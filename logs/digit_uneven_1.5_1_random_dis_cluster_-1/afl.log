===2023-06-19 17:57:33===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 0
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
===2023-06-19 17:57:40===
===2023-06-19 18:04:39===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 2
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
============ Train epoch 0 ============
===2023-06-19 18:10:39===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 2
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.2650 | Train Acc: 0.1689
 Site-MNIST                         | Train Loss: 2.2820 | Train Acc: 0.1391
 Site-MNIST                         | Train Loss: 2.2765 | Train Acc: 0.1381
 Site-MNIST                         | Train Loss: 2.2778 | Train Acc: 0.1327
 Site-MNIST                         | Train Loss: 2.2735 | Train Acc: 0.1384
 Site-USPS                          | Train Loss: 2.2694 | Train Acc: 0.2182
 Site-USPS                          | Train Loss: 2.2610 | Train Acc: 0.2748
 Site-USPS                          | Train Loss: 2.2673 | Train Acc: 0.2599
 Site-SynthDigits                   | Train Loss: 2.2997 | Train Acc: 0.1193
 Site-SynthDigits                   | Train Loss: 2.3056 | Train Acc: 0.1149
 Site-MNIST-M                       | Train Loss: 2.3163 | Train Acc: 0.0966
 Site-MNIST-M                       | Train Loss: 2.3116 | Train Acc: 0.1042
 Site-SVHN                          | Train Loss: 2.2944 | Train Acc: 0.1073
Average Train Accuracy: 0.1548
 Site-MNIST                         | Val  Loss: 2.2561 | Val  Acc: 0.2321
 Site-MNIST                         | Val  Loss: 2.2610 | Val  Acc: 0.1548
 Site-MNIST                         | Val  Loss: 2.2797 | Val  Acc: 0.1508
 Site-MNIST                         | Val  Loss: 2.2819 | Val  Acc: 0.1368
 Site-MNIST                         | Val  Loss: 2.2749 | Val  Acc: 0.1509
 Site-USPS                          | Val  Loss: 2.2714 | Val  Acc: 0.2115
 Site-USPS                          | Val  Loss: 2.2630 | Val  Acc: 0.2692
 Site-USPS                          | Val  Loss: 2.2611 | Val  Acc: 0.2350
 Site-SynthDigits                   | Val  Loss: 2.3042 | Val  Acc: 0.1439
 Site-SynthDigits                   | Val  Loss: 2.2959 | Val  Acc: 0.1414
 Site-MNIST-M                       | Val  Loss: 2.3366 | Val  Acc: 0.0795
 Site-MNIST-M                       | Val  Loss: 2.3401 | Val  Acc: 0.0985
 Site-SVHN                          | Val  Loss: 2.2906 | Val  Acc: 0.0890
Average Valid Accuracy: 0.1611
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.2321
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1548
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1508
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1368
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1509
 Best site-USPS                      | Epoch:0 | Val Acc: 0.2115
 Best site-USPS                      | Epoch:0 | Val Acc: 0.2692
 Best site-USPS                      | Epoch:0 | Val Acc: 0.2350
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1439
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1414
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.0795
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.0985
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.0890
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 2.2371 | Train Acc: 0.2489
 Site-MNIST                         | Train Loss: 2.2541 | Train Acc: 0.2101
 Site-MNIST                         | Train Loss: 2.2526 | Train Acc: 0.2150
 Site-MNIST                         | Train Loss: 2.2513 | Train Acc: 0.2011
 Site-MNIST                         | Train Loss: 2.2460 | Train Acc: 0.2320
 Site-USPS                          | Train Loss: 2.2332 | Train Acc: 0.3693
 Site-USPS                          | Train Loss: 2.2290 | Train Acc: 0.3882
 Site-USPS                          | Train Loss: 2.2320 | Train Acc: 0.3940
 Site-SynthDigits                   | Train Loss: 2.2896 | Train Acc: 0.1326
 Site-SynthDigits                   | Train Loss: 2.2982 | Train Acc: 0.1477
 Site-MNIST-M                       | Train Loss: 2.3132 | Train Acc: 0.1023
 Site-MNIST-M                       | Train Loss: 2.3076 | Train Acc: 0.1061
 Site-SVHN                          | Train Loss: 2.2905 | Train Acc: 0.1107
Average Train Accuracy: 0.2198
 Site-MNIST                         | Val  Loss: 2.2356 | Val  Acc: 0.3393
 Site-MNIST                         | Val  Loss: 2.2414 | Val  Acc: 0.2381
 Site-MNIST                         | Val  Loss: 2.2527 | Val  Acc: 0.1984
 Site-MNIST                         | Val  Loss: 2.2581 | Val  Acc: 0.1789
 Site-MNIST                         | Val  Loss: 2.2502 | Val  Acc: 0.2211
 Site-USPS                          | Val  Loss: 2.2434 | Val  Acc: 0.3077
 Site-USPS                          | Val  Loss: 2.2360 | Val  Acc: 0.3718
 Site-USPS                          | Val  Loss: 2.2274 | Val  Acc: 0.3974
 Site-SynthDigits                   | Val  Loss: 2.2994 | Val  Acc: 0.1515
 Site-SynthDigits                   | Val  Loss: 2.2899 | Val  Acc: 0.1364
 Site-MNIST-M                       | Val  Loss: 2.3302 | Val  Acc: 0.0795
 Site-MNIST-M                       | Val  Loss: 2.3350 | Val  Acc: 0.0985
 Site-SVHN                          | Val  Loss: 2.2872 | Val  Acc: 0.0822
Average Valid Accuracy: 0.2154
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.3393
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.2381
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.1984
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.1789
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.2211
 Best site-USPS                      | Epoch:1 | Val Acc: 0.3077
 Best site-USPS                      | Epoch:1 | Val Acc: 0.3718
 Best site-USPS                      | Epoch:1 | Val Acc: 0.3974
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.1515
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.1364
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.0795
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.0985
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.0822
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
===2023-06-19 18:14:39===
===2023-06-19 21:47:53===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.2650 | Train Acc: 0.1689
 Site-MNIST                         | Train Loss: 2.2820 | Train Acc: 0.1391
 Site-MNIST                         | Train Loss: 2.2765 | Train Acc: 0.1381
 Site-MNIST                         | Train Loss: 2.2778 | Train Acc: 0.1327
 Site-MNIST                         | Train Loss: 2.2735 | Train Acc: 0.1384
 Site-USPS                          | Train Loss: 2.2694 | Train Acc: 0.2182
 Site-USPS                          | Train Loss: 2.2610 | Train Acc: 0.2748
 Site-USPS                          | Train Loss: 2.2673 | Train Acc: 0.2599
 Site-SynthDigits                   | Train Loss: 2.2997 | Train Acc: 0.1193
 Site-SynthDigits                   | Train Loss: 2.3056 | Train Acc: 0.1149
 Site-MNIST-M                       | Train Loss: 2.3163 | Train Acc: 0.0966
 Site-MNIST-M                       | Train Loss: 2.3116 | Train Acc: 0.1042
 Site-SVHN                          | Train Loss: 2.2944 | Train Acc: 0.1073
Average Train Accuracy: 0.1548
 Site-MNIST                         | Val  Loss: 2.2561 | Val  Acc: 0.2321
 Site-MNIST                         | Val  Loss: 2.2610 | Val  Acc: 0.1548
 Site-MNIST                         | Val  Loss: 2.2797 | Val  Acc: 0.1508
 Site-MNIST                         | Val  Loss: 2.2819 | Val  Acc: 0.1368
 Site-MNIST                         | Val  Loss: 2.2749 | Val  Acc: 0.1509
 Site-USPS                          | Val  Loss: 2.2714 | Val  Acc: 0.2115
 Site-USPS                          | Val  Loss: 2.2630 | Val  Acc: 0.2692
 Site-USPS                          | Val  Loss: 2.2611 | Val  Acc: 0.2350
 Site-SynthDigits                   | Val  Loss: 2.3042 | Val  Acc: 0.1439
 Site-SynthDigits                   | Val  Loss: 2.2959 | Val  Acc: 0.1414
 Site-MNIST-M                       | Val  Loss: 2.3366 | Val  Acc: 0.0795
 Site-MNIST-M                       | Val  Loss: 2.3401 | Val  Acc: 0.0985
 Site-SVHN                          | Val  Loss: 2.2906 | Val  Acc: 0.0890
Average Valid Accuracy: 0.1611
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.2321
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1548
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1508
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1368
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1509
 Best site-USPS                      | Epoch:0 | Val Acc: 0.2115
 Best site-USPS                      | Epoch:0 | Val Acc: 0.2692
 Best site-USPS                      | Epoch:0 | Val Acc: 0.2350
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1439
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1414
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.0795
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.0985
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.0890
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 2.2371 | Train Acc: 0.2489
 Site-MNIST                         | Train Loss: 2.2541 | Train Acc: 0.2101
 Site-MNIST                         | Train Loss: 2.2526 | Train Acc: 0.2150
 Site-MNIST                         | Train Loss: 2.2513 | Train Acc: 0.2011
 Site-MNIST                         | Train Loss: 2.2460 | Train Acc: 0.2320
 Site-USPS                          | Train Loss: 2.2332 | Train Acc: 0.3693
 Site-USPS                          | Train Loss: 2.2290 | Train Acc: 0.3882
 Site-USPS                          | Train Loss: 2.2320 | Train Acc: 0.3940
 Site-SynthDigits                   | Train Loss: 2.2896 | Train Acc: 0.1326
 Site-SynthDigits                   | Train Loss: 2.2982 | Train Acc: 0.1477
 Site-MNIST-M                       | Train Loss: 2.3132 | Train Acc: 0.1023
 Site-MNIST-M                       | Train Loss: 2.3076 | Train Acc: 0.1061
 Site-SVHN                          | Train Loss: 2.2905 | Train Acc: 0.1107
Average Train Accuracy: 0.2198
 Site-MNIST                         | Val  Loss: 2.2356 | Val  Acc: 0.3393
 Site-MNIST                         | Val  Loss: 2.2414 | Val  Acc: 0.2381
 Site-MNIST                         | Val  Loss: 2.2527 | Val  Acc: 0.1984
 Site-MNIST                         | Val  Loss: 2.2581 | Val  Acc: 0.1789
 Site-MNIST                         | Val  Loss: 2.2502 | Val  Acc: 0.2211
 Site-USPS                          | Val  Loss: 2.2434 | Val  Acc: 0.3077
 Site-USPS                          | Val  Loss: 2.2360 | Val  Acc: 0.3718
 Site-USPS                          | Val  Loss: 2.2274 | Val  Acc: 0.3974
 Site-SynthDigits                   | Val  Loss: 2.2994 | Val  Acc: 0.1515
 Site-SynthDigits                   | Val  Loss: 2.2899 | Val  Acc: 0.1364
 Site-MNIST-M                       | Val  Loss: 2.3302 | Val  Acc: 0.0795
 Site-MNIST-M                       | Val  Loss: 2.3350 | Val  Acc: 0.0985
 Site-SVHN                          | Val  Loss: 2.2872 | Val  Acc: 0.0822
Average Valid Accuracy: 0.2154
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.3393
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.2381
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.1984
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.1789
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.2211
 Best site-USPS                      | Epoch:1 | Val Acc: 0.3077
 Best site-USPS                      | Epoch:1 | Val Acc: 0.3718
 Best site-USPS                      | Epoch:1 | Val Acc: 0.3974
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.1515
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.1364
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.0795
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.0985
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.0822
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 2.2121 | Train Acc: 0.3511
 Site-MNIST                         | Train Loss: 2.2290 | Train Acc: 0.3077
 Site-MNIST                         | Train Loss: 2.2288 | Train Acc: 0.2939
 Site-MNIST                         | Train Loss: 2.2255 | Train Acc: 0.2970
 Site-MNIST                         | Train Loss: 2.2196 | Train Acc: 0.3441
 Site-USPS                          | Train Loss: 2.2044 | Train Acc: 0.4341
 Site-USPS                          | Train Loss: 2.1991 | Train Acc: 0.4441
 Site-USPS                          | Train Loss: 2.1987 | Train Acc: 0.4409
 Site-SynthDigits                   | Train Loss: 2.2856 | Train Acc: 0.1515
 Site-SynthDigits                   | Train Loss: 2.2918 | Train Acc: 0.1654
 Site-MNIST-M                       | Train Loss: 2.3094 | Train Acc: 0.1250
 Site-MNIST-M                       | Train Loss: 2.3011 | Train Acc: 0.1136
 Site-SVHN                          | Train Loss: 2.2879 | Train Acc: 0.1227
Average Train Accuracy: 0.2762
 Site-MNIST                         | Val  Loss: 2.2155 | Val  Acc: 0.3929
 Site-MNIST                         | Val  Loss: 2.2220 | Val  Acc: 0.2738
 Site-MNIST                         | Val  Loss: 2.2264 | Val  Acc: 0.3095
 Site-MNIST                         | Val  Loss: 2.2346 | Val  Acc: 0.2789
 Site-MNIST                         | Val  Loss: 2.2259 | Val  Acc: 0.2982
 Site-USPS                          | Val  Loss: 2.2161 | Val  Acc: 0.3558
 Site-USPS                          | Val  Loss: 2.2100 | Val  Acc: 0.4295
 Site-USPS                          | Val  Loss: 2.1952 | Val  Acc: 0.4487
 Site-SynthDigits                   | Val  Loss: 2.2947 | Val  Acc: 0.1818
 Site-SynthDigits                   | Val  Loss: 2.2837 | Val  Acc: 0.1465
 Site-MNIST-M                       | Val  Loss: 2.3240 | Val  Acc: 0.0909
 Site-MNIST-M                       | Val  Loss: 2.3305 | Val  Acc: 0.0985
 Site-SVHN                          | Val  Loss: 2.2838 | Val  Acc: 0.1027
Average Valid Accuracy: 0.2621
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.3929
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.2738
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.3095
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.2789
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.2982
 Best site-USPS                      | Epoch:2 | Val Acc: 0.3558
 Best site-USPS                      | Epoch:2 | Val Acc: 0.4295
 Best site-USPS                      | Epoch:2 | Val Acc: 0.4487
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.1818
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.1465
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.0909
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.0985
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.1027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 2.1824 | Train Acc: 0.4133
 Site-MNIST                         | Train Loss: 2.1976 | Train Acc: 0.3639
 Site-MNIST                         | Train Loss: 2.2059 | Train Acc: 0.3511
 Site-MNIST                         | Train Loss: 2.1999 | Train Acc: 0.3561
 Site-MNIST                         | Train Loss: 2.1936 | Train Acc: 0.3993
 Site-USPS                          | Train Loss: 2.1735 | Train Acc: 0.4388
 Site-USPS                          | Train Loss: 2.1701 | Train Acc: 0.4601
 Site-USPS                          | Train Loss: 2.1663 | Train Acc: 0.4739
 Site-SynthDigits                   | Train Loss: 2.2800 | Train Acc: 0.1705
 Site-SynthDigits                   | Train Loss: 2.2833 | Train Acc: 0.1932
 Site-MNIST-M                       | Train Loss: 2.3037 | Train Acc: 0.1222
 Site-MNIST-M                       | Train Loss: 2.3007 | Train Acc: 0.1231
 Site-SVHN                          | Train Loss: 2.2885 | Train Acc: 0.1363
Average Train Accuracy: 0.3078
 Site-MNIST                         | Val  Loss: 2.1952 | Val  Acc: 0.4107
 Site-MNIST                         | Val  Loss: 2.2025 | Val  Acc: 0.3452
 Site-MNIST                         | Val  Loss: 2.2005 | Val  Acc: 0.3651
 Site-MNIST                         | Val  Loss: 2.2114 | Val  Acc: 0.3158
 Site-MNIST                         | Val  Loss: 2.2018 | Val  Acc: 0.3579
 Site-USPS                          | Val  Loss: 2.1895 | Val  Acc: 0.3654
 Site-USPS                          | Val  Loss: 2.1844 | Val  Acc: 0.4487
 Site-USPS                          | Val  Loss: 2.1640 | Val  Acc: 0.4701
 Site-SynthDigits                   | Val  Loss: 2.2898 | Val  Acc: 0.2121
 Site-SynthDigits                   | Val  Loss: 2.2775 | Val  Acc: 0.1465
 Site-MNIST-M                       | Val  Loss: 2.3175 | Val  Acc: 0.0909
 Site-MNIST-M                       | Val  Loss: 2.3265 | Val  Acc: 0.0985
 Site-SVHN                          | Val  Loss: 2.2805 | Val  Acc: 0.1027
Average Valid Accuracy: 0.2869
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.4107
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.3452
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.3651
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.3158
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.3579
 Best site-USPS                      | Epoch:3 | Val Acc: 0.3654
 Best site-USPS                      | Epoch:3 | Val Acc: 0.4487
 Best site-USPS                      | Epoch:3 | Val Acc: 0.4701
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2121
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.1465
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.0909
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.0985
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.1027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 2.1560 | Train Acc: 0.4489
 Site-MNIST                         | Train Loss: 2.1728 | Train Acc: 0.4024
 Site-MNIST                         | Train Loss: 2.1831 | Train Acc: 0.3748
 Site-MNIST                         | Train Loss: 2.1749 | Train Acc: 0.3837
 Site-MNIST                         | Train Loss: 2.1681 | Train Acc: 0.4247
 Site-USPS                          | Train Loss: 2.1404 | Train Acc: 0.4388
 Site-USPS                          | Train Loss: 2.1418 | Train Acc: 0.4649
 Site-USPS                          | Train Loss: 2.1359 | Train Acc: 0.4941
 Site-SynthDigits                   | Train Loss: 2.2727 | Train Acc: 0.1742
 Site-SynthDigits                   | Train Loss: 2.2762 | Train Acc: 0.2172
 Site-MNIST-M                       | Train Loss: 2.2998 | Train Acc: 0.1392
 Site-MNIST-M                       | Train Loss: 2.2987 | Train Acc: 0.1269
 Site-SVHN                          | Train Loss: 2.2770 | Train Acc: 0.1533
Average Train Accuracy: 0.3264
 Site-MNIST                         | Val  Loss: 2.1747 | Val  Acc: 0.3393
 Site-MNIST                         | Val  Loss: 2.1830 | Val  Acc: 0.3333
 Site-MNIST                         | Val  Loss: 2.1752 | Val  Acc: 0.4048
 Site-MNIST                         | Val  Loss: 2.1886 | Val  Acc: 0.3526
 Site-MNIST                         | Val  Loss: 2.1781 | Val  Acc: 0.4035
 Site-USPS                          | Val  Loss: 2.1637 | Val  Acc: 0.3750
 Site-USPS                          | Val  Loss: 2.1592 | Val  Acc: 0.4615
 Site-USPS                          | Val  Loss: 2.1337 | Val  Acc: 0.4658
 Site-SynthDigits                   | Val  Loss: 2.2850 | Val  Acc: 0.2197
 Site-SynthDigits                   | Val  Loss: 2.2714 | Val  Acc: 0.1566
 Site-MNIST-M                       | Val  Loss: 2.3116 | Val  Acc: 0.1136
 Site-MNIST-M                       | Val  Loss: 2.3228 | Val  Acc: 0.1061
 Site-SVHN                          | Val  Loss: 2.2770 | Val  Acc: 0.1096
Average Valid Accuracy: 0.2955
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.3393
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.3333
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.4048
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.3526
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.4035
 Best site-USPS                      | Epoch:4 | Val Acc: 0.3750
 Best site-USPS                      | Epoch:4 | Val Acc: 0.4615
 Best site-USPS                      | Epoch:4 | Val Acc: 0.4658
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.2197
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.1566
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.1136
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.1061
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.1096
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 2.1272 | Train Acc: 0.4756
 Site-MNIST                         | Train Loss: 2.1482 | Train Acc: 0.4201
 Site-MNIST                         | Train Loss: 2.1605 | Train Acc: 0.3984
 Site-MNIST                         | Train Loss: 2.1500 | Train Acc: 0.4034
 Site-MNIST                         | Train Loss: 2.1432 | Train Acc: 0.4387
 Site-USPS                          | Train Loss: 2.1090 | Train Acc: 0.4628
 Site-USPS                          | Train Loss: 2.1127 | Train Acc: 0.4760
 Site-USPS                          | Train Loss: 2.1061 | Train Acc: 0.5080
 Site-SynthDigits                   | Train Loss: 2.2702 | Train Acc: 0.1875
 Site-SynthDigits                   | Train Loss: 2.2680 | Train Acc: 0.2273
 Site-MNIST-M                       | Train Loss: 2.2983 | Train Acc: 0.1392
 Site-MNIST-M                       | Train Loss: 2.2942 | Train Acc: 0.1307
 Site-SVHN                          | Train Loss: 2.2809 | Train Acc: 0.1618
Average Train Accuracy: 0.3407
 Site-MNIST                         | Val  Loss: 2.1541 | Val  Acc: 0.3393
 Site-MNIST                         | Val  Loss: 2.1632 | Val  Acc: 0.3452
 Site-MNIST                         | Val  Loss: 2.1500 | Val  Acc: 0.4365
 Site-MNIST                         | Val  Loss: 2.1660 | Val  Acc: 0.3895
 Site-MNIST                         | Val  Loss: 2.1548 | Val  Acc: 0.4211
 Site-USPS                          | Val  Loss: 2.1384 | Val  Acc: 0.4231
 Site-USPS                          | Val  Loss: 2.1345 | Val  Acc: 0.4744
 Site-USPS                          | Val  Loss: 2.1043 | Val  Acc: 0.4872
 Site-SynthDigits                   | Val  Loss: 2.2804 | Val  Acc: 0.2273
 Site-SynthDigits                   | Val  Loss: 2.2655 | Val  Acc: 0.1667
 Site-MNIST-M                       | Val  Loss: 2.3058 | Val  Acc: 0.1023
 Site-MNIST-M                       | Val  Loss: 2.3191 | Val  Acc: 0.1061
 Site-SVHN                          | Val  Loss: 2.2738 | Val  Acc: 0.1164
Average Valid Accuracy: 0.3104
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.3393
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.3452
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.4365
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.3895
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.4211
 Best site-USPS                      | Epoch:5 | Val Acc: 0.4231
 Best site-USPS                      | Epoch:5 | Val Acc: 0.4744
 Best site-USPS                      | Epoch:5 | Val Acc: 0.4872
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.2273
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.1667
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.1023
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.1061
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.1164
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 2.1125 | Train Acc: 0.4711
 Site-MNIST                         | Train Loss: 2.1238 | Train Acc: 0.4349
 Site-MNIST                         | Train Loss: 2.1377 | Train Acc: 0.4162
 Site-MNIST                         | Train Loss: 2.1262 | Train Acc: 0.4179
 Site-MNIST                         | Train Loss: 2.1188 | Train Acc: 0.4501
 Site-USPS                          | Train Loss: 2.0865 | Train Acc: 0.4892
 Site-USPS                          | Train Loss: 2.0871 | Train Acc: 0.4936
 Site-USPS                          | Train Loss: 2.0749 | Train Acc: 0.5133
 Site-SynthDigits                   | Train Loss: 2.2608 | Train Acc: 0.2008
 Site-SynthDigits                   | Train Loss: 2.2609 | Train Acc: 0.2386
 Site-MNIST-M                       | Train Loss: 2.2939 | Train Acc: 0.1449
 Site-MNIST-M                       | Train Loss: 2.2953 | Train Acc: 0.1364
 Site-SVHN                          | Train Loss: 2.2736 | Train Acc: 0.1670
Average Train Accuracy: 0.3518
 Site-MNIST                         | Val  Loss: 2.1337 | Val  Acc: 0.3750
 Site-MNIST                         | Val  Loss: 2.1434 | Val  Acc: 0.3690
 Site-MNIST                         | Val  Loss: 2.1254 | Val  Acc: 0.4524
 Site-MNIST                         | Val  Loss: 2.1439 | Val  Acc: 0.4053
 Site-MNIST                         | Val  Loss: 2.1317 | Val  Acc: 0.4316
 Site-USPS                          | Val  Loss: 2.1133 | Val  Acc: 0.4423
 Site-USPS                          | Val  Loss: 2.1102 | Val  Acc: 0.4808
 Site-USPS                          | Val  Loss: 2.0755 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 2.2759 | Val  Acc: 0.2424
 Site-SynthDigits                   | Val  Loss: 2.2596 | Val  Acc: 0.1919
 Site-MNIST-M                       | Val  Loss: 2.3007 | Val  Acc: 0.1023
 Site-MNIST-M                       | Val  Loss: 2.3159 | Val  Acc: 0.1061
 Site-SVHN                          | Val  Loss: 2.2705 | Val  Acc: 0.1164
Average Valid Accuracy: 0.3243
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.3750
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.3690
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.4524
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.4053
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.4316
 Best site-USPS                      | Epoch:6 | Val Acc: 0.4423
 Best site-USPS                      | Epoch:6 | Val Acc: 0.4808
 Best site-USPS                      | Epoch:6 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.2424
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.1919
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.1023
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.1061
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.1164
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 2.0785 | Train Acc: 0.4844
 Site-MNIST                         | Train Loss: 2.1029 | Train Acc: 0.4349
 Site-MNIST                         | Train Loss: 2.1163 | Train Acc: 0.4260
 Site-MNIST                         | Train Loss: 2.1025 | Train Acc: 0.4284
 Site-MNIST                         | Train Loss: 2.0943 | Train Acc: 0.4536
 Site-USPS                          | Train Loss: 2.0552 | Train Acc: 0.4916
 Site-USPS                          | Train Loss: 2.0595 | Train Acc: 0.5016
 Site-USPS                          | Train Loss: 2.0465 | Train Acc: 0.5186
 Site-SynthDigits                   | Train Loss: 2.2607 | Train Acc: 0.2140
 Site-SynthDigits                   | Train Loss: 2.2542 | Train Acc: 0.2475
 Site-MNIST-M                       | Train Loss: 2.2890 | Train Acc: 0.1477
 Site-MNIST-M                       | Train Loss: 2.2865 | Train Acc: 0.1402
 Site-SVHN                          | Train Loss: 2.2724 | Train Acc: 0.1755
Average Train Accuracy: 0.3588
 Site-MNIST                         | Val  Loss: 2.1132 | Val  Acc: 0.3929
 Site-MNIST                         | Val  Loss: 2.1234 | Val  Acc: 0.3810
 Site-MNIST                         | Val  Loss: 2.1013 | Val  Acc: 0.4683
 Site-MNIST                         | Val  Loss: 2.1221 | Val  Acc: 0.4158
 Site-MNIST                         | Val  Loss: 2.1090 | Val  Acc: 0.4281
 Site-USPS                          | Val  Loss: 2.0889 | Val  Acc: 0.4423
 Site-USPS                          | Val  Loss: 2.0865 | Val  Acc: 0.4744
 Site-USPS                          | Val  Loss: 2.0478 | Val  Acc: 0.4957
 Site-SynthDigits                   | Val  Loss: 2.2713 | Val  Acc: 0.2500
 Site-SynthDigits                   | Val  Loss: 2.2537 | Val  Acc: 0.1970
 Site-MNIST-M                       | Val  Loss: 2.2955 | Val  Acc: 0.1250
 Site-MNIST-M                       | Val  Loss: 2.3127 | Val  Acc: 0.1136
 Site-SVHN                          | Val  Loss: 2.2675 | Val  Acc: 0.1164
Average Valid Accuracy: 0.3308
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.3929
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.3810
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.4683
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.4158
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.4281
 Best site-USPS                      | Epoch:7 | Val Acc: 0.4423
 Best site-USPS                      | Epoch:7 | Val Acc: 0.4744
 Best site-USPS                      | Epoch:7 | Val Acc: 0.4957
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.2500
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.1970
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.1250
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.1136
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.1164
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 2.0534 | Train Acc: 0.4889
 Site-MNIST                         | Train Loss: 2.0847 | Train Acc: 0.4497
 Site-MNIST                         | Train Loss: 2.0948 | Train Acc: 0.4398
 Site-MNIST                         | Train Loss: 2.0796 | Train Acc: 0.4297
 Site-MNIST                         | Train Loss: 2.0711 | Train Acc: 0.4667
 Site-USPS                          | Train Loss: 2.0294 | Train Acc: 0.4964
 Site-USPS                          | Train Loss: 2.0328 | Train Acc: 0.5112
 Site-USPS                          | Train Loss: 2.0176 | Train Acc: 0.5250
 Site-SynthDigits                   | Train Loss: 2.2505 | Train Acc: 0.2102
 Site-SynthDigits                   | Train Loss: 2.2456 | Train Acc: 0.2487
 Site-MNIST-M                       | Train Loss: 2.2858 | Train Acc: 0.1619
 Site-MNIST-M                       | Train Loss: 2.2817 | Train Acc: 0.1534
 Site-SVHN                          | Train Loss: 2.2691 | Train Acc: 0.1789
Average Train Accuracy: 0.3662
 Site-MNIST                         | Val  Loss: 2.0930 | Val  Acc: 0.4107
 Site-MNIST                         | Val  Loss: 2.1038 | Val  Acc: 0.3929
 Site-MNIST                         | Val  Loss: 2.0778 | Val  Acc: 0.4841
 Site-MNIST                         | Val  Loss: 2.1009 | Val  Acc: 0.4211
 Site-MNIST                         | Val  Loss: 2.0870 | Val  Acc: 0.4351
 Site-USPS                          | Val  Loss: 2.0648 | Val  Acc: 0.4615
 Site-USPS                          | Val  Loss: 2.0630 | Val  Acc: 0.4872
 Site-USPS                          | Val  Loss: 2.0207 | Val  Acc: 0.5043
 Site-SynthDigits                   | Val  Loss: 2.2671 | Val  Acc: 0.2576
 Site-SynthDigits                   | Val  Loss: 2.2477 | Val  Acc: 0.1818
 Site-MNIST-M                       | Val  Loss: 2.2908 | Val  Acc: 0.1591
 Site-MNIST-M                       | Val  Loss: 2.3092 | Val  Acc: 0.1364
 Site-SVHN                          | Val  Loss: 2.2644 | Val  Acc: 0.1233
Average Valid Accuracy: 0.3427
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.4107
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.3929
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.4841
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.4211
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.4351
 Best site-USPS                      | Epoch:8 | Val Acc: 0.4615
 Best site-USPS                      | Epoch:8 | Val Acc: 0.4872
 Best site-USPS                      | Epoch:8 | Val Acc: 0.5043
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.2576
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.1818
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.1591
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.1364
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.1233
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 2.0398 | Train Acc: 0.4978
 Site-MNIST                         | Train Loss: 2.0560 | Train Acc: 0.4615
 Site-MNIST                         | Train Loss: 2.0749 | Train Acc: 0.4497
 Site-MNIST                         | Train Loss: 2.0575 | Train Acc: 0.4310
 Site-MNIST                         | Train Loss: 2.0488 | Train Acc: 0.4720
 Site-USPS                          | Train Loss: 2.0063 | Train Acc: 0.4964
 Site-USPS                          | Train Loss: 2.0075 | Train Acc: 0.5224
 Site-USPS                          | Train Loss: 1.9908 | Train Acc: 0.5325
 Site-SynthDigits                   | Train Loss: 2.2493 | Train Acc: 0.2273
 Site-SynthDigits                   | Train Loss: 2.2396 | Train Acc: 0.2626
 Site-MNIST-M                       | Train Loss: 2.2817 | Train Acc: 0.1761
 Site-MNIST-M                       | Train Loss: 2.2817 | Train Acc: 0.1610
 Site-SVHN                          | Train Loss: 2.2676 | Train Acc: 0.1942
Average Train Accuracy: 0.3757
 Site-MNIST                         | Val  Loss: 2.0733 | Val  Acc: 0.4464
 Site-MNIST                         | Val  Loss: 2.0845 | Val  Acc: 0.4167
 Site-MNIST                         | Val  Loss: 2.0553 | Val  Acc: 0.5000
 Site-MNIST                         | Val  Loss: 2.0803 | Val  Acc: 0.4421
 Site-MNIST                         | Val  Loss: 2.0657 | Val  Acc: 0.4456
 Site-USPS                          | Val  Loss: 2.0410 | Val  Acc: 0.4615
 Site-USPS                          | Val  Loss: 2.0398 | Val  Acc: 0.4808
 Site-USPS                          | Val  Loss: 1.9943 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 2.2625 | Val  Acc: 0.2803
 Site-SynthDigits                   | Val  Loss: 2.2415 | Val  Acc: 0.2071
 Site-MNIST-M                       | Val  Loss: 2.2863 | Val  Acc: 0.1591
 Site-MNIST-M                       | Val  Loss: 2.3060 | Val  Acc: 0.1515
 Site-SVHN                          | Val  Loss: 2.2616 | Val  Acc: 0.1438
Average Valid Accuracy: 0.3565
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.4464
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.4167
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.5000
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.4421
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.4456
 Best site-USPS                      | Epoch:9 | Val Acc: 0.4615
 Best site-USPS                      | Epoch:9 | Val Acc: 0.4808
 Best site-USPS                      | Epoch:9 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.2803
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.2071
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.1591
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.1515
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.1438
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 2.0120 | Train Acc: 0.5111
 Site-MNIST                         | Train Loss: 2.0384 | Train Acc: 0.4675
 Site-MNIST                         | Train Loss: 2.0545 | Train Acc: 0.4536
 Site-MNIST                         | Train Loss: 2.0361 | Train Acc: 0.4376
 Site-MNIST                         | Train Loss: 2.0270 | Train Acc: 0.4720
 Site-USPS                          | Train Loss: 1.9774 | Train Acc: 0.4940
 Site-USPS                          | Train Loss: 1.9836 | Train Acc: 0.5304
 Site-USPS                          | Train Loss: 1.9624 | Train Acc: 0.5378
 Site-SynthDigits                   | Train Loss: 2.2389 | Train Acc: 0.2311
 Site-SynthDigits                   | Train Loss: 2.2344 | Train Acc: 0.2727
 Site-MNIST-M                       | Train Loss: 2.2790 | Train Acc: 0.1818
 Site-MNIST-M                       | Train Loss: 2.2735 | Train Acc: 0.1686
 Site-SVHN                          | Train Loss: 2.2595 | Train Acc: 0.2044
Average Train Accuracy: 0.3817
 Site-MNIST                         | Val  Loss: 2.0540 | Val  Acc: 0.4643
 Site-MNIST                         | Val  Loss: 2.0657 | Val  Acc: 0.4286
 Site-MNIST                         | Val  Loss: 2.0335 | Val  Acc: 0.5079
 Site-MNIST                         | Val  Loss: 2.0601 | Val  Acc: 0.4421
 Site-MNIST                         | Val  Loss: 2.0450 | Val  Acc: 0.4456
 Site-USPS                          | Val  Loss: 2.0179 | Val  Acc: 0.4808
 Site-USPS                          | Val  Loss: 2.0173 | Val  Acc: 0.4936
 Site-USPS                          | Val  Loss: 1.9687 | Val  Acc: 0.5043
 Site-SynthDigits                   | Val  Loss: 2.2582 | Val  Acc: 0.2803
 Site-SynthDigits                   | Val  Loss: 2.2354 | Val  Acc: 0.2071
 Site-MNIST-M                       | Val  Loss: 2.2820 | Val  Acc: 0.1591
 Site-MNIST-M                       | Val  Loss: 2.3026 | Val  Acc: 0.1591
 Site-SVHN                          | Val  Loss: 2.2588 | Val  Acc: 0.1438
Average Valid Accuracy: 0.3628
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.4643
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.4286
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.5079
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.4421
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.4456
 Best site-USPS                      | Epoch:10 | Val Acc: 0.4808
 Best site-USPS                      | Epoch:10 | Val Acc: 0.4936
 Best site-USPS                      | Epoch:10 | Val Acc: 0.5043
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.2803
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.2071
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.1591
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.1591
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.1438
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 1.9878 | Train Acc: 0.5244
 Site-MNIST                         | Train Loss: 2.0240 | Train Acc: 0.4793
 Site-MNIST                         | Train Loss: 2.0343 | Train Acc: 0.4596
 Site-MNIST                         | Train Loss: 2.0152 | Train Acc: 0.4547
 Site-MNIST                         | Train Loss: 2.0055 | Train Acc: 0.4790
 Site-USPS                          | Train Loss: 1.9522 | Train Acc: 0.5012
 Site-USPS                          | Train Loss: 1.9605 | Train Acc: 0.5351
 Site-USPS                          | Train Loss: 1.9387 | Train Acc: 0.5442
 Site-SynthDigits                   | Train Loss: 2.2340 | Train Acc: 0.2405
 Site-SynthDigits                   | Train Loss: 2.2256 | Train Acc: 0.2816
 Site-MNIST-M                       | Train Loss: 2.2750 | Train Acc: 0.1903
 Site-MNIST-M                       | Train Loss: 2.2718 | Train Acc: 0.1629
 Site-SVHN                          | Train Loss: 2.2606 | Train Acc: 0.2061
Average Train Accuracy: 0.3891
 Site-MNIST                         | Val  Loss: 2.0350 | Val  Acc: 0.4643
 Site-MNIST                         | Val  Loss: 2.0471 | Val  Acc: 0.4286
 Site-MNIST                         | Val  Loss: 2.0123 | Val  Acc: 0.5079
 Site-MNIST                         | Val  Loss: 2.0404 | Val  Acc: 0.4579
 Site-MNIST                         | Val  Loss: 2.0247 | Val  Acc: 0.4632
 Site-USPS                          | Val  Loss: 1.9956 | Val  Acc: 0.4808
 Site-USPS                          | Val  Loss: 1.9954 | Val  Acc: 0.4936
 Site-USPS                          | Val  Loss: 1.9442 | Val  Acc: 0.5085
 Site-SynthDigits                   | Val  Loss: 2.2537 | Val  Acc: 0.2803
 Site-SynthDigits                   | Val  Loss: 2.2294 | Val  Acc: 0.2071
 Site-MNIST-M                       | Val  Loss: 2.2780 | Val  Acc: 0.1705
 Site-MNIST-M                       | Val  Loss: 2.2990 | Val  Acc: 0.1667
 Site-SVHN                          | Val  Loss: 2.2558 | Val  Acc: 0.1438
Average Valid Accuracy: 0.3672
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.4643
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.4286
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.5079
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.4579
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.4632
 Best site-USPS                      | Epoch:11 | Val Acc: 0.4808
 Best site-USPS                      | Epoch:11 | Val Acc: 0.4936
 Best site-USPS                      | Epoch:11 | Val Acc: 0.5085
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.2803
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.2071
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.1705
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.1667
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.1438
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 1.9663 | Train Acc: 0.5333
 Site-MNIST                         | Train Loss: 1.9958 | Train Acc: 0.5000
 Site-MNIST                         | Train Loss: 2.0161 | Train Acc: 0.4675
 Site-MNIST                         | Train Loss: 1.9947 | Train Acc: 0.4599
 Site-MNIST                         | Train Loss: 1.9849 | Train Acc: 0.4886
 Site-USPS                          | Train Loss: 1.9330 | Train Acc: 0.5084
 Site-USPS                          | Train Loss: 1.9345 | Train Acc: 0.5415
 Site-USPS                          | Train Loss: 1.9128 | Train Acc: 0.5538
 Site-SynthDigits                   | Train Loss: 2.2300 | Train Acc: 0.2519
 Site-SynthDigits                   | Train Loss: 2.2167 | Train Acc: 0.2879
 Site-MNIST-M                       | Train Loss: 2.2714 | Train Acc: 0.2074
 Site-MNIST-M                       | Train Loss: 2.2689 | Train Acc: 0.1667
 Site-SVHN                          | Train Loss: 2.2604 | Train Acc: 0.2027
Average Train Accuracy: 0.3977
 Site-MNIST                         | Val  Loss: 2.0164 | Val  Acc: 0.4643
 Site-MNIST                         | Val  Loss: 2.0289 | Val  Acc: 0.4286
 Site-MNIST                         | Val  Loss: 1.9914 | Val  Acc: 0.5159
 Site-MNIST                         | Val  Loss: 2.0210 | Val  Acc: 0.4684
 Site-MNIST                         | Val  Loss: 2.0048 | Val  Acc: 0.4807
 Site-USPS                          | Val  Loss: 1.9740 | Val  Acc: 0.4904
 Site-USPS                          | Val  Loss: 1.9740 | Val  Acc: 0.5000
 Site-USPS                          | Val  Loss: 1.9203 | Val  Acc: 0.5128
 Site-SynthDigits                   | Val  Loss: 2.2491 | Val  Acc: 0.2879
 Site-SynthDigits                   | Val  Loss: 2.2234 | Val  Acc: 0.2222
 Site-MNIST-M                       | Val  Loss: 2.2739 | Val  Acc: 0.1932
 Site-MNIST-M                       | Val  Loss: 2.2955 | Val  Acc: 0.1818
 Site-SVHN                          | Val  Loss: 2.2530 | Val  Acc: 0.1507
Average Valid Accuracy: 0.3767
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.4643
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.4286
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.5159
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.4684
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.4807
 Best site-USPS                      | Epoch:12 | Val Acc: 0.4904
 Best site-USPS                      | Epoch:12 | Val Acc: 0.5000
 Best site-USPS                      | Epoch:12 | Val Acc: 0.5128
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.2879
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.2222
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.1932
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.1818
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.1507
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 1.9443 | Train Acc: 0.5378
 Site-MNIST                         | Train Loss: 1.9839 | Train Acc: 0.5089
 Site-MNIST                         | Train Loss: 1.9962 | Train Acc: 0.4714
 Site-MNIST                         | Train Loss: 1.9748 | Train Acc: 0.4731
 Site-MNIST                         | Train Loss: 1.9648 | Train Acc: 0.4930
 Site-USPS                          | Train Loss: 1.9068 | Train Acc: 0.5060
 Site-USPS                          | Train Loss: 1.9134 | Train Acc: 0.5495
 Site-USPS                          | Train Loss: 1.8878 | Train Acc: 0.5612
 Site-SynthDigits                   | Train Loss: 2.2217 | Train Acc: 0.2633
 Site-SynthDigits                   | Train Loss: 2.2099 | Train Acc: 0.2992
 Site-MNIST-M                       | Train Loss: 2.2665 | Train Acc: 0.2017
 Site-MNIST-M                       | Train Loss: 2.2671 | Train Acc: 0.1761
 Site-SVHN                          | Train Loss: 2.2524 | Train Acc: 0.2078
Average Train Accuracy: 0.4038
 Site-MNIST                         | Val  Loss: 1.9983 | Val  Acc: 0.4643
 Site-MNIST                         | Val  Loss: 2.0108 | Val  Acc: 0.4286
 Site-MNIST                         | Val  Loss: 1.9708 | Val  Acc: 0.5159
 Site-MNIST                         | Val  Loss: 2.0018 | Val  Acc: 0.4789
 Site-MNIST                         | Val  Loss: 1.9852 | Val  Acc: 0.4947
 Site-USPS                          | Val  Loss: 1.9533 | Val  Acc: 0.5192
 Site-USPS                          | Val  Loss: 1.9541 | Val  Acc: 0.5128
 Site-USPS                          | Val  Loss: 1.8982 | Val  Acc: 0.5171
 Site-SynthDigits                   | Val  Loss: 2.2442 | Val  Acc: 0.3030
 Site-SynthDigits                   | Val  Loss: 2.2173 | Val  Acc: 0.2374
 Site-MNIST-M                       | Val  Loss: 2.2700 | Val  Acc: 0.1932
 Site-MNIST-M                       | Val  Loss: 2.2921 | Val  Acc: 0.1818
 Site-SVHN                          | Val  Loss: 2.2505 | Val  Acc: 0.1438
Average Valid Accuracy: 0.3839
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.4643
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.4286
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.5159
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.4789
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.4947
 Best site-USPS                      | Epoch:13 | Val Acc: 0.5192
 Best site-USPS                      | Epoch:13 | Val Acc: 0.5128
 Best site-USPS                      | Epoch:13 | Val Acc: 0.5171
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.3030
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.2374
 Best site-MNIST-M                   | Epoch:13 | Val Acc: 0.1932
 Best site-MNIST-M                   | Epoch:13 | Val Acc: 0.1818
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.1438
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 1.9206 | Train Acc: 0.5378
 Site-MNIST                         | Train Loss: 1.9576 | Train Acc: 0.5207
 Site-MNIST                         | Train Loss: 1.9793 | Train Acc: 0.4793
 Site-MNIST                         | Train Loss: 1.9550 | Train Acc: 0.4836
 Site-MNIST                         | Train Loss: 1.9454 | Train Acc: 0.4974
 Site-USPS                          | Train Loss: 1.8910 | Train Acc: 0.5084
 Site-USPS                          | Train Loss: 1.8933 | Train Acc: 0.5543
 Site-USPS                          | Train Loss: 1.8679 | Train Acc: 0.5719
 Site-SynthDigits                   | Train Loss: 2.2123 | Train Acc: 0.2652
 Site-SynthDigits                   | Train Loss: 2.2049 | Train Acc: 0.3030
 Site-MNIST-M                       | Train Loss: 2.2672 | Train Acc: 0.2045
 Site-MNIST-M                       | Train Loss: 2.2665 | Train Acc: 0.1856
 Site-SVHN                          | Train Loss: 2.2545 | Train Acc: 0.2112
Average Train Accuracy: 0.4095
 Site-MNIST                         | Val  Loss: 1.9797 | Val  Acc: 0.4821
 Site-MNIST                         | Val  Loss: 1.9928 | Val  Acc: 0.4643
 Site-MNIST                         | Val  Loss: 1.9509 | Val  Acc: 0.5238
 Site-MNIST                         | Val  Loss: 1.9833 | Val  Acc: 0.4895
 Site-MNIST                         | Val  Loss: 1.9662 | Val  Acc: 0.5053
 Site-USPS                          | Val  Loss: 1.9328 | Val  Acc: 0.5192
 Site-USPS                          | Val  Loss: 1.9337 | Val  Acc: 0.5128
 Site-USPS                          | Val  Loss: 1.8757 | Val  Acc: 0.5171
 Site-SynthDigits                   | Val  Loss: 2.2398 | Val  Acc: 0.3106
 Site-SynthDigits                   | Val  Loss: 2.2117 | Val  Acc: 0.2475
 Site-MNIST-M                       | Val  Loss: 2.2660 | Val  Acc: 0.2045
 Site-MNIST-M                       | Val  Loss: 2.2885 | Val  Acc: 0.1894
 Site-SVHN                          | Val  Loss: 2.2482 | Val  Acc: 0.1438
Average Valid Accuracy: 0.3931
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.4821
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.4643
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.5238
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.4895
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.5053
 Best site-USPS                      | Epoch:14 | Val Acc: 0.5192
 Best site-USPS                      | Epoch:14 | Val Acc: 0.5128
 Best site-USPS                      | Epoch:14 | Val Acc: 0.5171
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.3106
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.2475
 Best site-MNIST-M                   | Epoch:14 | Val Acc: 0.2045
 Best site-MNIST-M                   | Epoch:14 | Val Acc: 0.1894
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.1438
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 1.9061 | Train Acc: 0.5467
 Site-MNIST                         | Train Loss: 1.9317 | Train Acc: 0.5325
 Site-MNIST                         | Train Loss: 1.9598 | Train Acc: 0.4832
 Site-MNIST                         | Train Loss: 1.9360 | Train Acc: 0.4915
 Site-MNIST                         | Train Loss: 1.9250 | Train Acc: 0.5026
 Site-USPS                          | Train Loss: 1.8629 | Train Acc: 0.5156
 Site-USPS                          | Train Loss: 1.8701 | Train Acc: 0.5623
 Site-USPS                          | Train Loss: 1.8469 | Train Acc: 0.5772
 Site-SynthDigits                   | Train Loss: 2.2094 | Train Acc: 0.2708
 Site-SynthDigits                   | Train Loss: 2.1953 | Train Acc: 0.3056
 Site-MNIST-M                       | Train Loss: 2.2591 | Train Acc: 0.2102
 Site-MNIST-M                       | Train Loss: 2.2587 | Train Acc: 0.1951
 Site-SVHN                          | Train Loss: 2.2503 | Train Acc: 0.2198
Average Train Accuracy: 0.4164
 Site-MNIST                         | Val  Loss: 1.9627 | Val  Acc: 0.5000
 Site-MNIST                         | Val  Loss: 1.9760 | Val  Acc: 0.4643
 Site-MNIST                         | Val  Loss: 1.9317 | Val  Acc: 0.5317
 Site-MNIST                         | Val  Loss: 1.9654 | Val  Acc: 0.5053
 Site-MNIST                         | Val  Loss: 1.9480 | Val  Acc: 0.5158
 Site-USPS                          | Val  Loss: 1.9134 | Val  Acc: 0.5288
 Site-USPS                          | Val  Loss: 1.9147 | Val  Acc: 0.5256
 Site-USPS                          | Val  Loss: 1.8548 | Val  Acc: 0.5256
 Site-SynthDigits                   | Val  Loss: 2.2347 | Val  Acc: 0.3106
 Site-SynthDigits                   | Val  Loss: 2.2056 | Val  Acc: 0.2525
 Site-MNIST-M                       | Val  Loss: 2.2619 | Val  Acc: 0.2273
 Site-MNIST-M                       | Val  Loss: 2.2851 | Val  Acc: 0.1818
 Site-SVHN                          | Val  Loss: 2.2455 | Val  Acc: 0.1507
Average Valid Accuracy: 0.4015
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.5000
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.4643
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.5317
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.5053
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.5158
 Best site-USPS                      | Epoch:15 | Val Acc: 0.5288
 Best site-USPS                      | Epoch:15 | Val Acc: 0.5256
 Best site-USPS                      | Epoch:15 | Val Acc: 0.5256
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.3106
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.2525
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.2273
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.1818
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.1507
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 1.8851 | Train Acc: 0.5467
 Site-MNIST                         | Train Loss: 1.9193 | Train Acc: 0.5444
 Site-MNIST                         | Train Loss: 1.9424 | Train Acc: 0.4892
 Site-MNIST                         | Train Loss: 1.9172 | Train Acc: 0.4915
 Site-MNIST                         | Train Loss: 1.9058 | Train Acc: 0.5114
 Site-USPS                          | Train Loss: 1.8467 | Train Acc: 0.5252
 Site-USPS                          | Train Loss: 1.8495 | Train Acc: 0.5751
 Site-USPS                          | Train Loss: 1.8233 | Train Acc: 0.5825
 Site-SynthDigits                   | Train Loss: 2.2052 | Train Acc: 0.2784
 Site-SynthDigits                   | Train Loss: 2.1869 | Train Acc: 0.3093
 Site-MNIST-M                       | Train Loss: 2.2577 | Train Acc: 0.2216
 Site-MNIST-M                       | Train Loss: 2.2587 | Train Acc: 0.1875
 Site-SVHN                          | Train Loss: 2.2451 | Train Acc: 0.2164
Average Train Accuracy: 0.4215
 Site-MNIST                         | Val  Loss: 1.9443 | Val  Acc: 0.5000
 Site-MNIST                         | Val  Loss: 1.9581 | Val  Acc: 0.4881
 Site-MNIST                         | Val  Loss: 1.9118 | Val  Acc: 0.5397
 Site-MNIST                         | Val  Loss: 1.9472 | Val  Acc: 0.5000
 Site-MNIST                         | Val  Loss: 1.9293 | Val  Acc: 0.5228
 Site-USPS                          | Val  Loss: 1.8938 | Val  Acc: 0.5481
 Site-USPS                          | Val  Loss: 1.8954 | Val  Acc: 0.5321
 Site-USPS                          | Val  Loss: 1.8336 | Val  Acc: 0.5299
 Site-SynthDigits                   | Val  Loss: 2.2303 | Val  Acc: 0.3182
 Site-SynthDigits                   | Val  Loss: 2.2003 | Val  Acc: 0.2576
 Site-MNIST-M                       | Val  Loss: 2.2583 | Val  Acc: 0.2273
 Site-MNIST-M                       | Val  Loss: 2.2816 | Val  Acc: 0.1970
 Site-SVHN                          | Val  Loss: 2.2432 | Val  Acc: 0.1438
Average Valid Accuracy: 0.4080
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.5000
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.4881
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.5397
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.5000
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.5228
 Best site-USPS                      | Epoch:16 | Val Acc: 0.5481
 Best site-USPS                      | Epoch:16 | Val Acc: 0.5321
 Best site-USPS                      | Epoch:16 | Val Acc: 0.5299
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.3182
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.2576
 Best site-MNIST-M                   | Epoch:16 | Val Acc: 0.2273
 Best site-MNIST-M                   | Epoch:16 | Val Acc: 0.1970
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.1438
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 1.8608 | Train Acc: 0.5600
 Site-MNIST                         | Train Loss: 1.8913 | Train Acc: 0.5592
 Site-MNIST                         | Train Loss: 1.9261 | Train Acc: 0.4970
 Site-MNIST                         | Train Loss: 1.8989 | Train Acc: 0.4980
 Site-MNIST                         | Train Loss: 1.8885 | Train Acc: 0.5236
 Site-USPS                          | Train Loss: 1.8337 | Train Acc: 0.5300
 Site-USPS                          | Train Loss: 1.8298 | Train Acc: 0.5815
 Site-USPS                          | Train Loss: 1.8042 | Train Acc: 0.5953
 Site-SynthDigits                   | Train Loss: 2.2060 | Train Acc: 0.2822
 Site-SynthDigits                   | Train Loss: 2.1825 | Train Acc: 0.3144
 Site-MNIST-M                       | Train Loss: 2.2547 | Train Acc: 0.2386
 Site-MNIST-M                       | Train Loss: 2.2541 | Train Acc: 0.1894
 Site-SVHN                          | Train Loss: 2.2436 | Train Acc: 0.2198
Average Train Accuracy: 0.4299
 Site-MNIST                         | Val  Loss: 1.9272 | Val  Acc: 0.5000
 Site-MNIST                         | Val  Loss: 1.9413 | Val  Acc: 0.5000
 Site-MNIST                         | Val  Loss: 1.8938 | Val  Acc: 0.5556
 Site-MNIST                         | Val  Loss: 1.9300 | Val  Acc: 0.5053
 Site-MNIST                         | Val  Loss: 1.9118 | Val  Acc: 0.5333
 Site-USPS                          | Val  Loss: 1.8743 | Val  Acc: 0.5481
 Site-USPS                          | Val  Loss: 1.8761 | Val  Acc: 0.5385
 Site-USPS                          | Val  Loss: 1.8129 | Val  Acc: 0.5299
 Site-SynthDigits                   | Val  Loss: 2.2258 | Val  Acc: 0.3258
 Site-SynthDigits                   | Val  Loss: 2.1945 | Val  Acc: 0.2677
 Site-MNIST-M                       | Val  Loss: 2.2543 | Val  Acc: 0.2386
 Site-MNIST-M                       | Val  Loss: 2.2780 | Val  Acc: 0.2121
 Site-SVHN                          | Val  Loss: 2.2406 | Val  Acc: 0.1438
Average Valid Accuracy: 0.4153
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.5000
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.5000
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.5556
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.5053
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.5333
 Best site-USPS                      | Epoch:17 | Val Acc: 0.5481
 Best site-USPS                      | Epoch:17 | Val Acc: 0.5385
 Best site-USPS                      | Epoch:17 | Val Acc: 0.5299
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.3258
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.2677
 Best site-MNIST-M                   | Epoch:17 | Val Acc: 0.2386
 Best site-MNIST-M                   | Epoch:17 | Val Acc: 0.2121
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.1438
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 1.8505 | Train Acc: 0.5644
 Site-MNIST                         | Train Loss: 1.8619 | Train Acc: 0.5710
 Site-MNIST                         | Train Loss: 1.9086 | Train Acc: 0.5030
 Site-MNIST                         | Train Loss: 1.8807 | Train Acc: 0.5059
 Site-MNIST                         | Train Loss: 1.8697 | Train Acc: 0.5306
 Site-USPS                          | Train Loss: 1.8099 | Train Acc: 0.5492
 Site-USPS                          | Train Loss: 1.8115 | Train Acc: 0.5847
 Site-USPS                          | Train Loss: 1.7829 | Train Acc: 0.6049
 Site-SynthDigits                   | Train Loss: 2.1900 | Train Acc: 0.2841
 Site-SynthDigits                   | Train Loss: 2.1779 | Train Acc: 0.3194
 Site-MNIST-M                       | Train Loss: 2.2539 | Train Acc: 0.2386
 Site-MNIST-M                       | Train Loss: 2.2535 | Train Acc: 0.1989
 Site-SVHN                          | Train Loss: 2.2352 | Train Acc: 0.2198
Average Train Accuracy: 0.4365
 Site-MNIST                         | Val  Loss: 1.9101 | Val  Acc: 0.5179
 Site-MNIST                         | Val  Loss: 1.9245 | Val  Acc: 0.5119
 Site-MNIST                         | Val  Loss: 1.8751 | Val  Acc: 0.5556
 Site-MNIST                         | Val  Loss: 1.9127 | Val  Acc: 0.5000
 Site-MNIST                         | Val  Loss: 1.8941 | Val  Acc: 0.5439
 Site-USPS                          | Val  Loss: 1.8560 | Val  Acc: 0.5577
 Site-USPS                          | Val  Loss: 1.8584 | Val  Acc: 0.5449
 Site-USPS                          | Val  Loss: 1.7937 | Val  Acc: 0.5470
 Site-SynthDigits                   | Val  Loss: 2.2213 | Val  Acc: 0.3258
 Site-SynthDigits                   | Val  Loss: 2.1888 | Val  Acc: 0.2677
 Site-MNIST-M                       | Val  Loss: 2.2503 | Val  Acc: 0.2386
 Site-MNIST-M                       | Val  Loss: 2.2747 | Val  Acc: 0.2121
 Site-SVHN                          | Val  Loss: 2.2382 | Val  Acc: 0.1438
Average Valid Accuracy: 0.4205
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.5179
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.5119
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.5556
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.5000
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.5439
 Best site-USPS                      | Epoch:18 | Val Acc: 0.5577
 Best site-USPS                      | Epoch:18 | Val Acc: 0.5449
 Best site-USPS                      | Epoch:18 | Val Acc: 0.5470
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.3258
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.2677
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.2386
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.2121
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.1438
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 1.8340 | Train Acc: 0.5778
 Site-MNIST                         | Train Loss: 1.8706 | Train Acc: 0.5888
 Site-MNIST                         | Train Loss: 1.8927 | Train Acc: 0.5069
 Site-MNIST                         | Train Loss: 1.8636 | Train Acc: 0.5125
 Site-MNIST                         | Train Loss: 1.8514 | Train Acc: 0.5403
 Site-USPS                          | Train Loss: 1.7920 | Train Acc: 0.5612
 Site-USPS                          | Train Loss: 1.7940 | Train Acc: 0.5990
 Site-USPS                          | Train Loss: 1.7616 | Train Acc: 0.6113
 Site-SynthDigits                   | Train Loss: 2.1882 | Train Acc: 0.2784
 Site-SynthDigits                   | Train Loss: 2.1703 | Train Acc: 0.3220
 Site-MNIST-M                       | Train Loss: 2.2436 | Train Acc: 0.2472
 Site-MNIST-M                       | Train Loss: 2.2428 | Train Acc: 0.2008
 Site-SVHN                          | Train Loss: 2.2373 | Train Acc: 0.2215
Average Train Accuracy: 0.4436
 Site-MNIST                         | Val  Loss: 1.8932 | Val  Acc: 0.5179
 Site-MNIST                         | Val  Loss: 1.9078 | Val  Acc: 0.5119
 Site-MNIST                         | Val  Loss: 1.8571 | Val  Acc: 0.5556
 Site-MNIST                         | Val  Loss: 1.8956 | Val  Acc: 0.5158
 Site-MNIST                         | Val  Loss: 1.8767 | Val  Acc: 0.5579
 Site-USPS                          | Val  Loss: 1.8381 | Val  Acc: 0.5673
 Site-USPS                          | Val  Loss: 1.8408 | Val  Acc: 0.5513
 Site-USPS                          | Val  Loss: 1.7748 | Val  Acc: 0.5513
 Site-SynthDigits                   | Val  Loss: 2.2166 | Val  Acc: 0.3182
 Site-SynthDigits                   | Val  Loss: 2.1835 | Val  Acc: 0.2576
 Site-MNIST-M                       | Val  Loss: 2.2467 | Val  Acc: 0.2386
 Site-MNIST-M                       | Val  Loss: 2.2715 | Val  Acc: 0.2121
 Site-SVHN                          | Val  Loss: 2.2358 | Val  Acc: 0.1438
Average Valid Accuracy: 0.4230
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.5179
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.5119
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.5556
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.5158
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.5579
 Best site-USPS                      | Epoch:19 | Val Acc: 0.5673
 Best site-USPS                      | Epoch:19 | Val Acc: 0.5513
 Best site-USPS                      | Epoch:19 | Val Acc: 0.5513
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.3182
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.2576
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.2386
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.2121
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.1438
 Test site-MNIST                     | Epoch:19 | Test Acc: 0.5136
 Test site-USPS                      | Epoch:19 | Test Acc: 0.6108
 Test site-SynthDigits               | Epoch:19 | Test Acc: 0.2877
 Test site-MNIST-M                   | Epoch:19 | Test Acc: 0.2033
 Test site-MNIST-M                   | Epoch:19 | Test Acc: 0.2033
 Test site-SVHN                      | Epoch:19 | Test Acc: 0.2066
MNIST: 0.3067, USPS: 0.6108, SynthDigits: 0.2877, SVHN: 0.2066, 
Average Test Accuracy(group): 0.3529, Average Test Accuracy(individual): 0.4299,
domain std=0.1535, cluster std=-1.0000, individual std=0.1584, 
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 1.8168 | Train Acc: 0.5911
 Site-MNIST                         | Train Loss: 1.8336 | Train Acc: 0.5947
 Site-MNIST                         | Train Loss: 1.8762 | Train Acc: 0.5168
 Site-MNIST                         | Train Loss: 1.8455 | Train Acc: 0.5164
 Site-MNIST                         | Train Loss: 1.8341 | Train Acc: 0.5534
 Site-USPS                          | Train Loss: 1.7539 | Train Acc: 0.5635
 Site-USPS                          | Train Loss: 1.7719 | Train Acc: 0.6054
 Site-USPS                          | Train Loss: 1.7434 | Train Acc: 0.6134
 Site-SynthDigits                   | Train Loss: 2.1752 | Train Acc: 0.2822
 Site-SynthDigits                   | Train Loss: 2.1594 | Train Acc: 0.3232
 Site-MNIST-M                       | Train Loss: 2.2467 | Train Acc: 0.2642
 Site-MNIST-M                       | Train Loss: 2.2463 | Train Acc: 0.2121
 Site-SVHN                          | Train Loss: 2.2322 | Train Acc: 0.2334
Average Train Accuracy: 0.4515
 Site-MNIST                         | Val  Loss: 1.8767 | Val  Acc: 0.5179
 Site-MNIST                         | Val  Loss: 1.8916 | Val  Acc: 0.5238
 Site-MNIST                         | Val  Loss: 1.8397 | Val  Acc: 0.5556
 Site-MNIST                         | Val  Loss: 1.8793 | Val  Acc: 0.5158
 Site-MNIST                         | Val  Loss: 1.8600 | Val  Acc: 0.5649
 Site-USPS                          | Val  Loss: 1.8200 | Val  Acc: 0.5865
 Site-USPS                          | Val  Loss: 1.8228 | Val  Acc: 0.5577
 Site-USPS                          | Val  Loss: 1.7556 | Val  Acc: 0.5556
 Site-SynthDigits                   | Val  Loss: 2.2123 | Val  Acc: 0.3182
 Site-SynthDigits                   | Val  Loss: 2.1781 | Val  Acc: 0.2576
 Site-MNIST-M                       | Val  Loss: 2.2430 | Val  Acc: 0.2614
 Site-MNIST-M                       | Val  Loss: 2.2680 | Val  Acc: 0.2273
 Site-SVHN                          | Val  Loss: 2.2334 | Val  Acc: 0.1712
Average Valid Accuracy: 0.4318
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.5179
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.5238
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.5556
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.5158
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.5649
 Best site-USPS                      | Epoch:20 | Val Acc: 0.5865
 Best site-USPS                      | Epoch:20 | Val Acc: 0.5577
 Best site-USPS                      | Epoch:20 | Val Acc: 0.5556
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.3182
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.2576
 Best site-MNIST-M                   | Epoch:20 | Val Acc: 0.2614
 Best site-MNIST-M                   | Epoch:20 | Val Acc: 0.2273
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.1712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 1.8081 | Train Acc: 0.6000
 Site-MNIST                         | Train Loss: 1.8164 | Train Acc: 0.5976
 Site-MNIST                         | Train Loss: 1.8601 | Train Acc: 0.5266
 Site-MNIST                         | Train Loss: 1.8291 | Train Acc: 0.5230
 Site-MNIST                         | Train Loss: 1.8179 | Train Acc: 0.5604
 Site-USPS                          | Train Loss: 1.7525 | Train Acc: 0.5707
 Site-USPS                          | Train Loss: 1.7548 | Train Acc: 0.6102
 Site-USPS                          | Train Loss: 1.7239 | Train Acc: 0.6219
 Site-SynthDigits                   | Train Loss: 2.1695 | Train Acc: 0.2898
 Site-SynthDigits                   | Train Loss: 2.1547 | Train Acc: 0.3258
 Site-MNIST-M                       | Train Loss: 2.2415 | Train Acc: 0.2727
 Site-MNIST-M                       | Train Loss: 2.2478 | Train Acc: 0.2159
 Site-SVHN                          | Train Loss: 2.2341 | Train Acc: 0.2351
Average Train Accuracy: 0.4577
 Site-MNIST                         | Val  Loss: 1.8600 | Val  Acc: 0.5357
 Site-MNIST                         | Val  Loss: 1.8754 | Val  Acc: 0.5238
 Site-MNIST                         | Val  Loss: 1.8223 | Val  Acc: 0.5635
 Site-MNIST                         | Val  Loss: 1.8630 | Val  Acc: 0.5421
 Site-MNIST                         | Val  Loss: 1.8435 | Val  Acc: 0.5719
 Site-USPS                          | Val  Loss: 1.8023 | Val  Acc: 0.5865
 Site-USPS                          | Val  Loss: 1.8053 | Val  Acc: 0.5705
 Site-USPS                          | Val  Loss: 1.7373 | Val  Acc: 0.5641
 Site-SynthDigits                   | Val  Loss: 2.2081 | Val  Acc: 0.3182
 Site-SynthDigits                   | Val  Loss: 2.1728 | Val  Acc: 0.2626
 Site-MNIST-M                       | Val  Loss: 2.2397 | Val  Acc: 0.2614
 Site-MNIST-M                       | Val  Loss: 2.2646 | Val  Acc: 0.2424
 Site-SVHN                          | Val  Loss: 2.2312 | Val  Acc: 0.1712
Average Valid Accuracy: 0.4395
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.5357
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.5238
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.5635
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.5421
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.5719
 Best site-USPS                      | Epoch:21 | Val Acc: 0.5865
 Best site-USPS                      | Epoch:21 | Val Acc: 0.5705
 Best site-USPS                      | Epoch:21 | Val Acc: 0.5641
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.3182
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.2626
 Best site-MNIST-M                   | Epoch:21 | Val Acc: 0.2614
 Best site-MNIST-M                   | Epoch:21 | Val Acc: 0.2424
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.1712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 1.7799 | Train Acc: 0.6178
 Site-MNIST                         | Train Loss: 1.8085 | Train Acc: 0.6006
 Site-MNIST                         | Train Loss: 1.8445 | Train Acc: 0.5345
 Site-MNIST                         | Train Loss: 1.8121 | Train Acc: 0.5296
 Site-MNIST                         | Train Loss: 1.8002 | Train Acc: 0.5692
 Site-USPS                          | Train Loss: 1.7309 | Train Acc: 0.5731
 Site-USPS                          | Train Loss: 1.7365 | Train Acc: 0.6198
 Site-USPS                          | Train Loss: 1.7053 | Train Acc: 0.6273
 Site-SynthDigits                   | Train Loss: 2.1739 | Train Acc: 0.2936
 Site-SynthDigits                   | Train Loss: 2.1480 | Train Acc: 0.3258
 Site-MNIST-M                       | Train Loss: 2.2387 | Train Acc: 0.2756
 Site-MNIST-M                       | Train Loss: 2.2368 | Train Acc: 0.2197
 Site-SVHN                          | Train Loss: 2.2294 | Train Acc: 0.2402
Average Train Accuracy: 0.4636
 Site-MNIST                         | Val  Loss: 1.8438 | Val  Acc: 0.5536
 Site-MNIST                         | Val  Loss: 1.8593 | Val  Acc: 0.5238
 Site-MNIST                         | Val  Loss: 1.8053 | Val  Acc: 0.5794
 Site-MNIST                         | Val  Loss: 1.8469 | Val  Acc: 0.5526
 Site-MNIST                         | Val  Loss: 1.8272 | Val  Acc: 0.5754
 Site-USPS                          | Val  Loss: 1.7858 | Val  Acc: 0.5962
 Site-USPS                          | Val  Loss: 1.7892 | Val  Acc: 0.5769
 Site-USPS                          | Val  Loss: 1.7203 | Val  Acc: 0.5726
 Site-SynthDigits                   | Val  Loss: 2.2037 | Val  Acc: 0.3182
 Site-SynthDigits                   | Val  Loss: 2.1671 | Val  Acc: 0.2727
 Site-MNIST-M                       | Val  Loss: 2.2360 | Val  Acc: 0.2727
 Site-MNIST-M                       | Val  Loss: 2.2615 | Val  Acc: 0.2576
 Site-SVHN                          | Val  Loss: 2.2293 | Val  Acc: 0.1712
Average Valid Accuracy: 0.4479
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.5536
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.5238
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.5794
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.5526
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.5754
 Best site-USPS                      | Epoch:22 | Val Acc: 0.5962
 Best site-USPS                      | Epoch:22 | Val Acc: 0.5769
 Best site-USPS                      | Epoch:22 | Val Acc: 0.5726
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.3182
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.2727
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.2727
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.2576
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.1712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 1.7681 | Train Acc: 0.6311
 Site-MNIST                         | Train Loss: 1.7874 | Train Acc: 0.6095
 Site-MNIST                         | Train Loss: 1.8295 | Train Acc: 0.5444
 Site-MNIST                         | Train Loss: 1.7965 | Train Acc: 0.5414
 Site-MNIST                         | Train Loss: 1.7848 | Train Acc: 0.5736
 Site-USPS                          | Train Loss: 1.7167 | Train Acc: 0.5755
 Site-USPS                          | Train Loss: 1.7194 | Train Acc: 0.6278
 Site-USPS                          | Train Loss: 1.6862 | Train Acc: 0.6337
 Site-SynthDigits                   | Train Loss: 2.1666 | Train Acc: 0.2973
 Site-SynthDigits                   | Train Loss: 2.1427 | Train Acc: 0.3283
 Site-MNIST-M                       | Train Loss: 2.2375 | Train Acc: 0.2756
 Site-MNIST-M                       | Train Loss: 2.2381 | Train Acc: 0.2292
 Site-SVHN                          | Train Loss: 2.2271 | Train Acc: 0.2436
Average Train Accuracy: 0.4701
 Site-MNIST                         | Val  Loss: 1.8280 | Val  Acc: 0.5714
 Site-MNIST                         | Val  Loss: 1.8440 | Val  Acc: 0.5476
 Site-MNIST                         | Val  Loss: 1.7887 | Val  Acc: 0.5714
 Site-MNIST                         | Val  Loss: 1.8313 | Val  Acc: 0.5632
 Site-MNIST                         | Val  Loss: 1.8115 | Val  Acc: 0.5860
 Site-USPS                          | Val  Loss: 1.7690 | Val  Acc: 0.6154
 Site-USPS                          | Val  Loss: 1.7725 | Val  Acc: 0.5833
 Site-USPS                          | Val  Loss: 1.7029 | Val  Acc: 0.5812
 Site-SynthDigits                   | Val  Loss: 2.1997 | Val  Acc: 0.3106
 Site-SynthDigits                   | Val  Loss: 2.1618 | Val  Acc: 0.2677
 Site-MNIST-M                       | Val  Loss: 2.2325 | Val  Acc: 0.2841
 Site-MNIST-M                       | Val  Loss: 2.2581 | Val  Acc: 0.2576
 Site-SVHN                          | Val  Loss: 2.2272 | Val  Acc: 0.1712
Average Valid Accuracy: 0.4547
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.5714
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.5476
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.5714
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.5632
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.5860
 Best site-USPS                      | Epoch:23 | Val Acc: 0.6154
 Best site-USPS                      | Epoch:23 | Val Acc: 0.5833
 Best site-USPS                      | Epoch:23 | Val Acc: 0.5812
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.3106
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.2677
 Best site-MNIST-M                   | Epoch:23 | Val Acc: 0.2841
 Best site-MNIST-M                   | Epoch:23 | Val Acc: 0.2576
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.1712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 1.7326 | Train Acc: 0.6400
 Site-MNIST                         | Train Loss: 1.7698 | Train Acc: 0.6183
 Site-MNIST                         | Train Loss: 1.8140 | Train Acc: 0.5582
 Site-MNIST                         | Train Loss: 1.7810 | Train Acc: 0.5519
 Site-MNIST                         | Train Loss: 1.7691 | Train Acc: 0.5858
 Site-USPS                          | Train Loss: 1.6959 | Train Acc: 0.5803
 Site-USPS                          | Train Loss: 1.7032 | Train Acc: 0.6342
 Site-USPS                          | Train Loss: 1.6740 | Train Acc: 0.6475
 Site-SynthDigits                   | Train Loss: 2.1628 | Train Acc: 0.3030
 Site-SynthDigits                   | Train Loss: 2.1339 | Train Acc: 0.3308
 Site-MNIST-M                       | Train Loss: 2.2319 | Train Acc: 0.2727
 Site-MNIST-M                       | Train Loss: 2.2340 | Train Acc: 0.2292
 Site-SVHN                          | Train Loss: 2.2206 | Train Acc: 0.2453
Average Train Accuracy: 0.4767
 Site-MNIST                         | Val  Loss: 1.8129 | Val  Acc: 0.6071
 Site-MNIST                         | Val  Loss: 1.8291 | Val  Acc: 0.5714
 Site-MNIST                         | Val  Loss: 1.7727 | Val  Acc: 0.5873
 Site-MNIST                         | Val  Loss: 1.8163 | Val  Acc: 0.5632
 Site-MNIST                         | Val  Loss: 1.7964 | Val  Acc: 0.5930
 Site-USPS                          | Val  Loss: 1.7522 | Val  Acc: 0.6250
 Site-USPS                          | Val  Loss: 1.7557 | Val  Acc: 0.5897
 Site-USPS                          | Val  Loss: 1.6852 | Val  Acc: 0.5897
 Site-SynthDigits                   | Val  Loss: 2.1955 | Val  Acc: 0.3106
 Site-SynthDigits                   | Val  Loss: 2.1567 | Val  Acc: 0.2727
 Site-MNIST-M                       | Val  Loss: 2.2288 | Val  Acc: 0.2841
 Site-MNIST-M                       | Val  Loss: 2.2550 | Val  Acc: 0.2424
 Site-SVHN                          | Val  Loss: 2.2254 | Val  Acc: 0.1781
Average Valid Accuracy: 0.4626
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.6071
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.5714
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.5873
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.5632
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.5930
 Best site-USPS                      | Epoch:24 | Val Acc: 0.6250
 Best site-USPS                      | Epoch:24 | Val Acc: 0.5897
 Best site-USPS                      | Epoch:24 | Val Acc: 0.5897
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.3106
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.2727
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.2841
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.2424
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.1781
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 1.7337 | Train Acc: 0.6444
 Site-MNIST                         | Train Loss: 1.7464 | Train Acc: 0.6272
 Site-MNIST                         | Train Loss: 1.8000 | Train Acc: 0.5740
 Site-MNIST                         | Train Loss: 1.7651 | Train Acc: 0.5558
 Site-MNIST                         | Train Loss: 1.7534 | Train Acc: 0.5919
 Site-USPS                          | Train Loss: 1.6833 | Train Acc: 0.5851
 Site-USPS                          | Train Loss: 1.6870 | Train Acc: 0.6374
 Site-USPS                          | Train Loss: 1.6529 | Train Acc: 0.6507
 Site-SynthDigits                   | Train Loss: 2.1571 | Train Acc: 0.3030
 Site-SynthDigits                   | Train Loss: 2.1285 | Train Acc: 0.3371
 Site-MNIST-M                       | Train Loss: 2.2309 | Train Acc: 0.2812
 Site-MNIST-M                       | Train Loss: 2.2327 | Train Acc: 0.2311
 Site-SVHN                          | Train Loss: 2.2193 | Train Acc: 0.2436
Average Train Accuracy: 0.4817
 Site-MNIST                         | Val  Loss: 1.7979 | Val  Acc: 0.6071
 Site-MNIST                         | Val  Loss: 1.8145 | Val  Acc: 0.5833
 Site-MNIST                         | Val  Loss: 1.7569 | Val  Acc: 0.6032
 Site-MNIST                         | Val  Loss: 1.8015 | Val  Acc: 0.5842
 Site-MNIST                         | Val  Loss: 1.7815 | Val  Acc: 0.6070
 Site-USPS                          | Val  Loss: 1.7361 | Val  Acc: 0.6250
 Site-USPS                          | Val  Loss: 1.7400 | Val  Acc: 0.5962
 Site-USPS                          | Val  Loss: 1.6690 | Val  Acc: 0.5983
 Site-SynthDigits                   | Val  Loss: 2.1913 | Val  Acc: 0.3106
 Site-SynthDigits                   | Val  Loss: 2.1511 | Val  Acc: 0.2727
 Site-MNIST-M                       | Val  Loss: 2.2248 | Val  Acc: 0.2841
 Site-MNIST-M                       | Val  Loss: 2.2520 | Val  Acc: 0.2424
 Site-SVHN                          | Val  Loss: 2.2234 | Val  Acc: 0.1781
Average Valid Accuracy: 0.4686
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.6071
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.5833
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.6032
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.5842
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.6070
 Best site-USPS                      | Epoch:25 | Val Acc: 0.6250
 Best site-USPS                      | Epoch:25 | Val Acc: 0.5962
 Best site-USPS                      | Epoch:25 | Val Acc: 0.5983
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.3106
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.2727
 Best site-MNIST-M                   | Epoch:25 | Val Acc: 0.2841
 Best site-MNIST-M                   | Epoch:25 | Val Acc: 0.2424
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.1781
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 1.7139 | Train Acc: 0.6444
 Site-MNIST                         | Train Loss: 1.7366 | Train Acc: 0.6331
 Site-MNIST                         | Train Loss: 1.7858 | Train Acc: 0.5819
 Site-MNIST                         | Train Loss: 1.7498 | Train Acc: 0.5585
 Site-MNIST                         | Train Loss: 1.7378 | Train Acc: 0.5972
 Site-USPS                          | Train Loss: 1.6713 | Train Acc: 0.5851
 Site-USPS                          | Train Loss: 1.6693 | Train Acc: 0.6406
 Site-USPS                          | Train Loss: 1.6386 | Train Acc: 0.6528
 Site-SynthDigits                   | Train Loss: 2.1401 | Train Acc: 0.3087
 Site-SynthDigits                   | Train Loss: 2.1235 | Train Acc: 0.3384
 Site-MNIST-M                       | Train Loss: 2.2250 | Train Acc: 0.2841
 Site-MNIST-M                       | Train Loss: 2.2316 | Train Acc: 0.2311
 Site-SVHN                          | Train Loss: 2.2226 | Train Acc: 0.2436
Average Train Accuracy: 0.4846
 Site-MNIST                         | Val  Loss: 1.7828 | Val  Acc: 0.6250
 Site-MNIST                         | Val  Loss: 1.7997 | Val  Acc: 0.6190
 Site-MNIST                         | Val  Loss: 1.7416 | Val  Acc: 0.6032
 Site-MNIST                         | Val  Loss: 1.7868 | Val  Acc: 0.5947
 Site-MNIST                         | Val  Loss: 1.7666 | Val  Acc: 0.6140
 Site-USPS                          | Val  Loss: 1.7205 | Val  Acc: 0.6346
 Site-USPS                          | Val  Loss: 1.7244 | Val  Acc: 0.5962
 Site-USPS                          | Val  Loss: 1.6530 | Val  Acc: 0.5983
 Site-SynthDigits                   | Val  Loss: 2.1875 | Val  Acc: 0.3258
 Site-SynthDigits                   | Val  Loss: 2.1455 | Val  Acc: 0.2778
 Site-MNIST-M                       | Val  Loss: 2.2212 | Val  Acc: 0.2955
 Site-MNIST-M                       | Val  Loss: 2.2488 | Val  Acc: 0.2348
 Site-SVHN                          | Val  Loss: 2.2213 | Val  Acc: 0.1781
Average Valid Accuracy: 0.4767
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.6250
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.6190
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.6032
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.5947
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.6140
 Best site-USPS                      | Epoch:26 | Val Acc: 0.6346
 Best site-USPS                      | Epoch:26 | Val Acc: 0.5962
 Best site-USPS                      | Epoch:26 | Val Acc: 0.5983
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.3258
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.2778
 Best site-MNIST-M                   | Epoch:26 | Val Acc: 0.2955
 Best site-MNIST-M                   | Epoch:26 | Val Acc: 0.2348
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.1781
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 1.7141 | Train Acc: 0.6444
 Site-MNIST                         | Train Loss: 1.7499 | Train Acc: 0.6391
 Site-MNIST                         | Train Loss: 1.7716 | Train Acc: 0.5858
 Site-MNIST                         | Train Loss: 1.7349 | Train Acc: 0.5690
 Site-MNIST                         | Train Loss: 1.7232 | Train Acc: 0.6007
 Site-USPS                          | Train Loss: 1.6585 | Train Acc: 0.5923
 Site-USPS                          | Train Loss: 1.6582 | Train Acc: 0.6438
 Site-USPS                          | Train Loss: 1.6240 | Train Acc: 0.6571
 Site-SynthDigits                   | Train Loss: 2.1423 | Train Acc: 0.3106
 Site-SynthDigits                   | Train Loss: 2.1195 | Train Acc: 0.3422
 Site-MNIST-M                       | Train Loss: 2.2224 | Train Acc: 0.2898
 Site-MNIST-M                       | Train Loss: 2.2233 | Train Acc: 0.2292
 Site-SVHN                          | Train Loss: 2.2152 | Train Acc: 0.2470
Average Train Accuracy: 0.4885
 Site-MNIST                         | Val  Loss: 1.7684 | Val  Acc: 0.6250
 Site-MNIST                         | Val  Loss: 1.7857 | Val  Acc: 0.6310
 Site-MNIST                         | Val  Loss: 1.7265 | Val  Acc: 0.6111
 Site-MNIST                         | Val  Loss: 1.7727 | Val  Acc: 0.5947
 Site-MNIST                         | Val  Loss: 1.7524 | Val  Acc: 0.6175
 Site-USPS                          | Val  Loss: 1.7061 | Val  Acc: 0.6346
 Site-USPS                          | Val  Loss: 1.7101 | Val  Acc: 0.5962
 Site-USPS                          | Val  Loss: 1.6381 | Val  Acc: 0.6068
 Site-SynthDigits                   | Val  Loss: 2.1830 | Val  Acc: 0.3333
 Site-SynthDigits                   | Val  Loss: 2.1398 | Val  Acc: 0.2778
 Site-MNIST-M                       | Val  Loss: 2.2173 | Val  Acc: 0.3182
 Site-MNIST-M                       | Val  Loss: 2.2459 | Val  Acc: 0.2424
 Site-SVHN                          | Val  Loss: 2.2194 | Val  Acc: 0.1781
Average Valid Accuracy: 0.4821
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.6250
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.6310
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.6111
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.5947
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.6175
 Best site-USPS                      | Epoch:27 | Val Acc: 0.6346
 Best site-USPS                      | Epoch:27 | Val Acc: 0.5962
 Best site-USPS                      | Epoch:27 | Val Acc: 0.6068
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.3333
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.2778
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.3182
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.2424
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.1781
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 1.6943 | Train Acc: 0.6489
 Site-MNIST                         | Train Loss: 1.7088 | Train Acc: 0.6391
 Site-MNIST                         | Train Loss: 1.7568 | Train Acc: 0.5937
 Site-MNIST                         | Train Loss: 1.7209 | Train Acc: 0.5795
 Site-MNIST                         | Train Loss: 1.7088 | Train Acc: 0.6033
 Site-USPS                          | Train Loss: 1.6354 | Train Acc: 0.5971
 Site-USPS                          | Train Loss: 1.6425 | Train Acc: 0.6486
 Site-USPS                          | Train Loss: 1.6065 | Train Acc: 0.6613
 Site-SynthDigits                   | Train Loss: 2.1383 | Train Acc: 0.3106
 Site-SynthDigits                   | Train Loss: 2.1093 | Train Acc: 0.3447
 Site-MNIST-M                       | Train Loss: 2.2224 | Train Acc: 0.2926
 Site-MNIST-M                       | Train Loss: 2.2247 | Train Acc: 0.2348
 Site-SVHN                          | Train Loss: 2.2126 | Train Acc: 0.2470
Average Train Accuracy: 0.4924
 Site-MNIST                         | Val  Loss: 1.7537 | Val  Acc: 0.6250
 Site-MNIST                         | Val  Loss: 1.7712 | Val  Acc: 0.6310
 Site-MNIST                         | Val  Loss: 1.7114 | Val  Acc: 0.6190
 Site-MNIST                         | Val  Loss: 1.7583 | Val  Acc: 0.6000
 Site-MNIST                         | Val  Loss: 1.7379 | Val  Acc: 0.6175
 Site-USPS                          | Val  Loss: 1.6909 | Val  Acc: 0.6442
 Site-USPS                          | Val  Loss: 1.6952 | Val  Acc: 0.6026
 Site-USPS                          | Val  Loss: 1.6227 | Val  Acc: 0.6068
 Site-SynthDigits                   | Val  Loss: 2.1795 | Val  Acc: 0.3333
 Site-SynthDigits                   | Val  Loss: 2.1343 | Val  Acc: 0.2828
 Site-MNIST-M                       | Val  Loss: 2.2138 | Val  Acc: 0.3182
 Site-MNIST-M                       | Val  Loss: 2.2427 | Val  Acc: 0.2424
 Site-SVHN                          | Val  Loss: 2.2175 | Val  Acc: 0.1849
Average Valid Accuracy: 0.4852
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.6250
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.6310
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.6190
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.6000
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.6175
 Best site-USPS                      | Epoch:28 | Val Acc: 0.6442
 Best site-USPS                      | Epoch:28 | Val Acc: 0.6026
 Best site-USPS                      | Epoch:28 | Val Acc: 0.6068
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.3333
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.2828
 Best site-MNIST-M                   | Epoch:28 | Val Acc: 0.3182
 Best site-MNIST-M                   | Epoch:28 | Val Acc: 0.2424
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.1849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 1.6683 | Train Acc: 0.6578
 Site-MNIST                         | Train Loss: 1.6790 | Train Acc: 0.6450
 Site-MNIST                         | Train Loss: 1.7426 | Train Acc: 0.5976
 Site-MNIST                         | Train Loss: 1.7059 | Train Acc: 0.5861
 Site-MNIST                         | Train Loss: 1.6930 | Train Acc: 0.6130
 Site-USPS                          | Train Loss: 1.6209 | Train Acc: 0.6019
 Site-USPS                          | Train Loss: 1.6229 | Train Acc: 0.6502
 Site-USPS                          | Train Loss: 1.5927 | Train Acc: 0.6645
 Site-SynthDigits                   | Train Loss: 2.1287 | Train Acc: 0.3125
 Site-SynthDigits                   | Train Loss: 2.1044 | Train Acc: 0.3485
 Site-MNIST-M                       | Train Loss: 2.2185 | Train Acc: 0.2955
 Site-MNIST-M                       | Train Loss: 2.2274 | Train Acc: 0.2367
 Site-SVHN                          | Train Loss: 2.2253 | Train Acc: 0.2470
Average Train Accuracy: 0.4966
 Site-MNIST                         | Val  Loss: 1.7383 | Val  Acc: 0.6250
 Site-MNIST                         | Val  Loss: 1.7561 | Val  Acc: 0.6429
 Site-MNIST                         | Val  Loss: 1.6960 | Val  Acc: 0.6349
 Site-MNIST                         | Val  Loss: 1.7432 | Val  Acc: 0.6105
 Site-MNIST                         | Val  Loss: 1.7227 | Val  Acc: 0.6211
 Site-USPS                          | Val  Loss: 1.6768 | Val  Acc: 0.6538
 Site-USPS                          | Val  Loss: 1.6814 | Val  Acc: 0.5962
 Site-USPS                          | Val  Loss: 1.6088 | Val  Acc: 0.6026
 Site-SynthDigits                   | Val  Loss: 2.1760 | Val  Acc: 0.3409
 Site-SynthDigits                   | Val  Loss: 2.1285 | Val  Acc: 0.2828
 Site-MNIST-M                       | Val  Loss: 2.2108 | Val  Acc: 0.3409
 Site-MNIST-M                       | Val  Loss: 2.2402 | Val  Acc: 0.2500
 Site-SVHN                          | Val  Loss: 2.2155 | Val  Acc: 0.1849
Average Valid Accuracy: 0.4913
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.6250
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.6429
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.6349
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.6105
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.6211
 Best site-USPS                      | Epoch:29 | Val Acc: 0.6538
 Best site-USPS                      | Epoch:29 | Val Acc: 0.5962
 Best site-USPS                      | Epoch:29 | Val Acc: 0.6026
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.3409
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.2828
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.3409
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.2500
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.1849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 1.6485 | Train Acc: 0.6667
 Site-MNIST                         | Train Loss: 1.6905 | Train Acc: 0.6509
 Site-MNIST                         | Train Loss: 1.7279 | Train Acc: 0.5996
 Site-MNIST                         | Train Loss: 1.6917 | Train Acc: 0.5913
 Site-MNIST                         | Train Loss: 1.6781 | Train Acc: 0.6191
 Site-USPS                          | Train Loss: 1.6049 | Train Acc: 0.6043
 Site-USPS                          | Train Loss: 1.6078 | Train Acc: 0.6518
 Site-USPS                          | Train Loss: 1.5783 | Train Acc: 0.6677
 Site-SynthDigits                   | Train Loss: 2.1309 | Train Acc: 0.3125
 Site-SynthDigits                   | Train Loss: 2.0972 | Train Acc: 0.3523
 Site-MNIST-M                       | Train Loss: 2.2137 | Train Acc: 0.2955
 Site-MNIST-M                       | Train Loss: 2.2223 | Train Acc: 0.2348
 Site-SVHN                          | Train Loss: 2.2054 | Train Acc: 0.2470
Average Train Accuracy: 0.4995
 Site-MNIST                         | Val  Loss: 1.7243 | Val  Acc: 0.6250
 Site-MNIST                         | Val  Loss: 1.7419 | Val  Acc: 0.6429
 Site-MNIST                         | Val  Loss: 1.6814 | Val  Acc: 0.6270
 Site-MNIST                         | Val  Loss: 1.7293 | Val  Acc: 0.6105
 Site-MNIST                         | Val  Loss: 1.7086 | Val  Acc: 0.6281
 Site-USPS                          | Val  Loss: 1.6629 | Val  Acc: 0.6538
 Site-USPS                          | Val  Loss: 1.6676 | Val  Acc: 0.5962
 Site-USPS                          | Val  Loss: 1.5947 | Val  Acc: 0.6026
 Site-SynthDigits                   | Val  Loss: 2.1724 | Val  Acc: 0.3409
 Site-SynthDigits                   | Val  Loss: 2.1226 | Val  Acc: 0.2828
 Site-MNIST-M                       | Val  Loss: 2.2077 | Val  Acc: 0.3409
 Site-MNIST-M                       | Val  Loss: 2.2370 | Val  Acc: 0.2500
 Site-SVHN                          | Val  Loss: 2.2134 | Val  Acc: 0.1849
Average Valid Accuracy: 0.4912
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 1.6487 | Train Acc: 0.6711
 Site-MNIST                         | Train Loss: 1.6676 | Train Acc: 0.6538
 Site-MNIST                         | Train Loss: 1.7164 | Train Acc: 0.6016
 Site-MNIST                         | Train Loss: 1.6778 | Train Acc: 0.5966
 Site-MNIST                         | Train Loss: 1.6650 | Train Acc: 0.6270
 Site-USPS                          | Train Loss: 1.6032 | Train Acc: 0.6067
 Site-USPS                          | Train Loss: 1.5974 | Train Acc: 0.6565
 Site-USPS                          | Train Loss: 1.5614 | Train Acc: 0.6731
 Site-SynthDigits                   | Train Loss: 2.1135 | Train Acc: 0.3106
 Site-SynthDigits                   | Train Loss: 2.0982 | Train Acc: 0.3535
 Site-MNIST-M                       | Train Loss: 2.2143 | Train Acc: 0.2983
 Site-MNIST-M                       | Train Loss: 2.2201 | Train Acc: 0.2330
 Site-SVHN                          | Train Loss: 2.2145 | Train Acc: 0.2453
Average Train Accuracy: 0.5021
 Site-MNIST                         | Val  Loss: 1.7109 | Val  Acc: 0.6429
 Site-MNIST                         | Val  Loss: 1.7286 | Val  Acc: 0.6429
 Site-MNIST                         | Val  Loss: 1.6674 | Val  Acc: 0.6270
 Site-MNIST                         | Val  Loss: 1.7161 | Val  Acc: 0.6105
 Site-MNIST                         | Val  Loss: 1.6952 | Val  Acc: 0.6281
 Site-USPS                          | Val  Loss: 1.6484 | Val  Acc: 0.6635
 Site-USPS                          | Val  Loss: 1.6533 | Val  Acc: 0.6026
 Site-USPS                          | Val  Loss: 1.5802 | Val  Acc: 0.6068
 Site-SynthDigits                   | Val  Loss: 2.1688 | Val  Acc: 0.3409
 Site-SynthDigits                   | Val  Loss: 2.1166 | Val  Acc: 0.2778
 Site-MNIST-M                       | Val  Loss: 2.2043 | Val  Acc: 0.3409
 Site-MNIST-M                       | Val  Loss: 2.2341 | Val  Acc: 0.2576
 Site-SVHN                          | Val  Loss: 2.2113 | Val  Acc: 0.1849
Average Valid Accuracy: 0.4943
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.6429
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.6429
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.6270
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.6105
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.6281
 Best site-USPS                      | Epoch:31 | Val Acc: 0.6635
 Best site-USPS                      | Epoch:31 | Val Acc: 0.6026
 Best site-USPS                      | Epoch:31 | Val Acc: 0.6068
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.3409
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.2778
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.3409
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.2576
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.1849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 1.6242 | Train Acc: 0.6667
 Site-MNIST                         | Train Loss: 1.6673 | Train Acc: 0.6627
 Site-MNIST                         | Train Loss: 1.7037 | Train Acc: 0.6075
 Site-MNIST                         | Train Loss: 1.6654 | Train Acc: 0.6045
 Site-MNIST                         | Train Loss: 1.6523 | Train Acc: 0.6305
 Site-USPS                          | Train Loss: 1.5774 | Train Acc: 0.6115
 Site-USPS                          | Train Loss: 1.5802 | Train Acc: 0.6613
 Site-USPS                          | Train Loss: 1.5475 | Train Acc: 0.6763
 Site-SynthDigits                   | Train Loss: 2.1117 | Train Acc: 0.3087
 Site-SynthDigits                   | Train Loss: 2.0919 | Train Acc: 0.3561
 Site-MNIST-M                       | Train Loss: 2.2071 | Train Acc: 0.3011
 Site-MNIST-M                       | Train Loss: 2.2141 | Train Acc: 0.2405
 Site-SVHN                          | Train Loss: 2.2057 | Train Acc: 0.2470
Average Train Accuracy: 0.5057
 Site-MNIST                         | Val  Loss: 1.6976 | Val  Acc: 0.6607
 Site-MNIST                         | Val  Loss: 1.7155 | Val  Acc: 0.6548
 Site-MNIST                         | Val  Loss: 1.6543 | Val  Acc: 0.6349
 Site-MNIST                         | Val  Loss: 1.7038 | Val  Acc: 0.6158
 Site-MNIST                         | Val  Loss: 1.6826 | Val  Acc: 0.6351
 Site-USPS                          | Val  Loss: 1.6327 | Val  Acc: 0.6731
 Site-USPS                          | Val  Loss: 1.6377 | Val  Acc: 0.6026
 Site-USPS                          | Val  Loss: 1.5645 | Val  Acc: 0.6068
 Site-SynthDigits                   | Val  Loss: 2.1658 | Val  Acc: 0.3333
 Site-SynthDigits                   | Val  Loss: 2.1106 | Val  Acc: 0.2727
 Site-MNIST-M                       | Val  Loss: 2.2011 | Val  Acc: 0.3523
 Site-MNIST-M                       | Val  Loss: 2.2310 | Val  Acc: 0.2652
 Site-SVHN                          | Val  Loss: 2.2091 | Val  Acc: 0.1849
Average Valid Accuracy: 0.4994
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.6607
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.6548
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.6349
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.6158
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.6351
 Best site-USPS                      | Epoch:32 | Val Acc: 0.6731
 Best site-USPS                      | Epoch:32 | Val Acc: 0.6026
 Best site-USPS                      | Epoch:32 | Val Acc: 0.6068
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.3333
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.2727
 Best site-MNIST-M                   | Epoch:32 | Val Acc: 0.3523
 Best site-MNIST-M                   | Epoch:32 | Val Acc: 0.2652
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.1849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 1.6128 | Train Acc: 0.6756
 Site-MNIST                         | Train Loss: 1.6440 | Train Acc: 0.6746
 Site-MNIST                         | Train Loss: 1.6909 | Train Acc: 0.6134
 Site-MNIST                         | Train Loss: 1.6515 | Train Acc: 0.6110
 Site-MNIST                         | Train Loss: 1.6384 | Train Acc: 0.6349
 Site-USPS                          | Train Loss: 1.5757 | Train Acc: 0.6163
 Site-USPS                          | Train Loss: 1.5681 | Train Acc: 0.6677
 Site-USPS                          | Train Loss: 1.5330 | Train Acc: 0.6784
 Site-SynthDigits                   | Train Loss: 2.1065 | Train Acc: 0.3106
 Site-SynthDigits                   | Train Loss: 2.0810 | Train Acc: 0.3586
 Site-MNIST-M                       | Train Loss: 2.2047 | Train Acc: 0.2955
 Site-MNIST-M                       | Train Loss: 2.2117 | Train Acc: 0.2424
 Site-SVHN                          | Train Loss: 2.2020 | Train Acc: 0.2453
Average Train Accuracy: 0.5096
 Site-MNIST                         | Val  Loss: 1.6847 | Val  Acc: 0.6786
 Site-MNIST                         | Val  Loss: 1.7025 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.6411 | Val  Acc: 0.6429
 Site-MNIST                         | Val  Loss: 1.6914 | Val  Acc: 0.6263
 Site-MNIST                         | Val  Loss: 1.6698 | Val  Acc: 0.6456
 Site-USPS                          | Val  Loss: 1.6190 | Val  Acc: 0.6923
 Site-USPS                          | Val  Loss: 1.6243 | Val  Acc: 0.6218
 Site-USPS                          | Val  Loss: 1.5513 | Val  Acc: 0.6068
 Site-SynthDigits                   | Val  Loss: 2.1621 | Val  Acc: 0.3333
 Site-SynthDigits                   | Val  Loss: 2.1048 | Val  Acc: 0.2727
 Site-MNIST-M                       | Val  Loss: 2.1981 | Val  Acc: 0.3523
 Site-MNIST-M                       | Val  Loss: 2.2286 | Val  Acc: 0.2500
 Site-SVHN                          | Val  Loss: 2.2074 | Val  Acc: 0.1781
Average Valid Accuracy: 0.5052
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.6786
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.6429
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.6263
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.6456
 Best site-USPS                      | Epoch:33 | Val Acc: 0.6923
 Best site-USPS                      | Epoch:33 | Val Acc: 0.6218
 Best site-USPS                      | Epoch:33 | Val Acc: 0.6068
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.3333
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.2727
 Best site-MNIST-M                   | Epoch:33 | Val Acc: 0.3523
 Best site-MNIST-M                   | Epoch:33 | Val Acc: 0.2500
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.1781
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 1.5931 | Train Acc: 0.6889
 Site-MNIST                         | Train Loss: 1.6470 | Train Acc: 0.6805
 Site-MNIST                         | Train Loss: 1.6786 | Train Acc: 0.6193
 Site-MNIST                         | Train Loss: 1.6385 | Train Acc: 0.6189
 Site-MNIST                         | Train Loss: 1.6251 | Train Acc: 0.6401
 Site-USPS                          | Train Loss: 1.5575 | Train Acc: 0.6235
 Site-USPS                          | Train Loss: 1.5516 | Train Acc: 0.6693
 Site-USPS                          | Train Loss: 1.5196 | Train Acc: 0.6869
 Site-SynthDigits                   | Train Loss: 2.1105 | Train Acc: 0.3087
 Site-SynthDigits                   | Train Loss: 2.0745 | Train Acc: 0.3611
 Site-MNIST-M                       | Train Loss: 2.1975 | Train Acc: 0.2926
 Site-MNIST-M                       | Train Loss: 2.2132 | Train Acc: 0.2500
 Site-SVHN                          | Train Loss: 2.2085 | Train Acc: 0.2538
Average Train Accuracy: 0.5149
 Site-MNIST                         | Val  Loss: 1.6721 | Val  Acc: 0.6786
 Site-MNIST                         | Val  Loss: 1.6902 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.6280 | Val  Acc: 0.6508
 Site-MNIST                         | Val  Loss: 1.6785 | Val  Acc: 0.6316
 Site-MNIST                         | Val  Loss: 1.6570 | Val  Acc: 0.6491
 Site-USPS                          | Val  Loss: 1.6053 | Val  Acc: 0.6827
 Site-USPS                          | Val  Loss: 1.6110 | Val  Acc: 0.6154
 Site-USPS                          | Val  Loss: 1.5377 | Val  Acc: 0.6111
 Site-SynthDigits                   | Val  Loss: 2.1575 | Val  Acc: 0.3258
 Site-SynthDigits                   | Val  Loss: 2.1004 | Val  Acc: 0.2677
 Site-MNIST-M                       | Val  Loss: 2.1941 | Val  Acc: 0.3523
 Site-MNIST-M                       | Val  Loss: 2.2253 | Val  Acc: 0.2576
 Site-SVHN                          | Val  Loss: 2.2054 | Val  Acc: 0.1918
Average Valid Accuracy: 0.5062
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.6786
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.6508
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.6316
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.6491
 Best site-USPS                      | Epoch:34 | Val Acc: 0.6827
 Best site-USPS                      | Epoch:34 | Val Acc: 0.6154
 Best site-USPS                      | Epoch:34 | Val Acc: 0.6111
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.3258
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.2677
 Best site-MNIST-M                   | Epoch:34 | Val Acc: 0.3523
 Best site-MNIST-M                   | Epoch:34 | Val Acc: 0.2576
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.1918
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 1.5799 | Train Acc: 0.6978
 Site-MNIST                         | Train Loss: 1.6136 | Train Acc: 0.6805
 Site-MNIST                         | Train Loss: 1.6660 | Train Acc: 0.6213
 Site-MNIST                         | Train Loss: 1.6253 | Train Acc: 0.6229
 Site-MNIST                         | Train Loss: 1.6131 | Train Acc: 0.6445
 Site-USPS                          | Train Loss: 1.5430 | Train Acc: 0.6307
 Site-USPS                          | Train Loss: 1.5416 | Train Acc: 0.6773
 Site-USPS                          | Train Loss: 1.5064 | Train Acc: 0.6912
 Site-SynthDigits                   | Train Loss: 2.0925 | Train Acc: 0.3106
 Site-SynthDigits                   | Train Loss: 2.0679 | Train Acc: 0.3611
 Site-MNIST-M                       | Train Loss: 2.1978 | Train Acc: 0.2955
 Site-MNIST-M                       | Train Loss: 2.2062 | Train Acc: 0.2519
 Site-SVHN                          | Train Loss: 2.2023 | Train Acc: 0.2521
Average Train Accuracy: 0.5183
 Site-MNIST                         | Val  Loss: 1.6590 | Val  Acc: 0.6786
 Site-MNIST                         | Val  Loss: 1.6771 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.6150 | Val  Acc: 0.6508
 Site-MNIST                         | Val  Loss: 1.6663 | Val  Acc: 0.6316
 Site-MNIST                         | Val  Loss: 1.6444 | Val  Acc: 0.6491
 Site-USPS                          | Val  Loss: 1.5912 | Val  Acc: 0.6923
 Site-USPS                          | Val  Loss: 1.5973 | Val  Acc: 0.6218
 Site-USPS                          | Val  Loss: 1.5242 | Val  Acc: 0.6111
 Site-SynthDigits                   | Val  Loss: 2.1536 | Val  Acc: 0.3258
 Site-SynthDigits                   | Val  Loss: 2.0950 | Val  Acc: 0.2677
 Site-MNIST-M                       | Val  Loss: 2.1915 | Val  Acc: 0.3523
 Site-MNIST-M                       | Val  Loss: 2.2228 | Val  Acc: 0.2576
 Site-SVHN                          | Val  Loss: 2.2035 | Val  Acc: 0.1849
Average Valid Accuracy: 0.5069
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.6786
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.6508
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.6316
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.6491
 Best site-USPS                      | Epoch:35 | Val Acc: 0.6923
 Best site-USPS                      | Epoch:35 | Val Acc: 0.6218
 Best site-USPS                      | Epoch:35 | Val Acc: 0.6111
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.3258
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.2677
 Best site-MNIST-M                   | Epoch:35 | Val Acc: 0.3523
 Best site-MNIST-M                   | Epoch:35 | Val Acc: 0.2576
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.1849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 1.5798 | Train Acc: 0.6978
 Site-MNIST                         | Train Loss: 1.6110 | Train Acc: 0.6893
 Site-MNIST                         | Train Loss: 1.6544 | Train Acc: 0.6193
 Site-MNIST                         | Train Loss: 1.6134 | Train Acc: 0.6360
 Site-MNIST                         | Train Loss: 1.6007 | Train Acc: 0.6489
 Site-USPS                          | Train Loss: 1.5260 | Train Acc: 0.6331
 Site-USPS                          | Train Loss: 1.5256 | Train Acc: 0.6773
 Site-USPS                          | Train Loss: 1.4952 | Train Acc: 0.6922
 Site-SynthDigits                   | Train Loss: 2.0956 | Train Acc: 0.3220
 Site-SynthDigits                   | Train Loss: 2.0633 | Train Acc: 0.3624
 Site-MNIST-M                       | Train Loss: 2.1965 | Train Acc: 0.2955
 Site-MNIST-M                       | Train Loss: 2.1960 | Train Acc: 0.2557
 Site-SVHN                          | Train Loss: 2.1986 | Train Acc: 0.2538
Average Train Accuracy: 0.5218
 Site-MNIST                         | Val  Loss: 1.6463 | Val  Acc: 0.6786
 Site-MNIST                         | Val  Loss: 1.6648 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.6026 | Val  Acc: 0.6508
 Site-MNIST                         | Val  Loss: 1.6546 | Val  Acc: 0.6263
 Site-MNIST                         | Val  Loss: 1.6325 | Val  Acc: 0.6596
 Site-USPS                          | Val  Loss: 1.5773 | Val  Acc: 0.6923
 Site-USPS                          | Val  Loss: 1.5837 | Val  Acc: 0.6282
 Site-USPS                          | Val  Loss: 1.5106 | Val  Acc: 0.6154
 Site-SynthDigits                   | Val  Loss: 2.1500 | Val  Acc: 0.3485
 Site-SynthDigits                   | Val  Loss: 2.0902 | Val  Acc: 0.2879
 Site-MNIST-M                       | Val  Loss: 2.1884 | Val  Acc: 0.3523
 Site-MNIST-M                       | Val  Loss: 2.2199 | Val  Acc: 0.2652
 Site-SVHN                          | Val  Loss: 2.2017 | Val  Acc: 0.1849
Average Valid Accuracy: 0.5120
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.6786
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.6508
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.6263
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.6596
 Best site-USPS                      | Epoch:36 | Val Acc: 0.6923
 Best site-USPS                      | Epoch:36 | Val Acc: 0.6282
 Best site-USPS                      | Epoch:36 | Val Acc: 0.6154
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.3485
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.2879
 Best site-MNIST-M                   | Epoch:36 | Val Acc: 0.3523
 Best site-MNIST-M                   | Epoch:36 | Val Acc: 0.2652
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.1849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 1.5705 | Train Acc: 0.7067
 Site-MNIST                         | Train Loss: 1.6003 | Train Acc: 0.6923
 Site-MNIST                         | Train Loss: 1.6417 | Train Acc: 0.6252
 Site-MNIST                         | Train Loss: 1.6006 | Train Acc: 0.6399
 Site-MNIST                         | Train Loss: 1.5882 | Train Acc: 0.6524
 Site-USPS                          | Train Loss: 1.5158 | Train Acc: 0.6403
 Site-USPS                          | Train Loss: 1.5115 | Train Acc: 0.6773
 Site-USPS                          | Train Loss: 1.4769 | Train Acc: 0.6954
 Site-SynthDigits                   | Train Loss: 2.0873 | Train Acc: 0.3220
 Site-SynthDigits                   | Train Loss: 2.0601 | Train Acc: 0.3687
 Site-MNIST-M                       | Train Loss: 2.1939 | Train Acc: 0.2983
 Site-MNIST-M                       | Train Loss: 2.1976 | Train Acc: 0.2614
 Site-SVHN                          | Train Loss: 2.1977 | Train Acc: 0.2555
Average Train Accuracy: 0.5258
 Site-MNIST                         | Val  Loss: 1.6335 | Val  Acc: 0.6786
 Site-MNIST                         | Val  Loss: 1.6523 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.5900 | Val  Acc: 0.6587
 Site-MNIST                         | Val  Loss: 1.6426 | Val  Acc: 0.6421
 Site-MNIST                         | Val  Loss: 1.6201 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 1.5635 | Val  Acc: 0.6923
 Site-USPS                          | Val  Loss: 1.5703 | Val  Acc: 0.6282
 Site-USPS                          | Val  Loss: 1.4973 | Val  Acc: 0.6154
 Site-SynthDigits                   | Val  Loss: 2.1465 | Val  Acc: 0.3409
 Site-SynthDigits                   | Val  Loss: 2.0852 | Val  Acc: 0.2929
 Site-MNIST-M                       | Val  Loss: 2.1860 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 2.2175 | Val  Acc: 0.2727
 Site-SVHN                          | Val  Loss: 2.1999 | Val  Acc: 0.1849
Average Valid Accuracy: 0.5157
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.6786
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.6587
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.6421
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:37 | Val Acc: 0.6923
 Best site-USPS                      | Epoch:37 | Val Acc: 0.6282
 Best site-USPS                      | Epoch:37 | Val Acc: 0.6154
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.3409
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.2929
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.3636
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.2727
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.1849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 1.5468 | Train Acc: 0.7067
 Site-MNIST                         | Train Loss: 1.5872 | Train Acc: 0.6923
 Site-MNIST                         | Train Loss: 1.6321 | Train Acc: 0.6252
 Site-MNIST                         | Train Loss: 1.5900 | Train Acc: 0.6505
 Site-MNIST                         | Train Loss: 1.5776 | Train Acc: 0.6602
 Site-USPS                          | Train Loss: 1.5120 | Train Acc: 0.6427
 Site-USPS                          | Train Loss: 1.5009 | Train Acc: 0.6853
 Site-USPS                          | Train Loss: 1.4669 | Train Acc: 0.7050
 Site-SynthDigits                   | Train Loss: 2.0864 | Train Acc: 0.3220
 Site-SynthDigits                   | Train Loss: 2.0553 | Train Acc: 0.3687
 Site-MNIST-M                       | Train Loss: 2.1905 | Train Acc: 0.2983
 Site-MNIST-M                       | Train Loss: 2.2021 | Train Acc: 0.2557
 Site-SVHN                          | Train Loss: 2.1879 | Train Acc: 0.2521
Average Train Accuracy: 0.5281
 Site-MNIST                         | Val  Loss: 1.6229 | Val  Acc: 0.6786
 Site-MNIST                         | Val  Loss: 1.6414 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.5788 | Val  Acc: 0.6587
 Site-MNIST                         | Val  Loss: 1.6317 | Val  Acc: 0.6421
 Site-MNIST                         | Val  Loss: 1.6095 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 1.5514 | Val  Acc: 0.7115
 Site-USPS                          | Val  Loss: 1.5584 | Val  Acc: 0.6474
 Site-USPS                          | Val  Loss: 1.4852 | Val  Acc: 0.6282
 Site-SynthDigits                   | Val  Loss: 2.1421 | Val  Acc: 0.3409
 Site-SynthDigits                   | Val  Loss: 2.0806 | Val  Acc: 0.2929
 Site-MNIST-M                       | Val  Loss: 2.1821 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 2.2139 | Val  Acc: 0.2652
 Site-SVHN                          | Val  Loss: 2.1986 | Val  Acc: 0.1712
Average Valid Accuracy: 0.5180
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.6786
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.6587
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.6421
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:38 | Val Acc: 0.7115
 Best site-USPS                      | Epoch:38 | Val Acc: 0.6474
 Best site-USPS                      | Epoch:38 | Val Acc: 0.6282
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.3409
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.2929
 Best site-MNIST-M                   | Epoch:38 | Val Acc: 0.3636
 Best site-MNIST-M                   | Epoch:38 | Val Acc: 0.2652
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.1712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 1.5403 | Train Acc: 0.7244
 Site-MNIST                         | Train Loss: 1.5721 | Train Acc: 0.6982
 Site-MNIST                         | Train Loss: 1.6201 | Train Acc: 0.6292
 Site-MNIST                         | Train Loss: 1.5769 | Train Acc: 0.6570
 Site-MNIST                         | Train Loss: 1.5647 | Train Acc: 0.6646
 Site-USPS                          | Train Loss: 1.4902 | Train Acc: 0.6451
 Site-USPS                          | Train Loss: 1.4869 | Train Acc: 0.6933
 Site-USPS                          | Train Loss: 1.4552 | Train Acc: 0.7029
 Site-SynthDigits                   | Train Loss: 2.0728 | Train Acc: 0.3220
 Site-SynthDigits                   | Train Loss: 2.0482 | Train Acc: 0.3687
 Site-MNIST-M                       | Train Loss: 2.1859 | Train Acc: 0.2955
 Site-MNIST-M                       | Train Loss: 2.1935 | Train Acc: 0.2557
 Site-SVHN                          | Train Loss: 2.1947 | Train Acc: 0.2521
Average Train Accuracy: 0.5314
 Site-MNIST                         | Val  Loss: 1.6104 | Val  Acc: 0.6964
 Site-MNIST                         | Val  Loss: 1.6294 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.5668 | Val  Acc: 0.6587
 Site-MNIST                         | Val  Loss: 1.6205 | Val  Acc: 0.6474
 Site-MNIST                         | Val  Loss: 1.5978 | Val  Acc: 0.6737
 Site-USPS                          | Val  Loss: 1.5363 | Val  Acc: 0.7115
 Site-USPS                          | Val  Loss: 1.5442 | Val  Acc: 0.6474
 Site-USPS                          | Val  Loss: 1.4717 | Val  Acc: 0.6325
 Site-SynthDigits                   | Val  Loss: 2.1392 | Val  Acc: 0.3409
 Site-SynthDigits                   | Val  Loss: 2.0749 | Val  Acc: 0.2929
 Site-MNIST-M                       | Val  Loss: 2.1804 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 2.2117 | Val  Acc: 0.2652
 Site-SVHN                          | Val  Loss: 2.1963 | Val  Acc: 0.1712
Average Valid Accuracy: 0.5206
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.6964
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.6587
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.6474
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.6737
 Best site-USPS                      | Epoch:39 | Val Acc: 0.7115
 Best site-USPS                      | Epoch:39 | Val Acc: 0.6474
 Best site-USPS                      | Epoch:39 | Val Acc: 0.6325
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.3409
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.2929
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.3636
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.2652
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.1712
 Test site-MNIST                     | Epoch:39 | Test Acc: 0.6500
 Test site-USPS                      | Epoch:39 | Test Acc: 0.7151
 Test site-SynthDigits               | Epoch:39 | Test Acc: 0.3341
 Test site-MNIST-M                   | Epoch:39 | Test Acc: 0.2441
 Test site-MNIST-M                   | Epoch:39 | Test Acc: 0.2441
 Test site-SVHN                      | Epoch:39 | Test Acc: 0.2163
MNIST: 0.3794, USPS: 0.7151, SynthDigits: 0.3341, SVHN: 0.2163, 
Average Test Accuracy(group): 0.4112, Average Test Accuracy(individual): 0.5206,
domain std=0.1852, cluster std=-1.0000, individual std=0.1985, 
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 1.5314 | Train Acc: 0.7244
 Site-MNIST                         | Train Loss: 1.5973 | Train Acc: 0.6982
 Site-MNIST                         | Train Loss: 1.6095 | Train Acc: 0.6351
 Site-MNIST                         | Train Loss: 1.5649 | Train Acc: 0.6623
 Site-MNIST                         | Train Loss: 1.5537 | Train Acc: 0.6725
 Site-USPS                          | Train Loss: 1.4662 | Train Acc: 0.6499
 Site-USPS                          | Train Loss: 1.4745 | Train Acc: 0.6933
 Site-USPS                          | Train Loss: 1.4421 | Train Acc: 0.7103
 Site-SynthDigits                   | Train Loss: 2.0785 | Train Acc: 0.3220
 Site-SynthDigits                   | Train Loss: 2.0410 | Train Acc: 0.3775
 Site-MNIST-M                       | Train Loss: 2.1873 | Train Acc: 0.2955
 Site-MNIST-M                       | Train Loss: 2.1937 | Train Acc: 0.2576
 Site-SVHN                          | Train Loss: 2.1939 | Train Acc: 0.2555
Average Train Accuracy: 0.5349
 Site-MNIST                         | Val  Loss: 1.5980 | Val  Acc: 0.7143
 Site-MNIST                         | Val  Loss: 1.6177 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.5550 | Val  Acc: 0.6587
 Site-MNIST                         | Val  Loss: 1.6091 | Val  Acc: 0.6474
 Site-MNIST                         | Val  Loss: 1.5863 | Val  Acc: 0.6737
 Site-USPS                          | Val  Loss: 1.5244 | Val  Acc: 0.7212
 Site-USPS                          | Val  Loss: 1.5328 | Val  Acc: 0.6538
 Site-USPS                          | Val  Loss: 1.4605 | Val  Acc: 0.6325
 Site-SynthDigits                   | Val  Loss: 2.1346 | Val  Acc: 0.3409
 Site-SynthDigits                   | Val  Loss: 2.0696 | Val  Acc: 0.2929
 Site-MNIST-M                       | Val  Loss: 2.1764 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 2.2087 | Val  Acc: 0.2652
 Site-SVHN                          | Val  Loss: 2.1949 | Val  Acc: 0.1781
Average Valid Accuracy: 0.5238
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.7143
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.6587
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.6474
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.6737
 Best site-USPS                      | Epoch:40 | Val Acc: 0.7212
 Best site-USPS                      | Epoch:40 | Val Acc: 0.6538
 Best site-USPS                      | Epoch:40 | Val Acc: 0.6325
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.3409
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.2929
 Best site-MNIST-M                   | Epoch:40 | Val Acc: 0.3636
 Best site-MNIST-M                   | Epoch:40 | Val Acc: 0.2652
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.1781
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 1.5215 | Train Acc: 0.7244
 Site-MNIST                         | Train Loss: 1.5415 | Train Acc: 0.7012
 Site-MNIST                         | Train Loss: 1.6000 | Train Acc: 0.6391
 Site-MNIST                         | Train Loss: 1.5552 | Train Acc: 0.6649
 Site-MNIST                         | Train Loss: 1.5433 | Train Acc: 0.6716
 Site-USPS                          | Train Loss: 1.4577 | Train Acc: 0.6595
 Site-USPS                          | Train Loss: 1.4653 | Train Acc: 0.6981
 Site-USPS                          | Train Loss: 1.4276 | Train Acc: 0.7114
 Site-SynthDigits                   | Train Loss: 2.0663 | Train Acc: 0.3220
 Site-SynthDigits                   | Train Loss: 2.0375 | Train Acc: 0.3788
 Site-MNIST-M                       | Train Loss: 2.1833 | Train Acc: 0.2926
 Site-MNIST-M                       | Train Loss: 2.1845 | Train Acc: 0.2708
 Site-SVHN                          | Train Loss: 2.1829 | Train Acc: 0.2555
Average Train Accuracy: 0.5377
 Site-MNIST                         | Val  Loss: 1.5884 | Val  Acc: 0.6964
 Site-MNIST                         | Val  Loss: 1.6079 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.5449 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.5997 | Val  Acc: 0.6526
 Site-MNIST                         | Val  Loss: 1.5770 | Val  Acc: 0.6772
 Site-USPS                          | Val  Loss: 1.5125 | Val  Acc: 0.7212
 Site-USPS                          | Val  Loss: 1.5208 | Val  Acc: 0.6538
 Site-USPS                          | Val  Loss: 1.4488 | Val  Acc: 0.6496
 Site-SynthDigits                   | Val  Loss: 2.1304 | Val  Acc: 0.3409
 Site-SynthDigits                   | Val  Loss: 2.0638 | Val  Acc: 0.2929
 Site-MNIST-M                       | Val  Loss: 2.1735 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 2.2058 | Val  Acc: 0.2652
 Site-SVHN                          | Val  Loss: 2.1935 | Val  Acc: 0.1781
Average Valid Accuracy: 0.5250
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.6964
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.6526
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.6772
 Best site-USPS                      | Epoch:41 | Val Acc: 0.7212
 Best site-USPS                      | Epoch:41 | Val Acc: 0.6538
 Best site-USPS                      | Epoch:41 | Val Acc: 0.6496
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.3409
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.2929
 Best site-MNIST-M                   | Epoch:41 | Val Acc: 0.3636
 Best site-MNIST-M                   | Epoch:41 | Val Acc: 0.2652
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.1781
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 1.5082 | Train Acc: 0.7244
 Site-MNIST                         | Train Loss: 1.5421 | Train Acc: 0.7041
 Site-MNIST                         | Train Loss: 1.5892 | Train Acc: 0.6450
 Site-MNIST                         | Train Loss: 1.5435 | Train Acc: 0.6728
 Site-MNIST                         | Train Loss: 1.5321 | Train Acc: 0.6760
 Site-USPS                          | Train Loss: 1.4608 | Train Acc: 0.6643
 Site-USPS                          | Train Loss: 1.4482 | Train Acc: 0.6997
 Site-USPS                          | Train Loss: 1.4175 | Train Acc: 0.7157
 Site-SynthDigits                   | Train Loss: 2.0589 | Train Acc: 0.3258
 Site-SynthDigits                   | Train Loss: 2.0321 | Train Acc: 0.3826
 Site-MNIST-M                       | Train Loss: 2.1777 | Train Acc: 0.2955
 Site-MNIST-M                       | Train Loss: 2.1853 | Train Acc: 0.2689
 Site-SVHN                          | Train Loss: 2.1891 | Train Acc: 0.2572
Average Train Accuracy: 0.5409
 Site-MNIST                         | Val  Loss: 1.5757 | Val  Acc: 0.7143
 Site-MNIST                         | Val  Loss: 1.5962 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.5330 | Val  Acc: 0.6746
 Site-MNIST                         | Val  Loss: 1.5880 | Val  Acc: 0.6579
 Site-MNIST                         | Val  Loss: 1.5652 | Val  Acc: 0.6807
 Site-USPS                          | Val  Loss: 1.4997 | Val  Acc: 0.7115
 Site-USPS                          | Val  Loss: 1.5086 | Val  Acc: 0.6474
 Site-USPS                          | Val  Loss: 1.4367 | Val  Acc: 0.6453
 Site-SynthDigits                   | Val  Loss: 2.1267 | Val  Acc: 0.3409
 Site-SynthDigits                   | Val  Loss: 2.0595 | Val  Acc: 0.2980
 Site-MNIST-M                       | Val  Loss: 2.1700 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 2.2029 | Val  Acc: 0.2576
 Site-SVHN                          | Val  Loss: 2.1919 | Val  Acc: 0.1849
Average Valid Accuracy: 0.5264
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.7143
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.6746
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.6579
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.6807
 Best site-USPS                      | Epoch:42 | Val Acc: 0.7115
 Best site-USPS                      | Epoch:42 | Val Acc: 0.6474
 Best site-USPS                      | Epoch:42 | Val Acc: 0.6453
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.3409
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.2980
 Best site-MNIST-M                   | Epoch:42 | Val Acc: 0.3636
 Best site-MNIST-M                   | Epoch:42 | Val Acc: 0.2576
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.1849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 1.4880 | Train Acc: 0.7244
 Site-MNIST                         | Train Loss: 1.5164 | Train Acc: 0.7041
 Site-MNIST                         | Train Loss: 1.5785 | Train Acc: 0.6469
 Site-MNIST                         | Train Loss: 1.5328 | Train Acc: 0.6767
 Site-MNIST                         | Train Loss: 1.5216 | Train Acc: 0.6795
 Site-USPS                          | Train Loss: 1.4484 | Train Acc: 0.6667
 Site-USPS                          | Train Loss: 1.4403 | Train Acc: 0.7029
 Site-USPS                          | Train Loss: 1.4012 | Train Acc: 0.7210
 Site-SynthDigits                   | Train Loss: 2.0604 | Train Acc: 0.3277
 Site-SynthDigits                   | Train Loss: 2.0224 | Train Acc: 0.3838
 Site-MNIST-M                       | Train Loss: 2.1775 | Train Acc: 0.2926
 Site-MNIST-M                       | Train Loss: 2.1904 | Train Acc: 0.2708
 Site-SVHN                          | Train Loss: 2.1817 | Train Acc: 0.2589
Average Train Accuracy: 0.5428
 Site-MNIST                         | Val  Loss: 1.5647 | Val  Acc: 0.7143
 Site-MNIST                         | Val  Loss: 1.5850 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.5217 | Val  Acc: 0.6746
 Site-MNIST                         | Val  Loss: 1.5772 | Val  Acc: 0.6579
 Site-MNIST                         | Val  Loss: 1.5544 | Val  Acc: 0.6807
 Site-USPS                          | Val  Loss: 1.4890 | Val  Acc: 0.7212
 Site-USPS                          | Val  Loss: 1.4983 | Val  Acc: 0.6474
 Site-USPS                          | Val  Loss: 1.4265 | Val  Acc: 0.6453
 Site-SynthDigits                   | Val  Loss: 2.1209 | Val  Acc: 0.3409
 Site-SynthDigits                   | Val  Loss: 2.0552 | Val  Acc: 0.2980
 Site-MNIST-M                       | Val  Loss: 2.1665 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 2.1997 | Val  Acc: 0.2576
 Site-SVHN                          | Val  Loss: 2.1905 | Val  Acc: 0.1849
Average Valid Accuracy: 0.5272
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.7143
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.6746
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.6579
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.6807
 Best site-USPS                      | Epoch:43 | Val Acc: 0.7212
 Best site-USPS                      | Epoch:43 | Val Acc: 0.6474
 Best site-USPS                      | Epoch:43 | Val Acc: 0.6453
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.3409
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.2980
 Best site-MNIST-M                   | Epoch:43 | Val Acc: 0.3636
 Best site-MNIST-M                   | Epoch:43 | Val Acc: 0.2576
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.1849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 1.4968 | Train Acc: 0.7333
 Site-MNIST                         | Train Loss: 1.5227 | Train Acc: 0.7041
 Site-MNIST                         | Train Loss: 1.5692 | Train Acc: 0.6489
 Site-MNIST                         | Train Loss: 1.5231 | Train Acc: 0.6754
 Site-MNIST                         | Train Loss: 1.5109 | Train Acc: 0.6839
 Site-USPS                          | Train Loss: 1.4480 | Train Acc: 0.6763
 Site-USPS                          | Train Loss: 1.4316 | Train Acc: 0.7093
 Site-USPS                          | Train Loss: 1.3917 | Train Acc: 0.7242
 Site-SynthDigits                   | Train Loss: 2.0581 | Train Acc: 0.3333
 Site-SynthDigits                   | Train Loss: 2.0189 | Train Acc: 0.3851
 Site-MNIST-M                       | Train Loss: 2.1760 | Train Acc: 0.2926
 Site-MNIST-M                       | Train Loss: 2.1830 | Train Acc: 0.2708
 Site-SVHN                          | Train Loss: 2.1742 | Train Acc: 0.2589
Average Train Accuracy: 0.5459
 Site-MNIST                         | Val  Loss: 1.5556 | Val  Acc: 0.6964
 Site-MNIST                         | Val  Loss: 1.5752 | Val  Acc: 0.6786
 Site-MNIST                         | Val  Loss: 1.5128 | Val  Acc: 0.6905
 Site-MNIST                         | Val  Loss: 1.5689 | Val  Acc: 0.6632
 Site-MNIST                         | Val  Loss: 1.5456 | Val  Acc: 0.6807
 Site-USPS                          | Val  Loss: 1.4773 | Val  Acc: 0.7212
 Site-USPS                          | Val  Loss: 1.4864 | Val  Acc: 0.6603
 Site-USPS                          | Val  Loss: 1.4154 | Val  Acc: 0.6581
 Site-SynthDigits                   | Val  Loss: 2.1170 | Val  Acc: 0.3485
 Site-SynthDigits                   | Val  Loss: 2.0489 | Val  Acc: 0.3030
 Site-MNIST-M                       | Val  Loss: 2.1640 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 2.1974 | Val  Acc: 0.2576
 Site-SVHN                          | Val  Loss: 2.1890 | Val  Acc: 0.1849
Average Valid Accuracy: 0.5313
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.6964
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.6786
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.6905
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.6632
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.6807
 Best site-USPS                      | Epoch:44 | Val Acc: 0.7212
 Best site-USPS                      | Epoch:44 | Val Acc: 0.6603
 Best site-USPS                      | Epoch:44 | Val Acc: 0.6581
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.3485
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.3030
 Best site-MNIST-M                   | Epoch:44 | Val Acc: 0.3636
 Best site-MNIST-M                   | Epoch:44 | Val Acc: 0.2576
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.1849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 1.4858 | Train Acc: 0.7333
 Site-MNIST                         | Train Loss: 1.5109 | Train Acc: 0.7101
 Site-MNIST                         | Train Loss: 1.5600 | Train Acc: 0.6588
 Site-MNIST                         | Train Loss: 1.5115 | Train Acc: 0.6807
 Site-MNIST                         | Train Loss: 1.5020 | Train Acc: 0.6874
 Site-USPS                          | Train Loss: 1.4212 | Train Acc: 0.6763
 Site-USPS                          | Train Loss: 1.4176 | Train Acc: 0.7157
 Site-USPS                          | Train Loss: 1.3807 | Train Acc: 0.7284
 Site-SynthDigits                   | Train Loss: 2.0474 | Train Acc: 0.3390
 Site-SynthDigits                   | Train Loss: 2.0167 | Train Acc: 0.3876
 Site-MNIST-M                       | Train Loss: 2.1742 | Train Acc: 0.2983
 Site-MNIST-M                       | Train Loss: 2.1782 | Train Acc: 0.2765
 Site-SVHN                          | Train Loss: 2.1664 | Train Acc: 0.2589
Average Train Accuracy: 0.5501
 Site-MNIST                         | Val  Loss: 1.5442 | Val  Acc: 0.7143
 Site-MNIST                         | Val  Loss: 1.5643 | Val  Acc: 0.6905
 Site-MNIST                         | Val  Loss: 1.5022 | Val  Acc: 0.6984
 Site-MNIST                         | Val  Loss: 1.5585 | Val  Acc: 0.6684
 Site-MNIST                         | Val  Loss: 1.5351 | Val  Acc: 0.6877
 Site-USPS                          | Val  Loss: 1.4656 | Val  Acc: 0.7308
 Site-USPS                          | Val  Loss: 1.4751 | Val  Acc: 0.6603
 Site-USPS                          | Val  Loss: 1.4046 | Val  Acc: 0.6581
 Site-SynthDigits                   | Val  Loss: 2.1132 | Val  Acc: 0.3636
 Site-SynthDigits                   | Val  Loss: 2.0438 | Val  Acc: 0.3182
 Site-MNIST-M                       | Val  Loss: 2.1610 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 2.1948 | Val  Acc: 0.2576
 Site-SVHN                          | Val  Loss: 2.1876 | Val  Acc: 0.1849
Average Valid Accuracy: 0.5382
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.7143
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.6905
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.6984
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.6684
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.6877
 Best site-USPS                      | Epoch:45 | Val Acc: 0.7308
 Best site-USPS                      | Epoch:45 | Val Acc: 0.6603
 Best site-USPS                      | Epoch:45 | Val Acc: 0.6581
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.3636
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.3182
 Best site-MNIST-M                   | Epoch:45 | Val Acc: 0.3636
 Best site-MNIST-M                   | Epoch:45 | Val Acc: 0.2576
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.1849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 1.4613 | Train Acc: 0.7333
 Site-MNIST                         | Train Loss: 1.4988 | Train Acc: 0.7189
 Site-MNIST                         | Train Loss: 1.5488 | Train Acc: 0.6686
 Site-MNIST                         | Train Loss: 1.5030 | Train Acc: 0.6859
 Site-MNIST                         | Train Loss: 1.4917 | Train Acc: 0.6909
 Site-USPS                          | Train Loss: 1.4037 | Train Acc: 0.6787
 Site-USPS                          | Train Loss: 1.4040 | Train Acc: 0.7157
 Site-USPS                          | Train Loss: 1.3698 | Train Acc: 0.7338
 Site-SynthDigits                   | Train Loss: 2.0343 | Train Acc: 0.3390
 Site-SynthDigits                   | Train Loss: 2.0068 | Train Acc: 0.3889
 Site-MNIST-M                       | Train Loss: 2.1726 | Train Acc: 0.2983
 Site-MNIST-M                       | Train Loss: 2.1769 | Train Acc: 0.2784
 Site-SVHN                          | Train Loss: 2.1806 | Train Acc: 0.2572
Average Train Accuracy: 0.5529
 Site-MNIST                         | Val  Loss: 1.5340 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.5542 | Val  Acc: 0.7143
 Site-MNIST                         | Val  Loss: 1.4921 | Val  Acc: 0.6984
 Site-MNIST                         | Val  Loss: 1.5487 | Val  Acc: 0.6789
 Site-MNIST                         | Val  Loss: 1.5254 | Val  Acc: 0.6982
 Site-USPS                          | Val  Loss: 1.4540 | Val  Acc: 0.7308
 Site-USPS                          | Val  Loss: 1.4639 | Val  Acc: 0.6603
 Site-USPS                          | Val  Loss: 1.3934 | Val  Acc: 0.6624
 Site-SynthDigits                   | Val  Loss: 2.1092 | Val  Acc: 0.3636
 Site-SynthDigits                   | Val  Loss: 2.0391 | Val  Acc: 0.3182
 Site-MNIST-M                       | Val  Loss: 2.1579 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 2.1919 | Val  Acc: 0.2500
 Site-SVHN                          | Val  Loss: 2.1863 | Val  Acc: 0.1849
Average Valid Accuracy: 0.5441
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.7143
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.6984
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.6789
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.6982
 Best site-USPS                      | Epoch:46 | Val Acc: 0.7308
 Best site-USPS                      | Epoch:46 | Val Acc: 0.6603
 Best site-USPS                      | Epoch:46 | Val Acc: 0.6624
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.3636
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.3182
 Best site-MNIST-M                   | Epoch:46 | Val Acc: 0.3636
 Best site-MNIST-M                   | Epoch:46 | Val Acc: 0.2500
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.1849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 1.4442 | Train Acc: 0.7378
 Site-MNIST                         | Train Loss: 1.4858 | Train Acc: 0.7278
 Site-MNIST                         | Train Loss: 1.5400 | Train Acc: 0.6746
 Site-MNIST                         | Train Loss: 1.4920 | Train Acc: 0.6912
 Site-MNIST                         | Train Loss: 1.4814 | Train Acc: 0.6953
 Site-USPS                          | Train Loss: 1.3861 | Train Acc: 0.6835
 Site-USPS                          | Train Loss: 1.3942 | Train Acc: 0.7157
 Site-USPS                          | Train Loss: 1.3575 | Train Acc: 0.7359
 Site-SynthDigits                   | Train Loss: 2.0448 | Train Acc: 0.3447
 Site-SynthDigits                   | Train Loss: 1.9975 | Train Acc: 0.3914
 Site-MNIST-M                       | Train Loss: 2.1646 | Train Acc: 0.3011
 Site-MNIST-M                       | Train Loss: 2.1711 | Train Acc: 0.2803
 Site-SVHN                          | Train Loss: 2.1741 | Train Acc: 0.2572
Average Train Accuracy: 0.5566
 Site-MNIST                         | Val  Loss: 1.5227 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.5431 | Val  Acc: 0.7262
 Site-MNIST                         | Val  Loss: 1.4815 | Val  Acc: 0.7063
 Site-MNIST                         | Val  Loss: 1.5386 | Val  Acc: 0.6842
 Site-MNIST                         | Val  Loss: 1.5150 | Val  Acc: 0.7088
 Site-USPS                          | Val  Loss: 1.4427 | Val  Acc: 0.7308
 Site-USPS                          | Val  Loss: 1.4529 | Val  Acc: 0.6603
 Site-USPS                          | Val  Loss: 1.3831 | Val  Acc: 0.6667
 Site-SynthDigits                   | Val  Loss: 2.1054 | Val  Acc: 0.3636
 Site-SynthDigits                   | Val  Loss: 2.0341 | Val  Acc: 0.3283
 Site-MNIST-M                       | Val  Loss: 2.1554 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 2.1904 | Val  Acc: 0.2500
 Site-SVHN                          | Val  Loss: 2.1842 | Val  Acc: 0.1849
Average Valid Accuracy: 0.5480
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.7262
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.7063
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.6842
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.7088
 Best site-USPS                      | Epoch:47 | Val Acc: 0.7308
 Best site-USPS                      | Epoch:47 | Val Acc: 0.6603
 Best site-USPS                      | Epoch:47 | Val Acc: 0.6667
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.3636
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.3283
 Best site-MNIST-M                   | Epoch:47 | Val Acc: 0.3636
 Best site-MNIST-M                   | Epoch:47 | Val Acc: 0.2500
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.1849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 1.4294 | Train Acc: 0.7378
 Site-MNIST                         | Train Loss: 1.4920 | Train Acc: 0.7308
 Site-MNIST                         | Train Loss: 1.5309 | Train Acc: 0.6726
 Site-MNIST                         | Train Loss: 1.4826 | Train Acc: 0.6951
 Site-MNIST                         | Train Loss: 1.4715 | Train Acc: 0.6979
 Site-USPS                          | Train Loss: 1.3981 | Train Acc: 0.6835
 Site-USPS                          | Train Loss: 1.3843 | Train Acc: 0.7204
 Site-USPS                          | Train Loss: 1.3479 | Train Acc: 0.7391
 Site-SynthDigits                   | Train Loss: 2.0401 | Train Acc: 0.3485
 Site-SynthDigits                   | Train Loss: 1.9933 | Train Acc: 0.3914
 Site-MNIST-M                       | Train Loss: 2.1664 | Train Acc: 0.3011
 Site-MNIST-M                       | Train Loss: 2.1710 | Train Acc: 0.2822
 Site-SVHN                          | Train Loss: 2.1606 | Train Acc: 0.2555
Average Train Accuracy: 0.5581
 Site-MNIST                         | Val  Loss: 1.5139 | Val  Acc: 0.7321
 Site-MNIST                         | Val  Loss: 1.5343 | Val  Acc: 0.7024
 Site-MNIST                         | Val  Loss: 1.4728 | Val  Acc: 0.6984
 Site-MNIST                         | Val  Loss: 1.5303 | Val  Acc: 0.6842
 Site-MNIST                         | Val  Loss: 1.5067 | Val  Acc: 0.7123
 Site-USPS                          | Val  Loss: 1.4311 | Val  Acc: 0.7308
 Site-USPS                          | Val  Loss: 1.4417 | Val  Acc: 0.6603
 Site-USPS                          | Val  Loss: 1.3726 | Val  Acc: 0.6667
 Site-SynthDigits                   | Val  Loss: 2.1019 | Val  Acc: 0.3712
 Site-SynthDigits                   | Val  Loss: 2.0290 | Val  Acc: 0.3333
 Site-MNIST-M                       | Val  Loss: 2.1532 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 2.1876 | Val  Acc: 0.2500
 Site-SVHN                          | Val  Loss: 2.1827 | Val  Acc: 0.1849
Average Valid Accuracy: 0.5454
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 1.4255 | Train Acc: 0.7378
 Site-MNIST                         | Train Loss: 1.4669 | Train Acc: 0.7308
 Site-MNIST                         | Train Loss: 1.5210 | Train Acc: 0.6785
 Site-MNIST                         | Train Loss: 1.4718 | Train Acc: 0.7017
 Site-MNIST                         | Train Loss: 1.4618 | Train Acc: 0.7014
 Site-USPS                          | Train Loss: 1.3868 | Train Acc: 0.6835
 Site-USPS                          | Train Loss: 1.3698 | Train Acc: 0.7236
 Site-USPS                          | Train Loss: 1.3400 | Train Acc: 0.7412
 Site-SynthDigits                   | Train Loss: 2.0214 | Train Acc: 0.3466
 Site-SynthDigits                   | Train Loss: 1.9943 | Train Acc: 0.3939
 Site-MNIST-M                       | Train Loss: 2.1676 | Train Acc: 0.3011
 Site-MNIST-M                       | Train Loss: 2.1786 | Train Acc: 0.2765
 Site-SVHN                          | Train Loss: 2.1579 | Train Acc: 0.2572
Average Train Accuracy: 0.5595
 Site-MNIST                         | Val  Loss: 1.5026 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.5234 | Val  Acc: 0.7262
 Site-MNIST                         | Val  Loss: 1.4618 | Val  Acc: 0.7063
 Site-MNIST                         | Val  Loss: 1.5198 | Val  Acc: 0.6842
 Site-MNIST                         | Val  Loss: 1.4964 | Val  Acc: 0.7123
 Site-USPS                          | Val  Loss: 1.4215 | Val  Acc: 0.7308
 Site-USPS                          | Val  Loss: 1.4321 | Val  Acc: 0.6603
 Site-USPS                          | Val  Loss: 1.3634 | Val  Acc: 0.6667
 Site-SynthDigits                   | Val  Loss: 2.0980 | Val  Acc: 0.3712
 Site-SynthDigits                   | Val  Loss: 2.0239 | Val  Acc: 0.3333
 Site-MNIST-M                       | Val  Loss: 2.1513 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 2.1856 | Val  Acc: 0.2500
 Site-SVHN                          | Val  Loss: 2.1812 | Val  Acc: 0.1849
Average Valid Accuracy: 0.5492
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.7262
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.7063
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.6842
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.7123
 Best site-USPS                      | Epoch:49 | Val Acc: 0.7308
 Best site-USPS                      | Epoch:49 | Val Acc: 0.6603
 Best site-USPS                      | Epoch:49 | Val Acc: 0.6667
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.3712
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.3333
 Best site-MNIST-M                   | Epoch:49 | Val Acc: 0.3636
 Best site-MNIST-M                   | Epoch:49 | Val Acc: 0.2500
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.1849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/afl...
===2023-06-19 23:38:38===
===2023-06-19 23:38:52===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.6893
 Test site-USPS                      | Epoch:49 | Test Acc: 0.7462
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.3577
 Test site-MNIST-M                   | Epoch:49 | Test Acc: 0.2543
 Test site-MNIST-M                   | Epoch:49 | Test Acc: 0.2543
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.2179
MNIST: 0.3993, USPS: 0.7462, SynthDigits: 0.3577, SVHN: 0.2179, 
Average Test Accuracy(group): 0.4303, Average Test Accuracy(individual): 0.5482,
domain std=0.1944, cluster std=-1.0000, individual std=0.2097, 
