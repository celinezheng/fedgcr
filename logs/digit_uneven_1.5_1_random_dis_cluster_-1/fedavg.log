===2023-06-03 18:53:33===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[451,676,1015,1522,2284,834,1252,1878,1057,1586,704,1057,1174,
client_nums=[5,3,2,2,1,]
len_dataset=[7438,4958,3305,2203,1468,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                    | Train Loss: 2.1889 | Train Acc: 0.4834
 Site-MNIST                    | Train Loss: 2.2030 | Train Acc: 0.4142
 Site-MNIST                    | Train Loss: 2.1982 | Train Acc: 0.4473
 Site-MNIST                    | Train Loss: 2.1998 | Train Acc: 0.4277
 Site-MNIST                    | Train Loss: 2.2017 | Train Acc: 0.4256
 Site-USPS                     | Train Loss: 2.1801 | Train Acc: 0.4976
 Site-USPS                     | Train Loss: 2.1769 | Train Acc: 0.5144
 Site-USPS                     | Train Loss: 2.1801 | Train Acc: 0.4957
 Site-SynthDigits              | Train Loss: 2.2809 | Train Acc: 0.1580
 Site-SynthDigits              | Train Loss: 2.2710 | Train Acc: 0.1917
 Site-MNIST-M                  | Train Loss: 2.2932 | Train Acc: 0.1207
 Site-MNIST-M                  | Train Loss: 2.2933 | Train Acc: 0.1060
 Site-SVHN                     | Train Loss: 2.2887 | Train Acc: 0.1150
 Site-MNIST                         | Val  Loss: 2.1983 | Val  Acc: 0.4196
 Site-MNIST                         | Val  Loss: 2.2028 | Val  Acc: 0.4320
 Site-MNIST                         | Val  Loss: 2.1968 | Val  Acc: 0.4506
 Site-MNIST                         | Val  Loss: 2.2076 | Val  Acc: 0.4053
 Site-MNIST                         | Val  Loss: 2.2042 | Val  Acc: 0.4175
 Site-USPS                          | Val  Loss: 2.1717 | Val  Acc: 0.5288
 Site-USPS                          | Val  Loss: 2.1751 | Val  Acc: 0.5256
 Site-USPS                          | Val  Loss: 2.1793 | Val  Acc: 0.5203
 Site-SynthDigits                   | Val  Loss: 2.2824 | Val  Acc: 0.1591
 Site-SynthDigits                   | Val  Loss: 2.2760 | Val  Acc: 0.1566
 Site-MNIST-M                       | Val  Loss: 2.2938 | Val  Acc: 0.1250
 Site-MNIST-M                       | Val  Loss: 2.2957 | Val  Acc: 0.0947
 Site-SVHN                          | Val  Loss: 2.2865 | Val  Acc: 0.0956
Average Valid Accuracy: 0.3331
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4196
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4320
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4506
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4053
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4175
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5288
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5256
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5203
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1591
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1566
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.1250
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.0947
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.0956
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 1 ============
 Site-MNIST                    | Train Loss: 2.0838 | Train Acc: 0.6098
 Site-MNIST                    | Train Loss: 2.1142 | Train Acc: 0.4837
 Site-MNIST                    | Train Loss: 2.0997 | Train Acc: 0.5143
 Site-MNIST                    | Train Loss: 2.1026 | Train Acc: 0.5230
 Site-MNIST                    | Train Loss: 2.1054 | Train Acc: 0.5166
 Site-USPS                     | Train Loss: 2.0669 | Train Acc: 0.5887
 Site-USPS                     | Train Loss: 2.0545 | Train Acc: 0.6006
 Site-USPS                     | Train Loss: 2.0630 | Train Acc: 0.5974
 Site-SynthDigits              | Train Loss: 2.2498 | Train Acc: 0.2223
 Site-SynthDigits              | Train Loss: 2.2438 | Train Acc: 0.2673
 Site-MNIST-M                  | Train Loss: 2.2798 | Train Acc: 0.1520
 Site-MNIST-M                  | Train Loss: 2.2879 | Train Acc: 0.1334
 Site-SVHN                     | Train Loss: 2.2796 | Train Acc: 0.1388
 Site-MNIST                         | Val  Loss: 2.1000 | Val  Acc: 0.5357
 Site-MNIST                         | Val  Loss: 2.1088 | Val  Acc: 0.5148
 Site-MNIST                         | Val  Loss: 2.0994 | Val  Acc: 0.5296
 Site-MNIST                         | Val  Loss: 2.1187 | Val  Acc: 0.4632
 Site-MNIST                         | Val  Loss: 2.1135 | Val  Acc: 0.4860
 Site-USPS                          | Val  Loss: 2.0443 | Val  Acc: 0.6442
 Site-USPS                          | Val  Loss: 2.0554 | Val  Acc: 0.6154
 Site-USPS                          | Val  Loss: 2.0653 | Val  Acc: 0.5949
 Site-SynthDigits                   | Val  Loss: 2.2558 | Val  Acc: 0.2386
 Site-SynthDigits                   | Val  Loss: 2.2489 | Val  Acc: 0.2348
 Site-MNIST-M                       | Val  Loss: 2.2837 | Val  Acc: 0.1420
 Site-MNIST-M                       | Val  Loss: 2.2841 | Val  Acc: 0.1174
 Site-SVHN                          | Val  Loss: 2.2766 | Val  Acc: 0.1297
Average Valid Accuracy: 0.4036
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5357
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5148
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5296
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.4632
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.4860
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6442
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6154
 Best site-USPS                      | Epoch:1 | Val Acc: 0.5949
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2386
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2348
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.1420
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.1174
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1297
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 2 ============
 Site-MNIST                    | Train Loss: 1.9819 | Train Acc: 0.6319
 Site-MNIST                    | Train Loss: 2.0269 | Train Acc: 0.5281
 Site-MNIST                    | Train Loss: 2.0026 | Train Acc: 0.5409
 Site-MNIST                    | Train Loss: 2.0071 | Train Acc: 0.5460
 Site-MNIST                    | Train Loss: 2.0107 | Train Acc: 0.5539
 Site-USPS                     | Train Loss: 1.9546 | Train Acc: 0.6223
 Site-USPS                     | Train Loss: 1.9485 | Train Acc: 0.6270
 Site-USPS                     | Train Loss: 1.9566 | Train Acc: 0.6299
 Site-SynthDigits              | Train Loss: 2.2230 | Train Acc: 0.2583
 Site-SynthDigits              | Train Loss: 2.2155 | Train Acc: 0.3008
 Site-MNIST-M                  | Train Loss: 2.2662 | Train Acc: 0.1776
 Site-MNIST-M                  | Train Loss: 2.2637 | Train Acc: 0.1599
 Site-SVHN                     | Train Loss: 2.2701 | Train Acc: 0.1661
 Site-MNIST                         | Val  Loss: 2.0083 | Val  Acc: 0.5625
 Site-MNIST                         | Val  Loss: 2.0174 | Val  Acc: 0.5148
 Site-MNIST                         | Val  Loss: 2.0035 | Val  Acc: 0.5336
 Site-MNIST                         | Val  Loss: 2.0299 | Val  Acc: 0.5026
 Site-MNIST                         | Val  Loss: 2.0238 | Val  Acc: 0.5298
 Site-USPS                          | Val  Loss: 1.9296 | Val  Acc: 0.6875
 Site-USPS                          | Val  Loss: 1.9489 | Val  Acc: 0.6538
 Site-USPS                          | Val  Loss: 1.9623 | Val  Acc: 0.6354
 Site-SynthDigits                   | Val  Loss: 2.2280 | Val  Acc: 0.2765
 Site-SynthDigits                   | Val  Loss: 2.2210 | Val  Acc: 0.2828
 Site-MNIST-M                       | Val  Loss: 2.2732 | Val  Acc: 0.1648
 Site-MNIST-M                       | Val  Loss: 2.2729 | Val  Acc: 0.1667
 Site-SVHN                          | Val  Loss: 2.2673 | Val  Acc: 0.1775
Average Valid Accuracy: 0.4376
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5625
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5148
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5336
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5026
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5298
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6875
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6538
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6354
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2765
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2828
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.1648
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.1667
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.1775
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 3 ============
 Site-MNIST                    | Train Loss: 1.8898 | Train Acc: 0.6452
 Site-MNIST                    | Train Loss: 1.9435 | Train Acc: 0.5607
 Site-MNIST                    | Train Loss: 1.9145 | Train Acc: 0.5695
 Site-MNIST                    | Train Loss: 1.9204 | Train Acc: 0.5828
 Site-MNIST                    | Train Loss: 1.9248 | Train Acc: 0.5779
 Site-USPS                     | Train Loss: 1.8580 | Train Acc: 0.6343
 Site-USPS                     | Train Loss: 1.8489 | Train Acc: 0.6597
 Site-USPS                     | Train Loss: 1.8548 | Train Acc: 0.6523
 Site-SynthDigits              | Train Loss: 2.1897 | Train Acc: 0.2886
 Site-SynthDigits              | Train Loss: 2.1881 | Train Acc: 0.3228
 Site-MNIST-M                  | Train Loss: 2.2527 | Train Acc: 0.1974
 Site-MNIST-M                  | Train Loss: 2.2584 | Train Acc: 0.1873
 Site-SVHN                     | Train Loss: 2.2618 | Train Acc: 0.1891
 Site-MNIST                         | Val  Loss: 1.9221 | Val  Acc: 0.5714
 Site-MNIST                         | Val  Loss: 1.9329 | Val  Acc: 0.5325
 Site-MNIST                         | Val  Loss: 1.9160 | Val  Acc: 0.5613
 Site-MNIST                         | Val  Loss: 1.9481 | Val  Acc: 0.5211
 Site-MNIST                         | Val  Loss: 1.9414 | Val  Acc: 0.5614
 Site-USPS                          | Val  Loss: 1.8214 | Val  Acc: 0.6971
 Site-USPS                          | Val  Loss: 1.8470 | Val  Acc: 0.6795
 Site-USPS                          | Val  Loss: 1.8634 | Val  Acc: 0.6525
 Site-SynthDigits                   | Val  Loss: 2.2007 | Val  Acc: 0.3030
 Site-SynthDigits                   | Val  Loss: 2.1936 | Val  Acc: 0.3182
 Site-MNIST-M                       | Val  Loss: 2.2621 | Val  Acc: 0.1818
 Site-MNIST-M                       | Val  Loss: 2.2617 | Val  Acc: 0.1780
 Site-SVHN                          | Val  Loss: 2.2582 | Val  Acc: 0.2116
Average Valid Accuracy: 0.4592
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5714
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5325
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5613
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5211
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5614
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6971
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6795
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6525
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3030
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3182
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.1818
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.1780
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2116
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 4 ============
 Site-MNIST                    | Train Loss: 1.7766 | Train Acc: 0.6785
 Site-MNIST                    | Train Loss: 1.8666 | Train Acc: 0.5843
 Site-MNIST                    | Train Loss: 1.8311 | Train Acc: 0.5901
 Site-MNIST                    | Train Loss: 1.8357 | Train Acc: 0.6097
 Site-MNIST                    | Train Loss: 1.8442 | Train Acc: 0.6121
 Site-USPS                     | Train Loss: 1.7750 | Train Acc: 0.6523
 Site-USPS                     | Train Loss: 1.7514 | Train Acc: 0.6861
 Site-USPS                     | Train Loss: 1.7601 | Train Acc: 0.6741
 Site-SynthDigits              | Train Loss: 2.1766 | Train Acc: 0.3103
 Site-SynthDigits              | Train Loss: 2.1613 | Train Acc: 0.3323
 Site-MNIST-M                  | Train Loss: 2.2397 | Train Acc: 0.2202
 Site-MNIST-M                  | Train Loss: 2.2435 | Train Acc: 0.2100
 Site-SVHN                     | Train Loss: 2.2545 | Train Acc: 0.2036
 Site-MNIST                         | Val  Loss: 1.8430 | Val  Acc: 0.5893
 Site-MNIST                         | Val  Loss: 1.8532 | Val  Acc: 0.5503
 Site-MNIST                         | Val  Loss: 1.8328 | Val  Acc: 0.5929
 Site-MNIST                         | Val  Loss: 1.8700 | Val  Acc: 0.5447
 Site-MNIST                         | Val  Loss: 1.8629 | Val  Acc: 0.5842
 Site-USPS                          | Val  Loss: 1.7226 | Val  Acc: 0.7163
 Site-USPS                          | Val  Loss: 1.7533 | Val  Acc: 0.6859
 Site-USPS                          | Val  Loss: 1.7708 | Val  Acc: 0.6802
 Site-SynthDigits                   | Val  Loss: 2.1745 | Val  Acc: 0.3333
 Site-SynthDigits                   | Val  Loss: 2.1674 | Val  Acc: 0.3434
 Site-MNIST-M                       | Val  Loss: 2.2505 | Val  Acc: 0.2045
 Site-MNIST-M                       | Val  Loss: 2.2509 | Val  Acc: 0.2045
 Site-SVHN                          | Val  Loss: 2.2507 | Val  Acc: 0.2253
Average Valid Accuracy: 0.4811
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5893
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5503
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5929
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5447
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5842
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7163
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6859
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6802
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3333
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3434
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.2045
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.2045
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2253
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 5 ============
 Site-MNIST                    | Train Loss: 1.7334 | Train Acc: 0.6874
 Site-MNIST                    | Train Loss: 1.7952 | Train Acc: 0.6080
 Site-MNIST                    | Train Loss: 1.7545 | Train Acc: 0.6227
 Site-MNIST                    | Train Loss: 1.7591 | Train Acc: 0.6367
 Site-MNIST                    | Train Loss: 1.7654 | Train Acc: 0.6344
 Site-USPS                     | Train Loss: 1.6764 | Train Acc: 0.6643
 Site-USPS                     | Train Loss: 1.6553 | Train Acc: 0.6981
 Site-USPS                     | Train Loss: 1.6717 | Train Acc: 0.6944
 Site-SynthDigits              | Train Loss: 2.1314 | Train Acc: 0.3254
 Site-SynthDigits              | Train Loss: 2.1364 | Train Acc: 0.3405
 Site-MNIST-M                  | Train Loss: 2.2291 | Train Acc: 0.2330
 Site-MNIST-M                  | Train Loss: 2.2395 | Train Acc: 0.2176
 Site-SVHN                     | Train Loss: 2.2471 | Train Acc: 0.2172
 Site-MNIST                         | Val  Loss: 1.7710 | Val  Acc: 0.6250
 Site-MNIST                         | Val  Loss: 1.7795 | Val  Acc: 0.5740
 Site-MNIST                         | Val  Loss: 1.7554 | Val  Acc: 0.6206
 Site-MNIST                         | Val  Loss: 1.7972 | Val  Acc: 0.5711
 Site-MNIST                         | Val  Loss: 1.7903 | Val  Acc: 0.6088
 Site-USPS                          | Val  Loss: 1.6323 | Val  Acc: 0.7115
 Site-USPS                          | Val  Loss: 1.6675 | Val  Acc: 0.6891
 Site-USPS                          | Val  Loss: 1.6859 | Val  Acc: 0.6908
 Site-SynthDigits                   | Val  Loss: 2.1503 | Val  Acc: 0.3409
 Site-SynthDigits                   | Val  Loss: 2.1433 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 2.2414 | Val  Acc: 0.2102
 Site-MNIST-M                       | Val  Loss: 2.2417 | Val  Acc: 0.2159
 Site-SVHN                          | Val  Loss: 2.2428 | Val  Acc: 0.2526
Average Valid Accuracy: 0.4980
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.6250
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5740
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.6206
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5711
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.6088
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7115
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6891
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6908
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3409
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3636
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.2102
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.2159
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2526
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 6 ============
 Site-MNIST                    | Train Loss: 1.6623 | Train Acc: 0.7251
 Site-MNIST                    | Train Loss: 1.7326 | Train Acc: 0.6376
 Site-MNIST                    | Train Loss: 1.6814 | Train Acc: 0.6443
 Site-MNIST                    | Train Loss: 1.6888 | Train Acc: 0.6524
 Site-MNIST                    | Train Loss: 1.6963 | Train Acc: 0.6567
 Site-USPS                     | Train Loss: 1.6149 | Train Acc: 0.6775
 Site-USPS                     | Train Loss: 1.5845 | Train Acc: 0.7077
 Site-USPS                     | Train Loss: 1.5950 | Train Acc: 0.7125
 Site-SynthDigits              | Train Loss: 2.1382 | Train Acc: 0.3264
 Site-SynthDigits              | Train Loss: 2.1128 | Train Acc: 0.3518
 Site-MNIST-M                  | Train Loss: 2.2185 | Train Acc: 0.2514
 Site-MNIST-M                  | Train Loss: 2.2168 | Train Acc: 0.2223
 Site-SVHN                     | Train Loss: 2.2407 | Train Acc: 0.2232
 Site-MNIST                         | Val  Loss: 1.7034 | Val  Acc: 0.6250
 Site-MNIST                         | Val  Loss: 1.7121 | Val  Acc: 0.5976
 Site-MNIST                         | Val  Loss: 1.6840 | Val  Acc: 0.6403
 Site-MNIST                         | Val  Loss: 1.7300 | Val  Acc: 0.6079
 Site-MNIST                         | Val  Loss: 1.7230 | Val  Acc: 0.6368
 Site-USPS                          | Val  Loss: 1.5523 | Val  Acc: 0.7212
 Site-USPS                          | Val  Loss: 1.5910 | Val  Acc: 0.6923
 Site-USPS                          | Val  Loss: 1.6106 | Val  Acc: 0.6972
 Site-SynthDigits                   | Val  Loss: 2.1269 | Val  Acc: 0.3561
 Site-SynthDigits                   | Val  Loss: 2.1191 | Val  Acc: 0.3586
 Site-MNIST-M                       | Val  Loss: 2.2309 | Val  Acc: 0.2216
 Site-MNIST-M                       | Val  Loss: 2.2321 | Val  Acc: 0.2386
 Site-SVHN                          | Val  Loss: 2.2360 | Val  Acc: 0.2765
Average Valid Accuracy: 0.5131
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6250
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.5976
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6403
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6079
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6368
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7212
 Best site-USPS                      | Epoch:6 | Val Acc: 0.6923
 Best site-USPS                      | Epoch:6 | Val Acc: 0.6972
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3561
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3586
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.2216
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.2386
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2765
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 7 ============
 Site-MNIST                    | Train Loss: 1.5609 | Train Acc: 0.7428
 Site-MNIST                    | Train Loss: 1.6574 | Train Acc: 0.6538
 Site-MNIST                    | Train Loss: 1.6154 | Train Acc: 0.6768
 Site-MNIST                    | Train Loss: 1.6225 | Train Acc: 0.6643
 Site-MNIST                    | Train Loss: 1.6298 | Train Acc: 0.6830
 Site-USPS                     | Train Loss: 1.5048 | Train Acc: 0.6894
 Site-USPS                     | Train Loss: 1.5212 | Train Acc: 0.7149
 Site-USPS                     | Train Loss: 1.5203 | Train Acc: 0.7247
 Site-SynthDigits              | Train Loss: 2.1046 | Train Acc: 0.3321
 Site-SynthDigits              | Train Loss: 2.0919 | Train Acc: 0.3537
 Site-MNIST-M                  | Train Loss: 2.2089 | Train Acc: 0.2599
 Site-MNIST-M                  | Train Loss: 2.2108 | Train Acc: 0.2318
 Site-SVHN                     | Train Loss: 2.2345 | Train Acc: 0.2342
 Site-MNIST                         | Val  Loss: 1.6411 | Val  Acc: 0.6339
 Site-MNIST                         | Val  Loss: 1.6480 | Val  Acc: 0.6213
 Site-MNIST                         | Val  Loss: 1.6168 | Val  Acc: 0.6640
 Site-MNIST                         | Val  Loss: 1.6664 | Val  Acc: 0.6289
 Site-MNIST                         | Val  Loss: 1.6596 | Val  Acc: 0.6544
 Site-USPS                          | Val  Loss: 1.4771 | Val  Acc: 0.7260
 Site-USPS                          | Val  Loss: 1.5190 | Val  Acc: 0.6891
 Site-USPS                          | Val  Loss: 1.5387 | Val  Acc: 0.7164
 Site-SynthDigits                   | Val  Loss: 2.1059 | Val  Acc: 0.3523
 Site-SynthDigits                   | Val  Loss: 2.0979 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 2.2226 | Val  Acc: 0.2386
 Site-MNIST-M                       | Val  Loss: 2.2237 | Val  Acc: 0.2538
 Site-SVHN                          | Val  Loss: 2.2293 | Val  Acc: 0.2799
Average Valid Accuracy: 0.5248
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6339
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6213
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6640
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6289
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6544
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7260
 Best site-USPS                      | Epoch:7 | Val Acc: 0.6891
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7164
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3523
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3636
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.2386
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.2538
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2799
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 8 ============
 Site-MNIST                    | Train Loss: 1.5263 | Train Acc: 0.7583
 Site-MNIST                    | Train Loss: 1.6107 | Train Acc: 0.6672
 Site-MNIST                    | Train Loss: 1.5564 | Train Acc: 0.6946
 Site-MNIST                    | Train Loss: 1.5620 | Train Acc: 0.6807
 Site-MNIST                    | Train Loss: 1.5684 | Train Acc: 0.6988
 Site-USPS                     | Train Loss: 1.4691 | Train Acc: 0.6978
 Site-USPS                     | Train Loss: 1.4487 | Train Acc: 0.7316
 Site-USPS                     | Train Loss: 1.4563 | Train Acc: 0.7359
 Site-SynthDigits              | Train Loss: 2.0910 | Train Acc: 0.3359
 Site-SynthDigits              | Train Loss: 2.0696 | Train Acc: 0.3613
 Site-MNIST-M                  | Train Loss: 2.1997 | Train Acc: 0.2685
 Site-MNIST-M                  | Train Loss: 2.1968 | Train Acc: 0.2431
 Site-SVHN                     | Train Loss: 2.2293 | Train Acc: 0.2334
 Site-MNIST                         | Val  Loss: 1.5835 | Val  Acc: 0.6339
 Site-MNIST                         | Val  Loss: 1.5911 | Val  Acc: 0.6450
 Site-MNIST                         | Val  Loss: 1.5567 | Val  Acc: 0.7036
 Site-MNIST                         | Val  Loss: 1.6092 | Val  Acc: 0.6526
 Site-MNIST                         | Val  Loss: 1.6029 | Val  Acc: 0.6719
 Site-USPS                          | Val  Loss: 1.4123 | Val  Acc: 0.7308
 Site-USPS                          | Val  Loss: 1.4560 | Val  Acc: 0.7115
 Site-USPS                          | Val  Loss: 1.4761 | Val  Acc: 0.7271
 Site-SynthDigits                   | Val  Loss: 2.0845 | Val  Acc: 0.3598
 Site-SynthDigits                   | Val  Loss: 2.0763 | Val  Acc: 0.3712
 Site-MNIST-M                       | Val  Loss: 2.2132 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.2146 | Val  Acc: 0.2614
 Site-SVHN                          | Val  Loss: 2.2226 | Val  Acc: 0.2799
Average Valid Accuracy: 0.5384
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6339
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6450
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7036
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6526
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6719
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7308
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7115
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7271
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3598
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3712
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.2614
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2799
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 9 ============
 Site-MNIST                    | Train Loss: 1.4414 | Train Acc: 0.7761
 Site-MNIST                    | Train Loss: 1.5631 | Train Acc: 0.6657
 Site-MNIST                    | Train Loss: 1.5033 | Train Acc: 0.6975
 Site-MNIST                    | Train Loss: 1.5113 | Train Acc: 0.6846
 Site-MNIST                    | Train Loss: 1.5154 | Train Acc: 0.7049
 Site-USPS                     | Train Loss: 1.4370 | Train Acc: 0.7002
 Site-USPS                     | Train Loss: 1.4135 | Train Acc: 0.7252
 Site-USPS                     | Train Loss: 1.4190 | Train Acc: 0.7295
 Site-SynthDigits              | Train Loss: 2.0515 | Train Acc: 0.3453
 Site-SynthDigits              | Train Loss: 2.0455 | Train Acc: 0.3701
 Site-MNIST-M                  | Train Loss: 2.1917 | Train Acc: 0.2727
 Site-MNIST-M                  | Train Loss: 2.1914 | Train Acc: 0.2526
 Site-SVHN                     | Train Loss: 2.2227 | Train Acc: 0.2462
 Site-MNIST                         | Val  Loss: 1.5315 | Val  Acc: 0.6161
 Site-MNIST                         | Val  Loss: 1.5424 | Val  Acc: 0.6331
 Site-MNIST                         | Val  Loss: 1.5040 | Val  Acc: 0.7154
 Site-MNIST                         | Val  Loss: 1.5579 | Val  Acc: 0.6711
 Site-MNIST                         | Val  Loss: 1.5532 | Val  Acc: 0.6684
 Site-USPS                          | Val  Loss: 1.3738 | Val  Acc: 0.7308
 Site-USPS                          | Val  Loss: 1.4176 | Val  Acc: 0.6987
 Site-USPS                          | Val  Loss: 1.4365 | Val  Acc: 0.7164
 Site-SynthDigits                   | Val  Loss: 2.0623 | Val  Acc: 0.3712
 Site-SynthDigits                   | Val  Loss: 2.0537 | Val  Acc: 0.3788
 Site-MNIST-M                       | Val  Loss: 2.2036 | Val  Acc: 0.2443
 Site-MNIST-M                       | Val  Loss: 2.2068 | Val  Acc: 0.2652
 Site-SVHN                          | Val  Loss: 2.2155 | Val  Acc: 0.2901
Average Valid Accuracy: 0.5384
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6161
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6331
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7154
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6711
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6684
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7308
 Best site-USPS                      | Epoch:9 | Val Acc: 0.6987
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7164
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3712
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3788
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.2443
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.2652
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2901
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
 Test site-MNIST                     | Epoch:9 | Test Acc: 0.6946
 Test site-USPS                      | Epoch:9 | Test Acc: 0.7199
 Test site-SynthDigits               | Epoch:9 | Test Acc: 0.3392
 Test site-MNIST-M                   | Epoch:9 | Test Acc: 0.2466
 Test site-SVHN                      | Epoch:9 | Test Acc: 0.2242
MNIST: 0.695, USPS: 0.720, SynthDigits: 0.339, MNIST-M: 0.247, SVHN: 0.224, 
Average Test Accuracy: 0.4449, domain std=0.2178, cluster std=-1.0000, individual std=0.2092, 
============ Train epoch 10 ============
 Site-MNIST                    | Train Loss: 1.3947 | Train Acc: 0.7938
 Site-MNIST                    | Train Loss: 1.5087 | Train Acc: 0.6790
 Site-MNIST                    | Train Loss: 1.4523 | Train Acc: 0.7172
 Site-MNIST                    | Train Loss: 1.4586 | Train Acc: 0.6997
 Site-MNIST                    | Train Loss: 1.4652 | Train Acc: 0.7242
 Site-USPS                     | Train Loss: 1.3791 | Train Acc: 0.7098
 Site-USPS                     | Train Loss: 1.3574 | Train Acc: 0.7468
 Site-USPS                     | Train Loss: 1.3627 | Train Acc: 0.7481
 Site-SynthDigits              | Train Loss: 2.0482 | Train Acc: 0.3538
 Site-SynthDigits              | Train Loss: 2.0290 | Train Acc: 0.3777
 Site-MNIST-M                  | Train Loss: 2.1835 | Train Acc: 0.2798
 Site-MNIST-M                  | Train Loss: 2.1849 | Train Acc: 0.2621
 Site-SVHN                     | Train Loss: 2.2172 | Train Acc: 0.2513
 Site-MNIST                         | Val  Loss: 1.4814 | Val  Acc: 0.6429
 Site-MNIST                         | Val  Loss: 1.4906 | Val  Acc: 0.6686
 Site-MNIST                         | Val  Loss: 1.4516 | Val  Acc: 0.7352
 Site-MNIST                         | Val  Loss: 1.5075 | Val  Acc: 0.6789
 Site-MNIST                         | Val  Loss: 1.5034 | Val  Acc: 0.6842
 Site-USPS                          | Val  Loss: 1.3153 | Val  Acc: 0.7452
 Site-USPS                          | Val  Loss: 1.3617 | Val  Acc: 0.7179
 Site-USPS                          | Val  Loss: 1.3804 | Val  Acc: 0.7292
 Site-SynthDigits                   | Val  Loss: 2.0437 | Val  Acc: 0.3826
 Site-SynthDigits                   | Val  Loss: 2.0353 | Val  Acc: 0.3838
 Site-MNIST-M                       | Val  Loss: 2.1952 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1994 | Val  Acc: 0.2614
 Site-SVHN                          | Val  Loss: 2.2094 | Val  Acc: 0.2935
Average Valid Accuracy: 0.5518
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6429
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6686
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7352
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6789
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6842
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7452
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7179
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7292
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3826
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3838
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.2614
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2935
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 11 ============
 Site-MNIST                    | Train Loss: 1.3656 | Train Acc: 0.8049
 Site-MNIST                    | Train Loss: 1.4499 | Train Acc: 0.6953
 Site-MNIST                    | Train Loss: 1.4040 | Train Acc: 0.7320
 Site-MNIST                    | Train Loss: 1.4135 | Train Acc: 0.7181
 Site-MNIST                    | Train Loss: 1.4182 | Train Acc: 0.7325
 Site-USPS                     | Train Loss: 1.2971 | Train Acc: 0.7266
 Site-USPS                     | Train Loss: 1.2981 | Train Acc: 0.7548
 Site-USPS                     | Train Loss: 1.3052 | Train Acc: 0.7535
 Site-SynthDigits              | Train Loss: 2.0306 | Train Acc: 0.3567
 Site-SynthDigits              | Train Loss: 2.0119 | Train Acc: 0.3796
 Site-MNIST-M                  | Train Loss: 2.1749 | Train Acc: 0.2869
 Site-MNIST-M                  | Train Loss: 2.1765 | Train Acc: 0.2668
 Site-SVHN                     | Train Loss: 2.2119 | Train Acc: 0.2521
 Site-MNIST                         | Val  Loss: 1.4391 | Val  Acc: 0.6696
 Site-MNIST                         | Val  Loss: 1.4455 | Val  Acc: 0.6864
 Site-MNIST                         | Val  Loss: 1.4037 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.4611 | Val  Acc: 0.6895
 Site-MNIST                         | Val  Loss: 1.4584 | Val  Acc: 0.7000
 Site-USPS                          | Val  Loss: 1.2579 | Val  Acc: 0.7596
 Site-USPS                          | Val  Loss: 1.3074 | Val  Acc: 0.7276
 Site-USPS                          | Val  Loss: 1.3253 | Val  Acc: 0.7441
 Site-SynthDigits                   | Val  Loss: 2.0243 | Val  Acc: 0.3826
 Site-SynthDigits                   | Val  Loss: 2.0170 | Val  Acc: 0.3914
 Site-MNIST-M                       | Val  Loss: 2.1884 | Val  Acc: 0.2670
 Site-MNIST-M                       | Val  Loss: 2.1921 | Val  Acc: 0.2689
 Site-SVHN                          | Val  Loss: 2.2028 | Val  Acc: 0.2969
Average Valid Accuracy: 0.5633
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6696
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6864
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6895
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7000
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7596
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7276
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7441
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3826
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3914
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.2670
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.2689
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2969
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 12 ============
 Site-MNIST                    | Train Loss: 1.3179 | Train Acc: 0.8071
 Site-MNIST                    | Train Loss: 1.4206 | Train Acc: 0.7101
 Site-MNIST                    | Train Loss: 1.3625 | Train Acc: 0.7458
 Site-MNIST                    | Train Loss: 1.3742 | Train Acc: 0.7365
 Site-MNIST                    | Train Loss: 1.3776 | Train Acc: 0.7504
 Site-USPS                     | Train Loss: 1.2375 | Train Acc: 0.7482
 Site-USPS                     | Train Loss: 1.2401 | Train Acc: 0.7756
 Site-USPS                     | Train Loss: 1.2446 | Train Acc: 0.7700
 Site-SynthDigits              | Train Loss: 2.0123 | Train Acc: 0.3586
 Site-SynthDigits              | Train Loss: 1.9935 | Train Acc: 0.3859
 Site-MNIST-M                  | Train Loss: 2.1656 | Train Acc: 0.2898
 Site-MNIST-M                  | Train Loss: 2.1573 | Train Acc: 0.2725
 Site-SVHN                     | Train Loss: 2.2066 | Train Acc: 0.2530
 Site-MNIST                         | Val  Loss: 1.4027 | Val  Acc: 0.6964
 Site-MNIST                         | Val  Loss: 1.4050 | Val  Acc: 0.7160
 Site-MNIST                         | Val  Loss: 1.3608 | Val  Acc: 0.7589
 Site-MNIST                         | Val  Loss: 1.4200 | Val  Acc: 0.7105
 Site-MNIST                         | Val  Loss: 1.4186 | Val  Acc: 0.7123
 Site-USPS                          | Val  Loss: 1.1991 | Val  Acc: 0.7692
 Site-USPS                          | Val  Loss: 1.2525 | Val  Acc: 0.7564
 Site-USPS                          | Val  Loss: 1.2692 | Val  Acc: 0.7719
 Site-SynthDigits                   | Val  Loss: 2.0068 | Val  Acc: 0.3939
 Site-SynthDigits                   | Val  Loss: 2.0002 | Val  Acc: 0.3965
 Site-MNIST-M                       | Val  Loss: 2.1806 | Val  Acc: 0.2727
 Site-MNIST-M                       | Val  Loss: 2.1848 | Val  Acc: 0.2803
 Site-SVHN                          | Val  Loss: 2.1958 | Val  Acc: 0.2969
Average Valid Accuracy: 0.5794
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.6964
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7160
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7589
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7105
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7123
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7692
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7564
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7719
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.3939
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.3965
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.2727
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.2803
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2969
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 13 ============
 Site-MNIST                    | Train Loss: 1.2581 | Train Acc: 0.8071
 Site-MNIST                    | Train Loss: 1.3883 | Train Acc: 0.7130
 Site-MNIST                    | Train Loss: 1.3169 | Train Acc: 0.7567
 Site-MNIST                    | Train Loss: 1.3256 | Train Acc: 0.7497
 Site-MNIST                    | Train Loss: 1.3288 | Train Acc: 0.7601
 Site-USPS                     | Train Loss: 1.2469 | Train Acc: 0.7566
 Site-USPS                     | Train Loss: 1.1932 | Train Acc: 0.7875
 Site-USPS                     | Train Loss: 1.2038 | Train Acc: 0.7726
 Site-SynthDigits              | Train Loss: 2.0010 | Train Acc: 0.3746
 Site-SynthDigits              | Train Loss: 1.9785 | Train Acc: 0.3909
 Site-MNIST-M                  | Train Loss: 2.1590 | Train Acc: 0.2955
 Site-MNIST-M                  | Train Loss: 2.1521 | Train Acc: 0.2725
 Site-SVHN                     | Train Loss: 2.2017 | Train Acc: 0.2572
 Site-MNIST                         | Val  Loss: 1.3578 | Val  Acc: 0.7232
 Site-MNIST                         | Val  Loss: 1.3616 | Val  Acc: 0.7278
 Site-MNIST                         | Val  Loss: 1.3142 | Val  Acc: 0.7628
 Site-MNIST                         | Val  Loss: 1.3738 | Val  Acc: 0.7211
 Site-MNIST                         | Val  Loss: 1.3727 | Val  Acc: 0.7158
 Site-USPS                          | Val  Loss: 1.1584 | Val  Acc: 0.7885
 Site-USPS                          | Val  Loss: 1.2128 | Val  Acc: 0.7756
 Site-USPS                          | Val  Loss: 1.2284 | Val  Acc: 0.7804
 Site-SynthDigits                   | Val  Loss: 1.9913 | Val  Acc: 0.4015
 Site-SynthDigits                   | Val  Loss: 1.9853 | Val  Acc: 0.4116
 Site-MNIST-M                       | Val  Loss: 2.1745 | Val  Acc: 0.2670
 Site-MNIST-M                       | Val  Loss: 2.1796 | Val  Acc: 0.2841
 Site-SVHN                          | Val  Loss: 2.1902 | Val  Acc: 0.3003
Average Valid Accuracy: 0.5892
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7232
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7278
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7628
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7211
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7158
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7885
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7756
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7804
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4015
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4116
 Best site-MNIST-M                   | Epoch:13 | Val Acc: 0.2670
 Best site-MNIST-M                   | Epoch:13 | Val Acc: 0.2841
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3003
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 14 ============
 Site-MNIST                    | Train Loss: 1.2343 | Train Acc: 0.8160
 Site-MNIST                    | Train Loss: 1.3529 | Train Acc: 0.7249
 Site-MNIST                    | Train Loss: 1.2909 | Train Acc: 0.7527
 Site-MNIST                    | Train Loss: 1.3023 | Train Acc: 0.7451
 Site-MNIST                    | Train Loss: 1.3055 | Train Acc: 0.7496
 Site-USPS                     | Train Loss: 1.2107 | Train Acc: 0.7518
 Site-USPS                     | Train Loss: 1.1781 | Train Acc: 0.7748
 Site-USPS                     | Train Loss: 1.1889 | Train Acc: 0.7769
 Site-SynthDigits              | Train Loss: 1.9838 | Train Acc: 0.3832
 Site-SynthDigits              | Train Loss: 1.9582 | Train Acc: 0.4042
 Site-MNIST-M                  | Train Loss: 2.1474 | Train Acc: 0.3082
 Site-MNIST-M                  | Train Loss: 2.1377 | Train Acc: 0.2706
 Site-SVHN                     | Train Loss: 2.1957 | Train Acc: 0.2589
 Site-MNIST                         | Val  Loss: 1.3341 | Val  Acc: 0.7321
 Site-MNIST                         | Val  Loss: 1.3387 | Val  Acc: 0.7160
 Site-MNIST                         | Val  Loss: 1.2895 | Val  Acc: 0.7510
 Site-MNIST                         | Val  Loss: 1.3492 | Val  Acc: 0.7263
 Site-MNIST                         | Val  Loss: 1.3520 | Val  Acc: 0.7281
 Site-USPS                          | Val  Loss: 1.1434 | Val  Acc: 0.7692
 Site-USPS                          | Val  Loss: 1.1976 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 1.2113 | Val  Acc: 0.7719
 Site-SynthDigits                   | Val  Loss: 1.9682 | Val  Acc: 0.4053
 Site-SynthDigits                   | Val  Loss: 1.9626 | Val  Acc: 0.4167
 Site-MNIST-M                       | Val  Loss: 2.1657 | Val  Acc: 0.3011
 Site-MNIST-M                       | Val  Loss: 2.1676 | Val  Acc: 0.2992
 Site-SVHN                          | Val  Loss: 2.1842 | Val  Acc: 0.3038
Average Valid Accuracy: 0.5901
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7321
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7160
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7510
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7263
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7281
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7692
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7719
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.4053
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.4167
 Best site-MNIST-M                   | Epoch:14 | Val Acc: 0.3011
 Best site-MNIST-M                   | Epoch:14 | Val Acc: 0.2992
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3038
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 15 ============
 Site-MNIST                    | Train Loss: 1.2005 | Train Acc: 0.8071
 Site-MNIST                    | Train Loss: 1.3173 | Train Acc: 0.7293
 Site-MNIST                    | Train Loss: 1.2558 | Train Acc: 0.7675
 Site-MNIST                    | Train Loss: 1.2687 | Train Acc: 0.7516
 Site-MNIST                    | Train Loss: 1.2719 | Train Acc: 0.7583
 Site-USPS                     | Train Loss: 1.1439 | Train Acc: 0.7686
 Site-USPS                     | Train Loss: 1.1379 | Train Acc: 0.7979
 Site-USPS                     | Train Loss: 1.1396 | Train Acc: 0.7902
 Site-SynthDigits              | Train Loss: 1.9502 | Train Acc: 0.3898
 Site-SynthDigits              | Train Loss: 1.9395 | Train Acc: 0.4149
 Site-MNIST-M                  | Train Loss: 2.1375 | Train Acc: 0.3097
 Site-MNIST-M                  | Train Loss: 2.1453 | Train Acc: 0.2829
 Site-SVHN                     | Train Loss: 2.1900 | Train Acc: 0.2606
 Site-MNIST                         | Val  Loss: 1.3036 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.3050 | Val  Acc: 0.7456
 Site-MNIST                         | Val  Loss: 1.2530 | Val  Acc: 0.7668
 Site-MNIST                         | Val  Loss: 1.3141 | Val  Acc: 0.7368
 Site-MNIST                         | Val  Loss: 1.3191 | Val  Acc: 0.7351
 Site-USPS                          | Val  Loss: 1.0954 | Val  Acc: 0.7981
 Site-USPS                          | Val  Loss: 1.1528 | Val  Acc: 0.7756
 Site-USPS                          | Val  Loss: 1.1651 | Val  Acc: 0.7953
 Site-SynthDigits                   | Val  Loss: 1.9510 | Val  Acc: 0.4091
 Site-SynthDigits                   | Val  Loss: 1.9460 | Val  Acc: 0.4192
 Site-MNIST-M                       | Val  Loss: 2.1583 | Val  Acc: 0.2841
 Site-MNIST-M                       | Val  Loss: 2.1587 | Val  Acc: 0.3106
 Site-SVHN                          | Val  Loss: 2.1778 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6028
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7456
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7668
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7368
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7351
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7981
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7756
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7953
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4091
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4192
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.2841
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.3106
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3106
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 16 ============
 Site-MNIST                    | Train Loss: 1.1784 | Train Acc: 0.8137
 Site-MNIST                    | Train Loss: 1.3009 | Train Acc: 0.7352
 Site-MNIST                    | Train Loss: 1.2289 | Train Acc: 0.7744
 Site-MNIST                    | Train Loss: 1.2388 | Train Acc: 0.7622
 Site-MNIST                    | Train Loss: 1.2426 | Train Acc: 0.7644
 Site-USPS                     | Train Loss: 1.1470 | Train Acc: 0.7698
 Site-USPS                     | Train Loss: 1.1063 | Train Acc: 0.8003
 Site-USPS                     | Train Loss: 1.1141 | Train Acc: 0.7950
 Site-SynthDigits              | Train Loss: 1.9499 | Train Acc: 0.3936
 Site-SynthDigits              | Train Loss: 1.9220 | Train Acc: 0.4231
 Site-MNIST-M                  | Train Loss: 2.1259 | Train Acc: 0.3097
 Site-MNIST-M                  | Train Loss: 2.1259 | Train Acc: 0.2829
 Site-SVHN                     | Train Loss: 2.1832 | Train Acc: 0.2641
 Site-MNIST                         | Val  Loss: 1.2775 | Val  Acc: 0.7589
 Site-MNIST                         | Val  Loss: 1.2765 | Val  Acc: 0.7337
 Site-MNIST                         | Val  Loss: 1.2230 | Val  Acc: 0.7708
 Site-MNIST                         | Val  Loss: 1.2852 | Val  Acc: 0.7447
 Site-MNIST                         | Val  Loss: 1.2928 | Val  Acc: 0.7404
 Site-USPS                          | Val  Loss: 1.0710 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 1.1308 | Val  Acc: 0.7628
 Site-USPS                          | Val  Loss: 1.1392 | Val  Acc: 0.7846
 Site-SynthDigits                   | Val  Loss: 1.9338 | Val  Acc: 0.4091
 Site-SynthDigits                   | Val  Loss: 1.9292 | Val  Acc: 0.4242
 Site-MNIST-M                       | Val  Loss: 2.1503 | Val  Acc: 0.2784
 Site-MNIST-M                       | Val  Loss: 2.1482 | Val  Acc: 0.3068
 Site-SVHN                          | Val  Loss: 2.1721 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6032
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7589
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7337
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7708
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7447
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7404
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8125
 Best site-USPS                      | Epoch:16 | Val Acc: 0.7628
 Best site-USPS                      | Epoch:16 | Val Acc: 0.7846
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4091
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4242
 Best site-MNIST-M                   | Epoch:16 | Val Acc: 0.2784
 Best site-MNIST-M                   | Epoch:16 | Val Acc: 0.3068
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3140
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 17 ============
 Site-MNIST                    | Train Loss: 1.1805 | Train Acc: 0.8160
 Site-MNIST                    | Train Loss: 1.2936 | Train Acc: 0.7396
 Site-MNIST                    | Train Loss: 1.1984 | Train Acc: 0.7803
 Site-MNIST                    | Train Loss: 1.2131 | Train Acc: 0.7727
 Site-MNIST                    | Train Loss: 1.2121 | Train Acc: 0.7680
 Site-USPS                     | Train Loss: 1.0722 | Train Acc: 0.7890
 Site-USPS                     | Train Loss: 1.0660 | Train Acc: 0.8115
 Site-USPS                     | Train Loss: 1.0730 | Train Acc: 0.8035
 Site-SynthDigits              | Train Loss: 1.8937 | Train Acc: 0.3983
 Site-SynthDigits              | Train Loss: 1.9058 | Train Acc: 0.4262
 Site-MNIST-M                  | Train Loss: 2.1141 | Train Acc: 0.3125
 Site-MNIST-M                  | Train Loss: 2.1186 | Train Acc: 0.2942
 Site-SVHN                     | Train Loss: 2.1758 | Train Acc: 0.2658
 Site-MNIST                         | Val  Loss: 1.2515 | Val  Acc: 0.7679
 Site-MNIST                         | Val  Loss: 1.2494 | Val  Acc: 0.7278
 Site-MNIST                         | Val  Loss: 1.1926 | Val  Acc: 0.7787
 Site-MNIST                         | Val  Loss: 1.2550 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.2656 | Val  Acc: 0.7439
 Site-USPS                          | Val  Loss: 1.0284 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 1.0910 | Val  Acc: 0.7724
 Site-USPS                          | Val  Loss: 1.1002 | Val  Acc: 0.7996
 Site-SynthDigits                   | Val  Loss: 1.9170 | Val  Acc: 0.4129
 Site-SynthDigits                   | Val  Loss: 1.9117 | Val  Acc: 0.4268
 Site-MNIST-M                       | Val  Loss: 2.1411 | Val  Acc: 0.2841
 Site-MNIST-M                       | Val  Loss: 2.1354 | Val  Acc: 0.3182
 Site-SVHN                          | Val  Loss: 2.1642 | Val  Acc: 0.3208
Average Valid Accuracy: 0.6089
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7679
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7278
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7787
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7439
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8125
 Best site-USPS                      | Epoch:17 | Val Acc: 0.7724
 Best site-USPS                      | Epoch:17 | Val Acc: 0.7996
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.4129
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.4268
 Best site-MNIST-M                   | Epoch:17 | Val Acc: 0.2841
 Best site-MNIST-M                   | Epoch:17 | Val Acc: 0.3182
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3208
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 18 ============
 Site-MNIST                    | Train Loss: 1.1389 | Train Acc: 0.8160
 Site-MNIST                    | Train Loss: 1.2344 | Train Acc: 0.7411
 Site-MNIST                    | Train Loss: 1.1677 | Train Acc: 0.7862
 Site-MNIST                    | Train Loss: 1.1851 | Train Acc: 0.7753
 Site-MNIST                    | Train Loss: 1.1817 | Train Acc: 0.7750
 Site-USPS                     | Train Loss: 1.0596 | Train Acc: 0.7914
 Site-USPS                     | Train Loss: 1.0409 | Train Acc: 0.8179
 Site-USPS                     | Train Loss: 1.0329 | Train Acc: 0.8110
 Site-SynthDigits              | Train Loss: 1.9065 | Train Acc: 0.3926
 Site-SynthDigits              | Train Loss: 1.8955 | Train Acc: 0.4300
 Site-MNIST-M                  | Train Loss: 2.1052 | Train Acc: 0.3196
 Site-MNIST-M                  | Train Loss: 2.0890 | Train Acc: 0.3018
 Site-SVHN                     | Train Loss: 2.1715 | Train Acc: 0.2658
 Site-MNIST                         | Val  Loss: 1.2227 | Val  Acc: 0.7589
 Site-MNIST                         | Val  Loss: 1.2152 | Val  Acc: 0.7456
 Site-MNIST                         | Val  Loss: 1.1581 | Val  Acc: 0.7866
 Site-MNIST                         | Val  Loss: 1.2226 | Val  Acc: 0.7526
 Site-MNIST                         | Val  Loss: 1.2332 | Val  Acc: 0.7456
 Site-USPS                          | Val  Loss: 0.9877 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 1.0529 | Val  Acc: 0.7756
 Site-USPS                          | Val  Loss: 1.0609 | Val  Acc: 0.7996
 Site-SynthDigits                   | Val  Loss: 1.9037 | Val  Acc: 0.4129
 Site-SynthDigits                   | Val  Loss: 1.9009 | Val  Acc: 0.4217
 Site-MNIST-M                       | Val  Loss: 2.1339 | Val  Acc: 0.2841
 Site-MNIST-M                       | Val  Loss: 2.1282 | Val  Acc: 0.3258
 Site-SVHN                          | Val  Loss: 2.1597 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6107
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7589
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7456
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7866
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7526
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7456
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8125
 Best site-USPS                      | Epoch:18 | Val Acc: 0.7756
 Best site-USPS                      | Epoch:18 | Val Acc: 0.7996
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4129
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4217
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.2841
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.3258
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3174
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 19 ============
 Site-MNIST                    | Train Loss: 1.0963 | Train Acc: 0.8204
 Site-MNIST                    | Train Loss: 1.2259 | Train Acc: 0.7470
 Site-MNIST                    | Train Loss: 1.1408 | Train Acc: 0.7872
 Site-MNIST                    | Train Loss: 1.1568 | Train Acc: 0.7799
 Site-MNIST                    | Train Loss: 1.1570 | Train Acc: 0.7802
 Site-USPS                     | Train Loss: 1.0402 | Train Acc: 0.7986
 Site-USPS                     | Train Loss: 1.0152 | Train Acc: 0.8179
 Site-USPS                     | Train Loss: 1.0189 | Train Acc: 0.8083
 Site-SynthDigits              | Train Loss: 1.9090 | Train Acc: 0.4021
 Site-SynthDigits              | Train Loss: 1.8799 | Train Acc: 0.4363
 Site-MNIST-M                  | Train Loss: 2.0958 | Train Acc: 0.3281
 Site-MNIST-M                  | Train Loss: 2.0838 | Train Acc: 0.3113
 Site-SVHN                     | Train Loss: 2.1666 | Train Acc: 0.2649
 Site-MNIST                         | Val  Loss: 1.1959 | Val  Acc: 0.7589
 Site-MNIST                         | Val  Loss: 1.1888 | Val  Acc: 0.7515
 Site-MNIST                         | Val  Loss: 1.1312 | Val  Acc: 0.7905
 Site-MNIST                         | Val  Loss: 1.1961 | Val  Acc: 0.7553
 Site-MNIST                         | Val  Loss: 1.2071 | Val  Acc: 0.7491
 Site-USPS                          | Val  Loss: 0.9753 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 1.0409 | Val  Acc: 0.7756
 Site-USPS                          | Val  Loss: 1.0464 | Val  Acc: 0.8038
 Site-SynthDigits                   | Val  Loss: 1.8883 | Val  Acc: 0.4280
 Site-SynthDigits                   | Val  Loss: 1.8859 | Val  Acc: 0.4369
 Site-MNIST-M                       | Val  Loss: 2.1253 | Val  Acc: 0.3068
 Site-MNIST-M                       | Val  Loss: 2.1179 | Val  Acc: 0.3333
 Site-SVHN                          | Val  Loss: 2.1544 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6165
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7589
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7515
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7905
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7553
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7491
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8077
 Best site-USPS                      | Epoch:19 | Val Acc: 0.7756
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8038
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4280
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4369
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.3068
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.3333
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3174
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
 Test site-MNIST                     | Epoch:19 | Test Acc: 0.7772
 Test site-USPS                      | Epoch:19 | Test Acc: 0.8048
 Test site-SynthDigits               | Epoch:19 | Test Acc: 0.4026
 Test site-MNIST-M                   | Epoch:19 | Test Acc: 0.2931
 Test site-SVHN                      | Epoch:19 | Test Acc: 0.2459
MNIST: 0.777, USPS: 0.805, SynthDigits: 0.403, MNIST-M: 0.293, SVHN: 0.246, 
Average Test Accuracy: 0.5047, domain std=0.2394, cluster std=-1.0000, individual std=0.2275, 
============ Train epoch 20 ============
 Site-MNIST                    | Train Loss: 1.0893 | Train Acc: 0.8204
 Site-MNIST                    | Train Loss: 1.2035 | Train Acc: 0.7530
 Site-MNIST                    | Train Loss: 1.1216 | Train Acc: 0.7813
 Site-MNIST                    | Train Loss: 1.1369 | Train Acc: 0.7799
 Site-MNIST                    | Train Loss: 1.1369 | Train Acc: 0.7820
 Site-USPS                     | Train Loss: 1.0185 | Train Acc: 0.7986
 Site-USPS                     | Train Loss: 1.0062 | Train Acc: 0.8187
 Site-USPS                     | Train Loss: 1.0082 | Train Acc: 0.8072
 Site-SynthDigits              | Train Loss: 1.9018 | Train Acc: 0.4021
 Site-SynthDigits              | Train Loss: 1.8627 | Train Acc: 0.4401
 Site-MNIST-M                  | Train Loss: 2.0832 | Train Acc: 0.3324
 Site-MNIST-M                  | Train Loss: 2.0706 | Train Acc: 0.3141
 Site-SVHN                     | Train Loss: 2.1594 | Train Acc: 0.2615
 Site-MNIST                         | Val  Loss: 1.1770 | Val  Acc: 0.7589
 Site-MNIST                         | Val  Loss: 1.1682 | Val  Acc: 0.7337
 Site-MNIST                         | Val  Loss: 1.1108 | Val  Acc: 0.7708
 Site-MNIST                         | Val  Loss: 1.1747 | Val  Acc: 0.7553
 Site-MNIST                         | Val  Loss: 1.1886 | Val  Acc: 0.7561
 Site-USPS                          | Val  Loss: 0.9612 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 1.0290 | Val  Acc: 0.7756
 Site-USPS                          | Val  Loss: 1.0328 | Val  Acc: 0.8038
 Site-SynthDigits                   | Val  Loss: 1.8698 | Val  Acc: 0.4394
 Site-SynthDigits                   | Val  Loss: 1.8658 | Val  Acc: 0.4293
 Site-MNIST-M                       | Val  Loss: 2.1154 | Val  Acc: 0.3068
 Site-MNIST-M                       | Val  Loss: 2.1045 | Val  Acc: 0.3333
 Site-SVHN                          | Val  Loss: 2.1478 | Val  Acc: 0.3072
Average Valid Accuracy: 0.6141
============ Train epoch 21 ============
 Site-MNIST                    | Train Loss: 1.0353 | Train Acc: 0.8204
 Site-MNIST                    | Train Loss: 1.1702 | Train Acc: 0.7559
 Site-MNIST                    | Train Loss: 1.0930 | Train Acc: 0.7872
 Site-MNIST                    | Train Loss: 1.1088 | Train Acc: 0.7825
 Site-MNIST                    | Train Loss: 1.1084 | Train Acc: 0.7842
 Site-USPS                     | Train Loss: 0.9955 | Train Acc: 0.8082
 Site-USPS                     | Train Loss: 0.9531 | Train Acc: 0.8235
 Site-USPS                     | Train Loss: 0.9693 | Train Acc: 0.8190
 Site-SynthDigits              | Train Loss: 1.8471 | Train Acc: 0.4096
 Site-SynthDigits              | Train Loss: 1.8513 | Train Acc: 0.4414
 Site-MNIST-M                  | Train Loss: 2.0748 | Train Acc: 0.3366
 Site-MNIST-M                  | Train Loss: 2.0610 | Train Acc: 0.3179
 Site-SVHN                     | Train Loss: 2.1552 | Train Acc: 0.2641
 Site-MNIST                         | Val  Loss: 1.1493 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.1392 | Val  Acc: 0.7337
 Site-MNIST                         | Val  Loss: 1.0822 | Val  Acc: 0.7945
 Site-MNIST                         | Val  Loss: 1.1464 | Val  Acc: 0.7658
 Site-MNIST                         | Val  Loss: 1.1613 | Val  Acc: 0.7561
 Site-USPS                          | Val  Loss: 0.9224 | Val  Acc: 0.8173
 Site-USPS                          | Val  Loss: 0.9914 | Val  Acc: 0.7821
 Site-USPS                          | Val  Loss: 0.9963 | Val  Acc: 0.8102
 Site-SynthDigits                   | Val  Loss: 1.8574 | Val  Acc: 0.4545
 Site-SynthDigits                   | Val  Loss: 1.8528 | Val  Acc: 0.4343
 Site-MNIST-M                       | Val  Loss: 2.1074 | Val  Acc: 0.3295
 Site-MNIST-M                       | Val  Loss: 2.0964 | Val  Acc: 0.3333
 Site-SVHN                          | Val  Loss: 2.1435 | Val  Acc: 0.3072
Average Valid Accuracy: 0.6207
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7337
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7945
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7658
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7561
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8173
 Best site-USPS                      | Epoch:21 | Val Acc: 0.7821
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8102
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.4545
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.4343
 Best site-MNIST-M                   | Epoch:21 | Val Acc: 0.3295
 Best site-MNIST-M                   | Epoch:21 | Val Acc: 0.3333
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.3072
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 22 ============
 Site-MNIST                    | Train Loss: 1.0423 | Train Acc: 0.8248
 Site-MNIST                    | Train Loss: 1.1565 | Train Acc: 0.7663
 Site-MNIST                    | Train Loss: 1.0713 | Train Acc: 0.7970
 Site-MNIST                    | Train Loss: 1.0883 | Train Acc: 0.7852
 Site-MNIST                    | Train Loss: 1.0866 | Train Acc: 0.7863
 Site-USPS                     | Train Loss: 0.9875 | Train Acc: 0.8094
 Site-USPS                     | Train Loss: 0.9328 | Train Acc: 0.8243
 Site-USPS                     | Train Loss: 0.9452 | Train Acc: 0.8195
 Site-SynthDigits              | Train Loss: 1.8627 | Train Acc: 0.4087
 Site-SynthDigits              | Train Loss: 1.8384 | Train Acc: 0.4451
 Site-MNIST-M                  | Train Loss: 2.0659 | Train Acc: 0.3310
 Site-MNIST-M                  | Train Loss: 2.0562 | Train Acc: 0.3179
 Site-SVHN                     | Train Loss: 2.1490 | Train Acc: 0.2649
 Site-MNIST                         | Val  Loss: 1.1295 | Val  Acc: 0.7589
 Site-MNIST                         | Val  Loss: 1.1170 | Val  Acc: 0.7337
 Site-MNIST                         | Val  Loss: 1.0589 | Val  Acc: 0.7945
 Site-MNIST                         | Val  Loss: 1.1227 | Val  Acc: 0.7737
 Site-MNIST                         | Val  Loss: 1.1392 | Val  Acc: 0.7667
 Site-USPS                          | Val  Loss: 0.9010 | Val  Acc: 0.8221
 Site-USPS                          | Val  Loss: 0.9708 | Val  Acc: 0.7853
 Site-USPS                          | Val  Loss: 0.9727 | Val  Acc: 0.8102
 Site-SynthDigits                   | Val  Loss: 1.8425 | Val  Acc: 0.4545
 Site-SynthDigits                   | Val  Loss: 1.8402 | Val  Acc: 0.4293
 Site-MNIST-M                       | Val  Loss: 2.1002 | Val  Acc: 0.3068
 Site-MNIST-M                       | Val  Loss: 2.0882 | Val  Acc: 0.3409
 Site-SVHN                          | Val  Loss: 2.1383 | Val  Acc: 0.3003
Average Valid Accuracy: 0.6213
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7589
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7337
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7945
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7737
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7667
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8221
 Best site-USPS                      | Epoch:22 | Val Acc: 0.7853
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8102
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.4545
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.4293
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.3068
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.3409
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.3003
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 23 ============
 Site-MNIST                    | Train Loss: 1.0722 | Train Acc: 0.8204
 Site-MNIST                    | Train Loss: 1.1351 | Train Acc: 0.7663
 Site-MNIST                    | Train Loss: 1.0551 | Train Acc: 0.8000
 Site-MNIST                    | Train Loss: 1.0722 | Train Acc: 0.7845
 Site-MNIST                    | Train Loss: 1.0716 | Train Acc: 0.7859
 Site-USPS                     | Train Loss: 0.9438 | Train Acc: 0.8165
 Site-USPS                     | Train Loss: 0.9289 | Train Acc: 0.8323
 Site-USPS                     | Train Loss: 0.9175 | Train Acc: 0.8227
 Site-SynthDigits              | Train Loss: 1.8440 | Train Acc: 0.4115
 Site-SynthDigits              | Train Loss: 1.8163 | Train Acc: 0.4508
 Site-MNIST-M                  | Train Loss: 2.0530 | Train Acc: 0.3452
 Site-MNIST-M                  | Train Loss: 2.0435 | Train Acc: 0.3283
 Site-SVHN                     | Train Loss: 2.1415 | Train Acc: 0.2692
 Site-MNIST                         | Val  Loss: 1.1139 | Val  Acc: 0.7679
 Site-MNIST                         | Val  Loss: 1.1005 | Val  Acc: 0.7456
 Site-MNIST                         | Val  Loss: 1.0426 | Val  Acc: 0.7984
 Site-MNIST                         | Val  Loss: 1.1058 | Val  Acc: 0.7842
 Site-MNIST                         | Val  Loss: 1.1255 | Val  Acc: 0.7667
 Site-USPS                          | Val  Loss: 0.8713 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.9426 | Val  Acc: 0.7885
 Site-USPS                          | Val  Loss: 0.9447 | Val  Acc: 0.8124
 Site-SynthDigits                   | Val  Loss: 1.8226 | Val  Acc: 0.4583
 Site-SynthDigits                   | Val  Loss: 1.8191 | Val  Acc: 0.4293
 Site-MNIST-M                       | Val  Loss: 2.0930 | Val  Acc: 0.3125
 Site-MNIST-M                       | Val  Loss: 2.0748 | Val  Acc: 0.3598
 Site-SVHN                          | Val  Loss: 2.1293 | Val  Acc: 0.3038
Average Valid Accuracy: 0.6272
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7679
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7456
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7984
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7842
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7667
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:23 | Val Acc: 0.7885
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8124
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.4583
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.4293
 Best site-MNIST-M                   | Epoch:23 | Val Acc: 0.3125
 Best site-MNIST-M                   | Epoch:23 | Val Acc: 0.3598
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.3038
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 24 ============
 Site-MNIST                    | Train Loss: 0.9739 | Train Acc: 0.8226
 Site-MNIST                    | Train Loss: 1.1289 | Train Acc: 0.7737
 Site-MNIST                    | Train Loss: 1.0328 | Train Acc: 0.8069
 Site-MNIST                    | Train Loss: 1.0501 | Train Acc: 0.7943
 Site-MNIST                    | Train Loss: 1.0476 | Train Acc: 0.7942
 Site-USPS                     | Train Loss: 0.8771 | Train Acc: 0.8369
 Site-USPS                     | Train Loss: 0.8690 | Train Acc: 0.8411
 Site-USPS                     | Train Loss: 0.8656 | Train Acc: 0.8397
 Site-SynthDigits              | Train Loss: 1.8417 | Train Acc: 0.4229
 Site-SynthDigits              | Train Loss: 1.8054 | Train Acc: 0.4502
 Site-MNIST-M                  | Train Loss: 2.0454 | Train Acc: 0.3509
 Site-MNIST-M                  | Train Loss: 2.0520 | Train Acc: 0.3311
 Site-SVHN                     | Train Loss: 2.1352 | Train Acc: 0.2760
 Site-MNIST                         | Val  Loss: 1.0942 | Val  Acc: 0.7946
 Site-MNIST                         | Val  Loss: 1.0790 | Val  Acc: 0.7515
 Site-MNIST                         | Val  Loss: 1.0185 | Val  Acc: 0.8024
 Site-MNIST                         | Val  Loss: 1.0803 | Val  Acc: 0.7842
 Site-MNIST                         | Val  Loss: 1.1027 | Val  Acc: 0.7702
 Site-USPS                          | Val  Loss: 0.8238 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.8954 | Val  Acc: 0.7981
 Site-USPS                          | Val  Loss: 0.8981 | Val  Acc: 0.8401
 Site-SynthDigits                   | Val  Loss: 1.8098 | Val  Acc: 0.4773
 Site-SynthDigits                   | Val  Loss: 1.8065 | Val  Acc: 0.4520
 Site-MNIST-M                       | Val  Loss: 2.0903 | Val  Acc: 0.3068
 Site-MNIST-M                       | Val  Loss: 2.0657 | Val  Acc: 0.3598
 Site-SVHN                          | Val  Loss: 2.1241 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6380
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7946
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7515
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8024
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7842
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7702
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8462
 Best site-USPS                      | Epoch:24 | Val Acc: 0.7981
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8401
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.4773
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.4520
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.3068
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.3598
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3106
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 25 ============
 Site-MNIST                    | Train Loss: 0.9766 | Train Acc: 0.8271
 Site-MNIST                    | Train Loss: 1.0838 | Train Acc: 0.7766
 Site-MNIST                    | Train Loss: 1.0058 | Train Acc: 0.8118
 Site-MNIST                    | Train Loss: 1.0223 | Train Acc: 0.7976
 Site-MNIST                    | Train Loss: 1.0257 | Train Acc: 0.7968
 Site-USPS                     | Train Loss: 0.9071 | Train Acc: 0.8261
 Site-USPS                     | Train Loss: 0.8673 | Train Acc: 0.8387
 Site-USPS                     | Train Loss: 0.8686 | Train Acc: 0.8349
 Site-SynthDigits              | Train Loss: 1.8272 | Train Acc: 0.4295
 Site-SynthDigits              | Train Loss: 1.7952 | Train Acc: 0.4552
 Site-MNIST-M                  | Train Loss: 2.0386 | Train Acc: 0.3494
 Site-MNIST-M                  | Train Loss: 1.9884 | Train Acc: 0.3349
 Site-SVHN                     | Train Loss: 2.1313 | Train Acc: 0.2777
 Site-MNIST                         | Val  Loss: 1.0664 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.0508 | Val  Acc: 0.7692
 Site-MNIST                         | Val  Loss: 0.9912 | Val  Acc: 0.8103
 Site-MNIST                         | Val  Loss: 1.0544 | Val  Acc: 0.7842
 Site-MNIST                         | Val  Loss: 1.0750 | Val  Acc: 0.7754
 Site-USPS                          | Val  Loss: 0.8263 | Val  Acc: 0.8413
 Site-USPS                          | Val  Loss: 0.8982 | Val  Acc: 0.7917
 Site-USPS                          | Val  Loss: 0.8977 | Val  Acc: 0.8273
 Site-SynthDigits                   | Val  Loss: 1.7988 | Val  Acc: 0.4962
 Site-SynthDigits                   | Val  Loss: 1.7978 | Val  Acc: 0.4672
 Site-MNIST-M                       | Val  Loss: 2.0822 | Val  Acc: 0.3182
 Site-MNIST-M                       | Val  Loss: 2.0604 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 2.1193 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6424
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7692
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8103
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7842
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7754
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8413
 Best site-USPS                      | Epoch:25 | Val Acc: 0.7917
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8273
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.4962
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.4672
 Best site-MNIST-M                   | Epoch:25 | Val Acc: 0.3182
 Best site-MNIST-M                   | Epoch:25 | Val Acc: 0.3561
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.3106
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 26 ============
 Site-MNIST                    | Train Loss: 0.9334 | Train Acc: 0.8248
 Site-MNIST                    | Train Loss: 1.0638 | Train Acc: 0.7840
 Site-MNIST                    | Train Loss: 0.9827 | Train Acc: 0.8177
 Site-MNIST                    | Train Loss: 0.9998 | Train Acc: 0.8055
 Site-MNIST                    | Train Loss: 1.0012 | Train Acc: 0.8017
 Site-USPS                     | Train Loss: 0.9211 | Train Acc: 0.8285
 Site-USPS                     | Train Loss: 0.8585 | Train Acc: 0.8395
 Site-USPS                     | Train Loss: 0.8516 | Train Acc: 0.8371
 Site-SynthDigits              | Train Loss: 1.7773 | Train Acc: 0.4305
 Site-SynthDigits              | Train Loss: 1.7839 | Train Acc: 0.4578
 Site-MNIST-M                  | Train Loss: 2.0314 | Train Acc: 0.3494
 Site-MNIST-M                  | Train Loss: 2.0454 | Train Acc: 0.3387
 Site-SVHN                     | Train Loss: 2.1256 | Train Acc: 0.2777
 Site-MNIST                         | Val  Loss: 1.0460 | Val  Acc: 0.7946
 Site-MNIST                         | Val  Loss: 1.0291 | Val  Acc: 0.7574
 Site-MNIST                         | Val  Loss: 0.9679 | Val  Acc: 0.8103
 Site-MNIST                         | Val  Loss: 1.0304 | Val  Acc: 0.7895
 Site-MNIST                         | Val  Loss: 1.0516 | Val  Acc: 0.7825
 Site-USPS                          | Val  Loss: 0.8098 | Val  Acc: 0.8413
 Site-USPS                          | Val  Loss: 0.8817 | Val  Acc: 0.7917
 Site-USPS                          | Val  Loss: 0.8800 | Val  Acc: 0.8273
 Site-SynthDigits                   | Val  Loss: 1.7858 | Val  Acc: 0.4924
 Site-SynthDigits                   | Val  Loss: 1.7865 | Val  Acc: 0.4621
 Site-MNIST-M                       | Val  Loss: 2.0777 | Val  Acc: 0.3182
 Site-MNIST-M                       | Val  Loss: 2.0528 | Val  Acc: 0.3523
 Site-SVHN                          | Val  Loss: 2.1143 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6408
============ Train epoch 27 ============
 Site-MNIST                    | Train Loss: 0.9748 | Train Acc: 0.8315
 Site-MNIST                    | Train Loss: 1.0546 | Train Acc: 0.7899
 Site-MNIST                    | Train Loss: 0.9694 | Train Acc: 0.8158
 Site-MNIST                    | Train Loss: 0.9853 | Train Acc: 0.8029
 Site-MNIST                    | Train Loss: 0.9898 | Train Acc: 0.8012
 Site-USPS                     | Train Loss: 0.8796 | Train Acc: 0.8309
 Site-USPS                     | Train Loss: 0.8362 | Train Acc: 0.8371
 Site-USPS                     | Train Loss: 0.8500 | Train Acc: 0.8296
 Site-SynthDigits              | Train Loss: 1.8010 | Train Acc: 0.4324
 Site-SynthDigits              | Train Loss: 1.7676 | Train Acc: 0.4578
 Site-MNIST-M                  | Train Loss: 2.0201 | Train Acc: 0.3509
 Site-MNIST-M                  | Train Loss: 2.0263 | Train Acc: 0.3415
 Site-SVHN                     | Train Loss: 2.1175 | Train Acc: 0.2836
 Site-MNIST                         | Val  Loss: 1.0358 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.0142 | Val  Acc: 0.7633
 Site-MNIST                         | Val  Loss: 0.9522 | Val  Acc: 0.8063
 Site-MNIST                         | Val  Loss: 1.0152 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 1.0377 | Val  Acc: 0.7895
 Site-USPS                          | Val  Loss: 0.8076 | Val  Acc: 0.8317
 Site-USPS                          | Val  Loss: 0.8798 | Val  Acc: 0.7949
 Site-USPS                          | Val  Loss: 0.8748 | Val  Acc: 0.8337
 Site-SynthDigits                   | Val  Loss: 1.7680 | Val  Acc: 0.4886
 Site-SynthDigits                   | Val  Loss: 1.7724 | Val  Acc: 0.4672
 Site-MNIST-M                       | Val  Loss: 2.0693 | Val  Acc: 0.3182
 Site-MNIST-M                       | Val  Loss: 2.0420 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 2.1065 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6436
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.7633
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8063
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.7895
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8317
 Best site-USPS                      | Epoch:27 | Val Acc: 0.7949
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8337
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.4886
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.4672
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.3182
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.3561
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.3140
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 28 ============
 Site-MNIST                    | Train Loss: 0.9013 | Train Acc: 0.8315
 Site-MNIST                    | Train Loss: 1.0267 | Train Acc: 0.7944
 Site-MNIST                    | Train Loss: 0.9479 | Train Acc: 0.8207
 Site-MNIST                    | Train Loss: 0.9631 | Train Acc: 0.8095
 Site-MNIST                    | Train Loss: 0.9608 | Train Acc: 0.8034
 Site-USPS                     | Train Loss: 0.8684 | Train Acc: 0.8309
 Site-USPS                     | Train Loss: 0.8286 | Train Acc: 0.8339
 Site-USPS                     | Train Loss: 0.8319 | Train Acc: 0.8328
 Site-SynthDigits              | Train Loss: 1.7824 | Train Acc: 0.4352
 Site-SynthDigits              | Train Loss: 1.7562 | Train Acc: 0.4628
 Site-MNIST-M                  | Train Loss: 2.0147 | Train Acc: 0.3494
 Site-MNIST-M                  | Train Loss: 2.0142 | Train Acc: 0.3434
 Site-SVHN                     | Train Loss: 2.1141 | Train Acc: 0.2836
 Site-MNIST                         | Val  Loss: 1.0097 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 0.9919 | Val  Acc: 0.7811
 Site-MNIST                         | Val  Loss: 0.9303 | Val  Acc: 0.8142
 Site-MNIST                         | Val  Loss: 0.9923 | Val  Acc: 0.7947
 Site-MNIST                         | Val  Loss: 1.0151 | Val  Acc: 0.7895
 Site-USPS                          | Val  Loss: 0.7930 | Val  Acc: 0.8317
 Site-USPS                          | Val  Loss: 0.8653 | Val  Acc: 0.7917
 Site-USPS                          | Val  Loss: 0.8590 | Val  Acc: 0.8294
 Site-SynthDigits                   | Val  Loss: 1.7574 | Val  Acc: 0.4962
 Site-SynthDigits                   | Val  Loss: 1.7614 | Val  Acc: 0.4646
 Site-MNIST-M                       | Val  Loss: 2.0668 | Val  Acc: 0.3182
 Site-MNIST-M                       | Val  Loss: 2.0358 | Val  Acc: 0.3485
 Site-SVHN                          | Val  Loss: 2.1009 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6444
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.7811
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.8142
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.7947
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.7895
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8317
 Best site-USPS                      | Epoch:28 | Val Acc: 0.7917
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8294
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.4962
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.4646
 Best site-MNIST-M                   | Epoch:28 | Val Acc: 0.3182
 Best site-MNIST-M                   | Epoch:28 | Val Acc: 0.3485
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.3140
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 29 ============
 Site-MNIST                    | Train Loss: 0.8761 | Train Acc: 0.8204
 Site-MNIST                    | Train Loss: 1.0266 | Train Acc: 0.8018
 Site-MNIST                    | Train Loss: 0.9322 | Train Acc: 0.8276
 Site-MNIST                    | Train Loss: 0.9482 | Train Acc: 0.8160
 Site-MNIST                    | Train Loss: 0.9489 | Train Acc: 0.8074
 Site-USPS                     | Train Loss: 0.8422 | Train Acc: 0.8345
 Site-USPS                     | Train Loss: 0.8165 | Train Acc: 0.8403
 Site-USPS                     | Train Loss: 0.8091 | Train Acc: 0.8344
 Site-SynthDigits              | Train Loss: 1.7929 | Train Acc: 0.4352
 Site-SynthDigits              | Train Loss: 1.7524 | Train Acc: 0.4723
 Site-MNIST-M                  | Train Loss: 2.0106 | Train Acc: 0.3452
 Site-MNIST-M                  | Train Loss: 2.0094 | Train Acc: 0.3415
 Site-SVHN                     | Train Loss: 2.1108 | Train Acc: 0.2828
 Site-MNIST                         | Val  Loss: 0.9951 | Val  Acc: 0.8304
 Site-MNIST                         | Val  Loss: 0.9754 | Val  Acc: 0.7751
 Site-MNIST                         | Val  Loss: 0.9162 | Val  Acc: 0.8182
 Site-MNIST                         | Val  Loss: 0.9789 | Val  Acc: 0.8053
 Site-MNIST                         | Val  Loss: 0.9995 | Val  Acc: 0.8000
 Site-USPS                          | Val  Loss: 0.7711 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 0.8443 | Val  Acc: 0.7949
 Site-USPS                          | Val  Loss: 0.8359 | Val  Acc: 0.8401
 Site-SynthDigits                   | Val  Loss: 1.7503 | Val  Acc: 0.4962
 Site-SynthDigits                   | Val  Loss: 1.7551 | Val  Acc: 0.4571
 Site-MNIST-M                       | Val  Loss: 2.0594 | Val  Acc: 0.3295
 Site-MNIST-M                       | Val  Loss: 2.0325 | Val  Acc: 0.3485
 Site-SVHN                          | Val  Loss: 2.0981 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6494
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8304
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.7751
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8182
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8053
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8000
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:29 | Val Acc: 0.7949
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8401
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.4962
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.4571
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.3295
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.3485
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3106
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
 Test site-MNIST                     | Epoch:29 | Test Acc: 0.8143
 Test site-USPS                      | Epoch:29 | Test Acc: 0.8312
 Test site-SynthDigits               | Epoch:29 | Test Acc: 0.4487
 Test site-MNIST-M                   | Epoch:29 | Test Acc: 0.3321
 Test site-SVHN                      | Epoch:29 | Test Acc: 0.2619
MNIST: 0.814, USPS: 0.831, SynthDigits: 0.449, MNIST-M: 0.332, SVHN: 0.262, 
Average Test Accuracy: 0.5376, domain std=0.2404, cluster std=-1.0000, individual std=0.2265, 
============ Train epoch 30 ============
 Site-MNIST                    | Train Loss: 0.8738 | Train Acc: 0.8337
 Site-MNIST                    | Train Loss: 0.9734 | Train Acc: 0.7959
 Site-MNIST                    | Train Loss: 0.9045 | Train Acc: 0.8246
 Site-MNIST                    | Train Loss: 0.9234 | Train Acc: 0.8193
 Site-MNIST                    | Train Loss: 0.9243 | Train Acc: 0.8078
 Site-USPS                     | Train Loss: 0.8542 | Train Acc: 0.8369
 Site-USPS                     | Train Loss: 0.8122 | Train Acc: 0.8379
 Site-USPS                     | Train Loss: 0.8136 | Train Acc: 0.8339
 Site-SynthDigits              | Train Loss: 1.7886 | Train Acc: 0.4361
 Site-SynthDigits              | Train Loss: 1.7513 | Train Acc: 0.4704
 Site-MNIST-M                  | Train Loss: 2.0082 | Train Acc: 0.3452
 Site-MNIST-M                  | Train Loss: 2.0164 | Train Acc: 0.3510
 Site-SVHN                     | Train Loss: 2.1134 | Train Acc: 0.2751
 Site-MNIST                         | Val  Loss: 0.9634 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.9475 | Val  Acc: 0.7751
 Site-MNIST                         | Val  Loss: 0.8916 | Val  Acc: 0.8142
 Site-MNIST                         | Val  Loss: 0.9559 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.9724 | Val  Acc: 0.7947
 Site-USPS                          | Val  Loss: 0.7724 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 0.8464 | Val  Acc: 0.7981
 Site-USPS                          | Val  Loss: 0.8358 | Val  Acc: 0.8380
 Site-SynthDigits                   | Val  Loss: 1.7453 | Val  Acc: 0.4886
 Site-SynthDigits                   | Val  Loss: 1.7538 | Val  Acc: 0.4571
 Site-MNIST-M                       | Val  Loss: 2.0525 | Val  Acc: 0.3239
 Site-MNIST-M                       | Val  Loss: 2.0346 | Val  Acc: 0.3485
 Site-SVHN                          | Val  Loss: 2.0996 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6467
============ Train epoch 31 ============
 Site-MNIST                    | Train Loss: 0.8599 | Train Acc: 0.8315
 Site-MNIST                    | Train Loss: 0.9517 | Train Acc: 0.7988
 Site-MNIST                    | Train Loss: 0.8966 | Train Acc: 0.8266
 Site-MNIST                    | Train Loss: 0.9142 | Train Acc: 0.8180
 Site-MNIST                    | Train Loss: 0.9141 | Train Acc: 0.8109
 Site-USPS                     | Train Loss: 0.8152 | Train Acc: 0.8369
 Site-USPS                     | Train Loss: 0.8085 | Train Acc: 0.8435
 Site-USPS                     | Train Loss: 0.7924 | Train Acc: 0.8365
 Site-SynthDigits              | Train Loss: 1.7679 | Train Acc: 0.4418
 Site-SynthDigits              | Train Loss: 1.7345 | Train Acc: 0.4773
 Site-MNIST-M                  | Train Loss: 2.0001 | Train Acc: 0.3565
 Site-MNIST-M                  | Train Loss: 2.0017 | Train Acc: 0.3482
 Site-SVHN                     | Train Loss: 2.1055 | Train Acc: 0.2828
 Site-MNIST                         | Val  Loss: 0.9598 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.9401 | Val  Acc: 0.7811
 Site-MNIST                         | Val  Loss: 0.8825 | Val  Acc: 0.8261
 Site-MNIST                         | Val  Loss: 0.9451 | Val  Acc: 0.8053
 Site-MNIST                         | Val  Loss: 0.9653 | Val  Acc: 0.7965
 Site-USPS                          | Val  Loss: 0.7542 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 0.8267 | Val  Acc: 0.7949
 Site-USPS                          | Val  Loss: 0.8177 | Val  Acc: 0.8380
 Site-SynthDigits                   | Val  Loss: 1.7304 | Val  Acc: 0.5076
 Site-SynthDigits                   | Val  Loss: 1.7395 | Val  Acc: 0.4646
 Site-MNIST-M                       | Val  Loss: 2.0523 | Val  Acc: 0.3352
 Site-MNIST-M                       | Val  Loss: 2.0248 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 2.0923 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6518
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.7811
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8261
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8053
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.7965
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:31 | Val Acc: 0.7949
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8380
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5076
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.4646
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.3352
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.3561
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.3106
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 32 ============
 Site-MNIST                    | Train Loss: 0.8270 | Train Acc: 0.8359
 Site-MNIST                    | Train Loss: 0.9542 | Train Acc: 0.8092
 Site-MNIST                    | Train Loss: 0.8806 | Train Acc: 0.8325
 Site-MNIST                    | Train Loss: 0.8953 | Train Acc: 0.8239
 Site-MNIST                    | Train Loss: 0.8977 | Train Acc: 0.8130
 Site-USPS                     | Train Loss: 0.7985 | Train Acc: 0.8405
 Site-USPS                     | Train Loss: 0.7935 | Train Acc: 0.8435
 Site-USPS                     | Train Loss: 0.7878 | Train Acc: 0.8344
 Site-SynthDigits              | Train Loss: 1.7432 | Train Acc: 0.4409
 Site-SynthDigits              | Train Loss: 1.7225 | Train Acc: 0.4849
 Site-MNIST-M                  | Train Loss: 1.9938 | Train Acc: 0.3480
 Site-MNIST-M                  | Train Loss: 1.9922 | Train Acc: 0.3529
 Site-SVHN                     | Train Loss: 2.0959 | Train Acc: 0.2862
 Site-MNIST                         | Val  Loss: 0.9420 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.9255 | Val  Acc: 0.7811
 Site-MNIST                         | Val  Loss: 0.8668 | Val  Acc: 0.8261
 Site-MNIST                         | Val  Loss: 0.9270 | Val  Acc: 0.8132
 Site-MNIST                         | Val  Loss: 0.9477 | Val  Acc: 0.8070
 Site-USPS                          | Val  Loss: 0.7521 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 0.8250 | Val  Acc: 0.8045
 Site-USPS                          | Val  Loss: 0.8112 | Val  Acc: 0.8443
 Site-SynthDigits                   | Val  Loss: 1.7171 | Val  Acc: 0.5189
 Site-SynthDigits                   | Val  Loss: 1.7260 | Val  Acc: 0.4621
 Site-MNIST-M                       | Val  Loss: 2.0454 | Val  Acc: 0.3182
 Site-MNIST-M                       | Val  Loss: 2.0161 | Val  Acc: 0.3598
 Site-SVHN                          | Val  Loss: 2.0850 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6560
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8393
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.7811
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8261
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8132
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8070
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8045
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8443
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.5189
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.4621
 Best site-MNIST-M                   | Epoch:32 | Val Acc: 0.3182
 Best site-MNIST-M                   | Epoch:32 | Val Acc: 0.3598
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.3174
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 33 ============
 Site-MNIST                    | Train Loss: 0.8103 | Train Acc: 0.8359
 Site-MNIST                    | Train Loss: 0.9255 | Train Acc: 0.8062
 Site-MNIST                    | Train Loss: 0.8689 | Train Acc: 0.8335
 Site-MNIST                    | Train Loss: 0.8864 | Train Acc: 0.8219
 Site-MNIST                    | Train Loss: 0.8857 | Train Acc: 0.8139
 Site-USPS                     | Train Loss: 0.8115 | Train Acc: 0.8453
 Site-USPS                     | Train Loss: 0.7708 | Train Acc: 0.8442
 Site-USPS                     | Train Loss: 0.7619 | Train Acc: 0.8403
 Site-SynthDigits              | Train Loss: 1.7254 | Train Acc: 0.4465
 Site-SynthDigits              | Train Loss: 1.7116 | Train Acc: 0.4836
 Site-MNIST-M                  | Train Loss: 1.9874 | Train Acc: 0.3580
 Site-MNIST-M                  | Train Loss: 1.9617 | Train Acc: 0.3500
 Site-SVHN                     | Train Loss: 2.0937 | Train Acc: 0.2853
 Site-MNIST                         | Val  Loss: 0.9278 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.9128 | Val  Acc: 0.7751
 Site-MNIST                         | Val  Loss: 0.8560 | Val  Acc: 0.8261
 Site-MNIST                         | Val  Loss: 0.9166 | Val  Acc: 0.8132
 Site-MNIST                         | Val  Loss: 0.9365 | Val  Acc: 0.8053
 Site-USPS                          | Val  Loss: 0.7255 | Val  Acc: 0.8413
 Site-USPS                          | Val  Loss: 0.7996 | Val  Acc: 0.8013
 Site-USPS                          | Val  Loss: 0.7860 | Val  Acc: 0.8422
 Site-SynthDigits                   | Val  Loss: 1.7030 | Val  Acc: 0.5152
 Site-SynthDigits                   | Val  Loss: 1.7152 | Val  Acc: 0.4672
 Site-MNIST-M                       | Val  Loss: 2.0417 | Val  Acc: 0.3523
 Site-MNIST-M                       | Val  Loss: 2.0091 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 2.0782 | Val  Acc: 0.3208
Average Valid Accuracy: 0.6581
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8393
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.7751
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8261
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8132
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8053
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8413
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8013
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8422
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.5152
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.4672
 Best site-MNIST-M                   | Epoch:33 | Val Acc: 0.3523
 Best site-MNIST-M                   | Epoch:33 | Val Acc: 0.3561
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.3208
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 34 ============
 Site-MNIST                    | Train Loss: 0.8439 | Train Acc: 0.8404
 Site-MNIST                    | Train Loss: 0.9112 | Train Acc: 0.8077
 Site-MNIST                    | Train Loss: 0.8533 | Train Acc: 0.8365
 Site-MNIST                    | Train Loss: 0.8674 | Train Acc: 0.8239
 Site-MNIST                    | Train Loss: 0.8676 | Train Acc: 0.8161
 Site-USPS                     | Train Loss: 0.8213 | Train Acc: 0.8405
 Site-USPS                     | Train Loss: 0.7774 | Train Acc: 0.8482
 Site-USPS                     | Train Loss: 0.7655 | Train Acc: 0.8371
 Site-SynthDigits              | Train Loss: 1.7117 | Train Acc: 0.4513
 Site-SynthDigits              | Train Loss: 1.7019 | Train Acc: 0.4830
 Site-MNIST-M                  | Train Loss: 1.9825 | Train Acc: 0.3565
 Site-MNIST-M                  | Train Loss: 1.9435 | Train Acc: 0.3586
 Site-SVHN                     | Train Loss: 2.0904 | Train Acc: 0.2845
 Site-MNIST                         | Val  Loss: 0.9146 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.8997 | Val  Acc: 0.7811
 Site-MNIST                         | Val  Loss: 0.8407 | Val  Acc: 0.8300
 Site-MNIST                         | Val  Loss: 0.9009 | Val  Acc: 0.8132
 Site-MNIST                         | Val  Loss: 0.9217 | Val  Acc: 0.8070
 Site-USPS                          | Val  Loss: 0.7285 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 0.8026 | Val  Acc: 0.8173
 Site-USPS                          | Val  Loss: 0.7864 | Val  Acc: 0.8486
 Site-SynthDigits                   | Val  Loss: 1.6952 | Val  Acc: 0.5189
 Site-SynthDigits                   | Val  Loss: 1.7081 | Val  Acc: 0.4747
 Site-MNIST-M                       | Val  Loss: 2.0356 | Val  Acc: 0.3409
 Site-MNIST-M                       | Val  Loss: 2.0049 | Val  Acc: 0.3636
 Site-SVHN                          | Val  Loss: 2.0767 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6611
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.8482
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.7811
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.8300
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.8132
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.8070
 Best site-USPS                      | Epoch:34 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:34 | Val Acc: 0.8173
 Best site-USPS                      | Epoch:34 | Val Acc: 0.8486
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.5189
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.4747
 Best site-MNIST-M                   | Epoch:34 | Val Acc: 0.3409
 Best site-MNIST-M                   | Epoch:34 | Val Acc: 0.3636
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.3140
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 35 ============
 Site-MNIST                    | Train Loss: 0.7876 | Train Acc: 0.8381
 Site-MNIST                    | Train Loss: 0.9078 | Train Acc: 0.8092
 Site-MNIST                    | Train Loss: 0.8369 | Train Acc: 0.8355
 Site-MNIST                    | Train Loss: 0.8547 | Train Acc: 0.8226
 Site-MNIST                    | Train Loss: 0.8568 | Train Acc: 0.8161
 Site-USPS                     | Train Loss: 0.7971 | Train Acc: 0.8405
 Site-USPS                     | Train Loss: 0.7562 | Train Acc: 0.8482
 Site-USPS                     | Train Loss: 0.7598 | Train Acc: 0.8397
 Site-SynthDigits              | Train Loss: 1.7202 | Train Acc: 0.4588
 Site-SynthDigits              | Train Loss: 1.6912 | Train Acc: 0.4842
 Site-MNIST-M                  | Train Loss: 1.9758 | Train Acc: 0.3537
 Site-MNIST-M                  | Train Loss: 1.9654 | Train Acc: 0.3548
 Site-SVHN                     | Train Loss: 2.0883 | Train Acc: 0.2828
 Site-MNIST                         | Val  Loss: 0.8955 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.8820 | Val  Acc: 0.7988
 Site-MNIST                         | Val  Loss: 0.8248 | Val  Acc: 0.8340
 Site-MNIST                         | Val  Loss: 0.8840 | Val  Acc: 0.8105
 Site-MNIST                         | Val  Loss: 0.9049 | Val  Acc: 0.8088
 Site-USPS                          | Val  Loss: 0.7234 | Val  Acc: 0.8317
 Site-USPS                          | Val  Loss: 0.7967 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.7817 | Val  Acc: 0.8465
 Site-SynthDigits                   | Val  Loss: 1.6830 | Val  Acc: 0.5227
 Site-SynthDigits                   | Val  Loss: 1.6971 | Val  Acc: 0.4823
 Site-MNIST-M                       | Val  Loss: 2.0319 | Val  Acc: 0.3409
 Site-MNIST-M                       | Val  Loss: 1.9985 | Val  Acc: 0.3636
 Site-SVHN                          | Val  Loss: 2.0727 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6619
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.8393
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.7988
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.8340
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.8105
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.8088
 Best site-USPS                      | Epoch:35 | Val Acc: 0.8317
 Best site-USPS                      | Epoch:35 | Val Acc: 0.8077
 Best site-USPS                      | Epoch:35 | Val Acc: 0.8465
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.5227
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.4823
 Best site-MNIST-M                   | Epoch:35 | Val Acc: 0.3409
 Best site-MNIST-M                   | Epoch:35 | Val Acc: 0.3636
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.3174
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 36 ============
 Site-MNIST                    | Train Loss: 0.8031 | Train Acc: 0.8293
 Site-MNIST                    | Train Loss: 0.9151 | Train Acc: 0.8062
 Site-MNIST                    | Train Loss: 0.8236 | Train Acc: 0.8394
 Site-MNIST                    | Train Loss: 0.8422 | Train Acc: 0.8246
 Site-MNIST                    | Train Loss: 0.8436 | Train Acc: 0.8179
 Site-USPS                     | Train Loss: 0.7579 | Train Acc: 0.8453
 Site-USPS                     | Train Loss: 0.7624 | Train Acc: 0.8514
 Site-USPS                     | Train Loss: 0.7455 | Train Acc: 0.8387
 Site-SynthDigits              | Train Loss: 1.7245 | Train Acc: 0.4579
 Site-SynthDigits              | Train Loss: 1.6887 | Train Acc: 0.4893
 Site-MNIST-M                  | Train Loss: 1.9679 | Train Acc: 0.3707
 Site-MNIST-M                  | Train Loss: 1.9659 | Train Acc: 0.3623
 Site-SVHN                     | Train Loss: 2.0887 | Train Acc: 0.2802
 Site-MNIST                         | Val  Loss: 0.8801 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.8685 | Val  Acc: 0.7988
 Site-MNIST                         | Val  Loss: 0.8126 | Val  Acc: 0.8379
 Site-MNIST                         | Val  Loss: 0.8740 | Val  Acc: 0.8184
 Site-MNIST                         | Val  Loss: 0.8919 | Val  Acc: 0.8035
 Site-USPS                          | Val  Loss: 0.7093 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 0.7852 | Val  Acc: 0.8109
 Site-USPS                          | Val  Loss: 0.7670 | Val  Acc: 0.8529
 Site-SynthDigits                   | Val  Loss: 1.6783 | Val  Acc: 0.5265
 Site-SynthDigits                   | Val  Loss: 1.6945 | Val  Acc: 0.4798
 Site-MNIST-M                       | Val  Loss: 2.0214 | Val  Acc: 0.3580
 Site-MNIST-M                       | Val  Loss: 1.9942 | Val  Acc: 0.3864
 Site-SVHN                          | Val  Loss: 2.0718 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6668
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.8482
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.7988
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.8379
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.8184
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.8035
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8109
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8529
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.5265
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.4798
 Best site-MNIST-M                   | Epoch:36 | Val Acc: 0.3580
 Best site-MNIST-M                   | Epoch:36 | Val Acc: 0.3864
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.3106
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 37 ============
 Site-MNIST                    | Train Loss: 0.7718 | Train Acc: 0.8315
 Site-MNIST                    | Train Loss: 0.8846 | Train Acc: 0.8166
 Site-MNIST                    | Train Loss: 0.8082 | Train Acc: 0.8443
 Site-MNIST                    | Train Loss: 0.8288 | Train Acc: 0.8265
 Site-MNIST                    | Train Loss: 0.8312 | Train Acc: 0.8201
 Site-USPS                     | Train Loss: 0.7661 | Train Acc: 0.8501
 Site-USPS                     | Train Loss: 0.7253 | Train Acc: 0.8538
 Site-USPS                     | Train Loss: 0.7319 | Train Acc: 0.8419
 Site-SynthDigits              | Train Loss: 1.7051 | Train Acc: 0.4588
 Site-SynthDigits              | Train Loss: 1.6772 | Train Acc: 0.4893
 Site-MNIST-M                  | Train Loss: 1.9625 | Train Acc: 0.3736
 Site-MNIST-M                  | Train Loss: 1.9446 | Train Acc: 0.3642
 Site-SVHN                     | Train Loss: 2.0819 | Train Acc: 0.2828
 Site-MNIST                         | Val  Loss: 0.8659 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.8540 | Val  Acc: 0.7988
 Site-MNIST                         | Val  Loss: 0.7989 | Val  Acc: 0.8379
 Site-MNIST                         | Val  Loss: 0.8603 | Val  Acc: 0.8289
 Site-MNIST                         | Val  Loss: 0.8781 | Val  Acc: 0.8140
 Site-USPS                          | Val  Loss: 0.6969 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.7722 | Val  Acc: 0.8141
 Site-USPS                          | Val  Loss: 0.7541 | Val  Acc: 0.8571
 Site-SynthDigits                   | Val  Loss: 1.6677 | Val  Acc: 0.5265
 Site-SynthDigits                   | Val  Loss: 1.6839 | Val  Acc: 0.4798
 Site-MNIST-M                       | Val  Loss: 2.0185 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 1.9866 | Val  Acc: 0.3902
 Site-SVHN                          | Val  Loss: 2.0655 | Val  Acc: 0.3208
Average Valid Accuracy: 0.6713
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8482
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.7988
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8379
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8289
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8140
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8462
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8141
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8571
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.5265
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.4798
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.3636
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.3902
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.3208
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 38 ============
 Site-MNIST                    | Train Loss: 0.7350 | Train Acc: 0.8337
 Site-MNIST                    | Train Loss: 0.8769 | Train Acc: 0.8225
 Site-MNIST                    | Train Loss: 0.7944 | Train Acc: 0.8502
 Site-MNIST                    | Train Loss: 0.8121 | Train Acc: 0.8298
 Site-MNIST                    | Train Loss: 0.8152 | Train Acc: 0.8244
 Site-USPS                     | Train Loss: 0.7616 | Train Acc: 0.8513
 Site-USPS                     | Train Loss: 0.7191 | Train Acc: 0.8530
 Site-USPS                     | Train Loss: 0.7183 | Train Acc: 0.8424
 Site-SynthDigits              | Train Loss: 1.7147 | Train Acc: 0.4579
 Site-SynthDigits              | Train Loss: 1.6718 | Train Acc: 0.4899
 Site-MNIST-M                  | Train Loss: 1.9618 | Train Acc: 0.3679
 Site-MNIST-M                  | Train Loss: 1.9621 | Train Acc: 0.3718
 Site-SVHN                     | Train Loss: 2.0828 | Train Acc: 0.2811
 Site-MNIST                         | Val  Loss: 0.8459 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.8375 | Val  Acc: 0.8107
 Site-MNIST                         | Val  Loss: 0.7839 | Val  Acc: 0.8617
 Site-MNIST                         | Val  Loss: 0.8431 | Val  Acc: 0.8395
 Site-MNIST                         | Val  Loss: 0.8615 | Val  Acc: 0.8193
 Site-USPS                          | Val  Loss: 0.6852 | Val  Acc: 0.8413
 Site-USPS                          | Val  Loss: 0.7598 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.7424 | Val  Acc: 0.8529
 Site-SynthDigits                   | Val  Loss: 1.6623 | Val  Acc: 0.5265
 Site-SynthDigits                   | Val  Loss: 1.6765 | Val  Acc: 0.4823
 Site-MNIST-M                       | Val  Loss: 2.0181 | Val  Acc: 0.3466
 Site-MNIST-M                       | Val  Loss: 1.9859 | Val  Acc: 0.3788
 Site-SVHN                          | Val  Loss: 2.0650 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6711
============ Train epoch 39 ============
 Site-MNIST                    | Train Loss: 0.7777 | Train Acc: 0.8359
 Site-MNIST                    | Train Loss: 0.8483 | Train Acc: 0.8210
 Site-MNIST                    | Train Loss: 0.7915 | Train Acc: 0.8443
 Site-MNIST                    | Train Loss: 0.8105 | Train Acc: 0.8357
 Site-MNIST                    | Train Loss: 0.8127 | Train Acc: 0.8244
 Site-USPS                     | Train Loss: 0.7310 | Train Acc: 0.8561
 Site-USPS                     | Train Loss: 0.7006 | Train Acc: 0.8530
 Site-USPS                     | Train Loss: 0.6876 | Train Acc: 0.8456
 Site-SynthDigits              | Train Loss: 1.6812 | Train Acc: 0.4645
 Site-SynthDigits              | Train Loss: 1.6549 | Train Acc: 0.5006
 Site-MNIST-M                  | Train Loss: 1.9549 | Train Acc: 0.3693
 Site-MNIST-M                  | Train Loss: 1.9443 | Train Acc: 0.3652
 Site-SVHN                     | Train Loss: 2.0709 | Train Acc: 0.2853
 Site-MNIST                         | Val  Loss: 0.8450 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.8382 | Val  Acc: 0.7988
 Site-MNIST                         | Val  Loss: 0.7818 | Val  Acc: 0.8379
 Site-MNIST                         | Val  Loss: 0.8392 | Val  Acc: 0.8263
 Site-MNIST                         | Val  Loss: 0.8593 | Val  Acc: 0.8175
 Site-USPS                          | Val  Loss: 0.6567 | Val  Acc: 0.8510
 Site-USPS                          | Val  Loss: 0.7313 | Val  Acc: 0.8205
 Site-USPS                          | Val  Loss: 0.7139 | Val  Acc: 0.8571
 Site-SynthDigits                   | Val  Loss: 1.6440 | Val  Acc: 0.5303
 Site-SynthDigits                   | Val  Loss: 1.6596 | Val  Acc: 0.4823
 Site-MNIST-M                       | Val  Loss: 2.0156 | Val  Acc: 0.3580
 Site-MNIST-M                       | Val  Loss: 1.9768 | Val  Acc: 0.3788
 Site-SVHN                          | Val  Loss: 2.0528 | Val  Acc: 0.3208
Average Valid Accuracy: 0.6714
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8482
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.7988
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8379
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8263
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8175
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8510
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8205
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8571
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.5303
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.4823
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.3580
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.3788
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.3208
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
 Test site-MNIST                     | Epoch:39 | Test Acc: 0.8339
 Test site-USPS                      | Epoch:39 | Test Acc: 0.8532
 Test site-SynthDigits               | Epoch:39 | Test Acc: 0.4807
 Test site-MNIST-M                   | Epoch:39 | Test Acc: 0.3566
 Test site-SVHN                      | Epoch:39 | Test Acc: 0.2707
MNIST: 0.834, USPS: 0.853, SynthDigits: 0.481, MNIST-M: 0.357, SVHN: 0.271, 
Average Test Accuracy: 0.5590, domain std=0.2418, cluster std=-1.0000, individual std=0.2258, 
============ Train epoch 40 ============
 Site-MNIST                    | Train Loss: 0.8017 | Train Acc: 0.8381
 Site-MNIST                    | Train Loss: 0.8441 | Train Acc: 0.8225
 Site-MNIST                    | Train Loss: 0.7759 | Train Acc: 0.8473
 Site-MNIST                    | Train Loss: 0.7926 | Train Acc: 0.8318
 Site-MNIST                    | Train Loss: 0.7959 | Train Acc: 0.8249
 Site-USPS                     | Train Loss: 0.7515 | Train Acc: 0.8501
 Site-USPS                     | Train Loss: 0.7227 | Train Acc: 0.8522
 Site-USPS                     | Train Loss: 0.7007 | Train Acc: 0.8445
 Site-SynthDigits              | Train Loss: 1.6587 | Train Acc: 0.4626
 Site-SynthDigits              | Train Loss: 1.6473 | Train Acc: 0.5050
 Site-MNIST-M                  | Train Loss: 1.9470 | Train Acc: 0.3750
 Site-MNIST-M                  | Train Loss: 1.9408 | Train Acc: 0.3680
 Site-SVHN                     | Train Loss: 2.0683 | Train Acc: 0.2896
 Site-MNIST                         | Val  Loss: 0.8292 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.8224 | Val  Acc: 0.7988
 Site-MNIST                         | Val  Loss: 0.7664 | Val  Acc: 0.8458
 Site-MNIST                         | Val  Loss: 0.8231 | Val  Acc: 0.8289
 Site-MNIST                         | Val  Loss: 0.8440 | Val  Acc: 0.8193
 Site-USPS                          | Val  Loss: 0.6678 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.7420 | Val  Acc: 0.8109
 Site-USPS                          | Val  Loss: 0.7230 | Val  Acc: 0.8529
 Site-SynthDigits                   | Val  Loss: 1.6345 | Val  Acc: 0.5265
 Site-SynthDigits                   | Val  Loss: 1.6503 | Val  Acc: 0.4848
 Site-MNIST-M                       | Val  Loss: 2.0101 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 1.9694 | Val  Acc: 0.3826
 Site-SVHN                          | Val  Loss: 2.0493 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6703
============ Train epoch 41 ============
 Site-MNIST                    | Train Loss: 0.7521 | Train Acc: 0.8404
 Site-MNIST                    | Train Loss: 0.8297 | Train Acc: 0.8225
 Site-MNIST                    | Train Loss: 0.7671 | Train Acc: 0.8463
 Site-MNIST                    | Train Loss: 0.7838 | Train Acc: 0.8344
 Site-MNIST                    | Train Loss: 0.7858 | Train Acc: 0.8279
 Site-USPS                     | Train Loss: 0.7283 | Train Acc: 0.8501
 Site-USPS                     | Train Loss: 0.6828 | Train Acc: 0.8538
 Site-USPS                     | Train Loss: 0.6831 | Train Acc: 0.8477
 Site-SynthDigits              | Train Loss: 1.6408 | Train Acc: 0.4683
 Site-SynthDigits              | Train Loss: 1.6351 | Train Acc: 0.5013
 Site-MNIST-M                  | Train Loss: 1.9439 | Train Acc: 0.3764
 Site-MNIST-M                  | Train Loss: 1.9256 | Train Acc: 0.3709
 Site-SVHN                     | Train Loss: 2.0657 | Train Acc: 0.2871
 Site-MNIST                         | Val  Loss: 0.8178 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.8133 | Val  Acc: 0.7929
 Site-MNIST                         | Val  Loss: 0.7568 | Val  Acc: 0.8379
 Site-MNIST                         | Val  Loss: 0.8111 | Val  Acc: 0.8263
 Site-MNIST                         | Val  Loss: 0.8333 | Val  Acc: 0.8193
 Site-USPS                          | Val  Loss: 0.6497 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.7245 | Val  Acc: 0.8109
 Site-USPS                          | Val  Loss: 0.7072 | Val  Acc: 0.8507
 Site-SynthDigits                   | Val  Loss: 1.6270 | Val  Acc: 0.5379
 Site-SynthDigits                   | Val  Loss: 1.6418 | Val  Acc: 0.4899
 Site-MNIST-M                       | Val  Loss: 2.0080 | Val  Acc: 0.3580
 Site-MNIST-M                       | Val  Loss: 1.9653 | Val  Acc: 0.3902
 Site-SVHN                          | Val  Loss: 2.0469 | Val  Acc: 0.3208
Average Valid Accuracy: 0.6708
============ Train epoch 42 ============
 Site-MNIST                    | Train Loss: 0.7230 | Train Acc: 0.8470
 Site-MNIST                    | Train Loss: 0.8197 | Train Acc: 0.8284
 Site-MNIST                    | Train Loss: 0.7498 | Train Acc: 0.8473
 Site-MNIST                    | Train Loss: 0.7684 | Train Acc: 0.8371
 Site-MNIST                    | Train Loss: 0.7674 | Train Acc: 0.8306
 Site-USPS                     | Train Loss: 0.7473 | Train Acc: 0.8477
 Site-USPS                     | Train Loss: 0.6945 | Train Acc: 0.8482
 Site-USPS                     | Train Loss: 0.7025 | Train Acc: 0.8392
 Site-SynthDigits              | Train Loss: 1.6962 | Train Acc: 0.4626
 Site-SynthDigits              | Train Loss: 1.6349 | Train Acc: 0.5025
 Site-MNIST-M                  | Train Loss: 1.9356 | Train Acc: 0.3736
 Site-MNIST-M                  | Train Loss: 1.9370 | Train Acc: 0.3822
 Site-SVHN                     | Train Loss: 2.0664 | Train Acc: 0.2794
 Site-MNIST                         | Val  Loss: 0.8022 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.7944 | Val  Acc: 0.8107
 Site-MNIST                         | Val  Loss: 0.7375 | Val  Acc: 0.8538
 Site-MNIST                         | Val  Loss: 0.7952 | Val  Acc: 0.8395
 Site-MNIST                         | Val  Loss: 0.8164 | Val  Acc: 0.8263
 Site-USPS                          | Val  Loss: 0.6684 | Val  Acc: 0.8317
 Site-USPS                          | Val  Loss: 0.7413 | Val  Acc: 0.8045
 Site-USPS                          | Val  Loss: 0.7206 | Val  Acc: 0.8507
 Site-SynthDigits                   | Val  Loss: 1.6225 | Val  Acc: 0.5303
 Site-SynthDigits                   | Val  Loss: 1.6397 | Val  Acc: 0.4798
 Site-MNIST-M                       | Val  Loss: 1.9996 | Val  Acc: 0.3580
 Site-MNIST-M                       | Val  Loss: 1.9599 | Val  Acc: 0.3826
 Site-SVHN                          | Val  Loss: 2.0472 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6706
============ Train epoch 43 ============
 Site-MNIST                    | Train Loss: 0.7307 | Train Acc: 0.8426
 Site-MNIST                    | Train Loss: 0.8191 | Train Acc: 0.8284
 Site-MNIST                    | Train Loss: 0.7471 | Train Acc: 0.8493
 Site-MNIST                    | Train Loss: 0.7656 | Train Acc: 0.8403
 Site-MNIST                    | Train Loss: 0.7671 | Train Acc: 0.8292
 Site-USPS                     | Train Loss: 0.6959 | Train Acc: 0.8549
 Site-USPS                     | Train Loss: 0.6659 | Train Acc: 0.8546
 Site-USPS                     | Train Loss: 0.6692 | Train Acc: 0.8493
 Site-SynthDigits              | Train Loss: 1.6767 | Train Acc: 0.4636
 Site-SynthDigits              | Train Loss: 1.6207 | Train Acc: 0.5050
 Site-MNIST-M                  | Train Loss: 1.9265 | Train Acc: 0.3920
 Site-MNIST-M                  | Train Loss: 1.9304 | Train Acc: 0.3803
 Site-SVHN                     | Train Loss: 2.0574 | Train Acc: 0.2862
 Site-MNIST                         | Val  Loss: 0.7949 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.7923 | Val  Acc: 0.7988
 Site-MNIST                         | Val  Loss: 0.7353 | Val  Acc: 0.8458
 Site-MNIST                         | Val  Loss: 0.7905 | Val  Acc: 0.8342
 Site-MNIST                         | Val  Loss: 0.8133 | Val  Acc: 0.8281
 Site-USPS                          | Val  Loss: 0.6368 | Val  Acc: 0.8510
 Site-USPS                          | Val  Loss: 0.7114 | Val  Acc: 0.8141
 Site-USPS                          | Val  Loss: 0.6918 | Val  Acc: 0.8571
 Site-SynthDigits                   | Val  Loss: 1.6094 | Val  Acc: 0.5303
 Site-SynthDigits                   | Val  Loss: 1.6239 | Val  Acc: 0.4823
 Site-MNIST-M                       | Val  Loss: 1.9956 | Val  Acc: 0.3864
 Site-MNIST-M                       | Val  Loss: 1.9498 | Val  Acc: 0.4015
 Site-SVHN                          | Val  Loss: 2.0365 | Val  Acc: 0.3072
Average Valid Accuracy: 0.6758
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8482
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.7988
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8458
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8342
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8281
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8510
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8141
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8571
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.5303
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.4823
 Best site-MNIST-M                   | Epoch:43 | Val Acc: 0.3864
 Best site-MNIST-M                   | Epoch:43 | Val Acc: 0.4015
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.3072
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 44 ============
 Site-MNIST                    | Train Loss: 0.6838 | Train Acc: 0.8448
 Site-MNIST                    | Train Loss: 0.7817 | Train Acc: 0.8373
 Site-MNIST                    | Train Loss: 0.7276 | Train Acc: 0.8473
 Site-MNIST                    | Train Loss: 0.7470 | Train Acc: 0.8417
 Site-MNIST                    | Train Loss: 0.7486 | Train Acc: 0.8306
 Site-USPS                     | Train Loss: 0.7111 | Train Acc: 0.8525
 Site-USPS                     | Train Loss: 0.6900 | Train Acc: 0.8506
 Site-USPS                     | Train Loss: 0.6866 | Train Acc: 0.8456
 Site-SynthDigits              | Train Loss: 1.6249 | Train Acc: 0.4740
 Site-SynthDigits              | Train Loss: 1.6149 | Train Acc: 0.5107
 Site-MNIST-M                  | Train Loss: 1.9245 | Train Acc: 0.3892
 Site-MNIST-M                  | Train Loss: 1.9174 | Train Acc: 0.3822
 Site-SVHN                     | Train Loss: 2.0566 | Train Acc: 0.2853
 Site-MNIST                         | Val  Loss: 0.7732 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.7736 | Val  Acc: 0.8107
 Site-MNIST                         | Val  Loss: 0.7186 | Val  Acc: 0.8656
 Site-MNIST                         | Val  Loss: 0.7728 | Val  Acc: 0.8500
 Site-MNIST                         | Val  Loss: 0.7946 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.6556 | Val  Acc: 0.8317
 Site-USPS                          | Val  Loss: 0.7282 | Val  Acc: 0.8109
 Site-USPS                          | Val  Loss: 0.7062 | Val  Acc: 0.8593
 Site-SynthDigits                   | Val  Loss: 1.6001 | Val  Acc: 0.5303
 Site-SynthDigits                   | Val  Loss: 1.6184 | Val  Acc: 0.4975
 Site-MNIST-M                       | Val  Loss: 1.9957 | Val  Acc: 0.3864
 Site-MNIST-M                       | Val  Loss: 1.9493 | Val  Acc: 0.3939
 Site-SVHN                          | Val  Loss: 2.0360 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6787
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8393
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8107
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8656
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8500
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8333
 Best site-USPS                      | Epoch:44 | Val Acc: 0.8317
 Best site-USPS                      | Epoch:44 | Val Acc: 0.8109
 Best site-USPS                      | Epoch:44 | Val Acc: 0.8593
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.5303
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.4975
 Best site-MNIST-M                   | Epoch:44 | Val Acc: 0.3864
 Best site-MNIST-M                   | Epoch:44 | Val Acc: 0.3939
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.3140
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 45 ============
 Site-MNIST                    | Train Loss: 0.6755 | Train Acc: 0.8492
 Site-MNIST                    | Train Loss: 0.8093 | Train Acc: 0.8328
 Site-MNIST                    | Train Loss: 0.7215 | Train Acc: 0.8532
 Site-MNIST                    | Train Loss: 0.7423 | Train Acc: 0.8430
 Site-MNIST                    | Train Loss: 0.7441 | Train Acc: 0.8323
 Site-USPS                     | Train Loss: 0.7386 | Train Acc: 0.8501
 Site-USPS                     | Train Loss: 0.6805 | Train Acc: 0.8546
 Site-USPS                     | Train Loss: 0.6748 | Train Acc: 0.8445
 Site-SynthDigits              | Train Loss: 1.6409 | Train Acc: 0.4655
 Site-SynthDigits              | Train Loss: 1.6040 | Train Acc: 0.5158
 Site-MNIST-M                  | Train Loss: 1.9144 | Train Acc: 0.3991
 Site-MNIST-M                  | Train Loss: 1.8669 | Train Acc: 0.3860
 Site-SVHN                     | Train Loss: 2.0506 | Train Acc: 0.2879
 Site-MNIST                         | Val  Loss: 0.7670 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.7672 | Val  Acc: 0.8166
 Site-MNIST                         | Val  Loss: 0.7110 | Val  Acc: 0.8656
 Site-MNIST                         | Val  Loss: 0.7665 | Val  Acc: 0.8474
 Site-MNIST                         | Val  Loss: 0.7883 | Val  Acc: 0.8316
 Site-USPS                          | Val  Loss: 0.6418 | Val  Acc: 0.8413
 Site-USPS                          | Val  Loss: 0.7156 | Val  Acc: 0.8109
 Site-USPS                          | Val  Loss: 0.6926 | Val  Acc: 0.8529
 Site-SynthDigits                   | Val  Loss: 1.5921 | Val  Acc: 0.5189
 Site-SynthDigits                   | Val  Loss: 1.6080 | Val  Acc: 0.4874
 Site-MNIST-M                       | Val  Loss: 1.9850 | Val  Acc: 0.3920
 Site-MNIST-M                       | Val  Loss: 1.9388 | Val  Acc: 0.4129
 Site-SVHN                          | Val  Loss: 2.0292 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6797
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.8482
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.8166
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.8656
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.8474
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.8316
 Best site-USPS                      | Epoch:45 | Val Acc: 0.8413
 Best site-USPS                      | Epoch:45 | Val Acc: 0.8109
 Best site-USPS                      | Epoch:45 | Val Acc: 0.8529
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.5189
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.4874
 Best site-MNIST-M                   | Epoch:45 | Val Acc: 0.3920
 Best site-MNIST-M                   | Epoch:45 | Val Acc: 0.4129
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.3106
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 46 ============
 Site-MNIST                    | Train Loss: 0.6762 | Train Acc: 0.8404
 Site-MNIST                    | Train Loss: 0.7876 | Train Acc: 0.8314
 Site-MNIST                    | Train Loss: 0.7080 | Train Acc: 0.8552
 Site-MNIST                    | Train Loss: 0.7256 | Train Acc: 0.8443
 Site-MNIST                    | Train Loss: 0.7282 | Train Acc: 0.8310
 Site-USPS                     | Train Loss: 0.7059 | Train Acc: 0.8489
 Site-USPS                     | Train Loss: 0.6772 | Train Acc: 0.8498
 Site-USPS                     | Train Loss: 0.6782 | Train Acc: 0.8403
 Site-SynthDigits              | Train Loss: 1.6401 | Train Acc: 0.4674
 Site-SynthDigits              | Train Loss: 1.6103 | Train Acc: 0.5088
 Site-MNIST-M                  | Train Loss: 1.9143 | Train Acc: 0.4006
 Site-MNIST-M                  | Train Loss: 1.8990 | Train Acc: 0.3869
 Site-SVHN                     | Train Loss: 2.0634 | Train Acc: 0.2785
 Site-MNIST                         | Val  Loss: 0.7516 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.7514 | Val  Acc: 0.8284
 Site-MNIST                         | Val  Loss: 0.6982 | Val  Acc: 0.8696
 Site-MNIST                         | Val  Loss: 0.7554 | Val  Acc: 0.8447
 Site-MNIST                         | Val  Loss: 0.7739 | Val  Acc: 0.8298
 Site-USPS                          | Val  Loss: 0.6468 | Val  Acc: 0.8510
 Site-USPS                          | Val  Loss: 0.7200 | Val  Acc: 0.8237
 Site-USPS                          | Val  Loss: 0.6965 | Val  Acc: 0.8529
 Site-SynthDigits                   | Val  Loss: 1.5939 | Val  Acc: 0.5265
 Site-SynthDigits                   | Val  Loss: 1.6154 | Val  Acc: 0.4949
 Site-MNIST-M                       | Val  Loss: 1.9869 | Val  Acc: 0.3750
 Site-MNIST-M                       | Val  Loss: 1.9406 | Val  Acc: 0.3939
 Site-SVHN                          | Val  Loss: 2.0398 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6807
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.8482
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.8284
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.8696
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.8447
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.8298
 Best site-USPS                      | Epoch:46 | Val Acc: 0.8510
 Best site-USPS                      | Epoch:46 | Val Acc: 0.8237
 Best site-USPS                      | Epoch:46 | Val Acc: 0.8529
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.5265
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.4949
 Best site-MNIST-M                   | Epoch:46 | Val Acc: 0.3750
 Best site-MNIST-M                   | Epoch:46 | Val Acc: 0.3939
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.3106
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 47 ============
 Site-MNIST                    | Train Loss: 0.6829 | Train Acc: 0.8448
 Site-MNIST                    | Train Loss: 0.7816 | Train Acc: 0.8373
 Site-MNIST                    | Train Loss: 0.7098 | Train Acc: 0.8532
 Site-MNIST                    | Train Loss: 0.7293 | Train Acc: 0.8410
 Site-MNIST                    | Train Loss: 0.7348 | Train Acc: 0.8424
 Site-USPS                     | Train Loss: 0.6571 | Train Acc: 0.8657
 Site-USPS                     | Train Loss: 0.6300 | Train Acc: 0.8650
 Site-USPS                     | Train Loss: 0.6208 | Train Acc: 0.8637
 Site-SynthDigits              | Train Loss: 1.6308 | Train Acc: 0.4730
 Site-SynthDigits              | Train Loss: 1.5936 | Train Acc: 0.5164
 Site-MNIST-M                  | Train Loss: 1.9183 | Train Acc: 0.3878
 Site-MNIST-M                  | Train Loss: 1.9072 | Train Acc: 0.3680
 Site-SVHN                     | Train Loss: 2.0479 | Train Acc: 0.2879
 Site-MNIST                         | Val  Loss: 0.7470 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.7553 | Val  Acc: 0.8047
 Site-MNIST                         | Val  Loss: 0.7038 | Val  Acc: 0.8458
 Site-MNIST                         | Val  Loss: 0.7500 | Val  Acc: 0.8395
 Site-MNIST                         | Val  Loss: 0.7748 | Val  Acc: 0.8298
 Site-USPS                          | Val  Loss: 0.5895 | Val  Acc: 0.8798
 Site-USPS                          | Val  Loss: 0.6635 | Val  Acc: 0.8141
 Site-USPS                          | Val  Loss: 0.6488 | Val  Acc: 0.8593
 Site-SynthDigits                   | Val  Loss: 1.5786 | Val  Acc: 0.5379
 Site-SynthDigits                   | Val  Loss: 1.5924 | Val  Acc: 0.4949
 Site-MNIST-M                       | Val  Loss: 2.0022 | Val  Acc: 0.3580
 Site-MNIST-M                       | Val  Loss: 1.9377 | Val  Acc: 0.3939
 Site-SVHN                          | Val  Loss: 2.0257 | Val  Acc: 0.3242
Average Valid Accuracy: 0.6792
============ Train epoch 48 ============
 Site-MNIST                    | Train Loss: 0.6638 | Train Acc: 0.8426
 Site-MNIST                    | Train Loss: 0.7598 | Train Acc: 0.8358
 Site-MNIST                    | Train Loss: 0.6922 | Train Acc: 0.8433
 Site-MNIST                    | Train Loss: 0.7141 | Train Acc: 0.8430
 Site-MNIST                    | Train Loss: 0.7165 | Train Acc: 0.8341
 Site-USPS                     | Train Loss: 0.6599 | Train Acc: 0.8525
 Site-USPS                     | Train Loss: 0.6442 | Train Acc: 0.8586
 Site-USPS                     | Train Loss: 0.6378 | Train Acc: 0.8557
 Site-SynthDigits              | Train Loss: 1.6592 | Train Acc: 0.4749
 Site-SynthDigits              | Train Loss: 1.5878 | Train Acc: 0.5195
 Site-MNIST-M                  | Train Loss: 1.9041 | Train Acc: 0.4006
 Site-MNIST-M                  | Train Loss: 1.9088 | Train Acc: 0.3879
 Site-SVHN                     | Train Loss: 2.0442 | Train Acc: 0.2862
 Site-MNIST                         | Val  Loss: 0.7260 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.7358 | Val  Acc: 0.7929
 Site-MNIST                         | Val  Loss: 0.6855 | Val  Acc: 0.8419
 Site-MNIST                         | Val  Loss: 0.7375 | Val  Acc: 0.8342
 Site-MNIST                         | Val  Loss: 0.7579 | Val  Acc: 0.8316
 Site-USPS                          | Val  Loss: 0.6070 | Val  Acc: 0.8558
 Site-USPS                          | Val  Loss: 0.6814 | Val  Acc: 0.8141
 Site-USPS                          | Val  Loss: 0.6595 | Val  Acc: 0.8529
 Site-SynthDigits                   | Val  Loss: 1.5702 | Val  Acc: 0.5265
 Site-SynthDigits                   | Val  Loss: 1.5886 | Val  Acc: 0.4949
 Site-MNIST-M                       | Val  Loss: 1.9800 | Val  Acc: 0.3864
 Site-MNIST-M                       | Val  Loss: 1.9306 | Val  Acc: 0.4129
 Site-SVHN                          | Val  Loss: 2.0196 | Val  Acc: 0.3072
Average Valid Accuracy: 0.6776
============ Train epoch 49 ============
 Site-MNIST                    | Train Loss: 0.6395 | Train Acc: 0.8537
 Site-MNIST                    | Train Loss: 0.7341 | Train Acc: 0.8343
 Site-MNIST                    | Train Loss: 0.6841 | Train Acc: 0.8542
 Site-MNIST                    | Train Loss: 0.7028 | Train Acc: 0.8463
 Site-MNIST                    | Train Loss: 0.7067 | Train Acc: 0.8398
 Site-USPS                     | Train Loss: 0.6491 | Train Acc: 0.8549
 Site-USPS                     | Train Loss: 0.6230 | Train Acc: 0.8610
 Site-USPS                     | Train Loss: 0.6276 | Train Acc: 0.8536
 Site-SynthDigits              | Train Loss: 1.6154 | Train Acc: 0.4740
 Site-SynthDigits              | Train Loss: 1.5827 | Train Acc: 0.5208
 Site-MNIST-M                  | Train Loss: 1.9000 | Train Acc: 0.4162
 Site-MNIST-M                  | Train Loss: 1.8789 | Train Acc: 0.3888
 Site-SVHN                     | Train Loss: 2.0419 | Train Acc: 0.2862
 Site-MNIST                         | Val  Loss: 0.7240 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.7268 | Val  Acc: 0.8107
 Site-MNIST                         | Val  Loss: 0.6749 | Val  Acc: 0.8656
 Site-MNIST                         | Val  Loss: 0.7280 | Val  Acc: 0.8395
 Site-MNIST                         | Val  Loss: 0.7502 | Val  Acc: 0.8316
 Site-USPS                          | Val  Loss: 0.5949 | Val  Acc: 0.8606
 Site-USPS                          | Val  Loss: 0.6696 | Val  Acc: 0.8237
 Site-USPS                          | Val  Loss: 0.6484 | Val  Acc: 0.8593
 Site-SynthDigits                   | Val  Loss: 1.5660 | Val  Acc: 0.5303
 Site-SynthDigits                   | Val  Loss: 1.5840 | Val  Acc: 0.4975
 Site-MNIST-M                       | Val  Loss: 1.9778 | Val  Acc: 0.4034
 Site-MNIST-M                       | Val  Loss: 1.9246 | Val  Acc: 0.4318
 Site-SVHN                          | Val  Loss: 2.0182 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6852
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8393
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8107
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8656
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8395
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8316
 Best site-USPS                      | Epoch:49 | Val Acc: 0.8606
 Best site-USPS                      | Epoch:49 | Val Acc: 0.8237
 Best site-USPS                      | Epoch:49 | Val Acc: 0.8593
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.5303
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.4975
 Best site-MNIST-M                   | Epoch:49 | Val Acc: 0.4034
 Best site-MNIST-M                   | Epoch:49 | Val Acc: 0.4318
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.3140
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.8471
 Test site-USPS                      | Epoch:49 | Test Acc: 0.8554
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.4986
 Test site-MNIST-M                   | Epoch:49 | Test Acc: 0.3774
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.2741
MNIST: 0.847, USPS: 0.855, SynthDigits: 0.499, MNIST-M: 0.377, SVHN: 0.274, 
Average Test Accuracy: 0.5705, domain std=0.2400, cluster std=-1.0000, individual std=0.2229, 
===2023-06-03 23:44:40===
===2023-06-07 17:12:31===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[451,676,1015,1522,2284,834,1252,1878,1057,1586,704,1057,1174,
client_nums=[5,3,2,2,1,]
len_dataset=[7438,4958,3305,2203,1468,]
domain number = 5
Loading snapshots...
===2023-06-07 17:14:20===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[451,676,1015,1522,2284,834,1252,1878,1057,1586,704,1057,1174,
client_nums=[5,3,2,2,1,]
len_dataset=[7438,4958,3305,2203,1468,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.8471
 Test site-USPS                      | Epoch:49 | Test Acc: 0.8554
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.4986
 Test site-MNIST-M                   | Epoch:49 | Test Acc: 0.3774
 Test site-MNIST-M                   | Epoch:49 | Test Acc: 0.3774
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.2741
MNIST: 0.5340, USPS: 0.8554, SynthDigits: 0.4986, SVHN: 0.2741, 
Average Test Accuracy(group): 0.5405, Average Test Accuracy(individual): 0.6791,
domain std=0.2073, cluster std=-1.0000, individual std=0.2229, 
===2023-06-10 02:13:52===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[451,676,1015,1522,2284,834,1252,1878,1057,1586,704,1057,1174,
client_nums=[5,3,2,2,1,]
len_dataset=[7438,4958,3305,2203,1468,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.8471
 Test site-USPS                      | Epoch:49 | Test Acc: 0.8554
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.4986
 Test site-MNIST-M                   | Epoch:49 | Test Acc: 0.3774
 Test site-MNIST-M                   | Epoch:49 | Test Acc: 0.3774
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.2741
MNIST: 0.5340, USPS: 0.8554, SynthDigits: 0.4986, SVHN: 0.2741, 
Average Test Accuracy(group): 0.5405, Average Test Accuracy(individual): 0.6791,
domain CV=0.3836, cluster CV=-1.0000, individual CV=0.3282, 

[5, 3, 2, 2, 1]
mean_domain: 0.5705, mean_individual: 0.6791,
std_domain: 0.2400, std_individual: 0.2228, data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
===2023-06-30 10:58:01===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 1.1458 | Train Acc: 0.7911
 Site-MNIST                         | Train Loss: 1.1945 | Train Acc: 0.7781
 Site-MNIST                         | Train Loss: 1.2419 | Train Acc: 0.7258
 Site-MNIST                         | Train Loss: 1.1916 | Train Acc: 0.7819
 Site-MNIST                         | Train Loss: 1.1952 | Train Acc: 0.7776
 Site-USPS                          | Train Loss: 1.1191 | Train Acc: 0.7266
 Site-USPS                          | Train Loss: 1.0716 | Train Acc: 0.7492
 Site-USPS                          | Train Loss: 1.0568 | Train Acc: 0.7849
 Site-SynthDigits                   | Train Loss: 1.9701 | Train Acc: 0.3125
 Site-SynthDigits                   | Train Loss: 1.8960 | Train Acc: 0.3497
 Site-MNIST_M                       | Train Loss: 2.1273 | Train Acc: 0.3210
 Site-MNIST_M                       | Train Loss: 2.1513 | Train Acc: 0.2557
 Site-SVHN                          | Train Loss: 2.2187 | Train Acc: 0.2078
Average Train Accuracy: 0.5817
 Site-MNIST                         | Val  Loss: 1.1847 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.2324 | Val  Acc: 0.7738
 Site-MNIST                         | Val  Loss: 1.1727 | Val  Acc: 0.7619
 Site-MNIST                         | Val  Loss: 1.2047 | Val  Acc: 0.7368
 Site-MNIST                         | Val  Loss: 1.2058 | Val  Acc: 0.7649
 Site-USPS                          | Val  Loss: 1.0568 | Val  Acc: 0.7404
 Site-USPS                          | Val  Loss: 1.0976 | Val  Acc: 0.7308
 Site-USPS                          | Val  Loss: 1.0815 | Val  Acc: 0.7393
 Site-SynthDigits                   | Val  Loss: 2.0564 | Val  Acc: 0.2652
 Site-SynthDigits                   | Val  Loss: 1.9605 | Val  Acc: 0.2980
 Site-MNIST_M                       | Val  Loss: 2.0759 | Val  Acc: 0.3977
 Site-MNIST_M                       | Val  Loss: 2.1637 | Val  Acc: 0.3182
 Site-SVHN                          | Val  Loss: 2.2005 | Val  Acc: 0.2534
Average Valid Accuracy: 0.5793
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7738
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7619
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7368
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7649
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7404
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7308
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7393
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2652
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2980
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.3977
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.3182
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2534
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 0.6558 | Train Acc: 0.8400
 Site-MNIST                         | Train Loss: 0.6985 | Train Acc: 0.8314
 Site-MNIST                         | Train Loss: 0.7541 | Train Acc: 0.8185
 Site-MNIST                         | Train Loss: 0.6886 | Train Acc: 0.8331
 Site-MNIST                         | Train Loss: 0.6945 | Train Acc: 0.8389
 Site-USPS                          | Train Loss: 0.6609 | Train Acc: 0.8297
 Site-USPS                          | Train Loss: 0.6120 | Train Acc: 0.8498
 Site-USPS                          | Train Loss: 0.5849 | Train Acc: 0.8647
 Site-SynthDigits                   | Train Loss: 1.7428 | Train Acc: 0.4299
 Site-SynthDigits                   | Train Loss: 1.6480 | Train Acc: 0.4773
 Site-MNIST_M                       | Train Loss: 1.9012 | Train Acc: 0.4062
 Site-MNIST_M                       | Train Loss: 1.9713 | Train Acc: 0.3220
 Site-SVHN                          | Train Loss: 2.1491 | Train Acc: 0.2334
Average Train Accuracy: 0.6596
 Site-MNIST                         | Val  Loss: 0.6524 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.6725 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.6951 | Val  Acc: 0.8730
 Site-MNIST                         | Val  Loss: 0.7089 | Val  Acc: 0.8158
 Site-MNIST                         | Val  Loss: 0.7129 | Val  Acc: 0.8211
 Site-USPS                          | Val  Loss: 0.5812 | Val  Acc: 0.8558
 Site-USPS                          | Val  Loss: 0.6236 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.6600 | Val  Acc: 0.8291
 Site-SynthDigits                   | Val  Loss: 1.9172 | Val  Acc: 0.4318
 Site-SynthDigits                   | Val  Loss: 1.6895 | Val  Acc: 0.4596
 Site-MNIST_M                       | Val  Loss: 1.8390 | Val  Acc: 0.4773
 Site-MNIST_M                       | Val  Loss: 1.9242 | Val  Acc: 0.3939
 Site-SVHN                          | Val  Loss: 2.1514 | Val  Acc: 0.2808
Average Valid Accuracy: 0.6822
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8730
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8158
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8211
 Best site-USPS                      | Epoch:1 | Val Acc: 0.8558
 Best site-USPS                      | Epoch:1 | Val Acc: 0.8333
 Best site-USPS                      | Epoch:1 | Val Acc: 0.8291
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.4318
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.4596
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.4773
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.3939
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2808
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 0.5499 | Train Acc: 0.8622
 Site-MNIST                         | Train Loss: 0.5260 | Train Acc: 0.8521
 Site-MNIST                         | Train Loss: 0.5951 | Train Acc: 0.8481
 Site-MNIST                         | Train Loss: 0.5384 | Train Acc: 0.8568
 Site-MNIST                         | Train Loss: 0.5369 | Train Acc: 0.8608
 Site-USPS                          | Train Loss: 0.5346 | Train Acc: 0.8297
 Site-USPS                          | Train Loss: 0.4826 | Train Acc: 0.8610
 Site-USPS                          | Train Loss: 0.4636 | Train Acc: 0.8743
 Site-SynthDigits                   | Train Loss: 1.6499 | Train Acc: 0.4356
 Site-SynthDigits                   | Train Loss: 1.5075 | Train Acc: 0.5164
 Site-MNIST_M                       | Train Loss: 1.7471 | Train Acc: 0.4347
 Site-MNIST_M                       | Train Loss: 1.8517 | Train Acc: 0.3580
 Site-SVHN                          | Train Loss: 2.0800 | Train Acc: 0.2624
Average Train Accuracy: 0.6809
 Site-MNIST                         | Val  Loss: 0.4877 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.4965 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.5418 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.5606 | Val  Acc: 0.8684
 Site-MNIST                         | Val  Loss: 0.5643 | Val  Acc: 0.8421
 Site-USPS                          | Val  Loss: 0.4302 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 0.5059 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.5489 | Val  Acc: 0.8333
 Site-SynthDigits                   | Val  Loss: 1.8275 | Val  Acc: 0.4242
 Site-SynthDigits                   | Val  Loss: 1.5816 | Val  Acc: 0.4444
 Site-MNIST_M                       | Val  Loss: 1.6607 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.8107 | Val  Acc: 0.4091
 Site-SVHN                          | Val  Loss: 2.0900 | Val  Acc: 0.2740
Average Valid Accuracy: 0.6880
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8810
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8684
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8421
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8333
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.4242
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.4444
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4091
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2740
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 0.4297 | Train Acc: 0.8800
 Site-MNIST                         | Train Loss: 0.4264 | Train Acc: 0.8846
 Site-MNIST                         | Train Loss: 0.4851 | Train Acc: 0.8698
 Site-MNIST                         | Train Loss: 0.4241 | Train Acc: 0.8949
 Site-MNIST                         | Train Loss: 0.4173 | Train Acc: 0.8914
 Site-USPS                          | Train Loss: 0.4506 | Train Acc: 0.8609
 Site-USPS                          | Train Loss: 0.3861 | Train Acc: 0.8882
 Site-USPS                          | Train Loss: 0.3749 | Train Acc: 0.8999
 Site-SynthDigits                   | Train Loss: 1.5096 | Train Acc: 0.5000
 Site-SynthDigits                   | Train Loss: 1.3931 | Train Acc: 0.5556
 Site-MNIST_M                       | Train Loss: 1.6702 | Train Acc: 0.4773
 Site-MNIST_M                       | Train Loss: 1.7475 | Train Acc: 0.4261
 Site-SVHN                          | Train Loss: 2.0231 | Train Acc: 0.2845
Average Train Accuracy: 0.7164
 Site-MNIST                         | Val  Loss: 0.3948 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3807 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.4043 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.4304 | Val  Acc: 0.8895
 Site-MNIST                         | Val  Loss: 0.4437 | Val  Acc: 0.8807
 Site-USPS                          | Val  Loss: 0.3303 | Val  Acc: 0.9135
 Site-USPS                          | Val  Loss: 0.4149 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.4720 | Val  Acc: 0.8462
 Site-SynthDigits                   | Val  Loss: 1.6903 | Val  Acc: 0.4621
 Site-SynthDigits                   | Val  Loss: 1.4079 | Val  Acc: 0.5152
 Site-MNIST_M                       | Val  Loss: 1.5977 | Val  Acc: 0.5455
 Site-MNIST_M                       | Val  Loss: 1.6798 | Val  Acc: 0.4697
 Site-SVHN                          | Val  Loss: 2.0683 | Val  Acc: 0.2945
Average Valid Accuracy: 0.7262
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.9127
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8895
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8807
 Best site-USPS                      | Epoch:3 | Val Acc: 0.9135
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8654
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8462
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4621
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.5152
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.5455
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.4697
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2945
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 0.3728 | Train Acc: 0.8933
 Site-MNIST                         | Train Loss: 0.3313 | Train Acc: 0.8964
 Site-MNIST                         | Train Loss: 0.3984 | Train Acc: 0.8895
 Site-MNIST                         | Train Loss: 0.3444 | Train Acc: 0.9067
 Site-MNIST                         | Train Loss: 0.3406 | Train Acc: 0.9116
 Site-USPS                          | Train Loss: 0.4268 | Train Acc: 0.8609
 Site-USPS                          | Train Loss: 0.3422 | Train Acc: 0.8978
 Site-USPS                          | Train Loss: 0.3523 | Train Acc: 0.8978
 Site-SynthDigits                   | Train Loss: 1.4577 | Train Acc: 0.4830
 Site-SynthDigits                   | Train Loss: 1.3275 | Train Acc: 0.5543
 Site-MNIST_M                       | Train Loss: 1.6129 | Train Acc: 0.4801
 Site-MNIST_M                       | Train Loss: 1.7719 | Train Acc: 0.3958
 Site-SVHN                          | Train Loss: 1.9856 | Train Acc: 0.3066
Average Train Accuracy: 0.7211
 Site-MNIST                         | Val  Loss: 0.3240 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2980 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.3199 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3577 | Val  Acc: 0.9053
 Site-MNIST                         | Val  Loss: 0.3620 | Val  Acc: 0.8912
 Site-USPS                          | Val  Loss: 0.2974 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3946 | Val  Acc: 0.8718
 Site-USPS                          | Val  Loss: 0.4357 | Val  Acc: 0.8632
 Site-SynthDigits                   | Val  Loss: 1.7057 | Val  Acc: 0.4697
 Site-SynthDigits                   | Val  Loss: 1.4153 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.5238 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.6425 | Val  Acc: 0.4773
 Site-SVHN                          | Val  Loss: 2.0325 | Val  Acc: 0.3082
Average Valid Accuracy: 0.7328
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.9365
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.9053
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8912
 Best site-USPS                      | Epoch:4 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8718
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8632
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4697
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.4773
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.3082
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 0.3589 | Train Acc: 0.8933
 Site-MNIST                         | Train Loss: 0.2865 | Train Acc: 0.9083
 Site-MNIST                         | Train Loss: 0.3569 | Train Acc: 0.8994
 Site-MNIST                         | Train Loss: 0.3173 | Train Acc: 0.9054
 Site-MNIST                         | Train Loss: 0.3128 | Train Acc: 0.9221
 Site-USPS                          | Train Loss: 0.3418 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.2751 | Train Acc: 0.9185
 Site-USPS                          | Train Loss: 0.2838 | Train Acc: 0.9233
 Site-SynthDigits                   | Train Loss: 1.3843 | Train Acc: 0.5360
 Site-SynthDigits                   | Train Loss: 1.2469 | Train Acc: 0.5997
 Site-MNIST_M                       | Train Loss: 1.5418 | Train Acc: 0.5142
 Site-MNIST_M                       | Train Loss: 1.6783 | Train Acc: 0.4451
 Site-SVHN                          | Train Loss: 1.9220 | Train Acc: 0.3186
Average Train Accuracy: 0.7456
 Site-MNIST                         | Val  Loss: 0.2686 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2391 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.2999 | Val  Acc: 0.9444
 Site-MNIST                         | Val  Loss: 0.3117 | Val  Acc: 0.9316
 Site-MNIST                         | Val  Loss: 0.3123 | Val  Acc: 0.9053
 Site-USPS                          | Val  Loss: 0.2249 | Val  Acc: 0.9519
 Site-USPS                          | Val  Loss: 0.3128 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3465 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.5556 | Val  Acc: 0.4848
 Site-SynthDigits                   | Val  Loss: 1.2779 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.4706 | Val  Acc: 0.5341
 Site-MNIST_M                       | Val  Loss: 1.5462 | Val  Acc: 0.4773
 Site-SVHN                          | Val  Loss: 2.0016 | Val  Acc: 0.2945
Average Valid Accuracy: 0.7535
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.9444
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.9316
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.9053
 Best site-USPS                      | Epoch:5 | Val Acc: 0.9519
 Best site-USPS                      | Epoch:5 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4848
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.5341
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.4773
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2945
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.3043 | Train Acc: 0.9022
 Site-MNIST                         | Train Loss: 0.2536 | Train Acc: 0.9408
 Site-MNIST                         | Train Loss: 0.3161 | Train Acc: 0.9034
 Site-MNIST                         | Train Loss: 0.2754 | Train Acc: 0.9277
 Site-MNIST                         | Train Loss: 0.2733 | Train Acc: 0.9308
 Site-USPS                          | Train Loss: 0.3165 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.2533 | Train Acc: 0.9249
 Site-USPS                          | Train Loss: 0.2538 | Train Acc: 0.9340
 Site-SynthDigits                   | Train Loss: 1.3157 | Train Acc: 0.5455
 Site-SynthDigits                   | Train Loss: 1.1863 | Train Acc: 0.6212
 Site-MNIST_M                       | Train Loss: 1.5087 | Train Acc: 0.5284
 Site-MNIST_M                       | Train Loss: 1.6379 | Train Acc: 0.4508
 Site-SVHN                          | Train Loss: 1.9128 | Train Acc: 0.3322
Average Train Accuracy: 0.7577
 Site-MNIST                         | Val  Loss: 0.2442 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2180 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.2602 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.2752 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.2624 | Val  Acc: 0.9404
 Site-USPS                          | Val  Loss: 0.2143 | Val  Acc: 0.9519
 Site-USPS                          | Val  Loss: 0.2968 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.3248 | Val  Acc: 0.8974
 Site-SynthDigits                   | Val  Loss: 1.5100 | Val  Acc: 0.5076
 Site-SynthDigits                   | Val  Loss: 1.2448 | Val  Acc: 0.5758
 Site-MNIST_M                       | Val  Loss: 1.4041 | Val  Acc: 0.5682
 Site-MNIST_M                       | Val  Loss: 1.5273 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.9734 | Val  Acc: 0.2877
Average Valid Accuracy: 0.7636
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9421
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9404
 Best site-USPS                      | Epoch:6 | Val Acc: 0.9519
 Best site-USPS                      | Epoch:6 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8974
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5076
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5758
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.5682
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2877
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.2463 | Train Acc: 0.9111
 Site-MNIST                         | Train Loss: 0.2199 | Train Acc: 0.9408
 Site-MNIST                         | Train Loss: 0.2781 | Train Acc: 0.9250
 Site-MNIST                         | Train Loss: 0.2431 | Train Acc: 0.9304
 Site-MNIST                         | Train Loss: 0.2307 | Train Acc: 0.9440
 Site-USPS                          | Train Loss: 0.3181 | Train Acc: 0.9065
 Site-USPS                          | Train Loss: 0.2506 | Train Acc: 0.9233
 Site-USPS                          | Train Loss: 0.2544 | Train Acc: 0.9329
 Site-SynthDigits                   | Train Loss: 1.2453 | Train Acc: 0.5871
 Site-SynthDigits                   | Train Loss: 1.1058 | Train Acc: 0.6553
 Site-MNIST_M                       | Train Loss: 1.4549 | Train Acc: 0.5511
 Site-MNIST_M                       | Train Loss: 1.5705 | Train Acc: 0.4602
 Site-SVHN                          | Train Loss: 1.8371 | Train Acc: 0.3390
Average Train Accuracy: 0.7698
 Site-MNIST                         | Val  Loss: 0.2098 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.1855 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.2260 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.2414 | Val  Acc: 0.9526
 Site-MNIST                         | Val  Loss: 0.2322 | Val  Acc: 0.9404
 Site-USPS                          | Val  Loss: 0.1920 | Val  Acc: 0.9519
 Site-USPS                          | Val  Loss: 0.2954 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.3356 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.3922 | Val  Acc: 0.5682
 Site-SynthDigits                   | Val  Loss: 1.1238 | Val  Acc: 0.6212
 Site-MNIST_M                       | Val  Loss: 1.3448 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.4434 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.9310 | Val  Acc: 0.2877
Average Valid Accuracy: 0.7769
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9526
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9404
 Best site-USPS                      | Epoch:7 | Val Acc: 0.9519
 Best site-USPS                      | Epoch:7 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5682
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.6212
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.6023
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2877
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.2684 | Train Acc: 0.9111
 Site-MNIST                         | Train Loss: 0.2380 | Train Acc: 0.9290
 Site-MNIST                         | Train Loss: 0.2721 | Train Acc: 0.9270
 Site-MNIST                         | Train Loss: 0.2301 | Train Acc: 0.9382
 Site-MNIST                         | Train Loss: 0.2249 | Train Acc: 0.9466
 Site-USPS                          | Train Loss: 0.3121 | Train Acc: 0.9065
 Site-USPS                          | Train Loss: 0.2315 | Train Acc: 0.9297
 Site-USPS                          | Train Loss: 0.2455 | Train Acc: 0.9361
 Site-SynthDigits                   | Train Loss: 1.1742 | Train Acc: 0.6023
 Site-SynthDigits                   | Train Loss: 1.0507 | Train Acc: 0.6705
 Site-MNIST_M                       | Train Loss: 1.3998 | Train Acc: 0.5653
 Site-MNIST_M                       | Train Loss: 1.5089 | Train Acc: 0.4943
 Site-SVHN                          | Train Loss: 1.8349 | Train Acc: 0.3663
Average Train Accuracy: 0.7787
 Site-MNIST                         | Val  Loss: 0.2051 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.1773 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.2228 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.2568 | Val  Acc: 0.9526
 Site-MNIST                         | Val  Loss: 0.2286 | Val  Acc: 0.9333
 Site-USPS                          | Val  Loss: 0.1830 | Val  Acc: 0.9519
 Site-USPS                          | Val  Loss: 0.2774 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.3077 | Val  Acc: 0.8974
 Site-SynthDigits                   | Val  Loss: 1.3246 | Val  Acc: 0.5985
 Site-SynthDigits                   | Val  Loss: 1.0767 | Val  Acc: 0.6465
 Site-MNIST_M                       | Val  Loss: 1.2763 | Val  Acc: 0.6136
 Site-MNIST_M                       | Val  Loss: 1.3733 | Val  Acc: 0.5076
 Site-SVHN                          | Val  Loss: 1.8874 | Val  Acc: 0.3082
Average Valid Accuracy: 0.7843
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9526
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9333
 Best site-USPS                      | Epoch:8 | Val Acc: 0.9519
 Best site-USPS                      | Epoch:8 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8974
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5985
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.6465
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.6136
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.5076
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3082
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.2319 | Train Acc: 0.9289
 Site-MNIST                         | Train Loss: 0.2064 | Train Acc: 0.9497
 Site-MNIST                         | Train Loss: 0.2402 | Train Acc: 0.9329
 Site-MNIST                         | Train Loss: 0.2059 | Train Acc: 0.9422
 Site-MNIST                         | Train Loss: 0.1891 | Train Acc: 0.9536
 Site-USPS                          | Train Loss: 0.2802 | Train Acc: 0.9209
 Site-USPS                          | Train Loss: 0.2234 | Train Acc: 0.9313
 Site-USPS                          | Train Loss: 0.2287 | Train Acc: 0.9361
 Site-SynthDigits                   | Train Loss: 1.1921 | Train Acc: 0.6080
 Site-SynthDigits                   | Train Loss: 1.0412 | Train Acc: 0.6692
 Site-MNIST_M                       | Train Loss: 1.4225 | Train Acc: 0.5426
 Site-MNIST_M                       | Train Loss: 1.5605 | Train Acc: 0.4773
 Site-SVHN                          | Train Loss: 1.8552 | Train Acc: 0.3509
Average Train Accuracy: 0.7803
 Site-MNIST                         | Val  Loss: 0.1703 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1481 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.2021 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.2172 | Val  Acc: 0.9526
 Site-MNIST                         | Val  Loss: 0.1929 | Val  Acc: 0.9509
 Site-USPS                          | Val  Loss: 0.1833 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.2744 | Val  Acc: 0.9359
 Site-USPS                          | Val  Loss: 0.3046 | Val  Acc: 0.9060
 Site-SynthDigits                   | Val  Loss: 1.2868 | Val  Acc: 0.5682
 Site-SynthDigits                   | Val  Loss: 1.0696 | Val  Acc: 0.6465
 Site-MNIST_M                       | Val  Loss: 1.3620 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.4440 | Val  Acc: 0.4697
 Site-SVHN                          | Val  Loss: 1.9094 | Val  Acc: 0.3082
Average Valid Accuracy: 0.7809
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.2321 | Train Acc: 0.9156
 Site-MNIST                         | Train Loss: 0.1985 | Train Acc: 0.9290
 Site-MNIST                         | Train Loss: 0.2341 | Train Acc: 0.9349
 Site-MNIST                         | Train Loss: 0.1997 | Train Acc: 0.9448
 Site-MNIST                         | Train Loss: 0.1902 | Train Acc: 0.9475
 Site-USPS                          | Train Loss: 0.2796 | Train Acc: 0.9185
 Site-USPS                          | Train Loss: 0.2043 | Train Acc: 0.9361
 Site-USPS                          | Train Loss: 0.2244 | Train Acc: 0.9436
 Site-SynthDigits                   | Train Loss: 1.1187 | Train Acc: 0.6269
 Site-SynthDigits                   | Train Loss: 0.9900 | Train Acc: 0.6856
 Site-MNIST_M                       | Train Loss: 1.3361 | Train Acc: 0.5881
 Site-MNIST_M                       | Train Loss: 1.4801 | Train Acc: 0.5057
 Site-SVHN                          | Train Loss: 1.7655 | Train Acc: 0.3867
Average Train Accuracy: 0.7894
 Site-MNIST                         | Val  Loss: 0.1913 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.1740 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1922 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.2291 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.2003 | Val  Acc: 0.9298
 Site-USPS                          | Val  Loss: 0.1680 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.2647 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.2886 | Val  Acc: 0.9017
 Site-SynthDigits                   | Val  Loss: 1.2364 | Val  Acc: 0.5985
 Site-SynthDigits                   | Val  Loss: 1.0053 | Val  Acc: 0.6667
 Site-MNIST_M                       | Val  Loss: 1.2693 | Val  Acc: 0.6136
 Site-MNIST_M                       | Val  Loss: 1.3313 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 1.8408 | Val  Acc: 0.3288
Average Valid Accuracy: 0.7902
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9683
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9421
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9298
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9615
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9017
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5985
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.6667
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.6136
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.5455
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3288
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.1912 | Train Acc: 0.9244
 Site-MNIST                         | Train Loss: 0.1793 | Train Acc: 0.9438
 Site-MNIST                         | Train Loss: 0.2158 | Train Acc: 0.9389
 Site-MNIST                         | Train Loss: 0.1806 | Train Acc: 0.9488
 Site-MNIST                         | Train Loss: 0.1664 | Train Acc: 0.9597
 Site-USPS                          | Train Loss: 0.2564 | Train Acc: 0.9233
 Site-USPS                          | Train Loss: 0.1923 | Train Acc: 0.9425
 Site-USPS                          | Train Loss: 0.2004 | Train Acc: 0.9436
 Site-SynthDigits                   | Train Loss: 1.0968 | Train Acc: 0.6402
 Site-SynthDigits                   | Train Loss: 0.9502 | Train Acc: 0.7045
 Site-MNIST_M                       | Train Loss: 1.3541 | Train Acc: 0.5767
 Site-MNIST_M                       | Train Loss: 1.4443 | Train Acc: 0.5189
 Site-SVHN                          | Train Loss: 1.7891 | Train Acc: 0.3612
Average Train Accuracy: 0.7943
 Site-MNIST                         | Val  Loss: 0.1651 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1510 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.1812 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.2033 | Val  Acc: 0.9474
 Site-MNIST                         | Val  Loss: 0.1715 | Val  Acc: 0.9439
 Site-USPS                          | Val  Loss: 0.1531 | Val  Acc: 0.9519
 Site-USPS                          | Val  Loss: 0.2403 | Val  Acc: 0.9359
 Site-USPS                          | Val  Loss: 0.2682 | Val  Acc: 0.9060
 Site-SynthDigits                   | Val  Loss: 1.1540 | Val  Acc: 0.6061
 Site-SynthDigits                   | Val  Loss: 0.9538 | Val  Acc: 0.6768
 Site-MNIST_M                       | Val  Loss: 1.2840 | Val  Acc: 0.6136
 Site-MNIST_M                       | Val  Loss: 1.3719 | Val  Acc: 0.5227
 Site-SVHN                          | Val  Loss: 1.8677 | Val  Acc: 0.3425
Average Valid Accuracy: 0.7935
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9474
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9439
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9519
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9359
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9060
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.6061
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.6768
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.6136
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.5227
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3425
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.1980 | Train Acc: 0.9333
 Site-MNIST                         | Train Loss: 0.1442 | Train Acc: 0.9527
 Site-MNIST                         | Train Loss: 0.2016 | Train Acc: 0.9349
 Site-MNIST                         | Train Loss: 0.1695 | Train Acc: 0.9514
 Site-MNIST                         | Train Loss: 0.1606 | Train Acc: 0.9597
 Site-USPS                          | Train Loss: 0.2418 | Train Acc: 0.9281
 Site-USPS                          | Train Loss: 0.1799 | Train Acc: 0.9377
 Site-USPS                          | Train Loss: 0.1884 | Train Acc: 0.9499
 Site-SynthDigits                   | Train Loss: 1.0440 | Train Acc: 0.6591
 Site-SynthDigits                   | Train Loss: 0.9087 | Train Acc: 0.7273
 Site-MNIST_M                       | Train Loss: 1.3507 | Train Acc: 0.5597
 Site-MNIST_M                       | Train Loss: 1.4189 | Train Acc: 0.5379
 Site-SVHN                          | Train Loss: 1.7839 | Train Acc: 0.4003
Average Train Accuracy: 0.8025
 Site-MNIST                         | Val  Loss: 0.1577 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.1334 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1759 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1854 | Val  Acc: 0.9526
 Site-MNIST                         | Val  Loss: 0.1610 | Val  Acc: 0.9544
 Site-USPS                          | Val  Loss: 0.1365 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.2242 | Val  Acc: 0.9359
 Site-USPS                          | Val  Loss: 0.2562 | Val  Acc: 0.9103
 Site-SynthDigits                   | Val  Loss: 1.1022 | Val  Acc: 0.6136
 Site-SynthDigits                   | Val  Loss: 0.9262 | Val  Acc: 0.6818
 Site-MNIST_M                       | Val  Loss: 1.2448 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.3588 | Val  Acc: 0.4848
 Site-SVHN                          | Val  Loss: 1.8272 | Val  Acc: 0.3493
Average Valid Accuracy: 0.7943
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9683
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9526
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9544
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9615
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9359
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9103
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.6136
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.6818
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.5909
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4848
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3493
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.1856 | Train Acc: 0.9378
 Site-MNIST                         | Train Loss: 0.1602 | Train Acc: 0.9497
 Site-MNIST                         | Train Loss: 0.1984 | Train Acc: 0.9428
 Site-MNIST                         | Train Loss: 0.1665 | Train Acc: 0.9540
 Site-MNIST                         | Train Loss: 0.1559 | Train Acc: 0.9588
 Site-USPS                          | Train Loss: 0.2383 | Train Acc: 0.9233
 Site-USPS                          | Train Loss: 0.1703 | Train Acc: 0.9521
 Site-USPS                          | Train Loss: 0.1849 | Train Acc: 0.9499
 Site-SynthDigits                   | Train Loss: 1.0213 | Train Acc: 0.6686
 Site-SynthDigits                   | Train Loss: 0.8846 | Train Acc: 0.7146
 Site-MNIST_M                       | Train Loss: 1.3387 | Train Acc: 0.5767
 Site-MNIST_M                       | Train Loss: 1.4142 | Train Acc: 0.5341
 Site-SVHN                          | Train Loss: 1.7090 | Train Acc: 0.4089
Average Train Accuracy: 0.8055
 Site-MNIST                         | Val  Loss: 0.1540 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1233 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1770 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1944 | Val  Acc: 0.9526
 Site-MNIST                         | Val  Loss: 0.1617 | Val  Acc: 0.9474
 Site-USPS                          | Val  Loss: 0.1242 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.2165 | Val  Acc: 0.9551
 Site-USPS                          | Val  Loss: 0.2519 | Val  Acc: 0.9188
 Site-SynthDigits                   | Val  Loss: 1.0577 | Val  Acc: 0.6212
 Site-SynthDigits                   | Val  Loss: 0.8841 | Val  Acc: 0.6970
 Site-MNIST_M                       | Val  Loss: 1.2494 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.3402 | Val  Acc: 0.5303
 Site-SVHN                          | Val  Loss: 1.7856 | Val  Acc: 0.3493
Average Valid Accuracy: 0.8034
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9683
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9526
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9474
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9615
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9551
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9188
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.6212
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.6970
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.5909
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.5303
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3493
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.1758 | Train Acc: 0.9422
 Site-MNIST                         | Train Loss: 0.1524 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.1829 | Train Acc: 0.9527
 Site-MNIST                         | Train Loss: 0.1490 | Train Acc: 0.9632
 Site-MNIST                         | Train Loss: 0.1374 | Train Acc: 0.9676
 Site-USPS                          | Train Loss: 0.2231 | Train Acc: 0.9329
 Site-USPS                          | Train Loss: 0.1616 | Train Acc: 0.9489
 Site-USPS                          | Train Loss: 0.1750 | Train Acc: 0.9542
 Site-SynthDigits                   | Train Loss: 1.0190 | Train Acc: 0.6742
 Site-SynthDigits                   | Train Loss: 0.8754 | Train Acc: 0.7273
 Site-MNIST_M                       | Train Loss: 1.2855 | Train Acc: 0.5739
 Site-MNIST_M                       | Train Loss: 1.3561 | Train Acc: 0.5436
 Site-SVHN                          | Train Loss: 1.7554 | Train Acc: 0.4055
Average Train Accuracy: 0.8116
 Site-MNIST                         | Val  Loss: 0.1333 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.1161 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1650 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1782 | Val  Acc: 0.9684
 Site-MNIST                         | Val  Loss: 0.1414 | Val  Acc: 0.9684
 Site-USPS                          | Val  Loss: 0.1198 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.2058 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.2351 | Val  Acc: 0.9145
 Site-SynthDigits                   | Val  Loss: 1.0993 | Val  Acc: 0.6364
 Site-SynthDigits                   | Val  Loss: 0.8973 | Val  Acc: 0.6818
 Site-MNIST_M                       | Val  Loss: 1.2281 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.3167 | Val  Acc: 0.5076
 Site-SVHN                          | Val  Loss: 1.8086 | Val  Acc: 0.3630
Average Valid Accuracy: 0.8114
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9684
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9684
 Best site-USPS                      | Epoch:14 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:14 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:14 | Val Acc: 0.9145
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.6364
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.6818
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.6477
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.5076
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3630
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.1825 | Train Acc: 0.9422
 Site-MNIST                         | Train Loss: 0.1213 | Train Acc: 0.9556
 Site-MNIST                         | Train Loss: 0.1794 | Train Acc: 0.9448
 Site-MNIST                         | Train Loss: 0.1407 | Train Acc: 0.9632
 Site-MNIST                         | Train Loss: 0.1353 | Train Acc: 0.9694
 Site-USPS                          | Train Loss: 0.2000 | Train Acc: 0.9353
 Site-USPS                          | Train Loss: 0.1581 | Train Acc: 0.9489
 Site-USPS                          | Train Loss: 0.1635 | Train Acc: 0.9510
 Site-SynthDigits                   | Train Loss: 1.0170 | Train Acc: 0.6799
 Site-SynthDigits                   | Train Loss: 0.8409 | Train Acc: 0.7386
 Site-MNIST_M                       | Train Loss: 1.3112 | Train Acc: 0.5597
 Site-MNIST_M                       | Train Loss: 1.3855 | Train Acc: 0.5360
 Site-SVHN                          | Train Loss: 1.7928 | Train Acc: 0.3952
Average Train Accuracy: 0.8092
 Site-MNIST                         | Val  Loss: 0.1416 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.1123 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1660 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1783 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.1359 | Val  Acc: 0.9544
 Site-USPS                          | Val  Loss: 0.1183 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.1908 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.2185 | Val  Acc: 0.9145
 Site-SynthDigits                   | Val  Loss: 1.0496 | Val  Acc: 0.6515
 Site-SynthDigits                   | Val  Loss: 0.8755 | Val  Acc: 0.7020
 Site-MNIST_M                       | Val  Loss: 1.2301 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.3076 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.8419 | Val  Acc: 0.3904
Average Valid Accuracy: 0.8083
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.1537 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.1278 | Train Acc: 0.9615
 Site-MNIST                         | Train Loss: 0.1758 | Train Acc: 0.9546
 Site-MNIST                         | Train Loss: 0.1363 | Train Acc: 0.9619
 Site-MNIST                         | Train Loss: 0.1245 | Train Acc: 0.9720
 Site-USPS                          | Train Loss: 0.2184 | Train Acc: 0.9329
 Site-USPS                          | Train Loss: 0.1515 | Train Acc: 0.9553
 Site-USPS                          | Train Loss: 0.1651 | Train Acc: 0.9542
 Site-SynthDigits                   | Train Loss: 1.0046 | Train Acc: 0.6894
 Site-SynthDigits                   | Train Loss: 0.8096 | Train Acc: 0.7399
 Site-MNIST_M                       | Train Loss: 1.2747 | Train Acc: 0.5938
 Site-MNIST_M                       | Train Loss: 1.3227 | Train Acc: 0.5625
 Site-SVHN                          | Train Loss: 1.7220 | Train Acc: 0.4089
Average Train Accuracy: 0.8183
 Site-MNIST                         | Val  Loss: 0.1393 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1143 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1593 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1704 | Val  Acc: 0.9632
 Site-MNIST                         | Val  Loss: 0.1321 | Val  Acc: 0.9614
 Site-USPS                          | Val  Loss: 0.1110 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.1953 | Val  Acc: 0.9487
 Site-USPS                          | Val  Loss: 0.2290 | Val  Acc: 0.9188
 Site-SynthDigits                   | Val  Loss: 1.0330 | Val  Acc: 0.6591
 Site-SynthDigits                   | Val  Loss: 0.8229 | Val  Acc: 0.7071
 Site-MNIST_M                       | Val  Loss: 1.1966 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.2827 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 1.7776 | Val  Acc: 0.3630
Average Valid Accuracy: 0.8146
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9632
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9614
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9487
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9188
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.6591
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.7071
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.6477
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.5455
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3630
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.1674 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.1395 | Train Acc: 0.9586
 Site-MNIST                         | Train Loss: 0.1740 | Train Acc: 0.9487
 Site-MNIST                         | Train Loss: 0.1251 | Train Acc: 0.9671
 Site-MNIST                         | Train Loss: 0.1224 | Train Acc: 0.9729
 Site-USPS                          | Train Loss: 0.2327 | Train Acc: 0.9305
 Site-USPS                          | Train Loss: 0.1482 | Train Acc: 0.9569
 Site-USPS                          | Train Loss: 0.1603 | Train Acc: 0.9510
 Site-SynthDigits                   | Train Loss: 0.9219 | Train Acc: 0.6970
 Site-SynthDigits                   | Train Loss: 0.7505 | Train Acc: 0.7626
 Site-MNIST_M                       | Train Loss: 1.2011 | Train Acc: 0.5909
 Site-MNIST_M                       | Train Loss: 1.2546 | Train Acc: 0.5739
 Site-SVHN                          | Train Loss: 1.7128 | Train Acc: 0.4208
Average Train Accuracy: 0.8217
 Site-MNIST                         | Val  Loss: 0.1452 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1098 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1574 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1706 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.1294 | Val  Acc: 0.9579
 Site-USPS                          | Val  Loss: 0.1078 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.1945 | Val  Acc: 0.9487
 Site-USPS                          | Val  Loss: 0.2309 | Val  Acc: 0.9188
 Site-SynthDigits                   | Val  Loss: 0.9983 | Val  Acc: 0.6742
 Site-SynthDigits                   | Val  Loss: 0.7980 | Val  Acc: 0.7071
 Site-MNIST_M                       | Val  Loss: 1.1240 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.2427 | Val  Acc: 0.5530
 Site-SVHN                          | Val  Loss: 1.7575 | Val  Acc: 0.3767
Average Valid Accuracy: 0.8159
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9579
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9579
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9487
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9188
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.6742
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.7071
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.6250
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.5530
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3767
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.1582 | Train Acc: 0.9556
 Site-MNIST                         | Train Loss: 0.1089 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.1653 | Train Acc: 0.9507
 Site-MNIST                         | Train Loss: 0.1210 | Train Acc: 0.9671
 Site-MNIST                         | Train Loss: 0.1120 | Train Acc: 0.9746
 Site-USPS                          | Train Loss: 0.2011 | Train Acc: 0.9400
 Site-USPS                          | Train Loss: 0.1423 | Train Acc: 0.9521
 Site-USPS                          | Train Loss: 0.1484 | Train Acc: 0.9563
 Site-SynthDigits                   | Train Loss: 0.9382 | Train Acc: 0.6989
 Site-SynthDigits                   | Train Loss: 0.7583 | Train Acc: 0.7652
 Site-MNIST_M                       | Train Loss: 1.2279 | Train Acc: 0.5938
 Site-MNIST_M                       | Train Loss: 1.2729 | Train Acc: 0.5814
 Site-SVHN                          | Train Loss: 1.6806 | Train Acc: 0.4089
Average Train Accuracy: 0.8238
 Site-MNIST                         | Val  Loss: 0.1382 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.1128 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1537 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1548 | Val  Acc: 0.9684
 Site-MNIST                         | Val  Loss: 0.1171 | Val  Acc: 0.9649
 Site-USPS                          | Val  Loss: 0.1056 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1810 | Val  Acc: 0.9551
 Site-USPS                          | Val  Loss: 0.2116 | Val  Acc: 0.9231
 Site-SynthDigits                   | Val  Loss: 0.9786 | Val  Acc: 0.6591
 Site-SynthDigits                   | Val  Loss: 0.7797 | Val  Acc: 0.7121
 Site-MNIST_M                       | Val  Loss: 1.1634 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.2583 | Val  Acc: 0.5379
 Site-SVHN                          | Val  Loss: 1.7691 | Val  Acc: 0.3630
Average Valid Accuracy: 0.8153
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.1573 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.1273 | Train Acc: 0.9586
 Site-MNIST                         | Train Loss: 0.1624 | Train Acc: 0.9507
 Site-MNIST                         | Train Loss: 0.1176 | Train Acc: 0.9671
 Site-MNIST                         | Train Loss: 0.1131 | Train Acc: 0.9729
 Site-USPS                          | Train Loss: 0.1996 | Train Acc: 0.9376
 Site-USPS                          | Train Loss: 0.1359 | Train Acc: 0.9633
 Site-USPS                          | Train Loss: 0.1442 | Train Acc: 0.9595
 Site-SynthDigits                   | Train Loss: 0.9182 | Train Acc: 0.7027
 Site-SynthDigits                   | Train Loss: 0.7611 | Train Acc: 0.7563
 Site-MNIST_M                       | Train Loss: 1.1888 | Train Acc: 0.5909
 Site-MNIST_M                       | Train Loss: 1.2569 | Train Acc: 0.5890
 Site-SVHN                          | Train Loss: 1.6944 | Train Acc: 0.4140
Average Train Accuracy: 0.8241
 Site-MNIST                         | Val  Loss: 0.1306 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0998 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1515 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1660 | Val  Acc: 0.9632
 Site-MNIST                         | Val  Loss: 0.1233 | Val  Acc: 0.9579
 Site-USPS                          | Val  Loss: 0.1093 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.1765 | Val  Acc: 0.9487
 Site-USPS                          | Val  Loss: 0.2060 | Val  Acc: 0.9231
 Site-SynthDigits                   | Val  Loss: 0.9920 | Val  Acc: 0.6818
 Site-SynthDigits                   | Val  Loss: 0.7655 | Val  Acc: 0.7222
 Site-MNIST_M                       | Val  Loss: 1.1486 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.2358 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 1.7438 | Val  Acc: 0.3836
Average Valid Accuracy: 0.8183
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9632
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9579
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9487
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9231
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.6818
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.7222
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.6364
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.5455
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3836
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.1412 | Train Acc: 0.9600
 Site-MNIST                         | Train Loss: 0.1112 | Train Acc: 0.9586
 Site-MNIST                         | Train Loss: 0.1530 | Train Acc: 0.9546
 Site-MNIST                         | Train Loss: 0.1134 | Train Acc: 0.9724
 Site-MNIST                         | Train Loss: 0.1040 | Train Acc: 0.9764
 Site-USPS                          | Train Loss: 0.1924 | Train Acc: 0.9472
 Site-USPS                          | Train Loss: 0.1297 | Train Acc: 0.9633
 Site-USPS                          | Train Loss: 0.1397 | Train Acc: 0.9585
 Site-SynthDigits                   | Train Loss: 0.8834 | Train Acc: 0.7216
 Site-SynthDigits                   | Train Loss: 0.7377 | Train Acc: 0.7753
 Site-MNIST_M                       | Train Loss: 1.1845 | Train Acc: 0.5966
 Site-MNIST_M                       | Train Loss: 1.2190 | Train Acc: 0.5890
 Site-SVHN                          | Train Loss: 1.6228 | Train Acc: 0.4225
Average Train Accuracy: 0.8305
 Site-MNIST                         | Val  Loss: 0.1333 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1053 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1458 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1559 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.1191 | Val  Acc: 0.9579
 Site-USPS                          | Val  Loss: 0.0971 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.1684 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1953 | Val  Acc: 0.9487
 Site-SynthDigits                   | Val  Loss: 0.9639 | Val  Acc: 0.6894
 Site-SynthDigits                   | Val  Loss: 0.7407 | Val  Acc: 0.7525
 Site-MNIST_M                       | Val  Loss: 1.1444 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.2269 | Val  Acc: 0.5303
 Site-SVHN                          | Val  Loss: 1.7265 | Val  Acc: 0.3836
Average Valid Accuracy: 0.8235
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9579
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9579
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9615
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9487
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.6894
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.7525
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.6477
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5303
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3836
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.1509 | Train Acc: 0.9422
 Site-MNIST                         | Train Loss: 0.1083 | Train Acc: 0.9675
 Site-MNIST                         | Train Loss: 0.1509 | Train Acc: 0.9546
 Site-MNIST                         | Train Loss: 0.1099 | Train Acc: 0.9711
 Site-MNIST                         | Train Loss: 0.1042 | Train Acc: 0.9790
 Site-USPS                          | Train Loss: 0.1894 | Train Acc: 0.9400
 Site-USPS                          | Train Loss: 0.1238 | Train Acc: 0.9601
 Site-USPS                          | Train Loss: 0.1343 | Train Acc: 0.9649
 Site-SynthDigits                   | Train Loss: 0.8554 | Train Acc: 0.7197
 Site-SynthDigits                   | Train Loss: 0.7219 | Train Acc: 0.7828
 Site-MNIST_M                       | Train Loss: 1.1933 | Train Acc: 0.5909
 Site-MNIST_M                       | Train Loss: 1.2122 | Train Acc: 0.5985
 Site-SVHN                          | Train Loss: 1.6408 | Train Acc: 0.4293
Average Train Accuracy: 0.8308
 Site-MNIST                         | Val  Loss: 0.1085 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0792 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1525 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1521 | Val  Acc: 0.9632
 Site-MNIST                         | Val  Loss: 0.1106 | Val  Acc: 0.9684
 Site-USPS                          | Val  Loss: 0.1002 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.1603 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1922 | Val  Acc: 0.9316
 Site-SynthDigits                   | Val  Loss: 0.9557 | Val  Acc: 0.6970
 Site-SynthDigits                   | Val  Loss: 0.7316 | Val  Acc: 0.7323
 Site-MNIST_M                       | Val  Loss: 1.1263 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.2148 | Val  Acc: 0.5379
 Site-SVHN                          | Val  Loss: 1.6914 | Val  Acc: 0.3767
Average Valid Accuracy: 0.8253
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9632
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9684
 Best site-USPS                      | Epoch:21 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:21 | Val Acc: 0.9679
 Best site-USPS                      | Epoch:21 | Val Acc: 0.9316
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.6970
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.7323
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.6364
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.5379
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.3767
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.1286 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.1126 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.1493 | Train Acc: 0.9546
 Site-MNIST                         | Train Loss: 0.1052 | Train Acc: 0.9777
 Site-MNIST                         | Train Loss: 0.0988 | Train Acc: 0.9755
 Site-USPS                          | Train Loss: 0.1934 | Train Acc: 0.9424
 Site-USPS                          | Train Loss: 0.1276 | Train Acc: 0.9633
 Site-USPS                          | Train Loss: 0.1426 | Train Acc: 0.9617
 Site-SynthDigits                   | Train Loss: 0.8700 | Train Acc: 0.7292
 Site-SynthDigits                   | Train Loss: 0.6908 | Train Acc: 0.7942
 Site-MNIST_M                       | Train Loss: 1.1522 | Train Acc: 0.6250
 Site-MNIST_M                       | Train Loss: 1.1710 | Train Acc: 0.6023
 Site-SVHN                          | Train Loss: 1.6127 | Train Acc: 0.4361
Average Train Accuracy: 0.8381
 Site-MNIST                         | Val  Loss: 0.1249 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0912 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1457 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1578 | Val  Acc: 0.9632
 Site-MNIST                         | Val  Loss: 0.1164 | Val  Acc: 0.9614
 Site-USPS                          | Val  Loss: 0.0951 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.1649 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.2030 | Val  Acc: 0.9402
 Site-SynthDigits                   | Val  Loss: 0.9170 | Val  Acc: 0.6894
 Site-SynthDigits                   | Val  Loss: 0.7169 | Val  Acc: 0.7475
 Site-MNIST_M                       | Val  Loss: 1.0868 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.1698 | Val  Acc: 0.5758
 Site-SVHN                          | Val  Loss: 1.6890 | Val  Acc: 0.3699
Average Valid Accuracy: 0.8288
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9632
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9614
 Best site-USPS                      | Epoch:22 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:22 | Val Acc: 0.9615
 Best site-USPS                      | Epoch:22 | Val Acc: 0.9402
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.6894
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.7475
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.6477
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5758
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.3699
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.1338 | Train Acc: 0.9600
 Site-MNIST                         | Train Loss: 0.0878 | Train Acc: 0.9675
 Site-MNIST                         | Train Loss: 0.1386 | Train Acc: 0.9586
 Site-MNIST                         | Train Loss: 0.1031 | Train Acc: 0.9685
 Site-MNIST                         | Train Loss: 0.0920 | Train Acc: 0.9807
 Site-USPS                          | Train Loss: 0.1912 | Train Acc: 0.9424
 Site-USPS                          | Train Loss: 0.1193 | Train Acc: 0.9649
 Site-USPS                          | Train Loss: 0.1308 | Train Acc: 0.9670
 Site-SynthDigits                   | Train Loss: 0.8297 | Train Acc: 0.7216
 Site-SynthDigits                   | Train Loss: 0.6939 | Train Acc: 0.7828
 Site-MNIST_M                       | Train Loss: 1.2127 | Train Acc: 0.5938
 Site-MNIST_M                       | Train Loss: 1.2050 | Train Acc: 0.5947
 Site-SVHN                          | Train Loss: 1.6418 | Train Acc: 0.4532
Average Train Accuracy: 0.8350
 Site-MNIST                         | Val  Loss: 0.0967 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0800 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1433 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1441 | Val  Acc: 0.9632
 Site-MNIST                         | Val  Loss: 0.1032 | Val  Acc: 0.9649
 Site-USPS                          | Val  Loss: 0.0862 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.1557 | Val  Acc: 0.9551
 Site-USPS                          | Val  Loss: 0.1876 | Val  Acc: 0.9359
 Site-SynthDigits                   | Val  Loss: 0.9049 | Val  Acc: 0.6894
 Site-SynthDigits                   | Val  Loss: 0.7160 | Val  Acc: 0.7374
 Site-MNIST_M                       | Val  Loss: 1.1466 | Val  Acc: 0.6591
 Site-MNIST_M                       | Val  Loss: 1.2362 | Val  Acc: 0.5530
 Site-SVHN                          | Val  Loss: 1.6963 | Val  Acc: 0.4041
Average Valid Accuracy: 0.8292
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9632
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9649
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9551
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9359
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.6894
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.7374
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.6591
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.5530
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.4041
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.1323 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.1081 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.1379 | Train Acc: 0.9527
 Site-MNIST                         | Train Loss: 0.0999 | Train Acc: 0.9750
 Site-MNIST                         | Train Loss: 0.0857 | Train Acc: 0.9825
 Site-USPS                          | Train Loss: 0.1741 | Train Acc: 0.9520
 Site-USPS                          | Train Loss: 0.1167 | Train Acc: 0.9712
 Site-USPS                          | Train Loss: 0.1250 | Train Acc: 0.9617
 Site-SynthDigits                   | Train Loss: 0.8445 | Train Acc: 0.7311
 Site-SynthDigits                   | Train Loss: 0.6883 | Train Acc: 0.7879
 Site-MNIST_M                       | Train Loss: 1.1534 | Train Acc: 0.6165
 Site-MNIST_M                       | Train Loss: 1.1738 | Train Acc: 0.6136
 Site-SVHN                          | Train Loss: 1.6691 | Train Acc: 0.4344
Average Train Accuracy: 0.8394
 Site-MNIST                         | Val  Loss: 0.0993 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0822 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1473 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1452 | Val  Acc: 0.9632
 Site-MNIST                         | Val  Loss: 0.1057 | Val  Acc: 0.9614
 Site-USPS                          | Val  Loss: 0.0861 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1521 | Val  Acc: 0.9744
 Site-USPS                          | Val  Loss: 0.1781 | Val  Acc: 0.9573
 Site-SynthDigits                   | Val  Loss: 0.9101 | Val  Acc: 0.7045
 Site-SynthDigits                   | Val  Loss: 0.6975 | Val  Acc: 0.7525
 Site-MNIST_M                       | Val  Loss: 1.1247 | Val  Acc: 0.6591
 Site-MNIST_M                       | Val  Loss: 1.1698 | Val  Acc: 0.5530
 Site-SVHN                          | Val  Loss: 1.6941 | Val  Acc: 0.3904
Average Valid Accuracy: 0.8309
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9632
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9614
 Best site-USPS                      | Epoch:24 | Val Acc: 0.9808
 Best site-USPS                      | Epoch:24 | Val Acc: 0.9744
 Best site-USPS                      | Epoch:24 | Val Acc: 0.9573
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.7045
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.7525
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.6591
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.5530
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3904
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.1136 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.0932 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.1368 | Train Acc: 0.9546
 Site-MNIST                         | Train Loss: 0.0942 | Train Acc: 0.9777
 Site-MNIST                         | Train Loss: 0.0825 | Train Acc: 0.9799
 Site-USPS                          | Train Loss: 0.1903 | Train Acc: 0.9448
 Site-USPS                          | Train Loss: 0.1187 | Train Acc: 0.9681
 Site-USPS                          | Train Loss: 0.1217 | Train Acc: 0.9617
 Site-SynthDigits                   | Train Loss: 0.7838 | Train Acc: 0.7348
 Site-SynthDigits                   | Train Loss: 0.6521 | Train Acc: 0.8131
 Site-MNIST_M                       | Train Loss: 1.1794 | Train Acc: 0.6108
 Site-MNIST_M                       | Train Loss: 1.1888 | Train Acc: 0.6080
 Site-SVHN                          | Train Loss: 1.6131 | Train Acc: 0.4446
Average Train Accuracy: 0.8405
 Site-MNIST                         | Val  Loss: 0.1174 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1002 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1449 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1420 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.1046 | Val  Acc: 0.9614
 Site-USPS                          | Val  Loss: 0.0795 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1449 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1877 | Val  Acc: 0.9402
 Site-SynthDigits                   | Val  Loss: 0.8471 | Val  Acc: 0.6970
 Site-SynthDigits                   | Val  Loss: 0.6918 | Val  Acc: 0.7525
 Site-MNIST_M                       | Val  Loss: 1.1034 | Val  Acc: 0.6705
 Site-MNIST_M                       | Val  Loss: 1.1758 | Val  Acc: 0.5682
 Site-SVHN                          | Val  Loss: 1.7062 | Val  Acc: 0.3836
Average Valid Accuracy: 0.8296
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.1155 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.0874 | Train Acc: 0.9704
 Site-MNIST                         | Train Loss: 0.1318 | Train Acc: 0.9527
 Site-MNIST                         | Train Loss: 0.0913 | Train Acc: 0.9763
 Site-MNIST                         | Train Loss: 0.0786 | Train Acc: 0.9825
 Site-USPS                          | Train Loss: 0.1569 | Train Acc: 0.9520
 Site-USPS                          | Train Loss: 0.1120 | Train Acc: 0.9728
 Site-USPS                          | Train Loss: 0.1202 | Train Acc: 0.9649
 Site-SynthDigits                   | Train Loss: 0.8139 | Train Acc: 0.7367
 Site-SynthDigits                   | Train Loss: 0.6539 | Train Acc: 0.8018
 Site-MNIST_M                       | Train Loss: 1.1529 | Train Acc: 0.6165
 Site-MNIST_M                       | Train Loss: 1.1394 | Train Acc: 0.6155
 Site-SVHN                          | Train Loss: 1.6027 | Train Acc: 0.4480
Average Train Accuracy: 0.8430
 Site-MNIST                         | Val  Loss: 0.0953 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0809 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1397 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1363 | Val  Acc: 0.9632
 Site-MNIST                         | Val  Loss: 0.1000 | Val  Acc: 0.9684
 Site-USPS                          | Val  Loss: 0.0808 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1359 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1691 | Val  Acc: 0.9487
 Site-SynthDigits                   | Val  Loss: 0.8454 | Val  Acc: 0.6970
 Site-SynthDigits                   | Val  Loss: 0.6800 | Val  Acc: 0.7677
 Site-MNIST_M                       | Val  Loss: 1.1075 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.1613 | Val  Acc: 0.5606
 Site-SVHN                          | Val  Loss: 1.6802 | Val  Acc: 0.3973
Average Valid Accuracy: 0.8302
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.1166 | Train Acc: 0.9600
 Site-MNIST                         | Train Loss: 0.1070 | Train Acc: 0.9615
 Site-MNIST                         | Train Loss: 0.1273 | Train Acc: 0.9527
 Site-MNIST                         | Train Loss: 0.0879 | Train Acc: 0.9763
 Site-MNIST                         | Train Loss: 0.0734 | Train Acc: 0.9860
 Site-USPS                          | Train Loss: 0.1928 | Train Acc: 0.9448
 Site-USPS                          | Train Loss: 0.1092 | Train Acc: 0.9696
 Site-USPS                          | Train Loss: 0.1221 | Train Acc: 0.9659
 Site-SynthDigits                   | Train Loss: 0.8047 | Train Acc: 0.7311
 Site-SynthDigits                   | Train Loss: 0.6230 | Train Acc: 0.8056
 Site-MNIST_M                       | Train Loss: 1.1209 | Train Acc: 0.6165
 Site-MNIST_M                       | Train Loss: 1.0590 | Train Acc: 0.6174
 Site-SVHN                          | Train Loss: 1.5396 | Train Acc: 0.4600
Average Train Accuracy: 0.8421
 Site-MNIST                         | Val  Loss: 0.0950 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0796 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1350 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1446 | Val  Acc: 0.9526
 Site-MNIST                         | Val  Loss: 0.1069 | Val  Acc: 0.9614
 Site-USPS                          | Val  Loss: 0.0730 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1450 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1841 | Val  Acc: 0.9402
 Site-SynthDigits                   | Val  Loss: 0.8578 | Val  Acc: 0.7121
 Site-SynthDigits                   | Val  Loss: 0.6418 | Val  Acc: 0.7626
 Site-MNIST_M                       | Val  Loss: 1.0639 | Val  Acc: 0.6591
 Site-MNIST_M                       | Val  Loss: 1.1763 | Val  Acc: 0.5682
 Site-SVHN                          | Val  Loss: 1.6447 | Val  Acc: 0.3973
Average Valid Accuracy: 0.8308
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.1118 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.0886 | Train Acc: 0.9675
 Site-MNIST                         | Train Loss: 0.1250 | Train Acc: 0.9625
 Site-MNIST                         | Train Loss: 0.0877 | Train Acc: 0.9750
 Site-MNIST                         | Train Loss: 0.0764 | Train Acc: 0.9816
 Site-USPS                          | Train Loss: 0.1716 | Train Acc: 0.9544
 Site-USPS                          | Train Loss: 0.0998 | Train Acc: 0.9760
 Site-USPS                          | Train Loss: 0.1123 | Train Acc: 0.9681
 Site-SynthDigits                   | Train Loss: 0.7911 | Train Acc: 0.7443
 Site-SynthDigits                   | Train Loss: 0.6215 | Train Acc: 0.8068
 Site-MNIST_M                       | Train Loss: 1.1210 | Train Acc: 0.6278
 Site-MNIST_M                       | Train Loss: 1.1107 | Train Acc: 0.6269
 Site-SVHN                          | Train Loss: 1.5547 | Train Acc: 0.4583
Average Train Accuracy: 0.8476
 Site-MNIST                         | Val  Loss: 0.1032 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0723 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1343 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1390 | Val  Acc: 0.9632
 Site-MNIST                         | Val  Loss: 0.1022 | Val  Acc: 0.9649
 Site-USPS                          | Val  Loss: 0.0674 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1256 | Val  Acc: 0.9744
 Site-USPS                          | Val  Loss: 0.1629 | Val  Acc: 0.9573
 Site-SynthDigits                   | Val  Loss: 0.8421 | Val  Acc: 0.7045
 Site-SynthDigits                   | Val  Loss: 0.6449 | Val  Acc: 0.7677
 Site-MNIST_M                       | Val  Loss: 1.0756 | Val  Acc: 0.6591
 Site-MNIST_M                       | Val  Loss: 1.1811 | Val  Acc: 0.5758
 Site-SVHN                          | Val  Loss: 1.6640 | Val  Acc: 0.4041
Average Valid Accuracy: 0.8383
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9632
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9649
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9808
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9744
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9573
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.7045
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.7677
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.6591
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.5758
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.4041
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.1036 | Train Acc: 0.9733
 Site-MNIST                         | Train Loss: 0.0987 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.1237 | Train Acc: 0.9586
 Site-MNIST                         | Train Loss: 0.0843 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0694 | Train Acc: 0.9851
 Site-USPS                          | Train Loss: 0.1811 | Train Acc: 0.9544
 Site-USPS                          | Train Loss: 0.1013 | Train Acc: 0.9712
 Site-USPS                          | Train Loss: 0.1195 | Train Acc: 0.9691
 Site-SynthDigits                   | Train Loss: 0.7339 | Train Acc: 0.7614
 Site-SynthDigits                   | Train Loss: 0.6122 | Train Acc: 0.8081
 Site-MNIST_M                       | Train Loss: 1.1197 | Train Acc: 0.6420
 Site-MNIST_M                       | Train Loss: 1.0770 | Train Acc: 0.6288
 Site-SVHN                          | Train Loss: 1.5711 | Train Acc: 0.4634
Average Train Accuracy: 0.8503
 Site-MNIST                         | Val  Loss: 0.0910 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0769 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1339 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1392 | Val  Acc: 0.9526
 Site-MNIST                         | Val  Loss: 0.1011 | Val  Acc: 0.9614
 Site-USPS                          | Val  Loss: 0.0726 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1398 | Val  Acc: 0.9744
 Site-USPS                          | Val  Loss: 0.1659 | Val  Acc: 0.9615
 Site-SynthDigits                   | Val  Loss: 0.8405 | Val  Acc: 0.7652
 Site-SynthDigits                   | Val  Loss: 0.6296 | Val  Acc: 0.7929
 Site-MNIST_M                       | Val  Loss: 1.0517 | Val  Acc: 0.6705
 Site-MNIST_M                       | Val  Loss: 1.1566 | Val  Acc: 0.5758
 Site-SVHN                          | Val  Loss: 1.6305 | Val  Acc: 0.4247
Average Valid Accuracy: 0.8451
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9683
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9526
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9614
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9808
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9744
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9615
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.7652
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.7929
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.6705
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.5758
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.4247
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.1135 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.1041 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.1245 | Train Acc: 0.9586
 Site-MNIST                         | Train Loss: 0.0820 | Train Acc: 0.9777
 Site-MNIST                         | Train Loss: 0.0712 | Train Acc: 0.9842
 Site-USPS                          | Train Loss: 0.1586 | Train Acc: 0.9448
 Site-USPS                          | Train Loss: 0.1012 | Train Acc: 0.9728
 Site-USPS                          | Train Loss: 0.1049 | Train Acc: 0.9712
 Site-SynthDigits                   | Train Loss: 0.7624 | Train Acc: 0.7689
 Site-SynthDigits                   | Train Loss: 0.6025 | Train Acc: 0.8131
 Site-MNIST_M                       | Train Loss: 1.1167 | Train Acc: 0.6165
 Site-MNIST_M                       | Train Loss: 1.1009 | Train Acc: 0.6250
 Site-SVHN                          | Train Loss: 1.5757 | Train Acc: 0.4446
Average Train Accuracy: 0.8467
 Site-MNIST                         | Val  Loss: 0.1066 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0818 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1440 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1361 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.0962 | Val  Acc: 0.9614
 Site-USPS                          | Val  Loss: 0.0734 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1269 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1567 | Val  Acc: 0.9359
 Site-SynthDigits                   | Val  Loss: 0.8229 | Val  Acc: 0.7424
 Site-SynthDigits                   | Val  Loss: 0.6237 | Val  Acc: 0.8030
 Site-MNIST_M                       | Val  Loss: 1.0858 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.1652 | Val  Acc: 0.5682
 Site-SVHN                          | Val  Loss: 1.6590 | Val  Acc: 0.4178
Average Valid Accuracy: 0.8355
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.1325 | Train Acc: 0.9733
 Site-MNIST                         | Train Loss: 0.0962 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.1245 | Train Acc: 0.9586
 Site-MNIST                         | Train Loss: 0.0817 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0716 | Train Acc: 0.9825
 Site-USPS                          | Train Loss: 0.1607 | Train Acc: 0.9472
 Site-USPS                          | Train Loss: 0.0986 | Train Acc: 0.9744
 Site-USPS                          | Train Loss: 0.1041 | Train Acc: 0.9681
 Site-SynthDigits                   | Train Loss: 0.7898 | Train Acc: 0.7595
 Site-SynthDigits                   | Train Loss: 0.5935 | Train Acc: 0.8258
 Site-MNIST_M                       | Train Loss: 1.0793 | Train Acc: 0.6477
 Site-MNIST_M                       | Train Loss: 1.0692 | Train Acc: 0.6458
 Site-SVHN                          | Train Loss: 1.5646 | Train Acc: 0.4549
Average Train Accuracy: 0.8520
 Site-MNIST                         | Val  Loss: 0.1196 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0900 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1385 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1417 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.1041 | Val  Acc: 0.9614
 Site-USPS                          | Val  Loss: 0.0685 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1211 | Val  Acc: 0.9744
 Site-USPS                          | Val  Loss: 0.1536 | Val  Acc: 0.9573
 Site-SynthDigits                   | Val  Loss: 0.8132 | Val  Acc: 0.7273
 Site-SynthDigits                   | Val  Loss: 0.6115 | Val  Acc: 0.7980
 Site-MNIST_M                       | Val  Loss: 1.0453 | Val  Acc: 0.6705
 Site-MNIST_M                       | Val  Loss: 1.1098 | Val  Acc: 0.6061
 Site-SVHN                          | Val  Loss: 1.6321 | Val  Acc: 0.4315
Average Valid Accuracy: 0.8432
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.1003 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.0891 | Train Acc: 0.9704
 Site-MNIST                         | Train Loss: 0.1167 | Train Acc: 0.9586
 Site-MNIST                         | Train Loss: 0.0781 | Train Acc: 0.9763
 Site-MNIST                         | Train Loss: 0.0639 | Train Acc: 0.9860
 Site-USPS                          | Train Loss: 0.1667 | Train Acc: 0.9520
 Site-USPS                          | Train Loss: 0.0947 | Train Acc: 0.9744
 Site-USPS                          | Train Loss: 0.1045 | Train Acc: 0.9681
 Site-SynthDigits                   | Train Loss: 0.7476 | Train Acc: 0.7689
 Site-SynthDigits                   | Train Loss: 0.5939 | Train Acc: 0.8232
 Site-MNIST_M                       | Train Loss: 1.1238 | Train Acc: 0.6392
 Site-MNIST_M                       | Train Loss: 1.0255 | Train Acc: 0.6345
 Site-SVHN                          | Train Loss: 1.5274 | Train Acc: 0.4668
Average Train Accuracy: 0.8529
 Site-MNIST                         | Val  Loss: 0.0965 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0822 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1298 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1309 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.0950 | Val  Acc: 0.9684
 Site-USPS                          | Val  Loss: 0.0701 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1205 | Val  Acc: 0.9744
 Site-USPS                          | Val  Loss: 0.1506 | Val  Acc: 0.9615
 Site-SynthDigits                   | Val  Loss: 0.7967 | Val  Acc: 0.7273
 Site-SynthDigits                   | Val  Loss: 0.5959 | Val  Acc: 0.7980
 Site-MNIST_M                       | Val  Loss: 1.0751 | Val  Acc: 0.6591
 Site-MNIST_M                       | Val  Loss: 1.1679 | Val  Acc: 0.5833
 Site-SVHN                          | Val  Loss: 1.6195 | Val  Acc: 0.4178
Average Valid Accuracy: 0.8413
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.0995 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.0772 | Train Acc: 0.9675
 Site-MNIST                         | Train Loss: 0.1159 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.0745 | Train Acc: 0.9790
 Site-MNIST                         | Train Loss: 0.0623 | Train Acc: 0.9895
 Site-USPS                          | Train Loss: 0.1497 | Train Acc: 0.9496
 Site-USPS                          | Train Loss: 0.0905 | Train Acc: 0.9744
 Site-USPS                          | Train Loss: 0.0934 | Train Acc: 0.9744
 Site-SynthDigits                   | Train Loss: 0.7129 | Train Acc: 0.7746
 Site-SynthDigits                   | Train Loss: 0.5832 | Train Acc: 0.8245
 Site-MNIST_M                       | Train Loss: 1.0955 | Train Acc: 0.6307
 Site-MNIST_M                       | Train Loss: 1.0328 | Train Acc: 0.6439
 Site-SVHN                          | Train Loss: 1.5492 | Train Acc: 0.4463
Average Train Accuracy: 0.8529
 Site-MNIST                         | Val  Loss: 0.0903 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0777 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1310 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1253 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.0909 | Val  Acc: 0.9649
 Site-USPS                          | Val  Loss: 0.0638 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1163 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1487 | Val  Acc: 0.9487
 Site-SynthDigits                   | Val  Loss: 0.7837 | Val  Acc: 0.7727
 Site-SynthDigits                   | Val  Loss: 0.5951 | Val  Acc: 0.8182
 Site-MNIST_M                       | Val  Loss: 1.0910 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.1319 | Val  Acc: 0.5833
 Site-SVHN                          | Val  Loss: 1.6620 | Val  Acc: 0.4041
Average Valid Accuracy: 0.8445
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.1227 | Train Acc: 0.9733
 Site-MNIST                         | Train Loss: 0.0750 | Train Acc: 0.9734
 Site-MNIST                         | Train Loss: 0.1114 | Train Acc: 0.9625
 Site-MNIST                         | Train Loss: 0.0715 | Train Acc: 0.9790
 Site-MNIST                         | Train Loss: 0.0591 | Train Acc: 0.9895
 Site-USPS                          | Train Loss: 0.1587 | Train Acc: 0.9496
 Site-USPS                          | Train Loss: 0.0860 | Train Acc: 0.9776
 Site-USPS                          | Train Loss: 0.0973 | Train Acc: 0.9723
 Site-SynthDigits                   | Train Loss: 0.7110 | Train Acc: 0.7689
 Site-SynthDigits                   | Train Loss: 0.5491 | Train Acc: 0.8194
 Site-MNIST_M                       | Train Loss: 1.0954 | Train Acc: 0.6420
 Site-MNIST_M                       | Train Loss: 1.0636 | Train Acc: 0.6402
 Site-SVHN                          | Train Loss: 1.4921 | Train Acc: 0.4787
Average Train Accuracy: 0.8559
 Site-MNIST                         | Val  Loss: 0.0773 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0685 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1234 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1219 | Val  Acc: 0.9632
 Site-MNIST                         | Val  Loss: 0.0866 | Val  Acc: 0.9719
 Site-USPS                          | Val  Loss: 0.0668 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1128 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1451 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.7732 | Val  Acc: 0.7500
 Site-SynthDigits                   | Val  Loss: 0.5882 | Val  Acc: 0.8030
 Site-MNIST_M                       | Val  Loss: 1.0832 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.1295 | Val  Acc: 0.5833
 Site-SVHN                          | Val  Loss: 1.6265 | Val  Acc: 0.4247
Average Valid Accuracy: 0.8449
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.1030 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.0835 | Train Acc: 0.9675
 Site-MNIST                         | Train Loss: 0.1122 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.0734 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0574 | Train Acc: 0.9869
 Site-USPS                          | Train Loss: 0.1607 | Train Acc: 0.9520
 Site-USPS                          | Train Loss: 0.0886 | Train Acc: 0.9760
 Site-USPS                          | Train Loss: 0.1003 | Train Acc: 0.9744
 Site-SynthDigits                   | Train Loss: 0.6954 | Train Acc: 0.7689
 Site-SynthDigits                   | Train Loss: 0.5308 | Train Acc: 0.8396
 Site-MNIST_M                       | Train Loss: 1.0712 | Train Acc: 0.6676
 Site-MNIST_M                       | Train Loss: 1.0416 | Train Acc: 0.6420
 Site-SVHN                          | Train Loss: 1.4930 | Train Acc: 0.4923
Average Train Accuracy: 0.8596
 Site-MNIST                         | Val  Loss: 0.0784 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0736 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1218 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1290 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.0951 | Val  Acc: 0.9649
 Site-USPS                          | Val  Loss: 0.0625 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1210 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1562 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.7510 | Val  Acc: 0.7424
 Site-SynthDigits                   | Val  Loss: 0.5642 | Val  Acc: 0.8182
 Site-MNIST_M                       | Val  Loss: 1.0334 | Val  Acc: 0.6932
 Site-MNIST_M                       | Val  Loss: 1.1012 | Val  Acc: 0.6364
 Site-SVHN                          | Val  Loss: 1.5723 | Val  Acc: 0.4521
Average Valid Accuracy: 0.8549
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9579
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9649
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9808
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9679
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9530
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.7424
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.8182
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.6932
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.6364
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.4521
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.0994 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.0815 | Train Acc: 0.9675
 Site-MNIST                         | Train Loss: 0.1048 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.0689 | Train Acc: 0.9816
 Site-MNIST                         | Train Loss: 0.0556 | Train Acc: 0.9886
 Site-USPS                          | Train Loss: 0.1518 | Train Acc: 0.9520
 Site-USPS                          | Train Loss: 0.0840 | Train Acc: 0.9792
 Site-USPS                          | Train Loss: 0.0949 | Train Acc: 0.9744
 Site-SynthDigits                   | Train Loss: 0.6797 | Train Acc: 0.7803
 Site-SynthDigits                   | Train Loss: 0.5516 | Train Acc: 0.8371
 Site-MNIST_M                       | Train Loss: 1.0649 | Train Acc: 0.6562
 Site-MNIST_M                       | Train Loss: 1.0104 | Train Acc: 0.6458
 Site-SVHN                          | Train Loss: 1.5094 | Train Acc: 0.4838
Average Train Accuracy: 0.8600
 Site-MNIST                         | Val  Loss: 0.0772 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0692 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1225 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1153 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.0835 | Val  Acc: 0.9649
 Site-USPS                          | Val  Loss: 0.0571 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1138 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1473 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.7441 | Val  Acc: 0.7652
 Site-SynthDigits                   | Val  Loss: 0.5697 | Val  Acc: 0.8182
 Site-MNIST_M                       | Val  Loss: 1.0622 | Val  Acc: 0.6818
 Site-MNIST_M                       | Val  Loss: 1.0976 | Val  Acc: 0.6212
 Site-SVHN                          | Val  Loss: 1.5961 | Val  Acc: 0.4384
Average Valid Accuracy: 0.8529
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.1040 | Train Acc: 0.9733
 Site-MNIST                         | Train Loss: 0.0667 | Train Acc: 0.9734
 Site-MNIST                         | Train Loss: 0.1046 | Train Acc: 0.9665
 Site-MNIST                         | Train Loss: 0.0673 | Train Acc: 0.9790
 Site-MNIST                         | Train Loss: 0.0551 | Train Acc: 0.9895
 Site-USPS                          | Train Loss: 0.1477 | Train Acc: 0.9568
 Site-USPS                          | Train Loss: 0.0843 | Train Acc: 0.9808
 Site-USPS                          | Train Loss: 0.0910 | Train Acc: 0.9744
 Site-SynthDigits                   | Train Loss: 0.6975 | Train Acc: 0.7841
 Site-SynthDigits                   | Train Loss: 0.5480 | Train Acc: 0.8283
 Site-MNIST_M                       | Train Loss: 1.0796 | Train Acc: 0.6307
 Site-MNIST_M                       | Train Loss: 1.0428 | Train Acc: 0.6572
 Site-SVHN                          | Train Loss: 1.4969 | Train Acc: 0.4736
Average Train Accuracy: 0.8590
 Site-MNIST                         | Val  Loss: 0.0744 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0661 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1236 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1121 | Val  Acc: 0.9632
 Site-MNIST                         | Val  Loss: 0.0797 | Val  Acc: 0.9719
 Site-USPS                          | Val  Loss: 0.0625 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1077 | Val  Acc: 0.9744
 Site-USPS                          | Val  Loss: 0.1371 | Val  Acc: 0.9615
 Site-SynthDigits                   | Val  Loss: 0.7425 | Val  Acc: 0.7652
 Site-SynthDigits                   | Val  Loss: 0.5685 | Val  Acc: 0.8182
 Site-MNIST_M                       | Val  Loss: 1.0884 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.1080 | Val  Acc: 0.5909
 Site-SVHN                          | Val  Loss: 1.5965 | Val  Acc: 0.4384
Average Valid Accuracy: 0.8492
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.0966 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.0763 | Train Acc: 0.9615
 Site-MNIST                         | Train Loss: 0.1038 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.0701 | Train Acc: 0.9829
 Site-MNIST                         | Train Loss: 0.0533 | Train Acc: 0.9886
 Site-USPS                          | Train Loss: 0.1560 | Train Acc: 0.9568
 Site-USPS                          | Train Loss: 0.0824 | Train Acc: 0.9776
 Site-USPS                          | Train Loss: 0.0926 | Train Acc: 0.9766
 Site-SynthDigits                   | Train Loss: 0.6789 | Train Acc: 0.7841
 Site-SynthDigits                   | Train Loss: 0.5321 | Train Acc: 0.8384
 Site-MNIST_M                       | Train Loss: 1.0721 | Train Acc: 0.6477
 Site-MNIST_M                       | Train Loss: 1.0152 | Train Acc: 0.6515
 Site-SVHN                          | Train Loss: 1.4512 | Train Acc: 0.4957
Average Train Accuracy: 0.8612
 Site-MNIST                         | Val  Loss: 0.0894 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0696 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1240 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1129 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.0850 | Val  Acc: 0.9579
 Site-USPS                          | Val  Loss: 0.0561 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1066 | Val  Acc: 0.9744
 Site-USPS                          | Val  Loss: 0.1367 | Val  Acc: 0.9658
 Site-SynthDigits                   | Val  Loss: 0.7539 | Val  Acc: 0.7500
 Site-SynthDigits                   | Val  Loss: 0.5398 | Val  Acc: 0.8232
 Site-MNIST_M                       | Val  Loss: 1.0439 | Val  Acc: 0.6818
 Site-MNIST_M                       | Val  Loss: 1.0904 | Val  Acc: 0.5985
 Site-SVHN                          | Val  Loss: 1.5681 | Val  Acc: 0.4452
Average Valid Accuracy: 0.8502
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.1062 | Train Acc: 0.9733
 Site-MNIST                         | Train Loss: 0.0910 | Train Acc: 0.9675
 Site-MNIST                         | Train Loss: 0.0981 | Train Acc: 0.9704
 Site-MNIST                         | Train Loss: 0.0618 | Train Acc: 0.9842
 Site-MNIST                         | Train Loss: 0.0503 | Train Acc: 0.9877
 Site-USPS                          | Train Loss: 0.1474 | Train Acc: 0.9544
 Site-USPS                          | Train Loss: 0.0805 | Train Acc: 0.9792
 Site-USPS                          | Train Loss: 0.0949 | Train Acc: 0.9734
 Site-SynthDigits                   | Train Loss: 0.6574 | Train Acc: 0.7955
 Site-SynthDigits                   | Train Loss: 0.5121 | Train Acc: 0.8434
 Site-MNIST_M                       | Train Loss: 1.0703 | Train Acc: 0.6506
 Site-MNIST_M                       | Train Loss: 0.9831 | Train Acc: 0.6591
 Site-SVHN                          | Train Loss: 1.4899 | Train Acc: 0.4957
Average Train Accuracy: 0.8642
 Site-MNIST                         | Val  Loss: 0.0643 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0571 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1138 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1106 | Val  Acc: 0.9632
 Site-MNIST                         | Val  Loss: 0.0784 | Val  Acc: 0.9649
 Site-USPS                          | Val  Loss: 0.0546 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1082 | Val  Acc: 0.9744
 Site-USPS                          | Val  Loss: 0.1451 | Val  Acc: 0.9615
 Site-SynthDigits                   | Val  Loss: 0.7324 | Val  Acc: 0.7879
 Site-SynthDigits                   | Val  Loss: 0.5397 | Val  Acc: 0.8283
 Site-MNIST_M                       | Val  Loss: 1.0334 | Val  Acc: 0.6591
 Site-MNIST_M                       | Val  Loss: 1.0699 | Val  Acc: 0.6136
 Site-SVHN                          | Val  Loss: 1.5732 | Val  Acc: 0.4521
Average Valid Accuracy: 0.8557
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9683
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9632
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9649
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9808
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9744
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9615
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.7879
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.8283
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.6591
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.6136
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.4521
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.0882 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.0682 | Train Acc: 0.9763
 Site-MNIST                         | Train Loss: 0.0961 | Train Acc: 0.9665
 Site-MNIST                         | Train Loss: 0.0644 | Train Acc: 0.9803
 Site-MNIST                         | Train Loss: 0.0474 | Train Acc: 0.9895
 Site-USPS                          | Train Loss: 0.1652 | Train Acc: 0.9544
 Site-USPS                          | Train Loss: 0.0792 | Train Acc: 0.9776
 Site-USPS                          | Train Loss: 0.0941 | Train Acc: 0.9712
 Site-SynthDigits                   | Train Loss: 0.6255 | Train Acc: 0.8030
 Site-SynthDigits                   | Train Loss: 0.5056 | Train Acc: 0.8333
 Site-MNIST_M                       | Train Loss: 1.0794 | Train Acc: 0.6648
 Site-MNIST_M                       | Train Loss: 0.9702 | Train Acc: 0.6591
 Site-SVHN                          | Train Loss: 1.4591 | Train Acc: 0.4940
Average Train Accuracy: 0.8642
 Site-MNIST                         | Val  Loss: 0.0590 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0585 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1096 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1028 | Val  Acc: 0.9737
 Site-MNIST                         | Val  Loss: 0.0762 | Val  Acc: 0.9754
 Site-USPS                          | Val  Loss: 0.0507 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1053 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1450 | Val  Acc: 0.9573
 Site-SynthDigits                   | Val  Loss: 0.6972 | Val  Acc: 0.7879
 Site-SynthDigits                   | Val  Loss: 0.5359 | Val  Acc: 0.8232
 Site-MNIST_M                       | Val  Loss: 1.0421 | Val  Acc: 0.7159
 Site-MNIST_M                       | Val  Loss: 1.0943 | Val  Acc: 0.6136
 Site-SVHN                          | Val  Loss: 1.5531 | Val  Acc: 0.4521
Average Valid Accuracy: 0.8619
 Best site-MNIST                     | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9683
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9737
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9754
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9808
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9679
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9573
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.7879
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.8232
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.7159
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.6136
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.4521
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.0903 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.0738 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.0962 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.0621 | Train Acc: 0.9829
 Site-MNIST                         | Train Loss: 0.0494 | Train Acc: 0.9895
 Site-USPS                          | Train Loss: 0.1315 | Train Acc: 0.9592
 Site-USPS                          | Train Loss: 0.0772 | Train Acc: 0.9808
 Site-USPS                          | Train Loss: 0.0839 | Train Acc: 0.9755
 Site-SynthDigits                   | Train Loss: 0.6686 | Train Acc: 0.8049
 Site-SynthDigits                   | Train Loss: 0.4848 | Train Acc: 0.8396
 Site-MNIST_M                       | Train Loss: 1.0386 | Train Acc: 0.6676
 Site-MNIST_M                       | Train Loss: 0.9858 | Train Acc: 0.6667
 Site-SVHN                          | Train Loss: 1.4607 | Train Acc: 0.4940
Average Train Accuracy: 0.8661
 Site-MNIST                         | Val  Loss: 0.0665 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0598 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1184 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1046 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.0777 | Val  Acc: 0.9614
 Site-USPS                          | Val  Loss: 0.0470 | Val  Acc: 0.9904
 Site-USPS                          | Val  Loss: 0.0984 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1347 | Val  Acc: 0.9658
 Site-SynthDigits                   | Val  Loss: 0.6885 | Val  Acc: 0.7803
 Site-SynthDigits                   | Val  Loss: 0.5265 | Val  Acc: 0.8232
 Site-MNIST_M                       | Val  Loss: 1.0231 | Val  Acc: 0.6591
 Site-MNIST_M                       | Val  Loss: 1.0785 | Val  Acc: 0.6212
 Site-SVHN                          | Val  Loss: 1.5808 | Val  Acc: 0.4521
Average Valid Accuracy: 0.8562
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.0954 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.0651 | Train Acc: 0.9675
 Site-MNIST                         | Train Loss: 0.0949 | Train Acc: 0.9724
 Site-MNIST                         | Train Loss: 0.0613 | Train Acc: 0.9816
 Site-MNIST                         | Train Loss: 0.0465 | Train Acc: 0.9895
 Site-USPS                          | Train Loss: 0.1500 | Train Acc: 0.9544
 Site-USPS                          | Train Loss: 0.0732 | Train Acc: 0.9824
 Site-USPS                          | Train Loss: 0.0873 | Train Acc: 0.9766
 Site-SynthDigits                   | Train Loss: 0.6602 | Train Acc: 0.8030
 Site-SynthDigits                   | Train Loss: 0.4850 | Train Acc: 0.8535
 Site-MNIST_M                       | Train Loss: 1.0383 | Train Acc: 0.6619
 Site-MNIST_M                       | Train Loss: 0.9865 | Train Acc: 0.6572
 Site-SVHN                          | Train Loss: 1.4605 | Train Acc: 0.4957
Average Train Accuracy: 0.8665
 Site-MNIST                         | Val  Loss: 0.0712 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0647 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1136 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1075 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.0797 | Val  Acc: 0.9649
 Site-USPS                          | Val  Loss: 0.0448 | Val  Acc: 0.9904
 Site-USPS                          | Val  Loss: 0.1005 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1378 | Val  Acc: 0.9573
 Site-SynthDigits                   | Val  Loss: 0.6745 | Val  Acc: 0.7727
 Site-SynthDigits                   | Val  Loss: 0.5268 | Val  Acc: 0.8333
 Site-MNIST_M                       | Val  Loss: 1.0528 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.1035 | Val  Acc: 0.5985
 Site-SVHN                          | Val  Loss: 1.5773 | Val  Acc: 0.4589
Average Valid Accuracy: 0.8529
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.0897 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.0811 | Train Acc: 0.9704
 Site-MNIST                         | Train Loss: 0.0979 | Train Acc: 0.9684
 Site-MNIST                         | Train Loss: 0.0595 | Train Acc: 0.9829
 Site-MNIST                         | Train Loss: 0.0457 | Train Acc: 0.9904
 Site-USPS                          | Train Loss: 0.1461 | Train Acc: 0.9544
 Site-USPS                          | Train Loss: 0.0707 | Train Acc: 0.9824
 Site-USPS                          | Train Loss: 0.0805 | Train Acc: 0.9798
 Site-SynthDigits                   | Train Loss: 0.6494 | Train Acc: 0.8030
 Site-SynthDigits                   | Train Loss: 0.4729 | Train Acc: 0.8561
 Site-MNIST_M                       | Train Loss: 1.0467 | Train Acc: 0.6648
 Site-MNIST_M                       | Train Loss: 0.9595 | Train Acc: 0.6629
 Site-SVHN                          | Train Loss: 1.4322 | Train Acc: 0.4838
Average Train Accuracy: 0.8668
 Site-MNIST                         | Val  Loss: 0.0772 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0649 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1189 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1091 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.0785 | Val  Acc: 0.9684
 Site-USPS                          | Val  Loss: 0.0448 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.0952 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1303 | Val  Acc: 0.9573
 Site-SynthDigits                   | Val  Loss: 0.6496 | Val  Acc: 0.7803
 Site-SynthDigits                   | Val  Loss: 0.5082 | Val  Acc: 0.8232
 Site-MNIST_M                       | Val  Loss: 1.0232 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.0595 | Val  Acc: 0.6136
 Site-SVHN                          | Val  Loss: 1.5885 | Val  Acc: 0.4247
Average Valid Accuracy: 0.8503
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.0880 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.0629 | Train Acc: 0.9704
 Site-MNIST                         | Train Loss: 0.0947 | Train Acc: 0.9625
 Site-MNIST                         | Train Loss: 0.0583 | Train Acc: 0.9816
 Site-MNIST                         | Train Loss: 0.0461 | Train Acc: 0.9904
 Site-USPS                          | Train Loss: 0.1309 | Train Acc: 0.9568
 Site-USPS                          | Train Loss: 0.0689 | Train Acc: 0.9840
 Site-USPS                          | Train Loss: 0.0765 | Train Acc: 0.9798
 Site-SynthDigits                   | Train Loss: 0.6489 | Train Acc: 0.7936
 Site-SynthDigits                   | Train Loss: 0.4847 | Train Acc: 0.8485
 Site-MNIST_M                       | Train Loss: 1.0491 | Train Acc: 0.6591
 Site-MNIST_M                       | Train Loss: 0.9786 | Train Acc: 0.6686
 Site-SVHN                          | Train Loss: 1.5207 | Train Acc: 0.4974
Average Train Accuracy: 0.8663
 Site-MNIST                         | Val  Loss: 0.0715 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0580 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1157 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.0993 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.0734 | Val  Acc: 0.9684
 Site-USPS                          | Val  Loss: 0.0414 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0906 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1261 | Val  Acc: 0.9615
 Site-SynthDigits                   | Val  Loss: 0.6505 | Val  Acc: 0.7500
 Site-SynthDigits                   | Val  Loss: 0.5032 | Val  Acc: 0.8030
 Site-MNIST_M                       | Val  Loss: 1.0466 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.0832 | Val  Acc: 0.5985
 Site-SVHN                          | Val  Loss: 1.5783 | Val  Acc: 0.4452
Average Valid Accuracy: 0.8501
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.0984 | Train Acc: 0.9733
 Site-MNIST                         | Train Loss: 0.0622 | Train Acc: 0.9734
 Site-MNIST                         | Train Loss: 0.0940 | Train Acc: 0.9665
 Site-MNIST                         | Train Loss: 0.0586 | Train Acc: 0.9829
 Site-MNIST                         | Train Loss: 0.0433 | Train Acc: 0.9904
 Site-USPS                          | Train Loss: 0.1296 | Train Acc: 0.9568
 Site-USPS                          | Train Loss: 0.0686 | Train Acc: 0.9824
 Site-USPS                          | Train Loss: 0.0768 | Train Acc: 0.9776
 Site-SynthDigits                   | Train Loss: 0.6076 | Train Acc: 0.8068
 Site-SynthDigits                   | Train Loss: 0.4630 | Train Acc: 0.8662
 Site-MNIST_M                       | Train Loss: 1.0520 | Train Acc: 0.6676
 Site-MNIST_M                       | Train Loss: 0.9657 | Train Acc: 0.6742
 Site-SVHN                          | Train Loss: 1.4348 | Train Acc: 0.4957
Average Train Accuracy: 0.8703
 Site-MNIST                         | Val  Loss: 0.0671 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0590 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1099 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1021 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.0780 | Val  Acc: 0.9684
 Site-USPS                          | Val  Loss: 0.0424 | Val  Acc: 0.9904
 Site-USPS                          | Val  Loss: 0.0943 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1279 | Val  Acc: 0.9573
 Site-SynthDigits                   | Val  Loss: 0.6350 | Val  Acc: 0.7803
 Site-SynthDigits                   | Val  Loss: 0.4848 | Val  Acc: 0.8333
 Site-MNIST_M                       | Val  Loss: 1.0303 | Val  Acc: 0.6705
 Site-MNIST_M                       | Val  Loss: 1.0715 | Val  Acc: 0.6136
 Site-SVHN                          | Val  Loss: 1.5424 | Val  Acc: 0.4521
Average Valid Accuracy: 0.8557
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.0980 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.0808 | Train Acc: 0.9763
 Site-MNIST                         | Train Loss: 0.0881 | Train Acc: 0.9704
 Site-MNIST                         | Train Loss: 0.0536 | Train Acc: 0.9855
 Site-MNIST                         | Train Loss: 0.0426 | Train Acc: 0.9877
 Site-USPS                          | Train Loss: 0.1287 | Train Acc: 0.9592
 Site-USPS                          | Train Loss: 0.0686 | Train Acc: 0.9824
 Site-USPS                          | Train Loss: 0.0786 | Train Acc: 0.9776
 Site-SynthDigits                   | Train Loss: 0.6065 | Train Acc: 0.7936
 Site-SynthDigits                   | Train Loss: 0.4590 | Train Acc: 0.8535
 Site-MNIST_M                       | Train Loss: 1.0247 | Train Acc: 0.6534
 Site-MNIST_M                       | Train Loss: 0.9477 | Train Acc: 0.6742
 Site-SVHN                          | Train Loss: 1.4755 | Train Acc: 0.5043
Average Train Accuracy: 0.8682
 Site-MNIST                         | Val  Loss: 0.0546 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0483 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1089 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.0992 | Val  Acc: 0.9632
 Site-MNIST                         | Val  Loss: 0.0692 | Val  Acc: 0.9719
 Site-USPS                          | Val  Loss: 0.0477 | Val  Acc: 0.9904
 Site-USPS                          | Val  Loss: 0.0923 | Val  Acc: 0.9744
 Site-USPS                          | Val  Loss: 0.1240 | Val  Acc: 0.9658
 Site-SynthDigits                   | Val  Loss: 0.6409 | Val  Acc: 0.7652
 Site-SynthDigits                   | Val  Loss: 0.4874 | Val  Acc: 0.8030
 Site-MNIST_M                       | Val  Loss: 1.0362 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.0656 | Val  Acc: 0.5985
 Site-SVHN                          | Val  Loss: 1.5531 | Val  Acc: 0.4521
Average Valid Accuracy: 0.8536
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.0933 | Train Acc: 0.9733
 Site-MNIST                         | Train Loss: 0.0657 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.0912 | Train Acc: 0.9665
 Site-MNIST                         | Train Loss: 0.0575 | Train Acc: 0.9842
 Site-MNIST                         | Train Loss: 0.0420 | Train Acc: 0.9904
 Site-USPS                          | Train Loss: 0.1297 | Train Acc: 0.9616
 Site-USPS                          | Train Loss: 0.0682 | Train Acc: 0.9824
 Site-USPS                          | Train Loss: 0.0708 | Train Acc: 0.9798
 Site-SynthDigits                   | Train Loss: 0.6143 | Train Acc: 0.8049
 Site-SynthDigits                   | Train Loss: 0.4457 | Train Acc: 0.8687
 Site-MNIST_M                       | Train Loss: 1.0352 | Train Acc: 0.6562
 Site-MNIST_M                       | Train Loss: 0.9556 | Train Acc: 0.6818
 Site-SVHN                          | Train Loss: 1.4612 | Train Acc: 0.4991
Average Train Accuracy: 0.8703
 Site-MNIST                         | Val  Loss: 0.0663 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0621 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1142 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1001 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.0731 | Val  Acc: 0.9614
 Site-USPS                          | Val  Loss: 0.0487 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.0922 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1207 | Val  Acc: 0.9701
 Site-SynthDigits                   | Val  Loss: 0.6441 | Val  Acc: 0.7879
 Site-SynthDigits                   | Val  Loss: 0.4821 | Val  Acc: 0.8232
 Site-MNIST_M                       | Val  Loss: 1.0384 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.0684 | Val  Acc: 0.6061
 Site-SVHN                          | Val  Loss: 1.5451 | Val  Acc: 0.4589
Average Valid Accuracy: 0.8549
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.0842 | Train Acc: 0.9600
 Site-MNIST                         | Train Loss: 0.0597 | Train Acc: 0.9734
 Site-MNIST                         | Train Loss: 0.0898 | Train Acc: 0.9704
 Site-MNIST                         | Train Loss: 0.0529 | Train Acc: 0.9829
 Site-MNIST                         | Train Loss: 0.0397 | Train Acc: 0.9886
 Site-USPS                          | Train Loss: 0.1198 | Train Acc: 0.9544
 Site-USPS                          | Train Loss: 0.0624 | Train Acc: 0.9840
 Site-USPS                          | Train Loss: 0.0724 | Train Acc: 0.9787
 Site-SynthDigits                   | Train Loss: 0.6299 | Train Acc: 0.7936
 Site-SynthDigits                   | Train Loss: 0.4647 | Train Acc: 0.8561
 Site-MNIST_M                       | Train Loss: 1.0361 | Train Acc: 0.6619
 Site-MNIST_M                       | Train Loss: 0.9512 | Train Acc: 0.6648
 Site-SVHN                          | Train Loss: 1.4986 | Train Acc: 0.4957
Average Train Accuracy: 0.8665
 Site-MNIST                         | Val  Loss: 0.0556 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0446 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1196 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1026 | Val  Acc: 0.9684
 Site-MNIST                         | Val  Loss: 0.0681 | Val  Acc: 0.9719
 Site-USPS                          | Val  Loss: 0.0419 | Val  Acc: 0.9904
 Site-USPS                          | Val  Loss: 0.0887 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1164 | Val  Acc: 0.9615
 Site-SynthDigits                   | Val  Loss: 0.6674 | Val  Acc: 0.7576
 Site-SynthDigits                   | Val  Loss: 0.4978 | Val  Acc: 0.8182
 Site-MNIST_M                       | Val  Loss: 1.0222 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.1116 | Val  Acc: 0.6061
 Site-SVHN                          | Val  Loss: 1.5885 | Val  Acc: 0.4521
Average Valid Accuracy: 0.8523
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.0876 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.0698 | Train Acc: 0.9763
 Site-MNIST                         | Train Loss: 0.0903 | Train Acc: 0.9665
 Site-MNIST                         | Train Loss: 0.0531 | Train Acc: 0.9829
 Site-MNIST                         | Train Loss: 0.0375 | Train Acc: 0.9912
 Site-USPS                          | Train Loss: 0.1228 | Train Acc: 0.9568
 Site-USPS                          | Train Loss: 0.0650 | Train Acc: 0.9856
 Site-USPS                          | Train Loss: 0.0692 | Train Acc: 0.9798
 Site-SynthDigits                   | Train Loss: 0.5946 | Train Acc: 0.8011
 Site-SynthDigits                   | Train Loss: 0.4508 | Train Acc: 0.8636
 Site-MNIST_M                       | Train Loss: 1.0288 | Train Acc: 0.6619
 Site-MNIST_M                       | Train Loss: 0.9478 | Train Acc: 0.6894
 Site-SVHN                          | Train Loss: 1.4744 | Train Acc: 0.5009
Average Train Accuracy: 0.8708
 Site-MNIST                         | Val  Loss: 0.0716 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0632 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1137 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1032 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.0730 | Val  Acc: 0.9719
 Site-USPS                          | Val  Loss: 0.0442 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.0862 | Val  Acc: 0.9744
 Site-USPS                          | Val  Loss: 0.1137 | Val  Acc: 0.9658
 Site-SynthDigits                   | Val  Loss: 0.6380 | Val  Acc: 0.7652
 Site-SynthDigits                   | Val  Loss: 0.5025 | Val  Acc: 0.8131
 Site-MNIST_M                       | Val  Loss: 1.0189 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.0489 | Val  Acc: 0.6212
 Site-SVHN                          | Val  Loss: 1.5900 | Val  Acc: 0.4589
Average Valid Accuracy: 0.8503
===2023-06-30 12:28:52===
===2023-06-30 12:28:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:40 | Test Acc: 0.9506
 Test site-USPS                      | Epoch:40 | Test Acc: 0.9495
 Test site-SynthDigits               | Epoch:40 | Test Acc: 0.7442
 Test site-MNIST_M                   | Epoch:40 | Test Acc: 0.5049
 Test site-SVHN                      | Epoch:40 | Test Acc: 0.3707
MNIST: 0.9506, USPS: 0.9495, SynthDigits: 0.7442, MNIST_M: 0.5049, SVHN: 0.3707, 
Average Test Accuracy(group): 0.7040, Average Test Accuracy(individual): 0.8054,
domain std=0.2338, cluster std=-1.0000, individual std=0.2047, 
===2023-06-30 14:20:51===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 1.4908 | Train Acc: 0.8000
 Site-MNIST                         | Train Loss: 1.5175 | Train Acc: 0.7781
 Site-MNIST                         | Train Loss: 1.5647 | Train Acc: 0.7239
 Site-MNIST                         | Train Loss: 1.5211 | Train Acc: 0.7740
 Site-MNIST                         | Train Loss: 1.5244 | Train Acc: 0.7697
 Site-USPS                          | Train Loss: 1.4435 | Train Acc: 0.7506
 Site-USPS                          | Train Loss: 1.4216 | Train Acc: 0.7668
 Site-USPS                          | Train Loss: 1.4058 | Train Acc: 0.7987
 Site-SynthDigits                   | Train Loss: 2.0802 | Train Acc: 0.3277
 Site-SynthDigits                   | Train Loss: 2.0348 | Train Acc: 0.3763
 Site-MNIST_M                       | Train Loss: 2.1898 | Train Acc: 0.2784
 Site-MNIST_M                       | Train Loss: 2.2059 | Train Acc: 0.2311
 Site-SVHN                          | Train Loss: 2.2292 | Train Acc: 0.1976
Average Train Accuracy: 0.5825
 Site-MNIST                         | Val  Loss: 1.5386 | Val  Acc: 0.7857
 Site-MNIST                         | Val  Loss: 1.5791 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 1.5162 | Val  Acc: 0.7698
 Site-MNIST                         | Val  Loss: 1.5453 | Val  Acc: 0.7158
 Site-MNIST                         | Val  Loss: 1.5328 | Val  Acc: 0.7579
 Site-USPS                          | Val  Loss: 1.4365 | Val  Acc: 0.7115
 Site-USPS                          | Val  Loss: 1.4592 | Val  Acc: 0.7436
 Site-USPS                          | Val  Loss: 1.4253 | Val  Acc: 0.7479
 Site-SynthDigits                   | Val  Loss: 2.1298 | Val  Acc: 0.3258
 Site-SynthDigits                   | Val  Loss: 2.0856 | Val  Acc: 0.3182
 Site-MNIST_M                       | Val  Loss: 2.1697 | Val  Acc: 0.3182
 Site-MNIST_M                       | Val  Loss: 2.2006 | Val  Acc: 0.2424
 Site-SVHN                          | Val  Loss: 2.2173 | Val  Acc: 0.2055
Average Valid Accuracy: 0.5741
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7857
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7698
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7158
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7579
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7115
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7436
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7479
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.3258
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.3182
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.3182
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.2424
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2055
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.0032 | Train Acc: 0.7867
 Site-MNIST                         | Train Loss: 1.0546 | Train Acc: 0.7929
 Site-MNIST                         | Train Loss: 1.1156 | Train Acc: 0.7535
 Site-MNIST                         | Train Loss: 1.0443 | Train Acc: 0.7806
 Site-MNIST                         | Train Loss: 1.0491 | Train Acc: 0.8039
 Site-USPS                          | Train Loss: 1.0119 | Train Acc: 0.7938
 Site-USPS                          | Train Loss: 0.9705 | Train Acc: 0.8099
 Site-USPS                          | Train Loss: 0.9428 | Train Acc: 0.8381
 Site-SynthDigits                   | Train Loss: 1.8941 | Train Acc: 0.4053
 Site-SynthDigits                   | Train Loss: 1.8300 | Train Acc: 0.4533
 Site-MNIST_M                       | Train Loss: 2.0543 | Train Acc: 0.3608
 Site-MNIST_M                       | Train Loss: 2.0925 | Train Acc: 0.3144
 Site-SVHN                          | Train Loss: 2.1858 | Train Acc: 0.2419
Average Train Accuracy: 0.6258
 Site-MNIST                         | Val  Loss: 1.0342 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.0869 | Val  Acc: 0.8095
 Site-MNIST                         | Val  Loss: 1.0563 | Val  Acc: 0.8016
 Site-MNIST                         | Val  Loss: 1.0913 | Val  Acc: 0.7684
 Site-MNIST                         | Val  Loss: 1.0720 | Val  Acc: 0.7789
 Site-USPS                          | Val  Loss: 0.9751 | Val  Acc: 0.7885
 Site-USPS                          | Val  Loss: 1.0126 | Val  Acc: 0.7885
 Site-USPS                          | Val  Loss: 1.0118 | Val  Acc: 0.7778
 Site-SynthDigits                   | Val  Loss: 1.9678 | Val  Acc: 0.4167
 Site-SynthDigits                   | Val  Loss: 1.8792 | Val  Acc: 0.4192
 Site-MNIST_M                       | Val  Loss: 2.0136 | Val  Acc: 0.4545
 Site-MNIST_M                       | Val  Loss: 2.0535 | Val  Acc: 0.3636
 Site-SVHN                          | Val  Loss: 2.1742 | Val  Acc: 0.2466
Average Valid Accuracy: 0.6321
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8095
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8016
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7684
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7789
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7885
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7885
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7778
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.4167
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.4192
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.4545
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.3636
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2466
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 0.7629 | Train Acc: 0.8267
 Site-MNIST                         | Train Loss: 0.7722 | Train Acc: 0.8491
 Site-MNIST                         | Train Loss: 0.8402 | Train Acc: 0.8146
 Site-MNIST                         | Train Loss: 0.7692 | Train Acc: 0.8279
 Site-MNIST                         | Train Loss: 0.7726 | Train Acc: 0.8494
 Site-USPS                          | Train Loss: 0.7878 | Train Acc: 0.8010
 Site-USPS                          | Train Loss: 0.7287 | Train Acc: 0.8259
 Site-USPS                          | Train Loss: 0.7192 | Train Acc: 0.8339
 Site-SynthDigits                   | Train Loss: 1.7786 | Train Acc: 0.4223
 Site-SynthDigits                   | Train Loss: 1.6812 | Train Acc: 0.4861
 Site-MNIST_M                       | Train Loss: 1.9565 | Train Acc: 0.3864
 Site-MNIST_M                       | Train Loss: 1.9887 | Train Acc: 0.3580
 Site-SVHN                          | Train Loss: 2.1372 | Train Acc: 0.2998
Average Train Accuracy: 0.6601
 Site-MNIST                         | Val  Loss: 0.7456 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.7891 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.7667 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.7996 | Val  Acc: 0.8474
 Site-MNIST                         | Val  Loss: 0.8073 | Val  Acc: 0.8351
 Site-USPS                          | Val  Loss: 0.7006 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.7514 | Val  Acc: 0.7885
 Site-USPS                          | Val  Loss: 0.7928 | Val  Acc: 0.7863
 Site-SynthDigits                   | Val  Loss: 1.8854 | Val  Acc: 0.4545
 Site-SynthDigits                   | Val  Loss: 1.7435 | Val  Acc: 0.4293
 Site-MNIST_M                       | Val  Loss: 1.9286 | Val  Acc: 0.4432
 Site-MNIST_M                       | Val  Loss: 1.9466 | Val  Acc: 0.3712
 Site-SVHN                          | Val  Loss: 2.1344 | Val  Acc: 0.2877
Average Valid Accuracy: 0.6692
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8810
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8474
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8351
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8077
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7885
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7863
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.4545
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.4293
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4432
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.3712
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2877
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 0.6444 | Train Acc: 0.8444
 Site-MNIST                         | Train Loss: 0.6390 | Train Acc: 0.8580
 Site-MNIST                         | Train Loss: 0.7101 | Train Acc: 0.8185
 Site-MNIST                         | Train Loss: 0.6431 | Train Acc: 0.8305
 Site-MNIST                         | Train Loss: 0.6475 | Train Acc: 0.8424
 Site-USPS                          | Train Loss: 0.5968 | Train Acc: 0.8393
 Site-USPS                          | Train Loss: 0.5485 | Train Acc: 0.8578
 Site-USPS                          | Train Loss: 0.5375 | Train Acc: 0.8871
 Site-SynthDigits                   | Train Loss: 1.6628 | Train Acc: 0.4678
 Site-SynthDigits                   | Train Loss: 1.5609 | Train Acc: 0.5278
 Site-MNIST_M                       | Train Loss: 1.8121 | Train Acc: 0.4460
 Site-MNIST_M                       | Train Loss: 1.8643 | Train Acc: 0.3883
 Site-SVHN                          | Train Loss: 2.0993 | Train Acc: 0.2760
Average Train Accuracy: 0.6834
 Site-MNIST                         | Val  Loss: 0.6109 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.6349 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.6561 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.6695 | Val  Acc: 0.8474
 Site-MNIST                         | Val  Loss: 0.6691 | Val  Acc: 0.8456
 Site-USPS                          | Val  Loss: 0.5238 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.5647 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.6066 | Val  Acc: 0.8333
 Site-SynthDigits                   | Val  Loss: 1.8265 | Val  Acc: 0.4773
 Site-SynthDigits                   | Val  Loss: 1.6034 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.7727 | Val  Acc: 0.4773
 Site-MNIST_M                       | Val  Loss: 1.8132 | Val  Acc: 0.4318
 Site-SVHN                          | Val  Loss: 2.1066 | Val  Acc: 0.2945
Average Valid Accuracy: 0.6967
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8810
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8810
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8474
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8456
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8846
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8462
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8333
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4773
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.4773
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.4318
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2945
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 0.5371 | Train Acc: 0.8667
 Site-MNIST                         | Train Loss: 0.5368 | Train Acc: 0.8639
 Site-MNIST                         | Train Loss: 0.6097 | Train Acc: 0.8481
 Site-MNIST                         | Train Loss: 0.5415 | Train Acc: 0.8660
 Site-MNIST                         | Train Loss: 0.5395 | Train Acc: 0.8748
 Site-USPS                          | Train Loss: 0.5427 | Train Acc: 0.8537
 Site-USPS                          | Train Loss: 0.4826 | Train Acc: 0.8690
 Site-USPS                          | Train Loss: 0.4682 | Train Acc: 0.8956
 Site-SynthDigits                   | Train Loss: 1.5751 | Train Acc: 0.4886
 Site-SynthDigits                   | Train Loss: 1.4729 | Train Acc: 0.5492
 Site-MNIST_M                       | Train Loss: 1.7248 | Train Acc: 0.4716
 Site-MNIST_M                       | Train Loss: 1.8555 | Train Acc: 0.3996
 Site-SVHN                          | Train Loss: 2.0482 | Train Acc: 0.2913
Average Train Accuracy: 0.7029
 Site-MNIST                         | Val  Loss: 0.5123 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.5365 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.5390 | Val  Acc: 0.8968
 Site-MNIST                         | Val  Loss: 0.5634 | Val  Acc: 0.8684
 Site-MNIST                         | Val  Loss: 0.5692 | Val  Acc: 0.8526
 Site-USPS                          | Val  Loss: 0.4415 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.5043 | Val  Acc: 0.8397
 Site-USPS                          | Val  Loss: 0.5472 | Val  Acc: 0.8419
 Site-SynthDigits                   | Val  Loss: 1.7651 | Val  Acc: 0.4621
 Site-SynthDigits                   | Val  Loss: 1.5135 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.6836 | Val  Acc: 0.5114
 Site-MNIST_M                       | Val  Loss: 1.7075 | Val  Acc: 0.4621
 Site-SVHN                          | Val  Loss: 2.0809 | Val  Acc: 0.2740
Average Valid Accuracy: 0.7087
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8968
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8684
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8526
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8942
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8397
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8419
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4621
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.5114
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.4621
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2740
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 0.4817 | Train Acc: 0.8800
 Site-MNIST                         | Train Loss: 0.4587 | Train Acc: 0.8876
 Site-MNIST                         | Train Loss: 0.5294 | Train Acc: 0.8521
 Site-MNIST                         | Train Loss: 0.4691 | Train Acc: 0.8765
 Site-MNIST                         | Train Loss: 0.4683 | Train Acc: 0.8800
 Site-USPS                          | Train Loss: 0.4844 | Train Acc: 0.8633
 Site-USPS                          | Train Loss: 0.4144 | Train Acc: 0.8930
 Site-USPS                          | Train Loss: 0.4082 | Train Acc: 0.9020
 Site-SynthDigits                   | Train Loss: 1.5464 | Train Acc: 0.5095
 Site-SynthDigits                   | Train Loss: 1.4169 | Train Acc: 0.5593
 Site-MNIST_M                       | Train Loss: 1.7226 | Train Acc: 0.4602
 Site-MNIST_M                       | Train Loss: 1.8218 | Train Acc: 0.4034
 Site-SVHN                          | Train Loss: 2.0157 | Train Acc: 0.2964
Average Train Accuracy: 0.7126
 Site-MNIST                         | Val  Loss: 0.4258 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.4344 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.4664 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.4787 | Val  Acc: 0.8947
 Site-MNIST                         | Val  Loss: 0.4869 | Val  Acc: 0.8772
 Site-USPS                          | Val  Loss: 0.3745 | Val  Acc: 0.9135
 Site-USPS                          | Val  Loss: 0.4428 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.4870 | Val  Acc: 0.8462
 Site-SynthDigits                   | Val  Loss: 1.7081 | Val  Acc: 0.4697
 Site-SynthDigits                   | Val  Loss: 1.4288 | Val  Acc: 0.5303
 Site-MNIST_M                       | Val  Loss: 1.6542 | Val  Acc: 0.5114
 Site-MNIST_M                       | Val  Loss: 1.7336 | Val  Acc: 0.4167
 Site-SVHN                          | Val  Loss: 2.0678 | Val  Acc: 0.2945
Average Valid Accuracy: 0.7167
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8810
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8947
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8772
 Best site-USPS                      | Epoch:5 | Val Acc: 0.9135
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8846
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8462
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4697
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.5303
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.5114
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.4167
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2945
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.4348 | Train Acc: 0.8844
 Site-MNIST                         | Train Loss: 0.4249 | Train Acc: 0.8876
 Site-MNIST                         | Train Loss: 0.4741 | Train Acc: 0.8659
 Site-MNIST                         | Train Loss: 0.4166 | Train Acc: 0.8870
===2023-06-30 14:33:11===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.0767 | Train Acc: 0.6311
 Site-MNIST                         | Train Loss: 2.0985 | Train Acc: 0.5740
 Site-MNIST                         | Train Loss: 2.1118 | Train Acc: 0.5148
 Site-MNIST                         | Train Loss: 2.1002 | Train Acc: 0.5375
 Site-MNIST                         | Train Loss: 2.0983 | Train Acc: 0.5464
 Site-USPS                          | Train Loss: 2.0785 | Train Acc: 0.5971
 Site-USPS                          | Train Loss: 2.0744 | Train Acc: 0.6166
 Site-USPS                          | Train Loss: 2.0615 | Train Acc: 0.6528
 Site-SynthDigits                   | Train Loss: 2.2520 | Train Acc: 0.2292
 Site-SynthDigits                   | Train Loss: 2.2302 | Train Acc: 0.2790
 Site-MNIST_M                       | Train Loss: 2.2757 | Train Acc: 0.1705
 Site-MNIST_M                       | Train Loss: 2.2832 | Train Acc: 0.1193
 Site-SVHN                          | Train Loss: 2.2751 | Train Acc: 0.1397
Average Train Accuracy: 0.4314
 Site-MNIST                         | Val  Loss: 2.1094 | Val  Acc: 0.5536
 Site-MNIST                         | Val  Loss: 2.1397 | Val  Acc: 0.5238
 Site-MNIST                         | Val  Loss: 2.0944 | Val  Acc: 0.5952
 Site-MNIST                         | Val  Loss: 2.1077 | Val  Acc: 0.5263
 Site-MNIST                         | Val  Loss: 2.1046 | Val  Acc: 0.5614
 Site-USPS                          | Val  Loss: 2.0869 | Val  Acc: 0.6058
 Site-USPS                          | Val  Loss: 2.0854 | Val  Acc: 0.5962
 Site-USPS                          | Val  Loss: 2.0733 | Val  Acc: 0.6026
 Site-SynthDigits                   | Val  Loss: 2.2495 | Val  Acc: 0.2197
 Site-SynthDigits                   | Val  Loss: 2.2496 | Val  Acc: 0.2172
 Site-MNIST_M                       | Val  Loss: 2.2778 | Val  Acc: 0.1818
 Site-MNIST_M                       | Val  Loss: 2.2662 | Val  Acc: 0.2045
 Site-SVHN                          | Val  Loss: 2.2742 | Val  Acc: 0.1781
Average Valid Accuracy: 0.4282
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5536
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5238
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5952
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5263
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5614
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6058
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5962
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6026
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2197
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2172
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1818
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.2045
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1781
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.8732 | Train Acc: 0.6844
 Site-MNIST                         | Train Loss: 1.9067 | Train Acc: 0.6391
 Site-MNIST                         | Train Loss: 1.9250 | Train Acc: 0.5759
 Site-MNIST                         | Train Loss: 1.9009 | Train Acc: 0.6005
 Site-MNIST                         | Train Loss: 1.8966 | Train Acc: 0.6252
 Site-USPS                          | Train Loss: 1.8810 | Train Acc: 0.6235
 Site-USPS                          | Train Loss: 1.8755 | Train Acc: 0.6565
 Site-USPS                          | Train Loss: 1.8532 | Train Acc: 0.6976
 Site-SynthDigits                   | Train Loss: 2.1909 | Train Acc: 0.3030
 Site-SynthDigits                   | Train Loss: 2.1624 | Train Acc: 0.3573
 Site-MNIST_M                       | Train Loss: 2.2408 | Train Acc: 0.2244
 Site-MNIST_M                       | Train Loss: 2.2498 | Train Acc: 0.1818
 Site-SVHN                          | Train Loss: 2.2526 | Train Acc: 0.1959
Average Train Accuracy: 0.4896
 Site-MNIST                         | Val  Loss: 1.9086 | Val  Acc: 0.6250
 Site-MNIST                         | Val  Loss: 1.9447 | Val  Acc: 0.6071
 Site-MNIST                         | Val  Loss: 1.8921 | Val  Acc: 0.6270
 Site-MNIST                         | Val  Loss: 1.9191 | Val  Acc: 0.5789
 Site-MNIST                         | Val  Loss: 1.9131 | Val  Acc: 0.6211
 Site-USPS                          | Val  Loss: 1.9002 | Val  Acc: 0.6731
 Site-USPS                          | Val  Loss: 1.8998 | Val  Acc: 0.6218
 Site-USPS                          | Val  Loss: 1.8776 | Val  Acc: 0.6111
 Site-SynthDigits                   | Val  Loss: 2.2030 | Val  Acc: 0.2955
 Site-SynthDigits                   | Val  Loss: 2.1828 | Val  Acc: 0.2626
 Site-MNIST_M                       | Val  Loss: 2.2387 | Val  Acc: 0.2955
 Site-MNIST_M                       | Val  Loss: 2.2243 | Val  Acc: 0.2424
 Site-SVHN                          | Val  Loss: 2.2552 | Val  Acc: 0.1918
Average Valid Accuracy: 0.4810
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6250
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6071
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6270
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5789
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6211
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6731
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6218
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6111
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2955
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2626
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2955
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2424
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1918
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.6931 | Train Acc: 0.7289
 Site-MNIST                         | Train Loss: 1.7088 | Train Acc: 0.6953
 Site-MNIST                         | Train Loss: 1.7536 | Train Acc: 0.6371
 Site-MNIST                         | Train Loss: 1.7169 | Train Acc: 0.6570
 Site-MNIST                         | Train Loss: 1.7136 | Train Acc: 0.6839
 Site-USPS                          | Train Loss: 1.6881 | Train Acc: 0.6355
 Site-USPS                          | Train Loss: 1.6810 | Train Acc: 0.6837
 Site-USPS                          | Train Loss: 1.6610 | Train Acc: 0.7146
 Site-SynthDigits                   | Train Loss: 2.1237 | Train Acc: 0.3466
 Site-SynthDigits                   | Train Loss: 2.0950 | Train Acc: 0.3927
 Site-MNIST_M                       | Train Loss: 2.2086 | Train Acc: 0.2670
 Site-MNIST_M                       | Train Loss: 2.2151 | Train Acc: 0.2500
 Site-SVHN                          | Train Loss: 2.2388 | Train Acc: 0.2555
Average Train Accuracy: 0.5344
 Site-MNIST                         | Val  Loss: 1.7268 | Val  Acc: 0.6964
 Site-MNIST                         | Val  Loss: 1.7690 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.7112 | Val  Acc: 0.6905
 Site-MNIST                         | Val  Loss: 1.7458 | Val  Acc: 0.6474
 Site-MNIST                         | Val  Loss: 1.7346 | Val  Acc: 0.6702
 Site-USPS                          | Val  Loss: 1.7173 | Val  Acc: 0.6827
 Site-USPS                          | Val  Loss: 1.7187 | Val  Acc: 0.6218
 Site-USPS                          | Val  Loss: 1.6889 | Val  Acc: 0.6239
 Site-SynthDigits                   | Val  Loss: 2.1518 | Val  Acc: 0.3712
 Site-SynthDigits                   | Val  Loss: 2.1184 | Val  Acc: 0.3283
 Site-MNIST_M                       | Val  Loss: 2.2022 | Val  Acc: 0.3295
 Site-MNIST_M                       | Val  Loss: 2.1882 | Val  Acc: 0.2727
 Site-SVHN                          | Val  Loss: 2.2371 | Val  Acc: 0.2260
Average Valid Accuracy: 0.5252
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6964
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6905
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6474
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6702
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6827
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6218
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6239
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3712
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3283
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.3295
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2727
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2260
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.5306 | Train Acc: 0.7378
 Site-MNIST                         | Train Loss: 1.5299 | Train Acc: 0.7337
 Site-MNIST                         | Train Loss: 1.5945 | Train Acc: 0.6903
 Site-MNIST                         | Train Loss: 1.5522 | Train Acc: 0.7201
 Site-MNIST                         | Train Loss: 1.5486 | Train Acc: 0.7338
 Site-USPS                          | Train Loss: 1.5224 | Train Acc: 0.6787
 Site-USPS                          | Train Loss: 1.5063 | Train Acc: 0.7300
 Site-USPS                          | Train Loss: 1.4844 | Train Acc: 0.7508
 Site-SynthDigits                   | Train Loss: 2.0641 | Train Acc: 0.3731
 Site-SynthDigits                   | Train Loss: 2.0263 | Train Acc: 0.4066
 Site-MNIST_M                       | Train Loss: 2.1797 | Train Acc: 0.3068
 Site-MNIST_M                       | Train Loss: 2.1830 | Train Acc: 0.2765
 Site-SVHN                          | Train Loss: 2.2206 | Train Acc: 0.2709
Average Train Accuracy: 0.5699
 Site-MNIST                         | Val  Loss: 1.5551 | Val  Acc: 0.7679
 Site-MNIST                         | Val  Loss: 1.6057 | Val  Acc: 0.7143
 Site-MNIST                         | Val  Loss: 1.5452 | Val  Acc: 0.7063
 Site-MNIST                         | Val  Loss: 1.5863 | Val  Acc: 0.6842
 Site-MNIST                         | Val  Loss: 1.5753 | Val  Acc: 0.7158
 Site-USPS                          | Val  Loss: 1.5468 | Val  Acc: 0.7404
 Site-USPS                          | Val  Loss: 1.5512 | Val  Acc: 0.6731
 Site-USPS                          | Val  Loss: 1.5180 | Val  Acc: 0.6667
 Site-SynthDigits                   | Val  Loss: 2.1104 | Val  Acc: 0.4091
 Site-SynthDigits                   | Val  Loss: 2.0613 | Val  Acc: 0.3333
 Site-MNIST_M                       | Val  Loss: 2.1729 | Val  Acc: 0.3636
 Site-MNIST_M                       | Val  Loss: 2.1597 | Val  Acc: 0.3030
 Site-SVHN                          | Val  Loss: 2.2173 | Val  Acc: 0.2397
Average Valid Accuracy: 0.5629
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7679
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7143
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7063
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6842
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7158
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7404
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6731
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6667
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4091
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3333
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3636
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3030
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2397
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.3727 | Train Acc: 0.7689
 Site-MNIST                         | Train Loss: 1.3916 | Train Acc: 0.7751
 Site-MNIST                         | Train Loss: 1.4610 | Train Acc: 0.7258
 Site-MNIST                         | Train Loss: 1.4092 | Train Acc: 0.7516
 Site-MNIST                         | Train Loss: 1.4085 | Train Acc: 0.7758
 Site-USPS                          | Train Loss: 1.3791 | Train Acc: 0.7194
 Site-USPS                          | Train Loss: 1.3529 | Train Acc: 0.7716
 Site-USPS                          | Train Loss: 1.3321 | Train Acc: 0.7774
 Site-SynthDigits                   | Train Loss: 1.9988 | Train Acc: 0.3769
 Site-SynthDigits                   | Train Loss: 1.9623 | Train Acc: 0.4242
 Site-MNIST_M                       | Train Loss: 2.1423 | Train Acc: 0.3210
 Site-MNIST_M                       | Train Loss: 2.1633 | Train Acc: 0.3144
 Site-SVHN                          | Train Loss: 2.1950 | Train Acc: 0.2845
Average Train Accuracy: 0.5990
 Site-MNIST                         | Val  Loss: 1.4087 | Val  Acc: 0.7857
 Site-MNIST                         | Val  Loss: 1.4658 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.4083 | Val  Acc: 0.7460
 Site-MNIST                         | Val  Loss: 1.4490 | Val  Acc: 0.7368
 Site-MNIST                         | Val  Loss: 1.4346 | Val  Acc: 0.7579
 Site-USPS                          | Val  Loss: 1.3892 | Val  Acc: 0.7885
 Site-USPS                          | Val  Loss: 1.3945 | Val  Acc: 0.7244
 Site-USPS                          | Val  Loss: 1.3664 | Val  Acc: 0.7137
 Site-SynthDigits                   | Val  Loss: 2.0660 | Val  Acc: 0.4091
 Site-SynthDigits                   | Val  Loss: 2.0043 | Val  Acc: 0.3333
 Site-MNIST_M                       | Val  Loss: 2.1445 | Val  Acc: 0.3636
 Site-MNIST_M                       | Val  Loss: 2.1160 | Val  Acc: 0.3258
 Site-SVHN                          | Val  Loss: 2.2026 | Val  Acc: 0.2397
Average Valid Accuracy: 0.5903
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7857
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7460
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7368
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7579
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7885
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7244
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7137
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4091
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3333
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3636
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3258
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2397
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.2497 | Train Acc: 0.8044
 Site-MNIST                         | Train Loss: 1.2815 | Train Acc: 0.7988
 Site-MNIST                         | Train Loss: 1.3355 | Train Acc: 0.7475
 Site-MNIST                         | Train Loss: 1.2795 | Train Acc: 0.7622
 Site-MNIST                         | Train Loss: 1.2774 | Train Acc: 0.7986
 Site-USPS                          | Train Loss: 1.2659 | Train Acc: 0.7482
 Site-USPS                          | Train Loss: 1.2191 | Train Acc: 0.7875
 Site-USPS                          | Train Loss: 1.1998 | Train Acc: 0.7977
 Site-SynthDigits                   | Train Loss: 1.9734 | Train Acc: 0.3883
 Site-SynthDigits                   | Train Loss: 1.9067 | Train Acc: 0.4432
 Site-MNIST_M                       | Train Loss: 2.1181 | Train Acc: 0.3409
 Site-MNIST_M                       | Train Loss: 2.1428 | Train Acc: 0.3220
 Site-SVHN                          | Train Loss: 2.1786 | Train Acc: 0.2964
Average Train Accuracy: 0.6181
 Site-MNIST                         | Val  Loss: 1.2756 | Val  Acc: 0.7857
 Site-MNIST                         | Val  Loss: 1.3344 | Val  Acc: 0.7738
 Site-MNIST                         | Val  Loss: 1.2754 | Val  Acc: 0.7937
 Site-MNIST                         | Val  Loss: 1.3160 | Val  Acc: 0.7737
 Site-MNIST                         | Val  Loss: 1.3061 | Val  Acc: 0.7860
 Site-USPS                          | Val  Loss: 1.2567 | Val  Acc: 0.7788
 Site-USPS                          | Val  Loss: 1.2632 | Val  Acc: 0.7564
 Site-USPS                          | Val  Loss: 1.2394 | Val  Acc: 0.7436
 Site-SynthDigits                   | Val  Loss: 2.0315 | Val  Acc: 0.4318
 Site-SynthDigits                   | Val  Loss: 1.9544 | Val  Acc: 0.3535
 Site-MNIST_M                       | Val  Loss: 2.1136 | Val  Acc: 0.3523
 Site-MNIST_M                       | Val  Loss: 2.0862 | Val  Acc: 0.3182
 Site-SVHN                          | Val  Loss: 2.1877 | Val  Acc: 0.2603
Average Valid Accuracy: 0.6083
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7857
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7738
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7937
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7737
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7860
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7788
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7564
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7436
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4318
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3535
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3523
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3182
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2603
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 1.1433 | Train Acc: 0.8222
 Site-MNIST                         | Train Loss: 1.1934 | Train Acc: 0.8225
 Site-MNIST                         | Train Loss: 1.2238 | Train Acc: 0.7633
 Site-MNIST                         | Train Loss: 1.1662 | Train Acc: 0.7819
 Site-MNIST                         | Train Loss: 1.1630 | Train Acc: 0.8091
 Site-USPS                          | Train Loss: 1.1527 | Train Acc: 0.7578
 Site-USPS                          | Train Loss: 1.1109 | Train Acc: 0.8019
 Site-USPS                          | Train Loss: 1.0884 | Train Acc: 0.8243
 Site-SynthDigits                   | Train Loss: 1.9159 | Train Acc: 0.4110
 Site-SynthDigits                   | Train Loss: 1.8580 | Train Acc: 0.4798
 Site-MNIST_M                       | Train Loss: 2.0934 | Train Acc: 0.3636
 Site-MNIST_M                       | Train Loss: 2.1197 | Train Acc: 0.3220
 Site-SVHN                          | Train Loss: 2.1722 | Train Acc: 0.2981
Average Train Accuracy: 0.6352
 Site-MNIST                         | Val  Loss: 1.1568 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 1.2127 | Val  Acc: 0.8095
 Site-MNIST                         | Val  Loss: 1.1600 | Val  Acc: 0.8095
 Site-MNIST                         | Val  Loss: 1.1993 | Val  Acc: 0.8105
 Site-MNIST                         | Val  Loss: 1.1901 | Val  Acc: 0.8140
 Site-USPS                          | Val  Loss: 1.1454 | Val  Acc: 0.7981
 Site-USPS                          | Val  Loss: 1.1532 | Val  Acc: 0.7564
 Site-USPS                          | Val  Loss: 1.1350 | Val  Acc: 0.7521
 Site-SynthDigits                   | Val  Loss: 1.9963 | Val  Acc: 0.4394
 Site-SynthDigits                   | Val  Loss: 1.9079 | Val  Acc: 0.3990
 Site-MNIST_M                       | Val  Loss: 2.0852 | Val  Acc: 0.4091
 Site-MNIST_M                       | Val  Loss: 2.0595 | Val  Acc: 0.3485
 Site-SVHN                          | Val  Loss: 2.1730 | Val  Acc: 0.2534
Average Valid Accuracy: 0.6324
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8095
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8095
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8105
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8140
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7981
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7564
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7521
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4394
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3990
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.4091
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3485
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2534
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 1.0215 | Train Acc: 0.8222
 Site-MNIST                         | Train Loss: 1.0754 | Train Acc: 0.8195
 Site-MNIST                         | Train Loss: 1.1352 | Train Acc: 0.7732
 Site-MNIST                         | Train Loss: 1.0754 | Train Acc: 0.8003
 Site-MNIST                         | Train Loss: 1.0726 | Train Acc: 0.8222
 Site-USPS                          | Train Loss: 1.0428 | Train Acc: 0.7866
 Site-USPS                          | Train Loss: 1.0161 | Train Acc: 0.8179
 Site-USPS                          | Train Loss: 0.9919 | Train Acc: 0.8360
 Site-SynthDigits                   | Train Loss: 1.8668 | Train Acc: 0.4242
 Site-SynthDigits                   | Train Loss: 1.8158 | Train Acc: 0.4987
 Site-MNIST_M                       | Train Loss: 2.0640 | Train Acc: 0.3750
 Site-MNIST_M                       | Train Loss: 2.0870 | Train Acc: 0.3258
 Site-SVHN                          | Train Loss: 2.1516 | Train Acc: 0.2998
Average Train Accuracy: 0.6463
 Site-MNIST                         | Val  Loss: 1.0609 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 1.1137 | Val  Acc: 0.8095
 Site-MNIST                         | Val  Loss: 1.0715 | Val  Acc: 0.8175
 Site-MNIST                         | Val  Loss: 1.1081 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 1.1005 | Val  Acc: 0.8105
 Site-USPS                          | Val  Loss: 1.0435 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 1.0493 | Val  Acc: 0.7885
 Site-USPS                          | Val  Loss: 1.0364 | Val  Acc: 0.7991
 Site-SynthDigits                   | Val  Loss: 1.9713 | Val  Acc: 0.4470
 Site-SynthDigits                   | Val  Loss: 1.8645 | Val  Acc: 0.4091
 Site-MNIST_M                       | Val  Loss: 2.0544 | Val  Acc: 0.4318
 Site-MNIST_M                       | Val  Loss: 2.0174 | Val  Acc: 0.3409
 Site-SVHN                          | Val  Loss: 2.1624 | Val  Acc: 0.2603
Average Valid Accuracy: 0.6433
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8095
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8175
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8105
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7885
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7991
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4470
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4091
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.4318
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3409
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2603
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.9542 | Train Acc: 0.8133
 Site-MNIST                         | Train Loss: 1.0164 | Train Acc: 0.8343
 Site-MNIST                         | Train Loss: 1.0428 | Train Acc: 0.7870
 Site-MNIST                         | Train Loss: 0.9850 | Train Acc: 0.8095
 Site-MNIST                         | Train Loss: 0.9762 | Train Acc: 0.8257
 Site-USPS                          | Train Loss: 0.9708 | Train Acc: 0.8129
 Site-USPS                          | Train Loss: 0.9223 | Train Acc: 0.8323
 Site-USPS                          | Train Loss: 0.8935 | Train Acc: 0.8573
 Site-SynthDigits                   | Train Loss: 1.8458 | Train Acc: 0.4280
 Site-SynthDigits                   | Train Loss: 1.7726 | Train Acc: 0.4975
 Site-MNIST_M                       | Train Loss: 2.0418 | Train Acc: 0.3778
 Site-MNIST_M                       | Train Loss: 2.0630 | Train Acc: 0.3295
 Site-SVHN                          | Train Loss: 2.1458 | Train Acc: 0.3032
Average Train Accuracy: 0.6545
 Site-MNIST                         | Val  Loss: 0.9731 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 1.0187 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.9839 | Val  Acc: 0.8254
 Site-MNIST                         | Val  Loss: 1.0150 | Val  Acc: 0.8263
 Site-MNIST                         | Val  Loss: 1.0063 | Val  Acc: 0.8281
 Site-USPS                          | Val  Loss: 0.9492 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.9543 | Val  Acc: 0.8141
 Site-USPS                          | Val  Loss: 0.9471 | Val  Acc: 0.8291
 Site-SynthDigits                   | Val  Loss: 1.9400 | Val  Acc: 0.4545
 Site-SynthDigits                   | Val  Loss: 1.8195 | Val  Acc: 0.4242
 Site-MNIST_M                       | Val  Loss: 2.0282 | Val  Acc: 0.4318
 Site-MNIST_M                       | Val  Loss: 1.9951 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 2.1510 | Val  Acc: 0.2603
Average Valid Accuracy: 0.6581
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8254
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8263
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8281
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8141
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8291
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4545
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4242
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.4318
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3561
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2603
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.8946 | Train Acc: 0.8267
 Site-MNIST                         | Train Loss: 0.9393 | Train Acc: 0.8254
 Site-MNIST                         | Train Loss: 0.9811 | Train Acc: 0.7791
 Site-MNIST                         | Train Loss: 0.9204 | Train Acc: 0.8134
 Site-MNIST                         | Train Loss: 0.9119 | Train Acc: 0.8310
 Site-USPS                          | Train Loss: 0.8882 | Train Acc: 0.8297
 Site-USPS                          | Train Loss: 0.8428 | Train Acc: 0.8482
 Site-USPS                          | Train Loss: 0.8208 | Train Acc: 0.8690
 Site-SynthDigits                   | Train Loss: 1.7908 | Train Acc: 0.4375
 Site-SynthDigits                   | Train Loss: 1.7377 | Train Acc: 0.5063
 Site-MNIST_M                       | Train Loss: 2.0011 | Train Acc: 0.3920
 Site-MNIST_M                       | Train Loss: 2.0477 | Train Acc: 0.3447
 Site-SVHN                          | Train Loss: 2.1110 | Train Acc: 0.3101
Average Train Accuracy: 0.6626
 Site-MNIST                         | Val  Loss: 0.9037 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.9408 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.9222 | Val  Acc: 0.8333
 Site-MNIST                         | Val  Loss: 0.9516 | Val  Acc: 0.8105
 Site-MNIST                         | Val  Loss: 0.9429 | Val  Acc: 0.8211
 Site-USPS                          | Val  Loss: 0.8710 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.8762 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.8752 | Val  Acc: 0.8333
 Site-SynthDigits                   | Val  Loss: 1.9122 | Val  Acc: 0.4697
 Site-SynthDigits                   | Val  Loss: 1.7673 | Val  Acc: 0.4495
 Site-MNIST_M                       | Val  Loss: 1.9973 | Val  Acc: 0.4659
 Site-MNIST_M                       | Val  Loss: 1.9627 | Val  Acc: 0.3864
 Site-SVHN                          | Val  Loss: 2.1358 | Val  Acc: 0.2671
Average Valid Accuracy: 0.6640
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8393
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8333
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8105
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8211
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8077
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8333
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4697
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4495
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.4659
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.3864
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2671
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.8282 | Train Acc: 0.8267
 Site-MNIST                         | Train Loss: 0.8515 | Train Acc: 0.8373
 Site-MNIST                         | Train Loss: 0.9116 | Train Acc: 0.8008
 Site-MNIST                         | Train Loss: 0.8472 | Train Acc: 0.8187
 Site-MNIST                         | Train Loss: 0.8358 | Train Acc: 0.8441
 Site-USPS                          | Train Loss: 0.8216 | Train Acc: 0.8345
 Site-USPS                          | Train Loss: 0.7785 | Train Acc: 0.8594
 Site-USPS                          | Train Loss: 0.7562 | Train Acc: 0.8701
 Site-SynthDigits                   | Train Loss: 1.7603 | Train Acc: 0.4508
 Site-SynthDigits                   | Train Loss: 1.6996 | Train Acc: 0.5164
 Site-MNIST_M                       | Train Loss: 1.9736 | Train Acc: 0.3864
 Site-MNIST_M                       | Train Loss: 2.0301 | Train Acc: 0.3617
 Site-SVHN                          | Train Loss: 2.1095 | Train Acc: 0.3049
Average Train Accuracy: 0.6701
 Site-MNIST                         | Val  Loss: 0.8288 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.8693 | Val  Acc: 0.8333
 Site-MNIST                         | Val  Loss: 0.8520 | Val  Acc: 0.8413
 Site-MNIST                         | Val  Loss: 0.8809 | Val  Acc: 0.8316
 Site-MNIST                         | Val  Loss: 0.8719 | Val  Acc: 0.8281
 Site-USPS                          | Val  Loss: 0.7998 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.8062 | Val  Acc: 0.8205
 Site-USPS                          | Val  Loss: 0.8132 | Val  Acc: 0.8419
 Site-SynthDigits                   | Val  Loss: 1.8907 | Val  Acc: 0.4697
 Site-SynthDigits                   | Val  Loss: 1.7384 | Val  Acc: 0.4646
 Site-MNIST_M                       | Val  Loss: 1.9689 | Val  Acc: 0.4545
 Site-MNIST_M                       | Val  Loss: 1.9360 | Val  Acc: 0.3788
 Site-SVHN                          | Val  Loss: 2.1259 | Val  Acc: 0.2740
Average Valid Accuracy: 0.6696
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8393
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8333
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8413
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8316
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8281
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8205
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8419
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4697
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4646
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4545
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.3788
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2740
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.7789 | Train Acc: 0.8222
 Site-MNIST                         | Train Loss: 0.8138 | Train Acc: 0.8314
 Site-MNIST                         | Train Loss: 0.8749 | Train Acc: 0.7830
 Site-MNIST                         | Train Loss: 0.8059 | Train Acc: 0.8239
 Site-MNIST                         | Train Loss: 0.7988 | Train Acc: 0.8398
 Site-USPS                          | Train Loss: 0.7723 | Train Acc: 0.8369
 Site-USPS                          | Train Loss: 0.7285 | Train Acc: 0.8626
 Site-USPS                          | Train Loss: 0.6999 | Train Acc: 0.8818
 Site-SynthDigits                   | Train Loss: 1.7257 | Train Acc: 0.4527
 Site-SynthDigits                   | Train Loss: 1.6646 | Train Acc: 0.5303
 Site-MNIST_M                       | Train Loss: 1.9482 | Train Acc: 0.4034
 Site-MNIST_M                       | Train Loss: 1.9913 | Train Acc: 0.3788
 Site-SVHN                          | Train Loss: 2.0751 | Train Acc: 0.3135
Average Train Accuracy: 0.6739
 Site-MNIST                         | Val  Loss: 0.7823 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.8175 | Val  Acc: 0.8333
 Site-MNIST                         | Val  Loss: 0.8171 | Val  Acc: 0.8175
 Site-MNIST                         | Val  Loss: 0.8447 | Val  Acc: 0.8158
 Site-MNIST                         | Val  Loss: 0.8301 | Val  Acc: 0.8246
 Site-USPS                          | Val  Loss: 0.7489 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.7564 | Val  Acc: 0.8141
 Site-USPS                          | Val  Loss: 0.7643 | Val  Acc: 0.8419
 Site-SynthDigits                   | Val  Loss: 1.8486 | Val  Acc: 0.4545
 Site-SynthDigits                   | Val  Loss: 1.6940 | Val  Acc: 0.4596
 Site-MNIST_M                       | Val  Loss: 1.9262 | Val  Acc: 0.5114
 Site-MNIST_M                       | Val  Loss: 1.8876 | Val  Acc: 0.4091
 Site-SVHN                          | Val  Loss: 2.1127 | Val  Acc: 0.2603
Average Valid Accuracy: 0.6685
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.7302 | Train Acc: 0.8444
 Site-MNIST                         | Train Loss: 0.7277 | Train Acc: 0.8550
 Site-MNIST                         | Train Loss: 0.8116 | Train Acc: 0.8087
 Site-MNIST                         | Train Loss: 0.7411 | Train Acc: 0.8344
 Site-MNIST                         | Train Loss: 0.7312 | Train Acc: 0.8529
 Site-USPS                          | Train Loss: 0.7274 | Train Acc: 0.8393
 Site-USPS                          | Train Loss: 0.6803 | Train Acc: 0.8674
 Site-USPS                          | Train Loss: 0.6544 | Train Acc: 0.8829
 Site-SynthDigits                   | Train Loss: 1.7080 | Train Acc: 0.4602
 Site-SynthDigits                   | Train Loss: 1.6410 | Train Acc: 0.5354
 Site-MNIST_M                       | Train Loss: 1.9252 | Train Acc: 0.4148
 Site-MNIST_M                       | Train Loss: 1.9749 | Train Acc: 0.3807
 Site-SVHN                          | Train Loss: 2.1053 | Train Acc: 0.3032
Average Train Accuracy: 0.6830
 Site-MNIST                         | Val  Loss: 0.7221 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.7572 | Val  Acc: 0.8452
 Site-MNIST                         | Val  Loss: 0.7526 | Val  Acc: 0.8413
 Site-MNIST                         | Val  Loss: 0.7776 | Val  Acc: 0.8526
 Site-MNIST                         | Val  Loss: 0.7672 | Val  Acc: 0.8456
 Site-USPS                          | Val  Loss: 0.6949 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 0.7107 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.7239 | Val  Acc: 0.8504
 Site-SynthDigits                   | Val  Loss: 1.8410 | Val  Acc: 0.4470
 Site-SynthDigits                   | Val  Loss: 1.6671 | Val  Acc: 0.4747
 Site-MNIST_M                       | Val  Loss: 1.9048 | Val  Acc: 0.5114
 Site-MNIST_M                       | Val  Loss: 1.8741 | Val  Acc: 0.4167
 Site-SVHN                          | Val  Loss: 2.1041 | Val  Acc: 0.2740
Average Valid Accuracy: 0.6830
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8452
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8413
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8526
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8456
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8504
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.4470
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.4747
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.5114
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4167
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2740
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.6895 | Train Acc: 0.8444
 Site-MNIST                         | Train Loss: 0.7163 | Train Acc: 0.8550
 Site-MNIST                         | Train Loss: 0.7768 | Train Acc: 0.8067
 Site-MNIST                         | Train Loss: 0.7071 | Train Acc: 0.8384
 Site-MNIST                         | Train Loss: 0.6953 | Train Acc: 0.8520
 Site-USPS                          | Train Loss: 0.6940 | Train Acc: 0.8489
 Site-USPS                          | Train Loss: 0.6420 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.6119 | Train Acc: 0.8839
 Site-SynthDigits                   | Train Loss: 1.6736 | Train Acc: 0.4621
 Site-SynthDigits                   | Train Loss: 1.6019 | Train Acc: 0.5429
 Site-MNIST_M                       | Train Loss: 1.9009 | Train Acc: 0.4148
 Site-MNIST_M                       | Train Loss: 1.9553 | Train Acc: 0.3826
 Site-SVHN                          | Train Loss: 2.0757 | Train Acc: 0.3066
Average Train Accuracy: 0.6853
 Site-MNIST                         | Val  Loss: 0.6817 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.7159 | Val  Acc: 0.8333
 Site-MNIST                         | Val  Loss: 0.7184 | Val  Acc: 0.8492
 Site-MNIST                         | Val  Loss: 0.7427 | Val  Acc: 0.8579
 Site-MNIST                         | Val  Loss: 0.7291 | Val  Acc: 0.8491
 Site-USPS                          | Val  Loss: 0.6543 | Val  Acc: 0.8558
 Site-USPS                          | Val  Loss: 0.6746 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.6856 | Val  Acc: 0.8547
 Site-SynthDigits                   | Val  Loss: 1.8121 | Val  Acc: 0.4545
 Site-SynthDigits                   | Val  Loss: 1.6298 | Val  Acc: 0.4697
 Site-MNIST_M                       | Val  Loss: 1.8589 | Val  Acc: 0.5114
 Site-MNIST_M                       | Val  Loss: 1.8308 | Val  Acc: 0.4167
 Site-SVHN                          | Val  Loss: 2.0979 | Val  Acc: 0.2877
Average Valid Accuracy: 0.6856
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8393
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8333
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8492
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8579
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8491
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8558
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8333
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8547
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4545
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4697
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.5114
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4167
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.2877
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.6540 | Train Acc: 0.8400
 Site-MNIST                         | Train Loss: 0.6861 | Train Acc: 0.8462
 Site-MNIST                         | Train Loss: 0.7428 | Train Acc: 0.8107
 Site-MNIST                         | Train Loss: 0.6691 | Train Acc: 0.8476
 Site-MNIST                         | Train Loss: 0.6610 | Train Acc: 0.8599
 Site-USPS                          | Train Loss: 0.6565 | Train Acc: 0.8465
 Site-USPS                          | Train Loss: 0.6035 | Train Acc: 0.8786
 Site-USPS                          | Train Loss: 0.5752 | Train Acc: 0.8903
 Site-SynthDigits                   | Train Loss: 1.6605 | Train Acc: 0.4678
 Site-SynthDigits                   | Train Loss: 1.5770 | Train Acc: 0.5492
 Site-MNIST_M                       | Train Loss: 1.8664 | Train Acc: 0.4205
 Site-MNIST_M                       | Train Loss: 1.9323 | Train Acc: 0.3920
 Site-SVHN                          | Train Loss: 2.0705 | Train Acc: 0.2998
Average Train Accuracy: 0.6884
 Site-MNIST                         | Val  Loss: 0.6439 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.6716 | Val  Acc: 0.8452
 Site-MNIST                         | Val  Loss: 0.6873 | Val  Acc: 0.8333
 Site-MNIST                         | Val  Loss: 0.7062 | Val  Acc: 0.8421
 Site-MNIST                         | Val  Loss: 0.6904 | Val  Acc: 0.8351
 Site-USPS                          | Val  Loss: 0.6113 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.6323 | Val  Acc: 0.8397
 Site-USPS                          | Val  Loss: 0.6485 | Val  Acc: 0.8504
 Site-SynthDigits                   | Val  Loss: 1.7920 | Val  Acc: 0.4697
 Site-SynthDigits                   | Val  Loss: 1.6122 | Val  Acc: 0.4899
 Site-MNIST_M                       | Val  Loss: 1.8460 | Val  Acc: 0.4886
 Site-MNIST_M                       | Val  Loss: 1.8022 | Val  Acc: 0.4167
 Site-SVHN                          | Val  Loss: 2.0865 | Val  Acc: 0.2808
Average Valid Accuracy: 0.6857
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8452
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8333
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8421
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8351
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8654
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8397
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8504
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.4697
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.4899
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4886
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4167
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.2808
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.6239 | Train Acc: 0.8400
 Site-MNIST                         | Train Loss: 0.5994 | Train Acc: 0.8550
 Site-MNIST                         | Train Loss: 0.6937 | Train Acc: 0.8304
 Site-MNIST                         | Train Loss: 0.6248 | Train Acc: 0.8528
 Site-MNIST                         | Train Loss: 0.6147 | Train Acc: 0.8625
 Site-USPS                          | Train Loss: 0.6171 | Train Acc: 0.8489
 Site-USPS                          | Train Loss: 0.5673 | Train Acc: 0.8850
 Site-USPS                          | Train Loss: 0.5433 | Train Acc: 0.8946
 Site-SynthDigits                   | Train Loss: 1.6322 | Train Acc: 0.4735
 Site-SynthDigits                   | Train Loss: 1.5457 | Train Acc: 0.5631
 Site-MNIST_M                       | Train Loss: 1.8580 | Train Acc: 0.4261
 Site-MNIST_M                       | Train Loss: 1.9360 | Train Acc: 0.3958
 Site-SVHN                          | Train Loss: 2.0661 | Train Acc: 0.2998
Average Train Accuracy: 0.6944
 Site-MNIST                         | Val  Loss: 0.5986 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.6289 | Val  Acc: 0.8452
 Site-MNIST                         | Val  Loss: 0.6346 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.6574 | Val  Acc: 0.8632
 Site-MNIST                         | Val  Loss: 0.6475 | Val  Acc: 0.8456
 Site-USPS                          | Val  Loss: 0.5663 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.5979 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.6173 | Val  Acc: 0.8504
 Site-SynthDigits                   | Val  Loss: 1.7771 | Val  Acc: 0.4697
 Site-SynthDigits                   | Val  Loss: 1.5765 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.8156 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.7772 | Val  Acc: 0.4318
 Site-SVHN                          | Val  Loss: 2.0792 | Val  Acc: 0.2740
Average Valid Accuracy: 0.6935
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8452
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8632
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8456
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8750
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8462
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8504
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4697
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4318
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2740
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.5893 | Train Acc: 0.8444
 Site-MNIST                         | Train Loss: 0.6014 | Train Acc: 0.8580
 Site-MNIST                         | Train Loss: 0.6682 | Train Acc: 0.8363
 Site-MNIST                         | Train Loss: 0.5969 | Train Acc: 0.8607
 Site-MNIST                         | Train Loss: 0.5899 | Train Acc: 0.8678
 Site-USPS                          | Train Loss: 0.5926 | Train Acc: 0.8633
 Site-USPS                          | Train Loss: 0.5432 | Train Acc: 0.8882
 Site-USPS                          | Train Loss: 0.5181 | Train Acc: 0.8999
 Site-SynthDigits                   | Train Loss: 1.6210 | Train Acc: 0.4905
 Site-SynthDigits                   | Train Loss: 1.5209 | Train Acc: 0.5568
 Site-MNIST_M                       | Train Loss: 1.8196 | Train Acc: 0.4233
 Site-MNIST_M                       | Train Loss: 1.9037 | Train Acc: 0.4034
 Site-SVHN                          | Train Loss: 2.0386 | Train Acc: 0.3066
Average Train Accuracy: 0.6999
 Site-MNIST                         | Val  Loss: 0.5697 | Val  Acc: 0.8750
 Site-MNIST                         | Val  Loss: 0.5929 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.6089 | Val  Acc: 0.8492
 Site-MNIST                         | Val  Loss: 0.6310 | Val  Acc: 0.8579
 Site-MNIST                         | Val  Loss: 0.6178 | Val  Acc: 0.8491
 Site-USPS                          | Val  Loss: 0.5338 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.5755 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.5936 | Val  Acc: 0.8632
 Site-SynthDigits                   | Val  Loss: 1.7454 | Val  Acc: 0.4848
 Site-SynthDigits                   | Val  Loss: 1.5388 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.7702 | Val  Acc: 0.4886
 Site-MNIST_M                       | Val  Loss: 1.7365 | Val  Acc: 0.4167
 Site-SVHN                          | Val  Loss: 2.0678 | Val  Acc: 0.2808
Average Valid Accuracy: 0.6964
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8750
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8492
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8579
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8491
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8846
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8462
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8632
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4848
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.4886
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.4167
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.2808
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.5661 | Train Acc: 0.8400
 Site-MNIST                         | Train Loss: 0.5885 | Train Acc: 0.8609
 Site-MNIST                         | Train Loss: 0.6393 | Train Acc: 0.8383
 Site-MNIST                         | Train Loss: 0.5686 | Train Acc: 0.8607
 Site-MNIST                         | Train Loss: 0.5590 | Train Acc: 0.8660
 Site-USPS                          | Train Loss: 0.5787 | Train Acc: 0.8585
 Site-USPS                          | Train Loss: 0.5132 | Train Acc: 0.8850
 Site-USPS                          | Train Loss: 0.4915 | Train Acc: 0.8999
 Site-SynthDigits                   | Train Loss: 1.5710 | Train Acc: 0.4924
 Site-SynthDigits                   | Train Loss: 1.4796 | Train Acc: 0.5669
 Site-MNIST_M                       | Train Loss: 1.8077 | Train Acc: 0.4290
 Site-MNIST_M                       | Train Loss: 1.8663 | Train Acc: 0.3996
 Site-SVHN                          | Train Loss: 2.0420 | Train Acc: 0.2964
Average Train Accuracy: 0.6995
 Site-MNIST                         | Val  Loss: 0.5427 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.5625 | Val  Acc: 0.8452
 Site-MNIST                         | Val  Loss: 0.5771 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.5964 | Val  Acc: 0.8737
 Site-MNIST                         | Val  Loss: 0.5871 | Val  Acc: 0.8526
 Site-USPS                          | Val  Loss: 0.5027 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.5479 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.5680 | Val  Acc: 0.8632
 Site-SynthDigits                   | Val  Loss: 1.7304 | Val  Acc: 0.4848
 Site-SynthDigits                   | Val  Loss: 1.5229 | Val  Acc: 0.5051
 Site-MNIST_M                       | Val  Loss: 1.7657 | Val  Acc: 0.4886
 Site-MNIST_M                       | Val  Loss: 1.7228 | Val  Acc: 0.4242
 Site-SVHN                          | Val  Loss: 2.0555 | Val  Acc: 0.2671
Average Valid Accuracy: 0.6965
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8452
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8810
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8737
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8526
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8654
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8462
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8632
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.4848
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5051
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.4886
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.4242
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.2671
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.5376 | Train Acc: 0.8533
 Site-MNIST                         | Train Loss: 0.5192 | Train Acc: 0.8728
 Site-MNIST                         | Train Loss: 0.5994 | Train Acc: 0.8481
 Site-MNIST                         | Train Loss: 0.5352 | Train Acc: 0.8712
 Site-MNIST                         | Train Loss: 0.5210 | Train Acc: 0.8730
 Site-USPS                          | Train Loss: 0.5503 | Train Acc: 0.8657
 Site-USPS                          | Train Loss: 0.4928 | Train Acc: 0.8898
 Site-USPS                          | Train Loss: 0.4708 | Train Acc: 0.9042
 Site-SynthDigits                   | Train Loss: 1.5922 | Train Acc: 0.4848
 Site-SynthDigits                   | Train Loss: 1.4792 | Train Acc: 0.5669
 Site-MNIST_M                       | Train Loss: 1.7969 | Train Acc: 0.4489
 Site-MNIST_M                       | Train Loss: 1.8553 | Train Acc: 0.4205
 Site-SVHN                          | Train Loss: 2.0021 | Train Acc: 0.3032
Average Train Accuracy: 0.7079
 Site-MNIST                         | Val  Loss: 0.5073 | Val  Acc: 0.8750
 Site-MNIST                         | Val  Loss: 0.5261 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.5392 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.5586 | Val  Acc: 0.8842
 Site-MNIST                         | Val  Loss: 0.5516 | Val  Acc: 0.8632
 Site-USPS                          | Val  Loss: 0.4707 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.5239 | Val  Acc: 0.8590
 Site-USPS                          | Val  Loss: 0.5458 | Val  Acc: 0.8590
 Site-SynthDigits                   | Val  Loss: 1.7196 | Val  Acc: 0.4697
 Site-SynthDigits                   | Val  Loss: 1.4939 | Val  Acc: 0.4949
 Site-MNIST_M                       | Val  Loss: 1.7396 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.7006 | Val  Acc: 0.4470
 Site-SVHN                          | Val  Loss: 2.0497 | Val  Acc: 0.2671
Average Valid Accuracy: 0.7038
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8750
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8842
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8632
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8846
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8590
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8590
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4697
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4949
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.4470
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.2671
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.5679 | Train Acc: 0.8400
 Site-MNIST                         | Train Loss: 0.5201 | Train Acc: 0.8669
 Site-MNIST                         | Train Loss: 0.5900 | Train Acc: 0.8462
 Site-MNIST                         | Train Loss: 0.5252 | Train Acc: 0.8673
 Site-MNIST                         | Train Loss: 0.5170 | Train Acc: 0.8722
 Site-USPS                          | Train Loss: 0.5226 | Train Acc: 0.8705
 Site-USPS                          | Train Loss: 0.4699 | Train Acc: 0.8914
 Site-USPS                          | Train Loss: 0.4465 | Train Acc: 0.9020
 Site-SynthDigits                   | Train Loss: 1.5546 | Train Acc: 0.4981
 Site-SynthDigits                   | Train Loss: 1.4651 | Train Acc: 0.5707
 Site-MNIST_M                       | Train Loss: 1.7757 | Train Acc: 0.4432
 Site-MNIST_M                       | Train Loss: 1.8489 | Train Acc: 0.4167
 Site-SVHN                          | Train Loss: 2.0182 | Train Acc: 0.3049
Average Train Accuracy: 0.7069
 Site-MNIST                         | Val  Loss: 0.4921 | Val  Acc: 0.8750
 Site-MNIST                         | Val  Loss: 0.5038 | Val  Acc: 0.8690
 Site-MNIST                         | Val  Loss: 0.5290 | Val  Acc: 0.8730
 Site-MNIST                         | Val  Loss: 0.5486 | Val  Acc: 0.8737
 Site-MNIST                         | Val  Loss: 0.5395 | Val  Acc: 0.8561
 Site-USPS                          | Val  Loss: 0.4520 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.5036 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.5243 | Val  Acc: 0.8632
 Site-SynthDigits                   | Val  Loss: 1.6818 | Val  Acc: 0.4924
 Site-SynthDigits                   | Val  Loss: 1.4715 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.7229 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.6704 | Val  Acc: 0.4394
 Site-SVHN                          | Val  Loss: 2.0430 | Val  Acc: 0.2877
Average Valid Accuracy: 0.7069
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8750
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8690
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8730
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8737
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8561
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8942
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8654
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8632
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4924
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.4394
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.2877
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.5108 | Train Acc: 0.8489
 Site-MNIST                         | Train Loss: 0.4717 | Train Acc: 0.8757
 Site-MNIST                         | Train Loss: 0.5625 | Train Acc: 0.8560
 Site-MNIST                         | Train Loss: 0.4972 | Train Acc: 0.8765
 Site-MNIST                         | Train Loss: 0.4854 | Train Acc: 0.8783
 Site-USPS                          | Train Loss: 0.4970 | Train Acc: 0.8753
 Site-USPS                          | Train Loss: 0.4522 | Train Acc: 0.8962
 Site-USPS                          | Train Loss: 0.4322 | Train Acc: 0.9020
 Site-SynthDigits                   | Train Loss: 1.5178 | Train Acc: 0.5019
 Site-SynthDigits                   | Train Loss: 1.4435 | Train Acc: 0.5783
 Site-MNIST_M                       | Train Loss: 1.7695 | Train Acc: 0.4460
 Site-MNIST_M                       | Train Loss: 1.8532 | Train Acc: 0.4242
 Site-SVHN                          | Train Loss: 1.9942 | Train Acc: 0.2879
Average Train Accuracy: 0.7113
 Site-MNIST                         | Val  Loss: 0.4684 | Val  Acc: 0.8750
 Site-MNIST                         | Val  Loss: 0.4809 | Val  Acc: 0.8690
 Site-MNIST                         | Val  Loss: 0.4977 | Val  Acc: 0.8968
 Site-MNIST                         | Val  Loss: 0.5167 | Val  Acc: 0.8895
 Site-MNIST                         | Val  Loss: 0.5109 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.4272 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.4862 | Val  Acc: 0.8718
 Site-USPS                          | Val  Loss: 0.5064 | Val  Acc: 0.8761
 Site-SynthDigits                   | Val  Loss: 1.6704 | Val  Acc: 0.4848
 Site-SynthDigits                   | Val  Loss: 1.4489 | Val  Acc: 0.5051
 Site-MNIST_M                       | Val  Loss: 1.7079 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.6621 | Val  Acc: 0.4470
 Site-SVHN                          | Val  Loss: 2.0407 | Val  Acc: 0.2671
Average Valid Accuracy: 0.7117
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8750
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8690
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8968
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8895
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8667
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8718
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8761
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.4848
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5051
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.4470
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.2671
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.5008 | Train Acc: 0.8578
 Site-MNIST                         | Train Loss: 0.4607 | Train Acc: 0.8787
 Site-MNIST                         | Train Loss: 0.5455 | Train Acc: 0.8580
 Site-MNIST                         | Train Loss: 0.4810 | Train Acc: 0.8804
 Site-MNIST                         | Train Loss: 0.4714 | Train Acc: 0.8757
 Site-USPS                          | Train Loss: 0.4961 | Train Acc: 0.8825
 Site-USPS                          | Train Loss: 0.4339 | Train Acc: 0.8946
 Site-USPS                          | Train Loss: 0.4203 | Train Acc: 0.9073
 Site-SynthDigits                   | Train Loss: 1.5008 | Train Acc: 0.5057
 Site-SynthDigits                   | Train Loss: 1.4269 | Train Acc: 0.5745
 Site-MNIST_M                       | Train Loss: 1.7491 | Train Acc: 0.4489
 Site-MNIST_M                       | Train Loss: 1.8256 | Train Acc: 0.4356
 Site-SVHN                          | Train Loss: 2.0275 | Train Acc: 0.2947
Average Train Accuracy: 0.7149
 Site-MNIST                         | Val  Loss: 0.4494 | Val  Acc: 0.8750
 Site-MNIST                         | Val  Loss: 0.4610 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.4851 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.5003 | Val  Acc: 0.8895
 Site-MNIST                         | Val  Loss: 0.4927 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.4082 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.4693 | Val  Acc: 0.8782
 Site-USPS                          | Val  Loss: 0.4925 | Val  Acc: 0.8761
 Site-SynthDigits                   | Val  Loss: 1.6558 | Val  Acc: 0.5076
 Site-SynthDigits                   | Val  Loss: 1.4282 | Val  Acc: 0.5202
 Site-MNIST_M                       | Val  Loss: 1.6797 | Val  Acc: 0.5114
 Site-MNIST_M                       | Val  Loss: 1.6316 | Val  Acc: 0.4394
 Site-SVHN                          | Val  Loss: 2.0353 | Val  Acc: 0.2808
Average Valid Accuracy: 0.7180
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8750
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8810
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8895
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8667
 Best site-USPS                      | Epoch:21 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8782
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8761
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.5076
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.5202
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.5114
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.4394
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.2808
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.4671 | Train Acc: 0.8711
 Site-MNIST                         | Train Loss: 0.4594 | Train Acc: 0.8935
 Site-MNIST                         | Train Loss: 0.5222 | Train Acc: 0.8659
 Site-MNIST                         | Train Loss: 0.4584 | Train Acc: 0.8804
 Site-MNIST                         | Train Loss: 0.4482 | Train Acc: 0.8835
 Site-USPS                          | Train Loss: 0.4661 | Train Acc: 0.8825
 Site-USPS                          | Train Loss: 0.4199 | Train Acc: 0.9042
 Site-USPS                          | Train Loss: 0.4009 | Train Acc: 0.9116
 Site-SynthDigits                   | Train Loss: 1.5343 | Train Acc: 0.5114
 Site-SynthDigits                   | Train Loss: 1.4109 | Train Acc: 0.5808
 Site-MNIST_M                       | Train Loss: 1.7345 | Train Acc: 0.4574
 Site-MNIST_M                       | Train Loss: 1.8034 | Train Acc: 0.4375
 Site-SVHN                          | Train Loss: 2.0120 | Train Acc: 0.2913
Average Train Accuracy: 0.7209
 Site-MNIST                         | Val  Loss: 0.4272 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.4403 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.4613 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.4758 | Val  Acc: 0.9000
 Site-MNIST                         | Val  Loss: 0.4685 | Val  Acc: 0.8842
 Site-USPS                          | Val  Loss: 0.3809 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.4489 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.4744 | Val  Acc: 0.8761
 Site-SynthDigits                   | Val  Loss: 1.6540 | Val  Acc: 0.5076
 Site-SynthDigits                   | Val  Loss: 1.4191 | Val  Acc: 0.5404
 Site-MNIST_M                       | Val  Loss: 1.6593 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.6205 | Val  Acc: 0.4318
 Site-SVHN                          | Val  Loss: 2.0283 | Val  Acc: 0.2740
Average Valid Accuracy: 0.7245
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9000
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8842
 Best site-USPS                      | Epoch:22 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8761
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.5076
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.5404
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.4318
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.2740
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.4618 | Train Acc: 0.8756
 Site-MNIST                         | Train Loss: 0.4034 | Train Acc: 0.8964
 Site-MNIST                         | Train Loss: 0.5070 | Train Acc: 0.8639
 Site-MNIST                         | Train Loss: 0.4465 | Train Acc: 0.8857
 Site-MNIST                         | Train Loss: 0.4360 | Train Acc: 0.8862
 Site-USPS                          | Train Loss: 0.4689 | Train Acc: 0.8873
 Site-USPS                          | Train Loss: 0.4089 | Train Acc: 0.9026
 Site-USPS                          | Train Loss: 0.3885 | Train Acc: 0.9116
 Site-SynthDigits                   | Train Loss: 1.4738 | Train Acc: 0.5189
 Site-SynthDigits                   | Train Loss: 1.3956 | Train Acc: 0.5947
 Site-MNIST_M                       | Train Loss: 1.7187 | Train Acc: 0.4517
 Site-MNIST_M                       | Train Loss: 1.8056 | Train Acc: 0.4356
 Site-SVHN                          | Train Loss: 2.0085 | Train Acc: 0.2930
Average Train Accuracy: 0.7233
 Site-MNIST                         | Val  Loss: 0.4113 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.4243 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.4474 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.4627 | Val  Acc: 0.9000
 Site-MNIST                         | Val  Loss: 0.4550 | Val  Acc: 0.8877
 Site-USPS                          | Val  Loss: 0.3730 | Val  Acc: 0.9135
 Site-USPS                          | Val  Loss: 0.4407 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.4638 | Val  Acc: 0.8803
 Site-SynthDigits                   | Val  Loss: 1.6387 | Val  Acc: 0.5227
 Site-SynthDigits                   | Val  Loss: 1.3973 | Val  Acc: 0.5404
 Site-MNIST_M                       | Val  Loss: 1.6401 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.5911 | Val  Acc: 0.4318
 Site-SVHN                          | Val  Loss: 2.0162 | Val  Acc: 0.2808
Average Valid Accuracy: 0.7276
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9127
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9000
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8877
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9135
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8803
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.5227
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.5404
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.4318
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.2808
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.4610 | Train Acc: 0.8844
 Site-MNIST                         | Train Loss: 0.4064 | Train Acc: 0.9053
 Site-MNIST                         | Train Loss: 0.4894 | Train Acc: 0.8698
 Site-MNIST                         | Train Loss: 0.4282 | Train Acc: 0.8844
 Site-MNIST                         | Train Loss: 0.4189 | Train Acc: 0.8958
 Site-USPS                          | Train Loss: 0.4409 | Train Acc: 0.8873
 Site-USPS                          | Train Loss: 0.3918 | Train Acc: 0.9058
 Site-USPS                          | Train Loss: 0.3715 | Train Acc: 0.9127
 Site-SynthDigits                   | Train Loss: 1.5112 | Train Acc: 0.5114
 Site-SynthDigits                   | Train Loss: 1.3796 | Train Acc: 0.5972
 Site-MNIST_M                       | Train Loss: 1.7063 | Train Acc: 0.4545
 Site-MNIST_M                       | Train Loss: 1.7895 | Train Acc: 0.4413
 Site-SVHN                          | Train Loss: 1.9979 | Train Acc: 0.2964
Average Train Accuracy: 0.7266
 Site-MNIST                         | Val  Loss: 0.3960 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.4106 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.4283 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.4414 | Val  Acc: 0.9000
 Site-MNIST                         | Val  Loss: 0.4344 | Val  Acc: 0.8982
 Site-USPS                          | Val  Loss: 0.3506 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.4254 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.4499 | Val  Acc: 0.8803
 Site-SynthDigits                   | Val  Loss: 1.6181 | Val  Acc: 0.5076
 Site-SynthDigits                   | Val  Loss: 1.3839 | Val  Acc: 0.5455
 Site-MNIST_M                       | Val  Loss: 1.6269 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.5862 | Val  Acc: 0.4318
 Site-SVHN                          | Val  Loss: 2.0148 | Val  Acc: 0.2877
Average Valid Accuracy: 0.7296
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9127
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9000
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8982
 Best site-USPS                      | Epoch:24 | Val Acc: 0.9327
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8803
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.5076
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.5455
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.4318
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.2877
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.4482 | Train Acc: 0.8844
 Site-MNIST                         | Train Loss: 0.4162 | Train Acc: 0.8905
 Site-MNIST                         | Train Loss: 0.4806 | Train Acc: 0.8698
 Site-MNIST                         | Train Loss: 0.4202 | Train Acc: 0.8804
 Site-MNIST                         | Train Loss: 0.4114 | Train Acc: 0.8949
 Site-USPS                          | Train Loss: 0.4412 | Train Acc: 0.8873
 Site-USPS                          | Train Loss: 0.3831 | Train Acc: 0.9058
 Site-USPS                          | Train Loss: 0.3599 | Train Acc: 0.9148
 Site-SynthDigits                   | Train Loss: 1.4484 | Train Acc: 0.5208
 Site-SynthDigits                   | Train Loss: 1.3575 | Train Acc: 0.5960
 Site-MNIST_M                       | Train Loss: 1.6993 | Train Acc: 0.4773
 Site-MNIST_M                       | Train Loss: 1.7905 | Train Acc: 0.4451
 Site-SVHN                          | Train Loss: 1.9961 | Train Acc: 0.3083
Average Train Accuracy: 0.7289
 Site-MNIST                         | Val  Loss: 0.3834 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.3995 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.4235 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.4344 | Val  Acc: 0.8947
 Site-MNIST                         | Val  Loss: 0.4244 | Val  Acc: 0.8842
 Site-USPS                          | Val  Loss: 0.3392 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.4161 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.4393 | Val  Acc: 0.8803
 Site-SynthDigits                   | Val  Loss: 1.5947 | Val  Acc: 0.5152
 Site-SynthDigits                   | Val  Loss: 1.3644 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.5930 | Val  Acc: 0.5341
 Site-MNIST_M                       | Val  Loss: 1.5624 | Val  Acc: 0.4621
 Site-SVHN                          | Val  Loss: 2.0136 | Val  Acc: 0.2945
Average Valid Accuracy: 0.7357
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9127
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8947
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8842
 Best site-USPS                      | Epoch:25 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8803
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.5152
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.5341
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.4621
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.2945
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.4405 | Train Acc: 0.8844
 Site-MNIST                         | Train Loss: 0.3809 | Train Acc: 0.8964
 Site-MNIST                         | Train Loss: 0.4746 | Train Acc: 0.8757
 Site-MNIST                         | Train Loss: 0.4117 | Train Acc: 0.8844
 Site-MNIST                         | Train Loss: 0.4069 | Train Acc: 0.8905
 Site-USPS                          | Train Loss: 0.4072 | Train Acc: 0.8849
 Site-USPS                          | Train Loss: 0.3741 | Train Acc: 0.9073
 Site-USPS                          | Train Loss: 0.3571 | Train Acc: 0.9148
 Site-SynthDigits                   | Train Loss: 1.4356 | Train Acc: 0.5303
 Site-SynthDigits                   | Train Loss: 1.3323 | Train Acc: 0.6073
 Site-MNIST_M                       | Train Loss: 1.6807 | Train Acc: 0.4602
 Site-MNIST_M                       | Train Loss: 1.7414 | Train Acc: 0.4451
 Site-SVHN                          | Train Loss: 1.9614 | Train Acc: 0.2981
Average Train Accuracy: 0.7292
 Site-MNIST                         | Val  Loss: 0.3730 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.3855 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.4135 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4276 | Val  Acc: 0.9053
 Site-MNIST                         | Val  Loss: 0.4162 | Val  Acc: 0.8912
 Site-USPS                          | Val  Loss: 0.3304 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.4024 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.4263 | Val  Acc: 0.8761
 Site-SynthDigits                   | Val  Loss: 1.5828 | Val  Acc: 0.5379
 Site-SynthDigits                   | Val  Loss: 1.3504 | Val  Acc: 0.5657
 Site-MNIST_M                       | Val  Loss: 1.5851 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.5404 | Val  Acc: 0.4470
 Site-SVHN                          | Val  Loss: 1.9924 | Val  Acc: 0.2945
Average Valid Accuracy: 0.7361
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9053
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8912
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8846
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8761
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.5379
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.5657
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.4470
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.2945
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.4270 | Train Acc: 0.8889
 Site-MNIST                         | Train Loss: 0.3767 | Train Acc: 0.8994
 Site-MNIST                         | Train Loss: 0.4515 | Train Acc: 0.8817
 Site-MNIST                         | Train Loss: 0.3945 | Train Acc: 0.8870
 Site-MNIST                         | Train Loss: 0.3880 | Train Acc: 0.9011
 Site-USPS                          | Train Loss: 0.4097 | Train Acc: 0.8921
 Site-USPS                          | Train Loss: 0.3616 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.3419 | Train Acc: 0.9191
 Site-SynthDigits                   | Train Loss: 1.4347 | Train Acc: 0.5246
 Site-SynthDigits                   | Train Loss: 1.3352 | Train Acc: 0.6010
 Site-MNIST_M                       | Train Loss: 1.6371 | Train Acc: 0.4716
 Site-MNIST_M                       | Train Loss: 1.7252 | Train Acc: 0.4470
 Site-SVHN                          | Train Loss: 1.9783 | Train Acc: 0.3101
Average Train Accuracy: 0.7333
 Site-MNIST                         | Val  Loss: 0.3592 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.3722 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3930 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4077 | Val  Acc: 0.9053
 Site-MNIST                         | Val  Loss: 0.3972 | Val  Acc: 0.8947
 Site-USPS                          | Val  Loss: 0.3166 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.3949 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.4179 | Val  Acc: 0.8846
 Site-SynthDigits                   | Val  Loss: 1.5829 | Val  Acc: 0.5227
 Site-SynthDigits                   | Val  Loss: 1.3408 | Val  Acc: 0.5606
 Site-MNIST_M                       | Val  Loss: 1.5747 | Val  Acc: 0.5455
 Site-MNIST_M                       | Val  Loss: 1.5348 | Val  Acc: 0.4697
 Site-SVHN                          | Val  Loss: 1.9914 | Val  Acc: 0.2945
Average Valid Accuracy: 0.7422
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9053
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8947
 Best site-USPS                      | Epoch:27 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8846
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5227
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5606
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.5455
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.4697
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.2945
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.4006 | Train Acc: 0.8844
 Site-MNIST                         | Train Loss: 0.3708 | Train Acc: 0.9201
 Site-MNIST                         | Train Loss: 0.4412 | Train Acc: 0.8876
 Site-MNIST                         | Train Loss: 0.3842 | Train Acc: 0.8870
 Site-MNIST                         | Train Loss: 0.3764 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.3983 | Train Acc: 0.8945
 Site-USPS                          | Train Loss: 0.3471 | Train Acc: 0.9105
 Site-USPS                          | Train Loss: 0.3283 | Train Acc: 0.9191
 Site-SynthDigits                   | Train Loss: 1.4372 | Train Acc: 0.5341
 Site-SynthDigits                   | Train Loss: 1.3207 | Train Acc: 0.6073
 Site-MNIST_M                       | Train Loss: 1.6593 | Train Acc: 0.4801
 Site-MNIST_M                       | Train Loss: 1.7511 | Train Acc: 0.4545
 Site-SVHN                          | Train Loss: 1.9779 | Train Acc: 0.3101
Average Train Accuracy: 0.7383
 Site-MNIST                         | Val  Loss: 0.3448 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.3626 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.3838 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3926 | Val  Acc: 0.9263
 Site-MNIST                         | Val  Loss: 0.3798 | Val  Acc: 0.9193
 Site-USPS                          | Val  Loss: 0.2961 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.3803 | Val  Acc: 0.8974
 Site-USPS                          | Val  Loss: 0.4064 | Val  Acc: 0.8846
 Site-SynthDigits                   | Val  Loss: 1.5537 | Val  Acc: 0.5303
 Site-SynthDigits                   | Val  Loss: 1.3320 | Val  Acc: 0.5606
 Site-MNIST_M                       | Val  Loss: 1.5820 | Val  Acc: 0.5341
 Site-MNIST_M                       | Val  Loss: 1.5340 | Val  Acc: 0.4848
 Site-SVHN                          | Val  Loss: 1.9900 | Val  Acc: 0.2877
Average Valid Accuracy: 0.7470
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9263
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9193
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8974
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8846
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.5303
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.5606
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.5341
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.4848
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.2877
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.3895 | Train Acc: 0.8978
 Site-MNIST                         | Train Loss: 0.3864 | Train Acc: 0.9201
 Site-MNIST                         | Train Loss: 0.4285 | Train Acc: 0.8876
 Site-MNIST                         | Train Loss: 0.3743 | Train Acc: 0.8936
 Site-MNIST                         | Train Loss: 0.3660 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.3877 | Train Acc: 0.8921
 Site-USPS                          | Train Loss: 0.3409 | Train Acc: 0.9073
 Site-USPS                          | Train Loss: 0.3259 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.3678 | Train Acc: 0.5322
 Site-SynthDigits                   | Train Loss: 1.2973 | Train Acc: 0.6010
 Site-MNIST_M                       | Train Loss: 1.6459 | Train Acc: 0.4858
 Site-MNIST_M                       | Train Loss: 1.7313 | Train Acc: 0.4564
 Site-SVHN                          | Train Loss: 1.9752 | Train Acc: 0.3135
Average Train Accuracy: 0.7398
 Site-MNIST                         | Val  Loss: 0.3372 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.3507 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3751 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3891 | Val  Acc: 0.9158
 Site-MNIST                         | Val  Loss: 0.3743 | Val  Acc: 0.9193
 Site-USPS                          | Val  Loss: 0.2917 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.3754 | Val  Acc: 0.8974
 Site-USPS                          | Val  Loss: 0.4026 | Val  Acc: 0.8803
 Site-SynthDigits                   | Val  Loss: 1.5440 | Val  Acc: 0.5303
 Site-SynthDigits                   | Val  Loss: 1.3090 | Val  Acc: 0.5707
 Site-MNIST_M                       | Val  Loss: 1.5409 | Val  Acc: 0.5795
 Site-MNIST_M                       | Val  Loss: 1.5083 | Val  Acc: 0.4773
 Site-SVHN                          | Val  Loss: 1.9780 | Val  Acc: 0.2945
Average Valid Accuracy: 0.7520
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9158
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9193
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8974
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8803
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5303
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5707
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.5795
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.4773
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.2945
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.3759 | Train Acc: 0.9067
 Site-MNIST                         | Train Loss: 0.3263 | Train Acc: 0.9231
 Site-MNIST                         | Train Loss: 0.4182 | Train Acc: 0.8895
 Site-MNIST                         | Train Loss: 0.3654 | Train Acc: 0.8909
 Site-MNIST                         | Train Loss: 0.3556 | Train Acc: 0.9151
 Site-USPS                          | Train Loss: 0.3869 | Train Acc: 0.8945
 Site-USPS                          | Train Loss: 0.3341 | Train Acc: 0.9058
 Site-USPS                          | Train Loss: 0.3197 | Train Acc: 0.9169
 Site-SynthDigits                   | Train Loss: 1.3617 | Train Acc: 0.5511
 Site-SynthDigits                   | Train Loss: 1.2880 | Train Acc: 0.6111
 Site-MNIST_M                       | Train Loss: 1.6286 | Train Acc: 0.4943
 Site-MNIST_M                       | Train Loss: 1.7232 | Train Acc: 0.4508
 Site-SVHN                          | Train Loss: 1.9773 | Train Acc: 0.3152
Average Train Accuracy: 0.7435
 Site-MNIST                         | Val  Loss: 0.3280 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.3427 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3658 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3722 | Val  Acc: 0.9263
 Site-MNIST                         | Val  Loss: 0.3584 | Val  Acc: 0.9228
 Site-USPS                          | Val  Loss: 0.2819 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.3709 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.3958 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.5346 | Val  Acc: 0.5455
 Site-SynthDigits                   | Val  Loss: 1.2991 | Val  Acc: 0.6010
 Site-MNIST_M                       | Val  Loss: 1.5399 | Val  Acc: 0.5795
 Site-MNIST_M                       | Val  Loss: 1.5010 | Val  Acc: 0.4924
 Site-SVHN                          | Val  Loss: 1.9794 | Val  Acc: 0.2945
Average Valid Accuracy: 0.7564
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9263
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9228
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8846
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5455
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.6010
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5795
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.4924
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.2945
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.3867 | Train Acc: 0.9067
 Site-MNIST                         | Train Loss: 0.3365 | Train Acc: 0.9142
 Site-MNIST                         | Train Loss: 0.4155 | Train Acc: 0.8895
 Site-MNIST                         | Train Loss: 0.3629 | Train Acc: 0.8949
 Site-MNIST                         | Train Loss: 0.3544 | Train Acc: 0.9107
 Site-USPS                          | Train Loss: 0.3708 | Train Acc: 0.8993
 Site-USPS                          | Train Loss: 0.3329 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.3133 | Train Acc: 0.9223
 Site-SynthDigits                   | Train Loss: 1.3778 | Train Acc: 0.5511
 Site-SynthDigits                   | Train Loss: 1.2791 | Train Acc: 0.6136
 Site-MNIST_M                       | Train Loss: 1.6204 | Train Acc: 0.4943
 Site-MNIST_M                       | Train Loss: 1.7231 | Train Acc: 0.4583
 Site-SVHN                          | Train Loss: 1.9513 | Train Acc: 0.3118
Average Train Accuracy: 0.7443
 Site-MNIST                         | Val  Loss: 0.3214 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.3355 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3632 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3756 | Val  Acc: 0.9263
 Site-MNIST                         | Val  Loss: 0.3584 | Val  Acc: 0.9123
 Site-USPS                          | Val  Loss: 0.2793 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.3642 | Val  Acc: 0.8974
 Site-USPS                          | Val  Loss: 0.3883 | Val  Acc: 0.8974
 Site-SynthDigits                   | Val  Loss: 1.5210 | Val  Acc: 0.5455
 Site-SynthDigits                   | Val  Loss: 1.2802 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.5053 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.4816 | Val  Acc: 0.4848
 Site-SVHN                          | Val  Loss: 1.9631 | Val  Acc: 0.2945
Average Valid Accuracy: 0.7574
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9365
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9263
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9123
 Best site-USPS                      | Epoch:31 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8974
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8974
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5455
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5909
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.5909
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.4848
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.2945
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.3645 | Train Acc: 0.8933
 Site-MNIST                         | Train Loss: 0.3445 | Train Acc: 0.9142
 Site-MNIST                         | Train Loss: 0.4091 | Train Acc: 0.8856
 Site-MNIST                         | Train Loss: 0.3569 | Train Acc: 0.8975
 Site-MNIST                         | Train Loss: 0.3514 | Train Acc: 0.9107
 Site-USPS                          | Train Loss: 0.3663 | Train Acc: 0.8969
 Site-USPS                          | Train Loss: 0.3263 | Train Acc: 0.9137
 Site-USPS                          | Train Loss: 0.3089 | Train Acc: 0.9223
 Site-SynthDigits                   | Train Loss: 1.3641 | Train Acc: 0.5473
 Site-SynthDigits                   | Train Loss: 1.2806 | Train Acc: 0.6199
 Site-MNIST_M                       | Train Loss: 1.6208 | Train Acc: 0.5028
 Site-MNIST_M                       | Train Loss: 1.6741 | Train Acc: 0.4545
 Site-SVHN                          | Train Loss: 1.9637 | Train Acc: 0.3083
Average Train Accuracy: 0.7436
 Site-MNIST                         | Val  Loss: 0.3145 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.3304 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3559 | Val  Acc: 0.9206
 Site-MNIST                         | Val  Loss: 0.3645 | Val  Acc: 0.9158
 Site-MNIST                         | Val  Loss: 0.3488 | Val  Acc: 0.9123
 Site-USPS                          | Val  Loss: 0.2719 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.3561 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.3797 | Val  Acc: 0.8932
 Site-SynthDigits                   | Val  Loss: 1.5278 | Val  Acc: 0.5303
 Site-SynthDigits                   | Val  Loss: 1.2815 | Val  Acc: 0.5758
 Site-MNIST_M                       | Val  Loss: 1.5096 | Val  Acc: 0.5795
 Site-MNIST_M                       | Val  Loss: 1.4717 | Val  Acc: 0.5152
 Site-SVHN                          | Val  Loss: 1.9567 | Val  Acc: 0.2945
Average Valid Accuracy: 0.7537
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.3691 | Train Acc: 0.9111
 Site-MNIST                         | Train Loss: 0.3062 | Train Acc: 0.9260
 Site-MNIST                         | Train Loss: 0.3997 | Train Acc: 0.8915
 Site-MNIST                         | Train Loss: 0.3475 | Train Acc: 0.9028
 Site-MNIST                         | Train Loss: 0.3413 | Train Acc: 0.9116
 Site-USPS                          | Train Loss: 0.3623 | Train Acc: 0.8993
 Site-USPS                          | Train Loss: 0.3203 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.2984 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.3472 | Train Acc: 0.5606
 Site-SynthDigits                   | Train Loss: 1.2612 | Train Acc: 0.6225
 Site-MNIST_M                       | Train Loss: 1.5946 | Train Acc: 0.5028
 Site-MNIST_M                       | Train Loss: 1.6893 | Train Acc: 0.4659
 Site-SVHN                          | Train Loss: 1.9650 | Train Acc: 0.3135
Average Train Accuracy: 0.7491
 Site-MNIST                         | Val  Loss: 0.3042 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3213 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3506 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3559 | Val  Acc: 0.9263
 Site-MNIST                         | Val  Loss: 0.3368 | Val  Acc: 0.9263
 Site-USPS                          | Val  Loss: 0.2602 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.3482 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.3732 | Val  Acc: 0.8932
 Site-SynthDigits                   | Val  Loss: 1.5054 | Val  Acc: 0.5606
 Site-SynthDigits                   | Val  Loss: 1.2700 | Val  Acc: 0.6010
 Site-MNIST_M                       | Val  Loss: 1.4955 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.4548 | Val  Acc: 0.5227
 Site-SVHN                          | Val  Loss: 1.9529 | Val  Acc: 0.3014
Average Valid Accuracy: 0.7662
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9365
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9263
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9263
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8932
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.5606
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.6010
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.6023
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5227
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.3014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.3756 | Train Acc: 0.9111
 Site-MNIST                         | Train Loss: 0.3033 | Train Acc: 0.9260
 Site-MNIST                         | Train Loss: 0.3907 | Train Acc: 0.8955
 Site-MNIST                         | Train Loss: 0.3386 | Train Acc: 0.9041
 Site-MNIST                         | Train Loss: 0.3336 | Train Acc: 0.9133
 Site-USPS                          | Train Loss: 0.3600 | Train Acc: 0.9017
 Site-USPS                          | Train Loss: 0.3117 | Train Acc: 0.9169
 Site-USPS                          | Train Loss: 0.2894 | Train Acc: 0.9233
 Site-SynthDigits                   | Train Loss: 1.3632 | Train Acc: 0.5644
 Site-SynthDigits                   | Train Loss: 1.2400 | Train Acc: 0.6124
 Site-MNIST_M                       | Train Loss: 1.5814 | Train Acc: 0.5114
 Site-MNIST_M                       | Train Loss: 1.7028 | Train Acc: 0.4545
 Site-SVHN                          | Train Loss: 1.9210 | Train Acc: 0.3066
Average Train Accuracy: 0.7493
 Site-MNIST                         | Val  Loss: 0.2950 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3096 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3420 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3493 | Val  Acc: 0.9263
 Site-MNIST                         | Val  Loss: 0.3298 | Val  Acc: 0.9263
 Site-USPS                          | Val  Loss: 0.2545 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.3397 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3651 | Val  Acc: 0.8974
 Site-SynthDigits                   | Val  Loss: 1.4960 | Val  Acc: 0.5682
 Site-SynthDigits                   | Val  Loss: 1.2599 | Val  Acc: 0.6010
 Site-MNIST_M                       | Val  Loss: 1.4956 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.4513 | Val  Acc: 0.5227
 Site-SVHN                          | Val  Loss: 1.9403 | Val  Acc: 0.3014
Average Valid Accuracy: 0.7681
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9365
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9263
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9263
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:34 | Val Acc: 0.8974
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.5682
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.6010
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.6023
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.5227
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.3014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.3491 | Train Acc: 0.9156
 Site-MNIST                         | Train Loss: 0.3032 | Train Acc: 0.9290
 Site-MNIST                         | Train Loss: 0.3841 | Train Acc: 0.8935
 Site-MNIST                         | Train Loss: 0.3345 | Train Acc: 0.9028
 Site-MNIST                         | Train Loss: 0.3301 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.3463 | Train Acc: 0.8993
 Site-USPS                          | Train Loss: 0.3020 | Train Acc: 0.9169
 Site-USPS                          | Train Loss: 0.2886 | Train Acc: 0.9233
 Site-SynthDigits                   | Train Loss: 1.3520 | Train Acc: 0.5663
 Site-SynthDigits                   | Train Loss: 1.2267 | Train Acc: 0.6162
 Site-MNIST_M                       | Train Loss: 1.5660 | Train Acc: 0.5142
 Site-MNIST_M                       | Train Loss: 1.6826 | Train Acc: 0.4716
 Site-SVHN                          | Train Loss: 1.9712 | Train Acc: 0.3135
Average Train Accuracy: 0.7520
 Site-MNIST                         | Val  Loss: 0.2876 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3016 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3391 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3454 | Val  Acc: 0.9263
 Site-MNIST                         | Val  Loss: 0.3238 | Val  Acc: 0.9298
 Site-USPS                          | Val  Loss: 0.2474 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.3331 | Val  Acc: 0.8974
 Site-USPS                          | Val  Loss: 0.3593 | Val  Acc: 0.9017
 Site-SynthDigits                   | Val  Loss: 1.4788 | Val  Acc: 0.5606
 Site-SynthDigits                   | Val  Loss: 1.2436 | Val  Acc: 0.6010
 Site-MNIST_M                       | Val  Loss: 1.4599 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.4370 | Val  Acc: 0.5076
 Site-SVHN                          | Val  Loss: 1.9418 | Val  Acc: 0.3082
Average Valid Accuracy: 0.7664
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.3282 | Train Acc: 0.9111
 Site-MNIST                         | Train Loss: 0.2852 | Train Acc: 0.9349
 Site-MNIST                         | Train Loss: 0.3710 | Train Acc: 0.9034
 Site-MNIST                         | Train Loss: 0.3263 | Train Acc: 0.9067
 Site-MNIST                         | Train Loss: 0.3155 | Train Acc: 0.9238
 Site-USPS                          | Train Loss: 0.3349 | Train Acc: 0.9041
 Site-USPS                          | Train Loss: 0.2981 | Train Acc: 0.9169
 Site-USPS                          | Train Loss: 0.2781 | Train Acc: 0.9286
 Site-SynthDigits                   | Train Loss: 1.3273 | Train Acc: 0.5587
 Site-SynthDigits                   | Train Loss: 1.2413 | Train Acc: 0.6187
 Site-MNIST_M                       | Train Loss: 1.5635 | Train Acc: 0.5085
 Site-MNIST_M                       | Train Loss: 1.6835 | Train Acc: 0.4602
 Site-SVHN                          | Train Loss: 1.9353 | Train Acc: 0.3118
Average Train Accuracy: 0.7529
 Site-MNIST                         | Val  Loss: 0.2848 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3019 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3237 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3277 | Val  Acc: 0.9316
 Site-MNIST                         | Val  Loss: 0.3068 | Val  Acc: 0.9368
 Site-USPS                          | Val  Loss: 0.2356 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.3244 | Val  Acc: 0.8974
 Site-USPS                          | Val  Loss: 0.3550 | Val  Acc: 0.8974
 Site-SynthDigits                   | Val  Loss: 1.4727 | Val  Acc: 0.5530
 Site-SynthDigits                   | Val  Loss: 1.2538 | Val  Acc: 0.6010
 Site-MNIST_M                       | Val  Loss: 1.4939 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.4370 | Val  Acc: 0.5303
 Site-SVHN                          | Val  Loss: 1.9348 | Val  Acc: 0.3082
Average Valid Accuracy: 0.7673
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.3066 | Train Acc: 0.9200
 Site-MNIST                         | Train Loss: 0.2654 | Train Acc: 0.9320
 Site-MNIST                         | Train Loss: 0.3565 | Train Acc: 0.9073
 Site-MNIST                         | Train Loss: 0.3131 | Train Acc: 0.9106
 Site-MNIST                         | Train Loss: 0.3008 | Train Acc: 0.9308
 Site-USPS                          | Train Loss: 0.3255 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.2964 | Train Acc: 0.9217
 Site-USPS                          | Train Loss: 0.2778 | Train Acc: 0.9265
 Site-SynthDigits                   | Train Loss: 1.3461 | Train Acc: 0.5587
 Site-SynthDigits                   | Train Loss: 1.2207 | Train Acc: 0.6250
 Site-MNIST_M                       | Train Loss: 1.5750 | Train Acc: 0.5114
 Site-MNIST_M                       | Train Loss: 1.6630 | Train Acc: 0.4583
 Site-SVHN                          | Train Loss: 1.9477 | Train Acc: 0.3237
Average Train Accuracy: 0.7565
 Site-MNIST                         | Val  Loss: 0.2800 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2948 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3143 | Val  Acc: 0.9444
 Site-MNIST                         | Val  Loss: 0.3197 | Val  Acc: 0.9368
 Site-MNIST                         | Val  Loss: 0.2960 | Val  Acc: 0.9333
 Site-USPS                          | Val  Loss: 0.2323 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.3251 | Val  Acc: 0.9103
 Site-USPS                          | Val  Loss: 0.3532 | Val  Acc: 0.9060
 Site-SynthDigits                   | Val  Loss: 1.4701 | Val  Acc: 0.5455
 Site-SynthDigits                   | Val  Loss: 1.2450 | Val  Acc: 0.5960
 Site-MNIST_M                       | Val  Loss: 1.4919 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.4313 | Val  Acc: 0.5152
 Site-SVHN                          | Val  Loss: 1.9312 | Val  Acc: 0.3014
Average Valid Accuracy: 0.7685
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9444
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9368
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9333
 Best site-USPS                      | Epoch:37 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:37 | Val Acc: 0.9103
 Best site-USPS                      | Epoch:37 | Val Acc: 0.9060
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.5455
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.5960
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.6023
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.5152
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.3014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.3391 | Train Acc: 0.9156
 Site-MNIST                         | Train Loss: 0.2758 | Train Acc: 0.9290
 Site-MNIST                         | Train Loss: 0.3617 | Train Acc: 0.8994
 Site-MNIST                         | Train Loss: 0.3133 | Train Acc: 0.9106
 Site-MNIST                         | Train Loss: 0.3068 | Train Acc: 0.9229
 Site-USPS                          | Train Loss: 0.3260 | Train Acc: 0.9137
 Site-USPS                          | Train Loss: 0.2888 | Train Acc: 0.9201
 Site-USPS                          | Train Loss: 0.2737 | Train Acc: 0.9286
 Site-SynthDigits                   | Train Loss: 1.3097 | Train Acc: 0.5644
 Site-SynthDigits                   | Train Loss: 1.2100 | Train Acc: 0.6225
 Site-MNIST_M                       | Train Loss: 1.5603 | Train Acc: 0.5142
 Site-MNIST_M                       | Train Loss: 1.6471 | Train Acc: 0.4621
 Site-SVHN                          | Train Loss: 1.9488 | Train Acc: 0.3066
Average Train Accuracy: 0.7546
 Site-MNIST                         | Val  Loss: 0.2709 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2882 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3125 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3215 | Val  Acc: 0.9316
 Site-MNIST                         | Val  Loss: 0.3002 | Val  Acc: 0.9298
 Site-USPS                          | Val  Loss: 0.2271 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.3148 | Val  Acc: 0.9103
 Site-USPS                          | Val  Loss: 0.3408 | Val  Acc: 0.9103
 Site-SynthDigits                   | Val  Loss: 1.4528 | Val  Acc: 0.5530
 Site-SynthDigits                   | Val  Loss: 1.2236 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.4401 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.4082 | Val  Acc: 0.5227
 Site-SVHN                          | Val  Loss: 1.9230 | Val  Acc: 0.3082
Average Valid Accuracy: 0.7682
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.3222 | Train Acc: 0.9200
 Site-MNIST                         | Train Loss: 0.2845 | Train Acc: 0.9320
 Site-MNIST                         | Train Loss: 0.3507 | Train Acc: 0.9053
 Site-MNIST                         | Train Loss: 0.3033 | Train Acc: 0.9146
 Site-MNIST                         | Train Loss: 0.2962 | Train Acc: 0.9291
 Site-USPS                          | Train Loss: 0.3148 | Train Acc: 0.9113
 Site-USPS                          | Train Loss: 0.2804 | Train Acc: 0.9201
 Site-USPS                          | Train Loss: 0.2685 | Train Acc: 0.9308
 Site-SynthDigits                   | Train Loss: 1.3024 | Train Acc: 0.5644
 Site-SynthDigits                   | Train Loss: 1.2005 | Train Acc: 0.6275
 Site-MNIST_M                       | Train Loss: 1.5776 | Train Acc: 0.5057
 Site-MNIST_M                       | Train Loss: 1.6573 | Train Acc: 0.4640
 Site-SVHN                          | Train Loss: 1.9237 | Train Acc: 0.3186
Average Train Accuracy: 0.7572
 Site-MNIST                         | Val  Loss: 0.2648 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2781 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3058 | Val  Acc: 0.9444
 Site-MNIST                         | Val  Loss: 0.3114 | Val  Acc: 0.9368
 Site-MNIST                         | Val  Loss: 0.2878 | Val  Acc: 0.9333
 Site-USPS                          | Val  Loss: 0.2191 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.3076 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3374 | Val  Acc: 0.9060
 Site-SynthDigits                   | Val  Loss: 1.4441 | Val  Acc: 0.5682
 Site-SynthDigits                   | Val  Loss: 1.2261 | Val  Acc: 0.6061
 Site-MNIST_M                       | Val  Loss: 1.4704 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.4115 | Val  Acc: 0.5303
 Site-SVHN                          | Val  Loss: 1.9185 | Val  Acc: 0.3014
Average Valid Accuracy: 0.7708
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9444
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9368
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9333
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9060
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.5682
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.6061
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.5909
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.5303
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.3014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.3183 | Train Acc: 0.9200
 Site-MNIST                         | Train Loss: 0.2694 | Train Acc: 0.9349
 Site-MNIST                         | Train Loss: 0.3452 | Train Acc: 0.9034
 Site-MNIST                         | Train Loss: 0.3007 | Train Acc: 0.9120
 Site-MNIST                         | Train Loss: 0.2918 | Train Acc: 0.9299
 Site-USPS                          | Train Loss: 0.3243 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.2775 | Train Acc: 0.9201
 Site-USPS                          | Train Loss: 0.2675 | Train Acc: 0.9297
 Site-SynthDigits                   | Train Loss: 1.2560 | Train Acc: 0.5682
 Site-SynthDigits                   | Train Loss: 1.1868 | Train Acc: 0.6275
 Site-MNIST_M                       | Train Loss: 1.5655 | Train Acc: 0.5142
 Site-MNIST_M                       | Train Loss: 1.6259 | Train Acc: 0.4735
 Site-SVHN                          | Train Loss: 1.9161 | Train Acc: 0.3101
Average Train Accuracy: 0.7579
 Site-MNIST                         | Val  Loss: 0.2613 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2774 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3044 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3075 | Val  Acc: 0.9316
 Site-MNIST                         | Val  Loss: 0.2825 | Val  Acc: 0.9368
 Site-USPS                          | Val  Loss: 0.2166 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.3083 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3358 | Val  Acc: 0.9060
 Site-SynthDigits                   | Val  Loss: 1.4380 | Val  Acc: 0.5530
 Site-SynthDigits                   | Val  Loss: 1.2099 | Val  Acc: 0.6111
 Site-MNIST_M                       | Val  Loss: 1.4487 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.4022 | Val  Acc: 0.5152
 Site-SVHN                          | Val  Loss: 1.9183 | Val  Acc: 0.3082
Average Valid Accuracy: 0.7695
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.2920 | Train Acc: 0.9200
 Site-MNIST                         | Train Loss: 0.2748 | Train Acc: 0.9349
 Site-MNIST                         | Train Loss: 0.3360 | Train Acc: 0.9053
 Site-MNIST                         | Train Loss: 0.2935 | Train Acc: 0.9146
 Site-MNIST                         | Train Loss: 0.2823 | Train Acc: 0.9335
 Site-USPS                          | Train Loss: 0.3044 | Train Acc: 0.9209
 Site-USPS                          | Train Loss: 0.2766 | Train Acc: 0.9217
 Site-USPS                          | Train Loss: 0.2616 | Train Acc: 0.9297
 Site-SynthDigits                   | Train Loss: 1.3003 | Train Acc: 0.5739
 Site-SynthDigits                   | Train Loss: 1.1767 | Train Acc: 0.6364
 Site-MNIST_M                       | Train Loss: 1.5466 | Train Acc: 0.5199
 Site-MNIST_M                       | Train Loss: 1.6358 | Train Acc: 0.4716
 Site-SVHN                          | Train Loss: 1.9467 | Train Acc: 0.3254
Average Train Accuracy: 0.7621
 Site-MNIST                         | Val  Loss: 0.2591 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2749 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2930 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.2991 | Val  Acc: 0.9316
 Site-MNIST                         | Val  Loss: 0.2752 | Val  Acc: 0.9368
 Site-USPS                          | Val  Loss: 0.2136 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.3052 | Val  Acc: 0.9103
 Site-USPS                          | Val  Loss: 0.3349 | Val  Acc: 0.9103
 Site-SynthDigits                   | Val  Loss: 1.4273 | Val  Acc: 0.5530
 Site-SynthDigits                   | Val  Loss: 1.2082 | Val  Acc: 0.6162
 Site-MNIST_M                       | Val  Loss: 1.4428 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.3976 | Val  Acc: 0.5227
 Site-SVHN                          | Val  Loss: 1.9102 | Val  Acc: 0.3082
Average Valid Accuracy: 0.7713
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9365
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9316
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9368
 Best site-USPS                      | Epoch:41 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:41 | Val Acc: 0.9103
 Best site-USPS                      | Epoch:41 | Val Acc: 0.9103
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.5530
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.6162
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.6023
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5227
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.3082
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.3026 | Train Acc: 0.9200
 Site-MNIST                         | Train Loss: 0.2534 | Train Acc: 0.9290
 Site-MNIST                         | Train Loss: 0.3348 | Train Acc: 0.9053
 Site-MNIST                         | Train Loss: 0.2892 | Train Acc: 0.9185
 Site-MNIST                         | Train Loss: 0.2836 | Train Acc: 0.9326
 Site-USPS                          | Train Loss: 0.3117 | Train Acc: 0.9209
 Site-USPS                          | Train Loss: 0.2671 | Train Acc: 0.9233
 Site-USPS                          | Train Loss: 0.2568 | Train Acc: 0.9329
 Site-SynthDigits                   | Train Loss: 1.2958 | Train Acc: 0.5739
 Site-SynthDigits                   | Train Loss: 1.1565 | Train Acc: 0.6414
 Site-MNIST_M                       | Train Loss: 1.5219 | Train Acc: 0.5085
 Site-MNIST_M                       | Train Loss: 1.6340 | Train Acc: 0.4735
 Site-SVHN                          | Train Loss: 1.9297 | Train Acc: 0.3169
Average Train Accuracy: 0.7613
 Site-MNIST                         | Val  Loss: 0.2490 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2656 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2923 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.2987 | Val  Acc: 0.9316
 Site-MNIST                         | Val  Loss: 0.2754 | Val  Acc: 0.9298
 Site-USPS                          | Val  Loss: 0.2063 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.2936 | Val  Acc: 0.9103
 Site-USPS                          | Val  Loss: 0.3232 | Val  Acc: 0.9103
 Site-SynthDigits                   | Val  Loss: 1.4138 | Val  Acc: 0.5682
 Site-SynthDigits                   | Val  Loss: 1.1934 | Val  Acc: 0.6111
 Site-MNIST_M                       | Val  Loss: 1.4364 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.3895 | Val  Acc: 0.5152
 Site-SVHN                          | Val  Loss: 1.8972 | Val  Acc: 0.3014
Average Valid Accuracy: 0.7705
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.3065 | Train Acc: 0.9156
 Site-MNIST                         | Train Loss: 0.2563 | Train Acc: 0.9349
 Site-MNIST                         | Train Loss: 0.3235 | Train Acc: 0.9132
 Site-MNIST                         | Train Loss: 0.2814 | Train Acc: 0.9159
 Site-MNIST                         | Train Loss: 0.2730 | Train Acc: 0.9405
 Site-USPS                          | Train Loss: 0.3151 | Train Acc: 0.9185
 Site-USPS                          | Train Loss: 0.2591 | Train Acc: 0.9265
 Site-USPS                          | Train Loss: 0.2496 | Train Acc: 0.9361
 Site-SynthDigits                   | Train Loss: 1.2812 | Train Acc: 0.5758
 Site-SynthDigits                   | Train Loss: 1.1663 | Train Acc: 0.6364
 Site-MNIST_M                       | Train Loss: 1.5461 | Train Acc: 0.5142
 Site-MNIST_M                       | Train Loss: 1.6260 | Train Acc: 0.4773
 Site-SVHN                          | Train Loss: 1.8584 | Train Acc: 0.3271
Average Train Accuracy: 0.7640
 Site-MNIST                         | Val  Loss: 0.2423 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2588 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2898 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.2908 | Val  Acc: 0.9263
 Site-MNIST                         | Val  Loss: 0.2643 | Val  Acc: 0.9368
 Site-USPS                          | Val  Loss: 0.1980 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.2844 | Val  Acc: 0.9103
 Site-USPS                          | Val  Loss: 0.3203 | Val  Acc: 0.9060
 Site-SynthDigits                   | Val  Loss: 1.4062 | Val  Acc: 0.5682
 Site-SynthDigits                   | Val  Loss: 1.1909 | Val  Acc: 0.6263
 Site-MNIST_M                       | Val  Loss: 1.4422 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.3828 | Val  Acc: 0.5227
 Site-SVHN                          | Val  Loss: 1.8945 | Val  Acc: 0.3014
Average Valid Accuracy: 0.7720
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9365
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9263
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9368
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9103
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9060
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.5682
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.6263
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.6023
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.5227
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.3014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.2900 | Train Acc: 0.9244
 Site-MNIST                         | Train Loss: 0.2365 | Train Acc: 0.9408
 Site-MNIST                         | Train Loss: 0.3223 | Train Acc: 0.9132
 Site-MNIST                         | Train Loss: 0.2803 | Train Acc: 0.9225
 Site-MNIST                         | Train Loss: 0.2714 | Train Acc: 0.9361
 Site-USPS                          | Train Loss: 0.2976 | Train Acc: 0.9185
 Site-USPS                          | Train Loss: 0.2592 | Train Acc: 0.9233
 Site-USPS                          | Train Loss: 0.2480 | Train Acc: 0.9340
 Site-SynthDigits                   | Train Loss: 1.2721 | Train Acc: 0.5758
 Site-SynthDigits                   | Train Loss: 1.1677 | Train Acc: 0.6402
 Site-MNIST_M                       | Train Loss: 1.5514 | Train Acc: 0.5170
 Site-MNIST_M                       | Train Loss: 1.6485 | Train Acc: 0.4754
 Site-SVHN                          | Train Loss: 1.9232 | Train Acc: 0.3220
Average Train Accuracy: 0.7649
 Site-MNIST                         | Val  Loss: 0.2369 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2529 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2821 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.2853 | Val  Acc: 0.9474
 Site-MNIST                         | Val  Loss: 0.2615 | Val  Acc: 0.9439
 Site-USPS                          | Val  Loss: 0.1972 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.2860 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3151 | Val  Acc: 0.9060
 Site-SynthDigits                   | Val  Loss: 1.4047 | Val  Acc: 0.5606
 Site-SynthDigits                   | Val  Loss: 1.1874 | Val  Acc: 0.6313
 Site-MNIST_M                       | Val  Loss: 1.4403 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.3790 | Val  Acc: 0.5303
 Site-SVHN                          | Val  Loss: 1.9012 | Val  Acc: 0.3014
Average Valid Accuracy: 0.7744
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9474
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9439
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9060
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.5606
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.6313
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.5909
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.5303
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.3014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.2697 | Train Acc: 0.9244
 Site-MNIST                         | Train Loss: 0.2347 | Train Acc: 0.9408
 Site-MNIST                         | Train Loss: 0.3149 | Train Acc: 0.9191
 Site-MNIST                         | Train Loss: 0.2746 | Train Acc: 0.9225
 Site-MNIST                         | Train Loss: 0.2622 | Train Acc: 0.9431
 Site-USPS                          | Train Loss: 0.2889 | Train Acc: 0.9257
 Site-USPS                          | Train Loss: 0.2581 | Train Acc: 0.9265
 Site-USPS                          | Train Loss: 0.2456 | Train Acc: 0.9372
 Site-SynthDigits                   | Train Loss: 1.2359 | Train Acc: 0.5871
 Site-SynthDigits                   | Train Loss: 1.1528 | Train Acc: 0.6414
 Site-MNIST_M                       | Train Loss: 1.5246 | Train Acc: 0.5312
 Site-MNIST_M                       | Train Loss: 1.6021 | Train Acc: 0.4716
 Site-SVHN                          | Train Loss: 1.9192 | Train Acc: 0.3373
Average Train Accuracy: 0.7698
 Site-MNIST                         | Val  Loss: 0.2361 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2575 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2788 | Val  Acc: 0.9444
 Site-MNIST                         | Val  Loss: 0.2779 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.2553 | Val  Acc: 0.9439
 Site-USPS                          | Val  Loss: 0.1913 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.2846 | Val  Acc: 0.9103
 Site-USPS                          | Val  Loss: 0.3180 | Val  Acc: 0.9103
 Site-SynthDigits                   | Val  Loss: 1.3785 | Val  Acc: 0.5833
 Site-SynthDigits                   | Val  Loss: 1.1602 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.4250 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.3743 | Val  Acc: 0.5227
 Site-SVHN                          | Val  Loss: 1.8965 | Val  Acc: 0.3151
Average Valid Accuracy: 0.7791
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9444
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9421
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9439
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9103
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9103
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.5833
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.6364
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.6023
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.5227
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.3151
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.2767 | Train Acc: 0.9244
 Site-MNIST                         | Train Loss: 0.2522 | Train Acc: 0.9438
 Site-MNIST                         | Train Loss: 0.3137 | Train Acc: 0.9211
 Site-MNIST                         | Train Loss: 0.2727 | Train Acc: 0.9251
 Site-MNIST                         | Train Loss: 0.2602 | Train Acc: 0.9440
 Site-USPS                          | Train Loss: 0.2881 | Train Acc: 0.9233
 Site-USPS                          | Train Loss: 0.2523 | Train Acc: 0.9265
 Site-USPS                          | Train Loss: 0.2438 | Train Acc: 0.9340
 Site-SynthDigits                   | Train Loss: 1.2393 | Train Acc: 0.5890
 Site-SynthDigits                   | Train Loss: 1.1385 | Train Acc: 0.6490
 Site-MNIST_M                       | Train Loss: 1.5427 | Train Acc: 0.5227
 Site-MNIST_M                       | Train Loss: 1.6073 | Train Acc: 0.4697
 Site-SVHN                          | Train Loss: 1.9349 | Train Acc: 0.3339
Average Train Accuracy: 0.7697
 Site-MNIST                         | Val  Loss: 0.2375 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2569 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2758 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.2748 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.2511 | Val  Acc: 0.9474
 Site-USPS                          | Val  Loss: 0.1931 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.2815 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3114 | Val  Acc: 0.9103
 Site-SynthDigits                   | Val  Loss: 1.3857 | Val  Acc: 0.5758
 Site-SynthDigits                   | Val  Loss: 1.1762 | Val  Acc: 0.6465
 Site-MNIST_M                       | Val  Loss: 1.4504 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.3808 | Val  Acc: 0.5227
 Site-SVHN                          | Val  Loss: 1.8896 | Val  Acc: 0.3014
Average Valid Accuracy: 0.7798
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9579
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9474
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9103
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.5758
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.6465
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.6023
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.5227
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.3014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.2815 | Train Acc: 0.9200
 Site-MNIST                         | Train Loss: 0.2389 | Train Acc: 0.9438
 Site-MNIST                         | Train Loss: 0.3085 | Train Acc: 0.9231
 Site-MNIST                         | Train Loss: 0.2714 | Train Acc: 0.9251
 Site-MNIST                         | Train Loss: 0.2581 | Train Acc: 0.9422
 Site-USPS                          | Train Loss: 0.2811 | Train Acc: 0.9233
 Site-USPS                          | Train Loss: 0.2487 | Train Acc: 0.9297
 Site-USPS                          | Train Loss: 0.2368 | Train Acc: 0.9372
 Site-SynthDigits                   | Train Loss: 1.2606 | Train Acc: 0.5852
 Site-SynthDigits                   | Train Loss: 1.1245 | Train Acc: 0.6515
 Site-MNIST_M                       | Train Loss: 1.5178 | Train Acc: 0.5341
 Site-MNIST_M                       | Train Loss: 1.6006 | Train Acc: 0.4678
 Site-SVHN                          | Train Loss: 1.9077 | Train Acc: 0.3356
Average Train Accuracy: 0.7707
 Site-MNIST                         | Val  Loss: 0.2263 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2470 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2715 | Val  Acc: 0.9444
 Site-MNIST                         | Val  Loss: 0.2725 | Val  Acc: 0.9526
 Site-MNIST                         | Val  Loss: 0.2485 | Val  Acc: 0.9474
 Site-USPS                          | Val  Loss: 0.1847 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.2676 | Val  Acc: 0.9103
 Site-USPS                          | Val  Loss: 0.3049 | Val  Acc: 0.9060
 Site-SynthDigits                   | Val  Loss: 1.3619 | Val  Acc: 0.5682
 Site-SynthDigits                   | Val  Loss: 1.1693 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.4375 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.3691 | Val  Acc: 0.5379
 Site-SVHN                          | Val  Loss: 1.8823 | Val  Acc: 0.3151
Average Valid Accuracy: 0.7790
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.2826 | Train Acc: 0.9244
 Site-MNIST                         | Train Loss: 0.2434 | Train Acc: 0.9379
 Site-MNIST                         | Train Loss: 0.3174 | Train Acc: 0.9112
 Site-MNIST                         | Train Loss: 0.2704 | Train Acc: 0.9264
 Site-MNIST                         | Train Loss: 0.2669 | Train Acc: 0.9326
 Site-USPS                          | Train Loss: 0.2897 | Train Acc: 0.9233
 Site-USPS                          | Train Loss: 0.2465 | Train Acc: 0.9233
 Site-USPS                          | Train Loss: 0.2388 | Train Acc: 0.9350
 Site-SynthDigits                   | Train Loss: 1.2568 | Train Acc: 0.5928
 Site-SynthDigits                   | Train Loss: 1.1147 | Train Acc: 0.6490
 Site-MNIST_M                       | Train Loss: 1.4835 | Train Acc: 0.5426
 Site-MNIST_M                       | Train Loss: 1.6249 | Train Acc: 0.4867
 Site-SVHN                          | Train Loss: 1.8871 | Train Acc: 0.3305
Average Train Accuracy: 0.7704
 Site-MNIST                         | Val  Loss: 0.2226 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2369 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2752 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.2843 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.2568 | Val  Acc: 0.9404
 Site-USPS                          | Val  Loss: 0.1892 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.2713 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.2974 | Val  Acc: 0.9145
 Site-SynthDigits                   | Val  Loss: 1.3400 | Val  Acc: 0.5909
 Site-SynthDigits                   | Val  Loss: 1.1462 | Val  Acc: 0.6414
 Site-MNIST_M                       | Val  Loss: 1.3649 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.3303 | Val  Acc: 0.5227
 Site-SVHN                          | Val  Loss: 1.8707 | Val  Acc: 0.3219
Average Valid Accuracy: 0.7820
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9421
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9404
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9145
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.5909
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.6414
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.6364
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.5227
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.3219
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/fedavg...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.2746 | Train Acc: 0.9244
 Site-MNIST                         | Train Loss: 0.2354 | Train Acc: 0.9438
 Site-MNIST                         | Train Loss: 0.3018 | Train Acc: 0.9172
 Site-MNIST                         | Train Loss: 0.2629 | Train Acc: 0.9277
 Site-MNIST                         | Train Loss: 0.2502 | Train Acc: 0.9475
 Site-USPS                          | Train Loss: 0.2728 | Train Acc: 0.9233
 Site-USPS                          | Train Loss: 0.2411 | Train Acc: 0.9265
 Site-USPS                          | Train Loss: 0.2305 | Train Acc: 0.9404
 Site-SynthDigits                   | Train Loss: 1.2199 | Train Acc: 0.5947
 Site-SynthDigits                   | Train Loss: 1.1192 | Train Acc: 0.6566
 Site-MNIST_M                       | Train Loss: 1.4979 | Train Acc: 0.5227
 Site-MNIST_M                       | Train Loss: 1.6023 | Train Acc: 0.4792
 Site-SVHN                          | Train Loss: 1.8904 | Train Acc: 0.3458
Average Train Accuracy: 0.7731
 Site-MNIST                         | Val  Loss: 0.2205 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2357 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2665 | Val  Acc: 0.9444
 Site-MNIST                         | Val  Loss: 0.2715 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.2430 | Val  Acc: 0.9474
 Site-USPS                          | Val  Loss: 0.1836 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.2600 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.2962 | Val  Acc: 0.9103
 Site-SynthDigits                   | Val  Loss: 1.3535 | Val  Acc: 0.5758
 Site-SynthDigits                   | Val  Loss: 1.1524 | Val  Acc: 0.6414
 Site-MNIST_M                       | Val  Loss: 1.4002 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.3422 | Val  Acc: 0.5227
 Site-SVHN                          | Val  Loss: 1.8720 | Val  Acc: 0.3014
Average Valid Accuracy: 0.7762
===2023-06-30 16:04:06===
===2023-06-30 16:04:09===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.9106
 Test site-USPS                      | Epoch:48 | Test Acc: 0.9194
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.5987
 Test site-MNIST_M                   | Epoch:48 | Test Acc: 0.4399
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.2983
MNIST: 0.9106, USPS: 0.9194, SynthDigits: 0.5987, MNIST_M: 0.4399, SVHN: 0.2983, 
Average Test Accuracy(group): 0.6334, Average Test Accuracy(individual): 0.7451,
domain std=0.2488, cluster std=-1.0000, individual std=0.2248, 
