===2023-06-04 02:19:13===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[451,676,1015,1522,2284,834,1252,1878,1057,1586,704,1057,1174,
client_nums=[5,3,2,2,1,]
len_dataset=[7438,4958,3305,2203,1468,]
domain number = 5
============ Train epoch 0 ============
denominator: 29580.806640625
 Site-MNIST                    | Train Loss: 2.2086 | Train Acc: 0.3703
 Site-MNIST                    | Train Loss: 2.2206 | Train Acc: 0.3284
 Site-MNIST                    | Train Loss: 2.2181 | Train Acc: 0.3695
 Site-MNIST                    | Train Loss: 2.2195 | Train Acc: 0.3686
 Site-MNIST                    | Train Loss: 2.2212 | Train Acc: 0.3546
 Site-USPS                     | Train Loss: 2.2046 | Train Acc: 0.4472
 Site-USPS                     | Train Loss: 2.2012 | Train Acc: 0.4601
 Site-USPS                     | Train Loss: 2.2046 | Train Acc: 0.4281
 Site-SynthDigits              | Train Loss: 2.2854 | Train Acc: 0.1495
 Site-SynthDigits              | Train Loss: 2.2761 | Train Acc: 0.1772
 Site-MNIST-M                  | Train Loss: 2.2951 | Train Acc: 0.1193
 Site-MNIST-M                  | Train Loss: 2.2952 | Train Acc: 0.1041
 Site-SVHN                     | Train Loss: 2.2894 | Train Acc: 0.1184
 Site-MNIST                         | Val  Loss: 2.2178 | Val  Acc: 0.3214
 Site-MNIST                         | Val  Loss: 2.2218 | Val  Acc: 0.3787
 Site-MNIST                         | Val  Loss: 2.2163 | Val  Acc: 0.3874
 Site-MNIST                         | Val  Loss: 2.2255 | Val  Acc: 0.3211
 Site-MNIST                         | Val  Loss: 2.2225 | Val  Acc: 0.3351
 Site-USPS                          | Val  Loss: 2.1981 | Val  Acc: 0.4663
 Site-USPS                          | Val  Loss: 2.1999 | Val  Acc: 0.4519
 Site-USPS                          | Val  Loss: 2.2033 | Val  Acc: 0.4691
 Site-SynthDigits                   | Val  Loss: 2.2873 | Val  Acc: 0.1553
 Site-SynthDigits                   | Val  Loss: 2.2807 | Val  Acc: 0.1540
 Site-MNIST-M                       | Val  Loss: 2.2951 | Val  Acc: 0.1250
 Site-MNIST-M                       | Val  Loss: 2.2973 | Val  Acc: 0.0871
 Site-SVHN                          | Val  Loss: 2.2871 | Val  Acc: 0.1024
Average Valid Accuracy: 0.2888
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.3214
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.3787
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.3874
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.3211
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.3351
 Best site-USPS                      | Epoch:0 | Val Acc: 0.4663
 Best site-USPS                      | Epoch:0 | Val Acc: 0.4519
 Best site-USPS                      | Epoch:0 | Val Acc: 0.4691
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1553
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1540
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.1250
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.0871
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1024
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 1 ============
denominator: 28899.7421875
 Site-MNIST                    | Train Loss: 2.1243 | Train Acc: 0.5942
 Site-MNIST                    | Train Loss: 2.1492 | Train Acc: 0.4719
 Site-MNIST                    | Train Loss: 2.1380 | Train Acc: 0.5103
 Site-MNIST                    | Train Loss: 2.1407 | Train Acc: 0.5053
 Site-MNIST                    | Train Loss: 2.1434 | Train Acc: 0.4978
 Site-USPS                     | Train Loss: 2.1088 | Train Acc: 0.5612
 Site-USPS                     | Train Loss: 2.0981 | Train Acc: 0.5887
 Site-USPS                     | Train Loss: 2.1063 | Train Acc: 0.5767
 Site-SynthDigits              | Train Loss: 2.2590 | Train Acc: 0.2062
 Site-SynthDigits              | Train Loss: 2.2531 | Train Acc: 0.2560
 Site-MNIST-M                  | Train Loss: 2.2837 | Train Acc: 0.1406
 Site-MNIST-M                  | Train Loss: 2.2911 | Train Acc: 0.1268
 Site-SVHN                     | Train Loss: 2.2810 | Train Acc: 0.1422
 Site-MNIST                         | Val  Loss: 2.1371 | Val  Acc: 0.5357
 Site-MNIST                         | Val  Loss: 2.1457 | Val  Acc: 0.5089
 Site-MNIST                         | Val  Loss: 2.1372 | Val  Acc: 0.5257
 Site-MNIST                         | Val  Loss: 2.1539 | Val  Acc: 0.4711
 Site-MNIST                         | Val  Loss: 2.1489 | Val  Acc: 0.4807
 Site-USPS                          | Val  Loss: 2.0906 | Val  Acc: 0.6010
 Site-USPS                          | Val  Loss: 2.0986 | Val  Acc: 0.5994
 Site-USPS                          | Val  Loss: 2.1074 | Val  Acc: 0.5714
 Site-SynthDigits                   | Val  Loss: 2.2648 | Val  Acc: 0.2273
 Site-SynthDigits                   | Val  Loss: 2.2577 | Val  Acc: 0.2071
 Site-MNIST-M                       | Val  Loss: 2.2868 | Val  Acc: 0.1364
 Site-MNIST-M                       | Val  Loss: 2.2872 | Val  Acc: 0.1061
 Site-SVHN                          | Val  Loss: 2.2777 | Val  Acc: 0.1638
Average Valid Accuracy: 0.3950
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5357
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5089
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5257
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.4711
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.4807
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6010
 Best site-USPS                      | Epoch:1 | Val Acc: 0.5994
 Best site-USPS                      | Epoch:1 | Val Acc: 0.5714
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2273
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2071
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.1364
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.1061
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1638
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 2 ============
denominator: 28218.55859375
 Site-MNIST                    | Train Loss: 2.0356 | Train Acc: 0.6319
 Site-MNIST                    | Train Loss: 2.0763 | Train Acc: 0.5118
 Site-MNIST                    | Train Loss: 2.0557 | Train Acc: 0.5281
 Site-MNIST                    | Train Loss: 2.0605 | Train Acc: 0.5296
 Site-MNIST                    | Train Loss: 2.0637 | Train Acc: 0.5271
 Site-USPS                     | Train Loss: 2.0107 | Train Acc: 0.6007
 Site-USPS                     | Train Loss: 2.0058 | Train Acc: 0.6222
 Site-USPS                     | Train Loss: 2.0137 | Train Acc: 0.6092
 Site-SynthDigits              | Train Loss: 2.2355 | Train Acc: 0.2431
 Site-SynthDigits              | Train Loss: 2.2288 | Train Acc: 0.2907
 Site-MNIST-M                  | Train Loss: 2.2717 | Train Acc: 0.1605
 Site-MNIST-M                  | Train Loss: 2.2693 | Train Acc: 0.1504
 Site-SVHN                     | Train Loss: 2.2718 | Train Acc: 0.1695
 Site-MNIST                         | Val  Loss: 2.0585 | Val  Acc: 0.5536
 Site-MNIST                         | Val  Loss: 2.0678 | Val  Acc: 0.5148
 Site-MNIST                         | Val  Loss: 2.0564 | Val  Acc: 0.5217
 Site-MNIST                         | Val  Loss: 2.0797 | Val  Acc: 0.4921
 Site-MNIST                         | Val  Loss: 2.0738 | Val  Acc: 0.5175
 Site-USPS                          | Val  Loss: 1.9901 | Val  Acc: 0.6635
 Site-USPS                          | Val  Loss: 2.0052 | Val  Acc: 0.6410
 Site-USPS                          | Val  Loss: 2.0177 | Val  Acc: 0.6119
 Site-SynthDigits                   | Val  Loss: 2.2410 | Val  Acc: 0.2500
 Site-SynthDigits                   | Val  Loss: 2.2337 | Val  Acc: 0.2551
 Site-MNIST-M                       | Val  Loss: 2.2776 | Val  Acc: 0.1477
 Site-MNIST-M                       | Val  Loss: 2.2768 | Val  Acc: 0.1477
 Site-SVHN                          | Val  Loss: 2.2686 | Val  Acc: 0.1843
Average Valid Accuracy: 0.4232
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5536
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5148
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5217
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.4921
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5175
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6635
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6410
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6119
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2500
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2551
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.1477
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.1477
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.1843
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 3 ============
denominator: 27509.4609375
 Site-MNIST                    | Train Loss: 1.9524 | Train Acc: 0.6275
 Site-MNIST                    | Train Loss: 2.0007 | Train Acc: 0.5237
 Site-MNIST                    | Train Loss: 1.9760 | Train Acc: 0.5379
 Site-MNIST                    | Train Loss: 1.9819 | Train Acc: 0.5473
 Site-MNIST                    | Train Loss: 1.9864 | Train Acc: 0.5420
 Site-USPS                     | Train Loss: 1.9260 | Train Acc: 0.6199
 Site-USPS                     | Train Loss: 1.9173 | Train Acc: 0.6286
 Site-USPS                     | Train Loss: 1.9241 | Train Acc: 0.6246
 Site-SynthDigits              | Train Loss: 2.2055 | Train Acc: 0.2725
 Site-SynthDigits              | Train Loss: 2.2041 | Train Acc: 0.3140
 Site-MNIST-M                  | Train Loss: 2.2587 | Train Acc: 0.1903
 Site-MNIST-M                  | Train Loss: 2.2646 | Train Acc: 0.1779
 Site-SVHN                     | Train Loss: 2.2635 | Train Acc: 0.1925
 Site-MNIST                         | Val  Loss: 1.9789 | Val  Acc: 0.5625
 Site-MNIST                         | Val  Loss: 1.9918 | Val  Acc: 0.5030
 Site-MNIST                         | Val  Loss: 1.9781 | Val  Acc: 0.5336
 Site-MNIST                         | Val  Loss: 2.0065 | Val  Acc: 0.5053
 Site-MNIST                         | Val  Loss: 1.9992 | Val  Acc: 0.5298
 Site-USPS                          | Val  Loss: 1.8933 | Val  Acc: 0.6923
 Site-USPS                          | Val  Loss: 1.9143 | Val  Acc: 0.6538
 Site-USPS                          | Val  Loss: 1.9307 | Val  Acc: 0.6247
 Site-SynthDigits                   | Val  Loss: 2.2163 | Val  Acc: 0.2841
 Site-SynthDigits                   | Val  Loss: 2.2088 | Val  Acc: 0.2980
 Site-MNIST-M                       | Val  Loss: 2.2674 | Val  Acc: 0.1705
 Site-MNIST-M                       | Val  Loss: 2.2661 | Val  Acc: 0.1780
 Site-SVHN                          | Val  Loss: 2.2595 | Val  Acc: 0.2116
Average Valid Accuracy: 0.4421
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5625
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5030
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5336
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5053
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5298
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6923
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6538
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6247
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2841
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2980
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.1705
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.1780
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2116
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 4 ============
denominator: 26910.0390625
 Site-MNIST                    | Train Loss: 1.8507 | Train Acc: 0.6430
 Site-MNIST                    | Train Loss: 1.9329 | Train Acc: 0.5533
 Site-MNIST                    | Train Loss: 1.9011 | Train Acc: 0.5675
 Site-MNIST                    | Train Loss: 1.9064 | Train Acc: 0.5808
 Site-MNIST                    | Train Loss: 1.9145 | Train Acc: 0.5670
 Site-USPS                     | Train Loss: 1.8495 | Train Acc: 0.6367
 Site-USPS                     | Train Loss: 1.8270 | Train Acc: 0.6565
 Site-USPS                     | Train Loss: 1.8373 | Train Acc: 0.6496
 Site-SynthDigits              | Train Loss: 2.1924 | Train Acc: 0.3027
 Site-SynthDigits              | Train Loss: 2.1788 | Train Acc: 0.3310
 Site-MNIST-M                  | Train Loss: 2.2461 | Train Acc: 0.2188
 Site-MNIST-M                  | Train Loss: 2.2517 | Train Acc: 0.1996
 Site-SVHN                     | Train Loss: 2.2559 | Train Acc: 0.2147
 Site-MNIST                         | Val  Loss: 1.9072 | Val  Acc: 0.5804
 Site-MNIST                         | Val  Loss: 1.9203 | Val  Acc: 0.5325
 Site-MNIST                         | Val  Loss: 1.9035 | Val  Acc: 0.5652
 Site-MNIST                         | Val  Loss: 1.9367 | Val  Acc: 0.5184
 Site-MNIST                         | Val  Loss: 1.9291 | Val  Acc: 0.5509
 Site-USPS                          | Val  Loss: 1.8015 | Val  Acc: 0.6971
 Site-USPS                          | Val  Loss: 1.8277 | Val  Acc: 0.6731
 Site-USPS                          | Val  Loss: 1.8457 | Val  Acc: 0.6525
 Site-SynthDigits                   | Val  Loss: 2.1917 | Val  Acc: 0.3220
 Site-SynthDigits                   | Val  Loss: 2.1841 | Val  Acc: 0.3283
 Site-MNIST-M                       | Val  Loss: 2.2562 | Val  Acc: 0.2045
 Site-MNIST-M                       | Val  Loss: 2.2552 | Val  Acc: 0.2083
 Site-SVHN                          | Val  Loss: 2.2516 | Val  Acc: 0.2457
Average Valid Accuracy: 0.4676
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5804
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5325
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5652
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5184
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5509
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6971
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6731
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6525
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3220
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3283
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.2045
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.2083
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2457
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 5 ============
denominator: 26228.634765625
 Site-MNIST                    | Train Loss: 1.8062 | Train Acc: 0.6630
 Site-MNIST                    | Train Loss: 1.8642 | Train Acc: 0.5873
 Site-MNIST                    | Train Loss: 1.8281 | Train Acc: 0.5842
 Site-MNIST                    | Train Loss: 1.8331 | Train Acc: 0.6038
 Site-MNIST                    | Train Loss: 1.8402 | Train Acc: 0.5989
 Site-USPS                     | Train Loss: 1.7526 | Train Acc: 0.6427
 Site-USPS                     | Train Loss: 1.7332 | Train Acc: 0.6789
 Site-USPS                     | Train Loss: 1.7502 | Train Acc: 0.6683
 Site-SynthDigits              | Train Loss: 2.1503 | Train Acc: 0.3179
 Site-SynthDigits              | Train Loss: 2.1552 | Train Acc: 0.3398
 Site-MNIST-M                  | Train Loss: 2.2350 | Train Acc: 0.2344
 Site-MNIST-M                  | Train Loss: 2.2466 | Train Acc: 0.2138
 Site-SVHN                     | Train Loss: 2.2481 | Train Acc: 0.2198
 Site-MNIST                         | Val  Loss: 1.8386 | Val  Acc: 0.5804
 Site-MNIST                         | Val  Loss: 1.8506 | Val  Acc: 0.5444
 Site-MNIST                         | Val  Loss: 1.8295 | Val  Acc: 0.5929
 Site-MNIST                         | Val  Loss: 1.8673 | Val  Acc: 0.5526
 Site-MNIST                         | Val  Loss: 1.8593 | Val  Acc: 0.5877
 Site-USPS                          | Val  Loss: 1.7122 | Val  Acc: 0.7019
 Site-USPS                          | Val  Loss: 1.7427 | Val  Acc: 0.6859
 Site-USPS                          | Val  Loss: 1.7621 | Val  Acc: 0.6652
 Site-SynthDigits                   | Val  Loss: 2.1687 | Val  Acc: 0.3485
 Site-SynthDigits                   | Val  Loss: 2.1608 | Val  Acc: 0.3586
 Site-MNIST-M                       | Val  Loss: 2.2473 | Val  Acc: 0.2216
 Site-MNIST-M                       | Val  Loss: 2.2465 | Val  Acc: 0.2197
 Site-SVHN                          | Val  Loss: 2.2431 | Val  Acc: 0.2594
Average Valid Accuracy: 0.4861
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5804
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5444
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5929
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5526
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5877
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7019
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6859
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6652
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3485
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3586
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.2216
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.2197
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2594
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 6 ============
denominator: 25675.53515625
 Site-MNIST                    | Train Loss: 1.7426 | Train Acc: 0.6918
 Site-MNIST                    | Train Loss: 1.8052 | Train Acc: 0.6080
 Site-MNIST                    | Train Loss: 1.7604 | Train Acc: 0.6217
 Site-MNIST                    | Train Loss: 1.7673 | Train Acc: 0.6314
 Site-MNIST                    | Train Loss: 1.7764 | Train Acc: 0.6309
 Site-USPS                     | Train Loss: 1.6801 | Train Acc: 0.6763
 Site-USPS                     | Train Loss: 1.6514 | Train Acc: 0.7013
 Site-USPS                     | Train Loss: 1.6634 | Train Acc: 0.7023
 Site-SynthDigits              | Train Loss: 2.1569 | Train Acc: 0.3311
 Site-SynthDigits              | Train Loss: 2.1341 | Train Acc: 0.3487
 Site-MNIST-M                  | Train Loss: 2.2244 | Train Acc: 0.2415
 Site-MNIST-M                  | Train Loss: 2.2244 | Train Acc: 0.2223
 Site-SVHN                     | Train Loss: 2.2412 | Train Acc: 0.2266
 Site-MNIST                         | Val  Loss: 1.7799 | Val  Acc: 0.6161
 Site-MNIST                         | Val  Loss: 1.7874 | Val  Acc: 0.5621
 Site-MNIST                         | Val  Loss: 1.7618 | Val  Acc: 0.6126
 Site-MNIST                         | Val  Loss: 1.8042 | Val  Acc: 0.5816
 Site-MNIST                         | Val  Loss: 1.7960 | Val  Acc: 0.6088
 Site-USPS                          | Val  Loss: 1.6218 | Val  Acc: 0.7212
 Site-USPS                          | Val  Loss: 1.6573 | Val  Acc: 0.7019
 Site-USPS                          | Val  Loss: 1.6780 | Val  Acc: 0.6994
 Site-SynthDigits                   | Val  Loss: 2.1473 | Val  Acc: 0.3598
 Site-SynthDigits                   | Val  Loss: 2.1386 | Val  Acc: 0.3662
 Site-MNIST-M                       | Val  Loss: 2.2379 | Val  Acc: 0.2216
 Site-MNIST-M                       | Val  Loss: 2.2369 | Val  Acc: 0.2273
 Site-SVHN                          | Val  Loss: 2.2353 | Val  Acc: 0.2628
Average Valid Accuracy: 0.5032
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6161
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.5621
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6126
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.5816
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6088
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7212
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7019
 Best site-USPS                      | Epoch:6 | Val Acc: 0.6994
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3598
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3662
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.2216
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.2273
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2628
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 7 ============
denominator: 25090.236328125
 Site-MNIST                    | Train Loss: 1.6393 | Train Acc: 0.7029
 Site-MNIST                    | Train Loss: 1.7284 | Train Acc: 0.6169
 Site-MNIST                    | Train Loss: 1.6918 | Train Acc: 0.6296
 Site-MNIST                    | Train Loss: 1.6993 | Train Acc: 0.6406
 Site-MNIST                    | Train Loss: 1.7082 | Train Acc: 0.6414
 Site-USPS                     | Train Loss: 1.5779 | Train Acc: 0.6763
 Site-USPS                     | Train Loss: 1.5951 | Train Acc: 0.7117
 Site-USPS                     | Train Loss: 1.5972 | Train Acc: 0.7077
 Site-SynthDigits              | Train Loss: 2.1219 | Train Acc: 0.3330
 Site-SynthDigits              | Train Loss: 2.1111 | Train Acc: 0.3562
 Site-MNIST-M                  | Train Loss: 2.2132 | Train Acc: 0.2628
 Site-MNIST-M                  | Train Loss: 2.2177 | Train Acc: 0.2252
 Site-SVHN                     | Train Loss: 2.2348 | Train Acc: 0.2317
 Site-MNIST                         | Val  Loss: 1.7106 | Val  Acc: 0.6161
 Site-MNIST                         | Val  Loss: 1.7209 | Val  Acc: 0.5740
 Site-MNIST                         | Val  Loss: 1.6944 | Val  Acc: 0.6285
 Site-MNIST                         | Val  Loss: 1.7401 | Val  Acc: 0.5895
 Site-MNIST                         | Val  Loss: 1.7314 | Val  Acc: 0.6158
 Site-USPS                          | Val  Loss: 1.5537 | Val  Acc: 0.7212
 Site-USPS                          | Val  Loss: 1.5912 | Val  Acc: 0.6955
 Site-USPS                          | Val  Loss: 1.6123 | Val  Acc: 0.6994
 Site-SynthDigits                   | Val  Loss: 2.1234 | Val  Acc: 0.3485
 Site-SynthDigits                   | Val  Loss: 2.1152 | Val  Acc: 0.3687
 Site-MNIST-M                       | Val  Loss: 2.2272 | Val  Acc: 0.2330
 Site-MNIST-M                       | Val  Loss: 2.2272 | Val  Acc: 0.2538
 Site-SVHN                          | Val  Loss: 2.2287 | Val  Acc: 0.2765
Average Valid Accuracy: 0.5092
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6161
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.5740
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6285
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.5895
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6158
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7212
 Best site-USPS                      | Epoch:7 | Val Acc: 0.6955
 Best site-USPS                      | Epoch:7 | Val Acc: 0.6994
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3485
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3687
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.2330
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.2538
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2765
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 8 ============
denominator: 24454.4765625
 Site-MNIST                    | Train Loss: 1.6002 | Train Acc: 0.7317
 Site-MNIST                    | Train Loss: 1.6789 | Train Acc: 0.6450
 Site-MNIST                    | Train Loss: 1.6296 | Train Acc: 0.6650
 Site-MNIST                    | Train Loss: 1.6353 | Train Acc: 0.6577
 Site-MNIST                    | Train Loss: 1.6443 | Train Acc: 0.6703
 Site-USPS                     | Train Loss: 1.5352 | Train Acc: 0.6894
 Site-USPS                     | Train Loss: 1.5154 | Train Acc: 0.7300
 Site-USPS                     | Train Loss: 1.5248 | Train Acc: 0.7284
 Site-SynthDigits              | Train Loss: 2.1083 | Train Acc: 0.3434
 Site-SynthDigits              | Train Loss: 2.0883 | Train Acc: 0.3556
 Site-MNIST-M                  | Train Loss: 2.2030 | Train Acc: 0.2670
 Site-MNIST-M                  | Train Loss: 2.2045 | Train Acc: 0.2375
 Site-SVHN                     | Train Loss: 2.2286 | Train Acc: 0.2428
 Site-MNIST                         | Val  Loss: 1.6522 | Val  Acc: 0.6339
 Site-MNIST                         | Val  Loss: 1.6614 | Val  Acc: 0.6213
 Site-MNIST                         | Val  Loss: 1.6304 | Val  Acc: 0.6522
 Site-MNIST                         | Val  Loss: 1.6799 | Val  Acc: 0.6132
 Site-MNIST                         | Val  Loss: 1.6716 | Val  Acc: 0.6491
 Site-USPS                          | Val  Loss: 1.4794 | Val  Acc: 0.7356
 Site-USPS                          | Val  Loss: 1.5209 | Val  Acc: 0.7179
 Site-USPS                          | Val  Loss: 1.5428 | Val  Acc: 0.7207
 Site-SynthDigits                   | Val  Loss: 2.1018 | Val  Acc: 0.3636
 Site-SynthDigits                   | Val  Loss: 2.0928 | Val  Acc: 0.3788
 Site-MNIST-M                       | Val  Loss: 2.2180 | Val  Acc: 0.2386
 Site-MNIST-M                       | Val  Loss: 2.2176 | Val  Acc: 0.2652
 Site-SVHN                          | Val  Loss: 2.2207 | Val  Acc: 0.2935
Average Valid Accuracy: 0.5295
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6339
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6213
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6522
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6132
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6491
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7356
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7179
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7207
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3636
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3788
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.2386
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.2652
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2935
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 9 ============
denominator: 23977.126953125
 Site-MNIST                    | Train Loss: 1.5142 | Train Acc: 0.7539
 Site-MNIST                    | Train Loss: 1.6281 | Train Acc: 0.6642
 Site-MNIST                    | Train Loss: 1.5740 | Train Acc: 0.6906
 Site-MNIST                    | Train Loss: 1.5824 | Train Acc: 0.6702
 Site-MNIST                    | Train Loss: 1.5896 | Train Acc: 0.6909
 Site-USPS                     | Train Loss: 1.4800 | Train Acc: 0.6942
 Site-USPS                     | Train Loss: 1.4588 | Train Acc: 0.7324
 Site-USPS                     | Train Loss: 1.4652 | Train Acc: 0.7370
 Site-SynthDigits              | Train Loss: 2.0694 | Train Acc: 0.3491
 Site-SynthDigits              | Train Loss: 2.0640 | Train Acc: 0.3682
 Site-MNIST-M                  | Train Loss: 2.1931 | Train Acc: 0.2770
 Site-MNIST-M                  | Train Loss: 2.1969 | Train Acc: 0.2498
 Site-SVHN                     | Train Loss: 2.2213 | Train Acc: 0.2470
 Site-MNIST                         | Val  Loss: 1.6009 | Val  Acc: 0.6429
 Site-MNIST                         | Val  Loss: 1.6087 | Val  Acc: 0.6509
 Site-MNIST                         | Val  Loss: 1.5730 | Val  Acc: 0.6838
 Site-MNIST                         | Val  Loss: 1.6256 | Val  Acc: 0.6421
 Site-MNIST                         | Val  Loss: 1.6192 | Val  Acc: 0.6702
 Site-USPS                          | Val  Loss: 1.4186 | Val  Acc: 0.7260
 Site-USPS                          | Val  Loss: 1.4619 | Val  Acc: 0.7019
 Site-USPS                          | Val  Loss: 1.4843 | Val  Acc: 0.7143
 Site-SynthDigits                   | Val  Loss: 2.0796 | Val  Acc: 0.3674
 Site-SynthDigits                   | Val  Loss: 2.0700 | Val  Acc: 0.3864
 Site-MNIST-M                       | Val  Loss: 2.2071 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.2084 | Val  Acc: 0.2689
 Site-SVHN                          | Val  Loss: 2.2126 | Val  Acc: 0.2969
Average Valid Accuracy: 0.5386
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6429
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6509
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6838
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6421
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6702
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7260
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7019
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7143
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3674
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3864
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.2689
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2969
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
 Test site-MNIST                     | Epoch:9 | Test Acc: 0.6796
 Test site-USPS                      | Epoch:9 | Test Acc: 0.7263
 Test site-SynthDigits               | Epoch:9 | Test Acc: 0.3405
 Test site-MNIST-M                   | Epoch:9 | Test Acc: 0.2460
 Test site-SVHN                      | Epoch:9 | Test Acc: 0.2256
MNIST: 0.680, USPS: 0.726, SynthDigits: 0.341, MNIST-M: 0.246, SVHN: 0.226, 
Average Test Accuracy: 0.4436, domain std=0.2158, cluster std=-1.0000, individual std=0.2062, 
============ Train epoch 10 ============
denominator: 23418.658203125
 Site-MNIST                    | Train Loss: 1.4615 | Train Acc: 0.7672
 Site-MNIST                    | Train Loss: 1.5679 | Train Acc: 0.6657
 Site-MNIST                    | Train Loss: 1.5166 | Train Acc: 0.7044
 Site-MNIST                    | Train Loss: 1.5240 | Train Acc: 0.6846
 Site-MNIST                    | Train Loss: 1.5334 | Train Acc: 0.7084
 Site-USPS                     | Train Loss: 1.4179 | Train Acc: 0.7122
 Site-USPS                     | Train Loss: 1.4000 | Train Acc: 0.7564
 Site-USPS                     | Train Loss: 1.4068 | Train Acc: 0.7513
 Site-SynthDigits              | Train Loss: 2.0634 | Train Acc: 0.3510
 Site-SynthDigits              | Train Loss: 2.0469 | Train Acc: 0.3783
 Site-MNIST-M                  | Train Loss: 2.1835 | Train Acc: 0.2869
 Site-MNIST-M                  | Train Loss: 2.1878 | Train Acc: 0.2583
 Site-SVHN                     | Train Loss: 2.2152 | Train Acc: 0.2479
 Site-MNIST                         | Val  Loss: 1.5429 | Val  Acc: 0.6429
 Site-MNIST                         | Val  Loss: 1.5511 | Val  Acc: 0.6627
 Site-MNIST                         | Val  Loss: 1.5159 | Val  Acc: 0.7115
 Site-MNIST                         | Val  Loss: 1.5707 | Val  Acc: 0.6500
 Site-MNIST                         | Val  Loss: 1.5640 | Val  Acc: 0.6719
 Site-USPS                          | Val  Loss: 1.3573 | Val  Acc: 0.7452
 Site-USPS                          | Val  Loss: 1.4034 | Val  Acc: 0.7308
 Site-USPS                          | Val  Loss: 1.4252 | Val  Acc: 0.7377
 Site-SynthDigits                   | Val  Loss: 2.0600 | Val  Acc: 0.3712
 Site-SynthDigits                   | Val  Loss: 2.0501 | Val  Acc: 0.3813
 Site-MNIST-M                       | Val  Loss: 2.1977 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.2002 | Val  Acc: 0.2765
 Site-SVHN                          | Val  Loss: 2.2054 | Val  Acc: 0.2969
Average Valid Accuracy: 0.5484
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6429
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6627
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7115
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6500
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6719
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7452
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7308
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7377
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3712
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3813
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.2765
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2969
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 11 ============
denominator: 22956.859375
 Site-MNIST                    | Train Loss: 1.4280 | Train Acc: 0.7783
 Site-MNIST                    | Train Loss: 1.5107 | Train Acc: 0.6879
 Site-MNIST                    | Train Loss: 1.4667 | Train Acc: 0.7172
 Site-MNIST                    | Train Loss: 1.4772 | Train Acc: 0.6984
 Site-MNIST                    | Train Loss: 1.4844 | Train Acc: 0.7215
 Site-USPS                     | Train Loss: 1.3325 | Train Acc: 0.7254
 Site-USPS                     | Train Loss: 1.3363 | Train Acc: 0.7676
 Site-USPS                     | Train Loss: 1.3439 | Train Acc: 0.7630
 Site-SynthDigits              | Train Loss: 2.0423 | Train Acc: 0.3491
 Site-SynthDigits              | Train Loss: 2.0269 | Train Acc: 0.3733
 Site-MNIST-M                  | Train Loss: 2.1731 | Train Acc: 0.2884
 Site-MNIST-M                  | Train Loss: 2.1783 | Train Acc: 0.2630
 Site-SVHN                     | Train Loss: 2.2086 | Train Acc: 0.2538
 Site-MNIST                         | Val  Loss: 1.4990 | Val  Acc: 0.6518
 Site-MNIST                         | Val  Loss: 1.5031 | Val  Acc: 0.6805
 Site-MNIST                         | Val  Loss: 1.4662 | Val  Acc: 0.7233
 Site-MNIST                         | Val  Loss: 1.5229 | Val  Acc: 0.6658
 Site-MNIST                         | Val  Loss: 1.5175 | Val  Acc: 0.6930
 Site-USPS                          | Val  Loss: 1.2938 | Val  Acc: 0.7788
 Site-USPS                          | Val  Loss: 1.3437 | Val  Acc: 0.7468
 Site-USPS                          | Val  Loss: 1.3646 | Val  Acc: 0.7463
 Site-SynthDigits                   | Val  Loss: 2.0370 | Val  Acc: 0.3750
 Site-SynthDigits                   | Val  Loss: 2.0286 | Val  Acc: 0.3813
 Site-MNIST-M                       | Val  Loss: 2.1892 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1907 | Val  Acc: 0.2803
 Site-SVHN                          | Val  Loss: 2.1976 | Val  Acc: 0.3003
Average Valid Accuracy: 0.5595
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6518
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6805
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7233
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6658
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6930
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7788
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7468
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7463
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3750
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3813
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.2803
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3003
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 12 ============
denominator: 22537.953125
 Site-MNIST                    | Train Loss: 1.3805 | Train Acc: 0.7916
 Site-MNIST                    | Train Loss: 1.4784 | Train Acc: 0.6997
 Site-MNIST                    | Train Loss: 1.4247 | Train Acc: 0.7389
 Site-MNIST                    | Train Loss: 1.4374 | Train Acc: 0.7135
 Site-MNIST                    | Train Loss: 1.4440 | Train Acc: 0.7404
 Site-USPS                     | Train Loss: 1.2685 | Train Acc: 0.7614
 Site-USPS                     | Train Loss: 1.2746 | Train Acc: 0.7947
 Site-USPS                     | Train Loss: 1.2794 | Train Acc: 0.7875
 Site-SynthDigits              | Train Loss: 2.0222 | Train Acc: 0.3642
 Site-SynthDigits              | Train Loss: 2.0063 | Train Acc: 0.3834
 Site-MNIST-M                  | Train Loss: 2.1631 | Train Acc: 0.2983
 Site-MNIST-M                  | Train Loss: 2.1585 | Train Acc: 0.2744
 Site-SVHN                     | Train Loss: 2.2027 | Train Acc: 0.2581
 Site-MNIST                         | Val  Loss: 1.4648 | Val  Acc: 0.6875
 Site-MNIST                         | Val  Loss: 1.4647 | Val  Acc: 0.7041
 Site-MNIST                         | Val  Loss: 1.4219 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.4795 | Val  Acc: 0.6895
 Site-MNIST                         | Val  Loss: 1.4770 | Val  Acc: 0.7035
 Site-USPS                          | Val  Loss: 1.2312 | Val  Acc: 0.7981
 Site-USPS                          | Val  Loss: 1.2856 | Val  Acc: 0.7692
 Site-USPS                          | Val  Loss: 1.3042 | Val  Acc: 0.7655
 Site-SynthDigits                   | Val  Loss: 2.0167 | Val  Acc: 0.3826
 Site-SynthDigits                   | Val  Loss: 2.0087 | Val  Acc: 0.3889
 Site-MNIST-M                       | Val  Loss: 2.1802 | Val  Acc: 0.2670
 Site-MNIST-M                       | Val  Loss: 2.1818 | Val  Acc: 0.2879
 Site-SVHN                          | Val  Loss: 2.1902 | Val  Acc: 0.2969
Average Valid Accuracy: 0.5754
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.6875
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7041
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.6895
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7035
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7981
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7692
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7655
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.3826
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.3889
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.2670
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.2879
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2969
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 13 ============
denominator: 22086.078125
 Site-MNIST                    | Train Loss: 1.3142 | Train Acc: 0.7960
 Site-MNIST                    | Train Loss: 1.4418 | Train Acc: 0.6997
 Site-MNIST                    | Train Loss: 1.3732 | Train Acc: 0.7438
 Site-MNIST                    | Train Loss: 1.3836 | Train Acc: 0.7293
 Site-MNIST                    | Train Loss: 1.3897 | Train Acc: 0.7491
 Site-USPS                     | Train Loss: 1.2740 | Train Acc: 0.7662
 Site-USPS                     | Train Loss: 1.2239 | Train Acc: 0.7971
 Site-USPS                     | Train Loss: 1.2359 | Train Acc: 0.7907
 Site-SynthDigits              | Train Loss: 2.0065 | Train Acc: 0.3775
 Site-SynthDigits              | Train Loss: 1.9875 | Train Acc: 0.3985
 Site-MNIST-M                  | Train Loss: 2.1540 | Train Acc: 0.3111
 Site-MNIST-M                  | Train Loss: 2.1504 | Train Acc: 0.2810
 Site-SVHN                     | Train Loss: 2.1968 | Train Acc: 0.2581
 Site-MNIST                         | Val  Loss: 1.4111 | Val  Acc: 0.6964
 Site-MNIST                         | Val  Loss: 1.4147 | Val  Acc: 0.7041
 Site-MNIST                         | Val  Loss: 1.3701 | Val  Acc: 0.7431
 Site-MNIST                         | Val  Loss: 1.4286 | Val  Acc: 0.6974
 Site-MNIST                         | Val  Loss: 1.4259 | Val  Acc: 0.7035
 Site-USPS                          | Val  Loss: 1.1874 | Val  Acc: 0.7933
 Site-USPS                          | Val  Loss: 1.2428 | Val  Acc: 0.7692
 Site-USPS                          | Val  Loss: 1.2607 | Val  Acc: 0.7761
 Site-SynthDigits                   | Val  Loss: 1.9976 | Val  Acc: 0.4015
 Site-SynthDigits                   | Val  Loss: 1.9896 | Val  Acc: 0.4116
 Site-MNIST-M                       | Val  Loss: 2.1725 | Val  Acc: 0.2784
 Site-MNIST-M                       | Val  Loss: 2.1732 | Val  Acc: 0.2992
 Site-SVHN                          | Val  Loss: 2.1834 | Val  Acc: 0.3003
Average Valid Accuracy: 0.5826
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.6964
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7041
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7431
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.6974
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7035
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7933
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7692
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7761
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4015
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4116
 Best site-MNIST-M                   | Epoch:13 | Val Acc: 0.2784
 Best site-MNIST-M                   | Epoch:13 | Val Acc: 0.2992
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3003
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 14 ============
denominator: 21720.091796875
 Site-MNIST                    | Train Loss: 1.2882 | Train Acc: 0.8004
 Site-MNIST                    | Train Loss: 1.4057 | Train Acc: 0.7130
 Site-MNIST                    | Train Loss: 1.3446 | Train Acc: 0.7507
 Site-MNIST                    | Train Loss: 1.3562 | Train Acc: 0.7247
 Site-MNIST                    | Train Loss: 1.3628 | Train Acc: 0.7417
 Site-USPS                     | Train Loss: 1.2282 | Train Acc: 0.7578
 Site-USPS                     | Train Loss: 1.1991 | Train Acc: 0.7907
 Site-USPS                     | Train Loss: 1.2085 | Train Acc: 0.7833
 Site-SynthDigits              | Train Loss: 1.9872 | Train Acc: 0.3917
 Site-SynthDigits              | Train Loss: 1.9634 | Train Acc: 0.4079
 Site-MNIST-M                  | Train Loss: 2.1428 | Train Acc: 0.3068
 Site-MNIST-M                  | Train Loss: 2.1382 | Train Acc: 0.2791
 Site-SVHN                     | Train Loss: 2.1888 | Train Acc: 0.2641
 Site-MNIST                         | Val  Loss: 1.3875 | Val  Acc: 0.7054
 Site-MNIST                         | Val  Loss: 1.3891 | Val  Acc: 0.7041
 Site-MNIST                         | Val  Loss: 1.3406 | Val  Acc: 0.7549
 Site-MNIST                         | Val  Loss: 1.3992 | Val  Acc: 0.7184
 Site-MNIST                         | Val  Loss: 1.4033 | Val  Acc: 0.7123
 Site-USPS                          | Val  Loss: 1.1642 | Val  Acc: 0.7933
 Site-USPS                          | Val  Loss: 1.2160 | Val  Acc: 0.7756
 Site-USPS                          | Val  Loss: 1.2340 | Val  Acc: 0.7825
 Site-SynthDigits                   | Val  Loss: 1.9726 | Val  Acc: 0.4242
 Site-SynthDigits                   | Val  Loss: 1.9654 | Val  Acc: 0.4242
 Site-MNIST-M                       | Val  Loss: 2.1632 | Val  Acc: 0.2727
 Site-MNIST-M                       | Val  Loss: 2.1594 | Val  Acc: 0.3030
 Site-SVHN                          | Val  Loss: 2.1752 | Val  Acc: 0.3140
Average Valid Accuracy: 0.5911
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7054
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7041
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7549
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7184
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7123
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7933
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7756
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7825
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.4242
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.4242
 Best site-MNIST-M                   | Epoch:14 | Val Acc: 0.2727
 Best site-MNIST-M                   | Epoch:14 | Val Acc: 0.3030
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3140
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 15 ============
denominator: 21305.3984375
 Site-MNIST                    | Train Loss: 1.2340 | Train Acc: 0.8027
 Site-MNIST                    | Train Loss: 1.3509 | Train Acc: 0.7219
 Site-MNIST                    | Train Loss: 1.2919 | Train Acc: 0.7596
 Site-MNIST                    | Train Loss: 1.3067 | Train Acc: 0.7510
 Site-MNIST                    | Train Loss: 1.3118 | Train Acc: 0.7531
 Site-USPS                     | Train Loss: 1.1574 | Train Acc: 0.7794
 Site-USPS                     | Train Loss: 1.1529 | Train Acc: 0.8099
 Site-USPS                     | Train Loss: 1.1552 | Train Acc: 0.7977
 Site-SynthDigits              | Train Loss: 1.9546 | Train Acc: 0.3917
 Site-SynthDigits              | Train Loss: 1.9471 | Train Acc: 0.4155
 Site-MNIST-M                  | Train Loss: 2.1316 | Train Acc: 0.3097
 Site-MNIST-M                  | Train Loss: 2.1419 | Train Acc: 0.2933
 Site-SVHN                     | Train Loss: 2.1834 | Train Acc: 0.2632
 Site-MNIST                         | Val  Loss: 1.3376 | Val  Acc: 0.7232
 Site-MNIST                         | Val  Loss: 1.3393 | Val  Acc: 0.7219
 Site-MNIST                         | Val  Loss: 1.2889 | Val  Acc: 0.7628
 Site-MNIST                         | Val  Loss: 1.3504 | Val  Acc: 0.7211
 Site-MNIST                         | Val  Loss: 1.3521 | Val  Acc: 0.7246
 Site-USPS                          | Val  Loss: 1.1070 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 1.1656 | Val  Acc: 0.7788
 Site-USPS                          | Val  Loss: 1.1810 | Val  Acc: 0.7932
 Site-SynthDigits                   | Val  Loss: 1.9556 | Val  Acc: 0.4205
 Site-SynthDigits                   | Val  Loss: 1.9487 | Val  Acc: 0.4318
 Site-MNIST-M                       | Val  Loss: 2.1541 | Val  Acc: 0.2841
 Site-MNIST-M                       | Val  Loss: 2.1522 | Val  Acc: 0.2992
 Site-SVHN                          | Val  Loss: 2.1682 | Val  Acc: 0.3038
Average Valid Accuracy: 0.5983
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7232
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7219
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7628
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7211
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7246
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8125
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7788
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7932
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4205
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4318
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.2841
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.2992
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3038
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 16 ============
denominator: 20903.001953125
 Site-MNIST                    | Train Loss: 1.2100 | Train Acc: 0.8071
 Site-MNIST                    | Train Loss: 1.3329 | Train Acc: 0.7204
 Site-MNIST                    | Train Loss: 1.2624 | Train Acc: 0.7606
 Site-MNIST                    | Train Loss: 1.2750 | Train Acc: 0.7503
 Site-MNIST                    | Train Loss: 1.2805 | Train Acc: 0.7518
 Site-USPS                     | Train Loss: 1.1593 | Train Acc: 0.7794
 Site-USPS                     | Train Loss: 1.1213 | Train Acc: 0.8091
 Site-USPS                     | Train Loss: 1.1312 | Train Acc: 0.7982
 Site-SynthDigits              | Train Loss: 1.9495 | Train Acc: 0.3974
 Site-SynthDigits              | Train Loss: 1.9244 | Train Acc: 0.4243
 Site-MNIST-M                  | Train Loss: 2.1163 | Train Acc: 0.3111
 Site-MNIST-M                  | Train Loss: 2.1201 | Train Acc: 0.2990
 Site-SVHN                     | Train Loss: 2.1744 | Train Acc: 0.2641
 Site-MNIST                         | Val  Loss: 1.3059 | Val  Acc: 0.7321
 Site-MNIST                         | Val  Loss: 1.3081 | Val  Acc: 0.7160
 Site-MNIST                         | Val  Loss: 1.2573 | Val  Acc: 0.7589
 Site-MNIST                         | Val  Loss: 1.3201 | Val  Acc: 0.7237
 Site-MNIST                         | Val  Loss: 1.3250 | Val  Acc: 0.7228
 Site-USPS                          | Val  Loss: 1.0840 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 1.1430 | Val  Acc: 0.7756
 Site-USPS                          | Val  Loss: 1.1564 | Val  Acc: 0.7932
 Site-SynthDigits                   | Val  Loss: 1.9342 | Val  Acc: 0.4205
 Site-SynthDigits                   | Val  Loss: 1.9274 | Val  Acc: 0.4293
 Site-MNIST-M                       | Val  Loss: 2.1423 | Val  Acc: 0.2841
 Site-MNIST-M                       | Val  Loss: 2.1370 | Val  Acc: 0.2992
 Site-SVHN                          | Val  Loss: 2.1607 | Val  Acc: 0.3072
Average Valid Accuracy: 0.5981
============ Train epoch 17 ============
denominator: 20508.880859375
 Site-MNIST                    | Train Loss: 1.2106 | Train Acc: 0.8137
 Site-MNIST                    | Train Loss: 1.3220 | Train Acc: 0.7263
 Site-MNIST                    | Train Loss: 1.2297 | Train Acc: 0.7764
 Site-MNIST                    | Train Loss: 1.2460 | Train Acc: 0.7641
 Site-MNIST                    | Train Loss: 1.2472 | Train Acc: 0.7614
 Site-USPS                     | Train Loss: 1.0658 | Train Acc: 0.7998
 Site-USPS                     | Train Loss: 1.0636 | Train Acc: 0.8291
 Site-USPS                     | Train Loss: 1.0697 | Train Acc: 0.8142
 Site-SynthDigits              | Train Loss: 1.8916 | Train Acc: 0.4059
 Site-SynthDigits              | Train Loss: 1.9064 | Train Acc: 0.4306
 Site-MNIST-M                  | Train Loss: 2.1025 | Train Acc: 0.3295
 Site-MNIST-M                  | Train Loss: 2.1089 | Train Acc: 0.3009
 Site-SVHN                     | Train Loss: 2.1662 | Train Acc: 0.2641
 Site-MNIST                         | Val  Loss: 1.2793 | Val  Acc: 0.7679
 Site-MNIST                         | Val  Loss: 1.2765 | Val  Acc: 0.7456
 Site-MNIST                         | Val  Loss: 1.2231 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 1.2862 | Val  Acc: 0.7395
 Site-MNIST                         | Val  Loss: 1.2948 | Val  Acc: 0.7298
 Site-USPS                          | Val  Loss: 1.0231 | Val  Acc: 0.8413
 Site-USPS                          | Val  Loss: 1.0871 | Val  Acc: 0.7917
 Site-USPS                          | Val  Loss: 1.0988 | Val  Acc: 0.8081
 Site-SynthDigits                   | Val  Loss: 1.9145 | Val  Acc: 0.4280
 Site-SynthDigits                   | Val  Loss: 1.9093 | Val  Acc: 0.4369
 Site-MNIST-M                       | Val  Loss: 2.1330 | Val  Acc: 0.2955
 Site-MNIST-M                       | Val  Loss: 2.1231 | Val  Acc: 0.3258
 Site-SVHN                          | Val  Loss: 2.1525 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6159
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7679
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7456
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7826
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7395
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7298
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8413
 Best site-USPS                      | Epoch:17 | Val Acc: 0.7917
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8081
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.4280
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.4369
 Best site-MNIST-M                   | Epoch:17 | Val Acc: 0.2955
 Best site-MNIST-M                   | Epoch:17 | Val Acc: 0.3258
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3140
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 18 ============
denominator: 20263.35546875
 Site-MNIST                    | Train Loss: 1.1722 | Train Acc: 0.8204
 Site-MNIST                    | Train Loss: 1.2668 | Train Acc: 0.7411
 Site-MNIST                    | Train Loss: 1.2010 | Train Acc: 0.7862
 Site-MNIST                    | Train Loss: 1.2194 | Train Acc: 0.7654
 Site-MNIST                    | Train Loss: 1.2187 | Train Acc: 0.7658
 Site-USPS                     | Train Loss: 1.0499 | Train Acc: 0.8094
 Site-USPS                     | Train Loss: 1.0351 | Train Acc: 0.8307
 Site-USPS                     | Train Loss: 1.0266 | Train Acc: 0.8211
 Site-SynthDigits              | Train Loss: 1.8976 | Train Acc: 0.4002
 Site-SynthDigits              | Train Loss: 1.8900 | Train Acc: 0.4325
 Site-MNIST-M                  | Train Loss: 2.0900 | Train Acc: 0.3253
 Site-MNIST-M                  | Train Loss: 2.0777 | Train Acc: 0.3065
 Site-SVHN                     | Train Loss: 2.1574 | Train Acc: 0.2649
 Site-MNIST                         | Val  Loss: 1.2550 | Val  Acc: 0.7857
 Site-MNIST                         | Val  Loss: 1.2436 | Val  Acc: 0.7456
 Site-MNIST                         | Val  Loss: 1.1897 | Val  Acc: 0.7905
 Site-MNIST                         | Val  Loss: 1.2544 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.2662 | Val  Acc: 0.7421
 Site-USPS                          | Val  Loss: 0.9801 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 1.0467 | Val  Acc: 0.7917
 Site-USPS                          | Val  Loss: 1.0557 | Val  Acc: 0.8145
 Site-SynthDigits                   | Val  Loss: 1.8945 | Val  Acc: 0.4318
 Site-SynthDigits                   | Val  Loss: 1.8930 | Val  Acc: 0.4242
 Site-MNIST-M                       | Val  Loss: 2.1235 | Val  Acc: 0.3068
 Site-MNIST-M                       | Val  Loss: 2.1095 | Val  Acc: 0.3295
 Site-SVHN                          | Val  Loss: 2.1457 | Val  Acc: 0.3072
Average Valid Accuracy: 0.6197
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7857
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7456
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7905
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7421
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:18 | Val Acc: 0.7917
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8145
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4318
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4242
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.3068
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.3295
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3072
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 19 ============
denominator: 19975.689453125
 Site-MNIST                    | Train Loss: 1.1264 | Train Acc: 0.8204
 Site-MNIST                    | Train Loss: 1.2548 | Train Acc: 0.7500
 Site-MNIST                    | Train Loss: 1.1707 | Train Acc: 0.7941
 Site-MNIST                    | Train Loss: 1.1867 | Train Acc: 0.7740
 Site-MNIST                    | Train Loss: 1.1908 | Train Acc: 0.7728
 Site-USPS                     | Train Loss: 1.0236 | Train Acc: 0.8070
 Site-USPS                     | Train Loss: 1.0016 | Train Acc: 0.8315
 Site-USPS                     | Train Loss: 1.0033 | Train Acc: 0.8216
 Site-SynthDigits              | Train Loss: 1.8961 | Train Acc: 0.4172
 Site-SynthDigits              | Train Loss: 1.8679 | Train Acc: 0.4420
 Site-MNIST-M                  | Train Loss: 2.0772 | Train Acc: 0.3395
 Site-MNIST-M                  | Train Loss: 2.0695 | Train Acc: 0.3122
 Site-SVHN                     | Train Loss: 2.1491 | Train Acc: 0.2726
 Site-MNIST                         | Val  Loss: 1.2245 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.2153 | Val  Acc: 0.7515
 Site-MNIST                         | Val  Loss: 1.1595 | Val  Acc: 0.7945
 Site-MNIST                         | Val  Loss: 1.2238 | Val  Acc: 0.7658
 Site-MNIST                         | Val  Loss: 1.2378 | Val  Acc: 0.7526
 Site-USPS                          | Val  Loss: 0.9622 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 1.0271 | Val  Acc: 0.7917
 Site-USPS                          | Val  Loss: 1.0322 | Val  Acc: 0.8102
 Site-SynthDigits                   | Val  Loss: 1.8735 | Val  Acc: 0.4545
 Site-SynthDigits                   | Val  Loss: 1.8737 | Val  Acc: 0.4394
 Site-MNIST-M                       | Val  Loss: 2.1114 | Val  Acc: 0.3295
 Site-MNIST-M                       | Val  Loss: 2.0973 | Val  Acc: 0.3523
 Site-SVHN                          | Val  Loss: 2.1385 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6302
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7515
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7945
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7658
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7526
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:19 | Val Acc: 0.7917
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8102
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4545
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4394
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.3295
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.3523
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3106
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
 Test site-MNIST                     | Epoch:19 | Test Acc: 0.7734
 Test site-USPS                      | Epoch:19 | Test Acc: 0.8140
 Test site-SynthDigits               | Epoch:19 | Test Acc: 0.4115
 Test site-MNIST-M                   | Epoch:19 | Test Acc: 0.3054
 Test site-SVHN                      | Epoch:19 | Test Acc: 0.2551
MNIST: 0.773, USPS: 0.814, SynthDigits: 0.412, MNIST-M: 0.305, SVHN: 0.255, 
Average Test Accuracy: 0.5119, domain std=0.2359, cluster std=-1.0000, individual std=0.2233, 
============ Train epoch 20 ============
denominator: 19679.185546875
 Site-MNIST                    | Train Loss: 1.1023 | Train Acc: 0.8226
 Site-MNIST                    | Train Loss: 1.2160 | Train Acc: 0.7530
 Site-MNIST                    | Train Loss: 1.1351 | Train Acc: 0.7882
 Site-MNIST                    | Train Loss: 1.1517 | Train Acc: 0.7766
 Site-MNIST                    | Train Loss: 1.1549 | Train Acc: 0.7767
 Site-USPS                     | Train Loss: 0.9969 | Train Acc: 0.8094
 Site-USPS                     | Train Loss: 0.9860 | Train Acc: 0.8331
 Site-USPS                     | Train Loss: 0.9877 | Train Acc: 0.8195
 Site-SynthDigits              | Train Loss: 1.8884 | Train Acc: 0.4182
 Site-SynthDigits              | Train Loss: 1.8523 | Train Acc: 0.4489
 Site-MNIST-M                  | Train Loss: 2.0610 | Train Acc: 0.3551
 Site-MNIST-M                  | Train Loss: 2.0514 | Train Acc: 0.3340
 Site-SVHN                     | Train Loss: 2.1430 | Train Acc: 0.2734
 Site-MNIST                         | Val  Loss: 1.1867 | Val  Acc: 0.7679
 Site-MNIST                         | Val  Loss: 1.1779 | Val  Acc: 0.7337
 Site-MNIST                         | Val  Loss: 1.1237 | Val  Acc: 0.7945
 Site-MNIST                         | Val  Loss: 1.1875 | Val  Acc: 0.7684
 Site-MNIST                         | Val  Loss: 1.2015 | Val  Acc: 0.7561
 Site-USPS                          | Val  Loss: 0.9405 | Val  Acc: 0.8221
 Site-USPS                          | Val  Loss: 1.0059 | Val  Acc: 0.7917
 Site-USPS                          | Val  Loss: 1.0137 | Val  Acc: 0.8145
 Site-SynthDigits                   | Val  Loss: 1.8558 | Val  Acc: 0.4735
 Site-SynthDigits                   | Val  Loss: 1.8522 | Val  Acc: 0.4520
 Site-MNIST-M                       | Val  Loss: 2.0989 | Val  Acc: 0.3295
 Site-MNIST-M                       | Val  Loss: 2.0799 | Val  Acc: 0.3485
 Site-SVHN                          | Val  Loss: 2.1325 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6282
============ Train epoch 21 ============
denominator: 19382.96484375
 Site-MNIST                    | Train Loss: 1.0479 | Train Acc: 0.8271
 Site-MNIST                    | Train Loss: 1.1789 | Train Acc: 0.7604
 Site-MNIST                    | Train Loss: 1.1043 | Train Acc: 0.7990
 Site-MNIST                    | Train Loss: 1.1214 | Train Acc: 0.7871
 Site-MNIST                    | Train Loss: 1.1247 | Train Acc: 0.7798
 Site-USPS                     | Train Loss: 0.9749 | Train Acc: 0.8213
 Site-USPS                     | Train Loss: 0.9338 | Train Acc: 0.8339
 Site-USPS                     | Train Loss: 0.9496 | Train Acc: 0.8291
 Site-SynthDigits              | Train Loss: 1.8263 | Train Acc: 0.4267
 Site-SynthDigits              | Train Loss: 1.8336 | Train Acc: 0.4477
 Site-MNIST-M                  | Train Loss: 2.0476 | Train Acc: 0.3594
 Site-MNIST-M                  | Train Loss: 2.0372 | Train Acc: 0.3377
 Site-SVHN                     | Train Loss: 2.1351 | Train Acc: 0.2734
 Site-MNIST                         | Val  Loss: 1.1594 | Val  Acc: 0.7946
 Site-MNIST                         | Val  Loss: 1.1478 | Val  Acc: 0.7456
 Site-MNIST                         | Val  Loss: 1.0914 | Val  Acc: 0.7984
 Site-MNIST                         | Val  Loss: 1.1554 | Val  Acc: 0.7789
 Site-MNIST                         | Val  Loss: 1.1716 | Val  Acc: 0.7596
 Site-USPS                          | Val  Loss: 0.9056 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.9721 | Val  Acc: 0.7949
 Site-USPS                          | Val  Loss: 0.9771 | Val  Acc: 0.8252
 Site-SynthDigits                   | Val  Loss: 1.8361 | Val  Acc: 0.4773
 Site-SynthDigits                   | Val  Loss: 1.8336 | Val  Acc: 0.4596
 Site-MNIST-M                       | Val  Loss: 2.0870 | Val  Acc: 0.3295
 Site-MNIST-M                       | Val  Loss: 2.0686 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 2.1248 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6357
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7946
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7456
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7984
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7789
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7596
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:21 | Val Acc: 0.7949
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8252
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.4773
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.4596
 Best site-MNIST-M                   | Epoch:21 | Val Acc: 0.3295
 Best site-MNIST-M                   | Epoch:21 | Val Acc: 0.3561
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.3174
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 22 ============
denominator: 19093.203125
 Site-MNIST                    | Train Loss: 1.0448 | Train Acc: 0.8293
 Site-MNIST                    | Train Loss: 1.1581 | Train Acc: 0.7707
 Site-MNIST                    | Train Loss: 1.0731 | Train Acc: 0.8020
 Site-MNIST                    | Train Loss: 1.0914 | Train Acc: 0.7937
 Site-MNIST                    | Train Loss: 1.0936 | Train Acc: 0.7846
 Site-USPS                     | Train Loss: 0.9599 | Train Acc: 0.8261
 Site-USPS                     | Train Loss: 0.9101 | Train Acc: 0.8339
 Site-USPS                     | Train Loss: 0.9234 | Train Acc: 0.8285
 Site-SynthDigits              | Train Loss: 1.8417 | Train Acc: 0.4267
 Site-SynthDigits              | Train Loss: 1.8199 | Train Acc: 0.4527
 Site-MNIST-M                  | Train Loss: 2.0374 | Train Acc: 0.3580
 Site-MNIST-M                  | Train Loss: 2.0358 | Train Acc: 0.3349
 Site-SVHN                     | Train Loss: 2.1256 | Train Acc: 0.2726
 Site-MNIST                         | Val  Loss: 1.1310 | Val  Acc: 0.7946
 Site-MNIST                         | Val  Loss: 1.1167 | Val  Acc: 0.7396
 Site-MNIST                         | Val  Loss: 1.0581 | Val  Acc: 0.7945
 Site-MNIST                         | Val  Loss: 1.1233 | Val  Acc: 0.7789
 Site-MNIST                         | Val  Loss: 1.1400 | Val  Acc: 0.7667
 Site-USPS                          | Val  Loss: 0.8814 | Val  Acc: 0.8317
 Site-USPS                          | Val  Loss: 0.9475 | Val  Acc: 0.7981
 Site-USPS                          | Val  Loss: 0.9504 | Val  Acc: 0.8316
 Site-SynthDigits                   | Val  Loss: 1.8196 | Val  Acc: 0.4886
 Site-SynthDigits                   | Val  Loss: 1.8196 | Val  Acc: 0.4596
 Site-MNIST-M                       | Val  Loss: 2.0754 | Val  Acc: 0.3352
 Site-MNIST-M                       | Val  Loss: 2.0586 | Val  Acc: 0.3523
 Site-SVHN                          | Val  Loss: 2.1183 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6373
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7946
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7396
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7945
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7789
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7667
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8317
 Best site-USPS                      | Epoch:22 | Val Acc: 0.7981
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8316
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.4886
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.4596
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.3352
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.3523
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.3140
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 23 ============
denominator: 18695.9609375
 Site-MNIST                    | Train Loss: 1.0691 | Train Acc: 0.8271
 Site-MNIST                    | Train Loss: 1.1314 | Train Acc: 0.7633
 Site-MNIST                    | Train Loss: 1.0540 | Train Acc: 0.7990
 Site-MNIST                    | Train Loss: 1.0727 | Train Acc: 0.7924
 Site-MNIST                    | Train Loss: 1.0748 | Train Acc: 0.7859
 Site-USPS                     | Train Loss: 0.9341 | Train Acc: 0.8165
 Site-USPS                     | Train Loss: 0.9194 | Train Acc: 0.8371
 Site-USPS                     | Train Loss: 0.9119 | Train Acc: 0.8216
 Site-SynthDigits              | Train Loss: 1.8160 | Train Acc: 0.4418
 Site-SynthDigits              | Train Loss: 1.7863 | Train Acc: 0.4628
 Site-MNIST-M                  | Train Loss: 2.0164 | Train Acc: 0.3693
 Site-MNIST-M                  | Train Loss: 2.0170 | Train Acc: 0.3491
 Site-SVHN                     | Train Loss: 2.1139 | Train Acc: 0.2836
 Site-MNIST                         | Val  Loss: 1.1101 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.0990 | Val  Acc: 0.7456
 Site-MNIST                         | Val  Loss: 1.0410 | Val  Acc: 0.7945
 Site-MNIST                         | Val  Loss: 1.1035 | Val  Acc: 0.7711
 Site-MNIST                         | Val  Loss: 1.1229 | Val  Acc: 0.7632
 Site-USPS                          | Val  Loss: 0.8671 | Val  Acc: 0.8413
 Site-USPS                          | Val  Loss: 0.9347 | Val  Acc: 0.7949
 Site-USPS                          | Val  Loss: 0.9361 | Val  Acc: 0.8230
 Site-SynthDigits                   | Val  Loss: 1.7916 | Val  Acc: 0.5038
 Site-SynthDigits                   | Val  Loss: 1.7900 | Val  Acc: 0.4798
 Site-MNIST-M                       | Val  Loss: 2.0655 | Val  Acc: 0.3466
 Site-MNIST-M                       | Val  Loss: 2.0364 | Val  Acc: 0.3674
 Site-SVHN                          | Val  Loss: 2.1028 | Val  Acc: 0.3242
Average Valid Accuracy: 0.6430
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7456
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7945
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7711
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7632
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8413
 Best site-USPS                      | Epoch:23 | Val Acc: 0.7949
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8230
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.5038
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.4798
 Best site-MNIST-M                   | Epoch:23 | Val Acc: 0.3466
 Best site-MNIST-M                   | Epoch:23 | Val Acc: 0.3674
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.3242
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 24 ============
denominator: 18480.38671875
 Site-MNIST                    | Train Loss: 0.9608 | Train Acc: 0.8271
 Site-MNIST                    | Train Loss: 1.1152 | Train Acc: 0.7825
 Site-MNIST                    | Train Loss: 1.0213 | Train Acc: 0.8039
 Site-MNIST                    | Train Loss: 1.0403 | Train Acc: 0.7989
 Site-MNIST                    | Train Loss: 1.0415 | Train Acc: 0.7929
 Site-USPS                     | Train Loss: 0.8786 | Train Acc: 0.8309
 Site-USPS                     | Train Loss: 0.8713 | Train Acc: 0.8411
 Site-USPS                     | Train Loss: 0.8720 | Train Acc: 0.8360
 Site-SynthDigits              | Train Loss: 1.8175 | Train Acc: 0.4437
 Site-SynthDigits              | Train Loss: 1.7775 | Train Acc: 0.4615
 Site-MNIST-M                  | Train Loss: 2.0093 | Train Acc: 0.3665
 Site-MNIST-M                  | Train Loss: 2.0271 | Train Acc: 0.3548
 Site-SVHN                     | Train Loss: 2.1105 | Train Acc: 0.2777
 Site-MNIST                         | Val  Loss: 1.0814 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.0671 | Val  Acc: 0.7396
 Site-MNIST                         | Val  Loss: 1.0070 | Val  Acc: 0.7945
 Site-MNIST                         | Val  Loss: 1.0689 | Val  Acc: 0.7895
 Site-MNIST                         | Val  Loss: 1.0889 | Val  Acc: 0.7807
 Site-USPS                          | Val  Loss: 0.8317 | Val  Acc: 0.8413
 Site-USPS                          | Val  Loss: 0.8985 | Val  Acc: 0.7981
 Site-USPS                          | Val  Loss: 0.8992 | Val  Acc: 0.8358
 Site-SynthDigits                   | Val  Loss: 1.7791 | Val  Acc: 0.4962
 Site-SynthDigits                   | Val  Loss: 1.7799 | Val  Acc: 0.4773
 Site-MNIST-M                       | Val  Loss: 2.0582 | Val  Acc: 0.3409
 Site-MNIST-M                       | Val  Loss: 2.0297 | Val  Acc: 0.3636
 Site-SVHN                          | Val  Loss: 2.1003 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6440
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7396
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7945
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7895
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7807
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8413
 Best site-USPS                      | Epoch:24 | Val Acc: 0.7981
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8358
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.4962
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.4773
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.3409
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.3636
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3106
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 25 ============
denominator: 18232.30859375
 Site-MNIST                    | Train Loss: 0.9563 | Train Acc: 0.8293
 Site-MNIST                    | Train Loss: 1.0661 | Train Acc: 0.7855
 Site-MNIST                    | Train Loss: 0.9888 | Train Acc: 0.8089
 Site-MNIST                    | Train Loss: 1.0074 | Train Acc: 0.8035
 Site-MNIST                    | Train Loss: 1.0137 | Train Acc: 0.7955
 Site-USPS                     | Train Loss: 0.9161 | Train Acc: 0.8201
 Site-USPS                     | Train Loss: 0.8781 | Train Acc: 0.8299
 Site-USPS                     | Train Loss: 0.8836 | Train Acc: 0.8280
 Site-SynthDigits              | Train Loss: 1.7985 | Train Acc: 0.4456
 Site-SynthDigits              | Train Loss: 1.7656 | Train Acc: 0.4653
 Site-MNIST-M                  | Train Loss: 1.9964 | Train Acc: 0.3736
 Site-MNIST-M                  | Train Loss: 1.9610 | Train Acc: 0.3595
 Site-SVHN                     | Train Loss: 2.1087 | Train Acc: 0.2828
 Site-MNIST                         | Val  Loss: 1.0473 | Val  Acc: 0.7768
 Site-MNIST                         | Val  Loss: 1.0327 | Val  Acc: 0.7574
 Site-MNIST                         | Val  Loss: 0.9745 | Val  Acc: 0.8063
 Site-MNIST                         | Val  Loss: 1.0404 | Val  Acc: 0.7895
 Site-MNIST                         | Val  Loss: 1.0567 | Val  Acc: 0.7825
 Site-USPS                          | Val  Loss: 0.8393 | Val  Acc: 0.8317
 Site-USPS                          | Val  Loss: 0.9088 | Val  Acc: 0.7949
 Site-USPS                          | Val  Loss: 0.9050 | Val  Acc: 0.8230
 Site-SynthDigits                   | Val  Loss: 1.7669 | Val  Acc: 0.5038
 Site-SynthDigits                   | Val  Loss: 1.7675 | Val  Acc: 0.4747
 Site-MNIST-M                       | Val  Loss: 2.0425 | Val  Acc: 0.3580
 Site-MNIST-M                       | Val  Loss: 2.0228 | Val  Acc: 0.3674
 Site-SVHN                          | Val  Loss: 2.0954 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6444
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7768
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7574
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8063
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7895
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7825
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8317
 Best site-USPS                      | Epoch:25 | Val Acc: 0.7949
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8230
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.5038
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.4747
 Best site-MNIST-M                   | Epoch:25 | Val Acc: 0.3580
 Best site-MNIST-M                   | Epoch:25 | Val Acc: 0.3674
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.3106
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 26 ============
denominator: 18050.93359375
 Site-MNIST                    | Train Loss: 0.9152 | Train Acc: 0.8337
 Site-MNIST                    | Train Loss: 1.0436 | Train Acc: 0.7929
 Site-MNIST                    | Train Loss: 0.9624 | Train Acc: 0.8207
 Site-MNIST                    | Train Loss: 0.9802 | Train Acc: 0.8088
 Site-MNIST                    | Train Loss: 0.9869 | Train Acc: 0.8017
 Site-USPS                     | Train Loss: 0.9192 | Train Acc: 0.8285
 Site-USPS                     | Train Loss: 0.8614 | Train Acc: 0.8323
 Site-USPS                     | Train Loss: 0.8558 | Train Acc: 0.8291
 Site-SynthDigits              | Train Loss: 1.7509 | Train Acc: 0.4437
 Site-SynthDigits              | Train Loss: 1.7590 | Train Acc: 0.4685
 Site-MNIST-M                  | Train Loss: 1.9940 | Train Acc: 0.3736
 Site-MNIST-M                  | Train Loss: 2.0130 | Train Acc: 0.3623
 Site-SVHN                     | Train Loss: 2.1063 | Train Acc: 0.2802
 Site-MNIST                         | Val  Loss: 1.0238 | Val  Acc: 0.8304
 Site-MNIST                         | Val  Loss: 1.0103 | Val  Acc: 0.7751
 Site-MNIST                         | Val  Loss: 0.9518 | Val  Acc: 0.8142
 Site-MNIST                         | Val  Loss: 1.0156 | Val  Acc: 0.8079
 Site-MNIST                         | Val  Loss: 1.0324 | Val  Acc: 0.7947
 Site-USPS                          | Val  Loss: 0.8132 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.8837 | Val  Acc: 0.7917
 Site-USPS                          | Val  Loss: 0.8782 | Val  Acc: 0.8316
 Site-SynthDigits                   | Val  Loss: 1.7571 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.7592 | Val  Acc: 0.4747
 Site-MNIST-M                       | Val  Loss: 2.0414 | Val  Acc: 0.3523
 Site-MNIST-M                       | Val  Loss: 2.0209 | Val  Acc: 0.3750
 Site-SVHN                          | Val  Loss: 2.0926 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6532
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8304
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.7751
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8142
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8079
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.7947
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:26 | Val Acc: 0.7917
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8316
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.4747
 Best site-MNIST-M                   | Epoch:26 | Val Acc: 0.3523
 Best site-MNIST-M                   | Epoch:26 | Val Acc: 0.3750
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.3174
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 27 ============
denominator: 17641.3125
 Site-MNIST                    | Train Loss: 0.9559 | Train Acc: 0.8359
 Site-MNIST                    | Train Loss: 1.0361 | Train Acc: 0.7944
 Site-MNIST                    | Train Loss: 0.9503 | Train Acc: 0.8148
 Site-MNIST                    | Train Loss: 0.9683 | Train Acc: 0.8035
 Site-MNIST                    | Train Loss: 0.9757 | Train Acc: 0.7977
 Site-USPS                     | Train Loss: 0.8552 | Train Acc: 0.8261
 Site-USPS                     | Train Loss: 0.8133 | Train Acc: 0.8395
 Site-USPS                     | Train Loss: 0.8290 | Train Acc: 0.8285
 Site-SynthDigits              | Train Loss: 1.7620 | Train Acc: 0.4503
 Site-SynthDigits              | Train Loss: 1.7301 | Train Acc: 0.4697
 Site-MNIST-M                  | Train Loss: 1.9768 | Train Acc: 0.3849
 Site-MNIST-M                  | Train Loss: 1.9889 | Train Acc: 0.3671
 Site-SVHN                     | Train Loss: 2.0892 | Train Acc: 0.2811
 Site-MNIST                         | Val  Loss: 1.0129 | Val  Acc: 0.8125
 Site-MNIST                         | Val  Loss: 0.9940 | Val  Acc: 0.7633
 Site-MNIST                         | Val  Loss: 0.9344 | Val  Acc: 0.8103
 Site-MNIST                         | Val  Loss: 0.9988 | Val  Acc: 0.8053
 Site-MNIST                         | Val  Loss: 1.0189 | Val  Acc: 0.7965
 Site-USPS                          | Val  Loss: 0.7866 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.8576 | Val  Acc: 0.7949
 Site-USPS                          | Val  Loss: 0.8520 | Val  Acc: 0.8358
 Site-SynthDigits                   | Val  Loss: 1.7267 | Val  Acc: 0.5227
 Site-SynthDigits                   | Val  Loss: 1.7343 | Val  Acc: 0.4747
 Site-MNIST-M                       | Val  Loss: 2.0280 | Val  Acc: 0.3693
 Site-MNIST-M                       | Val  Loss: 1.9979 | Val  Acc: 0.3788
 Site-SVHN                          | Val  Loss: 2.0763 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6560
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8125
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.7633
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8103
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8053
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.7965
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8462
 Best site-USPS                      | Epoch:27 | Val Acc: 0.7949
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8358
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5227
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.4747
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.3693
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.3788
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.3174
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 28 ============
denominator: 17515.08984375
 Site-MNIST                    | Train Loss: 0.8702 | Train Acc: 0.8381
 Site-MNIST                    | Train Loss: 0.9988 | Train Acc: 0.7988
 Site-MNIST                    | Train Loss: 0.9203 | Train Acc: 0.8207
 Site-MNIST                    | Train Loss: 0.9385 | Train Acc: 0.8081
 Site-MNIST                    | Train Loss: 0.9385 | Train Acc: 0.8025
 Site-USPS                     | Train Loss: 0.8625 | Train Acc: 0.8309
 Site-USPS                     | Train Loss: 0.8252 | Train Acc: 0.8331
 Site-USPS                     | Train Loss: 0.8294 | Train Acc: 0.8296
 Site-SynthDigits              | Train Loss: 1.7446 | Train Acc: 0.4588
 Site-SynthDigits              | Train Loss: 1.7209 | Train Acc: 0.4741
 Site-MNIST-M                  | Train Loss: 1.9765 | Train Acc: 0.3764
 Site-MNIST-M                  | Train Loss: 1.9786 | Train Acc: 0.3642
 Site-SVHN                     | Train Loss: 2.0904 | Train Acc: 0.2853
 Site-MNIST                         | Val  Loss: 0.9767 | Val  Acc: 0.8125
 Site-MNIST                         | Val  Loss: 0.9645 | Val  Acc: 0.7692
 Site-MNIST                         | Val  Loss: 0.9054 | Val  Acc: 0.8142
 Site-MNIST                         | Val  Loss: 0.9668 | Val  Acc: 0.8026
 Site-MNIST                         | Val  Loss: 0.9880 | Val  Acc: 0.7965
 Site-USPS                          | Val  Loss: 0.7903 | Val  Acc: 0.8317
 Site-USPS                          | Val  Loss: 0.8601 | Val  Acc: 0.7917
 Site-USPS                          | Val  Loss: 0.8541 | Val  Acc: 0.8316
 Site-SynthDigits                   | Val  Loss: 1.7175 | Val  Acc: 0.5227
 Site-SynthDigits                   | Val  Loss: 1.7224 | Val  Acc: 0.4823
 Site-MNIST-M                       | Val  Loss: 2.0336 | Val  Acc: 0.3523
 Site-MNIST-M                       | Val  Loss: 2.0001 | Val  Acc: 0.3788
 Site-SVHN                          | Val  Loss: 2.0741 | Val  Acc: 0.3208
Average Valid Accuracy: 0.6544
============ Train epoch 29 ============
denominator: 17302.876953125
 Site-MNIST                    | Train Loss: 0.8381 | Train Acc: 0.8404
 Site-MNIST                    | Train Loss: 0.9926 | Train Acc: 0.8047
 Site-MNIST                    | Train Loss: 0.9002 | Train Acc: 0.8305
 Site-MNIST                    | Train Loss: 0.9165 | Train Acc: 0.8206
 Site-MNIST                    | Train Loss: 0.9217 | Train Acc: 0.8100
 Site-USPS                     | Train Loss: 0.8280 | Train Acc: 0.8321
 Site-USPS                     | Train Loss: 0.8017 | Train Acc: 0.8387
 Site-USPS                     | Train Loss: 0.7980 | Train Acc: 0.8360
 Site-SynthDigits              | Train Loss: 1.7516 | Train Acc: 0.4456
 Site-SynthDigits              | Train Loss: 1.7122 | Train Acc: 0.4823
 Site-MNIST-M                  | Train Loss: 1.9595 | Train Acc: 0.3750
 Site-MNIST-M                  | Train Loss: 1.9606 | Train Acc: 0.3822
 Site-SVHN                     | Train Loss: 2.0821 | Train Acc: 0.2828
 Site-MNIST                         | Val  Loss: 0.9601 | Val  Acc: 0.8304
 Site-MNIST                         | Val  Loss: 0.9465 | Val  Acc: 0.7811
 Site-MNIST                         | Val  Loss: 0.8861 | Val  Acc: 0.8300
 Site-MNIST                         | Val  Loss: 0.9495 | Val  Acc: 0.8132
 Site-MNIST                         | Val  Loss: 0.9676 | Val  Acc: 0.8035
 Site-USPS                          | Val  Loss: 0.7602 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.8319 | Val  Acc: 0.7949
 Site-USPS                          | Val  Loss: 0.8204 | Val  Acc: 0.8380
 Site-SynthDigits                   | Val  Loss: 1.7077 | Val  Acc: 0.5076
 Site-SynthDigits                   | Val  Loss: 1.7121 | Val  Acc: 0.4621
 Site-MNIST-M                       | Val  Loss: 2.0111 | Val  Acc: 0.3693
 Site-MNIST-M                       | Val  Loss: 1.9854 | Val  Acc: 0.3674
 Site-SVHN                          | Val  Loss: 2.0669 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6585
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8304
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.7811
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8300
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8132
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8035
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8462
 Best site-USPS                      | Epoch:29 | Val Acc: 0.7949
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8380
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5076
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.4621
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.3693
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.3674
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3174
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
 Test site-MNIST                     | Epoch:29 | Test Acc: 0.8174
 Test site-USPS                      | Epoch:29 | Test Acc: 0.8317
 Test site-SynthDigits               | Epoch:29 | Test Acc: 0.4636
 Test site-MNIST-M                   | Epoch:29 | Test Acc: 0.3577
 Test site-SVHN                      | Epoch:29 | Test Acc: 0.2691
MNIST: 0.817, USPS: 0.832, SynthDigits: 0.464, MNIST-M: 0.358, SVHN: 0.269, 
Average Test Accuracy: 0.5479, domain std=0.2342, cluster std=-1.0000, individual std=0.2192, 
============ Train epoch 30 ============
denominator: 17025.736328125
 Site-MNIST                    | Train Loss: 0.8314 | Train Acc: 0.8404
 Site-MNIST                    | Train Loss: 0.9326 | Train Acc: 0.8136
 Site-MNIST                    | Train Loss: 0.8655 | Train Acc: 0.8305
 Site-MNIST                    | Train Loss: 0.8870 | Train Acc: 0.8226
 Site-MNIST                    | Train Loss: 0.8893 | Train Acc: 0.8117
 Site-USPS                     | Train Loss: 0.8395 | Train Acc: 0.8381
 Site-USPS                     | Train Loss: 0.7926 | Train Acc: 0.8371
 Site-USPS                     | Train Loss: 0.7996 | Train Acc: 0.8349
 Site-SynthDigits              | Train Loss: 1.7436 | Train Acc: 0.4484
 Site-SynthDigits              | Train Loss: 1.7086 | Train Acc: 0.4823
 Site-MNIST-M                  | Train Loss: 1.9590 | Train Acc: 0.3920
 Site-MNIST-M                  | Train Loss: 1.9692 | Train Acc: 0.3775
 Site-SVHN                     | Train Loss: 2.0844 | Train Acc: 0.2828
 Site-MNIST                         | Val  Loss: 0.9179 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.9111 | Val  Acc: 0.7929
 Site-MNIST                         | Val  Loss: 0.8527 | Val  Acc: 0.8340
 Site-MNIST                         | Val  Loss: 0.9173 | Val  Acc: 0.8184
 Site-MNIST                         | Val  Loss: 0.9324 | Val  Acc: 0.8140
 Site-USPS                          | Val  Loss: 0.7578 | Val  Acc: 0.8317
 Site-USPS                          | Val  Loss: 0.8295 | Val  Acc: 0.8013
 Site-USPS                          | Val  Loss: 0.8177 | Val  Acc: 0.8401
 Site-SynthDigits                   | Val  Loss: 1.6986 | Val  Acc: 0.5076
 Site-SynthDigits                   | Val  Loss: 1.7090 | Val  Acc: 0.4722
 Site-MNIST-M                       | Val  Loss: 2.0067 | Val  Acc: 0.3750
 Site-MNIST-M                       | Val  Loss: 1.9894 | Val  Acc: 0.3864
 Site-SVHN                          | Val  Loss: 2.0676 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6625
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.7929
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8340
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8184
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8140
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8317
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8013
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8401
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5076
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.4722
 Best site-MNIST-M                   | Epoch:30 | Val Acc: 0.3750
 Best site-MNIST-M                   | Epoch:30 | Val Acc: 0.3864
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.3174
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 31 ============
denominator: 16847.443359375
 Site-MNIST                    | Train Loss: 0.8214 | Train Acc: 0.8426
 Site-MNIST                    | Train Loss: 0.9136 | Train Acc: 0.8107
 Site-MNIST                    | Train Loss: 0.8597 | Train Acc: 0.8305
 Site-MNIST                    | Train Loss: 0.8766 | Train Acc: 0.8246
 Site-MNIST                    | Train Loss: 0.8822 | Train Acc: 0.8174
 Site-USPS                     | Train Loss: 0.8030 | Train Acc: 0.8381
 Site-USPS                     | Train Loss: 0.7963 | Train Acc: 0.8442
 Site-USPS                     | Train Loss: 0.7839 | Train Acc: 0.8307
 Site-SynthDigits              | Train Loss: 1.7144 | Train Acc: 0.4560
 Site-SynthDigits              | Train Loss: 1.6823 | Train Acc: 0.4861
 Site-MNIST-M                  | Train Loss: 1.9378 | Train Acc: 0.3991
 Site-MNIST-M                  | Train Loss: 1.9418 | Train Acc: 0.3822
 Site-SVHN                     | Train Loss: 2.0692 | Train Acc: 0.2862
 Site-MNIST                         | Val  Loss: 0.9203 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.9093 | Val  Acc: 0.7811
 Site-MNIST                         | Val  Loss: 0.8445 | Val  Acc: 0.8340
 Site-MNIST                         | Val  Loss: 0.9067 | Val  Acc: 0.8211
 Site-MNIST                         | Val  Loss: 0.9270 | Val  Acc: 0.8123
 Site-USPS                          | Val  Loss: 0.7478 | Val  Acc: 0.8510
 Site-USPS                          | Val  Loss: 0.8180 | Val  Acc: 0.8045
 Site-USPS                          | Val  Loss: 0.8025 | Val  Acc: 0.8486
 Site-SynthDigits                   | Val  Loss: 1.6783 | Val  Acc: 0.5227
 Site-SynthDigits                   | Val  Loss: 1.6869 | Val  Acc: 0.4722
 Site-MNIST-M                       | Val  Loss: 1.9936 | Val  Acc: 0.3977
 Site-MNIST-M                       | Val  Loss: 1.9644 | Val  Acc: 0.3939
 Site-SVHN                          | Val  Loss: 2.0537 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6670
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.7811
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8340
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8211
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8123
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8510
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8045
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8486
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5227
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.4722
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.3977
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.3939
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.3106
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 32 ============
denominator: 16700.5234375
 Site-MNIST                    | Train Loss: 0.7861 | Train Acc: 0.8448
 Site-MNIST                    | Train Loss: 0.9162 | Train Acc: 0.8107
 Site-MNIST                    | Train Loss: 0.8432 | Train Acc: 0.8296
 Site-MNIST                    | Train Loss: 0.8602 | Train Acc: 0.8272
 Site-MNIST                    | Train Loss: 0.8653 | Train Acc: 0.8170
 Site-USPS                     | Train Loss: 0.7766 | Train Acc: 0.8453
 Site-USPS                     | Train Loss: 0.7682 | Train Acc: 0.8427
 Site-USPS                     | Train Loss: 0.7658 | Train Acc: 0.8328
 Site-SynthDigits              | Train Loss: 1.6828 | Train Acc: 0.4645
 Site-SynthDigits              | Train Loss: 1.6620 | Train Acc: 0.4968
 Site-MNIST-M                  | Train Loss: 1.9342 | Train Acc: 0.4048
 Site-MNIST-M                  | Train Loss: 1.9398 | Train Acc: 0.3888
 Site-SVHN                     | Train Loss: 2.0549 | Train Acc: 0.2964
 Site-MNIST                         | Val  Loss: 0.8976 | Val  Acc: 0.8304
 Site-MNIST                         | Val  Loss: 0.8927 | Val  Acc: 0.7692
 Site-MNIST                         | Val  Loss: 0.8331 | Val  Acc: 0.8221
 Site-MNIST                         | Val  Loss: 0.8885 | Val  Acc: 0.8237
 Site-MNIST                         | Val  Loss: 0.9108 | Val  Acc: 0.8123
 Site-USPS                          | Val  Loss: 0.7330 | Val  Acc: 0.8413
 Site-USPS                          | Val  Loss: 0.8035 | Val  Acc: 0.8013
 Site-USPS                          | Val  Loss: 0.7874 | Val  Acc: 0.8486
 Site-SynthDigits                   | Val  Loss: 1.6580 | Val  Acc: 0.5492
 Site-SynthDigits                   | Val  Loss: 1.6644 | Val  Acc: 0.4975
 Site-MNIST-M                       | Val  Loss: 1.9962 | Val  Acc: 0.3977
 Site-MNIST-M                       | Val  Loss: 1.9545 | Val  Acc: 0.4091
 Site-SVHN                          | Val  Loss: 2.0395 | Val  Acc: 0.3208
Average Valid Accuracy: 0.6710
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8304
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.7692
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8221
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8237
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8123
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8413
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8013
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8486
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.5492
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.4975
 Best site-MNIST-M                   | Epoch:32 | Val Acc: 0.3977
 Best site-MNIST-M                   | Epoch:32 | Val Acc: 0.4091
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.3208
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 33 ============
denominator: 16578.958984375
 Site-MNIST                    | Train Loss: 0.7712 | Train Acc: 0.8359
 Site-MNIST                    | Train Loss: 0.8879 | Train Acc: 0.8210
 Site-MNIST                    | Train Loss: 0.8321 | Train Acc: 0.8374
 Site-MNIST                    | Train Loss: 0.8496 | Train Acc: 0.8331
 Site-MNIST                    | Train Loss: 0.8539 | Train Acc: 0.8187
 Site-USPS                     | Train Loss: 0.7666 | Train Acc: 0.8477
 Site-USPS                     | Train Loss: 0.7208 | Train Acc: 0.8538
 Site-USPS                     | Train Loss: 0.7168 | Train Acc: 0.8466
 Site-SynthDigits              | Train Loss: 1.6601 | Train Acc: 0.4749
 Site-SynthDigits              | Train Loss: 1.6488 | Train Acc: 0.4924
 Site-MNIST-M                  | Train Loss: 1.9179 | Train Acc: 0.4091
 Site-MNIST-M                  | Train Loss: 1.9045 | Train Acc: 0.3860
 Site-SVHN                     | Train Loss: 2.0508 | Train Acc: 0.2947
 Site-MNIST                         | Val  Loss: 0.8897 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.8804 | Val  Acc: 0.7870
 Site-MNIST                         | Val  Loss: 0.8175 | Val  Acc: 0.8419
 Site-MNIST                         | Val  Loss: 0.8773 | Val  Acc: 0.8342
 Site-MNIST                         | Val  Loss: 0.8988 | Val  Acc: 0.8193
 Site-USPS                          | Val  Loss: 0.6798 | Val  Acc: 0.8606
 Site-USPS                          | Val  Loss: 0.7527 | Val  Acc: 0.8237
 Site-USPS                          | Val  Loss: 0.7403 | Val  Acc: 0.8571
 Site-SynthDigits                   | Val  Loss: 1.6415 | Val  Acc: 0.5455
 Site-SynthDigits                   | Val  Loss: 1.6497 | Val  Acc: 0.4899
 Site-MNIST-M                       | Val  Loss: 1.9807 | Val  Acc: 0.4205
 Site-MNIST-M                       | Val  Loss: 1.9444 | Val  Acc: 0.4091
 Site-SVHN                          | Val  Loss: 2.0303 | Val  Acc: 0.3208
Average Valid Accuracy: 0.6807
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8393
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.7870
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8419
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8342
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8193
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8606
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8237
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8571
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.5455
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.4899
 Best site-MNIST-M                   | Epoch:33 | Val Acc: 0.4205
 Best site-MNIST-M                   | Epoch:33 | Val Acc: 0.4091
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.3208
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 34 ============
denominator: 16380.779296875
 Site-MNIST                    | Train Loss: 0.7749 | Train Acc: 0.8448
 Site-MNIST                    | Train Loss: 0.8438 | Train Acc: 0.8328
 Site-MNIST                    | Train Loss: 0.7880 | Train Acc: 0.8424
 Site-MNIST                    | Train Loss: 0.8066 | Train Acc: 0.8390
 Site-MNIST                    | Train Loss: 0.8121 | Train Acc: 0.8284
 Site-USPS                     | Train Loss: 0.7827 | Train Acc: 0.8525
 Site-USPS                     | Train Loss: 0.7426 | Train Acc: 0.8490
 Site-USPS                     | Train Loss: 0.7290 | Train Acc: 0.8413
 Site-SynthDigits              | Train Loss: 1.6407 | Train Acc: 0.4607
 Site-SynthDigits              | Train Loss: 1.6519 | Train Acc: 0.5000
 Site-MNIST-M                  | Train Loss: 1.9183 | Train Acc: 0.4119
 Site-MNIST-M                  | Train Loss: 1.8822 | Train Acc: 0.3888
 Site-SVHN                     | Train Loss: 2.0566 | Train Acc: 0.2853
 Site-MNIST                         | Val  Loss: 0.8374 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.8384 | Val  Acc: 0.7870
 Site-MNIST                         | Val  Loss: 0.7778 | Val  Acc: 0.8498
 Site-MNIST                         | Val  Loss: 0.8374 | Val  Acc: 0.8447
 Site-MNIST                         | Val  Loss: 0.8552 | Val  Acc: 0.8316
 Site-USPS                          | Val  Loss: 0.6967 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.7684 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.7514 | Val  Acc: 0.8550
 Site-SynthDigits                   | Val  Loss: 1.6450 | Val  Acc: 0.5379
 Site-SynthDigits                   | Val  Loss: 1.6530 | Val  Acc: 0.4874
 Site-MNIST-M                       | Val  Loss: 1.9736 | Val  Acc: 0.3920
 Site-MNIST-M                       | Val  Loss: 1.9460 | Val  Acc: 0.4091
 Site-SVHN                          | Val  Loss: 2.0390 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6759
============ Train epoch 35 ============
denominator: 16158.8564453125
 Site-MNIST                    | Train Loss: 0.7414 | Train Acc: 0.8426
 Site-MNIST                    | Train Loss: 0.8644 | Train Acc: 0.8225
 Site-MNIST                    | Train Loss: 0.7925 | Train Acc: 0.8394
 Site-MNIST                    | Train Loss: 0.8106 | Train Acc: 0.8331
 Site-MNIST                    | Train Loss: 0.8180 | Train Acc: 0.8240
 Site-USPS                     | Train Loss: 0.7586 | Train Acc: 0.8429
 Site-USPS                     | Train Loss: 0.7127 | Train Acc: 0.8442
 Site-USPS                     | Train Loss: 0.7216 | Train Acc: 0.8376
 Site-SynthDigits              | Train Loss: 1.6562 | Train Acc: 0.4683
 Site-SynthDigits              | Train Loss: 1.6308 | Train Acc: 0.5032
 Site-MNIST-M                  | Train Loss: 1.9016 | Train Acc: 0.4233
 Site-MNIST-M                  | Train Loss: 1.8995 | Train Acc: 0.3964
 Site-SVHN                     | Train Loss: 2.0454 | Train Acc: 0.2990
 Site-MNIST                         | Val  Loss: 0.8458 | Val  Acc: 0.8304
 Site-MNIST                         | Val  Loss: 0.8419 | Val  Acc: 0.7929
 Site-MNIST                         | Val  Loss: 0.7803 | Val  Acc: 0.8458
 Site-MNIST                         | Val  Loss: 0.8397 | Val  Acc: 0.8421
 Site-MNIST                         | Val  Loss: 0.8612 | Val  Acc: 0.8228
 Site-USPS                          | Val  Loss: 0.6853 | Val  Acc: 0.8413
 Site-USPS                          | Val  Loss: 0.7578 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.7422 | Val  Acc: 0.8465
 Site-SynthDigits                   | Val  Loss: 1.6200 | Val  Acc: 0.5492
 Site-SynthDigits                   | Val  Loss: 1.6310 | Val  Acc: 0.4874
 Site-MNIST-M                       | Val  Loss: 1.9625 | Val  Acc: 0.4148
 Site-MNIST-M                       | Val  Loss: 1.9285 | Val  Acc: 0.4280
 Site-SVHN                          | Val  Loss: 2.0244 | Val  Acc: 0.3311
Average Valid Accuracy: 0.6800
============ Train epoch 36 ============
denominator: 15977.619140625
 Site-MNIST                    | Train Loss: 0.7387 | Train Acc: 0.8514
 Site-MNIST                    | Train Loss: 0.8574 | Train Acc: 0.8284
 Site-MNIST                    | Train Loss: 0.7660 | Train Acc: 0.8355
 Site-MNIST                    | Train Loss: 0.7878 | Train Acc: 0.8331
 Site-MNIST                    | Train Loss: 0.7916 | Train Acc: 0.8240
 Site-USPS                     | Train Loss: 0.7537 | Train Acc: 0.8357
 Site-USPS                     | Train Loss: 0.7574 | Train Acc: 0.8450
 Site-USPS                     | Train Loss: 0.7409 | Train Acc: 0.8323
 Site-SynthDigits              | Train Loss: 1.6568 | Train Acc: 0.4664
 Site-SynthDigits              | Train Loss: 1.6230 | Train Acc: 0.5069
 Site-MNIST-M                  | Train Loss: 1.8843 | Train Acc: 0.4361
 Site-MNIST-M                  | Train Loss: 1.8894 | Train Acc: 0.4163
 Site-SVHN                     | Train Loss: 2.0469 | Train Acc: 0.2922
 Site-MNIST                         | Val  Loss: 0.8095 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.8169 | Val  Acc: 0.7870
 Site-MNIST                         | Val  Loss: 0.7581 | Val  Acc: 0.8340
 Site-MNIST                         | Val  Loss: 0.8156 | Val  Acc: 0.8289
 Site-MNIST                         | Val  Loss: 0.8342 | Val  Acc: 0.8281
 Site-USPS                          | Val  Loss: 0.7095 | Val  Acc: 0.8413
 Site-USPS                          | Val  Loss: 0.7828 | Val  Acc: 0.7949
 Site-USPS                          | Val  Loss: 0.7587 | Val  Acc: 0.8422
 Site-SynthDigits                   | Val  Loss: 1.6145 | Val  Acc: 0.5303
 Site-SynthDigits                   | Val  Loss: 1.6260 | Val  Acc: 0.4773
 Site-MNIST-M                       | Val  Loss: 1.9471 | Val  Acc: 0.4261
 Site-MNIST-M                       | Val  Loss: 1.9156 | Val  Acc: 0.4318
 Site-SVHN                          | Val  Loss: 2.0230 | Val  Acc: 0.3208
Average Valid Accuracy: 0.6755
============ Train epoch 37 ============
denominator: 15954.279296875
 Site-MNIST                    | Train Loss: 0.7099 | Train Acc: 0.8514
 Site-MNIST                    | Train Loss: 0.8228 | Train Acc: 0.8388
 Site-MNIST                    | Train Loss: 0.7507 | Train Acc: 0.8443
 Site-MNIST                    | Train Loss: 0.7722 | Train Acc: 0.8482
 Site-MNIST                    | Train Loss: 0.7820 | Train Acc: 0.8314
 Site-USPS                     | Train Loss: 0.7071 | Train Acc: 0.8537
 Site-USPS                     | Train Loss: 0.6698 | Train Acc: 0.8514
 Site-USPS                     | Train Loss: 0.6789 | Train Acc: 0.8498
 Site-SynthDigits              | Train Loss: 1.6465 | Train Acc: 0.4749
 Site-SynthDigits              | Train Loss: 1.6176 | Train Acc: 0.5076
 Site-MNIST-M                  | Train Loss: 1.8952 | Train Acc: 0.4261
 Site-MNIST-M                  | Train Loss: 1.8826 | Train Acc: 0.3955
 Site-SVHN                     | Train Loss: 2.0414 | Train Acc: 0.2922
 Site-MNIST                         | Val  Loss: 0.8041 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.8029 | Val  Acc: 0.7988
 Site-MNIST                         | Val  Loss: 0.7400 | Val  Acc: 0.8458
 Site-MNIST                         | Val  Loss: 0.8000 | Val  Acc: 0.8474
 Site-MNIST                         | Val  Loss: 0.8206 | Val  Acc: 0.8386
 Site-USPS                          | Val  Loss: 0.6476 | Val  Acc: 0.8558
 Site-USPS                          | Val  Loss: 0.7201 | Val  Acc: 0.8109
 Site-USPS                          | Val  Loss: 0.7032 | Val  Acc: 0.8550
 Site-SynthDigits                   | Val  Loss: 1.6111 | Val  Acc: 0.5417
 Site-SynthDigits                   | Val  Loss: 1.6179 | Val  Acc: 0.5051
 Site-MNIST-M                       | Val  Loss: 1.9554 | Val  Acc: 0.4148
 Site-MNIST-M                       | Val  Loss: 1.9235 | Val  Acc: 0.4280
 Site-SVHN                          | Val  Loss: 2.0203 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6852
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8482
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.7988
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8458
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8474
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8386
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8558
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8109
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8550
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.5417
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.5051
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.4148
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.4280
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.3174
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 38 ============
denominator: 15718.275390625
 Site-MNIST                    | Train Loss: 0.6726 | Train Acc: 0.8581
 Site-MNIST                    | Train Loss: 0.8116 | Train Acc: 0.8417
 Site-MNIST                    | Train Loss: 0.7323 | Train Acc: 0.8443
 Site-MNIST                    | Train Loss: 0.7536 | Train Acc: 0.8443
 Site-MNIST                    | Train Loss: 0.7603 | Train Acc: 0.8319
 Site-USPS                     | Train Loss: 0.7260 | Train Acc: 0.8501
 Site-USPS                     | Train Loss: 0.6812 | Train Acc: 0.8498
 Site-USPS                     | Train Loss: 0.6863 | Train Acc: 0.8435
 Site-SynthDigits              | Train Loss: 1.6419 | Train Acc: 0.4768
 Site-SynthDigits              | Train Loss: 1.6009 | Train Acc: 0.5126
 Site-MNIST-M                  | Train Loss: 1.8741 | Train Acc: 0.4375
 Site-MNIST-M                  | Train Loss: 1.8830 | Train Acc: 0.4182
 Site-SVHN                     | Train Loss: 2.0377 | Train Acc: 0.2939
 Site-MNIST                         | Val  Loss: 0.7686 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.7784 | Val  Acc: 0.7929
 Site-MNIST                         | Val  Loss: 0.7229 | Val  Acc: 0.8538
 Site-MNIST                         | Val  Loss: 0.7789 | Val  Acc: 0.8447
 Site-MNIST                         | Val  Loss: 0.7984 | Val  Acc: 0.8386
 Site-USPS                          | Val  Loss: 0.6531 | Val  Acc: 0.8510
 Site-USPS                          | Val  Loss: 0.7268 | Val  Acc: 0.8045
 Site-USPS                          | Val  Loss: 0.7074 | Val  Acc: 0.8507
 Site-SynthDigits                   | Val  Loss: 1.5906 | Val  Acc: 0.5455
 Site-SynthDigits                   | Val  Loss: 1.6014 | Val  Acc: 0.5051
 Site-MNIST-M                       | Val  Loss: 1.9383 | Val  Acc: 0.4261
 Site-MNIST-M                       | Val  Loss: 1.9048 | Val  Acc: 0.4318
 Site-SVHN                          | Val  Loss: 2.0115 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6845
============ Train epoch 39 ============
denominator: 15702.0634765625
 Site-MNIST                    | Train Loss: 0.7198 | Train Acc: 0.8537
 Site-MNIST                    | Train Loss: 0.7927 | Train Acc: 0.8358
 Site-MNIST                    | Train Loss: 0.7392 | Train Acc: 0.8473
 Site-MNIST                    | Train Loss: 0.7595 | Train Acc: 0.8449
 Site-MNIST                    | Train Loss: 0.7653 | Train Acc: 0.8345
 Site-USPS                     | Train Loss: 0.7276 | Train Acc: 0.8525
 Site-USPS                     | Train Loss: 0.6946 | Train Acc: 0.8522
 Site-USPS                     | Train Loss: 0.6855 | Train Acc: 0.8477
 Site-SynthDigits              | Train Loss: 1.5717 | Train Acc: 0.5052
 Site-SynthDigits              | Train Loss: 1.5543 | Train Acc: 0.5372
 Site-MNIST-M                  | Train Loss: 1.8774 | Train Acc: 0.4148
 Site-MNIST-M                  | Train Loss: 1.8786 | Train Acc: 0.3955
 Site-SVHN                     | Train Loss: 2.0115 | Train Acc: 0.3024
 Site-MNIST                         | Val  Loss: 0.7876 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.7895 | Val  Acc: 0.7870
 Site-MNIST                         | Val  Loss: 0.7304 | Val  Acc: 0.8379
 Site-MNIST                         | Val  Loss: 0.7789 | Val  Acc: 0.8368
 Site-MNIST                         | Val  Loss: 0.8032 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.6562 | Val  Acc: 0.8558
 Site-USPS                          | Val  Loss: 0.7290 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.7098 | Val  Acc: 0.8614
 Site-SynthDigits                   | Val  Loss: 1.5590 | Val  Acc: 0.5530
 Site-SynthDigits                   | Val  Loss: 1.5599 | Val  Acc: 0.5379
 Site-MNIST-M                       | Val  Loss: 1.9584 | Val  Acc: 0.4091
 Site-MNIST-M                       | Val  Loss: 1.8975 | Val  Acc: 0.4280
 Site-SVHN                          | Val  Loss: 1.9842 | Val  Acc: 0.3379
Average Valid Accuracy: 0.6879
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.7870
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8379
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8368
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8333
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8558
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8077
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8614
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.5530
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.5379
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.4091
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.4280
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.3379
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
 Test site-MNIST                     | Epoch:39 | Test Acc: 0.8389
 Test site-USPS                      | Epoch:39 | Test Acc: 0.8516
 Test site-SynthDigits               | Epoch:39 | Test Acc: 0.5213
 Test site-MNIST-M                   | Epoch:39 | Test Acc: 0.3921
 Test site-SVHN                      | Epoch:39 | Test Acc: 0.2877
MNIST: 0.839, USPS: 0.852, SynthDigits: 0.521, MNIST-M: 0.392, SVHN: 0.288, 
Average Test Accuracy: 0.5783, domain std=0.2302, cluster std=-1.0000, individual std=0.2121, 
============ Train epoch 40 ============
denominator: 15395.888671875
 Site-MNIST                    | Train Loss: 0.7302 | Train Acc: 0.8537
 Site-MNIST                    | Train Loss: 0.7779 | Train Acc: 0.8358
 Site-MNIST                    | Train Loss: 0.7095 | Train Acc: 0.8453
 Site-MNIST                    | Train Loss: 0.7307 | Train Acc: 0.8463
 Site-MNIST                    | Train Loss: 0.7358 | Train Acc: 0.8319
 Site-USPS                     | Train Loss: 0.7290 | Train Acc: 0.8537
 Site-USPS                     | Train Loss: 0.6971 | Train Acc: 0.8498
 Site-USPS                     | Train Loss: 0.6800 | Train Acc: 0.8403
 Site-SynthDigits              | Train Loss: 1.5902 | Train Acc: 0.4768
 Site-SynthDigits              | Train Loss: 1.5828 | Train Acc: 0.5240
 Site-MNIST-M                  | Train Loss: 1.8470 | Train Acc: 0.4489
 Site-MNIST-M                  | Train Loss: 1.8543 | Train Acc: 0.4267
 Site-SVHN                     | Train Loss: 2.0302 | Train Acc: 0.2947
 Site-MNIST                         | Val  Loss: 0.7463 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.7559 | Val  Acc: 0.8107
 Site-MNIST                         | Val  Loss: 0.7019 | Val  Acc: 0.8538
 Site-MNIST                         | Val  Loss: 0.7556 | Val  Acc: 0.8421
 Site-MNIST                         | Val  Loss: 0.7769 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.6444 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.7191 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.6964 | Val  Acc: 0.8571
 Site-SynthDigits                   | Val  Loss: 1.5675 | Val  Acc: 0.5341
 Site-SynthDigits                   | Val  Loss: 1.5799 | Val  Acc: 0.4899
 Site-MNIST-M                       | Val  Loss: 1.9182 | Val  Acc: 0.4261
 Site-MNIST-M                       | Val  Loss: 1.8808 | Val  Acc: 0.4432
 Site-SVHN                          | Val  Loss: 2.0026 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6851
============ Train epoch 41 ============
denominator: 15217.20703125
 Site-MNIST                    | Train Loss: 0.6869 | Train Acc: 0.8581
 Site-MNIST                    | Train Loss: 0.7646 | Train Acc: 0.8358
 Site-MNIST                    | Train Loss: 0.7046 | Train Acc: 0.8443
 Site-MNIST                    | Train Loss: 0.7245 | Train Acc: 0.8449
 Site-MNIST                    | Train Loss: 0.7306 | Train Acc: 0.8345
 Site-USPS                     | Train Loss: 0.6972 | Train Acc: 0.8537
 Site-USPS                     | Train Loss: 0.6519 | Train Acc: 0.8522
 Site-USPS                     | Train Loss: 0.6548 | Train Acc: 0.8456
 Site-SynthDigits              | Train Loss: 1.5694 | Train Acc: 0.4872
 Site-SynthDigits              | Train Loss: 1.5672 | Train Acc: 0.5240
 Site-MNIST-M                  | Train Loss: 1.8565 | Train Acc: 0.4361
 Site-MNIST-M                  | Train Loss: 1.8476 | Train Acc: 0.4238
 Site-SVHN                     | Train Loss: 2.0199 | Train Acc: 0.2990
 Site-MNIST                         | Val  Loss: 0.7341 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.7497 | Val  Acc: 0.7988
 Site-MNIST                         | Val  Loss: 0.6995 | Val  Acc: 0.8498
 Site-MNIST                         | Val  Loss: 0.7491 | Val  Acc: 0.8447
 Site-MNIST                         | Val  Loss: 0.7690 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.6245 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.6970 | Val  Acc: 0.8045
 Site-USPS                          | Val  Loss: 0.6768 | Val  Acc: 0.8507
 Site-SynthDigits                   | Val  Loss: 1.5593 | Val  Acc: 0.5379
 Site-SynthDigits                   | Val  Loss: 1.5709 | Val  Acc: 0.5051
 Site-MNIST-M                       | Val  Loss: 1.9313 | Val  Acc: 0.4148
 Site-MNIST-M                       | Val  Loss: 1.8839 | Val  Acc: 0.4394
 Site-SVHN                          | Val  Loss: 1.9925 | Val  Acc: 0.3242
Average Valid Accuracy: 0.6844
============ Train epoch 42 ============
denominator: 15154.2919921875
 Site-MNIST                    | Train Loss: 0.6507 | Train Acc: 0.8514
 Site-MNIST                    | Train Loss: 0.7432 | Train Acc: 0.8476
 Site-MNIST                    | Train Loss: 0.6764 | Train Acc: 0.8601
 Site-MNIST                    | Train Loss: 0.6988 | Train Acc: 0.8561
 Site-MNIST                    | Train Loss: 0.7046 | Train Acc: 0.8433
 Site-USPS                     | Train Loss: 0.7053 | Train Acc: 0.8549
 Site-USPS                     | Train Loss: 0.6516 | Train Acc: 0.8546
 Site-USPS                     | Train Loss: 0.6627 | Train Acc: 0.8466
 Site-SynthDigits              | Train Loss: 1.6187 | Train Acc: 0.4939
 Site-SynthDigits              | Train Loss: 1.5598 | Train Acc: 0.5315
 Site-MNIST-M                  | Train Loss: 1.8391 | Train Acc: 0.4432
 Site-MNIST-M                  | Train Loss: 1.8466 | Train Acc: 0.4333
 Site-SVHN                     | Train Loss: 2.0153 | Train Acc: 0.2947
 Site-MNIST                         | Val  Loss: 0.7107 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.7196 | Val  Acc: 0.8343
 Site-MNIST                         | Val  Loss: 0.6658 | Val  Acc: 0.8775
 Site-MNIST                         | Val  Loss: 0.7198 | Val  Acc: 0.8632
 Site-MNIST                         | Val  Loss: 0.7416 | Val  Acc: 0.8474
 Site-USPS                          | Val  Loss: 0.6311 | Val  Acc: 0.8558
 Site-USPS                          | Val  Loss: 0.7039 | Val  Acc: 0.8205
 Site-USPS                          | Val  Loss: 0.6801 | Val  Acc: 0.8593
 Site-SynthDigits                   | Val  Loss: 1.5496 | Val  Acc: 0.5530
 Site-SynthDigits                   | Val  Loss: 1.5570 | Val  Acc: 0.5126
 Site-MNIST-M                       | Val  Loss: 1.9127 | Val  Acc: 0.4489
 Site-MNIST-M                       | Val  Loss: 1.8687 | Val  Acc: 0.4470
 Site-SVHN                          | Val  Loss: 1.9852 | Val  Acc: 0.3311
Average Valid Accuracy: 0.6999
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8482
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8343
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8775
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8632
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8474
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8558
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8205
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8593
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.5530
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.5126
 Best site-MNIST-M                   | Epoch:42 | Val Acc: 0.4489
 Best site-MNIST-M                   | Epoch:42 | Val Acc: 0.4470
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.3311
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 43 ============
denominator: 15100.0458984375
 Site-MNIST                    | Train Loss: 0.6764 | Train Acc: 0.8404
 Site-MNIST                    | Train Loss: 0.7681 | Train Acc: 0.8328
 Site-MNIST                    | Train Loss: 0.6966 | Train Acc: 0.8483
 Site-MNIST                    | Train Loss: 0.7159 | Train Acc: 0.8384
 Site-MNIST                    | Train Loss: 0.7197 | Train Acc: 0.8327
 Site-USPS                     | Train Loss: 0.6555 | Train Acc: 0.8585
 Site-USPS                     | Train Loss: 0.6246 | Train Acc: 0.8562
 Site-USPS                     | Train Loss: 0.6303 | Train Acc: 0.8520
 Site-SynthDigits              | Train Loss: 1.5991 | Train Acc: 0.4920
 Site-SynthDigits              | Train Loss: 1.5454 | Train Acc: 0.5303
 Site-MNIST-M                  | Train Loss: 1.8308 | Train Acc: 0.4531
 Site-MNIST-M                  | Train Loss: 1.8462 | Train Acc: 0.4314
 Site-SVHN                     | Train Loss: 2.0073 | Train Acc: 0.2998
 Site-MNIST                         | Val  Loss: 0.7138 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.7376 | Val  Acc: 0.8047
 Site-MNIST                         | Val  Loss: 0.6955 | Val  Acc: 0.8498
 Site-MNIST                         | Val  Loss: 0.7375 | Val  Acc: 0.8395
 Site-MNIST                         | Val  Loss: 0.7566 | Val  Acc: 0.8281
 Site-USPS                          | Val  Loss: 0.5985 | Val  Acc: 0.8558
 Site-USPS                          | Val  Loss: 0.6717 | Val  Acc: 0.8109
 Site-USPS                          | Val  Loss: 0.6504 | Val  Acc: 0.8593
 Site-SynthDigits                   | Val  Loss: 1.5344 | Val  Acc: 0.5379
 Site-SynthDigits                   | Val  Loss: 1.5461 | Val  Acc: 0.5126
 Site-MNIST-M                       | Val  Loss: 1.9135 | Val  Acc: 0.4489
 Site-MNIST-M                       | Val  Loss: 1.8611 | Val  Acc: 0.4508
 Site-SVHN                          | Val  Loss: 1.9757 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6910
============ Train epoch 44 ============
denominator: 15061.73828125
 Site-MNIST                    | Train Loss: 0.6169 | Train Acc: 0.8603
 Site-MNIST                    | Train Loss: 0.7128 | Train Acc: 0.8491
 Site-MNIST                    | Train Loss: 0.6608 | Train Acc: 0.8542
 Site-MNIST                    | Train Loss: 0.6848 | Train Acc: 0.8515
 Site-MNIST                    | Train Loss: 0.6907 | Train Acc: 0.8419
 Site-USPS                     | Train Loss: 0.6633 | Train Acc: 0.8585
 Site-USPS                     | Train Loss: 0.6384 | Train Acc: 0.8586
 Site-USPS                     | Train Loss: 0.6397 | Train Acc: 0.8514
 Site-SynthDigits              | Train Loss: 1.5389 | Train Acc: 0.5033
 Site-SynthDigits              | Train Loss: 1.5358 | Train Acc: 0.5347
 Site-MNIST-M                  | Train Loss: 1.8314 | Train Acc: 0.4460
 Site-MNIST-M                  | Train Loss: 1.8310 | Train Acc: 0.4229
 Site-SVHN                     | Train Loss: 2.0082 | Train Acc: 0.2939
 Site-MNIST                         | Val  Loss: 0.6870 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.7020 | Val  Acc: 0.8107
 Site-MNIST                         | Val  Loss: 0.6524 | Val  Acc: 0.8656
 Site-MNIST                         | Val  Loss: 0.7025 | Val  Acc: 0.8526
 Site-MNIST                         | Val  Loss: 0.7262 | Val  Acc: 0.8421
 Site-USPS                          | Val  Loss: 0.6065 | Val  Acc: 0.8606
 Site-USPS                          | Val  Loss: 0.6795 | Val  Acc: 0.8237
 Site-USPS                          | Val  Loss: 0.6586 | Val  Acc: 0.8635
 Site-SynthDigits                   | Val  Loss: 1.5226 | Val  Acc: 0.5568
 Site-SynthDigits                   | Val  Loss: 1.5330 | Val  Acc: 0.5202
 Site-MNIST-M                       | Val  Loss: 1.9168 | Val  Acc: 0.4318
 Site-MNIST-M                       | Val  Loss: 1.8661 | Val  Acc: 0.4432
 Site-SVHN                          | Val  Loss: 1.9747 | Val  Acc: 0.3379
Average Valid Accuracy: 0.6967
============ Train epoch 45 ============
denominator: 14772.353515625
 Site-MNIST                    | Train Loss: 0.6214 | Train Acc: 0.8492
 Site-MNIST                    | Train Loss: 0.7485 | Train Acc: 0.8462
 Site-MNIST                    | Train Loss: 0.6721 | Train Acc: 0.8483
 Site-MNIST                    | Train Loss: 0.6915 | Train Acc: 0.8456
 Site-MNIST                    | Train Loss: 0.6974 | Train Acc: 0.8371
 Site-USPS                     | Train Loss: 0.6713 | Train Acc: 0.8609
 Site-USPS                     | Train Loss: 0.6086 | Train Acc: 0.8626
 Site-USPS                     | Train Loss: 0.6064 | Train Acc: 0.8584
 Site-SynthDigits              | Train Loss: 1.5668 | Train Acc: 0.4834
 Site-SynthDigits              | Train Loss: 1.5350 | Train Acc: 0.5366
 Site-MNIST-M                  | Train Loss: 1.8150 | Train Acc: 0.4602
 Site-MNIST-M                  | Train Loss: 1.7814 | Train Acc: 0.4295
 Site-SVHN                     | Train Loss: 2.0028 | Train Acc: 0.2998
 Site-MNIST                         | Val  Loss: 0.6905 | Val  Acc: 0.8661
 Site-MNIST                         | Val  Loss: 0.7140 | Val  Acc: 0.8047
 Site-MNIST                         | Val  Loss: 0.6700 | Val  Acc: 0.8379
 Site-MNIST                         | Val  Loss: 0.7125 | Val  Acc: 0.8474
 Site-MNIST                         | Val  Loss: 0.7316 | Val  Acc: 0.8368
 Site-USPS                          | Val  Loss: 0.5728 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.6489 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.6252 | Val  Acc: 0.8571
 Site-SynthDigits                   | Val  Loss: 1.5217 | Val  Acc: 0.5341
 Site-SynthDigits                   | Val  Loss: 1.5360 | Val  Acc: 0.5025
 Site-MNIST-M                       | Val  Loss: 1.8969 | Val  Acc: 0.4432
 Site-MNIST-M                       | Val  Loss: 1.8487 | Val  Acc: 0.4697
 Site-SVHN                          | Val  Loss: 1.9733 | Val  Acc: 0.3242
Average Valid Accuracy: 0.6943
============ Train epoch 46 ============
denominator: 14576.3515625
 Site-MNIST                    | Train Loss: 0.6117 | Train Acc: 0.8559
 Site-MNIST                    | Train Loss: 0.7210 | Train Acc: 0.8432
 Site-MNIST                    | Train Loss: 0.6407 | Train Acc: 0.8542
 Site-MNIST                    | Train Loss: 0.6610 | Train Acc: 0.8522
 Site-MNIST                    | Train Loss: 0.6669 | Train Acc: 0.8415
 Site-USPS                     | Train Loss: 0.6764 | Train Acc: 0.8501
 Site-USPS                     | Train Loss: 0.6476 | Train Acc: 0.8498
 Site-USPS                     | Train Loss: 0.6526 | Train Acc: 0.8435
 Site-SynthDigits              | Train Loss: 1.5670 | Train Acc: 0.4891
 Site-SynthDigits              | Train Loss: 1.5430 | Train Acc: 0.5240
 Site-MNIST-M                  | Train Loss: 1.8111 | Train Acc: 0.4460
 Site-MNIST-M                  | Train Loss: 1.8064 | Train Acc: 0.4456
 Site-SVHN                     | Train Loss: 2.0213 | Train Acc: 0.2905
 Site-MNIST                         | Val  Loss: 0.6673 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.6781 | Val  Acc: 0.8166
 Site-MNIST                         | Val  Loss: 0.6284 | Val  Acc: 0.8656
 Site-MNIST                         | Val  Loss: 0.6849 | Val  Acc: 0.8500
 Site-MNIST                         | Val  Loss: 0.7053 | Val  Acc: 0.8404
 Site-USPS                          | Val  Loss: 0.6177 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.6943 | Val  Acc: 0.8205
 Site-USPS                          | Val  Loss: 0.6652 | Val  Acc: 0.8593
 Site-SynthDigits                   | Val  Loss: 1.5228 | Val  Acc: 0.5492
 Site-SynthDigits                   | Val  Loss: 1.5416 | Val  Acc: 0.5051
 Site-MNIST-M                       | Val  Loss: 1.8905 | Val  Acc: 0.4318
 Site-MNIST-M                       | Val  Loss: 1.8546 | Val  Acc: 0.4356
 Site-SVHN                          | Val  Loss: 1.9874 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6914
============ Train epoch 47 ============
denominator: 14780.498046875
 Site-MNIST                    | Train Loss: 0.6127 | Train Acc: 0.8537
 Site-MNIST                    | Train Loss: 0.7109 | Train Acc: 0.8447
 Site-MNIST                    | Train Loss: 0.6431 | Train Acc: 0.8601
 Site-MNIST                    | Train Loss: 0.6663 | Train Acc: 0.8482
 Site-MNIST                    | Train Loss: 0.6752 | Train Acc: 0.8489
 Site-USPS                     | Train Loss: 0.6153 | Train Acc: 0.8705
 Site-USPS                     | Train Loss: 0.5832 | Train Acc: 0.8730
 Site-USPS                     | Train Loss: 0.5830 | Train Acc: 0.8674
 Site-SynthDigits              | Train Loss: 1.5387 | Train Acc: 0.5109
 Site-SynthDigits              | Train Loss: 1.5080 | Train Acc: 0.5454
 Site-MNIST-M                  | Train Loss: 1.8116 | Train Acc: 0.4560
 Site-MNIST-M                  | Train Loss: 1.8096 | Train Acc: 0.4333
 Site-SVHN                     | Train Loss: 1.9905 | Train Acc: 0.2998
 Site-MNIST                         | Val  Loss: 0.6498 | Val  Acc: 0.8661
 Site-MNIST                         | Val  Loss: 0.6786 | Val  Acc: 0.8225
 Site-MNIST                         | Val  Loss: 0.6394 | Val  Acc: 0.8538
 Site-MNIST                         | Val  Loss: 0.6840 | Val  Acc: 0.8474
 Site-MNIST                         | Val  Loss: 0.7046 | Val  Acc: 0.8368
 Site-USPS                          | Val  Loss: 0.5471 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.6247 | Val  Acc: 0.8429
 Site-USPS                          | Val  Loss: 0.6084 | Val  Acc: 0.8742
 Site-SynthDigits                   | Val  Loss: 1.4939 | Val  Acc: 0.5417
 Site-SynthDigits                   | Val  Loss: 1.5018 | Val  Acc: 0.5278
 Site-MNIST-M                       | Val  Loss: 1.9028 | Val  Acc: 0.4318
 Site-MNIST-M                       | Val  Loss: 1.8379 | Val  Acc: 0.4583
 Site-SVHN                          | Val  Loss: 1.9559 | Val  Acc: 0.3379
Average Valid Accuracy: 0.7035
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.8661
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.8225
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.8538
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.8474
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.8368
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:47 | Val Acc: 0.8429
 Best site-USPS                      | Epoch:47 | Val Acc: 0.8742
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5417
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5278
 Best site-MNIST-M                   | Epoch:47 | Val Acc: 0.4318
 Best site-MNIST-M                   | Epoch:47 | Val Acc: 0.4583
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.3379
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 48 ============
denominator: 14520.8916015625
 Site-MNIST                    | Train Loss: 0.5942 | Train Acc: 0.8692
 Site-MNIST                    | Train Loss: 0.6834 | Train Acc: 0.8462
 Site-MNIST                    | Train Loss: 0.6174 | Train Acc: 0.8640
 Site-MNIST                    | Train Loss: 0.6388 | Train Acc: 0.8633
 Site-MNIST                    | Train Loss: 0.6490 | Train Acc: 0.8481
 Site-USPS                     | Train Loss: 0.6243 | Train Acc: 0.8645
 Site-USPS                     | Train Loss: 0.6064 | Train Acc: 0.8658
 Site-USPS                     | Train Loss: 0.6048 | Train Acc: 0.8546
 Site-SynthDigits              | Train Loss: 1.5991 | Train Acc: 0.4910
 Site-SynthDigits              | Train Loss: 1.5337 | Train Acc: 0.5359
 Site-MNIST-M                  | Train Loss: 1.8102 | Train Acc: 0.4517
 Site-MNIST-M                  | Train Loss: 1.8168 | Train Acc: 0.4352
 Site-SVHN                     | Train Loss: 2.0095 | Train Acc: 0.2913
 Site-MNIST                         | Val  Loss: 0.6425 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.6555 | Val  Acc: 0.8343
 Site-MNIST                         | Val  Loss: 0.6063 | Val  Acc: 0.8814
 Site-MNIST                         | Val  Loss: 0.6599 | Val  Acc: 0.8605
 Site-MNIST                         | Val  Loss: 0.6807 | Val  Acc: 0.8439
 Site-USPS                          | Val  Loss: 0.5694 | Val  Acc: 0.8702
 Site-USPS                          | Val  Loss: 0.6472 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 0.6220 | Val  Acc: 0.8699
 Site-SynthDigits                   | Val  Loss: 1.5083 | Val  Acc: 0.5568
 Site-SynthDigits                   | Val  Loss: 1.5258 | Val  Acc: 0.5177
 Site-MNIST-M                       | Val  Loss: 1.8707 | Val  Acc: 0.4432
 Site-MNIST-M                       | Val  Loss: 1.8572 | Val  Acc: 0.4470
 Site-SVHN                          | Val  Loss: 1.9775 | Val  Acc: 0.3140
Average Valid Accuracy: 0.7025
============ Train epoch 49 ============
denominator: 14392.8876953125
 Site-MNIST                    | Train Loss: 0.5824 | Train Acc: 0.8581
 Site-MNIST                    | Train Loss: 0.6734 | Train Acc: 0.8476
 Site-MNIST                    | Train Loss: 0.6266 | Train Acc: 0.8581
 Site-MNIST                    | Train Loss: 0.6457 | Train Acc: 0.8509
 Site-MNIST                    | Train Loss: 0.6530 | Train Acc: 0.8433
 Site-USPS                     | Train Loss: 0.6046 | Train Acc: 0.8621
 Site-USPS                     | Train Loss: 0.5785 | Train Acc: 0.8602
 Site-USPS                     | Train Loss: 0.5865 | Train Acc: 0.8541
 Site-SynthDigits              | Train Loss: 1.5343 | Train Acc: 0.4939
 Site-SynthDigits              | Train Loss: 1.5055 | Train Acc: 0.5378
 Site-MNIST-M                  | Train Loss: 1.7927 | Train Acc: 0.4631
 Site-MNIST-M                  | Train Loss: 1.7860 | Train Acc: 0.4456
 Site-SVHN                     | Train Loss: 1.9919 | Train Acc: 0.3007
 Site-MNIST                         | Val  Loss: 0.6452 | Val  Acc: 0.8661
 Site-MNIST                         | Val  Loss: 0.6653 | Val  Acc: 0.8166
 Site-MNIST                         | Val  Loss: 0.6207 | Val  Acc: 0.8577
 Site-MNIST                         | Val  Loss: 0.6652 | Val  Acc: 0.8579
 Site-MNIST                         | Val  Loss: 0.6873 | Val  Acc: 0.8439
 Site-USPS                          | Val  Loss: 0.5568 | Val  Acc: 0.8702
 Site-USPS                          | Val  Loss: 0.6292 | Val  Acc: 0.8237
 Site-USPS                          | Val  Loss: 0.6048 | Val  Acc: 0.8593
 Site-SynthDigits                   | Val  Loss: 1.4867 | Val  Acc: 0.5303
 Site-SynthDigits                   | Val  Loss: 1.5038 | Val  Acc: 0.5101
 Site-MNIST-M                       | Val  Loss: 1.8799 | Val  Acc: 0.4432
 Site-MNIST-M                       | Val  Loss: 1.8261 | Val  Acc: 0.4697
 Site-SVHN                          | Val  Loss: 1.9617 | Val  Acc: 0.3311
Average Valid Accuracy: 0.6984
===2023-06-04 06:45:41===
===2023-06-04 06:45:51===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[451,676,1015,1522,2284,834,1252,1878,1057,1586,704,1057,1174,
client_nums=[5,3,2,2,1,]
len_dataset=[7438,4958,3305,2203,1468,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:47 | Test Acc: 0.8544
 Test site-USPS                      | Epoch:47 | Test Acc: 0.8667
 Test site-SynthDigits               | Epoch:47 | Test Acc: 0.5267
 Test site-MNIST-M                   | Epoch:47 | Test Acc: 0.4141
 Test site-SVHN                      | Epoch:47 | Test Acc: 0.2914
MNIST: 0.854, USPS: 0.867, SynthDigits: 0.527, MNIST-M: 0.414, SVHN: 0.291, 
Average Test Accuracy: 0.5906, domain std=0.2326, cluster std=-1.0000, individual std=0.2135, 
