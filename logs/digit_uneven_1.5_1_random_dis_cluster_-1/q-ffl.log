===2023-06-04 02:19:13===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[451,676,1015,1522,2284,834,1252,1878,1057,1586,704,1057,1174,
client_nums=[5,3,2,2,1,]
len_dataset=[7438,4958,3305,2203,1468,]
domain number = 5
============ Train epoch 0 ============
denominator: 29580.806640625
 Site-MNIST                    | Train Loss: 2.2086 | Train Acc: 0.3703
 Site-MNIST                    | Train Loss: 2.2206 | Train Acc: 0.3284
 Site-MNIST                    | Train Loss: 2.2181 | Train Acc: 0.3695
 Site-MNIST                    | Train Loss: 2.2195 | Train Acc: 0.3686
 Site-MNIST                    | Train Loss: 2.2212 | Train Acc: 0.3546
 Site-USPS                     | Train Loss: 2.2046 | Train Acc: 0.4472
 Site-USPS                     | Train Loss: 2.2012 | Train Acc: 0.4601
 Site-USPS                     | Train Loss: 2.2046 | Train Acc: 0.4281
 Site-SynthDigits              | Train Loss: 2.2854 | Train Acc: 0.1495
 Site-SynthDigits              | Train Loss: 2.2761 | Train Acc: 0.1772
 Site-MNIST-M                  | Train Loss: 2.2951 | Train Acc: 0.1193
 Site-MNIST-M                  | Train Loss: 2.2952 | Train Acc: 0.1041
 Site-SVHN                     | Train Loss: 2.2894 | Train Acc: 0.1184
 Site-MNIST                         | Val  Loss: 2.2178 | Val  Acc: 0.3214
 Site-MNIST                         | Val  Loss: 2.2218 | Val  Acc: 0.3787
 Site-MNIST                         | Val  Loss: 2.2163 | Val  Acc: 0.3874
 Site-MNIST                         | Val  Loss: 2.2255 | Val  Acc: 0.3211
 Site-MNIST                         | Val  Loss: 2.2225 | Val  Acc: 0.3351
 Site-USPS                          | Val  Loss: 2.1981 | Val  Acc: 0.4663
 Site-USPS                          | Val  Loss: 2.1999 | Val  Acc: 0.4519
 Site-USPS                          | Val  Loss: 2.2033 | Val  Acc: 0.4691
 Site-SynthDigits                   | Val  Loss: 2.2873 | Val  Acc: 0.1553
 Site-SynthDigits                   | Val  Loss: 2.2807 | Val  Acc: 0.1540
 Site-MNIST-M                       | Val  Loss: 2.2951 | Val  Acc: 0.1250
 Site-MNIST-M                       | Val  Loss: 2.2973 | Val  Acc: 0.0871
 Site-SVHN                          | Val  Loss: 2.2871 | Val  Acc: 0.1024
Average Valid Accuracy: 0.2888
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.3214
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.3787
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.3874
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.3211
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.3351
 Best site-USPS                      | Epoch:0 | Val Acc: 0.4663
 Best site-USPS                      | Epoch:0 | Val Acc: 0.4519
 Best site-USPS                      | Epoch:0 | Val Acc: 0.4691
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1553
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1540
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.1250
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.0871
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1024
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 1 ============
denominator: 28899.7421875
 Site-MNIST                    | Train Loss: 2.1243 | Train Acc: 0.5942
 Site-MNIST                    | Train Loss: 2.1492 | Train Acc: 0.4719
 Site-MNIST                    | Train Loss: 2.1380 | Train Acc: 0.5103
 Site-MNIST                    | Train Loss: 2.1407 | Train Acc: 0.5053
 Site-MNIST                    | Train Loss: 2.1434 | Train Acc: 0.4978
 Site-USPS                     | Train Loss: 2.1088 | Train Acc: 0.5612
 Site-USPS                     | Train Loss: 2.0981 | Train Acc: 0.5887
 Site-USPS                     | Train Loss: 2.1063 | Train Acc: 0.5767
 Site-SynthDigits              | Train Loss: 2.2590 | Train Acc: 0.2062
 Site-SynthDigits              | Train Loss: 2.2531 | Train Acc: 0.2560
 Site-MNIST-M                  | Train Loss: 2.2837 | Train Acc: 0.1406
 Site-MNIST-M                  | Train Loss: 2.2911 | Train Acc: 0.1268
 Site-SVHN                     | Train Loss: 2.2810 | Train Acc: 0.1422
 Site-MNIST                         | Val  Loss: 2.1371 | Val  Acc: 0.5357
 Site-MNIST                         | Val  Loss: 2.1457 | Val  Acc: 0.5089
 Site-MNIST                         | Val  Loss: 2.1372 | Val  Acc: 0.5257
 Site-MNIST                         | Val  Loss: 2.1539 | Val  Acc: 0.4711
 Site-MNIST                         | Val  Loss: 2.1489 | Val  Acc: 0.4807
 Site-USPS                          | Val  Loss: 2.0906 | Val  Acc: 0.6010
 Site-USPS                          | Val  Loss: 2.0986 | Val  Acc: 0.5994
 Site-USPS                          | Val  Loss: 2.1074 | Val  Acc: 0.5714
 Site-SynthDigits                   | Val  Loss: 2.2648 | Val  Acc: 0.2273
 Site-SynthDigits                   | Val  Loss: 2.2577 | Val  Acc: 0.2071
 Site-MNIST-M                       | Val  Loss: 2.2868 | Val  Acc: 0.1364
 Site-MNIST-M                       | Val  Loss: 2.2872 | Val  Acc: 0.1061
 Site-SVHN                          | Val  Loss: 2.2777 | Val  Acc: 0.1638
Average Valid Accuracy: 0.3950
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5357
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5089
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5257
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.4711
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.4807
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6010
 Best site-USPS                      | Epoch:1 | Val Acc: 0.5994
 Best site-USPS                      | Epoch:1 | Val Acc: 0.5714
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2273
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2071
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.1364
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.1061
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1638
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 2 ============
denominator: 28218.55859375
 Site-MNIST                    | Train Loss: 2.0356 | Train Acc: 0.6319
 Site-MNIST                    | Train Loss: 2.0763 | Train Acc: 0.5118
 Site-MNIST                    | Train Loss: 2.0557 | Train Acc: 0.5281
 Site-MNIST                    | Train Loss: 2.0605 | Train Acc: 0.5296
 Site-MNIST                    | Train Loss: 2.0637 | Train Acc: 0.5271
 Site-USPS                     | Train Loss: 2.0107 | Train Acc: 0.6007
 Site-USPS                     | Train Loss: 2.0058 | Train Acc: 0.6222
 Site-USPS                     | Train Loss: 2.0137 | Train Acc: 0.6092
 Site-SynthDigits              | Train Loss: 2.2355 | Train Acc: 0.2431
 Site-SynthDigits              | Train Loss: 2.2288 | Train Acc: 0.2907
 Site-MNIST-M                  | Train Loss: 2.2717 | Train Acc: 0.1605
 Site-MNIST-M                  | Train Loss: 2.2693 | Train Acc: 0.1504
 Site-SVHN                     | Train Loss: 2.2718 | Train Acc: 0.1695
 Site-MNIST                         | Val  Loss: 2.0585 | Val  Acc: 0.5536
 Site-MNIST                         | Val  Loss: 2.0678 | Val  Acc: 0.5148
 Site-MNIST                         | Val  Loss: 2.0564 | Val  Acc: 0.5217
 Site-MNIST                         | Val  Loss: 2.0797 | Val  Acc: 0.4921
 Site-MNIST                         | Val  Loss: 2.0738 | Val  Acc: 0.5175
 Site-USPS                          | Val  Loss: 1.9901 | Val  Acc: 0.6635
 Site-USPS                          | Val  Loss: 2.0052 | Val  Acc: 0.6410
 Site-USPS                          | Val  Loss: 2.0177 | Val  Acc: 0.6119
 Site-SynthDigits                   | Val  Loss: 2.2410 | Val  Acc: 0.2500
 Site-SynthDigits                   | Val  Loss: 2.2337 | Val  Acc: 0.2551
 Site-MNIST-M                       | Val  Loss: 2.2776 | Val  Acc: 0.1477
 Site-MNIST-M                       | Val  Loss: 2.2768 | Val  Acc: 0.1477
 Site-SVHN                          | Val  Loss: 2.2686 | Val  Acc: 0.1843
Average Valid Accuracy: 0.4232
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5536
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5148
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5217
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.4921
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5175
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6635
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6410
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6119
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2500
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2551
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.1477
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.1477
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.1843
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 3 ============
denominator: 27509.4609375
 Site-MNIST                    | Train Loss: 1.9524 | Train Acc: 0.6275
 Site-MNIST                    | Train Loss: 2.0007 | Train Acc: 0.5237
 Site-MNIST                    | Train Loss: 1.9760 | Train Acc: 0.5379
 Site-MNIST                    | Train Loss: 1.9819 | Train Acc: 0.5473
 Site-MNIST                    | Train Loss: 1.9864 | Train Acc: 0.5420
 Site-USPS                     | Train Loss: 1.9260 | Train Acc: 0.6199
 Site-USPS                     | Train Loss: 1.9173 | Train Acc: 0.6286
 Site-USPS                     | Train Loss: 1.9241 | Train Acc: 0.6246
 Site-SynthDigits              | Train Loss: 2.2055 | Train Acc: 0.2725
 Site-SynthDigits              | Train Loss: 2.2041 | Train Acc: 0.3140
 Site-MNIST-M                  | Train Loss: 2.2587 | Train Acc: 0.1903
 Site-MNIST-M                  | Train Loss: 2.2646 | Train Acc: 0.1779
 Site-SVHN                     | Train Loss: 2.2635 | Train Acc: 0.1925
 Site-MNIST                         | Val  Loss: 1.9789 | Val  Acc: 0.5625
 Site-MNIST                         | Val  Loss: 1.9918 | Val  Acc: 0.5030
 Site-MNIST                         | Val  Loss: 1.9781 | Val  Acc: 0.5336
 Site-MNIST                         | Val  Loss: 2.0065 | Val  Acc: 0.5053
 Site-MNIST                         | Val  Loss: 1.9992 | Val  Acc: 0.5298
 Site-USPS                          | Val  Loss: 1.8933 | Val  Acc: 0.6923
 Site-USPS                          | Val  Loss: 1.9143 | Val  Acc: 0.6538
 Site-USPS                          | Val  Loss: 1.9307 | Val  Acc: 0.6247
 Site-SynthDigits                   | Val  Loss: 2.2163 | Val  Acc: 0.2841
 Site-SynthDigits                   | Val  Loss: 2.2088 | Val  Acc: 0.2980
 Site-MNIST-M                       | Val  Loss: 2.2674 | Val  Acc: 0.1705
 Site-MNIST-M                       | Val  Loss: 2.2661 | Val  Acc: 0.1780
 Site-SVHN                          | Val  Loss: 2.2595 | Val  Acc: 0.2116
Average Valid Accuracy: 0.4421
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5625
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5030
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5336
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5053
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5298
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6923
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6538
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6247
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2841
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2980
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.1705
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.1780
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2116
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 4 ============
denominator: 26910.0390625
 Site-MNIST                    | Train Loss: 1.8507 | Train Acc: 0.6430
 Site-MNIST                    | Train Loss: 1.9329 | Train Acc: 0.5533
 Site-MNIST                    | Train Loss: 1.9011 | Train Acc: 0.5675
 Site-MNIST                    | Train Loss: 1.9064 | Train Acc: 0.5808
 Site-MNIST                    | Train Loss: 1.9145 | Train Acc: 0.5670
 Site-USPS                     | Train Loss: 1.8495 | Train Acc: 0.6367
 Site-USPS                     | Train Loss: 1.8270 | Train Acc: 0.6565
 Site-USPS                     | Train Loss: 1.8373 | Train Acc: 0.6496
 Site-SynthDigits              | Train Loss: 2.1924 | Train Acc: 0.3027
 Site-SynthDigits              | Train Loss: 2.1788 | Train Acc: 0.3310
 Site-MNIST-M                  | Train Loss: 2.2461 | Train Acc: 0.2188
 Site-MNIST-M                  | Train Loss: 2.2517 | Train Acc: 0.1996
 Site-SVHN                     | Train Loss: 2.2559 | Train Acc: 0.2147
 Site-MNIST                         | Val  Loss: 1.9072 | Val  Acc: 0.5804
 Site-MNIST                         | Val  Loss: 1.9203 | Val  Acc: 0.5325
 Site-MNIST                         | Val  Loss: 1.9035 | Val  Acc: 0.5652
 Site-MNIST                         | Val  Loss: 1.9367 | Val  Acc: 0.5184
 Site-MNIST                         | Val  Loss: 1.9291 | Val  Acc: 0.5509
 Site-USPS                          | Val  Loss: 1.8015 | Val  Acc: 0.6971
 Site-USPS                          | Val  Loss: 1.8277 | Val  Acc: 0.6731
 Site-USPS                          | Val  Loss: 1.8457 | Val  Acc: 0.6525
 Site-SynthDigits                   | Val  Loss: 2.1917 | Val  Acc: 0.3220
 Site-SynthDigits                   | Val  Loss: 2.1841 | Val  Acc: 0.3283
 Site-MNIST-M                       | Val  Loss: 2.2562 | Val  Acc: 0.2045
 Site-MNIST-M                       | Val  Loss: 2.2552 | Val  Acc: 0.2083
 Site-SVHN                          | Val  Loss: 2.2516 | Val  Acc: 0.2457
Average Valid Accuracy: 0.4676
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5804
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5325
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5652
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5184
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5509
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6971
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6731
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6525
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3220
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3283
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.2045
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.2083
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2457
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 5 ============
denominator: 26228.634765625
 Site-MNIST                    | Train Loss: 1.8062 | Train Acc: 0.6630
 Site-MNIST                    | Train Loss: 1.8642 | Train Acc: 0.5873
 Site-MNIST                    | Train Loss: 1.8281 | Train Acc: 0.5842
 Site-MNIST                    | Train Loss: 1.8331 | Train Acc: 0.6038
 Site-MNIST                    | Train Loss: 1.8402 | Train Acc: 0.5989
 Site-USPS                     | Train Loss: 1.7526 | Train Acc: 0.6427
 Site-USPS                     | Train Loss: 1.7332 | Train Acc: 0.6789
 Site-USPS                     | Train Loss: 1.7502 | Train Acc: 0.6683
 Site-SynthDigits              | Train Loss: 2.1503 | Train Acc: 0.3179
 Site-SynthDigits              | Train Loss: 2.1552 | Train Acc: 0.3398
 Site-MNIST-M                  | Train Loss: 2.2350 | Train Acc: 0.2344
 Site-MNIST-M                  | Train Loss: 2.2466 | Train Acc: 0.2138
 Site-SVHN                     | Train Loss: 2.2481 | Train Acc: 0.2198
 Site-MNIST                         | Val  Loss: 1.8386 | Val  Acc: 0.5804
 Site-MNIST                         | Val  Loss: 1.8506 | Val  Acc: 0.5444
 Site-MNIST                         | Val  Loss: 1.8295 | Val  Acc: 0.5929
 Site-MNIST                         | Val  Loss: 1.8673 | Val  Acc: 0.5526
 Site-MNIST                         | Val  Loss: 1.8593 | Val  Acc: 0.5877
 Site-USPS                          | Val  Loss: 1.7122 | Val  Acc: 0.7019
 Site-USPS                          | Val  Loss: 1.7427 | Val  Acc: 0.6859
 Site-USPS                          | Val  Loss: 1.7621 | Val  Acc: 0.6652
 Site-SynthDigits                   | Val  Loss: 2.1687 | Val  Acc: 0.3485
 Site-SynthDigits                   | Val  Loss: 2.1608 | Val  Acc: 0.3586
 Site-MNIST-M                       | Val  Loss: 2.2473 | Val  Acc: 0.2216
 Site-MNIST-M                       | Val  Loss: 2.2465 | Val  Acc: 0.2197
 Site-SVHN                          | Val  Loss: 2.2431 | Val  Acc: 0.2594
Average Valid Accuracy: 0.4861
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5804
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5444
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5929
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5526
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5877
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7019
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6859
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6652
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3485
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3586
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.2216
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.2197
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2594
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 6 ============
denominator: 25675.53515625
 Site-MNIST                    | Train Loss: 1.7426 | Train Acc: 0.6918
 Site-MNIST                    | Train Loss: 1.8052 | Train Acc: 0.6080
 Site-MNIST                    | Train Loss: 1.7604 | Train Acc: 0.6217
 Site-MNIST                    | Train Loss: 1.7673 | Train Acc: 0.6314
 Site-MNIST                    | Train Loss: 1.7764 | Train Acc: 0.6309
 Site-USPS                     | Train Loss: 1.6801 | Train Acc: 0.6763
 Site-USPS                     | Train Loss: 1.6514 | Train Acc: 0.7013
 Site-USPS                     | Train Loss: 1.6634 | Train Acc: 0.7023
 Site-SynthDigits              | Train Loss: 2.1569 | Train Acc: 0.3311
 Site-SynthDigits              | Train Loss: 2.1341 | Train Acc: 0.3487
 Site-MNIST-M                  | Train Loss: 2.2244 | Train Acc: 0.2415
 Site-MNIST-M                  | Train Loss: 2.2244 | Train Acc: 0.2223
 Site-SVHN                     | Train Loss: 2.2412 | Train Acc: 0.2266
 Site-MNIST                         | Val  Loss: 1.7799 | Val  Acc: 0.6161
 Site-MNIST                         | Val  Loss: 1.7874 | Val  Acc: 0.5621
 Site-MNIST                         | Val  Loss: 1.7618 | Val  Acc: 0.6126
 Site-MNIST                         | Val  Loss: 1.8042 | Val  Acc: 0.5816
 Site-MNIST                         | Val  Loss: 1.7960 | Val  Acc: 0.6088
 Site-USPS                          | Val  Loss: 1.6218 | Val  Acc: 0.7212
 Site-USPS                          | Val  Loss: 1.6573 | Val  Acc: 0.7019
 Site-USPS                          | Val  Loss: 1.6780 | Val  Acc: 0.6994
 Site-SynthDigits                   | Val  Loss: 2.1473 | Val  Acc: 0.3598
 Site-SynthDigits                   | Val  Loss: 2.1386 | Val  Acc: 0.3662
 Site-MNIST-M                       | Val  Loss: 2.2379 | Val  Acc: 0.2216
 Site-MNIST-M                       | Val  Loss: 2.2369 | Val  Acc: 0.2273
 Site-SVHN                          | Val  Loss: 2.2353 | Val  Acc: 0.2628
Average Valid Accuracy: 0.5032
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6161
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.5621
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6126
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.5816
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6088
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7212
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7019
 Best site-USPS                      | Epoch:6 | Val Acc: 0.6994
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3598
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3662
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.2216
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.2273
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2628
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 7 ============
denominator: 25090.236328125
 Site-MNIST                    | Train Loss: 1.6393 | Train Acc: 0.7029
 Site-MNIST                    | Train Loss: 1.7284 | Train Acc: 0.6169
 Site-MNIST                    | Train Loss: 1.6918 | Train Acc: 0.6296
 Site-MNIST                    | Train Loss: 1.6993 | Train Acc: 0.6406
 Site-MNIST                    | Train Loss: 1.7082 | Train Acc: 0.6414
 Site-USPS                     | Train Loss: 1.5779 | Train Acc: 0.6763
 Site-USPS                     | Train Loss: 1.5951 | Train Acc: 0.7117
 Site-USPS                     | Train Loss: 1.5972 | Train Acc: 0.7077
 Site-SynthDigits              | Train Loss: 2.1219 | Train Acc: 0.3330
 Site-SynthDigits              | Train Loss: 2.1111 | Train Acc: 0.3562
 Site-MNIST-M                  | Train Loss: 2.2132 | Train Acc: 0.2628
 Site-MNIST-M                  | Train Loss: 2.2177 | Train Acc: 0.2252
 Site-SVHN                     | Train Loss: 2.2348 | Train Acc: 0.2317
 Site-MNIST                         | Val  Loss: 1.7106 | Val  Acc: 0.6161
 Site-MNIST                         | Val  Loss: 1.7209 | Val  Acc: 0.5740
 Site-MNIST                         | Val  Loss: 1.6944 | Val  Acc: 0.6285
 Site-MNIST                         | Val  Loss: 1.7401 | Val  Acc: 0.5895
 Site-MNIST                         | Val  Loss: 1.7314 | Val  Acc: 0.6158
 Site-USPS                          | Val  Loss: 1.5537 | Val  Acc: 0.7212
 Site-USPS                          | Val  Loss: 1.5912 | Val  Acc: 0.6955
 Site-USPS                          | Val  Loss: 1.6123 | Val  Acc: 0.6994
 Site-SynthDigits                   | Val  Loss: 2.1234 | Val  Acc: 0.3485
 Site-SynthDigits                   | Val  Loss: 2.1152 | Val  Acc: 0.3687
 Site-MNIST-M                       | Val  Loss: 2.2272 | Val  Acc: 0.2330
 Site-MNIST-M                       | Val  Loss: 2.2272 | Val  Acc: 0.2538
 Site-SVHN                          | Val  Loss: 2.2287 | Val  Acc: 0.2765
Average Valid Accuracy: 0.5092
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6161
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.5740
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6285
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.5895
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6158
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7212
 Best site-USPS                      | Epoch:7 | Val Acc: 0.6955
 Best site-USPS                      | Epoch:7 | Val Acc: 0.6994
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3485
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3687
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.2330
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.2538
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2765
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 8 ============
denominator: 24454.4765625
 Site-MNIST                    | Train Loss: 1.6002 | Train Acc: 0.7317
 Site-MNIST                    | Train Loss: 1.6789 | Train Acc: 0.6450
 Site-MNIST                    | Train Loss: 1.6296 | Train Acc: 0.6650
 Site-MNIST                    | Train Loss: 1.6353 | Train Acc: 0.6577
 Site-MNIST                    | Train Loss: 1.6443 | Train Acc: 0.6703
 Site-USPS                     | Train Loss: 1.5352 | Train Acc: 0.6894
 Site-USPS                     | Train Loss: 1.5154 | Train Acc: 0.7300
 Site-USPS                     | Train Loss: 1.5248 | Train Acc: 0.7284
 Site-SynthDigits              | Train Loss: 2.1083 | Train Acc: 0.3434
 Site-SynthDigits              | Train Loss: 2.0883 | Train Acc: 0.3556
 Site-MNIST-M                  | Train Loss: 2.2030 | Train Acc: 0.2670
 Site-MNIST-M                  | Train Loss: 2.2045 | Train Acc: 0.2375
 Site-SVHN                     | Train Loss: 2.2286 | Train Acc: 0.2428
 Site-MNIST                         | Val  Loss: 1.6522 | Val  Acc: 0.6339
 Site-MNIST                         | Val  Loss: 1.6614 | Val  Acc: 0.6213
 Site-MNIST                         | Val  Loss: 1.6304 | Val  Acc: 0.6522
 Site-MNIST                         | Val  Loss: 1.6799 | Val  Acc: 0.6132
 Site-MNIST                         | Val  Loss: 1.6716 | Val  Acc: 0.6491
 Site-USPS                          | Val  Loss: 1.4794 | Val  Acc: 0.7356
 Site-USPS                          | Val  Loss: 1.5209 | Val  Acc: 0.7179
 Site-USPS                          | Val  Loss: 1.5428 | Val  Acc: 0.7207
 Site-SynthDigits                   | Val  Loss: 2.1018 | Val  Acc: 0.3636
 Site-SynthDigits                   | Val  Loss: 2.0928 | Val  Acc: 0.3788
 Site-MNIST-M                       | Val  Loss: 2.2180 | Val  Acc: 0.2386
 Site-MNIST-M                       | Val  Loss: 2.2176 | Val  Acc: 0.2652
 Site-SVHN                          | Val  Loss: 2.2207 | Val  Acc: 0.2935
Average Valid Accuracy: 0.5295
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6339
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6213
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6522
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6132
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6491
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7356
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7179
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7207
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3636
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3788
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.2386
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.2652
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2935
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 9 ============
denominator: 23977.126953125
 Site-MNIST                    | Train Loss: 1.5142 | Train Acc: 0.7539
 Site-MNIST                    | Train Loss: 1.6281 | Train Acc: 0.6642
 Site-MNIST                    | Train Loss: 1.5740 | Train Acc: 0.6906
 Site-MNIST                    | Train Loss: 1.5824 | Train Acc: 0.6702
 Site-MNIST                    | Train Loss: 1.5896 | Train Acc: 0.6909
 Site-USPS                     | Train Loss: 1.4800 | Train Acc: 0.6942
 Site-USPS                     | Train Loss: 1.4588 | Train Acc: 0.7324
 Site-USPS                     | Train Loss: 1.4652 | Train Acc: 0.7370
 Site-SynthDigits              | Train Loss: 2.0694 | Train Acc: 0.3491
 Site-SynthDigits              | Train Loss: 2.0640 | Train Acc: 0.3682
 Site-MNIST-M                  | Train Loss: 2.1931 | Train Acc: 0.2770
 Site-MNIST-M                  | Train Loss: 2.1969 | Train Acc: 0.2498
 Site-SVHN                     | Train Loss: 2.2213 | Train Acc: 0.2470
 Site-MNIST                         | Val  Loss: 1.6009 | Val  Acc: 0.6429
 Site-MNIST                         | Val  Loss: 1.6087 | Val  Acc: 0.6509
 Site-MNIST                         | Val  Loss: 1.5730 | Val  Acc: 0.6838
 Site-MNIST                         | Val  Loss: 1.6256 | Val  Acc: 0.6421
 Site-MNIST                         | Val  Loss: 1.6192 | Val  Acc: 0.6702
 Site-USPS                          | Val  Loss: 1.4186 | Val  Acc: 0.7260
 Site-USPS                          | Val  Loss: 1.4619 | Val  Acc: 0.7019
 Site-USPS                          | Val  Loss: 1.4843 | Val  Acc: 0.7143
 Site-SynthDigits                   | Val  Loss: 2.0796 | Val  Acc: 0.3674
 Site-SynthDigits                   | Val  Loss: 2.0700 | Val  Acc: 0.3864
 Site-MNIST-M                       | Val  Loss: 2.2071 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.2084 | Val  Acc: 0.2689
 Site-SVHN                          | Val  Loss: 2.2126 | Val  Acc: 0.2969
Average Valid Accuracy: 0.5386
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6429
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6509
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6838
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6421
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6702
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7260
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7019
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7143
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3674
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3864
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.2689
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2969
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
 Test site-MNIST                     | Epoch:9 | Test Acc: 0.6796
 Test site-USPS                      | Epoch:9 | Test Acc: 0.7263
 Test site-SynthDigits               | Epoch:9 | Test Acc: 0.3405
 Test site-MNIST-M                   | Epoch:9 | Test Acc: 0.2460
 Test site-SVHN                      | Epoch:9 | Test Acc: 0.2256
MNIST: 0.680, USPS: 0.726, SynthDigits: 0.341, MNIST-M: 0.246, SVHN: 0.226, 
Average Test Accuracy: 0.4436, domain std=0.2158, cluster std=-1.0000, individual std=0.2062, 
============ Train epoch 10 ============
denominator: 23418.658203125
 Site-MNIST                    | Train Loss: 1.4615 | Train Acc: 0.7672
 Site-MNIST                    | Train Loss: 1.5679 | Train Acc: 0.6657
 Site-MNIST                    | Train Loss: 1.5166 | Train Acc: 0.7044
 Site-MNIST                    | Train Loss: 1.5240 | Train Acc: 0.6846
 Site-MNIST                    | Train Loss: 1.5334 | Train Acc: 0.7084
 Site-USPS                     | Train Loss: 1.4179 | Train Acc: 0.7122
 Site-USPS                     | Train Loss: 1.4000 | Train Acc: 0.7564
 Site-USPS                     | Train Loss: 1.4068 | Train Acc: 0.7513
 Site-SynthDigits              | Train Loss: 2.0634 | Train Acc: 0.3510
 Site-SynthDigits              | Train Loss: 2.0469 | Train Acc: 0.3783
 Site-MNIST-M                  | Train Loss: 2.1835 | Train Acc: 0.2869
 Site-MNIST-M                  | Train Loss: 2.1878 | Train Acc: 0.2583
 Site-SVHN                     | Train Loss: 2.2152 | Train Acc: 0.2479
 Site-MNIST                         | Val  Loss: 1.5429 | Val  Acc: 0.6429
 Site-MNIST                         | Val  Loss: 1.5511 | Val  Acc: 0.6627
 Site-MNIST                         | Val  Loss: 1.5159 | Val  Acc: 0.7115
 Site-MNIST                         | Val  Loss: 1.5707 | Val  Acc: 0.6500
 Site-MNIST                         | Val  Loss: 1.5640 | Val  Acc: 0.6719
 Site-USPS                          | Val  Loss: 1.3573 | Val  Acc: 0.7452
 Site-USPS                          | Val  Loss: 1.4034 | Val  Acc: 0.7308
 Site-USPS                          | Val  Loss: 1.4252 | Val  Acc: 0.7377
 Site-SynthDigits                   | Val  Loss: 2.0600 | Val  Acc: 0.3712
 Site-SynthDigits                   | Val  Loss: 2.0501 | Val  Acc: 0.3813
 Site-MNIST-M                       | Val  Loss: 2.1977 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.2002 | Val  Acc: 0.2765
 Site-SVHN                          | Val  Loss: 2.2054 | Val  Acc: 0.2969
Average Valid Accuracy: 0.5484
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6429
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6627
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7115
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6500
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6719
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7452
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7308
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7377
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3712
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3813
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.2765
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2969
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 11 ============
denominator: 22956.859375
 Site-MNIST                    | Train Loss: 1.4280 | Train Acc: 0.7783
 Site-MNIST                    | Train Loss: 1.5107 | Train Acc: 0.6879
 Site-MNIST                    | Train Loss: 1.4667 | Train Acc: 0.7172
 Site-MNIST                    | Train Loss: 1.4772 | Train Acc: 0.6984
 Site-MNIST                    | Train Loss: 1.4844 | Train Acc: 0.7215
 Site-USPS                     | Train Loss: 1.3325 | Train Acc: 0.7254
 Site-USPS                     | Train Loss: 1.3363 | Train Acc: 0.7676
 Site-USPS                     | Train Loss: 1.3439 | Train Acc: 0.7630
 Site-SynthDigits              | Train Loss: 2.0423 | Train Acc: 0.3491
 Site-SynthDigits              | Train Loss: 2.0269 | Train Acc: 0.3733
 Site-MNIST-M                  | Train Loss: 2.1731 | Train Acc: 0.2884
 Site-MNIST-M                  | Train Loss: 2.1783 | Train Acc: 0.2630
 Site-SVHN                     | Train Loss: 2.2086 | Train Acc: 0.2538
 Site-MNIST                         | Val  Loss: 1.4990 | Val  Acc: 0.6518
 Site-MNIST                         | Val  Loss: 1.5031 | Val  Acc: 0.6805
 Site-MNIST                         | Val  Loss: 1.4662 | Val  Acc: 0.7233
 Site-MNIST                         | Val  Loss: 1.5229 | Val  Acc: 0.6658
 Site-MNIST                         | Val  Loss: 1.5175 | Val  Acc: 0.6930
 Site-USPS                          | Val  Loss: 1.2938 | Val  Acc: 0.7788
 Site-USPS                          | Val  Loss: 1.3437 | Val  Acc: 0.7468
 Site-USPS                          | Val  Loss: 1.3646 | Val  Acc: 0.7463
 Site-SynthDigits                   | Val  Loss: 2.0370 | Val  Acc: 0.3750
 Site-SynthDigits                   | Val  Loss: 2.0286 | Val  Acc: 0.3813
 Site-MNIST-M                       | Val  Loss: 2.1892 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1907 | Val  Acc: 0.2803
 Site-SVHN                          | Val  Loss: 2.1976 | Val  Acc: 0.3003
Average Valid Accuracy: 0.5595
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6518
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6805
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7233
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6658
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6930
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7788
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7468
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7463
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3750
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3813
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.2803
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3003
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 12 ============
denominator: 22537.953125
 Site-MNIST                    | Train Loss: 1.3805 | Train Acc: 0.7916
 Site-MNIST                    | Train Loss: 1.4784 | Train Acc: 0.6997
 Site-MNIST                    | Train Loss: 1.4247 | Train Acc: 0.7389
 Site-MNIST                    | Train Loss: 1.4374 | Train Acc: 0.7135
 Site-MNIST                    | Train Loss: 1.4440 | Train Acc: 0.7404
 Site-USPS                     | Train Loss: 1.2685 | Train Acc: 0.7614
 Site-USPS                     | Train Loss: 1.2746 | Train Acc: 0.7947
 Site-USPS                     | Train Loss: 1.2794 | Train Acc: 0.7875
 Site-SynthDigits              | Train Loss: 2.0222 | Train Acc: 0.3642
 Site-SynthDigits              | Train Loss: 2.0063 | Train Acc: 0.3834
 Site-MNIST-M                  | Train Loss: 2.1631 | Train Acc: 0.2983
 Site-MNIST-M                  | Train Loss: 2.1585 | Train Acc: 0.2744
 Site-SVHN                     | Train Loss: 2.2027 | Train Acc: 0.2581
 Site-MNIST                         | Val  Loss: 1.4648 | Val  Acc: 0.6875
 Site-MNIST                         | Val  Loss: 1.4647 | Val  Acc: 0.7041
 Site-MNIST                         | Val  Loss: 1.4219 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.4795 | Val  Acc: 0.6895
 Site-MNIST                         | Val  Loss: 1.4770 | Val  Acc: 0.7035
 Site-USPS                          | Val  Loss: 1.2312 | Val  Acc: 0.7981
 Site-USPS                          | Val  Loss: 1.2856 | Val  Acc: 0.7692
 Site-USPS                          | Val  Loss: 1.3042 | Val  Acc: 0.7655
 Site-SynthDigits                   | Val  Loss: 2.0167 | Val  Acc: 0.3826
 Site-SynthDigits                   | Val  Loss: 2.0087 | Val  Acc: 0.3889
 Site-MNIST-M                       | Val  Loss: 2.1802 | Val  Acc: 0.2670
 Site-MNIST-M                       | Val  Loss: 2.1818 | Val  Acc: 0.2879
 Site-SVHN                          | Val  Loss: 2.1902 | Val  Acc: 0.2969
Average Valid Accuracy: 0.5754
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.6875
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7041
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.6895
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7035
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7981
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7692
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7655
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.3826
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.3889
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.2670
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.2879
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2969
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 13 ============
denominator: 22086.078125
 Site-MNIST                    | Train Loss: 1.3142 | Train Acc: 0.7960
 Site-MNIST                    | Train Loss: 1.4418 | Train Acc: 0.6997
 Site-MNIST                    | Train Loss: 1.3732 | Train Acc: 0.7438
 Site-MNIST                    | Train Loss: 1.3836 | Train Acc: 0.7293
 Site-MNIST                    | Train Loss: 1.3897 | Train Acc: 0.7491
 Site-USPS                     | Train Loss: 1.2740 | Train Acc: 0.7662
 Site-USPS                     | Train Loss: 1.2239 | Train Acc: 0.7971
 Site-USPS                     | Train Loss: 1.2359 | Train Acc: 0.7907
 Site-SynthDigits              | Train Loss: 2.0065 | Train Acc: 0.3775
 Site-SynthDigits              | Train Loss: 1.9875 | Train Acc: 0.3985
 Site-MNIST-M                  | Train Loss: 2.1540 | Train Acc: 0.3111
 Site-MNIST-M                  | Train Loss: 2.1504 | Train Acc: 0.2810
 Site-SVHN                     | Train Loss: 2.1968 | Train Acc: 0.2581
 Site-MNIST                         | Val  Loss: 1.4111 | Val  Acc: 0.6964
 Site-MNIST                         | Val  Loss: 1.4147 | Val  Acc: 0.7041
 Site-MNIST                         | Val  Loss: 1.3701 | Val  Acc: 0.7431
 Site-MNIST                         | Val  Loss: 1.4286 | Val  Acc: 0.6974
 Site-MNIST                         | Val  Loss: 1.4259 | Val  Acc: 0.7035
 Site-USPS                          | Val  Loss: 1.1874 | Val  Acc: 0.7933
 Site-USPS                          | Val  Loss: 1.2428 | Val  Acc: 0.7692
 Site-USPS                          | Val  Loss: 1.2607 | Val  Acc: 0.7761
 Site-SynthDigits                   | Val  Loss: 1.9976 | Val  Acc: 0.4015
 Site-SynthDigits                   | Val  Loss: 1.9896 | Val  Acc: 0.4116
 Site-MNIST-M                       | Val  Loss: 2.1725 | Val  Acc: 0.2784
 Site-MNIST-M                       | Val  Loss: 2.1732 | Val  Acc: 0.2992
 Site-SVHN                          | Val  Loss: 2.1834 | Val  Acc: 0.3003
Average Valid Accuracy: 0.5826
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.6964
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7041
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7431
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.6974
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7035
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7933
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7692
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7761
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4015
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4116
 Best site-MNIST-M                   | Epoch:13 | Val Acc: 0.2784
 Best site-MNIST-M                   | Epoch:13 | Val Acc: 0.2992
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3003
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 14 ============
denominator: 21720.091796875
 Site-MNIST                    | Train Loss: 1.2882 | Train Acc: 0.8004
 Site-MNIST                    | Train Loss: 1.4057 | Train Acc: 0.7130
 Site-MNIST                    | Train Loss: 1.3446 | Train Acc: 0.7507
 Site-MNIST                    | Train Loss: 1.3562 | Train Acc: 0.7247
 Site-MNIST                    | Train Loss: 1.3628 | Train Acc: 0.7417
 Site-USPS                     | Train Loss: 1.2282 | Train Acc: 0.7578
 Site-USPS                     | Train Loss: 1.1991 | Train Acc: 0.7907
 Site-USPS                     | Train Loss: 1.2085 | Train Acc: 0.7833
 Site-SynthDigits              | Train Loss: 1.9872 | Train Acc: 0.3917
 Site-SynthDigits              | Train Loss: 1.9634 | Train Acc: 0.4079
 Site-MNIST-M                  | Train Loss: 2.1428 | Train Acc: 0.3068
 Site-MNIST-M                  | Train Loss: 2.1382 | Train Acc: 0.2791
 Site-SVHN                     | Train Loss: 2.1888 | Train Acc: 0.2641
 Site-MNIST                         | Val  Loss: 1.3875 | Val  Acc: 0.7054
 Site-MNIST                         | Val  Loss: 1.3891 | Val  Acc: 0.7041
 Site-MNIST                         | Val  Loss: 1.3406 | Val  Acc: 0.7549
 Site-MNIST                         | Val  Loss: 1.3992 | Val  Acc: 0.7184
 Site-MNIST                         | Val  Loss: 1.4033 | Val  Acc: 0.7123
 Site-USPS                          | Val  Loss: 1.1642 | Val  Acc: 0.7933
 Site-USPS                          | Val  Loss: 1.2160 | Val  Acc: 0.7756
 Site-USPS                          | Val  Loss: 1.2340 | Val  Acc: 0.7825
 Site-SynthDigits                   | Val  Loss: 1.9726 | Val  Acc: 0.4242
 Site-SynthDigits                   | Val  Loss: 1.9654 | Val  Acc: 0.4242
 Site-MNIST-M                       | Val  Loss: 2.1632 | Val  Acc: 0.2727
 Site-MNIST-M                       | Val  Loss: 2.1594 | Val  Acc: 0.3030
 Site-SVHN                          | Val  Loss: 2.1752 | Val  Acc: 0.3140
Average Valid Accuracy: 0.5911
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7054
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7041
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7549
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7184
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7123
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7933
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7756
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7825
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.4242
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.4242
 Best site-MNIST-M                   | Epoch:14 | Val Acc: 0.2727
 Best site-MNIST-M                   | Epoch:14 | Val Acc: 0.3030
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3140
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 15 ============
denominator: 21305.3984375
 Site-MNIST                    | Train Loss: 1.2340 | Train Acc: 0.8027
 Site-MNIST                    | Train Loss: 1.3509 | Train Acc: 0.7219
 Site-MNIST                    | Train Loss: 1.2919 | Train Acc: 0.7596
 Site-MNIST                    | Train Loss: 1.3067 | Train Acc: 0.7510
 Site-MNIST                    | Train Loss: 1.3118 | Train Acc: 0.7531
 Site-USPS                     | Train Loss: 1.1574 | Train Acc: 0.7794
 Site-USPS                     | Train Loss: 1.1529 | Train Acc: 0.8099
 Site-USPS                     | Train Loss: 1.1552 | Train Acc: 0.7977
 Site-SynthDigits              | Train Loss: 1.9546 | Train Acc: 0.3917
 Site-SynthDigits              | Train Loss: 1.9471 | Train Acc: 0.4155
 Site-MNIST-M                  | Train Loss: 2.1316 | Train Acc: 0.3097
 Site-MNIST-M                  | Train Loss: 2.1419 | Train Acc: 0.2933
 Site-SVHN                     | Train Loss: 2.1834 | Train Acc: 0.2632
 Site-MNIST                         | Val  Loss: 1.3376 | Val  Acc: 0.7232
 Site-MNIST                         | Val  Loss: 1.3393 | Val  Acc: 0.7219
 Site-MNIST                         | Val  Loss: 1.2889 | Val  Acc: 0.7628
 Site-MNIST                         | Val  Loss: 1.3504 | Val  Acc: 0.7211
 Site-MNIST                         | Val  Loss: 1.3521 | Val  Acc: 0.7246
 Site-USPS                          | Val  Loss: 1.1070 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 1.1656 | Val  Acc: 0.7788
 Site-USPS                          | Val  Loss: 1.1810 | Val  Acc: 0.7932
 Site-SynthDigits                   | Val  Loss: 1.9556 | Val  Acc: 0.4205
 Site-SynthDigits                   | Val  Loss: 1.9487 | Val  Acc: 0.4318
 Site-MNIST-M                       | Val  Loss: 2.1541 | Val  Acc: 0.2841
 Site-MNIST-M                       | Val  Loss: 2.1522 | Val  Acc: 0.2992
 Site-SVHN                          | Val  Loss: 2.1682 | Val  Acc: 0.3038
Average Valid Accuracy: 0.5983
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7232
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7219
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7628
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7211
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7246
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8125
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7788
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7932
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4205
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4318
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.2841
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.2992
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3038
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 16 ============
denominator: 20903.001953125
 Site-MNIST                    | Train Loss: 1.2100 | Train Acc: 0.8071
 Site-MNIST                    | Train Loss: 1.3329 | Train Acc: 0.7204
 Site-MNIST                    | Train Loss: 1.2624 | Train Acc: 0.7606
 Site-MNIST                    | Train Loss: 1.2750 | Train Acc: 0.7503
 Site-MNIST                    | Train Loss: 1.2805 | Train Acc: 0.7518
 Site-USPS                     | Train Loss: 1.1593 | Train Acc: 0.7794
 Site-USPS                     | Train Loss: 1.1213 | Train Acc: 0.8091
 Site-USPS                     | Train Loss: 1.1312 | Train Acc: 0.7982
 Site-SynthDigits              | Train Loss: 1.9495 | Train Acc: 0.3974
 Site-SynthDigits              | Train Loss: 1.9244 | Train Acc: 0.4243
 Site-MNIST-M                  | Train Loss: 2.1163 | Train Acc: 0.3111
 Site-MNIST-M                  | Train Loss: 2.1201 | Train Acc: 0.2990
 Site-SVHN                     | Train Loss: 2.1744 | Train Acc: 0.2641
 Site-MNIST                         | Val  Loss: 1.3059 | Val  Acc: 0.7321
 Site-MNIST                         | Val  Loss: 1.3081 | Val  Acc: 0.7160
 Site-MNIST                         | Val  Loss: 1.2573 | Val  Acc: 0.7589
 Site-MNIST                         | Val  Loss: 1.3201 | Val  Acc: 0.7237
 Site-MNIST                         | Val  Loss: 1.3250 | Val  Acc: 0.7228
 Site-USPS                          | Val  Loss: 1.0840 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 1.1430 | Val  Acc: 0.7756
 Site-USPS                          | Val  Loss: 1.1564 | Val  Acc: 0.7932
 Site-SynthDigits                   | Val  Loss: 1.9342 | Val  Acc: 0.4205
 Site-SynthDigits                   | Val  Loss: 1.9274 | Val  Acc: 0.4293
 Site-MNIST-M                       | Val  Loss: 2.1423 | Val  Acc: 0.2841
 Site-MNIST-M                       | Val  Loss: 2.1370 | Val  Acc: 0.2992
 Site-SVHN                          | Val  Loss: 2.1607 | Val  Acc: 0.3072
Average Valid Accuracy: 0.5981
============ Train epoch 17 ============
denominator: 20508.880859375
 Site-MNIST                    | Train Loss: 1.2106 | Train Acc: 0.8137
 Site-MNIST                    | Train Loss: 1.3220 | Train Acc: 0.7263
 Site-MNIST                    | Train Loss: 1.2297 | Train Acc: 0.7764
 Site-MNIST                    | Train Loss: 1.2460 | Train Acc: 0.7641
 Site-MNIST                    | Train Loss: 1.2472 | Train Acc: 0.7614
 Site-USPS                     | Train Loss: 1.0658 | Train Acc: 0.7998
 Site-USPS                     | Train Loss: 1.0636 | Train Acc: 0.8291
 Site-USPS                     | Train Loss: 1.0697 | Train Acc: 0.8142
 Site-SynthDigits              | Train Loss: 1.8916 | Train Acc: 0.4059
 Site-SynthDigits              | Train Loss: 1.9064 | Train Acc: 0.4306
 Site-MNIST-M                  | Train Loss: 2.1025 | Train Acc: 0.3295
 Site-MNIST-M                  | Train Loss: 2.1089 | Train Acc: 0.3009
 Site-SVHN                     | Train Loss: 2.1662 | Train Acc: 0.2641
 Site-MNIST                         | Val  Loss: 1.2793 | Val  Acc: 0.7679
 Site-MNIST                         | Val  Loss: 1.2765 | Val  Acc: 0.7456
 Site-MNIST                         | Val  Loss: 1.2231 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 1.2862 | Val  Acc: 0.7395
 Site-MNIST                         | Val  Loss: 1.2948 | Val  Acc: 0.7298
 Site-USPS                          | Val  Loss: 1.0231 | Val  Acc: 0.8413
 Site-USPS                          | Val  Loss: 1.0871 | Val  Acc: 0.7917
 Site-USPS                          | Val  Loss: 1.0988 | Val  Acc: 0.8081
 Site-SynthDigits                   | Val  Loss: 1.9145 | Val  Acc: 0.4280
 Site-SynthDigits                   | Val  Loss: 1.9093 | Val  Acc: 0.4369
 Site-MNIST-M                       | Val  Loss: 2.1330 | Val  Acc: 0.2955
 Site-MNIST-M                       | Val  Loss: 2.1231 | Val  Acc: 0.3258
 Site-SVHN                          | Val  Loss: 2.1525 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6159
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7679
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7456
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7826
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7395
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7298
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8413
 Best site-USPS                      | Epoch:17 | Val Acc: 0.7917
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8081
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.4280
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.4369
 Best site-MNIST-M                   | Epoch:17 | Val Acc: 0.2955
 Best site-MNIST-M                   | Epoch:17 | Val Acc: 0.3258
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3140
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 18 ============
denominator: 20263.35546875
 Site-MNIST                    | Train Loss: 1.1722 | Train Acc: 0.8204
 Site-MNIST                    | Train Loss: 1.2668 | Train Acc: 0.7411
 Site-MNIST                    | Train Loss: 1.2010 | Train Acc: 0.7862
 Site-MNIST                    | Train Loss: 1.2194 | Train Acc: 0.7654
 Site-MNIST                    | Train Loss: 1.2187 | Train Acc: 0.7658
 Site-USPS                     | Train Loss: 1.0499 | Train Acc: 0.8094
 Site-USPS                     | Train Loss: 1.0351 | Train Acc: 0.8307
 Site-USPS                     | Train Loss: 1.0266 | Train Acc: 0.8211
 Site-SynthDigits              | Train Loss: 1.8976 | Train Acc: 0.4002
 Site-SynthDigits              | Train Loss: 1.8900 | Train Acc: 0.4325
 Site-MNIST-M                  | Train Loss: 2.0900 | Train Acc: 0.3253
 Site-MNIST-M                  | Train Loss: 2.0777 | Train Acc: 0.3065
 Site-SVHN                     | Train Loss: 2.1574 | Train Acc: 0.2649
 Site-MNIST                         | Val  Loss: 1.2550 | Val  Acc: 0.7857
 Site-MNIST                         | Val  Loss: 1.2436 | Val  Acc: 0.7456
 Site-MNIST                         | Val  Loss: 1.1897 | Val  Acc: 0.7905
 Site-MNIST                         | Val  Loss: 1.2544 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.2662 | Val  Acc: 0.7421
 Site-USPS                          | Val  Loss: 0.9801 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 1.0467 | Val  Acc: 0.7917
 Site-USPS                          | Val  Loss: 1.0557 | Val  Acc: 0.8145
 Site-SynthDigits                   | Val  Loss: 1.8945 | Val  Acc: 0.4318
 Site-SynthDigits                   | Val  Loss: 1.8930 | Val  Acc: 0.4242
 Site-MNIST-M                       | Val  Loss: 2.1235 | Val  Acc: 0.3068
 Site-MNIST-M                       | Val  Loss: 2.1095 | Val  Acc: 0.3295
 Site-SVHN                          | Val  Loss: 2.1457 | Val  Acc: 0.3072
Average Valid Accuracy: 0.6197
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7857
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7456
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7905
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7421
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:18 | Val Acc: 0.7917
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8145
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4318
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4242
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.3068
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.3295
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3072
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 19 ============
denominator: 19975.689453125
 Site-MNIST                    | Train Loss: 1.1264 | Train Acc: 0.8204
 Site-MNIST                    | Train Loss: 1.2548 | Train Acc: 0.7500
 Site-MNIST                    | Train Loss: 1.1707 | Train Acc: 0.7941
 Site-MNIST                    | Train Loss: 1.1867 | Train Acc: 0.7740
 Site-MNIST                    | Train Loss: 1.1908 | Train Acc: 0.7728
 Site-USPS                     | Train Loss: 1.0236 | Train Acc: 0.8070
 Site-USPS                     | Train Loss: 1.0016 | Train Acc: 0.8315
 Site-USPS                     | Train Loss: 1.0033 | Train Acc: 0.8216
 Site-SynthDigits              | Train Loss: 1.8961 | Train Acc: 0.4172
 Site-SynthDigits              | Train Loss: 1.8679 | Train Acc: 0.4420
 Site-MNIST-M                  | Train Loss: 2.0772 | Train Acc: 0.3395
 Site-MNIST-M                  | Train Loss: 2.0695 | Train Acc: 0.3122
 Site-SVHN                     | Train Loss: 2.1491 | Train Acc: 0.2726
 Site-MNIST                         | Val  Loss: 1.2245 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.2153 | Val  Acc: 0.7515
 Site-MNIST                         | Val  Loss: 1.1595 | Val  Acc: 0.7945
 Site-MNIST                         | Val  Loss: 1.2238 | Val  Acc: 0.7658
 Site-MNIST                         | Val  Loss: 1.2378 | Val  Acc: 0.7526
 Site-USPS                          | Val  Loss: 0.9622 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 1.0271 | Val  Acc: 0.7917
 Site-USPS                          | Val  Loss: 1.0322 | Val  Acc: 0.8102
 Site-SynthDigits                   | Val  Loss: 1.8735 | Val  Acc: 0.4545
 Site-SynthDigits                   | Val  Loss: 1.8737 | Val  Acc: 0.4394
 Site-MNIST-M                       | Val  Loss: 2.1114 | Val  Acc: 0.3295
 Site-MNIST-M                       | Val  Loss: 2.0973 | Val  Acc: 0.3523
 Site-SVHN                          | Val  Loss: 2.1385 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6302
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7515
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7945
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7658
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7526
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:19 | Val Acc: 0.7917
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8102
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4545
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4394
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.3295
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.3523
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3106
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
 Test site-MNIST                     | Epoch:19 | Test Acc: 0.7734
 Test site-USPS                      | Epoch:19 | Test Acc: 0.8140
 Test site-SynthDigits               | Epoch:19 | Test Acc: 0.4115
 Test site-MNIST-M                   | Epoch:19 | Test Acc: 0.3054
 Test site-SVHN                      | Epoch:19 | Test Acc: 0.2551
MNIST: 0.773, USPS: 0.814, SynthDigits: 0.412, MNIST-M: 0.305, SVHN: 0.255, 
Average Test Accuracy: 0.5119, domain std=0.2359, cluster std=-1.0000, individual std=0.2233, 
============ Train epoch 20 ============
denominator: 19679.185546875
 Site-MNIST                    | Train Loss: 1.1023 | Train Acc: 0.8226
 Site-MNIST                    | Train Loss: 1.2160 | Train Acc: 0.7530
 Site-MNIST                    | Train Loss: 1.1351 | Train Acc: 0.7882
 Site-MNIST                    | Train Loss: 1.1517 | Train Acc: 0.7766
 Site-MNIST                    | Train Loss: 1.1549 | Train Acc: 0.7767
 Site-USPS                     | Train Loss: 0.9969 | Train Acc: 0.8094
 Site-USPS                     | Train Loss: 0.9860 | Train Acc: 0.8331
 Site-USPS                     | Train Loss: 0.9877 | Train Acc: 0.8195
 Site-SynthDigits              | Train Loss: 1.8884 | Train Acc: 0.4182
 Site-SynthDigits              | Train Loss: 1.8523 | Train Acc: 0.4489
 Site-MNIST-M                  | Train Loss: 2.0610 | Train Acc: 0.3551
 Site-MNIST-M                  | Train Loss: 2.0514 | Train Acc: 0.3340
 Site-SVHN                     | Train Loss: 2.1430 | Train Acc: 0.2734
 Site-MNIST                         | Val  Loss: 1.1867 | Val  Acc: 0.7679
 Site-MNIST                         | Val  Loss: 1.1779 | Val  Acc: 0.7337
 Site-MNIST                         | Val  Loss: 1.1237 | Val  Acc: 0.7945
 Site-MNIST                         | Val  Loss: 1.1875 | Val  Acc: 0.7684
 Site-MNIST                         | Val  Loss: 1.2015 | Val  Acc: 0.7561
 Site-USPS                          | Val  Loss: 0.9405 | Val  Acc: 0.8221
 Site-USPS                          | Val  Loss: 1.0059 | Val  Acc: 0.7917
 Site-USPS                          | Val  Loss: 1.0137 | Val  Acc: 0.8145
 Site-SynthDigits                   | Val  Loss: 1.8558 | Val  Acc: 0.4735
 Site-SynthDigits                   | Val  Loss: 1.8522 | Val  Acc: 0.4520
 Site-MNIST-M                       | Val  Loss: 2.0989 | Val  Acc: 0.3295
 Site-MNIST-M                       | Val  Loss: 2.0799 | Val  Acc: 0.3485
 Site-SVHN                          | Val  Loss: 2.1325 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6282
============ Train epoch 21 ============
denominator: 19382.96484375
 Site-MNIST                    | Train Loss: 1.0479 | Train Acc: 0.8271
 Site-MNIST                    | Train Loss: 1.1789 | Train Acc: 0.7604
 Site-MNIST                    | Train Loss: 1.1043 | Train Acc: 0.7990
 Site-MNIST                    | Train Loss: 1.1214 | Train Acc: 0.7871
 Site-MNIST                    | Train Loss: 1.1247 | Train Acc: 0.7798
 Site-USPS                     | Train Loss: 0.9749 | Train Acc: 0.8213
 Site-USPS                     | Train Loss: 0.9338 | Train Acc: 0.8339
 Site-USPS                     | Train Loss: 0.9496 | Train Acc: 0.8291
 Site-SynthDigits              | Train Loss: 1.8263 | Train Acc: 0.4267
 Site-SynthDigits              | Train Loss: 1.8336 | Train Acc: 0.4477
 Site-MNIST-M                  | Train Loss: 2.0476 | Train Acc: 0.3594
 Site-MNIST-M                  | Train Loss: 2.0372 | Train Acc: 0.3377
 Site-SVHN                     | Train Loss: 2.1351 | Train Acc: 0.2734
 Site-MNIST                         | Val  Loss: 1.1594 | Val  Acc: 0.7946
 Site-MNIST                         | Val  Loss: 1.1478 | Val  Acc: 0.7456
 Site-MNIST                         | Val  Loss: 1.0914 | Val  Acc: 0.7984
 Site-MNIST                         | Val  Loss: 1.1554 | Val  Acc: 0.7789
 Site-MNIST                         | Val  Loss: 1.1716 | Val  Acc: 0.7596
 Site-USPS                          | Val  Loss: 0.9056 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.9721 | Val  Acc: 0.7949
 Site-USPS                          | Val  Loss: 0.9771 | Val  Acc: 0.8252
 Site-SynthDigits                   | Val  Loss: 1.8361 | Val  Acc: 0.4773
 Site-SynthDigits                   | Val  Loss: 1.8336 | Val  Acc: 0.4596
 Site-MNIST-M                       | Val  Loss: 2.0870 | Val  Acc: 0.3295
 Site-MNIST-M                       | Val  Loss: 2.0686 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 2.1248 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6357
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7946
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7456
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7984
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7789
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7596
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:21 | Val Acc: 0.7949
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8252
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.4773
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.4596
 Best site-MNIST-M                   | Epoch:21 | Val Acc: 0.3295
 Best site-MNIST-M                   | Epoch:21 | Val Acc: 0.3561
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.3174
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 22 ============
denominator: 19093.203125
 Site-MNIST                    | Train Loss: 1.0448 | Train Acc: 0.8293
 Site-MNIST                    | Train Loss: 1.1581 | Train Acc: 0.7707
 Site-MNIST                    | Train Loss: 1.0731 | Train Acc: 0.8020
 Site-MNIST                    | Train Loss: 1.0914 | Train Acc: 0.7937
 Site-MNIST                    | Train Loss: 1.0936 | Train Acc: 0.7846
 Site-USPS                     | Train Loss: 0.9599 | Train Acc: 0.8261
 Site-USPS                     | Train Loss: 0.9101 | Train Acc: 0.8339
 Site-USPS                     | Train Loss: 0.9234 | Train Acc: 0.8285
 Site-SynthDigits              | Train Loss: 1.8417 | Train Acc: 0.4267
 Site-SynthDigits              | Train Loss: 1.8199 | Train Acc: 0.4527
 Site-MNIST-M                  | Train Loss: 2.0374 | Train Acc: 0.3580
 Site-MNIST-M                  | Train Loss: 2.0358 | Train Acc: 0.3349
 Site-SVHN                     | Train Loss: 2.1256 | Train Acc: 0.2726
 Site-MNIST                         | Val  Loss: 1.1310 | Val  Acc: 0.7946
 Site-MNIST                         | Val  Loss: 1.1167 | Val  Acc: 0.7396
 Site-MNIST                         | Val  Loss: 1.0581 | Val  Acc: 0.7945
 Site-MNIST                         | Val  Loss: 1.1233 | Val  Acc: 0.7789
 Site-MNIST                         | Val  Loss: 1.1400 | Val  Acc: 0.7667
 Site-USPS                          | Val  Loss: 0.8814 | Val  Acc: 0.8317
 Site-USPS                          | Val  Loss: 0.9475 | Val  Acc: 0.7981
 Site-USPS                          | Val  Loss: 0.9504 | Val  Acc: 0.8316
 Site-SynthDigits                   | Val  Loss: 1.8196 | Val  Acc: 0.4886
 Site-SynthDigits                   | Val  Loss: 1.8196 | Val  Acc: 0.4596
 Site-MNIST-M                       | Val  Loss: 2.0754 | Val  Acc: 0.3352
 Site-MNIST-M                       | Val  Loss: 2.0586 | Val  Acc: 0.3523
 Site-SVHN                          | Val  Loss: 2.1183 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6373
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7946
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7396
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7945
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7789
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7667
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8317
 Best site-USPS                      | Epoch:22 | Val Acc: 0.7981
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8316
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.4886
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.4596
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.3352
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.3523
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.3140
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 23 ============
denominator: 18695.9609375
 Site-MNIST                    | Train Loss: 1.0691 | Train Acc: 0.8271
 Site-MNIST                    | Train Loss: 1.1314 | Train Acc: 0.7633
 Site-MNIST                    | Train Loss: 1.0540 | Train Acc: 0.7990
 Site-MNIST                    | Train Loss: 1.0727 | Train Acc: 0.7924
 Site-MNIST                    | Train Loss: 1.0748 | Train Acc: 0.7859
 Site-USPS                     | Train Loss: 0.9341 | Train Acc: 0.8165
 Site-USPS                     | Train Loss: 0.9194 | Train Acc: 0.8371
 Site-USPS                     | Train Loss: 0.9119 | Train Acc: 0.8216
 Site-SynthDigits              | Train Loss: 1.8160 | Train Acc: 0.4418
 Site-SynthDigits              | Train Loss: 1.7863 | Train Acc: 0.4628
 Site-MNIST-M                  | Train Loss: 2.0164 | Train Acc: 0.3693
 Site-MNIST-M                  | Train Loss: 2.0170 | Train Acc: 0.3491
 Site-SVHN                     | Train Loss: 2.1139 | Train Acc: 0.2836
 Site-MNIST                         | Val  Loss: 1.1101 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.0990 | Val  Acc: 0.7456
 Site-MNIST                         | Val  Loss: 1.0410 | Val  Acc: 0.7945
 Site-MNIST                         | Val  Loss: 1.1035 | Val  Acc: 0.7711
 Site-MNIST                         | Val  Loss: 1.1229 | Val  Acc: 0.7632
 Site-USPS                          | Val  Loss: 0.8671 | Val  Acc: 0.8413
 Site-USPS                          | Val  Loss: 0.9347 | Val  Acc: 0.7949
 Site-USPS                          | Val  Loss: 0.9361 | Val  Acc: 0.8230
 Site-SynthDigits                   | Val  Loss: 1.7916 | Val  Acc: 0.5038
 Site-SynthDigits                   | Val  Loss: 1.7900 | Val  Acc: 0.4798
 Site-MNIST-M                       | Val  Loss: 2.0655 | Val  Acc: 0.3466
 Site-MNIST-M                       | Val  Loss: 2.0364 | Val  Acc: 0.3674
 Site-SVHN                          | Val  Loss: 2.1028 | Val  Acc: 0.3242
Average Valid Accuracy: 0.6430
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7456
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7945
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7711
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7632
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8413
 Best site-USPS                      | Epoch:23 | Val Acc: 0.7949
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8230
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.5038
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.4798
 Best site-MNIST-M                   | Epoch:23 | Val Acc: 0.3466
 Best site-MNIST-M                   | Epoch:23 | Val Acc: 0.3674
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.3242
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 24 ============
denominator: 18480.38671875
 Site-MNIST                    | Train Loss: 0.9608 | Train Acc: 0.8271
 Site-MNIST                    | Train Loss: 1.1152 | Train Acc: 0.7825
 Site-MNIST                    | Train Loss: 1.0213 | Train Acc: 0.8039
 Site-MNIST                    | Train Loss: 1.0403 | Train Acc: 0.7989
 Site-MNIST                    | Train Loss: 1.0415 | Train Acc: 0.7929
 Site-USPS                     | Train Loss: 0.8786 | Train Acc: 0.8309
 Site-USPS                     | Train Loss: 0.8713 | Train Acc: 0.8411
 Site-USPS                     | Train Loss: 0.8720 | Train Acc: 0.8360
 Site-SynthDigits              | Train Loss: 1.8175 | Train Acc: 0.4437
 Site-SynthDigits              | Train Loss: 1.7775 | Train Acc: 0.4615
 Site-MNIST-M                  | Train Loss: 2.0093 | Train Acc: 0.3665
 Site-MNIST-M                  | Train Loss: 2.0271 | Train Acc: 0.3548
 Site-SVHN                     | Train Loss: 2.1105 | Train Acc: 0.2777
 Site-MNIST                         | Val  Loss: 1.0814 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.0671 | Val  Acc: 0.7396
 Site-MNIST                         | Val  Loss: 1.0070 | Val  Acc: 0.7945
 Site-MNIST                         | Val  Loss: 1.0689 | Val  Acc: 0.7895
 Site-MNIST                         | Val  Loss: 1.0889 | Val  Acc: 0.7807
 Site-USPS                          | Val  Loss: 0.8317 | Val  Acc: 0.8413
 Site-USPS                          | Val  Loss: 0.8985 | Val  Acc: 0.7981
 Site-USPS                          | Val  Loss: 0.8992 | Val  Acc: 0.8358
 Site-SynthDigits                   | Val  Loss: 1.7791 | Val  Acc: 0.4962
 Site-SynthDigits                   | Val  Loss: 1.7799 | Val  Acc: 0.4773
 Site-MNIST-M                       | Val  Loss: 2.0582 | Val  Acc: 0.3409
 Site-MNIST-M                       | Val  Loss: 2.0297 | Val  Acc: 0.3636
 Site-SVHN                          | Val  Loss: 2.1003 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6440
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7396
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7945
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7895
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7807
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8413
 Best site-USPS                      | Epoch:24 | Val Acc: 0.7981
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8358
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.4962
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.4773
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.3409
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.3636
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3106
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 25 ============
denominator: 18232.30859375
 Site-MNIST                    | Train Loss: 0.9563 | Train Acc: 0.8293
 Site-MNIST                    | Train Loss: 1.0661 | Train Acc: 0.7855
 Site-MNIST                    | Train Loss: 0.9888 | Train Acc: 0.8089
 Site-MNIST                    | Train Loss: 1.0074 | Train Acc: 0.8035
 Site-MNIST                    | Train Loss: 1.0137 | Train Acc: 0.7955
 Site-USPS                     | Train Loss: 0.9161 | Train Acc: 0.8201
 Site-USPS                     | Train Loss: 0.8781 | Train Acc: 0.8299
 Site-USPS                     | Train Loss: 0.8836 | Train Acc: 0.8280
 Site-SynthDigits              | Train Loss: 1.7985 | Train Acc: 0.4456
 Site-SynthDigits              | Train Loss: 1.7656 | Train Acc: 0.4653
 Site-MNIST-M                  | Train Loss: 1.9964 | Train Acc: 0.3736
 Site-MNIST-M                  | Train Loss: 1.9610 | Train Acc: 0.3595
 Site-SVHN                     | Train Loss: 2.1087 | Train Acc: 0.2828
 Site-MNIST                         | Val  Loss: 1.0473 | Val  Acc: 0.7768
 Site-MNIST                         | Val  Loss: 1.0327 | Val  Acc: 0.7574
 Site-MNIST                         | Val  Loss: 0.9745 | Val  Acc: 0.8063
 Site-MNIST                         | Val  Loss: 1.0404 | Val  Acc: 0.7895
 Site-MNIST                         | Val  Loss: 1.0567 | Val  Acc: 0.7825
 Site-USPS                          | Val  Loss: 0.8393 | Val  Acc: 0.8317
 Site-USPS                          | Val  Loss: 0.9088 | Val  Acc: 0.7949
 Site-USPS                          | Val  Loss: 0.9050 | Val  Acc: 0.8230
 Site-SynthDigits                   | Val  Loss: 1.7669 | Val  Acc: 0.5038
 Site-SynthDigits                   | Val  Loss: 1.7675 | Val  Acc: 0.4747
 Site-MNIST-M                       | Val  Loss: 2.0425 | Val  Acc: 0.3580
 Site-MNIST-M                       | Val  Loss: 2.0228 | Val  Acc: 0.3674
 Site-SVHN                          | Val  Loss: 2.0954 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6444
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7768
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7574
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8063
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7895
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7825
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8317
 Best site-USPS                      | Epoch:25 | Val Acc: 0.7949
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8230
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.5038
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.4747
 Best site-MNIST-M                   | Epoch:25 | Val Acc: 0.3580
 Best site-MNIST-M                   | Epoch:25 | Val Acc: 0.3674
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.3106
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 26 ============
denominator: 18050.93359375
 Site-MNIST                    | Train Loss: 0.9152 | Train Acc: 0.8337
 Site-MNIST                    | Train Loss: 1.0436 | Train Acc: 0.7929
 Site-MNIST                    | Train Loss: 0.9624 | Train Acc: 0.8207
 Site-MNIST                    | Train Loss: 0.9802 | Train Acc: 0.8088
 Site-MNIST                    | Train Loss: 0.9869 | Train Acc: 0.8017
 Site-USPS                     | Train Loss: 0.9192 | Train Acc: 0.8285
 Site-USPS                     | Train Loss: 0.8614 | Train Acc: 0.8323
 Site-USPS                     | Train Loss: 0.8558 | Train Acc: 0.8291
 Site-SynthDigits              | Train Loss: 1.7509 | Train Acc: 0.4437
 Site-SynthDigits              | Train Loss: 1.7590 | Train Acc: 0.4685
 Site-MNIST-M                  | Train Loss: 1.9940 | Train Acc: 0.3736
 Site-MNIST-M                  | Train Loss: 2.0130 | Train Acc: 0.3623
 Site-SVHN                     | Train Loss: 2.1063 | Train Acc: 0.2802
 Site-MNIST                         | Val  Loss: 1.0238 | Val  Acc: 0.8304
 Site-MNIST                         | Val  Loss: 1.0103 | Val  Acc: 0.7751
 Site-MNIST                         | Val  Loss: 0.9518 | Val  Acc: 0.8142
 Site-MNIST                         | Val  Loss: 1.0156 | Val  Acc: 0.8079
 Site-MNIST                         | Val  Loss: 1.0324 | Val  Acc: 0.7947
 Site-USPS                          | Val  Loss: 0.8132 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.8837 | Val  Acc: 0.7917
 Site-USPS                          | Val  Loss: 0.8782 | Val  Acc: 0.8316
 Site-SynthDigits                   | Val  Loss: 1.7571 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.7592 | Val  Acc: 0.4747
 Site-MNIST-M                       | Val  Loss: 2.0414 | Val  Acc: 0.3523
 Site-MNIST-M                       | Val  Loss: 2.0209 | Val  Acc: 0.3750
 Site-SVHN                          | Val  Loss: 2.0926 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6532
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8304
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.7751
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8142
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8079
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.7947
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:26 | Val Acc: 0.7917
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8316
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.4747
 Best site-MNIST-M                   | Epoch:26 | Val Acc: 0.3523
 Best site-MNIST-M                   | Epoch:26 | Val Acc: 0.3750
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.3174
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 27 ============
denominator: 17641.3125
 Site-MNIST                    | Train Loss: 0.9559 | Train Acc: 0.8359
 Site-MNIST                    | Train Loss: 1.0361 | Train Acc: 0.7944
 Site-MNIST                    | Train Loss: 0.9503 | Train Acc: 0.8148
 Site-MNIST                    | Train Loss: 0.9683 | Train Acc: 0.8035
 Site-MNIST                    | Train Loss: 0.9757 | Train Acc: 0.7977
 Site-USPS                     | Train Loss: 0.8552 | Train Acc: 0.8261
 Site-USPS                     | Train Loss: 0.8133 | Train Acc: 0.8395
 Site-USPS                     | Train Loss: 0.8290 | Train Acc: 0.8285
 Site-SynthDigits              | Train Loss: 1.7620 | Train Acc: 0.4503
 Site-SynthDigits              | Train Loss: 1.7301 | Train Acc: 0.4697
 Site-MNIST-M                  | Train Loss: 1.9768 | Train Acc: 0.3849
 Site-MNIST-M                  | Train Loss: 1.9889 | Train Acc: 0.3671
 Site-SVHN                     | Train Loss: 2.0892 | Train Acc: 0.2811
 Site-MNIST                         | Val  Loss: 1.0129 | Val  Acc: 0.8125
 Site-MNIST                         | Val  Loss: 0.9940 | Val  Acc: 0.7633
 Site-MNIST                         | Val  Loss: 0.9344 | Val  Acc: 0.8103
 Site-MNIST                         | Val  Loss: 0.9988 | Val  Acc: 0.8053
 Site-MNIST                         | Val  Loss: 1.0189 | Val  Acc: 0.7965
 Site-USPS                          | Val  Loss: 0.7866 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.8576 | Val  Acc: 0.7949
 Site-USPS                          | Val  Loss: 0.8520 | Val  Acc: 0.8358
 Site-SynthDigits                   | Val  Loss: 1.7267 | Val  Acc: 0.5227
 Site-SynthDigits                   | Val  Loss: 1.7343 | Val  Acc: 0.4747
 Site-MNIST-M                       | Val  Loss: 2.0280 | Val  Acc: 0.3693
 Site-MNIST-M                       | Val  Loss: 1.9979 | Val  Acc: 0.3788
 Site-SVHN                          | Val  Loss: 2.0763 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6560
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8125
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.7633
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8103
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8053
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.7965
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8462
 Best site-USPS                      | Epoch:27 | Val Acc: 0.7949
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8358
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5227
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.4747
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.3693
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.3788
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.3174
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 28 ============
denominator: 17515.08984375
 Site-MNIST                    | Train Loss: 0.8702 | Train Acc: 0.8381
 Site-MNIST                    | Train Loss: 0.9988 | Train Acc: 0.7988
 Site-MNIST                    | Train Loss: 0.9203 | Train Acc: 0.8207
 Site-MNIST                    | Train Loss: 0.9385 | Train Acc: 0.8081
 Site-MNIST                    | Train Loss: 0.9385 | Train Acc: 0.8025
 Site-USPS                     | Train Loss: 0.8625 | Train Acc: 0.8309
 Site-USPS                     | Train Loss: 0.8252 | Train Acc: 0.8331
 Site-USPS                     | Train Loss: 0.8294 | Train Acc: 0.8296
 Site-SynthDigits              | Train Loss: 1.7446 | Train Acc: 0.4588
 Site-SynthDigits              | Train Loss: 1.7209 | Train Acc: 0.4741
 Site-MNIST-M                  | Train Loss: 1.9765 | Train Acc: 0.3764
 Site-MNIST-M                  | Train Loss: 1.9786 | Train Acc: 0.3642
 Site-SVHN                     | Train Loss: 2.0904 | Train Acc: 0.2853
 Site-MNIST                         | Val  Loss: 0.9767 | Val  Acc: 0.8125
 Site-MNIST                         | Val  Loss: 0.9645 | Val  Acc: 0.7692
 Site-MNIST                         | Val  Loss: 0.9054 | Val  Acc: 0.8142
 Site-MNIST                         | Val  Loss: 0.9668 | Val  Acc: 0.8026
 Site-MNIST                         | Val  Loss: 0.9880 | Val  Acc: 0.7965
 Site-USPS                          | Val  Loss: 0.7903 | Val  Acc: 0.8317
 Site-USPS                          | Val  Loss: 0.8601 | Val  Acc: 0.7917
 Site-USPS                          | Val  Loss: 0.8541 | Val  Acc: 0.8316
 Site-SynthDigits                   | Val  Loss: 1.7175 | Val  Acc: 0.5227
 Site-SynthDigits                   | Val  Loss: 1.7224 | Val  Acc: 0.4823
 Site-MNIST-M                       | Val  Loss: 2.0336 | Val  Acc: 0.3523
 Site-MNIST-M                       | Val  Loss: 2.0001 | Val  Acc: 0.3788
 Site-SVHN                          | Val  Loss: 2.0741 | Val  Acc: 0.3208
Average Valid Accuracy: 0.6544
============ Train epoch 29 ============
denominator: 17302.876953125
 Site-MNIST                    | Train Loss: 0.8381 | Train Acc: 0.8404
 Site-MNIST                    | Train Loss: 0.9926 | Train Acc: 0.8047
 Site-MNIST                    | Train Loss: 0.9002 | Train Acc: 0.8305
 Site-MNIST                    | Train Loss: 0.9165 | Train Acc: 0.8206
 Site-MNIST                    | Train Loss: 0.9217 | Train Acc: 0.8100
 Site-USPS                     | Train Loss: 0.8280 | Train Acc: 0.8321
 Site-USPS                     | Train Loss: 0.8017 | Train Acc: 0.8387
 Site-USPS                     | Train Loss: 0.7980 | Train Acc: 0.8360
 Site-SynthDigits              | Train Loss: 1.7516 | Train Acc: 0.4456
 Site-SynthDigits              | Train Loss: 1.7122 | Train Acc: 0.4823
 Site-MNIST-M                  | Train Loss: 1.9595 | Train Acc: 0.3750
 Site-MNIST-M                  | Train Loss: 1.9606 | Train Acc: 0.3822
 Site-SVHN                     | Train Loss: 2.0821 | Train Acc: 0.2828
 Site-MNIST                         | Val  Loss: 0.9601 | Val  Acc: 0.8304
 Site-MNIST                         | Val  Loss: 0.9465 | Val  Acc: 0.7811
 Site-MNIST                         | Val  Loss: 0.8861 | Val  Acc: 0.8300
 Site-MNIST                         | Val  Loss: 0.9495 | Val  Acc: 0.8132
 Site-MNIST                         | Val  Loss: 0.9676 | Val  Acc: 0.8035
 Site-USPS                          | Val  Loss: 0.7602 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.8319 | Val  Acc: 0.7949
 Site-USPS                          | Val  Loss: 0.8204 | Val  Acc: 0.8380
 Site-SynthDigits                   | Val  Loss: 1.7077 | Val  Acc: 0.5076
 Site-SynthDigits                   | Val  Loss: 1.7121 | Val  Acc: 0.4621
 Site-MNIST-M                       | Val  Loss: 2.0111 | Val  Acc: 0.3693
 Site-MNIST-M                       | Val  Loss: 1.9854 | Val  Acc: 0.3674
 Site-SVHN                          | Val  Loss: 2.0669 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6585
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8304
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.7811
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8300
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8132
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8035
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8462
 Best site-USPS                      | Epoch:29 | Val Acc: 0.7949
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8380
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5076
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.4621
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.3693
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.3674
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3174
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
 Test site-MNIST                     | Epoch:29 | Test Acc: 0.8174
 Test site-USPS                      | Epoch:29 | Test Acc: 0.8317
 Test site-SynthDigits               | Epoch:29 | Test Acc: 0.4636
 Test site-MNIST-M                   | Epoch:29 | Test Acc: 0.3577
 Test site-SVHN                      | Epoch:29 | Test Acc: 0.2691
MNIST: 0.817, USPS: 0.832, SynthDigits: 0.464, MNIST-M: 0.358, SVHN: 0.269, 
Average Test Accuracy: 0.5479, domain std=0.2342, cluster std=-1.0000, individual std=0.2192, 
============ Train epoch 30 ============
denominator: 17025.736328125
 Site-MNIST                    | Train Loss: 0.8314 | Train Acc: 0.8404
 Site-MNIST                    | Train Loss: 0.9326 | Train Acc: 0.8136
 Site-MNIST                    | Train Loss: 0.8655 | Train Acc: 0.8305
 Site-MNIST                    | Train Loss: 0.8870 | Train Acc: 0.8226
 Site-MNIST                    | Train Loss: 0.8893 | Train Acc: 0.8117
 Site-USPS                     | Train Loss: 0.8395 | Train Acc: 0.8381
 Site-USPS                     | Train Loss: 0.7926 | Train Acc: 0.8371
 Site-USPS                     | Train Loss: 0.7996 | Train Acc: 0.8349
 Site-SynthDigits              | Train Loss: 1.7436 | Train Acc: 0.4484
 Site-SynthDigits              | Train Loss: 1.7086 | Train Acc: 0.4823
 Site-MNIST-M                  | Train Loss: 1.9590 | Train Acc: 0.3920
 Site-MNIST-M                  | Train Loss: 1.9692 | Train Acc: 0.3775
 Site-SVHN                     | Train Loss: 2.0844 | Train Acc: 0.2828
 Site-MNIST                         | Val  Loss: 0.9179 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.9111 | Val  Acc: 0.7929
 Site-MNIST                         | Val  Loss: 0.8527 | Val  Acc: 0.8340
 Site-MNIST                         | Val  Loss: 0.9173 | Val  Acc: 0.8184
 Site-MNIST                         | Val  Loss: 0.9324 | Val  Acc: 0.8140
 Site-USPS                          | Val  Loss: 0.7578 | Val  Acc: 0.8317
 Site-USPS                          | Val  Loss: 0.8295 | Val  Acc: 0.8013
 Site-USPS                          | Val  Loss: 0.8177 | Val  Acc: 0.8401
 Site-SynthDigits                   | Val  Loss: 1.6986 | Val  Acc: 0.5076
 Site-SynthDigits                   | Val  Loss: 1.7090 | Val  Acc: 0.4722
 Site-MNIST-M                       | Val  Loss: 2.0067 | Val  Acc: 0.3750
 Site-MNIST-M                       | Val  Loss: 1.9894 | Val  Acc: 0.3864
 Site-SVHN                          | Val  Loss: 2.0676 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6625
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.7929
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8340
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8184
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8140
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8317
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8013
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8401
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5076
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.4722
 Best site-MNIST-M                   | Epoch:30 | Val Acc: 0.3750
 Best site-MNIST-M                   | Epoch:30 | Val Acc: 0.3864
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.3174
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 31 ============
denominator: 16847.443359375
 Site-MNIST                    | Train Loss: 0.8214 | Train Acc: 0.8426
 Site-MNIST                    | Train Loss: 0.9136 | Train Acc: 0.8107
 Site-MNIST                    | Train Loss: 0.8597 | Train Acc: 0.8305
 Site-MNIST                    | Train Loss: 0.8766 | Train Acc: 0.8246
 Site-MNIST                    | Train Loss: 0.8822 | Train Acc: 0.8174
 Site-USPS                     | Train Loss: 0.8030 | Train Acc: 0.8381
 Site-USPS                     | Train Loss: 0.7963 | Train Acc: 0.8442
 Site-USPS                     | Train Loss: 0.7839 | Train Acc: 0.8307
 Site-SynthDigits              | Train Loss: 1.7144 | Train Acc: 0.4560
 Site-SynthDigits              | Train Loss: 1.6823 | Train Acc: 0.4861
 Site-MNIST-M                  | Train Loss: 1.9378 | Train Acc: 0.3991
 Site-MNIST-M                  | Train Loss: 1.9418 | Train Acc: 0.3822
 Site-SVHN                     | Train Loss: 2.0692 | Train Acc: 0.2862
 Site-MNIST                         | Val  Loss: 0.9203 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.9093 | Val  Acc: 0.7811
 Site-MNIST                         | Val  Loss: 0.8445 | Val  Acc: 0.8340
 Site-MNIST                         | Val  Loss: 0.9067 | Val  Acc: 0.8211
 Site-MNIST                         | Val  Loss: 0.9270 | Val  Acc: 0.8123
 Site-USPS                          | Val  Loss: 0.7478 | Val  Acc: 0.8510
 Site-USPS                          | Val  Loss: 0.8180 | Val  Acc: 0.8045
 Site-USPS                          | Val  Loss: 0.8025 | Val  Acc: 0.8486
 Site-SynthDigits                   | Val  Loss: 1.6783 | Val  Acc: 0.5227
 Site-SynthDigits                   | Val  Loss: 1.6869 | Val  Acc: 0.4722
 Site-MNIST-M                       | Val  Loss: 1.9936 | Val  Acc: 0.3977
 Site-MNIST-M                       | Val  Loss: 1.9644 | Val  Acc: 0.3939
 Site-SVHN                          | Val  Loss: 2.0537 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6670
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.7811
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8340
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8211
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8123
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8510
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8045
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8486
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5227
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.4722
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.3977
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.3939
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.3106
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 32 ============
denominator: 16700.5234375
 Site-MNIST                    | Train Loss: 0.7861 | Train Acc: 0.8448
 Site-MNIST                    | Train Loss: 0.9162 | Train Acc: 0.8107
 Site-MNIST                    | Train Loss: 0.8432 | Train Acc: 0.8296
 Site-MNIST                    | Train Loss: 0.8602 | Train Acc: 0.8272
 Site-MNIST                    | Train Loss: 0.8653 | Train Acc: 0.8170
 Site-USPS                     | Train Loss: 0.7766 | Train Acc: 0.8453
 Site-USPS                     | Train Loss: 0.7682 | Train Acc: 0.8427
 Site-USPS                     | Train Loss: 0.7658 | Train Acc: 0.8328
 Site-SynthDigits              | Train Loss: 1.6828 | Train Acc: 0.4645
 Site-SynthDigits              | Train Loss: 1.6620 | Train Acc: 0.4968
 Site-MNIST-M                  | Train Loss: 1.9342 | Train Acc: 0.4048
 Site-MNIST-M                  | Train Loss: 1.9398 | Train Acc: 0.3888
 Site-SVHN                     | Train Loss: 2.0549 | Train Acc: 0.2964
 Site-MNIST                         | Val  Loss: 0.8976 | Val  Acc: 0.8304
 Site-MNIST                         | Val  Loss: 0.8927 | Val  Acc: 0.7692
 Site-MNIST                         | Val  Loss: 0.8331 | Val  Acc: 0.8221
 Site-MNIST                         | Val  Loss: 0.8885 | Val  Acc: 0.8237
 Site-MNIST                         | Val  Loss: 0.9108 | Val  Acc: 0.8123
 Site-USPS                          | Val  Loss: 0.7330 | Val  Acc: 0.8413
 Site-USPS                          | Val  Loss: 0.8035 | Val  Acc: 0.8013
 Site-USPS                          | Val  Loss: 0.7874 | Val  Acc: 0.8486
 Site-SynthDigits                   | Val  Loss: 1.6580 | Val  Acc: 0.5492
 Site-SynthDigits                   | Val  Loss: 1.6644 | Val  Acc: 0.4975
 Site-MNIST-M                       | Val  Loss: 1.9962 | Val  Acc: 0.3977
 Site-MNIST-M                       | Val  Loss: 1.9545 | Val  Acc: 0.4091
 Site-SVHN                          | Val  Loss: 2.0395 | Val  Acc: 0.3208
Average Valid Accuracy: 0.6710
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8304
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.7692
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8221
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8237
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8123
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8413
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8013
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8486
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.5492
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.4975
 Best site-MNIST-M                   | Epoch:32 | Val Acc: 0.3977
 Best site-MNIST-M                   | Epoch:32 | Val Acc: 0.4091
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.3208
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 33 ============
denominator: 16578.958984375
 Site-MNIST                    | Train Loss: 0.7712 | Train Acc: 0.8359
 Site-MNIST                    | Train Loss: 0.8879 | Train Acc: 0.8210
 Site-MNIST                    | Train Loss: 0.8321 | Train Acc: 0.8374
 Site-MNIST                    | Train Loss: 0.8496 | Train Acc: 0.8331
 Site-MNIST                    | Train Loss: 0.8539 | Train Acc: 0.8187
 Site-USPS                     | Train Loss: 0.7666 | Train Acc: 0.8477
 Site-USPS                     | Train Loss: 0.7208 | Train Acc: 0.8538
 Site-USPS                     | Train Loss: 0.7168 | Train Acc: 0.8466
 Site-SynthDigits              | Train Loss: 1.6601 | Train Acc: 0.4749
 Site-SynthDigits              | Train Loss: 1.6488 | Train Acc: 0.4924
 Site-MNIST-M                  | Train Loss: 1.9179 | Train Acc: 0.4091
 Site-MNIST-M                  | Train Loss: 1.9045 | Train Acc: 0.3860
 Site-SVHN                     | Train Loss: 2.0508 | Train Acc: 0.2947
 Site-MNIST                         | Val  Loss: 0.8897 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.8804 | Val  Acc: 0.7870
 Site-MNIST                         | Val  Loss: 0.8175 | Val  Acc: 0.8419
 Site-MNIST                         | Val  Loss: 0.8773 | Val  Acc: 0.8342
 Site-MNIST                         | Val  Loss: 0.8988 | Val  Acc: 0.8193
 Site-USPS                          | Val  Loss: 0.6798 | Val  Acc: 0.8606
 Site-USPS                          | Val  Loss: 0.7527 | Val  Acc: 0.8237
 Site-USPS                          | Val  Loss: 0.7403 | Val  Acc: 0.8571
 Site-SynthDigits                   | Val  Loss: 1.6415 | Val  Acc: 0.5455
 Site-SynthDigits                   | Val  Loss: 1.6497 | Val  Acc: 0.4899
 Site-MNIST-M                       | Val  Loss: 1.9807 | Val  Acc: 0.4205
 Site-MNIST-M                       | Val  Loss: 1.9444 | Val  Acc: 0.4091
 Site-SVHN                          | Val  Loss: 2.0303 | Val  Acc: 0.3208
Average Valid Accuracy: 0.6807
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8393
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.7870
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8419
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8342
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8193
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8606
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8237
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8571
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.5455
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.4899
 Best site-MNIST-M                   | Epoch:33 | Val Acc: 0.4205
 Best site-MNIST-M                   | Epoch:33 | Val Acc: 0.4091
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.3208
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 34 ============
denominator: 16380.779296875
 Site-MNIST                    | Train Loss: 0.7749 | Train Acc: 0.8448
 Site-MNIST                    | Train Loss: 0.8438 | Train Acc: 0.8328
 Site-MNIST                    | Train Loss: 0.7880 | Train Acc: 0.8424
 Site-MNIST                    | Train Loss: 0.8066 | Train Acc: 0.8390
 Site-MNIST                    | Train Loss: 0.8121 | Train Acc: 0.8284
 Site-USPS                     | Train Loss: 0.7827 | Train Acc: 0.8525
 Site-USPS                     | Train Loss: 0.7426 | Train Acc: 0.8490
 Site-USPS                     | Train Loss: 0.7290 | Train Acc: 0.8413
 Site-SynthDigits              | Train Loss: 1.6407 | Train Acc: 0.4607
 Site-SynthDigits              | Train Loss: 1.6519 | Train Acc: 0.5000
 Site-MNIST-M                  | Train Loss: 1.9183 | Train Acc: 0.4119
 Site-MNIST-M                  | Train Loss: 1.8822 | Train Acc: 0.3888
 Site-SVHN                     | Train Loss: 2.0566 | Train Acc: 0.2853
 Site-MNIST                         | Val  Loss: 0.8374 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.8384 | Val  Acc: 0.7870
 Site-MNIST                         | Val  Loss: 0.7778 | Val  Acc: 0.8498
 Site-MNIST                         | Val  Loss: 0.8374 | Val  Acc: 0.8447
 Site-MNIST                         | Val  Loss: 0.8552 | Val  Acc: 0.8316
 Site-USPS                          | Val  Loss: 0.6967 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.7684 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.7514 | Val  Acc: 0.8550
 Site-SynthDigits                   | Val  Loss: 1.6450 | Val  Acc: 0.5379
 Site-SynthDigits                   | Val  Loss: 1.6530 | Val  Acc: 0.4874
 Site-MNIST-M                       | Val  Loss: 1.9736 | Val  Acc: 0.3920
 Site-MNIST-M                       | Val  Loss: 1.9460 | Val  Acc: 0.4091
 Site-SVHN                          | Val  Loss: 2.0390 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6759
============ Train epoch 35 ============
denominator: 16158.8564453125
 Site-MNIST                    | Train Loss: 0.7414 | Train Acc: 0.8426
 Site-MNIST                    | Train Loss: 0.8644 | Train Acc: 0.8225
 Site-MNIST                    | Train Loss: 0.7925 | Train Acc: 0.8394
 Site-MNIST                    | Train Loss: 0.8106 | Train Acc: 0.8331
 Site-MNIST                    | Train Loss: 0.8180 | Train Acc: 0.8240
 Site-USPS                     | Train Loss: 0.7586 | Train Acc: 0.8429
 Site-USPS                     | Train Loss: 0.7127 | Train Acc: 0.8442
 Site-USPS                     | Train Loss: 0.7216 | Train Acc: 0.8376
 Site-SynthDigits              | Train Loss: 1.6562 | Train Acc: 0.4683
 Site-SynthDigits              | Train Loss: 1.6308 | Train Acc: 0.5032
 Site-MNIST-M                  | Train Loss: 1.9016 | Train Acc: 0.4233
 Site-MNIST-M                  | Train Loss: 1.8995 | Train Acc: 0.3964
 Site-SVHN                     | Train Loss: 2.0454 | Train Acc: 0.2990
 Site-MNIST                         | Val  Loss: 0.8458 | Val  Acc: 0.8304
 Site-MNIST                         | Val  Loss: 0.8419 | Val  Acc: 0.7929
 Site-MNIST                         | Val  Loss: 0.7803 | Val  Acc: 0.8458
 Site-MNIST                         | Val  Loss: 0.8397 | Val  Acc: 0.8421
 Site-MNIST                         | Val  Loss: 0.8612 | Val  Acc: 0.8228
 Site-USPS                          | Val  Loss: 0.6853 | Val  Acc: 0.8413
 Site-USPS                          | Val  Loss: 0.7578 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.7422 | Val  Acc: 0.8465
 Site-SynthDigits                   | Val  Loss: 1.6200 | Val  Acc: 0.5492
 Site-SynthDigits                   | Val  Loss: 1.6310 | Val  Acc: 0.4874
 Site-MNIST-M                       | Val  Loss: 1.9625 | Val  Acc: 0.4148
 Site-MNIST-M                       | Val  Loss: 1.9285 | Val  Acc: 0.4280
 Site-SVHN                          | Val  Loss: 2.0244 | Val  Acc: 0.3311
Average Valid Accuracy: 0.6800
============ Train epoch 36 ============
denominator: 15977.619140625
 Site-MNIST                    | Train Loss: 0.7387 | Train Acc: 0.8514
 Site-MNIST                    | Train Loss: 0.8574 | Train Acc: 0.8284
 Site-MNIST                    | Train Loss: 0.7660 | Train Acc: 0.8355
 Site-MNIST                    | Train Loss: 0.7878 | Train Acc: 0.8331
 Site-MNIST                    | Train Loss: 0.7916 | Train Acc: 0.8240
 Site-USPS                     | Train Loss: 0.7537 | Train Acc: 0.8357
 Site-USPS                     | Train Loss: 0.7574 | Train Acc: 0.8450
 Site-USPS                     | Train Loss: 0.7409 | Train Acc: 0.8323
 Site-SynthDigits              | Train Loss: 1.6568 | Train Acc: 0.4664
 Site-SynthDigits              | Train Loss: 1.6230 | Train Acc: 0.5069
 Site-MNIST-M                  | Train Loss: 1.8843 | Train Acc: 0.4361
 Site-MNIST-M                  | Train Loss: 1.8894 | Train Acc: 0.4163
 Site-SVHN                     | Train Loss: 2.0469 | Train Acc: 0.2922
 Site-MNIST                         | Val  Loss: 0.8095 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.8169 | Val  Acc: 0.7870
 Site-MNIST                         | Val  Loss: 0.7581 | Val  Acc: 0.8340
 Site-MNIST                         | Val  Loss: 0.8156 | Val  Acc: 0.8289
 Site-MNIST                         | Val  Loss: 0.8342 | Val  Acc: 0.8281
 Site-USPS                          | Val  Loss: 0.7095 | Val  Acc: 0.8413
 Site-USPS                          | Val  Loss: 0.7828 | Val  Acc: 0.7949
 Site-USPS                          | Val  Loss: 0.7587 | Val  Acc: 0.8422
 Site-SynthDigits                   | Val  Loss: 1.6145 | Val  Acc: 0.5303
 Site-SynthDigits                   | Val  Loss: 1.6260 | Val  Acc: 0.4773
 Site-MNIST-M                       | Val  Loss: 1.9471 | Val  Acc: 0.4261
 Site-MNIST-M                       | Val  Loss: 1.9156 | Val  Acc: 0.4318
 Site-SVHN                          | Val  Loss: 2.0230 | Val  Acc: 0.3208
Average Valid Accuracy: 0.6755
============ Train epoch 37 ============
denominator: 15954.279296875
 Site-MNIST                    | Train Loss: 0.7099 | Train Acc: 0.8514
 Site-MNIST                    | Train Loss: 0.8228 | Train Acc: 0.8388
 Site-MNIST                    | Train Loss: 0.7507 | Train Acc: 0.8443
 Site-MNIST                    | Train Loss: 0.7722 | Train Acc: 0.8482
 Site-MNIST                    | Train Loss: 0.7820 | Train Acc: 0.8314
 Site-USPS                     | Train Loss: 0.7071 | Train Acc: 0.8537
 Site-USPS                     | Train Loss: 0.6698 | Train Acc: 0.8514
 Site-USPS                     | Train Loss: 0.6789 | Train Acc: 0.8498
 Site-SynthDigits              | Train Loss: 1.6465 | Train Acc: 0.4749
 Site-SynthDigits              | Train Loss: 1.6176 | Train Acc: 0.5076
 Site-MNIST-M                  | Train Loss: 1.8952 | Train Acc: 0.4261
 Site-MNIST-M                  | Train Loss: 1.8826 | Train Acc: 0.3955
 Site-SVHN                     | Train Loss: 2.0414 | Train Acc: 0.2922
 Site-MNIST                         | Val  Loss: 0.8041 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.8029 | Val  Acc: 0.7988
 Site-MNIST                         | Val  Loss: 0.7400 | Val  Acc: 0.8458
 Site-MNIST                         | Val  Loss: 0.8000 | Val  Acc: 0.8474
 Site-MNIST                         | Val  Loss: 0.8206 | Val  Acc: 0.8386
 Site-USPS                          | Val  Loss: 0.6476 | Val  Acc: 0.8558
 Site-USPS                          | Val  Loss: 0.7201 | Val  Acc: 0.8109
 Site-USPS                          | Val  Loss: 0.7032 | Val  Acc: 0.8550
 Site-SynthDigits                   | Val  Loss: 1.6111 | Val  Acc: 0.5417
 Site-SynthDigits                   | Val  Loss: 1.6179 | Val  Acc: 0.5051
 Site-MNIST-M                       | Val  Loss: 1.9554 | Val  Acc: 0.4148
 Site-MNIST-M                       | Val  Loss: 1.9235 | Val  Acc: 0.4280
 Site-SVHN                          | Val  Loss: 2.0203 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6852
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8482
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.7988
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8458
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8474
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8386
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8558
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8109
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8550
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.5417
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.5051
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.4148
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.4280
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.3174
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 38 ============
denominator: 15718.275390625
 Site-MNIST                    | Train Loss: 0.6726 | Train Acc: 0.8581
 Site-MNIST                    | Train Loss: 0.8116 | Train Acc: 0.8417
 Site-MNIST                    | Train Loss: 0.7323 | Train Acc: 0.8443
 Site-MNIST                    | Train Loss: 0.7536 | Train Acc: 0.8443
 Site-MNIST                    | Train Loss: 0.7603 | Train Acc: 0.8319
 Site-USPS                     | Train Loss: 0.7260 | Train Acc: 0.8501
 Site-USPS                     | Train Loss: 0.6812 | Train Acc: 0.8498
 Site-USPS                     | Train Loss: 0.6863 | Train Acc: 0.8435
 Site-SynthDigits              | Train Loss: 1.6419 | Train Acc: 0.4768
 Site-SynthDigits              | Train Loss: 1.6009 | Train Acc: 0.5126
 Site-MNIST-M                  | Train Loss: 1.8741 | Train Acc: 0.4375
 Site-MNIST-M                  | Train Loss: 1.8830 | Train Acc: 0.4182
 Site-SVHN                     | Train Loss: 2.0377 | Train Acc: 0.2939
 Site-MNIST                         | Val  Loss: 0.7686 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.7784 | Val  Acc: 0.7929
 Site-MNIST                         | Val  Loss: 0.7229 | Val  Acc: 0.8538
 Site-MNIST                         | Val  Loss: 0.7789 | Val  Acc: 0.8447
 Site-MNIST                         | Val  Loss: 0.7984 | Val  Acc: 0.8386
 Site-USPS                          | Val  Loss: 0.6531 | Val  Acc: 0.8510
 Site-USPS                          | Val  Loss: 0.7268 | Val  Acc: 0.8045
 Site-USPS                          | Val  Loss: 0.7074 | Val  Acc: 0.8507
 Site-SynthDigits                   | Val  Loss: 1.5906 | Val  Acc: 0.5455
 Site-SynthDigits                   | Val  Loss: 1.6014 | Val  Acc: 0.5051
 Site-MNIST-M                       | Val  Loss: 1.9383 | Val  Acc: 0.4261
 Site-MNIST-M                       | Val  Loss: 1.9048 | Val  Acc: 0.4318
 Site-SVHN                          | Val  Loss: 2.0115 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6845
============ Train epoch 39 ============
denominator: 15702.0634765625
 Site-MNIST                    | Train Loss: 0.7198 | Train Acc: 0.8537
 Site-MNIST                    | Train Loss: 0.7927 | Train Acc: 0.8358
 Site-MNIST                    | Train Loss: 0.7392 | Train Acc: 0.8473
 Site-MNIST                    | Train Loss: 0.7595 | Train Acc: 0.8449
 Site-MNIST                    | Train Loss: 0.7653 | Train Acc: 0.8345
 Site-USPS                     | Train Loss: 0.7276 | Train Acc: 0.8525
 Site-USPS                     | Train Loss: 0.6946 | Train Acc: 0.8522
 Site-USPS                     | Train Loss: 0.6855 | Train Acc: 0.8477
 Site-SynthDigits              | Train Loss: 1.5717 | Train Acc: 0.5052
 Site-SynthDigits              | Train Loss: 1.5543 | Train Acc: 0.5372
 Site-MNIST-M                  | Train Loss: 1.8774 | Train Acc: 0.4148
 Site-MNIST-M                  | Train Loss: 1.8786 | Train Acc: 0.3955
 Site-SVHN                     | Train Loss: 2.0115 | Train Acc: 0.3024
 Site-MNIST                         | Val  Loss: 0.7876 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.7895 | Val  Acc: 0.7870
 Site-MNIST                         | Val  Loss: 0.7304 | Val  Acc: 0.8379
 Site-MNIST                         | Val  Loss: 0.7789 | Val  Acc: 0.8368
 Site-MNIST                         | Val  Loss: 0.8032 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.6562 | Val  Acc: 0.8558
 Site-USPS                          | Val  Loss: 0.7290 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.7098 | Val  Acc: 0.8614
 Site-SynthDigits                   | Val  Loss: 1.5590 | Val  Acc: 0.5530
 Site-SynthDigits                   | Val  Loss: 1.5599 | Val  Acc: 0.5379
 Site-MNIST-M                       | Val  Loss: 1.9584 | Val  Acc: 0.4091
 Site-MNIST-M                       | Val  Loss: 1.8975 | Val  Acc: 0.4280
 Site-SVHN                          | Val  Loss: 1.9842 | Val  Acc: 0.3379
Average Valid Accuracy: 0.6879
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.7870
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8379
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8368
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8333
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8558
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8077
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8614
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.5530
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.5379
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.4091
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.4280
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.3379
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
 Test site-MNIST                     | Epoch:39 | Test Acc: 0.8389
 Test site-USPS                      | Epoch:39 | Test Acc: 0.8516
 Test site-SynthDigits               | Epoch:39 | Test Acc: 0.5213
 Test site-MNIST-M                   | Epoch:39 | Test Acc: 0.3921
 Test site-SVHN                      | Epoch:39 | Test Acc: 0.2877
MNIST: 0.839, USPS: 0.852, SynthDigits: 0.521, MNIST-M: 0.392, SVHN: 0.288, 
Average Test Accuracy: 0.5783, domain std=0.2302, cluster std=-1.0000, individual std=0.2121, 
============ Train epoch 40 ============
denominator: 15395.888671875
 Site-MNIST                    | Train Loss: 0.7302 | Train Acc: 0.8537
 Site-MNIST                    | Train Loss: 0.7779 | Train Acc: 0.8358
 Site-MNIST                    | Train Loss: 0.7095 | Train Acc: 0.8453
 Site-MNIST                    | Train Loss: 0.7307 | Train Acc: 0.8463
 Site-MNIST                    | Train Loss: 0.7358 | Train Acc: 0.8319
 Site-USPS                     | Train Loss: 0.7290 | Train Acc: 0.8537
 Site-USPS                     | Train Loss: 0.6971 | Train Acc: 0.8498
 Site-USPS                     | Train Loss: 0.6800 | Train Acc: 0.8403
 Site-SynthDigits              | Train Loss: 1.5902 | Train Acc: 0.4768
 Site-SynthDigits              | Train Loss: 1.5828 | Train Acc: 0.5240
 Site-MNIST-M                  | Train Loss: 1.8470 | Train Acc: 0.4489
 Site-MNIST-M                  | Train Loss: 1.8543 | Train Acc: 0.4267
 Site-SVHN                     | Train Loss: 2.0302 | Train Acc: 0.2947
 Site-MNIST                         | Val  Loss: 0.7463 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.7559 | Val  Acc: 0.8107
 Site-MNIST                         | Val  Loss: 0.7019 | Val  Acc: 0.8538
 Site-MNIST                         | Val  Loss: 0.7556 | Val  Acc: 0.8421
 Site-MNIST                         | Val  Loss: 0.7769 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.6444 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.7191 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.6964 | Val  Acc: 0.8571
 Site-SynthDigits                   | Val  Loss: 1.5675 | Val  Acc: 0.5341
 Site-SynthDigits                   | Val  Loss: 1.5799 | Val  Acc: 0.4899
 Site-MNIST-M                       | Val  Loss: 1.9182 | Val  Acc: 0.4261
 Site-MNIST-M                       | Val  Loss: 1.8808 | Val  Acc: 0.4432
 Site-SVHN                          | Val  Loss: 2.0026 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6851
============ Train epoch 41 ============
denominator: 15217.20703125
 Site-MNIST                    | Train Loss: 0.6869 | Train Acc: 0.8581
 Site-MNIST                    | Train Loss: 0.7646 | Train Acc: 0.8358
 Site-MNIST                    | Train Loss: 0.7046 | Train Acc: 0.8443
 Site-MNIST                    | Train Loss: 0.7245 | Train Acc: 0.8449
 Site-MNIST                    | Train Loss: 0.7306 | Train Acc: 0.8345
 Site-USPS                     | Train Loss: 0.6972 | Train Acc: 0.8537
 Site-USPS                     | Train Loss: 0.6519 | Train Acc: 0.8522
 Site-USPS                     | Train Loss: 0.6548 | Train Acc: 0.8456
 Site-SynthDigits              | Train Loss: 1.5694 | Train Acc: 0.4872
 Site-SynthDigits              | Train Loss: 1.5672 | Train Acc: 0.5240
 Site-MNIST-M                  | Train Loss: 1.8565 | Train Acc: 0.4361
 Site-MNIST-M                  | Train Loss: 1.8476 | Train Acc: 0.4238
 Site-SVHN                     | Train Loss: 2.0199 | Train Acc: 0.2990
 Site-MNIST                         | Val  Loss: 0.7341 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.7497 | Val  Acc: 0.7988
 Site-MNIST                         | Val  Loss: 0.6995 | Val  Acc: 0.8498
 Site-MNIST                         | Val  Loss: 0.7491 | Val  Acc: 0.8447
 Site-MNIST                         | Val  Loss: 0.7690 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.6245 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.6970 | Val  Acc: 0.8045
 Site-USPS                          | Val  Loss: 0.6768 | Val  Acc: 0.8507
 Site-SynthDigits                   | Val  Loss: 1.5593 | Val  Acc: 0.5379
 Site-SynthDigits                   | Val  Loss: 1.5709 | Val  Acc: 0.5051
 Site-MNIST-M                       | Val  Loss: 1.9313 | Val  Acc: 0.4148
 Site-MNIST-M                       | Val  Loss: 1.8839 | Val  Acc: 0.4394
 Site-SVHN                          | Val  Loss: 1.9925 | Val  Acc: 0.3242
Average Valid Accuracy: 0.6844
============ Train epoch 42 ============
denominator: 15154.2919921875
 Site-MNIST                    | Train Loss: 0.6507 | Train Acc: 0.8514
 Site-MNIST                    | Train Loss: 0.7432 | Train Acc: 0.8476
 Site-MNIST                    | Train Loss: 0.6764 | Train Acc: 0.8601
 Site-MNIST                    | Train Loss: 0.6988 | Train Acc: 0.8561
 Site-MNIST                    | Train Loss: 0.7046 | Train Acc: 0.8433
 Site-USPS                     | Train Loss: 0.7053 | Train Acc: 0.8549
 Site-USPS                     | Train Loss: 0.6516 | Train Acc: 0.8546
 Site-USPS                     | Train Loss: 0.6627 | Train Acc: 0.8466
 Site-SynthDigits              | Train Loss: 1.6187 | Train Acc: 0.4939
 Site-SynthDigits              | Train Loss: 1.5598 | Train Acc: 0.5315
 Site-MNIST-M                  | Train Loss: 1.8391 | Train Acc: 0.4432
 Site-MNIST-M                  | Train Loss: 1.8466 | Train Acc: 0.4333
 Site-SVHN                     | Train Loss: 2.0153 | Train Acc: 0.2947
 Site-MNIST                         | Val  Loss: 0.7107 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.7196 | Val  Acc: 0.8343
 Site-MNIST                         | Val  Loss: 0.6658 | Val  Acc: 0.8775
 Site-MNIST                         | Val  Loss: 0.7198 | Val  Acc: 0.8632
 Site-MNIST                         | Val  Loss: 0.7416 | Val  Acc: 0.8474
 Site-USPS                          | Val  Loss: 0.6311 | Val  Acc: 0.8558
 Site-USPS                          | Val  Loss: 0.7039 | Val  Acc: 0.8205
 Site-USPS                          | Val  Loss: 0.6801 | Val  Acc: 0.8593
 Site-SynthDigits                   | Val  Loss: 1.5496 | Val  Acc: 0.5530
 Site-SynthDigits                   | Val  Loss: 1.5570 | Val  Acc: 0.5126
 Site-MNIST-M                       | Val  Loss: 1.9127 | Val  Acc: 0.4489
 Site-MNIST-M                       | Val  Loss: 1.8687 | Val  Acc: 0.4470
 Site-SVHN                          | Val  Loss: 1.9852 | Val  Acc: 0.3311
Average Valid Accuracy: 0.6999
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8482
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8343
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8775
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8632
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8474
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8558
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8205
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8593
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.5530
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.5126
 Best site-MNIST-M                   | Epoch:42 | Val Acc: 0.4489
 Best site-MNIST-M                   | Epoch:42 | Val Acc: 0.4470
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.3311
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 43 ============
denominator: 15100.0458984375
 Site-MNIST                    | Train Loss: 0.6764 | Train Acc: 0.8404
 Site-MNIST                    | Train Loss: 0.7681 | Train Acc: 0.8328
 Site-MNIST                    | Train Loss: 0.6966 | Train Acc: 0.8483
 Site-MNIST                    | Train Loss: 0.7159 | Train Acc: 0.8384
 Site-MNIST                    | Train Loss: 0.7197 | Train Acc: 0.8327
 Site-USPS                     | Train Loss: 0.6555 | Train Acc: 0.8585
 Site-USPS                     | Train Loss: 0.6246 | Train Acc: 0.8562
 Site-USPS                     | Train Loss: 0.6303 | Train Acc: 0.8520
 Site-SynthDigits              | Train Loss: 1.5991 | Train Acc: 0.4920
 Site-SynthDigits              | Train Loss: 1.5454 | Train Acc: 0.5303
 Site-MNIST-M                  | Train Loss: 1.8308 | Train Acc: 0.4531
 Site-MNIST-M                  | Train Loss: 1.8462 | Train Acc: 0.4314
 Site-SVHN                     | Train Loss: 2.0073 | Train Acc: 0.2998
 Site-MNIST                         | Val  Loss: 0.7138 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.7376 | Val  Acc: 0.8047
 Site-MNIST                         | Val  Loss: 0.6955 | Val  Acc: 0.8498
 Site-MNIST                         | Val  Loss: 0.7375 | Val  Acc: 0.8395
 Site-MNIST                         | Val  Loss: 0.7566 | Val  Acc: 0.8281
 Site-USPS                          | Val  Loss: 0.5985 | Val  Acc: 0.8558
 Site-USPS                          | Val  Loss: 0.6717 | Val  Acc: 0.8109
 Site-USPS                          | Val  Loss: 0.6504 | Val  Acc: 0.8593
 Site-SynthDigits                   | Val  Loss: 1.5344 | Val  Acc: 0.5379
 Site-SynthDigits                   | Val  Loss: 1.5461 | Val  Acc: 0.5126
 Site-MNIST-M                       | Val  Loss: 1.9135 | Val  Acc: 0.4489
 Site-MNIST-M                       | Val  Loss: 1.8611 | Val  Acc: 0.4508
 Site-SVHN                          | Val  Loss: 1.9757 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6910
============ Train epoch 44 ============
denominator: 15061.73828125
 Site-MNIST                    | Train Loss: 0.6169 | Train Acc: 0.8603
 Site-MNIST                    | Train Loss: 0.7128 | Train Acc: 0.8491
 Site-MNIST                    | Train Loss: 0.6608 | Train Acc: 0.8542
 Site-MNIST                    | Train Loss: 0.6848 | Train Acc: 0.8515
 Site-MNIST                    | Train Loss: 0.6907 | Train Acc: 0.8419
 Site-USPS                     | Train Loss: 0.6633 | Train Acc: 0.8585
 Site-USPS                     | Train Loss: 0.6384 | Train Acc: 0.8586
 Site-USPS                     | Train Loss: 0.6397 | Train Acc: 0.8514
 Site-SynthDigits              | Train Loss: 1.5389 | Train Acc: 0.5033
 Site-SynthDigits              | Train Loss: 1.5358 | Train Acc: 0.5347
 Site-MNIST-M                  | Train Loss: 1.8314 | Train Acc: 0.4460
 Site-MNIST-M                  | Train Loss: 1.8310 | Train Acc: 0.4229
 Site-SVHN                     | Train Loss: 2.0082 | Train Acc: 0.2939
 Site-MNIST                         | Val  Loss: 0.6870 | Val  Acc: 0.8482
 Site-MNIST                         | Val  Loss: 0.7020 | Val  Acc: 0.8107
 Site-MNIST                         | Val  Loss: 0.6524 | Val  Acc: 0.8656
 Site-MNIST                         | Val  Loss: 0.7025 | Val  Acc: 0.8526
 Site-MNIST                         | Val  Loss: 0.7262 | Val  Acc: 0.8421
 Site-USPS                          | Val  Loss: 0.6065 | Val  Acc: 0.8606
 Site-USPS                          | Val  Loss: 0.6795 | Val  Acc: 0.8237
 Site-USPS                          | Val  Loss: 0.6586 | Val  Acc: 0.8635
 Site-SynthDigits                   | Val  Loss: 1.5226 | Val  Acc: 0.5568
 Site-SynthDigits                   | Val  Loss: 1.5330 | Val  Acc: 0.5202
 Site-MNIST-M                       | Val  Loss: 1.9168 | Val  Acc: 0.4318
 Site-MNIST-M                       | Val  Loss: 1.8661 | Val  Acc: 0.4432
 Site-SVHN                          | Val  Loss: 1.9747 | Val  Acc: 0.3379
Average Valid Accuracy: 0.6967
============ Train epoch 45 ============
denominator: 14772.353515625
 Site-MNIST                    | Train Loss: 0.6214 | Train Acc: 0.8492
 Site-MNIST                    | Train Loss: 0.7485 | Train Acc: 0.8462
 Site-MNIST                    | Train Loss: 0.6721 | Train Acc: 0.8483
 Site-MNIST                    | Train Loss: 0.6915 | Train Acc: 0.8456
 Site-MNIST                    | Train Loss: 0.6974 | Train Acc: 0.8371
 Site-USPS                     | Train Loss: 0.6713 | Train Acc: 0.8609
 Site-USPS                     | Train Loss: 0.6086 | Train Acc: 0.8626
 Site-USPS                     | Train Loss: 0.6064 | Train Acc: 0.8584
 Site-SynthDigits              | Train Loss: 1.5668 | Train Acc: 0.4834
 Site-SynthDigits              | Train Loss: 1.5350 | Train Acc: 0.5366
 Site-MNIST-M                  | Train Loss: 1.8150 | Train Acc: 0.4602
 Site-MNIST-M                  | Train Loss: 1.7814 | Train Acc: 0.4295
 Site-SVHN                     | Train Loss: 2.0028 | Train Acc: 0.2998
 Site-MNIST                         | Val  Loss: 0.6905 | Val  Acc: 0.8661
 Site-MNIST                         | Val  Loss: 0.7140 | Val  Acc: 0.8047
 Site-MNIST                         | Val  Loss: 0.6700 | Val  Acc: 0.8379
 Site-MNIST                         | Val  Loss: 0.7125 | Val  Acc: 0.8474
 Site-MNIST                         | Val  Loss: 0.7316 | Val  Acc: 0.8368
 Site-USPS                          | Val  Loss: 0.5728 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.6489 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.6252 | Val  Acc: 0.8571
 Site-SynthDigits                   | Val  Loss: 1.5217 | Val  Acc: 0.5341
 Site-SynthDigits                   | Val  Loss: 1.5360 | Val  Acc: 0.5025
 Site-MNIST-M                       | Val  Loss: 1.8969 | Val  Acc: 0.4432
 Site-MNIST-M                       | Val  Loss: 1.8487 | Val  Acc: 0.4697
 Site-SVHN                          | Val  Loss: 1.9733 | Val  Acc: 0.3242
Average Valid Accuracy: 0.6943
============ Train epoch 46 ============
denominator: 14576.3515625
 Site-MNIST                    | Train Loss: 0.6117 | Train Acc: 0.8559
 Site-MNIST                    | Train Loss: 0.7210 | Train Acc: 0.8432
 Site-MNIST                    | Train Loss: 0.6407 | Train Acc: 0.8542
 Site-MNIST                    | Train Loss: 0.6610 | Train Acc: 0.8522
 Site-MNIST                    | Train Loss: 0.6669 | Train Acc: 0.8415
 Site-USPS                     | Train Loss: 0.6764 | Train Acc: 0.8501
 Site-USPS                     | Train Loss: 0.6476 | Train Acc: 0.8498
 Site-USPS                     | Train Loss: 0.6526 | Train Acc: 0.8435
 Site-SynthDigits              | Train Loss: 1.5670 | Train Acc: 0.4891
 Site-SynthDigits              | Train Loss: 1.5430 | Train Acc: 0.5240
 Site-MNIST-M                  | Train Loss: 1.8111 | Train Acc: 0.4460
 Site-MNIST-M                  | Train Loss: 1.8064 | Train Acc: 0.4456
 Site-SVHN                     | Train Loss: 2.0213 | Train Acc: 0.2905
 Site-MNIST                         | Val  Loss: 0.6673 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.6781 | Val  Acc: 0.8166
 Site-MNIST                         | Val  Loss: 0.6284 | Val  Acc: 0.8656
 Site-MNIST                         | Val  Loss: 0.6849 | Val  Acc: 0.8500
 Site-MNIST                         | Val  Loss: 0.7053 | Val  Acc: 0.8404
 Site-USPS                          | Val  Loss: 0.6177 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.6943 | Val  Acc: 0.8205
 Site-USPS                          | Val  Loss: 0.6652 | Val  Acc: 0.8593
 Site-SynthDigits                   | Val  Loss: 1.5228 | Val  Acc: 0.5492
 Site-SynthDigits                   | Val  Loss: 1.5416 | Val  Acc: 0.5051
 Site-MNIST-M                       | Val  Loss: 1.8905 | Val  Acc: 0.4318
 Site-MNIST-M                       | Val  Loss: 1.8546 | Val  Acc: 0.4356
 Site-SVHN                          | Val  Loss: 1.9874 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6914
============ Train epoch 47 ============
denominator: 14780.498046875
 Site-MNIST                    | Train Loss: 0.6127 | Train Acc: 0.8537
 Site-MNIST                    | Train Loss: 0.7109 | Train Acc: 0.8447
 Site-MNIST                    | Train Loss: 0.6431 | Train Acc: 0.8601
 Site-MNIST                    | Train Loss: 0.6663 | Train Acc: 0.8482
 Site-MNIST                    | Train Loss: 0.6752 | Train Acc: 0.8489
 Site-USPS                     | Train Loss: 0.6153 | Train Acc: 0.8705
 Site-USPS                     | Train Loss: 0.5832 | Train Acc: 0.8730
 Site-USPS                     | Train Loss: 0.5830 | Train Acc: 0.8674
 Site-SynthDigits              | Train Loss: 1.5387 | Train Acc: 0.5109
 Site-SynthDigits              | Train Loss: 1.5080 | Train Acc: 0.5454
 Site-MNIST-M                  | Train Loss: 1.8116 | Train Acc: 0.4560
 Site-MNIST-M                  | Train Loss: 1.8096 | Train Acc: 0.4333
 Site-SVHN                     | Train Loss: 1.9905 | Train Acc: 0.2998
 Site-MNIST                         | Val  Loss: 0.6498 | Val  Acc: 0.8661
 Site-MNIST                         | Val  Loss: 0.6786 | Val  Acc: 0.8225
 Site-MNIST                         | Val  Loss: 0.6394 | Val  Acc: 0.8538
 Site-MNIST                         | Val  Loss: 0.6840 | Val  Acc: 0.8474
 Site-MNIST                         | Val  Loss: 0.7046 | Val  Acc: 0.8368
 Site-USPS                          | Val  Loss: 0.5471 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.6247 | Val  Acc: 0.8429
 Site-USPS                          | Val  Loss: 0.6084 | Val  Acc: 0.8742
 Site-SynthDigits                   | Val  Loss: 1.4939 | Val  Acc: 0.5417
 Site-SynthDigits                   | Val  Loss: 1.5018 | Val  Acc: 0.5278
 Site-MNIST-M                       | Val  Loss: 1.9028 | Val  Acc: 0.4318
 Site-MNIST-M                       | Val  Loss: 1.8379 | Val  Acc: 0.4583
 Site-SVHN                          | Val  Loss: 1.9559 | Val  Acc: 0.3379
Average Valid Accuracy: 0.7035
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.8661
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.8225
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.8538
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.8474
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.8368
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:47 | Val Acc: 0.8429
 Best site-USPS                      | Epoch:47 | Val Acc: 0.8742
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5417
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5278
 Best site-MNIST-M                   | Epoch:47 | Val Acc: 0.4318
 Best site-MNIST-M                   | Epoch:47 | Val Acc: 0.4583
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.3379
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 48 ============
denominator: 14520.8916015625
 Site-MNIST                    | Train Loss: 0.5942 | Train Acc: 0.8692
 Site-MNIST                    | Train Loss: 0.6834 | Train Acc: 0.8462
 Site-MNIST                    | Train Loss: 0.6174 | Train Acc: 0.8640
 Site-MNIST                    | Train Loss: 0.6388 | Train Acc: 0.8633
 Site-MNIST                    | Train Loss: 0.6490 | Train Acc: 0.8481
 Site-USPS                     | Train Loss: 0.6243 | Train Acc: 0.8645
 Site-USPS                     | Train Loss: 0.6064 | Train Acc: 0.8658
 Site-USPS                     | Train Loss: 0.6048 | Train Acc: 0.8546
 Site-SynthDigits              | Train Loss: 1.5991 | Train Acc: 0.4910
 Site-SynthDigits              | Train Loss: 1.5337 | Train Acc: 0.5359
 Site-MNIST-M                  | Train Loss: 1.8102 | Train Acc: 0.4517
 Site-MNIST-M                  | Train Loss: 1.8168 | Train Acc: 0.4352
 Site-SVHN                     | Train Loss: 2.0095 | Train Acc: 0.2913
 Site-MNIST                         | Val  Loss: 0.6425 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.6555 | Val  Acc: 0.8343
 Site-MNIST                         | Val  Loss: 0.6063 | Val  Acc: 0.8814
 Site-MNIST                         | Val  Loss: 0.6599 | Val  Acc: 0.8605
 Site-MNIST                         | Val  Loss: 0.6807 | Val  Acc: 0.8439
 Site-USPS                          | Val  Loss: 0.5694 | Val  Acc: 0.8702
 Site-USPS                          | Val  Loss: 0.6472 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 0.6220 | Val  Acc: 0.8699
 Site-SynthDigits                   | Val  Loss: 1.5083 | Val  Acc: 0.5568
 Site-SynthDigits                   | Val  Loss: 1.5258 | Val  Acc: 0.5177
 Site-MNIST-M                       | Val  Loss: 1.8707 | Val  Acc: 0.4432
 Site-MNIST-M                       | Val  Loss: 1.8572 | Val  Acc: 0.4470
 Site-SVHN                          | Val  Loss: 1.9775 | Val  Acc: 0.3140
Average Valid Accuracy: 0.7025
============ Train epoch 49 ============
denominator: 14392.8876953125
 Site-MNIST                    | Train Loss: 0.5824 | Train Acc: 0.8581
 Site-MNIST                    | Train Loss: 0.6734 | Train Acc: 0.8476
 Site-MNIST                    | Train Loss: 0.6266 | Train Acc: 0.8581
 Site-MNIST                    | Train Loss: 0.6457 | Train Acc: 0.8509
 Site-MNIST                    | Train Loss: 0.6530 | Train Acc: 0.8433
 Site-USPS                     | Train Loss: 0.6046 | Train Acc: 0.8621
 Site-USPS                     | Train Loss: 0.5785 | Train Acc: 0.8602
 Site-USPS                     | Train Loss: 0.5865 | Train Acc: 0.8541
 Site-SynthDigits              | Train Loss: 1.5343 | Train Acc: 0.4939
 Site-SynthDigits              | Train Loss: 1.5055 | Train Acc: 0.5378
 Site-MNIST-M                  | Train Loss: 1.7927 | Train Acc: 0.4631
 Site-MNIST-M                  | Train Loss: 1.7860 | Train Acc: 0.4456
 Site-SVHN                     | Train Loss: 1.9919 | Train Acc: 0.3007
 Site-MNIST                         | Val  Loss: 0.6452 | Val  Acc: 0.8661
 Site-MNIST                         | Val  Loss: 0.6653 | Val  Acc: 0.8166
 Site-MNIST                         | Val  Loss: 0.6207 | Val  Acc: 0.8577
 Site-MNIST                         | Val  Loss: 0.6652 | Val  Acc: 0.8579
 Site-MNIST                         | Val  Loss: 0.6873 | Val  Acc: 0.8439
 Site-USPS                          | Val  Loss: 0.5568 | Val  Acc: 0.8702
 Site-USPS                          | Val  Loss: 0.6292 | Val  Acc: 0.8237
 Site-USPS                          | Val  Loss: 0.6048 | Val  Acc: 0.8593
 Site-SynthDigits                   | Val  Loss: 1.4867 | Val  Acc: 0.5303
 Site-SynthDigits                   | Val  Loss: 1.5038 | Val  Acc: 0.5101
 Site-MNIST-M                       | Val  Loss: 1.8799 | Val  Acc: 0.4432
 Site-MNIST-M                       | Val  Loss: 1.8261 | Val  Acc: 0.4697
 Site-SVHN                          | Val  Loss: 1.9617 | Val  Acc: 0.3311
Average Valid Accuracy: 0.6984
===2023-06-04 06:45:41===
===2023-06-04 06:45:51===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[451,676,1015,1522,2284,834,1252,1878,1057,1586,704,1057,1174,
client_nums=[5,3,2,2,1,]
len_dataset=[7438,4958,3305,2203,1468,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:47 | Test Acc: 0.8544
 Test site-USPS                      | Epoch:47 | Test Acc: 0.8667
 Test site-SynthDigits               | Epoch:47 | Test Acc: 0.5267
 Test site-MNIST-M                   | Epoch:47 | Test Acc: 0.4141
 Test site-SVHN                      | Epoch:47 | Test Acc: 0.2914
MNIST: 0.854, USPS: 0.867, SynthDigits: 0.527, MNIST-M: 0.414, SVHN: 0.291, 
Average Test Accuracy: 0.5906, domain std=0.2326, cluster std=-1.0000, individual std=0.2135, 
===2023-06-07 20:32:37===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[451,676,1015,1522,2284,834,1252,1878,1057,1586,704,1057,1174,
client_nums=[5,3,2,2,1,]
len_dataset=[7438,4958,3305,2203,1468,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:47 | Test Acc: 0.8544
 Test site-USPS                      | Epoch:47 | Test Acc: 0.8667
 Test site-SynthDigits               | Epoch:47 | Test Acc: 0.5267
 Test site-MNIST-M                   | Epoch:47 | Test Acc: 0.4141
 Test site-MNIST-M                   | Epoch:47 | Test Acc: 0.4141
 Test site-SVHN                      | Epoch:47 | Test Acc: 0.2914
MNIST: 0.5608, USPS: 0.8667, SynthDigits: 0.5267, SVHN: 0.2914, 
Average Test Accuracy(group): 0.5614, Average Test Accuracy(individual): 0.6957,
domain std=0.2045, cluster std=-1.0000, individual std=0.2135, 
===2023-06-10 03:05:09===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[451,676,1015,1522,2284,834,1252,1878,1057,1586,704,1057,1174,
client_nums=[5,3,2,2,1,]
len_dataset=[7438,4958,3305,2203,1468,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:47 | Test Acc: 0.8544
 Test site-USPS                      | Epoch:47 | Test Acc: 0.8667
 Test site-SynthDigits               | Epoch:47 | Test Acc: 0.5267
 Test site-MNIST-M                   | Epoch:47 | Test Acc: 0.4141
 Test site-MNIST-M                   | Epoch:47 | Test Acc: 0.4141
 Test site-SVHN                      | Epoch:47 | Test Acc: 0.2914
MNIST: 0.5608, USPS: 0.8667, SynthDigits: 0.5267, SVHN: 0.2914, 
Average Test Accuracy(group): 0.5614, Average Test Accuracy(individual): 0.6957,
domain CV=0.3643, cluster CV=-1.0000, individual CV=0.3069, 

[5, 3, 2, 2, 1]
mean_domain: 0.5907, mean_individual: 0.6958,
std_domain: 0.2326, std_individual: 0.2135, ===2023-06-30 17:57:06===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
============ Train epoch 0 ============
denominator: 38601.53515625
 Site-MNIST                         | Train Loss: 2.1554 | Train Acc: 0.5200
 Site-MNIST                         | Train Loss: 2.1718 | Train Acc: 0.4556
 Site-MNIST                         | Train Loss: 2.1809 | Train Acc: 0.4300
 Site-MNIST                         | Train Loss: 2.1766 | Train Acc: 0.4507
 Site-MNIST                         | Train Loss: 2.1750 | Train Acc: 0.4518
 Site-USPS                          | Train Loss: 2.1613 | Train Acc: 0.5252
 Site-USPS                          | Train Loss: 2.1587 | Train Acc: 0.5447
 Site-USPS                          | Train Loss: 2.1513 | Train Acc: 0.5666
 Site-SynthDigits                   | Train Loss: 2.2715 | Train Acc: 0.1648
 Site-SynthDigits                   | Train Loss: 2.2548 | Train Acc: 0.2298
 Site-MNIST_M                       | Train Loss: 2.2852 | Train Acc: 0.1477
 Site-MNIST_M                       | Train Loss: 2.2913 | Train Acc: 0.1080
 Site-SVHN                          | Train Loss: 2.2808 | Train Acc: 0.1380
Average Train Accuracy: 0.3641
 Site-MNIST                         | Val  Loss: 2.1770 | Val  Acc: 0.4286
 Site-MNIST                         | Val  Loss: 2.2029 | Val  Acc: 0.4048
 Site-MNIST                         | Val  Loss: 2.1686 | Val  Acc: 0.4603
 Site-MNIST                         | Val  Loss: 2.1766 | Val  Acc: 0.4368
 Site-MNIST                         | Val  Loss: 2.1760 | Val  Acc: 0.4456
 Site-USPS                          | Val  Loss: 2.1657 | Val  Acc: 0.5481
 Site-USPS                          | Val  Loss: 2.1620 | Val  Acc: 0.5064
 Site-USPS                          | Val  Loss: 2.1587 | Val  Acc: 0.5342
 Site-SynthDigits                   | Val  Loss: 2.2635 | Val  Acc: 0.1818
 Site-SynthDigits                   | Val  Loss: 2.2700 | Val  Acc: 0.1414
 Site-MNIST_M                       | Val  Loss: 2.2907 | Val  Acc: 0.1591
 Site-MNIST_M                       | Val  Loss: 2.2746 | Val  Acc: 0.1970
 Site-SVHN                          | Val  Loss: 2.2784 | Val  Acc: 0.1644
Average Valid Accuracy: 0.3545
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4286
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4048
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4603
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4368
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4456
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5481
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5064
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5342
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1818
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1414
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1591
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1970
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1644
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 1 ============
denominator: 37369.16796875
 Site-MNIST                         | Train Loss: 2.0268 | Train Acc: 0.6578
 Site-MNIST                         | Train Loss: 2.0511 | Train Acc: 0.6006
 Site-MNIST                         | Train Loss: 2.0634 | Train Acc: 0.5503
 Site-MNIST                         | Train Loss: 2.0493 | Train Acc: 0.5664
 Site-MNIST                         | Train Loss: 2.0480 | Train Acc: 0.5779
 Site-USPS                          | Train Loss: 2.0289 | Train Acc: 0.6283
 Site-USPS                          | Train Loss: 2.0260 | Train Acc: 0.6486
 Site-USPS                          | Train Loss: 2.0107 | Train Acc: 0.6613
 Site-SynthDigits                   | Train Loss: 2.2336 | Train Acc: 0.2576
 Site-SynthDigits                   | Train Loss: 2.2133 | Train Acc: 0.3093
 Site-MNIST_M                       | Train Loss: 2.2625 | Train Acc: 0.1761
 Site-MNIST_M                       | Train Loss: 2.2690 | Train Acc: 0.1402
 Site-SVHN                          | Train Loss: 2.2617 | Train Acc: 0.1959
Average Train Accuracy: 0.4593
 Site-MNIST                         | Val  Loss: 2.0525 | Val  Acc: 0.6250
 Site-MNIST                         | Val  Loss: 2.0834 | Val  Acc: 0.5714
 Site-MNIST                         | Val  Loss: 2.0420 | Val  Acc: 0.6032
 Site-MNIST                         | Val  Loss: 2.0593 | Val  Acc: 0.5474
 Site-MNIST                         | Val  Loss: 2.0544 | Val  Acc: 0.5789
 Site-USPS                          | Val  Loss: 2.0436 | Val  Acc: 0.6731
 Site-USPS                          | Val  Loss: 2.0398 | Val  Acc: 0.6026
 Site-USPS                          | Val  Loss: 2.0268 | Val  Acc: 0.6368
 Site-SynthDigits                   | Val  Loss: 2.2338 | Val  Acc: 0.2576
 Site-SynthDigits                   | Val  Loss: 2.2311 | Val  Acc: 0.2222
 Site-MNIST_M                       | Val  Loss: 2.2633 | Val  Acc: 0.2045
 Site-MNIST_M                       | Val  Loss: 2.2489 | Val  Acc: 0.2121
 Site-SVHN                          | Val  Loss: 2.2626 | Val  Acc: 0.1986
Average Valid Accuracy: 0.4564
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6250
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5714
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6032
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5474
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5789
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6731
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6026
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6368
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2576
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2222
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2045
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2121
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1986
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 2 ============
denominator: 36189.53125
 Site-MNIST                         | Train Loss: 1.8950 | Train Acc: 0.6800
 Site-MNIST                         | Train Loss: 1.9072 | Train Acc: 0.6568
 Site-MNIST                         | Train Loss: 1.9392 | Train Acc: 0.6055
 Site-MNIST                         | Train Loss: 1.9170 | Train Acc: 0.5979
 Site-MNIST                         | Train Loss: 1.9146 | Train Acc: 0.6313
 Site-USPS                          | Train Loss: 1.8920 | Train Acc: 0.6355
 Site-USPS                          | Train Loss: 1.8900 | Train Acc: 0.6677
 Site-USPS                          | Train Loss: 1.8735 | Train Acc: 0.6933
 Site-SynthDigits                   | Train Loss: 2.1847 | Train Acc: 0.3068
 Site-SynthDigits                   | Train Loss: 2.1635 | Train Acc: 0.3674
 Site-MNIST_M                       | Train Loss: 2.2347 | Train Acc: 0.2443
 Site-MNIST_M                       | Train Loss: 2.2443 | Train Acc: 0.1951
 Site-SVHN                          | Train Loss: 2.2521 | Train Acc: 0.2317
Average Train Accuracy: 0.5010
 Site-MNIST                         | Val  Loss: 1.9213 | Val  Acc: 0.6964
 Site-MNIST                         | Val  Loss: 1.9558 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.9098 | Val  Acc: 0.6508
 Site-MNIST                         | Val  Loss: 1.9327 | Val  Acc: 0.6105
 Site-MNIST                         | Val  Loss: 1.9251 | Val  Acc: 0.6351
 Site-USPS                          | Val  Loss: 1.9187 | Val  Acc: 0.6635
 Site-USPS                          | Val  Loss: 1.9144 | Val  Acc: 0.6346
 Site-USPS                          | Val  Loss: 1.8926 | Val  Acc: 0.6325
 Site-SynthDigits                   | Val  Loss: 2.2020 | Val  Acc: 0.3333
 Site-SynthDigits                   | Val  Loss: 2.1807 | Val  Acc: 0.2879
 Site-MNIST_M                       | Val  Loss: 2.2311 | Val  Acc: 0.2955
 Site-MNIST_M                       | Val  Loss: 2.2184 | Val  Acc: 0.2576
 Site-SVHN                          | Val  Loss: 2.2491 | Val  Acc: 0.2055
Average Valid Accuracy: 0.5054
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6964
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6508
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6105
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6351
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6635
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6346
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6325
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3333
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2879
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2955
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2576
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2055
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 3 ============
denominator: 34813.71875
 Site-MNIST                         | Train Loss: 1.7667 | Train Acc: 0.6978
 Site-MNIST                         | Train Loss: 1.7702 | Train Acc: 0.6834
 Site-MNIST                         | Train Loss: 1.8195 | Train Acc: 0.6410
 Site-MNIST                         | Train Loss: 1.7917 | Train Acc: 0.6386
 Site-MNIST                         | Train Loss: 1.7888 | Train Acc: 0.6716
 Site-USPS                          | Train Loss: 1.7611 | Train Acc: 0.6331
 Site-USPS                          | Train Loss: 1.7543 | Train Acc: 0.6949
 Site-USPS                          | Train Loss: 1.7351 | Train Acc: 0.7188
 Site-SynthDigits                   | Train Loss: 2.1394 | Train Acc: 0.3428
 Site-SynthDigits                   | Train Loss: 2.1122 | Train Acc: 0.3977
 Site-MNIST_M                       | Train Loss: 2.2136 | Train Acc: 0.2699
 Site-MNIST_M                       | Train Loss: 2.2171 | Train Acc: 0.2348
 Site-SVHN                          | Train Loss: 2.2378 | Train Acc: 0.2675
Average Train Accuracy: 0.5302
 Site-MNIST                         | Val  Loss: 1.7943 | Val  Acc: 0.6964
 Site-MNIST                         | Val  Loss: 1.8374 | Val  Acc: 0.6786
 Site-MNIST                         | Val  Loss: 1.7842 | Val  Acc: 0.6984
 Site-MNIST                         | Val  Loss: 1.8122 | Val  Acc: 0.6474
 Site-MNIST                         | Val  Loss: 1.8022 | Val  Acc: 0.6632
 Site-USPS                          | Val  Loss: 1.7893 | Val  Acc: 0.7115
 Site-USPS                          | Val  Loss: 1.7864 | Val  Acc: 0.6410
 Site-USPS                          | Val  Loss: 1.7580 | Val  Acc: 0.6282
 Site-SynthDigits                   | Val  Loss: 2.1697 | Val  Acc: 0.3409
 Site-SynthDigits                   | Val  Loss: 2.1350 | Val  Acc: 0.3131
 Site-MNIST_M                       | Val  Loss: 2.2092 | Val  Acc: 0.3295
 Site-MNIST_M                       | Val  Loss: 2.1927 | Val  Acc: 0.2955
 Site-SVHN                          | Val  Loss: 2.2356 | Val  Acc: 0.2397
Average Valid Accuracy: 0.5295
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6964
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6786
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6984
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6474
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6632
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7115
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6410
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6282
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3409
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3131
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3295
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2955
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2397
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 4 ============
denominator: 33693.203125
 Site-MNIST                         | Train Loss: 1.6342 | Train Acc: 0.7333
 Site-MNIST                         | Train Loss: 1.6500 | Train Acc: 0.7189
 Site-MNIST                         | Train Loss: 1.7070 | Train Acc: 0.6746
 Site-MNIST                         | Train Loss: 1.6713 | Train Acc: 0.6925
 Site-MNIST                         | Train Loss: 1.6704 | Train Acc: 0.7119
 Site-USPS                          | Train Loss: 1.6431 | Train Acc: 0.6571
 Site-USPS                          | Train Loss: 1.6293 | Train Acc: 0.7220
 Site-USPS                          | Train Loss: 1.6102 | Train Acc: 0.7476
 Site-SynthDigits                   | Train Loss: 2.0882 | Train Acc: 0.3807
 Site-SynthDigits                   | Train Loss: 2.0627 | Train Acc: 0.4129
 Site-MNIST_M                       | Train Loss: 2.1889 | Train Acc: 0.3097
 Site-MNIST_M                       | Train Loss: 2.2066 | Train Acc: 0.2595
 Site-SVHN                          | Train Loss: 2.2166 | Train Acc: 0.2726
Average Train Accuracy: 0.5610
 Site-MNIST                         | Val  Loss: 1.6730 | Val  Acc: 0.7143
 Site-MNIST                         | Val  Loss: 1.7191 | Val  Acc: 0.6905
 Site-MNIST                         | Val  Loss: 1.6645 | Val  Acc: 0.6984
 Site-MNIST                         | Val  Loss: 1.6976 | Val  Acc: 0.6579
 Site-MNIST                         | Val  Loss: 1.6859 | Val  Acc: 0.6947
 Site-USPS                          | Val  Loss: 1.6663 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 1.6654 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 1.6350 | Val  Acc: 0.6538
 Site-SynthDigits                   | Val  Loss: 2.1333 | Val  Acc: 0.3712
 Site-SynthDigits                   | Val  Loss: 2.0909 | Val  Acc: 0.3535
 Site-MNIST_M                       | Val  Loss: 2.1819 | Val  Acc: 0.3750
 Site-MNIST_M                       | Val  Loss: 2.1696 | Val  Acc: 0.3333
 Site-SVHN                          | Val  Loss: 2.2235 | Val  Acc: 0.2260
Average Valid Accuracy: 0.5527
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7143
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.6905
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.6984
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.6579
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.6947
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6538
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3712
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3535
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3750
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3333
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2260
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 5 ============
denominator: 32538.783203125
 Site-MNIST                         | Train Loss: 1.5257 | Train Acc: 0.7556
 Site-MNIST                         | Train Loss: 1.5556 | Train Acc: 0.7456
 Site-MNIST                         | Train Loss: 1.6014 | Train Acc: 0.6923
 Site-MNIST                         | Train Loss: 1.5597 | Train Acc: 0.7057
 Site-MNIST                         | Train Loss: 1.5581 | Train Acc: 0.7303
 Site-USPS                          | Train Loss: 1.5322 | Train Acc: 0.6811
 Site-USPS                          | Train Loss: 1.5016 | Train Acc: 0.7444
 Site-USPS                          | Train Loss: 1.4833 | Train Acc: 0.7572
 Site-SynthDigits                   | Train Loss: 2.0631 | Train Acc: 0.3826
 Site-SynthDigits                   | Train Loss: 2.0154 | Train Acc: 0.4154
 Site-MNIST_M                       | Train Loss: 2.1663 | Train Acc: 0.3324
 Site-MNIST_M                       | Train Loss: 2.1893 | Train Acc: 0.2973
 Site-SVHN                          | Train Loss: 2.2043 | Train Acc: 0.2930
Average Train Accuracy: 0.5794
 Site-MNIST                         | Val  Loss: 1.5590 | Val  Acc: 0.7321
 Site-MNIST                         | Val  Loss: 1.6095 | Val  Acc: 0.7143
 Site-MNIST                         | Val  Loss: 1.5517 | Val  Acc: 0.7222
 Site-MNIST                         | Val  Loss: 1.5887 | Val  Acc: 0.7000
 Site-MNIST                         | Val  Loss: 1.5771 | Val  Acc: 0.7263
 Site-USPS                          | Val  Loss: 1.5435 | Val  Acc: 0.7692
 Site-USPS                          | Val  Loss: 1.5438 | Val  Acc: 0.6923
 Site-USPS                          | Val  Loss: 1.5128 | Val  Acc: 0.6709
 Site-SynthDigits                   | Val  Loss: 2.0998 | Val  Acc: 0.3939
 Site-SynthDigits                   | Val  Loss: 2.0466 | Val  Acc: 0.3485
 Site-MNIST_M                       | Val  Loss: 2.1553 | Val  Acc: 0.3864
 Site-MNIST_M                       | Val  Loss: 2.1429 | Val  Acc: 0.3182
 Site-SVHN                          | Val  Loss: 2.2102 | Val  Acc: 0.2671
Average Valid Accuracy: 0.5724
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7321
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7143
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7222
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7000
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7263
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7692
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6923
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6709
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3939
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3485
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3864
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3182
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2671
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 6 ============
denominator: 31689.763671875
 Site-MNIST                         | Train Loss: 1.4260 | Train Acc: 0.7911
 Site-MNIST                         | Train Loss: 1.4728 | Train Acc: 0.7751
 Site-MNIST                         | Train Loss: 1.4975 | Train Acc: 0.7179
 Site-MNIST                         | Train Loss: 1.4521 | Train Acc: 0.7293
 Site-MNIST                         | Train Loss: 1.4505 | Train Acc: 0.7566
 Site-USPS                          | Train Loss: 1.4101 | Train Acc: 0.7266
 Site-USPS                          | Train Loss: 1.3833 | Train Acc: 0.7700
 Site-USPS                          | Train Loss: 1.3606 | Train Acc: 0.7753
 Site-SynthDigits                   | Train Loss: 2.0107 | Train Acc: 0.3958
 Site-SynthDigits                   | Train Loss: 1.9715 | Train Acc: 0.4369
 Site-MNIST_M                       | Train Loss: 2.1423 | Train Acc: 0.3466
 Site-MNIST_M                       | Train Loss: 2.1689 | Train Acc: 0.3087
 Site-SVHN                          | Train Loss: 2.1938 | Train Acc: 0.2913
Average Train Accuracy: 0.6016
 Site-MNIST                         | Val  Loss: 1.4471 | Val  Acc: 0.7679
 Site-MNIST                         | Val  Loss: 1.4998 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.4423 | Val  Acc: 0.7619
 Site-MNIST                         | Val  Loss: 1.4814 | Val  Acc: 0.7526
 Site-MNIST                         | Val  Loss: 1.4704 | Val  Acc: 0.7579
 Site-USPS                          | Val  Loss: 1.4248 | Val  Acc: 0.7788
 Site-USPS                          | Val  Loss: 1.4263 | Val  Acc: 0.7244
 Site-USPS                          | Val  Loss: 1.3971 | Val  Acc: 0.7222
 Site-SynthDigits                   | Val  Loss: 2.0646 | Val  Acc: 0.4015
 Site-SynthDigits                   | Val  Loss: 2.0019 | Val  Acc: 0.3687
 Site-MNIST_M                       | Val  Loss: 2.1275 | Val  Acc: 0.3977
 Site-MNIST_M                       | Val  Loss: 2.1181 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 2.1959 | Val  Acc: 0.2534
Average Valid Accuracy: 0.5995
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7679
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7619
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7526
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7579
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7788
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7244
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7222
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4015
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3687
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3977
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3561
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2534
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 7 ============
denominator: 30439.009765625
 Site-MNIST                         | Train Loss: 1.3014 | Train Acc: 0.7911
 Site-MNIST                         | Train Loss: 1.3473 | Train Acc: 0.7988
 Site-MNIST                         | Train Loss: 1.4007 | Train Acc: 0.7278
 Site-MNIST                         | Train Loss: 1.3511 | Train Acc: 0.7477
 Site-MNIST                         | Train Loss: 1.3503 | Train Acc: 0.7680
 Site-USPS                          | Train Loss: 1.3038 | Train Acc: 0.7506
 Site-USPS                          | Train Loss: 1.2869 | Train Acc: 0.7827
 Site-USPS                          | Train Loss: 1.2631 | Train Acc: 0.8030
 Site-SynthDigits                   | Train Loss: 1.9651 | Train Acc: 0.4091
 Site-SynthDigits                   | Train Loss: 1.9277 | Train Acc: 0.4533
 Site-MNIST_M                       | Train Loss: 2.1155 | Train Acc: 0.3636
 Site-MNIST_M                       | Train Loss: 2.1398 | Train Acc: 0.3220
 Site-SVHN                          | Train Loss: 2.1750 | Train Acc: 0.2896
Average Train Accuracy: 0.6159
 Site-MNIST                         | Val  Loss: 1.3437 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.3986 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.3420 | Val  Acc: 0.7698
 Site-MNIST                         | Val  Loss: 1.3798 | Val  Acc: 0.7737
 Site-MNIST                         | Val  Loss: 1.3707 | Val  Acc: 0.7860
 Site-USPS                          | Val  Loss: 1.3231 | Val  Acc: 0.7788
 Site-USPS                          | Val  Loss: 1.3238 | Val  Acc: 0.7564
 Site-USPS                          | Val  Loss: 1.2983 | Val  Acc: 0.7479
 Site-SynthDigits                   | Val  Loss: 2.0354 | Val  Acc: 0.4318
 Site-SynthDigits                   | Val  Loss: 1.9589 | Val  Acc: 0.3889
 Site-MNIST_M                       | Val  Loss: 2.1026 | Val  Acc: 0.3977
 Site-MNIST_M                       | Val  Loss: 2.0865 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 2.1840 | Val  Acc: 0.2534
Average Valid Accuracy: 0.6108
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7698
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7737
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7860
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7788
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7564
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7479
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4318
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3889
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3977
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3561
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2534
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 8 ============
denominator: 29475.40234375
 Site-MNIST                         | Train Loss: 1.2183 | Train Acc: 0.8089
 Site-MNIST                         | Train Loss: 1.2901 | Train Acc: 0.7988
 Site-MNIST                         | Train Loss: 1.3100 | Train Acc: 0.7396
 Site-MNIST                         | Train Loss: 1.2595 | Train Acc: 0.7556
 Site-MNIST                         | Train Loss: 1.2571 | Train Acc: 0.7732
 Site-USPS                          | Train Loss: 1.2127 | Train Acc: 0.7722
 Site-USPS                          | Train Loss: 1.1764 | Train Acc: 0.8019
 Site-USPS                          | Train Loss: 1.1482 | Train Acc: 0.8349
 Site-SynthDigits                   | Train Loss: 1.9391 | Train Acc: 0.4148
 Site-SynthDigits                   | Train Loss: 1.8831 | Train Acc: 0.4710
 Site-MNIST_M                       | Train Loss: 2.0887 | Train Acc: 0.3778
 Site-MNIST_M                       | Train Loss: 2.1202 | Train Acc: 0.3333
 Site-SVHN                          | Train Loss: 2.1670 | Train Acc: 0.3049
Average Train Accuracy: 0.6298
 Site-MNIST                         | Val  Loss: 1.2491 | Val  Acc: 0.7857
 Site-MNIST                         | Val  Loss: 1.3043 | Val  Acc: 0.7619
 Site-MNIST                         | Val  Loss: 1.2488 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 1.2859 | Val  Acc: 0.7789
 Site-MNIST                         | Val  Loss: 1.2784 | Val  Acc: 0.7860
 Site-USPS                          | Val  Loss: 1.2110 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 1.2125 | Val  Acc: 0.7756
 Site-USPS                          | Val  Loss: 1.1894 | Val  Acc: 0.7735
 Site-SynthDigits                   | Val  Loss: 2.0062 | Val  Acc: 0.4318
 Site-SynthDigits                   | Val  Loss: 1.9206 | Val  Acc: 0.3939
 Site-MNIST_M                       | Val  Loss: 2.0704 | Val  Acc: 0.3977
 Site-MNIST_M                       | Val  Loss: 2.0556 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 2.1691 | Val  Acc: 0.2740
Average Valid Accuracy: 0.6231
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7857
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7619
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7789
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7860
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8077
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7756
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7735
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4318
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3939
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3977
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3561
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2740
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 9 ============
denominator: 28628.240234375
 Site-MNIST                         | Train Loss: 1.1398 | Train Acc: 0.8222
 Site-MNIST                         | Train Loss: 1.1881 | Train Acc: 0.8077
 Site-MNIST                         | Train Loss: 1.2285 | Train Acc: 0.7396
 Site-MNIST                         | Train Loss: 1.1741 | Train Acc: 0.7674
 Site-MNIST                         | Train Loss: 1.1741 | Train Acc: 0.7995
 Site-USPS                          | Train Loss: 1.1082 | Train Acc: 0.8034
 Site-USPS                          | Train Loss: 1.0717 | Train Acc: 0.8211
 Site-USPS                          | Train Loss: 1.0533 | Train Acc: 0.8520
 Site-SynthDigits                   | Train Loss: 1.8927 | Train Acc: 0.4148
 Site-SynthDigits                   | Train Loss: 1.8455 | Train Acc: 0.4823
 Site-MNIST_M                       | Train Loss: 2.0473 | Train Acc: 0.3920
 Site-MNIST_M                       | Train Loss: 2.0970 | Train Acc: 0.3447
 Site-SVHN                          | Train Loss: 2.1366 | Train Acc: 0.3118
Average Train Accuracy: 0.6430
 Site-MNIST                         | Val  Loss: 1.1577 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 1.2107 | Val  Acc: 0.7976
 Site-MNIST                         | Val  Loss: 1.1688 | Val  Acc: 0.7619
 Site-MNIST                         | Val  Loss: 1.2031 | Val  Acc: 0.7737
 Site-MNIST                         | Val  Loss: 1.1939 | Val  Acc: 0.7965
 Site-USPS                          | Val  Loss: 1.1028 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 1.1061 | Val  Acc: 0.7949
 Site-USPS                          | Val  Loss: 1.0879 | Val  Acc: 0.8034
 Site-SynthDigits                   | Val  Loss: 1.9779 | Val  Acc: 0.4318
 Site-SynthDigits                   | Val  Loss: 1.8868 | Val  Acc: 0.3889
 Site-MNIST_M                       | Val  Loss: 2.0365 | Val  Acc: 0.4318
 Site-MNIST_M                       | Val  Loss: 2.0217 | Val  Acc: 0.3636
 Site-SVHN                          | Val  Loss: 2.1544 | Val  Acc: 0.2740
Average Valid Accuracy: 0.6366
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7976
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7619
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7737
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7965
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7949
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8034
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4318
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3889
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.4318
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.3636
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2740
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 10 ============
denominator: 27648.45703125
 Site-MNIST                         | Train Loss: 1.0582 | Train Acc: 0.8178
 Site-MNIST                         | Train Loss: 1.0860 | Train Acc: 0.7988
 Site-MNIST                         | Train Loss: 1.1470 | Train Acc: 0.7653
 Site-MNIST                         | Train Loss: 1.0920 | Train Acc: 0.7806
 Site-MNIST                         | Train Loss: 1.0924 | Train Acc: 0.8082
 Site-USPS                          | Train Loss: 1.0233 | Train Acc: 0.8177
 Site-USPS                          | Train Loss: 0.9872 | Train Acc: 0.8259
 Site-USPS                          | Train Loss: 0.9695 | Train Acc: 0.8573
 Site-SynthDigits                   | Train Loss: 1.8570 | Train Acc: 0.4167
 Site-SynthDigits                   | Train Loss: 1.8032 | Train Acc: 0.4987
 Site-MNIST_M                       | Train Loss: 2.0092 | Train Acc: 0.4148
 Site-MNIST_M                       | Train Loss: 2.0725 | Train Acc: 0.3598
 Site-SVHN                          | Train Loss: 2.1331 | Train Acc: 0.3118
Average Train Accuracy: 0.6518
 Site-MNIST                         | Val  Loss: 1.0679 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 1.1179 | Val  Acc: 0.8452
 Site-MNIST                         | Val  Loss: 1.0898 | Val  Acc: 0.8016
 Site-MNIST                         | Val  Loss: 1.1225 | Val  Acc: 0.7789
 Site-MNIST                         | Val  Loss: 1.1127 | Val  Acc: 0.7895
 Site-USPS                          | Val  Loss: 1.0094 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 1.0142 | Val  Acc: 0.8013
 Site-USPS                          | Val  Loss: 1.0062 | Val  Acc: 0.8077
 Site-SynthDigits                   | Val  Loss: 1.9492 | Val  Acc: 0.4242
 Site-SynthDigits                   | Val  Loss: 1.8526 | Val  Acc: 0.3939
 Site-MNIST_M                       | Val  Loss: 1.9999 | Val  Acc: 0.4886
 Site-MNIST_M                       | Val  Loss: 1.9852 | Val  Acc: 0.4015
 Site-SVHN                          | Val  Loss: 2.1466 | Val  Acc: 0.2671
Average Valid Accuracy: 0.6526
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8452
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8016
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7789
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7895
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8013
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8077
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4242
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3939
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4886
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4015
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2671
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 11 ============
denominator: 26761.017578125
 Site-MNIST                         | Train Loss: 0.9706 | Train Acc: 0.8267
 Site-MNIST                         | Train Loss: 1.0115 | Train Acc: 0.8136
 Site-MNIST                         | Train Loss: 1.0711 | Train Acc: 0.7673
 Site-MNIST                         | Train Loss: 1.0119 | Train Acc: 0.7976
 Site-MNIST                         | Train Loss: 1.0125 | Train Acc: 0.8135
 Site-USPS                          | Train Loss: 0.9493 | Train Acc: 0.8177
 Site-USPS                          | Train Loss: 0.9105 | Train Acc: 0.8355
 Site-USPS                          | Train Loss: 0.8908 | Train Acc: 0.8637
 Site-SynthDigits                   | Train Loss: 1.8224 | Train Acc: 0.4337
 Site-SynthDigits                   | Train Loss: 1.7695 | Train Acc: 0.5063
 Site-MNIST_M                       | Train Loss: 1.9803 | Train Acc: 0.4261
 Site-MNIST_M                       | Train Loss: 2.0359 | Train Acc: 0.3750
 Site-SVHN                          | Train Loss: 2.1113 | Train Acc: 0.3066
Average Train Accuracy: 0.6603
 Site-MNIST                         | Val  Loss: 0.9873 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 1.0314 | Val  Acc: 0.8333
 Site-MNIST                         | Val  Loss: 1.0140 | Val  Acc: 0.8095
 Site-MNIST                         | Val  Loss: 1.0437 | Val  Acc: 0.7947
 Site-MNIST                         | Val  Loss: 1.0313 | Val  Acc: 0.8070
 Site-USPS                          | Val  Loss: 0.9241 | Val  Acc: 0.8173
 Site-USPS                          | Val  Loss: 0.9331 | Val  Acc: 0.8141
 Site-USPS                          | Val  Loss: 0.9316 | Val  Acc: 0.8162
 Site-SynthDigits                   | Val  Loss: 1.9205 | Val  Acc: 0.4318
 Site-SynthDigits                   | Val  Loss: 1.8106 | Val  Acc: 0.4242
 Site-MNIST_M                       | Val  Loss: 1.9557 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.9433 | Val  Acc: 0.4242
 Site-SVHN                          | Val  Loss: 2.1372 | Val  Acc: 0.2740
Average Valid Accuracy: 0.6591
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8333
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8095
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7947
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8070
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8173
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8141
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8162
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.4318
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.4242
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4242
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2740
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 12 ============
denominator: 25938.625
 Site-MNIST                         | Train Loss: 0.9252 | Train Acc: 0.8222
 Site-MNIST                         | Train Loss: 0.9382 | Train Acc: 0.8136
 Site-MNIST                         | Train Loss: 1.0115 | Train Acc: 0.7830
 Site-MNIST                         | Train Loss: 0.9547 | Train Acc: 0.8003
 Site-MNIST                         | Train Loss: 0.9568 | Train Acc: 0.8179
 Site-USPS                          | Train Loss: 0.8878 | Train Acc: 0.8417
 Site-USPS                          | Train Loss: 0.8441 | Train Acc: 0.8610
 Site-USPS                          | Train Loss: 0.8275 | Train Acc: 0.8733
 Site-SynthDigits                   | Train Loss: 1.7872 | Train Acc: 0.4394
 Site-SynthDigits                   | Train Loss: 1.7302 | Train Acc: 0.5164
 Site-MNIST_M                       | Train Loss: 1.9498 | Train Acc: 0.4290
 Site-MNIST_M                       | Train Loss: 2.0149 | Train Acc: 0.3807
 Site-SVHN                          | Train Loss: 2.1263 | Train Acc: 0.3101
Average Train Accuracy: 0.6683
 Site-MNIST                         | Val  Loss: 0.9212 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.9574 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.9588 | Val  Acc: 0.8254
 Site-MNIST                         | Val  Loss: 0.9895 | Val  Acc: 0.7895
 Site-MNIST                         | Val  Loss: 0.9737 | Val  Acc: 0.8035
 Site-USPS                          | Val  Loss: 0.8573 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 0.8677 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.8697 | Val  Acc: 0.8376
 Site-SynthDigits                   | Val  Loss: 1.8920 | Val  Acc: 0.4394
 Site-SynthDigits                   | Val  Loss: 1.7615 | Val  Acc: 0.4444
 Site-MNIST_M                       | Val  Loss: 1.9182 | Val  Acc: 0.5114
 Site-MNIST_M                       | Val  Loss: 1.9099 | Val  Acc: 0.4318
 Site-SVHN                          | Val  Loss: 2.1297 | Val  Acc: 0.2671
Average Valid Accuracy: 0.6701
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8254
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7895
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8035
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8462
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8376
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.4394
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.4444
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.5114
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4318
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2671
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 13 ============
denominator: 25210.49609375
 Site-MNIST                         | Train Loss: 0.8566 | Train Acc: 0.8356
 Site-MNIST                         | Train Loss: 0.8929 | Train Acc: 0.8254
 Site-MNIST                         | Train Loss: 0.9489 | Train Acc: 0.7968
 Site-MNIST                         | Train Loss: 0.8935 | Train Acc: 0.8134
 Site-MNIST                         | Train Loss: 0.8915 | Train Acc: 0.8284
 Site-USPS                          | Train Loss: 0.8322 | Train Acc: 0.8417
 Site-USPS                          | Train Loss: 0.7833 | Train Acc: 0.8610
 Site-USPS                          | Train Loss: 0.7664 | Train Acc: 0.8754
 Site-SynthDigits                   | Train Loss: 1.7568 | Train Acc: 0.4508
 Site-SynthDigits                   | Train Loss: 1.6964 | Train Acc: 0.5202
 Site-MNIST_M                       | Train Loss: 1.9231 | Train Acc: 0.4460
 Site-MNIST_M                       | Train Loss: 1.9932 | Train Acc: 0.3902
 Site-SVHN                          | Train Loss: 2.1035 | Train Acc: 0.3186
Average Train Accuracy: 0.6772
 Site-MNIST                         | Val  Loss: 0.8546 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 0.8917 | Val  Acc: 0.8452
 Site-MNIST                         | Val  Loss: 0.8977 | Val  Acc: 0.8492
 Site-MNIST                         | Val  Loss: 0.9254 | Val  Acc: 0.8263
 Site-MNIST                         | Val  Loss: 0.9090 | Val  Acc: 0.8175
 Site-USPS                          | Val  Loss: 0.7890 | Val  Acc: 0.8558
 Site-USPS                          | Val  Loss: 0.8037 | Val  Acc: 0.8397
 Site-USPS                          | Val  Loss: 0.8110 | Val  Acc: 0.8333
 Site-SynthDigits                   | Val  Loss: 1.8694 | Val  Acc: 0.4394
 Site-SynthDigits                   | Val  Loss: 1.7278 | Val  Acc: 0.4495
 Site-MNIST_M                       | Val  Loss: 1.8782 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.8709 | Val  Acc: 0.4470
 Site-SVHN                          | Val  Loss: 2.1219 | Val  Acc: 0.2808
Average Valid Accuracy: 0.6760
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8452
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8492
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8263
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8175
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8558
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8397
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8333
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4394
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4495
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4470
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.2808
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 14 ============
denominator: 24538.583984375
 Site-MNIST                         | Train Loss: 0.7989 | Train Acc: 0.8311
 Site-MNIST                         | Train Loss: 0.8467 | Train Acc: 0.8343
 Site-MNIST                         | Train Loss: 0.8947 | Train Acc: 0.7988
 Site-MNIST                         | Train Loss: 0.8363 | Train Acc: 0.8187
 Site-MNIST                         | Train Loss: 0.8359 | Train Acc: 0.8319
 Site-USPS                          | Train Loss: 0.7818 | Train Acc: 0.8561
 Site-USPS                          | Train Loss: 0.7296 | Train Acc: 0.8626
 Site-USPS                          | Train Loss: 0.7149 | Train Acc: 0.8829
 Site-SynthDigits                   | Train Loss: 1.7398 | Train Acc: 0.4564
 Site-SynthDigits                   | Train Loss: 1.6663 | Train Acc: 0.5164
 Site-MNIST_M                       | Train Loss: 1.8710 | Train Acc: 0.4688
 Site-MNIST_M                       | Train Loss: 1.9609 | Train Acc: 0.4034
 Site-SVHN                          | Train Loss: 2.1014 | Train Acc: 0.3135
Average Train Accuracy: 0.6827
 Site-MNIST                         | Val  Loss: 0.7966 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.8290 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.8416 | Val  Acc: 0.8413
 Site-MNIST                         | Val  Loss: 0.8679 | Val  Acc: 0.8316
 Site-MNIST                         | Val  Loss: 0.8542 | Val  Acc: 0.8281
 Site-USPS                          | Val  Loss: 0.7328 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.7511 | Val  Acc: 0.8397
 Site-USPS                          | Val  Loss: 0.7589 | Val  Acc: 0.8504
 Site-SynthDigits                   | Val  Loss: 1.8410 | Val  Acc: 0.4470
 Site-SynthDigits                   | Val  Loss: 1.6857 | Val  Acc: 0.4697
 Site-MNIST_M                       | Val  Loss: 1.8403 | Val  Acc: 0.5455
 Site-MNIST_M                       | Val  Loss: 1.8343 | Val  Acc: 0.4697
 Site-SVHN                          | Val  Loss: 2.1120 | Val  Acc: 0.2877
Average Valid Accuracy: 0.6873
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8413
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8316
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8281
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8462
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8397
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8504
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.4470
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.4697
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.5455
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4697
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.2877
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 15 ============
denominator: 23906.083984375
 Site-MNIST                         | Train Loss: 0.7514 | Train Acc: 0.8356
 Site-MNIST                         | Train Loss: 0.7501 | Train Acc: 0.8432
 Site-MNIST                         | Train Loss: 0.8347 | Train Acc: 0.8107
 Site-MNIST                         | Train Loss: 0.7789 | Train Acc: 0.8318
 Site-MNIST                         | Train Loss: 0.7793 | Train Acc: 0.8371
 Site-USPS                          | Train Loss: 0.7316 | Train Acc: 0.8609
 Site-USPS                          | Train Loss: 0.6831 | Train Acc: 0.8722
 Site-USPS                          | Train Loss: 0.6726 | Train Acc: 0.8860
 Site-SynthDigits                   | Train Loss: 1.7107 | Train Acc: 0.4621
 Site-SynthDigits                   | Train Loss: 1.6323 | Train Acc: 0.5391
 Site-MNIST_M                       | Train Loss: 1.8570 | Train Acc: 0.4830
 Site-MNIST_M                       | Train Loss: 1.9558 | Train Acc: 0.4091
 Site-SVHN                          | Train Loss: 2.0850 | Train Acc: 0.3203
Average Train Accuracy: 0.6916
 Site-MNIST                         | Val  Loss: 0.7392 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.7699 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.7861 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.8100 | Val  Acc: 0.8474
 Site-MNIST                         | Val  Loss: 0.7986 | Val  Acc: 0.8351
 Site-USPS                          | Val  Loss: 0.6781 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.7032 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.7172 | Val  Acc: 0.8590
 Site-SynthDigits                   | Val  Loss: 1.8180 | Val  Acc: 0.4470
 Site-SynthDigits                   | Val  Loss: 1.6578 | Val  Acc: 0.4798
 Site-MNIST_M                       | Val  Loss: 1.8019 | Val  Acc: 0.5341
 Site-MNIST_M                       | Val  Loss: 1.7951 | Val  Acc: 0.4924
 Site-SVHN                          | Val  Loss: 2.1031 | Val  Acc: 0.3014
Average Valid Accuracy: 0.6956
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8474
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8351
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8654
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8462
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8590
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4470
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4798
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.5341
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4924
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 16 ============
denominator: 23381.11328125
 Site-MNIST                         | Train Loss: 0.6996 | Train Acc: 0.8267
 Site-MNIST                         | Train Loss: 0.7351 | Train Acc: 0.8491
 Site-MNIST                         | Train Loss: 0.7925 | Train Acc: 0.8185
 Site-MNIST                         | Train Loss: 0.7349 | Train Acc: 0.8357
 Site-MNIST                         | Train Loss: 0.7355 | Train Acc: 0.8389
 Site-USPS                          | Train Loss: 0.6913 | Train Acc: 0.8633
 Site-USPS                          | Train Loss: 0.6436 | Train Acc: 0.8818
 Site-USPS                          | Train Loss: 0.6328 | Train Acc: 0.8829
 Site-SynthDigits                   | Train Loss: 1.6858 | Train Acc: 0.4659
 Site-SynthDigits                   | Train Loss: 1.5991 | Train Acc: 0.5391
 Site-MNIST_M                       | Train Loss: 1.8223 | Train Acc: 0.5000
 Site-MNIST_M                       | Train Loss: 1.9268 | Train Acc: 0.4148
 Site-SVHN                          | Train Loss: 2.0561 | Train Acc: 0.3152
Average Train Accuracy: 0.6948
 Site-MNIST                         | Val  Loss: 0.6950 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.7208 | Val  Acc: 0.8690
 Site-MNIST                         | Val  Loss: 0.7401 | Val  Acc: 0.8651
 Site-MNIST                         | Val  Loss: 0.7638 | Val  Acc: 0.8579
 Site-MNIST                         | Val  Loss: 0.7541 | Val  Acc: 0.8421
 Site-USPS                          | Val  Loss: 0.6351 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.6665 | Val  Acc: 0.8590
 Site-USPS                          | Val  Loss: 0.6780 | Val  Acc: 0.8590
 Site-SynthDigits                   | Val  Loss: 1.7880 | Val  Acc: 0.4621
 Site-SynthDigits                   | Val  Loss: 1.6147 | Val  Acc: 0.4899
 Site-MNIST_M                       | Val  Loss: 1.7636 | Val  Acc: 0.5455
 Site-MNIST_M                       | Val  Loss: 1.7591 | Val  Acc: 0.5227
 Site-SVHN                          | Val  Loss: 2.0906 | Val  Acc: 0.2945
Average Valid Accuracy: 0.7070
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8393
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8690
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8651
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8579
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8421
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8846
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8590
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8590
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4621
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4899
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.5455
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.5227
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.2945
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 17 ============
denominator: 22799.333984375
 Site-MNIST                         | Train Loss: 0.6612 | Train Acc: 0.8311
 Site-MNIST                         | Train Loss: 0.7098 | Train Acc: 0.8580
 Site-MNIST                         | Train Loss: 0.7496 | Train Acc: 0.8245
 Site-MNIST                         | Train Loss: 0.6915 | Train Acc: 0.8371
 Site-MNIST                         | Train Loss: 0.6888 | Train Acc: 0.8468
 Site-USPS                          | Train Loss: 0.6677 | Train Acc: 0.8609
 Site-USPS                          | Train Loss: 0.6057 | Train Acc: 0.8786
 Site-USPS                          | Train Loss: 0.5948 | Train Acc: 0.8903
 Site-SynthDigits                   | Train Loss: 1.6386 | Train Acc: 0.4678
 Site-SynthDigits                   | Train Loss: 1.5600 | Train Acc: 0.5455
 Site-MNIST_M                       | Train Loss: 1.7870 | Train Acc: 0.5028
 Site-MNIST_M                       | Train Loss: 1.8806 | Train Acc: 0.4242
 Site-SVHN                          | Train Loss: 2.0631 | Train Acc: 0.3101
Average Train Accuracy: 0.6983
 Site-MNIST                         | Val  Loss: 0.6548 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.6792 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.6961 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.7183 | Val  Acc: 0.8737
 Site-MNIST                         | Val  Loss: 0.7101 | Val  Acc: 0.8491
 Site-USPS                          | Val  Loss: 0.5943 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.6312 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.6432 | Val  Acc: 0.8590
 Site-SynthDigits                   | Val  Loss: 1.7645 | Val  Acc: 0.4621
 Site-SynthDigits                   | Val  Loss: 1.5843 | Val  Acc: 0.4798
 Site-MNIST_M                       | Val  Loss: 1.7274 | Val  Acc: 0.5682
 Site-MNIST_M                       | Val  Loss: 1.7261 | Val  Acc: 0.5303
 Site-SVHN                          | Val  Loss: 2.0786 | Val  Acc: 0.2877
Average Valid Accuracy: 0.7070
============ Train epoch 18 ============
denominator: 22409.291015625
 Site-MNIST                         | Train Loss: 0.6391 | Train Acc: 0.8267
 Site-MNIST                         | Train Loss: 0.6411 | Train Acc: 0.8550
 Site-MNIST                         | Train Loss: 0.7086 | Train Acc: 0.8304
 Site-MNIST                         | Train Loss: 0.6545 | Train Acc: 0.8436
 Site-MNIST                         | Train Loss: 0.6515 | Train Acc: 0.8546
 Site-USPS                          | Train Loss: 0.6266 | Train Acc: 0.8681
 Site-USPS                          | Train Loss: 0.5714 | Train Acc: 0.8866
 Site-USPS                          | Train Loss: 0.5600 | Train Acc: 0.8924
 Site-SynthDigits                   | Train Loss: 1.6485 | Train Acc: 0.4754
 Site-SynthDigits                   | Train Loss: 1.5515 | Train Acc: 0.5442
 Site-MNIST_M                       | Train Loss: 1.7659 | Train Acc: 0.5085
 Site-MNIST_M                       | Train Loss: 1.8586 | Train Acc: 0.4337
 Site-SVHN                          | Train Loss: 2.0160 | Train Acc: 0.3101
Average Train Accuracy: 0.7023
 Site-MNIST                         | Val  Loss: 0.6159 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.6363 | Val  Acc: 0.8690
 Site-MNIST                         | Val  Loss: 0.6575 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.6785 | Val  Acc: 0.8737
 Site-MNIST                         | Val  Loss: 0.6728 | Val  Acc: 0.8456
 Site-USPS                          | Val  Loss: 0.5524 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.5972 | Val  Acc: 0.8526
 Site-USPS                          | Val  Loss: 0.6064 | Val  Acc: 0.8718
 Site-SynthDigits                   | Val  Loss: 1.7412 | Val  Acc: 0.4697
 Site-SynthDigits                   | Val  Loss: 1.5509 | Val  Acc: 0.4949
 Site-MNIST_M                       | Val  Loss: 1.6837 | Val  Acc: 0.5682
 Site-MNIST_M                       | Val  Loss: 1.6907 | Val  Acc: 0.5303
 Site-SVHN                          | Val  Loss: 2.0663 | Val  Acc: 0.2945
Average Valid Accuracy: 0.7149
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8690
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8810
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8737
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8456
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8846
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8526
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8718
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4697
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4949
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.5682
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.5303
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.2945
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 19 ============
denominator: 21838.4765625
 Site-MNIST                         | Train Loss: 0.6370 | Train Acc: 0.8356
 Site-MNIST                         | Train Loss: 0.6175 | Train Acc: 0.8550
 Site-MNIST                         | Train Loss: 0.6727 | Train Acc: 0.8304
 Site-MNIST                         | Train Loss: 0.6198 | Train Acc: 0.8463
 Site-MNIST                         | Train Loss: 0.6180 | Train Acc: 0.8564
 Site-USPS                          | Train Loss: 0.5962 | Train Acc: 0.8657
 Site-USPS                          | Train Loss: 0.5433 | Train Acc: 0.8850
 Site-USPS                          | Train Loss: 0.5298 | Train Acc: 0.8956
 Site-SynthDigits                   | Train Loss: 1.6084 | Train Acc: 0.4867
 Site-SynthDigits                   | Train Loss: 1.5328 | Train Acc: 0.5606
 Site-MNIST_M                       | Train Loss: 1.7508 | Train Acc: 0.5170
 Site-MNIST_M                       | Train Loss: 1.8527 | Train Acc: 0.4375
 Site-SVHN                          | Train Loss: 2.0306 | Train Acc: 0.3220
Average Train Accuracy: 0.7072
 Site-MNIST                         | Val  Loss: 0.5850 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.6001 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.6193 | Val  Acc: 0.8730
 Site-MNIST                         | Val  Loss: 0.6406 | Val  Acc: 0.8684
 Site-MNIST                         | Val  Loss: 0.6384 | Val  Acc: 0.8456
 Site-USPS                          | Val  Loss: 0.5273 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.5731 | Val  Acc: 0.8526
 Site-USPS                          | Val  Loss: 0.5808 | Val  Acc: 0.8675
 Site-SynthDigits                   | Val  Loss: 1.7173 | Val  Acc: 0.4924
 Site-SynthDigits                   | Val  Loss: 1.5206 | Val  Acc: 0.5051
 Site-MNIST_M                       | Val  Loss: 1.6766 | Val  Acc: 0.5682
 Site-MNIST_M                       | Val  Loss: 1.6754 | Val  Acc: 0.5227
 Site-SVHN                          | Val  Loss: 2.0515 | Val  Acc: 0.3014
Average Valid Accuracy: 0.7163
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8393
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8810
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8730
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8684
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8456
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8942
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8526
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8675
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4924
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.5051
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.5682
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.5227
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 20 ============
denominator: 21424.63671875
 Site-MNIST                         | Train Loss: 0.5869 | Train Acc: 0.8356
 Site-MNIST                         | Train Loss: 0.5602 | Train Acc: 0.8609
 Site-MNIST                         | Train Loss: 0.6453 | Train Acc: 0.8442
 Site-MNIST                         | Train Loss: 0.5901 | Train Acc: 0.8515
 Site-MNIST                         | Train Loss: 0.5883 | Train Acc: 0.8625
 Site-USPS                          | Train Loss: 0.5596 | Train Acc: 0.8729
 Site-USPS                          | Train Loss: 0.5156 | Train Acc: 0.8914
 Site-USPS                          | Train Loss: 0.5050 | Train Acc: 0.8956
 Site-SynthDigits                   | Train Loss: 1.5567 | Train Acc: 0.4886
 Site-SynthDigits                   | Train Loss: 1.5054 | Train Acc: 0.5581
 Site-MNIST_M                       | Train Loss: 1.7247 | Train Acc: 0.5369
 Site-MNIST_M                       | Train Loss: 1.8369 | Train Acc: 0.4583
 Site-SVHN                          | Train Loss: 2.0044 | Train Acc: 0.3186
Average Train Accuracy: 0.7135
 Site-MNIST                         | Val  Loss: 0.5538 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.5670 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.5896 | Val  Acc: 0.8968
 Site-MNIST                         | Val  Loss: 0.6104 | Val  Acc: 0.8842
 Site-MNIST                         | Val  Loss: 0.6060 | Val  Acc: 0.8526
 Site-USPS                          | Val  Loss: 0.4949 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.5460 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.5513 | Val  Acc: 0.8803
 Site-SynthDigits                   | Val  Loss: 1.6935 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.4929 | Val  Acc: 0.5152
 Site-MNIST_M                       | Val  Loss: 1.6307 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.6389 | Val  Acc: 0.5379
 Site-SVHN                          | Val  Loss: 2.0421 | Val  Acc: 0.3082
Average Valid Accuracy: 0.7266
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8393
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8810
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8968
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8842
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8526
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8942
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8654
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8803
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5152
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5909
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5379
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3082
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 21 ============
denominator: 21039.2890625
 Site-MNIST                         | Train Loss: 0.5619 | Train Acc: 0.8489
 Site-MNIST                         | Train Loss: 0.5420 | Train Acc: 0.8639
 Site-MNIST                         | Train Loss: 0.6131 | Train Acc: 0.8540
 Site-MNIST                         | Train Loss: 0.5584 | Train Acc: 0.8620
 Site-MNIST                         | Train Loss: 0.5534 | Train Acc: 0.8704
 Site-USPS                          | Train Loss: 0.5502 | Train Acc: 0.8801
 Site-USPS                          | Train Loss: 0.4924 | Train Acc: 0.8946
 Site-USPS                          | Train Loss: 0.4857 | Train Acc: 0.9020
 Site-SynthDigits                   | Train Loss: 1.5404 | Train Acc: 0.4905
 Site-SynthDigits                   | Train Loss: 1.4877 | Train Acc: 0.5619
 Site-MNIST_M                       | Train Loss: 1.7071 | Train Acc: 0.5369
 Site-MNIST_M                       | Train Loss: 1.8115 | Train Acc: 0.4602
 Site-SVHN                          | Train Loss: 2.0204 | Train Acc: 0.3169
Average Train Accuracy: 0.7186
 Site-MNIST                         | Val  Loss: 0.5272 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.5389 | Val  Acc: 0.8690
 Site-MNIST                         | Val  Loss: 0.5575 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.5781 | Val  Acc: 0.8842
 Site-MNIST                         | Val  Loss: 0.5762 | Val  Acc: 0.8561
 Site-USPS                          | Val  Loss: 0.4727 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.5279 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.5316 | Val  Acc: 0.8846
 Site-SynthDigits                   | Val  Loss: 1.6805 | Val  Acc: 0.4924
 Site-SynthDigits                   | Val  Loss: 1.4683 | Val  Acc: 0.5152
 Site-MNIST_M                       | Val  Loss: 1.6018 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.6170 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 2.0321 | Val  Acc: 0.3082
Average Valid Accuracy: 0.7271
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8690
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8842
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8561
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8942
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8654
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8846
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.4924
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.5152
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.5909
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.5455
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.3082
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 22 ============
denominator: 20612.16015625
 Site-MNIST                         | Train Loss: 0.5289 | Train Acc: 0.8578
 Site-MNIST                         | Train Loss: 0.5319 | Train Acc: 0.8698
 Site-MNIST                         | Train Loss: 0.5865 | Train Acc: 0.8560
 Site-MNIST                         | Train Loss: 0.5312 | Train Acc: 0.8712
 Site-MNIST                         | Train Loss: 0.5289 | Train Acc: 0.8809
 Site-USPS                          | Train Loss: 0.5204 | Train Acc: 0.8777
 Site-USPS                          | Train Loss: 0.4740 | Train Acc: 0.8946
 Site-USPS                          | Train Loss: 0.4623 | Train Acc: 0.9084
 Site-SynthDigits                   | Train Loss: 1.5566 | Train Acc: 0.4886
 Site-SynthDigits                   | Train Loss: 1.4656 | Train Acc: 0.5631
 Site-MNIST_M                       | Train Loss: 1.6895 | Train Acc: 0.5483
 Site-MNIST_M                       | Train Loss: 1.7852 | Train Acc: 0.4716
 Site-SVHN                          | Train Loss: 2.0043 | Train Acc: 0.3186
Average Train Accuracy: 0.7236
 Site-MNIST                         | Val  Loss: 0.4984 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.5070 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.5304 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.5508 | Val  Acc: 0.8789
 Site-MNIST                         | Val  Loss: 0.5465 | Val  Acc: 0.8596
 Site-USPS                          | Val  Loss: 0.4430 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.5033 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.5076 | Val  Acc: 0.8803
 Site-SynthDigits                   | Val  Loss: 1.6635 | Val  Acc: 0.4924
 Site-SynthDigits                   | Val  Loss: 1.4528 | Val  Acc: 0.5101
 Site-MNIST_M                       | Val  Loss: 1.5738 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.5917 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 2.0240 | Val  Acc: 0.3151
Average Valid Accuracy: 0.7285
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8810
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8789
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8596
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8942
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8654
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8803
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.4924
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.5101
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.6023
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5455
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.3151
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 23 ============
denominator: 20291.6484375
 Site-MNIST                         | Train Loss: 0.5150 | Train Acc: 0.8622
 Site-MNIST                         | Train Loss: 0.4634 | Train Acc: 0.8757
 Site-MNIST                         | Train Loss: 0.5611 | Train Acc: 0.8600
 Site-MNIST                         | Train Loss: 0.5087 | Train Acc: 0.8712
 Site-MNIST                         | Train Loss: 0.5069 | Train Acc: 0.8835
 Site-USPS                          | Train Loss: 0.5129 | Train Acc: 0.8801
 Site-USPS                          | Train Loss: 0.4535 | Train Acc: 0.8962
 Site-USPS                          | Train Loss: 0.4411 | Train Acc: 0.9095
 Site-SynthDigits                   | Train Loss: 1.5002 | Train Acc: 0.4981
 Site-SynthDigits                   | Train Loss: 1.4437 | Train Acc: 0.5669
 Site-MNIST_M                       | Train Loss: 1.6648 | Train Acc: 0.5369
 Site-MNIST_M                       | Train Loss: 1.7883 | Train Acc: 0.4697
 Site-SVHN                          | Train Loss: 2.0077 | Train Acc: 0.3186
Average Train Accuracy: 0.7253
 Site-MNIST                         | Val  Loss: 0.4763 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.4839 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.5093 | Val  Acc: 0.8968
 Site-MNIST                         | Val  Loss: 0.5288 | Val  Acc: 0.8789
 Site-MNIST                         | Val  Loss: 0.5219 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.4230 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.4876 | Val  Acc: 0.8590
 Site-USPS                          | Val  Loss: 0.4892 | Val  Acc: 0.8761
 Site-SynthDigits                   | Val  Loss: 1.6464 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.4316 | Val  Acc: 0.5303
 Site-MNIST_M                       | Val  Loss: 1.5526 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.5675 | Val  Acc: 0.5379
 Site-SVHN                          | Val  Loss: 2.0157 | Val  Acc: 0.3082
Average Valid Accuracy: 0.7299
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8968
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8789
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8667
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8942
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8590
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8761
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.5303
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.5909
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.5379
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.3082
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 24 ============
denominator: 20053.7890625
 Site-MNIST                         | Train Loss: 0.5135 | Train Acc: 0.8622
 Site-MNIST                         | Train Loss: 0.4705 | Train Acc: 0.8905
 Site-MNIST                         | Train Loss: 0.5412 | Train Acc: 0.8600
 Site-MNIST                         | Train Loss: 0.4859 | Train Acc: 0.8765
 Site-MNIST                         | Train Loss: 0.4860 | Train Acc: 0.8879
 Site-USPS                          | Train Loss: 0.4840 | Train Acc: 0.8777
 Site-USPS                          | Train Loss: 0.4357 | Train Acc: 0.8994
 Site-USPS                          | Train Loss: 0.4221 | Train Acc: 0.9105
 Site-SynthDigits                   | Train Loss: 1.5272 | Train Acc: 0.4905
 Site-SynthDigits                   | Train Loss: 1.4231 | Train Acc: 0.5745
 Site-MNIST_M                       | Train Loss: 1.6351 | Train Acc: 0.5483
 Site-MNIST_M                       | Train Loss: 1.7582 | Train Acc: 0.4792
 Site-SVHN                          | Train Loss: 1.9870 | Train Acc: 0.3220
Average Train Accuracy: 0.7292
 Site-MNIST                         | Val  Loss: 0.4529 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.4603 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.4877 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.5065 | Val  Acc: 0.8842
 Site-MNIST                         | Val  Loss: 0.4980 | Val  Acc: 0.8842
 Site-USPS                          | Val  Loss: 0.4040 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.4658 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.4691 | Val  Acc: 0.8761
 Site-SynthDigits                   | Val  Loss: 1.6193 | Val  Acc: 0.4773
 Site-SynthDigits                   | Val  Loss: 1.4123 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.5238 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.5317 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 2.0079 | Val  Acc: 0.3082
Average Valid Accuracy: 0.7300
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8842
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8842
 Best site-USPS                      | Epoch:24 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8654
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8761
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.4773
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.5909
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.5455
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3082
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 25 ============
denominator: 19544.33984375
 Site-MNIST                         | Train Loss: 0.4910 | Train Acc: 0.8622
 Site-MNIST                         | Train Loss: 0.4652 | Train Acc: 0.8905
 Site-MNIST                         | Train Loss: 0.5209 | Train Acc: 0.8679
 Site-MNIST                         | Train Loss: 0.4678 | Train Acc: 0.8817
 Site-MNIST                         | Train Loss: 0.4705 | Train Acc: 0.8897
 Site-USPS                          | Train Loss: 0.4716 | Train Acc: 0.8825
 Site-USPS                          | Train Loss: 0.4169 | Train Acc: 0.9026
 Site-USPS                          | Train Loss: 0.4016 | Train Acc: 0.9159
 Site-SynthDigits                   | Train Loss: 1.4743 | Train Acc: 0.4943
 Site-SynthDigits                   | Train Loss: 1.3987 | Train Acc: 0.5758
 Site-MNIST_M                       | Train Loss: 1.6424 | Train Acc: 0.5511
 Site-MNIST_M                       | Train Loss: 1.7675 | Train Acc: 0.4697
 Site-SVHN                          | Train Loss: 1.9942 | Train Acc: 0.3203
Average Train Accuracy: 0.7311
 Site-MNIST                         | Val  Loss: 0.4339 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.4377 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.4692 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.4875 | Val  Acc: 0.8895
 Site-MNIST                         | Val  Loss: 0.4779 | Val  Acc: 0.8842
 Site-USPS                          | Val  Loss: 0.3820 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.4463 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.4525 | Val  Acc: 0.8803
 Site-SynthDigits                   | Val  Loss: 1.6066 | Val  Acc: 0.4924
 Site-SynthDigits                   | Val  Loss: 1.3970 | Val  Acc: 0.5051
 Site-MNIST_M                       | Val  Loss: 1.5102 | Val  Acc: 0.6136
 Site-MNIST_M                       | Val  Loss: 1.5180 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 2.0002 | Val  Acc: 0.3082
Average Valid Accuracy: 0.7350
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8895
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8842
 Best site-USPS                      | Epoch:25 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8654
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8803
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.4924
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.5051
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.6136
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.5455
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.3082
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 26 ============
denominator: 19456.9140625
 Site-MNIST                         | Train Loss: 0.4590 | Train Acc: 0.8844
 Site-MNIST                         | Train Loss: 0.4203 | Train Acc: 0.8964
 Site-MNIST                         | Train Loss: 0.5037 | Train Acc: 0.8698
 Site-MNIST                         | Train Loss: 0.4489 | Train Acc: 0.8896
 Site-MNIST                         | Train Loss: 0.4492 | Train Acc: 0.8949
 Site-USPS                          | Train Loss: 0.4396 | Train Acc: 0.8849
 Site-USPS                          | Train Loss: 0.4042 | Train Acc: 0.9042
 Site-USPS                          | Train Loss: 0.3967 | Train Acc: 0.9127
 Site-SynthDigits                   | Train Loss: 1.4651 | Train Acc: 0.5076
 Site-SynthDigits                   | Train Loss: 1.3811 | Train Acc: 0.5758
 Site-MNIST_M                       | Train Loss: 1.6064 | Train Acc: 0.5511
 Site-MNIST_M                       | Train Loss: 1.7020 | Train Acc: 0.4792
 Site-SVHN                          | Train Loss: 1.9625 | Train Acc: 0.3152
Average Train Accuracy: 0.7358
 Site-MNIST                         | Val  Loss: 0.4152 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.4201 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.4479 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.4676 | Val  Acc: 0.8947
 Site-MNIST                         | Val  Loss: 0.4569 | Val  Acc: 0.8912
 Site-USPS                          | Val  Loss: 0.3726 | Val  Acc: 0.9135
 Site-USPS                          | Val  Loss: 0.4378 | Val  Acc: 0.8718
 Site-USPS                          | Val  Loss: 0.4390 | Val  Acc: 0.8846
 Site-SynthDigits                   | Val  Loss: 1.5834 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.3756 | Val  Acc: 0.5101
 Site-MNIST_M                       | Val  Loss: 1.4743 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.4846 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 1.9962 | Val  Acc: 0.2945
Average Valid Accuracy: 0.7353
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9127
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8947
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8912
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9135
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8718
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8846
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.5101
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5909
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5455
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.2945
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 27 ============
denominator: 19206.3984375
 Site-MNIST                         | Train Loss: 0.4543 | Train Acc: 0.9022
 Site-MNIST                         | Train Loss: 0.4177 | Train Acc: 0.9024
 Site-MNIST                         | Train Loss: 0.4795 | Train Acc: 0.8777
 Site-MNIST                         | Train Loss: 0.4283 | Train Acc: 0.8988
 Site-MNIST                         | Train Loss: 0.4300 | Train Acc: 0.8967
 Site-USPS                          | Train Loss: 0.4359 | Train Acc: 0.8897
 Site-USPS                          | Train Loss: 0.3890 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.3755 | Train Acc: 0.9191
 Site-SynthDigits                   | Train Loss: 1.4518 | Train Acc: 0.5038
 Site-SynthDigits                   | Train Loss: 1.3715 | Train Acc: 0.5846
 Site-MNIST_M                       | Train Loss: 1.5715 | Train Acc: 0.5540
 Site-MNIST_M                       | Train Loss: 1.6905 | Train Acc: 0.4773
 Site-SVHN                          | Train Loss: 1.9531 | Train Acc: 0.3118
Average Train Accuracy: 0.7405
 Site-MNIST                         | Val  Loss: 0.3972 | Val  Acc: 0.8750
 Site-MNIST                         | Val  Loss: 0.4004 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.4261 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.4486 | Val  Acc: 0.8947
 Site-MNIST                         | Val  Loss: 0.4376 | Val  Acc: 0.8982
 Site-USPS                          | Val  Loss: 0.3542 | Val  Acc: 0.9135
 Site-USPS                          | Val  Loss: 0.4225 | Val  Acc: 0.8718
 Site-USPS                          | Val  Loss: 0.4235 | Val  Acc: 0.8846
 Site-SynthDigits                   | Val  Loss: 1.5745 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.3600 | Val  Acc: 0.5152
 Site-MNIST_M                       | Val  Loss: 1.4665 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.4768 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 1.9832 | Val  Acc: 0.2945
Average Valid Accuracy: 0.7421
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8750
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9127
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8947
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8982
 Best site-USPS                      | Epoch:27 | Val Acc: 0.9135
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8718
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8846
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5152
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.6250
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.5455
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.2945
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 28 ============
denominator: 18823.404296875
 Site-MNIST                         | Train Loss: 0.4353 | Train Acc: 0.9022
 Site-MNIST                         | Train Loss: 0.4036 | Train Acc: 0.9053
 Site-MNIST                         | Train Loss: 0.4691 | Train Acc: 0.8738
 Site-MNIST                         | Train Loss: 0.4172 | Train Acc: 0.8936
 Site-MNIST                         | Train Loss: 0.4177 | Train Acc: 0.9011
 Site-USPS                          | Train Loss: 0.4207 | Train Acc: 0.8873
 Site-USPS                          | Train Loss: 0.3751 | Train Acc: 0.9121
 Site-USPS                          | Train Loss: 0.3626 | Train Acc: 0.9201
 Site-SynthDigits                   | Train Loss: 1.4462 | Train Acc: 0.5284
 Site-SynthDigits                   | Train Loss: 1.3507 | Train Acc: 0.5896
 Site-MNIST_M                       | Train Loss: 1.5460 | Train Acc: 0.5540
 Site-MNIST_M                       | Train Loss: 1.6978 | Train Acc: 0.4735
 Site-SVHN                          | Train Loss: 1.9533 | Train Acc: 0.3220
Average Train Accuracy: 0.7433
 Site-MNIST                         | Val  Loss: 0.3828 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.3857 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.4152 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.4370 | Val  Acc: 0.8895
 Site-MNIST                         | Val  Loss: 0.4224 | Val  Acc: 0.8982
 Site-USPS                          | Val  Loss: 0.3398 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.4091 | Val  Acc: 0.8782
 Site-USPS                          | Val  Loss: 0.4093 | Val  Acc: 0.8846
 Site-SynthDigits                   | Val  Loss: 1.5450 | Val  Acc: 0.5076
 Site-SynthDigits                   | Val  Loss: 1.3393 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.4299 | Val  Acc: 0.6136
 Site-MNIST_M                       | Val  Loss: 1.4398 | Val  Acc: 0.5682
 Site-SVHN                          | Val  Loss: 1.9777 | Val  Acc: 0.3151
Average Valid Accuracy: 0.7462
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.8895
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.8982
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8782
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8846
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.5076
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.6136
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.5682
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.3151
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 29 ============
denominator: 18674.021484375
 Site-MNIST                         | Train Loss: 0.4180 | Train Acc: 0.9022
 Site-MNIST                         | Train Loss: 0.4131 | Train Acc: 0.9083
 Site-MNIST                         | Train Loss: 0.4512 | Train Acc: 0.8797
 Site-MNIST                         | Train Loss: 0.4022 | Train Acc: 0.9001
 Site-MNIST                         | Train Loss: 0.4031 | Train Acc: 0.9028
 Site-USPS                          | Train Loss: 0.4039 | Train Acc: 0.8849
 Site-USPS                          | Train Loss: 0.3647 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.3541 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.3816 | Train Acc: 0.5265
 Site-SynthDigits                   | Train Loss: 1.3241 | Train Acc: 0.5972
 Site-MNIST_M                       | Train Loss: 1.5538 | Train Acc: 0.5568
 Site-MNIST_M                       | Train Loss: 1.6814 | Train Acc: 0.4773
 Site-SVHN                          | Train Loss: 1.9618 | Train Acc: 0.3237
Average Train Accuracy: 0.7454
 Site-MNIST                         | Val  Loss: 0.3701 | Val  Acc: 0.8750
 Site-MNIST                         | Val  Loss: 0.3721 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3999 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.4249 | Val  Acc: 0.8947
 Site-MNIST                         | Val  Loss: 0.4097 | Val  Acc: 0.9018
 Site-USPS                          | Val  Loss: 0.3284 | Val  Acc: 0.9135
 Site-USPS                          | Val  Loss: 0.3985 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.3990 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.5325 | Val  Acc: 0.5076
 Site-SynthDigits                   | Val  Loss: 1.3212 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.4145 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.4243 | Val  Acc: 0.5606
 Site-SVHN                          | Val  Loss: 1.9629 | Val  Acc: 0.3219
Average Valid Accuracy: 0.7511
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8750
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9127
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8947
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9018
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9135
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5076
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.6250
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.5606
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3219
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 30 ============
denominator: 18455.154296875
 Site-MNIST                         | Train Loss: 0.4082 | Train Acc: 0.9067
 Site-MNIST                         | Train Loss: 0.3599 | Train Acc: 0.9112
 Site-MNIST                         | Train Loss: 0.4392 | Train Acc: 0.8817
 Site-MNIST                         | Train Loss: 0.3885 | Train Acc: 0.9041
 Site-MNIST                         | Train Loss: 0.3898 | Train Acc: 0.9046
 Site-USPS                          | Train Loss: 0.4016 | Train Acc: 0.8969
 Site-USPS                          | Train Loss: 0.3558 | Train Acc: 0.9105
 Site-USPS                          | Train Loss: 0.3462 | Train Acc: 0.9191
 Site-SynthDigits                   | Train Loss: 1.3702 | Train Acc: 0.5511
 Site-SynthDigits                   | Train Loss: 1.3087 | Train Acc: 0.5972
 Site-MNIST_M                       | Train Loss: 1.5355 | Train Acc: 0.5568
 Site-MNIST_M                       | Train Loss: 1.6716 | Train Acc: 0.4792
 Site-SVHN                          | Train Loss: 1.9447 | Train Acc: 0.3237
Average Train Accuracy: 0.7494
 Site-MNIST                         | Val  Loss: 0.3603 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.3611 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.3861 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.4090 | Val  Acc: 0.8947
 Site-MNIST                         | Val  Loss: 0.3956 | Val  Acc: 0.9053
 Site-USPS                          | Val  Loss: 0.3196 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.3941 | Val  Acc: 0.8782
 Site-USPS                          | Val  Loss: 0.3908 | Val  Acc: 0.8974
 Site-SynthDigits                   | Val  Loss: 1.5292 | Val  Acc: 0.5076
 Site-SynthDigits                   | Val  Loss: 1.3002 | Val  Acc: 0.5808
 Site-MNIST_M                       | Val  Loss: 1.3948 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.4071 | Val  Acc: 0.5682
 Site-SVHN                          | Val  Loss: 1.9735 | Val  Acc: 0.3151
Average Valid Accuracy: 0.7533
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9127
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8947
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9053
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8782
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8974
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5076
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5808
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.6477
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5682
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.3151
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 31 ============
denominator: 18224.107421875
 Site-MNIST                         | Train Loss: 0.3937 | Train Acc: 0.9067
 Site-MNIST                         | Train Loss: 0.3512 | Train Acc: 0.9142
 Site-MNIST                         | Train Loss: 0.4224 | Train Acc: 0.8876
 Site-MNIST                         | Train Loss: 0.3742 | Train Acc: 0.9093
 Site-MNIST                         | Train Loss: 0.3757 | Train Acc: 0.9072
 Site-USPS                          | Train Loss: 0.3839 | Train Acc: 0.8945
 Site-USPS                          | Train Loss: 0.3459 | Train Acc: 0.9153
 Site-USPS                          | Train Loss: 0.3346 | Train Acc: 0.9223
 Site-SynthDigits                   | Train Loss: 1.3907 | Train Acc: 0.5417
 Site-SynthDigits                   | Train Loss: 1.3072 | Train Acc: 0.6035
 Site-MNIST_M                       | Train Loss: 1.5183 | Train Acc: 0.5625
 Site-MNIST_M                       | Train Loss: 1.6577 | Train Acc: 0.4943
 Site-SVHN                          | Train Loss: 1.9265 | Train Acc: 0.3203
Average Train Accuracy: 0.7523
 Site-MNIST                         | Val  Loss: 0.3452 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.3441 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3692 | Val  Acc: 0.9206
 Site-MNIST                         | Val  Loss: 0.3899 | Val  Acc: 0.9053
 Site-MNIST                         | Val  Loss: 0.3733 | Val  Acc: 0.9088
 Site-USPS                          | Val  Loss: 0.3057 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.3792 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.3793 | Val  Acc: 0.8974
 Site-SynthDigits                   | Val  Loss: 1.5031 | Val  Acc: 0.5152
 Site-SynthDigits                   | Val  Loss: 1.2940 | Val  Acc: 0.5707
 Site-MNIST_M                       | Val  Loss: 1.3802 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.3838 | Val  Acc: 0.5682
 Site-SVHN                          | Val  Loss: 1.9589 | Val  Acc: 0.3014
Average Valid Accuracy: 0.7561
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9206
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9053
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9088
 Best site-USPS                      | Epoch:31 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8846
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8974
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5152
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5707
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.6250
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.5682
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.3014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 32 ============
denominator: 18028.951171875
 Site-MNIST                         | Train Loss: 0.3733 | Train Acc: 0.9067
 Site-MNIST                         | Train Loss: 0.3588 | Train Acc: 0.9112
 Site-MNIST                         | Train Loss: 0.4142 | Train Acc: 0.8817
 Site-MNIST                         | Train Loss: 0.3667 | Train Acc: 0.9106
 Site-MNIST                         | Train Loss: 0.3667 | Train Acc: 0.9116
 Site-USPS                          | Train Loss: 0.3787 | Train Acc: 0.8873
 Site-USPS                          | Train Loss: 0.3398 | Train Acc: 0.9137
 Site-USPS                          | Train Loss: 0.3286 | Train Acc: 0.9244
 Site-SynthDigits                   | Train Loss: 1.3576 | Train Acc: 0.5530
 Site-SynthDigits                   | Train Loss: 1.2893 | Train Acc: 0.6086
 Site-MNIST_M                       | Train Loss: 1.4986 | Train Acc: 0.5710
 Site-MNIST_M                       | Train Loss: 1.6056 | Train Acc: 0.4830
 Site-SVHN                          | Train Loss: 1.9124 | Train Acc: 0.3271
Average Train Accuracy: 0.7531
 Site-MNIST                         | Val  Loss: 0.3369 | Val  Acc: 0.8750
 Site-MNIST                         | Val  Loss: 0.3371 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.3618 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.3872 | Val  Acc: 0.8947
 Site-MNIST                         | Val  Loss: 0.3686 | Val  Acc: 0.9053
 Site-USPS                          | Val  Loss: 0.2995 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.3737 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.3725 | Val  Acc: 0.8932
 Site-SynthDigits                   | Val  Loss: 1.5021 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.2848 | Val  Acc: 0.5859
 Site-MNIST_M                       | Val  Loss: 1.3473 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.3526 | Val  Acc: 0.5833
 Site-SVHN                          | Val  Loss: 1.9595 | Val  Acc: 0.3151
Average Valid Accuracy: 0.7549
============ Train epoch 33 ============
denominator: 17883.8671875
 Site-MNIST                         | Train Loss: 0.3770 | Train Acc: 0.9156
 Site-MNIST                         | Train Loss: 0.3187 | Train Acc: 0.9290
 Site-MNIST                         | Train Loss: 0.3999 | Train Acc: 0.8955
 Site-MNIST                         | Train Loss: 0.3495 | Train Acc: 0.9185
 Site-MNIST                         | Train Loss: 0.3549 | Train Acc: 0.9107
 Site-USPS                          | Train Loss: 0.3703 | Train Acc: 0.9041
 Site-USPS                          | Train Loss: 0.3309 | Train Acc: 0.9185
 Site-USPS                          | Train Loss: 0.3177 | Train Acc: 0.9255
 Site-SynthDigits                   | Train Loss: 1.3453 | Train Acc: 0.5587
 Site-SynthDigits                   | Train Loss: 1.2843 | Train Acc: 0.6111
 Site-MNIST_M                       | Train Loss: 1.4919 | Train Acc: 0.5852
 Site-MNIST_M                       | Train Loss: 1.6268 | Train Acc: 0.4962
 Site-SVHN                          | Train Loss: 1.9177 | Train Acc: 0.3220
Average Train Accuracy: 0.7608
 Site-MNIST                         | Val  Loss: 0.3258 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3202 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3475 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3680 | Val  Acc: 0.9158
 Site-MNIST                         | Val  Loss: 0.3506 | Val  Acc: 0.9263
 Site-USPS                          | Val  Loss: 0.2873 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.3662 | Val  Acc: 0.8974
 Site-USPS                          | Val  Loss: 0.3645 | Val  Acc: 0.9060
 Site-SynthDigits                   | Val  Loss: 1.4983 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.2731 | Val  Acc: 0.6010
 Site-MNIST_M                       | Val  Loss: 1.3433 | Val  Acc: 0.6705
 Site-MNIST_M                       | Val  Loss: 1.3560 | Val  Acc: 0.5682
 Site-SVHN                          | Val  Loss: 1.9502 | Val  Acc: 0.3014
Average Valid Accuracy: 0.7702
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9365
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9158
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9263
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9327
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8974
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9060
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.6010
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.6705
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5682
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.3014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 34 ============
denominator: 17693.994140625
 Site-MNIST                         | Train Loss: 0.3770 | Train Acc: 0.9156
 Site-MNIST                         | Train Loss: 0.3068 | Train Acc: 0.9260
 Site-MNIST                         | Train Loss: 0.3907 | Train Acc: 0.8935
 Site-MNIST                         | Train Loss: 0.3416 | Train Acc: 0.9172
 Site-MNIST                         | Train Loss: 0.3469 | Train Acc: 0.9124
 Site-USPS                          | Train Loss: 0.3676 | Train Acc: 0.8921
 Site-USPS                          | Train Loss: 0.3197 | Train Acc: 0.9153
 Site-USPS                          | Train Loss: 0.3069 | Train Acc: 0.9233
 Site-SynthDigits                   | Train Loss: 1.3477 | Train Acc: 0.5625
 Site-SynthDigits                   | Train Loss: 1.2546 | Train Acc: 0.6162
 Site-MNIST_M                       | Train Loss: 1.4569 | Train Acc: 0.5739
 Site-MNIST_M                       | Train Loss: 1.6260 | Train Acc: 0.4981
 Site-SVHN                          | Train Loss: 1.8871 | Train Acc: 0.3237
Average Train Accuracy: 0.7592
 Site-MNIST                         | Val  Loss: 0.3124 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.3114 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3424 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3628 | Val  Acc: 0.9105
 Site-MNIST                         | Val  Loss: 0.3412 | Val  Acc: 0.9228
 Site-USPS                          | Val  Loss: 0.2785 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.3553 | Val  Acc: 0.8782
 Site-USPS                          | Val  Loss: 0.3532 | Val  Acc: 0.8974
 Site-SynthDigits                   | Val  Loss: 1.4586 | Val  Acc: 0.5076
 Site-SynthDigits                   | Val  Loss: 1.2452 | Val  Acc: 0.6010
 Site-MNIST_M                       | Val  Loss: 1.3226 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.3349 | Val  Acc: 0.5833
 Site-SVHN                          | Val  Loss: 1.9398 | Val  Acc: 0.3151
Average Valid Accuracy: 0.7649
============ Train epoch 35 ============
denominator: 17399.962890625
 Site-MNIST                         | Train Loss: 0.3511 | Train Acc: 0.9156
 Site-MNIST                         | Train Loss: 0.3081 | Train Acc: 0.9349
 Site-MNIST                         | Train Loss: 0.3793 | Train Acc: 0.8994
 Site-MNIST                         | Train Loss: 0.3323 | Train Acc: 0.9198
 Site-MNIST                         | Train Loss: 0.3349 | Train Acc: 0.9124
 Site-USPS                          | Train Loss: 0.3499 | Train Acc: 0.9017
 Site-USPS                          | Train Loss: 0.3093 | Train Acc: 0.9169
 Site-USPS                          | Train Loss: 0.3036 | Train Acc: 0.9223
 Site-SynthDigits                   | Train Loss: 1.3422 | Train Acc: 0.5606
 Site-SynthDigits                   | Train Loss: 1.2415 | Train Acc: 0.6111
 Site-MNIST_M                       | Train Loss: 1.4421 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.6010 | Train Acc: 0.4962
 Site-SVHN                          | Train Loss: 1.9268 | Train Acc: 0.3169
Average Train Accuracy: 0.7606
 Site-MNIST                         | Val  Loss: 0.3046 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3010 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3281 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3497 | Val  Acc: 0.9263
 Site-MNIST                         | Val  Loss: 0.3306 | Val  Acc: 0.9333
 Site-USPS                          | Val  Loss: 0.2711 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.3457 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.3445 | Val  Acc: 0.9017
 Site-SynthDigits                   | Val  Loss: 1.4611 | Val  Acc: 0.5076
 Site-SynthDigits                   | Val  Loss: 1.2487 | Val  Acc: 0.5859
 Site-MNIST_M                       | Val  Loss: 1.2960 | Val  Acc: 0.6818
 Site-MNIST_M                       | Val  Loss: 1.3115 | Val  Acc: 0.5682
 Site-SVHN                          | Val  Loss: 1.9512 | Val  Acc: 0.2877
Average Valid Accuracy: 0.7695
============ Train epoch 36 ============
denominator: 17434.06640625
 Site-MNIST                         | Train Loss: 0.3481 | Train Acc: 0.9156
 Site-MNIST                         | Train Loss: 0.2987 | Train Acc: 0.9408
 Site-MNIST                         | Train Loss: 0.3739 | Train Acc: 0.8955
 Site-MNIST                         | Train Loss: 0.3299 | Train Acc: 0.9146
 Site-MNIST                         | Train Loss: 0.3354 | Train Acc: 0.9116
 Site-USPS                          | Train Loss: 0.3449 | Train Acc: 0.8969
 Site-USPS                          | Train Loss: 0.3064 | Train Acc: 0.9169
 Site-USPS                          | Train Loss: 0.2960 | Train Acc: 0.9276
 Site-SynthDigits                   | Train Loss: 1.2983 | Train Acc: 0.5663
 Site-SynthDigits                   | Train Loss: 1.2446 | Train Acc: 0.6199
 Site-MNIST_M                       | Train Loss: 1.4098 | Train Acc: 0.5767
 Site-MNIST_M                       | Train Loss: 1.5871 | Train Acc: 0.4924
 Site-SVHN                          | Train Loss: 1.8950 | Train Acc: 0.3254
Average Train Accuracy: 0.7615
 Site-MNIST                         | Val  Loss: 0.2978 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2944 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3261 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3461 | Val  Acc: 0.9316
 Site-MNIST                         | Val  Loss: 0.3250 | Val  Acc: 0.9404
 Site-USPS                          | Val  Loss: 0.2640 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.3364 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.3374 | Val  Acc: 0.8974
 Site-SynthDigits                   | Val  Loss: 1.4164 | Val  Acc: 0.5152
 Site-SynthDigits                   | Val  Loss: 1.2217 | Val  Acc: 0.6010
 Site-MNIST_M                       | Val  Loss: 1.2869 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.2983 | Val  Acc: 0.5909
 Site-SVHN                          | Val  Loss: 1.9238 | Val  Acc: 0.3014
Average Valid Accuracy: 0.7719
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9316
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9404
 Best site-USPS                      | Epoch:36 | Val Acc: 0.9327
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8974
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.5152
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.6010
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.6477
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.5909
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.3014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 37 ============
denominator: 17230.48828125
 Site-MNIST                         | Train Loss: 0.3298 | Train Acc: 0.9156
 Site-MNIST                         | Train Loss: 0.2729 | Train Acc: 0.9349
 Site-MNIST                         | Train Loss: 0.3591 | Train Acc: 0.8974
 Site-MNIST                         | Train Loss: 0.3147 | Train Acc: 0.9225
 Site-MNIST                         | Train Loss: 0.3196 | Train Acc: 0.9203
 Site-USPS                          | Train Loss: 0.3281 | Train Acc: 0.9041
 Site-USPS                          | Train Loss: 0.3009 | Train Acc: 0.9217
 Site-USPS                          | Train Loss: 0.2922 | Train Acc: 0.9286
 Site-SynthDigits                   | Train Loss: 1.3196 | Train Acc: 0.5663
 Site-SynthDigits                   | Train Loss: 1.2243 | Train Acc: 0.6187
 Site-MNIST_M                       | Train Loss: 1.4242 | Train Acc: 0.5852
 Site-MNIST_M                       | Train Loss: 1.5695 | Train Acc: 0.5019
 Site-SVHN                          | Train Loss: 1.9089 | Train Acc: 0.3271
Average Train Accuracy: 0.7649
 Site-MNIST                         | Val  Loss: 0.2904 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2869 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3131 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3337 | Val  Acc: 0.9211
 Site-MNIST                         | Val  Loss: 0.3091 | Val  Acc: 0.9333
 Site-USPS                          | Val  Loss: 0.2567 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.3308 | Val  Acc: 0.8974
 Site-USPS                          | Val  Loss: 0.3307 | Val  Acc: 0.9017
 Site-SynthDigits                   | Val  Loss: 1.4242 | Val  Acc: 0.5152
 Site-SynthDigits                   | Val  Loss: 1.2119 | Val  Acc: 0.5960
 Site-MNIST_M                       | Val  Loss: 1.2768 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.2896 | Val  Acc: 0.5833
 Site-SVHN                          | Val  Loss: 1.9250 | Val  Acc: 0.2945
Average Valid Accuracy: 0.7705
============ Train epoch 38 ============
denominator: 16966.19921875
 Site-MNIST                         | Train Loss: 0.3402 | Train Acc: 0.9156
 Site-MNIST                         | Train Loss: 0.2756 | Train Acc: 0.9438
 Site-MNIST                         | Train Loss: 0.3527 | Train Acc: 0.8974
 Site-MNIST                         | Train Loss: 0.3068 | Train Acc: 0.9225
 Site-MNIST                         | Train Loss: 0.3116 | Train Acc: 0.9221
 Site-USPS                          | Train Loss: 0.3320 | Train Acc: 0.8993
 Site-USPS                          | Train Loss: 0.2918 | Train Acc: 0.9169
 Site-USPS                          | Train Loss: 0.2841 | Train Acc: 0.9286
 Site-SynthDigits                   | Train Loss: 1.2869 | Train Acc: 0.5758
 Site-SynthDigits                   | Train Loss: 1.2061 | Train Acc: 0.6301
 Site-MNIST_M                       | Train Loss: 1.4160 | Train Acc: 0.5938
 Site-MNIST_M                       | Train Loss: 1.5497 | Train Acc: 0.5076
 Site-SVHN                          | Train Loss: 1.9010 | Train Acc: 0.3356
Average Train Accuracy: 0.7684
 Site-MNIST                         | Val  Loss: 0.2830 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.2802 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3067 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3261 | Val  Acc: 0.9316
 Site-MNIST                         | Val  Loss: 0.3017 | Val  Acc: 0.9439
 Site-USPS                          | Val  Loss: 0.2491 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.3190 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.3253 | Val  Acc: 0.9017
 Site-SynthDigits                   | Val  Loss: 1.3981 | Val  Acc: 0.5152
 Site-SynthDigits                   | Val  Loss: 1.1970 | Val  Acc: 0.5960
 Site-MNIST_M                       | Val  Loss: 1.2525 | Val  Acc: 0.6591
 Site-MNIST_M                       | Val  Loss: 1.2621 | Val  Acc: 0.5909
 Site-SVHN                          | Val  Loss: 1.9175 | Val  Acc: 0.3082
Average Valid Accuracy: 0.7728
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9365
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9316
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9439
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9327
 Best site-USPS                      | Epoch:38 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9017
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.5152
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.5960
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.6591
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.5909
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.3082
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 39 ============
denominator: 16967.73828125
 Site-MNIST                         | Train Loss: 0.3426 | Train Acc: 0.9200
 Site-MNIST                         | Train Loss: 0.2893 | Train Acc: 0.9379
 Site-MNIST                         | Train Loss: 0.3477 | Train Acc: 0.9034
 Site-MNIST                         | Train Loss: 0.3014 | Train Acc: 0.9251
 Site-MNIST                         | Train Loss: 0.3078 | Train Acc: 0.9194
 Site-USPS                          | Train Loss: 0.3169 | Train Acc: 0.9137
 Site-USPS                          | Train Loss: 0.2884 | Train Acc: 0.9201
 Site-USPS                          | Train Loss: 0.2873 | Train Acc: 0.9265
 Site-SynthDigits                   | Train Loss: 1.2798 | Train Acc: 0.5871
 Site-SynthDigits                   | Train Loss: 1.2027 | Train Acc: 0.6212
 Site-MNIST_M                       | Train Loss: 1.4070 | Train Acc: 0.5852
 Site-MNIST_M                       | Train Loss: 1.5430 | Train Acc: 0.5095
 Site-SVHN                          | Train Loss: 1.8916 | Train Acc: 0.3186
Average Train Accuracy: 0.7683
 Site-MNIST                         | Val  Loss: 0.2781 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2735 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3008 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3184 | Val  Acc: 0.9316
 Site-MNIST                         | Val  Loss: 0.2938 | Val  Acc: 0.9368
 Site-USPS                          | Val  Loss: 0.2480 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.3268 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.3205 | Val  Acc: 0.9145
 Site-SynthDigits                   | Val  Loss: 1.4256 | Val  Acc: 0.5227
 Site-SynthDigits                   | Val  Loss: 1.1776 | Val  Acc: 0.6212
 Site-MNIST_M                       | Val  Loss: 1.2336 | Val  Acc: 0.6591
 Site-MNIST_M                       | Val  Loss: 1.2610 | Val  Acc: 0.5909
 Site-SVHN                          | Val  Loss: 1.9355 | Val  Acc: 0.2740
Average Valid Accuracy: 0.7759
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9365
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9316
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9368
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9327
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9145
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.5227
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.6212
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.6591
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.5909
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.2740
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 40 ============
denominator: 16857.060546875
 Site-MNIST                         | Train Loss: 0.3280 | Train Acc: 0.9156
 Site-MNIST                         | Train Loss: 0.2655 | Train Acc: 0.9408
 Site-MNIST                         | Train Loss: 0.3365 | Train Acc: 0.9073
 Site-MNIST                         | Train Loss: 0.2929 | Train Acc: 0.9225
 Site-MNIST                         | Train Loss: 0.2994 | Train Acc: 0.9264
 Site-USPS                          | Train Loss: 0.3220 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.2783 | Train Acc: 0.9201
 Site-USPS                          | Train Loss: 0.2775 | Train Acc: 0.9265
 Site-SynthDigits                   | Train Loss: 1.2202 | Train Acc: 0.5795
 Site-SynthDigits                   | Train Loss: 1.1742 | Train Acc: 0.6301
 Site-MNIST_M                       | Train Loss: 1.3914 | Train Acc: 0.6023
 Site-MNIST_M                       | Train Loss: 1.5127 | Train Acc: 0.5019
 Site-SVHN                          | Train Loss: 1.8491 | Train Acc: 0.3339
Average Train Accuracy: 0.7704
 Site-MNIST                         | Val  Loss: 0.2620 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2587 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2949 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3113 | Val  Acc: 0.9368
 Site-MNIST                         | Val  Loss: 0.2839 | Val  Acc: 0.9404
 Site-USPS                          | Val  Loss: 0.2365 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.3098 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3141 | Val  Acc: 0.9103
 Site-SynthDigits                   | Val  Loss: 1.3621 | Val  Acc: 0.5152
 Site-SynthDigits                   | Val  Loss: 1.1648 | Val  Acc: 0.6010
 Site-MNIST_M                       | Val  Loss: 1.2275 | Val  Acc: 0.6818
 Site-MNIST_M                       | Val  Loss: 1.2348 | Val  Acc: 0.6061
 Site-SVHN                          | Val  Loss: 1.9015 | Val  Acc: 0.3219
Average Valid Accuracy: 0.7803
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9365
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9368
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9404
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9327
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9103
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.5152
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.6010
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.6818
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.6061
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.3219
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 41 ============
denominator: 16722.42578125
 Site-MNIST                         | Train Loss: 0.3113 | Train Acc: 0.9289
 Site-MNIST                         | Train Loss: 0.2804 | Train Acc: 0.9408
 Site-MNIST                         | Train Loss: 0.3363 | Train Acc: 0.9014
 Site-MNIST                         | Train Loss: 0.2923 | Train Acc: 0.9264
 Site-MNIST                         | Train Loss: 0.2982 | Train Acc: 0.9212
 Site-USPS                          | Train Loss: 0.3049 | Train Acc: 0.9041
 Site-USPS                          | Train Loss: 0.2756 | Train Acc: 0.9233
 Site-USPS                          | Train Loss: 0.2747 | Train Acc: 0.9276
 Site-SynthDigits                   | Train Loss: 1.2498 | Train Acc: 0.5833
 Site-SynthDigits                   | Train Loss: 1.1667 | Train Acc: 0.6402
 Site-MNIST_M                       | Train Loss: 1.3695 | Train Acc: 0.5909
 Site-MNIST_M                       | Train Loss: 1.5088 | Train Acc: 0.5095
 Site-SVHN                          | Train Loss: 1.9169 | Train Acc: 0.3254
Average Train Accuracy: 0.7710
 Site-MNIST                         | Val  Loss: 0.2704 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2676 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2866 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3071 | Val  Acc: 0.9368
 Site-MNIST                         | Val  Loss: 0.2837 | Val  Acc: 0.9404
 Site-USPS                          | Val  Loss: 0.2386 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.3089 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.3062 | Val  Acc: 0.9060
 Site-SynthDigits                   | Val  Loss: 1.3809 | Val  Acc: 0.5303
 Site-SynthDigits                   | Val  Loss: 1.1578 | Val  Acc: 0.6162
 Site-MNIST_M                       | Val  Loss: 1.2075 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.2342 | Val  Acc: 0.5758
 Site-SVHN                          | Val  Loss: 1.9172 | Val  Acc: 0.2808
Average Valid Accuracy: 0.7724
============ Train epoch 42 ============
denominator: 16695.990234375
 Site-MNIST                         | Train Loss: 0.2944 | Train Acc: 0.9244
 Site-MNIST                         | Train Loss: 0.2407 | Train Acc: 0.9438
 Site-MNIST                         | Train Loss: 0.3168 | Train Acc: 0.9132
 Site-MNIST                         | Train Loss: 0.2725 | Train Acc: 0.9317
 Site-MNIST                         | Train Loss: 0.2805 | Train Acc: 0.9387
 Site-USPS                          | Train Loss: 0.3123 | Train Acc: 0.9113
 Site-USPS                          | Train Loss: 0.2644 | Train Acc: 0.9217
 Site-USPS                          | Train Loss: 0.2645 | Train Acc: 0.9297
 Site-SynthDigits                   | Train Loss: 1.2674 | Train Acc: 0.5947
 Site-SynthDigits                   | Train Loss: 1.1520 | Train Acc: 0.6427
 Site-MNIST_M                       | Train Loss: 1.3437 | Train Acc: 0.6051
 Site-MNIST_M                       | Train Loss: 1.5053 | Train Acc: 0.5189
 Site-SVHN                          | Train Loss: 1.8788 | Train Acc: 0.3373
Average Train Accuracy: 0.7779
 Site-MNIST                         | Val  Loss: 0.2616 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2529 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2760 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.2955 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.2654 | Val  Acc: 0.9439
 Site-USPS                          | Val  Loss: 0.2253 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.3008 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.3027 | Val  Acc: 0.9017
 Site-SynthDigits                   | Val  Loss: 1.3732 | Val  Acc: 0.5379
 Site-SynthDigits                   | Val  Loss: 1.1588 | Val  Acc: 0.6313
 Site-MNIST_M                       | Val  Loss: 1.2165 | Val  Acc: 0.6932
 Site-MNIST_M                       | Val  Loss: 1.2137 | Val  Acc: 0.6061
 Site-SVHN                          | Val  Loss: 1.8876 | Val  Acc: 0.3219
Average Valid Accuracy: 0.7849
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9365
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9421
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9439
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9017
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.5379
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.6313
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.6932
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.6061
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.3219
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 43 ============
denominator: 16478.009765625
 Site-MNIST                         | Train Loss: 0.3227 | Train Acc: 0.9156
 Site-MNIST                         | Train Loss: 0.2599 | Train Acc: 0.9408
 Site-MNIST                         | Train Loss: 0.3215 | Train Acc: 0.9093
 Site-MNIST                         | Train Loss: 0.2797 | Train Acc: 0.9238
 Site-MNIST                         | Train Loss: 0.2872 | Train Acc: 0.9264
 Site-USPS                          | Train Loss: 0.3060 | Train Acc: 0.9161
 Site-USPS                          | Train Loss: 0.2600 | Train Acc: 0.9281
 Site-USPS                          | Train Loss: 0.2639 | Train Acc: 0.9276
 Site-SynthDigits                   | Train Loss: 1.2238 | Train Acc: 0.6080
 Site-SynthDigits                   | Train Loss: 1.1467 | Train Acc: 0.6389
 Site-MNIST_M                       | Train Loss: 1.3495 | Train Acc: 0.6023
 Site-MNIST_M                       | Train Loss: 1.4844 | Train Acc: 0.5265
 Site-SVHN                          | Train Loss: 1.8270 | Train Acc: 0.3322
Average Train Accuracy: 0.7766
 Site-MNIST                         | Val  Loss: 0.2517 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2486 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2802 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.2967 | Val  Acc: 0.9263
 Site-MNIST                         | Val  Loss: 0.2698 | Val  Acc: 0.9404
 Site-USPS                          | Val  Loss: 0.2250 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.2932 | Val  Acc: 0.9103
 Site-USPS                          | Val  Loss: 0.2935 | Val  Acc: 0.9103
 Site-SynthDigits                   | Val  Loss: 1.3480 | Val  Acc: 0.5606
 Site-SynthDigits                   | Val  Loss: 1.1227 | Val  Acc: 0.6263
 Site-MNIST_M                       | Val  Loss: 1.1807 | Val  Acc: 0.6705
 Site-MNIST_M                       | Val  Loss: 1.2029 | Val  Acc: 0.5909
 Site-SVHN                          | Val  Loss: 1.9105 | Val  Acc: 0.2808
Average Valid Accuracy: 0.7802
============ Train epoch 44 ============
denominator: 16358.291015625
 Site-MNIST                         | Train Loss: 0.2913 | Train Acc: 0.9244
 Site-MNIST                         | Train Loss: 0.2335 | Train Acc: 0.9438
 Site-MNIST                         | Train Loss: 0.3113 | Train Acc: 0.9211
 Site-MNIST                         | Train Loss: 0.2717 | Train Acc: 0.9277
 Site-MNIST                         | Train Loss: 0.2820 | Train Acc: 0.9361
 Site-USPS                          | Train Loss: 0.2964 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.2570 | Train Acc: 0.9249
 Site-USPS                          | Train Loss: 0.2567 | Train Acc: 0.9329
 Site-SynthDigits                   | Train Loss: 1.2102 | Train Acc: 0.6098
 Site-SynthDigits                   | Train Loss: 1.1503 | Train Acc: 0.6414
 Site-MNIST_M                       | Train Loss: 1.3533 | Train Acc: 0.6222
 Site-MNIST_M                       | Train Loss: 1.5087 | Train Acc: 0.5284
 Site-SVHN                          | Train Loss: 1.8614 | Train Acc: 0.3475
Average Train Accuracy: 0.7822
 Site-MNIST                         | Val  Loss: 0.2403 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.2315 | Val  Acc: 0.9405
 Site-MNIST                         | Val  Loss: 0.2732 | Val  Acc: 0.9444
 Site-MNIST                         | Val  Loss: 0.2867 | Val  Acc: 0.9368
 Site-MNIST                         | Val  Loss: 0.2566 | Val  Acc: 0.9439
 Site-USPS                          | Val  Loss: 0.2165 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.2894 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.2942 | Val  Acc: 0.9145
 Site-SynthDigits                   | Val  Loss: 1.3252 | Val  Acc: 0.5682
 Site-SynthDigits                   | Val  Loss: 1.1159 | Val  Acc: 0.6515
 Site-MNIST_M                       | Val  Loss: 1.1923 | Val  Acc: 0.6932
 Site-MNIST_M                       | Val  Loss: 1.2023 | Val  Acc: 0.6364
 Site-SVHN                          | Val  Loss: 1.8742 | Val  Acc: 0.3288
Average Valid Accuracy: 0.7968
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9405
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9444
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9368
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9439
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9327
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9145
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.5682
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.6515
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.6932
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.6364
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.3288
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 45 ============
denominator: 16238.306640625
 Site-MNIST                         | Train Loss: 0.2883 | Train Acc: 0.9244
 Site-MNIST                         | Train Loss: 0.2336 | Train Acc: 0.9467
 Site-MNIST                         | Train Loss: 0.3128 | Train Acc: 0.9152
 Site-MNIST                         | Train Loss: 0.2704 | Train Acc: 0.9251
 Site-MNIST                         | Train Loss: 0.2801 | Train Acc: 0.9264
 Site-USPS                          | Train Loss: 0.2854 | Train Acc: 0.9137
 Site-USPS                          | Train Loss: 0.2546 | Train Acc: 0.9281
 Site-USPS                          | Train Loss: 0.2573 | Train Acc: 0.9318
 Site-SynthDigits                   | Train Loss: 1.1798 | Train Acc: 0.6174
 Site-SynthDigits                   | Train Loss: 1.1299 | Train Acc: 0.6465
 Site-MNIST_M                       | Train Loss: 1.3357 | Train Acc: 0.6023
 Site-MNIST_M                       | Train Loss: 1.4667 | Train Acc: 0.5341
 Site-SVHN                          | Train Loss: 1.8843 | Train Acc: 0.3390
Average Train Accuracy: 0.7808
 Site-MNIST                         | Val  Loss: 0.2423 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2352 | Val  Acc: 0.9405
 Site-MNIST                         | Val  Loss: 0.2686 | Val  Acc: 0.9444
 Site-MNIST                         | Val  Loss: 0.2806 | Val  Acc: 0.9474
 Site-MNIST                         | Val  Loss: 0.2566 | Val  Acc: 0.9474
 Site-USPS                          | Val  Loss: 0.2172 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.2826 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.2835 | Val  Acc: 0.9145
 Site-SynthDigits                   | Val  Loss: 1.3190 | Val  Acc: 0.5909
 Site-SynthDigits                   | Val  Loss: 1.0930 | Val  Acc: 0.6566
 Site-MNIST_M                       | Val  Loss: 1.1720 | Val  Acc: 0.6705
 Site-MNIST_M                       | Val  Loss: 1.1819 | Val  Acc: 0.5985
 Site-SVHN                          | Val  Loss: 1.9027 | Val  Acc: 0.3082
Average Valid Accuracy: 0.7917
============ Train epoch 46 ============
denominator: 16208.955078125
 Site-MNIST                         | Train Loss: 0.2847 | Train Acc: 0.9200
 Site-MNIST                         | Train Loss: 0.2383 | Train Acc: 0.9408
 Site-MNIST                         | Train Loss: 0.2987 | Train Acc: 0.9211
 Site-MNIST                         | Train Loss: 0.2588 | Train Acc: 0.9330
 Site-MNIST                         | Train Loss: 0.2687 | Train Acc: 0.9317
 Site-USPS                          | Train Loss: 0.2802 | Train Acc: 0.9209
 Site-USPS                          | Train Loss: 0.2462 | Train Acc: 0.9329
 Site-USPS                          | Train Loss: 0.2494 | Train Acc: 0.9329
 Site-SynthDigits                   | Train Loss: 1.1661 | Train Acc: 0.6212
 Site-SynthDigits                   | Train Loss: 1.1166 | Train Acc: 0.6503
 Site-MNIST_M                       | Train Loss: 1.3139 | Train Acc: 0.6250
 Site-MNIST_M                       | Train Loss: 1.4346 | Train Acc: 0.5341
 Site-SVHN                          | Train Loss: 1.8906 | Train Acc: 0.3509
Average Train Accuracy: 0.7858
 Site-MNIST                         | Val  Loss: 0.2292 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.2220 | Val  Acc: 0.9405
 Site-MNIST                         | Val  Loss: 0.2612 | Val  Acc: 0.9444
 Site-MNIST                         | Val  Loss: 0.2753 | Val  Acc: 0.9368
 Site-MNIST                         | Val  Loss: 0.2446 | Val  Acc: 0.9404
 Site-USPS                          | Val  Loss: 0.2079 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.2755 | Val  Acc: 0.9167
 Site-USPS                          | Val  Loss: 0.2829 | Val  Acc: 0.9145
 Site-SynthDigits                   | Val  Loss: 1.2987 | Val  Acc: 0.5909
 Site-SynthDigits                   | Val  Loss: 1.0872 | Val  Acc: 0.6667
 Site-MNIST_M                       | Val  Loss: 1.1643 | Val  Acc: 0.6932
 Site-MNIST_M                       | Val  Loss: 1.1727 | Val  Acc: 0.6288
 Site-SVHN                          | Val  Loss: 1.8643 | Val  Acc: 0.3356
Average Valid Accuracy: 0.8012
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9405
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9444
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9368
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9404
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9167
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9145
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.5909
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.6667
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.6932
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.6288
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.3356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/q-ffl...
============ Train epoch 47 ============
denominator: 15927.970703125
 Site-MNIST                         | Train Loss: 0.2814 | Train Acc: 0.9244
 Site-MNIST                         | Train Loss: 0.2266 | Train Acc: 0.9497
 Site-MNIST                         | Train Loss: 0.2965 | Train Acc: 0.9211
 Site-MNIST                         | Train Loss: 0.2590 | Train Acc: 0.9290
 Site-MNIST                         | Train Loss: 0.2661 | Train Acc: 0.9326
 Site-USPS                          | Train Loss: 0.2774 | Train Acc: 0.9209
 Site-USPS                          | Train Loss: 0.2437 | Train Acc: 0.9329
 Site-USPS                          | Train Loss: 0.2475 | Train Acc: 0.9329
 Site-SynthDigits                   | Train Loss: 1.1945 | Train Acc: 0.6231
 Site-SynthDigits                   | Train Loss: 1.1075 | Train Acc: 0.6490
 Site-MNIST_M                       | Train Loss: 1.2933 | Train Acc: 0.6136
 Site-MNIST_M                       | Train Loss: 1.4532 | Train Acc: 0.5398
 Site-SVHN                          | Train Loss: 1.8849 | Train Acc: 0.3441
Average Train Accuracy: 0.7856
 Site-MNIST                         | Val  Loss: 0.2253 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2206 | Val  Acc: 0.9405
 Site-MNIST                         | Val  Loss: 0.2547 | Val  Acc: 0.9444
 Site-MNIST                         | Val  Loss: 0.2692 | Val  Acc: 0.9474
 Site-MNIST                         | Val  Loss: 0.2418 | Val  Acc: 0.9509
 Site-USPS                          | Val  Loss: 0.2059 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.2721 | Val  Acc: 0.9103
 Site-USPS                          | Val  Loss: 0.2757 | Val  Acc: 0.9145
 Site-SynthDigits                   | Val  Loss: 1.2949 | Val  Acc: 0.5758
 Site-SynthDigits                   | Val  Loss: 1.0835 | Val  Acc: 0.6667
 Site-MNIST_M                       | Val  Loss: 1.1498 | Val  Acc: 0.6705
 Site-MNIST_M                       | Val  Loss: 1.1600 | Val  Acc: 0.6136
 Site-SVHN                          | Val  Loss: 1.8905 | Val  Acc: 0.3082
Average Valid Accuracy: 0.7940
============ Train epoch 48 ============
denominator: 16030.7080078125
 Site-MNIST                         | Train Loss: 0.2615 | Train Acc: 0.9200
 Site-MNIST                         | Train Loss: 0.2228 | Train Acc: 0.9467
 Site-MNIST                         | Train Loss: 0.2888 | Train Acc: 0.9250
 Site-MNIST                         | Train Loss: 0.2448 | Train Acc: 0.9356
 Site-MNIST                         | Train Loss: 0.2544 | Train Acc: 0.9387
 Site-USPS                          | Train Loss: 0.2757 | Train Acc: 0.9233
 Site-USPS                          | Train Loss: 0.2380 | Train Acc: 0.9313
 Site-USPS                          | Train Loss: 0.2439 | Train Acc: 0.9308
 Site-SynthDigits                   | Train Loss: 1.1965 | Train Acc: 0.6269
 Site-SynthDigits                   | Train Loss: 1.0854 | Train Acc: 0.6604
 Site-MNIST_M                       | Train Loss: 1.2945 | Train Acc: 0.6278
 Site-MNIST_M                       | Train Loss: 1.4779 | Train Acc: 0.5436
 Site-SVHN                          | Train Loss: 1.8214 | Train Acc: 0.3526
Average Train Accuracy: 0.7894
 Site-MNIST                         | Val  Loss: 0.2264 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.2171 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2518 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.2651 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.2331 | Val  Acc: 0.9474
 Site-USPS                          | Val  Loss: 0.2024 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.2688 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.2761 | Val  Acc: 0.9103
 Site-SynthDigits                   | Val  Loss: 1.2851 | Val  Acc: 0.5758
 Site-SynthDigits                   | Val  Loss: 1.0725 | Val  Acc: 0.6566
 Site-MNIST_M                       | Val  Loss: 1.1433 | Val  Acc: 0.6818
 Site-MNIST_M                       | Val  Loss: 1.1478 | Val  Acc: 0.6364
 Site-SVHN                          | Val  Loss: 1.8490 | Val  Acc: 0.3425
Average Valid Accuracy: 0.7976
============ Train epoch 49 ============
denominator: 15842.56640625
 Site-MNIST                         | Train Loss: 0.2792 | Train Acc: 0.9289
 Site-MNIST                         | Train Loss: 0.2250 | Train Acc: 0.9497
 Site-MNIST                         | Train Loss: 0.2860 | Train Acc: 0.9250
 Site-MNIST                         | Train Loss: 0.2483 | Train Acc: 0.9317
 Site-MNIST                         | Train Loss: 0.2541 | Train Acc: 0.9343
 Site-USPS                          | Train Loss: 0.2640 | Train Acc: 0.9185
 Site-USPS                          | Train Loss: 0.2356 | Train Acc: 0.9329
 Site-USPS                          | Train Loss: 0.2435 | Train Acc: 0.9350
 Site-SynthDigits                   | Train Loss: 1.1461 | Train Acc: 0.6231
 Site-SynthDigits                   | Train Loss: 1.0937 | Train Acc: 0.6604
 Site-MNIST_M                       | Train Loss: 1.2739 | Train Acc: 0.6080
 Site-MNIST_M                       | Train Loss: 1.4332 | Train Acc: 0.5417
 Site-SVHN                          | Train Loss: 1.8648 | Train Acc: 0.3526
Average Train Accuracy: 0.7878
 Site-MNIST                         | Val  Loss: 0.2264 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2182 | Val  Acc: 0.9405
 Site-MNIST                         | Val  Loss: 0.2461 | Val  Acc: 0.9444
 Site-MNIST                         | Val  Loss: 0.2644 | Val  Acc: 0.9474
 Site-MNIST                         | Val  Loss: 0.2345 | Val  Acc: 0.9509
 Site-USPS                          | Val  Loss: 0.2013 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.2667 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.2702 | Val  Acc: 0.9145
 Site-SynthDigits                   | Val  Loss: 1.2862 | Val  Acc: 0.5909
 Site-SynthDigits                   | Val  Loss: 1.0527 | Val  Acc: 0.6667
 Site-MNIST_M                       | Val  Loss: 1.1183 | Val  Acc: 0.6818
 Site-MNIST_M                       | Val  Loss: 1.1376 | Val  Acc: 0.6061
 Site-SVHN                          | Val  Loss: 1.8859 | Val  Acc: 0.3356
Average Valid Accuracy: 0.7957
===2023-06-30 19:24:43===
===2023-06-30 19:24:45===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:46 | Test Acc: 0.9140
 Test site-USPS                      | Epoch:46 | Test Acc: 0.9226
 Test site-SynthDigits               | Epoch:46 | Test Acc: 0.6161
 Test site-MNIST_M                   | Epoch:46 | Test Acc: 0.4823
 Test site-SVHN                      | Epoch:46 | Test Acc: 0.3113
MNIST: 0.9140, USPS: 0.9226, SynthDigits: 0.6161, MNIST_M: 0.4823, SVHN: 0.3113, 
Average Test Accuracy(group): 0.6493, Average Test Accuracy(individual): 0.7574,
domain std=0.2400, cluster std=-1.0000, individual std=0.2139, 
