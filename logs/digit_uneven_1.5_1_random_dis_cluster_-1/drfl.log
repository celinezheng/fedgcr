===2023-06-04 13:38:45===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[451,676,1015,1522,2284,834,1252,1878,1057,1586,704,1057,1174,
client_nums=[5,3,2,2,1,]
len_dataset=[7438,4958,3305,2203,1468,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                    | Train Loss: 2.1889 | Train Acc: 0.4834
 Site-MNIST                    | Train Loss: 2.2030 | Train Acc: 0.4142
 Site-MNIST                    | Train Loss: 2.1982 | Train Acc: 0.4473
 Site-MNIST                    | Train Loss: 2.1998 | Train Acc: 0.4277
 Site-MNIST                    | Train Loss: 2.2017 | Train Acc: 0.4256
 Site-USPS                     | Train Loss: 2.1801 | Train Acc: 0.4976
 Site-USPS                     | Train Loss: 2.1769 | Train Acc: 0.5144
 Site-USPS                     | Train Loss: 2.1801 | Train Acc: 0.4957
 Site-SynthDigits              | Train Loss: 2.2809 | Train Acc: 0.1580
 Site-SynthDigits              | Train Loss: 2.2710 | Train Acc: 0.1917
 Site-MNIST-M                  | Train Loss: 2.2932 | Train Acc: 0.1207
 Site-MNIST-M                  | Train Loss: 2.2933 | Train Acc: 0.1060
 Site-SVHN                     | Train Loss: 2.2887 | Train Acc: 0.1150
 Site-MNIST                         | Val  Loss: 2.1983 | Val  Acc: 0.4196
 Site-MNIST                         | Val  Loss: 2.2028 | Val  Acc: 0.4320
 Site-MNIST                         | Val  Loss: 2.1968 | Val  Acc: 0.4506
 Site-MNIST                         | Val  Loss: 2.2076 | Val  Acc: 0.4053
 Site-MNIST                         | Val  Loss: 2.2042 | Val  Acc: 0.4175
 Site-USPS                          | Val  Loss: 2.1717 | Val  Acc: 0.5288
 Site-USPS                          | Val  Loss: 2.1751 | Val  Acc: 0.5256
 Site-USPS                          | Val  Loss: 2.1793 | Val  Acc: 0.5203
 Site-SynthDigits                   | Val  Loss: 2.2824 | Val  Acc: 0.1591
 Site-SynthDigits                   | Val  Loss: 2.2760 | Val  Acc: 0.1566
 Site-MNIST-M                       | Val  Loss: 2.2938 | Val  Acc: 0.1250
 Site-MNIST-M                       | Val  Loss: 2.2957 | Val  Acc: 0.0947
 Site-SVHN                          | Val  Loss: 2.2865 | Val  Acc: 0.0956
Average Valid Accuracy: 0.3331
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4196
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4320
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4506
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4053
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4175
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5288
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5256
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5203
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1591
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1566
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.1250
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.0947
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.0956
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 1 ============
 Site-MNIST                    | Train Loss: 2.0864 | Train Acc: 0.6053
 Site-MNIST                    | Train Loss: 2.1164 | Train Acc: 0.4882
 Site-MNIST                    | Train Loss: 2.1021 | Train Acc: 0.5153
 Site-MNIST                    | Train Loss: 2.1050 | Train Acc: 0.5217
 Site-MNIST                    | Train Loss: 2.1078 | Train Acc: 0.5171
 Site-USPS                     | Train Loss: 2.0697 | Train Acc: 0.5887
 Site-USPS                     | Train Loss: 2.0574 | Train Acc: 0.5998
 Site-USPS                     | Train Loss: 2.0659 | Train Acc: 0.5969
 Site-SynthDigits              | Train Loss: 2.2500 | Train Acc: 0.2223
 Site-SynthDigits              | Train Loss: 2.2441 | Train Acc: 0.2680
 Site-MNIST-M                  | Train Loss: 2.2800 | Train Acc: 0.1520
 Site-MNIST-M                  | Train Loss: 2.2880 | Train Acc: 0.1334
 Site-SVHN                     | Train Loss: 2.2794 | Train Acc: 0.1388
 Site-MNIST                         | Val  Loss: 2.1024 | Val  Acc: 0.5357
 Site-MNIST                         | Val  Loss: 2.1111 | Val  Acc: 0.5148
 Site-MNIST                         | Val  Loss: 2.1018 | Val  Acc: 0.5336
 Site-MNIST                         | Val  Loss: 2.1209 | Val  Acc: 0.4684
 Site-MNIST                         | Val  Loss: 2.1157 | Val  Acc: 0.4912
 Site-USPS                          | Val  Loss: 2.0474 | Val  Acc: 0.6442
 Site-USPS                          | Val  Loss: 2.0583 | Val  Acc: 0.6090
 Site-USPS                          | Val  Loss: 2.0681 | Val  Acc: 0.5928
 Site-SynthDigits                   | Val  Loss: 2.2560 | Val  Acc: 0.2386
 Site-SynthDigits                   | Val  Loss: 2.2491 | Val  Acc: 0.2348
 Site-MNIST-M                       | Val  Loss: 2.2839 | Val  Acc: 0.1420
 Site-MNIST-M                       | Val  Loss: 2.2843 | Val  Acc: 0.1174
 Site-SVHN                          | Val  Loss: 2.2764 | Val  Acc: 0.1331
Average Valid Accuracy: 0.4043
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5357
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5148
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5336
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.4684
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.4912
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6442
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6090
 Best site-USPS                      | Epoch:1 | Val Acc: 0.5928
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2386
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2348
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.1420
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.1174
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1331
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 2 ============
 Site-MNIST                    | Train Loss: 1.9892 | Train Acc: 0.6275
 Site-MNIST                    | Train Loss: 2.0333 | Train Acc: 0.5237
 Site-MNIST                    | Train Loss: 2.0097 | Train Acc: 0.5438
 Site-MNIST                    | Train Loss: 2.0140 | Train Acc: 0.5427
 Site-MNIST                    | Train Loss: 2.0176 | Train Acc: 0.5490
 Site-USPS                     | Train Loss: 1.9642 | Train Acc: 0.6199
 Site-USPS                     | Train Loss: 1.9582 | Train Acc: 0.6270
 Site-USPS                     | Train Loss: 1.9662 | Train Acc: 0.6267
 Site-SynthDigits              | Train Loss: 2.2235 | Train Acc: 0.2592
 Site-SynthDigits              | Train Loss: 2.2160 | Train Acc: 0.3045
 Site-MNIST-M                  | Train Loss: 2.2668 | Train Acc: 0.1761
 Site-MNIST-M                  | Train Loss: 2.2644 | Train Acc: 0.1618
 Site-SVHN                     | Train Loss: 2.2693 | Train Acc: 0.1687
 Site-MNIST                         | Val  Loss: 2.0154 | Val  Acc: 0.5714
 Site-MNIST                         | Val  Loss: 2.0242 | Val  Acc: 0.5148
 Site-MNIST                         | Val  Loss: 2.0106 | Val  Acc: 0.5336
 Site-MNIST                         | Val  Loss: 2.0363 | Val  Acc: 0.5053
 Site-MNIST                         | Val  Loss: 2.0303 | Val  Acc: 0.5246
 Site-USPS                          | Val  Loss: 1.9397 | Val  Acc: 0.6827
 Site-USPS                          | Val  Loss: 1.9587 | Val  Acc: 0.6506
 Site-USPS                          | Val  Loss: 1.9717 | Val  Acc: 0.6333
 Site-SynthDigits                   | Val  Loss: 2.2283 | Val  Acc: 0.2765
 Site-SynthDigits                   | Val  Loss: 2.2215 | Val  Acc: 0.2879
 Site-MNIST-M                       | Val  Loss: 2.2740 | Val  Acc: 0.1648
 Site-MNIST-M                       | Val  Loss: 2.2733 | Val  Acc: 0.1667
 Site-SVHN                          | Val  Loss: 2.2665 | Val  Acc: 0.1877
Average Valid Accuracy: 0.4384
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5714
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5148
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5336
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5053
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5246
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6827
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6506
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6333
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2765
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2879
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.1648
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.1667
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.1877
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 3 ============
 Site-MNIST                    | Train Loss: 1.9023 | Train Acc: 0.6475
 Site-MNIST                    | Train Loss: 1.9545 | Train Acc: 0.5518
 Site-MNIST                    | Train Loss: 1.9268 | Train Acc: 0.5685
 Site-MNIST                    | Train Loss: 1.9323 | Train Acc: 0.5802
 Site-MNIST                    | Train Loss: 1.9368 | Train Acc: 0.5709
 Site-USPS                     | Train Loss: 1.8760 | Train Acc: 0.6271
 Site-USPS                     | Train Loss: 1.8669 | Train Acc: 0.6542
 Site-USPS                     | Train Loss: 1.8730 | Train Acc: 0.6448
 Site-SynthDigits              | Train Loss: 2.1901 | Train Acc: 0.2952
 Site-SynthDigits              | Train Loss: 2.1885 | Train Acc: 0.3266
 Site-MNIST-M                  | Train Loss: 2.2538 | Train Acc: 0.1960
 Site-MNIST-M                  | Train Loss: 2.2593 | Train Acc: 0.1864
 Site-SVHN                     | Train Loss: 2.2605 | Train Acc: 0.1968
 Site-MNIST                         | Val  Loss: 1.9345 | Val  Acc: 0.5714
 Site-MNIST                         | Val  Loss: 1.9450 | Val  Acc: 0.5325
 Site-MNIST                         | Val  Loss: 1.9282 | Val  Acc: 0.5652
 Site-MNIST                         | Val  Loss: 1.9592 | Val  Acc: 0.5158
 Site-MNIST                         | Val  Loss: 1.9527 | Val  Acc: 0.5509
 Site-USPS                          | Val  Loss: 1.8403 | Val  Acc: 0.6971
 Site-USPS                          | Val  Loss: 1.8653 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 1.8811 | Val  Acc: 0.6418
 Site-SynthDigits                   | Val  Loss: 2.2009 | Val  Acc: 0.3106
 Site-SynthDigits                   | Val  Loss: 2.1940 | Val  Acc: 0.3207
 Site-MNIST-M                       | Val  Loss: 2.2634 | Val  Acc: 0.1761
 Site-MNIST-M                       | Val  Loss: 2.2627 | Val  Acc: 0.1742
 Site-SVHN                          | Val  Loss: 2.2568 | Val  Acc: 0.2253
Average Valid Accuracy: 0.4576
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5714
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5325
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5652
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5158
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5509
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6971
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6418
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3106
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3207
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.1761
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.1742
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2253
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 4 ============
 Site-MNIST                    | Train Loss: 1.7983 | Train Acc: 0.6741
 Site-MNIST                    | Train Loss: 1.8851 | Train Acc: 0.5799
 Site-MNIST                    | Train Loss: 1.8511 | Train Acc: 0.5921
 Site-MNIST                    | Train Loss: 1.8553 | Train Acc: 0.6051
 Site-MNIST                    | Train Loss: 1.8637 | Train Acc: 0.6073
 Site-USPS                     | Train Loss: 1.7988 | Train Acc: 0.6463
 Site-USPS                     | Train Loss: 1.7762 | Train Acc: 0.6805
 Site-USPS                     | Train Loss: 1.7850 | Train Acc: 0.6715
 Site-SynthDigits              | Train Loss: 2.1763 | Train Acc: 0.3094
 Site-SynthDigits              | Train Loss: 2.1613 | Train Acc: 0.3361
 Site-MNIST-M                  | Train Loss: 2.2408 | Train Acc: 0.2216
 Site-MNIST-M                  | Train Loss: 2.2448 | Train Acc: 0.2072
 Site-SVHN                     | Train Loss: 2.2524 | Train Acc: 0.2147
 Site-MNIST                         | Val  Loss: 1.8633 | Val  Acc: 0.5893
 Site-MNIST                         | Val  Loss: 1.8728 | Val  Acc: 0.5503
 Site-MNIST                         | Val  Loss: 1.8525 | Val  Acc: 0.5929
 Site-MNIST                         | Val  Loss: 1.8881 | Val  Acc: 0.5474
 Site-MNIST                         | Val  Loss: 1.8814 | Val  Acc: 0.5789
 Site-USPS                          | Val  Loss: 1.7481 | Val  Acc: 0.7067
 Site-USPS                          | Val  Loss: 1.7780 | Val  Acc: 0.6795
 Site-USPS                          | Val  Loss: 1.7947 | Val  Acc: 0.6695
 Site-SynthDigits                   | Val  Loss: 2.1740 | Val  Acc: 0.3258
 Site-SynthDigits                   | Val  Loss: 2.1673 | Val  Acc: 0.3460
 Site-MNIST-M                       | Val  Loss: 2.2519 | Val  Acc: 0.1989
 Site-MNIST-M                       | Val  Loss: 2.2514 | Val  Acc: 0.2045
 Site-SVHN                          | Val  Loss: 2.2482 | Val  Acc: 0.2457
Average Valid Accuracy: 0.4796
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5893
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5503
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5929
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5474
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5789
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7067
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6795
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6695
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3258
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3460
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.1989
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.2045
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2457
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 5 ============
 Site-MNIST                    | Train Loss: 1.7612 | Train Acc: 0.6874
 Site-MNIST                    | Train Loss: 1.8204 | Train Acc: 0.5962
 Site-MNIST                    | Train Loss: 1.7820 | Train Acc: 0.6099
 Site-MNIST                    | Train Loss: 1.7862 | Train Acc: 0.6281
 Site-MNIST                    | Train Loss: 1.7926 | Train Acc: 0.6261
 Site-USPS                     | Train Loss: 1.7152 | Train Acc: 0.6475
 Site-USPS                     | Train Loss: 1.6951 | Train Acc: 0.6877
 Site-USPS                     | Train Loss: 1.7116 | Train Acc: 0.6816
 Site-SynthDigits              | Train Loss: 2.1312 | Train Acc: 0.3236
 Site-SynthDigits              | Train Loss: 2.1355 | Train Acc: 0.3468
 Site-MNIST-M                  | Train Loss: 2.2305 | Train Acc: 0.2330
 Site-MNIST-M                  | Train Loss: 2.2407 | Train Acc: 0.2185
 Site-SVHN                     | Train Loss: 2.2438 | Train Acc: 0.2223
 Site-MNIST                         | Val  Loss: 1.7983 | Val  Acc: 0.5982
 Site-MNIST                         | Val  Loss: 1.8069 | Val  Acc: 0.5562
 Site-MNIST                         | Val  Loss: 1.7827 | Val  Acc: 0.6166
 Site-MNIST                         | Val  Loss: 1.8223 | Val  Acc: 0.5658
 Site-MNIST                         | Val  Loss: 1.8157 | Val  Acc: 0.5947
 Site-USPS                          | Val  Loss: 1.6733 | Val  Acc: 0.7067
 Site-USPS                          | Val  Loss: 1.7067 | Val  Acc: 0.6795
 Site-USPS                          | Val  Loss: 1.7240 | Val  Acc: 0.6738
 Site-SynthDigits                   | Val  Loss: 2.1488 | Val  Acc: 0.3485
 Site-SynthDigits                   | Val  Loss: 2.1424 | Val  Acc: 0.3535
 Site-MNIST-M                       | Val  Loss: 2.2429 | Val  Acc: 0.2159
 Site-MNIST-M                       | Val  Loss: 2.2428 | Val  Acc: 0.2159
 Site-SVHN                          | Val  Loss: 2.2391 | Val  Acc: 0.2594
Average Valid Accuracy: 0.4911
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5982
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5562
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.6166
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5658
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5947
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7067
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6795
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6738
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3485
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3535
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.2159
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.2159
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2594
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 6 ============
 Site-MNIST                    | Train Loss: 1.6998 | Train Acc: 0.7140
 Site-MNIST                    | Train Loss: 1.7663 | Train Acc: 0.6198
 Site-MNIST                    | Train Loss: 1.7182 | Train Acc: 0.6335
 Site-MNIST                    | Train Loss: 1.7250 | Train Acc: 0.6459
 Site-MNIST                    | Train Loss: 1.7327 | Train Acc: 0.6489
 Site-USPS                     | Train Loss: 1.6562 | Train Acc: 0.6691
 Site-USPS                     | Train Loss: 1.6273 | Train Acc: 0.7013
 Site-USPS                     | Train Loss: 1.6380 | Train Acc: 0.7013
 Site-SynthDigits              | Train Loss: 2.1375 | Train Acc: 0.3311
 Site-SynthDigits              | Train Loss: 2.1121 | Train Acc: 0.3562
 Site-MNIST-M                  | Train Loss: 2.2203 | Train Acc: 0.2500
 Site-MNIST-M                  | Train Loss: 2.2190 | Train Acc: 0.2204
 Site-SVHN                     | Train Loss: 2.2361 | Train Acc: 0.2334
 Site-MNIST                         | Val  Loss: 1.7404 | Val  Acc: 0.6250
 Site-MNIST                         | Val  Loss: 1.7468 | Val  Acc: 0.5976
 Site-MNIST                         | Val  Loss: 1.7198 | Val  Acc: 0.6364
 Site-MNIST                         | Val  Loss: 1.7639 | Val  Acc: 0.5868
 Site-MNIST                         | Val  Loss: 1.7572 | Val  Acc: 0.6175
 Site-USPS                          | Val  Loss: 1.5960 | Val  Acc: 0.7115
 Site-USPS                          | Val  Loss: 1.6333 | Val  Acc: 0.6859
 Site-USPS                          | Val  Loss: 1.6522 | Val  Acc: 0.6908
 Site-SynthDigits                   | Val  Loss: 2.1253 | Val  Acc: 0.3523
 Site-SynthDigits                   | Val  Loss: 2.1183 | Val  Acc: 0.3662
 Site-MNIST-M                       | Val  Loss: 2.2332 | Val  Acc: 0.2330
 Site-MNIST-M                       | Val  Loss: 2.2336 | Val  Acc: 0.2348
 Site-SVHN                          | Val  Loss: 2.2304 | Val  Acc: 0.2799
Average Valid Accuracy: 0.5091
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6250
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.5976
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6364
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.5868
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6175
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7115
 Best site-USPS                      | Epoch:6 | Val Acc: 0.6859
 Best site-USPS                      | Epoch:6 | Val Acc: 0.6908
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3523
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3662
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.2330
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.2348
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2799
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 7 ============
 Site-MNIST                    | Train Loss: 1.6076 | Train Acc: 0.7295
 Site-MNIST                    | Train Loss: 1.6984 | Train Acc: 0.6420
 Site-MNIST                    | Train Loss: 1.6599 | Train Acc: 0.6640
 Site-MNIST                    | Train Loss: 1.6665 | Train Acc: 0.6590
 Site-MNIST                    | Train Loss: 1.6741 | Train Acc: 0.6694
 Site-USPS                     | Train Loss: 1.5600 | Train Acc: 0.6775
 Site-USPS                     | Train Loss: 1.5750 | Train Acc: 0.7037
 Site-USPS                     | Train Loss: 1.5755 | Train Acc: 0.7119
 Site-SynthDigits              | Train Loss: 2.1021 | Train Acc: 0.3415
 Site-SynthDigits              | Train Loss: 2.0892 | Train Acc: 0.3588
 Site-MNIST-M                  | Train Loss: 2.2113 | Train Acc: 0.2642
 Site-MNIST-M                  | Train Loss: 2.2120 | Train Acc: 0.2356
 Site-SVHN                     | Train Loss: 2.2285 | Train Acc: 0.2436
 Site-MNIST                         | Val  Loss: 1.6861 | Val  Acc: 0.6161
 Site-MNIST                         | Val  Loss: 1.6912 | Val  Acc: 0.6154
 Site-MNIST                         | Val  Loss: 1.6606 | Val  Acc: 0.6601
 Site-MNIST                         | Val  Loss: 1.7078 | Val  Acc: 0.6237
 Site-MNIST                         | Val  Loss: 1.7012 | Val  Acc: 0.6439
 Site-USPS                          | Val  Loss: 1.5324 | Val  Acc: 0.7067
 Site-USPS                          | Val  Loss: 1.5732 | Val  Acc: 0.6827
 Site-USPS                          | Val  Loss: 1.5922 | Val  Acc: 0.7015
 Site-SynthDigits                   | Val  Loss: 2.1017 | Val  Acc: 0.3598
 Site-SynthDigits                   | Val  Loss: 2.0946 | Val  Acc: 0.3788
 Site-MNIST-M                       | Val  Loss: 2.2256 | Val  Acc: 0.2330
 Site-MNIST-M                       | Val  Loss: 2.2255 | Val  Acc: 0.2576
 Site-SVHN                          | Val  Loss: 2.2220 | Val  Acc: 0.2833
Average Valid Accuracy: 0.5202
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6161
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6154
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6601
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6237
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6439
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7067
 Best site-USPS                      | Epoch:7 | Val Acc: 0.6827
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7015
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3598
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3788
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.2330
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.2576
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2833
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 8 ============
 Site-MNIST                    | Train Loss: 1.5819 | Train Acc: 0.7406
 Site-MNIST                    | Train Loss: 1.6607 | Train Acc: 0.6509
 Site-MNIST                    | Train Loss: 1.6099 | Train Acc: 0.6749
 Site-MNIST                    | Train Loss: 1.6150 | Train Acc: 0.6682
 Site-MNIST                    | Train Loss: 1.6221 | Train Acc: 0.6799
 Site-USPS                     | Train Loss: 1.5296 | Train Acc: 0.6835
 Site-USPS                     | Train Loss: 1.5111 | Train Acc: 0.7141
 Site-USPS                     | Train Loss: 1.5205 | Train Acc: 0.7204
 Site-SynthDigits              | Train Loss: 2.0864 | Train Acc: 0.3444
 Site-SynthDigits              | Train Loss: 2.0656 | Train Acc: 0.3676
 Site-MNIST-M                  | Train Loss: 2.2025 | Train Acc: 0.2770
 Site-MNIST-M                  | Train Loss: 2.1982 | Train Acc: 0.2403
 Site-SVHN                     | Train Loss: 2.2219 | Train Acc: 0.2504
 Site-MNIST                         | Val  Loss: 1.6362 | Val  Acc: 0.6250
 Site-MNIST                         | Val  Loss: 1.6427 | Val  Acc: 0.6213
 Site-MNIST                         | Val  Loss: 1.6101 | Val  Acc: 0.6798
 Site-MNIST                         | Val  Loss: 1.6598 | Val  Acc: 0.6342
 Site-MNIST                         | Val  Loss: 1.6532 | Val  Acc: 0.6526
 Site-USPS                          | Val  Loss: 1.4746 | Val  Acc: 0.7067
 Site-USPS                          | Val  Loss: 1.5171 | Val  Acc: 0.6763
 Site-USPS                          | Val  Loss: 1.5371 | Val  Acc: 0.7036
 Site-SynthDigits                   | Val  Loss: 2.0786 | Val  Acc: 0.3598
 Site-SynthDigits                   | Val  Loss: 2.0716 | Val  Acc: 0.3763
 Site-MNIST-M                       | Val  Loss: 2.2165 | Val  Acc: 0.2443
 Site-MNIST-M                       | Val  Loss: 2.2167 | Val  Acc: 0.2652
 Site-SVHN                          | Val  Loss: 2.2138 | Val  Acc: 0.2935
Average Valid Accuracy: 0.5261
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6250
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6213
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6798
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6342
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6526
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7067
 Best site-USPS                      | Epoch:8 | Val Acc: 0.6763
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7036
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3598
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3763
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.2443
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.2652
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2935
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 9 ============
 Site-MNIST                    | Train Loss: 1.5080 | Train Acc: 0.7561
 Site-MNIST                    | Train Loss: 1.6221 | Train Acc: 0.6583
 Site-MNIST                    | Train Loss: 1.5671 | Train Acc: 0.6709
 Site-MNIST                    | Train Loss: 1.5742 | Train Acc: 0.6715
 Site-MNIST                    | Train Loss: 1.5792 | Train Acc: 0.6865
 Site-USPS                     | Train Loss: 1.5077 | Train Acc: 0.6799
 Site-USPS                     | Train Loss: 1.4860 | Train Acc: 0.7093
 Site-USPS                     | Train Loss: 1.4910 | Train Acc: 0.7199
 Site-SynthDigits              | Train Loss: 2.0472 | Train Acc: 0.3586
 Site-SynthDigits              | Train Loss: 2.0397 | Train Acc: 0.3808
 Site-MNIST-M                  | Train Loss: 2.1949 | Train Acc: 0.2798
 Site-MNIST-M                  | Train Loss: 2.1951 | Train Acc: 0.2507
 Site-SVHN                     | Train Loss: 2.2140 | Train Acc: 0.2589
 Site-MNIST                         | Val  Loss: 1.5949 | Val  Acc: 0.6161
 Site-MNIST                         | Val  Loss: 1.6032 | Val  Acc: 0.6213
 Site-MNIST                         | Val  Loss: 1.5667 | Val  Acc: 0.6798
 Site-MNIST                         | Val  Loss: 1.6176 | Val  Acc: 0.6395
 Site-MNIST                         | Val  Loss: 1.6132 | Val  Acc: 0.6596
 Site-USPS                          | Val  Loss: 1.4471 | Val  Acc: 0.7163
 Site-USPS                          | Val  Loss: 1.4887 | Val  Acc: 0.6795
 Site-USPS                          | Val  Loss: 1.5073 | Val  Acc: 0.7015
 Site-SynthDigits                   | Val  Loss: 2.0549 | Val  Acc: 0.3826
 Site-SynthDigits                   | Val  Loss: 2.0472 | Val  Acc: 0.3889
 Site-MNIST-M                       | Val  Loss: 2.2089 | Val  Acc: 0.2443
 Site-MNIST-M                       | Val  Loss: 2.2091 | Val  Acc: 0.2727
 Site-SVHN                          | Val  Loss: 2.2053 | Val  Acc: 0.3038
Average Valid Accuracy: 0.5312
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6161
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6213
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6798
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6395
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6596
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7163
 Best site-USPS                      | Epoch:9 | Val Acc: 0.6795
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7015
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3826
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3889
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.2443
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.2727
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3038
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
 Test site-MNIST                     | Epoch:9 | Test Acc: 0.6747
 Test site-USPS                      | Epoch:9 | Test Acc: 0.6973
 Test site-SynthDigits               | Epoch:9 | Test Acc: 0.3539
 Test site-MNIST-M                   | Epoch:9 | Test Acc: 0.2457
 Test site-SVHN                      | Epoch:9 | Test Acc: 0.2286
MNIST: 0.675, USPS: 0.697, SynthDigits: 0.354, MNIST-M: 0.246, SVHN: 0.229, 
Average Test Accuracy: 0.4400, domain std=0.2055, cluster std=-1.0000, individual std=0.1967, 
============ Train epoch 10 ============
 Site-MNIST                    | Train Loss: 1.4676 | Train Acc: 0.7694
 Site-MNIST                    | Train Loss: 1.5747 | Train Acc: 0.6553
 Site-MNIST                    | Train Loss: 1.5233 | Train Acc: 0.6956
 Site-MNIST                    | Train Loss: 1.5290 | Train Acc: 0.6827
 Site-MNIST                    | Train Loss: 1.5368 | Train Acc: 0.7032
 Site-USPS                     | Train Loss: 1.4486 | Train Acc: 0.6978
 Site-USPS                     | Train Loss: 1.4275 | Train Acc: 0.7292
 Site-USPS                     | Train Loss: 1.4350 | Train Acc: 0.7343
 Site-SynthDigits              | Train Loss: 2.0421 | Train Acc: 0.3728
 Site-SynthDigits              | Train Loss: 2.0214 | Train Acc: 0.3922
 Site-MNIST-M                  | Train Loss: 2.1862 | Train Acc: 0.2841
 Site-MNIST-M                  | Train Loss: 2.1862 | Train Acc: 0.2611
 Site-SVHN                     | Train Loss: 2.2067 | Train Acc: 0.2675
 Site-MNIST                         | Val  Loss: 1.5512 | Val  Acc: 0.6071
 Site-MNIST                         | Val  Loss: 1.5585 | Val  Acc: 0.6331
 Site-MNIST                         | Val  Loss: 1.5224 | Val  Acc: 0.7036
 Site-MNIST                         | Val  Loss: 1.5750 | Val  Acc: 0.6579
 Site-MNIST                         | Val  Loss: 1.5708 | Val  Acc: 0.6596
 Site-USPS                          | Val  Loss: 1.3862 | Val  Acc: 0.7308
 Site-USPS                          | Val  Loss: 1.4310 | Val  Acc: 0.6923
 Site-USPS                          | Val  Loss: 1.4513 | Val  Acc: 0.7100
 Site-SynthDigits                   | Val  Loss: 2.0342 | Val  Acc: 0.3864
 Site-SynthDigits                   | Val  Loss: 2.0267 | Val  Acc: 0.3965
 Site-MNIST-M                       | Val  Loss: 2.2000 | Val  Acc: 0.2443
 Site-MNIST-M                       | Val  Loss: 2.2005 | Val  Acc: 0.2727
 Site-SVHN                          | Val  Loss: 2.1968 | Val  Acc: 0.3072
Average Valid Accuracy: 0.5386
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6071
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6331
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7036
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6579
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6596
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7308
 Best site-USPS                      | Epoch:10 | Val Acc: 0.6923
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7100
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3864
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3965
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.2443
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.2727
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3072
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 11 ============
 Site-MNIST                    | Train Loss: 1.4491 | Train Acc: 0.7894
 Site-MNIST                    | Train Loss: 1.5299 | Train Acc: 0.6731
 Site-MNIST                    | Train Loss: 1.4860 | Train Acc: 0.7113
 Site-MNIST                    | Train Loss: 1.4946 | Train Acc: 0.6932
 Site-MNIST                    | Train Loss: 1.5005 | Train Acc: 0.7110
 Site-USPS                     | Train Loss: 1.3705 | Train Acc: 0.7050
 Site-USPS                     | Train Loss: 1.3714 | Train Acc: 0.7452
 Site-USPS                     | Train Loss: 1.3805 | Train Acc: 0.7433
 Site-SynthDigits              | Train Loss: 2.0193 | Train Acc: 0.3652
 Site-SynthDigits              | Train Loss: 2.0015 | Train Acc: 0.3934
 Site-MNIST-M                  | Train Loss: 2.1774 | Train Acc: 0.2969
 Site-MNIST-M                  | Train Loss: 2.1787 | Train Acc: 0.2706
 Site-SVHN                     | Train Loss: 2.1994 | Train Acc: 0.2666
 Site-MNIST                         | Val  Loss: 1.5204 | Val  Acc: 0.6250
 Site-MNIST                         | Val  Loss: 1.5236 | Val  Acc: 0.6391
 Site-MNIST                         | Val  Loss: 1.4852 | Val  Acc: 0.7154
 Site-MNIST                         | Val  Loss: 1.5393 | Val  Acc: 0.6658
 Site-MNIST                         | Val  Loss: 1.5366 | Val  Acc: 0.6772
 Site-USPS                          | Val  Loss: 1.3303 | Val  Acc: 0.7452
 Site-USPS                          | Val  Loss: 1.3792 | Val  Acc: 0.7244
 Site-USPS                          | Val  Loss: 1.3999 | Val  Acc: 0.7313
 Site-SynthDigits                   | Val  Loss: 2.0107 | Val  Acc: 0.3712
 Site-SynthDigits                   | Val  Loss: 2.0051 | Val  Acc: 0.3914
 Site-MNIST-M                       | Val  Loss: 2.1928 | Val  Acc: 0.2443
 Site-MNIST-M                       | Val  Loss: 2.1929 | Val  Acc: 0.2841
 Site-SVHN                          | Val  Loss: 2.1878 | Val  Acc: 0.3072
Average Valid Accuracy: 0.5478
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6250
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6391
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7154
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6658
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6772
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7452
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7244
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7313
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3712
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3914
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.2443
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.2841
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3072
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 12 ============
 Site-MNIST                    | Train Loss: 1.4084 | Train Acc: 0.7938
 Site-MNIST                    | Train Loss: 1.5034 | Train Acc: 0.6849
 Site-MNIST                    | Train Loss: 1.4517 | Train Acc: 0.7241
 Site-MNIST                    | Train Loss: 1.4620 | Train Acc: 0.7024
 Site-MNIST                    | Train Loss: 1.4675 | Train Acc: 0.7215
 Site-USPS                     | Train Loss: 1.3226 | Train Acc: 0.7302
 Site-USPS                     | Train Loss: 1.3252 | Train Acc: 0.7652
 Site-USPS                     | Train Loss: 1.3330 | Train Acc: 0.7599
 Site-SynthDigits              | Train Loss: 1.9997 | Train Acc: 0.3775
 Site-SynthDigits              | Train Loss: 1.9793 | Train Acc: 0.4079
 Site-MNIST-M                  | Train Loss: 2.1681 | Train Acc: 0.2997
 Site-MNIST-M                  | Train Loss: 2.1600 | Train Acc: 0.2744
 Site-SVHN                     | Train Loss: 2.1924 | Train Acc: 0.2700
 Site-MNIST                         | Val  Loss: 1.4911 | Val  Acc: 0.6429
 Site-MNIST                         | Val  Loss: 1.4926 | Val  Acc: 0.6627
 Site-MNIST                         | Val  Loss: 1.4505 | Val  Acc: 0.7312
 Site-MNIST                         | Val  Loss: 1.5052 | Val  Acc: 0.6842
 Site-MNIST                         | Val  Loss: 1.5041 | Val  Acc: 0.6895
 Site-USPS                          | Val  Loss: 1.2827 | Val  Acc: 0.7548
 Site-USPS                          | Val  Loss: 1.3361 | Val  Acc: 0.7436
 Site-USPS                          | Val  Loss: 1.3560 | Val  Acc: 0.7527
 Site-SynthDigits                   | Val  Loss: 1.9897 | Val  Acc: 0.3864
 Site-SynthDigits                   | Val  Loss: 1.9847 | Val  Acc: 0.4015
 Site-MNIST-M                       | Val  Loss: 2.1857 | Val  Acc: 0.2557
 Site-MNIST-M                       | Val  Loss: 2.1844 | Val  Acc: 0.2765
 Site-SVHN                          | Val  Loss: 2.1792 | Val  Acc: 0.3140
Average Valid Accuracy: 0.5612
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.6429
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.6627
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7312
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.6842
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.6895
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7548
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7436
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7527
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.3864
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.4015
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.2557
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.2765
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3140
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 13 ============
 Site-MNIST                    | Train Loss: 1.3652 | Train Acc: 0.7960
 Site-MNIST                    | Train Loss: 1.4906 | Train Acc: 0.7056
 Site-MNIST                    | Train Loss: 1.4237 | Train Acc: 0.7300
 Site-MNIST                    | Train Loss: 1.4311 | Train Acc: 0.7122
 Site-MNIST                    | Train Loss: 1.4368 | Train Acc: 0.7277
 Site-USPS                     | Train Loss: 1.3395 | Train Acc: 0.7434
 Site-USPS                     | Train Loss: 1.2872 | Train Acc: 0.7724
 Site-USPS                     | Train Loss: 1.3007 | Train Acc: 0.7657
 Site-SynthDigits              | Train Loss: 1.9835 | Train Acc: 0.3888
 Site-SynthDigits              | Train Loss: 1.9598 | Train Acc: 0.4206
 Site-MNIST-M                  | Train Loss: 2.1595 | Train Acc: 0.2969
 Site-MNIST-M                  | Train Loss: 2.1548 | Train Acc: 0.2829
 Site-SVHN                     | Train Loss: 2.1854 | Train Acc: 0.2666
 Site-MNIST                         | Val  Loss: 1.4636 | Val  Acc: 0.6786
 Site-MNIST                         | Val  Loss: 1.4652 | Val  Acc: 0.6746
 Site-MNIST                         | Val  Loss: 1.4190 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.4743 | Val  Acc: 0.6947
 Site-MNIST                         | Val  Loss: 1.4764 | Val  Acc: 0.7053
 Site-USPS                          | Val  Loss: 1.2526 | Val  Acc: 0.7644
 Site-USPS                          | Val  Loss: 1.3054 | Val  Acc: 0.7596
 Site-USPS                          | Val  Loss: 1.3239 | Val  Acc: 0.7655
 Site-SynthDigits                   | Val  Loss: 1.9696 | Val  Acc: 0.4129
 Site-SynthDigits                   | Val  Loss: 1.9650 | Val  Acc: 0.4116
 Site-MNIST-M                       | Val  Loss: 2.1787 | Val  Acc: 0.2614
 Site-MNIST-M                       | Val  Loss: 2.1750 | Val  Acc: 0.2803
 Site-SVHN                          | Val  Loss: 2.1710 | Val  Acc: 0.3140
Average Valid Accuracy: 0.5740
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.6786
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.6746
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.6947
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7053
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7644
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7596
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7655
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4129
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4116
 Best site-MNIST-M                   | Epoch:13 | Val Acc: 0.2614
 Best site-MNIST-M                   | Epoch:13 | Val Acc: 0.2803
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3140
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 14 ============
 Site-MNIST                    | Train Loss: 1.3581 | Train Acc: 0.7827
 Site-MNIST                    | Train Loss: 1.4712 | Train Acc: 0.6997
 Site-MNIST                    | Train Loss: 1.4117 | Train Acc: 0.7192
 Site-MNIST                    | Train Loss: 1.4199 | Train Acc: 0.7109
 Site-MNIST                    | Train Loss: 1.4262 | Train Acc: 0.7172
 Site-USPS                     | Train Loss: 1.3042 | Train Acc: 0.7422
 Site-USPS                     | Train Loss: 1.2748 | Train Acc: 0.7596
 Site-USPS                     | Train Loss: 1.2877 | Train Acc: 0.7641
 Site-SynthDigits              | Train Loss: 1.9637 | Train Acc: 0.4096
 Site-SynthDigits              | Train Loss: 1.9371 | Train Acc: 0.4325
 Site-MNIST-M                  | Train Loss: 2.1498 | Train Acc: 0.3011
 Site-MNIST-M                  | Train Loss: 2.1436 | Train Acc: 0.2734
 Site-SVHN                     | Train Loss: 2.1751 | Train Acc: 0.2700
 Site-MNIST                         | Val  Loss: 1.4550 | Val  Acc: 0.6607
 Site-MNIST                         | Val  Loss: 1.4546 | Val  Acc: 0.6450
 Site-MNIST                         | Val  Loss: 1.4065 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.4608 | Val  Acc: 0.6895
 Site-MNIST                         | Val  Loss: 1.4689 | Val  Acc: 0.7000
 Site-USPS                          | Val  Loss: 1.2422 | Val  Acc: 0.7548
 Site-USPS                          | Val  Loss: 1.2915 | Val  Acc: 0.7436
 Site-USPS                          | Val  Loss: 1.3089 | Val  Acc: 0.7548
 Site-SynthDigits                   | Val  Loss: 1.9461 | Val  Acc: 0.4356
 Site-SynthDigits                   | Val  Loss: 1.9419 | Val  Acc: 0.4394
 Site-MNIST-M                       | Val  Loss: 2.1749 | Val  Acc: 0.2727
 Site-MNIST-M                       | Val  Loss: 2.1642 | Val  Acc: 0.2992
 Site-SVHN                          | Val  Loss: 2.1615 | Val  Acc: 0.3242
Average Valid Accuracy: 0.5737
============ Train epoch 15 ============
 Site-MNIST                    | Train Loss: 1.3215 | Train Acc: 0.8004
 Site-MNIST                    | Train Loss: 1.4341 | Train Acc: 0.7130
 Site-MNIST                    | Train Loss: 1.3792 | Train Acc: 0.7320
 Site-MNIST                    | Train Loss: 1.3881 | Train Acc: 0.7240
 Site-MNIST                    | Train Loss: 1.3948 | Train Acc: 0.7277
 Site-USPS                     | Train Loss: 1.2490 | Train Acc: 0.7518
 Site-USPS                     | Train Loss: 1.2455 | Train Acc: 0.7827
 Site-USPS                     | Train Loss: 1.2483 | Train Acc: 0.7812
 Site-SynthDigits              | Train Loss: 1.9283 | Train Acc: 0.4172
 Site-SynthDigits              | Train Loss: 1.9165 | Train Acc: 0.4451
 Site-MNIST-M                  | Train Loss: 2.1412 | Train Acc: 0.3082
 Site-MNIST-M                  | Train Loss: 2.1513 | Train Acc: 0.2848
 Site-SVHN                     | Train Loss: 2.1662 | Train Acc: 0.2709
 Site-MNIST                         | Val  Loss: 1.4267 | Val  Acc: 0.6875
 Site-MNIST                         | Val  Loss: 1.4245 | Val  Acc: 0.6627
 Site-MNIST                         | Val  Loss: 1.3720 | Val  Acc: 0.7431
 Site-MNIST                         | Val  Loss: 1.4280 | Val  Acc: 0.7079
 Site-MNIST                         | Val  Loss: 1.4381 | Val  Acc: 0.7105
 Site-USPS                          | Val  Loss: 1.2042 | Val  Acc: 0.7740
 Site-USPS                          | Val  Loss: 1.2559 | Val  Acc: 0.7628
 Site-USPS                          | Val  Loss: 1.2707 | Val  Acc: 0.7697
 Site-SynthDigits                   | Val  Loss: 1.9249 | Val  Acc: 0.4508
 Site-SynthDigits                   | Val  Loss: 1.9224 | Val  Acc: 0.4470
 Site-MNIST-M                       | Val  Loss: 2.1710 | Val  Acc: 0.2614
 Site-MNIST-M                       | Val  Loss: 2.1569 | Val  Acc: 0.2955
 Site-SVHN                          | Val  Loss: 2.1512 | Val  Acc: 0.3208
Average Valid Accuracy: 0.5841
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.6875
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.6627
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7431
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7079
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7105
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7740
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7628
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7697
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4508
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4470
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.2614
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.2955
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3208
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 16 ============
 Site-MNIST                    | Train Loss: 1.3181 | Train Acc: 0.7960
 Site-MNIST                    | Train Loss: 1.4280 | Train Acc: 0.7204
 Site-MNIST                    | Train Loss: 1.3646 | Train Acc: 0.7389
 Site-MNIST                    | Train Loss: 1.3705 | Train Acc: 0.7286
 Site-MNIST                    | Train Loss: 1.3777 | Train Acc: 0.7294
 Site-USPS                     | Train Loss: 1.2472 | Train Acc: 0.7602
 Site-USPS                     | Train Loss: 1.2117 | Train Acc: 0.7788
 Site-USPS                     | Train Loss: 1.2214 | Train Acc: 0.7827
 Site-SynthDigits              | Train Loss: 1.9202 | Train Acc: 0.4267
 Site-SynthDigits              | Train Loss: 1.8892 | Train Acc: 0.4515
 Site-MNIST-M                  | Train Loss: 2.1242 | Train Acc: 0.3139
 Site-MNIST-M                  | Train Loss: 2.1294 | Train Acc: 0.2886
 Site-SVHN                     | Train Loss: 2.1489 | Train Acc: 0.2785
 Site-MNIST                         | Val  Loss: 1.4108 | Val  Acc: 0.7054
 Site-MNIST                         | Val  Loss: 1.4072 | Val  Acc: 0.6568
 Site-MNIST                         | Val  Loss: 1.3548 | Val  Acc: 0.7549
 Site-MNIST                         | Val  Loss: 1.4105 | Val  Acc: 0.7158
 Site-MNIST                         | Val  Loss: 1.4235 | Val  Acc: 0.7175
 Site-USPS                          | Val  Loss: 1.1799 | Val  Acc: 0.7788
 Site-USPS                          | Val  Loss: 1.2325 | Val  Acc: 0.7660
 Site-USPS                          | Val  Loss: 1.2425 | Val  Acc: 0.7804
 Site-SynthDigits                   | Val  Loss: 1.8992 | Val  Acc: 0.4583
 Site-SynthDigits                   | Val  Loss: 1.8985 | Val  Acc: 0.4596
 Site-MNIST-M                       | Val  Loss: 2.1579 | Val  Acc: 0.2784
 Site-MNIST-M                       | Val  Loss: 2.1420 | Val  Acc: 0.3144
 Site-SVHN                          | Val  Loss: 2.1402 | Val  Acc: 0.3106
Average Valid Accuracy: 0.5921
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7054
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.6568
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7549
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7158
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7175
 Best site-USPS                      | Epoch:16 | Val Acc: 0.7788
 Best site-USPS                      | Epoch:16 | Val Acc: 0.7660
 Best site-USPS                      | Epoch:16 | Val Acc: 0.7804
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4583
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4596
 Best site-MNIST-M                   | Epoch:16 | Val Acc: 0.2784
 Best site-MNIST-M                   | Epoch:16 | Val Acc: 0.3144
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3106
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 17 ============
 Site-MNIST                    | Train Loss: 1.3209 | Train Acc: 0.8004
 Site-MNIST                    | Train Loss: 1.4255 | Train Acc: 0.7293
 Site-MNIST                    | Train Loss: 1.3373 | Train Acc: 0.7360
 Site-MNIST                    | Train Loss: 1.3472 | Train Acc: 0.7352
 Site-MNIST                    | Train Loss: 1.3491 | Train Acc: 0.7382
 Site-USPS                     | Train Loss: 1.1972 | Train Acc: 0.7650
 Site-USPS                     | Train Loss: 1.1922 | Train Acc: 0.7987
 Site-USPS                     | Train Loss: 1.2018 | Train Acc: 0.7865
 Site-SynthDigits              | Train Loss: 1.8554 | Train Acc: 0.4352
 Site-SynthDigits              | Train Loss: 1.8606 | Train Acc: 0.4590
 Site-MNIST-M                  | Train Loss: 2.1088 | Train Acc: 0.3210
 Site-MNIST-M                  | Train Loss: 2.1188 | Train Acc: 0.2990
 Site-SVHN                     | Train Loss: 2.1338 | Train Acc: 0.2862
 Site-MNIST                         | Val  Loss: 1.3867 | Val  Acc: 0.7232
 Site-MNIST                         | Val  Loss: 1.3818 | Val  Acc: 0.6627
 Site-MNIST                         | Val  Loss: 1.3299 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.3843 | Val  Acc: 0.7105
 Site-MNIST                         | Val  Loss: 1.3986 | Val  Acc: 0.7228
 Site-USPS                          | Val  Loss: 1.1604 | Val  Acc: 0.7933
 Site-USPS                          | Val  Loss: 1.2122 | Val  Acc: 0.7692
 Site-USPS                          | Val  Loss: 1.2213 | Val  Acc: 0.7804
 Site-SynthDigits                   | Val  Loss: 1.8718 | Val  Acc: 0.4659
 Site-SynthDigits                   | Val  Loss: 1.8696 | Val  Acc: 0.4621
 Site-MNIST-M                       | Val  Loss: 2.1461 | Val  Acc: 0.3125
 Site-MNIST-M                       | Val  Loss: 2.1247 | Val  Acc: 0.3068
 Site-SVHN                          | Val  Loss: 2.1264 | Val  Acc: 0.3140
Average Valid Accuracy: 0.5971
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7232
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.6627
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7105
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7228
 Best site-USPS                      | Epoch:17 | Val Acc: 0.7933
 Best site-USPS                      | Epoch:17 | Val Acc: 0.7692
 Best site-USPS                      | Epoch:17 | Val Acc: 0.7804
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.4659
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.4621
 Best site-MNIST-M                   | Epoch:17 | Val Acc: 0.3125
 Best site-MNIST-M                   | Epoch:17 | Val Acc: 0.3068
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3140
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 18 ============
 Site-MNIST                    | Train Loss: 1.2881 | Train Acc: 0.8027
 Site-MNIST                    | Train Loss: 1.3712 | Train Acc: 0.7396
 Site-MNIST                    | Train Loss: 1.3118 | Train Acc: 0.7488
 Site-MNIST                    | Train Loss: 1.3246 | Train Acc: 0.7431
 Site-MNIST                    | Train Loss: 1.3251 | Train Acc: 0.7478
 Site-USPS                     | Train Loss: 1.1779 | Train Acc: 0.7770
 Site-USPS                     | Train Loss: 1.1644 | Train Acc: 0.8099
 Site-USPS                     | Train Loss: 1.1568 | Train Acc: 0.7971
 Site-SynthDigits              | Train Loss: 1.8525 | Train Acc: 0.4324
 Site-SynthDigits              | Train Loss: 1.8434 | Train Acc: 0.4641
 Site-MNIST-M                  | Train Loss: 2.0956 | Train Acc: 0.3210
 Site-MNIST-M                  | Train Loss: 2.0882 | Train Acc: 0.2942
 Site-SVHN                     | Train Loss: 2.1260 | Train Acc: 0.2956
 Site-MNIST                         | Val  Loss: 1.3651 | Val  Acc: 0.7232
 Site-MNIST                         | Val  Loss: 1.3531 | Val  Acc: 0.6746
 Site-MNIST                         | Val  Loss: 1.3011 | Val  Acc: 0.7431
 Site-MNIST                         | Val  Loss: 1.3565 | Val  Acc: 0.7237
 Site-MNIST                         | Val  Loss: 1.3722 | Val  Acc: 0.7316
 Site-USPS                          | Val  Loss: 1.1196 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 1.1726 | Val  Acc: 0.7821
 Site-USPS                          | Val  Loss: 1.1787 | Val  Acc: 0.7996
 Site-SynthDigits                   | Val  Loss: 1.8508 | Val  Acc: 0.4697
 Site-SynthDigits                   | Val  Loss: 1.8514 | Val  Acc: 0.4571
 Site-MNIST-M                       | Val  Loss: 2.1330 | Val  Acc: 0.3011
 Site-MNIST-M                       | Val  Loss: 2.1114 | Val  Acc: 0.2992
 Site-SVHN                          | Val  Loss: 2.1188 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6018
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7232
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.6746
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7431
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7237
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7316
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8077
 Best site-USPS                      | Epoch:18 | Val Acc: 0.7821
 Best site-USPS                      | Epoch:18 | Val Acc: 0.7996
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4697
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4571
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.3011
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.2992
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3106
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 19 ============
 Site-MNIST                    | Train Loss: 1.2508 | Train Acc: 0.8027
 Site-MNIST                    | Train Loss: 1.3705 | Train Acc: 0.7293
 Site-MNIST                    | Train Loss: 1.2934 | Train Acc: 0.7458
 Site-MNIST                    | Train Loss: 1.3038 | Train Acc: 0.7470
 Site-MNIST                    | Train Loss: 1.3067 | Train Acc: 0.7469
 Site-USPS                     | Train Loss: 1.1562 | Train Acc: 0.7782
 Site-USPS                     | Train Loss: 1.1343 | Train Acc: 0.8035
 Site-USPS                     | Train Loss: 1.1380 | Train Acc: 0.7950
 Site-SynthDigits              | Train Loss: 1.8434 | Train Acc: 0.4447
 Site-SynthDigits              | Train Loss: 1.8108 | Train Acc: 0.4735
 Site-MNIST-M                  | Train Loss: 2.0839 | Train Acc: 0.3281
 Site-MNIST-M                  | Train Loss: 2.0872 | Train Acc: 0.3018
 Site-SVHN                     | Train Loss: 2.1113 | Train Acc: 0.2981
 Site-MNIST                         | Val  Loss: 1.3479 | Val  Acc: 0.7321
 Site-MNIST                         | Val  Loss: 1.3375 | Val  Acc: 0.6568
 Site-MNIST                         | Val  Loss: 1.2840 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.3373 | Val  Acc: 0.7184
 Site-MNIST                         | Val  Loss: 1.3540 | Val  Acc: 0.7228
 Site-USPS                          | Val  Loss: 1.1000 | Val  Acc: 0.8029
 Site-USPS                          | Val  Loss: 1.1540 | Val  Acc: 0.7821
 Site-USPS                          | Val  Loss: 1.1599 | Val  Acc: 0.7953
 Site-SynthDigits                   | Val  Loss: 1.8240 | Val  Acc: 0.4811
 Site-SynthDigits                   | Val  Loss: 1.8213 | Val  Acc: 0.4621
 Site-MNIST-M                       | Val  Loss: 2.1239 | Val  Acc: 0.3182
 Site-MNIST-M                       | Val  Loss: 2.0952 | Val  Acc: 0.3220
 Site-SVHN                          | Val  Loss: 2.1055 | Val  Acc: 0.3140
Average Valid Accuracy: 0.6036
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7321
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.6568
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7184
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7228
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8029
 Best site-USPS                      | Epoch:19 | Val Acc: 0.7821
 Best site-USPS                      | Epoch:19 | Val Acc: 0.7953
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4811
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4621
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.3182
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.3220
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3140
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
 Test site-MNIST                     | Epoch:19 | Test Acc: 0.7487
 Test site-USPS                      | Epoch:19 | Test Acc: 0.7909
 Test site-SynthDigits               | Epoch:19 | Test Acc: 0.4523
 Test site-MNIST-M                   | Epoch:19 | Test Acc: 0.3067
 Test site-SVHN                      | Epoch:19 | Test Acc: 0.2785
MNIST: 0.749, USPS: 0.791, SynthDigits: 0.452, MNIST-M: 0.307, SVHN: 0.278, 
Average Test Accuracy: 0.5154, domain std=0.2163, cluster std=-1.0000, individual std=0.2034, 
============ Train epoch 20 ============
 Site-MNIST                    | Train Loss: 1.2253 | Train Acc: 0.8093
 Site-MNIST                    | Train Loss: 1.3181 | Train Acc: 0.7663
 Site-MNIST                    | Train Loss: 1.2479 | Train Acc: 0.7764
 Site-MNIST                    | Train Loss: 1.2581 | Train Acc: 0.7668
 Site-MNIST                    | Train Loss: 1.2630 | Train Acc: 0.7684
 Site-USPS                     | Train Loss: 1.0929 | Train Acc: 0.7962
 Site-USPS                     | Train Loss: 1.0889 | Train Acc: 0.8155
 Site-USPS                     | Train Loss: 1.0879 | Train Acc: 0.8126
 Site-SynthDigits              | Train Loss: 1.8497 | Train Acc: 0.4428
 Site-SynthDigits              | Train Loss: 1.8114 | Train Acc: 0.4754
 Site-MNIST-M                  | Train Loss: 2.0706 | Train Acc: 0.3409
 Site-MNIST-M                  | Train Loss: 2.0664 | Train Acc: 0.3245
 Site-SVHN                     | Train Loss: 2.1129 | Train Acc: 0.2888
 Site-MNIST                         | Val  Loss: 1.3074 | Val  Acc: 0.7768
 Site-MNIST                         | Val  Loss: 1.2886 | Val  Acc: 0.7160
 Site-MNIST                         | Val  Loss: 1.2346 | Val  Acc: 0.7708
 Site-MNIST                         | Val  Loss: 1.2913 | Val  Acc: 0.7605
 Site-MNIST                         | Val  Loss: 1.3070 | Val  Acc: 0.7649
 Site-USPS                          | Val  Loss: 1.0512 | Val  Acc: 0.8173
 Site-USPS                          | Val  Loss: 1.1084 | Val  Acc: 0.7917
 Site-USPS                          | Val  Loss: 1.1117 | Val  Acc: 0.8081
 Site-SynthDigits                   | Val  Loss: 1.8150 | Val  Acc: 0.4924
 Site-SynthDigits                   | Val  Loss: 1.8182 | Val  Acc: 0.4697
 Site-MNIST-M                       | Val  Loss: 2.1096 | Val  Acc: 0.3239
 Site-MNIST-M                       | Val  Loss: 2.0864 | Val  Acc: 0.3182
 Site-SVHN                          | Val  Loss: 2.1055 | Val  Acc: 0.3072
Average Valid Accuracy: 0.6244
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.7768
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.7160
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.7708
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.7605
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.7649
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8173
 Best site-USPS                      | Epoch:20 | Val Acc: 0.7917
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8081
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.4924
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.4697
 Best site-MNIST-M                   | Epoch:20 | Val Acc: 0.3239
 Best site-MNIST-M                   | Epoch:20 | Val Acc: 0.3182
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3072
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 21 ============
 Site-MNIST                    | Train Loss: 1.1885 | Train Acc: 0.8137
 Site-MNIST                    | Train Loss: 1.2982 | Train Acc: 0.7470
 Site-MNIST                    | Train Loss: 1.2324 | Train Acc: 0.7635
 Site-MNIST                    | Train Loss: 1.2420 | Train Acc: 0.7622
 Site-MNIST                    | Train Loss: 1.2466 | Train Acc: 0.7609
 Site-USPS                     | Train Loss: 1.1137 | Train Acc: 0.7926
 Site-USPS                     | Train Loss: 1.0735 | Train Acc: 0.8171
 Site-USPS                     | Train Loss: 1.0873 | Train Acc: 0.8040
 Site-SynthDigits              | Train Loss: 1.7823 | Train Acc: 0.4598
 Site-SynthDigits              | Train Loss: 1.7794 | Train Acc: 0.4868
 Site-MNIST-M                  | Train Loss: 2.0600 | Train Acc: 0.3452
 Site-MNIST-M                  | Train Loss: 2.0445 | Train Acc: 0.3179
 Site-SVHN                     | Train Loss: 2.0975 | Train Acc: 0.2930
 Site-MNIST                         | Val  Loss: 1.2889 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.2764 | Val  Acc: 0.6805
 Site-MNIST                         | Val  Loss: 1.2228 | Val  Acc: 0.7589
 Site-MNIST                         | Val  Loss: 1.2770 | Val  Acc: 0.7474
 Site-MNIST                         | Val  Loss: 1.2941 | Val  Acc: 0.7456
 Site-USPS                          | Val  Loss: 1.0485 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 1.1045 | Val  Acc: 0.7853
 Site-USPS                          | Val  Loss: 1.1090 | Val  Acc: 0.8017
 Site-SynthDigits                   | Val  Loss: 1.7873 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.7884 | Val  Acc: 0.4848
 Site-MNIST-M                       | Val  Loss: 2.1048 | Val  Acc: 0.3523
 Site-MNIST-M                       | Val  Loss: 2.0719 | Val  Acc: 0.3220
 Site-SVHN                          | Val  Loss: 2.0899 | Val  Acc: 0.3106
Average Valid Accuracy: 0.6193
============ Train epoch 22 ============
 Site-MNIST                    | Train Loss: 1.1801 | Train Acc: 0.8137
 Site-MNIST                    | Train Loss: 1.2965 | Train Acc: 0.7500
 Site-MNIST                    | Train Loss: 1.2147 | Train Acc: 0.7744
 Site-MNIST                    | Train Loss: 1.2257 | Train Acc: 0.7654
 Site-MNIST                    | Train Loss: 1.2283 | Train Acc: 0.7623
 Site-USPS                     | Train Loss: 1.0967 | Train Acc: 0.7938
 Site-USPS                     | Train Loss: 1.0559 | Train Acc: 0.8187
 Site-USPS                     | Train Loss: 1.0695 | Train Acc: 0.8040
 Site-SynthDigits              | Train Loss: 1.7881 | Train Acc: 0.4702
 Site-SynthDigits              | Train Loss: 1.7581 | Train Acc: 0.4905
 Site-MNIST-M                  | Train Loss: 2.0519 | Train Acc: 0.3395
 Site-MNIST-M                  | Train Loss: 2.0507 | Train Acc: 0.3273
 Site-SVHN                     | Train Loss: 2.0857 | Train Acc: 0.3058
 Site-MNIST                         | Val  Loss: 1.2727 | Val  Acc: 0.7679
 Site-MNIST                         | Val  Loss: 1.2596 | Val  Acc: 0.6982
 Site-MNIST                         | Val  Loss: 1.2054 | Val  Acc: 0.7747
 Site-MNIST                         | Val  Loss: 1.2590 | Val  Acc: 0.7526
 Site-MNIST                         | Val  Loss: 1.2771 | Val  Acc: 0.7439
 Site-USPS                          | Val  Loss: 1.0324 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 1.0885 | Val  Acc: 0.7853
 Site-USPS                          | Val  Loss: 1.0918 | Val  Acc: 0.8017
 Site-SynthDigits                   | Val  Loss: 1.7679 | Val  Acc: 0.5076
 Site-SynthDigits                   | Val  Loss: 1.7673 | Val  Acc: 0.4975
 Site-MNIST-M                       | Val  Loss: 2.0970 | Val  Acc: 0.3295
 Site-MNIST-M                       | Val  Loss: 2.0642 | Val  Acc: 0.3295
 Site-SVHN                          | Val  Loss: 2.0763 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6253
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7679
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.6982
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7747
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7526
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7439
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8125
 Best site-USPS                      | Epoch:22 | Val Acc: 0.7853
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8017
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.5076
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.4975
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.3295
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.3295
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.3276
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 23 ============
 Site-MNIST                    | Train Loss: 1.2084 | Train Acc: 0.8115
 Site-MNIST                    | Train Loss: 1.2688 | Train Acc: 0.7308
 Site-MNIST                    | Train Loss: 1.1967 | Train Acc: 0.7576
 Site-MNIST                    | Train Loss: 1.2078 | Train Acc: 0.7589
 Site-MNIST                    | Train Loss: 1.2097 | Train Acc: 0.7557
 Site-USPS                     | Train Loss: 1.0719 | Train Acc: 0.7854
 Site-USPS                     | Train Loss: 1.0622 | Train Acc: 0.8107
 Site-USPS                     | Train Loss: 1.0615 | Train Acc: 0.7977
 Site-SynthDigits              | Train Loss: 1.7712 | Train Acc: 0.4768
 Site-SynthDigits              | Train Loss: 1.7330 | Train Acc: 0.5044
 Site-MNIST-M                  | Train Loss: 2.0483 | Train Acc: 0.3494
 Site-MNIST-M                  | Train Loss: 2.0423 | Train Acc: 0.3273
 Site-SVHN                     | Train Loss: 2.0751 | Train Acc: 0.3032
 Site-MNIST                         | Val  Loss: 1.2506 | Val  Acc: 0.7411
 Site-MNIST                         | Val  Loss: 1.2458 | Val  Acc: 0.6627
 Site-MNIST                         | Val  Loss: 1.1917 | Val  Acc: 0.7549
 Site-MNIST                         | Val  Loss: 1.2429 | Val  Acc: 0.7289
 Site-MNIST                         | Val  Loss: 1.2612 | Val  Acc: 0.7228
 Site-USPS                          | Val  Loss: 1.0178 | Val  Acc: 0.8173
 Site-USPS                          | Val  Loss: 1.0744 | Val  Acc: 0.7853
 Site-USPS                          | Val  Loss: 1.0790 | Val  Acc: 0.7932
 Site-SynthDigits                   | Val  Loss: 1.7501 | Val  Acc: 0.5227
 Site-SynthDigits                   | Val  Loss: 1.7464 | Val  Acc: 0.5126
 Site-MNIST-M                       | Val  Loss: 2.0934 | Val  Acc: 0.3466
 Site-MNIST-M                       | Val  Loss: 2.0554 | Val  Acc: 0.3295
 Site-SVHN                          | Val  Loss: 2.0624 | Val  Acc: 0.3174
Average Valid Accuracy: 0.6181
============ Train epoch 24 ============
 Site-MNIST                    | Train Loss: 1.1102 | Train Acc: 0.8160
 Site-MNIST                    | Train Loss: 1.2624 | Train Acc: 0.7426
 Site-MNIST                    | Train Loss: 1.1723 | Train Acc: 0.7704
 Site-MNIST                    | Train Loss: 1.1849 | Train Acc: 0.7687
 Site-MNIST                    | Train Loss: 1.1849 | Train Acc: 0.7644
 Site-USPS                     | Train Loss: 1.0381 | Train Acc: 0.7950
 Site-USPS                     | Train Loss: 1.0334 | Train Acc: 0.8139
 Site-USPS                     | Train Loss: 1.0409 | Train Acc: 0.7993
 Site-SynthDigits              | Train Loss: 1.7657 | Train Acc: 0.4834
 Site-SynthDigits              | Train Loss: 1.7158 | Train Acc: 0.5095
 Site-MNIST-M                  | Train Loss: 2.0346 | Train Acc: 0.3494
 Site-MNIST-M                  | Train Loss: 2.0478 | Train Acc: 0.3340
 Site-SVHN                     | Train Loss: 2.0658 | Train Acc: 0.3135
 Site-MNIST                         | Val  Loss: 1.2281 | Val  Acc: 0.7589
 Site-MNIST                         | Val  Loss: 1.2187 | Val  Acc: 0.6982
 Site-MNIST                         | Val  Loss: 1.1662 | Val  Acc: 0.7708
 Site-MNIST                         | Val  Loss: 1.2180 | Val  Acc: 0.7447
 Site-MNIST                         | Val  Loss: 1.2365 | Val  Acc: 0.7368
 Site-USPS                          | Val  Loss: 0.9995 | Val  Acc: 0.8221
 Site-USPS                          | Val  Loss: 1.0570 | Val  Acc: 0.7885
 Site-USPS                          | Val  Loss: 1.0598 | Val  Acc: 0.7953
 Site-SynthDigits                   | Val  Loss: 1.7314 | Val  Acc: 0.5417
 Site-SynthDigits                   | Val  Loss: 1.7270 | Val  Acc: 0.5253
 Site-MNIST-M                       | Val  Loss: 2.0818 | Val  Acc: 0.3352
 Site-MNIST-M                       | Val  Loss: 2.0418 | Val  Acc: 0.3371
 Site-SVHN                          | Val  Loss: 2.0518 | Val  Acc: 0.3413
Average Valid Accuracy: 0.6305
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7589
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.6982
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7708
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7447
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7368
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8221
 Best site-USPS                      | Epoch:24 | Val Acc: 0.7885
 Best site-USPS                      | Epoch:24 | Val Acc: 0.7953
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.5417
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.5253
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.3352
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.3371
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3413
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 25 ============
 Site-MNIST                    | Train Loss: 1.1194 | Train Acc: 0.8137
 Site-MNIST                    | Train Loss: 1.2266 | Train Acc: 0.7485
 Site-MNIST                    | Train Loss: 1.1493 | Train Acc: 0.7754
 Site-MNIST                    | Train Loss: 1.1606 | Train Acc: 0.7727
 Site-MNIST                    | Train Loss: 1.1652 | Train Acc: 0.7715
 Site-USPS                     | Train Loss: 1.0425 | Train Acc: 0.7962
 Site-USPS                     | Train Loss: 1.0145 | Train Acc: 0.8147
 Site-USPS                     | Train Loss: 1.0222 | Train Acc: 0.7993
 Site-SynthDigits              | Train Loss: 1.7381 | Train Acc: 0.4834
 Site-SynthDigits              | Train Loss: 1.7041 | Train Acc: 0.5076
 Site-MNIST-M                  | Train Loss: 2.0215 | Train Acc: 0.3452
 Site-MNIST-M                  | Train Loss: 2.0275 | Train Acc: 0.3491
 Site-SVHN                     | Train Loss: 2.0603 | Train Acc: 0.3083
 Site-MNIST                         | Val  Loss: 1.2047 | Val  Acc: 0.7768
 Site-MNIST                         | Val  Loss: 1.1954 | Val  Acc: 0.7101
 Site-MNIST                         | Val  Loss: 1.1437 | Val  Acc: 0.7668
 Site-MNIST                         | Val  Loss: 1.1955 | Val  Acc: 0.7474
 Site-MNIST                         | Val  Loss: 1.2141 | Val  Acc: 0.7439
 Site-USPS                          | Val  Loss: 0.9799 | Val  Acc: 0.8173
 Site-USPS                          | Val  Loss: 1.0384 | Val  Acc: 0.7885
 Site-USPS                          | Val  Loss: 1.0403 | Val  Acc: 0.7953
 Site-SynthDigits                   | Val  Loss: 1.7193 | Val  Acc: 0.5455
 Site-SynthDigits                   | Val  Loss: 1.7162 | Val  Acc: 0.5227
 Site-MNIST-M                       | Val  Loss: 2.0707 | Val  Acc: 0.3295
 Site-MNIST-M                       | Val  Loss: 2.0323 | Val  Acc: 0.3371
 Site-SVHN                          | Val  Loss: 2.0434 | Val  Acc: 0.3311
Average Valid Accuracy: 0.6317
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7768
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7101
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7668
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7474
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7439
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8173
 Best site-USPS                      | Epoch:25 | Val Acc: 0.7885
 Best site-USPS                      | Epoch:25 | Val Acc: 0.7953
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.5455
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.5227
 Best site-MNIST-M                   | Epoch:25 | Val Acc: 0.3295
 Best site-MNIST-M                   | Epoch:25 | Val Acc: 0.3371
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.3311
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 26 ============
 Site-MNIST                    | Train Loss: 1.0714 | Train Acc: 0.8226
 Site-MNIST                    | Train Loss: 1.2005 | Train Acc: 0.7633
 Site-MNIST                    | Train Loss: 1.1217 | Train Acc: 0.7803
 Site-MNIST                    | Train Loss: 1.1353 | Train Acc: 0.7858
 Site-MNIST                    | Train Loss: 1.1372 | Train Acc: 0.7820
 Site-USPS                     | Train Loss: 1.0537 | Train Acc: 0.7962
 Site-USPS                     | Train Loss: 0.9948 | Train Acc: 0.8171
 Site-USPS                     | Train Loss: 0.9934 | Train Acc: 0.8078
 Site-SynthDigits              | Train Loss: 1.7013 | Train Acc: 0.4778
 Site-SynthDigits              | Train Loss: 1.6993 | Train Acc: 0.5038
 Site-MNIST-M                  | Train Loss: 2.0047 | Train Acc: 0.3608
 Site-MNIST-M                  | Train Loss: 2.0240 | Train Acc: 0.3586
 Site-SVHN                     | Train Loss: 2.0584 | Train Acc: 0.3083
 Site-MNIST                         | Val  Loss: 1.1812 | Val  Acc: 0.7768
 Site-MNIST                         | Val  Loss: 1.1677 | Val  Acc: 0.7160
 Site-MNIST                         | Val  Loss: 1.1163 | Val  Acc: 0.7668
 Site-MNIST                         | Val  Loss: 1.1685 | Val  Acc: 0.7632
 Site-MNIST                         | Val  Loss: 1.1871 | Val  Acc: 0.7667
 Site-USPS                          | Val  Loss: 0.9510 | Val  Acc: 0.8173
 Site-USPS                          | Val  Loss: 1.0122 | Val  Acc: 0.7853
 Site-USPS                          | Val  Loss: 1.0125 | Val  Acc: 0.8017
 Site-SynthDigits                   | Val  Loss: 1.7088 | Val  Acc: 0.5341
 Site-SynthDigits                   | Val  Loss: 1.7089 | Val  Acc: 0.4975
 Site-MNIST-M                       | Val  Loss: 2.0570 | Val  Acc: 0.3523
 Site-MNIST-M                       | Val  Loss: 2.0182 | Val  Acc: 0.3598
 Site-SVHN                          | Val  Loss: 2.0398 | Val  Acc: 0.3481
Average Valid Accuracy: 0.6373
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.7768
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.7160
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.7668
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.7632
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.7667
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8173
 Best site-USPS                      | Epoch:26 | Val Acc: 0.7853
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8017
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.5341
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.4975
 Best site-MNIST-M                   | Epoch:26 | Val Acc: 0.3523
 Best site-MNIST-M                   | Epoch:26 | Val Acc: 0.3598
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.3481
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 27 ============
 Site-MNIST                    | Train Loss: 1.1063 | Train Acc: 0.8248
 Site-MNIST                    | Train Loss: 1.1932 | Train Acc: 0.7589
 Site-MNIST                    | Train Loss: 1.1107 | Train Acc: 0.7813
 Site-MNIST                    | Train Loss: 1.1234 | Train Acc: 0.7792
 Site-MNIST                    | Train Loss: 1.1272 | Train Acc: 0.7789
 Site-USPS                     | Train Loss: 1.0106 | Train Acc: 0.7938
 Site-USPS                     | Train Loss: 0.9699 | Train Acc: 0.8139
 Site-USPS                     | Train Loss: 0.9906 | Train Acc: 0.8024
 Site-SynthDigits              | Train Loss: 1.7122 | Train Acc: 0.4825
 Site-SynthDigits              | Train Loss: 1.6758 | Train Acc: 0.5069
 Site-MNIST-M                  | Train Loss: 2.0004 | Train Acc: 0.3580
 Site-MNIST-M                  | Train Loss: 2.0147 | Train Acc: 0.3605
 Site-SVHN                     | Train Loss: 2.0457 | Train Acc: 0.3109
 Site-MNIST                         | Val  Loss: 1.1686 | Val  Acc: 0.7857
 Site-MNIST                         | Val  Loss: 1.1566 | Val  Acc: 0.7219
 Site-MNIST                         | Val  Loss: 1.1048 | Val  Acc: 0.7708
 Site-MNIST                         | Val  Loss: 1.1556 | Val  Acc: 0.7632
 Site-MNIST                         | Val  Loss: 1.1753 | Val  Acc: 0.7596
 Site-USPS                          | Val  Loss: 0.9471 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 1.0087 | Val  Acc: 0.7853
 Site-USPS                          | Val  Loss: 1.0083 | Val  Acc: 0.8017
 Site-SynthDigits                   | Val  Loss: 1.6900 | Val  Acc: 0.5341
 Site-SynthDigits                   | Val  Loss: 1.6876 | Val  Acc: 0.5076
 Site-MNIST-M                       | Val  Loss: 2.0551 | Val  Acc: 0.3466
 Site-MNIST-M                       | Val  Loss: 2.0129 | Val  Acc: 0.3598
 Site-SVHN                          | Val  Loss: 2.0280 | Val  Acc: 0.3481
Average Valid Accuracy: 0.6378
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.7857
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.7219
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.7708
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.7632
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.7596
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8077
 Best site-USPS                      | Epoch:27 | Val Acc: 0.7853
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8017
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5341
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5076
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.3466
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.3598
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.3481
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 28 ============
 Site-MNIST                    | Train Loss: 1.0332 | Train Acc: 0.8359
 Site-MNIST                    | Train Loss: 1.1609 | Train Acc: 0.7781
 Site-MNIST                    | Train Loss: 1.0846 | Train Acc: 0.7852
 Site-MNIST                    | Train Loss: 1.0964 | Train Acc: 0.7937
 Site-MNIST                    | Train Loss: 1.0947 | Train Acc: 0.7859
 Site-USPS                     | Train Loss: 0.9971 | Train Acc: 0.7998
 Site-USPS                     | Train Loss: 0.9590 | Train Acc: 0.8115
 Site-USPS                     | Train Loss: 0.9717 | Train Acc: 0.8115
 Site-SynthDigits              | Train Loss: 1.7056 | Train Acc: 0.4797
 Site-SynthDigits              | Train Loss: 1.6776 | Train Acc: 0.5126
 Site-MNIST-M                  | Train Loss: 1.9798 | Train Acc: 0.3693
 Site-MNIST-M                  | Train Loss: 1.9764 | Train Acc: 0.3718
 Site-SVHN                     | Train Loss: 2.0519 | Train Acc: 0.3007
 Site-MNIST                         | Val  Loss: 1.1435 | Val  Acc: 0.7857
 Site-MNIST                         | Val  Loss: 1.1291 | Val  Acc: 0.7278
 Site-MNIST                         | Val  Loss: 1.0768 | Val  Acc: 0.7708
 Site-MNIST                         | Val  Loss: 1.1290 | Val  Acc: 0.7684
 Site-MNIST                         | Val  Loss: 1.1481 | Val  Acc: 0.7754
 Site-USPS                          | Val  Loss: 0.9304 | Val  Acc: 0.7885
 Site-USPS                          | Val  Loss: 0.9935 | Val  Acc: 0.7756
 Site-USPS                          | Val  Loss: 0.9920 | Val  Acc: 0.8102
 Site-SynthDigits                   | Val  Loss: 1.6866 | Val  Acc: 0.5455
 Site-SynthDigits                   | Val  Loss: 1.6879 | Val  Acc: 0.5101
 Site-MNIST-M                       | Val  Loss: 2.0371 | Val  Acc: 0.3523
 Site-MNIST-M                       | Val  Loss: 1.9993 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 2.0327 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6380
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.7857
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.7278
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.7708
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.7684
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.7754
 Best site-USPS                      | Epoch:28 | Val Acc: 0.7885
 Best site-USPS                      | Epoch:28 | Val Acc: 0.7756
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8102
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.5455
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.5101
 Best site-MNIST-M                   | Epoch:28 | Val Acc: 0.3523
 Best site-MNIST-M                   | Epoch:28 | Val Acc: 0.3561
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.3276
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 29 ============
 Site-MNIST                    | Train Loss: 1.0179 | Train Acc: 0.8226
 Site-MNIST                    | Train Loss: 1.1772 | Train Acc: 0.7559
 Site-MNIST                    | Train Loss: 1.0854 | Train Acc: 0.7823
 Site-MNIST                    | Train Loss: 1.0976 | Train Acc: 0.7819
 Site-MNIST                    | Train Loss: 1.0969 | Train Acc: 0.7793
 Site-USPS                     | Train Loss: 0.9885 | Train Acc: 0.8010
 Site-USPS                     | Train Loss: 0.9658 | Train Acc: 0.8203
 Site-USPS                     | Train Loss: 0.9676 | Train Acc: 0.8056
 Site-SynthDigits              | Train Loss: 1.6896 | Train Acc: 0.4995
 Site-SynthDigits              | Train Loss: 1.6450 | Train Acc: 0.5164
 Site-MNIST-M                  | Train Loss: 1.9807 | Train Acc: 0.3707
 Site-MNIST-M                  | Train Loss: 1.9832 | Train Acc: 0.3661
 Site-SVHN                     | Train Loss: 2.0311 | Train Acc: 0.3169
 Site-MNIST                         | Val  Loss: 1.1431 | Val  Acc: 0.7946
 Site-MNIST                         | Val  Loss: 1.1332 | Val  Acc: 0.7160
 Site-MNIST                         | Val  Loss: 1.0809 | Val  Acc: 0.7668
 Site-MNIST                         | Val  Loss: 1.1282 | Val  Acc: 0.7579
 Site-MNIST                         | Val  Loss: 1.1496 | Val  Acc: 0.7526
 Site-USPS                          | Val  Loss: 0.9247 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.9874 | Val  Acc: 0.7885
 Site-USPS                          | Val  Loss: 0.9863 | Val  Acc: 0.7996
 Site-SynthDigits                   | Val  Loss: 1.6602 | Val  Acc: 0.5568
 Site-SynthDigits                   | Val  Loss: 1.6568 | Val  Acc: 0.5354
 Site-MNIST-M                       | Val  Loss: 2.0380 | Val  Acc: 0.3352
 Site-MNIST-M                       | Val  Loss: 1.9940 | Val  Acc: 0.3750
 Site-SVHN                          | Val  Loss: 2.0125 | Val  Acc: 0.3481
Average Valid Accuracy: 0.6411
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.7946
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.7160
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.7668
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.7579
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.7526
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8077
 Best site-USPS                      | Epoch:29 | Val Acc: 0.7885
 Best site-USPS                      | Epoch:29 | Val Acc: 0.7996
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5568
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5354
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.3352
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.3750
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3481
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
 Test site-MNIST                     | Epoch:29 | Test Acc: 0.7817
 Test site-USPS                      | Epoch:29 | Test Acc: 0.8016
 Test site-SynthDigits               | Epoch:29 | Test Acc: 0.5081
 Test site-MNIST-M                   | Epoch:29 | Test Acc: 0.3552
 Test site-SVHN                      | Epoch:29 | Test Acc: 0.2944
MNIST: 0.782, USPS: 0.802, SynthDigits: 0.508, MNIST-M: 0.355, SVHN: 0.294, 
Average Test Accuracy: 0.5482, domain std=0.2107, cluster std=-1.0000, individual std=0.1952, 
============ Train epoch 30 ============
 Site-MNIST                    | Train Loss: 1.0085 | Train Acc: 0.8359
 Site-MNIST                    | Train Loss: 1.1149 | Train Acc: 0.7796
 Site-MNIST                    | Train Loss: 1.0491 | Train Acc: 0.7951
 Site-MNIST                    | Train Loss: 1.0624 | Train Acc: 0.8003
 Site-MNIST                    | Train Loss: 1.0627 | Train Acc: 0.7912
 Site-USPS                     | Train Loss: 0.9878 | Train Acc: 0.8070
 Site-USPS                     | Train Loss: 0.9337 | Train Acc: 0.8115
 Site-USPS                     | Train Loss: 0.9450 | Train Acc: 0.8131
 Site-SynthDigits              | Train Loss: 1.6908 | Train Acc: 0.4891
 Site-SynthDigits              | Train Loss: 1.6538 | Train Acc: 0.5183
 Site-MNIST-M                  | Train Loss: 1.9617 | Train Acc: 0.3778
 Site-MNIST-M                  | Train Loss: 1.9711 | Train Acc: 0.3888
 Site-SVHN                     | Train Loss: 2.0394 | Train Acc: 0.3032
 Site-MNIST                         | Val  Loss: 1.1106 | Val  Acc: 0.7946
 Site-MNIST                         | Val  Loss: 1.0979 | Val  Acc: 0.7396
 Site-MNIST                         | Val  Loss: 1.0434 | Val  Acc: 0.7787
 Site-MNIST                         | Val  Loss: 1.0937 | Val  Acc: 0.7763
 Site-MNIST                         | Val  Loss: 1.1131 | Val  Acc: 0.7789
 Site-USPS                          | Val  Loss: 0.9019 | Val  Acc: 0.7837
 Site-USPS                          | Val  Loss: 0.9662 | Val  Acc: 0.7724
 Site-USPS                          | Val  Loss: 0.9633 | Val  Acc: 0.8209
 Site-SynthDigits                   | Val  Loss: 1.6606 | Val  Acc: 0.5492
 Site-SynthDigits                   | Val  Loss: 1.6618 | Val  Acc: 0.5177
 Site-MNIST-M                       | Val  Loss: 2.0202 | Val  Acc: 0.3523
 Site-MNIST-M                       | Val  Loss: 1.9838 | Val  Acc: 0.3750
 Site-SVHN                          | Val  Loss: 2.0178 | Val  Acc: 0.3413
Average Valid Accuracy: 0.6447
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.7946
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.7396
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.7787
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.7763
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.7789
 Best site-USPS                      | Epoch:30 | Val Acc: 0.7837
 Best site-USPS                      | Epoch:30 | Val Acc: 0.7724
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8209
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5492
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5177
 Best site-MNIST-M                   | Epoch:30 | Val Acc: 0.3523
 Best site-MNIST-M                   | Epoch:30 | Val Acc: 0.3750
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.3413
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 31 ============
 Site-MNIST                    | Train Loss: 1.0005 | Train Acc: 0.8271
 Site-MNIST                    | Train Loss: 1.0960 | Train Acc: 0.7781
 Site-MNIST                    | Train Loss: 1.0438 | Train Acc: 0.7941
 Site-MNIST                    | Train Loss: 1.0567 | Train Acc: 0.7983
 Site-MNIST                    | Train Loss: 1.0560 | Train Acc: 0.7881
 Site-USPS                     | Train Loss: 0.9601 | Train Acc: 0.8034
 Site-USPS                     | Train Loss: 0.9449 | Train Acc: 0.8139
 Site-USPS                     | Train Loss: 0.9405 | Train Acc: 0.8131
 Site-SynthDigits              | Train Loss: 1.6646 | Train Acc: 0.4929
 Site-SynthDigits              | Train Loss: 1.6303 | Train Acc: 0.5252
 Site-MNIST-M                  | Train Loss: 1.9574 | Train Acc: 0.3793
 Site-MNIST-M                  | Train Loss: 1.9595 | Train Acc: 0.3803
 Site-SVHN                     | Train Loss: 2.0261 | Train Acc: 0.3152
 Site-MNIST                         | Val  Loss: 1.1041 | Val  Acc: 0.7946
 Site-MNIST                         | Val  Loss: 1.0949 | Val  Acc: 0.7278
 Site-MNIST                         | Val  Loss: 1.0398 | Val  Acc: 0.7708
 Site-MNIST                         | Val  Loss: 1.0867 | Val  Acc: 0.7789
 Site-MNIST                         | Val  Loss: 1.1079 | Val  Acc: 0.7772
 Site-USPS                          | Val  Loss: 0.8998 | Val  Acc: 0.7981
 Site-USPS                          | Val  Loss: 0.9633 | Val  Acc: 0.7821
 Site-USPS                          | Val  Loss: 0.9586 | Val  Acc: 0.8124
 Site-SynthDigits                   | Val  Loss: 1.6425 | Val  Acc: 0.5530
 Site-SynthDigits                   | Val  Loss: 1.6407 | Val  Acc: 0.5253
 Site-MNIST-M                       | Val  Loss: 2.0188 | Val  Acc: 0.3580
 Site-MNIST-M                       | Val  Loss: 1.9776 | Val  Acc: 0.3712
 Site-SVHN                          | Val  Loss: 2.0053 | Val  Acc: 0.3618
Average Valid Accuracy: 0.6470
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.7946
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.7278
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.7708
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.7789
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.7772
 Best site-USPS                      | Epoch:31 | Val Acc: 0.7981
 Best site-USPS                      | Epoch:31 | Val Acc: 0.7821
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8124
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5530
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5253
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.3580
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.3712
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.3618
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 32 ============
 Site-MNIST                    | Train Loss: 0.9805 | Train Acc: 0.8160
 Site-MNIST                    | Train Loss: 1.1101 | Train Acc: 0.7737
 Site-MNIST                    | Train Loss: 1.0406 | Train Acc: 0.7872
 Site-MNIST                    | Train Loss: 1.0507 | Train Acc: 0.7898
 Site-MNIST                    | Train Loss: 1.0517 | Train Acc: 0.7850
 Site-USPS                     | Train Loss: 0.9452 | Train Acc: 0.8094
 Site-USPS                     | Train Loss: 0.9394 | Train Acc: 0.8171
 Site-USPS                     | Train Loss: 0.9431 | Train Acc: 0.8019
 Site-SynthDigits              | Train Loss: 1.6307 | Train Acc: 0.5289
 Site-SynthDigits              | Train Loss: 1.6007 | Train Acc: 0.5296
 Site-MNIST-M                  | Train Loss: 1.9584 | Train Acc: 0.3849
 Site-MNIST-M                  | Train Loss: 1.9685 | Train Acc: 0.3671
 Site-SVHN                     | Train Loss: 2.0119 | Train Acc: 0.3288
 Site-MNIST                         | Val  Loss: 1.0984 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.0921 | Val  Acc: 0.7160
 Site-MNIST                         | Val  Loss: 1.0385 | Val  Acc: 0.7668
 Site-MNIST                         | Val  Loss: 1.0822 | Val  Acc: 0.7711
 Site-MNIST                         | Val  Loss: 1.1052 | Val  Acc: 0.7702
 Site-USPS                          | Val  Loss: 0.9017 | Val  Acc: 0.8029
 Site-USPS                          | Val  Loss: 0.9648 | Val  Acc: 0.7853
 Site-USPS                          | Val  Loss: 0.9608 | Val  Acc: 0.8038
 Site-SynthDigits                   | Val  Loss: 1.6197 | Val  Acc: 0.5871
 Site-SynthDigits                   | Val  Loss: 1.6138 | Val  Acc: 0.5707
 Site-MNIST-M                       | Val  Loss: 2.0187 | Val  Acc: 0.3409
 Site-MNIST-M                       | Val  Loss: 1.9730 | Val  Acc: 0.3902
 Site-SVHN                          | Val  Loss: 1.9943 | Val  Acc: 0.3549
Average Valid Accuracy: 0.6510
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.7160
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.7668
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.7711
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.7702
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8029
 Best site-USPS                      | Epoch:32 | Val Acc: 0.7853
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8038
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.5871
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.5707
 Best site-MNIST-M                   | Epoch:32 | Val Acc: 0.3409
 Best site-MNIST-M                   | Epoch:32 | Val Acc: 0.3902
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.3549
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 33 ============
 Site-MNIST                    | Train Loss: 0.9704 | Train Acc: 0.8027
 Site-MNIST                    | Train Loss: 1.1016 | Train Acc: 0.7544
 Site-MNIST                    | Train Loss: 1.0410 | Train Acc: 0.7724
 Site-MNIST                    | Train Loss: 1.0545 | Train Acc: 0.7845
 Site-MNIST                    | Train Loss: 1.0512 | Train Acc: 0.7771
 Site-USPS                     | Train Loss: 0.9883 | Train Acc: 0.8010
 Site-USPS                     | Train Loss: 0.9442 | Train Acc: 0.8091
 Site-USPS                     | Train Loss: 0.9506 | Train Acc: 0.7875
 Site-SynthDigits              | Train Loss: 1.5910 | Train Acc: 0.5345
 Site-SynthDigits              | Train Loss: 1.5759 | Train Acc: 0.5460
 Site-MNIST-M                  | Train Loss: 1.9681 | Train Acc: 0.3864
 Site-MNIST-M                  | Train Loss: 1.9459 | Train Acc: 0.3605
 Site-SVHN                     | Train Loss: 1.9944 | Train Acc: 0.3348
 Site-MNIST                         | Val  Loss: 1.0985 | Val  Acc: 0.7768
 Site-MNIST                         | Val  Loss: 1.0975 | Val  Acc: 0.6923
 Site-MNIST                         | Val  Loss: 1.0412 | Val  Acc: 0.7708
 Site-MNIST                         | Val  Loss: 1.0824 | Val  Acc: 0.7553
 Site-MNIST                         | Val  Loss: 1.1081 | Val  Acc: 0.7491
 Site-USPS                          | Val  Loss: 0.9049 | Val  Acc: 0.7885
 Site-USPS                          | Val  Loss: 0.9687 | Val  Acc: 0.7692
 Site-USPS                          | Val  Loss: 0.9641 | Val  Acc: 0.7996
 Site-SynthDigits                   | Val  Loss: 1.6030 | Val  Acc: 0.5758
 Site-SynthDigits                   | Val  Loss: 1.5908 | Val  Acc: 0.5581
 Site-MNIST-M                       | Val  Loss: 2.0299 | Val  Acc: 0.3466
 Site-MNIST-M                       | Val  Loss: 1.9784 | Val  Acc: 0.3902
 Site-SVHN                          | Val  Loss: 1.9744 | Val  Acc: 0.3652
Average Valid Accuracy: 0.6413
============ Train epoch 34 ============
 Site-MNIST                    | Train Loss: 0.9811 | Train Acc: 0.8271
 Site-MNIST                    | Train Loss: 1.0577 | Train Acc: 0.7899
 Site-MNIST                    | Train Loss: 0.9995 | Train Acc: 0.7980
 Site-MNIST                    | Train Loss: 1.0117 | Train Acc: 0.8029
 Site-MNIST                    | Train Loss: 1.0086 | Train Acc: 0.7933
 Site-USPS                     | Train Loss: 0.9602 | Train Acc: 0.8106
 Site-USPS                     | Train Loss: 0.9143 | Train Acc: 0.8187
 Site-USPS                     | Train Loss: 0.9162 | Train Acc: 0.8131
 Site-SynthDigits              | Train Loss: 1.5909 | Train Acc: 0.5118
 Site-SynthDigits              | Train Loss: 1.5946 | Train Acc: 0.5366
 Site-MNIST-M                  | Train Loss: 1.9297 | Train Acc: 0.3977
 Site-MNIST-M                  | Train Loss: 1.8919 | Train Acc: 0.3983
 Site-SVHN                     | Train Loss: 2.0100 | Train Acc: 0.3194
 Site-MNIST                         | Val  Loss: 1.0599 | Val  Acc: 0.7946
 Site-MNIST                         | Val  Loss: 1.0525 | Val  Acc: 0.7337
 Site-MNIST                         | Val  Loss: 0.9964 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 1.0419 | Val  Acc: 0.7868
 Site-MNIST                         | Val  Loss: 1.0641 | Val  Acc: 0.7895
 Site-USPS                          | Val  Loss: 0.8753 | Val  Acc: 0.7981
 Site-USPS                          | Val  Loss: 0.9384 | Val  Acc: 0.7788
 Site-USPS                          | Val  Loss: 0.9322 | Val  Acc: 0.8124
 Site-SynthDigits                   | Val  Loss: 1.6082 | Val  Acc: 0.5606
 Site-SynthDigits                   | Val  Loss: 1.6058 | Val  Acc: 0.5404
 Site-MNIST-M                       | Val  Loss: 1.9943 | Val  Acc: 0.3580
 Site-MNIST-M                       | Val  Loss: 1.9543 | Val  Acc: 0.4015
 Site-SVHN                          | Val  Loss: 1.9871 | Val  Acc: 0.3584
Average Valid Accuracy: 0.6535
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.7946
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.7337
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.7826
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.7868
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.7895
 Best site-USPS                      | Epoch:34 | Val Acc: 0.7981
 Best site-USPS                      | Epoch:34 | Val Acc: 0.7788
 Best site-USPS                      | Epoch:34 | Val Acc: 0.8124
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.5606
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.5404
 Best site-MNIST-M                   | Epoch:34 | Val Acc: 0.3580
 Best site-MNIST-M                   | Epoch:34 | Val Acc: 0.4015
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.3584
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 35 ============
 Site-MNIST                    | Train Loss: 0.9278 | Train Acc: 0.8293
 Site-MNIST                    | Train Loss: 1.0434 | Train Acc: 0.7855
 Site-MNIST                    | Train Loss: 0.9802 | Train Acc: 0.8000
 Site-MNIST                    | Train Loss: 0.9959 | Train Acc: 0.8068
 Site-MNIST                    | Train Loss: 0.9961 | Train Acc: 0.7938
 Site-USPS                     | Train Loss: 0.9348 | Train Acc: 0.8106
 Site-USPS                     | Train Loss: 0.8906 | Train Acc: 0.8139
 Site-USPS                     | Train Loss: 0.9080 | Train Acc: 0.8131
 Site-SynthDigits              | Train Loss: 1.6177 | Train Acc: 0.5213
 Site-SynthDigits              | Train Loss: 1.5861 | Train Acc: 0.5492
 Site-MNIST-M                  | Train Loss: 1.9196 | Train Acc: 0.4034
 Site-MNIST-M                  | Train Loss: 1.9125 | Train Acc: 0.3945
 Site-SVHN                     | Train Loss: 2.0078 | Train Acc: 0.3143
 Site-MNIST                         | Val  Loss: 1.0399 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.0362 | Val  Acc: 0.7337
 Site-MNIST                         | Val  Loss: 0.9789 | Val  Acc: 0.7866
 Site-MNIST                         | Val  Loss: 1.0238 | Val  Acc: 0.7842
 Site-MNIST                         | Val  Loss: 1.0453 | Val  Acc: 0.7860
 Site-USPS                          | Val  Loss: 0.8678 | Val  Acc: 0.7885
 Site-USPS                          | Val  Loss: 0.9320 | Val  Acc: 0.7692
 Site-USPS                          | Val  Loss: 0.9249 | Val  Acc: 0.8102
 Site-SynthDigits                   | Val  Loss: 1.5973 | Val  Acc: 0.5758
 Site-SynthDigits                   | Val  Loss: 1.5971 | Val  Acc: 0.5429
 Site-MNIST-M                       | Val  Loss: 1.9850 | Val  Acc: 0.3693
 Site-MNIST-M                       | Val  Loss: 1.9443 | Val  Acc: 0.4091
 Site-SVHN                          | Val  Loss: 1.9854 | Val  Acc: 0.3515
Average Valid Accuracy: 0.6547
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.7337
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.7866
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.7842
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.7860
 Best site-USPS                      | Epoch:35 | Val Acc: 0.7885
 Best site-USPS                      | Epoch:35 | Val Acc: 0.7692
 Best site-USPS                      | Epoch:35 | Val Acc: 0.8102
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.5758
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.5429
 Best site-MNIST-M                   | Epoch:35 | Val Acc: 0.3693
 Best site-MNIST-M                   | Epoch:35 | Val Acc: 0.4091
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.3515
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 36 ============
 Site-MNIST                    | Train Loss: 0.9392 | Train Acc: 0.8293
 Site-MNIST                    | Train Loss: 1.0528 | Train Acc: 0.7899
 Site-MNIST                    | Train Loss: 0.9685 | Train Acc: 0.8010
 Site-MNIST                    | Train Loss: 0.9865 | Train Acc: 0.8022
 Site-MNIST                    | Train Loss: 0.9842 | Train Acc: 0.7929
 Site-USPS                     | Train Loss: 0.9077 | Train Acc: 0.8058
 Site-USPS                     | Train Loss: 0.9067 | Train Acc: 0.8091
 Site-USPS                     | Train Loss: 0.8984 | Train Acc: 0.8088
 Site-SynthDigits              | Train Loss: 1.6177 | Train Acc: 0.5147
 Site-SynthDigits              | Train Loss: 1.5797 | Train Acc: 0.5460
 Site-MNIST-M                  | Train Loss: 1.9098 | Train Acc: 0.4091
 Site-MNIST-M                  | Train Loss: 1.9074 | Train Acc: 0.4087
 Site-SVHN                     | Train Loss: 2.0037 | Train Acc: 0.3075
 Site-MNIST                         | Val  Loss: 1.0288 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.0253 | Val  Acc: 0.7337
 Site-MNIST                         | Val  Loss: 0.9673 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 1.0126 | Val  Acc: 0.7816
 Site-MNIST                         | Val  Loss: 1.0340 | Val  Acc: 0.7895
 Site-USPS                          | Val  Loss: 0.8558 | Val  Acc: 0.7837
 Site-USPS                          | Val  Loss: 0.9242 | Val  Acc: 0.7692
 Site-USPS                          | Val  Loss: 0.9142 | Val  Acc: 0.8145
 Site-SynthDigits                   | Val  Loss: 1.5876 | Val  Acc: 0.5568
 Site-SynthDigits                   | Val  Loss: 1.5898 | Val  Acc: 0.5328
 Site-MNIST-M                       | Val  Loss: 1.9768 | Val  Acc: 0.3693
 Site-MNIST-M                       | Val  Loss: 1.9382 | Val  Acc: 0.4167
 Site-SVHN                          | Val  Loss: 1.9798 | Val  Acc: 0.3481
Average Valid Accuracy: 0.6525
============ Train epoch 37 ============
 Site-MNIST                    | Train Loss: 0.9200 | Train Acc: 0.8271
 Site-MNIST                    | Train Loss: 1.0413 | Train Acc: 0.7840
 Site-MNIST                    | Train Loss: 0.9682 | Train Acc: 0.7980
 Site-MNIST                    | Train Loss: 0.9859 | Train Acc: 0.7976
 Site-MNIST                    | Train Loss: 0.9844 | Train Acc: 0.7912
 Site-USPS                     | Train Loss: 0.9211 | Train Acc: 0.8070
 Site-USPS                     | Train Loss: 0.8744 | Train Acc: 0.8155
 Site-USPS                     | Train Loss: 0.8941 | Train Acc: 0.8083
 Site-SynthDigits              | Train Loss: 1.5751 | Train Acc: 0.5364
 Site-SynthDigits              | Train Loss: 1.5455 | Train Acc: 0.5549
 Site-MNIST-M                  | Train Loss: 1.9150 | Train Acc: 0.3935
 Site-MNIST-M                  | Train Loss: 1.9122 | Train Acc: 0.3926
 Site-SVHN                     | Train Loss: 1.9866 | Train Acc: 0.3296
 Site-MNIST                         | Val  Loss: 1.0266 | Val  Acc: 0.8125
 Site-MNIST                         | Val  Loss: 1.0264 | Val  Acc: 0.7337
 Site-MNIST                         | Val  Loss: 0.9693 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 1.0107 | Val  Acc: 0.7895
 Site-MNIST                         | Val  Loss: 1.0335 | Val  Acc: 0.7825
 Site-USPS                          | Val  Loss: 0.8532 | Val  Acc: 0.7933
 Site-USPS                          | Val  Loss: 0.9183 | Val  Acc: 0.7821
 Site-USPS                          | Val  Loss: 0.9089 | Val  Acc: 0.8102
 Site-SynthDigits                   | Val  Loss: 1.5638 | Val  Acc: 0.5833
 Site-SynthDigits                   | Val  Loss: 1.5597 | Val  Acc: 0.5682
 Site-MNIST-M                       | Val  Loss: 1.9838 | Val  Acc: 0.3523
 Site-MNIST-M                       | Val  Loss: 1.9350 | Val  Acc: 0.4015
 Site-SVHN                          | Val  Loss: 1.9635 | Val  Acc: 0.3549
Average Valid Accuracy: 0.6574
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8125
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.7337
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.7826
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.7895
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.7825
 Best site-USPS                      | Epoch:37 | Val Acc: 0.7933
 Best site-USPS                      | Epoch:37 | Val Acc: 0.7821
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8102
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.5833
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.5682
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.3523
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.4015
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.3549
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 38 ============
 Site-MNIST                    | Train Loss: 0.8823 | Train Acc: 0.8271
 Site-MNIST                    | Train Loss: 1.0289 | Train Acc: 0.7899
 Site-MNIST                    | Train Loss: 0.9540 | Train Acc: 0.8000
 Site-MNIST                    | Train Loss: 0.9685 | Train Acc: 0.8075
 Site-MNIST                    | Train Loss: 0.9685 | Train Acc: 0.7955
 Site-USPS                     | Train Loss: 0.9118 | Train Acc: 0.8129
 Site-USPS                     | Train Loss: 0.8625 | Train Acc: 0.8155
 Site-USPS                     | Train Loss: 0.8756 | Train Acc: 0.8168
 Site-SynthDigits              | Train Loss: 1.5949 | Train Acc: 0.5289
 Site-SynthDigits              | Train Loss: 1.5486 | Train Acc: 0.5485
 Site-MNIST-M                  | Train Loss: 1.9004 | Train Acc: 0.4091
 Site-MNIST-M                  | Train Loss: 1.9027 | Train Acc: 0.4011
 Site-SVHN                     | Train Loss: 1.9896 | Train Acc: 0.3194
 Site-MNIST                         | Val  Loss: 1.0113 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.0088 | Val  Acc: 0.7396
 Site-MNIST                         | Val  Loss: 0.9519 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 0.9946 | Val  Acc: 0.7816
 Site-MNIST                         | Val  Loss: 1.0166 | Val  Acc: 0.7877
 Site-USPS                          | Val  Loss: 0.8344 | Val  Acc: 0.7837
 Site-USPS                          | Val  Loss: 0.9006 | Val  Acc: 0.7724
 Site-USPS                          | Val  Loss: 0.8908 | Val  Acc: 0.8188
 Site-SynthDigits                   | Val  Loss: 1.5598 | Val  Acc: 0.5833
 Site-SynthDigits                   | Val  Loss: 1.5602 | Val  Acc: 0.5530
 Site-MNIST-M                       | Val  Loss: 1.9704 | Val  Acc: 0.3807
 Site-MNIST-M                       | Val  Loss: 1.9266 | Val  Acc: 0.4129
 Site-SVHN                          | Val  Loss: 1.9636 | Val  Acc: 0.3549
Average Valid Accuracy: 0.6581
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.7396
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.7826
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.7816
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.7877
 Best site-USPS                      | Epoch:38 | Val Acc: 0.7837
 Best site-USPS                      | Epoch:38 | Val Acc: 0.7724
 Best site-USPS                      | Epoch:38 | Val Acc: 0.8188
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.5833
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.5530
 Best site-MNIST-M                   | Epoch:38 | Val Acc: 0.3807
 Best site-MNIST-M                   | Epoch:38 | Val Acc: 0.4129
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.3549
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 39 ============
 Site-MNIST                    | Train Loss: 0.9424 | Train Acc: 0.8204
 Site-MNIST                    | Train Loss: 1.0275 | Train Acc: 0.7722
 Site-MNIST                    | Train Loss: 0.9711 | Train Acc: 0.7862
 Site-MNIST                    | Train Loss: 0.9871 | Train Acc: 0.7878
 Site-MNIST                    | Train Loss: 0.9857 | Train Acc: 0.7855
 Site-USPS                     | Train Loss: 0.9346 | Train Acc: 0.7950
 Site-USPS                     | Train Loss: 0.9058 | Train Acc: 0.8131
 Site-USPS                     | Train Loss: 0.9055 | Train Acc: 0.8003
 Site-SynthDigits              | Train Loss: 1.5255 | Train Acc: 0.5591
 Site-SynthDigits              | Train Loss: 1.4980 | Train Acc: 0.5769
 Site-MNIST-M                  | Train Loss: 1.9235 | Train Acc: 0.4020
 Site-MNIST-M                  | Train Loss: 1.9226 | Train Acc: 0.3784
 Site-SVHN                     | Train Loss: 1.9690 | Train Acc: 0.3399
 Site-MNIST                         | Val  Loss: 1.0255 | Val  Acc: 0.7946
 Site-MNIST                         | Val  Loss: 1.0327 | Val  Acc: 0.7219
 Site-MNIST                         | Val  Loss: 0.9747 | Val  Acc: 0.7905
 Site-MNIST                         | Val  Loss: 1.0118 | Val  Acc: 0.7868
 Site-MNIST                         | Val  Loss: 1.0380 | Val  Acc: 0.7684
 Site-USPS                          | Val  Loss: 0.8695 | Val  Acc: 0.8029
 Site-USPS                          | Val  Loss: 0.9271 | Val  Acc: 0.7821
 Site-USPS                          | Val  Loss: 0.9216 | Val  Acc: 0.7974
 Site-SynthDigits                   | Val  Loss: 1.5335 | Val  Acc: 0.6023
 Site-SynthDigits                   | Val  Loss: 1.5179 | Val  Acc: 0.5884
 Site-MNIST-M                       | Val  Loss: 1.9882 | Val  Acc: 0.3636
 Site-MNIST-M                       | Val  Loss: 1.9342 | Val  Acc: 0.4091
 Site-SVHN                          | Val  Loss: 1.9514 | Val  Acc: 0.3686
Average Valid Accuracy: 0.6597
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.7946
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.7219
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.7905
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.7868
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.7684
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8029
 Best site-USPS                      | Epoch:39 | Val Acc: 0.7821
 Best site-USPS                      | Epoch:39 | Val Acc: 0.7974
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.6023
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.5884
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.3636
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.4091
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.3686
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
 Test site-MNIST                     | Epoch:39 | Test Acc: 0.7849
 Test site-USPS                      | Epoch:39 | Test Acc: 0.8011
 Test site-SynthDigits               | Epoch:39 | Test Acc: 0.5624
 Test site-MNIST-M                   | Epoch:39 | Test Acc: 0.3728
 Test site-SVHN                      | Epoch:39 | Test Acc: 0.3098
MNIST: 0.785, USPS: 0.801, SynthDigits: 0.562, MNIST-M: 0.373, SVHN: 0.310, 
Average Test Accuracy: 0.5662, domain std=0.2030, cluster std=-1.0000, individual std=0.1848, 
============ Train epoch 40 ============
 Site-MNIST                    | Train Loss: 0.9505 | Train Acc: 0.8271
 Site-MNIST                    | Train Loss: 1.0001 | Train Acc: 0.7929
 Site-MNIST                    | Train Loss: 0.9319 | Train Acc: 0.7980
 Site-MNIST                    | Train Loss: 0.9467 | Train Acc: 0.8055
 Site-MNIST                    | Train Loss: 0.9451 | Train Acc: 0.7968
 Site-USPS                     | Train Loss: 0.9250 | Train Acc: 0.7998
 Site-USPS                     | Train Loss: 0.8770 | Train Acc: 0.8091
 Site-USPS                     | Train Loss: 0.8720 | Train Acc: 0.8078
 Site-SynthDigits              | Train Loss: 1.5475 | Train Acc: 0.5364
 Site-SynthDigits              | Train Loss: 1.5287 | Train Acc: 0.5586
 Site-MNIST-M                  | Train Loss: 1.8873 | Train Acc: 0.4105
 Site-MNIST-M                  | Train Loss: 1.8914 | Train Acc: 0.4011
 Site-SVHN                     | Train Loss: 1.9785 | Train Acc: 0.3271
 Site-MNIST                         | Val  Loss: 0.9849 | Val  Acc: 0.8125
 Site-MNIST                         | Val  Loss: 0.9901 | Val  Acc: 0.7278
 Site-MNIST                         | Val  Loss: 0.9342 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 0.9736 | Val  Acc: 0.7816
 Site-MNIST                         | Val  Loss: 0.9957 | Val  Acc: 0.7930
 Site-USPS                          | Val  Loss: 0.8306 | Val  Acc: 0.7837
 Site-USPS                          | Val  Loss: 0.8983 | Val  Acc: 0.7724
 Site-USPS                          | Val  Loss: 0.8865 | Val  Acc: 0.8081
 Site-SynthDigits                   | Val  Loss: 1.5371 | Val  Acc: 0.5833
 Site-SynthDigits                   | Val  Loss: 1.5376 | Val  Acc: 0.5631
 Site-MNIST-M                       | Val  Loss: 1.9605 | Val  Acc: 0.3864
 Site-MNIST-M                       | Val  Loss: 1.9125 | Val  Acc: 0.4129
 Site-SVHN                          | Val  Loss: 1.9531 | Val  Acc: 0.3686
Average Valid Accuracy: 0.6597
============ Train epoch 41 ============
 Site-MNIST                    | Train Loss: 0.9141 | Train Acc: 0.8315
 Site-MNIST                    | Train Loss: 0.9872 | Train Acc: 0.7870
 Site-MNIST                    | Train Loss: 0.9323 | Train Acc: 0.7961
 Site-MNIST                    | Train Loss: 0.9483 | Train Acc: 0.8003
 Site-MNIST                    | Train Loss: 0.9457 | Train Acc: 0.7960
 Site-USPS                     | Train Loss: 0.9063 | Train Acc: 0.8022
 Site-USPS                     | Train Loss: 0.8537 | Train Acc: 0.8155
 Site-USPS                     | Train Loss: 0.8682 | Train Acc: 0.8115
 Site-SynthDigits              | Train Loss: 1.5200 | Train Acc: 0.5430
 Site-SynthDigits              | Train Loss: 1.5039 | Train Acc: 0.5681
 Site-MNIST-M                  | Train Loss: 1.8886 | Train Acc: 0.4105
 Site-MNIST-M                  | Train Loss: 1.8783 | Train Acc: 0.4002
 Site-SVHN                     | Train Loss: 1.9692 | Train Acc: 0.3339
 Site-MNIST                         | Val  Loss: 0.9834 | Val  Acc: 0.8125
 Site-MNIST                         | Val  Loss: 0.9904 | Val  Acc: 0.7337
 Site-MNIST                         | Val  Loss: 0.9345 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 0.9719 | Val  Acc: 0.7842
 Site-MNIST                         | Val  Loss: 0.9955 | Val  Acc: 0.7842
 Site-USPS                          | Val  Loss: 0.8276 | Val  Acc: 0.7885
 Site-USPS                          | Val  Loss: 0.8933 | Val  Acc: 0.7788
 Site-USPS                          | Val  Loss: 0.8826 | Val  Acc: 0.8038
 Site-SynthDigits                   | Val  Loss: 1.5216 | Val  Acc: 0.5909
 Site-SynthDigits                   | Val  Loss: 1.5189 | Val  Acc: 0.5707
 Site-MNIST-M                       | Val  Loss: 1.9630 | Val  Acc: 0.3920
 Site-MNIST-M                       | Val  Loss: 1.9096 | Val  Acc: 0.4205
 Site-SVHN                          | Val  Loss: 1.9426 | Val  Acc: 0.3618
Average Valid Accuracy: 0.6619
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.8125
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.7337
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.7826
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.7842
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.7842
 Best site-USPS                      | Epoch:41 | Val Acc: 0.7885
 Best site-USPS                      | Epoch:41 | Val Acc: 0.7788
 Best site-USPS                      | Epoch:41 | Val Acc: 0.8038
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.5909
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.5707
 Best site-MNIST-M                   | Epoch:41 | Val Acc: 0.3920
 Best site-MNIST-M                   | Epoch:41 | Val Acc: 0.4205
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.3618
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 42 ============
 Site-MNIST                    | Train Loss: 0.8920 | Train Acc: 0.8293
 Site-MNIST                    | Train Loss: 0.9968 | Train Acc: 0.7840
 Site-MNIST                    | Train Loss: 0.9278 | Train Acc: 0.7980
 Site-MNIST                    | Train Loss: 0.9439 | Train Acc: 0.7976
 Site-MNIST                    | Train Loss: 0.9403 | Train Acc: 0.7973
 Site-USPS                     | Train Loss: 0.8892 | Train Acc: 0.8082
 Site-USPS                     | Train Loss: 0.8384 | Train Acc: 0.8171
 Site-USPS                     | Train Loss: 0.8606 | Train Acc: 0.8083
 Site-SynthDigits              | Train Loss: 1.5721 | Train Acc: 0.5487
 Site-SynthDigits              | Train Loss: 1.4953 | Train Acc: 0.5731
 Site-MNIST-M                  | Train Loss: 1.8854 | Train Acc: 0.4119
 Site-MNIST-M                  | Train Loss: 1.8959 | Train Acc: 0.3983
 Site-SVHN                     | Train Loss: 1.9639 | Train Acc: 0.3365
 Site-MNIST                         | Val  Loss: 0.9761 | Val  Acc: 0.8125
 Site-MNIST                         | Val  Loss: 0.9840 | Val  Acc: 0.7456
 Site-MNIST                         | Val  Loss: 0.9299 | Val  Acc: 0.7866
 Site-MNIST                         | Val  Loss: 0.9661 | Val  Acc: 0.7842
 Site-MNIST                         | Val  Loss: 0.9911 | Val  Acc: 0.7825
 Site-USPS                          | Val  Loss: 0.8201 | Val  Acc: 0.7933
 Site-USPS                          | Val  Loss: 0.8828 | Val  Acc: 0.7756
 Site-USPS                          | Val  Loss: 0.8731 | Val  Acc: 0.8060
 Site-SynthDigits                   | Val  Loss: 1.5127 | Val  Acc: 0.5985
 Site-SynthDigits                   | Val  Loss: 1.5102 | Val  Acc: 0.5833
 Site-MNIST-M                       | Val  Loss: 1.9592 | Val  Acc: 0.3920
 Site-MNIST-M                       | Val  Loss: 1.9059 | Val  Acc: 0.4167
 Site-SVHN                          | Val  Loss: 1.9384 | Val  Acc: 0.3686
Average Valid Accuracy: 0.6650
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8125
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.7456
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.7866
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.7842
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.7825
 Best site-USPS                      | Epoch:42 | Val Acc: 0.7933
 Best site-USPS                      | Epoch:42 | Val Acc: 0.7756
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8060
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.5985
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.5833
 Best site-MNIST-M                   | Epoch:42 | Val Acc: 0.3920
 Best site-MNIST-M                   | Epoch:42 | Val Acc: 0.4167
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.3686
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 43 ============
 Site-MNIST                    | Train Loss: 0.8771 | Train Acc: 0.8404
 Site-MNIST                    | Train Loss: 0.9628 | Train Acc: 0.7988
 Site-MNIST                    | Train Loss: 0.8949 | Train Acc: 0.8138
 Site-MNIST                    | Train Loss: 0.9143 | Train Acc: 0.8154
 Site-MNIST                    | Train Loss: 0.9102 | Train Acc: 0.8074
 Site-USPS                     | Train Loss: 0.8700 | Train Acc: 0.8058
 Site-USPS                     | Train Loss: 0.8301 | Train Acc: 0.8139
 Site-USPS                     | Train Loss: 0.8464 | Train Acc: 0.8131
 Site-SynthDigits              | Train Loss: 1.5706 | Train Acc: 0.5364
 Site-SynthDigits              | Train Loss: 1.5117 | Train Acc: 0.5649
 Site-MNIST-M                  | Train Loss: 1.8607 | Train Acc: 0.4403
 Site-MNIST-M                  | Train Loss: 1.8645 | Train Acc: 0.4295
 Site-SVHN                     | Train Loss: 1.9749 | Train Acc: 0.3211
 Site-MNIST                         | Val  Loss: 0.9469 | Val  Acc: 0.8125
 Site-MNIST                         | Val  Loss: 0.9517 | Val  Acc: 0.7633
 Site-MNIST                         | Val  Loss: 0.8952 | Val  Acc: 0.7984
 Site-MNIST                         | Val  Loss: 0.9358 | Val  Acc: 0.7921
 Site-MNIST                         | Val  Loss: 0.9565 | Val  Acc: 0.7965
 Site-USPS                          | Val  Loss: 0.8070 | Val  Acc: 0.7885
 Site-USPS                          | Val  Loss: 0.8736 | Val  Acc: 0.7821
 Site-USPS                          | Val  Loss: 0.8607 | Val  Acc: 0.8166
 Site-SynthDigits                   | Val  Loss: 1.5174 | Val  Acc: 0.5833
 Site-SynthDigits                   | Val  Loss: 1.5181 | Val  Acc: 0.5556
 Site-MNIST-M                       | Val  Loss: 1.9351 | Val  Acc: 0.4148
 Site-MNIST-M                       | Val  Loss: 1.8912 | Val  Acc: 0.4432
 Site-SVHN                          | Val  Loss: 1.9460 | Val  Acc: 0.3549
Average Valid Accuracy: 0.6694
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8125
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.7633
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.7984
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.7921
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.7965
 Best site-USPS                      | Epoch:43 | Val Acc: 0.7885
 Best site-USPS                      | Epoch:43 | Val Acc: 0.7821
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8166
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.5833
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.5556
 Best site-MNIST-M                   | Epoch:43 | Val Acc: 0.4148
 Best site-MNIST-M                   | Epoch:43 | Val Acc: 0.4432
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.3549
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 44 ============
 Site-MNIST                    | Train Loss: 0.8530 | Train Acc: 0.8293
 Site-MNIST                    | Train Loss: 0.9672 | Train Acc: 0.7899
 Site-MNIST                    | Train Loss: 0.9138 | Train Acc: 0.7951
 Site-MNIST                    | Train Loss: 0.9301 | Train Acc: 0.7970
 Site-MNIST                    | Train Loss: 0.9275 | Train Acc: 0.7951
 Site-USPS                     | Train Loss: 0.8850 | Train Acc: 0.7986
 Site-USPS                     | Train Loss: 0.8585 | Train Acc: 0.8123
 Site-USPS                     | Train Loss: 0.8681 | Train Acc: 0.8019
 Site-SynthDigits              | Train Loss: 1.4931 | Train Acc: 0.5544
 Site-SynthDigits              | Train Loss: 1.4657 | Train Acc: 0.5889
 Site-MNIST-M                  | Train Loss: 1.8794 | Train Acc: 0.4233
 Site-MNIST-M                  | Train Loss: 1.8841 | Train Acc: 0.3926
 Site-SVHN                     | Train Loss: 1.9489 | Train Acc: 0.3441
 Site-MNIST                         | Val  Loss: 0.9614 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 0.9726 | Val  Acc: 0.7456
 Site-MNIST                         | Val  Loss: 0.9165 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 0.9513 | Val  Acc: 0.7921
 Site-MNIST                         | Val  Loss: 0.9772 | Val  Acc: 0.7895
 Site-USPS                          | Val  Loss: 0.8299 | Val  Acc: 0.7788
 Site-USPS                          | Val  Loss: 0.8916 | Val  Acc: 0.7724
 Site-USPS                          | Val  Loss: 0.8805 | Val  Acc: 0.7974
 Site-SynthDigits                   | Val  Loss: 1.4883 | Val  Acc: 0.5909
 Site-SynthDigits                   | Val  Loss: 1.4804 | Val  Acc: 0.5859
 Site-MNIST-M                       | Val  Loss: 1.9556 | Val  Acc: 0.4091
 Site-MNIST-M                       | Val  Loss: 1.8983 | Val  Acc: 0.4280
 Site-SVHN                          | Val  Loss: 1.9257 | Val  Acc: 0.3652
Average Valid Accuracy: 0.6647
============ Train epoch 45 ============
 Site-MNIST                    | Train Loss: 0.8486 | Train Acc: 0.8293
 Site-MNIST                    | Train Loss: 0.9859 | Train Acc: 0.7929
 Site-MNIST                    | Train Loss: 0.9028 | Train Acc: 0.7941
 Site-MNIST                    | Train Loss: 0.9210 | Train Acc: 0.7989
 Site-MNIST                    | Train Loss: 0.9185 | Train Acc: 0.7973
 Site-USPS                     | Train Loss: 0.9264 | Train Acc: 0.8082
 Site-USPS                     | Train Loss: 0.8449 | Train Acc: 0.8163
 Site-USPS                     | Train Loss: 0.8570 | Train Acc: 0.8062
 Site-SynthDigits              | Train Loss: 1.5001 | Train Acc: 0.5506
 Site-SynthDigits              | Train Loss: 1.4591 | Train Acc: 0.5826
 Site-MNIST-M                  | Train Loss: 1.8676 | Train Acc: 0.4247
 Site-MNIST-M                  | Train Loss: 1.8353 | Train Acc: 0.4011
 Site-SVHN                     | Train Loss: 1.9440 | Train Acc: 0.3441
 Site-MNIST                         | Val  Loss: 0.9498 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 0.9606 | Val  Acc: 0.7456
 Site-MNIST                         | Val  Loss: 0.9042 | Val  Acc: 0.7787
 Site-MNIST                         | Val  Loss: 0.9386 | Val  Acc: 0.7842
 Site-MNIST                         | Val  Loss: 0.9644 | Val  Acc: 0.7895
 Site-USPS                          | Val  Loss: 0.8183 | Val  Acc: 0.7837
 Site-USPS                          | Val  Loss: 0.8786 | Val  Acc: 0.7724
 Site-USPS                          | Val  Loss: 0.8688 | Val  Acc: 0.7953
 Site-SynthDigits                   | Val  Loss: 1.4804 | Val  Acc: 0.5985
 Site-SynthDigits                   | Val  Loss: 1.4749 | Val  Acc: 0.5833
 Site-MNIST-M                       | Val  Loss: 1.9464 | Val  Acc: 0.4148
 Site-MNIST-M                       | Val  Loss: 1.8905 | Val  Acc: 0.4356
 Site-SVHN                          | Val  Loss: 1.9193 | Val  Acc: 0.3788
Average Valid Accuracy: 0.6665
============ Train epoch 46 ============
 Site-MNIST                    | Train Loss: 0.8334 | Train Acc: 0.8315
 Site-MNIST                    | Train Loss: 0.9560 | Train Acc: 0.8047
 Site-MNIST                    | Train Loss: 0.8777 | Train Acc: 0.8118
 Site-MNIST                    | Train Loss: 0.8950 | Train Acc: 0.8055
 Site-MNIST                    | Train Loss: 0.8922 | Train Acc: 0.8060
 Site-USPS                     | Train Loss: 0.8577 | Train Acc: 0.7986
 Site-USPS                     | Train Loss: 0.8228 | Train Acc: 0.8115
 Site-USPS                     | Train Loss: 0.8391 | Train Acc: 0.8078
 Site-SynthDigits              | Train Loss: 1.5163 | Train Acc: 0.5364
 Site-SynthDigits              | Train Loss: 1.4827 | Train Acc: 0.5719
 Site-MNIST-M                  | Train Loss: 1.8453 | Train Acc: 0.4318
 Site-MNIST-M                  | Train Loss: 1.8469 | Train Acc: 0.4286
 Site-SVHN                     | Train Loss: 1.9572 | Train Acc: 0.3262
 Site-MNIST                         | Val  Loss: 0.9277 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.9339 | Val  Acc: 0.7574
 Site-MNIST                         | Val  Loss: 0.8773 | Val  Acc: 0.7945
 Site-MNIST                         | Val  Loss: 0.9153 | Val  Acc: 0.7947
 Site-MNIST                         | Val  Loss: 0.9382 | Val  Acc: 0.8053
 Site-USPS                          | Val  Loss: 0.8027 | Val  Acc: 0.7740
 Site-USPS                          | Val  Loss: 0.8683 | Val  Acc: 0.7564
 Site-USPS                          | Val  Loss: 0.8528 | Val  Acc: 0.8017
 Site-SynthDigits                   | Val  Loss: 1.4882 | Val  Acc: 0.5909
 Site-SynthDigits                   | Val  Loss: 1.4934 | Val  Acc: 0.5530
 Site-MNIST-M                       | Val  Loss: 1.9257 | Val  Acc: 0.4205
 Site-MNIST-M                       | Val  Loss: 1.8804 | Val  Acc: 0.4242
 Site-SVHN                          | Val  Loss: 1.9253 | Val  Acc: 0.3618
Average Valid Accuracy: 0.6658
============ Train epoch 47 ============
 Site-MNIST                    | Train Loss: 0.8440 | Train Acc: 0.8271
 Site-MNIST                    | Train Loss: 0.9394 | Train Acc: 0.7959
 Site-MNIST                    | Train Loss: 0.8776 | Train Acc: 0.8059
 Site-MNIST                    | Train Loss: 0.8922 | Train Acc: 0.8055
 Site-MNIST                    | Train Loss: 0.8927 | Train Acc: 0.8021
 Site-USPS                     | Train Loss: 0.8786 | Train Acc: 0.8046
 Site-USPS                     | Train Loss: 0.8389 | Train Acc: 0.8123
 Site-USPS                     | Train Loss: 0.8454 | Train Acc: 0.8046
 Site-SynthDigits              | Train Loss: 1.5074 | Train Acc: 0.5478
 Site-SynthDigits              | Train Loss: 1.4654 | Train Acc: 0.5769
 Site-MNIST-M                  | Train Loss: 1.8446 | Train Acc: 0.4375
 Site-MNIST-M                  | Train Loss: 1.8398 | Train Acc: 0.4257
 Site-SVHN                     | Train Loss: 1.9482 | Train Acc: 0.3322
 Site-MNIST                         | Val  Loss: 0.9265 | Val  Acc: 0.8125
 Site-MNIST                         | Val  Loss: 0.9340 | Val  Acc: 0.7574
 Site-MNIST                         | Val  Loss: 0.8786 | Val  Acc: 0.7866
 Site-MNIST                         | Val  Loss: 0.9141 | Val  Acc: 0.7921
 Site-MNIST                         | Val  Loss: 0.9369 | Val  Acc: 0.7947
 Site-USPS                          | Val  Loss: 0.8079 | Val  Acc: 0.7885
 Site-USPS                          | Val  Loss: 0.8720 | Val  Acc: 0.7788
 Site-USPS                          | Val  Loss: 0.8588 | Val  Acc: 0.8102
 Site-SynthDigits                   | Val  Loss: 1.4757 | Val  Acc: 0.5909
 Site-SynthDigits                   | Val  Loss: 1.4750 | Val  Acc: 0.5758
 Site-MNIST-M                       | Val  Loss: 1.9234 | Val  Acc: 0.4318
 Site-MNIST-M                       | Val  Loss: 1.8819 | Val  Acc: 0.4394
 Site-SVHN                          | Val  Loss: 1.9192 | Val  Acc: 0.3652
Average Valid Accuracy: 0.6711
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.8125
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.7574
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.7866
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.7921
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.7947
 Best site-USPS                      | Epoch:47 | Val Acc: 0.7885
 Best site-USPS                      | Epoch:47 | Val Acc: 0.7788
 Best site-USPS                      | Epoch:47 | Val Acc: 0.8102
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5909
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5758
 Best site-MNIST-M                   | Epoch:47 | Val Acc: 0.4318
 Best site-MNIST-M                   | Epoch:47 | Val Acc: 0.4394
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.3652
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
============ Train epoch 48 ============
 Site-MNIST                    | Train Loss: 0.8244 | Train Acc: 0.8293
 Site-MNIST                    | Train Loss: 0.9259 | Train Acc: 0.8018
 Site-MNIST                    | Train Loss: 0.8677 | Train Acc: 0.8059
 Site-MNIST                    | Train Loss: 0.8845 | Train Acc: 0.8042
 Site-MNIST                    | Train Loss: 0.8831 | Train Acc: 0.8021
 Site-USPS                     | Train Loss: 0.8392 | Train Acc: 0.8141
 Site-USPS                     | Train Loss: 0.8175 | Train Acc: 0.8211
 Site-USPS                     | Train Loss: 0.8306 | Train Acc: 0.8088
 Site-SynthDigits              | Train Loss: 1.5345 | Train Acc: 0.5449
 Site-SynthDigits              | Train Loss: 1.4529 | Train Acc: 0.5788
 Site-MNIST-M                  | Train Loss: 1.8376 | Train Acc: 0.4403
 Site-MNIST-M                  | Train Loss: 1.8518 | Train Acc: 0.4153
 Site-SVHN                     | Train Loss: 1.9392 | Train Acc: 0.3390
 Site-MNIST                         | Val  Loss: 0.9177 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 0.9267 | Val  Acc: 0.7574
 Site-MNIST                         | Val  Loss: 0.8697 | Val  Acc: 0.7866
 Site-MNIST                         | Val  Loss: 0.9030 | Val  Acc: 0.7921
 Site-MNIST                         | Val  Loss: 0.9271 | Val  Acc: 0.8000
 Site-USPS                          | Val  Loss: 0.7916 | Val  Acc: 0.7933
 Site-USPS                          | Val  Loss: 0.8545 | Val  Acc: 0.7821
 Site-USPS                          | Val  Loss: 0.8419 | Val  Acc: 0.8124
 Site-SynthDigits                   | Val  Loss: 1.4640 | Val  Acc: 0.5795
 Site-SynthDigits                   | Val  Loss: 1.4623 | Val  Acc: 0.5707
 Site-MNIST-M                       | Val  Loss: 1.9195 | Val  Acc: 0.4205
 Site-MNIST-M                       | Val  Loss: 1.8702 | Val  Acc: 0.4432
 Site-SVHN                          | Val  Loss: 1.9095 | Val  Acc: 0.3754
Average Valid Accuracy: 0.6705
============ Train epoch 49 ============
 Site-MNIST                    | Train Loss: 0.8036 | Train Acc: 0.8381
 Site-MNIST                    | Train Loss: 0.8919 | Train Acc: 0.8062
 Site-MNIST                    | Train Loss: 0.8521 | Train Acc: 0.8158
 Site-MNIST                    | Train Loss: 0.8692 | Train Acc: 0.8121
 Site-MNIST                    | Train Loss: 0.8687 | Train Acc: 0.8109
 Site-USPS                     | Train Loss: 0.8231 | Train Acc: 0.8153
 Site-USPS                     | Train Loss: 0.7898 | Train Acc: 0.8235
 Site-USPS                     | Train Loss: 0.8087 | Train Acc: 0.8152
 Site-SynthDigits              | Train Loss: 1.4921 | Train Acc: 0.5402
 Site-SynthDigits              | Train Loss: 1.4566 | Train Acc: 0.5757
 Site-MNIST-M                  | Train Loss: 1.8303 | Train Acc: 0.4418
 Site-MNIST-M                  | Train Loss: 1.8190 | Train Acc: 0.4286
 Site-SVHN                     | Train Loss: 1.9429 | Train Acc: 0.3330
 Site-MNIST                         | Val  Loss: 0.9041 | Val  Acc: 0.8125
 Site-MNIST                         | Val  Loss: 0.9124 | Val  Acc: 0.7633
 Site-MNIST                         | Val  Loss: 0.8537 | Val  Acc: 0.8024
 Site-MNIST                         | Val  Loss: 0.8881 | Val  Acc: 0.8026
 Site-MNIST                         | Val  Loss: 0.9113 | Val  Acc: 0.8070
 Site-USPS                          | Val  Loss: 0.7700 | Val  Acc: 0.8029
 Site-USPS                          | Val  Loss: 0.8361 | Val  Acc: 0.7756
 Site-USPS                          | Val  Loss: 0.8224 | Val  Acc: 0.8102
 Site-SynthDigits                   | Val  Loss: 1.4631 | Val  Acc: 0.5833
 Site-SynthDigits                   | Val  Loss: 1.4641 | Val  Acc: 0.5556
 Site-MNIST-M                       | Val  Loss: 1.9130 | Val  Acc: 0.4261
 Site-MNIST-M                       | Val  Loss: 1.8639 | Val  Acc: 0.4432
 Site-SVHN                          | Val  Loss: 1.9099 | Val  Acc: 0.3652
Average Valid Accuracy: 0.6731
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8125
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.7633
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8024
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8026
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8070
 Best site-USPS                      | Epoch:49 | Val Acc: 0.8029
 Best site-USPS                      | Epoch:49 | Val Acc: 0.7756
 Best site-USPS                      | Epoch:49 | Val Acc: 0.8102
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.5833
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.5556
 Best site-MNIST-M                   | Epoch:49 | Val Acc: 0.4261
 Best site-MNIST-M                   | Epoch:49 | Val Acc: 0.4432
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.3652
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/drfl...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.8092
 Test site-USPS                      | Epoch:49 | Test Acc: 0.8124
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.5555
 Test site-MNIST-M                   | Epoch:49 | Test Acc: 0.4101
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.3111
MNIST: 0.809, USPS: 0.812, SynthDigits: 0.556, MNIST-M: 0.410, SVHN: 0.311, 
Average Test Accuracy: 0.5797, domain std=0.2041, cluster std=-1.0000, individual std=0.1856, 
===2023-06-04 18:26:36===
===2023-06-04 18:26:52===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[451,676,1015,1522,2284,834,1252,1878,1057,1586,704,1057,1174,
client_nums=[5,3,2,2,1,]
len_dataset=[7438,4958,3305,2203,1468,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.8092
 Test site-USPS                      | Epoch:49 | Test Acc: 0.8124
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.5555
 Test site-MNIST-M                   | Epoch:49 | Test Acc: 0.4101
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.3111
MNIST: 0.809, USPS: 0.812, SynthDigits: 0.556, MNIST-M: 0.410, SVHN: 0.311, 
Average Test Accuracy: 0.5797, domain std=0.2041, cluster std=-1.0000, individual std=0.1856, 
===2023-06-07 23:54:06===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[451,676,1015,1522,2284,834,1252,1878,1057,1586,704,1057,1174,
client_nums=[5,3,2,2,1,]
len_dataset=[7438,4958,3305,2203,1468,]
domain number = 5
Loading snapshots...
