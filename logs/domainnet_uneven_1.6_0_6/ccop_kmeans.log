===2023-08-17 13:22:34===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 32
    iters: 2
    wk_iters: 1
    domain_num: 6
data_number=[6,11,17,28,45,72,116,186,298,477,18,29,46,74,119,191,306,53,85,136,217,59,95,152,73,118,120,
client_nums=[10,7,4,3,2,1,]
len_dataset=[2103,1314,821,513,320,200,]
domain number = 6
============ Train epoch 0 ============
cnt=[11, 2, 2, 1, 3, 8, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (3) | Train Loss: 1.8940 | Train Acc: 0.6667
 Site-Clipart                   (5) | Train Loss: 2.0272 | Train Acc: 0.3636
 Site-Clipart                   (5) | Train Loss: 1.8789 | Train Acc: 0.5882
 Site-Clipart                   (2) | Train Loss: 1.9707 | Train Acc: 0.3571
 Site-Clipart                   (5) | Train Loss: 2.0124 | Train Acc: 0.3333
 Site-Clipart                   (2) | Train Loss: 1.8659 | Train Acc: 0.4583
 Site-Clipart                   (5) | Train Loss: 1.9374 | Train Acc: 0.4655
 Site-Clipart                   (5) | Train Loss: 2.0206 | Train Acc: 0.3763
 Site-Clipart                   (5) | Train Loss: 1.9857 | Train Acc: 0.3926
 Site-Clipart                   (5) | Train Loss: 1.9774 | Train Acc: 0.3941
 Site-Real                      (0) | Train Loss: 2.0584 | Train Acc: 0.3333
 Site-Real                      (0) | Train Loss: 1.8758 | Train Acc: 0.5862
 Site-Real                      (0) | Train Loss: 1.9631 | Train Acc: 0.5000
 Site-Real                      (0) | Train Loss: 1.9598 | Train Acc: 0.4595
 Site-Real                      (0) | Train Loss: 1.9145 | Train Acc: 0.4706
 Site-Real                      (0) | Train Loss: 1.8970 | Train Acc: 0.5340
 Site-Real                      (0) | Train Loss: 1.9353 | Train Acc: 0.5163
 Site-Painting                  (0) | Train Loss: 2.0534 | Train Acc: 0.3396
 Site-Painting                  (0) | Train Loss: 2.0022 | Train Acc: 0.4588
 Site-Painting                  (0) | Train Loss: 2.0802 | Train Acc: 0.3750
 Site-Painting                  (0) | Train Loss: 1.9501 | Train Acc: 0.4608
 Site-Sketch                    (4) | Train Loss: 1.9565 | Train Acc: 0.4576
 Site-Sketch                    (4) | Train Loss: 2.0420 | Train Acc: 0.3895
 Site-Sketch                    (4) | Train Loss: 2.0445 | Train Acc: 0.3553
 Site-QuickDraw                 (1) | Train Loss: 2.3296 | Train Acc: 0.0822
 Site-QuickDraw                 (1) | Train Loss: 2.3710 | Train Acc: 0.0932
 Site-Infograph                 (5) | Train Loss: 2.2652 | Train Acc: 0.1500
Average Train Accuracy: 0.4059
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3636
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.5882
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3571
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3333
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4583
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4655
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3763
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3926
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3941
 Best site-Real                      | Epoch:0 | Val Acc: 0.3333
 Best site-Real                      | Epoch:0 | Val Acc: 0.5862
 Best site-Real                      | Epoch:0 | Val Acc: 0.5000
 Best site-Real                      | Epoch:0 | Val Acc: 0.4595
 Best site-Real                      | Epoch:0 | Val Acc: 0.4706
 Best site-Real                      | Epoch:0 | Val Acc: 0.5340
 Best site-Real                      | Epoch:0 | Val Acc: 0.5163
 Best site-Painting                  | Epoch:0 | Val Acc: 0.3396
 Best site-Painting                  | Epoch:0 | Val Acc: 0.4588
 Best site-Painting                  | Epoch:0 | Val Acc: 0.3750
 Best site-Painting                  | Epoch:0 | Val Acc: 0.4608
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.4576
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.3895
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.3553
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.0822
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.0932
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.1500
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 1 ============
cnt=[4, 2, 3, 9, 8, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (3) | Train Loss: 1.7335 | Train Acc: 0.5000
 Site-Clipart                   (5) | Train Loss: 1.5518 | Train Acc: 0.7273
 Site-Clipart                   (3) | Train Loss: 1.5328 | Train Acc: 0.7647
 Site-Clipart                   (3) | Train Loss: 1.6536 | Train Acc: 0.5357
 Site-Clipart                   (3) | Train Loss: 1.7659 | Train Acc: 0.6667
 Site-Clipart                   (3) | Train Loss: 1.5757 | Train Acc: 0.6667
 Site-Clipart                   (3) | Train Loss: 1.6016 | Train Acc: 0.6293
 Site-Clipart                   (3) | Train Loss: 1.7149 | Train Acc: 0.6452
 Site-Clipart                   (3) | Train Loss: 1.6235 | Train Acc: 0.6611
 Site-Clipart                   (3) | Train Loss: 1.6281 | Train Acc: 0.6457
 Site-Real                      (4) | Train Loss: 1.5686 | Train Acc: 0.6667
 Site-Real                      (4) | Train Loss: 1.5467 | Train Acc: 0.7241
 Site-Real                      (4) | Train Loss: 1.5614 | Train Acc: 0.6739
 Site-Real                      (4) | Train Loss: 1.4681 | Train Acc: 0.6486
 Site-Real                      (4) | Train Loss: 1.4827 | Train Acc: 0.6975
 Site-Real                      (4) | Train Loss: 1.4446 | Train Acc: 0.7644
 Site-Real                      (4) | Train Loss: 1.5363 | Train Acc: 0.7026
 Site-Painting                  (0) | Train Loss: 1.7027 | Train Acc: 0.5283
 Site-Painting                  (0) | Train Loss: 1.6010 | Train Acc: 0.5529
 Site-Painting                  (0) | Train Loss: 1.7128 | Train Acc: 0.5368
 Site-Painting                  (0) | Train Loss: 1.5535 | Train Acc: 0.6498
 Site-Sketch                    (2) | Train Loss: 1.6043 | Train Acc: 0.6271
 Site-Sketch                    (2) | Train Loss: 1.6604 | Train Acc: 0.6000
 Site-Sketch                    (2) | Train Loss: 1.6816 | Train Acc: 0.5592
 Site-QuickDraw                 (1) | Train Loss: 2.2554 | Train Acc: 0.1918
 Site-QuickDraw                 (1) | Train Loss: 2.3031 | Train Acc: 0.1864
 Site-Infograph                 (4) | Train Loss: 2.1069 | Train Acc: 0.2917
Average Train Accuracy: 0.5942
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.7273
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.7647
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5357
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6293
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6452
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6611
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6457
 Best site-Real                      | Epoch:1 | Val Acc: 0.6667
 Best site-Real                      | Epoch:1 | Val Acc: 0.7241
 Best site-Real                      | Epoch:1 | Val Acc: 0.6739
 Best site-Real                      | Epoch:1 | Val Acc: 0.6486
 Best site-Real                      | Epoch:1 | Val Acc: 0.6975
 Best site-Real                      | Epoch:1 | Val Acc: 0.7644
 Best site-Real                      | Epoch:1 | Val Acc: 0.7026
 Best site-Painting                  | Epoch:1 | Val Acc: 0.5283
 Best site-Painting                  | Epoch:1 | Val Acc: 0.5529
 Best site-Painting                  | Epoch:1 | Val Acc: 0.5368
 Best site-Painting                  | Epoch:1 | Val Acc: 0.6498
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.6271
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.6000
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.5592
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.1918
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.1864
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.2917
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
===2023-08-17 13:30:34===
===2023-08-17 13:31:43===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 6
data_number=[6,11,17,28,45,72,116,186,298,477,18,29,46,74,119,191,306,53,85,136,217,59,95,152,73,118,120,
client_nums=[10,7,4,3,2,1,]
len_dataset=[2103,1314,821,513,320,200,]
domain number = 6
============ Train epoch 0 ============
cnt=[11, 2, 2, 1, 3, 8, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (3) | Train Loss: 1.8940 | Train Acc: 0.6667
 Site-Clipart                   (5) | Train Loss: 2.0272 | Train Acc: 0.3636
 Site-Clipart                   (5) | Train Loss: 1.8789 | Train Acc: 0.5882
 Site-Clipart                   (2) | Train Loss: 1.9707 | Train Acc: 0.3571
 Site-Clipart                   (5) | Train Loss: 2.0124 | Train Acc: 0.3333
 Site-Clipart                   (2) | Train Loss: 1.8659 | Train Acc: 0.4583
 Site-Clipart                   (5) | Train Loss: 1.9374 | Train Acc: 0.4655
 Site-Clipart                   (5) | Train Loss: 2.0206 | Train Acc: 0.3763
 Site-Clipart                   (5) | Train Loss: 1.9857 | Train Acc: 0.3926
 Site-Clipart                   (5) | Train Loss: 1.9774 | Train Acc: 0.3941
 Site-Real                      (0) | Train Loss: 2.0584 | Train Acc: 0.3333
 Site-Real                      (0) | Train Loss: 1.8758 | Train Acc: 0.5862
 Site-Real                      (0) | Train Loss: 1.9631 | Train Acc: 0.5000
 Site-Real                      (0) | Train Loss: 1.9598 | Train Acc: 0.4595
 Site-Real                      (0) | Train Loss: 1.9145 | Train Acc: 0.4706
 Site-Real                      (0) | Train Loss: 1.8970 | Train Acc: 0.5340
 Site-Real                      (0) | Train Loss: 1.9353 | Train Acc: 0.5163
 Site-Painting                  (0) | Train Loss: 2.0534 | Train Acc: 0.3396
 Site-Painting                  (0) | Train Loss: 2.0022 | Train Acc: 0.4588
 Site-Painting                  (0) | Train Loss: 2.0802 | Train Acc: 0.3750
 Site-Painting                  (0) | Train Loss: 1.9501 | Train Acc: 0.4608
 Site-Sketch                    (4) | Train Loss: 1.9565 | Train Acc: 0.4576
 Site-Sketch                    (4) | Train Loss: 2.0420 | Train Acc: 0.3895
 Site-Sketch                    (4) | Train Loss: 2.0445 | Train Acc: 0.3553
 Site-QuickDraw                 (1) | Train Loss: 2.3296 | Train Acc: 0.0822
 Site-QuickDraw                 (1) | Train Loss: 2.3710 | Train Acc: 0.0932
 Site-Infograph                 (5) | Train Loss: 2.2652 | Train Acc: 0.1500
Average Train Accuracy: 0.4059
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3636
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.5882
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3571
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3333
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4583
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4655
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3763
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3926
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3941
 Best site-Real                      | Epoch:0 | Val Acc: 0.3333
 Best site-Real                      | Epoch:0 | Val Acc: 0.5862
 Best site-Real                      | Epoch:0 | Val Acc: 0.5000
 Best site-Real                      | Epoch:0 | Val Acc: 0.4595
 Best site-Real                      | Epoch:0 | Val Acc: 0.4706
 Best site-Real                      | Epoch:0 | Val Acc: 0.5340
 Best site-Real                      | Epoch:0 | Val Acc: 0.5163
 Best site-Painting                  | Epoch:0 | Val Acc: 0.3396
 Best site-Painting                  | Epoch:0 | Val Acc: 0.4588
 Best site-Painting                  | Epoch:0 | Val Acc: 0.3750
 Best site-Painting                  | Epoch:0 | Val Acc: 0.4608
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.4576
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.3895
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.3553
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.0822
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.0932
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.1500
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 1 ============
cnt=[4, 2, 3, 9, 8, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (3) | Train Loss: 1.7327 | Train Acc: 0.5000
 Site-Clipart                   (5) | Train Loss: 1.5512 | Train Acc: 0.7273
 Site-Clipart                   (3) | Train Loss: 1.5321 | Train Acc: 0.7647
 Site-Clipart                   (3) | Train Loss: 1.6534 | Train Acc: 0.5357
 Site-Clipart                   (3) | Train Loss: 1.7652 | Train Acc: 0.6667
 Site-Clipart                   (3) | Train Loss: 1.5753 | Train Acc: 0.6667
 Site-Clipart                   (3) | Train Loss: 1.6014 | Train Acc: 0.6293
 Site-Clipart                   (3) | Train Loss: 1.7147 | Train Acc: 0.6452
 Site-Clipart                   (3) | Train Loss: 1.6232 | Train Acc: 0.6611
 Site-Clipart                   (3) | Train Loss: 1.6280 | Train Acc: 0.6457
 Site-Real                      (4) | Train Loss: 1.5683 | Train Acc: 0.6667
 Site-Real                      (4) | Train Loss: 1.5468 | Train Acc: 0.7241
 Site-Real                      (4) | Train Loss: 1.5615 | Train Acc: 0.6739
 Site-Real                      (4) | Train Loss: 1.4676 | Train Acc: 0.6486
 Site-Real                      (4) | Train Loss: 1.4820 | Train Acc: 0.6975
 Site-Real                      (4) | Train Loss: 1.4444 | Train Acc: 0.7644
 Site-Real                      (4) | Train Loss: 1.5361 | Train Acc: 0.7026
 Site-Painting                  (0) | Train Loss: 1.7029 | Train Acc: 0.5283
 Site-Painting                  (0) | Train Loss: 1.6005 | Train Acc: 0.5529
 Site-Painting                  (0) | Train Loss: 1.7122 | Train Acc: 0.5368
 Site-Painting                  (0) | Train Loss: 1.5532 | Train Acc: 0.6544
 Site-Sketch                    (2) | Train Loss: 1.6038 | Train Acc: 0.6271
 Site-Sketch                    (2) | Train Loss: 1.6599 | Train Acc: 0.6000
 Site-Sketch                    (2) | Train Loss: 1.6813 | Train Acc: 0.5592
 Site-QuickDraw                 (1) | Train Loss: 2.2553 | Train Acc: 0.1918
 Site-QuickDraw                 (1) | Train Loss: 2.3029 | Train Acc: 0.1864
 Site-Infograph                 (4) | Train Loss: 2.1070 | Train Acc: 0.2917
Average Train Accuracy: 0.5944
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.7273
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.7647
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5357
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6293
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6452
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6611
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6457
 Best site-Real                      | Epoch:1 | Val Acc: 0.6667
 Best site-Real                      | Epoch:1 | Val Acc: 0.7241
 Best site-Real                      | Epoch:1 | Val Acc: 0.6739
 Best site-Real                      | Epoch:1 | Val Acc: 0.6486
 Best site-Real                      | Epoch:1 | Val Acc: 0.6975
 Best site-Real                      | Epoch:1 | Val Acc: 0.7644
 Best site-Real                      | Epoch:1 | Val Acc: 0.7026
 Best site-Painting                  | Epoch:1 | Val Acc: 0.5283
 Best site-Painting                  | Epoch:1 | Val Acc: 0.5529
 Best site-Painting                  | Epoch:1 | Val Acc: 0.5368
 Best site-Painting                  | Epoch:1 | Val Acc: 0.6544
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.6271
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.6000
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.5592
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.1918
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.1864
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.2917
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 2 ============
cnt=[7, 1, 10, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (2) | Train Loss: 1.2937 | Train Acc: 0.8333
 Site-Clipart                   (1) | Train Loss: 1.2259 | Train Acc: 0.8182
 Site-Clipart                   (2) | Train Loss: 1.2272 | Train Acc: 0.8235
 Site-Clipart                   (4) | Train Loss: 1.3916 | Train Acc: 0.5714
 Site-Clipart                   (2) | Train Loss: 1.4267 | Train Acc: 0.7333
 Site-Clipart                   (2) | Train Loss: 1.2805 | Train Acc: 0.7500
 Site-Clipart                   (2) | Train Loss: 1.3278 | Train Acc: 0.7500
 Site-Clipart                   (2) | Train Loss: 1.4148 | Train Acc: 0.7419
 Site-Clipart                   (2) | Train Loss: 1.3509 | Train Acc: 0.7383
 Site-Clipart                   (2) | Train Loss: 1.3521 | Train Acc: 0.7463
 Site-Real                      (0) | Train Loss: 1.3430 | Train Acc: 0.6667
 Site-Real                      (0) | Train Loss: 1.2122 | Train Acc: 0.8276
 Site-Real                      (0) | Train Loss: 1.1329 | Train Acc: 0.8696
 Site-Real                      (0) | Train Loss: 1.2238 | Train Acc: 0.7568
 Site-Real                      (0) | Train Loss: 1.1318 | Train Acc: 0.8235
 Site-Real                      (0) | Train Loss: 1.1179 | Train Acc: 0.8272
 Site-Real                      (0) | Train Loss: 1.1883 | Train Acc: 0.8137
 Site-Painting                  (4) | Train Loss: 1.3832 | Train Acc: 0.6792
 Site-Painting                  (4) | Train Loss: 1.3856 | Train Acc: 0.6588
 Site-Painting                  (4) | Train Loss: 1.3981 | Train Acc: 0.7206
 Site-Painting                  (4) | Train Loss: 1.2420 | Train Acc: 0.7558
 Site-Sketch                    (4) | Train Loss: 1.3152 | Train Acc: 0.7458
 Site-Sketch                    (2) | Train Loss: 1.4523 | Train Acc: 0.6316
 Site-Sketch                    (2) | Train Loss: 1.3892 | Train Acc: 0.6645
 Site-QuickDraw                 (3) | Train Loss: 2.2881 | Train Acc: 0.1918
 Site-QuickDraw                 (3) | Train Loss: 2.2772 | Train Acc: 0.2034
 Site-Infograph                 (5) | Train Loss: 2.0553 | Train Acc: 0.3417
Average Train Accuracy: 0.6920
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8182
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8235
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.5714
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7333
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7500
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7500
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7419
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7383
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7463
 Best site-Real                      | Epoch:2 | Val Acc: 0.6667
 Best site-Real                      | Epoch:2 | Val Acc: 0.8276
 Best site-Real                      | Epoch:2 | Val Acc: 0.8696
 Best site-Real                      | Epoch:2 | Val Acc: 0.7568
 Best site-Real                      | Epoch:2 | Val Acc: 0.8235
 Best site-Real                      | Epoch:2 | Val Acc: 0.8272
 Best site-Real                      | Epoch:2 | Val Acc: 0.8137
 Best site-Painting                  | Epoch:2 | Val Acc: 0.6792
 Best site-Painting                  | Epoch:2 | Val Acc: 0.6588
 Best site-Painting                  | Epoch:2 | Val Acc: 0.7206
 Best site-Painting                  | Epoch:2 | Val Acc: 0.7558
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.7458
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.6316
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.6645
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.1918
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.2034
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.3417
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 3 ============
cnt=[4, 5, 8, 7, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (3) | Train Loss: 1.3026 | Train Acc: 0.6667
 Site-Clipart                   (3) | Train Loss: 1.1914 | Train Acc: 0.7273
 Site-Clipart                   (3) | Train Loss: 1.0009 | Train Acc: 0.8824
 Site-Clipart                   (5) | Train Loss: 1.2479 | Train Acc: 0.7857
 Site-Clipart                   (3) | Train Loss: 1.2811 | Train Acc: 0.7778
 Site-Clipart                   (1) | Train Loss: 1.1226 | Train Acc: 0.7222
 Site-Clipart                   (1) | Train Loss: 1.0712 | Train Acc: 0.7931
 Site-Clipart                   (1) | Train Loss: 1.1992 | Train Acc: 0.7903
 Site-Clipart                   (3) | Train Loss: 1.1286 | Train Acc: 0.7919
 Site-Clipart                   (1) | Train Loss: 1.1334 | Train Acc: 0.8050
 Site-Real                      (2) | Train Loss: 1.1185 | Train Acc: 0.7222
 Site-Real                      (2) | Train Loss: 1.0668 | Train Acc: 0.8621
 Site-Real                      (2) | Train Loss: 0.8925 | Train Acc: 0.8696
 Site-Real                      (2) | Train Loss: 0.9531 | Train Acc: 0.8243
 Site-Real                      (2) | Train Loss: 0.8753 | Train Acc: 0.8908
 Site-Real                      (2) | Train Loss: 0.8803 | Train Acc: 0.8848
 Site-Real                      (2) | Train Loss: 0.9263 | Train Acc: 0.8725
 Site-Painting                  (0) | Train Loss: 1.1870 | Train Acc: 0.7547
 Site-Painting                  (0) | Train Loss: 1.1158 | Train Acc: 0.7647
 Site-Painting                  (0) | Train Loss: 1.1375 | Train Acc: 0.8015
 Site-Painting                  (0) | Train Loss: 1.0202 | Train Acc: 0.8295
 Site-Sketch                    (3) | Train Loss: 1.0865 | Train Acc: 0.7966
 Site-Sketch                    (1) | Train Loss: 1.1546 | Train Acc: 0.7579
 Site-Sketch                    (3) | Train Loss: 1.2328 | Train Acc: 0.6974
 Site-QuickDraw                 (4) | Train Loss: 2.2440 | Train Acc: 0.2192
 Site-QuickDraw                 (4) | Train Loss: 2.2459 | Train Acc: 0.2203
 Site-Infograph                 (2) | Train Loss: 1.9885 | Train Acc: 0.3333
Average Train Accuracy: 0.7350
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7273
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8824
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7857
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7778
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7222
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7931
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7903
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7919
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8050
 Best site-Real                      | Epoch:3 | Val Acc: 0.7222
 Best site-Real                      | Epoch:3 | Val Acc: 0.8621
 Best site-Real                      | Epoch:3 | Val Acc: 0.8696
 Best site-Real                      | Epoch:3 | Val Acc: 0.8243
 Best site-Real                      | Epoch:3 | Val Acc: 0.8908
 Best site-Real                      | Epoch:3 | Val Acc: 0.8848
 Best site-Real                      | Epoch:3 | Val Acc: 0.8725
 Best site-Painting                  | Epoch:3 | Val Acc: 0.7547
 Best site-Painting                  | Epoch:3 | Val Acc: 0.7647
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8015
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8295
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.7966
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.7579
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.6974
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.2192
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.2203
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.3333
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 4 ============
cnt=[2, 6, 4, 2, 10, 3, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (4) | Train Loss: 1.1720 | Train Acc: 0.6667
 Site-Clipart                   (4) | Train Loss: 1.0732 | Train Acc: 0.8182
 Site-Clipart                   (4) | Train Loss: 0.9063 | Train Acc: 0.8235
 Site-Clipart                   (5) | Train Loss: 1.0809 | Train Acc: 0.7500
 Site-Clipart                   (4) | Train Loss: 1.0989 | Train Acc: 0.8000
 Site-Clipart                   (4) | Train Loss: 1.0045 | Train Acc: 0.7500
 Site-Clipart                   (4) | Train Loss: 0.8963 | Train Acc: 0.8448
 Site-Clipart                   (4) | Train Loss: 1.0402 | Train Acc: 0.7796
 Site-Clipart                   (4) | Train Loss: 0.9266 | Train Acc: 0.8188
 Site-Clipart                   (4) | Train Loss: 0.9733 | Train Acc: 0.8008
 Site-Real                      (1) | Train Loss: 1.0186 | Train Acc: 0.7778
 Site-Real                      (1) | Train Loss: 0.8407 | Train Acc: 0.8966
 Site-Real                      (1) | Train Loss: 0.7344 | Train Acc: 0.9348
 Site-Real                      (2) | Train Loss: 0.8321 | Train Acc: 0.9054
 Site-Real                      (1) | Train Loss: 0.6968 | Train Acc: 0.9496
 Site-Real                      (1) | Train Loss: 0.6916 | Train Acc: 0.9267
 Site-Real                      (1) | Train Loss: 0.7503 | Train Acc: 0.8954
 Site-Painting                  (2) | Train Loss: 0.9450 | Train Acc: 0.8113
 Site-Painting                  (2) | Train Loss: 0.9532 | Train Acc: 0.7882
 Site-Painting                  (5) | Train Loss: 0.9203 | Train Acc: 0.8162
 Site-Painting                  (2) | Train Loss: 0.8622 | Train Acc: 0.8525
 Site-Sketch                    (0) | Train Loss: 0.9525 | Train Acc: 0.7627
 Site-Sketch                    (4) | Train Loss: 1.0108 | Train Acc: 0.7474
 Site-Sketch                    (0) | Train Loss: 1.0875 | Train Acc: 0.7039
 Site-QuickDraw                 (3) | Train Loss: 2.1232 | Train Acc: 0.2877
 Site-QuickDraw                 (3) | Train Loss: 2.1770 | Train Acc: 0.2288
 Site-Infograph                 (5) | Train Loss: 1.8548 | Train Acc: 0.4083
Average Train Accuracy: 0.7610
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8182
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8235
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7500
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8000
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7500
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8448
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7796
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8188
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8008
 Best site-Real                      | Epoch:4 | Val Acc: 0.7778
 Best site-Real                      | Epoch:4 | Val Acc: 0.8966
 Best site-Real                      | Epoch:4 | Val Acc: 0.9348
 Best site-Real                      | Epoch:4 | Val Acc: 0.9054
 Best site-Real                      | Epoch:4 | Val Acc: 0.9496
 Best site-Real                      | Epoch:4 | Val Acc: 0.9267
 Best site-Real                      | Epoch:4 | Val Acc: 0.8954
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8113
 Best site-Painting                  | Epoch:4 | Val Acc: 0.7882
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8162
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8525
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7627
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7474
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7039
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.2877
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.2288
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.4083
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 5 ============
cnt=[8, 4, 6, 2, 3, 4, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (4) | Train Loss: 0.8769 | Train Acc: 0.6667
 Site-Clipart                   (4) | Train Loss: 0.7752 | Train Acc: 0.9091
 Site-Clipart                   (4) | Train Loss: 0.8133 | Train Acc: 0.8235
 Site-Clipart                   (2) | Train Loss: 0.8961 | Train Acc: 0.8571
 Site-Clipart                   (0) | Train Loss: 1.0082 | Train Acc: 0.8222
 Site-Clipart                   (2) | Train Loss: 0.8782 | Train Acc: 0.7917
 Site-Clipart                   (0) | Train Loss: 0.7428 | Train Acc: 0.8966
 Site-Clipart                   (0) | Train Loss: 0.9158 | Train Acc: 0.8118
 Site-Clipart                   (0) | Train Loss: 0.8431 | Train Acc: 0.8523
 Site-Clipart                   (0) | Train Loss: 0.8477 | Train Acc: 0.8491
 Site-Real                      (5) | Train Loss: 0.9036 | Train Acc: 0.7778
 Site-Real                      (5) | Train Loss: 0.7534 | Train Acc: 0.8621
 Site-Real                      (5) | Train Loss: 0.6049 | Train Acc: 0.9565
 Site-Real                      (1) | Train Loss: 0.6671 | Train Acc: 0.9054
 Site-Real                      (5) | Train Loss: 0.6100 | Train Acc: 0.9496
 Site-Real                      (1) | Train Loss: 0.6087 | Train Acc: 0.9372
 Site-Real                      (1) | Train Loss: 0.6537 | Train Acc: 0.9118
 Site-Painting                  (2) | Train Loss: 0.8486 | Train Acc: 0.7736
 Site-Painting                  (2) | Train Loss: 0.8493 | Train Acc: 0.8235
 Site-Painting                  (2) | Train Loss: 0.8964 | Train Acc: 0.7868
 Site-Painting                  (1) | Train Loss: 0.7542 | Train Acc: 0.8525
 Site-Sketch                    (0) | Train Loss: 0.7498 | Train Acc: 0.8983
 Site-Sketch                    (0) | Train Loss: 0.9471 | Train Acc: 0.7789
 Site-Sketch                    (0) | Train Loss: 0.9434 | Train Acc: 0.7237
 Site-QuickDraw                 (3) | Train Loss: 2.0844 | Train Acc: 0.2603
 Site-QuickDraw                 (3) | Train Loss: 2.0842 | Train Acc: 0.2881
 Site-Infograph                 (2) | Train Loss: 1.8147 | Train Acc: 0.3833
Average Train Accuracy: 0.7833
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8235
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8222
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.7917
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8966
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8118
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8523
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8491
 Best site-Real                      | Epoch:5 | Val Acc: 0.7778
 Best site-Real                      | Epoch:5 | Val Acc: 0.8621
 Best site-Real                      | Epoch:5 | Val Acc: 0.9565
 Best site-Real                      | Epoch:5 | Val Acc: 0.9054
 Best site-Real                      | Epoch:5 | Val Acc: 0.9496
 Best site-Real                      | Epoch:5 | Val Acc: 0.9372
 Best site-Real                      | Epoch:5 | Val Acc: 0.9118
 Best site-Painting                  | Epoch:5 | Val Acc: 0.7736
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8235
 Best site-Painting                  | Epoch:5 | Val Acc: 0.7868
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8525
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.8983
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.7789
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.7237
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.2603
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.2881
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.3833
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 6 ============
cnt=[8, 5, 2, 8, 2, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (5) | Train Loss: 0.8101 | Train Acc: 0.6667
 Site-Clipart                   (5) | Train Loss: 0.7018 | Train Acc: 0.8182
 Site-Clipart                   (0) | Train Loss: 0.6157 | Train Acc: 0.8824
 Site-Clipart                   (1) | Train Loss: 0.7640 | Train Acc: 0.9286
 Site-Clipart                   (3) | Train Loss: 0.8387 | Train Acc: 0.8667
 Site-Clipart                   (3) | Train Loss: 0.8199 | Train Acc: 0.7778
 Site-Clipart                   (0) | Train Loss: 0.7000 | Train Acc: 0.8793
 Site-Clipart                   (0) | Train Loss: 0.8302 | Train Acc: 0.8495
 Site-Clipart                   (0) | Train Loss: 0.7519 | Train Acc: 0.8423
 Site-Clipart                   (0) | Train Loss: 0.7556 | Train Acc: 0.8386
 Site-Real                      (4) | Train Loss: 0.8109 | Train Acc: 0.7778
 Site-Real                      (4) | Train Loss: 0.6672 | Train Acc: 0.8966
 Site-Real                      (1) | Train Loss: 0.5518 | Train Acc: 0.9348
 Site-Real                      (3) | Train Loss: 0.6284 | Train Acc: 0.9459
 Site-Real                      (1) | Train Loss: 0.4943 | Train Acc: 0.9664
 Site-Real                      (1) | Train Loss: 0.5396 | Train Acc: 0.9372
 Site-Real                      (1) | Train Loss: 0.5676 | Train Acc: 0.9314
 Site-Painting                  (3) | Train Loss: 0.7739 | Train Acc: 0.8113
 Site-Painting                  (3) | Train Loss: 0.7097 | Train Acc: 0.8588
 Site-Painting                  (3) | Train Loss: 0.7236 | Train Acc: 0.8382
 Site-Painting                  (3) | Train Loss: 0.6581 | Train Acc: 0.8940
 Site-Sketch                    (0) | Train Loss: 0.6926 | Train Acc: 0.8644
 Site-Sketch                    (0) | Train Loss: 0.8447 | Train Acc: 0.8211
 Site-Sketch                    (0) | Train Loss: 0.8647 | Train Acc: 0.7566
 Site-QuickDraw                 (2) | Train Loss: 1.9408 | Train Acc: 0.2603
 Site-QuickDraw                 (2) | Train Loss: 2.0074 | Train Acc: 0.2542
 Site-Infograph                 (3) | Train Loss: 1.7434 | Train Acc: 0.4250
Average Train Accuracy: 0.7972
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8182
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8824
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.9286
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8667
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.7778
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8793
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8495
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8423
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8386
 Best site-Real                      | Epoch:6 | Val Acc: 0.7778
 Best site-Real                      | Epoch:6 | Val Acc: 0.8966
 Best site-Real                      | Epoch:6 | Val Acc: 0.9348
 Best site-Real                      | Epoch:6 | Val Acc: 0.9459
 Best site-Real                      | Epoch:6 | Val Acc: 0.9664
 Best site-Real                      | Epoch:6 | Val Acc: 0.9372
 Best site-Real                      | Epoch:6 | Val Acc: 0.9314
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8113
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8588
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8382
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8940
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.8644
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.8211
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.7566
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.2603
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.2542
 Best site-Infograph                 | Epoch:6 | Val Acc: 0.4250
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 7 ============
cnt=[5, 8, 2, 4, 7, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (1) | Train Loss: 0.8281 | Train Acc: 0.6667
 Site-Clipart                   (1) | Train Loss: 0.7706 | Train Acc: 0.9091
 Site-Clipart                   (1) | Train Loss: 0.5429 | Train Acc: 0.9412
 Site-Clipart                   (3) | Train Loss: 0.7506 | Train Acc: 0.8571
 Site-Clipart                   (4) | Train Loss: 0.7826 | Train Acc: 0.8222
 Site-Clipart                   (1) | Train Loss: 0.6657 | Train Acc: 0.8333
 Site-Clipart                   (1) | Train Loss: 0.6405 | Train Acc: 0.8793
 Site-Clipart                   (1) | Train Loss: 0.7606 | Train Acc: 0.8387
 Site-Clipart                   (1) | Train Loss: 0.7003 | Train Acc: 0.8121
 Site-Clipart                   (0) | Train Loss: 0.7098 | Train Acc: 0.8721
 Site-Real                      (3) | Train Loss: 0.7659 | Train Acc: 0.7778
 Site-Real                      (5) | Train Loss: 0.5887 | Train Acc: 0.8966
 Site-Real                      (0) | Train Loss: 0.4493 | Train Acc: 0.9348
 Site-Real                      (0) | Train Loss: 0.5957 | Train Acc: 0.9324
 Site-Real                      (3) | Train Loss: 0.4451 | Train Acc: 0.9412
 Site-Real                      (3) | Train Loss: 0.4647 | Train Acc: 0.9424
 Site-Real                      (0) | Train Loss: 0.5101 | Train Acc: 0.9444
 Site-Painting                  (4) | Train Loss: 0.7520 | Train Acc: 0.8113
 Site-Painting                  (4) | Train Loss: 0.6688 | Train Acc: 0.8471
 Site-Painting                  (0) | Train Loss: 0.7836 | Train Acc: 0.8235
 Site-Painting                  (4) | Train Loss: 0.5956 | Train Acc: 0.9078
 Site-Sketch                    (1) | Train Loss: 0.6513 | Train Acc: 0.8475
 Site-Sketch                    (4) | Train Loss: 0.7579 | Train Acc: 0.8000
 Site-Sketch                    (4) | Train Loss: 0.8010 | Train Acc: 0.7566
 Site-QuickDraw                 (2) | Train Loss: 1.8712 | Train Acc: 0.2877
 Site-QuickDraw                 (2) | Train Loss: 1.8563 | Train Acc: 0.3390
 Site-Infograph                 (4) | Train Loss: 1.6960 | Train Acc: 0.4417
Average Train Accuracy: 0.8024
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8222
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8793
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8387
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8121
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8721
 Best site-Real                      | Epoch:7 | Val Acc: 0.7778
 Best site-Real                      | Epoch:7 | Val Acc: 0.8966
 Best site-Real                      | Epoch:7 | Val Acc: 0.9348
 Best site-Real                      | Epoch:7 | Val Acc: 0.9324
 Best site-Real                      | Epoch:7 | Val Acc: 0.9412
 Best site-Real                      | Epoch:7 | Val Acc: 0.9424
 Best site-Real                      | Epoch:7 | Val Acc: 0.9444
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8113
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8471
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8235
 Best site-Painting                  | Epoch:7 | Val Acc: 0.9078
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.8475
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.8000
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.7566
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.2877
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.3390
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.4417
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 8 ============
cnt=[12, 8, 1, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (5) | Train Loss: 0.8250 | Train Acc: 0.6667
 Site-Clipart                   (0) | Train Loss: 0.5571 | Train Acc: 0.9091
 Site-Clipart                   (5) | Train Loss: 0.4130 | Train Acc: 0.9412
 Site-Clipart                   (1) | Train Loss: 0.7720 | Train Acc: 0.8571
 Site-Clipart                   (0) | Train Loss: 0.6557 | Train Acc: 0.9333
 Site-Clipart                   (0) | Train Loss: 0.7139 | Train Acc: 0.8056
 Site-Clipart                   (0) | Train Loss: 0.5880 | Train Acc: 0.8793
 Site-Clipart                   (0) | Train Loss: 0.6941 | Train Acc: 0.8548
 Site-Clipart                   (0) | Train Loss: 0.6661 | Train Acc: 0.8356
 Site-Clipart                   (0) | Train Loss: 0.6378 | Train Acc: 0.8658
 Site-Real                      (3) | Train Loss: 0.7540 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.5144 | Train Acc: 0.8966
 Site-Real                      (3) | Train Loss: 0.4581 | Train Acc: 0.9565
 Site-Real                      (1) | Train Loss: 0.5165 | Train Acc: 0.9459
 Site-Real                      (1) | Train Loss: 0.4009 | Train Acc: 0.9580
 Site-Real                      (1) | Train Loss: 0.4452 | Train Acc: 0.9424
 Site-Real                      (1) | Train Loss: 0.4549 | Train Acc: 0.9412
 Site-Painting                  (0) | Train Loss: 0.6971 | Train Acc: 0.8302
 Site-Painting                  (1) | Train Loss: 0.6166 | Train Acc: 0.8235
 Site-Painting                  (1) | Train Loss: 0.6674 | Train Acc: 0.8603
 Site-Painting                  (1) | Train Loss: 0.5851 | Train Acc: 0.8756
 Site-Sketch                    (0) | Train Loss: 0.6484 | Train Acc: 0.8644
 Site-Sketch                    (0) | Train Loss: 0.7908 | Train Acc: 0.7789
 Site-Sketch                    (0) | Train Loss: 0.8251 | Train Acc: 0.7500
 Site-QuickDraw                 (4) | Train Loss: 1.8069 | Train Acc: 0.3288
 Site-QuickDraw                 (4) | Train Loss: 1.8164 | Train Acc: 0.3559
 Site-Infograph                 (0) | Train Loss: 1.5907 | Train Acc: 0.5167
Average Train Accuracy: 0.8130
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8056
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8793
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8548
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8356
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8658
 Best site-Real                      | Epoch:8 | Val Acc: 0.7778
 Best site-Real                      | Epoch:8 | Val Acc: 0.8966
 Best site-Real                      | Epoch:8 | Val Acc: 0.9565
 Best site-Real                      | Epoch:8 | Val Acc: 0.9459
 Best site-Real                      | Epoch:8 | Val Acc: 0.9580
 Best site-Real                      | Epoch:8 | Val Acc: 0.9424
 Best site-Real                      | Epoch:8 | Val Acc: 0.9412
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8302
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8235
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8603
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8756
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.8644
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.7789
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.7500
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.3288
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.3559
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.5167
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 9 ============
cnt=[6, 6, 5, 7, 2, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (3) | Train Loss: 0.8007 | Train Acc: 0.8333
 Site-Clipart                   (1) | Train Loss: 0.6406 | Train Acc: 0.9091
 Site-Clipart                   (3) | Train Loss: 0.4045 | Train Acc: 0.9412
 Site-Clipart                   (0) | Train Loss: 0.7146 | Train Acc: 0.9286
 Site-Clipart                   (1) | Train Loss: 0.6549 | Train Acc: 0.8667
 Site-Clipart                   (3) | Train Loss: 0.5567 | Train Acc: 0.8611
 Site-Clipart                   (3) | Train Loss: 0.5205 | Train Acc: 0.8966
 Site-Clipart                   (3) | Train Loss: 0.6977 | Train Acc: 0.8333
 Site-Clipart                   (1) | Train Loss: 0.6466 | Train Acc: 0.8322
 Site-Clipart                   (1) | Train Loss: 0.6056 | Train Acc: 0.8679
 Site-Real                      (0) | Train Loss: 0.6997 | Train Acc: 0.7778
 Site-Real                      (5) | Train Loss: 0.5353 | Train Acc: 0.8621
 Site-Real                      (0) | Train Loss: 0.3471 | Train Acc: 0.9348
 Site-Real                      (0) | Train Loss: 0.5389 | Train Acc: 0.9189
 Site-Real                      (0) | Train Loss: 0.3776 | Train Acc: 0.9664
 Site-Real                      (0) | Train Loss: 0.4076 | Train Acc: 0.9424
 Site-Real                      (2) | Train Loss: 0.4278 | Train Acc: 0.9412
 Site-Painting                  (2) | Train Loss: 0.6432 | Train Acc: 0.8491
 Site-Painting                  (2) | Train Loss: 0.6674 | Train Acc: 0.8235
 Site-Painting                  (2) | Train Loss: 0.6153 | Train Acc: 0.8529
 Site-Painting                  (2) | Train Loss: 0.5386 | Train Acc: 0.8940
 Site-Sketch                    (3) | Train Loss: 0.5244 | Train Acc: 0.8814
 Site-Sketch                    (3) | Train Loss: 0.7355 | Train Acc: 0.8000
 Site-Sketch                    (1) | Train Loss: 0.7151 | Train Acc: 0.7829
 Site-QuickDraw                 (4) | Train Loss: 1.7188 | Train Acc: 0.3836
 Site-QuickDraw                 (4) | Train Loss: 1.6649 | Train Acc: 0.4322
 Site-Infograph                 (1) | Train Loss: 1.5365 | Train Acc: 0.4833
Average Train Accuracy: 0.8258
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9286
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8667
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8611
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8966
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8322
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8679
 Best site-Real                      | Epoch:9 | Val Acc: 0.7778
 Best site-Real                      | Epoch:9 | Val Acc: 0.8621
 Best site-Real                      | Epoch:9 | Val Acc: 0.9348
 Best site-Real                      | Epoch:9 | Val Acc: 0.9189
 Best site-Real                      | Epoch:9 | Val Acc: 0.9664
 Best site-Real                      | Epoch:9 | Val Acc: 0.9424
 Best site-Real                      | Epoch:9 | Val Acc: 0.9412
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8491
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8235
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8529
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8940
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8814
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8000
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.7829
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.3836
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.4322
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.4833
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 10 ============
cnt=[7, 7, 2, 4, 5, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (1) | Train Loss: 0.8109 | Train Acc: 0.6667
 Site-Clipart                   (1) | Train Loss: 0.5694 | Train Acc: 0.9091
 Site-Clipart                   (1) | Train Loss: 0.3541 | Train Acc: 1.0000
 Site-Clipart                   (0) | Train Loss: 0.6306 | Train Acc: 0.7857
 Site-Clipart                   (3) | Train Loss: 0.5445 | Train Acc: 0.9111
 Site-Clipart                   (1) | Train Loss: 0.6306 | Train Acc: 0.8472
 Site-Clipart                   (4) | Train Loss: 0.5068 | Train Acc: 0.8879
 Site-Clipart                   (1) | Train Loss: 0.6350 | Train Acc: 0.8280
 Site-Clipart                   (4) | Train Loss: 0.5642 | Train Acc: 0.8624
 Site-Clipart                   (4) | Train Loss: 0.5880 | Train Acc: 0.8742
 Site-Real                      (0) | Train Loss: 0.7258 | Train Acc: 0.7778
 Site-Real                      (5) | Train Loss: 0.5062 | Train Acc: 0.8621
 Site-Real                      (5) | Train Loss: 0.3793 | Train Acc: 0.9565
 Site-Real                      (0) | Train Loss: 0.4227 | Train Acc: 0.9324
 Site-Real                      (0) | Train Loss: 0.3418 | Train Acc: 0.9664
 Site-Real                      (3) | Train Loss: 0.3672 | Train Acc: 0.9424
 Site-Real                      (0) | Train Loss: 0.4049 | Train Acc: 0.9314
 Site-Painting                  (3) | Train Loss: 0.6849 | Train Acc: 0.8679
 Site-Painting                  (4) | Train Loss: 0.6549 | Train Acc: 0.8235
 Site-Painting                  (0) | Train Loss: 0.6001 | Train Acc: 0.8676
 Site-Painting                  (0) | Train Loss: 0.5384 | Train Acc: 0.8756
 Site-Sketch                    (4) | Train Loss: 0.5790 | Train Acc: 0.8305
 Site-Sketch                    (1) | Train Loss: 0.6619 | Train Acc: 0.8105
 Site-Sketch                    (1) | Train Loss: 0.7204 | Train Acc: 0.8026
 Site-QuickDraw                 (2) | Train Loss: 1.7190 | Train Acc: 0.4247
 Site-QuickDraw                 (2) | Train Loss: 1.6492 | Train Acc: 0.4237
 Site-Infograph                 (3) | Train Loss: 1.5466 | Train Acc: 0.4833
Average Train Accuracy: 0.8204
============ Train epoch 11 ============
cnt=[6, 3, 5, 2, 6, 5, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (5) | Train Loss: 0.7146 | Train Acc: 0.6667
 Site-Clipart                   (0) | Train Loss: 0.5411 | Train Acc: 0.9091
 Site-Clipart                   (5) | Train Loss: 0.3444 | Train Acc: 0.9412
 Site-Clipart                   (4) | Train Loss: 0.6749 | Train Acc: 0.8929
 Site-Clipart                   (2) | Train Loss: 0.6535 | Train Acc: 0.8889
 Site-Clipart                   (5) | Train Loss: 0.5197 | Train Acc: 0.8472
 Site-Clipart                   (0) | Train Loss: 0.5107 | Train Acc: 0.8879
 Site-Clipart                   (0) | Train Loss: 0.6270 | Train Acc: 0.8495
 Site-Clipart                   (0) | Train Loss: 0.5371 | Train Acc: 0.8758
 Site-Clipart                   (5) | Train Loss: 0.5356 | Train Acc: 0.8742
 Site-Real                      (1) | Train Loss: 0.6365 | Train Acc: 0.8333
 Site-Real                      (1) | Train Loss: 0.4963 | Train Acc: 0.8621
 Site-Real                      (4) | Train Loss: 0.2910 | Train Acc: 0.9783
 Site-Real                      (4) | Train Loss: 0.3910 | Train Acc: 0.9459
 Site-Real                      (1) | Train Loss: 0.3083 | Train Acc: 0.9496
 Site-Real                      (4) | Train Loss: 0.3678 | Train Acc: 0.9372
 Site-Real                      (4) | Train Loss: 0.3946 | Train Acc: 0.9379
 Site-Painting                  (2) | Train Loss: 0.6065 | Train Acc: 0.8302
 Site-Painting                  (2) | Train Loss: 0.6042 | Train Acc: 0.8235
 Site-Painting                  (2) | Train Loss: 0.6177 | Train Acc: 0.8529
 Site-Painting                  (4) | Train Loss: 0.5008 | Train Acc: 0.8940
 Site-Sketch                    (0) | Train Loss: 0.4612 | Train Acc: 0.8983
 Site-Sketch                    (0) | Train Loss: 0.6451 | Train Acc: 0.8211
 Site-Sketch                    (5) | Train Loss: 0.7228 | Train Acc: 0.7566
 Site-QuickDraw                 (3) | Train Loss: 1.6396 | Train Acc: 0.5205
 Site-QuickDraw                 (3) | Train Loss: 1.5343 | Train Acc: 0.5254
 Site-Infograph                 (2) | Train Loss: 1.5812 | Train Acc: 0.4667
Average Train Accuracy: 0.8321
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8929
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8889
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8472
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8879
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8495
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8758
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8742
 Best site-Real                      | Epoch:11 | Val Acc: 0.8333
 Best site-Real                      | Epoch:11 | Val Acc: 0.8621
 Best site-Real                      | Epoch:11 | Val Acc: 0.9783
 Best site-Real                      | Epoch:11 | Val Acc: 0.9459
 Best site-Real                      | Epoch:11 | Val Acc: 0.9496
 Best site-Real                      | Epoch:11 | Val Acc: 0.9372
 Best site-Real                      | Epoch:11 | Val Acc: 0.9379
 Best site-Painting                  | Epoch:11 | Val Acc: 0.8302
 Best site-Painting                  | Epoch:11 | Val Acc: 0.8235
 Best site-Painting                  | Epoch:11 | Val Acc: 0.8529
 Best site-Painting                  | Epoch:11 | Val Acc: 0.8940
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.8983
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.8211
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.7566
 Best site-QuickDraw                 | Epoch:11 | Val Acc: 0.5205
 Best site-QuickDraw                 | Epoch:11 | Val Acc: 0.5254
 Best site-Infograph                 | Epoch:11 | Val Acc: 0.4667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 12 ============
cnt=[5, 5, 2, 5, 6, 4, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (1) | Train Loss: 0.8691 | Train Acc: 0.6667
 Site-Clipart                   (0) | Train Loss: 0.6366 | Train Acc: 0.8182
 Site-Clipart                   (1) | Train Loss: 0.3246 | Train Acc: 1.0000
 Site-Clipart                   (4) | Train Loss: 0.6778 | Train Acc: 0.8571
 Site-Clipart                   (4) | Train Loss: 0.5297 | Train Acc: 0.9333
 Site-Clipart                   (5) | Train Loss: 0.5713 | Train Acc: 0.8333
 Site-Clipart                   (5) | Train Loss: 0.4432 | Train Acc: 0.9224
 Site-Clipart                   (1) | Train Loss: 0.5849 | Train Acc: 0.8656
 Site-Clipart                   (4) | Train Loss: 0.5022 | Train Acc: 0.8691
 Site-Clipart                   (1) | Train Loss: 0.5372 | Train Acc: 0.8679
 Site-Real                      (3) | Train Loss: 0.6677 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.4417 | Train Acc: 0.8966
 Site-Real                      (3) | Train Loss: 0.2807 | Train Acc: 0.9783
 Site-Real                      (3) | Train Loss: 0.3996 | Train Acc: 0.9459
 Site-Real                      (3) | Train Loss: 0.3010 | Train Acc: 0.9580
 Site-Real                      (0) | Train Loss: 0.3239 | Train Acc: 0.9424
 Site-Real                      (0) | Train Loss: 0.3784 | Train Acc: 0.9281
 Site-Painting                  (4) | Train Loss: 0.6201 | Train Acc: 0.9057
 Site-Painting                  (0) | Train Loss: 0.5804 | Train Acc: 0.8706
 Site-Painting                  (0) | Train Loss: 0.5422 | Train Acc: 0.8750
 Site-Painting                  (4) | Train Loss: 0.4689 | Train Acc: 0.9124
 Site-Sketch                    (5) | Train Loss: 0.5117 | Train Acc: 0.8814
 Site-Sketch                    (5) | Train Loss: 0.5923 | Train Acc: 0.8421
 Site-Sketch                    (1) | Train Loss: 0.6716 | Train Acc: 0.7895
 Site-QuickDraw                 (2) | Train Loss: 1.5061 | Train Acc: 0.5479
 Site-QuickDraw                 (2) | Train Loss: 1.4652 | Train Acc: 0.5254
 Site-Infograph                 (4) | Train Loss: 1.4974 | Train Acc: 0.5083
Average Train Accuracy: 0.8435
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8182
 Best site-Clipart                   | Epoch:12 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9224
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8656
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8691
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8679
 Best site-Real                      | Epoch:12 | Val Acc: 0.8333
 Best site-Real                      | Epoch:12 | Val Acc: 0.8966
 Best site-Real                      | Epoch:12 | Val Acc: 0.9783
 Best site-Real                      | Epoch:12 | Val Acc: 0.9459
 Best site-Real                      | Epoch:12 | Val Acc: 0.9580
 Best site-Real                      | Epoch:12 | Val Acc: 0.9424
 Best site-Real                      | Epoch:12 | Val Acc: 0.9281
 Best site-Painting                  | Epoch:12 | Val Acc: 0.9057
 Best site-Painting                  | Epoch:12 | Val Acc: 0.8706
 Best site-Painting                  | Epoch:12 | Val Acc: 0.8750
 Best site-Painting                  | Epoch:12 | Val Acc: 0.9124
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.8814
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.8421
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.7895
 Best site-QuickDraw                 | Epoch:12 | Val Acc: 0.5479
 Best site-QuickDraw                 | Epoch:12 | Val Acc: 0.5254
 Best site-Infograph                 | Epoch:12 | Val Acc: 0.5083
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 13 ============
cnt=[4, 6, 2, 6, 6, 3, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (4) | Train Loss: 0.6557 | Train Acc: 0.8333
 Site-Clipart                   (4) | Train Loss: 0.5709 | Train Acc: 0.9091
 Site-Clipart                   (4) | Train Loss: 0.3139 | Train Acc: 0.9412
 Site-Clipart                   (3) | Train Loss: 0.5976 | Train Acc: 0.8214
 Site-Clipart                   (1) | Train Loss: 0.4792 | Train Acc: 0.9111
 Site-Clipart                   (4) | Train Loss: 0.5809 | Train Acc: 0.8333
 Site-Clipart                   (1) | Train Loss: 0.3979 | Train Acc: 0.9397
 Site-Clipart                   (4) | Train Loss: 0.6167 | Train Acc: 0.8387
 Site-Clipart                   (1) | Train Loss: 0.5132 | Train Acc: 0.8557
 Site-Clipart                   (1) | Train Loss: 0.4978 | Train Acc: 0.8889
 Site-Real                      (0) | Train Loss: 0.6286 | Train Acc: 0.8333
 Site-Real                      (0) | Train Loss: 0.4467 | Train Acc: 0.8966
 Site-Real                      (0) | Train Loss: 0.3448 | Train Acc: 0.9348
 Site-Real                      (3) | Train Loss: 0.3597 | Train Acc: 0.9459
 Site-Real                      (0) | Train Loss: 0.3113 | Train Acc: 0.9580
 Site-Real                      (3) | Train Loss: 0.3137 | Train Acc: 0.9372
 Site-Real                      (3) | Train Loss: 0.3493 | Train Acc: 0.9510
 Site-Painting                  (5) | Train Loss: 0.5124 | Train Acc: 0.8868
 Site-Painting                  (3) | Train Loss: 0.5695 | Train Acc: 0.8118
 Site-Painting                  (3) | Train Loss: 0.5695 | Train Acc: 0.8824
 Site-Painting                  (5) | Train Loss: 0.4333 | Train Acc: 0.9124
 Site-Sketch                    (1) | Train Loss: 0.5048 | Train Acc: 0.8475
 Site-Sketch                    (4) | Train Loss: 0.6418 | Train Acc: 0.8211
 Site-Sketch                    (1) | Train Loss: 0.6080 | Train Acc: 0.7895
 Site-QuickDraw                 (2) | Train Loss: 1.4105 | Train Acc: 0.6027
 Site-QuickDraw                 (2) | Train Loss: 1.4179 | Train Acc: 0.5593
 Site-Infograph                 (5) | Train Loss: 1.5135 | Train Acc: 0.5000
Average Train Accuracy: 0.8460
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8214
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9111
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9397
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8387
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8557
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8889
 Best site-Real                      | Epoch:13 | Val Acc: 0.8333
 Best site-Real                      | Epoch:13 | Val Acc: 0.8966
 Best site-Real                      | Epoch:13 | Val Acc: 0.9348
 Best site-Real                      | Epoch:13 | Val Acc: 0.9459
 Best site-Real                      | Epoch:13 | Val Acc: 0.9580
 Best site-Real                      | Epoch:13 | Val Acc: 0.9372
 Best site-Real                      | Epoch:13 | Val Acc: 0.9510
 Best site-Painting                  | Epoch:13 | Val Acc: 0.8868
 Best site-Painting                  | Epoch:13 | Val Acc: 0.8118
 Best site-Painting                  | Epoch:13 | Val Acc: 0.8824
 Best site-Painting                  | Epoch:13 | Val Acc: 0.9124
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.8475
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.8211
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.7895
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.6027
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.5593
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 14 ============
cnt=[2, 9, 4, 4, 7, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (2) | Train Loss: 0.9373 | Train Acc: 0.6667
 Site-Clipart                   (4) | Train Loss: 0.4485 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.2739 | Train Acc: 0.8824
 Site-Clipart                   (4) | Train Loss: 0.5806 | Train Acc: 0.8571
 Site-Clipart                   (4) | Train Loss: 0.5517 | Train Acc: 0.8667
 Site-Clipart                   (4) | Train Loss: 0.4716 | Train Acc: 0.8611
 Site-Clipart                   (2) | Train Loss: 0.4478 | Train Acc: 0.8966
 Site-Clipart                   (4) | Train Loss: 0.5649 | Train Acc: 0.8548
 Site-Clipart                   (1) | Train Loss: 0.4943 | Train Acc: 0.8725
 Site-Clipart                   (4) | Train Loss: 0.4885 | Train Acc: 0.8847
 Site-Real                      (3) | Train Loss: 0.6172 | Train Acc: 0.8333
 Site-Real                      (5) | Train Loss: 0.4089 | Train Acc: 0.8966
 Site-Real                      (3) | Train Loss: 0.2474 | Train Acc: 0.9783
 Site-Real                      (1) | Train Loss: 0.3334 | Train Acc: 0.9459
 Site-Real                      (3) | Train Loss: 0.2555 | Train Acc: 0.9664
 Site-Real                      (3) | Train Loss: 0.3005 | Train Acc: 0.9581
 Site-Real                      (1) | Train Loss: 0.3573 | Train Acc: 0.9412
 Site-Painting                  (1) | Train Loss: 0.5784 | Train Acc: 0.7925
 Site-Painting                  (1) | Train Loss: 0.5269 | Train Acc: 0.9059
 Site-Painting                  (1) | Train Loss: 0.4729 | Train Acc: 0.8824
 Site-Painting                  (1) | Train Loss: 0.4332 | Train Acc: 0.9032
 Site-Sketch                    (1) | Train Loss: 0.5536 | Train Acc: 0.7966
 Site-Sketch                    (2) | Train Loss: 0.6153 | Train Acc: 0.8316
 Site-Sketch                    (4) | Train Loss: 0.6688 | Train Acc: 0.7829
 Site-QuickDraw                 (0) | Train Loss: 1.3387 | Train Acc: 0.5616
 Site-QuickDraw                 (0) | Train Loss: 1.2908 | Train Acc: 0.6271
 Site-Infograph                 (1) | Train Loss: 1.4505 | Train Acc: 0.5667
Average Train Accuracy: 0.8415
============ Train epoch 15 ============
cnt=[5, 2, 4, 9, 6, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (4) | Train Loss: 0.7277 | Train Acc: 0.6667
 Site-Clipart                   (3) | Train Loss: 0.5477 | Train Acc: 0.9091
 Site-Clipart                   (4) | Train Loss: 0.3377 | Train Acc: 0.8824
 Site-Clipart                   (0) | Train Loss: 0.5251 | Train Acc: 0.8929
 Site-Clipart                   (3) | Train Loss: 0.4753 | Train Acc: 0.9333
 Site-Clipart                   (4) | Train Loss: 0.4014 | Train Acc: 0.8750
 Site-Clipart                   (0) | Train Loss: 0.3865 | Train Acc: 0.9138
 Site-Clipart                   (4) | Train Loss: 0.5421 | Train Acc: 0.8548
 Site-Clipart                   (0) | Train Loss: 0.5077 | Train Acc: 0.8658
 Site-Clipart                   (0) | Train Loss: 0.4409 | Train Acc: 0.9078
 Site-Real                      (2) | Train Loss: 0.6211 | Train Acc: 0.8333
 Site-Real                      (5) | Train Loss: 0.3848 | Train Acc: 0.8966
 Site-Real                      (2) | Train Loss: 0.3086 | Train Acc: 0.9783
 Site-Real                      (3) | Train Loss: 0.3544 | Train Acc: 0.9595
 Site-Real                      (2) | Train Loss: 0.2631 | Train Acc: 0.9664
 Site-Real                      (3) | Train Loss: 0.2643 | Train Acc: 0.9581
 Site-Real                      (2) | Train Loss: 0.3047 | Train Acc: 0.9510
 Site-Painting                  (3) | Train Loss: 0.5903 | Train Acc: 0.8302
 Site-Painting                  (3) | Train Loss: 0.4913 | Train Acc: 0.8824
 Site-Painting                  (3) | Train Loss: 0.5326 | Train Acc: 0.8603
 Site-Painting                  (3) | Train Loss: 0.4056 | Train Acc: 0.9032
 Site-Sketch                    (0) | Train Loss: 0.4647 | Train Acc: 0.8475
 Site-Sketch                    (4) | Train Loss: 0.5711 | Train Acc: 0.8421
 Site-Sketch                    (4) | Train Loss: 0.6439 | Train Acc: 0.7829
 Site-QuickDraw                 (1) | Train Loss: 1.3625 | Train Acc: 0.6027
 Site-QuickDraw                 (1) | Train Loss: 1.3114 | Train Acc: 0.6017
 Site-Infograph                 (3) | Train Loss: 1.5159 | Train Acc: 0.5083
Average Train Accuracy: 0.8484
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8824
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8929
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8750
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.9138
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8548
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8658
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.9078
 Best site-Real                      | Epoch:15 | Val Acc: 0.8333
 Best site-Real                      | Epoch:15 | Val Acc: 0.8966
 Best site-Real                      | Epoch:15 | Val Acc: 0.9783
 Best site-Real                      | Epoch:15 | Val Acc: 0.9595
 Best site-Real                      | Epoch:15 | Val Acc: 0.9664
 Best site-Real                      | Epoch:15 | Val Acc: 0.9581
 Best site-Real                      | Epoch:15 | Val Acc: 0.9510
 Best site-Painting                  | Epoch:15 | Val Acc: 0.8302
 Best site-Painting                  | Epoch:15 | Val Acc: 0.8824
 Best site-Painting                  | Epoch:15 | Val Acc: 0.8603
 Best site-Painting                  | Epoch:15 | Val Acc: 0.9032
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.8475
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.8421
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.7829
 Best site-QuickDraw                 | Epoch:15 | Val Acc: 0.6027
 Best site-QuickDraw                 | Epoch:15 | Val Acc: 0.6017
 Best site-Infograph                 | Epoch:15 | Val Acc: 0.5083
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 16 ============
cnt=[6, 2, 8, 2, 6, 3, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (3) | Train Loss: 0.7975 | Train Acc: 0.6667
 Site-Clipart                   (0) | Train Loss: 0.6832 | Train Acc: 0.8182
 Site-Clipart                   (3) | Train Loss: 0.3171 | Train Acc: 0.8235
 Site-Clipart                   (5) | Train Loss: 0.5653 | Train Acc: 0.8214
 Site-Clipart                   (0) | Train Loss: 0.3947 | Train Acc: 0.9111
 Site-Clipart                   (4) | Train Loss: 0.4327 | Train Acc: 0.8750
 Site-Clipart                   (4) | Train Loss: 0.3497 | Train Acc: 0.9052
 Site-Clipart                   (4) | Train Loss: 0.5404 | Train Acc: 0.8710
 Site-Clipart                   (0) | Train Loss: 0.4694 | Train Acc: 0.8725
 Site-Clipart                   (4) | Train Loss: 0.4191 | Train Acc: 0.9140
 Site-Real                      (5) | Train Loss: 0.5978 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.3664 | Train Acc: 0.8966
 Site-Real                      (2) | Train Loss: 0.2973 | Train Acc: 0.9783
 Site-Real                      (2) | Train Loss: 0.3542 | Train Acc: 0.9459
 Site-Real                      (5) | Train Loss: 0.2519 | Train Acc: 0.9664
 Site-Real                      (2) | Train Loss: 0.2657 | Train Acc: 0.9529
 Site-Real                      (2) | Train Loss: 0.3207 | Train Acc: 0.9314
 Site-Painting                  (2) | Train Loss: 0.5743 | Train Acc: 0.8491
 Site-Painting                  (0) | Train Loss: 0.5520 | Train Acc: 0.8471
 Site-Painting                  (2) | Train Loss: 0.4857 | Train Acc: 0.8676
 Site-Painting                  (2) | Train Loss: 0.4284 | Train Acc: 0.9217
 Site-Sketch                    (0) | Train Loss: 0.4130 | Train Acc: 0.8983
 Site-Sketch                    (4) | Train Loss: 0.5697 | Train Acc: 0.8211
 Site-Sketch                    (4) | Train Loss: 0.6494 | Train Acc: 0.7763
 Site-QuickDraw                 (1) | Train Loss: 1.3174 | Train Acc: 0.5479
 Site-QuickDraw                 (1) | Train Loss: 1.2864 | Train Acc: 0.6102
 Site-Infograph                 (0) | Train Loss: 1.4692 | Train Acc: 0.5000
Average Train Accuracy: 0.8358
============ Train epoch 17 ============
cnt=[5, 2, 3, 10, 3, 4, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (3) | Train Loss: 0.7793 | Train Acc: 0.8333
 Site-Clipart                   (3) | Train Loss: 0.4840 | Train Acc: 0.9091
 Site-Clipart                   (3) | Train Loss: 0.1974 | Train Acc: 1.0000
 Site-Clipart                   (4) | Train Loss: 0.4941 | Train Acc: 0.8929
 Site-Clipart                   (3) | Train Loss: 0.4469 | Train Acc: 0.8667
 Site-Clipart                   (3) | Train Loss: 0.3994 | Train Acc: 0.8750
 Site-Clipart                   (4) | Train Loss: 0.3880 | Train Acc: 0.9052
 Site-Clipart                   (3) | Train Loss: 0.5235 | Train Acc: 0.8602
 Site-Clipart                   (3) | Train Loss: 0.4447 | Train Acc: 0.8624
 Site-Clipart                   (3) | Train Loss: 0.4197 | Train Acc: 0.8973
 Site-Real                      (2) | Train Loss: 0.6181 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.3873 | Train Acc: 0.8966
 Site-Real                      (2) | Train Loss: 0.2260 | Train Acc: 0.9783
 Site-Real                      (0) | Train Loss: 0.3270 | Train Acc: 0.9324
 Site-Real                      (5) | Train Loss: 0.2594 | Train Acc: 0.9580
 Site-Real                      (5) | Train Loss: 0.2598 | Train Acc: 0.9424
 Site-Real                      (5) | Train Loss: 0.3008 | Train Acc: 0.9379
 Site-Painting                  (0) | Train Loss: 0.4874 | Train Acc: 0.8491
 Site-Painting                  (0) | Train Loss: 0.4812 | Train Acc: 0.8588
 Site-Painting                  (5) | Train Loss: 0.4724 | Train Acc: 0.8824
 Site-Painting                  (0) | Train Loss: 0.3736 | Train Acc: 0.9217
 Site-Sketch                    (4) | Train Loss: 0.4674 | Train Acc: 0.8475
 Site-Sketch                    (3) | Train Loss: 0.5074 | Train Acc: 0.8737
 Site-Sketch                    (3) | Train Loss: 0.6697 | Train Acc: 0.7632
 Site-QuickDraw                 (1) | Train Loss: 1.2655 | Train Acc: 0.5753
 Site-QuickDraw                 (1) | Train Loss: 1.1986 | Train Acc: 0.6356
 Site-Infograph                 (0) | Train Loss: 1.4296 | Train Acc: 0.5333
Average Train Accuracy: 0.8543
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8929
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8667
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8750
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.9052
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8602
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8624
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8973
 Best site-Real                      | Epoch:17 | Val Acc: 0.7778
 Best site-Real                      | Epoch:17 | Val Acc: 0.8966
 Best site-Real                      | Epoch:17 | Val Acc: 0.9783
 Best site-Real                      | Epoch:17 | Val Acc: 0.9324
 Best site-Real                      | Epoch:17 | Val Acc: 0.9580
 Best site-Real                      | Epoch:17 | Val Acc: 0.9424
 Best site-Real                      | Epoch:17 | Val Acc: 0.9379
 Best site-Painting                  | Epoch:17 | Val Acc: 0.8491
 Best site-Painting                  | Epoch:17 | Val Acc: 0.8588
 Best site-Painting                  | Epoch:17 | Val Acc: 0.8824
 Best site-Painting                  | Epoch:17 | Val Acc: 0.9217
 Best site-Sketch                    | Epoch:17 | Val Acc: 0.8475
 Best site-Sketch                    | Epoch:17 | Val Acc: 0.8737
 Best site-Sketch                    | Epoch:17 | Val Acc: 0.7632
 Best site-QuickDraw                 | Epoch:17 | Val Acc: 0.5753
 Best site-QuickDraw                 | Epoch:17 | Val Acc: 0.6356
 Best site-Infograph                 | Epoch:17 | Val Acc: 0.5333
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 18 ============
cnt=[2, 9, 7, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (3) | Train Loss: 0.7724 | Train Acc: 0.8333
 Site-Clipart                   (4) | Train Loss: 0.3785 | Train Acc: 0.9091
 Site-Clipart                   (4) | Train Loss: 0.2080 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.4690 | Train Acc: 0.9286
 Site-Clipart                   (2) | Train Loss: 0.4540 | Train Acc: 0.9111
 Site-Clipart                   (3) | Train Loss: 0.4412 | Train Acc: 0.8472
 Site-Clipart                   (3) | Train Loss: 0.3457 | Train Acc: 0.9397
 Site-Clipart                   (3) | Train Loss: 0.4889 | Train Acc: 0.8871
 Site-Clipart                   (1) | Train Loss: 0.4293 | Train Acc: 0.8725
 Site-Clipart                   (1) | Train Loss: 0.4170 | Train Acc: 0.9140
 Site-Real                      (5) | Train Loss: 0.6490 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.4045 | Train Acc: 0.8966
 Site-Real                      (2) | Train Loss: 0.2202 | Train Acc: 0.9565
 Site-Real                      (2) | Train Loss: 0.2923 | Train Acc: 0.9324
 Site-Real                      (2) | Train Loss: 0.2367 | Train Acc: 0.9580
 Site-Real                      (2) | Train Loss: 0.2653 | Train Acc: 0.9581
 Site-Real                      (1) | Train Loss: 0.2924 | Train Acc: 0.9477
 Site-Painting                  (1) | Train Loss: 0.5134 | Train Acc: 0.8302
 Site-Painting                  (1) | Train Loss: 0.4513 | Train Acc: 0.8941
 Site-Painting                  (1) | Train Loss: 0.4979 | Train Acc: 0.8676
 Site-Painting                  (1) | Train Loss: 0.3808 | Train Acc: 0.9124
 Site-Sketch                    (1) | Train Loss: 0.4448 | Train Acc: 0.8475
 Site-Sketch                    (3) | Train Loss: 0.5990 | Train Acc: 0.8211
 Site-Sketch                    (3) | Train Loss: 0.5854 | Train Acc: 0.7961
 Site-QuickDraw                 (0) | Train Loss: 1.2196 | Train Acc: 0.6301
 Site-QuickDraw                 (0) | Train Loss: 1.1553 | Train Acc: 0.6441
 Site-Infograph                 (1) | Train Loss: 1.4557 | Train Acc: 0.5000
Average Train Accuracy: 0.8597
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:18 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9286
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9111
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8472
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9397
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8871
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8725
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9140
 Best site-Real                      | Epoch:18 | Val Acc: 0.7778
 Best site-Real                      | Epoch:18 | Val Acc: 0.8966
 Best site-Real                      | Epoch:18 | Val Acc: 0.9565
 Best site-Real                      | Epoch:18 | Val Acc: 0.9324
 Best site-Real                      | Epoch:18 | Val Acc: 0.9580
 Best site-Real                      | Epoch:18 | Val Acc: 0.9581
 Best site-Real                      | Epoch:18 | Val Acc: 0.9477
 Best site-Painting                  | Epoch:18 | Val Acc: 0.8302
 Best site-Painting                  | Epoch:18 | Val Acc: 0.8941
 Best site-Painting                  | Epoch:18 | Val Acc: 0.8676
 Best site-Painting                  | Epoch:18 | Val Acc: 0.9124
 Best site-Sketch                    | Epoch:18 | Val Acc: 0.8475
 Best site-Sketch                    | Epoch:18 | Val Acc: 0.8211
 Best site-Sketch                    | Epoch:18 | Val Acc: 0.7961
 Best site-QuickDraw                 | Epoch:18 | Val Acc: 0.6301
 Best site-QuickDraw                 | Epoch:18 | Val Acc: 0.6441
 Best site-Infograph                 | Epoch:18 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 19 ============
cnt=[7, 2, 8, 4, 1, 5, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (3) | Train Loss: 0.8101 | Train Acc: 0.6667
 Site-Clipart                   (0) | Train Loss: 0.3440 | Train Acc: 0.9091
 Site-Clipart                   (4) | Train Loss: 0.1398 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.5084 | Train Acc: 0.8571
 Site-Clipart                   (0) | Train Loss: 0.5293 | Train Acc: 0.9111
 Site-Clipart                   (3) | Train Loss: 0.4333 | Train Acc: 0.8611
 Site-Clipart                   (0) | Train Loss: 0.3276 | Train Acc: 0.9138
 Site-Clipart                   (3) | Train Loss: 0.4978 | Train Acc: 0.8602
 Site-Clipart                   (0) | Train Loss: 0.4025 | Train Acc: 0.8826
 Site-Clipart                   (0) | Train Loss: 0.4022 | Train Acc: 0.9015
 Site-Real                      (2) | Train Loss: 0.6332 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.3414 | Train Acc: 0.9310
 Site-Real                      (2) | Train Loss: 0.2049 | Train Acc: 0.9783
 Site-Real                      (2) | Train Loss: 0.3164 | Train Acc: 0.9189
 Site-Real                      (2) | Train Loss: 0.2324 | Train Acc: 0.9664
 Site-Real                      (2) | Train Loss: 0.2581 | Train Acc: 0.9424
 Site-Real                      (2) | Train Loss: 0.2895 | Train Acc: 0.9412
 Site-Painting                  (5) | Train Loss: 0.4977 | Train Acc: 0.8491
 Site-Painting                  (5) | Train Loss: 0.4513 | Train Acc: 0.8706
 Site-Painting                  (5) | Train Loss: 0.4333 | Train Acc: 0.8750
 Site-Painting                  (5) | Train Loss: 0.3686 | Train Acc: 0.9217
 Site-Sketch                    (0) | Train Loss: 0.4210 | Train Acc: 0.8983
 Site-Sketch                    (3) | Train Loss: 0.5545 | Train Acc: 0.8211
 Site-Sketch                    (0) | Train Loss: 0.5606 | Train Acc: 0.7961
 Site-QuickDraw                 (1) | Train Loss: 1.2656 | Train Acc: 0.6849
 Site-QuickDraw                 (1) | Train Loss: 1.1076 | Train Acc: 0.6864
 Site-Infograph                 (5) | Train Loss: 1.3410 | Train Acc: 0.5333
Average Train Accuracy: 0.8576
============ Train epoch 20 ============
cnt=[5, 2, 9, 5, 5, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (2) | Train Loss: 0.8551 | Train Acc: 0.6667
 Site-Clipart                   (2) | Train Loss: 0.5623 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.1810 | Train Acc: 1.0000
 Site-Clipart                   (3) | Train Loss: 0.4942 | Train Acc: 0.9286
 Site-Clipart                   (3) | Train Loss: 0.5197 | Train Acc: 0.9111
 Site-Clipart                   (2) | Train Loss: 0.5239 | Train Acc: 0.8611
 Site-Clipart                   (2) | Train Loss: 0.3672 | Train Acc: 0.9224
 Site-Clipart                   (2) | Train Loss: 0.5088 | Train Acc: 0.8763
 Site-Clipart                   (3) | Train Loss: 0.4113 | Train Acc: 0.8792
 Site-Clipart                   (3) | Train Loss: 0.3817 | Train Acc: 0.9057
 Site-Real                      (5) | Train Loss: 0.6384 | Train Acc: 0.7778
 Site-Real                      (0) | Train Loss: 0.3582 | Train Acc: 0.8966
 Site-Real                      (0) | Train Loss: 0.2664 | Train Acc: 0.9565
 Site-Real                      (4) | Train Loss: 0.3020 | Train Acc: 0.9459
 Site-Real                      (0) | Train Loss: 0.1965 | Train Acc: 0.9748
 Site-Real                      (0) | Train Loss: 0.2440 | Train Acc: 0.9529
 Site-Real                      (4) | Train Loss: 0.2738 | Train Acc: 0.9477
 Site-Painting                  (2) | Train Loss: 0.4046 | Train Acc: 0.9245
 Site-Painting                  (4) | Train Loss: 0.3770 | Train Acc: 0.9412
 Site-Painting                  (4) | Train Loss: 0.4664 | Train Acc: 0.8456
 Site-Painting                  (4) | Train Loss: 0.3750 | Train Acc: 0.9078
 Site-Sketch                    (3) | Train Loss: 0.4396 | Train Acc: 0.8814
 Site-Sketch                    (2) | Train Loss: 0.4834 | Train Acc: 0.8211
 Site-Sketch                    (2) | Train Loss: 0.6342 | Train Acc: 0.7632
 Site-QuickDraw                 (1) | Train Loss: 1.1685 | Train Acc: 0.6712
 Site-QuickDraw                 (1) | Train Loss: 1.1078 | Train Acc: 0.7034
 Site-Infograph                 (0) | Train Loss: 1.3580 | Train Acc: 0.5750
Average Train Accuracy: 0.8647
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:20 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9286
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9111
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8611
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9224
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8763
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8792
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9057
 Best site-Real                      | Epoch:20 | Val Acc: 0.7778
 Best site-Real                      | Epoch:20 | Val Acc: 0.8966
 Best site-Real                      | Epoch:20 | Val Acc: 0.9565
 Best site-Real                      | Epoch:20 | Val Acc: 0.9459
 Best site-Real                      | Epoch:20 | Val Acc: 0.9748
 Best site-Real                      | Epoch:20 | Val Acc: 0.9529
 Best site-Real                      | Epoch:20 | Val Acc: 0.9477
 Best site-Painting                  | Epoch:20 | Val Acc: 0.9245
 Best site-Painting                  | Epoch:20 | Val Acc: 0.9412
 Best site-Painting                  | Epoch:20 | Val Acc: 0.8456
 Best site-Painting                  | Epoch:20 | Val Acc: 0.9078
 Best site-Sketch                    | Epoch:20 | Val Acc: 0.8814
 Best site-Sketch                    | Epoch:20 | Val Acc: 0.8211
 Best site-Sketch                    | Epoch:20 | Val Acc: 0.7632
 Best site-QuickDraw                 | Epoch:20 | Val Acc: 0.6712
 Best site-QuickDraw                 | Epoch:20 | Val Acc: 0.7034
 Best site-Infograph                 | Epoch:20 | Val Acc: 0.5750
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 21 ============
cnt=[2, 2, 5, 6, 11, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (4) | Train Loss: 0.8076 | Train Acc: 0.6667
 Site-Clipart                   (4) | Train Loss: 0.4380 | Train Acc: 0.9091
 Site-Clipart                   (4) | Train Loss: 0.1498 | Train Acc: 1.0000
 Site-Clipart                   (5) | Train Loss: 0.4271 | Train Acc: 0.8929
 Site-Clipart                   (4) | Train Loss: 0.4315 | Train Acc: 0.9333
 Site-Clipart                   (4) | Train Loss: 0.3763 | Train Acc: 0.8750
 Site-Clipart                   (4) | Train Loss: 0.3115 | Train Acc: 0.9224
 Site-Clipart                   (4) | Train Loss: 0.4849 | Train Acc: 0.8656
 Site-Clipart                   (0) | Train Loss: 0.3837 | Train Acc: 0.8792
 Site-Clipart                   (4) | Train Loss: 0.3643 | Train Acc: 0.9161
 Site-Real                      (2) | Train Loss: 0.5998 | Train Acc: 0.8333
 Site-Real                      (2) | Train Loss: 0.4139 | Train Acc: 0.8621
 Site-Real                      (3) | Train Loss: 0.1764 | Train Acc: 0.9565
 Site-Real                      (3) | Train Loss: 0.3292 | Train Acc: 0.9459
 Site-Real                      (2) | Train Loss: 0.2253 | Train Acc: 0.9496
 Site-Real                      (2) | Train Loss: 0.2383 | Train Acc: 0.9529
 Site-Real                      (2) | Train Loss: 0.2539 | Train Acc: 0.9510
 Site-Painting                  (3) | Train Loss: 0.4452 | Train Acc: 0.8679
 Site-Painting                  (3) | Train Loss: 0.4482 | Train Acc: 0.8706
 Site-Painting                  (3) | Train Loss: 0.4264 | Train Acc: 0.8971
 Site-Painting                  (3) | Train Loss: 0.3674 | Train Acc: 0.9217
 Site-Sketch                    (4) | Train Loss: 0.5191 | Train Acc: 0.8305
 Site-Sketch                    (4) | Train Loss: 0.5081 | Train Acc: 0.8211
 Site-Sketch                    (4) | Train Loss: 0.6225 | Train Acc: 0.8026
 Site-QuickDraw                 (1) | Train Loss: 1.1649 | Train Acc: 0.6712
 Site-QuickDraw                 (1) | Train Loss: 1.0790 | Train Acc: 0.6695
 Site-Infograph                 (0) | Train Loss: 1.4034 | Train Acc: 0.5083
Average Train Accuracy: 0.8582
============ Train epoch 22 ============
cnt=[8, 2, 8, 3, 3, 3, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (4) | Train Loss: 0.6221 | Train Acc: 0.8333
 Site-Clipart                   (4) | Train Loss: 0.5246 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.1763 | Train Acc: 0.9412
 Site-Clipart                   (3) | Train Loss: 0.4104 | Train Acc: 0.8571
 Site-Clipart                   (2) | Train Loss: 0.5507 | Train Acc: 0.8667
 Site-Clipart                   (4) | Train Loss: 0.3351 | Train Acc: 0.8750
 Site-Clipart                   (0) | Train Loss: 0.3534 | Train Acc: 0.9310
 Site-Clipart                   (0) | Train Loss: 0.4702 | Train Acc: 0.8763
 Site-Clipart                   (0) | Train Loss: 0.4268 | Train Acc: 0.8893
 Site-Clipart                   (0) | Train Loss: 0.3715 | Train Acc: 0.9140
 Site-Real                      (3) | Train Loss: 0.6206 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.4051 | Train Acc: 0.8966
 Site-Real                      (2) | Train Loss: 0.1864 | Train Acc: 0.9565
 Site-Real                      (2) | Train Loss: 0.2620 | Train Acc: 0.9595
 Site-Real                      (2) | Train Loss: 0.1887 | Train Acc: 0.9664
 Site-Real                      (2) | Train Loss: 0.2308 | Train Acc: 0.9686
 Site-Real                      (2) | Train Loss: 0.2625 | Train Acc: 0.9477
 Site-Painting                  (5) | Train Loss: 0.5051 | Train Acc: 0.8302
 Site-Painting                  (5) | Train Loss: 0.4251 | Train Acc: 0.8471
 Site-Painting                  (2) | Train Loss: 0.5758 | Train Acc: 0.8529
 Site-Painting                  (2) | Train Loss: 0.3449 | Train Acc: 0.9171
 Site-Sketch                    (0) | Train Loss: 0.4330 | Train Acc: 0.8983
 Site-Sketch                    (0) | Train Loss: 0.5309 | Train Acc: 0.8421
 Site-Sketch                    (0) | Train Loss: 0.5585 | Train Acc: 0.8421
 Site-QuickDraw                 (1) | Train Loss: 1.1338 | Train Acc: 0.6575
 Site-QuickDraw                 (1) | Train Loss: 1.0527 | Train Acc: 0.6949
 Site-Infograph                 (5) | Train Loss: 1.3224 | Train Acc: 0.5417
Average Train Accuracy: 0.8646
============ Train epoch 23 ============
cnt=[5, 2, 10, 4, 3, 3, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (2) | Train Loss: 0.8145 | Train Acc: 0.6667
 Site-Clipart                   (5) | Train Loss: 0.5200 | Train Acc: 0.8182
 Site-Clipart                   (2) | Train Loss: 0.2345 | Train Acc: 0.9412
 Site-Clipart                   (5) | Train Loss: 0.4037 | Train Acc: 0.8929
 Site-Clipart                   (5) | Train Loss: 0.3464 | Train Acc: 0.9333
 Site-Clipart                   (2) | Train Loss: 0.5806 | Train Acc: 0.8889
 Site-Clipart                   (2) | Train Loss: 0.3183 | Train Acc: 0.9138
 Site-Clipart                   (2) | Train Loss: 0.4530 | Train Acc: 0.8925
 Site-Clipart                   (2) | Train Loss: 0.3883 | Train Acc: 0.8826
 Site-Clipart                   (2) | Train Loss: 0.3490 | Train Acc: 0.9036
 Site-Real                      (3) | Train Loss: 0.5875 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.3365 | Train Acc: 0.8966
 Site-Real                      (3) | Train Loss: 0.1981 | Train Acc: 0.9348
 Site-Real                      (0) | Train Loss: 0.2525 | Train Acc: 0.9459
 Site-Real                      (3) | Train Loss: 0.2076 | Train Acc: 0.9496
 Site-Real                      (0) | Train Loss: 0.2203 | Train Acc: 0.9634
 Site-Real                      (0) | Train Loss: 0.2578 | Train Acc: 0.9477
 Site-Painting                  (4) | Train Loss: 0.4593 | Train Acc: 0.8491
 Site-Painting                  (4) | Train Loss: 0.4733 | Train Acc: 0.8353
 Site-Painting                  (4) | Train Loss: 0.3534 | Train Acc: 0.8750
 Site-Painting                  (0) | Train Loss: 0.3532 | Train Acc: 0.9171
 Site-Sketch                    (2) | Train Loss: 0.4265 | Train Acc: 0.8983
 Site-Sketch                    (2) | Train Loss: 0.5531 | Train Acc: 0.8000
 Site-Sketch                    (2) | Train Loss: 0.5491 | Train Acc: 0.8158
 Site-QuickDraw                 (1) | Train Loss: 1.0786 | Train Acc: 0.6575
 Site-QuickDraw                 (1) | Train Loss: 0.9658 | Train Acc: 0.7203
 Site-Infograph                 (0) | Train Loss: 1.3559 | Train Acc: 0.5250
Average Train Accuracy: 0.8555
============ Train epoch 24 ============
cnt=[2, 2, 4, 8, 4, 7, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (3) | Train Loss: 0.6852 | Train Acc: 0.8333
 Site-Clipart                   (3) | Train Loss: 0.5022 | Train Acc: 0.9091
 Site-Clipart                   (3) | Train Loss: 0.1451 | Train Acc: 1.0000
 Site-Clipart                   (4) | Train Loss: 0.4539 | Train Acc: 0.9286
 Site-Clipart                   (4) | Train Loss: 0.4258 | Train Acc: 0.9111
 Site-Clipart                   (3) | Train Loss: 0.3769 | Train Acc: 0.8889
 Site-Clipart                   (3) | Train Loss: 0.3031 | Train Acc: 0.9397
 Site-Clipart                   (3) | Train Loss: 0.4732 | Train Acc: 0.8817
 Site-Clipart                   (0) | Train Loss: 0.3416 | Train Acc: 0.9060
 Site-Clipart                   (3) | Train Loss: 0.3353 | Train Acc: 0.9224
 Site-Real                      (2) | Train Loss: 0.5969 | Train Acc: 0.8333
 Site-Real                      (2) | Train Loss: 0.3310 | Train Acc: 0.9310
 Site-Real                      (5) | Train Loss: 0.2507 | Train Acc: 0.9783
 Site-Real                      (5) | Train Loss: 0.3004 | Train Acc: 0.9459
 Site-Real                      (5) | Train Loss: 0.2005 | Train Acc: 0.9664
 Site-Real                      (2) | Train Loss: 0.2268 | Train Acc: 0.9529
 Site-Real                      (2) | Train Loss: 0.2444 | Train Acc: 0.9542
 Site-Painting                  (5) | Train Loss: 0.5225 | Train Acc: 0.8491
 Site-Painting                  (5) | Train Loss: 0.3836 | Train Acc: 0.8706
 Site-Painting                  (5) | Train Loss: 0.3665 | Train Acc: 0.8603
 Site-Painting                  (5) | Train Loss: 0.3263 | Train Acc: 0.9217
 Site-Sketch                    (4) | Train Loss: 0.3821 | Train Acc: 0.8983
 Site-Sketch                    (3) | Train Loss: 0.5471 | Train Acc: 0.8105
 Site-Sketch                    (4) | Train Loss: 0.5576 | Train Acc: 0.8224
 Site-QuickDraw                 (1) | Train Loss: 1.1309 | Train Acc: 0.6849
 Site-QuickDraw                 (1) | Train Loss: 1.0065 | Train Acc: 0.7203
 Site-Infograph                 (0) | Train Loss: 1.4246 | Train Acc: 0.5083
Average Train Accuracy: 0.8752
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:24 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9286
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9111
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8889
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9397
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8817
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9060
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9224
 Best site-Real                      | Epoch:24 | Val Acc: 0.8333
 Best site-Real                      | Epoch:24 | Val Acc: 0.9310
 Best site-Real                      | Epoch:24 | Val Acc: 0.9783
 Best site-Real                      | Epoch:24 | Val Acc: 0.9459
 Best site-Real                      | Epoch:24 | Val Acc: 0.9664
 Best site-Real                      | Epoch:24 | Val Acc: 0.9529
 Best site-Real                      | Epoch:24 | Val Acc: 0.9542
 Best site-Painting                  | Epoch:24 | Val Acc: 0.8491
 Best site-Painting                  | Epoch:24 | Val Acc: 0.8706
 Best site-Painting                  | Epoch:24 | Val Acc: 0.8603
 Best site-Painting                  | Epoch:24 | Val Acc: 0.9217
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.8983
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.8105
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.8224
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.6849
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.7203
 Best site-Infograph                 | Epoch:24 | Val Acc: 0.5083
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 25 ============
cnt=[5, 2, 6, 12, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (3) | Train Loss: 0.7424 | Train Acc: 0.6667
 Site-Clipart                   (3) | Train Loss: 0.4356 | Train Acc: 0.9091
 Site-Clipart                   (3) | Train Loss: 0.1896 | Train Acc: 0.9412
 Site-Clipart                   (5) | Train Loss: 0.4309 | Train Acc: 0.8929
 Site-Clipart                   (3) | Train Loss: 0.3181 | Train Acc: 0.9556
 Site-Clipart                   (3) | Train Loss: 0.3811 | Train Acc: 0.8750
 Site-Clipart                   (3) | Train Loss: 0.2957 | Train Acc: 0.9483
 Site-Clipart                   (3) | Train Loss: 0.4489 | Train Acc: 0.8656
 Site-Clipart                   (3) | Train Loss: 0.3551 | Train Acc: 0.8960
 Site-Clipart                   (3) | Train Loss: 0.3567 | Train Acc: 0.9119
 Site-Real                      (4) | Train Loss: 0.5568 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.3646 | Train Acc: 0.8966
 Site-Real                      (2) | Train Loss: 0.2189 | Train Acc: 0.9565
 Site-Real                      (0) | Train Loss: 0.3089 | Train Acc: 0.9595
 Site-Real                      (2) | Train Loss: 0.2064 | Train Acc: 0.9580
 Site-Real                      (2) | Train Loss: 0.2265 | Train Acc: 0.9529
 Site-Real                      (2) | Train Loss: 0.2418 | Train Acc: 0.9379
 Site-Painting                  (0) | Train Loss: 0.4429 | Train Acc: 0.8679
 Site-Painting                  (0) | Train Loss: 0.3757 | Train Acc: 0.8941
 Site-Painting                  (2) | Train Loss: 0.4334 | Train Acc: 0.8897
 Site-Painting                  (0) | Train Loss: 0.3134 | Train Acc: 0.9263
 Site-Sketch                    (3) | Train Loss: 0.4320 | Train Acc: 0.8814
 Site-Sketch                    (3) | Train Loss: 0.4852 | Train Acc: 0.8316
 Site-Sketch                    (3) | Train Loss: 0.5826 | Train Acc: 0.7829
 Site-QuickDraw                 (1) | Train Loss: 0.9010 | Train Acc: 0.7397
 Site-QuickDraw                 (1) | Train Loss: 0.9606 | Train Acc: 0.7373
 Site-Infograph                 (0) | Train Loss: 1.3515 | Train Acc: 0.5417
Average Train Accuracy: 0.8664
============ Train epoch 26 ============
cnt=[6, 2, 7, 4, 2, 6, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (4) | Train Loss: 0.8348 | Train Acc: 0.6667
 Site-Clipart                   (4) | Train Loss: 0.5044 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.1746 | Train Acc: 1.0000
 Site-Clipart                   (3) | Train Loss: 0.4498 | Train Acc: 0.8214
 Site-Clipart                   (2) | Train Loss: 0.4592 | Train Acc: 0.9333
 Site-Clipart                   (2) | Train Loss: 0.3844 | Train Acc: 0.8611
 Site-Clipart                   (2) | Train Loss: 0.3045 | Train Acc: 0.9224
 Site-Clipart                   (2) | Train Loss: 0.4526 | Train Acc: 0.8763
 Site-Clipart                   (2) | Train Loss: 0.3395 | Train Acc: 0.8960
 Site-Clipart                   (3) | Train Loss: 0.3477 | Train Acc: 0.9140
 Site-Real                      (5) | Train Loss: 0.5581 | Train Acc: 0.7778
 Site-Real                      (5) | Train Loss: 0.3417 | Train Acc: 0.9310
 Site-Real                      (5) | Train Loss: 0.2719 | Train Acc: 0.9565
 Site-Real                      (0) | Train Loss: 0.2105 | Train Acc: 0.9595
 Site-Real                      (5) | Train Loss: 0.1845 | Train Acc: 0.9496
 Site-Real                      (5) | Train Loss: 0.2127 | Train Acc: 0.9529
 Site-Real                      (5) | Train Loss: 0.2506 | Train Acc: 0.9444
 Site-Painting                  (0) | Train Loss: 0.4532 | Train Acc: 0.8491
 Site-Painting                  (0) | Train Loss: 0.3542 | Train Acc: 0.9176
 Site-Painting                  (0) | Train Loss: 0.3954 | Train Acc: 0.8676
 Site-Painting                  (0) | Train Loss: 0.3128 | Train Acc: 0.9263
 Site-Sketch                    (3) | Train Loss: 0.4016 | Train Acc: 0.8644
 Site-Sketch                    (2) | Train Loss: 0.4158 | Train Acc: 0.8632
 Site-Sketch                    (3) | Train Loss: 0.5802 | Train Acc: 0.8158
 Site-QuickDraw                 (1) | Train Loss: 0.9242 | Train Acc: 0.7671
 Site-QuickDraw                 (1) | Train Loss: 0.9724 | Train Acc: 0.6780
 Site-Infograph                 (0) | Train Loss: 1.3225 | Train Acc: 0.5333
Average Train Accuracy: 0.8650
============ Train epoch 27 ============
cnt=[4, 2, 9, 2, 6, 4, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (2) | Train Loss: 0.7806 | Train Acc: 0.6667
 Site-Clipart                   (2) | Train Loss: 0.2628 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.2820 | Train Acc: 0.9412
 Site-Clipart                   (0) | Train Loss: 0.3941 | Train Acc: 0.9643
 Site-Clipart                   (0) | Train Loss: 0.3931 | Train Acc: 0.9333
 Site-Clipart                   (2) | Train Loss: 0.3641 | Train Acc: 0.9306
 Site-Clipart                   (2) | Train Loss: 0.2783 | Train Acc: 0.9224
 Site-Clipart                   (2) | Train Loss: 0.4291 | Train Acc: 0.8871
 Site-Clipart                   (2) | Train Loss: 0.3373 | Train Acc: 0.8993
 Site-Clipart                   (2) | Train Loss: 0.3398 | Train Acc: 0.9245
 Site-Real                      (3) | Train Loss: 0.5772 | Train Acc: 0.7778
 Site-Real                      (3) | Train Loss: 0.3076 | Train Acc: 0.8966
 Site-Real                      (4) | Train Loss: 0.1557 | Train Acc: 0.9565
 Site-Real                      (4) | Train Loss: 0.3440 | Train Acc: 0.9595
 Site-Real                      (4) | Train Loss: 0.1779 | Train Acc: 0.9580
 Site-Real                      (4) | Train Loss: 0.2186 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2224 | Train Acc: 0.9444
 Site-Painting                  (5) | Train Loss: 0.4129 | Train Acc: 0.8491
 Site-Painting                  (5) | Train Loss: 0.4087 | Train Acc: 0.8706
 Site-Painting                  (5) | Train Loss: 0.3826 | Train Acc: 0.8971
 Site-Painting                  (5) | Train Loss: 0.3262 | Train Acc: 0.9217
 Site-Sketch                    (0) | Train Loss: 0.3753 | Train Acc: 0.8814
 Site-Sketch                    (0) | Train Loss: 0.4627 | Train Acc: 0.8632
 Site-Sketch                    (2) | Train Loss: 0.5117 | Train Acc: 0.8158
 Site-QuickDraw                 (1) | Train Loss: 1.0331 | Train Acc: 0.7260
 Site-QuickDraw                 (1) | Train Loss: 0.9477 | Train Acc: 0.6780
 Site-Infograph                 (4) | Train Loss: 1.3260 | Train Acc: 0.5500
Average Train Accuracy: 0.8693
============ Train epoch 28 ============
cnt=[2, 7, 9, 5, 2, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (4) | Train Loss: 0.6569 | Train Acc: 0.8333
 Site-Clipart                   (4) | Train Loss: 0.3233 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.1244 | Train Acc: 1.0000
 Site-Clipart                   (5) | Train Loss: 0.4018 | Train Acc: 0.8571
 Site-Clipart                   (5) | Train Loss: 0.3976 | Train Acc: 0.9333
 Site-Clipart                   (2) | Train Loss: 0.4095 | Train Acc: 0.8889
 Site-Clipart                   (2) | Train Loss: 0.2837 | Train Acc: 0.9224
 Site-Clipart                   (2) | Train Loss: 0.4201 | Train Acc: 0.8817
 Site-Clipart                   (2) | Train Loss: 0.3850 | Train Acc: 0.8826
 Site-Clipart                   (2) | Train Loss: 0.3165 | Train Acc: 0.9182
 Site-Real                      (1) | Train Loss: 0.5824 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.3548 | Train Acc: 0.8966
 Site-Real                      (3) | Train Loss: 0.1439 | Train Acc: 0.9783
 Site-Real                      (1) | Train Loss: 0.2468 | Train Acc: 0.9324
 Site-Real                      (3) | Train Loss: 0.1818 | Train Acc: 0.9580
 Site-Real                      (3) | Train Loss: 0.1988 | Train Acc: 0.9424
 Site-Real                      (1) | Train Loss: 0.2353 | Train Acc: 0.9510
 Site-Painting                  (1) | Train Loss: 0.3689 | Train Acc: 0.8679
 Site-Painting                  (1) | Train Loss: 0.3324 | Train Acc: 0.9059
 Site-Painting                  (1) | Train Loss: 0.3806 | Train Acc: 0.9044
 Site-Painting                  (1) | Train Loss: 0.3443 | Train Acc: 0.9171
 Site-Sketch                    (2) | Train Loss: 0.4136 | Train Acc: 0.8644
 Site-Sketch                    (2) | Train Loss: 0.4427 | Train Acc: 0.8526
 Site-Sketch                    (2) | Train Loss: 0.5154 | Train Acc: 0.8553
 Site-QuickDraw                 (0) | Train Loss: 0.8930 | Train Acc: 0.7534
 Site-QuickDraw                 (0) | Train Loss: 0.8686 | Train Acc: 0.7542
 Site-Infograph                 (3) | Train Loss: 1.2652 | Train Acc: 0.5667
Average Train Accuracy: 0.8800
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:28 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.8889
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.9224
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.8817
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.8826
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.9182
 Best site-Real                      | Epoch:28 | Val Acc: 0.8333
 Best site-Real                      | Epoch:28 | Val Acc: 0.8966
 Best site-Real                      | Epoch:28 | Val Acc: 0.9783
 Best site-Real                      | Epoch:28 | Val Acc: 0.9324
 Best site-Real                      | Epoch:28 | Val Acc: 0.9580
 Best site-Real                      | Epoch:28 | Val Acc: 0.9424
 Best site-Real                      | Epoch:28 | Val Acc: 0.9510
 Best site-Painting                  | Epoch:28 | Val Acc: 0.8679
 Best site-Painting                  | Epoch:28 | Val Acc: 0.9059
 Best site-Painting                  | Epoch:28 | Val Acc: 0.9044
 Best site-Painting                  | Epoch:28 | Val Acc: 0.9171
 Best site-Sketch                    | Epoch:28 | Val Acc: 0.8644
 Best site-Sketch                    | Epoch:28 | Val Acc: 0.8526
 Best site-Sketch                    | Epoch:28 | Val Acc: 0.8553
 Best site-QuickDraw                 | Epoch:28 | Val Acc: 0.7534
 Best site-QuickDraw                 | Epoch:28 | Val Acc: 0.7542
 Best site-Infograph                 | Epoch:28 | Val Acc: 0.5667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 29 ============
cnt=[5, 2, 6, 12, 1, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (3) | Train Loss: 0.7440 | Train Acc: 0.6667
 Site-Clipart                   (3) | Train Loss: 0.3427 | Train Acc: 0.9091
 Site-Clipart                   (3) | Train Loss: 0.2190 | Train Acc: 0.9412
 Site-Clipart                   (5) | Train Loss: 0.3956 | Train Acc: 0.8571
 Site-Clipart                   (3) | Train Loss: 0.4264 | Train Acc: 0.9111
 Site-Clipart                   (3) | Train Loss: 0.4658 | Train Acc: 0.8750
 Site-Clipart                   (3) | Train Loss: 0.2547 | Train Acc: 0.9224
 Site-Clipart                   (3) | Train Loss: 0.4136 | Train Acc: 0.8925
 Site-Clipart                   (3) | Train Loss: 0.3632 | Train Acc: 0.8960
 Site-Clipart                   (3) | Train Loss: 0.3100 | Train Acc: 0.9287
 Site-Real                      (2) | Train Loss: 0.5836 | Train Acc: 0.8333
 Site-Real                      (4) | Train Loss: 0.2771 | Train Acc: 0.9310
 Site-Real                      (2) | Train Loss: 0.2000 | Train Acc: 0.9783
 Site-Real                      (0) | Train Loss: 0.2411 | Train Acc: 0.9595
 Site-Real                      (2) | Train Loss: 0.1918 | Train Acc: 0.9580
 Site-Real                      (2) | Train Loss: 0.2126 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.2261 | Train Acc: 0.9510
 Site-Painting                  (0) | Train Loss: 0.5186 | Train Acc: 0.8491
 Site-Painting                  (0) | Train Loss: 0.3826 | Train Acc: 0.8941
 Site-Painting                  (0) | Train Loss: 0.3230 | Train Acc: 0.9044
 Site-Painting                  (0) | Train Loss: 0.3005 | Train Acc: 0.9171
 Site-Sketch                    (3) | Train Loss: 0.3491 | Train Acc: 0.8983
 Site-Sketch                    (3) | Train Loss: 0.4731 | Train Acc: 0.8421
 Site-Sketch                    (3) | Train Loss: 0.4969 | Train Acc: 0.8355
 Site-QuickDraw                 (1) | Train Loss: 1.0024 | Train Acc: 0.7534
 Site-QuickDraw                 (1) | Train Loss: 0.9261 | Train Acc: 0.7542
 Site-Infograph                 (2) | Train Loss: 1.2604 | Train Acc: 0.6500
Average Train Accuracy: 0.8762
============ Train epoch 30 ============
cnt=[10, 2, 6, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (3) | Train Loss: 0.9028 | Train Acc: 0.6667
 Site-Clipart                   (3) | Train Loss: 0.4454 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.2016 | Train Acc: 0.9412
 Site-Clipart                   (2) | Train Loss: 0.4100 | Train Acc: 0.8929
 Site-Clipart                   (0) | Train Loss: 0.3357 | Train Acc: 0.9333
 Site-Clipart                   (0) | Train Loss: 0.3958 | Train Acc: 0.8750
 Site-Clipart                   (0) | Train Loss: 0.2799 | Train Acc: 0.9138
 Site-Clipart                   (0) | Train Loss: 0.4123 | Train Acc: 0.8763
 Site-Clipart                   (0) | Train Loss: 0.3268 | Train Acc: 0.8960
 Site-Clipart                   (0) | Train Loss: 0.3009 | Train Acc: 0.9371
 Site-Real                      (2) | Train Loss: 0.6108 | Train Acc: 0.7778
 Site-Real                      (5) | Train Loss: 0.2979 | Train Acc: 0.9310
 Site-Real                      (2) | Train Loss: 0.1862 | Train Acc: 0.9783
 Site-Real                      (4) | Train Loss: 0.2268 | Train Acc: 0.9459
 Site-Real                      (2) | Train Loss: 0.1708 | Train Acc: 0.9664
 Site-Real                      (2) | Train Loss: 0.1919 | Train Acc: 0.9634
 Site-Real                      (2) | Train Loss: 0.2380 | Train Acc: 0.9314
 Site-Painting                  (4) | Train Loss: 0.3717 | Train Acc: 0.9057
 Site-Painting                  (4) | Train Loss: 0.3466 | Train Acc: 0.9412
 Site-Painting                  (4) | Train Loss: 0.3762 | Train Acc: 0.8971
 Site-Painting                  (4) | Train Loss: 0.2911 | Train Acc: 0.9171
 Site-Sketch                    (0) | Train Loss: 0.3226 | Train Acc: 0.9153
 Site-Sketch                    (0) | Train Loss: 0.4929 | Train Acc: 0.8211
 Site-Sketch                    (0) | Train Loss: 0.5317 | Train Acc: 0.8158
 Site-QuickDraw                 (1) | Train Loss: 0.9504 | Train Acc: 0.6849
 Site-QuickDraw                 (1) | Train Loss: 0.8449 | Train Acc: 0.7627
 Site-Infograph                 (4) | Train Loss: 1.3242 | Train Acc: 0.5583
Average Train Accuracy: 0.8724
============ Train epoch 31 ============
cnt=[9, 2, 9, 1, 3, 3, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (0) | Train Loss: 0.7294 | Train Acc: 0.8333
 Site-Clipart                   (3) | Train Loss: 0.3059 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.2073 | Train Acc: 0.9412
 Site-Clipart                   (4) | Train Loss: 0.3877 | Train Acc: 0.8929
 Site-Clipart                   (4) | Train Loss: 0.3861 | Train Acc: 0.9333
 Site-Clipart                   (0) | Train Loss: 0.3346 | Train Acc: 0.8750
 Site-Clipart                   (0) | Train Loss: 0.2754 | Train Acc: 0.9138
 Site-Clipart                   (0) | Train Loss: 0.4280 | Train Acc: 0.8871
 Site-Clipart                   (0) | Train Loss: 0.2895 | Train Acc: 0.9362
 Site-Clipart                   (0) | Train Loss: 0.2939 | Train Acc: 0.9287
 Site-Real                      (5) | Train Loss: 0.5364 | Train Acc: 0.7778
 Site-Real                      (5) | Train Loss: 0.3056 | Train Acc: 0.9310
 Site-Real                      (2) | Train Loss: 0.1637 | Train Acc: 0.9565
 Site-Real                      (2) | Train Loss: 0.2169 | Train Acc: 0.9459
 Site-Real                      (2) | Train Loss: 0.1825 | Train Acc: 0.9580
 Site-Real                      (2) | Train Loss: 0.2252 | Train Acc: 0.9476
 Site-Real                      (5) | Train Loss: 0.2256 | Train Acc: 0.9477
 Site-Painting                  (2) | Train Loss: 0.4547 | Train Acc: 0.8679
 Site-Painting                  (2) | Train Loss: 0.3631 | Train Acc: 0.9059
 Site-Painting                  (2) | Train Loss: 0.2969 | Train Acc: 0.9191
 Site-Painting                  (2) | Train Loss: 0.2734 | Train Acc: 0.9309
 Site-Sketch                    (4) | Train Loss: 0.3397 | Train Acc: 0.8983
 Site-Sketch                    (0) | Train Loss: 0.4536 | Train Acc: 0.8632
 Site-Sketch                    (0) | Train Loss: 0.5780 | Train Acc: 0.7961
 Site-QuickDraw                 (1) | Train Loss: 0.9025 | Train Acc: 0.7260
 Site-QuickDraw                 (1) | Train Loss: 0.8807 | Train Acc: 0.7034
 Site-Infograph                 (2) | Train Loss: 1.2487 | Train Acc: 0.5833
Average Train Accuracy: 0.8781
============ Train epoch 32 ============
cnt=[2, 12, 4, 1, 2, 6, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (3) | Train Loss: 0.6821 | Train Acc: 0.8333
 Site-Clipart                   (1) | Train Loss: 0.5081 | Train Acc: 0.8182
 Site-Clipart                   (1) | Train Loss: 0.1034 | Train Acc: 1.0000
 Site-Clipart                   (1) | Train Loss: 0.3496 | Train Acc: 0.8929
 Site-Clipart                   (1) | Train Loss: 0.3009 | Train Acc: 0.9333
 Site-Clipart                   (1) | Train Loss: 0.3432 | Train Acc: 0.9167
 Site-Clipart                   (1) | Train Loss: 0.2495 | Train Acc: 0.9483
 Site-Clipart                   (1) | Train Loss: 0.4421 | Train Acc: 0.8871
 Site-Clipart                   (1) | Train Loss: 0.3210 | Train Acc: 0.9060
 Site-Clipart                   (1) | Train Loss: 0.3048 | Train Acc: 0.9161
 Site-Real                      (4) | Train Loss: 0.5332 | Train Acc: 0.7778
 Site-Real                      (4) | Train Loss: 0.3072 | Train Acc: 0.9310
 Site-Real                      (2) | Train Loss: 0.1252 | Train Acc: 0.9783
 Site-Real                      (5) | Train Loss: 0.2320 | Train Acc: 0.9189
 Site-Real                      (2) | Train Loss: 0.1799 | Train Acc: 0.9580
 Site-Real                      (2) | Train Loss: 0.1843 | Train Acc: 0.9581
 Site-Real                      (5) | Train Loss: 0.2286 | Train Acc: 0.9542
 Site-Painting                  (5) | Train Loss: 0.4529 | Train Acc: 0.8679
 Site-Painting                  (5) | Train Loss: 0.3006 | Train Acc: 0.9176
 Site-Painting                  (5) | Train Loss: 0.3500 | Train Acc: 0.8750
 Site-Painting                  (5) | Train Loss: 0.2670 | Train Acc: 0.9447
 Site-Sketch                    (1) | Train Loss: 0.3518 | Train Acc: 0.9322
 Site-Sketch                    (1) | Train Loss: 0.3929 | Train Acc: 0.8737
 Site-Sketch                    (1) | Train Loss: 0.5313 | Train Acc: 0.8224
 Site-QuickDraw                 (0) | Train Loss: 0.8401 | Train Acc: 0.7808
 Site-QuickDraw                 (0) | Train Loss: 0.8686 | Train Acc: 0.7712
 Site-Infograph                 (2) | Train Loss: 1.2648 | Train Acc: 0.6000
Average Train Accuracy: 0.8857
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.8182
 Best site-Clipart                   | Epoch:32 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.8929
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.9167
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.9483
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.8871
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.9060
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.9161
 Best site-Real                      | Epoch:32 | Val Acc: 0.7778
 Best site-Real                      | Epoch:32 | Val Acc: 0.9310
 Best site-Real                      | Epoch:32 | Val Acc: 0.9783
 Best site-Real                      | Epoch:32 | Val Acc: 0.9189
 Best site-Real                      | Epoch:32 | Val Acc: 0.9580
 Best site-Real                      | Epoch:32 | Val Acc: 0.9581
 Best site-Real                      | Epoch:32 | Val Acc: 0.9542
 Best site-Painting                  | Epoch:32 | Val Acc: 0.8679
 Best site-Painting                  | Epoch:32 | Val Acc: 0.9176
 Best site-Painting                  | Epoch:32 | Val Acc: 0.8750
 Best site-Painting                  | Epoch:32 | Val Acc: 0.9447
 Best site-Sketch                    | Epoch:32 | Val Acc: 0.9322
 Best site-Sketch                    | Epoch:32 | Val Acc: 0.8737
 Best site-Sketch                    | Epoch:32 | Val Acc: 0.8224
 Best site-QuickDraw                 | Epoch:32 | Val Acc: 0.7808
 Best site-QuickDraw                 | Epoch:32 | Val Acc: 0.7712
 Best site-Infograph                 | Epoch:32 | Val Acc: 0.6000
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 33 ============
cnt=[10, 2, 5, 3, 2, 5, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (3) | Train Loss: 0.8462 | Train Acc: 0.6667
 Site-Clipart                   (5) | Train Loss: 0.5412 | Train Acc: 0.9091
 Site-Clipart                   (5) | Train Loss: 0.0930 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.3588 | Train Acc: 0.8571
 Site-Clipart                   (2) | Train Loss: 0.3447 | Train Acc: 0.8889
 Site-Clipart                   (3) | Train Loss: 0.3808 | Train Acc: 0.8889
 Site-Clipart                   (5) | Train Loss: 0.2609 | Train Acc: 0.9569
 Site-Clipart                   (5) | Train Loss: 0.3728 | Train Acc: 0.8925
 Site-Clipart                   (5) | Train Loss: 0.3131 | Train Acc: 0.9060
 Site-Clipart                   (3) | Train Loss: 0.2929 | Train Acc: 0.9182
 Site-Real                      (0) | Train Loss: 0.5943 | Train Acc: 0.7778
 Site-Real                      (4) | Train Loss: 0.3770 | Train Acc: 0.8621
 Site-Real                      (0) | Train Loss: 0.1543 | Train Acc: 0.9783
 Site-Real                      (0) | Train Loss: 0.3245 | Train Acc: 0.9595
 Site-Real                      (0) | Train Loss: 0.1787 | Train Acc: 0.9412
 Site-Real                      (0) | Train Loss: 0.2081 | Train Acc: 0.9529
 Site-Real                      (4) | Train Loss: 0.2113 | Train Acc: 0.9412
 Site-Painting                  (0) | Train Loss: 0.5002 | Train Acc: 0.8679
 Site-Painting                  (0) | Train Loss: 0.3856 | Train Acc: 0.8706
 Site-Painting                  (0) | Train Loss: 0.3695 | Train Acc: 0.9191
 Site-Painting                  (0) | Train Loss: 0.2879 | Train Acc: 0.9124
 Site-Sketch                    (2) | Train Loss: 0.3540 | Train Acc: 0.8814
 Site-Sketch                    (2) | Train Loss: 0.4095 | Train Acc: 0.8737
 Site-Sketch                    (2) | Train Loss: 0.5237 | Train Acc: 0.8355
 Site-QuickDraw                 (1) | Train Loss: 1.0273 | Train Acc: 0.7260
 Site-QuickDraw                 (1) | Train Loss: 0.7974 | Train Acc: 0.7542
 Site-Infograph                 (0) | Train Loss: 1.2158 | Train Acc: 0.6167
Average Train Accuracy: 0.8724
============ Train epoch 34 ============
cnt=[8, 2, 5, 6, 5, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (0) | Train Loss: 0.9148 | Train Acc: 0.6667
 Site-Clipart                   (0) | Train Loss: 0.3627 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.1636 | Train Acc: 1.0000
 Site-Clipart                   (4) | Train Loss: 0.3848 | Train Acc: 0.8929
 Site-Clipart                   (4) | Train Loss: 0.3497 | Train Acc: 0.9556
 Site-Clipart                   (0) | Train Loss: 0.3276 | Train Acc: 0.9306
 Site-Clipart                   (0) | Train Loss: 0.2622 | Train Acc: 0.9397
 Site-Clipart                   (0) | Train Loss: 0.4229 | Train Acc: 0.8817
 Site-Clipart                   (0) | Train Loss: 0.3520 | Train Acc: 0.8960
 Site-Clipart                   (0) | Train Loss: 0.2894 | Train Acc: 0.9161
 Site-Real                      (3) | Train Loss: 0.5597 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.3177 | Train Acc: 0.8966
 Site-Real                      (3) | Train Loss: 0.1819 | Train Acc: 0.9783
 Site-Real                      (3) | Train Loss: 0.2018 | Train Acc: 0.9595
 Site-Real                      (3) | Train Loss: 0.1601 | Train Acc: 0.9580
 Site-Real                      (3) | Train Loss: 0.1669 | Train Acc: 0.9738
 Site-Real                      (2) | Train Loss: 0.2389 | Train Acc: 0.9444
 Site-Painting                  (2) | Train Loss: 0.3699 | Train Acc: 0.8868
 Site-Painting                  (2) | Train Loss: 0.2957 | Train Acc: 0.9412
 Site-Painting                  (2) | Train Loss: 0.3125 | Train Acc: 0.9118
 Site-Painting                  (2) | Train Loss: 0.2857 | Train Acc: 0.9309
 Site-Sketch                    (4) | Train Loss: 0.4185 | Train Acc: 0.8644
 Site-Sketch                    (4) | Train Loss: 0.4916 | Train Acc: 0.8421
 Site-Sketch                    (4) | Train Loss: 0.5214 | Train Acc: 0.8355
 Site-QuickDraw                 (1) | Train Loss: 0.8841 | Train Acc: 0.7671
 Site-QuickDraw                 (1) | Train Loss: 0.8216 | Train Acc: 0.7797
 Site-Infograph                 (5) | Train Loss: 1.1413 | Train Acc: 0.6333
Average Train Accuracy: 0.8861
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.8929
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.9556
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.9306
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.9397
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.8817
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.8960
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.9161
 Best site-Real                      | Epoch:34 | Val Acc: 0.8333
 Best site-Real                      | Epoch:34 | Val Acc: 0.8966
 Best site-Real                      | Epoch:34 | Val Acc: 0.9783
 Best site-Real                      | Epoch:34 | Val Acc: 0.9595
 Best site-Real                      | Epoch:34 | Val Acc: 0.9580
 Best site-Real                      | Epoch:34 | Val Acc: 0.9738
 Best site-Real                      | Epoch:34 | Val Acc: 0.9444
 Best site-Painting                  | Epoch:34 | Val Acc: 0.8868
 Best site-Painting                  | Epoch:34 | Val Acc: 0.9412
 Best site-Painting                  | Epoch:34 | Val Acc: 0.9118
 Best site-Painting                  | Epoch:34 | Val Acc: 0.9309
 Best site-Sketch                    | Epoch:34 | Val Acc: 0.8644
 Best site-Sketch                    | Epoch:34 | Val Acc: 0.8421
 Best site-Sketch                    | Epoch:34 | Val Acc: 0.8355
 Best site-QuickDraw                 | Epoch:34 | Val Acc: 0.7671
 Best site-QuickDraw                 | Epoch:34 | Val Acc: 0.7797
 Best site-Infograph                 | Epoch:34 | Val Acc: 0.6333
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 35 ============
cnt=[7, 2, 4, 6, 6, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (0) | Train Loss: 0.7910 | Train Acc: 0.6667
 Site-Clipart                   (0) | Train Loss: 0.4582 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.1186 | Train Acc: 0.9412
 Site-Clipart                   (4) | Train Loss: 0.4238 | Train Acc: 0.8571
 Site-Clipart                   (4) | Train Loss: 0.4067 | Train Acc: 0.8889
 Site-Clipart                   (0) | Train Loss: 0.3009 | Train Acc: 0.8889
 Site-Clipart                   (0) | Train Loss: 0.2814 | Train Acc: 0.9052
 Site-Clipart                   (4) | Train Loss: 0.3534 | Train Acc: 0.8978
 Site-Clipart                   (0) | Train Loss: 0.3235 | Train Acc: 0.9094
 Site-Clipart                   (0) | Train Loss: 0.2888 | Train Acc: 0.9350
 Site-Real                      (5) | Train Loss: 0.5683 | Train Acc: 0.7778
 Site-Real                      (3) | Train Loss: 0.3030 | Train Acc: 0.8966
 Site-Real                      (5) | Train Loss: 0.1752 | Train Acc: 0.9565
 Site-Real                      (3) | Train Loss: 0.1986 | Train Acc: 0.9324
 Site-Real                      (3) | Train Loss: 0.1491 | Train Acc: 0.9748
 Site-Real                      (3) | Train Loss: 0.2098 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.2381 | Train Acc: 0.9477
 Site-Painting                  (2) | Train Loss: 0.4385 | Train Acc: 0.8491
 Site-Painting                  (2) | Train Loss: 0.3451 | Train Acc: 0.9059
 Site-Painting                  (2) | Train Loss: 0.4093 | Train Acc: 0.8750
 Site-Painting                  (2) | Train Loss: 0.3185 | Train Acc: 0.9309
 Site-Sketch                    (4) | Train Loss: 0.3178 | Train Acc: 0.9322
 Site-Sketch                    (4) | Train Loss: 0.4162 | Train Acc: 0.8526
 Site-Sketch                    (4) | Train Loss: 0.5315 | Train Acc: 0.8158
 Site-QuickDraw                 (1) | Train Loss: 0.8039 | Train Acc: 0.7808
 Site-QuickDraw                 (1) | Train Loss: 0.8078 | Train Acc: 0.7458
 Site-Infograph                 (3) | Train Loss: 1.2161 | Train Acc: 0.6083
Average Train Accuracy: 0.8714
============ Train epoch 36 ============
cnt=[6, 2, 7, 4, 4, 4, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (4) | Train Loss: 0.7999 | Train Acc: 0.6667
 Site-Clipart                   (0) | Train Loss: 0.4745 | Train Acc: 0.9091
 Site-Clipart                   (4) | Train Loss: 0.1611 | Train Acc: 0.9412
 Site-Clipart                   (3) | Train Loss: 0.3694 | Train Acc: 0.8929
 Site-Clipart                   (3) | Train Loss: 0.3917 | Train Acc: 0.9111
 Site-Clipart                   (4) | Train Loss: 0.3867 | Train Acc: 0.9028
 Site-Clipart                   (0) | Train Loss: 0.2341 | Train Acc: 0.9483
 Site-Clipart                   (0) | Train Loss: 0.4125 | Train Acc: 0.8871
 Site-Clipart                   (4) | Train Loss: 0.3158 | Train Acc: 0.8993
 Site-Clipart                   (0) | Train Loss: 0.2819 | Train Acc: 0.9266
 Site-Real                      (2) | Train Loss: 0.5567 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.3081 | Train Acc: 0.9310
 Site-Real                      (2) | Train Loss: 0.1603 | Train Acc: 0.9565
 Site-Real                      (5) | Train Loss: 0.2748 | Train Acc: 0.9459
 Site-Real                      (2) | Train Loss: 0.1542 | Train Acc: 0.9748
 Site-Real                      (2) | Train Loss: 0.2055 | Train Acc: 0.9529
 Site-Real                      (2) | Train Loss: 0.2156 | Train Acc: 0.9444
 Site-Painting                  (5) | Train Loss: 0.3829 | Train Acc: 0.8868
 Site-Painting                  (5) | Train Loss: 0.3494 | Train Acc: 0.8588
 Site-Painting                  (5) | Train Loss: 0.2680 | Train Acc: 0.9191
 Site-Painting                  (2) | Train Loss: 0.2689 | Train Acc: 0.9355
 Site-Sketch                    (0) | Train Loss: 0.3103 | Train Acc: 0.9492
 Site-Sketch                    (0) | Train Loss: 0.4790 | Train Acc: 0.8211
 Site-Sketch                    (3) | Train Loss: 0.4755 | Train Acc: 0.8421
 Site-QuickDraw                 (1) | Train Loss: 0.7432 | Train Acc: 0.7945
 Site-QuickDraw                 (1) | Train Loss: 0.8358 | Train Acc: 0.7288
 Site-Infograph                 (2) | Train Loss: 1.1904 | Train Acc: 0.5833
Average Train Accuracy: 0.8794
============ Train epoch 37 ============
cnt=[9, 2, 5, 3, 3, 5, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (4) | Train Loss: 0.8099 | Train Acc: 0.6667
 Site-Clipart                   (4) | Train Loss: 0.3349 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.1759 | Train Acc: 0.9412
 Site-Clipart                   (3) | Train Loss: 0.3946 | Train Acc: 0.8571
 Site-Clipart                   (0) | Train Loss: 0.3285 | Train Acc: 0.9111
 Site-Clipart                   (4) | Train Loss: 0.3694 | Train Acc: 0.8750
 Site-Clipart                   (0) | Train Loss: 0.2560 | Train Acc: 0.9483
 Site-Clipart                   (0) | Train Loss: 0.4028 | Train Acc: 0.8871
 Site-Clipart                   (0) | Train Loss: 0.3131 | Train Acc: 0.9128
 Site-Clipart                   (0) | Train Loss: 0.2814 | Train Acc: 0.9329
 Site-Real                      (3) | Train Loss: 0.5357 | Train Acc: 0.7778
 Site-Real                      (3) | Train Loss: 0.3004 | Train Acc: 0.8966
 Site-Real                      (2) | Train Loss: 0.1188 | Train Acc: 0.9783
 Site-Real                      (5) | Train Loss: 0.2747 | Train Acc: 0.9595
 Site-Real                      (2) | Train Loss: 0.1537 | Train Acc: 0.9580
 Site-Real                      (2) | Train Loss: 0.1800 | Train Acc: 0.9581
 Site-Real                      (2) | Train Loss: 0.2104 | Train Acc: 0.9444
 Site-Painting                  (5) | Train Loss: 0.3657 | Train Acc: 0.8868
 Site-Painting                  (5) | Train Loss: 0.3856 | Train Acc: 0.9059
 Site-Painting                  (5) | Train Loss: 0.2865 | Train Acc: 0.9118
 Site-Painting                  (5) | Train Loss: 0.2630 | Train Acc: 0.9493
 Site-Sketch                    (0) | Train Loss: 0.2850 | Train Acc: 0.9492
 Site-Sketch                    (0) | Train Loss: 0.4266 | Train Acc: 0.8211
 Site-Sketch                    (0) | Train Loss: 0.5161 | Train Acc: 0.8158
 Site-QuickDraw                 (1) | Train Loss: 0.9131 | Train Acc: 0.7397
 Site-QuickDraw                 (1) | Train Loss: 0.7621 | Train Acc: 0.7458
 Site-Infograph                 (2) | Train Loss: 1.1708 | Train Acc: 0.5917
Average Train Accuracy: 0.8752
============ Train epoch 38 ============
cnt=[2, 2, 9, 1, 10, 3, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (3) | Train Loss: 0.7032 | Train Acc: 0.6667
 Site-Clipart                   (4) | Train Loss: 0.3268 | Train Acc: 0.9091
 Site-Clipart                   (4) | Train Loss: 0.1817 | Train Acc: 0.9412
 Site-Clipart                   (0) | Train Loss: 0.3788 | Train Acc: 0.8929
 Site-Clipart                   (0) | Train Loss: 0.3984 | Train Acc: 0.9333
 Site-Clipart                   (4) | Train Loss: 0.3875 | Train Acc: 0.8750
 Site-Clipart                   (4) | Train Loss: 0.2215 | Train Acc: 0.9397
 Site-Clipart                   (4) | Train Loss: 0.3583 | Train Acc: 0.9086
 Site-Clipart                   (4) | Train Loss: 0.3085 | Train Acc: 0.9195
 Site-Clipart                   (4) | Train Loss: 0.2509 | Train Acc: 0.9434
 Site-Real                      (2) | Train Loss: 0.5503 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.2853 | Train Acc: 0.8966
 Site-Real                      (2) | Train Loss: 0.1147 | Train Acc: 0.9783
 Site-Real                      (2) | Train Loss: 0.2082 | Train Acc: 0.9459
 Site-Real                      (2) | Train Loss: 0.1507 | Train Acc: 0.9580
 Site-Real                      (2) | Train Loss: 0.1904 | Train Acc: 0.9581
 Site-Real                      (2) | Train Loss: 0.1993 | Train Acc: 0.9542
 Site-Painting                  (5) | Train Loss: 0.4390 | Train Acc: 0.8868
 Site-Painting                  (5) | Train Loss: 0.3070 | Train Acc: 0.9176
 Site-Painting                  (2) | Train Loss: 0.2762 | Train Acc: 0.9412
 Site-Painting                  (5) | Train Loss: 0.3023 | Train Acc: 0.9124
 Site-Sketch                    (4) | Train Loss: 0.3447 | Train Acc: 0.8814
 Site-Sketch                    (4) | Train Loss: 0.4092 | Train Acc: 0.8632
 Site-Sketch                    (4) | Train Loss: 0.4615 | Train Acc: 0.8289
 Site-QuickDraw                 (1) | Train Loss: 0.7208 | Train Acc: 0.8082
 Site-QuickDraw                 (1) | Train Loss: 0.7727 | Train Acc: 0.7881
 Site-Infograph                 (2) | Train Loss: 1.1579 | Train Acc: 0.6250
Average Train Accuracy: 0.8834
============ Train epoch 39 ============
cnt=[4, 2, 5, 8, 7, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (3) | Train Loss: 0.6356 | Train Acc: 0.8333
 Site-Clipart                   (3) | Train Loss: 0.3002 | Train Acc: 0.9091
 Site-Clipart                   (3) | Train Loss: 0.1204 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.3410 | Train Acc: 0.8929
 Site-Clipart                   (2) | Train Loss: 0.3498 | Train Acc: 0.9111
 Site-Clipart                   (3) | Train Loss: 0.2590 | Train Acc: 0.9028
 Site-Clipart                   (3) | Train Loss: 0.2468 | Train Acc: 0.9483
 Site-Clipart                   (3) | Train Loss: 0.3544 | Train Acc: 0.8978
 Site-Clipart                   (3) | Train Loss: 0.3028 | Train Acc: 0.9128
 Site-Clipart                   (3) | Train Loss: 0.2609 | Train Acc: 0.9413
 Site-Real                      (4) | Train Loss: 0.5778 | Train Acc: 0.8333
 Site-Real                      (5) | Train Loss: 0.2595 | Train Acc: 0.9310
 Site-Real                      (4) | Train Loss: 0.1330 | Train Acc: 0.9783
 Site-Real                      (4) | Train Loss: 0.3040 | Train Acc: 0.9324
 Site-Real                      (4) | Train Loss: 0.1552 | Train Acc: 0.9580
 Site-Real                      (4) | Train Loss: 0.1740 | Train Acc: 0.9529
 Site-Real                      (4) | Train Loss: 0.1981 | Train Acc: 0.9510
 Site-Painting                  (0) | Train Loss: 0.4116 | Train Acc: 0.8679
 Site-Painting                  (0) | Train Loss: 0.2855 | Train Acc: 0.8824
 Site-Painting                  (0) | Train Loss: 0.3328 | Train Acc: 0.8824
 Site-Painting                  (0) | Train Loss: 0.2364 | Train Acc: 0.9355
 Site-Sketch                    (2) | Train Loss: 0.3293 | Train Acc: 0.8983
 Site-Sketch                    (2) | Train Loss: 0.4073 | Train Acc: 0.8526
 Site-Sketch                    (2) | Train Loss: 0.4750 | Train Acc: 0.8355
 Site-QuickDraw                 (1) | Train Loss: 0.8143 | Train Acc: 0.8630
 Site-QuickDraw                 (1) | Train Loss: 0.7544 | Train Acc: 0.7966
 Site-Infograph                 (4) | Train Loss: 1.2265 | Train Acc: 0.5750
Average Train Accuracy: 0.8917
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:39 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.8929
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.9111
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.9028
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.9483
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.8978
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.9128
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.9413
 Best site-Real                      | Epoch:39 | Val Acc: 0.8333
 Best site-Real                      | Epoch:39 | Val Acc: 0.9310
 Best site-Real                      | Epoch:39 | Val Acc: 0.9783
 Best site-Real                      | Epoch:39 | Val Acc: 0.9324
 Best site-Real                      | Epoch:39 | Val Acc: 0.9580
 Best site-Real                      | Epoch:39 | Val Acc: 0.9529
 Best site-Real                      | Epoch:39 | Val Acc: 0.9510
 Best site-Painting                  | Epoch:39 | Val Acc: 0.8679
 Best site-Painting                  | Epoch:39 | Val Acc: 0.8824
 Best site-Painting                  | Epoch:39 | Val Acc: 0.8824
 Best site-Painting                  | Epoch:39 | Val Acc: 0.9355
 Best site-Sketch                    | Epoch:39 | Val Acc: 0.8983
 Best site-Sketch                    | Epoch:39 | Val Acc: 0.8526
 Best site-Sketch                    | Epoch:39 | Val Acc: 0.8355
 Best site-QuickDraw                 | Epoch:39 | Val Acc: 0.8630
 Best site-QuickDraw                 | Epoch:39 | Val Acc: 0.7966
 Best site-Infograph                 | Epoch:39 | Val Acc: 0.5750
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 40 ============
cnt=[6, 2, 1, 4, 6, 8, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (2) | Train Loss: 0.7127 | Train Acc: 0.6667
 Site-Clipart                   (0) | Train Loss: 0.4686 | Train Acc: 0.9091
 Site-Clipart                   (4) | Train Loss: 0.2954 | Train Acc: 0.9412
 Site-Clipart                   (0) | Train Loss: 0.3126 | Train Acc: 0.9643
 Site-Clipart                   (0) | Train Loss: 0.3338 | Train Acc: 0.9333
 Site-Clipart                   (4) | Train Loss: 0.2256 | Train Acc: 0.9028
 Site-Clipart                   (4) | Train Loss: 0.2580 | Train Acc: 0.9483
 Site-Clipart                   (4) | Train Loss: 0.3576 | Train Acc: 0.8978
 Site-Clipart                   (4) | Train Loss: 0.3065 | Train Acc: 0.9195
 Site-Clipart                   (4) | Train Loss: 0.2691 | Train Acc: 0.9329
 Site-Real                      (5) | Train Loss: 0.5532 | Train Acc: 0.8333
 Site-Real                      (5) | Train Loss: 0.2831 | Train Acc: 0.9310
 Site-Real                      (5) | Train Loss: 0.1625 | Train Acc: 0.9565
 Site-Real                      (5) | Train Loss: 0.2206 | Train Acc: 0.9595
 Site-Real                      (5) | Train Loss: 0.1422 | Train Acc: 0.9580
 Site-Real                      (5) | Train Loss: 0.1739 | Train Acc: 0.9686
 Site-Real                      (5) | Train Loss: 0.1900 | Train Acc: 0.9542
 Site-Painting                  (3) | Train Loss: 0.3581 | Train Acc: 0.9057
 Site-Painting                  (3) | Train Loss: 0.2764 | Train Acc: 0.9294
 Site-Painting                  (3) | Train Loss: 0.3279 | Train Acc: 0.8971
 Site-Painting                  (3) | Train Loss: 0.2633 | Train Acc: 0.9124
 Site-Sketch                    (0) | Train Loss: 0.3552 | Train Acc: 0.8814
 Site-Sketch                    (0) | Train Loss: 0.4441 | Train Acc: 0.8526
 Site-Sketch                    (0) | Train Loss: 0.4849 | Train Acc: 0.8355
 Site-QuickDraw                 (1) | Train Loss: 0.8825 | Train Acc: 0.7808
 Site-QuickDraw                 (1) | Train Loss: 0.7858 | Train Acc: 0.7542
 Site-Infograph                 (5) | Train Loss: 1.1777 | Train Acc: 0.6500
Average Train Accuracy: 0.8880
============ Train epoch 41 ============
cnt=[6, 2, 4, 5, 4, 6, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                   (0) | Train Loss: 0.7529 | Train Acc: 0.8333
 Site-Clipart                   (0) | Train Loss: 0.2999 | Train Acc: 0.9091
 Site-Clipart                   (5) | Train Loss: 0.3031 | Train Acc: 0.8824
 Site-Clipart                   (2) | Train Loss: 0.3687 | Train Acc: 0.8571
 Site-Clipart                   (5) | Train Loss: 0.3231 | Train Acc: 0.9111
 Site-Clipart                   (0) | Train Loss: 0.3816 | Train Acc: 0.9167
 Site-Clipart                   (0) | Train Loss: 0.2261 | Train Acc: 0.9483
 Site-Clipart                   (0) | Train Loss: 0.3808 | Train Acc: 0.8978
 Site-Clipart                   (5) | Train Loss: 0.2719 | Train Acc: 0.9060
 Site-Clipart                   (0) | Train Loss: 0.2594 | Train Acc: 0.9455
 Site-Real                      (4) | Train Loss: 0.5081 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.3053 | Train Acc: 0.8621
 Site-Real                      (4) | Train Loss: 0.1581 | Train Acc: 0.9783
 Site-Real                      (3) | Train Loss: 0.1412 | Train Acc: 0.9595
 Site-Real                      (4) | Train Loss: 0.1256 | Train Acc: 0.9664
 Site-Real                      (2) | Train Loss: 0.1693 | Train Acc: 0.9529
 Site-Real                      (4) | Train Loss: 0.1747 | Train Acc: 0.9542
 Site-Painting                  (3) | Train Loss: 0.3723 | Train Acc: 0.9057
 Site-Painting                  (3) | Train Loss: 0.3481 | Train Acc: 0.8824
 Site-Painting                  (3) | Train Loss: 0.3689 | Train Acc: 0.8971
 Site-Painting                  (3) | Train Loss: 0.2777 | Train Acc: 0.9309
 Site-Sketch                    (5) | Train Loss: 0.3529 | Train Acc: 0.9153
 Site-Sketch                    (5) | Train Loss: 0.3920 | Train Acc: 0.8737
 Site-Sketch                    (5) | Train Loss: 0.5229 | Train Acc: 0.8224
 Site-QuickDraw                 (1) | Train Loss: 0.7948 | Train Acc: 0.7260
 Site-QuickDraw                 (1) | Train Loss: 0.7774 | Train Acc: 0.7203
 Site-Infograph                 (2) | Train Loss: 1.1181 | Train Acc: 0.6333
Average Train Accuracy: 0.8802
============ Train epoch 42 ============
cnt=[5, 2, 12, 6, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                   (4) | Train Loss: 0.8708 | Train Acc: 0.6667
 Site-Clipart                   (2) | Train Loss: 0.4228 | Train Acc: 0.8182
 Site-Clipart                   (2) | Train Loss: 0.1559 | Train Acc: 0.9412
 Site-Clipart                   (2) | Train Loss: 0.3137 | Train Acc: 0.8929
 Site-Clipart                   (2) | Train Loss: 0.4013 | Train Acc: 0.9556
 Site-Clipart                   (2) | Train Loss: 0.3599 | Train Acc: 0.8611
 Site-Clipart                   (2) | Train Loss: 0.2356 | Train Acc: 0.9483
 Site-Clipart                   (2) | Train Loss: 0.3589 | Train Acc: 0.8925
 Site-Clipart                   (2) | Train Loss: 0.2843 | Train Acc: 0.8993
 Site-Clipart                   (2) | Train Loss: 0.2651 | Train Acc: 0.9455
 Site-Real                      (3) | Train Loss: 0.5991 | Train Acc: 0.7778
 Site-Real                      (3) | Train Loss: 0.2819 | Train Acc: 0.8966
 Site-Real                      (3) | Train Loss: 0.1450 | Train Acc: 0.9783
 Site-Real                      (3) | Train Loss: 0.2293 | Train Acc: 0.9324
 Site-Real                      (0) | Train Loss: 0.1538 | Train Acc: 0.9496
 Site-Real                      (3) | Train Loss: 0.1831 | Train Acc: 0.9581
 Site-Real                      (3) | Train Loss: 0.2049 | Train Acc: 0.9444
 Site-Painting                  (0) | Train Loss: 0.3988 | Train Acc: 0.8868
 Site-Painting                  (0) | Train Loss: 0.3425 | Train Acc: 0.9059
 Site-Painting                  (0) | Train Loss: 0.3313 | Train Acc: 0.9044
 Site-Painting                  (0) | Train Loss: 0.3031 | Train Acc: 0.9078
 Site-Sketch                    (2) | Train Loss: 0.3559 | Train Acc: 0.8644
 Site-Sketch                    (2) | Train Loss: 0.4757 | Train Acc: 0.8526
 Site-Sketch                    (2) | Train Loss: 0.4647 | Train Acc: 0.8224
 Site-QuickDraw                 (1) | Train Loss: 0.7323 | Train Acc: 0.8219
 Site-QuickDraw                 (1) | Train Loss: 0.7282 | Train Acc: 0.7712
 Site-Infograph                 (5) | Train Loss: 1.0272 | Train Acc: 0.6833
Average Train Accuracy: 0.8770
============ Train epoch 43 ============
cnt=[11, 2, 5, 7, 1, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                   (2) | Train Loss: 0.8332 | Train Acc: 0.6667
 Site-Clipart                   (0) | Train Loss: 0.4732 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.0685 | Train Acc: 1.0000
 Site-Clipart                   (4) | Train Loss: 0.3738 | Train Acc: 0.8214
 Site-Clipart                   (0) | Train Loss: 0.3301 | Train Acc: 0.9333
 Site-Clipart                   (0) | Train Loss: 0.2770 | Train Acc: 0.9028
 Site-Clipart                   (0) | Train Loss: 0.2797 | Train Acc: 0.9052
 Site-Clipart                   (0) | Train Loss: 0.3498 | Train Acc: 0.8817
 Site-Clipart                   (0) | Train Loss: 0.2535 | Train Acc: 0.9295
 Site-Clipart                   (0) | Train Loss: 0.2515 | Train Acc: 0.9518
 Site-Real                      (3) | Train Loss: 0.5702 | Train Acc: 0.7778
 Site-Real                      (3) | Train Loss: 0.3127 | Train Acc: 0.8966
 Site-Real                      (3) | Train Loss: 0.1878 | Train Acc: 0.9565
 Site-Real                      (3) | Train Loss: 0.2574 | Train Acc: 0.9459
 Site-Real                      (3) | Train Loss: 0.1669 | Train Acc: 0.9664
 Site-Real                      (3) | Train Loss: 0.1956 | Train Acc: 0.9581
 Site-Real                      (3) | Train Loss: 0.2099 | Train Acc: 0.9477
 Site-Painting                  (2) | Train Loss: 0.4613 | Train Acc: 0.8868
 Site-Painting                  (2) | Train Loss: 0.3776 | Train Acc: 0.8706
 Site-Painting                  (2) | Train Loss: 0.3428 | Train Acc: 0.9191
 Site-Painting                  (2) | Train Loss: 0.2505 | Train Acc: 0.9217
 Site-Sketch                    (0) | Train Loss: 0.3596 | Train Acc: 0.8475
 Site-Sketch                    (0) | Train Loss: 0.4612 | Train Acc: 0.8526
 Site-Sketch                    (0) | Train Loss: 0.4461 | Train Acc: 0.8750
 Site-QuickDraw                 (1) | Train Loss: 0.7656 | Train Acc: 0.8082
 Site-QuickDraw                 (1) | Train Loss: 0.7403 | Train Acc: 0.7881
 Site-Infograph                 (5) | Train Loss: 1.0178 | Train Acc: 0.6833
Average Train Accuracy: 0.8816
============ Train epoch 44 ============
cnt=[5, 2, 4, 1, 7, 8, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                   (0) | Train Loss: 0.7514 | Train Acc: 0.6667
 Site-Clipart                   (0) | Train Loss: 0.5446 | Train Acc: 0.8182
 Site-Clipart                   (0) | Train Loss: 0.2186 | Train Acc: 0.8824
 Site-Clipart                   (5) | Train Loss: 0.2920 | Train Acc: 0.9286
 Site-Clipart                   (5) | Train Loss: 0.3179 | Train Acc: 0.9333
 Site-Clipart                   (0) | Train Loss: 0.4901 | Train Acc: 0.8889
 Site-Clipart                   (5) | Train Loss: 0.2599 | Train Acc: 0.9397
 Site-Clipart                   (5) | Train Loss: 0.3479 | Train Acc: 0.9086
 Site-Clipart                   (0) | Train Loss: 0.2872 | Train Acc: 0.9228
 Site-Clipart                   (5) | Train Loss: 0.2456 | Train Acc: 0.9392
 Site-Real                      (4) | Train Loss: 0.5465 | Train Acc: 0.7778
 Site-Real                      (4) | Train Loss: 0.2930 | Train Acc: 0.8621
 Site-Real                      (4) | Train Loss: 0.1314 | Train Acc: 0.9783
 Site-Real                      (4) | Train Loss: 0.2890 | Train Acc: 0.9459
 Site-Real                      (4) | Train Loss: 0.1290 | Train Acc: 0.9580
 Site-Real                      (4) | Train Loss: 0.1754 | Train Acc: 0.9581
 Site-Real                      (4) | Train Loss: 0.2186 | Train Acc: 0.9346
 Site-Painting                  (2) | Train Loss: 0.3488 | Train Acc: 0.8679
 Site-Painting                  (2) | Train Loss: 0.4671 | Train Acc: 0.8353
 Site-Painting                  (2) | Train Loss: 0.3164 | Train Acc: 0.9118
 Site-Painting                  (2) | Train Loss: 0.2487 | Train Acc: 0.9309
 Site-Sketch                    (5) | Train Loss: 0.3147 | Train Acc: 0.9322
 Site-Sketch                    (5) | Train Loss: 0.4087 | Train Acc: 0.8947
 Site-Sketch                    (5) | Train Loss: 0.4893 | Train Acc: 0.8553
 Site-QuickDraw                 (1) | Train Loss: 0.7205 | Train Acc: 0.8356
 Site-QuickDraw                 (1) | Train Loss: 0.7901 | Train Acc: 0.7712
 Site-Infograph                 (3) | Train Loss: 1.0262 | Train Acc: 0.6667
Average Train Accuracy: 0.8794
============ Train epoch 45 ============
cnt=[8, 2, 4, 6, 1, 6, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                   (3) | Train Loss: 0.8567 | Train Acc: 0.6667
 Site-Clipart                   (2) | Train Loss: 0.3407 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.1164 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.2918 | Train Acc: 0.8929
 Site-Clipart                   (2) | Train Loss: 0.2763 | Train Acc: 0.9333
 Site-Clipart                   (0) | Train Loss: 0.3377 | Train Acc: 0.9028
 Site-Clipart                   (0) | Train Loss: 0.2424 | Train Acc: 0.9224
 Site-Clipart                   (0) | Train Loss: 0.3576 | Train Acc: 0.8817
 Site-Clipart                   (0) | Train Loss: 0.2849 | Train Acc: 0.9161
 Site-Clipart                   (0) | Train Loss: 0.2507 | Train Acc: 0.9413
 Site-Real                      (5) | Train Loss: 0.5476 | Train Acc: 0.7778
 Site-Real                      (5) | Train Loss: 0.2853 | Train Acc: 0.9310
 Site-Real                      (5) | Train Loss: 0.1350 | Train Acc: 1.0000
 Site-Real                      (3) | Train Loss: 0.1768 | Train Acc: 0.9595
 Site-Real                      (5) | Train Loss: 0.1457 | Train Acc: 0.9580
 Site-Real                      (5) | Train Loss: 0.1883 | Train Acc: 0.9529
 Site-Real                      (5) | Train Loss: 0.2048 | Train Acc: 0.9510
 Site-Painting                  (3) | Train Loss: 0.3771 | Train Acc: 0.8868
 Site-Painting                  (3) | Train Loss: 0.2848 | Train Acc: 0.9294
 Site-Painting                  (3) | Train Loss: 0.3471 | Train Acc: 0.8897
 Site-Painting                  (3) | Train Loss: 0.2658 | Train Acc: 0.9539
 Site-Sketch                    (2) | Train Loss: 0.3534 | Train Acc: 0.8983
 Site-Sketch                    (0) | Train Loss: 0.3989 | Train Acc: 0.8947
 Site-Sketch                    (0) | Train Loss: 0.4475 | Train Acc: 0.8421
 Site-QuickDraw                 (1) | Train Loss: 0.7899 | Train Acc: 0.7945
 Site-QuickDraw                 (1) | Train Loss: 0.7235 | Train Acc: 0.8136
 Site-Infograph                 (4) | Train Loss: 1.0118 | Train Acc: 0.6500
Average Train Accuracy: 0.8907
============ Train epoch 46 ============
cnt=[5, 2, 11, 1, 3, 5, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                   (4) | Train Loss: 0.8526 | Train Acc: 0.6667
 Site-Clipart                   (4) | Train Loss: 0.3363 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.1258 | Train Acc: 0.9412
 Site-Clipart                   (0) | Train Loss: 0.3221 | Train Acc: 0.8929
 Site-Clipart                   (5) | Train Loss: 0.3263 | Train Acc: 0.9111
 Site-Clipart                   (4) | Train Loss: 0.2937 | Train Acc: 0.9028
 Site-Clipart                   (5) | Train Loss: 0.2291 | Train Acc: 0.9310
 Site-Clipart                   (5) | Train Loss: 0.3324 | Train Acc: 0.9194
 Site-Clipart                   (5) | Train Loss: 0.3125 | Train Acc: 0.9094
 Site-Clipart                   (5) | Train Loss: 0.2542 | Train Acc: 0.9392
 Site-Real                      (2) | Train Loss: 0.5692 | Train Acc: 0.8333
 Site-Real                      (2) | Train Loss: 0.3349 | Train Acc: 0.8966
 Site-Real                      (2) | Train Loss: 0.1111 | Train Acc: 1.0000
 Site-Real                      (2) | Train Loss: 0.1902 | Train Acc: 0.9595
 Site-Real                      (2) | Train Loss: 0.1468 | Train Acc: 0.9664
 Site-Real                      (2) | Train Loss: 0.1721 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.1916 | Train Acc: 0.9510
 Site-Painting                  (2) | Train Loss: 0.4051 | Train Acc: 0.8679
 Site-Painting                  (2) | Train Loss: 0.3346 | Train Acc: 0.8941
 Site-Painting                  (2) | Train Loss: 0.3595 | Train Acc: 0.9118
 Site-Painting                  (2) | Train Loss: 0.2661 | Train Acc: 0.9355
 Site-Sketch                    (0) | Train Loss: 0.3010 | Train Acc: 0.8983
 Site-Sketch                    (0) | Train Loss: 0.3795 | Train Acc: 0.8737
 Site-Sketch                    (0) | Train Loss: 0.4956 | Train Acc: 0.8355
 Site-QuickDraw                 (1) | Train Loss: 0.8276 | Train Acc: 0.7534
 Site-QuickDraw                 (1) | Train Loss: 0.7224 | Train Acc: 0.7797
 Site-Infograph                 (3) | Train Loss: 0.9574 | Train Acc: 0.7167
Average Train Accuracy: 0.8868
============ Train epoch 47 ============
cnt=[11, 2, 5, 1, 5, 3, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                   (2) | Train Loss: 0.6329 | Train Acc: 0.8333
 Site-Clipart                   (0) | Train Loss: 0.3677 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.1432 | Train Acc: 0.9412
 Site-Clipart                   (0) | Train Loss: 0.3613 | Train Acc: 0.8929
 Site-Clipart                   (0) | Train Loss: 0.3611 | Train Acc: 0.8889
 Site-Clipart                   (2) | Train Loss: 0.2477 | Train Acc: 0.9306
 Site-Clipart                   (0) | Train Loss: 0.2426 | Train Acc: 0.9483
 Site-Clipart                   (0) | Train Loss: 0.3055 | Train Acc: 0.9086
 Site-Clipart                   (0) | Train Loss: 0.2813 | Train Acc: 0.9195
 Site-Clipart                   (0) | Train Loss: 0.2455 | Train Acc: 0.9413
 Site-Real                      (5) | Train Loss: 0.5281 | Train Acc: 0.7778
 Site-Real                      (5) | Train Loss: 0.2398 | Train Acc: 0.9310
 Site-Real                      (4) | Train Loss: 0.1431 | Train Acc: 0.9783
 Site-Real                      (4) | Train Loss: 0.2123 | Train Acc: 0.9459
 Site-Real                      (5) | Train Loss: 0.1613 | Train Acc: 0.9664
 Site-Real                      (4) | Train Loss: 0.1706 | Train Acc: 0.9529
 Site-Real                      (4) | Train Loss: 0.1963 | Train Acc: 0.9575
 Site-Painting                  (2) | Train Loss: 0.3426 | Train Acc: 0.9057
 Site-Painting                  (2) | Train Loss: 0.3169 | Train Acc: 0.8941
 Site-Painting                  (2) | Train Loss: 0.3564 | Train Acc: 0.8824
 Site-Painting                  (4) | Train Loss: 0.2536 | Train Acc: 0.9401
 Site-Sketch                    (0) | Train Loss: 0.3107 | Train Acc: 0.8814
 Site-Sketch                    (0) | Train Loss: 0.4182 | Train Acc: 0.8526
 Site-Sketch                    (0) | Train Loss: 0.4236 | Train Acc: 0.8355
 Site-QuickDraw                 (1) | Train Loss: 0.7471 | Train Acc: 0.7534
 Site-QuickDraw                 (1) | Train Loss: 0.6492 | Train Acc: 0.8136
 Site-Infograph                 (3) | Train Loss: 0.9852 | Train Acc: 0.7000
Average Train Accuracy: 0.8919
 Best site-Clipart                   | Epoch:47 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:47 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:47 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:47 | Val Acc: 0.8929
 Best site-Clipart                   | Epoch:47 | Val Acc: 0.8889
 Best site-Clipart                   | Epoch:47 | Val Acc: 0.9306
 Best site-Clipart                   | Epoch:47 | Val Acc: 0.9483
 Best site-Clipart                   | Epoch:47 | Val Acc: 0.9086
 Best site-Clipart                   | Epoch:47 | Val Acc: 0.9195
 Best site-Clipart                   | Epoch:47 | Val Acc: 0.9413
 Best site-Real                      | Epoch:47 | Val Acc: 0.7778
 Best site-Real                      | Epoch:47 | Val Acc: 0.9310
 Best site-Real                      | Epoch:47 | Val Acc: 0.9783
 Best site-Real                      | Epoch:47 | Val Acc: 0.9459
 Best site-Real                      | Epoch:47 | Val Acc: 0.9664
 Best site-Real                      | Epoch:47 | Val Acc: 0.9529
 Best site-Real                      | Epoch:47 | Val Acc: 0.9575
 Best site-Painting                  | Epoch:47 | Val Acc: 0.9057
 Best site-Painting                  | Epoch:47 | Val Acc: 0.8941
 Best site-Painting                  | Epoch:47 | Val Acc: 0.8824
 Best site-Painting                  | Epoch:47 | Val Acc: 0.9401
 Best site-Sketch                    | Epoch:47 | Val Acc: 0.8814
 Best site-Sketch                    | Epoch:47 | Val Acc: 0.8526
 Best site-Sketch                    | Epoch:47 | Val Acc: 0.8355
 Best site-QuickDraw                 | Epoch:47 | Val Acc: 0.7534
 Best site-QuickDraw                 | Epoch:47 | Val Acc: 0.8136
 Best site-Infograph                 | Epoch:47 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 48 ============
cnt=[3, 2, 4, 10, 1, 7, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                   (0) | Train Loss: 0.8325 | Train Acc: 0.6667
 Site-Clipart                   (3) | Train Loss: 0.3237 | Train Acc: 0.9091
 Site-Clipart                   (3) | Train Loss: 0.2120 | Train Acc: 0.9412
 Site-Clipart                   (3) | Train Loss: 0.2984 | Train Acc: 0.8929
 Site-Clipart                   (3) | Train Loss: 0.2201 | Train Acc: 0.9333
 Site-Clipart                   (0) | Train Loss: 0.3517 | Train Acc: 0.8750
 Site-Clipart                   (3) | Train Loss: 0.2409 | Train Acc: 0.9310
 Site-Clipart                   (3) | Train Loss: 0.3541 | Train Acc: 0.9032
 Site-Clipart                   (3) | Train Loss: 0.2563 | Train Acc: 0.9396
 Site-Clipart                   (0) | Train Loss: 0.2479 | Train Acc: 0.9329
 Site-Real                      (2) | Train Loss: 0.5468 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.2338 | Train Acc: 0.9310
 Site-Real                      (2) | Train Loss: 0.1567 | Train Acc: 0.9783
 Site-Real                      (5) | Train Loss: 0.3023 | Train Acc: 0.9595
 Site-Real                      (5) | Train Loss: 0.1549 | Train Acc: 0.9580
 Site-Real                      (2) | Train Loss: 0.2079 | Train Acc: 0.9319
 Site-Real                      (5) | Train Loss: 0.2102 | Train Acc: 0.9444
 Site-Painting                  (5) | Train Loss: 0.3616 | Train Acc: 0.8679
 Site-Painting                  (5) | Train Loss: 0.3385 | Train Acc: 0.9059
 Site-Painting                  (5) | Train Loss: 0.2681 | Train Acc: 0.9191
 Site-Painting                  (5) | Train Loss: 0.2510 | Train Acc: 0.9309
 Site-Sketch                    (3) | Train Loss: 0.2754 | Train Acc: 0.9322
 Site-Sketch                    (3) | Train Loss: 0.3939 | Train Acc: 0.8737
 Site-Sketch                    (3) | Train Loss: 0.4711 | Train Acc: 0.8421
 Site-QuickDraw                 (1) | Train Loss: 0.7484 | Train Acc: 0.8356
 Site-QuickDraw                 (1) | Train Loss: 0.7142 | Train Acc: 0.8305
 Site-Infograph                 (4) | Train Loss: 0.9279 | Train Acc: 0.7417
Average Train Accuracy: 0.8921
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.8929
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.8750
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.9310
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.9032
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.9396
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.9329
 Best site-Real                      | Epoch:48 | Val Acc: 0.7778
 Best site-Real                      | Epoch:48 | Val Acc: 0.9310
 Best site-Real                      | Epoch:48 | Val Acc: 0.9783
 Best site-Real                      | Epoch:48 | Val Acc: 0.9595
 Best site-Real                      | Epoch:48 | Val Acc: 0.9580
 Best site-Real                      | Epoch:48 | Val Acc: 0.9319
 Best site-Real                      | Epoch:48 | Val Acc: 0.9444
 Best site-Painting                  | Epoch:48 | Val Acc: 0.8679
 Best site-Painting                  | Epoch:48 | Val Acc: 0.9059
 Best site-Painting                  | Epoch:48 | Val Acc: 0.9191
 Best site-Painting                  | Epoch:48 | Val Acc: 0.9309
 Best site-Sketch                    | Epoch:48 | Val Acc: 0.9322
 Best site-Sketch                    | Epoch:48 | Val Acc: 0.8737
 Best site-Sketch                    | Epoch:48 | Val Acc: 0.8421
 Best site-QuickDraw                 | Epoch:48 | Val Acc: 0.8356
 Best site-QuickDraw                 | Epoch:48 | Val Acc: 0.8305
 Best site-Infograph                 | Epoch:48 | Val Acc: 0.7417
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_0/ccop_q=1_kmeans...
============ Train epoch 49 ============
cnt=[7, 2, 7, 1, 6, 4, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                   (4) | Train Loss: 0.6576 | Train Acc: 0.6667
 Site-Clipart                   (4) | Train Loss: 0.4177 | Train Acc: 0.8182
 Site-Clipart                   (2) | Train Loss: 0.1402 | Train Acc: 0.9412
 Site-Clipart                   (2) | Train Loss: 0.2827 | Train Acc: 0.9286
 Site-Clipart                   (2) | Train Loss: 0.3454 | Train Acc: 0.9111
 Site-Clipart                   (4) | Train Loss: 0.2731 | Train Acc: 0.8889
 Site-Clipart                   (2) | Train Loss: 0.2341 | Train Acc: 0.9569
 Site-Clipart                   (4) | Train Loss: 0.3668 | Train Acc: 0.9086
 Site-Clipart                   (4) | Train Loss: 0.2722 | Train Acc: 0.9094
 Site-Clipart                   (4) | Train Loss: 0.2276 | Train Acc: 0.9371
 Site-Real                      (0) | Train Loss: 0.5356 | Train Acc: 0.7778
 Site-Real                      (0) | Train Loss: 0.2388 | Train Acc: 0.9310
 Site-Real                      (0) | Train Loss: 0.1206 | Train Acc: 0.9783
 Site-Real                      (0) | Train Loss: 0.1816 | Train Acc: 0.9459
 Site-Real                      (0) | Train Loss: 0.1708 | Train Acc: 0.9412
 Site-Real                      (0) | Train Loss: 0.1555 | Train Acc: 0.9529
 Site-Real                      (0) | Train Loss: 0.1787 | Train Acc: 0.9575
 Site-Painting                  (5) | Train Loss: 0.4167 | Train Acc: 0.8679
 Site-Painting                  (5) | Train Loss: 0.3820 | Train Acc: 0.8941
 Site-Painting                  (5) | Train Loss: 0.2640 | Train Acc: 0.9191
 Site-Painting                  (5) | Train Loss: 0.2303 | Train Acc: 0.9447
 Site-Sketch                    (2) | Train Loss: 0.3269 | Train Acc: 0.9322
 Site-Sketch                    (2) | Train Loss: 0.3824 | Train Acc: 0.8842
 Site-Sketch                    (2) | Train Loss: 0.4806 | Train Acc: 0.8421
 Site-QuickDraw                 (1) | Train Loss: 0.8371 | Train Acc: 0.7945
 Site-QuickDraw                 (1) | Train Loss: 0.6916 | Train Acc: 0.8305
 Site-Infograph                 (3) | Train Loss: 0.9494 | Train Acc: 0.7167
Average Train Accuracy: 0.8880
 Test site-Clipart                   (4)| Epoch:48 | Test Acc: 0.8992
 Test site-Real                      (0)| Epoch:48 | Test Acc: 0.9482
 Test site-Painting                  (5)| Epoch:48 | Test Acc: 0.9354
 Test site-Sketch                    (2)| Epoch:48 | Test Acc: 0.8773
 Test site-QuickDraw                 (1)| Epoch:48 | Test Acc: 0.7250
 Test site-Infograph                 (3)| Epoch:48 | Test Acc: 0.5616
Clipart: 0.8992, Real: 0.9482, Painting: 0.9354, Sketch: 0.8773, QuickDraw: 0.7250, Infograph: 0.5616, 
Average Test Accuracy(group): 0.8245, Average Test Accuracy(individual): 0.8894,
domain std=0.1384, cluster std=0.1393, individual std=0.0851, 
===2023-08-17 16:18:04===
===2023-08-17 16:18:19===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 6
data_number=[6,11,17,28,45,72,116,186,298,477,18,29,46,74,119,191,306,53,85,136,217,59,95,152,73,118,120,
client_nums=[10,7,4,3,2,1,]
len_dataset=[2103,1314,821,513,320,200,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (0)| Epoch:48 | Test Acc: 0.9049
 Test site-Real                      (2)| Epoch:48 | Test Acc: 0.9474
 Test site-Painting                  (5)| Epoch:48 | Test Acc: 0.9289
 Test site-Sketch                    (3)| Epoch:48 | Test Acc: 0.8736
 Test site-QuickDraw                 (1)| Epoch:48 | Test Acc: 0.7230
 Test site-Infograph                 (4)| Epoch:48 | Test Acc: 0.5601
Clipart: 0.9049, Real: 0.9474, Painting: 0.9289, Sketch: 0.8736, QuickDraw: 0.7230, Infograph: 0.5601, 
Average Test Accuracy(group): 0.8230, Average Test Accuracy(individual): 0.8898,
domain std=0.1385, cluster std=0.1411, individual std=0.0854, 
