===2023-07-01 16:12:08===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 1.2121 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 1.2448 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.9137 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 1.0600 | Train Acc: 0.9211
 Site-MNIST                         | Train Loss: 1.0928 | Train Acc: 0.8143
 Site-MNIST                         | Train Loss: 1.0936 | Train Acc: 0.8571
 Site-MNIST                         | Train Loss: 1.0941 | Train Acc: 0.8282
 Site-MNIST                         | Train Loss: 1.1797 | Train Acc: 0.7531
 Site-MNIST                         | Train Loss: 1.1312 | Train Acc: 0.8098
 Site-MNIST                         | Train Loss: 1.0913 | Train Acc: 0.8143
 Site-USPS                          | Train Loss: 1.2007 | Train Acc: 0.6750
 Site-USPS                          | Train Loss: 1.3358 | Train Acc: 0.6944
 Site-USPS                          | Train Loss: 1.4123 | Train Acc: 0.7442
 Site-USPS                          | Train Loss: 1.1547 | Train Acc: 0.7167
 Site-USPS                          | Train Loss: 1.0966 | Train Acc: 0.7405
 Site-USPS                          | Train Loss: 1.1087 | Train Acc: 0.7566
 Site-SynthDigits                   | Train Loss: 2.0228 | Train Acc: 0.2848
 Site-SynthDigits                   | Train Loss: 2.0593 | Train Acc: 0.3004
 Site-SynthDigits                   | Train Loss: 1.9708 | Train Acc: 0.3299
 Site-MNIST_M                       | Train Loss: 2.1427 | Train Acc: 0.2818
 Site-MNIST_M                       | Train Loss: 2.1536 | Train Acc: 0.2722
 Site-SVHN                          | Train Loss: 2.2358 | Train Acc: 0.1596
Average Train Accuracy: 0.6533
 Site-MNIST                         | Val  Loss: 0.9447 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 1.1251 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.1358 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 1.2557 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 1.1536 | Val  Acc: 0.7059
 Site-MNIST                         | Val  Loss: 1.1347 | Val  Acc: 0.8065
 Site-MNIST                         | Val  Loss: 1.1155 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.0905 | Val  Acc: 0.7941
 Site-MNIST                         | Val  Loss: 1.1202 | Val  Acc: 0.7705
 Site-MNIST                         | Val  Loss: 1.1108 | Val  Acc: 0.7885
 Site-USPS                          | Val  Loss: 0.9079 | Val  Acc: 0.8000
 Site-USPS                          | Val  Loss: 1.3716 | Val  Acc: 0.6111
 Site-USPS                          | Val  Loss: 1.3378 | Val  Acc: 0.5938
 Site-USPS                          | Val  Loss: 1.2904 | Val  Acc: 0.6207
 Site-USPS                          | Val  Loss: 1.1851 | Val  Acc: 0.7048
 Site-USPS                          | Val  Loss: 1.0923 | Val  Acc: 0.7407
 Site-SynthDigits                   | Val  Loss: 2.0659 | Val  Acc: 0.2973
 Site-SynthDigits                   | Val  Loss: 2.2083 | Val  Acc: 0.3529
 Site-SynthDigits                   | Val  Loss: 2.0391 | Val  Acc: 0.3033
 Site-MNIST_M                       | Val  Loss: 2.1437 | Val  Acc: 0.2889
 Site-MNIST_M                       | Val  Loss: 2.1092 | Val  Acc: 0.3457
 Site-SVHN                          | Val  Loss: 2.3078 | Val  Acc: 0.1143
Average Valid Accuracy: 0.6221
 Best site-MNIST                     | Epoch:0 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7059
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.8065
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7941
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7705
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7885
 Best site-USPS                      | Epoch:0 | Val Acc: 0.8000
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6111
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5938
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6207
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7048
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7407
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2973
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.3529
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.3033
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.2889
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.3457
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 0.6428 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.8612 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.4494 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.5987 | Train Acc: 0.8947
 Site-MNIST                         | Train Loss: 0.5901 | Train Acc: 0.8286
 Site-MNIST                         | Train Loss: 0.6670 | Train Acc: 0.8571
 Site-MNIST                         | Train Loss: 0.6678 | Train Acc: 0.8370
 Site-MNIST                         | Train Loss: 0.7372 | Train Acc: 0.8215
 Site-MNIST                         | Train Loss: 0.6864 | Train Acc: 0.8478
 Site-MNIST                         | Train Loss: 0.6546 | Train Acc: 0.8551
 Site-USPS                          | Train Loss: 0.7777 | Train Acc: 0.7750
 Site-USPS                          | Train Loss: 0.6943 | Train Acc: 0.7500
 Site-USPS                          | Train Loss: 0.5689 | Train Acc: 0.8295
 Site-USPS                          | Train Loss: 0.7856 | Train Acc: 0.7983
 Site-USPS                          | Train Loss: 0.7002 | Train Acc: 0.8190
 Site-USPS                          | Train Loss: 0.7210 | Train Acc: 0.8069
 Site-SynthDigits                   | Train Loss: 1.8767 | Train Acc: 0.3841
 Site-SynthDigits                   | Train Loss: 1.8556 | Train Acc: 0.3810
 Site-SynthDigits                   | Train Loss: 1.7730 | Train Acc: 0.4114
 Site-MNIST_M                       | Train Loss: 2.0112 | Train Acc: 0.3094
 Site-MNIST_M                       | Train Loss: 2.0638 | Train Acc: 0.3303
 Site-SVHN                          | Train Loss: 2.2071 | Train Acc: 0.1560
Average Train Accuracy: 0.7095
 Site-MNIST                         | Val  Loss: 0.3305 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.6808 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.8419 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.8260 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.7157 | Val  Acc: 0.8235
 Site-MNIST                         | Val  Loss: 0.7104 | Val  Acc: 0.8710
 Site-MNIST                         | Val  Loss: 0.6864 | Val  Acc: 0.8750
 Site-MNIST                         | Val  Loss: 0.6428 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.6906 | Val  Acc: 0.8306
 Site-MNIST                         | Val  Loss: 0.6971 | Val  Acc: 0.8157
 Site-USPS                          | Val  Loss: 0.5543 | Val  Acc: 0.9000
 Site-USPS                          | Val  Loss: 1.0906 | Val  Acc: 0.6111
 Site-USPS                          | Val  Loss: 1.0189 | Val  Acc: 0.6562
 Site-USPS                          | Val  Loss: 0.9872 | Val  Acc: 0.6897
 Site-USPS                          | Val  Loss: 0.8370 | Val  Acc: 0.7810
 Site-USPS                          | Val  Loss: 0.7233 | Val  Acc: 0.8360
 Site-SynthDigits                   | Val  Loss: 1.8763 | Val  Acc: 0.4054
 Site-SynthDigits                   | Val  Loss: 2.1025 | Val  Acc: 0.4412
 Site-SynthDigits                   | Val  Loss: 1.8888 | Val  Acc: 0.3934
 Site-MNIST_M                       | Val  Loss: 1.9907 | Val  Acc: 0.2889
 Site-MNIST_M                       | Val  Loss: 1.9282 | Val  Acc: 0.4198
 Site-SVHN                          | Val  Loss: 2.3044 | Val  Acc: 0.1714
Average Valid Accuracy: 0.6991
 Best site-MNIST                     | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8235
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8710
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8750
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8306
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8157
 Best site-USPS                      | Epoch:1 | Val Acc: 0.9000
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6111
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6562
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6897
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7810
 Best site-USPS                      | Epoch:1 | Val Acc: 0.8360
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.4054
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.4412
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3934
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2889
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.4198
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 0.5139 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.7135 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.3103 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.4140 | Train Acc: 0.9211
 Site-MNIST                         | Train Loss: 0.5148 | Train Acc: 0.8571
 Site-MNIST                         | Train Loss: 0.5215 | Train Acc: 0.8651
 Site-MNIST                         | Train Loss: 0.5044 | Train Acc: 0.8502
 Site-MNIST                         | Train Loss: 0.5881 | Train Acc: 0.8411
 Site-MNIST                         | Train Loss: 0.5201 | Train Acc: 0.8736
 Site-MNIST                         | Train Loss: 0.4889 | Train Acc: 0.8883
 Site-USPS                          | Train Loss: 0.6137 | Train Acc: 0.8750
 Site-USPS                          | Train Loss: 0.5571 | Train Acc: 0.8611
 Site-USPS                          | Train Loss: 0.3787 | Train Acc: 0.8837
 Site-USPS                          | Train Loss: 0.6242 | Train Acc: 0.8412
 Site-USPS                          | Train Loss: 0.5156 | Train Acc: 0.8833
 Site-USPS                          | Train Loss: 0.5121 | Train Acc: 0.8783
 Site-SynthDigits                   | Train Loss: 1.7947 | Train Acc: 0.4172
 Site-SynthDigits                   | Train Loss: 1.7335 | Train Acc: 0.4469
 Site-SynthDigits                   | Train Loss: 1.6497 | Train Acc: 0.4481
 Site-MNIST_M                       | Train Loss: 1.9191 | Train Acc: 0.3260
 Site-MNIST_M                       | Train Loss: 1.9117 | Train Acc: 0.3639
 Site-SVHN                          | Train Loss: 2.1885 | Train Acc: 0.1702
Average Train Accuracy: 0.7323
 Site-MNIST                         | Val  Loss: 0.1854 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4921 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 0.7408 | Val  Acc: 0.6000
 Site-MNIST                         | Val  Loss: 0.6895 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.5383 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.5304 | Val  Acc: 0.9032
 Site-MNIST                         | Val  Loss: 0.5169 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.4751 | Val  Acc: 0.8922
 Site-MNIST                         | Val  Loss: 0.5283 | Val  Acc: 0.8525
 Site-MNIST                         | Val  Loss: 0.5353 | Val  Acc: 0.8399
 Site-USPS                          | Val  Loss: 0.3385 | Val  Acc: 0.9000
 Site-USPS                          | Val  Loss: 0.8567 | Val  Acc: 0.7222
 Site-USPS                          | Val  Loss: 0.8150 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.8049 | Val  Acc: 0.7759
 Site-USPS                          | Val  Loss: 0.6671 | Val  Acc: 0.8286
 Site-USPS                          | Val  Loss: 0.5362 | Val  Acc: 0.8624
 Site-SynthDigits                   | Val  Loss: 1.7742 | Val  Acc: 0.5135
 Site-SynthDigits                   | Val  Loss: 1.9978 | Val  Acc: 0.4706
 Site-SynthDigits                   | Val  Loss: 1.8021 | Val  Acc: 0.4344
 Site-MNIST_M                       | Val  Loss: 1.8841 | Val  Acc: 0.3556
 Site-MNIST_M                       | Val  Loss: 1.8176 | Val  Acc: 0.4568
 Site-SVHN                          | Val  Loss: 2.2662 | Val  Acc: 0.2000
Average Valid Accuracy: 0.7109
 Best site-MNIST                     | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6000
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.9032
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8922
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8525
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8399
 Best site-USPS                      | Epoch:2 | Val Acc: 0.9000
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7222
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8125
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7759
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8286
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8624
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.5135
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.4706
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.4344
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.3556
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4568
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 0.3370 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.6477 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.2090 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3153 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.4739 | Train Acc: 0.8571
 Site-MNIST                         | Train Loss: 0.3906 | Train Acc: 0.9048
 Site-MNIST                         | Train Loss: 0.3990 | Train Acc: 0.8899
 Site-MNIST                         | Train Loss: 0.4507 | Train Acc: 0.8606
 Site-MNIST                         | Train Loss: 0.4110 | Train Acc: 0.9008
 Site-MNIST                         | Train Loss: 0.3758 | Train Acc: 0.9140
 Site-USPS                          | Train Loss: 0.6056 | Train Acc: 0.7750
 Site-USPS                          | Train Loss: 0.4908 | Train Acc: 0.8611
 Site-USPS                          | Train Loss: 0.3360 | Train Acc: 0.8760
 Site-USPS                          | Train Loss: 0.5688 | Train Acc: 0.8326
 Site-USPS                          | Train Loss: 0.4460 | Train Acc: 0.8619
 Site-USPS                          | Train Loss: 0.4736 | Train Acc: 0.8598
 Site-SynthDigits                   | Train Loss: 1.7043 | Train Acc: 0.4305
 Site-SynthDigits                   | Train Loss: 1.6740 | Train Acc: 0.4615
 Site-SynthDigits                   | Train Loss: 1.5725 | Train Acc: 0.4868
 Site-MNIST_M                       | Train Loss: 1.8631 | Train Acc: 0.3481
 Site-MNIST_M                       | Train Loss: 1.8766 | Train Acc: 0.3609
 Site-SVHN                          | Train Loss: 2.1637 | Train Acc: 0.2057
Average Train Accuracy: 0.7447
 Site-MNIST                         | Val  Loss: 0.0861 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4212 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 0.7482 | Val  Acc: 0.6000
 Site-MNIST                         | Val  Loss: 0.6728 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 0.4825 | Val  Acc: 0.8235
 Site-MNIST                         | Val  Loss: 0.3833 | Val  Acc: 0.8710
 Site-MNIST                         | Val  Loss: 0.3741 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.3462 | Val  Acc: 0.9314
 Site-MNIST                         | Val  Loss: 0.4170 | Val  Acc: 0.8798
 Site-MNIST                         | Val  Loss: 0.4206 | Val  Acc: 0.8792
 Site-USPS                          | Val  Loss: 0.2907 | Val  Acc: 0.9000
 Site-USPS                          | Val  Loss: 0.8233 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 0.8193 | Val  Acc: 0.6875
 Site-USPS                          | Val  Loss: 0.7899 | Val  Acc: 0.7414
 Site-USPS                          | Val  Loss: 0.6313 | Val  Acc: 0.8190
 Site-USPS                          | Val  Loss: 0.5057 | Val  Acc: 0.8677
 Site-SynthDigits                   | Val  Loss: 1.6862 | Val  Acc: 0.5405
 Site-SynthDigits                   | Val  Loss: 1.8990 | Val  Acc: 0.4706
 Site-SynthDigits                   | Val  Loss: 1.7432 | Val  Acc: 0.4590
 Site-MNIST_M                       | Val  Loss: 1.8225 | Val  Acc: 0.3556
 Site-MNIST_M                       | Val  Loss: 1.7315 | Val  Acc: 0.4568
 Site-SVHN                          | Val  Loss: 2.2010 | Val  Acc: 0.2286
Average Valid Accuracy: 0.7002
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 0.2374 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.5893 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.1681 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2768 | Train Acc: 0.8947
 Site-MNIST                         | Train Loss: 0.2658 | Train Acc: 0.8714
 Site-MNIST                         | Train Loss: 0.3439 | Train Acc: 0.9048
 Site-MNIST                         | Train Loss: 0.3246 | Train Acc: 0.9031
 Site-MNIST                         | Train Loss: 0.3857 | Train Acc: 0.8778
 Site-MNIST                         | Train Loss: 0.3474 | Train Acc: 0.9090
 Site-MNIST                         | Train Loss: 0.3102 | Train Acc: 0.9283
 Site-USPS                          | Train Loss: 0.5186 | Train Acc: 0.8250
 Site-USPS                          | Train Loss: 0.5341 | Train Acc: 0.8889
 Site-USPS                          | Train Loss: 0.3611 | Train Acc: 0.8837
 Site-USPS                          | Train Loss: 0.5137 | Train Acc: 0.8326
 Site-USPS                          | Train Loss: 0.3985 | Train Acc: 0.9024
 Site-USPS                          | Train Loss: 0.4050 | Train Acc: 0.8889
 Site-SynthDigits                   | Train Loss: 1.6603 | Train Acc: 0.4371
 Site-SynthDigits                   | Train Loss: 1.7035 | Train Acc: 0.4579
 Site-SynthDigits                   | Train Loss: 1.5290 | Train Acc: 0.4766
 Site-MNIST_M                       | Train Loss: 1.8538 | Train Acc: 0.3646
 Site-MNIST_M                       | Train Loss: 1.8092 | Train Acc: 0.3456
 Site-SVHN                          | Train Loss: 2.1495 | Train Acc: 0.2128
Average Train Accuracy: 0.7563
 Site-MNIST                         | Val  Loss: 0.0427 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3328 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.6570 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.5216 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.3820 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.2862 | Val  Acc: 0.9355
 Site-MNIST                         | Val  Loss: 0.3053 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.2847 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.3550 | Val  Acc: 0.8962
 Site-MNIST                         | Val  Loss: 0.3633 | Val  Acc: 0.8973
 Site-USPS                          | Val  Loss: 0.2303 | Val  Acc: 0.9000
 Site-USPS                          | Val  Loss: 0.7378 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 0.7380 | Val  Acc: 0.6875
 Site-USPS                          | Val  Loss: 0.7347 | Val  Acc: 0.7241
 Site-USPS                          | Val  Loss: 0.5797 | Val  Acc: 0.8095
 Site-USPS                          | Val  Loss: 0.4507 | Val  Acc: 0.8571
 Site-SynthDigits                   | Val  Loss: 1.6370 | Val  Acc: 0.5135
 Site-SynthDigits                   | Val  Loss: 1.8116 | Val  Acc: 0.4412
 Site-SynthDigits                   | Val  Loss: 1.7249 | Val  Acc: 0.4180
 Site-MNIST_M                       | Val  Loss: 1.8048 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 1.7030 | Val  Acc: 0.4691
 Site-SVHN                          | Val  Loss: 2.1116 | Val  Acc: 0.2286
Average Valid Accuracy: 0.7394
 Best site-MNIST                     | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.9355
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8962
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8973
 Best site-USPS                      | Epoch:4 | Val Acc: 0.9000
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6875
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7241
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8095
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8571
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5135
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4412
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4180
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.4000
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.4691
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 0.2534 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.5489 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.1571 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.2437 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.4818 | Train Acc: 0.8714
 Site-MNIST                         | Train Loss: 0.3222 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.3183 | Train Acc: 0.8943
 Site-MNIST                         | Train Loss: 0.3770 | Train Acc: 0.8924
 Site-MNIST                         | Train Loss: 0.3096 | Train Acc: 0.9158
 Site-MNIST                         | Train Loss: 0.2805 | Train Acc: 0.9351
 Site-USPS                          | Train Loss: 0.4496 | Train Acc: 0.8500
 Site-USPS                          | Train Loss: 0.4176 | Train Acc: 0.9028
 Site-USPS                          | Train Loss: 0.3904 | Train Acc: 0.9070
 Site-USPS                          | Train Loss: 0.4306 | Train Acc: 0.8627
 Site-USPS                          | Train Loss: 0.3299 | Train Acc: 0.9262
 Site-USPS                          | Train Loss: 0.3377 | Train Acc: 0.9048
 Site-SynthDigits                   | Train Loss: 1.5897 | Train Acc: 0.4834
 Site-SynthDigits                   | Train Loss: 1.5127 | Train Acc: 0.4908
 Site-SynthDigits                   | Train Loss: 1.4508 | Train Acc: 0.4990
 Site-MNIST_M                       | Train Loss: 1.8183 | Train Acc: 0.3978
 Site-MNIST_M                       | Train Loss: 1.9133 | Train Acc: 0.3731
 Site-SVHN                          | Train Loss: 2.1139 | Train Acc: 0.2199
Average Train Accuracy: 0.7646
 Site-MNIST                         | Val  Loss: 0.0476 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3579 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 0.6012 | Val  Acc: 0.6000
 Site-MNIST                         | Val  Loss: 0.4985 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.3340 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.2684 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.2779 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.2589 | Val  Acc: 0.9608
 Site-MNIST                         | Val  Loss: 0.3229 | Val  Acc: 0.9126
 Site-MNIST                         | Val  Loss: 0.3342 | Val  Acc: 0.9003
 Site-USPS                          | Val  Loss: 0.1471 | Val  Acc: 0.9000
 Site-USPS                          | Val  Loss: 0.6220 | Val  Acc: 0.7222
 Site-USPS                          | Val  Loss: 0.6389 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 0.6474 | Val  Acc: 0.7414
 Site-USPS                          | Val  Loss: 0.5169 | Val  Acc: 0.8381
 Site-USPS                          | Val  Loss: 0.3843 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.5827 | Val  Acc: 0.5405
 Site-SynthDigits                   | Val  Loss: 1.6742 | Val  Acc: 0.4853
 Site-SynthDigits                   | Val  Loss: 1.6403 | Val  Acc: 0.4836
 Site-MNIST_M                       | Val  Loss: 1.7411 | Val  Acc: 0.4667
 Site-MNIST_M                       | Val  Loss: 1.6499 | Val  Acc: 0.4938
 Site-SVHN                          | Val  Loss: 2.0672 | Val  Acc: 0.2571
Average Valid Accuracy: 0.7390
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.2126 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.4749 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0952 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2102 | Train Acc: 0.9211
 Site-MNIST                         | Train Loss: 0.2423 | Train Acc: 0.8714
 Site-MNIST                         | Train Loss: 0.2531 | Train Acc: 0.9365
 Site-MNIST                         | Train Loss: 0.2566 | Train Acc: 0.9339
 Site-MNIST                         | Train Loss: 0.3039 | Train Acc: 0.9071
 Site-MNIST                         | Train Loss: 0.2593 | Train Acc: 0.9226
 Site-MNIST                         | Train Loss: 0.2311 | Train Acc: 0.9426
 Site-USPS                          | Train Loss: 0.4582 | Train Acc: 0.8500
 Site-USPS                          | Train Loss: 0.4860 | Train Acc: 0.8889
 Site-USPS                          | Train Loss: 0.2885 | Train Acc: 0.8992
 Site-USPS                          | Train Loss: 0.4298 | Train Acc: 0.8755
 Site-USPS                          | Train Loss: 0.3080 | Train Acc: 0.9262
 Site-USPS                          | Train Loss: 0.3277 | Train Acc: 0.8995
 Site-SynthDigits                   | Train Loss: 1.4882 | Train Acc: 0.5099
 Site-SynthDigits                   | Train Loss: 1.5486 | Train Acc: 0.5165
 Site-SynthDigits                   | Train Loss: 1.3770 | Train Acc: 0.5397
 Site-MNIST_M                       | Train Loss: 1.7968 | Train Acc: 0.3978
 Site-MNIST_M                       | Train Loss: 1.8127 | Train Acc: 0.3884
 Site-SVHN                          | Train Loss: 2.0880 | Train Acc: 0.2376
Average Train Accuracy: 0.7855
 Site-MNIST                         | Val  Loss: 0.0376 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2176 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.5243 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4259 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.3059 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.2163 | Val  Acc: 0.9355
 Site-MNIST                         | Val  Loss: 0.2326 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.2118 | Val  Acc: 0.9510
 Site-MNIST                         | Val  Loss: 0.2768 | Val  Acc: 0.9180
 Site-MNIST                         | Val  Loss: 0.2826 | Val  Acc: 0.9275
 Site-USPS                          | Val  Loss: 0.1141 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.5915 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.6347 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.6523 | Val  Acc: 0.7759
 Site-USPS                          | Val  Loss: 0.5099 | Val  Acc: 0.8476
 Site-USPS                          | Val  Loss: 0.3682 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.5383 | Val  Acc: 0.5676
 Site-SynthDigits                   | Val  Loss: 1.5619 | Val  Acc: 0.5147
 Site-SynthDigits                   | Val  Loss: 1.5694 | Val  Acc: 0.5082
 Site-MNIST_M                       | Val  Loss: 1.7317 | Val  Acc: 0.4444
 Site-MNIST_M                       | Val  Loss: 1.6214 | Val  Acc: 0.5062
 Site-SVHN                          | Val  Loss: 1.9746 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7818
 Best site-MNIST                     | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9355
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9510
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9180
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9275
 Best site-USPS                      | Epoch:6 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8333
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8125
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7759
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8476
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5676
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5147
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5082
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.4444
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.5062
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.1464 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.4670 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0898 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2065 | Train Acc: 0.8947
 Site-MNIST                         | Train Loss: 0.2621 | Train Acc: 0.9000
 Site-MNIST                         | Train Loss: 0.2297 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.2298 | Train Acc: 0.9339
 Site-MNIST                         | Train Loss: 0.2694 | Train Acc: 0.9193
 Site-MNIST                         | Train Loss: 0.2295 | Train Acc: 0.9361
 Site-MNIST                         | Train Loss: 0.2033 | Train Acc: 0.9464
 Site-USPS                          | Train Loss: 0.4550 | Train Acc: 0.8500
 Site-USPS                          | Train Loss: 0.3955 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.2344 | Train Acc: 0.8992
 Site-USPS                          | Train Loss: 0.4057 | Train Acc: 0.8712
 Site-USPS                          | Train Loss: 0.2890 | Train Acc: 0.9262
 Site-USPS                          | Train Loss: 0.3184 | Train Acc: 0.8955
 Site-SynthDigits                   | Train Loss: 1.4939 | Train Acc: 0.4967
 Site-SynthDigits                   | Train Loss: 1.4580 | Train Acc: 0.5201
 Site-SynthDigits                   | Train Loss: 1.3477 | Train Acc: 0.5479
 Site-MNIST_M                       | Train Loss: 1.8022 | Train Acc: 0.3702
 Site-MNIST_M                       | Train Loss: 1.7979 | Train Acc: 0.4037
 Site-SVHN                          | Train Loss: 2.0581 | Train Acc: 0.2801
Average Train Accuracy: 0.7888
 Site-MNIST                         | Val  Loss: 0.0137 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1012 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.5893 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4394 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.3192 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.1743 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1998 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.1827 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.2523 | Val  Acc: 0.9235
 Site-MNIST                         | Val  Loss: 0.2570 | Val  Acc: 0.9275
 Site-USPS                          | Val  Loss: 0.1123 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.5690 | Val  Acc: 0.7778
 Site-USPS                          | Val  Loss: 0.6119 | Val  Acc: 0.7812
 Site-USPS                          | Val  Loss: 0.6334 | Val  Acc: 0.7586
 Site-USPS                          | Val  Loss: 0.4895 | Val  Acc: 0.8381
 Site-USPS                          | Val  Loss: 0.3524 | Val  Acc: 0.8836
 Site-SynthDigits                   | Val  Loss: 1.4523 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 1.4852 | Val  Acc: 0.5294
 Site-SynthDigits                   | Val  Loss: 1.5117 | Val  Acc: 0.5164
 Site-MNIST_M                       | Val  Loss: 1.7511 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 1.6134 | Val  Acc: 0.4444
 Site-SVHN                          | Val  Loss: 1.9410 | Val  Acc: 0.3286
Average Valid Accuracy: 0.7800
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.1646 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.4716 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0928 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1895 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.2644 | Train Acc: 0.8714
 Site-MNIST                         | Train Loss: 0.2257 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.2188 | Train Acc: 0.9339
 Site-MNIST                         | Train Loss: 0.2736 | Train Acc: 0.9242
 Site-MNIST                         | Train Loss: 0.2163 | Train Acc: 0.9402
 Site-MNIST                         | Train Loss: 0.1912 | Train Acc: 0.9525
 Site-USPS                          | Train Loss: 0.4043 | Train Acc: 0.8500
 Site-USPS                          | Train Loss: 0.3180 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.2029 | Train Acc: 0.9147
 Site-USPS                          | Train Loss: 0.3744 | Train Acc: 0.8970
 Site-USPS                          | Train Loss: 0.2479 | Train Acc: 0.9429
 Site-USPS                          | Train Loss: 0.2736 | Train Acc: 0.9101
 Site-SynthDigits                   | Train Loss: 1.4944 | Train Acc: 0.5099
 Site-SynthDigits                   | Train Loss: 1.4368 | Train Acc: 0.5275
 Site-SynthDigits                   | Train Loss: 1.2858 | Train Acc: 0.5703
 Site-MNIST_M                       | Train Loss: 1.7323 | Train Acc: 0.3702
 Site-MNIST_M                       | Train Loss: 1.7469 | Train Acc: 0.4128
 Site-SVHN                          | Train Loss: 2.0818 | Train Acc: 0.2518
Average Train Accuracy: 0.7918
 Site-MNIST                         | Val  Loss: 0.0140 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1781 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4891 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3731 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.2619 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.1890 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.2072 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.1806 | Val  Acc: 0.9608
 Site-MNIST                         | Val  Loss: 0.2401 | Val  Acc: 0.9290
 Site-MNIST                         | Val  Loss: 0.2460 | Val  Acc: 0.9335
 Site-USPS                          | Val  Loss: 0.0863 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4863 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.5242 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.5435 | Val  Acc: 0.8276
 Site-USPS                          | Val  Loss: 0.4432 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.3117 | Val  Acc: 0.9048
 Site-SynthDigits                   | Val  Loss: 1.4130 | Val  Acc: 0.5676
 Site-SynthDigits                   | Val  Loss: 1.4193 | Val  Acc: 0.5294
 Site-SynthDigits                   | Val  Loss: 1.4662 | Val  Acc: 0.5246
 Site-MNIST_M                       | Val  Loss: 1.6362 | Val  Acc: 0.4667
 Site-MNIST_M                       | Val  Loss: 1.5220 | Val  Acc: 0.5062
 Site-SVHN                          | Val  Loss: 1.9403 | Val  Acc: 0.3143
Average Valid Accuracy: 0.8018
 Best site-MNIST                     | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9677
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9608
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9290
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9335
 Best site-USPS                      | Epoch:8 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8750
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8276
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8667
 Best site-USPS                      | Epoch:8 | Val Acc: 0.9048
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5676
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5294
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5246
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.4667
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.5062
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.1244 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.4719 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0653 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1717 | Train Acc: 0.9211
 Site-MNIST                         | Train Loss: 0.1728 | Train Acc: 0.8714
 Site-MNIST                         | Train Loss: 0.2050 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.2250 | Train Acc: 0.9339
 Site-MNIST                         | Train Loss: 0.2492 | Train Acc: 0.9193
 Site-MNIST                         | Train Loss: 0.2003 | Train Acc: 0.9443
 Site-MNIST                         | Train Loss: 0.1722 | Train Acc: 0.9570
 Site-USPS                          | Train Loss: 0.3681 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2788 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.2249 | Train Acc: 0.9147
 Site-USPS                          | Train Loss: 0.3356 | Train Acc: 0.9099
 Site-USPS                          | Train Loss: 0.2363 | Train Acc: 0.9452
 Site-USPS                          | Train Loss: 0.2467 | Train Acc: 0.9272
 Site-SynthDigits                   | Train Loss: 1.4265 | Train Acc: 0.5232
 Site-SynthDigits                   | Train Loss: 1.3932 | Train Acc: 0.5348
 Site-SynthDigits                   | Train Loss: 1.2609 | Train Acc: 0.5723
 Site-MNIST_M                       | Train Loss: 1.7499 | Train Acc: 0.3591
 Site-MNIST_M                       | Train Loss: 1.6912 | Train Acc: 0.4404
 Site-SVHN                          | Train Loss: 2.0339 | Train Acc: 0.2766
Average Train Accuracy: 0.8035
 Site-MNIST                         | Val  Loss: 0.0103 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0907 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4097 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3004 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.2372 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.1621 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.2034 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.1748 | Val  Acc: 0.9608
 Site-MNIST                         | Val  Loss: 0.2406 | Val  Acc: 0.9235
 Site-MNIST                         | Val  Loss: 0.2349 | Val  Acc: 0.9305
 Site-USPS                          | Val  Loss: 0.0843 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4759 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.5085 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.5410 | Val  Acc: 0.8448
 Site-USPS                          | Val  Loss: 0.4234 | Val  Acc: 0.8857
 Site-USPS                          | Val  Loss: 0.2832 | Val  Acc: 0.9259
 Site-SynthDigits                   | Val  Loss: 1.3654 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 1.4028 | Val  Acc: 0.5294
 Site-SynthDigits                   | Val  Loss: 1.4554 | Val  Acc: 0.5246
 Site-MNIST_M                       | Val  Loss: 1.6958 | Val  Acc: 0.4444
 Site-MNIST_M                       | Val  Loss: 1.5621 | Val  Acc: 0.4444
 Site-SVHN                          | Val  Loss: 1.9272 | Val  Acc: 0.3429
Average Valid Accuracy: 0.7988
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.1310 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.4384 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0559 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1506 | Train Acc: 0.9211
 Site-MNIST                         | Train Loss: 0.4044 | Train Acc: 0.9000
 Site-MNIST                         | Train Loss: 0.1868 | Train Acc: 0.9444
 Site-MNIST                         | Train Loss: 0.1881 | Train Acc: 0.9383
 Site-MNIST                         | Train Loss: 0.2364 | Train Acc: 0.9364
 Site-MNIST                         | Train Loss: 0.1865 | Train Acc: 0.9470
 Site-MNIST                         | Train Loss: 0.1485 | Train Acc: 0.9638
 Site-USPS                          | Train Loss: 0.3772 | Train Acc: 0.8500
 Site-USPS                          | Train Loss: 0.2808 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1956 | Train Acc: 0.9225
 Site-USPS                          | Train Loss: 0.3374 | Train Acc: 0.8884
 Site-USPS                          | Train Loss: 0.2273 | Train Acc: 0.9429
 Site-USPS                          | Train Loss: 0.2490 | Train Acc: 0.9193
 Site-SynthDigits                   | Train Loss: 1.5199 | Train Acc: 0.5166
 Site-SynthDigits                   | Train Loss: 1.4127 | Train Acc: 0.5348
 Site-SynthDigits                   | Train Loss: 1.2458 | Train Acc: 0.5662
 Site-MNIST_M                       | Train Loss: 1.7401 | Train Acc: 0.3702
 Site-MNIST_M                       | Train Loss: 1.7746 | Train Acc: 0.4404
 Site-SVHN                          | Train Loss: 2.0651 | Train Acc: 0.2589
Average Train Accuracy: 0.8004
 Site-MNIST                         | Val  Loss: 0.0120 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0816 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4368 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3454 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.2454 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.1403 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1718 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1509 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.2180 | Val  Acc: 0.9344
 Site-MNIST                         | Val  Loss: 0.2159 | Val  Acc: 0.9396
 Site-USPS                          | Val  Loss: 0.0683 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4877 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.5373 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.5360 | Val  Acc: 0.8103
 Site-USPS                          | Val  Loss: 0.4219 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.2879 | Val  Acc: 0.9048
 Site-SynthDigits                   | Val  Loss: 1.3743 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 1.4003 | Val  Acc: 0.5441
 Site-SynthDigits                   | Val  Loss: 1.4293 | Val  Acc: 0.5492
 Site-MNIST_M                       | Val  Loss: 1.6670 | Val  Acc: 0.4222
 Site-MNIST_M                       | Val  Loss: 1.5391 | Val  Acc: 0.4444
 Site-SVHN                          | Val  Loss: 1.8930 | Val  Acc: 0.3143
Average Valid Accuracy: 0.8010
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.1226 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.4325 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0532 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1460 | Train Acc: 0.9211
 Site-MNIST                         | Train Loss: 0.2700 | Train Acc: 0.9143
 Site-MNIST                         | Train Loss: 0.1681 | Train Acc: 0.9444
 Site-MNIST                         | Train Loss: 0.1719 | Train Acc: 0.9427
 Site-MNIST                         | Train Loss: 0.2016 | Train Acc: 0.9340
 Site-MNIST                         | Train Loss: 0.1663 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1373 | Train Acc: 0.9645
 Site-USPS                          | Train Loss: 0.3552 | Train Acc: 0.9000
 Site-USPS                          | Train Loss: 0.2504 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.2174 | Train Acc: 0.9225
 Site-USPS                          | Train Loss: 0.3231 | Train Acc: 0.9013
 Site-USPS                          | Train Loss: 0.2254 | Train Acc: 0.9357
 Site-USPS                          | Train Loss: 0.2326 | Train Acc: 0.9246
 Site-SynthDigits                   | Train Loss: 1.4655 | Train Acc: 0.5099
 Site-SynthDigits                   | Train Loss: 1.3283 | Train Acc: 0.5421
 Site-SynthDigits                   | Train Loss: 1.2347 | Train Acc: 0.5764
 Site-MNIST_M                       | Train Loss: 1.7539 | Train Acc: 0.3702
 Site-MNIST_M                       | Train Loss: 1.7527 | Train Acc: 0.4465
 Site-SVHN                          | Train Loss: 2.0307 | Train Acc: 0.2660
Average Train Accuracy: 0.8053
 Site-MNIST                         | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1032 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3771 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2808 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.2067 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.1255 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1602 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1379 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.2063 | Val  Acc: 0.9290
 Site-MNIST                         | Val  Loss: 0.2000 | Val  Acc: 0.9366
 Site-USPS                          | Val  Loss: 0.0600 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4337 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4646 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.5052 | Val  Acc: 0.8276
 Site-USPS                          | Val  Loss: 0.3970 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.2725 | Val  Acc: 0.9153
 Site-SynthDigits                   | Val  Loss: 1.3376 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 1.3518 | Val  Acc: 0.5588
 Site-SynthDigits                   | Val  Loss: 1.4111 | Val  Acc: 0.5656
 Site-MNIST_M                       | Val  Loss: 1.6785 | Val  Acc: 0.4667
 Site-MNIST_M                       | Val  Loss: 1.5534 | Val  Acc: 0.4568
 Site-SVHN                          | Val  Loss: 1.8756 | Val  Acc: 0.3000
Average Valid Accuracy: 0.8067
 Best site-MNIST                     | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9290
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9366
 Best site-USPS                      | Epoch:11 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8750
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8276
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8667
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9153
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5946
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5588
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5656
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4667
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4568
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.1266 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.4423 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0488 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1398 | Train Acc: 0.9211
 Site-MNIST                         | Train Loss: 0.1616 | Train Acc: 0.8857
 Site-MNIST                         | Train Loss: 0.1579 | Train Acc: 0.9444
 Site-MNIST                         | Train Loss: 0.1639 | Train Acc: 0.9383
 Site-MNIST                         | Train Loss: 0.2017 | Train Acc: 0.9340
 Site-MNIST                         | Train Loss: 0.1589 | Train Acc: 0.9565
 Site-MNIST                         | Train Loss: 0.1311 | Train Acc: 0.9653
 Site-USPS                          | Train Loss: 0.3355 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.3088 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1645 | Train Acc: 0.9225
 Site-USPS                          | Train Loss: 0.3161 | Train Acc: 0.9099
 Site-USPS                          | Train Loss: 0.2029 | Train Acc: 0.9405
 Site-USPS                          | Train Loss: 0.2174 | Train Acc: 0.9312
 Site-SynthDigits                   | Train Loss: 1.4332 | Train Acc: 0.5364
 Site-SynthDigits                   | Train Loss: 1.3849 | Train Acc: 0.5495
 Site-SynthDigits                   | Train Loss: 1.1713 | Train Acc: 0.6008
 Site-MNIST_M                       | Train Loss: 1.7095 | Train Acc: 0.3702
 Site-MNIST_M                       | Train Loss: 1.6003 | Train Acc: 0.4404
 Site-SVHN                          | Train Loss: 2.0367 | Train Acc: 0.2801
Average Train Accuracy: 0.8102
 Site-MNIST                         | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1159 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4009 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2936 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.2110 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.1201 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1550 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.1312 | Val  Acc: 0.9608
 Site-MNIST                         | Val  Loss: 0.1985 | Val  Acc: 0.9344
 Site-MNIST                         | Val  Loss: 0.1957 | Val  Acc: 0.9396
 Site-USPS                          | Val  Loss: 0.0465 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3892 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4342 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.4550 | Val  Acc: 0.8448
 Site-USPS                          | Val  Loss: 0.3664 | Val  Acc: 0.8762
 Site-USPS                          | Val  Loss: 0.2509 | Val  Acc: 0.9206
 Site-SynthDigits                   | Val  Loss: 1.3048 | Val  Acc: 0.5676
 Site-SynthDigits                   | Val  Loss: 1.3468 | Val  Acc: 0.5294
 Site-SynthDigits                   | Val  Loss: 1.3558 | Val  Acc: 0.5574
 Site-MNIST_M                       | Val  Loss: 1.6396 | Val  Acc: 0.4444
 Site-MNIST_M                       | Val  Loss: 1.5013 | Val  Acc: 0.4568
 Site-SVHN                          | Val  Loss: 1.8606 | Val  Acc: 0.3571
Average Valid Accuracy: 0.8044
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.0913 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.4141 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0449 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1263 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1374 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.1463 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1492 | Train Acc: 0.9471
 Site-MNIST                         | Train Loss: 0.1933 | Train Acc: 0.9364
 Site-MNIST                         | Train Loss: 0.1507 | Train Acc: 0.9606
 Site-MNIST                         | Train Loss: 0.1153 | Train Acc: 0.9736
 Site-USPS                          | Train Loss: 0.3466 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.1855 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.2133 | Train Acc: 0.9225
 Site-USPS                          | Train Loss: 0.3344 | Train Acc: 0.9013
 Site-USPS                          | Train Loss: 0.2115 | Train Acc: 0.9262
 Site-USPS                          | Train Loss: 0.2271 | Train Acc: 0.9233
 Site-SynthDigits                   | Train Loss: 1.4680 | Train Acc: 0.5298
 Site-SynthDigits                   | Train Loss: 1.3258 | Train Acc: 0.5348
 Site-SynthDigits                   | Train Loss: 1.1777 | Train Acc: 0.5804
 Site-MNIST_M                       | Train Loss: 1.7405 | Train Acc: 0.3757
 Site-MNIST_M                       | Train Loss: 1.6669 | Train Acc: 0.4526
 Site-SVHN                          | Train Loss: 1.9960 | Train Acc: 0.2837
Average Train Accuracy: 0.8075
 Site-MNIST                         | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0642 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4405 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3167 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.2129 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0945 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1299 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1130 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1819 | Val  Acc: 0.9344
 Site-MNIST                         | Val  Loss: 0.1763 | Val  Acc: 0.9426
 Site-USPS                          | Val  Loss: 0.0570 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4545 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4860 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.5066 | Val  Acc: 0.8276
 Site-USPS                          | Val  Loss: 0.4028 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.2711 | Val  Acc: 0.9153
 Site-SynthDigits                   | Val  Loss: 1.3219 | Val  Acc: 0.5405
 Site-SynthDigits                   | Val  Loss: 1.2456 | Val  Acc: 0.5147
 Site-SynthDigits                   | Val  Loss: 1.3444 | Val  Acc: 0.5410
 Site-MNIST_M                       | Val  Loss: 1.6545 | Val  Acc: 0.4889
 Site-MNIST_M                       | Val  Loss: 1.5180 | Val  Acc: 0.4568
 Site-SVHN                          | Val  Loss: 1.7915 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8065
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.0842 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3951 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0439 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1324 | Train Acc: 0.9211
 Site-MNIST                         | Train Loss: 0.1631 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.1325 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.1537 | Train Acc: 0.9471
 Site-MNIST                         | Train Loss: 0.1914 | Train Acc: 0.9364
 Site-MNIST                         | Train Loss: 0.1399 | Train Acc: 0.9592
 Site-MNIST                         | Train Loss: 0.1130 | Train Acc: 0.9683
 Site-USPS                          | Train Loss: 0.3164 | Train Acc: 0.9000
 Site-USPS                          | Train Loss: 0.2663 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 1.2779 | Train Acc: 0.9147
 Site-USPS                          | Train Loss: 0.2930 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.1984 | Train Acc: 0.9429
 Site-USPS                          | Train Loss: 0.2084 | Train Acc: 0.9272
 Site-SynthDigits                   | Train Loss: 1.3508 | Train Acc: 0.5232
 Site-SynthDigits                   | Train Loss: 1.2474 | Train Acc: 0.5641
 Site-SynthDigits                   | Train Loss: 1.1389 | Train Acc: 0.6029
 Site-MNIST_M                       | Train Loss: 1.7193 | Train Acc: 0.3923
 Site-MNIST_M                       | Train Loss: 1.6844 | Train Acc: 0.4557
 Site-SVHN                          | Train Loss: 2.0339 | Train Acc: 0.2979
Average Train Accuracy: 0.8132
 Site-MNIST                         | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0495 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3931 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2564 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1922 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0849 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1329 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1147 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1895 | Val  Acc: 0.9344
 Site-MNIST                         | Val  Loss: 0.1784 | Val  Acc: 0.9426
 Site-USPS                          | Val  Loss: 0.0449 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3711 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4165 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.4401 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.3623 | Val  Acc: 0.8952
 Site-USPS                          | Val  Loss: 0.2410 | Val  Acc: 0.9259
 Site-SynthDigits                   | Val  Loss: 1.2536 | Val  Acc: 0.6216
 Site-SynthDigits                   | Val  Loss: 1.2521 | Val  Acc: 0.5882
 Site-SynthDigits                   | Val  Loss: 1.3112 | Val  Acc: 0.5738
 Site-MNIST_M                       | Val  Loss: 1.6607 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.5199 | Val  Acc: 0.4815
 Site-SVHN                          | Val  Loss: 1.8282 | Val  Acc: 0.3571
Average Valid Accuracy: 0.8216
 Best site-MNIST                     | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9344
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9426
 Best site-USPS                      | Epoch:14 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:14 | Val Acc: 0.9062
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8621
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8952
 Best site-USPS                      | Epoch:14 | Val Acc: 0.9259
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.6216
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5882
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5738
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.5333
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4815
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.1155 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3696 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0303 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1114 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.2056 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.1272 | Train Acc: 0.9365
 Site-MNIST                         | Train Loss: 0.1430 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1946 | Train Acc: 0.9315
 Site-MNIST                         | Train Loss: 0.1408 | Train Acc: 0.9565
 Site-MNIST                         | Train Loss: 0.1010 | Train Acc: 0.9713
 Site-USPS                          | Train Loss: 0.3196 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.2729 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1692 | Train Acc: 0.9225
 Site-USPS                          | Train Loss: 0.3029 | Train Acc: 0.9013
 Site-USPS                          | Train Loss: 0.1977 | Train Acc: 0.9381
 Site-USPS                          | Train Loss: 0.2126 | Train Acc: 0.9246
 Site-SynthDigits                   | Train Loss: 1.3218 | Train Acc: 0.5298
 Site-SynthDigits                   | Train Loss: 1.3120 | Train Acc: 0.5568
 Site-SynthDigits                   | Train Loss: 1.1365 | Train Acc: 0.6212
 Site-MNIST_M                       | Train Loss: 1.7196 | Train Acc: 0.3978
 Site-MNIST_M                       | Train Loss: 1.6440 | Train Acc: 0.4648
 Site-SVHN                          | Train Loss: 1.9894 | Train Acc: 0.2837
Average Train Accuracy: 0.8153
 Site-MNIST                         | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1013 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4780 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3250 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.2032 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0861 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1257 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1128 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1885 | Val  Acc: 0.9290
 Site-MNIST                         | Val  Loss: 0.1735 | Val  Acc: 0.9456
 Site-USPS                          | Val  Loss: 0.0391 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4161 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4463 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.4567 | Val  Acc: 0.8276
 Site-USPS                          | Val  Loss: 0.3781 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.2561 | Val  Acc: 0.9259
 Site-SynthDigits                   | Val  Loss: 1.2533 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 1.1685 | Val  Acc: 0.5588
 Site-SynthDigits                   | Val  Loss: 1.3039 | Val  Acc: 0.5574
 Site-MNIST_M                       | Val  Loss: 1.6372 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.4894 | Val  Acc: 0.4815
 Site-SVHN                          | Val  Loss: 1.8003 | Val  Acc: 0.3571
Average Valid Accuracy: 0.8125
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.0998 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3763 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0329 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1150 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.3300 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.1275 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.1467 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1743 | Train Acc: 0.9438
 Site-MNIST                         | Train Loss: 0.1288 | Train Acc: 0.9633
 Site-MNIST                         | Train Loss: 0.0973 | Train Acc: 0.9751
 Site-USPS                          | Train Loss: 0.2937 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.1495 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1833 | Train Acc: 0.9147
 Site-USPS                          | Train Loss: 0.2685 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.1731 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1920 | Train Acc: 0.9365
 Site-SynthDigits                   | Train Loss: 1.3682 | Train Acc: 0.5364
 Site-SynthDigits                   | Train Loss: 1.2750 | Train Acc: 0.5678
 Site-SynthDigits                   | Train Loss: 1.0976 | Train Acc: 0.6191
 Site-MNIST_M                       | Train Loss: 1.6603 | Train Acc: 0.4144
 Site-MNIST_M                       | Train Loss: 1.5634 | Train Acc: 0.4709
 Site-SVHN                          | Train Loss: 1.9750 | Train Acc: 0.2730
Average Train Accuracy: 0.8200
 Site-MNIST                         | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0567 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3322 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2229 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1601 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0810 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1189 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1029 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1748 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1662 | Val  Acc: 0.9517
 Site-USPS                          | Val  Loss: 0.0378 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3496 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4008 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.4073 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.3393 | Val  Acc: 0.8857
 Site-USPS                          | Val  Loss: 0.2276 | Val  Acc: 0.9153
 Site-SynthDigits                   | Val  Loss: 1.2317 | Val  Acc: 0.5676
 Site-SynthDigits                   | Val  Loss: 1.2256 | Val  Acc: 0.5441
 Site-SynthDigits                   | Val  Loss: 1.2899 | Val  Acc: 0.5574
 Site-MNIST_M                       | Val  Loss: 1.5816 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.4506 | Val  Acc: 0.5062
 Site-SVHN                          | Val  Loss: 1.8117 | Val  Acc: 0.3143
Average Valid Accuracy: 0.8164
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.0974 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3828 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0358 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1155 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.3984 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.1247 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.1322 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1845 | Train Acc: 0.9413
 Site-MNIST                         | Train Loss: 0.1208 | Train Acc: 0.9647
 Site-MNIST                         | Train Loss: 0.0926 | Train Acc: 0.9758
 Site-USPS                          | Train Loss: 0.2869 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.3778 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.1858 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.2854 | Train Acc: 0.9056
 Site-USPS                          | Train Loss: 0.1748 | Train Acc: 0.9476
 Site-USPS                          | Train Loss: 0.1883 | Train Acc: 0.9378
 Site-SynthDigits                   | Train Loss: 1.4669 | Train Acc: 0.5364
 Site-SynthDigits                   | Train Loss: 1.2816 | Train Acc: 0.5531
 Site-SynthDigits                   | Train Loss: 1.0929 | Train Acc: 0.6375
 Site-MNIST_M                       | Train Loss: 1.6773 | Train Acc: 0.4088
 Site-MNIST_M                       | Train Loss: 1.6615 | Train Acc: 0.4740
 Site-SVHN                          | Train Loss: 1.9732 | Train Acc: 0.2837
Average Train Accuracy: 0.8205
 Site-MNIST                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0773 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3807 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2496 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1621 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0706 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1117 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0979 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1731 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1631 | Val  Acc: 0.9547
 Site-USPS                          | Val  Loss: 0.0344 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3356 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3915 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.4170 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.3476 | Val  Acc: 0.8762
 Site-USPS                          | Val  Loss: 0.2298 | Val  Acc: 0.9259
 Site-SynthDigits                   | Val  Loss: 1.1970 | Val  Acc: 0.5676
 Site-SynthDigits                   | Val  Loss: 1.2121 | Val  Acc: 0.5294
 Site-SynthDigits                   | Val  Loss: 1.2702 | Val  Acc: 0.5492
 Site-MNIST_M                       | Val  Loss: 1.6103 | Val  Acc: 0.5111
 Site-MNIST_M                       | Val  Loss: 1.4715 | Val  Acc: 0.5062
 Site-SVHN                          | Val  Loss: 1.8157 | Val  Acc: 0.3286
Average Valid Accuracy: 0.8167
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.0678 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3654 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0337 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1186 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.2190 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.1151 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1202 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1575 | Train Acc: 0.9487
 Site-MNIST                         | Train Loss: 0.1108 | Train Acc: 0.9688
 Site-MNIST                         | Train Loss: 0.0870 | Train Acc: 0.9789
 Site-USPS                          | Train Loss: 0.2757 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.1340 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.2748 | Train Acc: 0.9225
 Site-USPS                          | Train Loss: 0.2676 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.1701 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1824 | Train Acc: 0.9339
 Site-SynthDigits                   | Train Loss: 1.3529 | Train Acc: 0.5430
 Site-SynthDigits                   | Train Loss: 1.1966 | Train Acc: 0.5824
 Site-SynthDigits                   | Train Loss: 1.0799 | Train Acc: 0.6212
 Site-MNIST_M                       | Train Loss: 1.6839 | Train Acc: 0.4088
 Site-MNIST_M                       | Train Loss: 1.6204 | Train Acc: 0.4587
 Site-SVHN                          | Train Loss: 2.0091 | Train Acc: 0.2908
Average Train Accuracy: 0.8219
 Site-MNIST                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0375 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3620 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2338 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1580 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0560 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0990 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0894 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1620 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1533 | Val  Acc: 0.9547
 Site-USPS                          | Val  Loss: 0.0276 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3204 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3911 | Val  Acc: 0.9375
 Site-USPS                          | Val  Loss: 0.3990 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.3323 | Val  Acc: 0.8762
 Site-USPS                          | Val  Loss: 0.2196 | Val  Acc: 0.9206
 Site-SynthDigits                   | Val  Loss: 1.2022 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 1.1742 | Val  Acc: 0.5735
 Site-SynthDigits                   | Val  Loss: 1.2635 | Val  Acc: 0.5902
 Site-MNIST_M                       | Val  Loss: 1.6265 | Val  Acc: 0.5111
 Site-MNIST_M                       | Val  Loss: 1.4807 | Val  Acc: 0.4938
 Site-SVHN                          | Val  Loss: 1.7875 | Val  Acc: 0.3286
Average Valid Accuracy: 0.8249
 Best site-MNIST                     | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9399
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9547
 Best site-USPS                      | Epoch:18 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:18 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9375
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8621
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8762
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9206
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.5946
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.5735
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.5902
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.5111
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.4938
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.0640 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3863 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0277 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1109 | Train Acc: 0.9211
 Site-MNIST                         | Train Loss: 0.1367 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.1060 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.1196 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1613 | Train Acc: 0.9413
 Site-MNIST                         | Train Loss: 0.1111 | Train Acc: 0.9674
 Site-MNIST                         | Train Loss: 0.0793 | Train Acc: 0.9834
 Site-USPS                          | Train Loss: 0.2702 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2592 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1414 | Train Acc: 0.9147
 Site-USPS                          | Train Loss: 0.2651 | Train Acc: 0.9013
 Site-USPS                          | Train Loss: 0.1548 | Train Acc: 0.9619
 Site-USPS                          | Train Loss: 0.1733 | Train Acc: 0.9431
 Site-SynthDigits                   | Train Loss: 1.3555 | Train Acc: 0.5497
 Site-SynthDigits                   | Train Loss: 1.2235 | Train Acc: 0.5897
 Site-SynthDigits                   | Train Loss: 1.0464 | Train Acc: 0.6375
 Site-MNIST_M                       | Train Loss: 1.6841 | Train Acc: 0.4475
 Site-MNIST_M                       | Train Loss: 1.5000 | Train Acc: 0.4832
 Site-SVHN                          | Train Loss: 2.0078 | Train Acc: 0.2766
Average Train Accuracy: 0.8260
 Site-MNIST                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0398 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4003 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2732 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1877 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0644 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1028 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0900 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1572 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1451 | Val  Acc: 0.9547
 Site-USPS                          | Val  Loss: 0.0360 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3489 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4174 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.4187 | Val  Acc: 0.8448
 Site-USPS                          | Val  Loss: 0.3336 | Val  Acc: 0.8762
 Site-USPS                          | Val  Loss: 0.2105 | Val  Acc: 0.9259
 Site-SynthDigits                   | Val  Loss: 1.1848 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 1.2032 | Val  Acc: 0.5588
 Site-SynthDigits                   | Val  Loss: 1.2397 | Val  Acc: 0.5820
 Site-MNIST_M                       | Val  Loss: 1.6218 | Val  Acc: 0.6000
 Site-MNIST_M                       | Val  Loss: 1.4772 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.7904 | Val  Acc: 0.3429
Average Valid Accuracy: 0.8215
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.0620 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3861 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0235 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1072 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1254 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.1024 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.1104 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1700 | Train Acc: 0.9389
 Site-MNIST                         | Train Loss: 0.1055 | Train Acc: 0.9633
 Site-MNIST                         | Train Loss: 0.0726 | Train Acc: 0.9842
 Site-USPS                          | Train Loss: 0.2633 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1033 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1435 | Train Acc: 0.9225
 Site-USPS                          | Train Loss: 0.2480 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.1629 | Train Acc: 0.9548
 Site-USPS                          | Train Loss: 0.1700 | Train Acc: 0.9392
 Site-SynthDigits                   | Train Loss: 1.2399 | Train Acc: 0.5563
 Site-SynthDigits                   | Train Loss: 1.1948 | Train Acc: 0.5897
 Site-SynthDigits                   | Train Loss: 1.0352 | Train Acc: 0.6477
 Site-MNIST_M                       | Train Loss: 1.7001 | Train Acc: 0.4199
 Site-MNIST_M                       | Train Loss: 1.6826 | Train Acc: 0.4801
 Site-SVHN                          | Train Loss: 1.9274 | Train Acc: 0.2872
Average Train Accuracy: 0.8282
 Site-MNIST                         | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0262 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4331 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2853 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1918 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0560 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0971 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0854 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1535 | Val  Acc: 0.9344
 Site-MNIST                         | Val  Loss: 0.1402 | Val  Acc: 0.9517
 Site-USPS                          | Val  Loss: 0.0304 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3449 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.4118 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.4090 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.3282 | Val  Acc: 0.8857
 Site-USPS                          | Val  Loss: 0.2076 | Val  Acc: 0.9418
 Site-SynthDigits                   | Val  Loss: 1.1681 | Val  Acc: 0.6216
 Site-SynthDigits                   | Val  Loss: 1.1866 | Val  Acc: 0.5882
 Site-SynthDigits                   | Val  Loss: 1.2264 | Val  Acc: 0.5984
 Site-MNIST_M                       | Val  Loss: 1.6346 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.4786 | Val  Acc: 0.5309
 Site-SVHN                          | Val  Loss: 1.7281 | Val  Acc: 0.3286
Average Valid Accuracy: 0.8265
 Best site-MNIST                     | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9344
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9517
 Best site-USPS                      | Epoch:20 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8750
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8621
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8857
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9418
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.6216
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5882
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5984
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5309
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.0495 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.4174 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0227 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0993 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1148 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.1060 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.1208 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1638 | Train Acc: 0.9438
 Site-MNIST                         | Train Loss: 0.1037 | Train Acc: 0.9647
 Site-MNIST                         | Train Loss: 0.0768 | Train Acc: 0.9834
 Site-USPS                          | Train Loss: 0.2543 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.1008 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.7753 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.2510 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.1519 | Train Acc: 0.9524
 Site-USPS                          | Train Loss: 0.1598 | Train Acc: 0.9484
 Site-SynthDigits                   | Train Loss: 1.2640 | Train Acc: 0.5430
 Site-SynthDigits                   | Train Loss: 1.1628 | Train Acc: 0.5824
 Site-SynthDigits                   | Train Loss: 1.0227 | Train Acc: 0.6477
 Site-MNIST_M                       | Train Loss: 1.6554 | Train Acc: 0.4309
 Site-MNIST_M                       | Train Loss: 1.4726 | Train Acc: 0.4924
 Site-SVHN                          | Train Loss: 1.9696 | Train Acc: 0.3085
Average Train Accuracy: 0.8265
 Site-MNIST                         | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0344 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3797 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2539 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1769 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0648 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1059 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0868 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1477 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1301 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0358 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2984 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3745 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3801 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.3238 | Val  Acc: 0.8762
 Site-USPS                          | Val  Loss: 0.1966 | Val  Acc: 0.9365
 Site-SynthDigits                   | Val  Loss: 1.1493 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 1.1150 | Val  Acc: 0.5588
 Site-SynthDigits                   | Val  Loss: 1.2118 | Val  Acc: 0.5820
 Site-MNIST_M                       | Val  Loss: 1.5742 | Val  Acc: 0.5778
 Site-MNIST_M                       | Val  Loss: 1.4236 | Val  Acc: 0.5432
 Site-SVHN                          | Val  Loss: 1.7498 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8272
 Best site-MNIST                     | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9399
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9577
 Best site-USPS                      | Epoch:21 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:21 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8750
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8621
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8762
 Best site-USPS                      | Epoch:21 | Val Acc: 0.9365
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.5946
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.5588
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.5820
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.5778
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.5432
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.3857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.0394 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3690 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0285 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0919 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.4048 | Train Acc: 0.9143
 Site-MNIST                         | Train Loss: 0.0939 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.1035 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1367 | Train Acc: 0.9487
 Site-MNIST                         | Train Loss: 0.1004 | Train Acc: 0.9688
 Site-MNIST                         | Train Loss: 0.0652 | Train Acc: 0.9857
 Site-USPS                          | Train Loss: 0.2525 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.1129 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1446 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.2421 | Train Acc: 0.9185
 Site-USPS                          | Train Loss: 0.1499 | Train Acc: 0.9452
 Site-USPS                          | Train Loss: 0.1703 | Train Acc: 0.9431
 Site-SynthDigits                   | Train Loss: 1.2487 | Train Acc: 0.5497
 Site-SynthDigits                   | Train Loss: 1.2281 | Train Acc: 0.5824
 Site-SynthDigits                   | Train Loss: 1.0383 | Train Acc: 0.6538
 Site-MNIST_M                       | Train Loss: 1.6825 | Train Acc: 0.4365
 Site-MNIST_M                       | Train Loss: 1.5267 | Train Acc: 0.4862
 Site-SVHN                          | Train Loss: 1.9756 | Train Acc: 0.3014
Average Train Accuracy: 0.8278
 Site-MNIST                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0313 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3800 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2610 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1706 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0520 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0879 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0774 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1442 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1282 | Val  Acc: 0.9547
 Site-USPS                          | Val  Loss: 0.0222 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3065 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3791 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3714 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.3181 | Val  Acc: 0.8857
 Site-USPS                          | Val  Loss: 0.2070 | Val  Acc: 0.9312
 Site-SynthDigits                   | Val  Loss: 1.1823 | Val  Acc: 0.5405
 Site-SynthDigits                   | Val  Loss: 1.1643 | Val  Acc: 0.5441
 Site-SynthDigits                   | Val  Loss: 1.2478 | Val  Acc: 0.5656
 Site-MNIST_M                       | Val  Loss: 1.6387 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.4959 | Val  Acc: 0.5062
 Site-SVHN                          | Val  Loss: 1.7555 | Val  Acc: 0.3571
Average Valid Accuracy: 0.8198
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.0437 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3821 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0209 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0951 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.3079 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0943 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.1112 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1471 | Train Acc: 0.9462
 Site-MNIST                         | Train Loss: 0.0906 | Train Acc: 0.9660
 Site-MNIST                         | Train Loss: 0.0630 | Train Acc: 0.9887
 Site-USPS                          | Train Loss: 0.2562 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2419 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1232 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.2313 | Train Acc: 0.9227
 Site-USPS                          | Train Loss: 0.1392 | Train Acc: 0.9619
 Site-USPS                          | Train Loss: 0.1555 | Train Acc: 0.9524
 Site-SynthDigits                   | Train Loss: 1.2865 | Train Acc: 0.5430
 Site-SynthDigits                   | Train Loss: 1.2324 | Train Acc: 0.5897
 Site-SynthDigits                   | Train Loss: 1.0055 | Train Acc: 0.6599
 Site-MNIST_M                       | Train Loss: 1.6807 | Train Acc: 0.4254
 Site-MNIST_M                       | Train Loss: 1.6014 | Train Acc: 0.4862
 Site-SVHN                          | Train Loss: 1.9599 | Train Acc: 0.2908
Average Train Accuracy: 0.8333
 Site-MNIST                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0220 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3406 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2340 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1793 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0619 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0938 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0778 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1431 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1265 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0178 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2578 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3242 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3517 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2936 | Val  Acc: 0.8952
 Site-USPS                          | Val  Loss: 0.1887 | Val  Acc: 0.9418
 Site-SynthDigits                   | Val  Loss: 1.1276 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 1.1181 | Val  Acc: 0.5735
 Site-SynthDigits                   | Val  Loss: 1.2037 | Val  Acc: 0.5902
 Site-MNIST_M                       | Val  Loss: 1.6354 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.4902 | Val  Acc: 0.5185
 Site-SVHN                          | Val  Loss: 1.7853 | Val  Acc: 0.3286
Average Valid Accuracy: 0.8258
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.0502 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3733 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0172 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0855 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1114 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0990 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.1173 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1609 | Train Acc: 0.9413
 Site-MNIST                         | Train Loss: 0.0903 | Train Acc: 0.9701
 Site-MNIST                         | Train Loss: 0.0613 | Train Acc: 0.9887
 Site-USPS                          | Train Loss: 0.2272 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0890 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1424 | Train Acc: 0.9225
 Site-USPS                          | Train Loss: 0.2209 | Train Acc: 0.9313
 Site-USPS                          | Train Loss: 0.1335 | Train Acc: 0.9595
 Site-USPS                          | Train Loss: 0.1512 | Train Acc: 0.9524
 Site-SynthDigits                   | Train Loss: 1.3126 | Train Acc: 0.5497
 Site-SynthDigits                   | Train Loss: 1.1732 | Train Acc: 0.6007
 Site-SynthDigits                   | Train Loss: 0.9972 | Train Acc: 0.6640
 Site-MNIST_M                       | Train Loss: 1.6698 | Train Acc: 0.4088
 Site-MNIST_M                       | Train Loss: 1.6606 | Train Acc: 0.4862
 Site-SVHN                          | Train Loss: 1.9638 | Train Acc: 0.2872
Average Train Accuracy: 0.8332
 Site-MNIST                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0145 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3023 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2102 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1481 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0494 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0942 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0792 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1441 | Val  Acc: 0.9344
 Site-MNIST                         | Val  Loss: 0.1215 | Val  Acc: 0.9547
 Site-USPS                          | Val  Loss: 0.0268 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3313 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.3764 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.3765 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.3034 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1851 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 1.1249 | Val  Acc: 0.6216
 Site-SynthDigits                   | Val  Loss: 1.1220 | Val  Acc: 0.6029
 Site-SynthDigits                   | Val  Loss: 1.2122 | Val  Acc: 0.5902
 Site-MNIST_M                       | Val  Loss: 1.6181 | Val  Acc: 0.4889
 Site-MNIST_M                       | Val  Loss: 1.4557 | Val  Acc: 0.4815
 Site-SVHN                          | Val  Loss: 1.7535 | Val  Acc: 0.3571
Average Valid Accuracy: 0.8191
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.0303 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.4016 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0172 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0943 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1078 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0960 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0957 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1434 | Train Acc: 0.9413
 Site-MNIST                         | Train Loss: 0.0850 | Train Acc: 0.9660
 Site-MNIST                         | Train Loss: 0.0610 | Train Acc: 0.9879
 Site-USPS                          | Train Loss: 0.2203 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1242 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1171 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.2107 | Train Acc: 0.9270
 Site-USPS                          | Train Loss: 0.1378 | Train Acc: 0.9548
 Site-USPS                          | Train Loss: 0.1443 | Train Acc: 0.9497
 Site-SynthDigits                   | Train Loss: 1.2166 | Train Acc: 0.5695
 Site-SynthDigits                   | Train Loss: 1.2529 | Train Acc: 0.5861
 Site-SynthDigits                   | Train Loss: 1.0024 | Train Acc: 0.6619
 Site-MNIST_M                       | Train Loss: 1.6684 | Train Acc: 0.4033
 Site-MNIST_M                       | Train Loss: 1.5738 | Train Acc: 0.4832
 Site-SVHN                          | Train Loss: 1.9824 | Train Acc: 0.3121
Average Train Accuracy: 0.8327
 Site-MNIST                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0120 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2924 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1872 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1434 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0475 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0877 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0752 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1436 | Val  Acc: 0.9344
 Site-MNIST                         | Val  Loss: 0.1213 | Val  Acc: 0.9517
 Site-USPS                          | Val  Loss: 0.0234 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2878 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.3442 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.3559 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.2909 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1791 | Val  Acc: 0.9471
 Site-SynthDigits                   | Val  Loss: 1.1123 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 1.0759 | Val  Acc: 0.5882
 Site-SynthDigits                   | Val  Loss: 1.1977 | Val  Acc: 0.5984
 Site-MNIST_M                       | Val  Loss: 1.6369 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.4591 | Val  Acc: 0.5185
 Site-SVHN                          | Val  Loss: 1.7315 | Val  Acc: 0.3429
Average Valid Accuracy: 0.8190
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.0496 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3884 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0142 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0912 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1097 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0902 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.1017 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1389 | Train Acc: 0.9413
 Site-MNIST                         | Train Loss: 0.0869 | Train Acc: 0.9728
 Site-MNIST                         | Train Loss: 0.0559 | Train Acc: 0.9887
 Site-USPS                          | Train Loss: 0.2345 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2233 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.1171 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.2113 | Train Acc: 0.9313
 Site-USPS                          | Train Loss: 0.1274 | Train Acc: 0.9643
 Site-USPS                          | Train Loss: 0.1381 | Train Acc: 0.9563
 Site-SynthDigits                   | Train Loss: 1.1930 | Train Acc: 0.5629
 Site-SynthDigits                   | Train Loss: 1.1517 | Train Acc: 0.6264
 Site-SynthDigits                   | Train Loss: 0.9633 | Train Acc: 0.6680
 Site-MNIST_M                       | Train Loss: 1.6506 | Train Acc: 0.4420
 Site-MNIST_M                       | Train Loss: 1.3771 | Train Acc: 0.5015
 Site-SVHN                          | Train Loss: 1.9521 | Train Acc: 0.3121
Average Train Accuracy: 0.8405
 Site-MNIST                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0168 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3197 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2153 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1595 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0541 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0911 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0770 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1401 | Val  Acc: 0.9344
 Site-MNIST                         | Val  Loss: 0.1235 | Val  Acc: 0.9547
 Site-USPS                          | Val  Loss: 0.0147 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2486 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3241 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3398 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2824 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1750 | Val  Acc: 0.9471
 Site-SynthDigits                   | Val  Loss: 1.0897 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 1.1307 | Val  Acc: 0.6324
 Site-SynthDigits                   | Val  Loss: 1.1642 | Val  Acc: 0.6311
 Site-MNIST_M                       | Val  Loss: 1.5999 | Val  Acc: 0.6000
 Site-MNIST_M                       | Val  Loss: 1.4272 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.7239 | Val  Acc: 0.3429
Average Valid Accuracy: 0.8351
 Best site-MNIST                     | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9344
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9547
 Best site-USPS                      | Epoch:26 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8750
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8793
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9048
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9471
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.6486
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.6324
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.6311
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.6000
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5679
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.3429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.0443 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.4079 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0199 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0932 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.3997 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0902 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.1114 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1439 | Train Acc: 0.9438
 Site-MNIST                         | Train Loss: 0.0840 | Train Acc: 0.9701
 Site-MNIST                         | Train Loss: 0.0558 | Train Acc: 0.9887
 Site-USPS                          | Train Loss: 0.2238 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0861 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1133 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.2100 | Train Acc: 0.9270
 Site-USPS                          | Train Loss: 0.1305 | Train Acc: 0.9619
 Site-USPS                          | Train Loss: 0.1320 | Train Acc: 0.9590
 Site-SynthDigits                   | Train Loss: 1.1959 | Train Acc: 0.5695
 Site-SynthDigits                   | Train Loss: 1.1133 | Train Acc: 0.6117
 Site-SynthDigits                   | Train Loss: 0.9537 | Train Acc: 0.6701
 Site-MNIST_M                       | Train Loss: 1.6714 | Train Acc: 0.4475
 Site-MNIST_M                       | Train Loss: 1.4332 | Train Acc: 0.4862
 Site-SVHN                          | Train Loss: 1.9508 | Train Acc: 0.3085
Average Train Accuracy: 0.8370
 Site-MNIST                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2843 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1820 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1580 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.0568 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1004 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.0767 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1357 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1145 | Val  Acc: 0.9607
 Site-USPS                          | Val  Loss: 0.0169 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2522 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3253 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3503 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.2854 | Val  Acc: 0.8952
 Site-USPS                          | Val  Loss: 0.1708 | Val  Acc: 0.9471
 Site-SynthDigits                   | Val  Loss: 1.0662 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 1.0856 | Val  Acc: 0.6176
 Site-SynthDigits                   | Val  Loss: 1.1351 | Val  Acc: 0.6230
 Site-MNIST_M                       | Val  Loss: 1.6483 | Val  Acc: 0.6000
 Site-MNIST_M                       | Val  Loss: 1.4763 | Val  Acc: 0.5802
 Site-SVHN                          | Val  Loss: 1.6907 | Val  Acc: 0.3429
Average Valid Accuracy: 0.8290
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.0569 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3701 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0198 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0761 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1075 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.0849 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0960 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1584 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.0764 | Train Acc: 0.9715
 Site-MNIST                         | Train Loss: 0.0478 | Train Acc: 0.9894
 Site-USPS                          | Train Loss: 0.2284 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0942 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1261 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.2237 | Train Acc: 0.9185
 Site-USPS                          | Train Loss: 0.1298 | Train Acc: 0.9643
 Site-USPS                          | Train Loss: 0.1475 | Train Acc: 0.9497
 Site-SynthDigits                   | Train Loss: 1.2232 | Train Acc: 0.5497
 Site-SynthDigits                   | Train Loss: 1.1476 | Train Acc: 0.6154
 Site-SynthDigits                   | Train Loss: 0.9350 | Train Acc: 0.6843
 Site-MNIST_M                       | Train Loss: 1.6703 | Train Acc: 0.4309
 Site-MNIST_M                       | Train Loss: 1.5386 | Train Acc: 0.4954
 Site-SVHN                          | Train Loss: 1.9034 | Train Acc: 0.3121
Average Train Accuracy: 0.8351
 Site-MNIST                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0257 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4252 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2733 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1729 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0402 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0783 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0720 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1324 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.1178 | Val  Acc: 0.9607
 Site-USPS                          | Val  Loss: 0.0152 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2645 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3338 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3213 | Val  Acc: 0.9138
 Site-USPS                          | Val  Loss: 0.2880 | Val  Acc: 0.8857
 Site-USPS                          | Val  Loss: 0.1906 | Val  Acc: 0.9312
 Site-SynthDigits                   | Val  Loss: 1.0877 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 1.0750 | Val  Acc: 0.5882
 Site-SynthDigits                   | Val  Loss: 1.1505 | Val  Acc: 0.5902
 Site-MNIST_M                       | Val  Loss: 1.6723 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.4743 | Val  Acc: 0.5432
 Site-SVHN                          | Val  Loss: 1.6896 | Val  Acc: 0.3571
Average Valid Accuracy: 0.8300
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.0457 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3840 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0163 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0748 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.4688 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.0835 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.1063 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1305 | Train Acc: 0.9438
 Site-MNIST                         | Train Loss: 0.0818 | Train Acc: 0.9715
 Site-MNIST                         | Train Loss: 0.0475 | Train Acc: 0.9902
 Site-USPS                          | Train Loss: 0.2207 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2051 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.1289 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.2172 | Train Acc: 0.9356
 Site-USPS                          | Train Loss: 0.1341 | Train Acc: 0.9643
 Site-USPS                          | Train Loss: 0.1287 | Train Acc: 0.9577
 Site-SynthDigits                   | Train Loss: 1.2158 | Train Acc: 0.5497
 Site-SynthDigits                   | Train Loss: 1.0573 | Train Acc: 0.6081
 Site-SynthDigits                   | Train Loss: 0.9110 | Train Acc: 0.6925
 Site-MNIST_M                       | Train Loss: 1.6341 | Train Acc: 0.4475
 Site-MNIST_M                       | Train Loss: 1.4145 | Train Acc: 0.4985
 Site-SVHN                          | Train Loss: 1.8929 | Train Acc: 0.3298
Average Train Accuracy: 0.8408
 Site-MNIST                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0221 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2836 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1956 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1446 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0507 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0975 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0798 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1368 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1197 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0116 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2286 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3010 | Val  Acc: 0.9375
 Site-USPS                          | Val  Loss: 0.3196 | Val  Acc: 0.9138
 Site-USPS                          | Val  Loss: 0.2815 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1742 | Val  Acc: 0.9471
 Site-SynthDigits                   | Val  Loss: 1.0575 | Val  Acc: 0.6216
 Site-SynthDigits                   | Val  Loss: 1.0696 | Val  Acc: 0.6029
 Site-SynthDigits                   | Val  Loss: 1.1276 | Val  Acc: 0.6066
 Site-MNIST_M                       | Val  Loss: 1.6561 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.4641 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.7127 | Val  Acc: 0.3571
Average Valid Accuracy: 0.8393
 Best site-MNIST                     | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9399
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9577
 Best site-USPS                      | Epoch:29 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:29 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9375
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9138
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9048
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9471
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.6216
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.6029
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.6066
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.5556
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.0333 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3712 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0172 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0862 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.3782 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0759 | Train Acc: 0.9841
 Site-MNIST                         | Train Loss: 0.0930 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1325 | Train Acc: 0.9462
 Site-MNIST                         | Train Loss: 0.0731 | Train Acc: 0.9755
 Site-MNIST                         | Train Loss: 0.0454 | Train Acc: 0.9917
 Site-USPS                          | Train Loss: 0.2264 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0868 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1449 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.2181 | Train Acc: 0.9185
 Site-USPS                          | Train Loss: 0.1264 | Train Acc: 0.9595
 Site-USPS                          | Train Loss: 0.1276 | Train Acc: 0.9630
 Site-SynthDigits                   | Train Loss: 1.2400 | Train Acc: 0.5762
 Site-SynthDigits                   | Train Loss: 1.1528 | Train Acc: 0.6227
 Site-SynthDigits                   | Train Loss: 0.9347 | Train Acc: 0.6782
 Site-MNIST_M                       | Train Loss: 1.6903 | Train Acc: 0.4254
 Site-MNIST_M                       | Train Loss: 1.6586 | Train Acc: 0.4924
 Site-SVHN                          | Train Loss: 1.9181 | Train Acc: 0.3333
Average Train Accuracy: 0.8405
 Site-MNIST                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0091 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3802 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2425 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1909 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.0545 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.0892 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.0714 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1315 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1157 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0158 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2296 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3042 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3429 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.2871 | Val  Acc: 0.8857
 Site-USPS                          | Val  Loss: 0.1730 | Val  Acc: 0.9471
 Site-SynthDigits                   | Val  Loss: 1.0594 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.0888 | Val  Acc: 0.6765
 Site-SynthDigits                   | Val  Loss: 1.1408 | Val  Acc: 0.6557
 Site-MNIST_M                       | Val  Loss: 1.6990 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.5102 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.6787 | Val  Acc: 0.3571
Average Valid Accuracy: 0.8338
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.0395 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3510 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0121 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0686 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1801 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0739 | Train Acc: 0.9841
 Site-MNIST                         | Train Loss: 0.0957 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1377 | Train Acc: 0.9413
 Site-MNIST                         | Train Loss: 0.0752 | Train Acc: 0.9742
 Site-MNIST                         | Train Loss: 0.0430 | Train Acc: 0.9917
 Site-USPS                          | Train Loss: 0.2287 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2122 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1115 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.2148 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.1186 | Train Acc: 0.9643
 Site-USPS                          | Train Loss: 0.1271 | Train Acc: 0.9590
 Site-SynthDigits                   | Train Loss: 1.1510 | Train Acc: 0.5695
 Site-SynthDigits                   | Train Loss: 1.0669 | Train Acc: 0.6190
 Site-SynthDigits                   | Train Loss: 0.9167 | Train Acc: 0.6884
 Site-MNIST_M                       | Train Loss: 1.6399 | Train Acc: 0.4586
 Site-MNIST_M                       | Train Loss: 1.5777 | Train Acc: 0.4924
 Site-SVHN                          | Train Loss: 1.9220 | Train Acc: 0.3298
Average Train Accuracy: 0.8427
 Site-MNIST                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0194 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3269 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2382 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1580 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0472 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0881 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0717 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1312 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1104 | Val  Acc: 0.9637
 Site-USPS                          | Val  Loss: 0.0129 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2125 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.2776 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3150 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2765 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1705 | Val  Acc: 0.9471
 Site-SynthDigits                   | Val  Loss: 1.0525 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.0675 | Val  Acc: 0.6471
 Site-SynthDigits                   | Val  Loss: 1.1271 | Val  Acc: 0.6311
 Site-MNIST_M                       | Val  Loss: 1.6091 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.4374 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.6964 | Val  Acc: 0.3429
Average Valid Accuracy: 0.8410
 Best site-MNIST                     | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9399
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9637
 Best site-USPS                      | Epoch:31 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:31 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:31 | Val Acc: 0.9062
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8966
 Best site-USPS                      | Epoch:31 | Val Acc: 0.9048
 Best site-USPS                      | Epoch:31 | Val Acc: 0.9471
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.7027
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.6471
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.6311
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.5556
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.3429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.0394 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3681 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0150 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0666 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1000 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0747 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0872 | Train Acc: 0.9559
 Site-MNIST                         | Train Loss: 0.1248 | Train Acc: 0.9462
 Site-MNIST                         | Train Loss: 0.0701 | Train Acc: 0.9755
 Site-MNIST                         | Train Loss: 0.0406 | Train Acc: 0.9940
 Site-USPS                          | Train Loss: 0.2134 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0771 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1096 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.2067 | Train Acc: 0.9313
 Site-USPS                          | Train Loss: 0.1180 | Train Acc: 0.9619
 Site-USPS                          | Train Loss: 0.1270 | Train Acc: 0.9603
 Site-SynthDigits                   | Train Loss: 1.1616 | Train Acc: 0.5762
 Site-SynthDigits                   | Train Loss: 1.1416 | Train Acc: 0.6264
 Site-SynthDigits                   | Train Loss: 0.9083 | Train Acc: 0.6925
 Site-MNIST_M                       | Train Loss: 1.6632 | Train Acc: 0.4420
 Site-MNIST_M                       | Train Loss: 1.4854 | Train Acc: 0.4924
 Site-SVHN                          | Train Loss: 1.8903 | Train Acc: 0.3440
Average Train Accuracy: 0.8419
 Site-MNIST                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0206 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3037 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2111 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1360 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0373 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0780 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0662 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1263 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1084 | Val  Acc: 0.9547
 Site-USPS                          | Val  Loss: 0.0120 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2307 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3010 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3130 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2762 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1704 | Val  Acc: 0.9471
 Site-SynthDigits                   | Val  Loss: 1.0394 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 1.0333 | Val  Acc: 0.6618
 Site-SynthDigits                   | Val  Loss: 1.1120 | Val  Acc: 0.6393
 Site-MNIST_M                       | Val  Loss: 1.6743 | Val  Acc: 0.5111
 Site-MNIST_M                       | Val  Loss: 1.4531 | Val  Acc: 0.5309
 Site-SVHN                          | Val  Loss: 1.6608 | Val  Acc: 0.3714
Average Valid Accuracy: 0.8346
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.0295 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3722 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0152 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0850 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.2092 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0712 | Train Acc: 0.9921
 Site-MNIST                         | Train Loss: 0.0850 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1204 | Train Acc: 0.9487
 Site-MNIST                         | Train Loss: 0.0734 | Train Acc: 0.9769
 Site-MNIST                         | Train Loss: 0.0404 | Train Acc: 0.9932
 Site-USPS                          | Train Loss: 0.2120 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0807 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1015 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1942 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.1208 | Train Acc: 0.9619
 Site-USPS                          | Train Loss: 0.1204 | Train Acc: 0.9603
 Site-SynthDigits                   | Train Loss: 1.2012 | Train Acc: 0.5894
 Site-SynthDigits                   | Train Loss: 1.0564 | Train Acc: 0.6410
 Site-SynthDigits                   | Train Loss: 0.9000 | Train Acc: 0.7088
 Site-MNIST_M                       | Train Loss: 1.6800 | Train Acc: 0.4365
 Site-MNIST_M                       | Train Loss: 1.4685 | Train Acc: 0.4924
 Site-SVHN                          | Train Loss: 1.9242 | Train Acc: 0.3404
Average Train Accuracy: 0.8458
 Site-MNIST                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0129 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2744 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1755 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1298 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0369 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0763 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0660 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1270 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1091 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0108 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2589 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3316 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3206 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2700 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1576 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 1.0304 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 0.9935 | Val  Acc: 0.6765
 Site-SynthDigits                   | Val  Loss: 1.1175 | Val  Acc: 0.6393
 Site-MNIST_M                       | Val  Loss: 1.7244 | Val  Acc: 0.5111
 Site-MNIST_M                       | Val  Loss: 1.5072 | Val  Acc: 0.5185
 Site-SVHN                          | Val  Loss: 1.6714 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8416
 Best site-MNIST                     | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9399
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9577
 Best site-USPS                      | Epoch:33 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9062
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8966
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9048
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9524
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.7027
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.6765
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.6393
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5111
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5185
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.0367 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3472 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0155 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0758 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1288 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0699 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0970 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1341 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.0627 | Train Acc: 0.9783
 Site-MNIST                         | Train Loss: 0.0363 | Train Acc: 0.9947
 Site-USPS                          | Train Loss: 0.2109 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2160 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1146 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.2001 | Train Acc: 0.9442
 Site-USPS                          | Train Loss: 0.1167 | Train Acc: 0.9595
 Site-USPS                          | Train Loss: 0.1217 | Train Acc: 0.9590
 Site-SynthDigits                   | Train Loss: 1.1487 | Train Acc: 0.5828
 Site-SynthDigits                   | Train Loss: 1.0543 | Train Acc: 0.6227
 Site-SynthDigits                   | Train Loss: 0.8840 | Train Acc: 0.7006
 Site-MNIST_M                       | Train Loss: 1.6572 | Train Acc: 0.4475
 Site-MNIST_M                       | Train Loss: 1.4296 | Train Acc: 0.4985
 Site-SVHN                          | Train Loss: 1.8874 | Train Acc: 0.3511
Average Train Accuracy: 0.8446
 Site-MNIST                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0102 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3121 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2077 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1390 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0354 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0702 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0595 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1177 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.1010 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0135 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2756 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3270 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3347 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2755 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1628 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 1.0412 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 0.9667 | Val  Acc: 0.6471
 Site-SynthDigits                   | Val  Loss: 1.1100 | Val  Acc: 0.6311
 Site-MNIST_M                       | Val  Loss: 1.6774 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.4764 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.6388 | Val  Acc: 0.4286
Average Valid Accuracy: 0.8449
 Best site-MNIST                     | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9804
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9454
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9577
 Best site-USPS                      | Epoch:34 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9062
 Best site-USPS                      | Epoch:34 | Val Acc: 0.8966
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9143
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9524
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.6486
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.6471
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.6311
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.5679
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.0327 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3521 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0159 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0780 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.3836 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0696 | Train Acc: 0.9921
 Site-MNIST                         | Train Loss: 0.0942 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1175 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.0612 | Train Acc: 0.9796
 Site-MNIST                         | Train Loss: 0.0367 | Train Acc: 0.9925
 Site-USPS                          | Train Loss: 0.1982 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0757 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1056 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.2091 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.1133 | Train Acc: 0.9667
 Site-USPS                          | Train Loss: 0.1130 | Train Acc: 0.9630
 Site-SynthDigits                   | Train Loss: 1.0690 | Train Acc: 0.5894
 Site-SynthDigits                   | Train Loss: 1.0626 | Train Acc: 0.6374
 Site-SynthDigits                   | Train Loss: 0.8759 | Train Acc: 0.7088
 Site-MNIST_M                       | Train Loss: 1.6309 | Train Acc: 0.4530
 Site-MNIST_M                       | Train Loss: 1.4558 | Train Acc: 0.5015
 Site-SVHN                          | Train Loss: 1.8723 | Train Acc: 0.3582
Average Train Accuracy: 0.8476
 Site-MNIST                         | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0177 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3291 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2166 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1455 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0377 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0679 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0570 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1108 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.0975 | Val  Acc: 0.9607
 Site-USPS                          | Val  Loss: 0.0107 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2152 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.2844 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3198 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2711 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1563 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 0.9958 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 0.9655 | Val  Acc: 0.6471
 Site-SynthDigits                   | Val  Loss: 1.0856 | Val  Acc: 0.6475
 Site-MNIST_M                       | Val  Loss: 1.6368 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.4325 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.6218 | Val  Acc: 0.4143
Average Valid Accuracy: 0.8412
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.0306 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3219 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0179 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0656 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1272 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0712 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0918 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1211 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.0609 | Train Acc: 0.9810
 Site-MNIST                         | Train Loss: 0.0350 | Train Acc: 0.9947
 Site-USPS                          | Train Loss: 0.1870 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1233 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1581 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.2067 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.1158 | Train Acc: 0.9595
 Site-USPS                          | Train Loss: 0.1187 | Train Acc: 0.9577
 Site-SynthDigits                   | Train Loss: 1.1374 | Train Acc: 0.5960
 Site-SynthDigits                   | Train Loss: 1.1203 | Train Acc: 0.6227
 Site-SynthDigits                   | Train Loss: 0.8857 | Train Acc: 0.6965
 Site-MNIST_M                       | Train Loss: 1.6808 | Train Acc: 0.4309
 Site-MNIST_M                       | Train Loss: 1.5004 | Train Acc: 0.5046
 Site-SVHN                          | Train Loss: 1.8896 | Train Acc: 0.3369
Average Train Accuracy: 0.8452
 Site-MNIST                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0167 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2391 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1793 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1187 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0363 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0639 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0559 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1116 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.0976 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0107 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2239 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.2903 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3239 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2782 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1613 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 1.0031 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 0.9430 | Val  Acc: 0.6618
 Site-SynthDigits                   | Val  Loss: 1.1052 | Val  Acc: 0.6393
 Site-MNIST_M                       | Val  Loss: 1.7235 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.4992 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.6372 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8415
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.0279 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3517 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0172 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0617 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1042 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0673 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0888 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1161 | Train Acc: 0.9560
 Site-MNIST                         | Train Loss: 0.0580 | Train Acc: 0.9810
 Site-MNIST                         | Train Loss: 0.0332 | Train Acc: 0.9947
 Site-USPS                          | Train Loss: 0.1975 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0626 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1012 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.1998 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.1113 | Train Acc: 0.9690
 Site-USPS                          | Train Loss: 0.1100 | Train Acc: 0.9656
 Site-SynthDigits                   | Train Loss: 1.0870 | Train Acc: 0.5695
 Site-SynthDigits                   | Train Loss: 1.0651 | Train Acc: 0.6374
 Site-SynthDigits                   | Train Loss: 0.8558 | Train Acc: 0.7189
 Site-MNIST_M                       | Train Loss: 1.6373 | Train Acc: 0.4365
 Site-MNIST_M                       | Train Loss: 1.4786 | Train Acc: 0.5107
 Site-SVHN                          | Train Loss: 1.8832 | Train Acc: 0.3546
Average Train Accuracy: 0.8493
 Site-MNIST                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0173 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3071 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2196 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1360 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0365 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0676 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0595 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1073 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.0953 | Val  Acc: 0.9668
 Site-USPS                          | Val  Loss: 0.0101 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2133 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.2766 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3074 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2647 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1526 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 0.9797 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 0.9200 | Val  Acc: 0.6618
 Site-SynthDigits                   | Val  Loss: 1.0721 | Val  Acc: 0.6393
 Site-MNIST_M                       | Val  Loss: 1.6719 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.4457 | Val  Acc: 0.5432
 Site-SVHN                          | Val  Loss: 1.5982 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8428
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.0164 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3642 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0211 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0743 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.0918 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0637 | Train Acc: 0.9841
 Site-MNIST                         | Train Loss: 0.1024 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1046 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.0607 | Train Acc: 0.9837
 Site-MNIST                         | Train Loss: 0.0328 | Train Acc: 0.9925
 Site-USPS                          | Train Loss: 0.1849 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1452 | Train Acc: 0.9722
 Site-USPS                          | Train Loss: 0.1366 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1976 | Train Acc: 0.9485
 Site-USPS                          | Train Loss: 0.1116 | Train Acc: 0.9643
 Site-USPS                          | Train Loss: 0.1091 | Train Acc: 0.9630
 Site-SynthDigits                   | Train Loss: 1.1343 | Train Acc: 0.5762
 Site-SynthDigits                   | Train Loss: 1.0718 | Train Acc: 0.6410
 Site-SynthDigits                   | Train Loss: 0.8579 | Train Acc: 0.7169
 Site-MNIST_M                       | Train Loss: 1.6708 | Train Acc: 0.4586
 Site-MNIST_M                       | Train Loss: 1.3876 | Train Acc: 0.5138
 Site-SVHN                          | Train Loss: 1.8572 | Train Acc: 0.3582
Average Train Accuracy: 0.8505
 Site-MNIST                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0092 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2822 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1873 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1345 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0382 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0695 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0579 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1097 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.0941 | Val  Acc: 0.9607
 Site-USPS                          | Val  Loss: 0.0115 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2239 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3038 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3205 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2689 | Val  Acc: 0.9238
 Site-USPS                          | Val  Loss: 0.1477 | Val  Acc: 0.9630
 Site-SynthDigits                   | Val  Loss: 0.9994 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 0.9449 | Val  Acc: 0.6618
 Site-SynthDigits                   | Val  Loss: 1.0831 | Val  Acc: 0.6475
 Site-MNIST_M                       | Val  Loss: 1.7225 | Val  Acc: 0.5778
 Site-MNIST_M                       | Val  Loss: 1.4990 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.5921 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8468
 Best site-MNIST                     | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9399
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9607
 Best site-USPS                      | Epoch:38 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9062
 Best site-USPS                      | Epoch:38 | Val Acc: 0.8966
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9238
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9630
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.6757
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.6618
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.6475
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.5778
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.5679
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.0250 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3443 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0156 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0647 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.3947 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0627 | Train Acc: 0.9921
 Site-MNIST                         | Train Loss: 0.0813 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1098 | Train Acc: 0.9584
 Site-MNIST                         | Train Loss: 0.0536 | Train Acc: 0.9837
 Site-MNIST                         | Train Loss: 0.0296 | Train Acc: 0.9947
 Site-USPS                          | Train Loss: 0.1984 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0632 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.1003 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.2048 | Train Acc: 0.9485
 Site-USPS                          | Train Loss: 0.1029 | Train Acc: 0.9643
 Site-USPS                          | Train Loss: 0.1085 | Train Acc: 0.9630
 Site-SynthDigits                   | Train Loss: 1.0931 | Train Acc: 0.6026
 Site-SynthDigits                   | Train Loss: 1.0080 | Train Acc: 0.6410
 Site-SynthDigits                   | Train Loss: 0.8448 | Train Acc: 0.7108
 Site-MNIST_M                       | Train Loss: 1.6392 | Train Acc: 0.4586
 Site-MNIST_M                       | Train Loss: 1.6182 | Train Acc: 0.5168
 Site-SVHN                          | Train Loss: 1.8638 | Train Acc: 0.3582
Average Train Accuracy: 0.8515
 Site-MNIST                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0073 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3131 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2122 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1368 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0328 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0629 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0556 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1062 | Val  Acc: 0.9563
 Site-MNIST                         | Val  Loss: 0.0929 | Val  Acc: 0.9668
 Site-USPS                          | Val  Loss: 0.0076 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2167 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.2902 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3096 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2584 | Val  Acc: 0.9238
 Site-USPS                          | Val  Loss: 0.1496 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 0.9853 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 0.9354 | Val  Acc: 0.6618
 Site-SynthDigits                   | Val  Loss: 1.0725 | Val  Acc: 0.6475
 Site-MNIST_M                       | Val  Loss: 1.6919 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.4748 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.5807 | Val  Acc: 0.4143
Average Valid Accuracy: 0.8457
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.0293 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3238 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0143 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0638 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0917 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0645 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0843 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1003 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.0553 | Train Acc: 0.9823
 Site-MNIST                         | Train Loss: 0.0276 | Train Acc: 0.9947
 Site-USPS                          | Train Loss: 0.1978 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.3209 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1573 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.2170 | Train Acc: 0.9485
 Site-USPS                          | Train Loss: 0.0998 | Train Acc: 0.9690
 Site-USPS                          | Train Loss: 0.1042 | Train Acc: 0.9630
 Site-SynthDigits                   | Train Loss: 1.1283 | Train Acc: 0.5960
 Site-SynthDigits                   | Train Loss: 1.1091 | Train Acc: 0.6447
 Site-SynthDigits                   | Train Loss: 0.8322 | Train Acc: 0.7312
 Site-MNIST_M                       | Train Loss: 1.6613 | Train Acc: 0.4475
 Site-MNIST_M                       | Train Loss: 1.6073 | Train Acc: 0.5107
 Site-SVHN                          | Train Loss: 1.8902 | Train Acc: 0.3546
Average Train Accuracy: 0.8496
 Site-MNIST                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0084 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2283 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1670 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1133 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0359 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0661 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0559 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1041 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.0918 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1954 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.2697 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3093 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2659 | Val  Acc: 0.9238
 Site-USPS                          | Val  Loss: 0.1555 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 0.9663 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 0.9429 | Val  Acc: 0.7059
 Site-SynthDigits                   | Val  Loss: 1.0665 | Val  Acc: 0.6639
 Site-MNIST_M                       | Val  Loss: 1.6929 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.4702 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.5817 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8488
 Best site-MNIST                     | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9399
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9577
 Best site-USPS                      | Epoch:40 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9062
 Best site-USPS                      | Epoch:40 | Val Acc: 0.8966
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9238
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9577
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.7027
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.7059
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.6639
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.5679
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.3857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.0249 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3316 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0155 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0627 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1530 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0646 | Train Acc: 0.9841
 Site-MNIST                         | Train Loss: 0.0958 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1041 | Train Acc: 0.9584
 Site-MNIST                         | Train Loss: 0.0552 | Train Acc: 0.9851
 Site-MNIST                         | Train Loss: 0.0264 | Train Acc: 0.9955
 Site-USPS                          | Train Loss: 0.2017 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0677 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1370 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.1892 | Train Acc: 0.9485
 Site-USPS                          | Train Loss: 0.1027 | Train Acc: 0.9643
 Site-USPS                          | Train Loss: 0.1066 | Train Acc: 0.9643
 Site-SynthDigits                   | Train Loss: 1.0719 | Train Acc: 0.6093
 Site-SynthDigits                   | Train Loss: 1.1039 | Train Acc: 0.6484
 Site-SynthDigits                   | Train Loss: 0.8333 | Train Acc: 0.7271
 Site-MNIST_M                       | Train Loss: 1.6669 | Train Acc: 0.4420
 Site-MNIST_M                       | Train Loss: 1.4035 | Train Acc: 0.5260
 Site-SVHN                          | Train Loss: 1.8765 | Train Acc: 0.3688
Average Train Accuracy: 0.8527
 Site-MNIST                         | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0117 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2137 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1622 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1072 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0336 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0565 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0512 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1053 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.0927 | Val  Acc: 0.9637
 Site-USPS                          | Val  Loss: 0.0071 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1768 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.2757 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3043 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2647 | Val  Acc: 0.9238
 Site-USPS                          | Val  Loss: 0.1532 | Val  Acc: 0.9630
 Site-SynthDigits                   | Val  Loss: 0.9428 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 0.9284 | Val  Acc: 0.6912
 Site-SynthDigits                   | Val  Loss: 1.0671 | Val  Acc: 0.6639
 Site-MNIST_M                       | Val  Loss: 1.7078 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.4865 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.5623 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8482
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.0186 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3432 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0179 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0604 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1465 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0614 | Train Acc: 0.9921
 Site-MNIST                         | Train Loss: 0.0807 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1010 | Train Acc: 0.9609
 Site-MNIST                         | Train Loss: 0.0530 | Train Acc: 0.9878
 Site-MNIST                         | Train Loss: 0.0274 | Train Acc: 0.9940
 Site-USPS                          | Train Loss: 0.1876 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0995 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.0976 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.1989 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.1042 | Train Acc: 0.9619
 Site-USPS                          | Train Loss: 0.1093 | Train Acc: 0.9603
 Site-SynthDigits                   | Train Loss: 1.1804 | Train Acc: 0.5960
 Site-SynthDigits                   | Train Loss: 1.0279 | Train Acc: 0.6520
 Site-SynthDigits                   | Train Loss: 0.8267 | Train Acc: 0.7332
 Site-MNIST_M                       | Train Loss: 1.6517 | Train Acc: 0.4475
 Site-MNIST_M                       | Train Loss: 1.4585 | Train Acc: 0.5107
 Site-SVHN                          | Train Loss: 1.8734 | Train Acc: 0.3688
Average Train Accuracy: 0.8513
 Site-MNIST                         | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0115 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1776 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1330 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.0873 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0295 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0550 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0485 | Val  Acc: 0.9902
 Site-MNIST                         | Val  Loss: 0.1006 | Val  Acc: 0.9617
 Site-MNIST                         | Val  Loss: 0.0890 | Val  Acc: 0.9698
 Site-USPS                          | Val  Loss: 0.0095 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1910 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.2954 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3273 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2819 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1546 | Val  Acc: 0.9630
 Site-SynthDigits                   | Val  Loss: 0.9183 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 0.8912 | Val  Acc: 0.6912
 Site-SynthDigits                   | Val  Loss: 1.0507 | Val  Acc: 0.6721
 Site-MNIST_M                       | Val  Loss: 1.7279 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.5126 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.5611 | Val  Acc: 0.4571
Average Valid Accuracy: 0.8493
 Best site-MNIST                     | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9902
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9617
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9698
 Best site-USPS                      | Epoch:42 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8750
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8793
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9048
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9630
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.6757
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.6912
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.6721
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.5333
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.5556
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.4571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.0164 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3547 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0153 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0602 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.0913 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0613 | Train Acc: 0.9841
 Site-MNIST                         | Train Loss: 0.0876 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1018 | Train Acc: 0.9633
 Site-MNIST                         | Train Loss: 0.0507 | Train Acc: 0.9891
 Site-MNIST                         | Train Loss: 0.0268 | Train Acc: 0.9962
 Site-USPS                          | Train Loss: 0.1825 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1252 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.0942 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1996 | Train Acc: 0.9485
 Site-USPS                          | Train Loss: 0.1017 | Train Acc: 0.9643
 Site-USPS                          | Train Loss: 0.0989 | Train Acc: 0.9656
 Site-SynthDigits                   | Train Loss: 1.1951 | Train Acc: 0.6093
 Site-SynthDigits                   | Train Loss: 1.1140 | Train Acc: 0.6630
 Site-SynthDigits                   | Train Loss: 0.8300 | Train Acc: 0.7230
 Site-MNIST_M                       | Train Loss: 1.6598 | Train Acc: 0.4420
 Site-MNIST_M                       | Train Loss: 1.4790 | Train Acc: 0.5168
 Site-SVHN                          | Train Loss: 1.8969 | Train Acc: 0.3652
Average Train Accuracy: 0.8534
 Site-MNIST                         | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0052 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1733 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1247 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.0835 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0251 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0550 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0481 | Val  Acc: 0.9902
 Site-MNIST                         | Val  Loss: 0.1009 | Val  Acc: 0.9563
 Site-MNIST                         | Val  Loss: 0.0875 | Val  Acc: 0.9637
 Site-USPS                          | Val  Loss: 0.0117 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1966 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.2997 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3209 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2615 | Val  Acc: 0.9238
 Site-USPS                          | Val  Loss: 0.1363 | Val  Acc: 0.9630
 Site-SynthDigits                   | Val  Loss: 0.9277 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 0.9349 | Val  Acc: 0.7206
 Site-SynthDigits                   | Val  Loss: 1.0571 | Val  Acc: 0.6803
 Site-MNIST_M                       | Val  Loss: 1.7322 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.4833 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.5722 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8545
 Best site-MNIST                     | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9902
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9563
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9637
 Best site-USPS                      | Epoch:43 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9062
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8966
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9238
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9630
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.7297
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.7206
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.6803
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.5556
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.0165 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3468 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0176 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0601 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0831 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0588 | Train Acc: 0.9841
 Site-MNIST                         | Train Loss: 0.0831 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1058 | Train Acc: 0.9658
 Site-MNIST                         | Train Loss: 0.0485 | Train Acc: 0.9878
 Site-MNIST                         | Train Loss: 0.0257 | Train Acc: 0.9970
 Site-USPS                          | Train Loss: 0.1927 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0652 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.0920 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.1861 | Train Acc: 0.9485
 Site-USPS                          | Train Loss: 0.1076 | Train Acc: 0.9667
 Site-USPS                          | Train Loss: 0.0961 | Train Acc: 0.9643
 Site-SynthDigits                   | Train Loss: 1.2178 | Train Acc: 0.5894
 Site-SynthDigits                   | Train Loss: 1.0228 | Train Acc: 0.6740
 Site-SynthDigits                   | Train Loss: 0.8117 | Train Acc: 0.7210
 Site-MNIST_M                       | Train Loss: 1.6605 | Train Acc: 0.4420
 Site-MNIST_M                       | Train Loss: 1.4048 | Train Acc: 0.5199
 Site-SVHN                          | Train Loss: 1.8244 | Train Acc: 0.3617
Average Train Accuracy: 0.8546
 Site-MNIST                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1854 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1330 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.0987 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0326 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0604 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0499 | Val  Acc: 0.9902
 Site-MNIST                         | Val  Loss: 0.0951 | Val  Acc: 0.9617
 Site-MNIST                         | Val  Loss: 0.0842 | Val  Acc: 0.9698
 Site-USPS                          | Val  Loss: 0.0113 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1975 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.2873 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3278 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2620 | Val  Acc: 0.9238
 Site-USPS                          | Val  Loss: 0.1350 | Val  Acc: 0.9630
 Site-SynthDigits                   | Val  Loss: 0.9212 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 0.8968 | Val  Acc: 0.7059
 Site-SynthDigits                   | Val  Loss: 1.0431 | Val  Acc: 0.6721
 Site-MNIST_M                       | Val  Loss: 1.7513 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.5168 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.5882 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8527
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.0189 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3297 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0171 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0616 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.2662 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0624 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0791 | Train Acc: 0.9736
 Site-MNIST                         | Train Loss: 0.0902 | Train Acc: 0.9633
 Site-MNIST                         | Train Loss: 0.0487 | Train Acc: 0.9905
 Site-MNIST                         | Train Loss: 0.0247 | Train Acc: 0.9970
 Site-USPS                          | Train Loss: 0.1804 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0634 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.0894 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1913 | Train Acc: 0.9442
 Site-USPS                          | Train Loss: 0.0965 | Train Acc: 0.9643
 Site-USPS                          | Train Loss: 0.0927 | Train Acc: 0.9709
 Site-SynthDigits                   | Train Loss: 1.1769 | Train Acc: 0.5960
 Site-SynthDigits                   | Train Loss: 1.0787 | Train Acc: 0.6630
 Site-SynthDigits                   | Train Loss: 0.8200 | Train Acc: 0.7291
 Site-MNIST_M                       | Train Loss: 1.6501 | Train Acc: 0.4365
 Site-MNIST_M                       | Train Loss: 1.4965 | Train Acc: 0.5199
 Site-SVHN                          | Train Loss: 1.8635 | Train Acc: 0.3794
Average Train Accuracy: 0.8537
 Site-MNIST                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1605 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1159 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.0776 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0253 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0575 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0497 | Val  Acc: 0.9902
 Site-MNIST                         | Val  Loss: 0.0963 | Val  Acc: 0.9672
 Site-MNIST                         | Val  Loss: 0.0846 | Val  Acc: 0.9758
 Site-USPS                          | Val  Loss: 0.0121 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2083 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.2870 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3271 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2698 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1407 | Val  Acc: 0.9630
 Site-SynthDigits                   | Val  Loss: 0.9110 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 0.8749 | Val  Acc: 0.7059
 Site-SynthDigits                   | Val  Loss: 1.0353 | Val  Acc: 0.6721
 Site-MNIST_M                       | Val  Loss: 1.7478 | Val  Acc: 0.4889
 Site-MNIST_M                       | Val  Loss: 1.5157 | Val  Acc: 0.5185
 Site-SVHN                          | Val  Loss: 1.5706 | Val  Acc: 0.4286
Average Valid Accuracy: 0.8494
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.0228 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3556 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0112 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0612 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0918 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0614 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0838 | Train Acc: 0.9736
 Site-MNIST                         | Train Loss: 0.1017 | Train Acc: 0.9609
 Site-MNIST                         | Train Loss: 0.0503 | Train Acc: 0.9864
 Site-MNIST                         | Train Loss: 0.0243 | Train Acc: 0.9977
 Site-USPS                          | Train Loss: 0.1832 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0672 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.0962 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1893 | Train Acc: 0.9442
 Site-USPS                          | Train Loss: 0.0882 | Train Acc: 0.9667
 Site-USPS                          | Train Loss: 0.0858 | Train Acc: 0.9735
 Site-SynthDigits                   | Train Loss: 1.1253 | Train Acc: 0.5828
 Site-SynthDigits                   | Train Loss: 0.9426 | Train Acc: 0.6813
 Site-SynthDigits                   | Train Loss: 0.7968 | Train Acc: 0.7373
 Site-MNIST_M                       | Train Loss: 1.6531 | Train Acc: 0.4530
 Site-MNIST_M                       | Train Loss: 1.3701 | Train Acc: 0.5260
 Site-SVHN                          | Train Loss: 1.9101 | Train Acc: 0.3475
Average Train Accuracy: 0.8543
 Site-MNIST                         | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0095 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2042 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1474 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1041 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0335 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0645 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0569 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1019 | Val  Acc: 0.9563
 Site-MNIST                         | Val  Loss: 0.0904 | Val  Acc: 0.9698
 Site-USPS                          | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1609 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.2381 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.2804 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2404 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1363 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 0.9311 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 0.9239 | Val  Acc: 0.7206
 Site-SynthDigits                   | Val  Loss: 1.0367 | Val  Acc: 0.6803
 Site-MNIST_M                       | Val  Loss: 1.7600 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.5218 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.6047 | Val  Acc: 0.3714
Average Valid Accuracy: 0.8523
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.0242 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3606 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0098 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0575 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1336 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0610 | Train Acc: 0.9921
 Site-MNIST                         | Train Loss: 0.0795 | Train Acc: 0.9736
 Site-MNIST                         | Train Loss: 0.0992 | Train Acc: 0.9584
 Site-MNIST                         | Train Loss: 0.0474 | Train Acc: 0.9878
 Site-MNIST                         | Train Loss: 0.0232 | Train Acc: 0.9970
 Site-USPS                          | Train Loss: 0.1843 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0560 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.1845 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.1890 | Train Acc: 0.9485
 Site-USPS                          | Train Loss: 0.0956 | Train Acc: 0.9690
 Site-USPS                          | Train Loss: 0.0895 | Train Acc: 0.9722
 Site-SynthDigits                   | Train Loss: 1.0736 | Train Acc: 0.6225
 Site-SynthDigits                   | Train Loss: 0.9774 | Train Acc: 0.6740
 Site-SynthDigits                   | Train Loss: 0.8010 | Train Acc: 0.7332
 Site-MNIST_M                       | Train Loss: 1.6614 | Train Acc: 0.4309
 Site-MNIST_M                       | Train Loss: 1.4790 | Train Acc: 0.5352
 Site-SVHN                          | Train Loss: 1.8468 | Train Acc: 0.3652
Average Train Accuracy: 0.8577
 Site-MNIST                         | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0057 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1352 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1035 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0676 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0228 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0527 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0479 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.0942 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.0844 | Val  Acc: 0.9668
 Site-USPS                          | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1599 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.2343 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.2817 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2314 | Val  Acc: 0.9238
 Site-USPS                          | Val  Loss: 0.1303 | Val  Acc: 0.9630
 Site-SynthDigits                   | Val  Loss: 0.9147 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 0.8563 | Val  Acc: 0.6912
 Site-SynthDigits                   | Val  Loss: 1.0285 | Val  Acc: 0.6639
 Site-MNIST_M                       | Val  Loss: 1.7234 | Val  Acc: 0.4889
 Site-MNIST_M                       | Val  Loss: 1.4796 | Val  Acc: 0.5309
 Site-SVHN                          | Val  Loss: 1.6191 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8620
 Best site-MNIST                     | Epoch:47 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:47 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:47 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:47 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:47 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:47 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9804
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9508
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9668
 Best site-USPS                      | Epoch:47 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9062
 Best site-USPS                      | Epoch:47 | Val Acc: 0.8966
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9238
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9630
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.6757
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.6912
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.6639
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.4889
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.5309
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1/fedsam...
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.0175 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3569 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0148 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0556 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3806 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0594 | Train Acc: 0.9841
 Site-MNIST                         | Train Loss: 0.0863 | Train Acc: 0.9736
 Site-MNIST                         | Train Loss: 0.0950 | Train Acc: 0.9633
 Site-MNIST                         | Train Loss: 0.0424 | Train Acc: 0.9864
 Site-MNIST                         | Train Loss: 0.0219 | Train Acc: 0.9962
 Site-USPS                          | Train Loss: 0.1745 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1252 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.0952 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1730 | Train Acc: 0.9442
 Site-USPS                          | Train Loss: 0.0931 | Train Acc: 0.9667
 Site-USPS                          | Train Loss: 0.0922 | Train Acc: 0.9656
 Site-SynthDigits                   | Train Loss: 1.0936 | Train Acc: 0.5894
 Site-SynthDigits                   | Train Loss: 1.0824 | Train Acc: 0.6703
 Site-SynthDigits                   | Train Loss: 0.7941 | Train Acc: 0.7291
 Site-MNIST_M                       | Train Loss: 1.6580 | Train Acc: 0.4420
 Site-MNIST_M                       | Train Loss: 1.4170 | Train Acc: 0.5321
 Site-SVHN                          | Train Loss: 1.8382 | Train Acc: 0.3688
Average Train Accuracy: 0.8571
 Site-MNIST                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0086 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2217 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1588 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.0970 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0246 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0461 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0455 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.0948 | Val  Acc: 0.9563
 Site-MNIST                         | Val  Loss: 0.0851 | Val  Acc: 0.9698
 Site-USPS                          | Val  Loss: 0.0056 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1680 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.2559 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.2724 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2352 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1390 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 0.9528 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 0.8586 | Val  Acc: 0.7059
 Site-SynthDigits                   | Val  Loss: 1.0467 | Val  Acc: 0.6721
 Site-MNIST_M                       | Val  Loss: 1.7745 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.5110 | Val  Acc: 0.5432
 Site-SVHN                          | Val  Loss: 1.6121 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8504
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.0169 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3118 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0162 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0526 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0800 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0553 | Train Acc: 0.9841
 Site-MNIST                         | Train Loss: 0.0727 | Train Acc: 0.9736
 Site-MNIST                         | Train Loss: 0.1030 | Train Acc: 0.9584
 Site-MNIST                         | Train Loss: 0.0436 | Train Acc: 0.9891
 Site-MNIST                         | Train Loss: 0.0203 | Train Acc: 0.9970
 Site-USPS                          | Train Loss: 0.1748 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1640 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1045 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1686 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.0955 | Train Acc: 0.9690
 Site-USPS                          | Train Loss: 0.0859 | Train Acc: 0.9709
 Site-SynthDigits                   | Train Loss: 1.1166 | Train Acc: 0.5960
 Site-SynthDigits                   | Train Loss: 1.0209 | Train Acc: 0.6630
 Site-SynthDigits                   | Train Loss: 0.7797 | Train Acc: 0.7352
 Site-MNIST_M                       | Train Loss: 1.6563 | Train Acc: 0.4420
 Site-MNIST_M                       | Train Loss: 1.4438 | Train Acc: 0.5291
 Site-SVHN                          | Train Loss: 1.8220 | Train Acc: 0.3688
Average Train Accuracy: 0.8554
 Site-MNIST                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2160 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1622 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.0976 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0277 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0490 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0467 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.0914 | Val  Acc: 0.9563
 Site-MNIST                         | Val  Loss: 0.0846 | Val  Acc: 0.9698
 Site-USPS                          | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1448 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.2340 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.2533 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2326 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1469 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 0.9284 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 0.8833 | Val  Acc: 0.6912
 Site-SynthDigits                   | Val  Loss: 1.0266 | Val  Acc: 0.6639
 Site-MNIST_M                       | Val  Loss: 1.7955 | Val  Acc: 0.5111
 Site-MNIST_M                       | Val  Loss: 1.5197 | Val  Acc: 0.5309
 Site-SVHN                          | Val  Loss: 1.5790 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8465
===2023-07-01 18:06:50===
===2023-07-01 18:06:53===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     (1)| Epoch:47 | Test Acc: 0.9517
 Test site-USPS                      (2)| Epoch:47 | Test Acc: 0.9473
 Test site-SynthDigits               (0)| Epoch:47 | Test Acc: 0.6056
 Test site-MNIST_M                   (3)| Epoch:47 | Test Acc: 0.3753
 Test site-SVHN                      (4)| Epoch:47 | Test Acc: 0.2600
MNIST: 0.9517, USPS: 0.9473, SynthDigits: 0.6056, MNIST_M: 0.3753, SVHN: 0.2600, 
Average Test Accuracy(group): 0.6280, Average Test Accuracy(individual): 0.8195,
domain std=0.2851, cluster std=0.2851, individual std=0.2254, 
