===2023-06-25 21:04:39===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (0) | Train Loss: 1.8165 | Train Acc: 0.5000
 Site-MNIST                     (0) | Train Loss: 1.7597 | Train Acc: 0.5000
 Site-MNIST                     (0) | Train Loss: 1.4906 | Train Acc: 0.7143
 Site-MNIST                     (0) | Train Loss: 1.6581 | Train Acc: 0.6053
 Site-MNIST                     (0) | Train Loss: 1.6634 | Train Acc: 0.6857
 Site-MNIST                     (0) | Train Loss: 1.5812 | Train Acc: 0.7302
 Site-MNIST                     (0) | Train Loss: 1.5795 | Train Acc: 0.7313
 Site-MNIST                     (0) | Train Loss: 1.6688 | Train Acc: 0.6479
 Site-MNIST                     (0) | Train Loss: 1.6388 | Train Acc: 0.6549
 Site-MNIST                     (0) | Train Loss: 1.6095 | Train Acc: 0.6792
 Site-USPS                      (1) | Train Loss: 1.6558 | Train Acc: 0.7000
 Site-USPS                      (1) | Train Loss: 1.6035 | Train Acc: 0.6389
 Site-USPS                      (1) | Train Loss: 1.8543 | Train Acc: 0.7287
 Site-USPS                      (1) | Train Loss: 1.6732 | Train Acc: 0.6695
 Site-USPS                      (1) | Train Loss: 1.6916 | Train Acc: 0.7095
 Site-USPS                      (1) | Train Loss: 1.6949 | Train Acc: 0.6429
 Site-SynthDigits               (2) | Train Loss: 2.1121 | Train Acc: 0.2649
 Site-SynthDigits               (2) | Train Loss: 2.1478 | Train Acc: 0.2308
 Site-SynthDigits               (2) | Train Loss: 2.1054 | Train Acc: 0.2668
 Site-MNIST_M                   (3) | Train Loss: 2.2404 | Train Acc: 0.1823
 Site-MNIST_M                   (3) | Train Loss: 2.2151 | Train Acc: 0.2049
 Site-SVHN                      (4) | Train Loss: 2.2462 | Train Acc: 0.1738
Average Train Accuracy: 0.5392
 Site-MNIST                     (0) | Val  Loss: 2.0048 | Val  Acc: 0.0000
 Site-MNIST                     (0) | Val  Loss: 1.7983 | Val  Acc: 0.3333
 Site-MNIST                     (0) | Val  Loss: 1.5398 | Val  Acc: 0.6000
 Site-MNIST                     (0) | Val  Loss: 1.6788 | Val  Acc: 0.5556
 Site-MNIST                     (0) | Val  Loss: 1.6318 | Val  Acc: 0.6471
 Site-MNIST                     (0) | Val  Loss: 1.6476 | Val  Acc: 0.6452
 Site-MNIST                     (0) | Val  Loss: 1.5692 | Val  Acc: 0.7143
 Site-MNIST                     (0) | Val  Loss: 1.5713 | Val  Acc: 0.7353
 Site-MNIST                     (0) | Val  Loss: 1.6207 | Val  Acc: 0.6776
 Site-MNIST                     (0) | Val  Loss: 1.5831 | Val  Acc: 0.6707
 Site-USPS                      (1) | Val  Loss: 1.6241 | Val  Acc: 0.8000
 Site-USPS                      (1) | Val  Loss: 1.8232 | Val  Acc: 0.5556
 Site-USPS                      (1) | Val  Loss: 1.7740 | Val  Acc: 0.5312
 Site-USPS                      (1) | Val  Loss: 1.7306 | Val  Acc: 0.6034
 Site-USPS                      (1) | Val  Loss: 1.6600 | Val  Acc: 0.6857
 Site-USPS                      (1) | Val  Loss: 1.6422 | Val  Acc: 0.7090
 Site-SynthDigits               (2) | Val  Loss: 2.1208 | Val  Acc: 0.2973
 Site-SynthDigits               (2) | Val  Loss: 2.0415 | Val  Acc: 0.2941
 Site-SynthDigits               (2) | Val  Loss: 2.1383 | Val  Acc: 0.2623
 Site-MNIST_M                   (3) | Val  Loss: 2.2632 | Val  Acc: 0.2000
 Site-MNIST_M                   (3) | Val  Loss: 2.2283 | Val  Acc: 0.1605
 Site-SVHN                      (4) | Val  Loss: 2.1324 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4919
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.0000
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.6000
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.5556
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.6471
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.6452
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.7143
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.7353
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.6776
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.6707
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.8000
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.5556
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.5312
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.6034
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.6857
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.7090
 Best site-SynthDigits              (2)  | Epoch:0 | Val Acc: 0.2973
 Best site-SynthDigits              (2)  | Epoch:0 | Val Acc: 0.2941
 Best site-SynthDigits              (2)  | Epoch:0 | Val Acc: 0.2623
 Best site-MNIST_M                  (3)  | Epoch:0 | Val Acc: 0.2000
 Best site-MNIST_M                  (3)  | Epoch:0 | Val Acc: 0.1605
 Best site-SVHN                     (4)  | Epoch:0 | Val Acc: 0.1429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 4, 3, 2, 12, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (2) | Train Loss: 1.8157 | Train Acc: 0.1667
 Site-MNIST                     (4) | Train Loss: 1.6771 | Train Acc: 0.4167
 Site-MNIST                     (4) | Train Loss: 1.4027 | Train Acc: 0.6190
 Site-MNIST                     (4) | Train Loss: 1.5846 | Train Acc: 0.5789
 Site-MNIST                     (3) | Train Loss: 1.6170 | Train Acc: 0.6571
 Site-MNIST                     (4) | Train Loss: 1.4557 | Train Acc: 0.6508
 Site-MNIST                     (4) | Train Loss: 1.4666 | Train Acc: 0.6432
 Site-MNIST                     (1) | Train Loss: 1.5777 | Train Acc: 0.5428
 Site-MNIST                     (1) | Train Loss: 1.5472 | Train Acc: 0.5720
 Site-MNIST                     (4) | Train Loss: 1.5104 | Train Acc: 0.6068
 Site-USPS                      (0) | Train Loss: 1.5607 | Train Acc: 0.5750
 Site-USPS                      (4) | Train Loss: 1.5139 | Train Acc: 0.5417
 Site-USPS                      (1) | Train Loss: 1.5931 | Train Acc: 0.5659
 Site-USPS                      (4) | Train Loss: 1.5712 | Train Acc: 0.5236
 Site-USPS                      (4) | Train Loss: 1.6246 | Train Acc: 0.5310
 Site-USPS                      (4) | Train Loss: 1.5988 | Train Acc: 0.5357
 Site-SynthDigits               (3) | Train Loss: 2.0700 | Train Acc: 0.2517
 Site-SynthDigits               (1) | Train Loss: 2.1070 | Train Acc: 0.2015
 Site-SynthDigits               (4) | Train Loss: 2.0422 | Train Acc: 0.2953
 Site-MNIST_M                   (2) | Train Loss: 2.2519 | Train Acc: 0.1713
 Site-MNIST_M                   (2) | Train Loss: 2.2029 | Train Acc: 0.2263
 Site-SVHN                      (4) | Train Loss: 2.0771 | Train Acc: 0.2482
Average Train Accuracy: 0.4600
 Site-MNIST                     (2) | Val  Loss: 1.8353 | Val  Acc: 1.0000
 Site-MNIST                     (4) | Val  Loss: 1.6260 | Val  Acc: 1.0000
 Site-MNIST                     (4) | Val  Loss: 1.3442 | Val  Acc: 0.6000
 Site-MNIST                     (4) | Val  Loss: 1.5287 | Val  Acc: 0.5556
 Site-MNIST                     (3) | Val  Loss: 1.5263 | Val  Acc: 0.5882
 Site-MNIST                     (4) | Val  Loss: 1.5749 | Val  Acc: 0.6452
 Site-MNIST                     (4) | Val  Loss: 1.4804 | Val  Acc: 0.6071
 Site-MNIST                     (1) | Val  Loss: 1.4687 | Val  Acc: 0.6078
 Site-MNIST                     (1) | Val  Loss: 1.5344 | Val  Acc: 0.5628
 Site-MNIST                     (4) | Val  Loss: 1.4772 | Val  Acc: 0.5801
 Site-USPS                      (0) | Val  Loss: 1.5985 | Val  Acc: 0.4000
 Site-USPS                      (4) | Val  Loss: 1.7234 | Val  Acc: 0.3889
 Site-USPS                      (1) | Val  Loss: 1.6222 | Val  Acc: 0.5625
 Site-USPS                      (4) | Val  Loss: 1.6230 | Val  Acc: 0.5000
 Site-USPS                      (4) | Val  Loss: 1.5479 | Val  Acc: 0.5810
 Site-USPS                      (4) | Val  Loss: 1.5143 | Val  Acc: 0.5820
 Site-SynthDigits               (3) | Val  Loss: 2.0627 | Val  Acc: 0.3243
 Site-SynthDigits               (1) | Val  Loss: 1.8776 | Val  Acc: 0.3088
 Site-SynthDigits               (4) | Val  Loss: 2.0839 | Val  Acc: 0.2213
 Site-MNIST_M                   (2) | Val  Loss: 2.3006 | Val  Acc: 0.1556
 Site-MNIST_M                   (2) | Val  Loss: 2.2643 | Val  Acc: 0.1728
 Site-SVHN                      (4) | Val  Loss: 1.9052 | Val  Acc: 0.2571
Average Valid Accuracy: 0.5091
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                    (4)  | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                    (4)  | Epoch:1 | Val Acc: 0.6000
 Best site-MNIST                    (4)  | Epoch:1 | Val Acc: 0.5556
 Best site-MNIST                    (3)  | Epoch:1 | Val Acc: 0.5882
 Best site-MNIST                    (4)  | Epoch:1 | Val Acc: 0.6452
 Best site-MNIST                    (4)  | Epoch:1 | Val Acc: 0.6071
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.6078
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.5628
 Best site-MNIST                    (4)  | Epoch:1 | Val Acc: 0.5801
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.4000
 Best site-USPS                     (4)  | Epoch:1 | Val Acc: 0.3889
 Best site-USPS                     (1)  | Epoch:1 | Val Acc: 0.5625
 Best site-USPS                     (4)  | Epoch:1 | Val Acc: 0.5000
 Best site-USPS                     (4)  | Epoch:1 | Val Acc: 0.5810
 Best site-USPS                     (4)  | Epoch:1 | Val Acc: 0.5820
 Best site-SynthDigits              (3)  | Epoch:1 | Val Acc: 0.3243
 Best site-SynthDigits              (1)  | Epoch:1 | Val Acc: 0.3088
 Best site-SynthDigits              (4)  | Epoch:1 | Val Acc: 0.2213
 Best site-MNIST_M                  (2)  | Epoch:1 | Val Acc: 0.1556
 Best site-MNIST_M                  (2)  | Epoch:1 | Val Acc: 0.1728
 Best site-SVHN                     (4)  | Epoch:1 | Val Acc: 0.2571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon/ccop_q=1...
============ Train epoch 2 ============
cnt=[4, 4, 2, 4, 8, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (2) | Train Loss: 1.7016 | Train Acc: 0.6667
 Site-MNIST                     (4) | Train Loss: 1.6117 | Train Acc: 0.5833
 Site-MNIST                     (0) | Train Loss: 1.3102 | Train Acc: 0.6667
 Site-MNIST                     (1) | Train Loss: 1.5280 | Train Acc: 0.5526
 Site-MNIST                     (1) | Train Loss: 1.3522 | Train Acc: 0.6857
 Site-MNIST                     (0) | Train Loss: 1.3783 | Train Acc: 0.6984
 Site-MNIST                     (4) | Train Loss: 1.4179 | Train Acc: 0.6564
 Site-MNIST                     (4) | Train Loss: 1.5153 | Train Acc: 0.5697
 Site-MNIST                     (2) | Train Loss: 1.4780 | Train Acc: 0.6087
 Site-MNIST                     (0) | Train Loss: 1.4380 | Train Acc: 0.6211
 Site-USPS                      (4) | Train Loss: 1.4486 | Train Acc: 0.6500
 Site-USPS                      (4) | Train Loss: 1.4045 | Train Acc: 0.5278
 Site-USPS                      (3) | Train Loss: 1.0858 | Train Acc: 0.5891
 Site-USPS                      (3) | Train Loss: 1.4878 | Train Acc: 0.5494
 Site-USPS                      (3) | Train Loss: 1.5255 | Train Acc: 0.5595
 Site-USPS                      (3) | Train Loss: 1.5070 | Train Acc: 0.5899
 Site-SynthDigits               (4) | Train Loss: 2.0334 | Train Acc: 0.2649
 Site-SynthDigits               (0) | Train Loss: 2.0438 | Train Acc: 0.2198
 Site-SynthDigits               (1) | Train Loss: 1.9851 | Train Acc: 0.3075
 Site-MNIST_M                   (1) | Train Loss: 2.2281 | Train Acc: 0.2044
 Site-MNIST_M                   (4) | Train Loss: 2.2071 | Train Acc: 0.2416
 Site-SVHN                      (4) | Train Loss: 2.0141 | Train Acc: 0.2837
Average Train Accuracy: 0.5135
 Site-MNIST                     (2) | Val  Loss: 1.7521 | Val  Acc: 1.0000
 Site-MNIST                     (4) | Val  Loss: 1.5033 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 1.2474 | Val  Acc: 0.6000
 Site-MNIST                     (1) | Val  Loss: 1.4262 | Val  Acc: 0.5556
 Site-MNIST                     (1) | Val  Loss: 1.4290 | Val  Acc: 0.6471
 Site-MNIST                     (0) | Val  Loss: 1.5015 | Val  Acc: 0.6774
 Site-MNIST                     (4) | Val  Loss: 1.4121 | Val  Acc: 0.6250
 Site-MNIST                     (4) | Val  Loss: 1.3976 | Val  Acc: 0.6275
 Site-MNIST                     (2) | Val  Loss: 1.4740 | Val  Acc: 0.5738
 Site-MNIST                     (0) | Val  Loss: 1.4061 | Val  Acc: 0.6012
 Site-USPS                      (4) | Val  Loss: 1.4794 | Val  Acc: 0.6000
 Site-USPS                      (4) | Val  Loss: 1.6240 | Val  Acc: 0.5556
 Site-USPS                      (3) | Val  Loss: 1.5211 | Val  Acc: 0.6250
 Site-USPS                      (3) | Val  Loss: 1.5375 | Val  Acc: 0.5172
 Site-USPS                      (3) | Val  Loss: 1.4584 | Val  Acc: 0.6000
 Site-USPS                      (3) | Val  Loss: 1.4233 | Val  Acc: 0.6032
 Site-SynthDigits               (4) | Val  Loss: 1.9997 | Val  Acc: 0.3243
 Site-SynthDigits               (0) | Val  Loss: 1.8173 | Val  Acc: 0.2941
 Site-SynthDigits               (1) | Val  Loss: 2.0351 | Val  Acc: 0.2459
 Site-MNIST_M                   (1) | Val  Loss: 2.2995 | Val  Acc: 0.2000
 Site-MNIST_M                   (4) | Val  Loss: 2.2474 | Val  Acc: 0.2099
 Site-SVHN                      (4) | Val  Loss: 1.8920 | Val  Acc: 0.2429
Average Valid Accuracy: 0.5421
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                    (4)  | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.6000
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.5556
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.6471
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.6774
 Best site-MNIST                    (4)  | Epoch:2 | Val Acc: 0.6250
 Best site-MNIST                    (4)  | Epoch:2 | Val Acc: 0.6275
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.5738
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.6012
 Best site-USPS                     (4)  | Epoch:2 | Val Acc: 0.6000
 Best site-USPS                     (4)  | Epoch:2 | Val Acc: 0.5556
 Best site-USPS                     (3)  | Epoch:2 | Val Acc: 0.6250
 Best site-USPS                     (3)  | Epoch:2 | Val Acc: 0.5172
 Best site-USPS                     (3)  | Epoch:2 | Val Acc: 0.6000
 Best site-USPS                     (3)  | Epoch:2 | Val Acc: 0.6032
 Best site-SynthDigits              (4)  | Epoch:2 | Val Acc: 0.3243
 Best site-SynthDigits              (0)  | Epoch:2 | Val Acc: 0.2941
 Best site-SynthDigits              (1)  | Epoch:2 | Val Acc: 0.2459
 Best site-MNIST_M                  (1)  | Epoch:2 | Val Acc: 0.2000
 Best site-MNIST_M                  (4)  | Epoch:2 | Val Acc: 0.2099
 Best site-SVHN                     (4)  | Epoch:2 | Val Acc: 0.2429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon/ccop_q=1...
============ Train epoch 3 ============
cnt=[10, 2, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (1) | Train Loss: 1.5850 | Train Acc: 0.5000
 Site-MNIST                     (2) | Train Loss: 1.5845 | Train Acc: 0.5833
 Site-MNIST                     (0) | Train Loss: 1.2183 | Train Acc: 0.6190
 Site-MNIST                     (3) | Train Loss: 1.4537 | Train Acc: 0.5526
 Site-MNIST                     (0) | Train Loss: 1.0616 | Train Acc: 0.7143
 Site-MNIST                     (2) | Train Loss: 1.3148 | Train Acc: 0.7381
 Site-MNIST                     (0) | Train Loss: 1.2997 | Train Acc: 0.6960
 Site-MNIST                     (4) | Train Loss: 1.4347 | Train Acc: 0.6528
 Site-MNIST                     (1) | Train Loss: 1.3947 | Train Acc: 0.6522
 Site-MNIST                     (0) | Train Loss: 1.3593 | Train Acc: 0.6702
 Site-USPS                      (0) | Train Loss: 1.3258 | Train Acc: 0.7000
 Site-USPS                      (3) | Train Loss: 1.4388 | Train Acc: 0.6806
 Site-USPS                      (2) | Train Loss: 1.4168 | Train Acc: 0.7209
 Site-USPS                      (0) | Train Loss: 1.3750 | Train Acc: 0.6567
 Site-USPS                      (2) | Train Loss: 1.4470 | Train Acc: 0.6643
 Site-USPS                      (0) | Train Loss: 1.4056 | Train Acc: 0.6825
 Site-SynthDigits               (0) | Train Loss: 1.9309 | Train Acc: 0.3510
 Site-SynthDigits               (0) | Train Loss: 1.9157 | Train Acc: 0.3150
 Site-SynthDigits               (2) | Train Loss: 1.8821 | Train Acc: 0.3646
 Site-MNIST_M                   (0) | Train Loss: 2.1704 | Train Acc: 0.2210
 Site-MNIST_M                   (4) | Train Loss: 2.0931 | Train Acc: 0.2875
 Site-SVHN                      (3) | Train Loss: 1.9061 | Train Acc: 0.3262
Average Train Accuracy: 0.5613
 Site-MNIST                     (1) | Val  Loss: 1.6642 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 1.4074 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 1.1625 | Val  Acc: 0.8000
 Site-MNIST                     (3) | Val  Loss: 1.3442 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 1.3373 | Val  Acc: 0.7647
 Site-MNIST                     (2) | Val  Loss: 1.4005 | Val  Acc: 0.7097
 Site-MNIST                     (0) | Val  Loss: 1.3207 | Val  Acc: 0.6607
 Site-MNIST                     (4) | Val  Loss: 1.3169 | Val  Acc: 0.6863
 Site-MNIST                     (1) | Val  Loss: 1.4110 | Val  Acc: 0.6393
 Site-MNIST                     (0) | Val  Loss: 1.3347 | Val  Acc: 0.6677
 Site-USPS                      (0) | Val  Loss: 1.2965 | Val  Acc: 0.7000
 Site-USPS                      (3) | Val  Loss: 1.4859 | Val  Acc: 0.6111
 Site-USPS                      (2) | Val  Loss: 1.4127 | Val  Acc: 0.6875
 Site-USPS                      (0) | Val  Loss: 1.4506 | Val  Acc: 0.5862
 Site-USPS                      (2) | Val  Loss: 1.3671 | Val  Acc: 0.6952
 Site-USPS                      (0) | Val  Loss: 1.3281 | Val  Acc: 0.7037
 Site-SynthDigits               (0) | Val  Loss: 1.9003 | Val  Acc: 0.4595
 Site-SynthDigits               (0) | Val  Loss: 1.7069 | Val  Acc: 0.4118
 Site-SynthDigits               (2) | Val  Loss: 1.9281 | Val  Acc: 0.3607
 Site-MNIST_M                   (0) | Val  Loss: 2.2310 | Val  Acc: 0.2000
 Site-MNIST_M                   (4) | Val  Loss: 2.1857 | Val  Acc: 0.2346
 Site-SVHN                      (3) | Val  Loss: 1.7898 | Val  Acc: 0.2714
Average Valid Accuracy: 0.6194
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8000
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.7647
 Best site-MNIST                    (2)  | Epoch:3 | Val Acc: 0.7097
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.6607
 Best site-MNIST                    (4)  | Epoch:3 | Val Acc: 0.6863
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 0.6393
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.6677
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.7000
 Best site-USPS                     (3)  | Epoch:3 | Val Acc: 0.6111
 Best site-USPS                     (2)  | Epoch:3 | Val Acc: 0.6875
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.5862
 Best site-USPS                     (2)  | Epoch:3 | Val Acc: 0.6952
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.7037
 Best site-SynthDigits              (0)  | Epoch:3 | Val Acc: 0.4595
 Best site-SynthDigits              (0)  | Epoch:3 | Val Acc: 0.4118
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.3607
 Best site-MNIST_M                  (0)  | Epoch:3 | Val Acc: 0.2000
 Best site-MNIST_M                  (4)  | Epoch:3 | Val Acc: 0.2346
 Best site-SVHN                     (3)  | Epoch:3 | Val Acc: 0.2714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon/ccop_q=1...
============ Train epoch 4 ============
cnt=[6, 2, 2, 5, 7, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (3) | Train Loss: 1.5824 | Train Acc: 0.5000
 Site-MNIST                     (4) | Train Loss: 1.6132 | Train Acc: 0.5000
 Site-MNIST                     (3) | Train Loss: 1.1809 | Train Acc: 0.6667
 Site-MNIST                     (4) | Train Loss: 1.4329 | Train Acc: 0.6053
 Site-MNIST                     (3) | Train Loss: 1.2039 | Train Acc: 0.7000
 Site-MNIST                     (0) | Train Loss: 1.3058 | Train Acc: 0.6825
 Site-MNIST                     (3) | Train Loss: 1.2429 | Train Acc: 0.6960
 Site-MNIST                     (2) | Train Loss: 1.4232 | Train Acc: 0.6406
 Site-MNIST                     (1) | Train Loss: 1.3651 | Train Acc: 0.6549
 Site-MNIST                     (4) | Train Loss: 1.3390 | Train Acc: 0.6581
 Site-USPS                      (2) | Train Loss: 1.2527 | Train Acc: 0.7750
 Site-USPS                      (0) | Train Loss: 1.3313 | Train Acc: 0.7083
 Site-USPS                      (4) | Train Loss: 1.6322 | Train Acc: 0.7209
 Site-USPS                      (4) | Train Loss: 1.3452 | Train Acc: 0.6867
 Site-USPS                      (0) | Train Loss: 1.3943 | Train Acc: 0.6810
 Site-USPS                      (4) | Train Loss: 1.3623 | Train Acc: 0.6601
 Site-SynthDigits               (0) | Train Loss: 1.8181 | Train Acc: 0.3841
 Site-SynthDigits               (4) | Train Loss: 1.8625 | Train Acc: 0.3480
 Site-SynthDigits               (3) | Train Loss: 1.7777 | Train Acc: 0.4379
 Site-MNIST_M                   (0) | Train Loss: 2.1780 | Train Acc: 0.1878
 Site-MNIST_M                   (1) | Train Loss: 2.0978 | Train Acc: 0.2752
 Site-SVHN                      (0) | Train Loss: 1.7914 | Train Acc: 0.3901
Average Train Accuracy: 0.5709
 Site-MNIST                     (3) | Val  Loss: 1.5657 | Val  Acc: 1.0000
 Site-MNIST                     (4) | Val  Loss: 1.2859 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 1.0787 | Val  Acc: 1.0000
 Site-MNIST                     (4) | Val  Loss: 1.2593 | Val  Acc: 0.8889
 Site-MNIST                     (3) | Val  Loss: 1.2700 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 1.3696 | Val  Acc: 0.7742
 Site-MNIST                     (3) | Val  Loss: 1.3098 | Val  Acc: 0.6786
 Site-MNIST                     (2) | Val  Loss: 1.3108 | Val  Acc: 0.6765
 Site-MNIST                     (1) | Val  Loss: 1.4046 | Val  Acc: 0.6066
 Site-MNIST                     (4) | Val  Loss: 1.3157 | Val  Acc: 0.6556
 Site-USPS                      (2) | Val  Loss: 1.2708 | Val  Acc: 0.8000
 Site-USPS                      (0) | Val  Loss: 1.4495 | Val  Acc: 0.6667
 Site-USPS                      (4) | Val  Loss: 1.3666 | Val  Acc: 0.7500
 Site-USPS                      (4) | Val  Loss: 1.4187 | Val  Acc: 0.6207
 Site-USPS                      (0) | Val  Loss: 1.3234 | Val  Acc: 0.6952
 Site-USPS                      (4) | Val  Loss: 1.2832 | Val  Acc: 0.7302
 Site-SynthDigits               (0) | Val  Loss: 1.8071 | Val  Acc: 0.4324
 Site-SynthDigits               (4) | Val  Loss: 1.5379 | Val  Acc: 0.4265
 Site-SynthDigits               (3) | Val  Loss: 1.8242 | Val  Acc: 0.3607
 Site-MNIST_M                   (0) | Val  Loss: 2.2645 | Val  Acc: 0.1778
 Site-MNIST_M                   (1) | Val  Loss: 2.1895 | Val  Acc: 0.2099
 Site-SVHN                      (0) | Val  Loss: 1.6637 | Val  Acc: 0.3286
Average Valid Accuracy: 0.6528
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                    (4)  | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                    (4)  | Epoch:4 | Val Acc: 0.8889
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.7742
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.6786
 Best site-MNIST                    (2)  | Epoch:4 | Val Acc: 0.6765
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.6066
 Best site-MNIST                    (4)  | Epoch:4 | Val Acc: 0.6556
 Best site-USPS                     (2)  | Epoch:4 | Val Acc: 0.8000
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.6667
 Best site-USPS                     (4)  | Epoch:4 | Val Acc: 0.7500
 Best site-USPS                     (4)  | Epoch:4 | Val Acc: 0.6207
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.6952
 Best site-USPS                     (4)  | Epoch:4 | Val Acc: 0.7302
 Best site-SynthDigits              (0)  | Epoch:4 | Val Acc: 0.4324
 Best site-SynthDigits              (4)  | Epoch:4 | Val Acc: 0.4265
 Best site-SynthDigits              (3)  | Epoch:4 | Val Acc: 0.3607
 Best site-MNIST_M                  (0)  | Epoch:4 | Val Acc: 0.1778
 Best site-MNIST_M                  (1)  | Epoch:4 | Val Acc: 0.2099
 Best site-SVHN                     (0)  | Epoch:4 | Val Acc: 0.3286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_clscon/ccop_q=1...
============ Train epoch 5 ============
