===2023-03-25 21:06:59===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0455 | Train Acc: 0.3492
 Site-Clipart   | Train Loss: 1.9659 | Train Acc: 0.4286
 Site-Clipart   | Train Loss: 1.9071 | Train Acc: 0.5397
 Site-Clipart   | Train Loss: 1.9695 | Train Acc: 0.3968
 Site-Clipart   | Train Loss: 2.1233 | Train Acc: 0.3968
 Site-Clipart   | Train Loss: 2.0924 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 2.2298 | Train Acc: 0.1270
 Site-Infograph | Train Loss: 2.1902 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 2.1132 | Train Acc: 0.3016
 Site-Painting  | Train Loss: 2.0660 | Train Acc: 0.3492
 Site-QuickDraw | Train Loss: 2.2855 | Train Acc: 0.0794
 Site-Real      | Train Loss: 2.0004 | Train Acc: 0.4444
 Site-Sketch    | Train Loss: 1.9318 | Train Acc: 0.5397
 Site-Clipart   | Val  Loss: 2.1379 | Val  Acc: 0.2857
 Site-Clipart   | Val  Loss: 1.9420 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 1.8583 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.9556 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9295 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 2.0443 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1406 | Val  Acc: 0.2619
 Site-Infograph | Val  Loss: 2.1734 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1865 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 2.1812 | Val  Acc: 0.3095
 Site-QuickDraw | Val  Loss: 2.2735 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.0730 | Val  Acc: 0.4048
 Site-Sketch    | Val  Loss: 2.0227 | Val  Acc: 0.4286
Average Valid Accuracy: 0.3498
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2857
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2619
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Painting   | Epoch:0 | Val Acc: 0.3095
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0952
 Best site-Real       | Epoch:0 | Val Acc: 0.4048
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.7381 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.7226 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.6182 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.6392 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 1.8585 | Train Acc: 0.5397
 Site-Clipart   | Train Loss: 1.8607 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 2.1127 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.0838 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 1.9289 | Train Acc: 0.3968
 Site-Painting  | Train Loss: 1.7791 | Train Acc: 0.5397
 Site-QuickDraw | Train Loss: 2.2216 | Train Acc: 0.2540
 Site-Real      | Train Loss: 1.7005 | Train Acc: 0.6825
 Site-Sketch    | Train Loss: 1.7158 | Train Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.8327 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6013 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.5619 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.5855 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.6923 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.7623 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.9765 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 1.9999 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.0653 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.8931 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 2.2138 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.8408 | Val  Acc: 0.5952
 Site-Sketch    | Val  Loss: 1.8253 | Val  Acc: 0.6429
Average Valid Accuracy: 0.5293
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2857
 Best site-Painting   | Epoch:1 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2381
 Best site-Real       | Epoch:1 | Val Acc: 0.5952
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.4979 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.4718 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.3258 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.3934 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.5799 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.5568 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 2.0025 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 1.8882 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.7899 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 1.5312 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 2.1571 | Train Acc: 0.2698
 Site-Real      | Train Loss: 1.3958 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 1.4145 | Train Acc: 0.7302
 Site-Clipart   | Val  Loss: 1.6063 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.3765 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.3052 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.2921 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.4797 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.5323 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.8238 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.8793 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.0125 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.7415 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 2.1450 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.4354 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.5790 | Val  Acc: 0.6667
Average Valid Accuracy: 0.5971
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3333
 Best site-Painting   | Epoch:2 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2619
 Best site-Real       | Epoch:2 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.2691 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.2820 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.1318 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.1613 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.4144 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.4595 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 1.9245 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.8069 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.6577 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 1.3347 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 2.1275 | Train Acc: 0.2381
 Site-Real      | Train Loss: 1.2145 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.2438 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.3765 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.1589 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.0787 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.1401 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.2397 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.3294 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.7402 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.7358 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.8977 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 1.5160 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 2.0447 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.2863 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.4194 | Val  Acc: 0.7619
Average Valid Accuracy: 0.6447
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3571
 Best site-Painting   | Epoch:3 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2857
 Best site-Real       | Epoch:3 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.2097 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.0862 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 1.0259 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 1.0149 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.2569 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.2832 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 1.8998 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.7308 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.6012 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 1.1868 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 2.1242 | Train Acc: 0.2540
 Site-Real      | Train Loss: 1.0817 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 1.1921 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 1.2388 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.0350 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9787 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9191 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.1887 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.1472 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.6364 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.6718 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.8541 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 1.3798 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.0983 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.0490 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.3063 | Val  Acc: 0.7619
Average Valid Accuracy: 0.6667
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4286
 Best site-Painting   | Epoch:4 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2619
 Best site-Real       | Epoch:4 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 1.0381 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.0073 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.9247 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.9701 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 1.1032 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.1578 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.8633 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.6678 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.5114 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 1.1014 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 2.0555 | Train Acc: 0.3016
 Site-Real      | Train Loss: 0.9503 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.0156 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 1.1322 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.9204 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.8283 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9029 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.0414 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.0203 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.5174 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.5766 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.8102 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 1.3102 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 2.0049 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.9641 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.2736 | Val  Acc: 0.8095
Average Valid Accuracy: 0.7015
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3571
 Best site-Painting   | Epoch:5 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3333
 Best site-Real       | Epoch:5 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.9388 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.8877 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.8386 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.8085 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 1.0274 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 1.0932 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.8169 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 1.5653 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.4310 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 1.0391 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 1.9799 | Train Acc: 0.3016
 Site-Real      | Train Loss: 0.8193 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.9448 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 1.0126 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.8322 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.7851 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7874 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.9691 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.9305 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.4409 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.4882 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.6877 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 1.1934 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 2.0667 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.8958 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.2131 | Val  Acc: 0.7381
Average Valid Accuracy: 0.7070
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4524
 Best site-Painting   | Epoch:6 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3095
 Best site-Real       | Epoch:6 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.8366 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.8921 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.8043 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7603 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.9350 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 1.0163 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.6944 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.5381 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.3578 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.9316 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.9833 | Train Acc: 0.3492
 Site-Real      | Train Loss: 0.7268 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.8796 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9833 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.6910 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.6704 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.6698 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.8241 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.8911 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3626 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4640 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.6785 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 1.1418 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.9342 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.7551 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.1478 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7161
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4048
 Best site-Painting   | Epoch:7 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3095
 Best site-Real       | Epoch:7 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.8736 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.8175 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.7117 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.6582 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.9343 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.9397 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.7234 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.4882 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.3380 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.8085 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.9623 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.7049 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.8331 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 0.8782 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.6834 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6779 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6223 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.8534 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.8606 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.4248 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.4115 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.6370 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 1.1366 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.9753 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.6832 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.0930 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7253
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4524
 Best site-Painting   | Epoch:8 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.2857
 Best site-Real       | Epoch:8 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:8 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.7226 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.7353 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.6726 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.6529 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.8291 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.9143 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.7693 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.4197 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.2819 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.7978 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.8487 | Train Acc: 0.3810
 Site-Real      | Train Loss: 0.6518 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.7989 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.8596 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.6000 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.5650 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.5481 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.7889 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.8509 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3624 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4176 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6295 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.0589 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.8667 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.6700 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.9899 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7473
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5000
 Best site-Painting   | Epoch:9 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.3333
 Best site-Real       | Epoch:9 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/DoPrompt...
===2023-03-25 21:42:17===
===2023-03-25 21:42:18===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8384
 Test site-Infograph | Epoch:9 | Test Acc: 0.4566
 Test site-Painting  | Epoch:9 | Test Acc: 0.8368
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.3940
 Test site-Real      | Epoch:9 | Test Acc: 0.8989
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7744
Average Test Accuracy: 0.6999
