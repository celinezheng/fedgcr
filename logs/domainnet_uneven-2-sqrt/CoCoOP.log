===2023-03-25 21:43:48===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 1.9255 | Train Acc: 0.4921
 Site-Clipart   | Train Loss: 1.8659 | Train Acc: 0.5397
 Site-Clipart   | Train Loss: 1.8255 | Train Acc: 0.5238
 Site-Clipart   | Train Loss: 1.8643 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 2.0214 | Train Acc: 0.3968
 Site-Clipart   | Train Loss: 1.9299 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 2.1485 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 2.1440 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.9928 | Train Acc: 0.4762
 Site-Painting  | Train Loss: 1.9157 | Train Acc: 0.5079
 Site-QuickDraw | Train Loss: 2.3094 | Train Acc: 0.0952
 Site-Real      | Train Loss: 1.8994 | Train Acc: 0.5873
 Site-Sketch    | Train Loss: 1.8474 | Train Acc: 0.5238
 Site-Clipart   | Val  Loss: 2.0381 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 1.9498 | Val  Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.8072 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.7810 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.8931 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.9097 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.0859 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1290 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1217 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 2.0416 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 2.2864 | Val  Acc: 0.1190
 Site-Real      | Val  Loss: 1.9606 | Val  Acc: 0.4524
 Site-Sketch    | Val  Loss: 1.9846 | Val  Acc: 0.5000
Average Valid Accuracy: 0.3993
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4286
 Best site-Clipart    | Epoch:0 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Painting   | Epoch:0 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1190
 Best site-Real       | Epoch:0 | Val Acc: 0.4524
 Best site-Sketch     | Epoch:0 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.5262 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.5321 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.4105 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.4000 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.6239 | Train Acc: 0.5714
 Site-Clipart   | Train Loss: 1.5935 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 2.0016 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.9112 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.7501 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 1.5605 | Train Acc: 0.5873
 Site-QuickDraw | Train Loss: 2.1767 | Train Acc: 0.2540
 Site-Real      | Train Loss: 1.3881 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 1.4192 | Train Acc: 0.7302
 Site-Clipart   | Val  Loss: 1.5451 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.4571 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.3618 | Val  Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.3660 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.4638 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.5046 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.8401 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.9126 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.0717 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 1.6844 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 2.1135 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.5167 | Val  Acc: 0.6429
 Site-Sketch    | Val  Loss: 1.6717 | Val  Acc: 0.5476
Average Valid Accuracy: 0.5458
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6429
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2619
 Best site-Painting   | Epoch:1 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2619
 Best site-Real       | Epoch:1 | Val Acc: 0.6429
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5476
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.1746 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.2023 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.0360 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 1.0367 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 1.2381 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.2807 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.8286 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.7096 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.5859 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 1.1154 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 2.1238 | Train Acc: 0.3016
 Site-Real      | Train Loss: 1.0392 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 1.1933 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.2047 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.0527 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.0004 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 1.0180 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.1442 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.1418 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.5728 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.6538 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8030 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 1.3899 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.1728 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.1078 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 1.4078 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6758
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4286
 Best site-Painting   | Epoch:2 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3333
 Best site-Real       | Epoch:2 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.8443 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.9302 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.8496 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.7323 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.9742 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 1.0452 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.7603 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.6154 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.3816 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 0.9473 | Train Acc: 0.7619
 Site-QuickDraw | Train Loss: 2.0573 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.8060 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.9049 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.0261 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7329 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7823 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7206 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.9644 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.0212 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4500 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.4973 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.7465 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.1037 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 2.0553 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.8332 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.2229 | Val  Acc: 0.6667
Average Valid Accuracy: 0.6996
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-Painting   | Epoch:3 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3333
 Best site-Real       | Epoch:3 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.6373 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.8342 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.6342 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.5350 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.7566 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.8326 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.6207 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.3288 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.2881 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.7041 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 2.0500 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.5957 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.7196 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 0.7452 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.5600 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5257 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.5473 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7487 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7585 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.2596 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.3812 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.5313 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.9207 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.9929 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.6118 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.0036 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7527
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Painting   | Epoch:4 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3571
 Best site-Real       | Epoch:4 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.4720 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.6080 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.4708 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4460 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.6675 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.7399 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.4571 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1738 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 1.1143 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.5617 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 2.0828 | Train Acc: 0.3175
 Site-Real      | Train Loss: 0.4626 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.5152 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.5512 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3990 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4155 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4192 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.6046 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5548 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.0409 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1856 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.3669 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.9022 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.9951 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.5512 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.9243 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7839
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5952
 Best site-Painting   | Epoch:5 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3571
 Best site-Real       | Epoch:5 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.3623 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.5196 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.3772 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3494 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.5287 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.6088 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.3702 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0850 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.9088 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.4677 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.9577 | Train Acc: 0.3492
 Site-Real      | Train Loss: 0.3343 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.5199 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4184 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3320 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3507 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3389 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4892 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.5803 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.9460 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.0291 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.2997 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.7523 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.9388 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.4550 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.9071 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7894
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5952
 Best site-Painting   | Epoch:6 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3333
 Best site-Real       | Epoch:6 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.3029 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3611 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2545 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2453 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3632 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.5399 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.2797 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.0182 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.9037 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.4039 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.7478 | Train Acc: 0.3968
 Site-Real      | Train Loss: 0.3201 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.3470 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3843 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2152 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2423 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2506 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3826 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4348 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.8641 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.0386 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.1168 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.8729 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 2.0367 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.4066 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.7574 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8187
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5714
 Best site-Painting   | Epoch:7 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.4048
 Best site-Real       | Epoch:7 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.2648 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2810 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2071 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2072 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4055 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.3907 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.1865 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.8915 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.8088 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.3187 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.8559 | Train Acc: 0.4286
 Site-Real      | Train Loss: 0.2081 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3813 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3070 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2254 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2005 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1856 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3417 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3177 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.6853 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.7754 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.9679 | Val  Acc: 0.6429
 Site-Painting  | Val  Loss: 0.5914 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.9392 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.2747 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7120 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8480
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6429
 Best site-Painting   | Epoch:8 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.4762
 Best site-Real       | Epoch:8 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/CoCoOP...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.1993 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2978 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1791 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1591 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2667 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3579 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.0948 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.8791 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.6846 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.2664 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.8033 | Train Acc: 0.4603
 Site-Real      | Train Loss: 0.1770 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3294 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2217 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1507 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1899 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1736 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2884 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2531 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.6693 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.6981 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.9164 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.6842 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.8688 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.3000 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6596 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8755
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7619
 Best site-Painting   | Epoch:9 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.4762
 Best site-Real       | Epoch:9 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/CoCoOP...
===2023-03-25 22:17:57===
===2023-03-25 22:17:58===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8688
 Test site-Infograph | Epoch:9 | Test Acc: 0.4916
 Test site-Painting  | Epoch:9 | Test Acc: 0.8401
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.4200
 Test site-Real      | Epoch:9 | Test Acc: 0.9187
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7816
Average Test Accuracy: 0.7201
