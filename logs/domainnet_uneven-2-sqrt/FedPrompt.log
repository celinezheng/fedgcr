===2023-03-25 20:29:11===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 1.9867 | Train Acc: 0.4286
 Site-Clipart   | Train Loss: 1.9259 | Train Acc: 0.4286
 Site-Clipart   | Train Loss: 1.8735 | Train Acc: 0.5397
 Site-Clipart   | Train Loss: 1.8777 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 2.0682 | Train Acc: 0.3492
 Site-Clipart   | Train Loss: 2.0530 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 2.1851 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1696 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 2.0549 | Train Acc: 0.3492
 Site-Painting  | Train Loss: 1.9859 | Train Acc: 0.4286
 Site-QuickDraw | Train Loss: 2.2886 | Train Acc: 0.1587
 Site-Real      | Train Loss: 1.8935 | Train Acc: 0.5238
 Site-Sketch    | Train Loss: 1.8664 | Train Acc: 0.5873
 Site-Clipart   | Val  Loss: 2.0613 | Val  Acc: 0.3571
 Site-Clipart   | Val  Loss: 1.8521 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 1.8666 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.8774 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.8844 | Val  Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.9638 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.1487 | Val  Acc: 0.2619
 Site-Infograph | Val  Loss: 2.1624 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1645 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 2.0694 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.2497 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.9559 | Val  Acc: 0.4524
 Site-Sketch    | Val  Loss: 2.0346 | Val  Acc: 0.4286
Average Valid Accuracy: 0.3736
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3571
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4286
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2619
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Painting   | Epoch:0 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1667
 Best site-Real       | Epoch:0 | Val Acc: 0.4524
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.6392 | Train Acc: 0.5556
 Site-Clipart   | Train Loss: 1.7007 | Train Acc: 0.4921
 Site-Clipart   | Train Loss: 1.5111 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.5273 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.7582 | Train Acc: 0.4921
 Site-Clipart   | Train Loss: 1.6862 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 2.1106 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 2.0286 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.8943 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 1.6030 | Train Acc: 0.5873
 Site-QuickDraw | Train Loss: 2.2495 | Train Acc: 0.1270
 Site-Real      | Train Loss: 1.4317 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 1.4671 | Train Acc: 0.6984
 Site-Clipart   | Val  Loss: 1.7338 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.4574 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.4556 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.4066 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.6651 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.6788 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 2.0062 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.0405 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.1857 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 1.8086 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 2.2122 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.5170 | Val  Acc: 0.7143
 Site-Sketch    | Val  Loss: 1.6926 | Val  Acc: 0.4286
Average Valid Accuracy: 0.5073
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2143
 Best site-Painting   | Epoch:1 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2381
 Best site-Real       | Epoch:1 | Val Acc: 0.7143
 Best site-Sketch     | Epoch:1 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.3130 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.3283 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.1361 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.1832 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.3389 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.4307 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 1.9449 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.7570 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.5971 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 1.2738 | Train Acc: 0.7619
 Site-QuickDraw | Train Loss: 2.2560 | Train Acc: 0.2381
 Site-Real      | Train Loss: 1.1657 | Train Acc: 0.7778
 Site-Sketch    | Train Loss: 1.2502 | Train Acc: 0.6825
 Site-Clipart   | Val  Loss: 1.3194 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.1968 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.1192 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.1065 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.3012 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.2975 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.5194 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7377 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9682 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 1.4219 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 2.2524 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.1462 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.4363 | Val  Acc: 0.6429
Average Valid Accuracy: 0.6355
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2619
 Best site-Painting   | Epoch:2 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2857
 Best site-Real       | Epoch:2 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.0874 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.1644 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 0.9163 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.8215 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 1.1360 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 1.1050 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.8217 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.7242 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.4829 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 1.0688 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 2.0440 | Train Acc: 0.3016
 Site-Real      | Train Loss: 0.7451 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 1.0085 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 1.0700 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.8140 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.8202 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.8238 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 1.1168 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.1137 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.5758 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.5378 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 2.0090 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.2864 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 2.1026 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.7702 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 1.1431 | Val  Acc: 0.7619
Average Valid Accuracy: 0.6850
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2857
 Best site-Painting   | Epoch:3 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2857
 Best site-Real       | Epoch:3 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.8123 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.8838 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 0.7063 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.6317 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.8729 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.9460 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.6300 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.4961 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1494 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.8991 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 2.0021 | Train Acc: 0.3810
 Site-Real      | Train Loss: 0.6554 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.8737 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 0.9092 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.7238 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.5959 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.6083 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.8883 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 0.8921 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.2170 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4063 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7586 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 1.1395 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 2.0458 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.6541 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.0950 | Val  Acc: 0.7381
Average Valid Accuracy: 0.7179
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4524
 Best site-Painting   | Epoch:4 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3571
 Best site-Real       | Epoch:4 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.6132 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.6993 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.5384 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.5058 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7497 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.7532 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.6257 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.4227 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.0576 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.6266 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.9340 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.4586 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.6622 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7131 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5247 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.5122 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4194 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7423 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.6833 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.1318 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3635 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6237 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.9404 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 2.1721 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.4465 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.8955 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7619
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:5 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4286
 Best site-Painting   | Epoch:5 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2857
 Best site-Real       | Epoch:5 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.5689 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7823 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.5427 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4234 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.7505 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.6668 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.5485 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.2584 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 1.0934 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.6020 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.7262 | Train Acc: 0.4603
 Site-Real      | Train Loss: 0.3888 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.7099 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.6257 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.4417 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3726 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4835 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7516 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.6829 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.0756 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.1981 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.6312 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.8842 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.7366 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.4503 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.8265 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7582
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.4907 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.6428 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.3369 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2575 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.4797 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.5960 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.4196 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.2195 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 0.9119 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.5536 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.7450 | Train Acc: 0.4286
 Site-Real      | Train Loss: 0.3421 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.4518 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4647 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.2843 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3105 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3076 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.6438 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.5798 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.9300 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.0773 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.7825 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.8414 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.7766 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3462 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7753 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7894
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4048
 Best site-Painting   | Epoch:7 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5000
 Best site-Real       | Epoch:7 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3259 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4319 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3292 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2444 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4438 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.5434 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.3782 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.0067 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.7894 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.4135 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.7302 | Train Acc: 0.4603
 Site-Real      | Train Loss: 0.3406 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.4681 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4676 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3332 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2855 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2838 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.5160 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4256 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.7445 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.9434 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.2960 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.6247 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.8525 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.3701 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.7066 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8223
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5476
 Best site-Painting   | Epoch:8 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.4524
 Best site-Real       | Epoch:8 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2719 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3787 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.2394 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1808 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3391 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4035 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.0883 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.0934 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.7147 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.3662 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.7091 | Train Acc: 0.4762
 Site-Real      | Train Loss: 0.2775 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3649 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.2531 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1741 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1497 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1828 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4322 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3561 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.6994 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.8697 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.2005 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.5790 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.8957 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.2661 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7086 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8535
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6190
 Best site-Painting   | Epoch:9 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.4286
 Best site-Real       | Epoch:9 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt/FedPrompt...
===2023-03-25 21:05:28===
===2023-03-25 21:05:29===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8574
 Test site-Infograph | Epoch:9 | Test Acc: 0.5114
 Test site-Painting  | Epoch:9 | Test Acc: 0.8207
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.4070
 Test site-Real      | Epoch:9 | Test Acc: 0.9219
 Test site-Sketch    | Epoch:9 | Test Acc: 0.8069
Average Test Accuracy: 0.7209
===2023-03-30 19:02:09===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
