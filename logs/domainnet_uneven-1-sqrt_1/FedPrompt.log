===2023-03-31 14:03:53===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 40
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
===2023-03-31 16:18:18===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 40
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-1
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
cnt=[1, 10, 1, ]
 Site-Clipart   | Train Loss: 1.9525 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9117 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.8209 | Train Acc: 0.5397
 Site-Clipart   | Train Loss: 1.9213 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 2.1958 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1521 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 2.0847 | Train Acc: 0.3333
 Site-Painting  | Train Loss: 1.9390 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.9670 | Train Acc: 0.4127
 Site-QuickDraw | Train Loss: 2.3235 | Train Acc: 0.1429
 Site-Real      | Train Loss: 1.8346 | Train Acc: 0.5397
 Site-Sketch    | Train Loss: 1.8877 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.8029 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.8115 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.9092 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.0174 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.0966 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0956 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1803 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 1.8046 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 2.0840 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 2.2621 | Val  Acc: 0.1190
 Site-Real      | Val  Loss: 1.9224 | Val  Acc: 0.5238
 Site-Sketch    | Val  Loss: 1.9873 | Val  Acc: 0.4048
Average Valid Accuracy: 0.3849
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1667
 Best site-Painting   | Epoch:0 | Val Acc: 0.5000
 Best site-Painting   | Epoch:0 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1190
 Best site-Real       | Epoch:0 | Val Acc: 0.5238
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 1.5518 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.6563 | Train Acc: 0.5556
 Site-Clipart   | Train Loss: 1.4526 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.4714 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 2.0988 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.9824 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.8954 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.4800 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 1.5244 | Train Acc: 0.6349
 Site-QuickDraw | Train Loss: 2.2578 | Train Acc: 0.1587
 Site-Real      | Train Loss: 1.3230 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 1.3791 | Train Acc: 0.6508
 Site-Clipart   | Val  Loss: 1.3276 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.3837 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.5995 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.6920 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.9315 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 1.9839 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.1693 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 1.2903 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 1.6483 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 2.1790 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.4201 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.5860 | Val  Acc: 0.5714
Average Valid Accuracy: 0.5417
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2143
 Best site-Painting   | Epoch:1 | Val Acc: 0.7857
 Best site-Painting   | Epoch:1 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1667
 Best site-Real       | Epoch:1 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5714
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 1.2396 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.2808 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.1291 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.0799 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.8965 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.8129 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.6473 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 1.0843 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 1.0474 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 2.1526 | Train Acc: 0.2698
 Site-Real      | Train Loss: 0.9660 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 1.0567 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9914 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.0472 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.2858 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.3098 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.7082 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 1.7394 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8943 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 0.9511 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 1.1985 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 2.1454 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.0067 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.3341 | Val  Acc: 0.5952
Average Valid Accuracy: 0.6409
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2857
 Best site-Painting   | Epoch:2 | Val Acc: 0.8810
 Best site-Painting   | Epoch:2 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3095
 Best site-Real       | Epoch:2 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:2 | Val Acc: 0.5952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.9345 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.1265 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 0.8622 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.7587 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.8270 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.6729 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.5351 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 0.8299 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.8540 | Train Acc: 0.7619
 Site-QuickDraw | Train Loss: 2.0548 | Train Acc: 0.3175
 Site-Real      | Train Loss: 0.6083 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.8677 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.6960 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7036 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 1.0849 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.1232 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.7246 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.5436 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9352 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 0.7456 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 0.9535 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.9764 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 0.6960 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.0446 | Val  Acc: 0.7381
Average Valid Accuracy: 0.6627
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2857
 Best site-Painting   | Epoch:3 | Val Acc: 0.8571
 Best site-Painting   | Epoch:3 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2619
 Best site-Real       | Epoch:3 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.7476 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.9365 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.6153 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.5753 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.6181 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.4049 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.2852 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.6596 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.6454 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.8060 | Train Acc: 0.4603
 Site-Real      | Train Loss: 0.4742 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.6833 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.5099 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5775 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.8464 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.8637 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.4424 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.3290 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7124 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.5355 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.7880 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.8756 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.5412 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.8918 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7381
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4048
 Best site-Painting   | Epoch:4 | Val Acc: 0.9524
 Best site-Painting   | Epoch:4 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.4048
 Best site-Real       | Epoch:4 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.5520 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.6886 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.4559 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3733 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.4822 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.2268 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.1015 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.5203 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.4529 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.8669 | Train Acc: 0.3810
 Site-Real      | Train Loss: 0.4220 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.4615 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3560 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.4169 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7534 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.6478 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.4261 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.1639 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.4466 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.3905 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.5494 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 2.0008 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.4179 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7976 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7817
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:5 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5000
 Best site-Painting   | Epoch:5 | Val Acc: 0.9524
 Best site-Painting   | Epoch:5 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3095
 Best site-Real       | Epoch:5 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.4436 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5498 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.3531 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2690 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.3026 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.2392 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.1572 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.3855 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.3729 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.6885 | Train Acc: 0.4603
 Site-Real      | Train Loss: 0.2999 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.5131 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.2793 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2911 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6575 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.4513 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.2372 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.1152 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.4506 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.3445 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.4019 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.8161 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.3313 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7955 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7917
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4762
 Best site-Painting   | Epoch:6 | Val Acc: 0.9524
 Best site-Painting   | Epoch:6 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.4524
 Best site-Real       | Epoch:6 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.2940 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4829 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.2214 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2167 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.2482 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.9078 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.0764 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.3028 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.2962 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.5829 | Train Acc: 0.5238
 Site-Real      | Train Loss: 0.2800 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.3168 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2123 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2016 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5477 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.4669 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.0963 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 0.8876 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1953 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.1961 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3783 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.7811 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.3430 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.6458 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8194
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6190
 Best site-Painting   | Epoch:7 | Val Acc: 0.9762
 Best site-Painting   | Epoch:7 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.4286
 Best site-Real       | Epoch:7 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.3158 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3606 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2397 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1691 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.0515 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 0.9164 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 0.8348 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.2740 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.1519 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 1.5884 | Train Acc: 0.4921
 Site-Real      | Train Loss: 0.2991 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.2474 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.2138 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2086 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3785 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3335 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.8276 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 0.7819 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1171 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.1516 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2637 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.9131 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.3408 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.7833 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8254
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5714
 Best site-Painting   | Epoch:8 | Val Acc: 1.0000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3571
 Best site-Real       | Epoch:8 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.2405 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3346 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1937 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1125 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.0145 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.6705 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 0.9154 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.1859 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.1872 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.3200 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.1973 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.2111 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1419 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1505 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3984 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3019 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.9523 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.7526 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.9890 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.1456 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2050 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.7186 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.2380 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6320 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8413
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6667
 Best site-Painting   | Epoch:9 | Val Acc: 1.0000
 Best site-Painting   | Epoch:9 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.4048
 Best site-Real       | Epoch:9 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 50 ============
============ Train epoch 51 ============
============ Train epoch 52 ============
============ Train epoch 53 ============
============ Train epoch 54 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.1912 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3374 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.1344 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0850 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.9607 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.6866 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 0.7084 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.1668 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.1420 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.3110 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.1856 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.1977 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.0787 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1210 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3279 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2055 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.6968 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.6277 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.8555 | Val  Acc: 0.6429
 Site-Painting  | Val  Loss: 0.1622 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.1969 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.5429 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.3105 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6286 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8571
 Best site-Clipart    | Epoch:10 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:10 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:10 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:10 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:10 | Val Acc: 0.6429
 Best site-Painting   | Epoch:10 | Val Acc: 0.9524
 Best site-Painting   | Epoch:10 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.4524
 Best site-Real       | Epoch:10 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:10 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 55 ============
============ Train epoch 56 ============
============ Train epoch 57 ============
============ Train epoch 58 ============
============ Train epoch 59 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.1489 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2443 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1428 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0941 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 0.8675 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.5495 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 0.6265 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.1559 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1367 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.2968 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.1414 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.1387 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.0947 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1317 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2366 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1946 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.7437 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.4826 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.6564 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 0.0836 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1531 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.6716 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.2813 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5720 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8889
 Best site-Clipart    | Epoch:11 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:11 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:11 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:11 | Val Acc: 0.8571
 Best site-Painting   | Epoch:11 | Val Acc: 1.0000
 Best site-Painting   | Epoch:11 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.4524
 Best site-Real       | Epoch:11 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:11 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 60 ============
============ Train epoch 61 ============
============ Train epoch 62 ============
============ Train epoch 63 ============
============ Train epoch 64 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.1408 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1836 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.0783 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1369 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.7069 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 0.4885 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 0.5566 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.1082 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.0816 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 1.2865 | Train Acc: 0.5238
 Site-Real      | Train Loss: 0.1686 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.1343 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.0783 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1523 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2241 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1315 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.7145 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.3135 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.5621 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 0.1100 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1307 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.5324 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.1961 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7462 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8909
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:12 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:12 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:12 | Val Acc: 0.8333
 Best site-Painting   | Epoch:12 | Val Acc: 1.0000
 Best site-Painting   | Epoch:12 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.5238
 Best site-Real       | Epoch:12 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:12 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 65 ============
============ Train epoch 66 ============
============ Train epoch 67 ============
============ Train epoch 68 ============
============ Train epoch 69 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0748 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1850 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0909 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0541 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.5710 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 0.4166 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 0.3646 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.0996 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.0927 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.1982 | Train Acc: 0.6032
 Site-Real      | Train Loss: 0.1319 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.1334 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.0437 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0712 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1781 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1122 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.4075 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.3302 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.4715 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.0773 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1137 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.2384 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.4101 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.5737 | Val  Acc: 0.8810
Average Valid Accuracy: 0.9187
 Best site-Clipart    | Epoch:13 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:13 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:13 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:13 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:13 | Val Acc: 0.8810
 Best site-Painting   | Epoch:13 | Val Acc: 1.0000
 Best site-Painting   | Epoch:13 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.5952
 Best site-Real       | Epoch:13 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:13 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 70 ============
============ Train epoch 71 ============
============ Train epoch 72 ============
============ Train epoch 73 ============
============ Train epoch 74 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0569 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1679 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.0683 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0350 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.6246 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 0.4244 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 0.5054 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.0870 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.0705 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 1.2210 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.0926 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.1297 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.0656 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0517 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1941 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1008 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.4954 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.4921 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.5966 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.0461 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0911 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.5263 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.3635 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.5287 | Val  Acc: 0.9048
Average Valid Accuracy: 0.9008
============ Train epoch 75 ============
============ Train epoch 76 ============
============ Train epoch 77 ============
============ Train epoch 78 ============
============ Train epoch 79 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0750 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1167 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0727 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0435 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.4803 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 0.3688 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 0.3998 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.0781 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.0718 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 1.2467 | Train Acc: 0.6349
 Site-Real      | Train Loss: 0.1340 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.0693 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.0834 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.0798 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1583 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0838 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.3526 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.2215 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.3853 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.0393 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0894 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.4689 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.3075 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7034 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9266
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:15 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:15 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:15 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:15 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:15 | Val Acc: 0.9286
 Best site-Painting   | Epoch:15 | Val Acc: 1.0000
 Best site-Painting   | Epoch:15 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.5476
 Best site-Real       | Epoch:15 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:15 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 80 ============
============ Train epoch 81 ============
============ Train epoch 82 ============
============ Train epoch 83 ============
============ Train epoch 84 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0489 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1760 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.0883 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0335 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.4168 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 0.3963 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 0.3626 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.0490 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0587 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.8740 | Train Acc: 0.7460
 Site-Real      | Train Loss: 0.0714 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.0756 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0506 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0519 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1648 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.0577 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.4006 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.3019 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.3689 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.0296 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0590 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.3677 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.2006 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6832 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9286
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:16 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:16 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:16 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:16 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:16 | Val Acc: 0.9286
 Best site-Painting   | Epoch:16 | Val Acc: 1.0000
 Best site-Painting   | Epoch:16 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.6667
 Best site-Real       | Epoch:16 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:16 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 85 ============
============ Train epoch 86 ============
============ Train epoch 87 ============
============ Train epoch 88 ============
============ Train epoch 89 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0672 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2219 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1243 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.0336 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.4052 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 0.3226 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 0.2783 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.0607 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0635 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.9172 | Train Acc: 0.7460
 Site-Real      | Train Loss: 0.1091 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.0802 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.0336 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0757 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1637 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.0892 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.3153 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.2156 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.4136 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.0607 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0638 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.3235 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.2598 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.4420 | Val  Acc: 0.9524
Average Valid Accuracy: 0.9345
 Best site-Clipart    | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:17 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:17 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:17 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:17 | Val Acc: 0.9286
 Best site-Painting   | Epoch:17 | Val Acc: 1.0000
 Best site-Painting   | Epoch:17 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.6190
 Best site-Real       | Epoch:17 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:17 | Val Acc: 0.9524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 90 ============
============ Train epoch 91 ============
============ Train epoch 92 ============
============ Train epoch 93 ============
============ Train epoch 94 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0499 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1132 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0433 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0319 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.4225 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 0.3284 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 0.3433 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.0425 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0590 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.8571 | Train Acc: 0.7302
 Site-Real      | Train Loss: 0.0711 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.0851 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.0305 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0440 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1378 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0488 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.3093 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.2759 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.4472 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 0.0289 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0466 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.3246 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.1417 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.4723 | Val  Acc: 0.9048
Average Valid Accuracy: 0.9206
============ Train epoch 95 ============
============ Train epoch 96 ============
============ Train epoch 97 ============
============ Train epoch 98 ============
============ Train epoch 99 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0456 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1126 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.0628 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0897 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 0.4478 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 0.3203 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 0.3137 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.0696 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.0442 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.8343 | Train Acc: 0.7460
 Site-Real      | Train Loss: 0.0509 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.0802 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.0276 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0727 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1187 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.0563 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.2644 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.1609 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.4329 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 0.0259 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0740 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.4310 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.2283 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4905 | Val  Acc: 0.9048
Average Valid Accuracy: 0.9266
============ Train epoch 100 ============
============ Train epoch 101 ============
============ Train epoch 102 ============
============ Train epoch 103 ============
============ Train epoch 104 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0323 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0763 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0329 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0203 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.2870 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 0.2384 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.1802 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.0461 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0245 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.8297 | Train Acc: 0.7460
 Site-Real      | Train Loss: 0.0677 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.0617 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0262 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0415 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0929 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0486 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.2581 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.2381 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.2947 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.0229 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0559 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.1682 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.2874 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7456 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9286
============ Train epoch 105 ============
============ Train epoch 106 ============
============ Train epoch 107 ============
============ Train epoch 108 ============
============ Train epoch 109 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0411 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0650 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0499 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0238 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.3409 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 0.2420 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 0.2042 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.0551 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.0341 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.8059 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.0633 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.0327 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0281 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0683 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0595 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0557 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.2188 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.1765 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.2951 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.0281 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0569 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.3326 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.3538 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5023 | Val  Acc: 0.8810
Average Valid Accuracy: 0.9405
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:21 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:21 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:21 | Val Acc: 0.9524
 Best site-Painting   | Epoch:21 | Val Acc: 1.0000
 Best site-Painting   | Epoch:21 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.6667
 Best site-Real       | Epoch:21 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:21 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 110 ============
============ Train epoch 111 ============
============ Train epoch 112 ============
============ Train epoch 113 ============
============ Train epoch 114 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0316 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0821 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0560 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0235 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.2634 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.3443 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 0.2711 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.0714 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.0345 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.6358 | Train Acc: 0.8571
 Site-Real      | Train Loss: 0.0616 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.0551 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.0116 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0412 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1074 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.0379 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.2098 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.2127 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.2791 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.0138 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0355 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.1453 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.1905 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5805 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9325
============ Train epoch 115 ============
============ Train epoch 116 ============
============ Train epoch 117 ============
============ Train epoch 118 ============
============ Train epoch 119 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0322 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0793 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0542 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0209 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.2967 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 0.2254 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.2164 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.0685 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.0306 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.7116 | Train Acc: 0.7619
 Site-Real      | Train Loss: 0.0560 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.0562 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0213 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0695 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0651 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0819 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.2691 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.1512 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.3094 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.0241 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0361 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 0.9778 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 0.3409 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4879 | Val  Acc: 0.8810
Average Valid Accuracy: 0.9425
 Best site-Clipart    | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:23 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:23 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:23 | Val Acc: 0.9286
 Best site-Painting   | Epoch:23 | Val Acc: 1.0000
 Best site-Painting   | Epoch:23 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.7381
 Best site-Real       | Epoch:23 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:23 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 120 ============
============ Train epoch 121 ============
============ Train epoch 122 ============
============ Train epoch 123 ============
============ Train epoch 124 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0228 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0806 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0299 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0278 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.2275 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.2369 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.2038 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.0379 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.0228 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.6428 | Train Acc: 0.8571
 Site-Real      | Train Loss: 0.0467 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.0466 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0172 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0313 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0931 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0364 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.1986 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.2131 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.2656 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.0227 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0362 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.1340 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.1876 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6809 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9425
============ Train epoch 125 ============
============ Train epoch 126 ============
============ Train epoch 127 ============
============ Train epoch 128 ============
============ Train epoch 129 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0209 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0569 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0569 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0204 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.2430 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 0.2129 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 0.1624 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.0583 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.0224 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.5792 | Train Acc: 0.8571
 Site-Real      | Train Loss: 0.0624 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.0419 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.0111 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0442 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0826 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0459 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.1739 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.1361 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.3227 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.0165 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0274 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.0842 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 0.3168 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4269 | Val  Acc: 0.9286
Average Valid Accuracy: 0.9583
 Best site-Clipart    | Epoch:25 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:25 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:25 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:25 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:25 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:25 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:25 | Val Acc: 0.9524
 Best site-Painting   | Epoch:25 | Val Acc: 1.0000
 Best site-Painting   | Epoch:25 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:25 | Val Acc: 0.7143
 Best site-Real       | Epoch:25 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:25 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 130 ============
============ Train epoch 131 ============
============ Train epoch 132 ============
============ Train epoch 133 ============
============ Train epoch 134 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0102 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0679 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0616 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.0106 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.2514 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 0.1438 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.1916 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.0236 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0299 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.6160 | Train Acc: 0.8095
 Site-Real      | Train Loss: 0.0443 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.0318 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0166 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0472 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0962 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.0268 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.1280 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.1618 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.1896 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.0340 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.0406 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.0525 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.3106 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6641 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9345
============ Train epoch 135 ============
============ Train epoch 136 ============
============ Train epoch 137 ============
============ Train epoch 138 ============
============ Train epoch 139 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0289 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0792 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.0356 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0344 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.2467 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.1482 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.1481 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.0360 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0476 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.5054 | Train Acc: 0.8571
 Site-Real      | Train Loss: 0.0604 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.0355 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0260 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1300 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0536 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.1142 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.1197 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.2737 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.0394 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0588 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 0.9694 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 0.3123 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.4440 | Val  Acc: 0.9524
Average Valid Accuracy: 0.9524
============ Train epoch 140 ============
============ Train epoch 141 ============
============ Train epoch 142 ============
============ Train epoch 143 ============
============ Train epoch 144 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0390 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0442 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0431 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0096 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.2577 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 0.1802 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.1276 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.0367 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.0155 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.4421 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.0568 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.0427 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0486 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0504 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0606 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0342 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.2011 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.1342 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.2823 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.0421 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.0315 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.1101 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.2221 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7923 | Val  Acc: 0.8095
Average Valid Accuracy: 0.9286
============ Train epoch 145 ============
============ Train epoch 146 ============
============ Train epoch 147 ============
============ Train epoch 148 ============
============ Train epoch 149 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0180 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0590 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0258 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0176 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.1562 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.1518 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.0866 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0420 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.0272 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.5678 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.0312 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.0445 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.0093 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0306 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0657 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0363 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.1134 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.0761 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.3481 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.0140 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0573 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.1506 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 0.3102 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.4662 | Val  Acc: 0.9048
Average Valid Accuracy: 0.9484
============ Train epoch 150 ============
============ Train epoch 151 ============
============ Train epoch 152 ============
============ Train epoch 153 ============
============ Train epoch 154 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0152 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0687 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0428 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0209 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.2274 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.1448 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.1887 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.0215 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0154 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.5567 | Train Acc: 0.8095
 Site-Real      | Train Loss: 0.0338 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.0362 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.0151 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0493 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0629 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0251 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.0692 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.0973 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.2742 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.0115 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0444 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 0.9708 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 0.2673 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5973 | Val  Acc: 0.9048
Average Valid Accuracy: 0.9524
============ Train epoch 155 ============
============ Train epoch 156 ============
============ Train epoch 157 ============
============ Train epoch 158 ============
============ Train epoch 159 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0114 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0513 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0414 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0112 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.1822 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.1514 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 0.1317 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.0182 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0112 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.4009 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.0416 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.0372 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.0080 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0372 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0456 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0238 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.0732 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.1456 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.1996 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.0149 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0290 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.1067 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.3447 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6947 | Val  Acc: 0.8810
Average Valid Accuracy: 0.9405
============ Train epoch 160 ============
============ Train epoch 161 ============
============ Train epoch 162 ============
============ Train epoch 163 ============
============ Train epoch 164 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0140 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0401 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0487 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0143 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.2382 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 0.1244 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.1040 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0151 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0235 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.4441 | Train Acc: 0.8413
 Site-Real      | Train Loss: 0.0494 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.0304 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.0134 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0607 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0360 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0101 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.0915 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.0967 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.1903 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.0223 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0389 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.0342 | Val  Acc: 0.7619
 Site-Real      | Val  Loss: 0.2546 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4016 | Val  Acc: 0.9286
Average Valid Accuracy: 0.9603
 Best site-Clipart    | Epoch:32 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:32 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:32 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:32 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:32 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:32 | Val Acc: 0.9524
 Best site-Painting   | Epoch:32 | Val Acc: 1.0000
 Best site-Painting   | Epoch:32 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.7619
 Best site-Real       | Epoch:32 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:32 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 165 ============
============ Train epoch 166 ============
============ Train epoch 167 ============
============ Train epoch 168 ============
============ Train epoch 169 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0109 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0358 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0323 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0103 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.1797 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 0.1320 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.0798 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0476 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.0195 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.4373 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.0481 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.0319 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0117 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0405 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0643 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0262 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.0756 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.0997 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.1678 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.0130 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0280 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 0.9191 | Val  Acc: 0.7857
 Site-Real      | Val  Loss: 0.3471 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5300 | Val  Acc: 0.9048
Average Valid Accuracy: 0.9623
 Best site-Clipart    | Epoch:33 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:33 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:33 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:33 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:33 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:33 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:33 | Val Acc: 0.9762
 Best site-Painting   | Epoch:33 | Val Acc: 1.0000
 Best site-Painting   | Epoch:33 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:33 | Val Acc: 0.7857
 Best site-Real       | Epoch:33 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:33 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 170 ============
============ Train epoch 171 ============
============ Train epoch 172 ============
============ Train epoch 173 ============
============ Train epoch 174 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0081 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0297 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0479 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0099 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.1755 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.1468 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.0829 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.0201 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0126 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.4278 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.0445 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.0287 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0057 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0557 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0427 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0130 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.1205 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.0867 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.1953 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.0188 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0296 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 0.8836 | Val  Acc: 0.7857
 Site-Real      | Val  Loss: 0.2993 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6865 | Val  Acc: 0.8810
Average Valid Accuracy: 0.9583
============ Train epoch 175 ============
============ Train epoch 176 ============
============ Train epoch 177 ============
============ Train epoch 178 ============
============ Train epoch 179 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0131 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0522 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0351 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0120 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.1509 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.1660 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 0.0882 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.0300 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.0276 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.4177 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.0434 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.0240 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0070 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0399 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0610 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0142 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.0993 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.1115 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.2565 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.0179 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0208 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.1822 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.3322 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6612 | Val  Acc: 0.9048
Average Valid Accuracy: 0.9425
============ Train epoch 180 ============
============ Train epoch 181 ============
============ Train epoch 182 ============
============ Train epoch 183 ============
============ Train epoch 184 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0154 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0304 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0316 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0131 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.1708 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.0998 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 0.0578 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0149 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0126 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.3966 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.0475 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.0286 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0434 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0347 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0138 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.0813 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.0638 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.1860 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0142 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.2360 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.2315 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4309 | Val  Acc: 0.9286
Average Valid Accuracy: 0.9544
============ Train epoch 185 ============
============ Train epoch 186 ============
============ Train epoch 187 ============
============ Train epoch 188 ============
============ Train epoch 189 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0085 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0443 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0290 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0078 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.1581 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.1480 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.0783 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.0228 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0125 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.4116 | Train Acc: 0.8571
 Site-Real      | Train Loss: 0.0273 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.0166 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0073 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0378 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1168 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.0163 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.0636 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.1265 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.1603 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.0722 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.0207 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.0880 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.2686 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6235 | Val  Acc: 0.9048
Average Valid Accuracy: 0.9484
============ Train epoch 190 ============
============ Train epoch 191 ============
============ Train epoch 192 ============
============ Train epoch 193 ============
============ Train epoch 194 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0079 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0281 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0344 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0110 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.1551 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.1178 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.0838 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.0120 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0242 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.4065 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.0421 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.0278 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.0056 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0472 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0490 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0156 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.1166 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.0923 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.1963 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.0155 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0390 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.2170 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.2451 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.4761 | Val  Acc: 0.9048
Average Valid Accuracy: 0.9504
============ Train epoch 195 ============
============ Train epoch 196 ============
============ Train epoch 197 ============
============ Train epoch 198 ============
============ Train epoch 199 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[3, 6, 3, ]
 Site-Clipart   | Train Loss: 0.0113 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0403 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0347 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0126 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.1058 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 0.1135 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.1006 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.0141 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0213 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.3774 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.0292 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.0122 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0063 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0357 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0390 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0237 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.0919 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.0722 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.1405 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.0103 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.0201 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 0.9011 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 0.3199 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5300 | Val  Acc: 0.9048
Average Valid Accuracy: 0.9563
===2023-03-31 18:31:11===
===2023-03-31 18:31:13===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:33 | Test Acc: 0.8574
 Test site-Infograph | Epoch:33 | Test Acc: 0.5129
 Test site-Painting  | Epoch:33 | Test Acc: 0.8514
 Test site-QuickDraw | Epoch:33 | Test Acc: 0.5760
 Test site-Real      | Epoch:33 | Test Acc: 0.9104
 Test site-Sketch    | Epoch:33 | Test Acc: 0.8231
Average Test Accuracy: 0.7552
===2023-04-05 05:30:54===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
clients=[(5,)(6,)(1,)]
 Site-Clipart   | Train Loss: 2.2029 | Train Acc: 0.2222
 Site-Clipart   | Train Loss: 2.1788 | Train Acc: 0.2540
 Site-Clipart   | Train Loss: 2.1823 | Train Acc: 0.2063
 Site-Clipart   | Train Loss: 2.1746 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.2552 | Train Acc: 0.1905
 Site-Infograph | Train Loss: 2.2467 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1856 | Train Acc: 0.2381
 Site-Painting  | Train Loss: 2.2027 | Train Acc: 0.2540
 Site-Painting  | Train Loss: 2.2631 | Train Acc: 0.1270
 Site-QuickDraw | Train Loss: 2.3912 | Train Acc: 0.0635
 Site-Real      | Train Loss: 2.2078 | Train Acc: 0.2063
 Site-Sketch    | Train Loss: 2.1812 | Train Acc: 0.2698
 Site-Clipart   | Val  Loss: 2.1481 | Val  Acc: 0.1905
 Site-Clipart   | Val  Loss: 2.2028 | Val  Acc: 0.2143
 Site-Clipart   | Val  Loss: 2.1670 | Val  Acc: 0.2381
 Site-Clipart   | Val  Loss: 2.2276 | Val  Acc: 0.1429
 Site-Infograph | Val  Loss: 2.1951 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.2902 | Val  Acc: 0.0952
 Site-Infograph | Val  Loss: 2.1842 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 2.2268 | Val  Acc: 0.1429
 Site-Painting  | Val  Loss: 2.3101 | Val  Acc: 0.1190
 Site-QuickDraw | Val  Loss: 2.3751 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.2603 | Val  Acc: 0.1429
 Site-Sketch    | Val  Loss: 2.1912 | Val  Acc: 0.2143
Average Valid Accuracy: 0.1667
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1905
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2143
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2381
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1429
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:0 | Val Acc: 0.0952
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Painting   | Epoch:0 | Val Acc: 0.1429
 Best site-Painting   | Epoch:0 | Val Acc: 0.1190
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0476
 Best site-Real       | Epoch:0 | Val Acc: 0.1429
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 1 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(9,)(2,)(1,)]
 Site-Clipart   | Train Loss: 2.1478 | Train Acc: 0.2698
 Site-Clipart   | Train Loss: 2.0666 | Train Acc: 0.3651
 Site-Clipart   | Train Loss: 2.0247 | Train Acc: 0.3968
 Site-Clipart   | Train Loss: 2.0684 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 2.2235 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1784 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.2017 | Train Acc: 0.2857
 Site-Painting  | Train Loss: 2.0977 | Train Acc: 0.3016
 Site-Painting  | Train Loss: 2.1278 | Train Acc: 0.2381
 Site-QuickDraw | Train Loss: 2.3445 | Train Acc: 0.0794
 Site-Real      | Train Loss: 2.0510 | Train Acc: 0.3651
 Site-Sketch    | Train Loss: 2.0478 | Train Acc: 0.3968
 Site-Clipart   | Val  Loss: 2.0577 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 2.0705 | Val  Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.0659 | Val  Acc: 0.3571
 Site-Clipart   | Val  Loss: 2.1142 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1854 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.2272 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 2.2033 | Val  Acc: 0.1905
 Site-Painting  | Val  Loss: 2.0360 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 2.1826 | Val  Acc: 0.1667
 Site-QuickDraw | Val  Loss: 2.3010 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.1166 | Val  Acc: 0.4048
 Site-Sketch    | Val  Loss: 2.1112 | Val  Acc: 0.2619
Average Valid Accuracy: 0.2698
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2857
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3571
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1905
 Best site-Painting   | Epoch:1 | Val Acc: 0.3095
 Best site-Painting   | Epoch:1 | Val Acc: 0.1667
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0952
 Best site-Real       | Epoch:1 | Val Acc: 0.4048
 Best site-Sketch     | Epoch:1 | Val Acc: 0.2619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 2 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(9,)(2,)(1,)]
 Site-Clipart   | Train Loss: 2.0175 | Train Acc: 0.4444
 Site-Clipart   | Train Loss: 1.9985 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9392 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.9569 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 2.2002 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.1382 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 2.1374 | Train Acc: 0.2857
 Site-Painting  | Train Loss: 2.0192 | Train Acc: 0.3651
 Site-Painting  | Train Loss: 2.0258 | Train Acc: 0.3968
 Site-QuickDraw | Train Loss: 2.3169 | Train Acc: 0.0635
 Site-Real      | Train Loss: 1.9428 | Train Acc: 0.4444
 Site-Sketch    | Train Loss: 1.9168 | Train Acc: 0.5397
 Site-Clipart   | Val  Loss: 1.9034 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.9540 | Val  Acc: 0.4048
 Site-Clipart   | Val  Loss: 1.9827 | Val  Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.0385 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1385 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1539 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.2027 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.8928 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 2.1038 | Val  Acc: 0.2619
 Site-QuickDraw | Val  Loss: 2.2547 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0317 | Val  Acc: 0.3810
 Site-Sketch    | Val  Loss: 2.0591 | Val  Acc: 0.3095
Average Valid Accuracy: 0.3393
 Best site-Clipart    | Epoch:2 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:2 | Val Acc: 0.4048
 Best site-Clipart    | Epoch:2 | Val Acc: 0.4286
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2381
 Best site-Painting   | Epoch:2 | Val Acc: 0.4762
 Best site-Painting   | Epoch:2 | Val Acc: 0.2619
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1429
 Best site-Real       | Epoch:2 | Val Acc: 0.3810
 Best site-Sketch     | Epoch:2 | Val Acc: 0.3095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 3 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(9,)(2,)(1,)]
 Site-Clipart   | Train Loss: 1.9158 | Train Acc: 0.4286
 Site-Clipart   | Train Loss: 1.9492 | Train Acc: 0.3968
 Site-Clipart   | Train Loss: 1.8287 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.8742 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 2.1907 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.0823 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 2.0259 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.8818 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.8731 | Train Acc: 0.5079
 Site-QuickDraw | Train Loss: 2.2914 | Train Acc: 0.0952
 Site-Real      | Train Loss: 1.8118 | Train Acc: 0.5238
 Site-Sketch    | Train Loss: 1.8183 | Train Acc: 0.5397
 Site-Clipart   | Val  Loss: 1.7743 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.8271 | Val  Acc: 0.4048
 Site-Clipart   | Val  Loss: 1.8924 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.9282 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.0774 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.0769 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1473 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.7171 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.9853 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.2528 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.8797 | Val  Acc: 0.5476
 Site-Sketch    | Val  Loss: 1.9563 | Val  Acc: 0.3810
Average Valid Accuracy: 0.3869
 Best site-Clipart    | Epoch:3 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:3 | Val Acc: 0.4048
 Best site-Clipart    | Epoch:3 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2857
 Best site-Painting   | Epoch:3 | Val Acc: 0.5000
 Best site-Painting   | Epoch:3 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.1667
 Best site-Real       | Epoch:3 | Val Acc: 0.5476
 Best site-Sketch     | Epoch:3 | Val Acc: 0.3810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 4 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(9,)(2,)(1,)]
 Site-Clipart   | Train Loss: 1.7983 | Train Acc: 0.5397
 Site-Clipart   | Train Loss: 1.8285 | Train Acc: 0.5079
 Site-Clipart   | Train Loss: 1.6910 | Train Acc: 0.5556
 Site-Clipart   | Train Loss: 1.7294 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 2.1127 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 2.0336 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 2.0150 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.7926 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 1.7870 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 2.2510 | Train Acc: 0.1270
 Site-Real      | Train Loss: 1.6652 | Train Acc: 0.6349
 Site-Sketch    | Train Loss: 1.7169 | Train Acc: 0.6349
 Site-Clipart   | Val  Loss: 1.6927 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.7262 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.8019 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.8347 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.0406 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0360 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.0993 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 1.6256 | Val  Acc: 0.6429
 Site-Painting  | Val  Loss: 1.9241 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.2259 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 1.7584 | Val  Acc: 0.5476
 Site-Sketch    | Val  Loss: 1.8755 | Val  Acc: 0.4286
Average Valid Accuracy: 0.4365
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:4 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:4 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3095
 Best site-Painting   | Epoch:4 | Val Acc: 0.6429
 Best site-Painting   | Epoch:4 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.0952
 Best site-Real       | Epoch:4 | Val Acc: 0.5476
 Best site-Sketch     | Epoch:4 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 5 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(9,)(2,)(1,)]
 Site-Clipart   | Train Loss: 1.7265 | Train Acc: 0.4921
 Site-Clipart   | Train Loss: 1.7341 | Train Acc: 0.5397
 Site-Clipart   | Train Loss: 1.5929 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.6021 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 2.0730 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 1.9714 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.9729 | Train Acc: 0.3968
 Site-Painting  | Train Loss: 1.6565 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 1.6368 | Train Acc: 0.6032
 Site-QuickDraw | Train Loss: 2.1991 | Train Acc: 0.2222
 Site-Real      | Train Loss: 1.5739 | Train Acc: 0.6508
 Site-Sketch    | Train Loss: 1.5849 | Train Acc: 0.6825
 Site-Clipart   | Val  Loss: 1.5226 | Val  Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.5791 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.7275 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.7776 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.9517 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.0333 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.0629 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.5506 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 1.8052 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 2.1570 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.6629 | Val  Acc: 0.5714
 Site-Sketch    | Val  Loss: 1.7864 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4861
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6429
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:5 | Val Acc: 0.2857
 Best site-Painting   | Epoch:5 | Val Acc: 0.5952
 Best site-Painting   | Epoch:5 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.1905
 Best site-Real       | Epoch:5 | Val Acc: 0.5714
 Best site-Sketch     | Epoch:5 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 6 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(9,)(2,)(1,)]
 Site-Clipart   | Train Loss: 1.6162 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.6408 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 1.5017 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.5226 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 2.0859 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.9170 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.8798 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.5425 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 1.5429 | Train Acc: 0.6667
 Site-QuickDraw | Train Loss: 2.2206 | Train Acc: 0.1746
 Site-Real      | Train Loss: 1.4412 | Train Acc: 0.6984
 Site-Sketch    | Train Loss: 1.4591 | Train Acc: 0.6984
 Site-Clipart   | Val  Loss: 1.4350 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.4821 | Val  Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.6936 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.6823 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.9118 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.8922 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.0165 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.4391 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 1.6606 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 2.1831 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.5285 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.6993 | Val  Acc: 0.5714
Average Valid Accuracy: 0.5238
 Best site-Clipart    | Epoch:6 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:6 | Val Acc: 0.6429
 Best site-Clipart    | Epoch:6 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:6 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3333
 Best site-Painting   | Epoch:6 | Val Acc: 0.5714
 Best site-Painting   | Epoch:6 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.1667
 Best site-Real       | Epoch:6 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:6 | Val Acc: 0.5714
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 7 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(9,)(2,)(1,)]
 Site-Clipart   | Train Loss: 1.5326 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 1.5993 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.4031 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.3814 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 2.0021 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.8374 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.7884 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 1.4551 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 1.4495 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 2.1216 | Train Acc: 0.2222
 Site-Real      | Train Loss: 1.3181 | Train Acc: 0.7460
 Site-Sketch    | Train Loss: 1.3942 | Train Acc: 0.6984
 Site-Clipart   | Val  Loss: 1.3346 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.3804 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.5082 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.5186 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.8561 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.8320 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.0327 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 1.2934 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 1.6052 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 2.1171 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.3901 | Val  Acc: 0.7143
 Site-Sketch    | Val  Loss: 1.5583 | Val  Acc: 0.6190
Average Valid Accuracy: 0.5794
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:7 | Val Acc: 0.2619
 Best site-Painting   | Epoch:7 | Val Acc: 0.7857
 Best site-Painting   | Epoch:7 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.1667
 Best site-Real       | Epoch:7 | Val Acc: 0.7143
 Best site-Sketch     | Epoch:7 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 8 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(9,)(2,)(1,)]
 Site-Clipart   | Train Loss: 1.4467 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.5032 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.2706 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 1.2657 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 1.9411 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.7910 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.7422 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 1.3573 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 1.3584 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.0491 | Train Acc: 0.3175
 Site-Real      | Train Loss: 1.2255 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 1.3095 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 1.2395 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.2612 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.4891 | Val  Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.5190 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.8230 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.7525 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.9383 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 1.2444 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 1.5704 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 2.0371 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.3378 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.5554 | Val  Acc: 0.6429
Average Valid Accuracy: 0.6111
 Best site-Clipart    | Epoch:8 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:8 | Val Acc: 0.6429
 Best site-Clipart    | Epoch:8 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4286
 Best site-Painting   | Epoch:8 | Val Acc: 0.7619
 Best site-Painting   | Epoch:8 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3095
 Best site-Real       | Epoch:8 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:8 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 9 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 1.3317 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.4202 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.2027 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.1878 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.8894 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.7105 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.6819 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 1.2860 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 1.2317 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 2.0572 | Train Acc: 0.2540
 Site-Real      | Train Loss: 1.1115 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.2683 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 1.0920 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.1579 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.4172 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.3959 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.6937 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7336 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 1.9153 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 1.0842 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 1.4143 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 2.0015 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.2435 | Val  Acc: 0.7143
 Site-Sketch    | Val  Loss: 1.3973 | Val  Acc: 0.6667
Average Valid Accuracy: 0.6270
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:9 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:9 | Val Acc: 0.3571
 Best site-Painting   | Epoch:9 | Val Acc: 0.6905
 Best site-Painting   | Epoch:9 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.3333
 Best site-Real       | Epoch:9 | Val Acc: 0.7143
 Best site-Sketch     | Epoch:9 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 10 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 1.2296 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.3251 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.0944 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 1.1614 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.8565 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.7345 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.6836 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 1.1659 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 1.1575 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 2.0046 | Train Acc: 0.2698
 Site-Real      | Train Loss: 1.0290 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 1.1592 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.0714 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.1356 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.3101 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.3294 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.6309 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.6426 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.9131 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.0741 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 1.3244 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.9699 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.1056 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.4779 | Val  Acc: 0.5952
Average Valid Accuracy: 0.6627
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:10 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:10 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:10 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:10 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:10 | Val Acc: 0.2857
 Best site-Painting   | Epoch:10 | Val Acc: 0.8333
 Best site-Painting   | Epoch:10 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.3571
 Best site-Real       | Epoch:10 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:10 | Val Acc: 0.5952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 11 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 1.1966 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.2776 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.0283 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.9908 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.8718 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.6314 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.5571 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 1.1952 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 1.0420 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 1.9404 | Train Acc: 0.3968
 Site-Real      | Train Loss: 0.9522 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.0325 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.9327 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.9980 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.2897 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.3007 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.6366 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.5410 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8189 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.9545 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 1.3025 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.9007 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.0249 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.3543 | Val  Acc: 0.6905
Average Valid Accuracy: 0.6806
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:11 | Val Acc: 0.4048
 Best site-Painting   | Epoch:11 | Val Acc: 0.9048
 Best site-Painting   | Epoch:11 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.3571
 Best site-Real       | Epoch:11 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:11 | Val Acc: 0.6905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 12 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 1.1277 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.1877 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 0.9862 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.8961 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.7617 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.5512 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.5520 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 1.0308 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 1.0110 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 1.9755 | Train Acc: 0.2857
 Site-Real      | Train Loss: 0.9219 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.0101 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 0.9224 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.8850 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 1.1491 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.2345 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4403 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.5106 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.7797 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 0.8469 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 1.1162 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.9377 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.0118 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.2818 | Val  Acc: 0.6429
Average Valid Accuracy: 0.6925
 Best site-Clipart    | Epoch:12 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:12 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:12 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:12 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:12 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:12 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:12 | Val Acc: 0.3571
 Best site-Painting   | Epoch:12 | Val Acc: 0.9048
 Best site-Painting   | Epoch:12 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.3095
 Best site-Real       | Epoch:12 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:12 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 13 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 1.0457 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.0454 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.8696 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.8643 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.7326 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.5211 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.4457 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.9411 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.9119 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 1.8476 | Train Acc: 0.4444
 Site-Real      | Train Loss: 0.7895 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.8870 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.8400 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.9077 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 1.2140 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.1464 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5048 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.4363 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.8564 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 0.7925 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 1.0897 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.9038 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.8660 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.1763 | Val  Acc: 0.7381
Average Valid Accuracy: 0.7004
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:13 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:13 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:13 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:13 | Val Acc: 0.3333
 Best site-Painting   | Epoch:13 | Val Acc: 0.8810
 Best site-Painting   | Epoch:13 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.3333
 Best site-Real       | Epoch:13 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:13 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 14 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 1.0294 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.0354 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.8014 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.7918 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.7151 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.4841 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.3186 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.9047 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.8727 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 1.9230 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.7373 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.8880 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7682 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.7714 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 1.0797 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.0330 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4402 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.3759 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.6237 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.6937 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 1.0751 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.9825 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.7999 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.1455 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7381
 Best site-Clipart    | Epoch:14 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:14 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:14 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:14 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:14 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:14 | Val Acc: 0.5000
 Best site-Painting   | Epoch:14 | Val Acc: 0.9524
 Best site-Painting   | Epoch:14 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.2857
 Best site-Real       | Epoch:14 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:14 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 15 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.9424 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.9714 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.7544 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.7504 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.7386 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.3721 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.3837 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.8457 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.8064 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.8322 | Train Acc: 0.4286
 Site-Real      | Train Loss: 0.6430 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.8548 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6662 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.7308 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 1.0415 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.0188 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.5203 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.3772 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.6214 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.6900 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.9904 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.7941 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.7615 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.0899 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7440
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:15 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:15 | Val Acc: 0.4524
 Best site-Painting   | Epoch:15 | Val Acc: 0.9048
 Best site-Painting   | Epoch:15 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.4286
 Best site-Real       | Epoch:15 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:15 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 16 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.8859 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.8693 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.6719 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.6740 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.6636 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.3864 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.3178 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.7291 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.7487 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.7657 | Train Acc: 0.4444
 Site-Real      | Train Loss: 0.6453 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.7356 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.6575 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.7458 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.8639 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.9665 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.4339 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.3847 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6429 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.6011 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.8618 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.8433 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.7371 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.1327 | Val  Acc: 0.7381
Average Valid Accuracy: 0.7500
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:16 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:16 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:16 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:16 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:16 | Val Acc: 0.4762
 Best site-Painting   | Epoch:16 | Val Acc: 0.9286
 Best site-Painting   | Epoch:16 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.3810
 Best site-Real       | Epoch:16 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:16 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 17 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.8143 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.8754 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.6992 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.6673 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.6110 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.3517 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 1.3135 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.7193 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.7275 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.7699 | Train Acc: 0.4603
 Site-Real      | Train Loss: 0.5711 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.7316 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.6359 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.6379 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.9344 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.9045 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3434 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.2520 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.6037 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 0.6013 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.8163 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.7187 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.6963 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.1299 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7520
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:17 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:17 | Val Acc: 0.3571
 Best site-Painting   | Epoch:17 | Val Acc: 0.9048
 Best site-Painting   | Epoch:17 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.4524
 Best site-Real       | Epoch:17 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:17 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 18 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.8161 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.7994 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.6282 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.6060 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.5092 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.2403 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.2343 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.7230 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.6769 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.7258 | Train Acc: 0.4127
 Site-Real      | Train Loss: 0.5439 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.7316 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.5417 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.5578 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.8106 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8365 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.3588 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.1948 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.5861 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.5262 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.7318 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.8729 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.6464 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.9953 | Val  Acc: 0.8095
Average Valid Accuracy: 0.7698
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:18 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:18 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:18 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:18 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:18 | Val Acc: 0.4524
 Best site-Painting   | Epoch:18 | Val Acc: 0.9524
 Best site-Painting   | Epoch:18 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.2857
 Best site-Real       | Epoch:18 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:18 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 19 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.6931 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.7500 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.6155 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5634 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.4941 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.3184 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.1738 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.6050 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.6080 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.6743 | Train Acc: 0.5079
 Site-Real      | Train Loss: 0.5050 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.6204 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.5299 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5471 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.7933 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7443 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.2459 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1773 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.4602 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.5355 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.7171 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.6183 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.5511 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.9725 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7956
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:19 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:19 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:19 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:19 | Val Acc: 0.5476
 Best site-Painting   | Epoch:19 | Val Acc: 0.9286
 Best site-Painting   | Epoch:19 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.4286
 Best site-Real       | Epoch:19 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:19 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
 Test site-Clipart   | Epoch:19 | Test Acc: 0.7852
 Test site-Infograph | Epoch:19 | Test Acc: 0.4521
 Test site-Painting  | Epoch:19 | Test Acc: 0.8045
 Test site-QuickDraw | Epoch:19 | Test Acc: 0.4500
 Test site-Real      | Epoch:19 | Test Acc: 0.9030
 Test site-Sketch    | Epoch:19 | Test Acc: 0.7509
Average Test Accuracy: 0.6909
============ Train epoch 20 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.6567 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.7386 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.5514 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.5038 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.4760 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1955 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 1.1370 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.5912 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.5313 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.5883 | Train Acc: 0.5238
 Site-Real      | Train Loss: 0.4637 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.5966 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.4694 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.5392 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.7398 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7012 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.2356 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.0896 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3795 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.5174 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.6250 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.7363 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.5460 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.9704 | Val  Acc: 0.8095
Average Valid Accuracy: 0.7956
============ Train epoch 21 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.5684 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.6875 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.5213 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4510 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.3799 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1385 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 1.0582 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.5794 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.5435 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.5545 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.3695 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.6421 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.4359 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.4462 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6737 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7051 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.2626 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.1593 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.4143 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4587 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.6460 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.7115 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4778 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.8615 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7937
============ Train epoch 22 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.5411 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.6513 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4730 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4362 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.3817 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.0991 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.0039 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.5055 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.5200 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.6047 | Train Acc: 0.4762
 Site-Real      | Train Loss: 0.4048 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.6155 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.4647 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.4572 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.7493 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6127 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.0952 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.9963 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3824 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.4782 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.6292 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.6249 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.5344 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.9161 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8214
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:22 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:22 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:22 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:22 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:22 | Val Acc: 0.5714
 Best site-Painting   | Epoch:22 | Val Acc: 0.8810
 Best site-Painting   | Epoch:22 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.4762
 Best site-Real       | Epoch:22 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:22 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 23 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.5706 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.6663 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4085 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3992 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.3684 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.0640 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 1.1027 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.5189 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.4782 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.3950 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.3442 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.5287 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4156 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4314 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.6433 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6208 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.1072 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0424 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.3437 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.3741 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.5784 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.4973 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.4990 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.8057 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8214
============ Train epoch 24 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.4607 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.5789 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.3692 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3455 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.3039 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.0434 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.9538 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.4288 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.4475 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.4393 | Train Acc: 0.6190
 Site-Real      | Train Loss: 0.4342 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.5153 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.3425 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4221 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5918 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.5639 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.0312 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 0.9302 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.3863 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.3968 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.5123 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.4277 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.4850 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8302 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8214
============ Train epoch 25 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.4840 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.5878 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3987 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3457 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.2461 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.0847 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.9722 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.4487 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.4975 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.3818 | Train Acc: 0.6349
 Site-Real      | Train Loss: 0.3450 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.4602 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.3425 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3565 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.5299 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4805 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 1.2873 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0341 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3513 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.3606 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.5342 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.5781 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.4070 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.8106 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8056
============ Train epoch 26 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.3925 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4926 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3819 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2815 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.2534 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 0.9192 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.9332 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.4139 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.4584 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.4364 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.3426 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.4055 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.2559 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3213 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.5370 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5071 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.0169 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.9688 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1723 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.3218 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5893 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.5152 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.4619 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8304 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8353
 Best site-Clipart    | Epoch:26 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:26 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:26 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:26 | Val Acc: 0.6667
 Best site-Painting   | Epoch:26 | Val Acc: 1.0000
 Best site-Painting   | Epoch:26 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.4524
 Best site-Real       | Epoch:26 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:26 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 27 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.4070 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4956 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3572 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2580 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.1632 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.9486 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.9908 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.3603 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.3428 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.3326 | Train Acc: 0.6032
 Site-Real      | Train Loss: 0.3022 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.4435 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.2749 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3306 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.5992 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4681 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.8962 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.9594 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.1099 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.2801 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.4408 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.4088 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.3455 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.8017 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8671
 Best site-Clipart    | Epoch:27 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:27 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:27 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:27 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:27 | Val Acc: 0.6905
 Best site-Painting   | Epoch:27 | Val Acc: 0.9762
 Best site-Painting   | Epoch:27 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.5476
 Best site-Real       | Epoch:27 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:27 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 28 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.3375 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.4817 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3289 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2462 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.1782 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.8990 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 0.9096 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.3701 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.3016 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.3666 | Train Acc: 0.6032
 Site-Real      | Train Loss: 0.2458 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3865 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.2360 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3281 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5512 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4201 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 1.0084 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 0.8755 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.1769 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.2854 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.4541 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.4935 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.3237 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7785 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8433
============ Train epoch 29 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.3480 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4206 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3068 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2729 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.1592 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.9195 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.9513 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.3055 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.3007 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.1867 | Train Acc: 0.6984
 Site-Real      | Train Loss: 0.3106 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.3202 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2294 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2874 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4439 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4689 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.8008 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.8277 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.0953 | Val  Acc: 0.6429
 Site-Painting  | Val  Loss: 0.2572 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3901 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.4308 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3128 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7678 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8591
============ Train epoch 30 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.3494 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4645 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2829 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2713 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.1540 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.8764 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 0.7852 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.3149 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2892 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.3087 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.2283 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3236 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2422 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2669 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.5461 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3560 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.7846 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.7636 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.1425 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.3283 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.3745 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.5099 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.2740 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.7234 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8552
============ Train epoch 31 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.3033 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4398 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2417 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2103 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.0407 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.7932 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 0.8904 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.2898 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.2991 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.3735 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.2462 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3189 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.1935 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2524 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3528 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3856 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.8178 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 0.7504 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.1476 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.2542 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3967 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.3478 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.2997 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7332 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8452
============ Train epoch 32 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.3764 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4263 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.2546 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1931 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.0841 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.8174 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 0.7550 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.2657 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2970 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.2759 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.2217 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2451 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.2152 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2347 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3919 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4027 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.8265 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.6668 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.9793 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 0.2489 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3765 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.5443 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.3404 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6939 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8710
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:32 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:32 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:32 | Val Acc: 0.7381
 Best site-Painting   | Epoch:32 | Val Acc: 1.0000
 Best site-Painting   | Epoch:32 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.4524
 Best site-Real       | Epoch:32 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:32 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 33 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.3305 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4172 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2586 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1970 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.0053 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.7650 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 0.7927 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.2641 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.3053 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.1746 | Train Acc: 0.6984
 Site-Real      | Train Loss: 0.1826 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2702 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.2018 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2403 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4269 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3742 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.7646 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.6804 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.0127 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.2294 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.4127 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.3284 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.2822 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6418 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8611
============ Train epoch 34 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.2694 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3264 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2091 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1609 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 0.9319 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 0.7359 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 0.7347 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.2279 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.2615 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 1.1231 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.2518 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3146 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.1270 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2477 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3404 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3478 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.7573 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.7035 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.8700 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.1566 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3761 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.4141 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.3859 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.5390 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8690
============ Train epoch 35 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.2211 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.4071 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1885 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1417 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.9568 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 0.7183 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 0.7519 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.2427 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.2411 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.2001 | Train Acc: 0.6984
 Site-Real      | Train Loss: 0.2088 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.2424 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.1599 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1934 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3321 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3011 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.7335 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.6213 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.9356 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.1924 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3431 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.5184 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.2522 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6772 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8591
============ Train epoch 36 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.2672 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2841 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2405 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1406 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.9985 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.6967 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 0.7237 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.1943 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.2249 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.0887 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.2417 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.2118 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.1377 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2060 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3181 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2905 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.8654 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.6552 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.8917 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.1894 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.2675 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.3259 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.3100 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6452 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8790
 Best site-Clipart    | Epoch:36 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:36 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:36 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:36 | Val Acc: 0.7619
 Best site-Painting   | Epoch:36 | Val Acc: 0.9762
 Best site-Painting   | Epoch:36 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:36 | Val Acc: 0.5238
 Best site-Real       | Epoch:36 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:36 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 37 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.2201 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2912 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1977 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1491 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.8390 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 0.6718 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 0.5924 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.2418 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.2470 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.0331 | Train Acc: 0.7143
 Site-Real      | Train Loss: 0.1686 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.2105 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.1668 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2035 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3046 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2610 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.6284 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.5806 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.8281 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 0.1534 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2468 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.3494 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.2821 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6481 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8988
 Best site-Clipart    | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:37 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:37 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:37 | Val Acc: 0.8095
 Best site-Painting   | Epoch:37 | Val Acc: 1.0000
 Best site-Painting   | Epoch:37 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:37 | Val Acc: 0.5476
 Best site-Real       | Epoch:37 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:37 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 38 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.2407 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3313 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2236 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1331 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.8632 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 0.6563 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 0.7766 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.1816 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.2052 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.9926 | Train Acc: 0.7619
 Site-Real      | Train Loss: 0.1813 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.2770 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.1208 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2179 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3361 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2865 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.6142 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.5827 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.8480 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.1540 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2646 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.1839 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.2187 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.6660 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8889
============ Train epoch 39 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.2038 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3056 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2142 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1493 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 0.8409 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 0.6321 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 0.6000 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.2172 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.1907 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.9715 | Train Acc: 0.7778
 Site-Real      | Train Loss: 0.1610 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.1817 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1065 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1583 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2984 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2367 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.5902 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.5974 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.7507 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 0.1453 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2761 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.2099 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.2482 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6761 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9127
 Best site-Clipart    | Epoch:39 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:39 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:39 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:39 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:39 | Val Acc: 0.8571
 Best site-Painting   | Epoch:39 | Val Acc: 1.0000
 Best site-Painting   | Epoch:39 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.6190
 Best site-Real       | Epoch:39 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:39 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.8384
 Test site-Infograph | Epoch:39 | Test Acc: 0.4886
 Test site-Painting  | Epoch:39 | Test Acc: 0.8498
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.5230
 Test site-Real      | Epoch:39 | Test Acc: 0.9178
 Test site-Sketch    | Epoch:39 | Test Acc: 0.7798
Average Test Accuracy: 0.7329
============ Train epoch 40 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.1866 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2742 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1894 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0985 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.9193 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.6073 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 0.5586 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.2106 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2251 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.0616 | Train Acc: 0.7143
 Site-Real      | Train Loss: 0.1968 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.2213 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.1093 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1668 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2864 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2347 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.6406 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.4975 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.7371 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 0.1362 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2088 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.2293 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.2679 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.7928 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8968
============ Train epoch 41 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.1958 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2237 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1640 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1109 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.7659 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 0.6030 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 0.5814 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.2082 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2018 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.0396 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.1773 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.1842 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1140 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1595 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2336 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1884 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.5497 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.4665 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.7851 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 0.1118 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2644 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.2827 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.2597 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6301 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8988
============ Train epoch 42 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.1635 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2665 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1498 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0940 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.9057 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.5085 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 0.6616 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.1790 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1636 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.9463 | Train Acc: 0.7619
 Site-Real      | Train Loss: 0.1354 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.1678 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.1029 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1748 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2603 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2121 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.6479 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.5694 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.7649 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.1073 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1790 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.2531 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.2535 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5895 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8948
============ Train epoch 43 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.1602 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2613 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1672 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0946 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.7747 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 0.5357 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 0.5011 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.1355 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1488 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.9119 | Train Acc: 0.7937
 Site-Real      | Train Loss: 0.1371 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.1356 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0930 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1601 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2493 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2177 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.5739 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.5060 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.7571 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 0.1414 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.2027 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.1666 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.2343 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5457 | Val  Acc: 0.8810
Average Valid Accuracy: 0.9048
============ Train epoch 44 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.1535 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2519 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1463 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1007 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.7551 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 0.5639 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 0.4964 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.1652 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1420 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.9420 | Train Acc: 0.7460
 Site-Real      | Train Loss: 0.1923 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.2408 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.0716 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1384 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2388 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2069 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.4779 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.4551 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.7124 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 0.0871 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1818 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.2255 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.2572 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6008 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9147
 Best site-Clipart    | Epoch:44 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:44 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:44 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:44 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:44 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:44 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:44 | Val Acc: 0.8095
 Best site-Painting   | Epoch:44 | Val Acc: 1.0000
 Best site-Painting   | Epoch:44 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:44 | Val Acc: 0.5714
 Best site-Real       | Epoch:44 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:44 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 45 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.1260 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1906 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1489 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0829 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.7108 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 0.5257 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 0.4586 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.1401 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1261 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.9372 | Train Acc: 0.7143
 Site-Real      | Train Loss: 0.1061 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.1119 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0864 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1645 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2178 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2000 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.4451 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.5014 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.6861 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 0.0875 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1746 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.1574 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.3071 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6665 | Val  Acc: 0.9048
Average Valid Accuracy: 0.9167
 Best site-Clipart    | Epoch:45 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:45 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:45 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:45 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:45 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:45 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:45 | Val Acc: 0.8095
 Best site-Painting   | Epoch:45 | Val Acc: 1.0000
 Best site-Painting   | Epoch:45 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:45 | Val Acc: 0.5714
 Best site-Real       | Epoch:45 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:45 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 46 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.1054 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1861 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1337 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0856 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.7717 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 0.5828 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 0.4788 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.1389 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1338 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.9702 | Train Acc: 0.7302
 Site-Real      | Train Loss: 0.1539 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.1554 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.0830 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1533 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2409 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1534 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.5675 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.5975 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.7835 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.0846 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1506 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.2679 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.3072 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5222 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8929
============ Train epoch 47 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.1250 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2438 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1273 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.0896 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.6364 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 0.4945 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 0.4618 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.1286 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.1156 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.9622 | Train Acc: 0.7460
 Site-Real      | Train Loss: 0.1341 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.1519 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.0789 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1196 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1794 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1722 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.4688 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.3558 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.6377 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 0.1040 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1497 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.2856 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.2950 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5006 | Val  Acc: 0.9048
Average Valid Accuracy: 0.9206
 Best site-Clipart    | Epoch:47 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:47 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:47 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:47 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:47 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:47 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:47 | Val Acc: 0.8333
 Best site-Painting   | Epoch:47 | Val Acc: 1.0000
 Best site-Painting   | Epoch:47 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:47 | Val Acc: 0.5476
 Best site-Real       | Epoch:47 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:47 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_1/FedPrompt...
============ Train epoch 48 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.1368 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1850 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1401 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.0718 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.5908 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 0.4903 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 0.5311 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.1572 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1395 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.8248 | Train Acc: 0.7619
 Site-Real      | Train Loss: 0.1024 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.1505 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.0899 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1134 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2322 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1667 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.4371 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.3927 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.6738 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 0.1046 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.1550 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.2455 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.2092 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5538 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9127
============ Train epoch 49 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(8,)(2,)(2,)]
 Site-Clipart   | Train Loss: 0.1297 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2013 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1325 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.0772 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.5807 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 0.4179 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.4044 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.1287 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1157 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.9063 | Train Acc: 0.7143
 Site-Real      | Train Loss: 0.0772 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.1339 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.0801 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1724 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2034 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1518 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.5170 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.4433 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.6353 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 0.1003 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.1560 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.1498 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.2604 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6331 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9048
===2023-04-05 06:27:45===
===2023-04-05 06:27:46===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:47 | Test Acc: 0.8536
 Test site-Infograph | Epoch:47 | Test Acc: 0.4992
 Test site-Painting  | Epoch:47 | Test Acc: 0.8320
 Test site-QuickDraw | Epoch:47 | Test Acc: 0.4900
 Test site-Real      | Epoch:47 | Test Acc: 0.9154
 Test site-Sketch    | Epoch:47 | Test Acc: 0.7780
Average Test Accuracy: 0.7280
