===2023-06-09 20:20:34===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                  | Train Loss: 2.1472 | Train Acc: 0.2348
 Site-Clipart                  | Train Loss: 2.1072 | Train Acc: 0.2857
 Site-Clipart                  | Train Loss: 2.1726 | Train Acc: 0.2133
 Site-Clipart                  | Train Loss: 2.1178 | Train Acc: 0.2500
 Site-Clipart                  | Train Loss: 2.1511 | Train Acc: 0.2421
 Site-Real                     | Train Loss: 2.1434 | Train Acc: 0.2063
 Site-Real                     | Train Loss: 2.1487 | Train Acc: 0.3107
 Site-Real                     | Train Loss: 2.1278 | Train Acc: 0.2379
 Site-Real                     | Train Loss: 2.1726 | Train Acc: 0.1954
 Site-Painting                 | Train Loss: 2.1546 | Train Acc: 0.2517
 Site-Painting                 | Train Loss: 2.2100 | Train Acc: 0.2961
 Site-Painting                 | Train Loss: 2.1474 | Train Acc: 0.2457
 Site-Sketch                   | Train Loss: 2.1001 | Train Acc: 0.2984
 Site-Sketch                   | Train Loss: 2.1286 | Train Acc: 0.2846
 Site-QuickDraw                | Train Loss: 2.2235 | Train Acc: 0.1651
 Site-Infograph                | Train Loss: 2.2591 | Train Acc: 0.1709
 Site-Clipart                   (1) | Val  Loss: 2.1961 | Val  Acc: 0.1974
 Site-Clipart                   (1) | Val  Loss: 2.1430 | Val  Acc: 0.2430
 Site-Clipart                   (1) | Val  Loss: 2.1280 | Val  Acc: 0.2533
 Site-Clipart                   (1) | Val  Loss: 2.1156 | Val  Acc: 0.2381
 Site-Clipart                   (1) | Val  Loss: 2.1535 | Val  Acc: 0.2237
 Site-Real                      (0) | Val  Loss: 2.1279 | Val  Acc: 0.2381
 Site-Real                      (0) | Val  Loss: 2.1519 | Val  Acc: 0.2034
 Site-Real                      (0) | Val  Loss: 2.1180 | Val  Acc: 0.2424
 Site-Real                      (0) | Val  Loss: 2.1373 | Val  Acc: 0.2554
 Site-Painting                  (5) | Val  Loss: 2.1100 | Val  Acc: 0.2857
 Site-Painting                  (5) | Val  Loss: 2.0773 | Val  Acc: 0.3212
 Site-Painting                  (5) | Val  Loss: 2.1483 | Val  Acc: 0.2812
 Site-Sketch                    (4) | Val  Loss: 2.0928 | Val  Acc: 0.3228
 Site-Sketch                    (4) | Val  Loss: 2.1263 | Val  Acc: 0.2303
 Site-QuickDraw                 (2) | Val  Loss: 2.2590 | Val  Acc: 0.1881
 Site-Infograph                 (3) | Val  Loss: 2.2608 | Val  Acc: 0.1474
Average Valid Accuracy: 0.2420
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.1974
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2430
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2533
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2381
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2237
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.2381
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.2034
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.2424
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.2554
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.2857
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3212
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.2812
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3228
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.2303
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1881
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.1474
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 1 ============
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                  | Train Loss: 1.9757 | Train Acc: 0.4348
 Site-Clipart                  | Train Loss: 1.9382 | Train Acc: 0.4472
 Site-Clipart                  | Train Loss: 2.0118 | Train Acc: 0.3822
 Site-Clipart                  | Train Loss: 1.9423 | Train Acc: 0.4146
 Site-Clipart                  | Train Loss: 1.9822 | Train Acc: 0.4434
 Site-Real                     | Train Loss: 1.9203 | Train Acc: 0.5397
 Site-Real                     | Train Loss: 1.8920 | Train Acc: 0.5028
 Site-Real                     | Train Loss: 1.8556 | Train Acc: 0.5363
 Site-Real                     | Train Loss: 1.9364 | Train Acc: 0.4770
 Site-Painting                 | Train Loss: 1.9131 | Train Acc: 0.4490
 Site-Painting                 | Train Loss: 1.9733 | Train Acc: 0.4078
 Site-Painting                 | Train Loss: 1.9256 | Train Acc: 0.4740
 Site-Sketch                   | Train Loss: 1.9159 | Train Acc: 0.5079
 Site-Sketch                   | Train Loss: 1.9190 | Train Acc: 0.4569
 Site-QuickDraw                | Train Loss: 2.1639 | Train Acc: 0.3180
 Site-Infograph                | Train Loss: 2.1525 | Train Acc: 0.2607
 Site-Clipart                   (0) | Val  Loss: 1.9374 | Val  Acc: 0.4868
 Site-Clipart                   (0) | Val  Loss: 1.9534 | Val  Acc: 0.4019
 Site-Clipart                   (0) | Val  Loss: 1.9523 | Val  Acc: 0.4733
 Site-Clipart                   (0) | Val  Loss: 1.9249 | Val  Acc: 0.4476
 Site-Clipart                   (0) | Val  Loss: 1.9980 | Val  Acc: 0.3831
 Site-Real                      (2) | Val  Loss: 1.8642 | Val  Acc: 0.4881
 Site-Real                      (2) | Val  Loss: 1.9085 | Val  Acc: 0.4831
 Site-Real                      (2) | Val  Loss: 1.8275 | Val  Acc: 0.5758
 Site-Real                      (2) | Val  Loss: 1.8710 | Val  Acc: 0.5541
 Site-Painting                  (3) | Val  Loss: 1.9016 | Val  Acc: 0.5000
 Site-Painting                  (3) | Val  Loss: 1.8792 | Val  Acc: 0.5036
 Site-Painting                  (3) | Val  Loss: 1.9336 | Val  Acc: 0.4896
 Site-Sketch                    (5) | Val  Loss: 1.9266 | Val  Acc: 0.5118
 Site-Sketch                    (5) | Val  Loss: 1.9312 | Val  Acc: 0.4270
 Site-QuickDraw                 (1) | Val  Loss: 2.1852 | Val  Acc: 0.2890
 Site-Infograph                 (4) | Val  Loss: 2.1420 | Val  Acc: 0.3077
Average Valid Accuracy: 0.4577
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4868
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4019
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4733
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4476
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.3831
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.4881
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.4831
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.5758
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.5541
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5000
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5036
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.4896
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5118
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4270
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.2890
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.3077
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 2 ============
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                  | Train Loss: 1.7930 | Train Acc: 0.5304
 Site-Clipart                  | Train Loss: 1.7354 | Train Acc: 0.5404
 Site-Clipart                  | Train Loss: 1.8160 | Train Acc: 0.5022
 Site-Clipart                  | Train Loss: 1.7455 | Train Acc: 0.5633
 Site-Clipart                  | Train Loss: 1.7803 | Train Acc: 0.5294
 Site-Real                     | Train Loss: 1.6564 | Train Acc: 0.6984
 Site-Real                     | Train Loss: 1.6183 | Train Acc: 0.6836
 Site-Real                     | Train Loss: 1.5423 | Train Acc: 0.7097
 Site-Real                     | Train Loss: 1.6844 | Train Acc: 0.6236
 Site-Painting                 | Train Loss: 1.6463 | Train Acc: 0.5850
 Site-Painting                 | Train Loss: 1.6801 | Train Acc: 0.5825
 Site-Painting                 | Train Loss: 1.6693 | Train Acc: 0.6263
 Site-Sketch                   | Train Loss: 1.6979 | Train Acc: 0.5812
 Site-Sketch                   | Train Loss: 1.7367 | Train Acc: 0.5955
 Site-QuickDraw                | Train Loss: 2.1014 | Train Acc: 0.3456
 Site-Infograph                | Train Loss: 2.0374 | Train Acc: 0.3376
 Site-Clipart                   (0) | Val  Loss: 1.7270 | Val  Acc: 0.5132
 Site-Clipart                   (0) | Val  Loss: 1.7433 | Val  Acc: 0.5607
 Site-Clipart                   (0) | Val  Loss: 1.7718 | Val  Acc: 0.5733
 Site-Clipart                   (0) | Val  Loss: 1.6963 | Val  Acc: 0.5810
 Site-Clipart                   (0) | Val  Loss: 1.8072 | Val  Acc: 0.4949
 Site-Real                      (2) | Val  Loss: 1.5711 | Val  Acc: 0.6429
 Site-Real                      (2) | Val  Loss: 1.6070 | Val  Acc: 0.6610
 Site-Real                      (2) | Val  Loss: 1.5043 | Val  Acc: 0.7879
 Site-Real                      (2) | Val  Loss: 1.5823 | Val  Acc: 0.7229
 Site-Painting                  (3) | Val  Loss: 1.6052 | Val  Acc: 0.7245
 Site-Painting                  (3) | Val  Loss: 1.6209 | Val  Acc: 0.6642
 Site-Painting                  (3) | Val  Loss: 1.6593 | Val  Acc: 0.6667
 Site-Sketch                    (5) | Val  Loss: 1.6972 | Val  Acc: 0.6063
 Site-Sketch                    (5) | Val  Loss: 1.7103 | Val  Acc: 0.5618
 Site-QuickDraw                 (1) | Val  Loss: 2.1266 | Val  Acc: 0.3394
 Site-Infograph                 (4) | Val  Loss: 2.0329 | Val  Acc: 0.3397
Average Valid Accuracy: 0.5900
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5132
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5607
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5733
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5810
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.4949
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.6429
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.6610
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7879
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7229
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.7245
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.6642
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.6667
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.6063
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5618
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.3394
 Best site-Infograph                (4)  | Epoch:2 | Val Acc: 0.3397
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 3 ============
cnt=[5, 4, 1, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                  | Train Loss: 1.5744 | Train Acc: 0.6261
 Site-Clipart                  | Train Loss: 1.5213 | Train Acc: 0.6770
 Site-Clipart                  | Train Loss: 1.6188 | Train Acc: 0.6356
 Site-Clipart                  | Train Loss: 1.5613 | Train Acc: 0.6582
 Site-Clipart                  | Train Loss: 1.5862 | Train Acc: 0.6538
 Site-Real                     | Train Loss: 1.4541 | Train Acc: 0.7857
 Site-Real                     | Train Loss: 1.3411 | Train Acc: 0.7853
 Site-Real                     | Train Loss: 1.2913 | Train Acc: 0.8226
 Site-Real                     | Train Loss: 1.4529 | Train Acc: 0.7213
 Site-Painting                 | Train Loss: 1.4880 | Train Acc: 0.6531
 Site-Painting                 | Train Loss: 1.4872 | Train Acc: 0.7087
 Site-Painting                 | Train Loss: 1.4489 | Train Acc: 0.7336
 Site-Sketch                   | Train Loss: 1.5128 | Train Acc: 0.6387
 Site-Sketch                   | Train Loss: 1.4801 | Train Acc: 0.6554
 Site-QuickDraw                | Train Loss: 2.0252 | Train Acc: 0.3456
 Site-Infograph                | Train Loss: 1.8919 | Train Acc: 0.4060
 Site-Clipart                   (0) | Val  Loss: 1.5068 | Val  Acc: 0.6184
 Site-Clipart                   (0) | Val  Loss: 1.5701 | Val  Acc: 0.6542
 Site-Clipart                   (0) | Val  Loss: 1.5486 | Val  Acc: 0.6067
 Site-Clipart                   (0) | Val  Loss: 1.5058 | Val  Acc: 0.6476
 Site-Clipart                   (0) | Val  Loss: 1.6185 | Val  Acc: 0.6102
 Site-Real                      (1) | Val  Loss: 1.3694 | Val  Acc: 0.7143
 Site-Real                      (1) | Val  Loss: 1.3687 | Val  Acc: 0.7966
 Site-Real                      (1) | Val  Loss: 1.2866 | Val  Acc: 0.8121
 Site-Real                      (1) | Val  Loss: 1.3381 | Val  Acc: 0.8009
 Site-Painting                  (4) | Val  Loss: 1.3623 | Val  Acc: 0.8163
 Site-Painting                  (4) | Val  Loss: 1.3696 | Val  Acc: 0.7664
 Site-Painting                  (4) | Val  Loss: 1.4455 | Val  Acc: 0.6927
 Site-Sketch                    (3) | Val  Loss: 1.4890 | Val  Acc: 0.6378
 Site-Sketch                    (3) | Val  Loss: 1.5392 | Val  Acc: 0.6292
 Site-QuickDraw                 (2) | Val  Loss: 2.0359 | Val  Acc: 0.3853
 Site-Infograph                 (5) | Val  Loss: 1.8698 | Val  Acc: 0.4423
Average Valid Accuracy: 0.6644
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6184
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6542
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6067
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6476
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6102
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.7143
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.7966
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8121
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8009
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.8163
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.7664
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.6927
 Best site-Sketch                   (3)  | Epoch:3 | Val Acc: 0.6378
 Best site-Sketch                   (3)  | Epoch:3 | Val Acc: 0.6292
 Best site-QuickDraw                (2)  | Epoch:3 | Val Acc: 0.3853
 Best site-Infograph                (5)  | Epoch:3 | Val Acc: 0.4423
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 4 ============
cnt=[5, 1, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                  | Train Loss: 1.4315 | Train Acc: 0.6522
 Site-Clipart                  | Train Loss: 1.3654 | Train Acc: 0.7081
 Site-Clipart                  | Train Loss: 1.4729 | Train Acc: 0.6756
 Site-Clipart                  | Train Loss: 1.3764 | Train Acc: 0.7215
 Site-Clipart                  | Train Loss: 1.4052 | Train Acc: 0.7059
 Site-Real                     | Train Loss: 1.2355 | Train Acc: 0.8095
 Site-Real                     | Train Loss: 1.1453 | Train Acc: 0.8305
 Site-Real                     | Train Loss: 1.0810 | Train Acc: 0.8387
 Site-Real                     | Train Loss: 1.2723 | Train Acc: 0.8075
 Site-Painting                 | Train Loss: 1.3385 | Train Acc: 0.6939
 Site-Painting                 | Train Loss: 1.3786 | Train Acc: 0.7621
 Site-Painting                 | Train Loss: 1.2625 | Train Acc: 0.7751
 Site-Sketch                   | Train Loss: 1.3207 | Train Acc: 0.7016
 Site-Sketch                   | Train Loss: 1.2623 | Train Acc: 0.6854
 Site-QuickDraw                | Train Loss: 1.9274 | Train Acc: 0.4251
 Site-Infograph                | Train Loss: 1.7833 | Train Acc: 0.4487
 Site-Clipart                   (0) | Val  Loss: 1.2716 | Val  Acc: 0.7500
 Site-Clipart                   (0) | Val  Loss: 1.4143 | Val  Acc: 0.6729
 Site-Clipart                   (0) | Val  Loss: 1.4013 | Val  Acc: 0.7067
 Site-Clipart                   (0) | Val  Loss: 1.3333 | Val  Acc: 0.6952
 Site-Clipart                   (0) | Val  Loss: 1.4584 | Val  Acc: 0.6441
 Site-Real                      (2) | Val  Loss: 1.1464 | Val  Acc: 0.8095
 Site-Real                      (2) | Val  Loss: 1.1404 | Val  Acc: 0.8305
 Site-Real                      (2) | Val  Loss: 1.0942 | Val  Acc: 0.8121
 Site-Real                      (2) | Val  Loss: 1.1283 | Val  Acc: 0.8268
 Site-Painting                  (4) | Val  Loss: 1.1858 | Val  Acc: 0.8367
 Site-Painting                  (4) | Val  Loss: 1.2463 | Val  Acc: 0.6934
 Site-Painting                  (4) | Val  Loss: 1.2819 | Val  Acc: 0.7656
 Site-Sketch                    (5) | Val  Loss: 1.3318 | Val  Acc: 0.7087
 Site-Sketch                    (5) | Val  Loss: 1.3337 | Val  Acc: 0.6742
 Site-QuickDraw                 (1) | Val  Loss: 1.9319 | Val  Acc: 0.4266
 Site-Infograph                 (3) | Val  Loss: 1.7646 | Val  Acc: 0.4359
Average Valid Accuracy: 0.7056
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7500
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.6729
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7067
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.6952
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.6441
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8095
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8305
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8121
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8268
 Best site-Painting                 (4)  | Epoch:4 | Val Acc: 0.8367
 Best site-Painting                 (4)  | Epoch:4 | Val Acc: 0.6934
 Best site-Painting                 (4)  | Epoch:4 | Val Acc: 0.7656
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.7087
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.6742
 Best site-QuickDraw                (1)  | Epoch:4 | Val Acc: 0.4266
 Best site-Infograph                (3)  | Epoch:4 | Val Acc: 0.4359
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 1, 4, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                  | Train Loss: 1.3024 | Train Acc: 0.6435
 Site-Clipart                  | Train Loss: 1.2020 | Train Acc: 0.7702
 Site-Clipart                  | Train Loss: 1.3187 | Train Acc: 0.7333
 Site-Clipart                  | Train Loss: 1.2380 | Train Acc: 0.7405
 Site-Clipart                  | Train Loss: 1.2945 | Train Acc: 0.7127
 Site-Real                     | Train Loss: 1.0698 | Train Acc: 0.8333
 Site-Real                     | Train Loss: 0.9579 | Train Acc: 0.8701
 Site-Real                     | Train Loss: 0.9417 | Train Acc: 0.8548
 Site-Real                     | Train Loss: 1.0454 | Train Acc: 0.8017
 Site-Painting                 | Train Loss: 1.1403 | Train Acc: 0.7551
 Site-Painting                 | Train Loss: 1.1904 | Train Acc: 0.7379
 Site-Painting                 | Train Loss: 1.1047 | Train Acc: 0.7993
 Site-Sketch                   | Train Loss: 1.1899 | Train Acc: 0.6702
 Site-Sketch                   | Train Loss: 1.2875 | Train Acc: 0.7116
 Site-QuickDraw                | Train Loss: 1.7746 | Train Acc: 0.4618
 Site-Infograph                | Train Loss: 1.7052 | Train Acc: 0.4701
 Site-Clipart                   (3) | Val  Loss: 1.1338 | Val  Acc: 0.7368
 Site-Clipart                   (3) | Val  Loss: 1.2696 | Val  Acc: 0.7196
 Site-Clipart                   (3) | Val  Loss: 1.2197 | Val  Acc: 0.7333
 Site-Clipart                   (3) | Val  Loss: 1.1891 | Val  Acc: 0.7143
 Site-Clipart                   (3) | Val  Loss: 1.3094 | Val  Acc: 0.7186
 Site-Real                      (2) | Val  Loss: 0.9588 | Val  Acc: 0.8690
 Site-Real                      (2) | Val  Loss: 0.9802 | Val  Acc: 0.8729
 Site-Real                      (2) | Val  Loss: 0.9109 | Val  Acc: 0.8727
 Site-Real                      (2) | Val  Loss: 0.9720 | Val  Acc: 0.8485
 Site-Painting                  (5) | Val  Loss: 0.9935 | Val  Acc: 0.8469
 Site-Painting                  (5) | Val  Loss: 1.0971 | Val  Acc: 0.7591
 Site-Painting                  (5) | Val  Loss: 1.1152 | Val  Acc: 0.7656
 Site-Sketch                    (0) | Val  Loss: 1.2312 | Val  Acc: 0.6929
 Site-Sketch                    (0) | Val  Loss: 1.1989 | Val  Acc: 0.6742
 Site-QuickDraw                 (1) | Val  Loss: 1.8288 | Val  Acc: 0.4771
 Site-Infograph                 (4) | Val  Loss: 1.6876 | Val  Acc: 0.4615
Average Valid Accuracy: 0.7352
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7368
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7196
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7333
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7143
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7186
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8690
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8729
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8727
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8485
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8469
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.7591
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.7656
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.6929
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.6742
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.4771
 Best site-Infograph                (4)  | Epoch:5 | Val Acc: 0.4615
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 6 ============
cnt=[5, 3, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                  | Train Loss: 1.1663 | Train Acc: 0.7130
 Site-Clipart                  | Train Loss: 1.0317 | Train Acc: 0.7826
 Site-Clipart                  | Train Loss: 1.2143 | Train Acc: 0.7244
 Site-Clipart                  | Train Loss: 1.1382 | Train Acc: 0.7215
 Site-Clipart                  | Train Loss: 1.1882 | Train Acc: 0.7172
 Site-Real                     | Train Loss: 0.9328 | Train Acc: 0.8651
 Site-Real                     | Train Loss: 0.8546 | Train Acc: 0.8757
 Site-Real                     | Train Loss: 0.8193 | Train Acc: 0.8790
 Site-Real                     | Train Loss: 0.9482 | Train Acc: 0.8736
 Site-Painting                 | Train Loss: 1.0037 | Train Acc: 0.7415
 Site-Painting                 | Train Loss: 0.9668 | Train Acc: 0.8155
 Site-Painting                 | Train Loss: 0.9994 | Train Acc: 0.8097
 Site-Sketch                   | Train Loss: 1.0610 | Train Acc: 0.7382
 Site-Sketch                   | Train Loss: 1.0933 | Train Acc: 0.7566
 Site-QuickDraw                | Train Loss: 1.5792 | Train Acc: 0.5199
 Site-Infograph                | Train Loss: 1.6037 | Train Acc: 0.5299
 Site-Clipart                   (0) | Val  Loss: 0.9939 | Val  Acc: 0.7632
 Site-Clipart                   (0) | Val  Loss: 1.1580 | Val  Acc: 0.7290
 Site-Clipart                   (0) | Val  Loss: 1.1259 | Val  Acc: 0.7333
 Site-Clipart                   (0) | Val  Loss: 1.0830 | Val  Acc: 0.7476
 Site-Clipart                   (0) | Val  Loss: 1.2075 | Val  Acc: 0.7153
 Site-Real                      (3) | Val  Loss: 0.8409 | Val  Acc: 0.8810
 Site-Real                      (3) | Val  Loss: 0.8549 | Val  Acc: 0.8559
 Site-Real                      (3) | Val  Loss: 0.8246 | Val  Acc: 0.8667
 Site-Real                      (3) | Val  Loss: 0.8403 | Val  Acc: 0.8658
 Site-Painting                  (1) | Val  Loss: 0.8843 | Val  Acc: 0.8265
 Site-Painting                  (1) | Val  Loss: 0.9797 | Val  Acc: 0.7810
 Site-Painting                  (1) | Val  Loss: 0.9863 | Val  Acc: 0.7969
 Site-Sketch                    (5) | Val  Loss: 1.0595 | Val  Acc: 0.7638
 Site-Sketch                    (5) | Val  Loss: 1.0735 | Val  Acc: 0.7360
 Site-QuickDraw                 (2) | Val  Loss: 1.6947 | Val  Acc: 0.5229
 Site-Infograph                 (4) | Val  Loss: 1.5830 | Val  Acc: 0.5577
Average Valid Accuracy: 0.7589
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7632
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7290
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7333
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7476
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7153
 Best site-Real                     (3)  | Epoch:6 | Val Acc: 0.8810
 Best site-Real                     (3)  | Epoch:6 | Val Acc: 0.8559
 Best site-Real                     (3)  | Epoch:6 | Val Acc: 0.8667
 Best site-Real                     (3)  | Epoch:6 | Val Acc: 0.8658
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.8265
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.7810
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.7969
 Best site-Sketch                   (5)  | Epoch:6 | Val Acc: 0.7638
 Best site-Sketch                   (5)  | Epoch:6 | Val Acc: 0.7360
 Best site-QuickDraw                (2)  | Epoch:6 | Val Acc: 0.5229
 Best site-Infograph                (4)  | Epoch:6 | Val Acc: 0.5577
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 7 ============
cnt=[3, 5, 1, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                  | Train Loss: 1.0531 | Train Acc: 0.7304
 Site-Clipart                  | Train Loss: 0.9607 | Train Acc: 0.7950
 Site-Clipart                  | Train Loss: 1.1029 | Train Acc: 0.7689
 Site-Clipart                  | Train Loss: 1.0282 | Train Acc: 0.7563
 Site-Clipart                  | Train Loss: 1.0774 | Train Acc: 0.7534
 Site-Real                     | Train Loss: 0.8520 | Train Acc: 0.8333
 Site-Real                     | Train Loss: 0.7696 | Train Acc: 0.8757
 Site-Real                     | Train Loss: 0.7238 | Train Acc: 0.8871
 Site-Real                     | Train Loss: 0.7966 | Train Acc: 0.8937
 Site-Painting                 | Train Loss: 0.9229 | Train Acc: 0.7755
 Site-Painting                 | Train Loss: 0.8622 | Train Acc: 0.7864
 Site-Painting                 | Train Loss: 0.8862 | Train Acc: 0.8201
 Site-Sketch                   | Train Loss: 0.9586 | Train Acc: 0.7749
 Site-Sketch                   | Train Loss: 0.9731 | Train Acc: 0.7566
 Site-QuickDraw                | Train Loss: 1.4328 | Train Acc: 0.5933
 Site-Infograph                | Train Loss: 1.5204 | Train Acc: 0.5513
 Site-Clipart                   (1) | Val  Loss: 0.8916 | Val  Acc: 0.8158
 Site-Clipart                   (1) | Val  Loss: 1.0470 | Val  Acc: 0.7383
 Site-Clipart                   (1) | Val  Loss: 1.0327 | Val  Acc: 0.7733
 Site-Clipart                   (1) | Val  Loss: 0.9532 | Val  Acc: 0.7952
 Site-Clipart                   (1) | Val  Loss: 1.1025 | Val  Acc: 0.7288
 Site-Real                      (5) | Val  Loss: 0.7535 | Val  Acc: 0.9167
 Site-Real                      (5) | Val  Loss: 0.7769 | Val  Acc: 0.9068
 Site-Real                      (5) | Val  Loss: 0.7329 | Val  Acc: 0.8606
 Site-Real                      (5) | Val  Loss: 0.7584 | Val  Acc: 0.8745
 Site-Painting                  (0) | Val  Loss: 0.7614 | Val  Acc: 0.8571
 Site-Painting                  (0) | Val  Loss: 0.8926 | Val  Acc: 0.8321
 Site-Painting                  (0) | Val  Loss: 0.8801 | Val  Acc: 0.8177
 Site-Sketch                    (4) | Val  Loss: 0.9467 | Val  Acc: 0.8110
 Site-Sketch                    (4) | Val  Loss: 0.9661 | Val  Acc: 0.7753
 Site-QuickDraw                 (2) | Val  Loss: 1.6109 | Val  Acc: 0.5917
 Site-Infograph                 (3) | Val  Loss: 1.4817 | Val  Acc: 0.5833
Average Valid Accuracy: 0.7924
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.8158
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7383
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7733
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7952
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7288
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.9167
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.9068
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.8606
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.8745
 Best site-Painting                 (0)  | Epoch:7 | Val Acc: 0.8571
 Best site-Painting                 (0)  | Epoch:7 | Val Acc: 0.8321
 Best site-Painting                 (0)  | Epoch:7 | Val Acc: 0.8177
 Best site-Sketch                   (4)  | Epoch:7 | Val Acc: 0.8110
 Best site-Sketch                   (4)  | Epoch:7 | Val Acc: 0.7753
 Best site-QuickDraw                (2)  | Epoch:7 | Val Acc: 0.5917
 Best site-Infograph                (3)  | Epoch:7 | Val Acc: 0.5833
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 8 ============
cnt=[5, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                  | Train Loss: 0.9540 | Train Acc: 0.7739
 Site-Clipart                  | Train Loss: 0.8768 | Train Acc: 0.8323
 Site-Clipart                  | Train Loss: 0.9855 | Train Acc: 0.7956
 Site-Clipart                  | Train Loss: 0.9172 | Train Acc: 0.7848
 Site-Clipart                  | Train Loss: 0.9661 | Train Acc: 0.7828
 Site-Real                     | Train Loss: 0.7377 | Train Acc: 0.8571
 Site-Real                     | Train Loss: 0.6984 | Train Acc: 0.8983
 Site-Real                     | Train Loss: 0.6581 | Train Acc: 0.8790
 Site-Real                     | Train Loss: 0.7286 | Train Acc: 0.8994
 Site-Painting                 | Train Loss: 0.9159 | Train Acc: 0.8027
 Site-Painting                 | Train Loss: 0.8026 | Train Acc: 0.8155
 Site-Painting                 | Train Loss: 0.8068 | Train Acc: 0.8339
 Site-Sketch                   | Train Loss: 0.8836 | Train Acc: 0.7487
 Site-Sketch                   | Train Loss: 0.9340 | Train Acc: 0.7715
 Site-QuickDraw                | Train Loss: 1.4530 | Train Acc: 0.6269
 Site-Infograph                | Train Loss: 1.4504 | Train Acc: 0.5598
 Site-Clipart                   (0) | Val  Loss: 0.8017 | Val  Acc: 0.8553
 Site-Clipart                   (0) | Val  Loss: 0.9424 | Val  Acc: 0.7757
 Site-Clipart                   (0) | Val  Loss: 0.9655 | Val  Acc: 0.7533
 Site-Clipart                   (0) | Val  Loss: 0.8903 | Val  Acc: 0.7714
 Site-Clipart                   (0) | Val  Loss: 1.0033 | Val  Acc: 0.7525
 Site-Real                      (1) | Val  Loss: 0.6681 | Val  Acc: 0.9167
 Site-Real                      (1) | Val  Loss: 0.6541 | Val  Acc: 0.9068
 Site-Real                      (1) | Val  Loss: 0.6235 | Val  Acc: 0.8909
 Site-Real                      (1) | Val  Loss: 0.6681 | Val  Acc: 0.8918
 Site-Painting                  (2) | Val  Loss: 0.7142 | Val  Acc: 0.8265
 Site-Painting                  (2) | Val  Loss: 0.8689 | Val  Acc: 0.7956
 Site-Painting                  (2) | Val  Loss: 0.8064 | Val  Acc: 0.8229
 Site-Sketch                    (5) | Val  Loss: 0.8902 | Val  Acc: 0.7717
 Site-Sketch                    (5) | Val  Loss: 0.8955 | Val  Acc: 0.7753
 Site-QuickDraw                 (3) | Val  Loss: 1.5127 | Val  Acc: 0.6055
 Site-Infograph                 (4) | Val  Loss: 1.4075 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7931
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8553
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.7757
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.7533
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.7714
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.7525
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9167
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9068
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.8909
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.8918
 Best site-Painting                 (2)  | Epoch:8 | Val Acc: 0.8265
 Best site-Painting                 (2)  | Epoch:8 | Val Acc: 0.7956
 Best site-Painting                 (2)  | Epoch:8 | Val Acc: 0.8229
 Best site-Sketch                   (5)  | Epoch:8 | Val Acc: 0.7717
 Best site-Sketch                   (5)  | Epoch:8 | Val Acc: 0.7753
 Best site-QuickDraw                (3)  | Epoch:8 | Val Acc: 0.6055
 Best site-Infograph                (4)  | Epoch:8 | Val Acc: 0.5769
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 3, 5, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                  | Train Loss: 0.8895 | Train Acc: 0.7391
 Site-Clipart                  | Train Loss: 0.8330 | Train Acc: 0.8075
 Site-Clipart                  | Train Loss: 0.9110 | Train Acc: 0.8089
 Site-Clipart                  | Train Loss: 0.8750 | Train Acc: 0.7848
 Site-Clipart                  | Train Loss: 0.9303 | Train Acc: 0.7557
 Site-Real                     | Train Loss: 0.7284 | Train Acc: 0.8651
 Site-Real                     | Train Loss: 0.6132 | Train Acc: 0.9040
 Site-Real                     | Train Loss: 0.5883 | Train Acc: 0.8952
 Site-Real                     | Train Loss: 0.6558 | Train Acc: 0.8994
 Site-Painting                 | Train Loss: 0.7830 | Train Acc: 0.8231
 Site-Painting                 | Train Loss: 0.7496 | Train Acc: 0.8252
 Site-Painting                 | Train Loss: 0.7535 | Train Acc: 0.8512
 Site-Sketch                   | Train Loss: 0.8531 | Train Acc: 0.7644
 Site-Sketch                   | Train Loss: 0.8236 | Train Acc: 0.7865
 Site-QuickDraw                | Train Loss: 1.3486 | Train Acc: 0.6483
 Site-Infograph                | Train Loss: 1.3763 | Train Acc: 0.5598
 Site-Clipart                   (2) | Val  Loss: 0.7147 | Val  Acc: 0.8421
 Site-Clipart                   (2) | Val  Loss: 0.8522 | Val  Acc: 0.7850
 Site-Clipart                   (2) | Val  Loss: 0.9036 | Val  Acc: 0.8200
 Site-Clipart                   (2) | Val  Loss: 0.8416 | Val  Acc: 0.7952
 Site-Clipart                   (2) | Val  Loss: 0.9473 | Val  Acc: 0.7729
 Site-Real                      (5) | Val  Loss: 0.5932 | Val  Acc: 0.9167
 Site-Real                      (5) | Val  Loss: 0.6164 | Val  Acc: 0.9068
 Site-Real                      (5) | Val  Loss: 0.6141 | Val  Acc: 0.8848
 Site-Real                      (5) | Val  Loss: 0.6262 | Val  Acc: 0.9004
 Site-Painting                  (1) | Val  Loss: 0.6501 | Val  Acc: 0.8571
 Site-Painting                  (1) | Val  Loss: 0.7941 | Val  Acc: 0.7737
 Site-Painting                  (1) | Val  Loss: 0.7240 | Val  Acc: 0.8490
 Site-Sketch                    (0) | Val  Loss: 0.8004 | Val  Acc: 0.8110
 Site-Sketch                    (0) | Val  Loss: 0.8668 | Val  Acc: 0.7416
 Site-QuickDraw                 (3) | Val  Loss: 1.4575 | Val  Acc: 0.6239
 Site-Infograph                 (4) | Val  Loss: 1.3486 | Val  Acc: 0.5962
Average Valid Accuracy: 0.8048
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8421
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.7850
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8200
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.7952
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.7729
 Best site-Real                     (5)  | Epoch:9 | Val Acc: 0.9167
 Best site-Real                     (5)  | Epoch:9 | Val Acc: 0.9068
 Best site-Real                     (5)  | Epoch:9 | Val Acc: 0.8848
 Best site-Real                     (5)  | Epoch:9 | Val Acc: 0.9004
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.8571
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.7737
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.8490
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.8110
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.7416
 Best site-QuickDraw                (3)  | Epoch:9 | Val Acc: 0.6239
 Best site-Infograph                (4)  | Epoch:9 | Val Acc: 0.5962
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
 Test site-Clipart                   (2)| Epoch:9 | Test Acc: 0.7871
 Test site-Real                      (5)| Epoch:9 | Test Acc: 0.9145
 Test site-Painting                  (1)| Epoch:9 | Test Acc: 0.8611
 Test site-Sketch                    (0)| Epoch:9 | Test Acc: 0.7906
 Test site-QuickDraw                 (3)| Epoch:9 | Test Acc: 0.6590
 Test site-Infograph                 (4)| Epoch:9 | Test Acc: 0.5099
Clipart: 0.7871, Real: 0.9145, Painting: 0.8611, Sketch: 0.7906, QuickDraw: 0.6590, Infograph: 0.5099, 
Average Test Accuracy(group): 0.7537, Average Test Accuracy(individual): 0.8079,
domain CV=0.1782, cluster CV=0.1782, individual CV=0.1267, 
============ Train epoch 10 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                  | Train Loss: 0.8393 | Train Acc: 0.8000
 Site-Clipart                  | Train Loss: 0.7384 | Train Acc: 0.8012
 Site-Clipart                  | Train Loss: 0.8608 | Train Acc: 0.7956
 Site-Clipart                  | Train Loss: 0.8261 | Train Acc: 0.7911
 Site-Clipart                  | Train Loss: 0.8388 | Train Acc: 0.7964
 Site-Real                     | Train Loss: 0.6522 | Train Acc: 0.8810
 Site-Real                     | Train Loss: 0.5424 | Train Acc: 0.9266
 Site-Real                     | Train Loss: 0.5428 | Train Acc: 0.8992
 Site-Real                     | Train Loss: 0.6323 | Train Acc: 0.9167
 Site-Painting                 | Train Loss: 0.7559 | Train Acc: 0.8163
 Site-Painting                 | Train Loss: 0.7187 | Train Acc: 0.8252
 Site-Painting                 | Train Loss: 0.7270 | Train Acc: 0.8408
 Site-Sketch                   | Train Loss: 0.7787 | Train Acc: 0.7958
 Site-Sketch                   | Train Loss: 0.9045 | Train Acc: 0.7828
 Site-QuickDraw                | Train Loss: 1.2581 | Train Acc: 0.6636
 Site-Infograph                | Train Loss: 1.3130 | Train Acc: 0.6068
 Site-Clipart                   (0) | Val  Loss: 0.6824 | Val  Acc: 0.8421
 Site-Clipart                   (0) | Val  Loss: 0.8018 | Val  Acc: 0.7944
 Site-Clipart                   (0) | Val  Loss: 0.8214 | Val  Acc: 0.8000
 Site-Clipart                   (0) | Val  Loss: 0.7779 | Val  Acc: 0.8190
 Site-Clipart                   (0) | Val  Loss: 0.9021 | Val  Acc: 0.7864
 Site-Real                      (1) | Val  Loss: 0.5289 | Val  Acc: 0.9048
 Site-Real                      (1) | Val  Loss: 0.5655 | Val  Acc: 0.9237
 Site-Real                      (1) | Val  Loss: 0.5687 | Val  Acc: 0.8970
 Site-Real                      (1) | Val  Loss: 0.5648 | Val  Acc: 0.9134
 Site-Painting                  (3) | Val  Loss: 0.5780 | Val  Acc: 0.8776
 Site-Painting                  (3) | Val  Loss: 0.7484 | Val  Acc: 0.8102
 Site-Painting                  (3) | Val  Loss: 0.6978 | Val  Acc: 0.8490
 Site-Sketch                    (5) | Val  Loss: 0.7285 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.8208 | Val  Acc: 0.7753
 Site-QuickDraw                 (2) | Val  Loss: 1.3242 | Val  Acc: 0.6789
 Site-Infograph                 (4) | Val  Loss: 1.2945 | Val  Acc: 0.6090
Average Valid Accuracy: 0.8202
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8421
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.7944
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8000
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8190
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.7864
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9048
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9237
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.8970
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9134
 Best site-Painting                 (3)  | Epoch:10 | Val Acc: 0.8776
 Best site-Painting                 (3)  | Epoch:10 | Val Acc: 0.8102
 Best site-Painting                 (3)  | Epoch:10 | Val Acc: 0.8490
 Best site-Sketch                   (5)  | Epoch:10 | Val Acc: 0.8425
 Best site-Sketch                   (5)  | Epoch:10 | Val Acc: 0.7753
 Best site-QuickDraw                (2)  | Epoch:10 | Val Acc: 0.6789
 Best site-Infograph                (4)  | Epoch:10 | Val Acc: 0.6090
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 11 ============
cnt=[3, 1, 2, 5, 4, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                  | Train Loss: 0.7641 | Train Acc: 0.8000
 Site-Clipart                  | Train Loss: 0.7307 | Train Acc: 0.8323
 Site-Clipart                  | Train Loss: 0.8418 | Train Acc: 0.8044
 Site-Clipart                  | Train Loss: 0.7840 | Train Acc: 0.8101
 Site-Clipart                  | Train Loss: 0.8331 | Train Acc: 0.7805
 Site-Real                     | Train Loss: 0.6080 | Train Acc: 0.8889
 Site-Real                     | Train Loss: 0.5127 | Train Acc: 0.9096
 Site-Real                     | Train Loss: 0.5094 | Train Acc: 0.9073
 Site-Real                     | Train Loss: 0.5677 | Train Acc: 0.9195
 Site-Painting                 | Train Loss: 0.7216 | Train Acc: 0.8027
 Site-Painting                 | Train Loss: 0.6562 | Train Acc: 0.8641
 Site-Painting                 | Train Loss: 0.6586 | Train Acc: 0.8616
 Site-Sketch                   | Train Loss: 0.7311 | Train Acc: 0.8010
 Site-Sketch                   | Train Loss: 0.7788 | Train Acc: 0.8052
 Site-QuickDraw                | Train Loss: 1.1395 | Train Acc: 0.6820
 Site-Infograph                | Train Loss: 1.2898 | Train Acc: 0.6026
 Site-Clipart                   (3) | Val  Loss: 0.6237 | Val  Acc: 0.8289
 Site-Clipart                   (3) | Val  Loss: 0.7700 | Val  Acc: 0.8131
 Site-Clipart                   (3) | Val  Loss: 0.7758 | Val  Acc: 0.7867
 Site-Clipart                   (3) | Val  Loss: 0.7371 | Val  Acc: 0.8000
 Site-Clipart                   (3) | Val  Loss: 0.8870 | Val  Acc: 0.7797
 Site-Real                      (4) | Val  Loss: 0.5238 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.5132 | Val  Acc: 0.8983
 Site-Real                      (4) | Val  Loss: 0.5102 | Val  Acc: 0.8909
 Site-Real                      (4) | Val  Loss: 0.5341 | Val  Acc: 0.9307
 Site-Painting                  (0) | Val  Loss: 0.5297 | Val  Acc: 0.9082
 Site-Painting                  (0) | Val  Loss: 0.6890 | Val  Acc: 0.8248
 Site-Painting                  (0) | Val  Loss: 0.6551 | Val  Acc: 0.8542
 Site-Sketch                    (2) | Val  Loss: 0.6547 | Val  Acc: 0.8583
 Site-Sketch                    (2) | Val  Loss: 0.8311 | Val  Acc: 0.7528
 Site-QuickDraw                 (1) | Val  Loss: 1.2504 | Val  Acc: 0.7018
 Site-Infograph                 (5) | Val  Loss: 1.2426 | Val  Acc: 0.6346
Average Valid Accuracy: 0.8260
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8289
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8131
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.7867
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8000
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.7797
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9524
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.8983
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.8909
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9307
 Best site-Painting                 (0)  | Epoch:11 | Val Acc: 0.9082
 Best site-Painting                 (0)  | Epoch:11 | Val Acc: 0.8248
 Best site-Painting                 (0)  | Epoch:11 | Val Acc: 0.8542
 Best site-Sketch                   (2)  | Epoch:11 | Val Acc: 0.8583
 Best site-Sketch                   (2)  | Epoch:11 | Val Acc: 0.7528
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.7018
 Best site-Infograph                (5)  | Epoch:11 | Val Acc: 0.6346
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 12 ============
cnt=[4, 2, 1, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                  | Train Loss: 0.7272 | Train Acc: 0.8348
 Site-Clipart                  | Train Loss: 0.6317 | Train Acc: 0.8571
 Site-Clipart                  | Train Loss: 0.7865 | Train Acc: 0.8178
 Site-Clipart                  | Train Loss: 0.7444 | Train Acc: 0.8196
 Site-Clipart                  | Train Loss: 0.7710 | Train Acc: 0.8009
 Site-Real                     | Train Loss: 0.5729 | Train Acc: 0.8889
 Site-Real                     | Train Loss: 0.4877 | Train Acc: 0.9322
 Site-Real                     | Train Loss: 0.4491 | Train Acc: 0.9274
 Site-Real                     | Train Loss: 0.5388 | Train Acc: 0.9282
 Site-Painting                 | Train Loss: 0.6766 | Train Acc: 0.8095
 Site-Painting                 | Train Loss: 0.6733 | Train Acc: 0.8447
 Site-Painting                 | Train Loss: 0.6086 | Train Acc: 0.8824
 Site-Sketch                   | Train Loss: 0.6678 | Train Acc: 0.8325
 Site-Sketch                   | Train Loss: 0.7031 | Train Acc: 0.8052
 Site-QuickDraw                | Train Loss: 1.1454 | Train Acc: 0.6972
 Site-Infograph                | Train Loss: 1.2974 | Train Acc: 0.5897
 Site-Clipart                   (3) | Val  Loss: 0.6263 | Val  Acc: 0.8026
 Site-Clipart                   (3) | Val  Loss: 0.7420 | Val  Acc: 0.8131
 Site-Clipart                   (3) | Val  Loss: 0.7077 | Val  Acc: 0.8333
 Site-Clipart                   (3) | Val  Loss: 0.6764 | Val  Acc: 0.8571
 Site-Clipart                   (3) | Val  Loss: 0.8354 | Val  Acc: 0.7898
 Site-Real                      (0) | Val  Loss: 0.4563 | Val  Acc: 0.9167
 Site-Real                      (0) | Val  Loss: 0.4636 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.4700 | Val  Acc: 0.9152
 Site-Real                      (0) | Val  Loss: 0.4641 | Val  Acc: 0.9351
 Site-Painting                  (5) | Val  Loss: 0.5311 | Val  Acc: 0.9082
 Site-Painting                  (5) | Val  Loss: 0.6021 | Val  Acc: 0.8321
 Site-Painting                  (5) | Val  Loss: 0.6328 | Val  Acc: 0.8438
 Site-Sketch                    (1) | Val  Loss: 0.6840 | Val  Acc: 0.8661
 Site-Sketch                    (1) | Val  Loss: 0.8042 | Val  Acc: 0.7640
 Site-QuickDraw                 (2) | Val  Loss: 1.2458 | Val  Acc: 0.6697
 Site-Infograph                 (4) | Val  Loss: 1.1685 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8346
 Best site-Clipart                  (3)  | Epoch:12 | Val Acc: 0.8026
 Best site-Clipart                  (3)  | Epoch:12 | Val Acc: 0.8131
 Best site-Clipart                  (3)  | Epoch:12 | Val Acc: 0.8333
 Best site-Clipart                  (3)  | Epoch:12 | Val Acc: 0.8571
 Best site-Clipart                  (3)  | Epoch:12 | Val Acc: 0.7898
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9167
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9152
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9351
 Best site-Painting                 (5)  | Epoch:12 | Val Acc: 0.9082
 Best site-Painting                 (5)  | Epoch:12 | Val Acc: 0.8321
 Best site-Painting                 (5)  | Epoch:12 | Val Acc: 0.8438
 Best site-Sketch                   (1)  | Epoch:12 | Val Acc: 0.8661
 Best site-Sketch                   (1)  | Epoch:12 | Val Acc: 0.7640
 Best site-QuickDraw                (2)  | Epoch:12 | Val Acc: 0.6697
 Best site-Infograph                (4)  | Epoch:12 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 13 ============
cnt=[1, 4, 2, 1, 5, 3, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                  | Train Loss: 0.7808 | Train Acc: 0.7739
 Site-Clipart                  | Train Loss: 0.6401 | Train Acc: 0.8571
 Site-Clipart                  | Train Loss: 0.7418 | Train Acc: 0.8311
 Site-Clipart                  | Train Loss: 0.7055 | Train Acc: 0.8038
 Site-Clipart                  | Train Loss: 0.7482 | Train Acc: 0.8009
 Site-Real                     | Train Loss: 0.5605 | Train Acc: 0.8730
 Site-Real                     | Train Loss: 0.4503 | Train Acc: 0.9322
 Site-Real                     | Train Loss: 0.4504 | Train Acc: 0.9234
 Site-Real                     | Train Loss: 0.5176 | Train Acc: 0.9253
 Site-Painting                 | Train Loss: 0.6910 | Train Acc: 0.8503
 Site-Painting                 | Train Loss: 0.6030 | Train Acc: 0.8495
 Site-Painting                 | Train Loss: 0.5715 | Train Acc: 0.8720
 Site-Sketch                   | Train Loss: 0.6732 | Train Acc: 0.8010
 Site-Sketch                   | Train Loss: 0.6682 | Train Acc: 0.8165
 Site-QuickDraw                | Train Loss: 1.1187 | Train Acc: 0.7095
 Site-Infograph                | Train Loss: 1.2035 | Train Acc: 0.6197
 Site-Clipart                   (4) | Val  Loss: 0.6145 | Val  Acc: 0.8026
 Site-Clipart                   (4) | Val  Loss: 0.6753 | Val  Acc: 0.8318
 Site-Clipart                   (4) | Val  Loss: 0.7333 | Val  Acc: 0.8200
 Site-Clipart                   (4) | Val  Loss: 0.7116 | Val  Acc: 0.8000
 Site-Clipart                   (4) | Val  Loss: 0.7895 | Val  Acc: 0.7898
 Site-Real                      (1) | Val  Loss: 0.4749 | Val  Acc: 0.9167
 Site-Real                      (1) | Val  Loss: 0.4606 | Val  Acc: 0.8983
 Site-Real                      (1) | Val  Loss: 0.4562 | Val  Acc: 0.9030
 Site-Real                      (1) | Val  Loss: 0.4730 | Val  Acc: 0.9307
 Site-Painting                  (5) | Val  Loss: 0.5037 | Val  Acc: 0.8673
 Site-Painting                  (5) | Val  Loss: 0.5902 | Val  Acc: 0.8467
 Site-Painting                  (5) | Val  Loss: 0.6043 | Val  Acc: 0.8594
 Site-Sketch                    (2) | Val  Loss: 0.6555 | Val  Acc: 0.8346
 Site-Sketch                    (2) | Val  Loss: 0.7319 | Val  Acc: 0.7640
 Site-QuickDraw                 (3) | Val  Loss: 1.1324 | Val  Acc: 0.7294
 Site-Infograph                 (0) | Val  Loss: 1.2109 | Val  Acc: 0.6346
Average Valid Accuracy: 0.8268
============ Train epoch 14 ============
cnt=[2, 4, 1, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                  | Train Loss: 0.7168 | Train Acc: 0.8261
 Site-Clipart                  | Train Loss: 0.6202 | Train Acc: 0.8634
 Site-Clipart                  | Train Loss: 0.7564 | Train Acc: 0.8311
 Site-Clipart                  | Train Loss: 0.6829 | Train Acc: 0.8196
 Site-Clipart                  | Train Loss: 0.7085 | Train Acc: 0.8281
 Site-Real                     | Train Loss: 0.5165 | Train Acc: 0.8968
 Site-Real                     | Train Loss: 0.4064 | Train Acc: 0.9492
 Site-Real                     | Train Loss: 0.4146 | Train Acc: 0.9274
 Site-Real                     | Train Loss: 0.5154 | Train Acc: 0.9167
 Site-Painting                 | Train Loss: 0.6066 | Train Acc: 0.8776
 Site-Painting                 | Train Loss: 0.6382 | Train Acc: 0.8447
 Site-Painting                 | Train Loss: 0.5582 | Train Acc: 0.8443
 Site-Sketch                   | Train Loss: 0.6304 | Train Acc: 0.8220
 Site-Sketch                   | Train Loss: 0.6236 | Train Acc: 0.8015
 Site-QuickDraw                | Train Loss: 1.0535 | Train Acc: 0.7401
 Site-Infograph                | Train Loss: 1.1616 | Train Acc: 0.6410
 Site-Clipart                   (3) | Val  Loss: 0.5660 | Val  Acc: 0.8158
 Site-Clipart                   (3) | Val  Loss: 0.6780 | Val  Acc: 0.8224
 Site-Clipart                   (3) | Val  Loss: 0.7203 | Val  Acc: 0.8133
 Site-Clipart                   (3) | Val  Loss: 0.6570 | Val  Acc: 0.8286
 Site-Clipart                   (3) | Val  Loss: 0.7611 | Val  Acc: 0.8034
 Site-Real                      (1) | Val  Loss: 0.4218 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.4582 | Val  Acc: 0.9237
 Site-Real                      (1) | Val  Loss: 0.4216 | Val  Acc: 0.9091
 Site-Real                      (1) | Val  Loss: 0.4409 | Val  Acc: 0.9351
 Site-Painting                  (5) | Val  Loss: 0.4937 | Val  Acc: 0.9082
 Site-Painting                  (5) | Val  Loss: 0.5513 | Val  Acc: 0.8321
 Site-Painting                  (5) | Val  Loss: 0.5910 | Val  Acc: 0.8542
 Site-Sketch                    (0) | Val  Loss: 0.6742 | Val  Acc: 0.8189
 Site-Sketch                    (0) | Val  Loss: 0.7351 | Val  Acc: 0.7584
 Site-QuickDraw                 (2) | Val  Loss: 1.1111 | Val  Acc: 0.7156
 Site-Infograph                 (4) | Val  Loss: 1.1364 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8329
============ Train epoch 15 ============
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                  | Train Loss: 0.7237 | Train Acc: 0.8000
 Site-Clipart                  | Train Loss: 0.5742 | Train Acc: 0.8509
 Site-Clipart                  | Train Loss: 0.7345 | Train Acc: 0.8133
 Site-Clipart                  | Train Loss: 0.6908 | Train Acc: 0.8070
 Site-Clipart                  | Train Loss: 0.7105 | Train Acc: 0.8213
 Site-Real                     | Train Loss: 0.5034 | Train Acc: 0.8810
 Site-Real                     | Train Loss: 0.3966 | Train Acc: 0.9492
 Site-Real                     | Train Loss: 0.4018 | Train Acc: 0.9234
 Site-Real                     | Train Loss: 0.4503 | Train Acc: 0.9282
 Site-Painting                 | Train Loss: 0.5800 | Train Acc: 0.8299
 Site-Painting                 | Train Loss: 0.5603 | Train Acc: 0.8641
 Site-Painting                 | Train Loss: 0.5435 | Train Acc: 0.8962
 Site-Sketch                   | Train Loss: 0.5975 | Train Acc: 0.8482
 Site-Sketch                   | Train Loss: 0.6790 | Train Acc: 0.7978
 Site-QuickDraw                | Train Loss: 1.0704 | Train Acc: 0.7401
 Site-Infograph                | Train Loss: 1.1425 | Train Acc: 0.6197
 Site-Clipart                   (0) | Val  Loss: 0.5225 | Val  Acc: 0.8553
 Site-Clipart                   (0) | Val  Loss: 0.6639 | Val  Acc: 0.7944
 Site-Clipart                   (0) | Val  Loss: 0.6591 | Val  Acc: 0.8467
 Site-Clipart                   (0) | Val  Loss: 0.6626 | Val  Acc: 0.8143
 Site-Clipart                   (0) | Val  Loss: 0.7544 | Val  Acc: 0.8000
 Site-Real                      (1) | Val  Loss: 0.4035 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.4261 | Val  Acc: 0.9068
 Site-Real                      (1) | Val  Loss: 0.3950 | Val  Acc: 0.9030
 Site-Real                      (1) | Val  Loss: 0.4164 | Val  Acc: 0.9351
 Site-Painting                  (4) | Val  Loss: 0.4111 | Val  Acc: 0.9286
 Site-Painting                  (4) | Val  Loss: 0.5497 | Val  Acc: 0.8686
 Site-Painting                  (4) | Val  Loss: 0.5292 | Val  Acc: 0.8802
 Site-Sketch                    (5) | Val  Loss: 0.5973 | Val  Acc: 0.8268
 Site-Sketch                    (5) | Val  Loss: 0.7010 | Val  Acc: 0.7921
 Site-QuickDraw                 (2) | Val  Loss: 1.0804 | Val  Acc: 0.7431
 Site-Infograph                 (3) | Val  Loss: 1.0944 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8439
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8553
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.7944
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8467
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8143
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8000
 Best site-Real                     (1)  | Epoch:15 | Val Acc: 0.9405
 Best site-Real                     (1)  | Epoch:15 | Val Acc: 0.9068
 Best site-Real                     (1)  | Epoch:15 | Val Acc: 0.9030
 Best site-Real                     (1)  | Epoch:15 | Val Acc: 0.9351
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.9286
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.8686
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.8802
 Best site-Sketch                   (5)  | Epoch:15 | Val Acc: 0.8268
 Best site-Sketch                   (5)  | Epoch:15 | Val Acc: 0.7921
 Best site-QuickDraw                (2)  | Epoch:15 | Val Acc: 0.7431
 Best site-Infograph                (3)  | Epoch:15 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 16 ============
cnt=[5, 3, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                  | Train Loss: 0.6078 | Train Acc: 0.8348
 Site-Clipart                  | Train Loss: 0.5471 | Train Acc: 0.8509
 Site-Clipart                  | Train Loss: 0.7205 | Train Acc: 0.8356
 Site-Clipart                  | Train Loss: 0.6313 | Train Acc: 0.8323
 Site-Clipart                  | Train Loss: 0.7003 | Train Acc: 0.7986
 Site-Real                     | Train Loss: 0.5186 | Train Acc: 0.8810
 Site-Real                     | Train Loss: 0.3561 | Train Acc: 0.9548
 Site-Real                     | Train Loss: 0.3822 | Train Acc: 0.9194
 Site-Real                     | Train Loss: 0.4330 | Train Acc: 0.9195
 Site-Painting                 | Train Loss: 0.5312 | Train Acc: 0.8639
 Site-Painting                 | Train Loss: 0.5337 | Train Acc: 0.8689
 Site-Painting                 | Train Loss: 0.5288 | Train Acc: 0.8858
 Site-Sketch                   | Train Loss: 0.6296 | Train Acc: 0.8010
 Site-Sketch                   | Train Loss: 0.6505 | Train Acc: 0.7978
 Site-QuickDraw                | Train Loss: 0.8983 | Train Acc: 0.7829
 Site-Infograph                | Train Loss: 1.0681 | Train Acc: 0.6624
 Site-Clipart                   (0) | Val  Loss: 0.5042 | Val  Acc: 0.8421
 Site-Clipart                   (0) | Val  Loss: 0.6585 | Val  Acc: 0.8224
 Site-Clipart                   (0) | Val  Loss: 0.6646 | Val  Acc: 0.8200
 Site-Clipart                   (0) | Val  Loss: 0.6274 | Val  Acc: 0.8429
 Site-Clipart                   (0) | Val  Loss: 0.7404 | Val  Acc: 0.8034
 Site-Real                      (3) | Val  Loss: 0.3856 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3987 | Val  Acc: 0.9068
 Site-Real                      (3) | Val  Loss: 0.3953 | Val  Acc: 0.9091
 Site-Real                      (3) | Val  Loss: 0.3955 | Val  Acc: 0.9134
 Site-Painting                  (1) | Val  Loss: 0.4166 | Val  Acc: 0.9082
 Site-Painting                  (1) | Val  Loss: 0.5348 | Val  Acc: 0.8394
 Site-Painting                  (1) | Val  Loss: 0.5551 | Val  Acc: 0.8594
 Site-Sketch                    (5) | Val  Loss: 0.6378 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.6631 | Val  Acc: 0.7753
 Site-QuickDraw                 (2) | Val  Loss: 1.0195 | Val  Acc: 0.7202
 Site-Infograph                 (4) | Val  Loss: 1.1235 | Val  Acc: 0.6538
Average Valid Accuracy: 0.8375
============ Train epoch 17 ============
cnt=[5, 3, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                  | Train Loss: 0.6704 | Train Acc: 0.8000
 Site-Clipart                  | Train Loss: 0.5531 | Train Acc: 0.8634
 Site-Clipart                  | Train Loss: 0.6903 | Train Acc: 0.8044
 Site-Clipart                  | Train Loss: 0.6450 | Train Acc: 0.8354
 Site-Clipart                  | Train Loss: 0.6383 | Train Acc: 0.8258
 Site-Real                     | Train Loss: 0.4991 | Train Acc: 0.8810
 Site-Real                     | Train Loss: 0.3764 | Train Acc: 0.9435
 Site-Real                     | Train Loss: 0.3816 | Train Acc: 0.9395
 Site-Real                     | Train Loss: 0.4095 | Train Acc: 0.9368
 Site-Painting                 | Train Loss: 0.6338 | Train Acc: 0.8503
 Site-Painting                 | Train Loss: 0.5442 | Train Acc: 0.8592
 Site-Painting                 | Train Loss: 0.5107 | Train Acc: 0.8720
 Site-Sketch                   | Train Loss: 0.6093 | Train Acc: 0.8429
 Site-Sketch                   | Train Loss: 0.5336 | Train Acc: 0.8390
 Site-QuickDraw                | Train Loss: 0.8877 | Train Acc: 0.7737
 Site-Infograph                | Train Loss: 1.0686 | Train Acc: 0.6752
 Site-Clipart                   (0) | Val  Loss: 0.5018 | Val  Acc: 0.8026
 Site-Clipart                   (0) | Val  Loss: 0.5996 | Val  Acc: 0.8131
 Site-Clipart                   (0) | Val  Loss: 0.6334 | Val  Acc: 0.8267
 Site-Clipart                   (0) | Val  Loss: 0.6325 | Val  Acc: 0.8095
 Site-Clipart                   (0) | Val  Loss: 0.7041 | Val  Acc: 0.8136
 Site-Real                      (3) | Val  Loss: 0.3893 | Val  Acc: 0.9167
 Site-Real                      (3) | Val  Loss: 0.3796 | Val  Acc: 0.9068
 Site-Real                      (3) | Val  Loss: 0.3629 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.4008 | Val  Acc: 0.9307
 Site-Painting                  (1) | Val  Loss: 0.4341 | Val  Acc: 0.9286
 Site-Painting                  (1) | Val  Loss: 0.4613 | Val  Acc: 0.8613
 Site-Painting                  (1) | Val  Loss: 0.5428 | Val  Acc: 0.8594
 Site-Sketch                    (5) | Val  Loss: 0.5480 | Val  Acc: 0.8504
 Site-Sketch                    (5) | Val  Loss: 0.6813 | Val  Acc: 0.7753
 Site-QuickDraw                 (2) | Val  Loss: 0.9913 | Val  Acc: 0.7752
 Site-Infograph                 (4) | Val  Loss: 1.1053 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8419
============ Train epoch 18 ============
cnt=[1, 5, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                  | Train Loss: 0.5806 | Train Acc: 0.8609
 Site-Clipart                  | Train Loss: 0.5355 | Train Acc: 0.8571
 Site-Clipart                  | Train Loss: 0.6438 | Train Acc: 0.8489
 Site-Clipart                  | Train Loss: 0.6324 | Train Acc: 0.8165
 Site-Clipart                  | Train Loss: 0.6463 | Train Acc: 0.8054
 Site-Real                     | Train Loss: 0.4947 | Train Acc: 0.8968
 Site-Real                     | Train Loss: 0.3466 | Train Acc: 0.9435
 Site-Real                     | Train Loss: 0.3750 | Train Acc: 0.9274
 Site-Real                     | Train Loss: 0.4161 | Train Acc: 0.9310
 Site-Painting                 | Train Loss: 0.6402 | Train Acc: 0.8163
 Site-Painting                 | Train Loss: 0.5468 | Train Acc: 0.8689
 Site-Painting                 | Train Loss: 0.5321 | Train Acc: 0.8858
 Site-Sketch                   | Train Loss: 0.5499 | Train Acc: 0.8482
 Site-Sketch                   | Train Loss: 0.5575 | Train Acc: 0.8202
 Site-QuickDraw                | Train Loss: 0.9259 | Train Acc: 0.7523
 Site-Infograph                | Train Loss: 1.0776 | Train Acc: 0.6453
 Site-Clipart                   (1) | Val  Loss: 0.4629 | Val  Acc: 0.8421
 Site-Clipart                   (1) | Val  Loss: 0.6011 | Val  Acc: 0.8131
 Site-Clipart                   (1) | Val  Loss: 0.5957 | Val  Acc: 0.8467
 Site-Clipart                   (1) | Val  Loss: 0.5949 | Val  Acc: 0.8524
 Site-Clipart                   (1) | Val  Loss: 0.6813 | Val  Acc: 0.8068
 Site-Real                      (2) | Val  Loss: 0.3688 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.3524 | Val  Acc: 0.9492
 Site-Real                      (2) | Val  Loss: 0.3959 | Val  Acc: 0.8970
 Site-Real                      (2) | Val  Loss: 0.3702 | Val  Acc: 0.9394
 Site-Painting                  (4) | Val  Loss: 0.4520 | Val  Acc: 0.8776
 Site-Painting                  (4) | Val  Loss: 0.5173 | Val  Acc: 0.8613
 Site-Painting                  (4) | Val  Loss: 0.5050 | Val  Acc: 0.8646
 Site-Sketch                    (5) | Val  Loss: 0.5577 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.6437 | Val  Acc: 0.7865
 Site-QuickDraw                 (0) | Val  Loss: 0.9883 | Val  Acc: 0.7385
 Site-Infograph                 (3) | Val  Loss: 1.0687 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8453
 Best site-Clipart                  (1)  | Epoch:18 | Val Acc: 0.8421
 Best site-Clipart                  (1)  | Epoch:18 | Val Acc: 0.8131
 Best site-Clipart                  (1)  | Epoch:18 | Val Acc: 0.8467
 Best site-Clipart                  (1)  | Epoch:18 | Val Acc: 0.8524
 Best site-Clipart                  (1)  | Epoch:18 | Val Acc: 0.8068
 Best site-Real                     (2)  | Epoch:18 | Val Acc: 0.9286
 Best site-Real                     (2)  | Epoch:18 | Val Acc: 0.9492
 Best site-Real                     (2)  | Epoch:18 | Val Acc: 0.8970
 Best site-Real                     (2)  | Epoch:18 | Val Acc: 0.9394
 Best site-Painting                 (4)  | Epoch:18 | Val Acc: 0.8776
 Best site-Painting                 (4)  | Epoch:18 | Val Acc: 0.8613
 Best site-Painting                 (4)  | Epoch:18 | Val Acc: 0.8646
 Best site-Sketch                   (5)  | Epoch:18 | Val Acc: 0.8346
 Best site-Sketch                   (5)  | Epoch:18 | Val Acc: 0.7865
 Best site-QuickDraw                (0)  | Epoch:18 | Val Acc: 0.7385
 Best site-Infograph                (3)  | Epoch:18 | Val Acc: 0.6859
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 19 ============
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                  | Train Loss: 0.6043 | Train Acc: 0.8348
 Site-Clipart                  | Train Loss: 0.4665 | Train Acc: 0.9193
 Site-Clipart                  | Train Loss: 0.6201 | Train Acc: 0.8311
 Site-Clipart                  | Train Loss: 0.6086 | Train Acc: 0.8323
 Site-Clipart                  | Train Loss: 0.6323 | Train Acc: 0.8235
 Site-Real                     | Train Loss: 0.4705 | Train Acc: 0.8968
 Site-Real                     | Train Loss: 0.3653 | Train Acc: 0.9435
 Site-Real                     | Train Loss: 0.3526 | Train Acc: 0.9274
 Site-Real                     | Train Loss: 0.4291 | Train Acc: 0.9253
 Site-Painting                 | Train Loss: 0.5326 | Train Acc: 0.8299
 Site-Painting                 | Train Loss: 0.4431 | Train Acc: 0.8592
 Site-Painting                 | Train Loss: 0.4858 | Train Acc: 0.8927
 Site-Sketch                   | Train Loss: 0.5512 | Train Acc: 0.8377
 Site-Sketch                   | Train Loss: 0.5868 | Train Acc: 0.8165
 Site-QuickDraw                | Train Loss: 0.9271 | Train Acc: 0.7645
 Site-Infograph                | Train Loss: 1.0524 | Train Acc: 0.6752
 Site-Clipart                   (0) | Val  Loss: 0.4735 | Val  Acc: 0.8289
 Site-Clipart                   (0) | Val  Loss: 0.5947 | Val  Acc: 0.8505
 Site-Clipart                   (0) | Val  Loss: 0.5810 | Val  Acc: 0.8467
 Site-Clipart                   (0) | Val  Loss: 0.6119 | Val  Acc: 0.8286
 Site-Clipart                   (0) | Val  Loss: 0.6803 | Val  Acc: 0.8169
 Site-Real                      (1) | Val  Loss: 0.3613 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.3826 | Val  Acc: 0.9322
 Site-Real                      (1) | Val  Loss: 0.3716 | Val  Acc: 0.9212
 Site-Real                      (1) | Val  Loss: 0.3787 | Val  Acc: 0.9351
 Site-Painting                  (4) | Val  Loss: 0.3780 | Val  Acc: 0.9082
 Site-Painting                  (4) | Val  Loss: 0.5072 | Val  Acc: 0.8321
 Site-Painting                  (4) | Val  Loss: 0.5133 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.5351 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.6372 | Val  Acc: 0.8034
 Site-QuickDraw                 (2) | Val  Loss: 0.9352 | Val  Acc: 0.7661
 Site-Infograph                 (3) | Val  Loss: 1.0714 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8540
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8289
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8505
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8467
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8286
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8169
 Best site-Real                     (1)  | Epoch:19 | Val Acc: 0.9524
 Best site-Real                     (1)  | Epoch:19 | Val Acc: 0.9322
 Best site-Real                     (1)  | Epoch:19 | Val Acc: 0.9212
 Best site-Real                     (1)  | Epoch:19 | Val Acc: 0.9351
 Best site-Painting                 (4)  | Epoch:19 | Val Acc: 0.9082
 Best site-Painting                 (4)  | Epoch:19 | Val Acc: 0.8321
 Best site-Painting                 (4)  | Epoch:19 | Val Acc: 0.8854
 Best site-Sketch                   (5)  | Epoch:19 | Val Acc: 0.8583
 Best site-Sketch                   (5)  | Epoch:19 | Val Acc: 0.8034
 Best site-QuickDraw                (2)  | Epoch:19 | Val Acc: 0.7661
 Best site-Infograph                (3)  | Epoch:19 | Val Acc: 0.6987
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
 Test site-Clipart                   (0)| Epoch:19 | Test Acc: 0.8251
 Test site-Real                      (1)| Epoch:19 | Test Acc: 0.9343
 Test site-Painting                  (4)| Epoch:19 | Test Acc: 0.9063
 Test site-Sketch                    (5)| Epoch:19 | Test Acc: 0.8375
 Test site-QuickDraw                 (2)| Epoch:19 | Test Acc: 0.7240
 Test site-Infograph                 (3)| Epoch:19 | Test Acc: 0.5632
Clipart: 0.8251, Real: 0.9343, Painting: 0.9063, Sketch: 0.8375, QuickDraw: 0.7240, Infograph: 0.5632, 
Average Test Accuracy(group): 0.7984, Average Test Accuracy(individual): 0.8465,
domain CV=0.1561, cluster CV=0.1561, individual CV=0.1102, 
============ Train epoch 20 ============
cnt=[3, 5, 1, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                  | Train Loss: 0.5996 | Train Acc: 0.8348
 Site-Clipart                  | Train Loss: 0.4827 | Train Acc: 0.8758
 Site-Clipart                  | Train Loss: 0.6155 | Train Acc: 0.8178
 Site-Clipart                  | Train Loss: 0.5938 | Train Acc: 0.8259
 Site-Clipart                  | Train Loss: 0.5861 | Train Acc: 0.8439
 Site-Real                     | Train Loss: 0.4525 | Train Acc: 0.8889
 Site-Real                     | Train Loss: 0.3480 | Train Acc: 0.9153
 Site-Real                     | Train Loss: 0.3190 | Train Acc: 0.9476
 Site-Real                     | Train Loss: 0.3772 | Train Acc: 0.9339
 Site-Painting                 | Train Loss: 0.4911 | Train Acc: 0.8844
 Site-Painting                 | Train Loss: 0.4753 | Train Acc: 0.8641
 Site-Painting                 | Train Loss: 0.5091 | Train Acc: 0.8720
 Site-Sketch                   | Train Loss: 0.5307 | Train Acc: 0.8482
 Site-Sketch                   | Train Loss: 0.6654 | Train Acc: 0.8352
 Site-QuickDraw                | Train Loss: 0.9155 | Train Acc: 0.7615
 Site-Infograph                | Train Loss: 1.0446 | Train Acc: 0.6838
 Site-Clipart                   (1) | Val  Loss: 0.4148 | Val  Acc: 0.8947
 Site-Clipart                   (1) | Val  Loss: 0.5551 | Val  Acc: 0.8411
 Site-Clipart                   (1) | Val  Loss: 0.5927 | Val  Acc: 0.8533
 Site-Clipart                   (1) | Val  Loss: 0.5916 | Val  Acc: 0.8286
 Site-Clipart                   (1) | Val  Loss: 0.6526 | Val  Acc: 0.8203
 Site-Real                      (4) | Val  Loss: 0.3818 | Val  Acc: 0.9167
 Site-Real                      (4) | Val  Loss: 0.3562 | Val  Acc: 0.9237
 Site-Real                      (4) | Val  Loss: 0.2991 | Val  Acc: 0.9515
 Site-Real                      (4) | Val  Loss: 0.3604 | Val  Acc: 0.9394
 Site-Painting                  (0) | Val  Loss: 0.3970 | Val  Acc: 0.8980
 Site-Painting                  (0) | Val  Loss: 0.4941 | Val  Acc: 0.8832
 Site-Painting                  (0) | Val  Loss: 0.5106 | Val  Acc: 0.8594
 Site-Sketch                    (3) | Val  Loss: 0.5542 | Val  Acc: 0.8425
 Site-Sketch                    (3) | Val  Loss: 0.5719 | Val  Acc: 0.7978
 Site-QuickDraw                 (2) | Val  Loss: 0.9515 | Val  Acc: 0.7431
 Site-Infograph                 (5) | Val  Loss: 1.0283 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8558
 Best site-Clipart                  (1)  | Epoch:20 | Val Acc: 0.8947
 Best site-Clipart                  (1)  | Epoch:20 | Val Acc: 0.8411
 Best site-Clipart                  (1)  | Epoch:20 | Val Acc: 0.8533
 Best site-Clipart                  (1)  | Epoch:20 | Val Acc: 0.8286
 Best site-Clipart                  (1)  | Epoch:20 | Val Acc: 0.8203
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9167
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9237
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9515
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9394
 Best site-Painting                 (0)  | Epoch:20 | Val Acc: 0.8980
 Best site-Painting                 (0)  | Epoch:20 | Val Acc: 0.8832
 Best site-Painting                 (0)  | Epoch:20 | Val Acc: 0.8594
 Best site-Sketch                   (3)  | Epoch:20 | Val Acc: 0.8425
 Best site-Sketch                   (3)  | Epoch:20 | Val Acc: 0.7978
 Best site-QuickDraw                (2)  | Epoch:20 | Val Acc: 0.7431
 Best site-Infograph                (5)  | Epoch:20 | Val Acc: 0.6987
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 21 ============
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                  | Train Loss: 0.6457 | Train Acc: 0.8000
 Site-Clipart                  | Train Loss: 0.5138 | Train Acc: 0.8696
 Site-Clipart                  | Train Loss: 0.6312 | Train Acc: 0.8178
 Site-Clipart                  | Train Loss: 0.6104 | Train Acc: 0.8038
 Site-Clipart                  | Train Loss: 0.6013 | Train Acc: 0.8258
 Site-Real                     | Train Loss: 0.4300 | Train Acc: 0.9048
 Site-Real                     | Train Loss: 0.3025 | Train Acc: 0.9435
 Site-Real                     | Train Loss: 0.3247 | Train Acc: 0.9355
 Site-Real                     | Train Loss: 0.3777 | Train Acc: 0.9310
 Site-Painting                 | Train Loss: 0.4464 | Train Acc: 0.8503
 Site-Painting                 | Train Loss: 0.5164 | Train Acc: 0.8689
 Site-Painting                 | Train Loss: 0.4520 | Train Acc: 0.8893
 Site-Sketch                   | Train Loss: 0.5432 | Train Acc: 0.8272
 Site-Sketch                   | Train Loss: 0.5244 | Train Acc: 0.8315
 Site-QuickDraw                | Train Loss: 0.8033 | Train Acc: 0.7859
 Site-Infograph                | Train Loss: 1.0352 | Train Acc: 0.6667
 Site-Clipart                   (0) | Val  Loss: 0.4398 | Val  Acc: 0.8553
 Site-Clipart                   (0) | Val  Loss: 0.5360 | Val  Acc: 0.8318
 Site-Clipart                   (0) | Val  Loss: 0.5672 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.5366 | Val  Acc: 0.8429
 Site-Clipart                   (0) | Val  Loss: 0.6571 | Val  Acc: 0.8339
 Site-Real                      (1) | Val  Loss: 0.3291 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.2911 | Val  Acc: 0.9576
 Site-Real                      (1) | Val  Loss: 0.3346 | Val  Acc: 0.9333
 Site-Real                      (1) | Val  Loss: 0.3285 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.3447 | Val  Acc: 0.9082
 Site-Painting                  (4) | Val  Loss: 0.4808 | Val  Acc: 0.8759
 Site-Painting                  (4) | Val  Loss: 0.4630 | Val  Acc: 0.8802
 Site-Sketch                    (5) | Val  Loss: 0.5185 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.6065 | Val  Acc: 0.8034
 Site-QuickDraw                 (2) | Val  Loss: 0.9018 | Val  Acc: 0.7706
 Site-Infograph                 (3) | Val  Loss: 1.0943 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8594
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8553
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8318
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8333
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8429
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8339
 Best site-Real                     (1)  | Epoch:21 | Val Acc: 0.9405
 Best site-Real                     (1)  | Epoch:21 | Val Acc: 0.9576
 Best site-Real                     (1)  | Epoch:21 | Val Acc: 0.9333
 Best site-Real                     (1)  | Epoch:21 | Val Acc: 0.9524
 Best site-Painting                 (4)  | Epoch:21 | Val Acc: 0.9082
 Best site-Painting                 (4)  | Epoch:21 | Val Acc: 0.8759
 Best site-Painting                 (4)  | Epoch:21 | Val Acc: 0.8802
 Best site-Sketch                   (5)  | Epoch:21 | Val Acc: 0.8583
 Best site-Sketch                   (5)  | Epoch:21 | Val Acc: 0.8034
 Best site-QuickDraw                (2)  | Epoch:21 | Val Acc: 0.7706
 Best site-Infograph                (3)  | Epoch:21 | Val Acc: 0.6731
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 22 ============
cnt=[5, 1, 2, 4, 1, 3, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                  | Train Loss: 0.5405 | Train Acc: 0.8348
 Site-Clipart                  | Train Loss: 0.4658 | Train Acc: 0.8820
 Site-Clipart                  | Train Loss: 0.5847 | Train Acc: 0.8400
 Site-Clipart                  | Train Loss: 0.5829 | Train Acc: 0.8323
 Site-Clipart                  | Train Loss: 0.5917 | Train Acc: 0.8439
 Site-Real                     | Train Loss: 0.4468 | Train Acc: 0.8889
 Site-Real                     | Train Loss: 0.3295 | Train Acc: 0.9266
 Site-Real                     | Train Loss: 0.3130 | Train Acc: 0.9355
 Site-Real                     | Train Loss: 0.3715 | Train Acc: 0.9339
 Site-Painting                 | Train Loss: 0.4559 | Train Acc: 0.8571
 Site-Painting                 | Train Loss: 0.4878 | Train Acc: 0.8641
 Site-Painting                 | Train Loss: 0.4739 | Train Acc: 0.8927
 Site-Sketch                   | Train Loss: 0.5478 | Train Acc: 0.8220
 Site-Sketch                   | Train Loss: 0.5169 | Train Acc: 0.8240
 Site-QuickDraw                | Train Loss: 0.8247 | Train Acc: 0.7768
 Site-Infograph                | Train Loss: 0.9590 | Train Acc: 0.6795
 Site-Clipart                   (0) | Val  Loss: 0.4233 | Val  Acc: 0.8289
 Site-Clipart                   (0) | Val  Loss: 0.5361 | Val  Acc: 0.8505
 Site-Clipart                   (0) | Val  Loss: 0.6154 | Val  Acc: 0.8400
 Site-Clipart                   (0) | Val  Loss: 0.5445 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.6333 | Val  Acc: 0.8203
 Site-Real                      (3) | Val  Loss: 0.3208 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3389 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.3321 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.3512 | Val  Acc: 0.9221
 Site-Painting                  (5) | Val  Loss: 0.4029 | Val  Acc: 0.8878
 Site-Painting                  (5) | Val  Loss: 0.4700 | Val  Acc: 0.8905
 Site-Painting                  (5) | Val  Loss: 0.5007 | Val  Acc: 0.8646
 Site-Sketch                    (2) | Val  Loss: 0.5599 | Val  Acc: 0.8346
 Site-Sketch                    (2) | Val  Loss: 0.5961 | Val  Acc: 0.7865
 Site-QuickDraw                 (1) | Val  Loss: 0.9066 | Val  Acc: 0.7569
 Site-Infograph                 (4) | Val  Loss: 1.0205 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8526
============ Train epoch 23 ============
cnt=[1, 4, 5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                  | Train Loss: 0.6164 | Train Acc: 0.8174
 Site-Clipart                  | Train Loss: 0.4500 | Train Acc: 0.8944
 Site-Clipart                  | Train Loss: 0.5891 | Train Acc: 0.8400
 Site-Clipart                  | Train Loss: 0.5623 | Train Acc: 0.8481
 Site-Clipart                  | Train Loss: 0.5991 | Train Acc: 0.8258
 Site-Real                     | Train Loss: 0.4376 | Train Acc: 0.8889
 Site-Real                     | Train Loss: 0.3181 | Train Acc: 0.9548
 Site-Real                     | Train Loss: 0.3217 | Train Acc: 0.9355
 Site-Real                     | Train Loss: 0.3996 | Train Acc: 0.9339
 Site-Painting                 | Train Loss: 0.5746 | Train Acc: 0.8503
 Site-Painting                 | Train Loss: 0.4878 | Train Acc: 0.8738
 Site-Painting                 | Train Loss: 0.4362 | Train Acc: 0.9066
 Site-Sketch                   | Train Loss: 0.5385 | Train Acc: 0.8115
 Site-Sketch                   | Train Loss: 0.5591 | Train Acc: 0.8390
 Site-QuickDraw                | Train Loss: 0.8514 | Train Acc: 0.7920
 Site-Infograph                | Train Loss: 0.9418 | Train Acc: 0.7222
 Site-Clipart                   (2) | Val  Loss: 0.4446 | Val  Acc: 0.8158
 Site-Clipart                   (2) | Val  Loss: 0.5131 | Val  Acc: 0.8598
 Site-Clipart                   (2) | Val  Loss: 0.5904 | Val  Acc: 0.8533
 Site-Clipart                   (2) | Val  Loss: 0.5403 | Val  Acc: 0.8381
 Site-Clipart                   (2) | Val  Loss: 0.6312 | Val  Acc: 0.8169
 Site-Real                      (1) | Val  Loss: 0.3752 | Val  Acc: 0.9286
 Site-Real                      (1) | Val  Loss: 0.3197 | Val  Acc: 0.9322
 Site-Real                      (1) | Val  Loss: 0.3149 | Val  Acc: 0.9333
 Site-Real                      (1) | Val  Loss: 0.3387 | Val  Acc: 0.9394
 Site-Painting                  (5) | Val  Loss: 0.3365 | Val  Acc: 0.9184
 Site-Painting                  (5) | Val  Loss: 0.4142 | Val  Acc: 0.8613
 Site-Painting                  (5) | Val  Loss: 0.4537 | Val  Acc: 0.8958
 Site-Sketch                    (4) | Val  Loss: 0.5461 | Val  Acc: 0.8110
 Site-Sketch                    (4) | Val  Loss: 0.5746 | Val  Acc: 0.8090
 Site-QuickDraw                 (0) | Val  Loss: 0.8882 | Val  Acc: 0.7798
 Site-Infograph                 (3) | Val  Loss: 1.0369 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8549
============ Train epoch 24 ============
cnt=[2, 3, 1, 1, 5, 4, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                  | Train Loss: 0.6027 | Train Acc: 0.8348
 Site-Clipart                  | Train Loss: 0.4487 | Train Acc: 0.8882
 Site-Clipart                  | Train Loss: 0.6248 | Train Acc: 0.8533
 Site-Clipart                  | Train Loss: 0.5731 | Train Acc: 0.8323
 Site-Clipart                  | Train Loss: 0.5698 | Train Acc: 0.8348
 Site-Real                     | Train Loss: 0.4526 | Train Acc: 0.8810
 Site-Real                     | Train Loss: 0.3127 | Train Acc: 0.9435
 Site-Real                     | Train Loss: 0.3267 | Train Acc: 0.9355
 Site-Real                     | Train Loss: 0.3805 | Train Acc: 0.9253
 Site-Painting                 | Train Loss: 0.5290 | Train Acc: 0.8571
 Site-Painting                 | Train Loss: 0.4884 | Train Acc: 0.8738
 Site-Painting                 | Train Loss: 0.4553 | Train Acc: 0.8858
 Site-Sketch                   | Train Loss: 0.5210 | Train Acc: 0.8377
 Site-Sketch                   | Train Loss: 0.5572 | Train Acc: 0.8127
 Site-QuickDraw                | Train Loss: 0.7248 | Train Acc: 0.7829
 Site-Infograph                | Train Loss: 0.9415 | Train Acc: 0.6880
 Site-Clipart                   (4) | Val  Loss: 0.3869 | Val  Acc: 0.8684
 Site-Clipart                   (4) | Val  Loss: 0.5282 | Val  Acc: 0.8318
 Site-Clipart                   (4) | Val  Loss: 0.5284 | Val  Acc: 0.8600
 Site-Clipart                   (4) | Val  Loss: 0.5253 | Val  Acc: 0.8619
 Site-Clipart                   (4) | Val  Loss: 0.6102 | Val  Acc: 0.8068
 Site-Real                      (5) | Val  Loss: 0.3523 | Val  Acc: 0.9286
 Site-Real                      (5) | Val  Loss: 0.3126 | Val  Acc: 0.9407
 Site-Real                      (5) | Val  Loss: 0.2950 | Val  Acc: 0.9394
 Site-Real                      (5) | Val  Loss: 0.3250 | Val  Acc: 0.9351
 Site-Painting                  (1) | Val  Loss: 0.3059 | Val  Acc: 0.9388
 Site-Painting                  (1) | Val  Loss: 0.4296 | Val  Acc: 0.8759
 Site-Painting                  (1) | Val  Loss: 0.4390 | Val  Acc: 0.8802
 Site-Sketch                    (0) | Val  Loss: 0.5257 | Val  Acc: 0.8504
 Site-Sketch                    (0) | Val  Loss: 0.5631 | Val  Acc: 0.8258
 Site-QuickDraw                 (2) | Val  Loss: 0.9000 | Val  Acc: 0.7752
 Site-Infograph                 (3) | Val  Loss: 1.0152 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8648
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8684
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8318
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8600
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8619
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8068
 Best site-Real                     (5)  | Epoch:24 | Val Acc: 0.9286
 Best site-Real                     (5)  | Epoch:24 | Val Acc: 0.9407
 Best site-Real                     (5)  | Epoch:24 | Val Acc: 0.9394
 Best site-Real                     (5)  | Epoch:24 | Val Acc: 0.9351
 Best site-Painting                 (1)  | Epoch:24 | Val Acc: 0.9388
 Best site-Painting                 (1)  | Epoch:24 | Val Acc: 0.8759
 Best site-Painting                 (1)  | Epoch:24 | Val Acc: 0.8802
 Best site-Sketch                   (0)  | Epoch:24 | Val Acc: 0.8504
 Best site-Sketch                   (0)  | Epoch:24 | Val Acc: 0.8258
 Best site-QuickDraw                (2)  | Epoch:24 | Val Acc: 0.7752
 Best site-Infograph                (3)  | Epoch:24 | Val Acc: 0.7179
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 25 ============
cnt=[1, 5, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                  | Train Loss: 0.5418 | Train Acc: 0.8609
 Site-Clipart                  | Train Loss: 0.4207 | Train Acc: 0.8944
 Site-Clipart                  | Train Loss: 0.5593 | Train Acc: 0.8578
 Site-Clipart                  | Train Loss: 0.5531 | Train Acc: 0.8354
 Site-Clipart                  | Train Loss: 0.5660 | Train Acc: 0.8281
 Site-Real                     | Train Loss: 0.4423 | Train Acc: 0.8968
 Site-Real                     | Train Loss: 0.2863 | Train Acc: 0.9492
 Site-Real                     | Train Loss: 0.2897 | Train Acc: 0.9476
 Site-Real                     | Train Loss: 0.3254 | Train Acc: 0.9310
 Site-Painting                 | Train Loss: 0.5083 | Train Acc: 0.8776
 Site-Painting                 | Train Loss: 0.4628 | Train Acc: 0.8641
 Site-Painting                 | Train Loss: 0.4132 | Train Acc: 0.8962
 Site-Sketch                   | Train Loss: 0.4709 | Train Acc: 0.8586
 Site-Sketch                   | Train Loss: 0.6091 | Train Acc: 0.8277
 Site-QuickDraw                | Train Loss: 0.7515 | Train Acc: 0.7737
 Site-Infograph                | Train Loss: 0.8936 | Train Acc: 0.7393
 Site-Clipart                   (1) | Val  Loss: 0.3830 | Val  Acc: 0.8553
 Site-Clipart                   (1) | Val  Loss: 0.5243 | Val  Acc: 0.8411
 Site-Clipart                   (1) | Val  Loss: 0.5411 | Val  Acc: 0.8600
 Site-Clipart                   (1) | Val  Loss: 0.5312 | Val  Acc: 0.8286
 Site-Clipart                   (1) | Val  Loss: 0.5805 | Val  Acc: 0.8339
 Site-Real                      (2) | Val  Loss: 0.3531 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.3072 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.2970 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.3228 | Val  Acc: 0.9264
 Site-Painting                  (4) | Val  Loss: 0.3429 | Val  Acc: 0.9286
 Site-Painting                  (4) | Val  Loss: 0.4347 | Val  Acc: 0.8978
 Site-Painting                  (4) | Val  Loss: 0.4379 | Val  Acc: 0.8958
 Site-Sketch                    (5) | Val  Loss: 0.5448 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.5938 | Val  Acc: 0.7978
 Site-QuickDraw                 (3) | Val  Loss: 0.8844 | Val  Acc: 0.7752
 Site-Infograph                 (0) | Val  Loss: 1.0155 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8613
============ Train epoch 26 ============
cnt=[3, 5, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                  | Train Loss: 0.5485 | Train Acc: 0.8522
 Site-Clipart                  | Train Loss: 0.4505 | Train Acc: 0.8634
 Site-Clipart                  | Train Loss: 0.5982 | Train Acc: 0.8578
 Site-Clipart                  | Train Loss: 0.5351 | Train Acc: 0.8418
 Site-Clipart                  | Train Loss: 0.5406 | Train Acc: 0.8552
 Site-Real                     | Train Loss: 0.3910 | Train Acc: 0.9048
 Site-Real                     | Train Loss: 0.2873 | Train Acc: 0.9548
 Site-Real                     | Train Loss: 0.3185 | Train Acc: 0.9395
 Site-Real                     | Train Loss: 0.3268 | Train Acc: 0.9397
 Site-Painting                 | Train Loss: 0.4854 | Train Acc: 0.8707
 Site-Painting                 | Train Loss: 0.4677 | Train Acc: 0.8786
 Site-Painting                 | Train Loss: 0.4120 | Train Acc: 0.8893
 Site-Sketch                   | Train Loss: 0.5007 | Train Acc: 0.8534
 Site-Sketch                   | Train Loss: 0.5118 | Train Acc: 0.8502
 Site-QuickDraw                | Train Loss: 0.7470 | Train Acc: 0.7859
 Site-Infograph                | Train Loss: 0.8970 | Train Acc: 0.7137
 Site-Clipart                   (1) | Val  Loss: 0.3647 | Val  Acc: 0.8684
 Site-Clipart                   (1) | Val  Loss: 0.5198 | Val  Acc: 0.8598
 Site-Clipart                   (1) | Val  Loss: 0.5141 | Val  Acc: 0.8467
 Site-Clipart                   (1) | Val  Loss: 0.5109 | Val  Acc: 0.8429
 Site-Clipart                   (1) | Val  Loss: 0.5594 | Val  Acc: 0.8610
 Site-Real                      (3) | Val  Loss: 0.3120 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2974 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2943 | Val  Acc: 0.9273
 Site-Real                      (3) | Val  Loss: 0.3176 | Val  Acc: 0.9351
 Site-Painting                  (0) | Val  Loss: 0.3220 | Val  Acc: 0.9286
 Site-Painting                  (0) | Val  Loss: 0.3984 | Val  Acc: 0.8832
 Site-Painting                  (0) | Val  Loss: 0.4325 | Val  Acc: 0.8958
 Site-Sketch                    (5) | Val  Loss: 0.4721 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.5553 | Val  Acc: 0.8202
 Site-QuickDraw                 (2) | Val  Loss: 0.8014 | Val  Acc: 0.7844
 Site-Infograph                 (4) | Val  Loss: 0.9843 | Val  Acc: 0.7372
Average Valid Accuracy: 0.8706
 Best site-Clipart                  (1)  | Epoch:26 | Val Acc: 0.8684
 Best site-Clipart                  (1)  | Epoch:26 | Val Acc: 0.8598
 Best site-Clipart                  (1)  | Epoch:26 | Val Acc: 0.8467
 Best site-Clipart                  (1)  | Epoch:26 | Val Acc: 0.8429
 Best site-Clipart                  (1)  | Epoch:26 | Val Acc: 0.8610
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9322
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9273
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9351
 Best site-Painting                 (0)  | Epoch:26 | Val Acc: 0.9286
 Best site-Painting                 (0)  | Epoch:26 | Val Acc: 0.8832
 Best site-Painting                 (0)  | Epoch:26 | Val Acc: 0.8958
 Best site-Sketch                   (5)  | Epoch:26 | Val Acc: 0.8661
 Best site-Sketch                   (5)  | Epoch:26 | Val Acc: 0.8202
 Best site-QuickDraw                (2)  | Epoch:26 | Val Acc: 0.7844
 Best site-Infograph                (4)  | Epoch:26 | Val Acc: 0.7372
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 27 ============
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                  | Train Loss: 0.5974 | Train Acc: 0.8174
 Site-Clipart                  | Train Loss: 0.4478 | Train Acc: 0.8820
 Site-Clipart                  | Train Loss: 0.5831 | Train Acc: 0.8400
 Site-Clipart                  | Train Loss: 0.5504 | Train Acc: 0.8513
 Site-Clipart                  | Train Loss: 0.5427 | Train Acc: 0.8507
 Site-Real                     | Train Loss: 0.4193 | Train Acc: 0.9048
 Site-Real                     | Train Loss: 0.2720 | Train Acc: 0.9492
 Site-Real                     | Train Loss: 0.2771 | Train Acc: 0.9516
 Site-Real                     | Train Loss: 0.3379 | Train Acc: 0.9310
 Site-Painting                 | Train Loss: 0.4341 | Train Acc: 0.8707
 Site-Painting                 | Train Loss: 0.4653 | Train Acc: 0.8835
 Site-Painting                 | Train Loss: 0.4048 | Train Acc: 0.9031
 Site-Sketch                   | Train Loss: 0.4521 | Train Acc: 0.8691
 Site-Sketch                   | Train Loss: 0.5035 | Train Acc: 0.8315
 Site-QuickDraw                | Train Loss: 0.8252 | Train Acc: 0.7615
 Site-Infograph                | Train Loss: 0.8934 | Train Acc: 0.7137
 Site-Clipart                   (0) | Val  Loss: 0.3919 | Val  Acc: 0.8816
 Site-Clipart                   (0) | Val  Loss: 0.5059 | Val  Acc: 0.8692
 Site-Clipart                   (0) | Val  Loss: 0.5418 | Val  Acc: 0.8533
 Site-Clipart                   (0) | Val  Loss: 0.5371 | Val  Acc: 0.8238
 Site-Clipart                   (0) | Val  Loss: 0.5858 | Val  Acc: 0.8475
 Site-Real                      (1) | Val  Loss: 0.2979 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.2733 | Val  Acc: 0.9661
 Site-Real                      (1) | Val  Loss: 0.2928 | Val  Acc: 0.9333
 Site-Real                      (1) | Val  Loss: 0.3292 | Val  Acc: 0.9351
 Site-Painting                  (5) | Val  Loss: 0.3196 | Val  Acc: 0.9184
 Site-Painting                  (5) | Val  Loss: 0.3765 | Val  Acc: 0.9051
 Site-Painting                  (5) | Val  Loss: 0.4372 | Val  Acc: 0.8958
 Site-Sketch                    (4) | Val  Loss: 0.4381 | Val  Acc: 0.9055
 Site-Sketch                    (4) | Val  Loss: 0.5705 | Val  Acc: 0.8034
 Site-QuickDraw                 (2) | Val  Loss: 0.8412 | Val  Acc: 0.7661
 Site-Infograph                 (3) | Val  Loss: 0.9848 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8719
 Best site-Clipart                  (0)  | Epoch:27 | Val Acc: 0.8816
 Best site-Clipart                  (0)  | Epoch:27 | Val Acc: 0.8692
 Best site-Clipart                  (0)  | Epoch:27 | Val Acc: 0.8533
 Best site-Clipart                  (0)  | Epoch:27 | Val Acc: 0.8238
 Best site-Clipart                  (0)  | Epoch:27 | Val Acc: 0.8475
 Best site-Real                     (1)  | Epoch:27 | Val Acc: 0.9405
 Best site-Real                     (1)  | Epoch:27 | Val Acc: 0.9661
 Best site-Real                     (1)  | Epoch:27 | Val Acc: 0.9333
 Best site-Real                     (1)  | Epoch:27 | Val Acc: 0.9351
 Best site-Painting                 (5)  | Epoch:27 | Val Acc: 0.9184
 Best site-Painting                 (5)  | Epoch:27 | Val Acc: 0.9051
 Best site-Painting                 (5)  | Epoch:27 | Val Acc: 0.8958
 Best site-Sketch                   (4)  | Epoch:27 | Val Acc: 0.9055
 Best site-Sketch                   (4)  | Epoch:27 | Val Acc: 0.8034
 Best site-QuickDraw                (2)  | Epoch:27 | Val Acc: 0.7661
 Best site-Infograph                (3)  | Epoch:27 | Val Acc: 0.7051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 28 ============
cnt=[5, 1, 3, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                  | Train Loss: 0.5174 | Train Acc: 0.8609
 Site-Clipart                  | Train Loss: 0.4438 | Train Acc: 0.8758
 Site-Clipart                  | Train Loss: 0.5879 | Train Acc: 0.8311
 Site-Clipart                  | Train Loss: 0.5373 | Train Acc: 0.8576
 Site-Clipart                  | Train Loss: 0.5272 | Train Acc: 0.8371
 Site-Real                     | Train Loss: 0.4101 | Train Acc: 0.8968
 Site-Real                     | Train Loss: 0.2691 | Train Acc: 0.9661
 Site-Real                     | Train Loss: 0.2992 | Train Acc: 0.9476
 Site-Real                     | Train Loss: 0.3534 | Train Acc: 0.9253
 Site-Painting                 | Train Loss: 0.4726 | Train Acc: 0.8639
 Site-Painting                 | Train Loss: 0.4719 | Train Acc: 0.8883
 Site-Painting                 | Train Loss: 0.3757 | Train Acc: 0.9100
 Site-Sketch                   | Train Loss: 0.4969 | Train Acc: 0.8534
 Site-Sketch                   | Train Loss: 0.5500 | Train Acc: 0.8315
 Site-QuickDraw                | Train Loss: 0.7099 | Train Acc: 0.8012
 Site-Infograph                | Train Loss: 0.8965 | Train Acc: 0.7009
 Site-Clipart                   (0) | Val  Loss: 0.3726 | Val  Acc: 0.8816
 Site-Clipart                   (0) | Val  Loss: 0.4725 | Val  Acc: 0.8505
 Site-Clipart                   (0) | Val  Loss: 0.5005 | Val  Acc: 0.8467
 Site-Clipart                   (0) | Val  Loss: 0.5291 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.5878 | Val  Acc: 0.8339
 Site-Real                      (3) | Val  Loss: 0.3277 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3133 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2982 | Val  Acc: 0.9091
 Site-Real                      (3) | Val  Loss: 0.2877 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.3142 | Val  Acc: 0.9082
 Site-Painting                  (2) | Val  Loss: 0.3704 | Val  Acc: 0.9051
 Site-Painting                  (2) | Val  Loss: 0.3924 | Val  Acc: 0.8802
 Site-Sketch                    (5) | Val  Loss: 0.4416 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.5538 | Val  Acc: 0.7809
 Site-QuickDraw                 (1) | Val  Loss: 0.8028 | Val  Acc: 0.7798
 Site-Infograph                 (4) | Val  Loss: 0.9628 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8643
============ Train epoch 29 ============
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                  | Train Loss: 0.6059 | Train Acc: 0.8261
 Site-Clipart                  | Train Loss: 0.4159 | Train Acc: 0.8944
 Site-Clipart                  | Train Loss: 0.5365 | Train Acc: 0.8578
 Site-Clipart                  | Train Loss: 0.5332 | Train Acc: 0.8639
 Site-Clipart                  | Train Loss: 0.5268 | Train Acc: 0.8371
 Site-Real                     | Train Loss: 0.4388 | Train Acc: 0.8810
 Site-Real                     | Train Loss: 0.2690 | Train Acc: 0.9492
 Site-Real                     | Train Loss: 0.2888 | Train Acc: 0.9476
 Site-Real                     | Train Loss: 0.3389 | Train Acc: 0.9310
 Site-Painting                 | Train Loss: 0.4161 | Train Acc: 0.8639
 Site-Painting                 | Train Loss: 0.4146 | Train Acc: 0.8641
 Site-Painting                 | Train Loss: 0.3814 | Train Acc: 0.8997
 Site-Sketch                   | Train Loss: 0.4519 | Train Acc: 0.8691
 Site-Sketch                   | Train Loss: 0.5081 | Train Acc: 0.8390
 Site-QuickDraw                | Train Loss: 0.7476 | Train Acc: 0.8012
 Site-Infograph                | Train Loss: 0.8599 | Train Acc: 0.7222
 Site-Clipart                   (0) | Val  Loss: 0.3594 | Val  Acc: 0.8684
 Site-Clipart                   (0) | Val  Loss: 0.4689 | Val  Acc: 0.8505
 Site-Clipart                   (0) | Val  Loss: 0.5316 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.5228 | Val  Acc: 0.8381
 Site-Clipart                   (0) | Val  Loss: 0.5677 | Val  Acc: 0.8237
 Site-Real                      (1) | Val  Loss: 0.3142 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.2817 | Val  Acc: 0.9746
 Site-Real                      (1) | Val  Loss: 0.2941 | Val  Acc: 0.9455
 Site-Real                      (1) | Val  Loss: 0.3076 | Val  Acc: 0.9264
 Site-Painting                  (5) | Val  Loss: 0.3082 | Val  Acc: 0.9082
 Site-Painting                  (5) | Val  Loss: 0.4049 | Val  Acc: 0.8613
 Site-Painting                  (5) | Val  Loss: 0.4202 | Val  Acc: 0.8854
 Site-Sketch                    (4) | Val  Loss: 0.4644 | Val  Acc: 0.8819
 Site-Sketch                    (4) | Val  Loss: 0.5933 | Val  Acc: 0.8146
 Site-QuickDraw                 (2) | Val  Loss: 0.7967 | Val  Acc: 0.7752
 Site-Infograph                 (3) | Val  Loss: 0.9858 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8633
============ Train epoch 30 ============
cnt=[1, 4, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                  | Train Loss: 0.5376 | Train Acc: 0.8522
 Site-Clipart                  | Train Loss: 0.4082 | Train Acc: 0.8882
 Site-Clipart                  | Train Loss: 0.5179 | Train Acc: 0.8711
 Site-Clipart                  | Train Loss: 0.5231 | Train Acc: 0.8481
 Site-Clipart                  | Train Loss: 0.5072 | Train Acc: 0.8484
 Site-Real                     | Train Loss: 0.4200 | Train Acc: 0.8968
 Site-Real                     | Train Loss: 0.2778 | Train Acc: 0.9379
 Site-Real                     | Train Loss: 0.2980 | Train Acc: 0.9315
 Site-Real                     | Train Loss: 0.3212 | Train Acc: 0.9339
 Site-Painting                 | Train Loss: 0.4474 | Train Acc: 0.8503
 Site-Painting                 | Train Loss: 0.4145 | Train Acc: 0.8786
 Site-Painting                 | Train Loss: 0.3930 | Train Acc: 0.9066
 Site-Sketch                   | Train Loss: 0.4763 | Train Acc: 0.8639
 Site-Sketch                   | Train Loss: 0.5723 | Train Acc: 0.8277
 Site-QuickDraw                | Train Loss: 0.7718 | Train Acc: 0.8196
 Site-Infograph                | Train Loss: 0.8199 | Train Acc: 0.7479
 Site-Clipart                   (2) | Val  Loss: 0.3649 | Val  Acc: 0.8816
 Site-Clipart                   (2) | Val  Loss: 0.4803 | Val  Acc: 0.8411
 Site-Clipart                   (2) | Val  Loss: 0.5250 | Val  Acc: 0.8533
 Site-Clipart                   (2) | Val  Loss: 0.5061 | Val  Acc: 0.8286
 Site-Clipart                   (2) | Val  Loss: 0.5883 | Val  Acc: 0.8441
 Site-Real                      (1) | Val  Loss: 0.3120 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.3298 | Val  Acc: 0.9407
 Site-Real                      (1) | Val  Loss: 0.2749 | Val  Acc: 0.9515
 Site-Real                      (1) | Val  Loss: 0.3102 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.3211 | Val  Acc: 0.9286
 Site-Painting                  (4) | Val  Loss: 0.4357 | Val  Acc: 0.8759
 Site-Painting                  (4) | Val  Loss: 0.4019 | Val  Acc: 0.8802
 Site-Sketch                    (5) | Val  Loss: 0.4371 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.5559 | Val  Acc: 0.8034
 Site-QuickDraw                 (0) | Val  Loss: 0.7865 | Val  Acc: 0.7752
 Site-Infograph                 (3) | Val  Loss: 0.9708 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8698
============ Train epoch 31 ============
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                  | Train Loss: 0.5585 | Train Acc: 0.8087
 Site-Clipart                  | Train Loss: 0.3756 | Train Acc: 0.9006
 Site-Clipart                  | Train Loss: 0.5129 | Train Acc: 0.8578
 Site-Clipart                  | Train Loss: 0.5171 | Train Acc: 0.8671
 Site-Clipart                  | Train Loss: 0.5184 | Train Acc: 0.8643
 Site-Real                     | Train Loss: 0.4155 | Train Acc: 0.8968
 Site-Real                     | Train Loss: 0.2472 | Train Acc: 0.9605
 Site-Real                     | Train Loss: 0.2838 | Train Acc: 0.9435
 Site-Real                     | Train Loss: 0.3170 | Train Acc: 0.9368
 Site-Painting                 | Train Loss: 0.4615 | Train Acc: 0.8571
 Site-Painting                 | Train Loss: 0.3969 | Train Acc: 0.8835
 Site-Painting                 | Train Loss: 0.4165 | Train Acc: 0.8997
 Site-Sketch                   | Train Loss: 0.4488 | Train Acc: 0.8639
 Site-Sketch                   | Train Loss: 0.4489 | Train Acc: 0.8539
 Site-QuickDraw                | Train Loss: 0.7230 | Train Acc: 0.8349
 Site-Infograph                | Train Loss: 0.8222 | Train Acc: 0.7479
 Site-Clipart                   (0) | Val  Loss: 0.3853 | Val  Acc: 0.8684
 Site-Clipart                   (0) | Val  Loss: 0.4471 | Val  Acc: 0.8598
 Site-Clipart                   (0) | Val  Loss: 0.4951 | Val  Acc: 0.8800
 Site-Clipart                   (0) | Val  Loss: 0.4756 | Val  Acc: 0.8619
 Site-Clipart                   (0) | Val  Loss: 0.5897 | Val  Acc: 0.8407
 Site-Real                      (2) | Val  Loss: 0.2895 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.2778 | Val  Acc: 0.9576
 Site-Real                      (2) | Val  Loss: 0.2712 | Val  Acc: 0.9455
 Site-Real                      (2) | Val  Loss: 0.2830 | Val  Acc: 0.9524
 Site-Painting                  (3) | Val  Loss: 0.2958 | Val  Acc: 0.9184
 Site-Painting                  (3) | Val  Loss: 0.3481 | Val  Acc: 0.8832
 Site-Painting                  (3) | Val  Loss: 0.4210 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.4282 | Val  Acc: 0.8740
 Site-Sketch                    (5) | Val  Loss: 0.5148 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 0.7903 | Val  Acc: 0.7890
 Site-Infograph                 (4) | Val  Loss: 0.9187 | Val  Acc: 0.7308
Average Valid Accuracy: 0.8751
 Best site-Clipart                  (0)  | Epoch:31 | Val Acc: 0.8684
 Best site-Clipart                  (0)  | Epoch:31 | Val Acc: 0.8598
 Best site-Clipart                  (0)  | Epoch:31 | Val Acc: 0.8800
 Best site-Clipart                  (0)  | Epoch:31 | Val Acc: 0.8619
 Best site-Clipart                  (0)  | Epoch:31 | Val Acc: 0.8407
 Best site-Real                     (2)  | Epoch:31 | Val Acc: 0.9286
 Best site-Real                     (2)  | Epoch:31 | Val Acc: 0.9576
 Best site-Real                     (2)  | Epoch:31 | Val Acc: 0.9455
 Best site-Real                     (2)  | Epoch:31 | Val Acc: 0.9524
 Best site-Painting                 (3)  | Epoch:31 | Val Acc: 0.9184
 Best site-Painting                 (3)  | Epoch:31 | Val Acc: 0.8832
 Best site-Painting                 (3)  | Epoch:31 | Val Acc: 0.8854
 Best site-Sketch                   (5)  | Epoch:31 | Val Acc: 0.8740
 Best site-Sketch                   (5)  | Epoch:31 | Val Acc: 0.8258
 Best site-QuickDraw                (1)  | Epoch:31 | Val Acc: 0.7890
 Best site-Infograph                (4)  | Epoch:31 | Val Acc: 0.7308
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 32 ============
cnt=[3, 1, 5, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                  | Train Loss: 0.5592 | Train Acc: 0.8261
 Site-Clipart                  | Train Loss: 0.3617 | Train Acc: 0.9130
 Site-Clipart                  | Train Loss: 0.5207 | Train Acc: 0.8578
 Site-Clipart                  | Train Loss: 0.5096 | Train Acc: 0.8544
 Site-Clipart                  | Train Loss: 0.5238 | Train Acc: 0.8507
 Site-Real                     | Train Loss: 0.3777 | Train Acc: 0.8968
 Site-Real                     | Train Loss: 0.2496 | Train Acc: 0.9435
 Site-Real                     | Train Loss: 0.2798 | Train Acc: 0.9395
 Site-Real                     | Train Loss: 0.3170 | Train Acc: 0.9310
 Site-Painting                 | Train Loss: 0.4558 | Train Acc: 0.8707
 Site-Painting                 | Train Loss: 0.3367 | Train Acc: 0.9078
 Site-Painting                 | Train Loss: 0.3901 | Train Acc: 0.8720
 Site-Sketch                   | Train Loss: 0.4587 | Train Acc: 0.8586
 Site-Sketch                   | Train Loss: 0.4897 | Train Acc: 0.8577
 Site-QuickDraw                | Train Loss: 0.7559 | Train Acc: 0.8135
 Site-Infograph                | Train Loss: 0.8395 | Train Acc: 0.7607
 Site-Clipart                   (2) | Val  Loss: 0.3830 | Val  Acc: 0.8816
 Site-Clipart                   (2) | Val  Loss: 0.4246 | Val  Acc: 0.8879
 Site-Clipart                   (2) | Val  Loss: 0.5023 | Val  Acc: 0.8200
 Site-Clipart                   (2) | Val  Loss: 0.5131 | Val  Acc: 0.8333
 Site-Clipart                   (2) | Val  Loss: 0.5232 | Val  Acc: 0.8576
 Site-Real                      (3) | Val  Loss: 0.2881 | Val  Acc: 0.9643
 Site-Real                      (3) | Val  Loss: 0.2763 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.2572 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.2636 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3052 | Val  Acc: 0.9286
 Site-Painting                  (0) | Val  Loss: 0.3843 | Val  Acc: 0.8978
 Site-Painting                  (0) | Val  Loss: 0.3819 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.4316 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.5056 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.8239 | Val  Acc: 0.7890
 Site-Infograph                 (4) | Val  Loss: 0.9444 | Val  Acc: 0.7372
Average Valid Accuracy: 0.8771
 Best site-Clipart                  (2)  | Epoch:32 | Val Acc: 0.8816
 Best site-Clipart                  (2)  | Epoch:32 | Val Acc: 0.8879
 Best site-Clipart                  (2)  | Epoch:32 | Val Acc: 0.8200
 Best site-Clipart                  (2)  | Epoch:32 | Val Acc: 0.8333
 Best site-Clipart                  (2)  | Epoch:32 | Val Acc: 0.8576
 Best site-Real                     (3)  | Epoch:32 | Val Acc: 0.9643
 Best site-Real                     (3)  | Epoch:32 | Val Acc: 0.9407
 Best site-Real                     (3)  | Epoch:32 | Val Acc: 0.9333
 Best site-Real                     (3)  | Epoch:32 | Val Acc: 0.9524
 Best site-Painting                 (0)  | Epoch:32 | Val Acc: 0.9286
 Best site-Painting                 (0)  | Epoch:32 | Val Acc: 0.8978
 Best site-Painting                 (0)  | Epoch:32 | Val Acc: 0.9062
 Best site-Sketch                   (5)  | Epoch:32 | Val Acc: 0.8898
 Best site-Sketch                   (5)  | Epoch:32 | Val Acc: 0.8146
 Best site-QuickDraw                (1)  | Epoch:32 | Val Acc: 0.7890
 Best site-Infograph                (4)  | Epoch:32 | Val Acc: 0.7372
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 33 ============
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                  | Train Loss: 0.5116 | Train Acc: 0.8522
 Site-Clipart                  | Train Loss: 0.3737 | Train Acc: 0.8634
 Site-Clipart                  | Train Loss: 0.5392 | Train Acc: 0.8400
 Site-Clipart                  | Train Loss: 0.5165 | Train Acc: 0.8418
 Site-Clipart                  | Train Loss: 0.4717 | Train Acc: 0.8869
 Site-Real                     | Train Loss: 0.3802 | Train Acc: 0.8889
 Site-Real                     | Train Loss: 0.2293 | Train Acc: 0.9661
 Site-Real                     | Train Loss: 0.2605 | Train Acc: 0.9435
 Site-Real                     | Train Loss: 0.3230 | Train Acc: 0.9339
 Site-Painting                 | Train Loss: 0.4170 | Train Acc: 0.8707
 Site-Painting                 | Train Loss: 0.3800 | Train Acc: 0.8932
 Site-Painting                 | Train Loss: 0.3648 | Train Acc: 0.9239
 Site-Sketch                   | Train Loss: 0.4714 | Train Acc: 0.8534
 Site-Sketch                   | Train Loss: 0.4197 | Train Acc: 0.8652
 Site-QuickDraw                | Train Loss: 0.6893 | Train Acc: 0.8196
 Site-Infograph                | Train Loss: 0.7876 | Train Acc: 0.7521
 Site-Clipart                   (1) | Val  Loss: 0.3426 | Val  Acc: 0.8816
 Site-Clipart                   (1) | Val  Loss: 0.4746 | Val  Acc: 0.8598
 Site-Clipart                   (1) | Val  Loss: 0.4334 | Val  Acc: 0.8667
 Site-Clipart                   (1) | Val  Loss: 0.4974 | Val  Acc: 0.8571
 Site-Clipart                   (1) | Val  Loss: 0.5673 | Val  Acc: 0.8373
 Site-Real                      (0) | Val  Loss: 0.2852 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.2536 | Val  Acc: 0.9492
 Site-Real                      (0) | Val  Loss: 0.2544 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2963 | Val  Acc: 0.9394
 Site-Painting                  (4) | Val  Loss: 0.2817 | Val  Acc: 0.9082
 Site-Painting                  (4) | Val  Loss: 0.3344 | Val  Acc: 0.8832
 Site-Painting                  (4) | Val  Loss: 0.4020 | Val  Acc: 0.8802
 Site-Sketch                    (5) | Val  Loss: 0.4102 | Val  Acc: 0.8740
 Site-Sketch                    (5) | Val  Loss: 0.5360 | Val  Acc: 0.8090
 Site-QuickDraw                 (2) | Val  Loss: 0.7425 | Val  Acc: 0.8028
 Site-Infograph                 (3) | Val  Loss: 0.9448 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8697
============ Train epoch 34 ============
cnt=[3, 5, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                  | Train Loss: 0.4852 | Train Acc: 0.8696
 Site-Clipart                  | Train Loss: 0.3936 | Train Acc: 0.8758
 Site-Clipart                  | Train Loss: 0.5101 | Train Acc: 0.8489
 Site-Clipart                  | Train Loss: 0.4724 | Train Acc: 0.8734
 Site-Clipart                  | Train Loss: 0.4787 | Train Acc: 0.8733
 Site-Real                     | Train Loss: 0.3742 | Train Acc: 0.9127
 Site-Real                     | Train Loss: 0.2507 | Train Acc: 0.9492
 Site-Real                     | Train Loss: 0.2701 | Train Acc: 0.9355
 Site-Real                     | Train Loss: 0.2911 | Train Acc: 0.9368
 Site-Painting                 | Train Loss: 0.3851 | Train Acc: 0.8844
 Site-Painting                 | Train Loss: 0.3935 | Train Acc: 0.8883
 Site-Painting                 | Train Loss: 0.3606 | Train Acc: 0.9031
 Site-Sketch                   | Train Loss: 0.4296 | Train Acc: 0.8796
 Site-Sketch                   | Train Loss: 0.5242 | Train Acc: 0.8577
 Site-QuickDraw                | Train Loss: 0.6565 | Train Acc: 0.7859
 Site-Infograph                | Train Loss: 0.8096 | Train Acc: 0.7393
 Site-Clipart                   (1) | Val  Loss: 0.3027 | Val  Acc: 0.8816
 Site-Clipart                   (1) | Val  Loss: 0.4305 | Val  Acc: 0.8692
 Site-Clipart                   (1) | Val  Loss: 0.4312 | Val  Acc: 0.8667
 Site-Clipart                   (1) | Val  Loss: 0.4937 | Val  Acc: 0.8571
 Site-Clipart                   (1) | Val  Loss: 0.5380 | Val  Acc: 0.8339
 Site-Real                      (3) | Val  Loss: 0.2726 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3053 | Val  Acc: 0.9153
 Site-Real                      (3) | Val  Loss: 0.2394 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.2599 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.2725 | Val  Acc: 0.9286
 Site-Painting                  (0) | Val  Loss: 0.3719 | Val  Acc: 0.8759
 Site-Painting                  (0) | Val  Loss: 0.3737 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.4121 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.5031 | Val  Acc: 0.8090
 Site-QuickDraw                 (2) | Val  Loss: 0.8170 | Val  Acc: 0.7615
 Site-Infograph                 (4) | Val  Loss: 0.9519 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8693
============ Train epoch 35 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                  | Train Loss: 0.5099 | Train Acc: 0.8783
 Site-Clipart                  | Train Loss: 0.3582 | Train Acc: 0.9317
 Site-Clipart                  | Train Loss: 0.4447 | Train Acc: 0.8578
 Site-Clipart                  | Train Loss: 0.4916 | Train Acc: 0.8576
 Site-Clipart                  | Train Loss: 0.4676 | Train Acc: 0.8801
 Site-Real                     | Train Loss: 0.3830 | Train Acc: 0.8968
 Site-Real                     | Train Loss: 0.2612 | Train Acc: 0.9435
 Site-Real                     | Train Loss: 0.2578 | Train Acc: 0.9476
 Site-Real                     | Train Loss: 0.3056 | Train Acc: 0.9425
 Site-Painting                 | Train Loss: 0.3981 | Train Acc: 0.8776
 Site-Painting                 | Train Loss: 0.3644 | Train Acc: 0.8981
 Site-Painting                 | Train Loss: 0.3575 | Train Acc: 0.9377
 Site-Sketch                   | Train Loss: 0.3990 | Train Acc: 0.9058
 Site-Sketch                   | Train Loss: 0.4750 | Train Acc: 0.8390
 Site-QuickDraw                | Train Loss: 0.6206 | Train Acc: 0.8165
 Site-Infograph                | Train Loss: 0.7586 | Train Acc: 0.7735
 Site-Clipart                   (0) | Val  Loss: 0.3440 | Val  Acc: 0.9211
 Site-Clipart                   (0) | Val  Loss: 0.4286 | Val  Acc: 0.8785
 Site-Clipart                   (0) | Val  Loss: 0.4972 | Val  Acc: 0.8467
 Site-Clipart                   (0) | Val  Loss: 0.4561 | Val  Acc: 0.8857
 Site-Clipart                   (0) | Val  Loss: 0.5428 | Val  Acc: 0.8271
 Site-Real                      (1) | Val  Loss: 0.2956 | Val  Acc: 0.9286
 Site-Real                      (1) | Val  Loss: 0.2777 | Val  Acc: 0.9322
 Site-Real                      (1) | Val  Loss: 0.2636 | Val  Acc: 0.9333
 Site-Real                      (1) | Val  Loss: 0.2704 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.3062 | Val  Acc: 0.9082
 Site-Painting                  (3) | Val  Loss: 0.3323 | Val  Acc: 0.9124
 Site-Painting                  (3) | Val  Loss: 0.3749 | Val  Acc: 0.8958
 Site-Sketch                    (5) | Val  Loss: 0.4450 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.5643 | Val  Acc: 0.8090
 Site-QuickDraw                 (2) | Val  Loss: 0.7577 | Val  Acc: 0.8028
 Site-Infograph                 (4) | Val  Loss: 0.9171 | Val  Acc: 0.7244
Average Valid Accuracy: 0.8762
============ Train epoch 36 ============
cnt=[3, 1, 4, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                  | Train Loss: 0.5599 | Train Acc: 0.8435
 Site-Clipart                  | Train Loss: 0.3506 | Train Acc: 0.9006
 Site-Clipart                  | Train Loss: 0.5132 | Train Acc: 0.8578
 Site-Clipart                  | Train Loss: 0.4938 | Train Acc: 0.8671
 Site-Clipart                  | Train Loss: 0.4798 | Train Acc: 0.8529
 Site-Real                     | Train Loss: 0.3778 | Train Acc: 0.9048
 Site-Real                     | Train Loss: 0.2610 | Train Acc: 0.9492
 Site-Real                     | Train Loss: 0.2395 | Train Acc: 0.9516
 Site-Real                     | Train Loss: 0.3204 | Train Acc: 0.9282
 Site-Painting                 | Train Loss: 0.4259 | Train Acc: 0.8435
 Site-Painting                 | Train Loss: 0.4383 | Train Acc: 0.8592
 Site-Painting                 | Train Loss: 0.3577 | Train Acc: 0.8997
 Site-Sketch                   | Train Loss: 0.4601 | Train Acc: 0.8639
 Site-Sketch                   | Train Loss: 0.4729 | Train Acc: 0.8727
 Site-QuickDraw                | Train Loss: 0.7198 | Train Acc: 0.8012
 Site-Infograph                | Train Loss: 0.7231 | Train Acc: 0.7991
 Site-Clipart                   (4) | Val  Loss: 0.3035 | Val  Acc: 0.9211
 Site-Clipart                   (4) | Val  Loss: 0.4449 | Val  Acc: 0.8505
 Site-Clipart                   (4) | Val  Loss: 0.4530 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.4428 | Val  Acc: 0.8714
 Site-Clipart                   (4) | Val  Loss: 0.5256 | Val  Acc: 0.8542
 Site-Real                      (2) | Val  Loss: 0.2853 | Val  Acc: 0.9643
 Site-Real                      (2) | Val  Loss: 0.3119 | Val  Acc: 0.9153
 Site-Real                      (2) | Val  Loss: 0.2646 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.2591 | Val  Acc: 0.9437
 Site-Painting                  (0) | Val  Loss: 0.2560 | Val  Acc: 0.9490
 Site-Painting                  (0) | Val  Loss: 0.3401 | Val  Acc: 0.9124
 Site-Painting                  (0) | Val  Loss: 0.3700 | Val  Acc: 0.8802
 Site-Sketch                    (3) | Val  Loss: 0.4138 | Val  Acc: 0.8583
 Site-Sketch                    (3) | Val  Loss: 0.5082 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.7688 | Val  Acc: 0.7798
 Site-Infograph                 (5) | Val  Loss: 0.8964 | Val  Acc: 0.7244
Average Valid Accuracy: 0.8778
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.9211
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.8505
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.8667
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.8714
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.8542
 Best site-Real                     (2)  | Epoch:36 | Val Acc: 0.9643
 Best site-Real                     (2)  | Epoch:36 | Val Acc: 0.9153
 Best site-Real                     (2)  | Epoch:36 | Val Acc: 0.9333
 Best site-Real                     (2)  | Epoch:36 | Val Acc: 0.9437
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9490
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9124
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.8802
 Best site-Sketch                   (3)  | Epoch:36 | Val Acc: 0.8583
 Best site-Sketch                   (3)  | Epoch:36 | Val Acc: 0.8202
 Best site-QuickDraw                (1)  | Epoch:36 | Val Acc: 0.7798
 Best site-Infograph                (5)  | Epoch:36 | Val Acc: 0.7244
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 37 ============
cnt=[1, 4, 5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                  | Train Loss: 0.4573 | Train Acc: 0.8435
 Site-Clipart                  | Train Loss: 0.4060 | Train Acc: 0.9006
 Site-Clipart                  | Train Loss: 0.5078 | Train Acc: 0.8667
 Site-Clipart                  | Train Loss: 0.4799 | Train Acc: 0.8544
 Site-Clipart                  | Train Loss: 0.4598 | Train Acc: 0.8665
 Site-Real                     | Train Loss: 0.3620 | Train Acc: 0.9206
 Site-Real                     | Train Loss: 0.2508 | Train Acc: 0.9492
 Site-Real                     | Train Loss: 0.2460 | Train Acc: 0.9677
 Site-Real                     | Train Loss: 0.2857 | Train Acc: 0.9339
 Site-Painting                 | Train Loss: 0.3927 | Train Acc: 0.8776
 Site-Painting                 | Train Loss: 0.3891 | Train Acc: 0.8544
 Site-Painting                 | Train Loss: 0.3285 | Train Acc: 0.9239
 Site-Sketch                   | Train Loss: 0.4134 | Train Acc: 0.8953
 Site-Sketch                   | Train Loss: 0.5972 | Train Acc: 0.8352
 Site-QuickDraw                | Train Loss: 0.6610 | Train Acc: 0.8104
 Site-Infograph                | Train Loss: 0.7580 | Train Acc: 0.7436
 Site-Clipart                   (2) | Val  Loss: 0.3124 | Val  Acc: 0.8947
 Site-Clipart                   (2) | Val  Loss: 0.4423 | Val  Acc: 0.8692
 Site-Clipart                   (2) | Val  Loss: 0.4833 | Val  Acc: 0.8400
 Site-Clipart                   (2) | Val  Loss: 0.4352 | Val  Acc: 0.8524
 Site-Clipart                   (2) | Val  Loss: 0.5300 | Val  Acc: 0.8237
 Site-Real                      (1) | Val  Loss: 0.2831 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.2644 | Val  Acc: 0.9576
 Site-Real                      (1) | Val  Loss: 0.2564 | Val  Acc: 0.9455
 Site-Real                      (1) | Val  Loss: 0.2456 | Val  Acc: 0.9481
 Site-Painting                  (5) | Val  Loss: 0.2952 | Val  Acc: 0.9388
 Site-Painting                  (5) | Val  Loss: 0.3296 | Val  Acc: 0.8905
 Site-Painting                  (5) | Val  Loss: 0.3471 | Val  Acc: 0.9115
 Site-Sketch                    (4) | Val  Loss: 0.4026 | Val  Acc: 0.8661
 Site-Sketch                    (4) | Val  Loss: 0.5080 | Val  Acc: 0.8258
 Site-QuickDraw                 (0) | Val  Loss: 0.7200 | Val  Acc: 0.7752
 Site-Infograph                 (3) | Val  Loss: 0.9223 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8748
============ Train epoch 38 ============
cnt=[1, 5, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                  | Train Loss: 0.4823 | Train Acc: 0.8783
 Site-Clipart                  | Train Loss: 0.3724 | Train Acc: 0.9068
 Site-Clipart                  | Train Loss: 0.5007 | Train Acc: 0.8622
 Site-Clipart                  | Train Loss: 0.4493 | Train Acc: 0.8734
 Site-Clipart                  | Train Loss: 0.4769 | Train Acc: 0.8552
 Site-Real                     | Train Loss: 0.3716 | Train Acc: 0.9048
 Site-Real                     | Train Loss: 0.2267 | Train Acc: 0.9435
 Site-Real                     | Train Loss: 0.2455 | Train Acc: 0.9435
 Site-Real                     | Train Loss: 0.3045 | Train Acc: 0.9368
 Site-Painting                 | Train Loss: 0.3181 | Train Acc: 0.8912
 Site-Painting                 | Train Loss: 0.4464 | Train Acc: 0.8738
 Site-Painting                 | Train Loss: 0.3311 | Train Acc: 0.9204
 Site-Sketch                   | Train Loss: 0.4444 | Train Acc: 0.8743
 Site-Sketch                   | Train Loss: 0.3876 | Train Acc: 0.8427
 Site-QuickDraw                | Train Loss: 0.6403 | Train Acc: 0.8257
 Site-Infograph                | Train Loss: 0.7809 | Train Acc: 0.7650
 Site-Clipart                   (1) | Val  Loss: 0.2890 | Val  Acc: 0.8816
 Site-Clipart                   (1) | Val  Loss: 0.4367 | Val  Acc: 0.8785
 Site-Clipart                   (1) | Val  Loss: 0.4307 | Val  Acc: 0.8733
 Site-Clipart                   (1) | Val  Loss: 0.4559 | Val  Acc: 0.8667
 Site-Clipart                   (1) | Val  Loss: 0.5082 | Val  Acc: 0.8475
 Site-Real                      (2) | Val  Loss: 0.2832 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.2364 | Val  Acc: 0.9492
 Site-Real                      (2) | Val  Loss: 0.2310 | Val  Acc: 0.9455
 Site-Real                      (2) | Val  Loss: 0.2394 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2721 | Val  Acc: 0.9184
 Site-Painting                  (5) | Val  Loss: 0.3649 | Val  Acc: 0.8759
 Site-Painting                  (5) | Val  Loss: 0.3585 | Val  Acc: 0.9062
 Site-Sketch                    (4) | Val  Loss: 0.4231 | Val  Acc: 0.8819
 Site-Sketch                    (4) | Val  Loss: 0.5203 | Val  Acc: 0.8258
 Site-QuickDraw                 (3) | Val  Loss: 0.7324 | Val  Acc: 0.7890
 Site-Infograph                 (0) | Val  Loss: 0.8767 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8781
 Best site-Clipart                  (1)  | Epoch:38 | Val Acc: 0.8816
 Best site-Clipart                  (1)  | Epoch:38 | Val Acc: 0.8785
 Best site-Clipart                  (1)  | Epoch:38 | Val Acc: 0.8733
 Best site-Clipart                  (1)  | Epoch:38 | Val Acc: 0.8667
 Best site-Clipart                  (1)  | Epoch:38 | Val Acc: 0.8475
 Best site-Real                     (2)  | Epoch:38 | Val Acc: 0.9405
 Best site-Real                     (2)  | Epoch:38 | Val Acc: 0.9492
 Best site-Real                     (2)  | Epoch:38 | Val Acc: 0.9455
 Best site-Real                     (2)  | Epoch:38 | Val Acc: 0.9524
 Best site-Painting                 (5)  | Epoch:38 | Val Acc: 0.9184
 Best site-Painting                 (5)  | Epoch:38 | Val Acc: 0.8759
 Best site-Painting                 (5)  | Epoch:38 | Val Acc: 0.9062
 Best site-Sketch                   (4)  | Epoch:38 | Val Acc: 0.8819
 Best site-Sketch                   (4)  | Epoch:38 | Val Acc: 0.8258
 Best site-QuickDraw                (3)  | Epoch:38 | Val Acc: 0.7890
 Best site-Infograph                (0)  | Epoch:38 | Val Acc: 0.7179
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 39 ============
cnt=[2, 3, 1, 5, 4, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                  | Train Loss: 0.5074 | Train Acc: 0.8435
 Site-Clipart                  | Train Loss: 0.3572 | Train Acc: 0.9130
 Site-Clipart                  | Train Loss: 0.4797 | Train Acc: 0.8711
 Site-Clipart                  | Train Loss: 0.4444 | Train Acc: 0.8513
 Site-Clipart                  | Train Loss: 0.4528 | Train Acc: 0.8688
 Site-Real                     | Train Loss: 0.3611 | Train Acc: 0.9048
 Site-Real                     | Train Loss: 0.2305 | Train Acc: 0.9605
 Site-Real                     | Train Loss: 0.2501 | Train Acc: 0.9395
 Site-Real                     | Train Loss: 0.3069 | Train Acc: 0.9397
 Site-Painting                 | Train Loss: 0.4445 | Train Acc: 0.8639
 Site-Painting                 | Train Loss: 0.4036 | Train Acc: 0.8883
 Site-Painting                 | Train Loss: 0.3467 | Train Acc: 0.9170
 Site-Sketch                   | Train Loss: 0.4064 | Train Acc: 0.8848
 Site-Sketch                   | Train Loss: 0.4109 | Train Acc: 0.8427
 Site-QuickDraw                | Train Loss: 0.6854 | Train Acc: 0.8349
 Site-Infograph                | Train Loss: 0.6898 | Train Acc: 0.7821
 Site-Clipart                   (3) | Val  Loss: 0.2784 | Val  Acc: 0.8816
 Site-Clipart                   (3) | Val  Loss: 0.4104 | Val  Acc: 0.8879
 Site-Clipart                   (3) | Val  Loss: 0.4362 | Val  Acc: 0.8867
 Site-Clipart                   (3) | Val  Loss: 0.4255 | Val  Acc: 0.8571
 Site-Clipart                   (3) | Val  Loss: 0.4980 | Val  Acc: 0.8576
 Site-Real                      (4) | Val  Loss: 0.2829 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2581 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.2435 | Val  Acc: 0.9273
 Site-Real                      (4) | Val  Loss: 0.2605 | Val  Acc: 0.9351
 Site-Painting                  (1) | Val  Loss: 0.2775 | Val  Acc: 0.9286
 Site-Painting                  (1) | Val  Loss: 0.3548 | Val  Acc: 0.9051
 Site-Painting                  (1) | Val  Loss: 0.3367 | Val  Acc: 0.9167
 Site-Sketch                    (0) | Val  Loss: 0.3960 | Val  Acc: 0.8819
 Site-Sketch                    (0) | Val  Loss: 0.4407 | Val  Acc: 0.8483
 Site-QuickDraw                 (2) | Val  Loss: 0.7419 | Val  Acc: 0.7706
 Site-Infograph                 (5) | Val  Loss: 0.8996 | Val  Acc: 0.7628
Average Valid Accuracy: 0.8823
 Best site-Clipart                  (3)  | Epoch:39 | Val Acc: 0.8816
 Best site-Clipart                  (3)  | Epoch:39 | Val Acc: 0.8879
 Best site-Clipart                  (3)  | Epoch:39 | Val Acc: 0.8867
 Best site-Clipart                  (3)  | Epoch:39 | Val Acc: 0.8571
 Best site-Clipart                  (3)  | Epoch:39 | Val Acc: 0.8576
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 0.9286
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 0.9407
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 0.9273
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 0.9351
 Best site-Painting                 (1)  | Epoch:39 | Val Acc: 0.9286
 Best site-Painting                 (1)  | Epoch:39 | Val Acc: 0.9051
 Best site-Painting                 (1)  | Epoch:39 | Val Acc: 0.9167
 Best site-Sketch                   (0)  | Epoch:39 | Val Acc: 0.8819
 Best site-Sketch                   (0)  | Epoch:39 | Val Acc: 0.8483
 Best site-QuickDraw                (2)  | Epoch:39 | Val Acc: 0.7706
 Best site-Infograph                (5)  | Epoch:39 | Val Acc: 0.7628
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
 Test site-Clipart                   (3)| Epoch:39 | Test Acc: 0.8498
 Test site-Real                      (4)| Epoch:39 | Test Acc: 0.9417
 Test site-Painting                  (1)| Epoch:39 | Test Acc: 0.9208
 Test site-Sketch                    (0)| Epoch:39 | Test Acc: 0.8718
 Test site-QuickDraw                 (2)| Epoch:39 | Test Acc: 0.7510
 Test site-Infograph                 (5)| Epoch:39 | Test Acc: 0.5799
Clipart: 0.8498, Real: 0.9417, Painting: 0.9208, Sketch: 0.8718, QuickDraw: 0.7510, Infograph: 0.5799, 
Average Test Accuracy(group): 0.8192, Average Test Accuracy(individual): 0.8658,
domain CV=0.1503, cluster CV=0.1503, individual CV=0.1035, 
============ Train epoch 40 ============
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                  | Train Loss: 0.4990 | Train Acc: 0.8348
 Site-Clipart                  | Train Loss: 0.3612 | Train Acc: 0.9068
 Site-Clipart                  | Train Loss: 0.5116 | Train Acc: 0.8489
 Site-Clipart                  | Train Loss: 0.4502 | Train Acc: 0.8671
 Site-Clipart                  | Train Loss: 0.4521 | Train Acc: 0.8801
 Site-Real                     | Train Loss: 0.3397 | Train Acc: 0.9206
 Site-Real                     | Train Loss: 0.2235 | Train Acc: 0.9605
 Site-Real                     | Train Loss: 0.2527 | Train Acc: 0.9476
 Site-Real                     | Train Loss: 0.2956 | Train Acc: 0.9368
 Site-Painting                 | Train Loss: 0.3453 | Train Acc: 0.8776
 Site-Painting                 | Train Loss: 0.4068 | Train Acc: 0.8883
 Site-Painting                 | Train Loss: 0.3239 | Train Acc: 0.9343
 Site-Sketch                   | Train Loss: 0.3861 | Train Acc: 0.8796
 Site-Sketch                   | Train Loss: 0.5335 | Train Acc: 0.8464
 Site-QuickDraw                | Train Loss: 0.6636 | Train Acc: 0.8012
 Site-Infograph                | Train Loss: 0.7152 | Train Acc: 0.7778
 Site-Clipart                   (1) | Val  Loss: 0.3105 | Val  Acc: 0.8947
 Site-Clipart                   (1) | Val  Loss: 0.4188 | Val  Acc: 0.8785
 Site-Clipart                   (1) | Val  Loss: 0.4743 | Val  Acc: 0.8600
 Site-Clipart                   (1) | Val  Loss: 0.4707 | Val  Acc: 0.8429
 Site-Clipart                   (1) | Val  Loss: 0.4890 | Val  Acc: 0.8610
 Site-Real                      (0) | Val  Loss: 0.2825 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2556 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.2274 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2451 | Val  Acc: 0.9567
 Site-Painting                  (4) | Val  Loss: 0.2012 | Val  Acc: 0.9592
 Site-Painting                  (4) | Val  Loss: 0.3627 | Val  Acc: 0.8832
 Site-Painting                  (4) | Val  Loss: 0.3583 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.4072 | Val  Acc: 0.8740
 Site-Sketch                    (5) | Val  Loss: 0.4701 | Val  Acc: 0.8315
 Site-QuickDraw                 (2) | Val  Loss: 0.7921 | Val  Acc: 0.7477
 Site-Infograph                 (3) | Val  Loss: 0.8811 | Val  Acc: 0.7308
Average Valid Accuracy: 0.8771
 Test site-Clipart                   (1)| Epoch:39 | Test Acc: 0.8574
 Test site-Real                      (0)| Epoch:39 | Test Acc: 0.9417
 Test site-Painting                  (4)| Epoch:39 | Test Acc: 0.9192
 Test site-Sketch                    (5)| Epoch:39 | Test Acc: 0.8791
 Test site-QuickDraw                 (2)| Epoch:39 | Test Acc: 0.7470
 Test site-Infograph                 (3)| Epoch:39 | Test Acc: 0.5693
Clipart: 0.8574, Real: 0.9417, Painting: 0.9192, Sketch: 0.8791, QuickDraw: 0.7470, Infograph: 0.5693, 
Average Test Accuracy(group): 0.8189, Average Test Accuracy(individual): 0.8679,
domain CV=0.1558, cluster CV=0.1558, individual CV=0.1056, 
Average Test Accuracy: 0.8189
============ Train epoch 41 ============
cnt=[4, 2, 1, 1, 5, 3, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                  | Train Loss: 0.4931 | Train Acc: 0.8435
 Site-Clipart                  | Train Loss: 0.3405 | Train Acc: 0.9193
 Site-Clipart                  | Train Loss: 0.5153 | Train Acc: 0.8667
 Site-Clipart                  | Train Loss: 0.4548 | Train Acc: 0.8703
 Site-Clipart                  | Train Loss: 0.4480 | Train Acc: 0.8891
 Site-Real                     | Train Loss: 0.3712 | Train Acc: 0.8968
 Site-Real                     | Train Loss: 0.2419 | Train Acc: 0.9605
 Site-Real                     | Train Loss: 0.2252 | Train Acc: 0.9516
 Site-Real                     | Train Loss: 0.3051 | Train Acc: 0.9397
 Site-Painting                 | Train Loss: 0.3618 | Train Acc: 0.8980
 Site-Painting                 | Train Loss: 0.3501 | Train Acc: 0.8981
 Site-Painting                 | Train Loss: 0.3096 | Train Acc: 0.9100
 Site-Sketch                   | Train Loss: 0.4235 | Train Acc: 0.8848
 Site-Sketch                   | Train Loss: 0.4318 | Train Acc: 0.8577
 Site-QuickDraw                | Train Loss: 0.6112 | Train Acc: 0.8563
 Site-Infograph                | Train Loss: 0.7206 | Train Acc: 0.7735
 Site-Clipart                   (4) | Val  Loss: 0.3212 | Val  Acc: 0.8684
 Site-Clipart                   (4) | Val  Loss: 0.3984 | Val  Acc: 0.8879
 Site-Clipart                   (4) | Val  Loss: 0.4111 | Val  Acc: 0.8800
 Site-Clipart                   (4) | Val  Loss: 0.4610 | Val  Acc: 0.8571
 Site-Clipart                   (4) | Val  Loss: 0.5134 | Val  Acc: 0.8576
 Site-Real                      (0) | Val  Loss: 0.2619 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2570 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2931 | Val  Acc: 0.9091
 Site-Real                      (0) | Val  Loss: 0.2639 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.2638 | Val  Acc: 0.8980
 Site-Painting                  (5) | Val  Loss: 0.3422 | Val  Acc: 0.9051
 Site-Painting                  (5) | Val  Loss: 0.3578 | Val  Acc: 0.9167
 Site-Sketch                    (1) | Val  Loss: 0.3926 | Val  Acc: 0.8740
 Site-Sketch                    (1) | Val  Loss: 0.4699 | Val  Acc: 0.8539
 Site-QuickDraw                 (3) | Val  Loss: 0.7743 | Val  Acc: 0.7752
 Site-Infograph                 (2) | Val  Loss: 0.8381 | Val  Acc: 0.7692
Average Valid Accuracy: 0.8798
 Test site-Clipart                   (4)| Epoch:39 | Test Acc: 0.8593
 Test site-Real                      (0)| Epoch:39 | Test Acc: 0.9408
 Test site-Painting                  (5)| Epoch:39 | Test Acc: 0.9225
 Test site-Sketch                    (1)| Epoch:39 | Test Acc: 0.8791
 Test site-QuickDraw                 (3)| Epoch:39 | Test Acc: 0.7520
 Test site-Infograph                 (2)| Epoch:39 | Test Acc: 0.5753
Clipart: 0.8593, Real: 0.9408, Painting: 0.9225, Sketch: 0.8791, QuickDraw: 0.7520, Infograph: 0.5753, 
Average Test Accuracy(group): 0.8215, Average Test Accuracy(individual): 0.8695,
domain CV=0.1528, cluster CV=0.1528, individual CV=0.1036, 
Average Test Accuracy: 0.8215
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 42 ============
cnt=[5, 1, 3, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                  | Train Loss: 0.5156 | Train Acc: 0.8174
 Site-Clipart                  | Train Loss: 0.3516 | Train Acc: 0.9068
 Site-Clipart                  | Train Loss: 0.4631 | Train Acc: 0.8533
 Site-Clipart                  | Train Loss: 0.4574 | Train Acc: 0.8576
 Site-Clipart                  | Train Loss: 0.4419 | Train Acc: 0.8710
 Site-Real                     | Train Loss: 0.3455 | Train Acc: 0.9127
 Site-Real                     | Train Loss: 0.2076 | Train Acc: 0.9605
 Site-Real                     | Train Loss: 0.2561 | Train Acc: 0.9476
 Site-Real                     | Train Loss: 0.2625 | Train Acc: 0.9368
 Site-Painting                 | Train Loss: 0.4338 | Train Acc: 0.8844
 Site-Painting                 | Train Loss: 0.3296 | Train Acc: 0.8786
 Site-Painting                 | Train Loss: 0.3423 | Train Acc: 0.9204
 Site-Sketch                   | Train Loss: 0.4276 | Train Acc: 0.8796
 Site-Sketch                   | Train Loss: 0.4222 | Train Acc: 0.8577
 Site-QuickDraw                | Train Loss: 0.5822 | Train Acc: 0.8532
 Site-Infograph                | Train Loss: 0.7069 | Train Acc: 0.7949
 Site-Clipart                   (0) | Val  Loss: 0.2742 | Val  Acc: 0.8816
 Site-Clipart                   (0) | Val  Loss: 0.3929 | Val  Acc: 0.8972
 Site-Clipart                   (0) | Val  Loss: 0.4121 | Val  Acc: 0.8800
 Site-Clipart                   (0) | Val  Loss: 0.4821 | Val  Acc: 0.8476
 Site-Clipart                   (0) | Val  Loss: 0.4859 | Val  Acc: 0.8542
 Site-Real                      (4) | Val  Loss: 0.2892 | Val  Acc: 0.9167
 Site-Real                      (4) | Val  Loss: 0.2332 | Val  Acc: 0.9576
 Site-Real                      (4) | Val  Loss: 0.2325 | Val  Acc: 0.9273
 Site-Real                      (4) | Val  Loss: 0.2772 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.2214 | Val  Acc: 0.9592
 Site-Painting                  (2) | Val  Loss: 0.2992 | Val  Acc: 0.9051
 Site-Painting                  (2) | Val  Loss: 0.3521 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.3634 | Val  Acc: 0.8976
 Site-Sketch                    (5) | Val  Loss: 0.4468 | Val  Acc: 0.8652
 Site-QuickDraw                 (1) | Val  Loss: 0.7131 | Val  Acc: 0.7982
 Site-Infograph                 (3) | Val  Loss: 0.8808 | Val  Acc: 0.7436
Average Valid Accuracy: 0.8853
 Best site-Clipart                  (0)  | Epoch:42 | Val Acc: 0.8816
 Best site-Clipart                  (0)  | Epoch:42 | Val Acc: 0.8972
 Best site-Clipart                  (0)  | Epoch:42 | Val Acc: 0.8800
 Best site-Clipart                  (0)  | Epoch:42 | Val Acc: 0.8476
 Best site-Clipart                  (0)  | Epoch:42 | Val Acc: 0.8542
 Best site-Real                     (4)  | Epoch:42 | Val Acc: 0.9167
 Best site-Real                     (4)  | Epoch:42 | Val Acc: 0.9576
 Best site-Real                     (4)  | Epoch:42 | Val Acc: 0.9273
 Best site-Real                     (4)  | Epoch:42 | Val Acc: 0.9481
 Best site-Painting                 (2)  | Epoch:42 | Val Acc: 0.9592
 Best site-Painting                 (2)  | Epoch:42 | Val Acc: 0.9051
 Best site-Painting                 (2)  | Epoch:42 | Val Acc: 0.8854
 Best site-Sketch                   (5)  | Epoch:42 | Val Acc: 0.8976
 Best site-Sketch                   (5)  | Epoch:42 | Val Acc: 0.8652
 Best site-QuickDraw                (1)  | Epoch:42 | Val Acc: 0.7982
 Best site-Infograph                (3)  | Epoch:42 | Val Acc: 0.7436
 Test site-Clipart                   (0)| Epoch:42 | Test Acc: 0.8631
 Test site-Real                      (4)| Epoch:42 | Test Acc: 0.9441
 Test site-Painting                  (2)| Epoch:42 | Test Acc: 0.9225
 Test site-Sketch                    (5)| Epoch:42 | Test Acc: 0.8791
 Test site-QuickDraw                 (1)| Epoch:42 | Test Acc: 0.7510
 Test site-Infograph                 (3)| Epoch:42 | Test Acc: 0.5753
Clipart: 0.8631, Real: 0.9441, Painting: 0.9225, Sketch: 0.8791, QuickDraw: 0.7510, Infograph: 0.5753, 
Average Test Accuracy(group): 0.8225, Average Test Accuracy(individual): 0.8715,
domain CV=0.1537, cluster CV=0.1537, individual CV=0.1041, 
Average Test Accuracy: 0.8225
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 43 ============
cnt=[2, 5, 3, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                  | Train Loss: 0.5116 | Train Acc: 0.8435
 Site-Clipart                  | Train Loss: 0.3297 | Train Acc: 0.9255
 Site-Clipart                  | Train Loss: 0.4858 | Train Acc: 0.8622
 Site-Clipart                  | Train Loss: 0.4537 | Train Acc: 0.8481
 Site-Clipart                  | Train Loss: 0.4342 | Train Acc: 0.8620
 Site-Real                     | Train Loss: 0.3501 | Train Acc: 0.9048
 Site-Real                     | Train Loss: 0.2186 | Train Acc: 0.9605
 Site-Real                     | Train Loss: 0.2430 | Train Acc: 0.9315
 Site-Real                     | Train Loss: 0.2758 | Train Acc: 0.9454
 Site-Painting                 | Train Loss: 0.4031 | Train Acc: 0.8639
 Site-Painting                 | Train Loss: 0.3668 | Train Acc: 0.8835
 Site-Painting                 | Train Loss: 0.3506 | Train Acc: 0.9100
 Site-Sketch                   | Train Loss: 0.4167 | Train Acc: 0.8796
 Site-Sketch                   | Train Loss: 0.4510 | Train Acc: 0.8614
 Site-QuickDraw                | Train Loss: 0.6499 | Train Acc: 0.8471
 Site-Infograph                | Train Loss: 0.6422 | Train Acc: 0.8462
 Site-Clipart                   (1) | Val  Loss: 0.3067 | Val  Acc: 0.8816
 Site-Clipart                   (1) | Val  Loss: 0.3774 | Val  Acc: 0.8879
 Site-Clipart                   (1) | Val  Loss: 0.4495 | Val  Acc: 0.8600
 Site-Clipart                   (1) | Val  Loss: 0.4238 | Val  Acc: 0.8762
 Site-Clipart                   (1) | Val  Loss: 0.4628 | Val  Acc: 0.8576
 Site-Real                      (4) | Val  Loss: 0.2754 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.1859 | Val  Acc: 0.9576
 Site-Real                      (4) | Val  Loss: 0.2309 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.2354 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.2194 | Val  Acc: 0.9592
 Site-Painting                  (2) | Val  Loss: 0.2890 | Val  Acc: 0.9343
 Site-Painting                  (2) | Val  Loss: 0.3071 | Val  Acc: 0.9219
 Site-Sketch                    (0) | Val  Loss: 0.3787 | Val  Acc: 0.8898
 Site-Sketch                    (0) | Val  Loss: 0.4663 | Val  Acc: 0.8427
 Site-QuickDraw                 (3) | Val  Loss: 0.7148 | Val  Acc: 0.8073
 Site-Infograph                 (5) | Val  Loss: 0.8363 | Val  Acc: 0.7821
Average Valid Accuracy: 0.8921
 Best site-Clipart                  (1)  | Epoch:43 | Val Acc: 0.8816
 Best site-Clipart                  (1)  | Epoch:43 | Val Acc: 0.8879
 Best site-Clipart                  (1)  | Epoch:43 | Val Acc: 0.8600
 Best site-Clipart                  (1)  | Epoch:43 | Val Acc: 0.8762
 Best site-Clipart                  (1)  | Epoch:43 | Val Acc: 0.8576
 Best site-Real                     (4)  | Epoch:43 | Val Acc: 0.9286
 Best site-Real                     (4)  | Epoch:43 | Val Acc: 0.9576
 Best site-Real                     (4)  | Epoch:43 | Val Acc: 0.9394
 Best site-Real                     (4)  | Epoch:43 | Val Acc: 0.9481
 Best site-Painting                 (2)  | Epoch:43 | Val Acc: 0.9592
 Best site-Painting                 (2)  | Epoch:43 | Val Acc: 0.9343
 Best site-Painting                 (2)  | Epoch:43 | Val Acc: 0.9219
 Best site-Sketch                   (0)  | Epoch:43 | Val Acc: 0.8898
 Best site-Sketch                   (0)  | Epoch:43 | Val Acc: 0.8427
 Best site-QuickDraw                (3)  | Epoch:43 | Val Acc: 0.8073
 Best site-Infograph                (5)  | Epoch:43 | Val Acc: 0.7821
 Test site-Clipart                   (1)| Epoch:43 | Test Acc: 0.8593
 Test site-Real                      (4)| Epoch:43 | Test Acc: 0.9433
 Test site-Painting                  (2)| Epoch:43 | Test Acc: 0.9257
 Test site-Sketch                    (0)| Epoch:43 | Test Acc: 0.8827
 Test site-QuickDraw                 (3)| Epoch:43 | Test Acc: 0.7540
 Test site-Infograph                 (5)| Epoch:43 | Test Acc: 0.5738
Clipart: 0.8593, Real: 0.9433, Painting: 0.9257, Sketch: 0.8827, QuickDraw: 0.7540, Infograph: 0.5738, 
Average Test Accuracy(group): 0.8231, Average Test Accuracy(individual): 0.8713,
domain CV=0.1543, cluster CV=0.1543, individual CV=0.1046, 
Average Test Accuracy: 0.8231
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 44 ============
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                  | Train Loss: 0.4625 | Train Acc: 0.8435
 Site-Clipart                  | Train Loss: 0.3428 | Train Acc: 0.9130
 Site-Clipart                  | Train Loss: 0.4564 | Train Acc: 0.8756
 Site-Clipart                  | Train Loss: 0.4745 | Train Acc: 0.8481
 Site-Clipart                  | Train Loss: 0.4148 | Train Acc: 0.8846
 Site-Real                     | Train Loss: 0.3363 | Train Acc: 0.9127
 Site-Real                     | Train Loss: 0.2205 | Train Acc: 0.9605
 Site-Real                     | Train Loss: 0.2258 | Train Acc: 0.9355
 Site-Real                     | Train Loss: 0.2932 | Train Acc: 0.9397
 Site-Painting                 | Train Loss: 0.3487 | Train Acc: 0.8980
 Site-Painting                 | Train Loss: 0.3571 | Train Acc: 0.9029
 Site-Painting                 | Train Loss: 0.3289 | Train Acc: 0.9100
 Site-Sketch                   | Train Loss: 0.4104 | Train Acc: 0.8639
 Site-Sketch                   | Train Loss: 0.4442 | Train Acc: 0.8727
 Site-QuickDraw                | Train Loss: 0.5150 | Train Acc: 0.8471
 Site-Infograph                | Train Loss: 0.6652 | Train Acc: 0.8120
 Site-Clipart                   (0) | Val  Loss: 0.2930 | Val  Acc: 0.8947
 Site-Clipart                   (0) | Val  Loss: 0.4252 | Val  Acc: 0.8692
 Site-Clipart                   (0) | Val  Loss: 0.4158 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.4407 | Val  Acc: 0.8571
 Site-Clipart                   (0) | Val  Loss: 0.5147 | Val  Acc: 0.8441
 Site-Real                      (1) | Val  Loss: 0.2468 | Val  Acc: 0.9286
 Site-Real                      (1) | Val  Loss: 0.2505 | Val  Acc: 0.9153
 Site-Real                      (1) | Val  Loss: 0.2089 | Val  Acc: 0.9273
 Site-Real                      (1) | Val  Loss: 0.2445 | Val  Acc: 0.9351
 Site-Painting                  (5) | Val  Loss: 0.2227 | Val  Acc: 0.9286
 Site-Painting                  (5) | Val  Loss: 0.3098 | Val  Acc: 0.8759
 Site-Painting                  (5) | Val  Loss: 0.3371 | Val  Acc: 0.9167
 Site-Sketch                    (4) | Val  Loss: 0.3337 | Val  Acc: 0.9213
 Site-Sketch                    (4) | Val  Loss: 0.4823 | Val  Acc: 0.8258
 Site-QuickDraw                 (2) | Val  Loss: 0.7015 | Val  Acc: 0.8165
 Site-Infograph                 (3) | Val  Loss: 0.8104 | Val  Acc: 0.7692
Average Valid Accuracy: 0.8807
 Test site-Clipart                   (0)| Epoch:43 | Test Acc: 0.8574
 Test site-Real                      (1)| Epoch:43 | Test Acc: 0.9441
 Test site-Painting                  (5)| Epoch:43 | Test Acc: 0.9241
 Test site-Sketch                    (4)| Epoch:43 | Test Acc: 0.8773
 Test site-QuickDraw                 (2)| Epoch:43 | Test Acc: 0.7510
 Test site-Infograph                 (3)| Epoch:43 | Test Acc: 0.5677
Clipart: 0.8574, Real: 0.9441, Painting: 0.9241, Sketch: 0.8773, QuickDraw: 0.7510, Infograph: 0.5677, 
Average Test Accuracy(group): 0.8203, Average Test Accuracy(individual): 0.8693,
domain CV=0.1568, cluster CV=0.1568, individual CV=0.1065, 
Average Test Accuracy: 0.8203
============ Train epoch 45 ============
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                  | Train Loss: 0.4795 | Train Acc: 0.8522
 Site-Clipart                  | Train Loss: 0.2881 | Train Acc: 0.9255
 Site-Clipart                  | Train Loss: 0.4782 | Train Acc: 0.8489
 Site-Clipart                  | Train Loss: 0.4170 | Train Acc: 0.8671
 Site-Clipart                  | Train Loss: 0.4051 | Train Acc: 0.8891
 Site-Real                     | Train Loss: 0.3444 | Train Acc: 0.9048
 Site-Real                     | Train Loss: 0.2295 | Train Acc: 0.9548
 Site-Real                     | Train Loss: 0.2528 | Train Acc: 0.9355
 Site-Real                     | Train Loss: 0.2628 | Train Acc: 0.9368
 Site-Painting                 | Train Loss: 0.3674 | Train Acc: 0.9116
 Site-Painting                 | Train Loss: 0.3287 | Train Acc: 0.8786
 Site-Painting                 | Train Loss: 0.3148 | Train Acc: 0.9170
 Site-Sketch                   | Train Loss: 0.3830 | Train Acc: 0.8953
 Site-Sketch                   | Train Loss: 0.4068 | Train Acc: 0.8689
 Site-QuickDraw                | Train Loss: 0.6161 | Train Acc: 0.8104
 Site-Infograph                | Train Loss: 0.6604 | Train Acc: 0.8120
 Site-Clipart                   (1) | Val  Loss: 0.2576 | Val  Acc: 0.8947
 Site-Clipart                   (1) | Val  Loss: 0.3990 | Val  Acc: 0.8879
 Site-Clipart                   (1) | Val  Loss: 0.4274 | Val  Acc: 0.8400
 Site-Clipart                   (1) | Val  Loss: 0.4140 | Val  Acc: 0.8714
 Site-Clipart                   (1) | Val  Loss: 0.4971 | Val  Acc: 0.8542
 Site-Real                      (0) | Val  Loss: 0.2513 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2432 | Val  Acc: 0.9492
 Site-Real                      (0) | Val  Loss: 0.2278 | Val  Acc: 0.9576
 Site-Real                      (0) | Val  Loss: 0.2348 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.2248 | Val  Acc: 0.9490
 Site-Painting                  (5) | Val  Loss: 0.3276 | Val  Acc: 0.9051
 Site-Painting                  (5) | Val  Loss: 0.3468 | Val  Acc: 0.9115
 Site-Sketch                    (4) | Val  Loss: 0.3778 | Val  Acc: 0.8819
 Site-Sketch                    (4) | Val  Loss: 0.4795 | Val  Acc: 0.8146
 Site-QuickDraw                 (2) | Val  Loss: 0.7431 | Val  Acc: 0.7890
 Site-Infograph                 (3) | Val  Loss: 0.9235 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8826
 Test site-Clipart                   (1)| Epoch:43 | Test Acc: 0.8555
 Test site-Real                      (0)| Epoch:43 | Test Acc: 0.9458
 Test site-Painting                  (5)| Epoch:43 | Test Acc: 0.9257
 Test site-Sketch                    (4)| Epoch:43 | Test Acc: 0.8845
 Test site-QuickDraw                 (2)| Epoch:43 | Test Acc: 0.7500
 Test site-Infograph                 (3)| Epoch:43 | Test Acc: 0.5677
Clipart: 0.8555, Real: 0.9458, Painting: 0.9257, Sketch: 0.8845, QuickDraw: 0.7500, Infograph: 0.5677, 
Average Test Accuracy(group): 0.8215, Average Test Accuracy(individual): 0.8703,
domain CV=0.1579, cluster CV=0.1579, individual CV=0.1073, 
Average Test Accuracy: 0.8215
============ Train epoch 46 ============
cnt=[4, 1, 5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                  | Train Loss: 0.4938 | Train Acc: 0.8522
 Site-Clipart                  | Train Loss: 0.3186 | Train Acc: 0.9130
 Site-Clipart                  | Train Loss: 0.4601 | Train Acc: 0.8622
 Site-Clipart                  | Train Loss: 0.4168 | Train Acc: 0.8829
 Site-Clipart                  | Train Loss: 0.4240 | Train Acc: 0.8869
 Site-Real                     | Train Loss: 0.3574 | Train Acc: 0.9048
 Site-Real                     | Train Loss: 0.1948 | Train Acc: 0.9661
 Site-Real                     | Train Loss: 0.2258 | Train Acc: 0.9395
 Site-Real                     | Train Loss: 0.2742 | Train Acc: 0.9454
 Site-Painting                 | Train Loss: 0.3798 | Train Acc: 0.9184
 Site-Painting                 | Train Loss: 0.3122 | Train Acc: 0.9078
 Site-Painting                 | Train Loss: 0.3270 | Train Acc: 0.9066
 Site-Sketch                   | Train Loss: 0.3982 | Train Acc: 0.8848
 Site-Sketch                   | Train Loss: 0.4095 | Train Acc: 0.8539
 Site-QuickDraw                | Train Loss: 0.5997 | Train Acc: 0.8532
 Site-Infograph                | Train Loss: 0.6306 | Train Acc: 0.8419
 Site-Clipart                   (2) | Val  Loss: 0.2381 | Val  Acc: 0.9342
 Site-Clipart                   (2) | Val  Loss: 0.3768 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.4077 | Val  Acc: 0.8733
 Site-Clipart                   (2) | Val  Loss: 0.4276 | Val  Acc: 0.8524
 Site-Clipart                   (2) | Val  Loss: 0.4879 | Val  Acc: 0.8678
 Site-Real                      (0) | Val  Loss: 0.2641 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.2698 | Val  Acc: 0.9153
 Site-Real                      (0) | Val  Loss: 0.2368 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2310 | Val  Acc: 0.9524
 Site-Painting                  (3) | Val  Loss: 0.2319 | Val  Acc: 0.9490
 Site-Painting                  (3) | Val  Loss: 0.3110 | Val  Acc: 0.8905
 Site-Painting                  (3) | Val  Loss: 0.3430 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.3779 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.4910 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.6713 | Val  Acc: 0.8028
 Site-Infograph                 (4) | Val  Loss: 0.8884 | Val  Acc: 0.7500
Average Valid Accuracy: 0.8848
 Test site-Clipart                   (2)| Epoch:43 | Test Acc: 0.8555
 Test site-Real                      (0)| Epoch:43 | Test Acc: 0.9458
 Test site-Painting                  (3)| Epoch:43 | Test Acc: 0.9241
 Test site-Sketch                    (5)| Epoch:43 | Test Acc: 0.8827
 Test site-QuickDraw                 (1)| Epoch:43 | Test Acc: 0.7570
 Test site-Infograph                 (4)| Epoch:43 | Test Acc: 0.5693
Clipart: 0.8555, Real: 0.9458, Painting: 0.9241, Sketch: 0.8827, QuickDraw: 0.7570, Infograph: 0.5693, 
Average Test Accuracy(group): 0.8224, Average Test Accuracy(individual): 0.8703,
domain CV=0.1559, cluster CV=0.1559, individual CV=0.1061, 
Average Test Accuracy: 0.8224
============ Train epoch 47 ============
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                  | Train Loss: 0.4813 | Train Acc: 0.8522
 Site-Clipart                  | Train Loss: 0.3320 | Train Acc: 0.9068
 Site-Clipart                  | Train Loss: 0.4228 | Train Acc: 0.8889
 Site-Clipart                  | Train Loss: 0.4341 | Train Acc: 0.8671
 Site-Clipart                  | Train Loss: 0.4272 | Train Acc: 0.8801
 Site-Real                     | Train Loss: 0.3631 | Train Acc: 0.9048
 Site-Real                     | Train Loss: 0.1994 | Train Acc: 0.9605
 Site-Real                     | Train Loss: 0.2283 | Train Acc: 0.9476
 Site-Real                     | Train Loss: 0.2528 | Train Acc: 0.9368
 Site-Painting                 | Train Loss: 0.3597 | Train Acc: 0.8980
 Site-Painting                 | Train Loss: 0.3934 | Train Acc: 0.8835
 Site-Painting                 | Train Loss: 0.2922 | Train Acc: 0.9343
 Site-Sketch                   | Train Loss: 0.3656 | Train Acc: 0.8953
 Site-Sketch                   | Train Loss: 0.4091 | Train Acc: 0.8502
 Site-QuickDraw                | Train Loss: 0.6042 | Train Acc: 0.8563
 Site-Infograph                | Train Loss: 0.6687 | Train Acc: 0.8077
 Site-Clipart                   (0) | Val  Loss: 0.2551 | Val  Acc: 0.9211
 Site-Clipart                   (0) | Val  Loss: 0.3755 | Val  Acc: 0.8785
 Site-Clipart                   (0) | Val  Loss: 0.4325 | Val  Acc: 0.8400
 Site-Clipart                   (0) | Val  Loss: 0.4041 | Val  Acc: 0.8619
 Site-Clipart                   (0) | Val  Loss: 0.4720 | Val  Acc: 0.8712
 Site-Real                      (1) | Val  Loss: 0.2717 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.2088 | Val  Acc: 0.9576
 Site-Real                      (1) | Val  Loss: 0.2263 | Val  Acc: 0.9455
 Site-Real                      (1) | Val  Loss: 0.2456 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.2206 | Val  Acc: 0.9592
 Site-Painting                  (5) | Val  Loss: 0.2537 | Val  Acc: 0.9270
 Site-Painting                  (5) | Val  Loss: 0.3475 | Val  Acc: 0.9062
 Site-Sketch                    (4) | Val  Loss: 0.3363 | Val  Acc: 0.8819
 Site-Sketch                    (4) | Val  Loss: 0.4746 | Val  Acc: 0.8315
 Site-QuickDraw                 (2) | Val  Loss: 0.6679 | Val  Acc: 0.8532
 Site-Infograph                 (3) | Val  Loss: 0.8484 | Val  Acc: 0.7692
Average Valid Accuracy: 0.8938
 Best site-Clipart                  (0)  | Epoch:47 | Val Acc: 0.9211
 Best site-Clipart                  (0)  | Epoch:47 | Val Acc: 0.8785
 Best site-Clipart                  (0)  | Epoch:47 | Val Acc: 0.8400
 Best site-Clipart                  (0)  | Epoch:47 | Val Acc: 0.8619
 Best site-Clipart                  (0)  | Epoch:47 | Val Acc: 0.8712
 Best site-Real                     (1)  | Epoch:47 | Val Acc: 0.9524
 Best site-Real                     (1)  | Epoch:47 | Val Acc: 0.9576
 Best site-Real                     (1)  | Epoch:47 | Val Acc: 0.9455
 Best site-Real                     (1)  | Epoch:47 | Val Acc: 0.9437
 Best site-Painting                 (5)  | Epoch:47 | Val Acc: 0.9592
 Best site-Painting                 (5)  | Epoch:47 | Val Acc: 0.9270
 Best site-Painting                 (5)  | Epoch:47 | Val Acc: 0.9062
 Best site-Sketch                   (4)  | Epoch:47 | Val Acc: 0.8819
 Best site-Sketch                   (4)  | Epoch:47 | Val Acc: 0.8315
 Best site-QuickDraw                (2)  | Epoch:47 | Val Acc: 0.8532
 Best site-Infograph                (3)  | Epoch:47 | Val Acc: 0.7692
 Test site-Clipart                   (0)| Epoch:47 | Test Acc: 0.8650
 Test site-Real                      (1)| Epoch:47 | Test Acc: 0.9441
 Test site-Painting                  (5)| Epoch:47 | Test Acc: 0.9257
 Test site-Sketch                    (4)| Epoch:47 | Test Acc: 0.8863
 Test site-QuickDraw                 (2)| Epoch:47 | Test Acc: 0.7580
 Test site-Infograph                 (3)| Epoch:47 | Test Acc: 0.5677
Clipart: 0.8650, Real: 0.9441, Painting: 0.9257, Sketch: 0.8863, QuickDraw: 0.7580, Infograph: 0.5677, 
Average Test Accuracy(group): 0.8245, Average Test Accuracy(individual): 0.8736,
domain CV=0.1569, cluster CV=0.1569, individual CV=0.1054, 
Average Test Accuracy: 0.8245
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 48 ============
cnt=[1, 4, 2, 1, 5, 3, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                  | Train Loss: 0.4786 | Train Acc: 0.8609
 Site-Clipart                  | Train Loss: 0.3190 | Train Acc: 0.9130
 Site-Clipart                  | Train Loss: 0.4352 | Train Acc: 0.8578
 Site-Clipart                  | Train Loss: 0.4176 | Train Acc: 0.8734
 Site-Clipart                  | Train Loss: 0.4048 | Train Acc: 0.9027
 Site-Real                     | Train Loss: 0.3310 | Train Acc: 0.9206
 Site-Real                     | Train Loss: 0.2177 | Train Acc: 0.9661
 Site-Real                     | Train Loss: 0.2209 | Train Acc: 0.9395
 Site-Real                     | Train Loss: 0.2685 | Train Acc: 0.9282
 Site-Painting                 | Train Loss: 0.3641 | Train Acc: 0.8571
 Site-Painting                 | Train Loss: 0.3378 | Train Acc: 0.8981
 Site-Painting                 | Train Loss: 0.2883 | Train Acc: 0.9273
 Site-Sketch                   | Train Loss: 0.3570 | Train Acc: 0.9162
 Site-Sketch                   | Train Loss: 0.3859 | Train Acc: 0.8614
 Site-QuickDraw                | Train Loss: 0.6347 | Train Acc: 0.8532
 Site-Infograph                | Train Loss: 0.6317 | Train Acc: 0.8333
 Site-Clipart                   (4) | Val  Loss: 0.2508 | Val  Acc: 0.9342
 Site-Clipart                   (4) | Val  Loss: 0.3678 | Val  Acc: 0.8879
 Site-Clipart                   (4) | Val  Loss: 0.3765 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.4081 | Val  Acc: 0.8619
 Site-Clipart                   (4) | Val  Loss: 0.4938 | Val  Acc: 0.8508
 Site-Real                      (1) | Val  Loss: 0.2546 | Val  Acc: 0.9286
 Site-Real                      (1) | Val  Loss: 0.2231 | Val  Acc: 0.9661
 Site-Real                      (1) | Val  Loss: 0.1989 | Val  Acc: 0.9515
 Site-Real                      (1) | Val  Loss: 0.2054 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.1916 | Val  Acc: 0.9286
 Site-Painting                  (5) | Val  Loss: 0.2940 | Val  Acc: 0.9051
 Site-Painting                  (5) | Val  Loss: 0.3527 | Val  Acc: 0.9062
 Site-Sketch                    (2) | Val  Loss: 0.3324 | Val  Acc: 0.8898
 Site-Sketch                    (2) | Val  Loss: 0.4677 | Val  Acc: 0.8202
 Site-QuickDraw                 (0) | Val  Loss: 0.7373 | Val  Acc: 0.7890
 Site-Infograph                 (3) | Val  Loss: 0.8588 | Val  Acc: 0.7821
Average Valid Accuracy: 0.8888
 Test site-Clipart                   (4)| Epoch:47 | Test Acc: 0.8631
 Test site-Real                      (1)| Epoch:47 | Test Acc: 0.9441
 Test site-Painting                  (5)| Epoch:47 | Test Acc: 0.9241
 Test site-Sketch                    (2)| Epoch:47 | Test Acc: 0.8881
 Test site-QuickDraw                 (0)| Epoch:47 | Test Acc: 0.7570
 Test site-Infograph                 (3)| Epoch:47 | Test Acc: 0.5753
Clipart: 0.8631, Real: 0.9441, Painting: 0.9241, Sketch: 0.8881, QuickDraw: 0.7570, Infograph: 0.5753, 
Average Test Accuracy(group): 0.8253, Average Test Accuracy(individual): 0.8733,
domain CV=0.1536, cluster CV=0.1536, individual CV=0.1036, 
Average Test Accuracy: 0.8253
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_cb/ccop_q=1...
============ Train epoch 49 ============
cnt=[5, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                  | Train Loss: 0.5180 | Train Acc: 0.8435
 Site-Clipart                  | Train Loss: 0.3223 | Train Acc: 0.8944
 Site-Clipart                  | Train Loss: 0.4253 | Train Acc: 0.8889
 Site-Clipart                  | Train Loss: 0.4320 | Train Acc: 0.8924
 Site-Clipart                  | Train Loss: 0.4145 | Train Acc: 0.8778
 Site-Real                     | Train Loss: 0.3582 | Train Acc: 0.8968
 Site-Real                     | Train Loss: 0.2052 | Train Acc: 0.9492
 Site-Real                     | Train Loss: 0.2210 | Train Acc: 0.9476
 Site-Real                     | Train Loss: 0.2531 | Train Acc: 0.9397
 Site-Painting                 | Train Loss: 0.3863 | Train Acc: 0.8912
 Site-Painting                 | Train Loss: 0.3111 | Train Acc: 0.8786
 Site-Painting                 | Train Loss: 0.3067 | Train Acc: 0.9135
 Site-Sketch                   | Train Loss: 0.3690 | Train Acc: 0.8901
 Site-Sketch                   | Train Loss: 0.3839 | Train Acc: 0.8989
 Site-QuickDraw                | Train Loss: 0.5572 | Train Acc: 0.8471
 Site-Infograph                | Train Loss: 0.6556 | Train Acc: 0.8034
 Site-Clipart                   (0) | Val  Loss: 0.2577 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.3326 | Val  Acc: 0.9159
 Site-Clipart                   (0) | Val  Loss: 0.4108 | Val  Acc: 0.8533
 Site-Clipart                   (0) | Val  Loss: 0.4125 | Val  Acc: 0.8857
 Site-Clipart                   (0) | Val  Loss: 0.4479 | Val  Acc: 0.8610
 Site-Real                      (1) | Val  Loss: 0.2414 | Val  Acc: 0.9286
 Site-Real                      (1) | Val  Loss: 0.2339 | Val  Acc: 0.9407
 Site-Real                      (1) | Val  Loss: 0.2220 | Val  Acc: 0.9212
 Site-Real                      (1) | Val  Loss: 0.2315 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.1911 | Val  Acc: 0.9592
 Site-Painting                  (2) | Val  Loss: 0.2952 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.3102 | Val  Acc: 0.9219
 Site-Sketch                    (5) | Val  Loss: 0.3659 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.4266 | Val  Acc: 0.8539
 Site-QuickDraw                 (3) | Val  Loss: 0.7080 | Val  Acc: 0.7798
 Site-Infograph                 (4) | Val  Loss: 0.8500 | Val  Acc: 0.7821
Average Valid Accuracy: 0.8921
 Test site-Clipart                   (0)| Epoch:48 | Test Acc: 0.8631
 Test site-Real                      (1)| Epoch:48 | Test Acc: 0.9449
 Test site-Painting                  (2)| Epoch:48 | Test Acc: 0.9241
 Test site-Sketch                    (5)| Epoch:48 | Test Acc: 0.8845
 Test site-QuickDraw                 (3)| Epoch:48 | Test Acc: 0.7630
 Test site-Infograph                 (4)| Epoch:48 | Test Acc: 0.5677
Clipart: 0.8631, Real: 0.9449, Painting: 0.9241, Sketch: 0.8845, QuickDraw: 0.7630, Infograph: 0.5677, 
Average Test Accuracy(group): 0.8246, Average Test Accuracy(individual): 0.8730,
domain CV=0.1560, cluster CV=0.1560, individual CV=0.1051, 
Average Test Accuracy: 0.8246
===2023-06-09 23:25:31===
===2023-06-09 23:25:34===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (4)| Epoch:48 | Test Acc: 0.8631
 Test site-Real                      (1)| Epoch:48 | Test Acc: 0.9441
 Test site-Painting                  (5)| Epoch:48 | Test Acc: 0.9241
 Test site-Sketch                    (2)| Epoch:48 | Test Acc: 0.8881
 Test site-QuickDraw                 (0)| Epoch:48 | Test Acc: 0.7570
 Test site-Infograph                 (3)| Epoch:48 | Test Acc: 0.5753
Clipart: 0.8631, Real: 0.9441, Painting: 0.9241, Sketch: 0.8881, QuickDraw: 0.7570, Infograph: 0.5753, 
Average Test Accuracy(group): 0.8253, Average Test Accuracy(individual): 0.8733,
domain CV=0.1536, cluster CV=0.1536, individual CV=0.1036, 
