===2023-05-23 15:15:31===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 3
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[198,259,340,446,360,222,291,382,457,264,346,448,352,462,268,352,474,330,]
client_nums=[5,4,3,2,2,1,1,]
domain number = 12
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-3
client-1 is in G-6
client-2 is in G-3
client-3 is in G-6
client-4 is in G-3
client-5 is in G-0
client-6 is in G-7
client-7 is in G-0
client-8 is in G-9
client-9 is in G-2
client-10 is in G-4
client-11 is in G-2
client-12 is in G-11
client-13 is in G-8
client-14 is in G-10
client-15 is in G-0
client-16 is in G-1
client-17 is in G-5
cnt=[3, 1, 2, 3, 1, 1, 2, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
sum of wi : 1.0000
 Site-White_Male               | Train Loss: 2.0978 | Train Acc: 0.2525
 Site-White_Female             | Train Loss: 1.7282 | Train Acc: 0.3861
 Site-White_Male               | Train Loss: 2.0271 | Train Acc: 0.2500
 Site-White_Female             | Train Loss: 1.8191 | Train Acc: 0.3744
 Site-White_Male               | Train Loss: 2.0131 | Train Acc: 0.2500
 Site-Latino_Hispanic_Female   | Train Loss: 1.9464 | Train Acc: 0.2838
 Site-Latino_Hispanic_Male     | Train Loss: 2.0122 | Train Acc: 0.2302
 Site-Latino_Hispanic_Female   | Train Loss: 1.9876 | Train Acc: 0.2801
 Site-Latino_Hispanic_Male     | Train Loss: 1.9550 | Train Acc: 0.2473
 Site-Black_Female             | Train Loss: 1.8846 | Train Acc: 0.3258
 Site-Black_Male               | Train Loss: 1.9712 | Train Acc: 0.2543
 Site-Black_Female             | Train Loss: 1.9080 | Train Acc: 0.2991
 Site-East_Asian_Male          | Train Loss: 1.8844 | Train Acc: 0.3239
 Site-East_Asian_Female        | Train Loss: 1.6605 | Train Acc: 0.4654
 Site-Indian_Male              | Train Loss: 2.0526 | Train Acc: 0.2127
 Site-Indian_Female            | Train Loss: 2.1402 | Train Acc: 0.2898
 Site-Southeast_Asian_Male     | Train Loss: 2.1033 | Train Acc: 0.2890
 Site-Middle_Eastern_Female    | Train Loss: 1.8860 | Train Acc: 0.3515
 Site-White_Male                (3) | Val  Loss: 1.7841 | Val  Acc: 0.2652
 Site-White_Female              (6) | Val  Loss: 1.7899 | Val  Acc: 0.3757
 Site-White_Male                (3) | Val  Loss: 2.0577 | Val  Acc: 0.2423
 Site-White_Female              (6) | Val  Loss: 1.8250 | Val  Acc: 0.3737
 Site-White_Male                (3) | Val  Loss: 2.0312 | Val  Acc: 0.2667
 Site-Latino_Hispanic_Female    (0) | Val  Loss: 1.9138 | Val  Acc: 0.2905
 Site-Latino_Hispanic_Male      (7) | Val  Loss: 2.0484 | Val  Acc: 0.2268
 Site-Latino_Hispanic_Female    (0) | Val  Loss: 1.9809 | Val  Acc: 0.2835
 Site-Latino_Hispanic_Male      (9) | Val  Loss: 2.0374 | Val  Acc: 0.2072
 Site-Black_Female              (2) | Val  Loss: 1.9439 | Val  Acc: 0.2955
 Site-Black_Male                (4) | Val  Loss: 1.9469 | Val  Acc: 0.2424
 Site-Black_Female              (2) | Val  Loss: 1.9221 | Val  Acc: 0.2886
 Site-East_Asian_Male           (11)| Val  Loss: 1.9217 | Val  Acc: 0.3248
 Site-East_Asian_Female         (8) | Val  Loss: 1.6968 | Val  Acc: 0.4643
 Site-Indian_Male               (10)| Val  Loss: 2.0651 | Val  Acc: 0.1844
 Site-Indian_Female             (0) | Val  Loss: 2.1405 | Val  Acc: 0.2821
 Site-Southeast_Asian_Male      (1) | Val  Loss: 2.0957 | Val  Acc: 0.2880
 Site-Middle_Eastern_Female     (5) | Val  Loss: 1.8796 | Val  Acc: 0.3636
Average Valid Accuracy: 0.2925
Aggregated Acc | Val Acc: 0.2926
 Best site-White_Male               (3)  | Epoch:0 | Val Acc: 0.2652
 Best site-White_Female             (6)  | Epoch:0 | Val Acc: 0.3757
 Best site-White_Male               (3)  | Epoch:0 | Val Acc: 0.2423
 Best site-White_Female             (6)  | Epoch:0 | Val Acc: 0.3737
 Best site-White_Male               (3)  | Epoch:0 | Val Acc: 0.2667
 Best site-Latino_Hispanic_Female   (0)  | Epoch:0 | Val Acc: 0.2905
 Best site-Latino_Hispanic_Male     (7)  | Epoch:0 | Val Acc: 0.2268
 Best site-Latino_Hispanic_Female   (0)  | Epoch:0 | Val Acc: 0.2835
 Best site-Latino_Hispanic_Male     (9)  | Epoch:0 | Val Acc: 0.2072
 Best site-Black_Female             (2)  | Epoch:0 | Val Acc: 0.2955
 Best site-Black_Male               (4)  | Epoch:0 | Val Acc: 0.2424
 Best site-Black_Female             (2)  | Epoch:0 | Val Acc: 0.2886
 Best site-East_Asian_Male          (11) | Epoch:0 | Val Acc: 0.3248
 Best site-East_Asian_Female        (8)  | Epoch:0 | Val Acc: 0.4643
 Best site-Indian_Male              (10) | Epoch:0 | Val Acc: 0.1844
 Best site-Indian_Female            (0)  | Epoch:0 | Val Acc: 0.2821
 Best site-Southeast_Asian_Male     (1)  | Epoch:0 | Val Acc: 0.2880
 Best site-Middle_Eastern_Female    (5)  | Epoch:0 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_gender_cluster_12/ccop_q=1...
============ Train epoch 1 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-4
client-3 is in G-1
client-4 is in G-4
client-5 is in G-6
client-6 is in G-0
client-7 is in G-6
client-8 is in G-0
client-9 is in G-3
client-10 is in G-2
client-11 is in G-3
client-12 is in G-8
client-13 is in G-7
client-14 is in G-9
client-15 is in G-5
client-16 is in G-10
client-17 is in G-11
cnt=[2, 2, 1, 2, 3, 1, 2, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
sum of wi : 1.0000
 Site-White_Male               | Train Loss: 1.9741 | Train Acc: 0.2525
 Site-White_Female             | Train Loss: 1.9171 | Train Acc: 0.3861
 Site-White_Male               | Train Loss: 1.9453 | Train Acc: 0.2618
 Site-White_Female             | Train Loss: 1.8092 | Train Acc: 0.3677
 Site-White_Male               | Train Loss: 1.9454 | Train Acc: 0.2556
 Site-Latino_Hispanic_Female   | Train Loss: 1.8919 | Train Acc: 0.2883
 Site-Latino_Hispanic_Male     | Train Loss: 1.9140 | Train Acc: 0.2268
 Site-Latino_Hispanic_Female   | Train Loss: 1.9271 | Train Acc: 0.2618
 Site-Latino_Hispanic_Male     | Train Loss: 1.8390 | Train Acc: 0.2516
 Site-Black_Female             | Train Loss: 1.8033 | Train Acc: 0.3258
 Site-Black_Male               | Train Loss: 1.9035 | Train Acc: 0.2543
 Site-Black_Female             | Train Loss: 1.8726 | Train Acc: 0.2902
 Site-East_Asian_Male          | Train Loss: 1.8430 | Train Acc: 0.3239
 Site-East_Asian_Female        | Train Loss: 1.6597 | Train Acc: 0.4610
 Site-Indian_Male              | Train Loss: 1.9916 | Train Acc: 0.2425
 Site-Indian_Female            | Train Loss: 2.0621 | Train Acc: 0.2784
 Site-Southeast_Asian_Male     | Train Loss: 2.0128 | Train Acc: 0.2785
 Site-Middle_Eastern_Female    | Train Loss: 1.8055 | Train Acc: 0.3576
 Site-White_Male                (4) | Val  Loss: 1.7570 | Val  Acc: 0.2652
 Site-White_Female              (1) | Val  Loss: 1.7551 | Val  Acc: 0.3931
 Site-White_Male                (4) | Val  Loss: 1.9698 | Val  Acc: 0.2379
 Site-White_Female              (1) | Val  Loss: 1.7944 | Val  Acc: 0.3636
 Site-White_Male                (4) | Val  Loss: 1.9515 | Val  Acc: 0.2583
 Site-Latino_Hispanic_Female    (6) | Val  Loss: 1.8762 | Val  Acc: 0.2905
 Site-Latino_Hispanic_Male      (0) | Val  Loss: 1.9403 | Val  Acc: 0.2113
 Site-Latino_Hispanic_Female    (6) | Val  Loss: 1.9086 | Val  Acc: 0.2717
 Site-Latino_Hispanic_Male      (0) | Val  Loss: 1.9436 | Val  Acc: 0.2138
 Site-Black_Female              (3) | Val  Loss: 1.8924 | Val  Acc: 0.2898
 Site-Black_Male                (2) | Val  Loss: 1.9060 | Val  Acc: 0.1991
 Site-Black_Female              (3) | Val  Loss: 1.8984 | Val  Acc: 0.2987
 Site-East_Asian_Male           (8) | Val  Loss: 1.8649 | Val  Acc: 0.3333
 Site-East_Asian_Female         (7) | Val  Loss: 1.7021 | Val  Acc: 0.4545
 Site-Indian_Male               (9) | Val  Loss: 1.9684 | Val  Acc: 0.2514
 Site-Indian_Female             (5) | Val  Loss: 2.0680 | Val  Acc: 0.2735
 Site-Southeast_Asian_Male      (10)| Val  Loss: 2.0375 | Val  Acc: 0.2880
 Site-Middle_Eastern_Female     (11)| Val  Loss: 1.8358 | Val  Acc: 0.3636
Average Valid Accuracy: 0.2921
Aggregated Acc | Val Acc: 0.2986
 Test site-White_Male               | Epoch:0 | Test Acc: 0.3702
 Test site-White_Female             | Epoch:0 | Test Acc: 0.2057
 Test site-Latino_Hispanic_Female   | Epoch:0 | Test Acc: 0.2710
 Test site-Latino_Hispanic_Male     | Epoch:0 | Test Acc: 0.2595
 Test site-Black_Female             | Epoch:0 | Test Acc: 0.2157
 Test site-Black_Male               | Epoch:0 | Test Acc: 0.2829
 Test site-East_Asian_Male          | Epoch:0 | Test Acc: 0.3987
 Test site-East_Asian_Female        | Epoch:0 | Test Acc: 0.3669
 Test site-Indian_Male              | Epoch:0 | Test Acc: 0.3210
 Test site-Indian_Female            | Epoch:0 | Test Acc: 0.2110
 Test site-Southeast_Asian_Male     | Epoch:0 | Test Acc: 0.3209
 Test site-Middle_Eastern_Female    | Epoch:0 | Test Acc: 0.2406
Average Test Accuracy: 0.2887
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_gender_cluster_12/ccop_q=1...
============ Train epoch 2 ============
gmm
client-0 is in G-0
client-1 is in G-1
client-2 is in G-0
client-3 is in G-1
client-4 is in G-0
client-5 is in G-6
client-6 is in G-11
client-7 is in G-6
client-8 is in G-3
client-9 is in G-9
client-10 is in G-10
client-11 is in G-2
client-12 is in G-8
client-13 is in G-4
client-14 is in G-5
client-15 is in G-6
client-16 is in G-11
client-17 is in G-7
cnt=[3, 2, 1, 1, 1, 1, 3, 1, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
sum of wi : 1.0000
 Site-White_Male               | Train Loss: 1.8578 | Train Acc: 0.2576
 Site-White_Female             | Train Loss: 1.8726 | Train Acc: 0.3900
 Site-White_Male               | Train Loss: 1.8984 | Train Acc: 0.2382
 Site-White_Female             | Train Loss: 1.7761 | Train Acc: 0.3767
 Site-White_Male               | Train Loss: 1.8902 | Train Acc: 0.2750
 Site-Latino_Hispanic_Female   | Train Loss: 1.8422 | Train Acc: 0.2748
 Site-Latino_Hispanic_Male     | Train Loss: 1.8955 | Train Acc: 0.2371
 Site-Latino_Hispanic_Female   | Train Loss: 1.8751 | Train Acc: 0.2827
 Site-Latino_Hispanic_Male     | Train Loss: 1.8741 | Train Acc: 0.2451
 Site-Black_Female             | Train Loss: 1.8086 | Train Acc: 0.3409
 Site-Black_Male               | Train Loss: 1.8910 | Train Acc: 0.2052
 Site-Black_Female             | Train Loss: 1.8414 | Train Acc: 0.3013
 Site-East_Asian_Male          | Train Loss: 1.8209 | Train Acc: 0.3239
 Site-East_Asian_Female        | Train Loss: 1.6525 | Train Acc: 0.4610
 Site-Indian_Male              | Train Loss: 1.9610 | Train Acc: 0.2351
 Site-Indian_Female            | Train Loss: 1.9949 | Train Acc: 0.2812
 Site-Southeast_Asian_Male     | Train Loss: 1.9636 | Train Acc: 0.2806
 Site-Middle_Eastern_Female    | Train Loss: 1.7748 | Train Acc: 0.3576
 Site-White_Male                (0) | Val  Loss: 1.7185 | Val  Acc: 0.2424
 Site-White_Female              (1) | Val  Loss: 1.7452 | Val  Acc: 0.3931
 Site-White_Male                (0) | Val  Loss: 1.9163 | Val  Acc: 0.2555
 Site-White_Female              (1) | Val  Loss: 1.7751 | Val  Acc: 0.3670
 Site-White_Male                (0) | Val  Loss: 1.9136 | Val  Acc: 0.2667
 Site-Latino_Hispanic_Female    (6) | Val  Loss: 1.8363 | Val  Acc: 0.3041
 Site-Latino_Hispanic_Male      (11)| Val  Loss: 1.8998 | Val  Acc: 0.2165
 Site-Latino_Hispanic_Female    (6) | Val  Loss: 1.8575 | Val  Acc: 0.2835
 Site-Latino_Hispanic_Male      (3) | Val  Loss: 1.9001 | Val  Acc: 0.2204
 Site-Black_Female              (9) | Val  Loss: 1.8721 | Val  Acc: 0.2841
 Site-Black_Male                (10)| Val  Loss: 1.8684 | Val  Acc: 0.2381
 Site-Black_Female              (2) | Val  Loss: 1.8682 | Val  Acc: 0.2886
 Site-East_Asian_Male           (8) | Val  Loss: 1.8331 | Val  Acc: 0.3077
 Site-East_Asian_Female         (4) | Val  Loss: 1.6692 | Val  Acc: 0.4513
 Site-Indian_Male               (5) | Val  Loss: 1.9147 | Val  Acc: 0.2346
 Site-Indian_Female             (6) | Val  Loss: 2.0138 | Val  Acc: 0.2906
 Site-Southeast_Asian_Male      (11)| Val  Loss: 1.9752 | Val  Acc: 0.2975
 Site-Middle_Eastern_Female     (7) | Val  Loss: 1.8322 | Val  Acc: 0.3455
Average Valid Accuracy: 0.2937
Aggregated Acc | Val Acc: 0.2962
 Best site-White_Male               (0)  | Epoch:2 | Val Acc: 0.2424
 Best site-White_Female             (1)  | Epoch:2 | Val Acc: 0.3931
 Best site-White_Male               (0)  | Epoch:2 | Val Acc: 0.2555
 Best site-White_Female             (1)  | Epoch:2 | Val Acc: 0.3670
 Best site-White_Male               (0)  | Epoch:2 | Val Acc: 0.2667
 Best site-Latino_Hispanic_Female   (6)  | Epoch:2 | Val Acc: 0.3041
 Best site-Latino_Hispanic_Male     (11) | Epoch:2 | Val Acc: 0.2165
 Best site-Latino_Hispanic_Female   (6)  | Epoch:2 | Val Acc: 0.2835
 Best site-Latino_Hispanic_Male     (3)  | Epoch:2 | Val Acc: 0.2204
 Best site-Black_Female             (9)  | Epoch:2 | Val Acc: 0.2841
 Best site-Black_Male               (10) | Epoch:2 | Val Acc: 0.2381
 Best site-Black_Female             (2)  | Epoch:2 | Val Acc: 0.2886
 Best site-East_Asian_Male          (8)  | Epoch:2 | Val Acc: 0.3077
 Best site-East_Asian_Female        (4)  | Epoch:2 | Val Acc: 0.4513
 Best site-Indian_Male              (5)  | Epoch:2 | Val Acc: 0.2346
 Best site-Indian_Female            (6)  | Epoch:2 | Val Acc: 0.2906
 Best site-Southeast_Asian_Male     (11) | Epoch:2 | Val Acc: 0.2975
 Best site-Middle_Eastern_Female    (7)  | Epoch:2 | Val Acc: 0.3455
 Test site-White_Male               | Epoch:2 | Test Acc: 0.3812
 Test site-White_Female             | Epoch:2 | Test Acc: 0.2249
 Test site-Latino_Hispanic_Female   | Epoch:2 | Test Acc: 0.2710
 Test site-Latino_Hispanic_Male     | Epoch:2 | Test Acc: 0.2785
 Test site-Black_Female             | Epoch:2 | Test Acc: 0.2026
 Test site-Black_Male               | Epoch:2 | Test Acc: 0.2862
 Test site-East_Asian_Male          | Epoch:2 | Test Acc: 0.4118
 Test site-East_Asian_Female        | Epoch:2 | Test Acc: 0.3525
 Test site-Indian_Male              | Epoch:2 | Test Acc: 0.3395
 Test site-Indian_Female            | Epoch:2 | Test Acc: 0.2339
 Test site-Southeast_Asian_Male     | Epoch:2 | Test Acc: 0.3433
 Test site-Middle_Eastern_Female    | Epoch:2 | Test Acc: 0.2781
Average Test Accuracy: 0.3003
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_gender_cluster_12/ccop_q=1...
===2023-05-23 15:30:07===
