===2023-05-23 15:15:31===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 3
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[198,259,340,446,360,222,291,382,457,264,346,448,352,462,268,352,474,330,]
client_nums=[5,4,3,2,2,1,1,]
domain number = 12
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-3
client-1 is in G-6
client-2 is in G-3
client-3 is in G-6
client-4 is in G-3
client-5 is in G-0
client-6 is in G-7
client-7 is in G-0
client-8 is in G-9
client-9 is in G-2
client-10 is in G-4
client-11 is in G-2
client-12 is in G-11
client-13 is in G-8
client-14 is in G-10
client-15 is in G-0
client-16 is in G-1
client-17 is in G-5
cnt=[3, 1, 2, 3, 1, 1, 2, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
sum of wi : 1.0000
 Site-White_Male               | Train Loss: 2.0978 | Train Acc: 0.2525
 Site-White_Female             | Train Loss: 1.7282 | Train Acc: 0.3861
 Site-White_Male               | Train Loss: 2.0271 | Train Acc: 0.2500
 Site-White_Female             | Train Loss: 1.8191 | Train Acc: 0.3744
 Site-White_Male               | Train Loss: 2.0131 | Train Acc: 0.2500
 Site-Latino_Hispanic_Female   | Train Loss: 1.9464 | Train Acc: 0.2838
 Site-Latino_Hispanic_Male     | Train Loss: 2.0122 | Train Acc: 0.2302
 Site-Latino_Hispanic_Female   | Train Loss: 1.9876 | Train Acc: 0.2801
 Site-Latino_Hispanic_Male     | Train Loss: 1.9550 | Train Acc: 0.2473
 Site-Black_Female             | Train Loss: 1.8846 | Train Acc: 0.3258
 Site-Black_Male               | Train Loss: 1.9712 | Train Acc: 0.2543
 Site-Black_Female             | Train Loss: 1.9080 | Train Acc: 0.2991
 Site-East_Asian_Male          | Train Loss: 1.8844 | Train Acc: 0.3239
 Site-East_Asian_Female        | Train Loss: 1.6605 | Train Acc: 0.4654
 Site-Indian_Male              | Train Loss: 2.0526 | Train Acc: 0.2127
 Site-Indian_Female            | Train Loss: 2.1402 | Train Acc: 0.2898
 Site-Southeast_Asian_Male     | Train Loss: 2.1033 | Train Acc: 0.2890
 Site-Middle_Eastern_Female    | Train Loss: 1.8860 | Train Acc: 0.3515
 Site-White_Male                (3) | Val  Loss: 1.7841 | Val  Acc: 0.2652
 Site-White_Female              (6) | Val  Loss: 1.7899 | Val  Acc: 0.3757
 Site-White_Male                (3) | Val  Loss: 2.0577 | Val  Acc: 0.2423
 Site-White_Female              (6) | Val  Loss: 1.8250 | Val  Acc: 0.3737
 Site-White_Male                (3) | Val  Loss: 2.0312 | Val  Acc: 0.2667
 Site-Latino_Hispanic_Female    (0) | Val  Loss: 1.9138 | Val  Acc: 0.2905
 Site-Latino_Hispanic_Male      (7) | Val  Loss: 2.0484 | Val  Acc: 0.2268
 Site-Latino_Hispanic_Female    (0) | Val  Loss: 1.9809 | Val  Acc: 0.2835
 Site-Latino_Hispanic_Male      (9) | Val  Loss: 2.0374 | Val  Acc: 0.2072
 Site-Black_Female              (2) | Val  Loss: 1.9439 | Val  Acc: 0.2955
 Site-Black_Male                (4) | Val  Loss: 1.9469 | Val  Acc: 0.2424
 Site-Black_Female              (2) | Val  Loss: 1.9221 | Val  Acc: 0.2886
 Site-East_Asian_Male           (11)| Val  Loss: 1.9217 | Val  Acc: 0.3248
 Site-East_Asian_Female         (8) | Val  Loss: 1.6968 | Val  Acc: 0.4643
 Site-Indian_Male               (10)| Val  Loss: 2.0651 | Val  Acc: 0.1844
 Site-Indian_Female             (0) | Val  Loss: 2.1405 | Val  Acc: 0.2821
 Site-Southeast_Asian_Male      (1) | Val  Loss: 2.0957 | Val  Acc: 0.2880
 Site-Middle_Eastern_Female     (5) | Val  Loss: 1.8796 | Val  Acc: 0.3636
Average Valid Accuracy: 0.2925
Aggregated Acc | Val Acc: 0.2926
 Best site-White_Male               (3)  | Epoch:0 | Val Acc: 0.2652
 Best site-White_Female             (6)  | Epoch:0 | Val Acc: 0.3757
 Best site-White_Male               (3)  | Epoch:0 | Val Acc: 0.2423
 Best site-White_Female             (6)  | Epoch:0 | Val Acc: 0.3737
 Best site-White_Male               (3)  | Epoch:0 | Val Acc: 0.2667
 Best site-Latino_Hispanic_Female   (0)  | Epoch:0 | Val Acc: 0.2905
 Best site-Latino_Hispanic_Male     (7)  | Epoch:0 | Val Acc: 0.2268
 Best site-Latino_Hispanic_Female   (0)  | Epoch:0 | Val Acc: 0.2835
 Best site-Latino_Hispanic_Male     (9)  | Epoch:0 | Val Acc: 0.2072
 Best site-Black_Female             (2)  | Epoch:0 | Val Acc: 0.2955
 Best site-Black_Male               (4)  | Epoch:0 | Val Acc: 0.2424
 Best site-Black_Female             (2)  | Epoch:0 | Val Acc: 0.2886
 Best site-East_Asian_Male          (11) | Epoch:0 | Val Acc: 0.3248
 Best site-East_Asian_Female        (8)  | Epoch:0 | Val Acc: 0.4643
 Best site-Indian_Male              (10) | Epoch:0 | Val Acc: 0.1844
 Best site-Indian_Female            (0)  | Epoch:0 | Val Acc: 0.2821
 Best site-Southeast_Asian_Male     (1)  | Epoch:0 | Val Acc: 0.2880
 Best site-Middle_Eastern_Female    (5)  | Epoch:0 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_gender_cluster_12/ccop_q=1...
============ Train epoch 1 ============
