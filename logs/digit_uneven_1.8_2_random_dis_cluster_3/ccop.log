===2023-08-13 09:09:12===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 3
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[10, 9, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (0) | Train Loss: 1.6532 | Train Acc: 0.5000
 Site-MNIST                     (0) | Train Loss: 1.6928 | Train Acc: 0.5833
 Site-MNIST                     (0) | Train Loss: 1.5678 | Train Acc: 0.7143
 Site-MNIST                     (0) | Train Loss: 1.5580 | Train Acc: 0.7105
 Site-MNIST                     (0) | Train Loss: 1.6556 | Train Acc: 0.7286
 Site-MNIST                     (0) | Train Loss: 1.5398 | Train Acc: 0.7381
 Site-MNIST                     (0) | Train Loss: 1.5223 | Train Acc: 0.7577
 Site-MNIST                     (0) | Train Loss: 1.6325 | Train Acc: 0.6430
 Site-MNIST                     (0) | Train Loss: 1.5962 | Train Acc: 0.6712
 Site-MNIST                     (0) | Train Loss: 1.5476 | Train Acc: 0.7200
 Site-USPS                      (1) | Train Loss: 1.6370 | Train Acc: 0.6250
 Site-USPS                      (1) | Train Loss: 1.6637 | Train Acc: 0.6111
 Site-USPS                      (1) | Train Loss: 1.6870 | Train Acc: 0.6124
 Site-USPS                      (1) | Train Loss: 1.6905 | Train Acc: 0.5794
 Site-USPS                      (1) | Train Loss: 1.6849 | Train Acc: 0.6071
 Site-USPS                      (1) | Train Loss: 1.6813 | Train Acc: 0.6019
 Site-SynthDigits               (1) | Train Loss: 2.1274 | Train Acc: 0.2649
 Site-SynthDigits               (1) | Train Loss: 2.1556 | Train Acc: 0.2015
 Site-SynthDigits               (1) | Train Loss: 2.1058 | Train Acc: 0.2953
 Site-MNIST_M                   (2) | Train Loss: 2.2708 | Train Acc: 0.1657
 Site-MNIST_M                   (2) | Train Loss: 2.1576 | Train Acc: 0.2263
 Site-SVHN                      (2) | Train Loss: 2.2308 | Train Acc: 0.1879
Average Train Accuracy: 0.5339
 Site-MNIST                     (0) | Val  Loss: 1.3860 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 1.2989 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 1.3377 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 1.5777 | Val  Acc: 0.5556
 Site-MNIST                     (0) | Val  Loss: 1.6099 | Val  Acc: 0.5882
 Site-MNIST                     (0) | Val  Loss: 1.5814 | Val  Acc: 0.6774
 Site-MNIST                     (0) | Val  Loss: 1.5364 | Val  Acc: 0.7143
 Site-MNIST                     (0) | Val  Loss: 1.5277 | Val  Acc: 0.6961
 Site-MNIST                     (0) | Val  Loss: 1.5936 | Val  Acc: 0.6612
 Site-MNIST                     (0) | Val  Loss: 1.5610 | Val  Acc: 0.6918
 Site-USPS                      (1) | Val  Loss: 1.7231 | Val  Acc: 0.6000
 Site-USPS                      (1) | Val  Loss: 1.8374 | Val  Acc: 0.5000
 Site-USPS                      (1) | Val  Loss: 1.7231 | Val  Acc: 0.6562
 Site-USPS                      (1) | Val  Loss: 1.7611 | Val  Acc: 0.5172
 Site-USPS                      (1) | Val  Loss: 1.7049 | Val  Acc: 0.5714
 Site-USPS                      (1) | Val  Loss: 1.6568 | Val  Acc: 0.5820
 Site-SynthDigits               (1) | Val  Loss: 2.2049 | Val  Acc: 0.1892
 Site-SynthDigits               (1) | Val  Loss: 2.2899 | Val  Acc: 0.1618
 Site-SynthDigits               (1) | Val  Loss: 2.1252 | Val  Acc: 0.2049
 Site-MNIST_M                   (2) | Val  Loss: 2.2359 | Val  Acc: 0.1778
 Site-MNIST_M                   (2) | Val  Loss: 2.2236 | Val  Acc: 0.1975
 Site-SVHN                      (2) | Val  Loss: 2.1759 | Val  Acc: 0.1000
Average Valid Accuracy: 0.5383
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.5556
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.5882
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.6774
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.7143
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.6961
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.6612
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.6918
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.6000
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.5000
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.6562
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.5172
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.5714
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.5820
 Best site-SynthDigits              (1)  | Epoch:0 | Val Acc: 0.1892
 Best site-SynthDigits              (1)  | Epoch:0 | Val Acc: 0.1618
 Best site-SynthDigits              (1)  | Epoch:0 | Val Acc: 0.2049
 Best site-MNIST_M                  (2)  | Epoch:0 | Val Acc: 0.1778
 Best site-MNIST_M                  (2)  | Epoch:0 | Val Acc: 0.1975
 Best site-SVHN                     (2)  | Epoch:0 | Val Acc: 0.1000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 1 ============
cnt=[6, 6, 10, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (2) | Train Loss: 1.1952 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 1.2571 | Train Acc: 0.5833
 Site-MNIST                     (2) | Train Loss: 1.0919 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 1.1002 | Train Acc: 0.8684
 Site-MNIST                     (2) | Train Loss: 1.0018 | Train Acc: 0.8286
 Site-MNIST                     (2) | Train Loss: 1.0866 | Train Acc: 0.8413
 Site-MNIST                     (2) | Train Loss: 1.1032 | Train Acc: 0.8150
 Site-MNIST                     (2) | Train Loss: 1.1948 | Train Acc: 0.7628
 Site-MNIST                     (2) | Train Loss: 1.1695 | Train Acc: 0.7649
 Site-MNIST                     (2) | Train Loss: 1.1126 | Train Acc: 0.8000
 Site-USPS                      (0) | Train Loss: 1.1280 | Train Acc: 0.8000
 Site-USPS                      (0) | Train Loss: 1.2847 | Train Acc: 0.7917
 Site-USPS                      (0) | Train Loss: 1.6107 | Train Acc: 0.7442
 Site-USPS                      (0) | Train Loss: 1.2262 | Train Acc: 0.7253
 Site-USPS                      (0) | Train Loss: 1.1951 | Train Acc: 0.7190
 Site-USPS                      (0) | Train Loss: 1.2073 | Train Acc: 0.7619
 Site-SynthDigits               (1) | Train Loss: 1.9372 | Train Acc: 0.3179
 Site-SynthDigits               (1) | Train Loss: 1.9358 | Train Acc: 0.3077
 Site-SynthDigits               (1) | Train Loss: 1.8972 | Train Acc: 0.3422
 Site-MNIST_M                   (1) | Train Loss: 2.1382 | Train Acc: 0.2376
 Site-MNIST_M                   (1) | Train Loss: 2.0054 | Train Acc: 0.3089
 Site-SVHN                      (1) | Train Loss: 2.1561 | Train Acc: 0.2234
Average Train Accuracy: 0.6470
 Site-MNIST                     (2) | Val  Loss: 0.7898 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.7890 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.8451 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 1.1489 | Val  Acc: 0.6667
 Site-MNIST                     (2) | Val  Loss: 1.1600 | Val  Acc: 0.7059
 Site-MNIST                     (2) | Val  Loss: 1.1674 | Val  Acc: 0.8065
 Site-MNIST                     (2) | Val  Loss: 1.1068 | Val  Acc: 0.8214
 Site-MNIST                     (2) | Val  Loss: 1.1095 | Val  Acc: 0.7941
 Site-MNIST                     (2) | Val  Loss: 1.1773 | Val  Acc: 0.7705
 Site-MNIST                     (2) | Val  Loss: 1.1403 | Val  Acc: 0.7855
 Site-USPS                      (0) | Val  Loss: 1.2125 | Val  Acc: 0.7000
 Site-USPS                      (0) | Val  Loss: 1.4787 | Val  Acc: 0.6111
 Site-USPS                      (0) | Val  Loss: 1.3414 | Val  Acc: 0.6875
 Site-USPS                      (0) | Val  Loss: 1.3498 | Val  Acc: 0.6552
 Site-USPS                      (0) | Val  Loss: 1.2493 | Val  Acc: 0.7333
 Site-USPS                      (0) | Val  Loss: 1.1954 | Val  Acc: 0.7407
 Site-SynthDigits               (1) | Val  Loss: 2.0342 | Val  Acc: 0.2432
 Site-SynthDigits               (1) | Val  Loss: 2.0415 | Val  Acc: 0.2647
 Site-SynthDigits               (1) | Val  Loss: 1.9277 | Val  Acc: 0.3279
 Site-MNIST_M                   (1) | Val  Loss: 2.1673 | Val  Acc: 0.2444
 Site-MNIST_M                   (1) | Val  Loss: 2.1049 | Val  Acc: 0.2963
 Site-SVHN                      (1) | Val  Loss: 2.0575 | Val  Acc: 0.2000
Average Valid Accuracy: 0.6298
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.6667
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.7059
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.8065
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.8214
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.7941
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.7705
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.7855
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.7000
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.6111
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.6875
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.6552
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.7333
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.7407
 Best site-SynthDigits              (1)  | Epoch:1 | Val Acc: 0.2432
 Best site-SynthDigits              (1)  | Epoch:1 | Val Acc: 0.2647
 Best site-SynthDigits              (1)  | Epoch:1 | Val Acc: 0.3279
 Best site-MNIST_M                  (1)  | Epoch:1 | Val Acc: 0.2444
 Best site-MNIST_M                  (1)  | Epoch:1 | Val Acc: 0.2963
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.2000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 2 ============
cnt=[16, 3, 3, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (0) | Train Loss: 0.9819 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 1.1432 | Train Acc: 0.6667
 Site-MNIST                     (0) | Train Loss: 0.9192 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.9439 | Train Acc: 0.8158
 Site-MNIST                     (0) | Train Loss: 0.9124 | Train Acc: 0.8143
 Site-MNIST                     (0) | Train Loss: 0.9393 | Train Acc: 0.8492
 Site-MNIST                     (0) | Train Loss: 0.9272 | Train Acc: 0.8502
 Site-MNIST                     (0) | Train Loss: 1.0655 | Train Acc: 0.7922
 Site-MNIST                     (0) | Train Loss: 1.0011 | Train Acc: 0.7976
 Site-MNIST                     (0) | Train Loss: 0.9546 | Train Acc: 0.8272
 Site-USPS                      (0) | Train Loss: 0.8922 | Train Acc: 0.8250
 Site-USPS                      (0) | Train Loss: 0.8098 | Train Acc: 0.8472
 Site-USPS                      (0) | Train Loss: 0.9761 | Train Acc: 0.7984
 Site-USPS                      (0) | Train Loss: 0.9908 | Train Acc: 0.7854
 Site-USPS                      (0) | Train Loss: 0.9652 | Train Acc: 0.7905
 Site-USPS                      (0) | Train Loss: 0.9744 | Train Acc: 0.8029
 Site-SynthDigits               (1) | Train Loss: 1.8435 | Train Acc: 0.3907
 Site-SynthDigits               (1) | Train Loss: 1.7471 | Train Acc: 0.4066
 Site-SynthDigits               (1) | Train Loss: 1.7309 | Train Acc: 0.4155
 Site-MNIST_M                   (2) | Train Loss: 2.0490 | Train Acc: 0.2762
 Site-MNIST_M                   (2) | Train Loss: 1.8994 | Train Acc: 0.3578
 Site-SVHN                      (2) | Train Loss: 2.1038 | Train Acc: 0.2376
Average Train Accuracy: 0.6835
 Site-MNIST                     (0) | Val  Loss: 0.5663 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.6020 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.6964 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 1.0142 | Val  Acc: 0.6667
 Site-MNIST                     (0) | Val  Loss: 1.0118 | Val  Acc: 0.7059
 Site-MNIST                     (0) | Val  Loss: 1.0080 | Val  Acc: 0.8065
 Site-MNIST                     (0) | Val  Loss: 0.9349 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.9403 | Val  Acc: 0.8235
 Site-MNIST                     (0) | Val  Loss: 1.0145 | Val  Acc: 0.8142
 Site-MNIST                     (0) | Val  Loss: 0.9812 | Val  Acc: 0.8097
 Site-USPS                      (0) | Val  Loss: 0.9028 | Val  Acc: 0.8000
 Site-USPS                      (0) | Val  Loss: 1.2458 | Val  Acc: 0.6667
 Site-USPS                      (0) | Val  Loss: 1.1404 | Val  Acc: 0.6875
 Site-USPS                      (0) | Val  Loss: 1.1517 | Val  Acc: 0.6897
 Site-USPS                      (0) | Val  Loss: 1.0310 | Val  Acc: 0.7810
 Site-USPS                      (0) | Val  Loss: 0.9718 | Val  Acc: 0.8095
 Site-SynthDigits               (1) | Val  Loss: 1.8931 | Val  Acc: 0.4054
 Site-SynthDigits               (1) | Val  Loss: 1.9020 | Val  Acc: 0.3824
 Site-SynthDigits               (1) | Val  Loss: 1.7691 | Val  Acc: 0.3934
 Site-MNIST_M                   (2) | Val  Loss: 2.0775 | Val  Acc: 0.2889
 Site-MNIST_M                   (2) | Val  Loss: 2.0169 | Val  Acc: 0.3086
 Site-SVHN                      (2) | Val  Loss: 2.0276 | Val  Acc: 0.2286
Average Valid Accuracy: 0.6693
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.6667
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.7059
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8065
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8571
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8235
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8142
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8097
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.8000
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.6667
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.6875
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.6897
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7810
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.8095
 Best site-SynthDigits              (1)  | Epoch:2 | Val Acc: 0.4054
 Best site-SynthDigits              (1)  | Epoch:2 | Val Acc: 0.3824
 Best site-SynthDigits              (1)  | Epoch:2 | Val Acc: 0.3934
 Best site-MNIST_M                  (2)  | Epoch:2 | Val Acc: 0.2889
 Best site-MNIST_M                  (2)  | Epoch:2 | Val Acc: 0.3086
 Best site-SVHN                     (2)  | Epoch:2 | Val Acc: 0.2286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 3 ============
cnt=[16, 3, 3, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (0) | Train Loss: 0.9053 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 1.0124 | Train Acc: 0.7500
 Site-MNIST                     (0) | Train Loss: 0.7754 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.8161 | Train Acc: 0.8947
 Site-MNIST                     (0) | Train Loss: 1.0484 | Train Acc: 0.8143
 Site-MNIST                     (0) | Train Loss: 0.8081 | Train Acc: 0.8651
 Site-MNIST                     (0) | Train Loss: 0.7947 | Train Acc: 0.8546
 Site-MNIST                     (0) | Train Loss: 0.9241 | Train Acc: 0.8093
 Site-MNIST                     (0) | Train Loss: 0.8819 | Train Acc: 0.8125
 Site-MNIST                     (0) | Train Loss: 0.8271 | Train Acc: 0.8377
 Site-USPS                      (0) | Train Loss: 0.7857 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.7836 | Train Acc: 0.8472
 Site-USPS                      (0) | Train Loss: 0.6584 | Train Acc: 0.8062
 Site-USPS                      (0) | Train Loss: 0.8577 | Train Acc: 0.8112
 Site-USPS                      (0) | Train Loss: 0.8447 | Train Acc: 0.8024
 Site-USPS                      (0) | Train Loss: 0.8549 | Train Acc: 0.8122
 Site-SynthDigits               (1) | Train Loss: 1.6913 | Train Acc: 0.4238
 Site-SynthDigits               (1) | Train Loss: 1.6483 | Train Acc: 0.4432
 Site-SynthDigits               (1) | Train Loss: 1.6047 | Train Acc: 0.4460
 Site-MNIST_M                   (2) | Train Loss: 1.9666 | Train Acc: 0.2873
 Site-MNIST_M                   (2) | Train Loss: 1.7387 | Train Acc: 0.4159
 Site-SVHN                      (2) | Train Loss: 2.0163 | Train Acc: 0.2695
Average Train Accuracy: 0.7065
 Site-MNIST                     (0) | Val  Loss: 0.4279 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4689 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.6239 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.9293 | Val  Acc: 0.6667
 Site-MNIST                     (0) | Val  Loss: 0.9081 | Val  Acc: 0.7059
 Site-MNIST                     (0) | Val  Loss: 0.8858 | Val  Acc: 0.8065
 Site-MNIST                     (0) | Val  Loss: 0.8036 | Val  Acc: 0.8750
 Site-MNIST                     (0) | Val  Loss: 0.8106 | Val  Acc: 0.8529
 Site-MNIST                     (0) | Val  Loss: 0.8899 | Val  Acc: 0.8197
 Site-MNIST                     (0) | Val  Loss: 0.8580 | Val  Acc: 0.8157
 Site-USPS                      (0) | Val  Loss: 0.7415 | Val  Acc: 0.8000
 Site-USPS                      (0) | Val  Loss: 1.1393 | Val  Acc: 0.6667
 Site-USPS                      (0) | Val  Loss: 1.0489 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 1.0464 | Val  Acc: 0.7241
 Site-USPS                      (0) | Val  Loss: 0.9095 | Val  Acc: 0.8000
 Site-USPS                      (0) | Val  Loss: 0.8535 | Val  Acc: 0.8254
 Site-SynthDigits               (1) | Val  Loss: 1.7793 | Val  Acc: 0.4324
 Site-SynthDigits               (1) | Val  Loss: 1.7529 | Val  Acc: 0.4706
 Site-SynthDigits               (1) | Val  Loss: 1.6433 | Val  Acc: 0.4508
 Site-MNIST_M                   (2) | Val  Loss: 2.0030 | Val  Acc: 0.3111
 Site-MNIST_M                   (2) | Val  Loss: 1.9441 | Val  Acc: 0.3457
 Site-SVHN                      (2) | Val  Loss: 1.9830 | Val  Acc: 0.2429
Average Valid Accuracy: 0.6878
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.6667
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.7059
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8065
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8750
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8529
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8197
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8157
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8000
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.6667
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.7188
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.7241
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8000
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8254
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.4324
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.4706
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.4508
 Best site-MNIST_M                  (2)  | Epoch:3 | Val Acc: 0.3111
 Best site-MNIST_M                  (2)  | Epoch:3 | Val Acc: 0.3457
 Best site-SVHN                     (2)  | Epoch:3 | Val Acc: 0.2429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 4 ============
cnt=[16, 3, 3, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (0) | Train Loss: 0.8363 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.9198 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.7014 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.7119 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.7245 | Train Acc: 0.8286
 Site-MNIST                     (0) | Train Loss: 0.7336 | Train Acc: 0.8254
 Site-MNIST                     (0) | Train Loss: 0.7245 | Train Acc: 0.8546
 Site-MNIST                     (0) | Train Loss: 0.8268 | Train Acc: 0.8166
 Site-MNIST                     (0) | Train Loss: 0.7981 | Train Acc: 0.8247
 Site-MNIST                     (0) | Train Loss: 0.7459 | Train Acc: 0.8513
 Site-USPS                      (0) | Train Loss: 0.6835 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.6508 | Train Acc: 0.8611
 Site-USPS                      (0) | Train Loss: 0.8470 | Train Acc: 0.8450
 Site-USPS                      (0) | Train Loss: 0.8187 | Train Acc: 0.8240
 Site-USPS                      (0) | Train Loss: 0.7648 | Train Acc: 0.8333
 Site-USPS                      (0) | Train Loss: 0.7688 | Train Acc: 0.8294
 Site-SynthDigits               (1) | Train Loss: 1.5605 | Train Acc: 0.4768
 Site-SynthDigits               (1) | Train Loss: 1.5562 | Train Acc: 0.5092
 Site-SynthDigits               (1) | Train Loss: 1.4891 | Train Acc: 0.4847
 Site-MNIST_M                   (2) | Train Loss: 1.8934 | Train Acc: 0.3315
 Site-MNIST_M                   (2) | Train Loss: 1.6822 | Train Acc: 0.4465
 Site-SVHN                      (2) | Train Loss: 1.9677 | Train Acc: 0.3085
Average Train Accuracy: 0.7294
 Site-MNIST                     (0) | Val  Loss: 0.3075 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.3419 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.5505 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.8237 | Val  Acc: 0.6667
 Site-MNIST                     (0) | Val  Loss: 0.8165 | Val  Acc: 0.7059
 Site-MNIST                     (0) | Val  Loss: 0.8002 | Val  Acc: 0.8387
 Site-MNIST                     (0) | Val  Loss: 0.7232 | Val  Acc: 0.8929
 Site-MNIST                     (0) | Val  Loss: 0.7284 | Val  Acc: 0.8529
 Site-MNIST                     (0) | Val  Loss: 0.8017 | Val  Acc: 0.8306
 Site-MNIST                     (0) | Val  Loss: 0.7749 | Val  Acc: 0.8187
 Site-USPS                      (0) | Val  Loss: 0.6494 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 1.0532 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.9633 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 0.9686 | Val  Acc: 0.7241
 Site-USPS                      (0) | Val  Loss: 0.8303 | Val  Acc: 0.8095
 Site-USPS                      (0) | Val  Loss: 0.7676 | Val  Acc: 0.8571
 Site-SynthDigits               (1) | Val  Loss: 1.6808 | Val  Acc: 0.5135
 Site-SynthDigits               (1) | Val  Loss: 1.5927 | Val  Acc: 0.5588
 Site-SynthDigits               (1) | Val  Loss: 1.5313 | Val  Acc: 0.5164
 Site-MNIST_M                   (2) | Val  Loss: 1.9131 | Val  Acc: 0.4000
 Site-MNIST_M                   (2) | Val  Loss: 1.8666 | Val  Acc: 0.4444
 Site-SVHN                      (2) | Val  Loss: 1.9302 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7208
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.6667
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.7059
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8387
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8929
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8529
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8306
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8187
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7222
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7188
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7241
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.8095
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.8571
 Best site-SynthDigits              (1)  | Epoch:4 | Val Acc: 0.5135
 Best site-SynthDigits              (1)  | Epoch:4 | Val Acc: 0.5588
 Best site-SynthDigits              (1)  | Epoch:4 | Val Acc: 0.5164
 Best site-MNIST_M                  (2)  | Epoch:4 | Val Acc: 0.4000
 Best site-MNIST_M                  (2)  | Epoch:4 | Val Acc: 0.4444
 Best site-SVHN                     (2)  | Epoch:4 | Val Acc: 0.2857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 5 ============
cnt=[16, 3, 3, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (0) | Train Loss: 0.7949 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.8444 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.6269 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.6377 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.5713 | Train Acc: 0.8286
 Site-MNIST                     (0) | Train Loss: 0.6638 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.6474 | Train Acc: 0.8722
 Site-MNIST                     (0) | Train Loss: 0.7461 | Train Acc: 0.8264
 Site-MNIST                     (0) | Train Loss: 0.7176 | Train Acc: 0.8451
 Site-MNIST                     (0) | Train Loss: 0.6754 | Train Acc: 0.8574
 Site-USPS                      (0) | Train Loss: 0.6320 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.7523 | Train Acc: 0.8611
 Site-USPS                      (0) | Train Loss: 0.5563 | Train Acc: 0.8527
 Site-USPS                      (0) | Train Loss: 0.7360 | Train Acc: 0.8369
 Site-USPS                      (0) | Train Loss: 0.6905 | Train Acc: 0.8381
 Site-USPS                      (0) | Train Loss: 0.7038 | Train Acc: 0.8347
 Site-SynthDigits               (2) | Train Loss: 1.4494 | Train Acc: 0.5232
 Site-SynthDigits               (2) | Train Loss: 1.4238 | Train Acc: 0.5311
 Site-SynthDigits               (2) | Train Loss: 1.4058 | Train Acc: 0.5540
 Site-MNIST_M                   (1) | Train Loss: 1.8137 | Train Acc: 0.3867
 Site-MNIST_M                   (1) | Train Loss: 1.6420 | Train Acc: 0.4832
 Site-SVHN                      (1) | Train Loss: 1.9360 | Train Acc: 0.3333
Average Train Accuracy: 0.7462
 Site-MNIST                     (0) | Val  Loss: 0.2514 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.2735 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.5255 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.7701 | Val  Acc: 0.6667
 Site-MNIST                     (0) | Val  Loss: 0.7542 | Val  Acc: 0.7059
 Site-MNIST                     (0) | Val  Loss: 0.7287 | Val  Acc: 0.8387
 Site-MNIST                     (0) | Val  Loss: 0.6545 | Val  Acc: 0.8929
 Site-MNIST                     (0) | Val  Loss: 0.6604 | Val  Acc: 0.8529
 Site-MNIST                     (0) | Val  Loss: 0.7307 | Val  Acc: 0.8361
 Site-MNIST                     (0) | Val  Loss: 0.7075 | Val  Acc: 0.8338
 Site-USPS                      (0) | Val  Loss: 0.5822 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 1.0065 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.9246 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 0.9240 | Val  Acc: 0.7586
 Site-USPS                      (0) | Val  Loss: 0.7745 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.7071 | Val  Acc: 0.8624
 Site-SynthDigits               (2) | Val  Loss: 1.5912 | Val  Acc: 0.6486
 Site-SynthDigits               (2) | Val  Loss: 1.4569 | Val  Acc: 0.6176
 Site-SynthDigits               (2) | Val  Loss: 1.4296 | Val  Acc: 0.5656
 Site-MNIST_M                   (1) | Val  Loss: 1.8465 | Val  Acc: 0.4444
 Site-MNIST_M                   (1) | Val  Loss: 1.8064 | Val  Acc: 0.4938
 Site-SVHN                      (1) | Val  Loss: 1.8828 | Val  Acc: 0.3143
Average Valid Accuracy: 0.7410
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.6667
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.7059
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8387
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8929
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8529
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8361
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8338
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.7222
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.7188
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.7586
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8286
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8624
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.6486
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.6176
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.5656
 Best site-MNIST_M                  (1)  | Epoch:5 | Val Acc: 0.4444
 Best site-MNIST_M                  (1)  | Epoch:5 | Val Acc: 0.4938
 Best site-SVHN                     (1)  | Epoch:5 | Val Acc: 0.3143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 6 ============
cnt=[3, 16, 3, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (1) | Train Loss: 0.7390 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.7859 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.5804 | Train Acc: 0.8571
 Site-MNIST                     (1) | Train Loss: 0.5716 | Train Acc: 0.8947
 Site-MNIST                     (1) | Train Loss: 0.6483 | Train Acc: 0.8429
 Site-MNIST                     (1) | Train Loss: 0.6239 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.5927 | Train Acc: 0.8722
 Site-MNIST                     (1) | Train Loss: 0.6841 | Train Acc: 0.8264
 Site-MNIST                     (1) | Train Loss: 0.6594 | Train Acc: 0.8505
 Site-MNIST                     (1) | Train Loss: 0.6265 | Train Acc: 0.8657
 Site-USPS                      (1) | Train Loss: 0.5750 | Train Acc: 0.8500
 Site-USPS                      (1) | Train Loss: 0.7261 | Train Acc: 0.8611
 Site-USPS                      (1) | Train Loss: 0.4582 | Train Acc: 0.8372
 Site-USPS                      (1) | Train Loss: 0.7076 | Train Acc: 0.8412
 Site-USPS                      (1) | Train Loss: 0.6603 | Train Acc: 0.8452
 Site-USPS                      (1) | Train Loss: 0.6582 | Train Acc: 0.8479
 Site-SynthDigits               (2) | Train Loss: 1.3573 | Train Acc: 0.5563
 Site-SynthDigits               (2) | Train Loss: 1.3586 | Train Acc: 0.5678
 Site-SynthDigits               (2) | Train Loss: 1.3176 | Train Acc: 0.5967
 Site-MNIST_M                   (0) | Train Loss: 1.7486 | Train Acc: 0.4144
 Site-MNIST_M                   (0) | Train Loss: 1.6292 | Train Acc: 0.5413
 Site-SVHN                      (0) | Train Loss: 1.8705 | Train Acc: 0.3511
Average Train Accuracy: 0.7592
 Site-MNIST                     (1) | Val  Loss: 0.2313 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.2399 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.5076 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.7271 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.7054 | Val  Acc: 0.7647
 Site-MNIST                     (1) | Val  Loss: 0.6729 | Val  Acc: 0.8710
 Site-MNIST                     (1) | Val  Loss: 0.5992 | Val  Acc: 0.8750
 Site-MNIST                     (1) | Val  Loss: 0.6084 | Val  Acc: 0.8627
 Site-MNIST                     (1) | Val  Loss: 0.6806 | Val  Acc: 0.8361
 Site-MNIST                     (1) | Val  Loss: 0.6568 | Val  Acc: 0.8338
 Site-USPS                      (1) | Val  Loss: 0.5322 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.9506 | Val  Acc: 0.7778
 Site-USPS                      (1) | Val  Loss: 0.8831 | Val  Acc: 0.7812
 Site-USPS                      (1) | Val  Loss: 0.8817 | Val  Acc: 0.7931
 Site-USPS                      (1) | Val  Loss: 0.7306 | Val  Acc: 0.8286
 Site-USPS                      (1) | Val  Loss: 0.6592 | Val  Acc: 0.8571
 Site-SynthDigits               (2) | Val  Loss: 1.5019 | Val  Acc: 0.6216
 Site-SynthDigits               (2) | Val  Loss: 1.3522 | Val  Acc: 0.6324
 Site-SynthDigits               (2) | Val  Loss: 1.3437 | Val  Acc: 0.5902
 Site-MNIST_M                   (0) | Val  Loss: 1.7915 | Val  Acc: 0.4444
 Site-MNIST_M                   (0) | Val  Loss: 1.7527 | Val  Acc: 0.4938
 Site-SVHN                      (0) | Val  Loss: 1.8472 | Val  Acc: 0.3429
Average Valid Accuracy: 0.7584
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.7647
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8710
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8750
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8627
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8361
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8338
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.7778
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.7812
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.7931
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8286
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8571
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.6216
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.6324
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.5902
 Best site-MNIST_M                  (0)  | Epoch:6 | Val Acc: 0.4444
 Best site-MNIST_M                  (0)  | Epoch:6 | Val Acc: 0.4938
 Best site-SVHN                     (0)  | Epoch:6 | Val Acc: 0.3429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 7 ============
cnt=[16, 3, 3, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (0) | Train Loss: 0.7147 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.7250 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.5234 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.5175 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.5782 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.5735 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.5370 | Train Acc: 0.8767
 Site-MNIST                     (0) | Train Loss: 0.6504 | Train Acc: 0.8411
 Site-MNIST                     (0) | Train Loss: 0.6171 | Train Acc: 0.8628
 Site-MNIST                     (0) | Train Loss: 0.5773 | Train Acc: 0.8762
 Site-USPS                      (0) | Train Loss: 0.5435 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.5883 | Train Acc: 0.8750
 Site-USPS                      (0) | Train Loss: 0.5278 | Train Acc: 0.8372
 Site-USPS                      (0) | Train Loss: 0.6587 | Train Acc: 0.8412
 Site-USPS                      (0) | Train Loss: 0.6297 | Train Acc: 0.8357
 Site-USPS                      (0) | Train Loss: 0.6214 | Train Acc: 0.8519
 Site-SynthDigits               (2) | Train Loss: 1.3599 | Train Acc: 0.5563
 Site-SynthDigits               (2) | Train Loss: 1.3028 | Train Acc: 0.5861
 Site-SynthDigits               (2) | Train Loss: 1.2520 | Train Acc: 0.6232
 Site-MNIST_M                   (1) | Train Loss: 1.6784 | Train Acc: 0.4530
 Site-MNIST_M                   (1) | Train Loss: 1.5341 | Train Acc: 0.5505
 Site-SVHN                      (1) | Train Loss: 1.8477 | Train Acc: 0.3652
Average Train Accuracy: 0.7693
 Site-MNIST                     (0) | Val  Loss: 0.1876 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.2009 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4837 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.6812 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.6514 | Val  Acc: 0.8235
 Site-MNIST                     (0) | Val  Loss: 0.6210 | Val  Acc: 0.9032
 Site-MNIST                     (0) | Val  Loss: 0.5493 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.5598 | Val  Acc: 0.8725
 Site-MNIST                     (0) | Val  Loss: 0.6286 | Val  Acc: 0.8525
 Site-MNIST                     (0) | Val  Loss: 0.6078 | Val  Acc: 0.8489
 Site-USPS                      (0) | Val  Loss: 0.5018 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.9265 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.8612 | Val  Acc: 0.7500
 Site-USPS                      (0) | Val  Loss: 0.8476 | Val  Acc: 0.7759
 Site-USPS                      (0) | Val  Loss: 0.6959 | Val  Acc: 0.8381
 Site-USPS                      (0) | Val  Loss: 0.6241 | Val  Acc: 0.8624
 Site-SynthDigits               (2) | Val  Loss: 1.4320 | Val  Acc: 0.6757
 Site-SynthDigits               (2) | Val  Loss: 1.2573 | Val  Acc: 0.6618
 Site-SynthDigits               (2) | Val  Loss: 1.2755 | Val  Acc: 0.6311
 Site-MNIST_M                   (1) | Val  Loss: 1.7225 | Val  Acc: 0.4667
 Site-MNIST_M                   (1) | Val  Loss: 1.6873 | Val  Acc: 0.5185
 Site-SVHN                      (1) | Val  Loss: 1.8038 | Val  Acc: 0.3571
Average Valid Accuracy: 0.7729
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8235
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.9032
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8725
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8525
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8489
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.7500
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.7759
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.8381
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.8624
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.6757
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.6618
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.6311
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.4667
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.5185
 Best site-SVHN                     (1)  | Epoch:7 | Val Acc: 0.3571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 8 ============
cnt=[16, 3, 3, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (0) | Train Loss: 0.6979 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.7347 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.5205 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.4968 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.8249 | Train Acc: 0.8286
 Site-MNIST                     (0) | Train Loss: 0.5671 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.5134 | Train Acc: 0.8767
 Site-MNIST                     (0) | Train Loss: 0.6279 | Train Acc: 0.8362
 Site-MNIST                     (0) | Train Loss: 0.5968 | Train Acc: 0.8546
 Site-MNIST                     (0) | Train Loss: 0.5606 | Train Acc: 0.8687
 Site-USPS                      (0) | Train Loss: 0.5055 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.5023 | Train Acc: 0.8889
 Site-USPS                      (0) | Train Loss: 0.4097 | Train Acc: 0.8605
 Site-USPS                      (0) | Train Loss: 0.6507 | Train Acc: 0.8498
 Site-USPS                      (0) | Train Loss: 0.5738 | Train Acc: 0.8690
 Site-USPS                      (0) | Train Loss: 0.5843 | Train Acc: 0.8624
 Site-SynthDigits               (1) | Train Loss: 1.3165 | Train Acc: 0.6026
 Site-SynthDigits               (1) | Train Loss: 1.2070 | Train Acc: 0.6264
 Site-SynthDigits               (1) | Train Loss: 1.1892 | Train Acc: 0.6456
 Site-MNIST_M                   (2) | Train Loss: 1.6314 | Train Acc: 0.4696
 Site-MNIST_M                   (2) | Train Loss: 1.4430 | Train Acc: 0.5566
 Site-SVHN                      (2) | Train Loss: 1.7776 | Train Acc: 0.3901
Average Train Accuracy: 0.7734
 Site-MNIST                     (0) | Val  Loss: 0.1399 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1742 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4992 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.6955 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.6578 | Val  Acc: 0.8235
 Site-MNIST                     (0) | Val  Loss: 0.6035 | Val  Acc: 0.9032
 Site-MNIST                     (0) | Val  Loss: 0.5303 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.5404 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.6147 | Val  Acc: 0.8415
 Site-MNIST                     (0) | Val  Loss: 0.5900 | Val  Acc: 0.8399
 Site-USPS                      (0) | Val  Loss: 0.4499 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.8647 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.8216 | Val  Acc: 0.7812
 Site-USPS                      (0) | Val  Loss: 0.8243 | Val  Acc: 0.7931
 Site-USPS                      (0) | Val  Loss: 0.6661 | Val  Acc: 0.8381
 Site-USPS                      (0) | Val  Loss: 0.5861 | Val  Acc: 0.8730
 Site-SynthDigits               (1) | Val  Loss: 1.3624 | Val  Acc: 0.6757
 Site-SynthDigits               (1) | Val  Loss: 1.1655 | Val  Acc: 0.6912
 Site-SynthDigits               (1) | Val  Loss: 1.1891 | Val  Acc: 0.6885
 Site-MNIST_M                   (2) | Val  Loss: 1.6556 | Val  Acc: 0.4889
 Site-MNIST_M                   (2) | Val  Loss: 1.6309 | Val  Acc: 0.5432
 Site-SVHN                      (2) | Val  Loss: 1.7007 | Val  Acc: 0.3857
Average Valid Accuracy: 0.7825
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8235
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.9032
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8415
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8399
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.7812
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.7931
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.8381
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.8730
 Best site-SynthDigits              (1)  | Epoch:8 | Val Acc: 0.6757
 Best site-SynthDigits              (1)  | Epoch:8 | Val Acc: 0.6912
 Best site-SynthDigits              (1)  | Epoch:8 | Val Acc: 0.6885
 Best site-MNIST_M                  (2)  | Epoch:8 | Val Acc: 0.4889
 Best site-MNIST_M                  (2)  | Epoch:8 | Val Acc: 0.5432
 Best site-SVHN                     (2)  | Epoch:8 | Val Acc: 0.3857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 9 ============
cnt=[6, 6, 10, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (2) | Train Loss: 0.6895 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.6685 | Train Acc: 0.9167
 Site-MNIST                     (2) | Train Loss: 0.4701 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 0.4428 | Train Acc: 0.9474
 Site-MNIST                     (2) | Train Loss: 0.8546 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 0.5168 | Train Acc: 0.8492
 Site-MNIST                     (2) | Train Loss: 0.4754 | Train Acc: 0.8855
 Site-MNIST                     (2) | Train Loss: 0.5771 | Train Acc: 0.8557
 Site-MNIST                     (2) | Train Loss: 0.5505 | Train Acc: 0.8723
 Site-MNIST                     (2) | Train Loss: 0.5136 | Train Acc: 0.8868
 Site-USPS                      (0) | Train Loss: 0.4731 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.5856 | Train Acc: 0.8889
 Site-USPS                      (0) | Train Loss: 0.8736 | Train Acc: 0.8605
 Site-USPS                      (0) | Train Loss: 0.6103 | Train Acc: 0.8455
 Site-USPS                      (0) | Train Loss: 0.5515 | Train Acc: 0.8619
 Site-USPS                      (0) | Train Loss: 0.5581 | Train Acc: 0.8651
 Site-SynthDigits               (1) | Train Loss: 1.2857 | Train Acc: 0.6358
 Site-SynthDigits               (1) | Train Loss: 1.2069 | Train Acc: 0.6337
 Site-SynthDigits               (1) | Train Loss: 1.1188 | Train Acc: 0.6701
 Site-MNIST_M                   (1) | Train Loss: 1.5957 | Train Acc: 0.4641
 Site-MNIST_M                   (1) | Train Loss: 1.5000 | Train Acc: 0.5780
 Site-SVHN                      (1) | Train Loss: 1.7443 | Train Acc: 0.4043
Average Train Accuracy: 0.7872
 Site-MNIST                     (2) | Val  Loss: 0.1332 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1587 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.4734 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 0.6524 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.6020 | Val  Acc: 0.8235
 Site-MNIST                     (2) | Val  Loss: 0.5486 | Val  Acc: 0.9032
 Site-MNIST                     (2) | Val  Loss: 0.4813 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.4922 | Val  Acc: 0.8922
 Site-MNIST                     (2) | Val  Loss: 0.5647 | Val  Acc: 0.8689
 Site-MNIST                     (2) | Val  Loss: 0.5427 | Val  Acc: 0.8550
 Site-USPS                      (0) | Val  Loss: 0.4238 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.8371 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.7944 | Val  Acc: 0.7812
 Site-USPS                      (0) | Val  Loss: 0.7837 | Val  Acc: 0.7931
 Site-USPS                      (0) | Val  Loss: 0.6352 | Val  Acc: 0.8381
 Site-USPS                      (0) | Val  Loss: 0.5574 | Val  Acc: 0.8783
 Site-SynthDigits               (1) | Val  Loss: 1.2832 | Val  Acc: 0.7027
 Site-SynthDigits               (1) | Val  Loss: 1.0793 | Val  Acc: 0.6912
 Site-SynthDigits               (1) | Val  Loss: 1.1373 | Val  Acc: 0.7049
 Site-MNIST_M                   (1) | Val  Loss: 1.6269 | Val  Acc: 0.4889
 Site-MNIST_M                   (1) | Val  Loss: 1.5905 | Val  Acc: 0.5556
 Site-SVHN                      (1) | Val  Loss: 1.6666 | Val  Acc: 0.3714
Average Valid Accuracy: 0.7878
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8235
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.9032
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8922
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8689
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8550
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.7812
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.7931
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8381
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8783
 Best site-SynthDigits              (1)  | Epoch:9 | Val Acc: 0.7027
 Best site-SynthDigits              (1)  | Epoch:9 | Val Acc: 0.6912
 Best site-SynthDigits              (1)  | Epoch:9 | Val Acc: 0.7049
 Best site-MNIST_M                  (1)  | Epoch:9 | Val Acc: 0.4889
 Best site-MNIST_M                  (1)  | Epoch:9 | Val Acc: 0.5556
 Best site-SVHN                     (1)  | Epoch:9 | Val Acc: 0.3714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 10 ============
cnt=[3, 16, 3, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (1) | Train Loss: 0.6829 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.6253 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.4331 | Train Acc: 0.8571
 Site-MNIST                     (1) | Train Loss: 0.4066 | Train Acc: 0.9474
 Site-MNIST                     (1) | Train Loss: 0.5676 | Train Acc: 0.8714
 Site-MNIST                     (1) | Train Loss: 0.4769 | Train Acc: 0.8651
 Site-MNIST                     (1) | Train Loss: 0.4384 | Train Acc: 0.8987
 Site-MNIST                     (1) | Train Loss: 0.5259 | Train Acc: 0.8778
 Site-MNIST                     (1) | Train Loss: 0.5175 | Train Acc: 0.8777
 Site-MNIST                     (1) | Train Loss: 0.4798 | Train Acc: 0.8943
 Site-USPS                      (1) | Train Loss: 0.4707 | Train Acc: 0.8500
 Site-USPS                      (1) | Train Loss: 0.6477 | Train Acc: 0.9028
 Site-USPS                      (1) | Train Loss: 0.4743 | Train Acc: 0.8682
 Site-USPS                      (1) | Train Loss: 0.5905 | Train Acc: 0.8455
 Site-USPS                      (1) | Train Loss: 0.5273 | Train Acc: 0.8619
 Site-USPS                      (1) | Train Loss: 0.5360 | Train Acc: 0.8677
 Site-SynthDigits               (0) | Train Loss: 1.1652 | Train Acc: 0.6225
 Site-SynthDigits               (0) | Train Loss: 1.1616 | Train Acc: 0.6484
 Site-SynthDigits               (0) | Train Loss: 1.0792 | Train Acc: 0.6802
 Site-MNIST_M                   (2) | Train Loss: 1.5148 | Train Acc: 0.4696
 Site-MNIST_M                   (2) | Train Loss: 1.4677 | Train Acc: 0.5963
 Site-SVHN                      (2) | Train Loss: 1.6917 | Train Acc: 0.4574
Average Train Accuracy: 0.7959
 Site-MNIST                     (1) | Val  Loss: 0.1110 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1452 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4843 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.6547 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.5819 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.5212 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.4493 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.4613 | Val  Acc: 0.9118
 Site-MNIST                     (1) | Val  Loss: 0.5298 | Val  Acc: 0.8743
 Site-MNIST                     (1) | Val  Loss: 0.5110 | Val  Acc: 0.8701
 Site-USPS                      (1) | Val  Loss: 0.4114 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.8280 | Val  Acc: 0.7778
 Site-USPS                      (1) | Val  Loss: 0.7917 | Val  Acc: 0.7500
 Site-USPS                      (1) | Val  Loss: 0.7647 | Val  Acc: 0.7759
 Site-USPS                      (1) | Val  Loss: 0.6163 | Val  Acc: 0.8286
 Site-USPS                      (1) | Val  Loss: 0.5398 | Val  Acc: 0.8836
 Site-SynthDigits               (0) | Val  Loss: 1.2394 | Val  Acc: 0.7568
 Site-SynthDigits               (0) | Val  Loss: 1.0184 | Val  Acc: 0.7500
 Site-SynthDigits               (0) | Val  Loss: 1.0978 | Val  Acc: 0.7049
 Site-MNIST_M                   (2) | Val  Loss: 1.5545 | Val  Acc: 0.5111
 Site-MNIST_M                   (2) | Val  Loss: 1.5186 | Val  Acc: 0.5432
 Site-SVHN                      (2) | Val  Loss: 1.6320 | Val  Acc: 0.4286
Average Valid Accuracy: 0.8012
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.9118
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.8743
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.8701
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.7778
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.7500
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.7759
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.8286
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.8836
 Best site-SynthDigits              (0)  | Epoch:10 | Val Acc: 0.7568
 Best site-SynthDigits              (0)  | Epoch:10 | Val Acc: 0.7500
 Best site-SynthDigits              (0)  | Epoch:10 | Val Acc: 0.7049
 Best site-MNIST_M                  (2)  | Epoch:10 | Val Acc: 0.5111
 Best site-MNIST_M                  (2)  | Epoch:10 | Val Acc: 0.5432
 Best site-SVHN                     (2)  | Epoch:10 | Val Acc: 0.4286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 11 ============
cnt=[16, 3, 3, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (0) | Train Loss: 0.6514 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.6364 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4369 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.3886 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.4061 | Train Acc: 0.8286
 Site-MNIST                     (0) | Train Loss: 0.4806 | Train Acc: 0.8492
 Site-MNIST                     (0) | Train Loss: 0.4400 | Train Acc: 0.9075
 Site-MNIST                     (0) | Train Loss: 0.5288 | Train Acc: 0.8631
 Site-MNIST                     (0) | Train Loss: 0.5095 | Train Acc: 0.8696
 Site-MNIST                     (0) | Train Loss: 0.4705 | Train Acc: 0.8913
 Site-USPS                      (0) | Train Loss: 0.4327 | Train Acc: 0.9000
 Site-USPS                      (0) | Train Loss: 0.4223 | Train Acc: 0.9167
 Site-USPS                      (0) | Train Loss: 0.6247 | Train Acc: 0.8527
 Site-USPS                      (0) | Train Loss: 0.5601 | Train Acc: 0.8498
 Site-USPS                      (0) | Train Loss: 0.5111 | Train Acc: 0.8738
 Site-USPS                      (0) | Train Loss: 0.5165 | Train Acc: 0.8743
 Site-SynthDigits               (2) | Train Loss: 1.1360 | Train Acc: 0.6623
 Site-SynthDigits               (2) | Train Loss: 1.0952 | Train Acc: 0.6886
 Site-SynthDigits               (2) | Train Loss: 1.0184 | Train Acc: 0.7026
 Site-MNIST_M                   (1) | Train Loss: 1.4538 | Train Acc: 0.5249
 Site-MNIST_M                   (1) | Train Loss: 1.2364 | Train Acc: 0.6208
 Site-SVHN                      (1) | Train Loss: 1.6654 | Train Acc: 0.4468
Average Train Accuracy: 0.7985
 Site-MNIST                     (0) | Val  Loss: 0.0930 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1265 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4888 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.6528 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.5789 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.5135 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.4442 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.4557 | Val  Acc: 0.9020
 Site-MNIST                     (0) | Val  Loss: 0.5266 | Val  Acc: 0.8743
 Site-MNIST                     (0) | Val  Loss: 0.5022 | Val  Acc: 0.8822
 Site-USPS                      (0) | Val  Loss: 0.4022 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.7889 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.7643 | Val  Acc: 0.7500
 Site-USPS                      (0) | Val  Loss: 0.7522 | Val  Acc: 0.7759
 Site-USPS                      (0) | Val  Loss: 0.6034 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.5218 | Val  Acc: 0.8624
 Site-SynthDigits               (2) | Val  Loss: 1.1751 | Val  Acc: 0.7297
 Site-SynthDigits               (2) | Val  Loss: 0.9521 | Val  Acc: 0.7647
 Site-SynthDigits               (2) | Val  Loss: 1.0316 | Val  Acc: 0.7459
 Site-MNIST_M                   (1) | Val  Loss: 1.4806 | Val  Acc: 0.5333
 Site-MNIST_M                   (1) | Val  Loss: 1.4460 | Val  Acc: 0.5679
 Site-SVHN                      (1) | Val  Loss: 1.5756 | Val  Acc: 0.4143
Average Valid Accuracy: 0.8023
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.9020
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.8743
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.8822
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.7500
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.7759
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.8286
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.8624
 Best site-SynthDigits              (2)  | Epoch:11 | Val Acc: 0.7297
 Best site-SynthDigits              (2)  | Epoch:11 | Val Acc: 0.7647
 Best site-SynthDigits              (2)  | Epoch:11 | Val Acc: 0.7459
 Best site-MNIST_M                  (1)  | Epoch:11 | Val Acc: 0.5333
 Best site-MNIST_M                  (1)  | Epoch:11 | Val Acc: 0.5679
 Best site-SVHN                     (1)  | Epoch:11 | Val Acc: 0.4143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 12 ============
cnt=[6, 10, 6, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (1) | Train Loss: 0.6401 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.6015 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.3794 | Train Acc: 0.8571
 Site-MNIST                     (1) | Train Loss: 0.3507 | Train Acc: 0.9474
 Site-MNIST                     (1) | Train Loss: 0.4228 | Train Acc: 0.8714
 Site-MNIST                     (1) | Train Loss: 0.4310 | Train Acc: 0.8889
 Site-MNIST                     (1) | Train Loss: 0.3977 | Train Acc: 0.9075
 Site-MNIST                     (1) | Train Loss: 0.4909 | Train Acc: 0.8802
 Site-MNIST                     (1) | Train Loss: 0.4704 | Train Acc: 0.8927
 Site-MNIST                     (1) | Train Loss: 0.4346 | Train Acc: 0.9057
 Site-USPS                      (2) | Train Loss: 0.4277 | Train Acc: 0.8500
 Site-USPS                      (2) | Train Loss: 0.4102 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.4241 | Train Acc: 0.8605
 Site-USPS                      (2) | Train Loss: 0.5597 | Train Acc: 0.8283
 Site-USPS                      (2) | Train Loss: 0.4743 | Train Acc: 0.8595
 Site-USPS                      (2) | Train Loss: 0.4963 | Train Acc: 0.8743
 Site-SynthDigits               (0) | Train Loss: 1.1354 | Train Acc: 0.6623
 Site-SynthDigits               (0) | Train Loss: 1.0297 | Train Acc: 0.7070
 Site-SynthDigits               (0) | Train Loss: 0.9784 | Train Acc: 0.7108
 Site-MNIST_M                   (0) | Train Loss: 1.4096 | Train Acc: 0.5249
 Site-MNIST_M                   (0) | Train Loss: 1.2643 | Train Acc: 0.6239
 Site-SVHN                      (0) | Train Loss: 1.6307 | Train Acc: 0.4504
Average Train Accuracy: 0.8083
 Site-MNIST                     (1) | Val  Loss: 0.0838 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1072 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4674 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.6325 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.5419 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.4715 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.4038 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.4160 | Val  Acc: 0.9118
 Site-MNIST                     (1) | Val  Loss: 0.4844 | Val  Acc: 0.8798
 Site-MNIST                     (1) | Val  Loss: 0.4642 | Val  Acc: 0.8792
 Site-USPS                      (2) | Val  Loss: 0.3878 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.7912 | Val  Acc: 0.7778
 Site-USPS                      (2) | Val  Loss: 0.7636 | Val  Acc: 0.7188
 Site-USPS                      (2) | Val  Loss: 0.7318 | Val  Acc: 0.7586
 Site-USPS                      (2) | Val  Loss: 0.5845 | Val  Acc: 0.8190
 Site-USPS                      (2) | Val  Loss: 0.5040 | Val  Acc: 0.8677
 Site-SynthDigits               (0) | Val  Loss: 1.1158 | Val  Acc: 0.7297
 Site-SynthDigits               (0) | Val  Loss: 0.8990 | Val  Acc: 0.7647
 Site-SynthDigits               (0) | Val  Loss: 0.9838 | Val  Acc: 0.7295
 Site-MNIST_M                   (0) | Val  Loss: 1.4686 | Val  Acc: 0.5333
 Site-MNIST_M                   (0) | Val  Loss: 1.4220 | Val  Acc: 0.5679
 Site-SVHN                      (0) | Val  Loss: 1.4984 | Val  Acc: 0.4286
Average Valid Accuracy: 0.8012
============ Train epoch 13 ============
cnt=[6, 6, 10, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (2) | Train Loss: 0.6437 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.5667 | Train Acc: 0.9167
 Site-MNIST                     (2) | Train Loss: 0.3521 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 0.3292 | Train Acc: 0.9474
 Site-MNIST                     (2) | Train Loss: 0.6205 | Train Acc: 0.8714
 Site-MNIST                     (2) | Train Loss: 0.4054 | Train Acc: 0.9048
 Site-MNIST                     (2) | Train Loss: 0.3661 | Train Acc: 0.9075
 Site-MNIST                     (2) | Train Loss: 0.4577 | Train Acc: 0.8875
 Site-MNIST                     (2) | Train Loss: 0.4401 | Train Acc: 0.8995
 Site-MNIST                     (2) | Train Loss: 0.4077 | Train Acc: 0.9057
 Site-USPS                      (0) | Train Loss: 0.4173 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.3596 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.8007 | Train Acc: 0.8837
 Site-USPS                      (0) | Train Loss: 0.5341 | Train Acc: 0.8283
 Site-USPS                      (0) | Train Loss: 0.4753 | Train Acc: 0.8619
 Site-USPS                      (0) | Train Loss: 0.4846 | Train Acc: 0.8796
 Site-SynthDigits               (1) | Train Loss: 1.0096 | Train Acc: 0.6821
 Site-SynthDigits               (1) | Train Loss: 0.9682 | Train Acc: 0.7216
 Site-SynthDigits               (1) | Train Loss: 0.9267 | Train Acc: 0.7373
 Site-MNIST_M                   (1) | Train Loss: 1.3684 | Train Acc: 0.5470
 Site-MNIST_M                   (1) | Train Loss: 1.2407 | Train Acc: 0.6483
 Site-SVHN                      (1) | Train Loss: 1.5384 | Train Acc: 0.4823
Average Train Accuracy: 0.8174
 Site-MNIST                     (2) | Val  Loss: 0.0698 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1006 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.4575 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 0.6156 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.5134 | Val  Acc: 0.8824
 Site-MNIST                     (2) | Val  Loss: 0.4479 | Val  Acc: 0.9355
 Site-MNIST                     (2) | Val  Loss: 0.3811 | Val  Acc: 0.9643
 Site-MNIST                     (2) | Val  Loss: 0.3933 | Val  Acc: 0.9216
 Site-MNIST                     (2) | Val  Loss: 0.4597 | Val  Acc: 0.8852
 Site-MNIST                     (2) | Val  Loss: 0.4393 | Val  Acc: 0.8822
 Site-USPS                      (0) | Val  Loss: 0.3695 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.7676 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.7443 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 0.7093 | Val  Acc: 0.7586
 Site-USPS                      (0) | Val  Loss: 0.5695 | Val  Acc: 0.8190
 Site-USPS                      (0) | Val  Loss: 0.4910 | Val  Acc: 0.8730
 Site-SynthDigits               (1) | Val  Loss: 1.0473 | Val  Acc: 0.7297
 Site-SynthDigits               (1) | Val  Loss: 0.8168 | Val  Acc: 0.7794
 Site-SynthDigits               (1) | Val  Loss: 0.9414 | Val  Acc: 0.7377
 Site-MNIST_M                   (1) | Val  Loss: 1.4277 | Val  Acc: 0.5556
 Site-MNIST_M                   (1) | Val  Loss: 1.3664 | Val  Acc: 0.6173
 Site-SVHN                      (1) | Val  Loss: 1.4565 | Val  Acc: 0.4571
Average Valid Accuracy: 0.8079
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8824
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.9355
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.9643
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.9216
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8852
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8822
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.7188
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.7586
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.8190
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.8730
 Best site-SynthDigits              (1)  | Epoch:13 | Val Acc: 0.7297
 Best site-SynthDigits              (1)  | Epoch:13 | Val Acc: 0.7794
 Best site-SynthDigits              (1)  | Epoch:13 | Val Acc: 0.7377
 Best site-MNIST_M                  (1)  | Epoch:13 | Val Acc: 0.5556
 Best site-MNIST_M                  (1)  | Epoch:13 | Val Acc: 0.6173
 Best site-SVHN                     (1)  | Epoch:13 | Val Acc: 0.4571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 14 ============
cnt=[6, 6, 10, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (2) | Train Loss: 0.6363 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.5694 | Train Acc: 0.9167
 Site-MNIST                     (2) | Train Loss: 0.3452 | Train Acc: 0.9048
 Site-MNIST                     (2) | Train Loss: 0.3094 | Train Acc: 0.9211
 Site-MNIST                     (2) | Train Loss: 0.4674 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 0.3981 | Train Acc: 0.8889
 Site-MNIST                     (2) | Train Loss: 0.3479 | Train Acc: 0.9119
 Site-MNIST                     (2) | Train Loss: 0.4437 | Train Acc: 0.8875
 Site-MNIST                     (2) | Train Loss: 0.4313 | Train Acc: 0.8927
 Site-MNIST                     (2) | Train Loss: 0.3975 | Train Acc: 0.9072
 Site-USPS                      (0) | Train Loss: 0.3929 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.4917 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.4356 | Train Acc: 0.8915
 Site-USPS                      (0) | Train Loss: 0.5037 | Train Acc: 0.8412
 Site-USPS                      (0) | Train Loss: 0.4397 | Train Acc: 0.8810
 Site-USPS                      (0) | Train Loss: 0.4596 | Train Acc: 0.8889
 Site-SynthDigits               (1) | Train Loss: 0.9565 | Train Acc: 0.6954
 Site-SynthDigits               (1) | Train Loss: 0.9469 | Train Acc: 0.7216
 Site-SynthDigits               (1) | Train Loss: 0.8799 | Train Acc: 0.7434
 Site-MNIST_M                   (1) | Train Loss: 1.3459 | Train Acc: 0.5856
 Site-MNIST_M                   (1) | Train Loss: 1.2700 | Train Acc: 0.6483
 Site-SVHN                      (1) | Train Loss: 1.5296 | Train Acc: 0.5035
Average Train Accuracy: 0.8235
 Site-MNIST                     (2) | Val  Loss: 0.0605 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.0842 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.4484 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 0.6056 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.5056 | Val  Acc: 0.8824
 Site-MNIST                     (2) | Val  Loss: 0.4353 | Val  Acc: 0.9355
 Site-MNIST                     (2) | Val  Loss: 0.3721 | Val  Acc: 0.9643
 Site-MNIST                     (2) | Val  Loss: 0.3833 | Val  Acc: 0.9118
 Site-MNIST                     (2) | Val  Loss: 0.4491 | Val  Acc: 0.8798
 Site-MNIST                     (2) | Val  Loss: 0.4290 | Val  Acc: 0.8792
 Site-USPS                      (0) | Val  Loss: 0.3492 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.7391 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.7158 | Val  Acc: 0.7500
 Site-USPS                      (0) | Val  Loss: 0.6860 | Val  Acc: 0.7759
 Site-USPS                      (0) | Val  Loss: 0.5495 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.4682 | Val  Acc: 0.8730
 Site-SynthDigits               (1) | Val  Loss: 0.9992 | Val  Acc: 0.7568
 Site-SynthDigits               (1) | Val  Loss: 0.7742 | Val  Acc: 0.7647
 Site-SynthDigits               (1) | Val  Loss: 0.8946 | Val  Acc: 0.7295
 Site-MNIST_M                   (1) | Val  Loss: 1.3836 | Val  Acc: 0.6222
 Site-MNIST_M                   (1) | Val  Loss: 1.3199 | Val  Acc: 0.6420
 Site-SVHN                      (1) | Val  Loss: 1.3605 | Val  Acc: 0.4714
Average Valid Accuracy: 0.8147
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8824
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.9355
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.9643
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.9118
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8798
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8792
 Best site-USPS                     (0)  | Epoch:14 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:14 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:14 | Val Acc: 0.7500
 Best site-USPS                     (0)  | Epoch:14 | Val Acc: 0.7759
 Best site-USPS                     (0)  | Epoch:14 | Val Acc: 0.8286
 Best site-USPS                     (0)  | Epoch:14 | Val Acc: 0.8730
 Best site-SynthDigits              (1)  | Epoch:14 | Val Acc: 0.7568
 Best site-SynthDigits              (1)  | Epoch:14 | Val Acc: 0.7647
 Best site-SynthDigits              (1)  | Epoch:14 | Val Acc: 0.7295
 Best site-MNIST_M                  (1)  | Epoch:14 | Val Acc: 0.6222
 Best site-MNIST_M                  (1)  | Epoch:14 | Val Acc: 0.6420
 Best site-SVHN                     (1)  | Epoch:14 | Val Acc: 0.4714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 15 ============
cnt=[6, 6, 10, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (2) | Train Loss: 0.6270 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.5483 | Train Acc: 0.9167
 Site-MNIST                     (2) | Train Loss: 0.3203 | Train Acc: 0.9048
 Site-MNIST                     (2) | Train Loss: 0.2923 | Train Acc: 0.9474
 Site-MNIST                     (2) | Train Loss: 0.2733 | Train Acc: 0.8714
 Site-MNIST                     (2) | Train Loss: 0.3681 | Train Acc: 0.9048
 Site-MNIST                     (2) | Train Loss: 0.3368 | Train Acc: 0.9119
 Site-MNIST                     (2) | Train Loss: 0.4220 | Train Acc: 0.8900
 Site-MNIST                     (2) | Train Loss: 0.4130 | Train Acc: 0.9062
 Site-MNIST                     (2) | Train Loss: 0.3748 | Train Acc: 0.9117
 Site-USPS                      (1) | Train Loss: 0.4153 | Train Acc: 0.8500
 Site-USPS                      (1) | Train Loss: 0.5957 | Train Acc: 0.9444
 Site-USPS                      (1) | Train Loss: 0.3268 | Train Acc: 0.8837
 Site-USPS                      (1) | Train Loss: 0.5149 | Train Acc: 0.8369
 Site-USPS                      (1) | Train Loss: 0.4397 | Train Acc: 0.8738
 Site-USPS                      (1) | Train Loss: 0.4544 | Train Acc: 0.8823
 Site-SynthDigits               (0) | Train Loss: 0.9300 | Train Acc: 0.7020
 Site-SynthDigits               (0) | Train Loss: 0.9342 | Train Acc: 0.7326
 Site-SynthDigits               (0) | Train Loss: 0.8274 | Train Acc: 0.7821
 Site-MNIST_M                   (0) | Train Loss: 1.2689 | Train Acc: 0.6022
 Site-MNIST_M                   (0) | Train Loss: 1.1697 | Train Acc: 0.6453
 Site-SVHN                      (0) | Train Loss: 1.5113 | Train Acc: 0.5106
Average Train Accuracy: 0.8293
 Site-MNIST                     (2) | Val  Loss: 0.0518 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.0739 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.4802 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 0.6264 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.5065 | Val  Acc: 0.8824
 Site-MNIST                     (2) | Val  Loss: 0.4161 | Val  Acc: 0.9355
 Site-MNIST                     (2) | Val  Loss: 0.3502 | Val  Acc: 0.9643
 Site-MNIST                     (2) | Val  Loss: 0.3639 | Val  Acc: 0.9216
 Site-MNIST                     (2) | Val  Loss: 0.4295 | Val  Acc: 0.8907
 Site-MNIST                     (2) | Val  Loss: 0.4119 | Val  Acc: 0.8943
 Site-USPS                      (1) | Val  Loss: 0.3411 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.7453 | Val  Acc: 0.7778
 Site-USPS                      (1) | Val  Loss: 0.7261 | Val  Acc: 0.7500
 Site-USPS                      (1) | Val  Loss: 0.6829 | Val  Acc: 0.7586
 Site-USPS                      (1) | Val  Loss: 0.5457 | Val  Acc: 0.8095
 Site-USPS                      (1) | Val  Loss: 0.4637 | Val  Acc: 0.8730
 Site-SynthDigits               (0) | Val  Loss: 0.9584 | Val  Acc: 0.7568
 Site-SynthDigits               (0) | Val  Loss: 0.7464 | Val  Acc: 0.8088
 Site-SynthDigits               (0) | Val  Loss: 0.8477 | Val  Acc: 0.7705
 Site-MNIST_M                   (0) | Val  Loss: 1.3182 | Val  Acc: 0.6000
 Site-MNIST_M                   (0) | Val  Loss: 1.2592 | Val  Acc: 0.6790
 Site-SVHN                      (0) | Val  Loss: 1.2769 | Val  Acc: 0.5143
Average Valid Accuracy: 0.8211
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8824
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.9355
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.9643
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.9216
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8907
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8943
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.7778
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.7500
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.7586
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.8095
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.8730
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.7568
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.8088
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.7705
 Best site-MNIST_M                  (0)  | Epoch:15 | Val Acc: 0.6000
 Best site-MNIST_M                  (0)  | Epoch:15 | Val Acc: 0.6790
 Best site-SVHN                     (0)  | Epoch:15 | Val Acc: 0.5143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 16 ============
cnt=[16, 4, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (0) | Train Loss: 0.6057 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.5216 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.3059 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.2744 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.2787 | Train Acc: 0.8714
 Site-MNIST                     (0) | Train Loss: 0.3546 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.3207 | Train Acc: 0.9163
 Site-MNIST                     (0) | Train Loss: 0.4179 | Train Acc: 0.8973
 Site-MNIST                     (0) | Train Loss: 0.3941 | Train Acc: 0.9076
 Site-MNIST                     (0) | Train Loss: 0.3586 | Train Acc: 0.9117
 Site-USPS                      (0) | Train Loss: 0.3939 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.4318 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.5130 | Train Acc: 0.8915
 Site-USPS                      (0) | Train Loss: 0.5005 | Train Acc: 0.8455
 Site-USPS                      (0) | Train Loss: 0.4249 | Train Acc: 0.8976
 Site-USPS                      (0) | Train Loss: 0.4453 | Train Acc: 0.8849
 Site-SynthDigits               (1) | Train Loss: 0.9058 | Train Acc: 0.7285
 Site-SynthDigits               (1) | Train Loss: 0.8596 | Train Acc: 0.7473
 Site-SynthDigits               (1) | Train Loss: 0.7946 | Train Acc: 0.7963
 Site-MNIST_M                   (2) | Train Loss: 1.2045 | Train Acc: 0.6188
 Site-MNIST_M                   (2) | Train Loss: 1.0945 | Train Acc: 0.6728
 Site-SVHN                      (1) | Train Loss: 1.4354 | Train Acc: 0.5319
Average Train Accuracy: 0.8361
 Site-MNIST                     (0) | Val  Loss: 0.0508 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0707 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4771 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.6149 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4919 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.3981 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.3353 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.3492 | Val  Acc: 0.9216
 Site-MNIST                     (0) | Val  Loss: 0.4149 | Val  Acc: 0.9016
 Site-MNIST                     (0) | Val  Loss: 0.3975 | Val  Acc: 0.8912
 Site-USPS                      (0) | Val  Loss: 0.3284 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.7181 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.7034 | Val  Acc: 0.7500
 Site-USPS                      (0) | Val  Loss: 0.6619 | Val  Acc: 0.7759
 Site-USPS                      (0) | Val  Loss: 0.5366 | Val  Acc: 0.8095
 Site-USPS                      (0) | Val  Loss: 0.4533 | Val  Acc: 0.8783
 Site-SynthDigits               (1) | Val  Loss: 0.9086 | Val  Acc: 0.7838
 Site-SynthDigits               (1) | Val  Loss: 0.7116 | Val  Acc: 0.8235
 Site-SynthDigits               (1) | Val  Loss: 0.8205 | Val  Acc: 0.7705
 Site-MNIST_M                   (2) | Val  Loss: 1.2654 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 1.1918 | Val  Acc: 0.6790
 Site-SVHN                      (1) | Val  Loss: 1.2705 | Val  Acc: 0.5286
Average Valid Accuracy: 0.8263
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9216
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9016
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.8912
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.7500
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.7759
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.8095
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.8783
 Best site-SynthDigits              (1)  | Epoch:16 | Val Acc: 0.7838
 Best site-SynthDigits              (1)  | Epoch:16 | Val Acc: 0.8235
 Best site-SynthDigits              (1)  | Epoch:16 | Val Acc: 0.7705
 Best site-MNIST_M                  (2)  | Epoch:16 | Val Acc: 0.6444
 Best site-MNIST_M                  (2)  | Epoch:16 | Val Acc: 0.6790
 Best site-SVHN                     (1)  | Epoch:16 | Val Acc: 0.5286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 17 ============
cnt=[10, 9, 3, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (0) | Train Loss: 0.6118 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.5014 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.2994 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.2634 | Train Acc: 0.8947
 Site-MNIST                     (0) | Train Loss: 0.5976 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.3466 | Train Acc: 0.8968
 Site-MNIST                     (0) | Train Loss: 0.3093 | Train Acc: 0.9207
 Site-MNIST                     (0) | Train Loss: 0.4017 | Train Acc: 0.8924
 Site-MNIST                     (0) | Train Loss: 0.3841 | Train Acc: 0.9090
 Site-MNIST                     (0) | Train Loss: 0.3488 | Train Acc: 0.9109
 Site-USPS                      (1) | Train Loss: 0.3589 | Train Acc: 0.9000
 Site-USPS                      (1) | Train Loss: 0.3197 | Train Acc: 0.9444
 Site-USPS                      (1) | Train Loss: 0.3800 | Train Acc: 0.8992
 Site-USPS                      (1) | Train Loss: 0.4565 | Train Acc: 0.8498
 Site-USPS                      (1) | Train Loss: 0.3829 | Train Acc: 0.9071
 Site-USPS                      (1) | Train Loss: 0.4105 | Train Acc: 0.8955
 Site-SynthDigits               (1) | Train Loss: 0.8822 | Train Acc: 0.7351
 Site-SynthDigits               (1) | Train Loss: 0.7970 | Train Acc: 0.7619
 Site-SynthDigits               (1) | Train Loss: 0.7844 | Train Acc: 0.7821
 Site-MNIST_M                   (2) | Train Loss: 1.1773 | Train Acc: 0.6298
 Site-MNIST_M                   (2) | Train Loss: 1.1208 | Train Acc: 0.6728
 Site-SVHN                      (2) | Train Loss: 1.3602 | Train Acc: 0.5355
Average Train Accuracy: 0.8386
 Site-MNIST                     (0) | Val  Loss: 0.0382 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0602 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4458 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5803 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4674 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.3865 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.3267 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.3383 | Val  Acc: 0.9216
 Site-MNIST                     (0) | Val  Loss: 0.4032 | Val  Acc: 0.9016
 Site-MNIST                     (0) | Val  Loss: 0.3871 | Val  Acc: 0.8973
 Site-USPS                      (1) | Val  Loss: 0.2937 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.6841 | Val  Acc: 0.8333
 Site-USPS                      (1) | Val  Loss: 0.6595 | Val  Acc: 0.7812
 Site-USPS                      (1) | Val  Loss: 0.6320 | Val  Acc: 0.7759
 Site-USPS                      (1) | Val  Loss: 0.5089 | Val  Acc: 0.8190
 Site-USPS                      (1) | Val  Loss: 0.4239 | Val  Acc: 0.8836
 Site-SynthDigits               (1) | Val  Loss: 0.8837 | Val  Acc: 0.7838
 Site-SynthDigits               (1) | Val  Loss: 0.6827 | Val  Acc: 0.7941
 Site-SynthDigits               (1) | Val  Loss: 0.8002 | Val  Acc: 0.7705
 Site-MNIST_M                   (2) | Val  Loss: 1.2180 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 1.1434 | Val  Acc: 0.6790
 Site-SVHN                      (2) | Val  Loss: 1.2109 | Val  Acc: 0.5429
Average Valid Accuracy: 0.8313
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9216
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9016
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.8973
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.8333
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.7812
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.7759
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.8190
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.8836
 Best site-SynthDigits              (1)  | Epoch:17 | Val Acc: 0.7838
 Best site-SynthDigits              (1)  | Epoch:17 | Val Acc: 0.7941
 Best site-SynthDigits              (1)  | Epoch:17 | Val Acc: 0.7705
 Best site-MNIST_M                  (2)  | Epoch:17 | Val Acc: 0.6444
 Best site-MNIST_M                  (2)  | Epoch:17 | Val Acc: 0.6790
 Best site-SVHN                     (2)  | Epoch:17 | Val Acc: 0.5429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 18 ============
cnt=[6, 10, 6, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (1) | Train Loss: 0.5913 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4943 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.2706 | Train Acc: 0.9048
 Site-MNIST                     (1) | Train Loss: 0.2404 | Train Acc: 0.9474
 Site-MNIST                     (1) | Train Loss: 0.2958 | Train Acc: 0.8714
 Site-MNIST                     (1) | Train Loss: 0.3231 | Train Acc: 0.9206
 Site-MNIST                     (1) | Train Loss: 0.2971 | Train Acc: 0.9207
 Site-MNIST                     (1) | Train Loss: 0.3991 | Train Acc: 0.8998
 Site-MNIST                     (1) | Train Loss: 0.3643 | Train Acc: 0.9103
 Site-MNIST                     (1) | Train Loss: 0.3294 | Train Acc: 0.9170
 Site-USPS                      (2) | Train Loss: 0.3636 | Train Acc: 0.8500
 Site-USPS                      (2) | Train Loss: 0.3962 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.4009 | Train Acc: 0.8915
 Site-USPS                      (2) | Train Loss: 0.4686 | Train Acc: 0.8498
 Site-USPS                      (2) | Train Loss: 0.3963 | Train Acc: 0.8929
 Site-USPS                      (2) | Train Loss: 0.4165 | Train Acc: 0.8955
 Site-SynthDigits               (0) | Train Loss: 0.9076 | Train Acc: 0.7351
 Site-SynthDigits               (0) | Train Loss: 0.7645 | Train Acc: 0.7656
 Site-SynthDigits               (0) | Train Loss: 0.7421 | Train Acc: 0.8126
 Site-MNIST_M                   (0) | Train Loss: 1.1747 | Train Acc: 0.6464
 Site-MNIST_M                   (0) | Train Loss: 0.9967 | Train Acc: 0.6972
 Site-SVHN                      (0) | Train Loss: 1.3665 | Train Acc: 0.5567
Average Train Accuracy: 0.8445
 Site-MNIST                     (1) | Val  Loss: 0.0407 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0577 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4478 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5744 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.4531 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.3620 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.3065 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.3196 | Val  Acc: 0.9314
 Site-MNIST                     (1) | Val  Loss: 0.3867 | Val  Acc: 0.9071
 Site-MNIST                     (1) | Val  Loss: 0.3687 | Val  Acc: 0.9033
 Site-USPS                      (2) | Val  Loss: 0.2993 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.6930 | Val  Acc: 0.7778
 Site-USPS                      (2) | Val  Loss: 0.6762 | Val  Acc: 0.7500
 Site-USPS                      (2) | Val  Loss: 0.6355 | Val  Acc: 0.7931
 Site-USPS                      (2) | Val  Loss: 0.5128 | Val  Acc: 0.8286
 Site-USPS                      (2) | Val  Loss: 0.4278 | Val  Acc: 0.8783
 Site-SynthDigits               (0) | Val  Loss: 0.8298 | Val  Acc: 0.7838
 Site-SynthDigits               (0) | Val  Loss: 0.6470 | Val  Acc: 0.8235
 Site-SynthDigits               (0) | Val  Loss: 0.7491 | Val  Acc: 0.8033
 Site-MNIST_M                   (0) | Val  Loss: 1.2201 | Val  Acc: 0.6222
 Site-MNIST_M                   (0) | Val  Loss: 1.1217 | Val  Acc: 0.7160
 Site-SVHN                      (0) | Val  Loss: 1.1162 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8333
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9314
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9071
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9033
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.7778
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.7500
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.7931
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.8286
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.8783
 Best site-SynthDigits              (0)  | Epoch:18 | Val Acc: 0.7838
 Best site-SynthDigits              (0)  | Epoch:18 | Val Acc: 0.8235
 Best site-SynthDigits              (0)  | Epoch:18 | Val Acc: 0.8033
 Best site-MNIST_M                  (0)  | Epoch:18 | Val Acc: 0.6222
 Best site-MNIST_M                  (0)  | Epoch:18 | Val Acc: 0.7160
 Best site-SVHN                     (0)  | Epoch:18 | Val Acc: 0.5714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 19 ============
cnt=[10, 6, 6, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (0) | Train Loss: 0.6000 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4540 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.2497 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.2244 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.5484 | Train Acc: 0.9000
 Site-MNIST                     (0) | Train Loss: 0.2978 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.2737 | Train Acc: 0.9427
 Site-MNIST                     (0) | Train Loss: 0.3559 | Train Acc: 0.9095
 Site-MNIST                     (0) | Train Loss: 0.3428 | Train Acc: 0.9130
 Site-MNIST                     (0) | Train Loss: 0.3109 | Train Acc: 0.9260
 Site-USPS                      (1) | Train Loss: 0.3633 | Train Acc: 0.8750
 Site-USPS                      (1) | Train Loss: 0.3412 | Train Acc: 0.9444
 Site-USPS                      (1) | Train Loss: 0.3547 | Train Acc: 0.8915
 Site-USPS                      (1) | Train Loss: 0.4664 | Train Acc: 0.8369
 Site-USPS                      (1) | Train Loss: 0.3908 | Train Acc: 0.9119
 Site-USPS                      (1) | Train Loss: 0.4066 | Train Acc: 0.8929
 Site-SynthDigits               (2) | Train Loss: 0.7749 | Train Acc: 0.7550
 Site-SynthDigits               (2) | Train Loss: 0.7304 | Train Acc: 0.7875
 Site-SynthDigits               (2) | Train Loss: 0.7117 | Train Acc: 0.8248
 Site-MNIST_M                   (2) | Train Loss: 1.1220 | Train Acc: 0.6575
 Site-MNIST_M                   (2) | Train Loss: 1.0663 | Train Acc: 0.7064
 Site-SVHN                      (2) | Train Loss: 1.3146 | Train Acc: 0.5709
Average Train Accuracy: 0.8545
 Site-MNIST                     (0) | Val  Loss: 0.0343 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0519 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4541 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5754 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4373 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.3409 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2851 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.3010 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.3654 | Val  Acc: 0.9180
 Site-MNIST                     (0) | Val  Loss: 0.3513 | Val  Acc: 0.9215
 Site-USPS                      (1) | Val  Loss: 0.2829 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.6962 | Val  Acc: 0.7778
 Site-USPS                      (1) | Val  Loss: 0.6781 | Val  Acc: 0.7500
 Site-USPS                      (1) | Val  Loss: 0.6192 | Val  Acc: 0.7931
 Site-USPS                      (1) | Val  Loss: 0.5054 | Val  Acc: 0.8286
 Site-USPS                      (1) | Val  Loss: 0.4232 | Val  Acc: 0.8783
 Site-SynthDigits               (2) | Val  Loss: 0.8036 | Val  Acc: 0.7838
 Site-SynthDigits               (2) | Val  Loss: 0.5966 | Val  Acc: 0.8235
 Site-SynthDigits               (2) | Val  Loss: 0.7264 | Val  Acc: 0.7787
 Site-MNIST_M                   (2) | Val  Loss: 1.1822 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 1.0827 | Val  Acc: 0.7037
 Site-SVHN                      (2) | Val  Loss: 1.0545 | Val  Acc: 0.5857
Average Valid Accuracy: 0.8358
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9412
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9180
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9215
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.7778
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.7500
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.7931
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.8286
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.8783
 Best site-SynthDigits              (2)  | Epoch:19 | Val Acc: 0.7838
 Best site-SynthDigits              (2)  | Epoch:19 | Val Acc: 0.8235
 Best site-SynthDigits              (2)  | Epoch:19 | Val Acc: 0.7787
 Best site-MNIST_M                  (2)  | Epoch:19 | Val Acc: 0.6444
 Best site-MNIST_M                  (2)  | Epoch:19 | Val Acc: 0.7037
 Best site-SVHN                     (2)  | Epoch:19 | Val Acc: 0.5857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 20 ============
cnt=[10, 4, 8, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (0) | Train Loss: 0.6007 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4422 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.2391 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.2158 | Train Acc: 0.9474
 Site-MNIST                     (0) | Train Loss: 0.5299 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.2856 | Train Acc: 0.9365
 Site-MNIST                     (0) | Train Loss: 0.2651 | Train Acc: 0.9427
 Site-MNIST                     (0) | Train Loss: 0.3579 | Train Acc: 0.9071
 Site-MNIST                     (0) | Train Loss: 0.3413 | Train Acc: 0.9130
 Site-MNIST                     (0) | Train Loss: 0.2963 | Train Acc: 0.9268
 Site-USPS                      (2) | Train Loss: 0.3354 | Train Acc: 0.9000
 Site-USPS                      (2) | Train Loss: 0.6381 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.8422 | Train Acc: 0.8992
 Site-USPS                      (2) | Train Loss: 0.4357 | Train Acc: 0.8541
 Site-USPS                      (2) | Train Loss: 0.3418 | Train Acc: 0.9238
 Site-USPS                      (2) | Train Loss: 0.3709 | Train Acc: 0.9021
 Site-SynthDigits               (1) | Train Loss: 0.8415 | Train Acc: 0.7616
 Site-SynthDigits               (1) | Train Loss: 0.7463 | Train Acc: 0.7802
 Site-SynthDigits               (1) | Train Loss: 0.6986 | Train Acc: 0.8126
 Site-MNIST_M                   (2) | Train Loss: 1.1206 | Train Acc: 0.6354
 Site-MNIST_M                   (2) | Train Loss: 1.0199 | Train Acc: 0.7034
 Site-SVHN                      (1) | Train Loss: 1.2938 | Train Acc: 0.5993
Average Train Accuracy: 0.8594
 Site-MNIST                     (0) | Val  Loss: 0.0291 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0459 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4489 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5611 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4263 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.3307 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2786 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.2915 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.3537 | Val  Acc: 0.9180
 Site-MNIST                     (0) | Val  Loss: 0.3417 | Val  Acc: 0.9154
 Site-USPS                      (2) | Val  Loss: 0.2425 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.6486 | Val  Acc: 0.7778
 Site-USPS                      (2) | Val  Loss: 0.6285 | Val  Acc: 0.8125
 Site-USPS                      (2) | Val  Loss: 0.5882 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.4703 | Val  Acc: 0.8476
 Site-USPS                      (2) | Val  Loss: 0.3877 | Val  Acc: 0.8889
 Site-SynthDigits               (1) | Val  Loss: 0.7803 | Val  Acc: 0.7838
 Site-SynthDigits               (1) | Val  Loss: 0.5527 | Val  Acc: 0.8088
 Site-SynthDigits               (1) | Val  Loss: 0.6898 | Val  Acc: 0.8033
 Site-MNIST_M                   (2) | Val  Loss: 1.1674 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 1.0650 | Val  Acc: 0.7160
 Site-SVHN                      (1) | Val  Loss: 1.0156 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8435
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9412
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9180
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9154
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.7778
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.8125
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.8476
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.8889
 Best site-SynthDigits              (1)  | Epoch:20 | Val Acc: 0.7838
 Best site-SynthDigits              (1)  | Epoch:20 | Val Acc: 0.8088
 Best site-SynthDigits              (1)  | Epoch:20 | Val Acc: 0.8033
 Best site-MNIST_M                  (2)  | Epoch:20 | Val Acc: 0.6444
 Best site-MNIST_M                  (2)  | Epoch:20 | Val Acc: 0.7160
 Best site-SVHN                     (1)  | Epoch:20 | Val Acc: 0.6286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 21 ============
cnt=[3, 10, 9, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (1) | Train Loss: 0.5678 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4245 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.2166 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.2037 | Train Acc: 0.9474
 Site-MNIST                     (1) | Train Loss: 0.4412 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.2671 | Train Acc: 0.9444
 Site-MNIST                     (1) | Train Loss: 0.2599 | Train Acc: 0.9383
 Site-MNIST                     (1) | Train Loss: 0.3466 | Train Acc: 0.9144
 Site-MNIST                     (1) | Train Loss: 0.3228 | Train Acc: 0.9212
 Site-MNIST                     (1) | Train Loss: 0.2848 | Train Acc: 0.9298
 Site-USPS                      (2) | Train Loss: 0.3214 | Train Acc: 0.9000
 Site-USPS                      (2) | Train Loss: 0.4896 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.3941 | Train Acc: 0.9070
 Site-USPS                      (2) | Train Loss: 0.4295 | Train Acc: 0.8455
 Site-USPS                      (2) | Train Loss: 0.3329 | Train Acc: 0.9238
 Site-USPS                      (2) | Train Loss: 0.3562 | Train Acc: 0.9074
 Site-SynthDigits               (2) | Train Loss: 0.7647 | Train Acc: 0.7682
 Site-SynthDigits               (2) | Train Loss: 0.7596 | Train Acc: 0.7875
 Site-SynthDigits               (2) | Train Loss: 0.6834 | Train Acc: 0.8208
 Site-MNIST_M                   (0) | Train Loss: 1.0522 | Train Acc: 0.7017
 Site-MNIST_M                   (0) | Train Loss: 0.9591 | Train Acc: 0.7064
 Site-SVHN                      (0) | Train Loss: 1.2971 | Train Acc: 0.6170
Average Train Accuracy: 0.8655
 Site-MNIST                     (1) | Val  Loss: 0.0273 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0426 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4385 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5329 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.4068 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.3161 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2684 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2788 | Val  Acc: 0.9314
 Site-MNIST                     (1) | Val  Loss: 0.3421 | Val  Acc: 0.9126
 Site-MNIST                     (1) | Val  Loss: 0.3284 | Val  Acc: 0.9124
 Site-USPS                      (2) | Val  Loss: 0.2348 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.6307 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.6097 | Val  Acc: 0.8125
 Site-USPS                      (2) | Val  Loss: 0.5708 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.4577 | Val  Acc: 0.8476
 Site-USPS                      (2) | Val  Loss: 0.3739 | Val  Acc: 0.8889
 Site-SynthDigits               (2) | Val  Loss: 0.7644 | Val  Acc: 0.7838
 Site-SynthDigits               (2) | Val  Loss: 0.5474 | Val  Acc: 0.8382
 Site-SynthDigits               (2) | Val  Loss: 0.6868 | Val  Acc: 0.8033
 Site-MNIST_M                   (0) | Val  Loss: 1.1334 | Val  Acc: 0.6444
 Site-MNIST_M                   (0) | Val  Loss: 1.0149 | Val  Acc: 0.7407
 Site-SVHN                      (0) | Val  Loss: 1.0215 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8455
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9314
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9126
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9124
 Best site-USPS                     (2)  | Epoch:21 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:21 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:21 | Val Acc: 0.8125
 Best site-USPS                     (2)  | Epoch:21 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:21 | Val Acc: 0.8476
 Best site-USPS                     (2)  | Epoch:21 | Val Acc: 0.8889
 Best site-SynthDigits              (2)  | Epoch:21 | Val Acc: 0.7838
 Best site-SynthDigits              (2)  | Epoch:21 | Val Acc: 0.8382
 Best site-SynthDigits              (2)  | Epoch:21 | Val Acc: 0.8033
 Best site-MNIST_M                  (0)  | Epoch:21 | Val Acc: 0.6444
 Best site-MNIST_M                  (0)  | Epoch:21 | Val Acc: 0.7407
 Best site-SVHN                     (0)  | Epoch:21 | Val Acc: 0.6000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 22 ============
cnt=[10, 8, 4, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (0) | Train Loss: 0.5658 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4086 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.2084 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1875 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.3421 | Train Acc: 0.9000
 Site-MNIST                     (0) | Train Loss: 0.2578 | Train Acc: 0.9444
 Site-MNIST                     (0) | Train Loss: 0.2520 | Train Acc: 0.9471
 Site-MNIST                     (0) | Train Loss: 0.3193 | Train Acc: 0.9193
 Site-MNIST                     (0) | Train Loss: 0.3102 | Train Acc: 0.9226
 Site-MNIST                     (0) | Train Loss: 0.2746 | Train Acc: 0.9343
 Site-USPS                      (1) | Train Loss: 0.3296 | Train Acc: 0.9000
 Site-USPS                      (1) | Train Loss: 0.5663 | Train Acc: 0.9444
 Site-USPS                      (1) | Train Loss: 0.2488 | Train Acc: 0.9070
 Site-USPS                      (1) | Train Loss: 0.4090 | Train Acc: 0.8498
 Site-USPS                      (1) | Train Loss: 0.3404 | Train Acc: 0.9286
 Site-USPS                      (1) | Train Loss: 0.3581 | Train Acc: 0.9021
 Site-SynthDigits               (2) | Train Loss: 0.7760 | Train Acc: 0.7748
 Site-SynthDigits               (2) | Train Loss: 0.6909 | Train Acc: 0.8059
 Site-SynthDigits               (2) | Train Loss: 0.6491 | Train Acc: 0.8554
 Site-MNIST_M                   (1) | Train Loss: 1.0568 | Train Acc: 0.6906
 Site-MNIST_M                   (1) | Train Loss: 1.0046 | Train Acc: 0.7125
 Site-SVHN                      (2) | Train Loss: 1.2278 | Train Acc: 0.6418
Average Train Accuracy: 0.8708
 Site-MNIST                     (0) | Val  Loss: 0.0284 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0405 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4415 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5371 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4004 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2974 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2505 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.2651 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.3308 | Val  Acc: 0.9235
 Site-MNIST                     (0) | Val  Loss: 0.3183 | Val  Acc: 0.9245
 Site-USPS                      (1) | Val  Loss: 0.2240 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.6410 | Val  Acc: 0.7778
 Site-USPS                      (1) | Val  Loss: 0.6294 | Val  Acc: 0.7500
 Site-USPS                      (1) | Val  Loss: 0.5635 | Val  Acc: 0.7931
 Site-USPS                      (1) | Val  Loss: 0.4579 | Val  Acc: 0.8286
 Site-USPS                      (1) | Val  Loss: 0.3761 | Val  Acc: 0.8836
 Site-SynthDigits               (2) | Val  Loss: 0.7276 | Val  Acc: 0.8108
 Site-SynthDigits               (2) | Val  Loss: 0.5266 | Val  Acc: 0.8382
 Site-SynthDigits               (2) | Val  Loss: 0.6502 | Val  Acc: 0.8197
 Site-MNIST_M                   (1) | Val  Loss: 1.1510 | Val  Acc: 0.6444
 Site-MNIST_M                   (1) | Val  Loss: 1.0228 | Val  Acc: 0.7160
 Site-SVHN                      (2) | Val  Loss: 0.9212 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8453
============ Train epoch 23 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (1) | Train Loss: 0.5785 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4044 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1959 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1840 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.4118 | Train Acc: 0.9000
 Site-MNIST                     (1) | Train Loss: 0.2465 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.2490 | Train Acc: 0.9383
 Site-MNIST                     (1) | Train Loss: 0.3027 | Train Acc: 0.9218
 Site-MNIST                     (1) | Train Loss: 0.3043 | Train Acc: 0.9266
 Site-MNIST                     (1) | Train Loss: 0.2644 | Train Acc: 0.9374
 Site-USPS                      (2) | Train Loss: 0.2994 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.3187 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.2305 | Train Acc: 0.8992
 Site-USPS                      (2) | Train Loss: 0.3844 | Train Acc: 0.8670
 Site-USPS                      (2) | Train Loss: 0.3112 | Train Acc: 0.9357
 Site-USPS                      (2) | Train Loss: 0.3392 | Train Acc: 0.9034
 Site-SynthDigits               (0) | Train Loss: 0.6781 | Train Acc: 0.7815
 Site-SynthDigits               (0) | Train Loss: 0.6984 | Train Acc: 0.8205
 Site-SynthDigits               (0) | Train Loss: 0.6163 | Train Acc: 0.8473
 Site-MNIST_M                   (2) | Train Loss: 1.0448 | Train Acc: 0.6906
 Site-MNIST_M                   (2) | Train Loss: 1.0062 | Train Acc: 0.7034
 Site-SVHN                      (0) | Train Loss: 1.1882 | Train Acc: 0.5957
Average Train Accuracy: 0.8723
 Site-MNIST                     (1) | Val  Loss: 0.0222 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0390 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4370 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5287 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3855 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2861 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2409 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2561 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.3189 | Val  Acc: 0.9290
 Site-MNIST                     (1) | Val  Loss: 0.3077 | Val  Acc: 0.9275
 Site-USPS                      (2) | Val  Loss: 0.2051 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.6074 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.5985 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.5505 | Val  Acc: 0.7931
 Site-USPS                      (2) | Val  Loss: 0.4419 | Val  Acc: 0.8476
 Site-USPS                      (2) | Val  Loss: 0.3586 | Val  Acc: 0.8836
 Site-SynthDigits               (0) | Val  Loss: 0.6857 | Val  Acc: 0.8378
 Site-SynthDigits               (0) | Val  Loss: 0.4817 | Val  Acc: 0.8824
 Site-SynthDigits               (0) | Val  Loss: 0.6083 | Val  Acc: 0.8279
 Site-MNIST_M                   (2) | Val  Loss: 1.1294 | Val  Acc: 0.6667
 Site-MNIST_M                   (2) | Val  Loss: 1.0003 | Val  Acc: 0.7284
 Site-SVHN                      (0) | Val  Loss: 0.9118 | Val  Acc: 0.6429
Average Valid Accuracy: 0.8537
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9412
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9290
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9275
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.7812
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.7931
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.8476
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.8836
 Best site-SynthDigits              (0)  | Epoch:23 | Val Acc: 0.8378
 Best site-SynthDigits              (0)  | Epoch:23 | Val Acc: 0.8824
 Best site-SynthDigits              (0)  | Epoch:23 | Val Acc: 0.8279
 Best site-MNIST_M                  (2)  | Epoch:23 | Val Acc: 0.6667
 Best site-MNIST_M                  (2)  | Epoch:23 | Val Acc: 0.7284
 Best site-SVHN                     (0)  | Epoch:23 | Val Acc: 0.6429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 24 ============
cnt=[10, 4, 8, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (0) | Train Loss: 0.5740 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3824 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1987 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1804 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.2430 | Train Acc: 0.9000
 Site-MNIST                     (0) | Train Loss: 0.2447 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.2333 | Train Acc: 0.9471
 Site-MNIST                     (0) | Train Loss: 0.3015 | Train Acc: 0.9193
 Site-MNIST                     (0) | Train Loss: 0.3007 | Train Acc: 0.9280
 Site-MNIST                     (0) | Train Loss: 0.2590 | Train Acc: 0.9389
 Site-USPS                      (2) | Train Loss: 0.2888 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.3061 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.2155 | Train Acc: 0.9070
 Site-USPS                      (2) | Train Loss: 0.3914 | Train Acc: 0.8584
 Site-USPS                      (2) | Train Loss: 0.2977 | Train Acc: 0.9405
 Site-USPS                      (2) | Train Loss: 0.3194 | Train Acc: 0.9101
 Site-SynthDigits               (1) | Train Loss: 0.7385 | Train Acc: 0.7682
 Site-SynthDigits               (1) | Train Loss: 0.7018 | Train Acc: 0.8205
 Site-SynthDigits               (1) | Train Loss: 0.6029 | Train Acc: 0.8391
 Site-MNIST_M                   (2) | Train Loss: 1.0226 | Train Acc: 0.6961
 Site-MNIST_M                   (2) | Train Loss: 0.9914 | Train Acc: 0.7187
 Site-SVHN                      (1) | Train Loss: 1.2046 | Train Acc: 0.6064
Average Train Accuracy: 0.8737
 Site-MNIST                     (0) | Val  Loss: 0.0189 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0368 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4316 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5019 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3717 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2790 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2389 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.2521 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.3152 | Val  Acc: 0.9235
 Site-MNIST                     (0) | Val  Loss: 0.3034 | Val  Acc: 0.9245
 Site-USPS                      (2) | Val  Loss: 0.1990 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5729 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.5551 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.5329 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.4270 | Val  Acc: 0.8571
 Site-USPS                      (2) | Val  Loss: 0.3385 | Val  Acc: 0.8889
 Site-SynthDigits               (1) | Val  Loss: 0.6678 | Val  Acc: 0.8378
 Site-SynthDigits               (1) | Val  Loss: 0.4612 | Val  Acc: 0.8824
 Site-SynthDigits               (1) | Val  Loss: 0.5919 | Val  Acc: 0.8279
 Site-MNIST_M                   (2) | Val  Loss: 1.0876 | Val  Acc: 0.6667
 Site-MNIST_M                   (2) | Val  Loss: 0.9658 | Val  Acc: 0.7284
 Site-SVHN                      (1) | Val  Loss: 0.9017 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8542
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9412
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9235
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9245
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.7812
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.8571
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.8889
 Best site-SynthDigits              (1)  | Epoch:24 | Val Acc: 0.8378
 Best site-SynthDigits              (1)  | Epoch:24 | Val Acc: 0.8824
 Best site-SynthDigits              (1)  | Epoch:24 | Val Acc: 0.8279
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.6667
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.7284
 Best site-SVHN                     (1)  | Epoch:24 | Val Acc: 0.6286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 25 ============
cnt=[8, 10, 4, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (1) | Train Loss: 0.5680 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3673 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1913 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1696 | Train Acc: 0.9474
 Site-MNIST                     (1) | Train Loss: 0.4111 | Train Acc: 0.9000
 Site-MNIST                     (1) | Train Loss: 0.2331 | Train Acc: 0.9444
 Site-MNIST                     (1) | Train Loss: 0.2301 | Train Acc: 0.9427
 Site-MNIST                     (1) | Train Loss: 0.2883 | Train Acc: 0.9267
 Site-MNIST                     (1) | Train Loss: 0.2839 | Train Acc: 0.9280
 Site-MNIST                     (1) | Train Loss: 0.2487 | Train Acc: 0.9411
 Site-USPS                      (0) | Train Loss: 0.2978 | Train Acc: 0.9500
 Site-USPS                      (0) | Train Loss: 0.5150 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.7000 | Train Acc: 0.9070
 Site-USPS                      (0) | Train Loss: 0.3677 | Train Acc: 0.8627
 Site-USPS                      (0) | Train Loss: 0.2883 | Train Acc: 0.9405
 Site-USPS                      (0) | Train Loss: 0.3161 | Train Acc: 0.9048
 Site-SynthDigits               (2) | Train Loss: 0.6775 | Train Acc: 0.7881
 Site-SynthDigits               (2) | Train Loss: 0.6055 | Train Acc: 0.8388
 Site-SynthDigits               (2) | Train Loss: 0.5852 | Train Acc: 0.8615
 Site-MNIST_M                   (0) | Train Loss: 0.9993 | Train Acc: 0.6961
 Site-MNIST_M                   (0) | Train Loss: 0.9700 | Train Acc: 0.7095
 Site-SVHN                      (2) | Train Loss: 1.1427 | Train Acc: 0.6099
Average Train Accuracy: 0.8748
 Site-MNIST                     (1) | Val  Loss: 0.0175 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0345 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4506 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5115 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3694 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2690 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2267 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2431 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.3056 | Val  Acc: 0.9290
 Site-MNIST                     (1) | Val  Loss: 0.2968 | Val  Acc: 0.9335
 Site-USPS                      (0) | Val  Loss: 0.1809 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.5783 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.5688 | Val  Acc: 0.7812
 Site-USPS                      (0) | Val  Loss: 0.5203 | Val  Acc: 0.7759
 Site-USPS                      (0) | Val  Loss: 0.4198 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.3367 | Val  Acc: 0.8783
 Site-SynthDigits               (2) | Val  Loss: 0.6519 | Val  Acc: 0.8378
 Site-SynthDigits               (2) | Val  Loss: 0.4482 | Val  Acc: 0.8824
 Site-SynthDigits               (2) | Val  Loss: 0.5783 | Val  Acc: 0.8443
 Site-MNIST_M                   (0) | Val  Loss: 1.0830 | Val  Acc: 0.6444
 Site-MNIST_M                   (0) | Val  Loss: 0.9690 | Val  Acc: 0.7160
 Site-SVHN                      (2) | Val  Loss: 0.8500 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8494
============ Train epoch 26 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (1) | Train Loss: 0.5658 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3619 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1821 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1661 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3102 | Train Acc: 0.9000
 Site-MNIST                     (1) | Train Loss: 0.2248 | Train Acc: 0.9444
 Site-MNIST                     (1) | Train Loss: 0.2281 | Train Acc: 0.9471
 Site-MNIST                     (1) | Train Loss: 0.2767 | Train Acc: 0.9242
 Site-MNIST                     (1) | Train Loss: 0.2814 | Train Acc: 0.9280
 Site-MNIST                     (1) | Train Loss: 0.2419 | Train Acc: 0.9419
 Site-USPS                      (2) | Train Loss: 0.2916 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2261 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.2518 | Train Acc: 0.9070
 Site-USPS                      (2) | Train Loss: 0.3822 | Train Acc: 0.8627
 Site-USPS                      (2) | Train Loss: 0.2813 | Train Acc: 0.9429
 Site-USPS                      (2) | Train Loss: 0.3075 | Train Acc: 0.9101
 Site-SynthDigits               (0) | Train Loss: 0.6613 | Train Acc: 0.7815
 Site-SynthDigits               (0) | Train Loss: 0.6012 | Train Acc: 0.8535
 Site-SynthDigits               (0) | Train Loss: 0.5710 | Train Acc: 0.8758
 Site-MNIST_M                   (2) | Train Loss: 0.9815 | Train Acc: 0.6961
 Site-MNIST_M                   (2) | Train Loss: 0.8955 | Train Acc: 0.7248
 Site-SVHN                      (0) | Train Loss: 1.1397 | Train Acc: 0.6418
Average Train Accuracy: 0.8796
 Site-MNIST                     (1) | Val  Loss: 0.0176 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0342 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4419 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4871 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3542 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2547 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2174 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2335 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2978 | Val  Acc: 0.9290
 Site-MNIST                     (1) | Val  Loss: 0.2890 | Val  Acc: 0.9335
 Site-USPS                      (2) | Val  Loss: 0.1739 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5775 | Val  Acc: 0.7778
 Site-USPS                      (2) | Val  Loss: 0.5703 | Val  Acc: 0.7500
 Site-USPS                      (2) | Val  Loss: 0.5105 | Val  Acc: 0.7759
 Site-USPS                      (2) | Val  Loss: 0.4169 | Val  Acc: 0.8286
 Site-USPS                      (2) | Val  Loss: 0.3322 | Val  Acc: 0.8783
 Site-SynthDigits               (0) | Val  Loss: 0.6243 | Val  Acc: 0.8378
 Site-SynthDigits               (0) | Val  Loss: 0.4269 | Val  Acc: 0.8824
 Site-SynthDigits               (0) | Val  Loss: 0.5645 | Val  Acc: 0.8443
 Site-MNIST_M                   (2) | Val  Loss: 1.0790 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 0.9551 | Val  Acc: 0.7160
 Site-SVHN                      (0) | Val  Loss: 0.8262 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8493
============ Train epoch 27 ============
cnt=[10, 4, 8, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (0) | Train Loss: 0.5460 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3538 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1791 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1659 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.3265 | Train Acc: 0.8857
 Site-MNIST                     (0) | Train Loss: 0.2244 | Train Acc: 0.9444
 Site-MNIST                     (0) | Train Loss: 0.2134 | Train Acc: 0.9471
 Site-MNIST                     (0) | Train Loss: 0.2775 | Train Acc: 0.9267
 Site-MNIST                     (0) | Train Loss: 0.2811 | Train Acc: 0.9321
 Site-MNIST                     (0) | Train Loss: 0.2382 | Train Acc: 0.9449
 Site-USPS                      (2) | Train Loss: 0.2723 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2706 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.3253 | Train Acc: 0.9147
 Site-USPS                      (2) | Train Loss: 0.3606 | Train Acc: 0.8670
 Site-USPS                      (2) | Train Loss: 0.2749 | Train Acc: 0.9405
 Site-USPS                      (2) | Train Loss: 0.2968 | Train Acc: 0.9101
 Site-SynthDigits               (1) | Train Loss: 0.6416 | Train Acc: 0.7881
 Site-SynthDigits               (1) | Train Loss: 0.5880 | Train Acc: 0.8425
 Site-SynthDigits               (1) | Train Loss: 0.5497 | Train Acc: 0.8676
 Site-MNIST_M                   (2) | Train Loss: 0.9647 | Train Acc: 0.7017
 Site-MNIST_M                   (2) | Train Loss: 0.9632 | Train Acc: 0.7278
 Site-SVHN                      (1) | Train Loss: 1.1347 | Train Acc: 0.6312
Average Train Accuracy: 0.8786
 Site-MNIST                     (0) | Val  Loss: 0.0157 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4280 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4636 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3411 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2486 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2158 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.2295 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.2942 | Val  Acc: 0.9290
 Site-MNIST                     (0) | Val  Loss: 0.2837 | Val  Acc: 0.9305
 Site-USPS                      (2) | Val  Loss: 0.1607 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5523 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.5404 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.5013 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.4025 | Val  Acc: 0.8476
 Site-USPS                      (2) | Val  Loss: 0.3146 | Val  Acc: 0.8942
 Site-SynthDigits               (1) | Val  Loss: 0.5959 | Val  Acc: 0.8649
 Site-SynthDigits               (1) | Val  Loss: 0.4128 | Val  Acc: 0.8971
 Site-SynthDigits               (1) | Val  Loss: 0.5385 | Val  Acc: 0.8525
 Site-MNIST_M                   (2) | Val  Loss: 1.0408 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 0.9185 | Val  Acc: 0.7407
 Site-SVHN                      (1) | Val  Loss: 0.8272 | Val  Acc: 0.6714
Average Valid Accuracy: 0.8590
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9412
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9290
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9305
 Best site-USPS                     (2)  | Epoch:27 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:27 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:27 | Val Acc: 0.7812
 Best site-USPS                     (2)  | Epoch:27 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:27 | Val Acc: 0.8476
 Best site-USPS                     (2)  | Epoch:27 | Val Acc: 0.8942
 Best site-SynthDigits              (1)  | Epoch:27 | Val Acc: 0.8649
 Best site-SynthDigits              (1)  | Epoch:27 | Val Acc: 0.8971
 Best site-SynthDigits              (1)  | Epoch:27 | Val Acc: 0.8525
 Best site-MNIST_M                  (2)  | Epoch:27 | Val Acc: 0.6444
 Best site-MNIST_M                  (2)  | Epoch:27 | Val Acc: 0.7407
 Best site-SVHN                     (1)  | Epoch:27 | Val Acc: 0.6714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 28 ============
cnt=[3, 10, 9, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (1) | Train Loss: 0.5233 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3478 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1640 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1619 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3938 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.2132 | Train Acc: 0.9444
 Site-MNIST                     (1) | Train Loss: 0.2164 | Train Acc: 0.9515
 Site-MNIST                     (1) | Train Loss: 0.2854 | Train Acc: 0.9267
 Site-MNIST                     (1) | Train Loss: 0.2764 | Train Acc: 0.9321
 Site-MNIST                     (1) | Train Loss: 0.2321 | Train Acc: 0.9472
 Site-USPS                      (2) | Train Loss: 0.2816 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2178 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.1991 | Train Acc: 0.9302
 Site-USPS                      (2) | Train Loss: 0.3588 | Train Acc: 0.8712
 Site-USPS                      (2) | Train Loss: 0.2851 | Train Acc: 0.9357
 Site-USPS                      (2) | Train Loss: 0.2912 | Train Acc: 0.9114
 Site-SynthDigits               (2) | Train Loss: 0.6177 | Train Acc: 0.7815
 Site-SynthDigits               (2) | Train Loss: 0.6108 | Train Acc: 0.8425
 Site-SynthDigits               (2) | Train Loss: 0.5460 | Train Acc: 0.8676
 Site-MNIST_M                   (0) | Train Loss: 0.9358 | Train Acc: 0.7182
 Site-MNIST_M                   (0) | Train Loss: 0.8929 | Train Acc: 0.7431
 Site-SVHN                      (0) | Train Loss: 1.1148 | Train Acc: 0.6348
Average Train Accuracy: 0.8829
 Site-MNIST                     (1) | Val  Loss: 0.0137 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0340 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4514 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4647 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3406 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2459 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2136 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2251 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2881 | Val  Acc: 0.9180
 Site-MNIST                     (1) | Val  Loss: 0.2761 | Val  Acc: 0.9335
 Site-USPS                      (2) | Val  Loss: 0.1574 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5405 | Val  Acc: 0.8889
 Site-USPS                      (2) | Val  Loss: 0.5290 | Val  Acc: 0.8125
 Site-USPS                      (2) | Val  Loss: 0.5023 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.3950 | Val  Acc: 0.8476
 Site-USPS                      (2) | Val  Loss: 0.3034 | Val  Acc: 0.8942
 Site-SynthDigits               (2) | Val  Loss: 0.5948 | Val  Acc: 0.8649
 Site-SynthDigits               (2) | Val  Loss: 0.4105 | Val  Acc: 0.8971
 Site-SynthDigits               (2) | Val  Loss: 0.5372 | Val  Acc: 0.8443
 Site-MNIST_M                   (0) | Val  Loss: 0.9811 | Val  Acc: 0.6444
 Site-MNIST_M                   (0) | Val  Loss: 0.8742 | Val  Acc: 0.7407
 Site-SVHN                      (0) | Val  Loss: 0.8380 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8635
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9412
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9180
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9335
 Best site-USPS                     (2)  | Epoch:28 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:28 | Val Acc: 0.8889
 Best site-USPS                     (2)  | Epoch:28 | Val Acc: 0.8125
 Best site-USPS                     (2)  | Epoch:28 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:28 | Val Acc: 0.8476
 Best site-USPS                     (2)  | Epoch:28 | Val Acc: 0.8942
 Best site-SynthDigits              (2)  | Epoch:28 | Val Acc: 0.8649
 Best site-SynthDigits              (2)  | Epoch:28 | Val Acc: 0.8971
 Best site-SynthDigits              (2)  | Epoch:28 | Val Acc: 0.8443
 Best site-MNIST_M                  (0)  | Epoch:28 | Val Acc: 0.6444
 Best site-MNIST_M                  (0)  | Epoch:28 | Val Acc: 0.7407
 Best site-SVHN                     (0)  | Epoch:28 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 29 ============
cnt=[10, 4, 8, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (0) | Train Loss: 0.5347 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3341 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1529 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1515 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.2761 | Train Acc: 0.9000
 Site-MNIST                     (0) | Train Loss: 0.2011 | Train Acc: 0.9444
 Site-MNIST                     (0) | Train Loss: 0.1958 | Train Acc: 0.9559
 Site-MNIST                     (0) | Train Loss: 0.2617 | Train Acc: 0.9340
 Site-MNIST                     (0) | Train Loss: 0.2672 | Train Acc: 0.9334
 Site-MNIST                     (0) | Train Loss: 0.2203 | Train Acc: 0.9502
 Site-USPS                      (2) | Train Loss: 0.2793 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.3480 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.2422 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.3493 | Train Acc: 0.8670
 Site-USPS                      (2) | Train Loss: 0.2672 | Train Acc: 0.9405
 Site-USPS                      (2) | Train Loss: 0.2860 | Train Acc: 0.9140
 Site-SynthDigits               (1) | Train Loss: 0.6285 | Train Acc: 0.7881
 Site-SynthDigits               (1) | Train Loss: 0.5762 | Train Acc: 0.8571
 Site-SynthDigits               (1) | Train Loss: 0.5310 | Train Acc: 0.8758
 Site-MNIST_M                   (2) | Train Loss: 0.9274 | Train Acc: 0.7238
 Site-MNIST_M                   (2) | Train Loss: 0.9013 | Train Acc: 0.7248
 Site-SVHN                      (1) | Train Loss: 1.0872 | Train Acc: 0.6418
Average Train Accuracy: 0.8832
 Site-MNIST                     (0) | Val  Loss: 0.0136 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0324 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4332 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4476 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3204 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2318 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1997 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.2152 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.2774 | Val  Acc: 0.9290
 Site-MNIST                     (0) | Val  Loss: 0.2671 | Val  Acc: 0.9366
 Site-USPS                      (2) | Val  Loss: 0.1547 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5628 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.5468 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.4924 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.3963 | Val  Acc: 0.8571
 Site-USPS                      (2) | Val  Loss: 0.3081 | Val  Acc: 0.8889
 Site-SynthDigits               (1) | Val  Loss: 0.5770 | Val  Acc: 0.8649
 Site-SynthDigits               (1) | Val  Loss: 0.3915 | Val  Acc: 0.8971
 Site-SynthDigits               (1) | Val  Loss: 0.5282 | Val  Acc: 0.8443
 Site-MNIST_M                   (2) | Val  Loss: 1.0055 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 0.8928 | Val  Acc: 0.7284
 Site-SVHN                      (1) | Val  Loss: 0.7912 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8598
============ Train epoch 30 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (1) | Train Loss: 0.5269 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3198 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1567 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1512 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.2822 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1994 | Train Acc: 0.9444
 Site-MNIST                     (1) | Train Loss: 0.1977 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2677 | Train Acc: 0.9340
 Site-MNIST                     (1) | Train Loss: 0.2551 | Train Acc: 0.9348
 Site-MNIST                     (1) | Train Loss: 0.2197 | Train Acc: 0.9509
 Site-USPS                      (2) | Train Loss: 0.2777 | Train Acc: 0.9250
 Site-USPS                      (2) | Train Loss: 0.2360 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.5335 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.3466 | Train Acc: 0.8712
 Site-USPS                      (2) | Train Loss: 0.2634 | Train Acc: 0.9429
 Site-USPS                      (2) | Train Loss: 0.2780 | Train Acc: 0.9180
 Site-SynthDigits               (0) | Train Loss: 0.6299 | Train Acc: 0.7748
 Site-SynthDigits               (0) | Train Loss: 0.5696 | Train Acc: 0.8645
 Site-SynthDigits               (0) | Train Loss: 0.5149 | Train Acc: 0.8737
 Site-MNIST_M                   (2) | Train Loss: 0.9119 | Train Acc: 0.7182
 Site-MNIST_M                   (2) | Train Loss: 0.8556 | Train Acc: 0.7309
 Site-SVHN                      (0) | Train Loss: 1.1034 | Train Acc: 0.6525
Average Train Accuracy: 0.8847
 Site-MNIST                     (1) | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4678 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4708 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3302 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2288 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1942 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2119 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2745 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2651 | Val  Acc: 0.9366
 Site-USPS                      (2) | Val  Loss: 0.1395 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.5328 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.5223 | Val  Acc: 0.8125
 Site-USPS                      (2) | Val  Loss: 0.4806 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.3840 | Val  Acc: 0.8571
 Site-USPS                      (2) | Val  Loss: 0.2968 | Val  Acc: 0.8942
 Site-SynthDigits               (0) | Val  Loss: 0.5528 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.3754 | Val  Acc: 0.9412
 Site-SynthDigits               (0) | Val  Loss: 0.4998 | Val  Acc: 0.8607
 Site-MNIST_M                   (2) | Val  Loss: 0.9852 | Val  Acc: 0.6667
 Site-MNIST_M                   (2) | Val  Loss: 0.8798 | Val  Acc: 0.7531
 Site-SVHN                      (0) | Val  Loss: 0.7648 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8731
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9412
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9344
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9366
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.8125
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.8571
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.8942
 Best site-SynthDigits              (0)  | Epoch:30 | Val Acc: 0.8919
 Best site-SynthDigits              (0)  | Epoch:30 | Val Acc: 0.9412
 Best site-SynthDigits              (0)  | Epoch:30 | Val Acc: 0.8607
 Best site-MNIST_M                  (2)  | Epoch:30 | Val Acc: 0.6667
 Best site-MNIST_M                  (2)  | Epoch:30 | Val Acc: 0.7531
 Best site-SVHN                     (0)  | Epoch:30 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 31 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (1) | Train Loss: 0.5282 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3166 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1390 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1443 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.1768 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1896 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.2042 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2423 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.2459 | Train Acc: 0.9348
 Site-MNIST                     (1) | Train Loss: 0.2104 | Train Acc: 0.9509
 Site-USPS                      (2) | Train Loss: 0.2639 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2920 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.2241 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.3229 | Train Acc: 0.8798
 Site-USPS                      (2) | Train Loss: 0.2584 | Train Acc: 0.9452
 Site-USPS                      (2) | Train Loss: 0.2685 | Train Acc: 0.9193
 Site-SynthDigits               (0) | Train Loss: 0.6244 | Train Acc: 0.8079
 Site-SynthDigits               (0) | Train Loss: 0.5470 | Train Acc: 0.8681
 Site-SynthDigits               (0) | Train Loss: 0.4947 | Train Acc: 0.8778
 Site-MNIST_M                   (2) | Train Loss: 0.8987 | Train Acc: 0.7182
 Site-MNIST_M                   (2) | Train Loss: 0.8474 | Train Acc: 0.7431
 Site-SVHN                      (0) | Train Loss: 1.0274 | Train Acc: 0.6489
Average Train Accuracy: 0.8886
 Site-MNIST                     (1) | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0322 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4463 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4521 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3178 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2178 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1869 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2039 | Val  Acc: 0.9314
 Site-MNIST                     (1) | Val  Loss: 0.2685 | Val  Acc: 0.9290
 Site-MNIST                     (1) | Val  Loss: 0.2576 | Val  Acc: 0.9366
 Site-USPS                      (2) | Val  Loss: 0.1362 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.5264 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.5114 | Val  Acc: 0.8438
 Site-USPS                      (2) | Val  Loss: 0.4743 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.3785 | Val  Acc: 0.8667
 Site-USPS                      (2) | Val  Loss: 0.2896 | Val  Acc: 0.8995
 Site-SynthDigits               (0) | Val  Loss: 0.5423 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.3583 | Val  Acc: 0.9265
 Site-SynthDigits               (0) | Val  Loss: 0.4916 | Val  Acc: 0.8770
 Site-MNIST_M                   (2) | Val  Loss: 0.9917 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 0.8785 | Val  Acc: 0.7654
 Site-SVHN                      (0) | Val  Loss: 0.7539 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8747
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9314
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9290
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9366
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 0.8438
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 0.8667
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 0.8995
 Best site-SynthDigits              (0)  | Epoch:31 | Val Acc: 0.8919
 Best site-SynthDigits              (0)  | Epoch:31 | Val Acc: 0.9265
 Best site-SynthDigits              (0)  | Epoch:31 | Val Acc: 0.8770
 Best site-MNIST_M                  (2)  | Epoch:31 | Val Acc: 0.6444
 Best site-MNIST_M                  (2)  | Epoch:31 | Val Acc: 0.7654
 Best site-SVHN                     (0)  | Epoch:31 | Val Acc: 0.7286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 32 ============
cnt=[8, 10, 4, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (1) | Train Loss: 0.5170 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3065 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1469 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1427 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.2665 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1904 | Train Acc: 0.9444
 Site-MNIST                     (1) | Train Loss: 0.1896 | Train Acc: 0.9515
 Site-MNIST                     (1) | Train Loss: 0.2415 | Train Acc: 0.9364
 Site-MNIST                     (1) | Train Loss: 0.2433 | Train Acc: 0.9348
 Site-MNIST                     (1) | Train Loss: 0.2078 | Train Acc: 0.9532
 Site-USPS                      (0) | Train Loss: 0.2553 | Train Acc: 0.9500
 Site-USPS                      (0) | Train Loss: 0.2155 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.1744 | Train Acc: 0.9302
 Site-USPS                      (0) | Train Loss: 0.3205 | Train Acc: 0.8884
 Site-USPS                      (0) | Train Loss: 0.2401 | Train Acc: 0.9500
 Site-USPS                      (0) | Train Loss: 0.2651 | Train Acc: 0.9259
 Site-SynthDigits               (2) | Train Loss: 0.5706 | Train Acc: 0.8079
 Site-SynthDigits               (2) | Train Loss: 0.5764 | Train Acc: 0.8938
 Site-SynthDigits               (2) | Train Loss: 0.4848 | Train Acc: 0.8880
 Site-MNIST_M                   (0) | Train Loss: 0.9093 | Train Acc: 0.7238
 Site-MNIST_M                   (0) | Train Loss: 0.8279 | Train Acc: 0.7462
 Site-SVHN                      (2) | Train Loss: 1.0483 | Train Acc: 0.6525
Average Train Accuracy: 0.8908
 Site-MNIST                     (1) | Val  Loss: 0.0113 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0315 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4497 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4551 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3164 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2153 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1839 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2015 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2649 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2560 | Val  Acc: 0.9396
 Site-USPS                      (0) | Val  Loss: 0.1180 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.5079 | Val  Acc: 0.8333
 Site-USPS                      (0) | Val  Loss: 0.4965 | Val  Acc: 0.8438
 Site-USPS                      (0) | Val  Loss: 0.4589 | Val  Acc: 0.8103
 Site-USPS                      (0) | Val  Loss: 0.3680 | Val  Acc: 0.8571
 Site-USPS                      (0) | Val  Loss: 0.2838 | Val  Acc: 0.9153
 Site-SynthDigits               (2) | Val  Loss: 0.5330 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.3436 | Val  Acc: 0.9412
 Site-SynthDigits               (2) | Val  Loss: 0.4711 | Val  Acc: 0.9016
 Site-MNIST_M                   (0) | Val  Loss: 0.9812 | Val  Acc: 0.6444
 Site-MNIST_M                   (0) | Val  Loss: 0.8767 | Val  Acc: 0.7407
 Site-SVHN                      (2) | Val  Loss: 0.7234 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8759
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.9412
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.9344
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.9396
 Best site-USPS                     (0)  | Epoch:32 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:32 | Val Acc: 0.8333
 Best site-USPS                     (0)  | Epoch:32 | Val Acc: 0.8438
 Best site-USPS                     (0)  | Epoch:32 | Val Acc: 0.8103
 Best site-USPS                     (0)  | Epoch:32 | Val Acc: 0.8571
 Best site-USPS                     (0)  | Epoch:32 | Val Acc: 0.9153
 Best site-SynthDigits              (2)  | Epoch:32 | Val Acc: 0.8919
 Best site-SynthDigits              (2)  | Epoch:32 | Val Acc: 0.9412
 Best site-SynthDigits              (2)  | Epoch:32 | Val Acc: 0.9016
 Best site-MNIST_M                  (0)  | Epoch:32 | Val Acc: 0.6444
 Best site-MNIST_M                  (0)  | Epoch:32 | Val Acc: 0.7407
 Best site-SVHN                     (2)  | Epoch:32 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 33 ============
cnt=[8, 10, 4, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (1) | Train Loss: 0.5183 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3013 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1368 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1379 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.2622 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1856 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1889 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2394 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.2516 | Train Acc: 0.9361
 Site-MNIST                     (1) | Train Loss: 0.2027 | Train Acc: 0.9547
 Site-USPS                      (0) | Train Loss: 0.2487 | Train Acc: 0.9500
 Site-USPS                      (0) | Train Loss: 0.2745 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.1903 | Train Acc: 0.9225
 Site-USPS                      (0) | Train Loss: 0.3235 | Train Acc: 0.8884
 Site-USPS                      (0) | Train Loss: 0.2392 | Train Acc: 0.9476
 Site-USPS                      (0) | Train Loss: 0.2548 | Train Acc: 0.9286
 Site-SynthDigits               (2) | Train Loss: 0.5594 | Train Acc: 0.7881
 Site-SynthDigits               (2) | Train Loss: 0.5328 | Train Acc: 0.8901
 Site-SynthDigits               (2) | Train Loss: 0.4793 | Train Acc: 0.8839
 Site-MNIST_M                   (0) | Train Loss: 0.8789 | Train Acc: 0.7459
 Site-MNIST_M                   (0) | Train Loss: 0.8201 | Train Acc: 0.7615
 Site-SVHN                      (2) | Train Loss: 1.0390 | Train Acc: 0.6667
Average Train Accuracy: 0.8927
 Site-MNIST                     (1) | Val  Loss: 0.0110 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4355 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4493 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3081 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2108 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1792 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1958 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2608 | Val  Acc: 0.9399
 Site-MNIST                     (1) | Val  Loss: 0.2503 | Val  Acc: 0.9366
 Site-USPS                      (0) | Val  Loss: 0.1197 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.4983 | Val  Acc: 0.8333
 Site-USPS                      (0) | Val  Loss: 0.4847 | Val  Acc: 0.8438
 Site-USPS                      (0) | Val  Loss: 0.4522 | Val  Acc: 0.8276
 Site-USPS                      (0) | Val  Loss: 0.3614 | Val  Acc: 0.8857
 Site-USPS                      (0) | Val  Loss: 0.2740 | Val  Acc: 0.9259
 Site-SynthDigits               (2) | Val  Loss: 0.5131 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.3289 | Val  Acc: 0.9412
 Site-SynthDigits               (2) | Val  Loss: 0.4583 | Val  Acc: 0.8852
 Site-MNIST_M                   (0) | Val  Loss: 0.9691 | Val  Acc: 0.6667
 Site-MNIST_M                   (0) | Val  Loss: 0.8529 | Val  Acc: 0.7654
 Site-SVHN                      (2) | Val  Loss: 0.7377 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8793
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9412
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9399
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9366
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.8333
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.8438
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.8276
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.8857
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.9259
 Best site-SynthDigits              (2)  | Epoch:33 | Val Acc: 0.8919
 Best site-SynthDigits              (2)  | Epoch:33 | Val Acc: 0.9412
 Best site-SynthDigits              (2)  | Epoch:33 | Val Acc: 0.8852
 Best site-MNIST_M                  (0)  | Epoch:33 | Val Acc: 0.6667
 Best site-MNIST_M                  (0)  | Epoch:33 | Val Acc: 0.7654
 Best site-SVHN                     (2)  | Epoch:33 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 34 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (1) | Train Loss: 0.5109 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2904 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1289 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1355 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3041 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1773 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1759 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2352 | Train Acc: 0.9462
 Site-MNIST                     (1) | Train Loss: 0.2396 | Train Acc: 0.9361
 Site-MNIST                     (1) | Train Loss: 0.1949 | Train Acc: 0.9577
 Site-USPS                      (2) | Train Loss: 0.2630 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2764 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1867 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.3102 | Train Acc: 0.8970
 Site-USPS                      (2) | Train Loss: 0.2373 | Train Acc: 0.9476
 Site-USPS                      (2) | Train Loss: 0.2509 | Train Acc: 0.9259
 Site-SynthDigits               (0) | Train Loss: 0.5514 | Train Acc: 0.8278
 Site-SynthDigits               (0) | Train Loss: 0.5046 | Train Acc: 0.8901
 Site-SynthDigits               (0) | Train Loss: 0.4740 | Train Acc: 0.8900
 Site-MNIST_M                   (2) | Train Loss: 0.8658 | Train Acc: 0.7459
 Site-MNIST_M                   (2) | Train Loss: 0.8127 | Train Acc: 0.7492
 Site-SVHN                      (0) | Train Loss: 1.0237 | Train Acc: 0.6773
Average Train Accuracy: 0.8955
 Site-MNIST                     (1) | Val  Loss: 0.0105 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0319 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4637 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4610 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3115 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2063 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1712 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1901 | Val  Acc: 0.9510
 Site-MNIST                     (1) | Val  Loss: 0.2539 | Val  Acc: 0.9399
 Site-MNIST                     (1) | Val  Loss: 0.2457 | Val  Acc: 0.9426
 Site-USPS                      (2) | Val  Loss: 0.1068 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4934 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.4870 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.4425 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.3551 | Val  Acc: 0.8857
 Site-USPS                      (2) | Val  Loss: 0.2722 | Val  Acc: 0.9206
 Site-SynthDigits               (0) | Val  Loss: 0.4977 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.3176 | Val  Acc: 0.9412
 Site-SynthDigits               (0) | Val  Loss: 0.4555 | Val  Acc: 0.8852
 Site-MNIST_M                   (2) | Val  Loss: 0.9764 | Val  Acc: 0.6889
 Site-MNIST_M                   (2) | Val  Loss: 0.8527 | Val  Acc: 0.7654
 Site-SVHN                      (0) | Val  Loss: 0.7246 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8849
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9510
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9399
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9426
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.8750
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.8448
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.8857
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.9206
 Best site-SynthDigits              (0)  | Epoch:34 | Val Acc: 0.8919
 Best site-SynthDigits              (0)  | Epoch:34 | Val Acc: 0.9412
 Best site-SynthDigits              (0)  | Epoch:34 | Val Acc: 0.8852
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.6889
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.7654
 Best site-SVHN                     (0)  | Epoch:34 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 35 ============
cnt=[3, 10, 9, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (1) | Train Loss: 0.4846 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2886 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1274 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1377 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.1591 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1715 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1738 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2314 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.2380 | Train Acc: 0.9402
 Site-MNIST                     (1) | Train Loss: 0.1947 | Train Acc: 0.9570
 Site-USPS                      (2) | Train Loss: 0.2547 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2980 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1739 | Train Acc: 0.9380
 Site-USPS                      (2) | Train Loss: 0.3127 | Train Acc: 0.8970
 Site-USPS                      (2) | Train Loss: 0.2217 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2419 | Train Acc: 0.9378
 Site-SynthDigits               (2) | Train Loss: 0.6172 | Train Acc: 0.8344
 Site-SynthDigits               (2) | Train Loss: 0.5013 | Train Acc: 0.8828
 Site-SynthDigits               (2) | Train Loss: 0.4710 | Train Acc: 0.8778
 Site-MNIST_M                   (0) | Train Loss: 0.8097 | Train Acc: 0.7514
 Site-MNIST_M                   (0) | Train Loss: 0.8535 | Train Acc: 0.7737
 Site-SVHN                      (0) | Train Loss: 1.0185 | Train Acc: 0.6738
Average Train Accuracy: 0.8979
 Site-MNIST                     (1) | Val  Loss: 0.0091 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0319 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4942 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4708 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3203 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2063 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1707 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1877 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2523 | Val  Acc: 0.9290
 Site-MNIST                     (1) | Val  Loss: 0.2431 | Val  Acc: 0.9366
 Site-USPS                      (2) | Val  Loss: 0.0962 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4632 | Val  Acc: 0.8889
 Site-USPS                      (2) | Val  Loss: 0.4570 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.4320 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.3415 | Val  Acc: 0.8857
 Site-USPS                      (2) | Val  Loss: 0.2585 | Val  Acc: 0.9206
 Site-SynthDigits               (2) | Val  Loss: 0.5016 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.3241 | Val  Acc: 0.9412
 Site-SynthDigits               (2) | Val  Loss: 0.4498 | Val  Acc: 0.8934
 Site-MNIST_M                   (0) | Val  Loss: 0.9088 | Val  Acc: 0.7333
 Site-MNIST_M                   (0) | Val  Loss: 0.7955 | Val  Acc: 0.7778
 Site-SVHN                      (0) | Val  Loss: 0.7152 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8863
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9412
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9290
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9366
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.8889
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.8750
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.8857
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.9206
 Best site-SynthDigits              (2)  | Epoch:35 | Val Acc: 0.8919
 Best site-SynthDigits              (2)  | Epoch:35 | Val Acc: 0.9412
 Best site-SynthDigits              (2)  | Epoch:35 | Val Acc: 0.8934
 Best site-MNIST_M                  (0)  | Epoch:35 | Val Acc: 0.7333
 Best site-MNIST_M                  (0)  | Epoch:35 | Val Acc: 0.7778
 Best site-SVHN                     (0)  | Epoch:35 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 36 ============
cnt=[10, 4, 8, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (0) | Train Loss: 0.4927 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2923 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1158 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1342 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.1743 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.1642 | Train Acc: 0.9603
 Site-MNIST                     (0) | Train Loss: 0.1704 | Train Acc: 0.9559
 Site-MNIST                     (0) | Train Loss: 0.2236 | Train Acc: 0.9389
 Site-MNIST                     (0) | Train Loss: 0.2269 | Train Acc: 0.9375
 Site-MNIST                     (0) | Train Loss: 0.1878 | Train Acc: 0.9577
 Site-USPS                      (2) | Train Loss: 0.2464 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.3160 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1610 | Train Acc: 0.9302
 Site-USPS                      (2) | Train Loss: 0.3013 | Train Acc: 0.8927
 Site-USPS                      (2) | Train Loss: 0.2353 | Train Acc: 0.9476
 Site-USPS                      (2) | Train Loss: 0.2419 | Train Acc: 0.9365
 Site-SynthDigits               (1) | Train Loss: 0.5822 | Train Acc: 0.7947
 Site-SynthDigits               (1) | Train Loss: 0.4875 | Train Acc: 0.8938
 Site-SynthDigits               (1) | Train Loss: 0.4473 | Train Acc: 0.8880
 Site-MNIST_M                   (2) | Train Loss: 0.8409 | Train Acc: 0.7514
 Site-MNIST_M                   (2) | Train Loss: 0.7928 | Train Acc: 0.7706
 Site-SVHN                      (1) | Train Loss: 0.9804 | Train Acc: 0.7021
Average Train Accuracy: 0.8974
 Site-MNIST                     (0) | Val  Loss: 0.0092 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0325 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4672 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4631 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3109 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1981 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1661 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1825 | Val  Acc: 0.9314
 Site-MNIST                     (0) | Val  Loss: 0.2481 | Val  Acc: 0.9344
 Site-MNIST                     (0) | Val  Loss: 0.2367 | Val  Acc: 0.9335
 Site-USPS                      (2) | Val  Loss: 0.0944 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4507 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.4489 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.4243 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.3423 | Val  Acc: 0.8857
 Site-USPS                      (2) | Val  Loss: 0.2560 | Val  Acc: 0.9259
 Site-SynthDigits               (1) | Val  Loss: 0.4877 | Val  Acc: 0.9189
 Site-SynthDigits               (1) | Val  Loss: 0.3198 | Val  Acc: 0.9412
 Site-SynthDigits               (1) | Val  Loss: 0.4446 | Val  Acc: 0.8852
 Site-MNIST_M                   (2) | Val  Loss: 0.9327 | Val  Acc: 0.7333
 Site-MNIST_M                   (2) | Val  Loss: 0.8022 | Val  Acc: 0.7901
 Site-SVHN                      (1) | Val  Loss: 0.7028 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8880
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9314
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9344
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9335
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.8750
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.8448
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.8857
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.9259
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.9189
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.9412
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.8852
 Best site-MNIST_M                  (2)  | Epoch:36 | Val Acc: 0.7333
 Best site-MNIST_M                  (2)  | Epoch:36 | Val Acc: 0.7901
 Best site-SVHN                     (1)  | Epoch:36 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 37 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (1) | Train Loss: 0.4983 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2932 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1120 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1298 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.1935 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1627 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1838 | Train Acc: 0.9604
 Site-MNIST                     (1) | Train Loss: 0.2448 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.2212 | Train Acc: 0.9375
 Site-MNIST                     (1) | Train Loss: 0.1864 | Train Acc: 0.9600
 Site-USPS                      (2) | Train Loss: 0.2413 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.1678 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.2009 | Train Acc: 0.9302
 Site-USPS                      (2) | Train Loss: 0.3063 | Train Acc: 0.8755
 Site-USPS                      (2) | Train Loss: 0.2234 | Train Acc: 0.9476
 Site-USPS                      (2) | Train Loss: 0.2378 | Train Acc: 0.9378
 Site-SynthDigits               (0) | Train Loss: 0.5128 | Train Acc: 0.8013
 Site-SynthDigits               (0) | Train Loss: 0.4373 | Train Acc: 0.8901
 Site-SynthDigits               (0) | Train Loss: 0.4410 | Train Acc: 0.8961
 Site-MNIST_M                   (2) | Train Loss: 0.8373 | Train Acc: 0.7514
 Site-MNIST_M                   (2) | Train Loss: 0.7594 | Train Acc: 0.7737
 Site-SVHN                      (0) | Train Loss: 0.9877 | Train Acc: 0.6950
Average Train Accuracy: 0.8967
 Site-MNIST                     (1) | Val  Loss: 0.0086 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0279 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4622 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4574 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3066 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.1945 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1617 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1791 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2448 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2341 | Val  Acc: 0.9366
 Site-USPS                      (2) | Val  Loss: 0.0919 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4630 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.4552 | Val  Acc: 0.8438
 Site-USPS                      (2) | Val  Loss: 0.4210 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.3402 | Val  Acc: 0.8762
 Site-USPS                      (2) | Val  Loss: 0.2544 | Val  Acc: 0.9153
 Site-SynthDigits               (0) | Val  Loss: 0.4741 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.3098 | Val  Acc: 0.9559
 Site-SynthDigits               (0) | Val  Loss: 0.4292 | Val  Acc: 0.8852
 Site-MNIST_M                   (2) | Val  Loss: 0.9501 | Val  Acc: 0.7111
 Site-MNIST_M                   (2) | Val  Loss: 0.8138 | Val  Acc: 0.7654
 Site-SVHN                      (0) | Val  Loss: 0.6776 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8848
============ Train epoch 38 ============
cnt=[10, 8, 4, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (0) | Train Loss: 0.5006 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2873 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1086 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1275 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.2107 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1560 | Train Acc: 0.9603
 Site-MNIST                     (0) | Train Loss: 0.1649 | Train Acc: 0.9559
 Site-MNIST                     (0) | Train Loss: 0.2233 | Train Acc: 0.9364
 Site-MNIST                     (0) | Train Loss: 0.2284 | Train Acc: 0.9375
 Site-MNIST                     (0) | Train Loss: 0.1804 | Train Acc: 0.9615
 Site-USPS                      (1) | Train Loss: 0.2492 | Train Acc: 0.9750
 Site-USPS                      (1) | Train Loss: 0.2419 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.1951 | Train Acc: 0.9225
 Site-USPS                      (1) | Train Loss: 0.2872 | Train Acc: 0.9056
 Site-USPS                      (1) | Train Loss: 0.2217 | Train Acc: 0.9500
 Site-USPS                      (1) | Train Loss: 0.2320 | Train Acc: 0.9392
 Site-SynthDigits               (2) | Train Loss: 0.5293 | Train Acc: 0.8013
 Site-SynthDigits               (2) | Train Loss: 0.4359 | Train Acc: 0.8974
 Site-SynthDigits               (2) | Train Loss: 0.4295 | Train Acc: 0.9084
 Site-MNIST_M                   (1) | Train Loss: 0.8329 | Train Acc: 0.7403
 Site-MNIST_M                   (1) | Train Loss: 0.7721 | Train Acc: 0.7584
 Site-SVHN                      (2) | Train Loss: 0.9712 | Train Acc: 0.6950
Average Train Accuracy: 0.8984
 Site-MNIST                     (0) | Val  Loss: 0.0083 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0280 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4562 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4652 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3058 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1905 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1559 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1744 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.2410 | Val  Acc: 0.9290
 Site-MNIST                     (0) | Val  Loss: 0.2308 | Val  Acc: 0.9366
 Site-USPS                      (1) | Val  Loss: 0.0855 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.4577 | Val  Acc: 0.8333
 Site-USPS                      (1) | Val  Loss: 0.4507 | Val  Acc: 0.8438
 Site-USPS                      (1) | Val  Loss: 0.4113 | Val  Acc: 0.8621
 Site-USPS                      (1) | Val  Loss: 0.3325 | Val  Acc: 0.8857
 Site-USPS                      (1) | Val  Loss: 0.2541 | Val  Acc: 0.9206
 Site-SynthDigits               (2) | Val  Loss: 0.4642 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.2927 | Val  Acc: 0.9559
 Site-SynthDigits               (2) | Val  Loss: 0.4183 | Val  Acc: 0.9098
 Site-MNIST_M                   (1) | Val  Loss: 0.9569 | Val  Acc: 0.6889
 Site-MNIST_M                   (1) | Val  Loss: 0.8203 | Val  Acc: 0.7778
 Site-SVHN                      (2) | Val  Loss: 0.6663 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8873
============ Train epoch 39 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (1) | Train Loss: 0.4887 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2835 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1036 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1259 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.1747 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1518 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1776 | Train Acc: 0.9604
 Site-MNIST                     (1) | Train Loss: 0.2347 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2179 | Train Acc: 0.9375
 Site-MNIST                     (1) | Train Loss: 0.1789 | Train Acc: 0.9638
 Site-USPS                      (2) | Train Loss: 0.2522 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2786 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1965 | Train Acc: 0.9302
 Site-USPS                      (2) | Train Loss: 0.2846 | Train Acc: 0.9056
 Site-USPS                      (2) | Train Loss: 0.2118 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2274 | Train Acc: 0.9405
 Site-SynthDigits               (0) | Train Loss: 0.5524 | Train Acc: 0.8212
 Site-SynthDigits               (0) | Train Loss: 0.4627 | Train Acc: 0.8974
 Site-SynthDigits               (0) | Train Loss: 0.4214 | Train Acc: 0.9043
 Site-MNIST_M                   (2) | Train Loss: 0.8229 | Train Acc: 0.7403
 Site-MNIST_M                   (2) | Train Loss: 0.8511 | Train Acc: 0.7645
 Site-SVHN                      (0) | Train Loss: 0.9374 | Train Acc: 0.7057
Average Train Accuracy: 0.8998
 Site-MNIST                     (1) | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0274 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4762 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4751 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3125 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.1895 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1530 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1713 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2384 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2281 | Val  Acc: 0.9426
 Site-USPS                      (2) | Val  Loss: 0.0791 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4496 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.4430 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.4044 | Val  Acc: 0.8621
 Site-USPS                      (2) | Val  Loss: 0.3254 | Val  Acc: 0.8857
 Site-USPS                      (2) | Val  Loss: 0.2471 | Val  Acc: 0.9206
 Site-SynthDigits               (0) | Val  Loss: 0.4590 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.2898 | Val  Acc: 0.9412
 Site-SynthDigits               (0) | Val  Loss: 0.4089 | Val  Acc: 0.9098
 Site-MNIST_M                   (2) | Val  Loss: 0.9341 | Val  Acc: 0.6667
 Site-MNIST_M                   (2) | Val  Loss: 0.8067 | Val  Acc: 0.7901
 Site-SVHN                      (0) | Val  Loss: 0.6462 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8881
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9412
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9344
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9426
 Best site-USPS                     (2)  | Epoch:39 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:39 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:39 | Val Acc: 0.8750
 Best site-USPS                     (2)  | Epoch:39 | Val Acc: 0.8621
 Best site-USPS                     (2)  | Epoch:39 | Val Acc: 0.8857
 Best site-USPS                     (2)  | Epoch:39 | Val Acc: 0.9206
 Best site-SynthDigits              (0)  | Epoch:39 | Val Acc: 0.9189
 Best site-SynthDigits              (0)  | Epoch:39 | Val Acc: 0.9412
 Best site-SynthDigits              (0)  | Epoch:39 | Val Acc: 0.9098
 Best site-MNIST_M                  (2)  | Epoch:39 | Val Acc: 0.6667
 Best site-MNIST_M                  (2)  | Epoch:39 | Val Acc: 0.7901
 Best site-SVHN                     (0)  | Epoch:39 | Val Acc: 0.7571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 40 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (1) | Train Loss: 0.4926 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2773 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1061 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1230 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3238 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1563 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1716 | Train Acc: 0.9604
 Site-MNIST                     (1) | Train Loss: 0.2153 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2120 | Train Acc: 0.9361
 Site-MNIST                     (1) | Train Loss: 0.1772 | Train Acc: 0.9615
 Site-USPS                      (2) | Train Loss: 0.2457 | Train Acc: 0.9750
 Site-USPS                      (2) | Train Loss: 0.2618 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.2470 | Train Acc: 0.9380
 Site-USPS                      (2) | Train Loss: 0.2854 | Train Acc: 0.8970
 Site-USPS                      (2) | Train Loss: 0.2093 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2197 | Train Acc: 0.9405
 Site-SynthDigits               (0) | Train Loss: 0.5225 | Train Acc: 0.8411
 Site-SynthDigits               (0) | Train Loss: 0.4666 | Train Acc: 0.8974
 Site-SynthDigits               (0) | Train Loss: 0.4188 | Train Acc: 0.9002
 Site-MNIST_M                   (2) | Train Loss: 0.7990 | Train Acc: 0.7624
 Site-MNIST_M                   (2) | Train Loss: 0.8646 | Train Acc: 0.7676
 Site-SVHN                      (0) | Train Loss: 0.9626 | Train Acc: 0.6986
Average Train Accuracy: 0.9023
 Site-MNIST                     (1) | Val  Loss: 0.0078 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0286 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4669 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4473 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3001 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.1833 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1520 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1690 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2362 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2263 | Val  Acc: 0.9426
 Site-USPS                      (2) | Val  Loss: 0.0711 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4223 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.4187 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.3926 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.3202 | Val  Acc: 0.8952
 Site-USPS                      (2) | Val  Loss: 0.2395 | Val  Acc: 0.9206
 Site-SynthDigits               (0) | Val  Loss: 0.4553 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.2840 | Val  Acc: 0.9412
 Site-SynthDigits               (0) | Val  Loss: 0.4026 | Val  Acc: 0.9180
 Site-MNIST_M                   (2) | Val  Loss: 0.9109 | Val  Acc: 0.6889
 Site-MNIST_M                   (2) | Val  Loss: 0.7865 | Val  Acc: 0.7778
 Site-SVHN                      (0) | Val  Loss: 0.6436 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8874
============ Train epoch 41 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (1) | Train Loss: 0.4934 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2743 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1044 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1196 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3204 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1543 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1667 | Train Acc: 0.9604
 Site-MNIST                     (1) | Train Loss: 0.2171 | Train Acc: 0.9487
 Site-MNIST                     (1) | Train Loss: 0.2143 | Train Acc: 0.9375
 Site-MNIST                     (1) | Train Loss: 0.1767 | Train Acc: 0.9592
 Site-USPS                      (2) | Train Loss: 0.2192 | Train Acc: 0.9750
 Site-USPS                      (2) | Train Loss: 0.1917 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1474 | Train Acc: 0.9457
 Site-USPS                      (2) | Train Loss: 0.2749 | Train Acc: 0.9056
 Site-USPS                      (2) | Train Loss: 0.2021 | Train Acc: 0.9476
 Site-USPS                      (2) | Train Loss: 0.2168 | Train Acc: 0.9418
 Site-SynthDigits               (0) | Train Loss: 0.4638 | Train Acc: 0.8543
 Site-SynthDigits               (0) | Train Loss: 0.4776 | Train Acc: 0.9084
 Site-SynthDigits               (0) | Train Loss: 0.4067 | Train Acc: 0.9022
 Site-MNIST_M                   (2) | Train Loss: 0.8033 | Train Acc: 0.7735
 Site-MNIST_M                   (2) | Train Loss: 0.8681 | Train Acc: 0.7859
 Site-SVHN                      (0) | Train Loss: 0.9268 | Train Acc: 0.6986
Average Train Accuracy: 0.9057
 Site-MNIST                     (1) | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0312 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4623 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4569 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3034 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.1808 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1498 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1660 | Val  Acc: 0.9510
 Site-MNIST                     (1) | Val  Loss: 0.2350 | Val  Acc: 0.9290
 Site-MNIST                     (1) | Val  Loss: 0.2238 | Val  Acc: 0.9396
 Site-USPS                      (2) | Val  Loss: 0.0704 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.3963 | Val  Acc: 0.8889
 Site-USPS                      (2) | Val  Loss: 0.3983 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.3866 | Val  Acc: 0.8276
 Site-USPS                      (2) | Val  Loss: 0.3170 | Val  Acc: 0.8952
 Site-USPS                      (2) | Val  Loss: 0.2327 | Val  Acc: 0.9259
 Site-SynthDigits               (0) | Val  Loss: 0.4476 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.2747 | Val  Acc: 0.9412
 Site-SynthDigits               (0) | Val  Loss: 0.3916 | Val  Acc: 0.9262
 Site-MNIST_M                   (2) | Val  Loss: 0.9106 | Val  Acc: 0.7556
 Site-MNIST_M                   (2) | Val  Loss: 0.7828 | Val  Acc: 0.8025
 Site-SVHN                      (0) | Val  Loss: 0.6443 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8933
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9510
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9290
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9396
 Best site-USPS                     (2)  | Epoch:41 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:41 | Val Acc: 0.8889
 Best site-USPS                     (2)  | Epoch:41 | Val Acc: 0.8750
 Best site-USPS                     (2)  | Epoch:41 | Val Acc: 0.8276
 Best site-USPS                     (2)  | Epoch:41 | Val Acc: 0.8952
 Best site-USPS                     (2)  | Epoch:41 | Val Acc: 0.9259
 Best site-SynthDigits              (0)  | Epoch:41 | Val Acc: 0.8919
 Best site-SynthDigits              (0)  | Epoch:41 | Val Acc: 0.9412
 Best site-SynthDigits              (0)  | Epoch:41 | Val Acc: 0.9262
 Best site-MNIST_M                  (2)  | Epoch:41 | Val Acc: 0.7556
 Best site-MNIST_M                  (2)  | Epoch:41 | Val Acc: 0.8025
 Best site-SVHN                     (0)  | Epoch:41 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 42 ============
cnt=[3, 10, 9, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (1) | Train Loss: 0.4790 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2686 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1100 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1305 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.4335 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1552 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1611 | Train Acc: 0.9648
 Site-MNIST                     (1) | Train Loss: 0.2307 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2094 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.1751 | Train Acc: 0.9592
 Site-USPS                      (2) | Train Loss: 0.2220 | Train Acc: 0.9750
 Site-USPS                      (2) | Train Loss: 0.4459 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1392 | Train Acc: 0.9380
 Site-USPS                      (2) | Train Loss: 0.2619 | Train Acc: 0.9013
 Site-USPS                      (2) | Train Loss: 0.1959 | Train Acc: 0.9524
 Site-USPS                      (2) | Train Loss: 0.2141 | Train Acc: 0.9392
 Site-SynthDigits               (2) | Train Loss: 0.4890 | Train Acc: 0.8477
 Site-SynthDigits               (2) | Train Loss: 0.4556 | Train Acc: 0.9048
 Site-SynthDigits               (2) | Train Loss: 0.4217 | Train Acc: 0.8961
 Site-MNIST_M                   (0) | Train Loss: 0.7484 | Train Acc: 0.7735
 Site-MNIST_M                   (0) | Train Loss: 0.6948 | Train Acc: 0.8043
 Site-SVHN                      (0) | Train Loss: 0.9142 | Train Acc: 0.6986
Average Train Accuracy: 0.9060
 Site-MNIST                     (1) | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0308 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4976 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4690 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3136 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.1832 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1499 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1654 | Val  Acc: 0.9608
 Site-MNIST                     (1) | Val  Loss: 0.2333 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2236 | Val  Acc: 0.9426
 Site-USPS                      (2) | Val  Loss: 0.0628 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.3833 | Val  Acc: 0.8889
 Site-USPS                      (2) | Val  Loss: 0.3853 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.3818 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.3118 | Val  Acc: 0.8857
 Site-USPS                      (2) | Val  Loss: 0.2302 | Val  Acc: 0.9206
 Site-SynthDigits               (2) | Val  Loss: 0.4640 | Val  Acc: 0.8649
 Site-SynthDigits               (2) | Val  Loss: 0.2742 | Val  Acc: 0.9265
 Site-SynthDigits               (2) | Val  Loss: 0.3988 | Val  Acc: 0.9180
 Site-MNIST_M                   (0) | Val  Loss: 0.8519 | Val  Acc: 0.7778
 Site-MNIST_M                   (0) | Val  Loss: 0.7322 | Val  Acc: 0.8025
 Site-SVHN                      (0) | Val  Loss: 0.6454 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8930
============ Train epoch 43 ============
cnt=[10, 4, 8, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (0) | Train Loss: 0.4877 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2688 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.0980 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1277 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.2737 | Train Acc: 0.9429
 Site-MNIST                     (0) | Train Loss: 0.1458 | Train Acc: 0.9603
 Site-MNIST                     (0) | Train Loss: 0.1486 | Train Acc: 0.9692
 Site-MNIST                     (0) | Train Loss: 0.2308 | Train Acc: 0.9389
 Site-MNIST                     (0) | Train Loss: 0.2044 | Train Acc: 0.9375
 Site-MNIST                     (0) | Train Loss: 0.1690 | Train Acc: 0.9615
 Site-USPS                      (2) | Train Loss: 0.2221 | Train Acc: 0.9750
 Site-USPS                      (2) | Train Loss: 0.2344 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.2548 | Train Acc: 0.9457
 Site-USPS                      (2) | Train Loss: 0.2585 | Train Acc: 0.9099
 Site-USPS                      (2) | Train Loss: 0.1985 | Train Acc: 0.9452
 Site-USPS                      (2) | Train Loss: 0.2097 | Train Acc: 0.9444
 Site-SynthDigits               (1) | Train Loss: 0.5276 | Train Acc: 0.8609
 Site-SynthDigits               (1) | Train Loss: 0.4292 | Train Acc: 0.9011
 Site-SynthDigits               (1) | Train Loss: 0.3941 | Train Acc: 0.9165
 Site-MNIST_M                   (2) | Train Loss: 0.7702 | Train Acc: 0.7956
 Site-MNIST_M                   (2) | Train Loss: 0.7261 | Train Acc: 0.8043
 Site-SVHN                      (1) | Train Loss: 0.9139 | Train Acc: 0.7199
Average Train Accuracy: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.0056 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0313 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4994 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4787 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3155 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1789 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1442 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1614 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.2289 | Val  Acc: 0.9344
 Site-MNIST                     (0) | Val  Loss: 0.2193 | Val  Acc: 0.9396
 Site-USPS                      (2) | Val  Loss: 0.0596 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.3788 | Val  Acc: 0.8889
 Site-USPS                      (2) | Val  Loss: 0.3880 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.3770 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.3068 | Val  Acc: 0.9048
 Site-USPS                      (2) | Val  Loss: 0.2268 | Val  Acc: 0.9365
 Site-SynthDigits               (1) | Val  Loss: 0.4431 | Val  Acc: 0.9189
 Site-SynthDigits               (1) | Val  Loss: 0.2676 | Val  Acc: 0.9412
 Site-SynthDigits               (1) | Val  Loss: 0.3873 | Val  Acc: 0.9098
 Site-MNIST_M                   (2) | Val  Loss: 0.8563 | Val  Acc: 0.7556
 Site-MNIST_M                   (2) | Val  Loss: 0.7336 | Val  Acc: 0.8025
 Site-SVHN                      (1) | Val  Loss: 0.6303 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8972
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.9412
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.9344
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.9396
 Best site-USPS                     (2)  | Epoch:43 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:43 | Val Acc: 0.8889
 Best site-USPS                     (2)  | Epoch:43 | Val Acc: 0.8750
 Best site-USPS                     (2)  | Epoch:43 | Val Acc: 0.8448
 Best site-USPS                     (2)  | Epoch:43 | Val Acc: 0.9048
 Best site-USPS                     (2)  | Epoch:43 | Val Acc: 0.9365
 Best site-SynthDigits              (1)  | Epoch:43 | Val Acc: 0.9189
 Best site-SynthDigits              (1)  | Epoch:43 | Val Acc: 0.9412
 Best site-SynthDigits              (1)  | Epoch:43 | Val Acc: 0.9098
 Best site-MNIST_M                  (2)  | Epoch:43 | Val Acc: 0.7556
 Best site-MNIST_M                  (2)  | Epoch:43 | Val Acc: 0.8025
 Best site-SVHN                     (1)  | Epoch:43 | Val Acc: 0.7857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 44 ============
cnt=[10, 8, 4, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (0) | Train Loss: 0.4931 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2661 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.0949 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1211 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.1363 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.1436 | Train Acc: 0.9603
 Site-MNIST                     (0) | Train Loss: 0.1539 | Train Acc: 0.9648
 Site-MNIST                     (0) | Train Loss: 0.2029 | Train Acc: 0.9438
 Site-MNIST                     (0) | Train Loss: 0.2098 | Train Acc: 0.9375
 Site-MNIST                     (0) | Train Loss: 0.1656 | Train Acc: 0.9623
 Site-USPS                      (1) | Train Loss: 0.2159 | Train Acc: 0.9750
 Site-USPS                      (1) | Train Loss: 0.2253 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.1398 | Train Acc: 0.9457
 Site-USPS                      (1) | Train Loss: 0.2605 | Train Acc: 0.9099
 Site-USPS                      (1) | Train Loss: 0.2037 | Train Acc: 0.9500
 Site-USPS                      (1) | Train Loss: 0.2058 | Train Acc: 0.9444
 Site-SynthDigits               (2) | Train Loss: 0.5107 | Train Acc: 0.8344
 Site-SynthDigits               (2) | Train Loss: 0.4068 | Train Acc: 0.9158
 Site-SynthDigits               (2) | Train Loss: 0.3835 | Train Acc: 0.9145
 Site-MNIST_M                   (1) | Train Loss: 0.7428 | Train Acc: 0.7735
 Site-MNIST_M                   (1) | Train Loss: 0.7895 | Train Acc: 0.8043
 Site-SVHN                      (2) | Train Loss: 0.8751 | Train Acc: 0.7376
Average Train Accuracy: 0.9095
 Site-MNIST                     (0) | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0301 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4744 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4734 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3065 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1751 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1412 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1582 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.2266 | Val  Acc: 0.9344
 Site-MNIST                     (0) | Val  Loss: 0.2157 | Val  Acc: 0.9396
 Site-USPS                      (1) | Val  Loss: 0.0617 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3902 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.3963 | Val  Acc: 0.8750
 Site-USPS                      (1) | Val  Loss: 0.3733 | Val  Acc: 0.8621
 Site-USPS                      (1) | Val  Loss: 0.3019 | Val  Acc: 0.8952
 Site-USPS                      (1) | Val  Loss: 0.2225 | Val  Acc: 0.9312
 Site-SynthDigits               (2) | Val  Loss: 0.4321 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.2579 | Val  Acc: 0.9412
 Site-SynthDigits               (2) | Val  Loss: 0.3797 | Val  Acc: 0.9098
 Site-MNIST_M                   (1) | Val  Loss: 0.8650 | Val  Acc: 0.7556
 Site-MNIST_M                   (1) | Val  Loss: 0.7383 | Val  Acc: 0.8148
 Site-SVHN                      (2) | Val  Loss: 0.6212 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8966
============ Train epoch 45 ============
cnt=[10, 8, 4, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (0) | Train Loss: 0.4857 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2539 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.0996 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1196 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.1512 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1460 | Train Acc: 0.9683
 Site-MNIST                     (0) | Train Loss: 0.1480 | Train Acc: 0.9648
 Site-MNIST                     (0) | Train Loss: 0.2073 | Train Acc: 0.9487
 Site-MNIST                     (0) | Train Loss: 0.2030 | Train Acc: 0.9375
 Site-MNIST                     (0) | Train Loss: 0.1644 | Train Acc: 0.9615
 Site-USPS                      (1) | Train Loss: 0.2179 | Train Acc: 0.9750
 Site-USPS                      (1) | Train Loss: 0.2087 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.1735 | Train Acc: 0.9457
 Site-USPS                      (1) | Train Loss: 0.2544 | Train Acc: 0.9185
 Site-USPS                      (1) | Train Loss: 0.1878 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.2017 | Train Acc: 0.9444
 Site-SynthDigits               (2) | Train Loss: 0.5141 | Train Acc: 0.8675
 Site-SynthDigits               (2) | Train Loss: 0.4043 | Train Acc: 0.9011
 Site-SynthDigits               (2) | Train Loss: 0.3779 | Train Acc: 0.9145
 Site-MNIST_M                   (1) | Train Loss: 0.7368 | Train Acc: 0.7735
 Site-MNIST_M                   (1) | Train Loss: 0.6536 | Train Acc: 0.7982
 Site-SVHN                      (2) | Train Loss: 0.8546 | Train Acc: 0.7340
Average Train Accuracy: 0.9103
 Site-MNIST                     (0) | Val  Loss: 0.0054 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0284 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4832 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4882 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3107 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1779 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1395 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1571 | Val  Acc: 0.9510
 Site-MNIST                     (0) | Val  Loss: 0.2252 | Val  Acc: 0.9399
 Site-MNIST                     (0) | Val  Loss: 0.2159 | Val  Acc: 0.9456
 Site-USPS                      (1) | Val  Loss: 0.0555 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3871 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.3917 | Val  Acc: 0.8750
 Site-USPS                      (1) | Val  Loss: 0.3676 | Val  Acc: 0.8793
 Site-USPS                      (1) | Val  Loss: 0.2950 | Val  Acc: 0.8952
 Site-USPS                      (1) | Val  Loss: 0.2180 | Val  Acc: 0.9312
 Site-SynthDigits               (2) | Val  Loss: 0.4257 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.2538 | Val  Acc: 0.9412
 Site-SynthDigits               (2) | Val  Loss: 0.3677 | Val  Acc: 0.9180
 Site-MNIST_M                   (1) | Val  Loss: 0.8435 | Val  Acc: 0.7778
 Site-MNIST_M                   (1) | Val  Loss: 0.7259 | Val  Acc: 0.8025
 Site-SVHN                      (2) | Val  Loss: 0.6136 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8998
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.9510
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.9399
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.9456
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 0.8889
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 0.8750
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 0.8793
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 0.8952
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 0.9312
 Best site-SynthDigits              (2)  | Epoch:45 | Val Acc: 0.9189
 Best site-SynthDigits              (2)  | Epoch:45 | Val Acc: 0.9412
 Best site-SynthDigits              (2)  | Epoch:45 | Val Acc: 0.9180
 Best site-MNIST_M                  (1)  | Epoch:45 | Val Acc: 0.7778
 Best site-MNIST_M                  (1)  | Epoch:45 | Val Acc: 0.8025
 Best site-SVHN                     (2)  | Epoch:45 | Val Acc: 0.7714
 Test site-MNIST                     (0)| Epoch:45 | Test Acc: 0.9420
 Test site-USPS                      (1)| Epoch:45 | Test Acc: 0.9473
 Test site-SynthDigits               (2)| Epoch:45 | Test Acc: 0.8836
 Test site-MNIST_M                   (1)| Epoch:45 | Test Acc: 0.7149
 Test site-SVHN                      (2)| Epoch:45 | Test Acc: 0.6286
MNIST: 0.9420, USPS: 0.9473, SynthDigits: 0.8836, MNIST_M: 0.7149, SVHN: 0.6286, 
Average Test Accuracy(group): 0.8233, Average Test Accuracy(individual): 0.9006,
domain std=0.1287, cluster std=0.0500, individual std=0.0890, 
===2023-08-13 12:45:22===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 3
Loading snapshots...
 Test site-MNIST                     (0)| Epoch:43 | Test Acc: 0.9421
 Test site-USPS                      (2)| Epoch:43 | Test Acc: 0.9452
 Test site-SynthDigits               (1)| Epoch:43 | Test Acc: 0.8814
 Test site-MNIST_M                   (2)| Epoch:43 | Test Acc: 0.7161
 Test site-SVHN                      (1)| Epoch:43 | Test Acc: 0.6259
MNIST: 0.9421, USPS: 0.9452, SynthDigits: 0.8814, MNIST_M: 0.7161, SVHN: 0.6259, 
Average Test Accuracy(group): 0.8222, Average Test Accuracy(individual): 0.8998,
domain std=0.1287, cluster std=0.0510, individual std=0.0889, 
===2023-08-14 09:00:30===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 3
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[10, 9, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (0) | Train Loss: 1.6532 | Train Acc: 0.5000
 Site-MNIST                     (0) | Train Loss: 1.6928 | Train Acc: 0.5833
 Site-MNIST                     (0) | Train Loss: 1.5678 | Train Acc: 0.7143
 Site-MNIST                     (0) | Train Loss: 1.5580 | Train Acc: 0.7105
 Site-MNIST                     (0) | Train Loss: 1.6556 | Train Acc: 0.7286
 Site-MNIST                     (0) | Train Loss: 1.5398 | Train Acc: 0.7381
 Site-MNIST                     (0) | Train Loss: 1.5223 | Train Acc: 0.7577
 Site-MNIST                     (0) | Train Loss: 1.6325 | Train Acc: 0.6430
 Site-MNIST                     (0) | Train Loss: 1.5962 | Train Acc: 0.6712
 Site-MNIST                     (0) | Train Loss: 1.5476 | Train Acc: 0.7200
 Site-USPS                      (1) | Train Loss: 1.6370 | Train Acc: 0.6250
 Site-USPS                      (1) | Train Loss: 1.6637 | Train Acc: 0.6111
 Site-USPS                      (1) | Train Loss: 1.6870 | Train Acc: 0.6124
 Site-USPS                      (1) | Train Loss: 1.6905 | Train Acc: 0.5794
 Site-USPS                      (1) | Train Loss: 1.6849 | Train Acc: 0.6071
 Site-USPS                      (1) | Train Loss: 1.6813 | Train Acc: 0.6019
 Site-SynthDigits               (1) | Train Loss: 2.1274 | Train Acc: 0.2649
 Site-SynthDigits               (1) | Train Loss: 2.1556 | Train Acc: 0.2015
 Site-SynthDigits               (1) | Train Loss: 2.1058 | Train Acc: 0.2953
 Site-MNIST_M                   (2) | Train Loss: 2.2708 | Train Acc: 0.1657
 Site-MNIST_M                   (2) | Train Loss: 2.1576 | Train Acc: 0.2263
 Site-SVHN                      (2) | Train Loss: 2.2308 | Train Acc: 0.1879
Average Train Accuracy: 0.5339
 Site-MNIST                     (0) | Val  Loss: 1.3860 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 1.2989 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 1.3377 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 1.5777 | Val  Acc: 0.5556
 Site-MNIST                     (0) | Val  Loss: 1.6099 | Val  Acc: 0.5882
 Site-MNIST                     (0) | Val  Loss: 1.5814 | Val  Acc: 0.6774
 Site-MNIST                     (0) | Val  Loss: 1.5364 | Val  Acc: 0.7143
 Site-MNIST                     (0) | Val  Loss: 1.5277 | Val  Acc: 0.6961
 Site-MNIST                     (0) | Val  Loss: 1.5936 | Val  Acc: 0.6612
 Site-MNIST                     (0) | Val  Loss: 1.5610 | Val  Acc: 0.6918
 Site-USPS                      (1) | Val  Loss: 1.7231 | Val  Acc: 0.6000
 Site-USPS                      (1) | Val  Loss: 1.8374 | Val  Acc: 0.5000
 Site-USPS                      (1) | Val  Loss: 1.7231 | Val  Acc: 0.6562
 Site-USPS                      (1) | Val  Loss: 1.7611 | Val  Acc: 0.5172
 Site-USPS                      (1) | Val  Loss: 1.7049 | Val  Acc: 0.5714
 Site-USPS                      (1) | Val  Loss: 1.6568 | Val  Acc: 0.5820
 Site-SynthDigits               (1) | Val  Loss: 2.2049 | Val  Acc: 0.1892
 Site-SynthDigits               (1) | Val  Loss: 2.2899 | Val  Acc: 0.1618
 Site-SynthDigits               (1) | Val  Loss: 2.1252 | Val  Acc: 0.2049
 Site-MNIST_M                   (2) | Val  Loss: 2.2359 | Val  Acc: 0.1778
 Site-MNIST_M                   (2) | Val  Loss: 2.2236 | Val  Acc: 0.1975
 Site-SVHN                      (2) | Val  Loss: 2.1759 | Val  Acc: 0.1000
Average Valid Accuracy: 0.5383
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.5556
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.5882
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.6774
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.7143
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.6961
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.6612
 Best site-MNIST                    (0)  | Epoch:0 | Val Acc: 0.6918
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.6000
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.5000
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.6562
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.5172
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.5714
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.5820
 Best site-SynthDigits              (1)  | Epoch:0 | Val Acc: 0.1892
 Best site-SynthDigits              (1)  | Epoch:0 | Val Acc: 0.1618
 Best site-SynthDigits              (1)  | Epoch:0 | Val Acc: 0.2049
 Best site-MNIST_M                  (2)  | Epoch:0 | Val Acc: 0.1778
 Best site-MNIST_M                  (2)  | Epoch:0 | Val Acc: 0.1975
 Best site-SVHN                     (2)  | Epoch:0 | Val Acc: 0.1000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 1 ============
cnt=[6, 6, 10, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (2) | Train Loss: 1.1952 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 1.2571 | Train Acc: 0.5833
 Site-MNIST                     (2) | Train Loss: 1.0919 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 1.1002 | Train Acc: 0.8684
 Site-MNIST                     (2) | Train Loss: 1.0018 | Train Acc: 0.8286
 Site-MNIST                     (2) | Train Loss: 1.0866 | Train Acc: 0.8413
 Site-MNIST                     (2) | Train Loss: 1.1032 | Train Acc: 0.8150
 Site-MNIST                     (2) | Train Loss: 1.1948 | Train Acc: 0.7628
 Site-MNIST                     (2) | Train Loss: 1.1695 | Train Acc: 0.7649
 Site-MNIST                     (2) | Train Loss: 1.1126 | Train Acc: 0.8000
 Site-USPS                      (0) | Train Loss: 1.1280 | Train Acc: 0.8000
 Site-USPS                      (0) | Train Loss: 1.2847 | Train Acc: 0.7917
 Site-USPS                      (0) | Train Loss: 1.6107 | Train Acc: 0.7442
 Site-USPS                      (0) | Train Loss: 1.2262 | Train Acc: 0.7253
 Site-USPS                      (0) | Train Loss: 1.1951 | Train Acc: 0.7190
 Site-USPS                      (0) | Train Loss: 1.2073 | Train Acc: 0.7619
 Site-SynthDigits               (1) | Train Loss: 1.9372 | Train Acc: 0.3179
 Site-SynthDigits               (1) | Train Loss: 1.9358 | Train Acc: 0.3077
 Site-SynthDigits               (1) | Train Loss: 1.8972 | Train Acc: 0.3422
 Site-MNIST_M                   (1) | Train Loss: 2.1382 | Train Acc: 0.2376
 Site-MNIST_M                   (1) | Train Loss: 2.0054 | Train Acc: 0.3089
 Site-SVHN                      (1) | Train Loss: 2.1561 | Train Acc: 0.2234
Average Train Accuracy: 0.6470
 Site-MNIST                     (2) | Val  Loss: 0.7898 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.7890 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.8451 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 1.1489 | Val  Acc: 0.6667
 Site-MNIST                     (2) | Val  Loss: 1.1600 | Val  Acc: 0.7059
 Site-MNIST                     (2) | Val  Loss: 1.1674 | Val  Acc: 0.8065
 Site-MNIST                     (2) | Val  Loss: 1.1068 | Val  Acc: 0.8214
 Site-MNIST                     (2) | Val  Loss: 1.1095 | Val  Acc: 0.7941
 Site-MNIST                     (2) | Val  Loss: 1.1773 | Val  Acc: 0.7705
 Site-MNIST                     (2) | Val  Loss: 1.1403 | Val  Acc: 0.7855
 Site-USPS                      (0) | Val  Loss: 1.2125 | Val  Acc: 0.7000
 Site-USPS                      (0) | Val  Loss: 1.4787 | Val  Acc: 0.6111
 Site-USPS                      (0) | Val  Loss: 1.3414 | Val  Acc: 0.6875
 Site-USPS                      (0) | Val  Loss: 1.3498 | Val  Acc: 0.6552
 Site-USPS                      (0) | Val  Loss: 1.2493 | Val  Acc: 0.7333
 Site-USPS                      (0) | Val  Loss: 1.1954 | Val  Acc: 0.7407
 Site-SynthDigits               (1) | Val  Loss: 2.0342 | Val  Acc: 0.2432
 Site-SynthDigits               (1) | Val  Loss: 2.0415 | Val  Acc: 0.2647
 Site-SynthDigits               (1) | Val  Loss: 1.9277 | Val  Acc: 0.3279
 Site-MNIST_M                   (1) | Val  Loss: 2.1673 | Val  Acc: 0.2444
 Site-MNIST_M                   (1) | Val  Loss: 2.1049 | Val  Acc: 0.2963
 Site-SVHN                      (1) | Val  Loss: 2.0575 | Val  Acc: 0.2000
Average Valid Accuracy: 0.6298
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.6667
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.7059
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.8065
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.8214
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.7941
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.7705
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.7855
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.7000
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.6111
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.6875
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.6552
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.7333
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.7407
 Best site-SynthDigits              (1)  | Epoch:1 | Val Acc: 0.2432
 Best site-SynthDigits              (1)  | Epoch:1 | Val Acc: 0.2647
 Best site-SynthDigits              (1)  | Epoch:1 | Val Acc: 0.3279
 Best site-MNIST_M                  (1)  | Epoch:1 | Val Acc: 0.2444
 Best site-MNIST_M                  (1)  | Epoch:1 | Val Acc: 0.2963
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.2000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 2 ============
cnt=[16, 3, 3, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (0) | Train Loss: 0.9819 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 1.1432 | Train Acc: 0.6667
 Site-MNIST                     (0) | Train Loss: 0.9192 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.9439 | Train Acc: 0.8158
 Site-MNIST                     (0) | Train Loss: 0.9124 | Train Acc: 0.8143
 Site-MNIST                     (0) | Train Loss: 0.9393 | Train Acc: 0.8492
 Site-MNIST                     (0) | Train Loss: 0.9272 | Train Acc: 0.8502
 Site-MNIST                     (0) | Train Loss: 1.0655 | Train Acc: 0.7922
 Site-MNIST                     (0) | Train Loss: 1.0011 | Train Acc: 0.7976
 Site-MNIST                     (0) | Train Loss: 0.9546 | Train Acc: 0.8272
 Site-USPS                      (0) | Train Loss: 0.8922 | Train Acc: 0.8250
 Site-USPS                      (0) | Train Loss: 0.8098 | Train Acc: 0.8472
 Site-USPS                      (0) | Train Loss: 0.9761 | Train Acc: 0.7984
 Site-USPS                      (0) | Train Loss: 0.9908 | Train Acc: 0.7854
 Site-USPS                      (0) | Train Loss: 0.9652 | Train Acc: 0.7905
 Site-USPS                      (0) | Train Loss: 0.9744 | Train Acc: 0.8029
 Site-SynthDigits               (1) | Train Loss: 1.8435 | Train Acc: 0.3907
 Site-SynthDigits               (1) | Train Loss: 1.7471 | Train Acc: 0.4066
 Site-SynthDigits               (1) | Train Loss: 1.7309 | Train Acc: 0.4155
 Site-MNIST_M                   (2) | Train Loss: 2.0490 | Train Acc: 0.2762
 Site-MNIST_M                   (2) | Train Loss: 1.8994 | Train Acc: 0.3578
 Site-SVHN                      (2) | Train Loss: 2.1038 | Train Acc: 0.2376
Average Train Accuracy: 0.6835
 Site-MNIST                     (0) | Val  Loss: 0.5663 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.6020 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.6964 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 1.0142 | Val  Acc: 0.6667
 Site-MNIST                     (0) | Val  Loss: 1.0118 | Val  Acc: 0.7059
 Site-MNIST                     (0) | Val  Loss: 1.0080 | Val  Acc: 0.8065
 Site-MNIST                     (0) | Val  Loss: 0.9349 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.9403 | Val  Acc: 0.8235
 Site-MNIST                     (0) | Val  Loss: 1.0145 | Val  Acc: 0.8142
 Site-MNIST                     (0) | Val  Loss: 0.9812 | Val  Acc: 0.8097
 Site-USPS                      (0) | Val  Loss: 0.9028 | Val  Acc: 0.8000
 Site-USPS                      (0) | Val  Loss: 1.2458 | Val  Acc: 0.6667
 Site-USPS                      (0) | Val  Loss: 1.1404 | Val  Acc: 0.6875
 Site-USPS                      (0) | Val  Loss: 1.1517 | Val  Acc: 0.6897
 Site-USPS                      (0) | Val  Loss: 1.0310 | Val  Acc: 0.7810
 Site-USPS                      (0) | Val  Loss: 0.9718 | Val  Acc: 0.8095
 Site-SynthDigits               (1) | Val  Loss: 1.8931 | Val  Acc: 0.4054
 Site-SynthDigits               (1) | Val  Loss: 1.9020 | Val  Acc: 0.3824
 Site-SynthDigits               (1) | Val  Loss: 1.7691 | Val  Acc: 0.3934
 Site-MNIST_M                   (2) | Val  Loss: 2.0775 | Val  Acc: 0.2889
 Site-MNIST_M                   (2) | Val  Loss: 2.0169 | Val  Acc: 0.3086
 Site-SVHN                      (2) | Val  Loss: 2.0276 | Val  Acc: 0.2286
Average Valid Accuracy: 0.6693
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.6667
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.7059
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8065
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8571
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8235
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8142
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8097
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.8000
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.6667
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.6875
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.6897
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7810
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.8095
 Best site-SynthDigits              (1)  | Epoch:2 | Val Acc: 0.4054
 Best site-SynthDigits              (1)  | Epoch:2 | Val Acc: 0.3824
 Best site-SynthDigits              (1)  | Epoch:2 | Val Acc: 0.3934
 Best site-MNIST_M                  (2)  | Epoch:2 | Val Acc: 0.2889
 Best site-MNIST_M                  (2)  | Epoch:2 | Val Acc: 0.3086
 Best site-SVHN                     (2)  | Epoch:2 | Val Acc: 0.2286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 3 ============
cnt=[16, 3, 3, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (0) | Train Loss: 0.9053 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 1.0124 | Train Acc: 0.7500
 Site-MNIST                     (0) | Train Loss: 0.7754 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.8161 | Train Acc: 0.8947
 Site-MNIST                     (0) | Train Loss: 1.0484 | Train Acc: 0.8143
 Site-MNIST                     (0) | Train Loss: 0.8081 | Train Acc: 0.8651
 Site-MNIST                     (0) | Train Loss: 0.7947 | Train Acc: 0.8546
 Site-MNIST                     (0) | Train Loss: 0.9241 | Train Acc: 0.8093
 Site-MNIST                     (0) | Train Loss: 0.8819 | Train Acc: 0.8125
 Site-MNIST                     (0) | Train Loss: 0.8271 | Train Acc: 0.8377
 Site-USPS                      (0) | Train Loss: 0.7857 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.7836 | Train Acc: 0.8472
 Site-USPS                      (0) | Train Loss: 0.6584 | Train Acc: 0.8062
 Site-USPS                      (0) | Train Loss: 0.8577 | Train Acc: 0.8112
 Site-USPS                      (0) | Train Loss: 0.8447 | Train Acc: 0.8024
 Site-USPS                      (0) | Train Loss: 0.8549 | Train Acc: 0.8122
 Site-SynthDigits               (1) | Train Loss: 1.6913 | Train Acc: 0.4238
 Site-SynthDigits               (1) | Train Loss: 1.6483 | Train Acc: 0.4432
 Site-SynthDigits               (1) | Train Loss: 1.6047 | Train Acc: 0.4460
 Site-MNIST_M                   (2) | Train Loss: 1.9666 | Train Acc: 0.2873
 Site-MNIST_M                   (2) | Train Loss: 1.7387 | Train Acc: 0.4159
 Site-SVHN                      (2) | Train Loss: 2.0163 | Train Acc: 0.2695
Average Train Accuracy: 0.7065
 Site-MNIST                     (0) | Val  Loss: 0.4279 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4689 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.6239 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.9293 | Val  Acc: 0.6667
 Site-MNIST                     (0) | Val  Loss: 0.9081 | Val  Acc: 0.7059
 Site-MNIST                     (0) | Val  Loss: 0.8858 | Val  Acc: 0.8065
 Site-MNIST                     (0) | Val  Loss: 0.8036 | Val  Acc: 0.8750
 Site-MNIST                     (0) | Val  Loss: 0.8106 | Val  Acc: 0.8529
 Site-MNIST                     (0) | Val  Loss: 0.8899 | Val  Acc: 0.8197
 Site-MNIST                     (0) | Val  Loss: 0.8580 | Val  Acc: 0.8157
 Site-USPS                      (0) | Val  Loss: 0.7415 | Val  Acc: 0.8000
 Site-USPS                      (0) | Val  Loss: 1.1393 | Val  Acc: 0.6667
 Site-USPS                      (0) | Val  Loss: 1.0489 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 1.0464 | Val  Acc: 0.7241
 Site-USPS                      (0) | Val  Loss: 0.9095 | Val  Acc: 0.8000
 Site-USPS                      (0) | Val  Loss: 0.8535 | Val  Acc: 0.8254
 Site-SynthDigits               (1) | Val  Loss: 1.7793 | Val  Acc: 0.4324
 Site-SynthDigits               (1) | Val  Loss: 1.7529 | Val  Acc: 0.4706
 Site-SynthDigits               (1) | Val  Loss: 1.6433 | Val  Acc: 0.4508
 Site-MNIST_M                   (2) | Val  Loss: 2.0030 | Val  Acc: 0.3111
 Site-MNIST_M                   (2) | Val  Loss: 1.9441 | Val  Acc: 0.3457
 Site-SVHN                      (2) | Val  Loss: 1.9830 | Val  Acc: 0.2429
Average Valid Accuracy: 0.6878
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.6667
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.7059
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8065
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8750
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8529
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8197
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8157
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8000
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.6667
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.7188
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.7241
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8000
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8254
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.4324
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.4706
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.4508
 Best site-MNIST_M                  (2)  | Epoch:3 | Val Acc: 0.3111
 Best site-MNIST_M                  (2)  | Epoch:3 | Val Acc: 0.3457
 Best site-SVHN                     (2)  | Epoch:3 | Val Acc: 0.2429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 4 ============
cnt=[16, 3, 3, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (0) | Train Loss: 0.8363 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.9198 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.7014 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.7119 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.7245 | Train Acc: 0.8286
 Site-MNIST                     (0) | Train Loss: 0.7336 | Train Acc: 0.8254
 Site-MNIST                     (0) | Train Loss: 0.7245 | Train Acc: 0.8546
 Site-MNIST                     (0) | Train Loss: 0.8268 | Train Acc: 0.8166
 Site-MNIST                     (0) | Train Loss: 0.7981 | Train Acc: 0.8247
 Site-MNIST                     (0) | Train Loss: 0.7459 | Train Acc: 0.8513
 Site-USPS                      (0) | Train Loss: 0.6835 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.6508 | Train Acc: 0.8611
 Site-USPS                      (0) | Train Loss: 0.8470 | Train Acc: 0.8450
 Site-USPS                      (0) | Train Loss: 0.8187 | Train Acc: 0.8240
 Site-USPS                      (0) | Train Loss: 0.7648 | Train Acc: 0.8333
 Site-USPS                      (0) | Train Loss: 0.7688 | Train Acc: 0.8294
 Site-SynthDigits               (1) | Train Loss: 1.5605 | Train Acc: 0.4768
 Site-SynthDigits               (1) | Train Loss: 1.5562 | Train Acc: 0.5092
 Site-SynthDigits               (1) | Train Loss: 1.4891 | Train Acc: 0.4847
 Site-MNIST_M                   (2) | Train Loss: 1.8934 | Train Acc: 0.3315
 Site-MNIST_M                   (2) | Train Loss: 1.6822 | Train Acc: 0.4465
 Site-SVHN                      (2) | Train Loss: 1.9677 | Train Acc: 0.3085
Average Train Accuracy: 0.7294
 Site-MNIST                     (0) | Val  Loss: 0.3075 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.3419 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.5505 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.8237 | Val  Acc: 0.6667
 Site-MNIST                     (0) | Val  Loss: 0.8165 | Val  Acc: 0.7059
 Site-MNIST                     (0) | Val  Loss: 0.8002 | Val  Acc: 0.8387
 Site-MNIST                     (0) | Val  Loss: 0.7232 | Val  Acc: 0.8929
 Site-MNIST                     (0) | Val  Loss: 0.7284 | Val  Acc: 0.8529
 Site-MNIST                     (0) | Val  Loss: 0.8017 | Val  Acc: 0.8306
 Site-MNIST                     (0) | Val  Loss: 0.7749 | Val  Acc: 0.8187
 Site-USPS                      (0) | Val  Loss: 0.6494 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 1.0532 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.9633 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 0.9686 | Val  Acc: 0.7241
 Site-USPS                      (0) | Val  Loss: 0.8303 | Val  Acc: 0.8095
 Site-USPS                      (0) | Val  Loss: 0.7676 | Val  Acc: 0.8571
 Site-SynthDigits               (1) | Val  Loss: 1.6808 | Val  Acc: 0.5135
 Site-SynthDigits               (1) | Val  Loss: 1.5927 | Val  Acc: 0.5588
 Site-SynthDigits               (1) | Val  Loss: 1.5313 | Val  Acc: 0.5164
 Site-MNIST_M                   (2) | Val  Loss: 1.9131 | Val  Acc: 0.4000
 Site-MNIST_M                   (2) | Val  Loss: 1.8666 | Val  Acc: 0.4444
 Site-SVHN                      (2) | Val  Loss: 1.9302 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7208
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.6667
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.7059
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8387
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8929
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8529
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8306
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8187
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7222
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7188
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7241
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.8095
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.8571
 Best site-SynthDigits              (1)  | Epoch:4 | Val Acc: 0.5135
 Best site-SynthDigits              (1)  | Epoch:4 | Val Acc: 0.5588
 Best site-SynthDigits              (1)  | Epoch:4 | Val Acc: 0.5164
 Best site-MNIST_M                  (2)  | Epoch:4 | Val Acc: 0.4000
 Best site-MNIST_M                  (2)  | Epoch:4 | Val Acc: 0.4444
 Best site-SVHN                     (2)  | Epoch:4 | Val Acc: 0.2857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 5 ============
cnt=[16, 3, 3, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (0) | Train Loss: 0.7949 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.8444 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.6269 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.6377 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.5713 | Train Acc: 0.8286
 Site-MNIST                     (0) | Train Loss: 0.6638 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.6474 | Train Acc: 0.8722
 Site-MNIST                     (0) | Train Loss: 0.7461 | Train Acc: 0.8264
 Site-MNIST                     (0) | Train Loss: 0.7176 | Train Acc: 0.8451
 Site-MNIST                     (0) | Train Loss: 0.6754 | Train Acc: 0.8574
 Site-USPS                      (0) | Train Loss: 0.6320 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.7523 | Train Acc: 0.8611
 Site-USPS                      (0) | Train Loss: 0.5563 | Train Acc: 0.8527
 Site-USPS                      (0) | Train Loss: 0.7360 | Train Acc: 0.8369
 Site-USPS                      (0) | Train Loss: 0.6905 | Train Acc: 0.8381
 Site-USPS                      (0) | Train Loss: 0.7038 | Train Acc: 0.8347
 Site-SynthDigits               (2) | Train Loss: 1.4494 | Train Acc: 0.5232
 Site-SynthDigits               (2) | Train Loss: 1.4238 | Train Acc: 0.5311
 Site-SynthDigits               (2) | Train Loss: 1.4058 | Train Acc: 0.5540
 Site-MNIST_M                   (1) | Train Loss: 1.8137 | Train Acc: 0.3867
 Site-MNIST_M                   (1) | Train Loss: 1.6420 | Train Acc: 0.4832
 Site-SVHN                      (1) | Train Loss: 1.9360 | Train Acc: 0.3333
Average Train Accuracy: 0.7462
 Site-MNIST                     (0) | Val  Loss: 0.2514 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.2735 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.5255 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.7701 | Val  Acc: 0.6667
 Site-MNIST                     (0) | Val  Loss: 0.7542 | Val  Acc: 0.7059
 Site-MNIST                     (0) | Val  Loss: 0.7287 | Val  Acc: 0.8387
 Site-MNIST                     (0) | Val  Loss: 0.6545 | Val  Acc: 0.8929
 Site-MNIST                     (0) | Val  Loss: 0.6604 | Val  Acc: 0.8529
 Site-MNIST                     (0) | Val  Loss: 0.7307 | Val  Acc: 0.8361
 Site-MNIST                     (0) | Val  Loss: 0.7075 | Val  Acc: 0.8338
 Site-USPS                      (0) | Val  Loss: 0.5822 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 1.0065 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.9246 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 0.9240 | Val  Acc: 0.7586
 Site-USPS                      (0) | Val  Loss: 0.7745 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.7071 | Val  Acc: 0.8624
 Site-SynthDigits               (2) | Val  Loss: 1.5912 | Val  Acc: 0.6486
 Site-SynthDigits               (2) | Val  Loss: 1.4569 | Val  Acc: 0.6176
 Site-SynthDigits               (2) | Val  Loss: 1.4296 | Val  Acc: 0.5656
 Site-MNIST_M                   (1) | Val  Loss: 1.8465 | Val  Acc: 0.4444
 Site-MNIST_M                   (1) | Val  Loss: 1.8064 | Val  Acc: 0.4938
 Site-SVHN                      (1) | Val  Loss: 1.8828 | Val  Acc: 0.3143
Average Valid Accuracy: 0.7410
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.6667
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.7059
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8387
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8929
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8529
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8361
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8338
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.7222
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.7188
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.7586
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8286
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8624
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.6486
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.6176
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.5656
 Best site-MNIST_M                  (1)  | Epoch:5 | Val Acc: 0.4444
 Best site-MNIST_M                  (1)  | Epoch:5 | Val Acc: 0.4938
 Best site-SVHN                     (1)  | Epoch:5 | Val Acc: 0.3143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 6 ============
cnt=[3, 16, 3, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (1) | Train Loss: 0.7390 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.7859 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.5804 | Train Acc: 0.8571
 Site-MNIST                     (1) | Train Loss: 0.5716 | Train Acc: 0.8947
 Site-MNIST                     (1) | Train Loss: 0.6483 | Train Acc: 0.8429
 Site-MNIST                     (1) | Train Loss: 0.6239 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.5927 | Train Acc: 0.8722
 Site-MNIST                     (1) | Train Loss: 0.6841 | Train Acc: 0.8264
 Site-MNIST                     (1) | Train Loss: 0.6594 | Train Acc: 0.8505
 Site-MNIST                     (1) | Train Loss: 0.6265 | Train Acc: 0.8657
 Site-USPS                      (1) | Train Loss: 0.5750 | Train Acc: 0.8500
 Site-USPS                      (1) | Train Loss: 0.7261 | Train Acc: 0.8611
 Site-USPS                      (1) | Train Loss: 0.4582 | Train Acc: 0.8372
 Site-USPS                      (1) | Train Loss: 0.7076 | Train Acc: 0.8412
 Site-USPS                      (1) | Train Loss: 0.6603 | Train Acc: 0.8452
 Site-USPS                      (1) | Train Loss: 0.6582 | Train Acc: 0.8479
 Site-SynthDigits               (2) | Train Loss: 1.3573 | Train Acc: 0.5563
 Site-SynthDigits               (2) | Train Loss: 1.3586 | Train Acc: 0.5678
 Site-SynthDigits               (2) | Train Loss: 1.3176 | Train Acc: 0.5967
 Site-MNIST_M                   (0) | Train Loss: 1.7486 | Train Acc: 0.4144
 Site-MNIST_M                   (0) | Train Loss: 1.6292 | Train Acc: 0.5413
 Site-SVHN                      (0) | Train Loss: 1.8705 | Train Acc: 0.3511
Average Train Accuracy: 0.7592
 Site-MNIST                     (1) | Val  Loss: 0.2313 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.2399 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.5076 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.7271 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.7054 | Val  Acc: 0.7647
 Site-MNIST                     (1) | Val  Loss: 0.6729 | Val  Acc: 0.8710
 Site-MNIST                     (1) | Val  Loss: 0.5992 | Val  Acc: 0.8750
 Site-MNIST                     (1) | Val  Loss: 0.6084 | Val  Acc: 0.8627
 Site-MNIST                     (1) | Val  Loss: 0.6806 | Val  Acc: 0.8361
 Site-MNIST                     (1) | Val  Loss: 0.6568 | Val  Acc: 0.8338
 Site-USPS                      (1) | Val  Loss: 0.5322 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.9506 | Val  Acc: 0.7778
 Site-USPS                      (1) | Val  Loss: 0.8831 | Val  Acc: 0.7812
 Site-USPS                      (1) | Val  Loss: 0.8817 | Val  Acc: 0.7931
 Site-USPS                      (1) | Val  Loss: 0.7306 | Val  Acc: 0.8286
 Site-USPS                      (1) | Val  Loss: 0.6592 | Val  Acc: 0.8571
 Site-SynthDigits               (2) | Val  Loss: 1.5019 | Val  Acc: 0.6216
 Site-SynthDigits               (2) | Val  Loss: 1.3522 | Val  Acc: 0.6324
 Site-SynthDigits               (2) | Val  Loss: 1.3437 | Val  Acc: 0.5902
 Site-MNIST_M                   (0) | Val  Loss: 1.7915 | Val  Acc: 0.4444
 Site-MNIST_M                   (0) | Val  Loss: 1.7527 | Val  Acc: 0.4938
 Site-SVHN                      (0) | Val  Loss: 1.8472 | Val  Acc: 0.3429
Average Valid Accuracy: 0.7584
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.7647
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8710
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8750
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8627
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8361
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8338
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.7778
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.7812
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.7931
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8286
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8571
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.6216
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.6324
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.5902
 Best site-MNIST_M                  (0)  | Epoch:6 | Val Acc: 0.4444
 Best site-MNIST_M                  (0)  | Epoch:6 | Val Acc: 0.4938
 Best site-SVHN                     (0)  | Epoch:6 | Val Acc: 0.3429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 7 ============
cnt=[16, 3, 3, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (0) | Train Loss: 0.7147 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.7250 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.5234 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.5175 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.5782 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.5735 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.5370 | Train Acc: 0.8767
 Site-MNIST                     (0) | Train Loss: 0.6504 | Train Acc: 0.8411
 Site-MNIST                     (0) | Train Loss: 0.6171 | Train Acc: 0.8628
 Site-MNIST                     (0) | Train Loss: 0.5773 | Train Acc: 0.8762
 Site-USPS                      (0) | Train Loss: 0.5435 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.5883 | Train Acc: 0.8750
 Site-USPS                      (0) | Train Loss: 0.5278 | Train Acc: 0.8372
 Site-USPS                      (0) | Train Loss: 0.6587 | Train Acc: 0.8412
 Site-USPS                      (0) | Train Loss: 0.6297 | Train Acc: 0.8357
 Site-USPS                      (0) | Train Loss: 0.6214 | Train Acc: 0.8519
 Site-SynthDigits               (2) | Train Loss: 1.3599 | Train Acc: 0.5563
 Site-SynthDigits               (2) | Train Loss: 1.3028 | Train Acc: 0.5861
 Site-SynthDigits               (2) | Train Loss: 1.2520 | Train Acc: 0.6232
 Site-MNIST_M                   (1) | Train Loss: 1.6784 | Train Acc: 0.4530
 Site-MNIST_M                   (1) | Train Loss: 1.5341 | Train Acc: 0.5505
 Site-SVHN                      (1) | Train Loss: 1.8477 | Train Acc: 0.3652
Average Train Accuracy: 0.7693
 Site-MNIST                     (0) | Val  Loss: 0.1876 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.2009 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4837 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.6812 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.6514 | Val  Acc: 0.8235
 Site-MNIST                     (0) | Val  Loss: 0.6210 | Val  Acc: 0.9032
 Site-MNIST                     (0) | Val  Loss: 0.5493 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.5598 | Val  Acc: 0.8725
 Site-MNIST                     (0) | Val  Loss: 0.6286 | Val  Acc: 0.8525
 Site-MNIST                     (0) | Val  Loss: 0.6078 | Val  Acc: 0.8489
 Site-USPS                      (0) | Val  Loss: 0.5018 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.9265 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.8612 | Val  Acc: 0.7500
 Site-USPS                      (0) | Val  Loss: 0.8476 | Val  Acc: 0.7759
 Site-USPS                      (0) | Val  Loss: 0.6959 | Val  Acc: 0.8381
 Site-USPS                      (0) | Val  Loss: 0.6241 | Val  Acc: 0.8624
 Site-SynthDigits               (2) | Val  Loss: 1.4320 | Val  Acc: 0.6757
 Site-SynthDigits               (2) | Val  Loss: 1.2573 | Val  Acc: 0.6618
 Site-SynthDigits               (2) | Val  Loss: 1.2755 | Val  Acc: 0.6311
 Site-MNIST_M                   (1) | Val  Loss: 1.7225 | Val  Acc: 0.4667
 Site-MNIST_M                   (1) | Val  Loss: 1.6873 | Val  Acc: 0.5185
 Site-SVHN                      (1) | Val  Loss: 1.8038 | Val  Acc: 0.3571
Average Valid Accuracy: 0.7729
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8235
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.9032
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8725
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8525
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8489
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.7500
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.7759
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.8381
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.8624
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.6757
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.6618
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.6311
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.4667
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.5185
 Best site-SVHN                     (1)  | Epoch:7 | Val Acc: 0.3571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 8 ============
cnt=[16, 3, 3, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (0) | Train Loss: 0.6979 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.7347 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.5205 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.4968 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.8249 | Train Acc: 0.8286
 Site-MNIST                     (0) | Train Loss: 0.5671 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.5134 | Train Acc: 0.8767
 Site-MNIST                     (0) | Train Loss: 0.6279 | Train Acc: 0.8362
 Site-MNIST                     (0) | Train Loss: 0.5968 | Train Acc: 0.8546
 Site-MNIST                     (0) | Train Loss: 0.5606 | Train Acc: 0.8687
 Site-USPS                      (0) | Train Loss: 0.5055 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.5023 | Train Acc: 0.8889
 Site-USPS                      (0) | Train Loss: 0.4097 | Train Acc: 0.8605
 Site-USPS                      (0) | Train Loss: 0.6507 | Train Acc: 0.8498
 Site-USPS                      (0) | Train Loss: 0.5738 | Train Acc: 0.8690
 Site-USPS                      (0) | Train Loss: 0.5843 | Train Acc: 0.8624
 Site-SynthDigits               (1) | Train Loss: 1.3165 | Train Acc: 0.6026
 Site-SynthDigits               (1) | Train Loss: 1.2070 | Train Acc: 0.6264
 Site-SynthDigits               (1) | Train Loss: 1.1892 | Train Acc: 0.6456
 Site-MNIST_M                   (2) | Train Loss: 1.6314 | Train Acc: 0.4696
 Site-MNIST_M                   (2) | Train Loss: 1.4430 | Train Acc: 0.5566
 Site-SVHN                      (2) | Train Loss: 1.7776 | Train Acc: 0.3901
Average Train Accuracy: 0.7734
 Site-MNIST                     (0) | Val  Loss: 0.1399 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1742 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4992 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.6955 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.6578 | Val  Acc: 0.8235
 Site-MNIST                     (0) | Val  Loss: 0.6035 | Val  Acc: 0.9032
 Site-MNIST                     (0) | Val  Loss: 0.5303 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.5404 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.6147 | Val  Acc: 0.8415
 Site-MNIST                     (0) | Val  Loss: 0.5900 | Val  Acc: 0.8399
 Site-USPS                      (0) | Val  Loss: 0.4499 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.8647 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.8216 | Val  Acc: 0.7812
 Site-USPS                      (0) | Val  Loss: 0.8243 | Val  Acc: 0.7931
 Site-USPS                      (0) | Val  Loss: 0.6661 | Val  Acc: 0.8381
 Site-USPS                      (0) | Val  Loss: 0.5861 | Val  Acc: 0.8730
 Site-SynthDigits               (1) | Val  Loss: 1.3624 | Val  Acc: 0.6757
 Site-SynthDigits               (1) | Val  Loss: 1.1655 | Val  Acc: 0.6912
 Site-SynthDigits               (1) | Val  Loss: 1.1891 | Val  Acc: 0.6885
 Site-MNIST_M                   (2) | Val  Loss: 1.6556 | Val  Acc: 0.4889
 Site-MNIST_M                   (2) | Val  Loss: 1.6309 | Val  Acc: 0.5432
 Site-SVHN                      (2) | Val  Loss: 1.7007 | Val  Acc: 0.3857
Average Valid Accuracy: 0.7825
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8235
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.9032
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8415
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8399
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.7812
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.7931
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.8381
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.8730
 Best site-SynthDigits              (1)  | Epoch:8 | Val Acc: 0.6757
 Best site-SynthDigits              (1)  | Epoch:8 | Val Acc: 0.6912
 Best site-SynthDigits              (1)  | Epoch:8 | Val Acc: 0.6885
 Best site-MNIST_M                  (2)  | Epoch:8 | Val Acc: 0.4889
 Best site-MNIST_M                  (2)  | Epoch:8 | Val Acc: 0.5432
 Best site-SVHN                     (2)  | Epoch:8 | Val Acc: 0.3857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 9 ============
cnt=[6, 6, 10, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (2) | Train Loss: 0.6895 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.6685 | Train Acc: 0.9167
 Site-MNIST                     (2) | Train Loss: 0.4701 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 0.4428 | Train Acc: 0.9474
 Site-MNIST                     (2) | Train Loss: 0.8546 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 0.5168 | Train Acc: 0.8492
 Site-MNIST                     (2) | Train Loss: 0.4754 | Train Acc: 0.8855
 Site-MNIST                     (2) | Train Loss: 0.5771 | Train Acc: 0.8557
 Site-MNIST                     (2) | Train Loss: 0.5505 | Train Acc: 0.8723
 Site-MNIST                     (2) | Train Loss: 0.5136 | Train Acc: 0.8868
 Site-USPS                      (0) | Train Loss: 0.4731 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.5856 | Train Acc: 0.8889
 Site-USPS                      (0) | Train Loss: 0.8736 | Train Acc: 0.8605
 Site-USPS                      (0) | Train Loss: 0.6103 | Train Acc: 0.8455
 Site-USPS                      (0) | Train Loss: 0.5515 | Train Acc: 0.8619
 Site-USPS                      (0) | Train Loss: 0.5581 | Train Acc: 0.8651
 Site-SynthDigits               (1) | Train Loss: 1.2857 | Train Acc: 0.6358
 Site-SynthDigits               (1) | Train Loss: 1.2069 | Train Acc: 0.6337
 Site-SynthDigits               (1) | Train Loss: 1.1188 | Train Acc: 0.6701
 Site-MNIST_M                   (1) | Train Loss: 1.5957 | Train Acc: 0.4641
 Site-MNIST_M                   (1) | Train Loss: 1.5000 | Train Acc: 0.5780
 Site-SVHN                      (1) | Train Loss: 1.7443 | Train Acc: 0.4043
Average Train Accuracy: 0.7872
 Site-MNIST                     (2) | Val  Loss: 0.1332 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1587 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.4734 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 0.6524 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.6020 | Val  Acc: 0.8235
 Site-MNIST                     (2) | Val  Loss: 0.5486 | Val  Acc: 0.9032
 Site-MNIST                     (2) | Val  Loss: 0.4813 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.4922 | Val  Acc: 0.8922
 Site-MNIST                     (2) | Val  Loss: 0.5647 | Val  Acc: 0.8689
 Site-MNIST                     (2) | Val  Loss: 0.5427 | Val  Acc: 0.8550
 Site-USPS                      (0) | Val  Loss: 0.4238 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.8371 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.7944 | Val  Acc: 0.7812
 Site-USPS                      (0) | Val  Loss: 0.7837 | Val  Acc: 0.7931
 Site-USPS                      (0) | Val  Loss: 0.6352 | Val  Acc: 0.8381
 Site-USPS                      (0) | Val  Loss: 0.5574 | Val  Acc: 0.8783
 Site-SynthDigits               (1) | Val  Loss: 1.2832 | Val  Acc: 0.7027
 Site-SynthDigits               (1) | Val  Loss: 1.0793 | Val  Acc: 0.6912
 Site-SynthDigits               (1) | Val  Loss: 1.1373 | Val  Acc: 0.7049
 Site-MNIST_M                   (1) | Val  Loss: 1.6269 | Val  Acc: 0.4889
 Site-MNIST_M                   (1) | Val  Loss: 1.5905 | Val  Acc: 0.5556
 Site-SVHN                      (1) | Val  Loss: 1.6666 | Val  Acc: 0.3714
Average Valid Accuracy: 0.7878
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8235
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.9032
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8922
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8689
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8550
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.7812
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.7931
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8381
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8783
 Best site-SynthDigits              (1)  | Epoch:9 | Val Acc: 0.7027
 Best site-SynthDigits              (1)  | Epoch:9 | Val Acc: 0.6912
 Best site-SynthDigits              (1)  | Epoch:9 | Val Acc: 0.7049
 Best site-MNIST_M                  (1)  | Epoch:9 | Val Acc: 0.4889
 Best site-MNIST_M                  (1)  | Epoch:9 | Val Acc: 0.5556
 Best site-SVHN                     (1)  | Epoch:9 | Val Acc: 0.3714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 10 ============
cnt=[3, 16, 3, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (1) | Train Loss: 0.6829 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.6253 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.4331 | Train Acc: 0.8571
 Site-MNIST                     (1) | Train Loss: 0.4066 | Train Acc: 0.9474
 Site-MNIST                     (1) | Train Loss: 0.5676 | Train Acc: 0.8714
 Site-MNIST                     (1) | Train Loss: 0.4769 | Train Acc: 0.8651
 Site-MNIST                     (1) | Train Loss: 0.4384 | Train Acc: 0.8987
 Site-MNIST                     (1) | Train Loss: 0.5259 | Train Acc: 0.8778
 Site-MNIST                     (1) | Train Loss: 0.5175 | Train Acc: 0.8777
 Site-MNIST                     (1) | Train Loss: 0.4798 | Train Acc: 0.8943
 Site-USPS                      (1) | Train Loss: 0.4707 | Train Acc: 0.8500
 Site-USPS                      (1) | Train Loss: 0.6477 | Train Acc: 0.9028
 Site-USPS                      (1) | Train Loss: 0.4743 | Train Acc: 0.8682
 Site-USPS                      (1) | Train Loss: 0.5905 | Train Acc: 0.8455
 Site-USPS                      (1) | Train Loss: 0.5273 | Train Acc: 0.8619
 Site-USPS                      (1) | Train Loss: 0.5360 | Train Acc: 0.8677
 Site-SynthDigits               (0) | Train Loss: 1.1652 | Train Acc: 0.6225
 Site-SynthDigits               (0) | Train Loss: 1.1616 | Train Acc: 0.6484
 Site-SynthDigits               (0) | Train Loss: 1.0792 | Train Acc: 0.6802
 Site-MNIST_M                   (2) | Train Loss: 1.5148 | Train Acc: 0.4696
 Site-MNIST_M                   (2) | Train Loss: 1.4677 | Train Acc: 0.5963
 Site-SVHN                      (2) | Train Loss: 1.6917 | Train Acc: 0.4574
Average Train Accuracy: 0.7959
 Site-MNIST                     (1) | Val  Loss: 0.1110 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1452 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4843 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.6547 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.5819 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.5212 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.4493 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.4613 | Val  Acc: 0.9118
 Site-MNIST                     (1) | Val  Loss: 0.5298 | Val  Acc: 0.8743
 Site-MNIST                     (1) | Val  Loss: 0.5110 | Val  Acc: 0.8701
 Site-USPS                      (1) | Val  Loss: 0.4114 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.8280 | Val  Acc: 0.7778
 Site-USPS                      (1) | Val  Loss: 0.7917 | Val  Acc: 0.7500
 Site-USPS                      (1) | Val  Loss: 0.7647 | Val  Acc: 0.7759
 Site-USPS                      (1) | Val  Loss: 0.6163 | Val  Acc: 0.8286
 Site-USPS                      (1) | Val  Loss: 0.5398 | Val  Acc: 0.8836
 Site-SynthDigits               (0) | Val  Loss: 1.2394 | Val  Acc: 0.7568
 Site-SynthDigits               (0) | Val  Loss: 1.0184 | Val  Acc: 0.7500
 Site-SynthDigits               (0) | Val  Loss: 1.0978 | Val  Acc: 0.7049
 Site-MNIST_M                   (2) | Val  Loss: 1.5545 | Val  Acc: 0.5111
 Site-MNIST_M                   (2) | Val  Loss: 1.5186 | Val  Acc: 0.5432
 Site-SVHN                      (2) | Val  Loss: 1.6320 | Val  Acc: 0.4286
Average Valid Accuracy: 0.8012
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.9118
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.8743
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.8701
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.7778
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.7500
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.7759
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.8286
 Best site-USPS                     (1)  | Epoch:10 | Val Acc: 0.8836
 Best site-SynthDigits              (0)  | Epoch:10 | Val Acc: 0.7568
 Best site-SynthDigits              (0)  | Epoch:10 | Val Acc: 0.7500
 Best site-SynthDigits              (0)  | Epoch:10 | Val Acc: 0.7049
 Best site-MNIST_M                  (2)  | Epoch:10 | Val Acc: 0.5111
 Best site-MNIST_M                  (2)  | Epoch:10 | Val Acc: 0.5432
 Best site-SVHN                     (2)  | Epoch:10 | Val Acc: 0.4286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 11 ============
cnt=[16, 3, 3, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (0) | Train Loss: 0.6514 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.6364 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4369 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.3886 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.4061 | Train Acc: 0.8286
 Site-MNIST                     (0) | Train Loss: 0.4806 | Train Acc: 0.8492
 Site-MNIST                     (0) | Train Loss: 0.4400 | Train Acc: 0.9075
 Site-MNIST                     (0) | Train Loss: 0.5288 | Train Acc: 0.8631
 Site-MNIST                     (0) | Train Loss: 0.5095 | Train Acc: 0.8696
 Site-MNIST                     (0) | Train Loss: 0.4705 | Train Acc: 0.8913
 Site-USPS                      (0) | Train Loss: 0.4327 | Train Acc: 0.9000
 Site-USPS                      (0) | Train Loss: 0.4223 | Train Acc: 0.9167
 Site-USPS                      (0) | Train Loss: 0.6247 | Train Acc: 0.8527
 Site-USPS                      (0) | Train Loss: 0.5601 | Train Acc: 0.8498
 Site-USPS                      (0) | Train Loss: 0.5111 | Train Acc: 0.8738
 Site-USPS                      (0) | Train Loss: 0.5165 | Train Acc: 0.8743
 Site-SynthDigits               (2) | Train Loss: 1.1360 | Train Acc: 0.6623
 Site-SynthDigits               (2) | Train Loss: 1.0952 | Train Acc: 0.6886
 Site-SynthDigits               (2) | Train Loss: 1.0184 | Train Acc: 0.7026
 Site-MNIST_M                   (1) | Train Loss: 1.4538 | Train Acc: 0.5249
 Site-MNIST_M                   (1) | Train Loss: 1.2364 | Train Acc: 0.6208
 Site-SVHN                      (1) | Train Loss: 1.6654 | Train Acc: 0.4468
Average Train Accuracy: 0.7985
 Site-MNIST                     (0) | Val  Loss: 0.0930 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1265 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4888 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.6528 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.5789 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.5135 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.4442 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.4557 | Val  Acc: 0.9020
 Site-MNIST                     (0) | Val  Loss: 0.5266 | Val  Acc: 0.8743
 Site-MNIST                     (0) | Val  Loss: 0.5022 | Val  Acc: 0.8822
 Site-USPS                      (0) | Val  Loss: 0.4022 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.7889 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.7643 | Val  Acc: 0.7500
 Site-USPS                      (0) | Val  Loss: 0.7522 | Val  Acc: 0.7759
 Site-USPS                      (0) | Val  Loss: 0.6034 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.5218 | Val  Acc: 0.8624
 Site-SynthDigits               (2) | Val  Loss: 1.1751 | Val  Acc: 0.7297
 Site-SynthDigits               (2) | Val  Loss: 0.9521 | Val  Acc: 0.7647
 Site-SynthDigits               (2) | Val  Loss: 1.0316 | Val  Acc: 0.7459
 Site-MNIST_M                   (1) | Val  Loss: 1.4806 | Val  Acc: 0.5333
 Site-MNIST_M                   (1) | Val  Loss: 1.4460 | Val  Acc: 0.5679
 Site-SVHN                      (1) | Val  Loss: 1.5756 | Val  Acc: 0.4143
Average Valid Accuracy: 0.8023
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.9020
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.8743
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.8822
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.7500
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.7759
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.8286
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.8624
 Best site-SynthDigits              (2)  | Epoch:11 | Val Acc: 0.7297
 Best site-SynthDigits              (2)  | Epoch:11 | Val Acc: 0.7647
 Best site-SynthDigits              (2)  | Epoch:11 | Val Acc: 0.7459
 Best site-MNIST_M                  (1)  | Epoch:11 | Val Acc: 0.5333
 Best site-MNIST_M                  (1)  | Epoch:11 | Val Acc: 0.5679
 Best site-SVHN                     (1)  | Epoch:11 | Val Acc: 0.4143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 12 ============
cnt=[6, 10, 6, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (1) | Train Loss: 0.6401 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.6015 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.3794 | Train Acc: 0.8571
 Site-MNIST                     (1) | Train Loss: 0.3507 | Train Acc: 0.9474
 Site-MNIST                     (1) | Train Loss: 0.4228 | Train Acc: 0.8714
 Site-MNIST                     (1) | Train Loss: 0.4310 | Train Acc: 0.8889
 Site-MNIST                     (1) | Train Loss: 0.3977 | Train Acc: 0.9075
 Site-MNIST                     (1) | Train Loss: 0.4909 | Train Acc: 0.8802
 Site-MNIST                     (1) | Train Loss: 0.4704 | Train Acc: 0.8927
 Site-MNIST                     (1) | Train Loss: 0.4346 | Train Acc: 0.9057
 Site-USPS                      (2) | Train Loss: 0.4277 | Train Acc: 0.8500
 Site-USPS                      (2) | Train Loss: 0.4102 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.4241 | Train Acc: 0.8605
 Site-USPS                      (2) | Train Loss: 0.5597 | Train Acc: 0.8283
 Site-USPS                      (2) | Train Loss: 0.4743 | Train Acc: 0.8595
 Site-USPS                      (2) | Train Loss: 0.4963 | Train Acc: 0.8743
 Site-SynthDigits               (0) | Train Loss: 1.1354 | Train Acc: 0.6623
 Site-SynthDigits               (0) | Train Loss: 1.0297 | Train Acc: 0.7070
 Site-SynthDigits               (0) | Train Loss: 0.9784 | Train Acc: 0.7108
 Site-MNIST_M                   (0) | Train Loss: 1.4096 | Train Acc: 0.5249
 Site-MNIST_M                   (0) | Train Loss: 1.2643 | Train Acc: 0.6239
 Site-SVHN                      (0) | Train Loss: 1.6307 | Train Acc: 0.4504
Average Train Accuracy: 0.8083
 Site-MNIST                     (1) | Val  Loss: 0.0838 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1072 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4674 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.6325 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.5419 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.4715 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.4038 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.4160 | Val  Acc: 0.9118
 Site-MNIST                     (1) | Val  Loss: 0.4844 | Val  Acc: 0.8798
 Site-MNIST                     (1) | Val  Loss: 0.4642 | Val  Acc: 0.8792
 Site-USPS                      (2) | Val  Loss: 0.3878 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.7912 | Val  Acc: 0.7778
 Site-USPS                      (2) | Val  Loss: 0.7636 | Val  Acc: 0.7188
 Site-USPS                      (2) | Val  Loss: 0.7318 | Val  Acc: 0.7586
 Site-USPS                      (2) | Val  Loss: 0.5845 | Val  Acc: 0.8190
 Site-USPS                      (2) | Val  Loss: 0.5040 | Val  Acc: 0.8677
 Site-SynthDigits               (0) | Val  Loss: 1.1158 | Val  Acc: 0.7297
 Site-SynthDigits               (0) | Val  Loss: 0.8990 | Val  Acc: 0.7647
 Site-SynthDigits               (0) | Val  Loss: 0.9838 | Val  Acc: 0.7295
 Site-MNIST_M                   (0) | Val  Loss: 1.4686 | Val  Acc: 0.5333
 Site-MNIST_M                   (0) | Val  Loss: 1.4220 | Val  Acc: 0.5679
 Site-SVHN                      (0) | Val  Loss: 1.4984 | Val  Acc: 0.4286
Average Valid Accuracy: 0.8012
============ Train epoch 13 ============
cnt=[6, 6, 10, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (2) | Train Loss: 0.6437 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.5667 | Train Acc: 0.9167
 Site-MNIST                     (2) | Train Loss: 0.3521 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 0.3292 | Train Acc: 0.9474
 Site-MNIST                     (2) | Train Loss: 0.6205 | Train Acc: 0.8714
 Site-MNIST                     (2) | Train Loss: 0.4054 | Train Acc: 0.9048
 Site-MNIST                     (2) | Train Loss: 0.3661 | Train Acc: 0.9075
 Site-MNIST                     (2) | Train Loss: 0.4577 | Train Acc: 0.8875
 Site-MNIST                     (2) | Train Loss: 0.4401 | Train Acc: 0.8995
 Site-MNIST                     (2) | Train Loss: 0.4077 | Train Acc: 0.9057
 Site-USPS                      (0) | Train Loss: 0.4173 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.3596 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.8007 | Train Acc: 0.8837
 Site-USPS                      (0) | Train Loss: 0.5341 | Train Acc: 0.8283
 Site-USPS                      (0) | Train Loss: 0.4753 | Train Acc: 0.8619
 Site-USPS                      (0) | Train Loss: 0.4846 | Train Acc: 0.8796
 Site-SynthDigits               (1) | Train Loss: 1.0096 | Train Acc: 0.6821
 Site-SynthDigits               (1) | Train Loss: 0.9682 | Train Acc: 0.7216
 Site-SynthDigits               (1) | Train Loss: 0.9267 | Train Acc: 0.7373
 Site-MNIST_M                   (1) | Train Loss: 1.3684 | Train Acc: 0.5470
 Site-MNIST_M                   (1) | Train Loss: 1.2407 | Train Acc: 0.6483
 Site-SVHN                      (1) | Train Loss: 1.5384 | Train Acc: 0.4823
Average Train Accuracy: 0.8174
 Site-MNIST                     (2) | Val  Loss: 0.0698 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1006 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.4575 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 0.6156 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.5134 | Val  Acc: 0.8824
 Site-MNIST                     (2) | Val  Loss: 0.4479 | Val  Acc: 0.9355
 Site-MNIST                     (2) | Val  Loss: 0.3811 | Val  Acc: 0.9643
 Site-MNIST                     (2) | Val  Loss: 0.3933 | Val  Acc: 0.9216
 Site-MNIST                     (2) | Val  Loss: 0.4597 | Val  Acc: 0.8852
 Site-MNIST                     (2) | Val  Loss: 0.4393 | Val  Acc: 0.8822
 Site-USPS                      (0) | Val  Loss: 0.3695 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.7676 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.7443 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 0.7093 | Val  Acc: 0.7586
 Site-USPS                      (0) | Val  Loss: 0.5695 | Val  Acc: 0.8190
 Site-USPS                      (0) | Val  Loss: 0.4910 | Val  Acc: 0.8730
 Site-SynthDigits               (1) | Val  Loss: 1.0473 | Val  Acc: 0.7297
 Site-SynthDigits               (1) | Val  Loss: 0.8168 | Val  Acc: 0.7794
 Site-SynthDigits               (1) | Val  Loss: 0.9414 | Val  Acc: 0.7377
 Site-MNIST_M                   (1) | Val  Loss: 1.4277 | Val  Acc: 0.5556
 Site-MNIST_M                   (1) | Val  Loss: 1.3664 | Val  Acc: 0.6173
 Site-SVHN                      (1) | Val  Loss: 1.4565 | Val  Acc: 0.4571
Average Valid Accuracy: 0.8079
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8824
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.9355
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.9643
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.9216
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8852
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8822
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.7188
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.7586
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.8190
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.8730
 Best site-SynthDigits              (1)  | Epoch:13 | Val Acc: 0.7297
 Best site-SynthDigits              (1)  | Epoch:13 | Val Acc: 0.7794
 Best site-SynthDigits              (1)  | Epoch:13 | Val Acc: 0.7377
 Best site-MNIST_M                  (1)  | Epoch:13 | Val Acc: 0.5556
 Best site-MNIST_M                  (1)  | Epoch:13 | Val Acc: 0.6173
 Best site-SVHN                     (1)  | Epoch:13 | Val Acc: 0.4571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 14 ============
cnt=[6, 6, 10, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (2) | Train Loss: 0.6363 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.5694 | Train Acc: 0.9167
 Site-MNIST                     (2) | Train Loss: 0.3452 | Train Acc: 0.9048
 Site-MNIST                     (2) | Train Loss: 0.3094 | Train Acc: 0.9211
 Site-MNIST                     (2) | Train Loss: 0.4674 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 0.3981 | Train Acc: 0.8889
 Site-MNIST                     (2) | Train Loss: 0.3479 | Train Acc: 0.9119
 Site-MNIST                     (2) | Train Loss: 0.4437 | Train Acc: 0.8875
 Site-MNIST                     (2) | Train Loss: 0.4313 | Train Acc: 0.8927
 Site-MNIST                     (2) | Train Loss: 0.3975 | Train Acc: 0.9072
 Site-USPS                      (0) | Train Loss: 0.3929 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.4917 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.4356 | Train Acc: 0.8915
 Site-USPS                      (0) | Train Loss: 0.5037 | Train Acc: 0.8412
 Site-USPS                      (0) | Train Loss: 0.4397 | Train Acc: 0.8810
 Site-USPS                      (0) | Train Loss: 0.4596 | Train Acc: 0.8889
 Site-SynthDigits               (1) | Train Loss: 0.9565 | Train Acc: 0.6954
 Site-SynthDigits               (1) | Train Loss: 0.9469 | Train Acc: 0.7216
 Site-SynthDigits               (1) | Train Loss: 0.8799 | Train Acc: 0.7434
 Site-MNIST_M                   (1) | Train Loss: 1.3459 | Train Acc: 0.5856
 Site-MNIST_M                   (1) | Train Loss: 1.2700 | Train Acc: 0.6483
 Site-SVHN                      (1) | Train Loss: 1.5296 | Train Acc: 0.5035
Average Train Accuracy: 0.8235
 Site-MNIST                     (2) | Val  Loss: 0.0605 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.0842 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.4484 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 0.6056 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.5056 | Val  Acc: 0.8824
 Site-MNIST                     (2) | Val  Loss: 0.4353 | Val  Acc: 0.9355
 Site-MNIST                     (2) | Val  Loss: 0.3721 | Val  Acc: 0.9643
 Site-MNIST                     (2) | Val  Loss: 0.3833 | Val  Acc: 0.9118
 Site-MNIST                     (2) | Val  Loss: 0.4491 | Val  Acc: 0.8798
 Site-MNIST                     (2) | Val  Loss: 0.4290 | Val  Acc: 0.8792
 Site-USPS                      (0) | Val  Loss: 0.3492 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.7391 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.7158 | Val  Acc: 0.7500
 Site-USPS                      (0) | Val  Loss: 0.6860 | Val  Acc: 0.7759
 Site-USPS                      (0) | Val  Loss: 0.5495 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.4682 | Val  Acc: 0.8730
 Site-SynthDigits               (1) | Val  Loss: 0.9992 | Val  Acc: 0.7568
 Site-SynthDigits               (1) | Val  Loss: 0.7742 | Val  Acc: 0.7647
 Site-SynthDigits               (1) | Val  Loss: 0.8946 | Val  Acc: 0.7295
 Site-MNIST_M                   (1) | Val  Loss: 1.3836 | Val  Acc: 0.6222
 Site-MNIST_M                   (1) | Val  Loss: 1.3199 | Val  Acc: 0.6420
 Site-SVHN                      (1) | Val  Loss: 1.3605 | Val  Acc: 0.4714
Average Valid Accuracy: 0.8147
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8824
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.9355
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.9643
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.9118
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8798
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8792
 Best site-USPS                     (0)  | Epoch:14 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:14 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:14 | Val Acc: 0.7500
 Best site-USPS                     (0)  | Epoch:14 | Val Acc: 0.7759
 Best site-USPS                     (0)  | Epoch:14 | Val Acc: 0.8286
 Best site-USPS                     (0)  | Epoch:14 | Val Acc: 0.8730
 Best site-SynthDigits              (1)  | Epoch:14 | Val Acc: 0.7568
 Best site-SynthDigits              (1)  | Epoch:14 | Val Acc: 0.7647
 Best site-SynthDigits              (1)  | Epoch:14 | Val Acc: 0.7295
 Best site-MNIST_M                  (1)  | Epoch:14 | Val Acc: 0.6222
 Best site-MNIST_M                  (1)  | Epoch:14 | Val Acc: 0.6420
 Best site-SVHN                     (1)  | Epoch:14 | Val Acc: 0.4714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 15 ============
cnt=[6, 6, 10, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (2) | Train Loss: 0.6270 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.5483 | Train Acc: 0.9167
 Site-MNIST                     (2) | Train Loss: 0.3203 | Train Acc: 0.9048
 Site-MNIST                     (2) | Train Loss: 0.2923 | Train Acc: 0.9474
 Site-MNIST                     (2) | Train Loss: 0.2733 | Train Acc: 0.8714
 Site-MNIST                     (2) | Train Loss: 0.3681 | Train Acc: 0.9048
 Site-MNIST                     (2) | Train Loss: 0.3368 | Train Acc: 0.9119
 Site-MNIST                     (2) | Train Loss: 0.4220 | Train Acc: 0.8900
 Site-MNIST                     (2) | Train Loss: 0.4130 | Train Acc: 0.9062
 Site-MNIST                     (2) | Train Loss: 0.3748 | Train Acc: 0.9117
 Site-USPS                      (1) | Train Loss: 0.4153 | Train Acc: 0.8500
 Site-USPS                      (1) | Train Loss: 0.5957 | Train Acc: 0.9444
 Site-USPS                      (1) | Train Loss: 0.3268 | Train Acc: 0.8837
 Site-USPS                      (1) | Train Loss: 0.5149 | Train Acc: 0.8369
 Site-USPS                      (1) | Train Loss: 0.4397 | Train Acc: 0.8738
 Site-USPS                      (1) | Train Loss: 0.4544 | Train Acc: 0.8823
 Site-SynthDigits               (0) | Train Loss: 0.9300 | Train Acc: 0.7020
 Site-SynthDigits               (0) | Train Loss: 0.9342 | Train Acc: 0.7326
 Site-SynthDigits               (0) | Train Loss: 0.8274 | Train Acc: 0.7821
 Site-MNIST_M                   (0) | Train Loss: 1.2689 | Train Acc: 0.6022
 Site-MNIST_M                   (0) | Train Loss: 1.1697 | Train Acc: 0.6453
 Site-SVHN                      (0) | Train Loss: 1.5113 | Train Acc: 0.5106
Average Train Accuracy: 0.8293
 Site-MNIST                     (2) | Val  Loss: 0.0518 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.0739 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.4802 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 0.6264 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.5065 | Val  Acc: 0.8824
 Site-MNIST                     (2) | Val  Loss: 0.4161 | Val  Acc: 0.9355
 Site-MNIST                     (2) | Val  Loss: 0.3502 | Val  Acc: 0.9643
 Site-MNIST                     (2) | Val  Loss: 0.3639 | Val  Acc: 0.9216
 Site-MNIST                     (2) | Val  Loss: 0.4295 | Val  Acc: 0.8907
 Site-MNIST                     (2) | Val  Loss: 0.4119 | Val  Acc: 0.8943
 Site-USPS                      (1) | Val  Loss: 0.3411 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.7453 | Val  Acc: 0.7778
 Site-USPS                      (1) | Val  Loss: 0.7261 | Val  Acc: 0.7500
 Site-USPS                      (1) | Val  Loss: 0.6829 | Val  Acc: 0.7586
 Site-USPS                      (1) | Val  Loss: 0.5457 | Val  Acc: 0.8095
 Site-USPS                      (1) | Val  Loss: 0.4637 | Val  Acc: 0.8730
 Site-SynthDigits               (0) | Val  Loss: 0.9584 | Val  Acc: 0.7568
 Site-SynthDigits               (0) | Val  Loss: 0.7464 | Val  Acc: 0.8088
 Site-SynthDigits               (0) | Val  Loss: 0.8477 | Val  Acc: 0.7705
 Site-MNIST_M                   (0) | Val  Loss: 1.3182 | Val  Acc: 0.6000
 Site-MNIST_M                   (0) | Val  Loss: 1.2592 | Val  Acc: 0.6790
 Site-SVHN                      (0) | Val  Loss: 1.2769 | Val  Acc: 0.5143
Average Valid Accuracy: 0.8211
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8824
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.9355
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.9643
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.9216
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8907
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8943
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.7778
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.7500
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.7586
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.8095
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.8730
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.7568
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.8088
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.7705
 Best site-MNIST_M                  (0)  | Epoch:15 | Val Acc: 0.6000
 Best site-MNIST_M                  (0)  | Epoch:15 | Val Acc: 0.6790
 Best site-SVHN                     (0)  | Epoch:15 | Val Acc: 0.5143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 16 ============
cnt=[16, 4, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (0) | Train Loss: 0.6057 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.5216 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.3059 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.2744 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.2787 | Train Acc: 0.8714
 Site-MNIST                     (0) | Train Loss: 0.3546 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.3207 | Train Acc: 0.9163
 Site-MNIST                     (0) | Train Loss: 0.4179 | Train Acc: 0.8973
 Site-MNIST                     (0) | Train Loss: 0.3941 | Train Acc: 0.9076
 Site-MNIST                     (0) | Train Loss: 0.3586 | Train Acc: 0.9117
 Site-USPS                      (0) | Train Loss: 0.3939 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.4318 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.5130 | Train Acc: 0.8915
 Site-USPS                      (0) | Train Loss: 0.5005 | Train Acc: 0.8455
 Site-USPS                      (0) | Train Loss: 0.4249 | Train Acc: 0.8976
 Site-USPS                      (0) | Train Loss: 0.4453 | Train Acc: 0.8849
 Site-SynthDigits               (1) | Train Loss: 0.9058 | Train Acc: 0.7285
 Site-SynthDigits               (1) | Train Loss: 0.8596 | Train Acc: 0.7473
 Site-SynthDigits               (1) | Train Loss: 0.7946 | Train Acc: 0.7963
 Site-MNIST_M                   (2) | Train Loss: 1.2045 | Train Acc: 0.6188
 Site-MNIST_M                   (2) | Train Loss: 1.0945 | Train Acc: 0.6728
 Site-SVHN                      (1) | Train Loss: 1.4354 | Train Acc: 0.5319
Average Train Accuracy: 0.8361
 Site-MNIST                     (0) | Val  Loss: 0.0508 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0707 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4771 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.6149 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4919 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.3981 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.3353 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.3492 | Val  Acc: 0.9216
 Site-MNIST                     (0) | Val  Loss: 0.4149 | Val  Acc: 0.9016
 Site-MNIST                     (0) | Val  Loss: 0.3975 | Val  Acc: 0.8912
 Site-USPS                      (0) | Val  Loss: 0.3284 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.7181 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.7034 | Val  Acc: 0.7500
 Site-USPS                      (0) | Val  Loss: 0.6619 | Val  Acc: 0.7759
 Site-USPS                      (0) | Val  Loss: 0.5366 | Val  Acc: 0.8095
 Site-USPS                      (0) | Val  Loss: 0.4533 | Val  Acc: 0.8783
 Site-SynthDigits               (1) | Val  Loss: 0.9086 | Val  Acc: 0.7838
 Site-SynthDigits               (1) | Val  Loss: 0.7116 | Val  Acc: 0.8235
 Site-SynthDigits               (1) | Val  Loss: 0.8205 | Val  Acc: 0.7705
 Site-MNIST_M                   (2) | Val  Loss: 1.2654 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 1.1918 | Val  Acc: 0.6790
 Site-SVHN                      (1) | Val  Loss: 1.2705 | Val  Acc: 0.5286
Average Valid Accuracy: 0.8263
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9216
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9016
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.8912
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.7500
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.7759
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.8095
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.8783
 Best site-SynthDigits              (1)  | Epoch:16 | Val Acc: 0.7838
 Best site-SynthDigits              (1)  | Epoch:16 | Val Acc: 0.8235
 Best site-SynthDigits              (1)  | Epoch:16 | Val Acc: 0.7705
 Best site-MNIST_M                  (2)  | Epoch:16 | Val Acc: 0.6444
 Best site-MNIST_M                  (2)  | Epoch:16 | Val Acc: 0.6790
 Best site-SVHN                     (1)  | Epoch:16 | Val Acc: 0.5286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 17 ============
cnt=[10, 9, 3, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (0) | Train Loss: 0.6118 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.5014 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.2994 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.2634 | Train Acc: 0.8947
 Site-MNIST                     (0) | Train Loss: 0.5976 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.3466 | Train Acc: 0.8968
 Site-MNIST                     (0) | Train Loss: 0.3093 | Train Acc: 0.9207
 Site-MNIST                     (0) | Train Loss: 0.4017 | Train Acc: 0.8924
 Site-MNIST                     (0) | Train Loss: 0.3841 | Train Acc: 0.9090
 Site-MNIST                     (0) | Train Loss: 0.3488 | Train Acc: 0.9109
 Site-USPS                      (1) | Train Loss: 0.3589 | Train Acc: 0.9000
 Site-USPS                      (1) | Train Loss: 0.3197 | Train Acc: 0.9444
 Site-USPS                      (1) | Train Loss: 0.3800 | Train Acc: 0.8992
 Site-USPS                      (1) | Train Loss: 0.4565 | Train Acc: 0.8498
 Site-USPS                      (1) | Train Loss: 0.3829 | Train Acc: 0.9071
 Site-USPS                      (1) | Train Loss: 0.4105 | Train Acc: 0.8955
 Site-SynthDigits               (1) | Train Loss: 0.8822 | Train Acc: 0.7351
 Site-SynthDigits               (1) | Train Loss: 0.7970 | Train Acc: 0.7619
 Site-SynthDigits               (1) | Train Loss: 0.7844 | Train Acc: 0.7821
 Site-MNIST_M                   (2) | Train Loss: 1.1773 | Train Acc: 0.6298
 Site-MNIST_M                   (2) | Train Loss: 1.1208 | Train Acc: 0.6728
 Site-SVHN                      (2) | Train Loss: 1.3602 | Train Acc: 0.5355
Average Train Accuracy: 0.8386
 Site-MNIST                     (0) | Val  Loss: 0.0382 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0602 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4458 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5803 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4674 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.3865 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.3267 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.3383 | Val  Acc: 0.9216
 Site-MNIST                     (0) | Val  Loss: 0.4032 | Val  Acc: 0.9016
 Site-MNIST                     (0) | Val  Loss: 0.3871 | Val  Acc: 0.8973
 Site-USPS                      (1) | Val  Loss: 0.2937 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.6841 | Val  Acc: 0.8333
 Site-USPS                      (1) | Val  Loss: 0.6595 | Val  Acc: 0.7812
 Site-USPS                      (1) | Val  Loss: 0.6320 | Val  Acc: 0.7759
 Site-USPS                      (1) | Val  Loss: 0.5089 | Val  Acc: 0.8190
 Site-USPS                      (1) | Val  Loss: 0.4239 | Val  Acc: 0.8836
 Site-SynthDigits               (1) | Val  Loss: 0.8837 | Val  Acc: 0.7838
 Site-SynthDigits               (1) | Val  Loss: 0.6827 | Val  Acc: 0.7941
 Site-SynthDigits               (1) | Val  Loss: 0.8002 | Val  Acc: 0.7705
 Site-MNIST_M                   (2) | Val  Loss: 1.2180 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 1.1434 | Val  Acc: 0.6790
 Site-SVHN                      (2) | Val  Loss: 1.2109 | Val  Acc: 0.5429
Average Valid Accuracy: 0.8313
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9216
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9016
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.8973
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.8333
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.7812
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.7759
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.8190
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.8836
 Best site-SynthDigits              (1)  | Epoch:17 | Val Acc: 0.7838
 Best site-SynthDigits              (1)  | Epoch:17 | Val Acc: 0.7941
 Best site-SynthDigits              (1)  | Epoch:17 | Val Acc: 0.7705
 Best site-MNIST_M                  (2)  | Epoch:17 | Val Acc: 0.6444
 Best site-MNIST_M                  (2)  | Epoch:17 | Val Acc: 0.6790
 Best site-SVHN                     (2)  | Epoch:17 | Val Acc: 0.5429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 18 ============
cnt=[6, 10, 6, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (1) | Train Loss: 0.5913 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4943 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.2706 | Train Acc: 0.9048
 Site-MNIST                     (1) | Train Loss: 0.2404 | Train Acc: 0.9474
 Site-MNIST                     (1) | Train Loss: 0.2958 | Train Acc: 0.8714
 Site-MNIST                     (1) | Train Loss: 0.3231 | Train Acc: 0.9206
 Site-MNIST                     (1) | Train Loss: 0.2971 | Train Acc: 0.9207
 Site-MNIST                     (1) | Train Loss: 0.3991 | Train Acc: 0.8998
 Site-MNIST                     (1) | Train Loss: 0.3643 | Train Acc: 0.9103
 Site-MNIST                     (1) | Train Loss: 0.3294 | Train Acc: 0.9170
 Site-USPS                      (2) | Train Loss: 0.3636 | Train Acc: 0.8500
 Site-USPS                      (2) | Train Loss: 0.3962 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.4009 | Train Acc: 0.8915
 Site-USPS                      (2) | Train Loss: 0.4686 | Train Acc: 0.8498
 Site-USPS                      (2) | Train Loss: 0.3963 | Train Acc: 0.8929
 Site-USPS                      (2) | Train Loss: 0.4165 | Train Acc: 0.8955
 Site-SynthDigits               (0) | Train Loss: 0.9076 | Train Acc: 0.7351
 Site-SynthDigits               (0) | Train Loss: 0.7645 | Train Acc: 0.7656
 Site-SynthDigits               (0) | Train Loss: 0.7421 | Train Acc: 0.8126
 Site-MNIST_M                   (0) | Train Loss: 1.1747 | Train Acc: 0.6464
 Site-MNIST_M                   (0) | Train Loss: 0.9967 | Train Acc: 0.6972
 Site-SVHN                      (0) | Train Loss: 1.3665 | Train Acc: 0.5567
Average Train Accuracy: 0.8445
 Site-MNIST                     (1) | Val  Loss: 0.0407 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0577 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4478 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5744 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.4531 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.3620 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.3065 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.3196 | Val  Acc: 0.9314
 Site-MNIST                     (1) | Val  Loss: 0.3867 | Val  Acc: 0.9071
 Site-MNIST                     (1) | Val  Loss: 0.3687 | Val  Acc: 0.9033
 Site-USPS                      (2) | Val  Loss: 0.2993 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.6930 | Val  Acc: 0.7778
 Site-USPS                      (2) | Val  Loss: 0.6762 | Val  Acc: 0.7500
 Site-USPS                      (2) | Val  Loss: 0.6355 | Val  Acc: 0.7931
 Site-USPS                      (2) | Val  Loss: 0.5128 | Val  Acc: 0.8286
 Site-USPS                      (2) | Val  Loss: 0.4278 | Val  Acc: 0.8783
 Site-SynthDigits               (0) | Val  Loss: 0.8298 | Val  Acc: 0.7838
 Site-SynthDigits               (0) | Val  Loss: 0.6470 | Val  Acc: 0.8235
 Site-SynthDigits               (0) | Val  Loss: 0.7491 | Val  Acc: 0.8033
 Site-MNIST_M                   (0) | Val  Loss: 1.2201 | Val  Acc: 0.6222
 Site-MNIST_M                   (0) | Val  Loss: 1.1217 | Val  Acc: 0.7160
 Site-SVHN                      (0) | Val  Loss: 1.1162 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8333
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9314
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9071
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9033
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.7778
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.7500
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.7931
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.8286
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.8783
 Best site-SynthDigits              (0)  | Epoch:18 | Val Acc: 0.7838
 Best site-SynthDigits              (0)  | Epoch:18 | Val Acc: 0.8235
 Best site-SynthDigits              (0)  | Epoch:18 | Val Acc: 0.8033
 Best site-MNIST_M                  (0)  | Epoch:18 | Val Acc: 0.6222
 Best site-MNIST_M                  (0)  | Epoch:18 | Val Acc: 0.7160
 Best site-SVHN                     (0)  | Epoch:18 | Val Acc: 0.5714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 19 ============
cnt=[10, 6, 6, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (0) | Train Loss: 0.6000 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4540 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.2497 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.2244 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.5484 | Train Acc: 0.9000
 Site-MNIST                     (0) | Train Loss: 0.2978 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.2737 | Train Acc: 0.9427
 Site-MNIST                     (0) | Train Loss: 0.3559 | Train Acc: 0.9095
 Site-MNIST                     (0) | Train Loss: 0.3428 | Train Acc: 0.9130
 Site-MNIST                     (0) | Train Loss: 0.3109 | Train Acc: 0.9260
 Site-USPS                      (1) | Train Loss: 0.3633 | Train Acc: 0.8750
 Site-USPS                      (1) | Train Loss: 0.3412 | Train Acc: 0.9444
 Site-USPS                      (1) | Train Loss: 0.3547 | Train Acc: 0.8915
 Site-USPS                      (1) | Train Loss: 0.4664 | Train Acc: 0.8369
 Site-USPS                      (1) | Train Loss: 0.3908 | Train Acc: 0.9119
 Site-USPS                      (1) | Train Loss: 0.4066 | Train Acc: 0.8929
 Site-SynthDigits               (2) | Train Loss: 0.7749 | Train Acc: 0.7550
 Site-SynthDigits               (2) | Train Loss: 0.7304 | Train Acc: 0.7875
 Site-SynthDigits               (2) | Train Loss: 0.7117 | Train Acc: 0.8248
 Site-MNIST_M                   (2) | Train Loss: 1.1220 | Train Acc: 0.6575
 Site-MNIST_M                   (2) | Train Loss: 1.0663 | Train Acc: 0.7064
 Site-SVHN                      (2) | Train Loss: 1.3146 | Train Acc: 0.5709
Average Train Accuracy: 0.8545
 Site-MNIST                     (0) | Val  Loss: 0.0343 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0519 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4541 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5754 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4373 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.3409 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2851 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.3010 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.3654 | Val  Acc: 0.9180
 Site-MNIST                     (0) | Val  Loss: 0.3513 | Val  Acc: 0.9215
 Site-USPS                      (1) | Val  Loss: 0.2829 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.6962 | Val  Acc: 0.7778
 Site-USPS                      (1) | Val  Loss: 0.6781 | Val  Acc: 0.7500
 Site-USPS                      (1) | Val  Loss: 0.6192 | Val  Acc: 0.7931
 Site-USPS                      (1) | Val  Loss: 0.5054 | Val  Acc: 0.8286
 Site-USPS                      (1) | Val  Loss: 0.4232 | Val  Acc: 0.8783
 Site-SynthDigits               (2) | Val  Loss: 0.8036 | Val  Acc: 0.7838
 Site-SynthDigits               (2) | Val  Loss: 0.5966 | Val  Acc: 0.8235
 Site-SynthDigits               (2) | Val  Loss: 0.7264 | Val  Acc: 0.7787
 Site-MNIST_M                   (2) | Val  Loss: 1.1822 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 1.0827 | Val  Acc: 0.7037
 Site-SVHN                      (2) | Val  Loss: 1.0545 | Val  Acc: 0.5857
Average Valid Accuracy: 0.8358
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9412
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9180
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9215
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.7778
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.7500
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.7931
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.8286
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.8783
 Best site-SynthDigits              (2)  | Epoch:19 | Val Acc: 0.7838
 Best site-SynthDigits              (2)  | Epoch:19 | Val Acc: 0.8235
 Best site-SynthDigits              (2)  | Epoch:19 | Val Acc: 0.7787
 Best site-MNIST_M                  (2)  | Epoch:19 | Val Acc: 0.6444
 Best site-MNIST_M                  (2)  | Epoch:19 | Val Acc: 0.7037
 Best site-SVHN                     (2)  | Epoch:19 | Val Acc: 0.5857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 20 ============
cnt=[10, 4, 8, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (0) | Train Loss: 0.6007 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4422 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.2391 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.2158 | Train Acc: 0.9474
 Site-MNIST                     (0) | Train Loss: 0.5299 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.2856 | Train Acc: 0.9365
 Site-MNIST                     (0) | Train Loss: 0.2651 | Train Acc: 0.9427
 Site-MNIST                     (0) | Train Loss: 0.3579 | Train Acc: 0.9071
 Site-MNIST                     (0) | Train Loss: 0.3413 | Train Acc: 0.9130
 Site-MNIST                     (0) | Train Loss: 0.2963 | Train Acc: 0.9268
 Site-USPS                      (2) | Train Loss: 0.3354 | Train Acc: 0.9000
 Site-USPS                      (2) | Train Loss: 0.6381 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.8422 | Train Acc: 0.8992
 Site-USPS                      (2) | Train Loss: 0.4357 | Train Acc: 0.8541
 Site-USPS                      (2) | Train Loss: 0.3418 | Train Acc: 0.9238
 Site-USPS                      (2) | Train Loss: 0.3709 | Train Acc: 0.9021
 Site-SynthDigits               (1) | Train Loss: 0.8415 | Train Acc: 0.7616
 Site-SynthDigits               (1) | Train Loss: 0.7463 | Train Acc: 0.7802
 Site-SynthDigits               (1) | Train Loss: 0.6986 | Train Acc: 0.8126
 Site-MNIST_M                   (2) | Train Loss: 1.1206 | Train Acc: 0.6354
 Site-MNIST_M                   (2) | Train Loss: 1.0199 | Train Acc: 0.7034
 Site-SVHN                      (1) | Train Loss: 1.2938 | Train Acc: 0.5993
Average Train Accuracy: 0.8594
 Site-MNIST                     (0) | Val  Loss: 0.0291 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0459 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4489 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5611 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4263 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.3307 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2786 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.2915 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.3537 | Val  Acc: 0.9180
 Site-MNIST                     (0) | Val  Loss: 0.3417 | Val  Acc: 0.9154
 Site-USPS                      (2) | Val  Loss: 0.2425 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.6486 | Val  Acc: 0.7778
 Site-USPS                      (2) | Val  Loss: 0.6285 | Val  Acc: 0.8125
 Site-USPS                      (2) | Val  Loss: 0.5882 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.4703 | Val  Acc: 0.8476
 Site-USPS                      (2) | Val  Loss: 0.3877 | Val  Acc: 0.8889
 Site-SynthDigits               (1) | Val  Loss: 0.7803 | Val  Acc: 0.7838
 Site-SynthDigits               (1) | Val  Loss: 0.5527 | Val  Acc: 0.8088
 Site-SynthDigits               (1) | Val  Loss: 0.6898 | Val  Acc: 0.8033
 Site-MNIST_M                   (2) | Val  Loss: 1.1674 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 1.0650 | Val  Acc: 0.7160
 Site-SVHN                      (1) | Val  Loss: 1.0156 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8435
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9412
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9180
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9154
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.7778
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.8125
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.8476
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.8889
 Best site-SynthDigits              (1)  | Epoch:20 | Val Acc: 0.7838
 Best site-SynthDigits              (1)  | Epoch:20 | Val Acc: 0.8088
 Best site-SynthDigits              (1)  | Epoch:20 | Val Acc: 0.8033
 Best site-MNIST_M                  (2)  | Epoch:20 | Val Acc: 0.6444
 Best site-MNIST_M                  (2)  | Epoch:20 | Val Acc: 0.7160
 Best site-SVHN                     (1)  | Epoch:20 | Val Acc: 0.6286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 21 ============
cnt=[3, 10, 9, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (1) | Train Loss: 0.5678 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4245 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.2166 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.2037 | Train Acc: 0.9474
 Site-MNIST                     (1) | Train Loss: 0.4412 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.2671 | Train Acc: 0.9444
 Site-MNIST                     (1) | Train Loss: 0.2599 | Train Acc: 0.9383
 Site-MNIST                     (1) | Train Loss: 0.3466 | Train Acc: 0.9144
 Site-MNIST                     (1) | Train Loss: 0.3228 | Train Acc: 0.9212
 Site-MNIST                     (1) | Train Loss: 0.2848 | Train Acc: 0.9298
 Site-USPS                      (2) | Train Loss: 0.3214 | Train Acc: 0.9000
 Site-USPS                      (2) | Train Loss: 0.4896 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.3941 | Train Acc: 0.9070
 Site-USPS                      (2) | Train Loss: 0.4295 | Train Acc: 0.8455
 Site-USPS                      (2) | Train Loss: 0.3329 | Train Acc: 0.9238
 Site-USPS                      (2) | Train Loss: 0.3562 | Train Acc: 0.9074
 Site-SynthDigits               (2) | Train Loss: 0.7647 | Train Acc: 0.7682
 Site-SynthDigits               (2) | Train Loss: 0.7596 | Train Acc: 0.7875
 Site-SynthDigits               (2) | Train Loss: 0.6834 | Train Acc: 0.8208
 Site-MNIST_M                   (0) | Train Loss: 1.0522 | Train Acc: 0.7017
 Site-MNIST_M                   (0) | Train Loss: 0.9591 | Train Acc: 0.7064
 Site-SVHN                      (0) | Train Loss: 1.2971 | Train Acc: 0.6170
Average Train Accuracy: 0.8655
 Site-MNIST                     (1) | Val  Loss: 0.0273 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0426 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4385 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5329 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.4068 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.3161 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2684 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2788 | Val  Acc: 0.9314
 Site-MNIST                     (1) | Val  Loss: 0.3421 | Val  Acc: 0.9126
 Site-MNIST                     (1) | Val  Loss: 0.3284 | Val  Acc: 0.9124
 Site-USPS                      (2) | Val  Loss: 0.2348 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.6307 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.6097 | Val  Acc: 0.8125
 Site-USPS                      (2) | Val  Loss: 0.5708 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.4577 | Val  Acc: 0.8476
 Site-USPS                      (2) | Val  Loss: 0.3739 | Val  Acc: 0.8889
 Site-SynthDigits               (2) | Val  Loss: 0.7644 | Val  Acc: 0.7838
 Site-SynthDigits               (2) | Val  Loss: 0.5474 | Val  Acc: 0.8382
 Site-SynthDigits               (2) | Val  Loss: 0.6868 | Val  Acc: 0.8033
 Site-MNIST_M                   (0) | Val  Loss: 1.1334 | Val  Acc: 0.6444
 Site-MNIST_M                   (0) | Val  Loss: 1.0149 | Val  Acc: 0.7407
 Site-SVHN                      (0) | Val  Loss: 1.0215 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8455
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9314
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9126
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9124
 Best site-USPS                     (2)  | Epoch:21 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:21 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:21 | Val Acc: 0.8125
 Best site-USPS                     (2)  | Epoch:21 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:21 | Val Acc: 0.8476
 Best site-USPS                     (2)  | Epoch:21 | Val Acc: 0.8889
 Best site-SynthDigits              (2)  | Epoch:21 | Val Acc: 0.7838
 Best site-SynthDigits              (2)  | Epoch:21 | Val Acc: 0.8382
 Best site-SynthDigits              (2)  | Epoch:21 | Val Acc: 0.8033
 Best site-MNIST_M                  (0)  | Epoch:21 | Val Acc: 0.6444
 Best site-MNIST_M                  (0)  | Epoch:21 | Val Acc: 0.7407
 Best site-SVHN                     (0)  | Epoch:21 | Val Acc: 0.6000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 22 ============
cnt=[10, 8, 4, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (0) | Train Loss: 0.5658 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4086 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.2084 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1875 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.3421 | Train Acc: 0.9000
 Site-MNIST                     (0) | Train Loss: 0.2578 | Train Acc: 0.9444
 Site-MNIST                     (0) | Train Loss: 0.2520 | Train Acc: 0.9471
 Site-MNIST                     (0) | Train Loss: 0.3193 | Train Acc: 0.9193
 Site-MNIST                     (0) | Train Loss: 0.3102 | Train Acc: 0.9226
 Site-MNIST                     (0) | Train Loss: 0.2746 | Train Acc: 0.9343
 Site-USPS                      (1) | Train Loss: 0.3296 | Train Acc: 0.9000
 Site-USPS                      (1) | Train Loss: 0.5663 | Train Acc: 0.9444
 Site-USPS                      (1) | Train Loss: 0.2488 | Train Acc: 0.9070
 Site-USPS                      (1) | Train Loss: 0.4090 | Train Acc: 0.8498
 Site-USPS                      (1) | Train Loss: 0.3404 | Train Acc: 0.9286
 Site-USPS                      (1) | Train Loss: 0.3581 | Train Acc: 0.9021
 Site-SynthDigits               (2) | Train Loss: 0.7760 | Train Acc: 0.7748
 Site-SynthDigits               (2) | Train Loss: 0.6909 | Train Acc: 0.8059
 Site-SynthDigits               (2) | Train Loss: 0.6491 | Train Acc: 0.8554
 Site-MNIST_M                   (1) | Train Loss: 1.0568 | Train Acc: 0.6906
 Site-MNIST_M                   (1) | Train Loss: 1.0046 | Train Acc: 0.7125
 Site-SVHN                      (2) | Train Loss: 1.2278 | Train Acc: 0.6418
Average Train Accuracy: 0.8708
 Site-MNIST                     (0) | Val  Loss: 0.0284 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0405 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4415 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5371 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4004 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2974 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2505 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.2651 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.3308 | Val  Acc: 0.9235
 Site-MNIST                     (0) | Val  Loss: 0.3183 | Val  Acc: 0.9245
 Site-USPS                      (1) | Val  Loss: 0.2240 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.6410 | Val  Acc: 0.7778
 Site-USPS                      (1) | Val  Loss: 0.6294 | Val  Acc: 0.7500
 Site-USPS                      (1) | Val  Loss: 0.5635 | Val  Acc: 0.7931
 Site-USPS                      (1) | Val  Loss: 0.4579 | Val  Acc: 0.8286
 Site-USPS                      (1) | Val  Loss: 0.3761 | Val  Acc: 0.8836
 Site-SynthDigits               (2) | Val  Loss: 0.7276 | Val  Acc: 0.8108
 Site-SynthDigits               (2) | Val  Loss: 0.5266 | Val  Acc: 0.8382
 Site-SynthDigits               (2) | Val  Loss: 0.6502 | Val  Acc: 0.8197
 Site-MNIST_M                   (1) | Val  Loss: 1.1510 | Val  Acc: 0.6444
 Site-MNIST_M                   (1) | Val  Loss: 1.0228 | Val  Acc: 0.7160
 Site-SVHN                      (2) | Val  Loss: 0.9212 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8453
============ Train epoch 23 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (1) | Train Loss: 0.5785 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4044 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1959 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1840 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.4118 | Train Acc: 0.9000
 Site-MNIST                     (1) | Train Loss: 0.2465 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.2490 | Train Acc: 0.9383
 Site-MNIST                     (1) | Train Loss: 0.3027 | Train Acc: 0.9218
 Site-MNIST                     (1) | Train Loss: 0.3043 | Train Acc: 0.9266
 Site-MNIST                     (1) | Train Loss: 0.2644 | Train Acc: 0.9374
 Site-USPS                      (2) | Train Loss: 0.2994 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.3187 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.2305 | Train Acc: 0.8992
 Site-USPS                      (2) | Train Loss: 0.3844 | Train Acc: 0.8670
 Site-USPS                      (2) | Train Loss: 0.3112 | Train Acc: 0.9357
 Site-USPS                      (2) | Train Loss: 0.3392 | Train Acc: 0.9034
 Site-SynthDigits               (0) | Train Loss: 0.6781 | Train Acc: 0.7815
 Site-SynthDigits               (0) | Train Loss: 0.6984 | Train Acc: 0.8205
 Site-SynthDigits               (0) | Train Loss: 0.6163 | Train Acc: 0.8473
 Site-MNIST_M                   (2) | Train Loss: 1.0448 | Train Acc: 0.6906
 Site-MNIST_M                   (2) | Train Loss: 1.0062 | Train Acc: 0.7034
 Site-SVHN                      (0) | Train Loss: 1.1882 | Train Acc: 0.5957
Average Train Accuracy: 0.8723
 Site-MNIST                     (1) | Val  Loss: 0.0222 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0390 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4370 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5287 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3855 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2861 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2409 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2561 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.3189 | Val  Acc: 0.9290
 Site-MNIST                     (1) | Val  Loss: 0.3077 | Val  Acc: 0.9275
 Site-USPS                      (2) | Val  Loss: 0.2051 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.6074 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.5985 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.5505 | Val  Acc: 0.7931
 Site-USPS                      (2) | Val  Loss: 0.4419 | Val  Acc: 0.8476
 Site-USPS                      (2) | Val  Loss: 0.3586 | Val  Acc: 0.8836
 Site-SynthDigits               (0) | Val  Loss: 0.6857 | Val  Acc: 0.8378
 Site-SynthDigits               (0) | Val  Loss: 0.4817 | Val  Acc: 0.8824
 Site-SynthDigits               (0) | Val  Loss: 0.6083 | Val  Acc: 0.8279
 Site-MNIST_M                   (2) | Val  Loss: 1.1294 | Val  Acc: 0.6667
 Site-MNIST_M                   (2) | Val  Loss: 1.0003 | Val  Acc: 0.7284
 Site-SVHN                      (0) | Val  Loss: 0.9118 | Val  Acc: 0.6429
Average Valid Accuracy: 0.8537
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9412
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9290
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9275
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.7812
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.7931
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.8476
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.8836
 Best site-SynthDigits              (0)  | Epoch:23 | Val Acc: 0.8378
 Best site-SynthDigits              (0)  | Epoch:23 | Val Acc: 0.8824
 Best site-SynthDigits              (0)  | Epoch:23 | Val Acc: 0.8279
 Best site-MNIST_M                  (2)  | Epoch:23 | Val Acc: 0.6667
 Best site-MNIST_M                  (2)  | Epoch:23 | Val Acc: 0.7284
 Best site-SVHN                     (0)  | Epoch:23 | Val Acc: 0.6429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 24 ============
cnt=[10, 4, 8, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (0) | Train Loss: 0.5740 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3824 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1987 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1804 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.2430 | Train Acc: 0.9000
 Site-MNIST                     (0) | Train Loss: 0.2447 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.2333 | Train Acc: 0.9471
 Site-MNIST                     (0) | Train Loss: 0.3015 | Train Acc: 0.9193
 Site-MNIST                     (0) | Train Loss: 0.3007 | Train Acc: 0.9280
 Site-MNIST                     (0) | Train Loss: 0.2590 | Train Acc: 0.9389
 Site-USPS                      (2) | Train Loss: 0.2888 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.3061 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.2155 | Train Acc: 0.9070
 Site-USPS                      (2) | Train Loss: 0.3914 | Train Acc: 0.8584
 Site-USPS                      (2) | Train Loss: 0.2977 | Train Acc: 0.9405
 Site-USPS                      (2) | Train Loss: 0.3194 | Train Acc: 0.9101
 Site-SynthDigits               (1) | Train Loss: 0.7385 | Train Acc: 0.7682
 Site-SynthDigits               (1) | Train Loss: 0.7018 | Train Acc: 0.8205
 Site-SynthDigits               (1) | Train Loss: 0.6029 | Train Acc: 0.8391
 Site-MNIST_M                   (2) | Train Loss: 1.0226 | Train Acc: 0.6961
 Site-MNIST_M                   (2) | Train Loss: 0.9914 | Train Acc: 0.7187
 Site-SVHN                      (1) | Train Loss: 1.2046 | Train Acc: 0.6064
Average Train Accuracy: 0.8737
 Site-MNIST                     (0) | Val  Loss: 0.0189 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0368 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4316 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5019 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3717 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2790 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2389 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.2521 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.3152 | Val  Acc: 0.9235
 Site-MNIST                     (0) | Val  Loss: 0.3034 | Val  Acc: 0.9245
 Site-USPS                      (2) | Val  Loss: 0.1990 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5729 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.5551 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.5329 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.4270 | Val  Acc: 0.8571
 Site-USPS                      (2) | Val  Loss: 0.3385 | Val  Acc: 0.8889
 Site-SynthDigits               (1) | Val  Loss: 0.6678 | Val  Acc: 0.8378
 Site-SynthDigits               (1) | Val  Loss: 0.4612 | Val  Acc: 0.8824
 Site-SynthDigits               (1) | Val  Loss: 0.5919 | Val  Acc: 0.8279
 Site-MNIST_M                   (2) | Val  Loss: 1.0876 | Val  Acc: 0.6667
 Site-MNIST_M                   (2) | Val  Loss: 0.9658 | Val  Acc: 0.7284
 Site-SVHN                      (1) | Val  Loss: 0.9017 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8542
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9412
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9235
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9245
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.7812
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.8571
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.8889
 Best site-SynthDigits              (1)  | Epoch:24 | Val Acc: 0.8378
 Best site-SynthDigits              (1)  | Epoch:24 | Val Acc: 0.8824
 Best site-SynthDigits              (1)  | Epoch:24 | Val Acc: 0.8279
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.6667
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.7284
 Best site-SVHN                     (1)  | Epoch:24 | Val Acc: 0.6286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 25 ============
cnt=[8, 10, 4, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (1) | Train Loss: 0.5680 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3673 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1913 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1696 | Train Acc: 0.9474
 Site-MNIST                     (1) | Train Loss: 0.4111 | Train Acc: 0.9000
 Site-MNIST                     (1) | Train Loss: 0.2331 | Train Acc: 0.9444
 Site-MNIST                     (1) | Train Loss: 0.2301 | Train Acc: 0.9427
 Site-MNIST                     (1) | Train Loss: 0.2883 | Train Acc: 0.9267
 Site-MNIST                     (1) | Train Loss: 0.2839 | Train Acc: 0.9280
 Site-MNIST                     (1) | Train Loss: 0.2487 | Train Acc: 0.9411
 Site-USPS                      (0) | Train Loss: 0.2978 | Train Acc: 0.9500
 Site-USPS                      (0) | Train Loss: 0.5150 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.7000 | Train Acc: 0.9070
 Site-USPS                      (0) | Train Loss: 0.3677 | Train Acc: 0.8627
 Site-USPS                      (0) | Train Loss: 0.2883 | Train Acc: 0.9405
 Site-USPS                      (0) | Train Loss: 0.3161 | Train Acc: 0.9048
 Site-SynthDigits               (2) | Train Loss: 0.6775 | Train Acc: 0.7881
 Site-SynthDigits               (2) | Train Loss: 0.6055 | Train Acc: 0.8388
 Site-SynthDigits               (2) | Train Loss: 0.5852 | Train Acc: 0.8615
 Site-MNIST_M                   (0) | Train Loss: 0.9993 | Train Acc: 0.6961
 Site-MNIST_M                   (0) | Train Loss: 0.9700 | Train Acc: 0.7095
 Site-SVHN                      (2) | Train Loss: 1.1427 | Train Acc: 0.6099
Average Train Accuracy: 0.8748
 Site-MNIST                     (1) | Val  Loss: 0.0175 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0345 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4506 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5115 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3694 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2690 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2267 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2431 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.3056 | Val  Acc: 0.9290
 Site-MNIST                     (1) | Val  Loss: 0.2968 | Val  Acc: 0.9335
 Site-USPS                      (0) | Val  Loss: 0.1809 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.5783 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.5688 | Val  Acc: 0.7812
 Site-USPS                      (0) | Val  Loss: 0.5203 | Val  Acc: 0.7759
 Site-USPS                      (0) | Val  Loss: 0.4198 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.3367 | Val  Acc: 0.8783
 Site-SynthDigits               (2) | Val  Loss: 0.6519 | Val  Acc: 0.8378
 Site-SynthDigits               (2) | Val  Loss: 0.4482 | Val  Acc: 0.8824
 Site-SynthDigits               (2) | Val  Loss: 0.5783 | Val  Acc: 0.8443
 Site-MNIST_M                   (0) | Val  Loss: 1.0830 | Val  Acc: 0.6444
 Site-MNIST_M                   (0) | Val  Loss: 0.9690 | Val  Acc: 0.7160
 Site-SVHN                      (2) | Val  Loss: 0.8500 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8494
============ Train epoch 26 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (1) | Train Loss: 0.5658 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3619 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1821 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1661 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3102 | Train Acc: 0.9000
 Site-MNIST                     (1) | Train Loss: 0.2248 | Train Acc: 0.9444
 Site-MNIST                     (1) | Train Loss: 0.2281 | Train Acc: 0.9471
 Site-MNIST                     (1) | Train Loss: 0.2767 | Train Acc: 0.9242
 Site-MNIST                     (1) | Train Loss: 0.2814 | Train Acc: 0.9280
 Site-MNIST                     (1) | Train Loss: 0.2419 | Train Acc: 0.9419
 Site-USPS                      (2) | Train Loss: 0.2916 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2261 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.2518 | Train Acc: 0.9070
 Site-USPS                      (2) | Train Loss: 0.3822 | Train Acc: 0.8627
 Site-USPS                      (2) | Train Loss: 0.2813 | Train Acc: 0.9429
 Site-USPS                      (2) | Train Loss: 0.3075 | Train Acc: 0.9101
 Site-SynthDigits               (0) | Train Loss: 0.6613 | Train Acc: 0.7815
 Site-SynthDigits               (0) | Train Loss: 0.6012 | Train Acc: 0.8535
 Site-SynthDigits               (0) | Train Loss: 0.5710 | Train Acc: 0.8758
 Site-MNIST_M                   (2) | Train Loss: 0.9815 | Train Acc: 0.6961
 Site-MNIST_M                   (2) | Train Loss: 0.8955 | Train Acc: 0.7248
 Site-SVHN                      (0) | Train Loss: 1.1397 | Train Acc: 0.6418
Average Train Accuracy: 0.8796
 Site-MNIST                     (1) | Val  Loss: 0.0176 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0342 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4419 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4871 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3542 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2547 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2174 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2335 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2978 | Val  Acc: 0.9290
 Site-MNIST                     (1) | Val  Loss: 0.2890 | Val  Acc: 0.9335
 Site-USPS                      (2) | Val  Loss: 0.1739 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5775 | Val  Acc: 0.7778
 Site-USPS                      (2) | Val  Loss: 0.5703 | Val  Acc: 0.7500
 Site-USPS                      (2) | Val  Loss: 0.5105 | Val  Acc: 0.7759
 Site-USPS                      (2) | Val  Loss: 0.4169 | Val  Acc: 0.8286
 Site-USPS                      (2) | Val  Loss: 0.3322 | Val  Acc: 0.8783
 Site-SynthDigits               (0) | Val  Loss: 0.6243 | Val  Acc: 0.8378
 Site-SynthDigits               (0) | Val  Loss: 0.4269 | Val  Acc: 0.8824
 Site-SynthDigits               (0) | Val  Loss: 0.5645 | Val  Acc: 0.8443
 Site-MNIST_M                   (2) | Val  Loss: 1.0790 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 0.9551 | Val  Acc: 0.7160
 Site-SVHN                      (0) | Val  Loss: 0.8262 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8493
============ Train epoch 27 ============
cnt=[10, 4, 8, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (0) | Train Loss: 0.5460 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3538 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1791 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1659 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.3265 | Train Acc: 0.8857
 Site-MNIST                     (0) | Train Loss: 0.2244 | Train Acc: 0.9444
 Site-MNIST                     (0) | Train Loss: 0.2134 | Train Acc: 0.9471
 Site-MNIST                     (0) | Train Loss: 0.2775 | Train Acc: 0.9267
 Site-MNIST                     (0) | Train Loss: 0.2811 | Train Acc: 0.9321
 Site-MNIST                     (0) | Train Loss: 0.2382 | Train Acc: 0.9449
 Site-USPS                      (2) | Train Loss: 0.2723 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2706 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.3253 | Train Acc: 0.9147
 Site-USPS                      (2) | Train Loss: 0.3606 | Train Acc: 0.8670
 Site-USPS                      (2) | Train Loss: 0.2749 | Train Acc: 0.9405
 Site-USPS                      (2) | Train Loss: 0.2968 | Train Acc: 0.9101
 Site-SynthDigits               (1) | Train Loss: 0.6416 | Train Acc: 0.7881
 Site-SynthDigits               (1) | Train Loss: 0.5880 | Train Acc: 0.8425
 Site-SynthDigits               (1) | Train Loss: 0.5497 | Train Acc: 0.8676
 Site-MNIST_M                   (2) | Train Loss: 0.9647 | Train Acc: 0.7017
 Site-MNIST_M                   (2) | Train Loss: 0.9632 | Train Acc: 0.7278
 Site-SVHN                      (1) | Train Loss: 1.1347 | Train Acc: 0.6312
Average Train Accuracy: 0.8786
 Site-MNIST                     (0) | Val  Loss: 0.0157 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4280 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4636 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3411 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2486 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2158 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.2295 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.2942 | Val  Acc: 0.9290
 Site-MNIST                     (0) | Val  Loss: 0.2837 | Val  Acc: 0.9305
 Site-USPS                      (2) | Val  Loss: 0.1607 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5523 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.5404 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.5013 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.4025 | Val  Acc: 0.8476
 Site-USPS                      (2) | Val  Loss: 0.3146 | Val  Acc: 0.8942
 Site-SynthDigits               (1) | Val  Loss: 0.5959 | Val  Acc: 0.8649
 Site-SynthDigits               (1) | Val  Loss: 0.4128 | Val  Acc: 0.8971
 Site-SynthDigits               (1) | Val  Loss: 0.5385 | Val  Acc: 0.8525
 Site-MNIST_M                   (2) | Val  Loss: 1.0408 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 0.9185 | Val  Acc: 0.7407
 Site-SVHN                      (1) | Val  Loss: 0.8272 | Val  Acc: 0.6714
Average Valid Accuracy: 0.8590
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9412
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9290
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9305
 Best site-USPS                     (2)  | Epoch:27 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:27 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:27 | Val Acc: 0.7812
 Best site-USPS                     (2)  | Epoch:27 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:27 | Val Acc: 0.8476
 Best site-USPS                     (2)  | Epoch:27 | Val Acc: 0.8942
 Best site-SynthDigits              (1)  | Epoch:27 | Val Acc: 0.8649
 Best site-SynthDigits              (1)  | Epoch:27 | Val Acc: 0.8971
 Best site-SynthDigits              (1)  | Epoch:27 | Val Acc: 0.8525
 Best site-MNIST_M                  (2)  | Epoch:27 | Val Acc: 0.6444
 Best site-MNIST_M                  (2)  | Epoch:27 | Val Acc: 0.7407
 Best site-SVHN                     (1)  | Epoch:27 | Val Acc: 0.6714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 28 ============
cnt=[3, 10, 9, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (1) | Train Loss: 0.5233 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3478 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1640 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1619 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3938 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.2132 | Train Acc: 0.9444
 Site-MNIST                     (1) | Train Loss: 0.2164 | Train Acc: 0.9515
 Site-MNIST                     (1) | Train Loss: 0.2854 | Train Acc: 0.9267
 Site-MNIST                     (1) | Train Loss: 0.2764 | Train Acc: 0.9321
 Site-MNIST                     (1) | Train Loss: 0.2321 | Train Acc: 0.9472
 Site-USPS                      (2) | Train Loss: 0.2816 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2178 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.1991 | Train Acc: 0.9302
 Site-USPS                      (2) | Train Loss: 0.3588 | Train Acc: 0.8712
 Site-USPS                      (2) | Train Loss: 0.2851 | Train Acc: 0.9357
 Site-USPS                      (2) | Train Loss: 0.2912 | Train Acc: 0.9114
 Site-SynthDigits               (2) | Train Loss: 0.6177 | Train Acc: 0.7815
 Site-SynthDigits               (2) | Train Loss: 0.6108 | Train Acc: 0.8425
 Site-SynthDigits               (2) | Train Loss: 0.5460 | Train Acc: 0.8676
 Site-MNIST_M                   (0) | Train Loss: 0.9358 | Train Acc: 0.7182
 Site-MNIST_M                   (0) | Train Loss: 0.8929 | Train Acc: 0.7431
 Site-SVHN                      (0) | Train Loss: 1.1148 | Train Acc: 0.6348
Average Train Accuracy: 0.8829
 Site-MNIST                     (1) | Val  Loss: 0.0137 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0340 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4514 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4647 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3406 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2459 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2136 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2251 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2881 | Val  Acc: 0.9180
 Site-MNIST                     (1) | Val  Loss: 0.2761 | Val  Acc: 0.9335
 Site-USPS                      (2) | Val  Loss: 0.1574 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5405 | Val  Acc: 0.8889
 Site-USPS                      (2) | Val  Loss: 0.5290 | Val  Acc: 0.8125
 Site-USPS                      (2) | Val  Loss: 0.5023 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.3950 | Val  Acc: 0.8476
 Site-USPS                      (2) | Val  Loss: 0.3034 | Val  Acc: 0.8942
 Site-SynthDigits               (2) | Val  Loss: 0.5948 | Val  Acc: 0.8649
 Site-SynthDigits               (2) | Val  Loss: 0.4105 | Val  Acc: 0.8971
 Site-SynthDigits               (2) | Val  Loss: 0.5372 | Val  Acc: 0.8443
 Site-MNIST_M                   (0) | Val  Loss: 0.9811 | Val  Acc: 0.6444
 Site-MNIST_M                   (0) | Val  Loss: 0.8742 | Val  Acc: 0.7407
 Site-SVHN                      (0) | Val  Loss: 0.8380 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8635
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9412
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9180
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9335
 Best site-USPS                     (2)  | Epoch:28 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:28 | Val Acc: 0.8889
 Best site-USPS                     (2)  | Epoch:28 | Val Acc: 0.8125
 Best site-USPS                     (2)  | Epoch:28 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:28 | Val Acc: 0.8476
 Best site-USPS                     (2)  | Epoch:28 | Val Acc: 0.8942
 Best site-SynthDigits              (2)  | Epoch:28 | Val Acc: 0.8649
 Best site-SynthDigits              (2)  | Epoch:28 | Val Acc: 0.8971
 Best site-SynthDigits              (2)  | Epoch:28 | Val Acc: 0.8443
 Best site-MNIST_M                  (0)  | Epoch:28 | Val Acc: 0.6444
 Best site-MNIST_M                  (0)  | Epoch:28 | Val Acc: 0.7407
 Best site-SVHN                     (0)  | Epoch:28 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 29 ============
cnt=[10, 4, 8, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (0) | Train Loss: 0.5347 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3341 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1529 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1515 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.2761 | Train Acc: 0.9000
 Site-MNIST                     (0) | Train Loss: 0.2011 | Train Acc: 0.9444
 Site-MNIST                     (0) | Train Loss: 0.1958 | Train Acc: 0.9559
 Site-MNIST                     (0) | Train Loss: 0.2617 | Train Acc: 0.9340
 Site-MNIST                     (0) | Train Loss: 0.2672 | Train Acc: 0.9334
 Site-MNIST                     (0) | Train Loss: 0.2203 | Train Acc: 0.9502
 Site-USPS                      (2) | Train Loss: 0.2793 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.3480 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.2422 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.3493 | Train Acc: 0.8670
 Site-USPS                      (2) | Train Loss: 0.2672 | Train Acc: 0.9405
 Site-USPS                      (2) | Train Loss: 0.2860 | Train Acc: 0.9140
 Site-SynthDigits               (1) | Train Loss: 0.6285 | Train Acc: 0.7881
 Site-SynthDigits               (1) | Train Loss: 0.5762 | Train Acc: 0.8571
 Site-SynthDigits               (1) | Train Loss: 0.5310 | Train Acc: 0.8758
 Site-MNIST_M                   (2) | Train Loss: 0.9274 | Train Acc: 0.7238
 Site-MNIST_M                   (2) | Train Loss: 0.9013 | Train Acc: 0.7248
 Site-SVHN                      (1) | Train Loss: 1.0872 | Train Acc: 0.6418
Average Train Accuracy: 0.8832
 Site-MNIST                     (0) | Val  Loss: 0.0136 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0324 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4332 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4476 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3204 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2318 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1997 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.2152 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.2774 | Val  Acc: 0.9290
 Site-MNIST                     (0) | Val  Loss: 0.2671 | Val  Acc: 0.9366
 Site-USPS                      (2) | Val  Loss: 0.1547 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5628 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.5468 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.4924 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.3963 | Val  Acc: 0.8571
 Site-USPS                      (2) | Val  Loss: 0.3081 | Val  Acc: 0.8889
 Site-SynthDigits               (1) | Val  Loss: 0.5770 | Val  Acc: 0.8649
 Site-SynthDigits               (1) | Val  Loss: 0.3915 | Val  Acc: 0.8971
 Site-SynthDigits               (1) | Val  Loss: 0.5282 | Val  Acc: 0.8443
 Site-MNIST_M                   (2) | Val  Loss: 1.0055 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 0.8928 | Val  Acc: 0.7284
 Site-SVHN                      (1) | Val  Loss: 0.7912 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8598
============ Train epoch 30 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (1) | Train Loss: 0.5269 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3198 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1567 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1512 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.2822 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1994 | Train Acc: 0.9444
 Site-MNIST                     (1) | Train Loss: 0.1977 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2677 | Train Acc: 0.9340
 Site-MNIST                     (1) | Train Loss: 0.2551 | Train Acc: 0.9348
 Site-MNIST                     (1) | Train Loss: 0.2197 | Train Acc: 0.9509
 Site-USPS                      (2) | Train Loss: 0.2777 | Train Acc: 0.9250
 Site-USPS                      (2) | Train Loss: 0.2360 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.5335 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.3466 | Train Acc: 0.8712
 Site-USPS                      (2) | Train Loss: 0.2634 | Train Acc: 0.9429
 Site-USPS                      (2) | Train Loss: 0.2780 | Train Acc: 0.9180
 Site-SynthDigits               (0) | Train Loss: 0.6299 | Train Acc: 0.7748
 Site-SynthDigits               (0) | Train Loss: 0.5696 | Train Acc: 0.8645
 Site-SynthDigits               (0) | Train Loss: 0.5149 | Train Acc: 0.8737
 Site-MNIST_M                   (2) | Train Loss: 0.9119 | Train Acc: 0.7182
 Site-MNIST_M                   (2) | Train Loss: 0.8556 | Train Acc: 0.7309
 Site-SVHN                      (0) | Train Loss: 1.1034 | Train Acc: 0.6525
Average Train Accuracy: 0.8847
 Site-MNIST                     (1) | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4678 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4708 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3302 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2288 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1942 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2119 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2745 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2651 | Val  Acc: 0.9366
 Site-USPS                      (2) | Val  Loss: 0.1395 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.5328 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.5223 | Val  Acc: 0.8125
 Site-USPS                      (2) | Val  Loss: 0.4806 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.3840 | Val  Acc: 0.8571
 Site-USPS                      (2) | Val  Loss: 0.2968 | Val  Acc: 0.8942
 Site-SynthDigits               (0) | Val  Loss: 0.5528 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.3754 | Val  Acc: 0.9412
 Site-SynthDigits               (0) | Val  Loss: 0.4998 | Val  Acc: 0.8607
 Site-MNIST_M                   (2) | Val  Loss: 0.9852 | Val  Acc: 0.6667
 Site-MNIST_M                   (2) | Val  Loss: 0.8798 | Val  Acc: 0.7531
 Site-SVHN                      (0) | Val  Loss: 0.7648 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8731
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9412
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9344
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9366
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.8125
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.8571
 Best site-USPS                     (2)  | Epoch:30 | Val Acc: 0.8942
 Best site-SynthDigits              (0)  | Epoch:30 | Val Acc: 0.8919
 Best site-SynthDigits              (0)  | Epoch:30 | Val Acc: 0.9412
 Best site-SynthDigits              (0)  | Epoch:30 | Val Acc: 0.8607
 Best site-MNIST_M                  (2)  | Epoch:30 | Val Acc: 0.6667
 Best site-MNIST_M                  (2)  | Epoch:30 | Val Acc: 0.7531
 Best site-SVHN                     (0)  | Epoch:30 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 31 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (1) | Train Loss: 0.5282 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3166 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1390 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1443 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.1768 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1896 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.2042 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2423 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.2459 | Train Acc: 0.9348
 Site-MNIST                     (1) | Train Loss: 0.2104 | Train Acc: 0.9509
 Site-USPS                      (2) | Train Loss: 0.2639 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2920 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.2241 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.3229 | Train Acc: 0.8798
 Site-USPS                      (2) | Train Loss: 0.2584 | Train Acc: 0.9452
 Site-USPS                      (2) | Train Loss: 0.2685 | Train Acc: 0.9193
 Site-SynthDigits               (0) | Train Loss: 0.6244 | Train Acc: 0.8079
 Site-SynthDigits               (0) | Train Loss: 0.5470 | Train Acc: 0.8681
 Site-SynthDigits               (0) | Train Loss: 0.4947 | Train Acc: 0.8778
 Site-MNIST_M                   (2) | Train Loss: 0.8987 | Train Acc: 0.7182
 Site-MNIST_M                   (2) | Train Loss: 0.8474 | Train Acc: 0.7431
 Site-SVHN                      (0) | Train Loss: 1.0274 | Train Acc: 0.6489
Average Train Accuracy: 0.8886
 Site-MNIST                     (1) | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0322 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4463 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4521 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3178 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2178 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1869 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2039 | Val  Acc: 0.9314
 Site-MNIST                     (1) | Val  Loss: 0.2685 | Val  Acc: 0.9290
 Site-MNIST                     (1) | Val  Loss: 0.2576 | Val  Acc: 0.9366
 Site-USPS                      (2) | Val  Loss: 0.1362 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.5264 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.5114 | Val  Acc: 0.8438
 Site-USPS                      (2) | Val  Loss: 0.4743 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.3785 | Val  Acc: 0.8667
 Site-USPS                      (2) | Val  Loss: 0.2896 | Val  Acc: 0.8995
 Site-SynthDigits               (0) | Val  Loss: 0.5423 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.3583 | Val  Acc: 0.9265
 Site-SynthDigits               (0) | Val  Loss: 0.4916 | Val  Acc: 0.8770
 Site-MNIST_M                   (2) | Val  Loss: 0.9917 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 0.8785 | Val  Acc: 0.7654
 Site-SVHN                      (0) | Val  Loss: 0.7539 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8747
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9314
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9290
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9366
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 0.8438
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 0.8667
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 0.8995
 Best site-SynthDigits              (0)  | Epoch:31 | Val Acc: 0.8919
 Best site-SynthDigits              (0)  | Epoch:31 | Val Acc: 0.9265
 Best site-SynthDigits              (0)  | Epoch:31 | Val Acc: 0.8770
 Best site-MNIST_M                  (2)  | Epoch:31 | Val Acc: 0.6444
 Best site-MNIST_M                  (2)  | Epoch:31 | Val Acc: 0.7654
 Best site-SVHN                     (0)  | Epoch:31 | Val Acc: 0.7286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 32 ============
cnt=[8, 10, 4, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (1) | Train Loss: 0.5170 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3065 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1469 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1427 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.2665 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1904 | Train Acc: 0.9444
 Site-MNIST                     (1) | Train Loss: 0.1896 | Train Acc: 0.9515
 Site-MNIST                     (1) | Train Loss: 0.2415 | Train Acc: 0.9364
 Site-MNIST                     (1) | Train Loss: 0.2433 | Train Acc: 0.9348
 Site-MNIST                     (1) | Train Loss: 0.2078 | Train Acc: 0.9532
 Site-USPS                      (0) | Train Loss: 0.2553 | Train Acc: 0.9500
 Site-USPS                      (0) | Train Loss: 0.2155 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.1744 | Train Acc: 0.9302
 Site-USPS                      (0) | Train Loss: 0.3205 | Train Acc: 0.8884
 Site-USPS                      (0) | Train Loss: 0.2401 | Train Acc: 0.9500
 Site-USPS                      (0) | Train Loss: 0.2651 | Train Acc: 0.9259
 Site-SynthDigits               (2) | Train Loss: 0.5706 | Train Acc: 0.8079
 Site-SynthDigits               (2) | Train Loss: 0.5764 | Train Acc: 0.8938
 Site-SynthDigits               (2) | Train Loss: 0.4848 | Train Acc: 0.8880
 Site-MNIST_M                   (0) | Train Loss: 0.9093 | Train Acc: 0.7238
 Site-MNIST_M                   (0) | Train Loss: 0.8279 | Train Acc: 0.7462
 Site-SVHN                      (2) | Train Loss: 1.0483 | Train Acc: 0.6525
Average Train Accuracy: 0.8908
 Site-MNIST                     (1) | Val  Loss: 0.0113 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0315 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4497 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4551 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3164 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2153 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1839 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2015 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2649 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2560 | Val  Acc: 0.9396
 Site-USPS                      (0) | Val  Loss: 0.1180 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.5079 | Val  Acc: 0.8333
 Site-USPS                      (0) | Val  Loss: 0.4965 | Val  Acc: 0.8438
 Site-USPS                      (0) | Val  Loss: 0.4589 | Val  Acc: 0.8103
 Site-USPS                      (0) | Val  Loss: 0.3680 | Val  Acc: 0.8571
 Site-USPS                      (0) | Val  Loss: 0.2838 | Val  Acc: 0.9153
 Site-SynthDigits               (2) | Val  Loss: 0.5330 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.3436 | Val  Acc: 0.9412
 Site-SynthDigits               (2) | Val  Loss: 0.4711 | Val  Acc: 0.9016
 Site-MNIST_M                   (0) | Val  Loss: 0.9812 | Val  Acc: 0.6444
 Site-MNIST_M                   (0) | Val  Loss: 0.8767 | Val  Acc: 0.7407
 Site-SVHN                      (2) | Val  Loss: 0.7234 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8759
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.9412
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.9344
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.9396
 Best site-USPS                     (0)  | Epoch:32 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:32 | Val Acc: 0.8333
 Best site-USPS                     (0)  | Epoch:32 | Val Acc: 0.8438
 Best site-USPS                     (0)  | Epoch:32 | Val Acc: 0.8103
 Best site-USPS                     (0)  | Epoch:32 | Val Acc: 0.8571
 Best site-USPS                     (0)  | Epoch:32 | Val Acc: 0.9153
 Best site-SynthDigits              (2)  | Epoch:32 | Val Acc: 0.8919
 Best site-SynthDigits              (2)  | Epoch:32 | Val Acc: 0.9412
 Best site-SynthDigits              (2)  | Epoch:32 | Val Acc: 0.9016
 Best site-MNIST_M                  (0)  | Epoch:32 | Val Acc: 0.6444
 Best site-MNIST_M                  (0)  | Epoch:32 | Val Acc: 0.7407
 Best site-SVHN                     (2)  | Epoch:32 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 33 ============
cnt=[8, 10, 4, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (1) | Train Loss: 0.5183 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3013 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1368 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1379 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.2622 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1856 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1889 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2394 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.2516 | Train Acc: 0.9361
 Site-MNIST                     (1) | Train Loss: 0.2027 | Train Acc: 0.9547
 Site-USPS                      (0) | Train Loss: 0.2487 | Train Acc: 0.9500
 Site-USPS                      (0) | Train Loss: 0.2745 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.1903 | Train Acc: 0.9225
 Site-USPS                      (0) | Train Loss: 0.3235 | Train Acc: 0.8884
 Site-USPS                      (0) | Train Loss: 0.2392 | Train Acc: 0.9476
 Site-USPS                      (0) | Train Loss: 0.2548 | Train Acc: 0.9286
 Site-SynthDigits               (2) | Train Loss: 0.5594 | Train Acc: 0.7881
 Site-SynthDigits               (2) | Train Loss: 0.5328 | Train Acc: 0.8901
 Site-SynthDigits               (2) | Train Loss: 0.4793 | Train Acc: 0.8839
 Site-MNIST_M                   (0) | Train Loss: 0.8789 | Train Acc: 0.7459
 Site-MNIST_M                   (0) | Train Loss: 0.8201 | Train Acc: 0.7615
 Site-SVHN                      (2) | Train Loss: 1.0390 | Train Acc: 0.6667
Average Train Accuracy: 0.8927
 Site-MNIST                     (1) | Val  Loss: 0.0110 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4355 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4493 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3081 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2108 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1792 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1958 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2608 | Val  Acc: 0.9399
 Site-MNIST                     (1) | Val  Loss: 0.2503 | Val  Acc: 0.9366
 Site-USPS                      (0) | Val  Loss: 0.1197 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.4983 | Val  Acc: 0.8333
 Site-USPS                      (0) | Val  Loss: 0.4847 | Val  Acc: 0.8438
 Site-USPS                      (0) | Val  Loss: 0.4522 | Val  Acc: 0.8276
 Site-USPS                      (0) | Val  Loss: 0.3614 | Val  Acc: 0.8857
 Site-USPS                      (0) | Val  Loss: 0.2740 | Val  Acc: 0.9259
 Site-SynthDigits               (2) | Val  Loss: 0.5131 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.3289 | Val  Acc: 0.9412
 Site-SynthDigits               (2) | Val  Loss: 0.4583 | Val  Acc: 0.8852
 Site-MNIST_M                   (0) | Val  Loss: 0.9691 | Val  Acc: 0.6667
 Site-MNIST_M                   (0) | Val  Loss: 0.8529 | Val  Acc: 0.7654
 Site-SVHN                      (2) | Val  Loss: 0.7377 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8793
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9412
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9399
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9366
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.8333
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.8438
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.8276
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.8857
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.9259
 Best site-SynthDigits              (2)  | Epoch:33 | Val Acc: 0.8919
 Best site-SynthDigits              (2)  | Epoch:33 | Val Acc: 0.9412
 Best site-SynthDigits              (2)  | Epoch:33 | Val Acc: 0.8852
 Best site-MNIST_M                  (0)  | Epoch:33 | Val Acc: 0.6667
 Best site-MNIST_M                  (0)  | Epoch:33 | Val Acc: 0.7654
 Best site-SVHN                     (2)  | Epoch:33 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 34 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (1) | Train Loss: 0.5109 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2904 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1289 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1355 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3041 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1773 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1759 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2352 | Train Acc: 0.9462
 Site-MNIST                     (1) | Train Loss: 0.2396 | Train Acc: 0.9361
 Site-MNIST                     (1) | Train Loss: 0.1949 | Train Acc: 0.9577
 Site-USPS                      (2) | Train Loss: 0.2630 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2764 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1867 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.3102 | Train Acc: 0.8970
 Site-USPS                      (2) | Train Loss: 0.2373 | Train Acc: 0.9476
 Site-USPS                      (2) | Train Loss: 0.2509 | Train Acc: 0.9259
 Site-SynthDigits               (0) | Train Loss: 0.5514 | Train Acc: 0.8278
 Site-SynthDigits               (0) | Train Loss: 0.5046 | Train Acc: 0.8901
 Site-SynthDigits               (0) | Train Loss: 0.4740 | Train Acc: 0.8900
 Site-MNIST_M                   (2) | Train Loss: 0.8658 | Train Acc: 0.7459
 Site-MNIST_M                   (2) | Train Loss: 0.8127 | Train Acc: 0.7492
 Site-SVHN                      (0) | Train Loss: 1.0237 | Train Acc: 0.6773
Average Train Accuracy: 0.8955
 Site-MNIST                     (1) | Val  Loss: 0.0105 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0319 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4637 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4610 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3115 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2063 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1712 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1901 | Val  Acc: 0.9510
 Site-MNIST                     (1) | Val  Loss: 0.2539 | Val  Acc: 0.9399
 Site-MNIST                     (1) | Val  Loss: 0.2457 | Val  Acc: 0.9426
 Site-USPS                      (2) | Val  Loss: 0.1068 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4934 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.4870 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.4425 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.3551 | Val  Acc: 0.8857
 Site-USPS                      (2) | Val  Loss: 0.2722 | Val  Acc: 0.9206
 Site-SynthDigits               (0) | Val  Loss: 0.4977 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.3176 | Val  Acc: 0.9412
 Site-SynthDigits               (0) | Val  Loss: 0.4555 | Val  Acc: 0.8852
 Site-MNIST_M                   (2) | Val  Loss: 0.9764 | Val  Acc: 0.6889
 Site-MNIST_M                   (2) | Val  Loss: 0.8527 | Val  Acc: 0.7654
 Site-SVHN                      (0) | Val  Loss: 0.7246 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8849
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9510
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9399
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9426
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.8750
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.8448
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.8857
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.9206
 Best site-SynthDigits              (0)  | Epoch:34 | Val Acc: 0.8919
 Best site-SynthDigits              (0)  | Epoch:34 | Val Acc: 0.9412
 Best site-SynthDigits              (0)  | Epoch:34 | Val Acc: 0.8852
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.6889
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.7654
 Best site-SVHN                     (0)  | Epoch:34 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 35 ============
cnt=[3, 10, 9, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (1) | Train Loss: 0.4846 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2886 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1274 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1377 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.1591 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1715 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1738 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2314 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.2380 | Train Acc: 0.9402
 Site-MNIST                     (1) | Train Loss: 0.1947 | Train Acc: 0.9570
 Site-USPS                      (2) | Train Loss: 0.2547 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2980 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1739 | Train Acc: 0.9380
 Site-USPS                      (2) | Train Loss: 0.3127 | Train Acc: 0.8970
 Site-USPS                      (2) | Train Loss: 0.2217 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2419 | Train Acc: 0.9378
 Site-SynthDigits               (2) | Train Loss: 0.6172 | Train Acc: 0.8344
 Site-SynthDigits               (2) | Train Loss: 0.5013 | Train Acc: 0.8828
 Site-SynthDigits               (2) | Train Loss: 0.4710 | Train Acc: 0.8778
 Site-MNIST_M                   (0) | Train Loss: 0.8097 | Train Acc: 0.7514
 Site-MNIST_M                   (0) | Train Loss: 0.8535 | Train Acc: 0.7737
 Site-SVHN                      (0) | Train Loss: 1.0185 | Train Acc: 0.6738
Average Train Accuracy: 0.8979
 Site-MNIST                     (1) | Val  Loss: 0.0091 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0319 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4942 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4708 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3203 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2063 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1707 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1877 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2523 | Val  Acc: 0.9290
 Site-MNIST                     (1) | Val  Loss: 0.2431 | Val  Acc: 0.9366
 Site-USPS                      (2) | Val  Loss: 0.0962 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4632 | Val  Acc: 0.8889
 Site-USPS                      (2) | Val  Loss: 0.4570 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.4320 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.3415 | Val  Acc: 0.8857
 Site-USPS                      (2) | Val  Loss: 0.2585 | Val  Acc: 0.9206
 Site-SynthDigits               (2) | Val  Loss: 0.5016 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.3241 | Val  Acc: 0.9412
 Site-SynthDigits               (2) | Val  Loss: 0.4498 | Val  Acc: 0.8934
 Site-MNIST_M                   (0) | Val  Loss: 0.9088 | Val  Acc: 0.7333
 Site-MNIST_M                   (0) | Val  Loss: 0.7955 | Val  Acc: 0.7778
 Site-SVHN                      (0) | Val  Loss: 0.7152 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8863
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9412
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9290
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9366
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.8889
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.8750
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.8857
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.9206
 Best site-SynthDigits              (2)  | Epoch:35 | Val Acc: 0.8919
 Best site-SynthDigits              (2)  | Epoch:35 | Val Acc: 0.9412
 Best site-SynthDigits              (2)  | Epoch:35 | Val Acc: 0.8934
 Best site-MNIST_M                  (0)  | Epoch:35 | Val Acc: 0.7333
 Best site-MNIST_M                  (0)  | Epoch:35 | Val Acc: 0.7778
 Best site-SVHN                     (0)  | Epoch:35 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 36 ============
cnt=[10, 4, 8, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (0) | Train Loss: 0.4927 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2923 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1158 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1342 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.1743 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.1642 | Train Acc: 0.9603
 Site-MNIST                     (0) | Train Loss: 0.1704 | Train Acc: 0.9559
 Site-MNIST                     (0) | Train Loss: 0.2236 | Train Acc: 0.9389
 Site-MNIST                     (0) | Train Loss: 0.2269 | Train Acc: 0.9375
 Site-MNIST                     (0) | Train Loss: 0.1878 | Train Acc: 0.9577
 Site-USPS                      (2) | Train Loss: 0.2464 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.3160 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1610 | Train Acc: 0.9302
 Site-USPS                      (2) | Train Loss: 0.3013 | Train Acc: 0.8927
 Site-USPS                      (2) | Train Loss: 0.2353 | Train Acc: 0.9476
 Site-USPS                      (2) | Train Loss: 0.2419 | Train Acc: 0.9365
 Site-SynthDigits               (1) | Train Loss: 0.5822 | Train Acc: 0.7947
 Site-SynthDigits               (1) | Train Loss: 0.4875 | Train Acc: 0.8938
 Site-SynthDigits               (1) | Train Loss: 0.4473 | Train Acc: 0.8880
 Site-MNIST_M                   (2) | Train Loss: 0.8409 | Train Acc: 0.7514
 Site-MNIST_M                   (2) | Train Loss: 0.7928 | Train Acc: 0.7706
 Site-SVHN                      (1) | Train Loss: 0.9804 | Train Acc: 0.7021
Average Train Accuracy: 0.8974
 Site-MNIST                     (0) | Val  Loss: 0.0092 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0325 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4672 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4631 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3109 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1981 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1661 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1825 | Val  Acc: 0.9314
 Site-MNIST                     (0) | Val  Loss: 0.2481 | Val  Acc: 0.9344
 Site-MNIST                     (0) | Val  Loss: 0.2367 | Val  Acc: 0.9335
 Site-USPS                      (2) | Val  Loss: 0.0944 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4507 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.4489 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.4243 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.3423 | Val  Acc: 0.8857
 Site-USPS                      (2) | Val  Loss: 0.2560 | Val  Acc: 0.9259
 Site-SynthDigits               (1) | Val  Loss: 0.4877 | Val  Acc: 0.9189
 Site-SynthDigits               (1) | Val  Loss: 0.3198 | Val  Acc: 0.9412
 Site-SynthDigits               (1) | Val  Loss: 0.4446 | Val  Acc: 0.8852
 Site-MNIST_M                   (2) | Val  Loss: 0.9327 | Val  Acc: 0.7333
 Site-MNIST_M                   (2) | Val  Loss: 0.8022 | Val  Acc: 0.7901
 Site-SVHN                      (1) | Val  Loss: 0.7028 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8880
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9314
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9344
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9335
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.8750
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.8448
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.8857
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.9259
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.9189
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.9412
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.8852
 Best site-MNIST_M                  (2)  | Epoch:36 | Val Acc: 0.7333
 Best site-MNIST_M                  (2)  | Epoch:36 | Val Acc: 0.7901
 Best site-SVHN                     (1)  | Epoch:36 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 37 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (1) | Train Loss: 0.4983 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2932 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1120 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1298 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.1935 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1627 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1838 | Train Acc: 0.9604
 Site-MNIST                     (1) | Train Loss: 0.2448 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.2212 | Train Acc: 0.9375
 Site-MNIST                     (1) | Train Loss: 0.1864 | Train Acc: 0.9600
 Site-USPS                      (2) | Train Loss: 0.2413 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.1678 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.2009 | Train Acc: 0.9302
 Site-USPS                      (2) | Train Loss: 0.3063 | Train Acc: 0.8755
 Site-USPS                      (2) | Train Loss: 0.2234 | Train Acc: 0.9476
 Site-USPS                      (2) | Train Loss: 0.2378 | Train Acc: 0.9378
 Site-SynthDigits               (0) | Train Loss: 0.5128 | Train Acc: 0.8013
 Site-SynthDigits               (0) | Train Loss: 0.4373 | Train Acc: 0.8901
 Site-SynthDigits               (0) | Train Loss: 0.4410 | Train Acc: 0.8961
 Site-MNIST_M                   (2) | Train Loss: 0.8373 | Train Acc: 0.7514
 Site-MNIST_M                   (2) | Train Loss: 0.7594 | Train Acc: 0.7737
 Site-SVHN                      (0) | Train Loss: 0.9877 | Train Acc: 0.6950
Average Train Accuracy: 0.8967
 Site-MNIST                     (1) | Val  Loss: 0.0086 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0279 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4622 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4574 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3066 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.1945 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1617 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1791 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2448 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2341 | Val  Acc: 0.9366
 Site-USPS                      (2) | Val  Loss: 0.0919 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4630 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.4552 | Val  Acc: 0.8438
 Site-USPS                      (2) | Val  Loss: 0.4210 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.3402 | Val  Acc: 0.8762
 Site-USPS                      (2) | Val  Loss: 0.2544 | Val  Acc: 0.9153
 Site-SynthDigits               (0) | Val  Loss: 0.4741 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.3098 | Val  Acc: 0.9559
 Site-SynthDigits               (0) | Val  Loss: 0.4292 | Val  Acc: 0.8852
 Site-MNIST_M                   (2) | Val  Loss: 0.9501 | Val  Acc: 0.7111
 Site-MNIST_M                   (2) | Val  Loss: 0.8138 | Val  Acc: 0.7654
 Site-SVHN                      (0) | Val  Loss: 0.6776 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8848
============ Train epoch 38 ============
cnt=[10, 8, 4, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (0) | Train Loss: 0.5006 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2873 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1086 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1275 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.2107 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1560 | Train Acc: 0.9603
 Site-MNIST                     (0) | Train Loss: 0.1649 | Train Acc: 0.9559
 Site-MNIST                     (0) | Train Loss: 0.2233 | Train Acc: 0.9364
 Site-MNIST                     (0) | Train Loss: 0.2284 | Train Acc: 0.9375
 Site-MNIST                     (0) | Train Loss: 0.1804 | Train Acc: 0.9615
 Site-USPS                      (1) | Train Loss: 0.2492 | Train Acc: 0.9750
 Site-USPS                      (1) | Train Loss: 0.2419 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.1951 | Train Acc: 0.9225
 Site-USPS                      (1) | Train Loss: 0.2872 | Train Acc: 0.9056
 Site-USPS                      (1) | Train Loss: 0.2217 | Train Acc: 0.9500
 Site-USPS                      (1) | Train Loss: 0.2320 | Train Acc: 0.9392
 Site-SynthDigits               (2) | Train Loss: 0.5293 | Train Acc: 0.8013
 Site-SynthDigits               (2) | Train Loss: 0.4359 | Train Acc: 0.8974
 Site-SynthDigits               (2) | Train Loss: 0.4295 | Train Acc: 0.9084
 Site-MNIST_M                   (1) | Train Loss: 0.8329 | Train Acc: 0.7403
 Site-MNIST_M                   (1) | Train Loss: 0.7721 | Train Acc: 0.7584
 Site-SVHN                      (2) | Train Loss: 0.9712 | Train Acc: 0.6950
Average Train Accuracy: 0.8984
 Site-MNIST                     (0) | Val  Loss: 0.0083 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0280 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4562 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4652 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3058 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1905 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1559 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1744 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.2410 | Val  Acc: 0.9290
 Site-MNIST                     (0) | Val  Loss: 0.2308 | Val  Acc: 0.9366
 Site-USPS                      (1) | Val  Loss: 0.0855 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.4577 | Val  Acc: 0.8333
 Site-USPS                      (1) | Val  Loss: 0.4507 | Val  Acc: 0.8438
 Site-USPS                      (1) | Val  Loss: 0.4113 | Val  Acc: 0.8621
 Site-USPS                      (1) | Val  Loss: 0.3325 | Val  Acc: 0.8857
 Site-USPS                      (1) | Val  Loss: 0.2541 | Val  Acc: 0.9206
 Site-SynthDigits               (2) | Val  Loss: 0.4642 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.2927 | Val  Acc: 0.9559
 Site-SynthDigits               (2) | Val  Loss: 0.4183 | Val  Acc: 0.9098
 Site-MNIST_M                   (1) | Val  Loss: 0.9569 | Val  Acc: 0.6889
 Site-MNIST_M                   (1) | Val  Loss: 0.8203 | Val  Acc: 0.7778
 Site-SVHN                      (2) | Val  Loss: 0.6663 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8873
============ Train epoch 39 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (1) | Train Loss: 0.4887 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2835 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1036 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1259 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.1747 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1518 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1776 | Train Acc: 0.9604
 Site-MNIST                     (1) | Train Loss: 0.2347 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2179 | Train Acc: 0.9375
 Site-MNIST                     (1) | Train Loss: 0.1789 | Train Acc: 0.9638
 Site-USPS                      (2) | Train Loss: 0.2522 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2786 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1965 | Train Acc: 0.9302
 Site-USPS                      (2) | Train Loss: 0.2846 | Train Acc: 0.9056
 Site-USPS                      (2) | Train Loss: 0.2118 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2274 | Train Acc: 0.9405
 Site-SynthDigits               (0) | Train Loss: 0.5524 | Train Acc: 0.8212
 Site-SynthDigits               (0) | Train Loss: 0.4627 | Train Acc: 0.8974
 Site-SynthDigits               (0) | Train Loss: 0.4214 | Train Acc: 0.9043
 Site-MNIST_M                   (2) | Train Loss: 0.8229 | Train Acc: 0.7403
 Site-MNIST_M                   (2) | Train Loss: 0.8511 | Train Acc: 0.7645
 Site-SVHN                      (0) | Train Loss: 0.9374 | Train Acc: 0.7057
Average Train Accuracy: 0.8998
 Site-MNIST                     (1) | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0274 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4762 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4751 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3125 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.1895 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1530 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1713 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2384 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2281 | Val  Acc: 0.9426
 Site-USPS                      (2) | Val  Loss: 0.0791 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4496 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.4430 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.4044 | Val  Acc: 0.8621
 Site-USPS                      (2) | Val  Loss: 0.3254 | Val  Acc: 0.8857
 Site-USPS                      (2) | Val  Loss: 0.2471 | Val  Acc: 0.9206
 Site-SynthDigits               (0) | Val  Loss: 0.4590 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.2898 | Val  Acc: 0.9412
 Site-SynthDigits               (0) | Val  Loss: 0.4089 | Val  Acc: 0.9098
 Site-MNIST_M                   (2) | Val  Loss: 0.9341 | Val  Acc: 0.6667
 Site-MNIST_M                   (2) | Val  Loss: 0.8067 | Val  Acc: 0.7901
 Site-SVHN                      (0) | Val  Loss: 0.6462 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8881
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9412
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9344
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9426
 Best site-USPS                     (2)  | Epoch:39 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:39 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:39 | Val Acc: 0.8750
 Best site-USPS                     (2)  | Epoch:39 | Val Acc: 0.8621
 Best site-USPS                     (2)  | Epoch:39 | Val Acc: 0.8857
 Best site-USPS                     (2)  | Epoch:39 | Val Acc: 0.9206
 Best site-SynthDigits              (0)  | Epoch:39 | Val Acc: 0.9189
 Best site-SynthDigits              (0)  | Epoch:39 | Val Acc: 0.9412
 Best site-SynthDigits              (0)  | Epoch:39 | Val Acc: 0.9098
 Best site-MNIST_M                  (2)  | Epoch:39 | Val Acc: 0.6667
 Best site-MNIST_M                  (2)  | Epoch:39 | Val Acc: 0.7901
 Best site-SVHN                     (0)  | Epoch:39 | Val Acc: 0.7571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 40 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (1) | Train Loss: 0.4926 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2773 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1061 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1230 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3238 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1563 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1716 | Train Acc: 0.9604
 Site-MNIST                     (1) | Train Loss: 0.2153 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2120 | Train Acc: 0.9361
 Site-MNIST                     (1) | Train Loss: 0.1772 | Train Acc: 0.9615
 Site-USPS                      (2) | Train Loss: 0.2457 | Train Acc: 0.9750
 Site-USPS                      (2) | Train Loss: 0.2618 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.2470 | Train Acc: 0.9380
 Site-USPS                      (2) | Train Loss: 0.2854 | Train Acc: 0.8970
 Site-USPS                      (2) | Train Loss: 0.2093 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2197 | Train Acc: 0.9405
 Site-SynthDigits               (0) | Train Loss: 0.5225 | Train Acc: 0.8411
 Site-SynthDigits               (0) | Train Loss: 0.4666 | Train Acc: 0.8974
 Site-SynthDigits               (0) | Train Loss: 0.4188 | Train Acc: 0.9002
 Site-MNIST_M                   (2) | Train Loss: 0.7990 | Train Acc: 0.7624
 Site-MNIST_M                   (2) | Train Loss: 0.8646 | Train Acc: 0.7676
 Site-SVHN                      (0) | Train Loss: 0.9626 | Train Acc: 0.6986
Average Train Accuracy: 0.9023
 Site-MNIST                     (1) | Val  Loss: 0.0078 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0286 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4669 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4473 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3001 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.1833 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1520 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1690 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2362 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2263 | Val  Acc: 0.9426
 Site-USPS                      (2) | Val  Loss: 0.0711 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4223 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.4187 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.3926 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.3202 | Val  Acc: 0.8952
 Site-USPS                      (2) | Val  Loss: 0.2395 | Val  Acc: 0.9206
 Site-SynthDigits               (0) | Val  Loss: 0.4553 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.2840 | Val  Acc: 0.9412
 Site-SynthDigits               (0) | Val  Loss: 0.4026 | Val  Acc: 0.9180
 Site-MNIST_M                   (2) | Val  Loss: 0.9109 | Val  Acc: 0.6889
 Site-MNIST_M                   (2) | Val  Loss: 0.7865 | Val  Acc: 0.7778
 Site-SVHN                      (0) | Val  Loss: 0.6436 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8874
============ Train epoch 41 ============
cnt=[4, 10, 8, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (1) | Train Loss: 0.4934 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2743 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1044 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1196 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3204 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1543 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1667 | Train Acc: 0.9604
 Site-MNIST                     (1) | Train Loss: 0.2171 | Train Acc: 0.9487
 Site-MNIST                     (1) | Train Loss: 0.2143 | Train Acc: 0.9375
 Site-MNIST                     (1) | Train Loss: 0.1767 | Train Acc: 0.9592
 Site-USPS                      (2) | Train Loss: 0.2192 | Train Acc: 0.9750
 Site-USPS                      (2) | Train Loss: 0.1917 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1474 | Train Acc: 0.9457
 Site-USPS                      (2) | Train Loss: 0.2749 | Train Acc: 0.9056
 Site-USPS                      (2) | Train Loss: 0.2021 | Train Acc: 0.9476
 Site-USPS                      (2) | Train Loss: 0.2168 | Train Acc: 0.9418
 Site-SynthDigits               (0) | Train Loss: 0.4638 | Train Acc: 0.8543
 Site-SynthDigits               (0) | Train Loss: 0.4776 | Train Acc: 0.9084
 Site-SynthDigits               (0) | Train Loss: 0.4067 | Train Acc: 0.9022
 Site-MNIST_M                   (2) | Train Loss: 0.8033 | Train Acc: 0.7735
 Site-MNIST_M                   (2) | Train Loss: 0.8681 | Train Acc: 0.7859
 Site-SVHN                      (0) | Train Loss: 0.9268 | Train Acc: 0.6986
Average Train Accuracy: 0.9057
 Site-MNIST                     (1) | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0312 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4623 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4569 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3034 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.1808 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1498 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1660 | Val  Acc: 0.9510
 Site-MNIST                     (1) | Val  Loss: 0.2350 | Val  Acc: 0.9290
 Site-MNIST                     (1) | Val  Loss: 0.2238 | Val  Acc: 0.9396
 Site-USPS                      (2) | Val  Loss: 0.0704 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.3963 | Val  Acc: 0.8889
 Site-USPS                      (2) | Val  Loss: 0.3983 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.3866 | Val  Acc: 0.8276
 Site-USPS                      (2) | Val  Loss: 0.3170 | Val  Acc: 0.8952
 Site-USPS                      (2) | Val  Loss: 0.2327 | Val  Acc: 0.9259
 Site-SynthDigits               (0) | Val  Loss: 0.4476 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.2747 | Val  Acc: 0.9412
 Site-SynthDigits               (0) | Val  Loss: 0.3916 | Val  Acc: 0.9262
 Site-MNIST_M                   (2) | Val  Loss: 0.9106 | Val  Acc: 0.7556
 Site-MNIST_M                   (2) | Val  Loss: 0.7828 | Val  Acc: 0.8025
 Site-SVHN                      (0) | Val  Loss: 0.6443 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8933
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9510
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9290
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9396
 Best site-USPS                     (2)  | Epoch:41 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:41 | Val Acc: 0.8889
 Best site-USPS                     (2)  | Epoch:41 | Val Acc: 0.8750
 Best site-USPS                     (2)  | Epoch:41 | Val Acc: 0.8276
 Best site-USPS                     (2)  | Epoch:41 | Val Acc: 0.8952
 Best site-USPS                     (2)  | Epoch:41 | Val Acc: 0.9259
 Best site-SynthDigits              (0)  | Epoch:41 | Val Acc: 0.8919
 Best site-SynthDigits              (0)  | Epoch:41 | Val Acc: 0.9412
 Best site-SynthDigits              (0)  | Epoch:41 | Val Acc: 0.9262
 Best site-MNIST_M                  (2)  | Epoch:41 | Val Acc: 0.7556
 Best site-MNIST_M                  (2)  | Epoch:41 | Val Acc: 0.8025
 Best site-SVHN                     (0)  | Epoch:41 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 42 ============
cnt=[3, 10, 9, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (1) | Train Loss: 0.4790 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2686 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1100 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1305 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.4335 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1552 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1611 | Train Acc: 0.9648
 Site-MNIST                     (1) | Train Loss: 0.2307 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2094 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.1751 | Train Acc: 0.9592
 Site-USPS                      (2) | Train Loss: 0.2220 | Train Acc: 0.9750
 Site-USPS                      (2) | Train Loss: 0.4459 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1392 | Train Acc: 0.9380
 Site-USPS                      (2) | Train Loss: 0.2619 | Train Acc: 0.9013
 Site-USPS                      (2) | Train Loss: 0.1959 | Train Acc: 0.9524
 Site-USPS                      (2) | Train Loss: 0.2141 | Train Acc: 0.9392
 Site-SynthDigits               (2) | Train Loss: 0.4890 | Train Acc: 0.8477
 Site-SynthDigits               (2) | Train Loss: 0.4556 | Train Acc: 0.9048
 Site-SynthDigits               (2) | Train Loss: 0.4217 | Train Acc: 0.8961
 Site-MNIST_M                   (0) | Train Loss: 0.7484 | Train Acc: 0.7735
 Site-MNIST_M                   (0) | Train Loss: 0.6948 | Train Acc: 0.8043
 Site-SVHN                      (0) | Train Loss: 0.9142 | Train Acc: 0.6986
Average Train Accuracy: 0.9060
 Site-MNIST                     (1) | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0308 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4976 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4690 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3136 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.1832 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1499 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1654 | Val  Acc: 0.9608
 Site-MNIST                     (1) | Val  Loss: 0.2333 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2236 | Val  Acc: 0.9426
 Site-USPS                      (2) | Val  Loss: 0.0628 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.3833 | Val  Acc: 0.8889
 Site-USPS                      (2) | Val  Loss: 0.3853 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.3818 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.3118 | Val  Acc: 0.8857
 Site-USPS                      (2) | Val  Loss: 0.2302 | Val  Acc: 0.9206
 Site-SynthDigits               (2) | Val  Loss: 0.4640 | Val  Acc: 0.8649
 Site-SynthDigits               (2) | Val  Loss: 0.2742 | Val  Acc: 0.9265
 Site-SynthDigits               (2) | Val  Loss: 0.3988 | Val  Acc: 0.9180
 Site-MNIST_M                   (0) | Val  Loss: 0.8519 | Val  Acc: 0.7778
 Site-MNIST_M                   (0) | Val  Loss: 0.7322 | Val  Acc: 0.8025
 Site-SVHN                      (0) | Val  Loss: 0.6454 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8930
============ Train epoch 43 ============
cnt=[10, 4, 8, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (0) | Train Loss: 0.4877 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2688 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.0980 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1277 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.2737 | Train Acc: 0.9429
 Site-MNIST                     (0) | Train Loss: 0.1458 | Train Acc: 0.9603
 Site-MNIST                     (0) | Train Loss: 0.1486 | Train Acc: 0.9692
 Site-MNIST                     (0) | Train Loss: 0.2308 | Train Acc: 0.9389
 Site-MNIST                     (0) | Train Loss: 0.2044 | Train Acc: 0.9375
 Site-MNIST                     (0) | Train Loss: 0.1690 | Train Acc: 0.9615
 Site-USPS                      (2) | Train Loss: 0.2221 | Train Acc: 0.9750
 Site-USPS                      (2) | Train Loss: 0.2344 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.2548 | Train Acc: 0.9457
 Site-USPS                      (2) | Train Loss: 0.2585 | Train Acc: 0.9099
 Site-USPS                      (2) | Train Loss: 0.1985 | Train Acc: 0.9452
 Site-USPS                      (2) | Train Loss: 0.2097 | Train Acc: 0.9444
 Site-SynthDigits               (1) | Train Loss: 0.5276 | Train Acc: 0.8609
 Site-SynthDigits               (1) | Train Loss: 0.4292 | Train Acc: 0.9011
 Site-SynthDigits               (1) | Train Loss: 0.3941 | Train Acc: 0.9165
 Site-MNIST_M                   (2) | Train Loss: 0.7702 | Train Acc: 0.7956
 Site-MNIST_M                   (2) | Train Loss: 0.7261 | Train Acc: 0.8043
 Site-SVHN                      (1) | Train Loss: 0.9139 | Train Acc: 0.7199
Average Train Accuracy: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.0056 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0313 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4994 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4787 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3155 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1789 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1442 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1614 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.2289 | Val  Acc: 0.9344
 Site-MNIST                     (0) | Val  Loss: 0.2193 | Val  Acc: 0.9396
 Site-USPS                      (2) | Val  Loss: 0.0596 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.3788 | Val  Acc: 0.8889
 Site-USPS                      (2) | Val  Loss: 0.3880 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.3770 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.3068 | Val  Acc: 0.9048
 Site-USPS                      (2) | Val  Loss: 0.2268 | Val  Acc: 0.9365
 Site-SynthDigits               (1) | Val  Loss: 0.4431 | Val  Acc: 0.9189
 Site-SynthDigits               (1) | Val  Loss: 0.2676 | Val  Acc: 0.9412
 Site-SynthDigits               (1) | Val  Loss: 0.3873 | Val  Acc: 0.9098
 Site-MNIST_M                   (2) | Val  Loss: 0.8563 | Val  Acc: 0.7556
 Site-MNIST_M                   (2) | Val  Loss: 0.7336 | Val  Acc: 0.8025
 Site-SVHN                      (1) | Val  Loss: 0.6303 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8972
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.9412
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.9344
 Best site-MNIST                    (0)  | Epoch:43 | Val Acc: 0.9396
 Best site-USPS                     (2)  | Epoch:43 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:43 | Val Acc: 0.8889
 Best site-USPS                     (2)  | Epoch:43 | Val Acc: 0.8750
 Best site-USPS                     (2)  | Epoch:43 | Val Acc: 0.8448
 Best site-USPS                     (2)  | Epoch:43 | Val Acc: 0.9048
 Best site-USPS                     (2)  | Epoch:43 | Val Acc: 0.9365
 Best site-SynthDigits              (1)  | Epoch:43 | Val Acc: 0.9189
 Best site-SynthDigits              (1)  | Epoch:43 | Val Acc: 0.9412
 Best site-SynthDigits              (1)  | Epoch:43 | Val Acc: 0.9098
 Best site-MNIST_M                  (2)  | Epoch:43 | Val Acc: 0.7556
 Best site-MNIST_M                  (2)  | Epoch:43 | Val Acc: 0.8025
 Best site-SVHN                     (1)  | Epoch:43 | Val Acc: 0.7857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 44 ============
cnt=[10, 8, 4, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (0) | Train Loss: 0.4931 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2661 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.0949 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1211 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.1363 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.1436 | Train Acc: 0.9603
 Site-MNIST                     (0) | Train Loss: 0.1539 | Train Acc: 0.9648
 Site-MNIST                     (0) | Train Loss: 0.2029 | Train Acc: 0.9438
 Site-MNIST                     (0) | Train Loss: 0.2098 | Train Acc: 0.9375
 Site-MNIST                     (0) | Train Loss: 0.1656 | Train Acc: 0.9623
 Site-USPS                      (1) | Train Loss: 0.2159 | Train Acc: 0.9750
 Site-USPS                      (1) | Train Loss: 0.2253 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.1398 | Train Acc: 0.9457
 Site-USPS                      (1) | Train Loss: 0.2605 | Train Acc: 0.9099
 Site-USPS                      (1) | Train Loss: 0.2037 | Train Acc: 0.9500
 Site-USPS                      (1) | Train Loss: 0.2058 | Train Acc: 0.9444
 Site-SynthDigits               (2) | Train Loss: 0.5107 | Train Acc: 0.8344
 Site-SynthDigits               (2) | Train Loss: 0.4068 | Train Acc: 0.9158
 Site-SynthDigits               (2) | Train Loss: 0.3835 | Train Acc: 0.9145
 Site-MNIST_M                   (1) | Train Loss: 0.7428 | Train Acc: 0.7735
 Site-MNIST_M                   (1) | Train Loss: 0.7895 | Train Acc: 0.8043
 Site-SVHN                      (2) | Train Loss: 0.8751 | Train Acc: 0.7376
Average Train Accuracy: 0.9095
 Site-MNIST                     (0) | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0301 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4744 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4734 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3065 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1751 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1412 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1582 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.2266 | Val  Acc: 0.9344
 Site-MNIST                     (0) | Val  Loss: 0.2157 | Val  Acc: 0.9396
 Site-USPS                      (1) | Val  Loss: 0.0617 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3902 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.3963 | Val  Acc: 0.8750
 Site-USPS                      (1) | Val  Loss: 0.3733 | Val  Acc: 0.8621
 Site-USPS                      (1) | Val  Loss: 0.3019 | Val  Acc: 0.8952
 Site-USPS                      (1) | Val  Loss: 0.2225 | Val  Acc: 0.9312
 Site-SynthDigits               (2) | Val  Loss: 0.4321 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.2579 | Val  Acc: 0.9412
 Site-SynthDigits               (2) | Val  Loss: 0.3797 | Val  Acc: 0.9098
 Site-MNIST_M                   (1) | Val  Loss: 0.8650 | Val  Acc: 0.7556
 Site-MNIST_M                   (1) | Val  Loss: 0.7383 | Val  Acc: 0.8148
 Site-SVHN                      (2) | Val  Loss: 0.6212 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8966
============ Train epoch 45 ============
cnt=[10, 8, 4, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (0) | Train Loss: 0.4857 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2539 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.0996 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1196 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.1512 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1460 | Train Acc: 0.9683
 Site-MNIST                     (0) | Train Loss: 0.1480 | Train Acc: 0.9648
 Site-MNIST                     (0) | Train Loss: 0.2073 | Train Acc: 0.9487
 Site-MNIST                     (0) | Train Loss: 0.2030 | Train Acc: 0.9375
 Site-MNIST                     (0) | Train Loss: 0.1644 | Train Acc: 0.9615
 Site-USPS                      (1) | Train Loss: 0.2179 | Train Acc: 0.9750
 Site-USPS                      (1) | Train Loss: 0.2087 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.1735 | Train Acc: 0.9457
 Site-USPS                      (1) | Train Loss: 0.2544 | Train Acc: 0.9185
 Site-USPS                      (1) | Train Loss: 0.1878 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.2017 | Train Acc: 0.9444
 Site-SynthDigits               (2) | Train Loss: 0.5141 | Train Acc: 0.8675
 Site-SynthDigits               (2) | Train Loss: 0.4043 | Train Acc: 0.9011
 Site-SynthDigits               (2) | Train Loss: 0.3779 | Train Acc: 0.9145
 Site-MNIST_M                   (1) | Train Loss: 0.7368 | Train Acc: 0.7735
 Site-MNIST_M                   (1) | Train Loss: 0.6536 | Train Acc: 0.7982
 Site-SVHN                      (2) | Train Loss: 0.8546 | Train Acc: 0.7340
Average Train Accuracy: 0.9103
 Site-MNIST                     (0) | Val  Loss: 0.0054 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0284 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4832 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4882 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3107 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1779 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1395 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1571 | Val  Acc: 0.9510
 Site-MNIST                     (0) | Val  Loss: 0.2252 | Val  Acc: 0.9399
 Site-MNIST                     (0) | Val  Loss: 0.2159 | Val  Acc: 0.9456
 Site-USPS                      (1) | Val  Loss: 0.0555 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3871 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.3917 | Val  Acc: 0.8750
 Site-USPS                      (1) | Val  Loss: 0.3676 | Val  Acc: 0.8793
 Site-USPS                      (1) | Val  Loss: 0.2950 | Val  Acc: 0.8952
 Site-USPS                      (1) | Val  Loss: 0.2180 | Val  Acc: 0.9312
 Site-SynthDigits               (2) | Val  Loss: 0.4257 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.2538 | Val  Acc: 0.9412
 Site-SynthDigits               (2) | Val  Loss: 0.3677 | Val  Acc: 0.9180
 Site-MNIST_M                   (1) | Val  Loss: 0.8435 | Val  Acc: 0.7778
 Site-MNIST_M                   (1) | Val  Loss: 0.7259 | Val  Acc: 0.8025
 Site-SVHN                      (2) | Val  Loss: 0.6136 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8998
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.9510
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.9399
 Best site-MNIST                    (0)  | Epoch:45 | Val Acc: 0.9456
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 0.8889
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 0.8750
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 0.8793
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 0.8952
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 0.9312
 Best site-SynthDigits              (2)  | Epoch:45 | Val Acc: 0.9189
 Best site-SynthDigits              (2)  | Epoch:45 | Val Acc: 0.9412
 Best site-SynthDigits              (2)  | Epoch:45 | Val Acc: 0.9180
 Best site-MNIST_M                  (1)  | Epoch:45 | Val Acc: 0.7778
 Best site-MNIST_M                  (1)  | Epoch:45 | Val Acc: 0.8025
 Best site-SVHN                     (2)  | Epoch:45 | Val Acc: 0.7714
 Test site-MNIST                     (0)| Epoch:45 | Test Acc: 0.9420
 Test site-USPS                      (1)| Epoch:45 | Test Acc: 0.9473
 Test site-SynthDigits               (2)| Epoch:45 | Test Acc: 0.8836
 Test site-MNIST_M                   (1)| Epoch:45 | Test Acc: 0.7149
 Test site-SVHN                      (2)| Epoch:45 | Test Acc: 0.6286
MNIST: 0.9420, USPS: 0.9473, SynthDigits: 0.8836, MNIST_M: 0.7149, SVHN: 0.6286, 
Average Test Accuracy(group): 0.8233, Average Test Accuracy(individual): 0.9006,
domain std=0.1287, cluster std=0.0500, individual std=0.0890, 
Average Test Accuracy: 0.8233
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 46 ============
cnt=[10, 8, 4, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-MNIST                     (0) | Train Loss: 0.4830 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2514 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.0967 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1233 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.2579 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.1421 | Train Acc: 0.9603
 Site-MNIST                     (0) | Train Loss: 0.1436 | Train Acc: 0.9692
 Site-MNIST                     (0) | Train Loss: 0.2059 | Train Acc: 0.9438
 Site-MNIST                     (0) | Train Loss: 0.1987 | Train Acc: 0.9361
 Site-MNIST                     (0) | Train Loss: 0.1620 | Train Acc: 0.9623
 Site-USPS                      (1) | Train Loss: 0.2237 | Train Acc: 0.9750
 Site-USPS                      (1) | Train Loss: 0.2645 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.1447 | Train Acc: 0.9457
 Site-USPS                      (1) | Train Loss: 0.2504 | Train Acc: 0.9142
 Site-USPS                      (1) | Train Loss: 0.1915 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.1968 | Train Acc: 0.9524
 Site-SynthDigits               (2) | Train Loss: 0.4694 | Train Acc: 0.8411
 Site-SynthDigits               (2) | Train Loss: 0.3817 | Train Acc: 0.9158
 Site-SynthDigits               (2) | Train Loss: 0.3665 | Train Acc: 0.9185
 Site-MNIST_M                   (1) | Train Loss: 0.7355 | Train Acc: 0.7901
 Site-MNIST_M                   (1) | Train Loss: 0.7840 | Train Acc: 0.8043
 Site-SVHN                      (2) | Train Loss: 0.8424 | Train Acc: 0.7447
Average Train Accuracy: 0.9119
 Site-MNIST                     (0) | Val  Loss: 0.0048 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0280 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4980 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4906 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3122 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1757 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1370 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1548 | Val  Acc: 0.9510
 Site-MNIST                     (0) | Val  Loss: 0.2230 | Val  Acc: 0.9344
 Site-MNIST                     (0) | Val  Loss: 0.2129 | Val  Acc: 0.9456
 Site-USPS                      (1) | Val  Loss: 0.0532 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3797 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.3788 | Val  Acc: 0.9062
 Site-USPS                      (1) | Val  Loss: 0.3641 | Val  Acc: 0.8966
 Site-USPS                      (1) | Val  Loss: 0.2886 | Val  Acc: 0.8857
 Site-USPS                      (1) | Val  Loss: 0.2107 | Val  Acc: 0.9418
 Site-SynthDigits               (2) | Val  Loss: 0.4186 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.2469 | Val  Acc: 0.9412
 Site-SynthDigits               (2) | Val  Loss: 0.3578 | Val  Acc: 0.9262
 Site-MNIST_M                   (1) | Val  Loss: 0.8386 | Val  Acc: 0.7778
 Site-MNIST_M                   (1) | Val  Loss: 0.7152 | Val  Acc: 0.8148
 Site-SVHN                      (2) | Val  Loss: 0.6045 | Val  Acc: 0.7857
Average Valid Accuracy: 0.9034
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.9510
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.9344
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.9456
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 0.8889
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 0.9062
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 0.8966
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 0.8857
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 0.9418
 Best site-SynthDigits              (2)  | Epoch:46 | Val Acc: 0.9189
 Best site-SynthDigits              (2)  | Epoch:46 | Val Acc: 0.9412
 Best site-SynthDigits              (2)  | Epoch:46 | Val Acc: 0.9262
 Best site-MNIST_M                  (1)  | Epoch:46 | Val Acc: 0.7778
 Best site-MNIST_M                  (1)  | Epoch:46 | Val Acc: 0.8148
 Best site-SVHN                     (2)  | Epoch:46 | Val Acc: 0.7857
 Test site-MNIST                     (0)| Epoch:46 | Test Acc: 0.9430
 Test site-USPS                      (1)| Epoch:46 | Test Acc: 0.9462
 Test site-SynthDigits               (2)| Epoch:46 | Test Acc: 0.8855
 Test site-MNIST_M                   (1)| Epoch:46 | Test Acc: 0.7153
 Test site-SVHN                      (2)| Epoch:46 | Test Acc: 0.6307
MNIST: 0.9430, USPS: 0.9462, SynthDigits: 0.8855, MNIST_M: 0.7153, SVHN: 0.6307, 
Average Test Accuracy(group): 0.8241, Average Test Accuracy(individual): 0.9011,
domain std=0.1281, cluster std=0.0496, individual std=0.0886, 
Average Test Accuracy: 0.8241
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 47 ============
cnt=[10, 8, 4, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-MNIST                     (0) | Train Loss: 0.5160 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2568 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.0904 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1209 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.3316 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.1396 | Train Acc: 0.9762
 Site-MNIST                     (0) | Train Loss: 0.1481 | Train Acc: 0.9648
 Site-MNIST                     (0) | Train Loss: 0.2034 | Train Acc: 0.9487
 Site-MNIST                     (0) | Train Loss: 0.1931 | Train Acc: 0.9361
 Site-MNIST                     (0) | Train Loss: 0.1587 | Train Acc: 0.9630
 Site-USPS                      (1) | Train Loss: 0.2338 | Train Acc: 0.9500
 Site-USPS                      (1) | Train Loss: 0.3269 | Train Acc: 0.9444
 Site-USPS                      (1) | Train Loss: 0.3065 | Train Acc: 0.9302
 Site-USPS                      (1) | Train Loss: 0.2352 | Train Acc: 0.9185
 Site-USPS                      (1) | Train Loss: 0.1918 | Train Acc: 0.9548
 Site-USPS                      (1) | Train Loss: 0.1916 | Train Acc: 0.9497
 Site-SynthDigits               (2) | Train Loss: 0.4411 | Train Acc: 0.8808
 Site-SynthDigits               (2) | Train Loss: 0.4000 | Train Acc: 0.9121
 Site-SynthDigits               (2) | Train Loss: 0.3657 | Train Acc: 0.9226
 Site-MNIST_M                   (1) | Train Loss: 0.7405 | Train Acc: 0.7956
 Site-MNIST_M                   (1) | Train Loss: 0.6501 | Train Acc: 0.8073
 Site-SVHN                      (2) | Train Loss: 0.8605 | Train Acc: 0.7376
Average Train Accuracy: 0.9135
 Site-MNIST                     (0) | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0293 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4894 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4901 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3085 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1762 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1349 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1531 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.2194 | Val  Acc: 0.9344
 Site-MNIST                     (0) | Val  Loss: 0.2107 | Val  Acc: 0.9426
 Site-USPS                      (1) | Val  Loss: 0.0487 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3632 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.3692 | Val  Acc: 0.8750
 Site-USPS                      (1) | Val  Loss: 0.3542 | Val  Acc: 0.8793
 Site-USPS                      (1) | Val  Loss: 0.2867 | Val  Acc: 0.9048
 Site-USPS                      (1) | Val  Loss: 0.2094 | Val  Acc: 0.9365
 Site-SynthDigits               (2) | Val  Loss: 0.4101 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.2401 | Val  Acc: 0.9412
 Site-SynthDigits               (2) | Val  Loss: 0.3520 | Val  Acc: 0.9344
 Site-MNIST_M                   (1) | Val  Loss: 0.8272 | Val  Acc: 0.7556
 Site-MNIST_M                   (1) | Val  Loss: 0.7006 | Val  Acc: 0.8025
 Site-SVHN                      (2) | Val  Loss: 0.6051 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8994
 Test site-MNIST                     (0)| Epoch:46 | Test Acc: 0.9440
 Test site-USPS                      (1)| Epoch:46 | Test Acc: 0.9495
 Test site-SynthDigits               (2)| Epoch:46 | Test Acc: 0.8851
 Test site-MNIST_M                   (1)| Epoch:46 | Test Acc: 0.7201
 Test site-SVHN                      (2)| Epoch:46 | Test Acc: 0.6346
MNIST: 0.9440, USPS: 0.9495, SynthDigits: 0.8851, MNIST_M: 0.7201, SVHN: 0.6346, 
Average Test Accuracy(group): 0.8267, Average Test Accuracy(individual): 0.9030,
domain std=0.1269, cluster std=0.0498, individual std=0.0878, 
Average Test Accuracy: 0.8267
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
============ Train epoch 48 ============
cnt=[10, 8, 4, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-MNIST                     (0) | Train Loss: 0.5111 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2554 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.0906 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1151 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.3376 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.1356 | Train Acc: 0.9762
 Site-MNIST                     (0) | Train Loss: 0.1712 | Train Acc: 0.9648
 Site-MNIST                     (0) | Train Loss: 0.2067 | Train Acc: 0.9487
 Site-MNIST                     (0) | Train Loss: 0.1960 | Train Acc: 0.9402
 Site-MNIST                     (0) | Train Loss: 0.1562 | Train Acc: 0.9645
 Site-USPS                      (1) | Train Loss: 0.2174 | Train Acc: 0.9500
 Site-USPS                      (1) | Train Loss: 0.2083 | Train Acc: 0.9444
 Site-USPS                      (1) | Train Loss: 0.1630 | Train Acc: 0.9457
 Site-USPS                      (1) | Train Loss: 0.2477 | Train Acc: 0.9270
 Site-USPS                      (1) | Train Loss: 0.1853 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.1932 | Train Acc: 0.9497
 Site-SynthDigits               (2) | Train Loss: 0.4629 | Train Acc: 0.8609
 Site-SynthDigits               (2) | Train Loss: 0.3920 | Train Acc: 0.9084
 Site-SynthDigits               (2) | Train Loss: 0.3532 | Train Acc: 0.9267
 Site-MNIST_M                   (1) | Train Loss: 0.7377 | Train Acc: 0.7680
 Site-MNIST_M                   (1) | Train Loss: 0.7140 | Train Acc: 0.8043
 Site-SVHN                      (2) | Train Loss: 0.8188 | Train Acc: 0.7553
Average Train Accuracy: 0.9133
 Site-MNIST                     (0) | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0270 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4940 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5001 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3115 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1771 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1313 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1511 | Val  Acc: 0.9510
 Site-MNIST                     (0) | Val  Loss: 0.2168 | Val  Acc: 0.9399
 Site-MNIST                     (0) | Val  Loss: 0.2088 | Val  Acc: 0.9486
 Site-USPS                      (1) | Val  Loss: 0.0494 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3561 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.3686 | Val  Acc: 0.8750
 Site-USPS                      (1) | Val  Loss: 0.3549 | Val  Acc: 0.8793
 Site-USPS                      (1) | Val  Loss: 0.2888 | Val  Acc: 0.9143
 Site-USPS                      (1) | Val  Loss: 0.2086 | Val  Acc: 0.9365
 Site-SynthDigits               (2) | Val  Loss: 0.4078 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.2332 | Val  Acc: 0.9412
 Site-SynthDigits               (2) | Val  Loss: 0.3492 | Val  Acc: 0.9262
 Site-MNIST_M                   (1) | Val  Loss: 0.8314 | Val  Acc: 0.7778
 Site-MNIST_M                   (1) | Val  Loss: 0.7040 | Val  Acc: 0.8025
 Site-SVHN                      (2) | Val  Loss: 0.5988 | Val  Acc: 0.7571
Average Valid Accuracy: 0.9008
 Test site-MNIST                     (0)| Epoch:47 | Test Acc: 0.9454
 Test site-USPS                      (1)| Epoch:47 | Test Acc: 0.9473
 Test site-SynthDigits               (2)| Epoch:47 | Test Acc: 0.8884
 Test site-MNIST_M                   (1)| Epoch:47 | Test Acc: 0.7156
 Test site-SVHN                      (2)| Epoch:47 | Test Acc: 0.6364
MNIST: 0.9454, USPS: 0.9473, SynthDigits: 0.8884, MNIST_M: 0.7156, SVHN: 0.6364, 
Average Test Accuracy(group): 0.8266, Average Test Accuracy(individual): 0.9032,
domain std=0.1273, cluster std=0.0490, individual std=0.0884, 
Average Test Accuracy: 0.8266
============ Train epoch 49 ============
cnt=[10, 8, 4, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-MNIST                     (0) | Train Loss: 0.4959 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2562 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.0805 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1132 | Train Acc: 0.9474
 Site-MNIST                     (0) | Train Loss: 0.2143 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1314 | Train Acc: 0.9762
 Site-MNIST                     (0) | Train Loss: 0.1435 | Train Acc: 0.9648
 Site-MNIST                     (0) | Train Loss: 0.1999 | Train Acc: 0.9462
 Site-MNIST                     (0) | Train Loss: 0.1904 | Train Acc: 0.9389
 Site-MNIST                     (0) | Train Loss: 0.1519 | Train Acc: 0.9653
 Site-USPS                      (1) | Train Loss: 0.2152 | Train Acc: 0.9500
 Site-USPS                      (1) | Train Loss: 0.2440 | Train Acc: 0.9444
 Site-USPS                      (1) | Train Loss: 0.1583 | Train Acc: 0.9457
 Site-USPS                      (1) | Train Loss: 0.2439 | Train Acc: 0.9313
 Site-USPS                      (1) | Train Loss: 0.1832 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.1896 | Train Acc: 0.9511
 Site-SynthDigits               (2) | Train Loss: 0.4293 | Train Acc: 0.8808
 Site-SynthDigits               (2) | Train Loss: 0.3918 | Train Acc: 0.9194
 Site-SynthDigits               (2) | Train Loss: 0.3526 | Train Acc: 0.9287
 Site-MNIST_M                   (1) | Train Loss: 0.7254 | Train Acc: 0.7901
 Site-MNIST_M                   (1) | Train Loss: 0.6830 | Train Acc: 0.8012
 Site-SVHN                      (2) | Train Loss: 0.8063 | Train Acc: 0.7482
Average Train Accuracy: 0.9136
 Site-MNIST                     (0) | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0244 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.5114 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5036 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3149 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1742 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1271 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1477 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.2147 | Val  Acc: 0.9344
 Site-MNIST                     (0) | Val  Loss: 0.2063 | Val  Acc: 0.9426
 Site-USPS                      (1) | Val  Loss: 0.0509 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3672 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.3824 | Val  Acc: 0.8750
 Site-USPS                      (1) | Val  Loss: 0.3585 | Val  Acc: 0.8966
 Site-USPS                      (1) | Val  Loss: 0.2915 | Val  Acc: 0.9143
 Site-USPS                      (1) | Val  Loss: 0.2086 | Val  Acc: 0.9365
 Site-SynthDigits               (2) | Val  Loss: 0.4032 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.2304 | Val  Acc: 0.9265
 Site-SynthDigits               (2) | Val  Loss: 0.3407 | Val  Acc: 0.9344
 Site-MNIST_M                   (1) | Val  Loss: 0.8167 | Val  Acc: 0.7778
 Site-MNIST_M                   (1) | Val  Loss: 0.6919 | Val  Acc: 0.8025
 Site-SVHN                      (2) | Val  Loss: 0.5814 | Val  Acc: 0.7857
Average Valid Accuracy: 0.9016
 Test site-MNIST                     (0)| Epoch:47 | Test Acc: 0.9459
 Test site-USPS                      (1)| Epoch:47 | Test Acc: 0.9462
 Test site-SynthDigits               (2)| Epoch:47 | Test Acc: 0.8891
 Test site-MNIST_M                   (1)| Epoch:47 | Test Acc: 0.7164
 Test site-SVHN                      (2)| Epoch:47 | Test Acc: 0.6367
MNIST: 0.9459, USPS: 0.9462, SynthDigits: 0.8891, MNIST_M: 0.7164, SVHN: 0.6367, 
Average Test Accuracy(group): 0.8269, Average Test Accuracy(individual): 0.9033,
domain std=0.1270, cluster std=0.0490, individual std=0.0881, 
Average Test Accuracy: 0.8269
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2_cluster_3/ccop_q=1...
===2023-08-14 13:55:08===
