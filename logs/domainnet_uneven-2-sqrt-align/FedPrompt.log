===2023-03-29 12:43:33===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
only align at first round
 Site-Clipart   | Train Loss: 1.9804 | Train Acc: 0.4127
 Site-Clipart   | Train Loss: 1.9118 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.8536 | Train Acc: 0.5397
 Site-Clipart   | Train Loss: 1.8520 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 2.0819 | Train Acc: 0.3492
 Site-Clipart   | Train Loss: 2.0375 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 2.1873 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1589 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.0669 | Train Acc: 0.3492
 Site-Painting  | Train Loss: 1.9811 | Train Acc: 0.4127
 Site-QuickDraw | Train Loss: 2.2794 | Train Acc: 0.1429
 Site-Real      | Train Loss: 1.8746 | Train Acc: 0.5079
 Site-Sketch    | Train Loss: 1.8415 | Train Acc: 0.5873
 Site-Clipart   | Val  Loss: 2.0548 | Val  Acc: 0.3571
 Site-Clipart   | Val  Loss: 1.8266 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.8362 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.8768 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.8656 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.9424 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.1569 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1478 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1601 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 2.0604 | Val  Acc: 0.4048
 Site-QuickDraw | Val  Loss: 2.2253 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.9620 | Val  Acc: 0.4048
 Site-Sketch    | Val  Loss: 1.9940 | Val  Acc: 0.4048
Average Valid Accuracy: 0.3810
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3571
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Painting   | Epoch:0 | Val Acc: 0.4048
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1667
 Best site-Real       | Epoch:0 | Val Acc: 0.4048
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.5252 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.6115 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.4196 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.4571 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.6331 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 1.6160 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 2.0802 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.9414 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.8261 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 1.5303 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 2.2337 | Train Acc: 0.1746
 Site-Real      | Train Loss: 1.3968 | Train Acc: 0.7619
 Site-Sketch    | Train Loss: 1.3967 | Train Acc: 0.7302
 Site-Clipart   | Val  Loss: 1.6180 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.3708 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.3693 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.3312 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.5885 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.5877 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.9589 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 1.9027 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.1025 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.7282 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 2.1579 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.4525 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 1.6259 | Val  Acc: 0.5952
Average Valid Accuracy: 0.5806
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:1 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3333
 Best site-Painting   | Epoch:1 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2619
 Best site-Real       | Epoch:1 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.1731 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.3207 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.0532 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9853 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 1.2194 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.2598 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 2.0388 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 1.8139 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.6857 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.1994 | Train Acc: 0.7302
 Site-QuickDraw | Train Loss: 2.1476 | Train Acc: 0.2063
 Site-Real      | Train Loss: 1.0095 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 1.1145 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 1.2031 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.0807 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.9533 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 1.0407 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.2438 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.2350 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.6983 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.7210 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.0403 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 1.4125 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 2.1011 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.9499 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 1.2128 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6465
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:2 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2143
 Best site-Painting   | Epoch:2 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3095
 Best site-Real       | Epoch:2 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.9511 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 0.9818 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.7865 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.6829 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.9516 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.9806 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.7544 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.5197 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.3556 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.9867 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 1.9743 | Train Acc: 0.4286
 Site-Real      | Train Loss: 0.7311 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.8782 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.9309 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.7066 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6518 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.7619 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.9673 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.9608 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.4344 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.3171 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.8472 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 1.1875 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 2.0478 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.6866 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.0119 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7363
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3810
 Best site-Painting   | Epoch:3 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3333
 Best site-Real       | Epoch:3 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.6564 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.7876 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.5366 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.4664 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.6617 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.7960 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.6056 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.3229 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 1.1526 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.7717 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.8275 | Train Acc: 0.3810
 Site-Real      | Train Loss: 0.5701 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.6601 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.6901 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.5123 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4831 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4661 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7939 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 0.7118 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3139 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.2492 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.6054 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.9804 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 2.0400 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.5056 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8943 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7784
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:4 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:4 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5714
 Best site-Painting   | Epoch:4 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3333
 Best site-Real       | Epoch:4 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.4944 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.6684 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.5034 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.4439 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.6375 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.6318 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.6354 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.2638 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.1164 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.5663 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.6475 | Train Acc: 0.4444
 Site-Real      | Train Loss: 0.3399 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.5531 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6083 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4413 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4033 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4389 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.7685 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.6527 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.1987 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.2412 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6334 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 0.8660 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.8944 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.3696 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7262 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7656
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.3653 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.6148 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.3943 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.2708 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.4795 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5015 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.4218 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1701 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 1.0729 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.4447 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.4546 | Train Acc: 0.6190
 Site-Real      | Train Loss: 0.2659 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.4569 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4222 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2409 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2816 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2445 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.5920 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.5286 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.0954 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.2069 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.4226 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.7171 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.6992 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.3284 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.8051 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8059
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5238
 Best site-Painting   | Epoch:6 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5238
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.3549 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4527 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.2273 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1809 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3538 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4776 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.2633 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 0.8526 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 0.8944 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.4070 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.6233 | Train Acc: 0.4762
 Site-Real      | Train Loss: 0.2681 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3147 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3542 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2108 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1873 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2446 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.4666 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5032 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.9135 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 0.7520 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.3069 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.7858 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.7763 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.3093 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6628 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8223
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:7 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5000
 Best site-Painting   | Epoch:7 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.4762
 Best site-Real       | Epoch:7 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.2394 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3488 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2257 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1528 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2909 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3458 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.3447 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0275 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 0.7921 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.3141 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.4684 | Train Acc: 0.5397
 Site-Real      | Train Loss: 0.2176 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3047 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2873 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2058 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1997 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1892 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3832 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3113 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.8292 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.9459 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.2059 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.5330 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.8032 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.2861 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5508 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8352
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5476
 Best site-Painting   | Epoch:8 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.4524
 Best site-Real       | Epoch:8 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.1924 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2587 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1969 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1597 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2476 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3851 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.0772 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.8681 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.6729 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.2619 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.2787 | Train Acc: 0.6190
 Site-Real      | Train Loss: 0.1833 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.2856 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2183 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1716 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1266 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1821 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3266 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3069 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.7014 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.7566 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.0470 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.5841 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.6051 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.2302 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6206 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8590
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6667
 Best site-Painting   | Epoch:9 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.4524
 Best site-Real       | Epoch:9 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-align/FedPrompt...
===2023-03-29 13:19:23===
===2023-03-29 13:19:25===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8650
 Test site-Infograph | Epoch:9 | Test Acc: 0.5129
 Test site-Painting  | Epoch:9 | Test Acc: 0.8514
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.4530
 Test site-Real      | Epoch:9 | Test Acc: 0.9244
 Test site-Sketch    | Epoch:9 | Test Acc: 0.8014
Average Test Accuracy: 0.7347
