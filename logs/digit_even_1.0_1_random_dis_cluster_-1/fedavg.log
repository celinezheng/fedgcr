===2023-06-03 13:39:43===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                    | Train Loss: 2.2497 | Train Acc: 0.2264
 Site-MNIST                    | Train Loss: 2.2568 | Train Acc: 0.2197
 Site-USPS                     | Train Loss: 2.2510 | Train Acc: 0.2561
 Site-USPS                     | Train Loss: 2.2463 | Train Acc: 0.2673
 Site-SynthDigits              | Train Loss: 2.2932 | Train Acc: 0.1294
 Site-SynthDigits              | Train Loss: 2.2832 | Train Acc: 0.1641
 Site-MNIST-M                  | Train Loss: 2.2996 | Train Acc: 0.1186
 Site-MNIST-M                  | Train Loss: 2.2982 | Train Acc: 0.1040
 Site-SVHN                     | Train Loss: 2.2821 | Train Acc: 0.1456
 Site-SVHN                     | Train Loss: 2.2868 | Train Acc: 0.1426
 Site-MNIST                         | Val  Loss: 2.2631 | Val  Acc: 0.1522
 Site-MNIST                         | Val  Loss: 2.2538 | Val  Acc: 0.1978
 Site-USPS                          | Val  Loss: 2.2520 | Val  Acc: 0.2609
 Site-USPS                          | Val  Loss: 2.2487 | Val  Acc: 0.2698
 Site-SynthDigits                   | Val  Loss: 2.2888 | Val  Acc: 0.1413
 Site-SynthDigits                   | Val  Loss: 2.2936 | Val  Acc: 0.1079
 Site-MNIST-M                       | Val  Loss: 2.3046 | Val  Acc: 0.0652
 Site-MNIST-M                       | Val  Loss: 2.3003 | Val  Acc: 0.0935
 Site-SVHN                          | Val  Loss: 2.2840 | Val  Acc: 0.1630
 Site-SVHN                          | Val  Loss: 2.2862 | Val  Acc: 0.1403
Average Valid Accuracy: 0.1592
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1522
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1978
 Best site-USPS                      | Epoch:0 | Val Acc: 0.2609
 Best site-USPS                      | Epoch:0 | Val Acc: 0.2698
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1413
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1079
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.0652
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.0935
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1630
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1403
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 1 ============
 Site-MNIST                    | Train Loss: 2.2028 | Train Acc: 0.4420
 Site-MNIST                    | Train Loss: 2.2192 | Train Acc: 0.3641
 Site-USPS                     | Train Loss: 2.1936 | Train Acc: 0.4555
 Site-USPS                     | Train Loss: 2.1880 | Train Acc: 0.4861
 Site-SynthDigits              | Train Loss: 2.2823 | Train Acc: 0.1590
 Site-SynthDigits              | Train Loss: 2.2668 | Train Acc: 0.2108
 Site-MNIST-M                  | Train Loss: 2.2934 | Train Acc: 0.1213
 Site-MNIST-M                  | Train Loss: 2.2920 | Train Acc: 0.1085
 Site-SVHN                     | Train Loss: 2.2716 | Train Acc: 0.1968
 Site-SVHN                     | Train Loss: 2.2761 | Train Acc: 0.1830
 Site-MNIST                         | Val  Loss: 2.2265 | Val  Acc: 0.2609
 Site-MNIST                         | Val  Loss: 2.2139 | Val  Acc: 0.3813
 Site-USPS                          | Val  Loss: 2.2001 | Val  Acc: 0.4239
 Site-USPS                          | Val  Loss: 2.1963 | Val  Acc: 0.4568
 Site-SynthDigits                   | Val  Loss: 2.2716 | Val  Acc: 0.2065
 Site-SynthDigits                   | Val  Loss: 2.2796 | Val  Acc: 0.1511
 Site-MNIST-M                       | Val  Loss: 2.2984 | Val  Acc: 0.0652
 Site-MNIST-M                       | Val  Loss: 2.2931 | Val  Acc: 0.1043
 Site-SVHN                          | Val  Loss: 2.2703 | Val  Acc: 0.2065
 Site-SVHN                          | Val  Loss: 2.2739 | Val  Acc: 0.2050
Average Valid Accuracy: 0.2462
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.2609
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.3813
 Best site-USPS                      | Epoch:1 | Val Acc: 0.4239
 Best site-USPS                      | Epoch:1 | Val Acc: 0.4568
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2065
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.1511
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.0652
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.1043
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2065
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2050
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 2 ============
 Site-MNIST                    | Train Loss: 2.1588 | Train Acc: 0.5256
 Site-MNIST                    | Train Loss: 2.1821 | Train Acc: 0.4475
 Site-USPS                     | Train Loss: 2.1383 | Train Acc: 0.5256
 Site-USPS                     | Train Loss: 2.1324 | Train Acc: 0.5668
 Site-SynthDigits              | Train Loss: 2.2707 | Train Acc: 0.1941
 Site-SynthDigits              | Train Loss: 2.2506 | Train Acc: 0.2565
 Site-MNIST-M                  | Train Loss: 2.2866 | Train Acc: 0.1348
 Site-MNIST-M                  | Train Loss: 2.2858 | Train Acc: 0.1220
 Site-SVHN                     | Train Loss: 2.2621 | Train Acc: 0.2183
 Site-SVHN                     | Train Loss: 2.2662 | Train Acc: 0.2018
 Site-MNIST                         | Val  Loss: 2.1902 | Val  Acc: 0.4022
 Site-MNIST                         | Val  Loss: 2.1744 | Val  Acc: 0.4640
 Site-USPS                          | Val  Loss: 2.1503 | Val  Acc: 0.4891
 Site-USPS                          | Val  Loss: 2.1460 | Val  Acc: 0.5144
 Site-SynthDigits                   | Val  Loss: 2.2550 | Val  Acc: 0.2500
 Site-SynthDigits                   | Val  Loss: 2.2656 | Val  Acc: 0.2014
 Site-MNIST-M                       | Val  Loss: 2.2924 | Val  Acc: 0.0543
 Site-MNIST-M                       | Val  Loss: 2.2861 | Val  Acc: 0.1043
 Site-SVHN                          | Val  Loss: 2.2576 | Val  Acc: 0.2391
 Site-SVHN                          | Val  Loss: 2.2627 | Val  Acc: 0.2194
Average Valid Accuracy: 0.2938
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.4022
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.4640
 Best site-USPS                      | Epoch:2 | Val Acc: 0.4891
 Best site-USPS                      | Epoch:2 | Val Acc: 0.5144
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2500
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2014
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.0543
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.1043
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2391
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2194
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 3 ============
 Site-MNIST                    | Train Loss: 2.1117 | Train Acc: 0.5526
 Site-MNIST                    | Train Loss: 2.1439 | Train Acc: 0.4673
 Site-USPS                     | Train Loss: 2.0863 | Train Acc: 0.5553
 Site-USPS                     | Train Loss: 2.0791 | Train Acc: 0.5883
 Site-SynthDigits              | Train Loss: 2.2583 | Train Acc: 0.2210
 Site-SynthDigits              | Train Loss: 2.2346 | Train Acc: 0.2807
 Site-MNIST-M                  | Train Loss: 2.2787 | Train Acc: 0.1644
 Site-MNIST-M                  | Train Loss: 2.2791 | Train Acc: 0.1435
 Site-SVHN                     | Train Loss: 2.2516 | Train Acc: 0.2426
 Site-SVHN                     | Train Loss: 2.2574 | Train Acc: 0.2135
 Site-MNIST                         | Val  Loss: 2.1527 | Val  Acc: 0.4457
 Site-MNIST                         | Val  Loss: 2.1343 | Val  Acc: 0.4964
 Site-USPS                          | Val  Loss: 2.1025 | Val  Acc: 0.5217
 Site-USPS                          | Val  Loss: 2.0979 | Val  Acc: 0.5324
 Site-SynthDigits                   | Val  Loss: 2.2390 | Val  Acc: 0.2826
 Site-SynthDigits                   | Val  Loss: 2.2514 | Val  Acc: 0.2374
 Site-MNIST-M                       | Val  Loss: 2.2863 | Val  Acc: 0.0761
 Site-MNIST-M                       | Val  Loss: 2.2789 | Val  Acc: 0.1151
 Site-SVHN                          | Val  Loss: 2.2459 | Val  Acc: 0.2717
 Site-SVHN                          | Val  Loss: 2.2525 | Val  Acc: 0.2482
Average Valid Accuracy: 0.3227
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.4457
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.4964
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5217
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5324
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2826
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2374
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.0761
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.1151
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2717
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2482
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 4 ============
 Site-MNIST                    | Train Loss: 2.0697 | Train Acc: 0.5795
 Site-MNIST                    | Train Loss: 2.1062 | Train Acc: 0.4888
 Site-USPS                     | Train Loss: 2.0339 | Train Acc: 0.5768
 Site-USPS                     | Train Loss: 2.0273 | Train Acc: 0.5955
 Site-SynthDigits              | Train Loss: 2.2452 | Train Acc: 0.2372
 Site-SynthDigits              | Train Loss: 2.2181 | Train Acc: 0.2996
 Site-MNIST-M                  | Train Loss: 2.2706 | Train Acc: 0.1833
 Site-MNIST-M                  | Train Loss: 2.2726 | Train Acc: 0.1596
 Site-SVHN                     | Train Loss: 2.2435 | Train Acc: 0.2453
 Site-SVHN                     | Train Loss: 2.2490 | Train Acc: 0.2287
 Site-MNIST                         | Val  Loss: 2.1153 | Val  Acc: 0.4674
 Site-MNIST                         | Val  Loss: 2.0948 | Val  Acc: 0.5180
 Site-USPS                          | Val  Loss: 2.0552 | Val  Acc: 0.5109
 Site-USPS                          | Val  Loss: 2.0505 | Val  Acc: 0.5288
 Site-SynthDigits                   | Val  Loss: 2.2232 | Val  Acc: 0.2935
 Site-SynthDigits                   | Val  Loss: 2.2370 | Val  Acc: 0.2446
 Site-MNIST-M                       | Val  Loss: 2.2799 | Val  Acc: 0.1413
 Site-MNIST-M                       | Val  Loss: 2.2720 | Val  Acc: 0.1547
 Site-SVHN                          | Val  Loss: 2.2356 | Val  Acc: 0.2717
 Site-SVHN                          | Val  Loss: 2.2432 | Val  Acc: 0.2626
Average Valid Accuracy: 0.3393
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.4674
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5180
 Best site-USPS                      | Epoch:4 | Val Acc: 0.5109
 Best site-USPS                      | Epoch:4 | Val Acc: 0.5288
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.2935
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.2446
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.1413
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.1547
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2717
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2626
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 5 ============
 Site-MNIST                    | Train Loss: 2.0272 | Train Acc: 0.6038
 Site-MNIST                    | Train Loss: 2.0685 | Train Acc: 0.4942
 Site-USPS                     | Train Loss: 1.9825 | Train Acc: 0.5930
 Site-USPS                     | Train Loss: 1.9785 | Train Acc: 0.6018
 Site-SynthDigits              | Train Loss: 2.2344 | Train Acc: 0.2399
 Site-SynthDigits              | Train Loss: 2.2016 | Train Acc: 0.3193
 Site-MNIST-M                  | Train Loss: 2.2634 | Train Acc: 0.1887
 Site-MNIST-M                  | Train Loss: 2.2655 | Train Acc: 0.1704
 Site-SVHN                     | Train Loss: 2.2358 | Train Acc: 0.2480
 Site-SVHN                     | Train Loss: 2.2417 | Train Acc: 0.2323
 Site-MNIST                         | Val  Loss: 2.0780 | Val  Acc: 0.4783
 Site-MNIST                         | Val  Loss: 2.0556 | Val  Acc: 0.5252
 Site-USPS                          | Val  Loss: 2.0107 | Val  Acc: 0.5217
 Site-USPS                          | Val  Loss: 2.0063 | Val  Acc: 0.5540
 Site-SynthDigits                   | Val  Loss: 2.2070 | Val  Acc: 0.3152
 Site-SynthDigits                   | Val  Loss: 2.2217 | Val  Acc: 0.2626
 Site-MNIST-M                       | Val  Loss: 2.2727 | Val  Acc: 0.1413
 Site-MNIST-M                       | Val  Loss: 2.2647 | Val  Acc: 0.1547
 Site-SVHN                          | Val  Loss: 2.2263 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.2343 | Val  Acc: 0.2806
Average Valid Accuracy: 0.3538
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.4783
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5252
 Best site-USPS                      | Epoch:5 | Val Acc: 0.5217
 Best site-USPS                      | Epoch:5 | Val Acc: 0.5540
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3152
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.2626
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.1413
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.1547
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2806
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 6 ============
 Site-MNIST                    | Train Loss: 1.9869 | Train Acc: 0.6092
 Site-MNIST                    | Train Loss: 2.0335 | Train Acc: 0.5004
 Site-USPS                     | Train Loss: 1.9367 | Train Acc: 0.5984
 Site-USPS                     | Train Loss: 1.9318 | Train Acc: 0.6179
 Site-SynthDigits              | Train Loss: 2.2194 | Train Acc: 0.2561
 Site-SynthDigits              | Train Loss: 2.1845 | Train Acc: 0.3372
 Site-MNIST-M                  | Train Loss: 2.2541 | Train Acc: 0.1941
 Site-MNIST-M                  | Train Loss: 2.2581 | Train Acc: 0.1919
 Site-SVHN                     | Train Loss: 2.2268 | Train Acc: 0.2480
 Site-SVHN                     | Train Loss: 2.2342 | Train Acc: 0.2323
 Site-MNIST                         | Val  Loss: 2.0416 | Val  Acc: 0.5109
 Site-MNIST                         | Val  Loss: 2.0191 | Val  Acc: 0.5468
 Site-USPS                          | Val  Loss: 1.9670 | Val  Acc: 0.5543
 Site-USPS                          | Val  Loss: 1.9627 | Val  Acc: 0.5719
 Site-SynthDigits                   | Val  Loss: 2.1909 | Val  Acc: 0.3370
 Site-SynthDigits                   | Val  Loss: 2.2058 | Val  Acc: 0.2842
 Site-MNIST-M                       | Val  Loss: 2.2647 | Val  Acc: 0.1413
 Site-MNIST-M                       | Val  Loss: 2.2565 | Val  Acc: 0.1763
 Site-SVHN                          | Val  Loss: 2.2181 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.2257 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3693
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.5109
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.5468
 Best site-USPS                      | Epoch:6 | Val Acc: 0.5543
 Best site-USPS                      | Epoch:6 | Val Acc: 0.5719
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3370
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.2842
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.1413
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.1763
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2770
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 7 ============
 Site-MNIST                    | Train Loss: 1.9483 | Train Acc: 0.6280
 Site-MNIST                    | Train Loss: 1.9993 | Train Acc: 0.5094
 Site-USPS                     | Train Loss: 1.8929 | Train Acc: 0.6065
 Site-USPS                     | Train Loss: 1.8860 | Train Acc: 0.6251
 Site-SynthDigits              | Train Loss: 2.2062 | Train Acc: 0.2642
 Site-SynthDigits              | Train Loss: 2.1676 | Train Acc: 0.3543
 Site-MNIST-M                  | Train Loss: 2.2444 | Train Acc: 0.2075
 Site-MNIST-M                  | Train Loss: 2.2511 | Train Acc: 0.2036
 Site-SVHN                     | Train Loss: 2.2229 | Train Acc: 0.2561
 Site-SVHN                     | Train Loss: 2.2277 | Train Acc: 0.2350
 Site-MNIST                         | Val  Loss: 2.0082 | Val  Acc: 0.5109
 Site-MNIST                         | Val  Loss: 1.9842 | Val  Acc: 0.5612
 Site-USPS                          | Val  Loss: 1.9251 | Val  Acc: 0.5435
 Site-USPS                          | Val  Loss: 1.9205 | Val  Acc: 0.5755
 Site-SynthDigits                   | Val  Loss: 2.1749 | Val  Acc: 0.3587
 Site-SynthDigits                   | Val  Loss: 2.1905 | Val  Acc: 0.3094
 Site-MNIST-M                       | Val  Loss: 2.2578 | Val  Acc: 0.1630
 Site-MNIST-M                       | Val  Loss: 2.2489 | Val  Acc: 0.1978
 Site-SVHN                          | Val  Loss: 2.2100 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.2183 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3780
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.5109
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.5612
 Best site-USPS                      | Epoch:7 | Val Acc: 0.5435
 Best site-USPS                      | Epoch:7 | Val Acc: 0.5755
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3587
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3094
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.1630
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.1978
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2770
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 8 ============
 Site-MNIST                    | Train Loss: 1.9059 | Train Acc: 0.6361
 Site-MNIST                    | Train Loss: 1.9645 | Train Acc: 0.5265
 Site-USPS                     | Train Loss: 1.8513 | Train Acc: 0.5984
 Site-USPS                     | Train Loss: 1.8415 | Train Acc: 0.6422
 Site-SynthDigits              | Train Loss: 2.1924 | Train Acc: 0.2749
 Site-SynthDigits              | Train Loss: 2.1515 | Train Acc: 0.3659
 Site-MNIST-M                  | Train Loss: 2.2393 | Train Acc: 0.2264
 Site-MNIST-M                  | Train Loss: 2.2443 | Train Acc: 0.2117
 Site-SVHN                     | Train Loss: 2.2184 | Train Acc: 0.2588
 Site-SVHN                     | Train Loss: 2.2210 | Train Acc: 0.2368
 Site-MNIST                         | Val  Loss: 1.9755 | Val  Acc: 0.5217
 Site-MNIST                         | Val  Loss: 1.9487 | Val  Acc: 0.5791
 Site-USPS                          | Val  Loss: 1.8837 | Val  Acc: 0.5326
 Site-USPS                          | Val  Loss: 1.8792 | Val  Acc: 0.5791
 Site-SynthDigits                   | Val  Loss: 2.1596 | Val  Acc: 0.3696
 Site-SynthDigits                   | Val  Loss: 2.1760 | Val  Acc: 0.3237
 Site-MNIST-M                       | Val  Loss: 2.2518 | Val  Acc: 0.1848
 Site-MNIST-M                       | Val  Loss: 2.2421 | Val  Acc: 0.2158
 Site-SVHN                          | Val  Loss: 2.2021 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.2112 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3877
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.5217
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.5791
 Best site-USPS                      | Epoch:8 | Val Acc: 0.5326
 Best site-USPS                      | Epoch:8 | Val Acc: 0.5791
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3696
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3237
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.1848
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.2158
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2770
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 9 ============
 Site-MNIST                    | Train Loss: 1.8680 | Train Acc: 0.6496
 Site-MNIST                    | Train Loss: 1.9313 | Train Acc: 0.5399
 Site-USPS                     | Train Loss: 1.8079 | Train Acc: 0.6092
 Site-USPS                     | Train Loss: 1.7987 | Train Acc: 0.6511
 Site-SynthDigits              | Train Loss: 2.1809 | Train Acc: 0.2776
 Site-SynthDigits              | Train Loss: 2.1361 | Train Acc: 0.3641
 Site-MNIST-M                  | Train Loss: 2.2301 | Train Acc: 0.2399
 Site-MNIST-M                  | Train Loss: 2.2380 | Train Acc: 0.2215
 Site-SVHN                     | Train Loss: 2.2069 | Train Acc: 0.2642
 Site-SVHN                     | Train Loss: 2.2150 | Train Acc: 0.2350
 Site-MNIST                         | Val  Loss: 1.9432 | Val  Acc: 0.5326
 Site-MNIST                         | Val  Loss: 1.9142 | Val  Acc: 0.5899
 Site-USPS                          | Val  Loss: 1.8440 | Val  Acc: 0.5543
 Site-USPS                          | Val  Loss: 1.8395 | Val  Acc: 0.5935
 Site-SynthDigits                   | Val  Loss: 2.1445 | Val  Acc: 0.3587
 Site-SynthDigits                   | Val  Loss: 2.1616 | Val  Acc: 0.3165
 Site-MNIST-M                       | Val  Loss: 2.2459 | Val  Acc: 0.2065
 Site-MNIST-M                       | Val  Loss: 2.2355 | Val  Acc: 0.2338
 Site-SVHN                          | Val  Loss: 2.1946 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.2045 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3956
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.5326
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.5899
 Best site-USPS                      | Epoch:9 | Val Acc: 0.5543
 Best site-USPS                      | Epoch:9 | Val Acc: 0.5935
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3587
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3165
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.2065
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.2338
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2770
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
 Test site-MNIST                     | Epoch:9 | Test Acc: 0.5447
 Test site-USPS                      | Epoch:9 | Test Acc: 0.6333
 Test site-SynthDigits               | Epoch:9 | Test Acc: 0.3350
 Test site-MNIST-M                   | Epoch:9 | Test Acc: 0.2054
 Test site-SVHN                      | Epoch:9 | Test Acc: 0.2153
MNIST: 0.545, USPS: 0.633, SynthDigits: 0.335, MNIST-M: 0.205, SVHN: 0.215, 
Average Test Accuracy: 0.3868, domain std=0.1736, cluster std=-1.0000, individual std=0.1736, 
============ Train epoch 10 ============
 Site-MNIST                    | Train Loss: 1.8334 | Train Acc: 0.6523
 Site-MNIST                    | Train Loss: 1.8987 | Train Acc: 0.5489
 Site-USPS                     | Train Loss: 1.7658 | Train Acc: 0.6226
 Site-USPS                     | Train Loss: 1.7597 | Train Acc: 0.6538
 Site-SynthDigits              | Train Loss: 2.1680 | Train Acc: 0.2803
 Site-SynthDigits              | Train Loss: 2.1205 | Train Acc: 0.3749
 Site-MNIST-M                  | Train Loss: 2.2237 | Train Acc: 0.2561
 Site-MNIST-M                  | Train Loss: 2.2309 | Train Acc: 0.2278
 Site-SVHN                     | Train Loss: 2.2043 | Train Acc: 0.2588
 Site-SVHN                     | Train Loss: 2.2089 | Train Acc: 0.2332
 Site-MNIST                         | Val  Loss: 1.9115 | Val  Acc: 0.5543
 Site-MNIST                         | Val  Loss: 1.8811 | Val  Acc: 0.5971
 Site-USPS                          | Val  Loss: 1.8088 | Val  Acc: 0.5652
 Site-USPS                          | Val  Loss: 1.8034 | Val  Acc: 0.5971
 Site-SynthDigits                   | Val  Loss: 2.1297 | Val  Acc: 0.3587
 Site-SynthDigits                   | Val  Loss: 2.1472 | Val  Acc: 0.3129
 Site-MNIST-M                       | Val  Loss: 2.2400 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.2285 | Val  Acc: 0.2518
 Site-SVHN                          | Val  Loss: 2.1879 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1984 | Val  Acc: 0.2770
Average Valid Accuracy: 0.4036
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.5543
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.5971
 Best site-USPS                      | Epoch:10 | Val Acc: 0.5652
 Best site-USPS                      | Epoch:10 | Val Acc: 0.5971
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3587
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3129
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.2518
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2770
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 11 ============
 Site-MNIST                    | Train Loss: 1.8036 | Train Acc: 0.6550
 Site-MNIST                    | Train Loss: 1.8669 | Train Acc: 0.5641
 Site-USPS                     | Train Loss: 1.7329 | Train Acc: 0.6226
 Site-USPS                     | Train Loss: 1.7181 | Train Acc: 0.6673
 Site-SynthDigits              | Train Loss: 2.1551 | Train Acc: 0.2884
 Site-SynthDigits              | Train Loss: 2.1057 | Train Acc: 0.3794
 Site-MNIST-M                  | Train Loss: 2.2173 | Train Acc: 0.2642
 Site-MNIST-M                  | Train Loss: 2.2245 | Train Acc: 0.2368
 Site-SVHN                     | Train Loss: 2.1961 | Train Acc: 0.2588
 Site-SVHN                     | Train Loss: 2.2035 | Train Acc: 0.2359
 Site-MNIST                         | Val  Loss: 1.8810 | Val  Acc: 0.5652
 Site-MNIST                         | Val  Loss: 1.8489 | Val  Acc: 0.6079
 Site-USPS                          | Val  Loss: 1.7691 | Val  Acc: 0.5870
 Site-USPS                          | Val  Loss: 1.7634 | Val  Acc: 0.6223
 Site-SynthDigits                   | Val  Loss: 2.1156 | Val  Acc: 0.3587
 Site-SynthDigits                   | Val  Loss: 2.1336 | Val  Acc: 0.3129
 Site-MNIST-M                       | Val  Loss: 2.2345 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.2219 | Val  Acc: 0.2626
 Site-SVHN                          | Val  Loss: 2.1813 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1927 | Val  Acc: 0.2806
Average Valid Accuracy: 0.4130
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.5652
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6079
 Best site-USPS                      | Epoch:11 | Val Acc: 0.5870
 Best site-USPS                      | Epoch:11 | Val Acc: 0.6223
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3587
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3129
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.2626
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2806
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 12 ============
 Site-MNIST                    | Train Loss: 1.7684 | Train Acc: 0.6792
 Site-MNIST                    | Train Loss: 1.8386 | Train Acc: 0.5767
 Site-USPS                     | Train Loss: 1.6920 | Train Acc: 0.6388
 Site-USPS                     | Train Loss: 1.6800 | Train Acc: 0.6753
 Site-SynthDigits              | Train Loss: 2.1432 | Train Acc: 0.2992
 Site-SynthDigits              | Train Loss: 2.0907 | Train Acc: 0.3821
 Site-MNIST-M                  | Train Loss: 2.2110 | Train Acc: 0.2695
 Site-MNIST-M                  | Train Loss: 2.2177 | Train Acc: 0.2430
 Site-SVHN                     | Train Loss: 2.1936 | Train Acc: 0.2615
 Site-SVHN                     | Train Loss: 2.1979 | Train Acc: 0.2368
 Site-MNIST                         | Val  Loss: 1.8523 | Val  Acc: 0.5652
 Site-MNIST                         | Val  Loss: 1.8193 | Val  Acc: 0.6187
 Site-USPS                          | Val  Loss: 1.7333 | Val  Acc: 0.5870
 Site-USPS                          | Val  Loss: 1.7273 | Val  Acc: 0.6331
 Site-SynthDigits                   | Val  Loss: 2.1011 | Val  Acc: 0.3478
 Site-SynthDigits                   | Val  Loss: 2.1190 | Val  Acc: 0.3094
 Site-MNIST-M                       | Val  Loss: 2.2296 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.2153 | Val  Acc: 0.2734
 Site-SVHN                          | Val  Loss: 2.1753 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1871 | Val  Acc: 0.2878
Average Valid Accuracy: 0.4177
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.5652
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.6187
 Best site-USPS                      | Epoch:12 | Val Acc: 0.5870
 Best site-USPS                      | Epoch:12 | Val Acc: 0.6331
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.3478
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.3094
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.2734
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2878
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 13 ============
 Site-MNIST                    | Train Loss: 1.7354 | Train Acc: 0.6873
 Site-MNIST                    | Train Loss: 1.8100 | Train Acc: 0.5848
 Site-USPS                     | Train Loss: 1.6588 | Train Acc: 0.6604
 Site-USPS                     | Train Loss: 1.6420 | Train Acc: 0.6843
 Site-SynthDigits              | Train Loss: 2.1347 | Train Acc: 0.2938
 Site-SynthDigits              | Train Loss: 2.0763 | Train Acc: 0.3892
 Site-MNIST-M                  | Train Loss: 2.2039 | Train Acc: 0.2695
 Site-MNIST-M                  | Train Loss: 2.2113 | Train Acc: 0.2475
 Site-SVHN                     | Train Loss: 2.1915 | Train Acc: 0.2642
 Site-SVHN                     | Train Loss: 2.1931 | Train Acc: 0.2395
 Site-MNIST                         | Val  Loss: 1.8241 | Val  Acc: 0.5761
 Site-MNIST                         | Val  Loss: 1.7899 | Val  Acc: 0.6331
 Site-USPS                          | Val  Loss: 1.6977 | Val  Acc: 0.6196
 Site-USPS                          | Val  Loss: 1.6914 | Val  Acc: 0.6511
 Site-SynthDigits                   | Val  Loss: 2.0877 | Val  Acc: 0.3478
 Site-SynthDigits                   | Val  Loss: 2.1059 | Val  Acc: 0.3058
 Site-MNIST-M                       | Val  Loss: 2.2252 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 2.2091 | Val  Acc: 0.2770
 Site-SVHN                          | Val  Loss: 2.1689 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1816 | Val  Acc: 0.2878
Average Valid Accuracy: 0.4263
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.5761
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.6331
 Best site-USPS                      | Epoch:13 | Val Acc: 0.6196
 Best site-USPS                      | Epoch:13 | Val Acc: 0.6511
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.3478
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.3058
 Best site-MNIST-M                   | Epoch:13 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:13 | Val Acc: 0.2770
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.2878
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 14 ============
 Site-MNIST                    | Train Loss: 1.7069 | Train Acc: 0.7035
 Site-MNIST                    | Train Loss: 1.7829 | Train Acc: 0.6036
 Site-USPS                     | Train Loss: 1.6166 | Train Acc: 0.6765
 Site-USPS                     | Train Loss: 1.6041 | Train Acc: 0.6987
 Site-SynthDigits              | Train Loss: 2.1202 | Train Acc: 0.3019
 Site-SynthDigits              | Train Loss: 2.0617 | Train Acc: 0.3973
 Site-MNIST-M                  | Train Loss: 2.1977 | Train Acc: 0.2857
 Site-MNIST-M                  | Train Loss: 2.2047 | Train Acc: 0.2475
 Site-SVHN                     | Train Loss: 2.1831 | Train Acc: 0.2749
 Site-SVHN                     | Train Loss: 2.1874 | Train Acc: 0.2413
 Site-MNIST                         | Val  Loss: 1.7982 | Val  Acc: 0.5761
 Site-MNIST                         | Val  Loss: 1.7626 | Val  Acc: 0.6403
 Site-USPS                          | Val  Loss: 1.6616 | Val  Acc: 0.6304
 Site-USPS                          | Val  Loss: 1.6544 | Val  Acc: 0.6511
 Site-SynthDigits                   | Val  Loss: 2.0746 | Val  Acc: 0.3478
 Site-SynthDigits                   | Val  Loss: 2.0929 | Val  Acc: 0.3058
 Site-MNIST-M                       | Val  Loss: 2.2207 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 2.2031 | Val  Acc: 0.2806
 Site-SVHN                          | Val  Loss: 2.1629 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1763 | Val  Acc: 0.2914
Average Valid Accuracy: 0.4289
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.5761
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.6403
 Best site-USPS                      | Epoch:14 | Val Acc: 0.6304
 Best site-USPS                      | Epoch:14 | Val Acc: 0.6511
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.3478
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.3058
 Best site-MNIST-M                   | Epoch:14 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:14 | Val Acc: 0.2806
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.2914
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 15 ============
 Site-MNIST                    | Train Loss: 1.6798 | Train Acc: 0.7089
 Site-MNIST                    | Train Loss: 1.7554 | Train Acc: 0.6063
 Site-USPS                     | Train Loss: 1.5780 | Train Acc: 0.6873
 Site-USPS                     | Train Loss: 1.5717 | Train Acc: 0.7076
 Site-SynthDigits              | Train Loss: 2.1053 | Train Acc: 0.3154
 Site-SynthDigits              | Train Loss: 2.0475 | Train Acc: 0.4027
 Site-MNIST-M                  | Train Loss: 2.1919 | Train Acc: 0.2911
 Site-MNIST-M                  | Train Loss: 2.1980 | Train Acc: 0.2538
 Site-SVHN                     | Train Loss: 2.1802 | Train Acc: 0.2749
 Site-SVHN                     | Train Loss: 2.1829 | Train Acc: 0.2439
 Site-MNIST                         | Val  Loss: 1.7705 | Val  Acc: 0.5761
 Site-MNIST                         | Val  Loss: 1.7342 | Val  Acc: 0.6475
 Site-USPS                          | Val  Loss: 1.6310 | Val  Acc: 0.6304
 Site-USPS                          | Val  Loss: 1.6225 | Val  Acc: 0.6511
 Site-SynthDigits                   | Val  Loss: 2.0613 | Val  Acc: 0.3696
 Site-SynthDigits                   | Val  Loss: 2.0796 | Val  Acc: 0.3129
 Site-MNIST-M                       | Val  Loss: 2.2162 | Val  Acc: 0.2717
 Site-MNIST-M                       | Val  Loss: 2.1970 | Val  Acc: 0.2878
 Site-SVHN                          | Val  Loss: 2.1569 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1711 | Val  Acc: 0.2878
Average Valid Accuracy: 0.4328
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.5761
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.6475
 Best site-USPS                      | Epoch:15 | Val Acc: 0.6304
 Best site-USPS                      | Epoch:15 | Val Acc: 0.6511
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.3696
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.3129
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.2717
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.2878
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2878
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 16 ============
 Site-MNIST                    | Train Loss: 1.6480 | Train Acc: 0.7197
 Site-MNIST                    | Train Loss: 1.7277 | Train Acc: 0.6161
 Site-USPS                     | Train Loss: 1.5493 | Train Acc: 0.6900
 Site-USPS                     | Train Loss: 1.5401 | Train Acc: 0.7103
 Site-SynthDigits              | Train Loss: 2.0955 | Train Acc: 0.3154
 Site-SynthDigits              | Train Loss: 2.0318 | Train Acc: 0.4108
 Site-MNIST-M                  | Train Loss: 2.1870 | Train Acc: 0.2938
 Site-MNIST-M                  | Train Loss: 2.1913 | Train Acc: 0.2619
 Site-SVHN                     | Train Loss: 2.1767 | Train Acc: 0.2776
 Site-SVHN                     | Train Loss: 2.1778 | Train Acc: 0.2484
 Site-MNIST                         | Val  Loss: 1.7440 | Val  Acc: 0.5870
 Site-MNIST                         | Val  Loss: 1.7065 | Val  Acc: 0.6475
 Site-USPS                          | Val  Loss: 1.6016 | Val  Acc: 0.6304
 Site-USPS                          | Val  Loss: 1.5936 | Val  Acc: 0.6511
 Site-SynthDigits                   | Val  Loss: 2.0467 | Val  Acc: 0.3804
 Site-SynthDigits                   | Val  Loss: 2.0649 | Val  Acc: 0.3165
 Site-MNIST-M                       | Val  Loss: 2.2113 | Val  Acc: 0.2826
 Site-MNIST-M                       | Val  Loss: 2.1906 | Val  Acc: 0.2878
 Site-SVHN                          | Val  Loss: 2.1516 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1661 | Val  Acc: 0.2914
Average Valid Accuracy: 0.4379
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.5870
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.6475
 Best site-USPS                      | Epoch:16 | Val Acc: 0.6304
 Best site-USPS                      | Epoch:16 | Val Acc: 0.6511
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.3804
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.3165
 Best site-MNIST-M                   | Epoch:16 | Val Acc: 0.2826
 Best site-MNIST-M                   | Epoch:16 | Val Acc: 0.2878
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.2914
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 17 ============
 Site-MNIST                    | Train Loss: 1.6215 | Train Acc: 0.7224
 Site-MNIST                    | Train Loss: 1.7041 | Train Acc: 0.6242
 Site-USPS                     | Train Loss: 1.5217 | Train Acc: 0.6900
 Site-USPS                     | Train Loss: 1.5083 | Train Acc: 0.7229
 Site-SynthDigits              | Train Loss: 2.0818 | Train Acc: 0.3127
 Site-SynthDigits              | Train Loss: 2.0178 | Train Acc: 0.4179
 Site-MNIST-M                  | Train Loss: 2.1791 | Train Acc: 0.3019
 Site-MNIST-M                  | Train Loss: 2.1842 | Train Acc: 0.2583
 Site-SVHN                     | Train Loss: 2.1702 | Train Acc: 0.2749
 Site-SVHN                     | Train Loss: 2.1723 | Train Acc: 0.2502
 Site-MNIST                         | Val  Loss: 1.7208 | Val  Acc: 0.6087
 Site-MNIST                         | Val  Loss: 1.6826 | Val  Acc: 0.6583
 Site-USPS                          | Val  Loss: 1.5726 | Val  Acc: 0.6413
 Site-USPS                          | Val  Loss: 1.5615 | Val  Acc: 0.6547
 Site-SynthDigits                   | Val  Loss: 2.0339 | Val  Acc: 0.3913
 Site-SynthDigits                   | Val  Loss: 2.0523 | Val  Acc: 0.3237
 Site-MNIST-M                       | Val  Loss: 2.2066 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1840 | Val  Acc: 0.2770
 Site-SVHN                          | Val  Loss: 2.1459 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1606 | Val  Acc: 0.2914
Average Valid Accuracy: 0.4401
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.6087
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.6583
 Best site-USPS                      | Epoch:17 | Val Acc: 0.6413
 Best site-USPS                      | Epoch:17 | Val Acc: 0.6547
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.3913
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.3237
 Best site-MNIST-M                   | Epoch:17 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:17 | Val Acc: 0.2770
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.2914
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 18 ============
 Site-MNIST                    | Train Loss: 1.5999 | Train Acc: 0.7358
 Site-MNIST                    | Train Loss: 1.6817 | Train Acc: 0.6323
 Site-USPS                     | Train Loss: 1.4918 | Train Acc: 0.6954
 Site-USPS                     | Train Loss: 1.4771 | Train Acc: 0.7309
 Site-SynthDigits              | Train Loss: 2.0699 | Train Acc: 0.3235
 Site-SynthDigits              | Train Loss: 2.0041 | Train Acc: 0.4188
 Site-MNIST-M                  | Train Loss: 2.1721 | Train Acc: 0.3019
 Site-MNIST-M                  | Train Loss: 2.1781 | Train Acc: 0.2628
 Site-SVHN                     | Train Loss: 2.1682 | Train Acc: 0.2749
 Site-SVHN                     | Train Loss: 2.1678 | Train Acc: 0.2520
 Site-MNIST                         | Val  Loss: 1.6983 | Val  Acc: 0.6196
 Site-MNIST                         | Val  Loss: 1.6594 | Val  Acc: 0.6655
 Site-USPS                          | Val  Loss: 1.5395 | Val  Acc: 0.6630
 Site-USPS                          | Val  Loss: 1.5310 | Val  Acc: 0.6727
 Site-SynthDigits                   | Val  Loss: 2.0212 | Val  Acc: 0.3804
 Site-SynthDigits                   | Val  Loss: 2.0399 | Val  Acc: 0.3309
 Site-MNIST-M                       | Val  Loss: 2.2023 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1782 | Val  Acc: 0.2806
 Site-SVHN                          | Val  Loss: 2.1402 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1554 | Val  Acc: 0.2914
Average Valid Accuracy: 0.4458
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.6196
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.6655
 Best site-USPS                      | Epoch:18 | Val Acc: 0.6630
 Best site-USPS                      | Epoch:18 | Val Acc: 0.6727
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.3804
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.3309
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.2806
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.2914
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 19 ============
 Site-MNIST                    | Train Loss: 1.5736 | Train Acc: 0.7385
 Site-MNIST                    | Train Loss: 1.6554 | Train Acc: 0.6377
 Site-USPS                     | Train Loss: 1.4706 | Train Acc: 0.7143
 Site-USPS                     | Train Loss: 1.4478 | Train Acc: 0.7408
 Site-SynthDigits              | Train Loss: 2.0609 | Train Acc: 0.3369
 Site-SynthDigits              | Train Loss: 1.9913 | Train Acc: 0.4269
 Site-MNIST-M                  | Train Loss: 2.1653 | Train Acc: 0.3046
 Site-MNIST-M                  | Train Loss: 2.1715 | Train Acc: 0.2691
 Site-SVHN                     | Train Loss: 2.1634 | Train Acc: 0.2749
 Site-SVHN                     | Train Loss: 2.1627 | Train Acc: 0.2520
 Site-MNIST                         | Val  Loss: 1.6731 | Val  Acc: 0.6196
 Site-MNIST                         | Val  Loss: 1.6326 | Val  Acc: 0.6655
 Site-USPS                          | Val  Loss: 1.5130 | Val  Acc: 0.6630
 Site-USPS                          | Val  Loss: 1.5012 | Val  Acc: 0.6871
 Site-SynthDigits                   | Val  Loss: 2.0083 | Val  Acc: 0.4022
 Site-SynthDigits                   | Val  Loss: 2.0277 | Val  Acc: 0.3525
 Site-MNIST-M                       | Val  Loss: 2.1964 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.1721 | Val  Acc: 0.2914
 Site-SVHN                          | Val  Loss: 2.1339 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1505 | Val  Acc: 0.2914
Average Valid Accuracy: 0.4516
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.6196
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.6655
 Best site-USPS                      | Epoch:19 | Val Acc: 0.6630
 Best site-USPS                      | Epoch:19 | Val Acc: 0.6871
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4022
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.3525
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.2914
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.2914
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
 Test site-MNIST                     | Epoch:19 | Test Acc: 0.6483
 Test site-USPS                      | Epoch:19 | Test Acc: 0.7441
 Test site-SynthDigits               | Epoch:19 | Test Acc: 0.3853
 Test site-MNIST-M                   | Epoch:19 | Test Acc: 0.2560
 Test site-SVHN                      | Epoch:19 | Test Acc: 0.2287
MNIST: 0.648, USPS: 0.744, SynthDigits: 0.385, MNIST-M: 0.256, SVHN: 0.229, 
Average Test Accuracy: 0.4525, domain std=0.2081, cluster std=-1.0000, individual std=0.2081, 
============ Train epoch 20 ============
 Site-MNIST                    | Train Loss: 1.5513 | Train Acc: 0.7358
 Site-MNIST                    | Train Loss: 1.6329 | Train Acc: 0.6484
 Site-USPS                     | Train Loss: 1.4421 | Train Acc: 0.7116
 Site-USPS                     | Train Loss: 1.4239 | Train Acc: 0.7381
 Site-SynthDigits              | Train Loss: 2.0457 | Train Acc: 0.3477
 Site-SynthDigits              | Train Loss: 1.9756 | Train Acc: 0.4296
 Site-MNIST-M                  | Train Loss: 2.1627 | Train Acc: 0.3154
 Site-MNIST-M                  | Train Loss: 2.1656 | Train Acc: 0.2771
 Site-SVHN                     | Train Loss: 2.1596 | Train Acc: 0.2749
 Site-SVHN                     | Train Loss: 2.1572 | Train Acc: 0.2538
 Site-MNIST                         | Val  Loss: 1.6500 | Val  Acc: 0.6196
 Site-MNIST                         | Val  Loss: 1.6096 | Val  Acc: 0.6727
 Site-USPS                          | Val  Loss: 1.4905 | Val  Acc: 0.6522
 Site-USPS                          | Val  Loss: 1.4788 | Val  Acc: 0.6835
 Site-SynthDigits                   | Val  Loss: 1.9941 | Val  Acc: 0.4022
 Site-SynthDigits                   | Val  Loss: 2.0132 | Val  Acc: 0.3597
 Site-MNIST-M                       | Val  Loss: 2.1923 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1656 | Val  Acc: 0.2986
 Site-SVHN                          | Val  Loss: 2.1292 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1460 | Val  Acc: 0.2950
Average Valid Accuracy: 0.4538
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.6196
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.6727
 Best site-USPS                      | Epoch:20 | Val Acc: 0.6522
 Best site-USPS                      | Epoch:20 | Val Acc: 0.6835
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.4022
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.3597
 Best site-MNIST-M                   | Epoch:20 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:20 | Val Acc: 0.2986
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.2950
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 21 ============
 Site-MNIST                    | Train Loss: 1.5175 | Train Acc: 0.7358
 Site-MNIST                    | Train Loss: 1.6120 | Train Acc: 0.6556
 Site-USPS                     | Train Loss: 1.4204 | Train Acc: 0.7224
 Site-USPS                     | Train Loss: 1.3952 | Train Acc: 0.7525
 Site-SynthDigits              | Train Loss: 2.0363 | Train Acc: 0.3639
 Site-SynthDigits              | Train Loss: 1.9629 | Train Acc: 0.4323
 Site-MNIST-M                  | Train Loss: 2.1517 | Train Acc: 0.3235
 Site-MNIST-M                  | Train Loss: 2.1583 | Train Acc: 0.2888
 Site-SVHN                     | Train Loss: 2.1512 | Train Acc: 0.2776
 Site-SVHN                     | Train Loss: 2.1522 | Train Acc: 0.2556
 Site-MNIST                         | Val  Loss: 1.6297 | Val  Acc: 0.6196
 Site-MNIST                         | Val  Loss: 1.5889 | Val  Acc: 0.6727
 Site-USPS                          | Val  Loss: 1.4632 | Val  Acc: 0.6848
 Site-USPS                          | Val  Loss: 1.4504 | Val  Acc: 0.6978
 Site-SynthDigits                   | Val  Loss: 1.9824 | Val  Acc: 0.4130
 Site-SynthDigits                   | Val  Loss: 2.0017 | Val  Acc: 0.3705
 Site-MNIST-M                       | Val  Loss: 2.1870 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.1595 | Val  Acc: 0.3129
 Site-SVHN                          | Val  Loss: 2.1223 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1406 | Val  Acc: 0.2950
Average Valid Accuracy: 0.4621
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.6196
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.6727
 Best site-USPS                      | Epoch:21 | Val Acc: 0.6848
 Best site-USPS                      | Epoch:21 | Val Acc: 0.6978
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.4130
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.3705
 Best site-MNIST-M                   | Epoch:21 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:21 | Val Acc: 0.3129
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.2950
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 22 ============
 Site-MNIST                    | Train Loss: 1.4978 | Train Acc: 0.7412
 Site-MNIST                    | Train Loss: 1.5906 | Train Acc: 0.6628
 Site-USPS                     | Train Loss: 1.3897 | Train Acc: 0.7305
 Site-USPS                     | Train Loss: 1.3708 | Train Acc: 0.7632
 Site-SynthDigits              | Train Loss: 2.0247 | Train Acc: 0.3585
 Site-SynthDigits              | Train Loss: 1.9506 | Train Acc: 0.4350
 Site-MNIST-M                  | Train Loss: 2.1463 | Train Acc: 0.3261
 Site-MNIST-M                  | Train Loss: 2.1511 | Train Acc: 0.2888
 Site-SVHN                     | Train Loss: 2.1506 | Train Acc: 0.2776
 Site-SVHN                     | Train Loss: 2.1473 | Train Acc: 0.2565
 Site-MNIST                         | Val  Loss: 1.6089 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.5673 | Val  Acc: 0.6799
 Site-USPS                          | Val  Loss: 1.4387 | Val  Acc: 0.6739
 Site-USPS                          | Val  Loss: 1.4252 | Val  Acc: 0.7014
 Site-SynthDigits                   | Val  Loss: 1.9699 | Val  Acc: 0.4130
 Site-SynthDigits                   | Val  Loss: 1.9899 | Val  Acc: 0.3741
 Site-MNIST-M                       | Val  Loss: 2.1812 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 2.1537 | Val  Acc: 0.3201
 Site-SVHN                          | Val  Loss: 2.1159 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1356 | Val  Acc: 0.2986
Average Valid Accuracy: 0.4678
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.6799
 Best site-USPS                      | Epoch:22 | Val Acc: 0.6739
 Best site-USPS                      | Epoch:22 | Val Acc: 0.7014
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.4130
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.3741
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.3201
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.2986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 23 ============
 Site-MNIST                    | Train Loss: 1.4807 | Train Acc: 0.7493
 Site-MNIST                    | Train Loss: 1.5710 | Train Acc: 0.6682
 Site-USPS                     | Train Loss: 1.3644 | Train Acc: 0.7466
 Site-USPS                     | Train Loss: 1.3444 | Train Acc: 0.7794
 Site-SynthDigits              | Train Loss: 2.0156 | Train Acc: 0.3612
 Site-SynthDigits              | Train Loss: 1.9380 | Train Acc: 0.4377
 Site-MNIST-M                  | Train Loss: 2.1330 | Train Acc: 0.3450
 Site-MNIST-M                  | Train Loss: 2.1434 | Train Acc: 0.2897
 Site-SVHN                     | Train Loss: 2.1469 | Train Acc: 0.2803
 Site-SVHN                     | Train Loss: 2.1419 | Train Acc: 0.2610
 Site-MNIST                         | Val  Loss: 1.5909 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.5494 | Val  Acc: 0.6835
 Site-USPS                          | Val  Loss: 1.4132 | Val  Acc: 0.6739
 Site-USPS                          | Val  Loss: 1.3982 | Val  Acc: 0.7086
 Site-SynthDigits                   | Val  Loss: 1.9585 | Val  Acc: 0.4130
 Site-SynthDigits                   | Val  Loss: 1.9793 | Val  Acc: 0.3813
 Site-MNIST-M                       | Val  Loss: 2.1747 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1468 | Val  Acc: 0.3201
 Site-SVHN                          | Val  Loss: 2.1092 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1298 | Val  Acc: 0.2986
Average Valid Accuracy: 0.4686
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.6835
 Best site-USPS                      | Epoch:23 | Val Acc: 0.6739
 Best site-USPS                      | Epoch:23 | Val Acc: 0.7086
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.4130
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.3813
 Best site-MNIST-M                   | Epoch:23 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:23 | Val Acc: 0.3201
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.2986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 24 ============
 Site-MNIST                    | Train Loss: 1.4657 | Train Acc: 0.7547
 Site-MNIST                    | Train Loss: 1.5528 | Train Acc: 0.6717
 Site-USPS                     | Train Loss: 1.3442 | Train Acc: 0.7574
 Site-USPS                     | Train Loss: 1.3225 | Train Acc: 0.7776
 Site-SynthDigits              | Train Loss: 2.0023 | Train Acc: 0.3666
 Site-SynthDigits              | Train Loss: 1.9239 | Train Acc: 0.4430
 Site-MNIST-M                  | Train Loss: 2.1308 | Train Acc: 0.3423
 Site-MNIST-M                  | Train Loss: 2.1384 | Train Acc: 0.2951
 Site-SVHN                     | Train Loss: 2.1446 | Train Acc: 0.2803
 Site-SVHN                     | Train Loss: 2.1354 | Train Acc: 0.2655
 Site-MNIST                         | Val  Loss: 1.5715 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.5307 | Val  Acc: 0.6942
 Site-USPS                          | Val  Loss: 1.3938 | Val  Acc: 0.6848
 Site-USPS                          | Val  Loss: 1.3781 | Val  Acc: 0.7194
 Site-SynthDigits                   | Val  Loss: 1.9459 | Val  Acc: 0.4348
 Site-SynthDigits                   | Val  Loss: 1.9664 | Val  Acc: 0.3813
 Site-MNIST-M                       | Val  Loss: 2.1706 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.1406 | Val  Acc: 0.3094
 Site-SVHN                          | Val  Loss: 2.1025 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1241 | Val  Acc: 0.2986
Average Valid Accuracy: 0.4740
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.6630
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.6942
 Best site-USPS                      | Epoch:24 | Val Acc: 0.6848
 Best site-USPS                      | Epoch:24 | Val Acc: 0.7194
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.4348
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.3813
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.3094
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.2986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 25 ============
 Site-MNIST                    | Train Loss: 1.4486 | Train Acc: 0.7574
 Site-MNIST                    | Train Loss: 1.5343 | Train Acc: 0.6735
 Site-USPS                     | Train Loss: 1.3241 | Train Acc: 0.7682
 Site-USPS                     | Train Loss: 1.3006 | Train Acc: 0.7883
 Site-SynthDigits              | Train Loss: 1.9909 | Train Acc: 0.3693
 Site-SynthDigits              | Train Loss: 1.9109 | Train Acc: 0.4484
 Site-MNIST-M                  | Train Loss: 2.1224 | Train Acc: 0.3585
 Site-MNIST-M                  | Train Loss: 2.1320 | Train Acc: 0.2960
 Site-SVHN                     | Train Loss: 2.1375 | Train Acc: 0.2911
 Site-SVHN                     | Train Loss: 2.1289 | Train Acc: 0.2700
 Site-MNIST                         | Val  Loss: 1.5535 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.5126 | Val  Acc: 0.6978
 Site-USPS                          | Val  Loss: 1.3739 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.3567 | Val  Acc: 0.7266
 Site-SynthDigits                   | Val  Loss: 1.9331 | Val  Acc: 0.4348
 Site-SynthDigits                   | Val  Loss: 1.9546 | Val  Acc: 0.3849
 Site-MNIST-M                       | Val  Loss: 2.1658 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1330 | Val  Acc: 0.3201
 Site-SVHN                          | Val  Loss: 2.0959 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.1188 | Val  Acc: 0.3058
Average Valid Accuracy: 0.4805
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.6630
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.6978
 Best site-USPS                      | Epoch:25 | Val Acc: 0.6957
 Best site-USPS                      | Epoch:25 | Val Acc: 0.7266
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.4348
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.3849
 Best site-MNIST-M                   | Epoch:25 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:25 | Val Acc: 0.3201
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.3058
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 26 ============
 Site-MNIST                    | Train Loss: 1.4250 | Train Acc: 0.7574
 Site-MNIST                    | Train Loss: 1.5160 | Train Acc: 0.6735
 Site-USPS                     | Train Loss: 1.2875 | Train Acc: 0.7736
 Site-USPS                     | Train Loss: 1.2741 | Train Acc: 0.7955
 Site-SynthDigits              | Train Loss: 1.9811 | Train Acc: 0.3801
 Site-SynthDigits              | Train Loss: 1.8992 | Train Acc: 0.4511
 Site-MNIST-M                  | Train Loss: 2.1033 | Train Acc: 0.3612
 Site-MNIST-M                  | Train Loss: 2.1242 | Train Acc: 0.2969
 Site-SVHN                     | Train Loss: 2.1326 | Train Acc: 0.2911
 Site-SVHN                     | Train Loss: 2.1233 | Train Acc: 0.2709
 Site-MNIST                         | Val  Loss: 1.5362 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.4956 | Val  Acc: 0.7050
 Site-USPS                          | Val  Loss: 1.3486 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.3302 | Val  Acc: 0.7338
 Site-SynthDigits                   | Val  Loss: 1.9203 | Val  Acc: 0.4239
 Site-SynthDigits                   | Val  Loss: 1.9446 | Val  Acc: 0.3813
 Site-MNIST-M                       | Val  Loss: 2.1614 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.1251 | Val  Acc: 0.3201
 Site-SVHN                          | Val  Loss: 2.0875 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.1131 | Val  Acc: 0.3058
Average Valid Accuracy: 0.4805
============ Train epoch 27 ============
 Site-MNIST                    | Train Loss: 1.4144 | Train Acc: 0.7601
 Site-MNIST                    | Train Loss: 1.4986 | Train Acc: 0.6807
 Site-USPS                     | Train Loss: 1.2726 | Train Acc: 0.7817
 Site-USPS                     | Train Loss: 1.2537 | Train Acc: 0.8009
 Site-SynthDigits              | Train Loss: 1.9685 | Train Acc: 0.3854
 Site-SynthDigits              | Train Loss: 1.8859 | Train Acc: 0.4565
 Site-MNIST-M                  | Train Loss: 2.1032 | Train Acc: 0.3585
 Site-MNIST-M                  | Train Loss: 2.1188 | Train Acc: 0.3004
 Site-SVHN                     | Train Loss: 2.1304 | Train Acc: 0.2965
 Site-SVHN                     | Train Loss: 2.1164 | Train Acc: 0.2744
 Site-MNIST                         | Val  Loss: 1.5183 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.4785 | Val  Acc: 0.7230
 Site-USPS                          | Val  Loss: 1.3299 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.3102 | Val  Acc: 0.7410
 Site-SynthDigits                   | Val  Loss: 1.9079 | Val  Acc: 0.4239
 Site-SynthDigits                   | Val  Loss: 1.9325 | Val  Acc: 0.3849
 Site-MNIST-M                       | Val  Loss: 2.1602 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1180 | Val  Acc: 0.3309
 Site-SVHN                          | Val  Loss: 2.0810 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1074 | Val  Acc: 0.3094
Average Valid Accuracy: 0.4870
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.6739
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.7230
 Best site-USPS                      | Epoch:27 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:27 | Val Acc: 0.7410
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.4239
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.3849
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.3309
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.3094
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 28 ============
 Site-MNIST                    | Train Loss: 1.3895 | Train Acc: 0.7682
 Site-MNIST                    | Train Loss: 1.4815 | Train Acc: 0.6780
 Site-USPS                     | Train Loss: 1.2591 | Train Acc: 0.7817
 Site-USPS                     | Train Loss: 1.2358 | Train Acc: 0.7991
 Site-SynthDigits              | Train Loss: 1.9552 | Train Acc: 0.3935
 Site-SynthDigits              | Train Loss: 1.8713 | Train Acc: 0.4529
 Site-MNIST-M                  | Train Loss: 2.0924 | Train Acc: 0.3612
 Site-MNIST-M                  | Train Loss: 2.1156 | Train Acc: 0.3013
 Site-SVHN                     | Train Loss: 2.1236 | Train Acc: 0.2965
 Site-SVHN                     | Train Loss: 2.1072 | Train Acc: 0.2771
 Site-MNIST                         | Val  Loss: 1.5009 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.4631 | Val  Acc: 0.7230
 Site-USPS                          | Val  Loss: 1.3131 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.2937 | Val  Acc: 0.7446
 Site-SynthDigits                   | Val  Loss: 1.8924 | Val  Acc: 0.4348
 Site-SynthDigits                   | Val  Loss: 1.9182 | Val  Acc: 0.3957
 Site-MNIST-M                       | Val  Loss: 2.1651 | Val  Acc: 0.2065
 Site-MNIST-M                       | Val  Loss: 2.1120 | Val  Acc: 0.3237
 Site-SVHN                          | Val  Loss: 2.0718 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0992 | Val  Acc: 0.3165
Average Valid Accuracy: 0.4841
============ Train epoch 29 ============
 Site-MNIST                    | Train Loss: 1.3808 | Train Acc: 0.7628
 Site-MNIST                    | Train Loss: 1.4692 | Train Acc: 0.6807
 Site-USPS                     | Train Loss: 1.2324 | Train Acc: 0.7790
 Site-USPS                     | Train Loss: 1.2186 | Train Acc: 0.8018
 Site-SynthDigits              | Train Loss: 1.9394 | Train Acc: 0.4016
 Site-SynthDigits              | Train Loss: 1.8534 | Train Acc: 0.4601
 Site-MNIST-M                  | Train Loss: 2.0815 | Train Acc: 0.3558
 Site-MNIST-M                  | Train Loss: 2.1074 | Train Acc: 0.3013
 Site-SVHN                     | Train Loss: 2.1164 | Train Acc: 0.3046
 Site-SVHN                     | Train Loss: 2.0948 | Train Acc: 0.2924
 Site-MNIST                         | Val  Loss: 1.4855 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.4543 | Val  Acc: 0.7302
 Site-USPS                          | Val  Loss: 1.2994 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.2748 | Val  Acc: 0.7518
 Site-SynthDigits                   | Val  Loss: 1.8694 | Val  Acc: 0.4457
 Site-SynthDigits                   | Val  Loss: 1.9001 | Val  Acc: 0.4101
 Site-MNIST-M                       | Val  Loss: 2.1618 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.1001 | Val  Acc: 0.3345
 Site-SVHN                          | Val  Loss: 2.0607 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0879 | Val  Acc: 0.3309
Average Valid Accuracy: 0.4916
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.6739
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.7302
 Best site-USPS                      | Epoch:29 | Val Acc: 0.6957
 Best site-USPS                      | Epoch:29 | Val Acc: 0.7518
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.4457
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.4101
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.3345
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3309
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
 Test site-MNIST                     | Epoch:29 | Test Acc: 0.6866
 Test site-USPS                      | Epoch:29 | Test Acc: 0.8226
 Test site-SynthDigits               | Epoch:29 | Test Acc: 0.4341
 Test site-MNIST-M                   | Epoch:29 | Test Acc: 0.2941
 Test site-SVHN                      | Epoch:29 | Test Acc: 0.2617
MNIST: 0.687, USPS: 0.823, SynthDigits: 0.434, MNIST-M: 0.294, SVHN: 0.262, 
Average Test Accuracy: 0.4998, domain std=0.2202, cluster std=-1.0000, individual std=0.2202, 
============ Train epoch 30 ============
 Site-MNIST                    | Train Loss: 1.3675 | Train Acc: 0.7574
 Site-MNIST                    | Train Loss: 1.4542 | Train Acc: 0.6816
 Site-USPS                     | Train Loss: 1.2247 | Train Acc: 0.8032
 Site-USPS                     | Train Loss: 1.2008 | Train Acc: 0.8054
 Site-SynthDigits              | Train Loss: 1.9207 | Train Acc: 0.4070
 Site-SynthDigits              | Train Loss: 1.8350 | Train Acc: 0.4655
 Site-MNIST-M                  | Train Loss: 2.0717 | Train Acc: 0.3666
 Site-MNIST-M                  | Train Loss: 2.0972 | Train Acc: 0.3076
 Site-SVHN                     | Train Loss: 2.1027 | Train Acc: 0.3019
 Site-SVHN                     | Train Loss: 2.0854 | Train Acc: 0.2987
 Site-MNIST                         | Val  Loss: 1.4690 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.4404 | Val  Acc: 0.7194
 Site-USPS                          | Val  Loss: 1.2824 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.2566 | Val  Acc: 0.7770
 Site-SynthDigits                   | Val  Loss: 1.8486 | Val  Acc: 0.4457
 Site-SynthDigits                   | Val  Loss: 1.8825 | Val  Acc: 0.4173
 Site-MNIST-M                       | Val  Loss: 2.1460 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.0841 | Val  Acc: 0.3381
 Site-SVHN                          | Val  Loss: 2.0525 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0783 | Val  Acc: 0.3309
Average Valid Accuracy: 0.4941
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.6739
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.7194
 Best site-USPS                      | Epoch:30 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:30 | Val Acc: 0.7770
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.4457
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.4173
 Best site-MNIST-M                   | Epoch:30 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:30 | Val Acc: 0.3381
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.3309
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 31 ============
 Site-MNIST                    | Train Loss: 1.3529 | Train Acc: 0.7574
 Site-MNIST                    | Train Loss: 1.4345 | Train Acc: 0.6843
 Site-USPS                     | Train Loss: 1.1972 | Train Acc: 0.8167
 Site-USPS                     | Train Loss: 1.1790 | Train Acc: 0.8143
 Site-SynthDigits              | Train Loss: 1.9103 | Train Acc: 0.4016
 Site-SynthDigits              | Train Loss: 1.8207 | Train Acc: 0.4691
 Site-MNIST-M                  | Train Loss: 2.0518 | Train Acc: 0.3585
 Site-MNIST-M                  | Train Loss: 2.0864 | Train Acc: 0.3067
 Site-SVHN                     | Train Loss: 2.1014 | Train Acc: 0.2992
 Site-SVHN                     | Train Loss: 2.0786 | Train Acc: 0.3022
 Site-MNIST                         | Val  Loss: 1.4494 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 1.4211 | Val  Acc: 0.7230
 Site-USPS                          | Val  Loss: 1.2611 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.2340 | Val  Acc: 0.7770
 Site-SynthDigits                   | Val  Loss: 1.8344 | Val  Acc: 0.4457
 Site-SynthDigits                   | Val  Loss: 1.8691 | Val  Acc: 0.4173
 Site-MNIST-M                       | Val  Loss: 2.1318 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.0704 | Val  Acc: 0.3345
 Site-SVHN                          | Val  Loss: 2.0433 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0718 | Val  Acc: 0.3237
Average Valid Accuracy: 0.4945
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.7230
 Best site-USPS                      | Epoch:31 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:31 | Val Acc: 0.7770
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.4457
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.4173
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.3345
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.3237
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 32 ============
 Site-MNIST                    | Train Loss: 1.3274 | Train Acc: 0.7574
 Site-MNIST                    | Train Loss: 1.4181 | Train Acc: 0.6744
 Site-USPS                     | Train Loss: 1.1835 | Train Acc: 0.8167
 Site-USPS                     | Train Loss: 1.1628 | Train Acc: 0.8170
 Site-SynthDigits              | Train Loss: 1.8987 | Train Acc: 0.4016
 Site-SynthDigits              | Train Loss: 1.8034 | Train Acc: 0.4870
 Site-MNIST-M                  | Train Loss: 2.0457 | Train Acc: 0.3639
 Site-MNIST-M                  | Train Loss: 2.0788 | Train Acc: 0.3121
 Site-SVHN                     | Train Loss: 2.0961 | Train Acc: 0.3181
 Site-SVHN                     | Train Loss: 2.0713 | Train Acc: 0.3022
 Site-MNIST                         | Val  Loss: 1.4309 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 1.4048 | Val  Acc: 0.7158
 Site-USPS                          | Val  Loss: 1.2435 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 1.2164 | Val  Acc: 0.7914
 Site-SynthDigits                   | Val  Loss: 1.8140 | Val  Acc: 0.4565
 Site-SynthDigits                   | Val  Loss: 1.8509 | Val  Acc: 0.4209
 Site-MNIST-M                       | Val  Loss: 2.1180 | Val  Acc: 0.2174
 Site-MNIST-M                       | Val  Loss: 2.0599 | Val  Acc: 0.3417
 Site-SVHN                          | Val  Loss: 2.0357 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0644 | Val  Acc: 0.3165
Average Valid Accuracy: 0.4999
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.7158
 Best site-USPS                      | Epoch:32 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:32 | Val Acc: 0.7914
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.4565
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.4209
 Best site-MNIST-M                   | Epoch:32 | Val Acc: 0.2174
 Best site-MNIST-M                   | Epoch:32 | Val Acc: 0.3417
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.3165
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 33 ============
 Site-MNIST                    | Train Loss: 1.3154 | Train Acc: 0.7574
 Site-MNIST                    | Train Loss: 1.4029 | Train Acc: 0.6771
 Site-USPS                     | Train Loss: 1.1695 | Train Acc: 0.8221
 Site-USPS                     | Train Loss: 1.1507 | Train Acc: 0.8224
 Site-SynthDigits              | Train Loss: 1.8806 | Train Acc: 0.4016
 Site-SynthDigits              | Train Loss: 1.7859 | Train Acc: 0.4969
 Site-MNIST-M                  | Train Loss: 2.0379 | Train Acc: 0.3612
 Site-MNIST-M                  | Train Loss: 2.0700 | Train Acc: 0.3211
 Site-SVHN                     | Train Loss: 2.0885 | Train Acc: 0.3181
 Site-SVHN                     | Train Loss: 2.0622 | Train Acc: 0.3022
 Site-MNIST                         | Val  Loss: 1.4136 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.3888 | Val  Acc: 0.7194
 Site-USPS                          | Val  Loss: 1.2337 | Val  Acc: 0.7609
 Site-USPS                          | Val  Loss: 1.2047 | Val  Acc: 0.8094
 Site-SynthDigits                   | Val  Loss: 1.7972 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.8333 | Val  Acc: 0.4317
 Site-MNIST-M                       | Val  Loss: 2.1070 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.0478 | Val  Acc: 0.3525
 Site-SVHN                          | Val  Loss: 2.0266 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0557 | Val  Acc: 0.3165
Average Valid Accuracy: 0.5075
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.6739
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.7194
 Best site-USPS                      | Epoch:33 | Val Acc: 0.7609
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8094
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.4674
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.4317
 Best site-MNIST-M                   | Epoch:33 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:33 | Val Acc: 0.3525
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.3165
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 34 ============
 Site-MNIST                    | Train Loss: 1.2954 | Train Acc: 0.7655
 Site-MNIST                    | Train Loss: 1.3852 | Train Acc: 0.6834
 Site-USPS                     | Train Loss: 1.1611 | Train Acc: 0.8221
 Site-USPS                     | Train Loss: 1.1376 | Train Acc: 0.8242
 Site-SynthDigits              | Train Loss: 1.8679 | Train Acc: 0.4124
 Site-SynthDigits              | Train Loss: 1.7718 | Train Acc: 0.5013
 Site-MNIST-M                  | Train Loss: 2.0313 | Train Acc: 0.3639
 Site-MNIST-M                  | Train Loss: 2.0626 | Train Acc: 0.3247
 Site-SVHN                     | Train Loss: 2.0786 | Train Acc: 0.3235
 Site-SVHN                     | Train Loss: 2.0543 | Train Acc: 0.3121
 Site-MNIST                         | Val  Loss: 1.3955 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 1.3716 | Val  Acc: 0.7230
 Site-USPS                          | Val  Loss: 1.2208 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 1.1907 | Val  Acc: 0.8094
 Site-SynthDigits                   | Val  Loss: 1.7824 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.8174 | Val  Acc: 0.4424
 Site-MNIST-M                       | Val  Loss: 2.0993 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 2.0394 | Val  Acc: 0.3669
 Site-SVHN                          | Val  Loss: 2.0181 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0489 | Val  Acc: 0.3309
Average Valid Accuracy: 0.5162
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.7230
 Best site-USPS                      | Epoch:34 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:34 | Val Acc: 0.8094
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.4674
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.4424
 Best site-MNIST-M                   | Epoch:34 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:34 | Val Acc: 0.3669
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.3309
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 35 ============
 Site-MNIST                    | Train Loss: 1.2757 | Train Acc: 0.7628
 Site-MNIST                    | Train Loss: 1.3643 | Train Acc: 0.6897
 Site-USPS                     | Train Loss: 1.1335 | Train Acc: 0.8275
 Site-USPS                     | Train Loss: 1.1168 | Train Acc: 0.8278
 Site-SynthDigits              | Train Loss: 1.8571 | Train Acc: 0.4178
 Site-SynthDigits              | Train Loss: 1.7612 | Train Acc: 0.5022
 Site-MNIST-M                  | Train Loss: 2.0228 | Train Acc: 0.3639
 Site-MNIST-M                  | Train Loss: 2.0524 | Train Acc: 0.3300
 Site-SVHN                     | Train Loss: 2.0829 | Train Acc: 0.3181
 Site-SVHN                     | Train Loss: 2.0513 | Train Acc: 0.3067
 Site-MNIST                         | Val  Loss: 1.3753 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 1.3503 | Val  Acc: 0.7266
 Site-USPS                          | Val  Loss: 1.2000 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 1.1705 | Val  Acc: 0.8201
 Site-SynthDigits                   | Val  Loss: 1.7723 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.8084 | Val  Acc: 0.4460
 Site-MNIST-M                       | Val  Loss: 2.0891 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.0301 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 2.0144 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0443 | Val  Acc: 0.3273
Average Valid Accuracy: 0.5165
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.7266
 Best site-USPS                      | Epoch:35 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:35 | Val Acc: 0.8201
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.4674
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.4460
 Best site-MNIST-M                   | Epoch:35 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:35 | Val Acc: 0.3561
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.3273
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 36 ============
 Site-MNIST                    | Train Loss: 1.2619 | Train Acc: 0.7628
 Site-MNIST                    | Train Loss: 1.3529 | Train Acc: 0.6906
 Site-USPS                     | Train Loss: 1.1246 | Train Acc: 0.8221
 Site-USPS                     | Train Loss: 1.1017 | Train Acc: 0.8269
 Site-SynthDigits              | Train Loss: 1.8407 | Train Acc: 0.4205
 Site-SynthDigits              | Train Loss: 1.7467 | Train Acc: 0.5058
 Site-MNIST-M                  | Train Loss: 2.0221 | Train Acc: 0.3801
 Site-MNIST-M                  | Train Loss: 2.0496 | Train Acc: 0.3265
 Site-SVHN                     | Train Loss: 2.0687 | Train Acc: 0.3235
 Site-SVHN                     | Train Loss: 2.0432 | Train Acc: 0.3103
 Site-MNIST                         | Val  Loss: 1.3615 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 1.3391 | Val  Acc: 0.7302
 Site-USPS                          | Val  Loss: 1.1874 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 1.1566 | Val  Acc: 0.8129
 Site-SynthDigits                   | Val  Loss: 1.7545 | Val  Acc: 0.4565
 Site-SynthDigits                   | Val  Loss: 1.7926 | Val  Acc: 0.4424
 Site-MNIST-M                       | Val  Loss: 2.0843 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 2.0255 | Val  Acc: 0.3705
 Site-SVHN                          | Val  Loss: 2.0054 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0366 | Val  Acc: 0.3345
Average Valid Accuracy: 0.5169
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.7302
 Best site-USPS                      | Epoch:36 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8129
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.4565
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.4424
 Best site-MNIST-M                   | Epoch:36 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:36 | Val Acc: 0.3705
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.3345
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 37 ============
 Site-MNIST                    | Train Loss: 1.2525 | Train Acc: 0.7628
 Site-MNIST                    | Train Loss: 1.3327 | Train Acc: 0.7022
 Site-USPS                     | Train Loss: 1.1049 | Train Acc: 0.8221
 Site-USPS                     | Train Loss: 1.0822 | Train Acc: 0.8305
 Site-SynthDigits              | Train Loss: 1.8345 | Train Acc: 0.4232
 Site-SynthDigits              | Train Loss: 1.7354 | Train Acc: 0.5103
 Site-MNIST-M                  | Train Loss: 2.0113 | Train Acc: 0.3666
 Site-MNIST-M                  | Train Loss: 2.0430 | Train Acc: 0.3318
 Site-SVHN                     | Train Loss: 2.0706 | Train Acc: 0.3235
 Site-SVHN                     | Train Loss: 2.0386 | Train Acc: 0.3139
 Site-MNIST                         | Val  Loss: 1.3440 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.3192 | Val  Acc: 0.7446
 Site-USPS                          | Val  Loss: 1.1660 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 1.1366 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.7464 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.7821 | Val  Acc: 0.4460
 Site-MNIST-M                       | Val  Loss: 2.0786 | Val  Acc: 0.2826
 Site-MNIST-M                       | Val  Loss: 2.0181 | Val  Acc: 0.3669
 Site-SVHN                          | Val  Loss: 1.9986 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0323 | Val  Acc: 0.3345
Average Valid Accuracy: 0.5270
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.7446
 Best site-USPS                      | Epoch:37 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.4674
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.4460
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.2826
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.3669
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.3345
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 38 ============
 Site-MNIST                    | Train Loss: 1.2369 | Train Acc: 0.7601
 Site-MNIST                    | Train Loss: 1.3190 | Train Acc: 0.7013
 Site-USPS                     | Train Loss: 1.1037 | Train Acc: 0.8086
 Site-USPS                     | Train Loss: 1.0764 | Train Acc: 0.8287
 Site-SynthDigits              | Train Loss: 1.8191 | Train Acc: 0.4420
 Site-SynthDigits              | Train Loss: 1.7195 | Train Acc: 0.5121
 Site-MNIST-M                  | Train Loss: 2.0006 | Train Acc: 0.3639
 Site-MNIST-M                  | Train Loss: 2.0381 | Train Acc: 0.3327
 Site-SVHN                     | Train Loss: 2.0670 | Train Acc: 0.3288
 Site-SVHN                     | Train Loss: 2.0301 | Train Acc: 0.3184
 Site-MNIST                         | Val  Loss: 1.3274 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 1.3050 | Val  Acc: 0.7410
 Site-USPS                          | Val  Loss: 1.1643 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 1.1325 | Val  Acc: 0.8058
 Site-SynthDigits                   | Val  Loss: 1.7330 | Val  Acc: 0.4783
 Site-SynthDigits                   | Val  Loss: 1.7663 | Val  Acc: 0.4568
 Site-MNIST-M                       | Val  Loss: 2.0749 | Val  Acc: 0.2717
 Site-MNIST-M                       | Val  Loss: 2.0130 | Val  Acc: 0.3633
 Site-SVHN                          | Val  Loss: 1.9898 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0248 | Val  Acc: 0.3345
Average Valid Accuracy: 0.5245
============ Train epoch 39 ============
 Site-MNIST                    | Train Loss: 1.2215 | Train Acc: 0.7736
 Site-MNIST                    | Train Loss: 1.3043 | Train Acc: 0.7112
 Site-USPS                     | Train Loss: 1.0791 | Train Acc: 0.8248
 Site-USPS                     | Train Loss: 1.0620 | Train Acc: 0.8350
 Site-SynthDigits              | Train Loss: 1.8090 | Train Acc: 0.4447
 Site-SynthDigits              | Train Loss: 1.7102 | Train Acc: 0.5184
 Site-MNIST-M                  | Train Loss: 1.9886 | Train Acc: 0.3666
 Site-MNIST-M                  | Train Loss: 2.0293 | Train Acc: 0.3399
 Site-SVHN                     | Train Loss: 2.0595 | Train Acc: 0.3315
 Site-SVHN                     | Train Loss: 2.0258 | Train Acc: 0.3193
 Site-MNIST                         | Val  Loss: 1.3114 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 1.2895 | Val  Acc: 0.7518
 Site-USPS                          | Val  Loss: 1.1499 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 1.1158 | Val  Acc: 0.8201
 Site-SynthDigits                   | Val  Loss: 1.7209 | Val  Acc: 0.4783
 Site-SynthDigits                   | Val  Loss: 1.7561 | Val  Acc: 0.4604
 Site-MNIST-M                       | Val  Loss: 2.0656 | Val  Acc: 0.3043
 Site-MNIST-M                       | Val  Loss: 2.0030 | Val  Acc: 0.3705
 Site-SVHN                          | Val  Loss: 1.9843 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0196 | Val  Acc: 0.3381
Average Valid Accuracy: 0.5339
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.7518
 Best site-USPS                      | Epoch:39 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8201
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.4783
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.4604
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.3043
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.3705
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.3381
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
 Test site-MNIST                     | Epoch:39 | Test Acc: 0.7247
 Test site-USPS                      | Epoch:39 | Test Acc: 0.8473
 Test site-SynthDigits               | Epoch:39 | Test Acc: 0.4869
 Test site-MNIST-M                   | Epoch:39 | Test Acc: 0.3334
 Test site-SVHN                      | Epoch:39 | Test Acc: 0.2947
MNIST: 0.725, USPS: 0.847, SynthDigits: 0.487, MNIST-M: 0.333, SVHN: 0.295, 
Average Test Accuracy: 0.5374, domain std=0.2164, cluster std=-1.0000, individual std=0.2164, 
============ Train epoch 40 ============
 Site-MNIST                    | Train Loss: 1.1999 | Train Acc: 0.7844
 Site-MNIST                    | Train Loss: 1.2867 | Train Acc: 0.7238
 Site-USPS                     | Train Loss: 1.0631 | Train Acc: 0.8410
 Site-USPS                     | Train Loss: 1.0467 | Train Acc: 0.8377
 Site-SynthDigits              | Train Loss: 1.7947 | Train Acc: 0.4367
 Site-SynthDigits              | Train Loss: 1.6987 | Train Acc: 0.5175
 Site-MNIST-M                  | Train Loss: 1.9798 | Train Acc: 0.3801
 Site-MNIST-M                  | Train Loss: 2.0191 | Train Acc: 0.3462
 Site-SVHN                     | Train Loss: 2.0561 | Train Acc: 0.3315
 Site-SVHN                     | Train Loss: 2.0215 | Train Acc: 0.3256
 Site-MNIST                         | Val  Loss: 1.2963 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.2723 | Val  Acc: 0.7626
 Site-USPS                          | Val  Loss: 1.1360 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 1.1011 | Val  Acc: 0.8273
 Site-SynthDigits                   | Val  Loss: 1.7117 | Val  Acc: 0.4783
 Site-SynthDigits                   | Val  Loss: 1.7465 | Val  Acc: 0.4604
 Site-MNIST-M                       | Val  Loss: 2.0557 | Val  Acc: 0.3043
 Site-MNIST-M                       | Val  Loss: 1.9914 | Val  Acc: 0.3741
 Site-SVHN                          | Val  Loss: 1.9782 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0152 | Val  Acc: 0.3417
Average Valid Accuracy: 0.5397
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.7626
 Best site-USPS                      | Epoch:40 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:40 | Val Acc: 0.8273
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.4783
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.4604
 Best site-MNIST-M                   | Epoch:40 | Val Acc: 0.3043
 Best site-MNIST-M                   | Epoch:40 | Val Acc: 0.3741
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.3417
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 41 ============
 Site-MNIST                    | Train Loss: 1.1859 | Train Acc: 0.7763
 Site-MNIST                    | Train Loss: 1.2740 | Train Acc: 0.7184
 Site-USPS                     | Train Loss: 1.0634 | Train Acc: 0.8275
 Site-USPS                     | Train Loss: 1.0409 | Train Acc: 0.8350
 Site-SynthDigits              | Train Loss: 1.7873 | Train Acc: 0.4420
 Site-SynthDigits              | Train Loss: 1.6867 | Train Acc: 0.5247
 Site-MNIST-M                  | Train Loss: 1.9815 | Train Acc: 0.3827
 Site-MNIST-M                  | Train Loss: 2.0154 | Train Acc: 0.3453
 Site-SVHN                     | Train Loss: 2.0456 | Train Acc: 0.3288
 Site-SVHN                     | Train Loss: 2.0149 | Train Acc: 0.3291
 Site-MNIST                         | Val  Loss: 1.2818 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.2605 | Val  Acc: 0.7554
 Site-USPS                          | Val  Loss: 1.1331 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 1.0963 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.6993 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.7333 | Val  Acc: 0.4712
 Site-MNIST-M                       | Val  Loss: 2.0483 | Val  Acc: 0.3043
 Site-MNIST-M                       | Val  Loss: 1.9845 | Val  Acc: 0.3813
 Site-SVHN                          | Val  Loss: 1.9721 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0090 | Val  Acc: 0.3417
Average Valid Accuracy: 0.5436
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.7554
 Best site-USPS                      | Epoch:41 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:41 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.4712
 Best site-MNIST-M                   | Epoch:41 | Val Acc: 0.3043
 Best site-MNIST-M                   | Epoch:41 | Val Acc: 0.3813
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.3417
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 42 ============
 Site-MNIST                    | Train Loss: 1.1799 | Train Acc: 0.7763
 Site-MNIST                    | Train Loss: 1.2609 | Train Acc: 0.7220
 Site-USPS                     | Train Loss: 1.0555 | Train Acc: 0.8302
 Site-USPS                     | Train Loss: 1.0305 | Train Acc: 0.8332
 Site-SynthDigits              | Train Loss: 1.7751 | Train Acc: 0.4447
 Site-SynthDigits              | Train Loss: 1.6764 | Train Acc: 0.5336
 Site-MNIST-M                  | Train Loss: 1.9667 | Train Acc: 0.3881
 Site-MNIST-M                  | Train Loss: 2.0098 | Train Acc: 0.3462
 Site-SVHN                     | Train Loss: 2.0438 | Train Acc: 0.3261
 Site-SVHN                     | Train Loss: 2.0092 | Train Acc: 0.3265
 Site-MNIST                         | Val  Loss: 1.2660 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.2457 | Val  Acc: 0.7626
 Site-USPS                          | Val  Loss: 1.1228 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 1.0856 | Val  Acc: 0.8201
 Site-SynthDigits                   | Val  Loss: 1.6872 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.7230 | Val  Acc: 0.4784
 Site-MNIST-M                       | Val  Loss: 2.0425 | Val  Acc: 0.3043
 Site-MNIST-M                       | Val  Loss: 1.9779 | Val  Acc: 0.3849
 Site-SVHN                          | Val  Loss: 1.9680 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0037 | Val  Acc: 0.3345
Average Valid Accuracy: 0.5433
============ Train epoch 43 ============
 Site-MNIST                    | Train Loss: 1.1580 | Train Acc: 0.7844
 Site-MNIST                    | Train Loss: 1.2432 | Train Acc: 0.7408
 Site-USPS                     | Train Loss: 1.0394 | Train Acc: 0.8302
 Site-USPS                     | Train Loss: 1.0156 | Train Acc: 0.8341
 Site-SynthDigits              | Train Loss: 1.7611 | Train Acc: 0.4420
 Site-SynthDigits              | Train Loss: 1.6657 | Train Acc: 0.5354
 Site-MNIST-M                  | Train Loss: 1.9661 | Train Acc: 0.3908
 Site-MNIST-M                  | Train Loss: 2.0029 | Train Acc: 0.3534
 Site-SVHN                     | Train Loss: 2.0437 | Train Acc: 0.3261
 Site-SVHN                     | Train Loss: 2.0043 | Train Acc: 0.3300
 Site-MNIST                         | Val  Loss: 1.2514 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.2288 | Val  Acc: 0.7806
 Site-USPS                          | Val  Loss: 1.1075 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 1.0701 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.6791 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.7135 | Val  Acc: 0.4784
 Site-MNIST-M                       | Val  Loss: 2.0368 | Val  Acc: 0.3152
 Site-MNIST-M                       | Val  Loss: 1.9710 | Val  Acc: 0.3885
 Site-SVHN                          | Val  Loss: 1.9623 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0001 | Val  Acc: 0.3417
Average Valid Accuracy: 0.5498
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.7806
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.5109
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.4784
 Best site-MNIST-M                   | Epoch:43 | Val Acc: 0.3152
 Best site-MNIST-M                   | Epoch:43 | Val Acc: 0.3885
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.3417
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 44 ============
 Site-MNIST                    | Train Loss: 1.1501 | Train Acc: 0.7817
 Site-MNIST                    | Train Loss: 1.2311 | Train Acc: 0.7354
 Site-USPS                     | Train Loss: 1.0328 | Train Acc: 0.8275
 Site-USPS                     | Train Loss: 1.0057 | Train Acc: 0.8359
 Site-SynthDigits              | Train Loss: 1.7589 | Train Acc: 0.4501
 Site-SynthDigits              | Train Loss: 1.6550 | Train Acc: 0.5453
 Site-MNIST-M                  | Train Loss: 1.9632 | Train Acc: 0.4016
 Site-MNIST-M                  | Train Loss: 1.9984 | Train Acc: 0.3471
 Site-SVHN                     | Train Loss: 2.0393 | Train Acc: 0.3342
 Site-SVHN                     | Train Loss: 1.9997 | Train Acc: 0.3318
 Site-MNIST                         | Val  Loss: 1.2383 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.2173 | Val  Acc: 0.7662
 Site-USPS                          | Val  Loss: 1.0998 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 1.0610 | Val  Acc: 0.8201
 Site-SynthDigits                   | Val  Loss: 1.6676 | Val  Acc: 0.5217
 Site-SynthDigits                   | Val  Loss: 1.7020 | Val  Acc: 0.4964
 Site-MNIST-M                       | Val  Loss: 2.0309 | Val  Acc: 0.3043
 Site-MNIST-M                       | Val  Loss: 1.9647 | Val  Acc: 0.3849
 Site-SVHN                          | Val  Loss: 1.9573 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 1.9950 | Val  Acc: 0.3453
Average Valid Accuracy: 0.5487
============ Train epoch 45 ============
 Site-MNIST                    | Train Loss: 1.1320 | Train Acc: 0.7763
 Site-MNIST                    | Train Loss: 1.2199 | Train Acc: 0.7399
 Site-USPS                     | Train Loss: 1.0085 | Train Acc: 0.8329
 Site-USPS                     | Train Loss: 0.9924 | Train Acc: 0.8386
 Site-SynthDigits              | Train Loss: 1.7493 | Train Acc: 0.4555
 Site-SynthDigits              | Train Loss: 1.6453 | Train Acc: 0.5435
 Site-MNIST-M                  | Train Loss: 1.9596 | Train Acc: 0.3908
 Site-MNIST-M                  | Train Loss: 1.9972 | Train Acc: 0.3525
 Site-SVHN                     | Train Loss: 2.0318 | Train Acc: 0.3315
 Site-SVHN                     | Train Loss: 1.9939 | Train Acc: 0.3309
 Site-MNIST                         | Val  Loss: 1.2245 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.2044 | Val  Acc: 0.7698
 Site-USPS                          | Val  Loss: 1.0874 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 1.0479 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.6578 | Val  Acc: 0.5217
 Site-SynthDigits                   | Val  Loss: 1.6917 | Val  Acc: 0.4928
 Site-MNIST-M                       | Val  Loss: 2.0317 | Val  Acc: 0.3261
 Site-MNIST-M                       | Val  Loss: 1.9646 | Val  Acc: 0.3921
 Site-SVHN                          | Val  Loss: 1.9509 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 1.9894 | Val  Acc: 0.3417
Average Valid Accuracy: 0.5527
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.7698
 Best site-USPS                      | Epoch:45 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:45 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.5217
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.4928
 Best site-MNIST-M                   | Epoch:45 | Val Acc: 0.3261
 Best site-MNIST-M                   | Epoch:45 | Val Acc: 0.3921
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.3417
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 46 ============
 Site-MNIST                    | Train Loss: 1.1276 | Train Acc: 0.7709
 Site-MNIST                    | Train Loss: 1.2123 | Train Acc: 0.7408
 Site-USPS                     | Train Loss: 1.0224 | Train Acc: 0.8275
 Site-USPS                     | Train Loss: 0.9990 | Train Acc: 0.8332
 Site-SynthDigits              | Train Loss: 1.7384 | Train Acc: 0.4582
 Site-SynthDigits              | Train Loss: 1.6305 | Train Acc: 0.5489
 Site-MNIST-M                  | Train Loss: 1.9600 | Train Acc: 0.3881
 Site-MNIST-M                  | Train Loss: 1.9938 | Train Acc: 0.3498
 Site-SVHN                     | Train Loss: 2.0247 | Train Acc: 0.3423
 Site-SVHN                     | Train Loss: 1.9856 | Train Acc: 0.3372
 Site-MNIST                         | Val  Loss: 1.2145 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.1978 | Val  Acc: 0.7626
 Site-USPS                          | Val  Loss: 1.0982 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 1.0534 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.6435 | Val  Acc: 0.5543
 Site-SynthDigits                   | Val  Loss: 1.6758 | Val  Acc: 0.5144
 Site-MNIST-M                       | Val  Loss: 2.0254 | Val  Acc: 0.3261
 Site-MNIST-M                       | Val  Loss: 1.9589 | Val  Acc: 0.3957
 Site-SVHN                          | Val  Loss: 1.9462 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 1.9849 | Val  Acc: 0.3453
Average Valid Accuracy: 0.5592
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.7626
 Best site-USPS                      | Epoch:46 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:46 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.5543
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.5144
 Best site-MNIST-M                   | Epoch:46 | Val Acc: 0.3261
 Best site-MNIST-M                   | Epoch:46 | Val Acc: 0.3957
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.3453
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 47 ============
 Site-MNIST                    | Train Loss: 1.1070 | Train Acc: 0.7844
 Site-MNIST                    | Train Loss: 1.1951 | Train Acc: 0.7516
 Site-USPS                     | Train Loss: 0.9973 | Train Acc: 0.8302
 Site-USPS                     | Train Loss: 0.9743 | Train Acc: 0.8377
 Site-SynthDigits              | Train Loss: 1.7335 | Train Acc: 0.4555
 Site-SynthDigits              | Train Loss: 1.6252 | Train Acc: 0.5489
 Site-MNIST-M                  | Train Loss: 1.9473 | Train Acc: 0.4016
 Site-MNIST-M                  | Train Loss: 1.9845 | Train Acc: 0.3534
 Site-SVHN                     | Train Loss: 2.0233 | Train Acc: 0.3531
 Site-SVHN                     | Train Loss: 1.9825 | Train Acc: 0.3327
 Site-MNIST                         | Val  Loss: 1.2010 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 1.1813 | Val  Acc: 0.7806
 Site-USPS                          | Val  Loss: 1.0741 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 1.0315 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.6387 | Val  Acc: 0.5326
 Site-SynthDigits                   | Val  Loss: 1.6712 | Val  Acc: 0.5036
 Site-MNIST-M                       | Val  Loss: 2.0171 | Val  Acc: 0.3261
 Site-MNIST-M                       | Val  Loss: 1.9496 | Val  Acc: 0.4029
 Site-SVHN                          | Val  Loss: 1.9406 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 1.9802 | Val  Acc: 0.3525
Average Valid Accuracy: 0.5602
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.7609
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.7806
 Best site-USPS                      | Epoch:47 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:47 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5326
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5036
 Best site-MNIST-M                   | Epoch:47 | Val Acc: 0.3261
 Best site-MNIST-M                   | Epoch:47 | Val Acc: 0.4029
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.3525
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 48 ============
 Site-MNIST                    | Train Loss: 1.0915 | Train Acc: 0.7898
 Site-MNIST                    | Train Loss: 1.1761 | Train Acc: 0.7623
 Site-USPS                     | Train Loss: 0.9785 | Train Acc: 0.8437
 Site-USPS                     | Train Loss: 0.9514 | Train Acc: 0.8430
 Site-SynthDigits              | Train Loss: 1.7308 | Train Acc: 0.4501
 Site-SynthDigits              | Train Loss: 1.6225 | Train Acc: 0.5453
 Site-MNIST-M                  | Train Loss: 1.9290 | Train Acc: 0.4070
 Site-MNIST-M                  | Train Loss: 1.9726 | Train Acc: 0.3578
 Site-SVHN                     | Train Loss: 2.0287 | Train Acc: 0.3450
 Site-SVHN                     | Train Loss: 1.9810 | Train Acc: 0.3327
 Site-MNIST                         | Val  Loss: 1.1870 | Val  Acc: 0.7717
 Site-MNIST                         | Val  Loss: 1.1624 | Val  Acc: 0.7878
 Site-USPS                          | Val  Loss: 1.0488 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 1.0082 | Val  Acc: 0.8345
 Site-SynthDigits                   | Val  Loss: 1.6353 | Val  Acc: 0.5435
 Site-SynthDigits                   | Val  Loss: 1.6704 | Val  Acc: 0.5072
 Site-MNIST-M                       | Val  Loss: 2.0100 | Val  Acc: 0.3152
 Site-MNIST-M                       | Val  Loss: 1.9399 | Val  Acc: 0.3993
 Site-SVHN                          | Val  Loss: 1.9355 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 1.9773 | Val  Acc: 0.3489
Average Valid Accuracy: 0.5628
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.7717
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.7878
 Best site-USPS                      | Epoch:48 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:48 | Val Acc: 0.8345
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.5435
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.5072
 Best site-MNIST-M                   | Epoch:48 | Val Acc: 0.3152
 Best site-MNIST-M                   | Epoch:48 | Val Acc: 0.3993
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.3489
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 49 ============
 Site-MNIST                    | Train Loss: 1.0752 | Train Acc: 0.7925
 Site-MNIST                    | Train Loss: 1.1592 | Train Acc: 0.7659
 Site-USPS                     | Train Loss: 0.9625 | Train Acc: 0.8518
 Site-USPS                     | Train Loss: 0.9357 | Train Acc: 0.8457
 Site-SynthDigits              | Train Loss: 1.7280 | Train Acc: 0.4420
 Site-SynthDigits              | Train Loss: 1.6205 | Train Acc: 0.5453
 Site-MNIST-M                  | Train Loss: 1.9164 | Train Acc: 0.4232
 Site-MNIST-M                  | Train Loss: 1.9608 | Train Acc: 0.3668
 Site-SVHN                     | Train Loss: 2.0227 | Train Acc: 0.3396
 Site-SVHN                     | Train Loss: 1.9805 | Train Acc: 0.3354
 Site-MNIST                         | Val  Loss: 1.1737 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.1453 | Val  Acc: 0.7842
 Site-USPS                          | Val  Loss: 1.0331 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.9938 | Val  Acc: 0.8345
 Site-SynthDigits                   | Val  Loss: 1.6329 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.6701 | Val  Acc: 0.4892
 Site-MNIST-M                       | Val  Loss: 2.0020 | Val  Acc: 0.3261
 Site-MNIST-M                       | Val  Loss: 1.9282 | Val  Acc: 0.4065
 Site-SVHN                          | Val  Loss: 1.9337 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 1.9757 | Val  Acc: 0.3525
Average Valid Accuracy: 0.5595
===2023-06-03 18:40:52===
===2023-06-03 18:40:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.7606
 Test site-USPS                      | Epoch:48 | Test Acc: 0.8624
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.5092
 Test site-MNIST-M                   | Epoch:48 | Test Acc: 0.3579
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.3053
MNIST: 0.761, USPS: 0.862, SynthDigits: 0.509, MNIST-M: 0.358, SVHN: 0.305, 
Average Test Accuracy: 0.5591, domain std=0.2191, cluster std=-1.0000, individual std=0.2191, 
