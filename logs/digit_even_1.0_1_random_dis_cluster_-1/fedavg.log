===2023-06-03 13:39:43===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                    | Train Loss: 2.2497 | Train Acc: 0.2264
 Site-MNIST                    | Train Loss: 2.2568 | Train Acc: 0.2197
 Site-USPS                     | Train Loss: 2.2510 | Train Acc: 0.2561
 Site-USPS                     | Train Loss: 2.2463 | Train Acc: 0.2673
 Site-SynthDigits              | Train Loss: 2.2932 | Train Acc: 0.1294
 Site-SynthDigits              | Train Loss: 2.2832 | Train Acc: 0.1641
 Site-MNIST-M                  | Train Loss: 2.2996 | Train Acc: 0.1186
 Site-MNIST-M                  | Train Loss: 2.2982 | Train Acc: 0.1040
 Site-SVHN                     | Train Loss: 2.2821 | Train Acc: 0.1456
 Site-SVHN                     | Train Loss: 2.2868 | Train Acc: 0.1426
 Site-MNIST                         | Val  Loss: 2.2631 | Val  Acc: 0.1522
 Site-MNIST                         | Val  Loss: 2.2538 | Val  Acc: 0.1978
 Site-USPS                          | Val  Loss: 2.2520 | Val  Acc: 0.2609
 Site-USPS                          | Val  Loss: 2.2487 | Val  Acc: 0.2698
 Site-SynthDigits                   | Val  Loss: 2.2888 | Val  Acc: 0.1413
 Site-SynthDigits                   | Val  Loss: 2.2936 | Val  Acc: 0.1079
 Site-MNIST-M                       | Val  Loss: 2.3046 | Val  Acc: 0.0652
 Site-MNIST-M                       | Val  Loss: 2.3003 | Val  Acc: 0.0935
 Site-SVHN                          | Val  Loss: 2.2840 | Val  Acc: 0.1630
 Site-SVHN                          | Val  Loss: 2.2862 | Val  Acc: 0.1403
Average Valid Accuracy: 0.1592
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1522
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1978
 Best site-USPS                      | Epoch:0 | Val Acc: 0.2609
 Best site-USPS                      | Epoch:0 | Val Acc: 0.2698
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1413
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1079
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.0652
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.0935
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1630
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1403
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 1 ============
 Site-MNIST                    | Train Loss: 2.2028 | Train Acc: 0.4420
 Site-MNIST                    | Train Loss: 2.2192 | Train Acc: 0.3641
 Site-USPS                     | Train Loss: 2.1936 | Train Acc: 0.4555
 Site-USPS                     | Train Loss: 2.1880 | Train Acc: 0.4861
 Site-SynthDigits              | Train Loss: 2.2823 | Train Acc: 0.1590
 Site-SynthDigits              | Train Loss: 2.2668 | Train Acc: 0.2108
 Site-MNIST-M                  | Train Loss: 2.2934 | Train Acc: 0.1213
 Site-MNIST-M                  | Train Loss: 2.2920 | Train Acc: 0.1085
 Site-SVHN                     | Train Loss: 2.2716 | Train Acc: 0.1968
 Site-SVHN                     | Train Loss: 2.2761 | Train Acc: 0.1830
 Site-MNIST                         | Val  Loss: 2.2265 | Val  Acc: 0.2609
 Site-MNIST                         | Val  Loss: 2.2139 | Val  Acc: 0.3813
 Site-USPS                          | Val  Loss: 2.2001 | Val  Acc: 0.4239
 Site-USPS                          | Val  Loss: 2.1963 | Val  Acc: 0.4568
 Site-SynthDigits                   | Val  Loss: 2.2716 | Val  Acc: 0.2065
 Site-SynthDigits                   | Val  Loss: 2.2796 | Val  Acc: 0.1511
 Site-MNIST-M                       | Val  Loss: 2.2984 | Val  Acc: 0.0652
 Site-MNIST-M                       | Val  Loss: 2.2931 | Val  Acc: 0.1043
 Site-SVHN                          | Val  Loss: 2.2703 | Val  Acc: 0.2065
 Site-SVHN                          | Val  Loss: 2.2739 | Val  Acc: 0.2050
Average Valid Accuracy: 0.2462
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.2609
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.3813
 Best site-USPS                      | Epoch:1 | Val Acc: 0.4239
 Best site-USPS                      | Epoch:1 | Val Acc: 0.4568
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2065
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.1511
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.0652
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.1043
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2065
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2050
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 2 ============
 Site-MNIST                    | Train Loss: 2.1588 | Train Acc: 0.5256
 Site-MNIST                    | Train Loss: 2.1821 | Train Acc: 0.4475
 Site-USPS                     | Train Loss: 2.1383 | Train Acc: 0.5256
 Site-USPS                     | Train Loss: 2.1324 | Train Acc: 0.5668
 Site-SynthDigits              | Train Loss: 2.2707 | Train Acc: 0.1941
 Site-SynthDigits              | Train Loss: 2.2506 | Train Acc: 0.2565
 Site-MNIST-M                  | Train Loss: 2.2866 | Train Acc: 0.1348
 Site-MNIST-M                  | Train Loss: 2.2858 | Train Acc: 0.1220
 Site-SVHN                     | Train Loss: 2.2621 | Train Acc: 0.2183
 Site-SVHN                     | Train Loss: 2.2662 | Train Acc: 0.2018
 Site-MNIST                         | Val  Loss: 2.1902 | Val  Acc: 0.4022
 Site-MNIST                         | Val  Loss: 2.1744 | Val  Acc: 0.4640
 Site-USPS                          | Val  Loss: 2.1503 | Val  Acc: 0.4891
 Site-USPS                          | Val  Loss: 2.1460 | Val  Acc: 0.5144
 Site-SynthDigits                   | Val  Loss: 2.2550 | Val  Acc: 0.2500
 Site-SynthDigits                   | Val  Loss: 2.2656 | Val  Acc: 0.2014
 Site-MNIST-M                       | Val  Loss: 2.2924 | Val  Acc: 0.0543
 Site-MNIST-M                       | Val  Loss: 2.2861 | Val  Acc: 0.1043
 Site-SVHN                          | Val  Loss: 2.2576 | Val  Acc: 0.2391
 Site-SVHN                          | Val  Loss: 2.2627 | Val  Acc: 0.2194
Average Valid Accuracy: 0.2938
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.4022
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.4640
 Best site-USPS                      | Epoch:2 | Val Acc: 0.4891
 Best site-USPS                      | Epoch:2 | Val Acc: 0.5144
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2500
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2014
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.0543
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.1043
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2391
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2194
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 3 ============
 Site-MNIST                    | Train Loss: 2.1117 | Train Acc: 0.5526
 Site-MNIST                    | Train Loss: 2.1439 | Train Acc: 0.4673
 Site-USPS                     | Train Loss: 2.0863 | Train Acc: 0.5553
 Site-USPS                     | Train Loss: 2.0791 | Train Acc: 0.5883
 Site-SynthDigits              | Train Loss: 2.2583 | Train Acc: 0.2210
 Site-SynthDigits              | Train Loss: 2.2346 | Train Acc: 0.2807
 Site-MNIST-M                  | Train Loss: 2.2787 | Train Acc: 0.1644
 Site-MNIST-M                  | Train Loss: 2.2791 | Train Acc: 0.1435
 Site-SVHN                     | Train Loss: 2.2516 | Train Acc: 0.2426
 Site-SVHN                     | Train Loss: 2.2574 | Train Acc: 0.2135
 Site-MNIST                         | Val  Loss: 2.1527 | Val  Acc: 0.4457
 Site-MNIST                         | Val  Loss: 2.1343 | Val  Acc: 0.4964
 Site-USPS                          | Val  Loss: 2.1025 | Val  Acc: 0.5217
 Site-USPS                          | Val  Loss: 2.0979 | Val  Acc: 0.5324
 Site-SynthDigits                   | Val  Loss: 2.2390 | Val  Acc: 0.2826
 Site-SynthDigits                   | Val  Loss: 2.2514 | Val  Acc: 0.2374
 Site-MNIST-M                       | Val  Loss: 2.2863 | Val  Acc: 0.0761
 Site-MNIST-M                       | Val  Loss: 2.2789 | Val  Acc: 0.1151
 Site-SVHN                          | Val  Loss: 2.2459 | Val  Acc: 0.2717
 Site-SVHN                          | Val  Loss: 2.2525 | Val  Acc: 0.2482
Average Valid Accuracy: 0.3227
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.4457
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.4964
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5217
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5324
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2826
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2374
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.0761
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.1151
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2717
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2482
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 4 ============
 Site-MNIST                    | Train Loss: 2.0697 | Train Acc: 0.5795
 Site-MNIST                    | Train Loss: 2.1062 | Train Acc: 0.4888
 Site-USPS                     | Train Loss: 2.0339 | Train Acc: 0.5768
 Site-USPS                     | Train Loss: 2.0273 | Train Acc: 0.5955
 Site-SynthDigits              | Train Loss: 2.2452 | Train Acc: 0.2372
 Site-SynthDigits              | Train Loss: 2.2181 | Train Acc: 0.2996
 Site-MNIST-M                  | Train Loss: 2.2706 | Train Acc: 0.1833
 Site-MNIST-M                  | Train Loss: 2.2726 | Train Acc: 0.1596
 Site-SVHN                     | Train Loss: 2.2435 | Train Acc: 0.2453
 Site-SVHN                     | Train Loss: 2.2490 | Train Acc: 0.2287
 Site-MNIST                         | Val  Loss: 2.1153 | Val  Acc: 0.4674
 Site-MNIST                         | Val  Loss: 2.0948 | Val  Acc: 0.5180
 Site-USPS                          | Val  Loss: 2.0552 | Val  Acc: 0.5109
 Site-USPS                          | Val  Loss: 2.0505 | Val  Acc: 0.5288
 Site-SynthDigits                   | Val  Loss: 2.2232 | Val  Acc: 0.2935
 Site-SynthDigits                   | Val  Loss: 2.2370 | Val  Acc: 0.2446
 Site-MNIST-M                       | Val  Loss: 2.2799 | Val  Acc: 0.1413
 Site-MNIST-M                       | Val  Loss: 2.2720 | Val  Acc: 0.1547
 Site-SVHN                          | Val  Loss: 2.2356 | Val  Acc: 0.2717
 Site-SVHN                          | Val  Loss: 2.2432 | Val  Acc: 0.2626
Average Valid Accuracy: 0.3393
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.4674
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5180
 Best site-USPS                      | Epoch:4 | Val Acc: 0.5109
 Best site-USPS                      | Epoch:4 | Val Acc: 0.5288
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.2935
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.2446
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.1413
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.1547
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2717
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2626
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 5 ============
 Site-MNIST                    | Train Loss: 2.0272 | Train Acc: 0.6038
 Site-MNIST                    | Train Loss: 2.0685 | Train Acc: 0.4942
 Site-USPS                     | Train Loss: 1.9825 | Train Acc: 0.5930
 Site-USPS                     | Train Loss: 1.9785 | Train Acc: 0.6018
 Site-SynthDigits              | Train Loss: 2.2344 | Train Acc: 0.2399
 Site-SynthDigits              | Train Loss: 2.2016 | Train Acc: 0.3193
 Site-MNIST-M                  | Train Loss: 2.2634 | Train Acc: 0.1887
 Site-MNIST-M                  | Train Loss: 2.2655 | Train Acc: 0.1704
 Site-SVHN                     | Train Loss: 2.2358 | Train Acc: 0.2480
 Site-SVHN                     | Train Loss: 2.2417 | Train Acc: 0.2323
 Site-MNIST                         | Val  Loss: 2.0780 | Val  Acc: 0.4783
 Site-MNIST                         | Val  Loss: 2.0556 | Val  Acc: 0.5252
 Site-USPS                          | Val  Loss: 2.0107 | Val  Acc: 0.5217
 Site-USPS                          | Val  Loss: 2.0063 | Val  Acc: 0.5540
 Site-SynthDigits                   | Val  Loss: 2.2070 | Val  Acc: 0.3152
 Site-SynthDigits                   | Val  Loss: 2.2217 | Val  Acc: 0.2626
 Site-MNIST-M                       | Val  Loss: 2.2727 | Val  Acc: 0.1413
 Site-MNIST-M                       | Val  Loss: 2.2647 | Val  Acc: 0.1547
 Site-SVHN                          | Val  Loss: 2.2263 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.2343 | Val  Acc: 0.2806
Average Valid Accuracy: 0.3538
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.4783
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5252
 Best site-USPS                      | Epoch:5 | Val Acc: 0.5217
 Best site-USPS                      | Epoch:5 | Val Acc: 0.5540
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3152
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.2626
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.1413
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.1547
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2806
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 6 ============
 Site-MNIST                    | Train Loss: 1.9869 | Train Acc: 0.6092
 Site-MNIST                    | Train Loss: 2.0335 | Train Acc: 0.5004
 Site-USPS                     | Train Loss: 1.9367 | Train Acc: 0.5984
 Site-USPS                     | Train Loss: 1.9318 | Train Acc: 0.6179
 Site-SynthDigits              | Train Loss: 2.2194 | Train Acc: 0.2561
 Site-SynthDigits              | Train Loss: 2.1845 | Train Acc: 0.3372
 Site-MNIST-M                  | Train Loss: 2.2541 | Train Acc: 0.1941
 Site-MNIST-M                  | Train Loss: 2.2581 | Train Acc: 0.1919
 Site-SVHN                     | Train Loss: 2.2268 | Train Acc: 0.2480
 Site-SVHN                     | Train Loss: 2.2342 | Train Acc: 0.2323
 Site-MNIST                         | Val  Loss: 2.0416 | Val  Acc: 0.5109
 Site-MNIST                         | Val  Loss: 2.0191 | Val  Acc: 0.5468
 Site-USPS                          | Val  Loss: 1.9670 | Val  Acc: 0.5543
 Site-USPS                          | Val  Loss: 1.9627 | Val  Acc: 0.5719
 Site-SynthDigits                   | Val  Loss: 2.1909 | Val  Acc: 0.3370
 Site-SynthDigits                   | Val  Loss: 2.2058 | Val  Acc: 0.2842
 Site-MNIST-M                       | Val  Loss: 2.2647 | Val  Acc: 0.1413
 Site-MNIST-M                       | Val  Loss: 2.2565 | Val  Acc: 0.1763
 Site-SVHN                          | Val  Loss: 2.2181 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.2257 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3693
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.5109
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.5468
 Best site-USPS                      | Epoch:6 | Val Acc: 0.5543
 Best site-USPS                      | Epoch:6 | Val Acc: 0.5719
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3370
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.2842
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.1413
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.1763
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2770
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 7 ============
 Site-MNIST                    | Train Loss: 1.9483 | Train Acc: 0.6280
 Site-MNIST                    | Train Loss: 1.9993 | Train Acc: 0.5094
 Site-USPS                     | Train Loss: 1.8929 | Train Acc: 0.6065
 Site-USPS                     | Train Loss: 1.8860 | Train Acc: 0.6251
 Site-SynthDigits              | Train Loss: 2.2062 | Train Acc: 0.2642
 Site-SynthDigits              | Train Loss: 2.1676 | Train Acc: 0.3543
 Site-MNIST-M                  | Train Loss: 2.2444 | Train Acc: 0.2075
 Site-MNIST-M                  | Train Loss: 2.2511 | Train Acc: 0.2036
 Site-SVHN                     | Train Loss: 2.2229 | Train Acc: 0.2561
 Site-SVHN                     | Train Loss: 2.2277 | Train Acc: 0.2350
 Site-MNIST                         | Val  Loss: 2.0082 | Val  Acc: 0.5109
 Site-MNIST                         | Val  Loss: 1.9842 | Val  Acc: 0.5612
 Site-USPS                          | Val  Loss: 1.9251 | Val  Acc: 0.5435
 Site-USPS                          | Val  Loss: 1.9205 | Val  Acc: 0.5755
 Site-SynthDigits                   | Val  Loss: 2.1749 | Val  Acc: 0.3587
 Site-SynthDigits                   | Val  Loss: 2.1905 | Val  Acc: 0.3094
 Site-MNIST-M                       | Val  Loss: 2.2578 | Val  Acc: 0.1630
 Site-MNIST-M                       | Val  Loss: 2.2489 | Val  Acc: 0.1978
 Site-SVHN                          | Val  Loss: 2.2100 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.2183 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3780
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.5109
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.5612
 Best site-USPS                      | Epoch:7 | Val Acc: 0.5435
 Best site-USPS                      | Epoch:7 | Val Acc: 0.5755
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3587
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3094
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.1630
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.1978
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2770
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 8 ============
 Site-MNIST                    | Train Loss: 1.9059 | Train Acc: 0.6361
 Site-MNIST                    | Train Loss: 1.9645 | Train Acc: 0.5265
 Site-USPS                     | Train Loss: 1.8513 | Train Acc: 0.5984
 Site-USPS                     | Train Loss: 1.8415 | Train Acc: 0.6422
 Site-SynthDigits              | Train Loss: 2.1924 | Train Acc: 0.2749
 Site-SynthDigits              | Train Loss: 2.1515 | Train Acc: 0.3659
 Site-MNIST-M                  | Train Loss: 2.2393 | Train Acc: 0.2264
 Site-MNIST-M                  | Train Loss: 2.2443 | Train Acc: 0.2117
 Site-SVHN                     | Train Loss: 2.2184 | Train Acc: 0.2588
 Site-SVHN                     | Train Loss: 2.2210 | Train Acc: 0.2368
 Site-MNIST                         | Val  Loss: 1.9755 | Val  Acc: 0.5217
 Site-MNIST                         | Val  Loss: 1.9487 | Val  Acc: 0.5791
 Site-USPS                          | Val  Loss: 1.8837 | Val  Acc: 0.5326
 Site-USPS                          | Val  Loss: 1.8792 | Val  Acc: 0.5791
 Site-SynthDigits                   | Val  Loss: 2.1596 | Val  Acc: 0.3696
 Site-SynthDigits                   | Val  Loss: 2.1760 | Val  Acc: 0.3237
 Site-MNIST-M                       | Val  Loss: 2.2518 | Val  Acc: 0.1848
 Site-MNIST-M                       | Val  Loss: 2.2421 | Val  Acc: 0.2158
 Site-SVHN                          | Val  Loss: 2.2021 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.2112 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3877
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.5217
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.5791
 Best site-USPS                      | Epoch:8 | Val Acc: 0.5326
 Best site-USPS                      | Epoch:8 | Val Acc: 0.5791
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3696
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3237
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.1848
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.2158
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2770
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 9 ============
 Site-MNIST                    | Train Loss: 1.8680 | Train Acc: 0.6496
 Site-MNIST                    | Train Loss: 1.9313 | Train Acc: 0.5399
 Site-USPS                     | Train Loss: 1.8079 | Train Acc: 0.6092
 Site-USPS                     | Train Loss: 1.7987 | Train Acc: 0.6511
 Site-SynthDigits              | Train Loss: 2.1809 | Train Acc: 0.2776
 Site-SynthDigits              | Train Loss: 2.1361 | Train Acc: 0.3641
 Site-MNIST-M                  | Train Loss: 2.2301 | Train Acc: 0.2399
 Site-MNIST-M                  | Train Loss: 2.2380 | Train Acc: 0.2215
 Site-SVHN                     | Train Loss: 2.2069 | Train Acc: 0.2642
 Site-SVHN                     | Train Loss: 2.2150 | Train Acc: 0.2350
 Site-MNIST                         | Val  Loss: 1.9432 | Val  Acc: 0.5326
 Site-MNIST                         | Val  Loss: 1.9142 | Val  Acc: 0.5899
 Site-USPS                          | Val  Loss: 1.8440 | Val  Acc: 0.5543
 Site-USPS                          | Val  Loss: 1.8395 | Val  Acc: 0.5935
 Site-SynthDigits                   | Val  Loss: 2.1445 | Val  Acc: 0.3587
 Site-SynthDigits                   | Val  Loss: 2.1616 | Val  Acc: 0.3165
 Site-MNIST-M                       | Val  Loss: 2.2459 | Val  Acc: 0.2065
 Site-MNIST-M                       | Val  Loss: 2.2355 | Val  Acc: 0.2338
 Site-SVHN                          | Val  Loss: 2.1946 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.2045 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3956
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.5326
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.5899
 Best site-USPS                      | Epoch:9 | Val Acc: 0.5543
 Best site-USPS                      | Epoch:9 | Val Acc: 0.5935
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3587
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3165
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.2065
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.2338
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2770
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
 Test site-MNIST                     | Epoch:9 | Test Acc: 0.5447
 Test site-USPS                      | Epoch:9 | Test Acc: 0.6333
 Test site-SynthDigits               | Epoch:9 | Test Acc: 0.3350
 Test site-MNIST-M                   | Epoch:9 | Test Acc: 0.2054
 Test site-SVHN                      | Epoch:9 | Test Acc: 0.2153
MNIST: 0.545, USPS: 0.633, SynthDigits: 0.335, MNIST-M: 0.205, SVHN: 0.215, 
Average Test Accuracy: 0.3868, domain std=0.1736, cluster std=-1.0000, individual std=0.1736, 
============ Train epoch 10 ============
 Site-MNIST                    | Train Loss: 1.8334 | Train Acc: 0.6523
 Site-MNIST                    | Train Loss: 1.8987 | Train Acc: 0.5489
 Site-USPS                     | Train Loss: 1.7658 | Train Acc: 0.6226
 Site-USPS                     | Train Loss: 1.7597 | Train Acc: 0.6538
 Site-SynthDigits              | Train Loss: 2.1680 | Train Acc: 0.2803
 Site-SynthDigits              | Train Loss: 2.1205 | Train Acc: 0.3749
 Site-MNIST-M                  | Train Loss: 2.2237 | Train Acc: 0.2561
 Site-MNIST-M                  | Train Loss: 2.2309 | Train Acc: 0.2278
 Site-SVHN                     | Train Loss: 2.2043 | Train Acc: 0.2588
 Site-SVHN                     | Train Loss: 2.2089 | Train Acc: 0.2332
 Site-MNIST                         | Val  Loss: 1.9115 | Val  Acc: 0.5543
 Site-MNIST                         | Val  Loss: 1.8811 | Val  Acc: 0.5971
 Site-USPS                          | Val  Loss: 1.8088 | Val  Acc: 0.5652
 Site-USPS                          | Val  Loss: 1.8034 | Val  Acc: 0.5971
 Site-SynthDigits                   | Val  Loss: 2.1297 | Val  Acc: 0.3587
 Site-SynthDigits                   | Val  Loss: 2.1472 | Val  Acc: 0.3129
 Site-MNIST-M                       | Val  Loss: 2.2400 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.2285 | Val  Acc: 0.2518
 Site-SVHN                          | Val  Loss: 2.1879 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1984 | Val  Acc: 0.2770
Average Valid Accuracy: 0.4036
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.5543
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.5971
 Best site-USPS                      | Epoch:10 | Val Acc: 0.5652
 Best site-USPS                      | Epoch:10 | Val Acc: 0.5971
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3587
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3129
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.2518
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2770
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 11 ============
 Site-MNIST                    | Train Loss: 1.8036 | Train Acc: 0.6550
 Site-MNIST                    | Train Loss: 1.8669 | Train Acc: 0.5641
 Site-USPS                     | Train Loss: 1.7329 | Train Acc: 0.6226
 Site-USPS                     | Train Loss: 1.7181 | Train Acc: 0.6673
 Site-SynthDigits              | Train Loss: 2.1551 | Train Acc: 0.2884
 Site-SynthDigits              | Train Loss: 2.1057 | Train Acc: 0.3794
 Site-MNIST-M                  | Train Loss: 2.2173 | Train Acc: 0.2642
 Site-MNIST-M                  | Train Loss: 2.2245 | Train Acc: 0.2368
 Site-SVHN                     | Train Loss: 2.1961 | Train Acc: 0.2588
 Site-SVHN                     | Train Loss: 2.2035 | Train Acc: 0.2359
 Site-MNIST                         | Val  Loss: 1.8810 | Val  Acc: 0.5652
 Site-MNIST                         | Val  Loss: 1.8489 | Val  Acc: 0.6079
 Site-USPS                          | Val  Loss: 1.7691 | Val  Acc: 0.5870
 Site-USPS                          | Val  Loss: 1.7634 | Val  Acc: 0.6223
 Site-SynthDigits                   | Val  Loss: 2.1156 | Val  Acc: 0.3587
 Site-SynthDigits                   | Val  Loss: 2.1336 | Val  Acc: 0.3129
 Site-MNIST-M                       | Val  Loss: 2.2345 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.2219 | Val  Acc: 0.2626
 Site-SVHN                          | Val  Loss: 2.1813 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1927 | Val  Acc: 0.2806
Average Valid Accuracy: 0.4130
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.5652
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6079
 Best site-USPS                      | Epoch:11 | Val Acc: 0.5870
 Best site-USPS                      | Epoch:11 | Val Acc: 0.6223
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3587
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3129
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.2626
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2806
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 12 ============
 Site-MNIST                    | Train Loss: 1.7684 | Train Acc: 0.6792
 Site-MNIST                    | Train Loss: 1.8386 | Train Acc: 0.5767
 Site-USPS                     | Train Loss: 1.6920 | Train Acc: 0.6388
 Site-USPS                     | Train Loss: 1.6800 | Train Acc: 0.6753
 Site-SynthDigits              | Train Loss: 2.1432 | Train Acc: 0.2992
 Site-SynthDigits              | Train Loss: 2.0907 | Train Acc: 0.3821
 Site-MNIST-M                  | Train Loss: 2.2110 | Train Acc: 0.2695
 Site-MNIST-M                  | Train Loss: 2.2177 | Train Acc: 0.2430
 Site-SVHN                     | Train Loss: 2.1936 | Train Acc: 0.2615
 Site-SVHN                     | Train Loss: 2.1979 | Train Acc: 0.2368
 Site-MNIST                         | Val  Loss: 1.8523 | Val  Acc: 0.5652
 Site-MNIST                         | Val  Loss: 1.8193 | Val  Acc: 0.6187
 Site-USPS                          | Val  Loss: 1.7333 | Val  Acc: 0.5870
 Site-USPS                          | Val  Loss: 1.7273 | Val  Acc: 0.6331
 Site-SynthDigits                   | Val  Loss: 2.1011 | Val  Acc: 0.3478
 Site-SynthDigits                   | Val  Loss: 2.1190 | Val  Acc: 0.3094
 Site-MNIST-M                       | Val  Loss: 2.2296 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.2153 | Val  Acc: 0.2734
 Site-SVHN                          | Val  Loss: 2.1753 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1871 | Val  Acc: 0.2878
Average Valid Accuracy: 0.4177
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.5652
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.6187
 Best site-USPS                      | Epoch:12 | Val Acc: 0.5870
 Best site-USPS                      | Epoch:12 | Val Acc: 0.6331
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.3478
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.3094
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.2734
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2878
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 13 ============
 Site-MNIST                    | Train Loss: 1.7354 | Train Acc: 0.6873
 Site-MNIST                    | Train Loss: 1.8100 | Train Acc: 0.5848
 Site-USPS                     | Train Loss: 1.6588 | Train Acc: 0.6604
 Site-USPS                     | Train Loss: 1.6420 | Train Acc: 0.6843
 Site-SynthDigits              | Train Loss: 2.1347 | Train Acc: 0.2938
 Site-SynthDigits              | Train Loss: 2.0763 | Train Acc: 0.3892
 Site-MNIST-M                  | Train Loss: 2.2039 | Train Acc: 0.2695
 Site-MNIST-M                  | Train Loss: 2.2113 | Train Acc: 0.2475
 Site-SVHN                     | Train Loss: 2.1915 | Train Acc: 0.2642
 Site-SVHN                     | Train Loss: 2.1931 | Train Acc: 0.2395
 Site-MNIST                         | Val  Loss: 1.8241 | Val  Acc: 0.5761
 Site-MNIST                         | Val  Loss: 1.7899 | Val  Acc: 0.6331
 Site-USPS                          | Val  Loss: 1.6977 | Val  Acc: 0.6196
 Site-USPS                          | Val  Loss: 1.6914 | Val  Acc: 0.6511
 Site-SynthDigits                   | Val  Loss: 2.0877 | Val  Acc: 0.3478
 Site-SynthDigits                   | Val  Loss: 2.1059 | Val  Acc: 0.3058
 Site-MNIST-M                       | Val  Loss: 2.2252 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 2.2091 | Val  Acc: 0.2770
 Site-SVHN                          | Val  Loss: 2.1689 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1816 | Val  Acc: 0.2878
Average Valid Accuracy: 0.4263
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.5761
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.6331
 Best site-USPS                      | Epoch:13 | Val Acc: 0.6196
 Best site-USPS                      | Epoch:13 | Val Acc: 0.6511
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.3478
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.3058
 Best site-MNIST-M                   | Epoch:13 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:13 | Val Acc: 0.2770
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.2878
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 14 ============
 Site-MNIST                    | Train Loss: 1.7069 | Train Acc: 0.7035
 Site-MNIST                    | Train Loss: 1.7829 | Train Acc: 0.6036
 Site-USPS                     | Train Loss: 1.6166 | Train Acc: 0.6765
 Site-USPS                     | Train Loss: 1.6041 | Train Acc: 0.6987
 Site-SynthDigits              | Train Loss: 2.1202 | Train Acc: 0.3019
 Site-SynthDigits              | Train Loss: 2.0617 | Train Acc: 0.3973
 Site-MNIST-M                  | Train Loss: 2.1977 | Train Acc: 0.2857
 Site-MNIST-M                  | Train Loss: 2.2047 | Train Acc: 0.2475
 Site-SVHN                     | Train Loss: 2.1831 | Train Acc: 0.2749
 Site-SVHN                     | Train Loss: 2.1874 | Train Acc: 0.2413
 Site-MNIST                         | Val  Loss: 1.7982 | Val  Acc: 0.5761
 Site-MNIST                         | Val  Loss: 1.7626 | Val  Acc: 0.6403
 Site-USPS                          | Val  Loss: 1.6616 | Val  Acc: 0.6304
 Site-USPS                          | Val  Loss: 1.6544 | Val  Acc: 0.6511
 Site-SynthDigits                   | Val  Loss: 2.0746 | Val  Acc: 0.3478
 Site-SynthDigits                   | Val  Loss: 2.0929 | Val  Acc: 0.3058
 Site-MNIST-M                       | Val  Loss: 2.2207 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 2.2031 | Val  Acc: 0.2806
 Site-SVHN                          | Val  Loss: 2.1629 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1763 | Val  Acc: 0.2914
Average Valid Accuracy: 0.4289
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.5761
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.6403
 Best site-USPS                      | Epoch:14 | Val Acc: 0.6304
 Best site-USPS                      | Epoch:14 | Val Acc: 0.6511
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.3478
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.3058
 Best site-MNIST-M                   | Epoch:14 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:14 | Val Acc: 0.2806
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.2914
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 15 ============
 Site-MNIST                    | Train Loss: 1.6798 | Train Acc: 0.7089
 Site-MNIST                    | Train Loss: 1.7554 | Train Acc: 0.6063
 Site-USPS                     | Train Loss: 1.5780 | Train Acc: 0.6873
 Site-USPS                     | Train Loss: 1.5717 | Train Acc: 0.7076
 Site-SynthDigits              | Train Loss: 2.1053 | Train Acc: 0.3154
 Site-SynthDigits              | Train Loss: 2.0475 | Train Acc: 0.4027
 Site-MNIST-M                  | Train Loss: 2.1919 | Train Acc: 0.2911
 Site-MNIST-M                  | Train Loss: 2.1980 | Train Acc: 0.2538
 Site-SVHN                     | Train Loss: 2.1802 | Train Acc: 0.2749
 Site-SVHN                     | Train Loss: 2.1829 | Train Acc: 0.2439
 Site-MNIST                         | Val  Loss: 1.7705 | Val  Acc: 0.5761
 Site-MNIST                         | Val  Loss: 1.7342 | Val  Acc: 0.6475
 Site-USPS                          | Val  Loss: 1.6310 | Val  Acc: 0.6304
 Site-USPS                          | Val  Loss: 1.6225 | Val  Acc: 0.6511
 Site-SynthDigits                   | Val  Loss: 2.0613 | Val  Acc: 0.3696
 Site-SynthDigits                   | Val  Loss: 2.0796 | Val  Acc: 0.3129
 Site-MNIST-M                       | Val  Loss: 2.2162 | Val  Acc: 0.2717
 Site-MNIST-M                       | Val  Loss: 2.1970 | Val  Acc: 0.2878
 Site-SVHN                          | Val  Loss: 2.1569 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1711 | Val  Acc: 0.2878
Average Valid Accuracy: 0.4328
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.5761
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.6475
 Best site-USPS                      | Epoch:15 | Val Acc: 0.6304
 Best site-USPS                      | Epoch:15 | Val Acc: 0.6511
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.3696
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.3129
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.2717
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.2878
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2878
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 16 ============
 Site-MNIST                    | Train Loss: 1.6480 | Train Acc: 0.7197
 Site-MNIST                    | Train Loss: 1.7277 | Train Acc: 0.6161
 Site-USPS                     | Train Loss: 1.5493 | Train Acc: 0.6900
 Site-USPS                     | Train Loss: 1.5401 | Train Acc: 0.7103
 Site-SynthDigits              | Train Loss: 2.0955 | Train Acc: 0.3154
 Site-SynthDigits              | Train Loss: 2.0318 | Train Acc: 0.4108
 Site-MNIST-M                  | Train Loss: 2.1870 | Train Acc: 0.2938
 Site-MNIST-M                  | Train Loss: 2.1913 | Train Acc: 0.2619
 Site-SVHN                     | Train Loss: 2.1767 | Train Acc: 0.2776
 Site-SVHN                     | Train Loss: 2.1778 | Train Acc: 0.2484
 Site-MNIST                         | Val  Loss: 1.7440 | Val  Acc: 0.5870
 Site-MNIST                         | Val  Loss: 1.7065 | Val  Acc: 0.6475
 Site-USPS                          | Val  Loss: 1.6016 | Val  Acc: 0.6304
 Site-USPS                          | Val  Loss: 1.5936 | Val  Acc: 0.6511
 Site-SynthDigits                   | Val  Loss: 2.0467 | Val  Acc: 0.3804
 Site-SynthDigits                   | Val  Loss: 2.0649 | Val  Acc: 0.3165
 Site-MNIST-M                       | Val  Loss: 2.2113 | Val  Acc: 0.2826
 Site-MNIST-M                       | Val  Loss: 2.1906 | Val  Acc: 0.2878
 Site-SVHN                          | Val  Loss: 2.1516 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1661 | Val  Acc: 0.2914
Average Valid Accuracy: 0.4379
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.5870
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.6475
 Best site-USPS                      | Epoch:16 | Val Acc: 0.6304
 Best site-USPS                      | Epoch:16 | Val Acc: 0.6511
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.3804
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.3165
 Best site-MNIST-M                   | Epoch:16 | Val Acc: 0.2826
 Best site-MNIST-M                   | Epoch:16 | Val Acc: 0.2878
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.2914
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 17 ============
 Site-MNIST                    | Train Loss: 1.6215 | Train Acc: 0.7224
 Site-MNIST                    | Train Loss: 1.7041 | Train Acc: 0.6242
 Site-USPS                     | Train Loss: 1.5217 | Train Acc: 0.6900
 Site-USPS                     | Train Loss: 1.5083 | Train Acc: 0.7229
 Site-SynthDigits              | Train Loss: 2.0818 | Train Acc: 0.3127
 Site-SynthDigits              | Train Loss: 2.0178 | Train Acc: 0.4179
 Site-MNIST-M                  | Train Loss: 2.1791 | Train Acc: 0.3019
 Site-MNIST-M                  | Train Loss: 2.1842 | Train Acc: 0.2583
 Site-SVHN                     | Train Loss: 2.1702 | Train Acc: 0.2749
 Site-SVHN                     | Train Loss: 2.1723 | Train Acc: 0.2502
 Site-MNIST                         | Val  Loss: 1.7208 | Val  Acc: 0.6087
 Site-MNIST                         | Val  Loss: 1.6826 | Val  Acc: 0.6583
 Site-USPS                          | Val  Loss: 1.5726 | Val  Acc: 0.6413
 Site-USPS                          | Val  Loss: 1.5615 | Val  Acc: 0.6547
 Site-SynthDigits                   | Val  Loss: 2.0339 | Val  Acc: 0.3913
 Site-SynthDigits                   | Val  Loss: 2.0523 | Val  Acc: 0.3237
 Site-MNIST-M                       | Val  Loss: 2.2066 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1840 | Val  Acc: 0.2770
 Site-SVHN                          | Val  Loss: 2.1459 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1606 | Val  Acc: 0.2914
Average Valid Accuracy: 0.4401
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.6087
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.6583
 Best site-USPS                      | Epoch:17 | Val Acc: 0.6413
 Best site-USPS                      | Epoch:17 | Val Acc: 0.6547
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.3913
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.3237
 Best site-MNIST-M                   | Epoch:17 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:17 | Val Acc: 0.2770
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.2914
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 18 ============
 Site-MNIST                    | Train Loss: 1.5999 | Train Acc: 0.7358
 Site-MNIST                    | Train Loss: 1.6817 | Train Acc: 0.6323
 Site-USPS                     | Train Loss: 1.4918 | Train Acc: 0.6954
 Site-USPS                     | Train Loss: 1.4771 | Train Acc: 0.7309
 Site-SynthDigits              | Train Loss: 2.0699 | Train Acc: 0.3235
 Site-SynthDigits              | Train Loss: 2.0041 | Train Acc: 0.4188
 Site-MNIST-M                  | Train Loss: 2.1721 | Train Acc: 0.3019
 Site-MNIST-M                  | Train Loss: 2.1781 | Train Acc: 0.2628
 Site-SVHN                     | Train Loss: 2.1682 | Train Acc: 0.2749
 Site-SVHN                     | Train Loss: 2.1678 | Train Acc: 0.2520
 Site-MNIST                         | Val  Loss: 1.6983 | Val  Acc: 0.6196
 Site-MNIST                         | Val  Loss: 1.6594 | Val  Acc: 0.6655
 Site-USPS                          | Val  Loss: 1.5395 | Val  Acc: 0.6630
 Site-USPS                          | Val  Loss: 1.5310 | Val  Acc: 0.6727
 Site-SynthDigits                   | Val  Loss: 2.0212 | Val  Acc: 0.3804
 Site-SynthDigits                   | Val  Loss: 2.0399 | Val  Acc: 0.3309
 Site-MNIST-M                       | Val  Loss: 2.2023 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1782 | Val  Acc: 0.2806
 Site-SVHN                          | Val  Loss: 2.1402 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1554 | Val  Acc: 0.2914
Average Valid Accuracy: 0.4458
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.6196
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.6655
 Best site-USPS                      | Epoch:18 | Val Acc: 0.6630
 Best site-USPS                      | Epoch:18 | Val Acc: 0.6727
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.3804
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.3309
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.2806
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.2914
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 19 ============
 Site-MNIST                    | Train Loss: 1.5736 | Train Acc: 0.7385
 Site-MNIST                    | Train Loss: 1.6554 | Train Acc: 0.6377
 Site-USPS                     | Train Loss: 1.4706 | Train Acc: 0.7143
 Site-USPS                     | Train Loss: 1.4478 | Train Acc: 0.7408
 Site-SynthDigits              | Train Loss: 2.0609 | Train Acc: 0.3369
 Site-SynthDigits              | Train Loss: 1.9913 | Train Acc: 0.4269
 Site-MNIST-M                  | Train Loss: 2.1653 | Train Acc: 0.3046
 Site-MNIST-M                  | Train Loss: 2.1715 | Train Acc: 0.2691
 Site-SVHN                     | Train Loss: 2.1634 | Train Acc: 0.2749
 Site-SVHN                     | Train Loss: 2.1627 | Train Acc: 0.2520
 Site-MNIST                         | Val  Loss: 1.6731 | Val  Acc: 0.6196
 Site-MNIST                         | Val  Loss: 1.6326 | Val  Acc: 0.6655
 Site-USPS                          | Val  Loss: 1.5130 | Val  Acc: 0.6630
 Site-USPS                          | Val  Loss: 1.5012 | Val  Acc: 0.6871
 Site-SynthDigits                   | Val  Loss: 2.0083 | Val  Acc: 0.4022
 Site-SynthDigits                   | Val  Loss: 2.0277 | Val  Acc: 0.3525
 Site-MNIST-M                       | Val  Loss: 2.1964 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.1721 | Val  Acc: 0.2914
 Site-SVHN                          | Val  Loss: 2.1339 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1505 | Val  Acc: 0.2914
Average Valid Accuracy: 0.4516
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.6196
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.6655
 Best site-USPS                      | Epoch:19 | Val Acc: 0.6630
 Best site-USPS                      | Epoch:19 | Val Acc: 0.6871
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4022
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.3525
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.2914
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.2914
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
 Test site-MNIST                     | Epoch:19 | Test Acc: 0.6483
 Test site-USPS                      | Epoch:19 | Test Acc: 0.7441
 Test site-SynthDigits               | Epoch:19 | Test Acc: 0.3853
 Test site-MNIST-M                   | Epoch:19 | Test Acc: 0.2560
 Test site-SVHN                      | Epoch:19 | Test Acc: 0.2287
MNIST: 0.648, USPS: 0.744, SynthDigits: 0.385, MNIST-M: 0.256, SVHN: 0.229, 
Average Test Accuracy: 0.4525, domain std=0.2081, cluster std=-1.0000, individual std=0.2081, 
============ Train epoch 20 ============
 Site-MNIST                    | Train Loss: 1.5513 | Train Acc: 0.7358
 Site-MNIST                    | Train Loss: 1.6329 | Train Acc: 0.6484
 Site-USPS                     | Train Loss: 1.4421 | Train Acc: 0.7116
 Site-USPS                     | Train Loss: 1.4239 | Train Acc: 0.7381
 Site-SynthDigits              | Train Loss: 2.0457 | Train Acc: 0.3477
 Site-SynthDigits              | Train Loss: 1.9756 | Train Acc: 0.4296
 Site-MNIST-M                  | Train Loss: 2.1627 | Train Acc: 0.3154
 Site-MNIST-M                  | Train Loss: 2.1656 | Train Acc: 0.2771
 Site-SVHN                     | Train Loss: 2.1596 | Train Acc: 0.2749
 Site-SVHN                     | Train Loss: 2.1572 | Train Acc: 0.2538
 Site-MNIST                         | Val  Loss: 1.6500 | Val  Acc: 0.6196
 Site-MNIST                         | Val  Loss: 1.6096 | Val  Acc: 0.6727
 Site-USPS                          | Val  Loss: 1.4905 | Val  Acc: 0.6522
 Site-USPS                          | Val  Loss: 1.4788 | Val  Acc: 0.6835
 Site-SynthDigits                   | Val  Loss: 1.9941 | Val  Acc: 0.4022
 Site-SynthDigits                   | Val  Loss: 2.0132 | Val  Acc: 0.3597
 Site-MNIST-M                       | Val  Loss: 2.1923 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1656 | Val  Acc: 0.2986
 Site-SVHN                          | Val  Loss: 2.1292 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1460 | Val  Acc: 0.2950
Average Valid Accuracy: 0.4538
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.6196
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.6727
 Best site-USPS                      | Epoch:20 | Val Acc: 0.6522
 Best site-USPS                      | Epoch:20 | Val Acc: 0.6835
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.4022
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.3597
 Best site-MNIST-M                   | Epoch:20 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:20 | Val Acc: 0.2986
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.2950
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 21 ============
 Site-MNIST                    | Train Loss: 1.5175 | Train Acc: 0.7358
 Site-MNIST                    | Train Loss: 1.6120 | Train Acc: 0.6556
 Site-USPS                     | Train Loss: 1.4204 | Train Acc: 0.7224
 Site-USPS                     | Train Loss: 1.3952 | Train Acc: 0.7525
 Site-SynthDigits              | Train Loss: 2.0363 | Train Acc: 0.3639
 Site-SynthDigits              | Train Loss: 1.9629 | Train Acc: 0.4323
 Site-MNIST-M                  | Train Loss: 2.1517 | Train Acc: 0.3235
 Site-MNIST-M                  | Train Loss: 2.1583 | Train Acc: 0.2888
 Site-SVHN                     | Train Loss: 2.1512 | Train Acc: 0.2776
 Site-SVHN                     | Train Loss: 2.1522 | Train Acc: 0.2556
 Site-MNIST                         | Val  Loss: 1.6297 | Val  Acc: 0.6196
 Site-MNIST                         | Val  Loss: 1.5889 | Val  Acc: 0.6727
 Site-USPS                          | Val  Loss: 1.4632 | Val  Acc: 0.6848
 Site-USPS                          | Val  Loss: 1.4504 | Val  Acc: 0.6978
 Site-SynthDigits                   | Val  Loss: 1.9824 | Val  Acc: 0.4130
 Site-SynthDigits                   | Val  Loss: 2.0017 | Val  Acc: 0.3705
 Site-MNIST-M                       | Val  Loss: 2.1870 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.1595 | Val  Acc: 0.3129
 Site-SVHN                          | Val  Loss: 2.1223 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1406 | Val  Acc: 0.2950
Average Valid Accuracy: 0.4621
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.6196
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.6727
 Best site-USPS                      | Epoch:21 | Val Acc: 0.6848
 Best site-USPS                      | Epoch:21 | Val Acc: 0.6978
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.4130
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.3705
 Best site-MNIST-M                   | Epoch:21 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:21 | Val Acc: 0.3129
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.2950
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 22 ============
 Site-MNIST                    | Train Loss: 1.4978 | Train Acc: 0.7412
 Site-MNIST                    | Train Loss: 1.5906 | Train Acc: 0.6628
 Site-USPS                     | Train Loss: 1.3897 | Train Acc: 0.7305
 Site-USPS                     | Train Loss: 1.3708 | Train Acc: 0.7632
 Site-SynthDigits              | Train Loss: 2.0247 | Train Acc: 0.3585
 Site-SynthDigits              | Train Loss: 1.9506 | Train Acc: 0.4350
 Site-MNIST-M                  | Train Loss: 2.1463 | Train Acc: 0.3261
 Site-MNIST-M                  | Train Loss: 2.1511 | Train Acc: 0.2888
 Site-SVHN                     | Train Loss: 2.1506 | Train Acc: 0.2776
 Site-SVHN                     | Train Loss: 2.1473 | Train Acc: 0.2565
 Site-MNIST                         | Val  Loss: 1.6089 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.5673 | Val  Acc: 0.6799
 Site-USPS                          | Val  Loss: 1.4387 | Val  Acc: 0.6739
 Site-USPS                          | Val  Loss: 1.4252 | Val  Acc: 0.7014
 Site-SynthDigits                   | Val  Loss: 1.9699 | Val  Acc: 0.4130
 Site-SynthDigits                   | Val  Loss: 1.9899 | Val  Acc: 0.3741
 Site-MNIST-M                       | Val  Loss: 2.1812 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 2.1537 | Val  Acc: 0.3201
 Site-SVHN                          | Val  Loss: 2.1159 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1356 | Val  Acc: 0.2986
Average Valid Accuracy: 0.4678
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.6799
 Best site-USPS                      | Epoch:22 | Val Acc: 0.6739
 Best site-USPS                      | Epoch:22 | Val Acc: 0.7014
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.4130
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.3741
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.3201
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.2986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 23 ============
 Site-MNIST                    | Train Loss: 1.4807 | Train Acc: 0.7493
 Site-MNIST                    | Train Loss: 1.5710 | Train Acc: 0.6682
 Site-USPS                     | Train Loss: 1.3644 | Train Acc: 0.7466
 Site-USPS                     | Train Loss: 1.3444 | Train Acc: 0.7794
 Site-SynthDigits              | Train Loss: 2.0156 | Train Acc: 0.3612
 Site-SynthDigits              | Train Loss: 1.9380 | Train Acc: 0.4377
 Site-MNIST-M                  | Train Loss: 2.1330 | Train Acc: 0.3450
 Site-MNIST-M                  | Train Loss: 2.1434 | Train Acc: 0.2897
 Site-SVHN                     | Train Loss: 2.1469 | Train Acc: 0.2803
 Site-SVHN                     | Train Loss: 2.1419 | Train Acc: 0.2610
 Site-MNIST                         | Val  Loss: 1.5909 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.5494 | Val  Acc: 0.6835
 Site-USPS                          | Val  Loss: 1.4132 | Val  Acc: 0.6739
 Site-USPS                          | Val  Loss: 1.3982 | Val  Acc: 0.7086
 Site-SynthDigits                   | Val  Loss: 1.9585 | Val  Acc: 0.4130
 Site-SynthDigits                   | Val  Loss: 1.9793 | Val  Acc: 0.3813
 Site-MNIST-M                       | Val  Loss: 2.1747 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1468 | Val  Acc: 0.3201
 Site-SVHN                          | Val  Loss: 2.1092 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1298 | Val  Acc: 0.2986
Average Valid Accuracy: 0.4686
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.6835
 Best site-USPS                      | Epoch:23 | Val Acc: 0.6739
 Best site-USPS                      | Epoch:23 | Val Acc: 0.7086
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.4130
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.3813
 Best site-MNIST-M                   | Epoch:23 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:23 | Val Acc: 0.3201
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.2986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 24 ============
 Site-MNIST                    | Train Loss: 1.4657 | Train Acc: 0.7547
 Site-MNIST                    | Train Loss: 1.5528 | Train Acc: 0.6717
 Site-USPS                     | Train Loss: 1.3442 | Train Acc: 0.7574
 Site-USPS                     | Train Loss: 1.3225 | Train Acc: 0.7776
 Site-SynthDigits              | Train Loss: 2.0023 | Train Acc: 0.3666
 Site-SynthDigits              | Train Loss: 1.9239 | Train Acc: 0.4430
 Site-MNIST-M                  | Train Loss: 2.1308 | Train Acc: 0.3423
 Site-MNIST-M                  | Train Loss: 2.1384 | Train Acc: 0.2951
 Site-SVHN                     | Train Loss: 2.1446 | Train Acc: 0.2803
 Site-SVHN                     | Train Loss: 2.1354 | Train Acc: 0.2655
 Site-MNIST                         | Val  Loss: 1.5715 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.5307 | Val  Acc: 0.6942
 Site-USPS                          | Val  Loss: 1.3938 | Val  Acc: 0.6848
 Site-USPS                          | Val  Loss: 1.3781 | Val  Acc: 0.7194
 Site-SynthDigits                   | Val  Loss: 1.9459 | Val  Acc: 0.4348
 Site-SynthDigits                   | Val  Loss: 1.9664 | Val  Acc: 0.3813
 Site-MNIST-M                       | Val  Loss: 2.1706 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.1406 | Val  Acc: 0.3094
 Site-SVHN                          | Val  Loss: 2.1025 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1241 | Val  Acc: 0.2986
Average Valid Accuracy: 0.4740
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.6630
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.6942
 Best site-USPS                      | Epoch:24 | Val Acc: 0.6848
 Best site-USPS                      | Epoch:24 | Val Acc: 0.7194
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.4348
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.3813
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.3094
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.2986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 25 ============
 Site-MNIST                    | Train Loss: 1.4486 | Train Acc: 0.7574
 Site-MNIST                    | Train Loss: 1.5343 | Train Acc: 0.6735
 Site-USPS                     | Train Loss: 1.3241 | Train Acc: 0.7682
 Site-USPS                     | Train Loss: 1.3006 | Train Acc: 0.7883
 Site-SynthDigits              | Train Loss: 1.9909 | Train Acc: 0.3693
 Site-SynthDigits              | Train Loss: 1.9109 | Train Acc: 0.4484
 Site-MNIST-M                  | Train Loss: 2.1224 | Train Acc: 0.3585
 Site-MNIST-M                  | Train Loss: 2.1320 | Train Acc: 0.2960
 Site-SVHN                     | Train Loss: 2.1375 | Train Acc: 0.2911
 Site-SVHN                     | Train Loss: 2.1289 | Train Acc: 0.2700
 Site-MNIST                         | Val  Loss: 1.5535 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.5126 | Val  Acc: 0.6978
 Site-USPS                          | Val  Loss: 1.3739 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.3567 | Val  Acc: 0.7266
 Site-SynthDigits                   | Val  Loss: 1.9331 | Val  Acc: 0.4348
 Site-SynthDigits                   | Val  Loss: 1.9546 | Val  Acc: 0.3849
 Site-MNIST-M                       | Val  Loss: 2.1658 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1330 | Val  Acc: 0.3201
 Site-SVHN                          | Val  Loss: 2.0959 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.1188 | Val  Acc: 0.3058
Average Valid Accuracy: 0.4805
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.6630
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.6978
 Best site-USPS                      | Epoch:25 | Val Acc: 0.6957
 Best site-USPS                      | Epoch:25 | Val Acc: 0.7266
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.4348
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.3849
 Best site-MNIST-M                   | Epoch:25 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:25 | Val Acc: 0.3201
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.3058
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 26 ============
 Site-MNIST                    | Train Loss: 1.4250 | Train Acc: 0.7574
 Site-MNIST                    | Train Loss: 1.5160 | Train Acc: 0.6735
 Site-USPS                     | Train Loss: 1.2875 | Train Acc: 0.7736
 Site-USPS                     | Train Loss: 1.2741 | Train Acc: 0.7955
 Site-SynthDigits              | Train Loss: 1.9811 | Train Acc: 0.3801
 Site-SynthDigits              | Train Loss: 1.8992 | Train Acc: 0.4511
 Site-MNIST-M                  | Train Loss: 2.1033 | Train Acc: 0.3612
 Site-MNIST-M                  | Train Loss: 2.1242 | Train Acc: 0.2969
 Site-SVHN                     | Train Loss: 2.1326 | Train Acc: 0.2911
 Site-SVHN                     | Train Loss: 2.1233 | Train Acc: 0.2709
 Site-MNIST                         | Val  Loss: 1.5362 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.4956 | Val  Acc: 0.7050
 Site-USPS                          | Val  Loss: 1.3486 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.3302 | Val  Acc: 0.7338
 Site-SynthDigits                   | Val  Loss: 1.9203 | Val  Acc: 0.4239
 Site-SynthDigits                   | Val  Loss: 1.9446 | Val  Acc: 0.3813
 Site-MNIST-M                       | Val  Loss: 2.1614 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.1251 | Val  Acc: 0.3201
 Site-SVHN                          | Val  Loss: 2.0875 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.1131 | Val  Acc: 0.3058
Average Valid Accuracy: 0.4805
============ Train epoch 27 ============
 Site-MNIST                    | Train Loss: 1.4144 | Train Acc: 0.7601
 Site-MNIST                    | Train Loss: 1.4986 | Train Acc: 0.6807
 Site-USPS                     | Train Loss: 1.2726 | Train Acc: 0.7817
 Site-USPS                     | Train Loss: 1.2537 | Train Acc: 0.8009
 Site-SynthDigits              | Train Loss: 1.9685 | Train Acc: 0.3854
 Site-SynthDigits              | Train Loss: 1.8859 | Train Acc: 0.4565
 Site-MNIST-M                  | Train Loss: 2.1032 | Train Acc: 0.3585
 Site-MNIST-M                  | Train Loss: 2.1188 | Train Acc: 0.3004
 Site-SVHN                     | Train Loss: 2.1304 | Train Acc: 0.2965
 Site-SVHN                     | Train Loss: 2.1164 | Train Acc: 0.2744
 Site-MNIST                         | Val  Loss: 1.5183 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.4785 | Val  Acc: 0.7230
 Site-USPS                          | Val  Loss: 1.3299 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.3102 | Val  Acc: 0.7410
 Site-SynthDigits                   | Val  Loss: 1.9079 | Val  Acc: 0.4239
 Site-SynthDigits                   | Val  Loss: 1.9325 | Val  Acc: 0.3849
 Site-MNIST-M                       | Val  Loss: 2.1602 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1180 | Val  Acc: 0.3309
 Site-SVHN                          | Val  Loss: 2.0810 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1074 | Val  Acc: 0.3094
Average Valid Accuracy: 0.4870
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.6739
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.7230
 Best site-USPS                      | Epoch:27 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:27 | Val Acc: 0.7410
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.4239
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.3849
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.3309
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.3094
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 28 ============
 Site-MNIST                    | Train Loss: 1.3895 | Train Acc: 0.7682
 Site-MNIST                    | Train Loss: 1.4815 | Train Acc: 0.6780
 Site-USPS                     | Train Loss: 1.2591 | Train Acc: 0.7817
 Site-USPS                     | Train Loss: 1.2358 | Train Acc: 0.7991
 Site-SynthDigits              | Train Loss: 1.9552 | Train Acc: 0.3935
 Site-SynthDigits              | Train Loss: 1.8713 | Train Acc: 0.4529
 Site-MNIST-M                  | Train Loss: 2.0924 | Train Acc: 0.3612
 Site-MNIST-M                  | Train Loss: 2.1156 | Train Acc: 0.3013
 Site-SVHN                     | Train Loss: 2.1236 | Train Acc: 0.2965
 Site-SVHN                     | Train Loss: 2.1072 | Train Acc: 0.2771
 Site-MNIST                         | Val  Loss: 1.5009 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.4631 | Val  Acc: 0.7230
 Site-USPS                          | Val  Loss: 1.3131 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.2937 | Val  Acc: 0.7446
 Site-SynthDigits                   | Val  Loss: 1.8924 | Val  Acc: 0.4348
 Site-SynthDigits                   | Val  Loss: 1.9182 | Val  Acc: 0.3957
 Site-MNIST-M                       | Val  Loss: 2.1651 | Val  Acc: 0.2065
 Site-MNIST-M                       | Val  Loss: 2.1120 | Val  Acc: 0.3237
 Site-SVHN                          | Val  Loss: 2.0718 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0992 | Val  Acc: 0.3165
Average Valid Accuracy: 0.4841
============ Train epoch 29 ============
 Site-MNIST                    | Train Loss: 1.3808 | Train Acc: 0.7628
 Site-MNIST                    | Train Loss: 1.4692 | Train Acc: 0.6807
 Site-USPS                     | Train Loss: 1.2324 | Train Acc: 0.7790
 Site-USPS                     | Train Loss: 1.2186 | Train Acc: 0.8018
 Site-SynthDigits              | Train Loss: 1.9394 | Train Acc: 0.4016
 Site-SynthDigits              | Train Loss: 1.8534 | Train Acc: 0.4601
 Site-MNIST-M                  | Train Loss: 2.0815 | Train Acc: 0.3558
 Site-MNIST-M                  | Train Loss: 2.1074 | Train Acc: 0.3013
 Site-SVHN                     | Train Loss: 2.1164 | Train Acc: 0.3046
 Site-SVHN                     | Train Loss: 2.0948 | Train Acc: 0.2924
 Site-MNIST                         | Val  Loss: 1.4855 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.4543 | Val  Acc: 0.7302
 Site-USPS                          | Val  Loss: 1.2994 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.2748 | Val  Acc: 0.7518
 Site-SynthDigits                   | Val  Loss: 1.8694 | Val  Acc: 0.4457
 Site-SynthDigits                   | Val  Loss: 1.9001 | Val  Acc: 0.4101
 Site-MNIST-M                       | Val  Loss: 2.1618 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.1001 | Val  Acc: 0.3345
 Site-SVHN                          | Val  Loss: 2.0607 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0879 | Val  Acc: 0.3309
Average Valid Accuracy: 0.4916
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.6739
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.7302
 Best site-USPS                      | Epoch:29 | Val Acc: 0.6957
 Best site-USPS                      | Epoch:29 | Val Acc: 0.7518
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.4457
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.4101
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.3345
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3309
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
 Test site-MNIST                     | Epoch:29 | Test Acc: 0.6866
 Test site-USPS                      | Epoch:29 | Test Acc: 0.8226
 Test site-SynthDigits               | Epoch:29 | Test Acc: 0.4341
 Test site-MNIST-M                   | Epoch:29 | Test Acc: 0.2941
 Test site-SVHN                      | Epoch:29 | Test Acc: 0.2617
MNIST: 0.687, USPS: 0.823, SynthDigits: 0.434, MNIST-M: 0.294, SVHN: 0.262, 
Average Test Accuracy: 0.4998, domain std=0.2202, cluster std=-1.0000, individual std=0.2202, 
============ Train epoch 30 ============
 Site-MNIST                    | Train Loss: 1.3675 | Train Acc: 0.7574
 Site-MNIST                    | Train Loss: 1.4542 | Train Acc: 0.6816
 Site-USPS                     | Train Loss: 1.2247 | Train Acc: 0.8032
 Site-USPS                     | Train Loss: 1.2008 | Train Acc: 0.8054
 Site-SynthDigits              | Train Loss: 1.9207 | Train Acc: 0.4070
 Site-SynthDigits              | Train Loss: 1.8350 | Train Acc: 0.4655
 Site-MNIST-M                  | Train Loss: 2.0717 | Train Acc: 0.3666
 Site-MNIST-M                  | Train Loss: 2.0972 | Train Acc: 0.3076
 Site-SVHN                     | Train Loss: 2.1027 | Train Acc: 0.3019
 Site-SVHN                     | Train Loss: 2.0854 | Train Acc: 0.2987
 Site-MNIST                         | Val  Loss: 1.4690 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.4404 | Val  Acc: 0.7194
 Site-USPS                          | Val  Loss: 1.2824 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.2566 | Val  Acc: 0.7770
 Site-SynthDigits                   | Val  Loss: 1.8486 | Val  Acc: 0.4457
 Site-SynthDigits                   | Val  Loss: 1.8825 | Val  Acc: 0.4173
 Site-MNIST-M                       | Val  Loss: 2.1460 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.0841 | Val  Acc: 0.3381
 Site-SVHN                          | Val  Loss: 2.0525 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0783 | Val  Acc: 0.3309
Average Valid Accuracy: 0.4941
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.6739
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.7194
 Best site-USPS                      | Epoch:30 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:30 | Val Acc: 0.7770
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.4457
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.4173
 Best site-MNIST-M                   | Epoch:30 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:30 | Val Acc: 0.3381
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.3309
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 31 ============
 Site-MNIST                    | Train Loss: 1.3529 | Train Acc: 0.7574
 Site-MNIST                    | Train Loss: 1.4345 | Train Acc: 0.6843
 Site-USPS                     | Train Loss: 1.1972 | Train Acc: 0.8167
 Site-USPS                     | Train Loss: 1.1790 | Train Acc: 0.8143
 Site-SynthDigits              | Train Loss: 1.9103 | Train Acc: 0.4016
 Site-SynthDigits              | Train Loss: 1.8207 | Train Acc: 0.4691
 Site-MNIST-M                  | Train Loss: 2.0518 | Train Acc: 0.3585
 Site-MNIST-M                  | Train Loss: 2.0864 | Train Acc: 0.3067
 Site-SVHN                     | Train Loss: 2.1014 | Train Acc: 0.2992
 Site-SVHN                     | Train Loss: 2.0786 | Train Acc: 0.3022
 Site-MNIST                         | Val  Loss: 1.4494 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 1.4211 | Val  Acc: 0.7230
 Site-USPS                          | Val  Loss: 1.2611 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.2340 | Val  Acc: 0.7770
 Site-SynthDigits                   | Val  Loss: 1.8344 | Val  Acc: 0.4457
 Site-SynthDigits                   | Val  Loss: 1.8691 | Val  Acc: 0.4173
 Site-MNIST-M                       | Val  Loss: 2.1318 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.0704 | Val  Acc: 0.3345
 Site-SVHN                          | Val  Loss: 2.0433 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0718 | Val  Acc: 0.3237
Average Valid Accuracy: 0.4945
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.7230
 Best site-USPS                      | Epoch:31 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:31 | Val Acc: 0.7770
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.4457
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.4173
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.3345
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.3237
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 32 ============
 Site-MNIST                    | Train Loss: 1.3274 | Train Acc: 0.7574
 Site-MNIST                    | Train Loss: 1.4181 | Train Acc: 0.6744
 Site-USPS                     | Train Loss: 1.1835 | Train Acc: 0.8167
 Site-USPS                     | Train Loss: 1.1628 | Train Acc: 0.8170
 Site-SynthDigits              | Train Loss: 1.8987 | Train Acc: 0.4016
 Site-SynthDigits              | Train Loss: 1.8034 | Train Acc: 0.4870
 Site-MNIST-M                  | Train Loss: 2.0457 | Train Acc: 0.3639
 Site-MNIST-M                  | Train Loss: 2.0788 | Train Acc: 0.3121
 Site-SVHN                     | Train Loss: 2.0961 | Train Acc: 0.3181
 Site-SVHN                     | Train Loss: 2.0713 | Train Acc: 0.3022
 Site-MNIST                         | Val  Loss: 1.4309 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 1.4048 | Val  Acc: 0.7158
 Site-USPS                          | Val  Loss: 1.2435 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 1.2164 | Val  Acc: 0.7914
 Site-SynthDigits                   | Val  Loss: 1.8140 | Val  Acc: 0.4565
 Site-SynthDigits                   | Val  Loss: 1.8509 | Val  Acc: 0.4209
 Site-MNIST-M                       | Val  Loss: 2.1180 | Val  Acc: 0.2174
 Site-MNIST-M                       | Val  Loss: 2.0599 | Val  Acc: 0.3417
 Site-SVHN                          | Val  Loss: 2.0357 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0644 | Val  Acc: 0.3165
Average Valid Accuracy: 0.4999
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.7158
 Best site-USPS                      | Epoch:32 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:32 | Val Acc: 0.7914
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.4565
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.4209
 Best site-MNIST-M                   | Epoch:32 | Val Acc: 0.2174
 Best site-MNIST-M                   | Epoch:32 | Val Acc: 0.3417
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.3165
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 33 ============
 Site-MNIST                    | Train Loss: 1.3154 | Train Acc: 0.7574
 Site-MNIST                    | Train Loss: 1.4029 | Train Acc: 0.6771
 Site-USPS                     | Train Loss: 1.1695 | Train Acc: 0.8221
 Site-USPS                     | Train Loss: 1.1507 | Train Acc: 0.8224
 Site-SynthDigits              | Train Loss: 1.8806 | Train Acc: 0.4016
 Site-SynthDigits              | Train Loss: 1.7859 | Train Acc: 0.4969
 Site-MNIST-M                  | Train Loss: 2.0379 | Train Acc: 0.3612
 Site-MNIST-M                  | Train Loss: 2.0700 | Train Acc: 0.3211
 Site-SVHN                     | Train Loss: 2.0885 | Train Acc: 0.3181
 Site-SVHN                     | Train Loss: 2.0622 | Train Acc: 0.3022
 Site-MNIST                         | Val  Loss: 1.4136 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.3888 | Val  Acc: 0.7194
 Site-USPS                          | Val  Loss: 1.2337 | Val  Acc: 0.7609
 Site-USPS                          | Val  Loss: 1.2047 | Val  Acc: 0.8094
 Site-SynthDigits                   | Val  Loss: 1.7972 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.8333 | Val  Acc: 0.4317
 Site-MNIST-M                       | Val  Loss: 2.1070 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.0478 | Val  Acc: 0.3525
 Site-SVHN                          | Val  Loss: 2.0266 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0557 | Val  Acc: 0.3165
Average Valid Accuracy: 0.5075
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.6739
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.7194
 Best site-USPS                      | Epoch:33 | Val Acc: 0.7609
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8094
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.4674
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.4317
 Best site-MNIST-M                   | Epoch:33 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:33 | Val Acc: 0.3525
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.3165
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 34 ============
 Site-MNIST                    | Train Loss: 1.2954 | Train Acc: 0.7655
 Site-MNIST                    | Train Loss: 1.3852 | Train Acc: 0.6834
 Site-USPS                     | Train Loss: 1.1611 | Train Acc: 0.8221
 Site-USPS                     | Train Loss: 1.1376 | Train Acc: 0.8242
 Site-SynthDigits              | Train Loss: 1.8679 | Train Acc: 0.4124
 Site-SynthDigits              | Train Loss: 1.7718 | Train Acc: 0.5013
 Site-MNIST-M                  | Train Loss: 2.0313 | Train Acc: 0.3639
 Site-MNIST-M                  | Train Loss: 2.0626 | Train Acc: 0.3247
 Site-SVHN                     | Train Loss: 2.0786 | Train Acc: 0.3235
 Site-SVHN                     | Train Loss: 2.0543 | Train Acc: 0.3121
 Site-MNIST                         | Val  Loss: 1.3955 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 1.3716 | Val  Acc: 0.7230
 Site-USPS                          | Val  Loss: 1.2208 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 1.1907 | Val  Acc: 0.8094
 Site-SynthDigits                   | Val  Loss: 1.7824 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.8174 | Val  Acc: 0.4424
 Site-MNIST-M                       | Val  Loss: 2.0993 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 2.0394 | Val  Acc: 0.3669
 Site-SVHN                          | Val  Loss: 2.0181 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0489 | Val  Acc: 0.3309
Average Valid Accuracy: 0.5162
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.7230
 Best site-USPS                      | Epoch:34 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:34 | Val Acc: 0.8094
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.4674
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.4424
 Best site-MNIST-M                   | Epoch:34 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:34 | Val Acc: 0.3669
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.3309
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 35 ============
 Site-MNIST                    | Train Loss: 1.2757 | Train Acc: 0.7628
 Site-MNIST                    | Train Loss: 1.3643 | Train Acc: 0.6897
 Site-USPS                     | Train Loss: 1.1335 | Train Acc: 0.8275
 Site-USPS                     | Train Loss: 1.1168 | Train Acc: 0.8278
 Site-SynthDigits              | Train Loss: 1.8571 | Train Acc: 0.4178
 Site-SynthDigits              | Train Loss: 1.7612 | Train Acc: 0.5022
 Site-MNIST-M                  | Train Loss: 2.0228 | Train Acc: 0.3639
 Site-MNIST-M                  | Train Loss: 2.0524 | Train Acc: 0.3300
 Site-SVHN                     | Train Loss: 2.0829 | Train Acc: 0.3181
 Site-SVHN                     | Train Loss: 2.0513 | Train Acc: 0.3067
 Site-MNIST                         | Val  Loss: 1.3753 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 1.3503 | Val  Acc: 0.7266
 Site-USPS                          | Val  Loss: 1.2000 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 1.1705 | Val  Acc: 0.8201
 Site-SynthDigits                   | Val  Loss: 1.7723 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.8084 | Val  Acc: 0.4460
 Site-MNIST-M                       | Val  Loss: 2.0891 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.0301 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 2.0144 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0443 | Val  Acc: 0.3273
Average Valid Accuracy: 0.5165
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.7266
 Best site-USPS                      | Epoch:35 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:35 | Val Acc: 0.8201
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.4674
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.4460
 Best site-MNIST-M                   | Epoch:35 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:35 | Val Acc: 0.3561
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.3273
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 36 ============
 Site-MNIST                    | Train Loss: 1.2619 | Train Acc: 0.7628
 Site-MNIST                    | Train Loss: 1.3529 | Train Acc: 0.6906
 Site-USPS                     | Train Loss: 1.1246 | Train Acc: 0.8221
 Site-USPS                     | Train Loss: 1.1017 | Train Acc: 0.8269
 Site-SynthDigits              | Train Loss: 1.8407 | Train Acc: 0.4205
 Site-SynthDigits              | Train Loss: 1.7467 | Train Acc: 0.5058
 Site-MNIST-M                  | Train Loss: 2.0221 | Train Acc: 0.3801
 Site-MNIST-M                  | Train Loss: 2.0496 | Train Acc: 0.3265
 Site-SVHN                     | Train Loss: 2.0687 | Train Acc: 0.3235
 Site-SVHN                     | Train Loss: 2.0432 | Train Acc: 0.3103
 Site-MNIST                         | Val  Loss: 1.3615 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 1.3391 | Val  Acc: 0.7302
 Site-USPS                          | Val  Loss: 1.1874 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 1.1566 | Val  Acc: 0.8129
 Site-SynthDigits                   | Val  Loss: 1.7545 | Val  Acc: 0.4565
 Site-SynthDigits                   | Val  Loss: 1.7926 | Val  Acc: 0.4424
 Site-MNIST-M                       | Val  Loss: 2.0843 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 2.0255 | Val  Acc: 0.3705
 Site-SVHN                          | Val  Loss: 2.0054 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0366 | Val  Acc: 0.3345
Average Valid Accuracy: 0.5169
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.7302
 Best site-USPS                      | Epoch:36 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8129
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.4565
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.4424
 Best site-MNIST-M                   | Epoch:36 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:36 | Val Acc: 0.3705
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.3345
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 37 ============
 Site-MNIST                    | Train Loss: 1.2525 | Train Acc: 0.7628
 Site-MNIST                    | Train Loss: 1.3327 | Train Acc: 0.7022
 Site-USPS                     | Train Loss: 1.1049 | Train Acc: 0.8221
 Site-USPS                     | Train Loss: 1.0822 | Train Acc: 0.8305
 Site-SynthDigits              | Train Loss: 1.8345 | Train Acc: 0.4232
 Site-SynthDigits              | Train Loss: 1.7354 | Train Acc: 0.5103
 Site-MNIST-M                  | Train Loss: 2.0113 | Train Acc: 0.3666
 Site-MNIST-M                  | Train Loss: 2.0430 | Train Acc: 0.3318
 Site-SVHN                     | Train Loss: 2.0706 | Train Acc: 0.3235
 Site-SVHN                     | Train Loss: 2.0386 | Train Acc: 0.3139
 Site-MNIST                         | Val  Loss: 1.3440 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.3192 | Val  Acc: 0.7446
 Site-USPS                          | Val  Loss: 1.1660 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 1.1366 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.7464 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.7821 | Val  Acc: 0.4460
 Site-MNIST-M                       | Val  Loss: 2.0786 | Val  Acc: 0.2826
 Site-MNIST-M                       | Val  Loss: 2.0181 | Val  Acc: 0.3669
 Site-SVHN                          | Val  Loss: 1.9986 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0323 | Val  Acc: 0.3345
Average Valid Accuracy: 0.5270
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.7446
 Best site-USPS                      | Epoch:37 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.4674
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.4460
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.2826
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.3669
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.3345
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 38 ============
 Site-MNIST                    | Train Loss: 1.2369 | Train Acc: 0.7601
 Site-MNIST                    | Train Loss: 1.3190 | Train Acc: 0.7013
 Site-USPS                     | Train Loss: 1.1037 | Train Acc: 0.8086
 Site-USPS                     | Train Loss: 1.0764 | Train Acc: 0.8287
 Site-SynthDigits              | Train Loss: 1.8191 | Train Acc: 0.4420
 Site-SynthDigits              | Train Loss: 1.7195 | Train Acc: 0.5121
 Site-MNIST-M                  | Train Loss: 2.0006 | Train Acc: 0.3639
 Site-MNIST-M                  | Train Loss: 2.0381 | Train Acc: 0.3327
 Site-SVHN                     | Train Loss: 2.0670 | Train Acc: 0.3288
 Site-SVHN                     | Train Loss: 2.0301 | Train Acc: 0.3184
 Site-MNIST                         | Val  Loss: 1.3274 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 1.3050 | Val  Acc: 0.7410
 Site-USPS                          | Val  Loss: 1.1643 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 1.1325 | Val  Acc: 0.8058
 Site-SynthDigits                   | Val  Loss: 1.7330 | Val  Acc: 0.4783
 Site-SynthDigits                   | Val  Loss: 1.7663 | Val  Acc: 0.4568
 Site-MNIST-M                       | Val  Loss: 2.0749 | Val  Acc: 0.2717
 Site-MNIST-M                       | Val  Loss: 2.0130 | Val  Acc: 0.3633
 Site-SVHN                          | Val  Loss: 1.9898 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0248 | Val  Acc: 0.3345
Average Valid Accuracy: 0.5245
============ Train epoch 39 ============
 Site-MNIST                    | Train Loss: 1.2215 | Train Acc: 0.7736
 Site-MNIST                    | Train Loss: 1.3043 | Train Acc: 0.7112
 Site-USPS                     | Train Loss: 1.0791 | Train Acc: 0.8248
 Site-USPS                     | Train Loss: 1.0620 | Train Acc: 0.8350
 Site-SynthDigits              | Train Loss: 1.8090 | Train Acc: 0.4447
 Site-SynthDigits              | Train Loss: 1.7102 | Train Acc: 0.5184
 Site-MNIST-M                  | Train Loss: 1.9886 | Train Acc: 0.3666
 Site-MNIST-M                  | Train Loss: 2.0293 | Train Acc: 0.3399
 Site-SVHN                     | Train Loss: 2.0595 | Train Acc: 0.3315
 Site-SVHN                     | Train Loss: 2.0258 | Train Acc: 0.3193
 Site-MNIST                         | Val  Loss: 1.3114 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 1.2895 | Val  Acc: 0.7518
 Site-USPS                          | Val  Loss: 1.1499 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 1.1158 | Val  Acc: 0.8201
 Site-SynthDigits                   | Val  Loss: 1.7209 | Val  Acc: 0.4783
 Site-SynthDigits                   | Val  Loss: 1.7561 | Val  Acc: 0.4604
 Site-MNIST-M                       | Val  Loss: 2.0656 | Val  Acc: 0.3043
 Site-MNIST-M                       | Val  Loss: 2.0030 | Val  Acc: 0.3705
 Site-SVHN                          | Val  Loss: 1.9843 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0196 | Val  Acc: 0.3381
Average Valid Accuracy: 0.5339
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.7518
 Best site-USPS                      | Epoch:39 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8201
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.4783
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.4604
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.3043
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.3705
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.3381
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
 Test site-MNIST                     | Epoch:39 | Test Acc: 0.7247
 Test site-USPS                      | Epoch:39 | Test Acc: 0.8473
 Test site-SynthDigits               | Epoch:39 | Test Acc: 0.4869
 Test site-MNIST-M                   | Epoch:39 | Test Acc: 0.3334
 Test site-SVHN                      | Epoch:39 | Test Acc: 0.2947
MNIST: 0.725, USPS: 0.847, SynthDigits: 0.487, MNIST-M: 0.333, SVHN: 0.295, 
Average Test Accuracy: 0.5374, domain std=0.2164, cluster std=-1.0000, individual std=0.2164, 
============ Train epoch 40 ============
 Site-MNIST                    | Train Loss: 1.1999 | Train Acc: 0.7844
 Site-MNIST                    | Train Loss: 1.2867 | Train Acc: 0.7238
 Site-USPS                     | Train Loss: 1.0631 | Train Acc: 0.8410
 Site-USPS                     | Train Loss: 1.0467 | Train Acc: 0.8377
 Site-SynthDigits              | Train Loss: 1.7947 | Train Acc: 0.4367
 Site-SynthDigits              | Train Loss: 1.6987 | Train Acc: 0.5175
 Site-MNIST-M                  | Train Loss: 1.9798 | Train Acc: 0.3801
 Site-MNIST-M                  | Train Loss: 2.0191 | Train Acc: 0.3462
 Site-SVHN                     | Train Loss: 2.0561 | Train Acc: 0.3315
 Site-SVHN                     | Train Loss: 2.0215 | Train Acc: 0.3256
 Site-MNIST                         | Val  Loss: 1.2963 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.2723 | Val  Acc: 0.7626
 Site-USPS                          | Val  Loss: 1.1360 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 1.1011 | Val  Acc: 0.8273
 Site-SynthDigits                   | Val  Loss: 1.7117 | Val  Acc: 0.4783
 Site-SynthDigits                   | Val  Loss: 1.7465 | Val  Acc: 0.4604
 Site-MNIST-M                       | Val  Loss: 2.0557 | Val  Acc: 0.3043
 Site-MNIST-M                       | Val  Loss: 1.9914 | Val  Acc: 0.3741
 Site-SVHN                          | Val  Loss: 1.9782 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0152 | Val  Acc: 0.3417
Average Valid Accuracy: 0.5397
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.7626
 Best site-USPS                      | Epoch:40 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:40 | Val Acc: 0.8273
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.4783
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.4604
 Best site-MNIST-M                   | Epoch:40 | Val Acc: 0.3043
 Best site-MNIST-M                   | Epoch:40 | Val Acc: 0.3741
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.3417
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 41 ============
 Site-MNIST                    | Train Loss: 1.1859 | Train Acc: 0.7763
 Site-MNIST                    | Train Loss: 1.2740 | Train Acc: 0.7184
 Site-USPS                     | Train Loss: 1.0634 | Train Acc: 0.8275
 Site-USPS                     | Train Loss: 1.0409 | Train Acc: 0.8350
 Site-SynthDigits              | Train Loss: 1.7873 | Train Acc: 0.4420
 Site-SynthDigits              | Train Loss: 1.6867 | Train Acc: 0.5247
 Site-MNIST-M                  | Train Loss: 1.9815 | Train Acc: 0.3827
 Site-MNIST-M                  | Train Loss: 2.0154 | Train Acc: 0.3453
 Site-SVHN                     | Train Loss: 2.0456 | Train Acc: 0.3288
 Site-SVHN                     | Train Loss: 2.0149 | Train Acc: 0.3291
 Site-MNIST                         | Val  Loss: 1.2818 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.2605 | Val  Acc: 0.7554
 Site-USPS                          | Val  Loss: 1.1331 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 1.0963 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.6993 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.7333 | Val  Acc: 0.4712
 Site-MNIST-M                       | Val  Loss: 2.0483 | Val  Acc: 0.3043
 Site-MNIST-M                       | Val  Loss: 1.9845 | Val  Acc: 0.3813
 Site-SVHN                          | Val  Loss: 1.9721 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0090 | Val  Acc: 0.3417
Average Valid Accuracy: 0.5436
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.7554
 Best site-USPS                      | Epoch:41 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:41 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.4712
 Best site-MNIST-M                   | Epoch:41 | Val Acc: 0.3043
 Best site-MNIST-M                   | Epoch:41 | Val Acc: 0.3813
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.3417
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 42 ============
 Site-MNIST                    | Train Loss: 1.1799 | Train Acc: 0.7763
 Site-MNIST                    | Train Loss: 1.2609 | Train Acc: 0.7220
 Site-USPS                     | Train Loss: 1.0555 | Train Acc: 0.8302
 Site-USPS                     | Train Loss: 1.0305 | Train Acc: 0.8332
 Site-SynthDigits              | Train Loss: 1.7751 | Train Acc: 0.4447
 Site-SynthDigits              | Train Loss: 1.6764 | Train Acc: 0.5336
 Site-MNIST-M                  | Train Loss: 1.9667 | Train Acc: 0.3881
 Site-MNIST-M                  | Train Loss: 2.0098 | Train Acc: 0.3462
 Site-SVHN                     | Train Loss: 2.0438 | Train Acc: 0.3261
 Site-SVHN                     | Train Loss: 2.0092 | Train Acc: 0.3265
 Site-MNIST                         | Val  Loss: 1.2660 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.2457 | Val  Acc: 0.7626
 Site-USPS                          | Val  Loss: 1.1228 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 1.0856 | Val  Acc: 0.8201
 Site-SynthDigits                   | Val  Loss: 1.6872 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.7230 | Val  Acc: 0.4784
 Site-MNIST-M                       | Val  Loss: 2.0425 | Val  Acc: 0.3043
 Site-MNIST-M                       | Val  Loss: 1.9779 | Val  Acc: 0.3849
 Site-SVHN                          | Val  Loss: 1.9680 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0037 | Val  Acc: 0.3345
Average Valid Accuracy: 0.5433
============ Train epoch 43 ============
 Site-MNIST                    | Train Loss: 1.1580 | Train Acc: 0.7844
 Site-MNIST                    | Train Loss: 1.2432 | Train Acc: 0.7408
 Site-USPS                     | Train Loss: 1.0394 | Train Acc: 0.8302
 Site-USPS                     | Train Loss: 1.0156 | Train Acc: 0.8341
 Site-SynthDigits              | Train Loss: 1.7611 | Train Acc: 0.4420
 Site-SynthDigits              | Train Loss: 1.6657 | Train Acc: 0.5354
 Site-MNIST-M                  | Train Loss: 1.9661 | Train Acc: 0.3908
 Site-MNIST-M                  | Train Loss: 2.0029 | Train Acc: 0.3534
 Site-SVHN                     | Train Loss: 2.0437 | Train Acc: 0.3261
 Site-SVHN                     | Train Loss: 2.0043 | Train Acc: 0.3300
 Site-MNIST                         | Val  Loss: 1.2514 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.2288 | Val  Acc: 0.7806
 Site-USPS                          | Val  Loss: 1.1075 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 1.0701 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.6791 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.7135 | Val  Acc: 0.4784
 Site-MNIST-M                       | Val  Loss: 2.0368 | Val  Acc: 0.3152
 Site-MNIST-M                       | Val  Loss: 1.9710 | Val  Acc: 0.3885
 Site-SVHN                          | Val  Loss: 1.9623 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0001 | Val  Acc: 0.3417
Average Valid Accuracy: 0.5498
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.7806
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.5109
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.4784
 Best site-MNIST-M                   | Epoch:43 | Val Acc: 0.3152
 Best site-MNIST-M                   | Epoch:43 | Val Acc: 0.3885
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.3417
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 44 ============
 Site-MNIST                    | Train Loss: 1.1501 | Train Acc: 0.7817
 Site-MNIST                    | Train Loss: 1.2311 | Train Acc: 0.7354
 Site-USPS                     | Train Loss: 1.0328 | Train Acc: 0.8275
 Site-USPS                     | Train Loss: 1.0057 | Train Acc: 0.8359
 Site-SynthDigits              | Train Loss: 1.7589 | Train Acc: 0.4501
 Site-SynthDigits              | Train Loss: 1.6550 | Train Acc: 0.5453
 Site-MNIST-M                  | Train Loss: 1.9632 | Train Acc: 0.4016
 Site-MNIST-M                  | Train Loss: 1.9984 | Train Acc: 0.3471
 Site-SVHN                     | Train Loss: 2.0393 | Train Acc: 0.3342
 Site-SVHN                     | Train Loss: 1.9997 | Train Acc: 0.3318
 Site-MNIST                         | Val  Loss: 1.2383 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.2173 | Val  Acc: 0.7662
 Site-USPS                          | Val  Loss: 1.0998 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 1.0610 | Val  Acc: 0.8201
 Site-SynthDigits                   | Val  Loss: 1.6676 | Val  Acc: 0.5217
 Site-SynthDigits                   | Val  Loss: 1.7020 | Val  Acc: 0.4964
 Site-MNIST-M                       | Val  Loss: 2.0309 | Val  Acc: 0.3043
 Site-MNIST-M                       | Val  Loss: 1.9647 | Val  Acc: 0.3849
 Site-SVHN                          | Val  Loss: 1.9573 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 1.9950 | Val  Acc: 0.3453
Average Valid Accuracy: 0.5487
============ Train epoch 45 ============
 Site-MNIST                    | Train Loss: 1.1320 | Train Acc: 0.7763
 Site-MNIST                    | Train Loss: 1.2199 | Train Acc: 0.7399
 Site-USPS                     | Train Loss: 1.0085 | Train Acc: 0.8329
 Site-USPS                     | Train Loss: 0.9924 | Train Acc: 0.8386
 Site-SynthDigits              | Train Loss: 1.7493 | Train Acc: 0.4555
 Site-SynthDigits              | Train Loss: 1.6453 | Train Acc: 0.5435
 Site-MNIST-M                  | Train Loss: 1.9596 | Train Acc: 0.3908
 Site-MNIST-M                  | Train Loss: 1.9972 | Train Acc: 0.3525
 Site-SVHN                     | Train Loss: 2.0318 | Train Acc: 0.3315
 Site-SVHN                     | Train Loss: 1.9939 | Train Acc: 0.3309
 Site-MNIST                         | Val  Loss: 1.2245 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.2044 | Val  Acc: 0.7698
 Site-USPS                          | Val  Loss: 1.0874 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 1.0479 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.6578 | Val  Acc: 0.5217
 Site-SynthDigits                   | Val  Loss: 1.6917 | Val  Acc: 0.4928
 Site-MNIST-M                       | Val  Loss: 2.0317 | Val  Acc: 0.3261
 Site-MNIST-M                       | Val  Loss: 1.9646 | Val  Acc: 0.3921
 Site-SVHN                          | Val  Loss: 1.9509 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 1.9894 | Val  Acc: 0.3417
Average Valid Accuracy: 0.5527
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.7698
 Best site-USPS                      | Epoch:45 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:45 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.5217
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.4928
 Best site-MNIST-M                   | Epoch:45 | Val Acc: 0.3261
 Best site-MNIST-M                   | Epoch:45 | Val Acc: 0.3921
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.3417
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 46 ============
 Site-MNIST                    | Train Loss: 1.1276 | Train Acc: 0.7709
 Site-MNIST                    | Train Loss: 1.2123 | Train Acc: 0.7408
 Site-USPS                     | Train Loss: 1.0224 | Train Acc: 0.8275
 Site-USPS                     | Train Loss: 0.9990 | Train Acc: 0.8332
 Site-SynthDigits              | Train Loss: 1.7384 | Train Acc: 0.4582
 Site-SynthDigits              | Train Loss: 1.6305 | Train Acc: 0.5489
 Site-MNIST-M                  | Train Loss: 1.9600 | Train Acc: 0.3881
 Site-MNIST-M                  | Train Loss: 1.9938 | Train Acc: 0.3498
 Site-SVHN                     | Train Loss: 2.0247 | Train Acc: 0.3423
 Site-SVHN                     | Train Loss: 1.9856 | Train Acc: 0.3372
 Site-MNIST                         | Val  Loss: 1.2145 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.1978 | Val  Acc: 0.7626
 Site-USPS                          | Val  Loss: 1.0982 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 1.0534 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.6435 | Val  Acc: 0.5543
 Site-SynthDigits                   | Val  Loss: 1.6758 | Val  Acc: 0.5144
 Site-MNIST-M                       | Val  Loss: 2.0254 | Val  Acc: 0.3261
 Site-MNIST-M                       | Val  Loss: 1.9589 | Val  Acc: 0.3957
 Site-SVHN                          | Val  Loss: 1.9462 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 1.9849 | Val  Acc: 0.3453
Average Valid Accuracy: 0.5592
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.7626
 Best site-USPS                      | Epoch:46 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:46 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.5543
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.5144
 Best site-MNIST-M                   | Epoch:46 | Val Acc: 0.3261
 Best site-MNIST-M                   | Epoch:46 | Val Acc: 0.3957
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.3453
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 47 ============
 Site-MNIST                    | Train Loss: 1.1070 | Train Acc: 0.7844
 Site-MNIST                    | Train Loss: 1.1951 | Train Acc: 0.7516
 Site-USPS                     | Train Loss: 0.9973 | Train Acc: 0.8302
 Site-USPS                     | Train Loss: 0.9743 | Train Acc: 0.8377
 Site-SynthDigits              | Train Loss: 1.7335 | Train Acc: 0.4555
 Site-SynthDigits              | Train Loss: 1.6252 | Train Acc: 0.5489
 Site-MNIST-M                  | Train Loss: 1.9473 | Train Acc: 0.4016
 Site-MNIST-M                  | Train Loss: 1.9845 | Train Acc: 0.3534
 Site-SVHN                     | Train Loss: 2.0233 | Train Acc: 0.3531
 Site-SVHN                     | Train Loss: 1.9825 | Train Acc: 0.3327
 Site-MNIST                         | Val  Loss: 1.2010 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 1.1813 | Val  Acc: 0.7806
 Site-USPS                          | Val  Loss: 1.0741 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 1.0315 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.6387 | Val  Acc: 0.5326
 Site-SynthDigits                   | Val  Loss: 1.6712 | Val  Acc: 0.5036
 Site-MNIST-M                       | Val  Loss: 2.0171 | Val  Acc: 0.3261
 Site-MNIST-M                       | Val  Loss: 1.9496 | Val  Acc: 0.4029
 Site-SVHN                          | Val  Loss: 1.9406 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 1.9802 | Val  Acc: 0.3525
Average Valid Accuracy: 0.5602
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.7609
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.7806
 Best site-USPS                      | Epoch:47 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:47 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5326
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5036
 Best site-MNIST-M                   | Epoch:47 | Val Acc: 0.3261
 Best site-MNIST-M                   | Epoch:47 | Val Acc: 0.4029
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.3525
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 48 ============
 Site-MNIST                    | Train Loss: 1.0915 | Train Acc: 0.7898
 Site-MNIST                    | Train Loss: 1.1761 | Train Acc: 0.7623
 Site-USPS                     | Train Loss: 0.9785 | Train Acc: 0.8437
 Site-USPS                     | Train Loss: 0.9514 | Train Acc: 0.8430
 Site-SynthDigits              | Train Loss: 1.7308 | Train Acc: 0.4501
 Site-SynthDigits              | Train Loss: 1.6225 | Train Acc: 0.5453
 Site-MNIST-M                  | Train Loss: 1.9290 | Train Acc: 0.4070
 Site-MNIST-M                  | Train Loss: 1.9726 | Train Acc: 0.3578
 Site-SVHN                     | Train Loss: 2.0287 | Train Acc: 0.3450
 Site-SVHN                     | Train Loss: 1.9810 | Train Acc: 0.3327
 Site-MNIST                         | Val  Loss: 1.1870 | Val  Acc: 0.7717
 Site-MNIST                         | Val  Loss: 1.1624 | Val  Acc: 0.7878
 Site-USPS                          | Val  Loss: 1.0488 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 1.0082 | Val  Acc: 0.8345
 Site-SynthDigits                   | Val  Loss: 1.6353 | Val  Acc: 0.5435
 Site-SynthDigits                   | Val  Loss: 1.6704 | Val  Acc: 0.5072
 Site-MNIST-M                       | Val  Loss: 2.0100 | Val  Acc: 0.3152
 Site-MNIST-M                       | Val  Loss: 1.9399 | Val  Acc: 0.3993
 Site-SVHN                          | Val  Loss: 1.9355 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 1.9773 | Val  Acc: 0.3489
Average Valid Accuracy: 0.5628
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.7717
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.7878
 Best site-USPS                      | Epoch:48 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:48 | Val Acc: 0.8345
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.5435
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.5072
 Best site-MNIST-M                   | Epoch:48 | Val Acc: 0.3152
 Best site-MNIST-M                   | Epoch:48 | Val Acc: 0.3993
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.3489
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 49 ============
 Site-MNIST                    | Train Loss: 1.0752 | Train Acc: 0.7925
 Site-MNIST                    | Train Loss: 1.1592 | Train Acc: 0.7659
 Site-USPS                     | Train Loss: 0.9625 | Train Acc: 0.8518
 Site-USPS                     | Train Loss: 0.9357 | Train Acc: 0.8457
 Site-SynthDigits              | Train Loss: 1.7280 | Train Acc: 0.4420
 Site-SynthDigits              | Train Loss: 1.6205 | Train Acc: 0.5453
 Site-MNIST-M                  | Train Loss: 1.9164 | Train Acc: 0.4232
 Site-MNIST-M                  | Train Loss: 1.9608 | Train Acc: 0.3668
 Site-SVHN                     | Train Loss: 2.0227 | Train Acc: 0.3396
 Site-SVHN                     | Train Loss: 1.9805 | Train Acc: 0.3354
 Site-MNIST                         | Val  Loss: 1.1737 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.1453 | Val  Acc: 0.7842
 Site-USPS                          | Val  Loss: 1.0331 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.9938 | Val  Acc: 0.8345
 Site-SynthDigits                   | Val  Loss: 1.6329 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.6701 | Val  Acc: 0.4892
 Site-MNIST-M                       | Val  Loss: 2.0020 | Val  Acc: 0.3261
 Site-MNIST-M                       | Val  Loss: 1.9282 | Val  Acc: 0.4065
 Site-SVHN                          | Val  Loss: 1.9337 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 1.9757 | Val  Acc: 0.3525
Average Valid Accuracy: 0.5595
===2023-06-03 18:40:52===
===2023-06-03 18:40:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.7606
 Test site-USPS                      | Epoch:48 | Test Acc: 0.8624
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.5092
 Test site-MNIST-M                   | Epoch:48 | Test Acc: 0.3579
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.3053
MNIST: 0.761, USPS: 0.862, SynthDigits: 0.509, MNIST-M: 0.358, SVHN: 0.305, 
Average Test Accuracy: 0.5591, domain std=0.2191, cluster std=-1.0000, individual std=0.2191, 
===2023-06-11 06:14:33===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.7606
 Test site-USPS                      | Epoch:48 | Test Acc: 0.8624
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.5092
 Test site-MNIST-M                   | Epoch:48 | Test Acc: 0.3579
 Test site-MNIST-M                   | Epoch:48 | Test Acc: 0.3579
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.3053
MNIST: 0.4921, USPS: 0.8624, SynthDigits: 0.5092, SVHN: 0.3053, 
Average Test Accuracy(group): 0.5422, Average Test Accuracy(individual): 0.5591,
domain CV=0.3714, cluster CV=-1.0000, individual CV=0.3919, 
===2023-06-30 11:03:08===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 1.2820 | Train Acc: 0.6577
 Site-MNIST                         | Train Loss: 1.3755 | Train Acc: 0.5821
 Site-USPS                          | Train Loss: 1.1233 | Train Acc: 0.7601
 Site-USPS                          | Train Loss: 1.1053 | Train Acc: 0.7767
 Site-SynthDigits                   | Train Loss: 1.8545 | Train Acc: 0.3962
 Site-SynthDigits                   | Train Loss: 1.7811 | Train Acc: 0.4565
 Site-MNIST_M                       | Train Loss: 2.0851 | Train Acc: 0.3127
 Site-MNIST_M                       | Train Loss: 2.0849 | Train Acc: 0.2852
 Site-SVHN                          | Train Loss: 2.1424 | Train Acc: 0.2722
 Site-SVHN                          | Train Loss: 2.1136 | Train Acc: 0.3085
Average Train Accuracy: 0.4808
 Site-MNIST                         | Val  Loss: 1.4023 | Val  Acc: 0.5652
 Site-MNIST                         | Val  Loss: 1.3759 | Val  Acc: 0.6259
 Site-USPS                          | Val  Loss: 1.1971 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.1879 | Val  Acc: 0.7410
 Site-SynthDigits                   | Val  Loss: 1.7922 | Val  Acc: 0.4565
 Site-SynthDigits                   | Val  Loss: 1.8191 | Val  Acc: 0.4173
 Site-MNIST_M                       | Val  Loss: 2.1420 | Val  Acc: 0.2391
 Site-MNIST_M                       | Val  Loss: 2.1027 | Val  Acc: 0.2734
 Site-SVHN                          | Val  Loss: 2.1008 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1246 | Val  Acc: 0.2842
Average Valid Accuracy: 0.4603
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5652
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6259
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7410
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.4565
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.4173
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.2391
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.2734
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2842
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 0.8398 | Train Acc: 0.8194
 Site-MNIST                         | Train Loss: 0.9298 | Train Acc: 0.7578
 Site-USPS                          | Train Loss: 0.7084 | Train Acc: 0.8544
 Site-USPS                          | Train Loss: 0.6848 | Train Acc: 0.8332
 Site-SynthDigits                   | Train Loss: 1.6464 | Train Acc: 0.4259
 Site-SynthDigits                   | Train Loss: 1.5277 | Train Acc: 0.5283
 Site-MNIST_M                       | Train Loss: 1.8829 | Train Acc: 0.3989
 Site-MNIST_M                       | Train Loss: 1.9121 | Train Acc: 0.3471
 Site-SVHN                          | Train Loss: 2.0638 | Train Acc: 0.2749
 Site-SVHN                          | Train Loss: 2.0036 | Train Acc: 0.3067
Average Train Accuracy: 0.5547
 Site-MNIST                         | Val  Loss: 0.9920 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 0.9417 | Val  Acc: 0.7626
 Site-USPS                          | Val  Loss: 0.7862 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.7451 | Val  Acc: 0.8165
 Site-SynthDigits                   | Val  Loss: 1.5592 | Val  Acc: 0.4891
 Site-SynthDigits                   | Val  Loss: 1.5871 | Val  Acc: 0.4640
 Site-MNIST_M                       | Val  Loss: 1.8948 | Val  Acc: 0.3478
 Site-MNIST_M                       | Val  Loss: 1.9086 | Val  Acc: 0.3813
 Site-SVHN                          | Val  Loss: 1.9940 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.0396 | Val  Acc: 0.3022
Average Valid Accuracy: 0.5346
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7626
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:1 | Val Acc: 0.8165
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.4891
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.4640
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.3478
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.3813
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.3022
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 0.6651 | Train Acc: 0.8410
 Site-MNIST                         | Train Loss: 0.7511 | Train Acc: 0.7883
 Site-USPS                          | Train Loss: 0.6432 | Train Acc: 0.8544
 Site-USPS                          | Train Loss: 0.6345 | Train Acc: 0.8323
 Site-SynthDigits                   | Train Loss: 1.5283 | Train Acc: 0.4798
 Site-SynthDigits                   | Train Loss: 1.4104 | Train Acc: 0.5166
 Site-MNIST_M                       | Train Loss: 1.6547 | Train Acc: 0.4555
 Site-MNIST_M                       | Train Loss: 1.6879 | Train Acc: 0.4314
 Site-SVHN                          | Train Loss: 1.9480 | Train Acc: 0.3208
 Site-SVHN                          | Train Loss: 1.8498 | Train Acc: 0.3785
Average Train Accuracy: 0.5899
 Site-MNIST                         | Val  Loss: 0.7590 | Val  Acc: 0.8043
 Site-MNIST                         | Val  Loss: 0.7504 | Val  Acc: 0.8058
 Site-USPS                          | Val  Loss: 0.7661 | Val  Acc: 0.7609
 Site-USPS                          | Val  Loss: 0.6755 | Val  Acc: 0.8165
 Site-SynthDigits                   | Val  Loss: 1.4139 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.4566 | Val  Acc: 0.4928
 Site-MNIST_M                       | Val  Loss: 1.6680 | Val  Acc: 0.3804
 Site-MNIST_M                       | Val  Loss: 1.6365 | Val  Acc: 0.4424
 Site-SVHN                          | Val  Loss: 1.7954 | Val  Acc: 0.3478
 Site-SVHN                          | Val  Loss: 1.8763 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5722
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8043
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8058
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7609
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8165
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.5109
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.4928
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.3804
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4424
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.3478
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.3597
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 0.5298 | Train Acc: 0.8571
 Site-MNIST                         | Train Loss: 0.6137 | Train Acc: 0.8251
 Site-USPS                          | Train Loss: 0.5011 | Train Acc: 0.8868
 Site-USPS                          | Train Loss: 0.4791 | Train Acc: 0.8735
 Site-SynthDigits                   | Train Loss: 1.3489 | Train Acc: 0.5633
 Site-SynthDigits                   | Train Loss: 1.2092 | Train Acc: 0.5928
 Site-MNIST_M                       | Train Loss: 1.5629 | Train Acc: 0.5067
 Site-MNIST_M                       | Train Loss: 1.5832 | Train Acc: 0.4601
 Site-SVHN                          | Train Loss: 1.9262 | Train Acc: 0.3154
 Site-SVHN                          | Train Loss: 1.8248 | Train Acc: 0.3892
Average Train Accuracy: 0.6270
 Site-MNIST                         | Val  Loss: 0.6101 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.6021 | Val  Acc: 0.8309
 Site-USPS                          | Val  Loss: 0.6538 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.5239 | Val  Acc: 0.8453
 Site-SynthDigits                   | Val  Loss: 1.2134 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.2501 | Val  Acc: 0.5935
 Site-MNIST_M                       | Val  Loss: 1.6415 | Val  Acc: 0.4457
 Site-MNIST_M                       | Val  Loss: 1.5508 | Val  Acc: 0.5180
 Site-SVHN                          | Val  Loss: 1.7053 | Val  Acc: 0.3913
 Site-SVHN                          | Val  Loss: 1.8305 | Val  Acc: 0.3741
Average Valid Accuracy: 0.6216
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8478
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8309
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8453
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.5761
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.5935
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.4457
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.5180
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.3913
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.3741
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 0.4661 | Train Acc: 0.8625
 Site-MNIST                         | Train Loss: 0.4997 | Train Acc: 0.8583
 Site-USPS                          | Train Loss: 0.4074 | Train Acc: 0.8949
 Site-USPS                          | Train Loss: 0.3918 | Train Acc: 0.8879
 Site-SynthDigits                   | Train Loss: 1.2615 | Train Acc: 0.5687
 Site-SynthDigits                   | Train Loss: 1.1117 | Train Acc: 0.6251
 Site-MNIST_M                       | Train Loss: 1.4728 | Train Acc: 0.5337
 Site-MNIST_M                       | Train Loss: 1.4877 | Train Acc: 0.4987
 Site-SVHN                          | Train Loss: 1.8711 | Train Acc: 0.3585
 Site-SVHN                          | Train Loss: 1.7246 | Train Acc: 0.4036
Average Train Accuracy: 0.6492
 Site-MNIST                         | Val  Loss: 0.4883 | Val  Acc: 0.8804
 Site-MNIST                         | Val  Loss: 0.4905 | Val  Acc: 0.8777
 Site-USPS                          | Val  Loss: 0.5436 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.4356 | Val  Acc: 0.8561
 Site-SynthDigits                   | Val  Loss: 1.1497 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.1839 | Val  Acc: 0.6007
 Site-MNIST_M                       | Val  Loss: 1.4727 | Val  Acc: 0.4565
 Site-MNIST_M                       | Val  Loss: 1.4672 | Val  Acc: 0.5072
 Site-SVHN                          | Val  Loss: 1.6390 | Val  Acc: 0.4239
 Site-SVHN                          | Val  Loss: 1.7685 | Val  Acc: 0.3885
Average Valid Accuracy: 0.6393
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8804
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8777
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8561
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.6007
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.4565
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.5072
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.4239
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.3885
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 0.4512 | Train Acc: 0.8652
 Site-MNIST                         | Train Loss: 0.4968 | Train Acc: 0.8457
 Site-USPS                          | Train Loss: 0.4054 | Train Acc: 0.8868
 Site-USPS                          | Train Loss: 0.3882 | Train Acc: 0.8780
 Site-SynthDigits                   | Train Loss: 1.1297 | Train Acc: 0.6361
 Site-SynthDigits                   | Train Loss: 1.0231 | Train Acc: 0.6709
 Site-MNIST_M                       | Train Loss: 1.4069 | Train Acc: 0.5229
 Site-MNIST_M                       | Train Loss: 1.4142 | Train Acc: 0.5202
 Site-SVHN                          | Train Loss: 1.8076 | Train Acc: 0.3827
 Site-SVHN                          | Train Loss: 1.6460 | Train Acc: 0.4422
Average Train Accuracy: 0.6651
 Site-MNIST                         | Val  Loss: 0.4740 | Val  Acc: 0.8696
 Site-MNIST                         | Val  Loss: 0.4722 | Val  Acc: 0.8525
 Site-USPS                          | Val  Loss: 0.5677 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.4314 | Val  Acc: 0.8381
 Site-SynthDigits                   | Val  Loss: 1.0463 | Val  Acc: 0.6087
 Site-SynthDigits                   | Val  Loss: 1.0520 | Val  Acc: 0.6403
 Site-MNIST_M                       | Val  Loss: 1.4505 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.3983 | Val  Acc: 0.5468
 Site-SVHN                          | Val  Loss: 1.5366 | Val  Acc: 0.4565
 Site-SVHN                          | Val  Loss: 1.6787 | Val  Acc: 0.4532
Average Valid Accuracy: 0.6537
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8696
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8525
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8381
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.6087
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.6403
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.5468
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.4565
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.4532
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.3737 | Train Acc: 0.8895
 Site-MNIST                         | Train Loss: 0.4039 | Train Acc: 0.8762
 Site-USPS                          | Train Loss: 0.3480 | Train Acc: 0.8922
 Site-USPS                          | Train Loss: 0.3194 | Train Acc: 0.9076
 Site-SynthDigits                   | Train Loss: 1.1431 | Train Acc: 0.5930
 Site-SynthDigits                   | Train Loss: 1.0305 | Train Acc: 0.6682
 Site-MNIST_M                       | Train Loss: 1.3412 | Train Acc: 0.5687
 Site-MNIST_M                       | Train Loss: 1.3403 | Train Acc: 0.5462
 Site-SVHN                          | Train Loss: 1.8347 | Train Acc: 0.3801
 Site-SVHN                          | Train Loss: 1.6387 | Train Acc: 0.4484
Average Train Accuracy: 0.6770
 Site-MNIST                         | Val  Loss: 0.3799 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.3879 | Val  Acc: 0.8813
 Site-USPS                          | Val  Loss: 0.4866 | Val  Acc: 0.8370
 Site-USPS                          | Val  Loss: 0.3682 | Val  Acc: 0.8777
 Site-SynthDigits                   | Val  Loss: 1.0446 | Val  Acc: 0.5978
 Site-SynthDigits                   | Val  Loss: 1.0594 | Val  Acc: 0.6403
 Site-MNIST_M                       | Val  Loss: 1.3560 | Val  Acc: 0.5217
 Site-MNIST_M                       | Val  Loss: 1.3472 | Val  Acc: 0.5647
 Site-SVHN                          | Val  Loss: 1.5554 | Val  Acc: 0.4674
 Site-SVHN                          | Val  Loss: 1.6801 | Val  Acc: 0.4496
Average Valid Accuracy: 0.6729
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8913
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8813
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8370
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8777
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5978
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.6403
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.5217
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.5647
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.4674
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.4496
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.3573 | Train Acc: 0.8922
 Site-MNIST                         | Train Loss: 0.3998 | Train Acc: 0.8807
 Site-USPS                          | Train Loss: 0.3474 | Train Acc: 0.9057
 Site-USPS                          | Train Loss: 0.3325 | Train Acc: 0.8987
 Site-SynthDigits                   | Train Loss: 1.0199 | Train Acc: 0.6280
 Site-SynthDigits                   | Train Loss: 0.9174 | Train Acc: 0.7013
 Site-MNIST_M                       | Train Loss: 1.2841 | Train Acc: 0.5660
 Site-MNIST_M                       | Train Loss: 1.2649 | Train Acc: 0.5561
 Site-SVHN                          | Train Loss: 1.7056 | Train Acc: 0.4124
 Site-SVHN                          | Train Loss: 1.5129 | Train Acc: 0.4933
Average Train Accuracy: 0.6934
 Site-MNIST                         | Val  Loss: 0.3624 | Val  Acc: 0.9022
 Site-MNIST                         | Val  Loss: 0.3752 | Val  Acc: 0.8849
 Site-USPS                          | Val  Loss: 0.5361 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.3865 | Val  Acc: 0.8705
 Site-SynthDigits                   | Val  Loss: 0.9480 | Val  Acc: 0.6630
 Site-SynthDigits                   | Val  Loss: 0.9282 | Val  Acc: 0.6619
 Site-MNIST_M                       | Val  Loss: 1.3062 | Val  Acc: 0.5543
 Site-MNIST_M                       | Val  Loss: 1.2652 | Val  Acc: 0.5899
 Site-SVHN                          | Val  Loss: 1.4557 | Val  Acc: 0.5652
 Site-SVHN                          | Val  Loss: 1.5833 | Val  Acc: 0.4892
Average Valid Accuracy: 0.6996
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9022
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8849
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8705
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.6630
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.6619
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.5543
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.5899
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.5652
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.4892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.3061 | Train Acc: 0.9084
 Site-MNIST                         | Train Loss: 0.3318 | Train Acc: 0.8996
 Site-USPS                          | Train Loss: 0.3150 | Train Acc: 0.9164
 Site-USPS                          | Train Loss: 0.2825 | Train Acc: 0.9202
 Site-SynthDigits                   | Train Loss: 1.0279 | Train Acc: 0.6280
 Site-SynthDigits                   | Train Loss: 0.8968 | Train Acc: 0.7103
 Site-MNIST_M                       | Train Loss: 1.2023 | Train Acc: 0.5957
 Site-MNIST_M                       | Train Loss: 1.1763 | Train Acc: 0.6161
 Site-SVHN                          | Train Loss: 1.7309 | Train Acc: 0.3666
 Site-SVHN                          | Train Loss: 1.5435 | Train Acc: 0.4619
Average Train Accuracy: 0.7023
 Site-MNIST                         | Val  Loss: 0.3028 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.3036 | Val  Acc: 0.9173
 Site-USPS                          | Val  Loss: 0.4783 | Val  Acc: 0.8696
 Site-USPS                          | Val  Loss: 0.3369 | Val  Acc: 0.8993
 Site-SynthDigits                   | Val  Loss: 0.9433 | Val  Acc: 0.6848
 Site-SynthDigits                   | Val  Loss: 0.9339 | Val  Acc: 0.6906
 Site-MNIST_M                       | Val  Loss: 1.2210 | Val  Acc: 0.5978
 Site-MNIST_M                       | Val  Loss: 1.1846 | Val  Acc: 0.6079
 Site-SVHN                          | Val  Loss: 1.4344 | Val  Acc: 0.5217
 Site-SVHN                          | Val  Loss: 1.5735 | Val  Acc: 0.4856
Average Valid Accuracy: 0.7188
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9173
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8696
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8993
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.6848
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.6906
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.5978
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.6079
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.5217
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.4856
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.3166 | Train Acc: 0.8949
 Site-MNIST                         | Train Loss: 0.3398 | Train Acc: 0.8870
 Site-USPS                          | Train Loss: 0.3129 | Train Acc: 0.9299
 Site-USPS                          | Train Loss: 0.2865 | Train Acc: 0.9193
 Site-SynthDigits                   | Train Loss: 0.9779 | Train Acc: 0.6577
 Site-SynthDigits                   | Train Loss: 0.8498 | Train Acc: 0.7345
 Site-MNIST_M                       | Train Loss: 1.1667 | Train Acc: 0.6011
 Site-MNIST_M                       | Train Loss: 1.1445 | Train Acc: 0.6233
 Site-SVHN                          | Train Loss: 1.6775 | Train Acc: 0.4151
 Site-SVHN                          | Train Loss: 1.4869 | Train Acc: 0.5013
Average Train Accuracy: 0.7164
 Site-MNIST                         | Val  Loss: 0.3148 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.3026 | Val  Acc: 0.9029
 Site-USPS                          | Val  Loss: 0.4804 | Val  Acc: 0.8478
 Site-USPS                          | Val  Loss: 0.3391 | Val  Acc: 0.9029
 Site-SynthDigits                   | Val  Loss: 0.8880 | Val  Acc: 0.6957
 Site-SynthDigits                   | Val  Loss: 0.9041 | Val  Acc: 0.6978
 Site-MNIST_M                       | Val  Loss: 1.1450 | Val  Acc: 0.6196
 Site-MNIST_M                       | Val  Loss: 1.1415 | Val  Acc: 0.6367
 Site-SVHN                          | Val  Loss: 1.3726 | Val  Acc: 0.5870
 Site-SVHN                          | Val  Loss: 1.5451 | Val  Acc: 0.5144
Average Valid Accuracy: 0.7296
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8913
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.9029
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8478
 Best site-USPS                      | Epoch:9 | Val Acc: 0.9029
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.6957
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.6978
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.6196
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.6367
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.5870
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.5144
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.3020 | Train Acc: 0.9003
 Site-MNIST                         | Train Loss: 0.3166 | Train Acc: 0.8906
 Site-USPS                          | Train Loss: 0.2934 | Train Acc: 0.9191
 Site-USPS                          | Train Loss: 0.2786 | Train Acc: 0.9130
 Site-SynthDigits                   | Train Loss: 0.8998 | Train Acc: 0.6954
 Site-SynthDigits                   | Train Loss: 0.7827 | Train Acc: 0.7543
 Site-MNIST_M                       | Train Loss: 1.1444 | Train Acc: 0.6092
 Site-MNIST_M                       | Train Loss: 1.0887 | Train Acc: 0.6206
 Site-SVHN                          | Train Loss: 1.6360 | Train Acc: 0.4501
 Site-SVHN                          | Train Loss: 1.4334 | Train Acc: 0.5229
Average Train Accuracy: 0.7275
 Site-MNIST                         | Val  Loss: 0.2731 | Val  Acc: 0.9022
 Site-MNIST                         | Val  Loss: 0.2705 | Val  Acc: 0.8921
 Site-USPS                          | Val  Loss: 0.4881 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.3265 | Val  Acc: 0.8849
 Site-SynthDigits                   | Val  Loss: 0.8183 | Val  Acc: 0.7174
 Site-SynthDigits                   | Val  Loss: 0.8194 | Val  Acc: 0.7230
 Site-MNIST_M                       | Val  Loss: 1.0786 | Val  Acc: 0.6413
 Site-MNIST_M                       | Val  Loss: 1.1037 | Val  Acc: 0.6439
 Site-SVHN                          | Val  Loss: 1.3248 | Val  Acc: 0.5870
 Site-SVHN                          | Val  Loss: 1.4825 | Val  Acc: 0.5216
Average Valid Accuracy: 0.7339
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9022
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8921
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8849
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.7174
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.7230
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.6413
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.6439
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.5870
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.5216
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.2737 | Train Acc: 0.9245
 Site-MNIST                         | Train Loss: 0.2847 | Train Acc: 0.9085
 Site-USPS                          | Train Loss: 0.2684 | Train Acc: 0.9245
 Site-USPS                          | Train Loss: 0.2588 | Train Acc: 0.9283
 Site-SynthDigits                   | Train Loss: 0.8910 | Train Acc: 0.6819
 Site-SynthDigits                   | Train Loss: 0.7720 | Train Acc: 0.7623
 Site-MNIST_M                       | Train Loss: 1.1301 | Train Acc: 0.6307
 Site-MNIST_M                       | Train Loss: 1.0549 | Train Acc: 0.6413
 Site-SVHN                          | Train Loss: 1.6251 | Train Acc: 0.4367
 Site-SVHN                          | Train Loss: 1.3931 | Train Acc: 0.5372
Average Train Accuracy: 0.7376
 Site-MNIST                         | Val  Loss: 0.2262 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.2386 | Val  Acc: 0.9281
 Site-USPS                          | Val  Loss: 0.4476 | Val  Acc: 0.8587
 Site-USPS                          | Val  Loss: 0.2932 | Val  Acc: 0.9137
 Site-SynthDigits                   | Val  Loss: 0.8091 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 0.8162 | Val  Acc: 0.7158
 Site-MNIST_M                       | Val  Loss: 1.0200 | Val  Acc: 0.6957
 Site-MNIST_M                       | Val  Loss: 1.0679 | Val  Acc: 0.6727
 Site-SVHN                          | Val  Loss: 1.2836 | Val  Acc: 0.5978
 Site-SVHN                          | Val  Loss: 1.4636 | Val  Acc: 0.5216
Average Valid Accuracy: 0.7578
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9457
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9281
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8587
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9137
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.7283
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.7158
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.6957
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.6727
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.5978
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.5216
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.2439 | Train Acc: 0.9191
 Site-MNIST                         | Train Loss: 0.2558 | Train Acc: 0.9220
 Site-USPS                          | Train Loss: 0.2451 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.2166 | Train Acc: 0.9345
 Site-SynthDigits                   | Train Loss: 0.8616 | Train Acc: 0.7170
 Site-SynthDigits                   | Train Loss: 0.7218 | Train Acc: 0.7749
 Site-MNIST_M                       | Train Loss: 1.1173 | Train Acc: 0.6307
 Site-MNIST_M                       | Train Loss: 1.0119 | Train Acc: 0.6493
 Site-SVHN                          | Train Loss: 1.6433 | Train Acc: 0.4367
 Site-SVHN                          | Train Loss: 1.4263 | Train Acc: 0.5256
Average Train Accuracy: 0.7448
 Site-MNIST                         | Val  Loss: 0.2253 | Val  Acc: 0.9348
 Site-MNIST                         | Val  Loss: 0.2208 | Val  Acc: 0.9353
 Site-USPS                          | Val  Loss: 0.4223 | Val  Acc: 0.8478
 Site-USPS                          | Val  Loss: 0.2725 | Val  Acc: 0.9137
 Site-SynthDigits                   | Val  Loss: 0.7802 | Val  Acc: 0.7391
 Site-SynthDigits                   | Val  Loss: 0.7866 | Val  Acc: 0.7374
 Site-MNIST_M                       | Val  Loss: 1.0184 | Val  Acc: 0.6848
 Site-MNIST_M                       | Val  Loss: 1.0474 | Val  Acc: 0.6655
 Site-SVHN                          | Val  Loss: 1.2813 | Val  Acc: 0.5978
 Site-SVHN                          | Val  Loss: 1.4653 | Val  Acc: 0.5144
Average Valid Accuracy: 0.7571
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.2319 | Train Acc: 0.9326
 Site-MNIST                         | Train Loss: 0.2529 | Train Acc: 0.9229
 Site-USPS                          | Train Loss: 0.2659 | Train Acc: 0.9299
 Site-USPS                          | Train Loss: 0.2312 | Train Acc: 0.9336
 Site-SynthDigits                   | Train Loss: 0.8482 | Train Acc: 0.7062
 Site-SynthDigits                   | Train Loss: 0.7271 | Train Acc: 0.7874
 Site-MNIST_M                       | Train Loss: 1.0401 | Train Acc: 0.6415
 Site-MNIST_M                       | Train Loss: 0.9493 | Train Acc: 0.6816
 Site-SVHN                          | Train Loss: 1.5676 | Train Acc: 0.4690
 Site-SVHN                          | Train Loss: 1.3590 | Train Acc: 0.5507
Average Train Accuracy: 0.7555
 Site-MNIST                         | Val  Loss: 0.2101 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.2149 | Val  Acc: 0.9317
 Site-USPS                          | Val  Loss: 0.4254 | Val  Acc: 0.8696
 Site-USPS                          | Val  Loss: 0.2761 | Val  Acc: 0.9281
 Site-SynthDigits                   | Val  Loss: 0.7633 | Val  Acc: 0.7391
 Site-SynthDigits                   | Val  Loss: 0.7771 | Val  Acc: 0.7482
 Site-MNIST_M                       | Val  Loss: 0.9158 | Val  Acc: 0.7174
 Site-MNIST_M                       | Val  Loss: 0.9793 | Val  Acc: 0.6727
 Site-SVHN                          | Val  Loss: 1.2077 | Val  Acc: 0.6196
 Site-SVHN                          | Val  Loss: 1.4194 | Val  Acc: 0.5432
Average Valid Accuracy: 0.7715
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9457
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9317
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8696
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9281
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.7391
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.7482
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.7174
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.6727
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.6196
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.5432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.2238 | Train Acc: 0.9299
 Site-MNIST                         | Train Loss: 0.2392 | Train Acc: 0.9256
 Site-USPS                          | Train Loss: 0.2438 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.2186 | Train Acc: 0.9372
 Site-SynthDigits                   | Train Loss: 0.8017 | Train Acc: 0.7332
 Site-SynthDigits                   | Train Loss: 0.6612 | Train Acc: 0.8045
 Site-MNIST_M                       | Train Loss: 1.0638 | Train Acc: 0.6523
 Site-MNIST_M                       | Train Loss: 0.9676 | Train Acc: 0.6637
 Site-SVHN                          | Train Loss: 1.5486 | Train Acc: 0.4825
 Site-SVHN                          | Train Loss: 1.3305 | Train Acc: 0.5534
Average Train Accuracy: 0.7620
 Site-MNIST                         | Val  Loss: 0.1959 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.2103 | Val  Acc: 0.9388
 Site-USPS                          | Val  Loss: 0.4288 | Val  Acc: 0.8587
 Site-USPS                          | Val  Loss: 0.2679 | Val  Acc: 0.9209
 Site-SynthDigits                   | Val  Loss: 0.7089 | Val  Acc: 0.7935
 Site-SynthDigits                   | Val  Loss: 0.7289 | Val  Acc: 0.7734
 Site-MNIST_M                       | Val  Loss: 0.9465 | Val  Acc: 0.7065
 Site-MNIST_M                       | Val  Loss: 0.9891 | Val  Acc: 0.6871
 Site-SVHN                          | Val  Loss: 1.2094 | Val  Acc: 0.6413
 Site-SVHN                          | Val  Loss: 1.3945 | Val  Acc: 0.5504
Average Valid Accuracy: 0.7816
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9457
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9388
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8587
 Best site-USPS                      | Epoch:14 | Val Acc: 0.9209
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.7935
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.7734
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.7065
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.6871
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.6413
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.5504
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.1958 | Train Acc: 0.9461
 Site-MNIST                         | Train Loss: 0.2089 | Train Acc: 0.9417
 Site-USPS                          | Train Loss: 0.2425 | Train Acc: 0.9326
 Site-USPS                          | Train Loss: 0.2044 | Train Acc: 0.9381
 Site-SynthDigits                   | Train Loss: 0.8134 | Train Acc: 0.7116
 Site-SynthDigits                   | Train Loss: 0.6641 | Train Acc: 0.8036
 Site-MNIST_M                       | Train Loss: 1.0129 | Train Acc: 0.6631
 Site-MNIST_M                       | Train Loss: 0.9070 | Train Acc: 0.6924
 Site-SVHN                          | Train Loss: 1.5487 | Train Acc: 0.4717
 Site-SVHN                          | Train Loss: 1.3377 | Train Acc: 0.5480
Average Train Accuracy: 0.7649
 Site-MNIST                         | Val  Loss: 0.1706 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1834 | Val  Acc: 0.9568
 Site-USPS                          | Val  Loss: 0.4086 | Val  Acc: 0.8696
 Site-USPS                          | Val  Loss: 0.2591 | Val  Acc: 0.9245
 Site-SynthDigits                   | Val  Loss: 0.7178 | Val  Acc: 0.7391
 Site-SynthDigits                   | Val  Loss: 0.7369 | Val  Acc: 0.7410
 Site-MNIST_M                       | Val  Loss: 0.8851 | Val  Acc: 0.7174
 Site-MNIST_M                       | Val  Loss: 0.9509 | Val  Acc: 0.6871
 Site-SVHN                          | Val  Loss: 1.1852 | Val  Acc: 0.6304
 Site-SVHN                          | Val  Loss: 1.3896 | Val  Acc: 0.5360
Average Valid Accuracy: 0.7769
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.1921 | Train Acc: 0.9434
 Site-MNIST                         | Train Loss: 0.2009 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.2334 | Train Acc: 0.9434
 Site-USPS                          | Train Loss: 0.1944 | Train Acc: 0.9417
 Site-SynthDigits                   | Train Loss: 0.7948 | Train Acc: 0.7170
 Site-SynthDigits                   | Train Loss: 0.6408 | Train Acc: 0.8045
 Site-MNIST_M                       | Train Loss: 0.9856 | Train Acc: 0.6577
 Site-MNIST_M                       | Train Loss: 0.8803 | Train Acc: 0.6897
 Site-SVHN                          | Train Loss: 1.5212 | Train Acc: 0.4690
 Site-SVHN                          | Train Loss: 1.3157 | Train Acc: 0.5561
Average Train Accuracy: 0.7667
 Site-MNIST                         | Val  Loss: 0.1631 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1743 | Val  Acc: 0.9568
 Site-USPS                          | Val  Loss: 0.3938 | Val  Acc: 0.8587
 Site-USPS                          | Val  Loss: 0.2509 | Val  Acc: 0.9245
 Site-SynthDigits                   | Val  Loss: 0.6841 | Val  Acc: 0.7609
 Site-SynthDigits                   | Val  Loss: 0.7079 | Val  Acc: 0.7626
 Site-MNIST_M                       | Val  Loss: 0.8574 | Val  Acc: 0.7283
 Site-MNIST_M                       | Val  Loss: 0.9264 | Val  Acc: 0.6871
 Site-SVHN                          | Val  Loss: 1.1639 | Val  Acc: 0.6413
 Site-SVHN                          | Val  Loss: 1.3627 | Val  Acc: 0.5396
Average Valid Accuracy: 0.7816
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9565
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9568
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8587
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9245
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.7609
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.7626
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.7283
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.6871
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.6413
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.5396
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.1970 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1995 | Train Acc: 0.9435
 Site-USPS                          | Train Loss: 0.2241 | Train Acc: 0.9353
 Site-USPS                          | Train Loss: 0.2111 | Train Acc: 0.9309
 Site-SynthDigits                   | Train Loss: 0.7644 | Train Acc: 0.7224
 Site-SynthDigits                   | Train Loss: 0.6183 | Train Acc: 0.8170
 Site-MNIST_M                       | Train Loss: 1.0121 | Train Acc: 0.6496
 Site-MNIST_M                       | Train Loss: 0.8851 | Train Acc: 0.6960
 Site-SVHN                          | Train Loss: 1.4837 | Train Acc: 0.4825
 Site-SVHN                          | Train Loss: 1.2668 | Train Acc: 0.5650
Average Train Accuracy: 0.7694
 Site-MNIST                         | Val  Loss: 0.1542 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1731 | Val  Acc: 0.9496
 Site-USPS                          | Val  Loss: 0.4179 | Val  Acc: 0.8587
 Site-USPS                          | Val  Loss: 0.2611 | Val  Acc: 0.9173
 Site-SynthDigits                   | Val  Loss: 0.6644 | Val  Acc: 0.7826
 Site-SynthDigits                   | Val  Loss: 0.6751 | Val  Acc: 0.7662
 Site-MNIST_M                       | Val  Loss: 0.8555 | Val  Acc: 0.7500
 Site-MNIST_M                       | Val  Loss: 0.9253 | Val  Acc: 0.6835
 Site-SVHN                          | Val  Loss: 1.1147 | Val  Acc: 0.5978
 Site-SVHN                          | Val  Loss: 1.3272 | Val  Acc: 0.5216
Average Valid Accuracy: 0.7784
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.1751 | Train Acc: 0.9569
 Site-MNIST                         | Train Loss: 0.1762 | Train Acc: 0.9543
 Site-USPS                          | Train Loss: 0.2118 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.1762 | Train Acc: 0.9453
 Site-SynthDigits                   | Train Loss: 0.7592 | Train Acc: 0.7439
 Site-SynthDigits                   | Train Loss: 0.6047 | Train Acc: 0.8188
 Site-MNIST_M                       | Train Loss: 0.9713 | Train Acc: 0.6712
 Site-MNIST_M                       | Train Loss: 0.8133 | Train Acc: 0.7166
 Site-SVHN                          | Train Loss: 1.5635 | Train Acc: 0.4798
 Site-SVHN                          | Train Loss: 1.3063 | Train Acc: 0.5399
Average Train Accuracy: 0.7765
 Site-MNIST                         | Val  Loss: 0.1335 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1483 | Val  Acc: 0.9640
 Site-USPS                          | Val  Loss: 0.3661 | Val  Acc: 0.8913
 Site-USPS                          | Val  Loss: 0.2275 | Val  Acc: 0.9353
 Site-SynthDigits                   | Val  Loss: 0.6689 | Val  Acc: 0.7935
 Site-SynthDigits                   | Val  Loss: 0.6832 | Val  Acc: 0.7734
 Site-MNIST_M                       | Val  Loss: 0.8123 | Val  Acc: 0.7391
 Site-MNIST_M                       | Val  Loss: 0.8771 | Val  Acc: 0.7014
 Site-SVHN                          | Val  Loss: 1.1577 | Val  Acc: 0.5978
 Site-SVHN                          | Val  Loss: 1.3703 | Val  Acc: 0.5252
Average Valid Accuracy: 0.7888
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9640
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8913
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9353
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.7935
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.7734
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.7391
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.7014
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.5978
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.5252
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.1791 | Train Acc: 0.9461
 Site-MNIST                         | Train Loss: 0.1855 | Train Acc: 0.9489
 Site-USPS                          | Train Loss: 0.2030 | Train Acc: 0.9434
 Site-USPS                          | Train Loss: 0.1876 | Train Acc: 0.9417
 Site-SynthDigits                   | Train Loss: 0.7180 | Train Acc: 0.7439
 Site-SynthDigits                   | Train Loss: 0.5735 | Train Acc: 0.8341
 Site-MNIST_M                       | Train Loss: 0.9933 | Train Acc: 0.6604
 Site-MNIST_M                       | Train Loss: 0.8465 | Train Acc: 0.6969
 Site-SVHN                          | Train Loss: 1.4647 | Train Acc: 0.4771
 Site-SVHN                          | Train Loss: 1.2464 | Train Acc: 0.5596
Average Train Accuracy: 0.7752
 Site-MNIST                         | Val  Loss: 0.1312 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1561 | Val  Acc: 0.9604
 Site-USPS                          | Val  Loss: 0.3709 | Val  Acc: 0.8587
 Site-USPS                          | Val  Loss: 0.2371 | Val  Acc: 0.9245
 Site-SynthDigits                   | Val  Loss: 0.6073 | Val  Acc: 0.8043
 Site-SynthDigits                   | Val  Loss: 0.6225 | Val  Acc: 0.7842
 Site-MNIST_M                       | Val  Loss: 0.7971 | Val  Acc: 0.7609
 Site-MNIST_M                       | Val  Loss: 0.8961 | Val  Acc: 0.6978
 Site-SVHN                          | Val  Loss: 1.0932 | Val  Acc: 0.6304
 Site-SVHN                          | Val  Loss: 1.3088 | Val  Acc: 0.5468
Average Valid Accuracy: 0.7935
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9604
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8587
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9245
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.8043
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.7842
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.7609
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.6978
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.6304
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.5468
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.1694 | Train Acc: 0.9569
 Site-MNIST                         | Train Loss: 0.1715 | Train Acc: 0.9587
 Site-USPS                          | Train Loss: 0.1990 | Train Acc: 0.9488
 Site-USPS                          | Train Loss: 0.1744 | Train Acc: 0.9453
 Site-SynthDigits                   | Train Loss: 0.7406 | Train Acc: 0.7439
 Site-SynthDigits                   | Train Loss: 0.5735 | Train Acc: 0.8233
 Site-MNIST_M                       | Train Loss: 0.9679 | Train Acc: 0.6631
 Site-MNIST_M                       | Train Loss: 0.8207 | Train Acc: 0.7220
 Site-SVHN                          | Train Loss: 1.4986 | Train Acc: 0.4717
 Site-SVHN                          | Train Loss: 1.2610 | Train Acc: 0.5587
Average Train Accuracy: 0.7792
 Site-MNIST                         | Val  Loss: 0.1391 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1512 | Val  Acc: 0.9568
 Site-USPS                          | Val  Loss: 0.3881 | Val  Acc: 0.8587
 Site-USPS                          | Val  Loss: 0.2319 | Val  Acc: 0.9245
 Site-SynthDigits                   | Val  Loss: 0.6387 | Val  Acc: 0.7935
 Site-SynthDigits                   | Val  Loss: 0.6448 | Val  Acc: 0.7806
 Site-MNIST_M                       | Val  Loss: 0.7616 | Val  Acc: 0.7717
 Site-MNIST_M                       | Val  Loss: 0.8664 | Val  Acc: 0.7194
 Site-SVHN                          | Val  Loss: 1.0906 | Val  Acc: 0.6304
 Site-SVHN                          | Val  Loss: 1.3186 | Val  Acc: 0.5252
Average Valid Accuracy: 0.7917
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.1679 | Train Acc: 0.9596
 Site-MNIST                         | Train Loss: 0.1633 | Train Acc: 0.9570
 Site-USPS                          | Train Loss: 0.1898 | Train Acc: 0.9515
 Site-USPS                          | Train Loss: 0.1689 | Train Acc: 0.9471
 Site-SynthDigits                   | Train Loss: 0.7193 | Train Acc: 0.7466
 Site-SynthDigits                   | Train Loss: 0.5552 | Train Acc: 0.8430
 Site-MNIST_M                       | Train Loss: 0.9448 | Train Acc: 0.6712
 Site-MNIST_M                       | Train Loss: 0.7773 | Train Acc: 0.7336
 Site-SVHN                          | Train Loss: 1.4822 | Train Acc: 0.4960
 Site-SVHN                          | Train Loss: 1.2245 | Train Acc: 0.5767
Average Train Accuracy: 0.7882
 Site-MNIST                         | Val  Loss: 0.1213 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.1388 | Val  Acc: 0.9748
 Site-USPS                          | Val  Loss: 0.3540 | Val  Acc: 0.8804
 Site-USPS                          | Val  Loss: 0.2146 | Val  Acc: 0.9317
 Site-SynthDigits                   | Val  Loss: 0.6038 | Val  Acc: 0.8261
 Site-SynthDigits                   | Val  Loss: 0.6179 | Val  Acc: 0.7986
 Site-MNIST_M                       | Val  Loss: 0.7163 | Val  Acc: 0.7717
 Site-MNIST_M                       | Val  Loss: 0.8435 | Val  Acc: 0.7086
 Site-SVHN                          | Val  Loss: 1.0496 | Val  Acc: 0.6522
 Site-SVHN                          | Val  Loss: 1.2852 | Val  Acc: 0.5683
Average Valid Accuracy: 0.8091
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9783
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9748
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8804
 Best site-USPS                      | Epoch:21 | Val Acc: 0.9317
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.8261
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.7986
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.7717
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.7086
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.6522
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.5683
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.1516 | Train Acc: 0.9596
 Site-MNIST                         | Train Loss: 0.1556 | Train Acc: 0.9614
 Site-USPS                          | Train Loss: 0.2033 | Train Acc: 0.9407
 Site-USPS                          | Train Loss: 0.1640 | Train Acc: 0.9516
 Site-SynthDigits                   | Train Loss: 0.7160 | Train Acc: 0.7520
 Site-SynthDigits                   | Train Loss: 0.5464 | Train Acc: 0.8448
 Site-MNIST_M                       | Train Loss: 0.9333 | Train Acc: 0.6765
 Site-MNIST_M                       | Train Loss: 0.7467 | Train Acc: 0.7417
 Site-SVHN                          | Train Loss: 1.5036 | Train Acc: 0.4852
 Site-SVHN                          | Train Loss: 1.2380 | Train Acc: 0.5776
Average Train Accuracy: 0.7891
 Site-MNIST                         | Val  Loss: 0.1241 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.1333 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.3482 | Val  Acc: 0.8913
 Site-USPS                          | Val  Loss: 0.2178 | Val  Acc: 0.9388
 Site-SynthDigits                   | Val  Loss: 0.5903 | Val  Acc: 0.8152
 Site-SynthDigits                   | Val  Loss: 0.6201 | Val  Acc: 0.8022
 Site-MNIST_M                       | Val  Loss: 0.6723 | Val  Acc: 0.8043
 Site-MNIST_M                       | Val  Loss: 0.8096 | Val  Acc: 0.7374
 Site-SVHN                          | Val  Loss: 1.0569 | Val  Acc: 0.6522
 Site-SVHN                          | Val  Loss: 1.3085 | Val  Acc: 0.5432
Average Valid Accuracy: 0.8134
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9783
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8913
 Best site-USPS                      | Epoch:22 | Val Acc: 0.9388
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.8152
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.8022
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.8043
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.7374
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.6522
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.5432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.1531 | Train Acc: 0.9596
 Site-MNIST                         | Train Loss: 0.1462 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.1851 | Train Acc: 0.9461
 Site-USPS                          | Train Loss: 0.1633 | Train Acc: 0.9507
 Site-SynthDigits                   | Train Loss: 0.6888 | Train Acc: 0.7628
 Site-SynthDigits                   | Train Loss: 0.5246 | Train Acc: 0.8565
 Site-MNIST_M                       | Train Loss: 0.9263 | Train Acc: 0.6685
 Site-MNIST_M                       | Train Loss: 0.7335 | Train Acc: 0.7381
 Site-SVHN                          | Train Loss: 1.4542 | Train Acc: 0.4879
 Site-SVHN                          | Train Loss: 1.1942 | Train Acc: 0.5874
Average Train Accuracy: 0.7920
 Site-MNIST                         | Val  Loss: 0.1076 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.1323 | Val  Acc: 0.9640
 Site-USPS                          | Val  Loss: 0.3474 | Val  Acc: 0.8913
 Site-USPS                          | Val  Loss: 0.2090 | Val  Acc: 0.9317
 Site-SynthDigits                   | Val  Loss: 0.5627 | Val  Acc: 0.8152
 Site-SynthDigits                   | Val  Loss: 0.5916 | Val  Acc: 0.8094
 Site-MNIST_M                       | Val  Loss: 0.6459 | Val  Acc: 0.8152
 Site-MNIST_M                       | Val  Loss: 0.8053 | Val  Acc: 0.7194
 Site-SVHN                          | Val  Loss: 1.0422 | Val  Acc: 0.6304
 Site-SVHN                          | Val  Loss: 1.2624 | Val  Acc: 0.5647
Average Valid Accuracy: 0.8120
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.1429 | Train Acc: 0.9623
 Site-MNIST                         | Train Loss: 0.1346 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.1883 | Train Acc: 0.9407
 Site-USPS                          | Train Loss: 0.1547 | Train Acc: 0.9498
 Site-SynthDigits                   | Train Loss: 0.6924 | Train Acc: 0.7520
 Site-SynthDigits                   | Train Loss: 0.5188 | Train Acc: 0.8565
 Site-MNIST_M                       | Train Loss: 0.8978 | Train Acc: 0.6819
 Site-MNIST_M                       | Train Loss: 0.7140 | Train Acc: 0.7534
 Site-SVHN                          | Train Loss: 1.4625 | Train Acc: 0.4798
 Site-SVHN                          | Train Loss: 1.1944 | Train Acc: 0.5892
Average Train Accuracy: 0.7931
 Site-MNIST                         | Val  Loss: 0.1002 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.1191 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.3481 | Val  Acc: 0.8696
 Site-USPS                          | Val  Loss: 0.2076 | Val  Acc: 0.9245
 Site-SynthDigits                   | Val  Loss: 0.5583 | Val  Acc: 0.8478
 Site-SynthDigits                   | Val  Loss: 0.5782 | Val  Acc: 0.8165
 Site-MNIST_M                       | Val  Loss: 0.6236 | Val  Acc: 0.8370
 Site-MNIST_M                       | Val  Loss: 0.7833 | Val  Acc: 0.7410
 Site-SVHN                          | Val  Loss: 1.0250 | Val  Acc: 0.6739
 Site-SVHN                          | Val  Loss: 1.2672 | Val  Acc: 0.5576
Average Valid Accuracy: 0.8217
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9783
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8696
 Best site-USPS                      | Epoch:24 | Val Acc: 0.9245
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.8478
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.8165
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.8370
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.7410
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.6739
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.5576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.1549 | Train Acc: 0.9623
 Site-MNIST                         | Train Loss: 0.1437 | Train Acc: 0.9686
 Site-USPS                          | Train Loss: 0.1641 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.1431 | Train Acc: 0.9605
 Site-SynthDigits                   | Train Loss: 0.6875 | Train Acc: 0.7601
 Site-SynthDigits                   | Train Loss: 0.5051 | Train Acc: 0.8610
 Site-MNIST_M                       | Train Loss: 0.9186 | Train Acc: 0.6739
 Site-MNIST_M                       | Train Loss: 0.7388 | Train Acc: 0.7498
 Site-SVHN                          | Train Loss: 1.4509 | Train Acc: 0.4906
 Site-SVHN                          | Train Loss: 1.1565 | Train Acc: 0.5955
Average Train Accuracy: 0.7976
 Site-MNIST                         | Val  Loss: 0.1104 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.1236 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.3331 | Val  Acc: 0.9022
 Site-USPS                          | Val  Loss: 0.1918 | Val  Acc: 0.9388
 Site-SynthDigits                   | Val  Loss: 0.5473 | Val  Acc: 0.8370
 Site-SynthDigits                   | Val  Loss: 0.5751 | Val  Acc: 0.8058
 Site-MNIST_M                       | Val  Loss: 0.6463 | Val  Acc: 0.8261
 Site-MNIST_M                       | Val  Loss: 0.8019 | Val  Acc: 0.7410
 Site-SVHN                          | Val  Loss: 1.0173 | Val  Acc: 0.6848
 Site-SVHN                          | Val  Loss: 1.2504 | Val  Acc: 0.5791
Average Valid Accuracy: 0.8264
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9783
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:25 | Val Acc: 0.9022
 Best site-USPS                      | Epoch:25 | Val Acc: 0.9388
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.8370
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.8058
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.8261
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.7410
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.6848
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.5791
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.1381 | Train Acc: 0.9596
 Site-MNIST                         | Train Loss: 0.1369 | Train Acc: 0.9695
 Site-USPS                          | Train Loss: 0.1646 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.1397 | Train Acc: 0.9605
 Site-SynthDigits                   | Train Loss: 0.6622 | Train Acc: 0.7655
 Site-SynthDigits                   | Train Loss: 0.4825 | Train Acc: 0.8691
 Site-MNIST_M                       | Train Loss: 0.9019 | Train Acc: 0.6954
 Site-MNIST_M                       | Train Loss: 0.6861 | Train Acc: 0.7722
 Site-SVHN                          | Train Loss: 1.4436 | Train Acc: 0.4960
 Site-SVHN                          | Train Loss: 1.1490 | Train Acc: 0.6000
Average Train Accuracy: 0.8042
 Site-MNIST                         | Val  Loss: 0.0984 | Val  Acc: 0.9891
 Site-MNIST                         | Val  Loss: 0.1107 | Val  Acc: 0.9820
 Site-USPS                          | Val  Loss: 0.3176 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1864 | Val  Acc: 0.9460
 Site-SynthDigits                   | Val  Loss: 0.5246 | Val  Acc: 0.8370
 Site-SynthDigits                   | Val  Loss: 0.5578 | Val  Acc: 0.8094
 Site-MNIST_M                       | Val  Loss: 0.5823 | Val  Acc: 0.8587
 Site-MNIST_M                       | Val  Loss: 0.7655 | Val  Acc: 0.7590
 Site-SVHN                          | Val  Loss: 1.0026 | Val  Acc: 0.6848
 Site-SVHN                          | Val  Loss: 1.2375 | Val  Acc: 0.5683
Average Valid Accuracy: 0.8347
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9891
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9820
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9130
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9460
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.8370
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.8094
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.8587
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.7590
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.6848
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.5683
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.1469 | Train Acc: 0.9596
 Site-MNIST                         | Train Loss: 0.1363 | Train Acc: 0.9668
 Site-USPS                          | Train Loss: 0.1630 | Train Acc: 0.9515
 Site-USPS                          | Train Loss: 0.1404 | Train Acc: 0.9614
 Site-SynthDigits                   | Train Loss: 0.6516 | Train Acc: 0.7763
 Site-SynthDigits                   | Train Loss: 0.4703 | Train Acc: 0.8682
 Site-MNIST_M                       | Train Loss: 0.9097 | Train Acc: 0.6981
 Site-MNIST_M                       | Train Loss: 0.6938 | Train Acc: 0.7686
 Site-SVHN                          | Train Loss: 1.4312 | Train Acc: 0.4906
 Site-SVHN                          | Train Loss: 1.1205 | Train Acc: 0.6126
Average Train Accuracy: 0.8054
 Site-MNIST                         | Val  Loss: 0.1075 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.1155 | Val  Acc: 0.9784
 Site-USPS                          | Val  Loss: 0.3359 | Val  Acc: 0.8913
 Site-USPS                          | Val  Loss: 0.1909 | Val  Acc: 0.9388
 Site-SynthDigits                   | Val  Loss: 0.5070 | Val  Acc: 0.8370
 Site-SynthDigits                   | Val  Loss: 0.5420 | Val  Acc: 0.8273
 Site-MNIST_M                       | Val  Loss: 0.5932 | Val  Acc: 0.8261
 Site-MNIST_M                       | Val  Loss: 0.7722 | Val  Acc: 0.7590
 Site-SVHN                          | Val  Loss: 0.9595 | Val  Acc: 0.6957
 Site-SVHN                          | Val  Loss: 1.2112 | Val  Acc: 0.5863
Average Valid Accuracy: 0.8318
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.1385 | Train Acc: 0.9596
 Site-MNIST                         | Train Loss: 0.1242 | Train Acc: 0.9722
 Site-USPS                          | Train Loss: 0.1557 | Train Acc: 0.9488
 Site-USPS                          | Train Loss: 0.1259 | Train Acc: 0.9614
 Site-SynthDigits                   | Train Loss: 0.6287 | Train Acc: 0.7844
 Site-SynthDigits                   | Train Loss: 0.4560 | Train Acc: 0.8744
 Site-MNIST_M                       | Train Loss: 0.8811 | Train Acc: 0.6981
 Site-MNIST_M                       | Train Loss: 0.6543 | Train Acc: 0.7776
 Site-SVHN                          | Train Loss: 1.4405 | Train Acc: 0.4987
 Site-SVHN                          | Train Loss: 1.1465 | Train Acc: 0.6009
Average Train Accuracy: 0.8076
 Site-MNIST                         | Val  Loss: 0.0918 | Val  Acc: 0.9891
 Site-MNIST                         | Val  Loss: 0.1047 | Val  Acc: 0.9820
 Site-USPS                          | Val  Loss: 0.3155 | Val  Acc: 0.9022
 Site-USPS                          | Val  Loss: 0.1787 | Val  Acc: 0.9424
 Site-SynthDigits                   | Val  Loss: 0.4985 | Val  Acc: 0.8370
 Site-SynthDigits                   | Val  Loss: 0.5135 | Val  Acc: 0.8381
 Site-MNIST_M                       | Val  Loss: 0.5661 | Val  Acc: 0.8587
 Site-MNIST_M                       | Val  Loss: 0.7416 | Val  Acc: 0.7662
 Site-SVHN                          | Val  Loss: 0.9746 | Val  Acc: 0.6957
 Site-SVHN                          | Val  Loss: 1.2238 | Val  Acc: 0.5827
Average Valid Accuracy: 0.8394
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9891
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9820
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9022
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9424
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.8370
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.8381
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.8587
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.7662
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.6957
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.5827
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.1395 | Train Acc: 0.9623
 Site-MNIST                         | Train Loss: 0.1251 | Train Acc: 0.9740
 Site-USPS                          | Train Loss: 0.1556 | Train Acc: 0.9569
 Site-USPS                          | Train Loss: 0.1292 | Train Acc: 0.9650
 Site-SynthDigits                   | Train Loss: 0.6399 | Train Acc: 0.7709
 Site-SynthDigits                   | Train Loss: 0.4523 | Train Acc: 0.8789
 Site-MNIST_M                       | Train Loss: 0.8837 | Train Acc: 0.6873
 Site-MNIST_M                       | Train Loss: 0.6578 | Train Acc: 0.7767
 Site-SVHN                          | Train Loss: 1.4333 | Train Acc: 0.4987
 Site-SVHN                          | Train Loss: 1.1275 | Train Acc: 0.6027
Average Train Accuracy: 0.8073
 Site-MNIST                         | Val  Loss: 0.0873 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.1003 | Val  Acc: 0.9820
 Site-USPS                          | Val  Loss: 0.3247 | Val  Acc: 0.9022
 Site-USPS                          | Val  Loss: 0.1779 | Val  Acc: 0.9424
 Site-SynthDigits                   | Val  Loss: 0.4984 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.5163 | Val  Acc: 0.8381
 Site-MNIST_M                       | Val  Loss: 0.5483 | Val  Acc: 0.8696
 Site-MNIST_M                       | Val  Loss: 0.7269 | Val  Acc: 0.7698
 Site-SVHN                          | Val  Loss: 0.9570 | Val  Acc: 0.7283
 Site-SVHN                          | Val  Loss: 1.2177 | Val  Acc: 0.6007
Average Valid Accuracy: 0.8470
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9783
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9820
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9022
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9424
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.8587
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.8381
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.8696
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.7698
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.7283
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.6007
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.1393 | Train Acc: 0.9569
 Site-MNIST                         | Train Loss: 0.1185 | Train Acc: 0.9740
 Site-USPS                          | Train Loss: 0.1595 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.1163 | Train Acc: 0.9668
 Site-SynthDigits                   | Train Loss: 0.6376 | Train Acc: 0.7682
 Site-SynthDigits                   | Train Loss: 0.4507 | Train Acc: 0.8726
 Site-MNIST_M                       | Train Loss: 0.8834 | Train Acc: 0.6927
 Site-MNIST_M                       | Train Loss: 0.6460 | Train Acc: 0.7892
 Site-SVHN                          | Train Loss: 1.4498 | Train Acc: 0.5040
 Site-SVHN                          | Train Loss: 1.1395 | Train Acc: 0.6072
Average Train Accuracy: 0.8086
 Site-MNIST                         | Val  Loss: 0.0800 | Val  Acc: 0.9891
 Site-MNIST                         | Val  Loss: 0.0951 | Val  Acc: 0.9748
 Site-USPS                          | Val  Loss: 0.2851 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1687 | Val  Acc: 0.9460
 Site-SynthDigits                   | Val  Loss: 0.4997 | Val  Acc: 0.8370
 Site-SynthDigits                   | Val  Loss: 0.5168 | Val  Acc: 0.8273
 Site-MNIST_M                       | Val  Loss: 0.5424 | Val  Acc: 0.8804
 Site-MNIST_M                       | Val  Loss: 0.7240 | Val  Acc: 0.7698
 Site-SVHN                          | Val  Loss: 0.9588 | Val  Acc: 0.7174
 Site-SVHN                          | Val  Loss: 1.2143 | Val  Acc: 0.5899
Average Valid Accuracy: 0.8445
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.1392 | Train Acc: 0.9596
 Site-MNIST                         | Train Loss: 0.1182 | Train Acc: 0.9740
 Site-USPS                          | Train Loss: 0.1544 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.1291 | Train Acc: 0.9605
 Site-SynthDigits                   | Train Loss: 0.6071 | Train Acc: 0.7951
 Site-SynthDigits                   | Train Loss: 0.4225 | Train Acc: 0.8861
 Site-MNIST_M                       | Train Loss: 0.8918 | Train Acc: 0.6873
 Site-MNIST_M                       | Train Loss: 0.6413 | Train Acc: 0.7964
 Site-SVHN                          | Train Loss: 1.3664 | Train Acc: 0.5175
 Site-SVHN                          | Train Loss: 1.0902 | Train Acc: 0.6188
Average Train Accuracy: 0.8155
 Site-MNIST                         | Val  Loss: 0.0848 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.1032 | Val  Acc: 0.9748
 Site-USPS                          | Val  Loss: 0.3289 | Val  Acc: 0.8913
 Site-USPS                          | Val  Loss: 0.1804 | Val  Acc: 0.9388
 Site-SynthDigits                   | Val  Loss: 0.4582 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.4772 | Val  Acc: 0.8453
 Site-MNIST_M                       | Val  Loss: 0.5581 | Val  Acc: 0.8587
 Site-MNIST_M                       | Val  Loss: 0.7363 | Val  Acc: 0.7734
 Site-SVHN                          | Val  Loss: 0.8999 | Val  Acc: 0.7174
 Site-SVHN                          | Val  Loss: 1.1529 | Val  Acc: 0.5899
Average Valid Accuracy: 0.8427
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.1282 | Train Acc: 0.9650
 Site-MNIST                         | Train Loss: 0.1118 | Train Acc: 0.9749
 Site-USPS                          | Train Loss: 0.1516 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.1173 | Train Acc: 0.9668
 Site-SynthDigits                   | Train Loss: 0.6255 | Train Acc: 0.7871
 Site-SynthDigits                   | Train Loss: 0.4314 | Train Acc: 0.8852
 Site-MNIST_M                       | Train Loss: 0.8726 | Train Acc: 0.7089
 Site-MNIST_M                       | Train Loss: 0.6267 | Train Acc: 0.8009
 Site-SVHN                          | Train Loss: 1.4021 | Train Acc: 0.5121
 Site-SVHN                          | Train Loss: 1.0991 | Train Acc: 0.6161
Average Train Accuracy: 0.8171
 Site-MNIST                         | Val  Loss: 0.0798 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.0955 | Val  Acc: 0.9748
 Site-USPS                          | Val  Loss: 0.2872 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1618 | Val  Acc: 0.9532
 Site-SynthDigits                   | Val  Loss: 0.4591 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.4945 | Val  Acc: 0.8345
 Site-MNIST_M                       | Val  Loss: 0.5276 | Val  Acc: 0.8696
 Site-MNIST_M                       | Val  Loss: 0.7221 | Val  Acc: 0.7878
 Site-SVHN                          | Val  Loss: 0.9062 | Val  Acc: 0.7174
 Site-SVHN                          | Val  Loss: 1.1575 | Val  Acc: 0.6079
Average Valid Accuracy: 0.8506
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9783
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9748
 Best site-USPS                      | Epoch:32 | Val Acc: 0.9239
 Best site-USPS                      | Epoch:32 | Val Acc: 0.9532
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.8587
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.8345
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.8696
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.7878
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.7174
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.6079
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.1204 | Train Acc: 0.9650
 Site-MNIST                         | Train Loss: 0.1071 | Train Acc: 0.9749
 Site-USPS                          | Train Loss: 0.1400 | Train Acc: 0.9569
 Site-USPS                          | Train Loss: 0.1094 | Train Acc: 0.9686
 Site-SynthDigits                   | Train Loss: 0.6039 | Train Acc: 0.7871
 Site-SynthDigits                   | Train Loss: 0.4213 | Train Acc: 0.8897
 Site-MNIST_M                       | Train Loss: 0.8791 | Train Acc: 0.6792
 Site-MNIST_M                       | Train Loss: 0.6144 | Train Acc: 0.8018
 Site-SVHN                          | Train Loss: 1.4003 | Train Acc: 0.5013
 Site-SVHN                          | Train Loss: 1.1037 | Train Acc: 0.6099
Average Train Accuracy: 0.8134
 Site-MNIST                         | Val  Loss: 0.0796 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.0922 | Val  Acc: 0.9820
 Site-USPS                          | Val  Loss: 0.2702 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1547 | Val  Acc: 0.9460
 Site-SynthDigits                   | Val  Loss: 0.4617 | Val  Acc: 0.8370
 Site-SynthDigits                   | Val  Loss: 0.4852 | Val  Acc: 0.8417
 Site-MNIST_M                       | Val  Loss: 0.5092 | Val  Acc: 0.8913
 Site-MNIST_M                       | Val  Loss: 0.7030 | Val  Acc: 0.7770
 Site-SVHN                          | Val  Loss: 0.9031 | Val  Acc: 0.7065
 Site-SVHN                          | Val  Loss: 1.1606 | Val  Acc: 0.5791
Average Valid Accuracy: 0.8452
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.1193 | Train Acc: 0.9623
 Site-MNIST                         | Train Loss: 0.1081 | Train Acc: 0.9749
 Site-USPS                          | Train Loss: 0.1412 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.1105 | Train Acc: 0.9686
 Site-SynthDigits                   | Train Loss: 0.6131 | Train Acc: 0.8005
 Site-SynthDigits                   | Train Loss: 0.4063 | Train Acc: 0.8933
 Site-MNIST_M                       | Train Loss: 0.8682 | Train Acc: 0.6792
 Site-MNIST_M                       | Train Loss: 0.5978 | Train Acc: 0.8099
 Site-SVHN                          | Train Loss: 1.4032 | Train Acc: 0.5094
 Site-SVHN                          | Train Loss: 1.0884 | Train Acc: 0.6170
Average Train Accuracy: 0.8169
 Site-MNIST                         | Val  Loss: 0.0790 | Val  Acc: 0.9891
 Site-MNIST                         | Val  Loss: 0.0924 | Val  Acc: 0.9820
 Site-USPS                          | Val  Loss: 0.2776 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1538 | Val  Acc: 0.9496
 Site-SynthDigits                   | Val  Loss: 0.4548 | Val  Acc: 0.8478
 Site-SynthDigits                   | Val  Loss: 0.4823 | Val  Acc: 0.8489
 Site-MNIST_M                       | Val  Loss: 0.5061 | Val  Acc: 0.9130
 Site-MNIST_M                       | Val  Loss: 0.6949 | Val  Acc: 0.7842
 Site-SVHN                          | Val  Loss: 0.9138 | Val  Acc: 0.7174
 Site-SVHN                          | Val  Loss: 1.1475 | Val  Acc: 0.6007
Average Valid Accuracy: 0.8546
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9891
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9820
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9130
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9496
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.8478
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.8489
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.9130
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.7842
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.7174
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.6007
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.1194 | Train Acc: 0.9623
 Site-MNIST                         | Train Loss: 0.1107 | Train Acc: 0.9740
 Site-USPS                          | Train Loss: 0.1475 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.1100 | Train Acc: 0.9659
 Site-SynthDigits                   | Train Loss: 0.5852 | Train Acc: 0.7951
 Site-SynthDigits                   | Train Loss: 0.3954 | Train Acc: 0.9022
 Site-MNIST_M                       | Train Loss: 0.8606 | Train Acc: 0.7008
 Site-MNIST_M                       | Train Loss: 0.5794 | Train Acc: 0.8135
 Site-SVHN                          | Train Loss: 1.3770 | Train Acc: 0.5337
 Site-SVHN                          | Train Loss: 1.0512 | Train Acc: 0.6296
Average Train Accuracy: 0.8231
 Site-MNIST                         | Val  Loss: 0.0764 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.0914 | Val  Acc: 0.9784
 Site-USPS                          | Val  Loss: 0.2844 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1555 | Val  Acc: 0.9496
 Site-SynthDigits                   | Val  Loss: 0.4282 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.4595 | Val  Acc: 0.8633
 Site-MNIST_M                       | Val  Loss: 0.4797 | Val  Acc: 0.9130
 Site-MNIST_M                       | Val  Loss: 0.6757 | Val  Acc: 0.8058
 Site-SVHN                          | Val  Loss: 0.8815 | Val  Acc: 0.7283
 Site-SVHN                          | Val  Loss: 1.1243 | Val  Acc: 0.6187
Average Valid Accuracy: 0.8618
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9783
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9784
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9130
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9496
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.8696
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.8633
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.9130
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.8058
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.7283
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.6187
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.1186 | Train Acc: 0.9704
 Site-MNIST                         | Train Loss: 0.0976 | Train Acc: 0.9767
 Site-USPS                          | Train Loss: 0.1587 | Train Acc: 0.9515
 Site-USPS                          | Train Loss: 0.1060 | Train Acc: 0.9659
 Site-SynthDigits                   | Train Loss: 0.5996 | Train Acc: 0.7817
 Site-SynthDigits                   | Train Loss: 0.4009 | Train Acc: 0.8987
 Site-MNIST_M                       | Train Loss: 0.8238 | Train Acc: 0.7170
 Site-MNIST_M                       | Train Loss: 0.5545 | Train Acc: 0.8278
 Site-SVHN                          | Train Loss: 1.4122 | Train Acc: 0.5013
 Site-SVHN                          | Train Loss: 1.0790 | Train Acc: 0.6152
Average Train Accuracy: 0.8206
 Site-MNIST                         | Val  Loss: 0.0700 | Val  Acc: 0.9891
 Site-MNIST                         | Val  Loss: 0.0831 | Val  Acc: 0.9856
 Site-USPS                          | Val  Loss: 0.2742 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1578 | Val  Acc: 0.9496
 Site-SynthDigits                   | Val  Loss: 0.4662 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.4782 | Val  Acc: 0.8633
 Site-MNIST_M                       | Val  Loss: 0.4743 | Val  Acc: 0.8804
 Site-MNIST_M                       | Val  Loss: 0.6590 | Val  Acc: 0.8129
 Site-SVHN                          | Val  Loss: 0.9268 | Val  Acc: 0.6848
 Site-SVHN                          | Val  Loss: 1.1429 | Val  Acc: 0.5899
Average Valid Accuracy: 0.8538
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.1195 | Train Acc: 0.9623
 Site-MNIST                         | Train Loss: 0.1000 | Train Acc: 0.9749
 Site-USPS                          | Train Loss: 0.1438 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.1026 | Train Acc: 0.9677
 Site-SynthDigits                   | Train Loss: 0.6012 | Train Acc: 0.7951
 Site-SynthDigits                   | Train Loss: 0.3906 | Train Acc: 0.9031
 Site-MNIST_M                       | Train Loss: 0.8457 | Train Acc: 0.6927
 Site-MNIST_M                       | Train Loss: 0.5784 | Train Acc: 0.8152
 Site-SVHN                          | Train Loss: 1.3664 | Train Acc: 0.5229
 Site-SVHN                          | Train Loss: 1.0435 | Train Acc: 0.6332
Average Train Accuracy: 0.8221
 Site-MNIST                         | Val  Loss: 0.0795 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.0896 | Val  Acc: 0.9820
 Site-USPS                          | Val  Loss: 0.2860 | Val  Acc: 0.8913
 Site-USPS                          | Val  Loss: 0.1504 | Val  Acc: 0.9424
 Site-SynthDigits                   | Val  Loss: 0.4369 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.4608 | Val  Acc: 0.8561
 Site-MNIST_M                       | Val  Loss: 0.4689 | Val  Acc: 0.8696
 Site-MNIST_M                       | Val  Loss: 0.6755 | Val  Acc: 0.7842
 Site-SVHN                          | Val  Loss: 0.8722 | Val  Acc: 0.7065
 Site-SVHN                          | Val  Loss: 1.1238 | Val  Acc: 0.6007
Average Valid Accuracy: 0.8481
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.1133 | Train Acc: 0.9677
 Site-MNIST                         | Train Loss: 0.0956 | Train Acc: 0.9776
 Site-USPS                          | Train Loss: 0.1534 | Train Acc: 0.9569
 Site-USPS                          | Train Loss: 0.1011 | Train Acc: 0.9695
 Site-SynthDigits                   | Train Loss: 0.5945 | Train Acc: 0.7951
 Site-SynthDigits                   | Train Loss: 0.3776 | Train Acc: 0.9076
 Site-MNIST_M                       | Train Loss: 0.8508 | Train Acc: 0.7089
 Site-MNIST_M                       | Train Loss: 0.5481 | Train Acc: 0.8314
 Site-SVHN                          | Train Loss: 1.3648 | Train Acc: 0.5391
 Site-SVHN                          | Train Loss: 1.0380 | Train Acc: 0.6413
Average Train Accuracy: 0.8295
 Site-MNIST                         | Val  Loss: 0.0654 | Val  Acc: 0.9891
 Site-MNIST                         | Val  Loss: 0.0791 | Val  Acc: 0.9856
 Site-USPS                          | Val  Loss: 0.2665 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1495 | Val  Acc: 0.9460
 Site-SynthDigits                   | Val  Loss: 0.4226 | Val  Acc: 0.8804
 Site-SynthDigits                   | Val  Loss: 0.4579 | Val  Acc: 0.8633
 Site-MNIST_M                       | Val  Loss: 0.4457 | Val  Acc: 0.8913
 Site-MNIST_M                       | Val  Loss: 0.6568 | Val  Acc: 0.8022
 Site-SVHN                          | Val  Loss: 0.8582 | Val  Acc: 0.7174
 Site-SVHN                          | Val  Loss: 1.1020 | Val  Acc: 0.6259
Average Valid Accuracy: 0.8614
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.1201 | Train Acc: 0.9677
 Site-MNIST                         | Train Loss: 0.1006 | Train Acc: 0.9758
 Site-USPS                          | Train Loss: 0.1398 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.1026 | Train Acc: 0.9749
 Site-SynthDigits                   | Train Loss: 0.5511 | Train Acc: 0.8086
 Site-SynthDigits                   | Train Loss: 0.3635 | Train Acc: 0.9130
 Site-MNIST_M                       | Train Loss: 0.8567 | Train Acc: 0.6846
 Site-MNIST_M                       | Train Loss: 0.5553 | Train Acc: 0.8242
 Site-SVHN                          | Train Loss: 1.3575 | Train Acc: 0.5067
 Site-SVHN                          | Train Loss: 1.0161 | Train Acc: 0.6574
Average Train Accuracy: 0.8278
 Site-MNIST                         | Val  Loss: 0.0732 | Val  Acc: 0.9891
 Site-MNIST                         | Val  Loss: 0.0876 | Val  Acc: 0.9856
 Site-USPS                          | Val  Loss: 0.2724 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1436 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.4007 | Val  Acc: 0.8804
 Site-SynthDigits                   | Val  Loss: 0.4252 | Val  Acc: 0.8813
 Site-MNIST_M                       | Val  Loss: 0.4560 | Val  Acc: 0.8913
 Site-MNIST_M                       | Val  Loss: 0.6710 | Val  Acc: 0.7878
 Site-SVHN                          | Val  Loss: 0.8317 | Val  Acc: 0.7609
 Site-SVHN                          | Val  Loss: 1.0781 | Val  Acc: 0.6331
Average Valid Accuracy: 0.8701
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9891
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9856
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9348
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9568
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.8804
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.8813
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.8913
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.7878
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.7609
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.6331
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.1138 | Train Acc: 0.9704
 Site-MNIST                         | Train Loss: 0.1007 | Train Acc: 0.9767
 Site-USPS                          | Train Loss: 0.1530 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.1039 | Train Acc: 0.9695
 Site-SynthDigits                   | Train Loss: 0.5824 | Train Acc: 0.8005
 Site-SynthDigits                   | Train Loss: 0.3674 | Train Acc: 0.9121
 Site-MNIST_M                       | Train Loss: 0.8513 | Train Acc: 0.6846
 Site-MNIST_M                       | Train Loss: 0.5591 | Train Acc: 0.8152
 Site-SVHN                          | Train Loss: 1.3632 | Train Acc: 0.5175
 Site-SVHN                          | Train Loss: 1.0250 | Train Acc: 0.6422
Average Train Accuracy: 0.8243
 Site-MNIST                         | Val  Loss: 0.0670 | Val  Acc: 0.9891
 Site-MNIST                         | Val  Loss: 0.0795 | Val  Acc: 0.9856
 Site-USPS                          | Val  Loss: 0.2988 | Val  Acc: 0.9022
 Site-USPS                          | Val  Loss: 0.1593 | Val  Acc: 0.9424
 Site-SynthDigits                   | Val  Loss: 0.4173 | Val  Acc: 0.8804
 Site-SynthDigits                   | Val  Loss: 0.4401 | Val  Acc: 0.8777
 Site-MNIST_M                       | Val  Loss: 0.4427 | Val  Acc: 0.9022
 Site-MNIST_M                       | Val  Loss: 0.6435 | Val  Acc: 0.7914
 Site-SVHN                          | Val  Loss: 0.8278 | Val  Acc: 0.7174
 Site-SVHN                          | Val  Loss: 1.0890 | Val  Acc: 0.6151
Average Valid Accuracy: 0.8604
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.1100 | Train Acc: 0.9704
 Site-MNIST                         | Train Loss: 0.0881 | Train Acc: 0.9767
 Site-USPS                          | Train Loss: 0.1302 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.0885 | Train Acc: 0.9785
 Site-SynthDigits                   | Train Loss: 0.5583 | Train Acc: 0.7978
 Site-SynthDigits                   | Train Loss: 0.3571 | Train Acc: 0.9094
 Site-MNIST_M                       | Train Loss: 0.8387 | Train Acc: 0.6873
 Site-MNIST_M                       | Train Loss: 0.5357 | Train Acc: 0.8314
 Site-SVHN                          | Train Loss: 1.3554 | Train Acc: 0.5067
 Site-SVHN                          | Train Loss: 1.0067 | Train Acc: 0.6466
Average Train Accuracy: 0.8264
 Site-MNIST                         | Val  Loss: 0.0637 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.0776 | Val  Acc: 0.9820
 Site-USPS                          | Val  Loss: 0.2398 | Val  Acc: 0.9022
 Site-USPS                          | Val  Loss: 0.1324 | Val  Acc: 0.9496
 Site-SynthDigits                   | Val  Loss: 0.3839 | Val  Acc: 0.8804
 Site-SynthDigits                   | Val  Loss: 0.4288 | Val  Acc: 0.8597
 Site-MNIST_M                       | Val  Loss: 0.4457 | Val  Acc: 0.8913
 Site-MNIST_M                       | Val  Loss: 0.6521 | Val  Acc: 0.7950
 Site-SVHN                          | Val  Loss: 0.8467 | Val  Acc: 0.7174
 Site-SVHN                          | Val  Loss: 1.0821 | Val  Acc: 0.6259
Average Valid Accuracy: 0.8582
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.1115 | Train Acc: 0.9677
 Site-MNIST                         | Train Loss: 0.0820 | Train Acc: 0.9803
 Site-USPS                          | Train Loss: 0.1401 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.0905 | Train Acc: 0.9740
 Site-SynthDigits                   | Train Loss: 0.5770 | Train Acc: 0.7898
 Site-SynthDigits                   | Train Loss: 0.3589 | Train Acc: 0.9130
 Site-MNIST_M                       | Train Loss: 0.8217 | Train Acc: 0.7035
 Site-MNIST_M                       | Train Loss: 0.5061 | Train Acc: 0.8422
 Site-SVHN                          | Train Loss: 1.3933 | Train Acc: 0.5121
 Site-SVHN                          | Train Loss: 1.0528 | Train Acc: 0.6233
Average Train Accuracy: 0.8260
 Site-MNIST                         | Val  Loss: 0.0547 | Val  Acc: 0.9891
 Site-MNIST                         | Val  Loss: 0.0703 | Val  Acc: 0.9820
 Site-USPS                          | Val  Loss: 0.2326 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1354 | Val  Acc: 0.9496
 Site-SynthDigits                   | Val  Loss: 0.3970 | Val  Acc: 0.8804
 Site-SynthDigits                   | Val  Loss: 0.4367 | Val  Acc: 0.8669
 Site-MNIST_M                       | Val  Loss: 0.4157 | Val  Acc: 0.9239
 Site-MNIST_M                       | Val  Loss: 0.6112 | Val  Acc: 0.8237
 Site-SVHN                          | Val  Loss: 0.8376 | Val  Acc: 0.7283
 Site-SVHN                          | Val  Loss: 1.1057 | Val  Acc: 0.6187
Average Valid Accuracy: 0.8676
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.1094 | Train Acc: 0.9677
 Site-MNIST                         | Train Loss: 0.0811 | Train Acc: 0.9821
 Site-USPS                          | Train Loss: 0.1286 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.0916 | Train Acc: 0.9776
 Site-SynthDigits                   | Train Loss: 0.5572 | Train Acc: 0.8005
 Site-SynthDigits                   | Train Loss: 0.3497 | Train Acc: 0.9202
 Site-MNIST_M                       | Train Loss: 0.8251 | Train Acc: 0.6981
 Site-MNIST_M                       | Train Loss: 0.4975 | Train Acc: 0.8511
 Site-SVHN                          | Train Loss: 1.3559 | Train Acc: 0.5202
 Site-SVHN                          | Train Loss: 1.0064 | Train Acc: 0.6502
Average Train Accuracy: 0.8327
 Site-MNIST                         | Val  Loss: 0.0499 | Val  Acc: 0.9891
 Site-MNIST                         | Val  Loss: 0.0704 | Val  Acc: 0.9820
 Site-USPS                          | Val  Loss: 0.2447 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1310 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.3839 | Val  Acc: 0.9022
 Site-SynthDigits                   | Val  Loss: 0.4205 | Val  Acc: 0.8813
 Site-MNIST_M                       | Val  Loss: 0.4159 | Val  Acc: 0.9130
 Site-MNIST_M                       | Val  Loss: 0.6196 | Val  Acc: 0.8201
 Site-SVHN                          | Val  Loss: 0.8179 | Val  Acc: 0.7174
 Site-SVHN                          | Val  Loss: 1.0798 | Val  Acc: 0.6295
Average Valid Accuracy: 0.8705
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9891
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9820
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9130
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9568
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.9022
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.8813
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.9130
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.8201
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.7174
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.6295
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.1168 | Train Acc: 0.9596
 Site-MNIST                         | Train Loss: 0.0820 | Train Acc: 0.9794
 Site-USPS                          | Train Loss: 0.1259 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.0944 | Train Acc: 0.9722
 Site-SynthDigits                   | Train Loss: 0.5525 | Train Acc: 0.8086
 Site-SynthDigits                   | Train Loss: 0.3368 | Train Acc: 0.9112
 Site-MNIST_M                       | Train Loss: 0.8425 | Train Acc: 0.6900
 Site-MNIST_M                       | Train Loss: 0.5266 | Train Acc: 0.8314
 Site-SVHN                          | Train Loss: 1.3230 | Train Acc: 0.5337
 Site-SVHN                          | Train Loss: 0.9724 | Train Acc: 0.6610
Average Train Accuracy: 0.8309
 Site-MNIST                         | Val  Loss: 0.0527 | Val  Acc: 0.9891
 Site-MNIST                         | Val  Loss: 0.0765 | Val  Acc: 0.9784
 Site-USPS                          | Val  Loss: 0.2757 | Val  Acc: 0.8804
 Site-USPS                          | Val  Loss: 0.1403 | Val  Acc: 0.9388
 Site-SynthDigits                   | Val  Loss: 0.3711 | Val  Acc: 0.8804
 Site-SynthDigits                   | Val  Loss: 0.4059 | Val  Acc: 0.8813
 Site-MNIST_M                       | Val  Loss: 0.4370 | Val  Acc: 0.8913
 Site-MNIST_M                       | Val  Loss: 0.6310 | Val  Acc: 0.7986
 Site-SVHN                          | Val  Loss: 0.8234 | Val  Acc: 0.7174
 Site-SVHN                          | Val  Loss: 1.0553 | Val  Acc: 0.6331
Average Valid Accuracy: 0.8589
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.1084 | Train Acc: 0.9730
 Site-MNIST                         | Train Loss: 0.0818 | Train Acc: 0.9776
 Site-USPS                          | Train Loss: 0.1355 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.0865 | Train Acc: 0.9776
 Site-SynthDigits                   | Train Loss: 0.5578 | Train Acc: 0.8113
 Site-SynthDigits                   | Train Loss: 0.3396 | Train Acc: 0.9193
 Site-MNIST_M                       | Train Loss: 0.8221 | Train Acc: 0.6927
 Site-MNIST_M                       | Train Loss: 0.4856 | Train Acc: 0.8556
 Site-SVHN                          | Train Loss: 1.3636 | Train Acc: 0.5202
 Site-SVHN                          | Train Loss: 1.0176 | Train Acc: 0.6413
Average Train Accuracy: 0.8328
 Site-MNIST                         | Val  Loss: 0.0529 | Val  Acc: 0.9891
 Site-MNIST                         | Val  Loss: 0.0723 | Val  Acc: 0.9820
 Site-USPS                          | Val  Loss: 0.2570 | Val  Acc: 0.9022
 Site-USPS                          | Val  Loss: 0.1355 | Val  Acc: 0.9532
 Site-SynthDigits                   | Val  Loss: 0.3905 | Val  Acc: 0.9130
 Site-SynthDigits                   | Val  Loss: 0.4122 | Val  Acc: 0.8957
 Site-MNIST_M                       | Val  Loss: 0.3955 | Val  Acc: 0.9457
 Site-MNIST_M                       | Val  Loss: 0.5931 | Val  Acc: 0.8381
 Site-SVHN                          | Val  Loss: 0.8181 | Val  Acc: 0.7174
 Site-SVHN                          | Val  Loss: 1.0754 | Val  Acc: 0.6115
Average Valid Accuracy: 0.8748
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9891
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9820
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9022
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9532
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.9130
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.8957
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.9457
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.8381
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.7174
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.6115
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.1077 | Train Acc: 0.9623
 Site-MNIST                         | Train Loss: 0.0779 | Train Acc: 0.9821
 Site-USPS                          | Train Loss: 0.1327 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.0932 | Train Acc: 0.9758
 Site-SynthDigits                   | Train Loss: 0.5462 | Train Acc: 0.8086
 Site-SynthDigits                   | Train Loss: 0.3236 | Train Acc: 0.9148
 Site-MNIST_M                       | Train Loss: 0.8264 | Train Acc: 0.7008
 Site-MNIST_M                       | Train Loss: 0.4812 | Train Acc: 0.8583
 Site-SVHN                          | Train Loss: 1.3710 | Train Acc: 0.5364
 Site-SVHN                          | Train Loss: 0.9928 | Train Acc: 0.6439
Average Train Accuracy: 0.8343
 Site-MNIST                         | Val  Loss: 0.0514 | Val  Acc: 0.9891
 Site-MNIST                         | Val  Loss: 0.0696 | Val  Acc: 0.9820
 Site-USPS                          | Val  Loss: 0.2768 | Val  Acc: 0.9022
 Site-USPS                          | Val  Loss: 0.1388 | Val  Acc: 0.9460
 Site-SynthDigits                   | Val  Loss: 0.3732 | Val  Acc: 0.8913
 Site-SynthDigits                   | Val  Loss: 0.3915 | Val  Acc: 0.8885
 Site-MNIST_M                       | Val  Loss: 0.3747 | Val  Acc: 0.9457
 Site-MNIST_M                       | Val  Loss: 0.5813 | Val  Acc: 0.8273
 Site-SVHN                          | Val  Loss: 0.8325 | Val  Acc: 0.6848
 Site-SVHN                          | Val  Loss: 1.0804 | Val  Acc: 0.6187
Average Valid Accuracy: 0.8676
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.1112 | Train Acc: 0.9784
 Site-MNIST                         | Train Loss: 0.0792 | Train Acc: 0.9812
 Site-USPS                          | Train Loss: 0.1292 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.0829 | Train Acc: 0.9794
 Site-SynthDigits                   | Train Loss: 0.5504 | Train Acc: 0.8032
 Site-SynthDigits                   | Train Loss: 0.3279 | Train Acc: 0.9157
 Site-MNIST_M                       | Train Loss: 0.8086 | Train Acc: 0.6900
 Site-MNIST_M                       | Train Loss: 0.4894 | Train Acc: 0.8493
 Site-SVHN                          | Train Loss: 1.3317 | Train Acc: 0.5418
 Site-SVHN                          | Train Loss: 0.9720 | Train Acc: 0.6619
Average Train Accuracy: 0.8360
 Site-MNIST                         | Val  Loss: 0.0584 | Val  Acc: 0.9891
 Site-MNIST                         | Val  Loss: 0.0715 | Val  Acc: 0.9892
 Site-USPS                          | Val  Loss: 0.2332 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1310 | Val  Acc: 0.9532
 Site-SynthDigits                   | Val  Loss: 0.3688 | Val  Acc: 0.9022
 Site-SynthDigits                   | Val  Loss: 0.3994 | Val  Acc: 0.8777
 Site-MNIST_M                       | Val  Loss: 0.3887 | Val  Acc: 0.9457
 Site-MNIST_M                       | Val  Loss: 0.6055 | Val  Acc: 0.8237
 Site-SVHN                          | Val  Loss: 0.8180 | Val  Acc: 0.7174
 Site-SVHN                          | Val  Loss: 1.0414 | Val  Acc: 0.6403
Average Valid Accuracy: 0.8762
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9891
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9892
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9239
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9532
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.9022
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.8777
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.9457
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.8237
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.7174
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.6403
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.1069 | Train Acc: 0.9677
 Site-MNIST                         | Train Loss: 0.0717 | Train Acc: 0.9821
 Site-USPS                          | Train Loss: 0.1240 | Train Acc: 0.9677
 Site-USPS                          | Train Loss: 0.0818 | Train Acc: 0.9794
 Site-SynthDigits                   | Train Loss: 0.5518 | Train Acc: 0.8059
 Site-SynthDigits                   | Train Loss: 0.3174 | Train Acc: 0.9157
 Site-MNIST_M                       | Train Loss: 0.8126 | Train Acc: 0.7089
 Site-MNIST_M                       | Train Loss: 0.4640 | Train Acc: 0.8691
 Site-SVHN                          | Train Loss: 1.3477 | Train Acc: 0.5310
 Site-SVHN                          | Train Loss: 0.9860 | Train Acc: 0.6547
Average Train Accuracy: 0.8382
 Site-MNIST                         | Val  Loss: 0.0438 | Val  Acc: 0.9891
 Site-MNIST                         | Val  Loss: 0.0623 | Val  Acc: 0.9856
 Site-USPS                          | Val  Loss: 0.2034 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1214 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.3672 | Val  Acc: 0.8913
 Site-SynthDigits                   | Val  Loss: 0.3937 | Val  Acc: 0.8813
 Site-MNIST_M                       | Val  Loss: 0.3560 | Val  Acc: 0.9565
 Site-MNIST_M                       | Val  Loss: 0.5748 | Val  Acc: 0.8345
 Site-SVHN                          | Val  Loss: 0.8074 | Val  Acc: 0.7283
 Site-SVHN                          | Val  Loss: 1.0521 | Val  Acc: 0.6259
Average Valid Accuracy: 0.8773
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9891
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9856
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9239
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9568
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.8913
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.8813
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.9565
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.8345
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.7283
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.6259
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.1107 | Train Acc: 0.9704
 Site-MNIST                         | Train Loss: 0.0726 | Train Acc: 0.9857
 Site-USPS                          | Train Loss: 0.1261 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.0833 | Train Acc: 0.9848
 Site-SynthDigits                   | Train Loss: 0.5292 | Train Acc: 0.7978
 Site-SynthDigits                   | Train Loss: 0.3174 | Train Acc: 0.9076
 Site-MNIST_M                       | Train Loss: 0.8420 | Train Acc: 0.6954
 Site-MNIST_M                       | Train Loss: 0.4880 | Train Acc: 0.8493
 Site-SVHN                          | Train Loss: 1.3271 | Train Acc: 0.5418
 Site-SVHN                          | Train Loss: 0.9497 | Train Acc: 0.6709
Average Train Accuracy: 0.8366
 Site-MNIST                         | Val  Loss: 0.0527 | Val  Acc: 0.9891
 Site-MNIST                         | Val  Loss: 0.0649 | Val  Acc: 0.9892
 Site-USPS                          | Val  Loss: 0.2282 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1274 | Val  Acc: 0.9604
 Site-SynthDigits                   | Val  Loss: 0.3565 | Val  Acc: 0.8804
 Site-SynthDigits                   | Val  Loss: 0.3770 | Val  Acc: 0.8741
 Site-MNIST_M                       | Val  Loss: 0.3815 | Val  Acc: 0.9348
 Site-MNIST_M                       | Val  Loss: 0.5929 | Val  Acc: 0.8129
 Site-SVHN                          | Val  Loss: 0.7838 | Val  Acc: 0.7283
 Site-SVHN                          | Val  Loss: 1.0221 | Val  Acc: 0.6403
Average Valid Accuracy: 0.8744
===2023-06-30 12:28:19===
===2023-06-30 12:28:23===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.9396
 Test site-USPS                      | Epoch:48 | Test Acc: 0.9430
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.8100
 Test site-MNIST_M                   | Epoch:48 | Test Acc: 0.6244
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.4880
MNIST: 0.9396, USPS: 0.9430, SynthDigits: 0.8100, MNIST_M: 0.6244, SVHN: 0.4880, 
Average Test Accuracy(group): 0.7610, Average Test Accuracy(individual): 0.7610,
domain std=0.1792, cluster std=-1.0000, individual std=0.1792, 
===2023-06-30 14:22:01===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 1.5920 | Train Acc: 0.7520
 Site-MNIST                         | Train Loss: 1.6425 | Train Acc: 0.6700
 Site-USPS                          | Train Loss: 1.5175 | Train Acc: 0.7817
 Site-USPS                          | Train Loss: 1.5011 | Train Acc: 0.7857
 Site-SynthDigits                   | Train Loss: 2.0261 | Train Acc: 0.4124
 Site-SynthDigits                   | Train Loss: 1.9735 | Train Acc: 0.4377
 Site-MNIST_M                       | Train Loss: 2.1914 | Train Acc: 0.2480
 Site-MNIST_M                       | Train Loss: 2.1854 | Train Acc: 0.2475
 Site-SVHN                          | Train Loss: 2.1821 | Train Acc: 0.2911
 Site-SVHN                          | Train Loss: 2.1719 | Train Acc: 0.2888
Average Train Accuracy: 0.4915
 Site-MNIST                         | Val  Loss: 1.6834 | Val  Acc: 0.6196
 Site-MNIST                         | Val  Loss: 1.6301 | Val  Acc: 0.6978
 Site-USPS                          | Val  Loss: 1.5796 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.5586 | Val  Acc: 0.7230
 Site-SynthDigits                   | Val  Loss: 1.9880 | Val  Acc: 0.3913
 Site-SynthDigits                   | Val  Loss: 2.0047 | Val  Acc: 0.4137
 Site-MNIST_M                       | Val  Loss: 2.2005 | Val  Acc: 0.2500
 Site-MNIST_M                       | Val  Loss: 2.1907 | Val  Acc: 0.2626
 Site-SVHN                          | Val  Loss: 2.1504 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1760 | Val  Acc: 0.3165
Average Valid Accuracy: 0.4675
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6196
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6978
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7230
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.3913
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.4137
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.2500
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.2626
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.3165
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.2028 | Train Acc: 0.7332
 Site-MNIST                         | Train Loss: 1.2927 | Train Acc: 0.6395
 Site-USPS                          | Train Loss: 1.1860 | Train Acc: 0.7358
 Site-USPS                          | Train Loss: 1.1822 | Train Acc: 0.7184
 Site-SynthDigits                   | Train Loss: 1.7456 | Train Acc: 0.4394
 Site-SynthDigits                   | Train Loss: 1.6582 | Train Acc: 0.5031
 Site-MNIST_M                       | Train Loss: 1.9889 | Train Acc: 0.3423
 Site-MNIST_M                       | Train Loss: 2.0082 | Train Acc: 0.3103
 Site-SVHN                          | Train Loss: 2.0748 | Train Acc: 0.3127
 Site-SVHN                          | Train Loss: 2.0128 | Train Acc: 0.3453
Average Train Accuracy: 0.5080
 Site-MNIST                         | Val  Loss: 1.3048 | Val  Acc: 0.6304
 Site-MNIST                         | Val  Loss: 1.3082 | Val  Acc: 0.6655
 Site-USPS                          | Val  Loss: 1.2831 | Val  Acc: 0.6848
 Site-USPS                          | Val  Loss: 1.2346 | Val  Acc: 0.7266
 Site-SynthDigits                   | Val  Loss: 1.6656 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.7071 | Val  Acc: 0.4820
 Site-MNIST_M                       | Val  Loss: 2.0294 | Val  Acc: 0.2609
 Site-MNIST_M                       | Val  Loss: 1.9884 | Val  Acc: 0.3381
 Site-SVHN                          | Val  Loss: 1.9695 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.0217 | Val  Acc: 0.3022
Average Valid Accuracy: 0.4840
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6304
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6655
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6848
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7266
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.4674
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.4820
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2609
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.3381
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.3022
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 0.9011 | Train Acc: 0.7817
 Site-MNIST                         | Train Loss: 1.0206 | Train Acc: 0.7022
 Site-USPS                          | Train Loss: 0.8062 | Train Acc: 0.8356
 Site-USPS                          | Train Loss: 0.7950 | Train Acc: 0.8269
 Site-SynthDigits                   | Train Loss: 1.5850 | Train Acc: 0.4933
 Site-SynthDigits                   | Train Loss: 1.4707 | Train Acc: 0.5471
 Site-MNIST_M                       | Train Loss: 1.8022 | Train Acc: 0.4313
 Site-MNIST_M                       | Train Loss: 1.8336 | Train Acc: 0.4018
 Site-SVHN                          | Train Loss: 1.9980 | Train Acc: 0.3100
 Site-SVHN                          | Train Loss: 1.9227 | Train Acc: 0.3623
Average Train Accuracy: 0.5692
 Site-MNIST                         | Val  Loss: 1.0355 | Val  Acc: 0.6522
 Site-MNIST                         | Val  Loss: 1.0243 | Val  Acc: 0.7230
 Site-USPS                          | Val  Loss: 0.8792 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.8516 | Val  Acc: 0.8022
 Site-SynthDigits                   | Val  Loss: 1.4767 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.5216 | Val  Acc: 0.5036
 Site-MNIST_M                       | Val  Loss: 1.8370 | Val  Acc: 0.4022
 Site-MNIST_M                       | Val  Loss: 1.7912 | Val  Acc: 0.4460
 Site-SVHN                          | Val  Loss: 1.8447 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 1.9188 | Val  Acc: 0.3525
Average Valid Accuracy: 0.5501
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6522
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7230
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8022
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.5109
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.5036
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4022
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4460
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.3525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 0.7476 | Train Acc: 0.8005
 Site-MNIST                         | Train Loss: 0.8697 | Train Acc: 0.7309
 Site-USPS                          | Train Loss: 0.7825 | Train Acc: 0.8032
 Site-USPS                          | Train Loss: 0.7821 | Train Acc: 0.7713
 Site-SynthDigits                   | Train Loss: 1.4595 | Train Acc: 0.5391
 Site-SynthDigits                   | Train Loss: 1.3582 | Train Acc: 0.5677
 Site-MNIST_M                       | Train Loss: 1.6839 | Train Acc: 0.4609
 Site-MNIST_M                       | Train Loss: 1.7040 | Train Acc: 0.4323
 Site-SVHN                          | Train Loss: 1.9326 | Train Acc: 0.3423
 Site-SVHN                          | Train Loss: 1.8457 | Train Acc: 0.3865
Average Train Accuracy: 0.5835
 Site-MNIST                         | Val  Loss: 0.8745 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 0.8830 | Val  Acc: 0.7410
 Site-USPS                          | Val  Loss: 0.8735 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.8608 | Val  Acc: 0.7230
 Site-SynthDigits                   | Val  Loss: 1.3054 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.3832 | Val  Acc: 0.5432
 Site-MNIST_M                       | Val  Loss: 1.6969 | Val  Acc: 0.4565
 Site-MNIST_M                       | Val  Loss: 1.6593 | Val  Acc: 0.5072
 Site-SVHN                          | Val  Loss: 1.8038 | Val  Acc: 0.3587
 Site-SVHN                          | Val  Loss: 1.8678 | Val  Acc: 0.3705
Average Valid Accuracy: 0.5678
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6630
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7410
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7230
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.5432
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.4565
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.5072
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.3587
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.3705
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 0.6149 | Train Acc: 0.8464
 Site-MNIST                         | Train Loss: 0.7078 | Train Acc: 0.7910
 Site-USPS                          | Train Loss: 0.5829 | Train Acc: 0.8652
 Site-USPS                          | Train Loss: 0.5732 | Train Acc: 0.8637
 Site-SynthDigits                   | Train Loss: 1.3653 | Train Acc: 0.5606
 Site-SynthDigits                   | Train Loss: 1.2405 | Train Acc: 0.6090
 Site-MNIST_M                       | Train Loss: 1.6217 | Train Acc: 0.4663
 Site-MNIST_M                       | Train Loss: 1.6417 | Train Acc: 0.4610
 Site-SVHN                          | Train Loss: 1.8593 | Train Acc: 0.3720
 Site-SVHN                          | Train Loss: 1.7481 | Train Acc: 0.4179
Average Train Accuracy: 0.6253
 Site-MNIST                         | Val  Loss: 0.7147 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 0.7259 | Val  Acc: 0.7986
 Site-USPS                          | Val  Loss: 0.7103 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.6395 | Val  Acc: 0.8489
 Site-SynthDigits                   | Val  Loss: 1.2262 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.2924 | Val  Acc: 0.5827
 Site-MNIST_M                       | Val  Loss: 1.6196 | Val  Acc: 0.4891
 Site-MNIST_M                       | Val  Loss: 1.5941 | Val  Acc: 0.5072
 Site-SVHN                          | Val  Loss: 1.6805 | Val  Acc: 0.4239
 Site-SVHN                          | Val  Loss: 1.7660 | Val  Acc: 0.4101
Average Valid Accuracy: 0.6202
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7609
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7986
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8489
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5827
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.4891
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.5072
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.4239
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.4101
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 0.5325 | Train Acc: 0.8464
 Site-MNIST                         | Train Loss: 0.6141 | Train Acc: 0.8305
 Site-USPS                          | Train Loss: 0.5422 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.5344 | Train Acc: 0.8502
 Site-SynthDigits                   | Train Loss: 1.2784 | Train Acc: 0.5903
 Site-SynthDigits                   | Train Loss: 1.1678 | Train Acc: 0.6484
 Site-MNIST_M                       | Train Loss: 1.5314 | Train Acc: 0.4879
 Site-MNIST_M                       | Train Loss: 1.5423 | Train Acc: 0.4996
 Site-SVHN                          | Train Loss: 1.8171 | Train Acc: 0.3908
 Site-SVHN                          | Train Loss: 1.7046 | Train Acc: 0.4296
Average Train Accuracy: 0.6444
 Site-MNIST                         | Val  Loss: 0.6172 | Val  Acc: 0.7717
 Site-MNIST                         | Val  Loss: 0.6297 | Val  Acc: 0.8165
 Site-USPS                          | Val  Loss: 0.6888 | Val  Acc: 0.7609
 Site-USPS                          | Val  Loss: 0.6080 | Val  Acc: 0.8201
 Site-SynthDigits                   | Val  Loss: 1.1389 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.2001 | Val  Acc: 0.6223
 Site-MNIST_M                       | Val  Loss: 1.5126 | Val  Acc: 0.4674
 Site-MNIST_M                       | Val  Loss: 1.5078 | Val  Acc: 0.5180
 Site-SVHN                          | Val  Loss: 1.6592 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.7452 | Val  Acc: 0.4281
Average Valid Accuracy: 0.6259
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7717
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8165
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7609
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8201
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.6196
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.6223
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.4674
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.5180
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.4348
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.4281
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.4607 | Train Acc: 0.8733
 Site-MNIST                         | Train Loss: 0.5278 | Train Acc: 0.8565
 Site-USPS                          | Train Loss: 0.4623 | Train Acc: 0.9003
 Site-USPS                          | Train Loss: 0.4681 | Train Acc: 0.8825
 Site-SynthDigits                   | Train Loss: 1.2282 | Train Acc: 0.6173
 Site-SynthDigits                   | Train Loss: 1.1202 | Train Acc: 0.6547
 Site-MNIST_M                       | Train Loss: 1.4688 | Train Acc: 0.5202
 Site-MNIST_M                       | Train Loss: 1.4707 | Train Acc: 0.5175
 Site-SVHN                          | Train Loss: 1.7988 | Train Acc: 0.4070
 Site-SVHN                          | Train Loss: 1.6886 | Train Acc: 0.4305
Average Train Accuracy: 0.6660
 Site-MNIST                         | Val  Loss: 0.5272 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.5267 | Val  Acc: 0.8597
 Site-USPS                          | Val  Loss: 0.6336 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.5304 | Val  Acc: 0.8417
 Site-SynthDigits                   | Val  Loss: 1.0816 | Val  Acc: 0.6304
 Site-SynthDigits                   | Val  Loss: 1.1645 | Val  Acc: 0.6259
 Site-MNIST_M                       | Val  Loss: 1.4543 | Val  Acc: 0.4891
 Site-MNIST_M                       | Val  Loss: 1.4358 | Val  Acc: 0.5612
 Site-SVHN                          | Val  Loss: 1.6546 | Val  Acc: 0.4457
===2023-06-30 14:34:07===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.1022 | Train Acc: 0.6388
 Site-MNIST                         | Train Loss: 2.1289 | Train Acc: 0.5085
 Site-USPS                          | Train Loss: 2.1017 | Train Acc: 0.5822
 Site-USPS                          | Train Loss: 2.0920 | Train Acc: 0.6188
 Site-SynthDigits                   | Train Loss: 2.2369 | Train Acc: 0.2453
 Site-SynthDigits                   | Train Loss: 2.2133 | Train Acc: 0.3031
 Site-MNIST_M                       | Train Loss: 2.2713 | Train Acc: 0.1563
 Site-MNIST_M                       | Train Loss: 2.2731 | Train Acc: 0.1462
 Site-SVHN                          | Train Loss: 2.2503 | Train Acc: 0.2399
 Site-SVHN                          | Train Loss: 2.2537 | Train Acc: 0.2305
Average Train Accuracy: 0.3670
 Site-MNIST                         | Val  Loss: 2.1434 | Val  Acc: 0.4783
 Site-MNIST                         | Val  Loss: 2.1252 | Val  Acc: 0.5576
 Site-USPS                          | Val  Loss: 2.1125 | Val  Acc: 0.5543
 Site-USPS                          | Val  Loss: 2.1093 | Val  Acc: 0.5827
 Site-SynthDigits                   | Val  Loss: 2.2202 | Val  Acc: 0.2826
 Site-SynthDigits                   | Val  Loss: 2.2357 | Val  Acc: 0.2482
 Site-MNIST_M                       | Val  Loss: 2.2761 | Val  Acc: 0.0870
 Site-MNIST_M                       | Val  Loss: 2.2720 | Val  Acc: 0.1295
 Site-SVHN                          | Val  Loss: 2.2488 | Val  Acc: 0.2717
 Site-SVHN                          | Val  Loss: 2.2507 | Val  Acc: 0.2518
Average Valid Accuracy: 0.3444
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4783
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5576
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5543
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5827
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2826
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2482
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.0870
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1295
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2717
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2518
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.9210 | Train Acc: 0.7089
 Site-MNIST                         | Train Loss: 1.9704 | Train Acc: 0.5785
 Site-USPS                          | Train Loss: 1.9210 | Train Acc: 0.6038
 Site-USPS                          | Train Loss: 1.9092 | Train Acc: 0.6413
 Site-SynthDigits                   | Train Loss: 2.1592 | Train Acc: 0.3288
 Site-SynthDigits                   | Train Loss: 2.1200 | Train Acc: 0.3928
 Site-MNIST_M                       | Train Loss: 2.2337 | Train Acc: 0.2399
 Site-MNIST_M                       | Train Loss: 2.2380 | Train Acc: 0.2161
 Site-SVHN                          | Train Loss: 2.2167 | Train Acc: 0.2857
 Site-SVHN                          | Train Loss: 2.2161 | Train Acc: 0.2601
Average Train Accuracy: 0.4256
 Site-MNIST                         | Val  Loss: 1.9897 | Val  Acc: 0.5109
 Site-MNIST                         | Val  Loss: 1.9684 | Val  Acc: 0.6151
 Site-USPS                          | Val  Loss: 1.9470 | Val  Acc: 0.5435
 Site-USPS                          | Val  Loss: 1.9409 | Val  Acc: 0.5755
 Site-SynthDigits                   | Val  Loss: 2.1269 | Val  Acc: 0.3804
 Site-SynthDigits                   | Val  Loss: 2.1506 | Val  Acc: 0.3165
 Site-MNIST_M                       | Val  Loss: 2.2434 | Val  Acc: 0.1630
 Site-MNIST_M                       | Val  Loss: 2.2378 | Val  Acc: 0.2122
 Site-SVHN                          | Val  Loss: 2.2043 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.2086 | Val  Acc: 0.2806
Average Valid Accuracy: 0.3880
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5109
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6151
 Best site-USPS                      | Epoch:1 | Val Acc: 0.5435
 Best site-USPS                      | Epoch:1 | Val Acc: 0.5755
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3804
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3165
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.1630
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2122
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2806
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.7557 | Train Acc: 0.7439
 Site-MNIST                         | Train Loss: 1.8205 | Train Acc: 0.6278
 Site-USPS                          | Train Loss: 1.7255 | Train Acc: 0.6388
 Site-USPS                          | Train Loss: 1.7136 | Train Acc: 0.7112
 Site-SynthDigits                   | Train Loss: 2.0918 | Train Acc: 0.3720
 Site-SynthDigits                   | Train Loss: 2.0375 | Train Acc: 0.4430
 Site-MNIST_M                       | Train Loss: 2.2034 | Train Acc: 0.2668
 Site-MNIST_M                       | Train Loss: 2.2034 | Train Acc: 0.2547
 Site-SVHN                          | Train Loss: 2.1932 | Train Acc: 0.2857
 Site-SVHN                          | Train Loss: 2.1860 | Train Acc: 0.2717
Average Train Accuracy: 0.4616
 Site-MNIST                         | Val  Loss: 1.8377 | Val  Acc: 0.5978
 Site-MNIST                         | Val  Loss: 1.8161 | Val  Acc: 0.6655
 Site-USPS                          | Val  Loss: 1.7591 | Val  Acc: 0.5978
 Site-USPS                          | Val  Loss: 1.7530 | Val  Acc: 0.6331
 Site-SynthDigits                   | Val  Loss: 2.0445 | Val  Acc: 0.3913
 Site-SynthDigits                   | Val  Loss: 2.0756 | Val  Acc: 0.3813
 Site-MNIST_M                       | Val  Loss: 2.2114 | Val  Acc: 0.1848
 Site-MNIST_M                       | Val  Loss: 2.2057 | Val  Acc: 0.2410
 Site-SVHN                          | Val  Loss: 2.1675 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1784 | Val  Acc: 0.2950
Average Valid Accuracy: 0.4292
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5978
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6655
 Best site-USPS                      | Epoch:2 | Val Acc: 0.5978
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6331
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3913
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3813
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.1848
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2410
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2950
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.5952 | Train Acc: 0.7385
 Site-MNIST                         | Train Loss: 1.6750 | Train Acc: 0.6556
 Site-USPS                          | Train Loss: 1.5905 | Train Acc: 0.6523
 Site-USPS                          | Train Loss: 1.5738 | Train Acc: 0.6969
 Site-SynthDigits                   | Train Loss: 2.0203 | Train Acc: 0.4340
 Site-SynthDigits                   | Train Loss: 1.9530 | Train Acc: 0.4879
 Site-MNIST_M                       | Train Loss: 2.1727 | Train Acc: 0.2749
 Site-MNIST_M                       | Train Loss: 2.1634 | Train Acc: 0.2834
 Site-SVHN                          | Train Loss: 2.1721 | Train Acc: 0.3073
 Site-SVHN                          | Train Loss: 2.1616 | Train Acc: 0.2807
Average Train Accuracy: 0.4811
 Site-MNIST                         | Val  Loss: 1.6856 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.6648 | Val  Acc: 0.6978
 Site-USPS                          | Val  Loss: 1.6400 | Val  Acc: 0.6087
 Site-USPS                          | Val  Loss: 1.6197 | Val  Acc: 0.6259
 Site-SynthDigits                   | Val  Loss: 1.9565 | Val  Acc: 0.4130
 Site-SynthDigits                   | Val  Loss: 1.9950 | Val  Acc: 0.4281
 Site-MNIST_M                       | Val  Loss: 2.1767 | Val  Acc: 0.2283
 Site-MNIST_M                       | Val  Loss: 2.1698 | Val  Acc: 0.2698
 Site-SVHN                          | Val  Loss: 2.1308 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1504 | Val  Acc: 0.3094
Average Valid Accuracy: 0.4559
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6739
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6978
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6087
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6259
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4130
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4281
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2283
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2698
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.3094
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.4701 | Train Acc: 0.7709
 Site-MNIST                         | Train Loss: 1.5513 | Train Acc: 0.6843
 Site-USPS                          | Train Loss: 1.4471 | Train Acc: 0.6819
 Site-USPS                          | Train Loss: 1.4256 | Train Acc: 0.7256
 Site-SynthDigits                   | Train Loss: 1.9553 | Train Acc: 0.4286
 Site-SynthDigits                   | Train Loss: 1.8728 | Train Acc: 0.5022
 Site-MNIST_M                       | Train Loss: 2.1420 | Train Acc: 0.2992
 Site-MNIST_M                       | Train Loss: 2.1333 | Train Acc: 0.3022
 Site-SVHN                          | Train Loss: 2.1456 | Train Acc: 0.3127
 Site-SVHN                          | Train Loss: 2.1289 | Train Acc: 0.2852
Average Train Accuracy: 0.4993
 Site-MNIST                         | Val  Loss: 1.5644 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 1.5429 | Val  Acc: 0.7266
 Site-USPS                          | Val  Loss: 1.4978 | Val  Acc: 0.6304
 Site-USPS                          | Val  Loss: 1.4778 | Val  Acc: 0.6511
 Site-SynthDigits                   | Val  Loss: 1.8836 | Val  Acc: 0.4783
 Site-SynthDigits                   | Val  Loss: 1.9271 | Val  Acc: 0.4532
 Site-MNIST_M                       | Val  Loss: 2.1444 | Val  Acc: 0.2609
 Site-MNIST_M                       | Val  Loss: 2.1341 | Val  Acc: 0.3022
 Site-SVHN                          | Val  Loss: 2.0980 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1227 | Val  Acc: 0.3237
Average Valid Accuracy: 0.4837
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7266
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6304
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6511
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4783
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4532
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.2609
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3022
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.3237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.3697 | Train Acc: 0.7736
 Site-MNIST                         | Train Loss: 1.4545 | Train Acc: 0.6861
 Site-USPS                          | Train Loss: 1.3231 | Train Acc: 0.7143
 Site-USPS                          | Train Loss: 1.3069 | Train Acc: 0.7345
 Site-SynthDigits                   | Train Loss: 1.8862 | Train Acc: 0.4447
 Site-SynthDigits                   | Train Loss: 1.8028 | Train Acc: 0.5139
 Site-MNIST_M                       | Train Loss: 2.1110 | Train Acc: 0.3100
 Site-MNIST_M                       | Train Loss: 2.0986 | Train Acc: 0.3112
 Site-SVHN                          | Train Loss: 2.1276 | Train Acc: 0.3073
 Site-SVHN                          | Train Loss: 2.1053 | Train Acc: 0.2915
Average Train Accuracy: 0.5087
 Site-MNIST                         | Val  Loss: 1.4629 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.4487 | Val  Acc: 0.7302
 Site-USPS                          | Val  Loss: 1.3823 | Val  Acc: 0.6848
 Site-USPS                          | Val  Loss: 1.3640 | Val  Acc: 0.6942
 Site-SynthDigits                   | Val  Loss: 1.8140 | Val  Acc: 0.4783
 Site-SynthDigits                   | Val  Loss: 1.8551 | Val  Acc: 0.4604
 Site-MNIST_M                       | Val  Loss: 2.1112 | Val  Acc: 0.2717
 Site-MNIST_M                       | Val  Loss: 2.1019 | Val  Acc: 0.3094
 Site-SVHN                          | Val  Loss: 2.0744 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0980 | Val  Acc: 0.3273
Average Valid Accuracy: 0.4967
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7302
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6848
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6942
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4783
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4604
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.2717
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3094
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 1.2617 | Train Acc: 0.8005
 Site-MNIST                         | Train Loss: 1.3539 | Train Acc: 0.7076
 Site-USPS                          | Train Loss: 1.2136 | Train Acc: 0.7278
 Site-USPS                          | Train Loss: 1.1950 | Train Acc: 0.7641
 Site-SynthDigits                   | Train Loss: 1.8285 | Train Acc: 0.4636
 Site-SynthDigits                   | Train Loss: 1.7413 | Train Acc: 0.5336
 Site-MNIST_M                       | Train Loss: 2.0793 | Train Acc: 0.3261
 Site-MNIST_M                       | Train Loss: 2.0629 | Train Acc: 0.3238
 Site-SVHN                          | Train Loss: 2.1081 | Train Acc: 0.3073
 Site-SVHN                          | Train Loss: 2.0790 | Train Acc: 0.2906
Average Train Accuracy: 0.5245
 Site-MNIST                         | Val  Loss: 1.3611 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.3426 | Val  Acc: 0.7518
 Site-USPS                          | Val  Loss: 1.2730 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 1.2550 | Val  Acc: 0.7302
 Site-SynthDigits                   | Val  Loss: 1.7492 | Val  Acc: 0.4783
 Site-SynthDigits                   | Val  Loss: 1.7940 | Val  Acc: 0.4748
 Site-MNIST_M                       | Val  Loss: 2.0794 | Val  Acc: 0.2609
 Site-MNIST_M                       | Val  Loss: 2.0679 | Val  Acc: 0.3237
 Site-SVHN                          | Val  Loss: 2.0484 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0753 | Val  Acc: 0.3237
Average Valid Accuracy: 0.5126
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7518
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7391
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7302
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4783
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4748
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.2609
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3237
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 1.1615 | Train Acc: 0.8113
 Site-MNIST                         | Train Loss: 1.2524 | Train Acc: 0.7614
 Site-USPS                          | Train Loss: 1.0891 | Train Acc: 0.7817
 Site-USPS                          | Train Loss: 1.0644 | Train Acc: 0.8081
 Site-SynthDigits                   | Train Loss: 1.7780 | Train Acc: 0.4879
 Site-SynthDigits                   | Train Loss: 1.6833 | Train Acc: 0.5471
 Site-MNIST_M                       | Train Loss: 2.0329 | Train Acc: 0.3693
 Site-MNIST_M                       | Train Loss: 2.0363 | Train Acc: 0.3363
 Site-SVHN                          | Train Loss: 2.0880 | Train Acc: 0.2938
 Site-SVHN                          | Train Loss: 2.0514 | Train Acc: 0.3058
Average Train Accuracy: 0.5503
 Site-MNIST                         | Val  Loss: 1.2722 | Val  Acc: 0.7717
 Site-MNIST                         | Val  Loss: 1.2473 | Val  Acc: 0.7878
 Site-USPS                          | Val  Loss: 1.1475 | Val  Acc: 0.7609
 Site-USPS                          | Val  Loss: 1.1278 | Val  Acc: 0.7734
 Site-SynthDigits                   | Val  Loss: 1.6890 | Val  Acc: 0.4891
 Site-SynthDigits                   | Val  Loss: 1.7377 | Val  Acc: 0.4964
 Site-MNIST_M                       | Val  Loss: 2.0522 | Val  Acc: 0.2826
 Site-MNIST_M                       | Val  Loss: 2.0278 | Val  Acc: 0.3309
 Site-SVHN                          | Val  Loss: 2.0208 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 2.0465 | Val  Acc: 0.3309
Average Valid Accuracy: 0.5361
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7717
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7878
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7609
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7734
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4891
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4964
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.2826
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3309
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3309
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 1.0917 | Train Acc: 0.8140
 Site-MNIST                         | Train Loss: 1.1749 | Train Acc: 0.7596
 Site-USPS                          | Train Loss: 1.0128 | Train Acc: 0.8140
 Site-USPS                          | Train Loss: 0.9879 | Train Acc: 0.8170
 Site-SynthDigits                   | Train Loss: 1.7130 | Train Acc: 0.4906
 Site-SynthDigits                   | Train Loss: 1.6174 | Train Acc: 0.5507
 Site-MNIST_M                       | Train Loss: 1.9780 | Train Acc: 0.3693
 Site-MNIST_M                       | Train Loss: 2.0027 | Train Acc: 0.3336
 Site-SVHN                          | Train Loss: 2.0506 | Train Acc: 0.3100
 Site-SVHN                          | Train Loss: 1.9962 | Train Acc: 0.3300
Average Train Accuracy: 0.5589
 Site-MNIST                         | Val  Loss: 1.1946 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.1757 | Val  Acc: 0.7842
 Site-USPS                          | Val  Loss: 1.0727 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 1.0477 | Val  Acc: 0.7806
 Site-SynthDigits                   | Val  Loss: 1.6325 | Val  Acc: 0.4783
 Site-SynthDigits                   | Val  Loss: 1.6691 | Val  Acc: 0.4928
 Site-MNIST_M                       | Val  Loss: 2.0204 | Val  Acc: 0.2500
 Site-MNIST_M                       | Val  Loss: 1.9823 | Val  Acc: 0.3345
 Site-SVHN                          | Val  Loss: 1.9578 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 1.9912 | Val  Acc: 0.3309
Average Valid Accuracy: 0.5310
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 1.0233 | Train Acc: 0.8167
 Site-MNIST                         | Train Loss: 1.1113 | Train Acc: 0.7641
 Site-USPS                          | Train Loss: 0.9448 | Train Acc: 0.8464
 Site-USPS                          | Train Loss: 0.9236 | Train Acc: 0.8305
 Site-SynthDigits                   | Train Loss: 1.6558 | Train Acc: 0.5121
 Site-SynthDigits                   | Train Loss: 1.5605 | Train Acc: 0.5570
 Site-MNIST_M                       | Train Loss: 1.9217 | Train Acc: 0.3854
 Site-MNIST_M                       | Train Loss: 1.9630 | Train Acc: 0.3525
 Site-SVHN                          | Train Loss: 2.0163 | Train Acc: 0.3208
 Site-SVHN                          | Train Loss: 1.9633 | Train Acc: 0.3372
Average Train Accuracy: 0.5723
 Site-MNIST                         | Val  Loss: 1.1201 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.1092 | Val  Acc: 0.7842
 Site-USPS                          | Val  Loss: 1.0206 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.9835 | Val  Acc: 0.8022
 Site-SynthDigits                   | Val  Loss: 1.5723 | Val  Acc: 0.4891
 Site-SynthDigits                   | Val  Loss: 1.6119 | Val  Acc: 0.5144
 Site-MNIST_M                       | Val  Loss: 1.9898 | Val  Acc: 0.2935
 Site-MNIST_M                       | Val  Loss: 1.9359 | Val  Acc: 0.3777
 Site-SVHN                          | Val  Loss: 1.9083 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 1.9536 | Val  Acc: 0.3489
Average Valid Accuracy: 0.5458
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7842
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8022
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4891
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.5144
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.2935
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.3777
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3489
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.9567 | Train Acc: 0.8167
 Site-MNIST                         | Train Loss: 1.0533 | Train Acc: 0.7731
 Site-USPS                          | Train Loss: 0.8928 | Train Acc: 0.8410
 Site-USPS                          | Train Loss: 0.8796 | Train Acc: 0.8323
 Site-SynthDigits                   | Train Loss: 1.6113 | Train Acc: 0.5202
 Site-SynthDigits                   | Train Loss: 1.5125 | Train Acc: 0.5695
 Site-MNIST_M                       | Train Loss: 1.8834 | Train Acc: 0.4124
 Site-MNIST_M                       | Train Loss: 1.9236 | Train Acc: 0.3650
 Site-SVHN                          | Train Loss: 1.9953 | Train Acc: 0.3235
 Site-SVHN                          | Train Loss: 1.9362 | Train Acc: 0.3534
Average Train Accuracy: 0.5807
 Site-MNIST                         | Val  Loss: 1.0519 | Val  Acc: 0.7717
 Site-MNIST                         | Val  Loss: 1.0445 | Val  Acc: 0.8022
 Site-USPS                          | Val  Loss: 0.9741 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.9319 | Val  Acc: 0.7878
 Site-SynthDigits                   | Val  Loss: 1.5268 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.5652 | Val  Acc: 0.5288
 Site-MNIST_M                       | Val  Loss: 1.9556 | Val  Acc: 0.3152
 Site-MNIST_M                       | Val  Loss: 1.8938 | Val  Acc: 0.3885
 Site-SVHN                          | Val  Loss: 1.8812 | Val  Acc: 0.3587
 Site-SVHN                          | Val  Loss: 1.9280 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5595
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7717
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8022
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7878
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5109
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5288
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.3152
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.3885
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3587
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3597
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.9117 | Train Acc: 0.8140
 Site-MNIST                         | Train Loss: 0.9979 | Train Acc: 0.7839
 Site-USPS                          | Train Loss: 0.8345 | Train Acc: 0.8544
 Site-USPS                          | Train Loss: 0.8200 | Train Acc: 0.8502
 Site-SynthDigits                   | Train Loss: 1.5697 | Train Acc: 0.5391
 Site-SynthDigits                   | Train Loss: 1.4784 | Train Acc: 0.5839
 Site-MNIST_M                       | Train Loss: 1.8518 | Train Acc: 0.4420
 Site-MNIST_M                       | Train Loss: 1.8932 | Train Acc: 0.3740
 Site-SVHN                          | Train Loss: 1.9746 | Train Acc: 0.3288
 Site-SVHN                          | Train Loss: 1.9101 | Train Acc: 0.3525
Average Train Accuracy: 0.5923
 Site-MNIST                         | Val  Loss: 0.9881 | Val  Acc: 0.7717
 Site-MNIST                         | Val  Loss: 0.9888 | Val  Acc: 0.7986
 Site-USPS                          | Val  Loss: 0.9212 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.8728 | Val  Acc: 0.8201
 Site-SynthDigits                   | Val  Loss: 1.4758 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.5165 | Val  Acc: 0.5396
 Site-MNIST_M                       | Val  Loss: 1.9203 | Val  Acc: 0.3587
 Site-MNIST_M                       | Val  Loss: 1.8553 | Val  Acc: 0.4065
 Site-SVHN                          | Val  Loss: 1.8525 | Val  Acc: 0.3478
 Site-SVHN                          | Val  Loss: 1.9055 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5707
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7717
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7986
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8201
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5109
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5396
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.3587
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4065
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3478
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3597
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.8582 | Train Acc: 0.8194
 Site-MNIST                         | Train Loss: 0.9425 | Train Acc: 0.7883
 Site-USPS                          | Train Loss: 0.7998 | Train Acc: 0.8652
 Site-USPS                          | Train Loss: 0.7739 | Train Acc: 0.8493
 Site-SynthDigits                   | Train Loss: 1.5289 | Train Acc: 0.5499
 Site-SynthDigits                   | Train Loss: 1.4287 | Train Acc: 0.5955
 Site-MNIST_M                       | Train Loss: 1.8126 | Train Acc: 0.4313
 Site-MNIST_M                       | Train Loss: 1.8537 | Train Acc: 0.3937
 Site-SVHN                          | Train Loss: 1.9554 | Train Acc: 0.3288
 Site-SVHN                          | Train Loss: 1.8885 | Train Acc: 0.3641
Average Train Accuracy: 0.5986
 Site-MNIST                         | Val  Loss: 0.9401 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 0.9426 | Val  Acc: 0.7986
 Site-USPS                          | Val  Loss: 0.8881 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.8310 | Val  Acc: 0.8201
 Site-SynthDigits                   | Val  Loss: 1.4313 | Val  Acc: 0.5326
 Site-SynthDigits                   | Val  Loss: 1.4742 | Val  Acc: 0.5576
 Site-MNIST_M                       | Val  Loss: 1.8853 | Val  Acc: 0.3696
 Site-MNIST_M                       | Val  Loss: 1.8205 | Val  Acc: 0.4245
 Site-SVHN                          | Val  Loss: 1.8166 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 1.8808 | Val  Acc: 0.3705
Average Valid Accuracy: 0.5797
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7609
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7986
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8201
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.5326
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.5576
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.3696
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4245
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3705
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.8078 | Train Acc: 0.8329
 Site-MNIST                         | Train Loss: 0.8908 | Train Acc: 0.7964
 Site-USPS                          | Train Loss: 0.7639 | Train Acc: 0.8679
 Site-USPS                          | Train Loss: 0.7402 | Train Acc: 0.8511
 Site-SynthDigits                   | Train Loss: 1.4917 | Train Acc: 0.5391
 Site-SynthDigits                   | Train Loss: 1.4046 | Train Acc: 0.6036
 Site-MNIST_M                       | Train Loss: 1.7800 | Train Acc: 0.4313
 Site-MNIST_M                       | Train Loss: 1.8265 | Train Acc: 0.4072
 Site-SVHN                          | Train Loss: 1.9321 | Train Acc: 0.3369
 Site-SVHN                          | Train Loss: 1.8636 | Train Acc: 0.3695
Average Train Accuracy: 0.6036
 Site-MNIST                         | Val  Loss: 0.8895 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 0.8871 | Val  Acc: 0.8165
 Site-USPS                          | Val  Loss: 0.8540 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.7944 | Val  Acc: 0.8165
 Site-SynthDigits                   | Val  Loss: 1.3952 | Val  Acc: 0.5435
 Site-SynthDigits                   | Val  Loss: 1.4359 | Val  Acc: 0.5576
 Site-MNIST_M                       | Val  Loss: 1.8483 | Val  Acc: 0.3913
 Site-MNIST_M                       | Val  Loss: 1.7903 | Val  Acc: 0.4353
 Site-SVHN                          | Val  Loss: 1.7884 | Val  Acc: 0.3913
 Site-SVHN                          | Val  Loss: 1.8583 | Val  Acc: 0.3849
Average Valid Accuracy: 0.5902
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7826
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8165
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8165
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5435
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5576
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.3913
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4353
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3913
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.7742 | Train Acc: 0.8302
 Site-MNIST                         | Train Loss: 0.8646 | Train Acc: 0.8000
 Site-USPS                          | Train Loss: 0.7193 | Train Acc: 0.8679
 Site-USPS                          | Train Loss: 0.7017 | Train Acc: 0.8574
 Site-SynthDigits                   | Train Loss: 1.4588 | Train Acc: 0.5606
 Site-SynthDigits                   | Train Loss: 1.3587 | Train Acc: 0.6143
 Site-MNIST_M                       | Train Loss: 1.7530 | Train Acc: 0.4340
 Site-MNIST_M                       | Train Loss: 1.8035 | Train Acc: 0.4036
 Site-SVHN                          | Train Loss: 1.9069 | Train Acc: 0.3396
 Site-SVHN                          | Train Loss: 1.8381 | Train Acc: 0.3776
Average Train Accuracy: 0.6085
 Site-MNIST                         | Val  Loss: 0.8560 | Val  Acc: 0.7935
 Site-MNIST                         | Val  Loss: 0.8539 | Val  Acc: 0.8165
 Site-USPS                          | Val  Loss: 0.8249 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.7522 | Val  Acc: 0.8201
 Site-SynthDigits                   | Val  Loss: 1.3596 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.3919 | Val  Acc: 0.5827
 Site-MNIST_M                       | Val  Loss: 1.8248 | Val  Acc: 0.3696
 Site-MNIST_M                       | Val  Loss: 1.7593 | Val  Acc: 0.4460
 Site-SVHN                          | Val  Loss: 1.7590 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 1.8366 | Val  Acc: 0.3705
Average Valid Accuracy: 0.5927
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7935
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8165
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8201
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5761
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5827
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.3696
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4460
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3705
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.7359 | Train Acc: 0.8302
 Site-MNIST                         | Train Loss: 0.8133 | Train Acc: 0.8054
 Site-USPS                          | Train Loss: 0.6732 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.6482 | Train Acc: 0.8646
 Site-SynthDigits                   | Train Loss: 1.4281 | Train Acc: 0.5472
 Site-SynthDigits                   | Train Loss: 1.3312 | Train Acc: 0.6161
 Site-MNIST_M                       | Train Loss: 1.7183 | Train Acc: 0.4501
 Site-MNIST_M                       | Train Loss: 1.7684 | Train Acc: 0.4170
 Site-SVHN                          | Train Loss: 1.8917 | Train Acc: 0.3531
 Site-SVHN                          | Train Loss: 1.8305 | Train Acc: 0.3910
Average Train Accuracy: 0.6145
 Site-MNIST                         | Val  Loss: 0.8157 | Val  Acc: 0.7717
 Site-MNIST                         | Val  Loss: 0.8130 | Val  Acc: 0.8058
 Site-USPS                          | Val  Loss: 0.7815 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.7061 | Val  Acc: 0.8273
 Site-SynthDigits                   | Val  Loss: 1.3233 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.3665 | Val  Acc: 0.5647
 Site-MNIST_M                       | Val  Loss: 1.7818 | Val  Acc: 0.4130
 Site-MNIST_M                       | Val  Loss: 1.7172 | Val  Acc: 0.4532
 Site-SVHN                          | Val  Loss: 1.7341 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.8164 | Val  Acc: 0.3957
Average Valid Accuracy: 0.6025
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7717
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8058
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8273
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.5761
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.5647
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4130
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4532
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3957
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.6961 | Train Acc: 0.8491
 Site-MNIST                         | Train Loss: 0.7750 | Train Acc: 0.8152
 Site-USPS                          | Train Loss: 0.6562 | Train Acc: 0.8733
 Site-USPS                          | Train Loss: 0.6208 | Train Acc: 0.8673
 Site-SynthDigits                   | Train Loss: 1.4032 | Train Acc: 0.5606
 Site-SynthDigits                   | Train Loss: 1.3035 | Train Acc: 0.6269
 Site-MNIST_M                       | Train Loss: 1.7013 | Train Acc: 0.4663
 Site-MNIST_M                       | Train Loss: 1.7508 | Train Acc: 0.4287
 Site-SVHN                          | Train Loss: 1.8899 | Train Acc: 0.3504
 Site-SVHN                          | Train Loss: 1.8090 | Train Acc: 0.3937
Average Train Accuracy: 0.6232
 Site-MNIST                         | Val  Loss: 0.7764 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 0.7746 | Val  Acc: 0.8273
 Site-USPS                          | Val  Loss: 0.7609 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.6855 | Val  Acc: 0.8273
 Site-SynthDigits                   | Val  Loss: 1.3035 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.3393 | Val  Acc: 0.5719
 Site-MNIST_M                       | Val  Loss: 1.7606 | Val  Acc: 0.4239
 Site-MNIST_M                       | Val  Loss: 1.6998 | Val  Acc: 0.4748
 Site-SVHN                          | Val  Loss: 1.7122 | Val  Acc: 0.4239
 Site-SVHN                          | Val  Loss: 1.8053 | Val  Acc: 0.4065
Average Valid Accuracy: 0.6119
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7826
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8273
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8273
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.5761
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.5719
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.4239
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.4748
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.4239
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.4065
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.6780 | Train Acc: 0.8491
 Site-MNIST                         | Train Loss: 0.7448 | Train Acc: 0.8296
 Site-USPS                          | Train Loss: 0.6070 | Train Acc: 0.8787
 Site-USPS                          | Train Loss: 0.5841 | Train Acc: 0.8682
 Site-SynthDigits                   | Train Loss: 1.3949 | Train Acc: 0.5660
 Site-SynthDigits                   | Train Loss: 1.2903 | Train Acc: 0.6224
 Site-MNIST_M                       | Train Loss: 1.6636 | Train Acc: 0.4825
 Site-MNIST_M                       | Train Loss: 1.7153 | Train Acc: 0.4538
 Site-SVHN                          | Train Loss: 1.8751 | Train Acc: 0.3666
 Site-SVHN                          | Train Loss: 1.7963 | Train Acc: 0.4027
Average Train Accuracy: 0.6320
 Site-MNIST                         | Val  Loss: 0.7425 | Val  Acc: 0.8152
 Site-MNIST                         | Val  Loss: 0.7383 | Val  Acc: 0.8381
 Site-USPS                          | Val  Loss: 0.7228 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.6400 | Val  Acc: 0.8345
 Site-SynthDigits                   | Val  Loss: 1.2977 | Val  Acc: 0.5543
 Site-SynthDigits                   | Val  Loss: 1.3373 | Val  Acc: 0.5683
 Site-MNIST_M                       | Val  Loss: 1.7140 | Val  Acc: 0.4239
 Site-MNIST_M                       | Val  Loss: 1.6617 | Val  Acc: 0.4892
 Site-SVHN                          | Val  Loss: 1.6899 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.7870 | Val  Acc: 0.4101
Average Valid Accuracy: 0.6162
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8152
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8381
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8345
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5543
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5683
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.4239
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.4892
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.4101
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.6539 | Train Acc: 0.8491
 Site-MNIST                         | Train Loss: 0.7248 | Train Acc: 0.8233
 Site-USPS                          | Train Loss: 0.5919 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.5687 | Train Acc: 0.8664
 Site-SynthDigits                   | Train Loss: 1.3636 | Train Acc: 0.5795
 Site-SynthDigits                   | Train Loss: 1.2645 | Train Acc: 0.6260
 Site-MNIST_M                       | Train Loss: 1.6380 | Train Acc: 0.4717
 Site-MNIST_M                       | Train Loss: 1.6814 | Train Acc: 0.4538
 Site-SVHN                          | Train Loss: 1.8553 | Train Acc: 0.3854
 Site-SVHN                          | Train Loss: 1.7662 | Train Acc: 0.3982
Average Train Accuracy: 0.6324
 Site-MNIST                         | Val  Loss: 0.7147 | Val  Acc: 0.8043
 Site-MNIST                         | Val  Loss: 0.7123 | Val  Acc: 0.8309
 Site-USPS                          | Val  Loss: 0.7047 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.6206 | Val  Acc: 0.8273
 Site-SynthDigits                   | Val  Loss: 1.2714 | Val  Acc: 0.5652
 Site-SynthDigits                   | Val  Loss: 1.3112 | Val  Acc: 0.5791
 Site-MNIST_M                       | Val  Loss: 1.6846 | Val  Acc: 0.4239
 Site-MNIST_M                       | Val  Loss: 1.6379 | Val  Acc: 0.4820
 Site-SVHN                          | Val  Loss: 1.6885 | Val  Acc: 0.3913
 Site-SVHN                          | Val  Loss: 1.7775 | Val  Acc: 0.3993
Average Valid Accuracy: 0.6119
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.6182 | Train Acc: 0.8571
 Site-MNIST                         | Train Loss: 0.6997 | Train Acc: 0.8269
 Site-USPS                          | Train Loss: 0.5618 | Train Acc: 0.8841
 Site-USPS                          | Train Loss: 0.5389 | Train Acc: 0.8771
 Site-SynthDigits                   | Train Loss: 1.3428 | Train Acc: 0.5768
 Site-SynthDigits                   | Train Loss: 1.2369 | Train Acc: 0.6484
 Site-MNIST_M                       | Train Loss: 1.6265 | Train Acc: 0.4744
 Site-MNIST_M                       | Train Loss: 1.6772 | Train Acc: 0.4583
 Site-SVHN                          | Train Loss: 1.8453 | Train Acc: 0.3881
 Site-SVHN                          | Train Loss: 1.7570 | Train Acc: 0.4000
Average Train Accuracy: 0.6391
 Site-MNIST                         | Val  Loss: 0.6876 | Val  Acc: 0.7935
 Site-MNIST                         | Val  Loss: 0.6827 | Val  Acc: 0.8417
 Site-USPS                          | Val  Loss: 0.6897 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.5969 | Val  Acc: 0.8309
 Site-SynthDigits                   | Val  Loss: 1.2456 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.2858 | Val  Acc: 0.5827
 Site-MNIST_M                       | Val  Loss: 1.6751 | Val  Acc: 0.4239
 Site-MNIST_M                       | Val  Loss: 1.6247 | Val  Acc: 0.4784
 Site-SVHN                          | Val  Loss: 1.6699 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.7635 | Val  Acc: 0.4173
Average Valid Accuracy: 0.6162
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.6023 | Train Acc: 0.8544
 Site-MNIST                         | Train Loss: 0.6493 | Train Acc: 0.8395
 Site-USPS                          | Train Loss: 0.5534 | Train Acc: 0.8814
 Site-USPS                          | Train Loss: 0.5250 | Train Acc: 0.8798
 Site-SynthDigits                   | Train Loss: 1.3362 | Train Acc: 0.5714
 Site-SynthDigits                   | Train Loss: 1.2144 | Train Acc: 0.6439
 Site-MNIST_M                       | Train Loss: 1.5982 | Train Acc: 0.4852
 Site-MNIST_M                       | Train Loss: 1.6454 | Train Acc: 0.4682
 Site-SVHN                          | Train Loss: 1.8423 | Train Acc: 0.3854
 Site-SVHN                          | Train Loss: 1.7529 | Train Acc: 0.4027
Average Train Accuracy: 0.6412
 Site-MNIST                         | Val  Loss: 0.6570 | Val  Acc: 0.8152
 Site-MNIST                         | Val  Loss: 0.6516 | Val  Acc: 0.8453
 Site-USPS                          | Val  Loss: 0.6751 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.5854 | Val  Acc: 0.8309
 Site-SynthDigits                   | Val  Loss: 1.2299 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.2694 | Val  Acc: 0.6007
 Site-MNIST_M                       | Val  Loss: 1.6419 | Val  Acc: 0.4239
 Site-MNIST_M                       | Val  Loss: 1.5968 | Val  Acc: 0.4856
 Site-SVHN                          | Val  Loss: 1.6667 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.7565 | Val  Acc: 0.4173
Average Valid Accuracy: 0.6223
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8152
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8453
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8309
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.6007
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.4239
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.4856
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.4173
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.5791 | Train Acc: 0.8571
 Site-MNIST                         | Train Loss: 0.6419 | Train Acc: 0.8332
 Site-USPS                          | Train Loss: 0.5277 | Train Acc: 0.8922
 Site-USPS                          | Train Loss: 0.5036 | Train Acc: 0.8852
 Site-SynthDigits                   | Train Loss: 1.3177 | Train Acc: 0.5822
 Site-SynthDigits                   | Train Loss: 1.1930 | Train Acc: 0.6484
 Site-MNIST_M                       | Train Loss: 1.5849 | Train Acc: 0.4879
 Site-MNIST_M                       | Train Loss: 1.6313 | Train Acc: 0.4744
 Site-SVHN                          | Train Loss: 1.8274 | Train Acc: 0.3962
 Site-SVHN                          | Train Loss: 1.7319 | Train Acc: 0.4126
Average Train Accuracy: 0.6469
 Site-MNIST                         | Val  Loss: 0.6437 | Val  Acc: 0.8152
 Site-MNIST                         | Val  Loss: 0.6393 | Val  Acc: 0.8489
 Site-USPS                          | Val  Loss: 0.6538 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.5613 | Val  Acc: 0.8381
 Site-SynthDigits                   | Val  Loss: 1.2144 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.2494 | Val  Acc: 0.5971
 Site-MNIST_M                       | Val  Loss: 1.6286 | Val  Acc: 0.4348
 Site-MNIST_M                       | Val  Loss: 1.5886 | Val  Acc: 0.4892
 Site-SVHN                          | Val  Loss: 1.6476 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.7423 | Val  Acc: 0.4281
Average Valid Accuracy: 0.6256
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8152
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8489
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8381
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.5971
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.4348
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.4892
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.4281
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.5548 | Train Acc: 0.8652
 Site-MNIST                         | Train Loss: 0.6210 | Train Acc: 0.8511
 Site-USPS                          | Train Loss: 0.5272 | Train Acc: 0.8868
 Site-USPS                          | Train Loss: 0.4951 | Train Acc: 0.8861
 Site-SynthDigits                   | Train Loss: 1.2814 | Train Acc: 0.5876
 Site-SynthDigits                   | Train Loss: 1.1723 | Train Acc: 0.6592
 Site-MNIST_M                       | Train Loss: 1.5815 | Train Acc: 0.4906
 Site-MNIST_M                       | Train Loss: 1.6193 | Train Acc: 0.4771
 Site-SVHN                          | Train Loss: 1.8191 | Train Acc: 0.3962
 Site-SVHN                          | Train Loss: 1.7162 | Train Acc: 0.4108
Average Train Accuracy: 0.6511
 Site-MNIST                         | Val  Loss: 0.6114 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.6038 | Val  Acc: 0.8705
 Site-USPS                          | Val  Loss: 0.6531 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.5588 | Val  Acc: 0.8453
 Site-SynthDigits                   | Val  Loss: 1.1947 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.2212 | Val  Acc: 0.6079
 Site-MNIST_M                       | Val  Loss: 1.6142 | Val  Acc: 0.5109
 Site-MNIST_M                       | Val  Loss: 1.5721 | Val  Acc: 0.5180
 Site-SVHN                          | Val  Loss: 1.6473 | Val  Acc: 0.4239
 Site-SVHN                          | Val  Loss: 1.7404 | Val  Acc: 0.4245
Average Valid Accuracy: 0.6440
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8478
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8705
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8453
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.6079
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5109
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5180
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.4239
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.4245
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.5323 | Train Acc: 0.8679
 Site-MNIST                         | Train Loss: 0.5864 | Train Acc: 0.8538
 Site-USPS                          | Train Loss: 0.4913 | Train Acc: 0.9003
 Site-USPS                          | Train Loss: 0.4623 | Train Acc: 0.8942
 Site-SynthDigits                   | Train Loss: 1.2875 | Train Acc: 0.5957
 Site-SynthDigits                   | Train Loss: 1.1704 | Train Acc: 0.6619
 Site-MNIST_M                       | Train Loss: 1.5470 | Train Acc: 0.5040
 Site-MNIST_M                       | Train Loss: 1.5765 | Train Acc: 0.5013
 Site-SVHN                          | Train Loss: 1.8246 | Train Acc: 0.3881
 Site-SVHN                          | Train Loss: 1.7218 | Train Acc: 0.4108
Average Train Accuracy: 0.6578
 Site-MNIST                         | Val  Loss: 0.5828 | Val  Acc: 0.8370
 Site-MNIST                         | Val  Loss: 0.5813 | Val  Acc: 0.8561
 Site-USPS                          | Val  Loss: 0.6190 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.5268 | Val  Acc: 0.8489
 Site-SynthDigits                   | Val  Loss: 1.1903 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.2217 | Val  Acc: 0.6187
 Site-MNIST_M                       | Val  Loss: 1.5769 | Val  Acc: 0.4891
 Site-MNIST_M                       | Val  Loss: 1.5412 | Val  Acc: 0.5216
 Site-SVHN                          | Val  Loss: 1.6416 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.7416 | Val  Acc: 0.4101
Average Valid Accuracy: 0.6397
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.5261 | Train Acc: 0.8652
 Site-MNIST                         | Train Loss: 0.5733 | Train Acc: 0.8565
 Site-USPS                          | Train Loss: 0.4950 | Train Acc: 0.8976
 Site-USPS                          | Train Loss: 0.4672 | Train Acc: 0.8888
 Site-SynthDigits                   | Train Loss: 1.2600 | Train Acc: 0.6038
 Site-SynthDigits                   | Train Loss: 1.1446 | Train Acc: 0.6682
 Site-MNIST_M                       | Train Loss: 1.5308 | Train Acc: 0.5067
 Site-MNIST_M                       | Train Loss: 1.5745 | Train Acc: 0.4897
 Site-SVHN                          | Train Loss: 1.7979 | Train Acc: 0.4043
 Site-SVHN                          | Train Loss: 1.6953 | Train Acc: 0.4188
Average Train Accuracy: 0.6600
 Site-MNIST                         | Val  Loss: 0.5727 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.5735 | Val  Acc: 0.8741
 Site-USPS                          | Val  Loss: 0.6256 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.5260 | Val  Acc: 0.8561
 Site-SynthDigits                   | Val  Loss: 1.1642 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.1882 | Val  Acc: 0.6367
 Site-MNIST_M                       | Val  Loss: 1.5633 | Val  Acc: 0.4891
 Site-MNIST_M                       | Val  Loss: 1.5262 | Val  Acc: 0.5324
 Site-SVHN                          | Val  Loss: 1.6593 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.7381 | Val  Acc: 0.4137
Average Valid Accuracy: 0.6552
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8587
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8741
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8561
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.6196
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.6367
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.4891
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.5324
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.4457
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.4137
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.5267 | Train Acc: 0.8598
 Site-MNIST                         | Train Loss: 0.5653 | Train Acc: 0.8601
 Site-USPS                          | Train Loss: 0.4755 | Train Acc: 0.8868
 Site-USPS                          | Train Loss: 0.4513 | Train Acc: 0.8879
 Site-SynthDigits                   | Train Loss: 1.2547 | Train Acc: 0.6038
 Site-SynthDigits                   | Train Loss: 1.1376 | Train Acc: 0.6655
 Site-MNIST_M                       | Train Loss: 1.5081 | Train Acc: 0.5148
 Site-MNIST_M                       | Train Loss: 1.5636 | Train Acc: 0.5058
 Site-SVHN                          | Train Loss: 1.8008 | Train Acc: 0.4043
 Site-SVHN                          | Train Loss: 1.6809 | Train Acc: 0.4260
Average Train Accuracy: 0.6615
 Site-MNIST                         | Val  Loss: 0.5511 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.5559 | Val  Acc: 0.8705
 Site-USPS                          | Val  Loss: 0.6046 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.5012 | Val  Acc: 0.8525
 Site-SynthDigits                   | Val  Loss: 1.1737 | Val  Acc: 0.6087
 Site-SynthDigits                   | Val  Loss: 1.1866 | Val  Acc: 0.6223
 Site-MNIST_M                       | Val  Loss: 1.5537 | Val  Acc: 0.5217
 Site-MNIST_M                       | Val  Loss: 1.5109 | Val  Acc: 0.5468
 Site-SVHN                          | Val  Loss: 1.6221 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.7176 | Val  Acc: 0.4209
Average Valid Accuracy: 0.6552
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8587
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8705
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8525
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.6087
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.6223
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.5217
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.5468
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.4348
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.4209
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.4979 | Train Acc: 0.8733
 Site-MNIST                         | Train Loss: 0.5501 | Train Acc: 0.8691
 Site-USPS                          | Train Loss: 0.4591 | Train Acc: 0.9003
 Site-USPS                          | Train Loss: 0.4407 | Train Acc: 0.8960
 Site-SynthDigits                   | Train Loss: 1.2304 | Train Acc: 0.6038
 Site-SynthDigits                   | Train Loss: 1.1163 | Train Acc: 0.6717
 Site-MNIST_M                       | Train Loss: 1.5056 | Train Acc: 0.5121
 Site-MNIST_M                       | Train Loss: 1.5381 | Train Acc: 0.5049
 Site-SVHN                          | Train Loss: 1.7883 | Train Acc: 0.4097
 Site-SVHN                          | Train Loss: 1.6694 | Train Acc: 0.4242
Average Train Accuracy: 0.6665
 Site-MNIST                         | Val  Loss: 0.5343 | Val  Acc: 0.8696
 Site-MNIST                         | Val  Loss: 0.5352 | Val  Acc: 0.8777
 Site-USPS                          | Val  Loss: 0.5908 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.4900 | Val  Acc: 0.8525
 Site-SynthDigits                   | Val  Loss: 1.1437 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.1670 | Val  Acc: 0.6331
 Site-MNIST_M                       | Val  Loss: 1.5269 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.4942 | Val  Acc: 0.5396
 Site-SVHN                          | Val  Loss: 1.6247 | Val  Acc: 0.4239
 Site-SVHN                          | Val  Loss: 1.7175 | Val  Acc: 0.4245
Average Valid Accuracy: 0.6566
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8696
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8777
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8525
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.6196
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.6331
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5396
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.4239
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.4245
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.4912 | Train Acc: 0.8679
 Site-MNIST                         | Train Loss: 0.5357 | Train Acc: 0.8673
 Site-USPS                          | Train Loss: 0.4538 | Train Acc: 0.8976
 Site-USPS                          | Train Loss: 0.4327 | Train Acc: 0.8978
 Site-SynthDigits                   | Train Loss: 1.2041 | Train Acc: 0.6146
 Site-SynthDigits                   | Train Loss: 1.0881 | Train Acc: 0.6807
 Site-MNIST_M                       | Train Loss: 1.5062 | Train Acc: 0.5121
 Site-MNIST_M                       | Train Loss: 1.5384 | Train Acc: 0.5076
 Site-SVHN                          | Train Loss: 1.7723 | Train Acc: 0.4043
 Site-SVHN                          | Train Loss: 1.6614 | Train Acc: 0.4350
Average Train Accuracy: 0.6685
 Site-MNIST                         | Val  Loss: 0.5219 | Val  Acc: 0.8696
 Site-MNIST                         | Val  Loss: 0.5247 | Val  Acc: 0.8777
 Site-USPS                          | Val  Loss: 0.5967 | Val  Acc: 0.8370
 Site-USPS                          | Val  Loss: 0.4847 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 1.1360 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.1394 | Val  Acc: 0.6403
 Site-MNIST_M                       | Val  Loss: 1.5185 | Val  Acc: 0.5326
 Site-MNIST_M                       | Val  Loss: 1.4913 | Val  Acc: 0.5576
 Site-SVHN                          | Val  Loss: 1.6112 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.6978 | Val  Acc: 0.4173
Average Valid Accuracy: 0.6653
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8696
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8777
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8370
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8669
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.6196
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.6403
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.5326
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.5576
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.4348
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.4173
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.4815 | Train Acc: 0.8706
 Site-MNIST                         | Train Loss: 0.5166 | Train Acc: 0.8646
 Site-USPS                          | Train Loss: 0.4251 | Train Acc: 0.9057
 Site-USPS                          | Train Loss: 0.4004 | Train Acc: 0.8969
 Site-SynthDigits                   | Train Loss: 1.1975 | Train Acc: 0.6011
 Site-SynthDigits                   | Train Loss: 1.0872 | Train Acc: 0.6852
 Site-MNIST_M                       | Train Loss: 1.4805 | Train Acc: 0.5148
 Site-MNIST_M                       | Train Loss: 1.4989 | Train Acc: 0.5202
 Site-SVHN                          | Train Loss: 1.7697 | Train Acc: 0.3989
 Site-SVHN                          | Train Loss: 1.6647 | Train Acc: 0.4359
Average Train Accuracy: 0.6694
 Site-MNIST                         | Val  Loss: 0.5086 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.5103 | Val  Acc: 0.8705
 Site-USPS                          | Val  Loss: 0.5735 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.4649 | Val  Acc: 0.8525
 Site-SynthDigits                   | Val  Loss: 1.1233 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.1439 | Val  Acc: 0.6403
 Site-MNIST_M                       | Val  Loss: 1.4871 | Val  Acc: 0.5217
 Site-MNIST_M                       | Val  Loss: 1.4686 | Val  Acc: 0.5468
 Site-SVHN                          | Val  Loss: 1.5898 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.6971 | Val  Acc: 0.4388
Average Valid Accuracy: 0.6621
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.4717 | Train Acc: 0.8733
 Site-MNIST                         | Train Loss: 0.5186 | Train Acc: 0.8691
 Site-USPS                          | Train Loss: 0.4354 | Train Acc: 0.9084
 Site-USPS                          | Train Loss: 0.4114 | Train Acc: 0.8951
 Site-SynthDigits                   | Train Loss: 1.1935 | Train Acc: 0.6011
 Site-SynthDigits                   | Train Loss: 1.0825 | Train Acc: 0.6753
 Site-MNIST_M                       | Train Loss: 1.4675 | Train Acc: 0.5202
 Site-MNIST_M                       | Train Loss: 1.4904 | Train Acc: 0.5345
 Site-SVHN                          | Train Loss: 1.7687 | Train Acc: 0.4016
 Site-SVHN                          | Train Loss: 1.6501 | Train Acc: 0.4404
Average Train Accuracy: 0.6719
 Site-MNIST                         | Val  Loss: 0.5073 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.5022 | Val  Acc: 0.8777
 Site-USPS                          | Val  Loss: 0.5797 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.4669 | Val  Acc: 0.8561
 Site-SynthDigits                   | Val  Loss: 1.1143 | Val  Acc: 0.6087
 Site-SynthDigits                   | Val  Loss: 1.1287 | Val  Acc: 0.6223
 Site-MNIST_M                       | Val  Loss: 1.4723 | Val  Acc: 0.5326
 Site-MNIST_M                       | Val  Loss: 1.4560 | Val  Acc: 0.5612
 Site-SVHN                          | Val  Loss: 1.5828 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.6905 | Val  Acc: 0.4317
Average Valid Accuracy: 0.6588
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.4638 | Train Acc: 0.8706
 Site-MNIST                         | Train Loss: 0.4985 | Train Acc: 0.8771
 Site-USPS                          | Train Loss: 0.4388 | Train Acc: 0.8922
 Site-USPS                          | Train Loss: 0.4125 | Train Acc: 0.8996
 Site-SynthDigits                   | Train Loss: 1.1752 | Train Acc: 0.6065
 Site-SynthDigits                   | Train Loss: 1.0545 | Train Acc: 0.6879
 Site-MNIST_M                       | Train Loss: 1.4667 | Train Acc: 0.5121
 Site-MNIST_M                       | Train Loss: 1.4887 | Train Acc: 0.5247
 Site-SVHN                          | Train Loss: 1.7434 | Train Acc: 0.4178
 Site-SVHN                          | Train Loss: 1.6275 | Train Acc: 0.4502
Average Train Accuracy: 0.6739
 Site-MNIST                         | Val  Loss: 0.4839 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.4894 | Val  Acc: 0.8705
 Site-USPS                          | Val  Loss: 0.5834 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.4677 | Val  Acc: 0.8597
 Site-SynthDigits                   | Val  Loss: 1.0999 | Val  Acc: 0.6087
 Site-SynthDigits                   | Val  Loss: 1.1047 | Val  Acc: 0.6367
 Site-MNIST_M                       | Val  Loss: 1.4709 | Val  Acc: 0.5326
 Site-MNIST_M                       | Val  Loss: 1.4466 | Val  Acc: 0.5612
 Site-SVHN                          | Val  Loss: 1.5747 | Val  Acc: 0.4565
 Site-SVHN                          | Val  Loss: 1.6696 | Val  Acc: 0.4353
Average Valid Accuracy: 0.6646
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.4599 | Train Acc: 0.8706
 Site-MNIST                         | Train Loss: 0.4861 | Train Acc: 0.8771
 Site-USPS                          | Train Loss: 0.4142 | Train Acc: 0.9084
 Site-USPS                          | Train Loss: 0.3816 | Train Acc: 0.9031
 Site-SynthDigits                   | Train Loss: 1.1685 | Train Acc: 0.6146
 Site-SynthDigits                   | Train Loss: 1.0472 | Train Acc: 0.6915
 Site-MNIST_M                       | Train Loss: 1.4601 | Train Acc: 0.5202
 Site-MNIST_M                       | Train Loss: 1.4578 | Train Acc: 0.5345
 Site-SVHN                          | Train Loss: 1.7357 | Train Acc: 0.4097
 Site-SVHN                          | Train Loss: 1.6193 | Train Acc: 0.4574
Average Train Accuracy: 0.6787
 Site-MNIST                         | Val  Loss: 0.4779 | Val  Acc: 0.8696
 Site-MNIST                         | Val  Loss: 0.4810 | Val  Acc: 0.8813
 Site-USPS                          | Val  Loss: 0.5614 | Val  Acc: 0.8370
 Site-USPS                          | Val  Loss: 0.4450 | Val  Acc: 0.8633
 Site-SynthDigits                   | Val  Loss: 1.1032 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.1043 | Val  Acc: 0.6439
 Site-MNIST_M                       | Val  Loss: 1.4523 | Val  Acc: 0.5761
 Site-MNIST_M                       | Val  Loss: 1.4341 | Val  Acc: 0.5719
 Site-SVHN                          | Val  Loss: 1.5645 | Val  Acc: 0.4565
 Site-SVHN                          | Val  Loss: 1.6642 | Val  Acc: 0.4388
Average Valid Accuracy: 0.6758
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8696
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8813
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8370
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8633
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.6196
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.6439
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.5761
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.5719
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.4565
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.4388
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.4323 | Train Acc: 0.8679
 Site-MNIST                         | Train Loss: 0.4744 | Train Acc: 0.8771
 Site-USPS                          | Train Loss: 0.4199 | Train Acc: 0.9111
 Site-USPS                          | Train Loss: 0.3889 | Train Acc: 0.9022
 Site-SynthDigits                   | Train Loss: 1.1598 | Train Acc: 0.5984
 Site-SynthDigits                   | Train Loss: 1.0402 | Train Acc: 0.6924
 Site-MNIST_M                       | Train Loss: 1.4428 | Train Acc: 0.5310
 Site-MNIST_M                       | Train Loss: 1.4476 | Train Acc: 0.5444
 Site-SVHN                          | Train Loss: 1.7346 | Train Acc: 0.4205
 Site-SVHN                          | Train Loss: 1.6232 | Train Acc: 0.4430
Average Train Accuracy: 0.6788
 Site-MNIST                         | Val  Loss: 0.4650 | Val  Acc: 0.8696
 Site-MNIST                         | Val  Loss: 0.4687 | Val  Acc: 0.8777
 Site-USPS                          | Val  Loss: 0.5524 | Val  Acc: 0.8370
 Site-USPS                          | Val  Loss: 0.4470 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 1.0812 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.0909 | Val  Acc: 0.6367
 Site-MNIST_M                       | Val  Loss: 1.4315 | Val  Acc: 0.5326
 Site-MNIST_M                       | Val  Loss: 1.4224 | Val  Acc: 0.5719
 Site-SVHN                          | Val  Loss: 1.5691 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.6672 | Val  Acc: 0.4317
Average Valid Accuracy: 0.6678
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.4201 | Train Acc: 0.8841
 Site-MNIST                         | Train Loss: 0.4452 | Train Acc: 0.8879
 Site-USPS                          | Train Loss: 0.3965 | Train Acc: 0.9111
 Site-USPS                          | Train Loss: 0.3775 | Train Acc: 0.9058
 Site-SynthDigits                   | Train Loss: 1.1483 | Train Acc: 0.6199
 Site-SynthDigits                   | Train Loss: 1.0368 | Train Acc: 0.6933
 Site-MNIST_M                       | Train Loss: 1.4238 | Train Acc: 0.5310
 Site-MNIST_M                       | Train Loss: 1.4303 | Train Acc: 0.5480
 Site-SVHN                          | Train Loss: 1.7551 | Train Acc: 0.4097
 Site-SVHN                          | Train Loss: 1.6234 | Train Acc: 0.4457
Average Train Accuracy: 0.6837
 Site-MNIST                         | Val  Loss: 0.4474 | Val  Acc: 0.8804
 Site-MNIST                         | Val  Loss: 0.4495 | Val  Acc: 0.8849
 Site-USPS                          | Val  Loss: 0.5378 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.4280 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 1.0767 | Val  Acc: 0.6304
 Site-SynthDigits                   | Val  Loss: 1.0888 | Val  Acc: 0.6511
 Site-MNIST_M                       | Val  Loss: 1.4328 | Val  Acc: 0.5326
 Site-MNIST_M                       | Val  Loss: 1.4029 | Val  Acc: 0.5576
 Site-SVHN                          | Val  Loss: 1.5610 | Val  Acc: 0.4783
 Site-SVHN                          | Val  Loss: 1.6677 | Val  Acc: 0.4281
Average Valid Accuracy: 0.6725
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.4134 | Train Acc: 0.8760
 Site-MNIST                         | Train Loss: 0.4432 | Train Acc: 0.8879
 Site-USPS                          | Train Loss: 0.4075 | Train Acc: 0.9084
 Site-USPS                          | Train Loss: 0.3808 | Train Acc: 0.9013
 Site-SynthDigits                   | Train Loss: 1.1388 | Train Acc: 0.6226
 Site-SynthDigits                   | Train Loss: 1.0131 | Train Acc: 0.6897
 Site-MNIST_M                       | Train Loss: 1.4005 | Train Acc: 0.5391
 Site-MNIST_M                       | Train Loss: 1.4170 | Train Acc: 0.5498
 Site-SVHN                          | Train Loss: 1.7374 | Train Acc: 0.4151
 Site-SVHN                          | Train Loss: 1.6095 | Train Acc: 0.4448
Average Train Accuracy: 0.6835
 Site-MNIST                         | Val  Loss: 0.4361 | Val  Acc: 0.8804
 Site-MNIST                         | Val  Loss: 0.4428 | Val  Acc: 0.8813
 Site-USPS                          | Val  Loss: 0.5486 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.4373 | Val  Acc: 0.8597
 Site-SynthDigits                   | Val  Loss: 1.0654 | Val  Acc: 0.6304
 Site-SynthDigits                   | Val  Loss: 1.0735 | Val  Acc: 0.6475
 Site-MNIST_M                       | Val  Loss: 1.3997 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.3799 | Val  Acc: 0.5683
 Site-SVHN                          | Val  Loss: 1.5588 | Val  Acc: 0.4565
 Site-SVHN                          | Val  Loss: 1.6668 | Val  Acc: 0.4137
Average Valid Accuracy: 0.6697
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.4051 | Train Acc: 0.8841
 Site-MNIST                         | Train Loss: 0.4407 | Train Acc: 0.8924
 Site-USPS                          | Train Loss: 0.3934 | Train Acc: 0.9137
 Site-USPS                          | Train Loss: 0.3688 | Train Acc: 0.9049
 Site-SynthDigits                   | Train Loss: 1.1268 | Train Acc: 0.6253
 Site-SynthDigits                   | Train Loss: 1.0080 | Train Acc: 0.6924
 Site-MNIST_M                       | Train Loss: 1.4110 | Train Acc: 0.5472
 Site-MNIST_M                       | Train Loss: 1.4124 | Train Acc: 0.5552
 Site-SVHN                          | Train Loss: 1.7242 | Train Acc: 0.4259
 Site-SVHN                          | Train Loss: 1.6030 | Train Acc: 0.4511
Average Train Accuracy: 0.6892
 Site-MNIST                         | Val  Loss: 0.4225 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.4334 | Val  Acc: 0.8849
 Site-USPS                          | Val  Loss: 0.5369 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.4261 | Val  Acc: 0.8633
 Site-SynthDigits                   | Val  Loss: 1.0529 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.0571 | Val  Acc: 0.6403
 Site-MNIST_M                       | Val  Loss: 1.3797 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.3785 | Val  Acc: 0.5755
 Site-SVHN                          | Val  Loss: 1.5415 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.6426 | Val  Acc: 0.4353
Average Valid Accuracy: 0.6714
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.3983 | Train Acc: 0.8841
 Site-MNIST                         | Train Loss: 0.4230 | Train Acc: 0.8915
 Site-USPS                          | Train Loss: 0.3962 | Train Acc: 0.9084
 Site-USPS                          | Train Loss: 0.3634 | Train Acc: 0.9049
 Site-SynthDigits                   | Train Loss: 1.0988 | Train Acc: 0.6361
 Site-SynthDigits                   | Train Loss: 0.9884 | Train Acc: 0.6987
 Site-MNIST_M                       | Train Loss: 1.4009 | Train Acc: 0.5445
 Site-MNIST_M                       | Train Loss: 1.4027 | Train Acc: 0.5659
 Site-SVHN                          | Train Loss: 1.7148 | Train Acc: 0.4394
 Site-SVHN                          | Train Loss: 1.5790 | Train Acc: 0.4673
Average Train Accuracy: 0.6941
 Site-MNIST                         | Val  Loss: 0.4089 | Val  Acc: 0.8804
 Site-MNIST                         | Val  Loss: 0.4206 | Val  Acc: 0.8849
 Site-USPS                          | Val  Loss: 0.5406 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.4231 | Val  Acc: 0.8633
 Site-SynthDigits                   | Val  Loss: 1.0472 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.0448 | Val  Acc: 0.6439
 Site-MNIST_M                       | Val  Loss: 1.3739 | Val  Acc: 0.5543
 Site-MNIST_M                       | Val  Loss: 1.3710 | Val  Acc: 0.5719
 Site-SVHN                          | Val  Loss: 1.5226 | Val  Acc: 0.4674
 Site-SVHN                          | Val  Loss: 1.6278 | Val  Acc: 0.4424
Average Valid Accuracy: 0.6754
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.3968 | Train Acc: 0.8814
 Site-MNIST                         | Train Loss: 0.4179 | Train Acc: 0.8951
 Site-USPS                          | Train Loss: 0.3852 | Train Acc: 0.9111
 Site-USPS                          | Train Loss: 0.3459 | Train Acc: 0.9121
 Site-SynthDigits                   | Train Loss: 1.1206 | Train Acc: 0.6199
 Site-SynthDigits                   | Train Loss: 0.9917 | Train Acc: 0.7049
 Site-MNIST_M                       | Train Loss: 1.3831 | Train Acc: 0.5526
 Site-MNIST_M                       | Train Loss: 1.3875 | Train Acc: 0.5650
 Site-SVHN                          | Train Loss: 1.7117 | Train Acc: 0.4259
 Site-SVHN                          | Train Loss: 1.5808 | Train Acc: 0.4664
Average Train Accuracy: 0.6934
 Site-MNIST                         | Val  Loss: 0.4014 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.4113 | Val  Acc: 0.8885
 Site-USPS                          | Val  Loss: 0.5110 | Val  Acc: 0.8370
 Site-USPS                          | Val  Loss: 0.4141 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 1.0337 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.0480 | Val  Acc: 0.6583
 Site-MNIST_M                       | Val  Loss: 1.3537 | Val  Acc: 0.5543
 Site-MNIST_M                       | Val  Loss: 1.3527 | Val  Acc: 0.5755
 Site-SVHN                          | Val  Loss: 1.5185 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.6375 | Val  Acc: 0.4460
Average Valid Accuracy: 0.6859
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8913
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8885
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8370
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8669
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.6583
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.5543
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.5755
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.4460
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.3767 | Train Acc: 0.8895
 Site-MNIST                         | Train Loss: 0.4046 | Train Acc: 0.8996
 Site-USPS                          | Train Loss: 0.3736 | Train Acc: 0.9191
 Site-USPS                          | Train Loss: 0.3409 | Train Acc: 0.9112
 Site-SynthDigits                   | Train Loss: 1.0980 | Train Acc: 0.6253
 Site-SynthDigits                   | Train Loss: 0.9739 | Train Acc: 0.7085
 Site-MNIST_M                       | Train Loss: 1.3869 | Train Acc: 0.5553
 Site-MNIST_M                       | Train Loss: 1.3762 | Train Acc: 0.5677
 Site-SVHN                          | Train Loss: 1.7111 | Train Acc: 0.4286
 Site-SVHN                          | Train Loss: 1.5847 | Train Acc: 0.4655
Average Train Accuracy: 0.6970
 Site-MNIST                         | Val  Loss: 0.3872 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.4022 | Val  Acc: 0.8957
 Site-USPS                          | Val  Loss: 0.5095 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.4075 | Val  Acc: 0.8597
 Site-SynthDigits                   | Val  Loss: 1.0178 | Val  Acc: 0.6630
 Site-SynthDigits                   | Val  Loss: 1.0295 | Val  Acc: 0.6619
 Site-MNIST_M                       | Val  Loss: 1.3398 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.3453 | Val  Acc: 0.5755
 Site-SVHN                          | Val  Loss: 1.5137 | Val  Acc: 0.4783
 Site-SVHN                          | Val  Loss: 1.6319 | Val  Acc: 0.4424
Average Valid Accuracy: 0.6827
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.3701 | Train Acc: 0.8895
 Site-MNIST                         | Train Loss: 0.3975 | Train Acc: 0.8978
 Site-USPS                          | Train Loss: 0.3759 | Train Acc: 0.9084
 Site-USPS                          | Train Loss: 0.3503 | Train Acc: 0.9076
 Site-SynthDigits                   | Train Loss: 1.0800 | Train Acc: 0.6415
 Site-SynthDigits                   | Train Loss: 0.9669 | Train Acc: 0.7067
 Site-MNIST_M                       | Train Loss: 1.3635 | Train Acc: 0.5580
 Site-MNIST_M                       | Train Loss: 1.3603 | Train Acc: 0.5740
 Site-SVHN                          | Train Loss: 1.7043 | Train Acc: 0.4420
 Site-SVHN                          | Train Loss: 1.5592 | Train Acc: 0.4700
Average Train Accuracy: 0.6995
 Site-MNIST                         | Val  Loss: 0.3719 | Val  Acc: 0.8804
 Site-MNIST                         | Val  Loss: 0.3893 | Val  Acc: 0.8921
 Site-USPS                          | Val  Loss: 0.5286 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.4045 | Val  Acc: 0.8561
 Site-SynthDigits                   | Val  Loss: 1.0154 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.0205 | Val  Acc: 0.6619
 Site-MNIST_M                       | Val  Loss: 1.3421 | Val  Acc: 0.5652
 Site-MNIST_M                       | Val  Loss: 1.3304 | Val  Acc: 0.5791
 Site-SVHN                          | Val  Loss: 1.5005 | Val  Acc: 0.4891
 Site-SVHN                          | Val  Loss: 1.6239 | Val  Acc: 0.4424
Average Valid Accuracy: 0.6823
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.3779 | Train Acc: 0.8868
 Site-MNIST                         | Train Loss: 0.3960 | Train Acc: 0.8951
 Site-USPS                          | Train Loss: 0.3626 | Train Acc: 0.9084
 Site-USPS                          | Train Loss: 0.3365 | Train Acc: 0.9094
 Site-SynthDigits                   | Train Loss: 1.0768 | Train Acc: 0.6388
 Site-SynthDigits                   | Train Loss: 0.9569 | Train Acc: 0.7067
 Site-MNIST_M                       | Train Loss: 1.3529 | Train Acc: 0.5687
 Site-MNIST_M                       | Train Loss: 1.3547 | Train Acc: 0.5659
 Site-SVHN                          | Train Loss: 1.6916 | Train Acc: 0.4232
 Site-SVHN                          | Train Loss: 1.5380 | Train Acc: 0.4861
Average Train Accuracy: 0.6989
 Site-MNIST                         | Val  Loss: 0.3715 | Val  Acc: 0.8804
 Site-MNIST                         | Val  Loss: 0.3839 | Val  Acc: 0.8885
 Site-USPS                          | Val  Loss: 0.5079 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.3991 | Val  Acc: 0.8597
 Site-SynthDigits                   | Val  Loss: 1.0163 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.0146 | Val  Acc: 0.6583
 Site-MNIST_M                       | Val  Loss: 1.3206 | Val  Acc: 0.5761
 Site-MNIST_M                       | Val  Loss: 1.3225 | Val  Acc: 0.5755
 Site-SVHN                          | Val  Loss: 1.4834 | Val  Acc: 0.5217
 Site-SVHN                          | Val  Loss: 1.6119 | Val  Acc: 0.4604
Average Valid Accuracy: 0.6877
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.8804
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.8885
 Best site-USPS                      | Epoch:40 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:40 | Val Acc: 0.8597
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.6583
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.5761
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.5755
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.5217
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.4604
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.3628 | Train Acc: 0.8868
 Site-MNIST                         | Train Loss: 0.3821 | Train Acc: 0.8978
 Site-USPS                          | Train Loss: 0.3604 | Train Acc: 0.9057
 Site-USPS                          | Train Loss: 0.3297 | Train Acc: 0.9121
 Site-SynthDigits                   | Train Loss: 1.0503 | Train Acc: 0.6415
 Site-SynthDigits                   | Train Loss: 0.9389 | Train Acc: 0.7157
 Site-MNIST_M                       | Train Loss: 1.3472 | Train Acc: 0.5714
 Site-MNIST_M                       | Train Loss: 1.3443 | Train Acc: 0.5722
 Site-SVHN                          | Train Loss: 1.6947 | Train Acc: 0.4447
 Site-SVHN                          | Train Loss: 1.5405 | Train Acc: 0.4807
Average Train Accuracy: 0.7029
 Site-MNIST                         | Val  Loss: 0.3570 | Val  Acc: 0.9022
 Site-MNIST                         | Val  Loss: 0.3752 | Val  Acc: 0.8957
 Site-USPS                          | Val  Loss: 0.5118 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.3958 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 0.9994 | Val  Acc: 0.6522
 Site-SynthDigits                   | Val  Loss: 0.9942 | Val  Acc: 0.6655
 Site-MNIST_M                       | Val  Loss: 1.3213 | Val  Acc: 0.5761
 Site-MNIST_M                       | Val  Loss: 1.3197 | Val  Acc: 0.5899
 Site-SVHN                          | Val  Loss: 1.4854 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.6145 | Val  Acc: 0.4460
Average Valid Accuracy: 0.6921
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9022
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.8957
 Best site-USPS                      | Epoch:41 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:41 | Val Acc: 0.8669
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.6522
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.6655
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5761
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5899
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.4460
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.3663 | Train Acc: 0.8895
 Site-MNIST                         | Train Loss: 0.3679 | Train Acc: 0.9022
 Site-USPS                          | Train Loss: 0.3578 | Train Acc: 0.9057
 Site-USPS                          | Train Loss: 0.3295 | Train Acc: 0.9112
 Site-SynthDigits                   | Train Loss: 1.0480 | Train Acc: 0.6469
 Site-SynthDigits                   | Train Loss: 0.9340 | Train Acc: 0.7229
 Site-MNIST_M                       | Train Loss: 1.3419 | Train Acc: 0.5687
 Site-MNIST_M                       | Train Loss: 1.3393 | Train Acc: 0.5794
 Site-SVHN                          | Train Loss: 1.6766 | Train Acc: 0.4340
 Site-SVHN                          | Train Loss: 1.5315 | Train Acc: 0.4870
Average Train Accuracy: 0.7047
 Site-MNIST                         | Val  Loss: 0.3475 | Val  Acc: 0.8804
 Site-MNIST                         | Val  Loss: 0.3664 | Val  Acc: 0.8921
 Site-USPS                          | Val  Loss: 0.5144 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.3848 | Val  Acc: 0.8633
 Site-SynthDigits                   | Val  Loss: 0.9940 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 0.9877 | Val  Acc: 0.6619
 Site-MNIST_M                       | Val  Loss: 1.3110 | Val  Acc: 0.5978
 Site-MNIST_M                       | Val  Loss: 1.3074 | Val  Acc: 0.5935
 Site-SVHN                          | Val  Loss: 1.4642 | Val  Acc: 0.5217
 Site-SVHN                          | Val  Loss: 1.5964 | Val  Acc: 0.4604
Average Valid Accuracy: 0.6928
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8804
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8921
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8633
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.6619
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.5978
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.5935
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.5217
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.4604
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.3527 | Train Acc: 0.8922
 Site-MNIST                         | Train Loss: 0.3610 | Train Acc: 0.9103
 Site-USPS                          | Train Loss: 0.3480 | Train Acc: 0.9030
 Site-USPS                          | Train Loss: 0.3137 | Train Acc: 0.9112
 Site-SynthDigits                   | Train Loss: 1.0570 | Train Acc: 0.6496
 Site-SynthDigits                   | Train Loss: 0.9451 | Train Acc: 0.7130
 Site-MNIST_M                       | Train Loss: 1.3290 | Train Acc: 0.5606
 Site-MNIST_M                       | Train Loss: 1.3143 | Train Acc: 0.5803
 Site-SVHN                          | Train Loss: 1.6745 | Train Acc: 0.4394
 Site-SVHN                          | Train Loss: 1.5205 | Train Acc: 0.4789
Average Train Accuracy: 0.7038
 Site-MNIST                         | Val  Loss: 0.3321 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.3528 | Val  Acc: 0.9029
 Site-USPS                          | Val  Loss: 0.5029 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.3756 | Val  Acc: 0.8561
 Site-SynthDigits                   | Val  Loss: 0.9998 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 0.9923 | Val  Acc: 0.6655
 Site-MNIST_M                       | Val  Loss: 1.2948 | Val  Acc: 0.6304
 Site-MNIST_M                       | Val  Loss: 1.2966 | Val  Acc: 0.6079
 Site-SVHN                          | Val  Loss: 1.4660 | Val  Acc: 0.4891
 Site-SVHN                          | Val  Loss: 1.5966 | Val  Acc: 0.4496
Average Valid Accuracy: 0.6939
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8913
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9029
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8561
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.6655
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.6304
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.6079
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.4891
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.4496
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.3471 | Train Acc: 0.8922
 Site-MNIST                         | Train Loss: 0.3541 | Train Acc: 0.9094
 Site-USPS                          | Train Loss: 0.3412 | Train Acc: 0.9084
 Site-USPS                          | Train Loss: 0.3114 | Train Acc: 0.9157
 Site-SynthDigits                   | Train Loss: 1.0375 | Train Acc: 0.6631
 Site-SynthDigits                   | Train Loss: 0.9102 | Train Acc: 0.7336
 Site-MNIST_M                       | Train Loss: 1.3227 | Train Acc: 0.5822
 Site-MNIST_M                       | Train Loss: 1.3093 | Train Acc: 0.5803
 Site-SVHN                          | Train Loss: 1.6777 | Train Acc: 0.4367
 Site-SVHN                          | Train Loss: 1.5284 | Train Acc: 0.4987
Average Train Accuracy: 0.7120
 Site-MNIST                         | Val  Loss: 0.3265 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.3460 | Val  Acc: 0.8993
 Site-USPS                          | Val  Loss: 0.5037 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.3753 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 0.9811 | Val  Acc: 0.6522
 Site-SynthDigits                   | Val  Loss: 0.9737 | Val  Acc: 0.6799
 Site-MNIST_M                       | Val  Loss: 1.2733 | Val  Acc: 0.6304
 Site-MNIST_M                       | Val  Loss: 1.2849 | Val  Acc: 0.6043
 Site-SVHN                          | Val  Loss: 1.4620 | Val  Acc: 0.5543
 Site-SVHN                          | Val  Loss: 1.5975 | Val  Acc: 0.4748
Average Valid Accuracy: 0.7080
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8913
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8993
 Best site-USPS                      | Epoch:44 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:44 | Val Acc: 0.8669
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.6522
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.6799
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.6304
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.6043
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.5543
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.4748
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.3521 | Train Acc: 0.8922
 Site-MNIST                         | Train Loss: 0.3529 | Train Acc: 0.9040
 Site-USPS                          | Train Loss: 0.3461 | Train Acc: 0.9084
 Site-USPS                          | Train Loss: 0.3084 | Train Acc: 0.9139
 Site-SynthDigits                   | Train Loss: 1.0269 | Train Acc: 0.6631
 Site-SynthDigits                   | Train Loss: 0.9147 | Train Acc: 0.7309
 Site-MNIST_M                       | Train Loss: 1.3214 | Train Acc: 0.5930
 Site-MNIST_M                       | Train Loss: 1.3035 | Train Acc: 0.5857
 Site-SVHN                          | Train Loss: 1.6597 | Train Acc: 0.4394
 Site-SVHN                          | Train Loss: 1.5141 | Train Acc: 0.4888
Average Train Accuracy: 0.7119
 Site-MNIST                         | Val  Loss: 0.3314 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.3457 | Val  Acc: 0.9101
 Site-USPS                          | Val  Loss: 0.4959 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.3723 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 0.9806 | Val  Acc: 0.6739
 Site-SynthDigits                   | Val  Loss: 0.9669 | Val  Acc: 0.6835
 Site-MNIST_M                       | Val  Loss: 1.2698 | Val  Acc: 0.5978
 Site-MNIST_M                       | Val  Loss: 1.2777 | Val  Acc: 0.6079
 Site-SVHN                          | Val  Loss: 1.4535 | Val  Acc: 0.5326
 Site-SVHN                          | Val  Loss: 1.5838 | Val  Acc: 0.4676
Average Valid Accuracy: 0.7079
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.3288 | Train Acc: 0.9057
 Site-MNIST                         | Train Loss: 0.3399 | Train Acc: 0.9121
 Site-USPS                          | Train Loss: 0.3332 | Train Acc: 0.9111
 Site-USPS                          | Train Loss: 0.2996 | Train Acc: 0.9202
 Site-SynthDigits                   | Train Loss: 1.0290 | Train Acc: 0.6469
 Site-SynthDigits                   | Train Loss: 0.9052 | Train Acc: 0.7336
 Site-MNIST_M                       | Train Loss: 1.3132 | Train Acc: 0.5768
 Site-MNIST_M                       | Train Loss: 1.2928 | Train Acc: 0.5812
 Site-SVHN                          | Train Loss: 1.6609 | Train Acc: 0.4367
 Site-SVHN                          | Train Loss: 1.5108 | Train Acc: 0.4951
Average Train Accuracy: 0.7119
 Site-MNIST                         | Val  Loss: 0.3102 | Val  Acc: 0.9239
 Site-MNIST                         | Val  Loss: 0.3332 | Val  Acc: 0.9137
 Site-USPS                          | Val  Loss: 0.4673 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.3609 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 0.9797 | Val  Acc: 0.6739
 Site-SynthDigits                   | Val  Loss: 0.9692 | Val  Acc: 0.6799
 Site-MNIST_M                       | Val  Loss: 1.2552 | Val  Acc: 0.6087
 Site-MNIST_M                       | Val  Loss: 1.2710 | Val  Acc: 0.6007
 Site-SVHN                          | Val  Loss: 1.4459 | Val  Acc: 0.5326
 Site-SVHN                          | Val  Loss: 1.5721 | Val  Acc: 0.4712
Average Valid Accuracy: 0.7087
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9239
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9137
 Best site-USPS                      | Epoch:46 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:46 | Val Acc: 0.8669
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.6739
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.6799
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.6087
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.6007
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.5326
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.4712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.3299 | Train Acc: 0.9003
 Site-MNIST                         | Train Loss: 0.3304 | Train Acc: 0.9157
 Site-USPS                          | Train Loss: 0.3422 | Train Acc: 0.9084
 Site-USPS                          | Train Loss: 0.3022 | Train Acc: 0.9175
 Site-SynthDigits                   | Train Loss: 1.0165 | Train Acc: 0.6604
 Site-SynthDigits                   | Train Loss: 0.8925 | Train Acc: 0.7372
 Site-MNIST_M                       | Train Loss: 1.2864 | Train Acc: 0.5984
 Site-MNIST_M                       | Train Loss: 1.2852 | Train Acc: 0.5785
 Site-SVHN                          | Train Loss: 1.6562 | Train Acc: 0.4420
 Site-SVHN                          | Train Loss: 1.5012 | Train Acc: 0.4969
Average Train Accuracy: 0.7155
 Site-MNIST                         | Val  Loss: 0.3058 | Val  Acc: 0.9348
 Site-MNIST                         | Val  Loss: 0.3311 | Val  Acc: 0.9137
 Site-USPS                          | Val  Loss: 0.4731 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.3636 | Val  Acc: 0.8705
 Site-SynthDigits                   | Val  Loss: 0.9598 | Val  Acc: 0.6739
 Site-SynthDigits                   | Val  Loss: 0.9491 | Val  Acc: 0.6871
 Site-MNIST_M                       | Val  Loss: 1.2471 | Val  Acc: 0.5978
 Site-MNIST_M                       | Val  Loss: 1.2650 | Val  Acc: 0.5899
 Site-SVHN                          | Val  Loss: 1.4371 | Val  Acc: 0.5435
 Site-SVHN                          | Val  Loss: 1.5756 | Val  Acc: 0.4712
Average Valid Accuracy: 0.7098
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9348
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9137
 Best site-USPS                      | Epoch:47 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:47 | Val Acc: 0.8705
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.6739
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.6871
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.5978
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.5899
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.5435
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.4712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.3210 | Train Acc: 0.9057
 Site-MNIST                         | Train Loss: 0.3271 | Train Acc: 0.9202
 Site-USPS                          | Train Loss: 0.3168 | Train Acc: 0.9137
 Site-USPS                          | Train Loss: 0.2909 | Train Acc: 0.9202
 Site-SynthDigits                   | Train Loss: 1.0248 | Train Acc: 0.6658
 Site-SynthDigits                   | Train Loss: 0.8907 | Train Acc: 0.7354
 Site-MNIST_M                       | Train Loss: 1.2966 | Train Acc: 0.5822
 Site-MNIST_M                       | Train Loss: 1.2722 | Train Acc: 0.5937
 Site-SVHN                          | Train Loss: 1.6576 | Train Acc: 0.4474
 Site-SVHN                          | Train Loss: 1.4986 | Train Acc: 0.4951
Average Train Accuracy: 0.7179
 Site-MNIST                         | Val  Loss: 0.3007 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.3210 | Val  Acc: 0.9137
 Site-USPS                          | Val  Loss: 0.4732 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.3479 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 0.9580 | Val  Acc: 0.6630
 Site-SynthDigits                   | Val  Loss: 0.9479 | Val  Acc: 0.6942
 Site-MNIST_M                       | Val  Loss: 1.2428 | Val  Acc: 0.6304
 Site-MNIST_M                       | Val  Loss: 1.2568 | Val  Acc: 0.6079
 Site-SVHN                          | Val  Loss: 1.4348 | Val  Acc: 0.5435
 Site-SVHN                          | Val  Loss: 1.5702 | Val  Acc: 0.4856
Average Valid Accuracy: 0.7134
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9137
 Best site-USPS                      | Epoch:48 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:48 | Val Acc: 0.8669
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.6630
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.6942
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.6304
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.6079
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.5435
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.4856
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/fedavg...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.3158 | Train Acc: 0.9084
 Site-MNIST                         | Train Loss: 0.3191 | Train Acc: 0.9184
 Site-USPS                          | Train Loss: 0.3311 | Train Acc: 0.9111
 Site-USPS                          | Train Loss: 0.2998 | Train Acc: 0.9229
 Site-SynthDigits                   | Train Loss: 1.0068 | Train Acc: 0.6604
 Site-SynthDigits                   | Train Loss: 0.8773 | Train Acc: 0.7372
 Site-MNIST_M                       | Train Loss: 1.2917 | Train Acc: 0.6011
 Site-MNIST_M                       | Train Loss: 1.2681 | Train Acc: 0.5901
 Site-SVHN                          | Train Loss: 1.6569 | Train Acc: 0.4609
 Site-SVHN                          | Train Loss: 1.5073 | Train Acc: 0.4915
Average Train Accuracy: 0.7202
 Site-MNIST                         | Val  Loss: 0.2964 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.3195 | Val  Acc: 0.9065
 Site-USPS                          | Val  Loss: 0.4755 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.3593 | Val  Acc: 0.8777
 Site-SynthDigits                   | Val  Loss: 0.9542 | Val  Acc: 0.6848
 Site-SynthDigits                   | Val  Loss: 0.9434 | Val  Acc: 0.7014
 Site-MNIST_M                       | Val  Loss: 1.2244 | Val  Acc: 0.6304
 Site-MNIST_M                       | Val  Loss: 1.2451 | Val  Acc: 0.6115
 Site-SVHN                          | Val  Loss: 1.4306 | Val  Acc: 0.5217
 Site-SVHN                          | Val  Loss: 1.5800 | Val  Acc: 0.4820
Average Valid Accuracy: 0.7133
===2023-06-30 15:59:01===
===2023-06-30 15:59:04===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.8993
 Test site-USPS                      | Epoch:48 | Test Acc: 0.9043
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.6838
 Test site-MNIST_M                   | Epoch:48 | Test Acc: 0.5234
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.4122
MNIST: 0.8993, USPS: 0.9043, SynthDigits: 0.6838, MNIST_M: 0.5234, SVHN: 0.4122, 
Average Test Accuracy(group): 0.6846, Average Test Accuracy(individual): 0.6846,
domain std=0.1972, cluster std=-1.0000, individual std=0.1972, 
