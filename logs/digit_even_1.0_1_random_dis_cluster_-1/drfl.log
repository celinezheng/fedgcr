===2023-06-04 11:14:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                    | Train Loss: 2.2497 | Train Acc: 0.2264
 Site-MNIST                    | Train Loss: 2.2568 | Train Acc: 0.2197
 Site-USPS                     | Train Loss: 2.2510 | Train Acc: 0.2561
 Site-USPS                     | Train Loss: 2.2463 | Train Acc: 0.2673
 Site-SynthDigits              | Train Loss: 2.2932 | Train Acc: 0.1294
 Site-SynthDigits              | Train Loss: 2.2832 | Train Acc: 0.1641
 Site-MNIST-M                  | Train Loss: 2.2996 | Train Acc: 0.1186
 Site-MNIST-M                  | Train Loss: 2.2982 | Train Acc: 0.1040
 Site-SVHN                     | Train Loss: 2.2821 | Train Acc: 0.1456
 Site-SVHN                     | Train Loss: 2.2868 | Train Acc: 0.1426
 Site-MNIST                         | Val  Loss: 2.2631 | Val  Acc: 0.1522
 Site-MNIST                         | Val  Loss: 2.2538 | Val  Acc: 0.1978
 Site-USPS                          | Val  Loss: 2.2520 | Val  Acc: 0.2609
 Site-USPS                          | Val  Loss: 2.2487 | Val  Acc: 0.2698
 Site-SynthDigits                   | Val  Loss: 2.2888 | Val  Acc: 0.1413
 Site-SynthDigits                   | Val  Loss: 2.2936 | Val  Acc: 0.1079
 Site-MNIST-M                       | Val  Loss: 2.3046 | Val  Acc: 0.0652
 Site-MNIST-M                       | Val  Loss: 2.3003 | Val  Acc: 0.0935
 Site-SVHN                          | Val  Loss: 2.2840 | Val  Acc: 0.1630
 Site-SVHN                          | Val  Loss: 2.2862 | Val  Acc: 0.1403
Average Valid Accuracy: 0.1592
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1522
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1978
 Best site-USPS                      | Epoch:0 | Val Acc: 0.2609
 Best site-USPS                      | Epoch:0 | Val Acc: 0.2698
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1413
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1079
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.0652
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.0935
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1630
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1403
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 1 ============
 Site-MNIST                    | Train Loss: 2.2037 | Train Acc: 0.4367
 Site-MNIST                    | Train Loss: 2.2200 | Train Acc: 0.3614
 Site-USPS                     | Train Loss: 2.1948 | Train Acc: 0.4474
 Site-USPS                     | Train Loss: 2.1893 | Train Acc: 0.4816
 Site-SynthDigits              | Train Loss: 2.2823 | Train Acc: 0.1590
 Site-SynthDigits              | Train Loss: 2.2669 | Train Acc: 0.2099
 Site-MNIST-M                  | Train Loss: 2.2934 | Train Acc: 0.1213
 Site-MNIST-M                  | Train Loss: 2.2921 | Train Acc: 0.1085
 Site-SVHN                     | Train Loss: 2.2714 | Train Acc: 0.1941
 Site-SVHN                     | Train Loss: 2.2759 | Train Acc: 0.1830
 Site-MNIST                         | Val  Loss: 2.2274 | Val  Acc: 0.2609
 Site-MNIST                         | Val  Loss: 2.2147 | Val  Acc: 0.3813
 Site-USPS                          | Val  Loss: 2.2012 | Val  Acc: 0.4130
 Site-USPS                          | Val  Loss: 2.1974 | Val  Acc: 0.4496
 Site-SynthDigits                   | Val  Loss: 2.2717 | Val  Acc: 0.2065
 Site-SynthDigits                   | Val  Loss: 2.2797 | Val  Acc: 0.1511
 Site-MNIST-M                       | Val  Loss: 2.2984 | Val  Acc: 0.0652
 Site-MNIST-M                       | Val  Loss: 2.2932 | Val  Acc: 0.1043
 Site-SVHN                          | Val  Loss: 2.2701 | Val  Acc: 0.2065
 Site-SVHN                          | Val  Loss: 2.2737 | Val  Acc: 0.2050
Average Valid Accuracy: 0.2444
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.2609
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.3813
 Best site-USPS                      | Epoch:1 | Val Acc: 0.4130
 Best site-USPS                      | Epoch:1 | Val Acc: 0.4496
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2065
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.1511
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.0652
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.1043
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2065
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2050
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 2 ============
 Site-MNIST                    | Train Loss: 2.1612 | Train Acc: 0.5202
 Site-MNIST                    | Train Loss: 2.1841 | Train Acc: 0.4448
 Site-USPS                     | Train Loss: 2.1416 | Train Acc: 0.5229
 Site-USPS                     | Train Loss: 2.1357 | Train Acc: 0.5641
 Site-SynthDigits              | Train Loss: 2.2709 | Train Acc: 0.1914
 Site-SynthDigits              | Train Loss: 2.2509 | Train Acc: 0.2538
 Site-MNIST-M                  | Train Loss: 2.2868 | Train Acc: 0.1348
 Site-MNIST-M                  | Train Loss: 2.2859 | Train Acc: 0.1229
 Site-SVHN                     | Train Loss: 2.2616 | Train Acc: 0.2318
 Site-SVHN                     | Train Loss: 2.2658 | Train Acc: 0.2027
 Site-MNIST                         | Val  Loss: 2.1923 | Val  Acc: 0.4022
 Site-MNIST                         | Val  Loss: 2.1766 | Val  Acc: 0.4640
 Site-USPS                          | Val  Loss: 2.1533 | Val  Acc: 0.4891
 Site-USPS                          | Val  Loss: 2.1490 | Val  Acc: 0.5072
 Site-SynthDigits                   | Val  Loss: 2.2554 | Val  Acc: 0.2500
 Site-SynthDigits                   | Val  Loss: 2.2660 | Val  Acc: 0.1978
 Site-MNIST-M                       | Val  Loss: 2.2924 | Val  Acc: 0.0543
 Site-MNIST-M                       | Val  Loss: 2.2862 | Val  Acc: 0.1043
 Site-SVHN                          | Val  Loss: 2.2572 | Val  Acc: 0.2391
 Site-SVHN                          | Val  Loss: 2.2623 | Val  Acc: 0.2338
Average Valid Accuracy: 0.2942
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.4022
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.4640
 Best site-USPS                      | Epoch:2 | Val Acc: 0.4891
 Best site-USPS                      | Epoch:2 | Val Acc: 0.5072
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2500
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.1978
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.0543
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.1043
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2391
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2338
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 3 ============
 Site-MNIST                    | Train Loss: 2.1158 | Train Acc: 0.5499
 Site-MNIST                    | Train Loss: 2.1473 | Train Acc: 0.4691
 Site-USPS                     | Train Loss: 2.0918 | Train Acc: 0.5526
 Site-USPS                     | Train Loss: 2.0847 | Train Acc: 0.5857
 Site-SynthDigits              | Train Loss: 2.2587 | Train Acc: 0.2183
 Site-SynthDigits              | Train Loss: 2.2351 | Train Acc: 0.2825
 Site-MNIST-M                  | Train Loss: 2.2790 | Train Acc: 0.1590
 Site-MNIST-M                  | Train Loss: 2.2792 | Train Acc: 0.1435
 Site-SVHN                     | Train Loss: 2.2513 | Train Acc: 0.2453
 Site-SVHN                     | Train Loss: 2.2571 | Train Acc: 0.2143
 Site-MNIST                         | Val  Loss: 2.1563 | Val  Acc: 0.4348
 Site-MNIST                         | Val  Loss: 2.1380 | Val  Acc: 0.4856
 Site-USPS                          | Val  Loss: 2.1076 | Val  Acc: 0.5326
 Site-USPS                          | Val  Loss: 2.1030 | Val  Acc: 0.5288
 Site-SynthDigits                   | Val  Loss: 2.2397 | Val  Acc: 0.2826
 Site-SynthDigits                   | Val  Loss: 2.2521 | Val  Acc: 0.2374
 Site-MNIST-M                       | Val  Loss: 2.2865 | Val  Acc: 0.0761
 Site-MNIST-M                       | Val  Loss: 2.2792 | Val  Acc: 0.1151
 Site-SVHN                          | Val  Loss: 2.2454 | Val  Acc: 0.2717
 Site-SVHN                          | Val  Loss: 2.2522 | Val  Acc: 0.2554
Average Valid Accuracy: 0.3220
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.4348
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.4856
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5326
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5288
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2826
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2374
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.0761
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.1151
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2717
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2554
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 4 ============
 Site-MNIST                    | Train Loss: 2.0758 | Train Acc: 0.5822
 Site-MNIST                    | Train Loss: 2.1114 | Train Acc: 0.4816
 Site-USPS                     | Train Loss: 2.0430 | Train Acc: 0.5768
 Site-USPS                     | Train Loss: 2.0365 | Train Acc: 0.5937
 Site-SynthDigits              | Train Loss: 2.2457 | Train Acc: 0.2318
 Site-SynthDigits              | Train Loss: 2.2189 | Train Acc: 0.3022
 Site-MNIST-M                  | Train Loss: 2.2711 | Train Acc: 0.1833
 Site-MNIST-M                  | Train Loss: 2.2728 | Train Acc: 0.1605
 Site-SVHN                     | Train Loss: 2.2429 | Train Acc: 0.2480
 Site-SVHN                     | Train Loss: 2.2485 | Train Acc: 0.2314
 Site-MNIST                         | Val  Loss: 2.1206 | Val  Acc: 0.4674
 Site-MNIST                         | Val  Loss: 2.1003 | Val  Acc: 0.5216
 Site-USPS                          | Val  Loss: 2.0637 | Val  Acc: 0.5109
 Site-USPS                          | Val  Loss: 2.0591 | Val  Acc: 0.5252
 Site-SynthDigits                   | Val  Loss: 2.2242 | Val  Acc: 0.2826
 Site-SynthDigits                   | Val  Loss: 2.2379 | Val  Acc: 0.2374
 Site-MNIST-M                       | Val  Loss: 2.2803 | Val  Acc: 0.1304
 Site-MNIST-M                       | Val  Loss: 2.2724 | Val  Acc: 0.1511
 Site-SVHN                          | Val  Loss: 2.2349 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.2427 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3383
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.4674
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5216
 Best site-USPS                      | Epoch:4 | Val Acc: 0.5109
 Best site-USPS                      | Epoch:4 | Val Acc: 0.5252
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.2826
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.2374
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.1304
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.1511
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 5 ============
 Site-MNIST                    | Train Loss: 2.0360 | Train Acc: 0.6038
 Site-MNIST                    | Train Loss: 2.0762 | Train Acc: 0.4915
 Site-USPS                     | Train Loss: 1.9962 | Train Acc: 0.5876
 Site-USPS                     | Train Loss: 1.9924 | Train Acc: 0.6018
 Site-SynthDigits              | Train Loss: 2.2350 | Train Acc: 0.2399
 Site-SynthDigits              | Train Loss: 2.2028 | Train Acc: 0.3175
 Site-MNIST-M                  | Train Loss: 2.2639 | Train Acc: 0.1968
 Site-MNIST-M                  | Train Loss: 2.2658 | Train Acc: 0.1731
 Site-SVHN                     | Train Loss: 2.2348 | Train Acc: 0.2480
 Site-SVHN                     | Train Loss: 2.2411 | Train Acc: 0.2323
 Site-MNIST                         | Val  Loss: 2.0857 | Val  Acc: 0.4783
 Site-MNIST                         | Val  Loss: 2.0636 | Val  Acc: 0.5252
 Site-USPS                          | Val  Loss: 2.0235 | Val  Acc: 0.5435
 Site-USPS                          | Val  Loss: 2.0190 | Val  Acc: 0.5540
 Site-SynthDigits                   | Val  Loss: 2.2084 | Val  Acc: 0.3152
 Site-SynthDigits                   | Val  Loss: 2.2230 | Val  Acc: 0.2590
 Site-MNIST-M                       | Val  Loss: 2.2734 | Val  Acc: 0.1304
 Site-MNIST-M                       | Val  Loss: 2.2653 | Val  Acc: 0.1547
 Site-SVHN                          | Val  Loss: 2.2254 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.2335 | Val  Acc: 0.2806
Average Valid Accuracy: 0.3545
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.4783
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5252
 Best site-USPS                      | Epoch:5 | Val Acc: 0.5435
 Best site-USPS                      | Epoch:5 | Val Acc: 0.5540
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3152
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.2590
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.1304
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.1547
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2806
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 6 ============
 Site-MNIST                    | Train Loss: 2.0000 | Train Acc: 0.6146
 Site-MNIST                    | Train Loss: 2.0446 | Train Acc: 0.5031
 Site-USPS                     | Train Loss: 1.9528 | Train Acc: 0.6038
 Site-USPS                     | Train Loss: 1.9483 | Train Acc: 0.6126
 Site-SynthDigits              | Train Loss: 2.2208 | Train Acc: 0.2588
 Site-SynthDigits              | Train Loss: 2.1864 | Train Acc: 0.3345
 Site-MNIST-M                  | Train Loss: 2.2554 | Train Acc: 0.1968
 Site-MNIST-M                  | Train Loss: 2.2589 | Train Acc: 0.1937
 Site-SVHN                     | Train Loss: 2.2252 | Train Acc: 0.2507
 Site-SVHN                     | Train Loss: 2.2333 | Train Acc: 0.2296
 Site-MNIST                         | Val  Loss: 2.0533 | Val  Acc: 0.5000
 Site-MNIST                         | Val  Loss: 2.0307 | Val  Acc: 0.5396
 Site-USPS                          | Val  Loss: 1.9821 | Val  Acc: 0.5435
 Site-USPS                          | Val  Loss: 1.9777 | Val  Acc: 0.5612
 Site-SynthDigits                   | Val  Loss: 2.1933 | Val  Acc: 0.3370
 Site-SynthDigits                   | Val  Loss: 2.2080 | Val  Acc: 0.2878
 Site-MNIST-M                       | Val  Loss: 2.2658 | Val  Acc: 0.1413
 Site-MNIST-M                       | Val  Loss: 2.2575 | Val  Acc: 0.1799
 Site-SVHN                          | Val  Loss: 2.2166 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.2244 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3668
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.5000
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.5396
 Best site-USPS                      | Epoch:6 | Val Acc: 0.5435
 Best site-USPS                      | Epoch:6 | Val Acc: 0.5612
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3370
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.2878
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.1413
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.1799
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 7 ============
 Site-MNIST                    | Train Loss: 1.9646 | Train Acc: 0.6307
 Site-MNIST                    | Train Loss: 2.0133 | Train Acc: 0.5103
 Site-USPS                     | Train Loss: 1.9142 | Train Acc: 0.5984
 Site-USPS                     | Train Loss: 1.9079 | Train Acc: 0.6161
 Site-SynthDigits              | Train Loss: 2.2076 | Train Acc: 0.2642
 Site-SynthDigits              | Train Loss: 2.1697 | Train Acc: 0.3534
 Site-MNIST-M                  | Train Loss: 2.2460 | Train Acc: 0.2022
 Site-MNIST-M                  | Train Loss: 2.2520 | Train Acc: 0.2090
 Site-SVHN                     | Train Loss: 2.2213 | Train Acc: 0.2534
 Site-SVHN                     | Train Loss: 2.2265 | Train Acc: 0.2314
 Site-MNIST                         | Val  Loss: 2.0223 | Val  Acc: 0.5109
 Site-MNIST                         | Val  Loss: 1.9987 | Val  Acc: 0.5647
 Site-USPS                          | Val  Loss: 1.9450 | Val  Acc: 0.5326
 Site-USPS                          | Val  Loss: 1.9404 | Val  Acc: 0.5612
 Site-SynthDigits                   | Val  Loss: 2.1776 | Val  Acc: 0.3478
 Site-SynthDigits                   | Val  Loss: 2.1929 | Val  Acc: 0.3058
 Site-MNIST-M                       | Val  Loss: 2.2591 | Val  Acc: 0.1630
 Site-MNIST-M                       | Val  Loss: 2.2501 | Val  Acc: 0.1978
 Site-SVHN                          | Val  Loss: 2.2084 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.2167 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3751
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.5109
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.5647
 Best site-USPS                      | Epoch:7 | Val Acc: 0.5326
 Best site-USPS                      | Epoch:7 | Val Acc: 0.5612
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3478
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3058
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.1630
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.1978
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 8 ============
 Site-MNIST                    | Train Loss: 1.9264 | Train Acc: 0.6280
 Site-MNIST                    | Train Loss: 1.9820 | Train Acc: 0.5238
 Site-USPS                     | Train Loss: 1.8780 | Train Acc: 0.6038
 Site-USPS                     | Train Loss: 1.8691 | Train Acc: 0.6269
 Site-SynthDigits              | Train Loss: 2.1939 | Train Acc: 0.2749
 Site-SynthDigits              | Train Loss: 2.1538 | Train Acc: 0.3650
 Site-MNIST-M                  | Train Loss: 2.2411 | Train Acc: 0.2210
 Site-MNIST-M                  | Train Loss: 2.2452 | Train Acc: 0.2135
 Site-SVHN                     | Train Loss: 2.2167 | Train Acc: 0.2588
 Site-SVHN                     | Train Loss: 2.2197 | Train Acc: 0.2305
 Site-MNIST                         | Val  Loss: 1.9927 | Val  Acc: 0.5109
 Site-MNIST                         | Val  Loss: 1.9670 | Val  Acc: 0.5647
 Site-USPS                          | Val  Loss: 1.9089 | Val  Acc: 0.5326
 Site-USPS                          | Val  Loss: 1.9043 | Val  Acc: 0.5791
 Site-SynthDigits                   | Val  Loss: 2.1627 | Val  Acc: 0.3696
 Site-SynthDigits                   | Val  Loss: 2.1786 | Val  Acc: 0.3237
 Site-MNIST-M                       | Val  Loss: 2.2533 | Val  Acc: 0.2065
 Site-MNIST-M                       | Val  Loss: 2.2435 | Val  Acc: 0.2230
 Site-SVHN                          | Val  Loss: 2.2001 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.2092 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3881
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.5109
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.5647
 Best site-USPS                      | Epoch:8 | Val Acc: 0.5326
 Best site-USPS                      | Epoch:8 | Val Acc: 0.5791
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3696
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3237
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.2065
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.2230
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2770
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 9 ============
 Site-MNIST                    | Train Loss: 1.8935 | Train Acc: 0.6496
 Site-MNIST                    | Train Loss: 1.9529 | Train Acc: 0.5363
 Site-USPS                     | Train Loss: 1.8393 | Train Acc: 0.6038
 Site-USPS                     | Train Loss: 1.8309 | Train Acc: 0.6457
 Site-SynthDigits              | Train Loss: 2.1824 | Train Acc: 0.2803
 Site-SynthDigits              | Train Loss: 2.1384 | Train Acc: 0.3695
 Site-MNIST-M                  | Train Loss: 2.2318 | Train Acc: 0.2318
 Site-MNIST-M                  | Train Loss: 2.2385 | Train Acc: 0.2251
 Site-SVHN                     | Train Loss: 2.2048 | Train Acc: 0.2642
 Site-SVHN                     | Train Loss: 2.2135 | Train Acc: 0.2332
 Site-MNIST                         | Val  Loss: 1.9642 | Val  Acc: 0.5326
 Site-MNIST                         | Val  Loss: 1.9368 | Val  Acc: 0.5899
 Site-USPS                          | Val  Loss: 1.8733 | Val  Acc: 0.5435
 Site-USPS                          | Val  Loss: 1.8686 | Val  Acc: 0.5899
 Site-SynthDigits                   | Val  Loss: 2.1478 | Val  Acc: 0.3696
 Site-SynthDigits                   | Val  Loss: 2.1644 | Val  Acc: 0.3237
 Site-MNIST-M                       | Val  Loss: 2.2474 | Val  Acc: 0.2065
 Site-MNIST-M                       | Val  Loss: 2.2365 | Val  Acc: 0.2266
 Site-SVHN                          | Val  Loss: 2.1927 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.2024 | Val  Acc: 0.2806
Average Valid Accuracy: 0.3956
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.5326
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.5899
 Best site-USPS                      | Epoch:9 | Val Acc: 0.5435
 Best site-USPS                      | Epoch:9 | Val Acc: 0.5899
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3696
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3237
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.2065
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.2266
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2806
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
 Test site-MNIST                     | Epoch:9 | Test Acc: 0.5421
 Test site-USPS                      | Epoch:9 | Test Acc: 0.6237
 Test site-SynthDigits               | Epoch:9 | Test Acc: 0.3343
 Test site-MNIST-M                   | Epoch:9 | Test Acc: 0.2063
 Test site-SVHN                      | Epoch:9 | Test Acc: 0.2120
MNIST: 0.542, USPS: 0.624, SynthDigits: 0.334, MNIST-M: 0.206, SVHN: 0.212, 
Average Test Accuracy: 0.3837, domain std=0.1709, cluster std=-1.0000, individual std=0.1709, 
============ Train epoch 10 ============
 Site-MNIST                    | Train Loss: 1.8636 | Train Acc: 0.6496
 Site-MNIST                    | Train Loss: 1.9244 | Train Acc: 0.5453
 Site-USPS                     | Train Loss: 1.8005 | Train Acc: 0.6065
 Site-USPS                     | Train Loss: 1.7951 | Train Acc: 0.6439
 Site-SynthDigits              | Train Loss: 2.1702 | Train Acc: 0.2776
 Site-SynthDigits              | Train Loss: 2.1230 | Train Acc: 0.3713
 Site-MNIST-M                  | Train Loss: 2.2254 | Train Acc: 0.2453
 Site-MNIST-M                  | Train Loss: 2.2317 | Train Acc: 0.2269
 Site-SVHN                     | Train Loss: 2.2021 | Train Acc: 0.2615
 Site-SVHN                     | Train Loss: 2.2074 | Train Acc: 0.2368
 Site-MNIST                         | Val  Loss: 1.9368 | Val  Acc: 0.5326
 Site-MNIST                         | Val  Loss: 1.9076 | Val  Acc: 0.5971
 Site-USPS                          | Val  Loss: 1.8402 | Val  Acc: 0.5543
 Site-USPS                          | Val  Loss: 1.8351 | Val  Acc: 0.5863
 Site-SynthDigits                   | Val  Loss: 2.1333 | Val  Acc: 0.3696
 Site-SynthDigits                   | Val  Loss: 2.1502 | Val  Acc: 0.3201
 Site-MNIST-M                       | Val  Loss: 2.2424 | Val  Acc: 0.2065
 Site-MNIST-M                       | Val  Loss: 2.2300 | Val  Acc: 0.2410
 Site-SVHN                          | Val  Loss: 2.1856 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1959 | Val  Acc: 0.2842
Average Valid Accuracy: 0.3985
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.5326
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.5971
 Best site-USPS                      | Epoch:10 | Val Acc: 0.5543
 Best site-USPS                      | Epoch:10 | Val Acc: 0.5863
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3696
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3201
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.2065
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.2410
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2842
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 11 ============
 Site-MNIST                    | Train Loss: 1.8367 | Train Acc: 0.6604
 Site-MNIST                    | Train Loss: 1.8958 | Train Acc: 0.5578
 Site-USPS                     | Train Loss: 1.7735 | Train Acc: 0.6146
 Site-USPS                     | Train Loss: 1.7595 | Train Acc: 0.6529
 Site-SynthDigits              | Train Loss: 2.1577 | Train Acc: 0.2776
 Site-SynthDigits              | Train Loss: 2.1087 | Train Acc: 0.3767
 Site-MNIST-M                  | Train Loss: 2.2189 | Train Acc: 0.2534
 Site-MNIST-M                  | Train Loss: 2.2254 | Train Acc: 0.2350
 Site-SVHN                     | Train Loss: 2.1932 | Train Acc: 0.2615
 Site-SVHN                     | Train Loss: 2.2017 | Train Acc: 0.2377
 Site-MNIST                         | Val  Loss: 1.9101 | Val  Acc: 0.5435
 Site-MNIST                         | Val  Loss: 1.8789 | Val  Acc: 0.6043
 Site-USPS                          | Val  Loss: 1.8060 | Val  Acc: 0.5652
 Site-USPS                          | Val  Loss: 1.8013 | Val  Acc: 0.6043
 Site-SynthDigits                   | Val  Loss: 2.1201 | Val  Acc: 0.3696
 Site-SynthDigits                   | Val  Loss: 2.1373 | Val  Acc: 0.3201
 Site-MNIST-M                       | Val  Loss: 2.2371 | Val  Acc: 0.2174
 Site-MNIST-M                       | Val  Loss: 2.2237 | Val  Acc: 0.2554
 Site-SVHN                          | Val  Loss: 2.1784 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1897 | Val  Acc: 0.2806
Average Valid Accuracy: 0.4054
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.5435
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6043
 Best site-USPS                      | Epoch:11 | Val Acc: 0.5652
 Best site-USPS                      | Epoch:11 | Val Acc: 0.6043
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3696
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3201
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.2174
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.2554
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2806
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 12 ============
 Site-MNIST                    | Train Loss: 1.8053 | Train Acc: 0.6712
 Site-MNIST                    | Train Loss: 1.8712 | Train Acc: 0.5722
 Site-USPS                     | Train Loss: 1.7382 | Train Acc: 0.6226
 Site-USPS                     | Train Loss: 1.7269 | Train Acc: 0.6610
 Site-SynthDigits              | Train Loss: 2.1459 | Train Acc: 0.2911
 Site-SynthDigits              | Train Loss: 2.0938 | Train Acc: 0.3848
 Site-MNIST-M                  | Train Loss: 2.2127 | Train Acc: 0.2561
 Site-MNIST-M                  | Train Loss: 2.2185 | Train Acc: 0.2413
 Site-SVHN                     | Train Loss: 2.1908 | Train Acc: 0.2642
 Site-SVHN                     | Train Loss: 2.1958 | Train Acc: 0.2377
 Site-MNIST                         | Val  Loss: 1.8848 | Val  Acc: 0.5652
 Site-MNIST                         | Val  Loss: 1.8529 | Val  Acc: 0.6187
 Site-USPS                          | Val  Loss: 1.7760 | Val  Acc: 0.5761
 Site-USPS                          | Val  Loss: 1.7704 | Val  Acc: 0.6115
 Site-SynthDigits                   | Val  Loss: 2.1054 | Val  Acc: 0.3696
 Site-SynthDigits                   | Val  Loss: 2.1228 | Val  Acc: 0.3201
 Site-MNIST-M                       | Val  Loss: 2.2322 | Val  Acc: 0.2174
 Site-MNIST-M                       | Val  Loss: 2.2169 | Val  Acc: 0.2554
 Site-SVHN                          | Val  Loss: 2.1720 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1837 | Val  Acc: 0.2770
Average Valid Accuracy: 0.4094
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.5652
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.6187
 Best site-USPS                      | Epoch:12 | Val Acc: 0.5761
 Best site-USPS                      | Epoch:12 | Val Acc: 0.6115
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.3696
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.3201
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.2174
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.2554
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2770
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 13 ============
 Site-MNIST                    | Train Loss: 1.7767 | Train Acc: 0.6765
 Site-MNIST                    | Train Loss: 1.8466 | Train Acc: 0.5794
 Site-USPS                     | Train Loss: 1.7122 | Train Acc: 0.6307
 Site-USPS                     | Train Loss: 1.6963 | Train Acc: 0.6673
 Site-SynthDigits              | Train Loss: 2.1371 | Train Acc: 0.3046
 Site-SynthDigits              | Train Loss: 2.0795 | Train Acc: 0.3919
 Site-MNIST-M                  | Train Loss: 2.2056 | Train Acc: 0.2695
 Site-MNIST-M                  | Train Loss: 2.2122 | Train Acc: 0.2457
 Site-SVHN                     | Train Loss: 2.1882 | Train Acc: 0.2642
 Site-SVHN                     | Train Loss: 2.1907 | Train Acc: 0.2377
 Site-MNIST                         | Val  Loss: 1.8609 | Val  Acc: 0.5652
 Site-MNIST                         | Val  Loss: 1.8276 | Val  Acc: 0.6223
 Site-USPS                          | Val  Loss: 1.7479 | Val  Acc: 0.5870
 Site-USPS                          | Val  Loss: 1.7420 | Val  Acc: 0.6187
 Site-SynthDigits                   | Val  Loss: 2.0923 | Val  Acc: 0.3478
 Site-SynthDigits                   | Val  Loss: 2.1098 | Val  Acc: 0.3165
 Site-MNIST-M                       | Val  Loss: 2.2280 | Val  Acc: 0.2174
 Site-MNIST-M                       | Val  Loss: 2.2109 | Val  Acc: 0.2590
 Site-SVHN                          | Val  Loss: 2.1652 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1776 | Val  Acc: 0.2770
Average Valid Accuracy: 0.4094
============ Train epoch 14 ============
 Site-MNIST                    | Train Loss: 1.7518 | Train Acc: 0.6846
 Site-MNIST                    | Train Loss: 1.8235 | Train Acc: 0.5839
 Site-USPS                     | Train Loss: 1.6797 | Train Acc: 0.6469
 Site-USPS                     | Train Loss: 1.6670 | Train Acc: 0.6717
 Site-SynthDigits              | Train Loss: 2.1221 | Train Acc: 0.3154
 Site-SynthDigits              | Train Loss: 2.0645 | Train Acc: 0.4000
 Site-MNIST-M                  | Train Loss: 2.1988 | Train Acc: 0.2803
 Site-MNIST-M                  | Train Loss: 2.2058 | Train Acc: 0.2511
 Site-SVHN                     | Train Loss: 2.1797 | Train Acc: 0.2695
 Site-SVHN                     | Train Loss: 2.1845 | Train Acc: 0.2395
 Site-MNIST                         | Val  Loss: 1.8380 | Val  Acc: 0.5761
 Site-MNIST                         | Val  Loss: 1.8045 | Val  Acc: 0.6259
 Site-USPS                          | Val  Loss: 1.7209 | Val  Acc: 0.5978
 Site-USPS                          | Val  Loss: 1.7141 | Val  Acc: 0.6403
 Site-SynthDigits                   | Val  Loss: 2.0791 | Val  Acc: 0.3804
 Site-SynthDigits                   | Val  Loss: 2.0962 | Val  Acc: 0.3201
 Site-MNIST-M                       | Val  Loss: 2.2236 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.2041 | Val  Acc: 0.2662
 Site-SVHN                          | Val  Loss: 2.1594 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1720 | Val  Acc: 0.2806
Average Valid Accuracy: 0.4209
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.5761
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.6259
 Best site-USPS                      | Epoch:14 | Val Acc: 0.5978
 Best site-USPS                      | Epoch:14 | Val Acc: 0.6403
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.3804
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.3201
 Best site-MNIST-M                   | Epoch:14 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:14 | Val Acc: 0.2662
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.2806
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 15 ============
 Site-MNIST                    | Train Loss: 1.7320 | Train Acc: 0.6954
 Site-MNIST                    | Train Loss: 1.8025 | Train Acc: 0.5901
 Site-USPS                     | Train Loss: 1.6401 | Train Acc: 0.6631
 Site-USPS                     | Train Loss: 1.6347 | Train Acc: 0.6843
 Site-SynthDigits              | Train Loss: 2.1081 | Train Acc: 0.3154
 Site-SynthDigits              | Train Loss: 2.0513 | Train Acc: 0.4072
 Site-MNIST-M                  | Train Loss: 2.1926 | Train Acc: 0.2884
 Site-MNIST-M                  | Train Loss: 2.1986 | Train Acc: 0.2547
 Site-SVHN                     | Train Loss: 2.1762 | Train Acc: 0.2695
 Site-SVHN                     | Train Loss: 2.1795 | Train Acc: 0.2448
 Site-MNIST                         | Val  Loss: 1.8171 | Val  Acc: 0.5761
 Site-MNIST                         | Val  Loss: 1.7831 | Val  Acc: 0.6295
 Site-USPS                          | Val  Loss: 1.6910 | Val  Acc: 0.6196
 Site-USPS                          | Val  Loss: 1.6809 | Val  Acc: 0.6439
 Site-SynthDigits                   | Val  Loss: 2.0673 | Val  Acc: 0.3913
 Site-SynthDigits                   | Val  Loss: 2.0844 | Val  Acc: 0.3273
 Site-MNIST-M                       | Val  Loss: 2.2186 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 2.1979 | Val  Acc: 0.2734
 Site-SVHN                          | Val  Loss: 2.1529 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1660 | Val  Acc: 0.2878
Average Valid Accuracy: 0.4303
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.5761
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.6295
 Best site-USPS                      | Epoch:15 | Val Acc: 0.6196
 Best site-USPS                      | Epoch:15 | Val Acc: 0.6439
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.3913
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.3273
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.2734
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2878
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 16 ============
 Site-MNIST                    | Train Loss: 1.7060 | Train Acc: 0.6981
 Site-MNIST                    | Train Loss: 1.7802 | Train Acc: 0.6018
 Site-USPS                     | Train Loss: 1.6160 | Train Acc: 0.6658
 Site-USPS                     | Train Loss: 1.6085 | Train Acc: 0.6906
 Site-SynthDigits              | Train Loss: 2.0984 | Train Acc: 0.3235
 Site-SynthDigits              | Train Loss: 2.0359 | Train Acc: 0.4126
 Site-MNIST-M                  | Train Loss: 2.1865 | Train Acc: 0.2911
 Site-MNIST-M                  | Train Loss: 2.1915 | Train Acc: 0.2619
 Site-SVHN                     | Train Loss: 2.1717 | Train Acc: 0.2722
 Site-SVHN                     | Train Loss: 2.1736 | Train Acc: 0.2511
 Site-MNIST                         | Val  Loss: 1.7960 | Val  Acc: 0.5870
 Site-MNIST                         | Val  Loss: 1.7610 | Val  Acc: 0.6367
 Site-USPS                          | Val  Loss: 1.6672 | Val  Acc: 0.6196
 Site-USPS                          | Val  Loss: 1.6564 | Val  Acc: 0.6403
 Site-SynthDigits                   | Val  Loss: 2.0530 | Val  Acc: 0.4022
 Site-SynthDigits                   | Val  Loss: 2.0702 | Val  Acc: 0.3309
 Site-MNIST-M                       | Val  Loss: 2.2137 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 2.1909 | Val  Acc: 0.2662
 Site-SVHN                          | Val  Loss: 2.1466 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1600 | Val  Acc: 0.2950
Average Valid Accuracy: 0.4354
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.5870
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.6367
 Best site-USPS                      | Epoch:16 | Val Acc: 0.6196
 Best site-USPS                      | Epoch:16 | Val Acc: 0.6403
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4022
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.3309
 Best site-MNIST-M                   | Epoch:16 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:16 | Val Acc: 0.2662
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.2950
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 17 ============
 Site-MNIST                    | Train Loss: 1.6828 | Train Acc: 0.7035
 Site-MNIST                    | Train Loss: 1.7601 | Train Acc: 0.6045
 Site-USPS                     | Train Loss: 1.5952 | Train Acc: 0.6792
 Site-USPS                     | Train Loss: 1.5822 | Train Acc: 0.6951
 Site-SynthDigits              | Train Loss: 2.0851 | Train Acc: 0.3288
 Site-SynthDigits              | Train Loss: 2.0217 | Train Acc: 0.4161
 Site-MNIST-M                  | Train Loss: 2.1791 | Train Acc: 0.2884
 Site-MNIST-M                  | Train Loss: 2.1848 | Train Acc: 0.2637
 Site-SVHN                     | Train Loss: 2.1650 | Train Acc: 0.2722
 Site-SVHN                     | Train Loss: 2.1673 | Train Acc: 0.2538
 Site-MNIST                         | Val  Loss: 1.7763 | Val  Acc: 0.5870
 Site-MNIST                         | Val  Loss: 1.7411 | Val  Acc: 0.6367
 Site-USPS                          | Val  Loss: 1.6430 | Val  Acc: 0.6196
 Site-USPS                          | Val  Loss: 1.6316 | Val  Acc: 0.6475
 Site-SynthDigits                   | Val  Loss: 2.0393 | Val  Acc: 0.4022
 Site-SynthDigits                   | Val  Loss: 2.0572 | Val  Acc: 0.3381
 Site-MNIST-M                       | Val  Loss: 2.2088 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.1840 | Val  Acc: 0.2662
 Site-SVHN                          | Val  Loss: 2.1396 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1537 | Val  Acc: 0.3022
Average Valid Accuracy: 0.4354
============ Train epoch 18 ============
 Site-MNIST                    | Train Loss: 1.6646 | Train Acc: 0.7089
 Site-MNIST                    | Train Loss: 1.7411 | Train Acc: 0.6090
 Site-USPS                     | Train Loss: 1.5723 | Train Acc: 0.6765
 Site-USPS                     | Train Loss: 1.5591 | Train Acc: 0.7013
 Site-SynthDigits              | Train Loss: 2.0724 | Train Acc: 0.3477
 Site-SynthDigits              | Train Loss: 2.0078 | Train Acc: 0.4170
 Site-MNIST-M                  | Train Loss: 2.1715 | Train Acc: 0.2965
 Site-MNIST-M                  | Train Loss: 2.1785 | Train Acc: 0.2700
 Site-SVHN                     | Train Loss: 2.1629 | Train Acc: 0.2776
 Site-SVHN                     | Train Loss: 2.1616 | Train Acc: 0.2538
 Site-MNIST                         | Val  Loss: 1.7562 | Val  Acc: 0.5978
 Site-MNIST                         | Val  Loss: 1.7211 | Val  Acc: 0.6547
 Site-USPS                          | Val  Loss: 1.6205 | Val  Acc: 0.6413
 Site-USPS                          | Val  Loss: 1.6083 | Val  Acc: 0.6547
 Site-SynthDigits                   | Val  Loss: 2.0260 | Val  Acc: 0.4022
 Site-SynthDigits                   | Val  Loss: 2.0445 | Val  Acc: 0.3525
 Site-MNIST-M                       | Val  Loss: 2.2037 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.1765 | Val  Acc: 0.2842
 Site-SVHN                          | Val  Loss: 2.1329 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1477 | Val  Acc: 0.3022
Average Valid Accuracy: 0.4433
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.5978
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.6547
 Best site-USPS                      | Epoch:18 | Val Acc: 0.6413
 Best site-USPS                      | Epoch:18 | Val Acc: 0.6547
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4022
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.3525
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.2842
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3022
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 19 ============
 Site-MNIST                    | Train Loss: 1.6416 | Train Acc: 0.7089
 Site-MNIST                    | Train Loss: 1.7187 | Train Acc: 0.6188
 Site-USPS                     | Train Loss: 1.5552 | Train Acc: 0.6900
 Site-USPS                     | Train Loss: 1.5339 | Train Acc: 0.7103
 Site-SynthDigits              | Train Loss: 2.0644 | Train Acc: 0.3504
 Site-SynthDigits              | Train Loss: 1.9953 | Train Acc: 0.4143
 Site-MNIST-M                  | Train Loss: 2.1624 | Train Acc: 0.3046
 Site-MNIST-M                  | Train Loss: 2.1712 | Train Acc: 0.2762
 Site-SVHN                     | Train Loss: 2.1573 | Train Acc: 0.2776
 Site-SVHN                     | Train Loss: 2.1560 | Train Acc: 0.2556
 Site-MNIST                         | Val  Loss: 1.7359 | Val  Acc: 0.5978
 Site-MNIST                         | Val  Loss: 1.6987 | Val  Acc: 0.6511
 Site-USPS                          | Val  Loss: 1.5976 | Val  Acc: 0.6413
 Site-USPS                          | Val  Loss: 1.5834 | Val  Acc: 0.6583
 Site-SynthDigits                   | Val  Loss: 2.0139 | Val  Acc: 0.4022
 Site-SynthDigits                   | Val  Loss: 2.0329 | Val  Acc: 0.3525
 Site-MNIST-M                       | Val  Loss: 2.1966 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1693 | Val  Acc: 0.2878
 Site-SVHN                          | Val  Loss: 2.1269 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1424 | Val  Acc: 0.3022
Average Valid Accuracy: 0.4458
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.5978
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.6511
 Best site-USPS                      | Epoch:19 | Val Acc: 0.6413
 Best site-USPS                      | Epoch:19 | Val Acc: 0.6583
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4022
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.3525
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.2878
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3022
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
 Test site-MNIST                     | Epoch:19 | Test Acc: 0.6204
 Test site-USPS                      | Epoch:19 | Test Acc: 0.7161
 Test site-SynthDigits               | Epoch:19 | Test Acc: 0.3900
 Test site-MNIST-M                   | Epoch:19 | Test Acc: 0.2556
 Test site-SVHN                      | Epoch:19 | Test Acc: 0.2301
MNIST: 0.620, USPS: 0.716, SynthDigits: 0.390, MNIST-M: 0.256, SVHN: 0.230, 
Average Test Accuracy: 0.4424, domain std=0.1946, cluster std=-1.0000, individual std=0.1946, 
============ Train epoch 20 ============
 Site-MNIST                    | Train Loss: 1.6310 | Train Acc: 0.7224
 Site-MNIST                    | Train Loss: 1.7078 | Train Acc: 0.6206
 Site-USPS                     | Train Loss: 1.5268 | Train Acc: 0.6846
 Site-USPS                     | Train Loss: 1.5118 | Train Acc: 0.7130
 Site-SynthDigits              | Train Loss: 2.0511 | Train Acc: 0.3612
 Site-SynthDigits              | Train Loss: 1.9805 | Train Acc: 0.4197
 Site-MNIST-M                  | Train Loss: 2.1578 | Train Acc: 0.3127
 Site-MNIST-M                  | Train Loss: 2.1654 | Train Acc: 0.2825
 Site-SVHN                     | Train Loss: 2.1528 | Train Acc: 0.2776
 Site-SVHN                     | Train Loss: 2.1476 | Train Acc: 0.2637
 Site-MNIST                         | Val  Loss: 1.7231 | Val  Acc: 0.6087
 Site-MNIST                         | Val  Loss: 1.6893 | Val  Acc: 0.6619
 Site-USPS                          | Val  Loss: 1.5798 | Val  Acc: 0.6522
 Site-USPS                          | Val  Loss: 1.5621 | Val  Acc: 0.6727
 Site-SynthDigits                   | Val  Loss: 1.9998 | Val  Acc: 0.3913
 Site-SynthDigits                   | Val  Loss: 2.0200 | Val  Acc: 0.3561
 Site-MNIST-M                       | Val  Loss: 2.1935 | Val  Acc: 0.2174
 Site-MNIST-M                       | Val  Loss: 2.1619 | Val  Acc: 0.2986
 Site-SVHN                          | Val  Loss: 2.1141 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.1336 | Val  Acc: 0.3094
Average Valid Accuracy: 0.4494
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.6087
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.6619
 Best site-USPS                      | Epoch:20 | Val Acc: 0.6522
 Best site-USPS                      | Epoch:20 | Val Acc: 0.6727
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.3913
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.3561
 Best site-MNIST-M                   | Epoch:20 | Val Acc: 0.2174
 Best site-MNIST-M                   | Epoch:20 | Val Acc: 0.2986
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3094
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 21 ============
 Site-MNIST                    | Train Loss: 1.5980 | Train Acc: 0.7332
 Site-MNIST                    | Train Loss: 1.6859 | Train Acc: 0.6323
 Site-USPS                     | Train Loss: 1.5132 | Train Acc: 0.6981
 Site-USPS                     | Train Loss: 1.4907 | Train Acc: 0.7211
 Site-SynthDigits              | Train Loss: 2.0390 | Train Acc: 0.3558
 Site-SynthDigits              | Train Loss: 1.9666 | Train Acc: 0.4242
 Site-MNIST-M                  | Train Loss: 2.1463 | Train Acc: 0.3154
 Site-MNIST-M                  | Train Loss: 2.1585 | Train Acc: 0.2852
 Site-SVHN                     | Train Loss: 2.1438 | Train Acc: 0.2749
 Site-SVHN                     | Train Loss: 2.1416 | Train Acc: 0.2673
 Site-MNIST                         | Val  Loss: 1.7023 | Val  Acc: 0.5978
 Site-MNIST                         | Val  Loss: 1.6667 | Val  Acc: 0.6691
 Site-USPS                          | Val  Loss: 1.5590 | Val  Acc: 0.6522
 Site-USPS                          | Val  Loss: 1.5419 | Val  Acc: 0.6727
 Site-SynthDigits                   | Val  Loss: 1.9864 | Val  Acc: 0.4022
 Site-SynthDigits                   | Val  Loss: 2.0061 | Val  Acc: 0.3669
 Site-MNIST-M                       | Val  Loss: 2.1866 | Val  Acc: 0.2174
 Site-MNIST-M                       | Val  Loss: 2.1544 | Val  Acc: 0.3058
 Site-SVHN                          | Val  Loss: 2.1095 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1288 | Val  Acc: 0.2986
Average Valid Accuracy: 0.4498
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.5978
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.6691
 Best site-USPS                      | Epoch:21 | Val Acc: 0.6522
 Best site-USPS                      | Epoch:21 | Val Acc: 0.6727
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.4022
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.3669
 Best site-MNIST-M                   | Epoch:21 | Val Acc: 0.2174
 Best site-MNIST-M                   | Epoch:21 | Val Acc: 0.3058
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.2986
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 22 ============
 Site-MNIST                    | Train Loss: 1.5776 | Train Acc: 0.7332
 Site-MNIST                    | Train Loss: 1.6647 | Train Acc: 0.6475
 Site-USPS                     | Train Loss: 1.4845 | Train Acc: 0.7116
 Site-USPS                     | Train Loss: 1.4688 | Train Acc: 0.7336
 Site-SynthDigits              | Train Loss: 2.0284 | Train Acc: 0.3558
 Site-SynthDigits              | Train Loss: 1.9549 | Train Acc: 0.4287
 Site-MNIST-M                  | Train Loss: 2.1409 | Train Acc: 0.3288
 Site-MNIST-M                  | Train Loss: 2.1506 | Train Acc: 0.2897
 Site-SVHN                     | Train Loss: 2.1432 | Train Acc: 0.2803
 Site-SVHN                     | Train Loss: 2.1369 | Train Acc: 0.2646
 Site-MNIST                         | Val  Loss: 1.6825 | Val  Acc: 0.6087
 Site-MNIST                         | Val  Loss: 1.6448 | Val  Acc: 0.6727
 Site-USPS                          | Val  Loss: 1.5374 | Val  Acc: 0.6413
 Site-USPS                          | Val  Loss: 1.5193 | Val  Acc: 0.6727
 Site-SynthDigits                   | Val  Loss: 1.9752 | Val  Acc: 0.3913
 Site-SynthDigits                   | Val  Loss: 1.9957 | Val  Acc: 0.3597
 Site-MNIST-M                       | Val  Loss: 2.1793 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.1480 | Val  Acc: 0.3165
 Site-SVHN                          | Val  Loss: 2.1037 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.1245 | Val  Acc: 0.2986
Average Valid Accuracy: 0.4527
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.6087
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.6727
 Best site-USPS                      | Epoch:22 | Val Acc: 0.6413
 Best site-USPS                      | Epoch:22 | Val Acc: 0.6727
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.3913
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.3597
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.3165
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.2986
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 23 ============
 Site-MNIST                    | Train Loss: 1.5607 | Train Acc: 0.7332
 Site-MNIST                    | Train Loss: 1.6460 | Train Acc: 0.6493
 Site-USPS                     | Train Loss: 1.4681 | Train Acc: 0.7170
 Site-USPS                     | Train Loss: 1.4513 | Train Acc: 0.7408
 Site-SynthDigits              | Train Loss: 2.0181 | Train Acc: 0.3612
 Site-SynthDigits              | Train Loss: 1.9413 | Train Acc: 0.4341
 Site-MNIST-M                  | Train Loss: 2.1274 | Train Acc: 0.3369
 Site-MNIST-M                  | Train Loss: 2.1438 | Train Acc: 0.2942
 Site-SVHN                     | Train Loss: 2.1382 | Train Acc: 0.2884
 Site-SVHN                     | Train Loss: 2.1299 | Train Acc: 0.2646
 Site-MNIST                         | Val  Loss: 1.6642 | Val  Acc: 0.5978
 Site-MNIST                         | Val  Loss: 1.6271 | Val  Acc: 0.6727
 Site-USPS                          | Val  Loss: 1.5215 | Val  Acc: 0.6522
 Site-USPS                          | Val  Loss: 1.5018 | Val  Acc: 0.6871
 Site-SynthDigits                   | Val  Loss: 1.9615 | Val  Acc: 0.3913
 Site-SynthDigits                   | Val  Loss: 1.9837 | Val  Acc: 0.3633
 Site-MNIST-M                       | Val  Loss: 2.1726 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1398 | Val  Acc: 0.3165
 Site-SVHN                          | Val  Loss: 2.0971 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1186 | Val  Acc: 0.2986
Average Valid Accuracy: 0.4545
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.5978
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.6727
 Best site-USPS                      | Epoch:23 | Val Acc: 0.6522
 Best site-USPS                      | Epoch:23 | Val Acc: 0.6871
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.3913
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.3633
 Best site-MNIST-M                   | Epoch:23 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:23 | Val Acc: 0.3165
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.2986
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 24 ============
 Site-MNIST                    | Train Loss: 1.5528 | Train Acc: 0.7278
 Site-MNIST                    | Train Loss: 1.6341 | Train Acc: 0.6529
 Site-USPS                     | Train Loss: 1.4524 | Train Acc: 0.7170
 Site-USPS                     | Train Loss: 1.4349 | Train Acc: 0.7408
 Site-SynthDigits              | Train Loss: 2.0016 | Train Acc: 0.3774
 Site-SynthDigits              | Train Loss: 1.9255 | Train Acc: 0.4439
 Site-MNIST-M                  | Train Loss: 2.1231 | Train Acc: 0.3477
 Site-MNIST-M                  | Train Loss: 2.1402 | Train Acc: 0.2951
 Site-SVHN                     | Train Loss: 2.1331 | Train Acc: 0.2911
 Site-SVHN                     | Train Loss: 2.1193 | Train Acc: 0.2744
 Site-MNIST                         | Val  Loss: 1.6496 | Val  Acc: 0.6304
 Site-MNIST                         | Val  Loss: 1.6161 | Val  Acc: 0.6835
 Site-USPS                          | Val  Loss: 1.5085 | Val  Acc: 0.6522
 Site-USPS                          | Val  Loss: 1.4865 | Val  Acc: 0.6942
 Site-SynthDigits                   | Val  Loss: 1.9454 | Val  Acc: 0.4130
 Site-SynthDigits                   | Val  Loss: 1.9692 | Val  Acc: 0.3813
 Site-MNIST-M                       | Val  Loss: 2.1754 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1332 | Val  Acc: 0.3237
 Site-SVHN                          | Val  Loss: 2.0849 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1086 | Val  Acc: 0.3129
Average Valid Accuracy: 0.4657
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.6304
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.6835
 Best site-USPS                      | Epoch:24 | Val Acc: 0.6522
 Best site-USPS                      | Epoch:24 | Val Acc: 0.6942
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.4130
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.3813
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.3237
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3129
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 25 ============
 Site-MNIST                    | Train Loss: 1.5345 | Train Acc: 0.7278
 Site-MNIST                    | Train Loss: 1.6155 | Train Acc: 0.6574
 Site-USPS                     | Train Loss: 1.4327 | Train Acc: 0.7278
 Site-USPS                     | Train Loss: 1.4139 | Train Acc: 0.7489
 Site-SynthDigits              | Train Loss: 1.9891 | Train Acc: 0.3801
 Site-SynthDigits              | Train Loss: 1.9116 | Train Acc: 0.4466
 Site-MNIST-M                  | Train Loss: 2.1145 | Train Acc: 0.3558
 Site-MNIST-M                  | Train Loss: 2.1333 | Train Acc: 0.3004
 Site-SVHN                     | Train Loss: 2.1242 | Train Acc: 0.2965
 Site-SVHN                     | Train Loss: 2.1116 | Train Acc: 0.2789
 Site-MNIST                         | Val  Loss: 1.6317 | Val  Acc: 0.6304
 Site-MNIST                         | Val  Loss: 1.5980 | Val  Acc: 0.6727
 Site-USPS                          | Val  Loss: 1.4884 | Val  Acc: 0.6522
 Site-USPS                          | Val  Loss: 1.4657 | Val  Acc: 0.7050
 Site-SynthDigits                   | Val  Loss: 1.9305 | Val  Acc: 0.4130
 Site-SynthDigits                   | Val  Loss: 1.9561 | Val  Acc: 0.3885
 Site-MNIST-M                       | Val  Loss: 2.1725 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.1262 | Val  Acc: 0.3273
 Site-SVHN                          | Val  Loss: 2.0772 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1016 | Val  Acc: 0.3165
Average Valid Accuracy: 0.4649
============ Train epoch 26 ============
 Site-MNIST                    | Train Loss: 1.5162 | Train Acc: 0.7170
 Site-MNIST                    | Train Loss: 1.6015 | Train Acc: 0.6556
 Site-USPS                     | Train Loss: 1.4058 | Train Acc: 0.7278
 Site-USPS                     | Train Loss: 1.3966 | Train Acc: 0.7543
 Site-SynthDigits              | Train Loss: 1.9744 | Train Acc: 0.3801
 Site-SynthDigits              | Train Loss: 1.8952 | Train Acc: 0.4520
 Site-MNIST-M                  | Train Loss: 2.0972 | Train Acc: 0.3585
 Site-MNIST-M                  | Train Loss: 2.1280 | Train Acc: 0.2906
 Site-SVHN                     | Train Loss: 2.1170 | Train Acc: 0.2992
 Site-SVHN                     | Train Loss: 2.1014 | Train Acc: 0.2843
 Site-MNIST                         | Val  Loss: 1.6158 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.5858 | Val  Acc: 0.6835
 Site-USPS                          | Val  Loss: 1.4728 | Val  Acc: 0.6630
 Site-USPS                          | Val  Loss: 1.4485 | Val  Acc: 0.7086
 Site-SynthDigits                   | Val  Loss: 1.9094 | Val  Acc: 0.4239
 Site-SynthDigits                   | Val  Loss: 1.9397 | Val  Acc: 0.3921
 Site-MNIST-M                       | Val  Loss: 2.1724 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.1196 | Val  Acc: 0.3165
 Site-SVHN                          | Val  Loss: 2.0664 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0915 | Val  Acc: 0.3237
Average Valid Accuracy: 0.4696
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.6835
 Best site-USPS                      | Epoch:26 | Val Acc: 0.6630
 Best site-USPS                      | Epoch:26 | Val Acc: 0.7086
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.4239
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.3921
 Best site-MNIST-M                   | Epoch:26 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:26 | Val Acc: 0.3165
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.3237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 27 ============
 Site-MNIST                    | Train Loss: 1.5062 | Train Acc: 0.7278
 Site-MNIST                    | Train Loss: 1.5860 | Train Acc: 0.6475
 Site-USPS                     | Train Loss: 1.3919 | Train Acc: 0.7358
 Site-USPS                     | Train Loss: 1.3775 | Train Acc: 0.7605
 Site-SynthDigits              | Train Loss: 1.9573 | Train Acc: 0.3881
 Site-SynthDigits              | Train Loss: 1.8769 | Train Acc: 0.4610
 Site-MNIST-M                  | Train Loss: 2.0966 | Train Acc: 0.3693
 Site-MNIST-M                  | Train Loss: 2.1189 | Train Acc: 0.2996
 Site-SVHN                     | Train Loss: 2.1111 | Train Acc: 0.3019
 Site-SVHN                     | Train Loss: 2.0919 | Train Acc: 0.2924
 Site-MNIST                         | Val  Loss: 1.5993 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.5713 | Val  Acc: 0.6799
 Site-USPS                          | Val  Loss: 1.4548 | Val  Acc: 0.6630
 Site-USPS                          | Val  Loss: 1.4296 | Val  Acc: 0.7158
 Site-SynthDigits                   | Val  Loss: 1.8872 | Val  Acc: 0.4565
 Site-SynthDigits                   | Val  Loss: 1.9210 | Val  Acc: 0.4065
 Site-MNIST-M                       | Val  Loss: 2.1649 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.1098 | Val  Acc: 0.3273
 Site-SVHN                          | Val  Loss: 2.0562 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0817 | Val  Acc: 0.3273
Average Valid Accuracy: 0.4761
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.6799
 Best site-USPS                      | Epoch:27 | Val Acc: 0.6630
 Best site-USPS                      | Epoch:27 | Val Acc: 0.7158
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.4565
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.4065
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.3273
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.3273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 28 ============
 Site-MNIST                    | Train Loss: 1.4848 | Train Acc: 0.7278
 Site-MNIST                    | Train Loss: 1.5714 | Train Acc: 0.6457
 Site-USPS                     | Train Loss: 1.3783 | Train Acc: 0.7412
 Site-USPS                     | Train Loss: 1.3616 | Train Acc: 0.7561
 Site-SynthDigits              | Train Loss: 1.9396 | Train Acc: 0.3935
 Site-SynthDigits              | Train Loss: 1.8569 | Train Acc: 0.4780
 Site-MNIST-M                  | Train Loss: 2.0853 | Train Acc: 0.3558
 Site-MNIST-M                  | Train Loss: 2.1124 | Train Acc: 0.3013
 Site-SVHN                     | Train Loss: 2.1040 | Train Acc: 0.3073
 Site-SVHN                     | Train Loss: 2.0816 | Train Acc: 0.3049
 Site-MNIST                         | Val  Loss: 1.5835 | Val  Acc: 0.6304
 Site-MNIST                         | Val  Loss: 1.5576 | Val  Acc: 0.6799
 Site-USPS                          | Val  Loss: 1.4401 | Val  Acc: 0.6739
 Site-USPS                          | Val  Loss: 1.4139 | Val  Acc: 0.7050
 Site-SynthDigits                   | Val  Loss: 1.8638 | Val  Acc: 0.4457
 Site-SynthDigits                   | Val  Loss: 1.9000 | Val  Acc: 0.4137
 Site-MNIST-M                       | Val  Loss: 2.1585 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.1020 | Val  Acc: 0.3345
 Site-SVHN                          | Val  Loss: 2.0458 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 2.0719 | Val  Acc: 0.3237
Average Valid Accuracy: 0.4772
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.6304
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.6799
 Best site-USPS                      | Epoch:28 | Val Acc: 0.6739
 Best site-USPS                      | Epoch:28 | Val Acc: 0.7050
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.4457
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.4137
 Best site-MNIST-M                   | Epoch:28 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:28 | Val Acc: 0.3345
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.3237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 29 ============
 Site-MNIST                    | Train Loss: 1.4685 | Train Acc: 0.7251
 Site-MNIST                    | Train Loss: 1.5558 | Train Acc: 0.6413
 Site-USPS                     | Train Loss: 1.3527 | Train Acc: 0.7412
 Site-USPS                     | Train Loss: 1.3450 | Train Acc: 0.7605
 Site-SynthDigits              | Train Loss: 1.9205 | Train Acc: 0.3989
 Site-SynthDigits              | Train Loss: 1.8370 | Train Acc: 0.4825
 Site-MNIST-M                  | Train Loss: 2.0760 | Train Acc: 0.3612
 Site-MNIST-M                  | Train Loss: 2.1013 | Train Acc: 0.3076
 Site-SVHN                     | Train Loss: 2.0994 | Train Acc: 0.3073
 Site-SVHN                     | Train Loss: 2.0711 | Train Acc: 0.3040
 Site-MNIST                         | Val  Loss: 1.5672 | Val  Acc: 0.6196
 Site-MNIST                         | Val  Loss: 1.5422 | Val  Acc: 0.6727
 Site-USPS                          | Val  Loss: 1.4244 | Val  Acc: 0.6848
 Site-USPS                          | Val  Loss: 1.3975 | Val  Acc: 0.7194
 Site-SynthDigits                   | Val  Loss: 1.8427 | Val  Acc: 0.4565
 Site-SynthDigits                   | Val  Loss: 1.8800 | Val  Acc: 0.4245
 Site-MNIST-M                       | Val  Loss: 2.1456 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.0887 | Val  Acc: 0.3417
 Site-SVHN                          | Val  Loss: 2.0360 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 2.0635 | Val  Acc: 0.3201
Average Valid Accuracy: 0.4805
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.6196
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.6727
 Best site-USPS                      | Epoch:29 | Val Acc: 0.6848
 Best site-USPS                      | Epoch:29 | Val Acc: 0.7194
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.4565
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.4245
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.3417
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3201
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
 Test site-MNIST                     | Epoch:29 | Test Acc: 0.6491
 Test site-USPS                      | Epoch:29 | Test Acc: 0.7677
 Test site-SynthDigits               | Epoch:29 | Test Acc: 0.4504
 Test site-MNIST-M                   | Epoch:29 | Test Acc: 0.3003
 Test site-SVHN                      | Epoch:29 | Test Acc: 0.2798
MNIST: 0.649, USPS: 0.768, SynthDigits: 0.450, MNIST-M: 0.300, SVHN: 0.280, 
Average Test Accuracy: 0.4895, domain std=0.1919, cluster std=-1.0000, individual std=0.1919, 
============ Train epoch 30 ============
 Site-MNIST                    | Train Loss: 1.4561 | Train Acc: 0.7278
 Site-MNIST                    | Train Loss: 1.5416 | Train Acc: 0.6475
 Site-USPS                     | Train Loss: 1.3479 | Train Acc: 0.7520
 Site-USPS                     | Train Loss: 1.3307 | Train Acc: 0.7632
 Site-SynthDigits              | Train Loss: 1.9017 | Train Acc: 0.4124
 Site-SynthDigits              | Train Loss: 1.8182 | Train Acc: 0.4897
 Site-MNIST-M                  | Train Loss: 2.0670 | Train Acc: 0.3639
 Site-MNIST-M                  | Train Loss: 2.0909 | Train Acc: 0.3103
 Site-SVHN                     | Train Loss: 2.0871 | Train Acc: 0.3127
 Site-SVHN                     | Train Loss: 2.0620 | Train Acc: 0.3130
 Site-MNIST                         | Val  Loss: 1.5518 | Val  Acc: 0.6304
 Site-MNIST                         | Val  Loss: 1.5276 | Val  Acc: 0.6763
 Site-USPS                          | Val  Loss: 1.4109 | Val  Acc: 0.6848
 Site-USPS                          | Val  Loss: 1.3827 | Val  Acc: 0.7230
 Site-SynthDigits                   | Val  Loss: 1.8232 | Val  Acc: 0.4457
 Site-SynthDigits                   | Val  Loss: 1.8619 | Val  Acc: 0.4317
 Site-MNIST-M                       | Val  Loss: 2.1316 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.0748 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 2.0269 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0560 | Val  Acc: 0.3165
Average Valid Accuracy: 0.4819
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.6304
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.6763
 Best site-USPS                      | Epoch:30 | Val Acc: 0.6848
 Best site-USPS                      | Epoch:30 | Val Acc: 0.7230
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.4457
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.4317
 Best site-MNIST-M                   | Epoch:30 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:30 | Val Acc: 0.3561
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.3165
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 31 ============
 Site-MNIST                    | Train Loss: 1.4416 | Train Acc: 0.7305
 Site-MNIST                    | Train Loss: 1.5238 | Train Acc: 0.6529
 Site-USPS                     | Train Loss: 1.3244 | Train Acc: 0.7493
 Site-USPS                     | Train Loss: 1.3135 | Train Acc: 0.7686
 Site-SynthDigits              | Train Loss: 1.8910 | Train Acc: 0.4151
 Site-SynthDigits              | Train Loss: 1.8041 | Train Acc: 0.4951
 Site-MNIST-M                  | Train Loss: 2.0478 | Train Acc: 0.3693
 Site-MNIST-M                  | Train Loss: 2.0794 | Train Acc: 0.3193
 Site-SVHN                     | Train Loss: 2.0836 | Train Acc: 0.3100
 Site-SVHN                     | Train Loss: 2.0552 | Train Acc: 0.3148
 Site-MNIST                         | Val  Loss: 1.5343 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.5100 | Val  Acc: 0.6942
 Site-USPS                          | Val  Loss: 1.3944 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.3649 | Val  Acc: 0.7302
 Site-SynthDigits                   | Val  Loss: 1.8083 | Val  Acc: 0.4565
 Site-SynthDigits                   | Val  Loss: 1.8472 | Val  Acc: 0.4424
 Site-MNIST-M                       | Val  Loss: 2.1180 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.0606 | Val  Acc: 0.3633
 Site-SVHN                          | Val  Loss: 2.0179 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0486 | Val  Acc: 0.3201
Average Valid Accuracy: 0.4920
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.6630
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.6942
 Best site-USPS                      | Epoch:31 | Val Acc: 0.6957
 Best site-USPS                      | Epoch:31 | Val Acc: 0.7302
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.4565
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.4424
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.3633
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.3201
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 32 ============
 Site-MNIST                    | Train Loss: 1.4186 | Train Acc: 0.7170
 Site-MNIST                    | Train Loss: 1.5129 | Train Acc: 0.6430
 Site-USPS                     | Train Loss: 1.3268 | Train Acc: 0.7547
 Site-USPS                     | Train Loss: 1.3119 | Train Acc: 0.7587
 Site-SynthDigits              | Train Loss: 1.8744 | Train Acc: 0.4232
 Site-SynthDigits              | Train Loss: 1.7837 | Train Acc: 0.5085
 Site-MNIST-M                  | Train Loss: 2.0433 | Train Acc: 0.3639
 Site-MNIST-M                  | Train Loss: 2.0741 | Train Acc: 0.3139
 Site-SVHN                     | Train Loss: 2.0765 | Train Acc: 0.3181
 Site-SVHN                     | Train Loss: 2.0457 | Train Acc: 0.3193
 Site-MNIST                         | Val  Loss: 1.5199 | Val  Acc: 0.6522
 Site-MNIST                         | Val  Loss: 1.4979 | Val  Acc: 0.6799
 Site-USPS                          | Val  Loss: 1.3929 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.3632 | Val  Acc: 0.7230
 Site-SynthDigits                   | Val  Loss: 1.7882 | Val  Acc: 0.4565
 Site-SynthDigits                   | Val  Loss: 1.8261 | Val  Acc: 0.4424
 Site-MNIST-M                       | Val  Loss: 2.1072 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.0532 | Val  Acc: 0.3597
 Site-SVHN                          | Val  Loss: 2.0100 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0418 | Val  Acc: 0.3273
Average Valid Accuracy: 0.4891
============ Train epoch 33 ============
 Site-MNIST                    | Train Loss: 1.4047 | Train Acc: 0.7278
 Site-MNIST                    | Train Loss: 1.4940 | Train Acc: 0.6538
 Site-USPS                     | Train Loss: 1.3034 | Train Acc: 0.7655
 Site-USPS                     | Train Loss: 1.2902 | Train Acc: 0.7695
 Site-SynthDigits              | Train Loss: 1.8610 | Train Acc: 0.4232
 Site-SynthDigits              | Train Loss: 1.7708 | Train Acc: 0.5094
 Site-MNIST-M                  | Train Loss: 2.0318 | Train Acc: 0.3666
 Site-MNIST-M                  | Train Loss: 2.0635 | Train Acc: 0.3220
 Site-SVHN                     | Train Loss: 2.0706 | Train Acc: 0.3235
 Site-SVHN                     | Train Loss: 2.0391 | Train Acc: 0.3238
 Site-MNIST                         | Val  Loss: 1.5020 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.4785 | Val  Acc: 0.6942
 Site-USPS                          | Val  Loss: 1.3726 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.3417 | Val  Acc: 0.7446
 Site-SynthDigits                   | Val  Loss: 1.7769 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.8150 | Val  Acc: 0.4460
 Site-MNIST-M                       | Val  Loss: 2.0954 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.0401 | Val  Acc: 0.3633
 Site-SVHN                          | Val  Loss: 2.0010 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.0347 | Val  Acc: 0.3453
Average Valid Accuracy: 0.5017
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.6739
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.6942
 Best site-USPS                      | Epoch:33 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:33 | Val Acc: 0.7446
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.4674
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.4460
 Best site-MNIST-M                   | Epoch:33 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:33 | Val Acc: 0.3633
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.3453
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 34 ============
 Site-MNIST                    | Train Loss: 1.3869 | Train Acc: 0.7224
 Site-MNIST                    | Train Loss: 1.4795 | Train Acc: 0.6547
 Site-USPS                     | Train Loss: 1.2976 | Train Acc: 0.7655
 Site-USPS                     | Train Loss: 1.2818 | Train Acc: 0.7722
 Site-SynthDigits              | Train Loss: 1.8480 | Train Acc: 0.4420
 Site-SynthDigits              | Train Loss: 1.7569 | Train Acc: 0.5148
 Site-MNIST-M                  | Train Loss: 2.0255 | Train Acc: 0.3639
 Site-MNIST-M                  | Train Loss: 2.0557 | Train Acc: 0.3247
 Site-SVHN                     | Train Loss: 2.0591 | Train Acc: 0.3235
 Site-SVHN                     | Train Loss: 2.0306 | Train Acc: 0.3274
 Site-MNIST                         | Val  Loss: 1.4864 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.4637 | Val  Acc: 0.6835
 Site-USPS                          | Val  Loss: 1.3648 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.3322 | Val  Acc: 0.7410
 Site-SynthDigits                   | Val  Loss: 1.7624 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.7999 | Val  Acc: 0.4676
 Site-MNIST-M                       | Val  Loss: 2.0871 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.0313 | Val  Acc: 0.3597
 Site-SVHN                          | Val  Loss: 1.9935 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.0274 | Val  Acc: 0.3453
Average Valid Accuracy: 0.4999
============ Train epoch 35 ============
 Site-MNIST                    | Train Loss: 1.3687 | Train Acc: 0.7278
 Site-MNIST                    | Train Loss: 1.4615 | Train Acc: 0.6565
 Site-USPS                     | Train Loss: 1.2746 | Train Acc: 0.7736
 Site-USPS                     | Train Loss: 1.2647 | Train Acc: 0.7767
 Site-SynthDigits              | Train Loss: 1.8355 | Train Acc: 0.4367
 Site-SynthDigits              | Train Loss: 1.7445 | Train Acc: 0.5157
 Site-MNIST-M                  | Train Loss: 2.0174 | Train Acc: 0.3666
 Site-MNIST-M                  | Train Loss: 2.0471 | Train Acc: 0.3238
 Site-SVHN                     | Train Loss: 2.0630 | Train Acc: 0.3208
 Site-SVHN                     | Train Loss: 2.0249 | Train Acc: 0.3291
 Site-MNIST                         | Val  Loss: 1.4693 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.4454 | Val  Acc: 0.7014
 Site-USPS                          | Val  Loss: 1.3495 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.3169 | Val  Acc: 0.7482
 Site-SynthDigits                   | Val  Loss: 1.7520 | Val  Acc: 0.4457
 Site-SynthDigits                   | Val  Loss: 1.7889 | Val  Acc: 0.4496
 Site-MNIST-M                       | Val  Loss: 2.0777 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.0215 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 1.9879 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.0230 | Val  Acc: 0.3453
Average Valid Accuracy: 0.4992
============ Train epoch 36 ============
 Site-MNIST                    | Train Loss: 1.3546 | Train Acc: 0.7251
 Site-MNIST                    | Train Loss: 1.4512 | Train Acc: 0.6601
 Site-USPS                     | Train Loss: 1.2708 | Train Acc: 0.7682
 Site-USPS                     | Train Loss: 1.2562 | Train Acc: 0.7695
 Site-SynthDigits              | Train Loss: 1.8178 | Train Acc: 0.4474
 Site-SynthDigits              | Train Loss: 1.7295 | Train Acc: 0.5211
 Site-MNIST-M                  | Train Loss: 2.0134 | Train Acc: 0.3747
 Site-MNIST-M                  | Train Loss: 2.0428 | Train Acc: 0.3238
 Site-SVHN                     | Train Loss: 2.0472 | Train Acc: 0.3208
 Site-SVHN                     | Train Loss: 2.0153 | Train Acc: 0.3327
 Site-MNIST                         | Val  Loss: 1.4561 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.4345 | Val  Acc: 0.6835
 Site-USPS                          | Val  Loss: 1.3424 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.3095 | Val  Acc: 0.7410
 Site-SynthDigits                   | Val  Loss: 1.7363 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.7731 | Val  Acc: 0.4748
 Site-MNIST-M                       | Val  Loss: 2.0741 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.0167 | Val  Acc: 0.3525
 Site-SVHN                          | Val  Loss: 1.9772 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 2.0130 | Val  Acc: 0.3525
Average Valid Accuracy: 0.5050
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.6630
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.6835
 Best site-USPS                      | Epoch:36 | Val Acc: 0.6957
 Best site-USPS                      | Epoch:36 | Val Acc: 0.7410
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.4748
 Best site-MNIST-M                   | Epoch:36 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:36 | Val Acc: 0.3525
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.3525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 37 ============
 Site-MNIST                    | Train Loss: 1.3517 | Train Acc: 0.7358
 Site-MNIST                    | Train Loss: 1.4383 | Train Acc: 0.6628
 Site-USPS                     | Train Loss: 1.2603 | Train Acc: 0.7655
 Site-USPS                     | Train Loss: 1.2467 | Train Acc: 0.7713
 Site-SynthDigits              | Train Loss: 1.8109 | Train Acc: 0.4447
 Site-SynthDigits              | Train Loss: 1.7157 | Train Acc: 0.5256
 Site-MNIST-M                  | Train Loss: 2.0025 | Train Acc: 0.3827
 Site-MNIST-M                  | Train Loss: 2.0358 | Train Acc: 0.3309
 Site-SVHN                     | Train Loss: 2.0451 | Train Acc: 0.3208
 Site-SVHN                     | Train Loss: 2.0087 | Train Acc: 0.3372
 Site-MNIST                         | Val  Loss: 1.4420 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 1.4211 | Val  Acc: 0.6942
 Site-USPS                          | Val  Loss: 1.3332 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.2983 | Val  Acc: 0.7482
 Site-SynthDigits                   | Val  Loss: 1.7228 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.7603 | Val  Acc: 0.4640
 Site-MNIST-M                       | Val  Loss: 2.0650 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 2.0086 | Val  Acc: 0.3669
 Site-SVHN                          | Val  Loss: 1.9684 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 2.0054 | Val  Acc: 0.3525
Average Valid Accuracy: 0.5072
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.6942
 Best site-USPS                      | Epoch:37 | Val Acc: 0.6957
 Best site-USPS                      | Epoch:37 | Val Acc: 0.7482
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.4674
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.4640
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.3669
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.3525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 38 ============
 Site-MNIST                    | Train Loss: 1.3384 | Train Acc: 0.7278
 Site-MNIST                    | Train Loss: 1.4257 | Train Acc: 0.6673
 Site-USPS                     | Train Loss: 1.2537 | Train Acc: 0.7682
 Site-USPS                     | Train Loss: 1.2366 | Train Acc: 0.7686
 Site-SynthDigits              | Train Loss: 1.7979 | Train Acc: 0.4474
 Site-SynthDigits              | Train Loss: 1.7022 | Train Acc: 0.5300
 Site-MNIST-M                  | Train Loss: 1.9900 | Train Acc: 0.3854
 Site-MNIST-M                  | Train Loss: 2.0289 | Train Acc: 0.3327
 Site-SVHN                     | Train Loss: 2.0411 | Train Acc: 0.3261
 Site-SVHN                     | Train Loss: 2.0020 | Train Acc: 0.3363
 Site-MNIST                         | Val  Loss: 1.4282 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 1.4079 | Val  Acc: 0.6978
 Site-USPS                          | Val  Loss: 1.3258 | Val  Acc: 0.6848
 Site-USPS                          | Val  Loss: 1.2893 | Val  Acc: 0.7446
 Site-SynthDigits                   | Val  Loss: 1.7118 | Val  Acc: 0.4783
 Site-SynthDigits                   | Val  Loss: 1.7473 | Val  Acc: 0.4748
 Site-MNIST-M                       | Val  Loss: 2.0571 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 1.9998 | Val  Acc: 0.3705
 Site-SVHN                          | Val  Loss: 1.9638 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 2.0004 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5093
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.6978
 Best site-USPS                      | Epoch:38 | Val Acc: 0.6848
 Best site-USPS                      | Epoch:38 | Val Acc: 0.7446
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.4783
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.4748
 Best site-MNIST-M                   | Epoch:38 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:38 | Val Acc: 0.3705
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.3597
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 39 ============
 Site-MNIST                    | Train Loss: 1.3218 | Train Acc: 0.7412
 Site-MNIST                    | Train Loss: 1.4095 | Train Acc: 0.6709
 Site-USPS                     | Train Loss: 1.2303 | Train Acc: 0.7763
 Site-USPS                     | Train Loss: 1.2218 | Train Acc: 0.7740
 Site-SynthDigits              | Train Loss: 1.7876 | Train Acc: 0.4420
 Site-SynthDigits              | Train Loss: 1.6946 | Train Acc: 0.5309
 Site-MNIST-M                  | Train Loss: 1.9763 | Train Acc: 0.3989
 Site-MNIST-M                  | Train Loss: 2.0195 | Train Acc: 0.3408
 Site-SVHN                     | Train Loss: 2.0327 | Train Acc: 0.3235
 Site-SVHN                     | Train Loss: 1.9971 | Train Acc: 0.3354
 Site-MNIST                         | Val  Loss: 1.4128 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 1.3918 | Val  Acc: 0.7122
 Site-USPS                          | Val  Loss: 1.3107 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 1.2739 | Val  Acc: 0.7626
 Site-SynthDigits                   | Val  Loss: 1.7017 | Val  Acc: 0.4891
 Site-SynthDigits                   | Val  Loss: 1.7384 | Val  Acc: 0.4820
 Site-MNIST-M                       | Val  Loss: 2.0484 | Val  Acc: 0.2717
 Site-MNIST-M                       | Val  Loss: 1.9896 | Val  Acc: 0.3885
 Site-SVHN                          | Val  Loss: 1.9574 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 1.9951 | Val  Acc: 0.3489
Average Valid Accuracy: 0.5205
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.7122
 Best site-USPS                      | Epoch:39 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:39 | Val Acc: 0.7626
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.4891
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.4820
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.2717
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.3885
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.3489
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
 Test site-MNIST                     | Epoch:39 | Test Acc: 0.6844
 Test site-USPS                      | Epoch:39 | Test Acc: 0.7839
 Test site-SynthDigits               | Epoch:39 | Test Acc: 0.4967
 Test site-MNIST-M                   | Epoch:39 | Test Acc: 0.3397
 Test site-SVHN                      | Epoch:39 | Test Acc: 0.3002
MNIST: 0.684, USPS: 0.784, SynthDigits: 0.497, MNIST-M: 0.340, SVHN: 0.300, 
Average Test Accuracy: 0.5210, domain std=0.1887, cluster std=-1.0000, individual std=0.1887, 
============ Train epoch 40 ============
 Site-MNIST                    | Train Loss: 1.2993 | Train Acc: 0.7439
 Site-MNIST                    | Train Loss: 1.3921 | Train Acc: 0.6780
 Site-USPS                     | Train Loss: 1.2123 | Train Acc: 0.7844
 Site-USPS                     | Train Loss: 1.2042 | Train Acc: 0.7803
 Site-SynthDigits              | Train Loss: 1.7773 | Train Acc: 0.4474
 Site-SynthDigits              | Train Loss: 1.6859 | Train Acc: 0.5309
 Site-MNIST-M                  | Train Loss: 1.9651 | Train Acc: 0.4043
 Site-MNIST-M                  | Train Loss: 2.0056 | Train Acc: 0.3561
 Site-SVHN                     | Train Loss: 2.0297 | Train Acc: 0.3288
 Site-SVHN                     | Train Loss: 1.9943 | Train Acc: 0.3363
 Site-MNIST                         | Val  Loss: 1.3971 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.3744 | Val  Acc: 0.7194
 Site-USPS                          | Val  Loss: 1.2929 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.2556 | Val  Acc: 0.7590
 Site-SynthDigits                   | Val  Loss: 1.6940 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.7325 | Val  Acc: 0.4820
 Site-MNIST-M                       | Val  Loss: 2.0364 | Val  Acc: 0.2935
 Site-MNIST-M                       | Val  Loss: 1.9752 | Val  Acc: 0.3993
 Site-SVHN                          | Val  Loss: 1.9520 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 1.9901 | Val  Acc: 0.3561
Average Valid Accuracy: 0.5270
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.7194
 Best site-USPS                      | Epoch:40 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:40 | Val Acc: 0.7590
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.4820
 Best site-MNIST-M                   | Epoch:40 | Val Acc: 0.2935
 Best site-MNIST-M                   | Epoch:40 | Val Acc: 0.3993
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.3561
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 41 ============
 Site-MNIST                    | Train Loss: 1.2882 | Train Acc: 0.7466
 Site-MNIST                    | Train Loss: 1.3832 | Train Acc: 0.6717
 Site-USPS                     | Train Loss: 1.2203 | Train Acc: 0.7709
 Site-USPS                     | Train Loss: 1.2048 | Train Acc: 0.7713
 Site-SynthDigits              | Train Loss: 1.7652 | Train Acc: 0.4394
 Site-SynthDigits              | Train Loss: 1.6711 | Train Acc: 0.5354
 Site-MNIST-M                  | Train Loss: 1.9699 | Train Acc: 0.4070
 Site-MNIST-M                  | Train Loss: 2.0040 | Train Acc: 0.3543
 Site-SVHN                     | Train Loss: 2.0176 | Train Acc: 0.3369
 Site-SVHN                     | Train Loss: 1.9859 | Train Acc: 0.3363
 Site-MNIST                         | Val  Loss: 1.3853 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.3654 | Val  Acc: 0.7122
 Site-USPS                          | Val  Loss: 1.2965 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.2569 | Val  Acc: 0.7518
 Site-SynthDigits                   | Val  Loss: 1.6804 | Val  Acc: 0.5217
 Site-SynthDigits                   | Val  Loss: 1.7158 | Val  Acc: 0.4892
 Site-MNIST-M                       | Val  Loss: 2.0338 | Val  Acc: 0.3043
 Site-MNIST-M                       | Val  Loss: 1.9726 | Val  Acc: 0.4029
 Site-SVHN                          | Val  Loss: 1.9452 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 1.9835 | Val  Acc: 0.3489
Average Valid Accuracy: 0.5281
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.7122
 Best site-USPS                      | Epoch:41 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:41 | Val Acc: 0.7518
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.5217
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.4892
 Best site-MNIST-M                   | Epoch:41 | Val Acc: 0.3043
 Best site-MNIST-M                   | Epoch:41 | Val Acc: 0.4029
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.3489
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 42 ============
 Site-MNIST                    | Train Loss: 1.2840 | Train Acc: 0.7466
 Site-MNIST                    | Train Loss: 1.3717 | Train Acc: 0.6735
 Site-USPS                     | Train Loss: 1.2079 | Train Acc: 0.7763
 Site-USPS                     | Train Loss: 1.1920 | Train Acc: 0.7731
 Site-SynthDigits              | Train Loss: 1.7572 | Train Acc: 0.4447
 Site-SynthDigits              | Train Loss: 1.6635 | Train Acc: 0.5390
 Site-MNIST-M                  | Train Loss: 1.9515 | Train Acc: 0.4151
 Site-MNIST-M                  | Train Loss: 1.9956 | Train Acc: 0.3587
 Site-SVHN                     | Train Loss: 2.0158 | Train Acc: 0.3396
 Site-SVHN                     | Train Loss: 1.9791 | Train Acc: 0.3363
 Site-MNIST                         | Val  Loss: 1.3725 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.3524 | Val  Acc: 0.7194
 Site-USPS                          | Val  Loss: 1.2832 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.2436 | Val  Acc: 0.7518
 Site-SynthDigits                   | Val  Loss: 1.6720 | Val  Acc: 0.5217
 Site-SynthDigits                   | Val  Loss: 1.7077 | Val  Acc: 0.4928
 Site-MNIST-M                       | Val  Loss: 2.0261 | Val  Acc: 0.3152
 Site-MNIST-M                       | Val  Loss: 1.9626 | Val  Acc: 0.4065
 Site-SVHN                          | Val  Loss: 1.9382 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 1.9773 | Val  Acc: 0.3561
Average Valid Accuracy: 0.5314
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.7194
 Best site-USPS                      | Epoch:42 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:42 | Val Acc: 0.7518
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.5217
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.4928
 Best site-MNIST-M                   | Epoch:42 | Val Acc: 0.3152
 Best site-MNIST-M                   | Epoch:42 | Val Acc: 0.4065
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.3561
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 43 ============
 Site-MNIST                    | Train Loss: 1.2705 | Train Acc: 0.7466
 Site-MNIST                    | Train Loss: 1.3628 | Train Acc: 0.6717
 Site-USPS                     | Train Loss: 1.2033 | Train Acc: 0.7682
 Site-USPS                     | Train Loss: 1.1898 | Train Acc: 0.7722
 Site-SynthDigits              | Train Loss: 1.7387 | Train Acc: 0.4474
 Site-SynthDigits              | Train Loss: 1.6481 | Train Acc: 0.5408
 Site-MNIST-M                  | Train Loss: 1.9577 | Train Acc: 0.4124
 Site-MNIST-M                  | Train Loss: 1.9946 | Train Acc: 0.3525
 Site-SVHN                     | Train Loss: 2.0101 | Train Acc: 0.3423
 Site-SVHN                     | Train Loss: 1.9701 | Train Acc: 0.3399
 Site-MNIST                         | Val  Loss: 1.3621 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.3438 | Val  Acc: 0.7230
 Site-USPS                          | Val  Loss: 1.2830 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.2404 | Val  Acc: 0.7410
 Site-SynthDigits                   | Val  Loss: 1.6597 | Val  Acc: 0.5326
 Site-SynthDigits                   | Val  Loss: 1.6936 | Val  Acc: 0.4964
 Site-MNIST-M                       | Val  Loss: 2.0217 | Val  Acc: 0.3152
 Site-MNIST-M                       | Val  Loss: 1.9609 | Val  Acc: 0.4101
 Site-SVHN                          | Val  Loss: 1.9318 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 1.9716 | Val  Acc: 0.3633
Average Valid Accuracy: 0.5332
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.7230
 Best site-USPS                      | Epoch:43 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:43 | Val Acc: 0.7410
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.5326
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.4964
 Best site-MNIST-M                   | Epoch:43 | Val Acc: 0.3152
 Best site-MNIST-M                   | Epoch:43 | Val Acc: 0.4101
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.3633
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 44 ============
 Site-MNIST                    | Train Loss: 1.2585 | Train Acc: 0.7412
 Site-MNIST                    | Train Loss: 1.3486 | Train Acc: 0.6735
 Site-USPS                     | Train Loss: 1.1931 | Train Acc: 0.7736
 Site-USPS                     | Train Loss: 1.1754 | Train Acc: 0.7740
 Site-SynthDigits              | Train Loss: 1.7377 | Train Acc: 0.4528
 Site-SynthDigits              | Train Loss: 1.6392 | Train Acc: 0.5453
 Site-MNIST-M                  | Train Loss: 1.9494 | Train Acc: 0.4151
 Site-MNIST-M                  | Train Loss: 1.9840 | Train Acc: 0.3641
 Site-SVHN                     | Train Loss: 2.0084 | Train Acc: 0.3369
 Site-SVHN                     | Train Loss: 1.9688 | Train Acc: 0.3417
 Site-MNIST                         | Val  Loss: 1.3477 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 1.3286 | Val  Acc: 0.7194
 Site-USPS                          | Val  Loss: 1.2680 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 1.2257 | Val  Acc: 0.7518
 Site-SynthDigits                   | Val  Loss: 1.6524 | Val  Acc: 0.5435
 Site-SynthDigits                   | Val  Loss: 1.6856 | Val  Acc: 0.5108
 Site-MNIST-M                       | Val  Loss: 2.0116 | Val  Acc: 0.3261
 Site-MNIST-M                       | Val  Loss: 1.9495 | Val  Acc: 0.4209
 Site-SVHN                          | Val  Loss: 1.9293 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 1.9682 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5382
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.7194
 Best site-USPS                      | Epoch:44 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:44 | Val Acc: 0.7518
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.5435
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.5108
 Best site-MNIST-M                   | Epoch:44 | Val Acc: 0.3261
 Best site-MNIST-M                   | Epoch:44 | Val Acc: 0.4209
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.3597
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 45 ============
 Site-MNIST                    | Train Loss: 1.2447 | Train Acc: 0.7439
 Site-MNIST                    | Train Loss: 1.3408 | Train Acc: 0.6771
 Site-USPS                     | Train Loss: 1.1725 | Train Acc: 0.7763
 Site-USPS                     | Train Loss: 1.1683 | Train Acc: 0.7731
 Site-SynthDigits              | Train Loss: 1.7239 | Train Acc: 0.4582
 Site-SynthDigits              | Train Loss: 1.6257 | Train Acc: 0.5507
 Site-MNIST-M                  | Train Loss: 1.9483 | Train Acc: 0.4178
 Site-MNIST-M                  | Train Loss: 1.9857 | Train Acc: 0.3578
 Site-SVHN                     | Train Loss: 1.9974 | Train Acc: 0.3396
 Site-SVHN                     | Train Loss: 1.9584 | Train Acc: 0.3453
 Site-MNIST                         | Val  Loss: 1.3373 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 1.3197 | Val  Acc: 0.7266
 Site-USPS                          | Val  Loss: 1.2634 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.2190 | Val  Acc: 0.7518
 Site-SynthDigits                   | Val  Loss: 1.6392 | Val  Acc: 0.5435
 Site-SynthDigits                   | Val  Loss: 1.6711 | Val  Acc: 0.5072
 Site-MNIST-M                       | Val  Loss: 2.0146 | Val  Acc: 0.3370
 Site-MNIST-M                       | Val  Loss: 1.9522 | Val  Acc: 0.4281
 Site-SVHN                          | Val  Loss: 1.9159 | Val  Acc: 0.3478
 Site-SVHN                          | Val  Loss: 1.9587 | Val  Acc: 0.3561
Average Valid Accuracy: 0.5411
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.7266
 Best site-USPS                      | Epoch:45 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:45 | Val Acc: 0.7518
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.5435
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.5072
 Best site-MNIST-M                   | Epoch:45 | Val Acc: 0.3370
 Best site-MNIST-M                   | Epoch:45 | Val Acc: 0.4281
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.3478
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.3561
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 46 ============
 Site-MNIST                    | Train Loss: 1.2367 | Train Acc: 0.7466
 Site-MNIST                    | Train Loss: 1.3301 | Train Acc: 0.6789
 Site-USPS                     | Train Loss: 1.1800 | Train Acc: 0.7682
 Site-USPS                     | Train Loss: 1.1657 | Train Acc: 0.7749
 Site-SynthDigits              | Train Loss: 1.7188 | Train Acc: 0.4690
 Site-SynthDigits              | Train Loss: 1.6173 | Train Acc: 0.5471
 Site-MNIST-M                  | Train Loss: 1.9409 | Train Acc: 0.4151
 Site-MNIST-M                  | Train Loss: 1.9777 | Train Acc: 0.3641
 Site-SVHN                     | Train Loss: 1.9909 | Train Acc: 0.3450
 Site-SVHN                     | Train Loss: 1.9524 | Train Acc: 0.3471
 Site-MNIST                         | Val  Loss: 1.3267 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 1.3098 | Val  Acc: 0.7266
 Site-USPS                          | Val  Loss: 1.2612 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.2148 | Val  Acc: 0.7518
 Site-SynthDigits                   | Val  Loss: 1.6321 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.6628 | Val  Acc: 0.5000
 Site-MNIST-M                       | Val  Loss: 2.0056 | Val  Acc: 0.3370
 Site-MNIST-M                       | Val  Loss: 1.9430 | Val  Acc: 0.4245
 Site-SVHN                          | Val  Loss: 1.9130 | Val  Acc: 0.3478
 Site-SVHN                          | Val  Loss: 1.9550 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5371
============ Train epoch 47 ============
 Site-MNIST                    | Train Loss: 1.2208 | Train Acc: 0.7466
 Site-MNIST                    | Train Loss: 1.3174 | Train Acc: 0.6789
 Site-USPS                     | Train Loss: 1.1591 | Train Acc: 0.7709
 Site-USPS                     | Train Loss: 1.1479 | Train Acc: 0.7758
 Site-SynthDigits              | Train Loss: 1.7110 | Train Acc: 0.4717
 Site-SynthDigits              | Train Loss: 1.6107 | Train Acc: 0.5498
 Site-MNIST-M                  | Train Loss: 1.9293 | Train Acc: 0.4232
 Site-MNIST-M                  | Train Loss: 1.9687 | Train Acc: 0.3722
 Site-SVHN                     | Train Loss: 1.9873 | Train Acc: 0.3477
 Site-SVHN                     | Train Loss: 1.9471 | Train Acc: 0.3471
 Site-MNIST                         | Val  Loss: 1.3142 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.2971 | Val  Acc: 0.7302
 Site-USPS                          | Val  Loss: 1.2452 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.1988 | Val  Acc: 0.7518
 Site-SynthDigits                   | Val  Loss: 1.6270 | Val  Acc: 0.5326
 Site-SynthDigits                   | Val  Loss: 1.6567 | Val  Acc: 0.5180
 Site-MNIST-M                       | Val  Loss: 1.9973 | Val  Acc: 0.3478
 Site-MNIST-M                       | Val  Loss: 1.9335 | Val  Acc: 0.4317
 Site-SVHN                          | Val  Loss: 1.9065 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 1.9487 | Val  Acc: 0.3561
Average Valid Accuracy: 0.5429
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.7302
 Best site-USPS                      | Epoch:47 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:47 | Val Acc: 0.7518
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5326
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5180
 Best site-MNIST-M                   | Epoch:47 | Val Acc: 0.3478
 Best site-MNIST-M                   | Epoch:47 | Val Acc: 0.4317
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.3561
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 48 ============
 Site-MNIST                    | Train Loss: 1.2089 | Train Acc: 0.7493
 Site-MNIST                    | Train Loss: 1.3007 | Train Acc: 0.6870
 Site-USPS                     | Train Loss: 1.1452 | Train Acc: 0.7817
 Site-USPS                     | Train Loss: 1.1322 | Train Acc: 0.7857
 Site-SynthDigits              | Train Loss: 1.7059 | Train Acc: 0.4609
 Site-SynthDigits              | Train Loss: 1.6049 | Train Acc: 0.5435
 Site-MNIST-M                  | Train Loss: 1.9096 | Train Acc: 0.4259
 Site-MNIST-M                  | Train Loss: 1.9557 | Train Acc: 0.3776
 Site-SVHN                     | Train Loss: 1.9945 | Train Acc: 0.3450
 Site-SVHN                     | Train Loss: 1.9450 | Train Acc: 0.3471
 Site-MNIST                         | Val  Loss: 1.2991 | Val  Acc: 0.7283
 Site-MNIST                         | Val  Loss: 1.2804 | Val  Acc: 0.7338
 Site-USPS                          | Val  Loss: 1.2271 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 1.1817 | Val  Acc: 0.7662
 Site-SynthDigits                   | Val  Loss: 1.6208 | Val  Acc: 0.5435
 Site-SynthDigits                   | Val  Loss: 1.6522 | Val  Acc: 0.5144
 Site-MNIST-M                       | Val  Loss: 1.9846 | Val  Acc: 0.3696
 Site-MNIST-M                       | Val  Loss: 1.9203 | Val  Acc: 0.4424
 Site-SVHN                          | Val  Loss: 1.9026 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 1.9467 | Val  Acc: 0.3381
Average Valid Accuracy: 0.5491
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.7283
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.7338
 Best site-USPS                      | Epoch:48 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:48 | Val Acc: 0.7662
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.5435
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.5144
 Best site-MNIST-M                   | Epoch:48 | Val Acc: 0.3696
 Best site-MNIST-M                   | Epoch:48 | Val Acc: 0.4424
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.3381
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 49 ============
 Site-MNIST                    | Train Loss: 1.1947 | Train Acc: 0.7547
 Site-MNIST                    | Train Loss: 1.2865 | Train Acc: 0.6951
 Site-USPS                     | Train Loss: 1.1326 | Train Acc: 0.7844
 Site-USPS                     | Train Loss: 1.1209 | Train Acc: 0.7874
 Site-SynthDigits              | Train Loss: 1.6995 | Train Acc: 0.4663
 Site-SynthDigits              | Train Loss: 1.6006 | Train Acc: 0.5471
 Site-MNIST-M                  | Train Loss: 1.8971 | Train Acc: 0.4259
 Site-MNIST-M                  | Train Loss: 1.9427 | Train Acc: 0.3874
 Site-SVHN                     | Train Loss: 1.9861 | Train Acc: 0.3477
 Site-SVHN                     | Train Loss: 1.9436 | Train Acc: 0.3462
 Site-MNIST                         | Val  Loss: 1.2854 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.2658 | Val  Acc: 0.7446
 Site-USPS                          | Val  Loss: 1.2152 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 1.1703 | Val  Acc: 0.7662
 Site-SynthDigits                   | Val  Loss: 1.6167 | Val  Acc: 0.5217
 Site-SynthDigits                   | Val  Loss: 1.6485 | Val  Acc: 0.5108
 Site-MNIST-M                       | Val  Loss: 1.9729 | Val  Acc: 0.3587
 Site-MNIST-M                       | Val  Loss: 1.9064 | Val  Acc: 0.4424
 Site-SVHN                          | Val  Loss: 1.9019 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 1.9446 | Val  Acc: 0.3489
Average Valid Accuracy: 0.5487
===2023-06-04 13:25:45===
===2023-06-04 13:26:04===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.7100
 Test site-USPS                      | Epoch:48 | Test Acc: 0.7978
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.5182
 Test site-MNIST-M                   | Epoch:48 | Test Acc: 0.3634
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.3146
MNIST: 0.710, USPS: 0.798, SynthDigits: 0.518, MNIST-M: 0.363, SVHN: 0.315, 
Average Test Accuracy: 0.5408, domain std=0.1886, cluster std=-1.0000, individual std=0.1886, 
===2023-06-11 06:28:49===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.7100
 Test site-USPS                      | Epoch:48 | Test Acc: 0.7978
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.5182
 Test site-MNIST-M                   | Epoch:48 | Test Acc: 0.3634
 Test site-MNIST-M                   | Epoch:48 | Test Acc: 0.3634
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.3146
MNIST: 0.4790, USPS: 0.7978, SynthDigits: 0.5182, SVHN: 0.3146, 
Average Test Accuracy(group): 0.5274, Average Test Accuracy(individual): 0.5408,
domain CV=0.3296, cluster CV=-1.0000, individual CV=0.3487, 
===2023-06-30 19:23:58===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.1022 | Train Acc: 0.6388
 Site-MNIST                         | Train Loss: 2.1289 | Train Acc: 0.5085
 Site-USPS                          | Train Loss: 2.1017 | Train Acc: 0.5822
 Site-USPS                          | Train Loss: 2.0920 | Train Acc: 0.6188
 Site-SynthDigits                   | Train Loss: 2.2369 | Train Acc: 0.2453
 Site-SynthDigits                   | Train Loss: 2.2133 | Train Acc: 0.3031
 Site-MNIST_M                       | Train Loss: 2.2713 | Train Acc: 0.1563
 Site-MNIST_M                       | Train Loss: 2.2731 | Train Acc: 0.1462
 Site-SVHN                          | Train Loss: 2.2503 | Train Acc: 0.2399
 Site-SVHN                          | Train Loss: 2.2537 | Train Acc: 0.2305
Average Train Accuracy: 0.3670
 Site-MNIST                         | Val  Loss: 2.1434 | Val  Acc: 0.4783
 Site-MNIST                         | Val  Loss: 2.1252 | Val  Acc: 0.5576
 Site-USPS                          | Val  Loss: 2.1125 | Val  Acc: 0.5543
 Site-USPS                          | Val  Loss: 2.1093 | Val  Acc: 0.5827
 Site-SynthDigits                   | Val  Loss: 2.2202 | Val  Acc: 0.2826
 Site-SynthDigits                   | Val  Loss: 2.2357 | Val  Acc: 0.2482
 Site-MNIST_M                       | Val  Loss: 2.2761 | Val  Acc: 0.0870
 Site-MNIST_M                       | Val  Loss: 2.2720 | Val  Acc: 0.1295
 Site-SVHN                          | Val  Loss: 2.2488 | Val  Acc: 0.2717
 Site-SVHN                          | Val  Loss: 2.2507 | Val  Acc: 0.2518
Average Valid Accuracy: 0.3444
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4783
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5576
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5543
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5827
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2826
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2482
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.0870
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1295
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2717
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2518
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.9295 | Train Acc: 0.7035
 Site-MNIST                         | Train Loss: 1.9776 | Train Acc: 0.5785
 Site-USPS                          | Train Loss: 1.9322 | Train Acc: 0.5957
 Site-USPS                          | Train Loss: 1.9208 | Train Acc: 0.6323
 Site-SynthDigits                   | Train Loss: 2.1597 | Train Acc: 0.3288
 Site-SynthDigits                   | Train Loss: 2.1211 | Train Acc: 0.3955
 Site-MNIST_M                       | Train Loss: 2.2339 | Train Acc: 0.2318
 Site-MNIST_M                       | Train Loss: 2.2375 | Train Acc: 0.2179
 Site-SVHN                          | Train Loss: 2.2161 | Train Acc: 0.2857
 Site-SVHN                          | Train Loss: 2.2153 | Train Acc: 0.2592
Average Train Accuracy: 0.4229
 Site-MNIST                         | Val  Loss: 1.9961 | Val  Acc: 0.5109
 Site-MNIST                         | Val  Loss: 1.9757 | Val  Acc: 0.6115
 Site-USPS                          | Val  Loss: 1.9584 | Val  Acc: 0.5435
 Site-USPS                          | Val  Loss: 1.9516 | Val  Acc: 0.5755
 Site-SynthDigits                   | Val  Loss: 2.1280 | Val  Acc: 0.3804
 Site-SynthDigits                   | Val  Loss: 2.1515 | Val  Acc: 0.3129
 Site-MNIST_M                       | Val  Loss: 2.2429 | Val  Acc: 0.1522
 Site-MNIST_M                       | Val  Loss: 2.2373 | Val  Acc: 0.2086
 Site-SVHN                          | Val  Loss: 2.2037 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.2076 | Val  Acc: 0.2806
Average Valid Accuracy: 0.3859
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5109
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6115
 Best site-USPS                      | Epoch:1 | Val Acc: 0.5435
 Best site-USPS                      | Epoch:1 | Val Acc: 0.5755
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3804
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3129
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.1522
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2086
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2806
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.7867 | Train Acc: 0.7385
 Site-MNIST                         | Train Loss: 1.8487 | Train Acc: 0.6215
 Site-USPS                          | Train Loss: 1.7517 | Train Acc: 0.6442
 Site-USPS                          | Train Loss: 1.7392 | Train Acc: 0.6996
 Site-SynthDigits                   | Train Loss: 2.0941 | Train Acc: 0.3639
 Site-SynthDigits                   | Train Loss: 2.0398 | Train Acc: 0.4386
 Site-MNIST_M                       | Train Loss: 2.2015 | Train Acc: 0.2695
 Site-MNIST_M                       | Train Loss: 2.2019 | Train Acc: 0.2547
 Site-SVHN                          | Train Loss: 2.1912 | Train Acc: 0.2857
 Site-SVHN                          | Train Loss: 2.1840 | Train Acc: 0.2691
Average Train Accuracy: 0.4585
 Site-MNIST                         | Val  Loss: 1.8648 | Val  Acc: 0.5870
 Site-MNIST                         | Val  Loss: 1.8453 | Val  Acc: 0.6619
 Site-USPS                          | Val  Loss: 1.7821 | Val  Acc: 0.5978
 Site-USPS                          | Val  Loss: 1.7771 | Val  Acc: 0.6295
 Site-SynthDigits                   | Val  Loss: 2.0459 | Val  Acc: 0.3913
 Site-SynthDigits                   | Val  Loss: 2.0768 | Val  Acc: 0.3705
 Site-MNIST_M                       | Val  Loss: 2.2077 | Val  Acc: 0.1848
 Site-MNIST_M                       | Val  Loss: 2.2022 | Val  Acc: 0.2446
 Site-SVHN                          | Val  Loss: 2.1674 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1760 | Val  Acc: 0.2950
Average Valid Accuracy: 0.4256
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5870
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6619
 Best site-USPS                      | Epoch:2 | Val Acc: 0.5978
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6295
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3913
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3705
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.1848
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2446
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2950
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.6386 | Train Acc: 0.7358
 Site-MNIST                         | Train Loss: 1.7167 | Train Acc: 0.6466
 Site-USPS                          | Train Loss: 1.6182 | Train Acc: 0.6550
 Site-USPS                          | Train Loss: 1.6015 | Train Acc: 0.6996
 Site-SynthDigits                   | Train Loss: 2.0258 | Train Acc: 0.4151
 Site-SynthDigits                   | Train Loss: 1.9593 | Train Acc: 0.4816
 Site-MNIST_M                       | Train Loss: 2.1702 | Train Acc: 0.2884
 Site-MNIST_M                       | Train Loss: 2.1648 | Train Acc: 0.2807
 Site-SVHN                          | Train Loss: 2.1662 | Train Acc: 0.3046
 Site-SVHN                          | Train Loss: 2.1559 | Train Acc: 0.2717
Average Train Accuracy: 0.4779
 Site-MNIST                         | Val  Loss: 1.7288 | Val  Acc: 0.6522
 Site-MNIST                         | Val  Loss: 1.7113 | Val  Acc: 0.6942
 Site-USPS                          | Val  Loss: 1.6562 | Val  Acc: 0.5978
 Site-USPS                          | Val  Loss: 1.6453 | Val  Acc: 0.6223
 Site-SynthDigits                   | Val  Loss: 1.9628 | Val  Acc: 0.4239
 Site-SynthDigits                   | Val  Loss: 2.0040 | Val  Acc: 0.4209
 Site-MNIST_M                       | Val  Loss: 2.1760 | Val  Acc: 0.2283
 Site-MNIST_M                       | Val  Loss: 2.1681 | Val  Acc: 0.2878
 Site-SVHN                          | Val  Loss: 2.1329 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1452 | Val  Acc: 0.3022
Average Valid Accuracy: 0.4523
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6522
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6942
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5978
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6223
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4239
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4209
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2283
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2878
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.3022
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.5491 | Train Acc: 0.7332
 Site-MNIST                         | Train Loss: 1.6262 | Train Acc: 0.6484
 Site-USPS                          | Train Loss: 1.4950 | Train Acc: 0.6712
 Site-USPS                          | Train Loss: 1.4714 | Train Acc: 0.7148
 Site-SynthDigits                   | Train Loss: 1.9563 | Train Acc: 0.4420
 Site-SynthDigits                   | Train Loss: 1.8784 | Train Acc: 0.4960
 Site-MNIST_M                       | Train Loss: 2.1331 | Train Acc: 0.3046
 Site-MNIST_M                       | Train Loss: 2.1330 | Train Acc: 0.2978
 Site-SVHN                          | Train Loss: 2.1376 | Train Acc: 0.3073
 Site-SVHN                          | Train Loss: 2.1205 | Train Acc: 0.2735
Average Train Accuracy: 0.4889
 Site-MNIST                         | Val  Loss: 1.6384 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.6251 | Val  Acc: 0.6727
 Site-USPS                          | Val  Loss: 1.5350 | Val  Acc: 0.6413
 Site-USPS                          | Val  Loss: 1.5228 | Val  Acc: 0.6547
 Site-SynthDigits                   | Val  Loss: 1.8892 | Val  Acc: 0.4565
 Site-SynthDigits                   | Val  Loss: 1.9347 | Val  Acc: 0.4245
 Site-MNIST_M                       | Val  Loss: 2.1467 | Val  Acc: 0.2391
 Site-MNIST_M                       | Val  Loss: 2.1291 | Val  Acc: 0.3058
 Site-SVHN                          | Val  Loss: 2.1014 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1145 | Val  Acc: 0.3129
Average Valid Accuracy: 0.4653
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.6727
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6413
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6547
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4565
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4245
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.2391
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3058
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.3129
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.4715 | Train Acc: 0.6981
 Site-MNIST                         | Train Loss: 1.5644 | Train Acc: 0.6081
 Site-USPS                          | Train Loss: 1.4264 | Train Acc: 0.7062
 Site-USPS                          | Train Loss: 1.4113 | Train Acc: 0.7229
 Site-SynthDigits                   | Train Loss: 1.8647 | Train Acc: 0.4420
 Site-SynthDigits                   | Train Loss: 1.7952 | Train Acc: 0.5067
 Site-MNIST_M                       | Train Loss: 2.0594 | Train Acc: 0.3396
 Site-MNIST_M                       | Train Loss: 2.0761 | Train Acc: 0.3175
 Site-SVHN                          | Train Loss: 2.0906 | Train Acc: 0.3046
 Site-SVHN                          | Train Loss: 2.0640 | Train Acc: 0.3094
Average Train Accuracy: 0.4955
 Site-MNIST                         | Val  Loss: 1.5727 | Val  Acc: 0.5870
 Site-MNIST                         | Val  Loss: 1.5654 | Val  Acc: 0.6367
 Site-USPS                          | Val  Loss: 1.4780 | Val  Acc: 0.6630
 Site-USPS                          | Val  Loss: 1.4593 | Val  Acc: 0.6871
 Site-SynthDigits                   | Val  Loss: 1.7989 | Val  Acc: 0.4348
 Site-SynthDigits                   | Val  Loss: 1.8395 | Val  Acc: 0.4532
 Site-MNIST_M                       | Val  Loss: 2.1038 | Val  Acc: 0.2826
 Site-MNIST_M                       | Val  Loss: 2.0614 | Val  Acc: 0.3381
 Site-SVHN                          | Val  Loss: 2.0252 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0492 | Val  Acc: 0.3273
Average Valid Accuracy: 0.4714
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5870
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.6367
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6630
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6871
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4348
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4532
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.2826
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3381
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 1.3607 | Train Acc: 0.7493
 Site-MNIST                         | Train Loss: 1.4526 | Train Acc: 0.6709
 Site-USPS                          | Train Loss: 1.3084 | Train Acc: 0.7439
 Site-USPS                          | Train Loss: 1.2940 | Train Acc: 0.7641
 Site-SynthDigits                   | Train Loss: 1.7954 | Train Acc: 0.4825
 Site-SynthDigits                   | Train Loss: 1.7211 | Train Acc: 0.5417
 Site-MNIST_M                       | Train Loss: 1.9959 | Train Acc: 0.3908
 Site-MNIST_M                       | Train Loss: 2.0184 | Train Acc: 0.3587
 Site-SVHN                          | Train Loss: 2.0522 | Train Acc: 0.3019
 Site-SVHN                          | Train Loss: 2.0140 | Train Acc: 0.3238
Average Train Accuracy: 0.5328
 Site-MNIST                         | Val  Loss: 1.4597 | Val  Acc: 0.6196
 Site-MNIST                         | Val  Loss: 1.4464 | Val  Acc: 0.6942
 Site-USPS                          | Val  Loss: 1.3562 | Val  Acc: 0.6739
 Site-USPS                          | Val  Loss: 1.3383 | Val  Acc: 0.7266
 Site-SynthDigits                   | Val  Loss: 1.7254 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.7692 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 2.0513 | Val  Acc: 0.3152
 Site-MNIST_M                       | Val  Loss: 2.0004 | Val  Acc: 0.3885
 Site-SVHN                          | Val  Loss: 1.9712 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0067 | Val  Acc: 0.3165
Average Valid Accuracy: 0.5050
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6196
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6942
 Best site-USPS                      | Epoch:6 | Val Acc: 0.6739
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7266
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3152
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3885
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3165
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 1.2849 | Train Acc: 0.7466
 Site-MNIST                         | Train Loss: 1.3722 | Train Acc: 0.6807
 Site-USPS                          | Train Loss: 1.2424 | Train Acc: 0.7466
 Site-USPS                          | Train Loss: 1.2285 | Train Acc: 0.7561
 Site-SynthDigits                   | Train Loss: 1.7231 | Train Acc: 0.4906
 Site-SynthDigits                   | Train Loss: 1.6503 | Train Acc: 0.5650
 Site-MNIST_M                       | Train Loss: 1.9418 | Train Acc: 0.4070
 Site-MNIST_M                       | Train Loss: 1.9757 | Train Acc: 0.3785
 Site-SVHN                          | Train Loss: 2.0106 | Train Acc: 0.3342
 Site-SVHN                          | Train Loss: 1.9709 | Train Acc: 0.3453
Average Train Accuracy: 0.5451
 Site-MNIST                         | Val  Loss: 1.3834 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.3676 | Val  Acc: 0.7014
 Site-USPS                          | Val  Loss: 1.2874 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 1.2704 | Val  Acc: 0.7446
 Site-SynthDigits                   | Val  Loss: 1.6520 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.6923 | Val  Acc: 0.5144
 Site-MNIST_M                       | Val  Loss: 2.0066 | Val  Acc: 0.3587
 Site-MNIST_M                       | Val  Loss: 1.9470 | Val  Acc: 0.4388
 Site-SVHN                          | Val  Loss: 1.9284 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 1.9697 | Val  Acc: 0.3309
Average Valid Accuracy: 0.5274
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7014
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7446
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5144
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3587
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.4388
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3309
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 1.2137 | Train Acc: 0.7601
 Site-MNIST                         | Train Loss: 1.2922 | Train Acc: 0.6987
 Site-USPS                          | Train Loss: 1.1466 | Train Acc: 0.7925
 Site-USPS                          | Train Loss: 1.1388 | Train Acc: 0.7785
 Site-SynthDigits                   | Train Loss: 1.6562 | Train Acc: 0.5310
 Site-SynthDigits                   | Train Loss: 1.5766 | Train Acc: 0.5812
 Site-MNIST_M                       | Train Loss: 1.8944 | Train Acc: 0.4097
 Site-MNIST_M                       | Train Loss: 1.9354 | Train Acc: 0.3937
 Site-SVHN                          | Train Loss: 1.9889 | Train Acc: 0.3369
 Site-SVHN                          | Train Loss: 1.9349 | Train Acc: 0.3543
Average Train Accuracy: 0.5636
 Site-MNIST                         | Val  Loss: 1.3053 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.2899 | Val  Acc: 0.7194
 Site-USPS                          | Val  Loss: 1.1967 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.1770 | Val  Acc: 0.7554
 Site-SynthDigits                   | Val  Loss: 1.5787 | Val  Acc: 0.5543
 Site-SynthDigits                   | Val  Loss: 1.6207 | Val  Acc: 0.5468
 Site-MNIST_M                       | Val  Loss: 1.9497 | Val  Acc: 0.4130
 Site-MNIST_M                       | Val  Loss: 1.8965 | Val  Acc: 0.4496
 Site-SVHN                          | Val  Loss: 1.8942 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 1.9457 | Val  Acc: 0.3381
Average Valid Accuracy: 0.5472
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6630
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7194
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7554
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5543
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5468
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.4130
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.4496
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3381
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 1.1570 | Train Acc: 0.7574
 Site-MNIST                         | Train Loss: 1.2341 | Train Acc: 0.7076
 Site-USPS                          | Train Loss: 1.0969 | Train Acc: 0.7951
 Site-USPS                          | Train Loss: 1.0824 | Train Acc: 0.7785
 Site-SynthDigits                   | Train Loss: 1.6003 | Train Acc: 0.5364
 Site-SynthDigits                   | Train Loss: 1.5211 | Train Acc: 0.5910
 Site-MNIST_M                       | Train Loss: 1.8463 | Train Acc: 0.4259
 Site-MNIST_M                       | Train Loss: 1.8970 | Train Acc: 0.4152
 Site-SVHN                          | Train Loss: 1.9566 | Train Acc: 0.3558
 Site-SVHN                          | Train Loss: 1.9011 | Train Acc: 0.3740
Average Train Accuracy: 0.5737
 Site-MNIST                         | Val  Loss: 1.2495 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 1.2309 | Val  Acc: 0.7266
 Site-USPS                          | Val  Loss: 1.1439 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 1.1254 | Val  Acc: 0.7770
 Site-SynthDigits                   | Val  Loss: 1.5176 | Val  Acc: 0.5652
 Site-SynthDigits                   | Val  Loss: 1.5602 | Val  Acc: 0.5504
 Site-MNIST_M                       | Val  Loss: 1.9026 | Val  Acc: 0.4457
 Site-MNIST_M                       | Val  Loss: 1.8510 | Val  Acc: 0.4820
 Site-SVHN                          | Val  Loss: 1.8628 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 1.9200 | Val  Acc: 0.3489
Average Valid Accuracy: 0.5657
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7266
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7770
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.5652
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.5504
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.4457
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.4820
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3489
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 1.1061 | Train Acc: 0.7520
 Site-MNIST                         | Train Loss: 1.1888 | Train Acc: 0.7139
 Site-USPS                          | Train Loss: 1.0578 | Train Acc: 0.7817
 Site-USPS                          | Train Loss: 1.0548 | Train Acc: 0.7686
 Site-SynthDigits                   | Train Loss: 1.5485 | Train Acc: 0.5526
 Site-SynthDigits                   | Train Loss: 1.4663 | Train Acc: 0.6000
 Site-MNIST_M                       | Train Loss: 1.8063 | Train Acc: 0.4367
 Site-MNIST_M                       | Train Loss: 1.8524 | Train Acc: 0.4206
 Site-SVHN                          | Train Loss: 1.9232 | Train Acc: 0.3720
 Site-SVHN                          | Train Loss: 1.8562 | Train Acc: 0.3839
Average Train Accuracy: 0.5782
 Site-MNIST                         | Val  Loss: 1.1972 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 1.1801 | Val  Acc: 0.7302
 Site-USPS                          | Val  Loss: 1.1012 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.0922 | Val  Acc: 0.7626
 Site-SynthDigits                   | Val  Loss: 1.4686 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.5088 | Val  Acc: 0.5612
 Site-MNIST_M                       | Val  Loss: 1.8590 | Val  Acc: 0.4348
 Site-MNIST_M                       | Val  Loss: 1.8089 | Val  Acc: 0.4964
 Site-SVHN                          | Val  Loss: 1.8360 | Val  Acc: 0.3478
 Site-SVHN                          | Val  Loss: 1.8869 | Val  Acc: 0.3633
Average Valid Accuracy: 0.5685
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7302
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7626
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5761
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5612
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4348
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4964
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3478
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3633
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 1.0601 | Train Acc: 0.7628
 Site-MNIST                         | Train Loss: 1.1332 | Train Acc: 0.7238
 Site-USPS                          | Train Loss: 1.0021 | Train Acc: 0.7978
 Site-USPS                          | Train Loss: 0.9995 | Train Acc: 0.7785
 Site-SynthDigits                   | Train Loss: 1.5127 | Train Acc: 0.5714
 Site-SynthDigits                   | Train Loss: 1.4328 | Train Acc: 0.6135
 Site-MNIST_M                       | Train Loss: 1.7834 | Train Acc: 0.4528
 Site-MNIST_M                       | Train Loss: 1.8266 | Train Acc: 0.4287
 Site-SVHN                          | Train Loss: 1.8983 | Train Acc: 0.3801
 Site-SVHN                          | Train Loss: 1.8243 | Train Acc: 0.3901
Average Train Accuracy: 0.5899
 Site-MNIST                         | Val  Loss: 1.1449 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 1.1266 | Val  Acc: 0.7482
 Site-USPS                          | Val  Loss: 1.0599 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.0408 | Val  Acc: 0.7626
 Site-SynthDigits                   | Val  Loss: 1.4252 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.4629 | Val  Acc: 0.5827
 Site-MNIST_M                       | Val  Loss: 1.8354 | Val  Acc: 0.4457
 Site-MNIST_M                       | Val  Loss: 1.7757 | Val  Acc: 0.5144
 Site-SVHN                          | Val  Loss: 1.8028 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 1.8576 | Val  Acc: 0.3777
Average Valid Accuracy: 0.5823
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7482
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7626
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5827
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4457
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.5144
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3777
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 1.0045 | Train Acc: 0.7817
 Site-MNIST                         | Train Loss: 1.0783 | Train Acc: 0.7390
 Site-USPS                          | Train Loss: 0.9841 | Train Acc: 0.7951
 Site-USPS                          | Train Loss: 0.9697 | Train Acc: 0.7740
 Site-SynthDigits                   | Train Loss: 1.4659 | Train Acc: 0.5714
 Site-SynthDigits                   | Train Loss: 1.3793 | Train Acc: 0.6233
 Site-MNIST_M                       | Train Loss: 1.7431 | Train Acc: 0.4717
 Site-MNIST_M                       | Train Loss: 1.7796 | Train Acc: 0.4413
 Site-SVHN                          | Train Loss: 1.8727 | Train Acc: 0.3908
 Site-SVHN                          | Train Loss: 1.7994 | Train Acc: 0.4018
Average Train Accuracy: 0.5990
 Site-MNIST                         | Val  Loss: 1.0999 | Val  Acc: 0.7283
 Site-MNIST                         | Val  Loss: 1.0788 | Val  Acc: 0.7626
 Site-USPS                          | Val  Loss: 1.0391 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 1.0183 | Val  Acc: 0.7554
 Site-SynthDigits                   | Val  Loss: 1.3860 | Val  Acc: 0.6087
 Site-SynthDigits                   | Val  Loss: 1.4208 | Val  Acc: 0.5935
 Site-MNIST_M                       | Val  Loss: 1.7971 | Val  Acc: 0.4565
 Site-MNIST_M                       | Val  Loss: 1.7398 | Val  Acc: 0.5072
 Site-SVHN                          | Val  Loss: 1.7851 | Val  Acc: 0.4022
 Site-SVHN                          | Val  Loss: 1.8349 | Val  Acc: 0.3993
Average Valid Accuracy: 0.5942
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7283
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7626
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7554
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.6087
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.5935
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4565
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.5072
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.4022
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3993
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.9739 | Train Acc: 0.7736
 Site-MNIST                         | Train Loss: 1.0505 | Train Acc: 0.7354
 Site-USPS                          | Train Loss: 0.9605 | Train Acc: 0.7951
 Site-USPS                          | Train Loss: 0.9545 | Train Acc: 0.7659
 Site-SynthDigits                   | Train Loss: 1.4325 | Train Acc: 0.5876
 Site-SynthDigits                   | Train Loss: 1.3593 | Train Acc: 0.6251
 Site-MNIST_M                       | Train Loss: 1.6992 | Train Acc: 0.4663
 Site-MNIST_M                       | Train Loss: 1.7439 | Train Acc: 0.4556
 Site-SVHN                          | Train Loss: 1.8476 | Train Acc: 0.3962
 Site-SVHN                          | Train Loss: 1.7715 | Train Acc: 0.4072
Average Train Accuracy: 0.6008
 Site-MNIST                         | Val  Loss: 1.0693 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 1.0476 | Val  Acc: 0.7518
 Site-USPS                          | Val  Loss: 1.0205 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.0011 | Val  Acc: 0.7410
 Site-SynthDigits                   | Val  Loss: 1.3497 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.3916 | Val  Acc: 0.5971
 Site-MNIST_M                       | Val  Loss: 1.7511 | Val  Acc: 0.4783
 Site-MNIST_M                       | Val  Loss: 1.6997 | Val  Acc: 0.5108
 Site-SVHN                          | Val  Loss: 1.7618 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.8136 | Val  Acc: 0.4137
Average Valid Accuracy: 0.5960
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7518
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7410
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.6196
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5971
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4783
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.5108
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.4137
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.9336 | Train Acc: 0.7844
 Site-MNIST                         | Train Loss: 1.0154 | Train Acc: 0.7480
 Site-USPS                          | Train Loss: 0.9029 | Train Acc: 0.8248
 Site-USPS                          | Train Loss: 0.8978 | Train Acc: 0.7776
 Site-SynthDigits                   | Train Loss: 1.4079 | Train Acc: 0.5768
 Site-SynthDigits                   | Train Loss: 1.3222 | Train Acc: 0.6323
 Site-MNIST_M                       | Train Loss: 1.6554 | Train Acc: 0.4960
 Site-MNIST_M                       | Train Loss: 1.6974 | Train Acc: 0.4825
 Site-SVHN                          | Train Loss: 1.8336 | Train Acc: 0.4151
 Site-SVHN                          | Train Loss: 1.7463 | Train Acc: 0.4224
Average Train Accuracy: 0.6160
 Site-MNIST                         | Val  Loss: 1.0271 | Val  Acc: 0.7283
 Site-MNIST                         | Val  Loss: 1.0059 | Val  Acc: 0.7734
 Site-USPS                          | Val  Loss: 0.9704 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 0.9418 | Val  Acc: 0.7698
 Site-SynthDigits                   | Val  Loss: 1.3265 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.3641 | Val  Acc: 0.5935
 Site-MNIST_M                       | Val  Loss: 1.7014 | Val  Acc: 0.4891
 Site-MNIST_M                       | Val  Loss: 1.6583 | Val  Acc: 0.5288
 Site-SVHN                          | Val  Loss: 1.7391 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.7916 | Val  Acc: 0.4281
Average Valid Accuracy: 0.6126
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7283
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7734
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7698
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.6196
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5935
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4891
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.5288
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.4457
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.4281
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.9094 | Train Acc: 0.7682
 Site-MNIST                         | Train Loss: 0.9817 | Train Acc: 0.7435
 Site-USPS                          | Train Loss: 0.8741 | Train Acc: 0.8275
 Site-USPS                          | Train Loss: 0.8679 | Train Acc: 0.7794
 Site-SynthDigits                   | Train Loss: 1.3902 | Train Acc: 0.5822
 Site-SynthDigits                   | Train Loss: 1.3014 | Train Acc: 0.6377
 Site-MNIST_M                       | Train Loss: 1.6260 | Train Acc: 0.4960
 Site-MNIST_M                       | Train Loss: 1.6685 | Train Acc: 0.4816
 Site-SVHN                          | Train Loss: 1.8061 | Train Acc: 0.4259
 Site-SVHN                          | Train Loss: 1.7263 | Train Acc: 0.4350
Average Train Accuracy: 0.6177
 Site-MNIST                         | Val  Loss: 1.0025 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 0.9886 | Val  Acc: 0.7518
 Site-USPS                          | Val  Loss: 0.9603 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.9200 | Val  Acc: 0.7590
 Site-SynthDigits                   | Val  Loss: 1.3032 | Val  Acc: 0.6087
 Site-SynthDigits                   | Val  Loss: 1.3461 | Val  Acc: 0.6079
 Site-MNIST_M                       | Val  Loss: 1.6724 | Val  Acc: 0.4783
 Site-MNIST_M                       | Val  Loss: 1.6283 | Val  Acc: 0.5180
 Site-SVHN                          | Val  Loss: 1.7116 | Val  Acc: 0.4239
 Site-SVHN                          | Val  Loss: 1.7598 | Val  Acc: 0.4281
Average Valid Accuracy: 0.6010
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.8813 | Train Acc: 0.7978
 Site-MNIST                         | Train Loss: 0.9535 | Train Acc: 0.7596
 Site-USPS                          | Train Loss: 0.8764 | Train Acc: 0.8167
 Site-USPS                          | Train Loss: 0.8589 | Train Acc: 0.7722
 Site-SynthDigits                   | Train Loss: 1.3520 | Train Acc: 0.6065
 Site-SynthDigits                   | Train Loss: 1.2624 | Train Acc: 0.6457
 Site-MNIST_M                       | Train Loss: 1.6070 | Train Acc: 0.4987
 Site-MNIST_M                       | Train Loss: 1.6495 | Train Acc: 0.4852
 Site-SVHN                          | Train Loss: 1.7980 | Train Acc: 0.4232
 Site-SVHN                          | Train Loss: 1.7019 | Train Acc: 0.4413
Average Train Accuracy: 0.6247
 Site-MNIST                         | Val  Loss: 0.9668 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 0.9539 | Val  Acc: 0.7770
 Site-USPS                          | Val  Loss: 0.9532 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 0.9166 | Val  Acc: 0.7446
 Site-SynthDigits                   | Val  Loss: 1.2659 | Val  Acc: 0.6304
 Site-SynthDigits                   | Val  Loss: 1.3064 | Val  Acc: 0.6079
 Site-MNIST_M                       | Val  Loss: 1.6542 | Val  Acc: 0.4891
 Site-MNIST_M                       | Val  Loss: 1.6060 | Val  Acc: 0.5144
 Site-SVHN                          | Val  Loss: 1.6949 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.7482 | Val  Acc: 0.4353
Average Valid Accuracy: 0.6047
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.8499 | Train Acc: 0.8032
 Site-MNIST                         | Train Loss: 0.9208 | Train Acc: 0.7659
 Site-USPS                          | Train Loss: 0.8284 | Train Acc: 0.8329
 Site-USPS                          | Train Loss: 0.8211 | Train Acc: 0.7830
 Site-SynthDigits                   | Train Loss: 1.3469 | Train Acc: 0.5903
 Site-SynthDigits                   | Train Loss: 1.2549 | Train Acc: 0.6377
 Site-MNIST_M                       | Train Loss: 1.5690 | Train Acc: 0.5121
 Site-MNIST_M                       | Train Loss: 1.6066 | Train Acc: 0.5130
 Site-SVHN                          | Train Loss: 1.7782 | Train Acc: 0.4259
 Site-SVHN                          | Train Loss: 1.6763 | Train Acc: 0.4538
Average Train Accuracy: 0.6318
 Site-MNIST                         | Val  Loss: 0.9391 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 0.9211 | Val  Acc: 0.7698
 Site-USPS                          | Val  Loss: 0.9266 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.8763 | Val  Acc: 0.7698
 Site-SynthDigits                   | Val  Loss: 1.2708 | Val  Acc: 0.6087
 Site-SynthDigits                   | Val  Loss: 1.3114 | Val  Acc: 0.5863
 Site-MNIST_M                       | Val  Loss: 1.6033 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.5737 | Val  Acc: 0.5612
 Site-SVHN                          | Val  Loss: 1.6542 | Val  Acc: 0.4674
 Site-SVHN                          | Val  Loss: 1.7157 | Val  Acc: 0.4460
Average Valid Accuracy: 0.6187
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7698
 Best site-USPS                      | Epoch:17 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:17 | Val Acc: 0.7698
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.6087
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5863
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.5435
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.5612
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.4674
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.4460
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.8281 | Train Acc: 0.8059
 Site-MNIST                         | Train Loss: 0.9006 | Train Acc: 0.7758
 Site-USPS                          | Train Loss: 0.8134 | Train Acc: 0.8329
 Site-USPS                          | Train Loss: 0.8088 | Train Acc: 0.7901
 Site-SynthDigits                   | Train Loss: 1.3101 | Train Acc: 0.6119
 Site-SynthDigits                   | Train Loss: 1.2173 | Train Acc: 0.6583
 Site-MNIST_M                       | Train Loss: 1.5514 | Train Acc: 0.5202
 Site-MNIST_M                       | Train Loss: 1.5785 | Train Acc: 0.5022
 Site-SVHN                          | Train Loss: 1.7555 | Train Acc: 0.4178
 Site-SVHN                          | Train Loss: 1.6362 | Train Acc: 0.4556
Average Train Accuracy: 0.6371
 Site-MNIST                         | Val  Loss: 0.9115 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 0.8971 | Val  Acc: 0.7842
 Site-USPS                          | Val  Loss: 0.9092 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.8578 | Val  Acc: 0.7662
 Site-SynthDigits                   | Val  Loss: 1.2312 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.2680 | Val  Acc: 0.6223
 Site-MNIST_M                       | Val  Loss: 1.5993 | Val  Acc: 0.5326
 Site-MNIST_M                       | Val  Loss: 1.5549 | Val  Acc: 0.5396
 Site-SVHN                          | Val  Loss: 1.6341 | Val  Acc: 0.4674
 Site-SVHN                          | Val  Loss: 1.6852 | Val  Acc: 0.4388
Average Valid Accuracy: 0.6260
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.7842
 Best site-USPS                      | Epoch:18 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:18 | Val Acc: 0.7662
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.6223
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.5326
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.5396
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.4674
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.4388
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.8094 | Train Acc: 0.8059
 Site-MNIST                         | Train Loss: 0.8918 | Train Acc: 0.7713
 Site-USPS                          | Train Loss: 0.7953 | Train Acc: 0.8437
 Site-USPS                          | Train Loss: 0.7946 | Train Acc: 0.7874
 Site-SynthDigits                   | Train Loss: 1.2878 | Train Acc: 0.6011
 Site-SynthDigits                   | Train Loss: 1.1860 | Train Acc: 0.6709
 Site-MNIST_M                       | Train Loss: 1.5276 | Train Acc: 0.5310
 Site-MNIST_M                       | Train Loss: 1.5653 | Train Acc: 0.5067
 Site-SVHN                          | Train Loss: 1.7344 | Train Acc: 0.4313
 Site-SVHN                          | Train Loss: 1.6251 | Train Acc: 0.4565
Average Train Accuracy: 0.6406
 Site-MNIST                         | Val  Loss: 0.8987 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 0.8919 | Val  Acc: 0.7698
 Site-USPS                          | Val  Loss: 0.8917 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 0.8430 | Val  Acc: 0.7698
 Site-SynthDigits                   | Val  Loss: 1.1910 | Val  Acc: 0.6630
 Site-SynthDigits                   | Val  Loss: 1.2371 | Val  Acc: 0.6259
 Site-MNIST_M                       | Val  Loss: 1.5751 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.5316 | Val  Acc: 0.5612
 Site-SVHN                          | Val  Loss: 1.6170 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.6754 | Val  Acc: 0.4353
Average Valid Accuracy: 0.6216
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.7923 | Train Acc: 0.8113
 Site-MNIST                         | Train Loss: 0.8452 | Train Acc: 0.7776
 Site-USPS                          | Train Loss: 0.7614 | Train Acc: 0.8491
 Site-USPS                          | Train Loss: 0.7531 | Train Acc: 0.8018
 Site-SynthDigits                   | Train Loss: 1.2815 | Train Acc: 0.6011
 Site-SynthDigits                   | Train Loss: 1.1721 | Train Acc: 0.6691
 Site-MNIST_M                       | Train Loss: 1.4928 | Train Acc: 0.5337
 Site-MNIST_M                       | Train Loss: 1.5316 | Train Acc: 0.5265
 Site-SVHN                          | Train Loss: 1.7247 | Train Acc: 0.4367
 Site-SVHN                          | Train Loss: 1.6055 | Train Acc: 0.4744
Average Train Accuracy: 0.6481
 Site-MNIST                         | Val  Loss: 0.8671 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 0.8648 | Val  Acc: 0.7770
 Site-USPS                          | Val  Loss: 0.8684 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.8007 | Val  Acc: 0.7698
 Site-SynthDigits                   | Val  Loss: 1.1884 | Val  Acc: 0.6304
 Site-SynthDigits                   | Val  Loss: 1.2285 | Val  Acc: 0.6151
 Site-MNIST_M                       | Val  Loss: 1.5460 | Val  Acc: 0.5326
 Site-MNIST_M                       | Val  Loss: 1.5052 | Val  Acc: 0.5576
 Site-SVHN                          | Val  Loss: 1.5874 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.6521 | Val  Acc: 0.4424
Average Valid Accuracy: 0.6271
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.7770
 Best site-USPS                      | Epoch:20 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:20 | Val Acc: 0.7698
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.6304
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.6151
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5326
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5576
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.4424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.7631 | Train Acc: 0.8167
 Site-MNIST                         | Train Loss: 0.8299 | Train Acc: 0.7821
 Site-USPS                          | Train Loss: 0.7500 | Train Acc: 0.8437
 Site-USPS                          | Train Loss: 0.7457 | Train Acc: 0.7964
 Site-SynthDigits                   | Train Loss: 1.2610 | Train Acc: 0.6011
 Site-SynthDigits                   | Train Loss: 1.1558 | Train Acc: 0.6637
 Site-MNIST_M                       | Train Loss: 1.4687 | Train Acc: 0.5364
 Site-MNIST_M                       | Train Loss: 1.5037 | Train Acc: 0.5336
 Site-SVHN                          | Train Loss: 1.7104 | Train Acc: 0.4420
 Site-SVHN                          | Train Loss: 1.5905 | Train Acc: 0.4807
Average Train Accuracy: 0.6496
 Site-MNIST                         | Val  Loss: 0.8483 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 0.8406 | Val  Acc: 0.7806
 Site-USPS                          | Val  Loss: 0.8623 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.7956 | Val  Acc: 0.7698
 Site-SynthDigits                   | Val  Loss: 1.1721 | Val  Acc: 0.6522
 Site-SynthDigits                   | Val  Loss: 1.2181 | Val  Acc: 0.6187
 Site-MNIST_M                       | Val  Loss: 1.5110 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.4803 | Val  Acc: 0.5719
 Site-SVHN                          | Val  Loss: 1.5617 | Val  Acc: 0.5109
 Site-SVHN                          | Val  Loss: 1.6292 | Val  Acc: 0.4604
Average Valid Accuracy: 0.6343
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7806
 Best site-USPS                      | Epoch:21 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:21 | Val Acc: 0.7698
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.6522
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.6187
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.5435
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.5719
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.5109
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.4604
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.7445 | Train Acc: 0.8221
 Site-MNIST                         | Train Loss: 0.8122 | Train Acc: 0.7955
 Site-USPS                          | Train Loss: 0.7525 | Train Acc: 0.8464
 Site-USPS                          | Train Loss: 0.7489 | Train Acc: 0.7865
 Site-SynthDigits                   | Train Loss: 1.2322 | Train Acc: 0.6092
 Site-SynthDigits                   | Train Loss: 1.1371 | Train Acc: 0.6726
 Site-MNIST_M                       | Train Loss: 1.4440 | Train Acc: 0.5553
 Site-MNIST_M                       | Train Loss: 1.4715 | Train Acc: 0.5525
 Site-SVHN                          | Train Loss: 1.6913 | Train Acc: 0.4394
 Site-SVHN                          | Train Loss: 1.5651 | Train Acc: 0.4852
Average Train Accuracy: 0.6565
 Site-MNIST                         | Val  Loss: 0.8161 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 0.8082 | Val  Acc: 0.7878
 Site-USPS                          | Val  Loss: 0.8632 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.8054 | Val  Acc: 0.7698
 Site-SynthDigits                   | Val  Loss: 1.1492 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.1947 | Val  Acc: 0.6223
 Site-MNIST_M                       | Val  Loss: 1.4793 | Val  Acc: 0.5652
 Site-MNIST_M                       | Val  Loss: 1.4489 | Val  Acc: 0.5899
 Site-SVHN                          | Val  Loss: 1.5463 | Val  Acc: 0.4891
 Site-SVHN                          | Val  Loss: 1.6076 | Val  Acc: 0.4496
Average Valid Accuracy: 0.6350
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7878
 Best site-USPS                      | Epoch:22 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:22 | Val Acc: 0.7698
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.6223
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5652
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5899
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.4891
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.4496
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.7324 | Train Acc: 0.8140
 Site-MNIST                         | Train Loss: 0.7905 | Train Acc: 0.7910
 Site-USPS                          | Train Loss: 0.7246 | Train Acc: 0.8491
 Site-USPS                          | Train Loss: 0.7177 | Train Acc: 0.8036
 Site-SynthDigits                   | Train Loss: 1.2264 | Train Acc: 0.6092
 Site-SynthDigits                   | Train Loss: 1.1286 | Train Acc: 0.6780
 Site-MNIST_M                       | Train Loss: 1.4311 | Train Acc: 0.5580
 Site-MNIST_M                       | Train Loss: 1.4499 | Train Acc: 0.5623
 Site-SVHN                          | Train Loss: 1.6828 | Train Acc: 0.4528
 Site-SVHN                          | Train Loss: 1.5590 | Train Acc: 0.4978
Average Train Accuracy: 0.6616
 Site-MNIST                         | Val  Loss: 0.7959 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 0.7932 | Val  Acc: 0.7806
 Site-USPS                          | Val  Loss: 0.8464 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.7703 | Val  Acc: 0.7806
 Site-SynthDigits                   | Val  Loss: 1.1473 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.1891 | Val  Acc: 0.6223
 Site-MNIST_M                       | Val  Loss: 1.4601 | Val  Acc: 0.5870
 Site-MNIST_M                       | Val  Loss: 1.4336 | Val  Acc: 0.6115
 Site-SVHN                          | Val  Loss: 1.5230 | Val  Acc: 0.5109
 Site-SVHN                          | Val  Loss: 1.5957 | Val  Acc: 0.4676
Average Valid Accuracy: 0.6447
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7806
 Best site-USPS                      | Epoch:23 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:23 | Val Acc: 0.7806
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.6223
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.5870
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.6115
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.5109
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.4676
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.7118 | Train Acc: 0.8140
 Site-MNIST                         | Train Loss: 0.7644 | Train Acc: 0.7973
 Site-USPS                          | Train Loss: 0.7223 | Train Acc: 0.8598
 Site-USPS                          | Train Loss: 0.7122 | Train Acc: 0.7901
 Site-SynthDigits                   | Train Loss: 1.2065 | Train Acc: 0.6146
 Site-SynthDigits                   | Train Loss: 1.1052 | Train Acc: 0.6807
 Site-MNIST_M                       | Train Loss: 1.3994 | Train Acc: 0.5606
 Site-MNIST_M                       | Train Loss: 1.4366 | Train Acc: 0.5668
 Site-SVHN                          | Train Loss: 1.6614 | Train Acc: 0.4528
 Site-SVHN                          | Train Loss: 1.5322 | Train Acc: 0.5031
Average Train Accuracy: 0.6640
 Site-MNIST                         | Val  Loss: 0.7691 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 0.7746 | Val  Acc: 0.7878
 Site-USPS                          | Val  Loss: 0.8413 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.7674 | Val  Acc: 0.7734
 Site-SynthDigits                   | Val  Loss: 1.1203 | Val  Acc: 0.6522
 Site-SynthDigits                   | Val  Loss: 1.1618 | Val  Acc: 0.6223
 Site-MNIST_M                       | Val  Loss: 1.4390 | Val  Acc: 0.5870
 Site-MNIST_M                       | Val  Loss: 1.4072 | Val  Acc: 0.6151
 Site-SVHN                          | Val  Loss: 1.5102 | Val  Acc: 0.5217
 Site-SVHN                          | Val  Loss: 1.5788 | Val  Acc: 0.4640
Average Valid Accuracy: 0.6502
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7878
 Best site-USPS                      | Epoch:24 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:24 | Val Acc: 0.7734
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.6522
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.6223
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.5870
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.6151
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.5217
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.4640
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.7053 | Train Acc: 0.8059
 Site-MNIST                         | Train Loss: 0.7610 | Train Acc: 0.7982
 Site-USPS                          | Train Loss: 0.7216 | Train Acc: 0.8437
 Site-USPS                          | Train Loss: 0.7157 | Train Acc: 0.7794
 Site-SynthDigits                   | Train Loss: 1.1856 | Train Acc: 0.6199
 Site-SynthDigits                   | Train Loss: 1.0774 | Train Acc: 0.6933
 Site-MNIST_M                       | Train Loss: 1.3898 | Train Acc: 0.5741
 Site-MNIST_M                       | Train Loss: 1.4391 | Train Acc: 0.5534
 Site-SVHN                          | Train Loss: 1.6535 | Train Acc: 0.4528
 Site-SVHN                          | Train Loss: 1.5055 | Train Acc: 0.5103
Average Train Accuracy: 0.6631
 Site-MNIST                         | Val  Loss: 0.7612 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 0.7695 | Val  Acc: 0.7950
 Site-USPS                          | Val  Loss: 0.8477 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 0.7778 | Val  Acc: 0.7518
 Site-SynthDigits                   | Val  Loss: 1.0977 | Val  Acc: 0.6848
 Site-SynthDigits                   | Val  Loss: 1.1321 | Val  Acc: 0.6475
 Site-MNIST_M                       | Val  Loss: 1.4287 | Val  Acc: 0.5870
 Site-MNIST_M                       | Val  Loss: 1.3974 | Val  Acc: 0.6223
 Site-SVHN                          | Val  Loss: 1.4944 | Val  Acc: 0.5109
 Site-SVHN                          | Val  Loss: 1.5579 | Val  Acc: 0.4640
Average Valid Accuracy: 0.6520
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7609
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7950
 Best site-USPS                      | Epoch:25 | Val Acc: 0.6957
 Best site-USPS                      | Epoch:25 | Val Acc: 0.7518
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.6848
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.6475
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.5870
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.6223
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.5109
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.4640
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.6937 | Train Acc: 0.8140
 Site-MNIST                         | Train Loss: 0.7585 | Train Acc: 0.7982
 Site-USPS                          | Train Loss: 0.6871 | Train Acc: 0.8598
 Site-USPS                          | Train Loss: 0.6845 | Train Acc: 0.8072
 Site-SynthDigits                   | Train Loss: 1.1769 | Train Acc: 0.6173
 Site-SynthDigits                   | Train Loss: 1.0805 | Train Acc: 0.6924
 Site-MNIST_M                       | Train Loss: 1.3662 | Train Acc: 0.5957
 Site-MNIST_M                       | Train Loss: 1.3974 | Train Acc: 0.5713
 Site-SVHN                          | Train Loss: 1.6412 | Train Acc: 0.4528
 Site-SVHN                          | Train Loss: 1.4925 | Train Acc: 0.5130
Average Train Accuracy: 0.6722
 Site-MNIST                         | Val  Loss: 0.7449 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 0.7546 | Val  Acc: 0.7806
 Site-USPS                          | Val  Loss: 0.8176 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.7308 | Val  Acc: 0.7734
 Site-SynthDigits                   | Val  Loss: 1.0950 | Val  Acc: 0.6848
 Site-SynthDigits                   | Val  Loss: 1.1378 | Val  Acc: 0.6475
 Site-MNIST_M                       | Val  Loss: 1.3881 | Val  Acc: 0.5978
 Site-MNIST_M                       | Val  Loss: 1.3722 | Val  Acc: 0.6187
 Site-SVHN                          | Val  Loss: 1.4722 | Val  Acc: 0.5326
 Site-SVHN                          | Val  Loss: 1.5460 | Val  Acc: 0.4676
Average Valid Accuracy: 0.6560
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.7806
 Best site-USPS                      | Epoch:26 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:26 | Val Acc: 0.7734
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.6848
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.6475
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5978
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.6187
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.5326
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.4676
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.6809 | Train Acc: 0.8194
 Site-MNIST                         | Train Loss: 0.7308 | Train Acc: 0.8054
 Site-USPS                          | Train Loss: 0.6790 | Train Acc: 0.8571
 Site-USPS                          | Train Loss: 0.6778 | Train Acc: 0.7991
 Site-SynthDigits                   | Train Loss: 1.1494 | Train Acc: 0.6199
 Site-SynthDigits                   | Train Loss: 1.0450 | Train Acc: 0.7022
 Site-MNIST_M                       | Train Loss: 1.3549 | Train Acc: 0.5957
 Site-MNIST_M                       | Train Loss: 1.3767 | Train Acc: 0.5785
 Site-SVHN                          | Train Loss: 1.6240 | Train Acc: 0.4690
 Site-SVHN                          | Train Loss: 1.4894 | Train Acc: 0.5184
Average Train Accuracy: 0.6765
 Site-MNIST                         | Val  Loss: 0.7255 | Val  Acc: 0.7717
 Site-MNIST                         | Val  Loss: 0.7340 | Val  Acc: 0.7986
 Site-USPS                          | Val  Loss: 0.8150 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.7300 | Val  Acc: 0.7662
 Site-SynthDigits                   | Val  Loss: 1.0648 | Val  Acc: 0.7174
 Site-SynthDigits                   | Val  Loss: 1.1063 | Val  Acc: 0.6691
 Site-MNIST_M                       | Val  Loss: 1.3695 | Val  Acc: 0.5978
 Site-MNIST_M                       | Val  Loss: 1.3500 | Val  Acc: 0.6187
 Site-SVHN                          | Val  Loss: 1.4677 | Val  Acc: 0.5435
 Site-SVHN                          | Val  Loss: 1.5371 | Val  Acc: 0.4892
Average Valid Accuracy: 0.6690
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.7717
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.7986
 Best site-USPS                      | Epoch:27 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:27 | Val Acc: 0.7662
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.7174
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.6691
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.5978
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.6187
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.5435
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.4892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.6810 | Train Acc: 0.8167
 Site-MNIST                         | Train Loss: 0.7270 | Train Acc: 0.8018
 Site-USPS                          | Train Loss: 0.6798 | Train Acc: 0.8491
 Site-USPS                          | Train Loss: 0.6832 | Train Acc: 0.7901
 Site-SynthDigits                   | Train Loss: 1.1347 | Train Acc: 0.6065
 Site-SynthDigits                   | Train Loss: 1.0362 | Train Acc: 0.7049
 Site-MNIST_M                       | Train Loss: 1.3390 | Train Acc: 0.5903
 Site-MNIST_M                       | Train Loss: 1.3583 | Train Acc: 0.5785
 Site-SVHN                          | Train Loss: 1.6059 | Train Acc: 0.4528
 Site-SVHN                          | Train Loss: 1.4858 | Train Acc: 0.5157
Average Train Accuracy: 0.6706
 Site-MNIST                         | Val  Loss: 0.7223 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 0.7369 | Val  Acc: 0.7950
 Site-USPS                          | Val  Loss: 0.8313 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 0.7472 | Val  Acc: 0.7590
 Site-SynthDigits                   | Val  Loss: 1.0500 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 1.0989 | Val  Acc: 0.6619
 Site-MNIST_M                       | Val  Loss: 1.3518 | Val  Acc: 0.5978
 Site-MNIST_M                       | Val  Loss: 1.3373 | Val  Acc: 0.6295
 Site-SVHN                          | Val  Loss: 1.4642 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.5294 | Val  Acc: 0.4712
Average Valid Accuracy: 0.6599
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.6575 | Train Acc: 0.8248
 Site-MNIST                         | Train Loss: 0.7181 | Train Acc: 0.8108
 Site-USPS                          | Train Loss: 0.6542 | Train Acc: 0.8598
 Site-USPS                          | Train Loss: 0.6551 | Train Acc: 0.8090
 Site-SynthDigits                   | Train Loss: 1.1220 | Train Acc: 0.6280
 Site-SynthDigits                   | Train Loss: 1.0262 | Train Acc: 0.7049
 Site-MNIST_M                       | Train Loss: 1.3145 | Train Acc: 0.6092
 Site-MNIST_M                       | Train Loss: 1.3400 | Train Acc: 0.5892
 Site-SVHN                          | Train Loss: 1.6094 | Train Acc: 0.4717
 Site-SVHN                          | Train Loss: 1.4668 | Train Acc: 0.5274
Average Train Accuracy: 0.6835
 Site-MNIST                         | Val  Loss: 0.7039 | Val  Acc: 0.7717
 Site-MNIST                         | Val  Loss: 0.7165 | Val  Acc: 0.7914
 Site-USPS                          | Val  Loss: 0.7995 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.7048 | Val  Acc: 0.7842
 Site-SynthDigits                   | Val  Loss: 1.0467 | Val  Acc: 0.6848
 Site-SynthDigits                   | Val  Loss: 1.0821 | Val  Acc: 0.6691
 Site-MNIST_M                       | Val  Loss: 1.3268 | Val  Acc: 0.6304
 Site-MNIST_M                       | Val  Loss: 1.3113 | Val  Acc: 0.6403
 Site-SVHN                          | Val  Loss: 1.4380 | Val  Acc: 0.5652
 Site-SVHN                          | Val  Loss: 1.5136 | Val  Acc: 0.4964
Average Valid Accuracy: 0.6762
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.7717
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.7914
 Best site-USPS                      | Epoch:29 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:29 | Val Acc: 0.7842
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.6848
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.6691
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.6304
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.6403
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.5652
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.4964
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.6514 | Train Acc: 0.8194
 Site-MNIST                         | Train Loss: 0.6982 | Train Acc: 0.8117
 Site-USPS                          | Train Loss: 0.6555 | Train Acc: 0.8544
 Site-USPS                          | Train Loss: 0.6529 | Train Acc: 0.8063
 Site-SynthDigits                   | Train Loss: 1.1142 | Train Acc: 0.6253
 Site-SynthDigits                   | Train Loss: 1.0017 | Train Acc: 0.7175
 Site-MNIST_M                       | Train Loss: 1.3104 | Train Acc: 0.5957
 Site-MNIST_M                       | Train Loss: 1.3302 | Train Acc: 0.5973
 Site-SVHN                          | Train Loss: 1.5794 | Train Acc: 0.4771
 Site-SVHN                          | Train Loss: 1.4387 | Train Acc: 0.5417
Average Train Accuracy: 0.6846
 Site-MNIST                         | Val  Loss: 0.6890 | Val  Acc: 0.7717
 Site-MNIST                         | Val  Loss: 0.6993 | Val  Acc: 0.7950
 Site-USPS                          | Val  Loss: 0.7969 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 0.7023 | Val  Acc: 0.7662
 Site-SynthDigits                   | Val  Loss: 1.0296 | Val  Acc: 0.7065
 Site-SynthDigits                   | Val  Loss: 1.0659 | Val  Acc: 0.6799
 Site-MNIST_M                       | Val  Loss: 1.3160 | Val  Acc: 0.6304
 Site-MNIST_M                       | Val  Loss: 1.3030 | Val  Acc: 0.6403
 Site-SVHN                          | Val  Loss: 1.4137 | Val  Acc: 0.5761
 Site-SVHN                          | Val  Loss: 1.4857 | Val  Acc: 0.5144
Average Valid Accuracy: 0.6787
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.7717
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.7950
 Best site-USPS                      | Epoch:30 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:30 | Val Acc: 0.7662
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.7065
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.6799
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.6304
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.6403
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.5761
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.5144
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.6352 | Train Acc: 0.8248
 Site-MNIST                         | Train Loss: 0.6837 | Train Acc: 0.8188
 Site-USPS                          | Train Loss: 0.6380 | Train Acc: 0.8598
 Site-USPS                          | Train Loss: 0.6368 | Train Acc: 0.8045
 Site-SynthDigits                   | Train Loss: 1.1043 | Train Acc: 0.6307
 Site-SynthDigits                   | Train Loss: 0.9950 | Train Acc: 0.7157
 Site-MNIST_M                       | Train Loss: 1.2957 | Train Acc: 0.6092
 Site-MNIST_M                       | Train Loss: 1.3022 | Train Acc: 0.6063
 Site-SVHN                          | Train Loss: 1.5710 | Train Acc: 0.4663
 Site-SVHN                          | Train Loss: 1.4424 | Train Acc: 0.5354
Average Train Accuracy: 0.6872
 Site-MNIST                         | Val  Loss: 0.6802 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 0.6890 | Val  Acc: 0.7986
 Site-USPS                          | Val  Loss: 0.7893 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 0.6993 | Val  Acc: 0.7698
 Site-SynthDigits                   | Val  Loss: 1.0221 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 1.0612 | Val  Acc: 0.6835
 Site-MNIST_M                       | Val  Loss: 1.2933 | Val  Acc: 0.6413
 Site-MNIST_M                       | Val  Loss: 1.2817 | Val  Acc: 0.6547
 Site-SVHN                          | Val  Loss: 1.4190 | Val  Acc: 0.5761
 Site-SVHN                          | Val  Loss: 1.4879 | Val  Acc: 0.5036
Average Valid Accuracy: 0.6845
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.7826
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.7986
 Best site-USPS                      | Epoch:31 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:31 | Val Acc: 0.7698
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.7283
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.6835
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.6413
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.6547
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.5761
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.5036
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.6176 | Train Acc: 0.8329
 Site-MNIST                         | Train Loss: 0.6782 | Train Acc: 0.8206
 Site-USPS                          | Train Loss: 0.6396 | Train Acc: 0.8625
 Site-USPS                          | Train Loss: 0.6450 | Train Acc: 0.8072
 Site-SynthDigits                   | Train Loss: 1.0871 | Train Acc: 0.6199
 Site-SynthDigits                   | Train Loss: 0.9810 | Train Acc: 0.7148
 Site-MNIST_M                       | Train Loss: 1.2800 | Train Acc: 0.6065
 Site-MNIST_M                       | Train Loss: 1.2944 | Train Acc: 0.6099
 Site-SVHN                          | Train Loss: 1.5688 | Train Acc: 0.4663
 Site-SVHN                          | Train Loss: 1.4281 | Train Acc: 0.5444
Average Train Accuracy: 0.6885
 Site-MNIST                         | Val  Loss: 0.6689 | Val  Acc: 0.7717
 Site-MNIST                         | Val  Loss: 0.6824 | Val  Acc: 0.7950
 Site-USPS                          | Val  Loss: 0.7901 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 0.6981 | Val  Acc: 0.7662
 Site-SynthDigits                   | Val  Loss: 1.0055 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 1.0467 | Val  Acc: 0.6799
 Site-MNIST_M                       | Val  Loss: 1.2813 | Val  Acc: 0.6413
 Site-MNIST_M                       | Val  Loss: 1.2750 | Val  Acc: 0.6475
 Site-SVHN                          | Val  Loss: 1.4070 | Val  Acc: 0.5978
 Site-SVHN                          | Val  Loss: 1.4775 | Val  Acc: 0.5252
Average Valid Accuracy: 0.6859
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.7717
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.7950
 Best site-USPS                      | Epoch:32 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:32 | Val Acc: 0.7662
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.7283
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.6799
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.6413
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.6475
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.5978
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.5252
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.6146 | Train Acc: 0.8302
 Site-MNIST                         | Train Loss: 0.6588 | Train Acc: 0.8269
 Site-USPS                          | Train Loss: 0.6257 | Train Acc: 0.8652
 Site-USPS                          | Train Loss: 0.6368 | Train Acc: 0.8063
 Site-SynthDigits                   | Train Loss: 1.0669 | Train Acc: 0.6388
 Site-SynthDigits                   | Train Loss: 0.9733 | Train Acc: 0.7202
 Site-MNIST_M                       | Train Loss: 1.2659 | Train Acc: 0.6038
 Site-MNIST_M                       | Train Loss: 1.2657 | Train Acc: 0.6152
 Site-SVHN                          | Train Loss: 1.5606 | Train Acc: 0.4825
 Site-SVHN                          | Train Loss: 1.4228 | Train Acc: 0.5453
Average Train Accuracy: 0.6934
 Site-MNIST                         | Val  Loss: 0.6529 | Val  Acc: 0.8152
 Site-MNIST                         | Val  Loss: 0.6711 | Val  Acc: 0.8165
 Site-USPS                          | Val  Loss: 0.7866 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.6939 | Val  Acc: 0.7734
 Site-SynthDigits                   | Val  Loss: 0.9938 | Val  Acc: 0.7174
 Site-SynthDigits                   | Val  Loss: 1.0263 | Val  Acc: 0.6978
 Site-MNIST_M                       | Val  Loss: 1.2691 | Val  Acc: 0.6413
 Site-MNIST_M                       | Val  Loss: 1.2519 | Val  Acc: 0.6403
 Site-SVHN                          | Val  Loss: 1.3948 | Val  Acc: 0.5761
 Site-SVHN                          | Val  Loss: 1.4660 | Val  Acc: 0.5216
Average Valid Accuracy: 0.6917
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8152
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8165
 Best site-USPS                      | Epoch:33 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:33 | Val Acc: 0.7734
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.7174
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.6978
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.6413
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.6403
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.5761
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.5216
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.5942 | Train Acc: 0.8383
 Site-MNIST                         | Train Loss: 0.6451 | Train Acc: 0.8278
 Site-USPS                          | Train Loss: 0.6079 | Train Acc: 0.8544
 Site-USPS                          | Train Loss: 0.6059 | Train Acc: 0.8287
 Site-SynthDigits                   | Train Loss: 1.0775 | Train Acc: 0.6388
 Site-SynthDigits                   | Train Loss: 0.9620 | Train Acc: 0.7265
 Site-MNIST_M                       | Train Loss: 1.2474 | Train Acc: 0.6119
 Site-MNIST_M                       | Train Loss: 1.2547 | Train Acc: 0.6305
 Site-SVHN                          | Train Loss: 1.5538 | Train Acc: 0.4879
 Site-SVHN                          | Train Loss: 1.4117 | Train Acc: 0.5525
Average Train Accuracy: 0.6997
 Site-MNIST                         | Val  Loss: 0.6441 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 0.6612 | Val  Acc: 0.7986
 Site-USPS                          | Val  Loss: 0.7680 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 0.6515 | Val  Acc: 0.7878
 Site-SynthDigits                   | Val  Loss: 0.9962 | Val  Acc: 0.7174
 Site-SynthDigits                   | Val  Loss: 1.0369 | Val  Acc: 0.6942
 Site-MNIST_M                       | Val  Loss: 1.2375 | Val  Acc: 0.6957
 Site-MNIST_M                       | Val  Loss: 1.2418 | Val  Acc: 0.6655
 Site-SVHN                          | Val  Loss: 1.3766 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.4567 | Val  Acc: 0.5360
Average Valid Accuracy: 0.7025
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.7826
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.7986
 Best site-USPS                      | Epoch:34 | Val Acc: 0.7391
 Best site-USPS                      | Epoch:34 | Val Acc: 0.7878
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.7174
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.6942
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.6957
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.6655
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.6087
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.5360
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.5889 | Train Acc: 0.8383
 Site-MNIST                         | Train Loss: 0.6416 | Train Acc: 0.8377
 Site-USPS                          | Train Loss: 0.6051 | Train Acc: 0.8544
 Site-USPS                          | Train Loss: 0.6081 | Train Acc: 0.8260
 Site-SynthDigits                   | Train Loss: 1.0583 | Train Acc: 0.6415
 Site-SynthDigits                   | Train Loss: 0.9454 | Train Acc: 0.7300
 Site-MNIST_M                       | Train Loss: 1.2498 | Train Acc: 0.6119
 Site-MNIST_M                       | Train Loss: 1.2474 | Train Acc: 0.6251
 Site-SVHN                          | Train Loss: 1.5370 | Train Acc: 0.5013
 Site-SVHN                          | Train Loss: 1.3931 | Train Acc: 0.5534
Average Train Accuracy: 0.7020
 Site-MNIST                         | Val  Loss: 0.6397 | Val  Acc: 0.8261
 Site-MNIST                         | Val  Loss: 0.6530 | Val  Acc: 0.8165
 Site-USPS                          | Val  Loss: 0.7645 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.6489 | Val  Acc: 0.7806
 Site-SynthDigits                   | Val  Loss: 0.9805 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 1.0139 | Val  Acc: 0.6942
 Site-MNIST_M                       | Val  Loss: 1.2396 | Val  Acc: 0.6739
 Site-MNIST_M                       | Val  Loss: 1.2320 | Val  Acc: 0.6619
 Site-SVHN                          | Val  Loss: 1.3605 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.4413 | Val  Acc: 0.5360
Average Valid Accuracy: 0.7044
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.8261
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.8165
 Best site-USPS                      | Epoch:35 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:35 | Val Acc: 0.7806
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.7283
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.6942
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.6739
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.6619
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.6087
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.5360
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.5846 | Train Acc: 0.8302
 Site-MNIST                         | Train Loss: 0.6303 | Train Acc: 0.8350
 Site-USPS                          | Train Loss: 0.6021 | Train Acc: 0.8544
 Site-USPS                          | Train Loss: 0.5883 | Train Acc: 0.8188
 Site-SynthDigits                   | Train Loss: 1.0439 | Train Acc: 0.6442
 Site-SynthDigits                   | Train Loss: 0.9409 | Train Acc: 0.7318
 Site-MNIST_M                       | Train Loss: 1.2310 | Train Acc: 0.6119
 Site-MNIST_M                       | Train Loss: 1.2262 | Train Acc: 0.6448
 Site-SVHN                          | Train Loss: 1.5335 | Train Acc: 0.5067
 Site-SVHN                          | Train Loss: 1.3839 | Train Acc: 0.5605
Average Train Accuracy: 0.7038
 Site-MNIST                         | Val  Loss: 0.6300 | Val  Acc: 0.8043
 Site-MNIST                         | Val  Loss: 0.6440 | Val  Acc: 0.8129
 Site-USPS                          | Val  Loss: 0.7606 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.6424 | Val  Acc: 0.7770
 Site-SynthDigits                   | Val  Loss: 0.9756 | Val  Acc: 0.7065
 Site-SynthDigits                   | Val  Loss: 1.0108 | Val  Acc: 0.6871
 Site-MNIST_M                       | Val  Loss: 1.2130 | Val  Acc: 0.6957
 Site-MNIST_M                       | Val  Loss: 1.2176 | Val  Acc: 0.6727
 Site-SVHN                          | Val  Loss: 1.3475 | Val  Acc: 0.5978
 Site-SVHN                          | Val  Loss: 1.4290 | Val  Acc: 0.5540
Average Valid Accuracy: 0.7036
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.5819 | Train Acc: 0.8329
 Site-MNIST                         | Train Loss: 0.6264 | Train Acc: 0.8395
 Site-USPS                          | Train Loss: 0.6008 | Train Acc: 0.8544
 Site-USPS                          | Train Loss: 0.5919 | Train Acc: 0.8170
 Site-SynthDigits                   | Train Loss: 1.0413 | Train Acc: 0.6415
 Site-SynthDigits                   | Train Loss: 0.9199 | Train Acc: 0.7336
 Site-MNIST_M                       | Train Loss: 1.2240 | Train Acc: 0.6226
 Site-MNIST_M                       | Train Loss: 1.2164 | Train Acc: 0.6368
 Site-SVHN                          | Train Loss: 1.5100 | Train Acc: 0.5121
 Site-SVHN                          | Train Loss: 1.3595 | Train Acc: 0.5650
Average Train Accuracy: 0.7056
 Site-MNIST                         | Val  Loss: 0.6216 | Val  Acc: 0.8043
 Site-MNIST                         | Val  Loss: 0.6342 | Val  Acc: 0.8201
 Site-USPS                          | Val  Loss: 0.7622 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.6490 | Val  Acc: 0.7698
 Site-SynthDigits                   | Val  Loss: 0.9584 | Val  Acc: 0.7391
 Site-SynthDigits                   | Val  Loss: 0.9896 | Val  Acc: 0.6942
 Site-MNIST_M                       | Val  Loss: 1.2073 | Val  Acc: 0.6848
 Site-MNIST_M                       | Val  Loss: 1.2046 | Val  Acc: 0.6619
 Site-SVHN                          | Val  Loss: 1.3374 | Val  Acc: 0.5978
 Site-SVHN                          | Val  Loss: 1.4184 | Val  Acc: 0.5540
Average Valid Accuracy: 0.7054
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8043
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8201
 Best site-USPS                      | Epoch:37 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:37 | Val Acc: 0.7698
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.7391
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.6942
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.6848
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.6619
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.5978
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.5540
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.5769 | Train Acc: 0.8302
 Site-MNIST                         | Train Loss: 0.6234 | Train Acc: 0.8332
 Site-USPS                          | Train Loss: 0.6068 | Train Acc: 0.8464
 Site-USPS                          | Train Loss: 0.6094 | Train Acc: 0.8099
 Site-SynthDigits                   | Train Loss: 1.0190 | Train Acc: 0.6496
 Site-SynthDigits                   | Train Loss: 0.9096 | Train Acc: 0.7345
 Site-MNIST_M                       | Train Loss: 1.2130 | Train Acc: 0.6253
 Site-MNIST_M                       | Train Loss: 1.2030 | Train Acc: 0.6404
 Site-SVHN                          | Train Loss: 1.5020 | Train Acc: 0.5040
 Site-SVHN                          | Train Loss: 1.3617 | Train Acc: 0.5605
Average Train Accuracy: 0.7034
 Site-MNIST                         | Val  Loss: 0.6158 | Val  Acc: 0.8043
 Site-MNIST                         | Val  Loss: 0.6384 | Val  Acc: 0.8094
 Site-USPS                          | Val  Loss: 0.7724 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.6617 | Val  Acc: 0.7626
 Site-SynthDigits                   | Val  Loss: 0.9479 | Val  Acc: 0.7174
 Site-SynthDigits                   | Val  Loss: 0.9672 | Val  Acc: 0.6978
 Site-MNIST_M                       | Val  Loss: 1.1953 | Val  Acc: 0.6739
 Site-MNIST_M                       | Val  Loss: 1.1890 | Val  Acc: 0.6655
 Site-SVHN                          | Val  Loss: 1.3412 | Val  Acc: 0.5870
 Site-SVHN                          | Val  Loss: 1.4235 | Val  Acc: 0.5360
Average Valid Accuracy: 0.6971
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.5633 | Train Acc: 0.8356
 Site-MNIST                         | Train Loss: 0.6102 | Train Acc: 0.8386
 Site-USPS                          | Train Loss: 0.5895 | Train Acc: 0.8464
 Site-USPS                          | Train Loss: 0.5846 | Train Acc: 0.8269
 Site-SynthDigits                   | Train Loss: 1.0140 | Train Acc: 0.6334
 Site-SynthDigits                   | Train Loss: 0.9108 | Train Acc: 0.7390
 Site-MNIST_M                       | Train Loss: 1.1904 | Train Acc: 0.6361
 Site-MNIST_M                       | Train Loss: 1.1861 | Train Acc: 0.6448
 Site-SVHN                          | Train Loss: 1.5034 | Train Acc: 0.5013
 Site-SVHN                          | Train Loss: 1.3506 | Train Acc: 0.5614
Average Train Accuracy: 0.7064
 Site-MNIST                         | Val  Loss: 0.5995 | Val  Acc: 0.7935
 Site-MNIST                         | Val  Loss: 0.6180 | Val  Acc: 0.8129
 Site-USPS                          | Val  Loss: 0.7601 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.6292 | Val  Acc: 0.7770
 Site-SynthDigits                   | Val  Loss: 0.9432 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 0.9804 | Val  Acc: 0.7014
 Site-MNIST_M                       | Val  Loss: 1.1645 | Val  Acc: 0.6957
 Site-MNIST_M                       | Val  Loss: 1.1782 | Val  Acc: 0.6655
 Site-SVHN                          | Val  Loss: 1.3326 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.4217 | Val  Acc: 0.5396
Average Valid Accuracy: 0.7051
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.5573 | Train Acc: 0.8356
 Site-MNIST                         | Train Loss: 0.6006 | Train Acc: 0.8413
 Site-USPS                          | Train Loss: 0.5713 | Train Acc: 0.8518
 Site-USPS                          | Train Loss: 0.5620 | Train Acc: 0.8296
 Site-SynthDigits                   | Train Loss: 1.0097 | Train Acc: 0.6577
 Site-SynthDigits                   | Train Loss: 0.8902 | Train Acc: 0.7462
 Site-MNIST_M                       | Train Loss: 1.1834 | Train Acc: 0.6361
 Site-MNIST_M                       | Train Loss: 1.1717 | Train Acc: 0.6511
 Site-SVHN                          | Train Loss: 1.4937 | Train Acc: 0.5121
 Site-SVHN                          | Train Loss: 1.3379 | Train Acc: 0.5731
Average Train Accuracy: 0.7135
 Site-MNIST                         | Val  Loss: 0.5957 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 0.6156 | Val  Acc: 0.8165
 Site-USPS                          | Val  Loss: 0.7499 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 0.6249 | Val  Acc: 0.7734
 Site-SynthDigits                   | Val  Loss: 0.9263 | Val  Acc: 0.7391
 Site-SynthDigits                   | Val  Loss: 0.9598 | Val  Acc: 0.7050
 Site-MNIST_M                       | Val  Loss: 1.1596 | Val  Acc: 0.6739
 Site-MNIST_M                       | Val  Loss: 1.1637 | Val  Acc: 0.6727
 Site-SVHN                          | Val  Loss: 1.3172 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.4045 | Val  Acc: 0.5504
Average Valid Accuracy: 0.7072
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.7826
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.8165
 Best site-USPS                      | Epoch:40 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:40 | Val Acc: 0.7734
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.7391
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.7050
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.6739
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.6727
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.6087
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.5504
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.5504 | Train Acc: 0.8356
 Site-MNIST                         | Train Loss: 0.5921 | Train Acc: 0.8448
 Site-USPS                          | Train Loss: 0.5794 | Train Acc: 0.8437
 Site-USPS                          | Train Loss: 0.5710 | Train Acc: 0.8224
 Site-SynthDigits                   | Train Loss: 0.9924 | Train Acc: 0.6550
 Site-SynthDigits                   | Train Loss: 0.8858 | Train Acc: 0.7516
 Site-MNIST_M                       | Train Loss: 1.1915 | Train Acc: 0.6280
 Site-MNIST_M                       | Train Loss: 1.1819 | Train Acc: 0.6395
 Site-SVHN                          | Train Loss: 1.4642 | Train Acc: 0.5067
 Site-SVHN                          | Train Loss: 1.3070 | Train Acc: 0.5821
Average Train Accuracy: 0.7109
 Site-MNIST                         | Val  Loss: 0.5894 | Val  Acc: 0.8261
 Site-MNIST                         | Val  Loss: 0.6089 | Val  Acc: 0.8309
 Site-USPS                          | Val  Loss: 0.7526 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 0.6267 | Val  Acc: 0.7698
 Site-SynthDigits                   | Val  Loss: 0.9219 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 0.9486 | Val  Acc: 0.7014
 Site-MNIST_M                       | Val  Loss: 1.1705 | Val  Acc: 0.6522
 Site-MNIST_M                       | Val  Loss: 1.1728 | Val  Acc: 0.6619
 Site-SVHN                          | Val  Loss: 1.2904 | Val  Acc: 0.6304
 Site-SVHN                          | Val  Loss: 1.3771 | Val  Acc: 0.5576
Average Valid Accuracy: 0.7098
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.8261
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.8309
 Best site-USPS                      | Epoch:41 | Val Acc: 0.7391
 Best site-USPS                      | Epoch:41 | Val Acc: 0.7698
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.7283
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.7014
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.6522
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.6619
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.6304
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.5576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.5540 | Train Acc: 0.8383
 Site-MNIST                         | Train Loss: 0.5866 | Train Acc: 0.8448
 Site-USPS                          | Train Loss: 0.5912 | Train Acc: 0.8410
 Site-USPS                          | Train Loss: 0.5877 | Train Acc: 0.8215
 Site-SynthDigits                   | Train Loss: 0.9780 | Train Acc: 0.6631
 Site-SynthDigits                   | Train Loss: 0.8707 | Train Acc: 0.7471
 Site-MNIST_M                       | Train Loss: 1.1745 | Train Acc: 0.6280
 Site-MNIST_M                       | Train Loss: 1.1657 | Train Acc: 0.6538
 Site-SVHN                          | Train Loss: 1.4633 | Train Acc: 0.5148
 Site-SVHN                          | Train Loss: 1.3111 | Train Acc: 0.5794
Average Train Accuracy: 0.7132
 Site-MNIST                         | Val  Loss: 0.5882 | Val  Acc: 0.8152
 Site-MNIST                         | Val  Loss: 0.6034 | Val  Acc: 0.8273
 Site-USPS                          | Val  Loss: 0.7604 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 0.6386 | Val  Acc: 0.7662
 Site-SynthDigits                   | Val  Loss: 0.9054 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 0.9331 | Val  Acc: 0.7050
 Site-MNIST_M                       | Val  Loss: 1.1419 | Val  Acc: 0.6957
 Site-MNIST_M                       | Val  Loss: 1.1477 | Val  Acc: 0.6727
 Site-SVHN                          | Val  Loss: 1.3016 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.3816 | Val  Acc: 0.5540
Average Valid Accuracy: 0.7101
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8152
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8273
 Best site-USPS                      | Epoch:42 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:42 | Val Acc: 0.7662
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.7283
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.7050
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.6957
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.6727
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.6087
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.5540
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.5394 | Train Acc: 0.8437
 Site-MNIST                         | Train Loss: 0.5801 | Train Acc: 0.8457
 Site-USPS                          | Train Loss: 0.5757 | Train Acc: 0.8491
 Site-USPS                          | Train Loss: 0.5583 | Train Acc: 0.8278
 Site-SynthDigits                   | Train Loss: 0.9698 | Train Acc: 0.6712
 Site-SynthDigits                   | Train Loss: 0.8628 | Train Acc: 0.7570
 Site-MNIST_M                       | Train Loss: 1.1655 | Train Acc: 0.6253
 Site-MNIST_M                       | Train Loss: 1.1459 | Train Acc: 0.6583
 Site-SVHN                          | Train Loss: 1.4597 | Train Acc: 0.5202
 Site-SVHN                          | Train Loss: 1.3039 | Train Acc: 0.5812
Average Train Accuracy: 0.7179
 Site-MNIST                         | Val  Loss: 0.5698 | Val  Acc: 0.8370
 Site-MNIST                         | Val  Loss: 0.5935 | Val  Acc: 0.8273
 Site-USPS                          | Val  Loss: 0.7508 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.6277 | Val  Acc: 0.7698
 Site-SynthDigits                   | Val  Loss: 0.9012 | Val  Acc: 0.7391
 Site-SynthDigits                   | Val  Loss: 0.9189 | Val  Acc: 0.7158
 Site-MNIST_M                       | Val  Loss: 1.1305 | Val  Acc: 0.6848
 Site-MNIST_M                       | Val  Loss: 1.1321 | Val  Acc: 0.6655
 Site-SVHN                          | Val  Loss: 1.2985 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.3813 | Val  Acc: 0.5540
Average Valid Accuracy: 0.7119
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8370
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8273
 Best site-USPS                      | Epoch:43 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:43 | Val Acc: 0.7698
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.7391
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.7158
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.6848
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.6655
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.6087
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.5540
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.5374 | Train Acc: 0.8383
 Site-MNIST                         | Train Loss: 0.5746 | Train Acc: 0.8448
 Site-USPS                          | Train Loss: 0.5604 | Train Acc: 0.8518
 Site-USPS                          | Train Loss: 0.5529 | Train Acc: 0.8278
 Site-SynthDigits                   | Train Loss: 0.9674 | Train Acc: 0.6739
 Site-SynthDigits                   | Train Loss: 0.8450 | Train Acc: 0.7596
 Site-MNIST_M                       | Train Loss: 1.1584 | Train Acc: 0.6280
 Site-MNIST_M                       | Train Loss: 1.1340 | Train Acc: 0.6717
 Site-SVHN                          | Train Loss: 1.4478 | Train Acc: 0.5283
 Site-SVHN                          | Train Loss: 1.2937 | Train Acc: 0.5857
Average Train Accuracy: 0.7210
 Site-MNIST                         | Val  Loss: 0.5719 | Val  Acc: 0.8152
 Site-MNIST                         | Val  Loss: 0.5934 | Val  Acc: 0.8237
 Site-USPS                          | Val  Loss: 0.7424 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 0.6121 | Val  Acc: 0.7770
 Site-SynthDigits                   | Val  Loss: 0.8918 | Val  Acc: 0.7391
 Site-SynthDigits                   | Val  Loss: 0.9177 | Val  Acc: 0.7194
 Site-MNIST_M                       | Val  Loss: 1.1191 | Val  Acc: 0.6848
 Site-MNIST_M                       | Val  Loss: 1.1262 | Val  Acc: 0.6763
 Site-SVHN                          | Val  Loss: 1.2717 | Val  Acc: 0.6304
 Site-SVHN                          | Val  Loss: 1.3606 | Val  Acc: 0.5755
Average Valid Accuracy: 0.7192
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8152
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8237
 Best site-USPS                      | Epoch:44 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:44 | Val Acc: 0.7770
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.7391
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.7194
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.6848
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.6763
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.6304
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.5755
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.5395 | Train Acc: 0.8464
 Site-MNIST                         | Train Loss: 0.5623 | Train Acc: 0.8529
 Site-USPS                          | Train Loss: 0.5753 | Train Acc: 0.8464
 Site-USPS                          | Train Loss: 0.5602 | Train Acc: 0.8233
 Site-SynthDigits                   | Train Loss: 0.9534 | Train Acc: 0.6712
 Site-SynthDigits                   | Train Loss: 0.8537 | Train Acc: 0.7561
 Site-MNIST_M                       | Train Loss: 1.1450 | Train Acc: 0.6199
 Site-MNIST_M                       | Train Loss: 1.1225 | Train Acc: 0.6664
 Site-SVHN                          | Train Loss: 1.4382 | Train Acc: 0.5391
 Site-SVHN                          | Train Loss: 1.2844 | Train Acc: 0.5848
Average Train Accuracy: 0.7206
 Site-MNIST                         | Val  Loss: 0.5538 | Val  Acc: 0.8261
 Site-MNIST                         | Val  Loss: 0.5823 | Val  Acc: 0.8417
 Site-USPS                          | Val  Loss: 0.7489 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 0.6210 | Val  Acc: 0.7698
 Site-SynthDigits                   | Val  Loss: 0.8891 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 0.9079 | Val  Acc: 0.7086
 Site-MNIST_M                       | Val  Loss: 1.0994 | Val  Acc: 0.7065
 Site-MNIST_M                       | Val  Loss: 1.1132 | Val  Acc: 0.6691
 Site-SVHN                          | Val  Loss: 1.2794 | Val  Acc: 0.6196
 Site-SVHN                          | Val  Loss: 1.3627 | Val  Acc: 0.5647
Average Valid Accuracy: 0.7174
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.5308 | Train Acc: 0.8491
 Site-MNIST                         | Train Loss: 0.5635 | Train Acc: 0.8502
 Site-USPS                          | Train Loss: 0.5730 | Train Acc: 0.8491
 Site-USPS                          | Train Loss: 0.5682 | Train Acc: 0.8215
 Site-SynthDigits                   | Train Loss: 0.9408 | Train Acc: 0.6900
 Site-SynthDigits                   | Train Loss: 0.8343 | Train Acc: 0.7578
 Site-MNIST_M                       | Train Loss: 1.1535 | Train Acc: 0.6119
 Site-MNIST_M                       | Train Loss: 1.1245 | Train Acc: 0.6628
 Site-SVHN                          | Train Loss: 1.4201 | Train Acc: 0.5445
 Site-SVHN                          | Train Loss: 1.2611 | Train Acc: 0.5964
Average Train Accuracy: 0.7233
 Site-MNIST                         | Val  Loss: 0.5495 | Val  Acc: 0.8261
 Site-MNIST                         | Val  Loss: 0.5787 | Val  Acc: 0.8381
 Site-USPS                          | Val  Loss: 0.7504 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.6263 | Val  Acc: 0.7734
 Site-SynthDigits                   | Val  Loss: 0.8844 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 0.8954 | Val  Acc: 0.7266
 Site-MNIST_M                       | Val  Loss: 1.1055 | Val  Acc: 0.6848
 Site-MNIST_M                       | Val  Loss: 1.1159 | Val  Acc: 0.6619
 Site-SVHN                          | Val  Loss: 1.2554 | Val  Acc: 0.6413
 Site-SVHN                          | Val  Loss: 1.3403 | Val  Acc: 0.5863
Average Valid Accuracy: 0.7184
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.5243 | Train Acc: 0.8491
 Site-MNIST                         | Train Loss: 0.5466 | Train Acc: 0.8538
 Site-USPS                          | Train Loss: 0.5588 | Train Acc: 0.8518
 Site-USPS                          | Train Loss: 0.5479 | Train Acc: 0.8341
 Site-SynthDigits                   | Train Loss: 0.9401 | Train Acc: 0.6846
 Site-SynthDigits                   | Train Loss: 0.8241 | Train Acc: 0.7561
 Site-MNIST_M                       | Train Loss: 1.1281 | Train Acc: 0.6334
 Site-MNIST_M                       | Train Loss: 1.1013 | Train Acc: 0.6753
 Site-SVHN                          | Train Loss: 1.4167 | Train Acc: 0.5445
 Site-SVHN                          | Train Loss: 1.2587 | Train Acc: 0.5991
Average Train Accuracy: 0.7282
 Site-MNIST                         | Val  Loss: 0.5511 | Val  Acc: 0.8261
 Site-MNIST                         | Val  Loss: 0.5752 | Val  Acc: 0.8345
 Site-USPS                          | Val  Loss: 0.7339 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 0.6011 | Val  Acc: 0.7806
 Site-SynthDigits                   | Val  Loss: 0.8742 | Val  Acc: 0.7391
 Site-SynthDigits                   | Val  Loss: 0.8907 | Val  Acc: 0.7194
 Site-MNIST_M                       | Val  Loss: 1.0765 | Val  Acc: 0.7065
 Site-MNIST_M                       | Val  Loss: 1.0904 | Val  Acc: 0.6871
 Site-SVHN                          | Val  Loss: 1.2492 | Val  Acc: 0.6304
 Site-SVHN                          | Val  Loss: 1.3371 | Val  Acc: 0.5791
Average Valid Accuracy: 0.7242
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.8261
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.8345
 Best site-USPS                      | Epoch:47 | Val Acc: 0.7391
 Best site-USPS                      | Epoch:47 | Val Acc: 0.7806
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.7391
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.7194
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.7065
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.6871
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.6304
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.5791
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.5249 | Train Acc: 0.8410
 Site-MNIST                         | Train Loss: 0.5532 | Train Acc: 0.8547
 Site-USPS                          | Train Loss: 0.5685 | Train Acc: 0.8464
 Site-USPS                          | Train Loss: 0.5650 | Train Acc: 0.8215
 Site-SynthDigits                   | Train Loss: 0.9318 | Train Acc: 0.6954
 Site-SynthDigits                   | Train Loss: 0.8175 | Train Acc: 0.7605
 Site-MNIST_M                       | Train Loss: 1.1289 | Train Acc: 0.6146
 Site-MNIST_M                       | Train Loss: 1.0993 | Train Acc: 0.6664
 Site-SVHN                          | Train Loss: 1.4062 | Train Acc: 0.5391
 Site-SVHN                          | Train Loss: 1.2494 | Train Acc: 0.6036
Average Train Accuracy: 0.7243
 Site-MNIST                         | Val  Loss: 0.5339 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.5719 | Val  Acc: 0.8453
 Site-USPS                          | Val  Loss: 0.7474 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 0.6227 | Val  Acc: 0.7698
 Site-SynthDigits                   | Val  Loss: 0.8668 | Val  Acc: 0.7609
 Site-SynthDigits                   | Val  Loss: 0.8726 | Val  Acc: 0.7374
 Site-MNIST_M                       | Val  Loss: 1.0744 | Val  Acc: 0.7174
 Site-MNIST_M                       | Val  Loss: 1.0851 | Val  Acc: 0.6799
 Site-SVHN                          | Val  Loss: 1.2403 | Val  Acc: 0.6413
 Site-SVHN                          | Val  Loss: 1.3300 | Val  Acc: 0.5863
Average Valid Accuracy: 0.7303
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.8478
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.8453
 Best site-USPS                      | Epoch:48 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:48 | Val Acc: 0.7698
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.7609
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.7374
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.7174
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.6799
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.6413
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.5863
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.5155 | Train Acc: 0.8464
 Site-MNIST                         | Train Loss: 0.5414 | Train Acc: 0.8565
 Site-USPS                          | Train Loss: 0.5560 | Train Acc: 0.8518
 Site-USPS                          | Train Loss: 0.5442 | Train Acc: 0.8269
 Site-SynthDigits                   | Train Loss: 0.9220 | Train Acc: 0.6873
 Site-SynthDigits                   | Train Loss: 0.8156 | Train Acc: 0.7623
 Site-MNIST_M                       | Train Loss: 1.1210 | Train Acc: 0.6253
 Site-MNIST_M                       | Train Loss: 1.0747 | Train Acc: 0.6816
 Site-SVHN                          | Train Loss: 1.4119 | Train Acc: 0.5364
 Site-SVHN                          | Train Loss: 1.2510 | Train Acc: 0.6081
Average Train Accuracy: 0.7283
 Site-MNIST                         | Val  Loss: 0.5235 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.5599 | Val  Acc: 0.8489
 Site-USPS                          | Val  Loss: 0.7324 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 0.5957 | Val  Acc: 0.7878
 Site-SynthDigits                   | Val  Loss: 0.8754 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 0.8822 | Val  Acc: 0.7302
 Site-MNIST_M                       | Val  Loss: 1.0465 | Val  Acc: 0.7174
 Site-MNIST_M                       | Val  Loss: 1.0751 | Val  Acc: 0.6942
 Site-SVHN                          | Val  Loss: 1.2337 | Val  Acc: 0.6196
 Site-SVHN                          | Val  Loss: 1.3257 | Val  Acc: 0.5827
Average Valid Accuracy: 0.7296
===2023-06-30 20:46:34===
===2023-06-30 20:46:50===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.8456
 Test site-USPS                      | Epoch:48 | Test Acc: 0.8237
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.7205
 Test site-MNIST_M                   | Epoch:48 | Test Acc: 0.5661
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.4874
MNIST: 0.8456, USPS: 0.8237, SynthDigits: 0.7205, MNIST_M: 0.5661, SVHN: 0.4874, 
Average Test Accuracy(group): 0.6886, Average Test Accuracy(individual): 0.6886,
domain std=0.1410, cluster std=-1.0000, individual std=0.1410, 
