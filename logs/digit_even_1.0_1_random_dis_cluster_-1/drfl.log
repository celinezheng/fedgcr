===2023-06-04 11:14:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                    | Train Loss: 2.2497 | Train Acc: 0.2264
 Site-MNIST                    | Train Loss: 2.2568 | Train Acc: 0.2197
 Site-USPS                     | Train Loss: 2.2510 | Train Acc: 0.2561
 Site-USPS                     | Train Loss: 2.2463 | Train Acc: 0.2673
 Site-SynthDigits              | Train Loss: 2.2932 | Train Acc: 0.1294
 Site-SynthDigits              | Train Loss: 2.2832 | Train Acc: 0.1641
 Site-MNIST-M                  | Train Loss: 2.2996 | Train Acc: 0.1186
 Site-MNIST-M                  | Train Loss: 2.2982 | Train Acc: 0.1040
 Site-SVHN                     | Train Loss: 2.2821 | Train Acc: 0.1456
 Site-SVHN                     | Train Loss: 2.2868 | Train Acc: 0.1426
 Site-MNIST                         | Val  Loss: 2.2631 | Val  Acc: 0.1522
 Site-MNIST                         | Val  Loss: 2.2538 | Val  Acc: 0.1978
 Site-USPS                          | Val  Loss: 2.2520 | Val  Acc: 0.2609
 Site-USPS                          | Val  Loss: 2.2487 | Val  Acc: 0.2698
 Site-SynthDigits                   | Val  Loss: 2.2888 | Val  Acc: 0.1413
 Site-SynthDigits                   | Val  Loss: 2.2936 | Val  Acc: 0.1079
 Site-MNIST-M                       | Val  Loss: 2.3046 | Val  Acc: 0.0652
 Site-MNIST-M                       | Val  Loss: 2.3003 | Val  Acc: 0.0935
 Site-SVHN                          | Val  Loss: 2.2840 | Val  Acc: 0.1630
 Site-SVHN                          | Val  Loss: 2.2862 | Val  Acc: 0.1403
Average Valid Accuracy: 0.1592
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1522
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1978
 Best site-USPS                      | Epoch:0 | Val Acc: 0.2609
 Best site-USPS                      | Epoch:0 | Val Acc: 0.2698
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1413
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1079
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.0652
 Best site-MNIST-M                   | Epoch:0 | Val Acc: 0.0935
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1630
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1403
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 1 ============
 Site-MNIST                    | Train Loss: 2.2037 | Train Acc: 0.4367
 Site-MNIST                    | Train Loss: 2.2200 | Train Acc: 0.3614
 Site-USPS                     | Train Loss: 2.1948 | Train Acc: 0.4474
 Site-USPS                     | Train Loss: 2.1893 | Train Acc: 0.4816
 Site-SynthDigits              | Train Loss: 2.2823 | Train Acc: 0.1590
 Site-SynthDigits              | Train Loss: 2.2669 | Train Acc: 0.2099
 Site-MNIST-M                  | Train Loss: 2.2934 | Train Acc: 0.1213
 Site-MNIST-M                  | Train Loss: 2.2921 | Train Acc: 0.1085
 Site-SVHN                     | Train Loss: 2.2714 | Train Acc: 0.1941
 Site-SVHN                     | Train Loss: 2.2759 | Train Acc: 0.1830
 Site-MNIST                         | Val  Loss: 2.2274 | Val  Acc: 0.2609
 Site-MNIST                         | Val  Loss: 2.2147 | Val  Acc: 0.3813
 Site-USPS                          | Val  Loss: 2.2012 | Val  Acc: 0.4130
 Site-USPS                          | Val  Loss: 2.1974 | Val  Acc: 0.4496
 Site-SynthDigits                   | Val  Loss: 2.2717 | Val  Acc: 0.2065
 Site-SynthDigits                   | Val  Loss: 2.2797 | Val  Acc: 0.1511
 Site-MNIST-M                       | Val  Loss: 2.2984 | Val  Acc: 0.0652
 Site-MNIST-M                       | Val  Loss: 2.2932 | Val  Acc: 0.1043
 Site-SVHN                          | Val  Loss: 2.2701 | Val  Acc: 0.2065
 Site-SVHN                          | Val  Loss: 2.2737 | Val  Acc: 0.2050
Average Valid Accuracy: 0.2444
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.2609
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.3813
 Best site-USPS                      | Epoch:1 | Val Acc: 0.4130
 Best site-USPS                      | Epoch:1 | Val Acc: 0.4496
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2065
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.1511
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.0652
 Best site-MNIST-M                   | Epoch:1 | Val Acc: 0.1043
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2065
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2050
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 2 ============
 Site-MNIST                    | Train Loss: 2.1612 | Train Acc: 0.5202
 Site-MNIST                    | Train Loss: 2.1841 | Train Acc: 0.4448
 Site-USPS                     | Train Loss: 2.1416 | Train Acc: 0.5229
 Site-USPS                     | Train Loss: 2.1357 | Train Acc: 0.5641
 Site-SynthDigits              | Train Loss: 2.2709 | Train Acc: 0.1914
 Site-SynthDigits              | Train Loss: 2.2509 | Train Acc: 0.2538
 Site-MNIST-M                  | Train Loss: 2.2868 | Train Acc: 0.1348
 Site-MNIST-M                  | Train Loss: 2.2859 | Train Acc: 0.1229
 Site-SVHN                     | Train Loss: 2.2616 | Train Acc: 0.2318
 Site-SVHN                     | Train Loss: 2.2658 | Train Acc: 0.2027
 Site-MNIST                         | Val  Loss: 2.1923 | Val  Acc: 0.4022
 Site-MNIST                         | Val  Loss: 2.1766 | Val  Acc: 0.4640
 Site-USPS                          | Val  Loss: 2.1533 | Val  Acc: 0.4891
 Site-USPS                          | Val  Loss: 2.1490 | Val  Acc: 0.5072
 Site-SynthDigits                   | Val  Loss: 2.2554 | Val  Acc: 0.2500
 Site-SynthDigits                   | Val  Loss: 2.2660 | Val  Acc: 0.1978
 Site-MNIST-M                       | Val  Loss: 2.2924 | Val  Acc: 0.0543
 Site-MNIST-M                       | Val  Loss: 2.2862 | Val  Acc: 0.1043
 Site-SVHN                          | Val  Loss: 2.2572 | Val  Acc: 0.2391
 Site-SVHN                          | Val  Loss: 2.2623 | Val  Acc: 0.2338
Average Valid Accuracy: 0.2942
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.4022
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.4640
 Best site-USPS                      | Epoch:2 | Val Acc: 0.4891
 Best site-USPS                      | Epoch:2 | Val Acc: 0.5072
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2500
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.1978
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.0543
 Best site-MNIST-M                   | Epoch:2 | Val Acc: 0.1043
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2391
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2338
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 3 ============
 Site-MNIST                    | Train Loss: 2.1158 | Train Acc: 0.5499
 Site-MNIST                    | Train Loss: 2.1473 | Train Acc: 0.4691
 Site-USPS                     | Train Loss: 2.0918 | Train Acc: 0.5526
 Site-USPS                     | Train Loss: 2.0847 | Train Acc: 0.5857
 Site-SynthDigits              | Train Loss: 2.2587 | Train Acc: 0.2183
 Site-SynthDigits              | Train Loss: 2.2351 | Train Acc: 0.2825
 Site-MNIST-M                  | Train Loss: 2.2790 | Train Acc: 0.1590
 Site-MNIST-M                  | Train Loss: 2.2792 | Train Acc: 0.1435
 Site-SVHN                     | Train Loss: 2.2513 | Train Acc: 0.2453
 Site-SVHN                     | Train Loss: 2.2571 | Train Acc: 0.2143
 Site-MNIST                         | Val  Loss: 2.1563 | Val  Acc: 0.4348
 Site-MNIST                         | Val  Loss: 2.1380 | Val  Acc: 0.4856
 Site-USPS                          | Val  Loss: 2.1076 | Val  Acc: 0.5326
 Site-USPS                          | Val  Loss: 2.1030 | Val  Acc: 0.5288
 Site-SynthDigits                   | Val  Loss: 2.2397 | Val  Acc: 0.2826
 Site-SynthDigits                   | Val  Loss: 2.2521 | Val  Acc: 0.2374
 Site-MNIST-M                       | Val  Loss: 2.2865 | Val  Acc: 0.0761
 Site-MNIST-M                       | Val  Loss: 2.2792 | Val  Acc: 0.1151
 Site-SVHN                          | Val  Loss: 2.2454 | Val  Acc: 0.2717
 Site-SVHN                          | Val  Loss: 2.2522 | Val  Acc: 0.2554
Average Valid Accuracy: 0.3220
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.4348
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.4856
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5326
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5288
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2826
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2374
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.0761
 Best site-MNIST-M                   | Epoch:3 | Val Acc: 0.1151
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2717
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2554
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 4 ============
 Site-MNIST                    | Train Loss: 2.0758 | Train Acc: 0.5822
 Site-MNIST                    | Train Loss: 2.1114 | Train Acc: 0.4816
 Site-USPS                     | Train Loss: 2.0430 | Train Acc: 0.5768
 Site-USPS                     | Train Loss: 2.0365 | Train Acc: 0.5937
 Site-SynthDigits              | Train Loss: 2.2457 | Train Acc: 0.2318
 Site-SynthDigits              | Train Loss: 2.2189 | Train Acc: 0.3022
 Site-MNIST-M                  | Train Loss: 2.2711 | Train Acc: 0.1833
 Site-MNIST-M                  | Train Loss: 2.2728 | Train Acc: 0.1605
 Site-SVHN                     | Train Loss: 2.2429 | Train Acc: 0.2480
 Site-SVHN                     | Train Loss: 2.2485 | Train Acc: 0.2314
 Site-MNIST                         | Val  Loss: 2.1206 | Val  Acc: 0.4674
 Site-MNIST                         | Val  Loss: 2.1003 | Val  Acc: 0.5216
 Site-USPS                          | Val  Loss: 2.0637 | Val  Acc: 0.5109
 Site-USPS                          | Val  Loss: 2.0591 | Val  Acc: 0.5252
 Site-SynthDigits                   | Val  Loss: 2.2242 | Val  Acc: 0.2826
 Site-SynthDigits                   | Val  Loss: 2.2379 | Val  Acc: 0.2374
 Site-MNIST-M                       | Val  Loss: 2.2803 | Val  Acc: 0.1304
 Site-MNIST-M                       | Val  Loss: 2.2724 | Val  Acc: 0.1511
 Site-SVHN                          | Val  Loss: 2.2349 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.2427 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3383
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.4674
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5216
 Best site-USPS                      | Epoch:4 | Val Acc: 0.5109
 Best site-USPS                      | Epoch:4 | Val Acc: 0.5252
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.2826
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.2374
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.1304
 Best site-MNIST-M                   | Epoch:4 | Val Acc: 0.1511
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 5 ============
 Site-MNIST                    | Train Loss: 2.0360 | Train Acc: 0.6038
 Site-MNIST                    | Train Loss: 2.0762 | Train Acc: 0.4915
 Site-USPS                     | Train Loss: 1.9962 | Train Acc: 0.5876
 Site-USPS                     | Train Loss: 1.9924 | Train Acc: 0.6018
 Site-SynthDigits              | Train Loss: 2.2350 | Train Acc: 0.2399
 Site-SynthDigits              | Train Loss: 2.2028 | Train Acc: 0.3175
 Site-MNIST-M                  | Train Loss: 2.2639 | Train Acc: 0.1968
 Site-MNIST-M                  | Train Loss: 2.2658 | Train Acc: 0.1731
 Site-SVHN                     | Train Loss: 2.2348 | Train Acc: 0.2480
 Site-SVHN                     | Train Loss: 2.2411 | Train Acc: 0.2323
 Site-MNIST                         | Val  Loss: 2.0857 | Val  Acc: 0.4783
 Site-MNIST                         | Val  Loss: 2.0636 | Val  Acc: 0.5252
 Site-USPS                          | Val  Loss: 2.0235 | Val  Acc: 0.5435
 Site-USPS                          | Val  Loss: 2.0190 | Val  Acc: 0.5540
 Site-SynthDigits                   | Val  Loss: 2.2084 | Val  Acc: 0.3152
 Site-SynthDigits                   | Val  Loss: 2.2230 | Val  Acc: 0.2590
 Site-MNIST-M                       | Val  Loss: 2.2734 | Val  Acc: 0.1304
 Site-MNIST-M                       | Val  Loss: 2.2653 | Val  Acc: 0.1547
 Site-SVHN                          | Val  Loss: 2.2254 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.2335 | Val  Acc: 0.2806
Average Valid Accuracy: 0.3545
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.4783
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5252
 Best site-USPS                      | Epoch:5 | Val Acc: 0.5435
 Best site-USPS                      | Epoch:5 | Val Acc: 0.5540
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3152
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.2590
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.1304
 Best site-MNIST-M                   | Epoch:5 | Val Acc: 0.1547
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2806
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 6 ============
 Site-MNIST                    | Train Loss: 2.0000 | Train Acc: 0.6146
 Site-MNIST                    | Train Loss: 2.0446 | Train Acc: 0.5031
 Site-USPS                     | Train Loss: 1.9528 | Train Acc: 0.6038
 Site-USPS                     | Train Loss: 1.9483 | Train Acc: 0.6126
 Site-SynthDigits              | Train Loss: 2.2208 | Train Acc: 0.2588
 Site-SynthDigits              | Train Loss: 2.1864 | Train Acc: 0.3345
 Site-MNIST-M                  | Train Loss: 2.2554 | Train Acc: 0.1968
 Site-MNIST-M                  | Train Loss: 2.2589 | Train Acc: 0.1937
 Site-SVHN                     | Train Loss: 2.2252 | Train Acc: 0.2507
 Site-SVHN                     | Train Loss: 2.2333 | Train Acc: 0.2296
 Site-MNIST                         | Val  Loss: 2.0533 | Val  Acc: 0.5000
 Site-MNIST                         | Val  Loss: 2.0307 | Val  Acc: 0.5396
 Site-USPS                          | Val  Loss: 1.9821 | Val  Acc: 0.5435
 Site-USPS                          | Val  Loss: 1.9777 | Val  Acc: 0.5612
 Site-SynthDigits                   | Val  Loss: 2.1933 | Val  Acc: 0.3370
 Site-SynthDigits                   | Val  Loss: 2.2080 | Val  Acc: 0.2878
 Site-MNIST-M                       | Val  Loss: 2.2658 | Val  Acc: 0.1413
 Site-MNIST-M                       | Val  Loss: 2.2575 | Val  Acc: 0.1799
 Site-SVHN                          | Val  Loss: 2.2166 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.2244 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3668
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.5000
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.5396
 Best site-USPS                      | Epoch:6 | Val Acc: 0.5435
 Best site-USPS                      | Epoch:6 | Val Acc: 0.5612
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3370
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.2878
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.1413
 Best site-MNIST-M                   | Epoch:6 | Val Acc: 0.1799
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 7 ============
 Site-MNIST                    | Train Loss: 1.9646 | Train Acc: 0.6307
 Site-MNIST                    | Train Loss: 2.0133 | Train Acc: 0.5103
 Site-USPS                     | Train Loss: 1.9142 | Train Acc: 0.5984
 Site-USPS                     | Train Loss: 1.9079 | Train Acc: 0.6161
 Site-SynthDigits              | Train Loss: 2.2076 | Train Acc: 0.2642
 Site-SynthDigits              | Train Loss: 2.1697 | Train Acc: 0.3534
 Site-MNIST-M                  | Train Loss: 2.2460 | Train Acc: 0.2022
 Site-MNIST-M                  | Train Loss: 2.2520 | Train Acc: 0.2090
 Site-SVHN                     | Train Loss: 2.2213 | Train Acc: 0.2534
 Site-SVHN                     | Train Loss: 2.2265 | Train Acc: 0.2314
 Site-MNIST                         | Val  Loss: 2.0223 | Val  Acc: 0.5109
 Site-MNIST                         | Val  Loss: 1.9987 | Val  Acc: 0.5647
 Site-USPS                          | Val  Loss: 1.9450 | Val  Acc: 0.5326
 Site-USPS                          | Val  Loss: 1.9404 | Val  Acc: 0.5612
 Site-SynthDigits                   | Val  Loss: 2.1776 | Val  Acc: 0.3478
 Site-SynthDigits                   | Val  Loss: 2.1929 | Val  Acc: 0.3058
 Site-MNIST-M                       | Val  Loss: 2.2591 | Val  Acc: 0.1630
 Site-MNIST-M                       | Val  Loss: 2.2501 | Val  Acc: 0.1978
 Site-SVHN                          | Val  Loss: 2.2084 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.2167 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3751
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.5109
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.5647
 Best site-USPS                      | Epoch:7 | Val Acc: 0.5326
 Best site-USPS                      | Epoch:7 | Val Acc: 0.5612
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3478
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3058
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.1630
 Best site-MNIST-M                   | Epoch:7 | Val Acc: 0.1978
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 8 ============
 Site-MNIST                    | Train Loss: 1.9264 | Train Acc: 0.6280
 Site-MNIST                    | Train Loss: 1.9820 | Train Acc: 0.5238
 Site-USPS                     | Train Loss: 1.8780 | Train Acc: 0.6038
 Site-USPS                     | Train Loss: 1.8691 | Train Acc: 0.6269
 Site-SynthDigits              | Train Loss: 2.1939 | Train Acc: 0.2749
 Site-SynthDigits              | Train Loss: 2.1538 | Train Acc: 0.3650
 Site-MNIST-M                  | Train Loss: 2.2411 | Train Acc: 0.2210
 Site-MNIST-M                  | Train Loss: 2.2452 | Train Acc: 0.2135
 Site-SVHN                     | Train Loss: 2.2167 | Train Acc: 0.2588
 Site-SVHN                     | Train Loss: 2.2197 | Train Acc: 0.2305
 Site-MNIST                         | Val  Loss: 1.9927 | Val  Acc: 0.5109
 Site-MNIST                         | Val  Loss: 1.9670 | Val  Acc: 0.5647
 Site-USPS                          | Val  Loss: 1.9089 | Val  Acc: 0.5326
 Site-USPS                          | Val  Loss: 1.9043 | Val  Acc: 0.5791
 Site-SynthDigits                   | Val  Loss: 2.1627 | Val  Acc: 0.3696
 Site-SynthDigits                   | Val  Loss: 2.1786 | Val  Acc: 0.3237
 Site-MNIST-M                       | Val  Loss: 2.2533 | Val  Acc: 0.2065
 Site-MNIST-M                       | Val  Loss: 2.2435 | Val  Acc: 0.2230
 Site-SVHN                          | Val  Loss: 2.2001 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.2092 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3881
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.5109
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.5647
 Best site-USPS                      | Epoch:8 | Val Acc: 0.5326
 Best site-USPS                      | Epoch:8 | Val Acc: 0.5791
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3696
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.3237
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.2065
 Best site-MNIST-M                   | Epoch:8 | Val Acc: 0.2230
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2770
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 9 ============
 Site-MNIST                    | Train Loss: 1.8935 | Train Acc: 0.6496
 Site-MNIST                    | Train Loss: 1.9529 | Train Acc: 0.5363
 Site-USPS                     | Train Loss: 1.8393 | Train Acc: 0.6038
 Site-USPS                     | Train Loss: 1.8309 | Train Acc: 0.6457
 Site-SynthDigits              | Train Loss: 2.1824 | Train Acc: 0.2803
 Site-SynthDigits              | Train Loss: 2.1384 | Train Acc: 0.3695
 Site-MNIST-M                  | Train Loss: 2.2318 | Train Acc: 0.2318
 Site-MNIST-M                  | Train Loss: 2.2385 | Train Acc: 0.2251
 Site-SVHN                     | Train Loss: 2.2048 | Train Acc: 0.2642
 Site-SVHN                     | Train Loss: 2.2135 | Train Acc: 0.2332
 Site-MNIST                         | Val  Loss: 1.9642 | Val  Acc: 0.5326
 Site-MNIST                         | Val  Loss: 1.9368 | Val  Acc: 0.5899
 Site-USPS                          | Val  Loss: 1.8733 | Val  Acc: 0.5435
 Site-USPS                          | Val  Loss: 1.8686 | Val  Acc: 0.5899
 Site-SynthDigits                   | Val  Loss: 2.1478 | Val  Acc: 0.3696
 Site-SynthDigits                   | Val  Loss: 2.1644 | Val  Acc: 0.3237
 Site-MNIST-M                       | Val  Loss: 2.2474 | Val  Acc: 0.2065
 Site-MNIST-M                       | Val  Loss: 2.2365 | Val  Acc: 0.2266
 Site-SVHN                          | Val  Loss: 2.1927 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.2024 | Val  Acc: 0.2806
Average Valid Accuracy: 0.3956
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.5326
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.5899
 Best site-USPS                      | Epoch:9 | Val Acc: 0.5435
 Best site-USPS                      | Epoch:9 | Val Acc: 0.5899
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3696
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3237
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.2065
 Best site-MNIST-M                   | Epoch:9 | Val Acc: 0.2266
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2806
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
 Test site-MNIST                     | Epoch:9 | Test Acc: 0.5421
 Test site-USPS                      | Epoch:9 | Test Acc: 0.6237
 Test site-SynthDigits               | Epoch:9 | Test Acc: 0.3343
 Test site-MNIST-M                   | Epoch:9 | Test Acc: 0.2063
 Test site-SVHN                      | Epoch:9 | Test Acc: 0.2120
MNIST: 0.542, USPS: 0.624, SynthDigits: 0.334, MNIST-M: 0.206, SVHN: 0.212, 
Average Test Accuracy: 0.3837, domain std=0.1709, cluster std=-1.0000, individual std=0.1709, 
============ Train epoch 10 ============
 Site-MNIST                    | Train Loss: 1.8636 | Train Acc: 0.6496
 Site-MNIST                    | Train Loss: 1.9244 | Train Acc: 0.5453
 Site-USPS                     | Train Loss: 1.8005 | Train Acc: 0.6065
 Site-USPS                     | Train Loss: 1.7951 | Train Acc: 0.6439
 Site-SynthDigits              | Train Loss: 2.1702 | Train Acc: 0.2776
 Site-SynthDigits              | Train Loss: 2.1230 | Train Acc: 0.3713
 Site-MNIST-M                  | Train Loss: 2.2254 | Train Acc: 0.2453
 Site-MNIST-M                  | Train Loss: 2.2317 | Train Acc: 0.2269
 Site-SVHN                     | Train Loss: 2.2021 | Train Acc: 0.2615
 Site-SVHN                     | Train Loss: 2.2074 | Train Acc: 0.2368
 Site-MNIST                         | Val  Loss: 1.9368 | Val  Acc: 0.5326
 Site-MNIST                         | Val  Loss: 1.9076 | Val  Acc: 0.5971
 Site-USPS                          | Val  Loss: 1.8402 | Val  Acc: 0.5543
 Site-USPS                          | Val  Loss: 1.8351 | Val  Acc: 0.5863
 Site-SynthDigits                   | Val  Loss: 2.1333 | Val  Acc: 0.3696
 Site-SynthDigits                   | Val  Loss: 2.1502 | Val  Acc: 0.3201
 Site-MNIST-M                       | Val  Loss: 2.2424 | Val  Acc: 0.2065
 Site-MNIST-M                       | Val  Loss: 2.2300 | Val  Acc: 0.2410
 Site-SVHN                          | Val  Loss: 2.1856 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1959 | Val  Acc: 0.2842
Average Valid Accuracy: 0.3985
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.5326
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.5971
 Best site-USPS                      | Epoch:10 | Val Acc: 0.5543
 Best site-USPS                      | Epoch:10 | Val Acc: 0.5863
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3696
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3201
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.2065
 Best site-MNIST-M                   | Epoch:10 | Val Acc: 0.2410
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2842
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 11 ============
 Site-MNIST                    | Train Loss: 1.8367 | Train Acc: 0.6604
 Site-MNIST                    | Train Loss: 1.8958 | Train Acc: 0.5578
 Site-USPS                     | Train Loss: 1.7735 | Train Acc: 0.6146
 Site-USPS                     | Train Loss: 1.7595 | Train Acc: 0.6529
 Site-SynthDigits              | Train Loss: 2.1577 | Train Acc: 0.2776
 Site-SynthDigits              | Train Loss: 2.1087 | Train Acc: 0.3767
 Site-MNIST-M                  | Train Loss: 2.2189 | Train Acc: 0.2534
 Site-MNIST-M                  | Train Loss: 2.2254 | Train Acc: 0.2350
 Site-SVHN                     | Train Loss: 2.1932 | Train Acc: 0.2615
 Site-SVHN                     | Train Loss: 2.2017 | Train Acc: 0.2377
 Site-MNIST                         | Val  Loss: 1.9101 | Val  Acc: 0.5435
 Site-MNIST                         | Val  Loss: 1.8789 | Val  Acc: 0.6043
 Site-USPS                          | Val  Loss: 1.8060 | Val  Acc: 0.5652
 Site-USPS                          | Val  Loss: 1.8013 | Val  Acc: 0.6043
 Site-SynthDigits                   | Val  Loss: 2.1201 | Val  Acc: 0.3696
 Site-SynthDigits                   | Val  Loss: 2.1373 | Val  Acc: 0.3201
 Site-MNIST-M                       | Val  Loss: 2.2371 | Val  Acc: 0.2174
 Site-MNIST-M                       | Val  Loss: 2.2237 | Val  Acc: 0.2554
 Site-SVHN                          | Val  Loss: 2.1784 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1897 | Val  Acc: 0.2806
Average Valid Accuracy: 0.4054
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.5435
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6043
 Best site-USPS                      | Epoch:11 | Val Acc: 0.5652
 Best site-USPS                      | Epoch:11 | Val Acc: 0.6043
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3696
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3201
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.2174
 Best site-MNIST-M                   | Epoch:11 | Val Acc: 0.2554
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2806
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 12 ============
 Site-MNIST                    | Train Loss: 1.8053 | Train Acc: 0.6712
 Site-MNIST                    | Train Loss: 1.8712 | Train Acc: 0.5722
 Site-USPS                     | Train Loss: 1.7382 | Train Acc: 0.6226
 Site-USPS                     | Train Loss: 1.7269 | Train Acc: 0.6610
 Site-SynthDigits              | Train Loss: 2.1459 | Train Acc: 0.2911
 Site-SynthDigits              | Train Loss: 2.0938 | Train Acc: 0.3848
 Site-MNIST-M                  | Train Loss: 2.2127 | Train Acc: 0.2561
 Site-MNIST-M                  | Train Loss: 2.2185 | Train Acc: 0.2413
 Site-SVHN                     | Train Loss: 2.1908 | Train Acc: 0.2642
 Site-SVHN                     | Train Loss: 2.1958 | Train Acc: 0.2377
 Site-MNIST                         | Val  Loss: 1.8848 | Val  Acc: 0.5652
 Site-MNIST                         | Val  Loss: 1.8529 | Val  Acc: 0.6187
 Site-USPS                          | Val  Loss: 1.7760 | Val  Acc: 0.5761
 Site-USPS                          | Val  Loss: 1.7704 | Val  Acc: 0.6115
 Site-SynthDigits                   | Val  Loss: 2.1054 | Val  Acc: 0.3696
 Site-SynthDigits                   | Val  Loss: 2.1228 | Val  Acc: 0.3201
 Site-MNIST-M                       | Val  Loss: 2.2322 | Val  Acc: 0.2174
 Site-MNIST-M                       | Val  Loss: 2.2169 | Val  Acc: 0.2554
 Site-SVHN                          | Val  Loss: 2.1720 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1837 | Val  Acc: 0.2770
Average Valid Accuracy: 0.4094
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.5652
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.6187
 Best site-USPS                      | Epoch:12 | Val Acc: 0.5761
 Best site-USPS                      | Epoch:12 | Val Acc: 0.6115
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.3696
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.3201
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.2174
 Best site-MNIST-M                   | Epoch:12 | Val Acc: 0.2554
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2770
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 13 ============
 Site-MNIST                    | Train Loss: 1.7767 | Train Acc: 0.6765
 Site-MNIST                    | Train Loss: 1.8466 | Train Acc: 0.5794
 Site-USPS                     | Train Loss: 1.7122 | Train Acc: 0.6307
 Site-USPS                     | Train Loss: 1.6963 | Train Acc: 0.6673
 Site-SynthDigits              | Train Loss: 2.1371 | Train Acc: 0.3046
 Site-SynthDigits              | Train Loss: 2.0795 | Train Acc: 0.3919
 Site-MNIST-M                  | Train Loss: 2.2056 | Train Acc: 0.2695
 Site-MNIST-M                  | Train Loss: 2.2122 | Train Acc: 0.2457
 Site-SVHN                     | Train Loss: 2.1882 | Train Acc: 0.2642
 Site-SVHN                     | Train Loss: 2.1907 | Train Acc: 0.2377
 Site-MNIST                         | Val  Loss: 1.8609 | Val  Acc: 0.5652
 Site-MNIST                         | Val  Loss: 1.8276 | Val  Acc: 0.6223
 Site-USPS                          | Val  Loss: 1.7479 | Val  Acc: 0.5870
 Site-USPS                          | Val  Loss: 1.7420 | Val  Acc: 0.6187
 Site-SynthDigits                   | Val  Loss: 2.0923 | Val  Acc: 0.3478
 Site-SynthDigits                   | Val  Loss: 2.1098 | Val  Acc: 0.3165
 Site-MNIST-M                       | Val  Loss: 2.2280 | Val  Acc: 0.2174
 Site-MNIST-M                       | Val  Loss: 2.2109 | Val  Acc: 0.2590
 Site-SVHN                          | Val  Loss: 2.1652 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1776 | Val  Acc: 0.2770
Average Valid Accuracy: 0.4094
============ Train epoch 14 ============
 Site-MNIST                    | Train Loss: 1.7518 | Train Acc: 0.6846
 Site-MNIST                    | Train Loss: 1.8235 | Train Acc: 0.5839
 Site-USPS                     | Train Loss: 1.6797 | Train Acc: 0.6469
 Site-USPS                     | Train Loss: 1.6670 | Train Acc: 0.6717
 Site-SynthDigits              | Train Loss: 2.1221 | Train Acc: 0.3154
 Site-SynthDigits              | Train Loss: 2.0645 | Train Acc: 0.4000
 Site-MNIST-M                  | Train Loss: 2.1988 | Train Acc: 0.2803
 Site-MNIST-M                  | Train Loss: 2.2058 | Train Acc: 0.2511
 Site-SVHN                     | Train Loss: 2.1797 | Train Acc: 0.2695
 Site-SVHN                     | Train Loss: 2.1845 | Train Acc: 0.2395
 Site-MNIST                         | Val  Loss: 1.8380 | Val  Acc: 0.5761
 Site-MNIST                         | Val  Loss: 1.8045 | Val  Acc: 0.6259
 Site-USPS                          | Val  Loss: 1.7209 | Val  Acc: 0.5978
 Site-USPS                          | Val  Loss: 1.7141 | Val  Acc: 0.6403
 Site-SynthDigits                   | Val  Loss: 2.0791 | Val  Acc: 0.3804
 Site-SynthDigits                   | Val  Loss: 2.0962 | Val  Acc: 0.3201
 Site-MNIST-M                       | Val  Loss: 2.2236 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.2041 | Val  Acc: 0.2662
 Site-SVHN                          | Val  Loss: 2.1594 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1720 | Val  Acc: 0.2806
Average Valid Accuracy: 0.4209
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.5761
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.6259
 Best site-USPS                      | Epoch:14 | Val Acc: 0.5978
 Best site-USPS                      | Epoch:14 | Val Acc: 0.6403
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.3804
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.3201
 Best site-MNIST-M                   | Epoch:14 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:14 | Val Acc: 0.2662
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.2806
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 15 ============
 Site-MNIST                    | Train Loss: 1.7320 | Train Acc: 0.6954
 Site-MNIST                    | Train Loss: 1.8025 | Train Acc: 0.5901
 Site-USPS                     | Train Loss: 1.6401 | Train Acc: 0.6631
 Site-USPS                     | Train Loss: 1.6347 | Train Acc: 0.6843
 Site-SynthDigits              | Train Loss: 2.1081 | Train Acc: 0.3154
 Site-SynthDigits              | Train Loss: 2.0513 | Train Acc: 0.4072
 Site-MNIST-M                  | Train Loss: 2.1926 | Train Acc: 0.2884
 Site-MNIST-M                  | Train Loss: 2.1986 | Train Acc: 0.2547
 Site-SVHN                     | Train Loss: 2.1762 | Train Acc: 0.2695
 Site-SVHN                     | Train Loss: 2.1795 | Train Acc: 0.2448
 Site-MNIST                         | Val  Loss: 1.8171 | Val  Acc: 0.5761
 Site-MNIST                         | Val  Loss: 1.7831 | Val  Acc: 0.6295
 Site-USPS                          | Val  Loss: 1.6910 | Val  Acc: 0.6196
 Site-USPS                          | Val  Loss: 1.6809 | Val  Acc: 0.6439
 Site-SynthDigits                   | Val  Loss: 2.0673 | Val  Acc: 0.3913
 Site-SynthDigits                   | Val  Loss: 2.0844 | Val  Acc: 0.3273
 Site-MNIST-M                       | Val  Loss: 2.2186 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 2.1979 | Val  Acc: 0.2734
 Site-SVHN                          | Val  Loss: 2.1529 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1660 | Val  Acc: 0.2878
Average Valid Accuracy: 0.4303
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.5761
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.6295
 Best site-USPS                      | Epoch:15 | Val Acc: 0.6196
 Best site-USPS                      | Epoch:15 | Val Acc: 0.6439
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.3913
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.3273
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:15 | Val Acc: 0.2734
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2878
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 16 ============
 Site-MNIST                    | Train Loss: 1.7060 | Train Acc: 0.6981
 Site-MNIST                    | Train Loss: 1.7802 | Train Acc: 0.6018
 Site-USPS                     | Train Loss: 1.6160 | Train Acc: 0.6658
 Site-USPS                     | Train Loss: 1.6085 | Train Acc: 0.6906
 Site-SynthDigits              | Train Loss: 2.0984 | Train Acc: 0.3235
 Site-SynthDigits              | Train Loss: 2.0359 | Train Acc: 0.4126
 Site-MNIST-M                  | Train Loss: 2.1865 | Train Acc: 0.2911
 Site-MNIST-M                  | Train Loss: 2.1915 | Train Acc: 0.2619
 Site-SVHN                     | Train Loss: 2.1717 | Train Acc: 0.2722
 Site-SVHN                     | Train Loss: 2.1736 | Train Acc: 0.2511
 Site-MNIST                         | Val  Loss: 1.7960 | Val  Acc: 0.5870
 Site-MNIST                         | Val  Loss: 1.7610 | Val  Acc: 0.6367
 Site-USPS                          | Val  Loss: 1.6672 | Val  Acc: 0.6196
 Site-USPS                          | Val  Loss: 1.6564 | Val  Acc: 0.6403
 Site-SynthDigits                   | Val  Loss: 2.0530 | Val  Acc: 0.4022
 Site-SynthDigits                   | Val  Loss: 2.0702 | Val  Acc: 0.3309
 Site-MNIST-M                       | Val  Loss: 2.2137 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 2.1909 | Val  Acc: 0.2662
 Site-SVHN                          | Val  Loss: 2.1466 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1600 | Val  Acc: 0.2950
Average Valid Accuracy: 0.4354
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.5870
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.6367
 Best site-USPS                      | Epoch:16 | Val Acc: 0.6196
 Best site-USPS                      | Epoch:16 | Val Acc: 0.6403
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4022
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.3309
 Best site-MNIST-M                   | Epoch:16 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:16 | Val Acc: 0.2662
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.2950
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 17 ============
 Site-MNIST                    | Train Loss: 1.6828 | Train Acc: 0.7035
 Site-MNIST                    | Train Loss: 1.7601 | Train Acc: 0.6045
 Site-USPS                     | Train Loss: 1.5952 | Train Acc: 0.6792
 Site-USPS                     | Train Loss: 1.5822 | Train Acc: 0.6951
 Site-SynthDigits              | Train Loss: 2.0851 | Train Acc: 0.3288
 Site-SynthDigits              | Train Loss: 2.0217 | Train Acc: 0.4161
 Site-MNIST-M                  | Train Loss: 2.1791 | Train Acc: 0.2884
 Site-MNIST-M                  | Train Loss: 2.1848 | Train Acc: 0.2637
 Site-SVHN                     | Train Loss: 2.1650 | Train Acc: 0.2722
 Site-SVHN                     | Train Loss: 2.1673 | Train Acc: 0.2538
 Site-MNIST                         | Val  Loss: 1.7763 | Val  Acc: 0.5870
 Site-MNIST                         | Val  Loss: 1.7411 | Val  Acc: 0.6367
 Site-USPS                          | Val  Loss: 1.6430 | Val  Acc: 0.6196
 Site-USPS                          | Val  Loss: 1.6316 | Val  Acc: 0.6475
 Site-SynthDigits                   | Val  Loss: 2.0393 | Val  Acc: 0.4022
 Site-SynthDigits                   | Val  Loss: 2.0572 | Val  Acc: 0.3381
 Site-MNIST-M                       | Val  Loss: 2.2088 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.1840 | Val  Acc: 0.2662
 Site-SVHN                          | Val  Loss: 2.1396 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1537 | Val  Acc: 0.3022
Average Valid Accuracy: 0.4354
============ Train epoch 18 ============
 Site-MNIST                    | Train Loss: 1.6646 | Train Acc: 0.7089
 Site-MNIST                    | Train Loss: 1.7411 | Train Acc: 0.6090
 Site-USPS                     | Train Loss: 1.5723 | Train Acc: 0.6765
 Site-USPS                     | Train Loss: 1.5591 | Train Acc: 0.7013
 Site-SynthDigits              | Train Loss: 2.0724 | Train Acc: 0.3477
 Site-SynthDigits              | Train Loss: 2.0078 | Train Acc: 0.4170
 Site-MNIST-M                  | Train Loss: 2.1715 | Train Acc: 0.2965
 Site-MNIST-M                  | Train Loss: 2.1785 | Train Acc: 0.2700
 Site-SVHN                     | Train Loss: 2.1629 | Train Acc: 0.2776
 Site-SVHN                     | Train Loss: 2.1616 | Train Acc: 0.2538
 Site-MNIST                         | Val  Loss: 1.7562 | Val  Acc: 0.5978
 Site-MNIST                         | Val  Loss: 1.7211 | Val  Acc: 0.6547
 Site-USPS                          | Val  Loss: 1.6205 | Val  Acc: 0.6413
 Site-USPS                          | Val  Loss: 1.6083 | Val  Acc: 0.6547
 Site-SynthDigits                   | Val  Loss: 2.0260 | Val  Acc: 0.4022
 Site-SynthDigits                   | Val  Loss: 2.0445 | Val  Acc: 0.3525
 Site-MNIST-M                       | Val  Loss: 2.2037 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.1765 | Val  Acc: 0.2842
 Site-SVHN                          | Val  Loss: 2.1329 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1477 | Val  Acc: 0.3022
Average Valid Accuracy: 0.4433
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.5978
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.6547
 Best site-USPS                      | Epoch:18 | Val Acc: 0.6413
 Best site-USPS                      | Epoch:18 | Val Acc: 0.6547
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4022
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.3525
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:18 | Val Acc: 0.2842
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3022
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 19 ============
 Site-MNIST                    | Train Loss: 1.6416 | Train Acc: 0.7089
 Site-MNIST                    | Train Loss: 1.7187 | Train Acc: 0.6188
 Site-USPS                     | Train Loss: 1.5552 | Train Acc: 0.6900
 Site-USPS                     | Train Loss: 1.5339 | Train Acc: 0.7103
 Site-SynthDigits              | Train Loss: 2.0644 | Train Acc: 0.3504
 Site-SynthDigits              | Train Loss: 1.9953 | Train Acc: 0.4143
 Site-MNIST-M                  | Train Loss: 2.1624 | Train Acc: 0.3046
 Site-MNIST-M                  | Train Loss: 2.1712 | Train Acc: 0.2762
 Site-SVHN                     | Train Loss: 2.1573 | Train Acc: 0.2776
 Site-SVHN                     | Train Loss: 2.1560 | Train Acc: 0.2556
 Site-MNIST                         | Val  Loss: 1.7359 | Val  Acc: 0.5978
 Site-MNIST                         | Val  Loss: 1.6987 | Val  Acc: 0.6511
 Site-USPS                          | Val  Loss: 1.5976 | Val  Acc: 0.6413
 Site-USPS                          | Val  Loss: 1.5834 | Val  Acc: 0.6583
 Site-SynthDigits                   | Val  Loss: 2.0139 | Val  Acc: 0.4022
 Site-SynthDigits                   | Val  Loss: 2.0329 | Val  Acc: 0.3525
 Site-MNIST-M                       | Val  Loss: 2.1966 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1693 | Val  Acc: 0.2878
 Site-SVHN                          | Val  Loss: 2.1269 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1424 | Val  Acc: 0.3022
Average Valid Accuracy: 0.4458
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.5978
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.6511
 Best site-USPS                      | Epoch:19 | Val Acc: 0.6413
 Best site-USPS                      | Epoch:19 | Val Acc: 0.6583
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4022
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.3525
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:19 | Val Acc: 0.2878
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3022
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
 Test site-MNIST                     | Epoch:19 | Test Acc: 0.6204
 Test site-USPS                      | Epoch:19 | Test Acc: 0.7161
 Test site-SynthDigits               | Epoch:19 | Test Acc: 0.3900
 Test site-MNIST-M                   | Epoch:19 | Test Acc: 0.2556
 Test site-SVHN                      | Epoch:19 | Test Acc: 0.2301
MNIST: 0.620, USPS: 0.716, SynthDigits: 0.390, MNIST-M: 0.256, SVHN: 0.230, 
Average Test Accuracy: 0.4424, domain std=0.1946, cluster std=-1.0000, individual std=0.1946, 
============ Train epoch 20 ============
 Site-MNIST                    | Train Loss: 1.6310 | Train Acc: 0.7224
 Site-MNIST                    | Train Loss: 1.7078 | Train Acc: 0.6206
 Site-USPS                     | Train Loss: 1.5268 | Train Acc: 0.6846
 Site-USPS                     | Train Loss: 1.5118 | Train Acc: 0.7130
 Site-SynthDigits              | Train Loss: 2.0511 | Train Acc: 0.3612
 Site-SynthDigits              | Train Loss: 1.9805 | Train Acc: 0.4197
 Site-MNIST-M                  | Train Loss: 2.1578 | Train Acc: 0.3127
 Site-MNIST-M                  | Train Loss: 2.1654 | Train Acc: 0.2825
 Site-SVHN                     | Train Loss: 2.1528 | Train Acc: 0.2776
 Site-SVHN                     | Train Loss: 2.1476 | Train Acc: 0.2637
 Site-MNIST                         | Val  Loss: 1.7231 | Val  Acc: 0.6087
 Site-MNIST                         | Val  Loss: 1.6893 | Val  Acc: 0.6619
 Site-USPS                          | Val  Loss: 1.5798 | Val  Acc: 0.6522
 Site-USPS                          | Val  Loss: 1.5621 | Val  Acc: 0.6727
 Site-SynthDigits                   | Val  Loss: 1.9998 | Val  Acc: 0.3913
 Site-SynthDigits                   | Val  Loss: 2.0200 | Val  Acc: 0.3561
 Site-MNIST-M                       | Val  Loss: 2.1935 | Val  Acc: 0.2174
 Site-MNIST-M                       | Val  Loss: 2.1619 | Val  Acc: 0.2986
 Site-SVHN                          | Val  Loss: 2.1141 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.1336 | Val  Acc: 0.3094
Average Valid Accuracy: 0.4494
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.6087
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.6619
 Best site-USPS                      | Epoch:20 | Val Acc: 0.6522
 Best site-USPS                      | Epoch:20 | Val Acc: 0.6727
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.3913
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.3561
 Best site-MNIST-M                   | Epoch:20 | Val Acc: 0.2174
 Best site-MNIST-M                   | Epoch:20 | Val Acc: 0.2986
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3094
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 21 ============
 Site-MNIST                    | Train Loss: 1.5980 | Train Acc: 0.7332
 Site-MNIST                    | Train Loss: 1.6859 | Train Acc: 0.6323
 Site-USPS                     | Train Loss: 1.5132 | Train Acc: 0.6981
 Site-USPS                     | Train Loss: 1.4907 | Train Acc: 0.7211
 Site-SynthDigits              | Train Loss: 2.0390 | Train Acc: 0.3558
 Site-SynthDigits              | Train Loss: 1.9666 | Train Acc: 0.4242
 Site-MNIST-M                  | Train Loss: 2.1463 | Train Acc: 0.3154
 Site-MNIST-M                  | Train Loss: 2.1585 | Train Acc: 0.2852
 Site-SVHN                     | Train Loss: 2.1438 | Train Acc: 0.2749
 Site-SVHN                     | Train Loss: 2.1416 | Train Acc: 0.2673
 Site-MNIST                         | Val  Loss: 1.7023 | Val  Acc: 0.5978
 Site-MNIST                         | Val  Loss: 1.6667 | Val  Acc: 0.6691
 Site-USPS                          | Val  Loss: 1.5590 | Val  Acc: 0.6522
 Site-USPS                          | Val  Loss: 1.5419 | Val  Acc: 0.6727
 Site-SynthDigits                   | Val  Loss: 1.9864 | Val  Acc: 0.4022
 Site-SynthDigits                   | Val  Loss: 2.0061 | Val  Acc: 0.3669
 Site-MNIST-M                       | Val  Loss: 2.1866 | Val  Acc: 0.2174
 Site-MNIST-M                       | Val  Loss: 2.1544 | Val  Acc: 0.3058
 Site-SVHN                          | Val  Loss: 2.1095 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1288 | Val  Acc: 0.2986
Average Valid Accuracy: 0.4498
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.5978
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.6691
 Best site-USPS                      | Epoch:21 | Val Acc: 0.6522
 Best site-USPS                      | Epoch:21 | Val Acc: 0.6727
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.4022
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.3669
 Best site-MNIST-M                   | Epoch:21 | Val Acc: 0.2174
 Best site-MNIST-M                   | Epoch:21 | Val Acc: 0.3058
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.2986
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 22 ============
 Site-MNIST                    | Train Loss: 1.5776 | Train Acc: 0.7332
 Site-MNIST                    | Train Loss: 1.6647 | Train Acc: 0.6475
 Site-USPS                     | Train Loss: 1.4845 | Train Acc: 0.7116
 Site-USPS                     | Train Loss: 1.4688 | Train Acc: 0.7336
 Site-SynthDigits              | Train Loss: 2.0284 | Train Acc: 0.3558
 Site-SynthDigits              | Train Loss: 1.9549 | Train Acc: 0.4287
 Site-MNIST-M                  | Train Loss: 2.1409 | Train Acc: 0.3288
 Site-MNIST-M                  | Train Loss: 2.1506 | Train Acc: 0.2897
 Site-SVHN                     | Train Loss: 2.1432 | Train Acc: 0.2803
 Site-SVHN                     | Train Loss: 2.1369 | Train Acc: 0.2646
 Site-MNIST                         | Val  Loss: 1.6825 | Val  Acc: 0.6087
 Site-MNIST                         | Val  Loss: 1.6448 | Val  Acc: 0.6727
 Site-USPS                          | Val  Loss: 1.5374 | Val  Acc: 0.6413
 Site-USPS                          | Val  Loss: 1.5193 | Val  Acc: 0.6727
 Site-SynthDigits                   | Val  Loss: 1.9752 | Val  Acc: 0.3913
 Site-SynthDigits                   | Val  Loss: 1.9957 | Val  Acc: 0.3597
 Site-MNIST-M                       | Val  Loss: 2.1793 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.1480 | Val  Acc: 0.3165
 Site-SVHN                          | Val  Loss: 2.1037 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.1245 | Val  Acc: 0.2986
Average Valid Accuracy: 0.4527
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.6087
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.6727
 Best site-USPS                      | Epoch:22 | Val Acc: 0.6413
 Best site-USPS                      | Epoch:22 | Val Acc: 0.6727
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.3913
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.3597
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:22 | Val Acc: 0.3165
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.2986
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 23 ============
 Site-MNIST                    | Train Loss: 1.5607 | Train Acc: 0.7332
 Site-MNIST                    | Train Loss: 1.6460 | Train Acc: 0.6493
 Site-USPS                     | Train Loss: 1.4681 | Train Acc: 0.7170
 Site-USPS                     | Train Loss: 1.4513 | Train Acc: 0.7408
 Site-SynthDigits              | Train Loss: 2.0181 | Train Acc: 0.3612
 Site-SynthDigits              | Train Loss: 1.9413 | Train Acc: 0.4341
 Site-MNIST-M                  | Train Loss: 2.1274 | Train Acc: 0.3369
 Site-MNIST-M                  | Train Loss: 2.1438 | Train Acc: 0.2942
 Site-SVHN                     | Train Loss: 2.1382 | Train Acc: 0.2884
 Site-SVHN                     | Train Loss: 2.1299 | Train Acc: 0.2646
 Site-MNIST                         | Val  Loss: 1.6642 | Val  Acc: 0.5978
 Site-MNIST                         | Val  Loss: 1.6271 | Val  Acc: 0.6727
 Site-USPS                          | Val  Loss: 1.5215 | Val  Acc: 0.6522
 Site-USPS                          | Val  Loss: 1.5018 | Val  Acc: 0.6871
 Site-SynthDigits                   | Val  Loss: 1.9615 | Val  Acc: 0.3913
 Site-SynthDigits                   | Val  Loss: 1.9837 | Val  Acc: 0.3633
 Site-MNIST-M                       | Val  Loss: 2.1726 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1398 | Val  Acc: 0.3165
 Site-SVHN                          | Val  Loss: 2.0971 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1186 | Val  Acc: 0.2986
Average Valid Accuracy: 0.4545
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.5978
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.6727
 Best site-USPS                      | Epoch:23 | Val Acc: 0.6522
 Best site-USPS                      | Epoch:23 | Val Acc: 0.6871
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.3913
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.3633
 Best site-MNIST-M                   | Epoch:23 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:23 | Val Acc: 0.3165
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.2986
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 24 ============
 Site-MNIST                    | Train Loss: 1.5528 | Train Acc: 0.7278
 Site-MNIST                    | Train Loss: 1.6341 | Train Acc: 0.6529
 Site-USPS                     | Train Loss: 1.4524 | Train Acc: 0.7170
 Site-USPS                     | Train Loss: 1.4349 | Train Acc: 0.7408
 Site-SynthDigits              | Train Loss: 2.0016 | Train Acc: 0.3774
 Site-SynthDigits              | Train Loss: 1.9255 | Train Acc: 0.4439
 Site-MNIST-M                  | Train Loss: 2.1231 | Train Acc: 0.3477
 Site-MNIST-M                  | Train Loss: 2.1402 | Train Acc: 0.2951
 Site-SVHN                     | Train Loss: 2.1331 | Train Acc: 0.2911
 Site-SVHN                     | Train Loss: 2.1193 | Train Acc: 0.2744
 Site-MNIST                         | Val  Loss: 1.6496 | Val  Acc: 0.6304
 Site-MNIST                         | Val  Loss: 1.6161 | Val  Acc: 0.6835
 Site-USPS                          | Val  Loss: 1.5085 | Val  Acc: 0.6522
 Site-USPS                          | Val  Loss: 1.4865 | Val  Acc: 0.6942
 Site-SynthDigits                   | Val  Loss: 1.9454 | Val  Acc: 0.4130
 Site-SynthDigits                   | Val  Loss: 1.9692 | Val  Acc: 0.3813
 Site-MNIST-M                       | Val  Loss: 2.1754 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.1332 | Val  Acc: 0.3237
 Site-SVHN                          | Val  Loss: 2.0849 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1086 | Val  Acc: 0.3129
Average Valid Accuracy: 0.4657
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.6304
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.6835
 Best site-USPS                      | Epoch:24 | Val Acc: 0.6522
 Best site-USPS                      | Epoch:24 | Val Acc: 0.6942
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.4130
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.3813
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:24 | Val Acc: 0.3237
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3129
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 25 ============
 Site-MNIST                    | Train Loss: 1.5345 | Train Acc: 0.7278
 Site-MNIST                    | Train Loss: 1.6155 | Train Acc: 0.6574
 Site-USPS                     | Train Loss: 1.4327 | Train Acc: 0.7278
 Site-USPS                     | Train Loss: 1.4139 | Train Acc: 0.7489
 Site-SynthDigits              | Train Loss: 1.9891 | Train Acc: 0.3801
 Site-SynthDigits              | Train Loss: 1.9116 | Train Acc: 0.4466
 Site-MNIST-M                  | Train Loss: 2.1145 | Train Acc: 0.3558
 Site-MNIST-M                  | Train Loss: 2.1333 | Train Acc: 0.3004
 Site-SVHN                     | Train Loss: 2.1242 | Train Acc: 0.2965
 Site-SVHN                     | Train Loss: 2.1116 | Train Acc: 0.2789
 Site-MNIST                         | Val  Loss: 1.6317 | Val  Acc: 0.6304
 Site-MNIST                         | Val  Loss: 1.5980 | Val  Acc: 0.6727
 Site-USPS                          | Val  Loss: 1.4884 | Val  Acc: 0.6522
 Site-USPS                          | Val  Loss: 1.4657 | Val  Acc: 0.7050
 Site-SynthDigits                   | Val  Loss: 1.9305 | Val  Acc: 0.4130
 Site-SynthDigits                   | Val  Loss: 1.9561 | Val  Acc: 0.3885
 Site-MNIST-M                       | Val  Loss: 2.1725 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.1262 | Val  Acc: 0.3273
 Site-SVHN                          | Val  Loss: 2.0772 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.1016 | Val  Acc: 0.3165
Average Valid Accuracy: 0.4649
============ Train epoch 26 ============
 Site-MNIST                    | Train Loss: 1.5162 | Train Acc: 0.7170
 Site-MNIST                    | Train Loss: 1.6015 | Train Acc: 0.6556
 Site-USPS                     | Train Loss: 1.4058 | Train Acc: 0.7278
 Site-USPS                     | Train Loss: 1.3966 | Train Acc: 0.7543
 Site-SynthDigits              | Train Loss: 1.9744 | Train Acc: 0.3801
 Site-SynthDigits              | Train Loss: 1.8952 | Train Acc: 0.4520
 Site-MNIST-M                  | Train Loss: 2.0972 | Train Acc: 0.3585
 Site-MNIST-M                  | Train Loss: 2.1280 | Train Acc: 0.2906
 Site-SVHN                     | Train Loss: 2.1170 | Train Acc: 0.2992
 Site-SVHN                     | Train Loss: 2.1014 | Train Acc: 0.2843
 Site-MNIST                         | Val  Loss: 1.6158 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.5858 | Val  Acc: 0.6835
 Site-USPS                          | Val  Loss: 1.4728 | Val  Acc: 0.6630
 Site-USPS                          | Val  Loss: 1.4485 | Val  Acc: 0.7086
 Site-SynthDigits                   | Val  Loss: 1.9094 | Val  Acc: 0.4239
 Site-SynthDigits                   | Val  Loss: 1.9397 | Val  Acc: 0.3921
 Site-MNIST-M                       | Val  Loss: 2.1724 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.1196 | Val  Acc: 0.3165
 Site-SVHN                          | Val  Loss: 2.0664 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0915 | Val  Acc: 0.3237
Average Valid Accuracy: 0.4696
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.6835
 Best site-USPS                      | Epoch:26 | Val Acc: 0.6630
 Best site-USPS                      | Epoch:26 | Val Acc: 0.7086
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.4239
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.3921
 Best site-MNIST-M                   | Epoch:26 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:26 | Val Acc: 0.3165
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.3237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 27 ============
 Site-MNIST                    | Train Loss: 1.5062 | Train Acc: 0.7278
 Site-MNIST                    | Train Loss: 1.5860 | Train Acc: 0.6475
 Site-USPS                     | Train Loss: 1.3919 | Train Acc: 0.7358
 Site-USPS                     | Train Loss: 1.3775 | Train Acc: 0.7605
 Site-SynthDigits              | Train Loss: 1.9573 | Train Acc: 0.3881
 Site-SynthDigits              | Train Loss: 1.8769 | Train Acc: 0.4610
 Site-MNIST-M                  | Train Loss: 2.0966 | Train Acc: 0.3693
 Site-MNIST-M                  | Train Loss: 2.1189 | Train Acc: 0.2996
 Site-SVHN                     | Train Loss: 2.1111 | Train Acc: 0.3019
 Site-SVHN                     | Train Loss: 2.0919 | Train Acc: 0.2924
 Site-MNIST                         | Val  Loss: 1.5993 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.5713 | Val  Acc: 0.6799
 Site-USPS                          | Val  Loss: 1.4548 | Val  Acc: 0.6630
 Site-USPS                          | Val  Loss: 1.4296 | Val  Acc: 0.7158
 Site-SynthDigits                   | Val  Loss: 1.8872 | Val  Acc: 0.4565
 Site-SynthDigits                   | Val  Loss: 1.9210 | Val  Acc: 0.4065
 Site-MNIST-M                       | Val  Loss: 2.1649 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.1098 | Val  Acc: 0.3273
 Site-SVHN                          | Val  Loss: 2.0562 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0817 | Val  Acc: 0.3273
Average Valid Accuracy: 0.4761
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.6799
 Best site-USPS                      | Epoch:27 | Val Acc: 0.6630
 Best site-USPS                      | Epoch:27 | Val Acc: 0.7158
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.4565
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.4065
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:27 | Val Acc: 0.3273
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.3273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 28 ============
 Site-MNIST                    | Train Loss: 1.4848 | Train Acc: 0.7278
 Site-MNIST                    | Train Loss: 1.5714 | Train Acc: 0.6457
 Site-USPS                     | Train Loss: 1.3783 | Train Acc: 0.7412
 Site-USPS                     | Train Loss: 1.3616 | Train Acc: 0.7561
 Site-SynthDigits              | Train Loss: 1.9396 | Train Acc: 0.3935
 Site-SynthDigits              | Train Loss: 1.8569 | Train Acc: 0.4780
 Site-MNIST-M                  | Train Loss: 2.0853 | Train Acc: 0.3558
 Site-MNIST-M                  | Train Loss: 2.1124 | Train Acc: 0.3013
 Site-SVHN                     | Train Loss: 2.1040 | Train Acc: 0.3073
 Site-SVHN                     | Train Loss: 2.0816 | Train Acc: 0.3049
 Site-MNIST                         | Val  Loss: 1.5835 | Val  Acc: 0.6304
 Site-MNIST                         | Val  Loss: 1.5576 | Val  Acc: 0.6799
 Site-USPS                          | Val  Loss: 1.4401 | Val  Acc: 0.6739
 Site-USPS                          | Val  Loss: 1.4139 | Val  Acc: 0.7050
 Site-SynthDigits                   | Val  Loss: 1.8638 | Val  Acc: 0.4457
 Site-SynthDigits                   | Val  Loss: 1.9000 | Val  Acc: 0.4137
 Site-MNIST-M                       | Val  Loss: 2.1585 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.1020 | Val  Acc: 0.3345
 Site-SVHN                          | Val  Loss: 2.0458 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 2.0719 | Val  Acc: 0.3237
Average Valid Accuracy: 0.4772
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.6304
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.6799
 Best site-USPS                      | Epoch:28 | Val Acc: 0.6739
 Best site-USPS                      | Epoch:28 | Val Acc: 0.7050
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.4457
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.4137
 Best site-MNIST-M                   | Epoch:28 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:28 | Val Acc: 0.3345
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.3237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 29 ============
 Site-MNIST                    | Train Loss: 1.4685 | Train Acc: 0.7251
 Site-MNIST                    | Train Loss: 1.5558 | Train Acc: 0.6413
 Site-USPS                     | Train Loss: 1.3527 | Train Acc: 0.7412
 Site-USPS                     | Train Loss: 1.3450 | Train Acc: 0.7605
 Site-SynthDigits              | Train Loss: 1.9205 | Train Acc: 0.3989
 Site-SynthDigits              | Train Loss: 1.8370 | Train Acc: 0.4825
 Site-MNIST-M                  | Train Loss: 2.0760 | Train Acc: 0.3612
 Site-MNIST-M                  | Train Loss: 2.1013 | Train Acc: 0.3076
 Site-SVHN                     | Train Loss: 2.0994 | Train Acc: 0.3073
 Site-SVHN                     | Train Loss: 2.0711 | Train Acc: 0.3040
 Site-MNIST                         | Val  Loss: 1.5672 | Val  Acc: 0.6196
 Site-MNIST                         | Val  Loss: 1.5422 | Val  Acc: 0.6727
 Site-USPS                          | Val  Loss: 1.4244 | Val  Acc: 0.6848
 Site-USPS                          | Val  Loss: 1.3975 | Val  Acc: 0.7194
 Site-SynthDigits                   | Val  Loss: 1.8427 | Val  Acc: 0.4565
 Site-SynthDigits                   | Val  Loss: 1.8800 | Val  Acc: 0.4245
 Site-MNIST-M                       | Val  Loss: 2.1456 | Val  Acc: 0.2283
 Site-MNIST-M                       | Val  Loss: 2.0887 | Val  Acc: 0.3417
 Site-SVHN                          | Val  Loss: 2.0360 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 2.0635 | Val  Acc: 0.3201
Average Valid Accuracy: 0.4805
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.6196
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.6727
 Best site-USPS                      | Epoch:29 | Val Acc: 0.6848
 Best site-USPS                      | Epoch:29 | Val Acc: 0.7194
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.4565
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.4245
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.2283
 Best site-MNIST-M                   | Epoch:29 | Val Acc: 0.3417
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3201
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
 Test site-MNIST                     | Epoch:29 | Test Acc: 0.6491
 Test site-USPS                      | Epoch:29 | Test Acc: 0.7677
 Test site-SynthDigits               | Epoch:29 | Test Acc: 0.4504
 Test site-MNIST-M                   | Epoch:29 | Test Acc: 0.3003
 Test site-SVHN                      | Epoch:29 | Test Acc: 0.2798
MNIST: 0.649, USPS: 0.768, SynthDigits: 0.450, MNIST-M: 0.300, SVHN: 0.280, 
Average Test Accuracy: 0.4895, domain std=0.1919, cluster std=-1.0000, individual std=0.1919, 
============ Train epoch 30 ============
 Site-MNIST                    | Train Loss: 1.4561 | Train Acc: 0.7278
 Site-MNIST                    | Train Loss: 1.5416 | Train Acc: 0.6475
 Site-USPS                     | Train Loss: 1.3479 | Train Acc: 0.7520
 Site-USPS                     | Train Loss: 1.3307 | Train Acc: 0.7632
 Site-SynthDigits              | Train Loss: 1.9017 | Train Acc: 0.4124
 Site-SynthDigits              | Train Loss: 1.8182 | Train Acc: 0.4897
 Site-MNIST-M                  | Train Loss: 2.0670 | Train Acc: 0.3639
 Site-MNIST-M                  | Train Loss: 2.0909 | Train Acc: 0.3103
 Site-SVHN                     | Train Loss: 2.0871 | Train Acc: 0.3127
 Site-SVHN                     | Train Loss: 2.0620 | Train Acc: 0.3130
 Site-MNIST                         | Val  Loss: 1.5518 | Val  Acc: 0.6304
 Site-MNIST                         | Val  Loss: 1.5276 | Val  Acc: 0.6763
 Site-USPS                          | Val  Loss: 1.4109 | Val  Acc: 0.6848
 Site-USPS                          | Val  Loss: 1.3827 | Val  Acc: 0.7230
 Site-SynthDigits                   | Val  Loss: 1.8232 | Val  Acc: 0.4457
 Site-SynthDigits                   | Val  Loss: 1.8619 | Val  Acc: 0.4317
 Site-MNIST-M                       | Val  Loss: 2.1316 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.0748 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 2.0269 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0560 | Val  Acc: 0.3165
Average Valid Accuracy: 0.4819
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.6304
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.6763
 Best site-USPS                      | Epoch:30 | Val Acc: 0.6848
 Best site-USPS                      | Epoch:30 | Val Acc: 0.7230
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.4457
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.4317
 Best site-MNIST-M                   | Epoch:30 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:30 | Val Acc: 0.3561
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.3165
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 31 ============
 Site-MNIST                    | Train Loss: 1.4416 | Train Acc: 0.7305
 Site-MNIST                    | Train Loss: 1.5238 | Train Acc: 0.6529
 Site-USPS                     | Train Loss: 1.3244 | Train Acc: 0.7493
 Site-USPS                     | Train Loss: 1.3135 | Train Acc: 0.7686
 Site-SynthDigits              | Train Loss: 1.8910 | Train Acc: 0.4151
 Site-SynthDigits              | Train Loss: 1.8041 | Train Acc: 0.4951
 Site-MNIST-M                  | Train Loss: 2.0478 | Train Acc: 0.3693
 Site-MNIST-M                  | Train Loss: 2.0794 | Train Acc: 0.3193
 Site-SVHN                     | Train Loss: 2.0836 | Train Acc: 0.3100
 Site-SVHN                     | Train Loss: 2.0552 | Train Acc: 0.3148
 Site-MNIST                         | Val  Loss: 1.5343 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.5100 | Val  Acc: 0.6942
 Site-USPS                          | Val  Loss: 1.3944 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.3649 | Val  Acc: 0.7302
 Site-SynthDigits                   | Val  Loss: 1.8083 | Val  Acc: 0.4565
 Site-SynthDigits                   | Val  Loss: 1.8472 | Val  Acc: 0.4424
 Site-MNIST-M                       | Val  Loss: 2.1180 | Val  Acc: 0.2391
 Site-MNIST-M                       | Val  Loss: 2.0606 | Val  Acc: 0.3633
 Site-SVHN                          | Val  Loss: 2.0179 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0486 | Val  Acc: 0.3201
Average Valid Accuracy: 0.4920
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.6630
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.6942
 Best site-USPS                      | Epoch:31 | Val Acc: 0.6957
 Best site-USPS                      | Epoch:31 | Val Acc: 0.7302
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.4565
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.4424
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.2391
 Best site-MNIST-M                   | Epoch:31 | Val Acc: 0.3633
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.3201
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 32 ============
 Site-MNIST                    | Train Loss: 1.4186 | Train Acc: 0.7170
 Site-MNIST                    | Train Loss: 1.5129 | Train Acc: 0.6430
 Site-USPS                     | Train Loss: 1.3268 | Train Acc: 0.7547
 Site-USPS                     | Train Loss: 1.3119 | Train Acc: 0.7587
 Site-SynthDigits              | Train Loss: 1.8744 | Train Acc: 0.4232
 Site-SynthDigits              | Train Loss: 1.7837 | Train Acc: 0.5085
 Site-MNIST-M                  | Train Loss: 2.0433 | Train Acc: 0.3639
 Site-MNIST-M                  | Train Loss: 2.0741 | Train Acc: 0.3139
 Site-SVHN                     | Train Loss: 2.0765 | Train Acc: 0.3181
 Site-SVHN                     | Train Loss: 2.0457 | Train Acc: 0.3193
 Site-MNIST                         | Val  Loss: 1.5199 | Val  Acc: 0.6522
 Site-MNIST                         | Val  Loss: 1.4979 | Val  Acc: 0.6799
 Site-USPS                          | Val  Loss: 1.3929 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.3632 | Val  Acc: 0.7230
 Site-SynthDigits                   | Val  Loss: 1.7882 | Val  Acc: 0.4565
 Site-SynthDigits                   | Val  Loss: 1.8261 | Val  Acc: 0.4424
 Site-MNIST-M                       | Val  Loss: 2.1072 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.0532 | Val  Acc: 0.3597
 Site-SVHN                          | Val  Loss: 2.0100 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.0418 | Val  Acc: 0.3273
Average Valid Accuracy: 0.4891
============ Train epoch 33 ============
 Site-MNIST                    | Train Loss: 1.4047 | Train Acc: 0.7278
 Site-MNIST                    | Train Loss: 1.4940 | Train Acc: 0.6538
 Site-USPS                     | Train Loss: 1.3034 | Train Acc: 0.7655
 Site-USPS                     | Train Loss: 1.2902 | Train Acc: 0.7695
 Site-SynthDigits              | Train Loss: 1.8610 | Train Acc: 0.4232
 Site-SynthDigits              | Train Loss: 1.7708 | Train Acc: 0.5094
 Site-MNIST-M                  | Train Loss: 2.0318 | Train Acc: 0.3666
 Site-MNIST-M                  | Train Loss: 2.0635 | Train Acc: 0.3220
 Site-SVHN                     | Train Loss: 2.0706 | Train Acc: 0.3235
 Site-SVHN                     | Train Loss: 2.0391 | Train Acc: 0.3238
 Site-MNIST                         | Val  Loss: 1.5020 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.4785 | Val  Acc: 0.6942
 Site-USPS                          | Val  Loss: 1.3726 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.3417 | Val  Acc: 0.7446
 Site-SynthDigits                   | Val  Loss: 1.7769 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.8150 | Val  Acc: 0.4460
 Site-MNIST-M                       | Val  Loss: 2.0954 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.0401 | Val  Acc: 0.3633
 Site-SVHN                          | Val  Loss: 2.0010 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.0347 | Val  Acc: 0.3453
Average Valid Accuracy: 0.5017
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.6739
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.6942
 Best site-USPS                      | Epoch:33 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:33 | Val Acc: 0.7446
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.4674
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.4460
 Best site-MNIST-M                   | Epoch:33 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:33 | Val Acc: 0.3633
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.3453
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 34 ============
 Site-MNIST                    | Train Loss: 1.3869 | Train Acc: 0.7224
 Site-MNIST                    | Train Loss: 1.4795 | Train Acc: 0.6547
 Site-USPS                     | Train Loss: 1.2976 | Train Acc: 0.7655
 Site-USPS                     | Train Loss: 1.2818 | Train Acc: 0.7722
 Site-SynthDigits              | Train Loss: 1.8480 | Train Acc: 0.4420
 Site-SynthDigits              | Train Loss: 1.7569 | Train Acc: 0.5148
 Site-MNIST-M                  | Train Loss: 2.0255 | Train Acc: 0.3639
 Site-MNIST-M                  | Train Loss: 2.0557 | Train Acc: 0.3247
 Site-SVHN                     | Train Loss: 2.0591 | Train Acc: 0.3235
 Site-SVHN                     | Train Loss: 2.0306 | Train Acc: 0.3274
 Site-MNIST                         | Val  Loss: 1.4864 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.4637 | Val  Acc: 0.6835
 Site-USPS                          | Val  Loss: 1.3648 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.3322 | Val  Acc: 0.7410
 Site-SynthDigits                   | Val  Loss: 1.7624 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.7999 | Val  Acc: 0.4676
 Site-MNIST-M                       | Val  Loss: 2.0871 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.0313 | Val  Acc: 0.3597
 Site-SVHN                          | Val  Loss: 1.9935 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.0274 | Val  Acc: 0.3453
Average Valid Accuracy: 0.4999
============ Train epoch 35 ============
 Site-MNIST                    | Train Loss: 1.3687 | Train Acc: 0.7278
 Site-MNIST                    | Train Loss: 1.4615 | Train Acc: 0.6565
 Site-USPS                     | Train Loss: 1.2746 | Train Acc: 0.7736
 Site-USPS                     | Train Loss: 1.2647 | Train Acc: 0.7767
 Site-SynthDigits              | Train Loss: 1.8355 | Train Acc: 0.4367
 Site-SynthDigits              | Train Loss: 1.7445 | Train Acc: 0.5157
 Site-MNIST-M                  | Train Loss: 2.0174 | Train Acc: 0.3666
 Site-MNIST-M                  | Train Loss: 2.0471 | Train Acc: 0.3238
 Site-SVHN                     | Train Loss: 2.0630 | Train Acc: 0.3208
 Site-SVHN                     | Train Loss: 2.0249 | Train Acc: 0.3291
 Site-MNIST                         | Val  Loss: 1.4693 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.4454 | Val  Acc: 0.7014
 Site-USPS                          | Val  Loss: 1.3495 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.3169 | Val  Acc: 0.7482
 Site-SynthDigits                   | Val  Loss: 1.7520 | Val  Acc: 0.4457
 Site-SynthDigits                   | Val  Loss: 1.7889 | Val  Acc: 0.4496
 Site-MNIST-M                       | Val  Loss: 2.0777 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.0215 | Val  Acc: 0.3561
 Site-SVHN                          | Val  Loss: 1.9879 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.0230 | Val  Acc: 0.3453
Average Valid Accuracy: 0.4992
============ Train epoch 36 ============
 Site-MNIST                    | Train Loss: 1.3546 | Train Acc: 0.7251
 Site-MNIST                    | Train Loss: 1.4512 | Train Acc: 0.6601
 Site-USPS                     | Train Loss: 1.2708 | Train Acc: 0.7682
 Site-USPS                     | Train Loss: 1.2562 | Train Acc: 0.7695
 Site-SynthDigits              | Train Loss: 1.8178 | Train Acc: 0.4474
 Site-SynthDigits              | Train Loss: 1.7295 | Train Acc: 0.5211
 Site-MNIST-M                  | Train Loss: 2.0134 | Train Acc: 0.3747
 Site-MNIST-M                  | Train Loss: 2.0428 | Train Acc: 0.3238
 Site-SVHN                     | Train Loss: 2.0472 | Train Acc: 0.3208
 Site-SVHN                     | Train Loss: 2.0153 | Train Acc: 0.3327
 Site-MNIST                         | Val  Loss: 1.4561 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.4345 | Val  Acc: 0.6835
 Site-USPS                          | Val  Loss: 1.3424 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.3095 | Val  Acc: 0.7410
 Site-SynthDigits                   | Val  Loss: 1.7363 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.7731 | Val  Acc: 0.4748
 Site-MNIST-M                       | Val  Loss: 2.0741 | Val  Acc: 0.2500
 Site-MNIST-M                       | Val  Loss: 2.0167 | Val  Acc: 0.3525
 Site-SVHN                          | Val  Loss: 1.9772 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 2.0130 | Val  Acc: 0.3525
Average Valid Accuracy: 0.5050
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.6630
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.6835
 Best site-USPS                      | Epoch:36 | Val Acc: 0.6957
 Best site-USPS                      | Epoch:36 | Val Acc: 0.7410
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.4748
 Best site-MNIST-M                   | Epoch:36 | Val Acc: 0.2500
 Best site-MNIST-M                   | Epoch:36 | Val Acc: 0.3525
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.3525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 37 ============
 Site-MNIST                    | Train Loss: 1.3517 | Train Acc: 0.7358
 Site-MNIST                    | Train Loss: 1.4383 | Train Acc: 0.6628
 Site-USPS                     | Train Loss: 1.2603 | Train Acc: 0.7655
 Site-USPS                     | Train Loss: 1.2467 | Train Acc: 0.7713
 Site-SynthDigits              | Train Loss: 1.8109 | Train Acc: 0.4447
 Site-SynthDigits              | Train Loss: 1.7157 | Train Acc: 0.5256
 Site-MNIST-M                  | Train Loss: 2.0025 | Train Acc: 0.3827
 Site-MNIST-M                  | Train Loss: 2.0358 | Train Acc: 0.3309
 Site-SVHN                     | Train Loss: 2.0451 | Train Acc: 0.3208
 Site-SVHN                     | Train Loss: 2.0087 | Train Acc: 0.3372
 Site-MNIST                         | Val  Loss: 1.4420 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 1.4211 | Val  Acc: 0.6942
 Site-USPS                          | Val  Loss: 1.3332 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.2983 | Val  Acc: 0.7482
 Site-SynthDigits                   | Val  Loss: 1.7228 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.7603 | Val  Acc: 0.4640
 Site-MNIST-M                       | Val  Loss: 2.0650 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 2.0086 | Val  Acc: 0.3669
 Site-SVHN                          | Val  Loss: 1.9684 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 2.0054 | Val  Acc: 0.3525
Average Valid Accuracy: 0.5072
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.6942
 Best site-USPS                      | Epoch:37 | Val Acc: 0.6957
 Best site-USPS                      | Epoch:37 | Val Acc: 0.7482
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.4674
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.4640
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:37 | Val Acc: 0.3669
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.3525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 38 ============
 Site-MNIST                    | Train Loss: 1.3384 | Train Acc: 0.7278
 Site-MNIST                    | Train Loss: 1.4257 | Train Acc: 0.6673
 Site-USPS                     | Train Loss: 1.2537 | Train Acc: 0.7682
 Site-USPS                     | Train Loss: 1.2366 | Train Acc: 0.7686
 Site-SynthDigits              | Train Loss: 1.7979 | Train Acc: 0.4474
 Site-SynthDigits              | Train Loss: 1.7022 | Train Acc: 0.5300
 Site-MNIST-M                  | Train Loss: 1.9900 | Train Acc: 0.3854
 Site-MNIST-M                  | Train Loss: 2.0289 | Train Acc: 0.3327
 Site-SVHN                     | Train Loss: 2.0411 | Train Acc: 0.3261
 Site-SVHN                     | Train Loss: 2.0020 | Train Acc: 0.3363
 Site-MNIST                         | Val  Loss: 1.4282 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 1.4079 | Val  Acc: 0.6978
 Site-USPS                          | Val  Loss: 1.3258 | Val  Acc: 0.6848
 Site-USPS                          | Val  Loss: 1.2893 | Val  Acc: 0.7446
 Site-SynthDigits                   | Val  Loss: 1.7118 | Val  Acc: 0.4783
 Site-SynthDigits                   | Val  Loss: 1.7473 | Val  Acc: 0.4748
 Site-MNIST-M                       | Val  Loss: 2.0571 | Val  Acc: 0.2609
 Site-MNIST-M                       | Val  Loss: 1.9998 | Val  Acc: 0.3705
 Site-SVHN                          | Val  Loss: 1.9638 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 2.0004 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5093
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.6978
 Best site-USPS                      | Epoch:38 | Val Acc: 0.6848
 Best site-USPS                      | Epoch:38 | Val Acc: 0.7446
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.4783
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.4748
 Best site-MNIST-M                   | Epoch:38 | Val Acc: 0.2609
 Best site-MNIST-M                   | Epoch:38 | Val Acc: 0.3705
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.3597
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 39 ============
 Site-MNIST                    | Train Loss: 1.3218 | Train Acc: 0.7412
 Site-MNIST                    | Train Loss: 1.4095 | Train Acc: 0.6709
 Site-USPS                     | Train Loss: 1.2303 | Train Acc: 0.7763
 Site-USPS                     | Train Loss: 1.2218 | Train Acc: 0.7740
 Site-SynthDigits              | Train Loss: 1.7876 | Train Acc: 0.4420
 Site-SynthDigits              | Train Loss: 1.6946 | Train Acc: 0.5309
 Site-MNIST-M                  | Train Loss: 1.9763 | Train Acc: 0.3989
 Site-MNIST-M                  | Train Loss: 2.0195 | Train Acc: 0.3408
 Site-SVHN                     | Train Loss: 2.0327 | Train Acc: 0.3235
 Site-SVHN                     | Train Loss: 1.9971 | Train Acc: 0.3354
 Site-MNIST                         | Val  Loss: 1.4128 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 1.3918 | Val  Acc: 0.7122
 Site-USPS                          | Val  Loss: 1.3107 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 1.2739 | Val  Acc: 0.7626
 Site-SynthDigits                   | Val  Loss: 1.7017 | Val  Acc: 0.4891
 Site-SynthDigits                   | Val  Loss: 1.7384 | Val  Acc: 0.4820
 Site-MNIST-M                       | Val  Loss: 2.0484 | Val  Acc: 0.2717
 Site-MNIST-M                       | Val  Loss: 1.9896 | Val  Acc: 0.3885
 Site-SVHN                          | Val  Loss: 1.9574 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 1.9951 | Val  Acc: 0.3489
Average Valid Accuracy: 0.5205
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.7122
 Best site-USPS                      | Epoch:39 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:39 | Val Acc: 0.7626
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.4891
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.4820
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.2717
 Best site-MNIST-M                   | Epoch:39 | Val Acc: 0.3885
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.3489
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
 Test site-MNIST                     | Epoch:39 | Test Acc: 0.6844
 Test site-USPS                      | Epoch:39 | Test Acc: 0.7839
 Test site-SynthDigits               | Epoch:39 | Test Acc: 0.4967
 Test site-MNIST-M                   | Epoch:39 | Test Acc: 0.3397
 Test site-SVHN                      | Epoch:39 | Test Acc: 0.3002
MNIST: 0.684, USPS: 0.784, SynthDigits: 0.497, MNIST-M: 0.340, SVHN: 0.300, 
Average Test Accuracy: 0.5210, domain std=0.1887, cluster std=-1.0000, individual std=0.1887, 
============ Train epoch 40 ============
 Site-MNIST                    | Train Loss: 1.2993 | Train Acc: 0.7439
 Site-MNIST                    | Train Loss: 1.3921 | Train Acc: 0.6780
 Site-USPS                     | Train Loss: 1.2123 | Train Acc: 0.7844
 Site-USPS                     | Train Loss: 1.2042 | Train Acc: 0.7803
 Site-SynthDigits              | Train Loss: 1.7773 | Train Acc: 0.4474
 Site-SynthDigits              | Train Loss: 1.6859 | Train Acc: 0.5309
 Site-MNIST-M                  | Train Loss: 1.9651 | Train Acc: 0.4043
 Site-MNIST-M                  | Train Loss: 2.0056 | Train Acc: 0.3561
 Site-SVHN                     | Train Loss: 2.0297 | Train Acc: 0.3288
 Site-SVHN                     | Train Loss: 1.9943 | Train Acc: 0.3363
 Site-MNIST                         | Val  Loss: 1.3971 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.3744 | Val  Acc: 0.7194
 Site-USPS                          | Val  Loss: 1.2929 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.2556 | Val  Acc: 0.7590
 Site-SynthDigits                   | Val  Loss: 1.6940 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.7325 | Val  Acc: 0.4820
 Site-MNIST-M                       | Val  Loss: 2.0364 | Val  Acc: 0.2935
 Site-MNIST-M                       | Val  Loss: 1.9752 | Val  Acc: 0.3993
 Site-SVHN                          | Val  Loss: 1.9520 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 1.9901 | Val  Acc: 0.3561
Average Valid Accuracy: 0.5270
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.7194
 Best site-USPS                      | Epoch:40 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:40 | Val Acc: 0.7590
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.4820
 Best site-MNIST-M                   | Epoch:40 | Val Acc: 0.2935
 Best site-MNIST-M                   | Epoch:40 | Val Acc: 0.3993
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.3561
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 41 ============
 Site-MNIST                    | Train Loss: 1.2882 | Train Acc: 0.7466
 Site-MNIST                    | Train Loss: 1.3832 | Train Acc: 0.6717
 Site-USPS                     | Train Loss: 1.2203 | Train Acc: 0.7709
 Site-USPS                     | Train Loss: 1.2048 | Train Acc: 0.7713
 Site-SynthDigits              | Train Loss: 1.7652 | Train Acc: 0.4394
 Site-SynthDigits              | Train Loss: 1.6711 | Train Acc: 0.5354
 Site-MNIST-M                  | Train Loss: 1.9699 | Train Acc: 0.4070
 Site-MNIST-M                  | Train Loss: 2.0040 | Train Acc: 0.3543
 Site-SVHN                     | Train Loss: 2.0176 | Train Acc: 0.3369
 Site-SVHN                     | Train Loss: 1.9859 | Train Acc: 0.3363
 Site-MNIST                         | Val  Loss: 1.3853 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.3654 | Val  Acc: 0.7122
 Site-USPS                          | Val  Loss: 1.2965 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.2569 | Val  Acc: 0.7518
 Site-SynthDigits                   | Val  Loss: 1.6804 | Val  Acc: 0.5217
 Site-SynthDigits                   | Val  Loss: 1.7158 | Val  Acc: 0.4892
 Site-MNIST-M                       | Val  Loss: 2.0338 | Val  Acc: 0.3043
 Site-MNIST-M                       | Val  Loss: 1.9726 | Val  Acc: 0.4029
 Site-SVHN                          | Val  Loss: 1.9452 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 1.9835 | Val  Acc: 0.3489
Average Valid Accuracy: 0.5281
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.7122
 Best site-USPS                      | Epoch:41 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:41 | Val Acc: 0.7518
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.5217
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.4892
 Best site-MNIST-M                   | Epoch:41 | Val Acc: 0.3043
 Best site-MNIST-M                   | Epoch:41 | Val Acc: 0.4029
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.3489
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 42 ============
 Site-MNIST                    | Train Loss: 1.2840 | Train Acc: 0.7466
 Site-MNIST                    | Train Loss: 1.3717 | Train Acc: 0.6735
 Site-USPS                     | Train Loss: 1.2079 | Train Acc: 0.7763
 Site-USPS                     | Train Loss: 1.1920 | Train Acc: 0.7731
 Site-SynthDigits              | Train Loss: 1.7572 | Train Acc: 0.4447
 Site-SynthDigits              | Train Loss: 1.6635 | Train Acc: 0.5390
 Site-MNIST-M                  | Train Loss: 1.9515 | Train Acc: 0.4151
 Site-MNIST-M                  | Train Loss: 1.9956 | Train Acc: 0.3587
 Site-SVHN                     | Train Loss: 2.0158 | Train Acc: 0.3396
 Site-SVHN                     | Train Loss: 1.9791 | Train Acc: 0.3363
 Site-MNIST                         | Val  Loss: 1.3725 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.3524 | Val  Acc: 0.7194
 Site-USPS                          | Val  Loss: 1.2832 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.2436 | Val  Acc: 0.7518
 Site-SynthDigits                   | Val  Loss: 1.6720 | Val  Acc: 0.5217
 Site-SynthDigits                   | Val  Loss: 1.7077 | Val  Acc: 0.4928
 Site-MNIST-M                       | Val  Loss: 2.0261 | Val  Acc: 0.3152
 Site-MNIST-M                       | Val  Loss: 1.9626 | Val  Acc: 0.4065
 Site-SVHN                          | Val  Loss: 1.9382 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 1.9773 | Val  Acc: 0.3561
Average Valid Accuracy: 0.5314
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.7194
 Best site-USPS                      | Epoch:42 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:42 | Val Acc: 0.7518
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.5217
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.4928
 Best site-MNIST-M                   | Epoch:42 | Val Acc: 0.3152
 Best site-MNIST-M                   | Epoch:42 | Val Acc: 0.4065
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.3561
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 43 ============
 Site-MNIST                    | Train Loss: 1.2705 | Train Acc: 0.7466
 Site-MNIST                    | Train Loss: 1.3628 | Train Acc: 0.6717
 Site-USPS                     | Train Loss: 1.2033 | Train Acc: 0.7682
 Site-USPS                     | Train Loss: 1.1898 | Train Acc: 0.7722
 Site-SynthDigits              | Train Loss: 1.7387 | Train Acc: 0.4474
 Site-SynthDigits              | Train Loss: 1.6481 | Train Acc: 0.5408
 Site-MNIST-M                  | Train Loss: 1.9577 | Train Acc: 0.4124
 Site-MNIST-M                  | Train Loss: 1.9946 | Train Acc: 0.3525
 Site-SVHN                     | Train Loss: 2.0101 | Train Acc: 0.3423
 Site-SVHN                     | Train Loss: 1.9701 | Train Acc: 0.3399
 Site-MNIST                         | Val  Loss: 1.3621 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.3438 | Val  Acc: 0.7230
 Site-USPS                          | Val  Loss: 1.2830 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.2404 | Val  Acc: 0.7410
 Site-SynthDigits                   | Val  Loss: 1.6597 | Val  Acc: 0.5326
 Site-SynthDigits                   | Val  Loss: 1.6936 | Val  Acc: 0.4964
 Site-MNIST-M                       | Val  Loss: 2.0217 | Val  Acc: 0.3152
 Site-MNIST-M                       | Val  Loss: 1.9609 | Val  Acc: 0.4101
 Site-SVHN                          | Val  Loss: 1.9318 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 1.9716 | Val  Acc: 0.3633
Average Valid Accuracy: 0.5332
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.7230
 Best site-USPS                      | Epoch:43 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:43 | Val Acc: 0.7410
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.5326
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.4964
 Best site-MNIST-M                   | Epoch:43 | Val Acc: 0.3152
 Best site-MNIST-M                   | Epoch:43 | Val Acc: 0.4101
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.3633
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 44 ============
 Site-MNIST                    | Train Loss: 1.2585 | Train Acc: 0.7412
 Site-MNIST                    | Train Loss: 1.3486 | Train Acc: 0.6735
 Site-USPS                     | Train Loss: 1.1931 | Train Acc: 0.7736
 Site-USPS                     | Train Loss: 1.1754 | Train Acc: 0.7740
 Site-SynthDigits              | Train Loss: 1.7377 | Train Acc: 0.4528
 Site-SynthDigits              | Train Loss: 1.6392 | Train Acc: 0.5453
 Site-MNIST-M                  | Train Loss: 1.9494 | Train Acc: 0.4151
 Site-MNIST-M                  | Train Loss: 1.9840 | Train Acc: 0.3641
 Site-SVHN                     | Train Loss: 2.0084 | Train Acc: 0.3369
 Site-SVHN                     | Train Loss: 1.9688 | Train Acc: 0.3417
 Site-MNIST                         | Val  Loss: 1.3477 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 1.3286 | Val  Acc: 0.7194
 Site-USPS                          | Val  Loss: 1.2680 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 1.2257 | Val  Acc: 0.7518
 Site-SynthDigits                   | Val  Loss: 1.6524 | Val  Acc: 0.5435
 Site-SynthDigits                   | Val  Loss: 1.6856 | Val  Acc: 0.5108
 Site-MNIST-M                       | Val  Loss: 2.0116 | Val  Acc: 0.3261
 Site-MNIST-M                       | Val  Loss: 1.9495 | Val  Acc: 0.4209
 Site-SVHN                          | Val  Loss: 1.9293 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 1.9682 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5382
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.7194
 Best site-USPS                      | Epoch:44 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:44 | Val Acc: 0.7518
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.5435
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.5108
 Best site-MNIST-M                   | Epoch:44 | Val Acc: 0.3261
 Best site-MNIST-M                   | Epoch:44 | Val Acc: 0.4209
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.3597
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 45 ============
 Site-MNIST                    | Train Loss: 1.2447 | Train Acc: 0.7439
 Site-MNIST                    | Train Loss: 1.3408 | Train Acc: 0.6771
 Site-USPS                     | Train Loss: 1.1725 | Train Acc: 0.7763
 Site-USPS                     | Train Loss: 1.1683 | Train Acc: 0.7731
 Site-SynthDigits              | Train Loss: 1.7239 | Train Acc: 0.4582
 Site-SynthDigits              | Train Loss: 1.6257 | Train Acc: 0.5507
 Site-MNIST-M                  | Train Loss: 1.9483 | Train Acc: 0.4178
 Site-MNIST-M                  | Train Loss: 1.9857 | Train Acc: 0.3578
 Site-SVHN                     | Train Loss: 1.9974 | Train Acc: 0.3396
 Site-SVHN                     | Train Loss: 1.9584 | Train Acc: 0.3453
 Site-MNIST                         | Val  Loss: 1.3373 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 1.3197 | Val  Acc: 0.7266
 Site-USPS                          | Val  Loss: 1.2634 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.2190 | Val  Acc: 0.7518
 Site-SynthDigits                   | Val  Loss: 1.6392 | Val  Acc: 0.5435
 Site-SynthDigits                   | Val  Loss: 1.6711 | Val  Acc: 0.5072
 Site-MNIST-M                       | Val  Loss: 2.0146 | Val  Acc: 0.3370
 Site-MNIST-M                       | Val  Loss: 1.9522 | Val  Acc: 0.4281
 Site-SVHN                          | Val  Loss: 1.9159 | Val  Acc: 0.3478
 Site-SVHN                          | Val  Loss: 1.9587 | Val  Acc: 0.3561
Average Valid Accuracy: 0.5411
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.7266
 Best site-USPS                      | Epoch:45 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:45 | Val Acc: 0.7518
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.5435
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.5072
 Best site-MNIST-M                   | Epoch:45 | Val Acc: 0.3370
 Best site-MNIST-M                   | Epoch:45 | Val Acc: 0.4281
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.3478
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.3561
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 46 ============
 Site-MNIST                    | Train Loss: 1.2367 | Train Acc: 0.7466
 Site-MNIST                    | Train Loss: 1.3301 | Train Acc: 0.6789
 Site-USPS                     | Train Loss: 1.1800 | Train Acc: 0.7682
 Site-USPS                     | Train Loss: 1.1657 | Train Acc: 0.7749
 Site-SynthDigits              | Train Loss: 1.7188 | Train Acc: 0.4690
 Site-SynthDigits              | Train Loss: 1.6173 | Train Acc: 0.5471
 Site-MNIST-M                  | Train Loss: 1.9409 | Train Acc: 0.4151
 Site-MNIST-M                  | Train Loss: 1.9777 | Train Acc: 0.3641
 Site-SVHN                     | Train Loss: 1.9909 | Train Acc: 0.3450
 Site-SVHN                     | Train Loss: 1.9524 | Train Acc: 0.3471
 Site-MNIST                         | Val  Loss: 1.3267 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 1.3098 | Val  Acc: 0.7266
 Site-USPS                          | Val  Loss: 1.2612 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.2148 | Val  Acc: 0.7518
 Site-SynthDigits                   | Val  Loss: 1.6321 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.6628 | Val  Acc: 0.5000
 Site-MNIST-M                       | Val  Loss: 2.0056 | Val  Acc: 0.3370
 Site-MNIST-M                       | Val  Loss: 1.9430 | Val  Acc: 0.4245
 Site-SVHN                          | Val  Loss: 1.9130 | Val  Acc: 0.3478
 Site-SVHN                          | Val  Loss: 1.9550 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5371
============ Train epoch 47 ============
 Site-MNIST                    | Train Loss: 1.2208 | Train Acc: 0.7466
 Site-MNIST                    | Train Loss: 1.3174 | Train Acc: 0.6789
 Site-USPS                     | Train Loss: 1.1591 | Train Acc: 0.7709
 Site-USPS                     | Train Loss: 1.1479 | Train Acc: 0.7758
 Site-SynthDigits              | Train Loss: 1.7110 | Train Acc: 0.4717
 Site-SynthDigits              | Train Loss: 1.6107 | Train Acc: 0.5498
 Site-MNIST-M                  | Train Loss: 1.9293 | Train Acc: 0.4232
 Site-MNIST-M                  | Train Loss: 1.9687 | Train Acc: 0.3722
 Site-SVHN                     | Train Loss: 1.9873 | Train Acc: 0.3477
 Site-SVHN                     | Train Loss: 1.9471 | Train Acc: 0.3471
 Site-MNIST                         | Val  Loss: 1.3142 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.2971 | Val  Acc: 0.7302
 Site-USPS                          | Val  Loss: 1.2452 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.1988 | Val  Acc: 0.7518
 Site-SynthDigits                   | Val  Loss: 1.6270 | Val  Acc: 0.5326
 Site-SynthDigits                   | Val  Loss: 1.6567 | Val  Acc: 0.5180
 Site-MNIST-M                       | Val  Loss: 1.9973 | Val  Acc: 0.3478
 Site-MNIST-M                       | Val  Loss: 1.9335 | Val  Acc: 0.4317
 Site-SVHN                          | Val  Loss: 1.9065 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 1.9487 | Val  Acc: 0.3561
Average Valid Accuracy: 0.5429
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.7302
 Best site-USPS                      | Epoch:47 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:47 | Val Acc: 0.7518
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5326
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5180
 Best site-MNIST-M                   | Epoch:47 | Val Acc: 0.3478
 Best site-MNIST-M                   | Epoch:47 | Val Acc: 0.4317
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.3561
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 48 ============
 Site-MNIST                    | Train Loss: 1.2089 | Train Acc: 0.7493
 Site-MNIST                    | Train Loss: 1.3007 | Train Acc: 0.6870
 Site-USPS                     | Train Loss: 1.1452 | Train Acc: 0.7817
 Site-USPS                     | Train Loss: 1.1322 | Train Acc: 0.7857
 Site-SynthDigits              | Train Loss: 1.7059 | Train Acc: 0.4609
 Site-SynthDigits              | Train Loss: 1.6049 | Train Acc: 0.5435
 Site-MNIST-M                  | Train Loss: 1.9096 | Train Acc: 0.4259
 Site-MNIST-M                  | Train Loss: 1.9557 | Train Acc: 0.3776
 Site-SVHN                     | Train Loss: 1.9945 | Train Acc: 0.3450
 Site-SVHN                     | Train Loss: 1.9450 | Train Acc: 0.3471
 Site-MNIST                         | Val  Loss: 1.2991 | Val  Acc: 0.7283
 Site-MNIST                         | Val  Loss: 1.2804 | Val  Acc: 0.7338
 Site-USPS                          | Val  Loss: 1.2271 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 1.1817 | Val  Acc: 0.7662
 Site-SynthDigits                   | Val  Loss: 1.6208 | Val  Acc: 0.5435
 Site-SynthDigits                   | Val  Loss: 1.6522 | Val  Acc: 0.5144
 Site-MNIST-M                       | Val  Loss: 1.9846 | Val  Acc: 0.3696
 Site-MNIST-M                       | Val  Loss: 1.9203 | Val  Acc: 0.4424
 Site-SVHN                          | Val  Loss: 1.9026 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 1.9467 | Val  Acc: 0.3381
Average Valid Accuracy: 0.5491
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.7283
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.7338
 Best site-USPS                      | Epoch:48 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:48 | Val Acc: 0.7662
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.5435
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.5144
 Best site-MNIST-M                   | Epoch:48 | Val Acc: 0.3696
 Best site-MNIST-M                   | Epoch:48 | Val Acc: 0.4424
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.3381
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/drfl...
============ Train epoch 49 ============
 Site-MNIST                    | Train Loss: 1.1947 | Train Acc: 0.7547
 Site-MNIST                    | Train Loss: 1.2865 | Train Acc: 0.6951
 Site-USPS                     | Train Loss: 1.1326 | Train Acc: 0.7844
 Site-USPS                     | Train Loss: 1.1209 | Train Acc: 0.7874
 Site-SynthDigits              | Train Loss: 1.6995 | Train Acc: 0.4663
 Site-SynthDigits              | Train Loss: 1.6006 | Train Acc: 0.5471
 Site-MNIST-M                  | Train Loss: 1.8971 | Train Acc: 0.4259
 Site-MNIST-M                  | Train Loss: 1.9427 | Train Acc: 0.3874
 Site-SVHN                     | Train Loss: 1.9861 | Train Acc: 0.3477
 Site-SVHN                     | Train Loss: 1.9436 | Train Acc: 0.3462
 Site-MNIST                         | Val  Loss: 1.2854 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 1.2658 | Val  Acc: 0.7446
 Site-USPS                          | Val  Loss: 1.2152 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 1.1703 | Val  Acc: 0.7662
 Site-SynthDigits                   | Val  Loss: 1.6167 | Val  Acc: 0.5217
 Site-SynthDigits                   | Val  Loss: 1.6485 | Val  Acc: 0.5108
 Site-MNIST-M                       | Val  Loss: 1.9729 | Val  Acc: 0.3587
 Site-MNIST-M                       | Val  Loss: 1.9064 | Val  Acc: 0.4424
 Site-SVHN                          | Val  Loss: 1.9019 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 1.9446 | Val  Acc: 0.3489
Average Valid Accuracy: 0.5487
===2023-06-04 13:25:45===
===2023-06-04 13:26:04===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.7100
 Test site-USPS                      | Epoch:48 | Test Acc: 0.7978
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.5182
 Test site-MNIST-M                   | Epoch:48 | Test Acc: 0.3634
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.3146
MNIST: 0.710, USPS: 0.798, SynthDigits: 0.518, MNIST-M: 0.363, SVHN: 0.315, 
Average Test Accuracy: 0.5408, domain std=0.1886, cluster std=-1.0000, individual std=0.1886, 
