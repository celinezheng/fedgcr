===2023-06-27 12:21:11===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.2919 | Train Acc: 0.0782
 Site-MNIST                         | Train Loss: 2.2912 | Train Acc: 0.0960
 Site-USPS                          | Train Loss: 2.2911 | Train Acc: 0.1267
 Site-USPS                          | Train Loss: 2.2814 | Train Acc: 0.1435
 Site-SynthDigits                   | Train Loss: 2.3005 | Train Acc: 0.1159
 Site-SynthDigits                   | Train Loss: 2.3083 | Train Acc: 0.1004
 Site-MNIST_M                       | Train Loss: 2.3175 | Train Acc: 0.1024
 Site-MNIST_M                       | Train Loss: 2.3100 | Train Acc: 0.0978
 Site-SVHN                          | Train Loss: 2.2952 | Train Acc: 0.1078
 Site-SVHN                          | Train Loss: 2.3013 | Train Acc: 0.1094
Average Train Accuracy: 0.1078
 Site-MNIST                         | Val  Loss: 2.2883 | Val  Acc: 0.0978
 Site-MNIST                         | Val  Loss: 2.2921 | Val  Acc: 0.1007
 Site-USPS                          | Val  Loss: 2.2661 | Val  Acc: 0.1522
 Site-USPS                          | Val  Loss: 2.2786 | Val  Acc: 0.1403
 Site-SynthDigits                   | Val  Loss: 2.3173 | Val  Acc: 0.0870
 Site-SynthDigits                   | Val  Loss: 2.3096 | Val  Acc: 0.1115
 Site-MNIST_M                       | Val  Loss: 2.3171 | Val  Acc: 0.0870
 Site-MNIST_M                       | Val  Loss: 2.3205 | Val  Acc: 0.0971
 Site-SVHN                          | Val  Loss: 2.2925 | Val  Acc: 0.1522
 Site-SVHN                          | Val  Loss: 2.2931 | Val  Acc: 0.1223
Average Valid Accuracy: 0.1148
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.0978
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1007
 Best site-USPS                      | Epoch:0 | Val Acc: 0.1522
 Best site-USPS                      | Epoch:0 | Val Acc: 0.1403
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.0870
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1115
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.0870
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.0971
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1522
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1223
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
===2023-06-27 12:23:01===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
===2023-06-27 16:06:09===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.2919 | Train Acc: 0.0782
 Site-MNIST                         | Train Loss: 2.2912 | Train Acc: 0.0960
 Site-USPS                          | Train Loss: 2.2911 | Train Acc: 0.1267
 Site-USPS                          | Train Loss: 2.2814 | Train Acc: 0.1435
 Site-SynthDigits                   | Train Loss: 2.3005 | Train Acc: 0.1159
 Site-SynthDigits                   | Train Loss: 2.3083 | Train Acc: 0.1004
 Site-MNIST_M                       | Train Loss: 2.3175 | Train Acc: 0.1024
 Site-MNIST_M                       | Train Loss: 2.3100 | Train Acc: 0.0978
 Site-SVHN                          | Train Loss: 2.2952 | Train Acc: 0.1078
 Site-SVHN                          | Train Loss: 2.3013 | Train Acc: 0.1094
Average Train Accuracy: 0.1078
 Site-MNIST                         | Val  Loss: 2.2883 | Val  Acc: 0.0978
 Site-MNIST                         | Val  Loss: 2.2921 | Val  Acc: 0.1007
 Site-USPS                          | Val  Loss: 2.2661 | Val  Acc: 0.1522
 Site-USPS                          | Val  Loss: 2.2786 | Val  Acc: 0.1403
 Site-SynthDigits                   | Val  Loss: 2.3173 | Val  Acc: 0.0870
 Site-SynthDigits                   | Val  Loss: 2.3096 | Val  Acc: 0.1115
 Site-MNIST_M                       | Val  Loss: 2.3171 | Val  Acc: 0.0870
 Site-MNIST_M                       | Val  Loss: 2.3205 | Val  Acc: 0.0971
 Site-SVHN                          | Val  Loss: 2.2925 | Val  Acc: 0.1522
 Site-SVHN                          | Val  Loss: 2.2931 | Val  Acc: 0.1223
Average Valid Accuracy: 0.1148
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.0978
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.1007
 Best site-USPS                      | Epoch:0 | Val Acc: 0.1522
 Best site-USPS                      | Epoch:0 | Val Acc: 0.1403
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.0870
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1115
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.0870
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.0971
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1522
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1223
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 2.2791 | Train Acc: 0.1213
 Site-MNIST                         | Train Loss: 2.2807 | Train Acc: 0.1175
 Site-USPS                          | Train Loss: 2.2742 | Train Acc: 0.2075
 Site-USPS                          | Train Loss: 2.2646 | Train Acc: 0.2484
 Site-SynthDigits                   | Train Loss: 2.2983 | Train Acc: 0.1186
 Site-SynthDigits                   | Train Loss: 2.3026 | Train Acc: 0.1229
 Site-MNIST_M                       | Train Loss: 2.3160 | Train Acc: 0.1051
 Site-MNIST_M                       | Train Loss: 2.3081 | Train Acc: 0.1031
 Site-SVHN                          | Train Loss: 2.2909 | Train Acc: 0.1132
 Site-SVHN                          | Train Loss: 2.2971 | Train Acc: 0.1193
Average Train Accuracy: 0.1377
 Site-MNIST                         | Val  Loss: 2.2790 | Val  Acc: 0.0978
 Site-MNIST                         | Val  Loss: 2.2818 | Val  Acc: 0.1187
 Site-USPS                          | Val  Loss: 2.2523 | Val  Acc: 0.2717
 Site-USPS                          | Val  Loss: 2.2650 | Val  Acc: 0.2446
 Site-SynthDigits                   | Val  Loss: 2.3121 | Val  Acc: 0.0978
 Site-SynthDigits                   | Val  Loss: 2.3065 | Val  Acc: 0.1223
 Site-MNIST_M                       | Val  Loss: 2.3152 | Val  Acc: 0.0870
 Site-MNIST_M                       | Val  Loss: 2.3185 | Val  Acc: 0.1007
 Site-SVHN                          | Val  Loss: 2.2878 | Val  Acc: 0.1957
 Site-SVHN                          | Val  Loss: 2.2886 | Val  Acc: 0.1439
Average Valid Accuracy: 0.1480
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.0978
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.1187
 Best site-USPS                      | Epoch:1 | Val Acc: 0.2717
 Best site-USPS                      | Epoch:1 | Val Acc: 0.2446
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.0978
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.1223
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.0870
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.1007
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1957
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1439
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 2.2665 | Train Acc: 0.1482
 Site-MNIST                         | Train Loss: 2.2713 | Train Acc: 0.1498
 Site-USPS                          | Train Loss: 2.2589 | Train Acc: 0.2992
 Site-USPS                          | Train Loss: 2.2506 | Train Acc: 0.3408
 Site-SynthDigits                   | Train Loss: 2.2950 | Train Acc: 0.1267
 Site-SynthDigits                   | Train Loss: 2.2983 | Train Acc: 0.1417
 Site-MNIST_M                       | Train Loss: 2.3138 | Train Acc: 0.1078
 Site-MNIST_M                       | Train Loss: 2.3078 | Train Acc: 0.1040
 Site-SVHN                          | Train Loss: 2.2874 | Train Acc: 0.1213
 Site-SVHN                          | Train Loss: 2.2935 | Train Acc: 0.1345
Average Train Accuracy: 0.1674
 Site-MNIST                         | Val  Loss: 2.2697 | Val  Acc: 0.1522
 Site-MNIST                         | Val  Loss: 2.2714 | Val  Acc: 0.1619
 Site-USPS                          | Val  Loss: 2.2387 | Val  Acc: 0.3370
 Site-USPS                          | Val  Loss: 2.2515 | Val  Acc: 0.3058
 Site-SynthDigits                   | Val  Loss: 2.3069 | Val  Acc: 0.0978
 Site-SynthDigits                   | Val  Loss: 2.3033 | Val  Acc: 0.1367
 Site-MNIST_M                       | Val  Loss: 2.3132 | Val  Acc: 0.0978
 Site-MNIST_M                       | Val  Loss: 2.3166 | Val  Acc: 0.1043
 Site-SVHN                          | Val  Loss: 2.2834 | Val  Acc: 0.2065
 Site-SVHN                          | Val  Loss: 2.2843 | Val  Acc: 0.1655
Average Valid Accuracy: 0.1765
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.1522
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.1619
 Best site-USPS                      | Epoch:2 | Val Acc: 0.3370
 Best site-USPS                      | Epoch:2 | Val Acc: 0.3058
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.0978
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.1367
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.0978
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.1043
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2065
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.1655
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 2.2537 | Train Acc: 0.1914
 Site-MNIST                         | Train Loss: 2.2611 | Train Acc: 0.1758
 Site-USPS                          | Train Loss: 2.2427 | Train Acc: 0.3450
 Site-USPS                          | Train Loss: 2.2347 | Train Acc: 0.3973
 Site-SynthDigits                   | Train Loss: 2.2926 | Train Acc: 0.1429
 Site-SynthDigits                   | Train Loss: 2.2940 | Train Acc: 0.1543
 Site-MNIST_M                       | Train Loss: 2.3110 | Train Acc: 0.1132
 Site-MNIST_M                       | Train Loss: 2.3052 | Train Acc: 0.1058
 Site-SVHN                          | Train Loss: 2.2839 | Train Acc: 0.1348
 Site-SVHN                          | Train Loss: 2.2902 | Train Acc: 0.1426
Average Train Accuracy: 0.1903
 Site-MNIST                         | Val  Loss: 2.2605 | Val  Acc: 0.1739
 Site-MNIST                         | Val  Loss: 2.2612 | Val  Acc: 0.1871
 Site-USPS                          | Val  Loss: 2.2253 | Val  Acc: 0.4239
 Site-USPS                          | Val  Loss: 2.2383 | Val  Acc: 0.3669
 Site-SynthDigits                   | Val  Loss: 2.3018 | Val  Acc: 0.1304
 Site-SynthDigits                   | Val  Loss: 2.3002 | Val  Acc: 0.1511
 Site-MNIST_M                       | Val  Loss: 2.3112 | Val  Acc: 0.0978
 Site-MNIST_M                       | Val  Loss: 2.3146 | Val  Acc: 0.1043
 Site-SVHN                          | Val  Loss: 2.2792 | Val  Acc: 0.2065
 Site-SVHN                          | Val  Loss: 2.2801 | Val  Acc: 0.1799
Average Valid Accuracy: 0.2022
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.1739
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.1871
 Best site-USPS                      | Epoch:3 | Val Acc: 0.4239
 Best site-USPS                      | Epoch:3 | Val Acc: 0.3669
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.1304
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.1511
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.0978
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.1043
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2065
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.1799
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 2.2418 | Train Acc: 0.2237
 Site-MNIST                         | Train Loss: 2.2509 | Train Acc: 0.2117
 Site-USPS                          | Train Loss: 2.2267 | Train Acc: 0.3881
 Site-USPS                          | Train Loss: 2.2198 | Train Acc: 0.4278
 Site-SynthDigits                   | Train Loss: 2.2898 | Train Acc: 0.1456
 Site-SynthDigits                   | Train Loss: 2.2900 | Train Acc: 0.1641
 Site-MNIST_M                       | Train Loss: 2.3077 | Train Acc: 0.1132
 Site-MNIST_M                       | Train Loss: 2.3031 | Train Acc: 0.1103
 Site-SVHN                          | Train Loss: 2.2794 | Train Acc: 0.1644
 Site-SVHN                          | Train Loss: 2.2858 | Train Acc: 0.1489
Average Train Accuracy: 0.2098
 Site-MNIST                         | Val  Loss: 2.2514 | Val  Acc: 0.1957
 Site-MNIST                         | Val  Loss: 2.2509 | Val  Acc: 0.2230
 Site-USPS                          | Val  Loss: 2.2122 | Val  Acc: 0.4348
 Site-USPS                          | Val  Loss: 2.2253 | Val  Acc: 0.3957
 Site-SynthDigits                   | Val  Loss: 2.2968 | Val  Acc: 0.1522
 Site-SynthDigits                   | Val  Loss: 2.2970 | Val  Acc: 0.1619
 Site-MNIST_M                       | Val  Loss: 2.3093 | Val  Acc: 0.0978
 Site-MNIST_M                       | Val  Loss: 2.3127 | Val  Acc: 0.1007
 Site-SVHN                          | Val  Loss: 2.2751 | Val  Acc: 0.2065
 Site-SVHN                          | Val  Loss: 2.2760 | Val  Acc: 0.2014
Average Valid Accuracy: 0.2170
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.1957
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.2230
 Best site-USPS                      | Epoch:4 | Val Acc: 0.4348
 Best site-USPS                      | Epoch:4 | Val Acc: 0.3957
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.1522
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.1619
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.0978
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.1007
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2065
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 2.2302 | Train Acc: 0.2965
 Site-MNIST                         | Train Loss: 2.2407 | Train Acc: 0.2404
 Site-USPS                          | Train Loss: 2.2121 | Train Acc: 0.4097
 Site-USPS                          | Train Loss: 2.2047 | Train Acc: 0.4502
 Site-SynthDigits                   | Train Loss: 2.2881 | Train Acc: 0.1536
 Site-SynthDigits                   | Train Loss: 2.2855 | Train Acc: 0.1812
 Site-MNIST_M                       | Train Loss: 2.3072 | Train Acc: 0.1132
 Site-MNIST_M                       | Train Loss: 2.3024 | Train Acc: 0.1103
 Site-SVHN                          | Train Loss: 2.2774 | Train Acc: 0.1725
 Site-SVHN                          | Train Loss: 2.2844 | Train Acc: 0.1578
Average Train Accuracy: 0.2285
 Site-MNIST                         | Val  Loss: 2.2422 | Val  Acc: 0.1848
 Site-MNIST                         | Val  Loss: 2.2408 | Val  Acc: 0.2410
 Site-USPS                          | Val  Loss: 2.1991 | Val  Acc: 0.4674
 Site-USPS                          | Val  Loss: 2.2123 | Val  Acc: 0.4245
 Site-SynthDigits                   | Val  Loss: 2.2919 | Val  Acc: 0.1522
 Site-SynthDigits                   | Val  Loss: 2.2939 | Val  Acc: 0.1583
 Site-MNIST_M                       | Val  Loss: 2.3075 | Val  Acc: 0.1087
 Site-MNIST_M                       | Val  Loss: 2.3109 | Val  Acc: 0.1043
 Site-SVHN                          | Val  Loss: 2.2713 | Val  Acc: 0.2174
 Site-SVHN                          | Val  Loss: 2.2721 | Val  Acc: 0.2086
Average Valid Accuracy: 0.2267
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.1848
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.2410
 Best site-USPS                      | Epoch:5 | Val Acc: 0.4674
 Best site-USPS                      | Epoch:5 | Val Acc: 0.4245
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.1522
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.1583
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.1087
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.1043
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2174
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2086
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 2.2168 | Train Acc: 0.3450
 Site-MNIST                         | Train Loss: 2.2312 | Train Acc: 0.2717
 Site-USPS                          | Train Loss: 2.1976 | Train Acc: 0.4205
 Site-USPS                          | Train Loss: 2.1899 | Train Acc: 0.4574
 Site-SynthDigits                   | Train Loss: 2.2850 | Train Acc: 0.1644
 Site-SynthDigits                   | Train Loss: 2.2802 | Train Acc: 0.1910
 Site-MNIST_M                       | Train Loss: 2.3042 | Train Acc: 0.1186
 Site-MNIST_M                       | Train Loss: 2.2992 | Train Acc: 0.1103
 Site-SVHN                          | Train Loss: 2.2744 | Train Acc: 0.1752
 Site-SVHN                          | Train Loss: 2.2802 | Train Acc: 0.1686
Average Train Accuracy: 0.2423
 Site-MNIST                         | Val  Loss: 2.2331 | Val  Acc: 0.2174
 Site-MNIST                         | Val  Loss: 2.2307 | Val  Acc: 0.2806
 Site-USPS                          | Val  Loss: 2.1863 | Val  Acc: 0.4674
 Site-USPS                          | Val  Loss: 2.1996 | Val  Acc: 0.4353
 Site-SynthDigits                   | Val  Loss: 2.2871 | Val  Acc: 0.1957
 Site-SynthDigits                   | Val  Loss: 2.2908 | Val  Acc: 0.1727
 Site-MNIST_M                       | Val  Loss: 2.3058 | Val  Acc: 0.1087
 Site-MNIST_M                       | Val  Loss: 2.3090 | Val  Acc: 0.1079
 Site-SVHN                          | Val  Loss: 2.2677 | Val  Acc: 0.1957
 Site-SVHN                          | Val  Loss: 2.2685 | Val  Acc: 0.2086
Average Valid Accuracy: 0.2390
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.2174
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.2806
 Best site-USPS                      | Epoch:6 | Val Acc: 0.4674
 Best site-USPS                      | Epoch:6 | Val Acc: 0.4353
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.1957
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.1727
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.1087
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.1079
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.1957
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2086
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 2.2065 | Train Acc: 0.3881
 Site-MNIST                         | Train Loss: 2.2214 | Train Acc: 0.3103
 Site-USPS                          | Train Loss: 2.1839 | Train Acc: 0.4313
 Site-USPS                          | Train Loss: 2.1761 | Train Acc: 0.4700
 Site-SynthDigits                   | Train Loss: 2.2819 | Train Acc: 0.1698
 Site-SynthDigits                   | Train Loss: 2.2767 | Train Acc: 0.2036
 Site-MNIST_M                       | Train Loss: 2.3025 | Train Acc: 0.1186
 Site-MNIST_M                       | Train Loss: 2.2987 | Train Acc: 0.1130
 Site-SVHN                          | Train Loss: 2.2703 | Train Acc: 0.1833
 Site-SVHN                          | Train Loss: 2.2775 | Train Acc: 0.1803
Average Train Accuracy: 0.2568
 Site-MNIST                         | Val  Loss: 2.2240 | Val  Acc: 0.2826
 Site-MNIST                         | Val  Loss: 2.2207 | Val  Acc: 0.3417
 Site-USPS                          | Val  Loss: 2.1737 | Val  Acc: 0.4891
 Site-USPS                          | Val  Loss: 2.1870 | Val  Acc: 0.4460
 Site-SynthDigits                   | Val  Loss: 2.2824 | Val  Acc: 0.2065
 Site-SynthDigits                   | Val  Loss: 2.2876 | Val  Acc: 0.1763
 Site-MNIST_M                       | Val  Loss: 2.3040 | Val  Acc: 0.1196
 Site-MNIST_M                       | Val  Loss: 2.3072 | Val  Acc: 0.1151
 Site-SVHN                          | Val  Loss: 2.2641 | Val  Acc: 0.2174
 Site-SVHN                          | Val  Loss: 2.2649 | Val  Acc: 0.2194
Average Valid Accuracy: 0.2614
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.2826
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.3417
 Best site-USPS                      | Epoch:7 | Val Acc: 0.4891
 Best site-USPS                      | Epoch:7 | Val Acc: 0.4460
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.2065
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.1763
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.1196
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.1151
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2174
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2194
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 2.1944 | Train Acc: 0.4178
 Site-MNIST                         | Train Loss: 2.2117 | Train Acc: 0.3238
 Site-USPS                          | Train Loss: 2.1685 | Train Acc: 0.4420
 Site-USPS                          | Train Loss: 2.1602 | Train Acc: 0.4762
 Site-SynthDigits                   | Train Loss: 2.2801 | Train Acc: 0.1698
 Site-SynthDigits                   | Train Loss: 2.2734 | Train Acc: 0.2135
 Site-MNIST_M                       | Train Loss: 2.3010 | Train Acc: 0.1348
 Site-MNIST_M                       | Train Loss: 2.2977 | Train Acc: 0.1184
 Site-SVHN                          | Train Loss: 2.2675 | Train Acc: 0.1887
 Site-SVHN                          | Train Loss: 2.2751 | Train Acc: 0.1803
Average Train Accuracy: 0.2665
 Site-MNIST                         | Val  Loss: 2.2150 | Val  Acc: 0.3043
 Site-MNIST                         | Val  Loss: 2.2107 | Val  Acc: 0.3597
 Site-USPS                          | Val  Loss: 2.1610 | Val  Acc: 0.4891
 Site-USPS                          | Val  Loss: 2.1744 | Val  Acc: 0.4532
 Site-SynthDigits                   | Val  Loss: 2.2778 | Val  Acc: 0.2065
 Site-SynthDigits                   | Val  Loss: 2.2845 | Val  Acc: 0.1799
 Site-MNIST_M                       | Val  Loss: 2.3025 | Val  Acc: 0.1196
 Site-MNIST_M                       | Val  Loss: 2.3054 | Val  Acc: 0.1223
 Site-SVHN                          | Val  Loss: 2.2606 | Val  Acc: 0.1957
 Site-SVHN                          | Val  Loss: 2.2614 | Val  Acc: 0.2122
Average Valid Accuracy: 0.2643
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.3043
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.3597
 Best site-USPS                      | Epoch:8 | Val Acc: 0.4891
 Best site-USPS                      | Epoch:8 | Val Acc: 0.4532
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.2065
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.1799
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.1196
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.1223
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.1957
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2122
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 2.1823 | Train Acc: 0.4313
 Site-MNIST                         | Train Loss: 2.2012 | Train Acc: 0.3399
 Site-USPS                          | Train Loss: 2.1547 | Train Acc: 0.4501
 Site-USPS                          | Train Loss: 2.1460 | Train Acc: 0.4780
 Site-SynthDigits                   | Train Loss: 2.2774 | Train Acc: 0.1752
 Site-SynthDigits                   | Train Loss: 2.2692 | Train Acc: 0.2206
 Site-MNIST_M                       | Train Loss: 2.2991 | Train Acc: 0.1402
 Site-MNIST_M                       | Train Loss: 2.2940 | Train Acc: 0.1193
 Site-SVHN                          | Train Loss: 2.2656 | Train Acc: 0.2049
 Site-SVHN                          | Train Loss: 2.2722 | Train Acc: 0.1865
Average Train Accuracy: 0.2746
 Site-MNIST                         | Val  Loss: 2.2061 | Val  Acc: 0.3043
 Site-MNIST                         | Val  Loss: 2.2008 | Val  Acc: 0.3705
 Site-USPS                          | Val  Loss: 2.1485 | Val  Acc: 0.5000
 Site-USPS                          | Val  Loss: 2.1618 | Val  Acc: 0.4604
 Site-SynthDigits                   | Val  Loss: 2.2730 | Val  Acc: 0.2283
 Site-SynthDigits                   | Val  Loss: 2.2813 | Val  Acc: 0.1871
 Site-MNIST_M                       | Val  Loss: 2.3008 | Val  Acc: 0.1304
 Site-MNIST_M                       | Val  Loss: 2.3036 | Val  Acc: 0.1331
 Site-SVHN                          | Val  Loss: 2.2570 | Val  Acc: 0.2065
 Site-SVHN                          | Val  Loss: 2.2581 | Val  Acc: 0.2122
Average Valid Accuracy: 0.2733
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.3043
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.3705
 Best site-USPS                      | Epoch:9 | Val Acc: 0.5000
 Best site-USPS                      | Epoch:9 | Val Acc: 0.4604
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.2283
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.1871
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.1304
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.1331
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2065
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2122
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 2.1705 | Train Acc: 0.4447
 Site-MNIST                         | Train Loss: 2.1918 | Train Acc: 0.3525
 Site-USPS                          | Train Loss: 2.1377 | Train Acc: 0.4609
 Site-USPS                          | Train Loss: 2.1331 | Train Acc: 0.4825
 Site-SynthDigits                   | Train Loss: 2.2744 | Train Acc: 0.1779
 Site-SynthDigits                   | Train Loss: 2.2647 | Train Acc: 0.2242
 Site-MNIST_M                       | Train Loss: 2.2974 | Train Acc: 0.1482
 Site-MNIST_M                       | Train Loss: 2.2923 | Train Acc: 0.1283
 Site-SVHN                          | Train Loss: 2.2624 | Train Acc: 0.2022
 Site-SVHN                          | Train Loss: 2.2697 | Train Acc: 0.1910
Average Train Accuracy: 0.2812
 Site-MNIST                         | Val  Loss: 2.1971 | Val  Acc: 0.3261
 Site-MNIST                         | Val  Loss: 2.1909 | Val  Acc: 0.3849
 Site-USPS                          | Val  Loss: 2.1359 | Val  Acc: 0.5109
 Site-USPS                          | Val  Loss: 2.1492 | Val  Acc: 0.4676
 Site-SynthDigits                   | Val  Loss: 2.2683 | Val  Acc: 0.2174
 Site-SynthDigits                   | Val  Loss: 2.2781 | Val  Acc: 0.1799
 Site-MNIST_M                       | Val  Loss: 2.2992 | Val  Acc: 0.1304
 Site-MNIST_M                       | Val  Loss: 2.3019 | Val  Acc: 0.1439
 Site-SVHN                          | Val  Loss: 2.2536 | Val  Acc: 0.2065
 Site-SVHN                          | Val  Loss: 2.2549 | Val  Acc: 0.2158
Average Valid Accuracy: 0.2783
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.3261
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.3849
 Best site-USPS                      | Epoch:10 | Val Acc: 0.5109
 Best site-USPS                      | Epoch:10 | Val Acc: 0.4676
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.2174
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.1799
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.1304
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.1439
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2065
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2158
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 2.1593 | Train Acc: 0.4663
 Site-MNIST                         | Train Loss: 2.1827 | Train Acc: 0.3749
 Site-USPS                          | Train Loss: 2.1258 | Train Acc: 0.4771
 Site-USPS                          | Train Loss: 2.1190 | Train Acc: 0.4897
 Site-SynthDigits                   | Train Loss: 2.2717 | Train Acc: 0.1806
 Site-SynthDigits                   | Train Loss: 2.2610 | Train Acc: 0.2314
 Site-MNIST_M                       | Train Loss: 2.2951 | Train Acc: 0.1482
 Site-MNIST_M                       | Train Loss: 2.2912 | Train Acc: 0.1336
 Site-SVHN                          | Train Loss: 2.2592 | Train Acc: 0.2075
 Site-SVHN                          | Train Loss: 2.2669 | Train Acc: 0.1910
Average Train Accuracy: 0.2900
 Site-MNIST                         | Val  Loss: 2.1881 | Val  Acc: 0.3478
 Site-MNIST                         | Val  Loss: 2.1810 | Val  Acc: 0.4065
 Site-USPS                          | Val  Loss: 2.1235 | Val  Acc: 0.5000
 Site-USPS                          | Val  Loss: 2.1369 | Val  Acc: 0.4856
 Site-SynthDigits                   | Val  Loss: 2.2639 | Val  Acc: 0.2174
 Site-SynthDigits                   | Val  Loss: 2.2749 | Val  Acc: 0.1871
 Site-MNIST_M                       | Val  Loss: 2.2976 | Val  Acc: 0.1522
 Site-MNIST_M                       | Val  Loss: 2.3002 | Val  Acc: 0.1475
 Site-SVHN                          | Val  Loss: 2.2503 | Val  Acc: 0.1739
 Site-SVHN                          | Val  Loss: 2.2518 | Val  Acc: 0.2122
Average Valid Accuracy: 0.2830
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.3478
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.4065
 Best site-USPS                      | Epoch:11 | Val Acc: 0.5000
 Best site-USPS                      | Epoch:11 | Val Acc: 0.4856
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.2174
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.1871
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.1522
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.1475
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.1739
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2122
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 2.1477 | Train Acc: 0.4717
 Site-MNIST                         | Train Loss: 2.1739 | Train Acc: 0.3839
 Site-USPS                          | Train Loss: 2.1116 | Train Acc: 0.4879
 Site-USPS                          | Train Loss: 2.1056 | Train Acc: 0.4978
 Site-SynthDigits                   | Train Loss: 2.2695 | Train Acc: 0.1914
 Site-SynthDigits                   | Train Loss: 2.2558 | Train Acc: 0.2413
 Site-MNIST_M                       | Train Loss: 2.2935 | Train Acc: 0.1509
 Site-MNIST_M                       | Train Loss: 2.2893 | Train Acc: 0.1390
 Site-SVHN                          | Train Loss: 2.2564 | Train Acc: 0.2129
 Site-SVHN                          | Train Loss: 2.2634 | Train Acc: 0.1973
Average Train Accuracy: 0.2974
 Site-MNIST                         | Val  Loss: 2.1790 | Val  Acc: 0.3696
 Site-MNIST                         | Val  Loss: 2.1712 | Val  Acc: 0.4101
 Site-USPS                          | Val  Loss: 2.1112 | Val  Acc: 0.5000
 Site-USPS                          | Val  Loss: 2.1246 | Val  Acc: 0.4856
 Site-SynthDigits                   | Val  Loss: 2.2593 | Val  Acc: 0.2391
 Site-SynthDigits                   | Val  Loss: 2.2717 | Val  Acc: 0.2050
 Site-MNIST_M                       | Val  Loss: 2.2960 | Val  Acc: 0.1522
 Site-MNIST_M                       | Val  Loss: 2.2985 | Val  Acc: 0.1547
 Site-SVHN                          | Val  Loss: 2.2472 | Val  Acc: 0.1957
 Site-SVHN                          | Val  Loss: 2.2487 | Val  Acc: 0.2230
Average Valid Accuracy: 0.2935
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.3696
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.4101
 Best site-USPS                      | Epoch:12 | Val Acc: 0.5000
 Best site-USPS                      | Epoch:12 | Val Acc: 0.4856
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.2391
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.2050
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.1522
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.1547
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.1957
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2230
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 2.1361 | Train Acc: 0.4744
 Site-MNIST                         | Train Loss: 2.1655 | Train Acc: 0.3919
 Site-USPS                          | Train Loss: 2.0969 | Train Acc: 0.4933
 Site-USPS                          | Train Loss: 2.0920 | Train Acc: 0.5004
 Site-SynthDigits                   | Train Loss: 2.2661 | Train Acc: 0.1995
 Site-SynthDigits                   | Train Loss: 2.2551 | Train Acc: 0.2511
 Site-MNIST_M                       | Train Loss: 2.2918 | Train Acc: 0.1509
 Site-MNIST_M                       | Train Loss: 2.2885 | Train Acc: 0.1426
 Site-SVHN                          | Train Loss: 2.2545 | Train Acc: 0.2156
 Site-SVHN                          | Train Loss: 2.2602 | Train Acc: 0.1964
Average Train Accuracy: 0.3016
 Site-MNIST                         | Val  Loss: 2.1697 | Val  Acc: 0.3696
 Site-MNIST                         | Val  Loss: 2.1613 | Val  Acc: 0.4101
 Site-USPS                          | Val  Loss: 2.0992 | Val  Acc: 0.5000
 Site-USPS                          | Val  Loss: 2.1125 | Val  Acc: 0.4820
 Site-SynthDigits                   | Val  Loss: 2.2548 | Val  Acc: 0.2500
 Site-SynthDigits                   | Val  Loss: 2.2685 | Val  Acc: 0.2158
 Site-MNIST_M                       | Val  Loss: 2.2945 | Val  Acc: 0.1522
 Site-MNIST_M                       | Val  Loss: 2.2968 | Val  Acc: 0.1547
 Site-SVHN                          | Val  Loss: 2.2442 | Val  Acc: 0.2065
 Site-SVHN                          | Val  Loss: 2.2457 | Val  Acc: 0.2230
Average Valid Accuracy: 0.2964
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.3696
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.4101
 Best site-USPS                      | Epoch:13 | Val Acc: 0.5000
 Best site-USPS                      | Epoch:13 | Val Acc: 0.4820
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.2500
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.2158
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.1522
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.1547
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.2065
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.2230
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 2.1248 | Train Acc: 0.4798
 Site-MNIST                         | Train Loss: 2.1535 | Train Acc: 0.3973
 Site-USPS                          | Train Loss: 2.0841 | Train Acc: 0.4933
 Site-USPS                          | Train Loss: 2.0780 | Train Acc: 0.5112
 Site-SynthDigits                   | Train Loss: 2.2626 | Train Acc: 0.2049
 Site-SynthDigits                   | Train Loss: 2.2479 | Train Acc: 0.2592
 Site-MNIST_M                       | Train Loss: 2.2903 | Train Acc: 0.1563
 Site-MNIST_M                       | Train Loss: 2.2880 | Train Acc: 0.1480
 Site-SVHN                          | Train Loss: 2.2519 | Train Acc: 0.2210
 Site-SVHN                          | Train Loss: 2.2570 | Train Acc: 0.1964
Average Train Accuracy: 0.3067
 Site-MNIST                         | Val  Loss: 2.1605 | Val  Acc: 0.3696
 Site-MNIST                         | Val  Loss: 2.1516 | Val  Acc: 0.4101
 Site-USPS                          | Val  Loss: 2.0868 | Val  Acc: 0.5109
 Site-USPS                          | Val  Loss: 2.1001 | Val  Acc: 0.4892
 Site-SynthDigits                   | Val  Loss: 2.2503 | Val  Acc: 0.2500
 Site-SynthDigits                   | Val  Loss: 2.2653 | Val  Acc: 0.2158
 Site-MNIST_M                       | Val  Loss: 2.2926 | Val  Acc: 0.1522
 Site-MNIST_M                       | Val  Loss: 2.2951 | Val  Acc: 0.1619
 Site-SVHN                          | Val  Loss: 2.2411 | Val  Acc: 0.2065
 Site-SVHN                          | Val  Loss: 2.2428 | Val  Acc: 0.2230
Average Valid Accuracy: 0.2989
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.3696
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.4101
 Best site-USPS                      | Epoch:14 | Val Acc: 0.5109
 Best site-USPS                      | Epoch:14 | Val Acc: 0.4892
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.2500
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.2158
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.1522
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.1619
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.2065
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.2230
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 2.1135 | Train Acc: 0.4852
 Site-MNIST                         | Train Loss: 2.1437 | Train Acc: 0.4027
 Site-USPS                          | Train Loss: 2.0704 | Train Acc: 0.4987
 Site-USPS                          | Train Loss: 2.0627 | Train Acc: 0.5184
 Site-SynthDigits                   | Train Loss: 2.2609 | Train Acc: 0.2183
 Site-SynthDigits                   | Train Loss: 2.2443 | Train Acc: 0.2726
 Site-MNIST_M                       | Train Loss: 2.2883 | Train Acc: 0.1590
 Site-MNIST_M                       | Train Loss: 2.2833 | Train Acc: 0.1516
 Site-SVHN                          | Train Loss: 2.2491 | Train Acc: 0.2264
 Site-SVHN                          | Train Loss: 2.2577 | Train Acc: 0.1955
Average Train Accuracy: 0.3128
 Site-MNIST                         | Val  Loss: 2.1513 | Val  Acc: 0.3804
 Site-MNIST                         | Val  Loss: 2.1418 | Val  Acc: 0.4209
 Site-USPS                          | Val  Loss: 2.0747 | Val  Acc: 0.5000
 Site-USPS                          | Val  Loss: 2.0880 | Val  Acc: 0.4892
 Site-SynthDigits                   | Val  Loss: 2.2460 | Val  Acc: 0.2826
 Site-SynthDigits                   | Val  Loss: 2.2621 | Val  Acc: 0.2410
 Site-MNIST_M                       | Val  Loss: 2.2910 | Val  Acc: 0.1630
 Site-MNIST_M                       | Val  Loss: 2.2933 | Val  Acc: 0.1655
 Site-SVHN                          | Val  Loss: 2.2381 | Val  Acc: 0.2065
 Site-SVHN                          | Val  Loss: 2.2400 | Val  Acc: 0.2266
Average Valid Accuracy: 0.3076
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.3804
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.4209
 Best site-USPS                      | Epoch:15 | Val Acc: 0.5000
 Best site-USPS                      | Epoch:15 | Val Acc: 0.4892
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.2826
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.2410
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.1630
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.1655
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2065
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2266
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 2.1018 | Train Acc: 0.4933
 Site-MNIST                         | Train Loss: 2.1346 | Train Acc: 0.4099
 Site-USPS                          | Train Loss: 2.0561 | Train Acc: 0.4987
 Site-USPS                          | Train Loss: 2.0508 | Train Acc: 0.5202
 Site-SynthDigits                   | Train Loss: 2.2573 | Train Acc: 0.2210
 Site-SynthDigits                   | Train Loss: 2.2401 | Train Acc: 0.2726
 Site-MNIST_M                       | Train Loss: 2.2866 | Train Acc: 0.1563
 Site-MNIST_M                       | Train Loss: 2.2815 | Train Acc: 0.1543
 Site-SVHN                          | Train Loss: 2.2468 | Train Acc: 0.2345
 Site-SVHN                          | Train Loss: 2.2543 | Train Acc: 0.2018
Average Train Accuracy: 0.3163
 Site-MNIST                         | Val  Loss: 2.1419 | Val  Acc: 0.3804
 Site-MNIST                         | Val  Loss: 2.1320 | Val  Acc: 0.4173
 Site-USPS                          | Val  Loss: 2.0626 | Val  Acc: 0.4891
 Site-USPS                          | Val  Loss: 2.0761 | Val  Acc: 0.4820
 Site-SynthDigits                   | Val  Loss: 2.2415 | Val  Acc: 0.2609
 Site-SynthDigits                   | Val  Loss: 2.2588 | Val  Acc: 0.2338
 Site-MNIST_M                       | Val  Loss: 2.2896 | Val  Acc: 0.1848
 Site-MNIST_M                       | Val  Loss: 2.2915 | Val  Acc: 0.1655
 Site-SVHN                          | Val  Loss: 2.2353 | Val  Acc: 0.2391
 Site-SVHN                          | Val  Loss: 2.2372 | Val  Acc: 0.2518
Average Valid Accuracy: 0.3105
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.3804
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.4173
 Best site-USPS                      | Epoch:16 | Val Acc: 0.4891
 Best site-USPS                      | Epoch:16 | Val Acc: 0.4820
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.2609
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.2338
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.1848
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.1655
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.2391
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.2518
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 2.0907 | Train Acc: 0.4933
 Site-MNIST                         | Train Loss: 2.1248 | Train Acc: 0.4126
 Site-USPS                          | Train Loss: 2.0454 | Train Acc: 0.5094
 Site-USPS                          | Train Loss: 2.0358 | Train Acc: 0.5220
 Site-SynthDigits                   | Train Loss: 2.2554 | Train Acc: 0.2210
 Site-SynthDigits                   | Train Loss: 2.2369 | Train Acc: 0.2744
 Site-MNIST_M                       | Train Loss: 2.2852 | Train Acc: 0.1617
 Site-MNIST_M                       | Train Loss: 2.2818 | Train Acc: 0.1561
 Site-SVHN                          | Train Loss: 2.2438 | Train Acc: 0.2372
 Site-SVHN                          | Train Loss: 2.2512 | Train Acc: 0.2063
Average Train Accuracy: 0.3194
 Site-MNIST                         | Val  Loss: 2.1326 | Val  Acc: 0.3913
 Site-MNIST                         | Val  Loss: 2.1224 | Val  Acc: 0.4245
 Site-USPS                          | Val  Loss: 2.0504 | Val  Acc: 0.4783
 Site-USPS                          | Val  Loss: 2.0640 | Val  Acc: 0.4748
 Site-SynthDigits                   | Val  Loss: 2.2374 | Val  Acc: 0.2609
 Site-SynthDigits                   | Val  Loss: 2.2555 | Val  Acc: 0.2302
 Site-MNIST_M                       | Val  Loss: 2.2882 | Val  Acc: 0.1848
 Site-MNIST_M                       | Val  Loss: 2.2899 | Val  Acc: 0.1691
 Site-SVHN                          | Val  Loss: 2.2323 | Val  Acc: 0.2500
 Site-SVHN                          | Val  Loss: 2.2346 | Val  Acc: 0.2554
Average Valid Accuracy: 0.3119
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.3913
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.4245
 Best site-USPS                      | Epoch:17 | Val Acc: 0.4783
 Best site-USPS                      | Epoch:17 | Val Acc: 0.4748
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.2609
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.2302
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.1848
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.1691
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.2500
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.2554
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 2.0785 | Train Acc: 0.5013
 Site-MNIST                         | Train Loss: 2.1156 | Train Acc: 0.4135
 Site-USPS                          | Train Loss: 2.0302 | Train Acc: 0.5121
 Site-USPS                          | Train Loss: 2.0232 | Train Acc: 0.5265
 Site-SynthDigits                   | Train Loss: 2.2511 | Train Acc: 0.2237
 Site-SynthDigits                   | Train Loss: 2.2336 | Train Acc: 0.2861
 Site-MNIST_M                       | Train Loss: 2.2842 | Train Acc: 0.1671
 Site-MNIST_M                       | Train Loss: 2.2777 | Train Acc: 0.1587
 Site-SVHN                          | Train Loss: 2.2410 | Train Acc: 0.2372
 Site-SVHN                          | Train Loss: 2.2494 | Train Acc: 0.2072
Average Train Accuracy: 0.3233
 Site-MNIST                         | Val  Loss: 2.1232 | Val  Acc: 0.3913
 Site-MNIST                         | Val  Loss: 2.1128 | Val  Acc: 0.4245
 Site-USPS                          | Val  Loss: 2.0382 | Val  Acc: 0.4674
 Site-USPS                          | Val  Loss: 2.0518 | Val  Acc: 0.4712
 Site-SynthDigits                   | Val  Loss: 2.2331 | Val  Acc: 0.2609
 Site-SynthDigits                   | Val  Loss: 2.2521 | Val  Acc: 0.2338
 Site-MNIST_M                       | Val  Loss: 2.2868 | Val  Acc: 0.1957
 Site-MNIST_M                       | Val  Loss: 2.2881 | Val  Acc: 0.1799
 Site-SVHN                          | Val  Loss: 2.2295 | Val  Acc: 0.2500
 Site-SVHN                          | Val  Loss: 2.2321 | Val  Acc: 0.2626
Average Valid Accuracy: 0.3137
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.3913
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.4245
 Best site-USPS                      | Epoch:18 | Val Acc: 0.4674
 Best site-USPS                      | Epoch:18 | Val Acc: 0.4712
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.2609
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.2338
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.1957
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.1799
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.2500
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.2626
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 2.0705 | Train Acc: 0.5121
 Site-MNIST                         | Train Loss: 2.1074 | Train Acc: 0.4170
 Site-USPS                          | Train Loss: 2.0164 | Train Acc: 0.5229
 Site-USPS                          | Train Loss: 2.0085 | Train Acc: 0.5291
 Site-SynthDigits                   | Train Loss: 2.2489 | Train Acc: 0.2372
 Site-SynthDigits                   | Train Loss: 2.2275 | Train Acc: 0.2870
 Site-MNIST_M                       | Train Loss: 2.2818 | Train Acc: 0.1671
 Site-MNIST_M                       | Train Loss: 2.2788 | Train Acc: 0.1596
 Site-SVHN                          | Train Loss: 2.2397 | Train Acc: 0.2372
 Site-SVHN                          | Train Loss: 2.2495 | Train Acc: 0.2117
Average Train Accuracy: 0.3281
 Site-MNIST                         | Val  Loss: 2.1138 | Val  Acc: 0.4022
 Site-MNIST                         | Val  Loss: 2.1032 | Val  Acc: 0.4317
 Site-USPS                          | Val  Loss: 2.0260 | Val  Acc: 0.4674
 Site-USPS                          | Val  Loss: 2.0398 | Val  Acc: 0.4748
 Site-SynthDigits                   | Val  Loss: 2.2289 | Val  Acc: 0.2609
 Site-SynthDigits                   | Val  Loss: 2.2488 | Val  Acc: 0.2518
 Site-MNIST_M                       | Val  Loss: 2.2853 | Val  Acc: 0.1957
 Site-MNIST_M                       | Val  Loss: 2.2863 | Val  Acc: 0.1727
 Site-SVHN                          | Val  Loss: 2.2265 | Val  Acc: 0.2609
 Site-SVHN                          | Val  Loss: 2.2297 | Val  Acc: 0.2698
Average Valid Accuracy: 0.3188
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.4022
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.4317
 Best site-USPS                      | Epoch:19 | Val Acc: 0.4674
 Best site-USPS                      | Epoch:19 | Val Acc: 0.4748
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.2609
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.2518
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.1957
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.1727
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.2609
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.2698
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 2.0594 | Train Acc: 0.5121
 Site-MNIST                         | Train Loss: 2.0968 | Train Acc: 0.4242
 Site-USPS                          | Train Loss: 2.0022 | Train Acc: 0.5256
 Site-USPS                          | Train Loss: 1.9948 | Train Acc: 0.5336
 Site-SynthDigits                   | Train Loss: 2.2452 | Train Acc: 0.2372
 Site-SynthDigits                   | Train Loss: 2.2245 | Train Acc: 0.2915
 Site-MNIST_M                       | Train Loss: 2.2793 | Train Acc: 0.1860
 Site-MNIST_M                       | Train Loss: 2.2758 | Train Acc: 0.1668
 Site-SVHN                          | Train Loss: 2.2375 | Train Acc: 0.2426
 Site-SVHN                          | Train Loss: 2.2466 | Train Acc: 0.2117
Average Train Accuracy: 0.3331
 Site-MNIST                         | Val  Loss: 2.1046 | Val  Acc: 0.4022
 Site-MNIST                         | Val  Loss: 2.0939 | Val  Acc: 0.4353
 Site-USPS                          | Val  Loss: 2.0137 | Val  Acc: 0.4783
 Site-USPS                          | Val  Loss: 2.0277 | Val  Acc: 0.4784
 Site-SynthDigits                   | Val  Loss: 2.2247 | Val  Acc: 0.2609
 Site-SynthDigits                   | Val  Loss: 2.2454 | Val  Acc: 0.2554
 Site-MNIST_M                       | Val  Loss: 2.2842 | Val  Acc: 0.1957
 Site-MNIST_M                       | Val  Loss: 2.2845 | Val  Acc: 0.1799
 Site-SVHN                          | Val  Loss: 2.2238 | Val  Acc: 0.2609
 Site-SVHN                          | Val  Loss: 2.2274 | Val  Acc: 0.2698
Average Valid Accuracy: 0.3217
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.4022
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.4353
 Best site-USPS                      | Epoch:20 | Val Acc: 0.4783
 Best site-USPS                      | Epoch:20 | Val Acc: 0.4784
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.2609
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.2554
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.1957
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.1799
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.2609
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.2698
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 2.0474 | Train Acc: 0.5094
 Site-MNIST                         | Train Loss: 2.0868 | Train Acc: 0.4323
 Site-USPS                          | Train Loss: 1.9901 | Train Acc: 0.5283
 Site-USPS                          | Train Loss: 1.9831 | Train Acc: 0.5372
 Site-SynthDigits                   | Train Loss: 2.2424 | Train Acc: 0.2399
 Site-SynthDigits                   | Train Loss: 2.2192 | Train Acc: 0.3040
 Site-MNIST_M                       | Train Loss: 2.2796 | Train Acc: 0.1941
 Site-MNIST_M                       | Train Loss: 2.2733 | Train Acc: 0.1731
 Site-SVHN                          | Train Loss: 2.2357 | Train Acc: 0.2399
 Site-SVHN                          | Train Loss: 2.2447 | Train Acc: 0.2135
Average Train Accuracy: 0.3372
 Site-MNIST                         | Val  Loss: 2.0956 | Val  Acc: 0.4022
 Site-MNIST                         | Val  Loss: 2.0847 | Val  Acc: 0.4388
 Site-USPS                          | Val  Loss: 2.0014 | Val  Acc: 0.4783
 Site-USPS                          | Val  Loss: 2.0156 | Val  Acc: 0.4784
 Site-SynthDigits                   | Val  Loss: 2.2209 | Val  Acc: 0.2826
 Site-SynthDigits                   | Val  Loss: 2.2421 | Val  Acc: 0.2590
 Site-MNIST_M                       | Val  Loss: 2.2830 | Val  Acc: 0.1957
 Site-MNIST_M                       | Val  Loss: 2.2829 | Val  Acc: 0.1906
 Site-SVHN                          | Val  Loss: 2.2210 | Val  Acc: 0.2717
 Site-SVHN                          | Val  Loss: 2.2251 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3271
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.4022
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.4388
 Best site-USPS                      | Epoch:21 | Val Acc: 0.4783
 Best site-USPS                      | Epoch:21 | Val Acc: 0.4784
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.2826
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.2590
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.1957
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.1906
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.2717
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 2.0402 | Train Acc: 0.5094
 Site-MNIST                         | Train Loss: 2.0770 | Train Acc: 0.4368
 Site-USPS                          | Train Loss: 1.9769 | Train Acc: 0.5337
 Site-USPS                          | Train Loss: 1.9724 | Train Acc: 0.5444
 Site-SynthDigits                   | Train Loss: 2.2402 | Train Acc: 0.2426
 Site-SynthDigits                   | Train Loss: 2.2177 | Train Acc: 0.3085
 Site-MNIST_M                       | Train Loss: 2.2766 | Train Acc: 0.2049
 Site-MNIST_M                       | Train Loss: 2.2714 | Train Acc: 0.1803
 Site-SVHN                          | Train Loss: 2.2327 | Train Acc: 0.2399
 Site-SVHN                          | Train Loss: 2.2408 | Train Acc: 0.2135
Average Train Accuracy: 0.3414
 Site-MNIST                         | Val  Loss: 2.0863 | Val  Acc: 0.4022
 Site-MNIST                         | Val  Loss: 2.0754 | Val  Acc: 0.4424
 Site-USPS                          | Val  Loss: 1.9895 | Val  Acc: 0.4783
 Site-USPS                          | Val  Loss: 2.0040 | Val  Acc: 0.4856
 Site-SynthDigits                   | Val  Loss: 2.2167 | Val  Acc: 0.2826
 Site-SynthDigits                   | Val  Loss: 2.2386 | Val  Acc: 0.2662
 Site-MNIST_M                       | Val  Loss: 2.2819 | Val  Acc: 0.1957
 Site-MNIST_M                       | Val  Loss: 2.2812 | Val  Acc: 0.2014
 Site-SVHN                          | Val  Loss: 2.2186 | Val  Acc: 0.2717
 Site-SVHN                          | Val  Loss: 2.2230 | Val  Acc: 0.2662
Average Valid Accuracy: 0.3292
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.4022
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.4424
 Best site-USPS                      | Epoch:22 | Val Acc: 0.4783
 Best site-USPS                      | Epoch:22 | Val Acc: 0.4856
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.2826
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.2662
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.1957
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.2014
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.2717
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.2662
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 2.0290 | Train Acc: 0.5148
 Site-MNIST                         | Train Loss: 2.0677 | Train Acc: 0.4404
 Site-USPS                          | Train Loss: 1.9642 | Train Acc: 0.5391
 Site-USPS                          | Train Loss: 1.9593 | Train Acc: 0.5498
 Site-SynthDigits                   | Train Loss: 2.2368 | Train Acc: 0.2399
 Site-SynthDigits                   | Train Loss: 2.2115 | Train Acc: 0.3103
 Site-MNIST_M                       | Train Loss: 2.2755 | Train Acc: 0.2022
 Site-MNIST_M                       | Train Loss: 2.2691 | Train Acc: 0.1892
 Site-SVHN                          | Train Loss: 2.2312 | Train Acc: 0.2399
 Site-SVHN                          | Train Loss: 2.2398 | Train Acc: 0.2152
Average Train Accuracy: 0.3441
 Site-MNIST                         | Val  Loss: 2.0770 | Val  Acc: 0.4022
 Site-MNIST                         | Val  Loss: 2.0662 | Val  Acc: 0.4424
 Site-USPS                          | Val  Loss: 1.9781 | Val  Acc: 0.4891
 Site-USPS                          | Val  Loss: 1.9927 | Val  Acc: 0.4928
 Site-SynthDigits                   | Val  Loss: 2.2124 | Val  Acc: 0.2826
 Site-SynthDigits                   | Val  Loss: 2.2351 | Val  Acc: 0.2662
 Site-MNIST_M                       | Val  Loss: 2.2807 | Val  Acc: 0.1848
 Site-MNIST_M                       | Val  Loss: 2.2796 | Val  Acc: 0.2014
 Site-SVHN                          | Val  Loss: 2.2162 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.2207 | Val  Acc: 0.2698
Average Valid Accuracy: 0.3314
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.4022
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.4424
 Best site-USPS                      | Epoch:23 | Val Acc: 0.4891
 Best site-USPS                      | Epoch:23 | Val Acc: 0.4928
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.2826
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.2662
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.1848
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.2014
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.2698
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 2.0185 | Train Acc: 0.5202
 Site-MNIST                         | Train Loss: 2.0597 | Train Acc: 0.4404
 Site-USPS                          | Train Loss: 1.9501 | Train Acc: 0.5418
 Site-USPS                          | Train Loss: 1.9472 | Train Acc: 0.5507
 Site-SynthDigits                   | Train Loss: 2.2329 | Train Acc: 0.2426
 Site-SynthDigits                   | Train Loss: 2.2072 | Train Acc: 0.3157
 Site-MNIST_M                       | Train Loss: 2.2739 | Train Acc: 0.1995
 Site-MNIST_M                       | Train Loss: 2.2684 | Train Acc: 0.1919
 Site-SVHN                          | Train Loss: 2.2295 | Train Acc: 0.2399
 Site-SVHN                          | Train Loss: 2.2389 | Train Acc: 0.2179
Average Train Accuracy: 0.3461
 Site-MNIST                         | Val  Loss: 2.0679 | Val  Acc: 0.4022
 Site-MNIST                         | Val  Loss: 2.0572 | Val  Acc: 0.4460
 Site-USPS                          | Val  Loss: 1.9666 | Val  Acc: 0.4891
 Site-USPS                          | Val  Loss: 1.9814 | Val  Acc: 0.4892
 Site-SynthDigits                   | Val  Loss: 2.2081 | Val  Acc: 0.2826
 Site-SynthDigits                   | Val  Loss: 2.2315 | Val  Acc: 0.2626
 Site-MNIST_M                       | Val  Loss: 2.2795 | Val  Acc: 0.1848
 Site-MNIST_M                       | Val  Loss: 2.2778 | Val  Acc: 0.2050
 Site-SVHN                          | Val  Loss: 2.2138 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.2186 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3318
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.4022
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.4460
 Best site-USPS                      | Epoch:24 | Val Acc: 0.4891
 Best site-USPS                      | Epoch:24 | Val Acc: 0.4892
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.2826
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.2626
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.1848
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.2050
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 2.0037 | Train Acc: 0.5310
 Site-MNIST                         | Train Loss: 2.0514 | Train Acc: 0.4368
 Site-USPS                          | Train Loss: 1.9363 | Train Acc: 0.5391
 Site-USPS                          | Train Loss: 1.9335 | Train Acc: 0.5516
 Site-SynthDigits                   | Train Loss: 2.2296 | Train Acc: 0.2453
 Site-SynthDigits                   | Train Loss: 2.2044 | Train Acc: 0.3247
 Site-MNIST_M                       | Train Loss: 2.2722 | Train Acc: 0.2049
 Site-MNIST_M                       | Train Loss: 2.2655 | Train Acc: 0.1937
 Site-SVHN                          | Train Loss: 2.2267 | Train Acc: 0.2399
 Site-SVHN                          | Train Loss: 2.2361 | Train Acc: 0.2179
Average Train Accuracy: 0.3485
 Site-MNIST                         | Val  Loss: 2.0577 | Val  Acc: 0.3913
 Site-MNIST                         | Val  Loss: 2.0463 | Val  Acc: 0.4460
 Site-USPS                          | Val  Loss: 1.9514 | Val  Acc: 0.4783
 Site-USPS                          | Val  Loss: 1.9662 | Val  Acc: 0.4892
 Site-SynthDigits                   | Val  Loss: 2.2035 | Val  Acc: 0.2935
 Site-SynthDigits                   | Val  Loss: 2.2279 | Val  Acc: 0.2734
 Site-MNIST_M                       | Val  Loss: 2.2780 | Val  Acc: 0.1848
 Site-MNIST_M                       | Val  Loss: 2.2760 | Val  Acc: 0.2050
 Site-SVHN                          | Val  Loss: 2.2107 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.2162 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3321
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.3913
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.4460
 Best site-USPS                      | Epoch:25 | Val Acc: 0.4783
 Best site-USPS                      | Epoch:25 | Val Acc: 0.4892
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.2935
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.2734
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.1848
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.2050
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.2770
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 1.9936 | Train Acc: 0.5337
 Site-MNIST                         | Train Loss: 2.0424 | Train Acc: 0.4439
 Site-USPS                          | Train Loss: 1.9222 | Train Acc: 0.5418
 Site-USPS                          | Train Loss: 1.9160 | Train Acc: 0.5534
 Site-SynthDigits                   | Train Loss: 2.2267 | Train Acc: 0.2453
 Site-SynthDigits                   | Train Loss: 2.2007 | Train Acc: 0.3238
 Site-MNIST_M                       | Train Loss: 2.2694 | Train Acc: 0.2022
 Site-MNIST_M                       | Train Loss: 2.2637 | Train Acc: 0.1964
 Site-SVHN                          | Train Loss: 2.2260 | Train Acc: 0.2399
 Site-SVHN                          | Train Loss: 2.2331 | Train Acc: 0.2188
Average Train Accuracy: 0.3499
 Site-MNIST                         | Val  Loss: 2.0488 | Val  Acc: 0.4130
 Site-MNIST                         | Val  Loss: 2.0375 | Val  Acc: 0.4568
 Site-USPS                          | Val  Loss: 1.9402 | Val  Acc: 0.4891
 Site-USPS                          | Val  Loss: 1.9552 | Val  Acc: 0.4928
 Site-SynthDigits                   | Val  Loss: 2.1994 | Val  Acc: 0.2935
 Site-SynthDigits                   | Val  Loss: 2.2243 | Val  Acc: 0.2662
 Site-MNIST_M                       | Val  Loss: 2.2769 | Val  Acc: 0.1739
 Site-MNIST_M                       | Val  Loss: 2.2743 | Val  Acc: 0.2158
 Site-SVHN                          | Val  Loss: 2.2085 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.2142 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3361
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.4130
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.4568
 Best site-USPS                      | Epoch:26 | Val Acc: 0.4891
 Best site-USPS                      | Epoch:26 | Val Acc: 0.4928
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.2935
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.2662
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.1739
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.2158
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.2770
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 1.9803 | Train Acc: 0.5418
 Site-MNIST                         | Train Loss: 2.0346 | Train Acc: 0.4466
 Site-USPS                          | Train Loss: 1.9089 | Train Acc: 0.5337
 Site-USPS                          | Train Loss: 1.9039 | Train Acc: 0.5525
 Site-SynthDigits                   | Train Loss: 2.2236 | Train Acc: 0.2480
 Site-SynthDigits                   | Train Loss: 2.1939 | Train Acc: 0.3247
 Site-MNIST_M                       | Train Loss: 2.2682 | Train Acc: 0.2075
 Site-MNIST_M                       | Train Loss: 2.2628 | Train Acc: 0.2000
 Site-SVHN                          | Train Loss: 2.2233 | Train Acc: 0.2399
 Site-SVHN                          | Train Loss: 2.2323 | Train Acc: 0.2188
Average Train Accuracy: 0.3513
 Site-MNIST                         | Val  Loss: 2.0390 | Val  Acc: 0.4022
 Site-MNIST                         | Val  Loss: 2.0273 | Val  Acc: 0.4604
 Site-USPS                          | Val  Loss: 1.9264 | Val  Acc: 0.4891
 Site-USPS                          | Val  Loss: 1.9414 | Val  Acc: 0.4928
 Site-SynthDigits                   | Val  Loss: 2.1946 | Val  Acc: 0.2935
 Site-SynthDigits                   | Val  Loss: 2.2205 | Val  Acc: 0.2698
 Site-MNIST_M                       | Val  Loss: 2.2754 | Val  Acc: 0.1848
 Site-MNIST_M                       | Val  Loss: 2.2724 | Val  Acc: 0.2266
 Site-SVHN                          | Val  Loss: 2.2059 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.2120 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3375
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.4022
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.4604
 Best site-USPS                      | Epoch:27 | Val Acc: 0.4891
 Best site-USPS                      | Epoch:27 | Val Acc: 0.4928
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.2935
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.2698
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.1848
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.2266
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 1.9737 | Train Acc: 0.5418
 Site-MNIST                         | Train Loss: 2.0218 | Train Acc: 0.4511
 Site-USPS                          | Train Loss: 1.8961 | Train Acc: 0.5364
 Site-USPS                          | Train Loss: 1.8918 | Train Acc: 0.5507
 Site-SynthDigits                   | Train Loss: 2.2206 | Train Acc: 0.2453
 Site-SynthDigits                   | Train Loss: 2.1923 | Train Acc: 0.3300
 Site-MNIST_M                       | Train Loss: 2.2660 | Train Acc: 0.2129
 Site-MNIST_M                       | Train Loss: 2.2587 | Train Acc: 0.2045
 Site-SVHN                          | Train Loss: 2.2222 | Train Acc: 0.2372
 Site-SVHN                          | Train Loss: 2.2306 | Train Acc: 0.2179
Average Train Accuracy: 0.3528
 Site-MNIST                         | Val  Loss: 2.0302 | Val  Acc: 0.4130
 Site-MNIST                         | Val  Loss: 2.0183 | Val  Acc: 0.4640
 Site-USPS                          | Val  Loss: 1.9154 | Val  Acc: 0.4783
 Site-USPS                          | Val  Loss: 1.9305 | Val  Acc: 0.4928
 Site-SynthDigits                   | Val  Loss: 2.1906 | Val  Acc: 0.2935
 Site-SynthDigits                   | Val  Loss: 2.2170 | Val  Acc: 0.2770
 Site-MNIST_M                       | Val  Loss: 2.2742 | Val  Acc: 0.1739
 Site-MNIST_M                       | Val  Loss: 2.2706 | Val  Acc: 0.2266
 Site-SVHN                          | Val  Loss: 2.2037 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.2100 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3375
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 1.9634 | Train Acc: 0.5499
 Site-MNIST                         | Train Loss: 2.0140 | Train Acc: 0.4601
 Site-USPS                          | Train Loss: 1.8847 | Train Acc: 0.5445
 Site-USPS                          | Train Loss: 1.8781 | Train Acc: 0.5578
 Site-SynthDigits                   | Train Loss: 2.2179 | Train Acc: 0.2534
 Site-SynthDigits                   | Train Loss: 2.1866 | Train Acc: 0.3345
 Site-MNIST_M                       | Train Loss: 2.2635 | Train Acc: 0.2156
 Site-MNIST_M                       | Train Loss: 2.2581 | Train Acc: 0.2143
 Site-SVHN                          | Train Loss: 2.2210 | Train Acc: 0.2426
 Site-SVHN                          | Train Loss: 2.2271 | Train Acc: 0.2215
Average Train Accuracy: 0.3594
 Site-MNIST                         | Val  Loss: 2.0216 | Val  Acc: 0.4348
 Site-MNIST                         | Val  Loss: 2.0096 | Val  Acc: 0.4676
 Site-USPS                          | Val  Loss: 1.9046 | Val  Acc: 0.4891
 Site-USPS                          | Val  Loss: 1.9197 | Val  Acc: 0.4964
 Site-SynthDigits                   | Val  Loss: 2.1868 | Val  Acc: 0.2935
 Site-SynthDigits                   | Val  Loss: 2.2137 | Val  Acc: 0.2806
 Site-MNIST_M                       | Val  Loss: 2.2729 | Val  Acc: 0.1739
 Site-MNIST_M                       | Val  Loss: 2.2690 | Val  Acc: 0.2266
 Site-SVHN                          | Val  Loss: 2.2014 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.2080 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3433
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.4348
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.4676
 Best site-USPS                      | Epoch:29 | Val Acc: 0.4891
 Best site-USPS                      | Epoch:29 | Val Acc: 0.4964
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.2935
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.2806
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.1739
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.2266
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.2770
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 1.9435 | Train Acc: 0.5472
 Site-MNIST                         | Train Loss: 1.9960 | Train Acc: 0.4574
 Site-USPS                          | Train Loss: 1.8608 | Train Acc: 0.5526
 Site-USPS                          | Train Loss: 1.8505 | Train Acc: 0.5561
 Site-SynthDigits                   | Train Loss: 2.2119 | Train Acc: 0.2453
 Site-SynthDigits                   | Train Loss: 2.1784 | Train Acc: 0.3309
 Site-MNIST_M                       | Train Loss: 2.2614 | Train Acc: 0.2183
 Site-MNIST_M                       | Train Loss: 2.2567 | Train Acc: 0.2143
 Site-SVHN                          | Train Loss: 2.2179 | Train Acc: 0.2426
 Site-SVHN                          | Train Loss: 2.2270 | Train Acc: 0.2233
Average Train Accuracy: 0.3588
 Site-MNIST                         | Val  Loss: 2.0058 | Val  Acc: 0.4239
 Site-MNIST                         | Val  Loss: 1.9931 | Val  Acc: 0.4640
 Site-USPS                          | Val  Loss: 1.8795 | Val  Acc: 0.4891
 Site-USPS                          | Val  Loss: 1.8948 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 2.1787 | Val  Acc: 0.2717
 Site-SynthDigits                   | Val  Loss: 2.2073 | Val  Acc: 0.2734
 Site-MNIST_M                       | Val  Loss: 2.2699 | Val  Acc: 0.1630
 Site-MNIST_M                       | Val  Loss: 2.2658 | Val  Acc: 0.2266
 Site-SVHN                          | Val  Loss: 2.1985 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.2057 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3382
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 1.9234 | Train Acc: 0.5526
 Site-MNIST                         | Train Loss: 1.9839 | Train Acc: 0.4610
 Site-USPS                          | Train Loss: 1.8285 | Train Acc: 0.5580
 Site-USPS                          | Train Loss: 1.8263 | Train Acc: 0.5686
 Site-SynthDigits                   | Train Loss: 2.2081 | Train Acc: 0.2480
 Site-SynthDigits                   | Train Loss: 2.1753 | Train Acc: 0.3336
 Site-MNIST_M                       | Train Loss: 2.2583 | Train Acc: 0.2291
 Site-MNIST_M                       | Train Loss: 2.2521 | Train Acc: 0.2170
 Site-SVHN                          | Train Loss: 2.2175 | Train Acc: 0.2399
 Site-SVHN                          | Train Loss: 2.2232 | Train Acc: 0.2224
Average Train Accuracy: 0.3630
 Site-MNIST                         | Val  Loss: 1.9898 | Val  Acc: 0.4130
 Site-MNIST                         | Val  Loss: 1.9767 | Val  Acc: 0.4712
 Site-USPS                          | Val  Loss: 1.8531 | Val  Acc: 0.4891
 Site-USPS                          | Val  Loss: 1.8684 | Val  Acc: 0.5036
 Site-SynthDigits                   | Val  Loss: 2.1721 | Val  Acc: 0.2717
 Site-SynthDigits                   | Val  Loss: 2.2014 | Val  Acc: 0.2734
 Site-MNIST_M                       | Val  Loss: 2.2672 | Val  Acc: 0.1630
 Site-MNIST_M                       | Val  Loss: 2.2627 | Val  Acc: 0.2194
 Site-SVHN                          | Val  Loss: 2.1952 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.2032 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3371
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 1.9035 | Train Acc: 0.5660
 Site-MNIST                         | Train Loss: 1.9587 | Train Acc: 0.4646
 Site-USPS                          | Train Loss: 1.7989 | Train Acc: 0.5714
 Site-USPS                          | Train Loss: 1.7889 | Train Acc: 0.5857
 Site-SynthDigits                   | Train Loss: 2.2015 | Train Acc: 0.2534
 Site-SynthDigits                   | Train Loss: 2.1659 | Train Acc: 0.3318
 Site-MNIST_M                       | Train Loss: 2.2542 | Train Acc: 0.2372
 Site-MNIST_M                       | Train Loss: 2.2505 | Train Acc: 0.2287
 Site-SVHN                          | Train Loss: 2.2131 | Train Acc: 0.2426
 Site-SVHN                          | Train Loss: 2.2222 | Train Acc: 0.2242
Average Train Accuracy: 0.3706
 Site-MNIST                         | Val  Loss: 1.9698 | Val  Acc: 0.4348
 Site-MNIST                         | Val  Loss: 1.9569 | Val  Acc: 0.4856
 Site-USPS                          | Val  Loss: 1.8210 | Val  Acc: 0.5217
 Site-USPS                          | Val  Loss: 1.8363 | Val  Acc: 0.5288
 Site-SynthDigits                   | Val  Loss: 2.1634 | Val  Acc: 0.2717
 Site-SynthDigits                   | Val  Loss: 2.1933 | Val  Acc: 0.2878
 Site-MNIST_M                       | Val  Loss: 2.2635 | Val  Acc: 0.1848
 Site-MNIST_M                       | Val  Loss: 2.2591 | Val  Acc: 0.2338
 Site-SVHN                          | Val  Loss: 2.1924 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.2011 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3509
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.4348
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.4856
 Best site-USPS                      | Epoch:32 | Val Acc: 0.5217
 Best site-USPS                      | Epoch:32 | Val Acc: 0.5288
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.2717
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.2878
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.1848
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.2338
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.2770
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 1.8755 | Train Acc: 0.5714
 Site-MNIST                         | Train Loss: 1.9400 | Train Acc: 0.4735
 Site-USPS                          | Train Loss: 1.7562 | Train Acc: 0.5822
 Site-USPS                          | Train Loss: 1.7504 | Train Acc: 0.6054
 Site-SynthDigits                   | Train Loss: 2.1951 | Train Acc: 0.2534
 Site-SynthDigits                   | Train Loss: 2.1558 | Train Acc: 0.3372
 Site-MNIST_M                       | Train Loss: 2.2501 | Train Acc: 0.2399
 Site-MNIST_M                       | Train Loss: 2.2462 | Train Acc: 0.2341
 Site-SVHN                          | Train Loss: 2.2123 | Train Acc: 0.2399
 Site-SVHN                          | Train Loss: 2.2208 | Train Acc: 0.2242
Average Train Accuracy: 0.3761
 Site-MNIST                         | Val  Loss: 1.9468 | Val  Acc: 0.4348
 Site-MNIST                         | Val  Loss: 1.9342 | Val  Acc: 0.4856
 Site-USPS                          | Val  Loss: 1.7836 | Val  Acc: 0.5435
 Site-USPS                          | Val  Loss: 1.7988 | Val  Acc: 0.5432
 Site-SynthDigits                   | Val  Loss: 2.1545 | Val  Acc: 0.2826
 Site-SynthDigits                   | Val  Loss: 2.1846 | Val  Acc: 0.2914
 Site-MNIST_M                       | Val  Loss: 2.2592 | Val  Acc: 0.1848
 Site-MNIST_M                       | Val  Loss: 2.2549 | Val  Acc: 0.2374
 Site-SVHN                          | Val  Loss: 2.1892 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1986 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3559
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.4348
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.4856
 Best site-USPS                      | Epoch:33 | Val Acc: 0.5435
 Best site-USPS                      | Epoch:33 | Val Acc: 0.5432
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.2826
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.2914
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.1848
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.2374
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 1.8525 | Train Acc: 0.5795
 Site-MNIST                         | Train Loss: 1.9177 | Train Acc: 0.4798
 Site-USPS                          | Train Loss: 1.7175 | Train Acc: 0.5876
 Site-USPS                          | Train Loss: 1.7151 | Train Acc: 0.6197
 Site-SynthDigits                   | Train Loss: 2.1885 | Train Acc: 0.2615
 Site-SynthDigits                   | Train Loss: 2.1480 | Train Acc: 0.3381
 Site-MNIST_M                       | Train Loss: 2.2467 | Train Acc: 0.2507
 Site-MNIST_M                       | Train Loss: 2.2394 | Train Acc: 0.2386
 Site-SVHN                          | Train Loss: 2.2101 | Train Acc: 0.2426
 Site-SVHN                          | Train Loss: 2.2187 | Train Acc: 0.2215
Average Train Accuracy: 0.3820
 Site-MNIST                         | Val  Loss: 1.9251 | Val  Acc: 0.4239
 Site-MNIST                         | Val  Loss: 1.9125 | Val  Acc: 0.4892
 Site-USPS                          | Val  Loss: 1.7488 | Val  Acc: 0.5652
 Site-USPS                          | Val  Loss: 1.7641 | Val  Acc: 0.5647
 Site-SynthDigits                   | Val  Loss: 2.1456 | Val  Acc: 0.2826
 Site-SynthDigits                   | Val  Loss: 2.1765 | Val  Acc: 0.2986
 Site-MNIST_M                       | Val  Loss: 2.2548 | Val  Acc: 0.2174
 Site-MNIST_M                       | Val  Loss: 2.2508 | Val  Acc: 0.2482
 Site-SVHN                          | Val  Loss: 2.1858 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1961 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3646
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.4239
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.4892
 Best site-USPS                      | Epoch:34 | Val Acc: 0.5652
 Best site-USPS                      | Epoch:34 | Val Acc: 0.5647
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.2826
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.2986
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.2174
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.2482
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 1.8307 | Train Acc: 0.5903
 Site-MNIST                         | Train Loss: 1.8947 | Train Acc: 0.4843
 Site-USPS                          | Train Loss: 1.6895 | Train Acc: 0.5984
 Site-USPS                          | Train Loss: 1.6858 | Train Acc: 0.6350
 Site-SynthDigits                   | Train Loss: 2.1820 | Train Acc: 0.2695
 Site-SynthDigits                   | Train Loss: 2.1422 | Train Acc: 0.3381
 Site-MNIST_M                       | Train Loss: 2.2431 | Train Acc: 0.2561
 Site-MNIST_M                       | Train Loss: 2.2389 | Train Acc: 0.2404
 Site-SVHN                          | Train Loss: 2.2093 | Train Acc: 0.2480
 Site-SVHN                          | Train Loss: 2.2143 | Train Acc: 0.2269
Average Train Accuracy: 0.3887
 Site-MNIST                         | Val  Loss: 1.9055 | Val  Acc: 0.4348
 Site-MNIST                         | Val  Loss: 1.8929 | Val  Acc: 0.4964
 Site-USPS                          | Val  Loss: 1.7197 | Val  Acc: 0.5978
 Site-USPS                          | Val  Loss: 1.7347 | Val  Acc: 0.5899
 Site-SynthDigits                   | Val  Loss: 2.1386 | Val  Acc: 0.2935
 Site-SynthDigits                   | Val  Loss: 2.1694 | Val  Acc: 0.3058
 Site-MNIST_M                       | Val  Loss: 2.2512 | Val  Acc: 0.2065
 Site-MNIST_M                       | Val  Loss: 2.2472 | Val  Acc: 0.2410
 Site-SVHN                          | Val  Loss: 2.1825 | Val  Acc: 0.2717
 Site-SVHN                          | Val  Loss: 2.1936 | Val  Acc: 0.2806
Average Valid Accuracy: 0.3718
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.4348
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.4964
 Best site-USPS                      | Epoch:35 | Val Acc: 0.5978
 Best site-USPS                      | Epoch:35 | Val Acc: 0.5899
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.2935
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.3058
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.2065
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.2410
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.2717
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.2806
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 1.8115 | Train Acc: 0.5903
 Site-MNIST                         | Train Loss: 1.8823 | Train Acc: 0.4942
 Site-USPS                          | Train Loss: 1.6546 | Train Acc: 0.6092
 Site-USPS                          | Train Loss: 1.6533 | Train Acc: 0.6457
 Site-SynthDigits                   | Train Loss: 2.1768 | Train Acc: 0.2722
 Site-SynthDigits                   | Train Loss: 2.1363 | Train Acc: 0.3390
 Site-MNIST_M                       | Train Loss: 2.2404 | Train Acc: 0.2588
 Site-MNIST_M                       | Train Loss: 2.2341 | Train Acc: 0.2413
 Site-SVHN                          | Train Loss: 2.2057 | Train Acc: 0.2480
 Site-SVHN                          | Train Loss: 2.2137 | Train Acc: 0.2278
Average Train Accuracy: 0.3926
 Site-MNIST                         | Val  Loss: 1.8862 | Val  Acc: 0.4783
 Site-MNIST                         | Val  Loss: 1.8735 | Val  Acc: 0.5108
 Site-USPS                          | Val  Loss: 1.6913 | Val  Acc: 0.6196
 Site-USPS                          | Val  Loss: 1.7063 | Val  Acc: 0.6043
 Site-SynthDigits                   | Val  Loss: 2.1319 | Val  Acc: 0.3043
 Site-SynthDigits                   | Val  Loss: 2.1623 | Val  Acc: 0.3094
 Site-MNIST_M                       | Val  Loss: 2.2475 | Val  Acc: 0.2174
 Site-MNIST_M                       | Val  Loss: 2.2438 | Val  Acc: 0.2518
 Site-SVHN                          | Val  Loss: 2.1799 | Val  Acc: 0.2717
 Site-SVHN                          | Val  Loss: 2.1915 | Val  Acc: 0.2806
Average Valid Accuracy: 0.3848
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.4783
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.5108
 Best site-USPS                      | Epoch:36 | Val Acc: 0.6196
 Best site-USPS                      | Epoch:36 | Val Acc: 0.6043
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.3043
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.3094
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.2174
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.2518
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.2717
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.2806
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 1.7845 | Train Acc: 0.5957
 Site-MNIST                         | Train Loss: 1.8564 | Train Acc: 0.5121
 Site-USPS                          | Train Loss: 1.6287 | Train Acc: 0.6226
 Site-USPS                          | Train Loss: 1.6196 | Train Acc: 0.6628
 Site-SynthDigits                   | Train Loss: 2.1711 | Train Acc: 0.2749
 Site-SynthDigits                   | Train Loss: 2.1269 | Train Acc: 0.3408
 Site-MNIST_M                       | Train Loss: 2.2371 | Train Acc: 0.2615
 Site-MNIST_M                       | Train Loss: 2.2306 | Train Acc: 0.2359
 Site-SVHN                          | Train Loss: 2.2028 | Train Acc: 0.2453
 Site-SVHN                          | Train Loss: 2.2112 | Train Acc: 0.2296
Average Train Accuracy: 0.3981
 Site-MNIST                         | Val  Loss: 1.8650 | Val  Acc: 0.4674
 Site-MNIST                         | Val  Loss: 1.8512 | Val  Acc: 0.5180
 Site-USPS                          | Val  Loss: 1.6616 | Val  Acc: 0.6304
 Site-USPS                          | Val  Loss: 1.6758 | Val  Acc: 0.6187
 Site-SynthDigits                   | Val  Loss: 2.1266 | Val  Acc: 0.3043
 Site-SynthDigits                   | Val  Loss: 2.1558 | Val  Acc: 0.3058
 Site-MNIST_M                       | Val  Loss: 2.2442 | Val  Acc: 0.1957
 Site-MNIST_M                       | Val  Loss: 2.2410 | Val  Acc: 0.2446
 Site-SVHN                          | Val  Loss: 2.1763 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1891 | Val  Acc: 0.2806
Average Valid Accuracy: 0.3848
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 1.7503 | Train Acc: 0.6119
 Site-MNIST                         | Train Loss: 1.8247 | Train Acc: 0.5265
 Site-USPS                          | Train Loss: 1.5980 | Train Acc: 0.6388
 Site-USPS                          | Train Loss: 1.5881 | Train Acc: 0.6789
 Site-SynthDigits                   | Train Loss: 2.1631 | Train Acc: 0.2830
 Site-SynthDigits                   | Train Loss: 2.1182 | Train Acc: 0.3462
 Site-MNIST_M                       | Train Loss: 2.2326 | Train Acc: 0.2534
 Site-MNIST_M                       | Train Loss: 2.2269 | Train Acc: 0.2413
 Site-SVHN                          | Train Loss: 2.2030 | Train Acc: 0.2453
 Site-SVHN                          | Train Loss: 2.2086 | Train Acc: 0.2314
Average Train Accuracy: 0.4057
 Site-MNIST                         | Val  Loss: 1.8354 | Val  Acc: 0.5000
 Site-MNIST                         | Val  Loss: 1.8207 | Val  Acc: 0.5468
 Site-USPS                          | Val  Loss: 1.6311 | Val  Acc: 0.6304
 Site-USPS                          | Val  Loss: 1.6451 | Val  Acc: 0.6367
 Site-SynthDigits                   | Val  Loss: 2.1192 | Val  Acc: 0.3043
 Site-SynthDigits                   | Val  Loss: 2.1477 | Val  Acc: 0.3094
 Site-MNIST_M                       | Val  Loss: 2.2395 | Val  Acc: 0.1957
 Site-MNIST_M                       | Val  Loss: 2.2365 | Val  Acc: 0.2446
 Site-SVHN                          | Val  Loss: 2.1737 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1870 | Val  Acc: 0.2842
Average Valid Accuracy: 0.3935
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.5000
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.5468
 Best site-USPS                      | Epoch:38 | Val Acc: 0.6304
 Best site-USPS                      | Epoch:38 | Val Acc: 0.6367
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.3043
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.3094
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.1957
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.2446
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.2842
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 1.7153 | Train Acc: 0.6442
 Site-MNIST                         | Train Loss: 1.7917 | Train Acc: 0.5596
 Site-USPS                          | Train Loss: 1.5578 | Train Acc: 0.6550
 Site-USPS                          | Train Loss: 1.5539 | Train Acc: 0.6951
 Site-SynthDigits                   | Train Loss: 2.1586 | Train Acc: 0.2749
 Site-SynthDigits                   | Train Loss: 2.1109 | Train Acc: 0.3471
 Site-MNIST_M                       | Train Loss: 2.2290 | Train Acc: 0.2534
 Site-MNIST_M                       | Train Loss: 2.2199 | Train Acc: 0.2466
 Site-SVHN                          | Train Loss: 2.2009 | Train Acc: 0.2426
 Site-SVHN                          | Train Loss: 2.2054 | Train Acc: 0.2323
Average Train Accuracy: 0.4151
 Site-MNIST                         | Val  Loss: 1.8040 | Val  Acc: 0.5109
 Site-MNIST                         | Val  Loss: 1.7876 | Val  Acc: 0.5719
 Site-USPS                          | Val  Loss: 1.5982 | Val  Acc: 0.6304
 Site-USPS                          | Val  Loss: 1.6120 | Val  Acc: 0.6439
 Site-SynthDigits                   | Val  Loss: 2.1134 | Val  Acc: 0.2935
 Site-SynthDigits                   | Val  Loss: 2.1404 | Val  Acc: 0.3022
 Site-MNIST_M                       | Val  Loss: 2.2351 | Val  Acc: 0.2174
 Site-MNIST_M                       | Val  Loss: 2.2321 | Val  Acc: 0.2554
 Site-SVHN                          | Val  Loss: 2.1706 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1847 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3985
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.5109
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.5719
 Best site-USPS                      | Epoch:39 | Val Acc: 0.6304
 Best site-USPS                      | Epoch:39 | Val Acc: 0.6439
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.2935
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.3022
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.2174
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.2554
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.2770
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 1.6811 | Train Acc: 0.6846
 Site-MNIST                         | Train Loss: 1.7557 | Train Acc: 0.5892
 Site-USPS                          | Train Loss: 1.5304 | Train Acc: 0.6739
 Site-USPS                          | Train Loss: 1.5181 | Train Acc: 0.7175
 Site-SynthDigits                   | Train Loss: 2.1477 | Train Acc: 0.2884
 Site-SynthDigits                   | Train Loss: 2.1032 | Train Acc: 0.3471
 Site-MNIST_M                       | Train Loss: 2.2244 | Train Acc: 0.2480
 Site-MNIST_M                       | Train Loss: 2.2153 | Train Acc: 0.2520
 Site-SVHN                          | Train Loss: 2.1969 | Train Acc: 0.2399
 Site-SVHN                          | Train Loss: 2.2033 | Train Acc: 0.2323
Average Train Accuracy: 0.4273
 Site-MNIST                         | Val  Loss: 1.7703 | Val  Acc: 0.5326
 Site-MNIST                         | Val  Loss: 1.7532 | Val  Acc: 0.6079
 Site-USPS                          | Val  Loss: 1.5673 | Val  Acc: 0.6413
 Site-USPS                          | Val  Loss: 1.5798 | Val  Acc: 0.6583
 Site-SynthDigits                   | Val  Loss: 2.1072 | Val  Acc: 0.3152
 Site-SynthDigits                   | Val  Loss: 2.1310 | Val  Acc: 0.3094
 Site-MNIST_M                       | Val  Loss: 2.2305 | Val  Acc: 0.2174
 Site-MNIST_M                       | Val  Loss: 2.2271 | Val  Acc: 0.2554
 Site-SVHN                          | Val  Loss: 2.1688 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1831 | Val  Acc: 0.2734
Average Valid Accuracy: 0.4093
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.5326
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.6079
 Best site-USPS                      | Epoch:40 | Val Acc: 0.6413
 Best site-USPS                      | Epoch:40 | Val Acc: 0.6583
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.3152
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.3094
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.2174
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.2554
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 1.6484 | Train Acc: 0.7008
 Site-MNIST                         | Train Loss: 1.7248 | Train Acc: 0.6126
 Site-USPS                          | Train Loss: 1.4976 | Train Acc: 0.7062
 Site-USPS                          | Train Loss: 1.4893 | Train Acc: 0.7390
 Site-SynthDigits                   | Train Loss: 2.1398 | Train Acc: 0.2965
 Site-SynthDigits                   | Train Loss: 2.0922 | Train Acc: 0.3543
 Site-MNIST_M                       | Train Loss: 2.2208 | Train Acc: 0.2480
 Site-MNIST_M                       | Train Loss: 2.2128 | Train Acc: 0.2538
 Site-SVHN                          | Train Loss: 2.1967 | Train Acc: 0.2399
 Site-SVHN                          | Train Loss: 2.2001 | Train Acc: 0.2350
Average Train Accuracy: 0.4386
 Site-MNIST                         | Val  Loss: 1.7377 | Val  Acc: 0.5543
 Site-MNIST                         | Val  Loss: 1.7205 | Val  Acc: 0.6259
 Site-USPS                          | Val  Loss: 1.5361 | Val  Acc: 0.6739
 Site-USPS                          | Val  Loss: 1.5479 | Val  Acc: 0.6835
 Site-SynthDigits                   | Val  Loss: 2.1038 | Val  Acc: 0.3261
 Site-SynthDigits                   | Val  Loss: 2.1248 | Val  Acc: 0.3273
 Site-MNIST_M                       | Val  Loss: 2.2252 | Val  Acc: 0.2283
 Site-MNIST_M                       | Val  Loss: 2.2230 | Val  Acc: 0.2554
 Site-SVHN                          | Val  Loss: 2.1648 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1801 | Val  Acc: 0.2842
Average Valid Accuracy: 0.4252
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.5543
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.6259
 Best site-USPS                      | Epoch:41 | Val Acc: 0.6739
 Best site-USPS                      | Epoch:41 | Val Acc: 0.6835
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.3261
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.3273
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.2283
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.2554
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.2842
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 1.6147 | Train Acc: 0.7224
 Site-MNIST                         | Train Loss: 1.6949 | Train Acc: 0.6314
 Site-USPS                          | Train Loss: 1.4719 | Train Acc: 0.7170
 Site-USPS                          | Train Loss: 1.4634 | Train Acc: 0.7489
 Site-SynthDigits                   | Train Loss: 2.1311 | Train Acc: 0.2884
 Site-SynthDigits                   | Train Loss: 2.0867 | Train Acc: 0.3534
 Site-MNIST_M                       | Train Loss: 2.2154 | Train Acc: 0.2534
 Site-MNIST_M                       | Train Loss: 2.2062 | Train Acc: 0.2529
 Site-SVHN                          | Train Loss: 2.1961 | Train Acc: 0.2399
 Site-SVHN                          | Train Loss: 2.1969 | Train Acc: 0.2359
Average Train Accuracy: 0.4443
 Site-MNIST                         | Val  Loss: 1.7087 | Val  Acc: 0.5978
 Site-MNIST                         | Val  Loss: 1.6910 | Val  Acc: 0.6511
 Site-USPS                          | Val  Loss: 1.5132 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.5236 | Val  Acc: 0.6978
 Site-SynthDigits                   | Val  Loss: 2.0983 | Val  Acc: 0.3261
 Site-SynthDigits                   | Val  Loss: 2.1173 | Val  Acc: 0.3165
 Site-MNIST_M                       | Val  Loss: 2.2207 | Val  Acc: 0.2174
 Site-MNIST_M                       | Val  Loss: 2.2185 | Val  Acc: 0.2518
 Site-SVHN                          | Val  Loss: 2.1627 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1784 | Val  Acc: 0.2842
Average Valid Accuracy: 0.4321
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.5978
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.6511
 Best site-USPS                      | Epoch:42 | Val Acc: 0.6957
 Best site-USPS                      | Epoch:42 | Val Acc: 0.6978
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.3261
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.3165
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.2174
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.2518
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.2842
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 1.5903 | Train Acc: 0.7385
 Site-MNIST                         | Train Loss: 1.6741 | Train Acc: 0.6395
 Site-USPS                          | Train Loss: 1.4495 | Train Acc: 0.7224
 Site-USPS                          | Train Loss: 1.4329 | Train Acc: 0.7570
 Site-SynthDigits                   | Train Loss: 2.1281 | Train Acc: 0.2938
 Site-SynthDigits                   | Train Loss: 2.0776 | Train Acc: 0.3587
 Site-MNIST_M                       | Train Loss: 2.2114 | Train Acc: 0.2534
 Site-MNIST_M                       | Train Loss: 2.2029 | Train Acc: 0.2556
 Site-SVHN                          | Train Loss: 2.1943 | Train Acc: 0.2426
 Site-SVHN                          | Train Loss: 2.1992 | Train Acc: 0.2359
Average Train Accuracy: 0.4497
 Site-MNIST                         | Val  Loss: 1.6840 | Val  Acc: 0.6196
 Site-MNIST                         | Val  Loss: 1.6662 | Val  Acc: 0.6619
 Site-USPS                          | Val  Loss: 1.4886 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.4990 | Val  Acc: 0.7050
 Site-SynthDigits                   | Val  Loss: 2.0925 | Val  Acc: 0.3587
 Site-SynthDigits                   | Val  Loss: 2.1101 | Val  Acc: 0.3237
 Site-MNIST_M                       | Val  Loss: 2.2182 | Val  Acc: 0.2174
 Site-MNIST_M                       | Val  Loss: 2.2149 | Val  Acc: 0.2518
 Site-SVHN                          | Val  Loss: 2.1619 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1775 | Val  Acc: 0.2878
Average Valid Accuracy: 0.4404
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.6196
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.6619
 Best site-USPS                      | Epoch:43 | Val Acc: 0.6957
 Best site-USPS                      | Epoch:43 | Val Acc: 0.7050
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.3587
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.3237
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.2174
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.2518
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.2878
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 1.5656 | Train Acc: 0.7439
 Site-MNIST                         | Train Loss: 1.6447 | Train Acc: 0.6502
 Site-USPS                          | Train Loss: 1.4250 | Train Acc: 0.7251
 Site-USPS                          | Train Loss: 1.4156 | Train Acc: 0.7632
 Site-SynthDigits                   | Train Loss: 2.1224 | Train Acc: 0.2911
 Site-SynthDigits                   | Train Loss: 2.0726 | Train Acc: 0.3578
 Site-MNIST_M                       | Train Loss: 2.2082 | Train Acc: 0.2534
 Site-MNIST_M                       | Train Loss: 2.1966 | Train Acc: 0.2565
 Site-SVHN                          | Train Loss: 2.1925 | Train Acc: 0.2453
 Site-SVHN                          | Train Loss: 2.1972 | Train Acc: 0.2386
Average Train Accuracy: 0.4525
 Site-MNIST                         | Val  Loss: 1.6610 | Val  Acc: 0.6304
 Site-MNIST                         | Val  Loss: 1.6424 | Val  Acc: 0.6655
 Site-USPS                          | Val  Loss: 1.4659 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.4760 | Val  Acc: 0.7086
 Site-SynthDigits                   | Val  Loss: 2.0870 | Val  Acc: 0.3587
 Site-SynthDigits                   | Val  Loss: 2.1042 | Val  Acc: 0.3237
 Site-MNIST_M                       | Val  Loss: 2.2149 | Val  Acc: 0.2174
 Site-MNIST_M                       | Val  Loss: 2.2113 | Val  Acc: 0.2554
 Site-SVHN                          | Val  Loss: 2.1590 | Val  Acc: 0.2826
 Site-SVHN                          | Val  Loss: 2.1752 | Val  Acc: 0.2878
Average Valid Accuracy: 0.4426
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.6304
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.6655
 Best site-USPS                      | Epoch:44 | Val Acc: 0.6957
 Best site-USPS                      | Epoch:44 | Val Acc: 0.7086
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.3587
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.3237
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.2174
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.2554
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.2826
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.2878
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 1.5420 | Train Acc: 0.7439
 Site-MNIST                         | Train Loss: 1.6239 | Train Acc: 0.6628
 Site-USPS                          | Train Loss: 1.4015 | Train Acc: 0.7332
 Site-USPS                          | Train Loss: 1.3917 | Train Acc: 0.7659
 Site-SynthDigits                   | Train Loss: 2.1151 | Train Acc: 0.2776
 Site-SynthDigits                   | Train Loss: 2.0652 | Train Acc: 0.3570
 Site-MNIST_M                       | Train Loss: 2.2061 | Train Acc: 0.2507
 Site-MNIST_M                       | Train Loss: 2.1963 | Train Acc: 0.2574
 Site-SVHN                          | Train Loss: 2.1915 | Train Acc: 0.2453
 Site-SVHN                          | Train Loss: 2.1940 | Train Acc: 0.2395
Average Train Accuracy: 0.4533
 Site-MNIST                         | Val  Loss: 1.6398 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.6208 | Val  Acc: 0.6727
 Site-USPS                          | Val  Loss: 1.4454 | Val  Acc: 0.6957
 Site-USPS                          | Val  Loss: 1.4549 | Val  Acc: 0.7086
 Site-SynthDigits                   | Val  Loss: 2.0815 | Val  Acc: 0.3478
 Site-SynthDigits                   | Val  Loss: 2.0979 | Val  Acc: 0.3129
 Site-MNIST_M                       | Val  Loss: 2.2116 | Val  Acc: 0.2174
 Site-MNIST_M                       | Val  Loss: 2.2075 | Val  Acc: 0.2590
 Site-SVHN                          | Val  Loss: 2.1565 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1732 | Val  Acc: 0.2950
Average Valid Accuracy: 0.4444
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.6727
 Best site-USPS                      | Epoch:45 | Val Acc: 0.6957
 Best site-USPS                      | Epoch:45 | Val Acc: 0.7086
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.3478
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.3129
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.2174
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.2590
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.2950
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 1.5243 | Train Acc: 0.7439
 Site-MNIST                         | Train Loss: 1.6068 | Train Acc: 0.6726
 Site-USPS                          | Train Loss: 1.3833 | Train Acc: 0.7385
 Site-USPS                          | Train Loss: 1.3757 | Train Acc: 0.7695
 Site-SynthDigits                   | Train Loss: 2.1122 | Train Acc: 0.2749
 Site-SynthDigits                   | Train Loss: 2.0583 | Train Acc: 0.3543
 Site-MNIST_M                       | Train Loss: 2.2011 | Train Acc: 0.2534
 Site-MNIST_M                       | Train Loss: 2.1924 | Train Acc: 0.2601
 Site-SVHN                          | Train Loss: 2.1895 | Train Acc: 0.2453
 Site-SVHN                          | Train Loss: 2.1903 | Train Acc: 0.2395
Average Train Accuracy: 0.4552
 Site-MNIST                         | Val  Loss: 1.6202 | Val  Acc: 0.6522
 Site-MNIST                         | Val  Loss: 1.6017 | Val  Acc: 0.6763
 Site-USPS                          | Val  Loss: 1.4249 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.4343 | Val  Acc: 0.7158
 Site-SynthDigits                   | Val  Loss: 2.0754 | Val  Acc: 0.3587
 Site-SynthDigits                   | Val  Loss: 2.0918 | Val  Acc: 0.3129
 Site-MNIST_M                       | Val  Loss: 2.2084 | Val  Acc: 0.2283
 Site-MNIST_M                       | Val  Loss: 2.2039 | Val  Acc: 0.2590
 Site-SVHN                          | Val  Loss: 2.1544 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1715 | Val  Acc: 0.2950
Average Valid Accuracy: 0.4498
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.6522
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.6763
 Best site-USPS                      | Epoch:46 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:46 | Val Acc: 0.7158
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.3587
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.3129
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.2283
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.2590
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.2950
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 1.5047 | Train Acc: 0.7574
 Site-MNIST                         | Train Loss: 1.5827 | Train Acc: 0.6861
 Site-USPS                          | Train Loss: 1.3597 | Train Acc: 0.7385
 Site-USPS                          | Train Loss: 1.3548 | Train Acc: 0.7776
 Site-SynthDigits                   | Train Loss: 2.1077 | Train Acc: 0.2776
 Site-SynthDigits                   | Train Loss: 2.0541 | Train Acc: 0.3578
 Site-MNIST_M                       | Train Loss: 2.1989 | Train Acc: 0.2507
 Site-MNIST_M                       | Train Loss: 2.1894 | Train Acc: 0.2637
 Site-SVHN                          | Train Loss: 2.1883 | Train Acc: 0.2453
 Site-SVHN                          | Train Loss: 2.1922 | Train Acc: 0.2395
Average Train Accuracy: 0.4594
 Site-MNIST                         | Val  Loss: 1.6015 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.5826 | Val  Acc: 0.6978
 Site-USPS                          | Val  Loss: 1.4070 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.4154 | Val  Acc: 0.7230
 Site-SynthDigits                   | Val  Loss: 2.0710 | Val  Acc: 0.3587
 Site-SynthDigits                   | Val  Loss: 2.0869 | Val  Acc: 0.3129
 Site-MNIST_M                       | Val  Loss: 2.2057 | Val  Acc: 0.2283
 Site-MNIST_M                       | Val  Loss: 2.2011 | Val  Acc: 0.2626
 Site-SVHN                          | Val  Loss: 2.1516 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1695 | Val  Acc: 0.2914
Average Valid Accuracy: 0.4549
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.6630
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.6978
 Best site-USPS                      | Epoch:47 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:47 | Val Acc: 0.7230
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.3587
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.3129
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.2283
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.2626
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.2914
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 1.4838 | Train Acc: 0.7601
 Site-MNIST                         | Train Loss: 1.5691 | Train Acc: 0.6915
 Site-USPS                          | Train Loss: 1.3460 | Train Acc: 0.7439
 Site-USPS                          | Train Loss: 1.3371 | Train Acc: 0.7821
 Site-SynthDigits                   | Train Loss: 2.1034 | Train Acc: 0.2803
 Site-SynthDigits                   | Train Loss: 2.0489 | Train Acc: 0.3552
 Site-MNIST_M                       | Train Loss: 2.1975 | Train Acc: 0.2534
 Site-MNIST_M                       | Train Loss: 2.1843 | Train Acc: 0.2628
 Site-SVHN                          | Train Loss: 2.1861 | Train Acc: 0.2453
 Site-SVHN                          | Train Loss: 2.1844 | Train Acc: 0.2422
Average Train Accuracy: 0.4617
 Site-MNIST                         | Val  Loss: 1.5833 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.5642 | Val  Acc: 0.7086
 Site-USPS                          | Val  Loss: 1.3912 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.3987 | Val  Acc: 0.7230
 Site-SynthDigits                   | Val  Loss: 2.0663 | Val  Acc: 0.3587
 Site-SynthDigits                   | Val  Loss: 2.0822 | Val  Acc: 0.3094
 Site-MNIST_M                       | Val  Loss: 2.2030 | Val  Acc: 0.2283
 Site-MNIST_M                       | Val  Loss: 2.1985 | Val  Acc: 0.2662
 Site-SVHN                          | Val  Loss: 2.1490 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1677 | Val  Acc: 0.2950
Average Valid Accuracy: 0.4585
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.6739
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.7086
 Best site-USPS                      | Epoch:48 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:48 | Val Acc: 0.7230
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.3587
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.3094
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.2283
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.2662
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.2950
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 1.4691 | Train Acc: 0.7709
 Site-MNIST                         | Train Loss: 1.5502 | Train Acc: 0.6978
 Site-USPS                          | Train Loss: 1.3314 | Train Acc: 0.7412
 Site-USPS                          | Train Loss: 1.3206 | Train Acc: 0.7865
 Site-SynthDigits                   | Train Loss: 2.0972 | Train Acc: 0.2830
 Site-SynthDigits                   | Train Loss: 2.0437 | Train Acc: 0.3516
 Site-MNIST_M                       | Train Loss: 2.1912 | Train Acc: 0.2534
 Site-MNIST_M                       | Train Loss: 2.1815 | Train Acc: 0.2691
 Site-SVHN                          | Train Loss: 2.1864 | Train Acc: 0.2453
 Site-SVHN                          | Train Loss: 2.1842 | Train Acc: 0.2404
Average Train Accuracy: 0.4639
 Site-MNIST                         | Val  Loss: 1.5659 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.5466 | Val  Acc: 0.7122
 Site-USPS                          | Val  Loss: 1.3764 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 1.3834 | Val  Acc: 0.7302
 Site-SynthDigits                   | Val  Loss: 2.0603 | Val  Acc: 0.3478
 Site-SynthDigits                   | Val  Loss: 2.0759 | Val  Acc: 0.3094
 Site-MNIST_M                       | Val  Loss: 2.2001 | Val  Acc: 0.2391
 Site-MNIST_M                       | Val  Loss: 2.1954 | Val  Acc: 0.2770
 Site-SVHN                          | Val  Loss: 2.1472 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1661 | Val  Acc: 0.2950
Average Valid Accuracy: 0.4617
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.6739
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.7122
 Best site-USPS                      | Epoch:49 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:49 | Val Acc: 0.7302
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.3478
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.3094
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.2391
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.2770
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.2950
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.6944
 Test site-USPS                      | Epoch:49 | Test Acc: 0.7774
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.3176
 Test site-MNIST_M                   | Epoch:49 | Test Acc: 0.2427
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.2221
MNIST: 0.6944, USPS: 0.7774, SynthDigits: 0.3176, MNIST_M: 0.2427, SVHN: 0.2221, 
Average Test Accuracy(group): 0.4509, Average Test Accuracy(individual): 0.4509,
domain std=0.2364, cluster std=-1.0000, individual std=0.2364, 
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/propfair...
===2023-06-27 17:49:15===
===2023-06-27 17:49:23===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.6944
 Test site-USPS                      | Epoch:49 | Test Acc: 0.7774
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.3176
 Test site-MNIST_M                   | Epoch:49 | Test Acc: 0.2427
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.2221
MNIST: 0.6944, USPS: 0.7774, SynthDigits: 0.3176, MNIST_M: 0.2427, SVHN: 0.2221, 
Average Test Accuracy(group): 0.4509, Average Test Accuracy(individual): 0.4509,
domain std=0.2364, cluster std=-1.0000, individual std=0.2364, 
===2023-06-28 21:08:54===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
