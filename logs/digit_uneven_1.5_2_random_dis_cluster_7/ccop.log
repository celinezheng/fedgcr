===2023-08-12 03:07:24===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 0
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
===2023-08-12 03:07:30===
===2023-08-12 12:38:11===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 2, 2, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (6) | Train Loss: 1.6654 | Train Acc: 0.6311
 Site-MNIST                     (1) | Train Loss: 1.6654 | Train Acc: 0.6450
 Site-MNIST                     (6) | Train Loss: 1.7172 | Train Acc: 0.5976
 Site-MNIST                     (1) | Train Loss: 1.6776 | Train Acc: 0.6216
 Site-MNIST                     (5) | Train Loss: 1.6666 | Train Acc: 0.6243
 Site-USPS                      (3) | Train Loss: 1.6710 | Train Acc: 0.5947
 Site-USPS                      (3) | Train Loss: 1.7016 | Train Acc: 0.5703
 Site-USPS                      (3) | Train Loss: 1.6766 | Train Acc: 0.5985
 Site-SynthDigits               (0) | Train Loss: 2.0965 | Train Acc: 0.2765
 Site-SynthDigits               (0) | Train Loss: 2.0862 | Train Acc: 0.2980
 Site-MNIST_M                   (2) | Train Loss: 2.2303 | Train Acc: 0.2273
 Site-MNIST_M                   (2) | Train Loss: 2.1984 | Train Acc: 0.2027
 Site-SVHN                      (4) | Train Loss: 2.1942 | Train Acc: 0.2232
Average Train Accuracy: 0.4701
 Site-MNIST                     (6) | Val  Loss: 1.7488 | Val  Acc: 0.5536
 Site-MNIST                     (1) | Val  Loss: 1.7469 | Val  Acc: 0.5952
 Site-MNIST                     (6) | Val  Loss: 1.6391 | Val  Acc: 0.6825
 Site-MNIST                     (1) | Val  Loss: 1.7045 | Val  Acc: 0.5947
 Site-MNIST                     (5) | Val  Loss: 1.6833 | Val  Acc: 0.6175
 Site-USPS                      (3) | Val  Loss: 1.7167 | Val  Acc: 0.5288
 Site-USPS                      (3) | Val  Loss: 1.7547 | Val  Acc: 0.5256
 Site-USPS                      (3) | Val  Loss: 1.6755 | Val  Acc: 0.5855
 Site-SynthDigits               (0) | Val  Loss: 2.2082 | Val  Acc: 0.2879
 Site-SynthDigits               (0) | Val  Loss: 2.0683 | Val  Acc: 0.2323
 Site-MNIST_M                   (2) | Val  Loss: 2.1396 | Val  Acc: 0.3182
 Site-MNIST_M                   (2) | Val  Loss: 2.2256 | Val  Acc: 0.2348
 Site-SVHN                      (4) | Val  Loss: 2.2206 | Val  Acc: 0.2603
Average Valid Accuracy: 0.4629
 Best site-MNIST                    (6)  | Epoch:0 | Val Acc: 0.5536
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.5952
 Best site-MNIST                    (6)  | Epoch:0 | Val Acc: 0.6825
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.5947
 Best site-MNIST                    (5)  | Epoch:0 | Val Acc: 0.6175
 Best site-USPS                     (3)  | Epoch:0 | Val Acc: 0.5288
 Best site-USPS                     (3)  | Epoch:0 | Val Acc: 0.5256
 Best site-USPS                     (3)  | Epoch:0 | Val Acc: 0.5855
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.2879
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.2323
 Best site-MNIST_M                  (2)  | Epoch:0 | Val Acc: 0.3182
 Best site-MNIST_M                  (2)  | Epoch:0 | Val Acc: 0.2348
 Best site-SVHN                     (4)  | Epoch:0 | Val Acc: 0.2603
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 1, 2, 3, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (5) | Train Loss: 1.2436 | Train Acc: 0.7689
 Site-MNIST                     (5) | Train Loss: 1.1972 | Train Acc: 0.7811
 Site-MNIST                     (5) | Train Loss: 1.2956 | Train Acc: 0.7278
 Site-MNIST                     (0) | Train Loss: 1.2367 | Train Acc: 0.7714
 Site-MNIST                     (5) | Train Loss: 1.2353 | Train Acc: 0.7662
 Site-USPS                      (3) | Train Loss: 1.1792 | Train Acc: 0.7530
 Site-USPS                      (3) | Train Loss: 1.1885 | Train Acc: 0.7460
 Site-USPS                      (3) | Train Loss: 1.1568 | Train Acc: 0.7774
 Site-SynthDigits               (2) | Train Loss: 1.8671 | Train Acc: 0.3504
 Site-SynthDigits               (2) | Train Loss: 1.8364 | Train Acc: 0.3624
 Site-MNIST_M                   (1) | Train Loss: 2.0432 | Train Acc: 0.2812
 Site-MNIST_M                   (6) | Train Loss: 2.0295 | Train Acc: 0.3106
 Site-SVHN                      (4) | Train Loss: 2.0853 | Train Acc: 0.2555
Average Train Accuracy: 0.5886
 Site-MNIST                     (5) | Val  Loss: 1.3038 | Val  Acc: 0.8036
 Site-MNIST                     (5) | Val  Loss: 1.2978 | Val  Acc: 0.8214
 Site-MNIST                     (5) | Val  Loss: 1.2090 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 1.2846 | Val  Acc: 0.7211
 Site-MNIST                     (5) | Val  Loss: 1.2661 | Val  Acc: 0.7544
 Site-USPS                      (3) | Val  Loss: 1.1542 | Val  Acc: 0.7596
 Site-USPS                      (3) | Val  Loss: 1.2302 | Val  Acc: 0.7179
 Site-USPS                      (3) | Val  Loss: 1.1739 | Val  Acc: 0.7436
 Site-SynthDigits               (2) | Val  Loss: 2.0280 | Val  Acc: 0.3864
 Site-SynthDigits               (2) | Val  Loss: 1.7918 | Val  Acc: 0.3434
 Site-MNIST_M                   (1) | Val  Loss: 1.9480 | Val  Acc: 0.3636
 Site-MNIST_M                   (6) | Val  Loss: 2.0884 | Val  Acc: 0.3333
 Site-SVHN                      (4) | Val  Loss: 2.0993 | Val  Acc: 0.3014
Average Valid Accuracy: 0.6021
 Best site-MNIST                    (5)  | Epoch:1 | Val Acc: 0.8036
 Best site-MNIST                    (5)  | Epoch:1 | Val Acc: 0.8214
 Best site-MNIST                    (5)  | Epoch:1 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7211
 Best site-MNIST                    (5)  | Epoch:1 | Val Acc: 0.7544
 Best site-USPS                     (3)  | Epoch:1 | Val Acc: 0.7596
 Best site-USPS                     (3)  | Epoch:1 | Val Acc: 0.7179
 Best site-USPS                     (3)  | Epoch:1 | Val Acc: 0.7436
 Best site-SynthDigits              (2)  | Epoch:1 | Val Acc: 0.3864
 Best site-SynthDigits              (2)  | Epoch:1 | Val Acc: 0.3434
 Best site-MNIST_M                  (1)  | Epoch:1 | Val Acc: 0.3636
 Best site-MNIST_M                  (6)  | Epoch:1 | Val Acc: 0.3333
 Best site-SVHN                     (4)  | Epoch:1 | Val Acc: 0.3014
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 2 ============
cnt=[3, 1, 2, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (3) | Train Loss: 1.0644 | Train Acc: 0.7867
 Site-MNIST                     (3) | Train Loss: 1.0397 | Train Acc: 0.7929
 Site-MNIST                     (6) | Train Loss: 1.1260 | Train Acc: 0.7574
 Site-MNIST                     (3) | Train Loss: 1.0672 | Train Acc: 0.7832
 Site-MNIST                     (6) | Train Loss: 1.0584 | Train Acc: 0.7767
 Site-USPS                      (0) | Train Loss: 0.9559 | Train Acc: 0.7986
 Site-USPS                      (0) | Train Loss: 0.9655 | Train Acc: 0.7780
 Site-USPS                      (0) | Train Loss: 0.9364 | Train Acc: 0.8126
 Site-SynthDigits               (2) | Train Loss: 1.6434 | Train Acc: 0.4451
 Site-SynthDigits               (2) | Train Loss: 1.6160 | Train Acc: 0.4798
 Site-MNIST_M                   (5) | Train Loss: 1.9116 | Train Acc: 0.3551
 Site-MNIST_M                   (4) | Train Loss: 1.8417 | Train Acc: 0.3883
 Site-SVHN                      (1) | Train Loss: 1.9985 | Train Acc: 0.2964
Average Train Accuracy: 0.6347
 Site-MNIST                     (3) | Val  Loss: 1.1359 | Val  Acc: 0.8036
 Site-MNIST                     (3) | Val  Loss: 1.1167 | Val  Acc: 0.8095
 Site-MNIST                     (6) | Val  Loss: 1.0201 | Val  Acc: 0.8095
 Site-MNIST                     (3) | Val  Loss: 1.1085 | Val  Acc: 0.7737
 Site-MNIST                     (6) | Val  Loss: 1.0933 | Val  Acc: 0.7825
 Site-USPS                      (0) | Val  Loss: 0.9266 | Val  Acc: 0.8269
 Site-USPS                      (0) | Val  Loss: 1.0040 | Val  Acc: 0.7564
 Site-USPS                      (0) | Val  Loss: 0.9549 | Val  Acc: 0.7778
 Site-SynthDigits               (2) | Val  Loss: 1.8449 | Val  Acc: 0.4848
 Site-SynthDigits               (2) | Val  Loss: 1.5960 | Val  Acc: 0.4394
 Site-MNIST_M                   (5) | Val  Loss: 1.7924 | Val  Acc: 0.4205
 Site-MNIST_M                   (4) | Val  Loss: 1.9696 | Val  Acc: 0.3636
 Site-SVHN                      (1) | Val  Loss: 2.0098 | Val  Acc: 0.3356
Average Valid Accuracy: 0.6449
 Best site-MNIST                    (3)  | Epoch:2 | Val Acc: 0.8036
 Best site-MNIST                    (3)  | Epoch:2 | Val Acc: 0.8095
 Best site-MNIST                    (6)  | Epoch:2 | Val Acc: 0.8095
 Best site-MNIST                    (3)  | Epoch:2 | Val Acc: 0.7737
 Best site-MNIST                    (6)  | Epoch:2 | Val Acc: 0.7825
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.8269
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7564
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7778
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.4848
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.4394
 Best site-MNIST_M                  (5)  | Epoch:2 | Val Acc: 0.4205
 Best site-MNIST_M                  (4)  | Epoch:2 | Val Acc: 0.3636
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.3356
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 1, 2, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (3) | Train Loss: 0.9236 | Train Acc: 0.8178
 Site-MNIST                     (3) | Train Loss: 0.9186 | Train Acc: 0.8195
 Site-MNIST                     (3) | Train Loss: 0.9937 | Train Acc: 0.7653
 Site-MNIST                     (3) | Train Loss: 0.9373 | Train Acc: 0.7858
 Site-MNIST                     (3) | Train Loss: 0.9254 | Train Acc: 0.7863
 Site-USPS                      (0) | Train Loss: 0.8334 | Train Acc: 0.8082
 Site-USPS                      (6) | Train Loss: 0.8300 | Train Acc: 0.7987
 Site-USPS                      (5) | Train Loss: 0.8060 | Train Acc: 0.8243
 Site-SynthDigits               (2) | Train Loss: 1.5053 | Train Acc: 0.5038
 Site-SynthDigits               (2) | Train Loss: 1.4595 | Train Acc: 0.5429
 Site-MNIST_M                   (4) | Train Loss: 1.7884 | Train Acc: 0.4062
 Site-MNIST_M                   (4) | Train Loss: 1.7537 | Train Acc: 0.4242
 Site-SVHN                      (1) | Train Loss: 1.9301 | Train Acc: 0.3390
Average Train Accuracy: 0.6632
 Site-MNIST                     (3) | Val  Loss: 0.9865 | Val  Acc: 0.7857
 Site-MNIST                     (3) | Val  Loss: 0.9658 | Val  Acc: 0.8095
 Site-MNIST                     (3) | Val  Loss: 0.8898 | Val  Acc: 0.8095
 Site-MNIST                     (3) | Val  Loss: 0.9815 | Val  Acc: 0.7737
 Site-MNIST                     (3) | Val  Loss: 0.9607 | Val  Acc: 0.8140
 Site-USPS                      (0) | Val  Loss: 0.7868 | Val  Acc: 0.8462
 Site-USPS                      (6) | Val  Loss: 0.8723 | Val  Acc: 0.7756
 Site-USPS                      (5) | Val  Loss: 0.8353 | Val  Acc: 0.8077
 Site-SynthDigits               (2) | Val  Loss: 1.7114 | Val  Acc: 0.5000
 Site-SynthDigits               (2) | Val  Loss: 1.4300 | Val  Acc: 0.5000
 Site-MNIST_M                   (4) | Val  Loss: 1.6600 | Val  Acc: 0.5114
 Site-MNIST_M                   (4) | Val  Loss: 1.8883 | Val  Acc: 0.4167
 Site-SVHN                      (1) | Val  Loss: 1.9195 | Val  Acc: 0.3904
Average Valid Accuracy: 0.6723
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.7857
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8095
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8095
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.7737
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8140
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8462
 Best site-USPS                     (6)  | Epoch:3 | Val Acc: 0.7756
 Best site-USPS                     (5)  | Epoch:3 | Val Acc: 0.8077
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.5000
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.5000
 Best site-MNIST_M                  (4)  | Epoch:3 | Val Acc: 0.5114
 Best site-MNIST_M                  (4)  | Epoch:3 | Val Acc: 0.4167
 Best site-SVHN                     (1)  | Epoch:3 | Val Acc: 0.3904
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 4 ============
cnt=[5, 1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (0) | Train Loss: 0.8170 | Train Acc: 0.8267
 Site-MNIST                     (0) | Train Loss: 0.7909 | Train Acc: 0.8343
 Site-MNIST                     (0) | Train Loss: 0.8727 | Train Acc: 0.7988
 Site-MNIST                     (0) | Train Loss: 0.8219 | Train Acc: 0.8160
 Site-MNIST                     (0) | Train Loss: 0.8092 | Train Acc: 0.8249
 Site-USPS                      (6) | Train Loss: 0.7554 | Train Acc: 0.8129
 Site-USPS                      (3) | Train Loss: 0.7568 | Train Acc: 0.8019
 Site-USPS                      (3) | Train Loss: 0.7351 | Train Acc: 0.8456
 Site-SynthDigits               (2) | Train Loss: 1.3751 | Train Acc: 0.5625
 Site-SynthDigits               (2) | Train Loss: 1.3228 | Train Acc: 0.6010
 Site-MNIST_M                   (1) | Train Loss: 1.6843 | Train Acc: 0.4517
 Site-MNIST_M                   (5) | Train Loss: 1.6385 | Train Acc: 0.4773
 Site-SVHN                      (4) | Train Loss: 1.8494 | Train Acc: 0.3748
Average Train Accuracy: 0.6945
 Site-MNIST                     (0) | Val  Loss: 0.8504 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.8218 | Val  Acc: 0.8690
 Site-MNIST                     (0) | Val  Loss: 0.7752 | Val  Acc: 0.8333
 Site-MNIST                     (0) | Val  Loss: 0.8692 | Val  Acc: 0.8053
 Site-MNIST                     (0) | Val  Loss: 0.8421 | Val  Acc: 0.8316
 Site-USPS                      (6) | Val  Loss: 0.6991 | Val  Acc: 0.8365
 Site-USPS                      (3) | Val  Loss: 0.7961 | Val  Acc: 0.7821
 Site-USPS                      (3) | Val  Loss: 0.7700 | Val  Acc: 0.8162
 Site-SynthDigits               (2) | Val  Loss: 1.5962 | Val  Acc: 0.5606
 Site-SynthDigits               (2) | Val  Loss: 1.2952 | Val  Acc: 0.5354
 Site-MNIST_M                   (1) | Val  Loss: 1.5556 | Val  Acc: 0.5455
 Site-MNIST_M                   (5) | Val  Loss: 1.8042 | Val  Acc: 0.4394
 Site-SVHN                      (4) | Val  Loss: 1.8438 | Val  Acc: 0.4110
Average Valid Accuracy: 0.7018
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8571
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8690
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8333
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8053
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8316
 Best site-USPS                     (6)  | Epoch:4 | Val Acc: 0.8365
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.7821
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.8162
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.5606
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.5354
 Best site-MNIST_M                  (1)  | Epoch:4 | Val Acc: 0.5455
 Best site-MNIST_M                  (5)  | Epoch:4 | Val Acc: 0.4394
 Best site-SVHN                     (4)  | Epoch:4 | Val Acc: 0.4110
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 4, 2, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (1) | Train Loss: 0.7273 | Train Acc: 0.8444
 Site-MNIST                     (5) | Train Loss: 0.7155 | Train Acc: 0.8580
 Site-MNIST                     (1) | Train Loss: 0.7805 | Train Acc: 0.8304
 Site-MNIST                     (1) | Train Loss: 0.7353 | Train Acc: 0.8384
 Site-MNIST                     (1) | Train Loss: 0.7219 | Train Acc: 0.8433
 Site-USPS                      (3) | Train Loss: 0.7151 | Train Acc: 0.8201
 Site-USPS                      (3) | Train Loss: 0.6935 | Train Acc: 0.8115
 Site-USPS                      (3) | Train Loss: 0.6775 | Train Acc: 0.8488
 Site-SynthDigits               (2) | Train Loss: 1.2688 | Train Acc: 0.6042
 Site-SynthDigits               (2) | Train Loss: 1.2053 | Train Acc: 0.6402
 Site-MNIST_M                   (6) | Train Loss: 1.6057 | Train Acc: 0.5000
 Site-MNIST_M                   (0) | Train Loss: 1.5925 | Train Acc: 0.5341
 Site-SVHN                      (4) | Train Loss: 1.7960 | Train Acc: 0.3884
Average Train Accuracy: 0.7201
 Site-MNIST                     (1) | Val  Loss: 0.7442 | Val  Acc: 0.8929
 Site-MNIST                     (5) | Val  Loss: 0.7190 | Val  Acc: 0.9048
 Site-MNIST                     (1) | Val  Loss: 0.6861 | Val  Acc: 0.8492
 Site-MNIST                     (1) | Val  Loss: 0.7806 | Val  Acc: 0.8316
 Site-MNIST                     (1) | Val  Loss: 0.7520 | Val  Acc: 0.8491
 Site-USPS                      (3) | Val  Loss: 0.6372 | Val  Acc: 0.8365
 Site-USPS                      (3) | Val  Loss: 0.7317 | Val  Acc: 0.7885
 Site-USPS                      (3) | Val  Loss: 0.7191 | Val  Acc: 0.8162
 Site-SynthDigits               (2) | Val  Loss: 1.4915 | Val  Acc: 0.5985
 Site-SynthDigits               (2) | Val  Loss: 1.1878 | Val  Acc: 0.5909
 Site-MNIST_M                   (6) | Val  Loss: 1.4493 | Val  Acc: 0.6136
 Site-MNIST_M                   (0) | Val  Loss: 1.7043 | Val  Acc: 0.4697
 Site-SVHN                      (4) | Val  Loss: 1.7872 | Val  Acc: 0.4315
Average Valid Accuracy: 0.7287
 Best site-MNIST                    (1)  | Epoch:5 | Val Acc: 0.8929
 Best site-MNIST                    (5)  | Epoch:5 | Val Acc: 0.9048
 Best site-MNIST                    (1)  | Epoch:5 | Val Acc: 0.8492
 Best site-MNIST                    (1)  | Epoch:5 | Val Acc: 0.8316
 Best site-MNIST                    (1)  | Epoch:5 | Val Acc: 0.8491
 Best site-USPS                     (3)  | Epoch:5 | Val Acc: 0.8365
 Best site-USPS                     (3)  | Epoch:5 | Val Acc: 0.7885
 Best site-USPS                     (3)  | Epoch:5 | Val Acc: 0.8162
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.5985
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.5909
 Best site-MNIST_M                  (6)  | Epoch:5 | Val Acc: 0.6136
 Best site-MNIST_M                  (0)  | Epoch:5 | Val Acc: 0.4697
 Best site-SVHN                     (4)  | Epoch:5 | Val Acc: 0.4315
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 2, 1, 3, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (1) | Train Loss: 0.6742 | Train Acc: 0.8578
 Site-MNIST                     (5) | Train Loss: 0.6928 | Train Acc: 0.8491
 Site-MNIST                     (1) | Train Loss: 0.7251 | Train Acc: 0.8166
 Site-MNIST                     (5) | Train Loss: 0.6871 | Train Acc: 0.8318
 Site-MNIST                     (5) | Train Loss: 0.6701 | Train Acc: 0.8433
 Site-USPS                      (3) | Train Loss: 0.6666 | Train Acc: 0.8201
 Site-USPS                      (3) | Train Loss: 0.6588 | Train Acc: 0.8099
 Site-USPS                      (3) | Train Loss: 0.6395 | Train Acc: 0.8509
 Site-SynthDigits               (6) | Train Loss: 1.2127 | Train Acc: 0.6250
 Site-SynthDigits               (2) | Train Loss: 1.1343 | Train Acc: 0.6730
 Site-MNIST_M                   (0) | Train Loss: 1.5136 | Train Acc: 0.5540
 Site-MNIST_M                   (0) | Train Loss: 1.4456 | Train Acc: 0.5682
 Site-SVHN                      (4) | Train Loss: 1.7193 | Train Acc: 0.4123
Average Train Accuracy: 0.7317
 Site-MNIST                     (1) | Val  Loss: 0.6813 | Val  Acc: 0.8393
 Site-MNIST                     (5) | Val  Loss: 0.6646 | Val  Acc: 0.8810
 Site-MNIST                     (1) | Val  Loss: 0.6392 | Val  Acc: 0.8492
 Site-MNIST                     (5) | Val  Loss: 0.7291 | Val  Acc: 0.8368
 Site-MNIST                     (5) | Val  Loss: 0.6993 | Val  Acc: 0.8491
 Site-USPS                      (3) | Val  Loss: 0.6013 | Val  Acc: 0.8269
 Site-USPS                      (3) | Val  Loss: 0.6886 | Val  Acc: 0.7821
 Site-USPS                      (3) | Val  Loss: 0.6864 | Val  Acc: 0.8077
 Site-SynthDigits               (6) | Val  Loss: 1.4288 | Val  Acc: 0.5909
 Site-SynthDigits               (2) | Val  Loss: 1.1055 | Val  Acc: 0.6212
 Site-MNIST_M                   (0) | Val  Loss: 1.3445 | Val  Acc: 0.6364
 Site-MNIST_M                   (0) | Val  Loss: 1.6028 | Val  Acc: 0.5379
 Site-SVHN                      (4) | Val  Loss: 1.7415 | Val  Acc: 0.4726
Average Valid Accuracy: 0.7332
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8393
 Best site-MNIST                    (5)  | Epoch:6 | Val Acc: 0.8810
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8492
 Best site-MNIST                    (5)  | Epoch:6 | Val Acc: 0.8368
 Best site-MNIST                    (5)  | Epoch:6 | Val Acc: 0.8491
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.8269
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.7821
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.8077
 Best site-SynthDigits              (6)  | Epoch:6 | Val Acc: 0.5909
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.6212
 Best site-MNIST_M                  (0)  | Epoch:6 | Val Acc: 0.6364
 Best site-MNIST_M                  (0)  | Epoch:6 | Val Acc: 0.5379
 Best site-SVHN                     (4)  | Epoch:6 | Val Acc: 0.4726
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 7 ============
cnt=[4, 1, 2, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (0) | Train Loss: 0.6296 | Train Acc: 0.8356
 Site-MNIST                     (0) | Train Loss: 0.6148 | Train Acc: 0.8491
 Site-MNIST                     (6) | Train Loss: 0.6850 | Train Acc: 0.8146
 Site-MNIST                     (0) | Train Loss: 0.6444 | Train Acc: 0.8410
 Site-MNIST                     (0) | Train Loss: 0.6320 | Train Acc: 0.8503
 Site-USPS                      (3) | Train Loss: 0.6232 | Train Acc: 0.8297
 Site-USPS                      (3) | Train Loss: 0.6001 | Train Acc: 0.8307
 Site-USPS                      (3) | Train Loss: 0.5823 | Train Acc: 0.8679
 Site-SynthDigits               (2) | Train Loss: 1.1037 | Train Acc: 0.6610
 Site-SynthDigits               (2) | Train Loss: 1.0423 | Train Acc: 0.7083
 Site-MNIST_M                   (1) | Train Loss: 1.4714 | Train Acc: 0.5568
 Site-MNIST_M                   (5) | Train Loss: 1.4436 | Train Acc: 0.5758
 Site-SVHN                      (4) | Train Loss: 1.6202 | Train Acc: 0.4480
Average Train Accuracy: 0.7438
 Site-MNIST                     (0) | Val  Loss: 0.6426 | Val  Acc: 0.8393
 Site-MNIST                     (0) | Val  Loss: 0.6162 | Val  Acc: 0.8571
 Site-MNIST                     (6) | Val  Loss: 0.5993 | Val  Acc: 0.8413
 Site-MNIST                     (0) | Val  Loss: 0.6878 | Val  Acc: 0.8105
 Site-MNIST                     (0) | Val  Loss: 0.6551 | Val  Acc: 0.8456
 Site-USPS                      (3) | Val  Loss: 0.5411 | Val  Acc: 0.8558
 Site-USPS                      (3) | Val  Loss: 0.6381 | Val  Acc: 0.8013
 Site-USPS                      (3) | Val  Loss: 0.6347 | Val  Acc: 0.8162
 Site-SynthDigits               (2) | Val  Loss: 1.3343 | Val  Acc: 0.6288
 Site-SynthDigits               (2) | Val  Loss: 1.0087 | Val  Acc: 0.6465
 Site-MNIST_M                   (1) | Val  Loss: 1.2879 | Val  Acc: 0.6591
 Site-MNIST_M                   (5) | Val  Loss: 1.5448 | Val  Acc: 0.5530
 Site-SVHN                      (4) | Val  Loss: 1.6648 | Val  Acc: 0.4795
Average Valid Accuracy: 0.7411
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8393
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8571
 Best site-MNIST                    (6)  | Epoch:7 | Val Acc: 0.8413
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8105
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8456
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.8558
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.8013
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.8162
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.6288
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.6465
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.6591
 Best site-MNIST_M                  (5)  | Epoch:7 | Val Acc: 0.5530
 Best site-SVHN                     (4)  | Epoch:7 | Val Acc: 0.4795
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 1, 5, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (2) | Train Loss: 0.5809 | Train Acc: 0.8356
 Site-MNIST                     (2) | Train Loss: 0.5737 | Train Acc: 0.8550
 Site-MNIST                     (2) | Train Loss: 0.6368 | Train Acc: 0.8363
 Site-MNIST                     (2) | Train Loss: 0.6063 | Train Acc: 0.8410
 Site-MNIST                     (2) | Train Loss: 0.5881 | Train Acc: 0.8538
 Site-USPS                      (0) | Train Loss: 0.5932 | Train Acc: 0.8297
 Site-USPS                      (6) | Train Loss: 0.5788 | Train Acc: 0.8275
 Site-USPS                      (0) | Train Loss: 0.5629 | Train Acc: 0.8743
 Site-SynthDigits               (3) | Train Loss: 1.0525 | Train Acc: 0.6723
 Site-SynthDigits               (5) | Train Loss: 0.9730 | Train Acc: 0.7159
 Site-MNIST_M                   (4) | Train Loss: 1.3585 | Train Acc: 0.5938
 Site-MNIST_M                   (4) | Train Loss: 1.3549 | Train Acc: 0.6023
 Site-SVHN                      (1) | Train Loss: 1.6076 | Train Acc: 0.4702
Average Train Accuracy: 0.7544
 Site-MNIST                     (2) | Val  Loss: 0.5903 | Val  Acc: 0.8750
 Site-MNIST                     (2) | Val  Loss: 0.5667 | Val  Acc: 0.9048
 Site-MNIST                     (2) | Val  Loss: 0.5635 | Val  Acc: 0.8730
 Site-MNIST                     (2) | Val  Loss: 0.6455 | Val  Acc: 0.8368
 Site-MNIST                     (2) | Val  Loss: 0.6105 | Val  Acc: 0.8596
 Site-USPS                      (0) | Val  Loss: 0.5100 | Val  Acc: 0.8462
 Site-USPS                      (6) | Val  Loss: 0.6101 | Val  Acc: 0.7949
 Site-USPS                      (0) | Val  Loss: 0.6174 | Val  Acc: 0.8162
 Site-SynthDigits               (3) | Val  Loss: 1.2984 | Val  Acc: 0.6288
 Site-SynthDigits               (5) | Val  Loss: 0.9542 | Val  Acc: 0.6667
 Site-MNIST_M                   (4) | Val  Loss: 1.2058 | Val  Acc: 0.6818
 Site-MNIST_M                   (4) | Val  Loss: 1.4305 | Val  Acc: 0.5909
 Site-SVHN                      (1) | Val  Loss: 1.5945 | Val  Acc: 0.4863
Average Valid Accuracy: 0.7585
 Best site-MNIST                    (2)  | Epoch:8 | Val Acc: 0.8750
 Best site-MNIST                    (2)  | Epoch:8 | Val Acc: 0.9048
 Best site-MNIST                    (2)  | Epoch:8 | Val Acc: 0.8730
 Best site-MNIST                    (2)  | Epoch:8 | Val Acc: 0.8368
 Best site-MNIST                    (2)  | Epoch:8 | Val Acc: 0.8596
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.8462
 Best site-USPS                     (6)  | Epoch:8 | Val Acc: 0.7949
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.8162
 Best site-SynthDigits              (3)  | Epoch:8 | Val Acc: 0.6288
 Best site-SynthDigits              (5)  | Epoch:8 | Val Acc: 0.6667
 Best site-MNIST_M                  (4)  | Epoch:8 | Val Acc: 0.6818
 Best site-MNIST_M                  (4)  | Epoch:8 | Val Acc: 0.5909
 Best site-SVHN                     (1)  | Epoch:8 | Val Acc: 0.4863
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 2, 1, 3, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (6) | Train Loss: 0.5410 | Train Acc: 0.8444
 Site-MNIST                     (6) | Train Loss: 0.5152 | Train Acc: 0.8757
 Site-MNIST                     (1) | Train Loss: 0.5959 | Train Acc: 0.8560
 Site-MNIST                     (6) | Train Loss: 0.5631 | Train Acc: 0.8568
 Site-MNIST                     (1) | Train Loss: 0.5426 | Train Acc: 0.8792
 Site-USPS                      (3) | Train Loss: 0.5586 | Train Acc: 0.8297
 Site-USPS                      (3) | Train Loss: 0.5323 | Train Acc: 0.8450
 Site-USPS                      (3) | Train Loss: 0.5259 | Train Acc: 0.8775
 Site-SynthDigits               (2) | Train Loss: 0.9538 | Train Acc: 0.7064
 Site-SynthDigits               (5) | Train Loss: 0.9112 | Train Acc: 0.7449
 Site-MNIST_M                   (0) | Train Loss: 1.3016 | Train Acc: 0.6136
 Site-MNIST_M                   (0) | Train Loss: 1.2813 | Train Acc: 0.6174
 Site-SVHN                      (4) | Train Loss: 1.4980 | Train Acc: 0.4923
Average Train Accuracy: 0.7722
 Site-MNIST                     (6) | Val  Loss: 0.5353 | Val  Acc: 0.8750
 Site-MNIST                     (6) | Val  Loss: 0.5132 | Val  Acc: 0.8929
 Site-MNIST                     (1) | Val  Loss: 0.5183 | Val  Acc: 0.8810
 Site-MNIST                     (6) | Val  Loss: 0.6061 | Val  Acc: 0.8579
 Site-MNIST                     (1) | Val  Loss: 0.5631 | Val  Acc: 0.8737
 Site-USPS                      (3) | Val  Loss: 0.4728 | Val  Acc: 0.8654
 Site-USPS                      (3) | Val  Loss: 0.5748 | Val  Acc: 0.8141
 Site-USPS                      (3) | Val  Loss: 0.5837 | Val  Acc: 0.8077
 Site-SynthDigits               (2) | Val  Loss: 1.2301 | Val  Acc: 0.6591
 Site-SynthDigits               (5) | Val  Loss: 0.8820 | Val  Acc: 0.6919
 Site-MNIST_M                   (0) | Val  Loss: 1.1747 | Val  Acc: 0.6705
 Site-MNIST_M                   (0) | Val  Loss: 1.3800 | Val  Acc: 0.5833
 Site-SVHN                      (4) | Val  Loss: 1.5213 | Val  Acc: 0.5342
Average Valid Accuracy: 0.7697
 Best site-MNIST                    (6)  | Epoch:9 | Val Acc: 0.8750
 Best site-MNIST                    (6)  | Epoch:9 | Val Acc: 0.8929
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8810
 Best site-MNIST                    (6)  | Epoch:9 | Val Acc: 0.8579
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8737
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8654
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8141
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8077
 Best site-SynthDigits              (2)  | Epoch:9 | Val Acc: 0.6591
 Best site-SynthDigits              (5)  | Epoch:9 | Val Acc: 0.6919
 Best site-MNIST_M                  (0)  | Epoch:9 | Val Acc: 0.6705
 Best site-MNIST_M                  (0)  | Epoch:9 | Val Acc: 0.5833
 Best site-SVHN                     (4)  | Epoch:9 | Val Acc: 0.5342
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 10 ============
cnt=[3, 1, 2, 2, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (5) | Train Loss: 0.5479 | Train Acc: 0.8400
 Site-MNIST                     (5) | Train Loss: 0.4980 | Train Acc: 0.8669
 Site-MNIST                     (5) | Train Loss: 0.5773 | Train Acc: 0.8540
 Site-MNIST                     (2) | Train Loss: 0.5459 | Train Acc: 0.8476
 Site-MNIST                     (2) | Train Loss: 0.5235 | Train Acc: 0.8713
 Site-USPS                      (0) | Train Loss: 0.5371 | Train Acc: 0.8441
 Site-USPS                      (0) | Train Loss: 0.5134 | Train Acc: 0.8450
 Site-USPS                      (0) | Train Loss: 0.5032 | Train Acc: 0.8860
 Site-SynthDigits               (3) | Train Loss: 0.9074 | Train Acc: 0.7292
 Site-SynthDigits               (3) | Train Loss: 0.8494 | Train Acc: 0.7652
 Site-MNIST_M                   (1) | Train Loss: 1.2485 | Train Acc: 0.6165
 Site-MNIST_M                   (6) | Train Loss: 1.2297 | Train Acc: 0.6383
 Site-SVHN                      (4) | Train Loss: 1.4184 | Train Acc: 0.5417
Average Train Accuracy: 0.7804
 Site-MNIST                     (5) | Val  Loss: 0.5151 | Val  Acc: 0.8571
 Site-MNIST                     (5) | Val  Loss: 0.4943 | Val  Acc: 0.8929
 Site-MNIST                     (5) | Val  Loss: 0.5032 | Val  Acc: 0.8730
 Site-MNIST                     (2) | Val  Loss: 0.5866 | Val  Acc: 0.8474
 Site-MNIST                     (2) | Val  Loss: 0.5429 | Val  Acc: 0.8667
 Site-USPS                      (0) | Val  Loss: 0.4469 | Val  Acc: 0.8654
 Site-USPS                      (0) | Val  Loss: 0.5480 | Val  Acc: 0.8205
 Site-USPS                      (0) | Val  Loss: 0.5640 | Val  Acc: 0.8120
 Site-SynthDigits               (3) | Val  Loss: 1.1816 | Val  Acc: 0.6894
 Site-SynthDigits               (3) | Val  Loss: 0.8159 | Val  Acc: 0.7424
 Site-MNIST_M                   (1) | Val  Loss: 1.1467 | Val  Acc: 0.6591
 Site-MNIST_M                   (6) | Val  Loss: 1.3029 | Val  Acc: 0.5682
 Site-SVHN                      (4) | Val  Loss: 1.4099 | Val  Acc: 0.5411
Average Valid Accuracy: 0.7719
 Best site-MNIST                    (5)  | Epoch:10 | Val Acc: 0.8571
 Best site-MNIST                    (5)  | Epoch:10 | Val Acc: 0.8929
 Best site-MNIST                    (5)  | Epoch:10 | Val Acc: 0.8730
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.8474
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.8667
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8654
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8205
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8120
 Best site-SynthDigits              (3)  | Epoch:10 | Val Acc: 0.6894
 Best site-SynthDigits              (3)  | Epoch:10 | Val Acc: 0.7424
 Best site-MNIST_M                  (1)  | Epoch:10 | Val Acc: 0.6591
 Best site-MNIST_M                  (6)  | Epoch:10 | Val Acc: 0.5682
 Best site-SVHN                     (4)  | Epoch:10 | Val Acc: 0.5411
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 3, 2, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (3) | Train Loss: 0.4953 | Train Acc: 0.8444
 Site-MNIST                     (5) | Train Loss: 0.4833 | Train Acc: 0.8817
 Site-MNIST                     (6) | Train Loss: 0.5312 | Train Acc: 0.8639
 Site-MNIST                     (5) | Train Loss: 0.5061 | Train Acc: 0.8581
 Site-MNIST                     (5) | Train Loss: 0.4799 | Train Acc: 0.8844
 Site-USPS                      (1) | Train Loss: 0.5286 | Train Acc: 0.8441
 Site-USPS                      (1) | Train Loss: 0.4975 | Train Acc: 0.8450
 Site-USPS                      (1) | Train Loss: 0.4868 | Train Acc: 0.8850
 Site-SynthDigits               (0) | Train Loss: 0.8686 | Train Acc: 0.7443
 Site-SynthDigits               (0) | Train Loss: 0.7887 | Train Acc: 0.7753
 Site-MNIST_M                   (2) | Train Loss: 1.1887 | Train Acc: 0.6477
 Site-MNIST_M                   (2) | Train Loss: 1.1648 | Train Acc: 0.6591
 Site-SVHN                      (4) | Train Loss: 1.3563 | Train Acc: 0.5622
Average Train Accuracy: 0.7919
 Site-MNIST                     (3) | Val  Loss: 0.4602 | Val  Acc: 0.8750
 Site-MNIST                     (5) | Val  Loss: 0.4455 | Val  Acc: 0.8929
 Site-MNIST                     (6) | Val  Loss: 0.4651 | Val  Acc: 0.8968
 Site-MNIST                     (5) | Val  Loss: 0.5462 | Val  Acc: 0.8684
 Site-MNIST                     (5) | Val  Loss: 0.5010 | Val  Acc: 0.8842
 Site-USPS                      (1) | Val  Loss: 0.4214 | Val  Acc: 0.8462
 Site-USPS                      (1) | Val  Loss: 0.5261 | Val  Acc: 0.7949
 Site-USPS                      (1) | Val  Loss: 0.5535 | Val  Acc: 0.8077
 Site-SynthDigits               (0) | Val  Loss: 1.1384 | Val  Acc: 0.7197
 Site-SynthDigits               (0) | Val  Loss: 0.7585 | Val  Acc: 0.7576
 Site-MNIST_M                   (2) | Val  Loss: 1.1012 | Val  Acc: 0.6932
 Site-MNIST_M                   (2) | Val  Loss: 1.2520 | Val  Acc: 0.5833
 Site-SVHN                      (4) | Val  Loss: 1.3829 | Val  Acc: 0.5753
Average Valid Accuracy: 0.7842
 Best site-MNIST                    (3)  | Epoch:11 | Val Acc: 0.8750
 Best site-MNIST                    (5)  | Epoch:11 | Val Acc: 0.8929
 Best site-MNIST                    (6)  | Epoch:11 | Val Acc: 0.8968
 Best site-MNIST                    (5)  | Epoch:11 | Val Acc: 0.8684
 Best site-MNIST                    (5)  | Epoch:11 | Val Acc: 0.8842
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.8462
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.7949
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.8077
 Best site-SynthDigits              (0)  | Epoch:11 | Val Acc: 0.7197
 Best site-SynthDigits              (0)  | Epoch:11 | Val Acc: 0.7576
 Best site-MNIST_M                  (2)  | Epoch:11 | Val Acc: 0.6932
 Best site-MNIST_M                  (2)  | Epoch:11 | Val Acc: 0.5833
 Best site-SVHN                     (4)  | Epoch:11 | Val Acc: 0.5753
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 2, 3, 1, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (1) | Train Loss: 0.4636 | Train Acc: 0.8356
 Site-MNIST                     (6) | Train Loss: 0.4480 | Train Acc: 0.8817
 Site-MNIST                     (6) | Train Loss: 0.5037 | Train Acc: 0.8619
 Site-MNIST                     (6) | Train Loss: 0.4827 | Train Acc: 0.8647
 Site-MNIST                     (1) | Train Loss: 0.4567 | Train Acc: 0.8818
 Site-USPS                      (2) | Train Loss: 0.5075 | Train Acc: 0.8585
 Site-USPS                      (2) | Train Loss: 0.4721 | Train Acc: 0.8690
 Site-USPS                      (2) | Train Loss: 0.4657 | Train Acc: 0.8871
 Site-SynthDigits               (5) | Train Loss: 0.8333 | Train Acc: 0.7500
 Site-SynthDigits               (3) | Train Loss: 0.7371 | Train Acc: 0.7929
 Site-MNIST_M                   (0) | Train Loss: 1.1430 | Train Acc: 0.6562
 Site-MNIST_M                   (0) | Train Loss: 1.1232 | Train Acc: 0.6610
 Site-SVHN                      (4) | Train Loss: 1.2774 | Train Acc: 0.6031
Average Train Accuracy: 0.8003
 Site-MNIST                     (1) | Val  Loss: 0.4405 | Val  Acc: 0.8750
 Site-MNIST                     (6) | Val  Loss: 0.4254 | Val  Acc: 0.8929
 Site-MNIST                     (6) | Val  Loss: 0.4420 | Val  Acc: 0.8968
 Site-MNIST                     (6) | Val  Loss: 0.5184 | Val  Acc: 0.8684
 Site-MNIST                     (1) | Val  Loss: 0.4746 | Val  Acc: 0.8772
 Site-USPS                      (2) | Val  Loss: 0.3958 | Val  Acc: 0.8846
 Site-USPS                      (2) | Val  Loss: 0.4983 | Val  Acc: 0.8397
 Site-USPS                      (2) | Val  Loss: 0.5314 | Val  Acc: 0.8291
 Site-SynthDigits               (5) | Val  Loss: 1.0745 | Val  Acc: 0.7348
 Site-SynthDigits               (3) | Val  Loss: 0.7025 | Val  Acc: 0.7828
 Site-MNIST_M                   (0) | Val  Loss: 1.0603 | Val  Acc: 0.7045
 Site-MNIST_M                   (0) | Val  Loss: 1.1920 | Val  Acc: 0.6212
 Site-SVHN                      (4) | Val  Loss: 1.3210 | Val  Acc: 0.5822
Average Valid Accuracy: 0.7992
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8750
 Best site-MNIST                    (6)  | Epoch:12 | Val Acc: 0.8929
 Best site-MNIST                    (6)  | Epoch:12 | Val Acc: 0.8968
 Best site-MNIST                    (6)  | Epoch:12 | Val Acc: 0.8684
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8772
 Best site-USPS                     (2)  | Epoch:12 | Val Acc: 0.8846
 Best site-USPS                     (2)  | Epoch:12 | Val Acc: 0.8397
 Best site-USPS                     (2)  | Epoch:12 | Val Acc: 0.8291
 Best site-SynthDigits              (5)  | Epoch:12 | Val Acc: 0.7348
 Best site-SynthDigits              (3)  | Epoch:12 | Val Acc: 0.7828
 Best site-MNIST_M                  (0)  | Epoch:12 | Val Acc: 0.7045
 Best site-MNIST_M                  (0)  | Epoch:12 | Val Acc: 0.6212
 Best site-SVHN                     (4)  | Epoch:12 | Val Acc: 0.5822
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 13 ============
cnt=[3, 2, 4, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (2) | Train Loss: 0.4434 | Train Acc: 0.8533
 Site-MNIST                     (2) | Train Loss: 0.4003 | Train Acc: 0.9112
 Site-MNIST                     (6) | Train Loss: 0.4669 | Train Acc: 0.8698
 Site-MNIST                     (2) | Train Loss: 0.4464 | Train Acc: 0.8699
 Site-MNIST                     (2) | Train Loss: 0.4174 | Train Acc: 0.8984
 Site-USPS                      (0) | Train Loss: 0.4728 | Train Acc: 0.8633
 Site-USPS                      (0) | Train Loss: 0.4538 | Train Acc: 0.8706
 Site-USPS                      (0) | Train Loss: 0.4467 | Train Acc: 0.8882
 Site-SynthDigits               (3) | Train Loss: 0.7481 | Train Acc: 0.7689
 Site-SynthDigits               (5) | Train Loss: 0.6931 | Train Acc: 0.8232
 Site-MNIST_M                   (1) | Train Loss: 1.0744 | Train Acc: 0.6676
 Site-MNIST_M                   (1) | Train Loss: 1.0982 | Train Acc: 0.6913
 Site-SVHN                      (4) | Train Loss: 1.2590 | Train Acc: 0.6014
Average Train Accuracy: 0.8136
 Site-MNIST                     (2) | Val  Loss: 0.3922 | Val  Acc: 0.8750
 Site-MNIST                     (2) | Val  Loss: 0.3852 | Val  Acc: 0.8929
 Site-MNIST                     (6) | Val  Loss: 0.4074 | Val  Acc: 0.8889
 Site-MNIST                     (2) | Val  Loss: 0.4829 | Val  Acc: 0.8789
 Site-MNIST                     (2) | Val  Loss: 0.4360 | Val  Acc: 0.9053
 Site-USPS                      (0) | Val  Loss: 0.3686 | Val  Acc: 0.8846
 Site-USPS                      (0) | Val  Loss: 0.4759 | Val  Acc: 0.8462
 Site-USPS                      (0) | Val  Loss: 0.5148 | Val  Acc: 0.8205
 Site-SynthDigits               (3) | Val  Loss: 1.0084 | Val  Acc: 0.7424
 Site-SynthDigits               (5) | Val  Loss: 0.6582 | Val  Acc: 0.7828
 Site-MNIST_M                   (1) | Val  Loss: 1.0151 | Val  Acc: 0.6818
 Site-MNIST_M                   (1) | Val  Loss: 1.1506 | Val  Acc: 0.6136
 Site-SVHN                      (4) | Val  Loss: 1.2978 | Val  Acc: 0.6027
Average Valid Accuracy: 0.8012
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8750
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8929
 Best site-MNIST                    (6)  | Epoch:13 | Val Acc: 0.8889
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8789
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.9053
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.8846
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.8462
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.8205
 Best site-SynthDigits              (3)  | Epoch:13 | Val Acc: 0.7424
 Best site-SynthDigits              (5)  | Epoch:13 | Val Acc: 0.7828
 Best site-MNIST_M                  (1)  | Epoch:13 | Val Acc: 0.6818
 Best site-MNIST_M                  (1)  | Epoch:13 | Val Acc: 0.6136
 Best site-SVHN                     (4)  | Epoch:13 | Val Acc: 0.6027
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 14 ============
cnt=[4, 1, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (0) | Train Loss: 0.4000 | Train Acc: 0.8711
 Site-MNIST                     (0) | Train Loss: 0.3642 | Train Acc: 0.9201
 Site-MNIST                     (0) | Train Loss: 0.4239 | Train Acc: 0.8895
 Site-MNIST                     (6) | Train Loss: 0.4138 | Train Acc: 0.8791
 Site-MNIST                     (0) | Train Loss: 0.3821 | Train Acc: 0.9072
 Site-USPS                      (5) | Train Loss: 0.4660 | Train Acc: 0.8561
 Site-USPS                      (1) | Train Loss: 0.4427 | Train Acc: 0.8706
 Site-USPS                      (5) | Train Loss: 0.4351 | Train Acc: 0.8850
 Site-SynthDigits               (4) | Train Loss: 0.7426 | Train Acc: 0.7670
 Site-SynthDigits               (4) | Train Loss: 0.6662 | Train Acc: 0.8270
 Site-MNIST_M                   (2) | Train Loss: 1.0554 | Train Acc: 0.6761
 Site-MNIST_M                   (2) | Train Loss: 1.0336 | Train Acc: 0.6989
 Site-SVHN                      (3) | Train Loss: 1.2032 | Train Acc: 0.6201
Average Train Accuracy: 0.8206
 Site-MNIST                     (0) | Val  Loss: 0.3518 | Val  Acc: 0.8929
 Site-MNIST                     (0) | Val  Loss: 0.3443 | Val  Acc: 0.9167
 Site-MNIST                     (0) | Val  Loss: 0.3732 | Val  Acc: 0.9206
 Site-MNIST                     (6) | Val  Loss: 0.4442 | Val  Acc: 0.9105
 Site-MNIST                     (0) | Val  Loss: 0.3996 | Val  Acc: 0.9123
 Site-USPS                      (5) | Val  Loss: 0.3552 | Val  Acc: 0.8942
 Site-USPS                      (1) | Val  Loss: 0.4602 | Val  Acc: 0.8526
 Site-USPS                      (5) | Val  Loss: 0.5049 | Val  Acc: 0.8205
 Site-SynthDigits               (4) | Val  Loss: 0.9549 | Val  Acc: 0.7500
 Site-SynthDigits               (4) | Val  Loss: 0.6320 | Val  Acc: 0.7929
 Site-MNIST_M                   (2) | Val  Loss: 0.9915 | Val  Acc: 0.6932
 Site-MNIST_M                   (2) | Val  Loss: 1.0933 | Val  Acc: 0.6364
 Site-SVHN                      (3) | Val  Loss: 1.2413 | Val  Acc: 0.6164
Average Valid Accuracy: 0.8161
 Best site-MNIST                    (0)  | Epoch:14 | Val Acc: 0.8929
 Best site-MNIST                    (0)  | Epoch:14 | Val Acc: 0.9167
 Best site-MNIST                    (0)  | Epoch:14 | Val Acc: 0.9206
 Best site-MNIST                    (6)  | Epoch:14 | Val Acc: 0.9105
 Best site-MNIST                    (0)  | Epoch:14 | Val Acc: 0.9123
 Best site-USPS                     (5)  | Epoch:14 | Val Acc: 0.8942
 Best site-USPS                     (1)  | Epoch:14 | Val Acc: 0.8526
 Best site-USPS                     (5)  | Epoch:14 | Val Acc: 0.8205
 Best site-SynthDigits              (4)  | Epoch:14 | Val Acc: 0.7500
 Best site-SynthDigits              (4)  | Epoch:14 | Val Acc: 0.7929
 Best site-MNIST_M                  (2)  | Epoch:14 | Val Acc: 0.6932
 Best site-MNIST_M                  (2)  | Epoch:14 | Val Acc: 0.6364
 Best site-SVHN                     (3)  | Epoch:14 | Val Acc: 0.6164
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 15 ============
cnt=[4, 1, 2, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (0) | Train Loss: 0.3740 | Train Acc: 0.8756
 Site-MNIST                     (0) | Train Loss: 0.3330 | Train Acc: 0.9142
 Site-MNIST                     (5) | Train Loss: 0.4087 | Train Acc: 0.8915
 Site-MNIST                     (0) | Train Loss: 0.3947 | Train Acc: 0.8870
 Site-MNIST                     (0) | Train Loss: 0.3643 | Train Acc: 0.9124
 Site-USPS                      (3) | Train Loss: 0.4468 | Train Acc: 0.8705
 Site-USPS                      (3) | Train Loss: 0.4115 | Train Acc: 0.8850
 Site-USPS                      (3) | Train Loss: 0.4018 | Train Acc: 0.8946
 Site-SynthDigits               (6) | Train Loss: 0.7067 | Train Acc: 0.7955
 Site-SynthDigits               (1) | Train Loss: 0.6273 | Train Acc: 0.8396
 Site-MNIST_M                   (2) | Train Loss: 1.0166 | Train Acc: 0.6847
 Site-MNIST_M                   (2) | Train Loss: 0.9923 | Train Acc: 0.7083
 Site-SVHN                      (4) | Train Loss: 1.1873 | Train Acc: 0.6303
Average Train Accuracy: 0.8299
 Site-MNIST                     (0) | Val  Loss: 0.3339 | Val  Acc: 0.8929
 Site-MNIST                     (0) | Val  Loss: 0.3285 | Val  Acc: 0.9167
 Site-MNIST                     (5) | Val  Loss: 0.3534 | Val  Acc: 0.9127
 Site-MNIST                     (0) | Val  Loss: 0.4266 | Val  Acc: 0.8947
 Site-MNIST                     (0) | Val  Loss: 0.3802 | Val  Acc: 0.9088
 Site-USPS                      (3) | Val  Loss: 0.3314 | Val  Acc: 0.8942
 Site-USPS                      (3) | Val  Loss: 0.4362 | Val  Acc: 0.8526
 Site-USPS                      (3) | Val  Loss: 0.4767 | Val  Acc: 0.8419
 Site-SynthDigits               (6) | Val  Loss: 0.8898 | Val  Acc: 0.7803
 Site-SynthDigits               (1) | Val  Loss: 0.5879 | Val  Acc: 0.8081
 Site-MNIST_M                   (2) | Val  Loss: 0.9707 | Val  Acc: 0.7045
 Site-MNIST_M                   (2) | Val  Loss: 1.0721 | Val  Acc: 0.6212
 Site-SVHN                      (4) | Val  Loss: 1.2209 | Val  Acc: 0.6164
Average Valid Accuracy: 0.8188
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.8929
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.9167
 Best site-MNIST                    (5)  | Epoch:15 | Val Acc: 0.9127
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.8947
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.9088
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.8942
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.8526
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.8419
 Best site-SynthDigits              (6)  | Epoch:15 | Val Acc: 0.7803
 Best site-SynthDigits              (1)  | Epoch:15 | Val Acc: 0.8081
 Best site-MNIST_M                  (2)  | Epoch:15 | Val Acc: 0.7045
 Best site-MNIST_M                  (2)  | Epoch:15 | Val Acc: 0.6212
 Best site-SVHN                     (4)  | Epoch:15 | Val Acc: 0.6164
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 16 ============
cnt=[1, 5, 2, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (1) | Train Loss: 0.3551 | Train Acc: 0.8844
 Site-MNIST                     (1) | Train Loss: 0.3064 | Train Acc: 0.9231
 Site-MNIST                     (1) | Train Loss: 0.3850 | Train Acc: 0.8974
 Site-MNIST                     (1) | Train Loss: 0.3772 | Train Acc: 0.8830
 Site-MNIST                     (1) | Train Loss: 0.3403 | Train Acc: 0.9186
 Site-USPS                      (5) | Train Loss: 0.4381 | Train Acc: 0.8729
 Site-USPS                      (3) | Train Loss: 0.4059 | Train Acc: 0.8898
 Site-USPS                      (5) | Train Loss: 0.3973 | Train Acc: 0.8956
 Site-SynthDigits               (2) | Train Loss: 0.6566 | Train Acc: 0.8087
 Site-SynthDigits               (2) | Train Loss: 0.5955 | Train Acc: 0.8598
 Site-MNIST_M                   (6) | Train Loss: 0.9870 | Train Acc: 0.7188
 Site-MNIST_M                   (0) | Train Loss: 0.9470 | Train Acc: 0.7235
 Site-SVHN                      (4) | Train Loss: 1.1304 | Train Acc: 0.6422
Average Train Accuracy: 0.8398
 Site-MNIST                     (1) | Val  Loss: 0.3064 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.3025 | Val  Acc: 0.9167
 Site-MNIST                     (1) | Val  Loss: 0.3349 | Val  Acc: 0.9127
 Site-MNIST                     (1) | Val  Loss: 0.4059 | Val  Acc: 0.9053
 Site-MNIST                     (1) | Val  Loss: 0.3568 | Val  Acc: 0.9193
 Site-USPS                      (5) | Val  Loss: 0.3226 | Val  Acc: 0.9135
 Site-USPS                      (3) | Val  Loss: 0.4226 | Val  Acc: 0.8654
 Site-USPS                      (5) | Val  Loss: 0.4695 | Val  Acc: 0.8504
 Site-SynthDigits               (2) | Val  Loss: 0.8178 | Val  Acc: 0.7652
 Site-SynthDigits               (2) | Val  Loss: 0.5638 | Val  Acc: 0.8182
 Site-MNIST_M                   (6) | Val  Loss: 0.9544 | Val  Acc: 0.7159
 Site-MNIST_M                   (0) | Val  Loss: 1.0262 | Val  Acc: 0.6970
 Site-SVHN                      (4) | Val  Loss: 1.1794 | Val  Acc: 0.6164
Average Valid Accuracy: 0.8313
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9167
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9127
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9053
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9193
 Best site-USPS                     (5)  | Epoch:16 | Val Acc: 0.9135
 Best site-USPS                     (3)  | Epoch:16 | Val Acc: 0.8654
 Best site-USPS                     (5)  | Epoch:16 | Val Acc: 0.8504
 Best site-SynthDigits              (2)  | Epoch:16 | Val Acc: 0.7652
 Best site-SynthDigits              (2)  | Epoch:16 | Val Acc: 0.8182
 Best site-MNIST_M                  (6)  | Epoch:16 | Val Acc: 0.7159
 Best site-MNIST_M                  (0)  | Epoch:16 | Val Acc: 0.6970
 Best site-SVHN                     (4)  | Epoch:16 | Val Acc: 0.6164
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 17 ============
cnt=[1, 2, 3, 2, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (5) | Train Loss: 0.3453 | Train Acc: 0.8933
 Site-MNIST                     (5) | Train Loss: 0.2965 | Train Acc: 0.9290
 Site-MNIST                     (5) | Train Loss: 0.3657 | Train Acc: 0.8994
 Site-MNIST                     (1) | Train Loss: 0.3575 | Train Acc: 0.8975
 Site-MNIST                     (1) | Train Loss: 0.3258 | Train Acc: 0.9212
 Site-USPS                      (2) | Train Loss: 0.4334 | Train Acc: 0.8609
 Site-USPS                      (2) | Train Loss: 0.3951 | Train Acc: 0.8818
 Site-USPS                      (2) | Train Loss: 0.3849 | Train Acc: 0.8988
 Site-SynthDigits               (0) | Train Loss: 0.6343 | Train Acc: 0.8163
 Site-SynthDigits               (6) | Train Loss: 0.5675 | Train Acc: 0.8624
 Site-MNIST_M                   (3) | Train Loss: 0.9349 | Train Acc: 0.7358
 Site-MNIST_M                   (3) | Train Loss: 0.9633 | Train Acc: 0.7348
 Site-SVHN                      (4) | Train Loss: 1.1536 | Train Acc: 0.6422
Average Train Accuracy: 0.8441
 Site-MNIST                     (5) | Val  Loss: 0.2978 | Val  Acc: 0.8929
 Site-MNIST                     (5) | Val  Loss: 0.2909 | Val  Acc: 0.9167
 Site-MNIST                     (5) | Val  Loss: 0.3173 | Val  Acc: 0.9127
 Site-MNIST                     (1) | Val  Loss: 0.3871 | Val  Acc: 0.9105
 Site-MNIST                     (1) | Val  Loss: 0.3379 | Val  Acc: 0.9228
 Site-USPS                      (2) | Val  Loss: 0.3088 | Val  Acc: 0.8942
 Site-USPS                      (2) | Val  Loss: 0.4113 | Val  Acc: 0.8462
 Site-USPS                      (2) | Val  Loss: 0.4610 | Val  Acc: 0.8333
 Site-SynthDigits               (0) | Val  Loss: 0.7802 | Val  Acc: 0.7803
 Site-SynthDigits               (6) | Val  Loss: 0.5385 | Val  Acc: 0.8232
 Site-MNIST_M                   (3) | Val  Loss: 0.9295 | Val  Acc: 0.7273
 Site-MNIST_M                   (3) | Val  Loss: 0.9881 | Val  Acc: 0.6970
 Site-SVHN                      (4) | Val  Loss: 1.1664 | Val  Acc: 0.6027
Average Valid Accuracy: 0.8277
============ Train epoch 18 ============
cnt=[2, 5, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (1) | Train Loss: 0.3273 | Train Acc: 0.8933
 Site-MNIST                     (1) | Train Loss: 0.3066 | Train Acc: 0.9349
 Site-MNIST                     (1) | Train Loss: 0.3535 | Train Acc: 0.9093
 Site-MNIST                     (1) | Train Loss: 0.3485 | Train Acc: 0.9054
 Site-MNIST                     (1) | Train Loss: 0.3142 | Train Acc: 0.9221
 Site-USPS                      (4) | Train Loss: 0.4162 | Train Acc: 0.8777
 Site-USPS                      (6) | Train Loss: 0.3797 | Train Acc: 0.8978
 Site-USPS                      (4) | Train Loss: 0.3741 | Train Acc: 0.9042
 Site-SynthDigits               (0) | Train Loss: 0.6106 | Train Acc: 0.8239
 Site-SynthDigits               (0) | Train Loss: 0.5445 | Train Acc: 0.8712
 Site-MNIST_M                   (5) | Train Loss: 0.9309 | Train Acc: 0.7188
 Site-MNIST_M                   (2) | Train Loss: 0.8588 | Train Acc: 0.7519
 Site-SVHN                      (3) | Train Loss: 1.0943 | Train Acc: 0.6542
Average Train Accuracy: 0.8511
 Site-MNIST                     (1) | Val  Loss: 0.2793 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2745 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.3081 | Val  Acc: 0.9127
 Site-MNIST                     (1) | Val  Loss: 0.3739 | Val  Acc: 0.9105
 Site-MNIST                     (1) | Val  Loss: 0.3267 | Val  Acc: 0.9333
 Site-USPS                      (4) | Val  Loss: 0.2911 | Val  Acc: 0.9231
 Site-USPS                      (6) | Val  Loss: 0.3979 | Val  Acc: 0.8590
 Site-USPS                      (4) | Val  Loss: 0.4490 | Val  Acc: 0.8462
 Site-SynthDigits               (0) | Val  Loss: 0.7437 | Val  Acc: 0.7955
 Site-SynthDigits               (0) | Val  Loss: 0.5123 | Val  Acc: 0.8384
 Site-MNIST_M                   (5) | Val  Loss: 0.9068 | Val  Acc: 0.7159
 Site-MNIST_M                   (2) | Val  Loss: 0.9540 | Val  Acc: 0.7197
 Site-SVHN                      (3) | Val  Loss: 1.1208 | Val  Acc: 0.6301
Average Valid Accuracy: 0.8417
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9127
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9105
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9333
 Best site-USPS                     (4)  | Epoch:18 | Val Acc: 0.9231
 Best site-USPS                     (6)  | Epoch:18 | Val Acc: 0.8590
 Best site-USPS                     (4)  | Epoch:18 | Val Acc: 0.8462
 Best site-SynthDigits              (0)  | Epoch:18 | Val Acc: 0.7955
 Best site-SynthDigits              (0)  | Epoch:18 | Val Acc: 0.8384
 Best site-MNIST_M                  (5)  | Epoch:18 | Val Acc: 0.7159
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.7197
 Best site-SVHN                     (3)  | Epoch:18 | Val Acc: 0.6301
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 19 ============
cnt=[5, 1, 1, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (0) | Train Loss: 0.3056 | Train Acc: 0.9200
 Site-MNIST                     (0) | Train Loss: 0.3181 | Train Acc: 0.9379
 Site-MNIST                     (0) | Train Loss: 0.3275 | Train Acc: 0.9112
 Site-MNIST                     (0) | Train Loss: 0.3285 | Train Acc: 0.9133
 Site-MNIST                     (0) | Train Loss: 0.2902 | Train Acc: 0.9361
 Site-USPS                      (1) | Train Loss: 0.4156 | Train Acc: 0.8801
 Site-USPS                      (5) | Train Loss: 0.3651 | Train Acc: 0.9042
 Site-USPS                      (5) | Train Loss: 0.3583 | Train Acc: 0.9052
 Site-SynthDigits               (3) | Train Loss: 0.6165 | Train Acc: 0.8239
 Site-SynthDigits               (3) | Train Loss: 0.5485 | Train Acc: 0.8737
 Site-MNIST_M                   (6) | Train Loss: 0.8904 | Train Acc: 0.7358
 Site-MNIST_M                   (2) | Train Loss: 0.9010 | Train Acc: 0.7500
 Site-SVHN                      (4) | Train Loss: 1.0535 | Train Acc: 0.6746
Average Train Accuracy: 0.8589
 Site-MNIST                     (0) | Val  Loss: 0.2563 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2495 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2843 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.3495 | Val  Acc: 0.9263
 Site-MNIST                     (0) | Val  Loss: 0.3021 | Val  Acc: 0.9333
 Site-USPS                      (1) | Val  Loss: 0.2784 | Val  Acc: 0.9327
 Site-USPS                      (5) | Val  Loss: 0.3852 | Val  Acc: 0.8846
 Site-USPS                      (5) | Val  Loss: 0.4386 | Val  Acc: 0.8590
 Site-SynthDigits               (3) | Val  Loss: 0.7267 | Val  Acc: 0.7955
 Site-SynthDigits               (3) | Val  Loss: 0.5020 | Val  Acc: 0.8434
 Site-MNIST_M                   (6) | Val  Loss: 0.8975 | Val  Acc: 0.7273
 Site-MNIST_M                   (2) | Val  Loss: 0.9345 | Val  Acc: 0.7197
 Site-SVHN                      (4) | Val  Loss: 1.0967 | Val  Acc: 0.6507
Average Valid Accuracy: 0.8506
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9263
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9333
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.9327
 Best site-USPS                     (5)  | Epoch:19 | Val Acc: 0.8846
 Best site-USPS                     (5)  | Epoch:19 | Val Acc: 0.8590
 Best site-SynthDigits              (3)  | Epoch:19 | Val Acc: 0.7955
 Best site-SynthDigits              (3)  | Epoch:19 | Val Acc: 0.8434
 Best site-MNIST_M                  (6)  | Epoch:19 | Val Acc: 0.7273
 Best site-MNIST_M                  (2)  | Epoch:19 | Val Acc: 0.7197
 Best site-SVHN                     (4)  | Epoch:19 | Val Acc: 0.6507
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 20 ============
cnt=[5, 1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (0) | Train Loss: 0.3058 | Train Acc: 0.9156
 Site-MNIST                     (0) | Train Loss: 0.2684 | Train Acc: 0.9467
 Site-MNIST                     (0) | Train Loss: 0.3234 | Train Acc: 0.9073
 Site-MNIST                     (0) | Train Loss: 0.3191 | Train Acc: 0.9120
 Site-MNIST                     (0) | Train Loss: 0.2843 | Train Acc: 0.9370
 Site-USPS                      (6) | Train Loss: 0.3797 | Train Acc: 0.8801
 Site-USPS                      (3) | Train Loss: 0.3548 | Train Acc: 0.9010
 Site-USPS                      (3) | Train Loss: 0.3487 | Train Acc: 0.9042
 Site-SynthDigits               (5) | Train Loss: 0.5588 | Train Acc: 0.8485
 Site-SynthDigits               (1) | Train Loss: 0.5128 | Train Acc: 0.8725
 Site-MNIST_M                   (2) | Train Loss: 0.8606 | Train Acc: 0.7415
 Site-MNIST_M                   (2) | Train Loss: 0.8471 | Train Acc: 0.7614
 Site-SVHN                      (4) | Train Loss: 1.0470 | Train Acc: 0.6661
Average Train Accuracy: 0.8610
 Site-MNIST                     (0) | Val  Loss: 0.2535 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2493 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2764 | Val  Acc: 0.9127
 Site-MNIST                     (0) | Val  Loss: 0.3437 | Val  Acc: 0.9211
 Site-MNIST                     (0) | Val  Loss: 0.2951 | Val  Acc: 0.9474
 Site-USPS                      (6) | Val  Loss: 0.2736 | Val  Acc: 0.9327
 Site-USPS                      (3) | Val  Loss: 0.3715 | Val  Acc: 0.8654
 Site-USPS                      (3) | Val  Loss: 0.4229 | Val  Acc: 0.8504
 Site-SynthDigits               (5) | Val  Loss: 0.6781 | Val  Acc: 0.8258
 Site-SynthDigits               (1) | Val  Loss: 0.4755 | Val  Acc: 0.8636
 Site-MNIST_M                   (2) | Val  Loss: 0.8553 | Val  Acc: 0.7273
 Site-MNIST_M                   (2) | Val  Loss: 0.8932 | Val  Acc: 0.7348
 Site-SVHN                      (4) | Val  Loss: 1.1122 | Val  Acc: 0.6164
Average Valid Accuracy: 0.8504
============ Train epoch 21 ============
cnt=[2, 1, 3, 1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (6) | Train Loss: 0.2927 | Train Acc: 0.9111
 Site-MNIST                     (0) | Train Loss: 0.2614 | Train Acc: 0.9497
 Site-MNIST                     (6) | Train Loss: 0.3134 | Train Acc: 0.9132
 Site-MNIST                     (0) | Train Loss: 0.3111 | Train Acc: 0.9172
 Site-MNIST                     (6) | Train Loss: 0.2726 | Train Acc: 0.9405
 Site-USPS                      (2) | Train Loss: 0.3701 | Train Acc: 0.8897
 Site-USPS                      (2) | Train Loss: 0.3406 | Train Acc: 0.9105
 Site-USPS                      (2) | Train Loss: 0.3338 | Train Acc: 0.9105
 Site-SynthDigits               (4) | Train Loss: 0.5521 | Train Acc: 0.8352
 Site-SynthDigits               (4) | Train Loss: 0.5080 | Train Acc: 0.8750
 Site-MNIST_M                   (5) | Train Loss: 0.8230 | Train Acc: 0.7614
 Site-MNIST_M                   (3) | Train Loss: 0.8605 | Train Acc: 0.7595
 Site-SVHN                      (1) | Train Loss: 0.9920 | Train Acc: 0.6695
Average Train Accuracy: 0.8648
 Site-MNIST                     (6) | Val  Loss: 0.2381 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2393 | Val  Acc: 0.9286
 Site-MNIST                     (6) | Val  Loss: 0.2711 | Val  Acc: 0.9206
 Site-MNIST                     (0) | Val  Loss: 0.3385 | Val  Acc: 0.9263
 Site-MNIST                     (6) | Val  Loss: 0.2871 | Val  Acc: 0.9439
 Site-USPS                      (2) | Val  Loss: 0.2560 | Val  Acc: 0.9327
 Site-USPS                      (2) | Val  Loss: 0.3584 | Val  Acc: 0.8718
 Site-USPS                      (2) | Val  Loss: 0.4129 | Val  Acc: 0.8590
 Site-SynthDigits               (4) | Val  Loss: 0.7006 | Val  Acc: 0.8030
 Site-SynthDigits               (4) | Val  Loss: 0.4729 | Val  Acc: 0.8586
 Site-MNIST_M                   (5) | Val  Loss: 0.8506 | Val  Acc: 0.7159
 Site-MNIST_M                   (3) | Val  Loss: 0.8793 | Val  Acc: 0.7273
 Site-SVHN                      (1) | Val  Loss: 1.0833 | Val  Acc: 0.6507
Average Valid Accuracy: 0.8513
 Best site-MNIST                    (6)  | Epoch:21 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:21 | Val Acc: 0.9286
 Best site-MNIST                    (6)  | Epoch:21 | Val Acc: 0.9206
 Best site-MNIST                    (0)  | Epoch:21 | Val Acc: 0.9263
 Best site-MNIST                    (6)  | Epoch:21 | Val Acc: 0.9439
 Best site-USPS                     (2)  | Epoch:21 | Val Acc: 0.9327
 Best site-USPS                     (2)  | Epoch:21 | Val Acc: 0.8718
 Best site-USPS                     (2)  | Epoch:21 | Val Acc: 0.8590
 Best site-SynthDigits              (4)  | Epoch:21 | Val Acc: 0.8030
 Best site-SynthDigits              (4)  | Epoch:21 | Val Acc: 0.8586
 Best site-MNIST_M                  (5)  | Epoch:21 | Val Acc: 0.7159
 Best site-MNIST_M                  (3)  | Epoch:21 | Val Acc: 0.7273
 Best site-SVHN                     (1)  | Epoch:21 | Val Acc: 0.6507
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 22 ============
cnt=[1, 1, 5, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (2) | Train Loss: 0.2921 | Train Acc: 0.9067
 Site-MNIST                     (2) | Train Loss: 0.2612 | Train Acc: 0.9438
 Site-MNIST                     (2) | Train Loss: 0.3094 | Train Acc: 0.9132
 Site-MNIST                     (2) | Train Loss: 0.3101 | Train Acc: 0.9159
 Site-MNIST                     (2) | Train Loss: 0.2690 | Train Acc: 0.9387
 Site-USPS                      (1) | Train Loss: 0.3680 | Train Acc: 0.8777
 Site-USPS                      (5) | Train Loss: 0.3393 | Train Acc: 0.9153
 Site-USPS                      (5) | Train Loss: 0.3323 | Train Acc: 0.9116
 Site-SynthDigits               (3) | Train Loss: 0.5681 | Train Acc: 0.8598
 Site-SynthDigits               (3) | Train Loss: 0.4889 | Train Acc: 0.8801
 Site-MNIST_M                   (0) | Train Loss: 0.8065 | Train Acc: 0.7557
 Site-MNIST_M                   (6) | Train Loss: 0.8136 | Train Acc: 0.7822
 Site-SVHN                      (4) | Train Loss: 1.0336 | Train Acc: 0.6746
Average Train Accuracy: 0.8673
 Site-MNIST                     (2) | Val  Loss: 0.2400 | Val  Acc: 0.9464
 Site-MNIST                     (2) | Val  Loss: 0.2351 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2700 | Val  Acc: 0.9206
 Site-MNIST                     (2) | Val  Loss: 0.3352 | Val  Acc: 0.9263
 Site-MNIST                     (2) | Val  Loss: 0.2858 | Val  Acc: 0.9368
 Site-USPS                      (1) | Val  Loss: 0.2550 | Val  Acc: 0.9327
 Site-USPS                      (5) | Val  Loss: 0.3592 | Val  Acc: 0.8718
 Site-USPS                      (5) | Val  Loss: 0.4087 | Val  Acc: 0.8504
 Site-SynthDigits               (3) | Val  Loss: 0.6432 | Val  Acc: 0.8409
 Site-SynthDigits               (3) | Val  Loss: 0.4492 | Val  Acc: 0.8737
 Site-MNIST_M                   (0) | Val  Loss: 0.8218 | Val  Acc: 0.7500
 Site-MNIST_M                   (6) | Val  Loss: 0.8467 | Val  Acc: 0.7348
 Site-SVHN                      (4) | Val  Loss: 1.0744 | Val  Acc: 0.6575
Average Valid Accuracy: 0.8593
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9464
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9206
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9263
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9368
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 0.9327
 Best site-USPS                     (5)  | Epoch:22 | Val Acc: 0.8718
 Best site-USPS                     (5)  | Epoch:22 | Val Acc: 0.8504
 Best site-SynthDigits              (3)  | Epoch:22 | Val Acc: 0.8409
 Best site-SynthDigits              (3)  | Epoch:22 | Val Acc: 0.8737
 Best site-MNIST_M                  (0)  | Epoch:22 | Val Acc: 0.7500
 Best site-MNIST_M                  (6)  | Epoch:22 | Val Acc: 0.7348
 Best site-SVHN                     (4)  | Epoch:22 | Val Acc: 0.6575
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 23 ============
cnt=[3, 1, 1, 1, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (5) | Train Loss: 0.2852 | Train Acc: 0.9111
 Site-MNIST                     (5) | Train Loss: 0.2721 | Train Acc: 0.9349
 Site-MNIST                     (2) | Train Loss: 0.3100 | Train Acc: 0.9152
 Site-MNIST                     (5) | Train Loss: 0.3084 | Train Acc: 0.9120
 Site-MNIST                     (5) | Train Loss: 0.2694 | Train Acc: 0.9387
 Site-USPS                      (0) | Train Loss: 0.3538 | Train Acc: 0.8945
 Site-USPS                      (0) | Train Loss: 0.3262 | Train Acc: 0.9201
 Site-USPS                      (0) | Train Loss: 0.3209 | Train Acc: 0.9105
 Site-SynthDigits               (4) | Train Loss: 0.5076 | Train Acc: 0.8598
 Site-SynthDigits               (4) | Train Loss: 0.4645 | Train Acc: 0.8889
 Site-MNIST_M                   (1) | Train Loss: 0.8350 | Train Acc: 0.7557
 Site-MNIST_M                   (6) | Train Loss: 0.8242 | Train Acc: 0.7727
 Site-SVHN                      (3) | Train Loss: 0.9991 | Train Acc: 0.6865
Average Train Accuracy: 0.8693
 Site-MNIST                     (5) | Val  Loss: 0.2411 | Val  Acc: 0.9464
 Site-MNIST                     (5) | Val  Loss: 0.2386 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2691 | Val  Acc: 0.9286
 Site-MNIST                     (5) | Val  Loss: 0.3341 | Val  Acc: 0.9263
 Site-MNIST                     (5) | Val  Loss: 0.2832 | Val  Acc: 0.9333
 Site-USPS                      (0) | Val  Loss: 0.2526 | Val  Acc: 0.9327
 Site-USPS                      (0) | Val  Loss: 0.3395 | Val  Acc: 0.8846
 Site-USPS                      (0) | Val  Loss: 0.3922 | Val  Acc: 0.8462
 Site-SynthDigits               (4) | Val  Loss: 0.6313 | Val  Acc: 0.8182
 Site-SynthDigits               (4) | Val  Loss: 0.4345 | Val  Acc: 0.8788
 Site-MNIST_M                   (1) | Val  Loss: 0.8513 | Val  Acc: 0.7386
 Site-MNIST_M                   (6) | Val  Loss: 0.8719 | Val  Acc: 0.7424
 Site-SVHN                      (3) | Val  Loss: 1.0324 | Val  Acc: 0.6644
Average Valid Accuracy: 0.8592
============ Train epoch 24 ============
cnt=[1, 1, 3, 2, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (5) | Train Loss: 0.2746 | Train Acc: 0.9111
 Site-MNIST                     (5) | Train Loss: 0.2465 | Train Acc: 0.9379
 Site-MNIST                     (1) | Train Loss: 0.3007 | Train Acc: 0.9191
 Site-MNIST                     (5) | Train Loss: 0.3036 | Train Acc: 0.9146
 Site-MNIST                     (5) | Train Loss: 0.2626 | Train Acc: 0.9387
 Site-USPS                      (2) | Train Loss: 0.3594 | Train Acc: 0.8897
 Site-USPS                      (2) | Train Loss: 0.3144 | Train Acc: 0.9201
 Site-USPS                      (2) | Train Loss: 0.3104 | Train Acc: 0.9116
 Site-SynthDigits               (3) | Train Loss: 0.5044 | Train Acc: 0.8636
 Site-SynthDigits               (3) | Train Loss: 0.4605 | Train Acc: 0.8914
 Site-MNIST_M                   (6) | Train Loss: 0.7704 | Train Acc: 0.7727
 Site-MNIST_M                   (0) | Train Loss: 0.7572 | Train Acc: 0.7955
 Site-SVHN                      (4) | Train Loss: 0.9958 | Train Acc: 0.6797
Average Train Accuracy: 0.8728
 Site-MNIST                     (5) | Val  Loss: 0.2322 | Val  Acc: 0.9464
 Site-MNIST                     (5) | Val  Loss: 0.2323 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2645 | Val  Acc: 0.9206
 Site-MNIST                     (5) | Val  Loss: 0.3245 | Val  Acc: 0.9263
 Site-MNIST                     (5) | Val  Loss: 0.2758 | Val  Acc: 0.9368
 Site-USPS                      (2) | Val  Loss: 0.2368 | Val  Acc: 0.9327
 Site-USPS                      (2) | Val  Loss: 0.3272 | Val  Acc: 0.8974
 Site-USPS                      (2) | Val  Loss: 0.3795 | Val  Acc: 0.8547
 Site-SynthDigits               (3) | Val  Loss: 0.6167 | Val  Acc: 0.8409
 Site-SynthDigits               (3) | Val  Loss: 0.4202 | Val  Acc: 0.8889
 Site-MNIST_M                   (6) | Val  Loss: 0.8157 | Val  Acc: 0.7500
 Site-MNIST_M                   (0) | Val  Loss: 0.8410 | Val  Acc: 0.7576
 Site-SVHN                      (4) | Val  Loss: 1.0198 | Val  Acc: 0.6575
Average Valid Accuracy: 0.8645
 Best site-MNIST                    (5)  | Epoch:24 | Val Acc: 0.9464
 Best site-MNIST                    (5)  | Epoch:24 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9206
 Best site-MNIST                    (5)  | Epoch:24 | Val Acc: 0.9263
 Best site-MNIST                    (5)  | Epoch:24 | Val Acc: 0.9368
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.9327
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.8974
 Best site-USPS                     (2)  | Epoch:24 | Val Acc: 0.8547
 Best site-SynthDigits              (3)  | Epoch:24 | Val Acc: 0.8409
 Best site-SynthDigits              (3)  | Epoch:24 | Val Acc: 0.8889
 Best site-MNIST_M                  (6)  | Epoch:24 | Val Acc: 0.7500
 Best site-MNIST_M                  (0)  | Epoch:24 | Val Acc: 0.7576
 Best site-SVHN                     (4)  | Epoch:24 | Val Acc: 0.6575
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 25 ============
cnt=[5, 1, 1, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (0) | Train Loss: 0.2574 | Train Acc: 0.9156
 Site-MNIST                     (0) | Train Loss: 0.2285 | Train Acc: 0.9467
 Site-MNIST                     (0) | Train Loss: 0.2914 | Train Acc: 0.9172
 Site-MNIST                     (0) | Train Loss: 0.2909 | Train Acc: 0.9212
 Site-MNIST                     (0) | Train Loss: 0.2505 | Train Acc: 0.9431
 Site-USPS                      (5) | Train Loss: 0.3388 | Train Acc: 0.8897
 Site-USPS                      (1) | Train Loss: 0.3119 | Train Acc: 0.9121
 Site-USPS                      (5) | Train Loss: 0.3095 | Train Acc: 0.9169
 Site-SynthDigits               (3) | Train Loss: 0.4969 | Train Acc: 0.8712
 Site-SynthDigits               (3) | Train Loss: 0.4373 | Train Acc: 0.8965
 Site-MNIST_M                   (2) | Train Loss: 0.7662 | Train Acc: 0.7812
 Site-MNIST_M                   (6) | Train Loss: 0.7723 | Train Acc: 0.7898
 Site-SVHN                      (4) | Train Loss: 0.8980 | Train Acc: 0.6968
Average Train Accuracy: 0.8768
 Site-MNIST                     (0) | Val  Loss: 0.2247 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2274 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2512 | Val  Acc: 0.9206
 Site-MNIST                     (0) | Val  Loss: 0.3137 | Val  Acc: 0.9316
 Site-MNIST                     (0) | Val  Loss: 0.2658 | Val  Acc: 0.9474
 Site-USPS                      (5) | Val  Loss: 0.2342 | Val  Acc: 0.9327
 Site-USPS                      (1) | Val  Loss: 0.3223 | Val  Acc: 0.8782
 Site-USPS                      (5) | Val  Loss: 0.3758 | Val  Acc: 0.8632
 Site-SynthDigits               (3) | Val  Loss: 0.6010 | Val  Acc: 0.8712
 Site-SynthDigits               (3) | Val  Loss: 0.4118 | Val  Acc: 0.8939
 Site-MNIST_M                   (2) | Val  Loss: 0.8190 | Val  Acc: 0.7500
 Site-MNIST_M                   (6) | Val  Loss: 0.8356 | Val  Acc: 0.7500
 Site-SVHN                      (4) | Val  Loss: 0.9662 | Val  Acc: 0.6781
Average Valid Accuracy: 0.8672
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.9206
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.9316
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.9474
 Best site-USPS                     (5)  | Epoch:25 | Val Acc: 0.9327
 Best site-USPS                     (1)  | Epoch:25 | Val Acc: 0.8782
 Best site-USPS                     (5)  | Epoch:25 | Val Acc: 0.8632
 Best site-SynthDigits              (3)  | Epoch:25 | Val Acc: 0.8712
 Best site-SynthDigits              (3)  | Epoch:25 | Val Acc: 0.8939
 Best site-MNIST_M                  (2)  | Epoch:25 | Val Acc: 0.7500
 Best site-MNIST_M                  (6)  | Epoch:25 | Val Acc: 0.7500
 Best site-SVHN                     (4)  | Epoch:25 | Val Acc: 0.6781
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 26 ============
cnt=[3, 2, 1, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (6) | Train Loss: 0.2666 | Train Acc: 0.9111
 Site-MNIST                     (0) | Train Loss: 0.2443 | Train Acc: 0.9379
 Site-MNIST                     (0) | Train Loss: 0.2895 | Train Acc: 0.9191
 Site-MNIST                     (0) | Train Loss: 0.2941 | Train Acc: 0.9146
 Site-MNIST                     (6) | Train Loss: 0.2507 | Train Acc: 0.9413
 Site-USPS                      (3) | Train Loss: 0.3362 | Train Acc: 0.8969
 Site-USPS                      (3) | Train Loss: 0.3030 | Train Acc: 0.9233
 Site-USPS                      (3) | Train Loss: 0.2975 | Train Acc: 0.9159
 Site-SynthDigits               (5) | Train Loss: 0.4843 | Train Acc: 0.8693
 Site-SynthDigits               (2) | Train Loss: 0.4302 | Train Acc: 0.8965
 Site-MNIST_M                   (1) | Train Loss: 0.7597 | Train Acc: 0.7841
 Site-MNIST_M                   (1) | Train Loss: 0.7397 | Train Acc: 0.7973
 Site-SVHN                      (4) | Train Loss: 0.9535 | Train Acc: 0.7121
Average Train Accuracy: 0.8784
 Site-MNIST                     (6) | Val  Loss: 0.2222 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.2271 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2531 | Val  Acc: 0.9206
 Site-MNIST                     (0) | Val  Loss: 0.3113 | Val  Acc: 0.9263
 Site-MNIST                     (6) | Val  Loss: 0.2644 | Val  Acc: 0.9404
 Site-USPS                      (3) | Val  Loss: 0.2233 | Val  Acc: 0.9327
 Site-USPS                      (3) | Val  Loss: 0.3128 | Val  Acc: 0.8974
 Site-USPS                      (3) | Val  Loss: 0.3648 | Val  Acc: 0.8590
 Site-SynthDigits               (5) | Val  Loss: 0.5681 | Val  Acc: 0.8712
 Site-SynthDigits               (2) | Val  Loss: 0.3980 | Val  Acc: 0.8889
 Site-MNIST_M                   (1) | Val  Loss: 0.7950 | Val  Acc: 0.7500
 Site-MNIST_M                   (1) | Val  Loss: 0.8129 | Val  Acc: 0.7727
 Site-SVHN                      (4) | Val  Loss: 0.9618 | Val  Acc: 0.7260
Average Valid Accuracy: 0.8739
 Best site-MNIST                    (6)  | Epoch:26 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.9206
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.9263
 Best site-MNIST                    (6)  | Epoch:26 | Val Acc: 0.9404
 Best site-USPS                     (3)  | Epoch:26 | Val Acc: 0.9327
 Best site-USPS                     (3)  | Epoch:26 | Val Acc: 0.8974
 Best site-USPS                     (3)  | Epoch:26 | Val Acc: 0.8590
 Best site-SynthDigits              (5)  | Epoch:26 | Val Acc: 0.8712
 Best site-SynthDigits              (2)  | Epoch:26 | Val Acc: 0.8889
 Best site-MNIST_M                  (1)  | Epoch:26 | Val Acc: 0.7500
 Best site-MNIST_M                  (1)  | Epoch:26 | Val Acc: 0.7727
 Best site-SVHN                     (4)  | Epoch:26 | Val Acc: 0.7260
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 27 ============
cnt=[1, 1, 5, 2, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (2) | Train Loss: 0.2485 | Train Acc: 0.9289
 Site-MNIST                     (2) | Train Loss: 0.2255 | Train Acc: 0.9527
 Site-MNIST                     (2) | Train Loss: 0.2744 | Train Acc: 0.9191
 Site-MNIST                     (2) | Train Loss: 0.2820 | Train Acc: 0.9198
 Site-MNIST                     (2) | Train Loss: 0.2399 | Train Acc: 0.9448
 Site-USPS                      (6) | Train Loss: 0.3378 | Train Acc: 0.8873
 Site-USPS                      (6) | Train Loss: 0.2972 | Train Acc: 0.9137
 Site-USPS                      (0) | Train Loss: 0.2925 | Train Acc: 0.9159
 Site-SynthDigits               (3) | Train Loss: 0.4983 | Train Acc: 0.8617
 Site-SynthDigits               (3) | Train Loss: 0.4229 | Train Acc: 0.9066
 Site-MNIST_M                   (1) | Train Loss: 0.7594 | Train Acc: 0.7841
 Site-MNIST_M                   (5) | Train Loss: 0.7105 | Train Acc: 0.7879
 Site-SVHN                      (4) | Train Loss: 0.8930 | Train Acc: 0.7274
Average Train Accuracy: 0.8808
 Site-MNIST                     (2) | Val  Loss: 0.2087 | Val  Acc: 0.9464
 Site-MNIST                     (2) | Val  Loss: 0.2135 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2434 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2984 | Val  Acc: 0.9263
 Site-MNIST                     (2) | Val  Loss: 0.2538 | Val  Acc: 0.9404
 Site-USPS                      (6) | Val  Loss: 0.2138 | Val  Acc: 0.9327
 Site-USPS                      (6) | Val  Loss: 0.3049 | Val  Acc: 0.8910
 Site-USPS                      (0) | Val  Loss: 0.3634 | Val  Acc: 0.8590
 Site-SynthDigits               (3) | Val  Loss: 0.5696 | Val  Acc: 0.8636
 Site-SynthDigits               (3) | Val  Loss: 0.3890 | Val  Acc: 0.9040
 Site-MNIST_M                   (1) | Val  Loss: 0.7992 | Val  Acc: 0.7614
 Site-MNIST_M                   (5) | Val  Loss: 0.8070 | Val  Acc: 0.7652
 Site-SVHN                      (4) | Val  Loss: 0.9170 | Val  Acc: 0.7123
Average Valid Accuracy: 0.8738
============ Train epoch 28 ============
cnt=[5, 1, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (0) | Train Loss: 0.2592 | Train Acc: 0.9156
 Site-MNIST                     (0) | Train Loss: 0.2409 | Train Acc: 0.9379
 Site-MNIST                     (0) | Train Loss: 0.2790 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.2839 | Train Acc: 0.9106
 Site-MNIST                     (0) | Train Loss: 0.2429 | Train Acc: 0.9378
 Site-USPS                      (3) | Train Loss: 0.3399 | Train Acc: 0.8993
 Site-USPS                      (3) | Train Loss: 0.2917 | Train Acc: 0.9217
 Site-USPS                      (3) | Train Loss: 0.2844 | Train Acc: 0.9159
 Site-SynthDigits               (1) | Train Loss: 0.4755 | Train Acc: 0.8731
 Site-SynthDigits               (5) | Train Loss: 0.4125 | Train Acc: 0.9066
 Site-MNIST_M                   (6) | Train Loss: 0.7003 | Train Acc: 0.7955
 Site-MNIST_M                   (2) | Train Loss: 0.7182 | Train Acc: 0.8106
 Site-SVHN                      (4) | Train Loss: 0.8617 | Train Acc: 0.7394
Average Train Accuracy: 0.8835
 Site-MNIST                     (0) | Val  Loss: 0.2132 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.2198 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2498 | Val  Acc: 0.9206
 Site-MNIST                     (0) | Val  Loss: 0.3019 | Val  Acc: 0.9211
 Site-MNIST                     (0) | Val  Loss: 0.2557 | Val  Acc: 0.9404
 Site-USPS                      (3) | Val  Loss: 0.2106 | Val  Acc: 0.9423
 Site-USPS                      (3) | Val  Loss: 0.2979 | Val  Acc: 0.9038
 Site-USPS                      (3) | Val  Loss: 0.3523 | Val  Acc: 0.8590
 Site-SynthDigits               (1) | Val  Loss: 0.5577 | Val  Acc: 0.8788
 Site-SynthDigits               (5) | Val  Loss: 0.3802 | Val  Acc: 0.8990
 Site-MNIST_M                   (6) | Val  Loss: 0.7644 | Val  Acc: 0.7841
 Site-MNIST_M                   (2) | Val  Loss: 0.7920 | Val  Acc: 0.7727
 Site-SVHN                      (4) | Val  Loss: 0.9066 | Val  Acc: 0.7123
Average Valid Accuracy: 0.8776
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.9206
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.9211
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.9404
 Best site-USPS                     (3)  | Epoch:28 | Val Acc: 0.9423
 Best site-USPS                     (3)  | Epoch:28 | Val Acc: 0.9038
 Best site-USPS                     (3)  | Epoch:28 | Val Acc: 0.8590
 Best site-SynthDigits              (1)  | Epoch:28 | Val Acc: 0.8788
 Best site-SynthDigits              (5)  | Epoch:28 | Val Acc: 0.8990
 Best site-MNIST_M                  (6)  | Epoch:28 | Val Acc: 0.7841
 Best site-MNIST_M                  (2)  | Epoch:28 | Val Acc: 0.7727
 Best site-SVHN                     (4)  | Epoch:28 | Val Acc: 0.7123
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 29 ============
cnt=[4, 2, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (0) | Train Loss: 0.2690 | Train Acc: 0.9244
 Site-MNIST                     (0) | Train Loss: 0.2128 | Train Acc: 0.9497
 Site-MNIST                     (0) | Train Loss: 0.2649 | Train Acc: 0.9270
 Site-MNIST                     (0) | Train Loss: 0.2745 | Train Acc: 0.9198
 Site-MNIST                     (6) | Train Loss: 0.2341 | Train Acc: 0.9440
 Site-USPS                      (5) | Train Loss: 0.3090 | Train Acc: 0.9065
 Site-USPS                      (1) | Train Loss: 0.2811 | Train Acc: 0.9265
 Site-USPS                      (1) | Train Loss: 0.2755 | Train Acc: 0.9255
 Site-SynthDigits               (3) | Train Loss: 0.4714 | Train Acc: 0.8750
 Site-SynthDigits               (3) | Train Loss: 0.3972 | Train Acc: 0.9040
 Site-MNIST_M                   (2) | Train Loss: 0.7026 | Train Acc: 0.7983
 Site-MNIST_M                   (2) | Train Loss: 0.6715 | Train Acc: 0.8125
 Site-SVHN                      (4) | Train Loss: 0.8483 | Train Acc: 0.7257
Average Train Accuracy: 0.8876
 Site-MNIST                     (0) | Val  Loss: 0.2048 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.2105 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2395 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2882 | Val  Acc: 0.9316
 Site-MNIST                     (6) | Val  Loss: 0.2435 | Val  Acc: 0.9404
 Site-USPS                      (5) | Val  Loss: 0.1971 | Val  Acc: 0.9327
 Site-USPS                      (1) | Val  Loss: 0.2878 | Val  Acc: 0.8910
 Site-USPS                      (1) | Val  Loss: 0.3423 | Val  Acc: 0.8632
 Site-SynthDigits               (3) | Val  Loss: 0.5439 | Val  Acc: 0.8712
 Site-SynthDigits               (3) | Val  Loss: 0.3708 | Val  Acc: 0.9091
 Site-MNIST_M                   (2) | Val  Loss: 0.7474 | Val  Acc: 0.7727
 Site-MNIST_M                   (2) | Val  Loss: 0.7546 | Val  Acc: 0.7879
 Site-SVHN                      (4) | Val  Loss: 0.8929 | Val  Acc: 0.7329
Average Valid Accuracy: 0.8797
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9316
 Best site-MNIST                    (6)  | Epoch:29 | Val Acc: 0.9404
 Best site-USPS                     (5)  | Epoch:29 | Val Acc: 0.9327
 Best site-USPS                     (1)  | Epoch:29 | Val Acc: 0.8910
 Best site-USPS                     (1)  | Epoch:29 | Val Acc: 0.8632
 Best site-SynthDigits              (3)  | Epoch:29 | Val Acc: 0.8712
 Best site-SynthDigits              (3)  | Epoch:29 | Val Acc: 0.9091
 Best site-MNIST_M                  (2)  | Epoch:29 | Val Acc: 0.7727
 Best site-MNIST_M                  (2)  | Epoch:29 | Val Acc: 0.7879
 Best site-SVHN                     (4)  | Epoch:29 | Val Acc: 0.7329
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 30 ============
cnt=[1, 5, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (1) | Train Loss: 0.2456 | Train Acc: 0.9156
 Site-MNIST                     (1) | Train Loss: 0.2274 | Train Acc: 0.9497
 Site-MNIST                     (1) | Train Loss: 0.2661 | Train Acc: 0.9172
 Site-MNIST                     (1) | Train Loss: 0.2738 | Train Acc: 0.9159
 Site-MNIST                     (1) | Train Loss: 0.2302 | Train Acc: 0.9413
 Site-USPS                      (3) | Train Loss: 0.3043 | Train Acc: 0.9041
 Site-USPS                      (3) | Train Loss: 0.2798 | Train Acc: 0.9233
 Site-USPS                      (3) | Train Loss: 0.2743 | Train Acc: 0.9255
 Site-SynthDigits               (2) | Train Loss: 0.4477 | Train Acc: 0.8788
 Site-SynthDigits               (6) | Train Loss: 0.3974 | Train Acc: 0.9116
 Site-MNIST_M                   (0) | Train Loss: 0.6920 | Train Acc: 0.8040
 Site-MNIST_M                   (5) | Train Loss: 0.7006 | Train Acc: 0.8220
 Site-SVHN                      (4) | Train Loss: 0.8548 | Train Acc: 0.7342
Average Train Accuracy: 0.8879
 Site-MNIST                     (1) | Val  Loss: 0.1982 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2042 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2415 | Val  Acc: 0.9206
 Site-MNIST                     (1) | Val  Loss: 0.2894 | Val  Acc: 0.9211
 Site-MNIST                     (1) | Val  Loss: 0.2432 | Val  Acc: 0.9439
 Site-USPS                      (3) | Val  Loss: 0.1958 | Val  Acc: 0.9423
 Site-USPS                      (3) | Val  Loss: 0.2854 | Val  Acc: 0.8974
 Site-USPS                      (3) | Val  Loss: 0.3396 | Val  Acc: 0.8590
 Site-SynthDigits               (2) | Val  Loss: 0.5137 | Val  Acc: 0.8939
 Site-SynthDigits               (6) | Val  Loss: 0.3561 | Val  Acc: 0.9141
 Site-MNIST_M                   (0) | Val  Loss: 0.7347 | Val  Acc: 0.8182
 Site-MNIST_M                   (5) | Val  Loss: 0.7539 | Val  Acc: 0.7955
 Site-SVHN                      (4) | Val  Loss: 0.8855 | Val  Acc: 0.7260
Average Valid Accuracy: 0.8852
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9206
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9211
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9439
 Best site-USPS                     (3)  | Epoch:30 | Val Acc: 0.9423
 Best site-USPS                     (3)  | Epoch:30 | Val Acc: 0.8974
 Best site-USPS                     (3)  | Epoch:30 | Val Acc: 0.8590
 Best site-SynthDigits              (2)  | Epoch:30 | Val Acc: 0.8939
 Best site-SynthDigits              (6)  | Epoch:30 | Val Acc: 0.9141
 Best site-MNIST_M                  (0)  | Epoch:30 | Val Acc: 0.8182
 Best site-MNIST_M                  (5)  | Epoch:30 | Val Acc: 0.7955
 Best site-SVHN                     (4)  | Epoch:30 | Val Acc: 0.7260
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 31 ============
cnt=[5, 1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (0) | Train Loss: 0.2683 | Train Acc: 0.9200
 Site-MNIST                     (0) | Train Loss: 0.2372 | Train Acc: 0.9408
 Site-MNIST                     (0) | Train Loss: 0.2635 | Train Acc: 0.9231
 Site-MNIST                     (0) | Train Loss: 0.2764 | Train Acc: 0.9159
 Site-MNIST                     (0) | Train Loss: 0.2318 | Train Acc: 0.9396
 Site-USPS                      (6) | Train Loss: 0.2969 | Train Acc: 0.9161
 Site-USPS                      (3) | Train Loss: 0.2696 | Train Acc: 0.9233
 Site-USPS                      (3) | Train Loss: 0.2720 | Train Acc: 0.9255
 Site-SynthDigits               (1) | Train Loss: 0.4545 | Train Acc: 0.8845
 Site-SynthDigits               (5) | Train Loss: 0.3923 | Train Acc: 0.9066
 Site-MNIST_M                   (2) | Train Loss: 0.6741 | Train Acc: 0.8011
 Site-MNIST_M                   (2) | Train Loss: 0.6686 | Train Acc: 0.8182
 Site-SVHN                      (4) | Train Loss: 0.8275 | Train Acc: 0.7411
Average Train Accuracy: 0.8889
 Site-MNIST                     (0) | Val  Loss: 0.2002 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.2048 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2411 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2868 | Val  Acc: 0.9211
 Site-MNIST                     (0) | Val  Loss: 0.2416 | Val  Acc: 0.9439
 Site-USPS                      (6) | Val  Loss: 0.1933 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.2751 | Val  Acc: 0.9038
 Site-USPS                      (3) | Val  Loss: 0.3255 | Val  Acc: 0.8632
 Site-SynthDigits               (1) | Val  Loss: 0.5236 | Val  Acc: 0.8712
 Site-SynthDigits               (5) | Val  Loss: 0.3502 | Val  Acc: 0.9040
 Site-MNIST_M                   (2) | Val  Loss: 0.7237 | Val  Acc: 0.8068
 Site-MNIST_M                   (2) | Val  Loss: 0.7453 | Val  Acc: 0.7727
 Site-SVHN                      (4) | Val  Loss: 0.8721 | Val  Acc: 0.7192
Average Valid Accuracy: 0.8794
============ Train epoch 32 ============
cnt=[4, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (0) | Train Loss: 0.2577 | Train Acc: 0.9111
 Site-MNIST                     (0) | Train Loss: 0.2175 | Train Acc: 0.9408
 Site-MNIST                     (6) | Train Loss: 0.2511 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.2629 | Train Acc: 0.9251
 Site-MNIST                     (0) | Train Loss: 0.2208 | Train Acc: 0.9448
 Site-USPS                      (5) | Train Loss: 0.3079 | Train Acc: 0.9017
 Site-USPS                      (3) | Train Loss: 0.2580 | Train Acc: 0.9329
 Site-USPS                      (3) | Train Loss: 0.2562 | Train Acc: 0.9286
 Site-SynthDigits               (4) | Train Loss: 0.4267 | Train Acc: 0.8788
 Site-SynthDigits               (4) | Train Loss: 0.3778 | Train Acc: 0.9179
 Site-MNIST_M                   (2) | Train Loss: 0.6792 | Train Acc: 0.8153
 Site-MNIST_M                   (2) | Train Loss: 0.6652 | Train Acc: 0.8182
 Site-SVHN                      (1) | Train Loss: 0.7974 | Train Acc: 0.7428
Average Train Accuracy: 0.8907
 Site-MNIST                     (0) | Val  Loss: 0.1875 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.1911 | Val  Acc: 0.9286
 Site-MNIST                     (6) | Val  Loss: 0.2278 | Val  Acc: 0.9365
 Site-MNIST                     (0) | Val  Loss: 0.2740 | Val  Acc: 0.9316
 Site-MNIST                     (0) | Val  Loss: 0.2292 | Val  Acc: 0.9474
 Site-USPS                      (5) | Val  Loss: 0.1850 | Val  Acc: 0.9423
 Site-USPS                      (3) | Val  Loss: 0.2661 | Val  Acc: 0.9038
 Site-USPS                      (3) | Val  Loss: 0.3185 | Val  Acc: 0.8590
 Site-SynthDigits               (4) | Val  Loss: 0.5123 | Val  Acc: 0.8788
 Site-SynthDigits               (4) | Val  Loss: 0.3431 | Val  Acc: 0.8990
 Site-MNIST_M                   (2) | Val  Loss: 0.7351 | Val  Acc: 0.8182
 Site-MNIST_M                   (2) | Val  Loss: 0.7414 | Val  Acc: 0.7955
 Site-SVHN                      (1) | Val  Loss: 0.8386 | Val  Acc: 0.7192
Average Valid Accuracy: 0.8851
============ Train epoch 33 ============
cnt=[3, 2, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (0) | Train Loss: 0.2487 | Train Acc: 0.9156
 Site-MNIST                     (0) | Train Loss: 0.2033 | Train Acc: 0.9497
 Site-MNIST                     (5) | Train Loss: 0.2455 | Train Acc: 0.9250
 Site-MNIST                     (5) | Train Loss: 0.2590 | Train Acc: 0.9238
 Site-MNIST                     (0) | Train Loss: 0.2174 | Train Acc: 0.9475
 Site-USPS                      (1) | Train Loss: 0.2783 | Train Acc: 0.9113
 Site-USPS                      (6) | Train Loss: 0.2616 | Train Acc: 0.9281
 Site-USPS                      (1) | Train Loss: 0.2542 | Train Acc: 0.9265
 Site-SynthDigits               (3) | Train Loss: 0.4073 | Train Acc: 0.8826
 Site-SynthDigits               (3) | Train Loss: 0.3750 | Train Acc: 0.9053
 Site-MNIST_M                   (2) | Train Loss: 0.6279 | Train Acc: 0.8239
 Site-MNIST_M                   (2) | Train Loss: 0.6434 | Train Acc: 0.8087
 Site-SVHN                      (4) | Train Loss: 0.7973 | Train Acc: 0.7479
Average Train Accuracy: 0.8920
 Site-MNIST                     (0) | Val  Loss: 0.1860 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.1922 | Val  Acc: 0.9286
 Site-MNIST                     (5) | Val  Loss: 0.2241 | Val  Acc: 0.9365
 Site-MNIST                     (5) | Val  Loss: 0.2684 | Val  Acc: 0.9368
 Site-MNIST                     (0) | Val  Loss: 0.2273 | Val  Acc: 0.9509
 Site-USPS                      (1) | Val  Loss: 0.1809 | Val  Acc: 0.9519
 Site-USPS                      (6) | Val  Loss: 0.2603 | Val  Acc: 0.9103
 Site-USPS                      (1) | Val  Loss: 0.3103 | Val  Acc: 0.8803
 Site-SynthDigits               (3) | Val  Loss: 0.4891 | Val  Acc: 0.8788
 Site-SynthDigits               (3) | Val  Loss: 0.3315 | Val  Acc: 0.9192
 Site-MNIST_M                   (2) | Val  Loss: 0.6921 | Val  Acc: 0.8295
 Site-MNIST_M                   (2) | Val  Loss: 0.7028 | Val  Acc: 0.7955
 Site-SVHN                      (4) | Val  Loss: 0.8427 | Val  Acc: 0.7466
Average Valid Accuracy: 0.8932
 Best site-MNIST                    (0)  | Epoch:33 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:33 | Val Acc: 0.9286
 Best site-MNIST                    (5)  | Epoch:33 | Val Acc: 0.9365
 Best site-MNIST                    (5)  | Epoch:33 | Val Acc: 0.9368
 Best site-MNIST                    (0)  | Epoch:33 | Val Acc: 0.9509
 Best site-USPS                     (1)  | Epoch:33 | Val Acc: 0.9519
 Best site-USPS                     (6)  | Epoch:33 | Val Acc: 0.9103
 Best site-USPS                     (1)  | Epoch:33 | Val Acc: 0.8803
 Best site-SynthDigits              (3)  | Epoch:33 | Val Acc: 0.8788
 Best site-SynthDigits              (3)  | Epoch:33 | Val Acc: 0.9192
 Best site-MNIST_M                  (2)  | Epoch:33 | Val Acc: 0.8295
 Best site-MNIST_M                  (2)  | Epoch:33 | Val Acc: 0.7955
 Best site-SVHN                     (4)  | Epoch:33 | Val Acc: 0.7466
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 34 ============
cnt=[1, 2, 3, 1, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (2) | Train Loss: 0.2484 | Train Acc: 0.9200
 Site-MNIST                     (5) | Train Loss: 0.2106 | Train Acc: 0.9467
 Site-MNIST                     (2) | Train Loss: 0.2469 | Train Acc: 0.9191
 Site-MNIST                     (5) | Train Loss: 0.2596 | Train Acc: 0.9198
 Site-MNIST                     (2) | Train Loss: 0.2155 | Train Acc: 0.9475
 Site-USPS                      (6) | Train Loss: 0.2833 | Train Acc: 0.9089
 Site-USPS                      (6) | Train Loss: 0.2524 | Train Acc: 0.9313
 Site-USPS                      (0) | Train Loss: 0.2502 | Train Acc: 0.9233
 Site-SynthDigits               (4) | Train Loss: 0.4180 | Train Acc: 0.8826
 Site-SynthDigits               (4) | Train Loss: 0.3683 | Train Acc: 0.9141
 Site-MNIST_M                   (1) | Train Loss: 0.6379 | Train Acc: 0.8324
 Site-MNIST_M                   (1) | Train Loss: 0.6173 | Train Acc: 0.8239
 Site-SVHN                      (3) | Train Loss: 0.7566 | Train Acc: 0.7530
Average Train Accuracy: 0.8940
 Site-MNIST                     (2) | Val  Loss: 0.1792 | Val  Acc: 0.9464
 Site-MNIST                     (5) | Val  Loss: 0.1867 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2262 | Val  Acc: 0.9206
 Site-MNIST                     (5) | Val  Loss: 0.2687 | Val  Acc: 0.9316
 Site-MNIST                     (2) | Val  Loss: 0.2253 | Val  Acc: 0.9404
 Site-USPS                      (6) | Val  Loss: 0.1775 | Val  Acc: 0.9423
 Site-USPS                      (6) | Val  Loss: 0.2565 | Val  Acc: 0.9103
 Site-USPS                      (0) | Val  Loss: 0.3056 | Val  Acc: 0.8718
 Site-SynthDigits               (4) | Val  Loss: 0.4971 | Val  Acc: 0.8788
 Site-SynthDigits               (4) | Val  Loss: 0.3258 | Val  Acc: 0.9141
 Site-MNIST_M                   (1) | Val  Loss: 0.6859 | Val  Acc: 0.8409
 Site-MNIST_M                   (1) | Val  Loss: 0.7105 | Val  Acc: 0.8030
 Site-SVHN                      (3) | Val  Loss: 0.8196 | Val  Acc: 0.7466
Average Valid Accuracy: 0.8904
============ Train epoch 35 ============
cnt=[1, 2, 2, 3, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (6) | Train Loss: 0.2329 | Train Acc: 0.9156
 Site-MNIST                     (6) | Train Loss: 0.2019 | Train Acc: 0.9467
 Site-MNIST                     (1) | Train Loss: 0.2365 | Train Acc: 0.9231
 Site-MNIST                     (1) | Train Loss: 0.2506 | Train Acc: 0.9251
 Site-MNIST                     (6) | Train Loss: 0.2082 | Train Acc: 0.9483
 Site-USPS                      (3) | Train Loss: 0.2688 | Train Acc: 0.9137
 Site-USPS                      (3) | Train Loss: 0.2468 | Train Acc: 0.9361
 Site-USPS                      (3) | Train Loss: 0.2431 | Train Acc: 0.9318
 Site-SynthDigits               (4) | Train Loss: 0.4197 | Train Acc: 0.8864
 Site-SynthDigits               (5) | Train Loss: 0.3539 | Train Acc: 0.9179
 Site-MNIST_M                   (2) | Train Loss: 0.6436 | Train Acc: 0.8267
 Site-MNIST_M                   (2) | Train Loss: 0.6409 | Train Acc: 0.8182
 Site-SVHN                      (0) | Train Loss: 0.7818 | Train Acc: 0.7581
Average Train Accuracy: 0.8960
 Site-MNIST                     (6) | Val  Loss: 0.1743 | Val  Acc: 0.9464
 Site-MNIST                     (6) | Val  Loss: 0.1796 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2197 | Val  Acc: 0.9365
 Site-MNIST                     (1) | Val  Loss: 0.2606 | Val  Acc: 0.9316
 Site-MNIST                     (6) | Val  Loss: 0.2174 | Val  Acc: 0.9439
 Site-USPS                      (3) | Val  Loss: 0.1744 | Val  Acc: 0.9327
 Site-USPS                      (3) | Val  Loss: 0.2482 | Val  Acc: 0.9103
 Site-USPS                      (3) | Val  Loss: 0.2970 | Val  Acc: 0.8803
 Site-SynthDigits               (4) | Val  Loss: 0.4939 | Val  Acc: 0.8788
 Site-SynthDigits               (5) | Val  Loss: 0.3177 | Val  Acc: 0.9141
 Site-MNIST_M                   (2) | Val  Loss: 0.6884 | Val  Acc: 0.7955
 Site-MNIST_M                   (2) | Val  Loss: 0.7057 | Val  Acc: 0.8106
 Site-SVHN                      (0) | Val  Loss: 0.8043 | Val  Acc: 0.7329
Average Valid Accuracy: 0.8879
============ Train epoch 36 ============
cnt=[1, 1, 2, 3, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (5) | Train Loss: 0.2438 | Train Acc: 0.9244
 Site-MNIST                     (5) | Train Loss: 0.1866 | Train Acc: 0.9527
 Site-MNIST                     (0) | Train Loss: 0.2257 | Train Acc: 0.9329
 Site-MNIST                     (5) | Train Loss: 0.2428 | Train Acc: 0.9304
 Site-MNIST                     (5) | Train Loss: 0.2025 | Train Acc: 0.9510
 Site-USPS                      (3) | Train Loss: 0.2647 | Train Acc: 0.9065
 Site-USPS                      (3) | Train Loss: 0.2474 | Train Acc: 0.9361
 Site-USPS                      (3) | Train Loss: 0.2421 | Train Acc: 0.9255
 Site-SynthDigits               (6) | Train Loss: 0.3959 | Train Acc: 0.8845
 Site-SynthDigits               (4) | Train Loss: 0.3620 | Train Acc: 0.9280
 Site-MNIST_M                   (2) | Train Loss: 0.6266 | Train Acc: 0.8210
 Site-MNIST_M                   (2) | Train Loss: 0.6137 | Train Acc: 0.8352
 Site-SVHN                      (1) | Train Loss: 0.7792 | Train Acc: 0.7649
Average Train Accuracy: 0.8995
 Site-MNIST                     (5) | Val  Loss: 0.1714 | Val  Acc: 0.9464
 Site-MNIST                     (5) | Val  Loss: 0.1746 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2110 | Val  Acc: 0.9444
 Site-MNIST                     (5) | Val  Loss: 0.2494 | Val  Acc: 0.9368
 Site-MNIST                     (5) | Val  Loss: 0.2098 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1725 | Val  Acc: 0.9327
 Site-USPS                      (3) | Val  Loss: 0.2447 | Val  Acc: 0.9167
 Site-USPS                      (3) | Val  Loss: 0.2937 | Val  Acc: 0.8761
 Site-SynthDigits               (6) | Val  Loss: 0.4624 | Val  Acc: 0.8864
 Site-SynthDigits               (4) | Val  Loss: 0.3074 | Val  Acc: 0.9141
 Site-MNIST_M                   (2) | Val  Loss: 0.6859 | Val  Acc: 0.7955
 Site-MNIST_M                   (2) | Val  Loss: 0.6944 | Val  Acc: 0.8106
 Site-SVHN                      (1) | Val  Loss: 0.7864 | Val  Acc: 0.7397
Average Valid Accuracy: 0.8907
============ Train epoch 37 ============
cnt=[3, 2, 2, 1, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (6) | Train Loss: 0.2144 | Train Acc: 0.9422
 Site-MNIST                     (2) | Train Loss: 0.1797 | Train Acc: 0.9586
 Site-MNIST                     (6) | Train Loss: 0.2210 | Train Acc: 0.9329
 Site-MNIST                     (6) | Train Loss: 0.2372 | Train Acc: 0.9304
 Site-MNIST                     (2) | Train Loss: 0.1965 | Train Acc: 0.9545
 Site-USPS                      (0) | Train Loss: 0.2626 | Train Acc: 0.9209
 Site-USPS                      (0) | Train Loss: 0.2421 | Train Acc: 0.9409
 Site-USPS                      (0) | Train Loss: 0.2406 | Train Acc: 0.9318
 Site-SynthDigits               (5) | Train Loss: 0.4036 | Train Acc: 0.8826
 Site-SynthDigits               (3) | Train Loss: 0.3328 | Train Acc: 0.9205
 Site-MNIST_M                   (1) | Train Loss: 0.5961 | Train Acc: 0.8324
 Site-MNIST_M                   (1) | Train Loss: 0.5764 | Train Acc: 0.8220
 Site-SVHN                      (4) | Train Loss: 0.7632 | Train Acc: 0.7734
Average Train Accuracy: 0.9033
 Site-MNIST                     (6) | Val  Loss: 0.1711 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.1756 | Val  Acc: 0.9167
 Site-MNIST                     (6) | Val  Loss: 0.2036 | Val  Acc: 0.9444
 Site-MNIST                     (6) | Val  Loss: 0.2445 | Val  Acc: 0.9368
 Site-MNIST                     (2) | Val  Loss: 0.2070 | Val  Acc: 0.9509
 Site-USPS                      (0) | Val  Loss: 0.1660 | Val  Acc: 0.9423
 Site-USPS                      (0) | Val  Loss: 0.2428 | Val  Acc: 0.9038
 Site-USPS                      (0) | Val  Loss: 0.2845 | Val  Acc: 0.8761
 Site-SynthDigits               (5) | Val  Loss: 0.4481 | Val  Acc: 0.8939
 Site-SynthDigits               (3) | Val  Loss: 0.2985 | Val  Acc: 0.9242
 Site-MNIST_M                   (1) | Val  Loss: 0.6515 | Val  Acc: 0.8295
 Site-MNIST_M                   (1) | Val  Loss: 0.6627 | Val  Acc: 0.8561
 Site-SVHN                      (4) | Val  Loss: 0.7939 | Val  Acc: 0.7534
Average Valid Accuracy: 0.8967
 Best site-MNIST                    (6)  | Epoch:37 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:37 | Val Acc: 0.9167
 Best site-MNIST                    (6)  | Epoch:37 | Val Acc: 0.9444
 Best site-MNIST                    (6)  | Epoch:37 | Val Acc: 0.9368
 Best site-MNIST                    (2)  | Epoch:37 | Val Acc: 0.9509
 Best site-USPS                     (0)  | Epoch:37 | Val Acc: 0.9423
 Best site-USPS                     (0)  | Epoch:37 | Val Acc: 0.9038
 Best site-USPS                     (0)  | Epoch:37 | Val Acc: 0.8761
 Best site-SynthDigits              (5)  | Epoch:37 | Val Acc: 0.8939
 Best site-SynthDigits              (3)  | Epoch:37 | Val Acc: 0.9242
 Best site-MNIST_M                  (1)  | Epoch:37 | Val Acc: 0.8295
 Best site-MNIST_M                  (1)  | Epoch:37 | Val Acc: 0.8561
 Best site-SVHN                     (4)  | Epoch:37 | Val Acc: 0.7534
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 38 ============
cnt=[2, 1, 2, 1, 2, 2, 3, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (0) | Train Loss: 0.2205 | Train Acc: 0.9333
 Site-MNIST                     (0) | Train Loss: 0.1847 | Train Acc: 0.9586
 Site-MNIST                     (6) | Train Loss: 0.2221 | Train Acc: 0.9349
 Site-MNIST                     (6) | Train Loss: 0.2364 | Train Acc: 0.9304
 Site-MNIST                     (6) | Train Loss: 0.1932 | Train Acc: 0.9553
 Site-USPS                      (3) | Train Loss: 0.2710 | Train Acc: 0.9089
 Site-USPS                      (5) | Train Loss: 0.2375 | Train Acc: 0.9393
 Site-USPS                      (5) | Train Loss: 0.2404 | Train Acc: 0.9286
 Site-SynthDigits               (4) | Train Loss: 0.4026 | Train Acc: 0.8958
 Site-SynthDigits               (4) | Train Loss: 0.3305 | Train Acc: 0.9179
 Site-MNIST_M                   (2) | Train Loss: 0.6128 | Train Acc: 0.8494
 Site-MNIST_M                   (2) | Train Loss: 0.5904 | Train Acc: 0.8295
 Site-SVHN                      (1) | Train Loss: 0.7510 | Train Acc: 0.7768
Average Train Accuracy: 0.9045
 Site-MNIST                     (0) | Val  Loss: 0.1639 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.1675 | Val  Acc: 0.9405
 Site-MNIST                     (6) | Val  Loss: 0.2037 | Val  Acc: 0.9444
 Site-MNIST                     (6) | Val  Loss: 0.2422 | Val  Acc: 0.9421
 Site-MNIST                     (6) | Val  Loss: 0.2052 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1688 | Val  Acc: 0.9519
 Site-USPS                      (5) | Val  Loss: 0.2380 | Val  Acc: 0.9231
 Site-USPS                      (5) | Val  Loss: 0.2852 | Val  Acc: 0.8761
 Site-SynthDigits               (4) | Val  Loss: 0.4706 | Val  Acc: 0.8864
 Site-SynthDigits               (4) | Val  Loss: 0.2957 | Val  Acc: 0.9343
 Site-MNIST_M                   (2) | Val  Loss: 0.6508 | Val  Acc: 0.8409
 Site-MNIST_M                   (2) | Val  Loss: 0.6689 | Val  Acc: 0.8409
 Site-SVHN                      (1) | Val  Loss: 0.7726 | Val  Acc: 0.7466
Average Valid Accuracy: 0.9019
 Best site-MNIST                    (0)  | Epoch:38 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:38 | Val Acc: 0.9405
 Best site-MNIST                    (6)  | Epoch:38 | Val Acc: 0.9444
 Best site-MNIST                    (6)  | Epoch:38 | Val Acc: 0.9421
 Best site-MNIST                    (6)  | Epoch:38 | Val Acc: 0.9509
 Best site-USPS                     (3)  | Epoch:38 | Val Acc: 0.9519
 Best site-USPS                     (5)  | Epoch:38 | Val Acc: 0.9231
 Best site-USPS                     (5)  | Epoch:38 | Val Acc: 0.8761
 Best site-SynthDigits              (4)  | Epoch:38 | Val Acc: 0.8864
 Best site-SynthDigits              (4)  | Epoch:38 | Val Acc: 0.9343
 Best site-MNIST_M                  (2)  | Epoch:38 | Val Acc: 0.8409
 Best site-MNIST_M                  (2)  | Epoch:38 | Val Acc: 0.8409
 Best site-SVHN                     (1)  | Epoch:38 | Val Acc: 0.7466
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 39 ============
cnt=[1, 5, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (1) | Train Loss: 0.2272 | Train Acc: 0.9244
 Site-MNIST                     (1) | Train Loss: 0.1765 | Train Acc: 0.9556
 Site-MNIST                     (1) | Train Loss: 0.2197 | Train Acc: 0.9290
 Site-MNIST                     (1) | Train Loss: 0.2377 | Train Acc: 0.9290
 Site-MNIST                     (1) | Train Loss: 0.1942 | Train Acc: 0.9536
 Site-USPS                      (5) | Train Loss: 0.2599 | Train Acc: 0.9113
 Site-USPS                      (3) | Train Loss: 0.2387 | Train Acc: 0.9377
 Site-USPS                      (3) | Train Loss: 0.2320 | Train Acc: 0.9297
 Site-SynthDigits               (4) | Train Loss: 0.3760 | Train Acc: 0.8958
 Site-SynthDigits               (4) | Train Loss: 0.3308 | Train Acc: 0.9205
 Site-MNIST_M                   (6) | Train Loss: 0.5661 | Train Acc: 0.8381
 Site-MNIST_M                   (2) | Train Loss: 0.5490 | Train Acc: 0.8352
 Site-SVHN                      (0) | Train Loss: 0.7597 | Train Acc: 0.7734
Average Train Accuracy: 0.9026
 Site-MNIST                     (1) | Val  Loss: 0.1636 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.1670 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2029 | Val  Acc: 0.9444
 Site-MNIST                     (1) | Val  Loss: 0.2417 | Val  Acc: 0.9421
 Site-MNIST                     (1) | Val  Loss: 0.2040 | Val  Acc: 0.9509
 Site-USPS                      (5) | Val  Loss: 0.1674 | Val  Acc: 0.9519
 Site-USPS                      (3) | Val  Loss: 0.2344 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.2755 | Val  Acc: 0.8889
 Site-SynthDigits               (4) | Val  Loss: 0.4502 | Val  Acc: 0.8788
 Site-SynthDigits               (4) | Val  Loss: 0.2915 | Val  Acc: 0.9293
 Site-MNIST_M                   (6) | Val  Loss: 0.6237 | Val  Acc: 0.8182
 Site-MNIST_M                   (2) | Val  Loss: 0.6548 | Val  Acc: 0.8485
 Site-SVHN                      (0) | Val  Loss: 0.7699 | Val  Acc: 0.7603
Average Valid Accuracy: 0.9009
============ Train epoch 40 ============
cnt=[3, 4, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (1) | Train Loss: 0.2233 | Train Acc: 0.9378
 Site-MNIST                     (1) | Train Loss: 0.1914 | Train Acc: 0.9556
 Site-MNIST                     (6) | Train Loss: 0.2142 | Train Acc: 0.9329
 Site-MNIST                     (1) | Train Loss: 0.2325 | Train Acc: 0.9304
 Site-MNIST                     (1) | Train Loss: 0.1891 | Train Acc: 0.9527
 Site-USPS                      (0) | Train Loss: 0.2718 | Train Acc: 0.9161
 Site-USPS                      (0) | Train Loss: 0.2273 | Train Acc: 0.9393
 Site-USPS                      (0) | Train Loss: 0.2297 | Train Acc: 0.9297
 Site-SynthDigits               (5) | Train Loss: 0.3883 | Train Acc: 0.8939
 Site-SynthDigits               (3) | Train Loss: 0.3284 | Train Acc: 0.9192
 Site-MNIST_M                   (2) | Train Loss: 0.5874 | Train Acc: 0.8352
 Site-MNIST_M                   (2) | Train Loss: 0.5836 | Train Acc: 0.8390
 Site-SVHN                      (4) | Train Loss: 0.6952 | Train Acc: 0.7871
Average Train Accuracy: 0.9053
 Site-MNIST                     (1) | Val  Loss: 0.1616 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.1629 | Val  Acc: 0.9286
 Site-MNIST                     (6) | Val  Loss: 0.2011 | Val  Acc: 0.9444
 Site-MNIST                     (1) | Val  Loss: 0.2390 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.1989 | Val  Acc: 0.9544
 Site-USPS                      (0) | Val  Loss: 0.1639 | Val  Acc: 0.9615
 Site-USPS                      (0) | Val  Loss: 0.2262 | Val  Acc: 0.9231
 Site-USPS                      (0) | Val  Loss: 0.2712 | Val  Acc: 0.8889
 Site-SynthDigits               (5) | Val  Loss: 0.4626 | Val  Acc: 0.8636
 Site-SynthDigits               (3) | Val  Loss: 0.2927 | Val  Acc: 0.9242
 Site-MNIST_M                   (2) | Val  Loss: 0.6345 | Val  Acc: 0.8182
 Site-MNIST_M                   (2) | Val  Loss: 0.6607 | Val  Acc: 0.8409
 Site-SVHN                      (4) | Val  Loss: 0.7368 | Val  Acc: 0.7534
Average Valid Accuracy: 0.8988
============ Train epoch 41 ============
cnt=[1, 5, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (1) | Train Loss: 0.2089 | Train Acc: 0.9378
 Site-MNIST                     (1) | Train Loss: 0.1900 | Train Acc: 0.9586
 Site-MNIST                     (1) | Train Loss: 0.2101 | Train Acc: 0.9310
 Site-MNIST                     (1) | Train Loss: 0.2280 | Train Acc: 0.9304
 Site-MNIST                     (1) | Train Loss: 0.1840 | Train Acc: 0.9536
 Site-USPS                      (3) | Train Loss: 0.2360 | Train Acc: 0.9209
 Site-USPS                      (3) | Train Loss: 0.2230 | Train Acc: 0.9393
 Site-USPS                      (6) | Train Loss: 0.2244 | Train Acc: 0.9350
 Site-SynthDigits               (4) | Train Loss: 0.3559 | Train Acc: 0.9015
 Site-SynthDigits               (4) | Train Loss: 0.3208 | Train Acc: 0.9230
 Site-MNIST_M                   (5) | Train Loss: 0.5645 | Train Acc: 0.8409
 Site-MNIST_M                   (2) | Train Loss: 0.5757 | Train Acc: 0.8466
 Site-SVHN                      (0) | Train Loss: 0.7102 | Train Acc: 0.7819
Average Train Accuracy: 0.9077
 Site-MNIST                     (1) | Val  Loss: 0.1589 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.1602 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.1968 | Val  Acc: 0.9444
 Site-MNIST                     (1) | Val  Loss: 0.2335 | Val  Acc: 0.9421
 Site-MNIST                     (1) | Val  Loss: 0.1942 | Val  Acc: 0.9544
 Site-USPS                      (3) | Val  Loss: 0.1549 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2184 | Val  Acc: 0.9231
 Site-USPS                      (6) | Val  Loss: 0.2622 | Val  Acc: 0.8846
 Site-SynthDigits               (4) | Val  Loss: 0.4415 | Val  Acc: 0.8864
 Site-SynthDigits               (4) | Val  Loss: 0.2839 | Val  Acc: 0.9343
 Site-MNIST_M                   (5) | Val  Loss: 0.6162 | Val  Acc: 0.8295
 Site-MNIST_M                   (2) | Val  Loss: 0.6393 | Val  Acc: 0.8561
 Site-SVHN                      (0) | Val  Loss: 0.7416 | Val  Acc: 0.7603
Average Valid Accuracy: 0.9040
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9444
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9421
 Best site-MNIST                    (1)  | Epoch:41 | Val Acc: 0.9544
 Best site-USPS                     (3)  | Epoch:41 | Val Acc: 0.9615
 Best site-USPS                     (3)  | Epoch:41 | Val Acc: 0.9231
 Best site-USPS                     (6)  | Epoch:41 | Val Acc: 0.8846
 Best site-SynthDigits              (4)  | Epoch:41 | Val Acc: 0.8864
 Best site-SynthDigits              (4)  | Epoch:41 | Val Acc: 0.9343
 Best site-MNIST_M                  (5)  | Epoch:41 | Val Acc: 0.8295
 Best site-MNIST_M                  (2)  | Epoch:41 | Val Acc: 0.8561
 Best site-SVHN                     (0)  | Epoch:41 | Val Acc: 0.7603
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 42 ============
cnt=[2, 3, 1, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (1) | Train Loss: 0.1964 | Train Acc: 0.9378
 Site-MNIST                     (6) | Train Loss: 0.1937 | Train Acc: 0.9556
 Site-MNIST                     (1) | Train Loss: 0.2089 | Train Acc: 0.9329
 Site-MNIST                     (6) | Train Loss: 0.2222 | Train Acc: 0.9382
 Site-MNIST                     (1) | Train Loss: 0.1789 | Train Acc: 0.9545
 Site-USPS                      (3) | Train Loss: 0.2517 | Train Acc: 0.9209
 Site-USPS                      (3) | Train Loss: 0.2187 | Train Acc: 0.9457
 Site-USPS                      (3) | Train Loss: 0.2203 | Train Acc: 0.9318
 Site-SynthDigits               (0) | Train Loss: 0.3872 | Train Acc: 0.8958
 Site-SynthDigits               (0) | Train Loss: 0.3191 | Train Acc: 0.9268
 Site-MNIST_M                   (5) | Train Loss: 0.5480 | Train Acc: 0.8523
 Site-MNIST_M                   (2) | Train Loss: 0.5573 | Train Acc: 0.8466
 Site-SVHN                      (4) | Train Loss: 0.6959 | Train Acc: 0.7734
Average Train Accuracy: 0.9086
 Site-MNIST                     (1) | Val  Loss: 0.1504 | Val  Acc: 0.9464
 Site-MNIST                     (6) | Val  Loss: 0.1560 | Val  Acc: 0.9405
 Site-MNIST                     (1) | Val  Loss: 0.1939 | Val  Acc: 0.9444
 Site-MNIST                     (6) | Val  Loss: 0.2330 | Val  Acc: 0.9421
 Site-MNIST                     (1) | Val  Loss: 0.1917 | Val  Acc: 0.9544
 Site-USPS                      (3) | Val  Loss: 0.1549 | Val  Acc: 0.9712
 Site-USPS                      (3) | Val  Loss: 0.2192 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.2632 | Val  Acc: 0.8889
 Site-SynthDigits               (0) | Val  Loss: 0.4338 | Val  Acc: 0.8864
 Site-SynthDigits               (0) | Val  Loss: 0.2804 | Val  Acc: 0.9293
 Site-MNIST_M                   (5) | Val  Loss: 0.6148 | Val  Acc: 0.8295
 Site-MNIST_M                   (2) | Val  Loss: 0.6383 | Val  Acc: 0.8561
 Site-SVHN                      (4) | Val  Loss: 0.7213 | Val  Acc: 0.7466
Average Valid Accuracy: 0.9045
 Best site-MNIST                    (1)  | Epoch:42 | Val Acc: 0.9464
 Best site-MNIST                    (6)  | Epoch:42 | Val Acc: 0.9405
 Best site-MNIST                    (1)  | Epoch:42 | Val Acc: 0.9444
 Best site-MNIST                    (6)  | Epoch:42 | Val Acc: 0.9421
 Best site-MNIST                    (1)  | Epoch:42 | Val Acc: 0.9544
 Best site-USPS                     (3)  | Epoch:42 | Val Acc: 0.9712
 Best site-USPS                     (3)  | Epoch:42 | Val Acc: 0.9231
 Best site-USPS                     (3)  | Epoch:42 | Val Acc: 0.8889
 Best site-SynthDigits              (0)  | Epoch:42 | Val Acc: 0.8864
 Best site-SynthDigits              (0)  | Epoch:42 | Val Acc: 0.9293
 Best site-MNIST_M                  (5)  | Epoch:42 | Val Acc: 0.8295
 Best site-MNIST_M                  (2)  | Epoch:42 | Val Acc: 0.8561
 Best site-SVHN                     (4)  | Epoch:42 | Val Acc: 0.7466
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 43 ============
cnt=[1, 5, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (1) | Train Loss: 0.1963 | Train Acc: 0.9378
 Site-MNIST                     (1) | Train Loss: 0.1589 | Train Acc: 0.9645
 Site-MNIST                     (1) | Train Loss: 0.2076 | Train Acc: 0.9369
 Site-MNIST                     (1) | Train Loss: 0.2203 | Train Acc: 0.9356
 Site-MNIST                     (1) | Train Loss: 0.1750 | Train Acc: 0.9571
 Site-USPS                      (3) | Train Loss: 0.2543 | Train Acc: 0.9161
 Site-USPS                      (3) | Train Loss: 0.2184 | Train Acc: 0.9441
 Site-USPS                      (3) | Train Loss: 0.2173 | Train Acc: 0.9329
 Site-SynthDigits               (5) | Train Loss: 0.3692 | Train Acc: 0.9015
 Site-SynthDigits               (0) | Train Loss: 0.3155 | Train Acc: 0.9318
 Site-MNIST_M                   (6) | Train Loss: 0.5377 | Train Acc: 0.8580
 Site-MNIST_M                   (2) | Train Loss: 0.5437 | Train Acc: 0.8504
 Site-SVHN                      (4) | Train Loss: 0.6736 | Train Acc: 0.7853
Average Train Accuracy: 0.9117
 Site-MNIST                     (1) | Val  Loss: 0.1457 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.1525 | Val  Acc: 0.9405
 Site-MNIST                     (1) | Val  Loss: 0.1919 | Val  Acc: 0.9444
 Site-MNIST                     (1) | Val  Loss: 0.2309 | Val  Acc: 0.9421
 Site-MNIST                     (1) | Val  Loss: 0.1896 | Val  Acc: 0.9579
 Site-USPS                      (3) | Val  Loss: 0.1562 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2169 | Val  Acc: 0.9295
 Site-USPS                      (3) | Val  Loss: 0.2599 | Val  Acc: 0.8846
 Site-SynthDigits               (5) | Val  Loss: 0.4324 | Val  Acc: 0.9015
 Site-SynthDigits               (0) | Val  Loss: 0.2724 | Val  Acc: 0.9394
 Site-MNIST_M                   (6) | Val  Loss: 0.6047 | Val  Acc: 0.8295
 Site-MNIST_M                   (2) | Val  Loss: 0.6364 | Val  Acc: 0.8636
 Site-SVHN                      (4) | Val  Loss: 0.7172 | Val  Acc: 0.7603
Average Valid Accuracy: 0.9078
 Best site-MNIST                    (1)  | Epoch:43 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:43 | Val Acc: 0.9405
 Best site-MNIST                    (1)  | Epoch:43 | Val Acc: 0.9444
 Best site-MNIST                    (1)  | Epoch:43 | Val Acc: 0.9421
 Best site-MNIST                    (1)  | Epoch:43 | Val Acc: 0.9579
 Best site-USPS                     (3)  | Epoch:43 | Val Acc: 0.9615
 Best site-USPS                     (3)  | Epoch:43 | Val Acc: 0.9295
 Best site-USPS                     (3)  | Epoch:43 | Val Acc: 0.8846
 Best site-SynthDigits              (5)  | Epoch:43 | Val Acc: 0.9015
 Best site-SynthDigits              (0)  | Epoch:43 | Val Acc: 0.9394
 Best site-MNIST_M                  (6)  | Epoch:43 | Val Acc: 0.8295
 Best site-MNIST_M                  (2)  | Epoch:43 | Val Acc: 0.8636
 Best site-SVHN                     (4)  | Epoch:43 | Val Acc: 0.7603
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 44 ============
cnt=[5, 1, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (0) | Train Loss: 0.1816 | Train Acc: 0.9511
 Site-MNIST                     (0) | Train Loss: 0.1556 | Train Acc: 0.9645
 Site-MNIST                     (0) | Train Loss: 0.1986 | Train Acc: 0.9389
 Site-MNIST                     (0) | Train Loss: 0.2148 | Train Acc: 0.9396
 Site-MNIST                     (0) | Train Loss: 0.1700 | Train Acc: 0.9588
 Site-USPS                      (3) | Train Loss: 0.2430 | Train Acc: 0.9233
 Site-USPS                      (3) | Train Loss: 0.2104 | Train Acc: 0.9409
 Site-USPS                      (3) | Train Loss: 0.2153 | Train Acc: 0.9372
 Site-SynthDigits               (5) | Train Loss: 0.3526 | Train Acc: 0.9053
 Site-SynthDigits               (1) | Train Loss: 0.3129 | Train Acc: 0.9280
 Site-MNIST_M                   (2) | Train Loss: 0.5305 | Train Acc: 0.8551
 Site-MNIST_M                   (6) | Train Loss: 0.5348 | Train Acc: 0.8523
 Site-SVHN                      (4) | Train Loss: 0.7120 | Train Acc: 0.7871
Average Train Accuracy: 0.9140
 Site-MNIST                     (0) | Val  Loss: 0.1378 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1459 | Val  Acc: 0.9405
 Site-MNIST                     (0) | Val  Loss: 0.1856 | Val  Acc: 0.9444
 Site-MNIST                     (0) | Val  Loss: 0.2244 | Val  Acc: 0.9421
 Site-MNIST                     (0) | Val  Loss: 0.1844 | Val  Acc: 0.9579
 Site-USPS                      (3) | Val  Loss: 0.1452 | Val  Acc: 0.9808
 Site-USPS                      (3) | Val  Loss: 0.2117 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.2528 | Val  Acc: 0.8974
 Site-SynthDigits               (5) | Val  Loss: 0.4274 | Val  Acc: 0.9015
 Site-SynthDigits               (1) | Val  Loss: 0.2707 | Val  Acc: 0.9343
 Site-MNIST_M                   (2) | Val  Loss: 0.6011 | Val  Acc: 0.8182
 Site-MNIST_M                   (6) | Val  Loss: 0.6194 | Val  Acc: 0.8561
 Site-SVHN                      (4) | Val  Loss: 0.7063 | Val  Acc: 0.7534
Average Valid Accuracy: 0.9088
 Best site-MNIST                    (0)  | Epoch:44 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:44 | Val Acc: 0.9405
 Best site-MNIST                    (0)  | Epoch:44 | Val Acc: 0.9444
 Best site-MNIST                    (0)  | Epoch:44 | Val Acc: 0.9421
 Best site-MNIST                    (0)  | Epoch:44 | Val Acc: 0.9579
 Best site-USPS                     (3)  | Epoch:44 | Val Acc: 0.9808
 Best site-USPS                     (3)  | Epoch:44 | Val Acc: 0.9231
 Best site-USPS                     (3)  | Epoch:44 | Val Acc: 0.8974
 Best site-SynthDigits              (5)  | Epoch:44 | Val Acc: 0.9015
 Best site-SynthDigits              (1)  | Epoch:44 | Val Acc: 0.9343
 Best site-MNIST_M                  (2)  | Epoch:44 | Val Acc: 0.8182
 Best site-MNIST_M                  (6)  | Epoch:44 | Val Acc: 0.8561
 Best site-SVHN                     (4)  | Epoch:44 | Val Acc: 0.7534
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 45 ============
cnt=[1, 5, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (1) | Train Loss: 0.1777 | Train Acc: 0.9556
 Site-MNIST                     (1) | Train Loss: 0.1695 | Train Acc: 0.9615
 Site-MNIST                     (1) | Train Loss: 0.1913 | Train Acc: 0.9448
 Site-MNIST                     (1) | Train Loss: 0.2095 | Train Acc: 0.9343
 Site-MNIST                     (1) | Train Loss: 0.1677 | Train Acc: 0.9615
 Site-USPS                      (6) | Train Loss: 0.2448 | Train Acc: 0.9257
 Site-USPS                      (3) | Train Loss: 0.2104 | Train Acc: 0.9457
 Site-USPS                      (3) | Train Loss: 0.2091 | Train Acc: 0.9382
 Site-SynthDigits               (5) | Train Loss: 0.3586 | Train Acc: 0.8977
 Site-SynthDigits               (0) | Train Loss: 0.3040 | Train Acc: 0.9217
 Site-MNIST_M                   (2) | Train Loss: 0.5344 | Train Acc: 0.8523
 Site-MNIST_M                   (2) | Train Loss: 0.5344 | Train Acc: 0.8466
 Site-SVHN                      (4) | Train Loss: 0.6687 | Train Acc: 0.7956
Average Train Accuracy: 0.9139
 Site-MNIST                     (1) | Val  Loss: 0.1374 | Val  Acc: 0.9821
 Site-MNIST                     (1) | Val  Loss: 0.1463 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1828 | Val  Acc: 0.9524
 Site-MNIST                     (1) | Val  Loss: 0.2213 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.1835 | Val  Acc: 0.9614
 Site-USPS                      (6) | Val  Loss: 0.1395 | Val  Acc: 0.9712
 Site-USPS                      (3) | Val  Loss: 0.2090 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.2488 | Val  Acc: 0.8932
 Site-SynthDigits               (5) | Val  Loss: 0.4184 | Val  Acc: 0.8864
 Site-SynthDigits               (0) | Val  Loss: 0.2704 | Val  Acc: 0.9242
 Site-MNIST_M                   (2) | Val  Loss: 0.6008 | Val  Acc: 0.8182
 Site-MNIST_M                   (2) | Val  Loss: 0.6170 | Val  Acc: 0.8485
 Site-SVHN                      (4) | Val  Loss: 0.6850 | Val  Acc: 0.7603
Average Valid Accuracy: 0.9094
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.9821
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.9524
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.9368
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.9614
 Best site-USPS                     (6)  | Epoch:45 | Val Acc: 0.9712
 Best site-USPS                     (3)  | Epoch:45 | Val Acc: 0.9231
 Best site-USPS                     (3)  | Epoch:45 | Val Acc: 0.8932
 Best site-SynthDigits              (5)  | Epoch:45 | Val Acc: 0.8864
 Best site-SynthDigits              (0)  | Epoch:45 | Val Acc: 0.9242
 Best site-MNIST_M                  (2)  | Epoch:45 | Val Acc: 0.8182
 Best site-MNIST_M                  (2)  | Epoch:45 | Val Acc: 0.8485
 Best site-SVHN                     (4)  | Epoch:45 | Val Acc: 0.7603
 Test site-MNIST                     (1)| Epoch:45 | Test Acc: 0.9423
 Test site-USPS                      (6)| Epoch:45 | Test Acc: 0.9495
 Test site-SynthDigits               (5)| Epoch:45 | Test Acc: 0.9012
 Test site-MNIST_M                   (2)| Epoch:45 | Test Acc: 0.7577
 Test site-SVHN                      (4)| Epoch:45 | Test Acc: 0.7059
MNIST: 0.9423, USPS: 0.9495, SynthDigits: 0.9012, MNIST_M: 0.7577, SVHN: 0.7059, 
Average Test Accuracy(group): 0.8513, Average Test Accuracy(individual): 0.8910,
domain std=0.1003, cluster std=0.0920, individual std=0.0848, 
Average Test Accuracy: 0.8513
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 46 ============
cnt=[1, 2, 5, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-MNIST                     (2) | Train Loss: 0.1714 | Train Acc: 0.9600
 Site-MNIST                     (2) | Train Loss: 0.1658 | Train Acc: 0.9645
 Site-MNIST                     (2) | Train Loss: 0.1896 | Train Acc: 0.9467
 Site-MNIST                     (2) | Train Loss: 0.2084 | Train Acc: 0.9356
 Site-MNIST                     (2) | Train Loss: 0.1652 | Train Acc: 0.9597
 Site-USPS                      (5) | Train Loss: 0.2319 | Train Acc: 0.9305
 Site-USPS                      (0) | Train Loss: 0.2078 | Train Acc: 0.9441
 Site-USPS                      (5) | Train Loss: 0.2026 | Train Acc: 0.9393
 Site-SynthDigits               (1) | Train Loss: 0.3732 | Train Acc: 0.9053
 Site-SynthDigits               (1) | Train Loss: 0.2957 | Train Acc: 0.9280
 Site-MNIST_M                   (6) | Train Loss: 0.5163 | Train Acc: 0.8693
 Site-MNIST_M                   (3) | Train Loss: 0.5098 | Train Acc: 0.8561
 Site-SVHN                      (4) | Train Loss: 0.6742 | Train Acc: 0.7853
Average Train Accuracy: 0.9173
 Site-MNIST                     (2) | Val  Loss: 0.1364 | Val  Acc: 0.9821
 Site-MNIST                     (2) | Val  Loss: 0.1454 | Val  Acc: 0.9524
 Site-MNIST                     (2) | Val  Loss: 0.1798 | Val  Acc: 0.9444
 Site-MNIST                     (2) | Val  Loss: 0.2173 | Val  Acc: 0.9421
 Site-MNIST                     (2) | Val  Loss: 0.1808 | Val  Acc: 0.9614
 Site-USPS                      (5) | Val  Loss: 0.1356 | Val  Acc: 0.9808
 Site-USPS                      (0) | Val  Loss: 0.2062 | Val  Acc: 0.9295
 Site-USPS                      (5) | Val  Loss: 0.2433 | Val  Acc: 0.9017
 Site-SynthDigits               (1) | Val  Loss: 0.4032 | Val  Acc: 0.8939
 Site-SynthDigits               (1) | Val  Loss: 0.2616 | Val  Acc: 0.9293
 Site-MNIST_M                   (6) | Val  Loss: 0.5884 | Val  Acc: 0.8182
 Site-MNIST_M                   (3) | Val  Loss: 0.6083 | Val  Acc: 0.8485
 Site-SVHN                      (4) | Val  Loss: 0.6805 | Val  Acc: 0.7808
Average Valid Accuracy: 0.9127
 Best site-MNIST                    (2)  | Epoch:46 | Val Acc: 0.9821
 Best site-MNIST                    (2)  | Epoch:46 | Val Acc: 0.9524
 Best site-MNIST                    (2)  | Epoch:46 | Val Acc: 0.9444
 Best site-MNIST                    (2)  | Epoch:46 | Val Acc: 0.9421
 Best site-MNIST                    (2)  | Epoch:46 | Val Acc: 0.9614
 Best site-USPS                     (5)  | Epoch:46 | Val Acc: 0.9808
 Best site-USPS                     (0)  | Epoch:46 | Val Acc: 0.9295
 Best site-USPS                     (5)  | Epoch:46 | Val Acc: 0.9017
 Best site-SynthDigits              (1)  | Epoch:46 | Val Acc: 0.8939
 Best site-SynthDigits              (1)  | Epoch:46 | Val Acc: 0.9293
 Best site-MNIST_M                  (6)  | Epoch:46 | Val Acc: 0.8182
 Best site-MNIST_M                  (3)  | Epoch:46 | Val Acc: 0.8485
 Best site-SVHN                     (4)  | Epoch:46 | Val Acc: 0.7808
 Test site-MNIST                     (2)| Epoch:46 | Test Acc: 0.9427
 Test site-USPS                      (5)| Epoch:46 | Test Acc: 0.9462
 Test site-SynthDigits               (1)| Epoch:46 | Test Acc: 0.9017
 Test site-MNIST_M                   (6)| Epoch:46 | Test Acc: 0.7601
 Test site-SVHN                      (4)| Epoch:46 | Test Acc: 0.7031
MNIST: 0.9427, USPS: 0.9462, SynthDigits: 0.9017, MNIST_M: 0.7601, SVHN: 0.7031, 
Average Test Accuracy(group): 0.8508, Average Test Accuracy(individual): 0.8907,
domain std=0.1002, cluster std=0.0982, individual std=0.0843, 
Average Test Accuracy: 0.8508
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 47 ============
cnt=[2, 1, 2, 2, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-MNIST                     (2) | Train Loss: 0.1824 | Train Acc: 0.9556
 Site-MNIST                     (6) | Train Loss: 0.1681 | Train Acc: 0.9586
 Site-MNIST                     (6) | Train Loss: 0.1868 | Train Acc: 0.9487
 Site-MNIST                     (6) | Train Loss: 0.2070 | Train Acc: 0.9396
 Site-MNIST                     (2) | Train Loss: 0.1632 | Train Acc: 0.9580
 Site-USPS                      (1) | Train Loss: 0.2305 | Train Acc: 0.9281
 Site-USPS                      (5) | Train Loss: 0.2036 | Train Acc: 0.9441
 Site-USPS                      (5) | Train Loss: 0.2028 | Train Acc: 0.9414
 Site-SynthDigits               (3) | Train Loss: 0.3354 | Train Acc: 0.8996
 Site-SynthDigits               (3) | Train Loss: 0.2897 | Train Acc: 0.9306
 Site-MNIST_M                   (0) | Train Loss: 0.5257 | Train Acc: 0.8665
 Site-MNIST_M                   (0) | Train Loss: 0.5138 | Train Acc: 0.8428
 Site-SVHN                      (4) | Train Loss: 0.6291 | Train Acc: 0.7888
Average Train Accuracy: 0.9156
 Site-MNIST                     (2) | Val  Loss: 0.1321 | Val  Acc: 0.9821
 Site-MNIST                     (6) | Val  Loss: 0.1401 | Val  Acc: 0.9643
 Site-MNIST                     (6) | Val  Loss: 0.1784 | Val  Acc: 0.9444
 Site-MNIST                     (6) | Val  Loss: 0.2138 | Val  Acc: 0.9421
 Site-MNIST                     (2) | Val  Loss: 0.1787 | Val  Acc: 0.9579
 Site-USPS                      (1) | Val  Loss: 0.1355 | Val  Acc: 0.9712
 Site-USPS                      (5) | Val  Loss: 0.2027 | Val  Acc: 0.9295
 Site-USPS                      (5) | Val  Loss: 0.2412 | Val  Acc: 0.9017
 Site-SynthDigits               (3) | Val  Loss: 0.4061 | Val  Acc: 0.8788
 Site-SynthDigits               (3) | Val  Loss: 0.2572 | Val  Acc: 0.9293
 Site-MNIST_M                   (0) | Val  Loss: 0.5893 | Val  Acc: 0.8182
 Site-MNIST_M                   (0) | Val  Loss: 0.6020 | Val  Acc: 0.8561
 Site-SVHN                      (4) | Val  Loss: 0.6725 | Val  Acc: 0.7603
Average Valid Accuracy: 0.9104
 Test site-MNIST                     (2)| Epoch:46 | Test Acc: 0.9430
 Test site-USPS                      (1)| Epoch:46 | Test Acc: 0.9484
 Test site-SynthDigits               (3)| Epoch:46 | Test Acc: 0.9008
 Test site-MNIST_M                   (0)| Epoch:46 | Test Acc: 0.7566
 Test site-SVHN                      (4)| Epoch:46 | Test Acc: 0.7093
MNIST: 0.9430, USPS: 0.9484, SynthDigits: 0.9008, MNIST_M: 0.7566, SVHN: 0.7093, 
Average Test Accuracy(group): 0.8516, Average Test Accuracy(individual): 0.8911,
domain std=0.0994, cluster std=0.0942, individual std=0.0845, 
Average Test Accuracy: 0.8516
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 48 ============
cnt=[2, 1, 5, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-MNIST                     (2) | Train Loss: 0.1791 | Train Acc: 0.9467
 Site-MNIST                     (2) | Train Loss: 0.1526 | Train Acc: 0.9645
 Site-MNIST                     (2) | Train Loss: 0.1847 | Train Acc: 0.9428
 Site-MNIST                     (2) | Train Loss: 0.2046 | Train Acc: 0.9422
 Site-MNIST                     (2) | Train Loss: 0.1613 | Train Acc: 0.9588
 Site-USPS                      (0) | Train Loss: 0.2310 | Train Acc: 0.9233
 Site-USPS                      (0) | Train Loss: 0.1987 | Train Acc: 0.9441
 Site-USPS                      (5) | Train Loss: 0.2004 | Train Acc: 0.9404
 Site-SynthDigits               (3) | Train Loss: 0.3703 | Train Acc: 0.9034
 Site-SynthDigits               (3) | Train Loss: 0.2881 | Train Acc: 0.9343
 Site-MNIST_M                   (1) | Train Loss: 0.5262 | Train Acc: 0.8636
 Site-MNIST_M                   (6) | Train Loss: 0.5058 | Train Acc: 0.8504
 Site-SVHN                      (4) | Train Loss: 0.6257 | Train Acc: 0.8007
Average Train Accuracy: 0.9166
 Site-MNIST                     (2) | Val  Loss: 0.1308 | Val  Acc: 0.9643
 Site-MNIST                     (2) | Val  Loss: 0.1367 | Val  Acc: 0.9405
 Site-MNIST                     (2) | Val  Loss: 0.1775 | Val  Acc: 0.9444
 Site-MNIST                     (2) | Val  Loss: 0.2122 | Val  Acc: 0.9421
 Site-MNIST                     (2) | Val  Loss: 0.1771 | Val  Acc: 0.9579
 Site-USPS                      (0) | Val  Loss: 0.1328 | Val  Acc: 0.9712
 Site-USPS                      (0) | Val  Loss: 0.1996 | Val  Acc: 0.9231
 Site-USPS                      (5) | Val  Loss: 0.2355 | Val  Acc: 0.8974
 Site-SynthDigits               (3) | Val  Loss: 0.4248 | Val  Acc: 0.8788
 Site-SynthDigits               (3) | Val  Loss: 0.2587 | Val  Acc: 0.9293
 Site-MNIST_M                   (1) | Val  Loss: 0.5681 | Val  Acc: 0.8182
 Site-MNIST_M                   (6) | Val  Loss: 0.5997 | Val  Acc: 0.8561
 Site-SVHN                      (4) | Val  Loss: 0.6724 | Val  Acc: 0.7877
Average Valid Accuracy: 0.9085
 Test site-MNIST                     (2)| Epoch:47 | Test Acc: 0.9429
 Test site-USPS                      (0)| Epoch:47 | Test Acc: 0.9484
 Test site-SynthDigits               (3)| Epoch:47 | Test Acc: 0.9008
 Test site-MNIST_M                   (1)| Epoch:47 | Test Acc: 0.7620
 Test site-SVHN                      (4)| Epoch:47 | Test Acc: 0.7064
MNIST: 0.9429, USPS: 0.9484, SynthDigits: 0.9008, MNIST_M: 0.7620, SVHN: 0.7064, 
Average Test Accuracy(group): 0.8521, Average Test Accuracy(individual): 0.8917,
domain std=0.0992, cluster std=0.0975, individual std=0.0836, 
Average Test Accuracy: 0.8521
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
============ Train epoch 49 ============
cnt=[1, 5, 1, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-MNIST                     (1) | Train Loss: 0.1890 | Train Acc: 0.9511
 Site-MNIST                     (1) | Train Loss: 0.1589 | Train Acc: 0.9645
 Site-MNIST                     (1) | Train Loss: 0.1832 | Train Acc: 0.9408
 Site-MNIST                     (1) | Train Loss: 0.2032 | Train Acc: 0.9448
 Site-MNIST                     (1) | Train Loss: 0.1599 | Train Acc: 0.9606
 Site-USPS                      (0) | Train Loss: 0.2297 | Train Acc: 0.9281
 Site-USPS                      (5) | Train Loss: 0.1992 | Train Acc: 0.9425
 Site-USPS                      (5) | Train Loss: 0.1964 | Train Acc: 0.9404
 Site-SynthDigits               (3) | Train Loss: 0.3203 | Train Acc: 0.9148
 Site-SynthDigits               (3) | Train Loss: 0.2887 | Train Acc: 0.9280
 Site-MNIST_M                   (2) | Train Loss: 0.5042 | Train Acc: 0.8722
 Site-MNIST_M                   (6) | Train Loss: 0.5039 | Train Acc: 0.8580
 Site-SVHN                      (4) | Train Loss: 0.6401 | Train Acc: 0.8109
Average Train Accuracy: 0.9197
 Site-MNIST                     (1) | Val  Loss: 0.1321 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1384 | Val  Acc: 0.9405
 Site-MNIST                     (1) | Val  Loss: 0.1760 | Val  Acc: 0.9444
 Site-MNIST                     (1) | Val  Loss: 0.2106 | Val  Acc: 0.9421
 Site-MNIST                     (1) | Val  Loss: 0.1757 | Val  Acc: 0.9649
 Site-USPS                      (0) | Val  Loss: 0.1302 | Val  Acc: 0.9712
 Site-USPS                      (5) | Val  Loss: 0.1967 | Val  Acc: 0.9359
 Site-USPS                      (5) | Val  Loss: 0.2305 | Val  Acc: 0.9017
 Site-SynthDigits               (3) | Val  Loss: 0.3938 | Val  Acc: 0.8864
 Site-SynthDigits               (3) | Val  Loss: 0.2512 | Val  Acc: 0.9293
 Site-MNIST_M                   (2) | Val  Loss: 0.5599 | Val  Acc: 0.8295
 Site-MNIST_M                   (6) | Val  Loss: 0.5859 | Val  Acc: 0.8636
 Site-SVHN                      (4) | Val  Loss: 0.6697 | Val  Acc: 0.8014
Average Valid Accuracy: 0.9135
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 0.9405
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 0.9444
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 0.9421
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 0.9649
 Best site-USPS                     (0)  | Epoch:49 | Val Acc: 0.9712
 Best site-USPS                     (5)  | Epoch:49 | Val Acc: 0.9359
 Best site-USPS                     (5)  | Epoch:49 | Val Acc: 0.9017
 Best site-SynthDigits              (3)  | Epoch:49 | Val Acc: 0.8864
 Best site-SynthDigits              (3)  | Epoch:49 | Val Acc: 0.9293
 Best site-MNIST_M                  (2)  | Epoch:49 | Val Acc: 0.8295
 Best site-MNIST_M                  (6)  | Epoch:49 | Val Acc: 0.8636
 Best site-SVHN                     (4)  | Epoch:49 | Val Acc: 0.8014
 Test site-MNIST                     (1)| Epoch:49 | Test Acc: 0.9434
 Test site-USPS                      (0)| Epoch:49 | Test Acc: 0.9495
 Test site-SynthDigits               (3)| Epoch:49 | Test Acc: 0.9036
 Test site-MNIST_M                   (2)| Epoch:49 | Test Acc: 0.7620
 Test site-SVHN                      (4)| Epoch:49 | Test Acc: 0.7043
MNIST: 0.9434, USPS: 0.9495, SynthDigits: 0.9036, MNIST_M: 0.7620, SVHN: 0.7043, 
Average Test Accuracy(group): 0.8526, Average Test Accuracy(individual): 0.8924,
domain std=0.1004, cluster std=0.0986, individual std=0.0843, 
Average Test Accuracy: 0.8526
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2_cluster_7/ccop_q=1...
===2023-08-12 17:53:00===
===2023-08-12 17:53:04===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 7
Loading snapshots...
 Test site-MNIST                     (1)| Epoch:49 | Test Acc: 0.9434
 Test site-USPS                      (0)| Epoch:49 | Test Acc: 0.9495
 Test site-SynthDigits               (3)| Epoch:49 | Test Acc: 0.9036
 Test site-MNIST_M                   (2)| Epoch:49 | Test Acc: 0.7620
 Test site-SVHN                      (4)| Epoch:49 | Test Acc: 0.7043
MNIST: 0.9434, USPS: 0.9495, SynthDigits: 0.9036, MNIST_M: 0.7620, SVHN: 0.7043, 
Average Test Accuracy(group): 0.8526, Average Test Accuracy(individual): 0.8924,
domain std=0.1004, cluster std=0.0986, individual std=0.0843, 
