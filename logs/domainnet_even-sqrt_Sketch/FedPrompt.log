===2023-03-26 18:51:20===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0509 | Train Acc: 0.3016
 Site-Clipart   | Train Loss: 1.9563 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 2.2203 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1712 | Train Acc: 0.2540
 Site-Painting  | Train Loss: 2.0172 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.9840 | Train Acc: 0.5079
 Site-QuickDraw | Train Loss: 2.2344 | Train Acc: 0.2381
 Site-QuickDraw | Train Loss: 2.1801 | Train Acc: 0.3016
 Site-Real      | Train Loss: 1.9241 | Train Acc: 0.5397
 Site-Real      | Train Loss: 1.9750 | Train Acc: 0.4762
 Site-Clipart   | Val  Loss: 2.0101 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 2.0330 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.1501 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1613 | Val  Acc: 0.1905
 Site-Painting  | Val  Loss: 1.9307 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 2.1141 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.1549 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 2.2250 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9501 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 2.0235 | Val  Acc: 0.5238
Average Valid Accuracy: 0.3714
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1905
 Best site-Painting   | Epoch:0 | Val Acc: 0.4286
 Best site-Painting   | Epoch:0 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1905
 Best site-Real       | Epoch:0 | Val Acc: 0.4524
 Best site-Real       | Epoch:0 | Val Acc: 0.5238
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.7143 | Train Acc: 0.5397
 Site-Clipart   | Train Loss: 1.6931 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 2.0674 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.9843 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.5414 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.5598 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.1060 | Train Acc: 0.2381
 Site-QuickDraw | Train Loss: 1.9759 | Train Acc: 0.4762
 Site-Real      | Train Loss: 1.3837 | Train Acc: 0.8413
 Site-Real      | Train Loss: 1.4721 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 1.7225 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.7026 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 2.0378 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.1419 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 1.4402 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 1.7380 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.9317 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 2.0621 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.3879 | Val  Acc: 0.8333
 Site-Real      | Val  Loss: 1.5033 | Val  Acc: 0.7857
Average Valid Accuracy: 0.5690
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3095
 Best site-Painting   | Epoch:1 | Val Acc: 0.8333
 Best site-Painting   | Epoch:1 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3571
 Best site-Real       | Epoch:1 | Val Acc: 0.8333
 Best site-Real       | Epoch:1 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.4116 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.4894 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 1.9513 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.8145 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 1.1716 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 1.2137 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 1.9190 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 1.7724 | Train Acc: 0.5079
 Site-Real      | Train Loss: 1.0707 | Train Acc: 0.8413
 Site-Real      | Train Loss: 1.1138 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.5170 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.4075 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.8272 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.0451 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.0867 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 1.4532 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.7011 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.8122 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 1.0499 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 1.1321 | Val  Acc: 0.8333
Average Valid Accuracy: 0.6452
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2857
 Best site-Painting   | Epoch:2 | Val Acc: 0.8333
 Best site-Painting   | Epoch:2 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4286
 Best site-Real       | Epoch:2 | Val Acc: 0.9286
 Best site-Real       | Epoch:2 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.1549 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.2157 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.8727 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.6701 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.9288 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.9550 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.7114 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 1.5843 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.7412 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.7401 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 1.3679 | Val  Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.1546 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.5937 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.9930 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 0.8973 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 1.1789 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.5077 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.6349 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.7149 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.8046 | Val  Acc: 0.9048
Average Valid Accuracy: 0.6762
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6429
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3095
 Best site-Painting   | Epoch:3 | Val Acc: 0.8333
 Best site-Painting   | Epoch:3 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5238
 Best site-Real       | Epoch:3 | Val Acc: 0.9524
 Best site-Real       | Epoch:3 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.9350 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.0784 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.6734 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.4956 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.7844 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.7894 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.6410 | Train Acc: 0.5397
 Site-QuickDraw | Train Loss: 1.3609 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.5627 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.5460 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 1.0974 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 0.9568 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.3627 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.6701 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.6731 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.9496 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.2616 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.3868 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 0.5110 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 0.6053 | Val  Acc: 0.9286
Average Valid Accuracy: 0.7429
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4286
 Best site-Painting   | Epoch:4 | Val Acc: 0.8810
 Best site-Painting   | Epoch:4 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.7143
 Best site-Real       | Epoch:4 | Val Acc: 0.8810
 Best site-Real       | Epoch:4 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.6901 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.8940 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.6487 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.4856 | Train Acc: 0.4762
 Site-Painting  | Train Loss: 0.5218 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.6108 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.4080 | Train Acc: 0.6349
 Site-QuickDraw | Train Loss: 1.2919 | Train Acc: 0.6032
 Site-Real      | Train Loss: 0.3953 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.3799 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.8617 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.9063 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3391 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.6885 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.5693 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.7096 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.2308 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.3951 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.3430 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.4041 | Val  Acc: 1.0000
Average Valid Accuracy: 0.7762
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4524
 Best site-Painting   | Epoch:5 | Val Acc: 0.9048
 Best site-Painting   | Epoch:5 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.6190
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Real       | Epoch:5 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.6420 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.7548 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.1715 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.1114 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.5489 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.4776 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.3634 | Train Acc: 0.5556
 Site-QuickDraw | Train Loss: 1.2509 | Train Acc: 0.6349
 Site-Real      | Train Loss: 0.4478 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.3336 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.6412 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.6379 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.0434 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2687 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.3019 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.5899 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.1919 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.3396 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.2894 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.3980 | Val  Acc: 0.9524
Average Valid Accuracy: 0.7833
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5714
 Best site-Painting   | Epoch:6 | Val Acc: 0.9524
 Best site-Painting   | Epoch:6 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5238
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.4680 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.6953 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.2786 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 1.1242 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.4038 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.4273 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.2260 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 1.0031 | Train Acc: 0.7302
 Site-Real      | Train Loss: 0.2096 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.2058 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.7271 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.7355 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.0044 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.2661 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.3952 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.4012 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 0.9189 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.1016 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 0.1853 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2285 | Val  Acc: 0.9762
Average Valid Accuracy: 0.8000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5714
 Best site-Painting   | Epoch:7 | Val Acc: 0.8810
 Best site-Painting   | Epoch:7 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.7143
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3554 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4641 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.0872 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 1.0527 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.2715 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2800 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.2316 | Train Acc: 0.6032
 Site-QuickDraw | Train Loss: 1.0763 | Train Acc: 0.6349
 Site-Real      | Train Loss: 0.2877 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.2026 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4797 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4851 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.0538 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1771 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.2331 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3461 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.0376 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.1960 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.2035 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2878 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8310
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6190
 Best site-Painting   | Epoch:8 | Val Acc: 0.9762
 Best site-Painting   | Epoch:8 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.6190
 Best site-Real       | Epoch:8 | Val Acc: 0.9524
 Best site-Real       | Epoch:8 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.3705 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.4610 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.0855 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.8603 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.2939 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2907 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.0549 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 0.8915 | Train Acc: 0.7460
 Site-Real      | Train Loss: 0.1770 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.1315 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.5152 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3915 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.8081 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.1216 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 0.2251 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3613 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 0.7770 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.0191 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 0.1213 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1473 | Val  Acc: 0.9762
Average Valid Accuracy: 0.8786
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7143
 Best site-Painting   | Epoch:9 | Val Acc: 0.9762
 Best site-Painting   | Epoch:9 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.7381
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
===2023-03-26 19:18:35===
===2023-03-26 19:18:36===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 3
Loading snapshots...
Test Accuracy of Sketch: 0.7563
Average Test Accuracy: 0.7563
===2023-03-28 00:49:25===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0321 | Train Acc: 0.3175
 Site-Clipart   | Train Loss: 1.9423 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 2.2114 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1563 | Train Acc: 0.2540
 Site-Painting  | Train Loss: 1.9701 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 1.9439 | Train Acc: 0.5397
 Site-QuickDraw | Train Loss: 2.2643 | Train Acc: 0.1746
 Site-QuickDraw | Train Loss: 2.1840 | Train Acc: 0.3016
 Site-Real      | Train Loss: 1.8856 | Train Acc: 0.6667
 Site-Real      | Train Loss: 1.9434 | Train Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.9863 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 2.0176 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.1303 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1519 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 1.8859 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 2.0860 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 2.1630 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.2122 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.9358 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 1.9725 | Val  Acc: 0.5714
Average Valid Accuracy: 0.3952
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Painting   | Epoch:0 | Val Acc: 0.5000
 Best site-Painting   | Epoch:0 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2143
 Best site-Real       | Epoch:0 | Val Acc: 0.5238
 Best site-Real       | Epoch:0 | Val Acc: 0.5714
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.7305 | Train Acc: 0.5079
 Site-Clipart   | Train Loss: 1.7004 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 2.0886 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.0063 | Train Acc: 0.3810
 Site-Painting  | Train Loss: 1.5481 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 1.5532 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 2.1243 | Train Acc: 0.2222
 Site-QuickDraw | Train Loss: 1.9494 | Train Acc: 0.4444
 Site-Real      | Train Loss: 1.3193 | Train Acc: 0.8889
 Site-Real      | Train Loss: 1.4363 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.7110 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.7349 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 2.0755 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.1714 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.4429 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 1.7042 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.9092 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 2.0427 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.3405 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 1.4118 | Val  Acc: 0.7619
Average Valid Accuracy: 0.5643
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2857
 Best site-Painting   | Epoch:1 | Val Acc: 0.7619
 Best site-Painting   | Epoch:1 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3333
 Best site-Real       | Epoch:1 | Val Acc: 0.8810
 Best site-Real       | Epoch:1 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.3635 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.4290 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 1.9342 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.7548 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 1.0958 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 1.1407 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 1.8860 | Train Acc: 0.4286
 Site-QuickDraw | Train Loss: 1.7498 | Train Acc: 0.6032
 Site-Real      | Train Loss: 0.9613 | Train Acc: 0.8413
 Site-Real      | Train Loss: 1.0003 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 1.4924 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.3384 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7478 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 2.0219 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 1.0160 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 1.3748 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.6446 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.7595 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.9496 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 1.0136 | Val  Acc: 0.8095
Average Valid Accuracy: 0.6452
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2619
 Best site-Painting   | Epoch:2 | Val Acc: 0.8333
 Best site-Painting   | Epoch:2 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.5238
 Best site-Real       | Epoch:2 | Val Acc: 0.9286
 Best site-Real       | Epoch:2 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.0932 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.0575 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.7684 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.5942 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 0.8095 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.8649 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 1.7604 | Train Acc: 0.4921
 Site-QuickDraw | Train Loss: 1.6156 | Train Acc: 0.6032
 Site-Real      | Train Loss: 0.6312 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.6229 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 1.2279 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.0688 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.4899 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8715 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 0.8008 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 1.0968 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.5474 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.7215 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.5940 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.6621 | Val  Acc: 0.9286
Average Valid Accuracy: 0.6976
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3810
 Best site-Painting   | Epoch:3 | Val Acc: 0.8333
 Best site-Painting   | Epoch:3 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5000
 Best site-Real       | Epoch:3 | Val Acc: 0.9524
 Best site-Real       | Epoch:3 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.9053 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.0076 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 1.6914 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.4827 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.6817 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.7199 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.6224 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 1.3551 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.4997 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.4505 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 1.0450 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 0.9195 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.3480 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.6817 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.5976 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.8212 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.2676 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.4707 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.4072 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.5114 | Val  Acc: 0.9286
Average Valid Accuracy: 0.7357
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4048
 Best site-Painting   | Epoch:4 | Val Acc: 0.9048
 Best site-Painting   | Epoch:4 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5476
 Best site-Real       | Epoch:4 | Val Acc: 0.9524
 Best site-Real       | Epoch:4 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.6669 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.8441 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.6582 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.5054 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 0.4678 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.5847 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 1.3762 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 1.3499 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.3241 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.2930 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.7964 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.8195 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.3966 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.7075 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.5106 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.6130 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.2348 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 1.4684 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.2642 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.3280 | Val  Acc: 1.0000
Average Valid Accuracy: 0.7548
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4286
 Best site-Painting   | Epoch:5 | Val Acc: 0.9048
 Best site-Painting   | Epoch:5 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5714
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Real       | Epoch:5 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.6265 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.7169 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.3042 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1074 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.4744 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.3941 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.1984 | Train Acc: 0.6349
 Site-QuickDraw | Train Loss: 1.0067 | Train Acc: 0.7302
 Site-Real      | Train Loss: 0.3314 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.2156 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.6069 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.6073 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.0485 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.4441 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.2649 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.4982 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 0.8363 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.1663 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.1807 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3136 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8167
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:6 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4524
 Best site-Painting   | Epoch:6 | Val Acc: 0.9762
 Best site-Painting   | Epoch:6 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6667
 Best site-Real       | Epoch:6 | Val Acc: 1.0000
 Best site-Real       | Epoch:6 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.3495 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.5447 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.2823 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.0480 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.3571 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.3177 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.0822 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 0.9457 | Train Acc: 0.7460
 Site-Real      | Train Loss: 0.1641 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.1534 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.5877 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5029 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.9485 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.2074 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.2872 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.3621 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 0.8540 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.1030 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.1492 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1637 | Val  Acc: 0.9762
Average Valid Accuracy: 0.8357
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6190
 Best site-Painting   | Epoch:7 | Val Acc: 0.9524
 Best site-Painting   | Epoch:7 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.6429
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3150 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3838 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.0566 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.9192 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.2250 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.2793 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.0372 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 0.8181 | Train Acc: 0.7302
 Site-Real      | Train Loss: 0.2399 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.1168 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.4571 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4212 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.7409 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.0892 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.2194 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2870 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 0.7449 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 0.9254 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.1172 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2505 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8595
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5714
 Best site-Painting   | Epoch:8 | Val Acc: 1.0000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.6905
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Real       | Epoch:8 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2741 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3256 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.9533 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.6942 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.1844 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.2078 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.8865 | Train Acc: 0.7460
 Site-QuickDraw | Train Loss: 0.7265 | Train Acc: 0.7619
 Site-Real      | Train Loss: 0.1414 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.0854 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.3344 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2828 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.6215 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.0113 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.1332 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2342 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 0.6207 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 0.9944 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.0679 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1269 | Val  Acc: 0.9762
Average Valid Accuracy: 0.8833
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6190
 Best site-Painting   | Epoch:9 | Val Acc: 1.0000
 Best site-Painting   | Epoch:9 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.6905
 Best site-Real       | Epoch:9 | Val Acc: 1.0000
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Sketch...
===2023-03-28 01:16:24===
===2023-03-28 01:16:26===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of Sketch: 0.7491
Average Test Accuracy: 0.7491
