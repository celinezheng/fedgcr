===2023-05-30 12:04:42===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0.7
    std_rw: False
data_number=[139,417,139,417,139,417,139,417,139,417,139,417,139,417,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1856,1856,1856,1856,1856,1856,1856,]
label set of clients: [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
min_w=0.03571, quan_i=1.00, quan_c=1.00
minimize weight of clients:[]
 Site-White                    | Train Loss: 2.0347 | Train Acc: 0.3669
 Site-White                    | Train Loss: 1.8113 | Train Acc: 0.3573
 Site-Latino_Hispanic          | Train Loss: 1.9740 | Train Acc: 0.2878
 Site-Latino_Hispanic          | Train Loss: 2.0301 | Train Acc: 0.2686
 Site-Black                    | Train Loss: 2.1977 | Train Acc: 0.2302
 Site-Black                    | Train Loss: 2.0367 | Train Acc: 0.2494
 Site-East_Asian               | Train Loss: 1.8523 | Train Acc: 0.3741
 Site-East_Asian               | Train Loss: 1.8194 | Train Acc: 0.3789
 Site-Indian                   | Train Loss: 1.9473 | Train Acc: 0.2446
 Site-Indian                   | Train Loss: 2.1591 | Train Acc: 0.2422
 Site-Southeast_Asian          | Train Loss: 2.0254 | Train Acc: 0.3094
 Site-Southeast_Asian          | Train Loss: 2.1201 | Train Acc: 0.2974
 Site-Middle_Eastern           | Train Loss: 1.9939 | Train Acc: 0.2734
 Site-Middle_Eastern           | Train Loss: 2.0398 | Train Acc: 0.2494
 Site-White                     (1) | Val  Loss: 1.9652 | Val  Acc: 0.3152
 Site-White                     (1) | Val  Loss: 1.8583 | Val  Acc: 0.3417
 Site-Latino_Hispanic           (4) | Val  Loss: 2.0372 | Val  Acc: 0.2826
 Site-Latino_Hispanic           (4) | Val  Loss: 1.9914 | Val  Acc: 0.2734
 Site-Black                     (0) | Val  Loss: 1.9975 | Val  Acc: 0.2500
 Site-Black                     (0) | Val  Loss: 1.9915 | Val  Acc: 0.2482
 Site-East_Asian                (2) | Val  Loss: 1.7620 | Val  Acc: 0.4130
 Site-East_Asian                (2) | Val  Loss: 1.8558 | Val  Acc: 0.3741
 Site-Indian                    (5) | Val  Loss: 2.1217 | Val  Acc: 0.2500
 Site-Indian                    (5) | Val  Loss: 2.1364 | Val  Acc: 0.2374
 Site-Southeast_Asian           (3) | Val  Loss: 2.0764 | Val  Acc: 0.2935
 Site-Southeast_Asian           (3) | Val  Loss: 2.0866 | Val  Acc: 0.3022
 Site-Middle_Eastern            (6) | Val  Loss: 1.9516 | Val  Acc: 0.2717
 Site-Middle_Eastern            (6) | Val  Loss: 2.0418 | Val  Acc: 0.2554
Average Valid Accuracy: 0.2935
Aggregated Acc | Val Acc: 0.2935
 Best site-White                    (1)  | Epoch:0 | Val Acc: 0.3152
 Best site-White                    (1)  | Epoch:0 | Val Acc: 0.3417
 Best site-Latino_Hispanic          (4)  | Epoch:0 | Val Acc: 0.2826
 Best site-Latino_Hispanic          (4)  | Epoch:0 | Val Acc: 0.2734
 Best site-Black                    (0)  | Epoch:0 | Val Acc: 0.2500
 Best site-Black                    (0)  | Epoch:0 | Val Acc: 0.2482
 Best site-East_Asian               (2)  | Epoch:0 | Val Acc: 0.4130
 Best site-East_Asian               (2)  | Epoch:0 | Val Acc: 0.3741
 Best site-Indian                   (5)  | Epoch:0 | Val Acc: 0.2500
 Best site-Indian                   (5)  | Epoch:0 | Val Acc: 0.2374
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.2935
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.3022
 Best site-Middle_Eastern           (6)  | Epoch:0 | Val Acc: 0.2717
 Best site-Middle_Eastern           (6)  | Epoch:0 | Val Acc: 0.2554
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 2, 2, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
min_w=0.12779, quan_i=2.04, quan_c=2.09
minimize weight of clients:[1, 2, 6, 7, 12, ]
 Site-White                    | Train Loss: 1.7450 | Train Acc: 0.3669
 Site-White                    | Train Loss: 1.8130 | Train Acc: 0.3501
 Site-Latino_Hispanic          | Train Loss: 1.9435 | Train Acc: 0.2878
 Site-Latino_Hispanic          | Train Loss: 1.8997 | Train Acc: 0.2710
 Site-Black                    | Train Loss: 1.9704 | Train Acc: 0.2014
 Site-Black                    | Train Loss: 1.9011 | Train Acc: 0.2566
 Site-East_Asian               | Train Loss: 1.7602 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.7784 | Train Acc: 0.3693
 Site-Indian                   | Train Loss: 1.9087 | Train Acc: 0.2878
 Site-Indian                   | Train Loss: 2.0382 | Train Acc: 0.2374
 Site-Southeast_Asian          | Train Loss: 2.0482 | Train Acc: 0.2950
 Site-Southeast_Asian          | Train Loss: 2.0005 | Train Acc: 0.2902
 Site-Middle_Eastern           | Train Loss: 1.9048 | Train Acc: 0.2734
 Site-Middle_Eastern           | Train Loss: 1.9295 | Train Acc: 0.2878
 Site-White                     (0) | Val  Loss: 1.9054 | Val  Acc: 0.2826
 Site-White                     (6) | Val  Loss: 1.8194 | Val  Acc: 0.3381
 Site-Latino_Hispanic           (0) | Val  Loss: 1.9546 | Val  Acc: 0.3370
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8817 | Val  Acc: 0.2734
 Site-Black                     (4) | Val  Loss: 1.8695 | Val  Acc: 0.3043
 Site-Black                     (4) | Val  Loss: 1.8912 | Val  Acc: 0.2914
 Site-East_Asian                (5) | Val  Loss: 1.7205 | Val  Acc: 0.4022
 Site-East_Asian                (5) | Val  Loss: 1.7950 | Val  Acc: 0.3669
 Site-Indian                    (3) | Val  Loss: 2.0141 | Val  Acc: 0.2500
 Site-Indian                    (3) | Val  Loss: 2.0301 | Val  Acc: 0.2374
 Site-Southeast_Asian           (1) | Val  Loss: 1.9879 | Val  Acc: 0.2826
 Site-Southeast_Asian           (1) | Val  Loss: 1.9846 | Val  Acc: 0.3058
 Site-Middle_Eastern            (2) | Val  Loss: 1.8501 | Val  Acc: 0.2717
 Site-Middle_Eastern            (2) | Val  Loss: 1.9045 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3012
Aggregated Acc | Val Acc: 0.3005
 Best site-White                    (0)  | Epoch:1 | Val Acc: 0.2826
 Best site-White                    (6)  | Epoch:1 | Val Acc: 0.3381
 Best site-Latino_Hispanic          (0)  | Epoch:1 | Val Acc: 0.3370
 Best site-Latino_Hispanic          (5)  | Epoch:1 | Val Acc: 0.2734
 Best site-Black                    (4)  | Epoch:1 | Val Acc: 0.3043
 Best site-Black                    (4)  | Epoch:1 | Val Acc: 0.2914
 Best site-East_Asian               (5)  | Epoch:1 | Val Acc: 0.4022
 Best site-East_Asian               (5)  | Epoch:1 | Val Acc: 0.3669
 Best site-Indian                   (3)  | Epoch:1 | Val Acc: 0.2500
 Best site-Indian                   (3)  | Epoch:1 | Val Acc: 0.2374
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2826
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.3058
 Best site-Middle_Eastern           (2)  | Epoch:1 | Val Acc: 0.2717
 Best site-Middle_Eastern           (2)  | Epoch:1 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 3, 3, 2, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
min_w=0.10992, quan_i=1.96, quan_c=1.97
minimize weight of clients:[0, 1, 2, 5, 6, 7, 12, 13, ]
 Site-White                    | Train Loss: 1.8193 | Train Acc: 0.3741
 Site-White                    | Train Loss: 1.7799 | Train Acc: 0.3645
 Site-Latino_Hispanic          | Train Loss: 1.8877 | Train Acc: 0.3022
 Site-Latino_Hispanic          | Train Loss: 1.8875 | Train Acc: 0.2710
 Site-Black                    | Train Loss: 2.0577 | Train Acc: 0.2230
 Site-Black                    | Train Loss: 1.8904 | Train Acc: 0.2566
 Site-East_Asian               | Train Loss: 1.7585 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.7303 | Train Acc: 0.3837
 Site-Indian                   | Train Loss: 1.9315 | Train Acc: 0.2590
 Site-Indian                   | Train Loss: 1.9675 | Train Acc: 0.2470
 Site-Southeast_Asian          | Train Loss: 1.8941 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.9485 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.9249 | Train Acc: 0.2734
 Site-Middle_Eastern           | Train Loss: 1.8850 | Train Acc: 0.2662
 Site-White                     (0) | Val  Loss: 1.8595 | Val  Acc: 0.2935
 Site-White                     (1) | Val  Loss: 1.8030 | Val  Acc: 0.3417
 Site-Latino_Hispanic           (4) | Val  Loss: 1.9051 | Val  Acc: 0.3152
 Site-Latino_Hispanic           (2) | Val  Loss: 1.8657 | Val  Acc: 0.2914
 Site-Black                     (6) | Val  Loss: 1.8308 | Val  Acc: 0.2826
 Site-Black                     (6) | Val  Loss: 1.8666 | Val  Acc: 0.2662
 Site-East_Asian                (5) | Val  Loss: 1.6650 | Val  Acc: 0.4348
 Site-East_Asian                (5) | Val  Loss: 1.7553 | Val  Acc: 0.3741
 Site-Indian                    (2) | Val  Loss: 1.9943 | Val  Acc: 0.2283
 Site-Indian                    (2) | Val  Loss: 1.9710 | Val  Acc: 0.2482
 Site-Southeast_Asian           (3) | Val  Loss: 1.9034 | Val  Acc: 0.3261
 Site-Southeast_Asian           (3) | Val  Loss: 1.9010 | Val  Acc: 0.3129
 Site-Middle_Eastern            (1) | Val  Loss: 1.8296 | Val  Acc: 0.2717
 Site-Middle_Eastern            (1) | Val  Loss: 1.9043 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3043
Aggregated Acc | Val Acc: 0.3084
 Best site-White                    (0)  | Epoch:2 | Val Acc: 0.2935
 Best site-White                    (1)  | Epoch:2 | Val Acc: 0.3417
 Best site-Latino_Hispanic          (4)  | Epoch:2 | Val Acc: 0.3152
 Best site-Latino_Hispanic          (2)  | Epoch:2 | Val Acc: 0.2914
 Best site-Black                    (6)  | Epoch:2 | Val Acc: 0.2826
 Best site-Black                    (6)  | Epoch:2 | Val Acc: 0.2662
 Best site-East_Asian               (5)  | Epoch:2 | Val Acc: 0.4348
 Best site-East_Asian               (5)  | Epoch:2 | Val Acc: 0.3741
 Best site-Indian                   (2)  | Epoch:2 | Val Acc: 0.2283
 Best site-Indian                   (2)  | Epoch:2 | Val Acc: 0.2482
 Best site-Southeast_Asian          (3)  | Epoch:2 | Val Acc: 0.3261
 Best site-Southeast_Asian          (3)  | Epoch:2 | Val Acc: 0.3129
 Best site-Middle_Eastern           (1)  | Epoch:2 | Val Acc: 0.2717
 Best site-Middle_Eastern           (1)  | Epoch:2 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 3 ============
cnt=[3, 3, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
min_w=0.11337, quan_i=1.96, quan_c=1.96
minimize weight of clients:[0, 1, 3, 6, 7, 10, 13, ]
 Site-White                    | Train Loss: 1.7860 | Train Acc: 0.3453
 Site-White                    | Train Loss: 1.7572 | Train Acc: 0.3669
 Site-Latino_Hispanic          | Train Loss: 1.8010 | Train Acc: 0.2590
 Site-Latino_Hispanic          | Train Loss: 1.8500 | Train Acc: 0.2758
 Site-Black                    | Train Loss: 2.0119 | Train Acc: 0.2446
 Site-Black                    | Train Loss: 1.8696 | Train Acc: 0.2734
 Site-East_Asian               | Train Loss: 1.7550 | Train Acc: 0.3885
 Site-East_Asian               | Train Loss: 1.7045 | Train Acc: 0.4005
 Site-Indian                   | Train Loss: 1.8636 | Train Acc: 0.2878
 Site-Indian                   | Train Loss: 1.9360 | Train Acc: 0.2518
 Site-Southeast_Asian          | Train Loss: 1.9153 | Train Acc: 0.3381
 Site-Southeast_Asian          | Train Loss: 1.8813 | Train Acc: 0.3213
 Site-Middle_Eastern           | Train Loss: 1.8299 | Train Acc: 0.3094
 Site-Middle_Eastern           | Train Loss: 1.8672 | Train Acc: 0.3022
 Site-White                     (4) | Val  Loss: 1.8544 | Val  Acc: 0.2717
 Site-White                     (1) | Val  Loss: 1.7781 | Val  Acc: 0.3597
 Site-Latino_Hispanic           (0) | Val  Loss: 1.8774 | Val  Acc: 0.3043
 Site-Latino_Hispanic           (6) | Val  Loss: 1.8352 | Val  Acc: 0.2914
 Site-Black                     (2) | Val  Loss: 1.7797 | Val  Acc: 0.3478
 Site-Black                     (2) | Val  Loss: 1.8386 | Val  Acc: 0.2662
 Site-East_Asian                (3) | Val  Loss: 1.6663 | Val  Acc: 0.4348
 Site-East_Asian                (3) | Val  Loss: 1.7355 | Val  Acc: 0.3597
 Site-Indian                    (0) | Val  Loss: 1.9612 | Val  Acc: 0.2174
 Site-Indian                    (0) | Val  Loss: 1.9295 | Val  Acc: 0.2446
 Site-Southeast_Asian           (5) | Val  Loss: 1.8733 | Val  Acc: 0.3152
 Site-Southeast_Asian           (5) | Val  Loss: 1.8710 | Val  Acc: 0.3094
 Site-Middle_Eastern            (1) | Val  Loss: 1.7886 | Val  Acc: 0.3913
 Site-Middle_Eastern            (1) | Val  Loss: 1.8704 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3136
Aggregated Acc | Val Acc: 0.3111
 Best site-White                    (4)  | Epoch:3 | Val Acc: 0.2717
 Best site-White                    (1)  | Epoch:3 | Val Acc: 0.3597
 Best site-Latino_Hispanic          (0)  | Epoch:3 | Val Acc: 0.3043
 Best site-Latino_Hispanic          (6)  | Epoch:3 | Val Acc: 0.2914
 Best site-Black                    (2)  | Epoch:3 | Val Acc: 0.3478
 Best site-Black                    (2)  | Epoch:3 | Val Acc: 0.2662
 Best site-East_Asian               (3)  | Epoch:3 | Val Acc: 0.4348
 Best site-East_Asian               (3)  | Epoch:3 | Val Acc: 0.3597
 Best site-Indian                   (0)  | Epoch:3 | Val Acc: 0.2174
 Best site-Indian                   (0)  | Epoch:3 | Val Acc: 0.2446
 Best site-Southeast_Asian          (5)  | Epoch:3 | Val Acc: 0.3152
 Best site-Southeast_Asian          (5)  | Epoch:3 | Val Acc: 0.3094
 Best site-Middle_Eastern           (1)  | Epoch:3 | Val Acc: 0.3913
 Best site-Middle_Eastern           (1)  | Epoch:3 | Val Acc: 0.2770
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 2, 3, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
min_w=0.11267, quan_i=1.89, quan_c=1.88
minimize weight of clients:[0, 1, 2, 3, 6, 7, 12, ]
 Site-White                    | Train Loss: 1.6270 | Train Acc: 0.3453
 Site-White                    | Train Loss: 1.7192 | Train Acc: 0.3981
 Site-Latino_Hispanic          | Train Loss: 1.8279 | Train Acc: 0.2950
 Site-Latino_Hispanic          | Train Loss: 1.8376 | Train Acc: 0.2926
 Site-Black                    | Train Loss: 1.9415 | Train Acc: 0.2230
 Site-Black                    | Train Loss: 1.8437 | Train Acc: 0.2782
 Site-East_Asian               | Train Loss: 1.6662 | Train Acc: 0.4173
 Site-East_Asian               | Train Loss: 1.6911 | Train Acc: 0.3861
 Site-Indian                   | Train Loss: 1.6936 | Train Acc: 0.3237
 Site-Indian                   | Train Loss: 1.9091 | Train Acc: 0.2662
 Site-Southeast_Asian          | Train Loss: 1.8202 | Train Acc: 0.3022
 Site-Southeast_Asian          | Train Loss: 1.8362 | Train Acc: 0.3477
 Site-Middle_Eastern           | Train Loss: 1.8450 | Train Acc: 0.2950
 Site-Middle_Eastern           | Train Loss: 1.8098 | Train Acc: 0.3213
 Site-White                     (6) | Val  Loss: 1.7981 | Val  Acc: 0.3043
 Site-White                     (6) | Val  Loss: 1.7562 | Val  Acc: 0.3561
 Site-Latino_Hispanic           (4) | Val  Loss: 1.8774 | Val  Acc: 0.3043
 Site-Latino_Hispanic           (3) | Val  Loss: 1.7976 | Val  Acc: 0.3165
 Site-Black                     (1) | Val  Loss: 1.7461 | Val  Acc: 0.3804
 Site-Black                     (1) | Val  Loss: 1.8195 | Val  Acc: 0.2698
 Site-East_Asian                (0) | Val  Loss: 1.6196 | Val  Acc: 0.4239
 Site-East_Asian                (0) | Val  Loss: 1.6994 | Val  Acc: 0.4101
 Site-Indian                    (5) | Val  Loss: 1.8957 | Val  Acc: 0.2826
 Site-Indian                    (5) | Val  Loss: 1.8823 | Val  Acc: 0.2770
 Site-Southeast_Asian           (3) | Val  Loss: 1.8030 | Val  Acc: 0.3478
 Site-Southeast_Asian           (3) | Val  Loss: 1.8130 | Val  Acc: 0.3525
 Site-Middle_Eastern            (2) | Val  Loss: 1.7450 | Val  Acc: 0.3478
 Site-Middle_Eastern            (2) | Val  Loss: 1.8181 | Val  Acc: 0.3058
Average Valid Accuracy: 0.3342
Aggregated Acc | Val Acc: 0.3317
 Best site-White                    (6)  | Epoch:4 | Val Acc: 0.3043
 Best site-White                    (6)  | Epoch:4 | Val Acc: 0.3561
 Best site-Latino_Hispanic          (4)  | Epoch:4 | Val Acc: 0.3043
 Best site-Latino_Hispanic          (3)  | Epoch:4 | Val Acc: 0.3165
 Best site-Black                    (1)  | Epoch:4 | Val Acc: 0.3804
 Best site-Black                    (1)  | Epoch:4 | Val Acc: 0.2698
 Best site-East_Asian               (0)  | Epoch:4 | Val Acc: 0.4239
 Best site-East_Asian               (0)  | Epoch:4 | Val Acc: 0.4101
 Best site-Indian                   (5)  | Epoch:4 | Val Acc: 0.2826
 Best site-Indian                   (5)  | Epoch:4 | Val Acc: 0.2770
 Best site-Southeast_Asian          (3)  | Epoch:4 | Val Acc: 0.3478
 Best site-Southeast_Asian          (3)  | Epoch:4 | Val Acc: 0.3525
 Best site-Middle_Eastern           (2)  | Epoch:4 | Val Acc: 0.3478
 Best site-Middle_Eastern           (2)  | Epoch:4 | Val Acc: 0.3058
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
min_w=0.09771, quan_i=1.85, quan_c=1.85
minimize weight of clients:[0, 1, 6, 7, 13, ]
 Site-White                    | Train Loss: 1.7590 | Train Acc: 0.3669
 Site-White                    | Train Loss: 1.6983 | Train Acc: 0.3789
 Site-Latino_Hispanic          | Train Loss: 1.7649 | Train Acc: 0.2950
 Site-Latino_Hispanic          | Train Loss: 1.8068 | Train Acc: 0.3070
 Site-Black                    | Train Loss: 1.8907 | Train Acc: 0.2518
 Site-Black                    | Train Loss: 1.8192 | Train Acc: 0.2878
 Site-East_Asian               | Train Loss: 1.6035 | Train Acc: 0.4173
 Site-East_Asian               | Train Loss: 1.6530 | Train Acc: 0.4245
 Site-Indian                   | Train Loss: 1.7498 | Train Acc: 0.3165
 Site-Indian                   | Train Loss: 1.8707 | Train Acc: 0.2686
 Site-Southeast_Asian          | Train Loss: 1.7821 | Train Acc: 0.3597
 Site-Southeast_Asian          | Train Loss: 1.8227 | Train Acc: 0.3573
 Site-Middle_Eastern           | Train Loss: 1.7532 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.7754 | Train Acc: 0.3309
 Site-White                     (0) | Val  Loss: 1.7850 | Val  Acc: 0.3043
 Site-White                     (0) | Val  Loss: 1.7146 | Val  Acc: 0.3777
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8235 | Val  Acc: 0.3261
 Site-Latino_Hispanic           (5) | Val  Loss: 1.7626 | Val  Acc: 0.3201
 Site-Black                     (1) | Val  Loss: 1.7322 | Val  Acc: 0.3478
 Site-Black                     (1) | Val  Loss: 1.7783 | Val  Acc: 0.3058
 Site-East_Asian                (6) | Val  Loss: 1.5995 | Val  Acc: 0.4457
 Site-East_Asian                (6) | Val  Loss: 1.6638 | Val  Acc: 0.4317
 Site-Indian                    (3) | Val  Loss: 1.9033 | Val  Acc: 0.2283
 Site-Indian                    (3) | Val  Loss: 1.8408 | Val  Acc: 0.2842
 Site-Southeast_Asian           (2) | Val  Loss: 1.7748 | Val  Acc: 0.3696
 Site-Southeast_Asian           (2) | Val  Loss: 1.7816 | Val  Acc: 0.3669
 Site-Middle_Eastern            (4) | Val  Loss: 1.7420 | Val  Acc: 0.4022
 Site-Middle_Eastern            (4) | Val  Loss: 1.7884 | Val  Acc: 0.3129
Average Valid Accuracy: 0.3445
Aggregated Acc | Val Acc: 0.3445
 Best site-White                    (0)  | Epoch:5 | Val Acc: 0.3043
 Best site-White                    (0)  | Epoch:5 | Val Acc: 0.3777
 Best site-Latino_Hispanic          (5)  | Epoch:5 | Val Acc: 0.3261
 Best site-Latino_Hispanic          (5)  | Epoch:5 | Val Acc: 0.3201
 Best site-Black                    (1)  | Epoch:5 | Val Acc: 0.3478
 Best site-Black                    (1)  | Epoch:5 | Val Acc: 0.3058
 Best site-East_Asian               (6)  | Epoch:5 | Val Acc: 0.4457
 Best site-East_Asian               (6)  | Epoch:5 | Val Acc: 0.4317
 Best site-Indian                   (3)  | Epoch:5 | Val Acc: 0.2283
 Best site-Indian                   (3)  | Epoch:5 | Val Acc: 0.2842
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.3696
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.3669
 Best site-Middle_Eastern           (4)  | Epoch:5 | Val Acc: 0.4022
 Best site-Middle_Eastern           (4)  | Epoch:5 | Val Acc: 0.3129
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 6 ============
cnt=[4, 2, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
min_w=0.09411, quan_i=1.82, quan_c=1.84
minimize weight of clients:[0, 1, 2, 3, 6, 7, 10, 12, 13, ]
 Site-White                    | Train Loss: 1.7070 | Train Acc: 0.3669
 Site-White                    | Train Loss: 1.6863 | Train Acc: 0.3861
 Site-Latino_Hispanic          | Train Loss: 1.7265 | Train Acc: 0.3309
 Site-Latino_Hispanic          | Train Loss: 1.7810 | Train Acc: 0.3213
 Site-Black                    | Train Loss: 1.8451 | Train Acc: 0.2662
 Site-Black                    | Train Loss: 1.7971 | Train Acc: 0.2758
 Site-East_Asian               | Train Loss: 1.6295 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.6275 | Train Acc: 0.4245
 Site-Indian                   | Train Loss: 1.7990 | Train Acc: 0.3165
 Site-Indian                   | Train Loss: 1.8210 | Train Acc: 0.2878
 Site-Southeast_Asian          | Train Loss: 1.8205 | Train Acc: 0.3525
 Site-Southeast_Asian          | Train Loss: 1.7885 | Train Acc: 0.3741
 Site-Middle_Eastern           | Train Loss: 1.6664 | Train Acc: 0.3525
 Site-Middle_Eastern           | Train Loss: 1.7554 | Train Acc: 0.3477
 Site-White                     (0) | Val  Loss: 1.7419 | Val  Acc: 0.3804
 Site-White                     (0) | Val  Loss: 1.6915 | Val  Acc: 0.3633
 Site-Latino_Hispanic           (6) | Val  Loss: 1.8163 | Val  Acc: 0.3370
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7697 | Val  Acc: 0.3201
 Site-Black                     (5) | Val  Loss: 1.7056 | Val  Acc: 0.4130
 Site-Black                     (5) | Val  Loss: 1.7661 | Val  Acc: 0.3201
 Site-East_Asian                (3) | Val  Loss: 1.5382 | Val  Acc: 0.4891
 Site-East_Asian                (3) | Val  Loss: 1.6623 | Val  Acc: 0.4137
 Site-Indian                    (1) | Val  Loss: 1.8392 | Val  Acc: 0.2826
 Site-Indian                    (1) | Val  Loss: 1.8490 | Val  Acc: 0.2698
 Site-Southeast_Asian           (2) | Val  Loss: 1.7330 | Val  Acc: 0.3587
 Site-Southeast_Asian           (2) | Val  Loss: 1.7503 | Val  Acc: 0.3633
 Site-Middle_Eastern            (0) | Val  Loss: 1.6841 | Val  Acc: 0.4022
 Site-Middle_Eastern            (0) | Val  Loss: 1.7674 | Val  Acc: 0.3489
Average Valid Accuracy: 0.3616
Aggregated Acc | Val Acc: 0.3551
 Best site-White                    (0)  | Epoch:6 | Val Acc: 0.3804
 Best site-White                    (0)  | Epoch:6 | Val Acc: 0.3633
 Best site-Latino_Hispanic          (6)  | Epoch:6 | Val Acc: 0.3370
 Best site-Latino_Hispanic          (4)  | Epoch:6 | Val Acc: 0.3201
 Best site-Black                    (5)  | Epoch:6 | Val Acc: 0.4130
 Best site-Black                    (5)  | Epoch:6 | Val Acc: 0.3201
 Best site-East_Asian               (3)  | Epoch:6 | Val Acc: 0.4891
 Best site-East_Asian               (3)  | Epoch:6 | Val Acc: 0.4137
 Best site-Indian                   (1)  | Epoch:6 | Val Acc: 0.2826
 Best site-Indian                   (1)  | Epoch:6 | Val Acc: 0.2698
 Best site-Southeast_Asian          (2)  | Epoch:6 | Val Acc: 0.3587
 Best site-Southeast_Asian          (2)  | Epoch:6 | Val Acc: 0.3633
 Best site-Middle_Eastern           (0)  | Epoch:6 | Val Acc: 0.4022
 Best site-Middle_Eastern           (0)  | Epoch:6 | Val Acc: 0.3489
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 2, 4, 2, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
min_w=0.09906, quan_i=1.82, quan_c=1.79
minimize weight of clients:[0, 1, 2, 3, 6, 7, 12, 13, ]
 Site-White                    | Train Loss: 1.6748 | Train Acc: 0.4101
 Site-White                    | Train Loss: 1.6666 | Train Acc: 0.3933
 Site-Latino_Hispanic          | Train Loss: 1.8180 | Train Acc: 0.3381
 Site-Latino_Hispanic          | Train Loss: 1.7697 | Train Acc: 0.3357
 Site-Black                    | Train Loss: 1.8129 | Train Acc: 0.2518
 Site-Black                    | Train Loss: 1.7854 | Train Acc: 0.3094
 Site-East_Asian               | Train Loss: 1.6095 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.6217 | Train Acc: 0.4388
 Site-Indian                   | Train Loss: 1.7658 | Train Acc: 0.3381
 Site-Indian                   | Train Loss: 1.7909 | Train Acc: 0.3070
 Site-Southeast_Asian          | Train Loss: 1.7934 | Train Acc: 0.3885
 Site-Southeast_Asian          | Train Loss: 1.7355 | Train Acc: 0.3933
 Site-Middle_Eastern           | Train Loss: 1.7426 | Train Acc: 0.3381
 Site-Middle_Eastern           | Train Loss: 1.7063 | Train Acc: 0.3693
 Site-White                     (5) | Val  Loss: 1.7533 | Val  Acc: 0.3478
 Site-White                     (5) | Val  Loss: 1.6954 | Val  Acc: 0.3921
 Site-Latino_Hispanic           (4) | Val  Loss: 1.8257 | Val  Acc: 0.3261
 Site-Latino_Hispanic           (0) | Val  Loss: 1.7339 | Val  Acc: 0.3345
 Site-Black                     (1) | Val  Loss: 1.6868 | Val  Acc: 0.4457
 Site-Black                     (1) | Val  Loss: 1.7442 | Val  Acc: 0.3273
 Site-East_Asian                (2) | Val  Loss: 1.5809 | Val  Acc: 0.5109
 Site-East_Asian                (2) | Val  Loss: 1.6276 | Val  Acc: 0.4424
 Site-Indian                    (3) | Val  Loss: 1.7783 | Val  Acc: 0.3152
 Site-Indian                    (3) | Val  Loss: 1.7796 | Val  Acc: 0.3129
 Site-Southeast_Asian           (2) | Val  Loss: 1.6936 | Val  Acc: 0.3913
 Site-Southeast_Asian           (2) | Val  Loss: 1.7052 | Val  Acc: 0.3993
 Site-Middle_Eastern            (6) | Val  Loss: 1.6665 | Val  Acc: 0.3804
 Site-Middle_Eastern            (6) | Val  Loss: 1.7506 | Val  Acc: 0.3453
Average Valid Accuracy: 0.3765
Aggregated Acc | Val Acc: 0.3614
 Best site-White                    (5)  | Epoch:7 | Val Acc: 0.3478
 Best site-White                    (5)  | Epoch:7 | Val Acc: 0.3921
 Best site-Latino_Hispanic          (4)  | Epoch:7 | Val Acc: 0.3261
 Best site-Latino_Hispanic          (0)  | Epoch:7 | Val Acc: 0.3345
 Best site-Black                    (1)  | Epoch:7 | Val Acc: 0.4457
 Best site-Black                    (1)  | Epoch:7 | Val Acc: 0.3273
 Best site-East_Asian               (2)  | Epoch:7 | Val Acc: 0.5109
 Best site-East_Asian               (2)  | Epoch:7 | Val Acc: 0.4424
 Best site-Indian                   (3)  | Epoch:7 | Val Acc: 0.3152
 Best site-Indian                   (3)  | Epoch:7 | Val Acc: 0.3129
 Best site-Southeast_Asian          (2)  | Epoch:7 | Val Acc: 0.3913
 Best site-Southeast_Asian          (2)  | Epoch:7 | Val Acc: 0.3993
 Best site-Middle_Eastern           (6)  | Epoch:7 | Val Acc: 0.3804
 Best site-Middle_Eastern           (6)  | Epoch:7 | Val Acc: 0.3453
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 2, 2, 2, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
min_w=0.09600, quan_i=1.79, quan_c=1.79
minimize weight of clients:[0, 1, 3, 6, 7, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.7358 | Train Acc: 0.4173
 Site-White                    | Train Loss: 1.6457 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.7537 | Train Acc: 0.3165
 Site-Latino_Hispanic          | Train Loss: 1.7376 | Train Acc: 0.3429
 Site-Black                    | Train Loss: 1.7838 | Train Acc: 0.2734
 Site-Black                    | Train Loss: 1.7281 | Train Acc: 0.3717
 Site-East_Asian               | Train Loss: 1.6303 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.5943 | Train Acc: 0.4436
 Site-Indian                   | Train Loss: 1.6638 | Train Acc: 0.4173
 Site-Indian                   | Train Loss: 1.7240 | Train Acc: 0.3189
 Site-Southeast_Asian          | Train Loss: 1.7521 | Train Acc: 0.4101
 Site-Southeast_Asian          | Train Loss: 1.6994 | Train Acc: 0.4101
 Site-Middle_Eastern           | Train Loss: 1.7413 | Train Acc: 0.3741
 Site-Middle_Eastern           | Train Loss: 1.6427 | Train Acc: 0.4053
 Site-White                     (0) | Val  Loss: 1.7040 | Val  Acc: 0.3261
 Site-White                     (0) | Val  Loss: 1.6554 | Val  Acc: 0.4029
 Site-Latino_Hispanic           (6) | Val  Loss: 1.7672 | Val  Acc: 0.3261
 Site-Latino_Hispanic           (4) | Val  Loss: 1.6966 | Val  Acc: 0.3381
 Site-Black                     (2) | Val  Loss: 1.6596 | Val  Acc: 0.3804
 Site-Black                     (2) | Val  Loss: 1.7395 | Val  Acc: 0.3381
 Site-East_Asian                (5) | Val  Loss: 1.5342 | Val  Acc: 0.5109
 Site-East_Asian                (5) | Val  Loss: 1.5693 | Val  Acc: 0.4712
 Site-Indian                    (3) | Val  Loss: 1.7723 | Val  Acc: 0.2391
 Site-Indian                    (3) | Val  Loss: 1.7513 | Val  Acc: 0.3094
 Site-Southeast_Asian           (5) | Val  Loss: 1.6597 | Val  Acc: 0.3804
 Site-Southeast_Asian           (5) | Val  Loss: 1.6529 | Val  Acc: 0.3993
 Site-Middle_Eastern            (1) | Val  Loss: 1.6577 | Val  Acc: 0.3913
 Site-Middle_Eastern            (1) | Val  Loss: 1.7081 | Val  Acc: 0.3921
Average Valid Accuracy: 0.3718
Aggregated Acc | Val Acc: 0.3563
============ Train epoch 9 ============
cnt=[2, 3, 2, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
min_w=0.09522, quan_i=1.75, quan_c=1.74
minimize weight of clients:[1, 6, 7, 8, 11, 13, ]
 Site-White                    | Train Loss: 1.6965 | Train Acc: 0.3813
 Site-White                    | Train Loss: 1.6271 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.8669 | Train Acc: 0.3309
 Site-Latino_Hispanic          | Train Loss: 1.6697 | Train Acc: 0.3477
 Site-Black                    | Train Loss: 1.8050 | Train Acc: 0.3094
 Site-Black                    | Train Loss: 1.7199 | Train Acc: 0.3429
 Site-East_Asian               | Train Loss: 1.5098 | Train Acc: 0.4892
 Site-East_Asian               | Train Loss: 1.5473 | Train Acc: 0.4460
 Site-Indian                   | Train Loss: 1.5955 | Train Acc: 0.3669
 Site-Indian                   | Train Loss: 1.6921 | Train Acc: 0.3261
 Site-Southeast_Asian          | Train Loss: 1.6632 | Train Acc: 0.4173
 Site-Southeast_Asian          | Train Loss: 1.6755 | Train Acc: 0.4029
 Site-Middle_Eastern           | Train Loss: 1.4957 | Train Acc: 0.4101
 Site-Middle_Eastern           | Train Loss: 1.6237 | Train Acc: 0.4221
 Site-White                     (2) | Val  Loss: 1.6885 | Val  Acc: 0.3804
 Site-White                     (2) | Val  Loss: 1.6121 | Val  Acc: 0.4029
 Site-Latino_Hispanic           (5) | Val  Loss: 1.7170 | Val  Acc: 0.3478
 Site-Latino_Hispanic           (6) | Val  Loss: 1.6551 | Val  Acc: 0.3561
 Site-Black                     (3) | Val  Loss: 1.5634 | Val  Acc: 0.4565
 Site-Black                     (3) | Val  Loss: 1.6827 | Val  Acc: 0.3489
 Site-East_Asian                (0) | Val  Loss: 1.4374 | Val  Acc: 0.5435
 Site-East_Asian                (0) | Val  Loss: 1.5626 | Val  Acc: 0.4353
 Site-Indian                    (1) | Val  Loss: 1.7213 | Val  Acc: 0.2174
 Site-Indian                    (6) | Val  Loss: 1.6826 | Val  Acc: 0.3489
 Site-Southeast_Asian           (1) | Val  Loss: 1.5840 | Val  Acc: 0.3913
 Site-Southeast_Asian           (1) | Val  Loss: 1.6116 | Val  Acc: 0.4281
 Site-Middle_Eastern            (4) | Val  Loss: 1.5949 | Val  Acc: 0.4348
 Site-Middle_Eastern            (4) | Val  Loss: 1.6479 | Val  Acc: 0.3993
Average Valid Accuracy: 0.3922
Aggregated Acc | Val Acc: 0.3924
 Best site-White                    (2)  | Epoch:9 | Val Acc: 0.3804
 Best site-White                    (2)  | Epoch:9 | Val Acc: 0.4029
 Best site-Latino_Hispanic          (5)  | Epoch:9 | Val Acc: 0.3478
 Best site-Latino_Hispanic          (6)  | Epoch:9 | Val Acc: 0.3561
 Best site-Black                    (3)  | Epoch:9 | Val Acc: 0.4565
 Best site-Black                    (3)  | Epoch:9 | Val Acc: 0.3489
 Best site-East_Asian               (0)  | Epoch:9 | Val Acc: 0.5435
 Best site-East_Asian               (0)  | Epoch:9 | Val Acc: 0.4353
 Best site-Indian                   (1)  | Epoch:9 | Val Acc: 0.2174
 Best site-Indian                   (6)  | Epoch:9 | Val Acc: 0.3489
 Best site-Southeast_Asian          (1)  | Epoch:9 | Val Acc: 0.3913
 Best site-Southeast_Asian          (1)  | Epoch:9 | Val Acc: 0.4281
 Best site-Middle_Eastern           (4)  | Epoch:9 | Val Acc: 0.4348
 Best site-Middle_Eastern           (4)  | Epoch:9 | Val Acc: 0.3993
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
 Test site-White                    | Epoch:9 | Test Acc: 0.3529
 Test site-Latino_Hispanic          | Epoch:9 | Test Acc: 0.3259
 Test site-Black                    | Epoch:9 | Test Acc: 0.2656
 Test site-East_Asian               | Epoch:9 | Test Acc: 0.4221
 Test site-Indian                   | Epoch:9 | Test Acc: 0.3278
 Test site-Southeast_Asian          | Epoch:9 | Test Acc: 0.3704
 Test site-Middle_Eastern           | Epoch:9 | Test Acc: 0.3892
Average Test Accuracy: 0.3506, domain std=0.0468, individual std=0.0468
============ Train epoch 10 ============
cnt=[3, 2, 2, 3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
min_w=0.08330, quan_i=1.70, quan_c=1.72
minimize weight of clients:[1, 3, 6, 7, 10, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.7402 | Train Acc: 0.3741
 Site-White                    | Train Loss: 1.5999 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.7414 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.6510 | Train Acc: 0.3549
 Site-Black                    | Train Loss: 1.7174 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.6801 | Train Acc: 0.3717
 Site-East_Asian               | Train Loss: 1.4247 | Train Acc: 0.4892
 Site-East_Asian               | Train Loss: 1.5473 | Train Acc: 0.4365
 Site-Indian                   | Train Loss: 1.4933 | Train Acc: 0.3813
 Site-Indian                   | Train Loss: 1.6503 | Train Acc: 0.3429
 Site-Southeast_Asian          | Train Loss: 1.7194 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.6297 | Train Acc: 0.4293
 Site-Middle_Eastern           | Train Loss: 1.5237 | Train Acc: 0.3669
 Site-Middle_Eastern           | Train Loss: 1.5907 | Train Acc: 0.4125
 Site-White                     (4) | Val  Loss: 1.6504 | Val  Acc: 0.3696
 Site-White                     (4) | Val  Loss: 1.5786 | Val  Acc: 0.3885
 Site-Latino_Hispanic           (0) | Val  Loss: 1.6434 | Val  Acc: 0.3913
 Site-Latino_Hispanic           (3) | Val  Loss: 1.6202 | Val  Acc: 0.3849
 Site-Black                     (6) | Val  Loss: 1.5237 | Val  Acc: 0.5109
 Site-Black                     (5) | Val  Loss: 1.6497 | Val  Acc: 0.3633
 Site-East_Asian                (1) | Val  Loss: 1.4532 | Val  Acc: 0.5217
 Site-East_Asian                (1) | Val  Loss: 1.5315 | Val  Acc: 0.4712
 Site-Indian                    (0) | Val  Loss: 1.6677 | Val  Acc: 0.2826
 Site-Indian                    (0) | Val  Loss: 1.6604 | Val  Acc: 0.3345
 Site-Southeast_Asian           (3) | Val  Loss: 1.5884 | Val  Acc: 0.3913
 Site-Southeast_Asian           (3) | Val  Loss: 1.5803 | Val  Acc: 0.4353
 Site-Middle_Eastern            (2) | Val  Loss: 1.4964 | Val  Acc: 0.4239
 Site-Middle_Eastern            (2) | Val  Loss: 1.6252 | Val  Acc: 0.4281
Average Valid Accuracy: 0.4069
Aggregated Acc | Val Acc: 0.4165
 Best site-White                    (4)  | Epoch:10 | Val Acc: 0.3696
 Best site-White                    (4)  | Epoch:10 | Val Acc: 0.3885
 Best site-Latino_Hispanic          (0)  | Epoch:10 | Val Acc: 0.3913
 Best site-Latino_Hispanic          (3)  | Epoch:10 | Val Acc: 0.3849
 Best site-Black                    (6)  | Epoch:10 | Val Acc: 0.5109
 Best site-Black                    (5)  | Epoch:10 | Val Acc: 0.3633
 Best site-East_Asian               (1)  | Epoch:10 | Val Acc: 0.5217
 Best site-East_Asian               (1)  | Epoch:10 | Val Acc: 0.4712
 Best site-Indian                   (0)  | Epoch:10 | Val Acc: 0.2826
 Best site-Indian                   (0)  | Epoch:10 | Val Acc: 0.3345
 Best site-Southeast_Asian          (3)  | Epoch:10 | Val Acc: 0.3913
 Best site-Southeast_Asian          (3)  | Epoch:10 | Val Acc: 0.4353
 Best site-Middle_Eastern           (2)  | Epoch:10 | Val Acc: 0.4239
 Best site-Middle_Eastern           (2)  | Epoch:10 | Val Acc: 0.4281
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
min_w=0.07653, quan_i=1.70, quan_c=1.66
minimize weight of clients:[1, 6, 7, 8, 9, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.5790 | Train Acc: 0.3813
 Site-White                    | Train Loss: 1.5590 | Train Acc: 0.4053
 Site-Latino_Hispanic          | Train Loss: 1.6021 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.6117 | Train Acc: 0.3645
 Site-Black                    | Train Loss: 1.7405 | Train Acc: 0.3309
 Site-Black                    | Train Loss: 1.6468 | Train Acc: 0.3645
 Site-East_Asian               | Train Loss: 1.3818 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.5033 | Train Acc: 0.4436
 Site-Indian                   | Train Loss: 1.6028 | Train Acc: 0.3669
 Site-Indian                   | Train Loss: 1.6497 | Train Acc: 0.3405
 Site-Southeast_Asian          | Train Loss: 1.6491 | Train Acc: 0.4245
 Site-Southeast_Asian          | Train Loss: 1.6216 | Train Acc: 0.3909
 Site-Middle_Eastern           | Train Loss: 1.5202 | Train Acc: 0.3597
 Site-Middle_Eastern           | Train Loss: 1.5444 | Train Acc: 0.4125
 Site-White                     (3) | Val  Loss: 1.6698 | Val  Acc: 0.3696
 Site-White                     (3) | Val  Loss: 1.5908 | Val  Acc: 0.4137
 Site-Latino_Hispanic           (1) | Val  Loss: 1.6559 | Val  Acc: 0.3370
 Site-Latino_Hispanic           (1) | Val  Loss: 1.6173 | Val  Acc: 0.3525
 Site-Black                     (2) | Val  Loss: 1.5022 | Val  Acc: 0.4565
 Site-Black                     (2) | Val  Loss: 1.6246 | Val  Acc: 0.3525
 Site-East_Asian                (6) | Val  Loss: 1.3969 | Val  Acc: 0.5761
 Site-East_Asian                (6) | Val  Loss: 1.4978 | Val  Acc: 0.4424
 Site-Indian                    (4) | Val  Loss: 1.6899 | Val  Acc: 0.2826
 Site-Indian                    (4) | Val  Loss: 1.6113 | Val  Acc: 0.3129
 Site-Southeast_Asian           (0) | Val  Loss: 1.5513 | Val  Acc: 0.4239
 Site-Southeast_Asian           (0) | Val  Loss: 1.5971 | Val  Acc: 0.4245
 Site-Middle_Eastern            (5) | Val  Loss: 1.5003 | Val  Acc: 0.4457
 Site-Middle_Eastern            (5) | Val  Loss: 1.5828 | Val  Acc: 0.4029
Average Valid Accuracy: 0.3995
Aggregated Acc | Val Acc: 0.3995
============ Train epoch 12 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
min_w=0.07237, quan_i=1.64, quan_c=1.65
minimize weight of clients:[0, 1, 2, 3, 6, 7, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.5352 | Train Acc: 0.3885
 Site-White                    | Train Loss: 1.5381 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.7240 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.6151 | Train Acc: 0.3837
 Site-Black                    | Train Loss: 1.6646 | Train Acc: 0.3022
 Site-Black                    | Train Loss: 1.6249 | Train Acc: 0.3429
 Site-East_Asian               | Train Loss: 1.4388 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.5143 | Train Acc: 0.4484
 Site-Indian                   | Train Loss: 1.4514 | Train Acc: 0.4460
 Site-Indian                   | Train Loss: 1.6179 | Train Acc: 0.3549
 Site-Southeast_Asian          | Train Loss: 1.5515 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.6048 | Train Acc: 0.3885
 Site-Middle_Eastern           | Train Loss: 1.5787 | Train Acc: 0.4029
 Site-Middle_Eastern           | Train Loss: 1.5328 | Train Acc: 0.4388
 Site-White                     (5) | Val  Loss: 1.5879 | Val  Acc: 0.3804
 Site-White                     (5) | Val  Loss: 1.5551 | Val  Acc: 0.3993
 Site-Latino_Hispanic           (6) | Val  Loss: 1.6235 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (6) | Val  Loss: 1.5867 | Val  Acc: 0.3741
 Site-Black                     (1) | Val  Loss: 1.4831 | Val  Acc: 0.4674
 Site-Black                     (1) | Val  Loss: 1.5901 | Val  Acc: 0.3993
 Site-East_Asian                (3) | Val  Loss: 1.4026 | Val  Acc: 0.5435
 Site-East_Asian                (3) | Val  Loss: 1.4779 | Val  Acc: 0.4712
 Site-Indian                    (4) | Val  Loss: 1.6331 | Val  Acc: 0.2717
 Site-Indian                    (4) | Val  Loss: 1.6132 | Val  Acc: 0.3381
 Site-Southeast_Asian           (0) | Val  Loss: 1.5685 | Val  Acc: 0.4130
 Site-Southeast_Asian           (0) | Val  Loss: 1.5458 | Val  Acc: 0.4388
 Site-Middle_Eastern            (2) | Val  Loss: 1.4874 | Val  Acc: 0.4022
 Site-Middle_Eastern            (2) | Val  Loss: 1.5972 | Val  Acc: 0.4065
Average Valid Accuracy: 0.4077
Aggregated Acc | Val Acc: 0.4077
 Best site-White                    (5)  | Epoch:12 | Val Acc: 0.3804
 Best site-White                    (5)  | Epoch:12 | Val Acc: 0.3993
 Best site-Latino_Hispanic          (6)  | Epoch:12 | Val Acc: 0.4022
 Best site-Latino_Hispanic          (6)  | Epoch:12 | Val Acc: 0.3741
 Best site-Black                    (1)  | Epoch:12 | Val Acc: 0.4674
 Best site-Black                    (1)  | Epoch:12 | Val Acc: 0.3993
 Best site-East_Asian               (3)  | Epoch:12 | Val Acc: 0.5435
 Best site-East_Asian               (3)  | Epoch:12 | Val Acc: 0.4712
 Best site-Indian                   (4)  | Epoch:12 | Val Acc: 0.2717
 Best site-Indian                   (4)  | Epoch:12 | Val Acc: 0.3381
 Best site-Southeast_Asian          (0)  | Epoch:12 | Val Acc: 0.4130
 Best site-Southeast_Asian          (0)  | Epoch:12 | Val Acc: 0.4388
 Best site-Middle_Eastern           (2)  | Epoch:12 | Val Acc: 0.4022
 Best site-Middle_Eastern           (2)  | Epoch:12 | Val Acc: 0.4065
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 13 ============
cnt=[3, 1, 3, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
min_w=0.07876, quan_i=1.64, quan_c=1.62
minimize weight of clients:[0, 1, 6, 7, 10, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.5810 | Train Acc: 0.4029
 Site-White                    | Train Loss: 1.5232 | Train Acc: 0.4149
 Site-Latino_Hispanic          | Train Loss: 1.6055 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.5755 | Train Acc: 0.3693
 Site-Black                    | Train Loss: 1.6521 | Train Acc: 0.3022
 Site-Black                    | Train Loss: 1.6070 | Train Acc: 0.3669
 Site-East_Asian               | Train Loss: 1.5295 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.5054 | Train Acc: 0.4412
 Site-Indian                   | Train Loss: 1.4270 | Train Acc: 0.4029
 Site-Indian                   | Train Loss: 1.6066 | Train Acc: 0.3549
 Site-Southeast_Asian          | Train Loss: 1.4889 | Train Acc: 0.4317
 Site-Southeast_Asian          | Train Loss: 1.5973 | Train Acc: 0.4005
 Site-Middle_Eastern           | Train Loss: 1.5574 | Train Acc: 0.4101
 Site-Middle_Eastern           | Train Loss: 1.5277 | Train Acc: 0.4269
 Site-White                     (5) | Val  Loss: 1.6137 | Val  Acc: 0.3804
 Site-White                     (1) | Val  Loss: 1.5577 | Val  Acc: 0.4209
 Site-Latino_Hispanic           (2) | Val  Loss: 1.5931 | Val  Acc: 0.3804
 Site-Latino_Hispanic           (0) | Val  Loss: 1.5379 | Val  Acc: 0.3813
 Site-Black                     (3) | Val  Loss: 1.4625 | Val  Acc: 0.4674
 Site-Black                     (3) | Val  Loss: 1.5859 | Val  Acc: 0.4245
 Site-East_Asian                (2) | Val  Loss: 1.3458 | Val  Acc: 0.5761
 Site-East_Asian                (2) | Val  Loss: 1.4844 | Val  Acc: 0.4712
 Site-Indian                    (0) | Val  Loss: 1.6536 | Val  Acc: 0.3478
 Site-Indian                    (0) | Val  Loss: 1.5698 | Val  Acc: 0.3705
 Site-Southeast_Asian           (6) | Val  Loss: 1.5313 | Val  Acc: 0.4239
 Site-Southeast_Asian           (6) | Val  Loss: 1.5485 | Val  Acc: 0.4209
 Site-Middle_Eastern            (4) | Val  Loss: 1.4859 | Val  Acc: 0.4457
 Site-Middle_Eastern            (4) | Val  Loss: 1.5972 | Val  Acc: 0.4137
Average Valid Accuracy: 0.4232
Aggregated Acc | Val Acc: 0.4202
 Best site-White                    (5)  | Epoch:13 | Val Acc: 0.3804
 Best site-White                    (1)  | Epoch:13 | Val Acc: 0.4209
 Best site-Latino_Hispanic          (2)  | Epoch:13 | Val Acc: 0.3804
 Best site-Latino_Hispanic          (0)  | Epoch:13 | Val Acc: 0.3813
 Best site-Black                    (3)  | Epoch:13 | Val Acc: 0.4674
 Best site-Black                    (3)  | Epoch:13 | Val Acc: 0.4245
 Best site-East_Asian               (2)  | Epoch:13 | Val Acc: 0.5761
 Best site-East_Asian               (2)  | Epoch:13 | Val Acc: 0.4712
 Best site-Indian                   (0)  | Epoch:13 | Val Acc: 0.3478
 Best site-Indian                   (0)  | Epoch:13 | Val Acc: 0.3705
 Best site-Southeast_Asian          (6)  | Epoch:13 | Val Acc: 0.4239
 Best site-Southeast_Asian          (6)  | Epoch:13 | Val Acc: 0.4209
 Best site-Middle_Eastern           (4)  | Epoch:13 | Val Acc: 0.4457
 Best site-Middle_Eastern           (4)  | Epoch:13 | Val Acc: 0.4137
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 3, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
min_w=0.07843, quan_i=1.61, quan_c=1.59
minimize weight of clients:[1, 3, 6, 7, 8, 10, 12, 13, ]
 Site-White                    | Train Loss: 1.5385 | Train Acc: 0.4029
 Site-White                    | Train Loss: 1.5044 | Train Acc: 0.4221
 Site-Latino_Hispanic          | Train Loss: 1.6361 | Train Acc: 0.3741
 Site-Latino_Hispanic          | Train Loss: 1.5793 | Train Acc: 0.3501
 Site-Black                    | Train Loss: 1.7355 | Train Acc: 0.3525
 Site-Black                    | Train Loss: 1.6185 | Train Acc: 0.3789
 Site-East_Asian               | Train Loss: 1.4104 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.4814 | Train Acc: 0.4652
 Site-Indian                   | Train Loss: 1.5009 | Train Acc: 0.4604
 Site-Indian                   | Train Loss: 1.5577 | Train Acc: 0.3765
 Site-Southeast_Asian          | Train Loss: 1.5986 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.5591 | Train Acc: 0.4077
 Site-Middle_Eastern           | Train Loss: 1.5317 | Train Acc: 0.4029
 Site-Middle_Eastern           | Train Loss: 1.5199 | Train Acc: 0.4173
 Site-White                     (4) | Val  Loss: 1.5947 | Val  Acc: 0.3804
 Site-White                     (6) | Val  Loss: 1.5112 | Val  Acc: 0.4137
 Site-Latino_Hispanic           (4) | Val  Loss: 1.6206 | Val  Acc: 0.3913
 Site-Latino_Hispanic           (1) | Val  Loss: 1.5685 | Val  Acc: 0.3741
 Site-Black                     (3) | Val  Loss: 1.4287 | Val  Acc: 0.5435
 Site-Black                     (3) | Val  Loss: 1.6072 | Val  Acc: 0.3741
 Site-East_Asian                (5) | Val  Loss: 1.3169 | Val  Acc: 0.5326
 Site-East_Asian                (5) | Val  Loss: 1.4789 | Val  Acc: 0.4424
 Site-Indian                    (0) | Val  Loss: 1.5933 | Val  Acc: 0.3152
 Site-Indian                    (0) | Val  Loss: 1.5667 | Val  Acc: 0.3561
 Site-Southeast_Asian           (1) | Val  Loss: 1.5215 | Val  Acc: 0.3913
 Site-Southeast_Asian           (1) | Val  Loss: 1.5205 | Val  Acc: 0.4173
 Site-Middle_Eastern            (2) | Val  Loss: 1.4824 | Val  Acc: 0.4565
 Site-Middle_Eastern            (2) | Val  Loss: 1.5594 | Val  Acc: 0.4245
Average Valid Accuracy: 0.4152
Aggregated Acc | Val Acc: 0.4166
============ Train epoch 15 ============
cnt=[2, 4, 2, 2, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
min_w=0.07487, quan_i=1.59, quan_c=1.58
minimize weight of clients:[1, 6, 7, 8, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.5520 | Train Acc: 0.4101
 Site-White                    | Train Loss: 1.5036 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.6018 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.5562 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.6641 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.6090 | Train Acc: 0.3957
 Site-East_Asian               | Train Loss: 1.4462 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.4619 | Train Acc: 0.4652
 Site-Indian                   | Train Loss: 1.4761 | Train Acc: 0.4604
 Site-Indian                   | Train Loss: 1.5835 | Train Acc: 0.3837
 Site-Southeast_Asian          | Train Loss: 1.5660 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.5789 | Train Acc: 0.4029
 Site-Middle_Eastern           | Train Loss: 1.4818 | Train Acc: 0.3525
 Site-Middle_Eastern           | Train Loss: 1.4729 | Train Acc: 0.4269
 Site-White                     (1) | Val  Loss: 1.5841 | Val  Acc: 0.3696
 Site-White                     (4) | Val  Loss: 1.4858 | Val  Acc: 0.4317
 Site-Latino_Hispanic           (1) | Val  Loss: 1.5620 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (1) | Val  Loss: 1.5261 | Val  Acc: 0.3921
 Site-Black                     (2) | Val  Loss: 1.4282 | Val  Acc: 0.5217
 Site-Black                     (2) | Val  Loss: 1.5690 | Val  Acc: 0.3957
 Site-East_Asian                (0) | Val  Loss: 1.4090 | Val  Acc: 0.5109
 Site-East_Asian                (0) | Val  Loss: 1.4672 | Val  Acc: 0.4676
 Site-Indian                    (5) | Val  Loss: 1.5579 | Val  Acc: 0.3478
 Site-Indian                    (1) | Val  Loss: 1.5548 | Val  Acc: 0.3597
 Site-Southeast_Asian           (6) | Val  Loss: 1.4978 | Val  Acc: 0.4130
 Site-Southeast_Asian           (6) | Val  Loss: 1.5177 | Val  Acc: 0.4137
 Site-Middle_Eastern            (3) | Val  Loss: 1.4339 | Val  Acc: 0.4891
 Site-Middle_Eastern            (3) | Val  Loss: 1.5614 | Val  Acc: 0.4065
Average Valid Accuracy: 0.4237
Aggregated Acc | Val Acc: 0.4246
 Best site-White                    (1)  | Epoch:15 | Val Acc: 0.3696
 Best site-White                    (4)  | Epoch:15 | Val Acc: 0.4317
 Best site-Latino_Hispanic          (1)  | Epoch:15 | Val Acc: 0.4130
 Best site-Latino_Hispanic          (1)  | Epoch:15 | Val Acc: 0.3921
 Best site-Black                    (2)  | Epoch:15 | Val Acc: 0.5217
 Best site-Black                    (2)  | Epoch:15 | Val Acc: 0.3957
 Best site-East_Asian               (0)  | Epoch:15 | Val Acc: 0.5109
 Best site-East_Asian               (0)  | Epoch:15 | Val Acc: 0.4676
 Best site-Indian                   (5)  | Epoch:15 | Val Acc: 0.3478
 Best site-Indian                   (1)  | Epoch:15 | Val Acc: 0.3597
 Best site-Southeast_Asian          (6)  | Epoch:15 | Val Acc: 0.4130
 Best site-Southeast_Asian          (6)  | Epoch:15 | Val Acc: 0.4137
 Best site-Middle_Eastern           (3)  | Epoch:15 | Val Acc: 0.4891
 Best site-Middle_Eastern           (3)  | Epoch:15 | Val Acc: 0.4065
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 16 ============
cnt=[2, 2, 2, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
min_w=0.07832, quan_i=1.59, quan_c=1.56
minimize weight of clients:[0, 1, 6, 7, 8, 12, 13, ]
 Site-White                    | Train Loss: 1.4699 | Train Acc: 0.4029
 Site-White                    | Train Loss: 1.4897 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.7150 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.5516 | Train Acc: 0.3909
 Site-Black                    | Train Loss: 1.8012 | Train Acc: 0.3525
 Site-Black                    | Train Loss: 1.5893 | Train Acc: 0.3933
 Site-East_Asian               | Train Loss: 1.5226 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.4683 | Train Acc: 0.4508
 Site-Indian                   | Train Loss: 1.4222 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.5232 | Train Acc: 0.3813
 Site-Southeast_Asian          | Train Loss: 1.4643 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.5177 | Train Acc: 0.4293
 Site-Middle_Eastern           | Train Loss: 1.5222 | Train Acc: 0.3885
 Site-Middle_Eastern           | Train Loss: 1.4816 | Train Acc: 0.4293
 Site-White                     (6) | Val  Loss: 1.5812 | Val  Acc: 0.3696
 Site-White                     (5) | Val  Loss: 1.5222 | Val  Acc: 0.4137
 Site-Latino_Hispanic           (1) | Val  Loss: 1.5387 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (1) | Val  Loss: 1.5288 | Val  Acc: 0.3921
 Site-Black                     (4) | Val  Loss: 1.4356 | Val  Acc: 0.5000
 Site-Black                     (4) | Val  Loss: 1.5882 | Val  Acc: 0.4029
 Site-East_Asian                (3) | Val  Loss: 1.3732 | Val  Acc: 0.5435
 Site-East_Asian                (3) | Val  Loss: 1.4350 | Val  Acc: 0.4640
 Site-Indian                    (2) | Val  Loss: 1.5965 | Val  Acc: 0.3043
 Site-Indian                    (2) | Val  Loss: 1.5511 | Val  Acc: 0.3849
 Site-Southeast_Asian           (3) | Val  Loss: 1.5371 | Val  Acc: 0.4130
 Site-Southeast_Asian           (3) | Val  Loss: 1.5239 | Val  Acc: 0.4317
 Site-Middle_Eastern            (0) | Val  Loss: 1.4592 | Val  Acc: 0.4239
 Site-Middle_Eastern            (0) | Val  Loss: 1.5483 | Val  Acc: 0.4173
Average Valid Accuracy: 0.4196
Aggregated Acc | Val Acc: 0.4094
============ Train epoch 17 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
min_w=0.07644, quan_i=1.54, quan_c=1.53
minimize weight of clients:[0, 1, 6, 7, 8, 9, 10, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.5707 | Train Acc: 0.4245
 Site-White                    | Train Loss: 1.4954 | Train Acc: 0.4412
 Site-Latino_Hispanic          | Train Loss: 1.6601 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.5063 | Train Acc: 0.3933
 Site-Black                    | Train Loss: 1.6767 | Train Acc: 0.3309
 Site-Black                    | Train Loss: 1.5475 | Train Acc: 0.4101
 Site-East_Asian               | Train Loss: 1.3933 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.4652 | Train Acc: 0.4341
 Site-Indian                   | Train Loss: 1.4826 | Train Acc: 0.4460
 Site-Indian                   | Train Loss: 1.5497 | Train Acc: 0.3765
 Site-Southeast_Asian          | Train Loss: 1.5179 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.5583 | Train Acc: 0.4173
 Site-Middle_Eastern           | Train Loss: 1.4131 | Train Acc: 0.4173
 Site-Middle_Eastern           | Train Loss: 1.4792 | Train Acc: 0.4269
 Site-White                     (2) | Val  Loss: 1.5468 | Val  Acc: 0.3913
 Site-White                     (2) | Val  Loss: 1.5090 | Val  Acc: 0.4101
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5277 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5060 | Val  Acc: 0.3849
 Site-Black                     (1) | Val  Loss: 1.3993 | Val  Acc: 0.4565
 Site-Black                     (1) | Val  Loss: 1.5418 | Val  Acc: 0.4209
 Site-East_Asian                (5) | Val  Loss: 1.3035 | Val  Acc: 0.5870
 Site-East_Asian                (5) | Val  Loss: 1.4399 | Val  Acc: 0.4604
 Site-Indian                    (3) | Val  Loss: 1.6452 | Val  Acc: 0.3696
 Site-Indian                    (3) | Val  Loss: 1.5215 | Val  Acc: 0.3633
 Site-Southeast_Asian           (0) | Val  Loss: 1.5214 | Val  Acc: 0.4022
 Site-Southeast_Asian           (0) | Val  Loss: 1.5077 | Val  Acc: 0.4460
 Site-Middle_Eastern            (6) | Val  Loss: 1.3994 | Val  Acc: 0.4565
 Site-Middle_Eastern            (6) | Val  Loss: 1.5469 | Val  Acc: 0.4209
Average Valid Accuracy: 0.4265
Aggregated Acc | Val Acc: 0.4265
 Best site-White                    (2)  | Epoch:17 | Val Acc: 0.3913
 Best site-White                    (2)  | Epoch:17 | Val Acc: 0.4101
 Best site-Latino_Hispanic          (4)  | Epoch:17 | Val Acc: 0.4022
 Best site-Latino_Hispanic          (4)  | Epoch:17 | Val Acc: 0.3849
 Best site-Black                    (1)  | Epoch:17 | Val Acc: 0.4565
 Best site-Black                    (1)  | Epoch:17 | Val Acc: 0.4209
 Best site-East_Asian               (5)  | Epoch:17 | Val Acc: 0.5870
 Best site-East_Asian               (5)  | Epoch:17 | Val Acc: 0.4604
 Best site-Indian                   (3)  | Epoch:17 | Val Acc: 0.3696
 Best site-Indian                   (3)  | Epoch:17 | Val Acc: 0.3633
 Best site-Southeast_Asian          (0)  | Epoch:17 | Val Acc: 0.4022
 Best site-Southeast_Asian          (0)  | Epoch:17 | Val Acc: 0.4460
 Best site-Middle_Eastern           (6)  | Epoch:17 | Val Acc: 0.4565
 Best site-Middle_Eastern           (6)  | Epoch:17 | Val Acc: 0.4209
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 18 ============
cnt=[1, 2, 3, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
min_w=0.07287, quan_i=1.56, quan_c=1.56
minimize weight of clients:[1, 3, 6, 7, 8, 10, 12, 13, ]
 Site-White                    | Train Loss: 1.4663 | Train Acc: 0.4029
 Site-White                    | Train Loss: 1.4707 | Train Acc: 0.4173
 Site-Latino_Hispanic          | Train Loss: 1.6090 | Train Acc: 0.3885
 Site-Latino_Hispanic          | Train Loss: 1.5018 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.7361 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.5412 | Train Acc: 0.4149
 Site-East_Asian               | Train Loss: 1.4593 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.4500 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.5055 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.5457 | Train Acc: 0.4077
 Site-Southeast_Asian          | Train Loss: 1.5278 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.5121 | Train Acc: 0.4365
 Site-Middle_Eastern           | Train Loss: 1.4195 | Train Acc: 0.4245
 Site-Middle_Eastern           | Train Loss: 1.4635 | Train Acc: 0.4365
 Site-White                     (6) | Val  Loss: 1.5986 | Val  Acc: 0.3587
 Site-White                     (3) | Val  Loss: 1.5090 | Val  Acc: 0.4317
 Site-Latino_Hispanic           (6) | Val  Loss: 1.5230 | Val  Acc: 0.3913
 Site-Latino_Hispanic           (2) | Val  Loss: 1.5048 | Val  Acc: 0.3741
 Site-Black                     (4) | Val  Loss: 1.4038 | Val  Acc: 0.4783
 Site-Black                     (4) | Val  Loss: 1.5392 | Val  Acc: 0.4101
 Site-East_Asian                (5) | Val  Loss: 1.3501 | Val  Acc: 0.5326
 Site-East_Asian                (5) | Val  Loss: 1.4245 | Val  Acc: 0.4928
 Site-Indian                    (2) | Val  Loss: 1.5944 | Val  Acc: 0.2826
 Site-Indian                    (2) | Val  Loss: 1.5270 | Val  Acc: 0.4137
 Site-Southeast_Asian           (1) | Val  Loss: 1.5163 | Val  Acc: 0.4239
 Site-Southeast_Asian           (1) | Val  Loss: 1.4592 | Val  Acc: 0.4532
 Site-Middle_Eastern            (0) | Val  Loss: 1.4379 | Val  Acc: 0.5000
 Site-Middle_Eastern            (3) | Val  Loss: 1.5190 | Val  Acc: 0.4209
Average Valid Accuracy: 0.4260
Aggregated Acc | Val Acc: 0.4362
============ Train epoch 19 ============
cnt=[2, 3, 2, 2, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
min_w=0.07430, quan_i=1.54, quan_c=1.55
minimize weight of clients:[0, 1, 6, 7, 8, 10, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.3975 | Train Acc: 0.3669
 Site-White                    | Train Loss: 1.4716 | Train Acc: 0.4293
 Site-Latino_Hispanic          | Train Loss: 1.6495 | Train Acc: 0.4173
 Site-Latino_Hispanic          | Train Loss: 1.5115 | Train Acc: 0.4005
 Site-Black                    | Train Loss: 1.7806 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.5467 | Train Acc: 0.4125
 Site-East_Asian               | Train Loss: 1.4392 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.4562 | Train Acc: 0.4508
 Site-Indian                   | Train Loss: 1.4079 | Train Acc: 0.3813
 Site-Indian                   | Train Loss: 1.5173 | Train Acc: 0.4005
 Site-Southeast_Asian          | Train Loss: 1.4634 | Train Acc: 0.3741
 Site-Southeast_Asian          | Train Loss: 1.5301 | Train Acc: 0.4221
 Site-Middle_Eastern           | Train Loss: 1.4606 | Train Acc: 0.4317
 Site-Middle_Eastern           | Train Loss: 1.4286 | Train Acc: 0.4341
 Site-White                     (5) | Val  Loss: 1.5503 | Val  Acc: 0.3913
 Site-White                     (5) | Val  Loss: 1.5142 | Val  Acc: 0.4173
 Site-Latino_Hispanic           (1) | Val  Loss: 1.5298 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4667 | Val  Acc: 0.4424
 Site-Black                     (2) | Val  Loss: 1.3978 | Val  Acc: 0.5109
 Site-Black                     (2) | Val  Loss: 1.5160 | Val  Acc: 0.4676
 Site-East_Asian                (0) | Val  Loss: 1.3561 | Val  Acc: 0.5435
 Site-East_Asian                (0) | Val  Loss: 1.4118 | Val  Acc: 0.4676
 Site-Indian                    (4) | Val  Loss: 1.5691 | Val  Acc: 0.3587
 Site-Indian                    (1) | Val  Loss: 1.5170 | Val  Acc: 0.3993
 Site-Southeast_Asian           (6) | Val  Loss: 1.5089 | Val  Acc: 0.4348
 Site-Southeast_Asian           (6) | Val  Loss: 1.4749 | Val  Acc: 0.4676
 Site-Middle_Eastern            (3) | Val  Loss: 1.4601 | Val  Acc: 0.4022
 Site-Middle_Eastern            (3) | Val  Loss: 1.5299 | Val  Acc: 0.4281
Average Valid Accuracy: 0.4389
Aggregated Acc | Val Acc: 0.4346
 Best site-White                    (5)  | Epoch:19 | Val Acc: 0.3913
 Best site-White                    (5)  | Epoch:19 | Val Acc: 0.4173
 Best site-Latino_Hispanic          (1)  | Epoch:19 | Val Acc: 0.4130
 Best site-Latino_Hispanic          (1)  | Epoch:19 | Val Acc: 0.4424
 Best site-Black                    (2)  | Epoch:19 | Val Acc: 0.5109
 Best site-Black                    (2)  | Epoch:19 | Val Acc: 0.4676
 Best site-East_Asian               (0)  | Epoch:19 | Val Acc: 0.5435
 Best site-East_Asian               (0)  | Epoch:19 | Val Acc: 0.4676
 Best site-Indian                   (4)  | Epoch:19 | Val Acc: 0.3587
 Best site-Indian                   (1)  | Epoch:19 | Val Acc: 0.3993
 Best site-Southeast_Asian          (6)  | Epoch:19 | Val Acc: 0.4348
 Best site-Southeast_Asian          (6)  | Epoch:19 | Val Acc: 0.4676
 Best site-Middle_Eastern           (3)  | Epoch:19 | Val Acc: 0.4022
 Best site-Middle_Eastern           (3)  | Epoch:19 | Val Acc: 0.4281
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
 Test site-White                    | Epoch:19 | Test Acc: 0.4064
 Test site-Latino_Hispanic          | Epoch:19 | Test Acc: 0.3513
 Test site-Black                    | Epoch:19 | Test Acc: 0.2969
 Test site-East_Asian               | Epoch:19 | Test Acc: 0.4188
 Test site-Indian                   | Epoch:19 | Test Acc: 0.3445
 Test site-Southeast_Asian          | Epoch:19 | Test Acc: 0.4037
 Test site-Middle_Eastern           | Epoch:19 | Test Acc: 0.4098
Average Test Accuracy: 0.3759, domain std=0.0423, individual std=0.0423
============ Train epoch 20 ============
cnt=[2, 2, 2, 2, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
min_w=0.07520, quan_i=1.54, quan_c=1.52
minimize weight of clients:[1, 6, 7, 8, 10, 12, 13, ]
 Site-White                    | Train Loss: 1.3731 | Train Acc: 0.4245
 Site-White                    | Train Loss: 1.4658 | Train Acc: 0.4676
 Site-Latino_Hispanic          | Train Loss: 1.6294 | Train Acc: 0.3597
 Site-Latino_Hispanic          | Train Loss: 1.4863 | Train Acc: 0.4053
 Site-Black                    | Train Loss: 1.6957 | Train Acc: 0.3525
 Site-Black                    | Train Loss: 1.5532 | Train Acc: 0.4125
 Site-East_Asian               | Train Loss: 1.3968 | Train Acc: 0.4820
 Site-East_Asian               | Train Loss: 1.4467 | Train Acc: 0.4604
 Site-Indian                   | Train Loss: 1.3621 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.5015 | Train Acc: 0.4005
 Site-Southeast_Asian          | Train Loss: 1.5032 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.4812 | Train Acc: 0.4556
 Site-Middle_Eastern           | Train Loss: 1.5853 | Train Acc: 0.4029
 Site-Middle_Eastern           | Train Loss: 1.4440 | Train Acc: 0.4317
 Site-White                     (6) | Val  Loss: 1.6221 | Val  Acc: 0.3696
 Site-White                     (5) | Val  Loss: 1.4780 | Val  Acc: 0.4388
 Site-Latino_Hispanic           (6) | Val  Loss: 1.5109 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4892 | Val  Acc: 0.3957
 Site-Black                     (4) | Val  Loss: 1.3214 | Val  Acc: 0.5000
 Site-Black                     (4) | Val  Loss: 1.5346 | Val  Acc: 0.4173
 Site-East_Asian                (3) | Val  Loss: 1.3660 | Val  Acc: 0.5652
 Site-East_Asian                (3) | Val  Loss: 1.4218 | Val  Acc: 0.4784
 Site-Indian                    (1) | Val  Loss: 1.5510 | Val  Acc: 0.3370
 Site-Indian                    (1) | Val  Loss: 1.5022 | Val  Acc: 0.3849
 Site-Southeast_Asian           (2) | Val  Loss: 1.5309 | Val  Acc: 0.4130
 Site-Southeast_Asian           (2) | Val  Loss: 1.4537 | Val  Acc: 0.4712
 Site-Middle_Eastern            (0) | Val  Loss: 1.4218 | Val  Acc: 0.4783
 Site-Middle_Eastern            (0) | Val  Loss: 1.5233 | Val  Acc: 0.3993
Average Valid Accuracy: 0.4330
Aggregated Acc | Val Acc: 0.4363
============ Train epoch 21 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
min_w=0.07163, quan_i=1.52, quan_c=1.50
minimize weight of clients:[0, 1, 6, 7, 8, 9, 10, 11, 13, ]
 Site-White                    | Train Loss: 1.5338 | Train Acc: 0.4173
 Site-White                    | Train Loss: 1.4378 | Train Acc: 0.4532
 Site-Latino_Hispanic          | Train Loss: 1.5457 | Train Acc: 0.3453
 Site-Latino_Hispanic          | Train Loss: 1.4902 | Train Acc: 0.3789
 Site-Black                    | Train Loss: 1.6864 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.5090 | Train Acc: 0.4269
 Site-East_Asian               | Train Loss: 1.3448 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.4301 | Train Acc: 0.4700
 Site-Indian                   | Train Loss: 1.3386 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.5270 | Train Acc: 0.3885
 Site-Southeast_Asian          | Train Loss: 1.5528 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.5263 | Train Acc: 0.4053
 Site-Middle_Eastern           | Train Loss: 1.5055 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.4432 | Train Acc: 0.4388
 Site-White                     (6) | Val  Loss: 1.4886 | Val  Acc: 0.4348
 Site-White                     (6) | Val  Loss: 1.4536 | Val  Acc: 0.4604
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4695 | Val  Acc: 0.3913
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4656 | Val  Acc: 0.4245
 Site-Black                     (5) | Val  Loss: 1.3672 | Val  Acc: 0.5435
 Site-Black                     (5) | Val  Loss: 1.4991 | Val  Acc: 0.4568
 Site-East_Asian                (4) | Val  Loss: 1.3330 | Val  Acc: 0.5326
 Site-East_Asian                (4) | Val  Loss: 1.4149 | Val  Acc: 0.4568
 Site-Indian                    (1) | Val  Loss: 1.6177 | Val  Acc: 0.3696
 Site-Indian                    (1) | Val  Loss: 1.5146 | Val  Acc: 0.3849
 Site-Southeast_Asian           (3) | Val  Loss: 1.4511 | Val  Acc: 0.4022
 Site-Southeast_Asian           (3) | Val  Loss: 1.4707 | Val  Acc: 0.4388
 Site-Middle_Eastern            (0) | Val  Loss: 1.4343 | Val  Acc: 0.4457
 Site-Middle_Eastern            (0) | Val  Loss: 1.5265 | Val  Acc: 0.4281
Average Valid Accuracy: 0.4407
Aggregated Acc | Val Acc: 0.4407
 Best site-White                    (6)  | Epoch:21 | Val Acc: 0.4348
 Best site-White                    (6)  | Epoch:21 | Val Acc: 0.4604
 Best site-Latino_Hispanic          (2)  | Epoch:21 | Val Acc: 0.3913
 Best site-Latino_Hispanic          (2)  | Epoch:21 | Val Acc: 0.4245
 Best site-Black                    (5)  | Epoch:21 | Val Acc: 0.5435
 Best site-Black                    (5)  | Epoch:21 | Val Acc: 0.4568
 Best site-East_Asian               (4)  | Epoch:21 | Val Acc: 0.5326
 Best site-East_Asian               (4)  | Epoch:21 | Val Acc: 0.4568
 Best site-Indian                   (1)  | Epoch:21 | Val Acc: 0.3696
 Best site-Indian                   (1)  | Epoch:21 | Val Acc: 0.3849
 Best site-Southeast_Asian          (3)  | Epoch:21 | Val Acc: 0.4022
 Best site-Southeast_Asian          (3)  | Epoch:21 | Val Acc: 0.4388
 Best site-Middle_Eastern           (0)  | Epoch:21 | Val Acc: 0.4457
 Best site-Middle_Eastern           (0)  | Epoch:21 | Val Acc: 0.4281
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 3, 2, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
min_w=0.06844, quan_i=1.54, quan_c=1.52
minimize weight of clients:[1, 6, 7, 8, 12, 13, ]
 Site-White                    | Train Loss: 1.5296 | Train Acc: 0.4101
 Site-White                    | Train Loss: 1.4373 | Train Acc: 0.4436
 Site-Latino_Hispanic          | Train Loss: 1.6345 | Train Acc: 0.3597
 Site-Latino_Hispanic          | Train Loss: 1.4756 | Train Acc: 0.3837
 Site-Black                    | Train Loss: 1.7526 | Train Acc: 0.3597
 Site-Black                    | Train Loss: 1.5636 | Train Acc: 0.4365
 Site-East_Asian               | Train Loss: 1.5193 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.4290 | Train Acc: 0.4604
 Site-Indian                   | Train Loss: 1.4619 | Train Acc: 0.4604
 Site-Indian                   | Train Loss: 1.4868 | Train Acc: 0.3957
 Site-Southeast_Asian          | Train Loss: 1.4658 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.4782 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.5614 | Train Acc: 0.4245
 Site-Middle_Eastern           | Train Loss: 1.4458 | Train Acc: 0.4341
 Site-White                     (0) | Val  Loss: 1.5201 | Val  Acc: 0.4565
 Site-White                     (0) | Val  Loss: 1.4858 | Val  Acc: 0.3993
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4836 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4572 | Val  Acc: 0.4245
 Site-Black                     (3) | Val  Loss: 1.3702 | Val  Acc: 0.4891
 Site-Black                     (3) | Val  Loss: 1.5069 | Val  Acc: 0.4388
 Site-East_Asian                (6) | Val  Loss: 1.3555 | Val  Acc: 0.5326
 Site-East_Asian                (6) | Val  Loss: 1.4025 | Val  Acc: 0.4856
 Site-Indian                    (2) | Val  Loss: 1.5541 | Val  Acc: 0.3587
 Site-Indian                    (2) | Val  Loss: 1.4762 | Val  Acc: 0.4029
 Site-Southeast_Asian           (1) | Val  Loss: 1.4258 | Val  Acc: 0.4674
 Site-Southeast_Asian           (1) | Val  Loss: 1.4531 | Val  Acc: 0.4460
 Site-Middle_Eastern            (4) | Val  Loss: 1.4093 | Val  Acc: 0.4674
 Site-Middle_Eastern            (4) | Val  Loss: 1.4954 | Val  Acc: 0.4388
Average Valid Accuracy: 0.4443
Aggregated Acc | Val Acc: 0.4420
 Best site-White                    (0)  | Epoch:22 | Val Acc: 0.4565
 Best site-White                    (0)  | Epoch:22 | Val Acc: 0.3993
 Best site-Latino_Hispanic          (5)  | Epoch:22 | Val Acc: 0.4130
 Best site-Latino_Hispanic          (1)  | Epoch:22 | Val Acc: 0.4245
 Best site-Black                    (3)  | Epoch:22 | Val Acc: 0.4891
 Best site-Black                    (3)  | Epoch:22 | Val Acc: 0.4388
 Best site-East_Asian               (6)  | Epoch:22 | Val Acc: 0.5326
 Best site-East_Asian               (6)  | Epoch:22 | Val Acc: 0.4856
 Best site-Indian                   (2)  | Epoch:22 | Val Acc: 0.3587
 Best site-Indian                   (2)  | Epoch:22 | Val Acc: 0.4029
 Best site-Southeast_Asian          (1)  | Epoch:22 | Val Acc: 0.4674
 Best site-Southeast_Asian          (1)  | Epoch:22 | Val Acc: 0.4460
 Best site-Middle_Eastern           (4)  | Epoch:22 | Val Acc: 0.4674
 Best site-Middle_Eastern           (4)  | Epoch:22 | Val Acc: 0.4388
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 23 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
min_w=0.07803, quan_i=1.54, quan_c=1.49
minimize weight of clients:[0, 1, 6, 7, 8, 9, 10, 11, 13, ]
 Site-White                    | Train Loss: 1.5477 | Train Acc: 0.4317
 Site-White                    | Train Loss: 1.4385 | Train Acc: 0.4365
 Site-Latino_Hispanic          | Train Loss: 1.7133 | Train Acc: 0.3885
 Site-Latino_Hispanic          | Train Loss: 1.4270 | Train Acc: 0.4053
 Site-Black                    | Train Loss: 1.6037 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.5142 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.4364 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.4376 | Train Acc: 0.4556
 Site-Indian                   | Train Loss: 1.3684 | Train Acc: 0.4964
 Site-Indian                   | Train Loss: 1.4872 | Train Acc: 0.3909
 Site-Southeast_Asian          | Train Loss: 1.5473 | Train Acc: 0.4317
 Site-Southeast_Asian          | Train Loss: 1.5441 | Train Acc: 0.4293
 Site-Middle_Eastern           | Train Loss: 1.2988 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.4516 | Train Acc: 0.4412
 Site-White                     (5) | Val  Loss: 1.5239 | Val  Acc: 0.4565
 Site-White                     (5) | Val  Loss: 1.4311 | Val  Acc: 0.4496
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4691 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4574 | Val  Acc: 0.3957
 Site-Black                     (1) | Val  Loss: 1.3442 | Val  Acc: 0.4783
 Site-Black                     (1) | Val  Loss: 1.5023 | Val  Acc: 0.4604
 Site-East_Asian                (6) | Val  Loss: 1.3023 | Val  Acc: 0.5326
 Site-East_Asian                (6) | Val  Loss: 1.3894 | Val  Acc: 0.4856
 Site-Indian                    (2) | Val  Loss: 1.5700 | Val  Acc: 0.3152
 Site-Indian                    (2) | Val  Loss: 1.5093 | Val  Acc: 0.4065
 Site-Southeast_Asian           (3) | Val  Loss: 1.5100 | Val  Acc: 0.4022
 Site-Southeast_Asian           (3) | Val  Loss: 1.4519 | Val  Acc: 0.4496
 Site-Middle_Eastern            (4) | Val  Loss: 1.4107 | Val  Acc: 0.4022
 Site-Middle_Eastern            (4) | Val  Loss: 1.5076 | Val  Acc: 0.4245
Average Valid Accuracy: 0.4345
Aggregated Acc | Val Acc: 0.4345
============ Train epoch 24 ============
cnt=[2, 4, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
min_w=0.06688, quan_i=1.56, quan_c=1.51
minimize weight of clients:[1, 3, 8, 9, 12, 13, ]
 Site-White                    | Train Loss: 1.4008 | Train Acc: 0.4245
 Site-White                    | Train Loss: 1.4346 | Train Acc: 0.4532
 Site-Latino_Hispanic          | Train Loss: 1.6811 | Train Acc: 0.3741
 Site-Latino_Hispanic          | Train Loss: 1.5001 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.6297 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.5101 | Train Acc: 0.4365
 Site-East_Asian               | Train Loss: 1.4079 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.3778 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.4524 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.4937 | Train Acc: 0.4029
 Site-Southeast_Asian          | Train Loss: 1.4211 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.4466 | Train Acc: 0.4652
 Site-Middle_Eastern           | Train Loss: 1.3623 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.4355 | Train Acc: 0.4221
 Site-White                     (6) | Val  Loss: 1.5338 | Val  Acc: 0.4348
 Site-White                     (2) | Val  Loss: 1.4737 | Val  Acc: 0.4281
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4846 | Val  Acc: 0.3804
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4547 | Val  Acc: 0.4173
 Site-Black                     (5) | Val  Loss: 1.4004 | Val  Acc: 0.4783
 Site-Black                     (5) | Val  Loss: 1.5295 | Val  Acc: 0.4137
 Site-East_Asian                (1) | Val  Loss: 1.2955 | Val  Acc: 0.5326
 Site-East_Asian                (1) | Val  Loss: 1.3531 | Val  Acc: 0.4928
 Site-Indian                    (4) | Val  Loss: 1.5596 | Val  Acc: 0.3370
 Site-Indian                    (4) | Val  Loss: 1.4910 | Val  Acc: 0.3957
 Site-Southeast_Asian           (1) | Val  Loss: 1.4185 | Val  Acc: 0.4565
 Site-Southeast_Asian           (1) | Val  Loss: 1.4319 | Val  Acc: 0.4676
 Site-Middle_Eastern            (3) | Val  Loss: 1.3758 | Val  Acc: 0.4891
 Site-Middle_Eastern            (3) | Val  Loss: 1.4958 | Val  Acc: 0.4209
Average Valid Accuracy: 0.4389
Aggregated Acc | Val Acc: 0.4309
============ Train epoch 25 ============
cnt=[1, 2, 4, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
min_w=0.06974, quan_i=1.52, quan_c=1.51
minimize weight of clients:[0, 1, 6, 7, 8, 10, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.5236 | Train Acc: 0.4388
 Site-White                    | Train Loss: 1.4434 | Train Acc: 0.4293
 Site-Latino_Hispanic          | Train Loss: 1.7069 | Train Acc: 0.3669
 Site-Latino_Hispanic          | Train Loss: 1.4530 | Train Acc: 0.4077
 Site-Black                    | Train Loss: 1.5513 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.4928 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3225 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.4568 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.4536 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.5120 | Train Acc: 0.4053
 Site-Southeast_Asian          | Train Loss: 1.6151 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.5070 | Train Acc: 0.4245
 Site-Middle_Eastern           | Train Loss: 1.4093 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.4102 | Train Acc: 0.4484
 Site-White                     (6) | Val  Loss: 1.5562 | Val  Acc: 0.4130
 Site-White                     (0) | Val  Loss: 1.4929 | Val  Acc: 0.4245
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4461 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4564 | Val  Acc: 0.3957
 Site-Black                     (5) | Val  Loss: 1.3459 | Val  Acc: 0.5217
 Site-Black                     (5) | Val  Loss: 1.4643 | Val  Acc: 0.4460
 Site-East_Asian                (2) | Val  Loss: 1.3428 | Val  Acc: 0.5109
 Site-East_Asian                (2) | Val  Loss: 1.3825 | Val  Acc: 0.4820
 Site-Indian                    (1) | Val  Loss: 1.5818 | Val  Acc: 0.4239
 Site-Indian                    (1) | Val  Loss: 1.4896 | Val  Acc: 0.4209
 Site-Southeast_Asian           (2) | Val  Loss: 1.4589 | Val  Acc: 0.4565
 Site-Southeast_Asian           (2) | Val  Loss: 1.4402 | Val  Acc: 0.4460
 Site-Middle_Eastern            (3) | Val  Loss: 1.3836 | Val  Acc: 0.4565
 Site-Middle_Eastern            (3) | Val  Loss: 1.4852 | Val  Acc: 0.4317
Average Valid Accuracy: 0.4459
Aggregated Acc | Val Acc: 0.4380
 Best site-White                    (6)  | Epoch:25 | Val Acc: 0.4130
 Best site-White                    (0)  | Epoch:25 | Val Acc: 0.4245
 Best site-Latino_Hispanic          (4)  | Epoch:25 | Val Acc: 0.4130
 Best site-Latino_Hispanic          (4)  | Epoch:25 | Val Acc: 0.3957
 Best site-Black                    (5)  | Epoch:25 | Val Acc: 0.5217
 Best site-Black                    (5)  | Epoch:25 | Val Acc: 0.4460
 Best site-East_Asian               (2)  | Epoch:25 | Val Acc: 0.5109
 Best site-East_Asian               (2)  | Epoch:25 | Val Acc: 0.4820
 Best site-Indian                   (1)  | Epoch:25 | Val Acc: 0.4239
 Best site-Indian                   (1)  | Epoch:25 | Val Acc: 0.4209
 Best site-Southeast_Asian          (2)  | Epoch:25 | Val Acc: 0.4565
 Best site-Southeast_Asian          (2)  | Epoch:25 | Val Acc: 0.4460
 Best site-Middle_Eastern           (3)  | Epoch:25 | Val Acc: 0.4565
 Best site-Middle_Eastern           (3)  | Epoch:25 | Val Acc: 0.4317
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 26 ============
cnt=[2, 3, 2, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
min_w=0.06810, quan_i=1.52, quan_c=1.55
minimize weight of clients:[1, 3, 5, 6, 7, 8, 9, 12, 13, ]
 Site-White                    | Train Loss: 1.5921 | Train Acc: 0.3957
 Site-White                    | Train Loss: 1.4187 | Train Acc: 0.4628
 Site-Latino_Hispanic          | Train Loss: 1.5655 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.4692 | Train Acc: 0.3981
 Site-Black                    | Train Loss: 1.7456 | Train Acc: 0.3094
 Site-Black                    | Train Loss: 1.5272 | Train Acc: 0.4293
 Site-East_Asian               | Train Loss: 1.4374 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3968 | Train Acc: 0.4652
 Site-Indian                   | Train Loss: 1.4714 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.4799 | Train Acc: 0.4173
 Site-Southeast_Asian          | Train Loss: 1.4397 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.4544 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.3163 | Train Acc: 0.4245
 Site-Middle_Eastern           | Train Loss: 1.4327 | Train Acc: 0.4365
 Site-White                     (2) | Val  Loss: 1.4860 | Val  Acc: 0.4022
 Site-White                     (4) | Val  Loss: 1.4284 | Val  Acc: 0.4496
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4281 | Val  Acc: 0.3913
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4826 | Val  Acc: 0.3849
 Site-Black                     (3) | Val  Loss: 1.3288 | Val  Acc: 0.5870
 Site-Black                     (5) | Val  Loss: 1.5269 | Val  Acc: 0.4281
 Site-East_Asian                (0) | Val  Loss: 1.3041 | Val  Acc: 0.5652
 Site-East_Asian                (0) | Val  Loss: 1.3877 | Val  Acc: 0.4676
 Site-Indian                    (1) | Val  Loss: 1.4957 | Val  Acc: 0.3913
 Site-Indian                    (1) | Val  Loss: 1.4674 | Val  Acc: 0.4245
 Site-Southeast_Asian           (6) | Val  Loss: 1.4023 | Val  Acc: 0.4783
 Site-Southeast_Asian           (6) | Val  Loss: 1.3959 | Val  Acc: 0.5000
 Site-Middle_Eastern            (4) | Val  Loss: 1.4142 | Val  Acc: 0.4565
 Site-Middle_Eastern            (4) | Val  Loss: 1.4981 | Val  Acc: 0.4353
Average Valid Accuracy: 0.4544
Aggregated Acc | Val Acc: 0.4664
 Best site-White                    (2)  | Epoch:26 | Val Acc: 0.4022
 Best site-White                    (4)  | Epoch:26 | Val Acc: 0.4496
 Best site-Latino_Hispanic          (2)  | Epoch:26 | Val Acc: 0.3913
 Best site-Latino_Hispanic          (1)  | Epoch:26 | Val Acc: 0.3849
 Best site-Black                    (3)  | Epoch:26 | Val Acc: 0.5870
 Best site-Black                    (5)  | Epoch:26 | Val Acc: 0.4281
 Best site-East_Asian               (0)  | Epoch:26 | Val Acc: 0.5652
 Best site-East_Asian               (0)  | Epoch:26 | Val Acc: 0.4676
 Best site-Indian                   (1)  | Epoch:26 | Val Acc: 0.3913
 Best site-Indian                   (1)  | Epoch:26 | Val Acc: 0.4245
 Best site-Southeast_Asian          (6)  | Epoch:26 | Val Acc: 0.4783
 Best site-Southeast_Asian          (6)  | Epoch:26 | Val Acc: 0.5000
 Best site-Middle_Eastern           (4)  | Epoch:26 | Val Acc: 0.4565
 Best site-Middle_Eastern           (4)  | Epoch:26 | Val Acc: 0.4353
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 27 ============
cnt=[2, 2, 2, 4, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
min_w=0.06741, quan_i=1.50, quan_c=1.48
minimize weight of clients:[1, 3, 6, 7, 10, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.3525 | Train Acc: 0.4532
 Site-White                    | Train Loss: 1.4385 | Train Acc: 0.4556
 Site-Latino_Hispanic          | Train Loss: 1.5973 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.4512 | Train Acc: 0.3837
 Site-Black                    | Train Loss: 1.8077 | Train Acc: 0.3381
 Site-Black                    | Train Loss: 1.4951 | Train Acc: 0.4508
 Site-East_Asian               | Train Loss: 1.4185 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.3967 | Train Acc: 0.4724
 Site-Indian                   | Train Loss: 1.3440 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.4618 | Train Acc: 0.4221
 Site-Southeast_Asian          | Train Loss: 1.5640 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.4843 | Train Acc: 0.4772
 Site-Middle_Eastern           | Train Loss: 1.4331 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.4190 | Train Acc: 0.4508
 Site-White                     (1) | Val  Loss: 1.4718 | Val  Acc: 0.4239
 Site-White                     (1) | Val  Loss: 1.4646 | Val  Acc: 0.4460
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4291 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4651 | Val  Acc: 0.3993
 Site-Black                     (5) | Val  Loss: 1.3399 | Val  Acc: 0.5326
 Site-Black                     (4) | Val  Loss: 1.4877 | Val  Acc: 0.4424
 Site-East_Asian                (6) | Val  Loss: 1.3381 | Val  Acc: 0.5217
 Site-East_Asian                (6) | Val  Loss: 1.3934 | Val  Acc: 0.4676
 Site-Indian                    (0) | Val  Loss: 1.5281 | Val  Acc: 0.4130
 Site-Indian                    (0) | Val  Loss: 1.4506 | Val  Acc: 0.4317
 Site-Southeast_Asian           (3) | Val  Loss: 1.4445 | Val  Acc: 0.4457
 Site-Southeast_Asian           (3) | Val  Loss: 1.4265 | Val  Acc: 0.4748
 Site-Middle_Eastern            (2) | Val  Loss: 1.4324 | Val  Acc: 0.4674
 Site-Middle_Eastern            (2) | Val  Loss: 1.4641 | Val  Acc: 0.4353
Average Valid Accuracy: 0.4518
Aggregated Acc | Val Acc: 0.4592
============ Train epoch 28 ============
cnt=[2, 2, 2, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
min_w=0.06522, quan_i=1.49, quan_c=1.48
minimize weight of clients:[0, 1, 3, 6, 7, 8, 9, 12, 13, ]
 Site-White                    | Train Loss: 1.3458 | Train Acc: 0.4317
 Site-White                    | Train Loss: 1.4346 | Train Acc: 0.4460
 Site-Latino_Hispanic          | Train Loss: 1.6462 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.4397 | Train Acc: 0.4053
 Site-Black                    | Train Loss: 1.6275 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.4517 | Train Acc: 0.4820
 Site-East_Asian               | Train Loss: 1.3129 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.3953 | Train Acc: 0.4916
 Site-Indian                   | Train Loss: 1.4555 | Train Acc: 0.4388
 Site-Indian                   | Train Loss: 1.4771 | Train Acc: 0.3909
 Site-Southeast_Asian          | Train Loss: 1.4342 | Train Acc: 0.4892
 Site-Southeast_Asian          | Train Loss: 1.4442 | Train Acc: 0.4700
 Site-Middle_Eastern           | Train Loss: 1.3688 | Train Acc: 0.5036
 Site-Middle_Eastern           | Train Loss: 1.4160 | Train Acc: 0.4508
 Site-White                     (3) | Val  Loss: 1.4940 | Val  Acc: 0.4674
 Site-White                     (3) | Val  Loss: 1.4327 | Val  Acc: 0.4496
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4533 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4626 | Val  Acc: 0.4065
 Site-Black                     (0) | Val  Loss: 1.3042 | Val  Acc: 0.5870
 Site-Black                     (0) | Val  Loss: 1.4648 | Val  Acc: 0.4676
 Site-East_Asian                (4) | Val  Loss: 1.2987 | Val  Acc: 0.5652
 Site-East_Asian                (4) | Val  Loss: 1.3695 | Val  Acc: 0.4964
 Site-Indian                    (6) | Val  Loss: 1.5251 | Val  Acc: 0.3370
 Site-Indian                    (5) | Val  Loss: 1.4602 | Val  Acc: 0.4101
 Site-Southeast_Asian           (1) | Val  Loss: 1.4614 | Val  Acc: 0.4348
 Site-Southeast_Asian           (1) | Val  Loss: 1.3948 | Val  Acc: 0.4820
 Site-Middle_Eastern            (2) | Val  Loss: 1.4001 | Val  Acc: 0.4239
 Site-Middle_Eastern            (2) | Val  Loss: 1.4601 | Val  Acc: 0.4388
Average Valid Accuracy: 0.4557
Aggregated Acc | Val Acc: 0.4481
 Best site-White                    (3)  | Epoch:28 | Val Acc: 0.4674
 Best site-White                    (3)  | Epoch:28 | Val Acc: 0.4496
 Best site-Latino_Hispanic          (3)  | Epoch:28 | Val Acc: 0.4130
 Best site-Latino_Hispanic          (5)  | Epoch:28 | Val Acc: 0.4065
 Best site-Black                    (0)  | Epoch:28 | Val Acc: 0.5870
 Best site-Black                    (0)  | Epoch:28 | Val Acc: 0.4676
 Best site-East_Asian               (4)  | Epoch:28 | Val Acc: 0.5652
 Best site-East_Asian               (4)  | Epoch:28 | Val Acc: 0.4964
 Best site-Indian                   (6)  | Epoch:28 | Val Acc: 0.3370
 Best site-Indian                   (5)  | Epoch:28 | Val Acc: 0.4101
 Best site-Southeast_Asian          (1)  | Epoch:28 | Val Acc: 0.4348
 Best site-Southeast_Asian          (1)  | Epoch:28 | Val Acc: 0.4820
 Best site-Middle_Eastern           (2)  | Epoch:28 | Val Acc: 0.4239
 Best site-Middle_Eastern           (2)  | Epoch:28 | Val Acc: 0.4388
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 29 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
min_w=0.06496, quan_i=1.47, quan_c=1.49
minimize weight of clients:[0, 1, 6, 7, 10, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.4385 | Train Acc: 0.4532
 Site-White                    | Train Loss: 1.4154 | Train Acc: 0.4556
 Site-Latino_Hispanic          | Train Loss: 1.4655 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.4157 | Train Acc: 0.4245
 Site-Black                    | Train Loss: 1.5463 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.4630 | Train Acc: 0.4652
 Site-East_Asian               | Train Loss: 1.5247 | Train Acc: 0.4029
 Site-East_Asian               | Train Loss: 1.4334 | Train Acc: 0.4580
 Site-Indian                   | Train Loss: 1.3333 | Train Acc: 0.4604
 Site-Indian                   | Train Loss: 1.4541 | Train Acc: 0.4173
 Site-Southeast_Asian          | Train Loss: 1.6091 | Train Acc: 0.4317
 Site-Southeast_Asian          | Train Loss: 1.4747 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.3828 | Train Acc: 0.4101
 Site-Middle_Eastern           | Train Loss: 1.4277 | Train Acc: 0.4388
 Site-White                     (3) | Val  Loss: 1.5499 | Val  Acc: 0.4348
 Site-White                     (3) | Val  Loss: 1.4136 | Val  Acc: 0.4820
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4154 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4117 | Val  Acc: 0.4388
 Site-Black                     (2) | Val  Loss: 1.2692 | Val  Acc: 0.6087
 Site-Black                     (2) | Val  Loss: 1.4418 | Val  Acc: 0.4784
 Site-East_Asian                (5) | Val  Loss: 1.3420 | Val  Acc: 0.5326
 Site-East_Asian                (5) | Val  Loss: 1.4091 | Val  Acc: 0.4676
 Site-Indian                    (1) | Val  Loss: 1.4999 | Val  Acc: 0.4239
 Site-Indian                    (1) | Val  Loss: 1.4552 | Val  Acc: 0.4317
 Site-Southeast_Asian           (0) | Val  Loss: 1.4515 | Val  Acc: 0.4348
 Site-Southeast_Asian           (0) | Val  Loss: 1.4177 | Val  Acc: 0.4820
 Site-Middle_Eastern            (4) | Val  Loss: 1.3806 | Val  Acc: 0.4239
 Site-Middle_Eastern            (4) | Val  Loss: 1.4710 | Val  Acc: 0.4496
Average Valid Accuracy: 0.4644
Aggregated Acc | Val Acc: 0.4644
 Best site-White                    (3)  | Epoch:29 | Val Acc: 0.4348
 Best site-White                    (3)  | Epoch:29 | Val Acc: 0.4820
 Best site-Latino_Hispanic          (6)  | Epoch:29 | Val Acc: 0.4130
 Best site-Latino_Hispanic          (6)  | Epoch:29 | Val Acc: 0.4388
 Best site-Black                    (2)  | Epoch:29 | Val Acc: 0.6087
 Best site-Black                    (2)  | Epoch:29 | Val Acc: 0.4784
 Best site-East_Asian               (5)  | Epoch:29 | Val Acc: 0.5326
 Best site-East_Asian               (5)  | Epoch:29 | Val Acc: 0.4676
 Best site-Indian                   (1)  | Epoch:29 | Val Acc: 0.4239
 Best site-Indian                   (1)  | Epoch:29 | Val Acc: 0.4317
 Best site-Southeast_Asian          (0)  | Epoch:29 | Val Acc: 0.4348
 Best site-Southeast_Asian          (0)  | Epoch:29 | Val Acc: 0.4820
 Best site-Middle_Eastern           (4)  | Epoch:29 | Val Acc: 0.4239
 Best site-Middle_Eastern           (4)  | Epoch:29 | Val Acc: 0.4496
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
 Test site-White                    | Epoch:29 | Test Acc: 0.4225
 Test site-Latino_Hispanic          | Epoch:29 | Test Acc: 0.3481
 Test site-Black                    | Epoch:29 | Test Acc: 0.3094
 Test site-East_Asian               | Epoch:29 | Test Acc: 0.4383
 Test site-Indian                   | Epoch:29 | Test Acc: 0.3301
 Test site-Southeast_Asian          | Epoch:29 | Test Acc: 0.4148
 Test site-Middle_Eastern           | Epoch:29 | Test Acc: 0.4330
Average Test Accuracy: 0.3852, domain std=0.0500, individual std=0.0500
============ Train epoch 30 ============
cnt=[3, 2, 1, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
min_w=0.06805, quan_i=1.47, quan_c=1.47
minimize weight of clients:[0, 1, 2, 3, 7, 8, 9, 12, 13, ]
 Site-White                    | Train Loss: 1.3549 | Train Acc: 0.4317
 Site-White                    | Train Loss: 1.4122 | Train Acc: 0.4652
 Site-Latino_Hispanic          | Train Loss: 1.5760 | Train Acc: 0.3885
 Site-Latino_Hispanic          | Train Loss: 1.4340 | Train Acc: 0.4197
 Site-Black                    | Train Loss: 1.6474 | Train Acc: 0.4245
 Site-Black                    | Train Loss: 1.4733 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3920 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3978 | Train Acc: 0.4700
 Site-Indian                   | Train Loss: 1.4047 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.4611 | Train Acc: 0.4053
 Site-Southeast_Asian          | Train Loss: 1.4341 | Train Acc: 0.5036
 Site-Southeast_Asian          | Train Loss: 1.4374 | Train Acc: 0.4796
 Site-Middle_Eastern           | Train Loss: 1.3867 | Train Acc: 0.4964
 Site-Middle_Eastern           | Train Loss: 1.4196 | Train Acc: 0.4484
 Site-White                     (5) | Val  Loss: 1.5081 | Val  Acc: 0.4457
 Site-White                     (2) | Val  Loss: 1.4325 | Val  Acc: 0.4424
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4432 | Val  Acc: 0.3913
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4526 | Val  Acc: 0.3993
 Site-Black                     (4) | Val  Loss: 1.2542 | Val  Acc: 0.5870
 Site-Black                     (4) | Val  Loss: 1.4731 | Val  Acc: 0.4820
 Site-East_Asian                (1) | Val  Loss: 1.2457 | Val  Acc: 0.5543
 Site-East_Asian                (1) | Val  Loss: 1.3865 | Val  Acc: 0.4676
 Site-Indian                    (0) | Val  Loss: 1.5351 | Val  Acc: 0.3370
 Site-Indian                    (0) | Val  Loss: 1.4284 | Val  Acc: 0.4209
 Site-Southeast_Asian           (3) | Val  Loss: 1.4164 | Val  Acc: 0.4674
 Site-Southeast_Asian           (3) | Val  Loss: 1.3985 | Val  Acc: 0.4784
 Site-Middle_Eastern            (6) | Val  Loss: 1.3738 | Val  Acc: 0.4348
 Site-Middle_Eastern            (6) | Val  Loss: 1.4819 | Val  Acc: 0.4281
Average Valid Accuracy: 0.4526
Aggregated Acc | Val Acc: 0.4566
============ Train epoch 31 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
min_w=0.06910, quan_i=1.45, quan_c=1.46
minimize weight of clients:[0, 1, 6, 7, 8, 10, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.2808 | Train Acc: 0.4317
 Site-White                    | Train Loss: 1.4243 | Train Acc: 0.4676
 Site-Latino_Hispanic          | Train Loss: 1.5698 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.4115 | Train Acc: 0.4101
 Site-Black                    | Train Loss: 1.6458 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.4804 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.3815 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.4152 | Train Acc: 0.4484
 Site-Indian                   | Train Loss: 1.3574 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.4470 | Train Acc: 0.4245
 Site-Southeast_Asian          | Train Loss: 1.4905 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.4333 | Train Acc: 0.4676
 Site-Middle_Eastern           | Train Loss: 1.4397 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.4056 | Train Acc: 0.4532
 Site-White                     (5) | Val  Loss: 1.4912 | Val  Acc: 0.4239
 Site-White                     (5) | Val  Loss: 1.4405 | Val  Acc: 0.4640
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4048 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4257 | Val  Acc: 0.4101
 Site-Black                     (0) | Val  Loss: 1.2777 | Val  Acc: 0.5978
 Site-Black                     (0) | Val  Loss: 1.4474 | Val  Acc: 0.4748
 Site-East_Asian                (6) | Val  Loss: 1.2769 | Val  Acc: 0.5435
 Site-East_Asian                (6) | Val  Loss: 1.3588 | Val  Acc: 0.5072
 Site-Indian                    (4) | Val  Loss: 1.4733 | Val  Acc: 0.3261
 Site-Indian                    (4) | Val  Loss: 1.4412 | Val  Acc: 0.4532
 Site-Southeast_Asian           (1) | Val  Loss: 1.4370 | Val  Acc: 0.4348
 Site-Southeast_Asian           (1) | Val  Loss: 1.4123 | Val  Acc: 0.4784
 Site-Middle_Eastern            (2) | Val  Loss: 1.3432 | Val  Acc: 0.4457
 Site-Middle_Eastern            (2) | Val  Loss: 1.4679 | Val  Acc: 0.4388
Average Valid Accuracy: 0.4580
Aggregated Acc | Val Acc: 0.4580
============ Train epoch 32 ============
cnt=[2, 4, 2, 1, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
min_w=0.05870, quan_i=1.45, quan_c=1.45
minimize weight of clients:[0, 1, 3, 6, 7, 8, 9, 12, 13, ]
 Site-White                    | Train Loss: 1.3919 | Train Acc: 0.4532
 Site-White                    | Train Loss: 1.4214 | Train Acc: 0.4628
 Site-Latino_Hispanic          | Train Loss: 1.4659 | Train Acc: 0.4460
 Site-Latino_Hispanic          | Train Loss: 1.4109 | Train Acc: 0.4365
 Site-Black                    | Train Loss: 1.7032 | Train Acc: 0.3597
 Site-Black                    | Train Loss: 1.4428 | Train Acc: 0.4820
 Site-East_Asian               | Train Loss: 1.4487 | Train Acc: 0.4964
 Site-East_Asian               | Train Loss: 1.4020 | Train Acc: 0.4604
 Site-Indian                   | Train Loss: 1.2481 | Train Acc: 0.5036
 Site-Indian                   | Train Loss: 1.4275 | Train Acc: 0.4341
 Site-Southeast_Asian          | Train Loss: 1.4122 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.4184 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.3840 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.3815 | Train Acc: 0.4580
 Site-White                     (4) | Val  Loss: 1.4861 | Val  Acc: 0.4130
 Site-White                     (3) | Val  Loss: 1.4301 | Val  Acc: 0.4173
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4134 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4321 | Val  Acc: 0.4173
 Site-Black                     (2) | Val  Loss: 1.2967 | Val  Acc: 0.5870
 Site-Black                     (2) | Val  Loss: 1.4181 | Val  Acc: 0.4676
 Site-East_Asian                (6) | Val  Loss: 1.2949 | Val  Acc: 0.5326
 Site-East_Asian                (6) | Val  Loss: 1.3613 | Val  Acc: 0.5144
 Site-Indian                    (1) | Val  Loss: 1.4091 | Val  Acc: 0.3913
 Site-Indian                    (1) | Val  Loss: 1.4336 | Val  Acc: 0.4137
 Site-Southeast_Asian           (5) | Val  Loss: 1.3951 | Val  Acc: 0.4783
 Site-Southeast_Asian           (5) | Val  Loss: 1.3829 | Val  Acc: 0.4856
 Site-Middle_Eastern            (0) | Val  Loss: 1.3824 | Val  Acc: 0.4239
 Site-Middle_Eastern            (0) | Val  Loss: 1.4744 | Val  Acc: 0.4137
Average Valid Accuracy: 0.4549
Aggregated Acc | Val Acc: 0.4558
============ Train epoch 33 ============
cnt=[2, 3, 4, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
min_w=0.06257, quan_i=1.43, quan_c=1.43
minimize weight of clients:[1, 7, 8, 9, 10, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.4182 | Train Acc: 0.4245
 Site-White                    | Train Loss: 1.4172 | Train Acc: 0.4412
 Site-Latino_Hispanic          | Train Loss: 1.5857 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.4125 | Train Acc: 0.4197
 Site-Black                    | Train Loss: 1.6045 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.4578 | Train Acc: 0.4628
 Site-East_Asian               | Train Loss: 1.5064 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.4077 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.2500 | Train Acc: 0.5036
 Site-Indian                   | Train Loss: 1.4672 | Train Acc: 0.4341
 Site-Southeast_Asian          | Train Loss: 1.5205 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.4364 | Train Acc: 0.4844
 Site-Middle_Eastern           | Train Loss: 1.3566 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.4047 | Train Acc: 0.4365
 Site-White                     (1) | Val  Loss: 1.4699 | Val  Acc: 0.4891
 Site-White                     (4) | Val  Loss: 1.4202 | Val  Acc: 0.4317
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4072 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4096 | Val  Acc: 0.4281
 Site-Black                     (0) | Val  Loss: 1.2214 | Val  Acc: 0.5761
 Site-Black                     (0) | Val  Loss: 1.3950 | Val  Acc: 0.5180
 Site-East_Asian                (5) | Val  Loss: 1.2535 | Val  Acc: 0.5761
 Site-East_Asian                (5) | Val  Loss: 1.3648 | Val  Acc: 0.4784
 Site-Indian                    (2) | Val  Loss: 1.5204 | Val  Acc: 0.3478
 Site-Indian                    (2) | Val  Loss: 1.4409 | Val  Acc: 0.4424
 Site-Southeast_Asian           (2) | Val  Loss: 1.4355 | Val  Acc: 0.4674
 Site-Southeast_Asian           (2) | Val  Loss: 1.3597 | Val  Acc: 0.5000
 Site-Middle_Eastern            (6) | Val  Loss: 1.3769 | Val  Acc: 0.4783
 Site-Middle_Eastern            (3) | Val  Loss: 1.4681 | Val  Acc: 0.4532
Average Valid Accuracy: 0.4722
Aggregated Acc | Val Acc: 0.4748
 Best site-White                    (1)  | Epoch:33 | Val Acc: 0.4891
 Best site-White                    (4)  | Epoch:33 | Val Acc: 0.4317
 Best site-Latino_Hispanic          (1)  | Epoch:33 | Val Acc: 0.4239
 Best site-Latino_Hispanic          (1)  | Epoch:33 | Val Acc: 0.4281
 Best site-Black                    (0)  | Epoch:33 | Val Acc: 0.5761
 Best site-Black                    (0)  | Epoch:33 | Val Acc: 0.5180
 Best site-East_Asian               (5)  | Epoch:33 | Val Acc: 0.5761
 Best site-East_Asian               (5)  | Epoch:33 | Val Acc: 0.4784
 Best site-Indian                   (2)  | Epoch:33 | Val Acc: 0.3478
 Best site-Indian                   (2)  | Epoch:33 | Val Acc: 0.4424
 Best site-Southeast_Asian          (2)  | Epoch:33 | Val Acc: 0.4674
 Best site-Southeast_Asian          (2)  | Epoch:33 | Val Acc: 0.5000
 Best site-Middle_Eastern           (6)  | Epoch:33 | Val Acc: 0.4783
 Best site-Middle_Eastern           (3)  | Epoch:33 | Val Acc: 0.4532
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 34 ============
cnt=[2, 2, 2, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
min_w=0.06324, quan_i=1.48, quan_c=1.47
minimize weight of clients:[0, 1, 3, 7, 8, 9, 12, 13, ]
 Site-White                    | Train Loss: 1.2747 | Train Acc: 0.4964
 Site-White                    | Train Loss: 1.4002 | Train Acc: 0.4724
 Site-Latino_Hispanic          | Train Loss: 1.5452 | Train Acc: 0.3885
 Site-Latino_Hispanic          | Train Loss: 1.4197 | Train Acc: 0.4197
 Site-Black                    | Train Loss: 1.5845 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.4110 | Train Acc: 0.4820
 Site-East_Asian               | Train Loss: 1.3327 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.3861 | Train Acc: 0.4700
 Site-Indian                   | Train Loss: 1.4293 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.4583 | Train Acc: 0.4173
 Site-Southeast_Asian          | Train Loss: 1.3770 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3998 | Train Acc: 0.4844
 Site-Middle_Eastern           | Train Loss: 1.2751 | Train Acc: 0.5324
 Site-Middle_Eastern           | Train Loss: 1.3899 | Train Acc: 0.4436
 Site-White                     (4) | Val  Loss: 1.5250 | Val  Acc: 0.4348
 Site-White                     (4) | Val  Loss: 1.3835 | Val  Acc: 0.4712
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3817 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4318 | Val  Acc: 0.4353
 Site-Black                     (2) | Val  Loss: 1.2560 | Val  Acc: 0.5978
 Site-Black                     (2) | Val  Loss: 1.4290 | Val  Acc: 0.5108
 Site-East_Asian                (5) | Val  Loss: 1.2475 | Val  Acc: 0.5217
 Site-East_Asian                (5) | Val  Loss: 1.3360 | Val  Acc: 0.5108
 Site-Indian                    (3) | Val  Loss: 1.4799 | Val  Acc: 0.4239
 Site-Indian                    (3) | Val  Loss: 1.4219 | Val  Acc: 0.4173
 Site-Southeast_Asian           (0) | Val  Loss: 1.4074 | Val  Acc: 0.5109
 Site-Southeast_Asian           (0) | Val  Loss: 1.3541 | Val  Acc: 0.5144
 Site-Middle_Eastern            (1) | Val  Loss: 1.3852 | Val  Acc: 0.4457
 Site-Middle_Eastern            (1) | Val  Loss: 1.4619 | Val  Acc: 0.4317
Average Valid Accuracy: 0.4773
Aggregated Acc | Val Acc: 0.4796
 Best site-White                    (4)  | Epoch:34 | Val Acc: 0.4348
 Best site-White                    (4)  | Epoch:34 | Val Acc: 0.4712
 Best site-Latino_Hispanic          (6)  | Epoch:34 | Val Acc: 0.4565
 Best site-Latino_Hispanic          (3)  | Epoch:34 | Val Acc: 0.4353
 Best site-Black                    (2)  | Epoch:34 | Val Acc: 0.5978
 Best site-Black                    (2)  | Epoch:34 | Val Acc: 0.5108
 Best site-East_Asian               (5)  | Epoch:34 | Val Acc: 0.5217
 Best site-East_Asian               (5)  | Epoch:34 | Val Acc: 0.5108
 Best site-Indian                   (3)  | Epoch:34 | Val Acc: 0.4239
 Best site-Indian                   (3)  | Epoch:34 | Val Acc: 0.4173
 Best site-Southeast_Asian          (0)  | Epoch:34 | Val Acc: 0.5109
 Best site-Southeast_Asian          (0)  | Epoch:34 | Val Acc: 0.5144
 Best site-Middle_Eastern           (1)  | Epoch:34 | Val Acc: 0.4457
 Best site-Middle_Eastern           (1)  | Epoch:34 | Val Acc: 0.4317
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 35 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
min_w=0.06294, quan_i=1.43, quan_c=1.46
minimize weight of clients:[0, 1, 3, 6, 7, 10, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.3036 | Train Acc: 0.4676
 Site-White                    | Train Loss: 1.3853 | Train Acc: 0.4460
 Site-Latino_Hispanic          | Train Loss: 1.6363 | Train Acc: 0.3669
 Site-Latino_Hispanic          | Train Loss: 1.4125 | Train Acc: 0.4245
 Site-Black                    | Train Loss: 1.6943 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.4165 | Train Acc: 0.5012
 Site-East_Asian               | Train Loss: 1.3930 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.4306 | Train Acc: 0.4460
 Site-Indian                   | Train Loss: 1.3050 | Train Acc: 0.5324
 Site-Indian                   | Train Loss: 1.4115 | Train Acc: 0.4580
 Site-Southeast_Asian          | Train Loss: 1.4163 | Train Acc: 0.5036
 Site-Southeast_Asian          | Train Loss: 1.4392 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.3089 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.4001 | Train Acc: 0.4508
 Site-White                     (5) | Val  Loss: 1.4865 | Val  Acc: 0.4022
 Site-White                     (5) | Val  Loss: 1.4153 | Val  Acc: 0.4424
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3857 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4187 | Val  Acc: 0.4137
 Site-Black                     (4) | Val  Loss: 1.2143 | Val  Acc: 0.6304
 Site-Black                     (4) | Val  Loss: 1.3983 | Val  Acc: 0.5000
 Site-East_Asian                (0) | Val  Loss: 1.2594 | Val  Acc: 0.5870
 Site-East_Asian                (0) | Val  Loss: 1.3408 | Val  Acc: 0.5036
 Site-Indian                    (1) | Val  Loss: 1.4218 | Val  Acc: 0.4022
 Site-Indian                    (1) | Val  Loss: 1.4101 | Val  Acc: 0.4532
 Site-Southeast_Asian           (3) | Val  Loss: 1.4699 | Val  Acc: 0.4565
 Site-Southeast_Asian           (3) | Val  Loss: 1.3570 | Val  Acc: 0.5216
 Site-Middle_Eastern            (2) | Val  Loss: 1.3486 | Val  Acc: 0.5000
 Site-Middle_Eastern            (2) | Val  Loss: 1.4662 | Val  Acc: 0.4173
Average Valid Accuracy: 0.4753
Aggregated Acc | Val Acc: 0.4753
============ Train epoch 36 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
min_w=0.06436, quan_i=1.43, quan_c=1.45
minimize weight of clients:[0, 1, 6, 8, 9, 10, 12, 13, ]
 Site-White                    | Train Loss: 1.3968 | Train Acc: 0.4604
 Site-White                    | Train Loss: 1.3764 | Train Acc: 0.4580
 Site-Latino_Hispanic          | Train Loss: 1.4846 | Train Acc: 0.4173
 Site-Latino_Hispanic          | Train Loss: 1.3988 | Train Acc: 0.4245
 Site-Black                    | Train Loss: 1.7398 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.4608 | Train Acc: 0.4772
 Site-East_Asian               | Train Loss: 1.3884 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.3805 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.2623 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.4303 | Train Acc: 0.4221
 Site-Southeast_Asian          | Train Loss: 1.4025 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.3881 | Train Acc: 0.5060
 Site-Middle_Eastern           | Train Loss: 1.4888 | Train Acc: 0.4964
 Site-Middle_Eastern           | Train Loss: 1.3918 | Train Acc: 0.4484
 Site-White                     (4) | Val  Loss: 1.4685 | Val  Acc: 0.4239
 Site-White                     (4) | Val  Loss: 1.4132 | Val  Acc: 0.4496
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3758 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4121 | Val  Acc: 0.4101
 Site-Black                     (5) | Val  Loss: 1.2256 | Val  Acc: 0.5870
 Site-Black                     (5) | Val  Loss: 1.3905 | Val  Acc: 0.5144
 Site-East_Asian                (3) | Val  Loss: 1.2222 | Val  Acc: 0.5870
 Site-East_Asian                (3) | Val  Loss: 1.3156 | Val  Acc: 0.5324
 Site-Indian                    (2) | Val  Loss: 1.4444 | Val  Acc: 0.4239
 Site-Indian                    (2) | Val  Loss: 1.4230 | Val  Acc: 0.4353
 Site-Southeast_Asian           (1) | Val  Loss: 1.2905 | Val  Acc: 0.5109
 Site-Southeast_Asian           (1) | Val  Loss: 1.3369 | Val  Acc: 0.5072
 Site-Middle_Eastern            (0) | Val  Loss: 1.3842 | Val  Acc: 0.4674
 Site-Middle_Eastern            (0) | Val  Loss: 1.4609 | Val  Acc: 0.4209
Average Valid Accuracy: 0.4773
Aggregated Acc | Val Acc: 0.4773
 Best site-White                    (4)  | Epoch:36 | Val Acc: 0.4239
 Best site-White                    (4)  | Epoch:36 | Val Acc: 0.4496
 Best site-Latino_Hispanic          (6)  | Epoch:36 | Val Acc: 0.4130
 Best site-Latino_Hispanic          (6)  | Epoch:36 | Val Acc: 0.4101
 Best site-Black                    (5)  | Epoch:36 | Val Acc: 0.5870
 Best site-Black                    (5)  | Epoch:36 | Val Acc: 0.5144
 Best site-East_Asian               (3)  | Epoch:36 | Val Acc: 0.5870
 Best site-East_Asian               (3)  | Epoch:36 | Val Acc: 0.5324
 Best site-Indian                   (2)  | Epoch:36 | Val Acc: 0.4239
 Best site-Indian                   (2)  | Epoch:36 | Val Acc: 0.4353
 Best site-Southeast_Asian          (1)  | Epoch:36 | Val Acc: 0.5109
 Best site-Southeast_Asian          (1)  | Epoch:36 | Val Acc: 0.5072
 Best site-Middle_Eastern           (0)  | Epoch:36 | Val Acc: 0.4674
 Best site-Middle_Eastern           (0)  | Epoch:36 | Val Acc: 0.4209
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 37 ============
cnt=[3, 2, 2, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
min_w=0.06333, quan_i=1.45, quan_c=1.43
minimize weight of clients:[0, 1, 3, 6, 7, 8, 9, 10, 11, ]
 Site-White                    | Train Loss: 1.4033 | Train Acc: 0.4676
 Site-White                    | Train Loss: 1.3839 | Train Acc: 0.4556
 Site-Latino_Hispanic          | Train Loss: 1.5815 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.3908 | Train Acc: 0.4388
 Site-Black                    | Train Loss: 1.5689 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.4287 | Train Acc: 0.4628
 Site-East_Asian               | Train Loss: 1.4289 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.3951 | Train Acc: 0.4652
 Site-Indian                   | Train Loss: 1.3196 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.4360 | Train Acc: 0.4412
 Site-Southeast_Asian          | Train Loss: 1.5046 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.4032 | Train Acc: 0.5012
 Site-Middle_Eastern           | Train Loss: 1.4528 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.3679 | Train Acc: 0.4796
 Site-White                     (0) | Val  Loss: 1.4653 | Val  Acc: 0.4783
 Site-White                     (5) | Val  Loss: 1.3907 | Val  Acc: 0.4640
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3894 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4244 | Val  Acc: 0.4101
 Site-Black                     (2) | Val  Loss: 1.2381 | Val  Acc: 0.5870
 Site-Black                     (2) | Val  Loss: 1.3749 | Val  Acc: 0.5144
 Site-East_Asian                (6) | Val  Loss: 1.2285 | Val  Acc: 0.5761
 Site-East_Asian                (6) | Val  Loss: 1.3372 | Val  Acc: 0.4964
 Site-Indian                    (1) | Val  Loss: 1.5223 | Val  Acc: 0.4239
 Site-Indian                    (1) | Val  Loss: 1.4290 | Val  Acc: 0.4173
 Site-Southeast_Asian           (3) | Val  Loss: 1.4157 | Val  Acc: 0.4130
 Site-Southeast_Asian           (3) | Val  Loss: 1.3813 | Val  Acc: 0.4820
 Site-Middle_Eastern            (4) | Val  Loss: 1.3495 | Val  Acc: 0.5326
 Site-Middle_Eastern            (4) | Val  Loss: 1.4493 | Val  Acc: 0.4245
Average Valid Accuracy: 0.4738
Aggregated Acc | Val Acc: 0.4759
============ Train epoch 38 ============
cnt=[2, 3, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
min_w=0.06756, quan_i=1.45, quan_c=1.44
minimize weight of clients:[0, 1, 6, 7, 8, 9, 11, 13, ]
 Site-White                    | Train Loss: 1.4261 | Train Acc: 0.4317
 Site-White                    | Train Loss: 1.3943 | Train Acc: 0.4748
 Site-Latino_Hispanic          | Train Loss: 1.6268 | Train Acc: 0.3957
 Site-Latino_Hispanic          | Train Loss: 1.4060 | Train Acc: 0.4269
 Site-Black                    | Train Loss: 1.5837 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.3880 | Train Acc: 0.4844
 Site-East_Asian               | Train Loss: 1.3051 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.3948 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.1966 | Train Acc: 0.5108
 Site-Indian                   | Train Loss: 1.4219 | Train Acc: 0.4341
 Site-Southeast_Asian          | Train Loss: 1.3522 | Train Acc: 0.4892
 Site-Southeast_Asian          | Train Loss: 1.4300 | Train Acc: 0.4796
 Site-Middle_Eastern           | Train Loss: 1.4270 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.3953 | Train Acc: 0.4460
 Site-White                     (6) | Val  Loss: 1.4703 | Val  Acc: 0.4674
 Site-White                     (1) | Val  Loss: 1.3714 | Val  Acc: 0.4640
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3838 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3782 | Val  Acc: 0.4245
 Site-Black                     (2) | Val  Loss: 1.2395 | Val  Acc: 0.5978
 Site-Black                     (2) | Val  Loss: 1.3650 | Val  Acc: 0.5396
 Site-East_Asian                (5) | Val  Loss: 1.2282 | Val  Acc: 0.5652
 Site-East_Asian                (5) | Val  Loss: 1.3072 | Val  Acc: 0.5324
 Site-Indian                    (4) | Val  Loss: 1.4582 | Val  Acc: 0.4130
 Site-Indian                    (4) | Val  Loss: 1.4241 | Val  Acc: 0.4245
 Site-Southeast_Asian           (0) | Val  Loss: 1.4040 | Val  Acc: 0.4565
 Site-Southeast_Asian           (0) | Val  Loss: 1.3725 | Val  Acc: 0.4892
 Site-Middle_Eastern            (1) | Val  Loss: 1.3612 | Val  Acc: 0.4783
 Site-Middle_Eastern            (1) | Val  Loss: 1.4442 | Val  Acc: 0.4568
Average Valid Accuracy: 0.4840
Aggregated Acc | Val Acc: 0.4841
 Best site-White                    (6)  | Epoch:38 | Val Acc: 0.4674
 Best site-White                    (1)  | Epoch:38 | Val Acc: 0.4640
 Best site-Latino_Hispanic          (3)  | Epoch:38 | Val Acc: 0.4674
 Best site-Latino_Hispanic          (3)  | Epoch:38 | Val Acc: 0.4245
 Best site-Black                    (2)  | Epoch:38 | Val Acc: 0.5978
 Best site-Black                    (2)  | Epoch:38 | Val Acc: 0.5396
 Best site-East_Asian               (5)  | Epoch:38 | Val Acc: 0.5652
 Best site-East_Asian               (5)  | Epoch:38 | Val Acc: 0.5324
 Best site-Indian                   (4)  | Epoch:38 | Val Acc: 0.4130
 Best site-Indian                   (4)  | Epoch:38 | Val Acc: 0.4245
 Best site-Southeast_Asian          (0)  | Epoch:38 | Val Acc: 0.4565
 Best site-Southeast_Asian          (0)  | Epoch:38 | Val Acc: 0.4892
 Best site-Middle_Eastern           (1)  | Epoch:38 | Val Acc: 0.4783
 Best site-Middle_Eastern           (1)  | Epoch:38 | Val Acc: 0.4568
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 39 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
min_w=0.05895, quan_i=1.43, quan_c=1.43
minimize weight of clients:[1, 6, 7, 8, 10, 13, ]
 Site-White                    | Train Loss: 1.4101 | Train Acc: 0.4820
 Site-White                    | Train Loss: 1.3991 | Train Acc: 0.4700
 Site-Latino_Hispanic          | Train Loss: 1.5474 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.3965 | Train Acc: 0.4508
 Site-Black                    | Train Loss: 1.5395 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.4453 | Train Acc: 0.4868
 Site-East_Asian               | Train Loss: 1.3658 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.3849 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.2377 | Train Acc: 0.4604
 Site-Indian                   | Train Loss: 1.3833 | Train Acc: 0.4652
 Site-Southeast_Asian          | Train Loss: 1.3915 | Train Acc: 0.4964
 Site-Southeast_Asian          | Train Loss: 1.3881 | Train Acc: 0.5060
 Site-Middle_Eastern           | Train Loss: 1.4259 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.3383 | Train Acc: 0.4580
 Site-White                     (6) | Val  Loss: 1.4820 | Val  Acc: 0.4674
 Site-White                     (6) | Val  Loss: 1.3586 | Val  Acc: 0.5108
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3594 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3723 | Val  Acc: 0.4388
 Site-Black                     (2) | Val  Loss: 1.2262 | Val  Acc: 0.5761
 Site-Black                     (2) | Val  Loss: 1.3946 | Val  Acc: 0.5108
 Site-East_Asian                (0) | Val  Loss: 1.3137 | Val  Acc: 0.5109
 Site-East_Asian                (0) | Val  Loss: 1.3420 | Val  Acc: 0.5108
 Site-Indian                    (4) | Val  Loss: 1.4890 | Val  Acc: 0.4022
 Site-Indian                    (4) | Val  Loss: 1.3895 | Val  Acc: 0.4604
 Site-Southeast_Asian           (3) | Val  Loss: 1.3755 | Val  Acc: 0.4674
 Site-Southeast_Asian           (3) | Val  Loss: 1.3273 | Val  Acc: 0.5072
 Site-Middle_Eastern            (1) | Val  Loss: 1.3280 | Val  Acc: 0.5000
 Site-Middle_Eastern            (1) | Val  Loss: 1.4263 | Val  Acc: 0.4532
Average Valid Accuracy: 0.4822
Aggregated Acc | Val Acc: 0.4822
============ Train epoch 40 ============
cnt=[2, 3, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
min_w=0.05580, quan_i=1.43, quan_c=1.42
minimize weight of clients:[1, 6, 7, 8, 10, 11, 13, ]
 Site-White                    | Train Loss: 1.3325 | Train Acc: 0.4820
 Site-White                    | Train Loss: 1.3730 | Train Acc: 0.4580
 Site-Latino_Hispanic          | Train Loss: 1.5304 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.3613 | Train Acc: 0.4532
 Site-Black                    | Train Loss: 1.5865 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.3905 | Train Acc: 0.5132
 Site-East_Asian               | Train Loss: 1.3721 | Train Acc: 0.4820
 Site-East_Asian               | Train Loss: 1.4331 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.3428 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.4013 | Train Acc: 0.4365
 Site-Southeast_Asian          | Train Loss: 1.4076 | Train Acc: 0.4964
 Site-Southeast_Asian          | Train Loss: 1.4014 | Train Acc: 0.4772
 Site-Middle_Eastern           | Train Loss: 1.4783 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.3506 | Train Acc: 0.4700
 Site-White                     (3) | Val  Loss: 1.4380 | Val  Acc: 0.4674
 Site-White                     (3) | Val  Loss: 1.4183 | Val  Acc: 0.4568
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3544 | Val  Acc: 0.3913
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3673 | Val  Acc: 0.4281
 Site-Black                     (0) | Val  Loss: 1.1726 | Val  Acc: 0.6413
 Site-Black                     (0) | Val  Loss: 1.3592 | Val  Acc: 0.5576
 Site-East_Asian                (5) | Val  Loss: 1.2760 | Val  Acc: 0.5652
 Site-East_Asian                (5) | Val  Loss: 1.3676 | Val  Acc: 0.4856
 Site-Indian                    (6) | Val  Loss: 1.5256 | Val  Acc: 0.3804
 Site-Indian                    (1) | Val  Loss: 1.3604 | Val  Acc: 0.4317
 Site-Southeast_Asian           (4) | Val  Loss: 1.4059 | Val  Acc: 0.4674
 Site-Southeast_Asian           (4) | Val  Loss: 1.3507 | Val  Acc: 0.5000
 Site-Middle_Eastern            (2) | Val  Loss: 1.3696 | Val  Acc: 0.5217
 Site-Middle_Eastern            (2) | Val  Loss: 1.4577 | Val  Acc: 0.3849
Average Valid Accuracy: 0.4771
Aggregated Acc | Val Acc: 0.4745
 Test site-White                    | Epoch:38 | Test Acc: 0.4064
 Test site-Latino_Hispanic          | Epoch:38 | Test Acc: 0.3481
 Test site-Black                    | Epoch:38 | Test Acc: 0.3250
 Test site-East_Asian               | Epoch:38 | Test Acc: 0.4643
 Test site-Indian                   | Epoch:38 | Test Acc: 0.3445
 Test site-Southeast_Asian          | Epoch:38 | Test Acc: 0.4222
 Test site-Middle_Eastern           | Epoch:38 | Test Acc: 0.4381
Average Test Accuracy: 0.3927, domain std=0.0495, individual std=0.0495
Average Test Accuracy: 0.3927
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 41 ============
cnt=[4, 1, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
min_w=0.06545, quan_i=1.41, quan_c=1.41
minimize weight of clients:[0, 1, 3, 8, 9, 10, 11, 13, ]
 Site-White                    | Train Loss: 1.2824 | Train Acc: 0.4388
 Site-White                    | Train Loss: 1.3722 | Train Acc: 0.4628
 Site-Latino_Hispanic          | Train Loss: 1.6186 | Train Acc: 0.3957
 Site-Latino_Hispanic          | Train Loss: 1.3965 | Train Acc: 0.4388
 Site-Black                    | Train Loss: 1.5840 | Train Acc: 0.4101
 Site-Black                    | Train Loss: 1.3742 | Train Acc: 0.5060
 Site-East_Asian               | Train Loss: 1.2350 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3558 | Train Acc: 0.4916
 Site-Indian                   | Train Loss: 1.3112 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.4336 | Train Acc: 0.4293
 Site-Southeast_Asian          | Train Loss: 1.4427 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.4044 | Train Acc: 0.5012
 Site-Middle_Eastern           | Train Loss: 1.2776 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.3493 | Train Acc: 0.4580
 Site-White                     (2) | Val  Loss: 1.4567 | Val  Acc: 0.4891
 Site-White                     (2) | Val  Loss: 1.3913 | Val  Acc: 0.4604
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3678 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3847 | Val  Acc: 0.4353
 Site-Black                     (1) | Val  Loss: 1.2494 | Val  Acc: 0.5978
 Site-Black                     (6) | Val  Loss: 1.3609 | Val  Acc: 0.5072
 Site-East_Asian                (5) | Val  Loss: 1.2028 | Val  Acc: 0.5652
 Site-East_Asian                (5) | Val  Loss: 1.3202 | Val  Acc: 0.5252
 Site-Indian                    (0) | Val  Loss: 1.4658 | Val  Acc: 0.4022
 Site-Indian                    (0) | Val  Loss: 1.4084 | Val  Acc: 0.4173
 Site-Southeast_Asian           (3) | Val  Loss: 1.3722 | Val  Acc: 0.4457
 Site-Southeast_Asian           (3) | Val  Loss: 1.3481 | Val  Acc: 0.5000
 Site-Middle_Eastern            (4) | Val  Loss: 1.3761 | Val  Acc: 0.4565
 Site-Middle_Eastern            (4) | Val  Loss: 1.4420 | Val  Acc: 0.4460
Average Valid Accuracy: 0.4766
Aggregated Acc | Val Acc: 0.4955
 Test site-White                    | Epoch:40 | Test Acc: 0.4144
 Test site-Latino_Hispanic          | Epoch:40 | Test Acc: 0.3481
 Test site-Black                    | Epoch:40 | Test Acc: 0.3250
 Test site-East_Asian               | Epoch:40 | Test Acc: 0.4935
 Test site-Indian                   | Epoch:40 | Test Acc: 0.3493
 Test site-Southeast_Asian          | Epoch:40 | Test Acc: 0.4259
 Test site-Middle_Eastern           | Epoch:40 | Test Acc: 0.4356
Average Test Accuracy: 0.3988, domain std=0.0558, individual std=0.0558
Average Test Accuracy: 0.3988
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 42 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
min_w=0.05977, quan_i=1.41, quan_c=1.42
minimize weight of clients:[0, 1, 6, 7, 8, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.4270 | Train Acc: 0.4964
 Site-White                    | Train Loss: 1.3803 | Train Acc: 0.4676
 Site-Latino_Hispanic          | Train Loss: 1.5066 | Train Acc: 0.4173
 Site-Latino_Hispanic          | Train Loss: 1.3475 | Train Acc: 0.4628
 Site-Black                    | Train Loss: 1.5824 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.3735 | Train Acc: 0.5036
 Site-East_Asian               | Train Loss: 1.4156 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3868 | Train Acc: 0.4460
 Site-Indian                   | Train Loss: 1.2796 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.3808 | Train Acc: 0.4724
 Site-Southeast_Asian          | Train Loss: 1.4367 | Train Acc: 0.4892
 Site-Southeast_Asian          | Train Loss: 1.3734 | Train Acc: 0.4964
 Site-Middle_Eastern           | Train Loss: 1.3430 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.3597 | Train Acc: 0.4724
 Site-White                     (5) | Val  Loss: 1.4471 | Val  Acc: 0.4891
 Site-White                     (5) | Val  Loss: 1.3516 | Val  Acc: 0.4856
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4006 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3822 | Val  Acc: 0.4460
 Site-Black                     (2) | Val  Loss: 1.2505 | Val  Acc: 0.5652
 Site-Black                     (2) | Val  Loss: 1.4044 | Val  Acc: 0.4964
 Site-East_Asian                (0) | Val  Loss: 1.2457 | Val  Acc: 0.5000
 Site-East_Asian                (0) | Val  Loss: 1.3412 | Val  Acc: 0.4964
 Site-Indian                    (4) | Val  Loss: 1.4090 | Val  Acc: 0.4130
 Site-Indian                    (4) | Val  Loss: 1.3843 | Val  Acc: 0.4748
 Site-Southeast_Asian           (6) | Val  Loss: 1.3910 | Val  Acc: 0.4783
 Site-Southeast_Asian           (6) | Val  Loss: 1.3431 | Val  Acc: 0.5036
 Site-Middle_Eastern            (1) | Val  Loss: 1.3654 | Val  Acc: 0.5000
 Site-Middle_Eastern            (1) | Val  Loss: 1.4294 | Val  Acc: 0.4245
Average Valid Accuracy: 0.4776
Aggregated Acc | Val Acc: 0.4776
 Test site-White                    | Epoch:41 | Test Acc: 0.4171
 Test site-Latino_Hispanic          | Epoch:41 | Test Acc: 0.3386
 Test site-Black                    | Epoch:41 | Test Acc: 0.3281
 Test site-East_Asian               | Epoch:41 | Test Acc: 0.4545
 Test site-Indian                   | Epoch:41 | Test Acc: 0.3517
 Test site-Southeast_Asian          | Epoch:41 | Test Acc: 0.4296
 Test site-Middle_Eastern           | Epoch:41 | Test Acc: 0.4278
Average Test Accuracy: 0.3925, domain std=0.0475, individual std=0.0475
Average Test Accuracy: 0.3925
============ Train epoch 43 ============
cnt=[3, 1, 2, 3, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
min_w=0.06233, quan_i=1.43, quan_c=1.44
minimize weight of clients:[1, 3, 7, 8, 9, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.3582 | Train Acc: 0.4460
 Site-White                    | Train Loss: 1.3720 | Train Acc: 0.4556
 Site-Latino_Hispanic          | Train Loss: 1.5723 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.3642 | Train Acc: 0.4676
 Site-Black                    | Train Loss: 1.4499 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.3788 | Train Acc: 0.5156
 Site-East_Asian               | Train Loss: 1.3570 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.3831 | Train Acc: 0.4700
 Site-Indian                   | Train Loss: 1.2064 | Train Acc: 0.4964
 Site-Indian                   | Train Loss: 1.4015 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3386 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.4096 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.3649 | Train Acc: 0.5108
 Site-Middle_Eastern           | Train Loss: 1.3662 | Train Acc: 0.4628
 Site-White                     (4) | Val  Loss: 1.4561 | Val  Acc: 0.5000
 Site-White                     (0) | Val  Loss: 1.3876 | Val  Acc: 0.4712
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3691 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3548 | Val  Acc: 0.4317
 Site-Black                     (2) | Val  Loss: 1.2229 | Val  Acc: 0.6304
 Site-Black                     (2) | Val  Loss: 1.3388 | Val  Acc: 0.5540
 Site-East_Asian                (3) | Val  Loss: 1.2346 | Val  Acc: 0.5543
 Site-East_Asian                (3) | Val  Loss: 1.3223 | Val  Acc: 0.5216
 Site-Indian                    (6) | Val  Loss: 1.4945 | Val  Acc: 0.4130
 Site-Indian                    (6) | Val  Loss: 1.3837 | Val  Acc: 0.4209
 Site-Southeast_Asian           (1) | Val  Loss: 1.3615 | Val  Acc: 0.4457
 Site-Southeast_Asian           (3) | Val  Loss: 1.3515 | Val  Acc: 0.4892
 Site-Middle_Eastern            (0) | Val  Loss: 1.4509 | Val  Acc: 0.4674
 Site-Middle_Eastern            (0) | Val  Loss: 1.4286 | Val  Acc: 0.4532
Average Valid Accuracy: 0.4856
Aggregated Acc | Val Acc: 0.4778
 Best site-White                    (4)  | Epoch:43 | Val Acc: 0.5000
 Best site-White                    (0)  | Epoch:43 | Val Acc: 0.4712
 Best site-Latino_Hispanic          (4)  | Epoch:43 | Val Acc: 0.4457
 Best site-Latino_Hispanic          (5)  | Epoch:43 | Val Acc: 0.4317
 Best site-Black                    (2)  | Epoch:43 | Val Acc: 0.6304
 Best site-Black                    (2)  | Epoch:43 | Val Acc: 0.5540
 Best site-East_Asian               (3)  | Epoch:43 | Val Acc: 0.5543
 Best site-East_Asian               (3)  | Epoch:43 | Val Acc: 0.5216
 Best site-Indian                   (6)  | Epoch:43 | Val Acc: 0.4130
 Best site-Indian                   (6)  | Epoch:43 | Val Acc: 0.4209
 Best site-Southeast_Asian          (1)  | Epoch:43 | Val Acc: 0.4457
 Best site-Southeast_Asian          (3)  | Epoch:43 | Val Acc: 0.4892
 Best site-Middle_Eastern           (0)  | Epoch:43 | Val Acc: 0.4674
 Best site-Middle_Eastern           (0)  | Epoch:43 | Val Acc: 0.4532
 Test site-White                    | Epoch:43 | Test Acc: 0.4118
 Test site-Latino_Hispanic          | Epoch:43 | Test Acc: 0.3449
 Test site-Black                    | Epoch:43 | Test Acc: 0.3219
 Test site-East_Asian               | Epoch:43 | Test Acc: 0.4740
 Test site-Indian                   | Epoch:43 | Test Acc: 0.3565
 Test site-Southeast_Asian          | Epoch:43 | Test Acc: 0.4222
 Test site-Middle_Eastern           | Epoch:43 | Test Acc: 0.4381
Average Test Accuracy: 0.3956, domain std=0.0514, individual std=0.0514
Average Test Accuracy: 0.3956
============ Train epoch 44 ============
cnt=[2, 2, 3, 2, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
min_w=0.05923, quan_i=1.39, quan_c=1.41
minimize weight of clients:[0, 1, 3, 6, 7, 8, 12, 13, ]
 Site-White                    | Train Loss: 1.4337 | Train Acc: 0.4820
 Site-White                    | Train Loss: 1.3880 | Train Acc: 0.4676
 Site-Latino_Hispanic          | Train Loss: 1.6200 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.3721 | Train Acc: 0.4484
 Site-Black                    | Train Loss: 1.4761 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.3810 | Train Acc: 0.5132
 Site-East_Asian               | Train Loss: 1.3537 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3728 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.4567 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.4263 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3608 | Train Acc: 0.5180
 Site-Southeast_Asian          | Train Loss: 1.3606 | Train Acc: 0.5132
 Site-Middle_Eastern           | Train Loss: 1.3383 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.3588 | Train Acc: 0.4604
 Site-White                     (2) | Val  Loss: 1.4298 | Val  Acc: 0.5109
 Site-White                     (2) | Val  Loss: 1.3711 | Val  Acc: 0.4712
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3708 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3705 | Val  Acc: 0.4281
 Site-Black                     (3) | Val  Loss: 1.2247 | Val  Acc: 0.6087
 Site-Black                     (3) | Val  Loss: 1.3850 | Val  Acc: 0.5288
 Site-East_Asian                (5) | Val  Loss: 1.2346 | Val  Acc: 0.5543
 Site-East_Asian                (5) | Val  Loss: 1.3498 | Val  Acc: 0.4820
 Site-Indian                    (1) | Val  Loss: 1.3809 | Val  Acc: 0.4348
 Site-Indian                    (1) | Val  Loss: 1.3443 | Val  Acc: 0.5108
 Site-Southeast_Asian           (0) | Val  Loss: 1.3222 | Val  Acc: 0.4674
 Site-Southeast_Asian           (0) | Val  Loss: 1.3279 | Val  Acc: 0.5036
 Site-Middle_Eastern            (2) | Val  Loss: 1.3841 | Val  Acc: 0.4348
 Site-Middle_Eastern            (6) | Val  Loss: 1.4215 | Val  Acc: 0.4388
Average Valid Accuracy: 0.4887
Aggregated Acc | Val Acc: 0.4883
 Best site-White                    (2)  | Epoch:44 | Val Acc: 0.5109
 Best site-White                    (2)  | Epoch:44 | Val Acc: 0.4712
 Best site-Latino_Hispanic          (4)  | Epoch:44 | Val Acc: 0.4674
 Best site-Latino_Hispanic          (6)  | Epoch:44 | Val Acc: 0.4281
 Best site-Black                    (3)  | Epoch:44 | Val Acc: 0.6087
 Best site-Black                    (3)  | Epoch:44 | Val Acc: 0.5288
 Best site-East_Asian               (5)  | Epoch:44 | Val Acc: 0.5543
 Best site-East_Asian               (5)  | Epoch:44 | Val Acc: 0.4820
 Best site-Indian                   (1)  | Epoch:44 | Val Acc: 0.4348
 Best site-Indian                   (1)  | Epoch:44 | Val Acc: 0.5108
 Best site-Southeast_Asian          (0)  | Epoch:44 | Val Acc: 0.4674
 Best site-Southeast_Asian          (0)  | Epoch:44 | Val Acc: 0.5036
 Best site-Middle_Eastern           (2)  | Epoch:44 | Val Acc: 0.4348
 Best site-Middle_Eastern           (6)  | Epoch:44 | Val Acc: 0.4388
 Test site-White                    | Epoch:44 | Test Acc: 0.4037
 Test site-Latino_Hispanic          | Epoch:44 | Test Acc: 0.3481
 Test site-Black                    | Epoch:44 | Test Acc: 0.3375
 Test site-East_Asian               | Epoch:44 | Test Acc: 0.5032
 Test site-Indian                   | Epoch:44 | Test Acc: 0.3541
 Test site-Southeast_Asian          | Epoch:44 | Test Acc: 0.4296
 Test site-Middle_Eastern           | Epoch:44 | Test Acc: 0.4278
Average Test Accuracy: 0.4006, domain std=0.0548, individual std=0.0548
Average Test Accuracy: 0.4006
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 45 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
min_w=0.06588, quan_i=1.43, quan_c=1.42
minimize weight of clients:[1, 5, 6, 7, 10, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.3290 | Train Acc: 0.4317
 Site-White                    | Train Loss: 1.3675 | Train Acc: 0.4652
 Site-Latino_Hispanic          | Train Loss: 1.6491 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.3461 | Train Acc: 0.4556
 Site-Black                    | Train Loss: 1.5939 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.4161 | Train Acc: 0.5084
 Site-East_Asian               | Train Loss: 1.5405 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.3810 | Train Acc: 0.4628
 Site-Indian                   | Train Loss: 1.2288 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.3427 | Train Acc: 0.4964
 Site-Southeast_Asian          | Train Loss: 1.3201 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.3904 | Train Acc: 0.4916
 Site-Middle_Eastern           | Train Loss: 1.3629 | Train Acc: 0.5036
 Site-Middle_Eastern           | Train Loss: 1.3474 | Train Acc: 0.4365
 Site-White                     (6) | Val  Loss: 1.4203 | Val  Acc: 0.5217
 Site-White                     (6) | Val  Loss: 1.3844 | Val  Acc: 0.4892
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3276 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3667 | Val  Acc: 0.4460
 Site-Black                     (2) | Val  Loss: 1.2095 | Val  Acc: 0.6087
 Site-Black                     (2) | Val  Loss: 1.3847 | Val  Acc: 0.5216
 Site-East_Asian                (4) | Val  Loss: 1.2210 | Val  Acc: 0.5217
 Site-East_Asian                (4) | Val  Loss: 1.3307 | Val  Acc: 0.4892
 Site-Indian                    (5) | Val  Loss: 1.3931 | Val  Acc: 0.4457
 Site-Indian                    (5) | Val  Loss: 1.3254 | Val  Acc: 0.4928
 Site-Southeast_Asian           (0) | Val  Loss: 1.3494 | Val  Acc: 0.4022
 Site-Southeast_Asian           (0) | Val  Loss: 1.2878 | Val  Acc: 0.5216
 Site-Middle_Eastern            (1) | Val  Loss: 1.3733 | Val  Acc: 0.4891
 Site-Middle_Eastern            (1) | Val  Loss: 1.4341 | Val  Acc: 0.4460
Average Valid Accuracy: 0.4894
Aggregated Acc | Val Acc: 0.4894
 Best site-White                    (6)  | Epoch:45 | Val Acc: 0.5217
 Best site-White                    (6)  | Epoch:45 | Val Acc: 0.4892
 Best site-Latino_Hispanic          (3)  | Epoch:45 | Val Acc: 0.4565
 Best site-Latino_Hispanic          (3)  | Epoch:45 | Val Acc: 0.4460
 Best site-Black                    (2)  | Epoch:45 | Val Acc: 0.6087
 Best site-Black                    (2)  | Epoch:45 | Val Acc: 0.5216
 Best site-East_Asian               (4)  | Epoch:45 | Val Acc: 0.5217
 Best site-East_Asian               (4)  | Epoch:45 | Val Acc: 0.4892
 Best site-Indian                   (5)  | Epoch:45 | Val Acc: 0.4457
 Best site-Indian                   (5)  | Epoch:45 | Val Acc: 0.4928
 Best site-Southeast_Asian          (0)  | Epoch:45 | Val Acc: 0.4022
 Best site-Southeast_Asian          (0)  | Epoch:45 | Val Acc: 0.5216
 Best site-Middle_Eastern           (1)  | Epoch:45 | Val Acc: 0.4891
 Best site-Middle_Eastern           (1)  | Epoch:45 | Val Acc: 0.4460
 Test site-White                    | Epoch:45 | Test Acc: 0.4171
 Test site-Latino_Hispanic          | Epoch:45 | Test Acc: 0.3608
 Test site-Black                    | Epoch:45 | Test Acc: 0.3156
 Test site-East_Asian               | Epoch:45 | Test Acc: 0.4578
 Test site-Indian                   | Epoch:45 | Test Acc: 0.3397
 Test site-Southeast_Asian          | Epoch:45 | Test Acc: 0.4222
 Test site-Middle_Eastern           | Epoch:45 | Test Acc: 0.4124
Average Test Accuracy: 0.3894, domain std=0.0475, individual std=0.0475
Average Test Accuracy: 0.3894
============ Train epoch 46 ============
cnt=[1, 2, 1, 3, 2, 2, 3, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
min_w=0.05443, quan_i=1.41, quan_c=1.42
minimize weight of clients:[0, 1, 3, 8, 9, 10, 12, 13, ]
 Site-White                    | Train Loss: 1.3348 | Train Acc: 0.4532
 Site-White                    | Train Loss: 1.3812 | Train Acc: 0.4676
 Site-Latino_Hispanic          | Train Loss: 1.6277 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.3844 | Train Acc: 0.4221
 Site-Black                    | Train Loss: 1.5512 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.3964 | Train Acc: 0.5132
 Site-East_Asian               | Train Loss: 1.3897 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.3371 | Train Acc: 0.5132
 Site-Indian                   | Train Loss: 1.3548 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.3467 | Train Acc: 0.4412
 Site-Southeast_Asian          | Train Loss: 1.2267 | Train Acc: 0.5036
 Site-Southeast_Asian          | Train Loss: 1.3471 | Train Acc: 0.5324
 Site-Middle_Eastern           | Train Loss: 1.4955 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.3612 | Train Acc: 0.4772
 Site-White                     (1) | Val  Loss: 1.4347 | Val  Acc: 0.4457
 Site-White                     (1) | Val  Loss: 1.3716 | Val  Acc: 0.4496
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3859 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3436 | Val  Acc: 0.4532
 Site-Black                     (5) | Val  Loss: 1.1705 | Val  Acc: 0.6087
 Site-Black                     (5) | Val  Loss: 1.3894 | Val  Acc: 0.5036
 Site-East_Asian                (3) | Val  Loss: 1.1684 | Val  Acc: 0.5870
 Site-East_Asian                (3) | Val  Loss: 1.2951 | Val  Acc: 0.5216
 Site-Indian                    (0) | Val  Loss: 1.4244 | Val  Acc: 0.4130
 Site-Indian                    (2) | Val  Loss: 1.3527 | Val  Acc: 0.4281
 Site-Southeast_Asian           (6) | Val  Loss: 1.3470 | Val  Acc: 0.5217
 Site-Southeast_Asian           (3) | Val  Loss: 1.2703 | Val  Acc: 0.5108
 Site-Middle_Eastern            (4) | Val  Loss: 1.3944 | Val  Acc: 0.4348
 Site-Middle_Eastern            (4) | Val  Loss: 1.4266 | Val  Acc: 0.4353
Average Valid Accuracy: 0.4804
Aggregated Acc | Val Acc: 0.4689
 Test site-White                    | Epoch:45 | Test Acc: 0.4118
 Test site-Latino_Hispanic          | Epoch:45 | Test Acc: 0.3418
 Test site-Black                    | Epoch:45 | Test Acc: 0.3219
 Test site-East_Asian               | Epoch:45 | Test Acc: 0.4968
 Test site-Indian                   | Epoch:45 | Test Acc: 0.3421
 Test site-Southeast_Asian          | Epoch:45 | Test Acc: 0.4259
 Test site-Middle_Eastern           | Epoch:45 | Test Acc: 0.4304
Average Test Accuracy: 0.3958, domain std=0.0583, individual std=0.0583
Average Test Accuracy: 0.3958
============ Train epoch 47 ============
cnt=[1, 3, 2, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
min_w=0.05443, quan_i=1.41, quan_c=1.40
minimize weight of clients:[0, 1, 7, 8, 9, 10, 11, 13, ]
 Site-White                    | Train Loss: 1.4183 | Train Acc: 0.4604
 Site-White                    | Train Loss: 1.3737 | Train Acc: 0.4796
 Site-Latino_Hispanic          | Train Loss: 1.5126 | Train Acc: 0.4173
 Site-Latino_Hispanic          | Train Loss: 1.3653 | Train Acc: 0.4652
 Site-Black                    | Train Loss: 1.5047 | Train Acc: 0.4460
 Site-Black                    | Train Loss: 1.3234 | Train Acc: 0.5348
 Site-East_Asian               | Train Loss: 1.3956 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.4008 | Train Acc: 0.4580
 Site-Indian                   | Train Loss: 1.2605 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.3958 | Train Acc: 0.4317
 Site-Southeast_Asian          | Train Loss: 1.4814 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.3937 | Train Acc: 0.5012
 Site-Middle_Eastern           | Train Loss: 1.4259 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.3316 | Train Acc: 0.4508
 Site-White                     (6) | Val  Loss: 1.4398 | Val  Acc: 0.4783
 Site-White                     (1) | Val  Loss: 1.3997 | Val  Acc: 0.4640
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3745 | Val  Acc: 0.4783
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3406 | Val  Acc: 0.4604
 Site-Black                     (2) | Val  Loss: 1.1736 | Val  Acc: 0.6087
 Site-Black                     (2) | Val  Loss: 1.3012 | Val  Acc: 0.5504
 Site-East_Asian                (5) | Val  Loss: 1.2967 | Val  Acc: 0.5217
 Site-East_Asian                (5) | Val  Loss: 1.3466 | Val  Acc: 0.4928
 Site-Indian                    (3) | Val  Loss: 1.4577 | Val  Acc: 0.3696
 Site-Indian                    (3) | Val  Loss: 1.3812 | Val  Acc: 0.4604
 Site-Southeast_Asian           (0) | Val  Loss: 1.3275 | Val  Acc: 0.5000
 Site-Southeast_Asian           (5) | Val  Loss: 1.3570 | Val  Acc: 0.5108
 Site-Middle_Eastern            (1) | Val  Loss: 1.3834 | Val  Acc: 0.4565
 Site-Middle_Eastern            (1) | Val  Loss: 1.4162 | Val  Acc: 0.4245
Average Valid Accuracy: 0.4840
Aggregated Acc | Val Acc: 0.4856
 Test site-White                    | Epoch:45 | Test Acc: 0.4037
 Test site-Latino_Hispanic          | Epoch:45 | Test Acc: 0.3576
 Test site-Black                    | Epoch:45 | Test Acc: 0.3500
 Test site-East_Asian               | Epoch:45 | Test Acc: 0.4773
 Test site-Indian                   | Epoch:45 | Test Acc: 0.3397
 Test site-Southeast_Asian          | Epoch:45 | Test Acc: 0.4259
 Test site-Middle_Eastern           | Epoch:45 | Test Acc: 0.4330
Average Test Accuracy: 0.3982, domain std=0.0473, individual std=0.0473
Average Test Accuracy: 0.3982
============ Train epoch 48 ============
cnt=[3, 1, 2, 2, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
min_w=0.06331, quan_i=1.43, quan_c=1.40
minimize weight of clients:[1, 5, 8, 9, 13, ]
 Site-White                    | Train Loss: 1.3765 | Train Acc: 0.4676
 Site-White                    | Train Loss: 1.3907 | Train Acc: 0.4772
 Site-Latino_Hispanic          | Train Loss: 1.7308 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.3546 | Train Acc: 0.4796
 Site-Black                    | Train Loss: 1.6155 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.3812 | Train Acc: 0.5156
 Site-East_Asian               | Train Loss: 1.3341 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3284 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.3081 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.3940 | Train Acc: 0.4436
 Site-Southeast_Asian          | Train Loss: 1.4395 | Train Acc: 0.4964
 Site-Southeast_Asian          | Train Loss: 1.3525 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.3259 | Train Acc: 0.4964
 Site-Middle_Eastern           | Train Loss: 1.3414 | Train Acc: 0.4628
 Site-White                     (1) | Val  Loss: 1.4264 | Val  Acc: 0.5000
 Site-White                     (5) | Val  Loss: 1.3344 | Val  Acc: 0.4784
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3372 | Val  Acc: 0.5000
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3627 | Val  Acc: 0.4496
 Site-Black                     (4) | Val  Loss: 1.2065 | Val  Acc: 0.5870
 Site-Black                     (4) | Val  Loss: 1.3907 | Val  Acc: 0.5288
 Site-East_Asian                (2) | Val  Loss: 1.1958 | Val  Acc: 0.5870
 Site-East_Asian                (2) | Val  Loss: 1.3006 | Val  Acc: 0.5144
 Site-Indian                    (0) | Val  Loss: 1.4094 | Val  Acc: 0.3804
 Site-Indian                    (0) | Val  Loss: 1.3822 | Val  Acc: 0.4532
 Site-Southeast_Asian           (6) | Val  Loss: 1.2776 | Val  Acc: 0.5326
 Site-Southeast_Asian           (6) | Val  Loss: 1.3124 | Val  Acc: 0.5252
 Site-Middle_Eastern            (3) | Val  Loss: 1.3548 | Val  Acc: 0.4783
 Site-Middle_Eastern            (3) | Val  Loss: 1.4014 | Val  Acc: 0.4245
Average Valid Accuracy: 0.4957
Aggregated Acc | Val Acc: 0.4979
 Best site-White                    (1)  | Epoch:48 | Val Acc: 0.5000
 Best site-White                    (5)  | Epoch:48 | Val Acc: 0.4784
 Best site-Latino_Hispanic          (0)  | Epoch:48 | Val Acc: 0.5000
 Best site-Latino_Hispanic          (6)  | Epoch:48 | Val Acc: 0.4496
 Best site-Black                    (4)  | Epoch:48 | Val Acc: 0.5870
 Best site-Black                    (4)  | Epoch:48 | Val Acc: 0.5288
 Best site-East_Asian               (2)  | Epoch:48 | Val Acc: 0.5870
 Best site-East_Asian               (2)  | Epoch:48 | Val Acc: 0.5144
 Best site-Indian                   (0)  | Epoch:48 | Val Acc: 0.3804
 Best site-Indian                   (0)  | Epoch:48 | Val Acc: 0.4532
 Best site-Southeast_Asian          (6)  | Epoch:48 | Val Acc: 0.5326
 Best site-Southeast_Asian          (6)  | Epoch:48 | Val Acc: 0.5252
 Best site-Middle_Eastern           (3)  | Epoch:48 | Val Acc: 0.4783
 Best site-Middle_Eastern           (3)  | Epoch:48 | Val Acc: 0.4245
 Test site-White                    | Epoch:48 | Test Acc: 0.3957
 Test site-Latino_Hispanic          | Epoch:48 | Test Acc: 0.3291
 Test site-Black                    | Epoch:48 | Test Acc: 0.3312
 Test site-East_Asian               | Epoch:48 | Test Acc: 0.4968
 Test site-Indian                   | Epoch:48 | Test Acc: 0.3565
 Test site-Southeast_Asian          | Epoch:48 | Test Acc: 0.4259
 Test site-Middle_Eastern           | Epoch:48 | Test Acc: 0.4433
Average Test Accuracy: 0.3969, domain std=0.0580, individual std=0.0580
Average Test Accuracy: 0.3969
============ Train epoch 49 ============
cnt=[2, 2, 2, 2, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
min_w=0.06457, quan_i=1.41, quan_c=1.40
minimize weight of clients:[0, 6, 7, 8, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.2548 | Train Acc: 0.4820
 Site-White                    | Train Loss: 1.3291 | Train Acc: 0.4676
 Site-Latino_Hispanic          | Train Loss: 1.5777 | Train Acc: 0.4532
 Site-Latino_Hispanic          | Train Loss: 1.3510 | Train Acc: 0.4341
 Site-Black                    | Train Loss: 1.5118 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.3937 | Train Acc: 0.5228
 Site-East_Asian               | Train Loss: 1.3020 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3064 | Train Acc: 0.5036
 Site-Indian                   | Train Loss: 1.1882 | Train Acc: 0.5108
 Site-Indian                   | Train Loss: 1.3705 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.4592 | Train Acc: 0.5108
 Site-Southeast_Asian          | Train Loss: 1.3802 | Train Acc: 0.5108
 Site-Middle_Eastern           | Train Loss: 1.3565 | Train Acc: 0.4964
 Site-Middle_Eastern           | Train Loss: 1.3135 | Train Acc: 0.4868
 Site-White                     (5) | Val  Loss: 1.3663 | Val  Acc: 0.4783
 Site-White                     (4) | Val  Loss: 1.3495 | Val  Acc: 0.4784
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3255 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3359 | Val  Acc: 0.4748
 Site-Black                     (3) | Val  Loss: 1.1775 | Val  Acc: 0.6739
 Site-Black                     (3) | Val  Loss: 1.3434 | Val  Acc: 0.5108
 Site-East_Asian                (1) | Val  Loss: 1.2024 | Val  Acc: 0.5870
 Site-East_Asian                (1) | Val  Loss: 1.3319 | Val  Acc: 0.4892
 Site-Indian                    (2) | Val  Loss: 1.3812 | Val  Acc: 0.3478
 Site-Indian                    (2) | Val  Loss: 1.3882 | Val  Acc: 0.4568
 Site-Southeast_Asian           (6) | Val  Loss: 1.3627 | Val  Acc: 0.4348
 Site-Southeast_Asian           (6) | Val  Loss: 1.3316 | Val  Acc: 0.5000
 Site-Middle_Eastern            (4) | Val  Loss: 1.3516 | Val  Acc: 0.4348
 Site-Middle_Eastern            (4) | Val  Loss: 1.3934 | Val  Acc: 0.4712
Average Valid Accuracy: 0.4814
Aggregated Acc | Val Acc: 0.4826
 Test site-White                    | Epoch:48 | Test Acc: 0.4171
 Test site-Latino_Hispanic          | Epoch:48 | Test Acc: 0.3449
 Test site-Black                    | Epoch:48 | Test Acc: 0.3250
 Test site-East_Asian               | Epoch:48 | Test Acc: 0.4740
 Test site-Indian                   | Epoch:48 | Test Acc: 0.3493
 Test site-Southeast_Asian          | Epoch:48 | Test Acc: 0.4370
 Test site-Middle_Eastern           | Epoch:48 | Test Acc: 0.4330
Average Test Accuracy: 0.3972, domain std=0.0527, individual std=0.0527
Average Test Accuracy: 0.3972
===2023-05-30 14:31:01===
===2023-05-30 14:31:19===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0.7
    std_rw: False
data_number=[139,417,139,417,139,417,139,417,139,417,139,417,139,417,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1856,1856,1856,1856,1856,1856,1856,]
label set of clients: [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 7
Loading snapshots...
 Test site-White                    | Epoch:44 | Test Acc: 0.4037
 Test site-Latino_Hispanic          | Epoch:44 | Test Acc: 0.3481
 Test site-Black                    | Epoch:44 | Test Acc: 0.3375
 Test site-East_Asian               | Epoch:44 | Test Acc: 0.5032
 Test site-Indian                   | Epoch:44 | Test Acc: 0.3541
 Test site-Southeast_Asian          | Epoch:44 | Test Acc: 0.4296
 Test site-Middle_Eastern           | Epoch:44 | Test Acc: 0.4278
Average Test Accuracy: 0.4006, domain std=0.0548, individual std=0.0548
===2023-05-30 14:32:19===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0.8
    std_rw: False
data_number=[139,417,139,417,139,417,139,417,139,417,139,417,139,417,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1856,1856,1856,1856,1856,1856,1856,]
label set of clients: [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
min_w=0.03571, quan_i=1.00, quan_c=1.00
minimize weight of clients:[]
 Site-White                    | Train Loss: 2.0347 | Train Acc: 0.3669
 Site-White                    | Train Loss: 1.8113 | Train Acc: 0.3573
 Site-Latino_Hispanic          | Train Loss: 1.9740 | Train Acc: 0.2878
 Site-Latino_Hispanic          | Train Loss: 2.0301 | Train Acc: 0.2686
 Site-Black                    | Train Loss: 2.1977 | Train Acc: 0.2302
 Site-Black                    | Train Loss: 2.0367 | Train Acc: 0.2494
 Site-East_Asian               | Train Loss: 1.8523 | Train Acc: 0.3741
 Site-East_Asian               | Train Loss: 1.8194 | Train Acc: 0.3789
 Site-Indian                   | Train Loss: 1.9473 | Train Acc: 0.2446
 Site-Indian                   | Train Loss: 2.1591 | Train Acc: 0.2422
 Site-Southeast_Asian          | Train Loss: 2.0254 | Train Acc: 0.3094
 Site-Southeast_Asian          | Train Loss: 2.1201 | Train Acc: 0.2974
 Site-Middle_Eastern           | Train Loss: 1.9939 | Train Acc: 0.2734
 Site-Middle_Eastern           | Train Loss: 2.0398 | Train Acc: 0.2494
 Site-White                     (1) | Val  Loss: 1.9652 | Val  Acc: 0.3152
 Site-White                     (1) | Val  Loss: 1.8583 | Val  Acc: 0.3417
 Site-Latino_Hispanic           (4) | Val  Loss: 2.0372 | Val  Acc: 0.2826
 Site-Latino_Hispanic           (4) | Val  Loss: 1.9914 | Val  Acc: 0.2734
 Site-Black                     (0) | Val  Loss: 1.9975 | Val  Acc: 0.2500
 Site-Black                     (0) | Val  Loss: 1.9915 | Val  Acc: 0.2482
 Site-East_Asian                (2) | Val  Loss: 1.7620 | Val  Acc: 0.4130
 Site-East_Asian                (2) | Val  Loss: 1.8558 | Val  Acc: 0.3741
 Site-Indian                    (5) | Val  Loss: 2.1217 | Val  Acc: 0.2500
 Site-Indian                    (5) | Val  Loss: 2.1364 | Val  Acc: 0.2374
 Site-Southeast_Asian           (3) | Val  Loss: 2.0764 | Val  Acc: 0.2935
 Site-Southeast_Asian           (3) | Val  Loss: 2.0866 | Val  Acc: 0.3022
 Site-Middle_Eastern            (6) | Val  Loss: 1.9516 | Val  Acc: 0.2717
 Site-Middle_Eastern            (6) | Val  Loss: 2.0418 | Val  Acc: 0.2554
Average Valid Accuracy: 0.2935
Aggregated Acc | Val Acc: 0.2935
 Best site-White                    (1)  | Epoch:0 | Val Acc: 0.3152
 Best site-White                    (1)  | Epoch:0 | Val Acc: 0.3417
 Best site-Latino_Hispanic          (4)  | Epoch:0 | Val Acc: 0.2826
 Best site-Latino_Hispanic          (4)  | Epoch:0 | Val Acc: 0.2734
 Best site-Black                    (0)  | Epoch:0 | Val Acc: 0.2500
 Best site-Black                    (0)  | Epoch:0 | Val Acc: 0.2482
 Best site-East_Asian               (2)  | Epoch:0 | Val Acc: 0.4130
 Best site-East_Asian               (2)  | Epoch:0 | Val Acc: 0.3741
 Best site-Indian                   (5)  | Epoch:0 | Val Acc: 0.2500
 Best site-Indian                   (5)  | Epoch:0 | Val Acc: 0.2374
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.2935
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.3022
 Best site-Middle_Eastern           (6)  | Epoch:0 | Val Acc: 0.2717
 Best site-Middle_Eastern           (6)  | Epoch:0 | Val Acc: 0.2554
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 2, 2, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
min_w=0.12779, quan_i=2.08, quan_c=2.11
minimize weight of clients:[0, 1, 2, 3, 5, 6, 7, 12, 13, ]
 Site-White                    | Train Loss: 1.7337 | Train Acc: 0.3813
 Site-White                    | Train Loss: 1.8087 | Train Acc: 0.3405
 Site-Latino_Hispanic          | Train Loss: 1.9497 | Train Acc: 0.2878
 Site-Latino_Hispanic          | Train Loss: 1.9144 | Train Acc: 0.2782
 Site-Black                    | Train Loss: 1.9904 | Train Acc: 0.1871
 Site-Black                    | Train Loss: 1.9185 | Train Acc: 0.2686
 Site-East_Asian               | Train Loss: 1.7624 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.7796 | Train Acc: 0.3741
 Site-Indian                   | Train Loss: 1.9041 | Train Acc: 0.2734
 Site-Indian                   | Train Loss: 2.0319 | Train Acc: 0.2398
 Site-Southeast_Asian          | Train Loss: 2.0463 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 1.9921 | Train Acc: 0.2974
 Site-Middle_Eastern           | Train Loss: 1.9138 | Train Acc: 0.2662
 Site-Middle_Eastern           | Train Loss: 1.9339 | Train Acc: 0.2806
 Site-White                     (0) | Val  Loss: 1.9038 | Val  Acc: 0.2826
 Site-White                     (6) | Val  Loss: 1.8158 | Val  Acc: 0.3381
 Site-Latino_Hispanic           (0) | Val  Loss: 1.9705 | Val  Acc: 0.3261
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8949 | Val  Acc: 0.2734
 Site-Black                     (4) | Val  Loss: 1.8850 | Val  Acc: 0.2717
 Site-Black                     (4) | Val  Loss: 1.9108 | Val  Acc: 0.2950
 Site-East_Asian                (5) | Val  Loss: 1.7202 | Val  Acc: 0.4022
 Site-East_Asian                (5) | Val  Loss: 1.7974 | Val  Acc: 0.3669
 Site-Indian                    (3) | Val  Loss: 2.0062 | Val  Acc: 0.2500
 Site-Indian                    (3) | Val  Loss: 2.0250 | Val  Acc: 0.2338
 Site-Southeast_Asian           (1) | Val  Loss: 1.9788 | Val  Acc: 0.3043
 Site-Southeast_Asian           (1) | Val  Loss: 1.9764 | Val  Acc: 0.2950
 Site-Middle_Eastern            (2) | Val  Loss: 1.8558 | Val  Acc: 0.2717
 Site-Middle_Eastern            (2) | Val  Loss: 1.9100 | Val  Acc: 0.2734
Average Valid Accuracy: 0.2989
Aggregated Acc | Val Acc: 0.2982
 Best site-White                    (0)  | Epoch:1 | Val Acc: 0.2826
 Best site-White                    (6)  | Epoch:1 | Val Acc: 0.3381
 Best site-Latino_Hispanic          (0)  | Epoch:1 | Val Acc: 0.3261
 Best site-Latino_Hispanic          (5)  | Epoch:1 | Val Acc: 0.2734
 Best site-Black                    (4)  | Epoch:1 | Val Acc: 0.2717
 Best site-Black                    (4)  | Epoch:1 | Val Acc: 0.2950
 Best site-East_Asian               (5)  | Epoch:1 | Val Acc: 0.4022
 Best site-East_Asian               (5)  | Epoch:1 | Val Acc: 0.3669
 Best site-Indian                   (3)  | Epoch:1 | Val Acc: 0.2500
 Best site-Indian                   (3)  | Epoch:1 | Val Acc: 0.2338
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.3043
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2950
 Best site-Middle_Eastern           (2)  | Epoch:1 | Val Acc: 0.2717
 Best site-Middle_Eastern           (2)  | Epoch:1 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 3, 3, 2, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
min_w=0.10992, quan_i=2.00, quan_c=1.97
minimize weight of clients:[0, 1, 2, 5, 6, 7, 12, 13, ]
 Site-White                    | Train Loss: 1.8201 | Train Acc: 0.3669
 Site-White                    | Train Loss: 1.7798 | Train Acc: 0.3621
 Site-Latino_Hispanic          | Train Loss: 1.8923 | Train Acc: 0.3022
 Site-Latino_Hispanic          | Train Loss: 1.8955 | Train Acc: 0.2710
 Site-Black                    | Train Loss: 2.0639 | Train Acc: 0.2230
 Site-Black                    | Train Loss: 1.8996 | Train Acc: 0.2542
 Site-East_Asian               | Train Loss: 1.7581 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.7332 | Train Acc: 0.3885
 Site-Indian                   | Train Loss: 1.9301 | Train Acc: 0.2590
 Site-Indian                   | Train Loss: 1.9637 | Train Acc: 0.2422
 Site-Southeast_Asian          | Train Loss: 1.8920 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.9456 | Train Acc: 0.3046
 Site-Middle_Eastern           | Train Loss: 1.9277 | Train Acc: 0.2806
 Site-Middle_Eastern           | Train Loss: 1.8887 | Train Acc: 0.2686
 Site-White                     (0) | Val  Loss: 1.8594 | Val  Acc: 0.2935
 Site-White                     (1) | Val  Loss: 1.8036 | Val  Acc: 0.3381
 Site-Latino_Hispanic           (4) | Val  Loss: 1.9134 | Val  Acc: 0.3043
 Site-Latino_Hispanic           (2) | Val  Loss: 1.8732 | Val  Acc: 0.2842
 Site-Black                     (6) | Val  Loss: 1.8397 | Val  Acc: 0.2826
 Site-Black                     (6) | Val  Loss: 1.8755 | Val  Acc: 0.2626
 Site-East_Asian                (5) | Val  Loss: 1.6676 | Val  Acc: 0.4239
 Site-East_Asian                (5) | Val  Loss: 1.7581 | Val  Acc: 0.3741
 Site-Indian                    (2) | Val  Loss: 1.9890 | Val  Acc: 0.2283
 Site-Indian                    (2) | Val  Loss: 1.9677 | Val  Acc: 0.2446
 Site-Southeast_Asian           (3) | Val  Loss: 1.8998 | Val  Acc: 0.3261
 Site-Southeast_Asian           (3) | Val  Loss: 1.8975 | Val  Acc: 0.3201
 Site-Middle_Eastern            (1) | Val  Loss: 1.8326 | Val  Acc: 0.2717
 Site-Middle_Eastern            (1) | Val  Loss: 1.9073 | Val  Acc: 0.2698
Average Valid Accuracy: 0.3017
Aggregated Acc | Val Acc: 0.3054
 Best site-White                    (0)  | Epoch:2 | Val Acc: 0.2935
 Best site-White                    (1)  | Epoch:2 | Val Acc: 0.3381
 Best site-Latino_Hispanic          (4)  | Epoch:2 | Val Acc: 0.3043
 Best site-Latino_Hispanic          (2)  | Epoch:2 | Val Acc: 0.2842
 Best site-Black                    (6)  | Epoch:2 | Val Acc: 0.2826
 Best site-Black                    (6)  | Epoch:2 | Val Acc: 0.2626
 Best site-East_Asian               (5)  | Epoch:2 | Val Acc: 0.4239
 Best site-East_Asian               (5)  | Epoch:2 | Val Acc: 0.3741
 Best site-Indian                   (2)  | Epoch:2 | Val Acc: 0.2283
 Best site-Indian                   (2)  | Epoch:2 | Val Acc: 0.2446
 Best site-Southeast_Asian          (3)  | Epoch:2 | Val Acc: 0.3261
 Best site-Southeast_Asian          (3)  | Epoch:2 | Val Acc: 0.3201
 Best site-Middle_Eastern           (1)  | Epoch:2 | Val Acc: 0.2717
 Best site-Middle_Eastern           (1)  | Epoch:2 | Val Acc: 0.2698
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 3 ============
cnt=[3, 3, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
min_w=0.11337, quan_i=1.96, quan_c=1.97
minimize weight of clients:[0, 1, 3, 5, 6, 7, 10, 13, ]
 Site-White                    | Train Loss: 1.7864 | Train Acc: 0.3381
 Site-White                    | Train Loss: 1.7558 | Train Acc: 0.3693
 Site-Latino_Hispanic          | Train Loss: 1.8081 | Train Acc: 0.2590
 Site-Latino_Hispanic          | Train Loss: 1.8595 | Train Acc: 0.2782
 Site-Black                    | Train Loss: 2.0254 | Train Acc: 0.2302
 Site-Black                    | Train Loss: 1.8895 | Train Acc: 0.2710
 Site-East_Asian               | Train Loss: 1.7581 | Train Acc: 0.3885
 Site-East_Asian               | Train Loss: 1.7097 | Train Acc: 0.4077
 Site-Indian                   | Train Loss: 1.8588 | Train Acc: 0.2878
 Site-Indian                   | Train Loss: 1.9280 | Train Acc: 0.2542
 Site-Southeast_Asian          | Train Loss: 1.9063 | Train Acc: 0.3525
 Site-Southeast_Asian          | Train Loss: 1.8756 | Train Acc: 0.3213
 Site-Middle_Eastern           | Train Loss: 1.8313 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.8684 | Train Acc: 0.2974
 Site-White                     (4) | Val  Loss: 1.8535 | Val  Acc: 0.2717
 Site-White                     (1) | Val  Loss: 1.7778 | Val  Acc: 0.3525
 Site-Latino_Hispanic           (0) | Val  Loss: 1.8891 | Val  Acc: 0.3152
 Site-Latino_Hispanic           (6) | Val  Loss: 1.8445 | Val  Acc: 0.2914
 Site-Black                     (2) | Val  Loss: 1.7980 | Val  Acc: 0.3261
 Site-Black                     (2) | Val  Loss: 1.8569 | Val  Acc: 0.2590
 Site-East_Asian                (3) | Val  Loss: 1.6725 | Val  Acc: 0.4348
 Site-East_Asian                (3) | Val  Loss: 1.7402 | Val  Acc: 0.3597
 Site-Indian                    (0) | Val  Loss: 1.9518 | Val  Acc: 0.2065
 Site-Indian                    (0) | Val  Loss: 1.9226 | Val  Acc: 0.2554
 Site-Southeast_Asian           (5) | Val  Loss: 1.8673 | Val  Acc: 0.3043
 Site-Southeast_Asian           (5) | Val  Loss: 1.8650 | Val  Acc: 0.3201
 Site-Middle_Eastern            (1) | Val  Loss: 1.7896 | Val  Acc: 0.3913
 Site-Middle_Eastern            (1) | Val  Loss: 1.8705 | Val  Acc: 0.2698
Average Valid Accuracy: 0.3113
Aggregated Acc | Val Acc: 0.3089
 Best site-White                    (4)  | Epoch:3 | Val Acc: 0.2717
 Best site-White                    (1)  | Epoch:3 | Val Acc: 0.3525
 Best site-Latino_Hispanic          (0)  | Epoch:3 | Val Acc: 0.3152
 Best site-Latino_Hispanic          (6)  | Epoch:3 | Val Acc: 0.2914
 Best site-Black                    (2)  | Epoch:3 | Val Acc: 0.3261
 Best site-Black                    (2)  | Epoch:3 | Val Acc: 0.2590
 Best site-East_Asian               (3)  | Epoch:3 | Val Acc: 0.4348
 Best site-East_Asian               (3)  | Epoch:3 | Val Acc: 0.3597
 Best site-Indian                   (0)  | Epoch:3 | Val Acc: 0.2065
 Best site-Indian                   (0)  | Epoch:3 | Val Acc: 0.2554
 Best site-Southeast_Asian          (5)  | Epoch:3 | Val Acc: 0.3043
 Best site-Southeast_Asian          (5)  | Epoch:3 | Val Acc: 0.3201
 Best site-Middle_Eastern           (1)  | Epoch:3 | Val Acc: 0.3913
 Best site-Middle_Eastern           (1)  | Epoch:3 | Val Acc: 0.2698
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 2, 3, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
min_w=0.11267, quan_i=1.92, quan_c=1.94
minimize weight of clients:[0, 1, 2, 3, 6, 7, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.6329 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.7244 | Train Acc: 0.3885
 Site-Latino_Hispanic          | Train Loss: 1.8255 | Train Acc: 0.2878
 Site-Latino_Hispanic          | Train Loss: 1.8410 | Train Acc: 0.2974
 Site-Black                    | Train Loss: 1.9324 | Train Acc: 0.2230
 Site-Black                    | Train Loss: 1.8459 | Train Acc: 0.2830
 Site-East_Asian               | Train Loss: 1.6719 | Train Acc: 0.4101
 Site-East_Asian               | Train Loss: 1.6960 | Train Acc: 0.3861
 Site-Indian                   | Train Loss: 1.6984 | Train Acc: 0.3237
 Site-Indian                   | Train Loss: 1.9121 | Train Acc: 0.2638
 Site-Southeast_Asian          | Train Loss: 1.8264 | Train Acc: 0.3094
 Site-Southeast_Asian          | Train Loss: 1.8477 | Train Acc: 0.3429
 Site-Middle_Eastern           | Train Loss: 1.8538 | Train Acc: 0.2806
 Site-Middle_Eastern           | Train Loss: 1.8215 | Train Acc: 0.3118
 Site-White                     (6) | Val  Loss: 1.8039 | Val  Acc: 0.2935
 Site-White                     (6) | Val  Loss: 1.7606 | Val  Acc: 0.3489
 Site-Latino_Hispanic           (4) | Val  Loss: 1.8791 | Val  Acc: 0.3043
 Site-Latino_Hispanic           (3) | Val  Loss: 1.8016 | Val  Acc: 0.3058
 Site-Black                     (1) | Val  Loss: 1.7557 | Val  Acc: 0.3696
 Site-Black                     (1) | Val  Loss: 1.8202 | Val  Acc: 0.2734
 Site-East_Asian                (0) | Val  Loss: 1.6244 | Val  Acc: 0.4022
 Site-East_Asian                (0) | Val  Loss: 1.7037 | Val  Acc: 0.4209
 Site-Indian                    (5) | Val  Loss: 1.8979 | Val  Acc: 0.2826
 Site-Indian                    (5) | Val  Loss: 1.8851 | Val  Acc: 0.2698
 Site-Southeast_Asian           (3) | Val  Loss: 1.8140 | Val  Acc: 0.3478
 Site-Southeast_Asian           (3) | Val  Loss: 1.8250 | Val  Acc: 0.3597
 Site-Middle_Eastern            (2) | Val  Loss: 1.7558 | Val  Acc: 0.3587
 Site-Middle_Eastern            (2) | Val  Loss: 1.8274 | Val  Acc: 0.2950
Average Valid Accuracy: 0.3309
Aggregated Acc | Val Acc: 0.3285
 Best site-White                    (6)  | Epoch:4 | Val Acc: 0.2935
 Best site-White                    (6)  | Epoch:4 | Val Acc: 0.3489
 Best site-Latino_Hispanic          (4)  | Epoch:4 | Val Acc: 0.3043
 Best site-Latino_Hispanic          (3)  | Epoch:4 | Val Acc: 0.3058
 Best site-Black                    (1)  | Epoch:4 | Val Acc: 0.3696
 Best site-Black                    (1)  | Epoch:4 | Val Acc: 0.2734
 Best site-East_Asian               (0)  | Epoch:4 | Val Acc: 0.4022
 Best site-East_Asian               (0)  | Epoch:4 | Val Acc: 0.4209
 Best site-Indian                   (5)  | Epoch:4 | Val Acc: 0.2826
 Best site-Indian                   (5)  | Epoch:4 | Val Acc: 0.2698
 Best site-Southeast_Asian          (3)  | Epoch:4 | Val Acc: 0.3478
 Best site-Southeast_Asian          (3)  | Epoch:4 | Val Acc: 0.3597
 Best site-Middle_Eastern           (2)  | Epoch:4 | Val Acc: 0.3587
 Best site-Middle_Eastern           (2)  | Epoch:4 | Val Acc: 0.2950
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
min_w=0.09832, quan_i=1.87, quan_c=1.87
minimize weight of clients:[0, 1, 2, 3, 6, 7, 10, 11, 13, ]
 Site-White                    | Train Loss: 1.7626 | Train Acc: 0.3597
 Site-White                    | Train Loss: 1.7045 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.7667 | Train Acc: 0.2950
 Site-Latino_Hispanic          | Train Loss: 1.8168 | Train Acc: 0.3070
 Site-Black                    | Train Loss: 1.8804 | Train Acc: 0.2446
 Site-Black                    | Train Loss: 1.8209 | Train Acc: 0.2854
 Site-East_Asian               | Train Loss: 1.6038 | Train Acc: 0.4101
 Site-East_Asian               | Train Loss: 1.6571 | Train Acc: 0.4269
 Site-Indian                   | Train Loss: 1.7537 | Train Acc: 0.3094
 Site-Indian                   | Train Loss: 1.8759 | Train Acc: 0.2686
 Site-Southeast_Asian          | Train Loss: 1.7913 | Train Acc: 0.3453
 Site-Southeast_Asian          | Train Loss: 1.8416 | Train Acc: 0.3405
 Site-Middle_Eastern           | Train Loss: 1.7584 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.7909 | Train Acc: 0.3237
 Site-White                     (0) | Val  Loss: 1.7945 | Val  Acc: 0.2826
 Site-White                     (0) | Val  Loss: 1.7206 | Val  Acc: 0.3669
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8324 | Val  Acc: 0.3370
 Site-Latino_Hispanic           (5) | Val  Loss: 1.7721 | Val  Acc: 0.3129
 Site-Black                     (1) | Val  Loss: 1.7420 | Val  Acc: 0.3478
 Site-Black                     (1) | Val  Loss: 1.7803 | Val  Acc: 0.2986
 Site-East_Asian                (6) | Val  Loss: 1.6029 | Val  Acc: 0.4565
 Site-East_Asian                (6) | Val  Loss: 1.6686 | Val  Acc: 0.4353
 Site-Indian                    (3) | Val  Loss: 1.9069 | Val  Acc: 0.2391
 Site-Indian                    (3) | Val  Loss: 1.8454 | Val  Acc: 0.2842
 Site-Southeast_Asian           (2) | Val  Loss: 1.7926 | Val  Acc: 0.3696
 Site-Southeast_Asian           (2) | Val  Loss: 1.8009 | Val  Acc: 0.3525
 Site-Middle_Eastern            (4) | Val  Loss: 1.7566 | Val  Acc: 0.3913
 Site-Middle_Eastern            (4) | Val  Loss: 1.8019 | Val  Acc: 0.3129
Average Valid Accuracy: 0.3419
Aggregated Acc | Val Acc: 0.3419
 Best site-White                    (0)  | Epoch:5 | Val Acc: 0.2826
 Best site-White                    (0)  | Epoch:5 | Val Acc: 0.3669
 Best site-Latino_Hispanic          (5)  | Epoch:5 | Val Acc: 0.3370
 Best site-Latino_Hispanic          (5)  | Epoch:5 | Val Acc: 0.3129
 Best site-Black                    (1)  | Epoch:5 | Val Acc: 0.3478
 Best site-Black                    (1)  | Epoch:5 | Val Acc: 0.2986
 Best site-East_Asian               (6)  | Epoch:5 | Val Acc: 0.4565
 Best site-East_Asian               (6)  | Epoch:5 | Val Acc: 0.4353
 Best site-Indian                   (3)  | Epoch:5 | Val Acc: 0.2391
 Best site-Indian                   (3)  | Epoch:5 | Val Acc: 0.2842
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.3696
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.3525
 Best site-Middle_Eastern           (4)  | Epoch:5 | Val Acc: 0.3913
 Best site-Middle_Eastern           (4)  | Epoch:5 | Val Acc: 0.3129
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 6 ============
cnt=[4, 2, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
min_w=0.09411, quan_i=1.85, quan_c=1.85
minimize weight of clients:[0, 1, 2, 3, 6, 7, 10, 12, 13, ]
 Site-White                    | Train Loss: 1.7101 | Train Acc: 0.3597
 Site-White                    | Train Loss: 1.6901 | Train Acc: 0.3861
 Site-Latino_Hispanic          | Train Loss: 1.7339 | Train Acc: 0.3165
 Site-Latino_Hispanic          | Train Loss: 1.7927 | Train Acc: 0.3118
 Site-Black                    | Train Loss: 1.8477 | Train Acc: 0.2590
 Site-Black                    | Train Loss: 1.8039 | Train Acc: 0.2830
 Site-East_Asian               | Train Loss: 1.6320 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.6323 | Train Acc: 0.4293
 Site-Indian                   | Train Loss: 1.8073 | Train Acc: 0.3165
 Site-Indian                   | Train Loss: 1.8224 | Train Acc: 0.2854
 Site-Southeast_Asian          | Train Loss: 1.8246 | Train Acc: 0.3525
 Site-Southeast_Asian          | Train Loss: 1.7996 | Train Acc: 0.3717
 Site-Middle_Eastern           | Train Loss: 1.6741 | Train Acc: 0.3525
 Site-Middle_Eastern           | Train Loss: 1.7693 | Train Acc: 0.3381
 Site-White                     (0) | Val  Loss: 1.7476 | Val  Acc: 0.3804
 Site-White                     (0) | Val  Loss: 1.6955 | Val  Acc: 0.3597
 Site-Latino_Hispanic           (6) | Val  Loss: 1.8271 | Val  Acc: 0.3261
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7802 | Val  Acc: 0.3165
 Site-Black                     (5) | Val  Loss: 1.7178 | Val  Acc: 0.4239
 Site-Black                     (5) | Val  Loss: 1.7743 | Val  Acc: 0.3201
 Site-East_Asian                (3) | Val  Loss: 1.5441 | Val  Acc: 0.4891
 Site-East_Asian                (3) | Val  Loss: 1.6677 | Val  Acc: 0.4029
 Site-Indian                    (1) | Val  Loss: 1.8383 | Val  Acc: 0.2717
 Site-Indian                    (1) | Val  Loss: 1.8489 | Val  Acc: 0.2770
 Site-Southeast_Asian           (2) | Val  Loss: 1.7449 | Val  Acc: 0.3696
 Site-Southeast_Asian           (2) | Val  Loss: 1.7607 | Val  Acc: 0.3561
 Site-Middle_Eastern            (0) | Val  Loss: 1.6958 | Val  Acc: 0.3804
 Site-Middle_Eastern            (0) | Val  Loss: 1.7790 | Val  Acc: 0.3525
Average Valid Accuracy: 0.3590
Aggregated Acc | Val Acc: 0.3523
 Best site-White                    (0)  | Epoch:6 | Val Acc: 0.3804
 Best site-White                    (0)  | Epoch:6 | Val Acc: 0.3597
 Best site-Latino_Hispanic          (6)  | Epoch:6 | Val Acc: 0.3261
 Best site-Latino_Hispanic          (4)  | Epoch:6 | Val Acc: 0.3165
 Best site-Black                    (5)  | Epoch:6 | Val Acc: 0.4239
 Best site-Black                    (5)  | Epoch:6 | Val Acc: 0.3201
 Best site-East_Asian               (3)  | Epoch:6 | Val Acc: 0.4891
 Best site-East_Asian               (3)  | Epoch:6 | Val Acc: 0.4029
 Best site-Indian                   (1)  | Epoch:6 | Val Acc: 0.2717
 Best site-Indian                   (1)  | Epoch:6 | Val Acc: 0.2770
 Best site-Southeast_Asian          (2)  | Epoch:6 | Val Acc: 0.3696
 Best site-Southeast_Asian          (2)  | Epoch:6 | Val Acc: 0.3561
 Best site-Middle_Eastern           (0)  | Epoch:6 | Val Acc: 0.3804
 Best site-Middle_Eastern           (0)  | Epoch:6 | Val Acc: 0.3525
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 2, 4, 2, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
min_w=0.09906, quan_i=1.83, quan_c=1.83
minimize weight of clients:[0, 1, 2, 3, 6, 7, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.6830 | Train Acc: 0.4029
 Site-White                    | Train Loss: 1.6716 | Train Acc: 0.3957
 Site-Latino_Hispanic          | Train Loss: 1.8259 | Train Acc: 0.3381
 Site-Latino_Hispanic          | Train Loss: 1.7802 | Train Acc: 0.3261
 Site-Black                    | Train Loss: 1.8163 | Train Acc: 0.2374
 Site-Black                    | Train Loss: 1.7896 | Train Acc: 0.2974
 Site-East_Asian               | Train Loss: 1.6157 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.6308 | Train Acc: 0.4317
 Site-Indian                   | Train Loss: 1.7830 | Train Acc: 0.3094
 Site-Indian                   | Train Loss: 1.8008 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 1.8102 | Train Acc: 0.3885
 Site-Southeast_Asian          | Train Loss: 1.7628 | Train Acc: 0.3837
 Site-Middle_Eastern           | Train Loss: 1.7521 | Train Acc: 0.3309
 Site-Middle_Eastern           | Train Loss: 1.7240 | Train Acc: 0.3669
 Site-White                     (5) | Val  Loss: 1.7646 | Val  Acc: 0.3370
 Site-White                     (5) | Val  Loss: 1.7018 | Val  Acc: 0.3885
 Site-Latino_Hispanic           (4) | Val  Loss: 1.8337 | Val  Acc: 0.3478
 Site-Latino_Hispanic           (0) | Val  Loss: 1.7447 | Val  Acc: 0.3237
 Site-Black                     (1) | Val  Loss: 1.6970 | Val  Acc: 0.4565
 Site-Black                     (1) | Val  Loss: 1.7459 | Val  Acc: 0.3309
 Site-East_Asian                (2) | Val  Loss: 1.5891 | Val  Acc: 0.5435
 Site-East_Asian                (2) | Val  Loss: 1.6356 | Val  Acc: 0.4353
 Site-Indian                    (3) | Val  Loss: 1.7870 | Val  Acc: 0.2935
 Site-Indian                    (3) | Val  Loss: 1.7881 | Val  Acc: 0.3094
 Site-Southeast_Asian           (2) | Val  Loss: 1.7212 | Val  Acc: 0.3804
 Site-Southeast_Asian           (2) | Val  Loss: 1.7313 | Val  Acc: 0.3993
 Site-Middle_Eastern            (6) | Val  Loss: 1.6803 | Val  Acc: 0.4022
 Site-Middle_Eastern            (6) | Val  Loss: 1.7646 | Val  Acc: 0.3561
Average Valid Accuracy: 0.3789
Aggregated Acc | Val Acc: 0.3640
 Best site-White                    (5)  | Epoch:7 | Val Acc: 0.3370
 Best site-White                    (5)  | Epoch:7 | Val Acc: 0.3885
 Best site-Latino_Hispanic          (4)  | Epoch:7 | Val Acc: 0.3478
 Best site-Latino_Hispanic          (0)  | Epoch:7 | Val Acc: 0.3237
 Best site-Black                    (1)  | Epoch:7 | Val Acc: 0.4565
 Best site-Black                    (1)  | Epoch:7 | Val Acc: 0.3309
 Best site-East_Asian               (2)  | Epoch:7 | Val Acc: 0.5435
 Best site-East_Asian               (2)  | Epoch:7 | Val Acc: 0.4353
 Best site-Indian                   (3)  | Epoch:7 | Val Acc: 0.2935
 Best site-Indian                   (3)  | Epoch:7 | Val Acc: 0.3094
 Best site-Southeast_Asian          (2)  | Epoch:7 | Val Acc: 0.3804
 Best site-Southeast_Asian          (2)  | Epoch:7 | Val Acc: 0.3993
 Best site-Middle_Eastern           (6)  | Epoch:7 | Val Acc: 0.4022
 Best site-Middle_Eastern           (6)  | Epoch:7 | Val Acc: 0.3561
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 2, 2, 2, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
min_w=0.09873, quan_i=1.82, quan_c=1.81
minimize weight of clients:[0, 1, 3, 6, 7, 8, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.7500 | Train Acc: 0.4173
 Site-White                    | Train Loss: 1.6538 | Train Acc: 0.3885
 Site-Latino_Hispanic          | Train Loss: 1.7692 | Train Acc: 0.3094
 Site-Latino_Hispanic          | Train Loss: 1.7553 | Train Acc: 0.3333
 Site-Black                    | Train Loss: 1.8009 | Train Acc: 0.2734
 Site-Black                    | Train Loss: 1.7408 | Train Acc: 0.3309
 Site-East_Asian               | Train Loss: 1.6366 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.6042 | Train Acc: 0.4365
 Site-Indian                   | Train Loss: 1.6925 | Train Acc: 0.3957
 Site-Indian                   | Train Loss: 1.7493 | Train Acc: 0.3213
 Site-Southeast_Asian          | Train Loss: 1.7850 | Train Acc: 0.3813
 Site-Southeast_Asian          | Train Loss: 1.7353 | Train Acc: 0.3837
 Site-Middle_Eastern           | Train Loss: 1.7611 | Train Acc: 0.3525
 Site-Middle_Eastern           | Train Loss: 1.6697 | Train Acc: 0.3933
 Site-White                     (0) | Val  Loss: 1.7218 | Val  Acc: 0.3370
 Site-White                     (0) | Val  Loss: 1.6713 | Val  Acc: 0.3921
 Site-Latino_Hispanic           (6) | Val  Loss: 1.7867 | Val  Acc: 0.2826
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7174 | Val  Acc: 0.3309
 Site-Black                     (2) | Val  Loss: 1.6782 | Val  Acc: 0.4022
 Site-Black                     (2) | Val  Loss: 1.7458 | Val  Acc: 0.3453
 Site-East_Asian                (5) | Val  Loss: 1.5471 | Val  Acc: 0.5109
 Site-East_Asian                (5) | Val  Loss: 1.5836 | Val  Acc: 0.4640
 Site-Indian                    (3) | Val  Loss: 1.7902 | Val  Acc: 0.2609
 Site-Indian                    (3) | Val  Loss: 1.7728 | Val  Acc: 0.3094
 Site-Southeast_Asian           (5) | Val  Loss: 1.6948 | Val  Acc: 0.3913
 Site-Southeast_Asian           (5) | Val  Loss: 1.6875 | Val  Acc: 0.3813
 Site-Middle_Eastern            (1) | Val  Loss: 1.6793 | Val  Acc: 0.3913
 Site-Middle_Eastern            (1) | Val  Loss: 1.7307 | Val  Acc: 0.3813
Average Valid Accuracy: 0.3700
Aggregated Acc | Val Acc: 0.3514
============ Train epoch 9 ============
cnt=[2, 2, 4, 1, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
min_w=0.09522, quan_i=1.79, quan_c=1.77
minimize weight of clients:[0, 1, 5, 6, 7, 8, 9, 11, 13, ]
 Site-White                    | Train Loss: 1.6809 | Train Acc: 0.3741
 Site-White                    | Train Loss: 1.6287 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.8562 | Train Acc: 0.3669
 Site-Latino_Hispanic          | Train Loss: 1.6855 | Train Acc: 0.3429
 Site-Black                    | Train Loss: 1.8308 | Train Acc: 0.2950
 Site-Black                    | Train Loss: 1.7371 | Train Acc: 0.3381
 Site-East_Asian               | Train Loss: 1.5317 | Train Acc: 0.5036
 Site-East_Asian               | Train Loss: 1.5474 | Train Acc: 0.4269
 Site-Indian                   | Train Loss: 1.6481 | Train Acc: 0.3957
 Site-Indian                   | Train Loss: 1.7167 | Train Acc: 0.3189
 Site-Southeast_Asian          | Train Loss: 1.6796 | Train Acc: 0.4101
 Site-Southeast_Asian          | Train Loss: 1.6911 | Train Acc: 0.4125
 Site-Middle_Eastern           | Train Loss: 1.5366 | Train Acc: 0.3885
 Site-Middle_Eastern           | Train Loss: 1.6532 | Train Acc: 0.3957
 Site-White                     (2) | Val  Loss: 1.7047 | Val  Acc: 0.3804
 Site-White                     (2) | Val  Loss: 1.6283 | Val  Acc: 0.4209
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7397 | Val  Acc: 0.3370
 Site-Latino_Hispanic           (4) | Val  Loss: 1.6720 | Val  Acc: 0.3453
 Site-Black                     (5) | Val  Loss: 1.6005 | Val  Acc: 0.4457
 Site-Black                     (3) | Val  Loss: 1.7018 | Val  Acc: 0.3381
 Site-East_Asian                (0) | Val  Loss: 1.4457 | Val  Acc: 0.5543
 Site-East_Asian                (0) | Val  Loss: 1.5648 | Val  Acc: 0.4496
 Site-Indian                    (6) | Val  Loss: 1.7372 | Val  Acc: 0.2717
 Site-Indian                    (6) | Val  Loss: 1.7136 | Val  Acc: 0.3309
 Site-Southeast_Asian           (1) | Val  Loss: 1.6075 | Val  Acc: 0.4130
 Site-Southeast_Asian           (1) | Val  Loss: 1.6369 | Val  Acc: 0.4209
 Site-Middle_Eastern            (2) | Val  Loss: 1.6204 | Val  Acc: 0.4022
 Site-Middle_Eastern            (2) | Val  Loss: 1.6770 | Val  Acc: 0.3993
Average Valid Accuracy: 0.3935
Aggregated Acc | Val Acc: 0.3923
 Best site-White                    (2)  | Epoch:9 | Val Acc: 0.3804
 Best site-White                    (2)  | Epoch:9 | Val Acc: 0.4209
 Best site-Latino_Hispanic          (4)  | Epoch:9 | Val Acc: 0.3370
 Best site-Latino_Hispanic          (4)  | Epoch:9 | Val Acc: 0.3453
 Best site-Black                    (5)  | Epoch:9 | Val Acc: 0.4457
 Best site-Black                    (3)  | Epoch:9 | Val Acc: 0.3381
 Best site-East_Asian               (0)  | Epoch:9 | Val Acc: 0.5543
 Best site-East_Asian               (0)  | Epoch:9 | Val Acc: 0.4496
 Best site-Indian                   (6)  | Epoch:9 | Val Acc: 0.2717
 Best site-Indian                   (6)  | Epoch:9 | Val Acc: 0.3309
 Best site-Southeast_Asian          (1)  | Epoch:9 | Val Acc: 0.4130
 Best site-Southeast_Asian          (1)  | Epoch:9 | Val Acc: 0.4209
 Best site-Middle_Eastern           (2)  | Epoch:9 | Val Acc: 0.4022
 Best site-Middle_Eastern           (2)  | Epoch:9 | Val Acc: 0.3993
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
 Test site-White                    | Epoch:9 | Test Acc: 0.3503
 Test site-Latino_Hispanic          | Epoch:9 | Test Acc: 0.3196
 Test site-Black                    | Epoch:9 | Test Acc: 0.2750
 Test site-East_Asian               | Epoch:9 | Test Acc: 0.4221
 Test site-Indian                   | Epoch:9 | Test Acc: 0.3397
 Test site-Southeast_Asian          | Epoch:9 | Test Acc: 0.3667
 Test site-Middle_Eastern           | Epoch:9 | Test Acc: 0.3918
Average Test Accuracy: 0.3522, domain std=0.0445, individual std=0.0445
============ Train epoch 10 ============
cnt=[3, 2, 2, 3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
min_w=0.08521, quan_i=1.74, quan_c=1.75
minimize weight of clients:[0, 1, 3, 6, 7, 10, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.7349 | Train Acc: 0.3597
 Site-White                    | Train Loss: 1.6069 | Train Acc: 0.4125
 Site-Latino_Hispanic          | Train Loss: 1.7423 | Train Acc: 0.3669
 Site-Latino_Hispanic          | Train Loss: 1.6614 | Train Acc: 0.3525
 Site-Black                    | Train Loss: 1.7306 | Train Acc: 0.3525
 Site-Black                    | Train Loss: 1.6945 | Train Acc: 0.3693
 Site-East_Asian               | Train Loss: 1.4405 | Train Acc: 0.5180
 Site-East_Asian               | Train Loss: 1.5555 | Train Acc: 0.4317
 Site-Indian                   | Train Loss: 1.5073 | Train Acc: 0.3957
 Site-Indian                   | Train Loss: 1.6592 | Train Acc: 0.3477
 Site-Southeast_Asian          | Train Loss: 1.7216 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.6475 | Train Acc: 0.4293
 Site-Middle_Eastern           | Train Loss: 1.5359 | Train Acc: 0.3741
 Site-Middle_Eastern           | Train Loss: 1.6081 | Train Acc: 0.4101
 Site-White                     (4) | Val  Loss: 1.6467 | Val  Acc: 0.3696
 Site-White                     (4) | Val  Loss: 1.5917 | Val  Acc: 0.4065
 Site-Latino_Hispanic           (0) | Val  Loss: 1.6628 | Val  Acc: 0.3913
 Site-Latino_Hispanic           (3) | Val  Loss: 1.6314 | Val  Acc: 0.3741
 Site-Black                     (6) | Val  Loss: 1.5480 | Val  Acc: 0.4783
 Site-Black                     (5) | Val  Loss: 1.6680 | Val  Acc: 0.3561
 Site-East_Asian                (1) | Val  Loss: 1.4726 | Val  Acc: 0.5326
 Site-East_Asian                (1) | Val  Loss: 1.5463 | Val  Acc: 0.4568
 Site-Indian                    (0) | Val  Loss: 1.6758 | Val  Acc: 0.2935
 Site-Indian                    (0) | Val  Loss: 1.6642 | Val  Acc: 0.3273
 Site-Southeast_Asian           (3) | Val  Loss: 1.6104 | Val  Acc: 0.3913
 Site-Southeast_Asian           (3) | Val  Loss: 1.6063 | Val  Acc: 0.4245
 Site-Middle_Eastern            (2) | Val  Loss: 1.5183 | Val  Acc: 0.4239
 Site-Middle_Eastern            (2) | Val  Loss: 1.6365 | Val  Acc: 0.4388
Average Valid Accuracy: 0.4046
Aggregated Acc | Val Acc: 0.4118
 Best site-White                    (4)  | Epoch:10 | Val Acc: 0.3696
 Best site-White                    (4)  | Epoch:10 | Val Acc: 0.4065
 Best site-Latino_Hispanic          (0)  | Epoch:10 | Val Acc: 0.3913
 Best site-Latino_Hispanic          (3)  | Epoch:10 | Val Acc: 0.3741
 Best site-Black                    (6)  | Epoch:10 | Val Acc: 0.4783
 Best site-Black                    (5)  | Epoch:10 | Val Acc: 0.3561
 Best site-East_Asian               (1)  | Epoch:10 | Val Acc: 0.5326
 Best site-East_Asian               (1)  | Epoch:10 | Val Acc: 0.4568
 Best site-Indian                   (0)  | Epoch:10 | Val Acc: 0.2935
 Best site-Indian                   (0)  | Epoch:10 | Val Acc: 0.3273
 Best site-Southeast_Asian          (3)  | Epoch:10 | Val Acc: 0.3913
 Best site-Southeast_Asian          (3)  | Epoch:10 | Val Acc: 0.4245
 Best site-Middle_Eastern           (2)  | Epoch:10 | Val Acc: 0.4239
 Best site-Middle_Eastern           (2)  | Epoch:10 | Val Acc: 0.4388
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
min_w=0.07814, quan_i=1.74, quan_c=1.69
minimize weight of clients:[1, 6, 7, 8, 9, 10, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.5759 | Train Acc: 0.3813
 Site-White                    | Train Loss: 1.5619 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.6097 | Train Acc: 0.3381
 Site-Latino_Hispanic          | Train Loss: 1.6247 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.7571 | Train Acc: 0.3094
 Site-Black                    | Train Loss: 1.6668 | Train Acc: 0.3597
 Site-East_Asian               | Train Loss: 1.3952 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.5053 | Train Acc: 0.4484
 Site-Indian                   | Train Loss: 1.6137 | Train Acc: 0.3597
 Site-Indian                   | Train Loss: 1.6546 | Train Acc: 0.3429
 Site-Southeast_Asian          | Train Loss: 1.6573 | Train Acc: 0.4245
 Site-Southeast_Asian          | Train Loss: 1.6280 | Train Acc: 0.3861
 Site-Middle_Eastern           | Train Loss: 1.5372 | Train Acc: 0.3669
 Site-Middle_Eastern           | Train Loss: 1.5591 | Train Acc: 0.4053
 Site-White                     (3) | Val  Loss: 1.6587 | Val  Acc: 0.3696
 Site-White                     (3) | Val  Loss: 1.5926 | Val  Acc: 0.3993
 Site-Latino_Hispanic           (1) | Val  Loss: 1.6674 | Val  Acc: 0.3587
 Site-Latino_Hispanic           (1) | Val  Loss: 1.6247 | Val  Acc: 0.3489
 Site-Black                     (2) | Val  Loss: 1.5177 | Val  Acc: 0.4674
 Site-Black                     (2) | Val  Loss: 1.6486 | Val  Acc: 0.3597
 Site-East_Asian                (6) | Val  Loss: 1.4065 | Val  Acc: 0.5435
 Site-East_Asian                (6) | Val  Loss: 1.4992 | Val  Acc: 0.4353
 Site-Indian                    (4) | Val  Loss: 1.6828 | Val  Acc: 0.2826
 Site-Indian                    (4) | Val  Loss: 1.6182 | Val  Acc: 0.3201
 Site-Southeast_Asian           (0) | Val  Loss: 1.5611 | Val  Acc: 0.4239
 Site-Southeast_Asian           (0) | Val  Loss: 1.6108 | Val  Acc: 0.4209
 Site-Middle_Eastern            (5) | Val  Loss: 1.5086 | Val  Acc: 0.4457
 Site-Middle_Eastern            (5) | Val  Loss: 1.5982 | Val  Acc: 0.4065
Average Valid Accuracy: 0.3987
Aggregated Acc | Val Acc: 0.3987
============ Train epoch 12 ============
cnt=[2, 3, 2, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
min_w=0.07383, quan_i=1.67, quan_c=1.66
minimize weight of clients:[0, 1, 2, 3, 6, 7, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.5397 | Train Acc: 0.3957
 Site-White                    | Train Loss: 1.5429 | Train Acc: 0.4221
 Site-Latino_Hispanic          | Train Loss: 1.7167 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.6236 | Train Acc: 0.3789
 Site-Black                    | Train Loss: 1.6727 | Train Acc: 0.3309
 Site-Black                    | Train Loss: 1.6408 | Train Acc: 0.3333
 Site-East_Asian               | Train Loss: 1.4410 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.5185 | Train Acc: 0.4388
 Site-Indian                   | Train Loss: 1.4650 | Train Acc: 0.4173
 Site-Indian                   | Train Loss: 1.6219 | Train Acc: 0.3597
 Site-Southeast_Asian          | Train Loss: 1.5631 | Train Acc: 0.4245
 Site-Southeast_Asian          | Train Loss: 1.6170 | Train Acc: 0.3909
 Site-Middle_Eastern           | Train Loss: 1.5763 | Train Acc: 0.4029
 Site-Middle_Eastern           | Train Loss: 1.5438 | Train Acc: 0.4317
 Site-White                     (5) | Val  Loss: 1.5814 | Val  Acc: 0.3696
 Site-White                     (1) | Val  Loss: 1.5599 | Val  Acc: 0.4029
 Site-Latino_Hispanic           (6) | Val  Loss: 1.6365 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (6) | Val  Loss: 1.5937 | Val  Acc: 0.3885
 Site-Black                     (2) | Val  Loss: 1.5008 | Val  Acc: 0.4674
 Site-Black                     (2) | Val  Loss: 1.6070 | Val  Acc: 0.3849
 Site-East_Asian                (3) | Val  Loss: 1.4078 | Val  Acc: 0.5435
 Site-East_Asian                (3) | Val  Loss: 1.4816 | Val  Acc: 0.4712
 Site-Indian                    (4) | Val  Loss: 1.6381 | Val  Acc: 0.2717
 Site-Indian                    (4) | Val  Loss: 1.6170 | Val  Acc: 0.3417
 Site-Southeast_Asian           (0) | Val  Loss: 1.5744 | Val  Acc: 0.3804
 Site-Southeast_Asian           (0) | Val  Loss: 1.5630 | Val  Acc: 0.4353
 Site-Middle_Eastern            (1) | Val  Loss: 1.4966 | Val  Acc: 0.4130
 Site-Middle_Eastern            (1) | Val  Loss: 1.6042 | Val  Acc: 0.4065
Average Valid Accuracy: 0.4056
Aggregated Acc | Val Acc: 0.4029
 Best site-White                    (5)  | Epoch:12 | Val Acc: 0.3696
 Best site-White                    (1)  | Epoch:12 | Val Acc: 0.4029
 Best site-Latino_Hispanic          (6)  | Epoch:12 | Val Acc: 0.4022
 Best site-Latino_Hispanic          (6)  | Epoch:12 | Val Acc: 0.3885
 Best site-Black                    (2)  | Epoch:12 | Val Acc: 0.4674
 Best site-Black                    (2)  | Epoch:12 | Val Acc: 0.3849
 Best site-East_Asian               (3)  | Epoch:12 | Val Acc: 0.5435
 Best site-East_Asian               (3)  | Epoch:12 | Val Acc: 0.4712
 Best site-Indian                   (4)  | Epoch:12 | Val Acc: 0.2717
 Best site-Indian                   (4)  | Epoch:12 | Val Acc: 0.3417
 Best site-Southeast_Asian          (0)  | Epoch:12 | Val Acc: 0.3804
 Best site-Southeast_Asian          (0)  | Epoch:12 | Val Acc: 0.4353
 Best site-Middle_Eastern           (1)  | Epoch:12 | Val Acc: 0.4130
 Best site-Middle_Eastern           (1)  | Epoch:12 | Val Acc: 0.4065
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 13 ============
cnt=[3, 1, 3, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
min_w=0.07931, quan_i=1.65, quan_c=1.63
minimize weight of clients:[0, 1, 3, 6, 7, 8, 9, 12, 13, ]
 Site-White                    | Train Loss: 1.5844 | Train Acc: 0.3885
 Site-White                    | Train Loss: 1.5228 | Train Acc: 0.4149
 Site-Latino_Hispanic          | Train Loss: 1.6224 | Train Acc: 0.3597
 Site-Latino_Hispanic          | Train Loss: 1.6009 | Train Acc: 0.3573
 Site-Black                    | Train Loss: 1.6797 | Train Acc: 0.3309
 Site-Black                    | Train Loss: 1.6275 | Train Acc: 0.3597
 Site-East_Asian               | Train Loss: 1.5051 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.4966 | Train Acc: 0.4412
 Site-Indian                   | Train Loss: 1.4332 | Train Acc: 0.3957
 Site-Indian                   | Train Loss: 1.6262 | Train Acc: 0.3501
 Site-Southeast_Asian          | Train Loss: 1.4865 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.5836 | Train Acc: 0.4029
 Site-Middle_Eastern           | Train Loss: 1.5747 | Train Acc: 0.3813
 Site-Middle_Eastern           | Train Loss: 1.5438 | Train Acc: 0.4293
 Site-White                     (5) | Val  Loss: 1.6135 | Val  Acc: 0.3804
 Site-White                     (1) | Val  Loss: 1.5559 | Val  Acc: 0.4245
 Site-Latino_Hispanic           (2) | Val  Loss: 1.6240 | Val  Acc: 0.3913
 Site-Latino_Hispanic           (0) | Val  Loss: 1.5628 | Val  Acc: 0.3777
 Site-Black                     (3) | Val  Loss: 1.4785 | Val  Acc: 0.4674
 Site-Black                     (3) | Val  Loss: 1.6043 | Val  Acc: 0.4101
 Site-East_Asian                (2) | Val  Loss: 1.3445 | Val  Acc: 0.5326
 Site-East_Asian                (2) | Val  Loss: 1.4755 | Val  Acc: 0.4820
 Site-Indian                    (0) | Val  Loss: 1.6707 | Val  Acc: 0.3152
 Site-Indian                    (0) | Val  Loss: 1.5901 | Val  Acc: 0.3669
 Site-Southeast_Asian           (6) | Val  Loss: 1.5206 | Val  Acc: 0.4130
 Site-Southeast_Asian           (6) | Val  Loss: 1.5397 | Val  Acc: 0.4065
 Site-Middle_Eastern            (4) | Val  Loss: 1.4917 | Val  Acc: 0.4457
 Site-Middle_Eastern            (4) | Val  Loss: 1.6128 | Val  Acc: 0.4029
Average Valid Accuracy: 0.4154
Aggregated Acc | Val Acc: 0.4142
 Best site-White                    (5)  | Epoch:13 | Val Acc: 0.3804
 Best site-White                    (1)  | Epoch:13 | Val Acc: 0.4245
 Best site-Latino_Hispanic          (2)  | Epoch:13 | Val Acc: 0.3913
 Best site-Latino_Hispanic          (0)  | Epoch:13 | Val Acc: 0.3777
 Best site-Black                    (3)  | Epoch:13 | Val Acc: 0.4674
 Best site-Black                    (3)  | Epoch:13 | Val Acc: 0.4101
 Best site-East_Asian               (2)  | Epoch:13 | Val Acc: 0.5326
 Best site-East_Asian               (2)  | Epoch:13 | Val Acc: 0.4820
 Best site-Indian                   (0)  | Epoch:13 | Val Acc: 0.3152
 Best site-Indian                   (0)  | Epoch:13 | Val Acc: 0.3669
 Best site-Southeast_Asian          (6)  | Epoch:13 | Val Acc: 0.4130
 Best site-Southeast_Asian          (6)  | Epoch:13 | Val Acc: 0.4065
 Best site-Middle_Eastern           (4)  | Epoch:13 | Val Acc: 0.4457
 Best site-Middle_Eastern           (4)  | Epoch:13 | Val Acc: 0.4029
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-std_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 3, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
min_w=0.08082, quan_i=1.64, quan_c=1.61
minimize weight of clients:[1, 3, 6, 7, 8, 10, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.5499 | Train Acc: 0.3885
 Site-White                    | Train Loss: 1.5097 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.6325 | Train Acc: 0.3597
 Site-Latino_Hispanic          | Train Loss: 1.5850 | Train Acc: 0.3573
 Site-Black                    | Train Loss: 1.7195 | Train Acc: 0.3597
 Site-Black                    | Train Loss: 1.6143 | Train Acc: 0.3837
 Site-East_Asian               | Train Loss: 1.4098 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.4881 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.5087 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.5722 | Train Acc: 0.3765
 Site-Southeast_Asian          | Train Loss: 1.6211 | Train Acc: 0.4101
 Site-Southeast_Asian          | Train Loss: 1.5851 | Train Acc: 0.3885
 Site-Middle_Eastern           | Train Loss: 1.5400 | Train Acc: 0.4029
 Site-Middle_Eastern           | Train Loss: 1.5280 | Train Acc: 0.4053
 Site-White                     (4) | Val  Loss: 1.6000 | Val  Acc: 0.3587
 Site-White                     (6) | Val  Loss: 1.5176 | Val  Acc: 0.4101
