===2023-06-08 10:09:47===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0.8
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[139,417,139,417,139,417,139,417,139,417,139,417,139,417,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1856,1856,1856,1856,1856,1856,1856,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 2, 1, 6, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
quan_i=1.00, quan_c=1.00
enlarge weight of clients:[]
 Site-White                    | Train Loss: 1.8554 | Train Acc: 0.3453
 Site-White                    | Train Loss: 1.7762 | Train Acc: 0.3549
 Site-Latino_Hispanic          | Train Loss: 1.9418 | Train Acc: 0.2734
 Site-Latino_Hispanic          | Train Loss: 1.8547 | Train Acc: 0.2878
 Site-Black                    | Train Loss: 1.9805 | Train Acc: 0.2590
 Site-Black                    | Train Loss: 1.8946 | Train Acc: 0.2638
 Site-East_Asian               | Train Loss: 1.7597 | Train Acc: 0.3669
 Site-East_Asian               | Train Loss: 1.7527 | Train Acc: 0.3861
 Site-Indian                   | Train Loss: 2.0860 | Train Acc: 0.2302
 Site-Indian                   | Train Loss: 2.1309 | Train Acc: 0.2326
 Site-Southeast_Asian          | Train Loss: 2.0066 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 2.0797 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.9361 | Train Acc: 0.2662
 Site-Middle_Eastern           | Train Loss: 1.9315 | Train Acc: 0.2470
 Site-White                     (3) | Val  Loss: 1.8923 | Val  Acc: 0.2935
 Site-White                     (5) | Val  Loss: 1.8190 | Val  Acc: 0.3525
 Site-Latino_Hispanic           (2) | Val  Loss: 1.9403 | Val  Acc: 0.3370
 Site-Latino_Hispanic           (3) | Val  Loss: 1.9059 | Val  Acc: 0.2806
 Site-Black                     (6) | Val  Loss: 1.8978 | Val  Acc: 0.3043
 Site-Black                     (0) | Val  Loss: 1.9447 | Val  Acc: 0.2554
 Site-East_Asian                (3) | Val  Loss: 1.7008 | Val  Acc: 0.4565
 Site-East_Asian                (3) | Val  Loss: 1.7966 | Val  Acc: 0.3813
 Site-Indian                    (4) | Val  Loss: 2.0572 | Val  Acc: 0.2283
 Site-Indian                    (4) | Val  Loss: 2.0392 | Val  Acc: 0.2410
 Site-Southeast_Asian           (3) | Val  Loss: 1.9884 | Val  Acc: 0.3152
 Site-Southeast_Asian           (3) | Val  Loss: 1.9858 | Val  Acc: 0.3129
 Site-Middle_Eastern            (1) | Val  Loss: 1.9261 | Val  Acc: 0.3043
 Site-Middle_Eastern            (1) | Val  Loss: 1.9600 | Val  Acc: 0.2518
Average Valid Accuracy: 0.3082
 Best site-White                    (3)  | Epoch:0 | Val Acc: 0.2935
 Best site-White                    (5)  | Epoch:0 | Val Acc: 0.3525
 Best site-Latino_Hispanic          (2)  | Epoch:0 | Val Acc: 0.3370
 Best site-Latino_Hispanic          (3)  | Epoch:0 | Val Acc: 0.2806
 Best site-Black                    (6)  | Epoch:0 | Val Acc: 0.3043
 Best site-Black                    (0)  | Epoch:0 | Val Acc: 0.2554
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.4565
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3813
 Best site-Indian                   (4)  | Epoch:0 | Val Acc: 0.2283
 Best site-Indian                   (4)  | Epoch:0 | Val Acc: 0.2410
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.3152
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.3129
 Best site-Middle_Eastern           (1)  | Epoch:0 | Val Acc: 0.3043
 Best site-Middle_Eastern           (1)  | Epoch:0 | Val Acc: 0.2518
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 4, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
quan_i=2.06, quan_c=1.96
enlarge weight of clients:[8, 9, ]
 Site-White                    | Train Loss: 1.7851 | Train Acc: 0.3381
 Site-White                    | Train Loss: 1.7203 | Train Acc: 0.3453
 Site-Latino_Hispanic          | Train Loss: 1.8697 | Train Acc: 0.2662
 Site-Latino_Hispanic          | Train Loss: 1.8388 | Train Acc: 0.2782
 Site-Black                    | Train Loss: 1.9634 | Train Acc: 0.1942
 Site-Black                    | Train Loss: 1.9253 | Train Acc: 0.2566
 Site-East_Asian               | Train Loss: 1.7383 | Train Acc: 0.3741
 Site-East_Asian               | Train Loss: 1.7487 | Train Acc: 0.3933
 Site-Indian                   | Train Loss: 1.9206 | Train Acc: 0.2590
 Site-Indian                   | Train Loss: 1.9299 | Train Acc: 0.2446
 Site-Southeast_Asian          | Train Loss: 1.9012 | Train Acc: 0.3309
 Site-Southeast_Asian          | Train Loss: 1.8740 | Train Acc: 0.3141
 Site-Middle_Eastern           | Train Loss: 1.8800 | Train Acc: 0.2662
 Site-Middle_Eastern           | Train Loss: 1.9102 | Train Acc: 0.2806
 Site-White                     (0) | Val  Loss: 1.8577 | Val  Acc: 0.2935
 Site-White                     (6) | Val  Loss: 1.7800 | Val  Acc: 0.3453
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8637 | Val  Acc: 0.3261
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8537 | Val  Acc: 0.2734
 Site-Black                     (3) | Val  Loss: 1.8539 | Val  Acc: 0.3152
 Site-Black                     (3) | Val  Loss: 1.8993 | Val  Acc: 0.2878
 Site-East_Asian                (1) | Val  Loss: 1.6679 | Val  Acc: 0.4239
 Site-East_Asian                (1) | Val  Loss: 1.7399 | Val  Acc: 0.3993
 Site-Indian                    (4) | Val  Loss: 1.9592 | Val  Acc: 0.2283
 Site-Indian                    (4) | Val  Loss: 1.9634 | Val  Acc: 0.2338
 Site-Southeast_Asian           (1) | Val  Loss: 1.8891 | Val  Acc: 0.3152
 Site-Southeast_Asian           (1) | Val  Loss: 1.9046 | Val  Acc: 0.3094
 Site-Middle_Eastern            (2) | Val  Loss: 1.8584 | Val  Acc: 0.2500
 Site-Middle_Eastern            (2) | Val  Loss: 1.8860 | Val  Acc: 0.2662
Average Valid Accuracy: 0.3048
============ Train epoch 2 ============
cnt=[2, 2, 3, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
quan_i=1.94, quan_c=1.96
enlarge weight of clients:[4, ]
 Site-White                    | Train Loss: 1.7717 | Train Acc: 0.3885
 Site-White                    | Train Loss: 1.7562 | Train Acc: 0.3909
 Site-Latino_Hispanic          | Train Loss: 1.8299 | Train Acc: 0.3094
 Site-Latino_Hispanic          | Train Loss: 1.8473 | Train Acc: 0.3285
 Site-Black                    | Train Loss: 1.9018 | Train Acc: 0.2230
 Site-Black                    | Train Loss: 1.8468 | Train Acc: 0.2830
 Site-East_Asian               | Train Loss: 1.6666 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.6616 | Train Acc: 0.4197
 Site-Indian                   | Train Loss: 1.8292 | Train Acc: 0.3165
 Site-Indian                   | Train Loss: 1.8882 | Train Acc: 0.2830
 Site-Southeast_Asian          | Train Loss: 1.8294 | Train Acc: 0.3453
 Site-Southeast_Asian          | Train Loss: 1.7889 | Train Acc: 0.3405
 Site-Middle_Eastern           | Train Loss: 1.7816 | Train Acc: 0.3741
 Site-Middle_Eastern           | Train Loss: 1.7659 | Train Acc: 0.3573
 Site-White                     (0) | Val  Loss: 1.7349 | Val  Acc: 0.3478
 Site-White                     (0) | Val  Loss: 1.6963 | Val  Acc: 0.3705
 Site-Latino_Hispanic           (4) | Val  Loss: 1.8200 | Val  Acc: 0.3370
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7861 | Val  Acc: 0.3273
 Site-Black                     (6) | Val  Loss: 1.7696 | Val  Acc: 0.4130
 Site-Black                     (2) | Val  Loss: 1.8293 | Val  Acc: 0.3273
 Site-East_Asian                (5) | Val  Loss: 1.6079 | Val  Acc: 0.4891
 Site-East_Asian                (5) | Val  Loss: 1.6620 | Val  Acc: 0.4029
 Site-Indian                    (2) | Val  Loss: 1.8818 | Val  Acc: 0.2609
 Site-Indian                    (2) | Val  Loss: 1.8492 | Val  Acc: 0.2482
 Site-Southeast_Asian           (1) | Val  Loss: 1.8002 | Val  Acc: 0.3043
 Site-Southeast_Asian           (1) | Val  Loss: 1.7798 | Val  Acc: 0.3741
 Site-Middle_Eastern            (3) | Val  Loss: 1.7568 | Val  Acc: 0.3804
 Site-Middle_Eastern            (3) | Val  Loss: 1.7797 | Val  Acc: 0.3633
Average Valid Accuracy: 0.3533
 Best site-White                    (0)  | Epoch:2 | Val Acc: 0.3478
 Best site-White                    (0)  | Epoch:2 | Val Acc: 0.3705
 Best site-Latino_Hispanic          (4)  | Epoch:2 | Val Acc: 0.3370
 Best site-Latino_Hispanic          (4)  | Epoch:2 | Val Acc: 0.3273
 Best site-Black                    (6)  | Epoch:2 | Val Acc: 0.4130
 Best site-Black                    (2)  | Epoch:2 | Val Acc: 0.3273
 Best site-East_Asian               (5)  | Epoch:2 | Val Acc: 0.4891
 Best site-East_Asian               (5)  | Epoch:2 | Val Acc: 0.4029
 Best site-Indian                   (2)  | Epoch:2 | Val Acc: 0.2609
 Best site-Indian                   (2)  | Epoch:2 | Val Acc: 0.2482
 Best site-Southeast_Asian          (1)  | Epoch:2 | Val Acc: 0.3043
 Best site-Southeast_Asian          (1)  | Epoch:2 | Val Acc: 0.3741
 Best site-Middle_Eastern           (3)  | Epoch:2 | Val Acc: 0.3804
 Best site-Middle_Eastern           (3)  | Epoch:2 | Val Acc: 0.3633
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 3 ============
cnt=[4, 2, 1, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
quan_i=1.85, quan_c=1.86
enlarge weight of clients:[4, ]
 Site-White                    | Train Loss: 1.6558 | Train Acc: 0.4101
 Site-White                    | Train Loss: 1.6654 | Train Acc: 0.3765
 Site-Latino_Hispanic          | Train Loss: 1.7588 | Train Acc: 0.3237
 Site-Latino_Hispanic          | Train Loss: 1.6855 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.8315 | Train Acc: 0.2734
 Site-Black                    | Train Loss: 1.8576 | Train Acc: 0.3094
 Site-East_Asian               | Train Loss: 1.5485 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.5292 | Train Acc: 0.4436
 Site-Indian                   | Train Loss: 1.7017 | Train Acc: 0.3741
 Site-Indian                   | Train Loss: 1.7009 | Train Acc: 0.3309
 Site-Southeast_Asian          | Train Loss: 1.6885 | Train Acc: 0.3741
 Site-Southeast_Asian          | Train Loss: 1.7091 | Train Acc: 0.3981
 Site-Middle_Eastern           | Train Loss: 1.7219 | Train Acc: 0.3597
 Site-Middle_Eastern           | Train Loss: 1.6733 | Train Acc: 0.4077
 Site-White                     (4) | Val  Loss: 1.6477 | Val  Acc: 0.3696
 Site-White                     (5) | Val  Loss: 1.6418 | Val  Acc: 0.3813
 Site-Latino_Hispanic           (3) | Val  Loss: 1.7508 | Val  Acc: 0.3370
 Site-Latino_Hispanic           (0) | Val  Loss: 1.7243 | Val  Acc: 0.3525
 Site-Black                     (6) | Val  Loss: 1.7240 | Val  Acc: 0.3696
 Site-Black                     (2) | Val  Loss: 1.8007 | Val  Acc: 0.3201
 Site-East_Asian                (3) | Val  Loss: 1.5149 | Val  Acc: 0.4565
 Site-East_Asian                (3) | Val  Loss: 1.5731 | Val  Acc: 0.4496
 Site-Indian                    (0) | Val  Loss: 1.7942 | Val  Acc: 0.2609
 Site-Indian                    (0) | Val  Loss: 1.7387 | Val  Acc: 0.3201
 Site-Southeast_Asian           (3) | Val  Loss: 1.6780 | Val  Acc: 0.4022
 Site-Southeast_Asian           (0) | Val  Loss: 1.6754 | Val  Acc: 0.3993
 Site-Middle_Eastern            (1) | Val  Loss: 1.6607 | Val  Acc: 0.4239
 Site-Middle_Eastern            (1) | Val  Loss: 1.6725 | Val  Acc: 0.3957
Average Valid Accuracy: 0.3742
 Best site-White                    (4)  | Epoch:3 | Val Acc: 0.3696
 Best site-White                    (5)  | Epoch:3 | Val Acc: 0.3813
 Best site-Latino_Hispanic          (3)  | Epoch:3 | Val Acc: 0.3370
 Best site-Latino_Hispanic          (0)  | Epoch:3 | Val Acc: 0.3525
 Best site-Black                    (6)  | Epoch:3 | Val Acc: 0.3696
 Best site-Black                    (2)  | Epoch:3 | Val Acc: 0.3201
 Best site-East_Asian               (3)  | Epoch:3 | Val Acc: 0.4565
 Best site-East_Asian               (3)  | Epoch:3 | Val Acc: 0.4496
 Best site-Indian                   (0)  | Epoch:3 | Val Acc: 0.2609
 Best site-Indian                   (0)  | Epoch:3 | Val Acc: 0.3201
 Best site-Southeast_Asian          (3)  | Epoch:3 | Val Acc: 0.4022
 Best site-Southeast_Asian          (0)  | Epoch:3 | Val Acc: 0.3993
 Best site-Middle_Eastern           (1)  | Epoch:3 | Val Acc: 0.4239
 Best site-Middle_Eastern           (1)  | Epoch:3 | Val Acc: 0.3957
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 4 ============
cnt=[4, 1, 2, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
quan_i=1.75, quan_c=1.73
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.6221 | Train Acc: 0.3885
 Site-White                    | Train Loss: 1.5473 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.7346 | Train Acc: 0.2878
 Site-Latino_Hispanic          | Train Loss: 1.6506 | Train Acc: 0.3837
 Site-Black                    | Train Loss: 1.8045 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.6800 | Train Acc: 0.3381
 Site-East_Asian               | Train Loss: 1.5656 | Train Acc: 0.3957
 Site-East_Asian               | Train Loss: 1.6026 | Train Acc: 0.4460
 Site-Indian                   | Train Loss: 1.6214 | Train Acc: 0.3669
 Site-Indian                   | Train Loss: 1.7225 | Train Acc: 0.3573
 Site-Southeast_Asian          | Train Loss: 1.6340 | Train Acc: 0.3885
 Site-Southeast_Asian          | Train Loss: 1.7491 | Train Acc: 0.3693
 Site-Middle_Eastern           | Train Loss: 1.6115 | Train Acc: 0.3813
 Site-Middle_Eastern           | Train Loss: 1.6270 | Train Acc: 0.3933
 Site-White                     (6) | Val  Loss: 1.6244 | Val  Acc: 0.4130
 Site-White                     (0) | Val  Loss: 1.6060 | Val  Acc: 0.3705
 Site-Latino_Hispanic           (6) | Val  Loss: 1.6968 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (0) | Val  Loss: 1.6815 | Val  Acc: 0.3813
 Site-Black                     (1) | Val  Loss: 1.6503 | Val  Acc: 0.4239
 Site-Black                     (5) | Val  Loss: 1.7627 | Val  Acc: 0.2986
 Site-East_Asian                (0) | Val  Loss: 1.4694 | Val  Acc: 0.5217
 Site-East_Asian                (0) | Val  Loss: 1.5155 | Val  Acc: 0.4245
 Site-Indian                    (3) | Val  Loss: 1.7264 | Val  Acc: 0.2609
 Site-Indian                    (3) | Val  Loss: 1.6975 | Val  Acc: 0.3058
 Site-Southeast_Asian           (4) | Val  Loss: 1.6316 | Val  Acc: 0.4457
 Site-Southeast_Asian           (4) | Val  Loss: 1.6269 | Val  Acc: 0.4029
 Site-Middle_Eastern            (2) | Val  Loss: 1.6072 | Val  Acc: 0.4565
 Site-Middle_Eastern            (2) | Val  Loss: 1.6381 | Val  Acc: 0.3849
Average Valid Accuracy: 0.3931
 Best site-White                    (6)  | Epoch:4 | Val Acc: 0.4130
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.3705
 Best site-Latino_Hispanic          (6)  | Epoch:4 | Val Acc: 0.4130
 Best site-Latino_Hispanic          (0)  | Epoch:4 | Val Acc: 0.3813
 Best site-Black                    (1)  | Epoch:4 | Val Acc: 0.4239
 Best site-Black                    (5)  | Epoch:4 | Val Acc: 0.2986
 Best site-East_Asian               (0)  | Epoch:4 | Val Acc: 0.5217
 Best site-East_Asian               (0)  | Epoch:4 | Val Acc: 0.4245
 Best site-Indian                   (3)  | Epoch:4 | Val Acc: 0.2609
 Best site-Indian                   (3)  | Epoch:4 | Val Acc: 0.3058
 Best site-Southeast_Asian          (4)  | Epoch:4 | Val Acc: 0.4457
 Best site-Southeast_Asian          (4)  | Epoch:4 | Val Acc: 0.4029
 Best site-Middle_Eastern           (2)  | Epoch:4 | Val Acc: 0.4565
 Best site-Middle_Eastern           (2)  | Epoch:4 | Val Acc: 0.3849
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 5 ============
cnt=[3, 2, 3, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
quan_i=1.74, quan_c=1.71
enlarge weight of clients:[4, 11, ]
 Site-White                    | Train Loss: 1.5555 | Train Acc: 0.4317
 Site-White                    | Train Loss: 1.5988 | Train Acc: 0.3957
 Site-Latino_Hispanic          | Train Loss: 1.6697 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.6749 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.8122 | Train Acc: 0.3309
 Site-Black                    | Train Loss: 1.7221 | Train Acc: 0.3213
 Site-East_Asian               | Train Loss: 1.5174 | Train Acc: 0.4101
 Site-East_Asian               | Train Loss: 1.4514 | Train Acc: 0.4508
 Site-Indian                   | Train Loss: 1.6140 | Train Acc: 0.4388
 Site-Indian                   | Train Loss: 1.6235 | Train Acc: 0.3597
 Site-Southeast_Asian          | Train Loss: 1.6311 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.6252 | Train Acc: 0.4077
 Site-Middle_Eastern           | Train Loss: 1.6349 | Train Acc: 0.3597
 Site-Middle_Eastern           | Train Loss: 1.5309 | Train Acc: 0.4125
 Site-White                     (0) | Val  Loss: 1.6079 | Val  Acc: 0.3696
 Site-White                     (0) | Val  Loss: 1.5706 | Val  Acc: 0.4029
 Site-Latino_Hispanic           (0) | Val  Loss: 1.6684 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (2) | Val  Loss: 1.6443 | Val  Acc: 0.3597
 Site-Black                     (6) | Val  Loss: 1.5660 | Val  Acc: 0.4565
 Site-Black                     (4) | Val  Loss: 1.6915 | Val  Acc: 0.3921
 Site-East_Asian                (3) | Val  Loss: 1.4023 | Val  Acc: 0.5326
 Site-East_Asian                (3) | Val  Loss: 1.4760 | Val  Acc: 0.4856
 Site-Indian                    (2) | Val  Loss: 1.7177 | Val  Acc: 0.3043
 Site-Indian                    (2) | Val  Loss: 1.6398 | Val  Acc: 0.3489
 Site-Southeast_Asian           (1) | Val  Loss: 1.6285 | Val  Acc: 0.3913
 Site-Southeast_Asian           (1) | Val  Loss: 1.5967 | Val  Acc: 0.4137
 Site-Middle_Eastern            (5) | Val  Loss: 1.5494 | Val  Acc: 0.5000
 Site-Middle_Eastern            (5) | Val  Loss: 1.5955 | Val  Acc: 0.4137
Average Valid Accuracy: 0.4124
 Best site-White                    (0)  | Epoch:5 | Val Acc: 0.3696
 Best site-White                    (0)  | Epoch:5 | Val Acc: 0.4029
 Best site-Latino_Hispanic          (0)  | Epoch:5 | Val Acc: 0.4022
 Best site-Latino_Hispanic          (2)  | Epoch:5 | Val Acc: 0.3597
 Best site-Black                    (6)  | Epoch:5 | Val Acc: 0.4565
 Best site-Black                    (4)  | Epoch:5 | Val Acc: 0.3921
 Best site-East_Asian               (3)  | Epoch:5 | Val Acc: 0.5326
 Best site-East_Asian               (3)  | Epoch:5 | Val Acc: 0.4856
 Best site-Indian                   (2)  | Epoch:5 | Val Acc: 0.3043
 Best site-Indian                   (2)  | Epoch:5 | Val Acc: 0.3489
 Best site-Southeast_Asian          (1)  | Epoch:5 | Val Acc: 0.3913
 Best site-Southeast_Asian          (1)  | Epoch:5 | Val Acc: 0.4137
 Best site-Middle_Eastern           (5)  | Epoch:5 | Val Acc: 0.5000
 Best site-Middle_Eastern           (5)  | Epoch:5 | Val Acc: 0.4137
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 3, 2, 1, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
quan_i=1.69, quan_c=1.66
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.5220 | Train Acc: 0.3885
 Site-White                    | Train Loss: 1.5315 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.6656 | Train Acc: 0.3309
 Site-Latino_Hispanic          | Train Loss: 1.7105 | Train Acc: 0.3501
 Site-Black                    | Train Loss: 1.7737 | Train Acc: 0.3022
 Site-Black                    | Train Loss: 1.7826 | Train Acc: 0.3309
 Site-East_Asian               | Train Loss: 1.5085 | Train Acc: 0.3957
 Site-East_Asian               | Train Loss: 1.5096 | Train Acc: 0.4652
 Site-Indian                   | Train Loss: 1.5482 | Train Acc: 0.4029
 Site-Indian                   | Train Loss: 1.5808 | Train Acc: 0.3693
 Site-Southeast_Asian          | Train Loss: 1.5746 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.6306 | Train Acc: 0.4221
 Site-Middle_Eastern           | Train Loss: 1.6114 | Train Acc: 0.4173
 Site-Middle_Eastern           | Train Loss: 1.5407 | Train Acc: 0.4341
 Site-White                     (4) | Val  Loss: 1.5747 | Val  Acc: 0.4022
 Site-White                     (0) | Val  Loss: 1.5514 | Val  Acc: 0.4101
 Site-Latino_Hispanic           (4) | Val  Loss: 1.6174 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (1) | Val  Loss: 1.6099 | Val  Acc: 0.3777
 Site-Black                     (6) | Val  Loss: 1.5960 | Val  Acc: 0.4674
 Site-Black                     (6) | Val  Loss: 1.6904 | Val  Acc: 0.3381
 Site-East_Asian                (5) | Val  Loss: 1.4315 | Val  Acc: 0.5109
 Site-East_Asian                (3) | Val  Loss: 1.4671 | Val  Acc: 0.4604
 Site-Indian                    (1) | Val  Loss: 1.6325 | Val  Acc: 0.3043
 Site-Indian                    (1) | Val  Loss: 1.6159 | Val  Acc: 0.3381
 Site-Southeast_Asian           (5) | Val  Loss: 1.5678 | Val  Acc: 0.4130
 Site-Southeast_Asian           (5) | Val  Loss: 1.5569 | Val  Acc: 0.4209
 Site-Middle_Eastern            (2) | Val  Loss: 1.5394 | Val  Acc: 0.4891
 Site-Middle_Eastern            (2) | Val  Loss: 1.5475 | Val  Acc: 0.4173
Average Valid Accuracy: 0.4108
============ Train epoch 7 ============
cnt=[1, 2, 2, 2, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
quan_i=1.69, quan_c=1.67
enlarge weight of clients:[3, 4, 5, ]
 Site-White                    | Train Loss: 1.4848 | Train Acc: 0.4245
 Site-White                    | Train Loss: 1.5591 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.6780 | Train Acc: 0.3237
 Site-Latino_Hispanic          | Train Loss: 1.5755 | Train Acc: 0.3717
 Site-Black                    | Train Loss: 1.7347 | Train Acc: 0.2950
 Site-Black                    | Train Loss: 1.6581 | Train Acc: 0.3549
 Site-East_Asian               | Train Loss: 1.4516 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.4741 | Train Acc: 0.4556
 Site-Indian                   | Train Loss: 1.4930 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.5545 | Train Acc: 0.3645
 Site-Southeast_Asian          | Train Loss: 1.5520 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.4876 | Train Acc: 0.4197
 Site-Middle_Eastern           | Train Loss: 1.5540 | Train Acc: 0.3525
 Site-Middle_Eastern           | Train Loss: 1.4441 | Train Acc: 0.4484
 Site-White                     (4) | Val  Loss: 1.5735 | Val  Acc: 0.3587
 Site-White                     (5) | Val  Loss: 1.5334 | Val  Acc: 0.4137
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5789 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (0) | Val  Loss: 1.6012 | Val  Acc: 0.3957
 Site-Black                     (3) | Val  Loss: 1.5291 | Val  Acc: 0.4457
 Site-Black                     (3) | Val  Loss: 1.6821 | Val  Acc: 0.3345
 Site-East_Asian                (1) | Val  Loss: 1.3849 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.4549 | Val  Acc: 0.4676
 Site-Indian                    (2) | Val  Loss: 1.6505 | Val  Acc: 0.3370
 Site-Indian                    (2) | Val  Loss: 1.6040 | Val  Acc: 0.3381
 Site-Southeast_Asian           (6) | Val  Loss: 1.5505 | Val  Acc: 0.4457
 Site-Southeast_Asian           (6) | Val  Loss: 1.5262 | Val  Acc: 0.4209
 Site-Middle_Eastern            (5) | Val  Loss: 1.4894 | Val  Acc: 0.4891
 Site-Middle_Eastern            (5) | Val  Loss: 1.5096 | Val  Acc: 0.4281
Average Valid Accuracy: 0.4150
 Best site-White                    (4)  | Epoch:7 | Val Acc: 0.3587
 Best site-White                    (5)  | Epoch:7 | Val Acc: 0.4137
 Best site-Latino_Hispanic          (4)  | Epoch:7 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (0)  | Epoch:7 | Val Acc: 0.3957
 Best site-Black                    (3)  | Epoch:7 | Val Acc: 0.4457
 Best site-Black                    (3)  | Epoch:7 | Val Acc: 0.3345
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.5000
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.4676
 Best site-Indian                   (2)  | Epoch:7 | Val Acc: 0.3370
 Best site-Indian                   (2)  | Epoch:7 | Val Acc: 0.3381
 Best site-Southeast_Asian          (6)  | Epoch:7 | Val Acc: 0.4457
 Best site-Southeast_Asian          (6)  | Epoch:7 | Val Acc: 0.4209
 Best site-Middle_Eastern           (5)  | Epoch:7 | Val Acc: 0.4891
 Best site-Middle_Eastern           (5)  | Epoch:7 | Val Acc: 0.4281
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 2, 1, 5, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
quan_i=1.62, quan_c=1.58
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.4743 | Train Acc: 0.4460
 Site-White                    | Train Loss: 1.4416 | Train Acc: 0.4293
 Site-Latino_Hispanic          | Train Loss: 1.6464 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.5537 | Train Acc: 0.3837
 Site-Black                    | Train Loss: 1.7348 | Train Acc: 0.3237
 Site-Black                    | Train Loss: 1.6408 | Train Acc: 0.3405
 Site-East_Asian               | Train Loss: 1.5028 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.4943 | Train Acc: 0.4652
 Site-Indian                   | Train Loss: 1.5166 | Train Acc: 0.4173
 Site-Indian                   | Train Loss: 1.7446 | Train Acc: 0.3693
 Site-Southeast_Asian          | Train Loss: 1.5314 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.5727 | Train Acc: 0.4317
 Site-Middle_Eastern           | Train Loss: 1.4532 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.4672 | Train Acc: 0.4101
 Site-White                     (0) | Val  Loss: 1.5111 | Val  Acc: 0.3913
 Site-White                     (6) | Val  Loss: 1.4884 | Val  Acc: 0.4424
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5833 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (3) | Val  Loss: 1.5524 | Val  Acc: 0.3921
 Site-Black                     (2) | Val  Loss: 1.5161 | Val  Acc: 0.4891
 Site-Black                     (5) | Val  Loss: 1.6629 | Val  Acc: 0.3561
 Site-East_Asian                (3) | Val  Loss: 1.3846 | Val  Acc: 0.4783
 Site-East_Asian                (3) | Val  Loss: 1.4305 | Val  Acc: 0.4640
 Site-Indian                    (4) | Val  Loss: 1.6524 | Val  Acc: 0.2826
 Site-Indian                    (4) | Val  Loss: 1.5793 | Val  Acc: 0.3453
 Site-Southeast_Asian           (3) | Val  Loss: 1.5126 | Val  Acc: 0.4348
 Site-Southeast_Asian           (3) | Val  Loss: 1.5050 | Val  Acc: 0.4245
 Site-Middle_Eastern            (1) | Val  Loss: 1.4682 | Val  Acc: 0.5109
 Site-Middle_Eastern            (1) | Val  Loss: 1.4980 | Val  Acc: 0.4317
Average Valid Accuracy: 0.4198
 Best site-White                    (0)  | Epoch:8 | Val Acc: 0.3913
 Best site-White                    (6)  | Epoch:8 | Val Acc: 0.4424
 Best site-Latino_Hispanic          (4)  | Epoch:8 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (3)  | Epoch:8 | Val Acc: 0.3921
 Best site-Black                    (2)  | Epoch:8 | Val Acc: 0.4891
 Best site-Black                    (5)  | Epoch:8 | Val Acc: 0.3561
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4783
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4640
 Best site-Indian                   (4)  | Epoch:8 | Val Acc: 0.2826
 Best site-Indian                   (4)  | Epoch:8 | Val Acc: 0.3453
 Best site-Southeast_Asian          (3)  | Epoch:8 | Val Acc: 0.4348
 Best site-Southeast_Asian          (3)  | Epoch:8 | Val Acc: 0.4245
 Best site-Middle_Eastern           (1)  | Epoch:8 | Val Acc: 0.5109
 Best site-Middle_Eastern           (1)  | Epoch:8 | Val Acc: 0.4317
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 9 ============
cnt=[4, 2, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
quan_i=1.67, quan_c=1.69
enlarge weight of clients:[9, ]
 Site-White                    | Train Loss: 1.4519 | Train Acc: 0.4388
 Site-White                    | Train Loss: 1.4594 | Train Acc: 0.4460
 Site-Latino_Hispanic          | Train Loss: 1.6316 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.5664 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.6553 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.6707 | Train Acc: 0.3237
 Site-East_Asian               | Train Loss: 1.4460 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3947 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.4477 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.5291 | Train Acc: 0.4125
 Site-Southeast_Asian          | Train Loss: 1.5121 | Train Acc: 0.5036
 Site-Southeast_Asian          | Train Loss: 1.6181 | Train Acc: 0.4365
 Site-Middle_Eastern           | Train Loss: 1.5120 | Train Acc: 0.4173
 Site-Middle_Eastern           | Train Loss: 1.4210 | Train Acc: 0.4412
 Site-White                     (4) | Val  Loss: 1.5259 | Val  Acc: 0.4130
 Site-White                     (5) | Val  Loss: 1.4598 | Val  Acc: 0.4568
 Site-Latino_Hispanic           (6) | Val  Loss: 1.5456 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5524 | Val  Acc: 0.3885
 Site-Black                     (1) | Val  Loss: 1.5200 | Val  Acc: 0.4891
 Site-Black                     (1) | Val  Loss: 1.6442 | Val  Acc: 0.3633
 Site-East_Asian                (0) | Val  Loss: 1.3407 | Val  Acc: 0.5000
 Site-East_Asian                (0) | Val  Loss: 1.4123 | Val  Acc: 0.5000
 Site-Indian                    (2) | Val  Loss: 1.5961 | Val  Acc: 0.3043
 Site-Indian                    (2) | Val  Loss: 1.5419 | Val  Acc: 0.3777
 Site-Southeast_Asian           (0) | Val  Loss: 1.4769 | Val  Acc: 0.4457
 Site-Southeast_Asian           (0) | Val  Loss: 1.4859 | Val  Acc: 0.4676
 Site-Middle_Eastern            (3) | Val  Loss: 1.4299 | Val  Acc: 0.5217
 Site-Middle_Eastern            (3) | Val  Loss: 1.4900 | Val  Acc: 0.4137
Average Valid Accuracy: 0.4356
 Best site-White                    (4)  | Epoch:9 | Val Acc: 0.4130
 Best site-White                    (5)  | Epoch:9 | Val Acc: 0.4568
 Best site-Latino_Hispanic          (6)  | Epoch:9 | Val Acc: 0.4565
 Best site-Latino_Hispanic          (4)  | Epoch:9 | Val Acc: 0.3885
 Best site-Black                    (1)  | Epoch:9 | Val Acc: 0.4891
 Best site-Black                    (1)  | Epoch:9 | Val Acc: 0.3633
 Best site-East_Asian               (0)  | Epoch:9 | Val Acc: 0.5000
 Best site-East_Asian               (0)  | Epoch:9 | Val Acc: 0.5000
 Best site-Indian                   (2)  | Epoch:9 | Val Acc: 0.3043
 Best site-Indian                   (2)  | Epoch:9 | Val Acc: 0.3777
 Best site-Southeast_Asian          (0)  | Epoch:9 | Val Acc: 0.4457
 Best site-Southeast_Asian          (0)  | Epoch:9 | Val Acc: 0.4676
 Best site-Middle_Eastern           (3)  | Epoch:9 | Val Acc: 0.5217
 Best site-Middle_Eastern           (3)  | Epoch:9 | Val Acc: 0.4137
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
 Test site-White                     (4)| Epoch:9 | Test Acc: 0.4305
 Test site-Latino_Hispanic           (6)| Epoch:9 | Test Acc: 0.3544
 Test site-Black                     (1)| Epoch:9 | Test Acc: 0.3219
 Test site-East_Asian                (0)| Epoch:9 | Test Acc: 0.4578
 Test site-Indian                    (2)| Epoch:9 | Test Acc: 0.3230
 Test site-Southeast_Asian           (0)| Epoch:9 | Test Acc: 0.4370
 Test site-Middle_Eastern            (3)| Epoch:9 | Test Acc: 0.3814
White: 0.4305, Latino_Hispanic: 0.3544, Black: 0.3219, East_Asian: 0.4578, Indian: 0.3230, Southeast_Asian: 0.4370, Middle_Eastern: 0.3814, 
Average Test Accuracy(group): 0.3866, Average Test Accuracy(individual): 0.3866,
domain std=0.0519, cluster std=nan, individual std=0.0519, 
============ Train epoch 10 ============
cnt=[2, 2, 1, 2, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
quan_i=1.64, quan_c=1.62
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.5393 | Train Acc: 0.4173
 Site-White                    | Train Loss: 1.3818 | Train Acc: 0.4532
 Site-Latino_Hispanic          | Train Loss: 1.6322 | Train Acc: 0.3381
 Site-Latino_Hispanic          | Train Loss: 1.4395 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.7248 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.6642 | Train Acc: 0.3621
 Site-East_Asian               | Train Loss: 1.4330 | Train Acc: 0.3957
 Site-East_Asian               | Train Loss: 1.4006 | Train Acc: 0.4652
 Site-Indian                   | Train Loss: 1.5159 | Train Acc: 0.4460
 Site-Indian                   | Train Loss: 1.5399 | Train Acc: 0.3933
 Site-Southeast_Asian          | Train Loss: 1.4736 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.5038 | Train Acc: 0.3957
 Site-Middle_Eastern           | Train Loss: 1.4526 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.4447 | Train Acc: 0.4460
 Site-White                     (6) | Val  Loss: 1.4704 | Val  Acc: 0.4348
 Site-White                     (6) | Val  Loss: 1.4565 | Val  Acc: 0.4424
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5353 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (6) | Val  Loss: 1.5305 | Val  Acc: 0.4245
 Site-Black                     (1) | Val  Loss: 1.4783 | Val  Acc: 0.4565
 Site-Black                     (1) | Val  Loss: 1.6376 | Val  Acc: 0.3417
 Site-East_Asian                (5) | Val  Loss: 1.3283 | Val  Acc: 0.5326
 Site-East_Asian                (5) | Val  Loss: 1.3958 | Val  Acc: 0.4784
 Site-Indian                    (0) | Val  Loss: 1.6088 | Val  Acc: 0.2826
 Site-Indian                    (0) | Val  Loss: 1.5434 | Val  Acc: 0.3813
 Site-Southeast_Asian           (3) | Val  Loss: 1.4311 | Val  Acc: 0.4348
 Site-Southeast_Asian           (3) | Val  Loss: 1.4511 | Val  Acc: 0.4353
 Site-Middle_Eastern            (2) | Val  Loss: 1.4884 | Val  Acc: 0.4891
 Site-Middle_Eastern            (6) | Val  Loss: 1.4709 | Val  Acc: 0.4604
Average Valid Accuracy: 0.4307
============ Train epoch 11 ============
cnt=[2, 3, 1, 2, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
quan_i=1.59, quan_c=1.56
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.4756 | Train Acc: 0.4604
 Site-White                    | Train Loss: 1.5072 | Train Acc: 0.4412
 Site-Latino_Hispanic          | Train Loss: 1.6143 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.4828 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.7501 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.5986 | Train Acc: 0.3717
 Site-East_Asian               | Train Loss: 1.4238 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.5268 | Train Acc: 0.4652
 Site-Indian                   | Train Loss: 1.4439 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.4725 | Train Acc: 0.4149
 Site-Southeast_Asian          | Train Loss: 1.4638 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.6048 | Train Acc: 0.4317
 Site-Middle_Eastern           | Train Loss: 1.5257 | Train Acc: 0.4245
 Site-Middle_Eastern           | Train Loss: 1.5187 | Train Acc: 0.4724
 Site-White                     (1) | Val  Loss: 1.5284 | Val  Acc: 0.4239
 Site-White                     (1) | Val  Loss: 1.4496 | Val  Acc: 0.4460
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5151 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5258 | Val  Acc: 0.4388
 Site-Black                     (6) | Val  Loss: 1.4067 | Val  Acc: 0.5217
 Site-Black                     (2) | Val  Loss: 1.5926 | Val  Acc: 0.3669
 Site-East_Asian                (4) | Val  Loss: 1.3199 | Val  Acc: 0.5652
 Site-East_Asian                (0) | Val  Loss: 1.3806 | Val  Acc: 0.5000
 Site-Indian                    (3) | Val  Loss: 1.5814 | Val  Acc: 0.3043
 Site-Indian                    (3) | Val  Loss: 1.5123 | Val  Acc: 0.3669
 Site-Southeast_Asian           (0) | Val  Loss: 1.4647 | Val  Acc: 0.4348
 Site-Southeast_Asian           (4) | Val  Loss: 1.4349 | Val  Acc: 0.4568
 Site-Middle_Eastern            (1) | Val  Loss: 1.4227 | Val  Acc: 0.5217
 Site-Middle_Eastern            (5) | Val  Loss: 1.4719 | Val  Acc: 0.4424
Average Valid Accuracy: 0.4446
 Best site-White                    (1)  | Epoch:11 | Val Acc: 0.4239
 Best site-White                    (1)  | Epoch:11 | Val Acc: 0.4460
 Best site-Latino_Hispanic          (4)  | Epoch:11 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (4)  | Epoch:11 | Val Acc: 0.4388
 Best site-Black                    (6)  | Epoch:11 | Val Acc: 0.5217
 Best site-Black                    (2)  | Epoch:11 | Val Acc: 0.3669
 Best site-East_Asian               (4)  | Epoch:11 | Val Acc: 0.5652
 Best site-East_Asian               (0)  | Epoch:11 | Val Acc: 0.5000
 Best site-Indian                   (3)  | Epoch:11 | Val Acc: 0.3043
 Best site-Indian                   (3)  | Epoch:11 | Val Acc: 0.3669
 Best site-Southeast_Asian          (0)  | Epoch:11 | Val Acc: 0.4348
 Best site-Southeast_Asian          (4)  | Epoch:11 | Val Acc: 0.4568
 Best site-Middle_Eastern           (1)  | Epoch:11 | Val Acc: 0.5217
 Best site-Middle_Eastern           (5)  | Epoch:11 | Val Acc: 0.4424
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 1, 3, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
quan_i=1.61, quan_c=1.58
enlarge weight of clients:[4, ]
 Site-White                    | Train Loss: 1.4533 | Train Acc: 0.4388
 Site-White                    | Train Loss: 1.3929 | Train Acc: 0.4604
 Site-Latino_Hispanic          | Train Loss: 1.5517 | Train Acc: 0.3741
 Site-Latino_Hispanic          | Train Loss: 1.5403 | Train Acc: 0.4365
 Site-Black                    | Train Loss: 1.8079 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.6091 | Train Acc: 0.3501
 Site-East_Asian               | Train Loss: 1.4774 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3152 | Train Acc: 0.4796
 Site-Indian                   | Train Loss: 1.3924 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.4785 | Train Acc: 0.4053
 Site-Southeast_Asian          | Train Loss: 1.5249 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.4497 | Train Acc: 0.4580
 Site-Middle_Eastern           | Train Loss: 1.4466 | Train Acc: 0.4317
 Site-Middle_Eastern           | Train Loss: 1.3929 | Train Acc: 0.4484
 Site-White                     (5) | Val  Loss: 1.4618 | Val  Acc: 0.4457
 Site-White                     (2) | Val  Loss: 1.4490 | Val  Acc: 0.4353
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5570 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5077 | Val  Acc: 0.4173
 Site-Black                     (1) | Val  Loss: 1.4393 | Val  Acc: 0.4891
 Site-Black                     (3) | Val  Loss: 1.6124 | Val  Acc: 0.3813
 Site-East_Asian                (6) | Val  Loss: 1.3236 | Val  Acc: 0.4783
 Site-East_Asian                (6) | Val  Loss: 1.3843 | Val  Acc: 0.5252
 Site-Indian                    (4) | Val  Loss: 1.5631 | Val  Acc: 0.2935
 Site-Indian                    (4) | Val  Loss: 1.4880 | Val  Acc: 0.4173
 Site-Southeast_Asian           (0) | Val  Loss: 1.4439 | Val  Acc: 0.4783
 Site-Southeast_Asian           (0) | Val  Loss: 1.4388 | Val  Acc: 0.4712
 Site-Middle_Eastern            (2) | Val  Loss: 1.4286 | Val  Acc: 0.4783
 Site-Middle_Eastern            (2) | Val  Loss: 1.4578 | Val  Acc: 0.4353
Average Valid Accuracy: 0.4422
============ Train epoch 13 ============
cnt=[3, 3, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
quan_i=1.56, quan_c=1.53
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.4789 | Train Acc: 0.4604
 Site-White                    | Train Loss: 1.4338 | Train Acc: 0.4868
 Site-Latino_Hispanic          | Train Loss: 1.6245 | Train Acc: 0.3885
 Site-Latino_Hispanic          | Train Loss: 1.6633 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.6698 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.6400 | Train Acc: 0.3717
 Site-East_Asian               | Train Loss: 1.4928 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.3639 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.4563 | Train Acc: 0.4460
 Site-Indian                   | Train Loss: 1.4792 | Train Acc: 0.4005
 Site-Southeast_Asian          | Train Loss: 1.4597 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.4659 | Train Acc: 0.4628
 Site-Middle_Eastern           | Train Loss: 1.4517 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.4781 | Train Acc: 0.4604
 Site-White                     (2) | Val  Loss: 1.4509 | Val  Acc: 0.4565
 Site-White                     (2) | Val  Loss: 1.4325 | Val  Acc: 0.4460
 Site-Latino_Hispanic           (5) | Val  Loss: 1.5170 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (0) | Val  Loss: 1.5046 | Val  Acc: 0.3993
 Site-Black                     (3) | Val  Loss: 1.4231 | Val  Acc: 0.4674
 Site-Black                     (3) | Val  Loss: 1.5851 | Val  Acc: 0.3813
 Site-East_Asian                (1) | Val  Loss: 1.3187 | Val  Acc: 0.5000
 Site-East_Asian                (6) | Val  Loss: 1.3587 | Val  Acc: 0.5108
 Site-Indian                    (0) | Val  Loss: 1.5390 | Val  Acc: 0.3587
 Site-Indian                    (0) | Val  Loss: 1.4742 | Val  Acc: 0.4424
 Site-Southeast_Asian           (1) | Val  Loss: 1.4852 | Val  Acc: 0.4130
 Site-Southeast_Asian           (1) | Val  Loss: 1.4331 | Val  Acc: 0.4532
 Site-Middle_Eastern            (4) | Val  Loss: 1.3982 | Val  Acc: 0.5217
 Site-Middle_Eastern            (4) | Val  Loss: 1.4579 | Val  Acc: 0.4388
Average Valid Accuracy: 0.4461
 Best site-White                    (2)  | Epoch:13 | Val Acc: 0.4565
 Best site-White                    (2)  | Epoch:13 | Val Acc: 0.4460
 Best site-Latino_Hispanic          (5)  | Epoch:13 | Val Acc: 0.4565
 Best site-Latino_Hispanic          (0)  | Epoch:13 | Val Acc: 0.3993
 Best site-Black                    (3)  | Epoch:13 | Val Acc: 0.4674
 Best site-Black                    (3)  | Epoch:13 | Val Acc: 0.3813
 Best site-East_Asian               (1)  | Epoch:13 | Val Acc: 0.5000
 Best site-East_Asian               (6)  | Epoch:13 | Val Acc: 0.5108
 Best site-Indian                   (0)  | Epoch:13 | Val Acc: 0.3587
 Best site-Indian                   (0)  | Epoch:13 | Val Acc: 0.4424
 Best site-Southeast_Asian          (1)  | Epoch:13 | Val Acc: 0.4130
 Best site-Southeast_Asian          (1)  | Epoch:13 | Val Acc: 0.4532
 Best site-Middle_Eastern           (4)  | Epoch:13 | Val Acc: 0.5217
 Best site-Middle_Eastern           (4)  | Epoch:13 | Val Acc: 0.4388
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 14 ============
cnt=[3, 2, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
quan_i=1.65, quan_c=1.57
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.4451 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.3568 | Train Acc: 0.4580
 Site-Latino_Hispanic          | Train Loss: 1.5799 | Train Acc: 0.3741
 Site-Latino_Hispanic          | Train Loss: 1.5315 | Train Acc: 0.4053
 Site-Black                    | Train Loss: 1.6883 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.5687 | Train Acc: 0.3765
 Site-East_Asian               | Train Loss: 1.4321 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3510 | Train Acc: 0.5012
 Site-Indian                   | Train Loss: 1.3966 | Train Acc: 0.4604
 Site-Indian                   | Train Loss: 1.5040 | Train Acc: 0.4269
 Site-Southeast_Asian          | Train Loss: 1.5205 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.5776 | Train Acc: 0.4221
 Site-Middle_Eastern           | Train Loss: 1.4228 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.3943 | Train Acc: 0.4460
 Site-White                     (4) | Val  Loss: 1.4599 | Val  Acc: 0.4457
 Site-White                     (6) | Val  Loss: 1.4119 | Val  Acc: 0.4353
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4742 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (0) | Val  Loss: 1.5064 | Val  Acc: 0.4101
 Site-Black                     (3) | Val  Loss: 1.4627 | Val  Acc: 0.4891
 Site-Black                     (3) | Val  Loss: 1.5967 | Val  Acc: 0.3633
 Site-East_Asian                (5) | Val  Loss: 1.2755 | Val  Acc: 0.5217
 Site-East_Asian                (5) | Val  Loss: 1.3406 | Val  Acc: 0.4964
 Site-Indian                    (0) | Val  Loss: 1.5782 | Val  Acc: 0.2826
 Site-Indian                    (0) | Val  Loss: 1.5018 | Val  Acc: 0.4065
 Site-Southeast_Asian           (1) | Val  Loss: 1.4578 | Val  Acc: 0.4239
 Site-Southeast_Asian           (1) | Val  Loss: 1.4354 | Val  Acc: 0.4496
 Site-Middle_Eastern            (2) | Val  Loss: 1.4202 | Val  Acc: 0.5543
 Site-Middle_Eastern            (2) | Val  Loss: 1.4343 | Val  Acc: 0.4496
Average Valid Accuracy: 0.4402
============ Train epoch 15 ============
cnt=[2, 2, 1, 2, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
quan_i=1.59, quan_c=1.58
enlarge weight of clients:[4, ]
 Site-White                    | Train Loss: 1.4060 | Train Acc: 0.4532
 Site-White                    | Train Loss: 1.4155 | Train Acc: 0.4556
 Site-Latino_Hispanic          | Train Loss: 1.6529 | Train Acc: 0.3885
 Site-Latino_Hispanic          | Train Loss: 1.4879 | Train Acc: 0.4029
 Site-Black                    | Train Loss: 1.6790 | Train Acc: 0.3597
 Site-Black                    | Train Loss: 1.7010 | Train Acc: 0.3573
 Site-East_Asian               | Train Loss: 1.4380 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3158 | Train Acc: 0.4916
 Site-Indian                   | Train Loss: 1.4313 | Train Acc: 0.4604
 Site-Indian                   | Train Loss: 1.4403 | Train Acc: 0.4436
 Site-Southeast_Asian          | Train Loss: 1.4258 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.5356 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.4774 | Train Acc: 0.4317
 Site-Middle_Eastern           | Train Loss: 1.3995 | Train Acc: 0.5012
 Site-White                     (4) | Val  Loss: 1.3908 | Val  Acc: 0.4783
 Site-White                     (4) | Val  Loss: 1.3993 | Val  Acc: 0.4676
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4738 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5070 | Val  Acc: 0.4137
 Site-Black                     (5) | Val  Loss: 1.4941 | Val  Acc: 0.4674
 Site-Black                     (2) | Val  Loss: 1.5860 | Val  Acc: 0.4029
 Site-East_Asian                (0) | Val  Loss: 1.2767 | Val  Acc: 0.5652
 Site-East_Asian                (0) | Val  Loss: 1.3483 | Val  Acc: 0.4856
 Site-Indian                    (6) | Val  Loss: 1.5574 | Val  Acc: 0.3261
 Site-Indian                    (6) | Val  Loss: 1.4855 | Val  Acc: 0.4137
 Site-Southeast_Asian           (3) | Val  Loss: 1.3891 | Val  Acc: 0.4674
 Site-Southeast_Asian           (3) | Val  Loss: 1.4380 | Val  Acc: 0.4604
 Site-Middle_Eastern            (1) | Val  Loss: 1.4121 | Val  Acc: 0.4674
 Site-Middle_Eastern            (1) | Val  Loss: 1.4419 | Val  Acc: 0.4676
Average Valid Accuracy: 0.4505
 Best site-White                    (4)  | Epoch:15 | Val Acc: 0.4783
 Best site-White                    (4)  | Epoch:15 | Val Acc: 0.4676
 Best site-Latino_Hispanic          (4)  | Epoch:15 | Val Acc: 0.4239
 Best site-Latino_Hispanic          (4)  | Epoch:15 | Val Acc: 0.4137
 Best site-Black                    (5)  | Epoch:15 | Val Acc: 0.4674
 Best site-Black                    (2)  | Epoch:15 | Val Acc: 0.4029
 Best site-East_Asian               (0)  | Epoch:15 | Val Acc: 0.5652
 Best site-East_Asian               (0)  | Epoch:15 | Val Acc: 0.4856
 Best site-Indian                   (6)  | Epoch:15 | Val Acc: 0.3261
 Best site-Indian                   (6)  | Epoch:15 | Val Acc: 0.4137
 Best site-Southeast_Asian          (3)  | Epoch:15 | Val Acc: 0.4674
 Best site-Southeast_Asian          (3)  | Epoch:15 | Val Acc: 0.4604
 Best site-Middle_Eastern           (1)  | Epoch:15 | Val Acc: 0.4674
 Best site-Middle_Eastern           (1)  | Epoch:15 | Val Acc: 0.4676
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 16 ============
cnt=[1, 1, 4, 2, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
quan_i=1.59, quan_c=1.56
enlarge weight of clients:[2, 4, 5, ]
 Site-White                    | Train Loss: 1.5082 | Train Acc: 0.4676
 Site-White                    | Train Loss: 1.3303 | Train Acc: 0.4700
 Site-Latino_Hispanic          | Train Loss: 1.5762 | Train Acc: 0.3957
 Site-Latino_Hispanic          | Train Loss: 1.4237 | Train Acc: 0.3909
 Site-Black                    | Train Loss: 1.6929 | Train Acc: 0.3381
 Site-Black                    | Train Loss: 1.5469 | Train Acc: 0.3837
 Site-East_Asian               | Train Loss: 1.3398 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3508 | Train Acc: 0.4940
 Site-Indian                   | Train Loss: 1.3992 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.5246 | Train Acc: 0.4101
 Site-Southeast_Asian          | Train Loss: 1.4737 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.6304 | Train Acc: 0.4676
 Site-Middle_Eastern           | Train Loss: 1.4460 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.3975 | Train Acc: 0.4772
 Site-White                     (4) | Val  Loss: 1.4374 | Val  Acc: 0.4783
 Site-White                     (4) | Val  Loss: 1.3855 | Val  Acc: 0.4784
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4827 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4792 | Val  Acc: 0.4173
 Site-Black                     (3) | Val  Loss: 1.4280 | Val  Acc: 0.5109
 Site-Black                     (3) | Val  Loss: 1.5415 | Val  Acc: 0.4101
 Site-East_Asian                (2) | Val  Loss: 1.3094 | Val  Acc: 0.5435
 Site-East_Asian                (2) | Val  Loss: 1.3537 | Val  Acc: 0.5072
 Site-Indian                    (6) | Val  Loss: 1.5799 | Val  Acc: 0.3261
 Site-Indian                    (6) | Val  Loss: 1.4692 | Val  Acc: 0.4137
 Site-Southeast_Asian           (2) | Val  Loss: 1.3949 | Val  Acc: 0.4348
 Site-Southeast_Asian           (2) | Val  Loss: 1.4263 | Val  Acc: 0.4604
 Site-Middle_Eastern            (5) | Val  Loss: 1.3972 | Val  Acc: 0.5217
 Site-Middle_Eastern            (0) | Val  Loss: 1.4078 | Val  Acc: 0.4712
Average Valid Accuracy: 0.4577
 Best site-White                    (4)  | Epoch:16 | Val Acc: 0.4783
 Best site-White                    (4)  | Epoch:16 | Val Acc: 0.4784
 Best site-Latino_Hispanic          (1)  | Epoch:16 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (6)  | Epoch:16 | Val Acc: 0.4173
 Best site-Black                    (3)  | Epoch:16 | Val Acc: 0.5109
 Best site-Black                    (3)  | Epoch:16 | Val Acc: 0.4101
 Best site-East_Asian               (2)  | Epoch:16 | Val Acc: 0.5435
 Best site-East_Asian               (2)  | Epoch:16 | Val Acc: 0.5072
 Best site-Indian                   (6)  | Epoch:16 | Val Acc: 0.3261
 Best site-Indian                   (6)  | Epoch:16 | Val Acc: 0.4137
 Best site-Southeast_Asian          (2)  | Epoch:16 | Val Acc: 0.4348
 Best site-Southeast_Asian          (2)  | Epoch:16 | Val Acc: 0.4604
 Best site-Middle_Eastern           (5)  | Epoch:16 | Val Acc: 0.5217
 Best site-Middle_Eastern           (0)  | Epoch:16 | Val Acc: 0.4712
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 17 ============
cnt=[3, 1, 4, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
quan_i=1.57, quan_c=1.55
enlarge weight of clients:[4, ]
 Site-White                    | Train Loss: 1.4071 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.2889 | Train Acc: 0.4652
 Site-Latino_Hispanic          | Train Loss: 1.6092 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.4911 | Train Acc: 0.4269
 Site-Black                    | Train Loss: 1.6164 | Train Acc: 0.3597
 Site-Black                    | Train Loss: 1.6658 | Train Acc: 0.3861
 Site-East_Asian               | Train Loss: 1.4316 | Train Acc: 0.4101
 Site-East_Asian               | Train Loss: 1.3023 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.4341 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.4654 | Train Acc: 0.4245
 Site-Southeast_Asian          | Train Loss: 1.4978 | Train Acc: 0.5108
 Site-Southeast_Asian          | Train Loss: 1.4468 | Train Acc: 0.4580
 Site-Middle_Eastern           | Train Loss: 1.4617 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.3193 | Train Acc: 0.4676
 Site-White                     (3) | Val  Loss: 1.4354 | Val  Acc: 0.4239
 Site-White                     (6) | Val  Loss: 1.3770 | Val  Acc: 0.4748
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4700 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4948 | Val  Acc: 0.3993
 Site-Black                     (1) | Val  Loss: 1.4376 | Val  Acc: 0.4783
 Site-Black                     (5) | Val  Loss: 1.5434 | Val  Acc: 0.3957
 Site-East_Asian                (0) | Val  Loss: 1.2904 | Val  Acc: 0.5326
 Site-East_Asian                (0) | Val  Loss: 1.3183 | Val  Acc: 0.5108
 Site-Indian                    (2) | Val  Loss: 1.5307 | Val  Acc: 0.3913
 Site-Indian                    (2) | Val  Loss: 1.4672 | Val  Acc: 0.4245
 Site-Southeast_Asian           (0) | Val  Loss: 1.3920 | Val  Acc: 0.4130
 Site-Southeast_Asian           (2) | Val  Loss: 1.3933 | Val  Acc: 0.4568
 Site-Middle_Eastern            (4) | Val  Loss: 1.4410 | Val  Acc: 0.4783
 Site-Middle_Eastern            (4) | Val  Loss: 1.4135 | Val  Acc: 0.4604
Average Valid Accuracy: 0.4482
============ Train epoch 18 ============
cnt=[3, 1, 4, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
quan_i=1.55, quan_c=1.49
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.4177 | Train Acc: 0.4676
 Site-White                    | Train Loss: 1.3309 | Train Acc: 0.4436
 Site-Latino_Hispanic          | Train Loss: 1.5524 | Train Acc: 0.4388
 Site-Latino_Hispanic          | Train Loss: 1.3815 | Train Acc: 0.4341
 Site-Black                    | Train Loss: 1.7378 | Train Acc: 0.3381
 Site-Black                    | Train Loss: 1.5365 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.4208 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.2935 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.3957 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.4702 | Train Acc: 0.4077
 Site-Southeast_Asian          | Train Loss: 1.4553 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.4136 | Train Acc: 0.4484
 Site-Middle_Eastern           | Train Loss: 1.4915 | Train Acc: 0.4101
 Site-Middle_Eastern           | Train Loss: 1.4586 | Train Acc: 0.4964
 Site-White                     (6) | Val  Loss: 1.3933 | Val  Acc: 0.4565
 Site-White                     (0) | Val  Loss: 1.3992 | Val  Acc: 0.4424
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4732 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4706 | Val  Acc: 0.4245
 Site-Black                     (4) | Val  Loss: 1.4103 | Val  Acc: 0.4783
 Site-Black                     (4) | Val  Loss: 1.5985 | Val  Acc: 0.3705
 Site-East_Asian                (5) | Val  Loss: 1.2868 | Val  Acc: 0.5000
 Site-East_Asian                (5) | Val  Loss: 1.3394 | Val  Acc: 0.4964
 Site-Indian                    (3) | Val  Loss: 1.5236 | Val  Acc: 0.3152
 Site-Indian                    (1) | Val  Loss: 1.4601 | Val  Acc: 0.4065
 Site-Southeast_Asian           (2) | Val  Loss: 1.3915 | Val  Acc: 0.4565
 Site-Southeast_Asian           (2) | Val  Loss: 1.3815 | Val  Acc: 0.4748
 Site-Middle_Eastern            (0) | Val  Loss: 1.3820 | Val  Acc: 0.5543
 Site-Middle_Eastern            (0) | Val  Loss: 1.4227 | Val  Acc: 0.4281
Average Valid Accuracy: 0.4441
============ Train epoch 19 ============
cnt=[1, 2, 3, 2, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
quan_i=1.51, quan_c=1.48
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.3724 | Train Acc: 0.4892
 Site-White                    | Train Loss: 1.3527 | Train Acc: 0.4988
 Site-Latino_Hispanic          | Train Loss: 1.5439 | Train Acc: 0.4388
 Site-Latino_Hispanic          | Train Loss: 1.4404 | Train Acc: 0.4269
 Site-Black                    | Train Loss: 1.7006 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.5915 | Train Acc: 0.3717
 Site-East_Asian               | Train Loss: 1.3808 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.4093 | Train Acc: 0.4796
 Site-Indian                   | Train Loss: 1.3368 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.5142 | Train Acc: 0.4077
 Site-Southeast_Asian          | Train Loss: 1.4553 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.5051 | Train Acc: 0.4580
 Site-Middle_Eastern           | Train Loss: 1.4300 | Train Acc: 0.4173
 Site-Middle_Eastern           | Train Loss: 1.3223 | Train Acc: 0.4988
 Site-White                     (5) | Val  Loss: 1.3742 | Val  Acc: 0.4674
 Site-White                     (5) | Val  Loss: 1.4045 | Val  Acc: 0.4748
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4566 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4575 | Val  Acc: 0.4317
 Site-Black                     (1) | Val  Loss: 1.4538 | Val  Acc: 0.4239
 Site-Black                     (1) | Val  Loss: 1.5446 | Val  Acc: 0.4029
 Site-East_Asian                (2) | Val  Loss: 1.2675 | Val  Acc: 0.5543
 Site-East_Asian                (0) | Val  Loss: 1.3430 | Val  Acc: 0.5108
 Site-Indian                    (6) | Val  Loss: 1.4932 | Val  Acc: 0.3478
 Site-Indian                    (6) | Val  Loss: 1.4527 | Val  Acc: 0.4496
 Site-Southeast_Asian           (2) | Val  Loss: 1.4070 | Val  Acc: 0.4891
 Site-Southeast_Asian           (2) | Val  Loss: 1.3970 | Val  Acc: 0.4568
 Site-Middle_Eastern            (3) | Val  Loss: 1.3906 | Val  Acc: 0.5000
 Site-Middle_Eastern            (3) | Val  Loss: 1.3842 | Val  Acc: 0.4712
Average Valid Accuracy: 0.4598
 Best site-White                    (5)  | Epoch:19 | Val Acc: 0.4674
 Best site-White                    (5)  | Epoch:19 | Val Acc: 0.4748
 Best site-Latino_Hispanic          (6)  | Epoch:19 | Val Acc: 0.4565
 Best site-Latino_Hispanic          (4)  | Epoch:19 | Val Acc: 0.4317
 Best site-Black                    (1)  | Epoch:19 | Val Acc: 0.4239
 Best site-Black                    (1)  | Epoch:19 | Val Acc: 0.4029
 Best site-East_Asian               (2)  | Epoch:19 | Val Acc: 0.5543
 Best site-East_Asian               (0)  | Epoch:19 | Val Acc: 0.5108
 Best site-Indian                   (6)  | Epoch:19 | Val Acc: 0.3478
 Best site-Indian                   (6)  | Epoch:19 | Val Acc: 0.4496
 Best site-Southeast_Asian          (2)  | Epoch:19 | Val Acc: 0.4891
 Best site-Southeast_Asian          (2)  | Epoch:19 | Val Acc: 0.4568
 Best site-Middle_Eastern           (3)  | Epoch:19 | Val Acc: 0.5000
 Best site-Middle_Eastern           (3)  | Epoch:19 | Val Acc: 0.4712
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
 Test site-White                     (5)| Epoch:19 | Test Acc: 0.4332
 Test site-Latino_Hispanic           (6)| Epoch:19 | Test Acc: 0.3671
 Test site-Black                     (1)| Epoch:19 | Test Acc: 0.3219
 Test site-East_Asian                (2)| Epoch:19 | Test Acc: 0.4903
 Test site-Indian                    (6)| Epoch:19 | Test Acc: 0.3397
 Test site-Southeast_Asian           (2)| Epoch:19 | Test Acc: 0.4222
 Test site-Middle_Eastern            (3)| Epoch:19 | Test Acc: 0.4278
White: 0.4332, Latino_Hispanic: 0.3671, Black: 0.3219, East_Asian: 0.4903, Indian: 0.3397, Southeast_Asian: 0.4222, Middle_Eastern: 0.4278, 
Average Test Accuracy(group): 0.4003, Average Test Accuracy(individual): 0.4003,
domain std=0.0552, cluster std=nan, individual std=0.0552, 
============ Train epoch 20 ============
cnt=[3, 6, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
quan_i=1.53, quan_c=1.49
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.3961 | Train Acc: 0.4532
 Site-White                    | Train Loss: 1.3073 | Train Acc: 0.4964
 Site-Latino_Hispanic          | Train Loss: 1.5733 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.4808 | Train Acc: 0.4341
 Site-Black                    | Train Loss: 1.6253 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.5177 | Train Acc: 0.4005
 Site-East_Asian               | Train Loss: 1.4053 | Train Acc: 0.4029
 Site-East_Asian               | Train Loss: 1.4481 | Train Acc: 0.4868
 Site-Indian                   | Train Loss: 1.3290 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.4239 | Train Acc: 0.4245
 Site-Southeast_Asian          | Train Loss: 1.4410 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.4706 | Train Acc: 0.4700
 Site-Middle_Eastern           | Train Loss: 1.4251 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.3131 | Train Acc: 0.4652
 Site-White                     (0) | Val  Loss: 1.4146 | Val  Acc: 0.4674
 Site-White                     (5) | Val  Loss: 1.3685 | Val  Acc: 0.5036
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4724 | Val  Acc: 0.3913
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4560 | Val  Acc: 0.4317
 Site-Black                     (2) | Val  Loss: 1.3924 | Val  Acc: 0.5000
 Site-Black                     (6) | Val  Loss: 1.5057 | Val  Acc: 0.4388
 Site-East_Asian                (4) | Val  Loss: 1.2825 | Val  Acc: 0.5326
 Site-East_Asian                (3) | Val  Loss: 1.3432 | Val  Acc: 0.5216
 Site-Indian                    (1) | Val  Loss: 1.5179 | Val  Acc: 0.3696
 Site-Indian                    (1) | Val  Loss: 1.4570 | Val  Acc: 0.4173
 Site-Southeast_Asian           (1) | Val  Loss: 1.4158 | Val  Acc: 0.4457
 Site-Southeast_Asian           (1) | Val  Loss: 1.3935 | Val  Acc: 0.4856
 Site-Middle_Eastern            (0) | Val  Loss: 1.3852 | Val  Acc: 0.4891
 Site-Middle_Eastern            (0) | Val  Loss: 1.3912 | Val  Acc: 0.4712
Average Valid Accuracy: 0.4618
 Best site-White                    (0)  | Epoch:20 | Val Acc: 0.4674
 Best site-White                    (5)  | Epoch:20 | Val Acc: 0.5036
 Best site-Latino_Hispanic          (1)  | Epoch:20 | Val Acc: 0.3913
 Best site-Latino_Hispanic          (1)  | Epoch:20 | Val Acc: 0.4317
 Best site-Black                    (2)  | Epoch:20 | Val Acc: 0.5000
 Best site-Black                    (6)  | Epoch:20 | Val Acc: 0.4388
 Best site-East_Asian               (4)  | Epoch:20 | Val Acc: 0.5326
 Best site-East_Asian               (3)  | Epoch:20 | Val Acc: 0.5216
 Best site-Indian                   (1)  | Epoch:20 | Val Acc: 0.3696
 Best site-Indian                   (1)  | Epoch:20 | Val Acc: 0.4173
 Best site-Southeast_Asian          (1)  | Epoch:20 | Val Acc: 0.4457
 Best site-Southeast_Asian          (1)  | Epoch:20 | Val Acc: 0.4856
 Best site-Middle_Eastern           (0)  | Epoch:20 | Val Acc: 0.4891
 Best site-Middle_Eastern           (0)  | Epoch:20 | Val Acc: 0.4712
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 21 ============
cnt=[4, 5, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
quan_i=1.51, quan_c=1.49
enlarge weight of clients:[2, 4, 5, ]
 Site-White                    | Train Loss: 1.3242 | Train Acc: 0.4820
 Site-White                    | Train Loss: 1.3317 | Train Acc: 0.4916
 Site-Latino_Hispanic          | Train Loss: 1.5520 | Train Acc: 0.4460
 Site-Latino_Hispanic          | Train Loss: 1.4621 | Train Acc: 0.4197
 Site-Black                    | Train Loss: 1.6876 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.5728 | Train Acc: 0.4029
 Site-East_Asian               | Train Loss: 1.3988 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.2428 | Train Acc: 0.4988
 Site-Indian                   | Train Loss: 1.3090 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.5247 | Train Acc: 0.4173
 Site-Southeast_Asian          | Train Loss: 1.3930 | Train Acc: 0.4892
 Site-Southeast_Asian          | Train Loss: 1.4229 | Train Acc: 0.4772
 Site-Middle_Eastern           | Train Loss: 1.4760 | Train Acc: 0.4676
 Site-Middle_Eastern           | Train Loss: 1.3293 | Train Acc: 0.4964
 Site-White                     (0) | Val  Loss: 1.3390 | Val  Acc: 0.5000
 Site-White                     (0) | Val  Loss: 1.3721 | Val  Acc: 0.4604
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4623 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4792 | Val  Acc: 0.3993
 Site-Black                     (6) | Val  Loss: 1.3408 | Val  Acc: 0.5109
 Site-Black                     (2) | Val  Loss: 1.5038 | Val  Acc: 0.3849
 Site-East_Asian                (3) | Val  Loss: 1.2500 | Val  Acc: 0.4783
 Site-East_Asian                (5) | Val  Loss: 1.3358 | Val  Acc: 0.4784
 Site-Indian                    (1) | Val  Loss: 1.5355 | Val  Acc: 0.3587
 Site-Indian                    (1) | Val  Loss: 1.4430 | Val  Acc: 0.4281
 Site-Southeast_Asian           (1) | Val  Loss: 1.4136 | Val  Acc: 0.4891
 Site-Southeast_Asian           (1) | Val  Loss: 1.3443 | Val  Acc: 0.5072
 Site-Middle_Eastern            (0) | Val  Loss: 1.3835 | Val  Acc: 0.4783
 Site-Middle_Eastern            (0) | Val  Loss: 1.3819 | Val  Acc: 0.4496
Average Valid Accuracy: 0.4518
============ Train epoch 22 ============
cnt=[2, 4, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
quan_i=1.55, quan_c=1.51
enlarge weight of clients:[2, 4, 5, ]
 Site-White                    | Train Loss: 1.3316 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.4029 | Train Acc: 0.4628
 Site-Latino_Hispanic          | Train Loss: 1.5304 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.3484 | Train Acc: 0.4293
 Site-Black                    | Train Loss: 1.6806 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.4941 | Train Acc: 0.3861
 Site-East_Asian               | Train Loss: 1.4136 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.4007 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.3619 | Train Acc: 0.5324
 Site-Indian                   | Train Loss: 1.3809 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.4354 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.3207 | Train Acc: 0.4844
 Site-Middle_Eastern           | Train Loss: 1.4406 | Train Acc: 0.4676
 Site-Middle_Eastern           | Train Loss: 1.3277 | Train Acc: 0.4772
 Site-White                     (0) | Val  Loss: 1.4006 | Val  Acc: 0.4674
 Site-White                     (0) | Val  Loss: 1.3894 | Val  Acc: 0.4604
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4280 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4398 | Val  Acc: 0.4353
 Site-Black                     (4) | Val  Loss: 1.3541 | Val  Acc: 0.5435
 Site-Black                     (4) | Val  Loss: 1.5013 | Val  Acc: 0.4245
 Site-East_Asian                (1) | Val  Loss: 1.2807 | Val  Acc: 0.5435
 Site-East_Asian                (6) | Val  Loss: 1.3277 | Val  Acc: 0.5036
 Site-Indian                    (2) | Val  Loss: 1.5063 | Val  Acc: 0.3696
 Site-Indian                    (2) | Val  Loss: 1.4212 | Val  Acc: 0.4317
 Site-Southeast_Asian           (1) | Val  Loss: 1.3554 | Val  Acc: 0.5000
 Site-Southeast_Asian           (1) | Val  Loss: 1.3757 | Val  Acc: 0.4532
 Site-Middle_Eastern            (3) | Val  Loss: 1.3786 | Val  Acc: 0.4891
 Site-Middle_Eastern            (3) | Val  Loss: 1.4082 | Val  Acc: 0.4424
Average Valid Accuracy: 0.4627
 Best site-White                    (0)  | Epoch:22 | Val Acc: 0.4674
 Best site-White                    (0)  | Epoch:22 | Val Acc: 0.4604
 Best site-Latino_Hispanic          (5)  | Epoch:22 | Val Acc: 0.4130
 Best site-Latino_Hispanic          (1)  | Epoch:22 | Val Acc: 0.4353
 Best site-Black                    (4)  | Epoch:22 | Val Acc: 0.5435
 Best site-Black                    (4)  | Epoch:22 | Val Acc: 0.4245
 Best site-East_Asian               (1)  | Epoch:22 | Val Acc: 0.5435
 Best site-East_Asian               (6)  | Epoch:22 | Val Acc: 0.5036
 Best site-Indian                   (2)  | Epoch:22 | Val Acc: 0.3696
 Best site-Indian                   (2)  | Epoch:22 | Val Acc: 0.4317
 Best site-Southeast_Asian          (1)  | Epoch:22 | Val Acc: 0.5000
 Best site-Southeast_Asian          (1)  | Epoch:22 | Val Acc: 0.4532
 Best site-Middle_Eastern           (3)  | Epoch:22 | Val Acc: 0.4891
 Best site-Middle_Eastern           (3)  | Epoch:22 | Val Acc: 0.4424
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 23 ============
cnt=[2, 2, 3, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
quan_i=1.48, quan_c=1.41
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.3382 | Train Acc: 0.5108
 Site-White                    | Train Loss: 1.3089 | Train Acc: 0.4604
 Site-Latino_Hispanic          | Train Loss: 1.5071 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.4478 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.6337 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.5093 | Train Acc: 0.3837
 Site-East_Asian               | Train Loss: 1.3750 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3592 | Train Acc: 0.4844
 Site-Indian                   | Train Loss: 1.3275 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.4094 | Train Acc: 0.3981
 Site-Southeast_Asian          | Train Loss: 1.4850 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.4311 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.3451 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.5379 | Train Acc: 0.4724
 Site-White                     (2) | Val  Loss: 1.3449 | Val  Acc: 0.4891
 Site-White                     (6) | Val  Loss: 1.3698 | Val  Acc: 0.4784
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4624 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4244 | Val  Acc: 0.4388
 Site-Black                     (1) | Val  Loss: 1.3687 | Val  Acc: 0.5217
 Site-Black                     (1) | Val  Loss: 1.4957 | Val  Acc: 0.4496
 Site-East_Asian                (5) | Val  Loss: 1.2284 | Val  Acc: 0.5761
 Site-East_Asian                (5) | Val  Loss: 1.2966 | Val  Acc: 0.4928
 Site-Indian                    (3) | Val  Loss: 1.5505 | Val  Acc: 0.4130
 Site-Indian                    (3) | Val  Loss: 1.4523 | Val  Acc: 0.4424
 Site-Southeast_Asian           (4) | Val  Loss: 1.3833 | Val  Acc: 0.4674
 Site-Southeast_Asian           (4) | Val  Loss: 1.3523 | Val  Acc: 0.4892
 Site-Middle_Eastern            (2) | Val  Loss: 1.4004 | Val  Acc: 0.4891
 Site-Middle_Eastern            (2) | Val  Loss: 1.3837 | Val  Acc: 0.4532
Average Valid Accuracy: 0.4755
 Best site-White                    (2)  | Epoch:23 | Val Acc: 0.4891
 Best site-White                    (6)  | Epoch:23 | Val Acc: 0.4784
 Best site-Latino_Hispanic          (0)  | Epoch:23 | Val Acc: 0.4565
 Best site-Latino_Hispanic          (0)  | Epoch:23 | Val Acc: 0.4388
 Best site-Black                    (1)  | Epoch:23 | Val Acc: 0.5217
 Best site-Black                    (1)  | Epoch:23 | Val Acc: 0.4496
 Best site-East_Asian               (5)  | Epoch:23 | Val Acc: 0.5761
 Best site-East_Asian               (5)  | Epoch:23 | Val Acc: 0.4928
 Best site-Indian                   (3)  | Epoch:23 | Val Acc: 0.4130
 Best site-Indian                   (3)  | Epoch:23 | Val Acc: 0.4424
 Best site-Southeast_Asian          (4)  | Epoch:23 | Val Acc: 0.4674
 Best site-Southeast_Asian          (4)  | Epoch:23 | Val Acc: 0.4892
 Best site-Middle_Eastern           (2)  | Epoch:23 | Val Acc: 0.4891
 Best site-Middle_Eastern           (2)  | Epoch:23 | Val Acc: 0.4532
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 24 ============
cnt=[1, 2, 3, 2, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
quan_i=1.52, quan_c=1.49
enlarge weight of clients:[]
 Site-White                    | Train Loss: 1.3922 | Train Acc: 0.4892
 Site-White                    | Train Loss: 1.3137 | Train Acc: 0.4748
 Site-Latino_Hispanic          | Train Loss: 1.5059 | Train Acc: 0.4317
 Site-Latino_Hispanic          | Train Loss: 1.4124 | Train Acc: 0.4269
 Site-Black                    | Train Loss: 1.5850 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.5404 | Train Acc: 0.3933
 Site-East_Asian               | Train Loss: 1.3502 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3389 | Train Acc: 0.4988
 Site-Indian                   | Train Loss: 1.3206 | Train Acc: 0.4604
 Site-Indian                   | Train Loss: 1.4304 | Train Acc: 0.4173
 Site-Southeast_Asian          | Train Loss: 1.4050 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.3999 | Train Acc: 0.4652
 Site-Middle_Eastern           | Train Loss: 1.3686 | Train Acc: 0.4317
 Site-Middle_Eastern           | Train Loss: 1.3541 | Train Acc: 0.4988
 Site-White                     (2) | Val  Loss: 1.3623 | Val  Acc: 0.4565
 Site-White                     (2) | Val  Loss: 1.3834 | Val  Acc: 0.4784
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4612 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4341 | Val  Acc: 0.3957
 Site-Black                     (4) | Val  Loss: 1.3471 | Val  Acc: 0.5109
 Site-Black                     (5) | Val  Loss: 1.4957 | Val  Acc: 0.4460
 Site-East_Asian                (6) | Val  Loss: 1.2426 | Val  Acc: 0.5109
 Site-East_Asian                (1) | Val  Loss: 1.3077 | Val  Acc: 0.5324
 Site-Indian                    (4) | Val  Loss: 1.4849 | Val  Acc: 0.3587
 Site-Indian                    (4) | Val  Loss: 1.4434 | Val  Acc: 0.4281
 Site-Southeast_Asian           (1) | Val  Loss: 1.3998 | Val  Acc: 0.4565
 Site-Southeast_Asian           (6) | Val  Loss: 1.3480 | Val  Acc: 0.4784
 Site-Middle_Eastern            (3) | Val  Loss: 1.3446 | Val  Acc: 0.5109
 Site-Middle_Eastern            (3) | Val  Loss: 1.3383 | Val  Acc: 0.4712
Average Valid Accuracy: 0.4636
============ Train epoch 25 ============
cnt=[2, 3, 1, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
quan_i=1.48, quan_c=1.46
enlarge weight of clients:[2, 4, 5, ]
 Site-White                    | Train Loss: 1.3513 | Train Acc: 0.4460
 Site-White                    | Train Loss: 1.3957 | Train Acc: 0.4868
 Site-Latino_Hispanic          | Train Loss: 1.5012 | Train Acc: 0.3957
 Site-Latino_Hispanic          | Train Loss: 1.4459 | Train Acc: 0.4341
 Site-Black                    | Train Loss: 1.6469 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.5629 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.3928 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3084 | Train Acc: 0.4916
 Site-Indian                   | Train Loss: 1.4014 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.4259 | Train Acc: 0.4652
 Site-Southeast_Asian          | Train Loss: 1.4863 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.4149 | Train Acc: 0.4700
 Site-Middle_Eastern           | Train Loss: 1.3987 | Train Acc: 0.4317
 Site-Middle_Eastern           | Train Loss: 1.2889 | Train Acc: 0.4820
 Site-White                     (0) | Val  Loss: 1.3535 | Val  Acc: 0.4783
 Site-White                     (0) | Val  Loss: 1.3493 | Val  Acc: 0.4820
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4799 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4239 | Val  Acc: 0.4460
 Site-Black                     (5) | Val  Loss: 1.3331 | Val  Acc: 0.5109
 Site-Black                     (5) | Val  Loss: 1.4790 | Val  Acc: 0.4496
 Site-East_Asian                (2) | Val  Loss: 1.2438 | Val  Acc: 0.5326
 Site-East_Asian                (4) | Val  Loss: 1.2945 | Val  Acc: 0.5360
 Site-Indian                    (1) | Val  Loss: 1.4340 | Val  Acc: 0.3587
 Site-Indian                    (1) | Val  Loss: 1.4666 | Val  Acc: 0.4065
 Site-Southeast_Asian           (4) | Val  Loss: 1.3827 | Val  Acc: 0.4891
 Site-Southeast_Asian           (4) | Val  Loss: 1.3909 | Val  Acc: 0.4496
 Site-Middle_Eastern            (3) | Val  Loss: 1.3839 | Val  Acc: 0.5326
 Site-Middle_Eastern            (3) | Val  Loss: 1.3560 | Val  Acc: 0.4856
Average Valid Accuracy: 0.4693
============ Train epoch 26 ============
cnt=[2, 2, 3, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
quan_i=1.50, quan_c=1.45
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.3566 | Train Acc: 0.5180
 Site-White                    | Train Loss: 1.2972 | Train Acc: 0.4796
 Site-Latino_Hispanic          | Train Loss: 1.5455 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.5438 | Train Acc: 0.4460
 Site-Black                    | Train Loss: 1.6068 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.4939 | Train Acc: 0.3909
 Site-East_Asian               | Train Loss: 1.3262 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.2633 | Train Acc: 0.5084
 Site-Indian                   | Train Loss: 1.3211 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.4671 | Train Acc: 0.4149
 Site-Southeast_Asian          | Train Loss: 1.4637 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.3618 | Train Acc: 0.4772
 Site-Middle_Eastern           | Train Loss: 1.3725 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.3028 | Train Acc: 0.4820
 Site-White                     (2) | Val  Loss: 1.3903 | Val  Acc: 0.4457
 Site-White                     (2) | Val  Loss: 1.3461 | Val  Acc: 0.4820
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4471 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4108 | Val  Acc: 0.4209
 Site-Black                     (3) | Val  Loss: 1.3279 | Val  Acc: 0.5543
 Site-Black                     (3) | Val  Loss: 1.4506 | Val  Acc: 0.4424
 Site-East_Asian                (0) | Val  Loss: 1.2313 | Val  Acc: 0.5217
 Site-East_Asian                (0) | Val  Loss: 1.3208 | Val  Acc: 0.5072
 Site-Indian                    (1) | Val  Loss: 1.4794 | Val  Acc: 0.3587
 Site-Indian                    (1) | Val  Loss: 1.4236 | Val  Acc: 0.4281
 Site-Southeast_Asian           (6) | Val  Loss: 1.3674 | Val  Acc: 0.4565
 Site-Southeast_Asian           (6) | Val  Loss: 1.3683 | Val  Acc: 0.4820
 Site-Middle_Eastern            (4) | Val  Loss: 1.3314 | Val  Acc: 0.5000
 Site-Middle_Eastern            (4) | Val  Loss: 1.3489 | Val  Acc: 0.4568
Average Valid Accuracy: 0.4621
============ Train epoch 27 ============
cnt=[3, 2, 2, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
quan_i=1.53, quan_c=1.51
enlarge weight of clients:[2, 4, ]
 Site-White                    | Train Loss: 1.3532 | Train Acc: 0.5252
 Site-White                    | Train Loss: 1.3098 | Train Acc: 0.4700
 Site-Latino_Hispanic          | Train Loss: 1.5357 | Train Acc: 0.4388
 Site-Latino_Hispanic          | Train Loss: 1.4670 | Train Acc: 0.4484
 Site-Black                    | Train Loss: 1.6010 | Train Acc: 0.3525
 Site-Black                    | Train Loss: 1.5212 | Train Acc: 0.4053
 Site-East_Asian               | Train Loss: 1.4102 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.3029 | Train Acc: 0.4964
 Site-Indian                   | Train Loss: 1.3346 | Train Acc: 0.5108
 Site-Indian                   | Train Loss: 1.4203 | Train Acc: 0.4341
 Site-Southeast_Asian          | Train Loss: 1.3610 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.3962 | Train Acc: 0.4988
 Site-Middle_Eastern           | Train Loss: 1.3736 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.2540 | Train Acc: 0.5012
 Site-White                     (1) | Val  Loss: 1.3490 | Val  Acc: 0.4891
 Site-White                     (1) | Val  Loss: 1.3342 | Val  Acc: 0.5000
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3865 | Val  Acc: 0.4783
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4106 | Val  Acc: 0.4388
 Site-Black                     (3) | Val  Loss: 1.3523 | Val  Acc: 0.5543
 Site-Black                     (3) | Val  Loss: 1.4528 | Val  Acc: 0.4676
 Site-East_Asian                (4) | Val  Loss: 1.2558 | Val  Acc: 0.5326
 Site-East_Asian                (4) | Val  Loss: 1.3107 | Val  Acc: 0.5216
 Site-Indian                    (0) | Val  Loss: 1.4768 | Val  Acc: 0.3696
 Site-Indian                    (0) | Val  Loss: 1.3999 | Val  Acc: 0.4460
 Site-Southeast_Asian           (6) | Val  Loss: 1.3704 | Val  Acc: 0.5217
 Site-Southeast_Asian           (6) | Val  Loss: 1.3409 | Val  Acc: 0.4856
 Site-Middle_Eastern            (2) | Val  Loss: 1.3733 | Val  Acc: 0.5000
 Site-Middle_Eastern            (2) | Val  Loss: 1.3354 | Val  Acc: 0.4784
Average Valid Accuracy: 0.4846
 Best site-White                    (1)  | Epoch:27 | Val Acc: 0.4891
 Best site-White                    (1)  | Epoch:27 | Val Acc: 0.5000
 Best site-Latino_Hispanic          (5)  | Epoch:27 | Val Acc: 0.4783
 Best site-Latino_Hispanic          (0)  | Epoch:27 | Val Acc: 0.4388
 Best site-Black                    (3)  | Epoch:27 | Val Acc: 0.5543
 Best site-Black                    (3)  | Epoch:27 | Val Acc: 0.4676
 Best site-East_Asian               (4)  | Epoch:27 | Val Acc: 0.5326
 Best site-East_Asian               (4)  | Epoch:27 | Val Acc: 0.5216
 Best site-Indian                   (0)  | Epoch:27 | Val Acc: 0.3696
 Best site-Indian                   (0)  | Epoch:27 | Val Acc: 0.4460
 Best site-Southeast_Asian          (6)  | Epoch:27 | Val Acc: 0.5217
 Best site-Southeast_Asian          (6)  | Epoch:27 | Val Acc: 0.4856
 Best site-Middle_Eastern           (2)  | Epoch:27 | Val Acc: 0.5000
 Best site-Middle_Eastern           (2)  | Epoch:27 | Val Acc: 0.4784
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 28 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
quan_i=1.50, quan_c=1.49
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.3936 | Train Acc: 0.5252
 Site-White                    | Train Loss: 1.3557 | Train Acc: 0.4700
 Site-Latino_Hispanic          | Train Loss: 1.5703 | Train Acc: 0.4388
 Site-Latino_Hispanic          | Train Loss: 1.4240 | Train Acc: 0.4293
 Site-Black                    | Train Loss: 1.5774 | Train Acc: 0.4245
 Site-Black                    | Train Loss: 1.5644 | Train Acc: 0.4293
 Site-East_Asian               | Train Loss: 1.4235 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.2712 | Train Acc: 0.5012
 Site-Indian                   | Train Loss: 1.3137 | Train Acc: 0.5036
 Site-Indian                   | Train Loss: 1.4171 | Train Acc: 0.4221
 Site-Southeast_Asian          | Train Loss: 1.3723 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.4076 | Train Acc: 0.4772
 Site-Middle_Eastern           | Train Loss: 1.3122 | Train Acc: 0.4317
 Site-Middle_Eastern           | Train Loss: 1.3110 | Train Acc: 0.5012
 Site-White                     (3) | Val  Loss: 1.3478 | Val  Acc: 0.4565
 Site-White                     (3) | Val  Loss: 1.3245 | Val  Acc: 0.5000
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3966 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4143 | Val  Acc: 0.4065
 Site-Black                     (0) | Val  Loss: 1.3199 | Val  Acc: 0.5435
 Site-Black                     (0) | Val  Loss: 1.4863 | Val  Acc: 0.4353
 Site-East_Asian                (1) | Val  Loss: 1.2066 | Val  Acc: 0.5326
 Site-East_Asian                (1) | Val  Loss: 1.2751 | Val  Acc: 0.5504
 Site-Indian                    (2) | Val  Loss: 1.4745 | Val  Acc: 0.3587
 Site-Indian                    (2) | Val  Loss: 1.3955 | Val  Acc: 0.4640
 Site-Southeast_Asian           (6) | Val  Loss: 1.3427 | Val  Acc: 0.4674
 Site-Southeast_Asian           (6) | Val  Loss: 1.3464 | Val  Acc: 0.4892
 Site-Middle_Eastern            (4) | Val  Loss: 1.4012 | Val  Acc: 0.4674
 Site-Middle_Eastern            (4) | Val  Loss: 1.3617 | Val  Acc: 0.4748
Average Valid Accuracy: 0.4724
============ Train epoch 29 ============
cnt=[1, 2, 1, 3, 2, 2, 3, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
quan_i=1.49, quan_c=1.46
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.3713 | Train Acc: 0.5180
 Site-White                    | Train Loss: 1.2581 | Train Acc: 0.5084
 Site-Latino_Hispanic          | Train Loss: 1.5371 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.3596 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.6065 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.4813 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3714 | Train Acc: 0.4964
 Site-East_Asian               | Train Loss: 1.3556 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.3820 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.4444 | Train Acc: 0.4412
 Site-Southeast_Asian          | Train Loss: 1.4041 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.3339 | Train Acc: 0.4868
 Site-Middle_Eastern           | Train Loss: 1.4030 | Train Acc: 0.4173
 Site-Middle_Eastern           | Train Loss: 1.3057 | Train Acc: 0.4724
 Site-White                     (3) | Val  Loss: 1.3583 | Val  Acc: 0.4565
 Site-White                     (2) | Val  Loss: 1.3177 | Val  Acc: 0.5252
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4642 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3918 | Val  Acc: 0.4460
 Site-Black                     (5) | Val  Loss: 1.3274 | Val  Acc: 0.5761
 Site-Black                     (5) | Val  Loss: 1.4772 | Val  Acc: 0.4712
 Site-East_Asian                (6) | Val  Loss: 1.2469 | Val  Acc: 0.5543
 Site-East_Asian                (6) | Val  Loss: 1.3095 | Val  Acc: 0.5216
 Site-Indian                    (1) | Val  Loss: 1.4282 | Val  Acc: 0.3696
 Site-Indian                    (1) | Val  Loss: 1.3937 | Val  Acc: 0.4137
 Site-Southeast_Asian           (0) | Val  Loss: 1.3376 | Val  Acc: 0.5000
 Site-Southeast_Asian           (6) | Val  Loss: 1.3676 | Val  Acc: 0.4784
 Site-Middle_Eastern            (4) | Val  Loss: 1.3586 | Val  Acc: 0.4891
 Site-Middle_Eastern            (4) | Val  Loss: 1.3678 | Val  Acc: 0.4640
Average Valid Accuracy: 0.4794
============ Train epoch 30 ============
cnt=[3, 3, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
quan_i=1.47, quan_c=1.46
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.3605 | Train Acc: 0.5108
 Site-White                    | Train Loss: 1.2842 | Train Acc: 0.5228
 Site-Latino_Hispanic          | Train Loss: 1.5567 | Train Acc: 0.4317
 Site-Latino_Hispanic          | Train Loss: 1.3634 | Train Acc: 0.4508
 Site-Black                    | Train Loss: 1.5740 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.5296 | Train Acc: 0.4005
 Site-East_Asian               | Train Loss: 1.3481 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.3043 | Train Acc: 0.5204
 Site-Indian                   | Train Loss: 1.3557 | Train Acc: 0.5108
 Site-Indian                   | Train Loss: 1.4458 | Train Acc: 0.4269
 Site-Southeast_Asian          | Train Loss: 1.4942 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.4013 | Train Acc: 0.4964
 Site-Middle_Eastern           | Train Loss: 1.3283 | Train Acc: 0.5108
 Site-Middle_Eastern           | Train Loss: 1.2378 | Train Acc: 0.5204
 Site-White                     (3) | Val  Loss: 1.3199 | Val  Acc: 0.4783
 Site-White                     (2) | Val  Loss: 1.3017 | Val  Acc: 0.5324
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3951 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4059 | Val  Acc: 0.4424
 Site-Black                     (5) | Val  Loss: 1.3166 | Val  Acc: 0.5217
 Site-Black                     (5) | Val  Loss: 1.4806 | Val  Acc: 0.4353
 Site-East_Asian                (1) | Val  Loss: 1.2204 | Val  Acc: 0.5543
 Site-East_Asian                (4) | Val  Loss: 1.3070 | Val  Acc: 0.5288
 Site-Indian                    (0) | Val  Loss: 1.4608 | Val  Acc: 0.3370
 Site-Indian                    (0) | Val  Loss: 1.4261 | Val  Acc: 0.4388
 Site-Southeast_Asian           (1) | Val  Loss: 1.3850 | Val  Acc: 0.5000
 Site-Southeast_Asian           (1) | Val  Loss: 1.3606 | Val  Acc: 0.5036
 Site-Middle_Eastern            (2) | Val  Loss: 1.3984 | Val  Acc: 0.5000
 Site-Middle_Eastern            (6) | Val  Loss: 1.3455 | Val  Acc: 0.5072
Average Valid Accuracy: 0.4781
============ Train epoch 31 ============
cnt=[1, 2, 2, 4, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
quan_i=1.52, quan_c=1.46
enlarge weight of clients:[5, ]
 Site-White                    | Train Loss: 1.4051 | Train Acc: 0.4604
 Site-White                    | Train Loss: 1.2871 | Train Acc: 0.4892
 Site-Latino_Hispanic          | Train Loss: 1.5006 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.3405 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.6142 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.5354 | Train Acc: 0.4173
 Site-East_Asian               | Train Loss: 1.2859 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.3647 | Train Acc: 0.5204
 Site-Indian                   | Train Loss: 1.3764 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.4305 | Train Acc: 0.4436
 Site-Southeast_Asian          | Train Loss: 1.4913 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.3897 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.3433 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.2321 | Train Acc: 0.4916
 Site-White                     (3) | Val  Loss: 1.3683 | Val  Acc: 0.4457
 Site-White                     (3) | Val  Loss: 1.3116 | Val  Acc: 0.5072
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3902 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3862 | Val  Acc: 0.4604
 Site-Black                     (4) | Val  Loss: 1.3295 | Val  Acc: 0.5109
 Site-Black                     (0) | Val  Loss: 1.4936 | Val  Acc: 0.4101
 Site-East_Asian                (5) | Val  Loss: 1.2095 | Val  Acc: 0.5326
 Site-East_Asian                (6) | Val  Loss: 1.2826 | Val  Acc: 0.5324
 Site-Indian                    (4) | Val  Loss: 1.4435 | Val  Acc: 0.3804
 Site-Indian                    (4) | Val  Loss: 1.3874 | Val  Acc: 0.4353
 Site-Southeast_Asian           (1) | Val  Loss: 1.3211 | Val  Acc: 0.4674
 Site-Southeast_Asian           (1) | Val  Loss: 1.3638 | Val  Acc: 0.4928
 Site-Middle_Eastern            (3) | Val  Loss: 1.3940 | Val  Acc: 0.5217
 Site-Middle_Eastern            (3) | Val  Loss: 1.3401 | Val  Acc: 0.4748
Average Valid Accuracy: 0.4719
============ Train epoch 32 ============
cnt=[2, 5, 1, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
quan_i=1.50, quan_c=1.43
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.3501 | Train Acc: 0.4892
 Site-White                    | Train Loss: 1.2361 | Train Acc: 0.5060
 Site-Latino_Hispanic          | Train Loss: 1.4720 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.3652 | Train Acc: 0.4460
 Site-Black                    | Train Loss: 1.5690 | Train Acc: 0.4388
 Site-Black                    | Train Loss: 1.4842 | Train Acc: 0.4125
 Site-East_Asian               | Train Loss: 1.3180 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.3106 | Train Acc: 0.5036
 Site-Indian                   | Train Loss: 1.3409 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.4146 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.4324 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.3542 | Train Acc: 0.4628
 Site-Middle_Eastern           | Train Loss: 1.3460 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.3020 | Train Acc: 0.4916
 Site-White                     (4) | Val  Loss: 1.3229 | Val  Acc: 0.4783
 Site-White                     (1) | Val  Loss: 1.3077 | Val  Acc: 0.4928
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3781 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4046 | Val  Acc: 0.4496
 Site-Black                     (6) | Val  Loss: 1.3426 | Val  Acc: 0.5435
 Site-Black                     (2) | Val  Loss: 1.4756 | Val  Acc: 0.4568
 Site-East_Asian                (5) | Val  Loss: 1.2280 | Val  Acc: 0.5326
 Site-East_Asian                (5) | Val  Loss: 1.2767 | Val  Acc: 0.5216
 Site-Indian                    (1) | Val  Loss: 1.4229 | Val  Acc: 0.3587
 Site-Indian                    (1) | Val  Loss: 1.3847 | Val  Acc: 0.4460
 Site-Southeast_Asian           (3) | Val  Loss: 1.3763 | Val  Acc: 0.4348
 Site-Southeast_Asian           (3) | Val  Loss: 1.3024 | Val  Acc: 0.4892
 Site-Middle_Eastern            (0) | Val  Loss: 1.3584 | Val  Acc: 0.4674
 Site-Middle_Eastern            (0) | Val  Loss: 1.3428 | Val  Acc: 0.5108
Average Valid Accuracy: 0.4719
============ Train epoch 33 ============
cnt=[1, 1, 2, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
quan_i=1.47, quan_c=1.43
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.3773 | Train Acc: 0.4964
 Site-White                    | Train Loss: 1.2624 | Train Acc: 0.4916
 Site-Latino_Hispanic          | Train Loss: 1.5698 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.3820 | Train Acc: 0.4293
 Site-Black                    | Train Loss: 1.6394 | Train Acc: 0.4029
 Site-Black                    | Train Loss: 1.5250 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3468 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.3421 | Train Acc: 0.5132
 Site-Indian                   | Train Loss: 1.3166 | Train Acc: 0.4964
 Site-Indian                   | Train Loss: 1.5498 | Train Acc: 0.4436
 Site-Southeast_Asian          | Train Loss: 1.4352 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.3992 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.3725 | Train Acc: 0.4964
 Site-Middle_Eastern           | Train Loss: 1.2616 | Train Acc: 0.4988
 Site-White                     (1) | Val  Loss: 1.3087 | Val  Acc: 0.5000
 Site-White                     (3) | Val  Loss: 1.2959 | Val  Acc: 0.4892
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4014 | Val  Acc: 0.4783
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3993 | Val  Acc: 0.4388
 Site-Black                     (4) | Val  Loss: 1.3166 | Val  Acc: 0.5761
 Site-Black                     (0) | Val  Loss: 1.5023 | Val  Acc: 0.4101
 Site-East_Asian                (5) | Val  Loss: 1.1980 | Val  Acc: 0.5652
 Site-East_Asian                (5) | Val  Loss: 1.2873 | Val  Acc: 0.5360
 Site-Indian                    (6) | Val  Loss: 1.4577 | Val  Acc: 0.3696
 Site-Indian                    (6) | Val  Loss: 1.4018 | Val  Acc: 0.4460
 Site-Southeast_Asian           (2) | Val  Loss: 1.3553 | Val  Acc: 0.4891
 Site-Southeast_Asian           (2) | Val  Loss: 1.3379 | Val  Acc: 0.5036
 Site-Middle_Eastern            (3) | Val  Loss: 1.2982 | Val  Acc: 0.5543
 Site-Middle_Eastern            (3) | Val  Loss: 1.3351 | Val  Acc: 0.4712
Average Valid Accuracy: 0.4877
 Best site-White                    (1)  | Epoch:33 | Val Acc: 0.5000
 Best site-White                    (3)  | Epoch:33 | Val Acc: 0.4892
 Best site-Latino_Hispanic          (6)  | Epoch:33 | Val Acc: 0.4783
 Best site-Latino_Hispanic          (3)  | Epoch:33 | Val Acc: 0.4388
 Best site-Black                    (4)  | Epoch:33 | Val Acc: 0.5761
 Best site-Black                    (0)  | Epoch:33 | Val Acc: 0.4101
 Best site-East_Asian               (5)  | Epoch:33 | Val Acc: 0.5652
 Best site-East_Asian               (5)  | Epoch:33 | Val Acc: 0.5360
 Best site-Indian                   (6)  | Epoch:33 | Val Acc: 0.3696
 Best site-Indian                   (6)  | Epoch:33 | Val Acc: 0.4460
 Best site-Southeast_Asian          (2)  | Epoch:33 | Val Acc: 0.4891
 Best site-Southeast_Asian          (2)  | Epoch:33 | Val Acc: 0.5036
 Best site-Middle_Eastern           (3)  | Epoch:33 | Val Acc: 0.5543
 Best site-Middle_Eastern           (3)  | Epoch:33 | Val Acc: 0.4712
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 34 ============
cnt=[3, 3, 1, 2, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
quan_i=1.55, quan_c=1.49
enlarge weight of clients:[4, ]
 Site-White                    | Train Loss: 1.3624 | Train Acc: 0.4964
 Site-White                    | Train Loss: 1.2310 | Train Acc: 0.5036
 Site-Latino_Hispanic          | Train Loss: 1.4651 | Train Acc: 0.4532
 Site-Latino_Hispanic          | Train Loss: 1.4619 | Train Acc: 0.4269
 Site-Black                    | Train Loss: 1.5767 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.5495 | Train Acc: 0.4149
 Site-East_Asian               | Train Loss: 1.3869 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.3388 | Train Acc: 0.5084
 Site-Indian                   | Train Loss: 1.3238 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.3790 | Train Acc: 0.4436
 Site-Southeast_Asian          | Train Loss: 1.4805 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.5199 | Train Acc: 0.4772
 Site-Middle_Eastern           | Train Loss: 1.4334 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.2908 | Train Acc: 0.4868
 Site-White                     (6) | Val  Loss: 1.2925 | Val  Acc: 0.5217
 Site-White                     (6) | Val  Loss: 1.2894 | Val  Acc: 0.4964
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3938 | Val  Acc: 0.4783
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4246 | Val  Acc: 0.4388
 Site-Black                     (4) | Val  Loss: 1.3017 | Val  Acc: 0.5761
 Site-Black                     (2) | Val  Loss: 1.4669 | Val  Acc: 0.4604
 Site-East_Asian                (5) | Val  Loss: 1.2175 | Val  Acc: 0.5435
 Site-East_Asian                (5) | Val  Loss: 1.2785 | Val  Acc: 0.5324
 Site-Indian                    (0) | Val  Loss: 1.4589 | Val  Acc: 0.3478
 Site-Indian                    (1) | Val  Loss: 1.3932 | Val  Acc: 0.4101
 Site-Southeast_Asian           (0) | Val  Loss: 1.3396 | Val  Acc: 0.4674
 Site-Southeast_Asian           (0) | Val  Loss: 1.3368 | Val  Acc: 0.4892
 Site-Middle_Eastern            (3) | Val  Loss: 1.3073 | Val  Acc: 0.5543
 Site-Middle_Eastern            (3) | Val  Loss: 1.3260 | Val  Acc: 0.4748
Average Valid Accuracy: 0.4851
============ Train epoch 35 ============
cnt=[2, 2, 2, 1, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
quan_i=1.51, quan_c=1.53
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.3110 | Train Acc: 0.5252
 Site-White                    | Train Loss: 1.3399 | Train Acc: 0.5132
 Site-Latino_Hispanic          | Train Loss: 1.5362 | Train Acc: 0.4388
 Site-Latino_Hispanic          | Train Loss: 1.4800 | Train Acc: 0.4388
 Site-Black                    | Train Loss: 1.6239 | Train Acc: 0.4101
 Site-Black                    | Train Loss: 1.4386 | Train Acc: 0.4412
 Site-East_Asian               | Train Loss: 1.3834 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.2995 | Train Acc: 0.5060
 Site-Indian                   | Train Loss: 1.3341 | Train Acc: 0.5468
 Site-Indian                   | Train Loss: 1.3659 | Train Acc: 0.4652
 Site-Southeast_Asian          | Train Loss: 1.4245 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.3623 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.4237 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.3275 | Train Acc: 0.5060
 Site-White                     (5) | Val  Loss: 1.3290 | Val  Acc: 0.4674
 Site-White                     (6) | Val  Loss: 1.2741 | Val  Acc: 0.4964
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4154 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4051 | Val  Acc: 0.4424
 Site-Black                     (4) | Val  Loss: 1.3073 | Val  Acc: 0.5217
 Site-Black                     (4) | Val  Loss: 1.4300 | Val  Acc: 0.4856
 Site-East_Asian                (0) | Val  Loss: 1.2234 | Val  Acc: 0.5652
 Site-East_Asian                (0) | Val  Loss: 1.2690 | Val  Acc: 0.5324
 Site-Indian                    (1) | Val  Loss: 1.4136 | Val  Acc: 0.3587
 Site-Indian                    (1) | Val  Loss: 1.3871 | Val  Acc: 0.4496
 Site-Southeast_Asian           (2) | Val  Loss: 1.3396 | Val  Acc: 0.5000
 Site-Southeast_Asian           (2) | Val  Loss: 1.3250 | Val  Acc: 0.5180
 Site-Middle_Eastern            (6) | Val  Loss: 1.3512 | Val  Acc: 0.5000
 Site-Middle_Eastern            (3) | Val  Loss: 1.3728 | Val  Acc: 0.4856
Average Valid Accuracy: 0.4827
============ Train epoch 36 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
quan_i=1.47, quan_c=1.50
enlarge weight of clients:[2, 3, ]
 Site-White                    | Train Loss: 1.3351 | Train Acc: 0.4892
 Site-White                    | Train Loss: 1.3272 | Train Acc: 0.4892
 Site-Latino_Hispanic          | Train Loss: 1.4488 | Train Acc: 0.4820
 Site-Latino_Hispanic          | Train Loss: 1.4662 | Train Acc: 0.4412
 Site-Black                    | Train Loss: 1.5289 | Train Acc: 0.4101
 Site-Black                    | Train Loss: 1.3918 | Train Acc: 0.4772
 Site-East_Asian               | Train Loss: 1.3695 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.2789 | Train Acc: 0.5012
 Site-Indian                   | Train Loss: 1.3137 | Train Acc: 0.5324
 Site-Indian                   | Train Loss: 1.3251 | Train Acc: 0.4556
 Site-Southeast_Asian          | Train Loss: 1.4928 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.3236 | Train Acc: 0.4916
 Site-Middle_Eastern           | Train Loss: 1.3530 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.2143 | Train Acc: 0.5132
 Site-White                     (4) | Val  Loss: 1.2706 | Val  Acc: 0.5326
 Site-White                     (4) | Val  Loss: 1.2998 | Val  Acc: 0.4892
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3913 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4010 | Val  Acc: 0.4245
 Site-Black                     (5) | Val  Loss: 1.3241 | Val  Acc: 0.5326
 Site-Black                     (5) | Val  Loss: 1.4471 | Val  Acc: 0.4784
 Site-East_Asian                (3) | Val  Loss: 1.2083 | Val  Acc: 0.5217
 Site-East_Asian                (3) | Val  Loss: 1.2631 | Val  Acc: 0.5432
 Site-Indian                    (2) | Val  Loss: 1.4029 | Val  Acc: 0.4674
 Site-Indian                    (2) | Val  Loss: 1.3880 | Val  Acc: 0.4353
 Site-Southeast_Asian           (1) | Val  Loss: 1.3218 | Val  Acc: 0.4674
 Site-Southeast_Asian           (1) | Val  Loss: 1.3301 | Val  Acc: 0.5108
 Site-Middle_Eastern            (0) | Val  Loss: 1.3356 | Val  Acc: 0.4674
 Site-Middle_Eastern            (0) | Val  Loss: 1.3152 | Val  Acc: 0.4748
Average Valid Accuracy: 0.4835
============ Train epoch 37 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
quan_i=1.46, quan_c=1.44
enlarge weight of clients:[3, ]
 Site-White                    | Train Loss: 1.3863 | Train Acc: 0.4820
 Site-White                    | Train Loss: 1.2707 | Train Acc: 0.4796
 Site-Latino_Hispanic          | Train Loss: 1.5206 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.3405 | Train Acc: 0.4532
 Site-Black                    | Train Loss: 1.5442 | Train Acc: 0.4029
 Site-Black                    | Train Loss: 1.4255 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.3266 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.2763 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.3028 | Train Acc: 0.4964
 Site-Indian                   | Train Loss: 1.5250 | Train Acc: 0.4772
 Site-Southeast_Asian          | Train Loss: 1.4375 | Train Acc: 0.5252
 Site-Southeast_Asian          | Train Loss: 1.3492 | Train Acc: 0.4772
 Site-Middle_Eastern           | Train Loss: 1.3600 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.2438 | Train Acc: 0.5108
 Site-White                     (5) | Val  Loss: 1.2786 | Val  Acc: 0.5435
 Site-White                     (5) | Val  Loss: 1.2831 | Val  Acc: 0.4856
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4091 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3945 | Val  Acc: 0.4532
 Site-Black                     (3) | Val  Loss: 1.3317 | Val  Acc: 0.4674
 Site-Black                     (3) | Val  Loss: 1.4162 | Val  Acc: 0.4568
 Site-East_Asian                (6) | Val  Loss: 1.1679 | Val  Acc: 0.6087
 Site-East_Asian                (6) | Val  Loss: 1.2625 | Val  Acc: 0.5432
 Site-Indian                    (1) | Val  Loss: 1.4376 | Val  Acc: 0.4565
 Site-Indian                    (1) | Val  Loss: 1.3810 | Val  Acc: 0.4820
 Site-Southeast_Asian           (2) | Val  Loss: 1.3644 | Val  Acc: 0.4783
 Site-Southeast_Asian           (2) | Val  Loss: 1.3323 | Val  Acc: 0.4640
 Site-Middle_Eastern            (4) | Val  Loss: 1.3503 | Val  Acc: 0.5326
 Site-Middle_Eastern            (4) | Val  Loss: 1.3357 | Val  Acc: 0.4748
Average Valid Accuracy: 0.4915
 Best site-White                    (5)  | Epoch:37 | Val Acc: 0.5435
 Best site-White                    (5)  | Epoch:37 | Val Acc: 0.4856
 Best site-Latino_Hispanic          (0)  | Epoch:37 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (0)  | Epoch:37 | Val Acc: 0.4532
 Best site-Black                    (3)  | Epoch:37 | Val Acc: 0.4674
 Best site-Black                    (3)  | Epoch:37 | Val Acc: 0.4568
 Best site-East_Asian               (6)  | Epoch:37 | Val Acc: 0.6087
 Best site-East_Asian               (6)  | Epoch:37 | Val Acc: 0.5432
 Best site-Indian                   (1)  | Epoch:37 | Val Acc: 0.4565
 Best site-Indian                   (1)  | Epoch:37 | Val Acc: 0.4820
 Best site-Southeast_Asian          (2)  | Epoch:37 | Val Acc: 0.4783
 Best site-Southeast_Asian          (2)  | Epoch:37 | Val Acc: 0.4640
 Best site-Middle_Eastern           (4)  | Epoch:37 | Val Acc: 0.5326
 Best site-Middle_Eastern           (4)  | Epoch:37 | Val Acc: 0.4748
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 38 ============
cnt=[2, 2, 1, 3, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
quan_i=1.48, quan_c=1.45
enlarge weight of clients:[4, 9, ]
 Site-White                    | Train Loss: 1.3541 | Train Acc: 0.4820
 Site-White                    | Train Loss: 1.2829 | Train Acc: 0.4964
 Site-Latino_Hispanic          | Train Loss: 1.5016 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.5229 | Train Acc: 0.4460
 Site-Black                    | Train Loss: 1.5839 | Train Acc: 0.4245
 Site-Black                    | Train Loss: 1.4604 | Train Acc: 0.4197
 Site-East_Asian               | Train Loss: 1.3565 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.2228 | Train Acc: 0.5012
 Site-Indian                   | Train Loss: 1.2981 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.4358 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.4315 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3249 | Train Acc: 0.4868
 Site-Middle_Eastern           | Train Loss: 1.3960 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.2700 | Train Acc: 0.5132
 Site-White                     (3) | Val  Loss: 1.3578 | Val  Acc: 0.4565
 Site-White                     (3) | Val  Loss: 1.3007 | Val  Acc: 0.4964
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4113 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3970 | Val  Acc: 0.4784
 Site-Black                     (2) | Val  Loss: 1.2494 | Val  Acc: 0.6087
 Site-Black                     (6) | Val  Loss: 1.4217 | Val  Acc: 0.4353
 Site-East_Asian                (5) | Val  Loss: 1.1939 | Val  Acc: 0.5652
 Site-East_Asian                (5) | Val  Loss: 1.2426 | Val  Acc: 0.5288
 Site-Indian                    (4) | Val  Loss: 1.4229 | Val  Acc: 0.4239
 Site-Indian                    (4) | Val  Loss: 1.3752 | Val  Acc: 0.4784
 Site-Southeast_Asian           (0) | Val  Loss: 1.3343 | Val  Acc: 0.4565
 Site-Southeast_Asian           (5) | Val  Loss: 1.3141 | Val  Acc: 0.5252
 Site-Middle_Eastern            (1) | Val  Loss: 1.3523 | Val  Acc: 0.5435
 Site-Middle_Eastern            (1) | Val  Loss: 1.3391 | Val  Acc: 0.4784
Average Valid Accuracy: 0.4936
 Best site-White                    (3)  | Epoch:38 | Val Acc: 0.4565
 Best site-White                    (3)  | Epoch:38 | Val Acc: 0.4964
 Best site-Latino_Hispanic          (3)  | Epoch:38 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (0)  | Epoch:38 | Val Acc: 0.4784
 Best site-Black                    (2)  | Epoch:38 | Val Acc: 0.6087
 Best site-Black                    (6)  | Epoch:38 | Val Acc: 0.4353
 Best site-East_Asian               (5)  | Epoch:38 | Val Acc: 0.5652
 Best site-East_Asian               (5)  | Epoch:38 | Val Acc: 0.5288
 Best site-Indian                   (4)  | Epoch:38 | Val Acc: 0.4239
 Best site-Indian                   (4)  | Epoch:38 | Val Acc: 0.4784
 Best site-Southeast_Asian          (0)  | Epoch:38 | Val Acc: 0.4565
 Best site-Southeast_Asian          (5)  | Epoch:38 | Val Acc: 0.5252
 Best site-Middle_Eastern           (1)  | Epoch:38 | Val Acc: 0.5435
 Best site-Middle_Eastern           (1)  | Epoch:38 | Val Acc: 0.4784
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 39 ============
cnt=[1, 2, 1, 5, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
quan_i=1.49, quan_c=1.41
enlarge weight of clients:[4, ]
 Site-White                    | Train Loss: 1.4240 | Train Acc: 0.4820
 Site-White                    | Train Loss: 1.2709 | Train Acc: 0.5300
 Site-Latino_Hispanic          | Train Loss: 1.4721 | Train Acc: 0.4317
 Site-Latino_Hispanic          | Train Loss: 1.3551 | Train Acc: 0.4556
 Site-Black                    | Train Loss: 1.5611 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.4330 | Train Acc: 0.4436
 Site-East_Asian               | Train Loss: 1.3659 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.2217 | Train Acc: 0.5276
 Site-Indian                   | Train Loss: 1.3077 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.3322 | Train Acc: 0.4269
 Site-Southeast_Asian          | Train Loss: 1.3971 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.3746 | Train Acc: 0.4940
 Site-Middle_Eastern           | Train Loss: 1.3949 | Train Acc: 0.4676
 Site-Middle_Eastern           | Train Loss: 1.3244 | Train Acc: 0.5132
 Site-White                     (6) | Val  Loss: 1.2696 | Val  Acc: 0.5217
 Site-White                     (6) | Val  Loss: 1.2884 | Val  Acc: 0.5180
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3563 | Val  Acc: 0.4891
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3803 | Val  Acc: 0.4640
 Site-Black                     (2) | Val  Loss: 1.2512 | Val  Acc: 0.5652
 Site-Black                     (5) | Val  Loss: 1.4068 | Val  Acc: 0.4748
 Site-East_Asian                (0) | Val  Loss: 1.2191 | Val  Acc: 0.5652
 Site-East_Asian                (3) | Val  Loss: 1.2890 | Val  Acc: 0.5324
 Site-Indian                    (4) | Val  Loss: 1.3856 | Val  Acc: 0.4348
 Site-Indian                    (4) | Val  Loss: 1.3622 | Val  Acc: 0.4137
 Site-Southeast_Asian           (3) | Val  Loss: 1.3526 | Val  Acc: 0.4674
 Site-Southeast_Asian           (3) | Val  Loss: 1.3535 | Val  Acc: 0.5000
 Site-Middle_Eastern            (1) | Val  Loss: 1.3395 | Val  Acc: 0.4891
 Site-Middle_Eastern            (1) | Val  Loss: 1.2964 | Val  Acc: 0.4892
Average Valid Accuracy: 0.4946
 Best site-White                    (6)  | Epoch:39 | Val Acc: 0.5217
 Best site-White                    (6)  | Epoch:39 | Val Acc: 0.5180
 Best site-Latino_Hispanic          (3)  | Epoch:39 | Val Acc: 0.4891
 Best site-Latino_Hispanic          (3)  | Epoch:39 | Val Acc: 0.4640
 Best site-Black                    (2)  | Epoch:39 | Val Acc: 0.5652
 Best site-Black                    (5)  | Epoch:39 | Val Acc: 0.4748
 Best site-East_Asian               (0)  | Epoch:39 | Val Acc: 0.5652
 Best site-East_Asian               (3)  | Epoch:39 | Val Acc: 0.5324
 Best site-Indian                   (4)  | Epoch:39 | Val Acc: 0.4348
 Best site-Indian                   (4)  | Epoch:39 | Val Acc: 0.4137
 Best site-Southeast_Asian          (3)  | Epoch:39 | Val Acc: 0.4674
 Best site-Southeast_Asian          (3)  | Epoch:39 | Val Acc: 0.5000
 Best site-Middle_Eastern           (1)  | Epoch:39 | Val Acc: 0.4891
 Best site-Middle_Eastern           (1)  | Epoch:39 | Val Acc: 0.4892
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
 Test site-White                     (6)| Epoch:39 | Test Acc: 0.4171
 Test site-Latino_Hispanic           (3)| Epoch:39 | Test Acc: 0.3734
 Test site-Black                     (2)| Epoch:39 | Test Acc: 0.3500
 Test site-East_Asian                (0)| Epoch:39 | Test Acc: 0.5097
 Test site-Indian                    (4)| Epoch:39 | Test Acc: 0.3589
 Test site-Southeast_Asian           (3)| Epoch:39 | Test Acc: 0.4259
 Test site-Middle_Eastern            (1)| Epoch:39 | Test Acc: 0.4124
White: 0.4171, Latino_Hispanic: 0.3734, Black: 0.3500, East_Asian: 0.5097, Indian: 0.3589, Southeast_Asian: 0.4259, Middle_Eastern: 0.4124, 
Average Test Accuracy(group): 0.4068, Average Test Accuracy(individual): 0.4068,
domain std=0.0503, cluster std=nan, individual std=0.0503, 
============ Train epoch 40 ============
cnt=[1, 4, 2, 3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
quan_i=1.44, quan_c=1.39
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.4115 | Train Acc: 0.5036
 Site-White                    | Train Loss: 1.2408 | Train Acc: 0.5372
 Site-Latino_Hispanic          | Train Loss: 1.5048 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.3953 | Train Acc: 0.4484
 Site-Black                    | Train Loss: 1.5392 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.4174 | Train Acc: 0.4341
 Site-East_Asian               | Train Loss: 1.3747 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.2499 | Train Acc: 0.5396
 Site-Indian                   | Train Loss: 1.2761 | Train Acc: 0.4964
 Site-Indian                   | Train Loss: 1.3642 | Train Acc: 0.4964
 Site-Southeast_Asian          | Train Loss: 1.4138 | Train Acc: 0.4317
 Site-Southeast_Asian          | Train Loss: 1.3278 | Train Acc: 0.4964
 Site-Middle_Eastern           | Train Loss: 1.4248 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.2956 | Train Acc: 0.5108
 Site-White                     (4) | Val  Loss: 1.2558 | Val  Acc: 0.5109
 Site-White                     (4) | Val  Loss: 1.2800 | Val  Acc: 0.5108
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3724 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3610 | Val  Acc: 0.4856
 Site-Black                     (0) | Val  Loss: 1.3147 | Val  Acc: 0.5435
 Site-Black                     (6) | Val  Loss: 1.4146 | Val  Acc: 0.4820
 Site-East_Asian                (3) | Val  Loss: 1.1668 | Val  Acc: 0.5543
 Site-East_Asian                (5) | Val  Loss: 1.2533 | Val  Acc: 0.5432
 Site-Indian                    (1) | Val  Loss: 1.4153 | Val  Acc: 0.3478
 Site-Indian                    (1) | Val  Loss: 1.3638 | Val  Acc: 0.4568
 Site-Southeast_Asian           (3) | Val  Loss: 1.3188 | Val  Acc: 0.4783
 Site-Southeast_Asian           (3) | Val  Loss: 1.3009 | Val  Acc: 0.5036
 Site-Middle_Eastern            (2) | Val  Loss: 1.3229 | Val  Acc: 0.5217
 Site-Middle_Eastern            (2) | Val  Loss: 1.3068 | Val  Acc: 0.4892
Average Valid Accuracy: 0.4925
 Test site-White                     (4)| Epoch:39 | Test Acc: 0.4251
 Test site-Latino_Hispanic           (1)| Epoch:39 | Test Acc: 0.3766
 Test site-Black                     (0)| Epoch:39 | Test Acc: 0.3469
 Test site-East_Asian                (3)| Epoch:39 | Test Acc: 0.4903
 Test site-Indian                    (1)| Epoch:39 | Test Acc: 0.3493
 Test site-Southeast_Asian           (3)| Epoch:39 | Test Acc: 0.4370
 Test site-Middle_Eastern            (2)| Epoch:39 | Test Acc: 0.4175
White: 0.4251, Latino_Hispanic: 0.3766, Black: 0.3469, East_Asian: 0.4903, Indian: 0.3493, Southeast_Asian: 0.4370, Middle_Eastern: 0.4175, 
Average Test Accuracy(group): 0.4061, Average Test Accuracy(individual): 0.4061,
domain std=0.0480, cluster std=nan, individual std=0.0480, 
Average Test Accuracy: 0.4061
============ Train epoch 41 ============
cnt=[2, 1, 3, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
quan_i=1.43, quan_c=1.42
enlarge weight of clients:[2, 4, ]
 Site-White                    | Train Loss: 1.3541 | Train Acc: 0.5324
 Site-White                    | Train Loss: 1.2224 | Train Acc: 0.5180
 Site-Latino_Hispanic          | Train Loss: 1.5162 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.3123 | Train Acc: 0.4388
 Site-Black                    | Train Loss: 1.5474 | Train Acc: 0.4101
 Site-Black                    | Train Loss: 1.4867 | Train Acc: 0.4484
 Site-East_Asian               | Train Loss: 1.3718 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.2607 | Train Acc: 0.4964
 Site-Indian                   | Train Loss: 1.3015 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.3447 | Train Acc: 0.4508
 Site-Southeast_Asian          | Train Loss: 1.4068 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.3649 | Train Acc: 0.4988
 Site-Middle_Eastern           | Train Loss: 1.3535 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.2523 | Train Acc: 0.4772
 Site-White                     (0) | Val  Loss: 1.3052 | Val  Acc: 0.4891
 Site-White                     (2) | Val  Loss: 1.2772 | Val  Acc: 0.5216
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3718 | Val  Acc: 0.5000
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3517 | Val  Acc: 0.4856
 Site-Black                     (1) | Val  Loss: 1.2293 | Val  Acc: 0.5978
 Site-Black                     (5) | Val  Loss: 1.3941 | Val  Acc: 0.5108
 Site-East_Asian                (3) | Val  Loss: 1.1986 | Val  Acc: 0.5870
 Site-East_Asian                (3) | Val  Loss: 1.2595 | Val  Acc: 0.5180
 Site-Indian                    (4) | Val  Loss: 1.4154 | Val  Acc: 0.4457
 Site-Indian                    (4) | Val  Loss: 1.3860 | Val  Acc: 0.4460
 Site-Southeast_Asian           (3) | Val  Loss: 1.3368 | Val  Acc: 0.5109
 Site-Southeast_Asian           (3) | Val  Loss: 1.3424 | Val  Acc: 0.4928
 Site-Middle_Eastern            (2) | Val  Loss: 1.3429 | Val  Acc: 0.5326
 Site-Middle_Eastern            (2) | Val  Loss: 1.3151 | Val  Acc: 0.5072
Average Valid Accuracy: 0.5104
 Best site-White                    (0)  | Epoch:41 | Val Acc: 0.4891
 Best site-White                    (2)  | Epoch:41 | Val Acc: 0.5216
 Best site-Latino_Hispanic          (6)  | Epoch:41 | Val Acc: 0.5000
 Best site-Latino_Hispanic          (0)  | Epoch:41 | Val Acc: 0.4856
 Best site-Black                    (1)  | Epoch:41 | Val Acc: 0.5978
 Best site-Black                    (5)  | Epoch:41 | Val Acc: 0.5108
 Best site-East_Asian               (3)  | Epoch:41 | Val Acc: 0.5870
 Best site-East_Asian               (3)  | Epoch:41 | Val Acc: 0.5180
 Best site-Indian                   (4)  | Epoch:41 | Val Acc: 0.4457
 Best site-Indian                   (4)  | Epoch:41 | Val Acc: 0.4460
 Best site-Southeast_Asian          (3)  | Epoch:41 | Val Acc: 0.5109
 Best site-Southeast_Asian          (3)  | Epoch:41 | Val Acc: 0.4928
 Best site-Middle_Eastern           (2)  | Epoch:41 | Val Acc: 0.5326
 Best site-Middle_Eastern           (2)  | Epoch:41 | Val Acc: 0.5072
 Test site-White                     (0)| Epoch:41 | Test Acc: 0.4225
 Test site-Latino_Hispanic           (6)| Epoch:41 | Test Acc: 0.3734
 Test site-Black                     (1)| Epoch:41 | Test Acc: 0.3531
 Test site-East_Asian                (3)| Epoch:41 | Test Acc: 0.5000
 Test site-Indian                    (4)| Epoch:41 | Test Acc: 0.3517
 Test site-Southeast_Asian           (3)| Epoch:41 | Test Acc: 0.4333
 Test site-Middle_Eastern            (2)| Epoch:41 | Test Acc: 0.4072
White: 0.4225, Latino_Hispanic: 0.3734, Black: 0.3531, East_Asian: 0.5000, Indian: 0.3517, Southeast_Asian: 0.4333, Middle_Eastern: 0.4072, 
Average Test Accuracy(group): 0.4059, Average Test Accuracy(individual): 0.4059,
domain std=0.0488, cluster std=nan, individual std=0.0488, 
Average Test Accuracy: 0.4059
============ Train epoch 42 ============
cnt=[1, 4, 2, 1, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
quan_i=1.44, quan_c=1.44
enlarge weight of clients:[2, 4, 5, ]
 Site-White                    | Train Loss: 1.3565 | Train Acc: 0.4964
 Site-White                    | Train Loss: 1.1944 | Train Acc: 0.5228
 Site-Latino_Hispanic          | Train Loss: 1.6247 | Train Acc: 0.4676
 Site-Latino_Hispanic          | Train Loss: 1.3734 | Train Acc: 0.4484
 Site-Black                    | Train Loss: 1.5789 | Train Acc: 0.4101
 Site-Black                    | Train Loss: 1.4605 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.2958 | Train Acc: 0.4820
 Site-East_Asian               | Train Loss: 1.2939 | Train Acc: 0.5276
 Site-Indian                   | Train Loss: 1.2590 | Train Acc: 0.5324
 Site-Indian                   | Train Loss: 1.3335 | Train Acc: 0.4269
 Site-Southeast_Asian          | Train Loss: 1.4103 | Train Acc: 0.5036
 Site-Southeast_Asian          | Train Loss: 1.3707 | Train Acc: 0.5084
 Site-Middle_Eastern           | Train Loss: 1.3516 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.1815 | Train Acc: 0.5132
 Site-White                     (2) | Val  Loss: 1.2586 | Val  Acc: 0.5543
 Site-White                     (2) | Val  Loss: 1.2703 | Val  Acc: 0.5216
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3770 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3738 | Val  Acc: 0.4604
 Site-Black                     (4) | Val  Loss: 1.2764 | Val  Acc: 0.5870
 Site-Black                     (4) | Val  Loss: 1.4224 | Val  Acc: 0.4604
 Site-East_Asian                (0) | Val  Loss: 1.1581 | Val  Acc: 0.6087
 Site-East_Asian                (1) | Val  Loss: 1.2562 | Val  Acc: 0.5432
 Site-Indian                    (5) | Val  Loss: 1.4036 | Val  Acc: 0.4130
 Site-Indian                    (5) | Val  Loss: 1.3319 | Val  Acc: 0.4820
 Site-Southeast_Asian           (1) | Val  Loss: 1.3404 | Val  Acc: 0.4457
 Site-Southeast_Asian           (1) | Val  Loss: 1.2977 | Val  Acc: 0.4892
 Site-Middle_Eastern            (1) | Val  Loss: 1.3021 | Val  Acc: 0.5109
 Site-Middle_Eastern            (5) | Val  Loss: 1.3510 | Val  Acc: 0.4712
Average Valid Accuracy: 0.5011
 Test site-White                     (2)| Epoch:41 | Test Acc: 0.4251
 Test site-Latino_Hispanic           (6)| Epoch:41 | Test Acc: 0.3734
 Test site-Black                     (4)| Epoch:41 | Test Acc: 0.3531
 Test site-East_Asian                (0)| Epoch:41 | Test Acc: 0.5097
 Test site-Indian                    (5)| Epoch:41 | Test Acc: 0.3469
 Test site-Southeast_Asian           (1)| Epoch:41 | Test Acc: 0.4407
 Test site-Middle_Eastern            (1)| Epoch:41 | Test Acc: 0.4072
White: 0.4251, Latino_Hispanic: 0.3734, Black: 0.3531, East_Asian: 0.5097, Indian: 0.3469, Southeast_Asian: 0.4407, Middle_Eastern: 0.4072, 
Average Test Accuracy(group): 0.4080, Average Test Accuracy(individual): 0.4080,
domain std=0.0530, cluster std=nan, individual std=0.0530, 
Average Test Accuracy: 0.4080
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 43 ============
cnt=[2, 4, 4, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
quan_i=1.45, quan_c=1.39
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.2812 | Train Acc: 0.5396
 Site-White                    | Train Loss: 1.2502 | Train Acc: 0.4988
 Site-Latino_Hispanic          | Train Loss: 1.5658 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.3685 | Train Acc: 0.4604
 Site-Black                    | Train Loss: 1.5780 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.3935 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.3398 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.3028 | Train Acc: 0.5204
 Site-Indian                   | Train Loss: 1.2879 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.3599 | Train Acc: 0.4508
 Site-Southeast_Asian          | Train Loss: 1.3931 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3372 | Train Acc: 0.4964
 Site-Middle_Eastern           | Train Loss: 1.3817 | Train Acc: 0.4676
 Site-Middle_Eastern           | Train Loss: 1.3149 | Train Acc: 0.5276
 Site-White                     (5) | Val  Loss: 1.2656 | Val  Acc: 0.5652
 Site-White                     (4) | Val  Loss: 1.2778 | Val  Acc: 0.5360
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4202 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3912 | Val  Acc: 0.4245
 Site-Black                     (3) | Val  Loss: 1.2221 | Val  Acc: 0.5978
 Site-Black                     (6) | Val  Loss: 1.4106 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.2152 | Val  Acc: 0.5870
 Site-East_Asian                (1) | Val  Loss: 1.2453 | Val  Acc: 0.5432
 Site-Indian                    (2) | Val  Loss: 1.4184 | Val  Acc: 0.4457
 Site-Indian                    (2) | Val  Loss: 1.3315 | Val  Acc: 0.4748
 Site-Southeast_Asian           (1) | Val  Loss: 1.3412 | Val  Acc: 0.4565
 Site-Southeast_Asian           (1) | Val  Loss: 1.3114 | Val  Acc: 0.4892
 Site-Middle_Eastern            (0) | Val  Loss: 1.3278 | Val  Acc: 0.4674
 Site-Middle_Eastern            (0) | Val  Loss: 1.2977 | Val  Acc: 0.4856
Average Valid Accuracy: 0.5005
 Test site-White                     (5)| Epoch:42 | Test Acc: 0.4251
 Test site-Latino_Hispanic           (2)| Epoch:42 | Test Acc: 0.3797
 Test site-Black                     (3)| Epoch:42 | Test Acc: 0.3500
 Test site-East_Asian                (1)| Epoch:42 | Test Acc: 0.5000
 Test site-Indian                    (2)| Epoch:42 | Test Acc: 0.3397
 Test site-Southeast_Asian           (1)| Epoch:42 | Test Acc: 0.4407
 Test site-Middle_Eastern            (0)| Epoch:42 | Test Acc: 0.4098
White: 0.4251, Latino_Hispanic: 0.3797, Black: 0.3500, East_Asian: 0.5000, Indian: 0.3397, Southeast_Asian: 0.4407, Middle_Eastern: 0.4098, 
Average Test Accuracy(group): 0.4064, Average Test Accuracy(individual): 0.4064,
domain std=0.0516, cluster std=nan, individual std=0.0516, 
Average Test Accuracy: 0.4064
============ Train epoch 44 ============
cnt=[4, 3, 1, 1, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
quan_i=1.41, quan_c=1.41
enlarge weight of clients:[2, 4, ]
 Site-White                    | Train Loss: 1.2651 | Train Acc: 0.5180
 Site-White                    | Train Loss: 1.2272 | Train Acc: 0.5204
 Site-Latino_Hispanic          | Train Loss: 1.5539 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.3703 | Train Acc: 0.4628
 Site-Black                    | Train Loss: 1.6077 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.3931 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.2948 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.2184 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.2693 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.3642 | Train Acc: 0.4412
 Site-Southeast_Asian          | Train Loss: 1.3513 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.3606 | Train Acc: 0.5012
 Site-Middle_Eastern           | Train Loss: 1.3687 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.2725 | Train Acc: 0.5252
 Site-White                     (6) | Val  Loss: 1.3254 | Val  Acc: 0.5109
 Site-White                     (2) | Val  Loss: 1.2977 | Val  Acc: 0.4892
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3558 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3905 | Val  Acc: 0.4640
 Site-Black                     (5) | Val  Loss: 1.2037 | Val  Acc: 0.6087
 Site-Black                     (3) | Val  Loss: 1.4115 | Val  Acc: 0.4712
 Site-East_Asian                (0) | Val  Loss: 1.1674 | Val  Acc: 0.5435
 Site-East_Asian                (0) | Val  Loss: 1.2148 | Val  Acc: 0.5252
 Site-Indian                    (1) | Val  Loss: 1.4130 | Val  Acc: 0.4674
 Site-Indian                    (1) | Val  Loss: 1.3397 | Val  Acc: 0.4748
 Site-Southeast_Asian           (0) | Val  Loss: 1.2875 | Val  Acc: 0.5000
 Site-Southeast_Asian           (0) | Val  Loss: 1.2989 | Val  Acc: 0.5252
 Site-Middle_Eastern            (6) | Val  Loss: 1.3596 | Val  Acc: 0.5326
 Site-Middle_Eastern            (1) | Val  Loss: 1.2898 | Val  Acc: 0.4748
Average Valid Accuracy: 0.5039
 Test site-White                     (6)| Epoch:42 | Test Acc: 0.4332
 Test site-Latino_Hispanic           (4)| Epoch:42 | Test Acc: 0.3829
 Test site-Black                     (5)| Epoch:42 | Test Acc: 0.3625
 Test site-East_Asian                (0)| Epoch:42 | Test Acc: 0.5130
 Test site-Indian                    (1)| Epoch:42 | Test Acc: 0.3589
 Test site-Southeast_Asian           (0)| Epoch:42 | Test Acc: 0.4370
 Test site-Middle_Eastern            (6)| Epoch:42 | Test Acc: 0.4201
White: 0.4332, Latino_Hispanic: 0.3829, Black: 0.3625, East_Asian: 0.5130, Indian: 0.3589, Southeast_Asian: 0.4370, Middle_Eastern: 0.4201, 
Average Test Accuracy(group): 0.4154, Average Test Accuracy(individual): 0.4154,
domain std=0.0498, cluster std=nan, individual std=0.0498, 
Average Test Accuracy: 0.4154
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_relu/ccop_q=1...
============ Train epoch 45 ============
cnt=[2, 3, 2, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
quan_i=1.40, quan_c=1.39
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.3061 | Train Acc: 0.5468
 Site-White                    | Train Loss: 1.2956 | Train Acc: 0.5372
 Site-Latino_Hispanic          | Train Loss: 1.4849 | Train Acc: 0.4388
 Site-Latino_Hispanic          | Train Loss: 1.3480 | Train Acc: 0.4460
 Site-Black                    | Train Loss: 1.5161 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.4527 | Train Acc: 0.4796
 Site-East_Asian               | Train Loss: 1.3559 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.3008 | Train Acc: 0.5036
 Site-Indian                   | Train Loss: 1.2917 | Train Acc: 0.5324
 Site-Indian                   | Train Loss: 1.3112 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.4473 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3193 | Train Acc: 0.5252
 Site-Middle_Eastern           | Train Loss: 1.3144 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.2370 | Train Acc: 0.5276
 Site-White                     (3) | Val  Loss: 1.2472 | Val  Acc: 0.5543
 Site-White                     (1) | Val  Loss: 1.2790 | Val  Acc: 0.5108
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4024 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3736 | Val  Acc: 0.4640
 Site-Black                     (2) | Val  Loss: 1.2980 | Val  Acc: 0.5543
 Site-Black                     (2) | Val  Loss: 1.4035 | Val  Acc: 0.4604
 Site-East_Asian                (6) | Val  Loss: 1.1679 | Val  Acc: 0.5435
 Site-East_Asian                (5) | Val  Loss: 1.2334 | Val  Acc: 0.5612
 Site-Indian                    (4) | Val  Loss: 1.3646 | Val  Acc: 0.4130
 Site-Indian                    (4) | Val  Loss: 1.3552 | Val  Acc: 0.4604
 Site-Southeast_Asian           (0) | Val  Loss: 1.2888 | Val  Acc: 0.5326
 Site-Southeast_Asian           (0) | Val  Loss: 1.2903 | Val  Acc: 0.5180
 Site-Middle_Eastern            (1) | Val  Loss: 1.3149 | Val  Acc: 0.5217
 Site-Middle_Eastern            (1) | Val  Loss: 1.2969 | Val  Acc: 0.4892
Average Valid Accuracy: 0.5005
 Test site-White                     (3)| Epoch:44 | Test Acc: 0.4278
 Test site-Latino_Hispanic           (4)| Epoch:44 | Test Acc: 0.3797
 Test site-Black                     (2)| Epoch:44 | Test Acc: 0.3469
 Test site-East_Asian                (6)| Epoch:44 | Test Acc: 0.5000
 Test site-Indian                    (4)| Epoch:44 | Test Acc: 0.3517
 Test site-Southeast_Asian           (0)| Epoch:44 | Test Acc: 0.4444
 Test site-Middle_Eastern            (1)| Epoch:44 | Test Acc: 0.4098
White: 0.4278, Latino_Hispanic: 0.3797, Black: 0.3469, East_Asian: 0.5000, Indian: 0.3517, Southeast_Asian: 0.4444, Middle_Eastern: 0.4098, 
Average Test Accuracy(group): 0.4086, Average Test Accuracy(individual): 0.4086,
domain std=0.0506, cluster std=nan, individual std=0.0506, 
Average Test Accuracy: 0.4086
============ Train epoch 46 ============
cnt=[2, 2, 1, 3, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
quan_i=1.46, quan_c=1.39
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.3345 | Train Acc: 0.5108
 Site-White                    | Train Loss: 1.2329 | Train Acc: 0.4916
 Site-Latino_Hispanic          | Train Loss: 1.5730 | Train Acc: 0.4173
 Site-Latino_Hispanic          | Train Loss: 1.3538 | Train Acc: 0.4365
 Site-Black                    | Train Loss: 1.5339 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.4012 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.3117 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.2438 | Train Acc: 0.5276
 Site-Indian                   | Train Loss: 1.2653 | Train Acc: 0.5108
 Site-Indian                   | Train Loss: 1.3859 | Train Acc: 0.4868
 Site-Southeast_Asian          | Train Loss: 1.3736 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.3198 | Train Acc: 0.5228
 Site-Middle_Eastern           | Train Loss: 1.4640 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.2314 | Train Acc: 0.5228
 Site-White                     (1) | Val  Loss: 1.2718 | Val  Acc: 0.5652
 Site-White                     (1) | Val  Loss: 1.2739 | Val  Acc: 0.4820
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3684 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3356 | Val  Acc: 0.4964
 Site-Black                     (6) | Val  Loss: 1.2864 | Val  Acc: 0.5543
 Site-Black                     (6) | Val  Loss: 1.3792 | Val  Acc: 0.5108
 Site-East_Asian                (3) | Val  Loss: 1.1783 | Val  Acc: 0.5435
 Site-East_Asian                (2) | Val  Loss: 1.2311 | Val  Acc: 0.5432
 Site-Indian                    (0) | Val  Loss: 1.4212 | Val  Acc: 0.4022
 Site-Indian                    (0) | Val  Loss: 1.3454 | Val  Acc: 0.4532
 Site-Southeast_Asian           (3) | Val  Loss: 1.3033 | Val  Acc: 0.4674
 Site-Southeast_Asian           (3) | Val  Loss: 1.3180 | Val  Acc: 0.5072
 Site-Middle_Eastern            (4) | Val  Loss: 1.3398 | Val  Acc: 0.5435
 Site-Middle_Eastern            (4) | Val  Loss: 1.3025 | Val  Acc: 0.4964
Average Valid Accuracy: 0.5023
 Test site-White                     (1)| Epoch:44 | Test Acc: 0.4305
 Test site-Latino_Hispanic           (5)| Epoch:44 | Test Acc: 0.3734
 Test site-Black                     (6)| Epoch:44 | Test Acc: 0.3563
 Test site-East_Asian                (3)| Epoch:44 | Test Acc: 0.5097
 Test site-Indian                    (0)| Epoch:44 | Test Acc: 0.3565
 Test site-Southeast_Asian           (3)| Epoch:44 | Test Acc: 0.4444
 Test site-Middle_Eastern            (4)| Epoch:44 | Test Acc: 0.4021
White: 0.4305, Latino_Hispanic: 0.3734, Black: 0.3563, East_Asian: 0.5097, Indian: 0.3565, Southeast_Asian: 0.4444, Middle_Eastern: 0.4021, 
Average Test Accuracy(group): 0.4104, Average Test Accuracy(individual): 0.4104,
domain std=0.0517, cluster std=nan, individual std=0.0517, 
Average Test Accuracy: 0.4104
============ Train epoch 47 ============
cnt=[4, 1, 2, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
quan_i=1.43, quan_c=1.40
enlarge weight of clients:[2, 4, ]
 Site-White                    | Train Loss: 1.3156 | Train Acc: 0.5324
 Site-White                    | Train Loss: 1.3312 | Train Acc: 0.4916
 Site-Latino_Hispanic          | Train Loss: 1.5643 | Train Acc: 0.4532
 Site-Latino_Hispanic          | Train Loss: 1.3481 | Train Acc: 0.4532
 Site-Black                    | Train Loss: 1.5993 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.4230 | Train Acc: 0.4724
 Site-East_Asian               | Train Loss: 1.3300 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.2726 | Train Acc: 0.5084
 Site-Indian                   | Train Loss: 1.2889 | Train Acc: 0.5108
 Site-Indian                   | Train Loss: 1.2709 | Train Acc: 0.4580
 Site-Southeast_Asian          | Train Loss: 1.3641 | Train Acc: 0.4317
 Site-Southeast_Asian          | Train Loss: 1.2358 | Train Acc: 0.5228
 Site-Middle_Eastern           | Train Loss: 1.3254 | Train Acc: 0.4317
 Site-Middle_Eastern           | Train Loss: 1.2329 | Train Acc: 0.4892
 Site-White                     (3) | Val  Loss: 1.2695 | Val  Acc: 0.5000
 Site-White                     (5) | Val  Loss: 1.2957 | Val  Acc: 0.4856
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4003 | Val  Acc: 0.4783
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3761 | Val  Acc: 0.4532
 Site-Black                     (2) | Val  Loss: 1.3245 | Val  Acc: 0.5326
 Site-Black                     (2) | Val  Loss: 1.4350 | Val  Acc: 0.4676
 Site-East_Asian                (0) | Val  Loss: 1.1854 | Val  Acc: 0.5652
 Site-East_Asian                (0) | Val  Loss: 1.2457 | Val  Acc: 0.5540
 Site-Indian                    (6) | Val  Loss: 1.3754 | Val  Acc: 0.3913
 Site-Indian                    (6) | Val  Loss: 1.3149 | Val  Acc: 0.4784
 Site-Southeast_Asian           (0) | Val  Loss: 1.3102 | Val  Acc: 0.5000
 Site-Southeast_Asian           (0) | Val  Loss: 1.2821 | Val  Acc: 0.5324
 Site-Middle_Eastern            (5) | Val  Loss: 1.3405 | Val  Acc: 0.4674
 Site-Middle_Eastern            (5) | Val  Loss: 1.2999 | Val  Acc: 0.5252
Average Valid Accuracy: 0.4951
 Test site-White                     (3)| Epoch:44 | Test Acc: 0.4251
 Test site-Latino_Hispanic           (1)| Epoch:44 | Test Acc: 0.3734
 Test site-Black                     (2)| Epoch:44 | Test Acc: 0.3594
 Test site-East_Asian                (0)| Epoch:44 | Test Acc: 0.5000
 Test site-Indian                    (6)| Epoch:44 | Test Acc: 0.3541
 Test site-Southeast_Asian           (0)| Epoch:44 | Test Acc: 0.4444
 Test site-Middle_Eastern            (5)| Epoch:44 | Test Acc: 0.3892
White: 0.4251, Latino_Hispanic: 0.3734, Black: 0.3594, East_Asian: 0.5000, Indian: 0.3541, Southeast_Asian: 0.4444, Middle_Eastern: 0.3892, 
Average Test Accuracy(group): 0.4065, Average Test Accuracy(individual): 0.4065,
domain std=0.0491, cluster std=nan, individual std=0.0491, 
Average Test Accuracy: 0.4065
============ Train epoch 48 ============
cnt=[2, 3, 2, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
quan_i=1.39, quan_c=1.33
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.3423 | Train Acc: 0.5036
 Site-White                    | Train Loss: 1.2753 | Train Acc: 0.5324
 Site-Latino_Hispanic          | Train Loss: 1.5363 | Train Acc: 0.4748
 Site-Latino_Hispanic          | Train Loss: 1.3884 | Train Acc: 0.4556
 Site-Black                    | Train Loss: 1.6222 | Train Acc: 0.3525
 Site-Black                    | Train Loss: 1.4542 | Train Acc: 0.4820
 Site-East_Asian               | Train Loss: 1.4226 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.2855 | Train Acc: 0.5300
 Site-Indian                   | Train Loss: 1.2839 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.3199 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.3612 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.2665 | Train Acc: 0.5132
 Site-Middle_Eastern           | Train Loss: 1.4159 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.2977 | Train Acc: 0.5012
 Site-White                     (6) | Val  Loss: 1.2311 | Val  Acc: 0.5326
 Site-White                     (4) | Val  Loss: 1.2762 | Val  Acc: 0.5180
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3793 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3466 | Val  Acc: 0.4820
 Site-Black                     (2) | Val  Loss: 1.2987 | Val  Acc: 0.5652
 Site-Black                     (2) | Val  Loss: 1.3954 | Val  Acc: 0.5108
 Site-East_Asian                (5) | Val  Loss: 1.2094 | Val  Acc: 0.5217
 Site-East_Asian                (5) | Val  Loss: 1.2361 | Val  Acc: 0.5180
 Site-Indian                    (0) | Val  Loss: 1.3886 | Val  Acc: 0.4022
 Site-Indian                    (0) | Val  Loss: 1.3143 | Val  Acc: 0.4640
 Site-Southeast_Asian           (3) | Val  Loss: 1.3394 | Val  Acc: 0.5109
 Site-Southeast_Asian           (3) | Val  Loss: 1.2934 | Val  Acc: 0.5180
 Site-Middle_Eastern            (1) | Val  Loss: 1.3288 | Val  Acc: 0.5000
 Site-Middle_Eastern            (1) | Val  Loss: 1.2824 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5000
 Test site-White                     (6)| Epoch:44 | Test Acc: 0.4305
 Test site-Latino_Hispanic           (1)| Epoch:44 | Test Acc: 0.3703
 Test site-Black                     (2)| Epoch:44 | Test Acc: 0.3531
 Test site-East_Asian                (5)| Epoch:44 | Test Acc: 0.4968
 Test site-Indian                    (0)| Epoch:44 | Test Acc: 0.3589
 Test site-Southeast_Asian           (3)| Epoch:44 | Test Acc: 0.4370
 Test site-Middle_Eastern            (1)| Epoch:44 | Test Acc: 0.3995
White: 0.4305, Latino_Hispanic: 0.3703, Black: 0.3531, East_Asian: 0.4968, Indian: 0.3589, Southeast_Asian: 0.4370, Middle_Eastern: 0.3995, 
Average Test Accuracy(group): 0.4066, Average Test Accuracy(individual): 0.4066,
domain std=0.0480, cluster std=nan, individual std=0.0480, 
Average Test Accuracy: 0.4066
============ Train epoch 49 ============
cnt=[2, 3, 2, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
quan_i=1.45, quan_c=1.43
enlarge weight of clients:[4, 5, ]
 Site-White                    | Train Loss: 1.2550 | Train Acc: 0.5468
 Site-White                    | Train Loss: 1.2412 | Train Acc: 0.5060
 Site-Latino_Hispanic          | Train Loss: 1.5125 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.3545 | Train Acc: 0.4580
 Site-Black                    | Train Loss: 1.6126 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.3946 | Train Acc: 0.4820
 Site-East_Asian               | Train Loss: 1.3018 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.3828 | Train Acc: 0.5228
 Site-Indian                   | Train Loss: 1.3104 | Train Acc: 0.5540
 Site-Indian                   | Train Loss: 1.3119 | Train Acc: 0.4868
 Site-Southeast_Asian          | Train Loss: 1.3936 | Train Acc: 0.5180
 Site-Southeast_Asian          | Train Loss: 1.3261 | Train Acc: 0.5012
 Site-Middle_Eastern           | Train Loss: 1.3038 | Train Acc: 0.4964
 Site-Middle_Eastern           | Train Loss: 1.1667 | Train Acc: 0.5204
 Site-White                     (1) | Val  Loss: 1.2783 | Val  Acc: 0.5109
 Site-White                     (5) | Val  Loss: 1.2535 | Val  Acc: 0.5216
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3498 | Val  Acc: 0.4783
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3653 | Val  Acc: 0.4928
 Site-Black                     (3) | Val  Loss: 1.2728 | Val  Acc: 0.5543
 Site-Black                     (3) | Val  Loss: 1.3403 | Val  Acc: 0.5216
 Site-East_Asian                (1) | Val  Loss: 1.1878 | Val  Acc: 0.5109
 Site-East_Asian                (1) | Val  Loss: 1.2369 | Val  Acc: 0.5252
 Site-Indian                    (2) | Val  Loss: 1.3699 | Val  Acc: 0.4239
 Site-Indian                    (2) | Val  Loss: 1.3351 | Val  Acc: 0.4856
 Site-Southeast_Asian           (6) | Val  Loss: 1.3030 | Val  Acc: 0.4565
 Site-Southeast_Asian           (6) | Val  Loss: 1.2985 | Val  Acc: 0.5324
 Site-Middle_Eastern            (4) | Val  Loss: 1.3426 | Val  Acc: 0.5217
 Site-Middle_Eastern            (4) | Val  Loss: 1.3003 | Val  Acc: 0.4892
Average Valid Accuracy: 0.5018
 Test site-White                     (1)| Epoch:44 | Test Acc: 0.4439
 Test site-Latino_Hispanic           (0)| Epoch:44 | Test Acc: 0.3671
 Test site-Black                     (3)| Epoch:44 | Test Acc: 0.3625
 Test site-East_Asian                (1)| Epoch:44 | Test Acc: 0.5130
 Test site-Indian                    (2)| Epoch:44 | Test Acc: 0.3469
 Test site-Southeast_Asian           (6)| Epoch:44 | Test Acc: 0.4519
 Test site-Middle_Eastern            (4)| Epoch:44 | Test Acc: 0.3892
White: 0.4439, Latino_Hispanic: 0.3671, Black: 0.3625, East_Asian: 0.5130, Indian: 0.3469, Southeast_Asian: 0.4519, Middle_Eastern: 0.3892, 
Average Test Accuracy(group): 0.4106, Average Test Accuracy(individual): 0.4106,
domain std=0.0561, cluster std=nan, individual std=0.0561, 
Average Test Accuracy: 0.4106
===2023-06-08 12:16:20===
===2023-06-08 12:16:34===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0.8
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[139,417,139,417,139,417,139,417,139,417,139,417,139,417,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1856,1856,1856,1856,1856,1856,1856,]
domain number = 7
Loading snapshots...
 Test site-White                     (6)| Epoch:44 | Test Acc: 0.4332
 Test site-Latino_Hispanic           (4)| Epoch:44 | Test Acc: 0.3829
 Test site-Black                     (5)| Epoch:44 | Test Acc: 0.3625
 Test site-East_Asian                (0)| Epoch:44 | Test Acc: 0.5130
 Test site-Indian                    (1)| Epoch:44 | Test Acc: 0.3589
 Test site-Southeast_Asian           (0)| Epoch:44 | Test Acc: 0.4370
 Test site-Middle_Eastern            (6)| Epoch:44 | Test Acc: 0.4201
White: 0.4332, Latino_Hispanic: 0.3829, Black: 0.3625, East_Asian: 0.5130, Indian: 0.3589, Southeast_Asian: 0.4370, Middle_Eastern: 0.4201, 
Average Test Accuracy(group): 0.4154, Average Test Accuracy(individual): 0.4154,
domain std=0.0498, cluster std=nan, individual std=0.0498, 
