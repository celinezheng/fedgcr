===2023-07-28 18:42:09===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 1.1147 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 1.1814 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.9766 | Train Acc: 0.9048
 Site-MNIST                         | Train Loss: 1.0300 | Train Acc: 0.8421
 Site-MNIST                         | Train Loss: 0.9890 | Train Acc: 0.8286
 Site-MNIST                         | Train Loss: 1.0846 | Train Acc: 0.8492
 Site-MNIST                         | Train Loss: 1.0894 | Train Acc: 0.7974
 Site-MNIST                         | Train Loss: 1.1274 | Train Acc: 0.7555
 Site-MNIST                         | Train Loss: 1.1003 | Train Acc: 0.8003
 Site-MNIST                         | Train Loss: 1.0693 | Train Acc: 0.8121
 Site-USPS                          | Train Loss: 1.1083 | Train Acc: 0.8000
 Site-USPS                          | Train Loss: 1.0366 | Train Acc: 0.7222
 Site-USPS                          | Train Loss: 0.8814 | Train Acc: 0.7829
 Site-USPS                          | Train Loss: 1.1047 | Train Acc: 0.7597
 Site-USPS                          | Train Loss: 1.0751 | Train Acc: 0.8071
 Site-USPS                          | Train Loss: 1.0930 | Train Acc: 0.7857
 Site-SynthDigits                   | Train Loss: 2.0025 | Train Acc: 0.2914
 Site-SynthDigits                   | Train Loss: 2.0440 | Train Acc: 0.2711
 Site-SynthDigits                   | Train Loss: 1.9288 | Train Acc: 0.3279
 Site-MNIST_M                       | Train Loss: 2.1175 | Train Acc: 0.2762
 Site-MNIST_M                       | Train Loss: 2.1042 | Train Acc: 0.3394
 Site-SVHN                          | Train Loss: 2.2325 | Train Acc: 0.1631
Average Train Accuracy: 0.6667
 Site-MNIST                         | Val  Loss: 0.8856 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.9755 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 1.0233 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 1.1355 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 1.0870 | Val  Acc: 0.7647
 Site-MNIST                         | Val  Loss: 1.1777 | Val  Acc: 0.8065
 Site-MNIST                         | Val  Loss: 1.1345 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.0844 | Val  Acc: 0.8039
 Site-MNIST                         | Val  Loss: 1.0937 | Val  Acc: 0.7869
 Site-MNIST                         | Val  Loss: 1.0844 | Val  Acc: 0.7855
 Site-USPS                          | Val  Loss: 0.8912 | Val  Acc: 0.9000
 Site-USPS                          | Val  Loss: 1.2924 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 1.2401 | Val  Acc: 0.6875
 Site-USPS                          | Val  Loss: 1.2308 | Val  Acc: 0.6724
 Site-USPS                          | Val  Loss: 1.1487 | Val  Acc: 0.7238
 Site-USPS                          | Val  Loss: 1.0571 | Val  Acc: 0.7831
 Site-SynthDigits                   | Val  Loss: 2.0330 | Val  Acc: 0.2703
 Site-SynthDigits                   | Val  Loss: 2.2061 | Val  Acc: 0.3382
 Site-SynthDigits                   | Val  Loss: 2.0234 | Val  Acc: 0.3197
 Site-MNIST_M                       | Val  Loss: 2.0880 | Val  Acc: 0.2889
 Site-MNIST_M                       | Val  Loss: 2.0654 | Val  Acc: 0.3333
 Site-SVHN                          | Val  Loss: 2.3296 | Val  Acc: 0.1429
Average Valid Accuracy: 0.6571
 Best site-MNIST                     | Epoch:0 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:0 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7647
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.8065
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.8039
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7869
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7855
 Best site-USPS                      | Epoch:0 | Val Acc: 0.9000
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6875
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6724
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7238
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7831
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2703
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.3382
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.3197
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.2889
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.3333
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/fedsam...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 0.6493 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.8267 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.5171 | Train Acc: 0.9048
 Site-MNIST                         | Train Loss: 0.5676 | Train Acc: 0.9211
 Site-MNIST                         | Train Loss: 0.5656 | Train Acc: 0.8571
 Site-MNIST                         | Train Loss: 0.6528 | Train Acc: 0.8413
 Site-MNIST                         | Train Loss: 0.6526 | Train Acc: 0.8546
 Site-MNIST                         | Train Loss: 0.7430 | Train Acc: 0.8215
 Site-MNIST                         | Train Loss: 0.6722 | Train Acc: 0.8465
 Site-MNIST                         | Train Loss: 0.6404 | Train Acc: 0.8672
 Site-USPS                          | Train Loss: 0.8325 | Train Acc: 0.7750
 Site-USPS                          | Train Loss: 0.8475 | Train Acc: 0.7361
 Site-USPS                          | Train Loss: 0.6173 | Train Acc: 0.8140
 Site-USPS                          | Train Loss: 0.8155 | Train Acc: 0.7768
 Site-USPS                          | Train Loss: 0.7286 | Train Acc: 0.8095
 Site-USPS                          | Train Loss: 0.7680 | Train Acc: 0.7857
 Site-SynthDigits                   | Train Loss: 1.8921 | Train Acc: 0.3311
 Site-SynthDigits                   | Train Loss: 1.8703 | Train Acc: 0.3480
 Site-SynthDigits                   | Train Loss: 1.7522 | Train Acc: 0.3849
 Site-MNIST_M                       | Train Loss: 1.9002 | Train Acc: 0.3591
 Site-MNIST_M                       | Train Loss: 1.9219 | Train Acc: 0.3823
 Site-SVHN                          | Train Loss: 2.2073 | Train Acc: 0.1809
Average Train Accuracy: 0.7052
 Site-MNIST                         | Val  Loss: 0.1992 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.5110 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.7672 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.8565 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.7244 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.6920 | Val  Acc: 0.9032
 Site-MNIST                         | Val  Loss: 0.6605 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.6399 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.6843 | Val  Acc: 0.8415
 Site-MNIST                         | Val  Loss: 0.6977 | Val  Acc: 0.8369
 Site-USPS                          | Val  Loss: 0.5370 | Val  Acc: 0.9000
 Site-USPS                          | Val  Loss: 1.0478 | Val  Acc: 0.6111
 Site-USPS                          | Val  Loss: 1.0595 | Val  Acc: 0.5625
 Site-USPS                          | Val  Loss: 1.0280 | Val  Acc: 0.6379
 Site-USPS                          | Val  Loss: 0.8780 | Val  Acc: 0.7429
 Site-USPS                          | Val  Loss: 0.7671 | Val  Acc: 0.8201
 Site-SynthDigits                   | Val  Loss: 1.7891 | Val  Acc: 0.3784
 Site-SynthDigits                   | Val  Loss: 1.9573 | Val  Acc: 0.3824
 Site-SynthDigits                   | Val  Loss: 1.8762 | Val  Acc: 0.3852
 Site-MNIST_M                       | Val  Loss: 1.8590 | Val  Acc: 0.4222
 Site-MNIST_M                       | Val  Loss: 1.7989 | Val  Acc: 0.4321
 Site-SVHN                          | Val  Loss: 2.2471 | Val  Acc: 0.2000
Average Valid Accuracy: 0.7001
 Best site-MNIST                     | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.9032
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8415
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8369
 Best site-USPS                      | Epoch:1 | Val Acc: 0.9000
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6111
 Best site-USPS                      | Epoch:1 | Val Acc: 0.5625
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6379
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7429
 Best site-USPS                      | Epoch:1 | Val Acc: 0.8201
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3784
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3824
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3852
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.4222
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.4321
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/fedsam...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 0.4402 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.6359 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.3011 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.3854 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.3483 | Train Acc: 0.8429
 Site-MNIST                         | Train Loss: 0.4538 | Train Acc: 0.8968
 Site-MNIST                         | Train Loss: 0.4477 | Train Acc: 0.8678
 Site-MNIST                         | Train Loss: 0.5459 | Train Acc: 0.8582
 Site-MNIST                         | Train Loss: 0.4794 | Train Acc: 0.8791
 Site-MNIST                         | Train Loss: 0.4597 | Train Acc: 0.8974
 Site-USPS                          | Train Loss: 0.6677 | Train Acc: 0.8250
 Site-USPS                          | Train Loss: 0.5391 | Train Acc: 0.8472
 Site-USPS                          | Train Loss: 0.4967 | Train Acc: 0.8527
 Site-USPS                          | Train Loss: 0.6859 | Train Acc: 0.7940
 Site-USPS                          | Train Loss: 0.5367 | Train Acc: 0.8524
 Site-USPS                          | Train Loss: 0.5849 | Train Acc: 0.8267
 Site-SynthDigits                   | Train Loss: 1.8131 | Train Acc: 0.4040
 Site-SynthDigits                   | Train Loss: 1.7970 | Train Acc: 0.4249
 Site-SynthDigits                   | Train Loss: 1.6603 | Train Acc: 0.4481
 Site-MNIST_M                       | Train Loss: 1.8904 | Train Acc: 0.3591
 Site-MNIST_M                       | Train Loss: 1.8867 | Train Acc: 0.3456
 Site-SVHN                          | Train Loss: 2.1818 | Train Acc: 0.2057
Average Train Accuracy: 0.7308
 Site-MNIST                         | Val  Loss: 0.1603 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3777 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.6011 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.6233 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.5167 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.4526 | Val  Acc: 0.9032
 Site-MNIST                         | Val  Loss: 0.4519 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.4400 | Val  Acc: 0.8922
 Site-MNIST                         | Val  Loss: 0.4918 | Val  Acc: 0.8798
 Site-MNIST                         | Val  Loss: 0.5089 | Val  Acc: 0.8640
 Site-USPS                          | Val  Loss: 0.3392 | Val  Acc: 0.9000
 Site-USPS                          | Val  Loss: 0.9705 | Val  Acc: 0.6111
 Site-USPS                          | Val  Loss: 0.9482 | Val  Acc: 0.6562
 Site-USPS                          | Val  Loss: 0.8843 | Val  Acc: 0.7069
 Site-USPS                          | Val  Loss: 0.7354 | Val  Acc: 0.7714
 Site-USPS                          | Val  Loss: 0.6158 | Val  Acc: 0.8201
 Site-SynthDigits                   | Val  Loss: 1.7590 | Val  Acc: 0.4595
 Site-SynthDigits                   | Val  Loss: 1.9751 | Val  Acc: 0.4265
 Site-SynthDigits                   | Val  Loss: 1.8330 | Val  Acc: 0.4016
 Site-MNIST_M                       | Val  Loss: 1.8107 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 1.7645 | Val  Acc: 0.4444
 Site-SVHN                          | Val  Loss: 2.1893 | Val  Acc: 0.2143
Average Valid Accuracy: 0.7189
 Best site-MNIST                     | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.9032
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8922
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8798
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8640
 Best site-USPS                      | Epoch:2 | Val Acc: 0.9000
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6111
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6562
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7069
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7714
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8201
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.4595
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.4265
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.4016
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4000
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4444
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/fedsam...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 0.2805 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.6046 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.2655 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.3288 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.3011 | Train Acc: 0.9000
 Site-MNIST                         | Train Loss: 0.3995 | Train Acc: 0.8651
 Site-MNIST                         | Train Loss: 0.3768 | Train Acc: 0.8634
 Site-MNIST                         | Train Loss: 0.4452 | Train Acc: 0.8655
 Site-MNIST                         | Train Loss: 0.3874 | Train Acc: 0.8927
 Site-MNIST                         | Train Loss: 0.3744 | Train Acc: 0.9064
 Site-USPS                          | Train Loss: 0.5439 | Train Acc: 0.8750
 Site-USPS                          | Train Loss: 0.3873 | Train Acc: 0.8750
 Site-USPS                          | Train Loss: 0.3500 | Train Acc: 0.8682
 Site-USPS                          | Train Loss: 0.5463 | Train Acc: 0.8412
 Site-USPS                          | Train Loss: 0.4064 | Train Acc: 0.8857
 Site-USPS                          | Train Loss: 0.4465 | Train Acc: 0.8770
 Site-SynthDigits                   | Train Loss: 1.7290 | Train Acc: 0.4503
 Site-SynthDigits                   | Train Loss: 1.6622 | Train Acc: 0.4579
 Site-SynthDigits                   | Train Loss: 1.5480 | Train Acc: 0.4827
 Site-MNIST_M                       | Train Loss: 1.7707 | Train Acc: 0.4254
 Site-MNIST_M                       | Train Loss: 1.8721 | Train Acc: 0.3914
 Site-SVHN                          | Train Loss: 2.1604 | Train Acc: 0.1879
Average Train Accuracy: 0.7565
 Site-MNIST                         | Val  Loss: 0.0859 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2378 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.5793 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.5494 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.4244 | Val  Acc: 0.8235
 Site-MNIST                         | Val  Loss: 0.3592 | Val  Acc: 0.9032
 Site-MNIST                         | Val  Loss: 0.3683 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.3537 | Val  Acc: 0.9216
 Site-MNIST                         | Val  Loss: 0.4103 | Val  Acc: 0.8962
 Site-MNIST                         | Val  Loss: 0.4318 | Val  Acc: 0.8731
 Site-USPS                          | Val  Loss: 0.1920 | Val  Acc: 0.9000
 Site-USPS                          | Val  Loss: 0.7302 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 0.7588 | Val  Acc: 0.6875
 Site-USPS                          | Val  Loss: 0.7321 | Val  Acc: 0.7414
 Site-USPS                          | Val  Loss: 0.5942 | Val  Acc: 0.8190
 Site-USPS                          | Val  Loss: 0.4769 | Val  Acc: 0.8677
 Site-SynthDigits                   | Val  Loss: 1.6687 | Val  Acc: 0.5676
 Site-SynthDigits                   | Val  Loss: 1.9663 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.7386 | Val  Acc: 0.4426
 Site-MNIST_M                       | Val  Loss: 1.6722 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.6314 | Val  Acc: 0.5309
 Site-SVHN                          | Val  Loss: 2.1181 | Val  Acc: 0.2000
Average Valid Accuracy: 0.7438
 Best site-MNIST                     | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8235
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.9032
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.9216
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8962
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8731
 Best site-USPS                      | Epoch:3 | Val Acc: 0.9000
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6875
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7414
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8190
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8677
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.5676
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4426
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.5333
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.5309
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/fedsam...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 0.1855 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.5247 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.2268 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.2819 | Train Acc: 0.9211
 Site-MNIST                         | Train Loss: 0.2515 | Train Acc: 0.9000
 Site-MNIST                         | Train Loss: 0.3331 | Train Acc: 0.9127
 Site-MNIST                         | Train Loss: 0.3410 | Train Acc: 0.8678
 Site-MNIST                         | Train Loss: 0.3685 | Train Acc: 0.8753
 Site-MNIST                         | Train Loss: 0.3320 | Train Acc: 0.9062
 Site-MNIST                         | Train Loss: 0.3064 | Train Acc: 0.9291
 Site-USPS                          | Train Loss: 0.5149 | Train Acc: 0.8250
 Site-USPS                          | Train Loss: 0.2938 | Train Acc: 0.8889
 Site-USPS                          | Train Loss: 0.2812 | Train Acc: 0.8682
 Site-USPS                          | Train Loss: 0.4877 | Train Acc: 0.8412
 Site-USPS                          | Train Loss: 0.3614 | Train Acc: 0.9000
 Site-USPS                          | Train Loss: 0.3943 | Train Acc: 0.8915
 Site-SynthDigits                   | Train Loss: 1.6922 | Train Acc: 0.4437
 Site-SynthDigits                   | Train Loss: 1.6043 | Train Acc: 0.4835
 Site-SynthDigits                   | Train Loss: 1.4776 | Train Acc: 0.5112
 Site-MNIST_M                       | Train Loss: 1.7125 | Train Acc: 0.4420
 Site-MNIST_M                       | Train Loss: 1.8294 | Train Acc: 0.4098
 Site-SVHN                          | Train Loss: 2.1474 | Train Acc: 0.2340
Average Train Accuracy: 0.7653
 Site-MNIST                         | Val  Loss: 0.0524 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1787 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4985 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4543 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.3486 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.2860 | Val  Acc: 0.9355
 Site-MNIST                         | Val  Loss: 0.3152 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2997 | Val  Acc: 0.9216
 Site-MNIST                         | Val  Loss: 0.3476 | Val  Acc: 0.9071
 Site-MNIST                         | Val  Loss: 0.3661 | Val  Acc: 0.8792
 Site-USPS                          | Val  Loss: 0.1424 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.6492 | Val  Acc: 0.7778
 Site-USPS                          | Val  Loss: 0.6966 | Val  Acc: 0.7188
 Site-USPS                          | Val  Loss: 0.6813 | Val  Acc: 0.7241
 Site-USPS                          | Val  Loss: 0.5609 | Val  Acc: 0.8095
 Site-USPS                          | Val  Loss: 0.4276 | Val  Acc: 0.8677
 Site-SynthDigits                   | Val  Loss: 1.6359 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 1.8919 | Val  Acc: 0.5441
 Site-SynthDigits                   | Val  Loss: 1.6794 | Val  Acc: 0.4590
 Site-MNIST_M                       | Val  Loss: 1.6072 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.5695 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 2.0505 | Val  Acc: 0.2571
Average Valid Accuracy: 0.7680
 Best site-MNIST                     | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.9355
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.9216
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.9071
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8792
 Best site-USPS                      | Epoch:4 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7778
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7188
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7241
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8095
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8677
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5946
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5441
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4590
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.5556
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/fedsam...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 0.1577 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.4657 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.1733 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2294 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.2743 | Train Acc: 0.9000
 Site-MNIST                         | Train Loss: 0.2926 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.2747 | Train Acc: 0.8987
 Site-MNIST                         | Train Loss: 0.3361 | Train Acc: 0.8900
 Site-MNIST                         | Train Loss: 0.2867 | Train Acc: 0.9226
 Site-MNIST                         | Train Loss: 0.2610 | Train Acc: 0.9381
 Site-USPS                          | Train Loss: 0.5146 | Train Acc: 0.8000
 Site-USPS                          | Train Loss: 0.3899 | Train Acc: 0.8889
 Site-USPS                          | Train Loss: 0.2634 | Train Acc: 0.8760
 Site-USPS                          | Train Loss: 0.4572 | Train Acc: 0.8455
 Site-USPS                          | Train Loss: 0.3282 | Train Acc: 0.9190
 Site-USPS                          | Train Loss: 0.3613 | Train Acc: 0.8995
 Site-SynthDigits                   | Train Loss: 1.6333 | Train Acc: 0.4570
 Site-SynthDigits                   | Train Loss: 1.5250 | Train Acc: 0.5092
 Site-SynthDigits                   | Train Loss: 1.3977 | Train Acc: 0.5397
 Site-MNIST_M                       | Train Loss: 1.6810 | Train Acc: 0.4033
 Site-MNIST_M                       | Train Loss: 1.8359 | Train Acc: 0.4434
 Site-SVHN                          | Train Loss: 2.1333 | Train Acc: 0.2482
Average Train Accuracy: 0.7805
 Site-MNIST                         | Val  Loss: 0.0577 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1514 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.5342 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4652 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.3265 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.2341 | Val  Acc: 0.9355
 Site-MNIST                         | Val  Loss: 0.2699 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2610 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.3152 | Val  Acc: 0.9180
 Site-MNIST                         | Val  Loss: 0.3275 | Val  Acc: 0.9063
 Site-USPS                          | Val  Loss: 0.1158 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.6346 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 0.6922 | Val  Acc: 0.6875
 Site-USPS                          | Val  Loss: 0.6561 | Val  Acc: 0.7414
 Site-USPS                          | Val  Loss: 0.5274 | Val  Acc: 0.8190
 Site-USPS                          | Val  Loss: 0.3919 | Val  Acc: 0.8730
 Site-SynthDigits                   | Val  Loss: 1.5580 | Val  Acc: 0.5405
 Site-SynthDigits                   | Val  Loss: 1.7557 | Val  Acc: 0.5294
 Site-SynthDigits                   | Val  Loss: 1.5893 | Val  Acc: 0.4918
 Site-MNIST_M                       | Val  Loss: 1.5756 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.5224 | Val  Acc: 0.5062
 Site-SVHN                          | Val  Loss: 1.9739 | Val  Acc: 0.3000
Average Valid Accuracy: 0.7627
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.1474 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.4131 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.1398 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1976 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.2635 | Train Acc: 0.9143
 Site-MNIST                         | Train Loss: 0.2501 | Train Acc: 0.9444
 Site-MNIST                         | Train Loss: 0.2459 | Train Acc: 0.9207
 Site-MNIST                         | Train Loss: 0.3081 | Train Acc: 0.9046
 Site-MNIST                         | Train Loss: 0.2465 | Train Acc: 0.9361
 Site-MNIST                         | Train Loss: 0.2212 | Train Acc: 0.9494
 Site-USPS                          | Train Loss: 0.4577 | Train Acc: 0.8500
 Site-USPS                          | Train Loss: 0.3354 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.2383 | Train Acc: 0.8837
 Site-USPS                          | Train Loss: 0.4053 | Train Acc: 0.8627
 Site-USPS                          | Train Loss: 0.2997 | Train Acc: 0.9190
 Site-USPS                          | Train Loss: 0.3287 | Train Acc: 0.9048
 Site-SynthDigits                   | Train Loss: 1.6047 | Train Acc: 0.4967
 Site-SynthDigits                   | Train Loss: 1.5473 | Train Acc: 0.5092
 Site-SynthDigits                   | Train Loss: 1.3678 | Train Acc: 0.5438
 Site-MNIST_M                       | Train Loss: 1.6591 | Train Acc: 0.4475
 Site-MNIST_M                       | Train Loss: 1.8163 | Train Acc: 0.4465
 Site-SVHN                          | Train Loss: 2.1321 | Train Acc: 0.2553
Average Train Accuracy: 0.7881
 Site-MNIST                         | Val  Loss: 0.0370 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1372 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4963 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4051 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.2751 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.1917 | Val  Acc: 0.9355
 Site-MNIST                         | Val  Loss: 0.2220 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2197 | Val  Acc: 0.9510
 Site-MNIST                         | Val  Loss: 0.2765 | Val  Acc: 0.9235
 Site-MNIST                         | Val  Loss: 0.2902 | Val  Acc: 0.9215
 Site-USPS                          | Val  Loss: 0.0680 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.5335 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.6162 | Val  Acc: 0.7812
 Site-USPS                          | Val  Loss: 0.6092 | Val  Acc: 0.7931
 Site-USPS                          | Val  Loss: 0.4985 | Val  Acc: 0.8190
 Site-USPS                          | Val  Loss: 0.3552 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.5191 | Val  Acc: 0.5676
 Site-SynthDigits                   | Val  Loss: 1.6264 | Val  Acc: 0.5441
 Site-SynthDigits                   | Val  Loss: 1.5427 | Val  Acc: 0.5246
 Site-MNIST_M                       | Val  Loss: 1.5667 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.4710 | Val  Acc: 0.5309
 Site-SVHN                          | Val  Loss: 1.8830 | Val  Acc: 0.3286
Average Valid Accuracy: 0.7866
 Best site-MNIST                     | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9355
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9510
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9235
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9215
 Best site-USPS                      | Epoch:6 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8333
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7812
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7931
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8190
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5676
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5441
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5246
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.5309
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/fedsam...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.1203 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3665 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.1230 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1660 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.5704 | Train Acc: 0.9143
 Site-MNIST                         | Train Loss: 0.2174 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.2258 | Train Acc: 0.9207
 Site-MNIST                         | Train Loss: 0.2761 | Train Acc: 0.9144
 Site-MNIST                         | Train Loss: 0.2248 | Train Acc: 0.9389
 Site-MNIST                         | Train Loss: 0.1989 | Train Acc: 0.9517
 Site-USPS                          | Train Loss: 0.4308 | Train Acc: 0.8500
 Site-USPS                          | Train Loss: 0.2903 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.2379 | Train Acc: 0.8682
 Site-USPS                          | Train Loss: 0.3910 | Train Acc: 0.8670
 Site-USPS                          | Train Loss: 0.2810 | Train Acc: 0.9262
 Site-USPS                          | Train Loss: 0.3117 | Train Acc: 0.9074
 Site-SynthDigits                   | Train Loss: 1.5090 | Train Acc: 0.5166
 Site-SynthDigits                   | Train Loss: 1.4324 | Train Acc: 0.5385
 Site-SynthDigits                   | Train Loss: 1.3281 | Train Acc: 0.5458
 Site-MNIST_M                       | Train Loss: 1.6400 | Train Acc: 0.4420
 Site-MNIST_M                       | Train Loss: 1.6596 | Train Acc: 0.4587
 Site-SVHN                          | Train Loss: 2.1192 | Train Acc: 0.2624
Average Train Accuracy: 0.7954
 Site-MNIST                         | Val  Loss: 0.0442 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1015 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.5008 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4680 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.2951 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.1737 | Val  Acc: 0.9355
 Site-MNIST                         | Val  Loss: 0.1987 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.1965 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.2544 | Val  Acc: 0.9290
 Site-MNIST                         | Val  Loss: 0.2652 | Val  Acc: 0.9245
 Site-USPS                          | Val  Loss: 0.0450 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.5023 | Val  Acc: 0.7778
 Site-USPS                          | Val  Loss: 0.5963 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 0.5687 | Val  Acc: 0.7931
 Site-USPS                          | Val  Loss: 0.4689 | Val  Acc: 0.8381
 Site-USPS                          | Val  Loss: 0.3382 | Val  Acc: 0.8942
 Site-SynthDigits                   | Val  Loss: 1.5045 | Val  Acc: 0.5676
 Site-SynthDigits                   | Val  Loss: 1.6166 | Val  Acc: 0.5882
 Site-SynthDigits                   | Val  Loss: 1.4844 | Val  Acc: 0.5328
 Site-MNIST_M                       | Val  Loss: 1.5113 | Val  Acc: 0.6000
 Site-MNIST_M                       | Val  Loss: 1.4416 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.8625 | Val  Acc: 0.3286
Average Valid Accuracy: 0.7884
 Best site-MNIST                     | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9355
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9290
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9245
 Best site-USPS                      | Epoch:7 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7778
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7931
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8381
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8942
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5676
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5882
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5328
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.6000
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.5556
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/fedsam...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.1074 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3935 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.1154 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1617 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1605 | Train Acc: 0.9143
 Site-MNIST                         | Train Loss: 0.2123 | Train Acc: 0.9365
 Site-MNIST                         | Train Loss: 0.2043 | Train Acc: 0.9295
 Site-MNIST                         | Train Loss: 0.2734 | Train Acc: 0.9095
 Site-MNIST                         | Train Loss: 0.2148 | Train Acc: 0.9443
 Site-MNIST                         | Train Loss: 0.1832 | Train Acc: 0.9532
 Site-USPS                          | Train Loss: 0.4300 | Train Acc: 0.8750
 Site-USPS                          | Train Loss: 0.3342 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.2074 | Train Acc: 0.8992
 Site-USPS                          | Train Loss: 0.3420 | Train Acc: 0.8798
 Site-USPS                          | Train Loss: 0.2602 | Train Acc: 0.9310
 Site-USPS                          | Train Loss: 0.2909 | Train Acc: 0.9140
 Site-SynthDigits                   | Train Loss: 1.4599 | Train Acc: 0.4967
 Site-SynthDigits                   | Train Loss: 1.4091 | Train Acc: 0.5788
 Site-SynthDigits                   | Train Loss: 1.2674 | Train Acc: 0.5743
 Site-MNIST_M                       | Train Loss: 1.5992 | Train Acc: 0.4641
 Site-MNIST_M                       | Train Loss: 1.6497 | Train Acc: 0.4740
 Site-SVHN                          | Train Loss: 2.0768 | Train Acc: 0.2624
Average Train Accuracy: 0.8000
 Site-MNIST                         | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0628 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.5219 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4302 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.2925 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.1592 | Val  Acc: 0.9355
 Site-MNIST                         | Val  Loss: 0.1910 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.1848 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.2448 | Val  Acc: 0.9290
 Site-MNIST                         | Val  Loss: 0.2529 | Val  Acc: 0.9305
 Site-USPS                          | Val  Loss: 0.0404 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4175 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.5388 | Val  Acc: 0.7812
 Site-USPS                          | Val  Loss: 0.5329 | Val  Acc: 0.7931
 Site-USPS                          | Val  Loss: 0.4284 | Val  Acc: 0.8381
 Site-USPS                          | Val  Loss: 0.3017 | Val  Acc: 0.9101
 Site-SynthDigits                   | Val  Loss: 1.4204 | Val  Acc: 0.5676
 Site-SynthDigits                   | Val  Loss: 1.5025 | Val  Acc: 0.6324
 Site-SynthDigits                   | Val  Loss: 1.4057 | Val  Acc: 0.5820
 Site-MNIST_M                       | Val  Loss: 1.4924 | Val  Acc: 0.6000
 Site-MNIST_M                       | Val  Loss: 1.3920 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.7647 | Val  Acc: 0.3286
Average Valid Accuracy: 0.8007
 Best site-MNIST                     | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9355
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9290
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9305
 Best site-USPS                      | Epoch:8 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7812
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7931
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8381
 Best site-USPS                      | Epoch:8 | Val Acc: 0.9101
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5676
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.6324
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5820
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.6000
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.5679
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/fedsam...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.1123 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3316 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.1031 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1341 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.4339 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.1817 | Train Acc: 0.9444
 Site-MNIST                         | Train Loss: 0.1655 | Train Acc: 0.9559
 Site-MNIST                         | Train Loss: 0.2541 | Train Acc: 0.9218
 Site-MNIST                         | Train Loss: 0.1928 | Train Acc: 0.9457
 Site-MNIST                         | Train Loss: 0.1566 | Train Acc: 0.9645
 Site-USPS                          | Train Loss: 0.4070 | Train Acc: 0.8750
 Site-USPS                          | Train Loss: 0.3966 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.3015 | Train Acc: 0.8915
 Site-USPS                          | Train Loss: 0.3704 | Train Acc: 0.8584
 Site-USPS                          | Train Loss: 0.2527 | Train Acc: 0.9262
 Site-USPS                          | Train Loss: 0.2886 | Train Acc: 0.9061
 Site-SynthDigits                   | Train Loss: 1.3997 | Train Acc: 0.5099
 Site-SynthDigits                   | Train Loss: 1.3559 | Train Acc: 0.5421
 Site-SynthDigits                   | Train Loss: 1.2552 | Train Acc: 0.5601
 Site-MNIST_M                       | Train Loss: 1.6348 | Train Acc: 0.4309
 Site-MNIST_M                       | Train Loss: 1.6137 | Train Acc: 0.4740
 Site-SVHN                          | Train Loss: 2.0761 | Train Acc: 0.2766
Average Train Accuracy: 0.8032
 Site-MNIST                         | Val  Loss: 0.0376 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1122 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.5441 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4434 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.2628 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.1117 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1423 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1518 | Val  Acc: 0.9608
 Site-MNIST                         | Val  Loss: 0.2229 | Val  Acc: 0.9235
 Site-MNIST                         | Val  Loss: 0.2264 | Val  Acc: 0.9426
 Site-USPS                          | Val  Loss: 0.0320 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4491 | Val  Acc: 0.7778
 Site-USPS                          | Val  Loss: 0.5522 | Val  Acc: 0.7188
 Site-USPS                          | Val  Loss: 0.5309 | Val  Acc: 0.7586
 Site-USPS                          | Val  Loss: 0.4427 | Val  Acc: 0.8190
 Site-USPS                          | Val  Loss: 0.3147 | Val  Acc: 0.8942
 Site-SynthDigits                   | Val  Loss: 1.3999 | Val  Acc: 0.5135
 Site-SynthDigits                   | Val  Loss: 1.4139 | Val  Acc: 0.5588
 Site-SynthDigits                   | Val  Loss: 1.4077 | Val  Acc: 0.5492
 Site-MNIST_M                       | Val  Loss: 1.5275 | Val  Acc: 0.6000
 Site-MNIST_M                       | Val  Loss: 1.4395 | Val  Acc: 0.5309
 Site-SVHN                          | Val  Loss: 1.7666 | Val  Acc: 0.3714
Average Valid Accuracy: 0.7869
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.0986 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3989 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.1066 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1387 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1635 | Train Acc: 0.9143
 Site-MNIST                         | Train Loss: 0.1934 | Train Acc: 0.9444
 Site-MNIST                         | Train Loss: 0.1729 | Train Acc: 0.9383
 Site-MNIST                         | Train Loss: 0.2263 | Train Acc: 0.9218
 Site-MNIST                         | Train Loss: 0.1806 | Train Acc: 0.9497
 Site-MNIST                         | Train Loss: 0.1558 | Train Acc: 0.9630
 Site-USPS                          | Train Loss: 0.3608 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.2279 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.3848 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.3291 | Train Acc: 0.8841
 Site-USPS                          | Train Loss: 0.2457 | Train Acc: 0.9357
 Site-USPS                          | Train Loss: 0.2563 | Train Acc: 0.9193
 Site-SynthDigits                   | Train Loss: 1.5738 | Train Acc: 0.5166
 Site-SynthDigits                   | Train Loss: 1.4194 | Train Acc: 0.5788
 Site-SynthDigits                   | Train Loss: 1.2070 | Train Acc: 0.5988
 Site-MNIST_M                       | Train Loss: 1.5927 | Train Acc: 0.4475
 Site-MNIST_M                       | Train Loss: 1.5071 | Train Acc: 0.4832
 Site-SVHN                          | Train Loss: 2.0416 | Train Acc: 0.2730
Average Train Accuracy: 0.8097
 Site-MNIST                         | Val  Loss: 0.0340 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0998 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3909 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3032 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1945 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.1171 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1626 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.1608 | Val  Acc: 0.9510
 Site-MNIST                         | Val  Loss: 0.2205 | Val  Acc: 0.9290
 Site-MNIST                         | Val  Loss: 0.2170 | Val  Acc: 0.9396
 Site-USPS                          | Val  Loss: 0.0283 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3646 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4740 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.4685 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.4041 | Val  Acc: 0.8571
 Site-USPS                          | Val  Loss: 0.2725 | Val  Acc: 0.8995
 Site-SynthDigits                   | Val  Loss: 1.3454 | Val  Acc: 0.4865
 Site-SynthDigits                   | Val  Loss: 1.3776 | Val  Acc: 0.5735
 Site-SynthDigits                   | Val  Loss: 1.3547 | Val  Acc: 0.5738
 Site-MNIST_M                       | Val  Loss: 1.4527 | Val  Acc: 0.6222
 Site-MNIST_M                       | Val  Loss: 1.3777 | Val  Acc: 0.5432
 Site-SVHN                          | Val  Loss: 1.7439 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8151
 Best site-MNIST                     | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9677
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9510
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9290
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9396
 Best site-USPS                      | Epoch:10 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8750
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8621
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8571
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8995
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4865
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5735
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5738
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.6222
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.5432
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/fedsam...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.0937 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3617 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0845 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1217 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.2286 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.1700 | Train Acc: 0.9365
 Site-MNIST                         | Train Loss: 0.1688 | Train Acc: 0.9559
 Site-MNIST                         | Train Loss: 0.2194 | Train Acc: 0.9291
 Site-MNIST                         | Train Loss: 0.1659 | Train Acc: 0.9552
 Site-MNIST                         | Train Loss: 0.1339 | Train Acc: 0.9683
 Site-USPS                          | Train Loss: 0.3565 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.1885 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.2989 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.3110 | Train Acc: 0.8884
 Site-USPS                          | Train Loss: 0.2216 | Train Acc: 0.9333
 Site-USPS                          | Train Loss: 0.2458 | Train Acc: 0.9153
 Site-SynthDigits                   | Train Loss: 1.4507 | Train Acc: 0.5232
 Site-SynthDigits                   | Train Loss: 1.2783 | Train Acc: 0.5788
 Site-SynthDigits                   | Train Loss: 1.2003 | Train Acc: 0.5764
 Site-MNIST_M                       | Train Loss: 1.5690 | Train Acc: 0.4530
 Site-MNIST_M                       | Train Loss: 1.5455 | Train Acc: 0.4924
 Site-SVHN                          | Train Loss: 2.0162 | Train Acc: 0.2837
Average Train Accuracy: 0.8135
 Site-MNIST                         | Val  Loss: 0.0319 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0862 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4267 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3503 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.2110 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.1078 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1377 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.1379 | Val  Acc: 0.9510
 Site-MNIST                         | Val  Loss: 0.2039 | Val  Acc: 0.9344
 Site-MNIST                         | Val  Loss: 0.2016 | Val  Acc: 0.9517
 Site-USPS                          | Val  Loss: 0.0243 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3769 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.4747 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.4661 | Val  Acc: 0.8276
 Site-USPS                          | Val  Loss: 0.3880 | Val  Acc: 0.8571
 Site-USPS                          | Val  Loss: 0.2672 | Val  Acc: 0.9153
 Site-SynthDigits                   | Val  Loss: 1.3601 | Val  Acc: 0.5405
 Site-SynthDigits                   | Val  Loss: 1.3508 | Val  Acc: 0.6176
 Site-SynthDigits                   | Val  Loss: 1.3364 | Val  Acc: 0.5820
 Site-MNIST_M                       | Val  Loss: 1.4455 | Val  Acc: 0.6000
 Site-MNIST_M                       | Val  Loss: 1.3404 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.7025 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8063
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.0860 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3305 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0959 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1160 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1326 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.1714 | Train Acc: 0.9444
 Site-MNIST                         | Train Loss: 0.1414 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1992 | Train Acc: 0.9364
 Site-MNIST                         | Train Loss: 0.1550 | Train Acc: 0.9565
 Site-MNIST                         | Train Loss: 0.1255 | Train Acc: 0.9713
 Site-USPS                          | Train Loss: 0.3304 | Train Acc: 0.9000
 Site-USPS                          | Train Loss: 0.3480 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.1696 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.3219 | Train Acc: 0.8884
 Site-USPS                          | Train Loss: 0.2065 | Train Acc: 0.9333
 Site-USPS                          | Train Loss: 0.2388 | Train Acc: 0.9167
 Site-SynthDigits                   | Train Loss: 1.4319 | Train Acc: 0.5232
 Site-SynthDigits                   | Train Loss: 1.3157 | Train Acc: 0.5678
 Site-SynthDigits                   | Train Loss: 1.1864 | Train Acc: 0.5825
 Site-MNIST_M                       | Train Loss: 1.5846 | Train Acc: 0.4420
 Site-MNIST_M                       | Train Loss: 1.5953 | Train Acc: 0.4832
 Site-SVHN                          | Train Loss: 2.0547 | Train Acc: 0.2660
Average Train Accuracy: 0.8090
 Site-MNIST                         | Val  Loss: 0.0395 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1329 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4432 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3591 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.1954 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.0906 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1231 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.1284 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1960 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1911 | Val  Acc: 0.9486
 Site-USPS                          | Val  Loss: 0.0206 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3646 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.4729 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.4591 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.3987 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.2684 | Val  Acc: 0.9048
 Site-SynthDigits                   | Val  Loss: 1.3411 | Val  Acc: 0.4865
 Site-SynthDigits                   | Val  Loss: 1.2919 | Val  Acc: 0.5882
 Site-SynthDigits                   | Val  Loss: 1.3264 | Val  Acc: 0.5902
 Site-MNIST_M                       | Val  Loss: 1.4719 | Val  Acc: 0.6000
 Site-MNIST_M                       | Val  Loss: 1.3614 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.7166 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8098
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.0766 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3471 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0592 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1125 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1452 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.1545 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1514 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1901 | Train Acc: 0.9315
 Site-MNIST                         | Train Loss: 0.1460 | Train Acc: 0.9565
 Site-MNIST                         | Train Loss: 0.1149 | Train Acc: 0.9736
 Site-USPS                          | Train Loss: 0.3511 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.2270 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.1656 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.2993 | Train Acc: 0.9013
 Site-USPS                          | Train Loss: 0.2035 | Train Acc: 0.9357
 Site-USPS                          | Train Loss: 0.2295 | Train Acc: 0.9220
 Site-SynthDigits                   | Train Loss: 1.4048 | Train Acc: 0.5497
 Site-SynthDigits                   | Train Loss: 1.2938 | Train Acc: 0.5861
 Site-SynthDigits                   | Train Loss: 1.1465 | Train Acc: 0.5988
 Site-MNIST_M                       | Train Loss: 1.5457 | Train Acc: 0.4586
 Site-MNIST_M                       | Train Loss: 1.5691 | Train Acc: 0.4954
 Site-SVHN                          | Train Loss: 1.9976 | Train Acc: 0.2801
Average Train Accuracy: 0.8176
 Site-MNIST                         | Val  Loss: 0.0229 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1003 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4097 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3274 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1957 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.1003 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1339 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1262 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1916 | Val  Acc: 0.9290
 Site-MNIST                         | Val  Loss: 0.1809 | Val  Acc: 0.9517
 Site-USPS                          | Val  Loss: 0.0208 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3252 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4316 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.4406 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.3727 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.2471 | Val  Acc: 0.9153
 Site-SynthDigits                   | Val  Loss: 1.3049 | Val  Acc: 0.5135
 Site-SynthDigits                   | Val  Loss: 1.2177 | Val  Acc: 0.5882
 Site-SynthDigits                   | Val  Loss: 1.2872 | Val  Acc: 0.5820
 Site-MNIST_M                       | Val  Loss: 1.4222 | Val  Acc: 0.6222
 Site-MNIST_M                       | Val  Loss: 1.3112 | Val  Acc: 0.5802
 Site-SVHN                          | Val  Loss: 1.6893 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8239
 Best site-MNIST                     | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9290
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9517
 Best site-USPS                      | Epoch:13 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8750
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8621
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8667
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9153
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5135
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5882
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5820
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.6222
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.5802
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/fedsam...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.0832 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3431 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0649 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1153 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1181 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.1439 | Train Acc: 0.9444
 Site-MNIST                         | Train Loss: 0.1243 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1895 | Train Acc: 0.9315
 Site-MNIST                         | Train Loss: 0.1382 | Train Acc: 0.9647
 Site-MNIST                         | Train Loss: 0.1063 | Train Acc: 0.9743
 Site-USPS                          | Train Loss: 0.3473 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.2362 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.1623 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.2796 | Train Acc: 0.8970
 Site-USPS                          | Train Loss: 0.2021 | Train Acc: 0.9381
 Site-USPS                          | Train Loss: 0.2191 | Train Acc: 0.9259
 Site-SynthDigits                   | Train Loss: 1.3647 | Train Acc: 0.5232
 Site-SynthDigits                   | Train Loss: 1.2545 | Train Acc: 0.5897
 Site-SynthDigits                   | Train Loss: 1.1202 | Train Acc: 0.6029
 Site-MNIST_M                       | Train Loss: 1.5724 | Train Acc: 0.4696
 Site-MNIST_M                       | Train Loss: 1.5424 | Train Acc: 0.4862
 Site-SVHN                          | Train Loss: 2.0661 | Train Acc: 0.2837
Average Train Accuracy: 0.8216
 Site-MNIST                         | Val  Loss: 0.0151 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1228 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4523 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3746 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.2104 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.0938 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1190 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1170 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1895 | Val  Acc: 0.9290
 Site-MNIST                         | Val  Loss: 0.1795 | Val  Acc: 0.9517
 Site-USPS                          | Val  Loss: 0.0140 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2732 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.4103 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.4165 | Val  Acc: 0.8276
 Site-USPS                          | Val  Loss: 0.3557 | Val  Acc: 0.8571
 Site-USPS                          | Val  Loss: 0.2418 | Val  Acc: 0.9206
 Site-SynthDigits                   | Val  Loss: 1.2800 | Val  Acc: 0.4865
 Site-SynthDigits                   | Val  Loss: 1.2099 | Val  Acc: 0.5882
 Site-SynthDigits                   | Val  Loss: 1.2603 | Val  Acc: 0.5902
 Site-MNIST_M                       | Val  Loss: 1.4363 | Val  Acc: 0.6444
 Site-MNIST_M                       | Val  Loss: 1.3265 | Val  Acc: 0.5926
 Site-SVHN                          | Val  Loss: 1.6834 | Val  Acc: 0.3571
Average Valid Accuracy: 0.8135
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.0763 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3041 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0677 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1005 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.2825 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.1453 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1233 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1832 | Train Acc: 0.9389
 Site-MNIST                         | Train Loss: 0.1303 | Train Acc: 0.9660
 Site-MNIST                         | Train Loss: 0.1032 | Train Acc: 0.9774
 Site-USPS                          | Train Loss: 0.3141 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.1176 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.1715 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.2587 | Train Acc: 0.9013
 Site-USPS                          | Train Loss: 0.1781 | Train Acc: 0.9452
 Site-USPS                          | Train Loss: 0.2052 | Train Acc: 0.9339
 Site-SynthDigits                   | Train Loss: 1.3489 | Train Acc: 0.5232
 Site-SynthDigits                   | Train Loss: 1.2529 | Train Acc: 0.5897
 Site-SynthDigits                   | Train Loss: 1.1118 | Train Acc: 0.6151
 Site-MNIST_M                       | Train Loss: 1.5587 | Train Acc: 0.4475
 Site-MNIST_M                       | Train Loss: 1.5094 | Train Acc: 0.4954
 Site-SVHN                          | Train Loss: 2.0261 | Train Acc: 0.2979
Average Train Accuracy: 0.8238
 Site-MNIST                         | Val  Loss: 0.0232 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0762 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3226 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3136 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.1806 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.0872 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1136 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1091 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1796 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.1689 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0126 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2891 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.4079 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.4123 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.3464 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.2302 | Val  Acc: 0.9206
 Site-SynthDigits                   | Val  Loss: 1.2735 | Val  Acc: 0.5135
 Site-SynthDigits                   | Val  Loss: 1.2122 | Val  Acc: 0.5735
 Site-SynthDigits                   | Val  Loss: 1.2266 | Val  Acc: 0.5820
 Site-MNIST_M                       | Val  Loss: 1.4261 | Val  Acc: 0.6000
 Site-MNIST_M                       | Val  Loss: 1.3134 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.6788 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8149
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.0429 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3486 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0574 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1199 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1253 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.1451 | Train Acc: 0.9444
 Site-MNIST                         | Train Loss: 0.1306 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1940 | Train Acc: 0.9315
 Site-MNIST                         | Train Loss: 0.1300 | Train Acc: 0.9592
 Site-MNIST                         | Train Loss: 0.0993 | Train Acc: 0.9736
 Site-USPS                          | Train Loss: 0.3027 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1038 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1411 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.2622 | Train Acc: 0.9013
 Site-USPS                          | Train Loss: 0.1705 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1876 | Train Acc: 0.9405
 Site-SynthDigits                   | Train Loss: 1.3638 | Train Acc: 0.5298
 Site-SynthDigits                   | Train Loss: 1.2908 | Train Acc: 0.6007
 Site-SynthDigits                   | Train Loss: 1.1097 | Train Acc: 0.6029
 Site-MNIST_M                       | Train Loss: 1.5389 | Train Acc: 0.4696
 Site-MNIST_M                       | Train Loss: 1.4104 | Train Acc: 0.5107
 Site-SVHN                          | Train Loss: 2.0111 | Train Acc: 0.2979
Average Train Accuracy: 0.8247
 Site-MNIST                         | Val  Loss: 0.0123 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0413 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3218 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2645 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1654 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0847 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1160 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1088 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1764 | Val  Acc: 0.9344
 Site-MNIST                         | Val  Loss: 0.1650 | Val  Acc: 0.9517
 Site-USPS                          | Val  Loss: 0.0160 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3087 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.4255 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.4183 | Val  Acc: 0.8276
 Site-USPS                          | Val  Loss: 0.3440 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.2123 | Val  Acc: 0.9259
 Site-SynthDigits                   | Val  Loss: 1.2466 | Val  Acc: 0.5405
 Site-SynthDigits                   | Val  Loss: 1.1610 | Val  Acc: 0.5882
 Site-SynthDigits                   | Val  Loss: 1.2186 | Val  Acc: 0.5902
 Site-MNIST_M                       | Val  Loss: 1.4029 | Val  Acc: 0.6444
 Site-MNIST_M                       | Val  Loss: 1.2798 | Val  Acc: 0.5926
 Site-SVHN                          | Val  Loss: 1.6706 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8280
 Best site-MNIST                     | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9344
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9517
 Best site-USPS                      | Epoch:16 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8438
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8276
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8667
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9259
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.5405
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.5882
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.5902
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.6444
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.5926
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/fedsam...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.0423 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3334 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0397 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0983 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.2675 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.1311 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.1123 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1728 | Train Acc: 0.9340
 Site-MNIST                         | Train Loss: 0.1229 | Train Acc: 0.9579
 Site-MNIST                         | Train Loss: 0.0884 | Train Acc: 0.9789
 Site-USPS                          | Train Loss: 0.2947 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.1907 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.1434 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.2656 | Train Acc: 0.9056
 Site-USPS                          | Train Loss: 0.1682 | Train Acc: 0.9524
 Site-USPS                          | Train Loss: 0.1888 | Train Acc: 0.9339
 Site-SynthDigits                   | Train Loss: 1.4021 | Train Acc: 0.5430
 Site-SynthDigits                   | Train Loss: 1.2110 | Train Acc: 0.6117
 Site-SynthDigits                   | Train Loss: 1.0808 | Train Acc: 0.6293
 Site-MNIST_M                       | Train Loss: 1.5349 | Train Acc: 0.4586
 Site-MNIST_M                       | Train Loss: 1.4662 | Train Acc: 0.5107
 Site-SVHN                          | Train Loss: 2.0089 | Train Acc: 0.3050
Average Train Accuracy: 0.8298
 Site-MNIST                         | Val  Loss: 0.0147 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0606 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3080 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2909 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.1701 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.0805 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1111 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1037 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1732 | Val  Acc: 0.9344
 Site-MNIST                         | Val  Loss: 0.1563 | Val  Acc: 0.9547
 Site-USPS                          | Val  Loss: 0.0122 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3185 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4351 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.4218 | Val  Acc: 0.8448
 Site-USPS                          | Val  Loss: 0.3457 | Val  Acc: 0.8762
 Site-USPS                          | Val  Loss: 0.2128 | Val  Acc: 0.9312
 Site-SynthDigits                   | Val  Loss: 1.2163 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 1.1182 | Val  Acc: 0.6029
 Site-SynthDigits                   | Val  Loss: 1.2042 | Val  Acc: 0.5984
 Site-MNIST_M                       | Val  Loss: 1.4110 | Val  Acc: 0.6222
 Site-MNIST_M                       | Val  Loss: 1.2935 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.6835 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8192
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.0422 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3027 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0543 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1026 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1987 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.1206 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.1099 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1646 | Train Acc: 0.9364
 Site-MNIST                         | Train Loss: 0.1096 | Train Acc: 0.9701
 Site-MNIST                         | Train Loss: 0.0813 | Train Acc: 0.9864
 Site-USPS                          | Train Loss: 0.3031 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.1345 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1445 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.2443 | Train Acc: 0.8927
 Site-USPS                          | Train Loss: 0.1718 | Train Acc: 0.9476
 Site-USPS                          | Train Loss: 0.1889 | Train Acc: 0.9299
 Site-SynthDigits                   | Train Loss: 1.2624 | Train Acc: 0.5364
 Site-SynthDigits                   | Train Loss: 1.2428 | Train Acc: 0.5897
 Site-SynthDigits                   | Train Loss: 1.0760 | Train Acc: 0.6212
 Site-MNIST_M                       | Train Loss: 1.5356 | Train Acc: 0.4475
 Site-MNIST_M                       | Train Loss: 1.5377 | Train Acc: 0.5015
 Site-SVHN                          | Train Loss: 1.9811 | Train Acc: 0.3191
Average Train Accuracy: 0.8285
 Site-MNIST                         | Val  Loss: 0.0150 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0521 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4424 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3814 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.2196 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.0823 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.0917 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0925 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1585 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1512 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0111 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3258 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4282 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.4073 | Val  Acc: 0.8103
 Site-USPS                          | Val  Loss: 0.3420 | Val  Acc: 0.8476
 Site-USPS                          | Val  Loss: 0.2193 | Val  Acc: 0.9153
 Site-SynthDigits                   | Val  Loss: 1.2319 | Val  Acc: 0.4865
 Site-SynthDigits                   | Val  Loss: 1.0925 | Val  Acc: 0.5588
 Site-SynthDigits                   | Val  Loss: 1.1908 | Val  Acc: 0.5902
 Site-MNIST_M                       | Val  Loss: 1.4224 | Val  Acc: 0.6000
 Site-MNIST_M                       | Val  Loss: 1.2905 | Val  Acc: 0.5309
 Site-SVHN                          | Val  Loss: 1.6610 | Val  Acc: 0.4143
Average Valid Accuracy: 0.8053
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.0350 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3032 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0459 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0895 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.3312 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.1118 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.1071 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1557 | Train Acc: 0.9364
 Site-MNIST                         | Train Loss: 0.1059 | Train Acc: 0.9715
 Site-MNIST                         | Train Loss: 0.0749 | Train Acc: 0.9857
 Site-USPS                          | Train Loss: 0.2924 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.1140 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.4603 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.2628 | Train Acc: 0.8884
 Site-USPS                          | Train Loss: 0.1748 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1856 | Train Acc: 0.9378
 Site-SynthDigits                   | Train Loss: 1.3819 | Train Acc: 0.5497
 Site-SynthDigits                   | Train Loss: 1.1845 | Train Acc: 0.6007
 Site-SynthDigits                   | Train Loss: 1.0463 | Train Acc: 0.6334
 Site-MNIST_M                       | Train Loss: 1.5270 | Train Acc: 0.4751
 Site-MNIST_M                       | Train Loss: 1.5574 | Train Acc: 0.5015
 Site-SVHN                          | Train Loss: 2.0206 | Train Acc: 0.3050
Average Train Accuracy: 0.8307
 Site-MNIST                         | Val  Loss: 0.0130 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0435 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4605 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3974 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.2231 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.0747 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.0869 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0892 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1548 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1482 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3562 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.4470 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.4178 | Val  Acc: 0.8103
 Site-USPS                          | Val  Loss: 0.3422 | Val  Acc: 0.8571
 Site-USPS                          | Val  Loss: 0.2202 | Val  Acc: 0.9153
 Site-SynthDigits                   | Val  Loss: 1.2242 | Val  Acc: 0.5135
 Site-SynthDigits                   | Val  Loss: 1.0974 | Val  Acc: 0.5735
 Site-SynthDigits                   | Val  Loss: 1.1811 | Val  Acc: 0.5902
 Site-MNIST_M                       | Val  Loss: 1.4105 | Val  Acc: 0.6444
 Site-MNIST_M                       | Val  Loss: 1.2796 | Val  Acc: 0.5432
 Site-SVHN                          | Val  Loss: 1.6690 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8063
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.0318 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2951 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0515 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0886 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1411 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.1127 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.1068 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1625 | Train Acc: 0.9389
 Site-MNIST                         | Train Loss: 0.1042 | Train Acc: 0.9728
 Site-MNIST                         | Train Loss: 0.0731 | Train Acc: 0.9864
 Site-USPS                          | Train Loss: 0.2760 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.1317 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.1372 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.2304 | Train Acc: 0.9227
 Site-USPS                          | Train Loss: 0.1621 | Train Acc: 0.9571
 Site-USPS                          | Train Loss: 0.1716 | Train Acc: 0.9392
 Site-SynthDigits                   | Train Loss: 1.2993 | Train Acc: 0.5563
 Site-SynthDigits                   | Train Loss: 1.1645 | Train Acc: 0.6227
 Site-SynthDigits                   | Train Loss: 1.0404 | Train Acc: 0.6354
 Site-MNIST_M                       | Train Loss: 1.5250 | Train Acc: 0.4641
 Site-MNIST_M                       | Train Loss: 1.4397 | Train Acc: 0.5291
 Site-SVHN                          | Train Loss: 2.0522 | Train Acc: 0.3050
Average Train Accuracy: 0.8352
 Site-MNIST                         | Val  Loss: 0.0173 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0345 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2801 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2534 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1468 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0619 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0910 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0899 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1544 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1439 | Val  Acc: 0.9547
 Site-USPS                          | Val  Loss: 0.0093 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3069 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.4082 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3914 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.3277 | Val  Acc: 0.8952
 Site-USPS                          | Val  Loss: 0.2079 | Val  Acc: 0.9365
 Site-SynthDigits                   | Val  Loss: 1.2294 | Val  Acc: 0.5676
 Site-SynthDigits                   | Val  Loss: 1.1035 | Val  Acc: 0.6176
 Site-SynthDigits                   | Val  Loss: 1.1806 | Val  Acc: 0.6311
 Site-MNIST_M                       | Val  Loss: 1.3973 | Val  Acc: 0.6444
 Site-MNIST_M                       | Val  Loss: 1.2755 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.6786 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8386
 Best site-MNIST                     | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9399
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9547
 Best site-USPS                      | Epoch:20 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9062
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8793
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8952
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9365
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5676
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.6176
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.6311
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.6444
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5679
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/fedsam...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.0295 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2958 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0495 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0899 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1259 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.1166 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.1283 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1501 | Train Acc: 0.9364
 Site-MNIST                         | Train Loss: 0.0987 | Train Acc: 0.9742
 Site-MNIST                         | Train Loss: 0.0730 | Train Acc: 0.9857
 Site-USPS                          | Train Loss: 0.2781 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.1368 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.1306 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.2324 | Train Acc: 0.9185
 Site-USPS                          | Train Loss: 0.1562 | Train Acc: 0.9571
 Site-USPS                          | Train Loss: 0.1624 | Train Acc: 0.9431
 Site-SynthDigits                   | Train Loss: 1.3298 | Train Acc: 0.5430
 Site-SynthDigits                   | Train Loss: 1.1656 | Train Acc: 0.6081
 Site-SynthDigits                   | Train Loss: 1.0456 | Train Acc: 0.6293
 Site-MNIST_M                       | Train Loss: 1.5041 | Train Acc: 0.4641
 Site-MNIST_M                       | Train Loss: 1.4184 | Train Acc: 0.5199
 Site-SVHN                          | Train Loss: 1.9834 | Train Acc: 0.3050
Average Train Accuracy: 0.8276
 Site-MNIST                         | Val  Loss: 0.0094 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0414 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2104 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2037 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1184 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0630 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0954 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0869 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1539 | Val  Acc: 0.9344
 Site-MNIST                         | Val  Loss: 0.1355 | Val  Acc: 0.9517
 Site-USPS                          | Val  Loss: 0.0113 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2750 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3733 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3789 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.3168 | Val  Acc: 0.8762
 Site-USPS                          | Val  Loss: 0.1980 | Val  Acc: 0.9259
 Site-SynthDigits                   | Val  Loss: 1.2017 | Val  Acc: 0.5135
 Site-SynthDigits                   | Val  Loss: 1.0440 | Val  Acc: 0.5882
 Site-SynthDigits                   | Val  Loss: 1.1632 | Val  Acc: 0.5902
 Site-MNIST_M                       | Val  Loss: 1.3670 | Val  Acc: 0.6444
 Site-MNIST_M                       | Val  Loss: 1.2531 | Val  Acc: 0.5802
 Site-SVHN                          | Val  Loss: 1.6643 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8304
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.0283 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3446 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0412 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0844 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1286 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.1109 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0995 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1542 | Train Acc: 0.9389
 Site-MNIST                         | Train Loss: 0.0941 | Train Acc: 0.9701
 Site-MNIST                         | Train Loss: 0.0690 | Train Acc: 0.9857
 Site-USPS                          | Train Loss: 0.2682 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0911 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1416 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.2210 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.1574 | Train Acc: 0.9571
 Site-USPS                          | Train Loss: 0.1571 | Train Acc: 0.9497
 Site-SynthDigits                   | Train Loss: 1.3113 | Train Acc: 0.5563
 Site-SynthDigits                   | Train Loss: 1.1866 | Train Acc: 0.6117
 Site-SynthDigits                   | Train Loss: 1.0302 | Train Acc: 0.6314
 Site-MNIST_M                       | Train Loss: 1.4976 | Train Acc: 0.4696
 Site-MNIST_M                       | Train Loss: 1.5209 | Train Acc: 0.5168
 Site-SVHN                          | Train Loss: 2.0097 | Train Acc: 0.3121
Average Train Accuracy: 0.8326
 Site-MNIST                         | Val  Loss: 0.0122 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0291 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2649 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2033 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1208 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0582 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0951 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0901 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1526 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1396 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0111 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2835 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3720 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3741 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.3077 | Val  Acc: 0.8857
 Site-USPS                          | Val  Loss: 0.1936 | Val  Acc: 0.9259
 Site-SynthDigits                   | Val  Loss: 1.1926 | Val  Acc: 0.5676
 Site-SynthDigits                   | Val  Loss: 1.0429 | Val  Acc: 0.6029
 Site-SynthDigits                   | Val  Loss: 1.1775 | Val  Acc: 0.5984
 Site-MNIST_M                       | Val  Loss: 1.3947 | Val  Acc: 0.6667
 Site-MNIST_M                       | Val  Loss: 1.2609 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.6523 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8320
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.0292 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3052 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0353 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0762 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1254 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.1023 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.1004 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1505 | Train Acc: 0.9364
 Site-MNIST                         | Train Loss: 0.0946 | Train Acc: 0.9715
 Site-MNIST                         | Train Loss: 0.0623 | Train Acc: 0.9902
 Site-USPS                          | Train Loss: 0.2791 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0811 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.2729 | Train Acc: 0.9302
 Site-USPS                          | Train Loss: 0.2107 | Train Acc: 0.9227
 Site-USPS                          | Train Loss: 0.1407 | Train Acc: 0.9643
 Site-USPS                          | Train Loss: 0.1498 | Train Acc: 0.9484
 Site-SynthDigits                   | Train Loss: 1.3875 | Train Acc: 0.5563
 Site-SynthDigits                   | Train Loss: 1.1218 | Train Acc: 0.6190
 Site-SynthDigits                   | Train Loss: 1.0186 | Train Acc: 0.6395
 Site-MNIST_M                       | Train Loss: 1.5034 | Train Acc: 0.4751
 Site-MNIST_M                       | Train Loss: 1.4530 | Train Acc: 0.5291
 Site-SVHN                          | Train Loss: 2.0054 | Train Acc: 0.3156
Average Train Accuracy: 0.8382
 Site-MNIST                         | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0214 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2661 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2623 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1500 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0711 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0904 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0857 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1470 | Val  Acc: 0.9344
 Site-MNIST                         | Val  Loss: 0.1348 | Val  Acc: 0.9547
 Site-USPS                          | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2590 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3640 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.3648 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.3006 | Val  Acc: 0.8952
 Site-USPS                          | Val  Loss: 0.1855 | Val  Acc: 0.9418
 Site-SynthDigits                   | Val  Loss: 1.1719 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 1.0610 | Val  Acc: 0.6324
 Site-SynthDigits                   | Val  Loss: 1.1764 | Val  Acc: 0.6148
 Site-MNIST_M                       | Val  Loss: 1.3807 | Val  Acc: 0.6444
 Site-MNIST_M                       | Val  Loss: 1.2581 | Val  Acc: 0.5802
 Site-SVHN                          | Val  Loss: 1.6674 | Val  Acc: 0.4143
Average Valid Accuracy: 0.8348
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.0326 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3303 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0280 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0714 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.2545 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.1052 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1033 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1638 | Train Acc: 0.9389
 Site-MNIST                         | Train Loss: 0.0910 | Train Acc: 0.9715
 Site-MNIST                         | Train Loss: 0.0616 | Train Acc: 0.9879
 Site-USPS                          | Train Loss: 0.2763 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2271 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1313 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1991 | Train Acc: 0.9227
 Site-USPS                          | Train Loss: 0.1463 | Train Acc: 0.9595
 Site-USPS                          | Train Loss: 0.1468 | Train Acc: 0.9537
 Site-SynthDigits                   | Train Loss: 1.2371 | Train Acc: 0.5695
 Site-SynthDigits                   | Train Loss: 1.0962 | Train Acc: 0.6484
 Site-SynthDigits                   | Train Loss: 0.9809 | Train Acc: 0.6578
 Site-MNIST_M                       | Train Loss: 1.4980 | Train Acc: 0.4807
 Site-MNIST_M                       | Train Loss: 1.4873 | Train Acc: 0.5260
 Site-SVHN                          | Train Loss: 1.9750 | Train Acc: 0.3227
Average Train Accuracy: 0.8417
 Site-MNIST                         | Val  Loss: 0.0073 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0254 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2253 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2293 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1335 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0657 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0937 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0840 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1511 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1316 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0076 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2590 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3663 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.3576 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2924 | Val  Acc: 0.8857
 Site-USPS                          | Val  Loss: 0.1750 | Val  Acc: 0.9418
 Site-SynthDigits                   | Val  Loss: 1.1297 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 0.9984 | Val  Acc: 0.6324
 Site-SynthDigits                   | Val  Loss: 1.1124 | Val  Acc: 0.6311
 Site-MNIST_M                       | Val  Loss: 1.3859 | Val  Acc: 0.6667
 Site-MNIST_M                       | Val  Loss: 1.2540 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.6336 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8361
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.0226 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3438 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0306 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0741 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1030 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.1037 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.0981 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1514 | Train Acc: 0.9364
 Site-MNIST                         | Train Loss: 0.0898 | Train Acc: 0.9742
 Site-MNIST                         | Train Loss: 0.0634 | Train Acc: 0.9879
 Site-USPS                          | Train Loss: 0.2617 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0836 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.1157 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.1914 | Train Acc: 0.9227
 Site-USPS                          | Train Loss: 0.1306 | Train Acc: 0.9619
 Site-USPS                          | Train Loss: 0.1341 | Train Acc: 0.9590
 Site-SynthDigits                   | Train Loss: 1.3409 | Train Acc: 0.5563
 Site-SynthDigits                   | Train Loss: 1.0899 | Train Acc: 0.6410
 Site-SynthDigits                   | Train Loss: 0.9923 | Train Acc: 0.6517
 Site-MNIST_M                       | Train Loss: 1.4849 | Train Acc: 0.4751
 Site-MNIST_M                       | Train Loss: 1.4179 | Train Acc: 0.5291
 Site-SVHN                          | Train Loss: 2.0074 | Train Acc: 0.3511
Average Train Accuracy: 0.8388
 Site-MNIST                         | Val  Loss: 0.0053 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0147 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1926 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1767 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1052 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0589 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0947 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0853 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1481 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1292 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0096 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2744 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3546 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3609 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.2821 | Val  Acc: 0.8857
 Site-USPS                          | Val  Loss: 0.1686 | Val  Acc: 0.9365
 Site-SynthDigits                   | Val  Loss: 1.1236 | Val  Acc: 0.6216
 Site-SynthDigits                   | Val  Loss: 0.9836 | Val  Acc: 0.6471
 Site-SynthDigits                   | Val  Loss: 1.1200 | Val  Acc: 0.6393
 Site-MNIST_M                       | Val  Loss: 1.3691 | Val  Acc: 0.6444
 Site-MNIST_M                       | Val  Loss: 1.2368 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.6421 | Val  Acc: 0.4286
Average Valid Accuracy: 0.8391
 Best site-MNIST                     | Epoch:25 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:25 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:25 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9399
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9577
 Best site-USPS                      | Epoch:25 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8750
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8621
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8857
 Best site-USPS                      | Epoch:25 | Val Acc: 0.9365
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.6216
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.6471
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.6393
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.6444
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.5679
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/fedsam...
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.0356 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3126 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0309 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0703 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.2394 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.1022 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0948 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1556 | Train Acc: 0.9389
 Site-MNIST                         | Train Loss: 0.0844 | Train Acc: 0.9715
 Site-MNIST                         | Train Loss: 0.0582 | Train Acc: 0.9902
 Site-USPS                          | Train Loss: 0.2486 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2222 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.1165 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1916 | Train Acc: 0.9270
 Site-USPS                          | Train Loss: 0.1391 | Train Acc: 0.9667
 Site-USPS                          | Train Loss: 0.1305 | Train Acc: 0.9590
 Site-SynthDigits                   | Train Loss: 1.2674 | Train Acc: 0.5695
 Site-SynthDigits                   | Train Loss: 1.0480 | Train Acc: 0.6484
 Site-SynthDigits                   | Train Loss: 0.9751 | Train Acc: 0.6680
 Site-MNIST_M                       | Train Loss: 1.4908 | Train Acc: 0.4751
 Site-MNIST_M                       | Train Loss: 1.4861 | Train Acc: 0.5352
 Site-SVHN                          | Train Loss: 1.9590 | Train Acc: 0.3333
Average Train Accuracy: 0.8442
 Site-MNIST                         | Val  Loss: 0.0055 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0236 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1801 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1880 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1072 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0539 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0872 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0801 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1469 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1268 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0075 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2713 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3669 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3557 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2795 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1650 | Val  Acc: 0.9418
 Site-SynthDigits                   | Val  Loss: 1.0754 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 0.9272 | Val  Acc: 0.6765
 Site-SynthDigits                   | Val  Loss: 1.1029 | Val  Acc: 0.6475
 Site-MNIST_M                       | Val  Loss: 1.3862 | Val  Acc: 0.6667
 Site-MNIST_M                       | Val  Loss: 1.2481 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.6488 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8431
 Best site-MNIST                     | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9399
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9577
 Best site-USPS                      | Epoch:26 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8750
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8793
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9048
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9418
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.6486
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.6765
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.6475
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.6667
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5556
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/fedsam...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.0271 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3163 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0319 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0688 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.3486 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0951 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0922 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1387 | Train Acc: 0.9413
 Site-MNIST                         | Train Loss: 0.0837 | Train Acc: 0.9755
 Site-MNIST                         | Train Loss: 0.0531 | Train Acc: 0.9917
 Site-USPS                          | Train Loss: 0.2614 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0813 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1695 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.2075 | Train Acc: 0.9185
 Site-USPS                          | Train Loss: 0.1369 | Train Acc: 0.9667
 Site-USPS                          | Train Loss: 0.1348 | Train Acc: 0.9537
 Site-SynthDigits                   | Train Loss: 1.2119 | Train Acc: 0.5762
 Site-SynthDigits                   | Train Loss: 1.0794 | Train Acc: 0.6374
 Site-SynthDigits                   | Train Loss: 0.9578 | Train Acc: 0.6802
 Site-MNIST_M                       | Train Loss: 1.4829 | Train Acc: 0.4807
 Site-MNIST_M                       | Train Loss: 1.4309 | Train Acc: 0.5352
 Site-SVHN                          | Train Loss: 1.9843 | Train Acc: 0.3440
Average Train Accuracy: 0.8416
 Site-MNIST                         | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0360 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2374 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2337 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1286 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0587 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0891 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0827 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1466 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1260 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2485 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3626 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3446 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2821 | Val  Acc: 0.8952
 Site-USPS                          | Val  Loss: 0.1726 | Val  Acc: 0.9365
 Site-SynthDigits                   | Val  Loss: 1.0701 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 0.9601 | Val  Acc: 0.6324
 Site-SynthDigits                   | Val  Loss: 1.1069 | Val  Acc: 0.6393
 Site-MNIST_M                       | Val  Loss: 1.3671 | Val  Acc: 0.6889
 Site-MNIST_M                       | Val  Loss: 1.2266 | Val  Acc: 0.5802
 Site-SVHN                          | Val  Loss: 1.6504 | Val  Acc: 0.4143
Average Valid Accuracy: 0.8403
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.0218 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3411 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0218 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0571 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1058 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0988 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0949 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1355 | Train Acc: 0.9315
 Site-MNIST                         | Train Loss: 0.0759 | Train Acc: 0.9755
 Site-MNIST                         | Train Loss: 0.0521 | Train Acc: 0.9902
 Site-USPS                          | Train Loss: 0.2412 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1171 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1198 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1963 | Train Acc: 0.9313
 Site-USPS                          | Train Loss: 0.1292 | Train Acc: 0.9667
 Site-USPS                          | Train Loss: 0.1280 | Train Acc: 0.9603
 Site-SynthDigits                   | Train Loss: 1.1251 | Train Acc: 0.5828
 Site-SynthDigits                   | Train Loss: 1.0647 | Train Acc: 0.6410
 Site-SynthDigits                   | Train Loss: 0.9292 | Train Acc: 0.6864
 Site-MNIST_M                       | Train Loss: 1.4764 | Train Acc: 0.4696
 Site-MNIST_M                       | Train Loss: 1.4904 | Train Acc: 0.5260
 Site-SVHN                          | Train Loss: 1.9445 | Train Acc: 0.3475
Average Train Accuracy: 0.8444
 Site-MNIST                         | Val  Loss: 0.0081 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0157 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2052 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2012 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1160 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0506 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0848 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0750 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1410 | Val  Acc: 0.9344
 Site-MNIST                         | Val  Loss: 0.1187 | Val  Acc: 0.9547
 Site-USPS                          | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3024 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4055 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3634 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2851 | Val  Acc: 0.9238
 Site-USPS                          | Val  Loss: 0.1629 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 1.0669 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 0.9300 | Val  Acc: 0.6471
 Site-SynthDigits                   | Val  Loss: 1.0805 | Val  Acc: 0.6475
 Site-MNIST_M                       | Val  Loss: 1.3572 | Val  Acc: 0.6889
 Site-MNIST_M                       | Val  Loss: 1.2273 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.6367 | Val  Acc: 0.4571
Average Valid Accuracy: 0.8479
 Best site-MNIST                     | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9344
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9547
 Best site-USPS                      | Epoch:28 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8750
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8966
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9238
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9577
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.6486
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.6471
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.6475
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.6889
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.5679
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.4571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/fedsam...
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.0310 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2861 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0289 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0582 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0965 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0919 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.0934 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1314 | Train Acc: 0.9413
 Site-MNIST                         | Train Loss: 0.0713 | Train Acc: 0.9769
 Site-MNIST                         | Train Loss: 0.0478 | Train Acc: 0.9932
 Site-USPS                          | Train Loss: 0.2495 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0829 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1233 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.1960 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.1240 | Train Acc: 0.9619
 Site-USPS                          | Train Loss: 0.1290 | Train Acc: 0.9563
 Site-SynthDigits                   | Train Loss: 1.2835 | Train Acc: 0.5828
 Site-SynthDigits                   | Train Loss: 1.0635 | Train Acc: 0.6374
 Site-SynthDigits                   | Train Loss: 0.9256 | Train Acc: 0.6925
 Site-MNIST_M                       | Train Loss: 1.4590 | Train Acc: 0.4862
 Site-MNIST_M                       | Train Loss: 1.4546 | Train Acc: 0.5352
 Site-SVHN                          | Train Loss: 1.9077 | Train Acc: 0.3511
Average Train Accuracy: 0.8426
 Site-MNIST                         | Val  Loss: 0.0086 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0155 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2493 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2203 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1240 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0523 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0835 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0766 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1364 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.1207 | Val  Acc: 0.9607
 Site-USPS                          | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2956 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3796 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3410 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2799 | Val  Acc: 0.8857
 Site-USPS                          | Val  Loss: 0.1768 | Val  Acc: 0.9259
 Site-SynthDigits                   | Val  Loss: 1.0820 | Val  Acc: 0.5676
 Site-SynthDigits                   | Val  Loss: 0.9229 | Val  Acc: 0.6324
 Site-SynthDigits                   | Val  Loss: 1.0699 | Val  Acc: 0.6311
 Site-MNIST_M                       | Val  Loss: 1.3442 | Val  Acc: 0.6667
 Site-MNIST_M                       | Val  Loss: 1.2047 | Val  Acc: 0.5802
 Site-SVHN                          | Val  Loss: 1.6272 | Val  Acc: 0.4429
Average Valid Accuracy: 0.8385
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.0264 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3127 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0238 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0617 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.3485 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0918 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0935 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1369 | Train Acc: 0.9389
 Site-MNIST                         | Train Loss: 0.0727 | Train Acc: 0.9755
 Site-MNIST                         | Train Loss: 0.0468 | Train Acc: 0.9917
 Site-USPS                          | Train Loss: 0.2512 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0822 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.2103 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1914 | Train Acc: 0.9270
 Site-USPS                          | Train Loss: 0.1345 | Train Acc: 0.9667
 Site-USPS                          | Train Loss: 0.1233 | Train Acc: 0.9590
 Site-SynthDigits                   | Train Loss: 1.2276 | Train Acc: 0.5695
 Site-SynthDigits                   | Train Loss: 1.0710 | Train Acc: 0.6557
 Site-SynthDigits                   | Train Loss: 0.9218 | Train Acc: 0.6965
 Site-MNIST_M                       | Train Loss: 1.4685 | Train Acc: 0.4862
 Site-MNIST_M                       | Train Loss: 1.4788 | Train Acc: 0.5321
 Site-SVHN                          | Train Loss: 1.9327 | Train Acc: 0.3546
Average Train Accuracy: 0.8450
 Site-MNIST                         | Val  Loss: 0.0066 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0229 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2477 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2115 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1186 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0490 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0807 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0737 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1364 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1178 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2774 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3641 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3338 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2694 | Val  Acc: 0.8952
 Site-USPS                          | Val  Loss: 0.1637 | Val  Acc: 0.9418
 Site-SynthDigits                   | Val  Loss: 1.0339 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 0.8711 | Val  Acc: 0.6324
 Site-SynthDigits                   | Val  Loss: 1.0686 | Val  Acc: 0.6311
 Site-MNIST_M                       | Val  Loss: 1.3651 | Val  Acc: 0.6444
 Site-MNIST_M                       | Val  Loss: 1.2097 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.6251 | Val  Acc: 0.4143
Average Valid Accuracy: 0.8371
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.0423 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3152 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0244 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0675 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1353 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0938 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.0839 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1230 | Train Acc: 0.9364
 Site-MNIST                         | Train Loss: 0.0678 | Train Acc: 0.9742
 Site-MNIST                         | Train Loss: 0.0456 | Train Acc: 0.9909
 Site-USPS                          | Train Loss: 0.2514 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0788 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1153 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1918 | Train Acc: 0.9227
 Site-USPS                          | Train Loss: 0.1272 | Train Acc: 0.9643
 Site-USPS                          | Train Loss: 0.1187 | Train Acc: 0.9603
 Site-SynthDigits                   | Train Loss: 1.1331 | Train Acc: 0.5762
 Site-SynthDigits                   | Train Loss: 1.0163 | Train Acc: 0.6667
 Site-SynthDigits                   | Train Loss: 0.9134 | Train Acc: 0.6986
 Site-MNIST_M                       | Train Loss: 1.4361 | Train Acc: 0.4862
 Site-MNIST_M                       | Train Loss: 1.5309 | Train Acc: 0.5443
 Site-SVHN                          | Train Loss: 1.9523 | Train Acc: 0.3475
Average Train Accuracy: 0.8429
 Site-MNIST                         | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0236 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1924 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1927 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1075 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0571 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0879 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0763 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1337 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1142 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0053 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2677 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3342 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3188 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2555 | Val  Acc: 0.8952
 Site-USPS                          | Val  Loss: 0.1609 | Val  Acc: 0.9365
 Site-SynthDigits                   | Val  Loss: 1.0506 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 0.8744 | Val  Acc: 0.6618
 Site-SynthDigits                   | Val  Loss: 1.0433 | Val  Acc: 0.6475
 Site-MNIST_M                       | Val  Loss: 1.3532 | Val  Acc: 0.6444
 Site-MNIST_M                       | Val  Loss: 1.1934 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.5839 | Val  Acc: 0.4429
Average Valid Accuracy: 0.8426
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.0199 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2884 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0197 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0524 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1732 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0841 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0797 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1317 | Train Acc: 0.9413
 Site-MNIST                         | Train Loss: 0.0667 | Train Acc: 0.9796
 Site-MNIST                         | Train Loss: 0.0406 | Train Acc: 0.9940
 Site-USPS                          | Train Loss: 0.2605 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1169 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1160 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1787 | Train Acc: 0.9356
 Site-USPS                          | Train Loss: 0.1206 | Train Acc: 0.9667
 Site-USPS                          | Train Loss: 0.1179 | Train Acc: 0.9590
 Site-SynthDigits                   | Train Loss: 1.1774 | Train Acc: 0.5695
 Site-SynthDigits                   | Train Loss: 0.9778 | Train Acc: 0.6740
 Site-SynthDigits                   | Train Loss: 0.8820 | Train Acc: 0.6925
 Site-MNIST_M                       | Train Loss: 1.4361 | Train Acc: 0.4917
 Site-MNIST_M                       | Train Loss: 1.5862 | Train Acc: 0.5535
 Site-SVHN                          | Train Loss: 1.9125 | Train Acc: 0.3475
Average Train Accuracy: 0.8519
 Site-MNIST                         | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0185 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2300 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2343 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1308 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0533 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0820 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0723 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1310 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.1135 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0048 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2587 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3132 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3020 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2439 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1599 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 1.0353 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 0.8515 | Val  Acc: 0.6618
 Site-SynthDigits                   | Val  Loss: 1.0239 | Val  Acc: 0.6475
 Site-MNIST_M                       | Val  Loss: 1.3651 | Val  Acc: 0.6444
 Site-MNIST_M                       | Val  Loss: 1.1919 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.5884 | Val  Acc: 0.4571
Average Valid Accuracy: 0.8454
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.0263 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2675 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0209 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0525 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0966 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0849 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0907 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1185 | Train Acc: 0.9487
 Site-MNIST                         | Train Loss: 0.0626 | Train Acc: 0.9783
 Site-MNIST                         | Train Loss: 0.0385 | Train Acc: 0.9925
 Site-USPS                          | Train Loss: 0.2433 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0812 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1126 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.1825 | Train Acc: 0.9313
 Site-USPS                          | Train Loss: 0.1212 | Train Acc: 0.9667
 Site-USPS                          | Train Loss: 0.1163 | Train Acc: 0.9616
 Site-SynthDigits                   | Train Loss: 1.2855 | Train Acc: 0.5960
 Site-SynthDigits                   | Train Loss: 1.0648 | Train Acc: 0.6447
 Site-SynthDigits                   | Train Loss: 0.9047 | Train Acc: 0.6925
 Site-MNIST_M                       | Train Loss: 1.4390 | Train Acc: 0.5083
 Site-MNIST_M                       | Train Loss: 1.3133 | Train Acc: 0.5413
 Site-SVHN                          | Train Loss: 1.9750 | Train Acc: 0.3617
Average Train Accuracy: 0.8516
 Site-MNIST                         | Val  Loss: 0.0087 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0301 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2306 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2026 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1104 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0489 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0774 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0712 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1305 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.1117 | Val  Acc: 0.9607
 Site-USPS                          | Val  Loss: 0.0052 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2509 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3157 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3033 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2504 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1642 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 1.0296 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 0.8436 | Val  Acc: 0.6471
 Site-SynthDigits                   | Val  Loss: 1.0412 | Val  Acc: 0.6311
 Site-MNIST_M                       | Val  Loss: 1.3634 | Val  Acc: 0.6667
 Site-MNIST_M                       | Val  Loss: 1.1961 | Val  Acc: 0.5926
 Site-SVHN                          | Val  Loss: 1.6015 | Val  Acc: 0.4714
Average Valid Accuracy: 0.8468
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.0399 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2753 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0267 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0716 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.3250 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0857 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0783 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1174 | Train Acc: 0.9438
 Site-MNIST                         | Train Loss: 0.0631 | Train Acc: 0.9823
 Site-MNIST                         | Train Loss: 0.0396 | Train Acc: 0.9925
 Site-USPS                          | Train Loss: 0.2412 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0776 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.1393 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1805 | Train Acc: 0.9227
 Site-USPS                          | Train Loss: 0.1152 | Train Acc: 0.9690
 Site-USPS                          | Train Loss: 0.1041 | Train Acc: 0.9669
 Site-SynthDigits                   | Train Loss: 1.2350 | Train Acc: 0.5960
 Site-SynthDigits                   | Train Loss: 1.0307 | Train Acc: 0.6447
 Site-SynthDigits                   | Train Loss: 0.8866 | Train Acc: 0.6986
 Site-MNIST_M                       | Train Loss: 1.4553 | Train Acc: 0.4807
 Site-MNIST_M                       | Train Loss: 1.3233 | Train Acc: 0.5505
 Site-SVHN                          | Train Loss: 1.9246 | Train Acc: 0.3652
Average Train Accuracy: 0.8446
 Site-MNIST                         | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0310 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1673 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1651 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.0894 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0505 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0760 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0707 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1246 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.1088 | Val  Acc: 0.9607
 Site-USPS                          | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2107 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.2936 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3027 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2492 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1569 | Val  Acc: 0.9418
 Site-SynthDigits                   | Val  Loss: 1.0060 | Val  Acc: 0.6216
 Site-SynthDigits                   | Val  Loss: 0.8222 | Val  Acc: 0.6618
 Site-SynthDigits                   | Val  Loss: 1.0303 | Val  Acc: 0.6393
 Site-MNIST_M                       | Val  Loss: 1.3639 | Val  Acc: 0.6444
 Site-MNIST_M                       | Val  Loss: 1.2077 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.5914 | Val  Acc: 0.4714
Average Valid Accuracy: 0.8440
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.0253 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2633 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0253 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0570 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0919 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0796 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0782 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1154 | Train Acc: 0.9535
 Site-MNIST                         | Train Loss: 0.0582 | Train Acc: 0.9837
 Site-MNIST                         | Train Loss: 0.0364 | Train Acc: 0.9940
 Site-USPS                          | Train Loss: 0.2505 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1589 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1162 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.1819 | Train Acc: 0.9313
 Site-USPS                          | Train Loss: 0.1126 | Train Acc: 0.9667
 Site-USPS                          | Train Loss: 0.1137 | Train Acc: 0.9577
 Site-SynthDigits                   | Train Loss: 1.1341 | Train Acc: 0.5960
 Site-SynthDigits                   | Train Loss: 1.0388 | Train Acc: 0.6557
 Site-SynthDigits                   | Train Loss: 0.8864 | Train Acc: 0.7088
 Site-MNIST_M                       | Train Loss: 1.4450 | Train Acc: 0.5083
 Site-MNIST_M                       | Train Loss: 1.3343 | Train Acc: 0.5474
 Site-SVHN                          | Train Loss: 1.9604 | Train Acc: 0.3404
Average Train Accuracy: 0.8484
 Site-MNIST                         | Val  Loss: 0.0096 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0298 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1973 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1930 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1051 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0448 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0620 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0596 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1200 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.1043 | Val  Acc: 0.9607
 Site-USPS                          | Val  Loss: 0.0042 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2334 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3097 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.2856 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2395 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1605 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 1.0253 | Val  Acc: 0.6216
 Site-SynthDigits                   | Val  Loss: 0.7988 | Val  Acc: 0.6471
 Site-SynthDigits                   | Val  Loss: 1.0138 | Val  Acc: 0.6393
 Site-MNIST_M                       | Val  Loss: 1.3707 | Val  Acc: 0.6222
 Site-MNIST_M                       | Val  Loss: 1.1985 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.5992 | Val  Acc: 0.4571
Average Valid Accuracy: 0.8451
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.0326 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2570 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0239 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0540 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1028 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0798 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0821 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1143 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.0581 | Train Acc: 0.9864
 Site-MNIST                         | Train Loss: 0.0340 | Train Acc: 0.9940
 Site-USPS                          | Train Loss: 0.2572 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1822 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1154 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1959 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.1120 | Train Acc: 0.9667
 Site-USPS                          | Train Loss: 0.1091 | Train Acc: 0.9643
 Site-SynthDigits                   | Train Loss: 1.1860 | Train Acc: 0.6026
 Site-SynthDigits                   | Train Loss: 1.0560 | Train Acc: 0.6630
 Site-SynthDigits                   | Train Loss: 0.8926 | Train Acc: 0.7067
 Site-MNIST_M                       | Train Loss: 1.4415 | Train Acc: 0.4972
 Site-MNIST_M                       | Train Loss: 1.2980 | Train Acc: 0.5505
 Site-SVHN                          | Train Loss: 1.9140 | Train Acc: 0.3617
Average Train Accuracy: 0.8527
 Site-MNIST                         | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0176 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1920 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1815 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.0994 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0443 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0694 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0661 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1213 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.1068 | Val  Acc: 0.9637
 Site-USPS                          | Val  Loss: 0.0046 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2565 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3166 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3075 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.2514 | Val  Acc: 0.8857
 Site-USPS                          | Val  Loss: 0.1699 | Val  Acc: 0.9312
 Site-SynthDigits                   | Val  Loss: 1.0002 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 0.8389 | Val  Acc: 0.6471
 Site-SynthDigits                   | Val  Loss: 1.0275 | Val  Acc: 0.6475
 Site-MNIST_M                       | Val  Loss: 1.3722 | Val  Acc: 0.6444
 Site-MNIST_M                       | Val  Loss: 1.1972 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.5833 | Val  Acc: 0.4714
Average Valid Accuracy: 0.8432
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.0213 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2694 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0191 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0517 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.2125 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0806 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.0750 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1106 | Train Acc: 0.9462
 Site-MNIST                         | Train Loss: 0.0538 | Train Acc: 0.9851
 Site-MNIST                         | Train Loss: 0.0341 | Train Acc: 0.9932
 Site-USPS                          | Train Loss: 0.2463 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1476 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1054 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1887 | Train Acc: 0.9313
 Site-USPS                          | Train Loss: 0.1151 | Train Acc: 0.9690
 Site-USPS                          | Train Loss: 0.1039 | Train Acc: 0.9643
 Site-SynthDigits                   | Train Loss: 1.1898 | Train Acc: 0.5828
 Site-SynthDigits                   | Train Loss: 1.0277 | Train Acc: 0.6484
 Site-SynthDigits                   | Train Loss: 0.8615 | Train Acc: 0.7189
 Site-MNIST_M                       | Train Loss: 1.4547 | Train Acc: 0.5083
 Site-MNIST_M                       | Train Loss: 1.2977 | Train Acc: 0.5627
 Site-SVHN                          | Train Loss: 1.8810 | Train Acc: 0.3723
Average Train Accuracy: 0.8545
 Site-MNIST                         | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0169 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1893 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1898 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1043 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0437 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0691 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0640 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1166 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.1003 | Val  Acc: 0.9637
 Site-USPS                          | Val  Loss: 0.0063 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2767 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3282 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3169 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2509 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1572 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 0.9988 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 0.8351 | Val  Acc: 0.6471
 Site-SynthDigits                   | Val  Loss: 1.0206 | Val  Acc: 0.6311
 Site-MNIST_M                       | Val  Loss: 1.3647 | Val  Acc: 0.6000
 Site-MNIST_M                       | Val  Loss: 1.1825 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.6087 | Val  Acc: 0.4714
Average Valid Accuracy: 0.8432
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.0261 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2521 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0143 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0491 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1957 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0747 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0743 | Train Acc: 0.9780
 Site-MNIST                         | Train Loss: 0.1174 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.0560 | Train Acc: 0.9810
 Site-MNIST                         | Train Loss: 0.0308 | Train Acc: 0.9947
 Site-USPS                          | Train Loss: 0.2585 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1778 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.1159 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.1789 | Train Acc: 0.9313
 Site-USPS                          | Train Loss: 0.1051 | Train Acc: 0.9690
 Site-USPS                          | Train Loss: 0.1079 | Train Acc: 0.9603
 Site-SynthDigits                   | Train Loss: 1.1166 | Train Acc: 0.5762
 Site-SynthDigits                   | Train Loss: 0.9980 | Train Acc: 0.6740
 Site-SynthDigits                   | Train Loss: 0.8512 | Train Acc: 0.7271
 Site-MNIST_M                       | Train Loss: 1.4519 | Train Acc: 0.4917
 Site-MNIST_M                       | Train Loss: 1.3572 | Train Acc: 0.5627
 Site-SVHN                          | Train Loss: 1.9389 | Train Acc: 0.3369
Average Train Accuracy: 0.8525
 Site-MNIST                         | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0126 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1525 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1727 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0968 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0442 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0640 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0611 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1180 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.1040 | Val  Acc: 0.9668
 Site-USPS                          | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2629 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3115 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.2821 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2265 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1589 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 1.0159 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 0.8511 | Val  Acc: 0.6912
 Site-SynthDigits                   | Val  Loss: 1.0163 | Val  Acc: 0.6557
 Site-MNIST_M                       | Val  Loss: 1.3621 | Val  Acc: 0.6222
 Site-MNIST_M                       | Val  Loss: 1.1850 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.6189 | Val  Acc: 0.4571
Average Valid Accuracy: 0.8663
 Best site-MNIST                     | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9454
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9668
 Best site-USPS                      | Epoch:38 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:38 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:38 | Val Acc: 0.8750
 Best site-USPS                      | Epoch:38 | Val Acc: 0.8966
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9143
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9524
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.7027
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.6912
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.6557
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.6222
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.5556
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.4571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/fedsam...
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.0258 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2857 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0146 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0487 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0902 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0758 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0767 | Train Acc: 0.9736
 Site-MNIST                         | Train Loss: 0.1175 | Train Acc: 0.9487
 Site-MNIST                         | Train Loss: 0.0557 | Train Acc: 0.9837
 Site-MNIST                         | Train Loss: 0.0326 | Train Acc: 0.9932
 Site-USPS                          | Train Loss: 0.2414 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0755 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1058 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1645 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.1069 | Train Acc: 0.9738
 Site-USPS                          | Train Loss: 0.0942 | Train Acc: 0.9683
 Site-SynthDigits                   | Train Loss: 1.1905 | Train Acc: 0.6225
 Site-SynthDigits                   | Train Loss: 1.0275 | Train Acc: 0.6886
 Site-SynthDigits                   | Train Loss: 0.8386 | Train Acc: 0.7373
 Site-MNIST_M                       | Train Loss: 1.4272 | Train Acc: 0.4972
 Site-MNIST_M                       | Train Loss: 1.4053 | Train Acc: 0.5657
 Site-SVHN                          | Train Loss: 1.9060 | Train Acc: 0.3404
Average Train Accuracy: 0.8564
 Site-MNIST                         | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0229 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1684 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1657 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.0909 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0389 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0685 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0613 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1138 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.0989 | Val  Acc: 0.9668
 Site-USPS                          | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2106 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.2957 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.2774 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2264 | Val  Acc: 0.9238
 Site-USPS                          | Val  Loss: 0.1414 | Val  Acc: 0.9630
 Site-SynthDigits                   | Val  Loss: 0.9677 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 0.8459 | Val  Acc: 0.6912
 Site-SynthDigits                   | Val  Loss: 0.9957 | Val  Acc: 0.6967
 Site-MNIST_M                       | Val  Loss: 1.3598 | Val  Acc: 0.6222
 Site-MNIST_M                       | Val  Loss: 1.1720 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.5722 | Val  Acc: 0.4286
Average Valid Accuracy: 0.8512
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.0225 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2802 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0137 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0510 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0998 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0779 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0816 | Train Acc: 0.9736
 Site-MNIST                         | Train Loss: 0.1042 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.0524 | Train Acc: 0.9837
 Site-MNIST                         | Train Loss: 0.0309 | Train Acc: 0.9947
 Site-USPS                          | Train Loss: 0.2427 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1464 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1729 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1876 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.0996 | Train Acc: 0.9738
 Site-USPS                          | Train Loss: 0.0953 | Train Acc: 0.9669
 Site-SynthDigits                   | Train Loss: 1.2438 | Train Acc: 0.6225
 Site-SynthDigits                   | Train Loss: 0.9666 | Train Acc: 0.6777
 Site-SynthDigits                   | Train Loss: 0.8299 | Train Acc: 0.7251
 Site-MNIST_M                       | Train Loss: 1.4317 | Train Acc: 0.5138
 Site-MNIST_M                       | Train Loss: 1.1944 | Train Acc: 0.5627
 Site-SVHN                          | Train Loss: 1.8896 | Train Acc: 0.3546
Average Train Accuracy: 0.8555
 Site-MNIST                         | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0190 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1315 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1283 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0712 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0394 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0733 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0643 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1150 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.0983 | Val  Acc: 0.9637
 Site-USPS                          | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2099 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.2886 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.2752 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2252 | Val  Acc: 0.9238
 Site-USPS                          | Val  Loss: 0.1459 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 0.9637 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 0.8489 | Val  Acc: 0.6912
 Site-SynthDigits                   | Val  Loss: 1.0030 | Val  Acc: 0.6803
 Site-MNIST_M                       | Val  Loss: 1.3565 | Val  Acc: 0.6222
 Site-MNIST_M                       | Val  Loss: 1.1786 | Val  Acc: 0.5802
 Site-SVHN                          | Val  Loss: 1.5941 | Val  Acc: 0.4714
Average Valid Accuracy: 0.8697
 Best site-MNIST                     | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9454
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9637
 Best site-USPS                      | Epoch:40 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:40 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:40 | Val Acc: 0.8750
 Best site-USPS                      | Epoch:40 | Val Acc: 0.8966
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9238
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9577
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.7027
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.6912
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.6803
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.6222
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.5802
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.4714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/fedsam...
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.0156 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2956 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0160 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0457 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1010 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0795 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0837 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1048 | Train Acc: 0.9560
 Site-MNIST                         | Train Loss: 0.0494 | Train Acc: 0.9864
 Site-MNIST                         | Train Loss: 0.0303 | Train Acc: 0.9955
 Site-USPS                          | Train Loss: 0.2446 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1126 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1073 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.1683 | Train Acc: 0.9356
 Site-USPS                          | Train Loss: 0.1009 | Train Acc: 0.9714
 Site-USPS                          | Train Loss: 0.0933 | Train Acc: 0.9669
 Site-SynthDigits                   | Train Loss: 1.1947 | Train Acc: 0.6225
 Site-SynthDigits                   | Train Loss: 0.9860 | Train Acc: 0.6593
 Site-SynthDigits                   | Train Loss: 0.8328 | Train Acc: 0.7332
 Site-MNIST_M                       | Train Loss: 1.4470 | Train Acc: 0.5138
 Site-MNIST_M                       | Train Loss: 1.3383 | Train Acc: 0.5841
 Site-SVHN                          | Train Loss: 1.8977 | Train Acc: 0.3723
Average Train Accuracy: 0.8567
 Site-MNIST                         | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0100 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1508 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1419 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0801 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0364 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0690 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0590 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1081 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.0891 | Val  Acc: 0.9637
 Site-USPS                          | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2662 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3120 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.2923 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2277 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1483 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 0.9826 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 0.8099 | Val  Acc: 0.6471
 Site-SynthDigits                   | Val  Loss: 1.0014 | Val  Acc: 0.6475
 Site-MNIST_M                       | Val  Loss: 1.3693 | Val  Acc: 0.6000
 Site-MNIST_M                       | Val  Loss: 1.1730 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.5861 | Val  Acc: 0.4857
Average Valid Accuracy: 0.8622
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.0173 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2606 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.0180 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0474 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1066 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0744 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0834 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.1023 | Train Acc: 0.9560
 Site-MNIST                         | Train Loss: 0.0472 | Train Acc: 0.9891
 Site-MNIST                         | Train Loss: 0.0293 | Train Acc: 0.9947
 Site-USPS                          | Train Loss: 0.2424 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1185 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1276 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1717 | Train Acc: 0.9313
 Site-USPS                          | Train Loss: 0.1011 | Train Acc: 0.9667
 Site-USPS                          | Train Loss: 0.0978 | Train Acc: 0.9683
 Site-SynthDigits                   | Train Loss: 1.1264 | Train Acc: 0.6026
 Site-SynthDigits                   | Train Loss: 1.0017 | Train Acc: 0.6630
 Site-SynthDigits                   | Train Loss: 0.8434 | Train Acc: 0.7251
 Site-MNIST_M                       | Train Loss: 1.4333 | Train Acc: 0.5083
 Site-MNIST_M                       | Train Loss: 1.2510 | Train Acc: 0.5780
 Site-SVHN                          | Train Loss: 1.9748 | Train Acc: 0.3652
Average Train Accuracy: 0.8538
 Site-MNIST                         | Val  Loss: 0.0087 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0119 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1445 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1572 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0862 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0369 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0588 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0541 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.1038 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.0891 | Val  Acc: 0.9637
 Site-USPS                          | Val  Loss: 0.0053 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2694 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3104 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.2949 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2408 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1646 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 0.9958 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 0.8127 | Val  Acc: 0.6324
 Site-SynthDigits                   | Val  Loss: 1.0130 | Val  Acc: 0.6393
 Site-MNIST_M                       | Val  Loss: 1.3702 | Val  Acc: 0.5778
 Site-MNIST_M                       | Val  Loss: 1.1758 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.6348 | Val  Acc: 0.4714
Average Valid Accuracy: 0.8584
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.0296 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2418 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0168 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0436 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0952 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0748 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0691 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.0952 | Train Acc: 0.9535
 Site-MNIST                         | Train Loss: 0.0486 | Train Acc: 0.9864
 Site-MNIST                         | Train Loss: 0.0264 | Train Acc: 0.9955
 Site-USPS                          | Train Loss: 0.2362 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0975 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1245 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.1703 | Train Acc: 0.9227
 Site-USPS                          | Train Loss: 0.1025 | Train Acc: 0.9738
 Site-USPS                          | Train Loss: 0.0876 | Train Acc: 0.9683
 Site-SynthDigits                   | Train Loss: 1.2718 | Train Acc: 0.6159
 Site-SynthDigits                   | Train Loss: 0.9512 | Train Acc: 0.6740
 Site-SynthDigits                   | Train Loss: 0.8215 | Train Acc: 0.7393
 Site-MNIST_M                       | Train Loss: 1.4603 | Train Acc: 0.5028
 Site-MNIST_M                       | Train Loss: 1.1974 | Train Acc: 0.5627
 Site-SVHN                          | Train Loss: 1.8834 | Train Acc: 0.3688
Average Train Accuracy: 0.8578
 Site-MNIST                         | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0317 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1351 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1659 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0866 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0399 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0577 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0530 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.0995 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.0876 | Val  Acc: 0.9607
 Site-USPS                          | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2280 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.2980 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.2884 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2434 | Val  Acc: 0.8952
 Site-USPS                          | Val  Loss: 0.1530 | Val  Acc: 0.9471
 Site-SynthDigits                   | Val  Loss: 0.9584 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 0.7919 | Val  Acc: 0.6765
 Site-SynthDigits                   | Val  Loss: 0.9856 | Val  Acc: 0.6639
 Site-MNIST_M                       | Val  Loss: 1.4068 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.2068 | Val  Acc: 0.5432
 Site-SVHN                          | Val  Loss: 1.5830 | Val  Acc: 0.4571
Average Valid Accuracy: 0.8590
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.0132 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2579 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0127 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0401 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1242 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0673 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0767 | Train Acc: 0.9736
 Site-MNIST                         | Train Loss: 0.1056 | Train Acc: 0.9584
 Site-MNIST                         | Train Loss: 0.0466 | Train Acc: 0.9864
 Site-MNIST                         | Train Loss: 0.0241 | Train Acc: 0.9977
 Site-USPS                          | Train Loss: 0.2546 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1621 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1160 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1700 | Train Acc: 0.9313
 Site-USPS                          | Train Loss: 0.0953 | Train Acc: 0.9714
 Site-USPS                          | Train Loss: 0.0962 | Train Acc: 0.9669
 Site-SynthDigits                   | Train Loss: 1.1193 | Train Acc: 0.6225
 Site-SynthDigits                   | Train Loss: 0.9214 | Train Acc: 0.6667
 Site-SynthDigits                   | Train Loss: 0.7974 | Train Acc: 0.7312
 Site-MNIST_M                       | Train Loss: 1.4190 | Train Acc: 0.5193
 Site-MNIST_M                       | Train Loss: 1.2369 | Train Acc: 0.5749
 Site-SVHN                          | Train Loss: 1.9112 | Train Acc: 0.3582
Average Train Accuracy: 0.8588
 Site-MNIST                         | Val  Loss: 0.0089 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0257 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1627 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1878 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1005 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0432 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0594 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0508 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.0954 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.0790 | Val  Acc: 0.9668
 Site-USPS                          | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2346 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.2923 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.2741 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2277 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1533 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 0.9555 | Val  Acc: 0.6216
 Site-SynthDigits                   | Val  Loss: 0.7479 | Val  Acc: 0.6471
 Site-SynthDigits                   | Val  Loss: 0.9738 | Val  Acc: 0.6393
 Site-MNIST_M                       | Val  Loss: 1.3595 | Val  Acc: 0.6000
 Site-MNIST_M                       | Val  Loss: 1.1800 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.5842 | Val  Acc: 0.4571
Average Valid Accuracy: 0.8599
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.0161 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2271 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0144 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0476 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1160 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0657 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0732 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.0961 | Train Acc: 0.9584
 Site-MNIST                         | Train Loss: 0.0427 | Train Acc: 0.9905
 Site-MNIST                         | Train Loss: 0.0236 | Train Acc: 0.9977
 Site-USPS                          | Train Loss: 0.2525 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.1526 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1102 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1663 | Train Acc: 0.9356
 Site-USPS                          | Train Loss: 0.0994 | Train Acc: 0.9762
 Site-USPS                          | Train Loss: 0.0887 | Train Acc: 0.9696
 Site-SynthDigits                   | Train Loss: 1.0812 | Train Acc: 0.6291
 Site-SynthDigits                   | Train Loss: 0.9518 | Train Acc: 0.6777
 Site-SynthDigits                   | Train Loss: 0.8113 | Train Acc: 0.7434
 Site-MNIST_M                       | Train Loss: 1.4271 | Train Acc: 0.5249
 Site-MNIST_M                       | Train Loss: 1.4906 | Train Acc: 0.5780
 Site-SVHN                          | Train Loss: 1.9086 | Train Acc: 0.3475
Average Train Accuracy: 0.8595
 Site-MNIST                         | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0139 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1539 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1738 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.0941 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0382 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0465 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0460 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.0917 | Val  Acc: 0.9617
 Site-MNIST                         | Val  Loss: 0.0836 | Val  Acc: 0.9668
 Site-USPS                          | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2435 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.2975 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.2751 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2287 | Val  Acc: 0.9238
 Site-USPS                          | Val  Loss: 0.1505 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 0.9289 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 0.7442 | Val  Acc: 0.6618
 Site-SynthDigits                   | Val  Loss: 0.9851 | Val  Acc: 0.6557
 Site-MNIST_M                       | Val  Loss: 1.3629 | Val  Acc: 0.5778
 Site-MNIST_M                       | Val  Loss: 1.1835 | Val  Acc: 0.5802
 Site-SVHN                          | Val  Loss: 1.5824 | Val  Acc: 0.4286
Average Valid Accuracy: 0.8474
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.0152 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2429 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0103 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0440 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0895 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0742 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0710 | Train Acc: 0.9736
 Site-MNIST                         | Train Loss: 0.0909 | Train Acc: 0.9584
 Site-MNIST                         | Train Loss: 0.0446 | Train Acc: 0.9864
 Site-MNIST                         | Train Loss: 0.0243 | Train Acc: 0.9962
 Site-USPS                          | Train Loss: 0.2549 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2077 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.0983 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.1603 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.0956 | Train Acc: 0.9690
 Site-USPS                          | Train Loss: 0.0804 | Train Acc: 0.9762
 Site-SynthDigits                   | Train Loss: 1.1512 | Train Acc: 0.6159
 Site-SynthDigits                   | Train Loss: 0.9174 | Train Acc: 0.6996
 Site-SynthDigits                   | Train Loss: 0.7853 | Train Acc: 0.7515
 Site-MNIST_M                       | Train Loss: 1.4453 | Train Acc: 0.4972
 Site-MNIST_M                       | Train Loss: 1.2999 | Train Acc: 0.5872
 Site-SVHN                          | Train Loss: 1.8350 | Train Acc: 0.3440
Average Train Accuracy: 0.8605
 Site-MNIST                         | Val  Loss: 0.0055 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0179 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0746 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1074 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0586 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0364 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0627 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0517 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.0976 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.0800 | Val  Acc: 0.9668
 Site-USPS                          | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2245 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.2866 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.2894 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2282 | Val  Acc: 0.9238
 Site-USPS                          | Val  Loss: 0.1346 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 0.8988 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 0.7099 | Val  Acc: 0.7353
 Site-SynthDigits                   | Val  Loss: 0.9486 | Val  Acc: 0.6885
 Site-MNIST_M                       | Val  Loss: 1.3558 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.1719 | Val  Acc: 0.5309
 Site-SVHN                          | Val  Loss: 1.5676 | Val  Acc: 0.4286
Average Valid Accuracy: 0.8692
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.0180 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2709 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0086 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0443 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1139 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0748 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0788 | Train Acc: 0.9736
 Site-MNIST                         | Train Loss: 0.0900 | Train Acc: 0.9633
 Site-MNIST                         | Train Loss: 0.0473 | Train Acc: 0.9891
 Site-MNIST                         | Train Loss: 0.0247 | Train Acc: 0.9977
 Site-USPS                          | Train Loss: 0.2461 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1729 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.0957 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1556 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.0908 | Train Acc: 0.9714
 Site-USPS                          | Train Loss: 0.0759 | Train Acc: 0.9762
 Site-SynthDigits                   | Train Loss: 1.0734 | Train Acc: 0.5960
 Site-SynthDigits                   | Train Loss: 0.9090 | Train Acc: 0.6996
 Site-SynthDigits                   | Train Loss: 0.7867 | Train Acc: 0.7413
 Site-MNIST_M                       | Train Loss: 1.4365 | Train Acc: 0.4751
 Site-MNIST_M                       | Train Loss: 1.2100 | Train Acc: 0.5963
 Site-SVHN                          | Train Loss: 1.8833 | Train Acc: 0.3652
Average Train Accuracy: 0.8615
 Site-MNIST                         | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0155 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0944 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1183 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0648 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0345 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0642 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0542 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.0987 | Val  Acc: 0.9563
 Site-MNIST                         | Val  Loss: 0.0811 | Val  Acc: 0.9698
 Site-USPS                          | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2184 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.2782 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.2845 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2195 | Val  Acc: 0.9333
 Site-USPS                          | Val  Loss: 0.1251 | Val  Acc: 0.9630
 Site-SynthDigits                   | Val  Loss: 0.8675 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 0.6962 | Val  Acc: 0.7500
 Site-SynthDigits                   | Val  Loss: 0.9425 | Val  Acc: 0.6885
 Site-MNIST_M                       | Val  Loss: 1.3587 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.1631 | Val  Acc: 0.5309
 Site-SVHN                          | Val  Loss: 1.5605 | Val  Acc: 0.4571
Average Valid Accuracy: 0.8683
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.0190 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2451 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0100 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0391 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1058 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0637 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0735 | Train Acc: 0.9736
 Site-MNIST                         | Train Loss: 0.0957 | Train Acc: 0.9609
 Site-MNIST                         | Train Loss: 0.0425 | Train Acc: 0.9905
 Site-MNIST                         | Train Loss: 0.0208 | Train Acc: 0.9985
 Site-USPS                          | Train Loss: 0.2519 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0724 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 1.8044 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.1659 | Train Acc: 0.9356
 Site-USPS                          | Train Loss: 0.0904 | Train Acc: 0.9690
 Site-USPS                          | Train Loss: 0.0854 | Train Acc: 0.9683
 Site-SynthDigits                   | Train Loss: 1.1250 | Train Acc: 0.5960
 Site-SynthDigits                   | Train Loss: 0.9566 | Train Acc: 0.6886
 Site-SynthDigits                   | Train Loss: 0.7671 | Train Acc: 0.7454
 Site-MNIST_M                       | Train Loss: 1.4545 | Train Acc: 0.5083
 Site-MNIST_M                       | Train Loss: 1.3871 | Train Acc: 0.5810
 Site-SVHN                          | Train Loss: 1.9396 | Train Acc: 0.3617
Average Train Accuracy: 0.8625
 Site-MNIST                         | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0257 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1248 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1547 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0814 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0380 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0515 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0508 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.0955 | Val  Acc: 0.9563
 Site-MNIST                         | Val  Loss: 0.0858 | Val  Acc: 0.9698
 Site-USPS                          | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2054 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.2803 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.2646 | Val  Acc: 0.9138
 Site-USPS                          | Val  Loss: 0.2282 | Val  Acc: 0.9238
 Site-USPS                          | Val  Loss: 0.1456 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 0.8650 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 0.7037 | Val  Acc: 0.7059
 Site-SynthDigits                   | Val  Loss: 0.9545 | Val  Acc: 0.6803
 Site-MNIST_M                       | Val  Loss: 1.3625 | Val  Acc: 0.5778
 Site-MNIST_M                       | Val  Loss: 1.1754 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.6129 | Val  Acc: 0.4571
Average Valid Accuracy: 0.8682
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.0105 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2505 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0082 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0357 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2804 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0677 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0793 | Train Acc: 0.9736
 Site-MNIST                         | Train Loss: 0.0890 | Train Acc: 0.9633
 Site-MNIST                         | Train Loss: 0.0406 | Train Acc: 0.9905
 Site-MNIST                         | Train Loss: 0.0208 | Train Acc: 0.9985
 Site-USPS                          | Train Loss: 0.2484 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2018 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.1059 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1684 | Train Acc: 0.9356
 Site-USPS                          | Train Loss: 0.0873 | Train Acc: 0.9714
 Site-USPS                          | Train Loss: 0.0805 | Train Acc: 0.9722
 Site-SynthDigits                   | Train Loss: 1.0473 | Train Acc: 0.6093
 Site-SynthDigits                   | Train Loss: 0.9999 | Train Acc: 0.6996
 Site-SynthDigits                   | Train Loss: 0.7781 | Train Acc: 0.7556
 Site-MNIST_M                       | Train Loss: 1.4477 | Train Acc: 0.5083
 Site-MNIST_M                       | Train Loss: 1.2644 | Train Acc: 0.5810
 Site-SVHN                          | Train Loss: 1.9047 | Train Acc: 0.3652
Average Train Accuracy: 0.8627
 Site-MNIST                         | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0071 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0959 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1359 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0752 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0377 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0532 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0483 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.0899 | Val  Acc: 0.9563
 Site-MNIST                         | Val  Loss: 0.0769 | Val  Acc: 0.9698
 Site-USPS                          | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2450 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.2995 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.2841 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2254 | Val  Acc: 0.9238
 Site-USPS                          | Val  Loss: 0.1389 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 0.8834 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 0.7272 | Val  Acc: 0.7206
 Site-SynthDigits                   | Val  Loss: 0.9434 | Val  Acc: 0.6967
 Site-MNIST_M                       | Val  Loss: 1.3670 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.1721 | Val  Acc: 0.5432
 Site-SVHN                          | Val  Loss: 1.5828 | Val  Acc: 0.4429
Average Valid Accuracy: 0.8653
===2023-07-28 20:37:10===
===2023-07-28 20:37:13===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:40 | Test Acc: 0.9534
 Test site-USPS                      | Epoch:40 | Test Acc: 0.9505
 Test site-SynthDigits               | Epoch:40 | Test Acc: 0.6201
 Test site-MNIST_M                   | Epoch:40 | Test Acc: 0.3884
 Test site-SVHN                      | Epoch:40 | Test Acc: 0.2732
MNIST: 0.9534, USPS: 0.9505, SynthDigits: 0.6201, MNIST_M: 0.3884, SVHN: 0.2732, 
Average Test Accuracy(group): 0.6371, Average Test Accuracy(individual): 0.8249,
domain std=0.2803, cluster std=-1.0000, individual std=0.2206, 
