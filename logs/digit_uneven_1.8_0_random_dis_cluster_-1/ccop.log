===2023-07-28 23:15:23===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[6, 2, 10, 3, 1, ]
cnt=[3, 10, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (2) | Train Loss: 1.6933 | Train Acc: 0.5000
 Site-MNIST                     (2) | Train Loss: 1.7288 | Train Acc: 0.6667
 Site-MNIST                     (2) | Train Loss: 1.5745 | Train Acc: 0.6667
 Site-MNIST                     (2) | Train Loss: 1.6454 | Train Acc: 0.7632
 Site-MNIST                     (2) | Train Loss: 1.5632 | Train Acc: 0.6857
 Site-MNIST                     (2) | Train Loss: 1.6032 | Train Acc: 0.7302
 Site-MNIST                     (2) | Train Loss: 1.6067 | Train Acc: 0.6784
 Site-MNIST                     (2) | Train Loss: 1.6766 | Train Acc: 0.6235
 Site-MNIST                     (2) | Train Loss: 1.6493 | Train Acc: 0.6644
 Site-MNIST                     (2) | Train Loss: 1.6265 | Train Acc: 0.6860
 Site-USPS                      (0) | Train Loss: 1.7111 | Train Acc: 0.5500
 Site-USPS                      (0) | Train Loss: 1.6562 | Train Acc: 0.5556
 Site-USPS                      (0) | Train Loss: 1.8253 | Train Acc: 0.5736
 Site-USPS                      (0) | Train Loss: 1.7285 | Train Acc: 0.5536
 Site-USPS                      (0) | Train Loss: 1.7470 | Train Acc: 0.5690
 Site-USPS                      (0) | Train Loss: 1.7449 | Train Acc: 0.5463
 Site-SynthDigits               (3) | Train Loss: 2.1621 | Train Acc: 0.2914
 Site-SynthDigits               (3) | Train Loss: 2.1584 | Train Acc: 0.2308
 Site-SynthDigits               (3) | Train Loss: 2.1377 | Train Acc: 0.2587
 Site-MNIST_M                   (1) | Train Loss: 2.2426 | Train Acc: 0.1934
 Site-MNIST_M                   (1) | Train Loss: 2.1697 | Train Acc: 0.2141
 Site-SVHN                      (4) | Train Loss: 2.2692 | Train Acc: 0.1631
Average Train Accuracy: 0.5166
 Site-MNIST                     (2) | Val  Loss: 2.0150 | Val  Acc: 0.0000
 Site-MNIST                     (2) | Val  Loss: 1.4954 | Val  Acc: 0.6667
 Site-MNIST                     (2) | Val  Loss: 1.4747 | Val  Acc: 0.6000
 Site-MNIST                     (2) | Val  Loss: 1.6396 | Val  Acc: 0.5556
 Site-MNIST                     (2) | Val  Loss: 1.6631 | Val  Acc: 0.5882
 Site-MNIST                     (2) | Val  Loss: 1.7017 | Val  Acc: 0.6452
 Site-MNIST                     (2) | Val  Loss: 1.6223 | Val  Acc: 0.6964
 Site-MNIST                     (2) | Val  Loss: 1.6110 | Val  Acc: 0.7255
 Site-MNIST                     (2) | Val  Loss: 1.6629 | Val  Acc: 0.6503
 Site-MNIST                     (2) | Val  Loss: 1.6314 | Val  Acc: 0.6435
 Site-USPS                      (0) | Val  Loss: 1.7363 | Val  Acc: 0.4000
 Site-USPS                      (0) | Val  Loss: 1.8335 | Val  Acc: 0.3889
 Site-USPS                      (0) | Val  Loss: 1.8047 | Val  Acc: 0.5000
 Site-USPS                      (0) | Val  Loss: 1.7916 | Val  Acc: 0.4828
 Site-USPS                      (0) | Val  Loss: 1.7383 | Val  Acc: 0.5810
 Site-USPS                      (0) | Val  Loss: 1.6739 | Val  Acc: 0.6085
 Site-SynthDigits               (3) | Val  Loss: 2.1917 | Val  Acc: 0.1622
 Site-SynthDigits               (3) | Val  Loss: 2.2467 | Val  Acc: 0.2647
 Site-SynthDigits               (3) | Val  Loss: 2.1293 | Val  Acc: 0.2869
 Site-MNIST_M                   (1) | Val  Loss: 2.1776 | Val  Acc: 0.2000
 Site-MNIST_M                   (1) | Val  Loss: 2.2288 | Val  Acc: 0.1852
 Site-SVHN                      (4) | Val  Loss: 2.2313 | Val  Acc: 0.2000
Average Valid Accuracy: 0.4560
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.0000
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6667
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6000
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5556
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5882
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6452
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6964
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.7255
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6503
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6435
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.4000
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.3889
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.5000
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.4828
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.5810
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.6085
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.1622
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2647
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2869
 Best site-MNIST_M                  (1)  | Epoch:0 | Val Acc: 0.2000
 Best site-MNIST_M                  (1)  | Epoch:0 | Val Acc: 0.1852
 Best site-SVHN                     (4)  | Epoch:0 | Val Acc: 0.2000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 3, 6, 3, 9, ]
cnt=[3, 9, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (0) | Train Loss: 1.2397 | Train Acc: 0.6667
 Site-MNIST                     (4) | Train Loss: 1.2668 | Train Acc: 0.7500
 Site-MNIST                     (4) | Train Loss: 1.0730 | Train Acc: 0.8095
 Site-MNIST                     (4) | Train Loss: 1.1017 | Train Acc: 0.8947
 Site-MNIST                     (4) | Train Loss: 1.2777 | Train Acc: 0.8000
 Site-MNIST                     (4) | Train Loss: 1.1132 | Train Acc: 0.8254
 Site-MNIST                     (4) | Train Loss: 1.1036 | Train Acc: 0.8546
 Site-MNIST                     (4) | Train Loss: 1.2302 | Train Acc: 0.7506
 Site-MNIST                     (4) | Train Loss: 1.1631 | Train Acc: 0.7840
 Site-MNIST                     (4) | Train Loss: 1.1300 | Train Acc: 0.7985
 Site-USPS                      (2) | Train Loss: 1.2389 | Train Acc: 0.7250
 Site-USPS                      (2) | Train Loss: 1.2145 | Train Acc: 0.7361
 Site-USPS                      (2) | Train Loss: 1.4597 | Train Acc: 0.7132
 Site-USPS                      (2) | Train Loss: 1.2626 | Train Acc: 0.7339
 Site-USPS                      (2) | Train Loss: 1.2464 | Train Acc: 0.7500
 Site-USPS                      (2) | Train Loss: 1.2627 | Train Acc: 0.7394
 Site-SynthDigits               (1) | Train Loss: 2.0081 | Train Acc: 0.2980
 Site-SynthDigits               (1) | Train Loss: 1.9825 | Train Acc: 0.2711
 Site-SynthDigits               (1) | Train Loss: 1.9790 | Train Acc: 0.3035
 Site-MNIST_M                   (3) | Train Loss: 2.0603 | Train Acc: 0.2486
 Site-MNIST_M                   (3) | Train Loss: 2.0524 | Train Acc: 0.3180
 Site-SVHN                      (3) | Train Loss: 2.2027 | Train Acc: 0.1809
Average Train Accuracy: 0.6342
 Site-MNIST                     (0) | Val  Loss: 1.3195 | Val  Acc: 1.0000
 Site-MNIST                     (4) | Val  Loss: 0.9260 | Val  Acc: 1.0000
 Site-MNIST                     (4) | Val  Loss: 0.9599 | Val  Acc: 0.8000
 Site-MNIST                     (4) | Val  Loss: 1.2502 | Val  Acc: 0.5556
 Site-MNIST                     (4) | Val  Loss: 1.2453 | Val  Acc: 0.7059
 Site-MNIST                     (4) | Val  Loss: 1.2652 | Val  Acc: 0.7419
 Site-MNIST                     (4) | Val  Loss: 1.1312 | Val  Acc: 0.8571
 Site-MNIST                     (4) | Val  Loss: 1.1291 | Val  Acc: 0.8137
 Site-MNIST                     (4) | Val  Loss: 1.2036 | Val  Acc: 0.7760
 Site-MNIST                     (4) | Val  Loss: 1.1669 | Val  Acc: 0.7976
 Site-USPS                      (2) | Val  Loss: 1.1707 | Val  Acc: 0.8000
 Site-USPS                      (2) | Val  Loss: 1.4302 | Val  Acc: 0.6667
 Site-USPS                      (2) | Val  Loss: 1.4112 | Val  Acc: 0.5938
 Site-USPS                      (2) | Val  Loss: 1.3757 | Val  Acc: 0.6207
 Site-USPS                      (2) | Val  Loss: 1.2787 | Val  Acc: 0.7238
 Site-USPS                      (2) | Val  Loss: 1.1965 | Val  Acc: 0.7672
 Site-SynthDigits               (1) | Val  Loss: 2.0897 | Val  Acc: 0.1892
 Site-SynthDigits               (1) | Val  Loss: 2.1890 | Val  Acc: 0.2794
 Site-SynthDigits               (1) | Val  Loss: 1.9876 | Val  Acc: 0.3115
 Site-MNIST_M                   (3) | Val  Loss: 2.0664 | Val  Acc: 0.2667
 Site-MNIST_M                   (3) | Val  Loss: 2.0773 | Val  Acc: 0.2469
 Site-SVHN                      (3) | Val  Loss: 2.0686 | Val  Acc: 0.2286
Average Valid Accuracy: 0.6246
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                    (4)  | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                    (4)  | Epoch:1 | Val Acc: 0.8000
 Best site-MNIST                    (4)  | Epoch:1 | Val Acc: 0.5556
 Best site-MNIST                    (4)  | Epoch:1 | Val Acc: 0.7059
 Best site-MNIST                    (4)  | Epoch:1 | Val Acc: 0.7419
 Best site-MNIST                    (4)  | Epoch:1 | Val Acc: 0.8571
 Best site-MNIST                    (4)  | Epoch:1 | Val Acc: 0.8137
 Best site-MNIST                    (4)  | Epoch:1 | Val Acc: 0.7760
 Best site-MNIST                    (4)  | Epoch:1 | Val Acc: 0.7976
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.8000
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.6667
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.5938
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.6207
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.7238
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.7672
 Best site-SynthDigits              (1)  | Epoch:1 | Val Acc: 0.1892
 Best site-SynthDigits              (1)  | Epoch:1 | Val Acc: 0.2794
 Best site-SynthDigits              (1)  | Epoch:1 | Val Acc: 0.3115
 Best site-MNIST_M                  (3)  | Epoch:1 | Val Acc: 0.2667
 Best site-MNIST_M                  (3)  | Epoch:1 | Val Acc: 0.2469
 Best site-SVHN                     (3)  | Epoch:1 | Val Acc: 0.2286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 2 ============
cnt=[6, 1, 10, 3, 2, ]
cnt=[3, 6, 9, 3, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (2) | Train Loss: 0.9308 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 1.1255 | Train Acc: 0.6667
 Site-MNIST                     (2) | Train Loss: 0.9484 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 0.9588 | Train Acc: 0.8421
 Site-MNIST                     (2) | Train Loss: 1.1786 | Train Acc: 0.7857
 Site-MNIST                     (2) | Train Loss: 0.9925 | Train Acc: 0.8095
 Site-MNIST                     (2) | Train Loss: 0.9467 | Train Acc: 0.8194
 Site-MNIST                     (2) | Train Loss: 1.0953 | Train Acc: 0.7579
 Site-MNIST                     (2) | Train Loss: 1.0346 | Train Acc: 0.7812
 Site-MNIST                     (2) | Train Loss: 0.9912 | Train Acc: 0.7857
 Site-USPS                      (0) | Train Loss: 0.9122 | Train Acc: 0.8000
 Site-USPS                      (0) | Train Loss: 0.8606 | Train Acc: 0.8056
 Site-USPS                      (0) | Train Loss: 0.6956 | Train Acc: 0.7442
 Site-USPS                      (0) | Train Loss: 1.0276 | Train Acc: 0.7682
 Site-USPS                      (0) | Train Loss: 1.0138 | Train Acc: 0.7905
 Site-USPS                      (0) | Train Loss: 1.0038 | Train Acc: 0.7791
 Site-SynthDigits               (3) | Train Loss: 1.8527 | Train Acc: 0.3709
 Site-SynthDigits               (3) | Train Loss: 1.8176 | Train Acc: 0.3919
 Site-SynthDigits               (3) | Train Loss: 1.7448 | Train Acc: 0.4053
 Site-MNIST_M                   (4) | Train Loss: 1.9460 | Train Acc: 0.2983
 Site-MNIST_M                   (4) | Train Loss: 1.8888 | Train Acc: 0.3578
 Site-SVHN                      (1) | Train Loss: 2.0877 | Train Acc: 0.2092
Average Train Accuracy: 0.6664
 Site-MNIST                     (2) | Val  Loss: 0.9143 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.6743 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.7690 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 1.0438 | Val  Acc: 0.6667
 Site-MNIST                     (2) | Val  Loss: 1.0882 | Val  Acc: 0.7647
 Site-MNIST                     (2) | Val  Loss: 1.1394 | Val  Acc: 0.7742
 Site-MNIST                     (2) | Val  Loss: 1.0214 | Val  Acc: 0.8214
 Site-MNIST                     (2) | Val  Loss: 1.0061 | Val  Acc: 0.7941
 Site-MNIST                     (2) | Val  Loss: 1.0687 | Val  Acc: 0.7596
 Site-MNIST                     (2) | Val  Loss: 1.0244 | Val  Acc: 0.7855
 Site-USPS                      (0) | Val  Loss: 0.8984 | Val  Acc: 0.8000
 Site-USPS                      (0) | Val  Loss: 1.1820 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 1.1463 | Val  Acc: 0.6562
 Site-USPS                      (0) | Val  Loss: 1.1547 | Val  Acc: 0.6724
 Site-USPS                      (0) | Val  Loss: 1.0375 | Val  Acc: 0.7714
 Site-USPS                      (0) | Val  Loss: 0.9532 | Val  Acc: 0.7937
 Site-SynthDigits               (3) | Val  Loss: 1.8930 | Val  Acc: 0.4054
 Site-SynthDigits               (3) | Val  Loss: 1.9455 | Val  Acc: 0.4265
 Site-SynthDigits               (3) | Val  Loss: 1.7961 | Val  Acc: 0.3934
 Site-MNIST_M                   (4) | Val  Loss: 1.9685 | Val  Acc: 0.3333
 Site-MNIST_M                   (4) | Val  Loss: 1.9565 | Val  Acc: 0.2963
 Site-SVHN                      (1) | Val  Loss: 1.9728 | Val  Acc: 0.2429
Average Valid Accuracy: 0.6673
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.6667
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.7647
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.7742
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.8214
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.7941
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.7596
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.7855
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.8000
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7222
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.6562
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.6724
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7714
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7937
 Best site-SynthDigits              (3)  | Epoch:2 | Val Acc: 0.4054
 Best site-SynthDigits              (3)  | Epoch:2 | Val Acc: 0.4265
 Best site-SynthDigits              (3)  | Epoch:2 | Val Acc: 0.3934
 Best site-MNIST_M                  (4)  | Epoch:2 | Val Acc: 0.3333
 Best site-MNIST_M                  (4)  | Epoch:2 | Val Acc: 0.2963
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.2429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 3 ============
cnt=[6, 3, 2, 10, 1, ]
cnt=[1, 6, 3, 3, 9, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (3) | Train Loss: 0.8049 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 1.0056 | Train Acc: 0.7500
 Site-MNIST                     (3) | Train Loss: 0.7692 | Train Acc: 0.8571
 Site-MNIST                     (3) | Train Loss: 0.8136 | Train Acc: 0.8421
 Site-MNIST                     (3) | Train Loss: 0.8405 | Train Acc: 0.8286
 Site-MNIST                     (3) | Train Loss: 0.8454 | Train Acc: 0.8254
 Site-MNIST                     (3) | Train Loss: 0.8113 | Train Acc: 0.8678
 Site-MNIST                     (3) | Train Loss: 0.9229 | Train Acc: 0.8020
 Site-MNIST                     (3) | Train Loss: 0.8789 | Train Acc: 0.8098
 Site-MNIST                     (3) | Train Loss: 0.8420 | Train Acc: 0.8143
 Site-USPS                      (0) | Train Loss: 0.7717 | Train Acc: 0.8250
 Site-USPS                      (0) | Train Loss: 0.8209 | Train Acc: 0.8056
 Site-USPS                      (0) | Train Loss: 0.7995 | Train Acc: 0.8062
 Site-USPS                      (0) | Train Loss: 0.8714 | Train Acc: 0.8069
 Site-USPS                      (0) | Train Loss: 0.8635 | Train Acc: 0.8119
 Site-USPS                      (0) | Train Loss: 0.8564 | Train Acc: 0.8042
 Site-SynthDigits               (1) | Train Loss: 1.7295 | Train Acc: 0.4371
 Site-SynthDigits               (1) | Train Loss: 1.6354 | Train Acc: 0.4615
 Site-SynthDigits               (1) | Train Loss: 1.5946 | Train Acc: 0.4705
 Site-MNIST_M                   (2) | Train Loss: 1.8739 | Train Acc: 0.3149
 Site-MNIST_M                   (2) | Train Loss: 1.8003 | Train Acc: 0.3884
 Site-SVHN                      (4) | Train Loss: 2.0334 | Train Acc: 0.2411
Average Train Accuracy: 0.7002
 Site-MNIST                     (3) | Val  Loss: 0.6917 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.5216 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.6642 | Val  Acc: 0.8000
 Site-MNIST                     (3) | Val  Loss: 0.9395 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.9492 | Val  Acc: 0.8235
 Site-MNIST                     (3) | Val  Loss: 0.9692 | Val  Acc: 0.8387
 Site-MNIST                     (3) | Val  Loss: 0.8490 | Val  Acc: 0.8571
 Site-MNIST                     (3) | Val  Loss: 0.8452 | Val  Acc: 0.8333
 Site-MNIST                     (3) | Val  Loss: 0.9209 | Val  Acc: 0.8142
 Site-MNIST                     (3) | Val  Loss: 0.8778 | Val  Acc: 0.8308
 Site-USPS                      (0) | Val  Loss: 0.6897 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 1.0380 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 1.0406 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 1.0275 | Val  Acc: 0.7241
 Site-USPS                      (0) | Val  Loss: 0.8957 | Val  Acc: 0.8095
 Site-USPS                      (0) | Val  Loss: 0.8140 | Val  Acc: 0.8201
 Site-SynthDigits               (1) | Val  Loss: 1.7550 | Val  Acc: 0.5405
 Site-SynthDigits               (1) | Val  Loss: 1.8086 | Val  Acc: 0.5294
 Site-SynthDigits               (1) | Val  Loss: 1.6438 | Val  Acc: 0.4754
 Site-MNIST_M                   (2) | Val  Loss: 1.9261 | Val  Acc: 0.3111
 Site-MNIST_M                   (2) | Val  Loss: 1.9012 | Val  Acc: 0.3580
 Site-SVHN                      (4) | Val  Loss: 1.9346 | Val  Acc: 0.3000
Average Valid Accuracy: 0.7200
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8000
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8235
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8387
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8571
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8333
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8142
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8308
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.7188
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.7241
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8095
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8201
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.5405
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.5294
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.4754
 Best site-MNIST_M                  (2)  | Epoch:3 | Val Acc: 0.3111
 Best site-MNIST_M                  (2)  | Epoch:3 | Val Acc: 0.3580
 Best site-SVHN                     (4)  | Epoch:3 | Val Acc: 0.3000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 1, 3, 14, 2, ]
cnt=[6, 10, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (3) | Train Loss: 0.7652 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.8822 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.6614 | Train Acc: 0.8095
 Site-MNIST                     (3) | Train Loss: 0.7061 | Train Acc: 0.8684
 Site-MNIST                     (3) | Train Loss: 0.7185 | Train Acc: 0.8286
 Site-MNIST                     (3) | Train Loss: 0.7522 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.7039 | Train Acc: 0.8767
 Site-MNIST                     (3) | Train Loss: 0.8251 | Train Acc: 0.8117
 Site-MNIST                     (3) | Train Loss: 0.7809 | Train Acc: 0.8383
 Site-MNIST                     (3) | Train Loss: 0.7404 | Train Acc: 0.8468
 Site-USPS                      (0) | Train Loss: 0.6783 | Train Acc: 0.8250
 Site-USPS                      (3) | Train Loss: 0.6528 | Train Acc: 0.8472
 Site-USPS                      (3) | Train Loss: 0.5206 | Train Acc: 0.8372
 Site-USPS                      (3) | Train Loss: 0.7982 | Train Acc: 0.8240
 Site-USPS                      (3) | Train Loss: 0.7659 | Train Acc: 0.8357
 Site-USPS                      (3) | Train Loss: 0.7685 | Train Acc: 0.8333
 Site-SynthDigits               (2) | Train Loss: 1.6071 | Train Acc: 0.4901
 Site-SynthDigits               (2) | Train Loss: 1.5193 | Train Acc: 0.4872
 Site-SynthDigits               (2) | Train Loss: 1.4818 | Train Acc: 0.5071
 Site-MNIST_M                   (4) | Train Loss: 1.7871 | Train Acc: 0.3757
 Site-MNIST_M                   (4) | Train Loss: 1.7400 | Train Acc: 0.4404
 Site-SVHN                      (1) | Train Loss: 1.9731 | Train Acc: 0.2660
Average Train Accuracy: 0.7250
 Site-MNIST                     (3) | Val  Loss: 0.4880 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.4179 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.6004 | Val  Acc: 0.8000
 Site-MNIST                     (3) | Val  Loss: 0.8753 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.8546 | Val  Acc: 0.8235
 Site-MNIST                     (3) | Val  Loss: 0.8481 | Val  Acc: 0.8710
 Site-MNIST                     (3) | Val  Loss: 0.7282 | Val  Acc: 0.8750
 Site-MNIST                     (3) | Val  Loss: 0.7322 | Val  Acc: 0.8431
 Site-MNIST                     (3) | Val  Loss: 0.8174 | Val  Acc: 0.8087
 Site-MNIST                     (3) | Val  Loss: 0.7778 | Val  Acc: 0.8399
 Site-USPS                      (0) | Val  Loss: 0.5706 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.9553 | Val  Acc: 0.7778
 Site-USPS                      (3) | Val  Loss: 0.9651 | Val  Acc: 0.7188
 Site-USPS                      (3) | Val  Loss: 0.9320 | Val  Acc: 0.7241
 Site-USPS                      (3) | Val  Loss: 0.8039 | Val  Acc: 0.8190
 Site-USPS                      (3) | Val  Loss: 0.7342 | Val  Acc: 0.8624
 Site-SynthDigits               (2) | Val  Loss: 1.6270 | Val  Acc: 0.5405
 Site-SynthDigits               (2) | Val  Loss: 1.6066 | Val  Acc: 0.5588
 Site-SynthDigits               (2) | Val  Loss: 1.5265 | Val  Acc: 0.5246
 Site-MNIST_M                   (4) | Val  Loss: 1.8583 | Val  Acc: 0.3556
 Site-MNIST_M                   (4) | Val  Loss: 1.8205 | Val  Acc: 0.4444
 Site-SVHN                      (1) | Val  Loss: 1.8955 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7341
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8000
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8235
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8710
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8750
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8431
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8087
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8399
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.7778
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.7188
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.7241
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.8190
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.8624
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.5405
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.5588
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.5246
 Best site-MNIST_M                  (4)  | Epoch:4 | Val Acc: 0.3556
 Best site-MNIST_M                  (4)  | Epoch:4 | Val Acc: 0.4444
 Best site-SVHN                     (1)  | Epoch:4 | Val Acc: 0.2857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 5 ============
cnt=[10, 2, 3, 6, 1, ]
cnt=[10, 6, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (0) | Train Loss: 0.7233 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.8332 | Train Acc: 0.7500
 Site-MNIST                     (0) | Train Loss: 0.5895 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.6203 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.9195 | Train Acc: 0.8143
 Site-MNIST                     (0) | Train Loss: 0.6870 | Train Acc: 0.8413
 Site-MNIST                     (0) | Train Loss: 0.6235 | Train Acc: 0.8811
 Site-MNIST                     (0) | Train Loss: 0.7455 | Train Acc: 0.8362
 Site-MNIST                     (0) | Train Loss: 0.6999 | Train Acc: 0.8383
 Site-MNIST                     (0) | Train Loss: 0.6715 | Train Acc: 0.8566
 Site-USPS                      (3) | Train Loss: 0.6056 | Train Acc: 0.8250
 Site-USPS                      (3) | Train Loss: 0.5909 | Train Acc: 0.8750
 Site-USPS                      (3) | Train Loss: 0.4790 | Train Acc: 0.8295
 Site-USPS                      (3) | Train Loss: 0.7385 | Train Acc: 0.8283
 Site-USPS                      (3) | Train Loss: 0.7097 | Train Acc: 0.8476
 Site-USPS                      (3) | Train Loss: 0.7053 | Train Acc: 0.8386
 Site-SynthDigits               (2) | Train Loss: 1.5232 | Train Acc: 0.5298
 Site-SynthDigits               (2) | Train Loss: 1.4632 | Train Acc: 0.5531
 Site-SynthDigits               (2) | Train Loss: 1.3768 | Train Acc: 0.5703
 Site-MNIST_M                   (1) | Train Loss: 1.6968 | Train Acc: 0.4033
 Site-MNIST_M                   (1) | Train Loss: 1.6658 | Train Acc: 0.4709
 Site-SVHN                      (4) | Train Loss: 1.9158 | Train Acc: 0.3121
Average Train Accuracy: 0.7437
 Site-MNIST                     (0) | Val  Loss: 0.3682 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.3078 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.5229 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.7646 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.7555 | Val  Acc: 0.8235
 Site-MNIST                     (0) | Val  Loss: 0.7703 | Val  Acc: 0.8710
 Site-MNIST                     (0) | Val  Loss: 0.6648 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.6678 | Val  Acc: 0.8627
 Site-MNIST                     (0) | Val  Loss: 0.7439 | Val  Acc: 0.8361
 Site-MNIST                     (0) | Val  Loss: 0.7069 | Val  Acc: 0.8459
 Site-USPS                      (3) | Val  Loss: 0.5239 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.9070 | Val  Acc: 0.7778
 Site-USPS                      (3) | Val  Loss: 0.9200 | Val  Acc: 0.7188
 Site-USPS                      (3) | Val  Loss: 0.8841 | Val  Acc: 0.7241
 Site-USPS                      (3) | Val  Loss: 0.7516 | Val  Acc: 0.8190
 Site-USPS                      (3) | Val  Loss: 0.6783 | Val  Acc: 0.8624
 Site-SynthDigits               (2) | Val  Loss: 1.5109 | Val  Acc: 0.6216
 Site-SynthDigits               (2) | Val  Loss: 1.4709 | Val  Acc: 0.6176
 Site-SynthDigits               (2) | Val  Loss: 1.4097 | Val  Acc: 0.5738
 Site-MNIST_M                   (1) | Val  Loss: 1.7858 | Val  Acc: 0.4000
 Site-MNIST_M                   (1) | Val  Loss: 1.7356 | Val  Acc: 0.4938
 Site-SVHN                      (4) | Val  Loss: 1.8500 | Val  Acc: 0.3143
Average Valid Accuracy: 0.7523
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8235
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8710
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8627
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8361
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8459
 Best site-USPS                     (3)  | Epoch:5 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:5 | Val Acc: 0.7778
 Best site-USPS                     (3)  | Epoch:5 | Val Acc: 0.7188
 Best site-USPS                     (3)  | Epoch:5 | Val Acc: 0.7241
 Best site-USPS                     (3)  | Epoch:5 | Val Acc: 0.8190
 Best site-USPS                     (3)  | Epoch:5 | Val Acc: 0.8624
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.6216
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.6176
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.5738
 Best site-MNIST_M                  (1)  | Epoch:5 | Val Acc: 0.4000
 Best site-MNIST_M                  (1)  | Epoch:5 | Val Acc: 0.4938
 Best site-SVHN                     (4)  | Epoch:5 | Val Acc: 0.3143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 6 ============
cnt=[10, 3, 2, 6, 1, ]
cnt=[9, 6, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (0) | Train Loss: 0.6631 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.7815 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.5431 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.5594 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 1.0191 | Train Acc: 0.8429
 Site-MNIST                     (0) | Train Loss: 0.6284 | Train Acc: 0.8651
 Site-MNIST                     (0) | Train Loss: 0.5603 | Train Acc: 0.8943
 Site-MNIST                     (0) | Train Loss: 0.6782 | Train Acc: 0.8435
 Site-MNIST                     (0) | Train Loss: 0.6467 | Train Acc: 0.8546
 Site-MNIST                     (0) | Train Loss: 0.6157 | Train Acc: 0.8709
 Site-USPS                      (3) | Train Loss: 0.5728 | Train Acc: 0.8000
 Site-USPS                      (3) | Train Loss: 0.7979 | Train Acc: 0.9167
 Site-USPS                      (3) | Train Loss: 1.0533 | Train Acc: 0.8295
 Site-USPS                      (3) | Train Loss: 0.7038 | Train Acc: 0.8369
 Site-USPS                      (3) | Train Loss: 0.6490 | Train Acc: 0.8429
 Site-USPS                      (3) | Train Loss: 0.6606 | Train Acc: 0.8571
 Site-SynthDigits               (1) | Train Loss: 1.4340 | Train Acc: 0.5629
 Site-SynthDigits               (1) | Train Loss: 1.3889 | Train Acc: 0.5751
 Site-SynthDigits               (1) | Train Loss: 1.2844 | Train Acc: 0.6171
 Site-MNIST_M                   (2) | Train Loss: 1.6460 | Train Acc: 0.4309
 Site-MNIST_M                   (2) | Train Loss: 1.5219 | Train Acc: 0.5321
 Site-SVHN                      (4) | Train Loss: 1.8393 | Train Acc: 0.3652
Average Train Accuracy: 0.7650
 Site-MNIST                     (0) | Val  Loss: 0.3249 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.2693 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.5029 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.7338 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.7013 | Val  Acc: 0.8235
 Site-MNIST                     (0) | Val  Loss: 0.6888 | Val  Acc: 0.8710
 Site-MNIST                     (0) | Val  Loss: 0.5960 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.6005 | Val  Acc: 0.8725
 Site-MNIST                     (0) | Val  Loss: 0.6792 | Val  Acc: 0.8415
 Site-MNIST                     (0) | Val  Loss: 0.6448 | Val  Acc: 0.8520
 Site-USPS                      (3) | Val  Loss: 0.4750 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.8772 | Val  Acc: 0.7778
 Site-USPS                      (3) | Val  Loss: 0.9020 | Val  Acc: 0.6875
 Site-USPS                      (3) | Val  Loss: 0.8507 | Val  Acc: 0.7586
 Site-USPS                      (3) | Val  Loss: 0.7190 | Val  Acc: 0.8381
 Site-USPS                      (3) | Val  Loss: 0.6399 | Val  Acc: 0.8783
 Site-SynthDigits               (1) | Val  Loss: 1.4090 | Val  Acc: 0.6757
 Site-SynthDigits               (1) | Val  Loss: 1.3576 | Val  Acc: 0.6618
 Site-SynthDigits               (1) | Val  Loss: 1.3247 | Val  Acc: 0.5984
 Site-MNIST_M                   (2) | Val  Loss: 1.7330 | Val  Acc: 0.4222
 Site-MNIST_M                   (2) | Val  Loss: 1.6654 | Val  Acc: 0.5185
 Site-SVHN                      (4) | Val  Loss: 1.7836 | Val  Acc: 0.3571
Average Valid Accuracy: 0.7655
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8235
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8710
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8725
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8415
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8520
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.7778
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.6875
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.7586
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.8381
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.8783
 Best site-SynthDigits              (1)  | Epoch:6 | Val Acc: 0.6757
 Best site-SynthDigits              (1)  | Epoch:6 | Val Acc: 0.6618
 Best site-SynthDigits              (1)  | Epoch:6 | Val Acc: 0.5984
 Best site-MNIST_M                  (2)  | Epoch:6 | Val Acc: 0.4222
 Best site-MNIST_M                  (2)  | Epoch:6 | Val Acc: 0.5185
 Best site-SVHN                     (4)  | Epoch:6 | Val Acc: 0.3571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 7 ============
cnt=[3, 6, 2, 10, 1, ]
cnt=[4, 9, 6, 1, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (3) | Train Loss: 0.6667 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.7387 | Train Acc: 0.9167
 Site-MNIST                     (3) | Train Loss: 0.5065 | Train Acc: 0.8571
 Site-MNIST                     (3) | Train Loss: 0.5109 | Train Acc: 0.8947
 Site-MNIST                     (3) | Train Loss: 0.5177 | Train Acc: 0.8429
 Site-MNIST                     (3) | Train Loss: 0.5871 | Train Acc: 0.8492
 Site-MNIST                     (3) | Train Loss: 0.5153 | Train Acc: 0.8899
 Site-MNIST                     (3) | Train Loss: 0.6260 | Train Acc: 0.8680
 Site-MNIST                     (3) | Train Loss: 0.6026 | Train Acc: 0.8682
 Site-MNIST                     (3) | Train Loss: 0.5753 | Train Acc: 0.8785
 Site-USPS                      (1) | Train Loss: 0.5686 | Train Acc: 0.8000
 Site-USPS                      (1) | Train Loss: 0.5776 | Train Acc: 0.9167
 Site-USPS                      (1) | Train Loss: 0.4331 | Train Acc: 0.8527
 Site-USPS                      (1) | Train Loss: 0.6735 | Train Acc: 0.8326
 Site-USPS                      (1) | Train Loss: 0.6200 | Train Acc: 0.8524
 Site-USPS                      (1) | Train Loss: 0.6259 | Train Acc: 0.8571
 Site-SynthDigits               (0) | Train Loss: 1.3283 | Train Acc: 0.5695
 Site-SynthDigits               (0) | Train Loss: 1.2952 | Train Acc: 0.6154
 Site-SynthDigits               (0) | Train Loss: 1.1980 | Train Acc: 0.6436
 Site-MNIST_M                   (2) | Train Loss: 1.5854 | Train Acc: 0.4530
 Site-MNIST_M                   (2) | Train Loss: 1.5170 | Train Acc: 0.5413
 Site-SVHN                      (4) | Train Loss: 1.7893 | Train Acc: 0.3759
Average Train Accuracy: 0.7731
 Site-MNIST                     (3) | Val  Loss: 0.2470 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.2404 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.4986 | Val  Acc: 0.8000
 Site-MNIST                     (3) | Val  Loss: 0.7269 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.6790 | Val  Acc: 0.8235
 Site-MNIST                     (3) | Val  Loss: 0.6478 | Val  Acc: 0.8710
 Site-MNIST                     (3) | Val  Loss: 0.5544 | Val  Acc: 0.9286
 Site-MNIST                     (3) | Val  Loss: 0.5605 | Val  Acc: 0.8922
 Site-MNIST                     (3) | Val  Loss: 0.6360 | Val  Acc: 0.8689
 Site-MNIST                     (3) | Val  Loss: 0.6056 | Val  Acc: 0.8640
 Site-USPS                      (1) | Val  Loss: 0.4271 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.8481 | Val  Acc: 0.7222
 Site-USPS                      (1) | Val  Loss: 0.8905 | Val  Acc: 0.6562
 Site-USPS                      (1) | Val  Loss: 0.8144 | Val  Acc: 0.7414
 Site-USPS                      (1) | Val  Loss: 0.6813 | Val  Acc: 0.8381
 Site-USPS                      (1) | Val  Loss: 0.6081 | Val  Acc: 0.8783
 Site-SynthDigits               (0) | Val  Loss: 1.3330 | Val  Acc: 0.7297
 Site-SynthDigits               (0) | Val  Loss: 1.2504 | Val  Acc: 0.7206
 Site-SynthDigits               (0) | Val  Loss: 1.2247 | Val  Acc: 0.6475
 Site-MNIST_M                   (2) | Val  Loss: 1.6777 | Val  Acc: 0.4000
 Site-MNIST_M                   (2) | Val  Loss: 1.6044 | Val  Acc: 0.5185
 Site-SVHN                      (4) | Val  Loss: 1.6952 | Val  Acc: 0.3857
Average Valid Accuracy: 0.7711
 Best site-MNIST                    (3)  | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:7 | Val Acc: 0.8000
 Best site-MNIST                    (3)  | Epoch:7 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:7 | Val Acc: 0.8235
 Best site-MNIST                    (3)  | Epoch:7 | Val Acc: 0.8710
 Best site-MNIST                    (3)  | Epoch:7 | Val Acc: 0.9286
 Best site-MNIST                    (3)  | Epoch:7 | Val Acc: 0.8922
 Best site-MNIST                    (3)  | Epoch:7 | Val Acc: 0.8689
 Best site-MNIST                    (3)  | Epoch:7 | Val Acc: 0.8640
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.7222
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.6562
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.7414
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.8381
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.8783
 Best site-SynthDigits              (0)  | Epoch:7 | Val Acc: 0.7297
 Best site-SynthDigits              (0)  | Epoch:7 | Val Acc: 0.7206
 Best site-SynthDigits              (0)  | Epoch:7 | Val Acc: 0.6475
 Best site-MNIST_M                  (2)  | Epoch:7 | Val Acc: 0.4000
 Best site-MNIST_M                  (2)  | Epoch:7 | Val Acc: 0.5185
 Best site-SVHN                     (4)  | Epoch:7 | Val Acc: 0.3857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 8 ============
cnt=[6, 1, 3, 10, 2, ]
cnt=[2, 6, 10, 3, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (3) | Train Loss: 0.6532 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.7638 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.5123 | Train Acc: 0.8571
 Site-MNIST                     (3) | Train Loss: 0.4932 | Train Acc: 0.8684
 Site-MNIST                     (3) | Train Loss: 0.4914 | Train Acc: 0.8143
 Site-MNIST                     (3) | Train Loss: 0.5890 | Train Acc: 0.8175
 Site-MNIST                     (3) | Train Loss: 0.5173 | Train Acc: 0.8899
 Site-MNIST                     (3) | Train Loss: 0.6122 | Train Acc: 0.8435
 Site-MNIST                     (3) | Train Loss: 0.5843 | Train Acc: 0.8560
 Site-MNIST                     (3) | Train Loss: 0.5631 | Train Acc: 0.8679
 Site-USPS                      (0) | Train Loss: 0.5112 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.4890 | Train Acc: 0.9167
 Site-USPS                      (0) | Train Loss: 0.4306 | Train Acc: 0.8760
 Site-USPS                      (0) | Train Loss: 0.6284 | Train Acc: 0.8455
 Site-USPS                      (0) | Train Loss: 0.5792 | Train Acc: 0.8738
 Site-USPS                      (0) | Train Loss: 0.5855 | Train Acc: 0.8730
 Site-SynthDigits               (2) | Train Loss: 1.2399 | Train Acc: 0.6490
 Site-SynthDigits               (2) | Train Loss: 1.1764 | Train Acc: 0.6484
 Site-SynthDigits               (2) | Train Loss: 1.1193 | Train Acc: 0.6904
 Site-MNIST_M                   (4) | Train Loss: 1.5191 | Train Acc: 0.4807
 Site-MNIST_M                   (4) | Train Loss: 1.4036 | Train Acc: 0.5780
 Site-SVHN                      (1) | Train Loss: 1.7190 | Train Acc: 0.4149
Average Train Accuracy: 0.7808
 Site-MNIST                     (3) | Val  Loss: 0.1889 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.2018 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.4747 | Val  Acc: 0.8000
 Site-MNIST                     (3) | Val  Loss: 0.6769 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.6514 | Val  Acc: 0.7647
 Site-MNIST                     (3) | Val  Loss: 0.6276 | Val  Acc: 0.8387
 Site-MNIST                     (3) | Val  Loss: 0.5490 | Val  Acc: 0.8750
 Site-MNIST                     (3) | Val  Loss: 0.5496 | Val  Acc: 0.8725
 Site-MNIST                     (3) | Val  Loss: 0.6237 | Val  Acc: 0.8415
 Site-MNIST                     (3) | Val  Loss: 0.5906 | Val  Acc: 0.8520
 Site-USPS                      (0) | Val  Loss: 0.3890 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.7860 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.8328 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 0.7877 | Val  Acc: 0.7931
 Site-USPS                      (0) | Val  Loss: 0.6486 | Val  Acc: 0.8476
 Site-USPS                      (0) | Val  Loss: 0.5676 | Val  Acc: 0.8783
 Site-SynthDigits               (2) | Val  Loss: 1.2383 | Val  Acc: 0.7027
 Site-SynthDigits               (2) | Val  Loss: 1.1613 | Val  Acc: 0.7794
 Site-SynthDigits               (2) | Val  Loss: 1.1269 | Val  Acc: 0.7049
 Site-MNIST_M                   (4) | Val  Loss: 1.5951 | Val  Acc: 0.4667
 Site-MNIST_M                   (4) | Val  Loss: 1.5142 | Val  Acc: 0.5802
 Site-SVHN                      (1) | Val  Loss: 1.5852 | Val  Acc: 0.4286
Average Valid Accuracy: 0.7793
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.8000
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.7647
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.8387
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.8750
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.8725
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.8415
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.8520
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.7222
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.7188
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.7931
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.8476
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.8783
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.7027
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.7794
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.7049
 Best site-MNIST_M                  (4)  | Epoch:8 | Val Acc: 0.4667
 Best site-MNIST_M                  (4)  | Epoch:8 | Val Acc: 0.5802
 Best site-SVHN                     (1)  | Epoch:8 | Val Acc: 0.4286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 9 ============
cnt=[10, 1, 3, 6, 2, ]
cnt=[10, 6, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (0) | Train Loss: 0.5885 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.6841 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4665 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.4378 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.4404 | Train Acc: 0.8143
 Site-MNIST                     (0) | Train Loss: 0.5295 | Train Acc: 0.8492
 Site-MNIST                     (0) | Train Loss: 0.4583 | Train Acc: 0.8987
 Site-MNIST                     (0) | Train Loss: 0.5596 | Train Acc: 0.8655
 Site-MNIST                     (0) | Train Loss: 0.5266 | Train Acc: 0.8723
 Site-MNIST                     (0) | Train Loss: 0.5061 | Train Acc: 0.8906
 Site-USPS                      (3) | Train Loss: 0.5100 | Train Acc: 0.8000
 Site-USPS                      (3) | Train Loss: 0.4381 | Train Acc: 0.9444
 Site-USPS                      (3) | Train Loss: 0.5881 | Train Acc: 0.8527
 Site-USPS                      (3) | Train Loss: 0.6196 | Train Acc: 0.8369
 Site-USPS                      (3) | Train Loss: 0.5593 | Train Acc: 0.8667
 Site-USPS                      (3) | Train Loss: 0.5742 | Train Acc: 0.8690
 Site-SynthDigits               (2) | Train Loss: 1.2009 | Train Acc: 0.6424
 Site-SynthDigits               (2) | Train Loss: 1.1086 | Train Acc: 0.6557
 Site-SynthDigits               (2) | Train Loss: 1.0619 | Train Acc: 0.7067
 Site-MNIST_M                   (4) | Train Loss: 1.4402 | Train Acc: 0.5470
 Site-MNIST_M                   (4) | Train Loss: 1.3721 | Train Acc: 0.6239
 Site-SVHN                      (1) | Train Loss: 1.6428 | Train Acc: 0.4149
Average Train Accuracy: 0.7907
 Site-MNIST                     (0) | Val  Loss: 0.1515 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1685 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4774 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.6676 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.6044 | Val  Acc: 0.8235
 Site-MNIST                     (0) | Val  Loss: 0.5633 | Val  Acc: 0.8710
 Site-MNIST                     (0) | Val  Loss: 0.4882 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.4954 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.5681 | Val  Acc: 0.8689
 Site-MNIST                     (0) | Val  Loss: 0.5364 | Val  Acc: 0.8671
 Site-USPS                      (3) | Val  Loss: 0.3847 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.8165 | Val  Acc: 0.7222
 Site-USPS                      (3) | Val  Loss: 0.8577 | Val  Acc: 0.6562
 Site-USPS                      (3) | Val  Loss: 0.7722 | Val  Acc: 0.7586
 Site-USPS                      (3) | Val  Loss: 0.6376 | Val  Acc: 0.8190
 Site-USPS                      (3) | Val  Loss: 0.5558 | Val  Acc: 0.8730
 Site-SynthDigits               (2) | Val  Loss: 1.1785 | Val  Acc: 0.7027
 Site-SynthDigits               (2) | Val  Loss: 1.0921 | Val  Acc: 0.7647
 Site-SynthDigits               (2) | Val  Loss: 1.0838 | Val  Acc: 0.6967
 Site-MNIST_M                   (4) | Val  Loss: 1.5178 | Val  Acc: 0.5111
 Site-MNIST_M                   (4) | Val  Loss: 1.4331 | Val  Acc: 0.6420
 Site-SVHN                      (1) | Val  Loss: 1.5153 | Val  Acc: 0.4571
Average Valid Accuracy: 0.7866
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8235
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8710
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8689
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8671
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.7222
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.6562
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.7586
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8190
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8730
 Best site-SynthDigits              (2)  | Epoch:9 | Val Acc: 0.7027
 Best site-SynthDigits              (2)  | Epoch:9 | Val Acc: 0.7647
 Best site-SynthDigits              (2)  | Epoch:9 | Val Acc: 0.6967
 Best site-MNIST_M                  (4)  | Epoch:9 | Val Acc: 0.5111
 Best site-MNIST_M                  (4)  | Epoch:9 | Val Acc: 0.6420
 Best site-SVHN                     (1)  | Epoch:9 | Val Acc: 0.4571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 10 ============
cnt=[6, 1, 3, 10, 2, ]
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (3) | Train Loss: 0.5782 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.6967 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.4663 | Train Acc: 0.8571
 Site-MNIST                     (3) | Train Loss: 0.4182 | Train Acc: 0.9211
 Site-MNIST                     (3) | Train Loss: 0.5664 | Train Acc: 0.8143
 Site-MNIST                     (3) | Train Loss: 0.5168 | Train Acc: 0.8413
 Site-MNIST                     (3) | Train Loss: 0.4241 | Train Acc: 0.9031
 Site-MNIST                     (3) | Train Loss: 0.5544 | Train Acc: 0.8729
 Site-MNIST                     (3) | Train Loss: 0.5227 | Train Acc: 0.8709
 Site-MNIST                     (3) | Train Loss: 0.4895 | Train Acc: 0.8845
 Site-USPS                      (0) | Train Loss: 0.4734 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.4147 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.4089 | Train Acc: 0.8837
 Site-USPS                      (0) | Train Loss: 0.5842 | Train Acc: 0.8455
 Site-USPS                      (0) | Train Loss: 0.5286 | Train Acc: 0.8714
 Site-USPS                      (0) | Train Loss: 0.5340 | Train Acc: 0.8730
 Site-SynthDigits               (2) | Train Loss: 1.1734 | Train Acc: 0.6623
 Site-SynthDigits               (2) | Train Loss: 1.0753 | Train Acc: 0.6703
 Site-SynthDigits               (2) | Train Loss: 1.0105 | Train Acc: 0.7169
 Site-MNIST_M                   (4) | Train Loss: 1.3936 | Train Acc: 0.5912
 Site-MNIST_M                   (4) | Train Loss: 1.2735 | Train Acc: 0.6269
 Site-SVHN                      (1) | Train Loss: 1.6097 | Train Acc: 0.4574
Average Train Accuracy: 0.8005
 Site-MNIST                     (3) | Val  Loss: 0.1215 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.1441 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.4640 | Val  Acc: 0.8000
 Site-MNIST                     (3) | Val  Loss: 0.6323 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.5780 | Val  Acc: 0.8235
 Site-MNIST                     (3) | Val  Loss: 0.5380 | Val  Acc: 0.8710
 Site-MNIST                     (3) | Val  Loss: 0.4786 | Val  Acc: 0.8929
 Site-MNIST                     (3) | Val  Loss: 0.4826 | Val  Acc: 0.8824
 Site-MNIST                     (3) | Val  Loss: 0.5506 | Val  Acc: 0.8634
 Site-MNIST                     (3) | Val  Loss: 0.5186 | Val  Acc: 0.8731
 Site-USPS                      (0) | Val  Loss: 0.3534 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.7759 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.8171 | Val  Acc: 0.6875
 Site-USPS                      (0) | Val  Loss: 0.7499 | Val  Acc: 0.7931
 Site-USPS                      (0) | Val  Loss: 0.6096 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.5221 | Val  Acc: 0.8889
 Site-SynthDigits               (2) | Val  Loss: 1.1108 | Val  Acc: 0.7297
 Site-SynthDigits               (2) | Val  Loss: 1.0247 | Val  Acc: 0.7647
 Site-SynthDigits               (2) | Val  Loss: 1.0083 | Val  Acc: 0.7377
 Site-MNIST_M                   (4) | Val  Loss: 1.4550 | Val  Acc: 0.6222
 Site-MNIST_M                   (4) | Val  Loss: 1.3633 | Val  Acc: 0.6790
 Site-SVHN                      (1) | Val  Loss: 1.4065 | Val  Acc: 0.4714
Average Valid Accuracy: 0.8004
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8000
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8235
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8710
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8929
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8824
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8634
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8731
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.7222
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.6875
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.7931
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8286
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8889
 Best site-SynthDigits              (2)  | Epoch:10 | Val Acc: 0.7297
 Best site-SynthDigits              (2)  | Epoch:10 | Val Acc: 0.7647
 Best site-SynthDigits              (2)  | Epoch:10 | Val Acc: 0.7377
 Best site-MNIST_M                  (4)  | Epoch:10 | Val Acc: 0.6222
 Best site-MNIST_M                  (4)  | Epoch:10 | Val Acc: 0.6790
 Best site-SVHN                     (1)  | Epoch:10 | Val Acc: 0.4714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 11 ============
cnt=[3, 10, 2, 6, 1, ]
cnt=[2, 10, 6, 1, 3, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (1) | Train Loss: 0.5804 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.6370 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4247 | Train Acc: 0.8571
 Site-MNIST                     (1) | Train Loss: 0.3741 | Train Acc: 0.8947
 Site-MNIST                     (1) | Train Loss: 0.7782 | Train Acc: 0.8429
 Site-MNIST                     (1) | Train Loss: 0.4618 | Train Acc: 0.8571
 Site-MNIST                     (1) | Train Loss: 0.4150 | Train Acc: 0.9163
 Site-MNIST                     (1) | Train Loss: 0.4916 | Train Acc: 0.8729
 Site-MNIST                     (1) | Train Loss: 0.4812 | Train Acc: 0.8927
 Site-MNIST                     (1) | Train Loss: 0.4498 | Train Acc: 0.8974
 Site-USPS                      (3) | Train Loss: 0.4846 | Train Acc: 0.8250
 Site-USPS                      (3) | Train Loss: 0.5179 | Train Acc: 0.9444
 Site-USPS                      (3) | Train Loss: 0.3893 | Train Acc: 0.8837
 Site-USPS                      (3) | Train Loss: 0.5681 | Train Acc: 0.8412
 Site-USPS                      (3) | Train Loss: 0.4993 | Train Acc: 0.8738
 Site-USPS                      (3) | Train Loss: 0.5279 | Train Acc: 0.8783
 Site-SynthDigits               (0) | Train Loss: 1.0713 | Train Acc: 0.6887
 Site-SynthDigits               (0) | Train Loss: 1.0023 | Train Acc: 0.7033
 Site-SynthDigits               (0) | Train Loss: 0.9470 | Train Acc: 0.7515
 Site-MNIST_M                   (2) | Train Loss: 1.3302 | Train Acc: 0.5967
 Site-MNIST_M                   (2) | Train Loss: 1.2814 | Train Acc: 0.6422
 Site-SVHN                      (4) | Train Loss: 1.5191 | Train Acc: 0.4787
Average Train Accuracy: 0.8093
 Site-MNIST                     (1) | Val  Loss: 0.1133 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1341 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4543 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.6082 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.5377 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.4940 | Val  Acc: 0.9032
 Site-MNIST                     (1) | Val  Loss: 0.4393 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.4464 | Val  Acc: 0.9020
 Site-MNIST                     (1) | Val  Loss: 0.5061 | Val  Acc: 0.8743
 Site-MNIST                     (1) | Val  Loss: 0.4806 | Val  Acc: 0.8792
 Site-USPS                      (3) | Val  Loss: 0.3575 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.7999 | Val  Acc: 0.7222
 Site-USPS                      (3) | Val  Loss: 0.8347 | Val  Acc: 0.6875
 Site-USPS                      (3) | Val  Loss: 0.7291 | Val  Acc: 0.7414
 Site-USPS                      (3) | Val  Loss: 0.5964 | Val  Acc: 0.8190
 Site-USPS                      (3) | Val  Loss: 0.5153 | Val  Acc: 0.8730
 Site-SynthDigits               (0) | Val  Loss: 1.0539 | Val  Acc: 0.7838
 Site-SynthDigits               (0) | Val  Loss: 0.9564 | Val  Acc: 0.7794
 Site-SynthDigits               (0) | Val  Loss: 0.9572 | Val  Acc: 0.7377
 Site-MNIST_M                   (2) | Val  Loss: 1.4144 | Val  Acc: 0.5778
 Site-MNIST_M                   (2) | Val  Loss: 1.3150 | Val  Acc: 0.6667
 Site-SVHN                      (4) | Val  Loss: 1.3253 | Val  Acc: 0.5286
Average Valid Accuracy: 0.8075
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.9032
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.9020
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.8743
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.8792
 Best site-USPS                     (3)  | Epoch:11 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:11 | Val Acc: 0.7222
 Best site-USPS                     (3)  | Epoch:11 | Val Acc: 0.6875
 Best site-USPS                     (3)  | Epoch:11 | Val Acc: 0.7414
 Best site-USPS                     (3)  | Epoch:11 | Val Acc: 0.8190
 Best site-USPS                     (3)  | Epoch:11 | Val Acc: 0.8730
 Best site-SynthDigits              (0)  | Epoch:11 | Val Acc: 0.7838
 Best site-SynthDigits              (0)  | Epoch:11 | Val Acc: 0.7794
 Best site-SynthDigits              (0)  | Epoch:11 | Val Acc: 0.7377
 Best site-MNIST_M                  (2)  | Epoch:11 | Val Acc: 0.5778
 Best site-MNIST_M                  (2)  | Epoch:11 | Val Acc: 0.6667
 Best site-SVHN                     (4)  | Epoch:11 | Val Acc: 0.5286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 6, 10, 3, 1, ]
cnt=[9, 6, 2, 1, 4, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (2) | Train Loss: 0.5769 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.5970 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.4088 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 0.3560 | Train Acc: 0.8947
 Site-MNIST                     (2) | Train Loss: 0.4942 | Train Acc: 0.8286
 Site-MNIST                     (2) | Train Loss: 0.4421 | Train Acc: 0.8651
 Site-MNIST                     (2) | Train Loss: 0.3675 | Train Acc: 0.9207
 Site-MNIST                     (2) | Train Loss: 0.4669 | Train Acc: 0.8778
 Site-MNIST                     (2) | Train Loss: 0.4543 | Train Acc: 0.8899
 Site-MNIST                     (2) | Train Loss: 0.4267 | Train Acc: 0.9019
 Site-USPS                      (1) | Train Loss: 0.4669 | Train Acc: 0.8500
 Site-USPS                      (1) | Train Loss: 0.4494 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.5269 | Train Acc: 0.8682
 Site-USPS                      (1) | Train Loss: 0.5595 | Train Acc: 0.8412
 Site-USPS                      (1) | Train Loss: 0.4894 | Train Acc: 0.8810
 Site-USPS                      (1) | Train Loss: 0.5003 | Train Acc: 0.8796
 Site-SynthDigits               (3) | Train Loss: 1.0369 | Train Acc: 0.7020
 Site-SynthDigits               (3) | Train Loss: 0.9373 | Train Acc: 0.7289
 Site-SynthDigits               (3) | Train Loss: 0.9002 | Train Acc: 0.7617
 Site-MNIST_M                   (0) | Train Loss: 1.2617 | Train Acc: 0.6354
 Site-MNIST_M                   (0) | Train Loss: 1.3326 | Train Acc: 0.6453
 Site-SVHN                      (4) | Train Loss: 1.4701 | Train Acc: 0.5177
Average Train Accuracy: 0.8156
 Site-MNIST                     (2) | Val  Loss: 0.0815 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1199 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.4598 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 0.6054 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.5212 | Val  Acc: 0.8824
 Site-MNIST                     (2) | Val  Loss: 0.4716 | Val  Acc: 0.9032
 Site-MNIST                     (2) | Val  Loss: 0.4201 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.4277 | Val  Acc: 0.8922
 Site-MNIST                     (2) | Val  Loss: 0.4832 | Val  Acc: 0.8743
 Site-MNIST                     (2) | Val  Loss: 0.4596 | Val  Acc: 0.8852
 Site-USPS                      (1) | Val  Loss: 0.3312 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.7630 | Val  Acc: 0.7222
 Site-USPS                      (1) | Val  Loss: 0.7930 | Val  Acc: 0.7188
 Site-USPS                      (1) | Val  Loss: 0.6956 | Val  Acc: 0.7931
 Site-USPS                      (1) | Val  Loss: 0.5726 | Val  Acc: 0.8381
 Site-USPS                      (1) | Val  Loss: 0.4923 | Val  Acc: 0.8783
 Site-SynthDigits               (3) | Val  Loss: 0.9920 | Val  Acc: 0.7838
 Site-SynthDigits               (3) | Val  Loss: 0.8864 | Val  Acc: 0.7794
 Site-SynthDigits               (3) | Val  Loss: 0.9146 | Val  Acc: 0.7459
 Site-MNIST_M                   (0) | Val  Loss: 1.3357 | Val  Acc: 0.6444
 Site-MNIST_M                   (0) | Val  Loss: 1.2335 | Val  Acc: 0.7037
 Site-SVHN                      (4) | Val  Loss: 1.2791 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8192
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.8824
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.9032
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.8922
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.8743
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.8852
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.7222
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.7188
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.7931
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.8381
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.8783
 Best site-SynthDigits              (3)  | Epoch:12 | Val Acc: 0.7838
 Best site-SynthDigits              (3)  | Epoch:12 | Val Acc: 0.7794
 Best site-SynthDigits              (3)  | Epoch:12 | Val Acc: 0.7459
 Best site-MNIST_M                  (0)  | Epoch:12 | Val Acc: 0.6444
 Best site-MNIST_M                  (0)  | Epoch:12 | Val Acc: 0.7037
 Best site-SVHN                     (4)  | Epoch:12 | Val Acc: 0.5714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 6, 10, 3, 1, ]
cnt=[6, 2, 10, 3, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (2) | Train Loss: 0.5688 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.6006 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.4023 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 0.3439 | Train Acc: 0.9211
 Site-MNIST                     (2) | Train Loss: 0.3535 | Train Acc: 0.8429
 Site-MNIST                     (2) | Train Loss: 0.4308 | Train Acc: 0.8651
 Site-MNIST                     (2) | Train Loss: 0.3694 | Train Acc: 0.9119
 Site-MNIST                     (2) | Train Loss: 0.5008 | Train Acc: 0.8802
 Site-MNIST                     (2) | Train Loss: 0.4470 | Train Acc: 0.8886
 Site-MNIST                     (2) | Train Loss: 0.4143 | Train Acc: 0.9011
 Site-USPS                      (1) | Train Loss: 0.4231 | Train Acc: 0.8750
 Site-USPS                      (1) | Train Loss: 0.3735 | Train Acc: 0.9444
 Site-USPS                      (1) | Train Loss: 0.3257 | Train Acc: 0.8682
 Site-USPS                      (1) | Train Loss: 0.5211 | Train Acc: 0.8455
 Site-USPS                      (1) | Train Loss: 0.4578 | Train Acc: 0.8762
 Site-USPS                      (1) | Train Loss: 0.4652 | Train Acc: 0.8849
 Site-SynthDigits               (3) | Train Loss: 0.9702 | Train Acc: 0.7152
 Site-SynthDigits               (3) | Train Loss: 0.9312 | Train Acc: 0.7216
 Site-SynthDigits               (3) | Train Loss: 0.8545 | Train Acc: 0.7760
 Site-MNIST_M                   (0) | Train Loss: 1.2231 | Train Acc: 0.6575
 Site-MNIST_M                   (0) | Train Loss: 1.2235 | Train Acc: 0.6636
 Site-SVHN                      (4) | Train Loss: 1.4208 | Train Acc: 0.5248
Average Train Accuracy: 0.8222
 Site-MNIST                     (2) | Val  Loss: 0.0698 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1056 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.4386 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 0.5764 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.4971 | Val  Acc: 0.8824
 Site-MNIST                     (2) | Val  Loss: 0.4500 | Val  Acc: 0.9032
 Site-MNIST                     (2) | Val  Loss: 0.4084 | Val  Acc: 0.9107
 Site-MNIST                     (2) | Val  Loss: 0.4142 | Val  Acc: 0.8824
 Site-MNIST                     (2) | Val  Loss: 0.4717 | Val  Acc: 0.8743
 Site-MNIST                     (2) | Val  Loss: 0.4456 | Val  Acc: 0.8882
 Site-USPS                      (1) | Val  Loss: 0.3057 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.7221 | Val  Acc: 0.7222
 Site-USPS                      (1) | Val  Loss: 0.7521 | Val  Acc: 0.6875
 Site-USPS                      (1) | Val  Loss: 0.6711 | Val  Acc: 0.7931
 Site-USPS                      (1) | Val  Loss: 0.5459 | Val  Acc: 0.8381
 Site-USPS                      (1) | Val  Loss: 0.4604 | Val  Acc: 0.8889
 Site-SynthDigits               (3) | Val  Loss: 0.9391 | Val  Acc: 0.7838
 Site-SynthDigits               (3) | Val  Loss: 0.8500 | Val  Acc: 0.7794
 Site-SynthDigits               (3) | Val  Loss: 0.8728 | Val  Acc: 0.7787
 Site-MNIST_M                   (0) | Val  Loss: 1.2997 | Val  Acc: 0.6444
 Site-MNIST_M                   (0) | Val  Loss: 1.1844 | Val  Acc: 0.7407
 Site-SVHN                      (4) | Val  Loss: 1.2307 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8203
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8824
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.9032
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.9107
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8824
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8743
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8882
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.7222
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.6875
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.7931
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.8381
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.8889
 Best site-SynthDigits              (3)  | Epoch:13 | Val Acc: 0.7838
 Best site-SynthDigits              (3)  | Epoch:13 | Val Acc: 0.7794
 Best site-SynthDigits              (3)  | Epoch:13 | Val Acc: 0.7787
 Best site-MNIST_M                  (0)  | Epoch:13 | Val Acc: 0.6444
 Best site-MNIST_M                  (0)  | Epoch:13 | Val Acc: 0.7407
 Best site-SVHN                     (4)  | Epoch:13 | Val Acc: 0.5714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 14 ============
cnt=[10, 3, 2, 6, 1, ]
cnt=[6, 10, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (0) | Train Loss: 0.5677 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.5826 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3902 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.3202 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.5614 | Train Acc: 0.8286
 Site-MNIST                     (0) | Train Loss: 0.4035 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.3510 | Train Acc: 0.9207
 Site-MNIST                     (0) | Train Loss: 0.4358 | Train Acc: 0.8900
 Site-MNIST                     (0) | Train Loss: 0.4216 | Train Acc: 0.8954
 Site-MNIST                     (0) | Train Loss: 0.3878 | Train Acc: 0.9026
 Site-USPS                      (3) | Train Loss: 0.4176 | Train Acc: 0.8500
 Site-USPS                      (3) | Train Loss: 0.4322 | Train Acc: 0.9444
 Site-USPS                      (3) | Train Loss: 0.3371 | Train Acc: 0.8992
 Site-USPS                      (3) | Train Loss: 0.5050 | Train Acc: 0.8541
 Site-USPS                      (3) | Train Loss: 0.4400 | Train Acc: 0.8929
 Site-USPS                      (3) | Train Loss: 0.4588 | Train Acc: 0.8902
 Site-SynthDigits               (1) | Train Loss: 1.0351 | Train Acc: 0.7152
 Site-SynthDigits               (1) | Train Loss: 0.8824 | Train Acc: 0.7509
 Site-SynthDigits               (1) | Train Loss: 0.8274 | Train Acc: 0.7943
 Site-MNIST_M                   (2) | Train Loss: 1.2001 | Train Acc: 0.6409
 Site-MNIST_M                   (2) | Train Loss: 1.2083 | Train Acc: 0.6789
 Site-SVHN                      (4) | Train Loss: 1.4081 | Train Acc: 0.5426
Average Train Accuracy: 0.8269
 Site-MNIST                     (0) | Val  Loss: 0.0602 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0955 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4550 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5827 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4822 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.4190 | Val  Acc: 0.9032
 Site-MNIST                     (0) | Val  Loss: 0.3777 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.3871 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.4456 | Val  Acc: 0.8907
 Site-MNIST                     (0) | Val  Loss: 0.4222 | Val  Acc: 0.8973
 Site-USPS                      (3) | Val  Loss: 0.2785 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.7127 | Val  Acc: 0.7222
 Site-USPS                      (3) | Val  Loss: 0.7554 | Val  Acc: 0.6875
 Site-USPS                      (3) | Val  Loss: 0.6636 | Val  Acc: 0.7931
 Site-USPS                      (3) | Val  Loss: 0.5383 | Val  Acc: 0.8286
 Site-USPS                      (3) | Val  Loss: 0.4512 | Val  Acc: 0.8783
 Site-SynthDigits               (1) | Val  Loss: 0.9012 | Val  Acc: 0.7568
 Site-SynthDigits               (1) | Val  Loss: 0.8119 | Val  Acc: 0.8088
 Site-SynthDigits               (1) | Val  Loss: 0.8439 | Val  Acc: 0.7869
 Site-MNIST_M                   (2) | Val  Loss: 1.2547 | Val  Acc: 0.6444
 Site-MNIST_M                   (2) | Val  Loss: 1.1406 | Val  Acc: 0.7037
 Site-SVHN                      (4) | Val  Loss: 1.1696 | Val  Acc: 0.5857
Average Valid Accuracy: 0.8200
============ Train epoch 15 ============
cnt=[10, 1, 6, 3, 2, ]
cnt=[1, 6, 9, 4, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (0) | Train Loss: 0.5536 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.5438 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3544 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.2916 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.6031 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.3700 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.3279 | Train Acc: 0.9251
 Site-MNIST                     (0) | Train Loss: 0.4112 | Train Acc: 0.8949
 Site-MNIST                     (0) | Train Loss: 0.3948 | Train Acc: 0.8995
 Site-MNIST                     (0) | Train Loss: 0.3634 | Train Acc: 0.9140
 Site-USPS                      (2) | Train Loss: 0.4246 | Train Acc: 0.8750
 Site-USPS                      (2) | Train Loss: 0.6311 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.3334 | Train Acc: 0.8992
 Site-USPS                      (2) | Train Loss: 0.5044 | Train Acc: 0.8455
 Site-USPS                      (2) | Train Loss: 0.4407 | Train Acc: 0.8905
 Site-USPS                      (2) | Train Loss: 0.4543 | Train Acc: 0.8902
 Site-SynthDigits               (3) | Train Loss: 0.8735 | Train Acc: 0.7285
 Site-SynthDigits               (3) | Train Loss: 0.8209 | Train Acc: 0.7546
 Site-SynthDigits               (3) | Train Loss: 0.7756 | Train Acc: 0.8045
 Site-MNIST_M                   (4) | Train Loss: 1.1383 | Train Acc: 0.6740
 Site-MNIST_M                   (4) | Train Loss: 1.0384 | Train Acc: 0.6942
 Site-SVHN                      (1) | Train Loss: 1.3565 | Train Acc: 0.5638
Average Train Accuracy: 0.8359
 Site-MNIST                     (0) | Val  Loss: 0.0521 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0824 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4444 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5566 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4543 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.4006 | Val  Acc: 0.9032
 Site-MNIST                     (0) | Val  Loss: 0.3599 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.3681 | Val  Acc: 0.9020
 Site-MNIST                     (0) | Val  Loss: 0.4176 | Val  Acc: 0.8962
 Site-MNIST                     (0) | Val  Loss: 0.3981 | Val  Acc: 0.9063
 Site-USPS                      (2) | Val  Loss: 0.2892 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.7247 | Val  Acc: 0.7222
 Site-USPS                      (2) | Val  Loss: 0.7610 | Val  Acc: 0.7188
 Site-USPS                      (2) | Val  Loss: 0.6548 | Val  Acc: 0.7931
 Site-USPS                      (2) | Val  Loss: 0.5381 | Val  Acc: 0.8286
 Site-USPS                      (2) | Val  Loss: 0.4507 | Val  Acc: 0.8730
 Site-SynthDigits               (3) | Val  Loss: 0.8657 | Val  Acc: 0.7838
 Site-SynthDigits               (3) | Val  Loss: 0.7414 | Val  Acc: 0.8235
 Site-SynthDigits               (3) | Val  Loss: 0.8091 | Val  Acc: 0.7951
 Site-MNIST_M                   (4) | Val  Loss: 1.1954 | Val  Acc: 0.6667
 Site-MNIST_M                   (4) | Val  Loss: 1.0837 | Val  Acc: 0.7284
 Site-SVHN                      (1) | Val  Loss: 1.1029 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8286
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.9032
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.9020
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.8962
 Best site-MNIST                    (0)  | Epoch:15 | Val Acc: 0.9063
 Best site-USPS                     (2)  | Epoch:15 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:15 | Val Acc: 0.7222
 Best site-USPS                     (2)  | Epoch:15 | Val Acc: 0.7188
 Best site-USPS                     (2)  | Epoch:15 | Val Acc: 0.7931
 Best site-USPS                     (2)  | Epoch:15 | Val Acc: 0.8286
 Best site-USPS                     (2)  | Epoch:15 | Val Acc: 0.8730
 Best site-SynthDigits              (3)  | Epoch:15 | Val Acc: 0.7838
 Best site-SynthDigits              (3)  | Epoch:15 | Val Acc: 0.8235
 Best site-SynthDigits              (3)  | Epoch:15 | Val Acc: 0.7951
 Best site-MNIST_M                  (4)  | Epoch:15 | Val Acc: 0.6667
 Best site-MNIST_M                  (4)  | Epoch:15 | Val Acc: 0.7284
 Best site-SVHN                     (1)  | Epoch:15 | Val Acc: 0.6000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 16 ============
cnt=[10, 3, 6, 2, 1, ]
cnt=[10, 6, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (0) | Train Loss: 0.5526 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.5156 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3135 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.2657 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.3607 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.3308 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.2958 | Train Acc: 0.9251
 Site-MNIST                     (0) | Train Loss: 0.3735 | Train Acc: 0.9046
 Site-MNIST                     (0) | Train Loss: 0.3691 | Train Acc: 0.9103
 Site-MNIST                     (0) | Train Loss: 0.3361 | Train Acc: 0.9230
 Site-USPS                      (2) | Train Loss: 0.4196 | Train Acc: 0.8750
 Site-USPS                      (2) | Train Loss: 0.3639 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.3788 | Train Acc: 0.8915
 Site-USPS                      (2) | Train Loss: 0.4868 | Train Acc: 0.8455
 Site-USPS                      (2) | Train Loss: 0.4188 | Train Acc: 0.8929
 Site-USPS                      (2) | Train Loss: 0.4393 | Train Acc: 0.8915
 Site-SynthDigits               (1) | Train Loss: 0.9405 | Train Acc: 0.7285
 Site-SynthDigits               (1) | Train Loss: 0.8227 | Train Acc: 0.7619
 Site-SynthDigits               (1) | Train Loss: 0.7441 | Train Acc: 0.8187
 Site-MNIST_M                   (3) | Train Loss: 1.1247 | Train Acc: 0.6575
 Site-MNIST_M                   (3) | Train Loss: 1.0802 | Train Acc: 0.6850
 Site-SVHN                      (4) | Train Loss: 1.2936 | Train Acc: 0.5709
Average Train Accuracy: 0.8400
 Site-MNIST                     (0) | Val  Loss: 0.0515 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0750 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4357 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5497 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4309 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.3697 | Val  Acc: 0.9032
 Site-MNIST                     (0) | Val  Loss: 0.3288 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.3379 | Val  Acc: 0.9020
 Site-MNIST                     (0) | Val  Loss: 0.3875 | Val  Acc: 0.9126
 Site-MNIST                     (0) | Val  Loss: 0.3705 | Val  Acc: 0.9094
 Site-USPS                      (2) | Val  Loss: 0.2715 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.7312 | Val  Acc: 0.7222
 Site-USPS                      (2) | Val  Loss: 0.7670 | Val  Acc: 0.7188
 Site-USPS                      (2) | Val  Loss: 0.6441 | Val  Acc: 0.7931
 Site-USPS                      (2) | Val  Loss: 0.5234 | Val  Acc: 0.8286
 Site-USPS                      (2) | Val  Loss: 0.4363 | Val  Acc: 0.8677
 Site-SynthDigits               (1) | Val  Loss: 0.8317 | Val  Acc: 0.7838
 Site-SynthDigits               (1) | Val  Loss: 0.7131 | Val  Acc: 0.8235
 Site-SynthDigits               (1) | Val  Loss: 0.7775 | Val  Acc: 0.7869
 Site-MNIST_M                   (3) | Val  Loss: 1.2000 | Val  Acc: 0.6667
 Site-MNIST_M                   (3) | Val  Loss: 1.0715 | Val  Acc: 0.7284
 Site-SVHN                      (4) | Val  Loss: 1.0736 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8289
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9032
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9020
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9126
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9094
 Best site-USPS                     (2)  | Epoch:16 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:16 | Val Acc: 0.7222
 Best site-USPS                     (2)  | Epoch:16 | Val Acc: 0.7188
 Best site-USPS                     (2)  | Epoch:16 | Val Acc: 0.7931
 Best site-USPS                     (2)  | Epoch:16 | Val Acc: 0.8286
 Best site-USPS                     (2)  | Epoch:16 | Val Acc: 0.8677
 Best site-SynthDigits              (1)  | Epoch:16 | Val Acc: 0.7838
 Best site-SynthDigits              (1)  | Epoch:16 | Val Acc: 0.8235
 Best site-SynthDigits              (1)  | Epoch:16 | Val Acc: 0.7869
 Best site-MNIST_M                  (3)  | Epoch:16 | Val Acc: 0.6667
 Best site-MNIST_M                  (3)  | Epoch:16 | Val Acc: 0.7284
 Best site-SVHN                     (4)  | Epoch:16 | Val Acc: 0.6000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 17 ============
cnt=[6, 2, 10, 3, 1, ]
cnt=[10, 6, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (2) | Train Loss: 0.5529 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.5055 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.3208 | Train Acc: 0.9048
 Site-MNIST                     (2) | Train Loss: 0.2595 | Train Acc: 0.9211
 Site-MNIST                     (2) | Train Loss: 0.3547 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 0.3303 | Train Acc: 0.9127
 Site-MNIST                     (2) | Train Loss: 0.2830 | Train Acc: 0.9295
 Site-MNIST                     (2) | Train Loss: 0.3784 | Train Acc: 0.9046
 Site-MNIST                     (2) | Train Loss: 0.3617 | Train Acc: 0.9090
 Site-MNIST                     (2) | Train Loss: 0.3303 | Train Acc: 0.9200
 Site-USPS                      (0) | Train Loss: 0.3734 | Train Acc: 0.8750
 Site-USPS                      (0) | Train Loss: 0.3888 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.3999 | Train Acc: 0.9147
 Site-USPS                      (0) | Train Loss: 0.4699 | Train Acc: 0.8541
 Site-USPS                      (0) | Train Loss: 0.3957 | Train Acc: 0.9024
 Site-USPS                      (0) | Train Loss: 0.4094 | Train Acc: 0.8968
 Site-SynthDigits               (3) | Train Loss: 0.8289 | Train Acc: 0.7550
 Site-SynthDigits               (3) | Train Loss: 0.7738 | Train Acc: 0.7839
 Site-SynthDigits               (3) | Train Loss: 0.7186 | Train Acc: 0.8330
 Site-MNIST_M                   (1) | Train Loss: 1.0850 | Train Acc: 0.6796
 Site-MNIST_M                   (1) | Train Loss: 1.0277 | Train Acc: 0.7034
 Site-SVHN                      (4) | Train Loss: 1.3087 | Train Acc: 0.5922
Average Train Accuracy: 0.8482
 Site-MNIST                     (2) | Val  Loss: 0.0412 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.0702 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.4475 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 0.5524 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.4255 | Val  Acc: 0.8824
 Site-MNIST                     (2) | Val  Loss: 0.3606 | Val  Acc: 0.9032
 Site-MNIST                     (2) | Val  Loss: 0.3235 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.3331 | Val  Acc: 0.9020
 Site-MNIST                     (2) | Val  Loss: 0.3830 | Val  Acc: 0.9126
 Site-MNIST                     (2) | Val  Loss: 0.3645 | Val  Acc: 0.9124
 Site-USPS                      (0) | Val  Loss: 0.2465 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.6834 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.7168 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 0.6200 | Val  Acc: 0.7931
 Site-USPS                      (0) | Val  Loss: 0.4991 | Val  Acc: 0.8476
 Site-USPS                      (0) | Val  Loss: 0.4126 | Val  Acc: 0.8783
 Site-SynthDigits               (3) | Val  Loss: 0.7790 | Val  Acc: 0.7568
 Site-SynthDigits               (3) | Val  Loss: 0.6512 | Val  Acc: 0.7941
 Site-SynthDigits               (3) | Val  Loss: 0.7376 | Val  Acc: 0.8115
 Site-MNIST_M                   (1) | Val  Loss: 1.1622 | Val  Acc: 0.6889
 Site-MNIST_M                   (1) | Val  Loss: 1.0354 | Val  Acc: 0.7531
 Site-SVHN                      (4) | Val  Loss: 1.0426 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8324
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.8824
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.9032
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.9020
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.9126
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.9124
 Best site-USPS                     (0)  | Epoch:17 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:17 | Val Acc: 0.7222
 Best site-USPS                     (0)  | Epoch:17 | Val Acc: 0.7188
 Best site-USPS                     (0)  | Epoch:17 | Val Acc: 0.7931
 Best site-USPS                     (0)  | Epoch:17 | Val Acc: 0.8476
 Best site-USPS                     (0)  | Epoch:17 | Val Acc: 0.8783
 Best site-SynthDigits              (3)  | Epoch:17 | Val Acc: 0.7568
 Best site-SynthDigits              (3)  | Epoch:17 | Val Acc: 0.7941
 Best site-SynthDigits              (3)  | Epoch:17 | Val Acc: 0.8115
 Best site-MNIST_M                  (1)  | Epoch:17 | Val Acc: 0.6889
 Best site-MNIST_M                  (1)  | Epoch:17 | Val Acc: 0.7531
 Best site-SVHN                     (4)  | Epoch:17 | Val Acc: 0.6286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 18 ============
cnt=[10, 1, 6, 3, 2, ]
cnt=[4, 9, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (0) | Train Loss: 0.5306 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4870 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2961 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.2484 | Train Acc: 0.9474
 Site-MNIST                     (0) | Train Loss: 0.3323 | Train Acc: 0.8857
 Site-MNIST                     (0) | Train Loss: 0.3080 | Train Acc: 0.9206
 Site-MNIST                     (0) | Train Loss: 0.2760 | Train Acc: 0.9383
 Site-MNIST                     (0) | Train Loss: 0.3495 | Train Acc: 0.9095
 Site-MNIST                     (0) | Train Loss: 0.3468 | Train Acc: 0.9130
 Site-MNIST                     (0) | Train Loss: 0.3101 | Train Acc: 0.9253
 Site-USPS                      (2) | Train Loss: 0.3761 | Train Acc: 0.8750
 Site-USPS                      (2) | Train Loss: 0.4365 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.3447 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.4557 | Train Acc: 0.8455
 Site-USPS                      (2) | Train Loss: 0.3840 | Train Acc: 0.8976
 Site-USPS                      (2) | Train Loss: 0.4082 | Train Acc: 0.8942
 Site-SynthDigits               (3) | Train Loss: 0.8506 | Train Acc: 0.7815
 Site-SynthDigits               (3) | Train Loss: 0.7557 | Train Acc: 0.7912
 Site-SynthDigits               (3) | Train Loss: 0.6889 | Train Acc: 0.8289
 Site-MNIST_M                   (4) | Train Loss: 1.0411 | Train Acc: 0.6851
 Site-MNIST_M                   (4) | Train Loss: 1.0706 | Train Acc: 0.6972
 Site-SVHN                      (1) | Train Loss: 1.2832 | Train Acc: 0.5957
Average Train Accuracy: 0.8532
 Site-MNIST                     (0) | Val  Loss: 0.0360 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0620 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4482 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5424 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4092 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.3416 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.3061 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.3153 | Val  Acc: 0.9118
 Site-MNIST                     (0) | Val  Loss: 0.3659 | Val  Acc: 0.9126
 Site-MNIST                     (0) | Val  Loss: 0.3468 | Val  Acc: 0.9215
 Site-USPS                      (2) | Val  Loss: 0.2472 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.6848 | Val  Acc: 0.7222
 Site-USPS                      (2) | Val  Loss: 0.7183 | Val  Acc: 0.6875
 Site-USPS                      (2) | Val  Loss: 0.6160 | Val  Acc: 0.7931
 Site-USPS                      (2) | Val  Loss: 0.4943 | Val  Acc: 0.8286
 Site-USPS                      (2) | Val  Loss: 0.4048 | Val  Acc: 0.8783
 Site-SynthDigits               (3) | Val  Loss: 0.7511 | Val  Acc: 0.7838
 Site-SynthDigits               (3) | Val  Loss: 0.6236 | Val  Acc: 0.8235
 Site-SynthDigits               (3) | Val  Loss: 0.7212 | Val  Acc: 0.8033
 Site-MNIST_M                   (4) | Val  Loss: 1.1195 | Val  Acc: 0.7111
 Site-MNIST_M                   (4) | Val  Loss: 0.9913 | Val  Acc: 0.7778
 Site-SVHN                      (1) | Val  Loss: 1.0102 | Val  Acc: 0.6429
Average Valid Accuracy: 0.8382
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9118
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9126
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9215
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.7222
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.6875
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.7931
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.8286
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.8783
 Best site-SynthDigits              (3)  | Epoch:18 | Val Acc: 0.7838
 Best site-SynthDigits              (3)  | Epoch:18 | Val Acc: 0.8235
 Best site-SynthDigits              (3)  | Epoch:18 | Val Acc: 0.8033
 Best site-MNIST_M                  (4)  | Epoch:18 | Val Acc: 0.7111
 Best site-MNIST_M                  (4)  | Epoch:18 | Val Acc: 0.7778
 Best site-SVHN                     (1)  | Epoch:18 | Val Acc: 0.6429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 19 ============
cnt=[10, 3, 6, 2, 1, ]
cnt=[4, 9, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (0) | Train Loss: 0.5587 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4940 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3166 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.2488 | Train Acc: 0.9474
 Site-MNIST                     (0) | Train Loss: 0.2400 | Train Acc: 0.8714
 Site-MNIST                     (0) | Train Loss: 0.3157 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.2835 | Train Acc: 0.9251
 Site-MNIST                     (0) | Train Loss: 0.3582 | Train Acc: 0.9022
 Site-MNIST                     (0) | Train Loss: 0.3479 | Train Acc: 0.9090
 Site-MNIST                     (0) | Train Loss: 0.3115 | Train Acc: 0.9208
 Site-USPS                      (2) | Train Loss: 0.3612 | Train Acc: 0.8750
 Site-USPS                      (2) | Train Loss: 0.3707 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.2747 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.4415 | Train Acc: 0.8627
 Site-USPS                      (2) | Train Loss: 0.3707 | Train Acc: 0.9095
 Site-USPS                      (2) | Train Loss: 0.3865 | Train Acc: 0.9061
 Site-SynthDigits               (1) | Train Loss: 0.8507 | Train Acc: 0.7748
 Site-SynthDigits               (1) | Train Loss: 0.7713 | Train Acc: 0.8059
 Site-SynthDigits               (1) | Train Loss: 0.6693 | Train Acc: 0.8391
 Site-MNIST_M                   (3) | Train Loss: 1.0263 | Train Acc: 0.6851
 Site-MNIST_M                   (3) | Train Loss: 0.9644 | Train Acc: 0.7034
 Site-SVHN                      (4) | Train Loss: 1.2449 | Train Acc: 0.6099
Average Train Accuracy: 0.8519
 Site-MNIST                     (0) | Val  Loss: 0.0297 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0594 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4635 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5532 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4158 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.3403 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.3076 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.3176 | Val  Acc: 0.9118
 Site-MNIST                     (0) | Val  Loss: 0.3655 | Val  Acc: 0.9126
 Site-MNIST                     (0) | Val  Loss: 0.3487 | Val  Acc: 0.9154
 Site-USPS                      (2) | Val  Loss: 0.2192 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.6459 | Val  Acc: 0.7222
 Site-USPS                      (2) | Val  Loss: 0.6817 | Val  Acc: 0.7188
 Site-USPS                      (2) | Val  Loss: 0.5950 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.4766 | Val  Acc: 0.8571
 Site-USPS                      (2) | Val  Loss: 0.3883 | Val  Acc: 0.8942
 Site-SynthDigits               (1) | Val  Loss: 0.7333 | Val  Acc: 0.8108
 Site-SynthDigits               (1) | Val  Loss: 0.5906 | Val  Acc: 0.8235
 Site-SynthDigits               (1) | Val  Loss: 0.6858 | Val  Acc: 0.8361
 Site-MNIST_M                   (3) | Val  Loss: 1.0838 | Val  Acc: 0.7111
 Site-MNIST_M                   (3) | Val  Loss: 0.9686 | Val  Acc: 0.7778
 Site-SVHN                      (4) | Val  Loss: 0.9627 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8455
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9118
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9126
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9154
 Best site-USPS                     (2)  | Epoch:19 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:19 | Val Acc: 0.7222
 Best site-USPS                     (2)  | Epoch:19 | Val Acc: 0.7188
 Best site-USPS                     (2)  | Epoch:19 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:19 | Val Acc: 0.8571
 Best site-USPS                     (2)  | Epoch:19 | Val Acc: 0.8942
 Best site-SynthDigits              (1)  | Epoch:19 | Val Acc: 0.8108
 Best site-SynthDigits              (1)  | Epoch:19 | Val Acc: 0.8235
 Best site-SynthDigits              (1)  | Epoch:19 | Val Acc: 0.8361
 Best site-MNIST_M                  (3)  | Epoch:19 | Val Acc: 0.7111
 Best site-MNIST_M                  (3)  | Epoch:19 | Val Acc: 0.7778
 Best site-SVHN                     (4)  | Epoch:19 | Val Acc: 0.6571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 20 ============
cnt=[10, 1, 6, 2, 3, ]
cnt=[1, 6, 4, 9, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (0) | Train Loss: 0.5654 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4623 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2908 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.2285 | Train Acc: 0.9474
 Site-MNIST                     (0) | Train Loss: 0.4819 | Train Acc: 0.8857
 Site-MNIST                     (0) | Train Loss: 0.2933 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.2686 | Train Acc: 0.9339
 Site-MNIST                     (0) | Train Loss: 0.3230 | Train Acc: 0.9120
 Site-MNIST                     (0) | Train Loss: 0.3336 | Train Acc: 0.9185
 Site-MNIST                     (0) | Train Loss: 0.2971 | Train Acc: 0.9291
 Site-USPS                      (2) | Train Loss: 0.3548 | Train Acc: 0.8750
 Site-USPS                      (2) | Train Loss: 0.4391 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.2740 | Train Acc: 0.9147
 Site-USPS                      (2) | Train Loss: 0.4430 | Train Acc: 0.8584
 Site-USPS                      (2) | Train Loss: 0.3675 | Train Acc: 0.9024
 Site-USPS                      (2) | Train Loss: 0.3800 | Train Acc: 0.8995
 Site-SynthDigits               (4) | Train Loss: 0.7201 | Train Acc: 0.7682
 Site-SynthDigits               (4) | Train Loss: 0.7041 | Train Acc: 0.8278
 Site-SynthDigits               (4) | Train Loss: 0.6537 | Train Acc: 0.8574
 Site-MNIST_M                   (3) | Train Loss: 1.0221 | Train Acc: 0.6961
 Site-MNIST_M                   (3) | Train Loss: 0.9862 | Train Acc: 0.7156
 Site-SVHN                      (1) | Train Loss: 1.2048 | Train Acc: 0.6135
Average Train Accuracy: 0.8563
 Site-MNIST                     (0) | Val  Loss: 0.0282 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0554 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4602 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5443 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3988 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.3263 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2918 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.3034 | Val  Acc: 0.9216
 Site-MNIST                     (0) | Val  Loss: 0.3478 | Val  Acc: 0.9180
 Site-MNIST                     (0) | Val  Loss: 0.3324 | Val  Acc: 0.9215
 Site-USPS                      (2) | Val  Loss: 0.2142 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.6390 | Val  Acc: 0.7222
 Site-USPS                      (2) | Val  Loss: 0.6776 | Val  Acc: 0.7188
 Site-USPS                      (2) | Val  Loss: 0.5841 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.4700 | Val  Acc: 0.8381
 Site-USPS                      (2) | Val  Loss: 0.3825 | Val  Acc: 0.8942
 Site-SynthDigits               (4) | Val  Loss: 0.7026 | Val  Acc: 0.8649
 Site-SynthDigits               (4) | Val  Loss: 0.5645 | Val  Acc: 0.8529
 Site-SynthDigits               (4) | Val  Loss: 0.6627 | Val  Acc: 0.8443
 Site-MNIST_M                   (3) | Val  Loss: 1.0717 | Val  Acc: 0.7111
 Site-MNIST_M                   (3) | Val  Loss: 0.9544 | Val  Acc: 0.7778
 Site-SVHN                      (1) | Val  Loss: 0.9201 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8517
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9216
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9180
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9215
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.7222
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.7188
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.8381
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.8942
 Best site-SynthDigits              (4)  | Epoch:20 | Val Acc: 0.8649
 Best site-SynthDigits              (4)  | Epoch:20 | Val Acc: 0.8529
 Best site-SynthDigits              (4)  | Epoch:20 | Val Acc: 0.8443
 Best site-MNIST_M                  (3)  | Epoch:20 | Val Acc: 0.7111
 Best site-MNIST_M                  (3)  | Epoch:20 | Val Acc: 0.7778
 Best site-SVHN                     (1)  | Epoch:20 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 21 ============
cnt=[6, 10, 2, 3, 1, ]
cnt=[9, 4, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (1) | Train Loss: 0.5303 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4299 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.2468 | Train Acc: 0.9048
 Site-MNIST                     (1) | Train Loss: 0.2107 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3530 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.2623 | Train Acc: 0.9365
 Site-MNIST                     (1) | Train Loss: 0.2621 | Train Acc: 0.9471
 Site-MNIST                     (1) | Train Loss: 0.3063 | Train Acc: 0.9193
 Site-MNIST                     (1) | Train Loss: 0.3122 | Train Acc: 0.9239
 Site-MNIST                     (1) | Train Loss: 0.2701 | Train Acc: 0.9381
 Site-USPS                      (0) | Train Loss: 0.3736 | Train Acc: 0.8750
 Site-USPS                      (0) | Train Loss: 0.3039 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.2725 | Train Acc: 0.9070
 Site-USPS                      (0) | Train Loss: 0.4382 | Train Acc: 0.8455
 Site-USPS                      (0) | Train Loss: 0.3616 | Train Acc: 0.9000
 Site-USPS                      (0) | Train Loss: 0.3785 | Train Acc: 0.8995
 Site-SynthDigits               (3) | Train Loss: 0.7190 | Train Acc: 0.7748
 Site-SynthDigits               (3) | Train Loss: 0.7181 | Train Acc: 0.8168
 Site-SynthDigits               (3) | Train Loss: 0.6351 | Train Acc: 0.8554
 Site-MNIST_M                   (2) | Train Loss: 0.9770 | Train Acc: 0.7072
 Site-MNIST_M                   (2) | Train Loss: 0.8980 | Train Acc: 0.7339
 Site-SVHN                      (4) | Train Loss: 1.2159 | Train Acc: 0.6028
Average Train Accuracy: 0.8662
 Site-MNIST                     (1) | Val  Loss: 0.0275 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0492 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4532 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5331 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3796 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.3066 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2703 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2827 | Val  Acc: 0.9020
 Site-MNIST                     (1) | Val  Loss: 0.3270 | Val  Acc: 0.9235
 Site-MNIST                     (1) | Val  Loss: 0.3103 | Val  Acc: 0.9335
 Site-USPS                      (0) | Val  Loss: 0.2205 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.6587 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.6990 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 0.5846 | Val  Acc: 0.7931
 Site-USPS                      (0) | Val  Loss: 0.4690 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.3794 | Val  Acc: 0.8677
 Site-SynthDigits               (3) | Val  Loss: 0.6777 | Val  Acc: 0.8378
 Site-SynthDigits               (3) | Val  Loss: 0.5627 | Val  Acc: 0.8382
 Site-SynthDigits               (3) | Val  Loss: 0.6483 | Val  Acc: 0.8525
 Site-MNIST_M                   (2) | Val  Loss: 1.0477 | Val  Acc: 0.6889
 Site-MNIST_M                   (2) | Val  Loss: 0.9212 | Val  Acc: 0.7531
 Site-SVHN                      (4) | Val  Loss: 0.9092 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8449
============ Train epoch 22 ============
cnt=[6, 10, 2, 3, 1, ]
cnt=[4, 9, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (1) | Train Loss: 0.5236 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4224 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.2303 | Train Acc: 0.9048
 Site-MNIST                     (1) | Train Loss: 0.2074 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3148 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.2492 | Train Acc: 0.9365
 Site-MNIST                     (1) | Train Loss: 0.2327 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.3116 | Train Acc: 0.9193
 Site-MNIST                     (1) | Train Loss: 0.3033 | Train Acc: 0.9280
 Site-MNIST                     (1) | Train Loss: 0.2615 | Train Acc: 0.9411
 Site-USPS                      (0) | Train Loss: 0.3470 | Train Acc: 0.8750
 Site-USPS                      (0) | Train Loss: 0.5400 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.2558 | Train Acc: 0.9225
 Site-USPS                      (0) | Train Loss: 0.4182 | Train Acc: 0.8498
 Site-USPS                      (0) | Train Loss: 0.3392 | Train Acc: 0.9024
 Site-USPS                      (0) | Train Loss: 0.3635 | Train Acc: 0.9074
 Site-SynthDigits               (3) | Train Loss: 0.7767 | Train Acc: 0.7947
 Site-SynthDigits               (3) | Train Loss: 0.6480 | Train Acc: 0.8205
 Site-SynthDigits               (3) | Train Loss: 0.6064 | Train Acc: 0.8615
 Site-MNIST_M                   (2) | Train Loss: 0.9625 | Train Acc: 0.7072
 Site-MNIST_M                   (2) | Train Loss: 0.9426 | Train Acc: 0.7492
 Site-SVHN                      (4) | Train Loss: 1.1432 | Train Acc: 0.6241
Average Train Accuracy: 0.8713
 Site-MNIST                     (1) | Val  Loss: 0.0240 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0459 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4362 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5143 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3620 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2965 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2630 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2730 | Val  Acc: 0.9020
 Site-MNIST                     (1) | Val  Loss: 0.3178 | Val  Acc: 0.9235
 Site-MNIST                     (1) | Val  Loss: 0.2988 | Val  Acc: 0.9335
 Site-USPS                      (0) | Val  Loss: 0.2194 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.6366 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.6671 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 0.5669 | Val  Acc: 0.7931
 Site-USPS                      (0) | Val  Loss: 0.4557 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.3646 | Val  Acc: 0.8730
 Site-SynthDigits               (3) | Val  Loss: 0.6443 | Val  Acc: 0.8378
 Site-SynthDigits               (3) | Val  Loss: 0.5244 | Val  Acc: 0.8382
 Site-SynthDigits               (3) | Val  Loss: 0.6389 | Val  Acc: 0.8361
 Site-MNIST_M                   (2) | Val  Loss: 1.0244 | Val  Acc: 0.7333
 Site-MNIST_M                   (2) | Val  Loss: 0.8939 | Val  Acc: 0.7901
 Site-SVHN                      (4) | Val  Loss: 0.9129 | Val  Acc: 0.6714
Average Valid Accuracy: 0.8474
============ Train epoch 23 ============
cnt=[3, 10, 6, 2, 1, ]
cnt=[6, 9, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (1) | Train Loss: 0.5205 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4074 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.2444 | Train Acc: 0.9048
 Site-MNIST                     (1) | Train Loss: 0.2038 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.4682 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.2515 | Train Acc: 0.9365
 Site-MNIST                     (1) | Train Loss: 0.2474 | Train Acc: 0.9427
 Site-MNIST                     (1) | Train Loss: 0.3115 | Train Acc: 0.9193
 Site-MNIST                     (1) | Train Loss: 0.3028 | Train Acc: 0.9253
 Site-MNIST                     (1) | Train Loss: 0.2610 | Train Acc: 0.9411
 Site-USPS                      (2) | Train Loss: 0.3366 | Train Acc: 0.8500
 Site-USPS                      (2) | Train Loss: 0.2668 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 1.2366 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.3953 | Train Acc: 0.8627
 Site-USPS                      (2) | Train Loss: 0.3289 | Train Acc: 0.9190
 Site-USPS                      (2) | Train Loss: 0.3471 | Train Acc: 0.9087
 Site-SynthDigits               (0) | Train Loss: 0.7271 | Train Acc: 0.8013
 Site-SynthDigits               (0) | Train Loss: 0.7035 | Train Acc: 0.8315
 Site-SynthDigits               (0) | Train Loss: 0.5986 | Train Acc: 0.8656
 Site-MNIST_M                   (3) | Train Loss: 0.9395 | Train Acc: 0.7072
 Site-MNIST_M                   (3) | Train Loss: 0.9364 | Train Acc: 0.7278
 Site-SVHN                      (4) | Train Loss: 1.1298 | Train Acc: 0.6312
Average Train Accuracy: 0.8718
 Site-MNIST                     (1) | Val  Loss: 0.0215 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0430 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4643 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5432 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3794 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2979 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2608 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2720 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.3176 | Val  Acc: 0.9180
 Site-MNIST                     (1) | Val  Loss: 0.2999 | Val  Acc: 0.9335
 Site-USPS                      (2) | Val  Loss: 0.1882 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.6024 | Val  Acc: 0.7222
 Site-USPS                      (2) | Val  Loss: 0.6429 | Val  Acc: 0.7188
 Site-USPS                      (2) | Val  Loss: 0.5517 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.4377 | Val  Acc: 0.8381
 Site-USPS                      (2) | Val  Loss: 0.3507 | Val  Acc: 0.9048
 Site-SynthDigits               (0) | Val  Loss: 0.6310 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.5059 | Val  Acc: 0.8382
 Site-SynthDigits               (0) | Val  Loss: 0.6171 | Val  Acc: 0.8607
 Site-MNIST_M                   (3) | Val  Loss: 0.9897 | Val  Acc: 0.7333
 Site-MNIST_M                   (3) | Val  Loss: 0.8763 | Val  Acc: 0.8025
 Site-SVHN                      (4) | Val  Loss: 0.8691 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8542
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9216
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9180
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9335
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.7222
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.7188
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.8381
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.9048
 Best site-SynthDigits              (0)  | Epoch:23 | Val Acc: 0.8919
 Best site-SynthDigits              (0)  | Epoch:23 | Val Acc: 0.8382
 Best site-SynthDigits              (0)  | Epoch:23 | Val Acc: 0.8607
 Best site-MNIST_M                  (3)  | Epoch:23 | Val Acc: 0.7333
 Best site-MNIST_M                  (3)  | Epoch:23 | Val Acc: 0.8025
 Best site-SVHN                     (4)  | Epoch:23 | Val Acc: 0.6571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 24 ============
cnt=[10, 3, 2, 6, 1, ]
cnt=[9, 6, 2, 1, 4, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (0) | Train Loss: 0.5234 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4125 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.2442 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.1999 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.3564 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.2477 | Train Acc: 0.9365
 Site-MNIST                     (0) | Train Loss: 0.2406 | Train Acc: 0.9471
 Site-MNIST                     (0) | Train Loss: 0.3006 | Train Acc: 0.9218
 Site-MNIST                     (0) | Train Loss: 0.2970 | Train Acc: 0.9293
 Site-MNIST                     (0) | Train Loss: 0.2551 | Train Acc: 0.9389
 Site-USPS                      (3) | Train Loss: 0.3364 | Train Acc: 0.8750
 Site-USPS                      (3) | Train Loss: 0.2942 | Train Acc: 0.9444
 Site-USPS                      (3) | Train Loss: 0.2567 | Train Acc: 0.9302
 Site-USPS                      (3) | Train Loss: 0.4069 | Train Acc: 0.8670
 Site-USPS                      (3) | Train Loss: 0.3211 | Train Acc: 0.9238
 Site-USPS                      (3) | Train Loss: 0.3418 | Train Acc: 0.9074
 Site-SynthDigits               (1) | Train Loss: 0.7055 | Train Acc: 0.7947
 Site-SynthDigits               (1) | Train Loss: 0.6321 | Train Acc: 0.8315
 Site-SynthDigits               (1) | Train Loss: 0.5835 | Train Acc: 0.8798
 Site-MNIST_M                   (2) | Train Loss: 0.9043 | Train Acc: 0.7348
 Site-MNIST_M                   (2) | Train Loss: 0.9115 | Train Acc: 0.7370
 Site-SVHN                      (4) | Train Loss: 1.0860 | Train Acc: 0.6525
Average Train Accuracy: 0.8777
 Site-MNIST                     (0) | Val  Loss: 0.0191 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0405 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4699 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5382 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3750 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2920 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2561 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.2671 | Val  Acc: 0.9118
 Site-MNIST                     (0) | Val  Loss: 0.3126 | Val  Acc: 0.9235
 Site-MNIST                     (0) | Val  Loss: 0.2948 | Val  Acc: 0.9335
 Site-USPS                      (3) | Val  Loss: 0.1785 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.5962 | Val  Acc: 0.7222
 Site-USPS                      (3) | Val  Loss: 0.6392 | Val  Acc: 0.7188
 Site-USPS                      (3) | Val  Loss: 0.5420 | Val  Acc: 0.8276
 Site-USPS                      (3) | Val  Loss: 0.4324 | Val  Acc: 0.8667
 Site-USPS                      (3) | Val  Loss: 0.3460 | Val  Acc: 0.8995
 Site-SynthDigits               (1) | Val  Loss: 0.6061 | Val  Acc: 0.9189
 Site-SynthDigits               (1) | Val  Loss: 0.4744 | Val  Acc: 0.8529
 Site-SynthDigits               (1) | Val  Loss: 0.6052 | Val  Acc: 0.8607
 Site-MNIST_M                   (2) | Val  Loss: 0.9655 | Val  Acc: 0.7778
 Site-MNIST_M                   (2) | Val  Loss: 0.8486 | Val  Acc: 0.8272
 Site-SVHN                      (4) | Val  Loss: 0.8425 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8635
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9118
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9235
 Best site-MNIST                    (0)  | Epoch:24 | Val Acc: 0.9335
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.7222
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.7188
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.8276
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.8667
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.8995
 Best site-SynthDigits              (1)  | Epoch:24 | Val Acc: 0.9189
 Best site-SynthDigits              (1)  | Epoch:24 | Val Acc: 0.8529
 Best site-SynthDigits              (1)  | Epoch:24 | Val Acc: 0.8607
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.7778
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.8272
 Best site-SVHN                     (4)  | Epoch:24 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 25 ============
cnt=[6, 10, 1, 3, 2, ]
cnt=[1, 10, 2, 6, 3, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (1) | Train Loss: 0.5285 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4007 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.2265 | Train Acc: 0.9048
 Site-MNIST                     (1) | Train Loss: 0.1909 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.4440 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.2387 | Train Acc: 0.9365
 Site-MNIST                     (1) | Train Loss: 0.2230 | Train Acc: 0.9471
 Site-MNIST                     (1) | Train Loss: 0.2938 | Train Acc: 0.9242
 Site-MNIST                     (1) | Train Loss: 0.2885 | Train Acc: 0.9321
 Site-MNIST                     (1) | Train Loss: 0.2492 | Train Acc: 0.9404
 Site-USPS                      (0) | Train Loss: 0.3428 | Train Acc: 0.8750
 Site-USPS                      (0) | Train Loss: 0.3785 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.2307 | Train Acc: 0.9380
 Site-USPS                      (0) | Train Loss: 0.4020 | Train Acc: 0.8541
 Site-USPS                      (0) | Train Loss: 0.3101 | Train Acc: 0.9262
 Site-USPS                      (0) | Train Loss: 0.3366 | Train Acc: 0.9140
 Site-SynthDigits               (3) | Train Loss: 0.7483 | Train Acc: 0.7947
 Site-SynthDigits               (3) | Train Loss: 0.6760 | Train Acc: 0.8388
 Site-SynthDigits               (3) | Train Loss: 0.5717 | Train Acc: 0.8758
 Site-MNIST_M                   (4) | Train Loss: 0.8932 | Train Acc: 0.7293
 Site-MNIST_M                   (4) | Train Loss: 0.8503 | Train Acc: 0.7554
 Site-SVHN                      (2) | Train Loss: 1.1120 | Train Acc: 0.6525
Average Train Accuracy: 0.8789
 Site-MNIST                     (1) | Val  Loss: 0.0179 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0393 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4691 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5398 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3718 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2864 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2486 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2602 | Val  Acc: 0.9118
 Site-MNIST                     (1) | Val  Loss: 0.3052 | Val  Acc: 0.9235
 Site-MNIST                     (1) | Val  Loss: 0.2888 | Val  Acc: 0.9335
 Site-USPS                      (0) | Val  Loss: 0.1725 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.5927 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.6430 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 0.5341 | Val  Acc: 0.8276
 Site-USPS                      (0) | Val  Loss: 0.4287 | Val  Acc: 0.8571
 Site-USPS                      (0) | Val  Loss: 0.3422 | Val  Acc: 0.8942
 Site-SynthDigits               (3) | Val  Loss: 0.5827 | Val  Acc: 0.9189
 Site-SynthDigits               (3) | Val  Loss: 0.4713 | Val  Acc: 0.8529
 Site-SynthDigits               (3) | Val  Loss: 0.5928 | Val  Acc: 0.8525
 Site-MNIST_M                   (4) | Val  Loss: 0.9526 | Val  Acc: 0.7778
 Site-MNIST_M                   (4) | Val  Loss: 0.8311 | Val  Acc: 0.8272
 Site-SVHN                      (2) | Val  Loss: 0.8385 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8631
============ Train epoch 26 ============
cnt=[3, 10, 6, 2, 1, ]
cnt=[4, 9, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (1) | Train Loss: 0.5229 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3928 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.2179 | Train Acc: 0.9048
 Site-MNIST                     (1) | Train Loss: 0.1895 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.2308 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.2282 | Train Acc: 0.9365
 Site-MNIST                     (1) | Train Loss: 0.2321 | Train Acc: 0.9515
 Site-MNIST                     (1) | Train Loss: 0.2806 | Train Acc: 0.9218
 Site-MNIST                     (1) | Train Loss: 0.2829 | Train Acc: 0.9361
 Site-MNIST                     (1) | Train Loss: 0.2418 | Train Acc: 0.9442
 Site-USPS                      (2) | Train Loss: 0.3399 | Train Acc: 0.9000
 Site-USPS                      (2) | Train Loss: 0.2671 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.2372 | Train Acc: 0.9147
 Site-USPS                      (2) | Train Loss: 0.3892 | Train Acc: 0.8541
 Site-USPS                      (2) | Train Loss: 0.3167 | Train Acc: 0.9310
 Site-USPS                      (2) | Train Loss: 0.3290 | Train Acc: 0.9140
 Site-SynthDigits               (0) | Train Loss: 0.6766 | Train Acc: 0.7947
 Site-SynthDigits               (0) | Train Loss: 0.6284 | Train Acc: 0.8388
 Site-SynthDigits               (0) | Train Loss: 0.5519 | Train Acc: 0.8819
 Site-MNIST_M                   (3) | Train Loss: 0.8744 | Train Acc: 0.7459
 Site-MNIST_M                   (3) | Train Loss: 0.8832 | Train Acc: 0.7645
 Site-SVHN                      (4) | Train Loss: 1.0494 | Train Acc: 0.6809
Average Train Accuracy: 0.8817
 Site-MNIST                     (1) | Val  Loss: 0.0164 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0355 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4624 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5206 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3569 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2744 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2400 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2514 | Val  Acc: 0.9118
 Site-MNIST                     (1) | Val  Loss: 0.2960 | Val  Acc: 0.9235
 Site-MNIST                     (1) | Val  Loss: 0.2802 | Val  Acc: 0.9335
 Site-USPS                      (2) | Val  Loss: 0.1677 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5876 | Val  Acc: 0.7222
 Site-USPS                      (2) | Val  Loss: 0.6377 | Val  Acc: 0.7500
 Site-USPS                      (2) | Val  Loss: 0.5325 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.4247 | Val  Acc: 0.8762
 Site-USPS                      (2) | Val  Loss: 0.3359 | Val  Acc: 0.8889
 Site-SynthDigits               (0) | Val  Loss: 0.5571 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.4609 | Val  Acc: 0.8824
 Site-SynthDigits               (0) | Val  Loss: 0.5676 | Val  Acc: 0.8607
 Site-MNIST_M                   (3) | Val  Loss: 0.9478 | Val  Acc: 0.7778
 Site-MNIST_M                   (3) | Val  Loss: 0.8184 | Val  Acc: 0.8395
 Site-SVHN                      (4) | Val  Loss: 0.8315 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8679
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.9118
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.9235
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.9335
 Best site-USPS                     (2)  | Epoch:26 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:26 | Val Acc: 0.7222
 Best site-USPS                     (2)  | Epoch:26 | Val Acc: 0.7500
 Best site-USPS                     (2)  | Epoch:26 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:26 | Val Acc: 0.8762
 Best site-USPS                     (2)  | Epoch:26 | Val Acc: 0.8889
 Best site-SynthDigits              (0)  | Epoch:26 | Val Acc: 0.9189
 Best site-SynthDigits              (0)  | Epoch:26 | Val Acc: 0.8824
 Best site-SynthDigits              (0)  | Epoch:26 | Val Acc: 0.8607
 Best site-MNIST_M                  (3)  | Epoch:26 | Val Acc: 0.7778
 Best site-MNIST_M                  (3)  | Epoch:26 | Val Acc: 0.8395
 Best site-SVHN                     (4)  | Epoch:26 | Val Acc: 0.7571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 27 ============
cnt=[6, 10, 3, 2, 1, ]
cnt=[2, 9, 6, 4, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (1) | Train Loss: 0.5068 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3840 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.2024 | Train Acc: 0.9048
 Site-MNIST                     (1) | Train Loss: 0.1848 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.2415 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.2239 | Train Acc: 0.9365
 Site-MNIST                     (1) | Train Loss: 0.2113 | Train Acc: 0.9515
 Site-MNIST                     (1) | Train Loss: 0.2734 | Train Acc: 0.9218
 Site-MNIST                     (1) | Train Loss: 0.2764 | Train Acc: 0.9348
 Site-MNIST                     (1) | Train Loss: 0.2355 | Train Acc: 0.9449
 Site-USPS                      (0) | Train Loss: 0.3051 | Train Acc: 0.9000
 Site-USPS                      (0) | Train Loss: 0.2222 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.7856 | Train Acc: 0.9225
 Site-USPS                      (0) | Train Loss: 0.3826 | Train Acc: 0.8627
 Site-USPS                      (0) | Train Loss: 0.3032 | Train Acc: 0.9238
 Site-USPS                      (0) | Train Loss: 0.3175 | Train Acc: 0.9193
 Site-SynthDigits               (2) | Train Loss: 0.6549 | Train Acc: 0.8079
 Site-SynthDigits               (2) | Train Loss: 0.5880 | Train Acc: 0.8425
 Site-SynthDigits               (2) | Train Loss: 0.5251 | Train Acc: 0.8778
 Site-MNIST_M                   (3) | Train Loss: 0.8652 | Train Acc: 0.7403
 Site-MNIST_M                   (3) | Train Loss: 0.8062 | Train Acc: 0.7645
 Site-SVHN                      (4) | Train Loss: 1.0837 | Train Acc: 0.6738
Average Train Accuracy: 0.8830
 Site-MNIST                     (1) | Val  Loss: 0.0163 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0337 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4681 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5200 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3539 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2670 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2333 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2438 | Val  Acc: 0.9118
 Site-MNIST                     (1) | Val  Loss: 0.2901 | Val  Acc: 0.9235
 Site-MNIST                     (1) | Val  Loss: 0.2733 | Val  Acc: 0.9335
 Site-USPS                      (0) | Val  Loss: 0.1542 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.5623 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.6093 | Val  Acc: 0.7812
 Site-USPS                      (0) | Val  Loss: 0.5168 | Val  Acc: 0.8276
 Site-USPS                      (0) | Val  Loss: 0.4099 | Val  Acc: 0.8762
 Site-USPS                      (0) | Val  Loss: 0.3231 | Val  Acc: 0.9048
 Site-SynthDigits               (2) | Val  Loss: 0.5501 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.4415 | Val  Acc: 0.8824
 Site-SynthDigits               (2) | Val  Loss: 0.5506 | Val  Acc: 0.8607
 Site-MNIST_M                   (3) | Val  Loss: 0.9221 | Val  Acc: 0.7778
 Site-MNIST_M                   (3) | Val  Loss: 0.7922 | Val  Acc: 0.8519
 Site-SVHN                      (4) | Val  Loss: 0.8181 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8721
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 0.9118
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 0.9235
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 0.9335
 Best site-USPS                     (0)  | Epoch:27 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:27 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:27 | Val Acc: 0.7812
 Best site-USPS                     (0)  | Epoch:27 | Val Acc: 0.8276
 Best site-USPS                     (0)  | Epoch:27 | Val Acc: 0.8762
 Best site-USPS                     (0)  | Epoch:27 | Val Acc: 0.9048
 Best site-SynthDigits              (2)  | Epoch:27 | Val Acc: 0.8919
 Best site-SynthDigits              (2)  | Epoch:27 | Val Acc: 0.8824
 Best site-SynthDigits              (2)  | Epoch:27 | Val Acc: 0.8607
 Best site-MNIST_M                  (3)  | Epoch:27 | Val Acc: 0.7778
 Best site-MNIST_M                  (3)  | Epoch:27 | Val Acc: 0.8519
 Best site-SVHN                     (4)  | Epoch:27 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 28 ============
cnt=[3, 10, 6, 2, 1, ]
cnt=[1, 6, 2, 4, 9, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (1) | Train Loss: 0.4961 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3717 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1865 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1702 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.6488 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.2107 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.2076 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2829 | Train Acc: 0.9218
 Site-MNIST                     (1) | Train Loss: 0.2606 | Train Acc: 0.9307
 Site-MNIST                     (1) | Train Loss: 0.2262 | Train Acc: 0.9540
 Site-USPS                      (2) | Train Loss: 0.3305 | Train Acc: 0.8750
 Site-USPS                      (2) | Train Loss: 0.4590 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.5066 | Train Acc: 0.8992
 Site-USPS                      (2) | Train Loss: 0.3737 | Train Acc: 0.8584
 Site-USPS                      (2) | Train Loss: 0.2868 | Train Acc: 0.9286
 Site-USPS                      (2) | Train Loss: 0.3110 | Train Acc: 0.9180
 Site-SynthDigits               (0) | Train Loss: 0.6370 | Train Acc: 0.7947
 Site-SynthDigits               (0) | Train Loss: 0.6020 | Train Acc: 0.8388
 Site-SynthDigits               (0) | Train Loss: 0.5154 | Train Acc: 0.8859
 Site-MNIST_M                   (3) | Train Loss: 0.8537 | Train Acc: 0.7680
 Site-MNIST_M                   (3) | Train Loss: 0.8523 | Train Acc: 0.7645
 Site-SVHN                      (4) | Train Loss: 1.0312 | Train Acc: 0.6738
Average Train Accuracy: 0.8843
 Site-MNIST                     (1) | Val  Loss: 0.0180 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0316 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4314 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4783 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3252 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2530 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2251 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2349 | Val  Acc: 0.9020
 Site-MNIST                     (1) | Val  Loss: 0.2796 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2636 | Val  Acc: 0.9366
 Site-USPS                      (2) | Val  Loss: 0.1708 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5840 | Val  Acc: 0.7222
 Site-USPS                      (2) | Val  Loss: 0.6174 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.5080 | Val  Acc: 0.8276
 Site-USPS                      (2) | Val  Loss: 0.4100 | Val  Acc: 0.8571
 Site-USPS                      (2) | Val  Loss: 0.3216 | Val  Acc: 0.8889
 Site-SynthDigits               (0) | Val  Loss: 0.5432 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.4357 | Val  Acc: 0.8824
 Site-SynthDigits               (0) | Val  Loss: 0.5522 | Val  Acc: 0.8689
 Site-MNIST_M                   (3) | Val  Loss: 0.9171 | Val  Acc: 0.7778
 Site-MNIST_M                   (3) | Val  Loss: 0.7799 | Val  Acc: 0.8642
 Site-SVHN                      (4) | Val  Loss: 0.8050 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8710
============ Train epoch 29 ============
cnt=[10, 1, 6, 2, 3, ]
cnt=[1, 6, 9, 4, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (0) | Train Loss: 0.5294 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3680 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1729 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1641 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.3006 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.2030 | Train Acc: 0.9603
 Site-MNIST                     (0) | Train Loss: 0.2094 | Train Acc: 0.9559
 Site-MNIST                     (0) | Train Loss: 0.2566 | Train Acc: 0.9315
 Site-MNIST                     (0) | Train Loss: 0.2575 | Train Acc: 0.9361
 Site-MNIST                     (0) | Train Loss: 0.2184 | Train Acc: 0.9532
 Site-USPS                      (2) | Train Loss: 0.3186 | Train Acc: 0.8750
 Site-USPS                      (2) | Train Loss: 0.2258 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.2177 | Train Acc: 0.9070
 Site-USPS                      (2) | Train Loss: 0.3679 | Train Acc: 0.8670
 Site-USPS                      (2) | Train Loss: 0.2887 | Train Acc: 0.9333
 Site-USPS                      (2) | Train Loss: 0.3054 | Train Acc: 0.9153
 Site-SynthDigits               (4) | Train Loss: 0.6741 | Train Acc: 0.8079
 Site-SynthDigits               (4) | Train Loss: 0.5540 | Train Acc: 0.8645
 Site-SynthDigits               (4) | Train Loss: 0.5157 | Train Acc: 0.8880
 Site-MNIST_M                   (3) | Train Loss: 0.8464 | Train Acc: 0.7680
 Site-MNIST_M                   (3) | Train Loss: 0.7695 | Train Acc: 0.7523
 Site-SVHN                      (1) | Train Loss: 1.0410 | Train Acc: 0.6879
Average Train Accuracy: 0.8881
 Site-MNIST                     (0) | Val  Loss: 0.0172 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0322 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4457 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4825 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3228 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2463 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2161 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.2280 | Val  Acc: 0.9118
 Site-MNIST                     (0) | Val  Loss: 0.2706 | Val  Acc: 0.9344
 Site-MNIST                     (0) | Val  Loss: 0.2572 | Val  Acc: 0.9486
 Site-USPS                      (2) | Val  Loss: 0.1568 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5674 | Val  Acc: 0.7222
 Site-USPS                      (2) | Val  Loss: 0.6066 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.5030 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.4035 | Val  Acc: 0.8857
 Site-USPS                      (2) | Val  Loss: 0.3175 | Val  Acc: 0.8942
 Site-SynthDigits               (4) | Val  Loss: 0.5279 | Val  Acc: 0.9189
 Site-SynthDigits               (4) | Val  Loss: 0.4090 | Val  Acc: 0.8824
 Site-SynthDigits               (4) | Val  Loss: 0.5279 | Val  Acc: 0.8689
 Site-MNIST_M                   (3) | Val  Loss: 0.8895 | Val  Acc: 0.7778
 Site-MNIST_M                   (3) | Val  Loss: 0.7658 | Val  Acc: 0.8642
 Site-SVHN                      (1) | Val  Loss: 0.7774 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8721
============ Train epoch 30 ============
cnt=[6, 10, 2, 3, 1, ]
cnt=[1, 9, 2, 1, 9, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (1) | Train Loss: 0.5334 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3604 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1677 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1575 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.7244 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1945 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1885 | Train Acc: 0.9648
 Site-MNIST                     (1) | Train Loss: 0.2515 | Train Acc: 0.9364
 Site-MNIST                     (1) | Train Loss: 0.2498 | Train Acc: 0.9361
 Site-MNIST                     (1) | Train Loss: 0.2118 | Train Acc: 0.9562
 Site-USPS                      (0) | Train Loss: 0.3025 | Train Acc: 0.9500
 Site-USPS                      (0) | Train Loss: 0.2269 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.2164 | Train Acc: 0.8992
 Site-USPS                      (0) | Train Loss: 0.3628 | Train Acc: 0.8670
 Site-USPS                      (0) | Train Loss: 0.2852 | Train Acc: 0.9333
 Site-USPS                      (0) | Train Loss: 0.3093 | Train Acc: 0.9167
 Site-SynthDigits               (3) | Train Loss: 0.6562 | Train Acc: 0.8013
 Site-SynthDigits               (3) | Train Loss: 0.5394 | Train Acc: 0.8828
 Site-SynthDigits               (3) | Train Loss: 0.4972 | Train Acc: 0.8900
 Site-MNIST_M                   (2) | Train Loss: 0.8251 | Train Acc: 0.7845
 Site-MNIST_M                   (2) | Train Loss: 0.8149 | Train Acc: 0.7798
 Site-SVHN                      (4) | Train Loss: 0.9644 | Train Acc: 0.7021
Average Train Accuracy: 0.8946
 Site-MNIST                     (1) | Val  Loss: 0.0182 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4634 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4887 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3228 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2333 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2058 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2207 | Val  Acc: 0.9118
 Site-MNIST                     (1) | Val  Loss: 0.2631 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2517 | Val  Acc: 0.9456
 Site-USPS                      (0) | Val  Loss: 0.1600 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.5658 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.6171 | Val  Acc: 0.7500
 Site-USPS                      (0) | Val  Loss: 0.5031 | Val  Acc: 0.8276
 Site-USPS                      (0) | Val  Loss: 0.4091 | Val  Acc: 0.8952
 Site-USPS                      (0) | Val  Loss: 0.3201 | Val  Acc: 0.8889
 Site-SynthDigits               (3) | Val  Loss: 0.5160 | Val  Acc: 0.9189
 Site-SynthDigits               (3) | Val  Loss: 0.4013 | Val  Acc: 0.8824
 Site-SynthDigits               (3) | Val  Loss: 0.5138 | Val  Acc: 0.8689
 Site-MNIST_M                   (2) | Val  Loss: 0.8895 | Val  Acc: 0.8000
 Site-MNIST_M                   (2) | Val  Loss: 0.7559 | Val  Acc: 0.8642
 Site-SVHN                      (4) | Val  Loss: 0.7607 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8763
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9118
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9344
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9456
 Best site-USPS                     (0)  | Epoch:30 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:30 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:30 | Val Acc: 0.7500
 Best site-USPS                     (0)  | Epoch:30 | Val Acc: 0.8276
 Best site-USPS                     (0)  | Epoch:30 | Val Acc: 0.8952
 Best site-USPS                     (0)  | Epoch:30 | Val Acc: 0.8889
 Best site-SynthDigits              (3)  | Epoch:30 | Val Acc: 0.9189
 Best site-SynthDigits              (3)  | Epoch:30 | Val Acc: 0.8824
 Best site-SynthDigits              (3)  | Epoch:30 | Val Acc: 0.8689
 Best site-MNIST_M                  (2)  | Epoch:30 | Val Acc: 0.8000
 Best site-MNIST_M                  (2)  | Epoch:30 | Val Acc: 0.8642
 Best site-SVHN                     (4)  | Epoch:30 | Val Acc: 0.7714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 31 ============
cnt=[10, 6, 3, 2, 1, ]
cnt=[1, 6, 9, 4, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (0) | Train Loss: 0.5287 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3384 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1725 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1530 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.1869 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1928 | Train Acc: 0.9603
 Site-MNIST                     (0) | Train Loss: 0.2008 | Train Acc: 0.9559
 Site-MNIST                     (0) | Train Loss: 0.2454 | Train Acc: 0.9389
 Site-MNIST                     (0) | Train Loss: 0.2512 | Train Acc: 0.9429
 Site-MNIST                     (0) | Train Loss: 0.2065 | Train Acc: 0.9570
 Site-USPS                      (1) | Train Loss: 0.3157 | Train Acc: 0.9000
 Site-USPS                      (1) | Train Loss: 0.3325 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.2108 | Train Acc: 0.9070
 Site-USPS                      (1) | Train Loss: 0.3693 | Train Acc: 0.8712
 Site-USPS                      (1) | Train Loss: 0.2787 | Train Acc: 0.9333
 Site-USPS                      (1) | Train Loss: 0.3020 | Train Acc: 0.9167
 Site-SynthDigits               (2) | Train Loss: 0.6217 | Train Acc: 0.8146
 Site-SynthDigits               (2) | Train Loss: 0.5628 | Train Acc: 0.8718
 Site-SynthDigits               (2) | Train Loss: 0.4860 | Train Acc: 0.9063
 Site-MNIST_M                   (3) | Train Loss: 0.7976 | Train Acc: 0.7735
 Site-MNIST_M                   (3) | Train Loss: 0.7891 | Train Acc: 0.7920
 Site-SVHN                      (4) | Train Loss: 0.9617 | Train Acc: 0.7021
Average Train Accuracy: 0.8938
 Site-MNIST                     (0) | Val  Loss: 0.0178 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0357 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4672 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4918 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3195 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2236 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1958 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.2133 | Val  Acc: 0.9216
 Site-MNIST                     (0) | Val  Loss: 0.2580 | Val  Acc: 0.9344
 Site-MNIST                     (0) | Val  Loss: 0.2482 | Val  Acc: 0.9396
 Site-USPS                      (1) | Val  Loss: 0.1496 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.5495 | Val  Acc: 0.8333
 Site-USPS                      (1) | Val  Loss: 0.6014 | Val  Acc: 0.7812
 Site-USPS                      (1) | Val  Loss: 0.4865 | Val  Acc: 0.8448
 Site-USPS                      (1) | Val  Loss: 0.3986 | Val  Acc: 0.9143
 Site-USPS                      (1) | Val  Loss: 0.3157 | Val  Acc: 0.8942
 Site-SynthDigits               (2) | Val  Loss: 0.5118 | Val  Acc: 0.8649
 Site-SynthDigits               (2) | Val  Loss: 0.4035 | Val  Acc: 0.8971
 Site-SynthDigits               (2) | Val  Loss: 0.5076 | Val  Acc: 0.8689
 Site-MNIST_M                   (3) | Val  Loss: 0.8731 | Val  Acc: 0.8000
 Site-MNIST_M                   (3) | Val  Loss: 0.7362 | Val  Acc: 0.8642
 Site-SVHN                      (4) | Val  Loss: 0.7677 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8814
 Best site-MNIST                    (0)  | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:31 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:31 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:31 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:31 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:31 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:31 | Val Acc: 0.9216
 Best site-MNIST                    (0)  | Epoch:31 | Val Acc: 0.9344
 Best site-MNIST                    (0)  | Epoch:31 | Val Acc: 0.9396
 Best site-USPS                     (1)  | Epoch:31 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:31 | Val Acc: 0.8333
 Best site-USPS                     (1)  | Epoch:31 | Val Acc: 0.7812
 Best site-USPS                     (1)  | Epoch:31 | Val Acc: 0.8448
 Best site-USPS                     (1)  | Epoch:31 | Val Acc: 0.9143
 Best site-USPS                     (1)  | Epoch:31 | Val Acc: 0.8942
 Best site-SynthDigits              (2)  | Epoch:31 | Val Acc: 0.8649
 Best site-SynthDigits              (2)  | Epoch:31 | Val Acc: 0.8971
 Best site-SynthDigits              (2)  | Epoch:31 | Val Acc: 0.8689
 Best site-MNIST_M                  (3)  | Epoch:31 | Val Acc: 0.8000
 Best site-MNIST_M                  (3)  | Epoch:31 | Val Acc: 0.8642
 Best site-SVHN                     (4)  | Epoch:31 | Val Acc: 0.7714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 32 ============
cnt=[10, 6, 3, 2, 1, ]
cnt=[6, 1, 2, 4, 9, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (0) | Train Loss: 0.5253 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3400 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1616 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1490 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.6709 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1948 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1924 | Train Acc: 0.9559
 Site-MNIST                     (0) | Train Loss: 0.2432 | Train Acc: 0.9389
 Site-MNIST                     (0) | Train Loss: 0.2423 | Train Acc: 0.9402
 Site-MNIST                     (0) | Train Loss: 0.2045 | Train Acc: 0.9592
 Site-USPS                      (1) | Train Loss: 0.3066 | Train Acc: 0.9000
 Site-USPS                      (1) | Train Loss: 0.2463 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.2086 | Train Acc: 0.9147
 Site-USPS                      (1) | Train Loss: 0.3421 | Train Acc: 0.8755
 Site-USPS                      (1) | Train Loss: 0.2659 | Train Acc: 0.9357
 Site-USPS                      (1) | Train Loss: 0.2876 | Train Acc: 0.9325
 Site-SynthDigits               (2) | Train Loss: 0.5412 | Train Acc: 0.8212
 Site-SynthDigits               (2) | Train Loss: 0.5357 | Train Acc: 0.8608
 Site-SynthDigits               (2) | Train Loss: 0.4727 | Train Acc: 0.9002
 Site-MNIST_M                   (3) | Train Loss: 0.7851 | Train Acc: 0.7845
 Site-MNIST_M                   (3) | Train Loss: 0.7547 | Train Acc: 0.7951
 Site-SVHN                      (4) | Train Loss: 0.9558 | Train Acc: 0.7092
Average Train Accuracy: 0.8953
 Site-MNIST                     (0) | Val  Loss: 0.0155 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0338 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4465 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4767 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3096 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2290 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1985 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.2135 | Val  Acc: 0.9216
 Site-MNIST                     (0) | Val  Loss: 0.2563 | Val  Acc: 0.9344
 Site-MNIST                     (0) | Val  Loss: 0.2448 | Val  Acc: 0.9456
 Site-USPS                      (1) | Val  Loss: 0.1494 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.5332 | Val  Acc: 0.7778
 Site-USPS                      (1) | Val  Loss: 0.5684 | Val  Acc: 0.7812
 Site-USPS                      (1) | Val  Loss: 0.4662 | Val  Acc: 0.8276
 Site-USPS                      (1) | Val  Loss: 0.3835 | Val  Acc: 0.9048
 Site-USPS                      (1) | Val  Loss: 0.3048 | Val  Acc: 0.8889
 Site-SynthDigits               (2) | Val  Loss: 0.4967 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.3775 | Val  Acc: 0.8824
 Site-SynthDigits               (2) | Val  Loss: 0.4838 | Val  Acc: 0.8852
 Site-MNIST_M                   (3) | Val  Loss: 0.8588 | Val  Acc: 0.8444
 Site-MNIST_M                   (3) | Val  Loss: 0.7185 | Val  Acc: 0.8765
 Site-SVHN                      (4) | Val  Loss: 0.7456 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8806
============ Train epoch 33 ============
cnt=[6, 10, 1, 2, 3, ]
cnt=[6, 1, 2, 9, 4, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (1) | Train Loss: 0.5342 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3299 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1598 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1476 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3518 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1873 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1887 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2425 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.2446 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.2000 | Train Acc: 0.9577
 Site-USPS                      (0) | Train Loss: 0.2842 | Train Acc: 0.9250
 Site-USPS                      (0) | Train Loss: 0.2718 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.2345 | Train Acc: 0.9302
 Site-USPS                      (0) | Train Loss: 0.3451 | Train Acc: 0.8712
 Site-USPS                      (0) | Train Loss: 0.2598 | Train Acc: 0.9357
 Site-USPS                      (0) | Train Loss: 0.2865 | Train Acc: 0.9246
 Site-SynthDigits               (4) | Train Loss: 0.6422 | Train Acc: 0.8411
 Site-SynthDigits               (4) | Train Loss: 0.5093 | Train Acc: 0.8791
 Site-SynthDigits               (4) | Train Loss: 0.4712 | Train Acc: 0.8982
 Site-MNIST_M                   (3) | Train Loss: 0.7614 | Train Acc: 0.7956
 Site-MNIST_M                   (3) | Train Loss: 0.7174 | Train Acc: 0.7859
 Site-SVHN                      (2) | Train Loss: 0.9515 | Train Acc: 0.6986
Average Train Accuracy: 0.8981
 Site-MNIST                     (1) | Val  Loss: 0.0146 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0342 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4694 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4944 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3172 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2271 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1941 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2097 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.2518 | Val  Acc: 0.9399
 Site-MNIST                     (1) | Val  Loss: 0.2405 | Val  Acc: 0.9426
 Site-USPS                      (0) | Val  Loss: 0.1390 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.5248 | Val  Acc: 0.8333
 Site-USPS                      (0) | Val  Loss: 0.5598 | Val  Acc: 0.7812
 Site-USPS                      (0) | Val  Loss: 0.4643 | Val  Acc: 0.8103
 Site-USPS                      (0) | Val  Loss: 0.3810 | Val  Acc: 0.8952
 Site-USPS                      (0) | Val  Loss: 0.3008 | Val  Acc: 0.8995
 Site-SynthDigits               (4) | Val  Loss: 0.4953 | Val  Acc: 0.9189
 Site-SynthDigits               (4) | Val  Loss: 0.3646 | Val  Acc: 0.8971
 Site-SynthDigits               (4) | Val  Loss: 0.4734 | Val  Acc: 0.8852
 Site-MNIST_M                   (3) | Val  Loss: 0.8338 | Val  Acc: 0.8444
 Site-MNIST_M                   (3) | Val  Loss: 0.6961 | Val  Acc: 0.8765
 Site-SVHN                      (2) | Val  Loss: 0.7415 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8840
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9216
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9399
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9426
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.8333
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.7812
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.8103
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.8952
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.8995
 Best site-SynthDigits              (4)  | Epoch:33 | Val Acc: 0.9189
 Best site-SynthDigits              (4)  | Epoch:33 | Val Acc: 0.8971
 Best site-SynthDigits              (4)  | Epoch:33 | Val Acc: 0.8852
 Best site-MNIST_M                  (3)  | Epoch:33 | Val Acc: 0.8444
 Best site-MNIST_M                  (3)  | Epoch:33 | Val Acc: 0.8765
 Best site-SVHN                     (2)  | Epoch:33 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 34 ============
cnt=[1, 10, 6, 2, 3, ]
cnt=[9, 6, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (1) | Train Loss: 0.5262 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3203 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1510 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1474 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.2545 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1776 | Train Acc: 0.9683
 Site-MNIST                     (1) | Train Loss: 0.1842 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2390 | Train Acc: 0.9364
 Site-MNIST                     (1) | Train Loss: 0.2394 | Train Acc: 0.9361
 Site-MNIST                     (1) | Train Loss: 0.1928 | Train Acc: 0.9585
 Site-USPS                      (2) | Train Loss: 0.2860 | Train Acc: 0.9750
 Site-USPS                      (2) | Train Loss: 0.2411 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.3364 | Train Acc: 0.9147
 Site-USPS                      (2) | Train Loss: 0.3325 | Train Acc: 0.8670
 Site-USPS                      (2) | Train Loss: 0.2598 | Train Acc: 0.9429
 Site-USPS                      (2) | Train Loss: 0.2763 | Train Acc: 0.9286
 Site-SynthDigits               (4) | Train Loss: 0.5489 | Train Acc: 0.8278
 Site-SynthDigits               (4) | Train Loss: 0.4785 | Train Acc: 0.8901
 Site-SynthDigits               (4) | Train Loss: 0.4566 | Train Acc: 0.8961
 Site-MNIST_M                   (3) | Train Loss: 0.7617 | Train Acc: 0.7790
 Site-MNIST_M                   (3) | Train Loss: 0.7571 | Train Acc: 0.7920
 Site-SVHN                      (0) | Train Loss: 0.9307 | Train Acc: 0.6879
Average Train Accuracy: 0.8996
 Site-MNIST                     (1) | Val  Loss: 0.0148 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0344 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4790 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5122 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3231 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2222 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1873 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2027 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.2457 | Val  Acc: 0.9399
 Site-MNIST                     (1) | Val  Loss: 0.2340 | Val  Acc: 0.9456
 Site-USPS                      (2) | Val  Loss: 0.1392 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5214 | Val  Acc: 0.7778
 Site-USPS                      (2) | Val  Loss: 0.5552 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.4665 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.3796 | Val  Acc: 0.8857
 Site-USPS                      (2) | Val  Loss: 0.2938 | Val  Acc: 0.9048
 Site-SynthDigits               (4) | Val  Loss: 0.4854 | Val  Acc: 0.8919
 Site-SynthDigits               (4) | Val  Loss: 0.3576 | Val  Acc: 0.9265
 Site-SynthDigits               (4) | Val  Loss: 0.4608 | Val  Acc: 0.8852
 Site-MNIST_M                   (3) | Val  Loss: 0.8355 | Val  Acc: 0.8222
 Site-MNIST_M                   (3) | Val  Loss: 0.6992 | Val  Acc: 0.8765
 Site-SVHN                      (0) | Val  Loss: 0.7328 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8812
============ Train epoch 35 ============
cnt=[10, 6, 2, 3, 1, ]
cnt=[6, 9, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (0) | Train Loss: 0.5285 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3153 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1414 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1416 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.3082 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1701 | Train Acc: 0.9683
 Site-MNIST                     (0) | Train Loss: 0.1810 | Train Acc: 0.9559
 Site-MNIST                     (0) | Train Loss: 0.2229 | Train Acc: 0.9389
 Site-MNIST                     (0) | Train Loss: 0.2265 | Train Acc: 0.9402
 Site-MNIST                     (0) | Train Loss: 0.1887 | Train Acc: 0.9585
 Site-USPS                      (1) | Train Loss: 0.2754 | Train Acc: 0.9500
 Site-USPS                      (1) | Train Loss: 0.1926 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.1861 | Train Acc: 0.9147
 Site-USPS                      (1) | Train Loss: 0.3310 | Train Acc: 0.8755
 Site-USPS                      (1) | Train Loss: 0.2566 | Train Acc: 0.9381
 Site-USPS                      (1) | Train Loss: 0.2723 | Train Acc: 0.9286
 Site-SynthDigits               (3) | Train Loss: 0.5703 | Train Acc: 0.8278
 Site-SynthDigits               (3) | Train Loss: 0.4898 | Train Acc: 0.8755
 Site-SynthDigits               (3) | Train Loss: 0.4433 | Train Acc: 0.9022
 Site-MNIST_M                   (2) | Train Loss: 0.7589 | Train Acc: 0.7845
 Site-MNIST_M                   (2) | Train Loss: 0.7643 | Train Acc: 0.8012
 Site-SVHN                      (4) | Train Loss: 0.9703 | Train Acc: 0.7128
Average Train Accuracy: 0.8997
 Site-MNIST                     (0) | Val  Loss: 0.0149 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0334 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4831 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5155 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3234 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2151 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1809 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1967 | Val  Acc: 0.9216
 Site-MNIST                     (0) | Val  Loss: 0.2419 | Val  Acc: 0.9454
 Site-MNIST                     (0) | Val  Loss: 0.2309 | Val  Acc: 0.9486
 Site-USPS                      (1) | Val  Loss: 0.1295 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.5102 | Val  Acc: 0.8333
 Site-USPS                      (1) | Val  Loss: 0.5482 | Val  Acc: 0.7812
 Site-USPS                      (1) | Val  Loss: 0.4520 | Val  Acc: 0.8276
 Site-USPS                      (1) | Val  Loss: 0.3738 | Val  Acc: 0.9048
 Site-USPS                      (1) | Val  Loss: 0.2909 | Val  Acc: 0.9101
 Site-SynthDigits               (3) | Val  Loss: 0.4659 | Val  Acc: 0.8919
 Site-SynthDigits               (3) | Val  Loss: 0.3607 | Val  Acc: 0.8971
 Site-SynthDigits               (3) | Val  Loss: 0.4629 | Val  Acc: 0.8770
 Site-MNIST_M                   (2) | Val  Loss: 0.8332 | Val  Acc: 0.8222
 Site-MNIST_M                   (2) | Val  Loss: 0.6885 | Val  Acc: 0.8765
 Site-SVHN                      (4) | Val  Loss: 0.7284 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8862
 Best site-MNIST                    (0)  | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:35 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:35 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:35 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:35 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:35 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:35 | Val Acc: 0.9216
 Best site-MNIST                    (0)  | Epoch:35 | Val Acc: 0.9454
 Best site-MNIST                    (0)  | Epoch:35 | Val Acc: 0.9486
 Best site-USPS                     (1)  | Epoch:35 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:35 | Val Acc: 0.8333
 Best site-USPS                     (1)  | Epoch:35 | Val Acc: 0.7812
 Best site-USPS                     (1)  | Epoch:35 | Val Acc: 0.8276
 Best site-USPS                     (1)  | Epoch:35 | Val Acc: 0.9048
 Best site-USPS                     (1)  | Epoch:35 | Val Acc: 0.9101
 Best site-SynthDigits              (3)  | Epoch:35 | Val Acc: 0.8919
 Best site-SynthDigits              (3)  | Epoch:35 | Val Acc: 0.8971
 Best site-SynthDigits              (3)  | Epoch:35 | Val Acc: 0.8770
 Best site-MNIST_M                  (2)  | Epoch:35 | Val Acc: 0.8222
 Best site-MNIST_M                  (2)  | Epoch:35 | Val Acc: 0.8765
 Best site-SVHN                     (4)  | Epoch:35 | Val Acc: 0.8000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 36 ============
cnt=[6, 10, 3, 2, 1, ]
cnt=[9, 6, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (1) | Train Loss: 0.5229 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3087 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1376 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1468 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.2987 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1649 | Train Acc: 0.9683
 Site-MNIST                     (1) | Train Loss: 0.1750 | Train Acc: 0.9604
 Site-MNIST                     (1) | Train Loss: 0.2361 | Train Acc: 0.9315
 Site-MNIST                     (1) | Train Loss: 0.2379 | Train Acc: 0.9361
 Site-MNIST                     (1) | Train Loss: 0.1843 | Train Acc: 0.9615
 Site-USPS                      (0) | Train Loss: 0.2847 | Train Acc: 0.9500
 Site-USPS                      (0) | Train Loss: 0.3644 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.1874 | Train Acc: 0.9302
 Site-USPS                      (0) | Train Loss: 0.3343 | Train Acc: 0.8670
 Site-USPS                      (0) | Train Loss: 0.2420 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.2700 | Train Acc: 0.9299
 Site-SynthDigits               (2) | Train Loss: 0.5366 | Train Acc: 0.8477
 Site-SynthDigits               (2) | Train Loss: 0.4714 | Train Acc: 0.8828
 Site-SynthDigits               (2) | Train Loss: 0.4404 | Train Acc: 0.9084
 Site-MNIST_M                   (3) | Train Loss: 0.7420 | Train Acc: 0.8011
 Site-MNIST_M                   (3) | Train Loss: 0.6754 | Train Acc: 0.8043
 Site-SVHN                      (4) | Train Loss: 0.9558 | Train Acc: 0.7128
Average Train Accuracy: 0.9032
 Site-MNIST                     (1) | Val  Loss: 0.0139 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0318 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4933 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5198 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3256 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2146 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1801 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1951 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.2390 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2283 | Val  Acc: 0.9426
 Site-USPS                      (0) | Val  Loss: 0.1193 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.5019 | Val  Acc: 0.8333
 Site-USPS                      (0) | Val  Loss: 0.5403 | Val  Acc: 0.7500
 Site-USPS                      (0) | Val  Loss: 0.4451 | Val  Acc: 0.8276
 Site-USPS                      (0) | Val  Loss: 0.3702 | Val  Acc: 0.9048
 Site-USPS                      (0) | Val  Loss: 0.2889 | Val  Acc: 0.8995
 Site-SynthDigits               (2) | Val  Loss: 0.4605 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.3509 | Val  Acc: 0.9118
 Site-SynthDigits               (2) | Val  Loss: 0.4522 | Val  Acc: 0.8770
 Site-MNIST_M                   (3) | Val  Loss: 0.8041 | Val  Acc: 0.8444
 Site-MNIST_M                   (3) | Val  Loss: 0.6705 | Val  Acc: 0.8765
 Site-SVHN                      (4) | Val  Loss: 0.7090 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8846
============ Train epoch 37 ============
cnt=[10, 6, 3, 2, 1, ]
cnt=[10, 6, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (0) | Train Loss: 0.5310 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3039 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1288 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1384 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.3759 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.1614 | Train Acc: 0.9683
 Site-MNIST                     (0) | Train Loss: 0.1654 | Train Acc: 0.9648
 Site-MNIST                     (0) | Train Loss: 0.2261 | Train Acc: 0.9364
 Site-MNIST                     (0) | Train Loss: 0.2194 | Train Acc: 0.9361
 Site-MNIST                     (0) | Train Loss: 0.1807 | Train Acc: 0.9585
 Site-USPS                      (1) | Train Loss: 0.2731 | Train Acc: 0.9000
 Site-USPS                      (1) | Train Loss: 0.4230 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.1905 | Train Acc: 0.9302
 Site-USPS                      (1) | Train Loss: 0.3207 | Train Acc: 0.8798
 Site-USPS                      (1) | Train Loss: 0.2466 | Train Acc: 0.9476
 Site-USPS                      (1) | Train Loss: 0.2656 | Train Acc: 0.9378
 Site-SynthDigits               (2) | Train Loss: 0.5205 | Train Acc: 0.8411
 Site-SynthDigits               (2) | Train Loss: 0.5183 | Train Acc: 0.8864
 Site-SynthDigits               (2) | Train Loss: 0.4280 | Train Acc: 0.9104
 Site-MNIST_M                   (3) | Train Loss: 0.7300 | Train Acc: 0.7901
 Site-MNIST_M                   (3) | Train Loss: 0.7343 | Train Acc: 0.8012
 Site-SVHN                      (4) | Train Loss: 0.9026 | Train Acc: 0.7270
Average Train Accuracy: 0.9023
 Site-MNIST                     (0) | Val  Loss: 0.0131 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0307 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4872 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5240 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3246 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2149 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1764 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1926 | Val  Acc: 0.9216
 Site-MNIST                     (0) | Val  Loss: 0.2365 | Val  Acc: 0.9344
 Site-MNIST                     (0) | Val  Loss: 0.2259 | Val  Acc: 0.9456
 Site-USPS                      (1) | Val  Loss: 0.1141 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.5024 | Val  Acc: 0.8333
 Site-USPS                      (1) | Val  Loss: 0.5402 | Val  Acc: 0.7812
 Site-USPS                      (1) | Val  Loss: 0.4355 | Val  Acc: 0.8448
 Site-USPS                      (1) | Val  Loss: 0.3644 | Val  Acc: 0.8857
 Site-USPS                      (1) | Val  Loss: 0.2892 | Val  Acc: 0.8889
 Site-SynthDigits               (2) | Val  Loss: 0.4525 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.3447 | Val  Acc: 0.9118
 Site-SynthDigits               (2) | Val  Loss: 0.4480 | Val  Acc: 0.8852
 Site-MNIST_M                   (3) | Val  Loss: 0.8193 | Val  Acc: 0.8444
 Site-MNIST_M                   (3) | Val  Loss: 0.6727 | Val  Acc: 0.8889
 Site-SVHN                      (4) | Val  Loss: 0.6903 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8923
 Best site-MNIST                    (0)  | Epoch:37 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:37 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:37 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:37 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:37 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:37 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:37 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:37 | Val Acc: 0.9216
 Best site-MNIST                    (0)  | Epoch:37 | Val Acc: 0.9344
 Best site-MNIST                    (0)  | Epoch:37 | Val Acc: 0.9456
 Best site-USPS                     (1)  | Epoch:37 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:37 | Val Acc: 0.8333
 Best site-USPS                     (1)  | Epoch:37 | Val Acc: 0.7812
 Best site-USPS                     (1)  | Epoch:37 | Val Acc: 0.8448
 Best site-USPS                     (1)  | Epoch:37 | Val Acc: 0.8857
 Best site-USPS                     (1)  | Epoch:37 | Val Acc: 0.8889
 Best site-SynthDigits              (2)  | Epoch:37 | Val Acc: 0.9189
 Best site-SynthDigits              (2)  | Epoch:37 | Val Acc: 0.9118
 Best site-SynthDigits              (2)  | Epoch:37 | Val Acc: 0.8852
 Best site-MNIST_M                  (3)  | Epoch:37 | Val Acc: 0.8444
 Best site-MNIST_M                  (3)  | Epoch:37 | Val Acc: 0.8889
 Best site-SVHN                     (4)  | Epoch:37 | Val Acc: 0.7857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 38 ============
cnt=[6, 10, 3, 2, 1, ]
cnt=[9, 6, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (1) | Train Loss: 0.5253 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2986 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1325 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1350 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.1909 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1611 | Train Acc: 0.9683
 Site-MNIST                     (1) | Train Loss: 0.1692 | Train Acc: 0.9648
 Site-MNIST                     (1) | Train Loss: 0.2254 | Train Acc: 0.9364
 Site-MNIST                     (1) | Train Loss: 0.2169 | Train Acc: 0.9402
 Site-MNIST                     (1) | Train Loss: 0.1797 | Train Acc: 0.9585
 Site-USPS                      (0) | Train Loss: 0.2605 | Train Acc: 0.9750
 Site-USPS                      (0) | Train Loss: 0.3138 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.6695 | Train Acc: 0.9225
 Site-USPS                      (0) | Train Loss: 0.3062 | Train Acc: 0.8798
 Site-USPS                      (0) | Train Loss: 0.2362 | Train Acc: 0.9476
 Site-USPS                      (0) | Train Loss: 0.2567 | Train Acc: 0.9339
 Site-SynthDigits               (2) | Train Loss: 0.5285 | Train Acc: 0.8411
 Site-SynthDigits               (2) | Train Loss: 0.4915 | Train Acc: 0.8901
 Site-SynthDigits               (2) | Train Loss: 0.4140 | Train Acc: 0.9145
 Site-MNIST_M                   (3) | Train Loss: 0.7082 | Train Acc: 0.8232
 Site-MNIST_M                   (3) | Train Loss: 0.7252 | Train Acc: 0.8073
 Site-SVHN                      (4) | Train Loss: 0.8799 | Train Acc: 0.7057
Average Train Accuracy: 0.9065
 Site-MNIST                     (1) | Val  Loss: 0.0126 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0287 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4883 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5206 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3225 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2151 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1771 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1914 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.2353 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2233 | Val  Acc: 0.9486
 Site-USPS                      (0) | Val  Loss: 0.1110 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.4813 | Val  Acc: 0.8333
 Site-USPS                      (0) | Val  Loss: 0.5198 | Val  Acc: 0.7812
 Site-USPS                      (0) | Val  Loss: 0.4292 | Val  Acc: 0.8448
 Site-USPS                      (0) | Val  Loss: 0.3528 | Val  Acc: 0.9048
 Site-USPS                      (0) | Val  Loss: 0.2761 | Val  Acc: 0.8995
 Site-SynthDigits               (2) | Val  Loss: 0.4496 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.3383 | Val  Acc: 0.8971
 Site-SynthDigits               (2) | Val  Loss: 0.4382 | Val  Acc: 0.8934
 Site-MNIST_M                   (3) | Val  Loss: 0.7895 | Val  Acc: 0.8667
 Site-MNIST_M                   (3) | Val  Loss: 0.6555 | Val  Acc: 0.8765
 Site-SVHN                      (4) | Val  Loss: 0.6830 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8927
 Best site-MNIST                    (1)  | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:38 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:38 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:38 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:38 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:38 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:38 | Val Acc: 0.9216
 Best site-MNIST                    (1)  | Epoch:38 | Val Acc: 0.9344
 Best site-MNIST                    (1)  | Epoch:38 | Val Acc: 0.9486
 Best site-USPS                     (0)  | Epoch:38 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:38 | Val Acc: 0.8333
 Best site-USPS                     (0)  | Epoch:38 | Val Acc: 0.7812
 Best site-USPS                     (0)  | Epoch:38 | Val Acc: 0.8448
 Best site-USPS                     (0)  | Epoch:38 | Val Acc: 0.9048
 Best site-USPS                     (0)  | Epoch:38 | Val Acc: 0.8995
 Best site-SynthDigits              (2)  | Epoch:38 | Val Acc: 0.8919
 Best site-SynthDigits              (2)  | Epoch:38 | Val Acc: 0.8971
 Best site-SynthDigits              (2)  | Epoch:38 | Val Acc: 0.8934
 Best site-MNIST_M                  (3)  | Epoch:38 | Val Acc: 0.8667
 Best site-MNIST_M                  (3)  | Epoch:38 | Val Acc: 0.8765
 Best site-SVHN                     (4)  | Epoch:38 | Val Acc: 0.7857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 39 ============
cnt=[6, 10, 3, 2, 1, ]
cnt=[6, 10, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (1) | Train Loss: 0.5350 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3030 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1399 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1399 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3732 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1650 | Train Acc: 0.9683
 Site-MNIST                     (1) | Train Loss: 0.1911 | Train Acc: 0.9604
 Site-MNIST                     (1) | Train Loss: 0.2125 | Train Acc: 0.9413
 Site-MNIST                     (1) | Train Loss: 0.2231 | Train Acc: 0.9402
 Site-MNIST                     (1) | Train Loss: 0.1830 | Train Acc: 0.9600
 Site-USPS                      (0) | Train Loss: 0.2644 | Train Acc: 0.9750
 Site-USPS                      (0) | Train Loss: 0.2605 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.3537 | Train Acc: 0.9302
 Site-USPS                      (0) | Train Loss: 0.3051 | Train Acc: 0.8970
 Site-USPS                      (0) | Train Loss: 0.2226 | Train Acc: 0.9381
 Site-USPS                      (0) | Train Loss: 0.2452 | Train Acc: 0.9352
 Site-SynthDigits               (2) | Train Loss: 0.5514 | Train Acc: 0.8411
 Site-SynthDigits               (2) | Train Loss: 0.4861 | Train Acc: 0.8938
 Site-SynthDigits               (2) | Train Loss: 0.4170 | Train Acc: 0.9165
 Site-MNIST_M                   (3) | Train Loss: 0.7037 | Train Acc: 0.8343
 Site-MNIST_M                   (3) | Train Loss: 0.6747 | Train Acc: 0.8104
 Site-SVHN                      (4) | Train Loss: 0.8694 | Train Acc: 0.7199
Average Train Accuracy: 0.9089
 Site-MNIST                     (1) | Val  Loss: 0.0120 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0263 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4719 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5012 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3153 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2154 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1802 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1916 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.2358 | Val  Acc: 0.9454
 Site-MNIST                     (1) | Val  Loss: 0.2237 | Val  Acc: 0.9486
 Site-USPS                      (0) | Val  Loss: 0.1006 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.4571 | Val  Acc: 0.8333
 Site-USPS                      (0) | Val  Loss: 0.4851 | Val  Acc: 0.7812
 Site-USPS                      (0) | Val  Loss: 0.4117 | Val  Acc: 0.8448
 Site-USPS                      (0) | Val  Loss: 0.3375 | Val  Acc: 0.8952
 Site-USPS                      (0) | Val  Loss: 0.2604 | Val  Acc: 0.9153
 Site-SynthDigits               (2) | Val  Loss: 0.4370 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.3283 | Val  Acc: 0.9265
 Site-SynthDigits               (2) | Val  Loss: 0.4255 | Val  Acc: 0.8852
 Site-MNIST_M                   (3) | Val  Loss: 0.7629 | Val  Acc: 0.8667
 Site-MNIST_M                   (3) | Val  Loss: 0.6403 | Val  Acc: 0.8889
 Site-SVHN                      (4) | Val  Loss: 0.6764 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8950
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9216
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9454
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9486
 Best site-USPS                     (0)  | Epoch:39 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:39 | Val Acc: 0.8333
 Best site-USPS                     (0)  | Epoch:39 | Val Acc: 0.7812
 Best site-USPS                     (0)  | Epoch:39 | Val Acc: 0.8448
 Best site-USPS                     (0)  | Epoch:39 | Val Acc: 0.8952
 Best site-USPS                     (0)  | Epoch:39 | Val Acc: 0.9153
 Best site-SynthDigits              (2)  | Epoch:39 | Val Acc: 0.8919
 Best site-SynthDigits              (2)  | Epoch:39 | Val Acc: 0.9265
 Best site-SynthDigits              (2)  | Epoch:39 | Val Acc: 0.8852
 Best site-MNIST_M                  (3)  | Epoch:39 | Val Acc: 0.8667
 Best site-MNIST_M                  (3)  | Epoch:39 | Val Acc: 0.8889
 Best site-SVHN                     (4)  | Epoch:39 | Val Acc: 0.7857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 40 ============
cnt=[6, 10, 3, 2, 1, ]
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (1) | Train Loss: 0.5697 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2961 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1420 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1353 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3695 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1653 | Train Acc: 0.9683
 Site-MNIST                     (1) | Train Loss: 0.1756 | Train Acc: 0.9648
 Site-MNIST                     (1) | Train Loss: 0.2152 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2187 | Train Acc: 0.9429
 Site-MNIST                     (1) | Train Loss: 0.1809 | Train Acc: 0.9592
 Site-USPS                      (0) | Train Loss: 0.2401 | Train Acc: 0.9750
 Site-USPS                      (0) | Train Loss: 0.1994 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.2141 | Train Acc: 0.9380
 Site-USPS                      (0) | Train Loss: 0.3064 | Train Acc: 0.8841
 Site-USPS                      (0) | Train Loss: 0.2227 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.2422 | Train Acc: 0.9378
 Site-SynthDigits               (2) | Train Loss: 0.5664 | Train Acc: 0.8477
 Site-SynthDigits               (2) | Train Loss: 0.4531 | Train Acc: 0.8864
 Site-SynthDigits               (2) | Train Loss: 0.4036 | Train Acc: 0.9165
 Site-MNIST_M                   (3) | Train Loss: 0.7069 | Train Acc: 0.8287
 Site-MNIST_M                   (3) | Train Loss: 0.6398 | Train Acc: 0.8012
 Site-SVHN                      (4) | Train Loss: 0.8806 | Train Acc: 0.7376
Average Train Accuracy: 0.9089
 Site-MNIST                     (1) | Val  Loss: 0.0118 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0271 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4664 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4951 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3111 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2111 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1760 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1887 | Val  Acc: 0.9314
 Site-MNIST                     (1) | Val  Loss: 0.2323 | Val  Acc: 0.9399
 Site-MNIST                     (1) | Val  Loss: 0.2227 | Val  Acc: 0.9456
 Site-USPS                      (0) | Val  Loss: 0.0983 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.4519 | Val  Acc: 0.8889
 Site-USPS                      (0) | Val  Loss: 0.4833 | Val  Acc: 0.7812
 Site-USPS                      (0) | Val  Loss: 0.4084 | Val  Acc: 0.8276
 Site-USPS                      (0) | Val  Loss: 0.3400 | Val  Acc: 0.9048
 Site-USPS                      (0) | Val  Loss: 0.2613 | Val  Acc: 0.9048
 Site-SynthDigits               (2) | Val  Loss: 0.4236 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.3189 | Val  Acc: 0.9265
 Site-SynthDigits               (2) | Val  Loss: 0.4172 | Val  Acc: 0.8934
 Site-MNIST_M                   (3) | Val  Loss: 0.7792 | Val  Acc: 0.8667
 Site-MNIST_M                   (3) | Val  Loss: 0.6473 | Val  Acc: 0.9012
 Site-SVHN                      (4) | Val  Loss: 0.6685 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8977
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.9314
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.9399
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.9456
 Best site-USPS                     (0)  | Epoch:40 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:40 | Val Acc: 0.8889
 Best site-USPS                     (0)  | Epoch:40 | Val Acc: 0.7812
 Best site-USPS                     (0)  | Epoch:40 | Val Acc: 0.8276
 Best site-USPS                     (0)  | Epoch:40 | Val Acc: 0.9048
 Best site-USPS                     (0)  | Epoch:40 | Val Acc: 0.9048
 Best site-SynthDigits              (2)  | Epoch:40 | Val Acc: 0.8919
 Best site-SynthDigits              (2)  | Epoch:40 | Val Acc: 0.9265
 Best site-SynthDigits              (2)  | Epoch:40 | Val Acc: 0.8934
 Best site-MNIST_M                  (3)  | Epoch:40 | Val Acc: 0.8667
 Best site-MNIST_M                  (3)  | Epoch:40 | Val Acc: 0.9012
 Best site-SVHN                     (4)  | Epoch:40 | Val Acc: 0.7857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 41 ============
cnt=[10, 6, 3, 2, 1, ]
cnt=[6, 10, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (0) | Train Loss: 0.5639 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2889 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1342 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1358 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.1578 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.1558 | Train Acc: 0.9683
 Site-MNIST                     (0) | Train Loss: 0.1632 | Train Acc: 0.9648
 Site-MNIST                     (0) | Train Loss: 0.2287 | Train Acc: 0.9462
 Site-MNIST                     (0) | Train Loss: 0.2118 | Train Acc: 0.9470
 Site-MNIST                     (0) | Train Loss: 0.1756 | Train Acc: 0.9615
 Site-USPS                      (1) | Train Loss: 0.2462 | Train Acc: 0.9750
 Site-USPS                      (1) | Train Loss: 0.1782 | Train Acc: 0.9167
 Site-USPS                      (1) | Train Loss: 0.2111 | Train Acc: 0.9225
 Site-USPS                      (1) | Train Loss: 0.2969 | Train Acc: 0.8841
 Site-USPS                      (1) | Train Loss: 0.2261 | Train Acc: 0.9405
 Site-USPS                      (1) | Train Loss: 0.2452 | Train Acc: 0.9352
 Site-SynthDigits               (2) | Train Loss: 0.5326 | Train Acc: 0.8411
 Site-SynthDigits               (2) | Train Loss: 0.4177 | Train Acc: 0.8938
 Site-SynthDigits               (2) | Train Loss: 0.3927 | Train Acc: 0.9185
 Site-MNIST_M                   (3) | Train Loss: 0.7074 | Train Acc: 0.8066
 Site-MNIST_M                   (3) | Train Loss: 0.7105 | Train Acc: 0.7951
 Site-SVHN                      (4) | Train Loss: 0.8216 | Train Acc: 0.7270
Average Train Accuracy: 0.9067
 Site-MNIST                     (0) | Val  Loss: 0.0120 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0282 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4802 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5088 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3153 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2075 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1694 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1841 | Val  Acc: 0.9314
 Site-MNIST                     (0) | Val  Loss: 0.2280 | Val  Acc: 0.9399
 Site-MNIST                     (0) | Val  Loss: 0.2193 | Val  Acc: 0.9486
 Site-USPS                      (1) | Val  Loss: 0.0965 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.4644 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.4977 | Val  Acc: 0.8125
 Site-USPS                      (1) | Val  Loss: 0.4110 | Val  Acc: 0.8276
 Site-USPS                      (1) | Val  Loss: 0.3426 | Val  Acc: 0.9048
 Site-USPS                      (1) | Val  Loss: 0.2664 | Val  Acc: 0.8889
 Site-SynthDigits               (2) | Val  Loss: 0.4188 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.3046 | Val  Acc: 0.9265
 Site-SynthDigits               (2) | Val  Loss: 0.4093 | Val  Acc: 0.9016
 Site-MNIST_M                   (3) | Val  Loss: 0.7729 | Val  Acc: 0.8667
 Site-MNIST_M                   (3) | Val  Loss: 0.6409 | Val  Acc: 0.9012
 Site-SVHN                      (4) | Val  Loss: 0.6508 | Val  Acc: 0.7857
Average Valid Accuracy: 0.9001
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.9314
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.9399
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.9486
 Best site-USPS                     (1)  | Epoch:41 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:41 | Val Acc: 0.8889
 Best site-USPS                     (1)  | Epoch:41 | Val Acc: 0.8125
 Best site-USPS                     (1)  | Epoch:41 | Val Acc: 0.8276
 Best site-USPS                     (1)  | Epoch:41 | Val Acc: 0.9048
 Best site-USPS                     (1)  | Epoch:41 | Val Acc: 0.8889
 Best site-SynthDigits              (2)  | Epoch:41 | Val Acc: 0.9189
 Best site-SynthDigits              (2)  | Epoch:41 | Val Acc: 0.9265
 Best site-SynthDigits              (2)  | Epoch:41 | Val Acc: 0.9016
 Best site-MNIST_M                  (3)  | Epoch:41 | Val Acc: 0.8667
 Best site-MNIST_M                  (3)  | Epoch:41 | Val Acc: 0.9012
 Best site-SVHN                     (4)  | Epoch:41 | Val Acc: 0.7857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 42 ============
cnt=[6, 10, 3, 2, 1, ]
cnt=[9, 6, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (1) | Train Loss: 0.5466 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2906 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1333 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1357 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3592 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1576 | Train Acc: 0.9683
 Site-MNIST                     (1) | Train Loss: 0.1649 | Train Acc: 0.9604
 Site-MNIST                     (1) | Train Loss: 0.2344 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.2108 | Train Acc: 0.9416
 Site-MNIST                     (1) | Train Loss: 0.1737 | Train Acc: 0.9600
 Site-USPS                      (0) | Train Loss: 0.2502 | Train Acc: 0.9750
 Site-USPS                      (0) | Train Loss: 0.2258 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.9511 | Train Acc: 0.9302
 Site-USPS                      (0) | Train Loss: 0.2845 | Train Acc: 0.8970
 Site-USPS                      (0) | Train Loss: 0.2205 | Train Acc: 0.9452
 Site-USPS                      (0) | Train Loss: 0.2411 | Train Acc: 0.9378
 Site-SynthDigits               (2) | Train Loss: 0.5548 | Train Acc: 0.8808
 Site-SynthDigits               (2) | Train Loss: 0.4571 | Train Acc: 0.9084
 Site-SynthDigits               (2) | Train Loss: 0.3930 | Train Acc: 0.9185
 Site-MNIST_M                   (3) | Train Loss: 0.6735 | Train Acc: 0.8287
 Site-MNIST_M                   (3) | Train Loss: 0.6927 | Train Acc: 0.8165
 Site-SVHN                      (4) | Train Loss: 0.8227 | Train Acc: 0.7234
Average Train Accuracy: 0.9114
 Site-MNIST                     (1) | Val  Loss: 0.0107 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0278 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.5082 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5195 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3249 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2054 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1683 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1825 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.2268 | Val  Acc: 0.9399
 Site-MNIST                     (1) | Val  Loss: 0.2181 | Val  Acc: 0.9426
 Site-USPS                      (0) | Val  Loss: 0.0870 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.4454 | Val  Acc: 0.8889
 Site-USPS                      (0) | Val  Loss: 0.4821 | Val  Acc: 0.8125
 Site-USPS                      (0) | Val  Loss: 0.4097 | Val  Acc: 0.8276
 Site-USPS                      (0) | Val  Loss: 0.3405 | Val  Acc: 0.8857
 Site-USPS                      (0) | Val  Loss: 0.2597 | Val  Acc: 0.9048
 Site-SynthDigits               (2) | Val  Loss: 0.4237 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.2997 | Val  Acc: 0.9265
 Site-SynthDigits               (2) | Val  Loss: 0.4003 | Val  Acc: 0.8934
 Site-MNIST_M                   (3) | Val  Loss: 0.7299 | Val  Acc: 0.8667
 Site-MNIST_M                   (3) | Val  Loss: 0.6137 | Val  Acc: 0.9012
 Site-SVHN                      (4) | Val  Loss: 0.6608 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8970
============ Train epoch 43 ============
cnt=[3, 10, 6, 2, 1, ]
cnt=[2, 1, 6, 4, 9, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (1) | Train Loss: 0.5268 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2943 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1289 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1393 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3592 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1543 | Train Acc: 0.9683
 Site-MNIST                     (1) | Train Loss: 0.1597 | Train Acc: 0.9648
 Site-MNIST                     (1) | Train Loss: 0.2059 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2171 | Train Acc: 0.9416
 Site-MNIST                     (1) | Train Loss: 0.1717 | Train Acc: 0.9615
 Site-USPS                      (2) | Train Loss: 0.2306 | Train Acc: 0.9750
 Site-USPS                      (2) | Train Loss: 0.2753 | Train Acc: 0.9167
 Site-USPS                      (2) | Train Loss: 0.5193 | Train Acc: 0.9457
 Site-USPS                      (2) | Train Loss: 0.2725 | Train Acc: 0.8927
 Site-USPS                      (2) | Train Loss: 0.2039 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2331 | Train Acc: 0.9352
 Site-SynthDigits               (0) | Train Loss: 0.5006 | Train Acc: 0.8477
 Site-SynthDigits               (0) | Train Loss: 0.4525 | Train Acc: 0.9084
 Site-SynthDigits               (0) | Train Loss: 0.3960 | Train Acc: 0.9185
 Site-MNIST_M                   (3) | Train Loss: 0.6563 | Train Acc: 0.8453
 Site-MNIST_M                   (3) | Train Loss: 0.6148 | Train Acc: 0.8440
 Site-SVHN                      (4) | Train Loss: 0.7998 | Train Acc: 0.7447
Average Train Accuracy: 0.9140
 Site-MNIST                     (1) | Val  Loss: 0.0103 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0245 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.5070 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5125 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3223 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2040 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1682 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1805 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.2250 | Val  Acc: 0.9454
 Site-MNIST                     (1) | Val  Loss: 0.2143 | Val  Acc: 0.9486
 Site-USPS                      (2) | Val  Loss: 0.0893 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4314 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.4567 | Val  Acc: 0.8125
 Site-USPS                      (2) | Val  Loss: 0.3993 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.3284 | Val  Acc: 0.8762
 Site-USPS                      (2) | Val  Loss: 0.2450 | Val  Acc: 0.9153
 Site-SynthDigits               (0) | Val  Loss: 0.4197 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.2877 | Val  Acc: 0.9265
 Site-SynthDigits               (0) | Val  Loss: 0.3928 | Val  Acc: 0.9016
 Site-MNIST_M                   (3) | Val  Loss: 0.7086 | Val  Acc: 0.8444
 Site-MNIST_M                   (3) | Val  Loss: 0.5993 | Val  Acc: 0.9012
 Site-SVHN                      (4) | Val  Loss: 0.6686 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8962
============ Train epoch 44 ============
cnt=[10, 6, 2, 3, 1, ]
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (0) | Train Loss: 0.5374 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2967 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1155 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1293 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.1802 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1472 | Train Acc: 0.9683
 Site-MNIST                     (0) | Train Loss: 0.1794 | Train Acc: 0.9692
 Site-MNIST                     (0) | Train Loss: 0.2108 | Train Acc: 0.9389
 Site-MNIST                     (0) | Train Loss: 0.2064 | Train Acc: 0.9402
 Site-MNIST                     (0) | Train Loss: 0.1668 | Train Acc: 0.9600
 Site-USPS                      (1) | Train Loss: 0.2306 | Train Acc: 0.9750
 Site-USPS                      (1) | Train Loss: 0.2786 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.1705 | Train Acc: 0.9380
 Site-USPS                      (1) | Train Loss: 0.2778 | Train Acc: 0.8884
 Site-USPS                      (1) | Train Loss: 0.2030 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.2270 | Train Acc: 0.9405
 Site-SynthDigits               (3) | Train Loss: 0.5497 | Train Acc: 0.8543
 Site-SynthDigits               (3) | Train Loss: 0.4396 | Train Acc: 0.9084
 Site-SynthDigits               (3) | Train Loss: 0.3809 | Train Acc: 0.9145
 Site-MNIST_M                   (2) | Train Loss: 0.6514 | Train Acc: 0.8343
 Site-MNIST_M                   (2) | Train Loss: 0.6216 | Train Acc: 0.8349
 Site-SVHN                      (4) | Train Loss: 0.7913 | Train Acc: 0.7589
Average Train Accuracy: 0.9135
 Site-MNIST                     (0) | Val  Loss: 0.0119 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0245 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4949 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5069 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3171 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2002 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1638 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1766 | Val  Acc: 0.9314
 Site-MNIST                     (0) | Val  Loss: 0.2217 | Val  Acc: 0.9454
 Site-MNIST                     (0) | Val  Loss: 0.2097 | Val  Acc: 0.9517
 Site-USPS                      (1) | Val  Loss: 0.0941 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.4337 | Val  Acc: 0.8333
 Site-USPS                      (1) | Val  Loss: 0.4602 | Val  Acc: 0.8125
 Site-USPS                      (1) | Val  Loss: 0.3954 | Val  Acc: 0.8448
 Site-USPS                      (1) | Val  Loss: 0.3283 | Val  Acc: 0.8952
 Site-USPS                      (1) | Val  Loss: 0.2448 | Val  Acc: 0.9101
 Site-SynthDigits               (3) | Val  Loss: 0.4055 | Val  Acc: 0.9189
 Site-SynthDigits               (3) | Val  Loss: 0.2822 | Val  Acc: 0.9118
 Site-SynthDigits               (3) | Val  Loss: 0.3868 | Val  Acc: 0.9098
 Site-MNIST_M                   (2) | Val  Loss: 0.7183 | Val  Acc: 0.8667
 Site-MNIST_M                   (2) | Val  Loss: 0.6007 | Val  Acc: 0.9012
 Site-SVHN                      (4) | Val  Loss: 0.6589 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8997
============ Train epoch 45 ============
cnt=[6, 10, 3, 2, 1, ]
cnt=[6, 10, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (1) | Train Loss: 0.5172 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3015 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1061 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1314 | Train Acc: 0.9474
 Site-MNIST                     (1) | Train Loss: 0.1918 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1401 | Train Acc: 0.9683
 Site-MNIST                     (1) | Train Loss: 0.1645 | Train Acc: 0.9648
 Site-MNIST                     (1) | Train Loss: 0.2108 | Train Acc: 0.9364
 Site-MNIST                     (1) | Train Loss: 0.2005 | Train Acc: 0.9348
 Site-MNIST                     (1) | Train Loss: 0.1618 | Train Acc: 0.9600
 Site-USPS                      (0) | Train Loss: 0.2421 | Train Acc: 0.9750
 Site-USPS                      (0) | Train Loss: 0.4653 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.1651 | Train Acc: 0.9380
 Site-USPS                      (0) | Train Loss: 0.2930 | Train Acc: 0.8927
 Site-USPS                      (0) | Train Loss: 0.2092 | Train Acc: 0.9524
 Site-USPS                      (0) | Train Loss: 0.2268 | Train Acc: 0.9418
 Site-SynthDigits               (2) | Train Loss: 0.4750 | Train Acc: 0.8609
 Site-SynthDigits               (2) | Train Loss: 0.4266 | Train Acc: 0.9011
 Site-SynthDigits               (2) | Train Loss: 0.3786 | Train Acc: 0.9206
 Site-MNIST_M                   (3) | Train Loss: 0.6402 | Train Acc: 0.8508
 Site-MNIST_M                   (3) | Train Loss: 0.6016 | Train Acc: 0.8440
 Site-SVHN                      (4) | Train Loss: 0.7899 | Train Acc: 0.7447
Average Train Accuracy: 0.9128
 Site-MNIST                     (1) | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0253 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.5079 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5171 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3209 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.1975 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1604 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1732 | Val  Acc: 0.9314
 Site-MNIST                     (1) | Val  Loss: 0.2199 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2067 | Val  Acc: 0.9426
 Site-USPS                      (0) | Val  Loss: 0.0874 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.4306 | Val  Acc: 0.8889
 Site-USPS                      (0) | Val  Loss: 0.4623 | Val  Acc: 0.8125
 Site-USPS                      (0) | Val  Loss: 0.3921 | Val  Acc: 0.8276
 Site-USPS                      (0) | Val  Loss: 0.3259 | Val  Acc: 0.9048
 Site-USPS                      (0) | Val  Loss: 0.2456 | Val  Acc: 0.9101
 Site-SynthDigits               (2) | Val  Loss: 0.4050 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.2834 | Val  Acc: 0.9265
 Site-SynthDigits               (2) | Val  Loss: 0.3848 | Val  Acc: 0.8934
 Site-MNIST_M                   (3) | Val  Loss: 0.6984 | Val  Acc: 0.8667
 Site-MNIST_M                   (3) | Val  Loss: 0.5848 | Val  Acc: 0.9012
 Site-SVHN                      (4) | Val  Loss: 0.6410 | Val  Acc: 0.8000
Average Valid Accuracy: 0.9009
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.9314
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.9344
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.9426
 Best site-USPS                     (0)  | Epoch:45 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:45 | Val Acc: 0.8889
 Best site-USPS                     (0)  | Epoch:45 | Val Acc: 0.8125
 Best site-USPS                     (0)  | Epoch:45 | Val Acc: 0.8276
 Best site-USPS                     (0)  | Epoch:45 | Val Acc: 0.9048
 Best site-USPS                     (0)  | Epoch:45 | Val Acc: 0.9101
 Best site-SynthDigits              (2)  | Epoch:45 | Val Acc: 0.9189
 Best site-SynthDigits              (2)  | Epoch:45 | Val Acc: 0.9265
 Best site-SynthDigits              (2)  | Epoch:45 | Val Acc: 0.8934
 Best site-MNIST_M                  (3)  | Epoch:45 | Val Acc: 0.8667
 Best site-MNIST_M                  (3)  | Epoch:45 | Val Acc: 0.9012
 Best site-SVHN                     (4)  | Epoch:45 | Val Acc: 0.8000
 Test site-MNIST                     (1)| Epoch:45 | Test Acc: 0.9407
 Test site-USPS                      (0)| Epoch:45 | Test Acc: 0.9376
 Test site-SynthDigits               (2)| Epoch:45 | Test Acc: 0.8827
 Test site-MNIST_M                   (3)| Epoch:45 | Test Acc: 0.7141
 Test site-SVHN                      (4)| Epoch:45 | Test Acc: 0.6276
MNIST: 0.9407, USPS: 0.9376, SynthDigits: 0.8827, MNIST_M: 0.7141, SVHN: 0.6276, 
Average Test Accuracy(group): 0.8206, Average Test Accuracy(individual): 0.8971,
domain std=0.1270, cluster std=0.1270, individual std=0.0877, 
Average Test Accuracy: 0.8206
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 46 ============
cnt=[10, 3, 6, 2, 1, ]
cnt=[6, 10, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-MNIST                     (0) | Train Loss: 0.5040 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2976 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1016 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1369 | Train Acc: 0.9474
 Site-MNIST                     (0) | Train Loss: 0.1857 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1399 | Train Acc: 0.9683
 Site-MNIST                     (0) | Train Loss: 0.1528 | Train Acc: 0.9648
 Site-MNIST                     (0) | Train Loss: 0.2261 | Train Acc: 0.9413
 Site-MNIST                     (0) | Train Loss: 0.2006 | Train Acc: 0.9375
 Site-MNIST                     (0) | Train Loss: 0.1609 | Train Acc: 0.9592
 Site-USPS                      (2) | Train Loss: 0.2246 | Train Acc: 0.9750
 Site-USPS                      (2) | Train Loss: 0.1638 | Train Acc: 0.9167
 Site-USPS                      (2) | Train Loss: 0.1614 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.2717 | Train Acc: 0.8970
 Site-USPS                      (2) | Train Loss: 0.2040 | Train Acc: 0.9452
 Site-USPS                      (2) | Train Loss: 0.2233 | Train Acc: 0.9352
 Site-SynthDigits               (1) | Train Loss: 0.4309 | Train Acc: 0.8742
 Site-SynthDigits               (1) | Train Loss: 0.4097 | Train Acc: 0.9084
 Site-SynthDigits               (1) | Train Loss: 0.3662 | Train Acc: 0.9226
 Site-MNIST_M                   (3) | Train Loss: 0.6437 | Train Acc: 0.8287
 Site-MNIST_M                   (3) | Train Loss: 0.6015 | Train Acc: 0.8287
 Site-SVHN                      (4) | Train Loss: 0.7875 | Train Acc: 0.7447
Average Train Accuracy: 0.9106
 Site-MNIST                     (0) | Val  Loss: 0.0115 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0233 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.5172 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5251 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3261 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2003 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1603 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1726 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.2193 | Val  Acc: 0.9399
 Site-MNIST                     (0) | Val  Loss: 0.2046 | Val  Acc: 0.9456
 Site-USPS                      (2) | Val  Loss: 0.0814 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4107 | Val  Acc: 0.8889
 Site-USPS                      (2) | Val  Loss: 0.4461 | Val  Acc: 0.8125
 Site-USPS                      (2) | Val  Loss: 0.3841 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.3207 | Val  Acc: 0.8952
 Site-USPS                      (2) | Val  Loss: 0.2416 | Val  Acc: 0.9101
 Site-SynthDigits               (1) | Val  Loss: 0.4021 | Val  Acc: 0.9189
 Site-SynthDigits               (1) | Val  Loss: 0.2789 | Val  Acc: 0.9118
 Site-SynthDigits               (1) | Val  Loss: 0.3811 | Val  Acc: 0.9016
 Site-MNIST_M                   (3) | Val  Loss: 0.6930 | Val  Acc: 0.8889
 Site-MNIST_M                   (3) | Val  Loss: 0.5782 | Val  Acc: 0.9012
 Site-SVHN                      (4) | Val  Loss: 0.6317 | Val  Acc: 0.8000
Average Valid Accuracy: 0.9028
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.9412
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.9399
 Best site-MNIST                    (0)  | Epoch:46 | Val Acc: 0.9456
 Best site-USPS                     (2)  | Epoch:46 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:46 | Val Acc: 0.8889
 Best site-USPS                     (2)  | Epoch:46 | Val Acc: 0.8125
 Best site-USPS                     (2)  | Epoch:46 | Val Acc: 0.8448
 Best site-USPS                     (2)  | Epoch:46 | Val Acc: 0.8952
 Best site-USPS                     (2)  | Epoch:46 | Val Acc: 0.9101
 Best site-SynthDigits              (1)  | Epoch:46 | Val Acc: 0.9189
 Best site-SynthDigits              (1)  | Epoch:46 | Val Acc: 0.9118
 Best site-SynthDigits              (1)  | Epoch:46 | Val Acc: 0.9016
 Best site-MNIST_M                  (3)  | Epoch:46 | Val Acc: 0.8889
 Best site-MNIST_M                  (3)  | Epoch:46 | Val Acc: 0.9012
 Best site-SVHN                     (4)  | Epoch:46 | Val Acc: 0.8000
 Test site-MNIST                     (0)| Epoch:46 | Test Acc: 0.9404
 Test site-USPS                      (2)| Epoch:46 | Test Acc: 0.9387
 Test site-SynthDigits               (1)| Epoch:46 | Test Acc: 0.8823
 Test site-MNIST_M                   (3)| Epoch:46 | Test Acc: 0.7156
 Test site-SVHN                      (4)| Epoch:46 | Test Acc: 0.6280
MNIST: 0.9404, USPS: 0.9387, SynthDigits: 0.8823, MNIST_M: 0.7156, SVHN: 0.6280, 
Average Test Accuracy(group): 0.8210, Average Test Accuracy(individual): 0.8974,
domain std=0.1267, cluster std=0.1267, individual std=0.0874, 
Average Test Accuracy: 0.8210
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 47 ============
cnt=[10, 3, 6, 2, 1, ]
cnt=[6, 10, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-MNIST                     (0) | Train Loss: 0.5102 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2868 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.0972 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1337 | Train Acc: 0.9474
 Site-MNIST                     (0) | Train Loss: 0.1535 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1369 | Train Acc: 0.9683
 Site-MNIST                     (0) | Train Loss: 0.1518 | Train Acc: 0.9692
 Site-MNIST                     (0) | Train Loss: 0.2115 | Train Acc: 0.9413
 Site-MNIST                     (0) | Train Loss: 0.2015 | Train Acc: 0.9375
 Site-MNIST                     (0) | Train Loss: 0.1630 | Train Acc: 0.9600
 Site-USPS                      (2) | Train Loss: 0.2294 | Train Acc: 0.9750
 Site-USPS                      (2) | Train Loss: 0.2818 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1525 | Train Acc: 0.9457
 Site-USPS                      (2) | Train Loss: 0.2872 | Train Acc: 0.8970
 Site-USPS                      (2) | Train Loss: 0.1906 | Train Acc: 0.9476
 Site-USPS                      (2) | Train Loss: 0.2164 | Train Acc: 0.9418
 Site-SynthDigits               (1) | Train Loss: 0.4712 | Train Acc: 0.8675
 Site-SynthDigits               (1) | Train Loss: 0.4021 | Train Acc: 0.9011
 Site-SynthDigits               (1) | Train Loss: 0.3766 | Train Acc: 0.9226
 Site-MNIST_M                   (3) | Train Loss: 0.6471 | Train Acc: 0.8453
 Site-MNIST_M                   (3) | Train Loss: 0.6074 | Train Acc: 0.8502
 Site-SVHN                      (4) | Train Loss: 0.7743 | Train Acc: 0.7695
Average Train Accuracy: 0.9152
 Site-MNIST                     (0) | Val  Loss: 0.0110 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0221 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.5053 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5019 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3132 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1968 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1602 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1711 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.2177 | Val  Acc: 0.9454
 Site-MNIST                     (0) | Val  Loss: 0.2021 | Val  Acc: 0.9486
 Site-USPS                      (2) | Val  Loss: 0.0894 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4094 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.4376 | Val  Acc: 0.8125
 Site-USPS                      (2) | Val  Loss: 0.3815 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.3194 | Val  Acc: 0.8952
 Site-USPS                      (2) | Val  Loss: 0.2400 | Val  Acc: 0.9101
 Site-SynthDigits               (1) | Val  Loss: 0.3932 | Val  Acc: 0.9189
 Site-SynthDigits               (1) | Val  Loss: 0.2741 | Val  Acc: 0.9118
 Site-SynthDigits               (1) | Val  Loss: 0.3774 | Val  Acc: 0.9098
 Site-MNIST_M                   (3) | Val  Loss: 0.6975 | Val  Acc: 0.8667
 Site-MNIST_M                   (3) | Val  Loss: 0.5752 | Val  Acc: 0.9012
 Site-SVHN                      (4) | Val  Loss: 0.6187 | Val  Acc: 0.8429
Average Valid Accuracy: 0.9019
 Test site-MNIST                     (0)| Epoch:46 | Test Acc: 0.9406
 Test site-USPS                      (2)| Epoch:46 | Test Acc: 0.9387
 Test site-SynthDigits               (1)| Epoch:46 | Test Acc: 0.8835
 Test site-MNIST_M                   (3)| Epoch:46 | Test Acc: 0.7204
 Test site-SVHN                      (4)| Epoch:46 | Test Acc: 0.6338
MNIST: 0.9406, USPS: 0.9387, SynthDigits: 0.8835, MNIST_M: 0.7204, SVHN: 0.6338, 
Average Test Accuracy(group): 0.8234, Average Test Accuracy(individual): 0.8983,
domain std=0.1243, cluster std=0.1243, individual std=0.0857, 
Average Test Accuracy: 0.8234
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 48 ============
cnt=[6, 10, 2, 3, 1, ]
cnt=[6, 1, 9, 2, 4, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-MNIST                     (1) | Train Loss: 0.5083 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2860 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.0962 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1337 | Train Acc: 0.9474
 Site-MNIST                     (1) | Train Loss: 0.1547 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1394 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1667 | Train Acc: 0.9692
 Site-MNIST                     (1) | Train Loss: 0.2120 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.1956 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.1588 | Train Acc: 0.9623
 Site-USPS                      (0) | Train Loss: 0.2358 | Train Acc: 0.9750
 Site-USPS                      (0) | Train Loss: 0.1946 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.1659 | Train Acc: 0.9225
 Site-USPS                      (0) | Train Loss: 0.2801 | Train Acc: 0.9142
 Site-USPS                      (0) | Train Loss: 0.2043 | Train Acc: 0.9524
 Site-USPS                      (0) | Train Loss: 0.2173 | Train Acc: 0.9431
 Site-SynthDigits               (3) | Train Loss: 0.4663 | Train Acc: 0.8675
 Site-SynthDigits               (3) | Train Loss: 0.3732 | Train Acc: 0.9158
 Site-SynthDigits               (3) | Train Loss: 0.3627 | Train Acc: 0.9226
 Site-MNIST_M                   (2) | Train Loss: 0.6187 | Train Acc: 0.8453
 Site-MNIST_M                   (2) | Train Loss: 0.5958 | Train Acc: 0.8532
 Site-SVHN                      (4) | Train Loss: 0.7843 | Train Acc: 0.7518
Average Train Accuracy: 0.9151
 Site-MNIST                     (1) | Val  Loss: 0.0104 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0223 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4881 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4903 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3041 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.1958 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1608 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1705 | Val  Acc: 0.9412
 Site-MNIST                     (1) | Val  Loss: 0.2153 | Val  Acc: 0.9454
 Site-MNIST                     (1) | Val  Loss: 0.1997 | Val  Acc: 0.9486
 Site-USPS                      (0) | Val  Loss: 0.0931 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.4086 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.4290 | Val  Acc: 0.8125
 Site-USPS                      (0) | Val  Loss: 0.3720 | Val  Acc: 0.8448
 Site-USPS                      (0) | Val  Loss: 0.3126 | Val  Acc: 0.8857
 Site-USPS                      (0) | Val  Loss: 0.2353 | Val  Acc: 0.9048
 Site-SynthDigits               (3) | Val  Loss: 0.3794 | Val  Acc: 0.9189
 Site-SynthDigits               (3) | Val  Loss: 0.2695 | Val  Acc: 0.9265
 Site-SynthDigits               (3) | Val  Loss: 0.3703 | Val  Acc: 0.9180
 Site-MNIST_M                   (2) | Val  Loss: 0.6770 | Val  Acc: 0.8667
 Site-MNIST_M                   (2) | Val  Loss: 0.5629 | Val  Acc: 0.9012
 Site-SVHN                      (4) | Val  Loss: 0.6192 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8978
 Test site-MNIST                     (1)| Epoch:47 | Test Acc: 0.9407
 Test site-USPS                      (0)| Epoch:47 | Test Acc: 0.9376
 Test site-SynthDigits               (3)| Epoch:47 | Test Acc: 0.8834
 Test site-MNIST_M                   (2)| Epoch:47 | Test Acc: 0.7241
 Test site-SVHN                      (4)| Epoch:47 | Test Acc: 0.6332
MNIST: 0.9407, USPS: 0.9376, SynthDigits: 0.8834, MNIST_M: 0.7241, SVHN: 0.6332, 
Average Test Accuracy(group): 0.8238, Average Test Accuracy(individual): 0.8984,
domain std=0.1236, cluster std=0.1236, individual std=0.0850, 
Average Test Accuracy: 0.8238
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
============ Train epoch 49 ============
cnt=[10, 6, 2, 3, 1, ]
cnt=[4, 1, 9, 6, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-MNIST                     (0) | Train Loss: 0.5305 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2931 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.0856 | Train Acc: 1.0000
 Site-MNIST                     (0) | Train Loss: 0.1281 | Train Acc: 0.9474
 Site-MNIST                     (0) | Train Loss: 0.2175 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.1347 | Train Acc: 0.9683
 Site-MNIST                     (0) | Train Loss: 0.1576 | Train Acc: 0.9692
 Site-MNIST                     (0) | Train Loss: 0.2183 | Train Acc: 0.9438
 Site-MNIST                     (0) | Train Loss: 0.1949 | Train Acc: 0.9402
 Site-MNIST                     (0) | Train Loss: 0.1541 | Train Acc: 0.9600
 Site-USPS                      (1) | Train Loss: 0.2352 | Train Acc: 0.9500
 Site-USPS                      (1) | Train Loss: 0.1820 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.1935 | Train Acc: 0.9535
 Site-USPS                      (1) | Train Loss: 0.2673 | Train Acc: 0.8970
 Site-USPS                      (1) | Train Loss: 0.1913 | Train Acc: 0.9500
 Site-USPS                      (1) | Train Loss: 0.2146 | Train Acc: 0.9418
 Site-SynthDigits               (3) | Train Loss: 0.4625 | Train Acc: 0.8675
 Site-SynthDigits               (3) | Train Loss: 0.3788 | Train Acc: 0.9048
 Site-SynthDigits               (3) | Train Loss: 0.3642 | Train Acc: 0.9246
 Site-MNIST_M                   (2) | Train Loss: 0.6291 | Train Acc: 0.8564
 Site-MNIST_M                   (2) | Train Loss: 0.5903 | Train Acc: 0.8654
 Site-SVHN                      (4) | Train Loss: 0.7725 | Train Acc: 0.7553
Average Train Accuracy: 0.9184
 Site-MNIST                     (0) | Val  Loss: 0.0112 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0243 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4805 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4918 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3029 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1926 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1603 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1687 | Val  Acc: 0.9412
 Site-MNIST                     (0) | Val  Loss: 0.2139 | Val  Acc: 0.9399
 Site-MNIST                     (0) | Val  Loss: 0.1973 | Val  Acc: 0.9456
 Site-USPS                      (1) | Val  Loss: 0.0929 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3943 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.4113 | Val  Acc: 0.8438
 Site-USPS                      (1) | Val  Loss: 0.3601 | Val  Acc: 0.8793
 Site-USPS                      (1) | Val  Loss: 0.3044 | Val  Acc: 0.9048
 Site-USPS                      (1) | Val  Loss: 0.2297 | Val  Acc: 0.9259
 Site-SynthDigits               (3) | Val  Loss: 0.3779 | Val  Acc: 0.9189
 Site-SynthDigits               (3) | Val  Loss: 0.2688 | Val  Acc: 0.9118
 Site-SynthDigits               (3) | Val  Loss: 0.3690 | Val  Acc: 0.9180
 Site-MNIST_M                   (2) | Val  Loss: 0.6772 | Val  Acc: 0.8667
 Site-MNIST_M                   (2) | Val  Loss: 0.5616 | Val  Acc: 0.8889
 Site-SVHN                      (4) | Val  Loss: 0.6361 | Val  Acc: 0.8000
Average Valid Accuracy: 0.9061
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.9412
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.9399
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.9456
 Best site-USPS                     (1)  | Epoch:49 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:49 | Val Acc: 0.8889
 Best site-USPS                     (1)  | Epoch:49 | Val Acc: 0.8438
 Best site-USPS                     (1)  | Epoch:49 | Val Acc: 0.8793
 Best site-USPS                     (1)  | Epoch:49 | Val Acc: 0.9048
 Best site-USPS                     (1)  | Epoch:49 | Val Acc: 0.9259
 Best site-SynthDigits              (3)  | Epoch:49 | Val Acc: 0.9189
 Best site-SynthDigits              (3)  | Epoch:49 | Val Acc: 0.9118
 Best site-SynthDigits              (3)  | Epoch:49 | Val Acc: 0.9180
 Best site-MNIST_M                  (2)  | Epoch:49 | Val Acc: 0.8667
 Best site-MNIST_M                  (2)  | Epoch:49 | Val Acc: 0.8889
 Best site-SVHN                     (4)  | Epoch:49 | Val Acc: 0.8000
 Test site-MNIST                     (0)| Epoch:49 | Test Acc: 0.9413
 Test site-USPS                      (1)| Epoch:49 | Test Acc: 0.9430
 Test site-SynthDigits               (3)| Epoch:49 | Test Acc: 0.8828
 Test site-MNIST_M                   (2)| Epoch:49 | Test Acc: 0.7196
 Test site-SVHN                      (4)| Epoch:49 | Test Acc: 0.6340
MNIST: 0.9413, USPS: 0.9430, SynthDigits: 0.8828, MNIST_M: 0.7196, SVHN: 0.6340, 
Average Test Accuracy(group): 0.8241, Average Test Accuracy(individual): 0.8997,
domain std=0.1252, cluster std=0.1252, individual std=0.0866, 
Average Test Accuracy: 0.8241
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0/ccop_q=1...
===2023-07-29 04:08:02===
===2023-07-29 04:08:19===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     (0)| Epoch:49 | Test Acc: 0.9413
 Test site-USPS                      (1)| Epoch:49 | Test Acc: 0.9430
 Test site-SynthDigits               (3)| Epoch:49 | Test Acc: 0.8828
 Test site-MNIST_M                   (2)| Epoch:49 | Test Acc: 0.7196
 Test site-SVHN                      (4)| Epoch:49 | Test Acc: 0.6340
MNIST: 0.9413, USPS: 0.9430, SynthDigits: 0.8828, MNIST_M: 0.7196, SVHN: 0.6340, 
Average Test Accuracy(group): 0.8241, Average Test Accuracy(individual): 0.8997,
domain std=0.1252, cluster std=0.1252, individual std=0.0866, 
