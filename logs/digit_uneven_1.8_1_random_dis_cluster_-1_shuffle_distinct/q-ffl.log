===2023-07-02 15:07:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
============ Train epoch 0 ============
denominator: 14425.8427734375
 Site-USPS                          | Train Loss: 2.1559 | Train Acc: 0.5736
 Site-MNIST                         | Train Loss: 2.1676 | Train Acc: 0.5409
 Site-SynthDigits                   | Train Loss: 2.2679 | Train Acc: 0.1967
 Site-SVHN                          | Train Loss: 2.2809 | Train Acc: 0.1379
 Site-MNIST_M                       | Train Loss: 2.2868 | Train Acc: 0.1250
Average Train Accuracy: 0.3148
 Site-USPS                          | Val  Loss: 2.1638 | Val  Acc: 0.5455
 Site-MNIST                         | Val  Loss: 2.1637 | Val  Acc: 0.5455
 Site-SynthDigits                   | Val  Loss: 2.2683 | Val  Acc: 0.1758
 Site-SVHN                          | Val  Loss: 2.2824 | Val  Acc: 0.1400
 Site-MNIST_M                       | Val  Loss: 2.2854 | Val  Acc: 0.1786
Average Valid Accuracy: 0.3171
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5455
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5455
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1758
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1400
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 1 ============
denominator: 14087.966796875
 Site-USPS                          | Train Loss: 2.0023 | Train Acc: 0.6796
 Site-MNIST                         | Train Loss: 2.0488 | Train Acc: 0.6212
 Site-SynthDigits                   | Train Loss: 2.2326 | Train Acc: 0.2568
 Site-SVHN                          | Train Loss: 2.2515 | Train Acc: 0.1379
 Site-MNIST_M                       | Train Loss: 2.2644 | Train Acc: 0.1518
Average Train Accuracy: 0.3695
 Site-USPS                          | Val  Loss: 2.0195 | Val  Acc: 0.6532
 Site-MNIST                         | Val  Loss: 2.0368 | Val  Acc: 0.6606
 Site-SynthDigits                   | Val  Loss: 2.2314 | Val  Acc: 0.2527
 Site-SVHN                          | Val  Loss: 2.2696 | Val  Acc: 0.1400
 Site-MNIST_M                       | Val  Loss: 2.2641 | Val  Acc: 0.2500
Average Valid Accuracy: 0.3913
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6532
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6606
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2527
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1400
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 2 ============
denominator: 13769.798828125
 Site-USPS                          | Train Loss: 1.8572 | Train Acc: 0.7098
 Site-MNIST                         | Train Loss: 1.9325 | Train Acc: 0.6561
 Site-SynthDigits                   | Train Loss: 2.1945 | Train Acc: 0.3033
 Site-SVHN                          | Train Loss: 2.2531 | Train Acc: 0.2167
 Site-MNIST_M                       | Train Loss: 2.2395 | Train Acc: 0.1518
Average Train Accuracy: 0.4075
 Site-USPS                          | Val  Loss: 1.8816 | Val  Acc: 0.6801
 Site-MNIST                         | Val  Loss: 1.9108 | Val  Acc: 0.6909
 Site-SynthDigits                   | Val  Loss: 2.1899 | Val  Acc: 0.3077
 Site-SVHN                          | Val  Loss: 2.2562 | Val  Acc: 0.1800
 Site-MNIST_M                       | Val  Loss: 2.2414 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4146
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6801
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6909
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3077
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.1800
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 3 ============
denominator: 13345.8642578125
 Site-USPS                          | Train Loss: 1.7237 | Train Acc: 0.7174
 Site-MNIST                         | Train Loss: 1.8187 | Train Acc: 0.6773
 Site-SynthDigits                   | Train Loss: 2.1503 | Train Acc: 0.3333
 Site-SVHN                          | Train Loss: 2.2465 | Train Acc: 0.2118
 Site-MNIST_M                       | Train Loss: 2.2190 | Train Acc: 0.2232
Average Train Accuracy: 0.4326
 Site-USPS                          | Val  Loss: 1.7527 | Val  Acc: 0.6768
 Site-MNIST                         | Val  Loss: 1.7960 | Val  Acc: 0.7152
 Site-SynthDigits                   | Val  Loss: 2.1474 | Val  Acc: 0.3077
 Site-SVHN                          | Val  Loss: 2.2458 | Val  Acc: 0.1600
 Site-MNIST_M                       | Val  Loss: 2.2195 | Val  Acc: 0.2500
Average Valid Accuracy: 0.4219
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6768
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7152
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3077
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.1600
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 4 ============
denominator: 13002.8134765625
 Site-USPS                          | Train Loss: 1.5982 | Train Acc: 0.7401
 Site-MNIST                         | Train Loss: 1.7116 | Train Acc: 0.7015
 Site-SynthDigits                   | Train Loss: 2.1177 | Train Acc: 0.3716
 Site-SVHN                          | Train Loss: 2.2166 | Train Acc: 0.2414
 Site-MNIST_M                       | Train Loss: 2.1973 | Train Acc: 0.3036
Average Train Accuracy: 0.4716
 Site-USPS                          | Val  Loss: 1.6307 | Val  Acc: 0.7071
 Site-MNIST                         | Val  Loss: 1.6823 | Val  Acc: 0.7455
 Site-SynthDigits                   | Val  Loss: 2.1100 | Val  Acc: 0.3846
 Site-SVHN                          | Val  Loss: 2.2309 | Val  Acc: 0.1800
 Site-MNIST_M                       | Val  Loss: 2.2071 | Val  Acc: 0.3571
Average Valid Accuracy: 0.4749
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7071
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7455
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3846
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.1800
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 5 ============
denominator: 12734.8564453125
 Site-USPS                          | Train Loss: 1.4801 | Train Acc: 0.7569
 Site-MNIST                         | Train Loss: 1.5956 | Train Acc: 0.7061
 Site-SynthDigits                   | Train Loss: 2.0794 | Train Acc: 0.3689
 Site-SVHN                          | Train Loss: 2.2238 | Train Acc: 0.2562
 Site-MNIST_M                       | Train Loss: 2.1808 | Train Acc: 0.3125
Average Train Accuracy: 0.4801
 Site-USPS                          | Val  Loss: 1.5160 | Val  Acc: 0.7239
 Site-MNIST                         | Val  Loss: 1.5719 | Val  Acc: 0.7576
 Site-SynthDigits                   | Val  Loss: 2.0736 | Val  Acc: 0.3846
 Site-SVHN                          | Val  Loss: 2.2175 | Val  Acc: 0.1600
 Site-MNIST_M                       | Val  Loss: 2.1999 | Val  Acc: 0.3214
Average Valid Accuracy: 0.4695
============ Train epoch 6 ============
denominator: 12451.2939453125
 Site-USPS                          | Train Loss: 1.3690 | Train Acc: 0.7864
 Site-MNIST                         | Train Loss: 1.5177 | Train Acc: 0.7212
 Site-SynthDigits                   | Train Loss: 2.0394 | Train Acc: 0.3852
 Site-SVHN                          | Train Loss: 2.1999 | Train Acc: 0.2562
 Site-MNIST_M                       | Train Loss: 2.1538 | Train Acc: 0.3571
Average Train Accuracy: 0.5012
 Site-USPS                          | Val  Loss: 1.4080 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 1.4794 | Val  Acc: 0.7758
 Site-SynthDigits                   | Val  Loss: 2.0310 | Val  Acc: 0.4176
 Site-SVHN                          | Val  Loss: 2.2067 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.1773 | Val  Acc: 0.4286
Average Valid Accuracy: 0.5206
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7609
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7758
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4176
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2200
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 7 ============
denominator: 12095.021484375
 Site-USPS                          | Train Loss: 1.2663 | Train Acc: 0.8007
 Site-MNIST                         | Train Loss: 1.4219 | Train Acc: 0.7348
 Site-SynthDigits                   | Train Loss: 2.0032 | Train Acc: 0.3825
 Site-SVHN                          | Train Loss: 2.1828 | Train Acc: 0.2660
 Site-MNIST_M                       | Train Loss: 2.1327 | Train Acc: 0.3661
Average Train Accuracy: 0.5100
 Site-USPS                          | Val  Loss: 1.3075 | Val  Acc: 0.7677
 Site-MNIST                         | Val  Loss: 1.3859 | Val  Acc: 0.7939
 Site-SynthDigits                   | Val  Loss: 1.9945 | Val  Acc: 0.4066
 Site-SVHN                          | Val  Loss: 2.1931 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1637 | Val  Acc: 0.3929
Average Valid Accuracy: 0.5202
============ Train epoch 8 ============
denominator: 11933.19140625
 Site-USPS                          | Train Loss: 1.1752 | Train Acc: 0.8091
 Site-MNIST                         | Train Loss: 1.3533 | Train Acc: 0.7485
 Site-SynthDigits                   | Train Loss: 1.9769 | Train Acc: 0.3989
 Site-SVHN                          | Train Loss: 2.1575 | Train Acc: 0.2808
 Site-MNIST_M                       | Train Loss: 2.1060 | Train Acc: 0.3571
Average Train Accuracy: 0.5189
 Site-USPS                          | Val  Loss: 1.2151 | Val  Acc: 0.7811
 Site-MNIST                         | Val  Loss: 1.3051 | Val  Acc: 0.8061
 Site-SynthDigits                   | Val  Loss: 1.9709 | Val  Acc: 0.4066
 Site-SVHN                          | Val  Loss: 2.1806 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1454 | Val  Acc: 0.3571
Average Valid Accuracy: 0.5262
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7811
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8061
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4066
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2800
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 9 ============
denominator: 11652.2060546875
 Site-USPS                          | Train Loss: 1.1147 | Train Acc: 0.8108
 Site-MNIST                         | Train Loss: 1.2661 | Train Acc: 0.7697
 Site-SynthDigits                   | Train Loss: 1.9389 | Train Acc: 0.4071
 Site-SVHN                          | Train Loss: 2.1259 | Train Acc: 0.2709
 Site-MNIST_M                       | Train Loss: 2.0994 | Train Acc: 0.3571
Average Train Accuracy: 0.5231
 Site-USPS                          | Val  Loss: 1.1536 | Val  Acc: 0.7879
 Site-MNIST                         | Val  Loss: 1.2188 | Val  Acc: 0.8242
 Site-SynthDigits                   | Val  Loss: 1.9298 | Val  Acc: 0.4396
 Site-SVHN                          | Val  Loss: 2.1769 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1282 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5226
============ Train epoch 10 ============
denominator: 11441.486328125
 Site-USPS                          | Train Loss: 1.0158 | Train Acc: 0.8385
 Site-MNIST                         | Train Loss: 1.2028 | Train Acc: 0.7879
 Site-SynthDigits                   | Train Loss: 1.9133 | Train Acc: 0.4235
 Site-SVHN                          | Train Loss: 2.1268 | Train Acc: 0.2857
 Site-MNIST_M                       | Train Loss: 2.0736 | Train Acc: 0.3571
Average Train Accuracy: 0.5386
 Site-USPS                          | Val  Loss: 1.0516 | Val  Acc: 0.8182
 Site-MNIST                         | Val  Loss: 1.1562 | Val  Acc: 0.8242
 Site-SynthDigits                   | Val  Loss: 1.8964 | Val  Acc: 0.4396
 Site-SVHN                          | Val  Loss: 2.1656 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1082 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5295
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8182
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8242
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4396
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2800
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 11 ============
denominator: 11255.642578125
 Site-USPS                          | Train Loss: 0.9644 | Train Acc: 0.8385
 Site-MNIST                         | Train Loss: 1.1419 | Train Acc: 0.7818
 Site-SynthDigits                   | Train Loss: 1.8790 | Train Acc: 0.4098
 Site-SVHN                          | Train Loss: 2.1510 | Train Acc: 0.2857
 Site-MNIST_M                       | Train Loss: 2.0536 | Train Acc: 0.3661
Average Train Accuracy: 0.5364
 Site-USPS                          | Val  Loss: 1.0010 | Val  Acc: 0.8114
 Site-MNIST                         | Val  Loss: 1.0872 | Val  Acc: 0.8182
 Site-SynthDigits                   | Val  Loss: 1.8667 | Val  Acc: 0.4176
 Site-SVHN                          | Val  Loss: 2.1544 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.1043 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5266
============ Train epoch 12 ============
denominator: 11086.2431640625
 Site-USPS                          | Train Loss: 0.8948 | Train Acc: 0.8562
 Site-MNIST                         | Train Loss: 1.0805 | Train Acc: 0.7985
 Site-SynthDigits                   | Train Loss: 1.8527 | Train Acc: 0.4481
 Site-SVHN                          | Train Loss: 2.1565 | Train Acc: 0.2759
 Site-MNIST_M                       | Train Loss: 2.0443 | Train Acc: 0.3839
Average Train Accuracy: 0.5525
 Site-USPS                          | Val  Loss: 0.9316 | Val  Acc: 0.8350
 Site-MNIST                         | Val  Loss: 1.0270 | Val  Acc: 0.8364
 Site-SynthDigits                   | Val  Loss: 1.8438 | Val  Acc: 0.4615
 Site-SVHN                          | Val  Loss: 2.1463 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1130 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5174
============ Train epoch 13 ============
denominator: 10804.287109375
 Site-USPS                          | Train Loss: 0.8352 | Train Acc: 0.8604
 Site-MNIST                         | Train Loss: 1.0200 | Train Acc: 0.8015
 Site-SynthDigits                   | Train Loss: 1.8258 | Train Acc: 0.4536
 Site-SVHN                          | Train Loss: 2.0882 | Train Acc: 0.2906
 Site-MNIST_M                       | Train Loss: 2.0297 | Train Acc: 0.3750
Average Train Accuracy: 0.5562
 Site-USPS                          | Val  Loss: 0.8690 | Val  Acc: 0.8485
 Site-MNIST                         | Val  Loss: 0.9756 | Val  Acc: 0.8303
 Site-SynthDigits                   | Val  Loss: 1.8137 | Val  Acc: 0.4615
 Site-SVHN                          | Val  Loss: 2.1340 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1018 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5341
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8485
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8303
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4615
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.2800
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 14 ============
denominator: 10576.4462890625
 Site-USPS                          | Train Loss: 0.7945 | Train Acc: 0.8570
 Site-MNIST                         | Train Loss: 0.9918 | Train Acc: 0.8076
 Site-SynthDigits                   | Train Loss: 1.8024 | Train Acc: 0.4536
 Site-SVHN                          | Train Loss: 2.0747 | Train Acc: 0.3005
 Site-MNIST_M                       | Train Loss: 2.0140 | Train Acc: 0.3839
Average Train Accuracy: 0.5605
 Site-USPS                          | Val  Loss: 0.8268 | Val  Acc: 0.8418
 Site-MNIST                         | Val  Loss: 0.9214 | Val  Acc: 0.8364
 Site-SynthDigits                   | Val  Loss: 1.8041 | Val  Acc: 0.4615
 Site-SVHN                          | Val  Loss: 2.1212 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.0975 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5379
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8418
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8364
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.4615
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3000
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 15 ============
denominator: 10424.001953125
 Site-USPS                          | Train Loss: 0.7407 | Train Acc: 0.8654
 Site-MNIST                         | Train Loss: 0.9144 | Train Acc: 0.8152
 Site-SynthDigits                   | Train Loss: 1.7725 | Train Acc: 0.4672
 Site-SVHN                          | Train Loss: 2.0577 | Train Acc: 0.3103
 Site-MNIST_M                       | Train Loss: 1.9973 | Train Acc: 0.3750
Average Train Accuracy: 0.5666
 Site-USPS                          | Val  Loss: 0.7679 | Val  Acc: 0.8586
 Site-MNIST                         | Val  Loss: 0.8837 | Val  Acc: 0.8424
 Site-SynthDigits                   | Val  Loss: 1.7583 | Val  Acc: 0.4835
 Site-SVHN                          | Val  Loss: 2.1114 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.0768 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5572
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8586
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8424
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4835
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2800
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 16 ============
denominator: 10317.4794921875
 Site-USPS                          | Train Loss: 0.6894 | Train Acc: 0.8730
 Site-MNIST                         | Train Loss: 0.8789 | Train Acc: 0.8273
 Site-SynthDigits                   | Train Loss: 1.7427 | Train Acc: 0.4727
 Site-SVHN                          | Train Loss: 2.0377 | Train Acc: 0.3103
 Site-MNIST_M                       | Train Loss: 1.9642 | Train Acc: 0.4107
Average Train Accuracy: 0.5788
 Site-USPS                          | Val  Loss: 0.7184 | Val  Acc: 0.8653
 Site-MNIST                         | Val  Loss: 0.8338 | Val  Acc: 0.8485
 Site-SynthDigits                   | Val  Loss: 1.7312 | Val  Acc: 0.4725
 Site-SVHN                          | Val  Loss: 2.0952 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.0652 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5576
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8653
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8485
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4725
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.2800
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 17 ============
denominator: 10015.5625
 Site-USPS                          | Train Loss: 0.6501 | Train Acc: 0.8755
 Site-MNIST                         | Train Loss: 0.8391 | Train Acc: 0.8242
 Site-SynthDigits                   | Train Loss: 1.7155 | Train Acc: 0.4754
 Site-SVHN                          | Train Loss: 2.0633 | Train Acc: 0.3103
 Site-MNIST_M                       | Train Loss: 1.9683 | Train Acc: 0.4018
Average Train Accuracy: 0.5775
 Site-USPS                          | Val  Loss: 0.6739 | Val  Acc: 0.8754
 Site-MNIST                         | Val  Loss: 0.7950 | Val  Acc: 0.8364
 Site-SynthDigits                   | Val  Loss: 1.6990 | Val  Acc: 0.4615
 Site-SVHN                          | Val  Loss: 2.0855 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.0614 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5590
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8754
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8364
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.4615
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3000
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 18 ============
denominator: 9962.6064453125
 Site-USPS                          | Train Loss: 0.6090 | Train Acc: 0.8848
 Site-MNIST                         | Train Loss: 0.8077 | Train Acc: 0.8212
 Site-SynthDigits                   | Train Loss: 1.6994 | Train Acc: 0.4781
 Site-SVHN                          | Train Loss: 2.0914 | Train Acc: 0.3202
 Site-MNIST_M                       | Train Loss: 1.9507 | Train Acc: 0.4018
Average Train Accuracy: 0.5812
 Site-USPS                          | Val  Loss: 0.6318 | Val  Acc: 0.8822
 Site-MNIST                         | Val  Loss: 0.7688 | Val  Acc: 0.8424
 Site-SynthDigits                   | Val  Loss: 1.6725 | Val  Acc: 0.4396
 Site-SVHN                          | Val  Loss: 2.0754 | Val  Acc: 0.3200
 Site-MNIST_M                       | Val  Loss: 2.0593 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5611
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8822
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8424
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4396
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3200
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 19 ============
denominator: 9812.7841796875
 Site-USPS                          | Train Loss: 0.5900 | Train Acc: 0.8898
 Site-MNIST                         | Train Loss: 0.7732 | Train Acc: 0.8394
 Site-SynthDigits                   | Train Loss: 1.6746 | Train Acc: 0.5027
 Site-SVHN                          | Train Loss: 2.0547 | Train Acc: 0.3054
 Site-MNIST_M                       | Train Loss: 1.9328 | Train Acc: 0.4107
Average Train Accuracy: 0.5896
 Site-USPS                          | Val  Loss: 0.6104 | Val  Acc: 0.8822
 Site-MNIST                         | Val  Loss: 0.7294 | Val  Acc: 0.8606
 Site-SynthDigits                   | Val  Loss: 1.6476 | Val  Acc: 0.4835
 Site-SVHN                          | Val  Loss: 2.0566 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.0530 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5695
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8822
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8606
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4835
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3000
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 20 ============
denominator: 9650.61328125
 Site-USPS                          | Train Loss: 0.5600 | Train Acc: 0.8907
 Site-MNIST                         | Train Loss: 0.7470 | Train Acc: 0.8288
 Site-SynthDigits                   | Train Loss: 1.6379 | Train Acc: 0.4973
 Site-SVHN                          | Train Loss: 2.0235 | Train Acc: 0.3300
 Site-MNIST_M                       | Train Loss: 1.9281 | Train Acc: 0.3839
Average Train Accuracy: 0.5861
 Site-USPS                          | Val  Loss: 0.5837 | Val  Acc: 0.8822
 Site-MNIST                         | Val  Loss: 0.7057 | Val  Acc: 0.8364
 Site-SynthDigits                   | Val  Loss: 1.6188 | Val  Acc: 0.4615
 Site-SVHN                          | Val  Loss: 2.0491 | Val  Acc: 0.3200
 Site-MNIST_M                       | Val  Loss: 2.0473 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5500
============ Train epoch 21 ============
denominator: 9493.078125
 Site-USPS                          | Train Loss: 0.5291 | Train Acc: 0.8915
 Site-MNIST                         | Train Loss: 0.7251 | Train Acc: 0.8348
 Site-SynthDigits                   | Train Loss: 1.6211 | Train Acc: 0.4863
 Site-SVHN                          | Train Loss: 2.0003 | Train Acc: 0.3202
 Site-MNIST_M                       | Train Loss: 1.9009 | Train Acc: 0.3750
Average Train Accuracy: 0.5816
 Site-USPS                          | Val  Loss: 0.5507 | Val  Acc: 0.8822
 Site-MNIST                         | Val  Loss: 0.6841 | Val  Acc: 0.8606
 Site-SynthDigits                   | Val  Loss: 1.5877 | Val  Acc: 0.4615
 Site-SVHN                          | Val  Loss: 2.0346 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 2.0145 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5589
============ Train epoch 22 ============
denominator: 9299.18359375
 Site-USPS                          | Train Loss: 0.5214 | Train Acc: 0.8915
 Site-MNIST                         | Train Loss: 0.6918 | Train Acc: 0.8364
 Site-SynthDigits                   | Train Loss: 1.6143 | Train Acc: 0.5109
 Site-SVHN                          | Train Loss: 1.9587 | Train Acc: 0.3350
 Site-MNIST_M                       | Train Loss: 1.8805 | Train Acc: 0.3839
Average Train Accuracy: 0.5915
 Site-USPS                          | Val  Loss: 0.5393 | Val  Acc: 0.8822
 Site-MNIST                         | Val  Loss: 0.6468 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.5768 | Val  Acc: 0.5055
 Site-SVHN                          | Val  Loss: 2.0308 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 2.0150 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5760
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8822
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8667
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.5055
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.3400
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 23 ============
denominator: 9247.169921875
 Site-USPS                          | Train Loss: 0.4947 | Train Acc: 0.8915
 Site-MNIST                         | Train Loss: 0.6628 | Train Acc: 0.8576
 Site-SynthDigits                   | Train Loss: 1.5916 | Train Acc: 0.5000
 Site-SVHN                          | Train Loss: 1.9931 | Train Acc: 0.3350
 Site-MNIST_M                       | Train Loss: 1.8562 | Train Acc: 0.4107
Average Train Accuracy: 0.5990
 Site-USPS                          | Val  Loss: 0.5212 | Val  Acc: 0.8822
 Site-MNIST                         | Val  Loss: 0.6143 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.5530 | Val  Acc: 0.5165
 Site-SVHN                          | Val  Loss: 2.0171 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 1.9861 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5878
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8822
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.5165
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.3400
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 24 ============
denominator: 9219.349609375
 Site-USPS                          | Train Loss: 0.4824 | Train Acc: 0.8974
 Site-MNIST                         | Train Loss: 0.6355 | Train Acc: 0.8621
 Site-SynthDigits                   | Train Loss: 1.5937 | Train Acc: 0.5082
 Site-SVHN                          | Train Loss: 1.9689 | Train Acc: 0.3350
 Site-MNIST_M                       | Train Loss: 1.8075 | Train Acc: 0.4107
Average Train Accuracy: 0.6027
 Site-USPS                          | Val  Loss: 0.5054 | Val  Acc: 0.8855
 Site-MNIST                         | Val  Loss: 0.5982 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.5510 | Val  Acc: 0.5385
 Site-SVHN                          | Val  Loss: 1.9965 | Val  Acc: 0.3600
 Site-MNIST_M                       | Val  Loss: 1.9765 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5897
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8855
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.5385
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3600
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 25 ============
denominator: 9077.7373046875
 Site-USPS                          | Train Loss: 0.4695 | Train Acc: 0.8982
 Site-MNIST                         | Train Loss: 0.6073 | Train Acc: 0.8591
 Site-SynthDigits                   | Train Loss: 1.5676 | Train Acc: 0.5137
 Site-SVHN                          | Train Loss: 1.9275 | Train Acc: 0.3350
 Site-MNIST_M                       | Train Loss: 1.8037 | Train Acc: 0.3929
Average Train Accuracy: 0.5998
 Site-USPS                          | Val  Loss: 0.4919 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.5763 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.5196 | Val  Acc: 0.5275
 Site-SVHN                          | Val  Loss: 1.9935 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 1.9667 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5842
============ Train epoch 26 ============
denominator: 9008.767578125
 Site-USPS                          | Train Loss: 0.4613 | Train Acc: 0.8974
 Site-MNIST                         | Train Loss: 0.5738 | Train Acc: 0.8561
 Site-SynthDigits                   | Train Loss: 1.5513 | Train Acc: 0.5219
 Site-SVHN                          | Train Loss: 1.9260 | Train Acc: 0.3448
 Site-MNIST_M                       | Train Loss: 1.7765 | Train Acc: 0.4196
Average Train Accuracy: 0.6080
 Site-USPS                          | Val  Loss: 0.4823 | Val  Acc: 0.8855
 Site-MNIST                         | Val  Loss: 0.5591 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.5140 | Val  Acc: 0.5275
 Site-SVHN                          | Val  Loss: 1.9732 | Val  Acc: 0.3600
 Site-MNIST_M                       | Val  Loss: 1.9357 | Val  Acc: 0.3929
Average Valid Accuracy: 0.6065
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8855
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8667
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.5275
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.3600
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.3929
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 27 ============
denominator: 8884.41015625
 Site-USPS                          | Train Loss: 0.4465 | Train Acc: 0.8974
 Site-MNIST                         | Train Loss: 0.5707 | Train Acc: 0.8621
 Site-SynthDigits                   | Train Loss: 1.5535 | Train Acc: 0.5246
 Site-SVHN                          | Train Loss: 1.9633 | Train Acc: 0.3300
 Site-MNIST_M                       | Train Loss: 1.7670 | Train Acc: 0.4107
Average Train Accuracy: 0.6050
 Site-USPS                          | Val  Loss: 0.4680 | Val  Acc: 0.8923
 Site-MNIST                         | Val  Loss: 0.5395 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.5001 | Val  Acc: 0.5495
 Site-SVHN                          | Val  Loss: 1.9860 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 1.9263 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5892
============ Train epoch 28 ============
denominator: 8772.91796875
 Site-USPS                          | Train Loss: 0.4267 | Train Acc: 0.9050
 Site-MNIST                         | Train Loss: 0.5620 | Train Acc: 0.8606
 Site-SynthDigits                   | Train Loss: 1.5232 | Train Acc: 0.5164
 Site-SVHN                          | Train Loss: 1.9558 | Train Acc: 0.3399
 Site-MNIST_M                       | Train Loss: 1.7699 | Train Acc: 0.4286
Average Train Accuracy: 0.6101
 Site-USPS                          | Val  Loss: 0.4508 | Val  Acc: 0.8990
 Site-MNIST                         | Val  Loss: 0.5312 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.4814 | Val  Acc: 0.5495
 Site-SVHN                          | Val  Loss: 1.9734 | Val  Acc: 0.3600
 Site-MNIST_M                       | Val  Loss: 1.9247 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6005
============ Train epoch 29 ============
denominator: 8664.1220703125
 Site-USPS                          | Train Loss: 0.4142 | Train Acc: 0.9041
 Site-MNIST                         | Train Loss: 0.5547 | Train Acc: 0.8576
 Site-SynthDigits                   | Train Loss: 1.5280 | Train Acc: 0.5164
 Site-SVHN                          | Train Loss: 1.8924 | Train Acc: 0.3300
 Site-MNIST_M                       | Train Loss: 1.7511 | Train Acc: 0.4554
Average Train Accuracy: 0.6127
 Site-USPS                          | Val  Loss: 0.4329 | Val  Acc: 0.8990
 Site-MNIST                         | Val  Loss: 0.5251 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.4649 | Val  Acc: 0.5714
 Site-SVHN                          | Val  Loss: 1.9608 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 1.9140 | Val  Acc: 0.4286
Average Valid Accuracy: 0.6211
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8990
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8667
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5714
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3400
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 30 ============
denominator: 8639.3779296875
 Site-USPS                          | Train Loss: 0.3945 | Train Acc: 0.9033
 Site-MNIST                         | Train Loss: 0.5265 | Train Acc: 0.8742
 Site-SynthDigits                   | Train Loss: 1.5218 | Train Acc: 0.5301
 Site-SVHN                          | Train Loss: 1.8655 | Train Acc: 0.3350
 Site-MNIST_M                       | Train Loss: 1.7130 | Train Acc: 0.4821
Average Train Accuracy: 0.6249
 Site-USPS                          | Val  Loss: 0.4201 | Val  Acc: 0.8990
 Site-MNIST                         | Val  Loss: 0.4984 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.4547 | Val  Acc: 0.5604
 Site-SVHN                          | Val  Loss: 1.9292 | Val  Acc: 0.3800
 Site-MNIST_M                       | Val  Loss: 1.8501 | Val  Acc: 0.4286
Average Valid Accuracy: 0.6318
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8990
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8909
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5604
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.3800
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 31 ============
denominator: 8607.0703125
 Site-USPS                          | Train Loss: 0.3897 | Train Acc: 0.9092
 Site-MNIST                         | Train Loss: 0.5343 | Train Acc: 0.8682
 Site-SynthDigits                   | Train Loss: 1.4832 | Train Acc: 0.5246
 Site-SVHN                          | Train Loss: 1.9245 | Train Acc: 0.3448
 Site-MNIST_M                       | Train Loss: 1.7075 | Train Acc: 0.4821
Average Train Accuracy: 0.6258
 Site-USPS                          | Val  Loss: 0.4103 | Val  Acc: 0.9091
 Site-MNIST                         | Val  Loss: 0.5080 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.4312 | Val  Acc: 0.5714
 Site-SVHN                          | Val  Loss: 1.9486 | Val  Acc: 0.3800
 Site-MNIST_M                       | Val  Loss: 1.8745 | Val  Acc: 0.4643
Average Valid Accuracy: 0.6395
 Best site-USPS                      | Epoch:31 | Val Acc: 0.9091
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8727
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5714
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.3800
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.4643
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 32 ============
denominator: 8547.357421875
 Site-USPS                          | Train Loss: 0.3914 | Train Acc: 0.9083
 Site-MNIST                         | Train Loss: 0.5024 | Train Acc: 0.8803
 Site-SynthDigits                   | Train Loss: 1.4625 | Train Acc: 0.5383
 Site-SVHN                          | Train Loss: 1.9344 | Train Acc: 0.3547
 Site-MNIST_M                       | Train Loss: 1.7136 | Train Acc: 0.4464
Average Train Accuracy: 0.6256
 Site-USPS                          | Val  Loss: 0.4124 | Val  Acc: 0.8990
 Site-MNIST                         | Val  Loss: 0.4766 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.4214 | Val  Acc: 0.6044
 Site-SVHN                          | Val  Loss: 1.9211 | Val  Acc: 0.3800
 Site-MNIST_M                       | Val  Loss: 1.8510 | Val  Acc: 0.4286
Average Valid Accuracy: 0.6430
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8990
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9030
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.6044
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.3800
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 33 ============
denominator: 8359.4775390625
 Site-USPS                          | Train Loss: 0.3740 | Train Acc: 0.9092
 Site-MNIST                         | Train Loss: 0.4845 | Train Acc: 0.8879
 Site-SynthDigits                   | Train Loss: 1.4874 | Train Acc: 0.5328
 Site-SVHN                          | Train Loss: 1.8877 | Train Acc: 0.3448
 Site-MNIST_M                       | Train Loss: 1.6590 | Train Acc: 0.4821
Average Train Accuracy: 0.6314
 Site-USPS                          | Val  Loss: 0.3951 | Val  Acc: 0.9024
 Site-MNIST                         | Val  Loss: 0.4599 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.4338 | Val  Acc: 0.5934
 Site-SVHN                          | Val  Loss: 1.9009 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 1.8026 | Val  Acc: 0.4643
Average Valid Accuracy: 0.6502
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9024
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8909
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.5934
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.4000
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.4643
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 34 ============
denominator: 8350.7021484375
 Site-USPS                          | Train Loss: 0.3806 | Train Acc: 0.9066
 Site-MNIST                         | Train Loss: 0.4847 | Train Acc: 0.8955
 Site-SynthDigits                   | Train Loss: 1.4573 | Train Acc: 0.5546
 Site-SVHN                          | Train Loss: 1.8811 | Train Acc: 0.3547
 Site-MNIST_M                       | Train Loss: 1.6566 | Train Acc: 0.4196
Average Train Accuracy: 0.6262
 Site-USPS                          | Val  Loss: 0.4043 | Val  Acc: 0.8990
 Site-MNIST                         | Val  Loss: 0.4535 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.4081 | Val  Acc: 0.6154
 Site-SVHN                          | Val  Loss: 1.8939 | Val  Acc: 0.3800
 Site-MNIST_M                       | Val  Loss: 1.8119 | Val  Acc: 0.3929
Average Valid Accuracy: 0.6405
============ Train epoch 35 ============
denominator: 8255.73828125
 Site-USPS                          | Train Loss: 0.3526 | Train Acc: 0.9108
 Site-MNIST                         | Train Loss: 0.4496 | Train Acc: 0.9030
 Site-SynthDigits                   | Train Loss: 1.4715 | Train Acc: 0.5546
 Site-SVHN                          | Train Loss: 1.8269 | Train Acc: 0.3498
 Site-MNIST_M                       | Train Loss: 1.6425 | Train Acc: 0.4821
Average Train Accuracy: 0.6401
 Site-USPS                          | Val  Loss: 0.3775 | Val  Acc: 0.9024
 Site-MNIST                         | Val  Loss: 0.4384 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.4125 | Val  Acc: 0.5934
 Site-SVHN                          | Val  Loss: 1.8790 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 1.8084 | Val  Acc: 0.4286
Average Valid Accuracy: 0.6467
============ Train epoch 36 ============
denominator: 8192.3759765625
 Site-USPS                          | Train Loss: 0.3518 | Train Acc: 0.9125
 Site-MNIST                         | Train Loss: 0.4415 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.4425 | Train Acc: 0.5410
 Site-SVHN                          | Train Loss: 1.8620 | Train Acc: 0.3744
 Site-MNIST_M                       | Train Loss: 1.6098 | Train Acc: 0.5446
Average Train Accuracy: 0.6563
 Site-USPS                          | Val  Loss: 0.3743 | Val  Acc: 0.9024
 Site-MNIST                         | Val  Loss: 0.4297 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.3903 | Val  Acc: 0.5714
 Site-SVHN                          | Val  Loss: 1.8692 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 1.7775 | Val  Acc: 0.5357
Average Valid Accuracy: 0.6637
 Best site-USPS                      | Epoch:36 | Val Acc: 0.9024
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9091
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.5714
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.4000
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.5357
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 37 ============
denominator: 8105.8740234375
 Site-USPS                          | Train Loss: 0.3459 | Train Acc: 0.9159
 Site-MNIST                         | Train Loss: 0.4375 | Train Acc: 0.9030
 Site-SynthDigits                   | Train Loss: 1.4306 | Train Acc: 0.5574
 Site-SVHN                          | Train Loss: 1.8450 | Train Acc: 0.3695
 Site-MNIST_M                       | Train Loss: 1.6451 | Train Acc: 0.5089
Average Train Accuracy: 0.6509
 Site-USPS                          | Val  Loss: 0.3697 | Val  Acc: 0.9057
 Site-MNIST                         | Val  Loss: 0.4186 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.3762 | Val  Acc: 0.6044
 Site-SVHN                          | Val  Loss: 1.8683 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 1.7838 | Val  Acc: 0.4286
Average Valid Accuracy: 0.6496
============ Train epoch 38 ============
denominator: 8127.62646484375
 Site-USPS                          | Train Loss: 0.3304 | Train Acc: 0.9184
 Site-MNIST                         | Train Loss: 0.4331 | Train Acc: 0.9061
 Site-SynthDigits                   | Train Loss: 1.4273 | Train Acc: 0.5492
 Site-SVHN                          | Train Loss: 1.7686 | Train Acc: 0.3744
 Site-MNIST_M                       | Train Loss: 1.5938 | Train Acc: 0.5536
Average Train Accuracy: 0.6603
 Site-USPS                          | Val  Loss: 0.3542 | Val  Acc: 0.9091
 Site-MNIST                         | Val  Loss: 0.4073 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.3631 | Val  Acc: 0.5934
 Site-SVHN                          | Val  Loss: 1.8479 | Val  Acc: 0.4200
 Site-MNIST_M                       | Val  Loss: 1.7569 | Val  Acc: 0.5357
Average Valid Accuracy: 0.6735
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9091
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9091
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.5934
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.4200
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.5357
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 39 ============
denominator: 7946.611328125
 Site-USPS                          | Train Loss: 0.3227 | Train Acc: 0.9201
 Site-MNIST                         | Train Loss: 0.4301 | Train Acc: 0.9061
 Site-SynthDigits                   | Train Loss: 1.3817 | Train Acc: 0.5683
 Site-SVHN                          | Train Loss: 1.7718 | Train Acc: 0.3793
 Site-MNIST_M                       | Train Loss: 1.6205 | Train Acc: 0.5268
Average Train Accuracy: 0.6601
 Site-USPS                          | Val  Loss: 0.3437 | Val  Acc: 0.9091
 Site-MNIST                         | Val  Loss: 0.4010 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.3338 | Val  Acc: 0.6154
 Site-SVHN                          | Val  Loss: 1.8536 | Val  Acc: 0.3800
 Site-MNIST_M                       | Val  Loss: 1.7543 | Val  Acc: 0.5357
Average Valid Accuracy: 0.6699
============ Train epoch 40 ============
denominator: 7948.8515625
 Site-USPS                          | Train Loss: 0.3276 | Train Acc: 0.9218
 Site-MNIST                         | Train Loss: 0.4037 | Train Acc: 0.9106
 Site-SynthDigits                   | Train Loss: 1.4100 | Train Acc: 0.5519
 Site-SVHN                          | Train Loss: 1.8308 | Train Acc: 0.3498
 Site-MNIST_M                       | Train Loss: 1.5701 | Train Acc: 0.5446
Average Train Accuracy: 0.6557
 Site-USPS                          | Val  Loss: 0.3539 | Val  Acc: 0.9125
 Site-MNIST                         | Val  Loss: 0.3837 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.3698 | Val  Acc: 0.5934
 Site-SVHN                          | Val  Loss: 1.8272 | Val  Acc: 0.4200
 Site-MNIST_M                       | Val  Loss: 1.7240 | Val  Acc: 0.4643
Average Valid Accuracy: 0.6598
============ Train epoch 41 ============
denominator: 8013.1298828125
 Site-USPS                          | Train Loss: 0.3286 | Train Acc: 0.9218
 Site-MNIST                         | Train Loss: 0.4025 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.3727 | Train Acc: 0.5656
 Site-SVHN                          | Train Loss: 1.8362 | Train Acc: 0.3695
 Site-MNIST_M                       | Train Loss: 1.5529 | Train Acc: 0.5625
Average Train Accuracy: 0.6657
 Site-USPS                          | Val  Loss: 0.3558 | Val  Acc: 0.9125
 Site-MNIST                         | Val  Loss: 0.3732 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.3344 | Val  Acc: 0.6044
 Site-SVHN                          | Val  Loss: 1.8292 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 1.7044 | Val  Acc: 0.5357
Average Valid Accuracy: 0.6735
 Best site-USPS                      | Epoch:41 | Val Acc: 0.9125
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9152
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.6044
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.4000
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5357
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 42 ============
denominator: 7876.4482421875
 Site-USPS                          | Train Loss: 0.3104 | Train Acc: 0.9176
 Site-MNIST                         | Train Loss: 0.3869 | Train Acc: 0.9015
 Site-SynthDigits                   | Train Loss: 1.3513 | Train Acc: 0.5956
 Site-SVHN                          | Train Loss: 1.8166 | Train Acc: 0.3645
 Site-MNIST_M                       | Train Loss: 1.5642 | Train Acc: 0.5625
Average Train Accuracy: 0.6684
 Site-USPS                          | Val  Loss: 0.3321 | Val  Acc: 0.9158
 Site-MNIST                         | Val  Loss: 0.3719 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.2968 | Val  Acc: 0.6264
 Site-SVHN                          | Val  Loss: 1.8514 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 1.7309 | Val  Acc: 0.5714
Average Valid Accuracy: 0.6713
============ Train epoch 43 ============
denominator: 7855.62841796875
 Site-USPS                          | Train Loss: 0.3112 | Train Acc: 0.9243
 Site-MNIST                         | Train Loss: 0.3756 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.3565 | Train Acc: 0.5874
 Site-SVHN                          | Train Loss: 1.7647 | Train Acc: 0.3842
 Site-MNIST_M                       | Train Loss: 1.5340 | Train Acc: 0.5625
Average Train Accuracy: 0.6735
 Site-USPS                          | Val  Loss: 0.3388 | Val  Acc: 0.9158
 Site-MNIST                         | Val  Loss: 0.3667 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.3085 | Val  Acc: 0.6154
 Site-SVHN                          | Val  Loss: 1.8028 | Val  Acc: 0.4400
 Site-MNIST_M                       | Val  Loss: 1.6806 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6761
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9158
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9091
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.6154
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.4400
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 44 ============
denominator: 7761.10009765625
 Site-USPS                          | Train Loss: 0.2989 | Train Acc: 0.9235
 Site-MNIST                         | Train Loss: 0.3837 | Train Acc: 0.9121
 Site-SynthDigits                   | Train Loss: 1.3631 | Train Acc: 0.5902
 Site-SVHN                          | Train Loss: 1.7674 | Train Acc: 0.3941
 Site-MNIST_M                       | Train Loss: 1.5245 | Train Acc: 0.5714
Average Train Accuracy: 0.6783
 Site-USPS                          | Val  Loss: 0.3188 | Val  Acc: 0.9158
 Site-MNIST                         | Val  Loss: 0.3576 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.2964 | Val  Acc: 0.6264
 Site-SVHN                          | Val  Loss: 1.8030 | Val  Acc: 0.4200
 Site-MNIST_M                       | Val  Loss: 1.6778 | Val  Acc: 0.5714
Average Valid Accuracy: 0.6873
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9158
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9030
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.6264
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.4200
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.5714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/q-ffl...
============ Train epoch 45 ============
denominator: 7791.16357421875
 Site-USPS                          | Train Loss: 0.3052 | Train Acc: 0.9251
 Site-MNIST                         | Train Loss: 0.3735 | Train Acc: 0.9106
 Site-SynthDigits                   | Train Loss: 1.3370 | Train Acc: 0.5820
 Site-SVHN                          | Train Loss: 1.7833 | Train Acc: 0.3842
 Site-MNIST_M                       | Train Loss: 1.5475 | Train Acc: 0.5446
Average Train Accuracy: 0.6693
 Site-USPS                          | Val  Loss: 0.3263 | Val  Acc: 0.9192
 Site-MNIST                         | Val  Loss: 0.3574 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.2864 | Val  Acc: 0.6154
 Site-SVHN                          | Val  Loss: 1.8055 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 1.6964 | Val  Acc: 0.5357
Average Valid Accuracy: 0.6759
============ Train epoch 46 ============
denominator: 7609.72119140625
 Site-USPS                          | Train Loss: 0.2916 | Train Acc: 0.9277
 Site-MNIST                         | Train Loss: 0.3640 | Train Acc: 0.9152
 Site-SynthDigits                   | Train Loss: 1.3490 | Train Acc: 0.5929
 Site-SVHN                          | Train Loss: 1.7912 | Train Acc: 0.3892
 Site-MNIST_M                       | Train Loss: 1.5205 | Train Acc: 0.5625
Average Train Accuracy: 0.6775
 Site-USPS                          | Val  Loss: 0.3085 | Val  Acc: 0.9226
 Site-MNIST                         | Val  Loss: 0.3469 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.2725 | Val  Acc: 0.6374
 Site-SVHN                          | Val  Loss: 1.7917 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 1.6619 | Val  Acc: 0.5357
Average Valid Accuracy: 0.6822
============ Train epoch 47 ============
denominator: 7629.14794921875
 Site-USPS                          | Train Loss: 0.2938 | Train Acc: 0.9251
 Site-MNIST                         | Train Loss: 0.3823 | Train Acc: 0.9136
 Site-SynthDigits                   | Train Loss: 1.2997 | Train Acc: 0.6066
 Site-SVHN                          | Train Loss: 1.7699 | Train Acc: 0.3941
 Site-MNIST_M                       | Train Loss: 1.5234 | Train Acc: 0.5714
Average Train Accuracy: 0.6822
 Site-USPS                          | Val  Loss: 0.3211 | Val  Acc: 0.9192
 Site-MNIST                         | Val  Loss: 0.3376 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.2562 | Val  Acc: 0.6154
 Site-SVHN                          | Val  Loss: 1.7846 | Val  Acc: 0.4200
 Site-MNIST_M                       | Val  Loss: 1.6842 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6727
============ Train epoch 48 ============
denominator: 7508.4033203125
 Site-USPS                          | Train Loss: 0.2775 | Train Acc: 0.9310
 Site-MNIST                         | Train Loss: 0.3524 | Train Acc: 0.9182
 Site-SynthDigits                   | Train Loss: 1.3323 | Train Acc: 0.6038
 Site-SVHN                          | Train Loss: 1.7401 | Train Acc: 0.3744
 Site-MNIST_M                       | Train Loss: 1.4923 | Train Acc: 0.5714
Average Train Accuracy: 0.6798
 Site-USPS                          | Val  Loss: 0.2976 | Val  Acc: 0.9226
 Site-MNIST                         | Val  Loss: 0.3337 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.2813 | Val  Acc: 0.6264
 Site-SVHN                          | Val  Loss: 1.7790 | Val  Acc: 0.4200
 Site-MNIST_M                       | Val  Loss: 1.6624 | Val  Acc: 0.5357
Average Valid Accuracy: 0.6840
============ Train epoch 49 ============
denominator: 7618.1162109375
 Site-USPS                          | Train Loss: 0.2713 | Train Acc: 0.9327
 Site-MNIST                         | Train Loss: 0.3618 | Train Acc: 0.9121
 Site-SynthDigits                   | Train Loss: 1.3015 | Train Acc: 0.6120
 Site-SVHN                          | Train Loss: 1.6400 | Train Acc: 0.4039
 Site-MNIST_M                       | Train Loss: 1.5183 | Train Acc: 0.5536
Average Train Accuracy: 0.6829
 Site-USPS                          | Val  Loss: 0.2830 | Val  Acc: 0.9293
 Site-MNIST                         | Val  Loss: 0.3359 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.2484 | Val  Acc: 0.6374
 Site-SVHN                          | Val  Loss: 1.7716 | Val  Acc: 0.4200
 Site-MNIST_M                       | Val  Loss: 1.6983 | Val  Acc: 0.5357
Average Valid Accuracy: 0.6863
===2023-07-02 16:08:29===
===2023-07-02 16:08:31===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
Loading snapshots...
 Test site-USPS                      | Epoch:44 | Test Acc: 0.9183
 Test site-MNIST                     | Epoch:44 | Test Acc: 0.8786
 Test site-SynthDigits               | Epoch:44 | Test Acc: 0.5128
 Test site-SVHN                      | Epoch:44 | Test Acc: 0.2881
 Test site-MNIST_M                   | Epoch:44 | Test Acc: 0.3754
USPS: 0.9183, MNIST: 0.8786, SynthDigits: 0.5128, SVHN: 0.2881, MNIST_M: 0.3754, 
Average Test Accuracy(group): 0.5946, Average Test Accuracy(individual): 0.5946,
domain std=0.2585, cluster std=-1.0000, individual std=0.2585, 
