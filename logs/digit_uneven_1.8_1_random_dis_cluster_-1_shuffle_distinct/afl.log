===2023-07-02 13:59:58===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
============ Train epoch 0 ============
 Site-USPS                          | Train Loss: 1.9198 | Train Acc: 0.6341
 Site-MNIST                         | Train Loss: 2.0504 | Train Acc: 0.4742
 Site-SynthDigits                   | Train Loss: 2.2449 | Train Acc: 0.2158
 Site-SVHN                          | Train Loss: 2.2825 | Train Acc: 0.1182
 Site-MNIST_M                       | Train Loss: 2.2840 | Train Acc: 0.1696
Average Train Accuracy: 0.3224
 Site-USPS                          | Val  Loss: 1.9432 | Val  Acc: 0.6027
 Site-MNIST                         | Val  Loss: 2.0359 | Val  Acc: 0.4909
 Site-SynthDigits                   | Val  Loss: 2.2416 | Val  Acc: 0.2198
 Site-SVHN                          | Val  Loss: 2.2824 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.3066 | Val  Acc: 0.0714
Average Valid Accuracy: 0.3170
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6027
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4909
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2198
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2000
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.0714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 1 ============
 Site-USPS                          | Train Loss: 1.6257 | Train Acc: 0.6972
 Site-MNIST                         | Train Loss: 1.8297 | Train Acc: 0.5803
 Site-SynthDigits                   | Train Loss: 2.1854 | Train Acc: 0.2650
 Site-SVHN                          | Train Loss: 2.2698 | Train Acc: 0.1182
 Site-MNIST_M                       | Train Loss: 2.2510 | Train Acc: 0.2321
Average Train Accuracy: 0.3786
 Site-USPS                          | Val  Loss: 1.6688 | Val  Acc: 0.6566
 Site-MNIST                         | Val  Loss: 1.8140 | Val  Acc: 0.6303
 Site-SynthDigits                   | Val  Loss: 2.1738 | Val  Acc: 0.2747
 Site-SVHN                          | Val  Loss: 2.2755 | Val  Acc: 0.1600
 Site-MNIST_M                       | Val  Loss: 2.2871 | Val  Acc: 0.1429
Average Valid Accuracy: 0.3729
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6566
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6303
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2747
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1600
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 2 ============
 Site-USPS                          | Train Loss: 1.3858 | Train Acc: 0.7687
 Site-MNIST                         | Train Loss: 1.6468 | Train Acc: 0.6606
 Site-SynthDigits                   | Train Loss: 2.1273 | Train Acc: 0.3169
 Site-SVHN                          | Train Loss: 2.2484 | Train Acc: 0.1379
 Site-MNIST_M                       | Train Loss: 2.2233 | Train Acc: 0.2232
Average Train Accuracy: 0.4215
 Site-USPS                          | Val  Loss: 1.4333 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 1.6247 | Val  Acc: 0.7212
 Site-SynthDigits                   | Val  Loss: 2.1085 | Val  Acc: 0.3297
 Site-SVHN                          | Val  Loss: 2.2631 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.2703 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4309
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7609
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7212
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3297
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2000
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 3 ============
 Site-USPS                          | Train Loss: 1.2331 | Train Acc: 0.7738
 Site-MNIST                         | Train Loss: 1.4893 | Train Acc: 0.6833
 Site-SynthDigits                   | Train Loss: 2.0775 | Train Acc: 0.3361
 Site-SVHN                          | Train Loss: 2.2469 | Train Acc: 0.1429
 Site-MNIST_M                       | Train Loss: 2.2086 | Train Acc: 0.1875
Average Train Accuracy: 0.4247
 Site-USPS                          | Val  Loss: 1.2839 | Val  Acc: 0.7441
 Site-MNIST                         | Val  Loss: 1.4540 | Val  Acc: 0.7394
 Site-SynthDigits                   | Val  Loss: 2.0527 | Val  Acc: 0.3626
 Site-SVHN                          | Val  Loss: 2.2600 | Val  Acc: 0.1800
 Site-MNIST_M                       | Val  Loss: 2.2594 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4338
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7441
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7394
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3626
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.1800
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 4 ============
 Site-USPS                          | Train Loss: 1.0722 | Train Acc: 0.8183
 Site-MNIST                         | Train Loss: 1.3661 | Train Acc: 0.6879
 Site-SynthDigits                   | Train Loss: 2.0354 | Train Acc: 0.3361
 Site-SVHN                          | Train Loss: 2.2222 | Train Acc: 0.1379
 Site-MNIST_M                       | Train Loss: 2.1930 | Train Acc: 0.1875
Average Train Accuracy: 0.4335
 Site-USPS                          | Val  Loss: 1.1201 | Val  Acc: 0.7845
 Site-MNIST                         | Val  Loss: 1.3297 | Val  Acc: 0.7576
 Site-SynthDigits                   | Val  Loss: 2.0117 | Val  Acc: 0.3516
 Site-SVHN                          | Val  Loss: 2.2523 | Val  Acc: 0.1600
 Site-MNIST_M                       | Val  Loss: 2.2686 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4465
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7845
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7576
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3516
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.1600
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 5 ============
 Site-USPS                          | Train Loss: 0.9461 | Train Acc: 0.8419
 Site-MNIST                         | Train Loss: 1.2637 | Train Acc: 0.6985
 Site-SynthDigits                   | Train Loss: 1.9965 | Train Acc: 0.3525
 Site-SVHN                          | Train Loss: 2.2293 | Train Acc: 0.1576
 Site-MNIST_M                       | Train Loss: 2.1657 | Train Acc: 0.1875
Average Train Accuracy: 0.4476
 Site-USPS                          | Val  Loss: 0.9966 | Val  Acc: 0.8114
 Site-MNIST                         | Val  Loss: 1.2298 | Val  Acc: 0.7455
 Site-SynthDigits                   | Val  Loss: 1.9663 | Val  Acc: 0.3846
 Site-SVHN                          | Val  Loss: 2.2338 | Val  Acc: 0.1600
 Site-MNIST_M                       | Val  Loss: 2.2380 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4489
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8114
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7455
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3846
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.1600
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 6 ============
 Site-USPS                          | Train Loss: 0.8601 | Train Acc: 0.8545
 Site-MNIST                         | Train Loss: 1.1559 | Train Acc: 0.7348
 Site-SynthDigits                   | Train Loss: 1.9687 | Train Acc: 0.3579
 Site-SVHN                          | Train Loss: 2.2190 | Train Acc: 0.1872
 Site-MNIST_M                       | Train Loss: 2.1340 | Train Acc: 0.2411
Average Train Accuracy: 0.4751
 Site-USPS                          | Val  Loss: 0.9065 | Val  Acc: 0.8283
 Site-MNIST                         | Val  Loss: 1.1155 | Val  Acc: 0.7879
 Site-SynthDigits                   | Val  Loss: 1.9328 | Val  Acc: 0.3626
 Site-SVHN                          | Val  Loss: 2.2107 | Val  Acc: 0.1800
 Site-MNIST_M                       | Val  Loss: 2.2250 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4603
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8283
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7879
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3626
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.1800
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 7 ============
 Site-USPS                          | Train Loss: 0.7604 | Train Acc: 0.8688
 Site-MNIST                         | Train Loss: 1.0931 | Train Acc: 0.7485
 Site-SynthDigits                   | Train Loss: 1.9520 | Train Acc: 0.3443
 Site-SVHN                          | Train Loss: 2.1803 | Train Acc: 0.1872
 Site-MNIST_M                       | Train Loss: 2.1115 | Train Acc: 0.2321
Average Train Accuracy: 0.4762
 Site-USPS                          | Val  Loss: 0.8079 | Val  Acc: 0.8519
 Site-MNIST                         | Val  Loss: 1.0451 | Val  Acc: 0.8121
 Site-SynthDigits                   | Val  Loss: 1.9100 | Val  Acc: 0.3516
 Site-SVHN                          | Val  Loss: 2.1991 | Val  Acc: 0.1800
 Site-MNIST_M                       | Val  Loss: 2.2134 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4677
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8519
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8121
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3516
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.1800
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 8 ============
 Site-USPS                          | Train Loss: 0.7071 | Train Acc: 0.8747
 Site-MNIST                         | Train Loss: 1.0121 | Train Acc: 0.7364
 Site-SynthDigits                   | Train Loss: 1.9172 | Train Acc: 0.3634
 Site-SVHN                          | Train Loss: 2.2028 | Train Acc: 0.2167
 Site-MNIST_M                       | Train Loss: 2.0852 | Train Acc: 0.2500
Average Train Accuracy: 0.4882
 Site-USPS                          | Val  Loss: 0.7533 | Val  Acc: 0.8620
 Site-MNIST                         | Val  Loss: 0.9766 | Val  Acc: 0.7636
 Site-SynthDigits                   | Val  Loss: 1.8816 | Val  Acc: 0.3736
 Site-SVHN                          | Val  Loss: 2.1845 | Val  Acc: 0.1800
 Site-MNIST_M                       | Val  Loss: 2.2023 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4644
============ Train epoch 9 ============
 Site-USPS                          | Train Loss: 0.6432 | Train Acc: 0.8789
 Site-MNIST                         | Train Loss: 0.9508 | Train Acc: 0.7515
 Site-SynthDigits                   | Train Loss: 1.9084 | Train Acc: 0.3661
 Site-SVHN                          | Train Loss: 2.1641 | Train Acc: 0.2365
 Site-MNIST_M                       | Train Loss: 2.0615 | Train Acc: 0.2500
Average Train Accuracy: 0.4966
 Site-USPS                          | Val  Loss: 0.6780 | Val  Acc: 0.8552
 Site-MNIST                         | Val  Loss: 0.9183 | Val  Acc: 0.7818
 Site-SynthDigits                   | Val  Loss: 1.8574 | Val  Acc: 0.3626
 Site-SVHN                          | Val  Loss: 2.1717 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.2123 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4765
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8552
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7818
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3626
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2400
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 10 ============
 Site-USPS                          | Train Loss: 0.5944 | Train Acc: 0.8881
 Site-MNIST                         | Train Loss: 0.9305 | Train Acc: 0.7500
 Site-SynthDigits                   | Train Loss: 1.9069 | Train Acc: 0.3661
 Site-SVHN                          | Train Loss: 2.1504 | Train Acc: 0.2463
 Site-MNIST_M                       | Train Loss: 2.0540 | Train Acc: 0.2768
Average Train Accuracy: 0.5055
 Site-USPS                          | Val  Loss: 0.6310 | Val  Acc: 0.8586
 Site-MNIST                         | Val  Loss: 0.8786 | Val  Acc: 0.7697
 Site-SynthDigits                   | Val  Loss: 1.8570 | Val  Acc: 0.3516
 Site-SVHN                          | Val  Loss: 2.1581 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.1822 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4837
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8586
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7697
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3516
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2600
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 11 ============
 Site-USPS                          | Train Loss: 0.5458 | Train Acc: 0.8974
 Site-MNIST                         | Train Loss: 0.8769 | Train Acc: 0.7455
 Site-SynthDigits                   | Train Loss: 1.8869 | Train Acc: 0.3716
 Site-SVHN                          | Train Loss: 2.1365 | Train Acc: 0.2562
 Site-MNIST_M                       | Train Loss: 2.0365 | Train Acc: 0.3125
Average Train Accuracy: 0.5166
 Site-USPS                          | Val  Loss: 0.5769 | Val  Acc: 0.8754
 Site-MNIST                         | Val  Loss: 0.8399 | Val  Acc: 0.7697
 Site-SynthDigits                   | Val  Loss: 1.8424 | Val  Acc: 0.3736
 Site-SVHN                          | Val  Loss: 2.1612 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.2010 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4986
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8754
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7697
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3736
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2600
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 12 ============
 Site-USPS                          | Train Loss: 0.5157 | Train Acc: 0.8999
 Site-MNIST                         | Train Loss: 0.8274 | Train Acc: 0.7652
 Site-SynthDigits                   | Train Loss: 1.8605 | Train Acc: 0.3852
 Site-SVHN                          | Train Loss: 2.1583 | Train Acc: 0.2611
 Site-MNIST_M                       | Train Loss: 2.0163 | Train Acc: 0.3036
Average Train Accuracy: 0.5230
 Site-USPS                          | Val  Loss: 0.5517 | Val  Acc: 0.8754
 Site-MNIST                         | Val  Loss: 0.7907 | Val  Acc: 0.7939
 Site-SynthDigits                   | Val  Loss: 1.8236 | Val  Acc: 0.3516
 Site-SVHN                          | Val  Loss: 2.1465 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1916 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4959
============ Train epoch 13 ============
 Site-USPS                          | Train Loss: 0.4825 | Train Acc: 0.8982
 Site-MNIST                         | Train Loss: 0.8157 | Train Acc: 0.7727
 Site-SynthDigits                   | Train Loss: 1.8569 | Train Acc: 0.3880
 Site-SVHN                          | Train Loss: 2.1449 | Train Acc: 0.2808
 Site-MNIST_M                       | Train Loss: 1.9827 | Train Acc: 0.2946
Average Train Accuracy: 0.5269
 Site-USPS                          | Val  Loss: 0.5091 | Val  Acc: 0.8721
 Site-MNIST                         | Val  Loss: 0.7756 | Val  Acc: 0.8000
 Site-SynthDigits                   | Val  Loss: 1.8104 | Val  Acc: 0.3626
 Site-SVHN                          | Val  Loss: 2.1339 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1895 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4915
============ Train epoch 14 ============
 Site-USPS                          | Train Loss: 0.4573 | Train Acc: 0.9041
 Site-MNIST                         | Train Loss: 0.7832 | Train Acc: 0.7803
 Site-SynthDigits                   | Train Loss: 1.8416 | Train Acc: 0.3989
 Site-SVHN                          | Train Loss: 2.1052 | Train Acc: 0.2660
 Site-MNIST_M                       | Train Loss: 2.0003 | Train Acc: 0.3214
Average Train Accuracy: 0.5342
 Site-USPS                          | Val  Loss: 0.4848 | Val  Acc: 0.8721
 Site-MNIST                         | Val  Loss: 0.7373 | Val  Acc: 0.8182
 Site-SynthDigits                   | Val  Loss: 1.8058 | Val  Acc: 0.3846
 Site-SVHN                          | Val  Loss: 2.1244 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.2088 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4995
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8721
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8182
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.3846
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.2800
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 15 ============
 Site-USPS                          | Train Loss: 0.4291 | Train Acc: 0.9125
 Site-MNIST                         | Train Loss: 0.7242 | Train Acc: 0.7909
 Site-SynthDigits                   | Train Loss: 1.8315 | Train Acc: 0.3962
 Site-SVHN                          | Train Loss: 2.1372 | Train Acc: 0.2463
 Site-MNIST_M                       | Train Loss: 1.9853 | Train Acc: 0.3214
Average Train Accuracy: 0.5335
 Site-USPS                          | Val  Loss: 0.4570 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.7015 | Val  Acc: 0.8242
 Site-SynthDigits                   | Val  Loss: 1.7812 | Val  Acc: 0.3736
 Site-SVHN                          | Val  Loss: 2.1148 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.1872 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5051
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8242
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.3736
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2600
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 16 ============
 Site-USPS                          | Train Loss: 0.4145 | Train Acc: 0.9117
 Site-MNIST                         | Train Loss: 0.7069 | Train Acc: 0.8045
 Site-SynthDigits                   | Train Loss: 1.8111 | Train Acc: 0.4016
 Site-SVHN                          | Train Loss: 2.1084 | Train Acc: 0.2562
 Site-MNIST_M                       | Train Loss: 1.9759 | Train Acc: 0.3393
Average Train Accuracy: 0.5427
 Site-USPS                          | Val  Loss: 0.4461 | Val  Acc: 0.8855
 Site-MNIST                         | Val  Loss: 0.6678 | Val  Acc: 0.8424
 Site-SynthDigits                   | Val  Loss: 1.7699 | Val  Acc: 0.3846
 Site-SVHN                          | Val  Loss: 2.1015 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.1812 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5102
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8855
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8424
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.3846
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.2600
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 17 ============
 Site-USPS                          | Train Loss: 0.3960 | Train Acc: 0.9151
 Site-MNIST                         | Train Loss: 0.6999 | Train Acc: 0.7970
 Site-SynthDigits                   | Train Loss: 1.7995 | Train Acc: 0.4016
 Site-SVHN                          | Train Loss: 2.1511 | Train Acc: 0.2709
 Site-MNIST_M                       | Train Loss: 1.9575 | Train Acc: 0.3214
Average Train Accuracy: 0.5412
 Site-USPS                          | Val  Loss: 0.4245 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.6603 | Val  Acc: 0.8242
 Site-SynthDigits                   | Val  Loss: 1.7528 | Val  Acc: 0.3626
 Site-SVHN                          | Val  Loss: 2.1019 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1782 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5140
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8242
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.3626
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.2800
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 18 ============
 Site-USPS                          | Train Loss: 0.3734 | Train Acc: 0.9176
 Site-MNIST                         | Train Loss: 0.6627 | Train Acc: 0.8121
 Site-SynthDigits                   | Train Loss: 1.7836 | Train Acc: 0.4262
 Site-SVHN                          | Train Loss: 2.1089 | Train Acc: 0.2463
 Site-MNIST_M                       | Train Loss: 1.9477 | Train Acc: 0.3661
Average Train Accuracy: 0.5537
 Site-USPS                          | Val  Loss: 0.4034 | Val  Acc: 0.8956
 Site-MNIST                         | Val  Loss: 0.6299 | Val  Acc: 0.8485
 Site-SynthDigits                   | Val  Loss: 1.7429 | Val  Acc: 0.3956
 Site-SVHN                          | Val  Loss: 2.0915 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1772 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5259
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8956
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8485
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.3956
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.2400
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 19 ============
 Site-USPS                          | Train Loss: 0.3541 | Train Acc: 0.9268
 Site-MNIST                         | Train Loss: 0.6490 | Train Acc: 0.8061
 Site-SynthDigits                   | Train Loss: 1.7665 | Train Acc: 0.4235
 Site-SVHN                          | Train Loss: 2.0567 | Train Acc: 0.2759
 Site-MNIST_M                       | Train Loss: 1.9379 | Train Acc: 0.3482
Average Train Accuracy: 0.5561
 Site-USPS                          | Val  Loss: 0.3819 | Val  Acc: 0.9091
 Site-MNIST                         | Val  Loss: 0.6135 | Val  Acc: 0.8485
 Site-SynthDigits                   | Val  Loss: 1.7342 | Val  Acc: 0.3736
 Site-SVHN                          | Val  Loss: 2.0882 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1923 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5171
============ Train epoch 20 ============
 Site-USPS                          | Train Loss: 0.3435 | Train Acc: 0.9235
 Site-MNIST                         | Train Loss: 0.6133 | Train Acc: 0.8227
 Site-SynthDigits                   | Train Loss: 1.7624 | Train Acc: 0.4208
 Site-SVHN                          | Train Loss: 2.0315 | Train Acc: 0.2660
 Site-MNIST_M                       | Train Loss: 1.9272 | Train Acc: 0.3661
Average Train Accuracy: 0.5598
 Site-USPS                          | Val  Loss: 0.3703 | Val  Acc: 0.9024
 Site-MNIST                         | Val  Loss: 0.5882 | Val  Acc: 0.8424
 Site-SynthDigits                   | Val  Loss: 1.7235 | Val  Acc: 0.3846
 Site-SVHN                          | Val  Loss: 2.0726 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.2017 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5127
============ Train epoch 21 ============
 Site-USPS                          | Train Loss: 0.3423 | Train Acc: 0.9260
 Site-MNIST                         | Train Loss: 0.6152 | Train Acc: 0.8227
 Site-SynthDigits                   | Train Loss: 1.7387 | Train Acc: 0.4372
 Site-SVHN                          | Train Loss: 2.0676 | Train Acc: 0.2709
 Site-MNIST_M                       | Train Loss: 1.9428 | Train Acc: 0.3571
Average Train Accuracy: 0.5628
 Site-USPS                          | Val  Loss: 0.3653 | Val  Acc: 0.9057
 Site-MNIST                         | Val  Loss: 0.5849 | Val  Acc: 0.8364
 Site-SynthDigits                   | Val  Loss: 1.7010 | Val  Acc: 0.4066
 Site-SVHN                          | Val  Loss: 2.0856 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.1977 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5166
============ Train epoch 22 ============
 Site-USPS                          | Train Loss: 0.3153 | Train Acc: 0.9344
 Site-MNIST                         | Train Loss: 0.6017 | Train Acc: 0.8242
 Site-SynthDigits                   | Train Loss: 1.7346 | Train Acc: 0.4399
 Site-SVHN                          | Train Loss: 2.1040 | Train Acc: 0.2759
 Site-MNIST_M                       | Train Loss: 1.9256 | Train Acc: 0.3571
Average Train Accuracy: 0.5663
 Site-USPS                          | Val  Loss: 0.3407 | Val  Acc: 0.9125
 Site-MNIST                         | Val  Loss: 0.5637 | Val  Acc: 0.8485
 Site-SynthDigits                   | Val  Loss: 1.6991 | Val  Acc: 0.4066
 Site-SVHN                          | Val  Loss: 2.0614 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.2210 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5244
============ Train epoch 23 ============
 Site-USPS                          | Train Loss: 0.3002 | Train Acc: 0.9361
 Site-MNIST                         | Train Loss: 0.5682 | Train Acc: 0.8409
 Site-SynthDigits                   | Train Loss: 1.7323 | Train Acc: 0.4399
 Site-SVHN                          | Train Loss: 2.0679 | Train Acc: 0.2660
 Site-MNIST_M                       | Train Loss: 1.9160 | Train Acc: 0.3661
Average Train Accuracy: 0.5698
 Site-USPS                          | Val  Loss: 0.3233 | Val  Acc: 0.9158
 Site-MNIST                         | Val  Loss: 0.5449 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.6835 | Val  Acc: 0.4176
 Site-SVHN                          | Val  Loss: 2.0462 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.2095 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5356
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9158
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8545
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.4176
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.2400
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 24 ============
 Site-USPS                          | Train Loss: 0.2868 | Train Acc: 0.9369
 Site-MNIST                         | Train Loss: 0.5566 | Train Acc: 0.8288
 Site-SynthDigits                   | Train Loss: 1.7276 | Train Acc: 0.4590
 Site-SVHN                          | Train Loss: 2.0683 | Train Acc: 0.2906
 Site-MNIST_M                       | Train Loss: 1.9183 | Train Acc: 0.3839
Average Train Accuracy: 0.5799
 Site-USPS                          | Val  Loss: 0.3069 | Val  Acc: 0.9192
 Site-MNIST                         | Val  Loss: 0.5393 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.6833 | Val  Acc: 0.4286
 Site-SVHN                          | Val  Loss: 2.0496 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.2214 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5465
 Best site-USPS                      | Epoch:24 | Val Acc: 0.9192
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8545
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.4286
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.2800
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 25 ============
 Site-USPS                          | Train Loss: 0.2816 | Train Acc: 0.9437
 Site-MNIST                         | Train Loss: 0.5514 | Train Acc: 0.8379
 Site-SynthDigits                   | Train Loss: 1.7073 | Train Acc: 0.4645
 Site-SVHN                          | Train Loss: 2.1019 | Train Acc: 0.2906
 Site-MNIST_M                       | Train Loss: 1.8721 | Train Acc: 0.3571
Average Train Accuracy: 0.5788
 Site-USPS                          | Val  Loss: 0.3034 | Val  Acc: 0.9226
 Site-MNIST                         | Val  Loss: 0.5245 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.6655 | Val  Acc: 0.4835
 Site-SVHN                          | Val  Loss: 2.0395 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1700 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5438
============ Train epoch 26 ============
 Site-USPS                          | Train Loss: 0.2737 | Train Acc: 0.9420
 Site-MNIST                         | Train Loss: 0.5318 | Train Acc: 0.8530
 Site-SynthDigits                   | Train Loss: 1.6871 | Train Acc: 0.4781
 Site-SVHN                          | Train Loss: 2.0882 | Train Acc: 0.2857
 Site-MNIST_M                       | Train Loss: 1.8897 | Train Acc: 0.3661
Average Train Accuracy: 0.5850
 Site-USPS                          | Val  Loss: 0.2971 | Val  Acc: 0.9293
 Site-MNIST                         | Val  Loss: 0.5048 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.6455 | Val  Acc: 0.4615
 Site-SVHN                          | Val  Loss: 2.0370 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.1850 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5396
============ Train epoch 27 ============
 Site-USPS                          | Train Loss: 0.2612 | Train Acc: 0.9411
 Site-MNIST                         | Train Loss: 0.5194 | Train Acc: 0.8439
 Site-SynthDigits                   | Train Loss: 1.6881 | Train Acc: 0.4809
 Site-SVHN                          | Train Loss: 2.1001 | Train Acc: 0.2808
 Site-MNIST_M                       | Train Loss: 1.8725 | Train Acc: 0.3661
Average Train Accuracy: 0.5826
 Site-USPS                          | Val  Loss: 0.2840 | Val  Acc: 0.9226
 Site-MNIST                         | Val  Loss: 0.4978 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.6319 | Val  Acc: 0.4725
 Site-SVHN                          | Val  Loss: 2.0327 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.1936 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5368
============ Train epoch 28 ============
 Site-USPS                          | Train Loss: 0.2613 | Train Acc: 0.9428
 Site-MNIST                         | Train Loss: 0.4935 | Train Acc: 0.8591
 Site-SynthDigits                   | Train Loss: 1.6652 | Train Acc: 0.4836
 Site-SVHN                          | Train Loss: 2.0896 | Train Acc: 0.2857
 Site-MNIST_M                       | Train Loss: 1.8930 | Train Acc: 0.3482
Average Train Accuracy: 0.5839
 Site-USPS                          | Val  Loss: 0.2915 | Val  Acc: 0.9226
 Site-MNIST                         | Val  Loss: 0.4725 | Val  Acc: 0.8606
 Site-SynthDigits                   | Val  Loss: 1.6348 | Val  Acc: 0.4725
 Site-SVHN                          | Val  Loss: 2.0380 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.1503 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5460
============ Train epoch 29 ============
 Site-USPS                          | Train Loss: 0.2522 | Train Acc: 0.9479
 Site-MNIST                         | Train Loss: 0.4985 | Train Acc: 0.8515
 Site-SynthDigits                   | Train Loss: 1.6587 | Train Acc: 0.4863
 Site-SVHN                          | Train Loss: 1.9769 | Train Acc: 0.2906
 Site-MNIST_M                       | Train Loss: 1.8631 | Train Acc: 0.3839
Average Train Accuracy: 0.5921
 Site-USPS                          | Val  Loss: 0.2769 | Val  Acc: 0.9293
 Site-MNIST                         | Val  Loss: 0.4850 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.5930 | Val  Acc: 0.4835
 Site-SVHN                          | Val  Loss: 2.0251 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.1320 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5555
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9293
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8545
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.4835
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.2600
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 30 ============
 Site-USPS                          | Train Loss: 0.2472 | Train Acc: 0.9487
 Site-MNIST                         | Train Loss: 0.4804 | Train Acc: 0.8561
 Site-SynthDigits                   | Train Loss: 1.6469 | Train Acc: 0.4973
 Site-SVHN                          | Train Loss: 1.9987 | Train Acc: 0.2956
 Site-MNIST_M                       | Train Loss: 1.8654 | Train Acc: 0.3750
Average Train Accuracy: 0.5945
 Site-USPS                          | Val  Loss: 0.2748 | Val  Acc: 0.9360
 Site-MNIST                         | Val  Loss: 0.4723 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.5805 | Val  Acc: 0.4945
 Site-SVHN                          | Val  Loss: 2.0228 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1223 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5654
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9360
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8667
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.4945
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.2800
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 31 ============
 Site-USPS                          | Train Loss: 0.2459 | Train Acc: 0.9470
 Site-MNIST                         | Train Loss: 0.4879 | Train Acc: 0.8591
 Site-SynthDigits                   | Train Loss: 1.6349 | Train Acc: 0.5000
 Site-SVHN                          | Train Loss: 1.9428 | Train Acc: 0.2956
 Site-MNIST_M                       | Train Loss: 1.8399 | Train Acc: 0.3750
Average Train Accuracy: 0.5953
 Site-USPS                          | Val  Loss: 0.2629 | Val  Acc: 0.9293
 Site-MNIST                         | Val  Loss: 0.4615 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.5803 | Val  Acc: 0.4945
 Site-SVHN                          | Val  Loss: 2.0100 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1352 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5617
============ Train epoch 32 ============
 Site-USPS                          | Train Loss: 0.2333 | Train Acc: 0.9512
 Site-MNIST                         | Train Loss: 0.4513 | Train Acc: 0.8667
 Site-SynthDigits                   | Train Loss: 1.6290 | Train Acc: 0.5164
 Site-SVHN                          | Train Loss: 1.9592 | Train Acc: 0.2906
 Site-MNIST_M                       | Train Loss: 1.8310 | Train Acc: 0.3661
Average Train Accuracy: 0.5982
 Site-USPS                          | Val  Loss: 0.2563 | Val  Acc: 0.9428
 Site-MNIST                         | Val  Loss: 0.4432 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.5667 | Val  Acc: 0.5055
 Site-SVHN                          | Val  Loss: 2.0178 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.1418 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5578
============ Train epoch 33 ============
 Site-USPS                          | Train Loss: 0.2168 | Train Acc: 0.9504
 Site-MNIST                         | Train Loss: 0.4491 | Train Acc: 0.8636
 Site-SynthDigits                   | Train Loss: 1.6185 | Train Acc: 0.5027
 Site-SVHN                          | Train Loss: 2.0110 | Train Acc: 0.2857
 Site-MNIST_M                       | Train Loss: 1.8265 | Train Acc: 0.3750
Average Train Accuracy: 0.5955
 Site-USPS                          | Val  Loss: 0.2383 | Val  Acc: 0.9461
 Site-MNIST                         | Val  Loss: 0.4377 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.5560 | Val  Acc: 0.5275
 Site-SVHN                          | Val  Loss: 2.0031 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.1583 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5641
============ Train epoch 34 ============
 Site-USPS                          | Train Loss: 0.2153 | Train Acc: 0.9495
 Site-MNIST                         | Train Loss: 0.4618 | Train Acc: 0.8652
 Site-SynthDigits                   | Train Loss: 1.6172 | Train Acc: 0.4945
 Site-SVHN                          | Train Loss: 1.9824 | Train Acc: 0.2906
 Site-MNIST_M                       | Train Loss: 1.8203 | Train Acc: 0.3750
Average Train Accuracy: 0.5950
 Site-USPS                          | Val  Loss: 0.2341 | Val  Acc: 0.9428
 Site-MNIST                         | Val  Loss: 0.4321 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.5615 | Val  Acc: 0.5055
 Site-SVHN                          | Val  Loss: 1.9994 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.1297 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5603
============ Train epoch 35 ============
 Site-USPS                          | Train Loss: 0.2077 | Train Acc: 0.9563
 Site-MNIST                         | Train Loss: 0.4347 | Train Acc: 0.8697
 Site-SynthDigits                   | Train Loss: 1.6141 | Train Acc: 0.4973
 Site-SVHN                          | Train Loss: 2.0295 | Train Acc: 0.2759
 Site-MNIST_M                       | Train Loss: 1.8104 | Train Acc: 0.3750
Average Train Accuracy: 0.5948
 Site-USPS                          | Val  Loss: 0.2281 | Val  Acc: 0.9495
 Site-MNIST                         | Val  Loss: 0.4164 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.5269 | Val  Acc: 0.5385
 Site-SVHN                          | Val  Loss: 2.0041 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.0767 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5689
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9495
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.8667
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.5385
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.2400
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 36 ============
 Site-USPS                          | Train Loss: 0.2084 | Train Acc: 0.9546
 Site-MNIST                         | Train Loss: 0.4417 | Train Acc: 0.8697
 Site-SynthDigits                   | Train Loss: 1.5999 | Train Acc: 0.5191
 Site-SVHN                          | Train Loss: 2.0037 | Train Acc: 0.2956
 Site-MNIST_M                       | Train Loss: 1.7970 | Train Acc: 0.4107
Average Train Accuracy: 0.6099
 Site-USPS                          | Val  Loss: 0.2289 | Val  Acc: 0.9495
 Site-MNIST                         | Val  Loss: 0.4162 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.5227 | Val  Acc: 0.5604
 Site-SVHN                          | Val  Loss: 1.9902 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1113 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5837
 Best site-USPS                      | Epoch:36 | Val Acc: 0.9495
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.5604
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.2800
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 37 ============
 Site-USPS                          | Train Loss: 0.1997 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.4231 | Train Acc: 0.8712
 Site-SynthDigits                   | Train Loss: 1.5901 | Train Acc: 0.5109
 Site-SVHN                          | Train Loss: 2.0213 | Train Acc: 0.3005
 Site-MNIST_M                       | Train Loss: 1.7998 | Train Acc: 0.4107
Average Train Accuracy: 0.6101
 Site-USPS                          | Val  Loss: 0.2178 | Val  Acc: 0.9495
 Site-MNIST                         | Val  Loss: 0.4041 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.5100 | Val  Acc: 0.5604
 Site-SVHN                          | Val  Loss: 1.9908 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1231 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5813
============ Train epoch 38 ============
 Site-USPS                          | Train Loss: 0.1989 | Train Acc: 0.9588
 Site-MNIST                         | Train Loss: 0.4172 | Train Acc: 0.8727
 Site-SynthDigits                   | Train Loss: 1.5843 | Train Acc: 0.5137
 Site-SVHN                          | Train Loss: 1.9769 | Train Acc: 0.3005
 Site-MNIST_M                       | Train Loss: 1.7841 | Train Acc: 0.4286
Average Train Accuracy: 0.6148
 Site-USPS                          | Val  Loss: 0.2181 | Val  Acc: 0.9495
 Site-MNIST                         | Val  Loss: 0.3958 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.4993 | Val  Acc: 0.5495
 Site-SVHN                          | Val  Loss: 1.9870 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1006 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5803
============ Train epoch 39 ============
 Site-USPS                          | Train Loss: 0.1924 | Train Acc: 0.9605
 Site-MNIST                         | Train Loss: 0.4145 | Train Acc: 0.8727
 Site-SynthDigits                   | Train Loss: 1.5646 | Train Acc: 0.5246
 Site-SVHN                          | Train Loss: 1.9649 | Train Acc: 0.3005
 Site-MNIST_M                       | Train Loss: 1.7975 | Train Acc: 0.4107
Average Train Accuracy: 0.6138
 Site-USPS                          | Val  Loss: 0.2115 | Val  Acc: 0.9663
 Site-MNIST                         | Val  Loss: 0.3886 | Val  Acc: 0.8606
 Site-SynthDigits                   | Val  Loss: 1.5052 | Val  Acc: 0.5714
 Site-SVHN                          | Val  Loss: 1.9728 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1085 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5857
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9663
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8606
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.5714
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.2800
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 40 ============
 Site-USPS                          | Train Loss: 0.1886 | Train Acc: 0.9596
 Site-MNIST                         | Train Loss: 0.4013 | Train Acc: 0.8712
 Site-SynthDigits                   | Train Loss: 1.5651 | Train Acc: 0.5328
 Site-SVHN                          | Train Loss: 2.0042 | Train Acc: 0.2956
 Site-MNIST_M                       | Train Loss: 1.7754 | Train Acc: 0.4107
Average Train Accuracy: 0.6140
 Site-USPS                          | Val  Loss: 0.2065 | Val  Acc: 0.9529
 Site-MNIST                         | Val  Loss: 0.3861 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.4879 | Val  Acc: 0.5714
 Site-SVHN                          | Val  Loss: 1.9848 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.0717 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5842
============ Train epoch 41 ============
 Site-USPS                          | Train Loss: 0.1867 | Train Acc: 0.9613
 Site-MNIST                         | Train Loss: 0.4002 | Train Acc: 0.8773
 Site-SynthDigits                   | Train Loss: 1.5534 | Train Acc: 0.5273
 Site-SVHN                          | Train Loss: 1.9185 | Train Acc: 0.2956
 Site-MNIST_M                       | Train Loss: 1.8238 | Train Acc: 0.3839
Average Train Accuracy: 0.6091
 Site-USPS                          | Val  Loss: 0.2077 | Val  Acc: 0.9562
 Site-MNIST                         | Val  Loss: 0.3812 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.4904 | Val  Acc: 0.5275
 Site-SVHN                          | Val  Loss: 1.9816 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.1599 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5721
============ Train epoch 42 ============
 Site-USPS                          | Train Loss: 0.1797 | Train Acc: 0.9613
 Site-MNIST                         | Train Loss: 0.3716 | Train Acc: 0.8864
 Site-SynthDigits                   | Train Loss: 1.5428 | Train Acc: 0.5164
 Site-SVHN                          | Train Loss: 1.9295 | Train Acc: 0.3054
 Site-MNIST_M                       | Train Loss: 1.7758 | Train Acc: 0.4196
Average Train Accuracy: 0.6178
 Site-USPS                          | Val  Loss: 0.1945 | Val  Acc: 0.9663
 Site-MNIST                         | Val  Loss: 0.3586 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.4795 | Val  Acc: 0.5604
 Site-SVHN                          | Val  Loss: 1.9570 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.0638 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6066
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9663
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8848
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.5604
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.3000
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 43 ============
 Site-USPS                          | Train Loss: 0.1777 | Train Acc: 0.9613
 Site-MNIST                         | Train Loss: 0.3830 | Train Acc: 0.8742
 Site-SynthDigits                   | Train Loss: 1.5279 | Train Acc: 0.5355
 Site-SVHN                          | Train Loss: 2.0542 | Train Acc: 0.3054
 Site-MNIST_M                       | Train Loss: 1.7445 | Train Acc: 0.4286
Average Train Accuracy: 0.6210
 Site-USPS                          | Val  Loss: 0.1954 | Val  Acc: 0.9562
 Site-MNIST                         | Val  Loss: 0.3738 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.4532 | Val  Acc: 0.5495
 Site-SVHN                          | Val  Loss: 1.9637 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.0571 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5876
============ Train epoch 44 ============
 Site-USPS                          | Train Loss: 0.1778 | Train Acc: 0.9638
 Site-MNIST                         | Train Loss: 0.3716 | Train Acc: 0.8758
 Site-SynthDigits                   | Train Loss: 1.5324 | Train Acc: 0.5437
 Site-SVHN                          | Train Loss: 1.9301 | Train Acc: 0.3103
 Site-MNIST_M                       | Train Loss: 1.7376 | Train Acc: 0.4464
Average Train Accuracy: 0.6280
 Site-USPS                          | Val  Loss: 0.1976 | Val  Acc: 0.9596
 Site-MNIST                         | Val  Loss: 0.3593 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.4465 | Val  Acc: 0.5714
 Site-SVHN                          | Val  Loss: 1.9600 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.0491 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5927
============ Train epoch 45 ============
 Site-USPS                          | Train Loss: 0.1679 | Train Acc: 0.9672
 Site-MNIST                         | Train Loss: 0.3584 | Train Acc: 0.8742
 Site-SynthDigits                   | Train Loss: 1.5229 | Train Acc: 0.5464
 Site-SVHN                          | Train Loss: 1.9819 | Train Acc: 0.2956
 Site-MNIST_M                       | Train Loss: 1.7538 | Train Acc: 0.4464
Average Train Accuracy: 0.6260
 Site-USPS                          | Val  Loss: 0.1837 | Val  Acc: 0.9697
 Site-MNIST                         | Val  Loss: 0.3527 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.4439 | Val  Acc: 0.5714
 Site-SVHN                          | Val  Loss: 1.9480 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.0529 | Val  Acc: 0.3571
Average Valid Accuracy: 0.6130
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9697
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.8667
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.5714
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.3000
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 46 ============
 Site-USPS                          | Train Loss: 0.1709 | Train Acc: 0.9622
 Site-MNIST                         | Train Loss: 0.3671 | Train Acc: 0.8818
 Site-SynthDigits                   | Train Loss: 1.5250 | Train Acc: 0.5273
 Site-SVHN                          | Train Loss: 1.9342 | Train Acc: 0.2956
 Site-MNIST_M                       | Train Loss: 1.7383 | Train Acc: 0.4375
Average Train Accuracy: 0.6209
 Site-USPS                          | Val  Loss: 0.1918 | Val  Acc: 0.9596
 Site-MNIST                         | Val  Loss: 0.3494 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.4509 | Val  Acc: 0.5495
 Site-SVHN                          | Val  Loss: 1.9407 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.0848 | Val  Acc: 0.3214
Average Valid Accuracy: 0.5979
============ Train epoch 47 ============
 Site-USPS                          | Train Loss: 0.1656 | Train Acc: 0.9664
 Site-MNIST                         | Train Loss: 0.3695 | Train Acc: 0.8955
 Site-SynthDigits                   | Train Loss: 1.5260 | Train Acc: 0.5328
 Site-SVHN                          | Train Loss: 1.9345 | Train Acc: 0.2906
 Site-MNIST_M                       | Train Loss: 1.7147 | Train Acc: 0.4375
Average Train Accuracy: 0.6245
 Site-USPS                          | Val  Loss: 0.1799 | Val  Acc: 0.9663
 Site-MNIST                         | Val  Loss: 0.3317 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.4412 | Val  Acc: 0.5604
 Site-SVHN                          | Val  Loss: 1.9352 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.0068 | Val  Acc: 0.3571
Average Valid Accuracy: 0.6138
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9663
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.8848
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5604
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.3000
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/afl...
============ Train epoch 48 ============
 Site-USPS                          | Train Loss: 0.1657 | Train Acc: 0.9655
 Site-MNIST                         | Train Loss: 0.3529 | Train Acc: 0.8909
 Site-SynthDigits                   | Train Loss: 1.5143 | Train Acc: 0.5355
 Site-SVHN                          | Train Loss: 1.9822 | Train Acc: 0.2956
 Site-MNIST_M                       | Train Loss: 1.7307 | Train Acc: 0.4196
Average Train Accuracy: 0.6214
 Site-USPS                          | Val  Loss: 0.1814 | Val  Acc: 0.9596
 Site-MNIST                         | Val  Loss: 0.3286 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.4216 | Val  Acc: 0.5385
 Site-SVHN                          | Val  Loss: 1.9390 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.0361 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5909
============ Train epoch 49 ============
 Site-USPS                          | Train Loss: 0.1599 | Train Acc: 0.9655
 Site-MNIST                         | Train Loss: 0.3460 | Train Acc: 0.8985
 Site-SynthDigits                   | Train Loss: 1.4958 | Train Acc: 0.5574
 Site-SVHN                          | Train Loss: 2.0017 | Train Acc: 0.2906
 Site-MNIST_M                       | Train Loss: 1.7204 | Train Acc: 0.4107
Average Train Accuracy: 0.6245
 Site-USPS                          | Val  Loss: 0.1761 | Val  Acc: 0.9663
 Site-MNIST                         | Val  Loss: 0.3294 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.4279 | Val  Acc: 0.5385
 Site-SVHN                          | Val  Loss: 1.9395 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.0208 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6019
===2023-07-02 15:00:34===
===2023-07-02 15:00:35===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
Loading snapshots...
 Test site-USPS                      | Epoch:47 | Test Acc: 0.9441
 Test site-MNIST                     | Epoch:47 | Test Acc: 0.8749
 Test site-SynthDigits               | Epoch:47 | Test Acc: 0.4713
 Test site-SVHN                      | Epoch:47 | Test Acc: 0.2522
 Test site-MNIST_M                   | Epoch:47 | Test Acc: 0.3186
USPS: 0.9441, MNIST: 0.8749, SynthDigits: 0.4713, SVHN: 0.2522, MNIST_M: 0.3186, 
Average Test Accuracy(group): 0.5722, Average Test Accuracy(individual): 0.5722,
domain std=0.2852, cluster std=-1.0000, individual std=0.2852, 
