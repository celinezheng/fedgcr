===2023-07-02 17:22:00===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
============ Train epoch 0 ============
 Site-USPS                          | Train Loss: 0.7155 | Train Acc: 0.8511
 Site-MNIST                         | Train Loss: 1.2109 | Train Acc: 0.7076
 Site-SynthDigits                   | Train Loss: 2.0251 | Train Acc: 0.3060
 Site-SVHN                          | Train Loss: 2.2432 | Train Acc: 0.1281
 Site-MNIST_M                       | Train Loss: 2.1627 | Train Acc: 0.2232
Average Train Accuracy: 0.4432
 Site-USPS                          | Val  Loss: 0.7488 | Val  Acc: 0.8215
 Site-MNIST                         | Val  Loss: 1.1898 | Val  Acc: 0.7212
 Site-SynthDigits                   | Val  Loss: 2.0096 | Val  Acc: 0.3077
 Site-SVHN                          | Val  Loss: 2.2080 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.2500 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4387
 Best site-USPS                      | Epoch:0 | Val Acc: 0.8215
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7212
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.3077
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2000
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 1 ============
 Site-USPS                          | Train Loss: 0.4170 | Train Acc: 0.8949
 Site-MNIST                         | Train Loss: 0.7339 | Train Acc: 0.8091
 Site-SynthDigits                   | Train Loss: 1.9408 | Train Acc: 0.3552
 Site-SVHN                          | Train Loss: 2.2229 | Train Acc: 0.1872
 Site-MNIST_M                       | Train Loss: 2.0579 | Train Acc: 0.2768
Average Train Accuracy: 0.5046
 Site-USPS                          | Val  Loss: 0.4341 | Val  Acc: 0.8754
 Site-MNIST                         | Val  Loss: 0.7019 | Val  Acc: 0.8242
 Site-SynthDigits                   | Val  Loss: 1.8917 | Val  Acc: 0.3626
 Site-SVHN                          | Val  Loss: 2.1832 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.2570 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4953
 Best site-USPS                      | Epoch:1 | Val Acc: 0.8754
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8242
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3626
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2000
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 2 ============
 Site-USPS                          | Train Loss: 0.3056 | Train Acc: 0.9268
 Site-MNIST                         | Train Loss: 0.5546 | Train Acc: 0.8333
 Site-SynthDigits                   | Train Loss: 1.8675 | Train Acc: 0.3689
 Site-SVHN                          | Train Loss: 2.1590 | Train Acc: 0.2020
 Site-MNIST_M                       | Train Loss: 2.0134 | Train Acc: 0.2679
Average Train Accuracy: 0.5198
 Site-USPS                          | Val  Loss: 0.3187 | Val  Acc: 0.9024
 Site-MNIST                         | Val  Loss: 0.5427 | Val  Acc: 0.8424
 Site-SynthDigits                   | Val  Loss: 1.8248 | Val  Acc: 0.3846
 Site-SVHN                          | Val  Loss: 2.1742 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.2831 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4945
============ Train epoch 3 ============
 Site-USPS                          | Train Loss: 0.2442 | Train Acc: 0.9361
 Site-MNIST                         | Train Loss: 0.4510 | Train Acc: 0.8712
 Site-SynthDigits                   | Train Loss: 1.7857 | Train Acc: 0.4317
 Site-SVHN                          | Train Loss: 2.2032 | Train Acc: 0.2266
 Site-MNIST_M                       | Train Loss: 1.9767 | Train Acc: 0.2768
Average Train Accuracy: 0.5485
 Site-USPS                          | Val  Loss: 0.2568 | Val  Acc: 0.9226
 Site-MNIST                         | Val  Loss: 0.4106 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.7564 | Val  Acc: 0.4176
 Site-SVHN                          | Val  Loss: 2.1435 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.2568 | Val  Acc: 0.1071
Average Valid Accuracy: 0.5132
 Best site-USPS                      | Epoch:3 | Val Acc: 0.9226
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4176
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2400
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 4 ============
 Site-USPS                          | Train Loss: 0.2036 | Train Acc: 0.9437
 Site-MNIST                         | Train Loss: 0.4097 | Train Acc: 0.8742
 Site-SynthDigits                   | Train Loss: 1.7663 | Train Acc: 0.4126
 Site-SVHN                          | Train Loss: 2.1239 | Train Acc: 0.2167
 Site-MNIST_M                       | Train Loss: 1.9047 | Train Acc: 0.3304
Average Train Accuracy: 0.5555
 Site-USPS                          | Val  Loss: 0.2059 | Val  Acc: 0.9360
 Site-MNIST                         | Val  Loss: 0.3572 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.7067 | Val  Acc: 0.4396
 Site-SVHN                          | Val  Loss: 2.1202 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.2472 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5297
 Best site-USPS                      | Epoch:4 | Val Acc: 0.9360
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8545
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4396
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2400
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 5 ============
 Site-USPS                          | Train Loss: 0.1688 | Train Acc: 0.9613
 Site-MNIST                         | Train Loss: 0.3460 | Train Acc: 0.8848
 Site-SynthDigits                   | Train Loss: 1.7027 | Train Acc: 0.4454
 Site-SVHN                          | Train Loss: 2.2085 | Train Acc: 0.2463
 Site-MNIST_M                       | Train Loss: 1.8849 | Train Acc: 0.3482
Average Train Accuracy: 0.5772
 Site-USPS                          | Val  Loss: 0.1823 | Val  Acc: 0.9428
 Site-MNIST                         | Val  Loss: 0.3331 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.6479 | Val  Acc: 0.4945
 Site-SVHN                          | Val  Loss: 2.1240 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.3011 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5438
 Best site-USPS                      | Epoch:5 | Val Acc: 0.9428
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4945
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2600
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 6 ============
 Site-USPS                          | Train Loss: 0.1515 | Train Acc: 0.9655
 Site-MNIST                         | Train Loss: 0.2834 | Train Acc: 0.9348
 Site-SynthDigits                   | Train Loss: 1.6657 | Train Acc: 0.4672
 Site-SVHN                          | Train Loss: 2.1450 | Train Acc: 0.2414
 Site-MNIST_M                       | Train Loss: 1.8496 | Train Acc: 0.3750
Average Train Accuracy: 0.5968
 Site-USPS                          | Val  Loss: 0.1566 | Val  Acc: 0.9697
 Site-MNIST                         | Val  Loss: 0.2437 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.6179 | Val  Acc: 0.5055
 Site-SVHN                          | Val  Loss: 2.1161 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.2236 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5769
 Best site-USPS                      | Epoch:6 | Val Acc: 0.9697
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9394
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5055
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2200
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 7 ============
 Site-USPS                          | Train Loss: 0.1335 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.2750 | Train Acc: 0.9258
 Site-SynthDigits                   | Train Loss: 1.6414 | Train Acc: 0.4918
 Site-SVHN                          | Train Loss: 2.1228 | Train Acc: 0.2365
 Site-MNIST_M                       | Train Loss: 1.8026 | Train Acc: 0.3929
Average Train Accuracy: 0.6032
 Site-USPS                          | Val  Loss: 0.1458 | Val  Acc: 0.9630
 Site-MNIST                         | Val  Loss: 0.2344 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.5592 | Val  Acc: 0.5714
 Site-SVHN                          | Val  Loss: 2.0915 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.2113 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6027
 Best site-USPS                      | Epoch:7 | Val Acc: 0.9630
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9333
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5714
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2600
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 8 ============
 Site-USPS                          | Train Loss: 0.1088 | Train Acc: 0.9773
 Site-MNIST                         | Train Loss: 0.2804 | Train Acc: 0.9167
 Site-SynthDigits                   | Train Loss: 1.6106 | Train Acc: 0.4699
 Site-SVHN                          | Train Loss: 2.0784 | Train Acc: 0.2414
 Site-MNIST_M                       | Train Loss: 1.8129 | Train Acc: 0.3839
Average Train Accuracy: 0.5978
 Site-USPS                          | Val  Loss: 0.1208 | Val  Acc: 0.9663
 Site-MNIST                         | Val  Loss: 0.2507 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.5848 | Val  Acc: 0.5165
 Site-SVHN                          | Val  Loss: 2.0839 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.2461 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5807
============ Train epoch 9 ============
 Site-USPS                          | Train Loss: 0.1049 | Train Acc: 0.9790
 Site-MNIST                         | Train Loss: 0.2299 | Train Acc: 0.9258
 Site-SynthDigits                   | Train Loss: 1.5730 | Train Acc: 0.5027
 Site-SVHN                          | Train Loss: 2.0935 | Train Acc: 0.2709
 Site-MNIST_M                       | Train Loss: 1.8052 | Train Acc: 0.3750
Average Train Accuracy: 0.6107
 Site-USPS                          | Val  Loss: 0.1136 | Val  Acc: 0.9697
 Site-MNIST                         | Val  Loss: 0.2159 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.5253 | Val  Acc: 0.5604
 Site-SVHN                          | Val  Loss: 2.0755 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.2164 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6010
============ Train epoch 10 ============
 Site-USPS                          | Train Loss: 0.0986 | Train Acc: 0.9773
 Site-MNIST                         | Train Loss: 0.2114 | Train Acc: 0.9348
 Site-SynthDigits                   | Train Loss: 1.5478 | Train Acc: 0.5109
 Site-SVHN                          | Train Loss: 2.0915 | Train Acc: 0.2414
 Site-MNIST_M                       | Train Loss: 1.7796 | Train Acc: 0.3929
Average Train Accuracy: 0.6115
 Site-USPS                          | Val  Loss: 0.1031 | Val  Acc: 0.9764
 Site-MNIST                         | Val  Loss: 0.1841 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.5178 | Val  Acc: 0.5385
 Site-SVHN                          | Val  Loss: 2.1120 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1748 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6031
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9764
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9394
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5385
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2400
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 11 ============
 Site-USPS                          | Train Loss: 0.0846 | Train Acc: 0.9823
 Site-MNIST                         | Train Loss: 0.2078 | Train Acc: 0.9258
 Site-SynthDigits                   | Train Loss: 1.5438 | Train Acc: 0.5191
 Site-SVHN                          | Train Loss: 2.1593 | Train Acc: 0.2709
 Site-MNIST_M                       | Train Loss: 1.7841 | Train Acc: 0.4018
Average Train Accuracy: 0.6200
 Site-USPS                          | Val  Loss: 0.0868 | Val  Acc: 0.9832
 Site-MNIST                         | Val  Loss: 0.1984 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.5231 | Val  Acc: 0.5824
 Site-SVHN                          | Val  Loss: 2.0910 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.2425 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6096
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9832
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9212
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5824
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2400
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 12 ============
 Site-USPS                          | Train Loss: 0.0772 | Train Acc: 0.9832
 Site-MNIST                         | Train Loss: 0.1895 | Train Acc: 0.9409
 Site-SynthDigits                   | Train Loss: 1.4924 | Train Acc: 0.5246
 Site-SVHN                          | Train Loss: 2.1163 | Train Acc: 0.3153
 Site-MNIST_M                       | Train Loss: 1.7815 | Train Acc: 0.4107
Average Train Accuracy: 0.6349
 Site-USPS                          | Val  Loss: 0.0844 | Val  Acc: 0.9865
 Site-MNIST                         | Val  Loss: 0.1844 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.4534 | Val  Acc: 0.5714
 Site-SVHN                          | Val  Loss: 2.0412 | Val  Acc: 0.3200
 Site-MNIST_M                       | Val  Loss: 2.2168 | Val  Acc: 0.3571
Average Valid Accuracy: 0.6325
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9865
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9273
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.5714
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3200
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 13 ============
 Site-USPS                          | Train Loss: 0.0727 | Train Acc: 0.9899
 Site-MNIST                         | Train Loss: 0.1743 | Train Acc: 0.9485
 Site-SynthDigits                   | Train Loss: 1.4610 | Train Acc: 0.5328
 Site-SVHN                          | Train Loss: 1.9872 | Train Acc: 0.2660
 Site-MNIST_M                       | Train Loss: 1.7319 | Train Acc: 0.4375
Average Train Accuracy: 0.6349
 Site-USPS                          | Val  Loss: 0.0733 | Val  Acc: 0.9933
 Site-MNIST                         | Val  Loss: 0.1644 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.4134 | Val  Acc: 0.6154
 Site-SVHN                          | Val  Loss: 2.0712 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1482 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6203
============ Train epoch 14 ============
 Site-USPS                          | Train Loss: 0.0671 | Train Acc: 0.9907
 Site-MNIST                         | Train Loss: 0.1612 | Train Acc: 0.9515
 Site-SynthDigits                   | Train Loss: 1.4316 | Train Acc: 0.5328
 Site-SVHN                          | Train Loss: 2.2496 | Train Acc: 0.2660
 Site-MNIST_M                       | Train Loss: 1.7793 | Train Acc: 0.4286
Average Train Accuracy: 0.6339
 Site-USPS                          | Val  Loss: 0.0706 | Val  Acc: 0.9933
 Site-MNIST                         | Val  Loss: 0.1472 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.3937 | Val  Acc: 0.5934
 Site-SVHN                          | Val  Loss: 2.0480 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.2376 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6184
============ Train epoch 15 ============
 Site-USPS                          | Train Loss: 0.0654 | Train Acc: 0.9882
 Site-MNIST                         | Train Loss: 0.1442 | Train Acc: 0.9636
 Site-SynthDigits                   | Train Loss: 1.4738 | Train Acc: 0.5219
 Site-SVHN                          | Train Loss: 2.0558 | Train Acc: 0.2660
 Site-MNIST_M                       | Train Loss: 1.7458 | Train Acc: 0.4286
Average Train Accuracy: 0.6337
 Site-USPS                          | Val  Loss: 0.0681 | Val  Acc: 0.9933
 Site-MNIST                         | Val  Loss: 0.1264 | Val  Acc: 0.9758
 Site-SynthDigits                   | Val  Loss: 1.4647 | Val  Acc: 0.5824
 Site-SVHN                          | Val  Loss: 2.0855 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.2423 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6203
============ Train epoch 16 ============
 Site-USPS                          | Train Loss: 0.0571 | Train Acc: 0.9891
 Site-MNIST                         | Train Loss: 0.1443 | Train Acc: 0.9682
 Site-SynthDigits                   | Train Loss: 1.3851 | Train Acc: 0.5383
 Site-SVHN                          | Train Loss: 2.0682 | Train Acc: 0.2808
 Site-MNIST_M                       | Train Loss: 1.7623 | Train Acc: 0.4196
Average Train Accuracy: 0.6392
 Site-USPS                          | Val  Loss: 0.0623 | Val  Acc: 0.9865
 Site-MNIST                         | Val  Loss: 0.1341 | Val  Acc: 0.9576
 Site-SynthDigits                   | Val  Loss: 1.3534 | Val  Acc: 0.6154
 Site-SVHN                          | Val  Loss: 2.0405 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.1695 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6219
============ Train epoch 17 ============
 Site-USPS                          | Train Loss: 0.0540 | Train Acc: 0.9941
 Site-MNIST                         | Train Loss: 0.1465 | Train Acc: 0.9545
 Site-SynthDigits                   | Train Loss: 1.3507 | Train Acc: 0.5874
 Site-SVHN                          | Train Loss: 2.1146 | Train Acc: 0.2857
 Site-MNIST_M                       | Train Loss: 1.7685 | Train Acc: 0.4107
Average Train Accuracy: 0.6465
 Site-USPS                          | Val  Loss: 0.0578 | Val  Acc: 0.9966
 Site-MNIST                         | Val  Loss: 0.1338 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.3223 | Val  Acc: 0.6264
 Site-SVHN                          | Val  Loss: 2.0029 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.0697 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6025
============ Train epoch 18 ============
 Site-USPS                          | Train Loss: 0.0487 | Train Acc: 0.9958
 Site-MNIST                         | Train Loss: 0.1273 | Train Acc: 0.9667
 Site-SynthDigits                   | Train Loss: 1.3465 | Train Acc: 0.5710
 Site-SVHN                          | Train Loss: 2.1079 | Train Acc: 0.2857
 Site-MNIST_M                       | Train Loss: 1.7749 | Train Acc: 0.4375
Average Train Accuracy: 0.6513
 Site-USPS                          | Val  Loss: 0.0532 | Val  Acc: 0.9933
 Site-MNIST                         | Val  Loss: 0.1272 | Val  Acc: 0.9576
 Site-SynthDigits                   | Val  Loss: 1.3269 | Val  Acc: 0.6484
 Site-SVHN                          | Val  Loss: 2.0410 | Val  Acc: 0.3200
 Site-MNIST_M                       | Val  Loss: 2.2556 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6410
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9933
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9576
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.6484
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3200
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 19 ============
 Site-USPS                          | Train Loss: 0.0444 | Train Acc: 0.9966
 Site-MNIST                         | Train Loss: 0.1399 | Train Acc: 0.9636
 Site-SynthDigits                   | Train Loss: 1.3297 | Train Acc: 0.5765
 Site-SVHN                          | Train Loss: 1.9804 | Train Acc: 0.2956
 Site-MNIST_M                       | Train Loss: 1.7476 | Train Acc: 0.4286
Average Train Accuracy: 0.6522
 Site-USPS                          | Val  Loss: 0.0469 | Val  Acc: 0.9966
 Site-MNIST                         | Val  Loss: 0.1320 | Val  Acc: 0.9576
 Site-SynthDigits                   | Val  Loss: 1.3042 | Val  Acc: 0.6484
 Site-SVHN                          | Val  Loss: 2.0504 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 2.1311 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6457
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9966
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9576
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.6484
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3400
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 20 ============
 Site-USPS                          | Train Loss: 0.0381 | Train Acc: 0.9958
 Site-MNIST                         | Train Loss: 0.1127 | Train Acc: 0.9682
 Site-SynthDigits                   | Train Loss: 1.3397 | Train Acc: 0.5765
 Site-SVHN                          | Train Loss: 1.9904 | Train Acc: 0.2808
 Site-MNIST_M                       | Train Loss: 1.7296 | Train Acc: 0.4196
Average Train Accuracy: 0.6482
 Site-USPS                          | Val  Loss: 0.0369 | Val  Acc: 0.9966
 Site-MNIST                         | Val  Loss: 0.1082 | Val  Acc: 0.9636
 Site-SynthDigits                   | Val  Loss: 1.3180 | Val  Acc: 0.6593
 Site-SVHN                          | Val  Loss: 2.0083 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.1366 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6482
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9966
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9636
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.6593
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3000
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 21 ============
 Site-USPS                          | Train Loss: 0.0456 | Train Acc: 0.9933
 Site-MNIST                         | Train Loss: 0.1131 | Train Acc: 0.9636
 Site-SynthDigits                   | Train Loss: 1.3151 | Train Acc: 0.5738
 Site-SVHN                          | Train Loss: 2.1326 | Train Acc: 0.2956
 Site-MNIST_M                       | Train Loss: 1.7509 | Train Acc: 0.4107
Average Train Accuracy: 0.6474
 Site-USPS                          | Val  Loss: 0.0427 | Val  Acc: 0.9966
 Site-MNIST                         | Val  Loss: 0.0957 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.2968 | Val  Acc: 0.6484
 Site-SVHN                          | Val  Loss: 2.0584 | Val  Acc: 0.3200
 Site-MNIST_M                       | Val  Loss: 2.1214 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6441
============ Train epoch 22 ============
 Site-USPS                          | Train Loss: 0.0440 | Train Acc: 0.9958
 Site-MNIST                         | Train Loss: 0.1061 | Train Acc: 0.9652
 Site-SynthDigits                   | Train Loss: 1.2851 | Train Acc: 0.5902
 Site-SVHN                          | Train Loss: 2.1193 | Train Acc: 0.2956
 Site-MNIST_M                       | Train Loss: 1.7664 | Train Acc: 0.4464
Average Train Accuracy: 0.6586
 Site-USPS                          | Val  Loss: 0.0410 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0910 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.2537 | Val  Acc: 0.6264
 Site-SVHN                          | Val  Loss: 1.9977 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 2.1699 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6444
============ Train epoch 23 ============
 Site-USPS                          | Train Loss: 0.0364 | Train Acc: 0.9966
 Site-MNIST                         | Train Loss: 0.1050 | Train Acc: 0.9682
 Site-SynthDigits                   | Train Loss: 1.3198 | Train Acc: 0.5519
 Site-SVHN                          | Train Loss: 2.0057 | Train Acc: 0.3054
 Site-MNIST_M                       | Train Loss: 1.7101 | Train Acc: 0.4375
Average Train Accuracy: 0.6519
 Site-USPS                          | Val  Loss: 0.0374 | Val  Acc: 0.9966
 Site-MNIST                         | Val  Loss: 0.1058 | Val  Acc: 0.9636
 Site-SynthDigits                   | Val  Loss: 1.2847 | Val  Acc: 0.5824
 Site-SVHN                          | Val  Loss: 1.9690 | Val  Acc: 0.3200
 Site-MNIST_M                       | Val  Loss: 2.1741 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6297
============ Train epoch 24 ============
 Site-USPS                          | Train Loss: 0.0395 | Train Acc: 0.9950
 Site-MNIST                         | Train Loss: 0.0965 | Train Acc: 0.9788
 Site-SynthDigits                   | Train Loss: 1.2670 | Train Acc: 0.5874
 Site-SVHN                          | Train Loss: 2.0393 | Train Acc: 0.2956
 Site-MNIST_M                       | Train Loss: 1.7599 | Train Acc: 0.4464
Average Train Accuracy: 0.6606
 Site-USPS                          | Val  Loss: 0.0412 | Val  Acc: 0.9933
 Site-MNIST                         | Val  Loss: 0.0955 | Val  Acc: 0.9758
 Site-SynthDigits                   | Val  Loss: 1.2119 | Val  Acc: 0.6374
 Site-SVHN                          | Val  Loss: 1.9980 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.1944 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6456
============ Train epoch 25 ============
 Site-USPS                          | Train Loss: 0.0363 | Train Acc: 0.9992
 Site-MNIST                         | Train Loss: 0.0880 | Train Acc: 0.9773
 Site-SynthDigits                   | Train Loss: 1.2937 | Train Acc: 0.5656
 Site-SVHN                          | Train Loss: 2.0831 | Train Acc: 0.2956
 Site-MNIST_M                       | Train Loss: 1.7783 | Train Acc: 0.4375
Average Train Accuracy: 0.6550
 Site-USPS                          | Val  Loss: 0.0377 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0916 | Val  Acc: 0.9636
 Site-SynthDigits                   | Val  Loss: 1.2394 | Val  Acc: 0.5934
 Site-SVHN                          | Val  Loss: 2.0182 | Val  Acc: 0.3200
 Site-MNIST_M                       | Val  Loss: 2.1985 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6397
============ Train epoch 26 ============
 Site-USPS                          | Train Loss: 0.0280 | Train Acc: 0.9992
 Site-MNIST                         | Train Loss: 0.0967 | Train Acc: 0.9803
 Site-SynthDigits                   | Train Loss: 1.2156 | Train Acc: 0.5929
 Site-SVHN                          | Train Loss: 1.9919 | Train Acc: 0.3153
 Site-MNIST_M                       | Train Loss: 1.7614 | Train Acc: 0.4286
Average Train Accuracy: 0.6632
 Site-USPS                          | Val  Loss: 0.0303 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1028 | Val  Acc: 0.9636
 Site-SynthDigits                   | Val  Loss: 1.1501 | Val  Acc: 0.6374
 Site-SVHN                          | Val  Loss: 1.9548 | Val  Acc: 0.3600
 Site-MNIST_M                       | Val  Loss: 2.1589 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6565
 Best site-USPS                      | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9636
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.6374
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.3600
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 27 ============
 Site-USPS                          | Train Loss: 0.0259 | Train Acc: 0.9983
 Site-MNIST                         | Train Loss: 0.0987 | Train Acc: 0.9682
 Site-SynthDigits                   | Train Loss: 1.2358 | Train Acc: 0.5984
 Site-SVHN                          | Train Loss: 2.0945 | Train Acc: 0.2956
 Site-MNIST_M                       | Train Loss: 1.7397 | Train Acc: 0.4375
Average Train Accuracy: 0.6596
 Site-USPS                          | Val  Loss: 0.0278 | Val  Acc: 0.9966
 Site-MNIST                         | Val  Loss: 0.1114 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.1825 | Val  Acc: 0.6593
 Site-SVHN                          | Val  Loss: 1.9479 | Val  Acc: 0.3600
 Site-MNIST_M                       | Val  Loss: 2.1970 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6482
============ Train epoch 28 ============
 Site-USPS                          | Train Loss: 0.0275 | Train Acc: 0.9992
 Site-MNIST                         | Train Loss: 0.0842 | Train Acc: 0.9864
 Site-SynthDigits                   | Train Loss: 1.2071 | Train Acc: 0.6011
 Site-SVHN                          | Train Loss: 2.0494 | Train Acc: 0.3103
 Site-MNIST_M                       | Train Loss: 1.7714 | Train Acc: 0.4464
Average Train Accuracy: 0.6687
 Site-USPS                          | Val  Loss: 0.0284 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0835 | Val  Acc: 0.9758
 Site-SynthDigits                   | Val  Loss: 1.1707 | Val  Acc: 0.6484
 Site-SVHN                          | Val  Loss: 1.9477 | Val  Acc: 0.3600
 Site-MNIST_M                       | Val  Loss: 2.2033 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6611
 Best site-USPS                      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9758
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.6484
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.3600
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 29 ============
 Site-USPS                          | Train Loss: 0.0270 | Train Acc: 0.9983
 Site-MNIST                         | Train Loss: 0.0809 | Train Acc: 0.9788
 Site-SynthDigits                   | Train Loss: 1.1942 | Train Acc: 0.6011
 Site-SVHN                          | Train Loss: 1.8746 | Train Acc: 0.3103
 Site-MNIST_M                       | Train Loss: 1.7558 | Train Acc: 0.4375
Average Train Accuracy: 0.6652
 Site-USPS                          | Val  Loss: 0.0250 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0758 | Val  Acc: 0.9758
 Site-SynthDigits                   | Val  Loss: 1.1472 | Val  Acc: 0.6374
 Site-SVHN                          | Val  Loss: 1.9049 | Val  Acc: 0.3200
 Site-MNIST_M                       | Val  Loss: 2.1636 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6438
============ Train epoch 30 ============
 Site-USPS                          | Train Loss: 0.0256 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0767 | Train Acc: 0.9848
 Site-SynthDigits                   | Train Loss: 1.2061 | Train Acc: 0.5984
 Site-SVHN                          | Train Loss: 2.0001 | Train Acc: 0.3547
 Site-MNIST_M                       | Train Loss: 1.7351 | Train Acc: 0.4375
Average Train Accuracy: 0.6751
 Site-USPS                          | Val  Loss: 0.0253 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0723 | Val  Acc: 0.9758
 Site-SynthDigits                   | Val  Loss: 1.1598 | Val  Acc: 0.6374
 Site-SVHN                          | Val  Loss: 1.9444 | Val  Acc: 0.3800
 Site-MNIST_M                       | Val  Loss: 2.1843 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6558
============ Train epoch 31 ============
 Site-USPS                          | Train Loss: 0.0227 | Train Acc: 0.9992
 Site-MNIST                         | Train Loss: 0.0808 | Train Acc: 0.9864
 Site-SynthDigits                   | Train Loss: 1.2103 | Train Acc: 0.5984
 Site-SVHN                          | Train Loss: 1.9177 | Train Acc: 0.3350
 Site-MNIST_M                       | Train Loss: 1.7266 | Train Acc: 0.4464
Average Train Accuracy: 0.6731
 Site-USPS                          | Val  Loss: 0.0226 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0859 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 1.1553 | Val  Acc: 0.6484
 Site-SVHN                          | Val  Loss: 1.9422 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1680 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6332
============ Train epoch 32 ============
 Site-USPS                          | Train Loss: 0.0202 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0718 | Train Acc: 0.9864
 Site-SynthDigits                   | Train Loss: 1.1991 | Train Acc: 0.5984
 Site-SVHN                          | Train Loss: 2.0399 | Train Acc: 0.3202
 Site-MNIST_M                       | Train Loss: 1.6994 | Train Acc: 0.4554
Average Train Accuracy: 0.6721
 Site-USPS                          | Val  Loss: 0.0203 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0808 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 1.1394 | Val  Acc: 0.6703
 Site-SVHN                          | Val  Loss: 1.9390 | Val  Acc: 0.3800
 Site-MNIST_M                       | Val  Loss: 2.1471 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6636
 Best site-USPS                      | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9818
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.6703
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.3800
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 33 ============
 Site-USPS                          | Train Loss: 0.0196 | Train Acc: 0.9983
 Site-MNIST                         | Train Loss: 0.0799 | Train Acc: 0.9788
 Site-SynthDigits                   | Train Loss: 1.1828 | Train Acc: 0.6120
 Site-SVHN                          | Train Loss: 2.0897 | Train Acc: 0.3153
 Site-MNIST_M                       | Train Loss: 1.7372 | Train Acc: 0.4643
Average Train Accuracy: 0.6737
 Site-USPS                          | Val  Loss: 0.0191 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0896 | Val  Acc: 0.9636
 Site-SynthDigits                   | Val  Loss: 1.1365 | Val  Acc: 0.6813
 Site-SVHN                          | Val  Loss: 1.9087 | Val  Acc: 0.3600
 Site-MNIST_M                       | Val  Loss: 2.1987 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6581
============ Train epoch 34 ============
 Site-USPS                          | Train Loss: 0.0203 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0726 | Train Acc: 0.9848
 Site-SynthDigits                   | Train Loss: 1.1880 | Train Acc: 0.6175
 Site-SVHN                          | Train Loss: 1.9709 | Train Acc: 0.3054
 Site-MNIST_M                       | Train Loss: 1.7094 | Train Acc: 0.4375
Average Train Accuracy: 0.6691
 Site-USPS                          | Val  Loss: 0.0196 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0715 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 1.1383 | Val  Acc: 0.6703
 Site-SVHN                          | Val  Loss: 1.9202 | Val  Acc: 0.3600
 Site-MNIST_M                       | Val  Loss: 2.2083 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6679
 Best site-USPS                      | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9879
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.6703
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.3600
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 35 ============
 Site-USPS                          | Train Loss: 0.0206 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0712 | Train Acc: 0.9848
 Site-SynthDigits                   | Train Loss: 1.1870 | Train Acc: 0.5956
 Site-SVHN                          | Train Loss: 1.9562 | Train Acc: 0.3251
 Site-MNIST_M                       | Train Loss: 1.7491 | Train Acc: 0.4375
Average Train Accuracy: 0.6686
 Site-USPS                          | Val  Loss: 0.0200 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0734 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 1.1119 | Val  Acc: 0.6703
 Site-SVHN                          | Val  Loss: 1.9028 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 2.1888 | Val  Acc: 0.3571
Average Valid Accuracy: 0.6699
 Best site-USPS                      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9818
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.6703
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.3400
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/harmo-fl...
============ Train epoch 36 ============
 Site-USPS                          | Train Loss: 0.0214 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0659 | Train Acc: 0.9879
 Site-SynthDigits                   | Train Loss: 1.1653 | Train Acc: 0.6284
 Site-SVHN                          | Train Loss: 1.9939 | Train Acc: 0.3399
 Site-MNIST_M                       | Train Loss: 1.7586 | Train Acc: 0.4464
Average Train Accuracy: 0.6805
 Site-USPS                          | Val  Loss: 0.0216 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0627 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 1.1245 | Val  Acc: 0.6484
 Site-SVHN                          | Val  Loss: 1.9148 | Val  Acc: 0.3600
 Site-MNIST_M                       | Val  Loss: 2.2358 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6492
============ Train epoch 37 ============
 Site-USPS                          | Train Loss: 0.0185 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0726 | Train Acc: 0.9788
 Site-SynthDigits                   | Train Loss: 1.1802 | Train Acc: 0.6202
 Site-SVHN                          | Train Loss: 1.9782 | Train Acc: 0.3202
 Site-MNIST_M                       | Train Loss: 1.7050 | Train Acc: 0.4464
Average Train Accuracy: 0.6731
 Site-USPS                          | Val  Loss: 0.0182 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0698 | Val  Acc: 0.9758
 Site-SynthDigits                   | Val  Loss: 1.0997 | Val  Acc: 0.6484
 Site-SVHN                          | Val  Loss: 1.8925 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 2.1640 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6428
============ Train epoch 38 ============
 Site-USPS                          | Train Loss: 0.0184 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0655 | Train Acc: 0.9879
 Site-SynthDigits                   | Train Loss: 1.1329 | Train Acc: 0.6148
 Site-SVHN                          | Train Loss: 1.9394 | Train Acc: 0.3251
 Site-MNIST_M                       | Train Loss: 1.7501 | Train Acc: 0.4286
Average Train Accuracy: 0.6713
 Site-USPS                          | Val  Loss: 0.0196 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0666 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 1.0458 | Val  Acc: 0.6484
 Site-SVHN                          | Val  Loss: 1.9006 | Val  Acc: 0.3600
 Site-MNIST_M                       | Val  Loss: 2.1836 | Val  Acc: 0.2143
Average Valid Accuracy: 0.6409
============ Train epoch 39 ============
 Site-USPS                          | Train Loss: 0.0151 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0737 | Train Acc: 0.9848
 Site-SynthDigits                   | Train Loss: 1.1521 | Train Acc: 0.6066
 Site-SVHN                          | Train Loss: 1.9254 | Train Acc: 0.3448
 Site-MNIST_M                       | Train Loss: 1.7517 | Train Acc: 0.4196
Average Train Accuracy: 0.6712
 Site-USPS                          | Val  Loss: 0.0163 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0757 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 1.0984 | Val  Acc: 0.6593
 Site-SVHN                          | Val  Loss: 1.8765 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 2.2108 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6462
============ Train epoch 40 ============
 Site-USPS                          | Train Loss: 0.0183 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0591 | Train Acc: 0.9924
 Site-SynthDigits                   | Train Loss: 1.1575 | Train Acc: 0.6148
 Site-SVHN                          | Train Loss: 1.9820 | Train Acc: 0.3202
 Site-MNIST_M                       | Train Loss: 1.7467 | Train Acc: 0.4286
Average Train Accuracy: 0.6712
 Site-USPS                          | Val  Loss: 0.0171 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0590 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 1.0876 | Val  Acc: 0.6374
 Site-SVHN                          | Val  Loss: 1.8729 | Val  Acc: 0.3600
 Site-MNIST_M                       | Val  Loss: 2.1494 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6470
============ Train epoch 41 ============
 Site-USPS                          | Train Loss: 0.0161 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0618 | Train Acc: 0.9894
 Site-SynthDigits                   | Train Loss: 1.1558 | Train Acc: 0.6120
 Site-SVHN                          | Train Loss: 2.0203 | Train Acc: 0.3005
 Site-MNIST_M                       | Train Loss: 1.7210 | Train Acc: 0.4286
Average Train Accuracy: 0.6661
 Site-USPS                          | Val  Loss: 0.0156 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0669 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 1.0991 | Val  Acc: 0.6593
 Site-SVHN                          | Val  Loss: 1.8863 | Val  Acc: 0.3800
 Site-MNIST_M                       | Val  Loss: 2.1653 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6685
============ Train epoch 42 ============
 Site-USPS                          | Train Loss: 0.0154 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0665 | Train Acc: 0.9894
 Site-SynthDigits                   | Train Loss: 1.1228 | Train Acc: 0.6230
 Site-SVHN                          | Train Loss: 1.9914 | Train Acc: 0.3251
 Site-MNIST_M                       | Train Loss: 1.7218 | Train Acc: 0.4107
Average Train Accuracy: 0.6696
 Site-USPS                          | Val  Loss: 0.0156 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0714 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 1.0989 | Val  Acc: 0.6703
 Site-SVHN                          | Val  Loss: 1.9020 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 2.1924 | Val  Acc: 0.2143
Average Valid Accuracy: 0.6545
============ Train epoch 43 ============
 Site-USPS                          | Train Loss: 0.0155 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0647 | Train Acc: 0.9909
 Site-SynthDigits                   | Train Loss: 1.1394 | Train Acc: 0.6284
 Site-SVHN                          | Train Loss: 1.9118 | Train Acc: 0.3399
 Site-MNIST_M                       | Train Loss: 1.7467 | Train Acc: 0.4018
Average Train Accuracy: 0.6722
 Site-USPS                          | Val  Loss: 0.0142 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0611 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 1.1212 | Val  Acc: 0.6593
 Site-SVHN                          | Val  Loss: 1.8277 | Val  Acc: 0.3600
 Site-MNIST_M                       | Val  Loss: 2.1289 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6514
============ Train epoch 44 ============
 Site-USPS                          | Train Loss: 0.0159 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0578 | Train Acc: 0.9909
 Site-SynthDigits                   | Train Loss: 1.1461 | Train Acc: 0.6421
 Site-SVHN                          | Train Loss: 1.8791 | Train Acc: 0.3153
 Site-MNIST_M                       | Train Loss: 1.8002 | Train Acc: 0.4375
Average Train Accuracy: 0.6772
 Site-USPS                          | Val  Loss: 0.0152 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0627 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 1.0918 | Val  Acc: 0.6703
 Site-SVHN                          | Val  Loss: 1.8771 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 2.2920 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6509
============ Train epoch 45 ============
 Site-USPS                          | Train Loss: 0.0143 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0577 | Train Acc: 0.9924
 Site-SynthDigits                   | Train Loss: 1.1587 | Train Acc: 0.6011
 Site-SVHN                          | Train Loss: 2.0054 | Train Acc: 0.3596
 Site-MNIST_M                       | Train Loss: 1.7210 | Train Acc: 0.4286
Average Train Accuracy: 0.6763
 Site-USPS                          | Val  Loss: 0.0139 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0625 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 1.1248 | Val  Acc: 0.6154
 Site-SVHN                          | Val  Loss: 1.8732 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 2.1226 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6507
============ Train epoch 46 ============
 Site-USPS                          | Train Loss: 0.0165 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0579 | Train Acc: 0.9909
 Site-SynthDigits                   | Train Loss: 1.1231 | Train Acc: 0.6230
 Site-SVHN                          | Train Loss: 1.9318 | Train Acc: 0.3596
 Site-MNIST_M                       | Train Loss: 1.7699 | Train Acc: 0.3750
Average Train Accuracy: 0.6697
 Site-USPS                          | Val  Loss: 0.0183 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0606 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 1.0662 | Val  Acc: 0.6813
 Site-SVHN                          | Val  Loss: 1.8768 | Val  Acc: 0.3800
 Site-MNIST_M                       | Val  Loss: 2.2182 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6611
============ Train epoch 47 ============
 Site-USPS                          | Train Loss: 0.0135 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0748 | Train Acc: 0.9803
 Site-SynthDigits                   | Train Loss: 1.1552 | Train Acc: 0.5847
 Site-SVHN                          | Train Loss: 1.9552 | Train Acc: 0.3596
 Site-MNIST_M                       | Train Loss: 1.6920 | Train Acc: 0.4107
Average Train Accuracy: 0.6671
 Site-USPS                          | Val  Loss: 0.0139 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0853 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.1103 | Val  Acc: 0.6044
 Site-SVHN                          | Val  Loss: 1.8475 | Val  Acc: 0.3800
 Site-MNIST_M                       | Val  Loss: 2.1695 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6480
============ Train epoch 48 ============
 Site-USPS                          | Train Loss: 0.0143 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0616 | Train Acc: 0.9894
 Site-SynthDigits                   | Train Loss: 1.1409 | Train Acc: 0.6038
 Site-SVHN                          | Train Loss: 2.0045 | Train Acc: 0.3153
 Site-MNIST_M                       | Train Loss: 1.6972 | Train Acc: 0.4196
Average Train Accuracy: 0.6656
 Site-USPS                          | Val  Loss: 0.0151 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0720 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 1.0884 | Val  Acc: 0.6484
 Site-SVHN                          | Val  Loss: 1.9026 | Val  Acc: 0.3600
 Site-MNIST_M                       | Val  Loss: 2.2298 | Val  Acc: 0.2143
Average Valid Accuracy: 0.6409
============ Train epoch 49 ============
 Site-USPS                          | Train Loss: 0.0129 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0600 | Train Acc: 0.9955
 Site-SynthDigits                   | Train Loss: 1.1224 | Train Acc: 0.6311
 Site-SVHN                          | Train Loss: 2.0061 | Train Acc: 0.3399
 Site-MNIST_M                       | Train Loss: 1.6951 | Train Acc: 0.4107
Average Train Accuracy: 0.6754
 Site-USPS                          | Val  Loss: 0.0128 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0704 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 1.0695 | Val  Acc: 0.6484
 Site-SVHN                          | Val  Loss: 1.8668 | Val  Acc: 0.3800
 Site-MNIST_M                       | Val  Loss: 2.1728 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6545
===2023-07-02 20:10:17===
===2023-07-02 20:10:19===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
Loading snapshots...
 Test site-USPS                      | Epoch:35 | Test Acc: 0.9527
 Test site-MNIST                     | Epoch:35 | Test Acc: 0.9166
 Test site-SynthDigits               | Epoch:35 | Test Acc: 0.5061
 Test site-SVHN                      | Epoch:35 | Test Acc: 0.2393
 Test site-MNIST_M                   | Epoch:35 | Test Acc: 0.3243
USPS: 0.9527, MNIST: 0.9166, SynthDigits: 0.5061, SVHN: 0.2393, MNIST_M: 0.3243, 
Average Test Accuracy(group): 0.5878, Average Test Accuracy(individual): 0.5878,
domain std=0.2962, cluster std=-1.0000, individual std=0.2962, 
