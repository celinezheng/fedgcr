===2023-07-02 20:26:55===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
============ Train epoch 0 ============
===2023-07-02 20:27:04===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
Loading snapshots...
===2023-07-03 05:58:51===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
============ Train epoch 0 ============
 Site-USPS                          | Train Loss: 1.7015 | Train Acc: 0.7603
 Site-MNIST                         | Train Loss: 1.8970 | Train Acc: 0.5803
 Site-SynthDigits                   | Train Loss: 2.1969 | Train Acc: 0.2814
 Site-SVHN                          | Train Loss: 2.2854 | Train Acc: 0.1084
 Site-MNIST_M                       | Train Loss: 2.2571 | Train Acc: 0.1875
Average Train Accuracy: 0.3836
 Site-USPS                          | Val  Loss: 1.7457 | Val  Acc: 0.7273
 Site-MNIST                         | Val  Loss: 1.9015 | Val  Acc: 0.6000
 Site-SynthDigits                   | Val  Loss: 2.1926 | Val  Acc: 0.3187
 Site-SVHN                          | Val  Loss: 2.2794 | Val  Acc: 0.1600
 Site-MNIST_M                       | Val  Loss: 2.2990 | Val  Acc: 0.0714
Average Valid Accuracy: 0.3755
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7273
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6000
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.3187
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1600
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.0714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 1 ============
 Site-USPS                          | Train Loss: 1.2935 | Train Acc: 0.7822
 Site-MNIST                         | Train Loss: 1.6093 | Train Acc: 0.6364
 Site-SynthDigits                   | Train Loss: 2.0995 | Train Acc: 0.3060
 Site-SVHN                          | Train Loss: 2.2766 | Train Acc: 0.1182
 Site-MNIST_M                       | Train Loss: 2.2334 | Train Acc: 0.1964
Average Train Accuracy: 0.4078
 Site-USPS                          | Val  Loss: 1.3508 | Val  Acc: 0.7576
 Site-MNIST                         | Val  Loss: 1.6172 | Val  Acc: 0.6909
 Site-SynthDigits                   | Val  Loss: 2.0777 | Val  Acc: 0.3187
 Site-SVHN                          | Val  Loss: 2.2750 | Val  Acc: 0.1200
 Site-MNIST_M                       | Val  Loss: 2.2660 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4131
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7576
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6909
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3187
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1200
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 2 ============
 Site-USPS                          | Train Loss: 0.9802 | Train Acc: 0.8192
 Site-MNIST                         | Train Loss: 1.3424 | Train Acc: 0.6909
 Site-SynthDigits                   | Train Loss: 2.0385 | Train Acc: 0.3115
 Site-SVHN                          | Train Loss: 2.2571 | Train Acc: 0.1084
 Site-MNIST_M                       | Train Loss: 2.2017 | Train Acc: 0.2054
Average Train Accuracy: 0.4271
 Site-USPS                          | Val  Loss: 1.0494 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 1.3474 | Val  Acc: 0.7333
 Site-SynthDigits                   | Val  Loss: 2.0248 | Val  Acc: 0.3077
 Site-SVHN                          | Val  Loss: 2.2704 | Val  Acc: 0.1400
 Site-MNIST_M                       | Val  Loss: 2.2540 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4275
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7333
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3077
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.1400
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 3 ============
 Site-USPS                          | Train Loss: 0.7847 | Train Acc: 0.8612
 Site-MNIST                         | Train Loss: 1.2353 | Train Acc: 0.6985
 Site-SynthDigits                   | Train Loss: 1.9875 | Train Acc: 0.3333
 Site-SVHN                          | Train Loss: 2.2561 | Train Acc: 0.1084
 Site-MNIST_M                       | Train Loss: 2.1836 | Train Acc: 0.2411
Average Train Accuracy: 0.4485
 Site-USPS                          | Val  Loss: 0.8427 | Val  Acc: 0.8451
 Site-MNIST                         | Val  Loss: 1.2342 | Val  Acc: 0.7455
 Site-SynthDigits                   | Val  Loss: 1.9735 | Val  Acc: 0.3297
 Site-SVHN                          | Val  Loss: 2.2668 | Val  Acc: 0.1400
 Site-MNIST_M                       | Val  Loss: 2.2659 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4549
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8451
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7455
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3297
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.1400
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 4 ============
 Site-USPS                          | Train Loss: 0.6470 | Train Acc: 0.8772
 Site-MNIST                         | Train Loss: 1.0684 | Train Acc: 0.7197
 Site-SynthDigits                   | Train Loss: 1.9645 | Train Acc: 0.3197
 Site-SVHN                          | Train Loss: 2.2510 | Train Acc: 0.1232
 Site-MNIST_M                       | Train Loss: 2.1601 | Train Acc: 0.2411
Average Train Accuracy: 0.4562
 Site-USPS                          | Val  Loss: 0.6948 | Val  Acc: 0.8586
 Site-MNIST                         | Val  Loss: 1.0674 | Val  Acc: 0.7515
 Site-SynthDigits                   | Val  Loss: 1.9448 | Val  Acc: 0.3516
 Site-SVHN                          | Val  Loss: 2.2600 | Val  Acc: 0.1400
 Site-MNIST_M                       | Val  Loss: 2.2829 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4632
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8586
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7515
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3516
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.1400
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 5 ============
 Site-USPS                          | Train Loss: 0.5378 | Train Acc: 0.8949
 Site-MNIST                         | Train Loss: 1.0090 | Train Acc: 0.7333
 Site-SynthDigits                   | Train Loss: 1.9252 | Train Acc: 0.3279
 Site-SVHN                          | Train Loss: 2.2684 | Train Acc: 0.1379
 Site-MNIST_M                       | Train Loss: 2.1760 | Train Acc: 0.2589
Average Train Accuracy: 0.4706
 Site-USPS                          | Val  Loss: 0.5848 | Val  Acc: 0.8754
 Site-MNIST                         | Val  Loss: 0.9990 | Val  Acc: 0.7576
 Site-SynthDigits                   | Val  Loss: 1.9048 | Val  Acc: 0.3297
 Site-SVHN                          | Val  Loss: 2.2610 | Val  Acc: 0.1400
 Site-MNIST_M                       | Val  Loss: 2.3366 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4634
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8754
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7576
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3297
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.1400
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 6 ============
 Site-USPS                          | Train Loss: 0.4935 | Train Acc: 0.8940
 Site-MNIST                         | Train Loss: 0.9206 | Train Acc: 0.7621
 Site-SynthDigits                   | Train Loss: 1.9287 | Train Acc: 0.3306
 Site-SVHN                          | Train Loss: 2.2427 | Train Acc: 0.1281
 Site-MNIST_M                       | Train Loss: 2.1366 | Train Acc: 0.2768
Average Train Accuracy: 0.4783
 Site-USPS                          | Val  Loss: 0.5341 | Val  Acc: 0.8721
 Site-MNIST                         | Val  Loss: 0.9152 | Val  Acc: 0.8000
 Site-SynthDigits                   | Val  Loss: 1.8821 | Val  Acc: 0.3407
 Site-SVHN                          | Val  Loss: 2.2449 | Val  Acc: 0.1600
 Site-MNIST_M                       | Val  Loss: 2.3192 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4774
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8721
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8000
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3407
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.1600
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 7 ============
 Site-USPS                          | Train Loss: 0.4276 | Train Acc: 0.9033
 Site-MNIST                         | Train Loss: 0.8570 | Train Acc: 0.7818
 Site-SynthDigits                   | Train Loss: 1.8811 | Train Acc: 0.3552
 Site-SVHN                          | Train Loss: 2.2333 | Train Acc: 0.1429
 Site-MNIST_M                       | Train Loss: 2.0915 | Train Acc: 0.2411
Average Train Accuracy: 0.4848
 Site-USPS                          | Val  Loss: 0.4764 | Val  Acc: 0.8822
 Site-MNIST                         | Val  Loss: 0.8396 | Val  Acc: 0.8121
 Site-SynthDigits                   | Val  Loss: 1.8582 | Val  Acc: 0.3516
 Site-SVHN                          | Val  Loss: 2.2234 | Val  Acc: 0.1600
 Site-MNIST_M                       | Val  Loss: 2.3354 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4698
============ Train epoch 8 ============
 Site-USPS                          | Train Loss: 0.3772 | Train Acc: 0.9125
 Site-MNIST                         | Train Loss: 0.8133 | Train Acc: 0.7848
 Site-SynthDigits                   | Train Loss: 1.8629 | Train Acc: 0.3579
 Site-SVHN                          | Train Loss: 2.2437 | Train Acc: 0.1527
 Site-MNIST_M                       | Train Loss: 2.0904 | Train Acc: 0.2411
Average Train Accuracy: 0.4898
 Site-USPS                          | Val  Loss: 0.4227 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.7818 | Val  Acc: 0.8242
 Site-SynthDigits                   | Val  Loss: 1.8615 | Val  Acc: 0.3187
 Site-SVHN                          | Val  Loss: 2.2220 | Val  Acc: 0.1600
 Site-MNIST_M                       | Val  Loss: 2.3285 | Val  Acc: 0.1071
Average Valid Accuracy: 0.4598
============ Train epoch 9 ============
 Site-USPS                          | Train Loss: 0.3558 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.7456 | Train Acc: 0.8091
 Site-SynthDigits                   | Train Loss: 1.8308 | Train Acc: 0.3716
 Site-SVHN                          | Train Loss: 2.2225 | Train Acc: 0.1872
 Site-MNIST_M                       | Train Loss: 2.1415 | Train Acc: 0.2232
Average Train Accuracy: 0.5016
 Site-USPS                          | Val  Loss: 0.3964 | Val  Acc: 0.8923
 Site-MNIST                         | Val  Loss: 0.7162 | Val  Acc: 0.8364
 Site-SynthDigits                   | Val  Loss: 1.8314 | Val  Acc: 0.3516
 Site-SVHN                          | Val  Loss: 2.2120 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.3787 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4846
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8923
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8364
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.3516
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2000
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 10 ============
 Site-USPS                          | Train Loss: 0.3271 | Train Acc: 0.9218
 Site-MNIST                         | Train Loss: 0.6749 | Train Acc: 0.8212
 Site-SynthDigits                   | Train Loss: 1.8341 | Train Acc: 0.3825
 Site-SVHN                          | Train Loss: 2.2509 | Train Acc: 0.1823
 Site-MNIST_M                       | Train Loss: 2.0656 | Train Acc: 0.2768
Average Train Accuracy: 0.5169
 Site-USPS                          | Val  Loss: 0.3640 | Val  Acc: 0.9024
 Site-MNIST                         | Val  Loss: 0.6488 | Val  Acc: 0.8424
 Site-SynthDigits                   | Val  Loss: 1.8229 | Val  Acc: 0.3407
 Site-SVHN                          | Val  Loss: 2.1983 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.2812 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4857
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9024
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8424
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3407
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2000
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 11 ============
 Site-USPS                          | Train Loss: 0.3087 | Train Acc: 0.9176
 Site-MNIST                         | Train Loss: 0.6254 | Train Acc: 0.8424
 Site-SynthDigits                   | Train Loss: 1.8004 | Train Acc: 0.3743
 Site-SVHN                          | Train Loss: 2.2192 | Train Acc: 0.1823
 Site-MNIST_M                       | Train Loss: 2.0169 | Train Acc: 0.2857
Average Train Accuracy: 0.5205
 Site-USPS                          | Val  Loss: 0.3529 | Val  Acc: 0.8956
 Site-MNIST                         | Val  Loss: 0.5942 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.8210 | Val  Acc: 0.3297
 Site-SVHN                          | Val  Loss: 2.1815 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.2408 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4953
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8956
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8727
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.3297
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2000
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 12 ============
 Site-USPS                          | Train Loss: 0.2878 | Train Acc: 0.9352
 Site-MNIST                         | Train Loss: 0.6137 | Train Acc: 0.8439
 Site-SynthDigits                   | Train Loss: 1.8074 | Train Acc: 0.3880
 Site-SVHN                          | Train Loss: 2.1848 | Train Acc: 0.2167
 Site-MNIST_M                       | Train Loss: 2.0399 | Train Acc: 0.2500
Average Train Accuracy: 0.5268
 Site-USPS                          | Val  Loss: 0.3260 | Val  Acc: 0.9158
 Site-MNIST                         | Val  Loss: 0.5803 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.7890 | Val  Acc: 0.3297
 Site-SVHN                          | Val  Loss: 2.1975 | Val  Acc: 0.1800
 Site-MNIST_M                       | Val  Loss: 2.3193 | Val  Acc: 0.1071
Average Valid Accuracy: 0.4811
============ Train epoch 13 ============
 Site-USPS                          | Train Loss: 0.2684 | Train Acc: 0.9302
 Site-MNIST                         | Train Loss: 0.5953 | Train Acc: 0.8424
 Site-SynthDigits                   | Train Loss: 1.7652 | Train Acc: 0.4126
 Site-SVHN                          | Train Loss: 2.1747 | Train Acc: 0.2118
 Site-MNIST_M                       | Train Loss: 2.0354 | Train Acc: 0.2857
Average Train Accuracy: 0.5365
 Site-USPS                          | Val  Loss: 0.3109 | Val  Acc: 0.9125
 Site-MNIST                         | Val  Loss: 0.5561 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.7654 | Val  Acc: 0.4066
 Site-SVHN                          | Val  Loss: 2.1843 | Val  Acc: 0.1800
 Site-MNIST_M                       | Val  Loss: 2.2849 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5064
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9125
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8545
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4066
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.1800
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 14 ============
 Site-USPS                          | Train Loss: 0.2641 | Train Acc: 0.9352
 Site-MNIST                         | Train Loss: 0.5651 | Train Acc: 0.8470
 Site-SynthDigits                   | Train Loss: 1.7259 | Train Acc: 0.4262
 Site-SVHN                          | Train Loss: 2.2092 | Train Acc: 0.2463
 Site-MNIST_M                       | Train Loss: 2.0203 | Train Acc: 0.2679
Average Train Accuracy: 0.5445
 Site-USPS                          | Val  Loss: 0.2996 | Val  Acc: 0.9158
 Site-MNIST                         | Val  Loss: 0.5324 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.7494 | Val  Acc: 0.3846
 Site-SVHN                          | Val  Loss: 2.1901 | Val  Acc: 0.1800
 Site-MNIST_M                       | Val  Loss: 2.3034 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4956
============ Train epoch 15 ============
 Site-USPS                          | Train Loss: 0.2469 | Train Acc: 0.9378
 Site-MNIST                         | Train Loss: 0.5456 | Train Acc: 0.8515
 Site-SynthDigits                   | Train Loss: 1.7270 | Train Acc: 0.4481
 Site-SVHN                          | Train Loss: 2.2116 | Train Acc: 0.2463
 Site-MNIST_M                       | Train Loss: 2.0186 | Train Acc: 0.2946
Average Train Accuracy: 0.5557
 Site-USPS                          | Val  Loss: 0.2785 | Val  Acc: 0.9192
 Site-MNIST                         | Val  Loss: 0.5214 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.7305 | Val  Acc: 0.4066
 Site-SVHN                          | Val  Loss: 2.1447 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.2682 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5158
 Best site-USPS                      | Epoch:15 | Val Acc: 0.9192
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8545
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4066
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2200
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 16 ============
 Site-USPS                          | Train Loss: 0.2320 | Train Acc: 0.9394
 Site-MNIST                         | Train Loss: 0.5097 | Train Acc: 0.8576
 Site-SynthDigits                   | Train Loss: 1.7029 | Train Acc: 0.4426
 Site-SVHN                          | Train Loss: 2.1354 | Train Acc: 0.2463
 Site-MNIST_M                       | Train Loss: 2.0282 | Train Acc: 0.3304
Average Train Accuracy: 0.5633
 Site-USPS                          | Val  Loss: 0.2748 | Val  Acc: 0.9192
 Site-MNIST                         | Val  Loss: 0.4852 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.7091 | Val  Acc: 0.4066
 Site-SVHN                          | Val  Loss: 2.1556 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.2732 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5341
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9192
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8545
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4066
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.2400
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 17 ============
 Site-USPS                          | Train Loss: 0.2358 | Train Acc: 0.9420
 Site-MNIST                         | Train Loss: 0.4858 | Train Acc: 0.8636
 Site-SynthDigits                   | Train Loss: 1.6903 | Train Acc: 0.4426
 Site-SVHN                          | Train Loss: 2.1633 | Train Acc: 0.2611
 Site-MNIST_M                       | Train Loss: 2.0366 | Train Acc: 0.3036
Average Train Accuracy: 0.5626
 Site-USPS                          | Val  Loss: 0.2692 | Val  Acc: 0.9226
 Site-MNIST                         | Val  Loss: 0.4447 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.7113 | Val  Acc: 0.3956
 Site-SVHN                          | Val  Loss: 2.1567 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.2925 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5191
============ Train epoch 18 ============
 Site-USPS                          | Train Loss: 0.2167 | Train Acc: 0.9462
 Site-MNIST                         | Train Loss: 0.4809 | Train Acc: 0.8742
 Site-SynthDigits                   | Train Loss: 1.6975 | Train Acc: 0.4563
 Site-SVHN                          | Train Loss: 2.1790 | Train Acc: 0.2611
 Site-MNIST_M                       | Train Loss: 2.0191 | Train Acc: 0.2946
Average Train Accuracy: 0.5665
 Site-USPS                          | Val  Loss: 0.2518 | Val  Acc: 0.9327
 Site-MNIST                         | Val  Loss: 0.4415 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.6764 | Val  Acc: 0.4176
 Site-SVHN                          | Val  Loss: 2.1316 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.2743 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5319
============ Train epoch 19 ============
 Site-USPS                          | Train Loss: 0.2064 | Train Acc: 0.9512
 Site-MNIST                         | Train Loss: 0.4605 | Train Acc: 0.8667
 Site-SynthDigits                   | Train Loss: 1.6478 | Train Acc: 0.4454
 Site-SVHN                          | Train Loss: 2.1589 | Train Acc: 0.2512
 Site-MNIST_M                       | Train Loss: 1.9879 | Train Acc: 0.3125
Average Train Accuracy: 0.5654
 Site-USPS                          | Val  Loss: 0.2357 | Val  Acc: 0.9360
 Site-MNIST                         | Val  Loss: 0.4302 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.6818 | Val  Acc: 0.4286
 Site-SVHN                          | Val  Loss: 2.1242 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.2768 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5380
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9360
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8909
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4286
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.2200
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 20 ============
 Site-USPS                          | Train Loss: 0.2046 | Train Acc: 0.9462
 Site-MNIST                         | Train Loss: 0.4515 | Train Acc: 0.8697
 Site-SynthDigits                   | Train Loss: 1.6423 | Train Acc: 0.4590
 Site-SVHN                          | Train Loss: 2.1684 | Train Acc: 0.2512
 Site-MNIST_M                       | Train Loss: 1.9617 | Train Acc: 0.2679
Average Train Accuracy: 0.5588
 Site-USPS                          | Val  Loss: 0.2424 | Val  Acc: 0.9293
 Site-MNIST                         | Val  Loss: 0.4170 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.6510 | Val  Acc: 0.4286
 Site-SVHN                          | Val  Loss: 2.1403 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.2996 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5275
============ Train epoch 21 ============
 Site-USPS                          | Train Loss: 0.1990 | Train Acc: 0.9437
 Site-MNIST                         | Train Loss: 0.4290 | Train Acc: 0.8742
 Site-SynthDigits                   | Train Loss: 1.6396 | Train Acc: 0.4727
 Site-SVHN                          | Train Loss: 2.1199 | Train Acc: 0.2512
 Site-MNIST_M                       | Train Loss: 1.9819 | Train Acc: 0.3036
Average Train Accuracy: 0.5691
 Site-USPS                          | Val  Loss: 0.2392 | Val  Acc: 0.9226
 Site-MNIST                         | Val  Loss: 0.3812 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.6398 | Val  Acc: 0.4505
 Site-SVHN                          | Val  Loss: 2.1220 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.3027 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5294
============ Train epoch 22 ============
 Site-USPS                          | Train Loss: 0.1868 | Train Acc: 0.9521
 Site-MNIST                         | Train Loss: 0.4445 | Train Acc: 0.8788
 Site-SynthDigits                   | Train Loss: 1.6502 | Train Acc: 0.4727
 Site-SVHN                          | Train Loss: 2.1268 | Train Acc: 0.2414
 Site-MNIST_M                       | Train Loss: 2.0360 | Train Acc: 0.3036
Average Train Accuracy: 0.5697
 Site-USPS                          | Val  Loss: 0.2104 | Val  Acc: 0.9360
 Site-MNIST                         | Val  Loss: 0.4072 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.6077 | Val  Acc: 0.4615
 Site-SVHN                          | Val  Loss: 2.0905 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.2703 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5426
 Best site-USPS                      | Epoch:22 | Val Acc: 0.9360
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8970
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.4615
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.2400
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 23 ============
 Site-USPS                          | Train Loss: 0.1821 | Train Acc: 0.9529
 Site-MNIST                         | Train Loss: 0.3998 | Train Acc: 0.8909
 Site-SynthDigits                   | Train Loss: 1.5990 | Train Acc: 0.4754
 Site-SVHN                          | Train Loss: 2.1672 | Train Acc: 0.2611
 Site-MNIST_M                       | Train Loss: 1.9851 | Train Acc: 0.3482
Average Train Accuracy: 0.5857
 Site-USPS                          | Val  Loss: 0.2106 | Val  Acc: 0.9327
 Site-MNIST                         | Val  Loss: 0.3517 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.6101 | Val  Acc: 0.4725
 Site-SVHN                          | Val  Loss: 2.1117 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.2466 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5485
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9327
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9030
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.4725
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.2200
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 24 ============
 Site-USPS                          | Train Loss: 0.1801 | Train Acc: 0.9462
 Site-MNIST                         | Train Loss: 0.3933 | Train Acc: 0.8924
 Site-SynthDigits                   | Train Loss: 1.6005 | Train Acc: 0.4508
 Site-SVHN                          | Train Loss: 2.1321 | Train Acc: 0.2709
 Site-MNIST_M                       | Train Loss: 1.9534 | Train Acc: 0.3304
Average Train Accuracy: 0.5781
 Site-USPS                          | Val  Loss: 0.2149 | Val  Acc: 0.9226
 Site-MNIST                         | Val  Loss: 0.3615 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.6000 | Val  Acc: 0.4505
 Site-SVHN                          | Val  Loss: 2.1188 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.2310 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5532
 Best site-USPS                      | Epoch:24 | Val Acc: 0.9226
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9030
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.4505
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.2400
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 25 ============
 Site-USPS                          | Train Loss: 0.1813 | Train Acc: 0.9537
 Site-MNIST                         | Train Loss: 0.3989 | Train Acc: 0.8939
 Site-SynthDigits                   | Train Loss: 1.5645 | Train Acc: 0.4754
 Site-SVHN                          | Train Loss: 2.1776 | Train Acc: 0.2512
 Site-MNIST_M                       | Train Loss: 1.9759 | Train Acc: 0.3393
Average Train Accuracy: 0.5827
 Site-USPS                          | Val  Loss: 0.2081 | Val  Acc: 0.9293
 Site-MNIST                         | Val  Loss: 0.3499 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.5976 | Val  Acc: 0.5055
 Site-SVHN                          | Val  Loss: 2.1081 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.2388 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5564
 Best site-USPS                      | Epoch:25 | Val Acc: 0.9293
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8970
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.5055
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.2000
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 26 ============
 Site-USPS                          | Train Loss: 0.1606 | Train Acc: 0.9554
 Site-MNIST                         | Train Loss: 0.3803 | Train Acc: 0.9015
 Site-SynthDigits                   | Train Loss: 1.5668 | Train Acc: 0.4727
 Site-SVHN                          | Train Loss: 2.1524 | Train Acc: 0.2512
 Site-MNIST_M                       | Train Loss: 1.9583 | Train Acc: 0.3304
Average Train Accuracy: 0.5822
 Site-USPS                          | Val  Loss: 0.1888 | Val  Acc: 0.9394
 Site-MNIST                         | Val  Loss: 0.3239 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.5816 | Val  Acc: 0.4835
 Site-SVHN                          | Val  Loss: 2.0761 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.2631 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5545
============ Train epoch 27 ============
 Site-USPS                          | Train Loss: 0.1512 | Train Acc: 0.9613
 Site-MNIST                         | Train Loss: 0.3646 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.5726 | Train Acc: 0.4645
 Site-SVHN                          | Train Loss: 2.1604 | Train Acc: 0.2512
 Site-MNIST_M                       | Train Loss: 1.9683 | Train Acc: 0.3571
Average Train Accuracy: 0.5887
 Site-USPS                          | Val  Loss: 0.1825 | Val  Acc: 0.9360
 Site-MNIST                         | Val  Loss: 0.3139 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.5775 | Val  Acc: 0.4835
 Site-SVHN                          | Val  Loss: 2.1022 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.2565 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5622
 Best site-USPS                      | Epoch:27 | Val Acc: 0.9360
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9212
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.4835
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.2200
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 28 ============
 Site-USPS                          | Train Loss: 0.1457 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.3799 | Train Acc: 0.9045
 Site-SynthDigits                   | Train Loss: 1.5668 | Train Acc: 0.4836
 Site-SVHN                          | Train Loss: 2.1471 | Train Acc: 0.2512
 Site-MNIST_M                       | Train Loss: 1.9119 | Train Acc: 0.3571
Average Train Accuracy: 0.5907
 Site-USPS                          | Val  Loss: 0.1750 | Val  Acc: 0.9394
 Site-MNIST                         | Val  Loss: 0.3434 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.5430 | Val  Acc: 0.5055
 Site-SVHN                          | Val  Loss: 2.1032 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.2186 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5707
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9394
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9030
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.5055
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.2200
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 29 ============
 Site-USPS                          | Train Loss: 0.1464 | Train Acc: 0.9605
 Site-MNIST                         | Train Loss: 0.3657 | Train Acc: 0.9030
 Site-SynthDigits                   | Train Loss: 1.5530 | Train Acc: 0.4836
 Site-SVHN                          | Train Loss: 2.1755 | Train Acc: 0.2660
 Site-MNIST_M                       | Train Loss: 1.9515 | Train Acc: 0.3393
Average Train Accuracy: 0.5905
 Site-USPS                          | Val  Loss: 0.1712 | Val  Acc: 0.9428
 Site-MNIST                         | Val  Loss: 0.3272 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.5394 | Val  Acc: 0.5495
 Site-SVHN                          | Val  Loss: 2.0844 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.2473 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5835
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9428
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9152
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5495
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.2600
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 30 ============
 Site-USPS                          | Train Loss: 0.1326 | Train Acc: 0.9647
 Site-MNIST                         | Train Loss: 0.3570 | Train Acc: 0.8970
 Site-SynthDigits                   | Train Loss: 1.5589 | Train Acc: 0.4836
 Site-SVHN                          | Train Loss: 2.1661 | Train Acc: 0.2660
 Site-MNIST_M                       | Train Loss: 1.9326 | Train Acc: 0.3393
Average Train Accuracy: 0.5901
 Site-USPS                          | Val  Loss: 0.1614 | Val  Acc: 0.9428
 Site-MNIST                         | Val  Loss: 0.3209 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.5425 | Val  Acc: 0.5165
 Site-SVHN                          | Val  Loss: 2.0880 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.2490 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5769
============ Train epoch 31 ============
 Site-USPS                          | Train Loss: 0.1316 | Train Acc: 0.9647
 Site-MNIST                         | Train Loss: 0.3459 | Train Acc: 0.9121
 Site-SynthDigits                   | Train Loss: 1.5424 | Train Acc: 0.4973
 Site-SVHN                          | Train Loss: 2.1669 | Train Acc: 0.2512
 Site-MNIST_M                       | Train Loss: 1.9253 | Train Acc: 0.3304
Average Train Accuracy: 0.5911
 Site-USPS                          | Val  Loss: 0.1627 | Val  Acc: 0.9495
 Site-MNIST                         | Val  Loss: 0.3074 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.5397 | Val  Acc: 0.5495
 Site-SVHN                          | Val  Loss: 2.1071 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.2625 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5789
============ Train epoch 32 ============
 Site-USPS                          | Train Loss: 0.1319 | Train Acc: 0.9680
 Site-MNIST                         | Train Loss: 0.3355 | Train Acc: 0.9136
 Site-SynthDigits                   | Train Loss: 1.5277 | Train Acc: 0.4945
 Site-SVHN                          | Train Loss: 2.1558 | Train Acc: 0.2315
 Site-MNIST_M                       | Train Loss: 1.8672 | Train Acc: 0.3750
Average Train Accuracy: 0.5965
 Site-USPS                          | Val  Loss: 0.1591 | Val  Acc: 0.9495
 Site-MNIST                         | Val  Loss: 0.2964 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.5154 | Val  Acc: 0.5165
 Site-SVHN                          | Val  Loss: 2.1481 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.2497 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5791
============ Train epoch 33 ============
 Site-USPS                          | Train Loss: 0.1184 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.3339 | Train Acc: 0.9106
 Site-SynthDigits                   | Train Loss: 1.5201 | Train Acc: 0.5055
 Site-SVHN                          | Train Loss: 2.1383 | Train Acc: 0.2611
 Site-MNIST_M                       | Train Loss: 1.9001 | Train Acc: 0.3661
Average Train Accuracy: 0.6024
 Site-USPS                          | Val  Loss: 0.1415 | Val  Acc: 0.9562
 Site-MNIST                         | Val  Loss: 0.3097 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.5087 | Val  Acc: 0.5385
 Site-SVHN                          | Val  Loss: 2.1146 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.2861 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5852
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9562
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9212
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.5385
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.2600
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 34 ============
 Site-USPS                          | Train Loss: 0.1140 | Train Acc: 0.9697
 Site-MNIST                         | Train Loss: 0.3547 | Train Acc: 0.9045
 Site-SynthDigits                   | Train Loss: 1.5239 | Train Acc: 0.5109
 Site-SVHN                          | Train Loss: 2.1047 | Train Acc: 0.2611
 Site-MNIST_M                       | Train Loss: 1.9373 | Train Acc: 0.3750
Average Train Accuracy: 0.6043
 Site-USPS                          | Val  Loss: 0.1377 | Val  Acc: 0.9596
 Site-MNIST                         | Val  Loss: 0.3259 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.5315 | Val  Acc: 0.5165
 Site-SVHN                          | Val  Loss: 2.0762 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.3001 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5815
============ Train epoch 35 ============
 Site-USPS                          | Train Loss: 0.1094 | Train Acc: 0.9731
 Site-MNIST                         | Train Loss: 0.3326 | Train Acc: 0.9091
 Site-SynthDigits                   | Train Loss: 1.4779 | Train Acc: 0.5219
 Site-SVHN                          | Train Loss: 2.1673 | Train Acc: 0.2759
 Site-MNIST_M                       | Train Loss: 1.9278 | Train Acc: 0.3482
Average Train Accuracy: 0.6056
 Site-USPS                          | Val  Loss: 0.1329 | Val  Acc: 0.9529
 Site-MNIST                         | Val  Loss: 0.2992 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.5011 | Val  Acc: 0.5495
 Site-SVHN                          | Val  Loss: 2.0991 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.3268 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5783
============ Train epoch 36 ============
 Site-USPS                          | Train Loss: 0.1334 | Train Acc: 0.9630
 Site-MNIST                         | Train Loss: 0.3051 | Train Acc: 0.9197
 Site-SynthDigits                   | Train Loss: 1.5179 | Train Acc: 0.5000
 Site-SVHN                          | Train Loss: 2.0840 | Train Acc: 0.2660
 Site-MNIST_M                       | Train Loss: 1.8410 | Train Acc: 0.3750
Average Train Accuracy: 0.6047
 Site-USPS                          | Val  Loss: 0.1683 | Val  Acc: 0.9529
 Site-MNIST                         | Val  Loss: 0.2556 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.5108 | Val  Acc: 0.5275
 Site-SVHN                          | Val  Loss: 2.1150 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.2460 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5859
 Best site-USPS                      | Epoch:36 | Val Acc: 0.9529
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9394
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.5275
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.2600
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 37 ============
 Site-USPS                          | Train Loss: 0.1163 | Train Acc: 0.9714
 Site-MNIST                         | Train Loss: 0.3053 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.4629 | Train Acc: 0.5137
 Site-SVHN                          | Train Loss: 2.1504 | Train Acc: 0.2709
 Site-MNIST_M                       | Train Loss: 1.9005 | Train Acc: 0.3482
Average Train Accuracy: 0.6051
 Site-USPS                          | Val  Loss: 0.1415 | Val  Acc: 0.9562
 Site-MNIST                         | Val  Loss: 0.2631 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.5095 | Val  Acc: 0.5385
 Site-SVHN                          | Val  Loss: 2.1157 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.3143 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5733
============ Train epoch 38 ============
 Site-USPS                          | Train Loss: 0.1040 | Train Acc: 0.9765
 Site-MNIST                         | Train Loss: 0.2926 | Train Acc: 0.9167
 Site-SynthDigits                   | Train Loss: 1.4772 | Train Acc: 0.5164
 Site-SVHN                          | Train Loss: 2.1089 | Train Acc: 0.2808
 Site-MNIST_M                       | Train Loss: 1.8798 | Train Acc: 0.3839
Average Train Accuracy: 0.6148
 Site-USPS                          | Val  Loss: 0.1244 | Val  Acc: 0.9731
 Site-MNIST                         | Val  Loss: 0.2577 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.4958 | Val  Acc: 0.5055
 Site-SVHN                          | Val  Loss: 2.0661 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.3411 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5924
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9731
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9333
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.5055
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.3000
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 39 ============
 Site-USPS                          | Train Loss: 0.0968 | Train Acc: 0.9773
 Site-MNIST                         | Train Loss: 0.3134 | Train Acc: 0.9182
 Site-SynthDigits                   | Train Loss: 1.4868 | Train Acc: 0.5273
 Site-SVHN                          | Train Loss: 2.1020 | Train Acc: 0.2857
 Site-MNIST_M                       | Train Loss: 1.9364 | Train Acc: 0.3839
Average Train Accuracy: 0.6185
 Site-USPS                          | Val  Loss: 0.1146 | Val  Acc: 0.9697
 Site-MNIST                         | Val  Loss: 0.2734 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.4844 | Val  Acc: 0.5604
 Site-SVHN                          | Val  Loss: 2.0790 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.3458 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6058
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9697
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9333
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.5604
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.2800
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 40 ============
 Site-USPS                          | Train Loss: 0.1027 | Train Acc: 0.9773
 Site-MNIST                         | Train Loss: 0.2902 | Train Acc: 0.9182
 Site-SynthDigits                   | Train Loss: 1.4650 | Train Acc: 0.5246
 Site-SVHN                          | Train Loss: 2.1593 | Train Acc: 0.2759
 Site-MNIST_M                       | Train Loss: 1.8866 | Train Acc: 0.3661
Average Train Accuracy: 0.6124
 Site-USPS                          | Val  Loss: 0.1229 | Val  Acc: 0.9663
 Site-MNIST                         | Val  Loss: 0.2501 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.4662 | Val  Acc: 0.5604
 Site-SVHN                          | Val  Loss: 2.0898 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.3319 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6020
============ Train epoch 41 ============
 Site-USPS                          | Train Loss: 0.0989 | Train Acc: 0.9765
 Site-MNIST                         | Train Loss: 0.3031 | Train Acc: 0.9136
 Site-SynthDigits                   | Train Loss: 1.4604 | Train Acc: 0.5273
 Site-SVHN                          | Train Loss: 2.0584 | Train Acc: 0.2956
 Site-MNIST_M                       | Train Loss: 1.9221 | Train Acc: 0.3839
Average Train Accuracy: 0.6194
 Site-USPS                          | Val  Loss: 0.1132 | Val  Acc: 0.9697
 Site-MNIST                         | Val  Loss: 0.2656 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.4873 | Val  Acc: 0.5385
 Site-SVHN                          | Val  Loss: 2.0356 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.3235 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5971
============ Train epoch 42 ============
 Site-USPS                          | Train Loss: 0.0872 | Train Acc: 0.9807
 Site-MNIST                         | Train Loss: 0.2896 | Train Acc: 0.9182
 Site-SynthDigits                   | Train Loss: 1.4595 | Train Acc: 0.5246
 Site-SVHN                          | Train Loss: 2.1001 | Train Acc: 0.2808
 Site-MNIST_M                       | Train Loss: 1.8803 | Train Acc: 0.3571
Average Train Accuracy: 0.6123
 Site-USPS                          | Val  Loss: 0.1042 | Val  Acc: 0.9731
 Site-MNIST                         | Val  Loss: 0.2556 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.4747 | Val  Acc: 0.5495
 Site-SVHN                          | Val  Loss: 2.0395 | Val  Acc: 0.3200
 Site-MNIST_M                       | Val  Loss: 2.3125 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5980
============ Train epoch 43 ============
 Site-USPS                          | Train Loss: 0.0843 | Train Acc: 0.9832
 Site-MNIST                         | Train Loss: 0.3057 | Train Acc: 0.9076
 Site-SynthDigits                   | Train Loss: 1.4421 | Train Acc: 0.5383
 Site-SVHN                          | Train Loss: 2.1057 | Train Acc: 0.2808
 Site-MNIST_M                       | Train Loss: 1.8630 | Train Acc: 0.3661
Average Train Accuracy: 0.6152
 Site-USPS                          | Val  Loss: 0.0984 | Val  Acc: 0.9731
 Site-MNIST                         | Val  Loss: 0.2735 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.4642 | Val  Acc: 0.5385
 Site-SVHN                          | Val  Loss: 2.0564 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.3084 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5894
============ Train epoch 44 ============
 Site-USPS                          | Train Loss: 0.0798 | Train Acc: 0.9849
 Site-MNIST                         | Train Loss: 0.2898 | Train Acc: 0.9182
 Site-SynthDigits                   | Train Loss: 1.4287 | Train Acc: 0.5219
 Site-SVHN                          | Train Loss: 2.0726 | Train Acc: 0.2857
 Site-MNIST_M                       | Train Loss: 1.8975 | Train Acc: 0.3929
Average Train Accuracy: 0.6207
 Site-USPS                          | Val  Loss: 0.0955 | Val  Acc: 0.9798
 Site-MNIST                         | Val  Loss: 0.2469 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.4521 | Val  Acc: 0.5385
 Site-SVHN                          | Val  Loss: 2.0409 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.2817 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5991
============ Train epoch 45 ============
 Site-USPS                          | Train Loss: 0.0835 | Train Acc: 0.9823
 Site-MNIST                         | Train Loss: 0.2754 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.4411 | Train Acc: 0.5410
 Site-SVHN                          | Train Loss: 2.1177 | Train Acc: 0.2512
 Site-MNIST_M                       | Train Loss: 1.8499 | Train Acc: 0.3750
Average Train Accuracy: 0.6142
 Site-USPS                          | Val  Loss: 0.0973 | Val  Acc: 0.9731
 Site-MNIST                         | Val  Loss: 0.2341 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.4553 | Val  Acc: 0.5275
 Site-SVHN                          | Val  Loss: 2.0264 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.3523 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5940
============ Train epoch 46 ============
 Site-USPS                          | Train Loss: 0.0897 | Train Acc: 0.9798
 Site-MNIST                         | Train Loss: 0.2675 | Train Acc: 0.9258
 Site-SynthDigits                   | Train Loss: 1.4382 | Train Acc: 0.5383
 Site-SVHN                          | Train Loss: 2.1587 | Train Acc: 0.2906
 Site-MNIST_M                       | Train Loss: 1.9121 | Train Acc: 0.3839
Average Train Accuracy: 0.6237
 Site-USPS                          | Val  Loss: 0.1047 | Val  Acc: 0.9697
 Site-MNIST                         | Val  Loss: 0.2168 | Val  Acc: 0.9455
 Site-SynthDigits                   | Val  Loss: 1.4378 | Val  Acc: 0.5275
 Site-SVHN                          | Val  Loss: 2.0646 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 2.3791 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6065
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9697
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9455
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.5275
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.3400
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 47 ============
 Site-USPS                          | Train Loss: 0.0827 | Train Acc: 0.9798
 Site-MNIST                         | Train Loss: 0.2845 | Train Acc: 0.9197
 Site-SynthDigits                   | Train Loss: 1.4708 | Train Acc: 0.5164
 Site-SVHN                          | Train Loss: 2.0896 | Train Acc: 0.3005
 Site-MNIST_M                       | Train Loss: 1.8752 | Train Acc: 0.3929
Average Train Accuracy: 0.6219
 Site-USPS                          | Val  Loss: 0.0986 | Val  Acc: 0.9764
 Site-MNIST                         | Val  Loss: 0.2523 | Val  Acc: 0.9333
 Site-SynthDigits                   | Val  Loss: 1.4721 | Val  Acc: 0.5385
 Site-SVHN                          | Val  Loss: 2.0154 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 2.3516 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6148
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9764
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9333
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5385
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.3400
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedmix...
============ Train epoch 48 ============
 Site-USPS                          | Train Loss: 0.0711 | Train Acc: 0.9882
 Site-MNIST                         | Train Loss: 0.2882 | Train Acc: 0.9136
 Site-SynthDigits                   | Train Loss: 1.4240 | Train Acc: 0.5437
 Site-SVHN                          | Train Loss: 2.1308 | Train Acc: 0.2906
 Site-MNIST_M                       | Train Loss: 1.8271 | Train Acc: 0.3839
Average Train Accuracy: 0.6240
 Site-USPS                          | Val  Loss: 0.0800 | Val  Acc: 0.9865
 Site-MNIST                         | Val  Loss: 0.2593 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.4021 | Val  Acc: 0.5385
 Site-SVHN                          | Val  Loss: 2.0752 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.3463 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6024
============ Train epoch 49 ============
 Site-USPS                          | Train Loss: 0.0746 | Train Acc: 0.9865
 Site-MNIST                         | Train Loss: 0.2617 | Train Acc: 0.9258
 Site-SynthDigits                   | Train Loss: 1.4196 | Train Acc: 0.5355
 Site-SVHN                          | Train Loss: 2.1704 | Train Acc: 0.2857
 Site-MNIST_M                       | Train Loss: 1.8608 | Train Acc: 0.3929
Average Train Accuracy: 0.6253
 Site-USPS                          | Val  Loss: 0.0847 | Val  Acc: 0.9798
 Site-MNIST                         | Val  Loss: 0.2243 | Val  Acc: 0.9455
 Site-SynthDigits                   | Val  Loss: 1.3978 | Val  Acc: 0.5275
 Site-SVHN                          | Val  Loss: 2.0876 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.3318 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5965
===2023-07-03 07:50:49===
===2023-07-03 07:50:50===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
Loading snapshots...
 Test site-USPS                      | Epoch:47 | Test Acc: 0.9505
 Test site-MNIST                     | Epoch:47 | Test Acc: 0.8849
 Test site-SynthDigits               | Epoch:47 | Test Acc: 0.4804
 Test site-SVHN                      | Epoch:47 | Test Acc: 0.2436
 Test site-MNIST_M                   | Epoch:47 | Test Acc: 0.2749
USPS: 0.9505, MNIST: 0.8849, SynthDigits: 0.4804, SVHN: 0.2436, MNIST_M: 0.2749, 
Average Test Accuracy(group): 0.5668, Average Test Accuracy(individual): 0.5668,
domain std=0.2985, cluster std=-1.0000, individual std=0.2985, 
