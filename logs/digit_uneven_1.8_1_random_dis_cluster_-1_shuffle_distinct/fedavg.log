===2023-07-02 12:50:24===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
============ Train epoch 0 ============
 Site-USPS                          | Train Loss: 1.9345 | Train Acc: 0.6131
 Site-MNIST                         | Train Loss: 2.0263 | Train Acc: 0.5015
 Site-SynthDigits                   | Train Loss: 2.2447 | Train Acc: 0.1858
 Site-SVHN                          | Train Loss: 2.2871 | Train Acc: 0.1379
 Site-MNIST_M                       | Train Loss: 2.2777 | Train Acc: 0.1339
Average Train Accuracy: 0.3145
 Site-USPS                          | Val  Loss: 1.9598 | Val  Acc: 0.5354
 Site-MNIST                         | Val  Loss: 2.0137 | Val  Acc: 0.5273
 Site-SynthDigits                   | Val  Loss: 2.2383 | Val  Acc: 0.2198
 Site-SVHN                          | Val  Loss: 2.2887 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.2900 | Val  Acc: 0.1786
Average Valid Accuracy: 0.3362
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5354
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5273
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2198
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2200
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 1 ============
 Site-USPS                          | Train Loss: 1.5901 | Train Acc: 0.7485
 Site-MNIST                         | Train Loss: 1.7978 | Train Acc: 0.5985
 Site-SynthDigits                   | Train Loss: 2.1870 | Train Acc: 0.2377
 Site-SVHN                          | Train Loss: 2.2688 | Train Acc: 0.1379
 Site-MNIST_M                       | Train Loss: 2.2467 | Train Acc: 0.2143
Average Train Accuracy: 0.3874
 Site-USPS                          | Val  Loss: 1.6318 | Val  Acc: 0.7273
 Site-MNIST                         | Val  Loss: 1.7723 | Val  Acc: 0.6242
 Site-SynthDigits                   | Val  Loss: 2.1795 | Val  Acc: 0.2637
 Site-SVHN                          | Val  Loss: 2.2814 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.2700 | Val  Acc: 0.1786
Average Valid Accuracy: 0.3988
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7273
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6242
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2637
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2000
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 2 ============
 Site-USPS                          | Train Loss: 1.3077 | Train Acc: 0.8066
 Site-MNIST                         | Train Loss: 1.6029 | Train Acc: 0.6591
 Site-SynthDigits                   | Train Loss: 2.1311 | Train Acc: 0.2923
 Site-SVHN                          | Train Loss: 2.2685 | Train Acc: 0.1330
 Site-MNIST_M                       | Train Loss: 2.2045 | Train Acc: 0.2857
Average Train Accuracy: 0.4353
 Site-USPS                          | Val  Loss: 1.3498 | Val  Acc: 0.7980
 Site-MNIST                         | Val  Loss: 1.5607 | Val  Acc: 0.7091
 Site-SynthDigits                   | Val  Loss: 2.1161 | Val  Acc: 0.3077
 Site-SVHN                          | Val  Loss: 2.2650 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.2354 | Val  Acc: 0.2500
Average Valid Accuracy: 0.4530
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7980
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7091
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3077
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2000
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 3 ============
 Site-USPS                          | Train Loss: 1.0876 | Train Acc: 0.8486
 Site-MNIST                         | Train Loss: 1.4056 | Train Acc: 0.7045
 Site-SynthDigits                   | Train Loss: 2.0803 | Train Acc: 0.3033
 Site-SVHN                          | Train Loss: 2.2858 | Train Acc: 0.1379
 Site-MNIST_M                       | Train Loss: 2.1702 | Train Acc: 0.2679
Average Train Accuracy: 0.4524
 Site-USPS                          | Val  Loss: 1.1309 | Val  Acc: 0.8283
 Site-MNIST                         | Val  Loss: 1.3599 | Val  Acc: 0.7636
 Site-SynthDigits                   | Val  Loss: 2.0740 | Val  Acc: 0.2967
 Site-SVHN                          | Val  Loss: 2.2527 | Val  Acc: 0.1800
 Site-MNIST_M                       | Val  Loss: 2.2295 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4423
============ Train epoch 4 ============
 Site-USPS                          | Train Loss: 0.9094 | Train Acc: 0.8680
 Site-MNIST                         | Train Loss: 1.2918 | Train Acc: 0.7182
 Site-SynthDigits                   | Train Loss: 2.0401 | Train Acc: 0.2923
 Site-SVHN                          | Train Loss: 2.2663 | Train Acc: 0.1133
 Site-MNIST_M                       | Train Loss: 2.1355 | Train Acc: 0.2679
Average Train Accuracy: 0.4519
 Site-USPS                          | Val  Loss: 0.9472 | Val  Acc: 0.8485
 Site-MNIST                         | Val  Loss: 1.2445 | Val  Acc: 0.7939
 Site-SynthDigits                   | Val  Loss: 2.0278 | Val  Acc: 0.2967
 Site-SVHN                          | Val  Loss: 2.2461 | Val  Acc: 0.1400
 Site-MNIST_M                       | Val  Loss: 2.2078 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4515
============ Train epoch 5 ============
 Site-USPS                          | Train Loss: 0.7839 | Train Acc: 0.8730
 Site-MNIST                         | Train Loss: 1.1401 | Train Acc: 0.7348
 Site-SynthDigits                   | Train Loss: 2.0015 | Train Acc: 0.3115
 Site-SVHN                          | Train Loss: 2.2466 | Train Acc: 0.1084
 Site-MNIST_M                       | Train Loss: 2.1130 | Train Acc: 0.2500
Average Train Accuracy: 0.4555
 Site-USPS                          | Val  Loss: 0.8176 | Val  Acc: 0.8620
 Site-MNIST                         | Val  Loss: 1.1014 | Val  Acc: 0.7818
 Site-SynthDigits                   | Val  Loss: 1.9908 | Val  Acc: 0.2857
 Site-SVHN                          | Val  Loss: 2.2399 | Val  Acc: 0.1600
 Site-MNIST_M                       | Val  Loss: 2.1888 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4536
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8620
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7818
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.2857
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.1600
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 6 ============
 Site-USPS                          | Train Loss: 0.6649 | Train Acc: 0.8890
 Site-MNIST                         | Train Loss: 1.0568 | Train Acc: 0.7500
 Site-SynthDigits                   | Train Loss: 1.9759 | Train Acc: 0.3169
 Site-SVHN                          | Train Loss: 2.2900 | Train Acc: 0.1232
 Site-MNIST_M                       | Train Loss: 2.0792 | Train Acc: 0.2946
Average Train Accuracy: 0.4747
 Site-USPS                          | Val  Loss: 0.7008 | Val  Acc: 0.8721
 Site-MNIST                         | Val  Loss: 1.0004 | Val  Acc: 0.7879
 Site-SynthDigits                   | Val  Loss: 1.9668 | Val  Acc: 0.3077
 Site-SVHN                          | Val  Loss: 2.2342 | Val  Acc: 0.1600
 Site-MNIST_M                       | Val  Loss: 2.1750 | Val  Acc: 0.2143
Average Valid Accuracy: 0.4684
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8721
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7879
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3077
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.1600
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 7 ============
 Site-USPS                          | Train Loss: 0.5913 | Train Acc: 0.8907
 Site-MNIST                         | Train Loss: 0.9556 | Train Acc: 0.7561
 Site-SynthDigits                   | Train Loss: 1.9527 | Train Acc: 0.3197
 Site-SVHN                          | Train Loss: 2.2568 | Train Acc: 0.1281
 Site-MNIST_M                       | Train Loss: 2.0701 | Train Acc: 0.2946
Average Train Accuracy: 0.4778
 Site-USPS                          | Val  Loss: 0.6234 | Val  Acc: 0.8822
 Site-MNIST                         | Val  Loss: 0.9165 | Val  Acc: 0.7879
 Site-SynthDigits                   | Val  Loss: 1.9429 | Val  Acc: 0.3077
 Site-SVHN                          | Val  Loss: 2.2215 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.1803 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4713
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8822
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7879
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3077
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2000
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 8 ============
 Site-USPS                          | Train Loss: 0.5474 | Train Acc: 0.8907
 Site-MNIST                         | Train Loss: 0.8686 | Train Acc: 0.7864
 Site-SynthDigits                   | Train Loss: 1.9418 | Train Acc: 0.3306
 Site-SVHN                          | Train Loss: 2.2292 | Train Acc: 0.1281
 Site-MNIST_M                       | Train Loss: 2.0626 | Train Acc: 0.2768
Average Train Accuracy: 0.4825
 Site-USPS                          | Val  Loss: 0.5805 | Val  Acc: 0.8754
 Site-MNIST                         | Val  Loss: 0.8205 | Val  Acc: 0.8242
 Site-SynthDigits                   | Val  Loss: 1.9390 | Val  Acc: 0.2967
 Site-SVHN                          | Val  Loss: 2.2096 | Val  Acc: 0.1800
 Site-MNIST_M                       | Val  Loss: 2.2061 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4710
============ Train epoch 9 ============
 Site-USPS                          | Train Loss: 0.4883 | Train Acc: 0.8974
 Site-MNIST                         | Train Loss: 0.8151 | Train Acc: 0.7788
 Site-SynthDigits                   | Train Loss: 1.9265 | Train Acc: 0.3279
 Site-SVHN                          | Train Loss: 2.1990 | Train Acc: 0.1330
 Site-MNIST_M                       | Train Loss: 2.0556 | Train Acc: 0.2946
Average Train Accuracy: 0.4863
 Site-USPS                          | Val  Loss: 0.5176 | Val  Acc: 0.8788
 Site-MNIST                         | Val  Loss: 0.7806 | Val  Acc: 0.8061
 Site-SynthDigits                   | Val  Loss: 1.9233 | Val  Acc: 0.2857
 Site-SVHN                          | Val  Loss: 2.2082 | Val  Acc: 0.1800
 Site-MNIST_M                       | Val  Loss: 2.1850 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4658
============ Train epoch 10 ============
 Site-USPS                          | Train Loss: 0.4575 | Train Acc: 0.9008
 Site-MNIST                         | Train Loss: 0.7695 | Train Acc: 0.7864
 Site-SynthDigits                   | Train Loss: 1.9143 | Train Acc: 0.3361
 Site-SVHN                          | Train Loss: 2.2068 | Train Acc: 0.1379
 Site-MNIST_M                       | Train Loss: 2.0554 | Train Acc: 0.2946
Average Train Accuracy: 0.4912
 Site-USPS                          | Val  Loss: 0.4833 | Val  Acc: 0.8788
 Site-MNIST                         | Val  Loss: 0.7431 | Val  Acc: 0.8061
 Site-SynthDigits                   | Val  Loss: 1.9040 | Val  Acc: 0.3187
 Site-SVHN                          | Val  Loss: 2.1875 | Val  Acc: 0.1800
 Site-MNIST_M                       | Val  Loss: 2.1966 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4724
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8788
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8061
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.3187
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.1800
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 11 ============
 Site-USPS                          | Train Loss: 0.4145 | Train Acc: 0.9134
 Site-MNIST                         | Train Loss: 0.7407 | Train Acc: 0.7955
 Site-SynthDigits                   | Train Loss: 1.9103 | Train Acc: 0.3169
 Site-SVHN                          | Train Loss: 2.2768 | Train Acc: 0.1478
 Site-MNIST_M                       | Train Loss: 2.0192 | Train Acc: 0.3125
Average Train Accuracy: 0.4972
 Site-USPS                          | Val  Loss: 0.4374 | Val  Acc: 0.9057
 Site-MNIST                         | Val  Loss: 0.7078 | Val  Acc: 0.8000
 Site-SynthDigits                   | Val  Loss: 1.9050 | Val  Acc: 0.2967
 Site-SVHN                          | Val  Loss: 2.1892 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.1885 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4762
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9057
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8000
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.2967
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2000
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 12 ============
 Site-USPS                          | Train Loss: 0.3910 | Train Acc: 0.9108
 Site-MNIST                         | Train Loss: 0.6888 | Train Acc: 0.8167
 Site-SynthDigits                   | Train Loss: 1.9057 | Train Acc: 0.3279
 Site-SVHN                          | Train Loss: 2.2667 | Train Acc: 0.1527
 Site-MNIST_M                       | Train Loss: 2.0261 | Train Acc: 0.2946
Average Train Accuracy: 0.5005
 Site-USPS                          | Val  Loss: 0.4162 | Val  Acc: 0.8990
 Site-MNIST                         | Val  Loss: 0.6685 | Val  Acc: 0.8303
 Site-SynthDigits                   | Val  Loss: 1.8999 | Val  Acc: 0.3187
 Site-SVHN                          | Val  Loss: 2.1824 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.1938 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4853
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8990
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8303
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.3187
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2000
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 13 ============
 Site-USPS                          | Train Loss: 0.3657 | Train Acc: 0.9184
 Site-MNIST                         | Train Loss: 0.6440 | Train Acc: 0.8273
 Site-SynthDigits                   | Train Loss: 1.8949 | Train Acc: 0.3361
 Site-SVHN                          | Train Loss: 2.2502 | Train Acc: 0.1527
 Site-MNIST_M                       | Train Loss: 2.0000 | Train Acc: 0.2946
Average Train Accuracy: 0.5058
 Site-USPS                          | Val  Loss: 0.3910 | Val  Acc: 0.9024
 Site-MNIST                         | Val  Loss: 0.6358 | Val  Acc: 0.8303
 Site-SynthDigits                   | Val  Loss: 1.8795 | Val  Acc: 0.3297
 Site-SVHN                          | Val  Loss: 2.1819 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.1870 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4882
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9024
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8303
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.3297
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.2000
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 14 ============
 Site-USPS                          | Train Loss: 0.3538 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.6420 | Train Acc: 0.8318
 Site-SynthDigits                   | Train Loss: 1.8673 | Train Acc: 0.3306
 Site-SVHN                          | Train Loss: 2.2052 | Train Acc: 0.1379
 Site-MNIST_M                       | Train Loss: 2.0132 | Train Acc: 0.2946
Average Train Accuracy: 0.5023
 Site-USPS                          | Val  Loss: 0.3797 | Val  Acc: 0.9024
 Site-MNIST                         | Val  Loss: 0.6023 | Val  Acc: 0.8364
 Site-SynthDigits                   | Val  Loss: 1.8613 | Val  Acc: 0.3407
 Site-SVHN                          | Val  Loss: 2.1641 | Val  Acc: 0.1800
 Site-MNIST_M                       | Val  Loss: 2.2059 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4876
============ Train epoch 15 ============
 Site-USPS                          | Train Loss: 0.3348 | Train Acc: 0.9218
 Site-MNIST                         | Train Loss: 0.5744 | Train Acc: 0.8333
 Site-SynthDigits                   | Train Loss: 1.8577 | Train Acc: 0.3689
 Site-SVHN                          | Train Loss: 2.1790 | Train Acc: 0.1626
 Site-MNIST_M                       | Train Loss: 1.9979 | Train Acc: 0.2946
Average Train Accuracy: 0.5162
 Site-USPS                          | Val  Loss: 0.3576 | Val  Acc: 0.9091
 Site-MNIST                         | Val  Loss: 0.5893 | Val  Acc: 0.8485
 Site-SynthDigits                   | Val  Loss: 1.8289 | Val  Acc: 0.3626
 Site-SVHN                          | Val  Loss: 2.1621 | Val  Acc: 0.1600
 Site-MNIST_M                       | Val  Loss: 2.2061 | Val  Acc: 0.1786
Average Valid Accuracy: 0.4918
 Best site-USPS                      | Epoch:15 | Val Acc: 0.9091
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8485
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.3626
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.1600
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 16 ============
 Site-USPS                          | Train Loss: 0.3323 | Train Acc: 0.9260
 Site-MNIST                         | Train Loss: 0.5594 | Train Acc: 0.8439
 Site-SynthDigits                   | Train Loss: 1.8563 | Train Acc: 0.3415
 Site-SVHN                          | Train Loss: 2.1616 | Train Acc: 0.1724
 Site-MNIST_M                       | Train Loss: 1.9779 | Train Acc: 0.3214
Average Train Accuracy: 0.5211
 Site-USPS                          | Val  Loss: 0.3587 | Val  Acc: 0.9091
 Site-MNIST                         | Val  Loss: 0.5519 | Val  Acc: 0.8485
 Site-SynthDigits                   | Val  Loss: 1.8390 | Val  Acc: 0.3407
 Site-SVHN                          | Val  Loss: 2.1508 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.2090 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5065
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9091
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8485
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.3407
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.2200
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 17 ============
 Site-USPS                          | Train Loss: 0.3057 | Train Acc: 0.9268
 Site-MNIST                         | Train Loss: 0.5319 | Train Acc: 0.8515
 Site-SynthDigits                   | Train Loss: 1.8405 | Train Acc: 0.3552
 Site-SVHN                          | Train Loss: 2.1817 | Train Acc: 0.1576
 Site-MNIST_M                       | Train Loss: 1.9847 | Train Acc: 0.3125
Average Train Accuracy: 0.5207
 Site-USPS                          | Val  Loss: 0.3258 | Val  Acc: 0.9192
 Site-MNIST                         | Val  Loss: 0.5341 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.8171 | Val  Acc: 0.3626
 Site-SVHN                          | Val  Loss: 2.1574 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1884 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5181
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9192
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8545
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.3626
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.2400
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 18 ============
 Site-USPS                          | Train Loss: 0.2940 | Train Acc: 0.9310
 Site-MNIST                         | Train Loss: 0.5090 | Train Acc: 0.8545
 Site-SynthDigits                   | Train Loss: 1.8307 | Train Acc: 0.3661
 Site-SVHN                          | Train Loss: 2.2654 | Train Acc: 0.1872
 Site-MNIST_M                       | Train Loss: 1.9813 | Train Acc: 0.3036
Average Train Accuracy: 0.5285
 Site-USPS                          | Val  Loss: 0.3130 | Val  Acc: 0.9192
 Site-MNIST                         | Val  Loss: 0.5157 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.7917 | Val  Acc: 0.3407
 Site-SVHN                          | Val  Loss: 2.1490 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.1911 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5193
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9192
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8667
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.3407
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.2200
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 19 ============
 Site-USPS                          | Train Loss: 0.2763 | Train Acc: 0.9327
 Site-MNIST                         | Train Loss: 0.4999 | Train Acc: 0.8530
 Site-SynthDigits                   | Train Loss: 1.8008 | Train Acc: 0.3716
 Site-SVHN                          | Train Loss: 2.1806 | Train Acc: 0.2118
 Site-MNIST_M                       | Train Loss: 1.9568 | Train Acc: 0.3036
Average Train Accuracy: 0.5345
 Site-USPS                          | Val  Loss: 0.2914 | Val  Acc: 0.9226
 Site-MNIST                         | Val  Loss: 0.5158 | Val  Acc: 0.8485
 Site-SynthDigits                   | Val  Loss: 1.7688 | Val  Acc: 0.3516
 Site-SVHN                          | Val  Loss: 2.1473 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.1838 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5145
============ Train epoch 20 ============
 Site-USPS                          | Train Loss: 0.2680 | Train Acc: 0.9336
 Site-MNIST                         | Train Loss: 0.4853 | Train Acc: 0.8621
 Site-SynthDigits                   | Train Loss: 1.7878 | Train Acc: 0.3689
 Site-SVHN                          | Train Loss: 2.2184 | Train Acc: 0.2167
 Site-MNIST_M                       | Train Loss: 1.9546 | Train Acc: 0.3393
Average Train Accuracy: 0.5441
 Site-USPS                          | Val  Loss: 0.2904 | Val  Acc: 0.9192
 Site-MNIST                         | Val  Loss: 0.4871 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.7671 | Val  Acc: 0.3736
 Site-SVHN                          | Val  Loss: 2.1483 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1792 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5370
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9192
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8667
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.3736
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.2400
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 21 ============
 Site-USPS                          | Train Loss: 0.2513 | Train Acc: 0.9394
 Site-MNIST                         | Train Loss: 0.4901 | Train Acc: 0.8545
 Site-SynthDigits                   | Train Loss: 1.7773 | Train Acc: 0.3770
 Site-SVHN                          | Train Loss: 2.1730 | Train Acc: 0.2118
 Site-MNIST_M                       | Train Loss: 1.9416 | Train Acc: 0.3214
Average Train Accuracy: 0.5409
 Site-USPS                          | Val  Loss: 0.2691 | Val  Acc: 0.9327
 Site-MNIST                         | Val  Loss: 0.4918 | Val  Acc: 0.8424
 Site-SynthDigits                   | Val  Loss: 1.7376 | Val  Acc: 0.3736
 Site-SVHN                          | Val  Loss: 2.1291 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.1608 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5317
============ Train epoch 22 ============
 Site-USPS                          | Train Loss: 0.2557 | Train Acc: 0.9394
 Site-MNIST                         | Train Loss: 0.4585 | Train Acc: 0.8667
 Site-SynthDigits                   | Train Loss: 1.7699 | Train Acc: 0.3934
 Site-SVHN                          | Train Loss: 2.1222 | Train Acc: 0.2167
 Site-MNIST_M                       | Train Loss: 1.9236 | Train Acc: 0.3214
Average Train Accuracy: 0.5475
 Site-USPS                          | Val  Loss: 0.2760 | Val  Acc: 0.9293
 Site-MNIST                         | Val  Loss: 0.4556 | Val  Acc: 0.8606
 Site-SynthDigits                   | Val  Loss: 1.7214 | Val  Acc: 0.3846
 Site-SVHN                          | Val  Loss: 2.1270 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.1686 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5440
 Best site-USPS                      | Epoch:22 | Val Acc: 0.9293
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8606
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.3846
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.2600
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 23 ============
 Site-USPS                          | Train Loss: 0.2512 | Train Acc: 0.9378
 Site-MNIST                         | Train Loss: 0.4398 | Train Acc: 0.8909
 Site-SynthDigits                   | Train Loss: 1.7430 | Train Acc: 0.4016
 Site-SVHN                          | Train Loss: 2.1888 | Train Acc: 0.2069
 Site-MNIST_M                       | Train Loss: 1.9236 | Train Acc: 0.3125
Average Train Accuracy: 0.5499
 Site-USPS                          | Val  Loss: 0.2790 | Val  Acc: 0.9259
 Site-MNIST                         | Val  Loss: 0.4330 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.6998 | Val  Acc: 0.3956
 Site-SVHN                          | Val  Loss: 2.1272 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.1607 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5341
============ Train epoch 24 ============
 Site-USPS                          | Train Loss: 0.2325 | Train Acc: 0.9437
 Site-MNIST                         | Train Loss: 0.4506 | Train Acc: 0.8727
 Site-SynthDigits                   | Train Loss: 1.7604 | Train Acc: 0.3852
 Site-SVHN                          | Train Loss: 2.1939 | Train Acc: 0.2266
 Site-MNIST_M                       | Train Loss: 1.9089 | Train Acc: 0.3304
Average Train Accuracy: 0.5517
 Site-USPS                          | Val  Loss: 0.2528 | Val  Acc: 0.9360
 Site-MNIST                         | Val  Loss: 0.4508 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.7089 | Val  Acc: 0.3736
 Site-SVHN                          | Val  Loss: 2.1393 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1472 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5496
 Best site-USPS                      | Epoch:24 | Val Acc: 0.9360
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8727
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.3736
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.2800
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 25 ============
 Site-USPS                          | Train Loss: 0.2458 | Train Acc: 0.9420
 Site-MNIST                         | Train Loss: 0.3988 | Train Acc: 0.8909
 Site-SynthDigits                   | Train Loss: 1.7458 | Train Acc: 0.3962
 Site-SVHN                          | Train Loss: 2.1411 | Train Acc: 0.2167
 Site-MNIST_M                       | Train Loss: 1.8902 | Train Acc: 0.3214
Average Train Accuracy: 0.5534
 Site-USPS                          | Val  Loss: 0.2752 | Val  Acc: 0.9327
 Site-MNIST                         | Val  Loss: 0.4037 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.7258 | Val  Acc: 0.3956
 Site-SVHN                          | Val  Loss: 2.1330 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1229 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5323
============ Train epoch 26 ============
 Site-USPS                          | Train Loss: 0.2262 | Train Acc: 0.9479
 Site-MNIST                         | Train Loss: 0.3940 | Train Acc: 0.8833
 Site-SynthDigits                   | Train Loss: 1.7203 | Train Acc: 0.3934
 Site-SVHN                          | Train Loss: 2.1584 | Train Acc: 0.2463
 Site-MNIST_M                       | Train Loss: 1.9410 | Train Acc: 0.3125
Average Train Accuracy: 0.5567
 Site-USPS                          | Val  Loss: 0.2444 | Val  Acc: 0.9428
 Site-MNIST                         | Val  Loss: 0.4159 | Val  Acc: 0.8727
 Site-SynthDigits                   | Val  Loss: 1.6637 | Val  Acc: 0.3956
 Site-SVHN                          | Val  Loss: 2.1153 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1815 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5474
============ Train epoch 27 ============
 Site-USPS                          | Train Loss: 0.2143 | Train Acc: 0.9470
 Site-MNIST                         | Train Loss: 0.4139 | Train Acc: 0.8742
 Site-SynthDigits                   | Train Loss: 1.7108 | Train Acc: 0.4044
 Site-SVHN                          | Train Loss: 2.1515 | Train Acc: 0.2660
 Site-MNIST_M                       | Train Loss: 1.9361 | Train Acc: 0.3214
Average Train Accuracy: 0.5626
 Site-USPS                          | Val  Loss: 0.2328 | Val  Acc: 0.9394
 Site-MNIST                         | Val  Loss: 0.4181 | Val  Acc: 0.8424
 Site-SynthDigits                   | Val  Loss: 1.6349 | Val  Acc: 0.4066
 Site-SVHN                          | Val  Loss: 2.1173 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.1840 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5468
============ Train epoch 28 ============
 Site-USPS                          | Train Loss: 0.2230 | Train Acc: 0.9445
 Site-MNIST                         | Train Loss: 0.3754 | Train Acc: 0.9076
 Site-SynthDigits                   | Train Loss: 1.7048 | Train Acc: 0.4016
 Site-SVHN                          | Train Loss: 2.1705 | Train Acc: 0.2414
 Site-MNIST_M                       | Train Loss: 1.9241 | Train Acc: 0.3482
Average Train Accuracy: 0.5687
 Site-USPS                          | Val  Loss: 0.2519 | Val  Acc: 0.9327
 Site-MNIST                         | Val  Loss: 0.3748 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.6613 | Val  Acc: 0.4176
 Site-SVHN                          | Val  Loss: 2.1196 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1615 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5558
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9327
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9030
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.4176
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.2400
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 29 ============
 Site-USPS                          | Train Loss: 0.2216 | Train Acc: 0.9453
 Site-MNIST                         | Train Loss: 0.3580 | Train Acc: 0.9076
 Site-SynthDigits                   | Train Loss: 1.6981 | Train Acc: 0.4098
 Site-SVHN                          | Train Loss: 2.0929 | Train Acc: 0.2463
 Site-MNIST_M                       | Train Loss: 1.9082 | Train Acc: 0.3393
Average Train Accuracy: 0.5697
 Site-USPS                          | Val  Loss: 0.2515 | Val  Acc: 0.9360
 Site-MNIST                         | Val  Loss: 0.3636 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.6474 | Val  Acc: 0.3956
 Site-SVHN                          | Val  Loss: 2.1154 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1685 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5449
============ Train epoch 30 ============
 Site-USPS                          | Train Loss: 0.1997 | Train Acc: 0.9512
 Site-MNIST                         | Train Loss: 0.3700 | Train Acc: 0.9045
 Site-SynthDigits                   | Train Loss: 1.6890 | Train Acc: 0.4016
 Site-SVHN                          | Train Loss: 2.1323 | Train Acc: 0.2562
 Site-MNIST_M                       | Train Loss: 1.9111 | Train Acc: 0.3750
Average Train Accuracy: 0.5777
 Site-USPS                          | Val  Loss: 0.2232 | Val  Acc: 0.9394
 Site-MNIST                         | Val  Loss: 0.3708 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.6283 | Val  Acc: 0.4176
 Site-SVHN                          | Val  Loss: 2.1291 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.1682 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5507
============ Train epoch 31 ============
 Site-USPS                          | Train Loss: 0.1935 | Train Acc: 0.9537
 Site-MNIST                         | Train Loss: 0.3709 | Train Acc: 0.9106
 Site-SynthDigits                   | Train Loss: 1.6535 | Train Acc: 0.4208
 Site-SVHN                          | Train Loss: 2.1386 | Train Acc: 0.2414
 Site-MNIST_M                       | Train Loss: 1.8642 | Train Acc: 0.3750
Average Train Accuracy: 0.5803
 Site-USPS                          | Val  Loss: 0.2141 | Val  Acc: 0.9495
 Site-MNIST                         | Val  Loss: 0.3621 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.5973 | Val  Acc: 0.3956
 Site-SVHN                          | Val  Loss: 2.1088 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1512 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5548
============ Train epoch 32 ============
 Site-USPS                          | Train Loss: 0.2008 | Train Acc: 0.9487
 Site-MNIST                         | Train Loss: 0.3498 | Train Acc: 0.9121
 Site-SynthDigits                   | Train Loss: 1.6516 | Train Acc: 0.4262
 Site-SVHN                          | Train Loss: 2.2034 | Train Acc: 0.2365
 Site-MNIST_M                       | Train Loss: 1.8930 | Train Acc: 0.3482
Average Train Accuracy: 0.5743
 Site-USPS                          | Val  Loss: 0.2238 | Val  Acc: 0.9428
 Site-MNIST                         | Val  Loss: 0.3485 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.6100 | Val  Acc: 0.3846
 Site-SVHN                          | Val  Loss: 2.1062 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1478 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5453
============ Train epoch 33 ============
 Site-USPS                          | Train Loss: 0.1943 | Train Acc: 0.9479
 Site-MNIST                         | Train Loss: 0.3412 | Train Acc: 0.9167
 Site-SynthDigits                   | Train Loss: 1.6657 | Train Acc: 0.4262
 Site-SVHN                          | Train Loss: 2.1515 | Train Acc: 0.2365
 Site-MNIST_M                       | Train Loss: 1.9152 | Train Acc: 0.3571
Average Train Accuracy: 0.5769
 Site-USPS                          | Val  Loss: 0.2189 | Val  Acc: 0.9360
 Site-MNIST                         | Val  Loss: 0.3381 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.6172 | Val  Acc: 0.3846
 Site-SVHN                          | Val  Loss: 2.1172 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1622 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5427
============ Train epoch 34 ============
 Site-USPS                          | Train Loss: 0.1851 | Train Acc: 0.9563
 Site-MNIST                         | Train Loss: 0.3688 | Train Acc: 0.8909
 Site-SynthDigits                   | Train Loss: 1.6642 | Train Acc: 0.4153
 Site-SVHN                          | Train Loss: 2.1493 | Train Acc: 0.2512
 Site-MNIST_M                       | Train Loss: 1.8827 | Train Acc: 0.3393
Average Train Accuracy: 0.5706
 Site-USPS                          | Val  Loss: 0.2045 | Val  Acc: 0.9495
 Site-MNIST                         | Val  Loss: 0.3563 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.5805 | Val  Acc: 0.3956
 Site-SVHN                          | Val  Loss: 2.1330 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1597 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5428
============ Train epoch 35 ============
 Site-USPS                          | Train Loss: 0.1700 | Train Acc: 0.9596
 Site-MNIST                         | Train Loss: 0.3399 | Train Acc: 0.9106
 Site-SynthDigits                   | Train Loss: 1.6435 | Train Acc: 0.4508
 Site-SVHN                          | Train Loss: 2.0938 | Train Acc: 0.2463
 Site-MNIST_M                       | Train Loss: 1.8782 | Train Acc: 0.3571
Average Train Accuracy: 0.5849
 Site-USPS                          | Val  Loss: 0.1859 | Val  Acc: 0.9529
 Site-MNIST                         | Val  Loss: 0.3473 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.5796 | Val  Acc: 0.4286
 Site-SVHN                          | Val  Loss: 2.1154 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.1623 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5672
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9529
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9091
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.4286
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.2600
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 36 ============
 Site-USPS                          | Train Loss: 0.1809 | Train Acc: 0.9529
 Site-MNIST                         | Train Loss: 0.3211 | Train Acc: 0.9121
 Site-SynthDigits                   | Train Loss: 1.6328 | Train Acc: 0.4508
 Site-SVHN                          | Train Loss: 2.1504 | Train Acc: 0.2463
 Site-MNIST_M                       | Train Loss: 1.9037 | Train Acc: 0.3393
Average Train Accuracy: 0.5803
 Site-USPS                          | Val  Loss: 0.2011 | Val  Acc: 0.9461
 Site-MNIST                         | Val  Loss: 0.3211 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.5799 | Val  Acc: 0.4396
 Site-SVHN                          | Val  Loss: 2.1068 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.1513 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5577
============ Train epoch 37 ============
 Site-USPS                          | Train Loss: 0.1610 | Train Acc: 0.9613
 Site-MNIST                         | Train Loss: 0.3209 | Train Acc: 0.9121
 Site-SynthDigits                   | Train Loss: 1.6292 | Train Acc: 0.4617
 Site-SVHN                          | Train Loss: 2.1243 | Train Acc: 0.2463
 Site-MNIST_M                       | Train Loss: 1.8886 | Train Acc: 0.3571
Average Train Accuracy: 0.5877
 Site-USPS                          | Val  Loss: 0.1790 | Val  Acc: 0.9529
 Site-MNIST                         | Val  Loss: 0.3234 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.5629 | Val  Acc: 0.4396
 Site-SVHN                          | Val  Loss: 2.1086 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1526 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5547
============ Train epoch 38 ============
 Site-USPS                          | Train Loss: 0.1723 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.3201 | Train Acc: 0.9152
 Site-SynthDigits                   | Train Loss: 1.6216 | Train Acc: 0.4563
 Site-SVHN                          | Train Loss: 2.0787 | Train Acc: 0.2562
 Site-MNIST_M                       | Train Loss: 1.8625 | Train Acc: 0.3839
Average Train Accuracy: 0.5937
 Site-USPS                          | Val  Loss: 0.1972 | Val  Acc: 0.9495
 Site-MNIST                         | Val  Loss: 0.3184 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.5652 | Val  Acc: 0.4396
 Site-SVHN                          | Val  Loss: 2.0976 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1334 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5632
============ Train epoch 39 ============
 Site-USPS                          | Train Loss: 0.1683 | Train Acc: 0.9563
 Site-MNIST                         | Train Loss: 0.3101 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.5892 | Train Acc: 0.4590
 Site-SVHN                          | Train Loss: 2.1210 | Train Acc: 0.2562
 Site-MNIST_M                       | Train Loss: 1.8936 | Train Acc: 0.3571
Average Train Accuracy: 0.5900
 Site-USPS                          | Val  Loss: 0.1910 | Val  Acc: 0.9461
 Site-MNIST                         | Val  Loss: 0.2948 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.5178 | Val  Acc: 0.4396
 Site-SVHN                          | Val  Loss: 2.0950 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.1556 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5641
============ Train epoch 40 ============
 Site-USPS                          | Train Loss: 0.1590 | Train Acc: 0.9622
 Site-MNIST                         | Train Loss: 0.3046 | Train Acc: 0.9167
 Site-SynthDigits                   | Train Loss: 1.5918 | Train Acc: 0.4508
 Site-SVHN                          | Train Loss: 2.1298 | Train Acc: 0.2660
 Site-MNIST_M                       | Train Loss: 1.8791 | Train Acc: 0.3839
Average Train Accuracy: 0.5959
 Site-USPS                          | Val  Loss: 0.1778 | Val  Acc: 0.9529
 Site-MNIST                         | Val  Loss: 0.2984 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.5103 | Val  Acc: 0.4066
 Site-SVHN                          | Val  Loss: 2.0823 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1538 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5669
============ Train epoch 41 ============
 Site-USPS                          | Train Loss: 0.1523 | Train Acc: 0.9630
 Site-MNIST                         | Train Loss: 0.3113 | Train Acc: 0.9121
 Site-SynthDigits                   | Train Loss: 1.6114 | Train Acc: 0.4454
 Site-SVHN                          | Train Loss: 2.1709 | Train Acc: 0.2562
 Site-MNIST_M                       | Train Loss: 1.8360 | Train Acc: 0.3661
Average Train Accuracy: 0.5885
 Site-USPS                          | Val  Loss: 0.1712 | Val  Acc: 0.9562
 Site-MNIST                         | Val  Loss: 0.3024 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.5383 | Val  Acc: 0.4176
 Site-SVHN                          | Val  Loss: 2.0745 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.1381 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5562
============ Train epoch 42 ============
 Site-USPS                          | Train Loss: 0.1577 | Train Acc: 0.9588
 Site-MNIST                         | Train Loss: 0.2875 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.5736 | Train Acc: 0.4672
 Site-SVHN                          | Train Loss: 2.1572 | Train Acc: 0.2611
 Site-MNIST_M                       | Train Loss: 1.8437 | Train Acc: 0.3661
Average Train Accuracy: 0.5949
 Site-USPS                          | Val  Loss: 0.1788 | Val  Acc: 0.9529
 Site-MNIST                         | Val  Loss: 0.2849 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.5145 | Val  Acc: 0.4396
 Site-SVHN                          | Val  Loss: 2.0929 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1498 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5675
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9529
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9152
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.4396
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.2800
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 43 ============
 Site-USPS                          | Train Loss: 0.1700 | Train Acc: 0.9537
 Site-MNIST                         | Train Loss: 0.2581 | Train Acc: 0.9258
 Site-SynthDigits                   | Train Loss: 1.5734 | Train Acc: 0.4754
 Site-SVHN                          | Train Loss: 2.1321 | Train Acc: 0.2562
 Site-MNIST_M                       | Train Loss: 1.8464 | Train Acc: 0.3929
Average Train Accuracy: 0.6008
 Site-USPS                          | Val  Loss: 0.1979 | Val  Acc: 0.9428
 Site-MNIST                         | Val  Loss: 0.2579 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.5280 | Val  Acc: 0.4505
 Site-SVHN                          | Val  Loss: 2.0811 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1251 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5760
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9428
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9212
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.4505
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.2800
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 44 ============
 Site-USPS                          | Train Loss: 0.1426 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.2890 | Train Acc: 0.9273
 Site-SynthDigits                   | Train Loss: 1.5713 | Train Acc: 0.4617
 Site-SVHN                          | Train Loss: 2.1517 | Train Acc: 0.2315
 Site-MNIST_M                       | Train Loss: 1.8621 | Train Acc: 0.3839
Average Train Accuracy: 0.5947
 Site-USPS                          | Val  Loss: 0.1570 | Val  Acc: 0.9630
 Site-MNIST                         | Val  Loss: 0.2748 | Val  Acc: 0.9091
 Site-SynthDigits                   | Val  Loss: 1.4871 | Val  Acc: 0.4066
 Site-SVHN                          | Val  Loss: 2.0952 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.1540 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5649
============ Train epoch 45 ============
 Site-USPS                          | Train Loss: 0.1515 | Train Acc: 0.9655
 Site-MNIST                         | Train Loss: 0.2632 | Train Acc: 0.9333
 Site-SynthDigits                   | Train Loss: 1.5566 | Train Acc: 0.4645
 Site-SVHN                          | Train Loss: 2.1459 | Train Acc: 0.2611
 Site-MNIST_M                       | Train Loss: 1.8685 | Train Acc: 0.3750
Average Train Accuracy: 0.5999
 Site-USPS                          | Val  Loss: 0.1674 | Val  Acc: 0.9630
 Site-MNIST                         | Val  Loss: 0.2624 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.4986 | Val  Acc: 0.4176
 Site-SVHN                          | Val  Loss: 2.0842 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1603 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5676
============ Train epoch 46 ============
 Site-USPS                          | Train Loss: 0.1393 | Train Acc: 0.9706
 Site-MNIST                         | Train Loss: 0.2707 | Train Acc: 0.9288
 Site-SynthDigits                   | Train Loss: 1.5791 | Train Acc: 0.4645
 Site-SVHN                          | Train Loss: 2.1729 | Train Acc: 0.2512
 Site-MNIST_M                       | Train Loss: 1.8593 | Train Acc: 0.3750
Average Train Accuracy: 0.5980
 Site-USPS                          | Val  Loss: 0.1515 | Val  Acc: 0.9731
 Site-MNIST                         | Val  Loss: 0.2628 | Val  Acc: 0.9152
 Site-SynthDigits                   | Val  Loss: 1.4798 | Val  Acc: 0.4176
 Site-SVHN                          | Val  Loss: 2.0938 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1348 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5743
============ Train epoch 47 ============
 Site-USPS                          | Train Loss: 0.1311 | Train Acc: 0.9748
 Site-MNIST                         | Train Loss: 0.2878 | Train Acc: 0.9318
 Site-SynthDigits                   | Train Loss: 1.5598 | Train Acc: 0.4590
 Site-SVHN                          | Train Loss: 2.1132 | Train Acc: 0.2759
 Site-MNIST_M                       | Train Loss: 1.8764 | Train Acc: 0.3750
Average Train Accuracy: 0.6033
 Site-USPS                          | Val  Loss: 0.1512 | Val  Acc: 0.9731
 Site-MNIST                         | Val  Loss: 0.2570 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.4827 | Val  Acc: 0.3956
 Site-SVHN                          | Val  Loss: 2.0721 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.1790 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5751
============ Train epoch 48 ============
 Site-USPS                          | Train Loss: 0.1272 | Train Acc: 0.9739
 Site-MNIST                         | Train Loss: 0.2700 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.5491 | Train Acc: 0.4809
 Site-SVHN                          | Train Loss: 2.0923 | Train Acc: 0.2611
 Site-MNIST_M                       | Train Loss: 1.8374 | Train Acc: 0.4018
Average Train Accuracy: 0.6078
 Site-USPS                          | Val  Loss: 0.1428 | Val  Acc: 0.9731
 Site-MNIST                         | Val  Loss: 0.2633 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.4879 | Val  Acc: 0.4725
 Site-SVHN                          | Val  Loss: 2.0663 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.1397 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5829
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9731
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9030
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.4725
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.2800
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedavg...
============ Train epoch 49 ============
 Site-USPS                          | Train Loss: 0.1310 | Train Acc: 0.9714
 Site-MNIST                         | Train Loss: 0.2588 | Train Acc: 0.9333
 Site-SynthDigits                   | Train Loss: 1.5353 | Train Acc: 0.4727
 Site-SVHN                          | Train Loss: 2.0684 | Train Acc: 0.2611
 Site-MNIST_M                       | Train Loss: 1.8496 | Train Acc: 0.3839
Average Train Accuracy: 0.6045
 Site-USPS                          | Val  Loss: 0.1469 | Val  Acc: 0.9663
 Site-MNIST                         | Val  Loss: 0.2400 | Val  Acc: 0.9273
 Site-SynthDigits                   | Val  Loss: 1.4764 | Val  Acc: 0.3956
 Site-SVHN                          | Val  Loss: 2.0760 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.1587 | Val  Acc: 0.2857
Average Valid Accuracy: 0.5750
===2023-07-02 13:52:30===
===2023-07-02 13:52:32===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
Loading snapshots...
 Test site-USPS                      | Epoch:48 | Test Acc: 0.9419
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.8937
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.4389
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.2434
 Test site-MNIST_M                   | Epoch:48 | Test Acc: 0.3200
USPS: 0.9419, MNIST: 0.8937, SynthDigits: 0.4389, SVHN: 0.2434, MNIST_M: 0.3200, 
Average Test Accuracy(group): 0.5676, Average Test Accuracy(individual): 0.5676,
domain std=0.2931, cluster std=-1.0000, individual std=0.2931, 
