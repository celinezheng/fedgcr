===2023-07-02 20:27:08===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
============ Train epoch 0 ============
 Site-USPS                          | Train Loss: 0.7366 | Train Acc: 0.8595
 Site-MNIST                         | Train Loss: 1.1304 | Train Acc: 0.7106
 Site-SynthDigits                   | Train Loss: 2.0320 | Train Acc: 0.3169
 Site-SVHN                          | Train Loss: 2.2588 | Train Acc: 0.1429
 Site-MNIST_M                       | Train Loss: 2.1719 | Train Acc: 0.2500
Average Train Accuracy: 0.4560
 Site-USPS                          | Val  Loss: 0.7788 | Val  Acc: 0.8384
 Site-MNIST                         | Val  Loss: 1.1016 | Val  Acc: 0.7333
 Site-SynthDigits                   | Val  Loss: 2.0352 | Val  Acc: 0.3297
 Site-SVHN                          | Val  Loss: 2.2652 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.3087 | Val  Acc: 0.1071
Average Valid Accuracy: 0.4457
 Best site-USPS                      | Epoch:0 | Val Acc: 0.8384
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7333
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.3297
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2200
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 1 ============
 Site-USPS                          | Train Loss: 0.4468 | Train Acc: 0.8696
 Site-MNIST                         | Train Loss: 0.7547 | Train Acc: 0.7803
 Site-SynthDigits                   | Train Loss: 1.9019 | Train Acc: 0.3634
 Site-SVHN                          | Train Loss: 2.1815 | Train Acc: 0.1626
 Site-MNIST_M                       | Train Loss: 2.0783 | Train Acc: 0.2679
Average Train Accuracy: 0.4887
 Site-USPS                          | Val  Loss: 0.4739 | Val  Acc: 0.8519
 Site-MNIST                         | Val  Loss: 0.7056 | Val  Acc: 0.8061
 Site-SynthDigits                   | Val  Loss: 1.9034 | Val  Acc: 0.3736
 Site-SVHN                          | Val  Loss: 2.1986 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.2647 | Val  Acc: 0.1071
Average Valid Accuracy: 0.4677
 Best site-USPS                      | Epoch:1 | Val Acc: 0.8519
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8061
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3736
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2000
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.1071
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 2 ============
 Site-USPS                          | Train Loss: 0.3117 | Train Acc: 0.9184
 Site-MNIST                         | Train Loss: 0.6299 | Train Acc: 0.7955
 Site-SynthDigits                   | Train Loss: 1.8780 | Train Acc: 0.3525
 Site-SVHN                          | Train Loss: 2.2332 | Train Acc: 0.1724
 Site-MNIST_M                       | Train Loss: 1.9869 | Train Acc: 0.2946
Average Train Accuracy: 0.5067
 Site-USPS                          | Val  Loss: 0.3257 | Val  Acc: 0.9057
 Site-MNIST                         | Val  Loss: 0.6223 | Val  Acc: 0.8242
 Site-SynthDigits                   | Val  Loss: 1.8783 | Val  Acc: 0.3297
 Site-SVHN                          | Val  Loss: 2.2438 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.2247 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4805
 Best site-USPS                      | Epoch:2 | Val Acc: 0.9057
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8242
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3297
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2000
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 3 ============
 Site-USPS                          | Train Loss: 0.2860 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.5017 | Train Acc: 0.8364
 Site-SynthDigits                   | Train Loss: 1.8079 | Train Acc: 0.3852
 Site-SVHN                          | Train Loss: 2.2612 | Train Acc: 0.2020
 Site-MNIST_M                       | Train Loss: 1.9747 | Train Acc: 0.3125
Average Train Accuracy: 0.5306
 Site-USPS                          | Val  Loss: 0.3010 | Val  Acc: 0.9057
 Site-MNIST                         | Val  Loss: 0.4611 | Val  Acc: 0.8424
 Site-SynthDigits                   | Val  Loss: 1.8062 | Val  Acc: 0.3407
 Site-SVHN                          | Val  Loss: 2.1888 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.2290 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4863
 Best site-USPS                      | Epoch:3 | Val Acc: 0.9057
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8424
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3407
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2000
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 4 ============
 Site-USPS                          | Train Loss: 0.2335 | Train Acc: 0.9243
 Site-MNIST                         | Train Loss: 0.4553 | Train Acc: 0.8606
 Site-SynthDigits                   | Train Loss: 1.7972 | Train Acc: 0.3907
 Site-SVHN                          | Train Loss: 2.1773 | Train Acc: 0.2512
 Site-MNIST_M                       | Train Loss: 1.9128 | Train Acc: 0.3125
Average Train Accuracy: 0.5479
 Site-USPS                          | Val  Loss: 0.2467 | Val  Acc: 0.9057
 Site-MNIST                         | Val  Loss: 0.4013 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.7714 | Val  Acc: 0.3956
 Site-SVHN                          | Val  Loss: 2.1374 | Val  Acc: 0.2200
 Site-MNIST_M                       | Val  Loss: 2.1993 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5180
 Best site-USPS                      | Epoch:4 | Val Acc: 0.9057
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8545
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3956
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2200
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 5 ============
 Site-USPS                          | Train Loss: 0.2100 | Train Acc: 0.9403
 Site-MNIST                         | Train Loss: 0.4038 | Train Acc: 0.8606
 Site-SynthDigits                   | Train Loss: 1.7239 | Train Acc: 0.4235
 Site-SVHN                          | Train Loss: 2.2182 | Train Acc: 0.2562
 Site-MNIST_M                       | Train Loss: 1.9340 | Train Acc: 0.3125
Average Train Accuracy: 0.5586
 Site-USPS                          | Val  Loss: 0.2308 | Val  Acc: 0.9360
 Site-MNIST                         | Val  Loss: 0.4030 | Val  Acc: 0.8545
 Site-SynthDigits                   | Val  Loss: 1.6671 | Val  Acc: 0.4615
 Site-SVHN                          | Val  Loss: 2.1180 | Val  Acc: 0.2400
 Site-MNIST_M                       | Val  Loss: 2.2683 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5341
 Best site-USPS                      | Epoch:5 | Val Acc: 0.9360
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8545
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4615
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2400
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.1786
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 6 ============
 Site-USPS                          | Train Loss: 0.1768 | Train Acc: 0.9453
 Site-MNIST                         | Train Loss: 0.3516 | Train Acc: 0.8803
 Site-SynthDigits                   | Train Loss: 1.6293 | Train Acc: 0.4454
 Site-SVHN                          | Train Loss: 2.2371 | Train Acc: 0.2660
 Site-MNIST_M                       | Train Loss: 1.9012 | Train Acc: 0.3125
Average Train Accuracy: 0.5699
 Site-USPS                          | Val  Loss: 0.1829 | Val  Acc: 0.9428
 Site-MNIST                         | Val  Loss: 0.3209 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.6043 | Val  Acc: 0.4176
 Site-SVHN                          | Val  Loss: 2.1677 | Val  Acc: 0.2000
 Site-MNIST_M                       | Val  Loss: 2.2582 | Val  Acc: 0.1786
Average Valid Accuracy: 0.5235
============ Train epoch 7 ============
 Site-USPS                          | Train Loss: 0.1618 | Train Acc: 0.9537
 Site-MNIST                         | Train Loss: 0.3186 | Train Acc: 0.8894
 Site-SynthDigits                   | Train Loss: 1.6340 | Train Acc: 0.4727
 Site-SVHN                          | Train Loss: 2.0879 | Train Acc: 0.2956
 Site-MNIST_M                       | Train Loss: 1.8959 | Train Acc: 0.3125
Average Train Accuracy: 0.5848
 Site-USPS                          | Val  Loss: 0.1807 | Val  Acc: 0.9461
 Site-MNIST                         | Val  Loss: 0.3001 | Val  Acc: 0.8788
 Site-SynthDigits                   | Val  Loss: 1.5915 | Val  Acc: 0.4505
 Site-SVHN                          | Val  Loss: 2.1556 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.2606 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5540
 Best site-USPS                      | Epoch:7 | Val Acc: 0.9461
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8788
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4505
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2800
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 8 ============
 Site-USPS                          | Train Loss: 0.1281 | Train Acc: 0.9622
 Site-MNIST                         | Train Loss: 0.3096 | Train Acc: 0.8894
 Site-SynthDigits                   | Train Loss: 1.5795 | Train Acc: 0.4945
 Site-SVHN                          | Train Loss: 2.2530 | Train Acc: 0.2709
 Site-MNIST_M                       | Train Loss: 1.8844 | Train Acc: 0.3036
Average Train Accuracy: 0.5841
 Site-USPS                          | Val  Loss: 0.1486 | Val  Acc: 0.9596
 Site-MNIST                         | Val  Loss: 0.2866 | Val  Acc: 0.8606
 Site-SynthDigits                   | Val  Loss: 1.5884 | Val  Acc: 0.4945
 Site-SVHN                          | Val  Loss: 2.1798 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.2266 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5578
 Best site-USPS                      | Epoch:8 | Val Acc: 0.9596
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8606
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4945
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2600
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 9 ============
 Site-USPS                          | Train Loss: 0.1156 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.2882 | Train Acc: 0.8939
 Site-SynthDigits                   | Train Loss: 1.5314 | Train Acc: 0.4891
 Site-SVHN                          | Train Loss: 2.0918 | Train Acc: 0.2759
 Site-MNIST_M                       | Train Loss: 1.8458 | Train Acc: 0.3125
Average Train Accuracy: 0.5881
 Site-USPS                          | Val  Loss: 0.1315 | Val  Acc: 0.9562
 Site-MNIST                         | Val  Loss: 0.2772 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.5031 | Val  Acc: 0.5055
 Site-SVHN                          | Val  Loss: 2.1431 | Val  Acc: 0.2600
 Site-MNIST_M                       | Val  Loss: 2.2180 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5713
 Best site-USPS                      | Epoch:9 | Val Acc: 0.9562
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8848
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.5055
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2600
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 10 ============
 Site-USPS                          | Train Loss: 0.0990 | Train Acc: 0.9756
 Site-MNIST                         | Train Loss: 0.2820 | Train Acc: 0.8894
 Site-SynthDigits                   | Train Loss: 1.5222 | Train Acc: 0.5164
 Site-SVHN                          | Train Loss: 2.1324 | Train Acc: 0.3103
 Site-MNIST_M                       | Train Loss: 1.7909 | Train Acc: 0.3214
Average Train Accuracy: 0.6026
 Site-USPS                          | Val  Loss: 0.1097 | Val  Acc: 0.9731
 Site-MNIST                         | Val  Loss: 0.2697 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.5083 | Val  Acc: 0.5275
 Site-SVHN                          | Val  Loss: 2.1017 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.1770 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5871
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9731
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8848
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5275
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3000
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 11 ============
 Site-USPS                          | Train Loss: 0.0896 | Train Acc: 0.9790
 Site-MNIST                         | Train Loss: 0.2769 | Train Acc: 0.8894
 Site-SynthDigits                   | Train Loss: 1.4978 | Train Acc: 0.5109
 Site-SVHN                          | Train Loss: 2.0650 | Train Acc: 0.3005
 Site-MNIST_M                       | Train Loss: 1.8360 | Train Acc: 0.3036
Average Train Accuracy: 0.5967
 Site-USPS                          | Val  Loss: 0.0955 | Val  Acc: 0.9798
 Site-MNIST                         | Val  Loss: 0.2903 | Val  Acc: 0.8667
 Site-SynthDigits                   | Val  Loss: 1.4932 | Val  Acc: 0.5495
 Site-SVHN                          | Val  Loss: 2.1083 | Val  Acc: 0.3200
 Site-MNIST_M                       | Val  Loss: 2.2296 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5860
============ Train epoch 12 ============
 Site-USPS                          | Train Loss: 0.0829 | Train Acc: 0.9781
 Site-MNIST                         | Train Loss: 0.2625 | Train Acc: 0.9045
 Site-SynthDigits                   | Train Loss: 1.4592 | Train Acc: 0.5410
 Site-SVHN                          | Train Loss: 2.2104 | Train Acc: 0.3103
 Site-MNIST_M                       | Train Loss: 1.8843 | Train Acc: 0.3214
Average Train Accuracy: 0.6111
 Site-USPS                          | Val  Loss: 0.0953 | Val  Acc: 0.9798
 Site-MNIST                         | Val  Loss: 0.2490 | Val  Acc: 0.8848
 Site-SynthDigits                   | Val  Loss: 1.4232 | Val  Acc: 0.5714
 Site-SVHN                          | Val  Loss: 2.1285 | Val  Acc: 0.3200
 Site-MNIST_M                       | Val  Loss: 2.3348 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5941
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9798
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8848
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.5714
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3200
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 13 ============
 Site-USPS                          | Train Loss: 0.0783 | Train Acc: 0.9815
 Site-MNIST                         | Train Loss: 0.2257 | Train Acc: 0.9167
 Site-SynthDigits                   | Train Loss: 1.4618 | Train Acc: 0.5082
 Site-SVHN                          | Train Loss: 2.0531 | Train Acc: 0.3153
 Site-MNIST_M                       | Train Loss: 1.8360 | Train Acc: 0.3482
Average Train Accuracy: 0.6140
 Site-USPS                          | Val  Loss: 0.0862 | Val  Acc: 0.9731
 Site-MNIST                         | Val  Loss: 0.2295 | Val  Acc: 0.8909
 Site-SynthDigits                   | Val  Loss: 1.3834 | Val  Acc: 0.5385
 Site-SVHN                          | Val  Loss: 2.0745 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 2.3324 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5985
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9731
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8909
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5385
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3400
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 14 ============
 Site-USPS                          | Train Loss: 0.0702 | Train Acc: 0.9832
 Site-MNIST                         | Train Loss: 0.2139 | Train Acc: 0.9182
 Site-SynthDigits                   | Train Loss: 1.4251 | Train Acc: 0.5328
 Site-SVHN                          | Train Loss: 2.1562 | Train Acc: 0.2956
 Site-MNIST_M                       | Train Loss: 1.8989 | Train Acc: 0.3214
Average Train Accuracy: 0.6102
 Site-USPS                          | Val  Loss: 0.0784 | Val  Acc: 0.9798
 Site-MNIST                         | Val  Loss: 0.2216 | Val  Acc: 0.8970
 Site-SynthDigits                   | Val  Loss: 1.3933 | Val  Acc: 0.5385
 Site-SVHN                          | Val  Loss: 2.0839 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.3410 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5930
============ Train epoch 15 ============
 Site-USPS                          | Train Loss: 0.0652 | Train Acc: 0.9882
 Site-MNIST                         | Train Loss: 0.1977 | Train Acc: 0.9167
 Site-SynthDigits                   | Train Loss: 1.4297 | Train Acc: 0.5437
 Site-SVHN                          | Train Loss: 2.1454 | Train Acc: 0.3054
 Site-MNIST_M                       | Train Loss: 1.8485 | Train Acc: 0.3571
Average Train Accuracy: 0.6222
 Site-USPS                          | Val  Loss: 0.0719 | Val  Acc: 0.9865
 Site-MNIST                         | Val  Loss: 0.1966 | Val  Acc: 0.9030
 Site-SynthDigits                   | Val  Loss: 1.4070 | Val  Acc: 0.5604
 Site-SVHN                          | Val  Loss: 2.1011 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 2.4011 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6080
 Best site-USPS                      | Epoch:15 | Val Acc: 0.9865
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.9030
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.5604
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3400
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 16 ============
 Site-USPS                          | Train Loss: 0.0574 | Train Acc: 0.9907
 Site-MNIST                         | Train Loss: 0.1940 | Train Acc: 0.9348
 Site-SynthDigits                   | Train Loss: 1.3594 | Train Acc: 0.5710
 Site-SVHN                          | Train Loss: 2.0414 | Train Acc: 0.3054
 Site-MNIST_M                       | Train Loss: 1.8153 | Train Acc: 0.3393
Average Train Accuracy: 0.6283
 Site-USPS                          | Val  Loss: 0.0651 | Val  Acc: 0.9899
 Site-MNIST                         | Val  Loss: 0.1862 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.3306 | Val  Acc: 0.5824
 Site-SVHN                          | Val  Loss: 2.0867 | Val  Acc: 0.2800
 Site-MNIST_M                       | Val  Loss: 2.3370 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5976
============ Train epoch 17 ============
 Site-USPS                          | Train Loss: 0.0594 | Train Acc: 0.9849
 Site-MNIST                         | Train Loss: 0.1753 | Train Acc: 0.9348
 Site-SynthDigits                   | Train Loss: 1.3103 | Train Acc: 0.5956
 Site-SVHN                          | Train Loss: 2.1993 | Train Acc: 0.3103
 Site-MNIST_M                       | Train Loss: 1.8421 | Train Acc: 0.3571
Average Train Accuracy: 0.6366
 Site-USPS                          | Val  Loss: 0.0651 | Val  Acc: 0.9865
 Site-MNIST                         | Val  Loss: 0.1707 | Val  Acc: 0.9212
 Site-SynthDigits                   | Val  Loss: 1.2968 | Val  Acc: 0.6484
 Site-SVHN                          | Val  Loss: 2.1042 | Val  Acc: 0.3000
 Site-MNIST_M                       | Val  Loss: 2.2593 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6212
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9865
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9212
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.6484
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3000
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 18 ============
 Site-USPS                          | Train Loss: 0.0479 | Train Acc: 0.9941
 Site-MNIST                         | Train Loss: 0.1539 | Train Acc: 0.9424
 Site-SynthDigits                   | Train Loss: 1.2912 | Train Acc: 0.5902
 Site-SVHN                          | Train Loss: 2.1292 | Train Acc: 0.3350
 Site-MNIST_M                       | Train Loss: 1.7855 | Train Acc: 0.3750
Average Train Accuracy: 0.6473
 Site-USPS                          | Val  Loss: 0.0538 | Val  Acc: 0.9865
 Site-MNIST                         | Val  Loss: 0.1483 | Val  Acc: 0.9455
 Site-SynthDigits                   | Val  Loss: 1.2615 | Val  Acc: 0.6154
 Site-SVHN                          | Val  Loss: 2.1143 | Val  Acc: 0.3400
 Site-MNIST_M                       | Val  Loss: 2.2744 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6275
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9865
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9455
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.6154
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3400
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 19 ============
 Site-USPS                          | Train Loss: 0.0509 | Train Acc: 0.9891
 Site-MNIST                         | Train Loss: 0.1480 | Train Acc: 0.9455
 Site-SynthDigits                   | Train Loss: 1.2819 | Train Acc: 0.5902
 Site-SVHN                          | Train Loss: 1.9511 | Train Acc: 0.3103
 Site-MNIST_M                       | Train Loss: 1.7815 | Train Acc: 0.4107
Average Train Accuracy: 0.6491
 Site-USPS                          | Val  Loss: 0.0559 | Val  Acc: 0.9865
 Site-MNIST                         | Val  Loss: 0.1322 | Val  Acc: 0.9455
 Site-SynthDigits                   | Val  Loss: 1.2863 | Val  Acc: 0.6044
 Site-SVHN                          | Val  Loss: 2.0904 | Val  Acc: 0.3200
 Site-MNIST_M                       | Val  Loss: 2.2271 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6284
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9865
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9455
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.6044
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3200
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 20 ============
 Site-USPS                          | Train Loss: 0.0435 | Train Acc: 0.9933
 Site-MNIST                         | Train Loss: 0.1338 | Train Acc: 0.9576
 Site-SynthDigits                   | Train Loss: 1.2858 | Train Acc: 0.6038
 Site-SVHN                          | Train Loss: 2.0057 | Train Acc: 0.3103
 Site-MNIST_M                       | Train Loss: 1.7656 | Train Acc: 0.3929
Average Train Accuracy: 0.6516
 Site-USPS                          | Val  Loss: 0.0442 | Val  Acc: 0.9933
 Site-MNIST                         | Val  Loss: 0.1255 | Val  Acc: 0.9576
 Site-SynthDigits                   | Val  Loss: 1.2875 | Val  Acc: 0.6154
 Site-SVHN                          | Val  Loss: 2.0626 | Val  Acc: 0.3200
 Site-MNIST_M                       | Val  Loss: 2.2431 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6344
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9933
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9576
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.6154
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3200
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 21 ============
 Site-USPS                          | Train Loss: 0.0419 | Train Acc: 0.9933
 Site-MNIST                         | Train Loss: 0.1347 | Train Acc: 0.9530
 Site-SynthDigits                   | Train Loss: 1.2610 | Train Acc: 0.6038
 Site-SVHN                          | Train Loss: 2.0861 | Train Acc: 0.3350
 Site-MNIST_M                       | Train Loss: 1.8095 | Train Acc: 0.4018
Average Train Accuracy: 0.6574
 Site-USPS                          | Val  Loss: 0.0413 | Val  Acc: 0.9933
 Site-MNIST                         | Val  Loss: 0.1285 | Val  Acc: 0.9515
 Site-SynthDigits                   | Val  Loss: 1.2609 | Val  Acc: 0.6484
 Site-SVHN                          | Val  Loss: 2.0597 | Val  Acc: 0.3600
 Site-MNIST_M                       | Val  Loss: 2.2743 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6406
 Best site-USPS                      | Epoch:21 | Val Acc: 0.9933
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9515
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.6484
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.3600
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 22 ============
 Site-USPS                          | Train Loss: 0.0420 | Train Acc: 0.9941
 Site-MNIST                         | Train Loss: 0.1252 | Train Acc: 0.9697
 Site-SynthDigits                   | Train Loss: 1.2498 | Train Acc: 0.6202
 Site-SVHN                          | Train Loss: 2.1492 | Train Acc: 0.3251
 Site-MNIST_M                       | Train Loss: 1.7958 | Train Acc: 0.3839
Average Train Accuracy: 0.6586
 Site-USPS                          | Val  Loss: 0.0404 | Val  Acc: 0.9933
 Site-MNIST                         | Val  Loss: 0.1083 | Val  Acc: 0.9758
 Site-SynthDigits                   | Val  Loss: 1.2116 | Val  Acc: 0.6593
 Site-SVHN                          | Val  Loss: 2.0332 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 2.2985 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6628
 Best site-USPS                      | Epoch:22 | Val Acc: 0.9933
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9758
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.6593
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.4000
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 23 ============
 Site-USPS                          | Train Loss: 0.0384 | Train Acc: 0.9950
 Site-MNIST                         | Train Loss: 0.1124 | Train Acc: 0.9697
 Site-SynthDigits                   | Train Loss: 1.2916 | Train Acc: 0.6011
 Site-SVHN                          | Train Loss: 2.0752 | Train Acc: 0.3300
 Site-MNIST_M                       | Train Loss: 1.7590 | Train Acc: 0.3929
Average Train Accuracy: 0.6577
 Site-USPS                          | Val  Loss: 0.0416 | Val  Acc: 0.9933
 Site-MNIST                         | Val  Loss: 0.1007 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 1.2462 | Val  Acc: 0.6703
 Site-SVHN                          | Val  Loss: 2.0113 | Val  Acc: 0.3800
 Site-MNIST_M                       | Val  Loss: 2.3166 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6551
============ Train epoch 24 ============
 Site-USPS                          | Train Loss: 0.0349 | Train Acc: 0.9950
 Site-MNIST                         | Train Loss: 0.1074 | Train Acc: 0.9667
 Site-SynthDigits                   | Train Loss: 1.2903 | Train Acc: 0.6038
 Site-SVHN                          | Train Loss: 2.0951 | Train Acc: 0.3498
 Site-MNIST_M                       | Train Loss: 1.7621 | Train Acc: 0.4107
Average Train Accuracy: 0.6652
 Site-USPS                          | Val  Loss: 0.0382 | Val  Acc: 0.9899
 Site-MNIST                         | Val  Loss: 0.1137 | Val  Acc: 0.9515
 Site-SynthDigits                   | Val  Loss: 1.2122 | Val  Acc: 0.6703
 Site-SVHN                          | Val  Loss: 1.9833 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 2.3614 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6595
============ Train epoch 25 ============
 Site-USPS                          | Train Loss: 0.0337 | Train Acc: 0.9966
 Site-MNIST                         | Train Loss: 0.1027 | Train Acc: 0.9773
 Site-SynthDigits                   | Train Loss: 1.2472 | Train Acc: 0.6066
 Site-SVHN                          | Train Loss: 2.0332 | Train Acc: 0.3547
 Site-MNIST_M                       | Train Loss: 1.7660 | Train Acc: 0.4018
Average Train Accuracy: 0.6674
 Site-USPS                          | Val  Loss: 0.0373 | Val  Acc: 0.9933
 Site-MNIST                         | Val  Loss: 0.1030 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 1.2155 | Val  Acc: 0.6593
 Site-SVHN                          | Val  Loss: 1.9931 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 2.3482 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6712
 Best site-USPS                      | Epoch:25 | Val Acc: 0.9933
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9818
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.6593
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.4000
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 26 ============
 Site-USPS                          | Train Loss: 0.0274 | Train Acc: 0.9975
 Site-MNIST                         | Train Loss: 0.1111 | Train Acc: 0.9636
 Site-SynthDigits                   | Train Loss: 1.2107 | Train Acc: 0.6175
 Site-SVHN                          | Train Loss: 2.1914 | Train Acc: 0.3399
 Site-MNIST_M                       | Train Loss: 1.7799 | Train Acc: 0.3929
Average Train Accuracy: 0.6623
 Site-USPS                          | Val  Loss: 0.0360 | Val  Acc: 0.9966
 Site-MNIST                         | Val  Loss: 0.1063 | Val  Acc: 0.9394
 Site-SynthDigits                   | Val  Loss: 1.1306 | Val  Acc: 0.6703
 Site-SVHN                          | Val  Loss: 1.9973 | Val  Acc: 0.3800
 Site-MNIST_M                       | Val  Loss: 2.3829 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6616
============ Train epoch 27 ============
 Site-USPS                          | Train Loss: 0.0246 | Train Acc: 0.9992
 Site-MNIST                         | Train Loss: 0.0948 | Train Acc: 0.9712
 Site-SynthDigits                   | Train Loss: 1.2159 | Train Acc: 0.6284
 Site-SVHN                          | Train Loss: 2.0597 | Train Acc: 0.3547
 Site-MNIST_M                       | Train Loss: 1.8301 | Train Acc: 0.4375
Average Train Accuracy: 0.6782
 Site-USPS                          | Val  Loss: 0.0281 | Val  Acc: 0.9966
 Site-MNIST                         | Val  Loss: 0.0924 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.1090 | Val  Acc: 0.7033
 Site-SVHN                          | Val  Loss: 1.9659 | Val  Acc: 0.4200
 Site-MNIST_M                       | Val  Loss: 2.3732 | Val  Acc: 0.3571
Average Valid Accuracy: 0.6894
 Best site-USPS                      | Epoch:27 | Val Acc: 0.9966
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9697
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.7033
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.4200
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 28 ============
 Site-USPS                          | Train Loss: 0.0257 | Train Acc: 0.9983
 Site-MNIST                         | Train Loss: 0.0890 | Train Acc: 0.9773
 Site-SynthDigits                   | Train Loss: 1.1820 | Train Acc: 0.6475
 Site-SVHN                          | Train Loss: 2.0838 | Train Acc: 0.3596
 Site-MNIST_M                       | Train Loss: 1.8256 | Train Acc: 0.4018
Average Train Accuracy: 0.6769
 Site-USPS                          | Val  Loss: 0.0294 | Val  Acc: 0.9966
 Site-MNIST                         | Val  Loss: 0.0760 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 1.1020 | Val  Acc: 0.7253
 Site-SVHN                          | Val  Loss: 1.9545 | Val  Acc: 0.4200
 Site-MNIST_M                       | Val  Loss: 2.3688 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6819
============ Train epoch 29 ============
 Site-USPS                          | Train Loss: 0.0210 | Train Acc: 0.9983
 Site-MNIST                         | Train Loss: 0.0892 | Train Acc: 0.9682
 Site-SynthDigits                   | Train Loss: 1.1591 | Train Acc: 0.6475
 Site-SVHN                          | Train Loss: 1.8669 | Train Acc: 0.3596
 Site-MNIST_M                       | Train Loss: 1.8172 | Train Acc: 0.4196
Average Train Accuracy: 0.6787
 Site-USPS                          | Val  Loss: 0.0249 | Val  Acc: 0.9933
 Site-MNIST                         | Val  Loss: 0.0856 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.1158 | Val  Acc: 0.7033
 Site-SVHN                          | Val  Loss: 1.9300 | Val  Acc: 0.4200
 Site-MNIST_M                       | Val  Loss: 2.3809 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6673
============ Train epoch 30 ============
 Site-USPS                          | Train Loss: 0.0213 | Train Acc: 0.9975
 Site-MNIST                         | Train Loss: 0.0833 | Train Acc: 0.9712
 Site-SynthDigits                   | Train Loss: 1.1620 | Train Acc: 0.6585
 Site-SVHN                          | Train Loss: 2.0346 | Train Acc: 0.3498
 Site-MNIST_M                       | Train Loss: 1.7843 | Train Acc: 0.4107
Average Train Accuracy: 0.6775
 Site-USPS                          | Val  Loss: 0.0233 | Val  Acc: 0.9933
 Site-MNIST                         | Val  Loss: 0.0796 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.1010 | Val  Acc: 0.7253
 Site-SVHN                          | Val  Loss: 1.9170 | Val  Acc: 0.4200
 Site-MNIST_M                       | Val  Loss: 2.3892 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6788
============ Train epoch 31 ============
 Site-USPS                          | Train Loss: 0.0172 | Train Acc: 0.9975
 Site-MNIST                         | Train Loss: 0.0997 | Train Acc: 0.9697
 Site-SynthDigits                   | Train Loss: 1.1599 | Train Acc: 0.6503
 Site-SVHN                          | Train Loss: 2.0016 | Train Acc: 0.3350
 Site-MNIST_M                       | Train Loss: 1.7933 | Train Acc: 0.3929
Average Train Accuracy: 0.6691
 Site-USPS                          | Val  Loss: 0.0190 | Val  Acc: 0.9933
 Site-MNIST                         | Val  Loss: 0.0938 | Val  Acc: 0.9515
 Site-SynthDigits                   | Val  Loss: 1.0926 | Val  Acc: 0.6923
 Site-SVHN                          | Val  Loss: 1.9355 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 2.3799 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6574
============ Train epoch 32 ============
 Site-USPS                          | Train Loss: 0.0168 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0780 | Train Acc: 0.9742
 Site-SynthDigits                   | Train Loss: 1.1508 | Train Acc: 0.6448
 Site-SVHN                          | Train Loss: 1.9779 | Train Acc: 0.3448
 Site-MNIST_M                       | Train Loss: 1.8070 | Train Acc: 0.4643
Average Train Accuracy: 0.6856
 Site-USPS                          | Val  Loss: 0.0165 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0745 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 1.0740 | Val  Acc: 0.7033
 Site-SVHN                          | Val  Loss: 1.9152 | Val  Acc: 0.3800
 Site-MNIST_M                       | Val  Loss: 2.4079 | Val  Acc: 0.3571
Average Valid Accuracy: 0.6857
============ Train epoch 33 ============
 Site-USPS                          | Train Loss: 0.0154 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0779 | Train Acc: 0.9788
 Site-SynthDigits                   | Train Loss: 1.1358 | Train Acc: 0.6557
 Site-SVHN                          | Train Loss: 2.0125 | Train Acc: 0.3596
 Site-MNIST_M                       | Train Loss: 1.8132 | Train Acc: 0.4286
Average Train Accuracy: 0.6845
 Site-USPS                          | Val  Loss: 0.0158 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0682 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 1.0835 | Val  Acc: 0.7143
 Site-SVHN                          | Val  Loss: 1.8793 | Val  Acc: 0.4600
 Site-MNIST_M                       | Val  Loss: 2.5330 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6967
 Best site-USPS                      | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9879
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.7143
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.4600
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 34 ============
 Site-USPS                          | Train Loss: 0.0148 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0729 | Train Acc: 0.9803
 Site-SynthDigits                   | Train Loss: 1.1372 | Train Acc: 0.6503
 Site-SVHN                          | Train Loss: 1.9230 | Train Acc: 0.3547
 Site-MNIST_M                       | Train Loss: 1.8027 | Train Acc: 0.4554
Average Train Accuracy: 0.6881
 Site-USPS                          | Val  Loss: 0.0150 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0642 | Val  Acc: 0.9818
 Site-SynthDigits                   | Val  Loss: 1.0699 | Val  Acc: 0.7033
 Site-SVHN                          | Val  Loss: 1.8957 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 2.4699 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6742
============ Train epoch 35 ============
 Site-USPS                          | Train Loss: 0.0131 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0640 | Train Acc: 0.9818
 Site-SynthDigits                   | Train Loss: 1.1076 | Train Acc: 0.6639
 Site-SVHN                          | Train Loss: 2.0773 | Train Acc: 0.3448
 Site-MNIST_M                       | Train Loss: 1.8041 | Train Acc: 0.3929
Average Train Accuracy: 0.6767
 Site-USPS                          | Val  Loss: 0.0141 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0623 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 1.0191 | Val  Acc: 0.7473
 Site-SVHN                          | Val  Loss: 1.9184 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 2.4342 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6842
============ Train epoch 36 ============
 Site-USPS                          | Train Loss: 0.0116 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0706 | Train Acc: 0.9773
 Site-SynthDigits                   | Train Loss: 1.0885 | Train Acc: 0.6721
 Site-SVHN                          | Train Loss: 2.0270 | Train Acc: 0.3498
 Site-MNIST_M                       | Train Loss: 1.8423 | Train Acc: 0.4375
Average Train Accuracy: 0.6873
 Site-USPS                          | Val  Loss: 0.0122 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0717 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 1.0049 | Val  Acc: 0.7363
 Site-SVHN                          | Val  Loss: 1.9300 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 2.4042 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6855
============ Train epoch 37 ============
 Site-USPS                          | Train Loss: 0.0102 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0659 | Train Acc: 0.9803
 Site-SynthDigits                   | Train Loss: 1.1234 | Train Acc: 0.6612
 Site-SVHN                          | Train Loss: 2.0687 | Train Acc: 0.3498
 Site-MNIST_M                       | Train Loss: 1.7847 | Train Acc: 0.4286
Average Train Accuracy: 0.6840
 Site-USPS                          | Val  Loss: 0.0115 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0694 | Val  Acc: 0.9758
 Site-SynthDigits                   | Val  Loss: 1.0148 | Val  Acc: 0.7473
 Site-SVHN                          | Val  Loss: 1.8575 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 2.4143 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6817
============ Train epoch 38 ============
 Site-USPS                          | Train Loss: 0.0109 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0624 | Train Acc: 0.9788
 Site-SynthDigits                   | Train Loss: 1.0579 | Train Acc: 0.6776
 Site-SVHN                          | Train Loss: 1.9212 | Train Acc: 0.3350
 Site-MNIST_M                       | Train Loss: 1.7859 | Train Acc: 0.4375
Average Train Accuracy: 0.6858
 Site-USPS                          | Val  Loss: 0.0129 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0619 | Val  Acc: 0.9758
 Site-SynthDigits                   | Val  Loss: 0.9650 | Val  Acc: 0.7692
 Site-SVHN                          | Val  Loss: 1.8968 | Val  Acc: 0.4200
 Site-MNIST_M                       | Val  Loss: 2.3606 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6973
 Best site-USPS                      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9758
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.7692
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.4200
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 39 ============
 Site-USPS                          | Train Loss: 0.0104 | Train Acc: 0.9992
 Site-MNIST                         | Train Loss: 0.0704 | Train Acc: 0.9727
 Site-SynthDigits                   | Train Loss: 1.0784 | Train Acc: 0.6749
 Site-SVHN                          | Train Loss: 2.0839 | Train Acc: 0.3645
 Site-MNIST_M                       | Train Loss: 1.8201 | Train Acc: 0.4375
Average Train Accuracy: 0.6898
 Site-USPS                          | Val  Loss: 0.0139 | Val  Acc: 0.9966
 Site-MNIST                         | Val  Loss: 0.0784 | Val  Acc: 0.9636
 Site-SynthDigits                   | Val  Loss: 1.0236 | Val  Acc: 0.7363
 Site-SVHN                          | Val  Loss: 1.8693 | Val  Acc: 0.4400
 Site-MNIST_M                       | Val  Loss: 2.4742 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6844
============ Train epoch 40 ============
 Site-USPS                          | Train Loss: 0.0100 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0520 | Train Acc: 0.9864
 Site-SynthDigits                   | Train Loss: 1.0798 | Train Acc: 0.6612
 Site-SVHN                          | Train Loss: 2.1245 | Train Acc: 0.3448
 Site-MNIST_M                       | Train Loss: 1.8422 | Train Acc: 0.4643
Average Train Accuracy: 0.6913
 Site-USPS                          | Val  Loss: 0.0095 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0514 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 1.0004 | Val  Acc: 0.7363
 Site-SVHN                          | Val  Loss: 1.8509 | Val  Acc: 0.4200
 Site-MNIST_M                       | Val  Loss: 2.4841 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6872
============ Train epoch 41 ============
 Site-USPS                          | Train Loss: 0.0095 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0631 | Train Acc: 0.9818
 Site-SynthDigits                   | Train Loss: 1.0795 | Train Acc: 0.6612
 Site-SVHN                          | Train Loss: 2.0246 | Train Acc: 0.3596
 Site-MNIST_M                       | Train Loss: 1.8726 | Train Acc: 0.4554
Average Train Accuracy: 0.6916
 Site-USPS                          | Val  Loss: 0.0096 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0598 | Val  Acc: 0.9758
 Site-SynthDigits                   | Val  Loss: 1.0095 | Val  Acc: 0.7143
 Site-SVHN                          | Val  Loss: 1.8306 | Val  Acc: 0.4400
 Site-MNIST_M                       | Val  Loss: 2.6045 | Val  Acc: 0.3571
Average Valid Accuracy: 0.6974
 Best site-USPS                      | Epoch:41 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9758
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.7143
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.4400
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 42 ============
 Site-USPS                          | Train Loss: 0.0081 | Train Acc: 0.9992
 Site-MNIST                         | Train Loss: 0.0618 | Train Acc: 0.9773
 Site-SynthDigits                   | Train Loss: 1.0636 | Train Acc: 0.6831
 Site-SVHN                          | Train Loss: 1.9247 | Train Acc: 0.3645
 Site-MNIST_M                       | Train Loss: 1.8516 | Train Acc: 0.4286
Average Train Accuracy: 0.6905
 Site-USPS                          | Val  Loss: 0.0076 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0726 | Val  Acc: 0.9697
 Site-SynthDigits                   | Val  Loss: 0.9992 | Val  Acc: 0.7473
 Site-SVHN                          | Val  Loss: 1.8520 | Val  Acc: 0.4600
 Site-MNIST_M                       | Val  Loss: 2.5246 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6925
============ Train epoch 43 ============
 Site-USPS                          | Train Loss: 0.0081 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0504 | Train Acc: 0.9864
 Site-SynthDigits                   | Train Loss: 1.0505 | Train Acc: 0.6940
 Site-SVHN                          | Train Loss: 2.0395 | Train Acc: 0.3596
 Site-MNIST_M                       | Train Loss: 1.8788 | Train Acc: 0.4286
Average Train Accuracy: 0.6937
 Site-USPS                          | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0451 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 0.9967 | Val  Acc: 0.7692
 Site-SVHN                          | Val  Loss: 1.8821 | Val  Acc: 0.4400
 Site-MNIST_M                       | Val  Loss: 2.4399 | Val  Acc: 0.3214
Average Valid Accuracy: 0.7037
 Best site-USPS                      | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9879
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.7692
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.4400
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 44 ============
 Site-USPS                          | Train Loss: 0.0056 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0546 | Train Acc: 0.9833
 Site-SynthDigits                   | Train Loss: 1.0491 | Train Acc: 0.6995
 Site-SVHN                          | Train Loss: 1.9603 | Train Acc: 0.3695
 Site-MNIST_M                       | Train Loss: 1.9027 | Train Acc: 0.4375
Average Train Accuracy: 0.6979
 Site-USPS                          | Val  Loss: 0.0052 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0520 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 0.9710 | Val  Acc: 0.7473
 Site-SVHN                          | Val  Loss: 1.8450 | Val  Acc: 0.4400
 Site-MNIST_M                       | Val  Loss: 2.4885 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6993
============ Train epoch 45 ============
 Site-USPS                          | Train Loss: 0.0057 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0442 | Train Acc: 0.9879
 Site-SynthDigits                   | Train Loss: 1.0561 | Train Acc: 0.6885
 Site-SVHN                          | Train Loss: 2.0350 | Train Acc: 0.3547
 Site-MNIST_M                       | Train Loss: 1.8817 | Train Acc: 0.4286
Average Train Accuracy: 0.6919
 Site-USPS                          | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0437 | Val  Acc: 0.9939
 Site-SynthDigits                   | Val  Loss: 0.9851 | Val  Acc: 0.7363
 Site-SVHN                          | Val  Loss: 1.8624 | Val  Acc: 0.4400
 Site-MNIST_M                       | Val  Loss: 2.5092 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6912
============ Train epoch 46 ============
 Site-USPS                          | Train Loss: 0.0072 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0471 | Train Acc: 0.9864
 Site-SynthDigits                   | Train Loss: 1.0075 | Train Acc: 0.6913
 Site-SVHN                          | Train Loss: 2.0212 | Train Acc: 0.3645
 Site-MNIST_M                       | Train Loss: 1.8903 | Train Acc: 0.4375
Average Train Accuracy: 0.6959
 Site-USPS                          | Val  Loss: 0.0068 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0475 | Val  Acc: 0.9758
 Site-SynthDigits                   | Val  Loss: 0.9709 | Val  Acc: 0.7582
 Site-SVHN                          | Val  Loss: 1.8771 | Val  Acc: 0.4200
 Site-MNIST_M                       | Val  Loss: 2.4849 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6951
============ Train epoch 47 ============
 Site-USPS                          | Train Loss: 0.0053 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0421 | Train Acc: 0.9894
 Site-SynthDigits                   | Train Loss: 1.0269 | Train Acc: 0.6858
 Site-SVHN                          | Train Loss: 1.9967 | Train Acc: 0.3793
 Site-MNIST_M                       | Train Loss: 1.8391 | Train Acc: 0.4464
Average Train Accuracy: 0.7002
 Site-USPS                          | Val  Loss: 0.0053 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0406 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.9647 | Val  Acc: 0.7582
 Site-SVHN                          | Val  Loss: 1.8246 | Val  Acc: 0.4600
 Site-MNIST_M                       | Val  Loss: 2.5658 | Val  Acc: 0.3214
Average Valid Accuracy: 0.7079
 Best site-USPS                      | Epoch:47 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:47 | Val Acc: 1.0000
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.7582
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.4600
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.3214
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_distinct/fedsam...
============ Train epoch 48 ============
 Site-USPS                          | Train Loss: 0.0050 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0436 | Train Acc: 0.9848
 Site-SynthDigits                   | Train Loss: 0.9958 | Train Acc: 0.6913
 Site-SVHN                          | Train Loss: 1.9665 | Train Acc: 0.3744
 Site-MNIST_M                       | Train Loss: 1.8935 | Train Acc: 0.4464
Average Train Accuracy: 0.6994
 Site-USPS                          | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0458 | Val  Acc: 0.9879
 Site-SynthDigits                   | Val  Loss: 0.9546 | Val  Acc: 0.7253
 Site-SVHN                          | Val  Loss: 1.8229 | Val  Acc: 0.4600
 Site-MNIST_M                       | Val  Loss: 2.6151 | Val  Acc: 0.3214
Average Valid Accuracy: 0.6989
============ Train epoch 49 ============
 Site-USPS                          | Train Loss: 0.0039 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0391 | Train Acc: 0.9924
 Site-SynthDigits                   | Train Loss: 1.0090 | Train Acc: 0.7104
 Site-SVHN                          | Train Loss: 1.9446 | Train Acc: 0.3695
 Site-MNIST_M                       | Train Loss: 1.8581 | Train Acc: 0.4196
Average Train Accuracy: 0.6984
 Site-USPS                          | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0383 | Val  Acc: 1.0000
 Site-SynthDigits                   | Val  Loss: 0.9513 | Val  Acc: 0.7802
 Site-SVHN                          | Val  Loss: 1.7998 | Val  Acc: 0.4600
 Site-MNIST_M                       | Val  Loss: 2.5824 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7052
===2023-07-02 22:00:21===
===2023-07-02 22:00:23===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1189,660,366,203,112,
client_nums=[1,1,1,1,1,]
len_dataset=[1487,826,458,254,141,]
domain number = 5
Loading snapshots...
 Test site-USPS                      | Epoch:47 | Test Acc: 0.9634
 Test site-MNIST                     | Epoch:47 | Test Acc: 0.9140
 Test site-SynthDigits               | Epoch:47 | Test Acc: 0.5049
 Test site-SVHN                      | Epoch:47 | Test Acc: 0.2478
 Test site-MNIST_M                   | Epoch:47 | Test Acc: 0.2906
USPS: 0.9634, MNIST: 0.9140, SynthDigits: 0.5049, SVHN: 0.2478, MNIST_M: 0.2906, 
Average Test Accuracy(group): 0.5841, Average Test Accuracy(individual): 0.5841,
domain std=0.3027, cluster std=-1.0000, individual std=0.3027, 
