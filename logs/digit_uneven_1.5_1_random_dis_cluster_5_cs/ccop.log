===2023-06-17 01:47:25===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[90,135,202,304,456,166,250,375,211,316,140,211,234,
client_nums=[5,3,2,2,1,]
len_dataset=[1487,991,660,440,293,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (1) | Train Loss: 2.0372 | Train Acc: 0.4556
 Site-MNIST                     (1) | Train Loss: 2.0327 | Train Acc: 0.4593
 Site-MNIST                     (1) | Train Loss: 1.9401 | Train Acc: 0.5099
 Site-MNIST                     (1) | Train Loss: 1.9867 | Train Acc: 0.4507
 Site-MNIST                     (1) | Train Loss: 2.0583 | Train Acc: 0.3925
 Site-USPS                      (0) | Train Loss: 1.9810 | Train Acc: 0.4277
 Site-USPS                      (0) | Train Loss: 1.9560 | Train Acc: 0.5680
 Site-USPS                      (0) | Train Loss: 1.9789 | Train Acc: 0.4533
 Site-SynthDigits               (3) | Train Loss: 2.2167 | Train Acc: 0.1848
 Site-SynthDigits               (3) | Train Loss: 2.1965 | Train Acc: 0.2025
 Site-MNIST-M                   (2) | Train Loss: 2.2998 | Train Acc: 0.1500
 Site-MNIST-M                   (2) | Train Loss: 2.2481 | Train Acc: 0.1517
 Site-SVHN                      (4) | Train Loss: 2.2856 | Train Acc: 0.1282
Average Train Accuracy: 0.3488
 Site-MNIST                     (1) | Val  Loss: 1.8381 | Val  Acc: 0.5000
 Site-MNIST                     (1) | Val  Loss: 1.8490 | Val  Acc: 0.5152
 Site-MNIST                     (1) | Val  Loss: 1.9410 | Val  Acc: 0.4600
 Site-MNIST                     (1) | Val  Loss: 1.8793 | Val  Acc: 0.5263
 Site-MNIST                     (1) | Val  Loss: 1.9486 | Val  Acc: 0.4474
 Site-USPS                      (0) | Val  Loss: 1.9191 | Val  Acc: 0.6829
 Site-USPS                      (0) | Val  Loss: 1.9601 | Val  Acc: 0.6290
 Site-USPS                      (0) | Val  Loss: 2.0039 | Val  Acc: 0.4194
 Site-SynthDigits               (3) | Val  Loss: 2.2574 | Val  Acc: 0.1154
 Site-SynthDigits               (3) | Val  Loss: 2.2015 | Val  Acc: 0.2051
 Site-MNIST-M                   (2) | Val  Loss: 2.2466 | Val  Acc: 0.2353
 Site-MNIST-M                   (2) | Val  Loss: 2.2619 | Val  Acc: 0.1154
 Site-SVHN                      (4) | Val  Loss: 2.2833 | Val  Acc: 0.1034
Average Valid Accuracy: 0.3811
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.5000
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.5152
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.4600
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.5263
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.4474
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.6829
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.6290
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.4194
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.1154
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2051
 Best site-MNIST-M                  (2)  | Epoch:0 | Val Acc: 0.2353
 Best site-MNIST-M                  (2)  | Epoch:0 | Val Acc: 0.1154
 Best site-SVHN                     (4)  | Epoch:0 | Val Acc: 0.1034
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 5, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (1) | Train Loss: 1.7887 | Train Acc: 0.5556
 Site-MNIST                     (1) | Train Loss: 1.6657 | Train Acc: 0.5630
 Site-MNIST                     (1) | Train Loss: 1.7153 | Train Acc: 0.6238
 Site-MNIST                     (1) | Train Loss: 1.7830 | Train Acc: 0.5592
 Site-MNIST                     (1) | Train Loss: 1.8475 | Train Acc: 0.4825
 Site-USPS                      (2) | Train Loss: 1.7935 | Train Acc: 0.5120
 Site-USPS                      (2) | Train Loss: 1.7634 | Train Acc: 0.5880
 Site-USPS                      (2) | Train Loss: 1.7880 | Train Acc: 0.5573
 Site-SynthDigits               (3) | Train Loss: 2.1405 | Train Acc: 0.2512
 Site-SynthDigits               (3) | Train Loss: 2.0900 | Train Acc: 0.3133
 Site-MNIST-M                   (4) | Train Loss: 2.2094 | Train Acc: 0.1929
 Site-MNIST-M                   (4) | Train Loss: 2.1702 | Train Acc: 0.2844
 Site-SVHN                      (0) | Train Loss: 2.2196 | Train Acc: 0.1709
Average Train Accuracy: 0.4349
 Site-MNIST                     (1) | Val  Loss: 1.5867 | Val  Acc: 0.7727
 Site-MNIST                     (1) | Val  Loss: 1.6128 | Val  Acc: 0.6667
 Site-MNIST                     (1) | Val  Loss: 1.7254 | Val  Acc: 0.6000
 Site-MNIST                     (1) | Val  Loss: 1.6592 | Val  Acc: 0.6184
 Site-MNIST                     (1) | Val  Loss: 1.7426 | Val  Acc: 0.5702
 Site-USPS                      (2) | Val  Loss: 1.7284 | Val  Acc: 0.7073
 Site-USPS                      (2) | Val  Loss: 1.7804 | Val  Acc: 0.5968
 Site-USPS                      (2) | Val  Loss: 1.8289 | Val  Acc: 0.4839
 Site-SynthDigits               (3) | Val  Loss: 2.1785 | Val  Acc: 0.2692
 Site-SynthDigits               (3) | Val  Loss: 2.1076 | Val  Acc: 0.3077
 Site-MNIST-M                   (4) | Val  Loss: 2.1470 | Val  Acc: 0.2647
 Site-MNIST-M                   (4) | Val  Loss: 2.2061 | Val  Acc: 0.1154
 Site-SVHN                      (0) | Val  Loss: 2.2180 | Val  Acc: 0.1897
Average Valid Accuracy: 0.4740
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.7727
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.6667
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.6000
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.6184
 Best site-MNIST                    (1)  | Epoch:1 | Val Acc: 0.5702
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.7073
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.5968
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.4839
 Best site-SynthDigits              (3)  | Epoch:1 | Val Acc: 0.2692
 Best site-SynthDigits              (3)  | Epoch:1 | Val Acc: 0.3077
 Best site-MNIST-M                  (4)  | Epoch:1 | Val Acc: 0.2647
 Best site-MNIST-M                  (4)  | Epoch:1 | Val Acc: 0.1154
 Best site-SVHN                     (0)  | Epoch:1 | Val Acc: 0.1897
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 5, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (1) | Train Loss: 1.6036 | Train Acc: 0.6222
 Site-MNIST                     (1) | Train Loss: 1.5092 | Train Acc: 0.6296
 Site-MNIST                     (1) | Train Loss: 1.4774 | Train Acc: 0.7376
 Site-MNIST                     (1) | Train Loss: 1.5812 | Train Acc: 0.6447
 Site-MNIST                     (1) | Train Loss: 1.6509 | Train Acc: 0.5833
 Site-USPS                      (2) | Train Loss: 1.6127 | Train Acc: 0.6506
 Site-USPS                      (2) | Train Loss: 1.5572 | Train Acc: 0.6560
 Site-USPS                      (2) | Train Loss: 1.5891 | Train Acc: 0.7013
 Site-SynthDigits               (3) | Train Loss: 2.0288 | Train Acc: 0.2844
 Site-SynthDigits               (3) | Train Loss: 1.9822 | Train Acc: 0.3354
 Site-MNIST-M                   (4) | Train Loss: 2.1693 | Train Acc: 0.2357
 Site-MNIST-M                   (4) | Train Loss: 2.0933 | Train Acc: 0.3128
 Site-SVHN                      (0) | Train Loss: 2.1633 | Train Acc: 0.1966
Average Train Accuracy: 0.5070
 Site-MNIST                     (1) | Val  Loss: 1.3785 | Val  Acc: 0.8636
 Site-MNIST                     (1) | Val  Loss: 1.4071 | Val  Acc: 0.7576
 Site-MNIST                     (1) | Val  Loss: 1.5175 | Val  Acc: 0.6800
 Site-MNIST                     (1) | Val  Loss: 1.4534 | Val  Acc: 0.7237
 Site-MNIST                     (1) | Val  Loss: 1.5570 | Val  Acc: 0.6228
 Site-USPS                      (2) | Val  Loss: 1.5174 | Val  Acc: 0.7317
 Site-USPS                      (2) | Val  Loss: 1.5793 | Val  Acc: 0.6935
 Site-USPS                      (2) | Val  Loss: 1.6290 | Val  Acc: 0.6022
 Site-SynthDigits               (3) | Val  Loss: 2.0891 | Val  Acc: 0.3077
 Site-SynthDigits               (3) | Val  Loss: 1.9983 | Val  Acc: 0.3462
 Site-MNIST-M                   (4) | Val  Loss: 2.0563 | Val  Acc: 0.2941
 Site-MNIST-M                   (4) | Val  Loss: 2.1615 | Val  Acc: 0.1731
 Site-SVHN                      (0) | Val  Loss: 2.1689 | Val  Acc: 0.1724
Average Valid Accuracy: 0.5360
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.8636
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.7576
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.6800
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.7237
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.6228
 Best site-USPS                     (2)  | Epoch:2 | Val Acc: 0.7317
 Best site-USPS                     (2)  | Epoch:2 | Val Acc: 0.6935
 Best site-USPS                     (2)  | Epoch:2 | Val Acc: 0.6022
 Best site-SynthDigits              (3)  | Epoch:2 | Val Acc: 0.3077
 Best site-SynthDigits              (3)  | Epoch:2 | Val Acc: 0.3462
 Best site-MNIST-M                  (4)  | Epoch:2 | Val Acc: 0.2941
 Best site-MNIST-M                  (4)  | Epoch:2 | Val Acc: 0.1731
 Best site-SVHN                     (0)  | Epoch:2 | Val Acc: 0.1724
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1...
============ Train epoch 3 ============
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (0) | Train Loss: 1.3336 | Train Acc: 0.7222
 Site-MNIST                     (0) | Train Loss: 1.3317 | Train Acc: 0.7704
 Site-MNIST                     (0) | Train Loss: 1.2964 | Train Acc: 0.8366
 Site-MNIST                     (0) | Train Loss: 1.3902 | Train Acc: 0.7138
 Site-MNIST                     (0) | Train Loss: 1.4302 | Train Acc: 0.6776
 Site-USPS                      (1) | Train Loss: 1.3918 | Train Acc: 0.6988
 Site-USPS                      (1) | Train Loss: 1.3557 | Train Acc: 0.7280
 Site-USPS                      (1) | Train Loss: 1.3762 | Train Acc: 0.7360
 Site-SynthDigits               (3) | Train Loss: 1.9163 | Train Acc: 0.3033
 Site-SynthDigits               (3) | Train Loss: 1.8652 | Train Acc: 0.3544
 Site-MNIST-M                   (2) | Train Loss: 2.0781 | Train Acc: 0.2643
 Site-MNIST-M                   (2) | Train Loss: 1.9673 | Train Acc: 0.3507
 Site-SVHN                      (4) | Train Loss: 2.0972 | Train Acc: 0.2436
Average Train Accuracy: 0.5692
 Site-MNIST                     (0) | Val  Loss: 1.1871 | Val  Acc: 0.9091
 Site-MNIST                     (0) | Val  Loss: 1.2105 | Val  Acc: 0.8788
 Site-MNIST                     (0) | Val  Loss: 1.3048 | Val  Acc: 0.8200
 Site-MNIST                     (0) | Val  Loss: 1.2500 | Val  Acc: 0.8026
 Site-MNIST                     (0) | Val  Loss: 1.3734 | Val  Acc: 0.7632
 Site-USPS                      (1) | Val  Loss: 1.3103 | Val  Acc: 0.7805
 Site-USPS                      (1) | Val  Loss: 1.3710 | Val  Acc: 0.7419
 Site-USPS                      (1) | Val  Loss: 1.4087 | Val  Acc: 0.6989
 Site-SynthDigits               (3) | Val  Loss: 1.9578 | Val  Acc: 0.3077
 Site-SynthDigits               (3) | Val  Loss: 1.8589 | Val  Acc: 0.3462
 Site-MNIST-M                   (2) | Val  Loss: 1.9608 | Val  Acc: 0.3529
 Site-MNIST-M                   (2) | Val  Loss: 2.0838 | Val  Acc: 0.2308
 Site-SVHN                      (4) | Val  Loss: 2.1044 | Val  Acc: 0.1724
Average Valid Accuracy: 0.6004
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.9091
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8788
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8200
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8026
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.7632
 Best site-USPS                     (1)  | Epoch:3 | Val Acc: 0.7805
 Best site-USPS                     (1)  | Epoch:3 | Val Acc: 0.7419
 Best site-USPS                     (1)  | Epoch:3 | Val Acc: 0.6989
 Best site-SynthDigits              (3)  | Epoch:3 | Val Acc: 0.3077
 Best site-SynthDigits              (3)  | Epoch:3 | Val Acc: 0.3462
 Best site-MNIST-M                  (2)  | Epoch:3 | Val Acc: 0.3529
 Best site-MNIST-M                  (2)  | Epoch:3 | Val Acc: 0.2308
 Best site-SVHN                     (4)  | Epoch:3 | Val Acc: 0.1724
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1...
============ Train epoch 4 ============
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (1) | Train Loss: 1.2290 | Train Acc: 0.7222
 Site-MNIST                     (1) | Train Loss: 1.2523 | Train Acc: 0.7852
 Site-MNIST                     (1) | Train Loss: 1.2232 | Train Acc: 0.8614
 Site-MNIST                     (1) | Train Loss: 1.2695 | Train Acc: 0.7467
 Site-MNIST                     (1) | Train Loss: 1.3156 | Train Acc: 0.7171
 Site-USPS                      (0) | Train Loss: 1.2181 | Train Acc: 0.7590
 Site-USPS                      (0) | Train Loss: 1.2117 | Train Acc: 0.7520
 Site-USPS                      (0) | Train Loss: 1.2209 | Train Acc: 0.7440
 Site-SynthDigits               (3) | Train Loss: 1.7914 | Train Acc: 0.3839
 Site-SynthDigits               (3) | Train Loss: 1.7541 | Train Acc: 0.4019
 Site-MNIST-M                   (2) | Train Loss: 1.9667 | Train Acc: 0.2786
 Site-MNIST-M                   (2) | Train Loss: 1.8519 | Train Acc: 0.3981
 Site-SVHN                      (4) | Train Loss: 2.0439 | Train Acc: 0.2650
Average Train Accuracy: 0.6012
 Site-MNIST                     (1) | Val  Loss: 1.0566 | Val  Acc: 0.9091
 Site-MNIST                     (1) | Val  Loss: 1.0588 | Val  Acc: 0.9394
 Site-MNIST                     (1) | Val  Loss: 1.1601 | Val  Acc: 0.8600
 Site-MNIST                     (1) | Val  Loss: 1.1214 | Val  Acc: 0.8421
 Site-MNIST                     (1) | Val  Loss: 1.2448 | Val  Acc: 0.7895
 Site-USPS                      (0) | Val  Loss: 1.1596 | Val  Acc: 0.7805
 Site-USPS                      (0) | Val  Loss: 1.2237 | Val  Acc: 0.7581
 Site-USPS                      (0) | Val  Loss: 1.2437 | Val  Acc: 0.7419
 Site-SynthDigits               (3) | Val  Loss: 1.8248 | Val  Acc: 0.3846
 Site-SynthDigits               (3) | Val  Loss: 1.7378 | Val  Acc: 0.3974
 Site-MNIST-M                   (2) | Val  Loss: 1.8563 | Val  Acc: 0.4118
 Site-MNIST-M                   (2) | Val  Loss: 2.0212 | Val  Acc: 0.2308
 Site-SVHN                      (4) | Val  Loss: 2.0259 | Val  Acc: 0.2586
Average Valid Accuracy: 0.6388
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.9091
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.9394
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.8600
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.8421
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.7895
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7805
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7581
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7419
 Best site-SynthDigits              (3)  | Epoch:4 | Val Acc: 0.3846
 Best site-SynthDigits              (3)  | Epoch:4 | Val Acc: 0.3974
 Best site-MNIST-M                  (2)  | Epoch:4 | Val Acc: 0.4118
 Best site-MNIST-M                  (2)  | Epoch:4 | Val Acc: 0.2308
 Best site-SVHN                     (4)  | Epoch:4 | Val Acc: 0.2586
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1...
============ Train epoch 5 ============
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (0) | Train Loss: 1.1375 | Train Acc: 0.7222
 Site-MNIST                     (0) | Train Loss: 1.1024 | Train Acc: 0.7926
 Site-MNIST                     (0) | Train Loss: 1.0064 | Train Acc: 0.8614
 Site-MNIST                     (0) | Train Loss: 1.1754 | Train Acc: 0.7730
 Site-MNIST                     (0) | Train Loss: 1.1927 | Train Acc: 0.7434
 Site-USPS                      (1) | Train Loss: 1.1145 | Train Acc: 0.7892
 Site-USPS                      (1) | Train Loss: 1.1290 | Train Acc: 0.7600
 Site-USPS                      (1) | Train Loss: 1.1498 | Train Acc: 0.7627
 Site-SynthDigits               (3) | Train Loss: 1.7489 | Train Acc: 0.4550
 Site-SynthDigits               (3) | Train Loss: 1.6465 | Train Acc: 0.4715
 Site-MNIST-M                   (2) | Train Loss: 1.9470 | Train Acc: 0.3286
 Site-MNIST-M                   (2) | Train Loss: 1.7823 | Train Acc: 0.4360
 Site-SVHN                      (4) | Train Loss: 1.9888 | Train Acc: 0.3205
Average Train Accuracy: 0.6320
 Site-MNIST                     (0) | Val  Loss: 0.9555 | Val  Acc: 0.9091
 Site-MNIST                     (0) | Val  Loss: 0.9578 | Val  Acc: 0.9091
 Site-MNIST                     (0) | Val  Loss: 1.0580 | Val  Acc: 0.8800
 Site-MNIST                     (0) | Val  Loss: 1.0301 | Val  Acc: 0.8158
 Site-MNIST                     (0) | Val  Loss: 1.1534 | Val  Acc: 0.7807
 Site-USPS                      (1) | Val  Loss: 1.0815 | Val  Acc: 0.8049
 Site-USPS                      (1) | Val  Loss: 1.1442 | Val  Acc: 0.7742
 Site-USPS                      (1) | Val  Loss: 1.1513 | Val  Acc: 0.7957
 Site-SynthDigits               (3) | Val  Loss: 1.7097 | Val  Acc: 0.4231
 Site-SynthDigits               (3) | Val  Loss: 1.6314 | Val  Acc: 0.4744
 Site-MNIST-M                   (2) | Val  Loss: 1.7917 | Val  Acc: 0.4118
 Site-MNIST-M                   (2) | Val  Loss: 1.9687 | Val  Acc: 0.2500
 Site-SVHN                      (4) | Val  Loss: 1.9434 | Val  Acc: 0.3103
Average Valid Accuracy: 0.6568
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.9091
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.9091
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8800
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8158
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.7807
 Best site-USPS                     (1)  | Epoch:5 | Val Acc: 0.8049
 Best site-USPS                     (1)  | Epoch:5 | Val Acc: 0.7742
 Best site-USPS                     (1)  | Epoch:5 | Val Acc: 0.7957
 Best site-SynthDigits              (3)  | Epoch:5 | Val Acc: 0.4231
 Best site-SynthDigits              (3)  | Epoch:5 | Val Acc: 0.4744
 Best site-MNIST-M                  (2)  | Epoch:5 | Val Acc: 0.4118
 Best site-MNIST-M                  (2)  | Epoch:5 | Val Acc: 0.2500
 Best site-SVHN                     (4)  | Epoch:5 | Val Acc: 0.3103
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1...
============ Train epoch 6 ============
cnt=[5, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (0) | Train Loss: 1.0034 | Train Acc: 0.7444
 Site-MNIST                     (0) | Train Loss: 1.0316 | Train Acc: 0.8074
 Site-MNIST                     (0) | Train Loss: 0.9980 | Train Acc: 0.8762
 Site-MNIST                     (0) | Train Loss: 1.0783 | Train Acc: 0.8158
 Site-MNIST                     (0) | Train Loss: 1.1374 | Train Acc: 0.7741
 Site-USPS                      (3) | Train Loss: 1.0220 | Train Acc: 0.8012
 Site-USPS                      (3) | Train Loss: 1.0300 | Train Acc: 0.7960
 Site-USPS                      (3) | Train Loss: 1.0390 | Train Acc: 0.8027
 Site-SynthDigits               (1) | Train Loss: 1.5914 | Train Acc: 0.4597
 Site-SynthDigits               (1) | Train Loss: 1.5635 | Train Acc: 0.4968
 Site-MNIST-M                   (2) | Train Loss: 1.9244 | Train Acc: 0.3500
 Site-MNIST-M                   (2) | Train Loss: 1.7339 | Train Acc: 0.4739
 Site-SVHN                      (4) | Train Loss: 1.9318 | Train Acc: 0.3333
Average Train Accuracy: 0.6563
 Site-MNIST                     (0) | Val  Loss: 0.8661 | Val  Acc: 0.9091
 Site-MNIST                     (0) | Val  Loss: 0.8695 | Val  Acc: 0.9091
 Site-MNIST                     (0) | Val  Loss: 0.9662 | Val  Acc: 0.8800
 Site-MNIST                     (0) | Val  Loss: 0.9355 | Val  Acc: 0.8289
 Site-MNIST                     (0) | Val  Loss: 1.0625 | Val  Acc: 0.8070
 Site-USPS                      (3) | Val  Loss: 0.9893 | Val  Acc: 0.8293
 Site-USPS                      (3) | Val  Loss: 1.0421 | Val  Acc: 0.7903
 Site-USPS                      (3) | Val  Loss: 1.0474 | Val  Acc: 0.7849
 Site-SynthDigits               (1) | Val  Loss: 1.6435 | Val  Acc: 0.4038
 Site-SynthDigits               (1) | Val  Loss: 1.5637 | Val  Acc: 0.4615
 Site-MNIST-M                   (2) | Val  Loss: 1.7272 | Val  Acc: 0.5588
 Site-MNIST-M                   (2) | Val  Loss: 1.8996 | Val  Acc: 0.4038
 Site-SVHN                      (4) | Val  Loss: 1.8954 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6842
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.9091
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.9091
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8800
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8289
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8070
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.8293
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.7903
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.7849
 Best site-SynthDigits              (1)  | Epoch:6 | Val Acc: 0.4038
 Best site-SynthDigits              (1)  | Epoch:6 | Val Acc: 0.4615
 Best site-MNIST-M                  (2)  | Epoch:6 | Val Acc: 0.5588
 Best site-MNIST-M                  (2)  | Epoch:6 | Val Acc: 0.4038
 Best site-SVHN                     (4)  | Epoch:6 | Val Acc: 0.3276
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1...
============ Train epoch 7 ============
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (0) | Train Loss: 0.9832 | Train Acc: 0.7778
 Site-MNIST                     (0) | Train Loss: 0.9513 | Train Acc: 0.8074
 Site-MNIST                     (0) | Train Loss: 0.8612 | Train Acc: 0.8812
 Site-MNIST                     (0) | Train Loss: 1.0133 | Train Acc: 0.8059
 Site-MNIST                     (0) | Train Loss: 1.0909 | Train Acc: 0.7829
 Site-USPS                      (1) | Train Loss: 0.9392 | Train Acc: 0.8434
 Site-USPS                      (1) | Train Loss: 0.9538 | Train Acc: 0.8080
 Site-USPS                      (1) | Train Loss: 0.9513 | Train Acc: 0.8213
 Site-SynthDigits               (3) | Train Loss: 1.5752 | Train Acc: 0.4882
 Site-SynthDigits               (3) | Train Loss: 1.4926 | Train Acc: 0.5443
 Site-MNIST-M                   (2) | Train Loss: 1.7599 | Train Acc: 0.3429
 Site-MNIST-M                   (2) | Train Loss: 1.6365 | Train Acc: 0.4834
 Site-SVHN                      (4) | Train Loss: 1.9079 | Train Acc: 0.3419
Average Train Accuracy: 0.6714
 Site-MNIST                     (0) | Val  Loss: 0.8089 | Val  Acc: 0.9091
 Site-MNIST                     (0) | Val  Loss: 0.7888 | Val  Acc: 0.9394
 Site-MNIST                     (0) | Val  Loss: 0.8835 | Val  Acc: 0.9200
 Site-MNIST                     (0) | Val  Loss: 0.8786 | Val  Acc: 0.8289
 Site-MNIST                     (0) | Val  Loss: 1.0021 | Val  Acc: 0.8070
 Site-USPS                      (1) | Val  Loss: 0.9109 | Val  Acc: 0.8537
 Site-USPS                      (1) | Val  Loss: 0.9579 | Val  Acc: 0.8065
 Site-USPS                      (1) | Val  Loss: 0.9563 | Val  Acc: 0.8387
 Site-SynthDigits               (3) | Val  Loss: 1.5707 | Val  Acc: 0.4423
 Site-SynthDigits               (3) | Val  Loss: 1.4866 | Val  Acc: 0.5000
 Site-MNIST-M                   (2) | Val  Loss: 1.6697 | Val  Acc: 0.5294
 Site-MNIST-M                   (2) | Val  Loss: 1.8488 | Val  Acc: 0.4231
 Site-SVHN                      (4) | Val  Loss: 1.8505 | Val  Acc: 0.3276
Average Valid Accuracy: 0.7020
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.9091
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.9394
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.9200
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8289
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8070
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.8537
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.8065
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.8387
 Best site-SynthDigits              (3)  | Epoch:7 | Val Acc: 0.4423
 Best site-SynthDigits              (3)  | Epoch:7 | Val Acc: 0.5000
 Best site-MNIST-M                  (2)  | Epoch:7 | Val Acc: 0.5294
 Best site-MNIST-M                  (2)  | Epoch:7 | Val Acc: 0.4231
 Best site-SVHN                     (4)  | Epoch:7 | Val Acc: 0.3276
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1...
============ Train epoch 8 ============
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (0) | Train Loss: 0.9247 | Train Acc: 0.7778
 Site-MNIST                     (0) | Train Loss: 0.9517 | Train Acc: 0.8296
 Site-MNIST                     (0) | Train Loss: 0.7835 | Train Acc: 0.8812
 Site-MNIST                     (0) | Train Loss: 0.9496 | Train Acc: 0.8092
 Site-MNIST                     (0) | Train Loss: 0.9993 | Train Acc: 0.7917
 Site-USPS                      (1) | Train Loss: 0.8499 | Train Acc: 0.8554
 Site-USPS                      (1) | Train Loss: 0.9022 | Train Acc: 0.8120
 Site-USPS                      (1) | Train Loss: 0.8970 | Train Acc: 0.8187
 Site-SynthDigits               (3) | Train Loss: 1.5507 | Train Acc: 0.5118
 Site-SynthDigits               (3) | Train Loss: 1.4174 | Train Acc: 0.5538
 Site-MNIST-M                   (2) | Train Loss: 1.8268 | Train Acc: 0.3857
 Site-MNIST-M                   (2) | Train Loss: 1.5488 | Train Acc: 0.5118
 Site-SVHN                      (4) | Train Loss: 1.8596 | Train Acc: 0.3889
Average Train Accuracy: 0.6867
 Site-MNIST                     (0) | Val  Loss: 0.7454 | Val  Acc: 0.9091
 Site-MNIST                     (0) | Val  Loss: 0.7307 | Val  Acc: 0.9394
 Site-MNIST                     (0) | Val  Loss: 0.8297 | Val  Acc: 0.9200
 Site-MNIST                     (0) | Val  Loss: 0.8223 | Val  Acc: 0.8421
 Site-MNIST                     (0) | Val  Loss: 0.9417 | Val  Acc: 0.8333
 Site-USPS                      (1) | Val  Loss: 0.8641 | Val  Acc: 0.8293
 Site-USPS                      (1) | Val  Loss: 0.9094 | Val  Acc: 0.7903
 Site-USPS                      (1) | Val  Loss: 0.8952 | Val  Acc: 0.8495
 Site-SynthDigits               (3) | Val  Loss: 1.5088 | Val  Acc: 0.4615
 Site-SynthDigits               (3) | Val  Loss: 1.4431 | Val  Acc: 0.5256
 Site-MNIST-M                   (2) | Val  Loss: 1.6048 | Val  Acc: 0.5882
 Site-MNIST-M                   (2) | Val  Loss: 1.7789 | Val  Acc: 0.4615
 Site-SVHN                      (4) | Val  Loss: 1.7951 | Val  Acc: 0.3966
Average Valid Accuracy: 0.7190
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.9091
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.9394
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.9200
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8421
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8333
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.8293
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.7903
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.8495
 Best site-SynthDigits              (3)  | Epoch:8 | Val Acc: 0.4615
 Best site-SynthDigits              (3)  | Epoch:8 | Val Acc: 0.5256
 Best site-MNIST-M                  (2)  | Epoch:8 | Val Acc: 0.5882
 Best site-MNIST-M                  (2)  | Epoch:8 | Val Acc: 0.4615
 Best site-SVHN                     (4)  | Epoch:8 | Val Acc: 0.3966
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1...
============ Train epoch 9 ============
cnt=[5, 1, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (0) | Train Loss: 0.7696 | Train Acc: 0.8000
 Site-MNIST                     (0) | Train Loss: 0.7687 | Train Acc: 0.8593
 Site-MNIST                     (0) | Train Loss: 0.7905 | Train Acc: 0.8861
 Site-MNIST                     (0) | Train Loss: 0.8925 | Train Acc: 0.8322
 Site-MNIST                     (0) | Train Loss: 0.9399 | Train Acc: 0.7982
 Site-USPS                      (1) | Train Loss: 0.8414 | Train Acc: 0.8855
 Site-USPS                      (3) | Train Loss: 0.8674 | Train Acc: 0.8200
 Site-USPS                      (3) | Train Loss: 0.8587 | Train Acc: 0.8240
 Site-SynthDigits               (4) | Train Loss: 1.4158 | Train Acc: 0.5308
 Site-SynthDigits               (4) | Train Loss: 1.3461 | Train Acc: 0.6139
 Site-MNIST-M                   (2) | Train Loss: 1.6617 | Train Acc: 0.4286
 Site-MNIST-M                   (2) | Train Loss: 1.5100 | Train Acc: 0.5261
 Site-SVHN                      (2) | Train Loss: 1.8012 | Train Acc: 0.4316
Average Train Accuracy: 0.7105
 Site-MNIST                     (0) | Val  Loss: 0.7181 | Val  Acc: 0.9091
 Site-MNIST                     (0) | Val  Loss: 0.6852 | Val  Acc: 0.9394
 Site-MNIST                     (0) | Val  Loss: 0.7704 | Val  Acc: 0.9200
 Site-MNIST                     (0) | Val  Loss: 0.7749 | Val  Acc: 0.8684
 Site-MNIST                     (0) | Val  Loss: 0.8860 | Val  Acc: 0.8596
 Site-USPS                      (1) | Val  Loss: 0.8327 | Val  Acc: 0.7805
 Site-USPS                      (3) | Val  Loss: 0.8785 | Val  Acc: 0.8226
 Site-USPS                      (3) | Val  Loss: 0.8510 | Val  Acc: 0.8710
 Site-SynthDigits               (4) | Val  Loss: 1.4460 | Val  Acc: 0.4808
 Site-SynthDigits               (4) | Val  Loss: 1.3838 | Val  Acc: 0.5256
 Site-MNIST-M                   (2) | Val  Loss: 1.5544 | Val  Acc: 0.5588
 Site-MNIST-M                   (2) | Val  Loss: 1.7210 | Val  Acc: 0.4615
 Site-SVHN                      (2) | Val  Loss: 1.7420 | Val  Acc: 0.4655
Average Valid Accuracy: 0.7279
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.9091
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.9394
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.9200
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8684
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8596
 Best site-USPS                     (1)  | Epoch:9 | Val Acc: 0.7805
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8226
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8710
 Best site-SynthDigits              (4)  | Epoch:9 | Val Acc: 0.4808
 Best site-SynthDigits              (4)  | Epoch:9 | Val Acc: 0.5256
 Best site-MNIST-M                  (2)  | Epoch:9 | Val Acc: 0.5588
 Best site-MNIST-M                  (2)  | Epoch:9 | Val Acc: 0.4615
 Best site-SVHN                     (2)  | Epoch:9 | Val Acc: 0.4655
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cs/ccop_q=1_gmap...
 Test site-MNIST                     (0)| Epoch:9 | Test Acc: 0.8150
 Test site-USPS                      (1)| Epoch:9 | Test Acc: 0.8468
