===2023-03-30 23:33:53===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
===2023-03-30 23:34:55===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
client-11 is in G-2
client-11 is in G-0
client-11 is in G-0
client-11 is in G-1
client-11 is in G-1
client-11 is in G-0
client-11 is in G-1
client-11 is in G-2
client-11 is in G-1
client-11 is in G-1
client-11 is in G-0
client-11 is in G-0
 Site-Clipart   | Train Loss: 2.2749 | Train Acc: 0.2063
 Site-Clipart   | Train Loss: 2.2013 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 2.2677 | Train Acc: 0.1429
 Site-Infograph | Train Loss: 2.2935 | Train Acc: 0.1270
 Site-Painting  | Train Loss: 2.2767 | Train Acc: 0.1587
 Site-Painting  | Train Loss: 2.3055 | Train Acc: 0.1429
 Site-QuickDraw | Train Loss: 2.3418 | Train Acc: 0.0635
 Site-QuickDraw | Train Loss: 2.2993 | Train Acc: 0.1429
 Site-Real      | Train Loss: 2.2693 | Train Acc: 0.1270
 Site-Real      | Train Loss: 2.2796 | Train Acc: 0.1746
 Site-Sketch    | Train Loss: 2.2239 | Train Acc: 0.1429
 Site-Sketch    | Train Loss: 2.2188 | Train Acc: 0.2222
 Site-Clipart   | Val  Loss: 2.1875 | Val  Acc: 0.1905
 Site-Clipart   | Val  Loss: 2.2453 | Val  Acc: 0.1190
 Site-Infograph | Val  Loss: 2.2221 | Val  Acc: 0.1905
 Site-Infograph | Val  Loss: 2.2426 | Val  Acc: 0.1190
 Site-Painting  | Val  Loss: 2.2855 | Val  Acc: 0.1429
 Site-Painting  | Val  Loss: 2.3411 | Val  Acc: 0.1429
 Site-QuickDraw | Val  Loss: 2.3021 | Val  Acc: 0.1667
 Site-QuickDraw | Val  Loss: 2.3426 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.2486 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 2.3156 | Val  Acc: 0.1905
 Site-Sketch    | Val  Loss: 2.1695 | Val  Acc: 0.2143
 Site-Sketch    | Val  Loss: 2.2028 | Val  Acc: 0.2143
Average Valid Accuracy: 0.1647
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1905
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1190
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1905
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1190
 Best site-Painting   | Epoch:0 | Val Acc: 0.1429
 Best site-Painting   | Epoch:0 | Val Acc: 0.1429
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1667
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0952
 Best site-Real       | Epoch:0 | Val Acc: 0.1905
 Best site-Real       | Epoch:0 | Val Acc: 0.1905
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2143
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
============ Train epoch 1 ============
cnt=[(2,)(2,)(8,)]
client-11 is in G-2
client-11 is in G-2
client-11 is in G-2
client-11 is in G-2
client-11 is in G-1
client-11 is in G-0
client-11 is in G-2
client-11 is in G-2
client-11 is in G-1
client-11 is in G-2
client-11 is in G-2
client-11 is in G-0
 Site-Clipart   | Train Loss: 2.1835 | Train Acc: 0.2698
 Site-Clipart   | Train Loss: 2.1102 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.2622 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.2127 | Train Acc: 0.1270
 Site-Painting  | Train Loss: 2.1293 | Train Acc: 0.3016
 Site-Painting  | Train Loss: 2.1842 | Train Acc: 0.3175
 Site-QuickDraw | Train Loss: 2.3240 | Train Acc: 0.0952
 Site-QuickDraw | Train Loss: 2.2787 | Train Acc: 0.1587
 Site-Real      | Train Loss: 2.1382 | Train Acc: 0.2857
 Site-Real      | Train Loss: 2.1508 | Train Acc: 0.2381
 Site-Sketch    | Train Loss: 2.1209 | Train Acc: 0.2698
 Site-Sketch    | Train Loss: 2.1137 | Train Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.0899 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 2.1730 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1976 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 2.1992 | Val  Acc: 0.1905
 Site-Painting  | Val  Loss: 2.1506 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 2.2710 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.2810 | Val  Acc: 0.1429
 Site-QuickDraw | Val  Loss: 2.2949 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1230 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 2.1923 | Val  Acc: 0.2619
 Site-Sketch    | Val  Loss: 2.0691 | Val  Acc: 0.3810
 Site-Sketch    | Val  Loss: 2.1840 | Val  Acc: 0.1905
Average Valid Accuracy: 0.2421
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1905
 Best site-Painting   | Epoch:1 | Val Acc: 0.3095
 Best site-Painting   | Epoch:1 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1429
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1429
 Best site-Real       | Epoch:1 | Val Acc: 0.2619
 Best site-Real       | Epoch:1 | Val Acc: 0.2619
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3810
 Best site-Sketch     | Epoch:1 | Val Acc: 0.1905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
===2023-03-30 23:37:00===
===2023-03-30 23:37:41===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
===2023-03-30 23:41:31===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
===2023-03-30 23:45:14===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
===2023-03-30 23:46:30===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
client-11 is in G-2
client-11 is in G-0
client-11 is in G-0
client-11 is in G-1
client-11 is in G-1
client-11 is in G-0
client-11 is in G-1
client-11 is in G-2
client-11 is in G-1
client-11 is in G-1
client-11 is in G-0
client-11 is in G-0
 Site-Clipart   | Train Loss: 2.2749 | Train Acc: 0.2063
 Site-Clipart   | Train Loss: 2.2013 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 2.2677 | Train Acc: 0.1429
 Site-Infograph | Train Loss: 2.2935 | Train Acc: 0.1270
 Site-Painting  | Train Loss: 2.2767 | Train Acc: 0.1587
 Site-Painting  | Train Loss: 2.3055 | Train Acc: 0.1429
 Site-QuickDraw | Train Loss: 2.3418 | Train Acc: 0.0635
 Site-QuickDraw | Train Loss: 2.2993 | Train Acc: 0.1429
 Site-Real      | Train Loss: 2.2693 | Train Acc: 0.1270
 Site-Real      | Train Loss: 2.2796 | Train Acc: 0.1746
 Site-Sketch    | Train Loss: 2.2239 | Train Acc: 0.1429
 Site-Sketch    | Train Loss: 2.2188 | Train Acc: 0.2222
 Site-Clipart   | Val  Loss: 2.1875 | Val  Acc: 0.1905
 Site-Clipart   | Val  Loss: 2.2453 | Val  Acc: 0.1190
 Site-Infograph | Val  Loss: 2.2221 | Val  Acc: 0.1905
 Site-Infograph | Val  Loss: 2.2426 | Val  Acc: 0.1190
 Site-Painting  | Val  Loss: 2.2855 | Val  Acc: 0.1429
 Site-Painting  | Val  Loss: 2.3411 | Val  Acc: 0.1429
 Site-QuickDraw | Val  Loss: 2.3021 | Val  Acc: 0.1667
 Site-QuickDraw | Val  Loss: 2.3426 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.2486 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 2.3156 | Val  Acc: 0.1905
 Site-Sketch    | Val  Loss: 2.1695 | Val  Acc: 0.2143
 Site-Sketch    | Val  Loss: 2.2028 | Val  Acc: 0.2143
Average Valid Accuracy: 0.1647
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1905
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1190
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1905
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1190
 Best site-Painting   | Epoch:0 | Val Acc: 0.1429
 Best site-Painting   | Epoch:0 | Val Acc: 0.1429
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1667
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0952
 Best site-Real       | Epoch:0 | Val Acc: 0.1905
 Best site-Real       | Epoch:0 | Val Acc: 0.1905
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2143
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
============ Train epoch 1 ============
cnt=[(2,)(2,)(8,)]
client-11 is in G-2
client-11 is in G-2
client-11 is in G-2
client-11 is in G-2
client-11 is in G-1
client-11 is in G-0
client-11 is in G-2
client-11 is in G-2
client-11 is in G-1
client-11 is in G-2
client-11 is in G-2
client-11 is in G-0
 Site-Clipart   | Train Loss: 2.1835 | Train Acc: 0.2698
===2023-03-30 23:48:21===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
client-11 is in G-0
client-11 is in G-1
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-2
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
 Site-Clipart   | Train Loss: 2.2779 | Train Acc: 0.1746
 Site-Clipart   | Train Loss: 2.1984 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.2639 | Train Acc: 0.1429
 Site-Infograph | Train Loss: 2.2893 | Train Acc: 0.1429
 Site-Painting  | Train Loss: 2.2758 | Train Acc: 0.1587
 Site-Painting  | Train Loss: 2.2955 | Train Acc: 0.1429
 Site-QuickDraw | Train Loss: 2.3422 | Train Acc: 0.0635
 Site-QuickDraw | Train Loss: 2.3010 | Train Acc: 0.1429
 Site-Real      | Train Loss: 2.2749 | Train Acc: 0.1746
 Site-Real      | Train Loss: 2.2800 | Train Acc: 0.1746
 Site-Sketch    | Train Loss: 2.2252 | Train Acc: 0.1746
 Site-Sketch    | Train Loss: 2.2165 | Train Acc: 0.2222
 Site-Clipart   | Val  Loss: 2.1821 | Val  Acc: 0.2143
 Site-Clipart   | Val  Loss: 2.2483 | Val  Acc: 0.1190
 Site-Infograph | Val  Loss: 2.2211 | Val  Acc: 0.1905
 Site-Infograph | Val  Loss: 2.2407 | Val  Acc: 0.1429
 Site-Painting  | Val  Loss: 2.2730 | Val  Acc: 0.1429
 Site-Painting  | Val  Loss: 2.3319 | Val  Acc: 0.1190
 Site-QuickDraw | Val  Loss: 2.3067 | Val  Acc: 0.1667
 Site-QuickDraw | Val  Loss: 2.3434 | Val  Acc: 0.1190
 Site-Real      | Val  Loss: 2.2628 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 2.3182 | Val  Acc: 0.1667
 Site-Sketch    | Val  Loss: 2.1670 | Val  Acc: 0.2143
 Site-Sketch    | Val  Loss: 2.2044 | Val  Acc: 0.1905
Average Valid Accuracy: 0.1627
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2143
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1190
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1905
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1429
 Best site-Painting   | Epoch:0 | Val Acc: 0.1429
 Best site-Painting   | Epoch:0 | Val Acc: 0.1190
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1667
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1190
 Best site-Real       | Epoch:0 | Val Acc: 0.1667
 Best site-Real       | Epoch:0 | Val Acc: 0.1667
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2143
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
============ Train epoch 1 ============
cnt=[(10,)(1,)(1,)]
client-11 is in G-0
client-11 is in G-1
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-2
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
===2023-03-30 23:50:01===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
client-11 is in G-0
client-11 is in G-2
client-11 is in G-1
client-11 is in G-0
client-11 is in G-0
client-11 is in G-1
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-1
client-11 is in G-1
 Site-Clipart   | Train Loss: 2.2785 | Train Acc: 0.1905
 Site-Clipart   | Train Loss: 2.2005 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 2.2661 | Train Acc: 0.1429
 Site-Infograph | Train Loss: 2.2899 | Train Acc: 0.1429
 Site-Painting  | Train Loss: 2.2767 | Train Acc: 0.1746
 Site-Painting  | Train Loss: 2.2984 | Train Acc: 0.1429
 Site-QuickDraw | Train Loss: 2.3419 | Train Acc: 0.0635
 Site-QuickDraw | Train Loss: 2.3014 | Train Acc: 0.1429
 Site-Real      | Train Loss: 2.2749 | Train Acc: 0.1429
 Site-Real      | Train Loss: 2.2804 | Train Acc: 0.1746
 Site-Sketch    | Train Loss: 2.2250 | Train Acc: 0.1746
 Site-Sketch    | Train Loss: 2.2178 | Train Acc: 0.2222
 Site-Clipart   | Val  Loss: 2.1833 | Val  Acc: 0.2143
 Site-Clipart   | Val  Loss: 2.2500 | Val  Acc: 0.1190
 Site-Infograph | Val  Loss: 2.2201 | Val  Acc: 0.1905
 Site-Infograph | Val  Loss: 2.2411 | Val  Acc: 0.1429
 Site-Painting  | Val  Loss: 2.2772 | Val  Acc: 0.1429
 Site-Painting  | Val  Loss: 2.3353 | Val  Acc: 0.1429
 Site-QuickDraw | Val  Loss: 2.3068 | Val  Acc: 0.1667
 Site-QuickDraw | Val  Loss: 2.3436 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.2586 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 2.3191 | Val  Acc: 0.1667
 Site-Sketch    | Val  Loss: 2.1675 | Val  Acc: 0.2143
 Site-Sketch    | Val  Loss: 2.2051 | Val  Acc: 0.1905
Average Valid Accuracy: 0.1667
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2143
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1190
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1905
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1429
 Best site-Painting   | Epoch:0 | Val Acc: 0.1429
 Best site-Painting   | Epoch:0 | Val Acc: 0.1429
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1667
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0952
 Best site-Real       | Epoch:0 | Val Acc: 0.2143
 Best site-Real       | Epoch:0 | Val Acc: 0.1667
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2143
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
============ Train epoch 1 ============
cnt=[(8,)(3,)(1,)]
client-11 is in G-0
client-11 is in G-2
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-1
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-1
client-11 is in G-1
 Site-Clipart   | Train Loss: 2.1829 | Train Acc: 0.2698
 Site-Clipart   | Train Loss: 2.1087 | Train Acc: 0.3016
===2023-03-30 23:51:52===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
client-11 is in G-0
client-11 is in G-2
client-11 is in G-1
client-11 is in G-0
client-11 is in G-0
client-11 is in G-1
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-1
client-11 is in G-1
 Site-Clipart   | Train Loss: 2.2785 | Train Acc: 0.1905
 Site-Clipart   | Train Loss: 2.2005 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 2.2661 | Train Acc: 0.1429
 Site-Infograph | Train Loss: 2.2899 | Train Acc: 0.1429
 Site-Painting  | Train Loss: 2.2767 | Train Acc: 0.1746
 Site-Painting  | Train Loss: 2.2984 | Train Acc: 0.1429
 Site-QuickDraw | Train Loss: 2.3419 | Train Acc: 0.0635
 Site-QuickDraw | Train Loss: 2.3014 | Train Acc: 0.1429
 Site-Real      | Train Loss: 2.2749 | Train Acc: 0.1429
 Site-Real      | Train Loss: 2.2804 | Train Acc: 0.1746
 Site-Sketch    | Train Loss: 2.2250 | Train Acc: 0.1746
 Site-Sketch    | Train Loss: 2.2178 | Train Acc: 0.2222
 Site-Clipart   | Val  Loss: 2.1833 | Val  Acc: 0.2143
 Site-Clipart   | Val  Loss: 2.2500 | Val  Acc: 0.1190
 Site-Infograph | Val  Loss: 2.2201 | Val  Acc: 0.1905
 Site-Infograph | Val  Loss: 2.2411 | Val  Acc: 0.1429
 Site-Painting  | Val  Loss: 2.2772 | Val  Acc: 0.1429
 Site-Painting  | Val  Loss: 2.3353 | Val  Acc: 0.1429
 Site-QuickDraw | Val  Loss: 2.3068 | Val  Acc: 0.1667
 Site-QuickDraw | Val  Loss: 2.3436 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.2586 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 2.3191 | Val  Acc: 0.1667
 Site-Sketch    | Val  Loss: 2.1675 | Val  Acc: 0.2143
 Site-Sketch    | Val  Loss: 2.2051 | Val  Acc: 0.1905
Average Valid Accuracy: 0.1667
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2143
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1190
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1905
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1429
 Best site-Painting   | Epoch:0 | Val Acc: 0.1429
 Best site-Painting   | Epoch:0 | Val Acc: 0.1429
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1667
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0952
 Best site-Real       | Epoch:0 | Val Acc: 0.2143
 Best site-Real       | Epoch:0 | Val Acc: 0.1667
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2143
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
============ Train epoch 1 ============
cnt=[(8,)(3,)(1,)]
client-11 is in G-0
client-11 is in G-2
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-1
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-0
client-11 is in G-1
client-11 is in G-1
 Site-Clipart   | Train Loss: 2.1829 | Train Acc: 0.2698
 Site-Clipart   | Train Loss: 2.1087 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 2.2586 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.2126 | Train Acc: 0.1270
 Site-Painting  | Train Loss: 2.1287 | Train Acc: 0.2857
 Site-Painting  | Train Loss: 2.1790 | Train Acc: 0.2698
 Site-QuickDraw | Train Loss: 2.3288 | Train Acc: 0.1111
 Site-QuickDraw | Train Loss: 2.2818 | Train Acc: 0.1746
 Site-Real      | Train Loss: 2.1452 | Train Acc: 0.2857
 Site-Real      | Train Loss: 2.1535 | Train Acc: 0.2063
 Site-Sketch    | Train Loss: 2.1231 | Train Acc: 0.2698
 Site-Sketch    | Train Loss: 2.1182 | Train Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.0873 | Val  Acc: 0.3810
 Site-Clipart   | Val  Loss: 2.1742 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1905 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 2.1985 | Val  Acc: 0.1905
 Site-Painting  | Val  Loss: 2.1475 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 2.2658 | Val  Acc: 0.2619
 Site-QuickDraw | Val  Loss: 2.2845 | Val  Acc: 0.1190
 Site-QuickDraw | Val  Loss: 2.2930 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 2.1319 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 2.1959 | Val  Acc: 0.3095
 Site-Sketch    | Val  Loss: 2.0738 | Val  Acc: 0.3571
 Site-Sketch    | Val  Loss: 2.1856 | Val  Acc: 0.1905
Average Valid Accuracy: 0.2460
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3810
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1905
 Best site-Painting   | Epoch:1 | Val Acc: 0.2857
 Best site-Painting   | Epoch:1 | Val Acc: 0.2619
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1190
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1667
 Best site-Real       | Epoch:1 | Val Acc: 0.2381
 Best site-Real       | Epoch:1 | Val Acc: 0.3095
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3571
 Best site-Sketch     | Epoch:1 | Val Acc: 0.1905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
===2023-03-30 23:54:00===
===2023-03-30 23:54:33===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
client-0 is in G-2
client-1 is in G-0
client-2 is in G-0
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
 Site-Clipart   | Train Loss: 2.2749 | Train Acc: 0.2063
 Site-Clipart   | Train Loss: 2.2013 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 2.2677 | Train Acc: 0.1429
 Site-Infograph | Train Loss: 2.2935 | Train Acc: 0.1270
 Site-Painting  | Train Loss: 2.2767 | Train Acc: 0.1587
 Site-Painting  | Train Loss: 2.3055 | Train Acc: 0.1429
 Site-QuickDraw | Train Loss: 2.3418 | Train Acc: 0.0635
 Site-QuickDraw | Train Loss: 2.2993 | Train Acc: 0.1429
 Site-Real      | Train Loss: 2.2693 | Train Acc: 0.1270
 Site-Real      | Train Loss: 2.2796 | Train Acc: 0.1746
 Site-Sketch    | Train Loss: 2.2239 | Train Acc: 0.1429
 Site-Sketch    | Train Loss: 2.2188 | Train Acc: 0.2222
 Site-Clipart   | Val  Loss: 2.1875 | Val  Acc: 0.1905
 Site-Clipart   | Val  Loss: 2.2453 | Val  Acc: 0.1190
 Site-Infograph | Val  Loss: 2.2221 | Val  Acc: 0.1905
 Site-Infograph | Val  Loss: 2.2426 | Val  Acc: 0.1190
 Site-Painting  | Val  Loss: 2.2855 | Val  Acc: 0.1429
 Site-Painting  | Val  Loss: 2.3411 | Val  Acc: 0.1429
 Site-QuickDraw | Val  Loss: 2.3021 | Val  Acc: 0.1667
 Site-QuickDraw | Val  Loss: 2.3426 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.2486 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 2.3156 | Val  Acc: 0.1905
 Site-Sketch    | Val  Loss: 2.1695 | Val  Acc: 0.2143
 Site-Sketch    | Val  Loss: 2.2028 | Val  Acc: 0.2143
Average Valid Accuracy: 0.1647
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1905
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1190
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1905
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1190
 Best site-Painting   | Epoch:0 | Val Acc: 0.1429
 Best site-Painting   | Epoch:0 | Val Acc: 0.1429
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1667
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0952
 Best site-Real       | Epoch:0 | Val Acc: 0.1905
 Best site-Real       | Epoch:0 | Val Acc: 0.1905
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2143
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
============ Train epoch 1 ============
cnt=[(2,)(2,)(8,)]
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-1
client-5 is in G-0
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-0
 Site-Clipart   | Train Loss: 2.1835 | Train Acc: 0.2698
 Site-Clipart   | Train Loss: 2.1102 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.2622 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.2127 | Train Acc: 0.1270
 Site-Painting  | Train Loss: 2.1293 | Train Acc: 0.3016
 Site-Painting  | Train Loss: 2.1842 | Train Acc: 0.3175
 Site-QuickDraw | Train Loss: 2.3240 | Train Acc: 0.0952
 Site-QuickDraw | Train Loss: 2.2787 | Train Acc: 0.1587
 Site-Real      | Train Loss: 2.1382 | Train Acc: 0.2857
 Site-Real      | Train Loss: 2.1508 | Train Acc: 0.2381
 Site-Sketch    | Train Loss: 2.1209 | Train Acc: 0.2698
 Site-Sketch    | Train Loss: 2.1137 | Train Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.0899 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 2.1730 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1976 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 2.1992 | Val  Acc: 0.1905
 Site-Painting  | Val  Loss: 2.1506 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 2.2710 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.2810 | Val  Acc: 0.1429
 Site-QuickDraw | Val  Loss: 2.2949 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1230 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 2.1923 | Val  Acc: 0.2619
 Site-Sketch    | Val  Loss: 2.0691 | Val  Acc: 0.3810
 Site-Sketch    | Val  Loss: 2.1840 | Val  Acc: 0.1905
Average Valid Accuracy: 0.2421
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1905
 Best site-Painting   | Epoch:1 | Val Acc: 0.3095
 Best site-Painting   | Epoch:1 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1429
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1429
 Best site-Real       | Epoch:1 | Val Acc: 0.2619
 Best site-Real       | Epoch:1 | Val Acc: 0.2619
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3810
 Best site-Sketch     | Epoch:1 | Val Acc: 0.1905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
===2023-03-30 23:56:40===
===2023-03-30 23:59:59===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-2
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
 Site-Clipart   | Train Loss: 2.0209 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9410 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 2.1939 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.1554 | Train Acc: 0.2540
 Site-Painting  | Train Loss: 1.9712 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.9519 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 2.2701 | Train Acc: 0.2222
 Site-QuickDraw | Train Loss: 2.2039 | Train Acc: 0.2222
 Site-Real      | Train Loss: 1.8467 | Train Acc: 0.5556
 Site-Real      | Train Loss: 1.9198 | Train Acc: 0.5238
 Site-Sketch    | Train Loss: 1.9647 | Train Acc: 0.5079
 Site-Sketch    | Train Loss: 1.9707 | Train Acc: 0.4921
 Site-Clipart   | Val  Loss: 1.9664 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.9530 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.1342 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1376 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.8958 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 2.0596 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.1976 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.2215 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.8772 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 1.9550 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.9322 | Val  Acc: 0.4286
 Site-Sketch    | Val  Loss: 2.0329 | Val  Acc: 0.4762
Average Valid Accuracy: 0.3968
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Painting   | Epoch:0 | Val Acc: 0.4286
 Best site-Painting   | Epoch:0 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2619
 Best site-Real       | Epoch:0 | Val Acc: 0.4762
 Best site-Real       | Epoch:0 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4286
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
cnt=[(6,)(3,)(3,)]
client-0 is in G-0
client-1 is in G-1
client-2 is in G-2
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
 Site-Clipart   | Train Loss: 1.7016 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.6442 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 2.1126 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.0214 | Train Acc: 0.3810
 Site-Painting  | Train Loss: 1.4920 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 1.4578 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 2.1513 | Train Acc: 0.2540
 Site-QuickDraw | Train Loss: 2.0526 | Train Acc: 0.3333
 Site-Real      | Train Loss: 1.3063 | Train Acc: 0.7778
 Site-Real      | Train Loss: 1.3896 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 1.5046 | Train Acc: 0.6190
 Site-Sketch    | Train Loss: 1.5207 | Train Acc: 0.6349
 Site-Clipart   | Val  Loss: 1.7138 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.6871 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.9539 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.1581 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.3429 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 1.6632 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 2.0271 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.1032 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.3618 | Val  Acc: 0.8095
 Site-Real      | Val  Loss: 1.3733 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.5838 | Val  Acc: 0.6429
 Site-Sketch    | Val  Loss: 1.5605 | Val  Acc: 0.6905
Average Valid Accuracy: 0.5556
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3333
 Best site-Painting   | Epoch:1 | Val Acc: 0.7619
 Best site-Painting   | Epoch:1 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2143
 Best site-Real       | Epoch:1 | Val Acc: 0.8095
 Best site-Real       | Epoch:1 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6429
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
===2023-03-31 00:06:24===
===2023-03-31 00:08:03===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-2
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
cnt=[===2023-03-31 00:11:25===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-2
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
cnt=[(6,)(3,)(3,)]
 Site-Clipart   | Train Loss: 2.0209 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9410 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 2.1939 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.1554 | Train Acc: 0.2540
 Site-Painting  | Train Loss: 1.9712 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.9519 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 2.2701 | Train Acc: 0.2222
 Site-QuickDraw | Train Loss: 2.2039 | Train Acc: 0.2222
 Site-Real      | Train Loss: 1.8467 | Train Acc: 0.5556
 Site-Real      | Train Loss: 1.9198 | Train Acc: 0.5238
 Site-Sketch    | Train Loss: 1.9647 | Train Acc: 0.5079
 Site-Sketch    | Train Loss: 1.9707 | Train Acc: 0.4921
 Site-Clipart   | Val  Loss: 1.9664 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.9530 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.1342 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1376 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.8958 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 2.0596 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.1976 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.2215 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.8772 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 1.9550 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.9322 | Val  Acc: 0.4286
 Site-Sketch    | Val  Loss: 2.0329 | Val  Acc: 0.4762
Average Valid Accuracy: 0.3968
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Painting   | Epoch:0 | Val Acc: 0.4286
 Best site-Painting   | Epoch:0 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2619
 Best site-Real       | Epoch:0 | Val Acc: 0.4762
 Best site-Real       | Epoch:0 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4286
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-1
client-1 is in G-0
client-2 is in G-0
client-3 is in G-1
client-4 is in G-2
client-5 is in G-0
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-2
client-10 is in G-1
client-11 is in G-0
cnt=[(5,)(5,)(2,)]
 Site-Clipart   | Train Loss: 1.6854 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.6297 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 2.1045 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.0146 | Train Acc: 0.4127
 Site-Painting  | Train Loss: 1.4819 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 1.4645 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 2.1454 | Train Acc: 0.3016
 Site-QuickDraw | Train Loss: 2.0521 | Train Acc: 0.3175
 Site-Real      | Train Loss: 1.3166 | Train Acc: 0.7778
 Site-Real      | Train Loss: 1.3725 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 1.5042 | Train Acc: 0.6032
 Site-Sketch    | Train Loss: 1.5223 | Train Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.7125 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.6692 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.9476 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1411 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 1.3422 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 1.6523 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 2.0263 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.1016 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.3590 | Val  Acc: 0.8095
 Site-Real      | Val  Loss: 1.3573 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.5703 | Val  Acc: 0.6429
 Site-Sketch    | Val  Loss: 1.5597 | Val  Acc: 0.6190
Average Valid Accuracy: 0.5476
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3095
 Best site-Painting   | Epoch:1 | Val Acc: 0.7619
 Best site-Painting   | Epoch:1 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2143
 Best site-Real       | Epoch:1 | Val Acc: 0.8095
 Best site-Real       | Epoch:1 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6429
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
===2023-03-31 00:17:50===
===2023-03-31 00:20:01===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-2
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
cnt=[(6,)(3,)(3,)]
 Site-Clipart   | Train Loss: 2.0209 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9410 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 2.1939 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.1554 | Train Acc: 0.2540
 Site-Painting  | Train Loss: 1.9712 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.9519 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 2.2701 | Train Acc: 0.2222
 Site-QuickDraw | Train Loss: 2.2039 | Train Acc: 0.2222
 Site-Real      | Train Loss: 1.8467 | Train Acc: 0.5556
 Site-Real      | Train Loss: 1.9198 | Train Acc: 0.5238
 Site-Sketch    | Train Loss: 1.9647 | Train Acc: 0.5079
 Site-Sketch    | Train Loss: 1.9707 | Train Acc: 0.4921
 Site-Clipart   | Val  Loss: 1.9664 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.9530 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.1342 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1376 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.8958 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 2.0596 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.1976 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.2215 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.8772 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 1.9550 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.9322 | Val  Acc: 0.4286
 Site-Sketch    | Val  Loss: 2.0329 | Val  Acc: 0.4762
Average Valid Accuracy: 0.3968
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Painting   | Epoch:0 | Val Acc: 0.4286
 Best site-Painting   | Epoch:0 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2619
 Best site-Real       | Epoch:0 | Val Acc: 0.4762
 Best site-Real       | Epoch:0 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4286
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-1
client-1 is in G-0
client-2 is in G-0
client-3 is in G-1
client-4 is in G-2
client-5 is in G-0
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-2
client-10 is in G-1
client-11 is in G-0
cnt=[(5,)(5,)(2,)]
 Site-Clipart   | Train Loss: 1.6854 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.6297 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 2.1045 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.0146 | Train Acc: 0.4127
 Site-Painting  | Train Loss: 1.4819 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 1.4645 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 2.1454 | Train Acc: 0.3016
 Site-QuickDraw | Train Loss: 2.0521 | Train Acc: 0.3175
 Site-Real      | Train Loss: 1.3166 | Train Acc: 0.7778
 Site-Real      | Train Loss: 1.3725 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 1.5042 | Train Acc: 0.6032
 Site-Sketch    | Train Loss: 1.5223 | Train Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.7125 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.6692 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.9476 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1411 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 1.3422 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 1.6523 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 2.0263 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.1016 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.3590 | Val  Acc: 0.8095
 Site-Real      | Val  Loss: 1.3573 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.5703 | Val  Acc: 0.6429
 Site-Sketch    | Val  Loss: 1.5597 | Val  Acc: 0.6190
Average Valid Accuracy: 0.5476
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3095
 Best site-Painting   | Epoch:1 | Val Acc: 0.7619
 Best site-Painting   | Epoch:1 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2143
 Best site-Real       | Epoch:1 | Val Acc: 0.8095
 Best site-Real       | Epoch:1 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6429
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-2
client-7 is in G-2
client-8 is in G-0
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
cnt=[(7,)(3,)(2,)]
 Site-Clipart   | Train Loss: 1.2770 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.3373 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 1.9478 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.7722 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 1.0691 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 1.0780 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 2.0179 | Train Acc: 0.3810
 Site-QuickDraw | Train Loss: 1.8402 | Train Acc: 0.4444
 Site-Real      | Train Loss: 0.8624 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.9638 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.1850 | Train Acc: 0.7778
 Site-Sketch    | Train Loss: 1.1634 | Train Acc: 0.7302
 Site-Clipart   | Val  Loss: 1.4076 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.4002 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7512 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.9742 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 0.9677 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 1.2233 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.7704 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.8737 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.8829 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.9164 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.2315 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.2982 | Val  Acc: 0.7381
Average Valid Accuracy: 0.6687
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3333
 Best site-Painting   | Epoch:2 | Val Acc: 0.9286
 Best site-Painting   | Epoch:2 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4286
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-1
client-3 is in G-2
client-4 is in G-2
client-5 is in G-1
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-2
client-10 is in G-0
client-11 is in G-1
cnt=[(4,)(5,)(3,)]
 Site-Clipart   | Train Loss: 1.0861 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.0599 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.7610 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.5436 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.7915 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.8199 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.8615 | Train Acc: 0.3968
 Site-QuickDraw | Train Loss: 1.7164 | Train Acc: 0.4603
 Site-Real      | Train Loss: 0.6512 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.6375 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.9154 | Train Acc: 0.7778
 Site-Sketch    | Train Loss: 0.9899 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 1.1307 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.0320 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.4269 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.8488 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 0.7572 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 1.0401 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.7594 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 1.8161 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.6261 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.6428 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.9235 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 1.0024 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7004
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-Painting   | Epoch:3 | Val Acc: 0.8810
 Best site-Painting   | Epoch:3 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4762
 Best site-Real       | Epoch:3 | Val Acc: 0.9286
 Best site-Real       | Epoch:3 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-2
client-4 is in G-2
client-5 is in G-0
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
cnt=[(7,)(2,)(3,)]
 Site-Clipart   | Train Loss: 0.8295 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.8776 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.5696 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.3700 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.6138 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.6796 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 1.6154 | Train Acc: 0.5556
 Site-QuickDraw | Train Loss: 1.4616 | Train Acc: 0.6190
 Site-Real      | Train Loss: 0.4792 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.4289 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.7948 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 0.8148 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 1.0913 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 0.8884 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.2168 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.6996 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.6292 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 0.7842 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.4133 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.6366 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.3907 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.4337 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.8859 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 0.7914 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7321
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:4 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4286
 Best site-Painting   | Epoch:4 | Val Acc: 0.8571
 Best site-Painting   | Epoch:4 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5238
 Best site-Real       | Epoch:4 | Val Acc: 0.9524
 Best site-Real       | Epoch:4 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-2
client-4 is in G-2
client-5 is in G-0
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
cnt=[(7,)(2,)(3,)]
 Site-Clipart   | Train Loss: 0.6291 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.8006 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.5354 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.2432 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.4828 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.5929 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.4227 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 1.3274 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.4147 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.3188 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.6942 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 0.6618 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8295 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 0.6934 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.0582 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3852 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.4873 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.6718 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.2462 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.4204 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.3168 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.3856 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7437 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 0.6568 | Val  Acc: 0.9048
Average Valid Accuracy: 0.7817
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5476
 Best site-Painting   | Epoch:5 | Val Acc: 0.9048
 Best site-Painting   | Epoch:5 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5714
 Best site-Real       | Epoch:5 | Val Acc: 0.9524
 Best site-Real       | Epoch:5 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:5 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-2
client-4 is in G-2
client-5 is in G-0
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
cnt=[(7,)(2,)(3,)]
 Site-Clipart   | Train Loss: 0.4451 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.7253 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.4164 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1042 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.4051 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.3640 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.2695 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 1.1151 | Train Acc: 0.6349
 Site-Real      | Train Loss: 0.3235 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.2020 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.5561 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.5673 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.7375 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.6479 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.9844 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.5443 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.3566 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.4715 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.1326 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.2441 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.2539 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.2441 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.5765 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.6164 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7857
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4286
 Best site-Painting   | Epoch:6 | Val Acc: 0.9524
 Best site-Painting   | Epoch:6 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5238
 Best site-Real       | Epoch:6 | Val Acc: 0.9286
 Best site-Real       | Epoch:6 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-2
client-4 is in G-2
client-5 is in G-0
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
cnt=[(7,)(2,)(3,)]
 Site-Clipart   | Train Loss: 0.3650 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.5679 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.1469 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 0.9275 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.3508 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.3255 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.1603 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 1.0880 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.3208 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.1631 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.4450 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.5233 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6274 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.5023 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.9685 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.2484 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.2623 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.3877 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 0.9914 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.2416 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.1684 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2288 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5245 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.3897 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8254
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6190
 Best site-Painting   | Epoch:7 | Val Acc: 0.9524
 Best site-Painting   | Epoch:7 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.6190
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Real       | Epoch:7 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-2
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-1
client-7 is in G-1
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-2
cnt=[(5,)(2,)(5,)]
 Site-Clipart   | Train Loss: 0.2933 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4102 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.1619 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 0.9485 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.2597 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2363 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.1403 | Train Acc: 0.6032
 Site-QuickDraw | Train Loss: 1.0016 | Train Acc: 0.6984
 Site-Real      | Train Loss: 0.2176 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.1211 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2931 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3710 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4395 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3668 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.8118 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3782 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.2457 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.2945 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 0.8075 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.1071 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.1207 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1602 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.3502 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.3918 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8393
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9524
 Best site-Painting   | Epoch:8 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.6190
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-2
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-1
client-7 is in G-1
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-2
cnt=[(5,)(2,)(5,)]
 Site-Clipart   | Train Loss: 0.3157 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4675 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.1454 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 0.8965 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.2130 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.1957 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.0325 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 0.7705 | Train Acc: 0.7143
 Site-Real      | Train Loss: 0.1459 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1328 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.2884 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.2950 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.5195 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3112 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.6726 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.9685 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 0.2001 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.2362 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 0.7671 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 0.9065 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.1191 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1475 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.4925 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.4088 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8631
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7143
 Best site-Painting   | Epoch:9 | Val Acc: 0.9762
 Best site-Painting   | Epoch:9 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.6429
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt-sklearn/FedPrompt...
===2023-03-31 00:52:14===
===2023-03-31 00:52:56===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8080
 Test site-Infograph | Epoch:9 | Test Acc: 0.4703
 Test site-Painting  | Epoch:9 | Test Acc: 0.8465
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.5610
 Test site-Real      | Epoch:9 | Test Acc: 0.9236
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7906
Average Test Accuracy: 0.7333
===2023-03-31 13:57:48===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 20
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
===2023-03-31 13:58:27===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 40
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
