===2023-08-10 17:55:15===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 3
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 4, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (1) | Train Loss: 1.6158 | Train Acc: 0.5733
 Site-photo                     (1) | Train Loss: 1.4886 | Train Acc: 0.6311
 Site-art_painting              (1) | Train Loss: 1.7779 | Train Acc: 0.2933
 Site-art_painting              (1) | Train Loss: 1.6805 | Train Acc: 0.4022
 Site-cartoon                   (2) | Train Loss: 1.7684 | Train Acc: 0.3333
 Site-cartoon                   (2) | Train Loss: 1.7106 | Train Acc: 0.3156
 Site-sketch                    (0) | Train Loss: 1.7783 | Train Acc: 0.2267
 Site-sketch                    (0) | Train Loss: 1.7646 | Train Acc: 0.2467
Average Train Accuracy: 0.3778
 Site-photo                     (1) | Val  Loss: 1.5287 | Val  Acc: 0.6600
 Site-photo                     (1) | Val  Loss: 1.5713 | Val  Acc: 0.6200
 Site-art_painting              (1) | Val  Loss: 1.6422 | Val  Acc: 0.4500
 Site-art_painting              (1) | Val  Loss: 1.6794 | Val  Acc: 0.4267
 Site-cartoon                   (2) | Val  Loss: 1.7516 | Val  Acc: 0.2700
 Site-cartoon                   (2) | Val  Loss: 1.7579 | Val  Acc: 0.3333
 Site-sketch                    (0) | Val  Loss: 1.7498 | Val  Acc: 0.3100
 Site-sketch                    (0) | Val  Loss: 1.7667 | Val  Acc: 0.2500
Average Valid Accuracy: 0.4150
 Best site-photo                    (1)  | Epoch:0 | Val Acc: 0.6600
 Best site-photo                    (1)  | Epoch:0 | Val Acc: 0.6200
 Best site-art_painting             (1)  | Epoch:0 | Val Acc: 0.4500
 Best site-art_painting             (1)  | Epoch:0 | Val Acc: 0.4267
 Best site-cartoon                  (2)  | Epoch:0 | Val Acc: 0.2700
 Best site-cartoon                  (2)  | Epoch:0 | Val Acc: 0.3333
 Best site-sketch                   (0)  | Epoch:0 | Val Acc: 0.3100
 Best site-sketch                   (0)  | Epoch:0 | Val Acc: 0.2500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 1 ============
cnt=[4, 2, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (0) | Train Loss: 1.2724 | Train Acc: 0.7667
 Site-photo                     (0) | Train Loss: 1.2212 | Train Acc: 0.8156
 Site-art_painting              (0) | Train Loss: 1.5658 | Train Acc: 0.5267
 Site-art_painting              (0) | Train Loss: 1.4971 | Train Acc: 0.5444
 Site-cartoon                   (2) | Train Loss: 1.5771 | Train Acc: 0.4400
 Site-cartoon                   (2) | Train Loss: 1.5656 | Train Acc: 0.5089
 Site-sketch                    (1) | Train Loss: 1.6709 | Train Acc: 0.3800
 Site-sketch                    (1) | Train Loss: 1.6093 | Train Acc: 0.3800
Average Train Accuracy: 0.5453
 Site-photo                     (0) | Val  Loss: 1.2041 | Val  Acc: 0.8600
 Site-photo                     (0) | Val  Loss: 1.2508 | Val  Acc: 0.8033
 Site-art_painting              (0) | Val  Loss: 1.4530 | Val  Acc: 0.5600
 Site-art_painting              (0) | Val  Loss: 1.4680 | Val  Acc: 0.5633
 Site-cartoon                   (2) | Val  Loss: 1.5349 | Val  Acc: 0.5400
 Site-cartoon                   (2) | Val  Loss: 1.5313 | Val  Acc: 0.5000
 Site-sketch                    (1) | Val  Loss: 1.5858 | Val  Acc: 0.3800
 Site-sketch                    (1) | Val  Loss: 1.5743 | Val  Acc: 0.3967
Average Valid Accuracy: 0.5754
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.8600
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.8033
 Best site-art_painting             (0)  | Epoch:1 | Val Acc: 0.5600
 Best site-art_painting             (0)  | Epoch:1 | Val Acc: 0.5633
 Best site-cartoon                  (2)  | Epoch:1 | Val Acc: 0.5400
 Best site-cartoon                  (2)  | Epoch:1 | Val Acc: 0.5000
 Best site-sketch                   (1)  | Epoch:1 | Val Acc: 0.3800
 Best site-sketch                   (1)  | Epoch:1 | Val Acc: 0.3967
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 4, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (1) | Train Loss: 1.0284 | Train Acc: 0.9133
 Site-photo                     (1) | Train Loss: 1.0182 | Train Acc: 0.9089
 Site-art_painting              (1) | Train Loss: 1.3397 | Train Acc: 0.5867
 Site-art_painting              (1) | Train Loss: 1.2274 | Train Acc: 0.7022
 Site-cartoon                   (2) | Train Loss: 1.4369 | Train Acc: 0.5467
 Site-cartoon                   (2) | Train Loss: 1.3414 | Train Acc: 0.6044
 Site-sketch                    (0) | Train Loss: 1.4794 | Train Acc: 0.4400
 Site-sketch                    (0) | Train Loss: 1.4386 | Train Acc: 0.4556
Average Train Accuracy: 0.6447
 Site-photo                     (1) | Val  Loss: 0.9673 | Val  Acc: 0.9000
 Site-photo                     (1) | Val  Loss: 0.9805 | Val  Acc: 0.8967
 Site-art_painting              (1) | Val  Loss: 1.1996 | Val  Acc: 0.7700
 Site-art_painting              (1) | Val  Loss: 1.2408 | Val  Acc: 0.7100
 Site-cartoon                   (2) | Val  Loss: 1.4100 | Val  Acc: 0.6000
 Site-cartoon                   (2) | Val  Loss: 1.3532 | Val  Acc: 0.6433
 Site-sketch                    (0) | Val  Loss: 1.4269 | Val  Acc: 0.5200
 Site-sketch                    (0) | Val  Loss: 1.4664 | Val  Acc: 0.4700
Average Valid Accuracy: 0.6887
 Best site-photo                    (1)  | Epoch:2 | Val Acc: 0.9000
 Best site-photo                    (1)  | Epoch:2 | Val Acc: 0.8967
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.7700
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.7100
 Best site-cartoon                  (2)  | Epoch:2 | Val Acc: 0.6000
 Best site-cartoon                  (2)  | Epoch:2 | Val Acc: 0.6433
 Best site-sketch                   (0)  | Epoch:2 | Val Acc: 0.5200
 Best site-sketch                   (0)  | Epoch:2 | Val Acc: 0.4700
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 4, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (1) | Train Loss: 0.8309 | Train Acc: 0.9333
 Site-photo                     (1) | Train Loss: 0.7633 | Train Acc: 0.9489
 Site-art_painting              (1) | Train Loss: 1.1432 | Train Acc: 0.6933
 Site-art_painting              (1) | Train Loss: 1.1881 | Train Acc: 0.7756
 Site-cartoon                   (2) | Train Loss: 1.2649 | Train Acc: 0.6333
 Site-cartoon                   (2) | Train Loss: 1.1372 | Train Acc: 0.6889
 Site-sketch                    (0) | Train Loss: 1.4267 | Train Acc: 0.4600
 Site-sketch                    (0) | Train Loss: 1.3143 | Train Acc: 0.5378
Average Train Accuracy: 0.7089
 Site-photo                     (1) | Val  Loss: 0.7554 | Val  Acc: 0.9400
 Site-photo                     (1) | Val  Loss: 0.7698 | Val  Acc: 0.9533
 Site-art_painting              (1) | Val  Loss: 1.0223 | Val  Acc: 0.8600
 Site-art_painting              (1) | Val  Loss: 1.0898 | Val  Acc: 0.7767
 Site-cartoon                   (2) | Val  Loss: 1.2082 | Val  Acc: 0.7100
 Site-cartoon                   (2) | Val  Loss: 1.1891 | Val  Acc: 0.6767
 Site-sketch                    (0) | Val  Loss: 1.3290 | Val  Acc: 0.4700
 Site-sketch                    (0) | Val  Loss: 1.3277 | Val  Acc: 0.5133
Average Valid Accuracy: 0.7375
 Best site-photo                    (1)  | Epoch:3 | Val Acc: 0.9400
 Best site-photo                    (1)  | Epoch:3 | Val Acc: 0.9533
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.8600
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.7767
 Best site-cartoon                  (2)  | Epoch:3 | Val Acc: 0.7100
 Best site-cartoon                  (2)  | Epoch:3 | Val Acc: 0.6767
 Best site-sketch                   (0)  | Epoch:3 | Val Acc: 0.4700
 Best site-sketch                   (0)  | Epoch:3 | Val Acc: 0.5133
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 4, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (1) | Train Loss: 0.6940 | Train Acc: 0.9400
 Site-photo                     (1) | Train Loss: 0.6415 | Train Acc: 0.9689
 Site-art_painting              (1) | Train Loss: 1.0050 | Train Acc: 0.7600
 Site-art_painting              (1) | Train Loss: 0.9771 | Train Acc: 0.8200
 Site-cartoon                   (2) | Train Loss: 1.0905 | Train Acc: 0.7000
 Site-cartoon                   (2) | Train Loss: 0.9840 | Train Acc: 0.6889
 Site-sketch                    (0) | Train Loss: 1.2179 | Train Acc: 0.5867
 Site-sketch                    (0) | Train Loss: 1.1379 | Train Acc: 0.5956
Average Train Accuracy: 0.7575
 Site-photo                     (1) | Val  Loss: 0.6140 | Val  Acc: 0.9500
 Site-photo                     (1) | Val  Loss: 0.6540 | Val  Acc: 0.9467
 Site-art_painting              (1) | Val  Loss: 0.9329 | Val  Acc: 0.8300
 Site-art_painting              (1) | Val  Loss: 0.8959 | Val  Acc: 0.8200
 Site-cartoon                   (2) | Val  Loss: 1.0479 | Val  Acc: 0.6800
 Site-cartoon                   (2) | Val  Loss: 1.0289 | Val  Acc: 0.7167
 Site-sketch                    (0) | Val  Loss: 1.1383 | Val  Acc: 0.6600
 Site-sketch                    (0) | Val  Loss: 1.1808 | Val  Acc: 0.6000
Average Valid Accuracy: 0.7754
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.9500
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.9467
 Best site-art_painting             (1)  | Epoch:4 | Val Acc: 0.8300
 Best site-art_painting             (1)  | Epoch:4 | Val Acc: 0.8200
 Best site-cartoon                  (2)  | Epoch:4 | Val Acc: 0.6800
 Best site-cartoon                  (2)  | Epoch:4 | Val Acc: 0.7167
 Best site-sketch                   (0)  | Epoch:4 | Val Acc: 0.6600
 Best site-sketch                   (0)  | Epoch:4 | Val Acc: 0.6000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 2, 4, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (2) | Train Loss: 0.5973 | Train Acc: 0.9600
 Site-photo                     (2) | Train Loss: 0.5227 | Train Acc: 0.9578
 Site-art_painting              (2) | Train Loss: 0.8491 | Train Acc: 0.8267
 Site-art_painting              (2) | Train Loss: 0.8159 | Train Acc: 0.8422
 Site-cartoon                   (0) | Train Loss: 0.9817 | Train Acc: 0.7200
 Site-cartoon                   (0) | Train Loss: 0.9252 | Train Acc: 0.7467
 Site-sketch                    (1) | Train Loss: 1.1090 | Train Acc: 0.6200
 Site-sketch                    (1) | Train Loss: 1.1011 | Train Acc: 0.6533
Average Train Accuracy: 0.7908
 Site-photo                     (2) | Val  Loss: 0.4912 | Val  Acc: 0.9300
 Site-photo                     (2) | Val  Loss: 0.5437 | Val  Acc: 0.9500
 Site-art_painting              (2) | Val  Loss: 0.8044 | Val  Acc: 0.8700
 Site-art_painting              (2) | Val  Loss: 0.8147 | Val  Acc: 0.8200
 Site-cartoon                   (0) | Val  Loss: 0.9296 | Val  Acc: 0.7100
 Site-cartoon                   (0) | Val  Loss: 0.9360 | Val  Acc: 0.7300
 Site-sketch                    (1) | Val  Loss: 1.0921 | Val  Acc: 0.6100
 Site-sketch                    (1) | Val  Loss: 1.0450 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7858
 Best site-photo                    (2)  | Epoch:5 | Val Acc: 0.9300
 Best site-photo                    (2)  | Epoch:5 | Val Acc: 0.9500
 Best site-art_painting             (2)  | Epoch:5 | Val Acc: 0.8700
 Best site-art_painting             (2)  | Epoch:5 | Val Acc: 0.8200
 Best site-cartoon                  (0)  | Epoch:5 | Val Acc: 0.7100
 Best site-cartoon                  (0)  | Epoch:5 | Val Acc: 0.7300
 Best site-sketch                   (1)  | Epoch:5 | Val Acc: 0.6100
 Best site-sketch                   (1)  | Epoch:5 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 4, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (1) | Train Loss: 0.4843 | Train Acc: 0.9600
 Site-photo                     (1) | Train Loss: 0.4305 | Train Acc: 0.9689
 Site-art_painting              (1) | Train Loss: 0.8131 | Train Acc: 0.8400
 Site-art_painting              (1) | Train Loss: 0.6799 | Train Acc: 0.8689
 Site-cartoon                   (0) | Train Loss: 0.8070 | Train Acc: 0.7533
 Site-cartoon                   (0) | Train Loss: 0.7698 | Train Acc: 0.7756
 Site-sketch                    (2) | Train Loss: 0.9911 | Train Acc: 0.7067
 Site-sketch                    (2) | Train Loss: 1.0447 | Train Acc: 0.6889
Average Train Accuracy: 0.8203
 Site-photo                     (1) | Val  Loss: 0.4321 | Val  Acc: 0.9700
 Site-photo                     (1) | Val  Loss: 0.4535 | Val  Acc: 0.9667
 Site-art_painting              (1) | Val  Loss: 0.7473 | Val  Acc: 0.8600
 Site-art_painting              (1) | Val  Loss: 0.7240 | Val  Acc: 0.8567
 Site-cartoon                   (0) | Val  Loss: 0.8053 | Val  Acc: 0.8100
 Site-cartoon                   (0) | Val  Loss: 0.8442 | Val  Acc: 0.7667
 Site-sketch                    (2) | Val  Loss: 0.9966 | Val  Acc: 0.6200
 Site-sketch                    (2) | Val  Loss: 0.9668 | Val  Acc: 0.6967
Average Valid Accuracy: 0.8183
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9700
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9667
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.8600
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.8567
 Best site-cartoon                  (0)  | Epoch:6 | Val Acc: 0.8100
 Best site-cartoon                  (0)  | Epoch:6 | Val Acc: 0.7667
 Best site-sketch                   (2)  | Epoch:6 | Val Acc: 0.6200
 Best site-sketch                   (2)  | Epoch:6 | Val Acc: 0.6967
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 7 ============
cnt=[4, 2, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (0) | Train Loss: 0.4460 | Train Acc: 0.9600
 Site-photo                     (0) | Train Loss: 0.4095 | Train Acc: 0.9644
 Site-art_painting              (0) | Train Loss: 0.7130 | Train Acc: 0.8600
 Site-art_painting              (0) | Train Loss: 0.6430 | Train Acc: 0.8578
 Site-cartoon                   (2) | Train Loss: 0.8458 | Train Acc: 0.7867
 Site-cartoon                   (2) | Train Loss: 0.7645 | Train Acc: 0.8000
 Site-sketch                    (1) | Train Loss: 0.8537 | Train Acc: 0.7667
 Site-sketch                    (1) | Train Loss: 0.9204 | Train Acc: 0.7178
Average Train Accuracy: 0.8392
 Site-photo                     (0) | Val  Loss: 0.3851 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.3867 | Val  Acc: 0.9633
 Site-art_painting              (0) | Val  Loss: 0.6565 | Val  Acc: 0.8900
 Site-art_painting              (0) | Val  Loss: 0.6431 | Val  Acc: 0.8600
 Site-cartoon                   (2) | Val  Loss: 0.8202 | Val  Acc: 0.7100
 Site-cartoon                   (2) | Val  Loss: 0.7543 | Val  Acc: 0.7967
 Site-sketch                    (1) | Val  Loss: 0.8614 | Val  Acc: 0.7100
 Site-sketch                    (1) | Val  Loss: 0.8788 | Val  Acc: 0.7300
Average Valid Accuracy: 0.8275
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9600
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9633
 Best site-art_painting             (0)  | Epoch:7 | Val Acc: 0.8900
 Best site-art_painting             (0)  | Epoch:7 | Val Acc: 0.8600
 Best site-cartoon                  (2)  | Epoch:7 | Val Acc: 0.7100
 Best site-cartoon                  (2)  | Epoch:7 | Val Acc: 0.7967
 Best site-sketch                   (1)  | Epoch:7 | Val Acc: 0.7100
 Best site-sketch                   (1)  | Epoch:7 | Val Acc: 0.7300
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 2, 4, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (2) | Train Loss: 0.4104 | Train Acc: 0.9533
 Site-photo                     (2) | Train Loss: 0.3256 | Train Acc: 0.9689
 Site-art_painting              (2) | Train Loss: 0.6983 | Train Acc: 0.8267
 Site-art_painting              (2) | Train Loss: 0.6810 | Train Acc: 0.8778
 Site-cartoon                   (0) | Train Loss: 0.7390 | Train Acc: 0.7800
 Site-cartoon                   (0) | Train Loss: 0.5981 | Train Acc: 0.8267
 Site-sketch                    (1) | Train Loss: 0.8826 | Train Acc: 0.7267
 Site-sketch                    (1) | Train Loss: 0.8099 | Train Acc: 0.7622
Average Train Accuracy: 0.8403
 Site-photo                     (2) | Val  Loss: 0.3712 | Val  Acc: 0.9500
 Site-photo                     (2) | Val  Loss: 0.3692 | Val  Acc: 0.9667
 Site-art_painting              (2) | Val  Loss: 0.6320 | Val  Acc: 0.8800
 Site-art_painting              (2) | Val  Loss: 0.6441 | Val  Acc: 0.8800
 Site-cartoon                   (0) | Val  Loss: 0.7218 | Val  Acc: 0.7900
 Site-cartoon                   (0) | Val  Loss: 0.6951 | Val  Acc: 0.8100
 Site-sketch                    (1) | Val  Loss: 0.8460 | Val  Acc: 0.6400
 Site-sketch                    (1) | Val  Loss: 0.8464 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8271
============ Train epoch 9 ============
cnt=[4, 2, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (0) | Train Loss: 0.3252 | Train Acc: 0.9667
 Site-photo                     (0) | Train Loss: 0.3371 | Train Acc: 0.9689
 Site-art_painting              (0) | Train Loss: 0.6713 | Train Acc: 0.8400
 Site-art_painting              (0) | Train Loss: 0.6495 | Train Acc: 0.8867
 Site-cartoon                   (2) | Train Loss: 0.6546 | Train Acc: 0.8267
 Site-cartoon                   (2) | Train Loss: 0.6106 | Train Acc: 0.8222
 Site-sketch                    (1) | Train Loss: 0.8063 | Train Acc: 0.7533
 Site-sketch                    (1) | Train Loss: 0.7194 | Train Acc: 0.7533
Average Train Accuracy: 0.8522
 Site-photo                     (0) | Val  Loss: 0.3319 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.3334 | Val  Acc: 0.9700
 Site-art_painting              (0) | Val  Loss: 0.6033 | Val  Acc: 0.8800
 Site-art_painting              (0) | Val  Loss: 0.5827 | Val  Acc: 0.8633
 Site-cartoon                   (2) | Val  Loss: 0.6551 | Val  Acc: 0.8400
 Site-cartoon                   (2) | Val  Loss: 0.6324 | Val  Acc: 0.8300
 Site-sketch                    (1) | Val  Loss: 0.7656 | Val  Acc: 0.7300
 Site-sketch                    (1) | Val  Loss: 0.7897 | Val  Acc: 0.7633
Average Valid Accuracy: 0.8546
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9600
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9700
 Best site-art_painting             (0)  | Epoch:9 | Val Acc: 0.8800
 Best site-art_painting             (0)  | Epoch:9 | Val Acc: 0.8633
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.8400
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.8300
 Best site-sketch                   (1)  | Epoch:9 | Val Acc: 0.7300
 Best site-sketch                   (1)  | Epoch:9 | Val Acc: 0.7633
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 10 ============
cnt=[4, 2, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (0) | Train Loss: 0.3267 | Train Acc: 0.9667
 Site-photo                     (0) | Train Loss: 0.3328 | Train Acc: 0.9733
 Site-art_painting              (0) | Train Loss: 0.5621 | Train Acc: 0.8467
 Site-art_painting              (0) | Train Loss: 0.4838 | Train Acc: 0.8822
 Site-cartoon                   (2) | Train Loss: 0.6377 | Train Acc: 0.7867
 Site-cartoon                   (2) | Train Loss: 0.6965 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.7289 | Train Acc: 0.7600
 Site-sketch                    (1) | Train Loss: 0.6950 | Train Acc: 0.7689
Average Train Accuracy: 0.8506
 Site-photo                     (0) | Val  Loss: 0.2767 | Val  Acc: 0.9500
 Site-photo                     (0) | Val  Loss: 0.2896 | Val  Acc: 0.9733
 Site-art_painting              (0) | Val  Loss: 0.5297 | Val  Acc: 0.9000
 Site-art_painting              (0) | Val  Loss: 0.5204 | Val  Acc: 0.8933
 Site-cartoon                   (2) | Val  Loss: 0.6758 | Val  Acc: 0.7600
 Site-cartoon                   (2) | Val  Loss: 0.6539 | Val  Acc: 0.7900
 Site-sketch                    (1) | Val  Loss: 0.7131 | Val  Acc: 0.7600
 Site-sketch                    (1) | Val  Loss: 0.7624 | Val  Acc: 0.7400
Average Valid Accuracy: 0.8458
============ Train epoch 11 ============
cnt=[2, 2, 4, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (2) | Train Loss: 0.2703 | Train Acc: 0.9533
 Site-photo                     (2) | Train Loss: 0.2695 | Train Acc: 0.9667
 Site-art_painting              (2) | Train Loss: 0.5977 | Train Acc: 0.8800
 Site-art_painting              (2) | Train Loss: 0.4997 | Train Acc: 0.8778
 Site-cartoon                   (0) | Train Loss: 0.5568 | Train Acc: 0.8400
 Site-cartoon                   (0) | Train Loss: 0.5009 | Train Acc: 0.8400
 Site-sketch                    (1) | Train Loss: 0.7669 | Train Acc: 0.7733
 Site-sketch                    (1) | Train Loss: 0.6702 | Train Acc: 0.7756
Average Train Accuracy: 0.8633
 Site-photo                     (2) | Val  Loss: 0.3015 | Val  Acc: 0.9500
 Site-photo                     (2) | Val  Loss: 0.2845 | Val  Acc: 0.9667
 Site-art_painting              (2) | Val  Loss: 0.5231 | Val  Acc: 0.9000
 Site-art_painting              (2) | Val  Loss: 0.5319 | Val  Acc: 0.8867
 Site-cartoon                   (0) | Val  Loss: 0.6210 | Val  Acc: 0.7900
 Site-cartoon                   (0) | Val  Loss: 0.5749 | Val  Acc: 0.8267
 Site-sketch                    (1) | Val  Loss: 0.7092 | Val  Acc: 0.7700
 Site-sketch                    (1) | Val  Loss: 0.6998 | Val  Acc: 0.8033
Average Valid Accuracy: 0.8617
 Best site-photo                    (2)  | Epoch:11 | Val Acc: 0.9500
 Best site-photo                    (2)  | Epoch:11 | Val Acc: 0.9667
 Best site-art_painting             (2)  | Epoch:11 | Val Acc: 0.9000
 Best site-art_painting             (2)  | Epoch:11 | Val Acc: 0.8867
 Best site-cartoon                  (0)  | Epoch:11 | Val Acc: 0.7900
 Best site-cartoon                  (0)  | Epoch:11 | Val Acc: 0.8267
 Best site-sketch                   (1)  | Epoch:11 | Val Acc: 0.7700
 Best site-sketch                   (1)  | Epoch:11 | Val Acc: 0.8033
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 12 ============
cnt=[4, 2, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (0) | Train Loss: 0.2364 | Train Acc: 0.9733
 Site-photo                     (0) | Train Loss: 0.2508 | Train Acc: 0.9733
 Site-art_painting              (0) | Train Loss: 0.5654 | Train Acc: 0.8600
 Site-art_painting              (0) | Train Loss: 0.6038 | Train Acc: 0.8911
 Site-cartoon                   (2) | Train Loss: 0.6570 | Train Acc: 0.8267
 Site-cartoon                   (2) | Train Loss: 0.5569 | Train Acc: 0.8289
 Site-sketch                    (1) | Train Loss: 0.7061 | Train Acc: 0.7267
 Site-sketch                    (1) | Train Loss: 0.7183 | Train Acc: 0.7844
Average Train Accuracy: 0.8581
 Site-photo                     (0) | Val  Loss: 0.2358 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.2333 | Val  Acc: 0.9700
 Site-art_painting              (0) | Val  Loss: 0.5018 | Val  Acc: 0.8600
 Site-art_painting              (0) | Val  Loss: 0.5180 | Val  Acc: 0.8600
 Site-cartoon                   (2) | Val  Loss: 0.6005 | Val  Acc: 0.8300
 Site-cartoon                   (2) | Val  Loss: 0.5641 | Val  Acc: 0.8300
 Site-sketch                    (1) | Val  Loss: 0.7042 | Val  Acc: 0.7500
 Site-sketch                    (1) | Val  Loss: 0.7069 | Val  Acc: 0.7633
Average Valid Accuracy: 0.8529
============ Train epoch 13 ============
cnt=[2, 4, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (1) | Train Loss: 0.2529 | Train Acc: 0.9667
 Site-photo                     (1) | Train Loss: 0.2028 | Train Acc: 0.9800
 Site-art_painting              (1) | Train Loss: 0.5226 | Train Acc: 0.8667
 Site-art_painting              (1) | Train Loss: 0.4220 | Train Acc: 0.9000
 Site-cartoon                   (2) | Train Loss: 0.5873 | Train Acc: 0.8200
 Site-cartoon                   (2) | Train Loss: 0.4941 | Train Acc: 0.8489
 Site-sketch                    (0) | Train Loss: 0.6523 | Train Acc: 0.7800
 Site-sketch                    (0) | Train Loss: 0.6187 | Train Acc: 0.7711
Average Train Accuracy: 0.8667
 Site-photo                     (1) | Val  Loss: 0.2599 | Val  Acc: 0.9500
 Site-photo                     (1) | Val  Loss: 0.2329 | Val  Acc: 0.9733
 Site-art_painting              (1) | Val  Loss: 0.5335 | Val  Acc: 0.8600
 Site-art_painting              (1) | Val  Loss: 0.4519 | Val  Acc: 0.8900
 Site-cartoon                   (2) | Val  Loss: 0.5738 | Val  Acc: 0.8100
 Site-cartoon                   (2) | Val  Loss: 0.5448 | Val  Acc: 0.8200
 Site-sketch                    (0) | Val  Loss: 0.6513 | Val  Acc: 0.7700
 Site-sketch                    (0) | Val  Loss: 0.6632 | Val  Acc: 0.7633
Average Valid Accuracy: 0.8546
============ Train epoch 14 ============
cnt=[4, 2, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (0) | Train Loss: 0.2166 | Train Acc: 0.9800
 Site-photo                     (0) | Train Loss: 0.1918 | Train Acc: 0.9733
 Site-art_painting              (0) | Train Loss: 0.4794 | Train Acc: 0.8733
 Site-art_painting              (0) | Train Loss: 0.5143 | Train Acc: 0.8822
 Site-cartoon                   (2) | Train Loss: 0.5593 | Train Acc: 0.8067
 Site-cartoon                   (2) | Train Loss: 0.4605 | Train Acc: 0.8533
 Site-sketch                    (1) | Train Loss: 0.6613 | Train Acc: 0.8067
 Site-sketch                    (1) | Train Loss: 0.6268 | Train Acc: 0.7667
Average Train Accuracy: 0.8678
 Site-photo                     (0) | Val  Loss: 0.2197 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.2132 | Val  Acc: 0.9633
 Site-art_painting              (0) | Val  Loss: 0.4579 | Val  Acc: 0.8700
 Site-art_painting              (0) | Val  Loss: 0.4438 | Val  Acc: 0.8933
 Site-cartoon                   (2) | Val  Loss: 0.5478 | Val  Acc: 0.8100
 Site-cartoon                   (2) | Val  Loss: 0.4818 | Val  Acc: 0.8733
 Site-sketch                    (1) | Val  Loss: 0.6034 | Val  Acc: 0.7900
 Site-sketch                    (1) | Val  Loss: 0.6577 | Val  Acc: 0.7467
Average Valid Accuracy: 0.8633
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9600
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9633
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.8700
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.8933
 Best site-cartoon                  (2)  | Epoch:14 | Val Acc: 0.8100
 Best site-cartoon                  (2)  | Epoch:14 | Val Acc: 0.8733
 Best site-sketch                   (1)  | Epoch:14 | Val Acc: 0.7900
 Best site-sketch                   (1)  | Epoch:14 | Val Acc: 0.7467
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 2, 4, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (2) | Train Loss: 0.1930 | Train Acc: 0.9867
 Site-photo                     (2) | Train Loss: 0.1853 | Train Acc: 0.9733
 Site-art_painting              (2) | Train Loss: 0.4803 | Train Acc: 0.8600
 Site-art_painting              (2) | Train Loss: 0.3824 | Train Acc: 0.9044
 Site-cartoon                   (0) | Train Loss: 0.5379 | Train Acc: 0.8267
 Site-cartoon                   (0) | Train Loss: 0.4414 | Train Acc: 0.8467
 Site-sketch                    (1) | Train Loss: 0.6385 | Train Acc: 0.8000
 Site-sketch                    (1) | Train Loss: 0.5661 | Train Acc: 0.7822
Average Train Accuracy: 0.8725
 Site-photo                     (2) | Val  Loss: 0.2457 | Val  Acc: 0.9500
 Site-photo                     (2) | Val  Loss: 0.2061 | Val  Acc: 0.9700
 Site-art_painting              (2) | Val  Loss: 0.4348 | Val  Acc: 0.8800
 Site-art_painting              (2) | Val  Loss: 0.4535 | Val  Acc: 0.8933
 Site-cartoon                   (0) | Val  Loss: 0.5833 | Val  Acc: 0.7700
 Site-cartoon                   (0) | Val  Loss: 0.4957 | Val  Acc: 0.8533
 Site-sketch                    (1) | Val  Loss: 0.6223 | Val  Acc: 0.7800
 Site-sketch                    (1) | Val  Loss: 0.6465 | Val  Acc: 0.8133
Average Valid Accuracy: 0.8638
 Best site-photo                    (2)  | Epoch:15 | Val Acc: 0.9500
 Best site-photo                    (2)  | Epoch:15 | Val Acc: 0.9700
 Best site-art_painting             (2)  | Epoch:15 | Val Acc: 0.8800
 Best site-art_painting             (2)  | Epoch:15 | Val Acc: 0.8933
 Best site-cartoon                  (0)  | Epoch:15 | Val Acc: 0.7700
 Best site-cartoon                  (0)  | Epoch:15 | Val Acc: 0.8533
 Best site-sketch                   (1)  | Epoch:15 | Val Acc: 0.7800
 Best site-sketch                   (1)  | Epoch:15 | Val Acc: 0.8133
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 16 ============
cnt=[2, 2, 4, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (2) | Train Loss: 0.2308 | Train Acc: 0.9667
 Site-photo                     (2) | Train Loss: 0.1752 | Train Acc: 0.9756
 Site-art_painting              (2) | Train Loss: 0.5163 | Train Acc: 0.8467
 Site-art_painting              (2) | Train Loss: 0.4227 | Train Acc: 0.8911
 Site-cartoon                   (0) | Train Loss: 0.5216 | Train Acc: 0.8467
 Site-cartoon                   (0) | Train Loss: 0.4045 | Train Acc: 0.8689
 Site-sketch                    (1) | Train Loss: 0.6695 | Train Acc: 0.7600
 Site-sketch                    (1) | Train Loss: 0.5840 | Train Acc: 0.7756
Average Train Accuracy: 0.8664
 Site-photo                     (2) | Val  Loss: 0.2121 | Val  Acc: 0.9700
 Site-photo                     (2) | Val  Loss: 0.2057 | Val  Acc: 0.9667
 Site-art_painting              (2) | Val  Loss: 0.4921 | Val  Acc: 0.8500
 Site-art_painting              (2) | Val  Loss: 0.4773 | Val  Acc: 0.8800
 Site-cartoon                   (0) | Val  Loss: 0.5504 | Val  Acc: 0.8300
 Site-cartoon                   (0) | Val  Loss: 0.4726 | Val  Acc: 0.8500
 Site-sketch                    (1) | Val  Loss: 0.6518 | Val  Acc: 0.7500
 Site-sketch                    (1) | Val  Loss: 0.5874 | Val  Acc: 0.8033
Average Valid Accuracy: 0.8625
============ Train epoch 17 ============
cnt=[2, 2, 4, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (2) | Train Loss: 0.2433 | Train Acc: 0.9467
 Site-photo                     (2) | Train Loss: 0.2230 | Train Acc: 0.9689
 Site-art_painting              (2) | Train Loss: 0.5323 | Train Acc: 0.8800
 Site-art_painting              (2) | Train Loss: 0.4077 | Train Acc: 0.8978
 Site-cartoon                   (0) | Train Loss: 0.4993 | Train Acc: 0.8733
 Site-cartoon                   (0) | Train Loss: 0.4525 | Train Acc: 0.8689
 Site-sketch                    (1) | Train Loss: 0.5942 | Train Acc: 0.7733
 Site-sketch                    (1) | Train Loss: 0.5387 | Train Acc: 0.7800
Average Train Accuracy: 0.8736
 Site-photo                     (2) | Val  Loss: 0.1907 | Val  Acc: 0.9600
 Site-photo                     (2) | Val  Loss: 0.1996 | Val  Acc: 0.9700
 Site-art_painting              (2) | Val  Loss: 0.4514 | Val  Acc: 0.8800
 Site-art_painting              (2) | Val  Loss: 0.4226 | Val  Acc: 0.9000
 Site-cartoon                   (0) | Val  Loss: 0.4566 | Val  Acc: 0.8400
 Site-cartoon                   (0) | Val  Loss: 0.4573 | Val  Acc: 0.8533
 Site-sketch                    (1) | Val  Loss: 0.5483 | Val  Acc: 0.7900
 Site-sketch                    (1) | Val  Loss: 0.5993 | Val  Acc: 0.7867
Average Valid Accuracy: 0.8725
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9600
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9700
 Best site-art_painting             (2)  | Epoch:17 | Val Acc: 0.8800
 Best site-art_painting             (2)  | Epoch:17 | Val Acc: 0.9000
 Best site-cartoon                  (0)  | Epoch:17 | Val Acc: 0.8400
 Best site-cartoon                  (0)  | Epoch:17 | Val Acc: 0.8533
 Best site-sketch                   (1)  | Epoch:17 | Val Acc: 0.7900
 Best site-sketch                   (1)  | Epoch:17 | Val Acc: 0.7867
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 18 ============
cnt=[4, 2, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (0) | Train Loss: 0.1920 | Train Acc: 0.9667
 Site-photo                     (0) | Train Loss: 0.1745 | Train Acc: 0.9756
 Site-art_painting              (0) | Train Loss: 0.4497 | Train Acc: 0.8733
 Site-art_painting              (0) | Train Loss: 0.3833 | Train Acc: 0.8889
 Site-cartoon                   (2) | Train Loss: 0.4714 | Train Acc: 0.8733
 Site-cartoon                   (2) | Train Loss: 0.4795 | Train Acc: 0.8533
 Site-sketch                    (1) | Train Loss: 0.6479 | Train Acc: 0.7800
 Site-sketch                    (1) | Train Loss: 0.6190 | Train Acc: 0.7889
Average Train Accuracy: 0.8750
 Site-photo                     (0) | Val  Loss: 0.1847 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.1958 | Val  Acc: 0.9700
 Site-art_painting              (0) | Val  Loss: 0.4229 | Val  Acc: 0.8600
 Site-art_painting              (0) | Val  Loss: 0.4322 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.5141 | Val  Acc: 0.7900
 Site-cartoon                   (2) | Val  Loss: 0.4441 | Val  Acc: 0.8633
 Site-sketch                    (1) | Val  Loss: 0.5985 | Val  Acc: 0.7500
 Site-sketch                    (1) | Val  Loss: 0.6168 | Val  Acc: 0.7600
Average Valid Accuracy: 0.8542
============ Train epoch 19 ============
cnt=[2, 2, 4, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (2) | Train Loss: 0.1988 | Train Acc: 0.9733
 Site-photo                     (2) | Train Loss: 0.1653 | Train Acc: 0.9778
 Site-art_painting              (2) | Train Loss: 0.4032 | Train Acc: 0.8867
 Site-art_painting              (2) | Train Loss: 0.4574 | Train Acc: 0.8933
 Site-cartoon                   (0) | Train Loss: 0.4661 | Train Acc: 0.8600
 Site-cartoon                   (0) | Train Loss: 0.4318 | Train Acc: 0.8756
 Site-sketch                    (1) | Train Loss: 0.5331 | Train Acc: 0.8400
 Site-sketch                    (1) | Train Loss: 0.5794 | Train Acc: 0.7978
Average Train Accuracy: 0.8881
 Site-photo                     (2) | Val  Loss: 0.1786 | Val  Acc: 0.9700
 Site-photo                     (2) | Val  Loss: 0.1867 | Val  Acc: 0.9667
 Site-art_painting              (2) | Val  Loss: 0.3852 | Val  Acc: 0.8800
 Site-art_painting              (2) | Val  Loss: 0.3775 | Val  Acc: 0.9200
 Site-cartoon                   (0) | Val  Loss: 0.4780 | Val  Acc: 0.8000
 Site-cartoon                   (0) | Val  Loss: 0.4452 | Val  Acc: 0.8467
 Site-sketch                    (1) | Val  Loss: 0.5413 | Val  Acc: 0.8600
 Site-sketch                    (1) | Val  Loss: 0.5857 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8804
 Best site-photo                    (2)  | Epoch:19 | Val Acc: 0.9700
 Best site-photo                    (2)  | Epoch:19 | Val Acc: 0.9667
 Best site-art_painting             (2)  | Epoch:19 | Val Acc: 0.8800
 Best site-art_painting             (2)  | Epoch:19 | Val Acc: 0.9200
 Best site-cartoon                  (0)  | Epoch:19 | Val Acc: 0.8000
 Best site-cartoon                  (0)  | Epoch:19 | Val Acc: 0.8467
 Best site-sketch                   (1)  | Epoch:19 | Val Acc: 0.8600
 Best site-sketch                   (1)  | Epoch:19 | Val Acc: 0.8000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 20 ============
cnt=[4, 2, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (0) | Train Loss: 0.1792 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.1570 | Train Acc: 0.9800
 Site-art_painting              (0) | Train Loss: 0.4157 | Train Acc: 0.8733
 Site-art_painting              (0) | Train Loss: 0.3332 | Train Acc: 0.9222
 Site-cartoon                   (2) | Train Loss: 0.4066 | Train Acc: 0.8467
 Site-cartoon                   (2) | Train Loss: 0.4160 | Train Acc: 0.8689
 Site-sketch                    (1) | Train Loss: 0.4956 | Train Acc: 0.8133
 Site-sketch                    (1) | Train Loss: 0.5251 | Train Acc: 0.7978
Average Train Accuracy: 0.8861
 Site-photo                     (0) | Val  Loss: 0.1809 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.1827 | Val  Acc: 0.9667
 Site-art_painting              (0) | Val  Loss: 0.4600 | Val  Acc: 0.8700
 Site-art_painting              (0) | Val  Loss: 0.3746 | Val  Acc: 0.8933
 Site-cartoon                   (2) | Val  Loss: 0.4472 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.4365 | Val  Acc: 0.8300
 Site-sketch                    (1) | Val  Loss: 0.5279 | Val  Acc: 0.8100
 Site-sketch                    (1) | Val  Loss: 0.5998 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8750
============ Train epoch 21 ============
cnt=[2, 4, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (1) | Train Loss: 0.1439 | Train Acc: 0.9867
 Site-photo                     (1) | Train Loss: 0.1421 | Train Acc: 0.9822
 Site-art_painting              (1) | Train Loss: 0.4882 | Train Acc: 0.8467
 Site-art_painting              (1) | Train Loss: 0.3338 | Train Acc: 0.9111
 Site-cartoon                   (2) | Train Loss: 0.4251 | Train Acc: 0.8200
 Site-cartoon                   (2) | Train Loss: 0.4727 | Train Acc: 0.8667
 Site-sketch                    (0) | Train Loss: 0.5637 | Train Acc: 0.7867
 Site-sketch                    (0) | Train Loss: 0.6016 | Train Acc: 0.7956
Average Train Accuracy: 0.8744
 Site-photo                     (1) | Val  Loss: 0.1496 | Val  Acc: 0.9900
 Site-photo                     (1) | Val  Loss: 0.1512 | Val  Acc: 0.9767
 Site-art_painting              (1) | Val  Loss: 0.4231 | Val  Acc: 0.8800
 Site-art_painting              (1) | Val  Loss: 0.4031 | Val  Acc: 0.8833
 Site-cartoon                   (2) | Val  Loss: 0.4414 | Val  Acc: 0.8500
 Site-cartoon                   (2) | Val  Loss: 0.4233 | Val  Acc: 0.8633
 Site-sketch                    (0) | Val  Loss: 0.5369 | Val  Acc: 0.7700
 Site-sketch                    (0) | Val  Loss: 0.5834 | Val  Acc: 0.7900
Average Valid Accuracy: 0.8754
============ Train epoch 22 ============
cnt=[2, 2, 4, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (2) | Train Loss: 0.1633 | Train Acc: 0.9933
 Site-photo                     (2) | Train Loss: 0.1483 | Train Acc: 0.9778
 Site-art_painting              (2) | Train Loss: 0.4412 | Train Acc: 0.8867
 Site-art_painting              (2) | Train Loss: 0.4315 | Train Acc: 0.8956
 Site-cartoon                   (0) | Train Loss: 0.3868 | Train Acc: 0.9067
 Site-cartoon                   (0) | Train Loss: 0.4673 | Train Acc: 0.8889
 Site-sketch                    (1) | Train Loss: 0.5561 | Train Acc: 0.7867
 Site-sketch                    (1) | Train Loss: 0.4900 | Train Acc: 0.8022
Average Train Accuracy: 0.8922
 Site-photo                     (2) | Val  Loss: 0.1527 | Val  Acc: 0.9700
 Site-photo                     (2) | Val  Loss: 0.1549 | Val  Acc: 0.9733
 Site-art_painting              (2) | Val  Loss: 0.3334 | Val  Acc: 0.8900
 Site-art_painting              (2) | Val  Loss: 0.3722 | Val  Acc: 0.8867
 Site-cartoon                   (0) | Val  Loss: 0.4322 | Val  Acc: 0.8400
 Site-cartoon                   (0) | Val  Loss: 0.4045 | Val  Acc: 0.8633
 Site-sketch                    (1) | Val  Loss: 0.5152 | Val  Acc: 0.8200
 Site-sketch                    (1) | Val  Loss: 0.5796 | Val  Acc: 0.7800
Average Valid Accuracy: 0.8779
============ Train epoch 23 ============
cnt=[4, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (0) | Train Loss: 0.1610 | Train Acc: 0.9733
 Site-photo                     (0) | Train Loss: 0.1277 | Train Acc: 0.9867
 Site-art_painting              (0) | Train Loss: 0.3943 | Train Acc: 0.8733
 Site-art_painting              (0) | Train Loss: 0.3214 | Train Acc: 0.9022
 Site-cartoon                   (2) | Train Loss: 0.4003 | Train Acc: 0.8733
 Site-cartoon                   (2) | Train Loss: 0.3533 | Train Acc: 0.8800
 Site-sketch                    (1) | Train Loss: 0.6202 | Train Acc: 0.7867
 Site-sketch                    (1) | Train Loss: 0.4785 | Train Acc: 0.8067
Average Train Accuracy: 0.8853
 Site-photo                     (0) | Val  Loss: 0.1576 | Val  Acc: 0.9800
 Site-photo                     (0) | Val  Loss: 0.1648 | Val  Acc: 0.9700
 Site-art_painting              (0) | Val  Loss: 0.4196 | Val  Acc: 0.8500
 Site-art_painting              (0) | Val  Loss: 0.3449 | Val  Acc: 0.9067
 Site-cartoon                   (2) | Val  Loss: 0.3970 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.3779 | Val  Acc: 0.8733
 Site-sketch                    (1) | Val  Loss: 0.5456 | Val  Acc: 0.7600
 Site-sketch                    (1) | Val  Loss: 0.5706 | Val  Acc: 0.8167
Average Valid Accuracy: 0.8783
============ Train epoch 24 ============
cnt=[4, 2, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (0) | Train Loss: 0.1769 | Train Acc: 0.9800
 Site-photo                     (0) | Train Loss: 0.1325 | Train Acc: 0.9733
 Site-art_painting              (0) | Train Loss: 0.3970 | Train Acc: 0.8867
 Site-art_painting              (0) | Train Loss: 0.3195 | Train Acc: 0.9067
 Site-cartoon                   (2) | Train Loss: 0.4392 | Train Acc: 0.8733
 Site-cartoon                   (2) | Train Loss: 0.5684 | Train Acc: 0.8778
 Site-sketch                    (1) | Train Loss: 0.6720 | Train Acc: 0.7800
 Site-sketch                    (1) | Train Loss: 0.4969 | Train Acc: 0.7978
Average Train Accuracy: 0.8844
 Site-photo                     (0) | Val  Loss: 0.1653 | Val  Acc: 0.9800
 Site-photo                     (0) | Val  Loss: 0.1588 | Val  Acc: 0.9733
 Site-art_painting              (0) | Val  Loss: 0.3680 | Val  Acc: 0.8900
 Site-art_painting              (0) | Val  Loss: 0.3354 | Val  Acc: 0.9200
 Site-cartoon                   (2) | Val  Loss: 0.4128 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.3819 | Val  Acc: 0.8800
 Site-sketch                    (1) | Val  Loss: 0.5063 | Val  Acc: 0.8300
 Site-sketch                    (1) | Val  Loss: 0.5373 | Val  Acc: 0.8233
Average Valid Accuracy: 0.8971
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.9800
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.9733
 Best site-art_painting             (0)  | Epoch:24 | Val Acc: 0.8900
 Best site-art_painting             (0)  | Epoch:24 | Val Acc: 0.9200
 Best site-cartoon                  (2)  | Epoch:24 | Val Acc: 0.8800
 Best site-cartoon                  (2)  | Epoch:24 | Val Acc: 0.8800
 Best site-sketch                   (1)  | Epoch:24 | Val Acc: 0.8300
 Best site-sketch                   (1)  | Epoch:24 | Val Acc: 0.8233
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 25 ============
cnt=[4, 2, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (0) | Train Loss: 0.1779 | Train Acc: 0.9667
 Site-photo                     (0) | Train Loss: 0.1326 | Train Acc: 0.9733
 Site-art_painting              (0) | Train Loss: 0.4026 | Train Acc: 0.8667
 Site-art_painting              (0) | Train Loss: 0.3514 | Train Acc: 0.9000
 Site-cartoon                   (2) | Train Loss: 0.3877 | Train Acc: 0.8800
 Site-cartoon                   (2) | Train Loss: 0.3292 | Train Acc: 0.8933
 Site-sketch                    (1) | Train Loss: 0.5342 | Train Acc: 0.8067
 Site-sketch                    (1) | Train Loss: 0.6299 | Train Acc: 0.7956
Average Train Accuracy: 0.8853
 Site-photo                     (0) | Val  Loss: 0.1742 | Val  Acc: 0.9500
 Site-photo                     (0) | Val  Loss: 0.1642 | Val  Acc: 0.9667
 Site-art_painting              (0) | Val  Loss: 0.4335 | Val  Acc: 0.8600
 Site-art_painting              (0) | Val  Loss: 0.3708 | Val  Acc: 0.8867
 Site-cartoon                   (2) | Val  Loss: 0.3784 | Val  Acc: 0.8900
 Site-cartoon                   (2) | Val  Loss: 0.3291 | Val  Acc: 0.8967
 Site-sketch                    (1) | Val  Loss: 0.5444 | Val  Acc: 0.7500
 Site-sketch                    (1) | Val  Loss: 0.5443 | Val  Acc: 0.7867
Average Valid Accuracy: 0.8733
============ Train epoch 26 ============
cnt=[2, 4, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (1) | Train Loss: 0.1404 | Train Acc: 0.9867
 Site-photo                     (1) | Train Loss: 0.1292 | Train Acc: 0.9756
 Site-art_painting              (1) | Train Loss: 0.3847 | Train Acc: 0.8800
 Site-art_painting              (1) | Train Loss: 0.3994 | Train Acc: 0.9067
 Site-cartoon                   (2) | Train Loss: 0.4226 | Train Acc: 0.8867
 Site-cartoon                   (2) | Train Loss: 0.3093 | Train Acc: 0.8844
 Site-sketch                    (0) | Train Loss: 0.4922 | Train Acc: 0.8333
 Site-sketch                    (0) | Train Loss: 0.4714 | Train Acc: 0.8400
Average Train Accuracy: 0.8992
 Site-photo                     (1) | Val  Loss: 0.1531 | Val  Acc: 0.9800
 Site-photo                     (1) | Val  Loss: 0.1694 | Val  Acc: 0.9633
 Site-art_painting              (1) | Val  Loss: 0.4616 | Val  Acc: 0.8700
 Site-art_painting              (1) | Val  Loss: 0.3192 | Val  Acc: 0.9233
 Site-cartoon                   (2) | Val  Loss: 0.4348 | Val  Acc: 0.8500
 Site-cartoon                   (2) | Val  Loss: 0.3490 | Val  Acc: 0.9067
 Site-sketch                    (0) | Val  Loss: 0.4736 | Val  Acc: 0.8200
 Site-sketch                    (0) | Val  Loss: 0.5374 | Val  Acc: 0.8167
Average Valid Accuracy: 0.8913
============ Train epoch 27 ============
cnt=[2, 2, 4, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (2) | Train Loss: 0.1586 | Train Acc: 0.9667
 Site-photo                     (2) | Train Loss: 0.1119 | Train Acc: 0.9822
 Site-art_painting              (2) | Train Loss: 0.3898 | Train Acc: 0.8733
 Site-art_painting              (2) | Train Loss: 0.3589 | Train Acc: 0.9089
 Site-cartoon                   (0) | Train Loss: 0.4477 | Train Acc: 0.8667
 Site-cartoon                   (0) | Train Loss: 0.4264 | Train Acc: 0.8822
 Site-sketch                    (1) | Train Loss: 0.4692 | Train Acc: 0.8400
 Site-sketch                    (1) | Train Loss: 0.4593 | Train Acc: 0.8356
Average Train Accuracy: 0.8944
 Site-photo                     (2) | Val  Loss: 0.1675 | Val  Acc: 0.9700
 Site-photo                     (2) | Val  Loss: 0.1253 | Val  Acc: 0.9767
 Site-art_painting              (2) | Val  Loss: 0.3886 | Val  Acc: 0.8700
 Site-art_painting              (2) | Val  Loss: 0.3281 | Val  Acc: 0.8967
 Site-cartoon                   (0) | Val  Loss: 0.4126 | Val  Acc: 0.8300
 Site-cartoon                   (0) | Val  Loss: 0.3850 | Val  Acc: 0.8633
 Site-sketch                    (1) | Val  Loss: 0.5126 | Val  Acc: 0.7800
 Site-sketch                    (1) | Val  Loss: 0.5211 | Val  Acc: 0.7967
Average Valid Accuracy: 0.8729
============ Train epoch 28 ============
cnt=[2, 4, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (1) | Train Loss: 0.1361 | Train Acc: 0.9733
 Site-photo                     (1) | Train Loss: 0.1410 | Train Acc: 0.9778
 Site-art_painting              (1) | Train Loss: 0.3816 | Train Acc: 0.8867
 Site-art_painting              (1) | Train Loss: 0.3007 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.3671 | Train Acc: 0.9067
 Site-cartoon                   (2) | Train Loss: 0.3254 | Train Acc: 0.8978
 Site-sketch                    (0) | Train Loss: 0.5032 | Train Acc: 0.8533
 Site-sketch                    (0) | Train Loss: 0.5666 | Train Acc: 0.8222
Average Train Accuracy: 0.9047
 Site-photo                     (1) | Val  Loss: 0.1366 | Val  Acc: 0.9600
 Site-photo                     (1) | Val  Loss: 0.1391 | Val  Acc: 0.9767
 Site-art_painting              (1) | Val  Loss: 0.3077 | Val  Acc: 0.9300
 Site-art_painting              (1) | Val  Loss: 0.3191 | Val  Acc: 0.9067
 Site-cartoon                   (2) | Val  Loss: 0.3773 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.3360 | Val  Acc: 0.8800
 Site-sketch                    (0) | Val  Loss: 0.4551 | Val  Acc: 0.8200
 Site-sketch                    (0) | Val  Loss: 0.5027 | Val  Acc: 0.8300
Average Valid Accuracy: 0.8967
============ Train epoch 29 ============
cnt=[2, 2, 4, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (2) | Train Loss: 0.1750 | Train Acc: 0.9867
 Site-photo                     (2) | Train Loss: 0.1045 | Train Acc: 0.9756
 Site-art_painting              (2) | Train Loss: 0.3581 | Train Acc: 0.8800
 Site-art_painting              (2) | Train Loss: 0.3002 | Train Acc: 0.9067
 Site-cartoon                   (0) | Train Loss: 0.4315 | Train Acc: 0.8867
 Site-cartoon                   (0) | Train Loss: 0.3617 | Train Acc: 0.8889
 Site-sketch                    (1) | Train Loss: 0.5087 | Train Acc: 0.8267
 Site-sketch                    (1) | Train Loss: 0.4512 | Train Acc: 0.8267
Average Train Accuracy: 0.8972
 Site-photo                     (2) | Val  Loss: 0.1400 | Val  Acc: 0.9700
 Site-photo                     (2) | Val  Loss: 0.1274 | Val  Acc: 0.9667
 Site-art_painting              (2) | Val  Loss: 0.3681 | Val  Acc: 0.8700
 Site-art_painting              (2) | Val  Loss: 0.2922 | Val  Acc: 0.9100
 Site-cartoon                   (0) | Val  Loss: 0.3817 | Val  Acc: 0.8400
 Site-cartoon                   (0) | Val  Loss: 0.3444 | Val  Acc: 0.9000
 Site-sketch                    (1) | Val  Loss: 0.4932 | Val  Acc: 0.7800
 Site-sketch                    (1) | Val  Loss: 0.4802 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8838
============ Train epoch 30 ============
cnt=[4, 2, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (0) | Train Loss: 0.1197 | Train Acc: 0.9800
 Site-photo                     (0) | Train Loss: 0.1268 | Train Acc: 0.9844
 Site-art_painting              (0) | Train Loss: 0.4074 | Train Acc: 0.8733
 Site-art_painting              (0) | Train Loss: 0.2892 | Train Acc: 0.9000
 Site-cartoon                   (2) | Train Loss: 0.3681 | Train Acc: 0.8933
 Site-cartoon                   (2) | Train Loss: 0.2806 | Train Acc: 0.9044
 Site-sketch                    (1) | Train Loss: 0.4776 | Train Acc: 0.8067
 Site-sketch                    (1) | Train Loss: 0.4516 | Train Acc: 0.8222
Average Train Accuracy: 0.8956
 Site-photo                     (0) | Val  Loss: 0.1421 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.1419 | Val  Acc: 0.9700
 Site-art_painting              (0) | Val  Loss: 0.3230 | Val  Acc: 0.9100
 Site-art_painting              (0) | Val  Loss: 0.3173 | Val  Acc: 0.9067
 Site-cartoon                   (2) | Val  Loss: 0.3713 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.3298 | Val  Acc: 0.8967
 Site-sketch                    (1) | Val  Loss: 0.4192 | Val  Acc: 0.8400
 Site-sketch                    (1) | Val  Loss: 0.4877 | Val  Acc: 0.8467
Average Valid Accuracy: 0.9000
 Best site-photo                    (0)  | Epoch:30 | Val Acc: 0.9600
 Best site-photo                    (0)  | Epoch:30 | Val Acc: 0.9700
 Best site-art_painting             (0)  | Epoch:30 | Val Acc: 0.9100
 Best site-art_painting             (0)  | Epoch:30 | Val Acc: 0.9067
 Best site-cartoon                  (2)  | Epoch:30 | Val Acc: 0.8700
 Best site-cartoon                  (2)  | Epoch:30 | Val Acc: 0.8967
 Best site-sketch                   (1)  | Epoch:30 | Val Acc: 0.8400
 Best site-sketch                   (1)  | Epoch:30 | Val Acc: 0.8467
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 31 ============
cnt=[2, 4, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (1) | Train Loss: 0.1379 | Train Acc: 0.9667
 Site-photo                     (1) | Train Loss: 0.1069 | Train Acc: 0.9800
 Site-art_painting              (1) | Train Loss: 0.3037 | Train Acc: 0.9267
 Site-art_painting              (1) | Train Loss: 0.4694 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.3971 | Train Acc: 0.8600
 Site-cartoon                   (2) | Train Loss: 0.2965 | Train Acc: 0.9000
 Site-sketch                    (0) | Train Loss: 0.4880 | Train Acc: 0.8267
 Site-sketch                    (0) | Train Loss: 0.5147 | Train Acc: 0.8578
Average Train Accuracy: 0.9047
 Site-photo                     (1) | Val  Loss: 0.1522 | Val  Acc: 0.9600
 Site-photo                     (1) | Val  Loss: 0.1229 | Val  Acc: 0.9800
 Site-art_painting              (1) | Val  Loss: 0.3126 | Val  Acc: 0.8900
 Site-art_painting              (1) | Val  Loss: 0.2964 | Val  Acc: 0.9033
 Site-cartoon                   (2) | Val  Loss: 0.3640 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.3415 | Val  Acc: 0.9000
 Site-sketch                    (0) | Val  Loss: 0.4306 | Val  Acc: 0.8100
 Site-sketch                    (0) | Val  Loss: 0.4921 | Val  Acc: 0.8033
Average Valid Accuracy: 0.8908
============ Train epoch 32 ============
cnt=[2, 2, 4, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (2) | Train Loss: 0.1298 | Train Acc: 0.9800
 Site-photo                     (2) | Train Loss: 0.1043 | Train Acc: 0.9800
 Site-art_painting              (2) | Train Loss: 0.3229 | Train Acc: 0.8800
 Site-art_painting              (2) | Train Loss: 0.2930 | Train Acc: 0.9200
 Site-cartoon                   (0) | Train Loss: 0.3455 | Train Acc: 0.8800
 Site-cartoon                   (0) | Train Loss: 0.4299 | Train Acc: 0.9044
 Site-sketch                    (1) | Train Loss: 0.5635 | Train Acc: 0.7800
 Site-sketch                    (1) | Train Loss: 0.4534 | Train Acc: 0.8244
Average Train Accuracy: 0.8936
 Site-photo                     (2) | Val  Loss: 0.0933 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.1202 | Val  Acc: 0.9700
 Site-art_painting              (2) | Val  Loss: 0.3303 | Val  Acc: 0.8800
 Site-art_painting              (2) | Val  Loss: 0.2768 | Val  Acc: 0.9367
 Site-cartoon                   (0) | Val  Loss: 0.4101 | Val  Acc: 0.8600
 Site-cartoon                   (0) | Val  Loss: 0.3642 | Val  Acc: 0.8933
 Site-sketch                    (1) | Val  Loss: 0.4479 | Val  Acc: 0.8200
 Site-sketch                    (1) | Val  Loss: 0.4680 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8992
============ Train epoch 33 ============
cnt=[4, 2, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (0) | Train Loss: 0.1259 | Train Acc: 0.9800
 Site-photo                     (0) | Train Loss: 0.1505 | Train Acc: 0.9756
 Site-art_painting              (0) | Train Loss: 0.3638 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.3774 | Train Acc: 0.9022
 Site-cartoon                   (2) | Train Loss: 0.3660 | Train Acc: 0.8933
 Site-cartoon                   (2) | Train Loss: 0.2712 | Train Acc: 0.9156
 Site-sketch                    (1) | Train Loss: 0.5623 | Train Acc: 0.8267
 Site-sketch                    (1) | Train Loss: 0.5862 | Train Acc: 0.8222
Average Train Accuracy: 0.9019
 Site-photo                     (0) | Val  Loss: 0.1561 | Val  Acc: 0.9800
 Site-photo                     (0) | Val  Loss: 0.1311 | Val  Acc: 0.9800
 Site-art_painting              (0) | Val  Loss: 0.3677 | Val  Acc: 0.8700
 Site-art_painting              (0) | Val  Loss: 0.2870 | Val  Acc: 0.9233
 Site-cartoon                   (2) | Val  Loss: 0.3418 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.3337 | Val  Acc: 0.9067
 Site-sketch                    (1) | Val  Loss: 0.4879 | Val  Acc: 0.8200
 Site-sketch                    (1) | Val  Loss: 0.5093 | Val  Acc: 0.8167
Average Valid Accuracy: 0.8958
============ Train epoch 34 ============
cnt=[2, 2, 4, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (2) | Train Loss: 0.1428 | Train Acc: 0.9667
 Site-photo                     (2) | Train Loss: 0.1045 | Train Acc: 0.9756
 Site-art_painting              (2) | Train Loss: 0.2752 | Train Acc: 0.9067
 Site-art_painting              (2) | Train Loss: 0.3447 | Train Acc: 0.9244
 Site-cartoon                   (0) | Train Loss: 0.3394 | Train Acc: 0.8867
 Site-cartoon                   (0) | Train Loss: 0.3314 | Train Acc: 0.9067
 Site-sketch                    (1) | Train Loss: 0.5304 | Train Acc: 0.7867
 Site-sketch                    (1) | Train Loss: 0.4164 | Train Acc: 0.8356
Average Train Accuracy: 0.8986
 Site-photo                     (2) | Val  Loss: 0.1597 | Val  Acc: 0.9700
 Site-photo                     (2) | Val  Loss: 0.1206 | Val  Acc: 0.9800
 Site-art_painting              (2) | Val  Loss: 0.3644 | Val  Acc: 0.8500
 Site-art_painting              (2) | Val  Loss: 0.3106 | Val  Acc: 0.9167
 Site-cartoon                   (0) | Val  Loss: 0.3617 | Val  Acc: 0.8800
 Site-cartoon                   (0) | Val  Loss: 0.3121 | Val  Acc: 0.9067
 Site-sketch                    (1) | Val  Loss: 0.4630 | Val  Acc: 0.8700
 Site-sketch                    (1) | Val  Loss: 0.4640 | Val  Acc: 0.8367
Average Valid Accuracy: 0.9012
 Best site-photo                    (2)  | Epoch:34 | Val Acc: 0.9700
 Best site-photo                    (2)  | Epoch:34 | Val Acc: 0.9800
 Best site-art_painting             (2)  | Epoch:34 | Val Acc: 0.8500
 Best site-art_painting             (2)  | Epoch:34 | Val Acc: 0.9167
 Best site-cartoon                  (0)  | Epoch:34 | Val Acc: 0.8800
 Best site-cartoon                  (0)  | Epoch:34 | Val Acc: 0.9067
 Best site-sketch                   (1)  | Epoch:34 | Val Acc: 0.8700
 Best site-sketch                   (1)  | Epoch:34 | Val Acc: 0.8367
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 35 ============
cnt=[2, 2, 4, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (2) | Train Loss: 0.1183 | Train Acc: 0.9800
 Site-photo                     (2) | Train Loss: 0.1056 | Train Acc: 0.9800
 Site-art_painting              (2) | Train Loss: 0.3938 | Train Acc: 0.9067
 Site-art_painting              (2) | Train Loss: 0.2583 | Train Acc: 0.9178
 Site-cartoon                   (0) | Train Loss: 0.3084 | Train Acc: 0.9133
 Site-cartoon                   (0) | Train Loss: 0.3038 | Train Acc: 0.9022
 Site-sketch                    (1) | Train Loss: 0.4120 | Train Acc: 0.8600
 Site-sketch                    (1) | Train Loss: 0.4102 | Train Acc: 0.8200
Average Train Accuracy: 0.9100
 Site-photo                     (2) | Val  Loss: 0.1367 | Val  Acc: 0.9700
 Site-photo                     (2) | Val  Loss: 0.1161 | Val  Acc: 0.9733
 Site-art_painting              (2) | Val  Loss: 0.3284 | Val  Acc: 0.9100
 Site-art_painting              (2) | Val  Loss: 0.2767 | Val  Acc: 0.9233
 Site-cartoon                   (0) | Val  Loss: 0.3465 | Val  Acc: 0.8700
 Site-cartoon                   (0) | Val  Loss: 0.3270 | Val  Acc: 0.8867
 Site-sketch                    (1) | Val  Loss: 0.4213 | Val  Acc: 0.8300
 Site-sketch                    (1) | Val  Loss: 0.4585 | Val  Acc: 0.8467
Average Valid Accuracy: 0.9013
 Best site-photo                    (2)  | Epoch:35 | Val Acc: 0.9700
 Best site-photo                    (2)  | Epoch:35 | Val Acc: 0.9733
 Best site-art_painting             (2)  | Epoch:35 | Val Acc: 0.9100
 Best site-art_painting             (2)  | Epoch:35 | Val Acc: 0.9233
 Best site-cartoon                  (0)  | Epoch:35 | Val Acc: 0.8700
 Best site-cartoon                  (0)  | Epoch:35 | Val Acc: 0.8867
 Best site-sketch                   (1)  | Epoch:35 | Val Acc: 0.8300
 Best site-sketch                   (1)  | Epoch:35 | Val Acc: 0.8467
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 36 ============
cnt=[2, 4, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (1) | Train Loss: 0.0992 | Train Acc: 0.9733
 Site-photo                     (1) | Train Loss: 0.1034 | Train Acc: 0.9800
 Site-art_painting              (1) | Train Loss: 0.3302 | Train Acc: 0.9267
 Site-art_painting              (1) | Train Loss: 0.3835 | Train Acc: 0.9333
 Site-cartoon                   (2) | Train Loss: 0.3423 | Train Acc: 0.8800
 Site-cartoon                   (2) | Train Loss: 0.2842 | Train Acc: 0.8933
 Site-sketch                    (0) | Train Loss: 0.4746 | Train Acc: 0.8133
 Site-sketch                    (0) | Train Loss: 0.4207 | Train Acc: 0.8511
Average Train Accuracy: 0.9064
 Site-photo                     (1) | Val  Loss: 0.1489 | Val  Acc: 0.9600
 Site-photo                     (1) | Val  Loss: 0.1083 | Val  Acc: 0.9767
 Site-art_painting              (1) | Val  Loss: 0.2997 | Val  Acc: 0.9100
 Site-art_painting              (1) | Val  Loss: 0.2864 | Val  Acc: 0.9167
 Site-cartoon                   (2) | Val  Loss: 0.4188 | Val  Acc: 0.8100
 Site-cartoon                   (2) | Val  Loss: 0.3344 | Val  Acc: 0.8867
 Site-sketch                    (0) | Val  Loss: 0.4139 | Val  Acc: 0.8500
 Site-sketch                    (0) | Val  Loss: 0.4738 | Val  Acc: 0.8200
Average Valid Accuracy: 0.8912
============ Train epoch 37 ============
cnt=[4, 2, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (0) | Train Loss: 0.1569 | Train Acc: 0.9800
 Site-photo                     (0) | Train Loss: 0.0878 | Train Acc: 0.9778
 Site-art_painting              (0) | Train Loss: 0.3152 | Train Acc: 0.9267
 Site-art_painting              (0) | Train Loss: 0.3202 | Train Acc: 0.9333
 Site-cartoon                   (2) | Train Loss: 0.3644 | Train Acc: 0.9000
 Site-cartoon                   (2) | Train Loss: 0.3107 | Train Acc: 0.8800
 Site-sketch                    (1) | Train Loss: 0.5275 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.4865 | Train Acc: 0.8289
Average Train Accuracy: 0.9058
 Site-photo                     (0) | Val  Loss: 0.1094 | Val  Acc: 0.9800
 Site-photo                     (0) | Val  Loss: 0.1019 | Val  Acc: 0.9833
 Site-art_painting              (0) | Val  Loss: 0.3541 | Val  Acc: 0.8700
 Site-art_painting              (0) | Val  Loss: 0.2439 | Val  Acc: 0.9233
 Site-cartoon                   (2) | Val  Loss: 0.3809 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.3347 | Val  Acc: 0.8833
 Site-sketch                    (1) | Val  Loss: 0.4701 | Val  Acc: 0.8400
 Site-sketch                    (1) | Val  Loss: 0.4664 | Val  Acc: 0.8133
Average Valid Accuracy: 0.8992
============ Train epoch 38 ============
cnt=[4, 2, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (0) | Train Loss: 0.0978 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.0892 | Train Acc: 0.9800
 Site-art_painting              (0) | Train Loss: 0.3885 | Train Acc: 0.8867
 Site-art_painting              (0) | Train Loss: 0.2901 | Train Acc: 0.8933
 Site-cartoon                   (2) | Train Loss: 0.3179 | Train Acc: 0.9267
 Site-cartoon                   (2) | Train Loss: 0.3623 | Train Acc: 0.9111
 Site-sketch                    (1) | Train Loss: 0.4806 | Train Acc: 0.7933
 Site-sketch                    (1) | Train Loss: 0.4437 | Train Acc: 0.8489
Average Train Accuracy: 0.9033
 Site-photo                     (0) | Val  Loss: 0.1079 | Val  Acc: 0.9900
 Site-photo                     (0) | Val  Loss: 0.1132 | Val  Acc: 0.9833
 Site-art_painting              (0) | Val  Loss: 0.3050 | Val  Acc: 0.9000
 Site-art_painting              (0) | Val  Loss: 0.3041 | Val  Acc: 0.8933
 Site-cartoon                   (2) | Val  Loss: 0.3557 | Val  Acc: 0.8500
 Site-cartoon                   (2) | Val  Loss: 0.3200 | Val  Acc: 0.9000
 Site-sketch                    (1) | Val  Loss: 0.4324 | Val  Acc: 0.9000
 Site-sketch                    (1) | Val  Loss: 0.4769 | Val  Acc: 0.8267
Average Valid Accuracy: 0.9054
 Best site-photo                    (0)  | Epoch:38 | Val Acc: 0.9900
 Best site-photo                    (0)  | Epoch:38 | Val Acc: 0.9833
 Best site-art_painting             (0)  | Epoch:38 | Val Acc: 0.9000
 Best site-art_painting             (0)  | Epoch:38 | Val Acc: 0.8933
 Best site-cartoon                  (2)  | Epoch:38 | Val Acc: 0.8500
 Best site-cartoon                  (2)  | Epoch:38 | Val Acc: 0.9000
 Best site-sketch                   (1)  | Epoch:38 | Val Acc: 0.9000
 Best site-sketch                   (1)  | Epoch:38 | Val Acc: 0.8267
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 39 ============
cnt=[4, 2, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (0) | Train Loss: 0.1076 | Train Acc: 0.9733
 Site-photo                     (0) | Train Loss: 0.0886 | Train Acc: 0.9800
 Site-art_painting              (0) | Train Loss: 0.2856 | Train Acc: 0.8867
 Site-art_painting              (0) | Train Loss: 0.2781 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.3065 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.2625 | Train Acc: 0.8933
 Site-sketch                    (1) | Train Loss: 0.4648 | Train Acc: 0.8267
 Site-sketch                    (1) | Train Loss: 0.4313 | Train Acc: 0.8333
Average Train Accuracy: 0.9042
 Site-photo                     (0) | Val  Loss: 0.1030 | Val  Acc: 0.9700
 Site-photo                     (0) | Val  Loss: 0.1157 | Val  Acc: 0.9800
 Site-art_painting              (0) | Val  Loss: 0.3786 | Val  Acc: 0.8900
 Site-art_painting              (0) | Val  Loss: 0.2840 | Val  Acc: 0.9200
 Site-cartoon                   (2) | Val  Loss: 0.3193 | Val  Acc: 0.8900
 Site-cartoon                   (2) | Val  Loss: 0.2902 | Val  Acc: 0.9200
 Site-sketch                    (1) | Val  Loss: 0.4258 | Val  Acc: 0.8800
 Site-sketch                    (1) | Val  Loss: 0.4194 | Val  Acc: 0.8600
Average Valid Accuracy: 0.9137
 Best site-photo                    (0)  | Epoch:39 | Val Acc: 0.9700
 Best site-photo                    (0)  | Epoch:39 | Val Acc: 0.9800
 Best site-art_painting             (0)  | Epoch:39 | Val Acc: 0.8900
 Best site-art_painting             (0)  | Epoch:39 | Val Acc: 0.9200
 Best site-cartoon                  (2)  | Epoch:39 | Val Acc: 0.8900
 Best site-cartoon                  (2)  | Epoch:39 | Val Acc: 0.9200
 Best site-sketch                   (1)  | Epoch:39 | Val Acc: 0.8800
 Best site-sketch                   (1)  | Epoch:39 | Val Acc: 0.8600
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 40 ============
cnt=[4, 2, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (0) | Train Loss: 0.1293 | Train Acc: 0.9667
 Site-photo                     (0) | Train Loss: 0.1033 | Train Acc: 0.9733
 Site-art_painting              (0) | Train Loss: 0.3318 | Train Acc: 0.8533
 Site-art_painting              (0) | Train Loss: 0.2383 | Train Acc: 0.9289
 Site-cartoon                   (2) | Train Loss: 0.3602 | Train Acc: 0.9133
 Site-cartoon                   (2) | Train Loss: 0.2607 | Train Acc: 0.9022
 Site-sketch                    (1) | Train Loss: 0.5019 | Train Acc: 0.8467
 Site-sketch                    (1) | Train Loss: 0.3700 | Train Acc: 0.8644
Average Train Accuracy: 0.9061
 Site-photo                     (0) | Val  Loss: 0.1489 | Val  Acc: 0.9700
 Site-photo                     (0) | Val  Loss: 0.1260 | Val  Acc: 0.9733
 Site-art_painting              (0) | Val  Loss: 0.3156 | Val  Acc: 0.9100
 Site-art_painting              (0) | Val  Loss: 0.2709 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.3562 | Val  Acc: 0.8500
 Site-cartoon                   (2) | Val  Loss: 0.2726 | Val  Acc: 0.9100
 Site-sketch                    (1) | Val  Loss: 0.4130 | Val  Acc: 0.8900
 Site-sketch                    (1) | Val  Loss: 0.4690 | Val  Acc: 0.8433
Average Valid Accuracy: 0.9058
 Test site-photo                     (0)| Epoch:39 | Test Acc: 0.9925
 Test site-art_painting              (0)| Epoch:39 | Test Acc: 0.9147
 Test site-cartoon                   (2)| Epoch:39 | Test Acc: 0.8894
 Test site-sketch                    (1)| Epoch:39 | Test Acc: 0.8640
photo: 0.9925, art_painting: 0.9147, cartoon: 0.8894, sketch: 0.8640, 
Average Test Accuracy(group): 0.9152, Average Test Accuracy(individual): 0.9152,
domain std=0.0481, cluster std=0.0377, individual std=0.0481, 
===2023-08-10 19:18:35===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 3
Loading snapshots...
 Test site-photo                     (0)| Epoch:39 | Test Acc: 0.9910
 Test site-art_painting              (0)| Epoch:39 | Test Acc: 0.9111
 Test site-cartoon                   (2)| Epoch:39 | Test Acc: 0.8989
 Test site-sketch                    (1)| Epoch:39 | Test Acc: 0.8659
photo: 0.9910, art_painting: 0.9111, cartoon: 0.8989, sketch: 0.8659, 
Average Test Accuracy(group): 0.9168, Average Test Accuracy(individual): 0.9168,
domain std=0.0460, cluster std=0.0350, individual std=0.0460, 
