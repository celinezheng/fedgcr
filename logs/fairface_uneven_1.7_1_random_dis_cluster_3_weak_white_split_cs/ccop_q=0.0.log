===2023-06-16 09:55:11===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 70
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[142,242,413,702,1195,131,224,381,345,587,548,]
client_nums=[5,3,2,1,]
len_dataset=[7712,2112,2668,1569,]
domain number = 3
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-White-0                   (0) | Train Loss: 1.6631 | Train Acc: 0.3944
 Site-White-1                   (0) | Train Loss: 1.8383 | Train Acc: 0.3636
 Site-White-2                   (0) | Train Loss: 1.8633 | Train Acc: 0.3220
 Site-White-3                   (0) | Train Loss: 1.7865 | Train Acc: 0.3604
 Site-White-4                   (0) | Train Loss: 1.7342 | Train Acc: 0.3573
 Site-Middle_Eastern-0          (0) | Train Loss: 2.3338 | Train Acc: 0.2901
 Site-Middle_Eastern-1          (0) | Train Loss: 2.0507 | Train Acc: 0.2500
 Site-Middle_Eastern-2          (0) | Train Loss: 1.9946 | Train Acc: 0.2651
 Site-Black-0                   (2) | Train Loss: 2.0441 | Train Acc: 0.2435
 Site-Black-1                   (2) | Train Loss: 2.0850 | Train Acc: 0.2112
 Site-White_ffhq-0              (1) | Train Loss: 1.1960 | Train Acc: 0.5420
Average Train Accuracy: 0.3272
 Site-White-0                   (0) | Val  Loss: 1.9823 | Val  Acc: 0.2500
 Site-White-1                   (0) | Val  Loss: 1.9170 | Val  Acc: 0.2059
 Site-White-2                   (0) | Val  Loss: 1.8822 | Val  Acc: 0.3390
 Site-White-3                   (0) | Val  Loss: 1.7967 | Val  Acc: 0.3000
 Site-White-4                   (0) | Val  Loss: 1.8630 | Val  Acc: 0.3000
 Site-Middle_Eastern-0          (0) | Val  Loss: 2.2136 | Val  Acc: 0.2222
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.7635 | Val  Acc: 0.2812
 Site-Middle_Eastern-2          (0) | Val  Loss: 2.0206 | Val  Acc: 0.2037
 Site-Black-0                   (2) | Val  Loss: 2.0792 | Val  Acc: 0.2449
 Site-Black-1                   (2) | Val  Loss: 1.9099 | Val  Acc: 0.3133
 Site-White_ffhq-0              (1) | Val  Loss: 1.1460 | Val  Acc: 0.5513
Average Valid Accuracy: 0.2920
 Best site-White-0                  (0)  | Epoch:0 | Val Acc: 0.2500
 Best site-White-1                  (0)  | Epoch:0 | Val Acc: 0.2059
 Best site-White-2                  (0)  | Epoch:0 | Val Acc: 0.3390
 Best site-White-3                  (0)  | Epoch:0 | Val Acc: 0.3000
 Best site-White-4                  (0)  | Epoch:0 | Val Acc: 0.3000
 Best site-Middle_Eastern-0         (0)  | Epoch:0 | Val Acc: 0.2222
 Best site-Middle_Eastern-1         (0)  | Epoch:0 | Val Acc: 0.2812
 Best site-Middle_Eastern-2         (0)  | Epoch:0 | Val Acc: 0.2037
 Best site-Black-0                  (2)  | Epoch:0 | Val Acc: 0.2449
 Best site-Black-1                  (2)  | Epoch:0 | Val Acc: 0.3133
 Best site-White_ffhq-0             (1)  | Epoch:0 | Val Acc: 0.5513
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split_cs/ccop_q=0.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split_cs/ccop_q=0.0...
============ Train epoch 1 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-White-0                   (0) | Train Loss: 1.7788 | Train Acc: 0.3944
 Site-White-1                   (0) | Train Loss: 1.7925 | Train Acc: 0.3430
 Site-White-2                   (0) | Train Loss: 1.7874 | Train Acc: 0.3341
 Site-White-3                   (0) | Train Loss: 1.7494 | Train Acc: 0.3490
 Site-White-4                   (0) | Train Loss: 1.6939 | Train Acc: 0.3640
 Site-Middle_Eastern-0          (0) | Train Loss: 2.0987 | Train Acc: 0.2748
 Site-Middle_Eastern-1          (0) | Train Loss: 1.9465 | Train Acc: 0.2679
 Site-Middle_Eastern-2          (0) | Train Loss: 1.9130 | Train Acc: 0.2730
 Site-Black-0                   (2) | Train Loss: 1.9127 | Train Acc: 0.2406
 Site-Black-1                   (2) | Train Loss: 1.9791 | Train Acc: 0.1942
 Site-White_ffhq-0              (1) | Train Loss: 1.3072 | Train Acc: 0.4836
Average Train Accuracy: 0.3199
 Site-White-0                   (0) | Val  Loss: 1.9256 | Val  Acc: 0.2000
 Site-White-1                   (0) | Val  Loss: 1.8440 | Val  Acc: 0.2059
 Site-White-2                   (0) | Val  Loss: 1.8356 | Val  Acc: 0.3898
 Site-White-3                   (0) | Val  Loss: 1.8005 | Val  Acc: 0.3100
 Site-White-4                   (0) | Val  Loss: 1.7952 | Val  Acc: 0.3176
 Site-Middle_Eastern-0          (0) | Val  Loss: 2.0749 | Val  Acc: 0.1667
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.6891 | Val  Acc: 0.3125
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.9096 | Val  Acc: 0.2222
 Site-Black-0                   (2) | Val  Loss: 1.9693 | Val  Acc: 0.2857
 Site-Black-1                   (2) | Val  Loss: 1.9123 | Val  Acc: 0.2410
 Site-White_ffhq-0              (1) | Val  Loss: 1.3000 | Val  Acc: 0.4615
Average Valid Accuracy: 0.2830
============ Train epoch 2 ============
cnt=[1, 8, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-White-0                   (1) | Train Loss: 1.7147 | Train Acc: 0.4014
 Site-White-1                   (1) | Train Loss: 1.7568 | Train Acc: 0.3554
 Site-White-2                   (1) | Train Loss: 1.7425 | Train Acc: 0.3874
 Site-White-3                   (1) | Train Loss: 1.7146 | Train Acc: 0.3590
 Site-White-4                   (1) | Train Loss: 1.6614 | Train Acc: 0.3623
 Site-Middle_Eastern-0          (1) | Train Loss: 1.9773 | Train Acc: 0.2901
 Site-Middle_Eastern-1          (1) | Train Loss: 1.8926 | Train Acc: 0.3036
 Site-Middle_Eastern-2          (1) | Train Loss: 1.8446 | Train Acc: 0.3176
 Site-Black-0                   (2) | Train Loss: 1.8691 | Train Acc: 0.2638
 Site-Black-1                   (2) | Train Loss: 1.9314 | Train Acc: 0.2300
 Site-White_ffhq-0              (0) | Train Loss: 1.3465 | Train Acc: 0.4854
Average Train Accuracy: 0.3414
 Site-White-0                   (1) | Val  Loss: 1.8624 | Val  Acc: 0.3500
 Site-White-1                   (1) | Val  Loss: 1.7904 | Val  Acc: 0.2353
 Site-White-2                   (1) | Val  Loss: 1.8028 | Val  Acc: 0.3390
 Site-White-3                   (1) | Val  Loss: 1.7357 | Val  Acc: 0.3700
 Site-White-4                   (1) | Val  Loss: 1.7824 | Val  Acc: 0.3412
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.9807 | Val  Acc: 0.2778
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.6226 | Val  Acc: 0.3125
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.8319 | Val  Acc: 0.2593
 Site-Black-0                   (2) | Val  Loss: 1.9610 | Val  Acc: 0.2041
 Site-Black-1                   (2) | Val  Loss: 1.8650 | Val  Acc: 0.2771
 Site-White_ffhq-0              (0) | Val  Loss: 1.3165 | Val  Acc: 0.4744
Average Valid Accuracy: 0.3128
 Best site-White-0                  (1)  | Epoch:2 | Val Acc: 0.3500
 Best site-White-1                  (1)  | Epoch:2 | Val Acc: 0.2353
 Best site-White-2                  (1)  | Epoch:2 | Val Acc: 0.3390
 Best site-White-3                  (1)  | Epoch:2 | Val Acc: 0.3700
 Best site-White-4                  (1)  | Epoch:2 | Val Acc: 0.3412
 Best site-Middle_Eastern-0         (1)  | Epoch:2 | Val Acc: 0.2778
 Best site-Middle_Eastern-1         (1)  | Epoch:2 | Val Acc: 0.3125
 Best site-Middle_Eastern-2         (1)  | Epoch:2 | Val Acc: 0.2593
 Best site-Black-0                  (2)  | Epoch:2 | Val Acc: 0.2041
 Best site-Black-1                  (2)  | Epoch:2 | Val Acc: 0.2771
 Best site-White_ffhq-0             (0)  | Epoch:2 | Val Acc: 0.4744
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split_cs/ccop_q=0.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split_cs/ccop_q=0.0...
============ Train epoch 3 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-White-0                   (0) | Train Loss: 1.6702 | Train Acc: 0.4225
 Site-White-1                   (0) | Train Loss: 1.7008 | Train Acc: 0.3760
 Site-White-2                   (0) | Train Loss: 1.6773 | Train Acc: 0.3923
 Site-White-3                   (0) | Train Loss: 1.6503 | Train Acc: 0.3946
 Site-White-4                   (0) | Train Loss: 1.6298 | Train Acc: 0.3791
 Site-Middle_Eastern-0          (0) | Train Loss: 1.7613 | Train Acc: 0.3130
 Site-Middle_Eastern-1          (0) | Train Loss: 1.8177 | Train Acc: 0.3036
 Site-Middle_Eastern-2          (0) | Train Loss: 1.7995 | Train Acc: 0.3255
 Site-Black-0                   (2) | Train Loss: 1.8311 | Train Acc: 0.2870
 Site-Black-1                   (2) | Train Loss: 1.8766 | Train Acc: 0.2368
