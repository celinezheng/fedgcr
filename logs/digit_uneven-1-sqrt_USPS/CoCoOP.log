===2023-03-30 03:52:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8733 | Train Acc: 0.4659
 Site-MNIST     | Train Loss: 1.7981 | Train Acc: 0.5568
 Site-MNIST     | Train Loss: 1.7868 | Train Acc: 0.4432
 Site-MNIST     | Train Loss: 1.7291 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 2.1810 | Train Acc: 0.1705
 Site-SVHN      | Train Loss: 2.1549 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.1882 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.0936 | Train Acc: 0.2955
 Site-SynthDigits| Train Loss: 2.1567 | Train Acc: 0.2159
 Site-MNIST-M   | Train Loss: 2.2485 | Train Acc: 0.1705
 Site-MNIST     | Val  Loss: 1.7380 | Val  Acc: 0.4576
 Site-MNIST     | Val  Loss: 1.7917 | Val  Acc: 0.4576
 Site-MNIST     | Val  Loss: 1.8351 | Val  Acc: 0.5085
 Site-MNIST     | Val  Loss: 1.7943 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 2.0971 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 2.2361 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.1325 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2340 | Val  Acc: 0.1695
 Site-SynthDigits| Val  Loss: 2.1508 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.2484 | Val  Acc: 0.1525
Average Valid Accuracy: 0.3458
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4576
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4576
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5085
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_USPS...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4899 | Train Acc: 0.6591
 Site-MNIST     | Train Loss: 1.3932 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.4344 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 1.3143 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 2.1081 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.0859 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.0963 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.9722 | Train Acc: 0.3523
 Site-SynthDigits| Train Loss: 1.9891 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1439 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 1.3654 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.4231 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.4546 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.3745 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 1.9762 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 2.1649 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.0430 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.1515 | Val  Acc: 0.1695
 Site-SynthDigits| Val  Loss: 1.9747 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1319 | Val  Acc: 0.2034
Average Valid Accuracy: 0.4271
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1695
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_USPS...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1954 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.0841 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.1469 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.0413 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 2.1006 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.0133 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.0115 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.8940 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.8397 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 2.0152 | Train Acc: 0.3068
 Site-MNIST     | Val  Loss: 1.0703 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 1.1346 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.1655 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.0867 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.8767 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 2.0878 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 1.9982 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0778 | Val  Acc: 0.1864
 Site-SynthDigits| Val  Loss: 1.8254 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0358 | Val  Acc: 0.2542
Average Valid Accuracy: 0.5085
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1864
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2542
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_USPS...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.9444 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 0.8926 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.9288 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.8529 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 2.0189 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 1.9454 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.9445 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.8326 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 1.7618 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.9316 | Train Acc: 0.3409
 Site-MNIST     | Val  Loss: 0.8616 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.9245 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.9634 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.8904 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.7996 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 2.0294 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 1.9543 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.0151 | Val  Acc: 0.2034
 Site-SynthDigits| Val  Loss: 1.7226 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.9624 | Val  Acc: 0.3390
Average Valid Accuracy: 0.5390
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2034
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_USPS...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.8051 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.7689 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.7697 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.7121 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 1.9549 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.8689 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.8938 | Train Acc: 0.3977
 Site-SVHN      | Train Loss: 1.7249 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.6526 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.8801 | Train Acc: 0.3977
 Site-MNIST     | Val  Loss: 0.7240 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.7823 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.8179 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.7538 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.7245 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.9664 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 1.9064 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.9472 | Val  Acc: 0.2712
 Site-SynthDigits| Val  Loss: 1.6291 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.8905 | Val  Acc: 0.3729
Average Valid Accuracy: 0.5729
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2712
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_USPS...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.7028 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.6621 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.6756 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.5830 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.9213 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.8356 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.8086 | Train Acc: 0.3977
 Site-SVHN      | Train Loss: 1.6994 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 1.5498 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.7991 | Train Acc: 0.4205
 Site-MNIST     | Val  Loss: 0.6080 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.6725 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.7007 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6500 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.6712 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.9171 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 1.8731 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8890 | Val  Acc: 0.2881
 Site-SynthDigits| Val  Loss: 1.5608 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.8113 | Val  Acc: 0.3898
Average Valid Accuracy: 0.5864
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2881
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_USPS...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.6059 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.5467 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.5760 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.5287 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.8897 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.7788 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.7526 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.6586 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 1.4671 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.7156 | Train Acc: 0.4205
 Site-MNIST     | Val  Loss: 0.5313 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.5962 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.6138 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.5743 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.6142 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.8819 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.8212 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.8519 | Val  Acc: 0.2881
 Site-SynthDigits| Val  Loss: 1.4994 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.7597 | Val  Acc: 0.4407
Average Valid Accuracy: 0.6017
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2881
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_USPS...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.5550 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.5436 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.5105 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.4352 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.8333 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.7467 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.7057 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.6500 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.3992 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.6539 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.4609 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.5282 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.5368 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5109 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.5698 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.8381 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.7977 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.7983 | Val  Acc: 0.3390
 Site-SynthDigits| Val  Loss: 1.4414 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.7118 | Val  Acc: 0.4407
Average Valid Accuracy: 0.6237
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3390
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_USPS...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4778 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4772 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.4766 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.3904 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.8554 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.7339 | Train Acc: 0.3977
 Site-SVHN      | Train Loss: 1.6967 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.5964 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.3350 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.6329 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.4136 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4813 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.4818 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4656 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.5302 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.8026 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.7692 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.7516 | Val  Acc: 0.3559
 Site-SynthDigits| Val  Loss: 1.3821 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.6750 | Val  Acc: 0.4746
Average Valid Accuracy: 0.6373
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3559
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_USPS...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.4397 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4089 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.4416 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.3602 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.7578 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.6933 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.6214 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 1.5861 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.2487 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.5645 | Train Acc: 0.4773
 Site-MNIST     | Val  Loss: 0.3820 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4416 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.4386 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4267 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.4795 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 1.7563 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.7341 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.6966 | Val  Acc: 0.3729
 Site-SynthDigits| Val  Loss: 1.3316 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.6207 | Val  Acc: 0.5085
Average Valid Accuracy: 0.6593
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3729
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_USPS...
===2023-03-30 04:25:22===
===2023-03-30 04:25:23===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of USPS: 0.7903
Average Test Accuracy: 0.7903
