===2023-03-30 01:02:44===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8202 | Train Acc: 0.5114
 Site-MNIST     | Train Loss: 1.7086 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.7346 | Train Acc: 0.5341
 Site-MNIST     | Train Loss: 1.6432 | Train Acc: 0.5909
 Site-SVHN      | Train Loss: 2.2087 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1712 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.1703 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.1228 | Train Acc: 0.2841
 Site-SynthDigits| Train Loss: 2.1489 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.2241 | Train Acc: 0.1591
 Site-MNIST     | Val  Loss: 1.6670 | Val  Acc: 0.5593
 Site-MNIST     | Val  Loss: 1.7384 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.7698 | Val  Acc: 0.5593
 Site-MNIST     | Val  Loss: 1.7140 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 2.1025 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.2219 | Val  Acc: 0.1525
 Site-SVHN      | Val  Loss: 2.1360 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.2323 | Val  Acc: 0.1356
 Site-SynthDigits| Val  Loss: 2.1200 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.2411 | Val  Acc: 0.1356
Average Valid Accuracy: 0.3661
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5593
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5593
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1356
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_USPS...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3038 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 1.2201 | Train Acc: 0.6705
 Site-MNIST     | Train Loss: 1.2711 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 1.1345 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 2.1419 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.0414 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.0592 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.9472 | Train Acc: 0.3523
 Site-SynthDigits| Train Loss: 1.9052 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 2.0963 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 1.1899 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.2516 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.2813 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.1755 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 1.9485 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 2.1125 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.0151 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1211 | Val  Acc: 0.1864
 Site-SynthDigits| Val  Loss: 1.8950 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 2.1263 | Val  Acc: 0.2034
Average Valid Accuracy: 0.4525
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7288
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1864
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_USPS...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.9086 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 0.8312 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.8954 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.7897 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 2.0520 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 1.8765 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.9246 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.7529 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 1.6616 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.9121 | Train Acc: 0.3068
 Site-MNIST     | Val  Loss: 0.7755 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.8999 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.8917 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.8198 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.7528 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.9983 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.8798 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.9914 | Val  Acc: 0.2034
 Site-SynthDigits| Val  Loss: 1.7040 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.9566 | Val  Acc: 0.2881
Average Valid Accuracy: 0.5593
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2034
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2881
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_USPS...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.5973 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.5534 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.5928 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.4612 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.8377 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.7604 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.7176 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 1.6367 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.5369 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.6440 | Train Acc: 0.4432
 Site-MNIST     | Val  Loss: 0.4952 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5775 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.5941 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.5351 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.5615 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.8141 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.7528 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.8365 | Val  Acc: 0.3390
 Site-SynthDigits| Val  Loss: 1.5839 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 1.7710 | Val  Acc: 0.4407
Average Valid Accuracy: 0.6237
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3390
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_USPS...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.4050 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.3627 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3903 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.2931 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.6840 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 1.4956 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.4463 | Train Acc: 0.5795
 Site-SVHN      | Train Loss: 1.5299 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.2534 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.5099 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 0.3092 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4107 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.4018 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.3904 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.4083 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.5421 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.5161 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.6592 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.4481 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.6621 | Val  Acc: 0.4407
Average Valid Accuracy: 0.6678
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_USPS...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2874 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.2906 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.2734 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2181 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.3910 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.2602 | Train Acc: 0.6477
 Site-SVHN      | Train Loss: 1.2631 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 1.1978 | Train Acc: 0.6250
 Site-SynthDigits| Train Loss: 1.0262 | Train Acc: 0.6705
 Site-MNIST-M   | Train Loss: 1.2081 | Train Acc: 0.6250
 Site-MNIST     | Val  Loss: 0.2335 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3014 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3003 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2928 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.0984 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 1.4243 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.2178 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 1.4134 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 1.2923 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.4364 | Val  Acc: 0.5424
Average Valid Accuracy: 0.7373
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_USPS...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1845 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1804 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1754 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1270 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.3153 | Train Acc: 0.5682
 Site-SVHN      | Train Loss: 1.0884 | Train Acc: 0.6477
 Site-SVHN      | Train Loss: 1.0709 | Train Acc: 0.6932
 Site-SVHN      | Train Loss: 1.1660 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 0.9217 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 0.9526 | Train Acc: 0.7273
 Site-MNIST     | Val  Loss: 0.1318 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1924 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1902 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1945 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.0391 | Val  Acc: 0.6271
 Site-SVHN      | Val  Loss: 1.1518 | Val  Acc: 0.6271
 Site-SVHN      | Val  Loss: 1.1102 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 1.2922 | Val  Acc: 0.5932
 Site-SynthDigits| Val  Loss: 1.2524 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.3608 | Val  Acc: 0.5593
Average Valid Accuracy: 0.7492
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6271
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6271
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5932
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_USPS...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1453 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1228 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1135 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0955 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.9665 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 0.8137 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 0.8381 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 0.8772 | Train Acc: 0.7614
 Site-SynthDigits| Train Loss: 0.7378 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 0.7280 | Train Acc: 0.8523
 Site-MNIST     | Val  Loss: 0.0966 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1214 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1181 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1484 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 0.7226 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 0.9138 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 0.7721 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 0.9589 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 1.1469 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.1866 | Val  Acc: 0.6949
Average Valid Accuracy: 0.8339
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:7 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:7 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6949
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_USPS...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0947 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0853 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0784 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0539 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.9268 | Train Acc: 0.6932
 Site-SVHN      | Train Loss: 0.6595 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 0.6762 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 0.7510 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 0.6369 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.4698 | Train Acc: 0.9545
 Site-MNIST     | Val  Loss: 0.0591 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0853 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0896 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1028 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.6474 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 0.7230 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 0.6754 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 0.8635 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 1.0848 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.0518 | Val  Acc: 0.7288
Average Valid Accuracy: 0.8593
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7119
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.7288
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_USPS...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0729 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0603 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0777 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0412 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.6957 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 0.5445 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 0.5910 | Train Acc: 0.8295
 Site-SVHN      | Train Loss: 0.5069 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.4384 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.4254 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.0529 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0811 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0637 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0722 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5005 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 0.6721 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 0.5489 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 0.6498 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 0.9477 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 1.0200 | Val  Acc: 0.7458
Average Valid Accuracy: 0.8864
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.7458
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_USPS...
===2023-03-30 01:36:26===
===2023-03-30 01:36:27===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of USPS: 0.7151
Average Test Accuracy: 0.7151
