===2023-07-27 16:41:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.1055 | Train Acc: 0.5467
 Site-MNIST                         | Train Loss: 2.1106 | Train Acc: 0.4911
 Site-MNIST                         | Train Loss: 2.1269 | Train Acc: 0.5089
 Site-MNIST                         | Train Loss: 2.1134 | Train Acc: 0.5164
 Site-MNIST                         | Train Loss: 2.1109 | Train Acc: 0.5298
 Site-USPS                          | Train Loss: 2.0791 | Train Acc: 0.6379
 Site-USPS                          | Train Loss: 2.0901 | Train Acc: 0.6342
 Site-USPS                          | Train Loss: 2.0741 | Train Acc: 0.6571
 Site-SynthDigits                   | Train Loss: 2.2526 | Train Acc: 0.2008
 Site-SynthDigits                   | Train Loss: 2.2423 | Train Acc: 0.2247
 Site-MNIST_M                       | Train Loss: 2.2782 | Train Acc: 0.1903
 Site-MNIST_M                       | Train Loss: 2.2846 | Train Acc: 0.1402
 Site-SVHN                          | Train Loss: 2.2809 | Train Acc: 0.1516
Average Train Accuracy: 0.4177
 Site-MNIST                         | Val  Loss: 2.1420 | Val  Acc: 0.4643
 Site-MNIST                         | Val  Loss: 2.1552 | Val  Acc: 0.4643
 Site-MNIST                         | Val  Loss: 2.1173 | Val  Acc: 0.5397
 Site-MNIST                         | Val  Loss: 2.1207 | Val  Acc: 0.5053
 Site-MNIST                         | Val  Loss: 2.1187 | Val  Acc: 0.4842
 Site-USPS                          | Val  Loss: 2.0974 | Val  Acc: 0.6346
 Site-USPS                          | Val  Loss: 2.0984 | Val  Acc: 0.6026
 Site-USPS                          | Val  Loss: 2.0775 | Val  Acc: 0.6624
 Site-SynthDigits                   | Val  Loss: 2.2590 | Val  Acc: 0.1894
 Site-SynthDigits                   | Val  Loss: 2.2482 | Val  Acc: 0.2020
 Site-MNIST_M                       | Val  Loss: 2.2830 | Val  Acc: 0.2045
 Site-MNIST_M                       | Val  Loss: 2.2650 | Val  Acc: 0.1818
 Site-SVHN                          | Val  Loss: 2.2875 | Val  Acc: 0.1370
Average Valid Accuracy: 0.4055
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4643
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4643
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5397
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5053
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4842
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6346
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6026
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6624
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1894
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2020
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.2045
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1818
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1370
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.9114 | Train Acc: 0.6133
 Site-MNIST                         | Train Loss: 1.9319 | Train Acc: 0.5917
 Site-MNIST                         | Train Loss: 1.9523 | Train Acc: 0.5464
 Site-MNIST                         | Train Loss: 1.9252 | Train Acc: 0.5572
 Site-MNIST                         | Train Loss: 1.9223 | Train Acc: 0.5788
 Site-USPS                          | Train Loss: 1.8537 | Train Acc: 0.6787
 Site-USPS                          | Train Loss: 1.8611 | Train Acc: 0.6917
 Site-USPS                          | Train Loss: 1.8374 | Train Acc: 0.7359
 Site-SynthDigits                   | Train Loss: 2.1944 | Train Acc: 0.2595
 Site-SynthDigits                   | Train Loss: 2.1754 | Train Acc: 0.3043
 Site-MNIST_M                       | Train Loss: 2.2490 | Train Acc: 0.2472
 Site-MNIST_M                       | Train Loss: 2.2580 | Train Acc: 0.2083
 Site-SVHN                          | Train Loss: 2.2610 | Train Acc: 0.1738
Average Train Accuracy: 0.4759
 Site-MNIST                         | Val  Loss: 1.9587 | Val  Acc: 0.5536
 Site-MNIST                         | Val  Loss: 1.9850 | Val  Acc: 0.5476
 Site-MNIST                         | Val  Loss: 1.9303 | Val  Acc: 0.5794
 Site-MNIST                         | Val  Loss: 1.9469 | Val  Acc: 0.5474
 Site-MNIST                         | Val  Loss: 1.9387 | Val  Acc: 0.5684
 Site-USPS                          | Val  Loss: 1.8863 | Val  Acc: 0.7019
 Site-USPS                          | Val  Loss: 1.8870 | Val  Acc: 0.6795
 Site-USPS                          | Val  Loss: 1.8464 | Val  Acc: 0.6838
 Site-SynthDigits                   | Val  Loss: 2.2175 | Val  Acc: 0.2576
 Site-SynthDigits                   | Val  Loss: 2.1879 | Val  Acc: 0.2576
 Site-MNIST_M                       | Val  Loss: 2.2486 | Val  Acc: 0.3068
 Site-MNIST_M                       | Val  Loss: 2.2357 | Val  Acc: 0.2348
 Site-SVHN                          | Val  Loss: 2.2723 | Val  Acc: 0.1644
Average Valid Accuracy: 0.4679
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5536
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5476
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5794
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5474
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5684
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7019
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6795
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6838
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2576
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2576
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.3068
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2348
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1644
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.7430 | Train Acc: 0.6800
 Site-MNIST                         | Train Loss: 1.7731 | Train Acc: 0.6864
 Site-MNIST                         | Train Loss: 1.7879 | Train Acc: 0.6233
 Site-MNIST                         | Train Loss: 1.7505 | Train Acc: 0.6583
 Site-MNIST                         | Train Loss: 1.7484 | Train Acc: 0.6637
 Site-USPS                          | Train Loss: 1.6571 | Train Acc: 0.7170
 Site-USPS                          | Train Loss: 1.6555 | Train Acc: 0.7444
 Site-USPS                          | Train Loss: 1.6275 | Train Acc: 0.7742
 Site-SynthDigits                   | Train Loss: 2.1252 | Train Acc: 0.2955
 Site-SynthDigits                   | Train Loss: 2.1042 | Train Acc: 0.3447
 Site-MNIST_M                       | Train Loss: 2.2184 | Train Acc: 0.2869
 Site-MNIST_M                       | Train Loss: 2.2173 | Train Acc: 0.2159
 Site-SVHN                          | Train Loss: 2.2449 | Train Acc: 0.2249
Average Train Accuracy: 0.5319
 Site-MNIST                         | Val  Loss: 1.7864 | Val  Acc: 0.6429
 Site-MNIST                         | Val  Loss: 1.8056 | Val  Acc: 0.6190
 Site-MNIST                         | Val  Loss: 1.7599 | Val  Acc: 0.6429
 Site-MNIST                         | Val  Loss: 1.7847 | Val  Acc: 0.6158
 Site-MNIST                         | Val  Loss: 1.7700 | Val  Acc: 0.6632
 Site-USPS                          | Val  Loss: 1.6902 | Val  Acc: 0.7115
 Site-USPS                          | Val  Loss: 1.6917 | Val  Acc: 0.7115
 Site-USPS                          | Val  Loss: 1.6411 | Val  Acc: 0.7179
 Site-SynthDigits                   | Val  Loss: 2.1764 | Val  Acc: 0.2955
 Site-SynthDigits                   | Val  Loss: 2.1317 | Val  Acc: 0.2576
 Site-MNIST_M                       | Val  Loss: 2.2124 | Val  Acc: 0.3068
 Site-MNIST_M                       | Val  Loss: 2.2002 | Val  Acc: 0.2879
 Site-SVHN                          | Val  Loss: 2.2552 | Val  Acc: 0.2055
Average Valid Accuracy: 0.5137
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6429
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6190
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6429
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6158
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6632
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7115
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7115
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7179
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2955
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2576
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.3068
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2879
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2055
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.5664 | Train Acc: 0.7422
 Site-MNIST                         | Train Loss: 1.5979 | Train Acc: 0.7130
 Site-MNIST                         | Train Loss: 1.6289 | Train Acc: 0.6844
 Site-MNIST                         | Train Loss: 1.5867 | Train Acc: 0.7083
 Site-MNIST                         | Train Loss: 1.5815 | Train Acc: 0.7198
 Site-USPS                          | Train Loss: 1.4697 | Train Acc: 0.7626
 Site-USPS                          | Train Loss: 1.4767 | Train Acc: 0.7732
 Site-USPS                          | Train Loss: 1.4460 | Train Acc: 0.7966
 Site-SynthDigits                   | Train Loss: 2.0717 | Train Acc: 0.3144
 Site-SynthDigits                   | Train Loss: 2.0436 | Train Acc: 0.3801
 Site-MNIST_M                       | Train Loss: 2.1883 | Train Acc: 0.2983
 Site-MNIST_M                       | Train Loss: 2.1965 | Train Acc: 0.2330
 Site-SVHN                          | Train Loss: 2.2205 | Train Acc: 0.2487
Average Train Accuracy: 0.5673
 Site-MNIST                         | Val  Loss: 1.6211 | Val  Acc: 0.7321
 Site-MNIST                         | Val  Loss: 1.6389 | Val  Acc: 0.7024
 Site-MNIST                         | Val  Loss: 1.5881 | Val  Acc: 0.7222
 Site-MNIST                         | Val  Loss: 1.6233 | Val  Acc: 0.6737
 Site-MNIST                         | Val  Loss: 1.6086 | Val  Acc: 0.6912
 Site-USPS                          | Val  Loss: 1.5144 | Val  Acc: 0.7404
 Site-USPS                          | Val  Loss: 1.5121 | Val  Acc: 0.7244
 Site-USPS                          | Val  Loss: 1.4625 | Val  Acc: 0.7735
 Site-SynthDigits                   | Val  Loss: 2.1306 | Val  Acc: 0.3030
 Site-SynthDigits                   | Val  Loss: 2.0748 | Val  Acc: 0.2828
 Site-MNIST_M                       | Val  Loss: 2.1763 | Val  Acc: 0.3523
 Site-MNIST_M                       | Val  Loss: 2.1701 | Val  Acc: 0.3106
 Site-SVHN                          | Val  Loss: 2.2379 | Val  Acc: 0.2260
Average Valid Accuracy: 0.5565
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7321
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7024
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.7222
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6737
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6912
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7404
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7244
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7735
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3030
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.2828
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3523
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3106
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2260
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.4158 | Train Acc: 0.7467
 Site-MNIST                         | Train Loss: 1.4351 | Train Acc: 0.7367
 Site-MNIST                         | Train Loss: 1.4905 | Train Acc: 0.7120
 Site-MNIST                         | Train Loss: 1.4399 | Train Acc: 0.7319
 Site-MNIST                         | Train Loss: 1.4346 | Train Acc: 0.7408
 Site-USPS                          | Train Loss: 1.3460 | Train Acc: 0.7458
 Site-USPS                          | Train Loss: 1.3303 | Train Acc: 0.7732
 Site-USPS                          | Train Loss: 1.2952 | Train Acc: 0.7923
 Site-SynthDigits                   | Train Loss: 2.0163 | Train Acc: 0.3485
 Site-SynthDigits                   | Train Loss: 1.9779 | Train Acc: 0.3977
 Site-MNIST_M                       | Train Loss: 2.1685 | Train Acc: 0.3239
 Site-MNIST_M                       | Train Loss: 2.1736 | Train Acc: 0.2595
 Site-SVHN                          | Train Loss: 2.2118 | Train Acc: 0.2658
Average Train Accuracy: 0.5827
 Site-MNIST                         | Val  Loss: 1.4712 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.4894 | Val  Acc: 0.7381
 Site-MNIST                         | Val  Loss: 1.4355 | Val  Acc: 0.7619
 Site-MNIST                         | Val  Loss: 1.4820 | Val  Acc: 0.7105
 Site-MNIST                         | Val  Loss: 1.4669 | Val  Acc: 0.7193
 Site-USPS                          | Val  Loss: 1.3703 | Val  Acc: 0.7404
 Site-USPS                          | Val  Loss: 1.3698 | Val  Acc: 0.7179
 Site-USPS                          | Val  Loss: 1.3234 | Val  Acc: 0.7393
 Site-SynthDigits                   | Val  Loss: 2.0906 | Val  Acc: 0.3485
 Site-SynthDigits                   | Val  Loss: 2.0232 | Val  Acc: 0.3131
 Site-MNIST_M                       | Val  Loss: 2.1434 | Val  Acc: 0.3409
 Site-MNIST_M                       | Val  Loss: 2.1345 | Val  Acc: 0.3106
 Site-SVHN                          | Val  Loss: 2.2209 | Val  Acc: 0.2260
Average Valid Accuracy: 0.5705
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7381
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7619
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7105
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7193
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7404
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7179
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7393
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3485
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3131
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3409
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3106
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2260
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.2870 | Train Acc: 0.7778
 Site-MNIST                         | Train Loss: 1.3294 | Train Acc: 0.7604
 Site-MNIST                         | Train Loss: 1.3736 | Train Acc: 0.7357
 Site-MNIST                         | Train Loss: 1.3196 | Train Acc: 0.7595
 Site-MNIST                         | Train Loss: 1.3178 | Train Acc: 0.7671
 Site-USPS                          | Train Loss: 1.2312 | Train Acc: 0.7434
 Site-USPS                          | Train Loss: 1.2070 | Train Acc: 0.7827
 Site-USPS                          | Train Loss: 1.1768 | Train Acc: 0.8040
 Site-SynthDigits                   | Train Loss: 1.9652 | Train Acc: 0.3750
 Site-SynthDigits                   | Train Loss: 1.9257 | Train Acc: 0.4306
 Site-MNIST_M                       | Train Loss: 2.1344 | Train Acc: 0.3267
 Site-MNIST_M                       | Train Loss: 2.1504 | Train Acc: 0.2576
 Site-SVHN                          | Train Loss: 2.1869 | Train Acc: 0.2675
Average Train Accuracy: 0.5991
 Site-MNIST                         | Val  Loss: 1.3488 | Val  Acc: 0.7857
 Site-MNIST                         | Val  Loss: 1.3660 | Val  Acc: 0.7619
 Site-MNIST                         | Val  Loss: 1.3173 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 1.3683 | Val  Acc: 0.7263
 Site-MNIST                         | Val  Loss: 1.3485 | Val  Acc: 0.7439
 Site-USPS                          | Val  Loss: 1.2494 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 1.2454 | Val  Acc: 0.7372
 Site-USPS                          | Val  Loss: 1.2060 | Val  Acc: 0.7436
 Site-SynthDigits                   | Val  Loss: 2.0488 | Val  Acc: 0.3864
 Site-SynthDigits                   | Val  Loss: 1.9772 | Val  Acc: 0.3586
 Site-MNIST_M                       | Val  Loss: 2.1097 | Val  Acc: 0.3182
 Site-MNIST_M                       | Val  Loss: 2.1074 | Val  Acc: 0.3258
 Site-SVHN                          | Val  Loss: 2.2072 | Val  Acc: 0.2397
Average Valid Accuracy: 0.5888
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7857
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7619
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7263
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7439
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7372
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7436
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3864
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3586
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3182
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3258
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2397
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 1.2025 | Train Acc: 0.7867
 Site-MNIST                         | Train Loss: 1.2484 | Train Acc: 0.7840
 Site-MNIST                         | Train Loss: 1.2818 | Train Acc: 0.7515
 Site-MNIST                         | Train Loss: 1.2209 | Train Acc: 0.7740
 Site-MNIST                         | Train Loss: 1.2190 | Train Acc: 0.7758
 Site-USPS                          | Train Loss: 1.0875 | Train Acc: 0.7890
 Site-USPS                          | Train Loss: 1.0786 | Train Acc: 0.8051
 Site-USPS                          | Train Loss: 1.0440 | Train Acc: 0.8339
 Site-SynthDigits                   | Train Loss: 1.9262 | Train Acc: 0.3996
 Site-SynthDigits                   | Train Loss: 1.8706 | Train Acc: 0.4508
 Site-MNIST_M                       | Train Loss: 2.1013 | Train Acc: 0.3608
 Site-MNIST_M                       | Train Loss: 2.1305 | Train Acc: 0.2765
 Site-SVHN                          | Train Loss: 2.1903 | Train Acc: 0.2726
Average Train Accuracy: 0.6200
 Site-MNIST                         | Val  Loss: 1.2427 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.2631 | Val  Acc: 0.8095
 Site-MNIST                         | Val  Loss: 1.2217 | Val  Acc: 0.8016
 Site-MNIST                         | Val  Loss: 1.2739 | Val  Acc: 0.7474
 Site-MNIST                         | Val  Loss: 1.2542 | Val  Acc: 0.7719
 Site-USPS                          | Val  Loss: 1.1167 | Val  Acc: 0.7596
 Site-USPS                          | Val  Loss: 1.1120 | Val  Acc: 0.7756
 Site-USPS                          | Val  Loss: 1.0764 | Val  Acc: 0.7991
 Site-SynthDigits                   | Val  Loss: 2.0073 | Val  Acc: 0.4015
 Site-SynthDigits                   | Val  Loss: 1.9344 | Val  Acc: 0.3737
 Site-MNIST_M                       | Val  Loss: 2.0809 | Val  Acc: 0.3636
 Site-MNIST_M                       | Val  Loss: 2.0796 | Val  Acc: 0.3409
 Site-SVHN                          | Val  Loss: 2.1940 | Val  Acc: 0.2260
Average Valid Accuracy: 0.6134
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8095
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8016
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7474
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7719
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7596
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7756
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7991
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4015
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.3737
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3636
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3409
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2260
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 1.0946 | Train Acc: 0.7911
 Site-MNIST                         | Train Loss: 1.1399 | Train Acc: 0.7929
 Site-MNIST                         | Train Loss: 1.1876 | Train Acc: 0.7692
 Site-MNIST                         | Train Loss: 1.1234 | Train Acc: 0.7924
 Site-MNIST                         | Train Loss: 1.1225 | Train Acc: 0.7942
 Site-USPS                          | Train Loss: 1.0215 | Train Acc: 0.7866
 Site-USPS                          | Train Loss: 0.9908 | Train Acc: 0.8067
 Site-USPS                          | Train Loss: 0.9577 | Train Acc: 0.8328
 Site-SynthDigits                   | Train Loss: 1.8889 | Train Acc: 0.4072
 Site-SynthDigits                   | Train Loss: 1.8259 | Train Acc: 0.4621
 Site-MNIST_M                       | Train Loss: 2.0753 | Train Acc: 0.3608
 Site-MNIST_M                       | Train Loss: 2.1157 | Train Acc: 0.3125
 Site-SVHN                          | Train Loss: 2.1797 | Train Acc: 0.2777
Average Train Accuracy: 0.6297
 Site-MNIST                         | Val  Loss: 1.1456 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.1624 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 1.1253 | Val  Acc: 0.8095
 Site-MNIST                         | Val  Loss: 1.1733 | Val  Acc: 0.7737
 Site-MNIST                         | Val  Loss: 1.1582 | Val  Acc: 0.7789
 Site-USPS                          | Val  Loss: 1.0293 | Val  Acc: 0.7692
 Site-USPS                          | Val  Loss: 1.0244 | Val  Acc: 0.7756
 Site-USPS                          | Val  Loss: 0.9938 | Val  Acc: 0.7863
 Site-SynthDigits                   | Val  Loss: 1.9819 | Val  Acc: 0.4015
 Site-SynthDigits                   | Val  Loss: 1.8962 | Val  Acc: 0.3788
 Site-MNIST_M                       | Val  Loss: 2.0509 | Val  Acc: 0.3636
 Site-MNIST_M                       | Val  Loss: 2.0553 | Val  Acc: 0.3409
 Site-SVHN                          | Val  Loss: 2.1804 | Val  Acc: 0.2397
Average Valid Accuracy: 0.6187
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8095
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7737
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7789
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7692
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7756
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7863
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4015
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.3788
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3636
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3409
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2397
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 1.0137 | Train Acc: 0.8000
 Site-MNIST                         | Train Loss: 1.0513 | Train Acc: 0.7899
 Site-MNIST                         | Train Loss: 1.1242 | Train Acc: 0.7613
 Site-MNIST                         | Train Loss: 1.0560 | Train Acc: 0.7806
 Site-MNIST                         | Train Loss: 1.0565 | Train Acc: 0.7863
 Site-USPS                          | Train Loss: 0.9824 | Train Acc: 0.7914
 Site-USPS                          | Train Loss: 0.9426 | Train Acc: 0.8067
 Site-USPS                          | Train Loss: 0.9089 | Train Acc: 0.8381
 Site-SynthDigits                   | Train Loss: 1.8460 | Train Acc: 0.4223
 Site-SynthDigits                   | Train Loss: 1.7875 | Train Acc: 0.4760
 Site-MNIST_M                       | Train Loss: 2.0460 | Train Acc: 0.3977
 Site-MNIST_M                       | Train Loss: 2.0862 | Train Acc: 0.3068
 Site-SVHN                          | Train Loss: 2.1463 | Train Acc: 0.2879
Average Train Accuracy: 0.6342
 Site-MNIST                         | Val  Loss: 1.0725 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.0897 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 1.0579 | Val  Acc: 0.8095
 Site-MNIST                         | Val  Loss: 1.1103 | Val  Acc: 0.7632
 Site-MNIST                         | Val  Loss: 1.0950 | Val  Acc: 0.7754
 Site-USPS                          | Val  Loss: 0.9727 | Val  Acc: 0.7788
 Site-USPS                          | Val  Loss: 0.9746 | Val  Acc: 0.7821
 Site-USPS                          | Val  Loss: 0.9568 | Val  Acc: 0.7863
 Site-SynthDigits                   | Val  Loss: 1.9471 | Val  Acc: 0.4470
 Site-SynthDigits                   | Val  Loss: 1.8563 | Val  Acc: 0.4192
 Site-MNIST_M                       | Val  Loss: 2.0168 | Val  Acc: 0.3750
 Site-MNIST_M                       | Val  Loss: 2.0161 | Val  Acc: 0.3788
 Site-SVHN                          | Val  Loss: 2.1774 | Val  Acc: 0.2123
Average Valid Accuracy: 0.6271
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8095
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7632
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7754
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7788
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7821
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7863
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4470
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4192
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3750
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3788
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2123
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.9375 | Train Acc: 0.8044
 Site-MNIST                         | Train Loss: 1.0377 | Train Acc: 0.8047
 Site-MNIST                         | Train Loss: 1.0514 | Train Acc: 0.7830
 Site-MNIST                         | Train Loss: 0.9814 | Train Acc: 0.8108
 Site-MNIST                         | Train Loss: 0.9810 | Train Acc: 0.8117
 Site-USPS                          | Train Loss: 0.8836 | Train Acc: 0.8201
 Site-USPS                          | Train Loss: 0.8411 | Train Acc: 0.8323
 Site-USPS                          | Train Loss: 0.8085 | Train Acc: 0.8616
 Site-SynthDigits                   | Train Loss: 1.7980 | Train Acc: 0.4261
 Site-SynthDigits                   | Train Loss: 1.7525 | Train Acc: 0.5101
 Site-MNIST_M                       | Train Loss: 2.0165 | Train Acc: 0.4091
 Site-MNIST_M                       | Train Loss: 2.0697 | Train Acc: 0.3182
 Site-SVHN                          | Train Loss: 2.1445 | Train Acc: 0.2862
Average Train Accuracy: 0.6522
 Site-MNIST                         | Val  Loss: 0.9847 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 1.0059 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.9863 | Val  Acc: 0.8254
 Site-MNIST                         | Val  Loss: 1.0354 | Val  Acc: 0.7789
 Site-MNIST                         | Val  Loss: 1.0220 | Val  Acc: 0.7895
 Site-USPS                          | Val  Loss: 0.8614 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.8644 | Val  Acc: 0.8013
 Site-USPS                          | Val  Loss: 0.8457 | Val  Acc: 0.8162
 Site-SynthDigits                   | Val  Loss: 1.9315 | Val  Acc: 0.4394
 Site-SynthDigits                   | Val  Loss: 1.8368 | Val  Acc: 0.4040
 Site-MNIST_M                       | Val  Loss: 1.9908 | Val  Acc: 0.4205
 Site-MNIST_M                       | Val  Loss: 2.0023 | Val  Acc: 0.3712
 Site-SVHN                          | Val  Loss: 2.1598 | Val  Acc: 0.2260
Average Valid Accuracy: 0.6430
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8254
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7789
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7895
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8077
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8013
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8162
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4394
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4040
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.4205
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.3712
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2260
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.8988 | Train Acc: 0.7956
 Site-MNIST                         | Train Loss: 0.9327 | Train Acc: 0.8047
 Site-MNIST                         | Train Loss: 0.9903 | Train Acc: 0.7870
 Site-MNIST                         | Train Loss: 0.9146 | Train Acc: 0.8173
 Site-MNIST                         | Train Loss: 0.9184 | Train Acc: 0.8144
 Site-USPS                          | Train Loss: 0.8213 | Train Acc: 0.8249
 Site-USPS                          | Train Loss: 0.7878 | Train Acc: 0.8403
 Site-USPS                          | Train Loss: 0.7545 | Train Acc: 0.8637
 Site-SynthDigits                   | Train Loss: 1.7983 | Train Acc: 0.4489
 Site-SynthDigits                   | Train Loss: 1.7268 | Train Acc: 0.5240
 Site-MNIST_M                       | Train Loss: 1.9938 | Train Acc: 0.4261
 Site-MNIST_M                       | Train Loss: 2.0312 | Train Acc: 0.3201
 Site-SVHN                          | Train Loss: 2.1375 | Train Acc: 0.2913
Average Train Accuracy: 0.6583
 Site-MNIST                         | Val  Loss: 0.9185 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 0.9363 | Val  Acc: 0.8452
 Site-MNIST                         | Val  Loss: 0.9246 | Val  Acc: 0.8333
 Site-MNIST                         | Val  Loss: 0.9690 | Val  Acc: 0.7947
 Site-MNIST                         | Val  Loss: 0.9599 | Val  Acc: 0.7930
 Site-USPS                          | Val  Loss: 0.8058 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 0.8144 | Val  Acc: 0.8141
 Site-USPS                          | Val  Loss: 0.8034 | Val  Acc: 0.8205
 Site-SynthDigits                   | Val  Loss: 1.8995 | Val  Acc: 0.4545
 Site-SynthDigits                   | Val  Loss: 1.8055 | Val  Acc: 0.4495
 Site-MNIST_M                       | Val  Loss: 1.9693 | Val  Acc: 0.4545
 Site-MNIST_M                       | Val  Loss: 1.9666 | Val  Acc: 0.3864
 Site-SVHN                          | Val  Loss: 2.1525 | Val  Acc: 0.2397
Average Valid Accuracy: 0.6558
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8452
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8333
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7947
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7930
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8141
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8205
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4545
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4495
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4545
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.3864
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.2397
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.8448 | Train Acc: 0.8044
 Site-MNIST                         | Train Loss: 0.8594 | Train Acc: 0.8254
 Site-MNIST                         | Train Loss: 0.9358 | Train Acc: 0.7968
 Site-MNIST                         | Train Loss: 0.8563 | Train Acc: 0.8265
 Site-MNIST                         | Train Loss: 0.8642 | Train Acc: 0.8205
 Site-USPS                          | Train Loss: 0.7871 | Train Acc: 0.8345
 Site-USPS                          | Train Loss: 0.7395 | Train Acc: 0.8514
 Site-USPS                          | Train Loss: 0.7075 | Train Acc: 0.8722
 Site-SynthDigits                   | Train Loss: 1.7687 | Train Acc: 0.4508
 Site-SynthDigits                   | Train Loss: 1.6993 | Train Acc: 0.5227
 Site-MNIST_M                       | Train Loss: 1.9648 | Train Acc: 0.4318
 Site-MNIST_M                       | Train Loss: 2.0250 | Train Acc: 0.3333
 Site-SVHN                          | Train Loss: 2.1277 | Train Acc: 0.2879
Average Train Accuracy: 0.6660
 Site-MNIST                         | Val  Loss: 0.8589 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.8743 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.8690 | Val  Acc: 0.8333
 Site-MNIST                         | Val  Loss: 0.9122 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.9037 | Val  Acc: 0.8140
 Site-USPS                          | Val  Loss: 0.7555 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.7667 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.7587 | Val  Acc: 0.8291
 Site-SynthDigits                   | Val  Loss: 1.8800 | Val  Acc: 0.4545
 Site-SynthDigits                   | Val  Loss: 1.7699 | Val  Acc: 0.4697
 Site-MNIST_M                       | Val  Loss: 1.9428 | Val  Acc: 0.4545
 Site-MNIST_M                       | Val  Loss: 1.9461 | Val  Acc: 0.3864
 Site-SVHN                          | Val  Loss: 2.1423 | Val  Acc: 0.2329
Average Valid Accuracy: 0.6665
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8333
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8140
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8654
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8462
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8291
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.4545
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.4697
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4545
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.3864
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2329
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.7989 | Train Acc: 0.8089
 Site-MNIST                         | Train Loss: 0.8036 | Train Acc: 0.8254
 Site-MNIST                         | Train Loss: 0.8853 | Train Acc: 0.7949
 Site-MNIST                         | Train Loss: 0.8102 | Train Acc: 0.8305
 Site-MNIST                         | Train Loss: 0.8166 | Train Acc: 0.8319
 Site-USPS                          | Train Loss: 0.7356 | Train Acc: 0.8345
 Site-USPS                          | Train Loss: 0.6978 | Train Acc: 0.8530
 Site-USPS                          | Train Loss: 0.6661 | Train Acc: 0.8818
 Site-SynthDigits                   | Train Loss: 1.7552 | Train Acc: 0.4602
 Site-SynthDigits                   | Train Loss: 1.6705 | Train Acc: 0.5341
 Site-MNIST_M                       | Train Loss: 1.9431 | Train Acc: 0.4290
 Site-MNIST_M                       | Train Loss: 2.0273 | Train Acc: 0.3409
 Site-SVHN                          | Train Loss: 2.1237 | Train Acc: 0.2811
Average Train Accuracy: 0.6697
 Site-MNIST                         | Val  Loss: 0.8045 | Val  Acc: 0.7857
 Site-MNIST                         | Val  Loss: 0.8227 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.8157 | Val  Acc: 0.8492
 Site-MNIST                         | Val  Loss: 0.8594 | Val  Acc: 0.8053
 Site-MNIST                         | Val  Loss: 0.8571 | Val  Acc: 0.8175
 Site-USPS                          | Val  Loss: 0.7059 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.7235 | Val  Acc: 0.8397
 Site-USPS                          | Val  Loss: 0.7248 | Val  Acc: 0.8376
 Site-SynthDigits                   | Val  Loss: 1.8597 | Val  Acc: 0.4470
 Site-SynthDigits                   | Val  Loss: 1.7557 | Val  Acc: 0.4697
 Site-MNIST_M                       | Val  Loss: 1.9265 | Val  Acc: 0.4545
 Site-MNIST_M                       | Val  Loss: 1.9201 | Val  Acc: 0.3788
 Site-SVHN                          | Val  Loss: 2.1336 | Val  Acc: 0.2260
Average Valid Accuracy: 0.6641
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.7535 | Train Acc: 0.8267
 Site-MNIST                         | Train Loss: 0.7519 | Train Acc: 0.8373
 Site-MNIST                         | Train Loss: 0.8383 | Train Acc: 0.8146
 Site-MNIST                         | Train Loss: 0.7619 | Train Acc: 0.8344
 Site-MNIST                         | Train Loss: 0.7665 | Train Acc: 0.8450
 Site-USPS                          | Train Loss: 0.6901 | Train Acc: 0.8537
 Site-USPS                          | Train Loss: 0.6457 | Train Acc: 0.8674
 Site-USPS                          | Train Loss: 0.6167 | Train Acc: 0.8871
 Site-SynthDigits                   | Train Loss: 1.7198 | Train Acc: 0.4640
 Site-SynthDigits                   | Train Loss: 1.6362 | Train Acc: 0.5480
 Site-MNIST_M                       | Train Loss: 1.9289 | Train Acc: 0.4347
 Site-MNIST_M                       | Train Loss: 1.9820 | Train Acc: 0.3466
 Site-SVHN                          | Train Loss: 2.1122 | Train Acc: 0.2845
Average Train Accuracy: 0.6803
 Site-MNIST                         | Val  Loss: 0.7534 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 0.7737 | Val  Acc: 0.8690
 Site-MNIST                         | Val  Loss: 0.7711 | Val  Acc: 0.8651
 Site-MNIST                         | Val  Loss: 0.8126 | Val  Acc: 0.8211
 Site-MNIST                         | Val  Loss: 0.8099 | Val  Acc: 0.8246
 Site-USPS                          | Val  Loss: 0.6472 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.6684 | Val  Acc: 0.8526
 Site-USPS                          | Val  Loss: 0.6687 | Val  Acc: 0.8462
 Site-SynthDigits                   | Val  Loss: 1.8468 | Val  Acc: 0.4470
 Site-SynthDigits                   | Val  Loss: 1.7342 | Val  Acc: 0.4697
 Site-MNIST_M                       | Val  Loss: 1.9000 | Val  Acc: 0.4545
 Site-MNIST_M                       | Val  Loss: 1.9050 | Val  Acc: 0.3864
 Site-SVHN                          | Val  Loss: 2.1258 | Val  Acc: 0.2397
Average Valid Accuracy: 0.6734
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8690
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8651
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8211
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8246
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8750
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8526
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8462
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4470
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4697
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4545
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.3864
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.2397
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.7023 | Train Acc: 0.8267
 Site-MNIST                         | Train Loss: 0.7453 | Train Acc: 0.8491
 Site-MNIST                         | Train Loss: 0.7946 | Train Acc: 0.8146
 Site-MNIST                         | Train Loss: 0.7183 | Train Acc: 0.8423
 Site-MNIST                         | Train Loss: 0.7231 | Train Acc: 0.8529
 Site-USPS                          | Train Loss: 0.6497 | Train Acc: 0.8561
 Site-USPS                          | Train Loss: 0.6154 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.5878 | Train Acc: 0.8871
 Site-SynthDigits                   | Train Loss: 1.7292 | Train Acc: 0.4621
 Site-SynthDigits                   | Train Loss: 1.6240 | Train Acc: 0.5442
 Site-MNIST_M                       | Train Loss: 1.9183 | Train Acc: 0.4375
 Site-MNIST_M                       | Train Loss: 1.9632 | Train Acc: 0.3523
 Site-SVHN                          | Train Loss: 2.0915 | Train Acc: 0.2828
Average Train Accuracy: 0.6829
 Site-MNIST                         | Val  Loss: 0.7078 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 0.7271 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.7246 | Val  Acc: 0.8651
 Site-MNIST                         | Val  Loss: 0.7628 | Val  Acc: 0.8316
 Site-MNIST                         | Val  Loss: 0.7638 | Val  Acc: 0.8351
 Site-USPS                          | Val  Loss: 0.6130 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.6356 | Val  Acc: 0.8590
 Site-USPS                          | Val  Loss: 0.6437 | Val  Acc: 0.8462
 Site-SynthDigits                   | Val  Loss: 1.8283 | Val  Acc: 0.4470
 Site-SynthDigits                   | Val  Loss: 1.7182 | Val  Acc: 0.4646
 Site-MNIST_M                       | Val  Loss: 1.8855 | Val  Acc: 0.4545
 Site-MNIST_M                       | Val  Loss: 1.8873 | Val  Acc: 0.3788
 Site-SVHN                          | Val  Loss: 2.1164 | Val  Acc: 0.2260
Average Valid Accuracy: 0.6733
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.6772 | Train Acc: 0.8311
 Site-MNIST                         | Train Loss: 0.7340 | Train Acc: 0.8491
 Site-MNIST                         | Train Loss: 0.7630 | Train Acc: 0.8205
 Site-MNIST                         | Train Loss: 0.6867 | Train Acc: 0.8397
 Site-MNIST                         | Train Loss: 0.6908 | Train Acc: 0.8529
 Site-USPS                          | Train Loss: 0.6348 | Train Acc: 0.8561
 Site-USPS                          | Train Loss: 0.5911 | Train Acc: 0.8770
 Site-USPS                          | Train Loss: 0.5548 | Train Acc: 0.8903
 Site-SynthDigits                   | Train Loss: 1.6852 | Train Acc: 0.4716
 Site-SynthDigits                   | Train Loss: 1.6005 | Train Acc: 0.5530
 Site-MNIST_M                       | Train Loss: 1.8857 | Train Acc: 0.4347
 Site-MNIST_M                       | Train Loss: 1.9424 | Train Acc: 0.3598
 Site-SVHN                          | Train Loss: 2.0794 | Train Acc: 0.2777
Average Train Accuracy: 0.6857
 Site-MNIST                         | Val  Loss: 0.6741 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.6924 | Val  Acc: 0.8690
 Site-MNIST                         | Val  Loss: 0.6953 | Val  Acc: 0.8651
 Site-MNIST                         | Val  Loss: 0.7314 | Val  Acc: 0.8421
 Site-MNIST                         | Val  Loss: 0.7339 | Val  Acc: 0.8351
 Site-USPS                          | Val  Loss: 0.5839 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.6115 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.6178 | Val  Acc: 0.8504
 Site-SynthDigits                   | Val  Loss: 1.8086 | Val  Acc: 0.4621
 Site-SynthDigits                   | Val  Loss: 1.6857 | Val  Acc: 0.4646
 Site-MNIST_M                       | Val  Loss: 1.8541 | Val  Acc: 0.4659
 Site-MNIST_M                       | Val  Loss: 1.8593 | Val  Acc: 0.3864
 Site-SVHN                          | Val  Loss: 2.1108 | Val  Acc: 0.2329
Average Valid Accuracy: 0.6825
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8393
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8690
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8651
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8421
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8351
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8942
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8654
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8504
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4621
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4646
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4659
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.3864
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.2329
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.6567 | Train Acc: 0.8356
 Site-MNIST                         | Train Loss: 0.6798 | Train Acc: 0.8550
 Site-MNIST                         | Train Loss: 0.7278 | Train Acc: 0.8264
 Site-MNIST                         | Train Loss: 0.6547 | Train Acc: 0.8449
 Site-MNIST                         | Train Loss: 0.6581 | Train Acc: 0.8616
 Site-USPS                          | Train Loss: 0.6055 | Train Acc: 0.8705
 Site-USPS                          | Train Loss: 0.5535 | Train Acc: 0.8850
 Site-USPS                          | Train Loss: 0.5281 | Train Acc: 0.8914
 Site-SynthDigits                   | Train Loss: 1.6589 | Train Acc: 0.4792
 Site-SynthDigits                   | Train Loss: 1.5837 | Train Acc: 0.5568
 Site-MNIST_M                       | Train Loss: 1.8671 | Train Acc: 0.4403
 Site-MNIST_M                       | Train Loss: 1.9339 | Train Acc: 0.3561
 Site-SVHN                          | Train Loss: 2.0872 | Train Acc: 0.2828
Average Train Accuracy: 0.6912
 Site-MNIST                         | Val  Loss: 0.6310 | Val  Acc: 0.8750
 Site-MNIST                         | Val  Loss: 0.6539 | Val  Acc: 0.8690
 Site-MNIST                         | Val  Loss: 0.6585 | Val  Acc: 0.8730
 Site-MNIST                         | Val  Loss: 0.6990 | Val  Acc: 0.8526
 Site-MNIST                         | Val  Loss: 0.6982 | Val  Acc: 0.8421
 Site-USPS                          | Val  Loss: 0.5439 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.5734 | Val  Acc: 0.8782
 Site-USPS                          | Val  Loss: 0.5843 | Val  Acc: 0.8632
 Site-SynthDigits                   | Val  Loss: 1.7937 | Val  Acc: 0.4697
 Site-SynthDigits                   | Val  Loss: 1.6747 | Val  Acc: 0.4848
 Site-MNIST_M                       | Val  Loss: 1.8285 | Val  Acc: 0.4773
 Site-MNIST_M                       | Val  Loss: 1.8420 | Val  Acc: 0.4091
 Site-SVHN                          | Val  Loss: 2.1054 | Val  Acc: 0.2466
Average Valid Accuracy: 0.6957
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8750
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8690
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8730
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8526
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8421
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8782
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8632
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4697
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.4848
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.4773
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.4091
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.2466
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.5975 | Train Acc: 0.8489
 Site-MNIST                         | Train Loss: 0.6432 | Train Acc: 0.8669
 Site-MNIST                         | Train Loss: 0.6943 | Train Acc: 0.8284
 Site-MNIST                         | Train Loss: 0.6209 | Train Acc: 0.8502
 Site-MNIST                         | Train Loss: 0.6243 | Train Acc: 0.8608
 Site-USPS                          | Train Loss: 0.5757 | Train Acc: 0.8633
 Site-USPS                          | Train Loss: 0.5329 | Train Acc: 0.8786
 Site-USPS                          | Train Loss: 0.5095 | Train Acc: 0.8956
 Site-SynthDigits                   | Train Loss: 1.6540 | Train Acc: 0.4754
 Site-SynthDigits                   | Train Loss: 1.5559 | Train Acc: 0.5644
 Site-MNIST_M                       | Train Loss: 1.8413 | Train Acc: 0.4517
 Site-MNIST_M                       | Train Loss: 1.9234 | Train Acc: 0.3598
 Site-SVHN                          | Train Loss: 2.0627 | Train Acc: 0.2862
Average Train Accuracy: 0.6946
 Site-MNIST                         | Val  Loss: 0.5996 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.6232 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.6246 | Val  Acc: 0.8730
 Site-MNIST                         | Val  Loss: 0.6587 | Val  Acc: 0.8526
 Site-MNIST                         | Val  Loss: 0.6653 | Val  Acc: 0.8526
 Site-USPS                          | Val  Loss: 0.5237 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.5591 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.5710 | Val  Acc: 0.8462
 Site-SynthDigits                   | Val  Loss: 1.7681 | Val  Acc: 0.4697
 Site-SynthDigits                   | Val  Loss: 1.6477 | Val  Acc: 0.4747
 Site-MNIST_M                       | Val  Loss: 1.8045 | Val  Acc: 0.4886
 Site-MNIST_M                       | Val  Loss: 1.8137 | Val  Acc: 0.4242
 Site-SVHN                          | Val  Loss: 2.0958 | Val  Acc: 0.2329
Average Valid Accuracy: 0.6949
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.6118 | Train Acc: 0.8533
 Site-MNIST                         | Train Loss: 0.6375 | Train Acc: 0.8698
 Site-MNIST                         | Train Loss: 0.6613 | Train Acc: 0.8383
 Site-MNIST                         | Train Loss: 0.5975 | Train Acc: 0.8568
 Site-MNIST                         | Train Loss: 0.6003 | Train Acc: 0.8678
 Site-USPS                          | Train Loss: 0.5542 | Train Acc: 0.8777
 Site-USPS                          | Train Loss: 0.5034 | Train Acc: 0.8962
 Site-USPS                          | Train Loss: 0.4804 | Train Acc: 0.8978
 Site-SynthDigits                   | Train Loss: 1.6612 | Train Acc: 0.4811
 Site-SynthDigits                   | Train Loss: 1.5458 | Train Acc: 0.5556
 Site-MNIST_M                       | Train Loss: 1.8161 | Train Acc: 0.4489
 Site-MNIST_M                       | Train Loss: 1.8949 | Train Acc: 0.3712
 Site-SVHN                          | Train Loss: 2.0748 | Train Acc: 0.2845
Average Train Accuracy: 0.6999
 Site-MNIST                         | Val  Loss: 0.5550 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.5839 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.5940 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.6309 | Val  Acc: 0.8737
 Site-MNIST                         | Val  Loss: 0.6312 | Val  Acc: 0.8596
 Site-USPS                          | Val  Loss: 0.4889 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.5273 | Val  Acc: 0.8718
 Site-USPS                          | Val  Loss: 0.5391 | Val  Acc: 0.8632
 Site-SynthDigits                   | Val  Loss: 1.7520 | Val  Acc: 0.4773
 Site-SynthDigits                   | Val  Loss: 1.6375 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.7819 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.7989 | Val  Acc: 0.4242
 Site-SVHN                          | Val  Loss: 2.0933 | Val  Acc: 0.2329
Average Valid Accuracy: 0.7069
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8737
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8596
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8942
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8718
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8632
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.4773
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.4242
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.2329
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.5669 | Train Acc: 0.8400
 Site-MNIST                         | Train Loss: 0.5564 | Train Acc: 0.8669
 Site-MNIST                         | Train Loss: 0.6340 | Train Acc: 0.8422
 Site-MNIST                         | Train Loss: 0.5683 | Train Acc: 0.8581
 Site-MNIST                         | Train Loss: 0.5736 | Train Acc: 0.8748
 Site-USPS                          | Train Loss: 0.5320 | Train Acc: 0.8777
 Site-USPS                          | Train Loss: 0.4925 | Train Acc: 0.8962
 Site-USPS                          | Train Loss: 0.4699 | Train Acc: 0.9010
 Site-SynthDigits                   | Train Loss: 1.6277 | Train Acc: 0.4962
 Site-SynthDigits                   | Train Loss: 1.5177 | Train Acc: 0.5530
 Site-MNIST_M                       | Train Loss: 1.8137 | Train Acc: 0.4688
 Site-MNIST_M                       | Train Loss: 1.8675 | Train Acc: 0.3693
 Site-SVHN                          | Train Loss: 2.0766 | Train Acc: 0.2811
Average Train Accuracy: 0.7019
 Site-MNIST                         | Val  Loss: 0.5296 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.5535 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.5662 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.5997 | Val  Acc: 0.8737
 Site-MNIST                         | Val  Loss: 0.6034 | Val  Acc: 0.8561
 Site-USPS                          | Val  Loss: 0.4742 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.5143 | Val  Acc: 0.8782
 Site-USPS                          | Val  Loss: 0.5275 | Val  Acc: 0.8675
 Site-SynthDigits                   | Val  Loss: 1.7312 | Val  Acc: 0.4848
 Site-SynthDigits                   | Val  Loss: 1.6188 | Val  Acc: 0.5152
 Site-MNIST_M                       | Val  Loss: 1.7630 | Val  Acc: 0.5227
 Site-MNIST_M                       | Val  Loss: 1.7756 | Val  Acc: 0.4545
 Site-SVHN                          | Val  Loss: 2.0864 | Val  Acc: 0.2329
Average Valid Accuracy: 0.7133
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8737
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8561
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8942
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8782
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8675
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4848
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.5152
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.5227
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.4545
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.2329
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.5509 | Train Acc: 0.8444
 Site-MNIST                         | Train Loss: 0.5355 | Train Acc: 0.8757
 Site-MNIST                         | Train Loss: 0.6111 | Train Acc: 0.8521
 Site-MNIST                         | Train Loss: 0.5474 | Train Acc: 0.8647
 Site-MNIST                         | Train Loss: 0.5524 | Train Acc: 0.8748
 Site-USPS                          | Train Loss: 0.5191 | Train Acc: 0.8825
 Site-USPS                          | Train Loss: 0.4728 | Train Acc: 0.8994
 Site-USPS                          | Train Loss: 0.4523 | Train Acc: 0.9020
 Site-SynthDigits                   | Train Loss: 1.6212 | Train Acc: 0.4905
 Site-SynthDigits                   | Train Loss: 1.5125 | Train Acc: 0.5556
 Site-MNIST_M                       | Train Loss: 1.7902 | Train Acc: 0.4688
 Site-MNIST_M                       | Train Loss: 1.8872 | Train Acc: 0.3769
 Site-SVHN                          | Train Loss: 2.0581 | Train Acc: 0.2862
Average Train Accuracy: 0.7057
 Site-MNIST                         | Val  Loss: 0.5059 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.5274 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.5441 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.5793 | Val  Acc: 0.8895
 Site-MNIST                         | Val  Loss: 0.5801 | Val  Acc: 0.8632
 Site-USPS                          | Val  Loss: 0.4564 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.4982 | Val  Acc: 0.8782
 Site-USPS                          | Val  Loss: 0.5093 | Val  Acc: 0.8761
 Site-SynthDigits                   | Val  Loss: 1.7143 | Val  Acc: 0.4848
 Site-SynthDigits                   | Val  Loss: 1.6017 | Val  Acc: 0.5051
 Site-MNIST_M                       | Val  Loss: 1.7324 | Val  Acc: 0.5341
 Site-MNIST_M                       | Val  Loss: 1.7512 | Val  Acc: 0.4697
 Site-SVHN                          | Val  Loss: 2.0810 | Val  Acc: 0.2466
Average Valid Accuracy: 0.7192
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8895
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8632
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8942
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8782
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8761
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.4848
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5051
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5341
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.4697
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.2466
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.5343 | Train Acc: 0.8533
 Site-MNIST                         | Train Loss: 0.5276 | Train Acc: 0.8669
 Site-MNIST                         | Train Loss: 0.5894 | Train Acc: 0.8560
 Site-MNIST                         | Train Loss: 0.5286 | Train Acc: 0.8712
 Site-MNIST                         | Train Loss: 0.5306 | Train Acc: 0.8800
 Site-USPS                          | Train Loss: 0.5063 | Train Acc: 0.8825
 Site-USPS                          | Train Loss: 0.4513 | Train Acc: 0.9010
 Site-USPS                          | Train Loss: 0.4329 | Train Acc: 0.9010
 Site-SynthDigits                   | Train Loss: 1.6060 | Train Acc: 0.5019
 Site-SynthDigits                   | Train Loss: 1.4941 | Train Acc: 0.5455
 Site-MNIST_M                       | Train Loss: 1.8055 | Train Acc: 0.4574
 Site-MNIST_M                       | Train Loss: 1.8774 | Train Acc: 0.3807
 Site-SVHN                          | Train Loss: 2.0519 | Train Acc: 0.2811
Average Train Accuracy: 0.7060
 Site-MNIST                         | Val  Loss: 0.4802 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.5000 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.5179 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.5511 | Val  Acc: 0.8947
 Site-MNIST                         | Val  Loss: 0.5555 | Val  Acc: 0.8526
 Site-USPS                          | Val  Loss: 0.4295 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.4762 | Val  Acc: 0.8782
 Site-USPS                          | Val  Loss: 0.4884 | Val  Acc: 0.8675
 Site-SynthDigits                   | Val  Loss: 1.6994 | Val  Acc: 0.4924
 Site-SynthDigits                   | Val  Loss: 1.5913 | Val  Acc: 0.5152
 Site-MNIST_M                       | Val  Loss: 1.7213 | Val  Acc: 0.5227
 Site-MNIST_M                       | Val  Loss: 1.7508 | Val  Acc: 0.4545
 Site-SVHN                          | Val  Loss: 2.0761 | Val  Acc: 0.2397
Average Valid Accuracy: 0.7176
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.4985 | Train Acc: 0.8444
 Site-MNIST                         | Train Loss: 0.5158 | Train Acc: 0.8817
 Site-MNIST                         | Train Loss: 0.5647 | Train Acc: 0.8600
 Site-MNIST                         | Train Loss: 0.5022 | Train Acc: 0.8725
 Site-MNIST                         | Train Loss: 0.5085 | Train Acc: 0.8870
 Site-USPS                          | Train Loss: 0.5068 | Train Acc: 0.8849
 Site-USPS                          | Train Loss: 0.4461 | Train Acc: 0.9010
 Site-USPS                          | Train Loss: 0.4287 | Train Acc: 0.9084
 Site-SynthDigits                   | Train Loss: 1.6105 | Train Acc: 0.5019
 Site-SynthDigits                   | Train Loss: 1.4674 | Train Acc: 0.5518
 Site-MNIST_M                       | Train Loss: 1.7577 | Train Acc: 0.4659
 Site-MNIST_M                       | Train Loss: 1.8479 | Train Acc: 0.3826
 Site-SVHN                          | Train Loss: 2.0510 | Train Acc: 0.2828
Average Train Accuracy: 0.7096
 Site-MNIST                         | Val  Loss: 0.4634 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.4805 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.4993 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.5330 | Val  Acc: 0.9000
 Site-MNIST                         | Val  Loss: 0.5337 | Val  Acc: 0.8702
 Site-USPS                          | Val  Loss: 0.4272 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.4771 | Val  Acc: 0.8718
 Site-USPS                          | Val  Loss: 0.4913 | Val  Acc: 0.8761
 Site-SynthDigits                   | Val  Loss: 1.6742 | Val  Acc: 0.4924
 Site-SynthDigits                   | Val  Loss: 1.5799 | Val  Acc: 0.5101
 Site-MNIST_M                       | Val  Loss: 1.7001 | Val  Acc: 0.5227
 Site-MNIST_M                       | Val  Loss: 1.7232 | Val  Acc: 0.4621
 Site-SVHN                          | Val  Loss: 2.0717 | Val  Acc: 0.2260
Average Valid Accuracy: 0.7195
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9127
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9000
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8702
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8942
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8718
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8761
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.4924
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.5101
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5227
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.4621
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.2260
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.4899 | Train Acc: 0.8578
 Site-MNIST                         | Train Loss: 0.4896 | Train Acc: 0.8817
 Site-MNIST                         | Train Loss: 0.5499 | Train Acc: 0.8619
 Site-MNIST                         | Train Loss: 0.4886 | Train Acc: 0.8804
 Site-MNIST                         | Train Loss: 0.4924 | Train Acc: 0.8879
 Site-USPS                          | Train Loss: 0.4829 | Train Acc: 0.8945
 Site-USPS                          | Train Loss: 0.4270 | Train Acc: 0.9058
 Site-USPS                          | Train Loss: 0.4085 | Train Acc: 0.9095
 Site-SynthDigits                   | Train Loss: 1.5676 | Train Acc: 0.4981
 Site-SynthDigits                   | Train Loss: 1.4566 | Train Acc: 0.5593
 Site-MNIST_M                       | Train Loss: 1.7540 | Train Acc: 0.4631
 Site-MNIST_M                       | Train Loss: 1.8378 | Train Acc: 0.3788
 Site-SVHN                          | Train Loss: 2.0530 | Train Acc: 0.2828
Average Train Accuracy: 0.7124
 Site-MNIST                         | Val  Loss: 0.4452 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4637 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.4819 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.5151 | Val  Acc: 0.9053
 Site-MNIST                         | Val  Loss: 0.5161 | Val  Acc: 0.8702
 Site-USPS                          | Val  Loss: 0.4048 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.4554 | Val  Acc: 0.8718
 Site-USPS                          | Val  Loss: 0.4650 | Val  Acc: 0.8761
 Site-SynthDigits                   | Val  Loss: 1.6630 | Val  Acc: 0.4848
 Site-SynthDigits                   | Val  Loss: 1.5698 | Val  Acc: 0.4949
 Site-MNIST_M                       | Val  Loss: 1.6780 | Val  Acc: 0.5568
 Site-MNIST_M                       | Val  Loss: 1.7134 | Val  Acc: 0.4545
 Site-SVHN                          | Val  Loss: 2.0681 | Val  Acc: 0.2397
Average Valid Accuracy: 0.7211
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9053
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8702
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8942
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8718
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8761
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.4848
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.4949
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.5568
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.4545
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.2397
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.4841 | Train Acc: 0.8667
 Site-MNIST                         | Train Loss: 0.4583 | Train Acc: 0.8846
 Site-MNIST                         | Train Loss: 0.5308 | Train Acc: 0.8718
 Site-MNIST                         | Train Loss: 0.4679 | Train Acc: 0.8817
 Site-MNIST                         | Train Loss: 0.4721 | Train Acc: 0.8905
 Site-USPS                          | Train Loss: 0.4775 | Train Acc: 0.8921
 Site-USPS                          | Train Loss: 0.4164 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.4013 | Train Acc: 0.9137
 Site-SynthDigits                   | Train Loss: 1.5420 | Train Acc: 0.4943
 Site-SynthDigits                   | Train Loss: 1.4412 | Train Acc: 0.5581
 Site-MNIST_M                       | Train Loss: 1.7325 | Train Acc: 0.4773
 Site-MNIST_M                       | Train Loss: 1.8149 | Train Acc: 0.3883
 Site-SVHN                          | Train Loss: 2.0417 | Train Acc: 0.2811
Average Train Accuracy: 0.7161
 Site-MNIST                         | Val  Loss: 0.4311 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.4434 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.4610 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.4956 | Val  Acc: 0.9053
 Site-MNIST                         | Val  Loss: 0.4956 | Val  Acc: 0.8737
 Site-USPS                          | Val  Loss: 0.3927 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.4458 | Val  Acc: 0.8782
 Site-USPS                          | Val  Loss: 0.4564 | Val  Acc: 0.8761
 Site-SynthDigits                   | Val  Loss: 1.6386 | Val  Acc: 0.4848
 Site-SynthDigits                   | Val  Loss: 1.5525 | Val  Acc: 0.4949
 Site-MNIST_M                       | Val  Loss: 1.6603 | Val  Acc: 0.5568
 Site-MNIST_M                       | Val  Loss: 1.6889 | Val  Acc: 0.4697
 Site-SVHN                          | Val  Loss: 2.0641 | Val  Acc: 0.2260
Average Valid Accuracy: 0.7223
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.9053
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8737
 Best site-USPS                      | Epoch:24 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8782
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8761
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.4848
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.4949
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.5568
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.4697
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.2260
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.4690 | Train Acc: 0.8711
 Site-MNIST                         | Train Loss: 0.4918 | Train Acc: 0.8935
 Site-MNIST                         | Train Loss: 0.5147 | Train Acc: 0.8757
 Site-MNIST                         | Train Loss: 0.4556 | Train Acc: 0.8804
 Site-MNIST                         | Train Loss: 0.4615 | Train Acc: 0.8888
 Site-USPS                          | Train Loss: 0.4508 | Train Acc: 0.8921
 Site-USPS                          | Train Loss: 0.4054 | Train Acc: 0.9042
 Site-USPS                          | Train Loss: 0.3847 | Train Acc: 0.9116
 Site-SynthDigits                   | Train Loss: 1.5459 | Train Acc: 0.5000
 Site-SynthDigits                   | Train Loss: 1.4235 | Train Acc: 0.5669
 Site-MNIST_M                       | Train Loss: 1.7339 | Train Acc: 0.4801
 Site-MNIST_M                       | Train Loss: 1.8299 | Train Acc: 0.3902
 Site-SVHN                          | Train Loss: 2.0406 | Train Acc: 0.2811
Average Train Accuracy: 0.7181
 Site-MNIST                         | Val  Loss: 0.4153 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4283 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.4486 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.4821 | Val  Acc: 0.9105
 Site-MNIST                         | Val  Loss: 0.4831 | Val  Acc: 0.8842
 Site-USPS                          | Val  Loss: 0.3778 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.4341 | Val  Acc: 0.8718
 Site-USPS                          | Val  Loss: 0.4436 | Val  Acc: 0.8718
 Site-SynthDigits                   | Val  Loss: 1.6258 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.5293 | Val  Acc: 0.5101
 Site-MNIST_M                       | Val  Loss: 1.6428 | Val  Acc: 0.5568
 Site-MNIST_M                       | Val  Loss: 1.6763 | Val  Acc: 0.4697
 Site-SVHN                          | Val  Loss: 2.0603 | Val  Acc: 0.2260
Average Valid Accuracy: 0.7264
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9105
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8842
 Best site-USPS                      | Epoch:25 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8718
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8718
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.5101
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.5568
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.4697
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.2260
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.4506 | Train Acc: 0.8533
 Site-MNIST                         | Train Loss: 0.4648 | Train Acc: 0.8817
 Site-MNIST                         | Train Loss: 0.5090 | Train Acc: 0.8757
 Site-MNIST                         | Train Loss: 0.4492 | Train Acc: 0.8804
 Site-MNIST                         | Train Loss: 0.4579 | Train Acc: 0.8940
 Site-USPS                          | Train Loss: 0.4461 | Train Acc: 0.8945
 Site-USPS                          | Train Loss: 0.3909 | Train Acc: 0.9121
 Site-USPS                          | Train Loss: 0.3761 | Train Acc: 0.9159
 Site-SynthDigits                   | Train Loss: 1.5256 | Train Acc: 0.4962
 Site-SynthDigits                   | Train Loss: 1.4011 | Train Acc: 0.5707
 Site-MNIST_M                       | Train Loss: 1.7086 | Train Acc: 0.4886
 Site-MNIST_M                       | Train Loss: 1.8099 | Train Acc: 0.3902
 Site-SVHN                          | Train Loss: 2.0587 | Train Acc: 0.2811
Average Train Accuracy: 0.7180
 Site-MNIST                         | Val  Loss: 0.4065 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4180 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.4380 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.4731 | Val  Acc: 0.9053
 Site-MNIST                         | Val  Loss: 0.4741 | Val  Acc: 0.8737
 Site-USPS                          | Val  Loss: 0.3654 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.4281 | Val  Acc: 0.8782
 Site-USPS                          | Val  Loss: 0.4354 | Val  Acc: 0.8803
 Site-SynthDigits                   | Val  Loss: 1.6024 | Val  Acc: 0.4924
 Site-SynthDigits                   | Val  Loss: 1.5216 | Val  Acc: 0.4949
 Site-MNIST_M                       | Val  Loss: 1.6362 | Val  Acc: 0.5682
 Site-MNIST_M                       | Val  Loss: 1.6614 | Val  Acc: 0.4848
 Site-SVHN                          | Val  Loss: 2.0579 | Val  Acc: 0.2260
Average Valid Accuracy: 0.7266
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9053
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8737
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8782
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8803
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.4924
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.4949
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5682
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.4848
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.2260
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.4378 | Train Acc: 0.8756
 Site-MNIST                         | Train Loss: 0.4264 | Train Acc: 0.8964
 Site-MNIST                         | Train Loss: 0.4873 | Train Acc: 0.8817
 Site-MNIST                         | Train Loss: 0.4279 | Train Acc: 0.8883
 Site-MNIST                         | Train Loss: 0.4329 | Train Acc: 0.8905
 Site-USPS                          | Train Loss: 0.4281 | Train Acc: 0.8921
 Site-USPS                          | Train Loss: 0.3780 | Train Acc: 0.9121
 Site-USPS                          | Train Loss: 0.3610 | Train Acc: 0.9191
 Site-SynthDigits                   | Train Loss: 1.5237 | Train Acc: 0.4981
 Site-SynthDigits                   | Train Loss: 1.3960 | Train Acc: 0.5770
 Site-MNIST_M                       | Train Loss: 1.6886 | Train Acc: 0.4830
 Site-MNIST_M                       | Train Loss: 1.8182 | Train Acc: 0.3958
 Site-SVHN                          | Train Loss: 2.0480 | Train Acc: 0.2862
Average Train Accuracy: 0.7228
 Site-MNIST                         | Val  Loss: 0.3928 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.4007 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.4183 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.4534 | Val  Acc: 0.9105
 Site-MNIST                         | Val  Loss: 0.4544 | Val  Acc: 0.8877
 Site-USPS                          | Val  Loss: 0.3547 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.4139 | Val  Acc: 0.8782
 Site-USPS                          | Val  Loss: 0.4199 | Val  Acc: 0.8718
 Site-SynthDigits                   | Val  Loss: 1.5921 | Val  Acc: 0.5076
 Site-SynthDigits                   | Val  Loss: 1.5057 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.6152 | Val  Acc: 0.5795
 Site-MNIST_M                       | Val  Loss: 1.6493 | Val  Acc: 0.4773
 Site-SVHN                          | Val  Loss: 2.0545 | Val  Acc: 0.2260
Average Valid Accuracy: 0.7322
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9127
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9105
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8877
 Best site-USPS                      | Epoch:27 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8782
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8718
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5076
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.5795
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.4773
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.2260
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.4311 | Train Acc: 0.8889
 Site-MNIST                         | Train Loss: 0.4394 | Train Acc: 0.8964
 Site-MNIST                         | Train Loss: 0.4737 | Train Acc: 0.8836
 Site-MNIST                         | Train Loss: 0.4148 | Train Acc: 0.8909
 Site-MNIST                         | Train Loss: 0.4211 | Train Acc: 0.9002
 Site-USPS                          | Train Loss: 0.4309 | Train Acc: 0.8945
 Site-USPS                          | Train Loss: 0.3689 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.3549 | Train Acc: 0.9191
 Site-SynthDigits                   | Train Loss: 1.5102 | Train Acc: 0.4962
 Site-SynthDigits                   | Train Loss: 1.3849 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.7047 | Train Acc: 0.4858
 Site-MNIST_M                       | Train Loss: 1.7875 | Train Acc: 0.3939
 Site-SVHN                          | Train Loss: 1.9960 | Train Acc: 0.2947
Average Train Accuracy: 0.7256
 Site-MNIST                         | Val  Loss: 0.3769 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.3879 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.4068 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4406 | Val  Acc: 0.9158
 Site-MNIST                         | Val  Loss: 0.4404 | Val  Acc: 0.8877
 Site-USPS                          | Val  Loss: 0.3456 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.4018 | Val  Acc: 0.8782
 Site-USPS                          | Val  Loss: 0.4116 | Val  Acc: 0.8761
 Site-SynthDigits                   | Val  Loss: 1.5796 | Val  Acc: 0.4924
 Site-SynthDigits                   | Val  Loss: 1.4976 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.6041 | Val  Acc: 0.5682
 Site-MNIST_M                       | Val  Loss: 1.6419 | Val  Acc: 0.4848
 Site-SVHN                          | Val  Loss: 2.0448 | Val  Acc: 0.2534
Average Valid Accuracy: 0.7348
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9158
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.8877
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8782
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8761
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.4924
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.5682
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.4848
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.2534
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.4156 | Train Acc: 0.8800
 Site-MNIST                         | Train Loss: 0.4134 | Train Acc: 0.8905
 Site-MNIST                         | Train Loss: 0.4627 | Train Acc: 0.8876
 Site-MNIST                         | Train Loss: 0.4046 | Train Acc: 0.8896
 Site-MNIST                         | Train Loss: 0.4100 | Train Acc: 0.9028
 Site-USPS                          | Train Loss: 0.4189 | Train Acc: 0.8921
 Site-USPS                          | Train Loss: 0.3667 | Train Acc: 0.9121
 Site-USPS                          | Train Loss: 0.3503 | Train Acc: 0.9180
 Site-SynthDigits                   | Train Loss: 1.5072 | Train Acc: 0.5152
 Site-SynthDigits                   | Train Loss: 1.3623 | Train Acc: 0.5833
 Site-MNIST_M                       | Train Loss: 1.6962 | Train Acc: 0.4830
 Site-MNIST_M                       | Train Loss: 1.8000 | Train Acc: 0.3996
 Site-SVHN                          | Train Loss: 2.0131 | Train Acc: 0.2879
Average Train Accuracy: 0.7263
 Site-MNIST                         | Val  Loss: 0.3664 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.3779 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3935 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4269 | Val  Acc: 0.9105
 Site-MNIST                         | Val  Loss: 0.4281 | Val  Acc: 0.8807
 Site-USPS                          | Val  Loss: 0.3367 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.4017 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.4091 | Val  Acc: 0.8846
 Site-SynthDigits                   | Val  Loss: 1.5612 | Val  Acc: 0.5227
 Site-SynthDigits                   | Val  Loss: 1.4826 | Val  Acc: 0.5101
 Site-MNIST_M                       | Val  Loss: 1.6036 | Val  Acc: 0.5568
 Site-MNIST_M                       | Val  Loss: 1.6276 | Val  Acc: 0.4848
 Site-SVHN                          | Val  Loss: 2.0423 | Val  Acc: 0.2329
Average Valid Accuracy: 0.7361
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9105
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8807
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8846
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5227
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5101
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.5568
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.4848
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.2329
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.4111 | Train Acc: 0.8889
 Site-MNIST                         | Train Loss: 0.3810 | Train Acc: 0.8935
 Site-MNIST                         | Train Loss: 0.4510 | Train Acc: 0.8856
 Site-MNIST                         | Train Loss: 0.3938 | Train Acc: 0.8949
 Site-MNIST                         | Train Loss: 0.3987 | Train Acc: 0.9011
 Site-USPS                          | Train Loss: 0.4162 | Train Acc: 0.8969
 Site-USPS                          | Train Loss: 0.3570 | Train Acc: 0.9169
 Site-USPS                          | Train Loss: 0.3417 | Train Acc: 0.9201
 Site-SynthDigits                   | Train Loss: 1.4692 | Train Acc: 0.5095
 Site-SynthDigits                   | Train Loss: 1.3422 | Train Acc: 0.5934
 Site-MNIST_M                       | Train Loss: 1.6813 | Train Acc: 0.4858
 Site-MNIST_M                       | Train Loss: 1.8062 | Train Acc: 0.4053
 Site-SVHN                          | Train Loss: 2.0303 | Train Acc: 0.2964
Average Train Accuracy: 0.7299
 Site-MNIST                         | Val  Loss: 0.3585 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.3651 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3844 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4187 | Val  Acc: 0.9105
 Site-MNIST                         | Val  Loss: 0.4180 | Val  Acc: 0.8842
 Site-USPS                          | Val  Loss: 0.3317 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3917 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.4004 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.5518 | Val  Acc: 0.5152
 Site-SynthDigits                   | Val  Loss: 1.4650 | Val  Acc: 0.5152
 Site-MNIST_M                       | Val  Loss: 1.5710 | Val  Acc: 0.5568
 Site-MNIST_M                       | Val  Loss: 1.6065 | Val  Acc: 0.4848
 Site-SVHN                          | Val  Loss: 2.0335 | Val  Acc: 0.2534
Average Valid Accuracy: 0.7381
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9105
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8842
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5152
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5152
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5568
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.4848
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.2534
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.4217 | Train Acc: 0.8800
 Site-MNIST                         | Train Loss: 0.4024 | Train Acc: 0.8994
 Site-MNIST                         | Train Loss: 0.4470 | Train Acc: 0.8856
 Site-MNIST                         | Train Loss: 0.3911 | Train Acc: 0.8883
 Site-MNIST                         | Train Loss: 0.3972 | Train Acc: 0.9063
 Site-USPS                          | Train Loss: 0.4028 | Train Acc: 0.9017
 Site-USPS                          | Train Loss: 0.3469 | Train Acc: 0.9137
 Site-USPS                          | Train Loss: 0.3326 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.4415 | Train Acc: 0.5170
 Site-SynthDigits                   | Train Loss: 1.3469 | Train Acc: 0.5909
 Site-MNIST_M                       | Train Loss: 1.6627 | Train Acc: 0.4858
 Site-MNIST_M                       | Train Loss: 1.7935 | Train Acc: 0.4053
 Site-SVHN                          | Train Loss: 1.9885 | Train Acc: 0.2964
Average Train Accuracy: 0.7301
 Site-MNIST                         | Val  Loss: 0.3519 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.3595 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3798 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4122 | Val  Acc: 0.9158
 Site-MNIST                         | Val  Loss: 0.4111 | Val  Acc: 0.8912
 Site-USPS                          | Val  Loss: 0.3214 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3789 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.3861 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.5340 | Val  Acc: 0.5076
 Site-SynthDigits                   | Val  Loss: 1.4576 | Val  Acc: 0.5253
 Site-MNIST_M                       | Val  Loss: 1.5586 | Val  Acc: 0.5568
 Site-MNIST_M                       | Val  Loss: 1.6004 | Val  Acc: 0.4848
 Site-SVHN                          | Val  Loss: 2.0247 | Val  Acc: 0.2534
Average Valid Accuracy: 0.7388
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9158
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8912
 Best site-USPS                      | Epoch:31 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8846
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5076
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5253
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.5568
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.4848
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.2534
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.4195 | Train Acc: 0.8800
 Site-MNIST                         | Train Loss: 0.3744 | Train Acc: 0.8964
 Site-MNIST                         | Train Loss: 0.4442 | Train Acc: 0.8777
 Site-MNIST                         | Train Loss: 0.3877 | Train Acc: 0.8896
 Site-MNIST                         | Train Loss: 0.3971 | Train Acc: 0.9037
 Site-USPS                          | Train Loss: 0.4024 | Train Acc: 0.8945
 Site-USPS                          | Train Loss: 0.3468 | Train Acc: 0.9121
 Site-USPS                          | Train Loss: 0.3279 | Train Acc: 0.9180
 Site-SynthDigits                   | Train Loss: 1.4265 | Train Acc: 0.5227
 Site-SynthDigits                   | Train Loss: 1.3345 | Train Acc: 0.6035
 Site-MNIST_M                       | Train Loss: 1.6557 | Train Acc: 0.4915
 Site-MNIST_M                       | Train Loss: 1.7726 | Train Acc: 0.4034
 Site-SVHN                          | Train Loss: 1.9811 | Train Acc: 0.3032
Average Train Accuracy: 0.7305
 Site-MNIST                         | Val  Loss: 0.3463 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.3522 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3769 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.4140 | Val  Acc: 0.9000
 Site-MNIST                         | Val  Loss: 0.4110 | Val  Acc: 0.8912
 Site-USPS                          | Val  Loss: 0.3193 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3834 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.3868 | Val  Acc: 0.8932
 Site-SynthDigits                   | Val  Loss: 1.5214 | Val  Acc: 0.5227
 Site-SynthDigits                   | Val  Loss: 1.4361 | Val  Acc: 0.5303
 Site-MNIST_M                       | Val  Loss: 1.5362 | Val  Acc: 0.5682
 Site-MNIST_M                       | Val  Loss: 1.5769 | Val  Acc: 0.4924
 Site-SVHN                          | Val  Loss: 2.0196 | Val  Acc: 0.2534
Average Valid Accuracy: 0.7402
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9127
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9000
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8912
 Best site-USPS                      | Epoch:32 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8932
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.5227
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.5303
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.5682
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.4924
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.2534
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.3906 | Train Acc: 0.8844
 Site-MNIST                         | Train Loss: 0.3869 | Train Acc: 0.9053
 Site-MNIST                         | Train Loss: 0.4257 | Train Acc: 0.8856
 Site-MNIST                         | Train Loss: 0.3698 | Train Acc: 0.9001
 Site-MNIST                         | Train Loss: 0.3746 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.3813 | Train Acc: 0.9017
 Site-USPS                          | Train Loss: 0.3342 | Train Acc: 0.9153
 Site-USPS                          | Train Loss: 0.3214 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.4165 | Train Acc: 0.5189
 Site-SynthDigits                   | Train Loss: 1.3153 | Train Acc: 0.6023
 Site-MNIST_M                       | Train Loss: 1.6493 | Train Acc: 0.4915
 Site-MNIST_M                       | Train Loss: 1.7587 | Train Acc: 0.4034
 Site-SVHN                          | Train Loss: 2.0098 | Train Acc: 0.2998
Average Train Accuracy: 0.7337
 Site-MNIST                         | Val  Loss: 0.3332 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.3380 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3569 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3900 | Val  Acc: 0.9158
 Site-MNIST                         | Val  Loss: 0.3877 | Val  Acc: 0.8982
 Site-USPS                          | Val  Loss: 0.3067 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3701 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.3768 | Val  Acc: 0.8974
 Site-SynthDigits                   | Val  Loss: 1.5070 | Val  Acc: 0.5227
 Site-SynthDigits                   | Val  Loss: 1.4284 | Val  Acc: 0.5354
 Site-MNIST_M                       | Val  Loss: 1.5390 | Val  Acc: 0.5682
 Site-MNIST_M                       | Val  Loss: 1.5701 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 2.0188 | Val  Acc: 0.2534
Average Valid Accuracy: 0.7444
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9158
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8982
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8974
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.5227
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.5354
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5682
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.2534
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.3761 | Train Acc: 0.8889
 Site-MNIST                         | Train Loss: 0.3461 | Train Acc: 0.9053
 Site-MNIST                         | Train Loss: 0.4203 | Train Acc: 0.8876
 Site-MNIST                         | Train Loss: 0.3648 | Train Acc: 0.8988
 Site-MNIST                         | Train Loss: 0.3727 | Train Acc: 0.9107
 Site-USPS                          | Train Loss: 0.3794 | Train Acc: 0.9017
 Site-USPS                          | Train Loss: 0.3291 | Train Acc: 0.9121
 Site-USPS                          | Train Loss: 0.3140 | Train Acc: 0.9201
 Site-SynthDigits                   | Train Loss: 1.4340 | Train Acc: 0.5246
 Site-SynthDigits                   | Train Loss: 1.3132 | Train Acc: 0.6061
 Site-MNIST_M                       | Train Loss: 1.6367 | Train Acc: 0.5000
 Site-MNIST_M                       | Train Loss: 1.7408 | Train Acc: 0.4110
 Site-SVHN                          | Train Loss: 1.9750 | Train Acc: 0.2981
Average Train Accuracy: 0.7358
 Site-MNIST                         | Val  Loss: 0.3249 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.3262 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3533 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3863 | Val  Acc: 0.9158
 Site-MNIST                         | Val  Loss: 0.3838 | Val  Acc: 0.8982
 Site-USPS                          | Val  Loss: 0.3033 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3691 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.3738 | Val  Acc: 0.8932
 Site-SynthDigits                   | Val  Loss: 1.4926 | Val  Acc: 0.5152
 Site-SynthDigits                   | Val  Loss: 1.4168 | Val  Acc: 0.5404
 Site-MNIST_M                       | Val  Loss: 1.5206 | Val  Acc: 0.5795
 Site-MNIST_M                       | Val  Loss: 1.5546 | Val  Acc: 0.5076
 Site-SVHN                          | Val  Loss: 2.0145 | Val  Acc: 0.2466
Average Valid Accuracy: 0.7444
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.3921 | Train Acc: 0.8978
 Site-MNIST                         | Train Loss: 0.3436 | Train Acc: 0.9112
 Site-MNIST                         | Train Loss: 0.4079 | Train Acc: 0.8895
 Site-MNIST                         | Train Loss: 0.3537 | Train Acc: 0.9001
 Site-MNIST                         | Train Loss: 0.3617 | Train Acc: 0.9116
 Site-USPS                          | Train Loss: 0.3774 | Train Acc: 0.9017
 Site-USPS                          | Train Loss: 0.3228 | Train Acc: 0.9185
 Site-USPS                          | Train Loss: 0.3070 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.4363 | Train Acc: 0.5208
 Site-SynthDigits                   | Train Loss: 1.3011 | Train Acc: 0.6073
 Site-MNIST_M                       | Train Loss: 1.6221 | Train Acc: 0.4943
 Site-MNIST_M                       | Train Loss: 1.7623 | Train Acc: 0.4110
 Site-SVHN                          | Train Loss: 1.9742 | Train Acc: 0.2964
Average Train Accuracy: 0.7370
 Site-MNIST                         | Val  Loss: 0.3199 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.3204 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3435 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3741 | Val  Acc: 0.9158
 Site-MNIST                         | Val  Loss: 0.3711 | Val  Acc: 0.9053
 Site-USPS                          | Val  Loss: 0.2958 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3566 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.3638 | Val  Acc: 0.8932
 Site-SynthDigits                   | Val  Loss: 1.4827 | Val  Acc: 0.5227
 Site-SynthDigits                   | Val  Loss: 1.4138 | Val  Acc: 0.5404
 Site-MNIST_M                       | Val  Loss: 1.5139 | Val  Acc: 0.5682
 Site-MNIST_M                       | Val  Loss: 1.5505 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 2.0105 | Val  Acc: 0.2466
Average Valid Accuracy: 0.7445
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9158
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9053
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:35 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:35 | Val Acc: 0.8932
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.5227
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.5404
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.5682
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.2466
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.3849 | Train Acc: 0.8889
 Site-MNIST                         | Train Loss: 0.3441 | Train Acc: 0.9112
 Site-MNIST                         | Train Loss: 0.4034 | Train Acc: 0.8876
 Site-MNIST                         | Train Loss: 0.3486 | Train Acc: 0.8988
 Site-MNIST                         | Train Loss: 0.3562 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.3695 | Train Acc: 0.9041
 Site-USPS                          | Train Loss: 0.3158 | Train Acc: 0.9153
 Site-USPS                          | Train Loss: 0.3040 | Train Acc: 0.9223
 Site-SynthDigits                   | Train Loss: 1.4058 | Train Acc: 0.5246
 Site-SynthDigits                   | Train Loss: 1.2786 | Train Acc: 0.6136
 Site-MNIST_M                       | Train Loss: 1.6225 | Train Acc: 0.5000
 Site-MNIST_M                       | Train Loss: 1.7226 | Train Acc: 0.4148
 Site-SVHN                          | Train Loss: 1.9568 | Train Acc: 0.2998
Average Train Accuracy: 0.7381
 Site-MNIST                         | Val  Loss: 0.3105 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.3113 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3357 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3700 | Val  Acc: 0.9158
 Site-MNIST                         | Val  Loss: 0.3667 | Val  Acc: 0.9053
 Site-USPS                          | Val  Loss: 0.2932 | Val  Acc: 0.9135
 Site-USPS                          | Val  Loss: 0.3565 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.3615 | Val  Acc: 0.8932
 Site-SynthDigits                   | Val  Loss: 1.4712 | Val  Acc: 0.5303
 Site-SynthDigits                   | Val  Loss: 1.3994 | Val  Acc: 0.5455
 Site-MNIST_M                       | Val  Loss: 1.4947 | Val  Acc: 0.5795
 Site-MNIST_M                       | Val  Loss: 1.5381 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 2.0048 | Val  Acc: 0.2397
Average Valid Accuracy: 0.7461
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9158
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9053
 Best site-USPS                      | Epoch:36 | Val Acc: 0.9135
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8846
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8932
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.5303
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.5455
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.5795
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.2397
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.3439 | Train Acc: 0.8978
 Site-MNIST                         | Train Loss: 0.3158 | Train Acc: 0.9142
 Site-MNIST                         | Train Loss: 0.3915 | Train Acc: 0.8895
 Site-MNIST                         | Train Loss: 0.3370 | Train Acc: 0.9054
 Site-MNIST                         | Train Loss: 0.3425 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.3750 | Train Acc: 0.9041
 Site-USPS                          | Train Loss: 0.3139 | Train Acc: 0.9185
 Site-USPS                          | Train Loss: 0.3024 | Train Acc: 0.9255
 Site-SynthDigits                   | Train Loss: 1.4030 | Train Acc: 0.5303
 Site-SynthDigits                   | Train Loss: 1.2849 | Train Acc: 0.6187
 Site-MNIST_M                       | Train Loss: 1.6157 | Train Acc: 0.4972
 Site-MNIST_M                       | Train Loss: 1.7582 | Train Acc: 0.4186
 Site-SVHN                          | Train Loss: 2.0029 | Train Acc: 0.2964
Average Train Accuracy: 0.7408
 Site-MNIST                         | Val  Loss: 0.3035 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.3038 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3253 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3612 | Val  Acc: 0.9158
 Site-MNIST                         | Val  Loss: 0.3566 | Val  Acc: 0.9088
 Site-USPS                          | Val  Loss: 0.2909 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3550 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.3590 | Val  Acc: 0.8974
 Site-SynthDigits                   | Val  Loss: 1.4622 | Val  Acc: 0.5303
 Site-SynthDigits                   | Val  Loss: 1.3863 | Val  Acc: 0.5505
 Site-MNIST_M                       | Val  Loss: 1.4853 | Val  Acc: 0.5795
 Site-MNIST_M                       | Val  Loss: 1.5231 | Val  Acc: 0.4848
 Site-SVHN                          | Val  Loss: 2.0115 | Val  Acc: 0.2603
Average Valid Accuracy: 0.7472
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9158
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9088
 Best site-USPS                      | Epoch:37 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8974
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.5303
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.5505
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.5795
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.4848
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.2603
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.3624 | Train Acc: 0.8933
 Site-MNIST                         | Train Loss: 0.3153 | Train Acc: 0.9142
 Site-MNIST                         | Train Loss: 0.3862 | Train Acc: 0.8974
 Site-MNIST                         | Train Loss: 0.3327 | Train Acc: 0.9041
 Site-MNIST                         | Train Loss: 0.3403 | Train Acc: 0.9159
 Site-USPS                          | Train Loss: 0.3750 | Train Acc: 0.9065
 Site-USPS                          | Train Loss: 0.3051 | Train Acc: 0.9169
 Site-USPS                          | Train Loss: 0.2926 | Train Acc: 0.9244
 Site-SynthDigits                   | Train Loss: 1.3909 | Train Acc: 0.5398
 Site-SynthDigits                   | Train Loss: 1.2698 | Train Acc: 0.6187
 Site-MNIST_M                       | Train Loss: 1.6224 | Train Acc: 0.4943
 Site-MNIST_M                       | Train Loss: 1.7335 | Train Acc: 0.4186
 Site-SVHN                          | Train Loss: 1.9670 | Train Acc: 0.3015
Average Train Accuracy: 0.7420
 Site-MNIST                         | Val  Loss: 0.2990 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2965 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3187 | Val  Acc: 0.9444
 Site-MNIST                         | Val  Loss: 0.3544 | Val  Acc: 0.9263
 Site-MNIST                         | Val  Loss: 0.3499 | Val  Acc: 0.9088
 Site-USPS                          | Val  Loss: 0.2811 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3456 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.3491 | Val  Acc: 0.8974
 Site-SynthDigits                   | Val  Loss: 1.4477 | Val  Acc: 0.5379
 Site-SynthDigits                   | Val  Loss: 1.3766 | Val  Acc: 0.5606
 Site-MNIST_M                       | Val  Loss: 1.4798 | Val  Acc: 0.5795
 Site-MNIST_M                       | Val  Loss: 1.5142 | Val  Acc: 0.5076
 Site-SVHN                          | Val  Loss: 2.0048 | Val  Acc: 0.2534
Average Valid Accuracy: 0.7528
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9444
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9263
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9088
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:38 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:38 | Val Acc: 0.8974
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.5379
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.5606
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.5795
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.5076
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.2534
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.3545 | Train Acc: 0.8978
 Site-MNIST                         | Train Loss: 0.3194 | Train Acc: 0.9172
 Site-MNIST                         | Train Loss: 0.3778 | Train Acc: 0.8935
 Site-MNIST                         | Train Loss: 0.3260 | Train Acc: 0.9028
 Site-MNIST                         | Train Loss: 0.3318 | Train Acc: 0.9159
 Site-USPS                          | Train Loss: 0.3562 | Train Acc: 0.9041
 Site-USPS                          | Train Loss: 0.3005 | Train Acc: 0.9217
 Site-USPS                          | Train Loss: 0.2890 | Train Acc: 0.9244
 Site-SynthDigits                   | Train Loss: 1.3870 | Train Acc: 0.5360
 Site-SynthDigits                   | Train Loss: 1.2675 | Train Acc: 0.6275
 Site-MNIST_M                       | Train Loss: 1.6089 | Train Acc: 0.5057
 Site-MNIST_M                       | Train Loss: 1.7077 | Train Acc: 0.4242
 Site-SVHN                          | Train Loss: 1.9388 | Train Acc: 0.3049
Average Train Accuracy: 0.7443
 Site-MNIST                         | Val  Loss: 0.2933 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2923 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3118 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3474 | Val  Acc: 0.9211
 Site-MNIST                         | Val  Loss: 0.3428 | Val  Acc: 0.9123
 Site-USPS                          | Val  Loss: 0.2755 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3427 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.3472 | Val  Acc: 0.8974
 Site-SynthDigits                   | Val  Loss: 1.4432 | Val  Acc: 0.5455
 Site-SynthDigits                   | Val  Loss: 1.3658 | Val  Acc: 0.5606
 Site-MNIST_M                       | Val  Loss: 1.4755 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.5052 | Val  Acc: 0.5076
 Site-SVHN                          | Val  Loss: 2.0031 | Val  Acc: 0.2466
Average Valid Accuracy: 0.7520
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.3420 | Train Acc: 0.9067
 Site-MNIST                         | Train Loss: 0.2957 | Train Acc: 0.9201
 Site-MNIST                         | Train Loss: 0.3700 | Train Acc: 0.8955
 Site-MNIST                         | Train Loss: 0.3172 | Train Acc: 0.9054
 Site-MNIST                         | Train Loss: 0.3228 | Train Acc: 0.9186
 Site-USPS                          | Train Loss: 0.3546 | Train Acc: 0.9041
 Site-USPS                          | Train Loss: 0.2963 | Train Acc: 0.9185
 Site-USPS                          | Train Loss: 0.2858 | Train Acc: 0.9265
 Site-SynthDigits                   | Train Loss: 1.3610 | Train Acc: 0.5379
 Site-SynthDigits                   | Train Loss: 1.2339 | Train Acc: 0.6263
 Site-MNIST_M                       | Train Loss: 1.5865 | Train Acc: 0.4886
 Site-MNIST_M                       | Train Loss: 1.7232 | Train Acc: 0.4261
 Site-SVHN                          | Train Loss: 1.9684 | Train Acc: 0.2998
Average Train Accuracy: 0.7442
 Site-MNIST                         | Val  Loss: 0.2852 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2837 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3058 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3417 | Val  Acc: 0.9263
 Site-MNIST                         | Val  Loss: 0.3340 | Val  Acc: 0.9158
 Site-USPS                          | Val  Loss: 0.2751 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3391 | Val  Acc: 0.8974
 Site-USPS                          | Val  Loss: 0.3444 | Val  Acc: 0.9017
 Site-SynthDigits                   | Val  Loss: 1.4339 | Val  Acc: 0.5303
 Site-SynthDigits                   | Val  Loss: 1.3590 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.4593 | Val  Acc: 0.5795
 Site-MNIST_M                       | Val  Loss: 1.4950 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 2.0072 | Val  Acc: 0.2603
Average Valid Accuracy: 0.7516
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.3609 | Train Acc: 0.8933
 Site-MNIST                         | Train Loss: 0.3086 | Train Acc: 0.9172
 Site-MNIST                         | Train Loss: 0.3702 | Train Acc: 0.8955
 Site-MNIST                         | Train Loss: 0.3163 | Train Acc: 0.9067
 Site-MNIST                         | Train Loss: 0.3249 | Train Acc: 0.9177
 Site-USPS                          | Train Loss: 0.3468 | Train Acc: 0.9065
 Site-USPS                          | Train Loss: 0.2954 | Train Acc: 0.9233
 Site-USPS                          | Train Loss: 0.2819 | Train Acc: 0.9233
 Site-SynthDigits                   | Train Loss: 1.3681 | Train Acc: 0.5398
 Site-SynthDigits                   | Train Loss: 1.2351 | Train Acc: 0.6237
 Site-MNIST_M                       | Train Loss: 1.5956 | Train Acc: 0.4915
 Site-MNIST_M                       | Train Loss: 1.6988 | Train Acc: 0.4242
 Site-SVHN                          | Train Loss: 1.9625 | Train Acc: 0.3152
Average Train Accuracy: 0.7445
 Site-MNIST                         | Val  Loss: 0.2833 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2847 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3058 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3393 | Val  Acc: 0.9211
 Site-MNIST                         | Val  Loss: 0.3333 | Val  Acc: 0.9123
 Site-USPS                          | Val  Loss: 0.2717 | Val  Acc: 0.9135
 Site-USPS                          | Val  Loss: 0.3392 | Val  Acc: 0.8974
 Site-USPS                          | Val  Loss: 0.3432 | Val  Acc: 0.9017
 Site-SynthDigits                   | Val  Loss: 1.4181 | Val  Acc: 0.5379
 Site-SynthDigits                   | Val  Loss: 1.3452 | Val  Acc: 0.5606
 Site-MNIST_M                       | Val  Loss: 1.4568 | Val  Acc: 0.5795
 Site-MNIST_M                       | Val  Loss: 1.4882 | Val  Acc: 0.4924
 Site-SVHN                          | Val  Loss: 1.9960 | Val  Acc: 0.2603
Average Valid Accuracy: 0.7520
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.3652 | Train Acc: 0.9022
 Site-MNIST                         | Train Loss: 0.3184 | Train Acc: 0.9172
 Site-MNIST                         | Train Loss: 0.3600 | Train Acc: 0.8974
 Site-MNIST                         | Train Loss: 0.3104 | Train Acc: 0.9080
 Site-MNIST                         | Train Loss: 0.3161 | Train Acc: 0.9203
 Site-USPS                          | Train Loss: 0.3429 | Train Acc: 0.9065
 Site-USPS                          | Train Loss: 0.2880 | Train Acc: 0.9201
 Site-USPS                          | Train Loss: 0.2787 | Train Acc: 0.9255
 Site-SynthDigits                   | Train Loss: 1.3371 | Train Acc: 0.5455
 Site-SynthDigits                   | Train Loss: 1.2125 | Train Acc: 0.6263
 Site-MNIST_M                       | Train Loss: 1.5983 | Train Acc: 0.5028
 Site-MNIST_M                       | Train Loss: 1.6881 | Train Acc: 0.4223
 Site-SVHN                          | Train Loss: 1.9739 | Train Acc: 0.3083
Average Train Accuracy: 0.7463
 Site-MNIST                         | Val  Loss: 0.2776 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2802 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2978 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3289 | Val  Acc: 0.9105
 Site-MNIST                         | Val  Loss: 0.3233 | Val  Acc: 0.9123
 Site-USPS                          | Val  Loss: 0.2658 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3291 | Val  Acc: 0.8974
 Site-USPS                          | Val  Loss: 0.3365 | Val  Acc: 0.9017
 Site-SynthDigits                   | Val  Loss: 1.4182 | Val  Acc: 0.5379
 Site-SynthDigits                   | Val  Loss: 1.3381 | Val  Acc: 0.5657
 Site-MNIST_M                       | Val  Loss: 1.4668 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.4923 | Val  Acc: 0.5152
 Site-SVHN                          | Val  Loss: 1.9941 | Val  Acc: 0.2466
Average Valid Accuracy: 0.7533
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9365
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9105
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9123
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8974
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9017
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.5379
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.5657
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.5909
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.5152
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.2466
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.3286 | Train Acc: 0.9022
 Site-MNIST                         | Train Loss: 0.3038 | Train Acc: 0.9201
 Site-MNIST                         | Train Loss: 0.3565 | Train Acc: 0.8994
 Site-MNIST                         | Train Loss: 0.3077 | Train Acc: 0.9054
 Site-MNIST                         | Train Loss: 0.3115 | Train Acc: 0.9238
 Site-USPS                          | Train Loss: 0.3308 | Train Acc: 0.9065
 Site-USPS                          | Train Loss: 0.2841 | Train Acc: 0.9249
 Site-USPS                          | Train Loss: 0.2728 | Train Acc: 0.9265
 Site-SynthDigits                   | Train Loss: 1.3903 | Train Acc: 0.5473
 Site-SynthDigits                   | Train Loss: 1.2231 | Train Acc: 0.6326
 Site-MNIST_M                       | Train Loss: 1.5778 | Train Acc: 0.5085
 Site-MNIST_M                       | Train Loss: 1.7006 | Train Acc: 0.4242
 Site-SVHN                          | Train Loss: 1.9520 | Train Acc: 0.3118
Average Train Accuracy: 0.7487
 Site-MNIST                         | Val  Loss: 0.2719 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2745 | Val  Acc: 0.9405
 Site-MNIST                         | Val  Loss: 0.2918 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.3258 | Val  Acc: 0.9211
 Site-MNIST                         | Val  Loss: 0.3204 | Val  Acc: 0.9158
 Site-USPS                          | Val  Loss: 0.2596 | Val  Acc: 0.9135
 Site-USPS                          | Val  Loss: 0.3257 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3308 | Val  Acc: 0.9060
 Site-SynthDigits                   | Val  Loss: 1.4048 | Val  Acc: 0.5455
 Site-SynthDigits                   | Val  Loss: 1.3227 | Val  Acc: 0.5657
 Site-MNIST_M                       | Val  Loss: 1.4464 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.4774 | Val  Acc: 0.5152
 Site-SVHN                          | Val  Loss: 1.9892 | Val  Acc: 0.2603
Average Valid Accuracy: 0.7606
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9405
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9211
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9158
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9135
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9060
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.5455
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.5657
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.6023
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.5152
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.2603
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.3202 | Train Acc: 0.8978
 Site-MNIST                         | Train Loss: 0.3017 | Train Acc: 0.9201
 Site-MNIST                         | Train Loss: 0.3521 | Train Acc: 0.8955
 Site-MNIST                         | Train Loss: 0.3015 | Train Acc: 0.9080
 Site-MNIST                         | Train Loss: 0.3070 | Train Acc: 0.9229
 Site-USPS                          | Train Loss: 0.3324 | Train Acc: 0.9065
 Site-USPS                          | Train Loss: 0.2786 | Train Acc: 0.9265
 Site-USPS                          | Train Loss: 0.2691 | Train Acc: 0.9286
 Site-SynthDigits                   | Train Loss: 1.3382 | Train Acc: 0.5530
 Site-SynthDigits                   | Train Loss: 1.2108 | Train Acc: 0.6338
 Site-MNIST_M                       | Train Loss: 1.5568 | Train Acc: 0.5000
 Site-MNIST_M                       | Train Loss: 1.6795 | Train Acc: 0.4280
 Site-SVHN                          | Train Loss: 1.9231 | Train Acc: 0.3220
Average Train Accuracy: 0.7494
 Site-MNIST                         | Val  Loss: 0.2663 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2666 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.2899 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3208 | Val  Acc: 0.9158
 Site-MNIST                         | Val  Loss: 0.3139 | Val  Acc: 0.9158
 Site-USPS                          | Val  Loss: 0.2555 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.3208 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3258 | Val  Acc: 0.9060
 Site-SynthDigits                   | Val  Loss: 1.3915 | Val  Acc: 0.5455
 Site-SynthDigits                   | Val  Loss: 1.3159 | Val  Acc: 0.5606
 Site-MNIST_M                       | Val  Loss: 1.4400 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.4675 | Val  Acc: 0.5076
 Site-SVHN                          | Val  Loss: 1.9881 | Val  Acc: 0.2740
Average Valid Accuracy: 0.7565
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.3217 | Train Acc: 0.8978
 Site-MNIST                         | Train Loss: 0.2907 | Train Acc: 0.9290
 Site-MNIST                         | Train Loss: 0.3468 | Train Acc: 0.8974
 Site-MNIST                         | Train Loss: 0.2970 | Train Acc: 0.9106
 Site-MNIST                         | Train Loss: 0.3024 | Train Acc: 0.9238
 Site-USPS                          | Train Loss: 0.3284 | Train Acc: 0.9041
 Site-USPS                          | Train Loss: 0.2778 | Train Acc: 0.9265
 Site-USPS                          | Train Loss: 0.2645 | Train Acc: 0.9297
 Site-SynthDigits                   | Train Loss: 1.3251 | Train Acc: 0.5568
 Site-SynthDigits                   | Train Loss: 1.2134 | Train Acc: 0.6465
 Site-MNIST_M                       | Train Loss: 1.5704 | Train Acc: 0.4972
 Site-MNIST_M                       | Train Loss: 1.6797 | Train Acc: 0.4242
 Site-SVHN                          | Train Loss: 1.9648 | Train Acc: 0.3237
Average Train Accuracy: 0.7513
 Site-MNIST                         | Val  Loss: 0.2620 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2613 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.2832 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3177 | Val  Acc: 0.9211
 Site-MNIST                         | Val  Loss: 0.3095 | Val  Acc: 0.9263
 Site-USPS                          | Val  Loss: 0.2520 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.3198 | Val  Acc: 0.8974
 Site-USPS                          | Val  Loss: 0.3238 | Val  Acc: 0.9017
 Site-SynthDigits                   | Val  Loss: 1.3815 | Val  Acc: 0.5606
 Site-SynthDigits                   | Val  Loss: 1.3047 | Val  Acc: 0.5758
 Site-MNIST_M                       | Val  Loss: 1.4224 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.4586 | Val  Acc: 0.5076
 Site-SVHN                          | Val  Loss: 1.9836 | Val  Acc: 0.2740
Average Valid Accuracy: 0.7592
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.3255 | Train Acc: 0.9022
 Site-MNIST                         | Train Loss: 0.2886 | Train Acc: 0.9201
 Site-MNIST                         | Train Loss: 0.3437 | Train Acc: 0.8994
 Site-MNIST                         | Train Loss: 0.2940 | Train Acc: 0.9146
 Site-MNIST                         | Train Loss: 0.2986 | Train Acc: 0.9256
 Site-USPS                          | Train Loss: 0.3253 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.2724 | Train Acc: 0.9297
 Site-USPS                          | Train Loss: 0.2609 | Train Acc: 0.9286
 Site-SynthDigits                   | Train Loss: 1.3555 | Train Acc: 0.5587
 Site-SynthDigits                   | Train Loss: 1.2081 | Train Acc: 0.6402
 Site-MNIST_M                       | Train Loss: 1.5973 | Train Acc: 0.5057
 Site-MNIST_M                       | Train Loss: 1.6592 | Train Acc: 0.4280
 Site-SVHN                          | Train Loss: 1.9508 | Train Acc: 0.3220
Average Train Accuracy: 0.7526
 Site-MNIST                         | Val  Loss: 0.2577 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2587 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2810 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3120 | Val  Acc: 0.9211
 Site-MNIST                         | Val  Loss: 0.3068 | Val  Acc: 0.9158
 Site-USPS                          | Val  Loss: 0.2478 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.3142 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3210 | Val  Acc: 0.9017
 Site-SynthDigits                   | Val  Loss: 1.3816 | Val  Acc: 0.5682
 Site-SynthDigits                   | Val  Loss: 1.2989 | Val  Acc: 0.5808
 Site-MNIST_M                       | Val  Loss: 1.4210 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.4555 | Val  Acc: 0.5076
 Site-SVHN                          | Val  Loss: 1.9679 | Val  Acc: 0.2671
Average Valid Accuracy: 0.7609
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9365
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9211
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9158
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9017
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.5682
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.5808
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.5909
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.5076
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.2671
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.3002 | Train Acc: 0.9022
 Site-MNIST                         | Train Loss: 0.2835 | Train Acc: 0.9290
 Site-MNIST                         | Train Loss: 0.3368 | Train Acc: 0.8955
 Site-MNIST                         | Train Loss: 0.2870 | Train Acc: 0.9093
 Site-MNIST                         | Train Loss: 0.2909 | Train Acc: 0.9264
 Site-USPS                          | Train Loss: 0.3195 | Train Acc: 0.9065
 Site-USPS                          | Train Loss: 0.2739 | Train Acc: 0.9297
 Site-USPS                          | Train Loss: 0.2636 | Train Acc: 0.9308
 Site-SynthDigits                   | Train Loss: 1.3051 | Train Acc: 0.5644
 Site-SynthDigits                   | Train Loss: 1.1941 | Train Acc: 0.6465
 Site-MNIST_M                       | Train Loss: 1.5672 | Train Acc: 0.4943
 Site-MNIST_M                       | Train Loss: 1.6568 | Train Acc: 0.4337
 Site-SVHN                          | Train Loss: 1.9648 | Train Acc: 0.3271
Average Train Accuracy: 0.7535
 Site-MNIST                         | Val  Loss: 0.2557 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2547 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.2751 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.3088 | Val  Acc: 0.9263
 Site-MNIST                         | Val  Loss: 0.2997 | Val  Acc: 0.9263
 Site-USPS                          | Val  Loss: 0.2480 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.3112 | Val  Acc: 0.9103
 Site-USPS                          | Val  Loss: 0.3198 | Val  Acc: 0.9060
 Site-SynthDigits                   | Val  Loss: 1.3668 | Val  Acc: 0.5758
 Site-SynthDigits                   | Val  Loss: 1.2907 | Val  Acc: 0.5859
 Site-MNIST_M                       | Val  Loss: 1.4125 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.4465 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.9754 | Val  Acc: 0.2808
Average Valid Accuracy: 0.7643
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9365
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9263
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9263
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9103
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9060
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5758
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.5859
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.6023
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.2808
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.3161 | Train Acc: 0.9022
 Site-MNIST                         | Train Loss: 0.2858 | Train Acc: 0.9290
 Site-MNIST                         | Train Loss: 0.3354 | Train Acc: 0.9053
 Site-MNIST                         | Train Loss: 0.2866 | Train Acc: 0.9093
 Site-MNIST                         | Train Loss: 0.2936 | Train Acc: 0.9273
 Site-USPS                          | Train Loss: 0.3343 | Train Acc: 0.9113
 Site-USPS                          | Train Loss: 0.2657 | Train Acc: 0.9281
 Site-USPS                          | Train Loss: 0.2562 | Train Acc: 0.9286
 Site-SynthDigits                   | Train Loss: 1.3055 | Train Acc: 0.5701
 Site-SynthDigits                   | Train Loss: 1.1812 | Train Acc: 0.6553
 Site-MNIST_M                       | Train Loss: 1.5704 | Train Acc: 0.5028
 Site-MNIST_M                       | Train Loss: 1.6590 | Train Acc: 0.4261
 Site-SVHN                          | Train Loss: 1.9339 | Train Acc: 0.3254
Average Train Accuracy: 0.7555
 Site-MNIST                         | Val  Loss: 0.2515 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2525 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2755 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.3060 | Val  Acc: 0.9368
 Site-MNIST                         | Val  Loss: 0.2987 | Val  Acc: 0.9263
 Site-USPS                          | Val  Loss: 0.2414 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.3043 | Val  Acc: 0.9103
 Site-USPS                          | Val  Loss: 0.3152 | Val  Acc: 0.9060
 Site-SynthDigits                   | Val  Loss: 1.3603 | Val  Acc: 0.5758
 Site-SynthDigits                   | Val  Loss: 1.2822 | Val  Acc: 0.5960
 Site-MNIST_M                       | Val  Loss: 1.4208 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.4484 | Val  Acc: 0.5076
 Site-SVHN                          | Val  Loss: 1.9586 | Val  Acc: 0.2808
Average Valid Accuracy: 0.7678
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9368
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9263
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9103
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9060
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.5758
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.5960
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.5909
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.5076
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.2808
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.3043 | Train Acc: 0.9111
 Site-MNIST                         | Train Loss: 0.2797 | Train Acc: 0.9290
 Site-MNIST                         | Train Loss: 0.3250 | Train Acc: 0.9014
 Site-MNIST                         | Train Loss: 0.2785 | Train Acc: 0.9133
 Site-MNIST                         | Train Loss: 0.2815 | Train Acc: 0.9282
 Site-USPS                          | Train Loss: 0.3154 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.2667 | Train Acc: 0.9281
 Site-USPS                          | Train Loss: 0.2548 | Train Acc: 0.9286
 Site-SynthDigits                   | Train Loss: 1.3034 | Train Acc: 0.5644
 Site-SynthDigits                   | Train Loss: 1.1720 | Train Acc: 0.6503
 Site-MNIST_M                       | Train Loss: 1.5600 | Train Acc: 0.5085
 Site-MNIST_M                       | Train Loss: 1.6433 | Train Acc: 0.4375
 Site-SVHN                          | Train Loss: 1.9410 | Train Acc: 0.3271
Average Train Accuracy: 0.7566
 Site-MNIST                         | Val  Loss: 0.2446 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.2487 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.2657 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.2996 | Val  Acc: 0.9316
 Site-MNIST                         | Val  Loss: 0.2911 | Val  Acc: 0.9263
 Site-USPS                          | Val  Loss: 0.2403 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.3060 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3134 | Val  Acc: 0.9060
 Site-SynthDigits                   | Val  Loss: 1.3440 | Val  Acc: 0.5833
 Site-SynthDigits                   | Val  Loss: 1.2799 | Val  Acc: 0.5960
 Site-MNIST_M                       | Val  Loss: 1.4053 | Val  Acc: 0.6136
 Site-MNIST_M                       | Val  Loss: 1.4334 | Val  Acc: 0.5076
 Site-SVHN                          | Val  Loss: 1.9678 | Val  Acc: 0.2740
Average Valid Accuracy: 0.7687
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9316
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9263
 Best site-USPS                      | Epoch:49 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:49 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:49 | Val Acc: 0.9060
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.5833
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.5960
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.6136
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.5076
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.2740
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/term...
===2023-07-27 18:08:36===
===2023-07-27 18:08:44===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.9099
 Test site-USPS                      | Epoch:49 | Test Acc: 0.9204
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.5920
 Test site-MNIST_M                   | Epoch:49 | Test Acc: 0.4177
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.2871
MNIST: 0.9099, USPS: 0.9204, SynthDigits: 0.5920, MNIST_M: 0.4177, SVHN: 0.2871, 
Average Test Accuracy(group): 0.6254, Average Test Accuracy(individual): 0.7398,
domain std=0.2556, cluster std=-1.0000, individual std=0.2318, 
