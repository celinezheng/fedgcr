===2023-07-27 18:20:26===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 1.2340 | Train Acc: 0.7733
 Site-MNIST                         | Train Loss: 1.2556 | Train Acc: 0.7278
 Site-MNIST                         | Train Loss: 1.3082 | Train Acc: 0.6824
 Site-MNIST                         | Train Loss: 1.2597 | Train Acc: 0.7477
 Site-MNIST                         | Train Loss: 1.2559 | Train Acc: 0.7320
 Site-USPS                          | Train Loss: 1.0513 | Train Acc: 0.7770
 Site-USPS                          | Train Loss: 1.0136 | Train Acc: 0.7907
 Site-USPS                          | Train Loss: 0.9955 | Train Acc: 0.8275
 Site-SynthDigits                   | Train Loss: 1.9396 | Train Acc: 0.3049
 Site-SynthDigits                   | Train Loss: 1.8895 | Train Acc: 0.3586
 Site-MNIST_M                       | Train Loss: 2.0988 | Train Acc: 0.2926
 Site-MNIST_M                       | Train Loss: 2.1054 | Train Acc: 0.2595
 Site-SVHN                          | Train Loss: 2.2081 | Train Acc: 0.1976
Average Train Accuracy: 0.5747
 Site-MNIST                         | Val  Loss: 1.2689 | Val  Acc: 0.6786
 Site-MNIST                         | Val  Loss: 1.3283 | Val  Acc: 0.7024
 Site-MNIST                         | Val  Loss: 1.2463 | Val  Acc: 0.7222
 Site-MNIST                         | Val  Loss: 1.2742 | Val  Acc: 0.6842
 Site-MNIST                         | Val  Loss: 1.2742 | Val  Acc: 0.7123
 Site-USPS                          | Val  Loss: 0.9984 | Val  Acc: 0.7788
 Site-USPS                          | Val  Loss: 1.0325 | Val  Acc: 0.7821
 Site-USPS                          | Val  Loss: 1.0275 | Val  Acc: 0.7821
 Site-SynthDigits                   | Val  Loss: 2.1085 | Val  Acc: 0.2955
 Site-SynthDigits                   | Val  Loss: 1.9500 | Val  Acc: 0.2828
 Site-MNIST_M                       | Val  Loss: 2.0322 | Val  Acc: 0.3523
 Site-MNIST_M                       | Val  Loss: 2.1198 | Val  Acc: 0.2879
 Site-SVHN                          | Val  Loss: 2.1984 | Val  Acc: 0.2192
Average Valid Accuracy: 0.5600
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6786
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7024
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7222
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6842
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7123
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7788
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7821
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7821
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2955
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2828
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.3523
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.2879
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2192
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 0.7226 | Train Acc: 0.8622
 Site-MNIST                         | Train Loss: 0.7808 | Train Acc: 0.8195
 Site-MNIST                         | Train Loss: 0.8206 | Train Acc: 0.7870
 Site-MNIST                         | Train Loss: 0.7488 | Train Acc: 0.8226
 Site-MNIST                         | Train Loss: 0.7419 | Train Acc: 0.8476
 Site-USPS                          | Train Loss: 0.7497 | Train Acc: 0.8010
 Site-USPS                          | Train Loss: 0.7035 | Train Acc: 0.8131
 Site-USPS                          | Train Loss: 0.6940 | Train Acc: 0.8392
 Site-SynthDigits                   | Train Loss: 1.6889 | Train Acc: 0.4223
 Site-SynthDigits                   | Train Loss: 1.6111 | Train Acc: 0.4747
 Site-MNIST_M                       | Train Loss: 1.9080 | Train Acc: 0.3523
 Site-MNIST_M                       | Train Loss: 1.9431 | Train Acc: 0.3409
 Site-SVHN                          | Train Loss: 2.1058 | Train Acc: 0.2249
Average Train Accuracy: 0.6467
 Site-MNIST                         | Val  Loss: 0.7717 | Val  Acc: 0.7857
 Site-MNIST                         | Val  Loss: 0.7615 | Val  Acc: 0.8333
 Site-MNIST                         | Val  Loss: 0.7192 | Val  Acc: 0.8254
 Site-MNIST                         | Val  Loss: 0.8005 | Val  Acc: 0.7895
 Site-MNIST                         | Val  Loss: 0.7811 | Val  Acc: 0.8105
 Site-USPS                          | Val  Loss: 0.6791 | Val  Acc: 0.8173
 Site-USPS                          | Val  Loss: 0.7344 | Val  Acc: 0.7821
 Site-USPS                          | Val  Loss: 0.7443 | Val  Acc: 0.7991
 Site-SynthDigits                   | Val  Loss: 1.9899 | Val  Acc: 0.3712
 Site-SynthDigits                   | Val  Loss: 1.6700 | Val  Acc: 0.4040
 Site-MNIST_M                       | Val  Loss: 1.7885 | Val  Acc: 0.4545
 Site-MNIST_M                       | Val  Loss: 1.9172 | Val  Acc: 0.3864
 Site-SVHN                          | Val  Loss: 2.1486 | Val  Acc: 0.2260
Average Valid Accuracy: 0.6373
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7857
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8333
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8254
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7895
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8105
 Best site-USPS                      | Epoch:1 | Val Acc: 0.8173
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7821
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7991
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3712
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.4040
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.4545
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.3864
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2260
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 0.5498 | Train Acc: 0.8533
 Site-MNIST                         | Train Loss: 0.6000 | Train Acc: 0.8314
 Site-MNIST                         | Train Loss: 0.6543 | Train Acc: 0.8087
 Site-MNIST                         | Train Loss: 0.5890 | Train Acc: 0.8331
 Site-MNIST                         | Train Loss: 0.5798 | Train Acc: 0.8433
 Site-USPS                          | Train Loss: 0.5760 | Train Acc: 0.8345
 Site-USPS                          | Train Loss: 0.5260 | Train Acc: 0.8546
 Site-USPS                          | Train Loss: 0.5237 | Train Acc: 0.8584
 Site-SynthDigits                   | Train Loss: 1.5138 | Train Acc: 0.4962
 Site-SynthDigits                   | Train Loss: 1.4351 | Train Acc: 0.5455
 Site-MNIST_M                       | Train Loss: 1.7738 | Train Acc: 0.4148
 Site-MNIST_M                       | Train Loss: 1.8083 | Train Acc: 0.3769
 Site-SVHN                          | Train Loss: 1.9887 | Train Acc: 0.2692
Average Train Accuracy: 0.6784
 Site-MNIST                         | Val  Loss: 0.5829 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.5772 | Val  Acc: 0.8333
 Site-MNIST                         | Val  Loss: 0.5647 | Val  Acc: 0.8175
 Site-MNIST                         | Val  Loss: 0.6436 | Val  Acc: 0.7895
 Site-MNIST                         | Val  Loss: 0.6209 | Val  Acc: 0.8175
 Site-USPS                          | Val  Loss: 0.4981 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.5580 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.5821 | Val  Acc: 0.8291
 Site-SynthDigits                   | Val  Loss: 1.7794 | Val  Acc: 0.4545
 Site-SynthDigits                   | Val  Loss: 1.4715 | Val  Acc: 0.4949
 Site-MNIST_M                       | Val  Loss: 1.5694 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.7807 | Val  Acc: 0.4015
 Site-SVHN                          | Val  Loss: 2.0716 | Val  Acc: 0.2466
Average Valid Accuracy: 0.6733
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8333
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8175
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7895
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8175
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8846
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8291
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.4545
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.4949
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4015
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2466
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 0.4452 | Train Acc: 0.8800
 Site-MNIST                         | Train Loss: 0.4797 | Train Acc: 0.8698
 Site-MNIST                         | Train Loss: 0.5370 | Train Acc: 0.8284
 Site-MNIST                         | Train Loss: 0.4753 | Train Acc: 0.8712
 Site-MNIST                         | Train Loss: 0.4653 | Train Acc: 0.8844
 Site-USPS                          | Train Loss: 0.4718 | Train Acc: 0.8705
 Site-USPS                          | Train Loss: 0.4236 | Train Acc: 0.8882
 Site-USPS                          | Train Loss: 0.4276 | Train Acc: 0.8924
 Site-SynthDigits                   | Train Loss: 1.4405 | Train Acc: 0.5170
 Site-SynthDigits                   | Train Loss: 1.3663 | Train Acc: 0.5606
 Site-MNIST_M                       | Train Loss: 1.6834 | Train Acc: 0.4716
 Site-MNIST_M                       | Train Loss: 1.7210 | Train Acc: 0.4072
 Site-SVHN                          | Train Loss: 1.9363 | Train Acc: 0.2879
Average Train Accuracy: 0.7099
 Site-MNIST                         | Val  Loss: 0.4569 | Val  Acc: 0.8750
 Site-MNIST                         | Val  Loss: 0.4468 | Val  Acc: 0.8690
 Site-MNIST                         | Val  Loss: 0.4524 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.5123 | Val  Acc: 0.8368
 Site-MNIST                         | Val  Loss: 0.5002 | Val  Acc: 0.8561
 Site-USPS                          | Val  Loss: 0.3732 | Val  Acc: 0.9135
 Site-USPS                          | Val  Loss: 0.4676 | Val  Acc: 0.8590
 Site-USPS                          | Val  Loss: 0.5025 | Val  Acc: 0.8504
 Site-SynthDigits                   | Val  Loss: 1.7384 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.3522 | Val  Acc: 0.5202
 Site-MNIST_M                       | Val  Loss: 1.4765 | Val  Acc: 0.5455
 Site-MNIST_M                       | Val  Loss: 1.7061 | Val  Acc: 0.4621
 Site-SVHN                          | Val  Loss: 2.0362 | Val  Acc: 0.2466
Average Valid Accuracy: 0.7070
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8750
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8690
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8368
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8561
 Best site-USPS                      | Epoch:3 | Val Acc: 0.9135
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8590
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8504
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.5202
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.5455
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.4621
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2466
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 0.3722 | Train Acc: 0.9289
 Site-MNIST                         | Train Loss: 0.3698 | Train Acc: 0.8905
 Site-MNIST                         | Train Loss: 0.4372 | Train Acc: 0.8698
 Site-MNIST                         | Train Loss: 0.3866 | Train Acc: 0.8988
 Site-MNIST                         | Train Loss: 0.3694 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.4476 | Train Acc: 0.8873
 Site-USPS                          | Train Loss: 0.3831 | Train Acc: 0.9058
 Site-USPS                          | Train Loss: 0.3957 | Train Acc: 0.8946
 Site-SynthDigits                   | Train Loss: 1.3626 | Train Acc: 0.5625
 Site-SynthDigits                   | Train Loss: 1.2621 | Train Acc: 0.5896
 Site-MNIST_M                       | Train Loss: 1.6366 | Train Acc: 0.4716
 Site-MNIST_M                       | Train Loss: 1.6910 | Train Acc: 0.4337
 Site-SVHN                          | Train Loss: 1.9233 | Train Acc: 0.3015
Average Train Accuracy: 0.7345
 Site-MNIST                         | Val  Loss: 0.3592 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.3476 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.3643 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.4186 | Val  Acc: 0.8737
 Site-MNIST                         | Val  Loss: 0.4141 | Val  Acc: 0.8807
 Site-USPS                          | Val  Loss: 0.3217 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.4304 | Val  Acc: 0.8718
 Site-USPS                          | Val  Loss: 0.4759 | Val  Acc: 0.8675
 Site-SynthDigits                   | Val  Loss: 1.6252 | Val  Acc: 0.5152
 Site-SynthDigits                   | Val  Loss: 1.2358 | Val  Acc: 0.5606
 Site-MNIST_M                       | Val  Loss: 1.4295 | Val  Acc: 0.5455
 Site-MNIST_M                       | Val  Loss: 1.6230 | Val  Acc: 0.4697
 Site-SVHN                          | Val  Loss: 2.0003 | Val  Acc: 0.2534
Average Valid Accuracy: 0.7270
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8810
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8737
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8807
 Best site-USPS                      | Epoch:4 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8718
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8675
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5152
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5606
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.5455
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.4697
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2534
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 0.3197 | Train Acc: 0.9289
 Site-MNIST                         | Train Loss: 0.3525 | Train Acc: 0.8935
 Site-MNIST                         | Train Loss: 0.3791 | Train Acc: 0.8856
 Site-MNIST                         | Train Loss: 0.3292 | Train Acc: 0.9159
 Site-MNIST                         | Train Loss: 0.3157 | Train Acc: 0.9299
 Site-USPS                          | Train Loss: 0.4006 | Train Acc: 0.8945
 Site-USPS                          | Train Loss: 0.3313 | Train Acc: 0.9153
 Site-USPS                          | Train Loss: 0.3485 | Train Acc: 0.9084
 Site-SynthDigits                   | Train Loss: 1.3198 | Train Acc: 0.5606
 Site-SynthDigits                   | Train Loss: 1.2233 | Train Acc: 0.6048
 Site-MNIST_M                       | Train Loss: 1.5856 | Train Acc: 0.4972
 Site-MNIST_M                       | Train Loss: 1.6155 | Train Acc: 0.4564
 Site-SVHN                          | Train Loss: 1.8331 | Train Acc: 0.3186
Average Train Accuracy: 0.7469
 Site-MNIST                         | Val  Loss: 0.2880 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.2955 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.3168 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.3632 | Val  Acc: 0.9000
 Site-MNIST                         | Val  Loss: 0.3599 | Val  Acc: 0.8877
 Site-USPS                          | Val  Loss: 0.2601 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.3772 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.4292 | Val  Acc: 0.8761
 Site-SynthDigits                   | Val  Loss: 1.5677 | Val  Acc: 0.5227
 Site-SynthDigits                   | Val  Loss: 1.1739 | Val  Acc: 0.5808
 Site-MNIST_M                       | Val  Loss: 1.3797 | Val  Acc: 0.5682
 Site-MNIST_M                       | Val  Loss: 1.5464 | Val  Acc: 0.4924
 Site-SVHN                          | Val  Loss: 1.9856 | Val  Acc: 0.2945
Average Valid Accuracy: 0.7516
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.9000
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8877
 Best site-USPS                      | Epoch:5 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8846
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8761
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.5227
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.5808
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.5682
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.4924
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2945
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.2986 | Train Acc: 0.9289
 Site-MNIST                         | Train Loss: 0.3209 | Train Acc: 0.9024
 Site-MNIST                         | Train Loss: 0.3405 | Train Acc: 0.8955
 Site-MNIST                         | Train Loss: 0.2998 | Train Acc: 0.9172
 Site-MNIST                         | Train Loss: 0.2827 | Train Acc: 0.9326
 Site-USPS                          | Train Loss: 0.3461 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.2955 | Train Acc: 0.9201
 Site-USPS                          | Train Loss: 0.3076 | Train Acc: 0.9212
 Site-SynthDigits                   | Train Loss: 1.2819 | Train Acc: 0.5871
 Site-SynthDigits                   | Train Loss: 1.1670 | Train Acc: 0.6174
 Site-MNIST_M                       | Train Loss: 1.5799 | Train Acc: 0.4801
 Site-MNIST_M                       | Train Loss: 1.6010 | Train Acc: 0.4602
 Site-SVHN                          | Train Loss: 1.8646 | Train Acc: 0.3492
Average Train Accuracy: 0.7554
 Site-MNIST                         | Val  Loss: 0.2727 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.2597 | Val  Acc: 0.9405
 Site-MNIST                         | Val  Loss: 0.2780 | Val  Acc: 0.8968
 Site-MNIST                         | Val  Loss: 0.3201 | Val  Acc: 0.9000
 Site-MNIST                         | Val  Loss: 0.3264 | Val  Acc: 0.8982
 Site-USPS                          | Val  Loss: 0.2330 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.3438 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3863 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.5264 | Val  Acc: 0.5758
 Site-SynthDigits                   | Val  Loss: 1.1077 | Val  Acc: 0.6162
 Site-MNIST_M                       | Val  Loss: 1.3831 | Val  Acc: 0.5682
 Site-MNIST_M                       | Val  Loss: 1.5183 | Val  Acc: 0.4545
 Site-SVHN                          | Val  Loss: 1.9506 | Val  Acc: 0.3082
Average Valid Accuracy: 0.7583
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9405
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8968
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9000
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8982
 Best site-USPS                      | Epoch:6 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:6 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5758
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.6162
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.5682
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.4545
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3082
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.2873 | Train Acc: 0.9378
 Site-MNIST                         | Train Loss: 0.2728 | Train Acc: 0.9231
 Site-MNIST                         | Train Loss: 0.3121 | Train Acc: 0.9073
 Site-MNIST                         | Train Loss: 0.2699 | Train Acc: 0.9317
 Site-MNIST                         | Train Loss: 0.2571 | Train Acc: 0.9440
 Site-USPS                          | Train Loss: 0.3376 | Train Acc: 0.9065
 Site-USPS                          | Train Loss: 0.2663 | Train Acc: 0.9313
 Site-USPS                          | Train Loss: 0.2887 | Train Acc: 0.9297
 Site-SynthDigits                   | Train Loss: 1.2112 | Train Acc: 0.6080
 Site-SynthDigits                   | Train Loss: 1.1006 | Train Acc: 0.6402
 Site-MNIST_M                       | Train Loss: 1.5206 | Train Acc: 0.5028
 Site-MNIST_M                       | Train Loss: 1.5466 | Train Acc: 0.4811
 Site-SVHN                          | Train Loss: 1.8282 | Train Acc: 0.3629
Average Train Accuracy: 0.7697
 Site-MNIST                         | Val  Loss: 0.2289 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.2249 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.2630 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.3028 | Val  Acc: 0.9053
 Site-MNIST                         | Val  Loss: 0.2893 | Val  Acc: 0.9228
 Site-USPS                          | Val  Loss: 0.2137 | Val  Acc: 0.9519
 Site-USPS                          | Val  Loss: 0.3213 | Val  Acc: 0.8910
 Site-USPS                          | Val  Loss: 0.3606 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.4551 | Val  Acc: 0.5758
 Site-SynthDigits                   | Val  Loss: 1.0410 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.3178 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.5053 | Val  Acc: 0.4697
 Site-SVHN                          | Val  Loss: 1.9145 | Val  Acc: 0.3288
Average Valid Accuracy: 0.7694
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9127
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9053
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9228
 Best site-USPS                      | Epoch:7 | Val Acc: 0.9519
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8910
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5758
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.6364
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.5909
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.4697
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3288
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.2426 | Train Acc: 0.9422
 Site-MNIST                         | Train Loss: 0.2525 | Train Acc: 0.9349
 Site-MNIST                         | Train Loss: 0.2846 | Train Acc: 0.9172
 Site-MNIST                         | Train Loss: 0.2455 | Train Acc: 0.9317
 Site-MNIST                         | Train Loss: 0.2290 | Train Acc: 0.9492
 Site-USPS                          | Train Loss: 0.3094 | Train Acc: 0.9209
 Site-USPS                          | Train Loss: 0.2446 | Train Acc: 0.9297
 Site-USPS                          | Train Loss: 0.2724 | Train Acc: 0.9297
 Site-SynthDigits                   | Train Loss: 1.1652 | Train Acc: 0.6383
 Site-SynthDigits                   | Train Loss: 1.0550 | Train Acc: 0.6654
 Site-MNIST_M                       | Train Loss: 1.5436 | Train Acc: 0.4858
 Site-MNIST_M                       | Train Loss: 1.5537 | Train Acc: 0.4962
 Site-SVHN                          | Train Loss: 1.7820 | Train Acc: 0.3714
Average Train Accuracy: 0.7779
 Site-MNIST                         | Val  Loss: 0.2206 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.2120 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.2362 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.2749 | Val  Acc: 0.9211
 Site-MNIST                         | Val  Loss: 0.2617 | Val  Acc: 0.9368
 Site-USPS                          | Val  Loss: 0.2022 | Val  Acc: 0.9327
 Site-USPS                          | Val  Loss: 0.2983 | Val  Acc: 0.8974
 Site-USPS                          | Val  Loss: 0.3343 | Val  Acc: 0.9060
 Site-SynthDigits                   | Val  Loss: 1.4006 | Val  Acc: 0.5985
 Site-SynthDigits                   | Val  Loss: 0.9857 | Val  Acc: 0.6566
 Site-MNIST_M                       | Val  Loss: 1.3265 | Val  Acc: 0.5795
 Site-MNIST_M                       | Val  Loss: 1.4619 | Val  Acc: 0.4318
 Site-SVHN                          | Val  Loss: 1.8960 | Val  Acc: 0.3151
Average Valid Accuracy: 0.7714
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9127
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9211
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9368
 Best site-USPS                      | Epoch:8 | Val Acc: 0.9327
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8974
 Best site-USPS                      | Epoch:8 | Val Acc: 0.9060
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5985
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.6566
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.5795
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.4318
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3151
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.2268 | Train Acc: 0.9378
 Site-MNIST                         | Train Loss: 0.2410 | Train Acc: 0.9379
 Site-MNIST                         | Train Loss: 0.2695 | Train Acc: 0.9211
 Site-MNIST                         | Train Loss: 0.2310 | Train Acc: 0.9369
 Site-MNIST                         | Train Loss: 0.2127 | Train Acc: 0.9510
 Site-USPS                          | Train Loss: 0.3035 | Train Acc: 0.9161
 Site-USPS                          | Train Loss: 0.2336 | Train Acc: 0.9345
 Site-USPS                          | Train Loss: 0.2537 | Train Acc: 0.9350
 Site-SynthDigits                   | Train Loss: 1.1256 | Train Acc: 0.6193
 Site-SynthDigits                   | Train Loss: 1.0229 | Train Acc: 0.6679
 Site-MNIST_M                       | Train Loss: 1.4474 | Train Acc: 0.5057
 Site-MNIST_M                       | Train Loss: 1.5114 | Train Acc: 0.4924
 Site-SVHN                          | Train Loss: 1.7869 | Train Acc: 0.3816
Average Train Accuracy: 0.7798
 Site-MNIST                         | Val  Loss: 0.2220 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.2127 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.2148 | Val  Acc: 0.9365
 Site-MNIST                         | Val  Loss: 0.2571 | Val  Acc: 0.9368
 Site-MNIST                         | Val  Loss: 0.2479 | Val  Acc: 0.9404
 Site-USPS                          | Val  Loss: 0.1927 | Val  Acc: 0.9519
 Site-USPS                          | Val  Loss: 0.2841 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.3245 | Val  Acc: 0.9017
 Site-SynthDigits                   | Val  Loss: 1.3308 | Val  Acc: 0.5985
 Site-SynthDigits                   | Val  Loss: 0.9705 | Val  Acc: 0.6616
 Site-MNIST_M                       | Val  Loss: 1.2644 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.4416 | Val  Acc: 0.4773
 Site-SVHN                          | Val  Loss: 1.8889 | Val  Acc: 0.3425
Average Valid Accuracy: 0.7823
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.9365
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.9368
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.9404
 Best site-USPS                      | Epoch:9 | Val Acc: 0.9519
 Best site-USPS                      | Epoch:9 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:9 | Val Acc: 0.9017
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.5985
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.6616
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.6023
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.4773
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3425
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.2215 | Train Acc: 0.9467
 Site-MNIST                         | Train Loss: 0.2135 | Train Acc: 0.9438
 Site-MNIST                         | Train Loss: 0.2535 | Train Acc: 0.9290
 Site-MNIST                         | Train Loss: 0.2176 | Train Acc: 0.9435
 Site-MNIST                         | Train Loss: 0.1988 | Train Acc: 0.9518
 Site-USPS                          | Train Loss: 0.2703 | Train Acc: 0.9257
 Site-USPS                          | Train Loss: 0.2165 | Train Acc: 0.9393
 Site-USPS                          | Train Loss: 0.2437 | Train Acc: 0.9340
 Site-SynthDigits                   | Train Loss: 1.1147 | Train Acc: 0.6648
 Site-SynthDigits                   | Train Loss: 0.9995 | Train Acc: 0.6907
 Site-MNIST_M                       | Train Loss: 1.4733 | Train Acc: 0.4972
 Site-MNIST_M                       | Train Loss: 1.5260 | Train Acc: 0.4962
 Site-SVHN                          | Train Loss: 1.7432 | Train Acc: 0.3867
Average Train Accuracy: 0.7884
 Site-MNIST                         | Val  Loss: 0.1945 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1804 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.2103 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.2543 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.2362 | Val  Acc: 0.9474
 Site-USPS                          | Val  Loss: 0.1849 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.2790 | Val  Acc: 0.9103
 Site-USPS                          | Val  Loss: 0.3036 | Val  Acc: 0.9103
 Site-SynthDigits                   | Val  Loss: 1.3056 | Val  Acc: 0.6136
 Site-SynthDigits                   | Val  Loss: 0.9252 | Val  Acc: 0.6919
 Site-MNIST_M                       | Val  Loss: 1.2690 | Val  Acc: 0.5682
 Site-MNIST_M                       | Val  Loss: 1.4144 | Val  Acc: 0.4621
 Site-SVHN                          | Val  Loss: 1.8597 | Val  Acc: 0.3288
Average Valid Accuracy: 0.7863
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9421
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9474
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9103
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9103
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.6136
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.6919
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.5682
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.4621
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3288
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.2062 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.1945 | Train Acc: 0.9379
 Site-MNIST                         | Train Loss: 0.2425 | Train Acc: 0.9290
 Site-MNIST                         | Train Loss: 0.2009 | Train Acc: 0.9448
 Site-MNIST                         | Train Loss: 0.1821 | Train Acc: 0.9571
 Site-USPS                          | Train Loss: 0.2762 | Train Acc: 0.9281
 Site-USPS                          | Train Loss: 0.2054 | Train Acc: 0.9377
 Site-USPS                          | Train Loss: 0.2334 | Train Acc: 0.9414
 Site-SynthDigits                   | Train Loss: 1.0858 | Train Acc: 0.6591
 Site-SynthDigits                   | Train Loss: 0.9523 | Train Acc: 0.6982
 Site-MNIST_M                       | Train Loss: 1.4546 | Train Acc: 0.4972
 Site-MNIST_M                       | Train Loss: 1.4854 | Train Acc: 0.4943
 Site-SVHN                          | Train Loss: 1.7268 | Train Acc: 0.3833
Average Train Accuracy: 0.7892
 Site-MNIST                         | Val  Loss: 0.2013 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1869 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1993 | Val  Acc: 0.9444
 Site-MNIST                         | Val  Loss: 0.2382 | Val  Acc: 0.9474
 Site-MNIST                         | Val  Loss: 0.2266 | Val  Acc: 0.9404
 Site-USPS                          | Val  Loss: 0.1688 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.2632 | Val  Acc: 0.9167
 Site-USPS                          | Val  Loss: 0.2936 | Val  Acc: 0.9188
 Site-SynthDigits                   | Val  Loss: 1.2518 | Val  Acc: 0.6439
 Site-SynthDigits                   | Val  Loss: 0.8845 | Val  Acc: 0.6717
 Site-MNIST_M                       | Val  Loss: 1.2707 | Val  Acc: 0.5568
 Site-MNIST_M                       | Val  Loss: 1.3780 | Val  Acc: 0.4545
 Site-SVHN                          | Val  Loss: 1.8361 | Val  Acc: 0.3356
Average Valid Accuracy: 0.7847
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.2123 | Train Acc: 0.9422
 Site-MNIST                         | Train Loss: 0.1912 | Train Acc: 0.9349
 Site-MNIST                         | Train Loss: 0.2322 | Train Acc: 0.9329
 Site-MNIST                         | Train Loss: 0.1967 | Train Acc: 0.9461
 Site-MNIST                         | Train Loss: 0.1768 | Train Acc: 0.9562
 Site-USPS                          | Train Loss: 0.2357 | Train Acc: 0.9257
 Site-USPS                          | Train Loss: 0.1891 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.2071 | Train Acc: 0.9457
 Site-SynthDigits                   | Train Loss: 1.0491 | Train Acc: 0.6629
 Site-SynthDigits                   | Train Loss: 0.9366 | Train Acc: 0.7033
 Site-MNIST_M                       | Train Loss: 1.4514 | Train Acc: 0.5057
 Site-MNIST_M                       | Train Loss: 1.5155 | Train Acc: 0.4924
 Site-SVHN                          | Train Loss: 1.7459 | Train Acc: 0.3935
Average Train Accuracy: 0.7913
 Site-MNIST                         | Val  Loss: 0.1871 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1642 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1909 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.2334 | Val  Acc: 0.9316
 Site-MNIST                         | Val  Loss: 0.2217 | Val  Acc: 0.9368
 Site-USPS                          | Val  Loss: 0.1535 | Val  Acc: 0.9519
 Site-USPS                          | Val  Loss: 0.2429 | Val  Acc: 0.9103
 Site-USPS                          | Val  Loss: 0.2718 | Val  Acc: 0.9145
 Site-SynthDigits                   | Val  Loss: 1.2313 | Val  Acc: 0.6439
 Site-SynthDigits                   | Val  Loss: 0.8636 | Val  Acc: 0.6717
 Site-MNIST_M                       | Val  Loss: 1.2485 | Val  Acc: 0.5682
 Site-MNIST_M                       | Val  Loss: 1.3521 | Val  Acc: 0.4621
 Site-SVHN                          | Val  Loss: 1.8203 | Val  Acc: 0.3356
Average Valid Accuracy: 0.7870
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9316
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9368
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9519
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9103
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9145
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.6439
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.6717
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.5682
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4621
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.2168 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.1988 | Train Acc: 0.9349
 Site-MNIST                         | Train Loss: 0.2241 | Train Acc: 0.9349
 Site-MNIST                         | Train Loss: 0.1877 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1711 | Train Acc: 0.9588
 Site-USPS                          | Train Loss: 0.2290 | Train Acc: 0.9329
 Site-USPS                          | Train Loss: 0.1773 | Train Acc: 0.9521
 Site-USPS                          | Train Loss: 0.2015 | Train Acc: 0.9478
 Site-SynthDigits                   | Train Loss: 1.0285 | Train Acc: 0.6591
 Site-SynthDigits                   | Train Loss: 0.9094 | Train Acc: 0.7172
 Site-MNIST_M                       | Train Loss: 1.4138 | Train Acc: 0.5170
 Site-MNIST_M                       | Train Loss: 1.4580 | Train Acc: 0.5019
 Site-SVHN                          | Train Loss: 1.6755 | Train Acc: 0.4089
Average Train Accuracy: 0.7972
 Site-MNIST                         | Val  Loss: 0.1696 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1566 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1870 | Val  Acc: 0.9603
 Site-MNIST                         | Val  Loss: 0.2262 | Val  Acc: 0.9368
 Site-MNIST                         | Val  Loss: 0.2177 | Val  Acc: 0.9368
 Site-USPS                          | Val  Loss: 0.1382 | Val  Acc: 0.9519
 Site-USPS                          | Val  Loss: 0.2314 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.2574 | Val  Acc: 0.9188
 Site-SynthDigits                   | Val  Loss: 1.1996 | Val  Acc: 0.6136
 Site-SynthDigits                   | Val  Loss: 0.8532 | Val  Acc: 0.6717
 Site-MNIST_M                       | Val  Loss: 1.2457 | Val  Acc: 0.5568
 Site-MNIST_M                       | Val  Loss: 1.3727 | Val  Acc: 0.4697
 Site-SVHN                          | Val  Loss: 1.7976 | Val  Acc: 0.3562
Average Valid Accuracy: 0.7883
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9603
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9368
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9368
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9519
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9188
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.6136
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.6717
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.5568
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4697
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3562
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.1896 | Train Acc: 0.9333
 Site-MNIST                         | Train Loss: 0.1765 | Train Acc: 0.9438
 Site-MNIST                         | Train Loss: 0.2114 | Train Acc: 0.9389
 Site-MNIST                         | Train Loss: 0.1775 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1569 | Train Acc: 0.9641
 Site-USPS                          | Train Loss: 0.2183 | Train Acc: 0.9376
 Site-USPS                          | Train Loss: 0.1695 | Train Acc: 0.9537
 Site-USPS                          | Train Loss: 0.1909 | Train Acc: 0.9510
 Site-SynthDigits                   | Train Loss: 1.0368 | Train Acc: 0.6780
 Site-SynthDigits                   | Train Loss: 0.9079 | Train Acc: 0.7159
 Site-MNIST_M                       | Train Loss: 1.4682 | Train Acc: 0.5057
 Site-MNIST_M                       | Train Loss: 1.4504 | Train Acc: 0.5019
 Site-SVHN                          | Train Loss: 1.6697 | Train Acc: 0.4106
Average Train Accuracy: 0.7986
 Site-MNIST                         | Val  Loss: 0.1609 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1387 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1757 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.2138 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.2003 | Val  Acc: 0.9439
 Site-USPS                          | Val  Loss: 0.1317 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.2201 | Val  Acc: 0.9359
 Site-USPS                          | Val  Loss: 0.2500 | Val  Acc: 0.9316
 Site-SynthDigits                   | Val  Loss: 1.2283 | Val  Acc: 0.6136
 Site-SynthDigits                   | Val  Loss: 0.8295 | Val  Acc: 0.6970
 Site-MNIST_M                       | Val  Loss: 1.2733 | Val  Acc: 0.5682
 Site-MNIST_M                       | Val  Loss: 1.3462 | Val  Acc: 0.4697
 Site-SVHN                          | Val  Loss: 1.7887 | Val  Acc: 0.3699
Average Valid Accuracy: 0.7943
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9421
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9439
 Best site-USPS                      | Epoch:14 | Val Acc: 0.9615
 Best site-USPS                      | Epoch:14 | Val Acc: 0.9359
 Best site-USPS                      | Epoch:14 | Val Acc: 0.9316
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.6136
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.6970
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.5682
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4697
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3699
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.1825 | Train Acc: 0.9378
 Site-MNIST                         | Train Loss: 0.1886 | Train Acc: 0.9408
 Site-MNIST                         | Train Loss: 0.2067 | Train Acc: 0.9389
 Site-MNIST                         | Train Loss: 0.1707 | Train Acc: 0.9501
 Site-MNIST                         | Train Loss: 0.1514 | Train Acc: 0.9641
 Site-USPS                          | Train Loss: 0.2125 | Train Acc: 0.9400
 Site-USPS                          | Train Loss: 0.1620 | Train Acc: 0.9569
 Site-USPS                          | Train Loss: 0.1812 | Train Acc: 0.9499
 Site-SynthDigits                   | Train Loss: 1.0183 | Train Acc: 0.6667
 Site-SynthDigits                   | Train Loss: 0.8879 | Train Acc: 0.7323
 Site-MNIST_M                       | Train Loss: 1.4178 | Train Acc: 0.5199
 Site-MNIST_M                       | Train Loss: 1.4342 | Train Acc: 0.5038
 Site-SVHN                          | Train Loss: 1.6685 | Train Acc: 0.4106
Average Train Accuracy: 0.8009
 Site-MNIST                         | Val  Loss: 0.1507 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1354 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1718 | Val  Acc: 0.9603
 Site-MNIST                         | Val  Loss: 0.2120 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.2009 | Val  Acc: 0.9439
 Site-USPS                          | Val  Loss: 0.1255 | Val  Acc: 0.9519
 Site-USPS                          | Val  Loss: 0.2208 | Val  Acc: 0.9295
 Site-USPS                          | Val  Loss: 0.2439 | Val  Acc: 0.9316
 Site-SynthDigits                   | Val  Loss: 1.1981 | Val  Acc: 0.5985
 Site-SynthDigits                   | Val  Loss: 0.8161 | Val  Acc: 0.6818
 Site-MNIST_M                       | Val  Loss: 1.2555 | Val  Acc: 0.5568
 Site-MNIST_M                       | Val  Loss: 1.3254 | Val  Acc: 0.4848
 Site-SVHN                          | Val  Loss: 1.7817 | Val  Acc: 0.3630
Average Valid Accuracy: 0.7921
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.1879 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.1862 | Train Acc: 0.9497
 Site-MNIST                         | Train Loss: 0.1985 | Train Acc: 0.9389
 Site-MNIST                         | Train Loss: 0.1652 | Train Acc: 0.9540
 Site-MNIST                         | Train Loss: 0.1447 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.2091 | Train Acc: 0.9448
 Site-USPS                          | Train Loss: 0.1543 | Train Acc: 0.9585
 Site-USPS                          | Train Loss: 0.1792 | Train Acc: 0.9510
 Site-SynthDigits                   | Train Loss: 0.9647 | Train Acc: 0.6856
 Site-SynthDigits                   | Train Loss: 0.8633 | Train Acc: 0.7285
 Site-MNIST_M                       | Train Loss: 1.3793 | Train Acc: 0.5227
 Site-MNIST_M                       | Train Loss: 1.4129 | Train Acc: 0.5152
 Site-SVHN                          | Train Loss: 1.6524 | Train Acc: 0.4157
Average Train Accuracy: 0.8062
 Site-MNIST                         | Val  Loss: 0.1427 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1258 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1647 | Val  Acc: 0.9603
 Site-MNIST                         | Val  Loss: 0.2085 | Val  Acc: 0.9474
 Site-MNIST                         | Val  Loss: 0.1912 | Val  Acc: 0.9509
 Site-USPS                          | Val  Loss: 0.1257 | Val  Acc: 0.9519
 Site-USPS                          | Val  Loss: 0.1978 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.2294 | Val  Acc: 0.9359
 Site-SynthDigits                   | Val  Loss: 1.1475 | Val  Acc: 0.6212
 Site-SynthDigits                   | Val  Loss: 0.7879 | Val  Acc: 0.7071
 Site-MNIST_M                       | Val  Loss: 1.2100 | Val  Acc: 0.5568
 Site-MNIST_M                       | Val  Loss: 1.2877 | Val  Acc: 0.4848
 Site-SVHN                          | Val  Loss: 1.7594 | Val  Acc: 0.3699
Average Valid Accuracy: 0.7985
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9603
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9474
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9509
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9519
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9423
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9359
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.6212
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.7071
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.5568
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.4848
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3699
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.1671 | Train Acc: 0.9556
 Site-MNIST                         | Train Loss: 0.1925 | Train Acc: 0.9438
 Site-MNIST                         | Train Loss: 0.1923 | Train Acc: 0.9428
 Site-MNIST                         | Train Loss: 0.1585 | Train Acc: 0.9501
 Site-MNIST                         | Train Loss: 0.1390 | Train Acc: 0.9641
 Site-USPS                          | Train Loss: 0.1993 | Train Acc: 0.9424
 Site-USPS                          | Train Loss: 0.1510 | Train Acc: 0.9569
 Site-USPS                          | Train Loss: 0.1828 | Train Acc: 0.9510
 Site-SynthDigits                   | Train Loss: 0.9585 | Train Acc: 0.6932
 Site-SynthDigits                   | Train Loss: 0.8499 | Train Acc: 0.7348
 Site-MNIST_M                       | Train Loss: 1.3651 | Train Acc: 0.5398
 Site-MNIST_M                       | Train Loss: 1.3858 | Train Acc: 0.5152
 Site-SVHN                          | Train Loss: 1.6199 | Train Acc: 0.4174
Average Train Accuracy: 0.8082
 Site-MNIST                         | Val  Loss: 0.1312 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1275 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1500 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1988 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.1881 | Val  Acc: 0.9439
 Site-USPS                          | Val  Loss: 0.1282 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.2026 | Val  Acc: 0.9359
 Site-USPS                          | Val  Loss: 0.2286 | Val  Acc: 0.9359
 Site-SynthDigits                   | Val  Loss: 1.1095 | Val  Acc: 0.6288
 Site-SynthDigits                   | Val  Loss: 0.7760 | Val  Acc: 0.7121
 Site-MNIST_M                       | Val  Loss: 1.2104 | Val  Acc: 0.5682
 Site-MNIST_M                       | Val  Loss: 1.2903 | Val  Acc: 0.5152
 Site-SVHN                          | Val  Loss: 1.7512 | Val  Acc: 0.3904
Average Valid Accuracy: 0.8042
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9683
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9421
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9439
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9615
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9359
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9359
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.6288
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.7121
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.5682
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.5152
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3904
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.1807 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.1948 | Train Acc: 0.9467
 Site-MNIST                         | Train Loss: 0.1873 | Train Acc: 0.9408
 Site-MNIST                         | Train Loss: 0.1582 | Train Acc: 0.9540
 Site-MNIST                         | Train Loss: 0.1307 | Train Acc: 0.9676
 Site-USPS                          | Train Loss: 0.1874 | Train Acc: 0.9448
 Site-USPS                          | Train Loss: 0.1450 | Train Acc: 0.9601
 Site-USPS                          | Train Loss: 0.1677 | Train Acc: 0.9553
 Site-SynthDigits                   | Train Loss: 0.9959 | Train Acc: 0.6837
 Site-SynthDigits                   | Train Loss: 0.8390 | Train Acc: 0.7500
 Site-MNIST_M                       | Train Loss: 1.3694 | Train Acc: 0.5369
 Site-MNIST_M                       | Train Loss: 1.3943 | Train Acc: 0.5189
 Site-SVHN                          | Train Loss: 1.6218 | Train Acc: 0.4276
Average Train Accuracy: 0.8106
 Site-MNIST                         | Val  Loss: 0.1492 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1298 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1522 | Val  Acc: 0.9603
 Site-MNIST                         | Val  Loss: 0.1893 | Val  Acc: 0.9368
 Site-MNIST                         | Val  Loss: 0.1796 | Val  Acc: 0.9474
 Site-USPS                          | Val  Loss: 0.1140 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1889 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.2169 | Val  Acc: 0.9402
 Site-SynthDigits                   | Val  Loss: 1.1234 | Val  Acc: 0.6288
 Site-SynthDigits                   | Val  Loss: 0.7659 | Val  Acc: 0.7020
 Site-MNIST_M                       | Val  Loss: 1.2118 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.2654 | Val  Acc: 0.5076
 Site-SVHN                          | Val  Loss: 1.7629 | Val  Acc: 0.3630
Average Valid Accuracy: 0.8026
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.1596 | Train Acc: 0.9600
 Site-MNIST                         | Train Loss: 0.1490 | Train Acc: 0.9467
 Site-MNIST                         | Train Loss: 0.1809 | Train Acc: 0.9467
 Site-MNIST                         | Train Loss: 0.1483 | Train Acc: 0.9566
 Site-MNIST                         | Train Loss: 0.1226 | Train Acc: 0.9746
 Site-USPS                          | Train Loss: 0.1908 | Train Acc: 0.9472
 Site-USPS                          | Train Loss: 0.1457 | Train Acc: 0.9537
 Site-USPS                          | Train Loss: 0.1737 | Train Acc: 0.9553
 Site-SynthDigits                   | Train Loss: 0.9462 | Train Acc: 0.6989
 Site-SynthDigits                   | Train Loss: 0.8197 | Train Acc: 0.7487
 Site-MNIST_M                       | Train Loss: 1.3776 | Train Acc: 0.5483
 Site-MNIST_M                       | Train Loss: 1.3817 | Train Acc: 0.5170
 Site-SVHN                          | Train Loss: 1.6589 | Train Acc: 0.4123
Average Train Accuracy: 0.8128
 Site-MNIST                         | Val  Loss: 0.1360 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1225 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1441 | Val  Acc: 0.9603
 Site-MNIST                         | Val  Loss: 0.1869 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.1760 | Val  Acc: 0.9474
 Site-USPS                          | Val  Loss: 0.1169 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1936 | Val  Acc: 0.9359
 Site-USPS                          | Val  Loss: 0.2200 | Val  Acc: 0.9359
 Site-SynthDigits                   | Val  Loss: 1.1028 | Val  Acc: 0.6288
 Site-SynthDigits                   | Val  Loss: 0.7471 | Val  Acc: 0.7121
 Site-MNIST_M                       | Val  Loss: 1.2342 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.2615 | Val  Acc: 0.5303
 Site-SVHN                          | Val  Loss: 1.7387 | Val  Acc: 0.3973
Average Valid Accuracy: 0.8082
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9603
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9421
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9474
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9615
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9359
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9359
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.6288
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.7121
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.6023
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.5303
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.1717 | Train Acc: 0.9467
 Site-MNIST                         | Train Loss: 0.1476 | Train Acc: 0.9438
 Site-MNIST                         | Train Loss: 0.1730 | Train Acc: 0.9467
 Site-MNIST                         | Train Loss: 0.1425 | Train Acc: 0.9566
 Site-MNIST                         | Train Loss: 0.1230 | Train Acc: 0.9702
 Site-USPS                          | Train Loss: 0.1749 | Train Acc: 0.9568
 Site-USPS                          | Train Loss: 0.1358 | Train Acc: 0.9665
 Site-USPS                          | Train Loss: 0.1589 | Train Acc: 0.9595
 Site-SynthDigits                   | Train Loss: 0.9224 | Train Acc: 0.7045
 Site-SynthDigits                   | Train Loss: 0.8095 | Train Acc: 0.7538
 Site-MNIST_M                       | Train Loss: 1.3569 | Train Acc: 0.5511
 Site-MNIST_M                       | Train Loss: 1.3523 | Train Acc: 0.5189
 Site-SVHN                          | Train Loss: 1.6076 | Train Acc: 0.4327
Average Train Accuracy: 0.8160
 Site-MNIST                         | Val  Loss: 0.1300 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1128 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1359 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1798 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.1754 | Val  Acc: 0.9404
 Site-USPS                          | Val  Loss: 0.1061 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1785 | Val  Acc: 0.9487
 Site-USPS                          | Val  Loss: 0.2045 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 1.0696 | Val  Acc: 0.6439
 Site-SynthDigits                   | Val  Loss: 0.7279 | Val  Acc: 0.7222
 Site-MNIST_M                       | Val  Loss: 1.2266 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.2616 | Val  Acc: 0.5379
 Site-SVHN                          | Val  Loss: 1.7200 | Val  Acc: 0.3973
Average Valid Accuracy: 0.8131
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9683
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9421
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9404
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9615
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9487
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9530
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.6439
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.7222
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.6023
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5379
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.1879 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.1565 | Train Acc: 0.9467
 Site-MNIST                         | Train Loss: 0.1703 | Train Acc: 0.9448
 Site-MNIST                         | Train Loss: 0.1418 | Train Acc: 0.9606
 Site-MNIST                         | Train Loss: 0.1163 | Train Acc: 0.9737
 Site-USPS                          | Train Loss: 0.1820 | Train Acc: 0.9568
 Site-USPS                          | Train Loss: 0.1312 | Train Acc: 0.9633
 Site-USPS                          | Train Loss: 0.1529 | Train Acc: 0.9617
 Site-SynthDigits                   | Train Loss: 0.8996 | Train Acc: 0.7102
 Site-SynthDigits                   | Train Loss: 0.7786 | Train Acc: 0.7626
 Site-MNIST_M                       | Train Loss: 1.4072 | Train Acc: 0.5597
 Site-MNIST_M                       | Train Loss: 1.3618 | Train Acc: 0.5265
 Site-SVHN                          | Train Loss: 1.6221 | Train Acc: 0.4344
Average Train Accuracy: 0.8194
 Site-MNIST                         | Val  Loss: 0.1363 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1232 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1335 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.1722 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.1707 | Val  Acc: 0.9439
 Site-USPS                          | Val  Loss: 0.1021 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.1670 | Val  Acc: 0.9551
 Site-USPS                          | Val  Loss: 0.2013 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 1.0414 | Val  Acc: 0.6742
 Site-SynthDigits                   | Val  Loss: 0.7146 | Val  Acc: 0.7222
 Site-MNIST_M                       | Val  Loss: 1.2163 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.2257 | Val  Acc: 0.5303
 Site-SVHN                          | Val  Loss: 1.7044 | Val  Acc: 0.4041
Average Valid Accuracy: 0.8173
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9421
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.9439
 Best site-USPS                      | Epoch:21 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:21 | Val Acc: 0.9551
 Best site-USPS                      | Epoch:21 | Val Acc: 0.9530
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.6742
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.7222
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.6364
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.5303
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.4041
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.1697 | Train Acc: 0.9556
 Site-MNIST                         | Train Loss: 0.1608 | Train Acc: 0.9467
 Site-MNIST                         | Train Loss: 0.1661 | Train Acc: 0.9467
 Site-MNIST                         | Train Loss: 0.1354 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.1156 | Train Acc: 0.9720
 Site-USPS                          | Train Loss: 0.1788 | Train Acc: 0.9520
 Site-USPS                          | Train Loss: 0.1287 | Train Acc: 0.9649
 Site-USPS                          | Train Loss: 0.1493 | Train Acc: 0.9606
 Site-SynthDigits                   | Train Loss: 0.9137 | Train Acc: 0.7178
 Site-SynthDigits                   | Train Loss: 0.7566 | Train Acc: 0.7740
 Site-MNIST_M                       | Train Loss: 1.3061 | Train Acc: 0.5597
 Site-MNIST_M                       | Train Loss: 1.3353 | Train Acc: 0.5436
 Site-SVHN                          | Train Loss: 1.6301 | Train Acc: 0.4361
Average Train Accuracy: 0.8226
 Site-MNIST                         | Val  Loss: 0.1244 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1076 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1322 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1745 | Val  Acc: 0.9474
 Site-MNIST                         | Val  Loss: 0.1716 | Val  Acc: 0.9439
 Site-USPS                          | Val  Loss: 0.0965 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1726 | Val  Acc: 0.9423
 Site-USPS                          | Val  Loss: 0.1999 | Val  Acc: 0.9402
 Site-SynthDigits                   | Val  Loss: 1.0108 | Val  Acc: 0.6742
 Site-SynthDigits                   | Val  Loss: 0.6999 | Val  Acc: 0.7273
 Site-MNIST_M                       | Val  Loss: 1.1913 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.2654 | Val  Acc: 0.5379
 Site-SVHN                          | Val  Loss: 1.7040 | Val  Acc: 0.3973
Average Valid Accuracy: 0.8141
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.1533 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.1783 | Train Acc: 0.9527
 Site-MNIST                         | Train Loss: 0.1612 | Train Acc: 0.9467
 Site-MNIST                         | Train Loss: 0.1342 | Train Acc: 0.9619
 Site-MNIST                         | Train Loss: 0.1098 | Train Acc: 0.9720
 Site-USPS                          | Train Loss: 0.1757 | Train Acc: 0.9568
 Site-USPS                          | Train Loss: 0.1223 | Train Acc: 0.9649
 Site-USPS                          | Train Loss: 0.1434 | Train Acc: 0.9617
 Site-SynthDigits                   | Train Loss: 0.8959 | Train Acc: 0.7216
 Site-SynthDigits                   | Train Loss: 0.7618 | Train Acc: 0.7689
 Site-MNIST_M                       | Train Loss: 1.3177 | Train Acc: 0.5625
 Site-MNIST_M                       | Train Loss: 1.3355 | Train Acc: 0.5455
 Site-SVHN                          | Train Loss: 1.6218 | Train Acc: 0.4361
Average Train Accuracy: 0.8233
 Site-MNIST                         | Val  Loss: 0.1101 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1012 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1338 | Val  Acc: 0.9603
 Site-MNIST                         | Val  Loss: 0.1729 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.1669 | Val  Acc: 0.9509
 Site-USPS                          | Val  Loss: 0.0840 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.1604 | Val  Acc: 0.9551
 Site-USPS                          | Val  Loss: 0.1959 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 1.0193 | Val  Acc: 0.6894
 Site-SynthDigits                   | Val  Loss: 0.6959 | Val  Acc: 0.7273
 Site-MNIST_M                       | Val  Loss: 1.2222 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.2418 | Val  Acc: 0.5379
 Site-SVHN                          | Val  Loss: 1.6964 | Val  Acc: 0.4110
Average Valid Accuracy: 0.8212
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9603
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9421
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9509
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9551
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9530
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.6894
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.7273
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.6250
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.5379
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.4110
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.1589 | Train Acc: 0.9600
 Site-MNIST                         | Train Loss: 0.1372 | Train Acc: 0.9497
 Site-MNIST                         | Train Loss: 0.1611 | Train Acc: 0.9467
 Site-MNIST                         | Train Loss: 0.1250 | Train Acc: 0.9658
 Site-MNIST                         | Train Loss: 0.1049 | Train Acc: 0.9755
 Site-USPS                          | Train Loss: 0.1634 | Train Acc: 0.9592
 Site-USPS                          | Train Loss: 0.1226 | Train Acc: 0.9712
 Site-USPS                          | Train Loss: 0.1407 | Train Acc: 0.9595
 Site-SynthDigits                   | Train Loss: 0.8526 | Train Acc: 0.7140
 Site-SynthDigits                   | Train Loss: 0.7446 | Train Acc: 0.7727
 Site-MNIST_M                       | Train Loss: 1.3334 | Train Acc: 0.5653
 Site-MNIST_M                       | Train Loss: 1.2673 | Train Acc: 0.5530
 Site-SVHN                          | Train Loss: 1.5919 | Train Acc: 0.4378
Average Train Accuracy: 0.8254
 Site-MNIST                         | Val  Loss: 0.1212 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1039 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1300 | Val  Acc: 0.9603
 Site-MNIST                         | Val  Loss: 0.1683 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.1600 | Val  Acc: 0.9474
 Site-USPS                          | Val  Loss: 0.0898 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1595 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1895 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 1.0061 | Val  Acc: 0.6515
 Site-SynthDigits                   | Val  Loss: 0.6861 | Val  Acc: 0.7222
 Site-MNIST_M                       | Val  Loss: 1.2196 | Val  Acc: 0.6136
 Site-MNIST_M                       | Val  Loss: 1.2586 | Val  Acc: 0.5379
 Site-SVHN                          | Val  Loss: 1.6690 | Val  Acc: 0.4110
Average Valid Accuracy: 0.8180
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.1563 | Train Acc: 0.9556
 Site-MNIST                         | Train Loss: 0.1456 | Train Acc: 0.9527
 Site-MNIST                         | Train Loss: 0.1569 | Train Acc: 0.9507
 Site-MNIST                         | Train Loss: 0.1270 | Train Acc: 0.9658
 Site-MNIST                         | Train Loss: 0.1037 | Train Acc: 0.9737
 Site-USPS                          | Train Loss: 0.1582 | Train Acc: 0.9568
 Site-USPS                          | Train Loss: 0.1178 | Train Acc: 0.9696
 Site-USPS                          | Train Loss: 0.1350 | Train Acc: 0.9606
 Site-SynthDigits                   | Train Loss: 0.8431 | Train Acc: 0.7178
 Site-SynthDigits                   | Train Loss: 0.7428 | Train Acc: 0.7702
 Site-MNIST_M                       | Train Loss: 1.3310 | Train Acc: 0.5710
 Site-MNIST_M                       | Train Loss: 1.2639 | Train Acc: 0.5511
 Site-SVHN                          | Train Loss: 1.5750 | Train Acc: 0.4480
Average Train Accuracy: 0.8264
 Site-MNIST                         | Val  Loss: 0.1071 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1022 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1274 | Val  Acc: 0.9603
 Site-MNIST                         | Val  Loss: 0.1655 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.1626 | Val  Acc: 0.9509
 Site-USPS                          | Val  Loss: 0.0877 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.1558 | Val  Acc: 0.9551
 Site-USPS                          | Val  Loss: 0.1828 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.9913 | Val  Acc: 0.6667
 Site-SynthDigits                   | Val  Loss: 0.6742 | Val  Acc: 0.7222
 Site-MNIST_M                       | Val  Loss: 1.1973 | Val  Acc: 0.6136
 Site-MNIST_M                       | Val  Loss: 1.2330 | Val  Acc: 0.5530
 Site-SVHN                          | Val  Loss: 1.6714 | Val  Acc: 0.4110
Average Valid Accuracy: 0.8193
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.1411 | Train Acc: 0.9600
 Site-MNIST                         | Train Loss: 0.1409 | Train Acc: 0.9556
 Site-MNIST                         | Train Loss: 0.1519 | Train Acc: 0.9507
 Site-MNIST                         | Train Loss: 0.1247 | Train Acc: 0.9671
 Site-MNIST                         | Train Loss: 0.0998 | Train Acc: 0.9781
 Site-USPS                          | Train Loss: 0.1702 | Train Acc: 0.9520
 Site-USPS                          | Train Loss: 0.1130 | Train Acc: 0.9712
 Site-USPS                          | Train Loss: 0.1336 | Train Acc: 0.9606
 Site-SynthDigits                   | Train Loss: 0.8490 | Train Acc: 0.7216
 Site-SynthDigits                   | Train Loss: 0.7183 | Train Acc: 0.7677
 Site-MNIST_M                       | Train Loss: 1.3058 | Train Acc: 0.5597
 Site-MNIST_M                       | Train Loss: 1.3131 | Train Acc: 0.5511
 Site-SVHN                          | Train Loss: 1.5916 | Train Acc: 0.4549
Average Train Accuracy: 0.8270
 Site-MNIST                         | Val  Loss: 0.1093 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0999 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1199 | Val  Acc: 0.9603
 Site-MNIST                         | Val  Loss: 0.1613 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.1590 | Val  Acc: 0.9544
 Site-USPS                          | Val  Loss: 0.0837 | Val  Acc: 0.9904
 Site-USPS                          | Val  Loss: 0.1493 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1828 | Val  Acc: 0.9487
 Site-SynthDigits                   | Val  Loss: 0.9569 | Val  Acc: 0.6894
 Site-SynthDigits                   | Val  Loss: 0.6727 | Val  Acc: 0.7222
 Site-MNIST_M                       | Val  Loss: 1.2006 | Val  Acc: 0.6136
 Site-MNIST_M                       | Val  Loss: 1.2170 | Val  Acc: 0.5379
 Site-SVHN                          | Val  Loss: 1.6838 | Val  Acc: 0.4178
Average Valid Accuracy: 0.8229
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9603
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9421
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9544
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9904
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9679
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9487
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.6894
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.7222
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.6136
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5379
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.4178
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.1477 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.1397 | Train Acc: 0.9497
 Site-MNIST                         | Train Loss: 0.1508 | Train Acc: 0.9527
 Site-MNIST                         | Train Loss: 0.1209 | Train Acc: 0.9632
 Site-MNIST                         | Train Loss: 0.0984 | Train Acc: 0.9790
 Site-USPS                          | Train Loss: 0.1578 | Train Acc: 0.9592
 Site-USPS                          | Train Loss: 0.1110 | Train Acc: 0.9712
 Site-USPS                          | Train Loss: 0.1263 | Train Acc: 0.9638
 Site-SynthDigits                   | Train Loss: 0.8691 | Train Acc: 0.7197
 Site-SynthDigits                   | Train Loss: 0.7141 | Train Acc: 0.7740
 Site-MNIST_M                       | Train Loss: 1.2980 | Train Acc: 0.5710
 Site-MNIST_M                       | Train Loss: 1.2507 | Train Acc: 0.5379
 Site-SVHN                          | Train Loss: 1.5924 | Train Acc: 0.4566
Average Train Accuracy: 0.8279
 Site-MNIST                         | Val  Loss: 0.1249 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1050 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1216 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1645 | Val  Acc: 0.9474
 Site-MNIST                         | Val  Loss: 0.1628 | Val  Acc: 0.9474
 Site-USPS                          | Val  Loss: 0.0765 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1447 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1799 | Val  Acc: 0.9487
 Site-SynthDigits                   | Val  Loss: 0.9706 | Val  Acc: 0.6515
 Site-SynthDigits                   | Val  Loss: 0.6720 | Val  Acc: 0.7222
 Site-MNIST_M                       | Val  Loss: 1.1862 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.2567 | Val  Acc: 0.5530
 Site-SVHN                          | Val  Loss: 1.6584 | Val  Acc: 0.4110
Average Valid Accuracy: 0.8216
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.1645 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.1471 | Train Acc: 0.9527
 Site-MNIST                         | Train Loss: 0.1466 | Train Acc: 0.9527
 Site-MNIST                         | Train Loss: 0.1192 | Train Acc: 0.9658
 Site-MNIST                         | Train Loss: 0.1003 | Train Acc: 0.9781
 Site-USPS                          | Train Loss: 0.1469 | Train Acc: 0.9592
 Site-USPS                          | Train Loss: 0.1063 | Train Acc: 0.9792
 Site-USPS                          | Train Loss: 0.1182 | Train Acc: 0.9670
 Site-SynthDigits                   | Train Loss: 0.8346 | Train Acc: 0.7178
 Site-SynthDigits                   | Train Loss: 0.7237 | Train Acc: 0.7727
 Site-MNIST_M                       | Train Loss: 1.3036 | Train Acc: 0.5653
 Site-MNIST_M                       | Train Loss: 1.2203 | Train Acc: 0.5511
 Site-SVHN                          | Train Loss: 1.5502 | Train Acc: 0.4566
Average Train Accuracy: 0.8294
 Site-MNIST                         | Val  Loss: 0.1060 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0903 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1198 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1597 | Val  Acc: 0.9474
 Site-MNIST                         | Val  Loss: 0.1594 | Val  Acc: 0.9509
 Site-USPS                          | Val  Loss: 0.0706 | Val  Acc: 0.9904
 Site-USPS                          | Val  Loss: 0.1369 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1692 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.9582 | Val  Acc: 0.6591
 Site-SynthDigits                   | Val  Loss: 0.6624 | Val  Acc: 0.7121
 Site-MNIST_M                       | Val  Loss: 1.1743 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.2337 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 1.6618 | Val  Acc: 0.4178
Average Valid Accuracy: 0.8218
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.1533 | Train Acc: 0.9556
 Site-MNIST                         | Train Loss: 0.1301 | Train Acc: 0.9556
 Site-MNIST                         | Train Loss: 0.1449 | Train Acc: 0.9527
 Site-MNIST                         | Train Loss: 0.1185 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.0949 | Train Acc: 0.9790
 Site-USPS                          | Train Loss: 0.1440 | Train Acc: 0.9616
 Site-USPS                          | Train Loss: 0.1081 | Train Acc: 0.9728
 Site-USPS                          | Train Loss: 0.1202 | Train Acc: 0.9681
 Site-SynthDigits                   | Train Loss: 0.8531 | Train Acc: 0.7197
 Site-SynthDigits                   | Train Loss: 0.7038 | Train Acc: 0.7740
 Site-MNIST_M                       | Train Loss: 1.2923 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.2757 | Train Acc: 0.5511
 Site-SVHN                          | Train Loss: 1.5474 | Train Acc: 0.4719
Average Train Accuracy: 0.8312
 Site-MNIST                         | Val  Loss: 0.1132 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1023 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1157 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1579 | Val  Acc: 0.9421
 Site-MNIST                         | Val  Loss: 0.1571 | Val  Acc: 0.9509
 Site-USPS                          | Val  Loss: 0.0748 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.1347 | Val  Acc: 0.9551
 Site-USPS                          | Val  Loss: 0.1657 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.9341 | Val  Acc: 0.6818
 Site-SynthDigits                   | Val  Loss: 0.6580 | Val  Acc: 0.7222
 Site-MNIST_M                       | Val  Loss: 1.1873 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.2109 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 1.6531 | Val  Acc: 0.4178
Average Valid Accuracy: 0.8219
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.1375 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.1240 | Train Acc: 0.9556
 Site-MNIST                         | Train Loss: 0.1386 | Train Acc: 0.9546
 Site-MNIST                         | Train Loss: 0.1102 | Train Acc: 0.9671
 Site-MNIST                         | Train Loss: 0.0910 | Train Acc: 0.9807
 Site-USPS                          | Train Loss: 0.1453 | Train Acc: 0.9640
 Site-USPS                          | Train Loss: 0.1033 | Train Acc: 0.9776
 Site-USPS                          | Train Loss: 0.1203 | Train Acc: 0.9649
 Site-SynthDigits                   | Train Loss: 0.7817 | Train Acc: 0.7348
 Site-SynthDigits                   | Train Loss: 0.6867 | Train Acc: 0.7803
 Site-MNIST_M                       | Train Loss: 1.2992 | Train Acc: 0.5682
 Site-MNIST_M                       | Train Loss: 1.2784 | Train Acc: 0.5511
 Site-SVHN                          | Train Loss: 1.5954 | Train Acc: 0.4787
Average Train Accuracy: 0.8340
 Site-MNIST                         | Val  Loss: 0.0922 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0826 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1115 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1575 | Val  Acc: 0.9474
 Site-MNIST                         | Val  Loss: 0.1510 | Val  Acc: 0.9544
 Site-USPS                          | Val  Loss: 0.0767 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1327 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1655 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.9033 | Val  Acc: 0.6894
 Site-SynthDigits                   | Val  Loss: 0.6313 | Val  Acc: 0.7374
 Site-MNIST_M                       | Val  Loss: 1.1927 | Val  Acc: 0.6136
 Site-MNIST_M                       | Val  Loss: 1.2352 | Val  Acc: 0.5303
 Site-SVHN                          | Val  Loss: 1.6183 | Val  Acc: 0.4452
Average Valid Accuracy: 0.8257
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9683
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9474
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9544
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9808
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9615
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9530
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.6894
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.7374
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.6136
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5303
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.4452
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.1398 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.1395 | Train Acc: 0.9497
 Site-MNIST                         | Train Loss: 0.1340 | Train Acc: 0.9566
 Site-MNIST                         | Train Loss: 0.1092 | Train Acc: 0.9724
 Site-MNIST                         | Train Loss: 0.0868 | Train Acc: 0.9825
 Site-USPS                          | Train Loss: 0.1551 | Train Acc: 0.9640
 Site-USPS                          | Train Loss: 0.1013 | Train Acc: 0.9728
 Site-USPS                          | Train Loss: 0.1189 | Train Acc: 0.9681
 Site-SynthDigits                   | Train Loss: 0.7844 | Train Acc: 0.7254
 Site-SynthDigits                   | Train Loss: 0.6841 | Train Acc: 0.7841
 Site-MNIST_M                       | Train Loss: 1.2812 | Train Acc: 0.5653
 Site-MNIST_M                       | Train Loss: 1.2417 | Train Acc: 0.5606
 Site-SVHN                          | Train Loss: 1.5516 | Train Acc: 0.4787
Average Train Accuracy: 0.8342
 Site-MNIST                         | Val  Loss: 0.0846 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0774 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1083 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1534 | Val  Acc: 0.9526
 Site-MNIST                         | Val  Loss: 0.1472 | Val  Acc: 0.9474
 Site-USPS                          | Val  Loss: 0.0724 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1331 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1662 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.9291 | Val  Acc: 0.6818
 Site-SynthDigits                   | Val  Loss: 0.6335 | Val  Acc: 0.7172
 Site-MNIST_M                       | Val  Loss: 1.1803 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.2236 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 1.6334 | Val  Acc: 0.4247
Average Valid Accuracy: 0.8253
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.1372 | Train Acc: 0.9600
 Site-MNIST                         | Train Loss: 0.1311 | Train Acc: 0.9586
 Site-MNIST                         | Train Loss: 0.1349 | Train Acc: 0.9566
 Site-MNIST                         | Train Loss: 0.1087 | Train Acc: 0.9711
 Site-MNIST                         | Train Loss: 0.0860 | Train Acc: 0.9834
 Site-USPS                          | Train Loss: 0.1407 | Train Acc: 0.9616
 Site-USPS                          | Train Loss: 0.0976 | Train Acc: 0.9776
 Site-USPS                          | Train Loss: 0.1119 | Train Acc: 0.9723
 Site-SynthDigits                   | Train Loss: 0.7842 | Train Acc: 0.7273
 Site-SynthDigits                   | Train Loss: 0.6769 | Train Acc: 0.7929
 Site-MNIST_M                       | Train Loss: 1.3226 | Train Acc: 0.5682
 Site-MNIST_M                       | Train Loss: 1.2363 | Train Acc: 0.5511
 Site-SVHN                          | Train Loss: 1.5284 | Train Acc: 0.4906
Average Train Accuracy: 0.8363
 Site-MNIST                         | Val  Loss: 0.0882 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0788 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1106 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1558 | Val  Acc: 0.9526
 Site-MNIST                         | Val  Loss: 0.1493 | Val  Acc: 0.9544
 Site-USPS                          | Val  Loss: 0.0704 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1251 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1586 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.9027 | Val  Acc: 0.6894
 Site-SynthDigits                   | Val  Loss: 0.6252 | Val  Acc: 0.7172
 Site-MNIST_M                       | Val  Loss: 1.1879 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.2087 | Val  Acc: 0.5379
 Site-SVHN                          | Val  Loss: 1.6152 | Val  Acc: 0.4589
Average Valid Accuracy: 0.8270
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9683
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9526
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9544
 Best site-USPS                      | Epoch:32 | Val Acc: 0.9808
 Best site-USPS                      | Epoch:32 | Val Acc: 0.9615
 Best site-USPS                      | Epoch:32 | Val Acc: 0.9530
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.6894
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.7172
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.6250
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.5379
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.4589
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.1622 | Train Acc: 0.9600
 Site-MNIST                         | Train Loss: 0.1320 | Train Acc: 0.9615
 Site-MNIST                         | Train Loss: 0.1359 | Train Acc: 0.9586
 Site-MNIST                         | Train Loss: 0.1064 | Train Acc: 0.9685
 Site-MNIST                         | Train Loss: 0.0857 | Train Acc: 0.9825
 Site-USPS                          | Train Loss: 0.1352 | Train Acc: 0.9664
 Site-USPS                          | Train Loss: 0.0964 | Train Acc: 0.9792
 Site-USPS                          | Train Loss: 0.1119 | Train Acc: 0.9712
 Site-SynthDigits                   | Train Loss: 0.7588 | Train Acc: 0.7235
 Site-SynthDigits                   | Train Loss: 0.6521 | Train Acc: 0.7992
 Site-MNIST_M                       | Train Loss: 1.3100 | Train Acc: 0.5682
 Site-MNIST_M                       | Train Loss: 1.2611 | Train Acc: 0.5701
 Site-SVHN                          | Train Loss: 1.5221 | Train Acc: 0.4957
Average Train Accuracy: 0.8388
 Site-MNIST                         | Val  Loss: 0.0915 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0808 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1105 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1583 | Val  Acc: 0.9526
 Site-MNIST                         | Val  Loss: 0.1489 | Val  Acc: 0.9579
 Site-USPS                          | Val  Loss: 0.0659 | Val  Acc: 0.9904
 Site-USPS                          | Val  Loss: 0.1235 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1592 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.8941 | Val  Acc: 0.6970
 Site-SynthDigits                   | Val  Loss: 0.6206 | Val  Acc: 0.7071
 Site-MNIST_M                       | Val  Loss: 1.1807 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.1938 | Val  Acc: 0.5530
 Site-SVHN                          | Val  Loss: 1.6039 | Val  Acc: 0.4521
Average Valid Accuracy: 0.8312
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9683
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9526
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9579
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9904
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9679
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9530
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.6970
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.7071
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.6364
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5530
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.4521
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.1298 | Train Acc: 0.9556
 Site-MNIST                         | Train Loss: 0.1228 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.1311 | Train Acc: 0.9527
 Site-MNIST                         | Train Loss: 0.1030 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0816 | Train Acc: 0.9842
 Site-USPS                          | Train Loss: 0.1325 | Train Acc: 0.9616
 Site-USPS                          | Train Loss: 0.0930 | Train Acc: 0.9792
 Site-USPS                          | Train Loss: 0.1091 | Train Acc: 0.9702
 Site-SynthDigits                   | Train Loss: 0.7989 | Train Acc: 0.7405
 Site-SynthDigits                   | Train Loss: 0.6565 | Train Acc: 0.7955
 Site-MNIST_M                       | Train Loss: 1.2922 | Train Acc: 0.5597
 Site-MNIST_M                       | Train Loss: 1.2068 | Train Acc: 0.5568
 Site-SVHN                          | Train Loss: 1.4911 | Train Acc: 0.4957
Average Train Accuracy: 0.8377
 Site-MNIST                         | Val  Loss: 0.0900 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.0771 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1066 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1484 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.1468 | Val  Acc: 0.9614
 Site-USPS                          | Val  Loss: 0.0644 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1244 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1570 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.8987 | Val  Acc: 0.7121
 Site-SynthDigits                   | Val  Loss: 0.6223 | Val  Acc: 0.7323
 Site-MNIST_M                       | Val  Loss: 1.1960 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.2045 | Val  Acc: 0.5303
 Site-SVHN                          | Val  Loss: 1.5895 | Val  Acc: 0.4452
Average Valid Accuracy: 0.8292
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.1428 | Train Acc: 0.9556
 Site-MNIST                         | Train Loss: 0.1412 | Train Acc: 0.9615
 Site-MNIST                         | Train Loss: 0.1317 | Train Acc: 0.9566
 Site-MNIST                         | Train Loss: 0.1043 | Train Acc: 0.9685
 Site-MNIST                         | Train Loss: 0.0815 | Train Acc: 0.9834
 Site-USPS                          | Train Loss: 0.1305 | Train Acc: 0.9688
 Site-USPS                          | Train Loss: 0.0942 | Train Acc: 0.9776
 Site-USPS                          | Train Loss: 0.1010 | Train Acc: 0.9766
 Site-SynthDigits                   | Train Loss: 0.8272 | Train Acc: 0.7235
 Site-SynthDigits                   | Train Loss: 0.6515 | Train Acc: 0.7917
 Site-MNIST_M                       | Train Loss: 1.2641 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.2092 | Train Acc: 0.5530
 Site-SVHN                          | Train Loss: 1.4756 | Train Acc: 0.5009
Average Train Accuracy: 0.8382
 Site-MNIST                         | Val  Loss: 0.0998 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0827 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1114 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1470 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.1450 | Val  Acc: 0.9579
 Site-USPS                          | Val  Loss: 0.0590 | Val  Acc: 0.9904
 Site-USPS                          | Val  Loss: 0.1189 | Val  Acc: 0.9744
 Site-USPS                          | Val  Loss: 0.1512 | Val  Acc: 0.9573
 Site-SynthDigits                   | Val  Loss: 0.9213 | Val  Acc: 0.6894
 Site-SynthDigits                   | Val  Loss: 0.6204 | Val  Acc: 0.7222
 Site-MNIST_M                       | Val  Loss: 1.1669 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.1626 | Val  Acc: 0.5606
 Site-SVHN                          | Val  Loss: 1.5849 | Val  Acc: 0.4589
Average Valid Accuracy: 0.8347
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9579
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9579
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9904
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9744
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9573
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.6894
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.7222
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.6364
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.5606
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.4589
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.1710 | Train Acc: 0.9600
 Site-MNIST                         | Train Loss: 0.1341 | Train Acc: 0.9586
 Site-MNIST                         | Train Loss: 0.1264 | Train Acc: 0.9546
 Site-MNIST                         | Train Loss: 0.1030 | Train Acc: 0.9698
 Site-MNIST                         | Train Loss: 0.0812 | Train Acc: 0.9825
 Site-USPS                          | Train Loss: 0.1254 | Train Acc: 0.9712
 Site-USPS                          | Train Loss: 0.0924 | Train Acc: 0.9792
 Site-USPS                          | Train Loss: 0.0989 | Train Acc: 0.9776
 Site-SynthDigits                   | Train Loss: 0.7611 | Train Acc: 0.7443
 Site-SynthDigits                   | Train Loss: 0.6334 | Train Acc: 0.7967
 Site-MNIST_M                       | Train Loss: 1.2585 | Train Acc: 0.5824
 Site-MNIST_M                       | Train Loss: 1.2343 | Train Acc: 0.5663
 Site-SVHN                          | Train Loss: 1.4673 | Train Acc: 0.5111
Average Train Accuracy: 0.8426
 Site-MNIST                         | Val  Loss: 0.0964 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0759 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1060 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1502 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.1464 | Val  Acc: 0.9579
 Site-USPS                          | Val  Loss: 0.0572 | Val  Acc: 0.9904
 Site-USPS                          | Val  Loss: 0.1198 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1513 | Val  Acc: 0.9573
 Site-SynthDigits                   | Val  Loss: 0.8829 | Val  Acc: 0.7121
 Site-SynthDigits                   | Val  Loss: 0.6102 | Val  Acc: 0.7374
 Site-MNIST_M                       | Val  Loss: 1.1498 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.1686 | Val  Acc: 0.5530
 Site-SVHN                          | Val  Loss: 1.5735 | Val  Acc: 0.4452
Average Valid Accuracy: 0.8347
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.1304 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.1119 | Train Acc: 0.9586
 Site-MNIST                         | Train Loss: 0.1250 | Train Acc: 0.9566
 Site-MNIST                         | Train Loss: 0.0993 | Train Acc: 0.9750
 Site-MNIST                         | Train Loss: 0.0761 | Train Acc: 0.9877
 Site-USPS                          | Train Loss: 0.1253 | Train Acc: 0.9664
 Site-USPS                          | Train Loss: 0.0905 | Train Acc: 0.9792
 Site-USPS                          | Train Loss: 0.1002 | Train Acc: 0.9755
 Site-SynthDigits                   | Train Loss: 0.7704 | Train Acc: 0.7462
 Site-SynthDigits                   | Train Loss: 0.6559 | Train Acc: 0.8018
 Site-MNIST_M                       | Train Loss: 1.2143 | Train Acc: 0.5852
 Site-MNIST_M                       | Train Loss: 1.2346 | Train Acc: 0.5833
 Site-SVHN                          | Train Loss: 1.5823 | Train Acc: 0.5094
Average Train Accuracy: 0.8453
 Site-MNIST                         | Val  Loss: 0.0781 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0722 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1035 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1428 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.1407 | Val  Acc: 0.9579
 Site-USPS                          | Val  Loss: 0.0589 | Val  Acc: 0.9904
 Site-USPS                          | Val  Loss: 0.1182 | Val  Acc: 0.9744
 Site-USPS                          | Val  Loss: 0.1466 | Val  Acc: 0.9573
 Site-SynthDigits                   | Val  Loss: 0.8873 | Val  Acc: 0.7045
 Site-SynthDigits                   | Val  Loss: 0.6029 | Val  Acc: 0.7172
 Site-MNIST_M                       | Val  Loss: 1.1631 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.1487 | Val  Acc: 0.5682
 Site-SVHN                          | Val  Loss: 1.5847 | Val  Acc: 0.4589
Average Valid Accuracy: 0.8352
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9579
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9579
 Best site-USPS                      | Epoch:37 | Val Acc: 0.9904
 Best site-USPS                      | Epoch:37 | Val Acc: 0.9744
 Best site-USPS                      | Epoch:37 | Val Acc: 0.9573
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.7045
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.7172
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.6250
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.5682
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.4589
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.1540 | Train Acc: 0.9600
 Site-MNIST                         | Train Loss: 0.1236 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.1213 | Train Acc: 0.9546
 Site-MNIST                         | Train Loss: 0.0963 | Train Acc: 0.9750
 Site-MNIST                         | Train Loss: 0.0771 | Train Acc: 0.9860
 Site-USPS                          | Train Loss: 0.1307 | Train Acc: 0.9664
 Site-USPS                          | Train Loss: 0.0894 | Train Acc: 0.9824
 Site-USPS                          | Train Loss: 0.0988 | Train Acc: 0.9755
 Site-SynthDigits                   | Train Loss: 0.7693 | Train Acc: 0.7500
 Site-SynthDigits                   | Train Loss: 0.6253 | Train Acc: 0.8030
 Site-MNIST_M                       | Train Loss: 1.2482 | Train Acc: 0.5767
 Site-MNIST_M                       | Train Loss: 1.1866 | Train Acc: 0.5758
 Site-SVHN                          | Train Loss: 1.4424 | Train Acc: 0.5128
Average Train Accuracy: 0.8448
 Site-MNIST                         | Val  Loss: 0.0781 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0685 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1034 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1432 | Val  Acc: 0.9632
 Site-MNIST                         | Val  Loss: 0.1386 | Val  Acc: 0.9614
 Site-USPS                          | Val  Loss: 0.0588 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1140 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1454 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.8771 | Val  Acc: 0.7121
 Site-SynthDigits                   | Val  Loss: 0.5951 | Val  Acc: 0.7374
 Site-MNIST_M                       | Val  Loss: 1.1687 | Val  Acc: 0.6136
 Site-MNIST_M                       | Val  Loss: 1.1512 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 1.5744 | Val  Acc: 0.4658
Average Valid Accuracy: 0.8359
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9632
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.9614
 Best site-USPS                      | Epoch:38 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9679
 Best site-USPS                      | Epoch:38 | Val Acc: 0.9530
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.7121
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.7374
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.6136
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.5455
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.4658
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.1321 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.1219 | Train Acc: 0.9615
 Site-MNIST                         | Train Loss: 0.1219 | Train Acc: 0.9566
 Site-MNIST                         | Train Loss: 0.0958 | Train Acc: 0.9698
 Site-MNIST                         | Train Loss: 0.0758 | Train Acc: 0.9851
 Site-USPS                          | Train Loss: 0.1225 | Train Acc: 0.9664
 Site-USPS                          | Train Loss: 0.0846 | Train Acc: 0.9824
 Site-USPS                          | Train Loss: 0.0950 | Train Acc: 0.9766
 Site-SynthDigits                   | Train Loss: 0.7444 | Train Acc: 0.7443
 Site-SynthDigits                   | Train Loss: 0.6344 | Train Acc: 0.8056
 Site-MNIST_M                       | Train Loss: 1.2648 | Train Acc: 0.5767
 Site-MNIST_M                       | Train Loss: 1.1853 | Train Acc: 0.5795
 Site-SVHN                          | Train Loss: 1.4408 | Train Acc: 0.5077
Average Train Accuracy: 0.8444
 Site-MNIST                         | Val  Loss: 0.0681 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0671 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1024 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1482 | Val  Acc: 0.9526
 Site-MNIST                         | Val  Loss: 0.1413 | Val  Acc: 0.9579
 Site-USPS                          | Val  Loss: 0.0517 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1136 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1452 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.8926 | Val  Acc: 0.7121
 Site-SynthDigits                   | Val  Loss: 0.5985 | Val  Acc: 0.7323
 Site-MNIST_M                       | Val  Loss: 1.1815 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.1507 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 1.5866 | Val  Acc: 0.4384
Average Valid Accuracy: 0.8332
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.1301 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.1120 | Train Acc: 0.9615
 Site-MNIST                         | Train Loss: 0.1198 | Train Acc: 0.9586
 Site-MNIST                         | Train Loss: 0.0914 | Train Acc: 0.9777
 Site-MNIST                         | Train Loss: 0.0723 | Train Acc: 0.9869
 Site-USPS                          | Train Loss: 0.1245 | Train Acc: 0.9688
 Site-USPS                          | Train Loss: 0.0845 | Train Acc: 0.9808
 Site-USPS                          | Train Loss: 0.0975 | Train Acc: 0.9744
 Site-SynthDigits                   | Train Loss: 0.7448 | Train Acc: 0.7462
 Site-SynthDigits                   | Train Loss: 0.6225 | Train Acc: 0.8106
 Site-MNIST_M                       | Train Loss: 1.2342 | Train Acc: 0.5824
 Site-MNIST_M                       | Train Loss: 1.1809 | Train Acc: 0.5777
 Site-SVHN                          | Train Loss: 1.4341 | Train Acc: 0.5162
Average Train Accuracy: 0.8466
 Site-MNIST                         | Val  Loss: 0.0714 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0657 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1023 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1435 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.1390 | Val  Acc: 0.9579
 Site-USPS                          | Val  Loss: 0.0550 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1136 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1441 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.8617 | Val  Acc: 0.7197
 Site-SynthDigits                   | Val  Loss: 0.5863 | Val  Acc: 0.7323
 Site-MNIST_M                       | Val  Loss: 1.1783 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.1699 | Val  Acc: 0.5530
 Site-SVHN                          | Val  Loss: 1.5545 | Val  Acc: 0.4726
Average Valid Accuracy: 0.8382
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9579
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9579
 Best site-USPS                      | Epoch:40 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9679
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9530
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.7197
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.7323
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.6364
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.5530
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.4726
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.1516 | Train Acc: 0.9600
 Site-MNIST                         | Train Loss: 0.1087 | Train Acc: 0.9675
 Site-MNIST                         | Train Loss: 0.1208 | Train Acc: 0.9586
 Site-MNIST                         | Train Loss: 0.0925 | Train Acc: 0.9790
 Site-MNIST                         | Train Loss: 0.0721 | Train Acc: 0.9842
 Site-USPS                          | Train Loss: 0.1158 | Train Acc: 0.9688
 Site-USPS                          | Train Loss: 0.0847 | Train Acc: 0.9792
 Site-USPS                          | Train Loss: 0.0925 | Train Acc: 0.9755
 Site-SynthDigits                   | Train Loss: 0.7423 | Train Acc: 0.7595
 Site-SynthDigits                   | Train Loss: 0.6185 | Train Acc: 0.8119
 Site-MNIST_M                       | Train Loss: 1.2502 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.1785 | Train Acc: 0.5682
 Site-SVHN                          | Train Loss: 1.4515 | Train Acc: 0.5128
Average Train Accuracy: 0.8465
 Site-MNIST                         | Val  Loss: 0.0726 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0703 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1078 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1445 | Val  Acc: 0.9632
 Site-MNIST                         | Val  Loss: 0.1388 | Val  Acc: 0.9649
 Site-USPS                          | Val  Loss: 0.0558 | Val  Acc: 0.9904
 Site-USPS                          | Val  Loss: 0.1105 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1385 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.8687 | Val  Acc: 0.7424
 Site-SynthDigits                   | Val  Loss: 0.5844 | Val  Acc: 0.7424
 Site-MNIST_M                       | Val  Loss: 1.1779 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.1582 | Val  Acc: 0.5379
 Site-SVHN                          | Val  Loss: 1.5414 | Val  Acc: 0.4521
Average Valid Accuracy: 0.8363
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.1421 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.1151 | Train Acc: 0.9615
 Site-MNIST                         | Train Loss: 0.1167 | Train Acc: 0.9586
 Site-MNIST                         | Train Loss: 0.0878 | Train Acc: 0.9777
 Site-MNIST                         | Train Loss: 0.0664 | Train Acc: 0.9895
 Site-USPS                          | Train Loss: 0.1184 | Train Acc: 0.9640
 Site-USPS                          | Train Loss: 0.0836 | Train Acc: 0.9808
 Site-USPS                          | Train Loss: 0.0934 | Train Acc: 0.9776
 Site-SynthDigits                   | Train Loss: 0.6992 | Train Acc: 0.7633
 Site-SynthDigits                   | Train Loss: 0.5968 | Train Acc: 0.8131
 Site-MNIST_M                       | Train Loss: 1.2334 | Train Acc: 0.5852
 Site-MNIST_M                       | Train Loss: 1.1665 | Train Acc: 0.5682
 Site-SVHN                          | Train Loss: 1.4525 | Train Acc: 0.5247
Average Train Accuracy: 0.8484
 Site-MNIST                         | Val  Loss: 0.0816 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0732 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.0986 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1416 | Val  Acc: 0.9474
 Site-MNIST                         | Val  Loss: 0.1304 | Val  Acc: 0.9579
 Site-USPS                          | Val  Loss: 0.0596 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1076 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1339 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.8478 | Val  Acc: 0.7273
 Site-SynthDigits                   | Val  Loss: 0.5715 | Val  Acc: 0.7475
 Site-MNIST_M                       | Val  Loss: 1.1769 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.1783 | Val  Acc: 0.5530
 Site-SVHN                          | Val  Loss: 1.5448 | Val  Acc: 0.4726
Average Valid Accuracy: 0.8362
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.1367 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.1427 | Train Acc: 0.9734
 Site-MNIST                         | Train Loss: 0.1187 | Train Acc: 0.9625
 Site-MNIST                         | Train Loss: 0.0894 | Train Acc: 0.9750
 Site-MNIST                         | Train Loss: 0.0661 | Train Acc: 0.9860
 Site-USPS                          | Train Loss: 0.1212 | Train Acc: 0.9688
 Site-USPS                          | Train Loss: 0.0826 | Train Acc: 0.9776
 Site-USPS                          | Train Loss: 0.1008 | Train Acc: 0.9712
 Site-SynthDigits                   | Train Loss: 0.7513 | Train Acc: 0.7595
 Site-SynthDigits                   | Train Loss: 0.6006 | Train Acc: 0.8119
 Site-MNIST_M                       | Train Loss: 1.2547 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.2028 | Train Acc: 0.5739
 Site-SVHN                          | Train Loss: 1.4534 | Train Acc: 0.5128
Average Train Accuracy: 0.8474
 Site-MNIST                         | Val  Loss: 0.0648 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0715 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1011 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1477 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.1341 | Val  Acc: 0.9719
 Site-USPS                          | Val  Loss: 0.0600 | Val  Acc: 0.9808
 Site-USPS                          | Val  Loss: 0.1112 | Val  Acc: 0.9615
 Site-USPS                          | Val  Loss: 0.1393 | Val  Acc: 0.9573
 Site-SynthDigits                   | Val  Loss: 0.8528 | Val  Acc: 0.7348
 Site-SynthDigits                   | Val  Loss: 0.5693 | Val  Acc: 0.7576
 Site-MNIST_M                       | Val  Loss: 1.1963 | Val  Acc: 0.6136
 Site-MNIST_M                       | Val  Loss: 1.1652 | Val  Acc: 0.5606
 Site-SVHN                          | Val  Loss: 1.5442 | Val  Acc: 0.4452
Average Valid Accuracy: 0.8369
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.1301 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.1204 | Train Acc: 0.9704
 Site-MNIST                         | Train Loss: 0.1136 | Train Acc: 0.9606
 Site-MNIST                         | Train Loss: 0.0841 | Train Acc: 0.9816
 Site-MNIST                         | Train Loss: 0.0659 | Train Acc: 0.9886
 Site-USPS                          | Train Loss: 0.1158 | Train Acc: 0.9688
 Site-USPS                          | Train Loss: 0.0804 | Train Acc: 0.9840
 Site-USPS                          | Train Loss: 0.0950 | Train Acc: 0.9755
 Site-SynthDigits                   | Train Loss: 0.7002 | Train Acc: 0.7670
 Site-SynthDigits                   | Train Loss: 0.5949 | Train Acc: 0.8232
 Site-MNIST_M                       | Train Loss: 1.2218 | Train Acc: 0.5824
 Site-MNIST_M                       | Train Loss: 1.1523 | Train Acc: 0.5833
 Site-SVHN                          | Train Loss: 1.4315 | Train Acc: 0.5145
Average Train Accuracy: 0.8511
 Site-MNIST                         | Val  Loss: 0.0734 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0680 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.0974 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1407 | Val  Acc: 0.9632
 Site-MNIST                         | Val  Loss: 0.1307 | Val  Acc: 0.9684
 Site-USPS                          | Val  Loss: 0.0545 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1038 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1352 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.8499 | Val  Acc: 0.7424
 Site-SynthDigits                   | Val  Loss: 0.5634 | Val  Acc: 0.7626
 Site-MNIST_M                       | Val  Loss: 1.1658 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.1717 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 1.5285 | Val  Acc: 0.4589
Average Valid Accuracy: 0.8410
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9632
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9684
 Best site-USPS                      | Epoch:44 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9679
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9530
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.7424
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.7626
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.6250
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.5455
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.4589
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.1302 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.1207 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.1162 | Train Acc: 0.9606
 Site-MNIST                         | Train Loss: 0.0889 | Train Acc: 0.9777
 Site-MNIST                         | Train Loss: 0.0656 | Train Acc: 0.9877
 Site-USPS                          | Train Loss: 0.1198 | Train Acc: 0.9664
 Site-USPS                          | Train Loss: 0.0789 | Train Acc: 0.9824
 Site-USPS                          | Train Loss: 0.0922 | Train Acc: 0.9755
 Site-SynthDigits                   | Train Loss: 0.6970 | Train Acc: 0.7689
 Site-SynthDigits                   | Train Loss: 0.5965 | Train Acc: 0.8169
 Site-MNIST_M                       | Train Loss: 1.2244 | Train Acc: 0.5767
 Site-MNIST_M                       | Train Loss: 1.1587 | Train Acc: 0.5852
 Site-SVHN                          | Train Loss: 1.4594 | Train Acc: 0.5162
Average Train Accuracy: 0.8495
 Site-MNIST                         | Val  Loss: 0.0705 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0696 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.1018 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1434 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.1348 | Val  Acc: 0.9614
 Site-USPS                          | Val  Loss: 0.0525 | Val  Acc: 0.9904
 Site-USPS                          | Val  Loss: 0.0995 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1317 | Val  Acc: 0.9530
 Site-SynthDigits                   | Val  Loss: 0.8484 | Val  Acc: 0.7348
 Site-SynthDigits                   | Val  Loss: 0.5671 | Val  Acc: 0.7677
 Site-MNIST_M                       | Val  Loss: 1.1792 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.1550 | Val  Acc: 0.5379
 Site-SVHN                          | Val  Loss: 1.5371 | Val  Acc: 0.4658
Average Valid Accuracy: 0.8402
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.1233 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.1156 | Train Acc: 0.9704
 Site-MNIST                         | Train Loss: 0.1141 | Train Acc: 0.9625
 Site-MNIST                         | Train Loss: 0.0860 | Train Acc: 0.9829
 Site-MNIST                         | Train Loss: 0.0620 | Train Acc: 0.9886
 Site-USPS                          | Train Loss: 0.1168 | Train Acc: 0.9664
 Site-USPS                          | Train Loss: 0.0774 | Train Acc: 0.9824
 Site-USPS                          | Train Loss: 0.0910 | Train Acc: 0.9755
 Site-SynthDigits                   | Train Loss: 0.7366 | Train Acc: 0.7652
 Site-SynthDigits                   | Train Loss: 0.5982 | Train Acc: 0.8106
 Site-MNIST_M                       | Train Loss: 1.2274 | Train Acc: 0.5966
 Site-MNIST_M                       | Train Loss: 1.1339 | Train Acc: 0.5814
 Site-SVHN                          | Train Loss: 1.4544 | Train Acc: 0.5145
Average Train Accuracy: 0.8509
 Site-MNIST                         | Val  Loss: 0.0698 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0677 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.0974 | Val  Acc: 0.9683
 Site-MNIST                         | Val  Loss: 0.1425 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.1356 | Val  Acc: 0.9684
 Site-USPS                          | Val  Loss: 0.0526 | Val  Acc: 0.9904
 Site-USPS                          | Val  Loss: 0.1013 | Val  Acc: 0.9679
 Site-USPS                          | Val  Loss: 0.1314 | Val  Acc: 0.9573
 Site-SynthDigits                   | Val  Loss: 0.8424 | Val  Acc: 0.7348
 Site-SynthDigits                   | Val  Loss: 0.5652 | Val  Acc: 0.7576
 Site-MNIST_M                       | Val  Loss: 1.1630 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.1482 | Val  Acc: 0.5758
 Site-SVHN                          | Val  Loss: 1.5136 | Val  Acc: 0.4452
Average Valid Accuracy: 0.8399
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.1300 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.1176 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.1106 | Train Acc: 0.9645
 Site-MNIST                         | Train Loss: 0.0849 | Train Acc: 0.9803
 Site-MNIST                         | Train Loss: 0.0640 | Train Acc: 0.9904
 Site-USPS                          | Train Loss: 0.1079 | Train Acc: 0.9712
 Site-USPS                          | Train Loss: 0.0791 | Train Acc: 0.9808
 Site-USPS                          | Train Loss: 0.0828 | Train Acc: 0.9798
 Site-SynthDigits                   | Train Loss: 0.7271 | Train Acc: 0.7519
 Site-SynthDigits                   | Train Loss: 0.6114 | Train Acc: 0.8207
 Site-MNIST_M                       | Train Loss: 1.2184 | Train Acc: 0.5909
 Site-MNIST_M                       | Train Loss: 1.1476 | Train Acc: 0.5701
 Site-SVHN                          | Train Loss: 1.4496 | Train Acc: 0.5281
Average Train Accuracy: 0.8506
 Site-MNIST                         | Val  Loss: 0.0666 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0636 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.0959 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1377 | Val  Acc: 0.9632
 Site-MNIST                         | Val  Loss: 0.1339 | Val  Acc: 0.9649
 Site-USPS                          | Val  Loss: 0.0496 | Val  Acc: 0.9904
 Site-USPS                          | Val  Loss: 0.0982 | Val  Acc: 0.9744
 Site-USPS                          | Val  Loss: 0.1267 | Val  Acc: 0.9573
 Site-SynthDigits                   | Val  Loss: 0.8569 | Val  Acc: 0.7197
 Site-SynthDigits                   | Val  Loss: 0.5766 | Val  Acc: 0.7374
 Site-MNIST_M                       | Val  Loss: 1.1489 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.1378 | Val  Acc: 0.5606
 Site-SVHN                          | Val  Loss: 1.5133 | Val  Acc: 0.4589
Average Valid Accuracy: 0.8392
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.1441 | Train Acc: 0.9689
 Site-MNIST                         | Train Loss: 0.1144 | Train Acc: 0.9675
 Site-MNIST                         | Train Loss: 0.1088 | Train Acc: 0.9606
 Site-MNIST                         | Train Loss: 0.0840 | Train Acc: 0.9763
 Site-MNIST                         | Train Loss: 0.0639 | Train Acc: 0.9912
 Site-USPS                          | Train Loss: 0.1119 | Train Acc: 0.9712
 Site-USPS                          | Train Loss: 0.0774 | Train Acc: 0.9856
 Site-USPS                          | Train Loss: 0.0822 | Train Acc: 0.9830
 Site-SynthDigits                   | Train Loss: 0.7003 | Train Acc: 0.7633
 Site-SynthDigits                   | Train Loss: 0.5888 | Train Acc: 0.8093
 Site-MNIST_M                       | Train Loss: 1.2188 | Train Acc: 0.5852
 Site-MNIST_M                       | Train Loss: 1.1568 | Train Acc: 0.5852
 Site-SVHN                          | Train Loss: 1.4219 | Train Acc: 0.5230
Average Train Accuracy: 0.8516
 Site-MNIST                         | Val  Loss: 0.0651 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0608 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.0908 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1374 | Val  Acc: 0.9684
 Site-MNIST                         | Val  Loss: 0.1377 | Val  Acc: 0.9649
 Site-USPS                          | Val  Loss: 0.0482 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0994 | Val  Acc: 0.9744
 Site-USPS                          | Val  Loss: 0.1287 | Val  Acc: 0.9615
 Site-SynthDigits                   | Val  Loss: 0.8655 | Val  Acc: 0.7273
 Site-SynthDigits                   | Val  Loss: 0.5694 | Val  Acc: 0.7525
 Site-MNIST_M                       | Val  Loss: 1.1573 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.1460 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 1.5153 | Val  Acc: 0.4452
Average Valid Accuracy: 0.8411
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9684
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9649
 Best site-USPS                      | Epoch:48 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9744
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9615
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.7273
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.7525
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.6477
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.5455
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.4452
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.1270 | Train Acc: 0.9644
 Site-MNIST                         | Train Loss: 0.1087 | Train Acc: 0.9586
 Site-MNIST                         | Train Loss: 0.1054 | Train Acc: 0.9606
 Site-MNIST                         | Train Loss: 0.0811 | Train Acc: 0.9842
 Site-MNIST                         | Train Loss: 0.0634 | Train Acc: 0.9895
 Site-USPS                          | Train Loss: 0.1008 | Train Acc: 0.9712
 Site-USPS                          | Train Loss: 0.0763 | Train Acc: 0.9840
 Site-USPS                          | Train Loss: 0.0837 | Train Acc: 0.9819
 Site-SynthDigits                   | Train Loss: 0.7146 | Train Acc: 0.7670
 Site-SynthDigits                   | Train Loss: 0.5927 | Train Acc: 0.8056
 Site-MNIST_M                       | Train Loss: 1.2146 | Train Acc: 0.5852
 Site-MNIST_M                       | Train Loss: 1.0920 | Train Acc: 0.5909
 Site-SVHN                          | Train Loss: 1.4300 | Train Acc: 0.5264
Average Train Accuracy: 0.8515
 Site-MNIST                         | Val  Loss: 0.0603 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0543 | Val  Acc: 0.9881
 Site-MNIST                         | Val  Loss: 0.0906 | Val  Acc: 0.9762
 Site-MNIST                         | Val  Loss: 0.1390 | Val  Acc: 0.9579
 Site-MNIST                         | Val  Loss: 0.1310 | Val  Acc: 0.9544
 Site-USPS                          | Val  Loss: 0.0497 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.0932 | Val  Acc: 0.9744
 Site-USPS                          | Val  Loss: 0.1245 | Val  Acc: 0.9573
 Site-SynthDigits                   | Val  Loss: 0.8739 | Val  Acc: 0.7348
 Site-SynthDigits                   | Val  Loss: 0.5715 | Val  Acc: 0.7576
 Site-MNIST_M                       | Val  Loss: 1.1522 | Val  Acc: 0.6591
 Site-MNIST_M                       | Val  Loss: 1.1597 | Val  Acc: 0.5530
 Site-SVHN                          | Val  Loss: 1.4999 | Val  Acc: 0.4589
Average Valid Accuracy: 0.8426
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9881
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9762
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9579
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9544
 Best site-USPS                      | Epoch:49 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:49 | Val Acc: 0.9744
 Best site-USPS                      | Epoch:49 | Val Acc: 0.9573
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.7348
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.7576
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.6591
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.5530
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.4589
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/harmo-fl...
===2023-07-28 00:42:21===
===2023-07-28 00:42:37===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.9454
 Test site-USPS                      | Epoch:49 | Test Acc: 0.9495
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.7152
 Test site-MNIST_M                   | Epoch:49 | Test Acc: 0.4856
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.3694
MNIST: 0.9454, USPS: 0.9495, SynthDigits: 0.7152, MNIST_M: 0.4856, SVHN: 0.3694, 
Average Test Accuracy(group): 0.6930, Average Test Accuracy(individual): 0.7959,
domain std=0.2357, cluster std=-1.0000, individual std=0.2094, 
