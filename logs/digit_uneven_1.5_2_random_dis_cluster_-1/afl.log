===2023-07-27 13:25:08===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 2.1152 | Train Acc: 0.5333
 Site-MNIST                         | Train Loss: 2.1202 | Train Acc: 0.4941
 Site-MNIST                         | Train Loss: 2.1353 | Train Acc: 0.5069
 Site-MNIST                         | Train Loss: 2.1228 | Train Acc: 0.5085
 Site-MNIST                         | Train Loss: 2.1204 | Train Acc: 0.5236
 Site-USPS                          | Train Loss: 2.0922 | Train Acc: 0.6235
 Site-USPS                          | Train Loss: 2.1032 | Train Acc: 0.6182
 Site-USPS                          | Train Loss: 2.0878 | Train Acc: 0.6305
 Site-SynthDigits                   | Train Loss: 2.2536 | Train Acc: 0.2083
 Site-SynthDigits                   | Train Loss: 2.2436 | Train Acc: 0.2298
 Site-MNIST_M                       | Train Loss: 2.2787 | Train Acc: 0.1932
 Site-MNIST_M                       | Train Loss: 2.2852 | Train Acc: 0.1364
 Site-SVHN                          | Train Loss: 2.2807 | Train Acc: 0.1567
Average Train Accuracy: 0.4125
 Site-MNIST                         | Val  Loss: 2.1504 | Val  Acc: 0.4643
 Site-MNIST                         | Val  Loss: 2.1633 | Val  Acc: 0.4762
 Site-MNIST                         | Val  Loss: 2.1265 | Val  Acc: 0.5317
 Site-MNIST                         | Val  Loss: 2.1291 | Val  Acc: 0.5105
 Site-MNIST                         | Val  Loss: 2.1275 | Val  Acc: 0.4842
 Site-USPS                          | Val  Loss: 2.1094 | Val  Acc: 0.6154
 Site-USPS                          | Val  Loss: 2.1103 | Val  Acc: 0.5897
 Site-USPS                          | Val  Loss: 2.0907 | Val  Acc: 0.6538
 Site-SynthDigits                   | Val  Loss: 2.2589 | Val  Acc: 0.2045
 Site-SynthDigits                   | Val  Loss: 2.2495 | Val  Acc: 0.2121
 Site-MNIST_M                       | Val  Loss: 2.2839 | Val  Acc: 0.2045
 Site-MNIST_M                       | Val  Loss: 2.2653 | Val  Acc: 0.1818
 Site-SVHN                          | Val  Loss: 2.2871 | Val  Acc: 0.1507
Average Valid Accuracy: 0.4061
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4643
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4762
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5317
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5105
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.4842
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6154
 Best site-USPS                      | Epoch:0 | Val Acc: 0.5897
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6538
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2045
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2121
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.2045
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1818
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1507
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 1.9365 | Train Acc: 0.5911
 Site-MNIST                         | Train Loss: 1.9574 | Train Acc: 0.5680
 Site-MNIST                         | Train Loss: 1.9756 | Train Acc: 0.5404
 Site-MNIST                         | Train Loss: 1.9501 | Train Acc: 0.5493
 Site-MNIST                         | Train Loss: 1.9477 | Train Acc: 0.5692
 Site-USPS                          | Train Loss: 1.8896 | Train Acc: 0.6691
 Site-USPS                          | Train Loss: 1.8966 | Train Acc: 0.6821
 Site-USPS                          | Train Loss: 1.8739 | Train Acc: 0.7284
 Site-SynthDigits                   | Train Loss: 2.1962 | Train Acc: 0.2614
 Site-SynthDigits                   | Train Loss: 2.1783 | Train Acc: 0.3005
 Site-MNIST_M                       | Train Loss: 2.2506 | Train Acc: 0.2472
 Site-MNIST_M                       | Train Loss: 2.2595 | Train Acc: 0.1970
 Site-SVHN                          | Train Loss: 2.2594 | Train Acc: 0.1976
Average Train Accuracy: 0.4693
 Site-MNIST                         | Val  Loss: 1.9819 | Val  Acc: 0.5536
 Site-MNIST                         | Val  Loss: 2.0062 | Val  Acc: 0.5476
 Site-MNIST                         | Val  Loss: 1.9567 | Val  Acc: 0.5873
 Site-MNIST                         | Val  Loss: 1.9708 | Val  Acc: 0.5474
 Site-MNIST                         | Val  Loss: 1.9628 | Val  Acc: 0.5509
 Site-USPS                          | Val  Loss: 1.9186 | Val  Acc: 0.6731
 Site-USPS                          | Val  Loss: 1.9203 | Val  Acc: 0.6731
 Site-USPS                          | Val  Loss: 1.8834 | Val  Acc: 0.6752
 Site-SynthDigits                   | Val  Loss: 2.2206 | Val  Acc: 0.2500
 Site-SynthDigits                   | Val  Loss: 2.1900 | Val  Acc: 0.2626
 Site-MNIST_M                       | Val  Loss: 2.2482 | Val  Acc: 0.3068
 Site-MNIST_M                       | Val  Loss: 2.2360 | Val  Acc: 0.2500
 Site-SVHN                          | Val  Loss: 2.2705 | Val  Acc: 0.1849
Average Valid Accuracy: 0.4663
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5536
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5476
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5873
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5474
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.5509
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6731
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6731
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6752
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2500
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2626
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.3068
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2500
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 1.7894 | Train Acc: 0.6622
 Site-MNIST                         | Train Loss: 1.8167 | Train Acc: 0.6509
 Site-MNIST                         | Train Loss: 1.8321 | Train Acc: 0.5957
 Site-MNIST                         | Train Loss: 1.7986 | Train Acc: 0.6294
 Site-MNIST                         | Train Loss: 1.7960 | Train Acc: 0.6401
 Site-USPS                          | Train Loss: 1.7181 | Train Acc: 0.6978
 Site-USPS                          | Train Loss: 1.7182 | Train Acc: 0.7173
 Site-USPS                          | Train Loss: 1.6923 | Train Acc: 0.7551
 Site-SynthDigits                   | Train Loss: 2.1250 | Train Acc: 0.3087
 Site-SynthDigits                   | Train Loss: 2.1070 | Train Acc: 0.3523
 Site-MNIST_M                       | Train Loss: 2.2195 | Train Acc: 0.3068
 Site-MNIST_M                       | Train Loss: 2.2215 | Train Acc: 0.2008
 Site-SVHN                          | Train Loss: 2.2405 | Train Acc: 0.2470
Average Train Accuracy: 0.5203
 Site-MNIST                         | Val  Loss: 1.8339 | Val  Acc: 0.6071
 Site-MNIST                         | Val  Loss: 1.8591 | Val  Acc: 0.5952
 Site-MNIST                         | Val  Loss: 1.8050 | Val  Acc: 0.6190
 Site-MNIST                         | Val  Loss: 1.8283 | Val  Acc: 0.6000
 Site-MNIST                         | Val  Loss: 1.8144 | Val  Acc: 0.6281
 Site-USPS                          | Val  Loss: 1.7552 | Val  Acc: 0.7019
 Site-USPS                          | Val  Loss: 1.7550 | Val  Acc: 0.6795
 Site-USPS                          | Val  Loss: 1.7046 | Val  Acc: 0.7094
 Site-SynthDigits                   | Val  Loss: 2.1720 | Val  Acc: 0.3106
 Site-SynthDigits                   | Val  Loss: 2.1304 | Val  Acc: 0.2828
 Site-MNIST_M                       | Val  Loss: 2.2130 | Val  Acc: 0.3182
 Site-MNIST_M                       | Val  Loss: 2.1994 | Val  Acc: 0.3106
 Site-SVHN                          | Val  Loss: 2.2499 | Val  Acc: 0.2260
Average Valid Accuracy: 0.5068
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6071
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5952
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6190
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6000
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6281
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7019
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6795
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7094
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3106
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.2828
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.3182
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.3106
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2260
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 1.6437 | Train Acc: 0.7289
 Site-MNIST                         | Train Loss: 1.6727 | Train Acc: 0.7071
 Site-MNIST                         | Train Loss: 1.7047 | Train Acc: 0.6469
 Site-MNIST                         | Train Loss: 1.6623 | Train Acc: 0.7004
 Site-MNIST                         | Train Loss: 1.6609 | Train Acc: 0.7102
 Site-USPS                          | Train Loss: 1.5582 | Train Acc: 0.7194
 Site-USPS                          | Train Loss: 1.5683 | Train Acc: 0.7476
 Site-USPS                          | Train Loss: 1.5377 | Train Acc: 0.7668
 Site-SynthDigits                   | Train Loss: 2.0724 | Train Acc: 0.3504
 Site-SynthDigits                   | Train Loss: 2.0490 | Train Acc: 0.4003
 Site-MNIST_M                       | Train Loss: 2.1904 | Train Acc: 0.2983
 Site-MNIST_M                       | Train Loss: 2.2019 | Train Acc: 0.2330
 Site-SVHN                          | Train Loss: 2.2102 | Train Acc: 0.2726
Average Train Accuracy: 0.5601
 Site-MNIST                         | Val  Loss: 1.7019 | Val  Acc: 0.6786
 Site-MNIST                         | Val  Loss: 1.7214 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.6645 | Val  Acc: 0.6905
 Site-MNIST                         | Val  Loss: 1.6997 | Val  Acc: 0.6474
 Site-MNIST                         | Val  Loss: 1.6850 | Val  Acc: 0.6842
 Site-USPS                          | Val  Loss: 1.6107 | Val  Acc: 0.7019
 Site-USPS                          | Val  Loss: 1.6074 | Val  Acc: 0.6923
 Site-USPS                          | Val  Loss: 1.5549 | Val  Acc: 0.7222
 Site-SynthDigits                   | Val  Loss: 2.1270 | Val  Acc: 0.3409
 Site-SynthDigits                   | Val  Loss: 2.0783 | Val  Acc: 0.3131
 Site-MNIST_M                       | Val  Loss: 2.1778 | Val  Acc: 0.3182
 Site-MNIST_M                       | Val  Loss: 2.1667 | Val  Acc: 0.2955
 Site-SVHN                          | Val  Loss: 2.2283 | Val  Acc: 0.2466
Average Valid Accuracy: 0.5383
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6786
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6905
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6474
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.6842
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7019
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6923
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7222
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3409
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3131
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.3182
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2955
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2466
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 1.5175 | Train Acc: 0.7467
 Site-MNIST                         | Train Loss: 1.5351 | Train Acc: 0.7337
 Site-MNIST                         | Train Loss: 1.5854 | Train Acc: 0.6963
 Site-MNIST                         | Train Loss: 1.5392 | Train Acc: 0.7175
 Site-MNIST                         | Train Loss: 1.5352 | Train Acc: 0.7320
 Site-USPS                          | Train Loss: 1.4421 | Train Acc: 0.7266
 Site-USPS                          | Train Loss: 1.4319 | Train Acc: 0.7572
 Site-USPS                          | Train Loss: 1.3988 | Train Acc: 0.7838
 Site-SynthDigits                   | Train Loss: 2.0168 | Train Acc: 0.3807
 Site-SynthDigits                   | Train Loss: 1.9822 | Train Acc: 0.4318
 Site-MNIST_M                       | Train Loss: 2.1677 | Train Acc: 0.3267
 Site-MNIST_M                       | Train Loss: 2.1786 | Train Acc: 0.2595
 Site-SVHN                          | Train Loss: 2.1988 | Train Acc: 0.2709
Average Train Accuracy: 0.5818
 Site-MNIST                         | Val  Loss: 1.5698 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.5855 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.5375 | Val  Acc: 0.7460
 Site-MNIST                         | Val  Loss: 1.5804 | Val  Acc: 0.6895
 Site-MNIST                         | Val  Loss: 1.5633 | Val  Acc: 0.7123
 Site-USPS                          | Val  Loss: 1.4718 | Val  Acc: 0.7212
 Site-USPS                          | Val  Loss: 1.4694 | Val  Acc: 0.6987
 Site-USPS                          | Val  Loss: 1.4194 | Val  Acc: 0.7479
 Site-SynthDigits                   | Val  Loss: 2.0834 | Val  Acc: 0.3864
 Site-SynthDigits                   | Val  Loss: 2.0221 | Val  Acc: 0.3636
 Site-MNIST_M                       | Val  Loss: 2.1408 | Val  Acc: 0.3409
 Site-MNIST_M                       | Val  Loss: 2.1358 | Val  Acc: 0.3258
 Site-SVHN                          | Val  Loss: 2.2057 | Val  Acc: 0.2466
Average Valid Accuracy: 0.5753
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7500
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7460
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.6895
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7123
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7212
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6987
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7479
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3864
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3636
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3409
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.3258
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2466
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 1.4285 | Train Acc: 0.7244
 Site-MNIST                         | Train Loss: 1.4788 | Train Acc: 0.7367
 Site-MNIST                         | Train Loss: 1.5099 | Train Acc: 0.6844
 Site-MNIST                         | Train Loss: 1.4683 | Train Acc: 0.6912
 Site-MNIST                         | Train Loss: 1.4611 | Train Acc: 0.7128
 Site-USPS                          | Train Loss: 1.3928 | Train Acc: 0.7050
 Site-USPS                          | Train Loss: 1.3679 | Train Acc: 0.7428
 Site-USPS                          | Train Loss: 1.3460 | Train Acc: 0.7583
 Site-SynthDigits                   | Train Loss: 1.9491 | Train Acc: 0.4205
 Site-SynthDigits                   | Train Loss: 1.9178 | Train Acc: 0.4571
 Site-MNIST_M                       | Train Loss: 2.1274 | Train Acc: 0.3381
 Site-MNIST_M                       | Train Loss: 2.1485 | Train Acc: 0.2822
 Site-SVHN                          | Train Loss: 2.1683 | Train Acc: 0.2794
Average Train Accuracy: 0.5794
 Site-MNIST                         | Val  Loss: 1.4902 | Val  Acc: 0.7679
 Site-MNIST                         | Val  Loss: 1.5074 | Val  Acc: 0.7262
 Site-MNIST                         | Val  Loss: 1.4654 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.5156 | Val  Acc: 0.6526
 Site-MNIST                         | Val  Loss: 1.4873 | Val  Acc: 0.7228
 Site-USPS                          | Val  Loss: 1.4118 | Val  Acc: 0.7308
 Site-USPS                          | Val  Loss: 1.4097 | Val  Acc: 0.6987
 Site-USPS                          | Val  Loss: 1.3682 | Val  Acc: 0.7179
 Site-SynthDigits                   | Val  Loss: 2.0417 | Val  Acc: 0.4318
 Site-SynthDigits                   | Val  Loss: 1.9539 | Val  Acc: 0.4141
 Site-MNIST_M                       | Val  Loss: 2.0965 | Val  Acc: 0.3295
 Site-MNIST_M                       | Val  Loss: 2.1048 | Val  Acc: 0.3485
 Site-SVHN                          | Val  Loss: 2.1911 | Val  Acc: 0.2534
Average Valid Accuracy: 0.5739
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 1.3443 | Train Acc: 0.7689
 Site-MNIST                         | Train Loss: 1.3950 | Train Acc: 0.7692
 Site-MNIST                         | Train Loss: 1.4174 | Train Acc: 0.7081
 Site-MNIST                         | Train Loss: 1.3684 | Train Acc: 0.7385
 Site-MNIST                         | Train Loss: 1.3643 | Train Acc: 0.7426
 Site-USPS                          | Train Loss: 1.2817 | Train Acc: 0.7242
 Site-USPS                          | Train Loss: 1.2689 | Train Acc: 0.7572
 Site-USPS                          | Train Loss: 1.2437 | Train Acc: 0.7614
 Site-SynthDigits                   | Train Loss: 1.9012 | Train Acc: 0.4527
 Site-SynthDigits                   | Train Loss: 1.8577 | Train Acc: 0.4912
 Site-MNIST_M                       | Train Loss: 2.0877 | Train Acc: 0.3778
 Site-MNIST_M                       | Train Loss: 2.1177 | Train Acc: 0.2936
 Site-SVHN                          | Train Loss: 2.1603 | Train Acc: 0.2896
Average Train Accuracy: 0.6058
 Site-MNIST                         | Val  Loss: 1.3876 | Val  Acc: 0.7857
 Site-MNIST                         | Val  Loss: 1.4055 | Val  Acc: 0.7381
 Site-MNIST                         | Val  Loss: 1.3678 | Val  Acc: 0.7063
 Site-MNIST                         | Val  Loss: 1.4206 | Val  Acc: 0.7000
 Site-MNIST                         | Val  Loss: 1.3900 | Val  Acc: 0.7544
 Site-USPS                          | Val  Loss: 1.3116 | Val  Acc: 0.7212
 Site-USPS                          | Val  Loss: 1.3115 | Val  Acc: 0.7244
 Site-USPS                          | Val  Loss: 1.2704 | Val  Acc: 0.7265
 Site-SynthDigits                   | Val  Loss: 1.9901 | Val  Acc: 0.4470
 Site-SynthDigits                   | Val  Loss: 1.8880 | Val  Acc: 0.4293
 Site-MNIST_M                       | Val  Loss: 2.0472 | Val  Acc: 0.4432
 Site-MNIST_M                       | Val  Loss: 2.0701 | Val  Acc: 0.3788
 Site-SVHN                          | Val  Loss: 2.1709 | Val  Acc: 0.2603
Average Valid Accuracy: 0.6012
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7857
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7381
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7063
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7000
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7544
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7212
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7244
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7265
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4470
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4293
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.4432
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3788
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2603
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 1.2610 | Train Acc: 0.7733
 Site-MNIST                         | Train Loss: 1.3133 | Train Acc: 0.7663
 Site-MNIST                         | Train Loss: 1.3491 | Train Acc: 0.7101
 Site-MNIST                         | Train Loss: 1.2973 | Train Acc: 0.7372
 Site-MNIST                         | Train Loss: 1.2922 | Train Acc: 0.7443
 Site-USPS                          | Train Loss: 1.2611 | Train Acc: 0.7098
 Site-USPS                          | Train Loss: 1.2170 | Train Acc: 0.7428
 Site-USPS                          | Train Loss: 1.2017 | Train Acc: 0.7476
 Site-SynthDigits                   | Train Loss: 1.8352 | Train Acc: 0.4621
 Site-SynthDigits                   | Train Loss: 1.7974 | Train Acc: 0.5088
 Site-MNIST_M                       | Train Loss: 2.0529 | Train Acc: 0.3778
 Site-MNIST_M                       | Train Loss: 2.0986 | Train Acc: 0.3106
 Site-SVHN                          | Train Loss: 2.1363 | Train Acc: 0.2913
Average Train Accuracy: 0.6063
 Site-MNIST                         | Val  Loss: 1.3170 | Val  Acc: 0.7679
 Site-MNIST                         | Val  Loss: 1.3372 | Val  Acc: 0.7262
 Site-MNIST                         | Val  Loss: 1.2973 | Val  Acc: 0.7222
 Site-MNIST                         | Val  Loss: 1.3508 | Val  Acc: 0.7000
 Site-MNIST                         | Val  Loss: 1.3198 | Val  Acc: 0.7544
 Site-USPS                          | Val  Loss: 1.2570 | Val  Acc: 0.7115
 Site-USPS                          | Val  Loss: 1.2608 | Val  Acc: 0.7115
 Site-USPS                          | Val  Loss: 1.2322 | Val  Acc: 0.7222
 Site-SynthDigits                   | Val  Loss: 1.9419 | Val  Acc: 0.4621
 Site-SynthDigits                   | Val  Loss: 1.8111 | Val  Acc: 0.4596
 Site-MNIST_M                       | Val  Loss: 2.0027 | Val  Acc: 0.4432
 Site-MNIST_M                       | Val  Loss: 2.0433 | Val  Acc: 0.3864
 Site-SVHN                          | Val  Loss: 2.1557 | Val  Acc: 0.2603
Average Valid Accuracy: 0.6021
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7679
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7262
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7222
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7000
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7544
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7115
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7115
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7222
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4621
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4596
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.4432
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3864
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.2603
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 1.1648 | Train Acc: 0.7867
 Site-MNIST                         | Train Loss: 1.2007 | Train Acc: 0.7840
 Site-MNIST                         | Train Loss: 1.2665 | Train Acc: 0.7594
 Site-MNIST                         | Train Loss: 1.2099 | Train Acc: 0.7740
 Site-MNIST                         | Train Loss: 1.2072 | Train Acc: 0.7741
 Site-USPS                          | Train Loss: 1.1770 | Train Acc: 0.7386
 Site-USPS                          | Train Loss: 1.1394 | Train Acc: 0.7572
 Site-USPS                          | Train Loss: 1.1189 | Train Acc: 0.7540
 Site-SynthDigits                   | Train Loss: 1.7908 | Train Acc: 0.4848
 Site-SynthDigits                   | Train Loss: 1.7516 | Train Acc: 0.5265
 Site-MNIST_M                       | Train Loss: 2.0267 | Train Acc: 0.4034
 Site-MNIST_M                       | Train Loss: 2.0687 | Train Acc: 0.3352
 Site-SVHN                          | Train Loss: 2.1018 | Train Acc: 0.2862
Average Train Accuracy: 0.6280
 Site-MNIST                         | Val  Loss: 1.2255 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 1.2407 | Val  Acc: 0.7976
 Site-MNIST                         | Val  Loss: 1.2093 | Val  Acc: 0.7698
 Site-MNIST                         | Val  Loss: 1.2629 | Val  Acc: 0.7632
 Site-MNIST                         | Val  Loss: 1.2351 | Val  Acc: 0.7719
 Site-USPS                          | Val  Loss: 1.1763 | Val  Acc: 0.7308
 Site-USPS                          | Val  Loss: 1.1789 | Val  Acc: 0.7308
 Site-USPS                          | Val  Loss: 1.1491 | Val  Acc: 0.7393
 Site-SynthDigits                   | Val  Loss: 1.8924 | Val  Acc: 0.4848
 Site-SynthDigits                   | Val  Loss: 1.7682 | Val  Acc: 0.4798
 Site-MNIST_M                       | Val  Loss: 1.9651 | Val  Acc: 0.4545
 Site-MNIST_M                       | Val  Loss: 1.9961 | Val  Acc: 0.3939
 Site-SVHN                          | Val  Loss: 2.1370 | Val  Acc: 0.2466
Average Valid Accuracy: 0.6310
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8393
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7976
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7698
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7632
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7719
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7308
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7308
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7393
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4848
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4798
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.4545
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3939
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.2466
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 1.0916 | Train Acc: 0.7956
 Site-MNIST                         | Train Loss: 1.1911 | Train Acc: 0.7959
 Site-MNIST                         | Train Loss: 1.2031 | Train Acc: 0.7692
 Site-MNIST                         | Train Loss: 1.1411 | Train Acc: 0.7858
 Site-MNIST                         | Train Loss: 1.1401 | Train Acc: 0.7933
 Site-USPS                          | Train Loss: 1.1269 | Train Acc: 0.7386
 Site-USPS                          | Train Loss: 1.0778 | Train Acc: 0.7716
 Site-USPS                          | Train Loss: 1.0622 | Train Acc: 0.7753
 Site-SynthDigits                   | Train Loss: 1.7079 | Train Acc: 0.5057
 Site-SynthDigits                   | Train Loss: 1.6928 | Train Acc: 0.5556
 Site-MNIST_M                       | Train Loss: 1.9799 | Train Acc: 0.4176
 Site-MNIST_M                       | Train Loss: 2.0428 | Train Acc: 0.3466
 Site-SVHN                          | Train Loss: 2.0872 | Train Acc: 0.2947
Average Train Accuracy: 0.6420
 Site-MNIST                         | Val  Loss: 1.1594 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 1.1711 | Val  Acc: 0.8095
 Site-MNIST                         | Val  Loss: 1.1433 | Val  Acc: 0.7937
 Site-MNIST                         | Val  Loss: 1.1947 | Val  Acc: 0.7684
 Site-MNIST                         | Val  Loss: 1.1696 | Val  Acc: 0.7860
 Site-USPS                          | Val  Loss: 1.1087 | Val  Acc: 0.7596
 Site-USPS                          | Val  Loss: 1.1113 | Val  Acc: 0.7372
 Site-USPS                          | Val  Loss: 1.0869 | Val  Acc: 0.7393
 Site-SynthDigits                   | Val  Loss: 1.8437 | Val  Acc: 0.4848
 Site-SynthDigits                   | Val  Loss: 1.6868 | Val  Acc: 0.4798
 Site-MNIST_M                       | Val  Loss: 1.9115 | Val  Acc: 0.4659
 Site-MNIST_M                       | Val  Loss: 1.9783 | Val  Acc: 0.4091
 Site-SVHN                          | Val  Loss: 2.1202 | Val  Acc: 0.2671
Average Valid Accuracy: 0.6401
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8095
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7937
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7684
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7860
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7596
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7372
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7393
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4848
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4798
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.4659
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.4091
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.2671
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 1.1109 | Train Acc: 0.7733
 Site-MNIST                         | Train Loss: 1.1546 | Train Acc: 0.7692
 Site-MNIST                         | Train Loss: 1.2031 | Train Acc: 0.7179
 Site-MNIST                         | Train Loss: 1.1421 | Train Acc: 0.7451
 Site-MNIST                         | Train Loss: 1.1404 | Train Acc: 0.7636
 Site-USPS                          | Train Loss: 1.1115 | Train Acc: 0.7218
 Site-USPS                          | Train Loss: 1.0790 | Train Acc: 0.7652
 Site-USPS                          | Train Loss: 1.0703 | Train Acc: 0.7529
 Site-SynthDigits                   | Train Loss: 1.6847 | Train Acc: 0.5152
 Site-SynthDigits                   | Train Loss: 1.6426 | Train Acc: 0.5694
 Site-MNIST_M                       | Train Loss: 1.9563 | Train Acc: 0.4006
 Site-MNIST_M                       | Train Loss: 2.0133 | Train Acc: 0.3485
 Site-SVHN                          | Train Loss: 2.0548 | Train Acc: 0.2998
Average Train Accuracy: 0.6264
 Site-MNIST                         | Val  Loss: 1.1580 | Val  Acc: 0.7679
 Site-MNIST                         | Val  Loss: 1.1631 | Val  Acc: 0.7500
 Site-MNIST                         | Val  Loss: 1.1407 | Val  Acc: 0.7460
 Site-MNIST                         | Val  Loss: 1.2025 | Val  Acc: 0.7263
 Site-MNIST                         | Val  Loss: 1.1673 | Val  Acc: 0.7579
 Site-USPS                          | Val  Loss: 1.1195 | Val  Acc: 0.7692
 Site-USPS                          | Val  Loss: 1.1259 | Val  Acc: 0.7244
 Site-USPS                          | Val  Loss: 1.1034 | Val  Acc: 0.7137
 Site-SynthDigits                   | Val  Loss: 1.8194 | Val  Acc: 0.4924
 Site-SynthDigits                   | Val  Loss: 1.6321 | Val  Acc: 0.5051
 Site-MNIST_M                       | Val  Loss: 1.8620 | Val  Acc: 0.4545
 Site-MNIST_M                       | Val  Loss: 1.9539 | Val  Acc: 0.4015
 Site-SVHN                          | Val  Loss: 2.0863 | Val  Acc: 0.2808
Average Valid Accuracy: 0.6223
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 1.0267 | Train Acc: 0.7867
 Site-MNIST                         | Train Loss: 1.0497 | Train Acc: 0.7959
 Site-MNIST                         | Train Loss: 1.1183 | Train Acc: 0.7712
 Site-MNIST                         | Train Loss: 1.0573 | Train Acc: 0.7753
 Site-MNIST                         | Train Loss: 1.0583 | Train Acc: 0.8004
 Site-USPS                          | Train Loss: 1.0421 | Train Acc: 0.7482
 Site-USPS                          | Train Loss: 0.9980 | Train Acc: 0.7843
 Site-USPS                          | Train Loss: 0.9883 | Train Acc: 0.7806
 Site-SynthDigits                   | Train Loss: 1.6615 | Train Acc: 0.5322
 Site-SynthDigits                   | Train Loss: 1.6157 | Train Acc: 0.5707
 Site-MNIST_M                       | Train Loss: 1.9091 | Train Acc: 0.4347
 Site-MNIST_M                       | Train Loss: 1.9772 | Train Acc: 0.3750
 Site-SVHN                          | Train Loss: 2.0515 | Train Acc: 0.3101
Average Train Accuracy: 0.6512
 Site-MNIST                         | Val  Loss: 1.0678 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 1.0763 | Val  Acc: 0.7857
 Site-MNIST                         | Val  Loss: 1.0558 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 1.1086 | Val  Acc: 0.7632
 Site-MNIST                         | Val  Loss: 1.0820 | Val  Acc: 0.7895
 Site-USPS                          | Val  Loss: 1.0236 | Val  Acc: 0.7692
 Site-USPS                          | Val  Loss: 1.0358 | Val  Acc: 0.7628
 Site-USPS                          | Val  Loss: 1.0216 | Val  Acc: 0.7436
 Site-SynthDigits                   | Val  Loss: 1.7931 | Val  Acc: 0.5530
 Site-SynthDigits                   | Val  Loss: 1.6084 | Val  Acc: 0.5303
 Site-MNIST_M                       | Val  Loss: 1.8247 | Val  Acc: 0.4545
 Site-MNIST_M                       | Val  Loss: 1.9060 | Val  Acc: 0.4394
 Site-SVHN                          | Val  Loss: 2.0800 | Val  Acc: 0.2945
Average Valid Accuracy: 0.6513
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7857
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7632
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7895
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7692
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7628
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7436
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5530
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5303
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4545
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.4394
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.2945
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.9639 | Train Acc: 0.8133
 Site-MNIST                         | Train Loss: 0.9941 | Train Acc: 0.8018
 Site-MNIST                         | Train Loss: 1.0594 | Train Acc: 0.7791
 Site-MNIST                         | Train Loss: 0.9978 | Train Acc: 0.8003
 Site-MNIST                         | Train Loss: 0.9961 | Train Acc: 0.8187
 Site-USPS                          | Train Loss: 0.9695 | Train Acc: 0.7722
 Site-USPS                          | Train Loss: 0.9216 | Train Acc: 0.8067
 Site-USPS                          | Train Loss: 0.9164 | Train Acc: 0.8126
 Site-SynthDigits                   | Train Loss: 1.6126 | Train Acc: 0.5303
 Site-SynthDigits                   | Train Loss: 1.5660 | Train Acc: 0.5745
 Site-MNIST_M                       | Train Loss: 1.8977 | Train Acc: 0.4318
 Site-MNIST_M                       | Train Loss: 1.9929 | Train Acc: 0.3902
 Site-SVHN                          | Train Loss: 2.0445 | Train Acc: 0.3066
Average Train Accuracy: 0.6645
 Site-MNIST                         | Val  Loss: 1.0049 | Val  Acc: 0.7857
 Site-MNIST                         | Val  Loss: 1.0121 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.9971 | Val  Acc: 0.8175
 Site-MNIST                         | Val  Loss: 1.0463 | Val  Acc: 0.7842
 Site-MNIST                         | Val  Loss: 1.0247 | Val  Acc: 0.7965
 Site-USPS                          | Val  Loss: 0.9434 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.9617 | Val  Acc: 0.7692
 Site-USPS                          | Val  Loss: 0.9518 | Val  Acc: 0.7692
 Site-SynthDigits                   | Val  Loss: 1.7566 | Val  Acc: 0.5455
 Site-SynthDigits                   | Val  Loss: 1.5642 | Val  Acc: 0.5253
 Site-MNIST_M                       | Val  Loss: 1.7965 | Val  Acc: 0.4659
 Site-MNIST_M                       | Val  Loss: 1.8879 | Val  Acc: 0.4394
 Site-SVHN                          | Val  Loss: 2.0702 | Val  Acc: 0.2808
Average Valid Accuracy: 0.6622
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7857
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8175
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7842
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7965
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8077
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7692
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7692
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.5455
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.5253
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4659
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4394
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.2808
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.9471 | Train Acc: 0.8044
 Site-MNIST                         | Train Loss: 0.9470 | Train Acc: 0.7988
 Site-MNIST                         | Train Loss: 1.0309 | Train Acc: 0.7890
 Site-MNIST                         | Train Loss: 0.9692 | Train Acc: 0.7976
 Site-MNIST                         | Train Loss: 0.9684 | Train Acc: 0.8117
 Site-USPS                          | Train Loss: 0.9676 | Train Acc: 0.7578
 Site-USPS                          | Train Loss: 0.9241 | Train Acc: 0.7955
 Site-USPS                          | Train Loss: 0.9130 | Train Acc: 0.8009
 Site-SynthDigits                   | Train Loss: 1.5503 | Train Acc: 0.5398
 Site-SynthDigits                   | Train Loss: 1.5119 | Train Acc: 0.5871
 Site-MNIST_M                       | Train Loss: 1.8678 | Train Acc: 0.4517
 Site-MNIST_M                       | Train Loss: 1.9327 | Train Acc: 0.3788
 Site-SVHN                          | Train Loss: 1.9903 | Train Acc: 0.3186
Average Train Accuracy: 0.6640
 Site-MNIST                         | Val  Loss: 0.9776 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.9797 | Val  Acc: 0.8333
 Site-MNIST                         | Val  Loss: 0.9695 | Val  Acc: 0.8254
 Site-MNIST                         | Val  Loss: 1.0219 | Val  Acc: 0.7842
 Site-MNIST                         | Val  Loss: 0.9938 | Val  Acc: 0.7895
 Site-USPS                          | Val  Loss: 0.9474 | Val  Acc: 0.7788
 Site-USPS                          | Val  Loss: 0.9652 | Val  Acc: 0.7628
 Site-USPS                          | Val  Loss: 0.9545 | Val  Acc: 0.7350
 Site-SynthDigits                   | Val  Loss: 1.7273 | Val  Acc: 0.5379
 Site-SynthDigits                   | Val  Loss: 1.4955 | Val  Acc: 0.5404
 Site-MNIST_M                       | Val  Loss: 1.7506 | Val  Acc: 0.5227
 Site-MNIST_M                       | Val  Loss: 1.8553 | Val  Acc: 0.4697
 Site-SVHN                          | Val  Loss: 2.0362 | Val  Acc: 0.2945
Average Valid Accuracy: 0.6689
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8333
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8254
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7842
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7895
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7788
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7628
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7350
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5379
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5404
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.5227
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4697
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.2945
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.8893 | Train Acc: 0.8222
 Site-MNIST                         | Train Loss: 0.9464 | Train Acc: 0.8077
 Site-MNIST                         | Train Loss: 0.9933 | Train Acc: 0.7850
 Site-MNIST                         | Train Loss: 0.9313 | Train Acc: 0.8016
 Site-MNIST                         | Train Loss: 0.9278 | Train Acc: 0.8187
 Site-USPS                          | Train Loss: 0.9042 | Train Acc: 0.7866
 Site-USPS                          | Train Loss: 0.8654 | Train Acc: 0.8179
 Site-USPS                          | Train Loss: 0.8619 | Train Acc: 0.8190
 Site-SynthDigits                   | Train Loss: 1.5388 | Train Acc: 0.5511
 Site-SynthDigits                   | Train Loss: 1.4875 | Train Acc: 0.5884
 Site-MNIST_M                       | Train Loss: 1.8516 | Train Acc: 0.4631
 Site-MNIST_M                       | Train Loss: 1.9083 | Train Acc: 0.3958
 Site-SVHN                          | Train Loss: 1.9678 | Train Acc: 0.3305
Average Train Accuracy: 0.6760
 Site-MNIST                         | Val  Loss: 0.9366 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 0.9368 | Val  Acc: 0.8095
 Site-MNIST                         | Val  Loss: 0.9291 | Val  Acc: 0.8016
 Site-MNIST                         | Val  Loss: 0.9836 | Val  Acc: 0.7842
 Site-MNIST                         | Val  Loss: 0.9590 | Val  Acc: 0.7965
 Site-USPS                          | Val  Loss: 0.8793 | Val  Acc: 0.8173
 Site-USPS                          | Val  Loss: 0.9010 | Val  Acc: 0.7821
 Site-USPS                          | Val  Loss: 0.9028 | Val  Acc: 0.7650
 Site-SynthDigits                   | Val  Loss: 1.6958 | Val  Acc: 0.5682
 Site-SynthDigits                   | Val  Loss: 1.4590 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.7126 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.8371 | Val  Acc: 0.4848
 Site-SVHN                          | Val  Loss: 2.0292 | Val  Acc: 0.3014
Average Valid Accuracy: 0.6746
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8095
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8016
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7842
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7965
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8173
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7821
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7650
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5682
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4848
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.8521 | Train Acc: 0.8222
 Site-MNIST                         | Train Loss: 0.9228 | Train Acc: 0.8195
 Site-MNIST                         | Train Loss: 0.9426 | Train Acc: 0.7949
 Site-MNIST                         | Train Loss: 0.8809 | Train Acc: 0.8160
 Site-MNIST                         | Train Loss: 0.8774 | Train Acc: 0.8301
 Site-USPS                          | Train Loss: 0.8702 | Train Acc: 0.7962
 Site-USPS                          | Train Loss: 0.8299 | Train Acc: 0.8163
 Site-USPS                          | Train Loss: 0.8159 | Train Acc: 0.8253
 Site-SynthDigits                   | Train Loss: 1.4991 | Train Acc: 0.5549
 Site-SynthDigits                   | Train Loss: 1.4597 | Train Acc: 0.6023
 Site-MNIST_M                       | Train Loss: 1.8014 | Train Acc: 0.4688
 Site-MNIST_M                       | Train Loss: 1.8655 | Train Acc: 0.4205
 Site-SVHN                          | Train Loss: 1.9411 | Train Acc: 0.3305
Average Train Accuracy: 0.6844
 Site-MNIST                         | Val  Loss: 0.8787 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 0.8802 | Val  Acc: 0.8452
 Site-MNIST                         | Val  Loss: 0.8821 | Val  Acc: 0.8333
 Site-MNIST                         | Val  Loss: 0.9292 | Val  Acc: 0.8158
 Site-MNIST                         | Val  Loss: 0.9083 | Val  Acc: 0.8105
 Site-USPS                          | Val  Loss: 0.8330 | Val  Acc: 0.7981
 Site-USPS                          | Val  Loss: 0.8631 | Val  Acc: 0.7821
 Site-USPS                          | Val  Loss: 0.8635 | Val  Acc: 0.7735
 Site-SynthDigits                   | Val  Loss: 1.6735 | Val  Acc: 0.5606
 Site-SynthDigits                   | Val  Loss: 1.4089 | Val  Acc: 0.5606
 Site-MNIST_M                       | Val  Loss: 1.6690 | Val  Acc: 0.5568
 Site-MNIST_M                       | Val  Loss: 1.7974 | Val  Acc: 0.4848
 Site-SVHN                          | Val  Loss: 2.0094 | Val  Acc: 0.3014
Average Valid Accuracy: 0.6866
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8452
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8333
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8158
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8105
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7981
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7821
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7735
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.5606
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.5606
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.5568
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4848
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.8264 | Train Acc: 0.8356
 Site-MNIST                         | Train Loss: 0.8783 | Train Acc: 0.8107
 Site-MNIST                         | Train Loss: 0.9132 | Train Acc: 0.8028
 Site-MNIST                         | Train Loss: 0.8499 | Train Acc: 0.8173
 Site-MNIST                         | Train Loss: 0.8453 | Train Acc: 0.8327
 Site-USPS                          | Train Loss: 0.8494 | Train Acc: 0.8129
 Site-USPS                          | Train Loss: 0.7944 | Train Acc: 0.8243
 Site-USPS                          | Train Loss: 0.7855 | Train Acc: 0.8339
 Site-SynthDigits                   | Train Loss: 1.4625 | Train Acc: 0.5701
 Site-SynthDigits                   | Train Loss: 1.4328 | Train Acc: 0.6086
 Site-MNIST_M                       | Train Loss: 1.7723 | Train Acc: 0.4744
 Site-MNIST_M                       | Train Loss: 1.8588 | Train Acc: 0.4223
 Site-SVHN                          | Train Loss: 1.9421 | Train Acc: 0.3390
Average Train Accuracy: 0.6911
 Site-MNIST                         | Val  Loss: 0.8517 | Val  Acc: 0.7857
 Site-MNIST                         | Val  Loss: 0.8476 | Val  Acc: 0.8452
 Site-MNIST                         | Val  Loss: 0.8493 | Val  Acc: 0.8492
 Site-MNIST                         | Val  Loss: 0.8985 | Val  Acc: 0.8158
 Site-MNIST                         | Val  Loss: 0.8815 | Val  Acc: 0.8035
 Site-USPS                          | Val  Loss: 0.7948 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 0.8257 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.8312 | Val  Acc: 0.7991
 Site-SynthDigits                   | Val  Loss: 1.6442 | Val  Acc: 0.5758
 Site-SynthDigits                   | Val  Loss: 1.3761 | Val  Acc: 0.5808
 Site-MNIST_M                       | Val  Loss: 1.6304 | Val  Acc: 0.5682
 Site-MNIST_M                       | Val  Loss: 1.7943 | Val  Acc: 0.4697
 Site-SVHN                          | Val  Loss: 1.9974 | Val  Acc: 0.3014
Average Valid Accuracy: 0.6953
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7857
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8452
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8492
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8158
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8035
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8077
 Best site-USPS                      | Epoch:16 | Val Acc: 0.7991
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.5758
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.5808
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.5682
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.4697
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.7811 | Train Acc: 0.8400
 Site-MNIST                         | Train Loss: 0.8351 | Train Acc: 0.8254
 Site-MNIST                         | Train Loss: 0.8800 | Train Acc: 0.8008
 Site-MNIST                         | Train Loss: 0.8155 | Train Acc: 0.8147
 Site-MNIST                         | Train Loss: 0.8105 | Train Acc: 0.8354
 Site-USPS                          | Train Loss: 0.8035 | Train Acc: 0.8129
 Site-USPS                          | Train Loss: 0.7622 | Train Acc: 0.8307
 Site-USPS                          | Train Loss: 0.7599 | Train Acc: 0.8328
 Site-SynthDigits                   | Train Loss: 1.4605 | Train Acc: 0.5720
 Site-SynthDigits                   | Train Loss: 1.4035 | Train Acc: 0.6061
 Site-MNIST_M                       | Train Loss: 1.7527 | Train Acc: 0.4886
 Site-MNIST_M                       | Train Loss: 1.8255 | Train Acc: 0.4242
 Site-SVHN                          | Train Loss: 1.9075 | Train Acc: 0.3475
Average Train Accuracy: 0.6947
 Site-MNIST                         | Val  Loss: 0.8096 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 0.8079 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.8172 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.8637 | Val  Acc: 0.8263
 Site-MNIST                         | Val  Loss: 0.8465 | Val  Acc: 0.8175
 Site-USPS                          | Val  Loss: 0.7629 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.7999 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.8063 | Val  Acc: 0.7991
 Site-SynthDigits                   | Val  Loss: 1.6231 | Val  Acc: 0.5758
 Site-SynthDigits                   | Val  Loss: 1.3374 | Val  Acc: 0.5859
 Site-MNIST_M                       | Val  Loss: 1.5982 | Val  Acc: 0.5568
 Site-MNIST_M                       | Val  Loss: 1.7590 | Val  Acc: 0.4848
 Site-SVHN                          | Val  Loss: 1.9821 | Val  Acc: 0.3151
Average Valid Accuracy: 0.7011
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8263
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.8175
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8077
 Best site-USPS                      | Epoch:17 | Val Acc: 0.7991
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5758
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5859
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.5568
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.4848
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3151
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.7706 | Train Acc: 0.8489
 Site-MNIST                         | Train Loss: 0.8385 | Train Acc: 0.8314
 Site-MNIST                         | Train Loss: 0.8517 | Train Acc: 0.8047
 Site-MNIST                         | Train Loss: 0.7918 | Train Acc: 0.8279
 Site-MNIST                         | Train Loss: 0.7832 | Train Acc: 0.8363
 Site-USPS                          | Train Loss: 0.7845 | Train Acc: 0.8153
 Site-USPS                          | Train Loss: 0.7341 | Train Acc: 0.8227
 Site-USPS                          | Train Loss: 0.7303 | Train Acc: 0.8371
 Site-SynthDigits                   | Train Loss: 1.4695 | Train Acc: 0.5777
 Site-SynthDigits                   | Train Loss: 1.3927 | Train Acc: 0.6124
 Site-MNIST_M                       | Train Loss: 1.7176 | Train Acc: 0.4886
 Site-MNIST_M                       | Train Loss: 1.8166 | Train Acc: 0.4356
 Site-SVHN                          | Train Loss: 1.9098 | Train Acc: 0.3492
Average Train Accuracy: 0.6991
 Site-MNIST                         | Val  Loss: 0.7864 | Val  Acc: 0.8036
 Site-MNIST                         | Val  Loss: 0.7791 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.7869 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.8358 | Val  Acc: 0.8211
 Site-MNIST                         | Val  Loss: 0.8209 | Val  Acc: 0.8246
 Site-USPS                          | Val  Loss: 0.7287 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.7677 | Val  Acc: 0.8077
 Site-USPS                          | Val  Loss: 0.7808 | Val  Acc: 0.8034
 Site-SynthDigits                   | Val  Loss: 1.6094 | Val  Acc: 0.5758
 Site-SynthDigits                   | Val  Loss: 1.3232 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.5694 | Val  Acc: 0.5795
 Site-MNIST_M                       | Val  Loss: 1.7451 | Val  Acc: 0.4773
 Site-SVHN                          | Val  Loss: 1.9716 | Val  Acc: 0.3288
Average Valid Accuracy: 0.7041
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8036
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8211
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.8246
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8077
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8034
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.5758
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.5909
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.5795
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.4773
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.3288
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.7278 | Train Acc: 0.8489
 Site-MNIST                         | Train Loss: 0.7685 | Train Acc: 0.8254
 Site-MNIST                         | Train Loss: 0.8291 | Train Acc: 0.8146
 Site-MNIST                         | Train Loss: 0.7664 | Train Acc: 0.8305
 Site-MNIST                         | Train Loss: 0.7592 | Train Acc: 0.8415
 Site-USPS                          | Train Loss: 0.7563 | Train Acc: 0.8297
 Site-USPS                          | Train Loss: 0.7196 | Train Acc: 0.8355
 Site-USPS                          | Train Loss: 0.7187 | Train Acc: 0.8371
 Site-SynthDigits                   | Train Loss: 1.4273 | Train Acc: 0.5833
 Site-SynthDigits                   | Train Loss: 1.3554 | Train Acc: 0.6187
 Site-MNIST_M                       | Train Loss: 1.7156 | Train Acc: 0.4943
 Site-MNIST_M                       | Train Loss: 1.7894 | Train Acc: 0.4394
 Site-SVHN                          | Train Loss: 1.9126 | Train Acc: 0.3509
Average Train Accuracy: 0.7038
 Site-MNIST                         | Val  Loss: 0.7572 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.7477 | Val  Acc: 0.8690
 Site-MNIST                         | Val  Loss: 0.7634 | Val  Acc: 0.8651
 Site-MNIST                         | Val  Loss: 0.8113 | Val  Acc: 0.8263
 Site-MNIST                         | Val  Loss: 0.7991 | Val  Acc: 0.8175
 Site-USPS                          | Val  Loss: 0.7073 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.7511 | Val  Acc: 0.8205
 Site-USPS                          | Val  Loss: 0.7681 | Val  Acc: 0.8162
 Site-SynthDigits                   | Val  Loss: 1.5762 | Val  Acc: 0.5909
 Site-SynthDigits                   | Val  Loss: 1.2749 | Val  Acc: 0.6061
 Site-MNIST_M                       | Val  Loss: 1.5467 | Val  Acc: 0.5568
 Site-MNIST_M                       | Val  Loss: 1.7337 | Val  Acc: 0.4924
 Site-SVHN                          | Val  Loss: 1.9537 | Val  Acc: 0.3356
Average Valid Accuracy: 0.7111
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8690
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8651
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8263
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8175
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8205
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8162
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.5909
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.6061
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.5568
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.4924
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.6997 | Train Acc: 0.8489
 Site-MNIST                         | Train Loss: 0.7316 | Train Acc: 0.8343
 Site-MNIST                         | Train Loss: 0.7927 | Train Acc: 0.8107
 Site-MNIST                         | Train Loss: 0.7339 | Train Acc: 0.8371
 Site-MNIST                         | Train Loss: 0.7275 | Train Acc: 0.8468
 Site-USPS                          | Train Loss: 0.7404 | Train Acc: 0.8345
 Site-USPS                          | Train Loss: 0.6811 | Train Acc: 0.8387
 Site-USPS                          | Train Loss: 0.6780 | Train Acc: 0.8456
 Site-SynthDigits                   | Train Loss: 1.4110 | Train Acc: 0.5852
 Site-SynthDigits                   | Train Loss: 1.3577 | Train Acc: 0.6237
 Site-MNIST_M                       | Train Loss: 1.6944 | Train Acc: 0.4943
 Site-MNIST_M                       | Train Loss: 1.7672 | Train Acc: 0.4508
 Site-SVHN                          | Train Loss: 1.8877 | Train Acc: 0.3578
Average Train Accuracy: 0.7083
 Site-MNIST                         | Val  Loss: 0.7157 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.7117 | Val  Acc: 0.8690
 Site-MNIST                         | Val  Loss: 0.7280 | Val  Acc: 0.8651
 Site-MNIST                         | Val  Loss: 0.7731 | Val  Acc: 0.8263
 Site-MNIST                         | Val  Loss: 0.7623 | Val  Acc: 0.8211
 Site-USPS                          | Val  Loss: 0.6629 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 0.7129 | Val  Acc: 0.8141
 Site-USPS                          | Val  Loss: 0.7316 | Val  Acc: 0.8162
 Site-SynthDigits                   | Val  Loss: 1.5592 | Val  Acc: 0.5833
 Site-SynthDigits                   | Val  Loss: 1.2601 | Val  Acc: 0.6061
 Site-MNIST_M                       | Val  Loss: 1.5294 | Val  Acc: 0.5795
 Site-MNIST_M                       | Val  Loss: 1.6986 | Val  Acc: 0.5000
 Site-SVHN                          | Val  Loss: 1.9422 | Val  Acc: 0.3288
Average Valid Accuracy: 0.7143
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8393
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8690
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8651
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8263
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.8211
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8141
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8162
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5833
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.6061
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5795
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.5000
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3288
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.6929 | Train Acc: 0.8578
 Site-MNIST                         | Train Loss: 0.7249 | Train Acc: 0.8402
 Site-MNIST                         | Train Loss: 0.7712 | Train Acc: 0.8126
 Site-MNIST                         | Train Loss: 0.7126 | Train Acc: 0.8436
 Site-MNIST                         | Train Loss: 0.7030 | Train Acc: 0.8564
 Site-USPS                          | Train Loss: 0.7258 | Train Acc: 0.8441
 Site-USPS                          | Train Loss: 0.6625 | Train Acc: 0.8355
 Site-USPS                          | Train Loss: 0.6613 | Train Acc: 0.8530
 Site-SynthDigits                   | Train Loss: 1.3807 | Train Acc: 0.5871
 Site-SynthDigits                   | Train Loss: 1.3201 | Train Acc: 0.6263
 Site-MNIST_M                       | Train Loss: 1.6885 | Train Acc: 0.4972
 Site-MNIST_M                       | Train Loss: 1.7420 | Train Acc: 0.4640
 Site-SVHN                          | Train Loss: 1.8794 | Train Acc: 0.3543
Average Train Accuracy: 0.7132
 Site-MNIST                         | Val  Loss: 0.6905 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 0.6832 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.7062 | Val  Acc: 0.8651
 Site-MNIST                         | Val  Loss: 0.7502 | Val  Acc: 0.8316
 Site-MNIST                         | Val  Loss: 0.7430 | Val  Acc: 0.8281
 Site-USPS                          | Val  Loss: 0.6385 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.6945 | Val  Acc: 0.8205
 Site-USPS                          | Val  Loss: 0.7164 | Val  Acc: 0.8333
 Site-SynthDigits                   | Val  Loss: 1.5318 | Val  Acc: 0.5985
 Site-SynthDigits                   | Val  Loss: 1.2298 | Val  Acc: 0.6212
 Site-MNIST_M                       | Val  Loss: 1.5062 | Val  Acc: 0.5568
 Site-MNIST_M                       | Val  Loss: 1.6905 | Val  Acc: 0.4924
 Site-SVHN                          | Val  Loss: 1.9319 | Val  Acc: 0.3493
Average Valid Accuracy: 0.7156
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8651
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8316
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.8281
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8205
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8333
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.5985
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.6212
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.5568
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.4924
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.3493
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.6583 | Train Acc: 0.8578
 Site-MNIST                         | Train Loss: 0.7200 | Train Acc: 0.8402
 Site-MNIST                         | Train Loss: 0.7508 | Train Acc: 0.8185
 Site-MNIST                         | Train Loss: 0.6926 | Train Acc: 0.8410
 Site-MNIST                         | Train Loss: 0.6814 | Train Acc: 0.8616
 Site-USPS                          | Train Loss: 0.7068 | Train Acc: 0.8513
 Site-USPS                          | Train Loss: 0.6366 | Train Acc: 0.8466
 Site-USPS                          | Train Loss: 0.6373 | Train Acc: 0.8584
 Site-SynthDigits                   | Train Loss: 1.3959 | Train Acc: 0.5890
 Site-SynthDigits                   | Train Loss: 1.2991 | Train Acc: 0.6427
 Site-MNIST_M                       | Train Loss: 1.6307 | Train Acc: 0.4915
 Site-MNIST_M                       | Train Loss: 1.7383 | Train Acc: 0.4640
 Site-SVHN                          | Train Loss: 1.8611 | Train Acc: 0.3663
Average Train Accuracy: 0.7176
 Site-MNIST                         | Val  Loss: 0.6669 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.6627 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.6852 | Val  Acc: 0.8651
 Site-MNIST                         | Val  Loss: 0.7295 | Val  Acc: 0.8263
 Site-MNIST                         | Val  Loss: 0.7238 | Val  Acc: 0.8281
 Site-USPS                          | Val  Loss: 0.6077 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 0.6701 | Val  Acc: 0.8205
 Site-USPS                          | Val  Loss: 0.6969 | Val  Acc: 0.8376
 Site-SynthDigits                   | Val  Loss: 1.5172 | Val  Acc: 0.5909
 Site-SynthDigits                   | Val  Loss: 1.2159 | Val  Acc: 0.6162
 Site-MNIST_M                       | Val  Loss: 1.4859 | Val  Acc: 0.5568
 Site-MNIST_M                       | Val  Loss: 1.6733 | Val  Acc: 0.4848
 Site-SVHN                          | Val  Loss: 1.9234 | Val  Acc: 0.3493
Average Valid Accuracy: 0.7193
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8810
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8651
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8263
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8281
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8205
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8376
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.5909
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.6162
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5568
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.4848
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.3493
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.6373 | Train Acc: 0.8533
 Site-MNIST                         | Train Loss: 0.6967 | Train Acc: 0.8402
 Site-MNIST                         | Train Loss: 0.7327 | Train Acc: 0.8107
 Site-MNIST                         | Train Loss: 0.6747 | Train Acc: 0.8423
 Site-MNIST                         | Train Loss: 0.6620 | Train Acc: 0.8634
 Site-USPS                          | Train Loss: 0.6802 | Train Acc: 0.8561
 Site-USPS                          | Train Loss: 0.6202 | Train Acc: 0.8482
 Site-USPS                          | Train Loss: 0.6210 | Train Acc: 0.8584
 Site-SynthDigits                   | Train Loss: 1.3344 | Train Acc: 0.5947
 Site-SynthDigits                   | Train Loss: 1.2797 | Train Acc: 0.6477
 Site-MNIST_M                       | Train Loss: 1.6186 | Train Acc: 0.4915
 Site-MNIST_M                       | Train Loss: 1.7054 | Train Acc: 0.4867
 Site-SVHN                          | Train Loss: 1.8679 | Train Acc: 0.3629
Average Train Accuracy: 0.7197
 Site-MNIST                         | Val  Loss: 0.6448 | Val  Acc: 0.8393
 Site-MNIST                         | Val  Loss: 0.6418 | Val  Acc: 0.8690
 Site-MNIST                         | Val  Loss: 0.6666 | Val  Acc: 0.8651
 Site-MNIST                         | Val  Loss: 0.7109 | Val  Acc: 0.8263
 Site-MNIST                         | Val  Loss: 0.7059 | Val  Acc: 0.8281
 Site-USPS                          | Val  Loss: 0.5863 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.6519 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.6801 | Val  Acc: 0.8462
 Site-SynthDigits                   | Val  Loss: 1.4880 | Val  Acc: 0.5909
 Site-SynthDigits                   | Val  Loss: 1.1910 | Val  Acc: 0.6263
 Site-MNIST_M                       | Val  Loss: 1.4679 | Val  Acc: 0.5341
 Site-MNIST_M                       | Val  Loss: 1.6549 | Val  Acc: 0.4773
 Site-SVHN                          | Val  Loss: 1.9107 | Val  Acc: 0.3493
Average Valid Accuracy: 0.7178
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.6475 | Train Acc: 0.8400
 Site-MNIST                         | Train Loss: 0.6523 | Train Acc: 0.8432
 Site-MNIST                         | Train Loss: 0.7140 | Train Acc: 0.8304
 Site-MNIST                         | Train Loss: 0.6567 | Train Acc: 0.8436
 Site-MNIST                         | Train Loss: 0.6421 | Train Acc: 0.8651
 Site-USPS                          | Train Loss: 0.6659 | Train Acc: 0.8513
 Site-USPS                          | Train Loss: 0.6097 | Train Acc: 0.8450
 Site-USPS                          | Train Loss: 0.6070 | Train Acc: 0.8552
 Site-SynthDigits                   | Train Loss: 1.3194 | Train Acc: 0.5947
 Site-SynthDigits                   | Train Loss: 1.2661 | Train Acc: 0.6452
 Site-MNIST_M                       | Train Loss: 1.6080 | Train Acc: 0.5000
 Site-MNIST_M                       | Train Loss: 1.6752 | Train Acc: 0.4981
 Site-SVHN                          | Train Loss: 1.8414 | Train Acc: 0.3731
Average Train Accuracy: 0.7219
 Site-MNIST                         | Val  Loss: 0.6210 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.6166 | Val  Acc: 0.8690
 Site-MNIST                         | Val  Loss: 0.6436 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.6893 | Val  Acc: 0.8368
 Site-MNIST                         | Val  Loss: 0.6856 | Val  Acc: 0.8316
 Site-USPS                          | Val  Loss: 0.5721 | Val  Acc: 0.8365
 Site-USPS                          | Val  Loss: 0.6399 | Val  Acc: 0.8205
 Site-USPS                          | Val  Loss: 0.6651 | Val  Acc: 0.8376
 Site-SynthDigits                   | Val  Loss: 1.4682 | Val  Acc: 0.5833
 Site-SynthDigits                   | Val  Loss: 1.1633 | Val  Acc: 0.6162
 Site-MNIST_M                       | Val  Loss: 1.4473 | Val  Acc: 0.5455
 Site-MNIST_M                       | Val  Loss: 1.6349 | Val  Acc: 0.4924
 Site-SVHN                          | Val  Loss: 1.8946 | Val  Acc: 0.3562
Average Valid Accuracy: 0.7203
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8690
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8810
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8368
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.8316
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8365
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8205
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8376
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.5833
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.6162
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.5455
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.4924
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3562
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.6198 | Train Acc: 0.8533
 Site-MNIST                         | Train Loss: 0.6762 | Train Acc: 0.8432
 Site-MNIST                         | Train Loss: 0.6932 | Train Acc: 0.8264
 Site-MNIST                         | Train Loss: 0.6407 | Train Acc: 0.8449
 Site-MNIST                         | Train Loss: 0.6270 | Train Acc: 0.8678
 Site-USPS                          | Train Loss: 0.6388 | Train Acc: 0.8609
 Site-USPS                          | Train Loss: 0.5876 | Train Acc: 0.8562
 Site-USPS                          | Train Loss: 0.5866 | Train Acc: 0.8637
 Site-SynthDigits                   | Train Loss: 1.3221 | Train Acc: 0.5947
 Site-SynthDigits                   | Train Loss: 1.2594 | Train Acc: 0.6515
 Site-MNIST_M                       | Train Loss: 1.5880 | Train Acc: 0.5227
 Site-MNIST_M                       | Train Loss: 1.6617 | Train Acc: 0.5038
 Site-SVHN                          | Train Loss: 1.8401 | Train Acc: 0.3731
Average Train Accuracy: 0.7279
 Site-MNIST                         | Val  Loss: 0.5979 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.5977 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.6274 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.6717 | Val  Acc: 0.8316
 Site-MNIST                         | Val  Loss: 0.6688 | Val  Acc: 0.8316
 Site-USPS                          | Val  Loss: 0.5435 | Val  Acc: 0.8558
 Site-USPS                          | Val  Loss: 0.6199 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.6499 | Val  Acc: 0.8462
 Site-SynthDigits                   | Val  Loss: 1.4528 | Val  Acc: 0.5909
 Site-SynthDigits                   | Val  Loss: 1.1497 | Val  Acc: 0.6212
 Site-MNIST_M                       | Val  Loss: 1.4329 | Val  Acc: 0.5682
 Site-MNIST_M                       | Val  Loss: 1.6172 | Val  Acc: 0.5152
 Site-SVHN                          | Val  Loss: 1.8853 | Val  Acc: 0.3699
Average Valid Accuracy: 0.7296
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8810
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8316
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.8316
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8558
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8462
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.5909
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.6212
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.5682
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.5152
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.3699
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.5986 | Train Acc: 0.8533
 Site-MNIST                         | Train Loss: 0.6413 | Train Acc: 0.8373
 Site-MNIST                         | Train Loss: 0.6874 | Train Acc: 0.8264
 Site-MNIST                         | Train Loss: 0.6339 | Train Acc: 0.8436
 Site-MNIST                         | Train Loss: 0.6183 | Train Acc: 0.8730
 Site-USPS                          | Train Loss: 0.6402 | Train Acc: 0.8609
 Site-USPS                          | Train Loss: 0.5758 | Train Acc: 0.8530
 Site-USPS                          | Train Loss: 0.5857 | Train Acc: 0.8605
 Site-SynthDigits                   | Train Loss: 1.2771 | Train Acc: 0.5947
 Site-SynthDigits                   | Train Loss: 1.2120 | Train Acc: 0.6528
 Site-MNIST_M                       | Train Loss: 1.5753 | Train Acc: 0.5256
 Site-MNIST_M                       | Train Loss: 1.6617 | Train Acc: 0.5000
 Site-SVHN                          | Train Loss: 1.8460 | Train Acc: 0.3680
Average Train Accuracy: 0.7269
 Site-MNIST                         | Val  Loss: 0.5873 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.5848 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.6218 | Val  Acc: 0.8730
 Site-MNIST                         | Val  Loss: 0.6686 | Val  Acc: 0.8368
 Site-MNIST                         | Val  Loss: 0.6655 | Val  Acc: 0.8316
 Site-USPS                          | Val  Loss: 0.5354 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.6130 | Val  Acc: 0.8205
 Site-USPS                          | Val  Loss: 0.6470 | Val  Acc: 0.8462
 Site-SynthDigits                   | Val  Loss: 1.4325 | Val  Acc: 0.5985
 Site-SynthDigits                   | Val  Loss: 1.1258 | Val  Acc: 0.6162
 Site-MNIST_M                       | Val  Loss: 1.4167 | Val  Acc: 0.5909
 Site-MNIST_M                       | Val  Loss: 1.6094 | Val  Acc: 0.5303
 Site-SVHN                          | Val  Loss: 1.8781 | Val  Acc: 0.3562
Average Valid Accuracy: 0.7323
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8810
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8730
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8368
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8316
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8462
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8205
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8462
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.5985
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.6162
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5909
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.5303
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.3562
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.5944 | Train Acc: 0.8533
 Site-MNIST                         | Train Loss: 0.6345 | Train Acc: 0.8491
 Site-MNIST                         | Train Loss: 0.6661 | Train Acc: 0.8383
 Site-MNIST                         | Train Loss: 0.6113 | Train Acc: 0.8463
 Site-MNIST                         | Train Loss: 0.5965 | Train Acc: 0.8730
 Site-USPS                          | Train Loss: 0.6243 | Train Acc: 0.8609
 Site-USPS                          | Train Loss: 0.5688 | Train Acc: 0.8546
 Site-USPS                          | Train Loss: 0.5711 | Train Acc: 0.8605
 Site-SynthDigits                   | Train Loss: 1.2878 | Train Acc: 0.5985
 Site-SynthDigits                   | Train Loss: 1.2129 | Train Acc: 0.6578
 Site-MNIST_M                       | Train Loss: 1.5374 | Train Acc: 0.5312
 Site-MNIST_M                       | Train Loss: 1.6476 | Train Acc: 0.5057
 Site-SVHN                          | Train Loss: 1.8211 | Train Acc: 0.3782
Average Train Accuracy: 0.7313
 Site-MNIST                         | Val  Loss: 0.5622 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.5647 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.5974 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.6456 | Val  Acc: 0.8421
 Site-MNIST                         | Val  Loss: 0.6425 | Val  Acc: 0.8386
 Site-USPS                          | Val  Loss: 0.5253 | Val  Acc: 0.8558
 Site-USPS                          | Val  Loss: 0.6103 | Val  Acc: 0.8269
 Site-USPS                          | Val  Loss: 0.6404 | Val  Acc: 0.8419
 Site-SynthDigits                   | Val  Loss: 1.4255 | Val  Acc: 0.6061
 Site-SynthDigits                   | Val  Loss: 1.1081 | Val  Acc: 0.6111
 Site-MNIST_M                       | Val  Loss: 1.3998 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.5887 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 1.8577 | Val  Acc: 0.3630
Average Valid Accuracy: 0.7431
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8421
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8386
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8558
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8269
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8419
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.6061
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.6111
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.6250
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.5455
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.3630
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.5768 | Train Acc: 0.8533
 Site-MNIST                         | Train Loss: 0.6247 | Train Acc: 0.8550
 Site-MNIST                         | Train Loss: 0.6513 | Train Acc: 0.8323
 Site-MNIST                         | Train Loss: 0.5996 | Train Acc: 0.8541
 Site-MNIST                         | Train Loss: 0.5840 | Train Acc: 0.8783
 Site-USPS                          | Train Loss: 0.6254 | Train Acc: 0.8657
 Site-USPS                          | Train Loss: 0.5496 | Train Acc: 0.8610
 Site-USPS                          | Train Loss: 0.5580 | Train Acc: 0.8626
 Site-SynthDigits                   | Train Loss: 1.2672 | Train Acc: 0.6004
 Site-SynthDigits                   | Train Loss: 1.2031 | Train Acc: 0.6591
 Site-MNIST_M                       | Train Loss: 1.5438 | Train Acc: 0.5398
 Site-MNIST_M                       | Train Loss: 1.6011 | Train Acc: 0.5076
 Site-SVHN                          | Train Loss: 1.7799 | Train Acc: 0.3799
Average Train Accuracy: 0.7346
 Site-MNIST                         | Val  Loss: 0.5416 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.5470 | Val  Acc: 0.8690
 Site-MNIST                         | Val  Loss: 0.5861 | Val  Acc: 0.8730
 Site-MNIST                         | Val  Loss: 0.6315 | Val  Acc: 0.8368
 Site-MNIST                         | Val  Loss: 0.6279 | Val  Acc: 0.8491
 Site-USPS                          | Val  Loss: 0.5025 | Val  Acc: 0.8558
 Site-USPS                          | Val  Loss: 0.5908 | Val  Acc: 0.8205
 Site-USPS                          | Val  Loss: 0.6226 | Val  Acc: 0.8462
 Site-SynthDigits                   | Val  Loss: 1.4036 | Val  Acc: 0.5985
 Site-SynthDigits                   | Val  Loss: 1.0890 | Val  Acc: 0.6111
 Site-MNIST_M                       | Val  Loss: 1.3826 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.5743 | Val  Acc: 0.5606
 Site-SVHN                          | Val  Loss: 1.8542 | Val  Acc: 0.3699
Average Valid Accuracy: 0.7400
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.5619 | Train Acc: 0.8533
 Site-MNIST                         | Train Loss: 0.6007 | Train Acc: 0.8550
 Site-MNIST                         | Train Loss: 0.6388 | Train Acc: 0.8383
 Site-MNIST                         | Train Loss: 0.5872 | Train Acc: 0.8568
 Site-MNIST                         | Train Loss: 0.5698 | Train Acc: 0.8835
 Site-USPS                          | Train Loss: 0.6018 | Train Acc: 0.8729
 Site-USPS                          | Train Loss: 0.5371 | Train Acc: 0.8770
 Site-USPS                          | Train Loss: 0.5422 | Train Acc: 0.8733
 Site-SynthDigits                   | Train Loss: 1.2653 | Train Acc: 0.6042
 Site-SynthDigits                   | Train Loss: 1.1878 | Train Acc: 0.6641
 Site-MNIST_M                       | Train Loss: 1.5216 | Train Acc: 0.5341
 Site-MNIST_M                       | Train Loss: 1.6206 | Train Acc: 0.5057
 Site-SVHN                          | Train Loss: 1.7772 | Train Acc: 0.3833
Average Train Accuracy: 0.7386
 Site-MNIST                         | Val  Loss: 0.5254 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.5332 | Val  Acc: 0.8810
 Site-MNIST                         | Val  Loss: 0.5745 | Val  Acc: 0.8968
 Site-MNIST                         | Val  Loss: 0.6178 | Val  Acc: 0.8526
 Site-MNIST                         | Val  Loss: 0.6152 | Val  Acc: 0.8526
 Site-USPS                          | Val  Loss: 0.4820 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.5746 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.6101 | Val  Acc: 0.8590
 Site-SynthDigits                   | Val  Loss: 1.3923 | Val  Acc: 0.5985
 Site-SynthDigits                   | Val  Loss: 1.0857 | Val  Acc: 0.6212
 Site-MNIST_M                       | Val  Loss: 1.3601 | Val  Acc: 0.6136
 Site-MNIST_M                       | Val  Loss: 1.5517 | Val  Acc: 0.5379
 Site-SVHN                          | Val  Loss: 1.8520 | Val  Acc: 0.3493
Average Valid Accuracy: 0.7472
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8810
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8968
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8526
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8526
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8942
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8462
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8590
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5985
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.6212
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.6136
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.5379
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3493
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.5526 | Train Acc: 0.8489
 Site-MNIST                         | Train Loss: 0.5583 | Train Acc: 0.8550
 Site-MNIST                         | Train Loss: 0.6128 | Train Acc: 0.8501
 Site-MNIST                         | Train Loss: 0.5649 | Train Acc: 0.8555
 Site-MNIST                         | Train Loss: 0.5488 | Train Acc: 0.8888
 Site-USPS                          | Train Loss: 0.5997 | Train Acc: 0.8777
 Site-USPS                          | Train Loss: 0.5262 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.5327 | Train Acc: 0.8701
 Site-SynthDigits                   | Train Loss: 1.2370 | Train Acc: 0.6042
 Site-SynthDigits                   | Train Loss: 1.1709 | Train Acc: 0.6667
 Site-MNIST_M                       | Train Loss: 1.5209 | Train Acc: 0.5426
 Site-MNIST_M                       | Train Loss: 1.6029 | Train Acc: 0.5095
 Site-SVHN                          | Train Loss: 1.7946 | Train Acc: 0.3884
Average Train Accuracy: 0.7406
 Site-MNIST                         | Val  Loss: 0.5056 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.5082 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.5481 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.5916 | Val  Acc: 0.8632
 Site-MNIST                         | Val  Loss: 0.5926 | Val  Acc: 0.8491
 Site-USPS                          | Val  Loss: 0.4742 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.5707 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.6055 | Val  Acc: 0.8590
 Site-SynthDigits                   | Val  Loss: 1.3880 | Val  Acc: 0.6136
 Site-SynthDigits                   | Val  Loss: 1.0664 | Val  Acc: 0.6263
 Site-MNIST_M                       | Val  Loss: 1.3450 | Val  Acc: 0.6250
 Site-MNIST_M                       | Val  Loss: 1.5301 | Val  Acc: 0.5530
 Site-SVHN                          | Val  Loss: 1.8285 | Val  Acc: 0.3630
Average Valid Accuracy: 0.7548
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8632
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8491
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8942
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8462
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8590
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.6136
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.6263
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.6250
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5530
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.3630
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.5669 | Train Acc: 0.8578
 Site-MNIST                         | Train Loss: 0.5848 | Train Acc: 0.8521
 Site-MNIST                         | Train Loss: 0.6041 | Train Acc: 0.8521
 Site-MNIST                         | Train Loss: 0.5580 | Train Acc: 0.8581
 Site-MNIST                         | Train Loss: 0.5415 | Train Acc: 0.8870
 Site-USPS                          | Train Loss: 0.6042 | Train Acc: 0.8681
 Site-USPS                          | Train Loss: 0.5275 | Train Acc: 0.8642
 Site-USPS                          | Train Loss: 0.5341 | Train Acc: 0.8701
 Site-SynthDigits                   | Train Loss: 1.1801 | Train Acc: 0.6098
 Site-SynthDigits                   | Train Loss: 1.1556 | Train Acc: 0.6654
 Site-MNIST_M                       | Train Loss: 1.4853 | Train Acc: 0.5341
 Site-MNIST_M                       | Train Loss: 1.5905 | Train Acc: 0.5133
 Site-SVHN                          | Train Loss: 1.7530 | Train Acc: 0.4072
Average Train Accuracy: 0.7415
 Site-MNIST                         | Val  Loss: 0.4916 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4958 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.5384 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.5820 | Val  Acc: 0.8579
 Site-MNIST                         | Val  Loss: 0.5823 | Val  Acc: 0.8456
 Site-USPS                          | Val  Loss: 0.4744 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.5746 | Val  Acc: 0.8397
 Site-USPS                          | Val  Loss: 0.6078 | Val  Acc: 0.8419
 Site-SynthDigits                   | Val  Loss: 1.3711 | Val  Acc: 0.6061
 Site-SynthDigits                   | Val  Loss: 1.0365 | Val  Acc: 0.6313
 Site-MNIST_M                       | Val  Loss: 1.3307 | Val  Acc: 0.6136
 Site-MNIST_M                       | Val  Loss: 1.5115 | Val  Acc: 0.5530
 Site-SVHN                          | Val  Loss: 1.8149 | Val  Acc: 0.3904
Average Valid Accuracy: 0.7549
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8579
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8456
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8846
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8397
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8419
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.6061
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.6313
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.6136
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.5530
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.3904
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.5403 | Train Acc: 0.8667
 Site-MNIST                         | Train Loss: 0.5414 | Train Acc: 0.8491
 Site-MNIST                         | Train Loss: 0.5886 | Train Acc: 0.8521
 Site-MNIST                         | Train Loss: 0.5453 | Train Acc: 0.8581
 Site-MNIST                         | Train Loss: 0.5287 | Train Acc: 0.8879
 Site-USPS                          | Train Loss: 0.5817 | Train Acc: 0.8801
 Site-USPS                          | Train Loss: 0.5099 | Train Acc: 0.8738
 Site-USPS                          | Train Loss: 0.5151 | Train Acc: 0.8743
 Site-SynthDigits                   | Train Loss: 1.2037 | Train Acc: 0.6117
 Site-SynthDigits                   | Train Loss: 1.1445 | Train Acc: 0.6705
 Site-MNIST_M                       | Train Loss: 1.4853 | Train Acc: 0.5369
 Site-MNIST_M                       | Train Loss: 1.5583 | Train Acc: 0.5189
 Site-SVHN                          | Train Loss: 1.7521 | Train Acc: 0.4089
Average Train Accuracy: 0.7453
 Site-MNIST                         | Val  Loss: 0.4782 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4805 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.5241 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.5695 | Val  Acc: 0.8579
 Site-MNIST                         | Val  Loss: 0.5717 | Val  Acc: 0.8421
 Site-USPS                          | Val  Loss: 0.4534 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.5545 | Val  Acc: 0.8526
 Site-USPS                          | Val  Loss: 0.5891 | Val  Acc: 0.8632
 Site-SynthDigits                   | Val  Loss: 1.3613 | Val  Acc: 0.6212
 Site-SynthDigits                   | Val  Loss: 1.0316 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.3197 | Val  Acc: 0.6136
 Site-MNIST_M                       | Val  Loss: 1.4989 | Val  Acc: 0.5530
 Site-SVHN                          | Val  Loss: 1.8110 | Val  Acc: 0.3836
Average Valid Accuracy: 0.7591
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8579
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8421
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8942
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8526
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8632
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.6212
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.6364
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.6136
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.5530
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.3836
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.5313 | Train Acc: 0.8756
 Site-MNIST                         | Train Loss: 0.5581 | Train Acc: 0.8550
 Site-MNIST                         | Train Loss: 0.5767 | Train Acc: 0.8521
 Site-MNIST                         | Train Loss: 0.5338 | Train Acc: 0.8633
 Site-MNIST                         | Train Loss: 0.5179 | Train Acc: 0.8905
 Site-USPS                          | Train Loss: 0.5589 | Train Acc: 0.8801
 Site-USPS                          | Train Loss: 0.5008 | Train Acc: 0.8770
 Site-USPS                          | Train Loss: 0.5072 | Train Acc: 0.8765
 Site-SynthDigits                   | Train Loss: 1.1646 | Train Acc: 0.6117
 Site-SynthDigits                   | Train Loss: 1.1245 | Train Acc: 0.6742
 Site-MNIST_M                       | Train Loss: 1.4789 | Train Acc: 0.5398
 Site-MNIST_M                       | Train Loss: 1.5567 | Train Acc: 0.5303
 Site-SVHN                          | Train Loss: 1.7531 | Train Acc: 0.4106
Average Train Accuracy: 0.7490
 Site-MNIST                         | Val  Loss: 0.4629 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4678 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.5102 | Val  Acc: 0.8968
 Site-MNIST                         | Val  Loss: 0.5528 | Val  Acc: 0.8579
 Site-MNIST                         | Val  Loss: 0.5552 | Val  Acc: 0.8491
 Site-USPS                          | Val  Loss: 0.4416 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.5430 | Val  Acc: 0.8526
 Site-USPS                          | Val  Loss: 0.5799 | Val  Acc: 0.8632
 Site-SynthDigits                   | Val  Loss: 1.3411 | Val  Acc: 0.5985
 Site-SynthDigits                   | Val  Loss: 1.0140 | Val  Acc: 0.6313
 Site-MNIST_M                       | Val  Loss: 1.3098 | Val  Acc: 0.6136
 Site-MNIST_M                       | Val  Loss: 1.4823 | Val  Acc: 0.5530
 Site-SVHN                          | Val  Loss: 1.8045 | Val  Acc: 0.3767
Average Valid Accuracy: 0.7554
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.4928 | Train Acc: 0.8844
 Site-MNIST                         | Train Loss: 0.5089 | Train Acc: 0.8669
 Site-MNIST                         | Train Loss: 0.5655 | Train Acc: 0.8560
 Site-MNIST                         | Train Loss: 0.5210 | Train Acc: 0.8686
 Site-MNIST                         | Train Loss: 0.5050 | Train Acc: 0.8905
 Site-USPS                          | Train Loss: 0.5624 | Train Acc: 0.8753
 Site-USPS                          | Train Loss: 0.4954 | Train Acc: 0.8690
 Site-USPS                          | Train Loss: 0.5020 | Train Acc: 0.8765
 Site-SynthDigits                   | Train Loss: 1.1844 | Train Acc: 0.6193
 Site-SynthDigits                   | Train Loss: 1.1153 | Train Acc: 0.6768
 Site-MNIST_M                       | Train Loss: 1.4720 | Train Acc: 0.5369
 Site-MNIST_M                       | Train Loss: 1.5423 | Train Acc: 0.5227
 Site-SVHN                          | Train Loss: 1.7313 | Train Acc: 0.4106
Average Train Accuracy: 0.7503
 Site-MNIST                         | Val  Loss: 0.4478 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4543 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.5020 | Val  Acc: 0.8968
 Site-MNIST                         | Val  Loss: 0.5444 | Val  Acc: 0.8684
 Site-MNIST                         | Val  Loss: 0.5465 | Val  Acc: 0.8596
 Site-USPS                          | Val  Loss: 0.4344 | Val  Acc: 0.8846
 Site-USPS                          | Val  Loss: 0.5396 | Val  Acc: 0.8462
 Site-USPS                          | Val  Loss: 0.5769 | Val  Acc: 0.8590
 Site-SynthDigits                   | Val  Loss: 1.3296 | Val  Acc: 0.5985
 Site-SynthDigits                   | Val  Loss: 0.9944 | Val  Acc: 0.6414
 Site-MNIST_M                       | Val  Loss: 1.2905 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.4684 | Val  Acc: 0.5455
 Site-SVHN                          | Val  Loss: 1.8030 | Val  Acc: 0.3767
Average Valid Accuracy: 0.7548
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.5168 | Train Acc: 0.8800
 Site-MNIST                         | Train Loss: 0.5226 | Train Acc: 0.8669
 Site-MNIST                         | Train Loss: 0.5525 | Train Acc: 0.8600
 Site-MNIST                         | Train Loss: 0.5111 | Train Acc: 0.8712
 Site-MNIST                         | Train Loss: 0.4964 | Train Acc: 0.8923
 Site-USPS                          | Train Loss: 0.5594 | Train Acc: 0.8681
 Site-USPS                          | Train Loss: 0.4881 | Train Acc: 0.8802
 Site-USPS                          | Train Loss: 0.4932 | Train Acc: 0.8786
 Site-SynthDigits                   | Train Loss: 1.1752 | Train Acc: 0.6212
 Site-SynthDigits                   | Train Loss: 1.0989 | Train Acc: 0.6768
 Site-MNIST_M                       | Train Loss: 1.4491 | Train Acc: 0.5398
 Site-MNIST_M                       | Train Loss: 1.5343 | Train Acc: 0.5246
 Site-SVHN                          | Train Loss: 1.7243 | Train Acc: 0.4020
Average Train Accuracy: 0.7509
 Site-MNIST                         | Val  Loss: 0.4400 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4416 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.4907 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.5320 | Val  Acc: 0.8737
 Site-MNIST                         | Val  Loss: 0.5333 | Val  Acc: 0.8596
 Site-USPS                          | Val  Loss: 0.4286 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.5296 | Val  Acc: 0.8526
 Site-USPS                          | Val  Loss: 0.5649 | Val  Acc: 0.8547
 Site-SynthDigits                   | Val  Loss: 1.3195 | Val  Acc: 0.5909
 Site-SynthDigits                   | Val  Loss: 0.9795 | Val  Acc: 0.6465
 Site-MNIST_M                       | Val  Loss: 1.2720 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.4467 | Val  Acc: 0.5606
 Site-SVHN                          | Val  Loss: 1.7920 | Val  Acc: 0.3699
Average Valid Accuracy: 0.7594
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9127
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.8737
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.8596
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:35 | Val Acc: 0.8526
 Best site-USPS                      | Epoch:35 | Val Acc: 0.8547
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.5909
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.6465
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.6023
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.5606
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.3699
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.5179 | Train Acc: 0.8889
 Site-MNIST                         | Train Loss: 0.5105 | Train Acc: 0.8728
 Site-MNIST                         | Train Loss: 0.5419 | Train Acc: 0.8639
 Site-MNIST                         | Train Loss: 0.4988 | Train Acc: 0.8686
 Site-MNIST                         | Train Loss: 0.4826 | Train Acc: 0.8975
 Site-USPS                          | Train Loss: 0.5467 | Train Acc: 0.8801
 Site-USPS                          | Train Loss: 0.4715 | Train Acc: 0.8786
 Site-USPS                          | Train Loss: 0.4791 | Train Acc: 0.8818
 Site-SynthDigits                   | Train Loss: 1.1534 | Train Acc: 0.6288
 Site-SynthDigits                   | Train Loss: 1.0816 | Train Acc: 0.6843
 Site-MNIST_M                       | Train Loss: 1.4423 | Train Acc: 0.5483
 Site-MNIST_M                       | Train Loss: 1.5061 | Train Acc: 0.5227
 Site-SVHN                          | Train Loss: 1.7191 | Train Acc: 0.4208
Average Train Accuracy: 0.7567
 Site-MNIST                         | Val  Loss: 0.4272 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4305 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.4787 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.5184 | Val  Acc: 0.8789
 Site-MNIST                         | Val  Loss: 0.5191 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.4119 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.5188 | Val  Acc: 0.8526
 Site-USPS                          | Val  Loss: 0.5603 | Val  Acc: 0.8590
 Site-SynthDigits                   | Val  Loss: 1.3118 | Val  Acc: 0.6212
 Site-SynthDigits                   | Val  Loss: 0.9791 | Val  Acc: 0.6515
 Site-MNIST_M                       | Val  Loss: 1.2643 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.4358 | Val  Acc: 0.5682
 Site-SVHN                          | Val  Loss: 1.7784 | Val  Acc: 0.3904
Average Valid Accuracy: 0.7682
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9127
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.8789
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.8667
 Best site-USPS                      | Epoch:36 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8526
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8590
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.6212
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.6515
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.6364
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.5682
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.3904
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.4689 | Train Acc: 0.8844
 Site-MNIST                         | Train Loss: 0.4748 | Train Acc: 0.8669
 Site-MNIST                         | Train Loss: 0.5302 | Train Acc: 0.8659
 Site-MNIST                         | Train Loss: 0.4897 | Train Acc: 0.8699
 Site-MNIST                         | Train Loss: 0.4733 | Train Acc: 0.8932
 Site-USPS                          | Train Loss: 0.5517 | Train Acc: 0.8729
 Site-USPS                          | Train Loss: 0.4716 | Train Acc: 0.8818
 Site-USPS                          | Train Loss: 0.4814 | Train Acc: 0.8797
 Site-SynthDigits                   | Train Loss: 1.1545 | Train Acc: 0.6231
 Site-SynthDigits                   | Train Loss: 1.0897 | Train Acc: 0.6793
 Site-MNIST_M                       | Train Loss: 1.4141 | Train Acc: 0.5398
 Site-MNIST_M                       | Train Loss: 1.5335 | Train Acc: 0.5360
 Site-SVHN                          | Train Loss: 1.7750 | Train Acc: 0.4020
Average Train Accuracy: 0.7534
 Site-MNIST                         | Val  Loss: 0.4156 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4197 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.4650 | Val  Acc: 0.9206
 Site-MNIST                         | Val  Loss: 0.5091 | Val  Acc: 0.8842
 Site-MNIST                         | Val  Loss: 0.5104 | Val  Acc: 0.8596
 Site-USPS                          | Val  Loss: 0.4136 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.5176 | Val  Acc: 0.8590
 Site-USPS                          | Val  Loss: 0.5533 | Val  Acc: 0.8590
 Site-SynthDigits                   | Val  Loss: 1.3132 | Val  Acc: 0.5985
 Site-SynthDigits                   | Val  Loss: 0.9548 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.2469 | Val  Acc: 0.6023
 Site-MNIST_M                       | Val  Loss: 1.4203 | Val  Acc: 0.5606
 Site-SVHN                          | Val  Loss: 1.7860 | Val  Acc: 0.3699
Average Valid Accuracy: 0.7615
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.4744 | Train Acc: 0.8933
 Site-MNIST                         | Train Loss: 0.4841 | Train Acc: 0.8728
 Site-MNIST                         | Train Loss: 0.5223 | Train Acc: 0.8639
 Site-MNIST                         | Train Loss: 0.4807 | Train Acc: 0.8778
 Site-MNIST                         | Train Loss: 0.4663 | Train Acc: 0.8975
 Site-USPS                          | Train Loss: 0.5577 | Train Acc: 0.8777
 Site-USPS                          | Train Loss: 0.4615 | Train Acc: 0.8834
 Site-USPS                          | Train Loss: 0.4695 | Train Acc: 0.8882
 Site-SynthDigits                   | Train Loss: 1.1319 | Train Acc: 0.6402
 Site-SynthDigits                   | Train Loss: 1.0557 | Train Acc: 0.6856
 Site-MNIST_M                       | Train Loss: 1.4224 | Train Acc: 0.5540
 Site-MNIST_M                       | Train Loss: 1.5014 | Train Acc: 0.5341
 Site-SVHN                          | Train Loss: 1.7263 | Train Acc: 0.4157
Average Train Accuracy: 0.7603
 Site-MNIST                         | Val  Loss: 0.4045 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4132 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.4622 | Val  Acc: 0.9127
 Site-MNIST                         | Val  Loss: 0.5034 | Val  Acc: 0.8789
 Site-MNIST                         | Val  Loss: 0.5020 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.3988 | Val  Acc: 0.8942
 Site-USPS                          | Val  Loss: 0.5055 | Val  Acc: 0.8590
 Site-USPS                          | Val  Loss: 0.5446 | Val  Acc: 0.8632
 Site-SynthDigits                   | Val  Loss: 1.2970 | Val  Acc: 0.5985
 Site-SynthDigits                   | Val  Loss: 0.9462 | Val  Acc: 0.6616
 Site-MNIST_M                       | Val  Loss: 1.2474 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.4137 | Val  Acc: 0.5758
 Site-SVHN                          | Val  Loss: 1.7747 | Val  Acc: 0.3836
Average Valid Accuracy: 0.7674
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.4590 | Train Acc: 0.8933
 Site-MNIST                         | Train Loss: 0.4821 | Train Acc: 0.8698
 Site-MNIST                         | Train Loss: 0.5079 | Train Acc: 0.8679
 Site-MNIST                         | Train Loss: 0.4681 | Train Acc: 0.8739
 Site-MNIST                         | Train Loss: 0.4519 | Train Acc: 0.9019
 Site-USPS                          | Train Loss: 0.5219 | Train Acc: 0.8825
 Site-USPS                          | Train Loss: 0.4472 | Train Acc: 0.8898
 Site-USPS                          | Train Loss: 0.4516 | Train Acc: 0.8903
 Site-SynthDigits                   | Train Loss: 1.1270 | Train Acc: 0.6345
 Site-SynthDigits                   | Train Loss: 1.0746 | Train Acc: 0.6919
 Site-MNIST_M                       | Train Loss: 1.4128 | Train Acc: 0.5653
 Site-MNIST_M                       | Train Loss: 1.4723 | Train Acc: 0.5360
 Site-SVHN                          | Train Loss: 1.6559 | Train Acc: 0.4174
Average Train Accuracy: 0.7627
 Site-MNIST                         | Val  Loss: 0.3978 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.4030 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.4452 | Val  Acc: 0.9206
 Site-MNIST                         | Val  Loss: 0.4863 | Val  Acc: 0.8842
 Site-MNIST                         | Val  Loss: 0.4887 | Val  Acc: 0.8632
 Site-USPS                          | Val  Loss: 0.3834 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.4959 | Val  Acc: 0.8718
 Site-USPS                          | Val  Loss: 0.5359 | Val  Acc: 0.8675
 Site-SynthDigits                   | Val  Loss: 1.2960 | Val  Acc: 0.6136
 Site-SynthDigits                   | Val  Loss: 0.9429 | Val  Acc: 0.6566
 Site-MNIST_M                       | Val  Loss: 1.2278 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.3954 | Val  Acc: 0.5833
 Site-SVHN                          | Val  Loss: 1.7649 | Val  Acc: 0.3836
Average Valid Accuracy: 0.7738
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9206
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8842
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8632
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9038
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8718
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8675
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.6136
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.6566
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.6477
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.5833
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.3836
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.4644 | Train Acc: 0.8978
 Site-MNIST                         | Train Loss: 0.4543 | Train Acc: 0.8698
 Site-MNIST                         | Train Loss: 0.5020 | Train Acc: 0.8698
 Site-MNIST                         | Train Loss: 0.4616 | Train Acc: 0.8739
 Site-MNIST                         | Train Loss: 0.4439 | Train Acc: 0.9019
 Site-USPS                          | Train Loss: 0.5313 | Train Acc: 0.8801
 Site-USPS                          | Train Loss: 0.4481 | Train Acc: 0.8882
 Site-USPS                          | Train Loss: 0.4585 | Train Acc: 0.8924
 Site-SynthDigits                   | Train Loss: 1.1100 | Train Acc: 0.6420
 Site-SynthDigits                   | Train Loss: 1.0341 | Train Acc: 0.6932
 Site-MNIST_M                       | Train Loss: 1.3975 | Train Acc: 0.5653
 Site-MNIST_M                       | Train Loss: 1.4892 | Train Acc: 0.5303
 Site-SVHN                          | Train Loss: 1.6948 | Train Acc: 0.4123
Average Train Accuracy: 0.7628
 Site-MNIST                         | Val  Loss: 0.3880 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.3942 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.4414 | Val  Acc: 0.9206
 Site-MNIST                         | Val  Loss: 0.4836 | Val  Acc: 0.8842
 Site-MNIST                         | Val  Loss: 0.4829 | Val  Acc: 0.8632
 Site-USPS                          | Val  Loss: 0.3864 | Val  Acc: 0.9038
 Site-USPS                          | Val  Loss: 0.4961 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.5336 | Val  Acc: 0.8632
 Site-SynthDigits                   | Val  Loss: 1.2902 | Val  Acc: 0.6136
 Site-SynthDigits                   | Val  Loss: 0.9260 | Val  Acc: 0.6616
 Site-MNIST_M                       | Val  Loss: 1.2164 | Val  Acc: 0.6477
 Site-MNIST_M                       | Val  Loss: 1.3880 | Val  Acc: 0.5833
 Site-SVHN                          | Val  Loss: 1.7568 | Val  Acc: 0.3836
Average Valid Accuracy: 0.7733
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.4658 | Train Acc: 0.9067
 Site-MNIST                         | Train Loss: 0.4544 | Train Acc: 0.8728
 Site-MNIST                         | Train Loss: 0.4965 | Train Acc: 0.8679
 Site-MNIST                         | Train Loss: 0.4558 | Train Acc: 0.8804
 Site-MNIST                         | Train Loss: 0.4386 | Train Acc: 0.9028
 Site-USPS                          | Train Loss: 0.5170 | Train Acc: 0.8753
 Site-USPS                          | Train Loss: 0.4424 | Train Acc: 0.8930
 Site-USPS                          | Train Loss: 0.4478 | Train Acc: 0.8860
 Site-SynthDigits                   | Train Loss: 1.1009 | Train Acc: 0.6458
 Site-SynthDigits                   | Train Loss: 1.0290 | Train Acc: 0.6982
 Site-MNIST_M                       | Train Loss: 1.4014 | Train Acc: 0.5597
 Site-MNIST_M                       | Train Loss: 1.4558 | Train Acc: 0.5341
 Site-SVHN                          | Train Loss: 1.6917 | Train Acc: 0.4208
Average Train Accuracy: 0.7649
 Site-MNIST                         | Val  Loss: 0.3753 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.3862 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.4371 | Val  Acc: 0.9206
 Site-MNIST                         | Val  Loss: 0.4785 | Val  Acc: 0.8842
 Site-MNIST                         | Val  Loss: 0.4777 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.3786 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.4895 | Val  Acc: 0.8718
 Site-USPS                          | Val  Loss: 0.5274 | Val  Acc: 0.8590
 Site-SynthDigits                   | Val  Loss: 1.2719 | Val  Acc: 0.6136
 Site-SynthDigits                   | Val  Loss: 0.9130 | Val  Acc: 0.6717
 Site-MNIST_M                       | Val  Loss: 1.2100 | Val  Acc: 0.6364
 Site-MNIST_M                       | Val  Loss: 1.3835 | Val  Acc: 0.5682
 Site-SVHN                          | Val  Loss: 1.7517 | Val  Acc: 0.3836
Average Valid Accuracy: 0.7740
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9206
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.8842
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.8667
 Best site-USPS                      | Epoch:41 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:41 | Val Acc: 0.8718
 Best site-USPS                      | Epoch:41 | Val Acc: 0.8590
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.6136
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.6717
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.6364
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5682
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.3836
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.4728 | Train Acc: 0.9111
 Site-MNIST                         | Train Loss: 0.4815 | Train Acc: 0.8787
 Site-MNIST                         | Train Loss: 0.4817 | Train Acc: 0.8698
 Site-MNIST                         | Train Loss: 0.4432 | Train Acc: 0.8883
 Site-MNIST                         | Train Loss: 0.4267 | Train Acc: 0.9054
 Site-USPS                          | Train Loss: 0.4986 | Train Acc: 0.8801
 Site-USPS                          | Train Loss: 0.4298 | Train Acc: 0.8914
 Site-USPS                          | Train Loss: 0.4369 | Train Acc: 0.8978
 Site-SynthDigits                   | Train Loss: 1.0664 | Train Acc: 0.6458
 Site-SynthDigits                   | Train Loss: 1.0121 | Train Acc: 0.6932
 Site-MNIST_M                       | Train Loss: 1.3824 | Train Acc: 0.5682
 Site-MNIST_M                       | Train Loss: 1.4541 | Train Acc: 0.5360
 Site-SVHN                          | Train Loss: 1.6637 | Train Acc: 0.4293
Average Train Accuracy: 0.7689
 Site-MNIST                         | Val  Loss: 0.3646 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.3753 | Val  Acc: 0.9167
 Site-MNIST                         | Val  Loss: 0.4228 | Val  Acc: 0.9206
 Site-MNIST                         | Val  Loss: 0.4660 | Val  Acc: 0.8842
 Site-MNIST                         | Val  Loss: 0.4657 | Val  Acc: 0.8702
 Site-USPS                          | Val  Loss: 0.3673 | Val  Acc: 0.9135
 Site-USPS                          | Val  Loss: 0.4802 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.5184 | Val  Acc: 0.8632
 Site-SynthDigits                   | Val  Loss: 1.2744 | Val  Acc: 0.6212
 Site-SynthDigits                   | Val  Loss: 0.9082 | Val  Acc: 0.6717
 Site-MNIST_M                       | Val  Loss: 1.2024 | Val  Acc: 0.6705
 Site-MNIST_M                       | Val  Loss: 1.3767 | Val  Acc: 0.5985
 Site-SVHN                          | Val  Loss: 1.7434 | Val  Acc: 0.3973
Average Valid Accuracy: 0.7799
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9167
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9206
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8842
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8702
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9135
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8654
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8632
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.6212
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.6717
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.6705
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.5985
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.3973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.4407 | Train Acc: 0.9022
 Site-MNIST                         | Train Loss: 0.4540 | Train Acc: 0.8787
 Site-MNIST                         | Train Loss: 0.4726 | Train Acc: 0.8738
 Site-MNIST                         | Train Loss: 0.4359 | Train Acc: 0.8883
 Site-MNIST                         | Train Loss: 0.4189 | Train Acc: 0.9046
 Site-USPS                          | Train Loss: 0.4916 | Train Acc: 0.8825
 Site-USPS                          | Train Loss: 0.4266 | Train Acc: 0.8930
 Site-USPS                          | Train Loss: 0.4322 | Train Acc: 0.8946
 Site-SynthDigits                   | Train Loss: 1.1109 | Train Acc: 0.6477
 Site-SynthDigits                   | Train Loss: 1.0187 | Train Acc: 0.6932
 Site-MNIST_M                       | Train Loss: 1.3638 | Train Acc: 0.5682
 Site-MNIST_M                       | Train Loss: 1.4594 | Train Acc: 0.5436
 Site-SVHN                          | Train Loss: 1.6803 | Train Acc: 0.4242
Average Train Accuracy: 0.7688
 Site-MNIST                         | Val  Loss: 0.3570 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.3667 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4123 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4551 | Val  Acc: 0.8842
 Site-MNIST                         | Val  Loss: 0.4538 | Val  Acc: 0.8737
 Site-USPS                          | Val  Loss: 0.3615 | Val  Acc: 0.9135
 Site-USPS                          | Val  Loss: 0.4729 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.5104 | Val  Acc: 0.8632
 Site-SynthDigits                   | Val  Loss: 1.2682 | Val  Acc: 0.6212
 Site-SynthDigits                   | Val  Loss: 0.8998 | Val  Acc: 0.6667
 Site-MNIST_M                       | Val  Loss: 1.1873 | Val  Acc: 0.6705
 Site-MNIST_M                       | Val  Loss: 1.3557 | Val  Acc: 0.5985
 Site-SVHN                          | Val  Loss: 1.7399 | Val  Acc: 0.3973
Average Valid Accuracy: 0.7814
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8842
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8737
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9135
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8654
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8632
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.6212
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.6667
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.6705
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.5985
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.3973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.4277 | Train Acc: 0.9111
 Site-MNIST                         | Train Loss: 0.4445 | Train Acc: 0.8787
 Site-MNIST                         | Train Loss: 0.4658 | Train Acc: 0.8718
 Site-MNIST                         | Train Loss: 0.4287 | Train Acc: 0.8922
 Site-MNIST                         | Train Loss: 0.4125 | Train Acc: 0.9081
 Site-USPS                          | Train Loss: 0.5025 | Train Acc: 0.8801
 Site-USPS                          | Train Loss: 0.4221 | Train Acc: 0.8930
 Site-USPS                          | Train Loss: 0.4310 | Train Acc: 0.8935
 Site-SynthDigits                   | Train Loss: 1.0751 | Train Acc: 0.6572
 Site-SynthDigits                   | Train Loss: 1.0135 | Train Acc: 0.6932
 Site-MNIST_M                       | Train Loss: 1.3426 | Train Acc: 0.5710
 Site-MNIST_M                       | Train Loss: 1.4264 | Train Acc: 0.5473
 Site-SVHN                          | Train Loss: 1.6378 | Train Acc: 0.4344
Average Train Accuracy: 0.7717
 Site-MNIST                         | Val  Loss: 0.3476 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.3563 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4087 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4480 | Val  Acc: 0.8842
 Site-MNIST                         | Val  Loss: 0.4454 | Val  Acc: 0.8737
 Site-USPS                          | Val  Loss: 0.3565 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.4694 | Val  Acc: 0.8718
 Site-USPS                          | Val  Loss: 0.5091 | Val  Acc: 0.8632
 Site-SynthDigits                   | Val  Loss: 1.2512 | Val  Acc: 0.6288
 Site-SynthDigits                   | Val  Loss: 0.8882 | Val  Acc: 0.6717
 Site-MNIST_M                       | Val  Loss: 1.1768 | Val  Acc: 0.6705
 Site-MNIST_M                       | Val  Loss: 1.3462 | Val  Acc: 0.5909
 Site-SVHN                          | Val  Loss: 1.7248 | Val  Acc: 0.4041
Average Valid Accuracy: 0.7835
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8842
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8737
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:44 | Val Acc: 0.8718
 Best site-USPS                      | Epoch:44 | Val Acc: 0.8632
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.6288
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.6717
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.6705
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.5909
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.4041
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.4303 | Train Acc: 0.9022
 Site-MNIST                         | Train Loss: 0.4475 | Train Acc: 0.8817
 Site-MNIST                         | Train Loss: 0.4596 | Train Acc: 0.8757
 Site-MNIST                         | Train Loss: 0.4243 | Train Acc: 0.8922
 Site-MNIST                         | Train Loss: 0.4071 | Train Acc: 0.9063
 Site-USPS                          | Train Loss: 0.4907 | Train Acc: 0.8849
 Site-USPS                          | Train Loss: 0.4192 | Train Acc: 0.8946
 Site-USPS                          | Train Loss: 0.4259 | Train Acc: 0.8935
 Site-SynthDigits                   | Train Loss: 1.0605 | Train Acc: 0.6629
 Site-SynthDigits                   | Train Loss: 1.0029 | Train Acc: 0.7020
 Site-MNIST_M                       | Train Loss: 1.3454 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.4242 | Train Acc: 0.5473
 Site-SVHN                          | Train Loss: 1.6639 | Train Acc: 0.4276
Average Train Accuracy: 0.7731
 Site-MNIST                         | Val  Loss: 0.3470 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.3519 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4023 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4417 | Val  Acc: 0.8895
 Site-MNIST                         | Val  Loss: 0.4398 | Val  Acc: 0.8737
 Site-USPS                          | Val  Loss: 0.3538 | Val  Acc: 0.9135
 Site-USPS                          | Val  Loss: 0.4639 | Val  Acc: 0.8654
 Site-USPS                          | Val  Loss: 0.5019 | Val  Acc: 0.8675
 Site-SynthDigits                   | Val  Loss: 1.2507 | Val  Acc: 0.6364
 Site-SynthDigits                   | Val  Loss: 0.8770 | Val  Acc: 0.6768
 Site-MNIST_M                       | Val  Loss: 1.1611 | Val  Acc: 0.6818
 Site-MNIST_M                       | Val  Loss: 1.3333 | Val  Acc: 0.6136
 Site-SVHN                          | Val  Loss: 1.7261 | Val  Acc: 0.3973
Average Valid Accuracy: 0.7874
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.8895
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.8737
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9135
 Best site-USPS                      | Epoch:45 | Val Acc: 0.8654
 Best site-USPS                      | Epoch:45 | Val Acc: 0.8675
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.6364
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.6768
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.6818
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.6136
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.3973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.4238 | Train Acc: 0.8978
 Site-MNIST                         | Train Loss: 0.4158 | Train Acc: 0.8817
 Site-MNIST                         | Train Loss: 0.4488 | Train Acc: 0.8797
 Site-MNIST                         | Train Loss: 0.4126 | Train Acc: 0.8936
 Site-MNIST                         | Train Loss: 0.3985 | Train Acc: 0.9098
 Site-USPS                          | Train Loss: 0.4918 | Train Acc: 0.8849
 Site-USPS                          | Train Loss: 0.4063 | Train Acc: 0.8978
 Site-USPS                          | Train Loss: 0.4075 | Train Acc: 0.9020
 Site-SynthDigits                   | Train Loss: 1.1023 | Train Acc: 0.6591
 Site-SynthDigits                   | Train Loss: 0.9936 | Train Acc: 0.7045
 Site-MNIST_M                       | Train Loss: 1.3606 | Train Acc: 0.5881
 Site-MNIST_M                       | Train Loss: 1.4083 | Train Acc: 0.5511
 Site-SVHN                          | Train Loss: 1.6792 | Train Acc: 0.4327
Average Train Accuracy: 0.7756
 Site-MNIST                         | Val  Loss: 0.3357 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.3437 | Val  Acc: 0.9405
 Site-MNIST                         | Val  Loss: 0.3951 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4317 | Val  Acc: 0.8842
 Site-MNIST                         | Val  Loss: 0.4310 | Val  Acc: 0.8737
 Site-USPS                          | Val  Loss: 0.3397 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.4538 | Val  Acc: 0.8718
 Site-USPS                          | Val  Loss: 0.4941 | Val  Acc: 0.8675
 Site-SynthDigits                   | Val  Loss: 1.2389 | Val  Acc: 0.6364
 Site-SynthDigits                   | Val  Loss: 0.8746 | Val  Acc: 0.6768
 Site-MNIST_M                       | Val  Loss: 1.1539 | Val  Acc: 0.6932
 Site-MNIST_M                       | Val  Loss: 1.3237 | Val  Acc: 0.6061
 Site-SVHN                          | Val  Loss: 1.7131 | Val  Acc: 0.3973
Average Valid Accuracy: 0.7895
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9405
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.8842
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.8737
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:46 | Val Acc: 0.8718
 Best site-USPS                      | Epoch:46 | Val Acc: 0.8675
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.6364
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.6768
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.6932
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.6061
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.3973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.4008 | Train Acc: 0.8978
 Site-MNIST                         | Train Loss: 0.4384 | Train Acc: 0.8846
 Site-MNIST                         | Train Loss: 0.4507 | Train Acc: 0.8777
 Site-MNIST                         | Train Loss: 0.4124 | Train Acc: 0.8949
 Site-MNIST                         | Train Loss: 0.3981 | Train Acc: 0.9089
 Site-USPS                          | Train Loss: 0.4816 | Train Acc: 0.8825
 Site-USPS                          | Train Loss: 0.4161 | Train Acc: 0.8946
 Site-USPS                          | Train Loss: 0.4221 | Train Acc: 0.8914
 Site-SynthDigits                   | Train Loss: 1.0393 | Train Acc: 0.6723
 Site-SynthDigits                   | Train Loss: 0.9857 | Train Acc: 0.7172
 Site-MNIST_M                       | Train Loss: 1.3531 | Train Acc: 0.5739
 Site-MNIST_M                       | Train Loss: 1.4052 | Train Acc: 0.5644
 Site-SVHN                          | Train Loss: 1.6680 | Train Acc: 0.4361
Average Train Accuracy: 0.7766
 Site-MNIST                         | Val  Loss: 0.3294 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.3414 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3994 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4357 | Val  Acc: 0.9000
 Site-MNIST                         | Val  Loss: 0.4328 | Val  Acc: 0.8772
 Site-USPS                          | Val  Loss: 0.3500 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.4591 | Val  Acc: 0.8782
 Site-USPS                          | Val  Loss: 0.4967 | Val  Acc: 0.8632
 Site-SynthDigits                   | Val  Loss: 1.2343 | Val  Acc: 0.6591
 Site-SynthDigits                   | Val  Loss: 0.8574 | Val  Acc: 0.6970
 Site-MNIST_M                       | Val  Loss: 1.1487 | Val  Acc: 0.6705
 Site-MNIST_M                       | Val  Loss: 1.3231 | Val  Acc: 0.5833
 Site-SVHN                          | Val  Loss: 1.7148 | Val  Acc: 0.4041
Average Valid Accuracy: 0.7892
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.4260 | Train Acc: 0.9067
 Site-MNIST                         | Train Loss: 0.4136 | Train Acc: 0.8876
 Site-MNIST                         | Train Loss: 0.4371 | Train Acc: 0.8817
 Site-MNIST                         | Train Loss: 0.3992 | Train Acc: 0.8988
 Site-MNIST                         | Train Loss: 0.3871 | Train Acc: 0.9116
 Site-USPS                          | Train Loss: 0.4815 | Train Acc: 0.8873
 Site-USPS                          | Train Loss: 0.3943 | Train Acc: 0.8994
 Site-USPS                          | Train Loss: 0.3962 | Train Acc: 0.9052
 Site-SynthDigits                   | Train Loss: 1.0582 | Train Acc: 0.6667
 Site-SynthDigits                   | Train Loss: 0.9754 | Train Acc: 0.7058
 Site-MNIST_M                       | Train Loss: 1.3453 | Train Acc: 0.5739
 Site-MNIST_M                       | Train Loss: 1.3902 | Train Acc: 0.5606
 Site-SVHN                          | Train Loss: 1.6015 | Train Acc: 0.4395
Average Train Accuracy: 0.7788
 Site-MNIST                         | Val  Loss: 0.3255 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.3298 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.3829 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4211 | Val  Acc: 0.8947
 Site-MNIST                         | Val  Loss: 0.4180 | Val  Acc: 0.8807
 Site-USPS                          | Val  Loss: 0.3293 | Val  Acc: 0.9231
 Site-USPS                          | Val  Loss: 0.4393 | Val  Acc: 0.8718
 Site-USPS                          | Val  Loss: 0.4810 | Val  Acc: 0.8675
 Site-SynthDigits                   | Val  Loss: 1.2356 | Val  Acc: 0.6439
 Site-SynthDigits                   | Val  Loss: 0.8651 | Val  Acc: 0.6869
 Site-MNIST_M                       | Val  Loss: 1.1358 | Val  Acc: 0.6705
 Site-MNIST_M                       | Val  Loss: 1.3092 | Val  Acc: 0.5985
 Site-SVHN                          | Val  Loss: 1.6926 | Val  Acc: 0.3973
Average Valid Accuracy: 0.7903
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.8947
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.8807
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9231
 Best site-USPS                      | Epoch:48 | Val Acc: 0.8718
 Best site-USPS                      | Epoch:48 | Val Acc: 0.8675
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.6439
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.6869
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.6705
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.5985
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.3973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.3998 | Train Acc: 0.9156
 Site-MNIST                         | Train Loss: 0.3980 | Train Acc: 0.8905
 Site-MNIST                         | Train Loss: 0.4311 | Train Acc: 0.8856
 Site-MNIST                         | Train Loss: 0.3956 | Train Acc: 0.8988
 Site-MNIST                         | Train Loss: 0.3780 | Train Acc: 0.9151
 Site-USPS                          | Train Loss: 0.4612 | Train Acc: 0.8897
 Site-USPS                          | Train Loss: 0.3882 | Train Acc: 0.8994
 Site-USPS                          | Train Loss: 0.3915 | Train Acc: 0.9052
 Site-SynthDigits                   | Train Loss: 1.0404 | Train Acc: 0.6705
 Site-SynthDigits                   | Train Loss: 0.9666 | Train Acc: 0.7083
 Site-MNIST_M                       | Train Loss: 1.3155 | Train Acc: 0.5824
 Site-MNIST_M                       | Train Loss: 1.3727 | Train Acc: 0.5663
 Site-SVHN                          | Train Loss: 1.6240 | Train Acc: 0.4395
Average Train Accuracy: 0.7821
 Site-MNIST                         | Val  Loss: 0.3174 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.3264 | Val  Acc: 0.9524
 Site-MNIST                         | Val  Loss: 0.3791 | Val  Acc: 0.9286
 Site-MNIST                         | Val  Loss: 0.4180 | Val  Acc: 0.9053
 Site-MNIST                         | Val  Loss: 0.4144 | Val  Acc: 0.8842
 Site-USPS                          | Val  Loss: 0.3216 | Val  Acc: 0.9135
 Site-USPS                          | Val  Loss: 0.4329 | Val  Acc: 0.8718
 Site-USPS                          | Val  Loss: 0.4734 | Val  Acc: 0.8675
 Site-SynthDigits                   | Val  Loss: 1.2281 | Val  Acc: 0.6515
 Site-SynthDigits                   | Val  Loss: 0.8596 | Val  Acc: 0.6970
 Site-MNIST_M                       | Val  Loss: 1.1316 | Val  Acc: 0.6818
 Site-MNIST_M                       | Val  Loss: 1.3023 | Val  Acc: 0.5985
 Site-SVHN                          | Val  Loss: 1.6941 | Val  Acc: 0.4178
Average Valid Accuracy: 0.7963
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9524
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9286
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9053
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8842
 Best site-USPS                      | Epoch:49 | Val Acc: 0.9135
 Best site-USPS                      | Epoch:49 | Val Acc: 0.8718
 Best site-USPS                      | Epoch:49 | Val Acc: 0.8675
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.6515
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.6970
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.6818
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.5985
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.4178
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_2/afl...
===2023-07-27 14:51:35===
===2023-07-27 14:51:38===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.8877
 Test site-USPS                      | Epoch:49 | Test Acc: 0.8978
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.6644
 Test site-MNIST_M                   | Epoch:49 | Test Acc: 0.4941
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.3539
MNIST: 0.8877, USPS: 0.8978, SynthDigits: 0.6644, MNIST_M: 0.4941, SVHN: 0.3539, 
Average Test Accuracy(group): 0.6596, Average Test Accuracy(individual): 0.7541,
domain std=0.2143, cluster std=-1.0000, individual std=0.1886, 
