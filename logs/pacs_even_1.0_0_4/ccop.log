===2023-08-17 08:27:12===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
============ Train epoch 0 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (3) | Train Loss: 1.4508 | Train Acc: 0.4867
 Site-photo                     (3) | Train Loss: 1.4463 | Train Acc: 0.4489
 Site-art_painting              (1) | Train Loss: 1.6422 | Train Acc: 0.3333
 Site-art_painting              (1) | Train Loss: 1.6162 | Train Acc: 0.3533
 Site-cartoon                   (2) | Train Loss: 1.6808 | Train Acc: 0.2867
 Site-cartoon                   (2) | Train Loss: 1.6717 | Train Acc: 0.2556
 Site-sketch                    (0) | Train Loss: 1.7390 | Train Acc: 0.2200
 Site-sketch                    (0) | Train Loss: 1.8197 | Train Acc: 0.2133
Average Train Accuracy: 0.3247
 Best site-photo                     | Epoch:0 | Val Acc: 0.4867
 Best site-photo                     | Epoch:0 | Val Acc: 0.4489
 Best site-art_painting              | Epoch:0 | Val Acc: 0.3333
 Best site-art_painting              | Epoch:0 | Val Acc: 0.3533
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.2867
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.2556
 Best site-sketch                    | Epoch:0 | Val Acc: 0.2200
 Best site-sketch                    | Epoch:0 | Val Acc: 0.2133
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (0) | Train Loss: 1.0391 | Train Acc: 0.8933
 Site-photo                     (0) | Train Loss: 1.0783 | Train Acc: 0.8578
 Site-art_painting              (3) | Train Loss: 1.3832 | Train Acc: 0.6200
 Site-art_painting              (3) | Train Loss: 1.3273 | Train Acc: 0.6889
 Site-cartoon                   (2) | Train Loss: 1.3669 | Train Acc: 0.5333
 Site-cartoon                   (2) | Train Loss: 1.3159 | Train Acc: 0.6133
 Site-sketch                    (1) | Train Loss: 1.4449 | Train Acc: 0.5333
 Site-sketch                    (1) | Train Loss: 1.4809 | Train Acc: 0.4911
Average Train Accuracy: 0.6539
 Best site-photo                     | Epoch:1 | Val Acc: 0.8933
 Best site-photo                     | Epoch:1 | Val Acc: 0.8578
 Best site-art_painting              | Epoch:1 | Val Acc: 0.6200
 Best site-art_painting              | Epoch:1 | Val Acc: 0.6889
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.5333
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.6133
 Best site-sketch                    | Epoch:1 | Val Acc: 0.5333
 Best site-sketch                    | Epoch:1 | Val Acc: 0.4911
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (0) | Train Loss: 0.7253 | Train Acc: 0.9467
 Site-photo                     (0) | Train Loss: 0.7008 | Train Acc: 0.9600
 Site-art_painting              (3) | Train Loss: 1.0696 | Train Acc: 0.7400
 Site-art_painting              (3) | Train Loss: 0.9706 | Train Acc: 0.8067
 Site-cartoon                   (2) | Train Loss: 1.1053 | Train Acc: 0.6933
 Site-cartoon                   (2) | Train Loss: 1.0443 | Train Acc: 0.7756
 Site-sketch                    (1) | Train Loss: 1.2208 | Train Acc: 0.5933
 Site-sketch                    (1) | Train Loss: 1.2425 | Train Acc: 0.5844
Average Train Accuracy: 0.7625
 Best site-photo                     | Epoch:2 | Val Acc: 0.9467
 Best site-photo                     | Epoch:2 | Val Acc: 0.9600
 Best site-art_painting              | Epoch:2 | Val Acc: 0.7400
 Best site-art_painting              | Epoch:2 | Val Acc: 0.8067
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.6933
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.7756
 Best site-sketch                    | Epoch:2 | Val Acc: 0.5933
 Best site-sketch                    | Epoch:2 | Val Acc: 0.5844
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 3 ============
cnt=[4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (0) | Train Loss: 0.5622 | Train Acc: 0.9800
 Site-photo                     (0) | Train Loss: 0.5300 | Train Acc: 0.9667
 Site-art_painting              (0) | Train Loss: 0.9050 | Train Acc: 0.7667
 Site-art_painting              (0) | Train Loss: 0.7835 | Train Acc: 0.8311
 Site-cartoon                   (2) | Train Loss: 0.9295 | Train Acc: 0.7267
 Site-cartoon                   (2) | Train Loss: 0.9284 | Train Acc: 0.7533
 Site-sketch                    (1) | Train Loss: 0.9976 | Train Acc: 0.7000
 Site-sketch                    (3) | Train Loss: 0.9889 | Train Acc: 0.6778
Average Train Accuracy: 0.8003
 Best site-photo                     | Epoch:3 | Val Acc: 0.9800
 Best site-photo                     | Epoch:3 | Val Acc: 0.9667
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7667
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8311
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.7267
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.7533
 Best site-sketch                    | Epoch:3 | Val Acc: 0.7000
 Best site-sketch                    | Epoch:3 | Val Acc: 0.6778
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (2) | Train Loss: 0.4192 | Train Acc: 0.9667
 Site-photo                     (2) | Train Loss: 0.4049 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.7812 | Train Acc: 0.7867
 Site-art_painting              (2) | Train Loss: 0.6476 | Train Acc: 0.8600
 Site-cartoon                   (0) | Train Loss: 0.7736 | Train Acc: 0.7733
 Site-cartoon                   (0) | Train Loss: 0.6995 | Train Acc: 0.8333
 Site-sketch                    (1) | Train Loss: 0.8856 | Train Acc: 0.7267
 Site-sketch                    (1) | Train Loss: 0.8695 | Train Acc: 0.6956
Average Train Accuracy: 0.8272
 Best site-photo                     | Epoch:4 | Val Acc: 0.9667
 Best site-photo                     | Epoch:4 | Val Acc: 0.9756
 Best site-art_painting              | Epoch:4 | Val Acc: 0.7867
 Best site-art_painting              | Epoch:4 | Val Acc: 0.8600
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.7733
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.8333
 Best site-sketch                    | Epoch:4 | Val Acc: 0.7267
 Best site-sketch                    | Epoch:4 | Val Acc: 0.6956
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (1) | Train Loss: 0.3347 | Train Acc: 0.9867
 Site-photo                     (1) | Train Loss: 0.3264 | Train Acc: 0.9644
 Site-art_painting              (1) | Train Loss: 0.7358 | Train Acc: 0.7933
 Site-art_painting              (1) | Train Loss: 0.5774 | Train Acc: 0.8667
 Site-cartoon                   (2) | Train Loss: 0.7414 | Train Acc: 0.7600
 Site-cartoon                   (2) | Train Loss: 0.6584 | Train Acc: 0.8489
 Site-sketch                    (0) | Train Loss: 0.7470 | Train Acc: 0.7533
 Site-sketch                    (3) | Train Loss: 0.8239 | Train Acc: 0.7378
Average Train Accuracy: 0.8389
 Best site-photo                     | Epoch:5 | Val Acc: 0.9867
 Best site-photo                     | Epoch:5 | Val Acc: 0.9644
 Best site-art_painting              | Epoch:5 | Val Acc: 0.7933
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8667
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.7600
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.8489
 Best site-sketch                    | Epoch:5 | Val Acc: 0.7533
 Best site-sketch                    | Epoch:5 | Val Acc: 0.7378
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (2) | Train Loss: 0.2832 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.2535 | Train Acc: 0.9778
 Site-art_painting              (2) | Train Loss: 0.6247 | Train Acc: 0.8133
 Site-art_painting              (2) | Train Loss: 0.5443 | Train Acc: 0.8800
 Site-cartoon                   (0) | Train Loss: 0.6683 | Train Acc: 0.7733
 Site-cartoon                   (0) | Train Loss: 0.5447 | Train Acc: 0.8556
 Site-sketch                    (1) | Train Loss: 0.6939 | Train Acc: 0.7733
 Site-sketch                    (1) | Train Loss: 0.7546 | Train Acc: 0.7644
Average Train Accuracy: 0.8522
 Best site-photo                     | Epoch:6 | Val Acc: 0.9800
 Best site-photo                     | Epoch:6 | Val Acc: 0.9778
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8133
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8800
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.7733
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.8556
 Best site-sketch                    | Epoch:6 | Val Acc: 0.7733
 Best site-sketch                    | Epoch:6 | Val Acc: 0.7644
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (1) | Train Loss: 0.2494 | Train Acc: 0.9933
 Site-photo                     (1) | Train Loss: 0.2413 | Train Acc: 0.9711
 Site-art_painting              (1) | Train Loss: 0.5717 | Train Acc: 0.8267
 Site-art_painting              (1) | Train Loss: 0.4742 | Train Acc: 0.9000
 Site-cartoon                   (2) | Train Loss: 0.5991 | Train Acc: 0.8000
 Site-cartoon                   (2) | Train Loss: 0.5131 | Train Acc: 0.8356
 Site-sketch                    (3) | Train Loss: 0.6529 | Train Acc: 0.8000
 Site-sketch                    (0) | Train Loss: 0.6496 | Train Acc: 0.7800
Average Train Accuracy: 0.8633
 Best site-photo                     | Epoch:7 | Val Acc: 0.9933
 Best site-photo                     | Epoch:7 | Val Acc: 0.9711
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8267
 Best site-art_painting              | Epoch:7 | Val Acc: 0.9000
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.8000
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.8356
 Best site-sketch                    | Epoch:7 | Val Acc: 0.8000
 Best site-sketch                    | Epoch:7 | Val Acc: 0.7800
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 8 ============
cnt=[4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (0) | Train Loss: 0.2162 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.2113 | Train Acc: 0.9822
 Site-art_painting              (0) | Train Loss: 0.5876 | Train Acc: 0.8400
 Site-art_painting              (0) | Train Loss: 0.5560 | Train Acc: 0.8733
 Site-cartoon                   (2) | Train Loss: 0.5477 | Train Acc: 0.8200
 Site-cartoon                   (2) | Train Loss: 0.4807 | Train Acc: 0.8267
 Site-sketch                    (3) | Train Loss: 0.5954 | Train Acc: 0.7800
 Site-sketch                    (1) | Train Loss: 0.6314 | Train Acc: 0.7956
Average Train Accuracy: 0.8631
============ Train epoch 9 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (3) | Train Loss: 0.2174 | Train Acc: 0.9733
 Site-photo                     (0) | Train Loss: 0.1908 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.4994 | Train Acc: 0.8400
 Site-art_painting              (0) | Train Loss: 0.3984 | Train Acc: 0.9133
 Site-cartoon                   (2) | Train Loss: 0.5326 | Train Acc: 0.8200
 Site-cartoon                   (2) | Train Loss: 0.4660 | Train Acc: 0.8467
 Site-sketch                    (1) | Train Loss: 0.6491 | Train Acc: 0.7800
 Site-sketch                    (1) | Train Loss: 0.5819 | Train Acc: 0.7933
Average Train Accuracy: 0.8678
 Best site-photo                     | Epoch:9 | Val Acc: 0.9733
 Best site-photo                     | Epoch:9 | Val Acc: 0.9756
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8400
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9133
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.8200
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.8467
 Best site-sketch                    | Epoch:9 | Val Acc: 0.7800
 Best site-sketch                    | Epoch:9 | Val Acc: 0.7933
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 10 ============
cnt=[2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (3) | Train Loss: 0.1844 | Train Acc: 0.9867
 Site-photo                     (2) | Train Loss: 0.1900 | Train Acc: 0.9800
 Site-art_painting              (2) | Train Loss: 0.5354 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 0.4373 | Train Acc: 0.8822
 Site-cartoon                   (0) | Train Loss: 0.5245 | Train Acc: 0.8533
 Site-cartoon                   (0) | Train Loss: 0.4292 | Train Acc: 0.8622
 Site-sketch                    (1) | Train Loss: 0.5619 | Train Acc: 0.7867
 Site-sketch                    (1) | Train Loss: 0.5585 | Train Acc: 0.8222
Average Train Accuracy: 0.8758
 Best site-photo                     | Epoch:10 | Val Acc: 0.9867
 Best site-photo                     | Epoch:10 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8822
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.8533
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.8622
 Best site-sketch                    | Epoch:10 | Val Acc: 0.7867
 Best site-sketch                    | Epoch:10 | Val Acc: 0.8222
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (2) | Train Loss: 0.1781 | Train Acc: 0.9800
 Site-photo                     (2) | Train Loss: 0.1752 | Train Acc: 0.9800
 Site-art_painting              (2) | Train Loss: 0.5232 | Train Acc: 0.8400
 Site-art_painting              (2) | Train Loss: 0.3772 | Train Acc: 0.8978
 Site-cartoon                   (0) | Train Loss: 0.4864 | Train Acc: 0.8533
 Site-cartoon                   (0) | Train Loss: 0.4026 | Train Acc: 0.8711
 Site-sketch                    (1) | Train Loss: 0.5449 | Train Acc: 0.8267
 Site-sketch                    (3) | Train Loss: 0.5159 | Train Acc: 0.8111
Average Train Accuracy: 0.8825
 Best site-photo                     | Epoch:11 | Val Acc: 0.9800
 Best site-photo                     | Epoch:11 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8400
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8978
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.8533
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.8711
 Best site-sketch                    | Epoch:11 | Val Acc: 0.8267
 Best site-sketch                    | Epoch:11 | Val Acc: 0.8111
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (3) | Train Loss: 0.1823 | Train Acc: 0.9800
 Site-photo                     (0) | Train Loss: 0.2237 | Train Acc: 0.9800
 Site-art_painting              (3) | Train Loss: 0.4506 | Train Acc: 0.8733
 Site-art_painting              (0) | Train Loss: 0.4495 | Train Acc: 0.9000
 Site-cartoon                   (2) | Train Loss: 0.4931 | Train Acc: 0.8267
 Site-cartoon                   (2) | Train Loss: 0.4089 | Train Acc: 0.8756
 Site-sketch                    (1) | Train Loss: 0.5152 | Train Acc: 0.8067
 Site-sketch                    (1) | Train Loss: 0.5112 | Train Acc: 0.8267
Average Train Accuracy: 0.8836
 Best site-photo                     | Epoch:12 | Val Acc: 0.9800
 Best site-photo                     | Epoch:12 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8733
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9000
 Best site-cartoon                   | Epoch:12 | Val Acc: 0.8267
 Best site-cartoon                   | Epoch:12 | Val Acc: 0.8756
 Best site-sketch                    | Epoch:12 | Val Acc: 0.8067
 Best site-sketch                    | Epoch:12 | Val Acc: 0.8267
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 13 ============
cnt=[1, 2, 2, 3, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (3) | Train Loss: 0.1573 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.1415 | Train Acc: 0.9800
 Site-art_painting              (0) | Train Loss: 0.4635 | Train Acc: 0.8400
 Site-art_painting              (3) | Train Loss: 0.3545 | Train Acc: 0.9178
 Site-cartoon                   (2) | Train Loss: 0.4831 | Train Acc: 0.8533
 Site-cartoon                   (2) | Train Loss: 0.4254 | Train Acc: 0.8822
 Site-sketch                    (1) | Train Loss: 0.4894 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.5427 | Train Acc: 0.8089
Average Train Accuracy: 0.8861
 Best site-photo                     | Epoch:13 | Val Acc: 0.9867
 Best site-photo                     | Epoch:13 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:13 | Val Acc: 0.8400
 Best site-art_painting              | Epoch:13 | Val Acc: 0.9178
 Best site-cartoon                   | Epoch:13 | Val Acc: 0.8533
 Best site-cartoon                   | Epoch:13 | Val Acc: 0.8822
 Best site-sketch                    | Epoch:13 | Val Acc: 0.8200
 Best site-sketch                    | Epoch:13 | Val Acc: 0.8089
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 14 ============
cnt=[4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (0) | Train Loss: 0.1597 | Train Acc: 0.9800
 Site-photo                     (0) | Train Loss: 0.1519 | Train Acc: 0.9711
 Site-art_painting              (0) | Train Loss: 0.4605 | Train Acc: 0.8533
 Site-art_painting              (0) | Train Loss: 0.3956 | Train Acc: 0.8844
 Site-cartoon                   (2) | Train Loss: 0.4750 | Train Acc: 0.8600
 Site-cartoon                   (3) | Train Loss: 0.3715 | Train Acc: 0.8822
 Site-sketch                    (1) | Train Loss: 0.5079 | Train Acc: 0.7933
 Site-sketch                    (1) | Train Loss: 0.4894 | Train Acc: 0.8244
Average Train Accuracy: 0.8811
============ Train epoch 15 ============
cnt=[4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (0) | Train Loss: 0.1605 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.1382 | Train Acc: 0.9800
 Site-art_painting              (0) | Train Loss: 0.3660 | Train Acc: 0.8667
 Site-art_painting              (0) | Train Loss: 0.3152 | Train Acc: 0.9222
 Site-cartoon                   (2) | Train Loss: 0.4404 | Train Acc: 0.8467
 Site-cartoon                   (2) | Train Loss: 0.3655 | Train Acc: 0.8689
 Site-sketch                    (3) | Train Loss: 0.5099 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.5258 | Train Acc: 0.8289
Average Train Accuracy: 0.8900
 Best site-photo                     | Epoch:15 | Val Acc: 0.9867
 Best site-photo                     | Epoch:15 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:15 | Val Acc: 0.9222
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.8467
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.8689
 Best site-sketch                    | Epoch:15 | Val Acc: 0.8200
 Best site-sketch                    | Epoch:15 | Val Acc: 0.8289
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 16 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (3) | Train Loss: 0.1374 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.1249 | Train Acc: 0.9800
 Site-art_painting              (0) | Train Loss: 0.3548 | Train Acc: 0.8933
 Site-art_painting              (0) | Train Loss: 0.3369 | Train Acc: 0.9156
 Site-cartoon                   (2) | Train Loss: 0.5266 | Train Acc: 0.8267
 Site-cartoon                   (2) | Train Loss: 0.4461 | Train Acc: 0.8867
 Site-sketch                    (1) | Train Loss: 0.4897 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.4377 | Train Acc: 0.8444
Average Train Accuracy: 0.8933
 Best site-photo                     | Epoch:16 | Val Acc: 0.9800
 Best site-photo                     | Epoch:16 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8933
 Best site-art_painting              | Epoch:16 | Val Acc: 0.9156
 Best site-cartoon                   | Epoch:16 | Val Acc: 0.8267
 Best site-cartoon                   | Epoch:16 | Val Acc: 0.8867
 Best site-sketch                    | Epoch:16 | Val Acc: 0.8200
 Best site-sketch                    | Epoch:16 | Val Acc: 0.8444
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 17 ============
cnt=[2, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (2) | Train Loss: 0.1516 | Train Acc: 0.9733
 Site-photo                     (2) | Train Loss: 0.1273 | Train Acc: 0.9800
 Site-art_painting              (2) | Train Loss: 0.3888 | Train Acc: 0.8800
 Site-art_painting              (2) | Train Loss: 0.3435 | Train Acc: 0.9089
 Site-cartoon                   (0) | Train Loss: 0.3738 | Train Acc: 0.8733
 Site-cartoon                   (0) | Train Loss: 0.3205 | Train Acc: 0.9000
 Site-sketch                    (3) | Train Loss: 0.4896 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.4495 | Train Acc: 0.8289
Average Train Accuracy: 0.8956
 Best site-photo                     | Epoch:17 | Val Acc: 0.9733
 Best site-photo                     | Epoch:17 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8800
 Best site-art_painting              | Epoch:17 | Val Acc: 0.9089
 Best site-cartoon                   | Epoch:17 | Val Acc: 0.8733
 Best site-cartoon                   | Epoch:17 | Val Acc: 0.9000
 Best site-sketch                    | Epoch:17 | Val Acc: 0.8200
 Best site-sketch                    | Epoch:17 | Val Acc: 0.8289
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 18 ============
cnt=[4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (0) | Train Loss: 0.1681 | Train Acc: 0.9733
 Site-photo                     (0) | Train Loss: 0.1346 | Train Acc: 0.9800
 Site-art_painting              (0) | Train Loss: 0.3927 | Train Acc: 0.8667
 Site-art_painting              (0) | Train Loss: 0.3088 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.3976 | Train Acc: 0.8600
 Site-cartoon                   (2) | Train Loss: 0.3319 | Train Acc: 0.9000
 Site-sketch                    (1) | Train Loss: 0.4472 | Train Acc: 0.8533
 Site-sketch                    (3) | Train Loss: 0.4515 | Train Acc: 0.8556
Average Train Accuracy: 0.9011
 Best site-photo                     | Epoch:18 | Val Acc: 0.9733
 Best site-photo                     | Epoch:18 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:18 | Val Acc: 0.9200
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.8600
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.9000
 Best site-sketch                    | Epoch:18 | Val Acc: 0.8533
 Best site-sketch                    | Epoch:18 | Val Acc: 0.8556
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (0) | Train Loss: 0.1311 | Train Acc: 0.9733
 Site-photo                     (0) | Train Loss: 0.1117 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.4059 | Train Acc: 0.8667
 Site-art_painting              (3) | Train Loss: 0.2823 | Train Acc: 0.9178
 Site-cartoon                   (2) | Train Loss: 0.3651 | Train Acc: 0.8600
 Site-cartoon                   (2) | Train Loss: 0.3380 | Train Acc: 0.9044
 Site-sketch                    (1) | Train Loss: 0.4355 | Train Acc: 0.8867
 Site-sketch                    (1) | Train Loss: 0.3949 | Train Acc: 0.8622
Average Train Accuracy: 0.9058
 Best site-photo                     | Epoch:19 | Val Acc: 0.9733
 Best site-photo                     | Epoch:19 | Val Acc: 0.9756
 Best site-art_painting              | Epoch:19 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:19 | Val Acc: 0.9178
 Best site-cartoon                   | Epoch:19 | Val Acc: 0.8600
 Best site-cartoon                   | Epoch:19 | Val Acc: 0.9044
 Best site-sketch                    | Epoch:19 | Val Acc: 0.8867
 Best site-sketch                    | Epoch:19 | Val Acc: 0.8622
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 20 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (3) | Train Loss: 0.1380 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.1209 | Train Acc: 0.9844
 Site-art_painting              (0) | Train Loss: 0.3738 | Train Acc: 0.8600
 Site-art_painting              (0) | Train Loss: 0.2706 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.3608 | Train Acc: 0.8733
 Site-cartoon                   (2) | Train Loss: 0.3120 | Train Acc: 0.8978
 Site-sketch                    (1) | Train Loss: 0.4596 | Train Acc: 0.8267
 Site-sketch                    (1) | Train Loss: 0.4132 | Train Acc: 0.8356
Average Train Accuracy: 0.8972
============ Train epoch 21 ============
cnt=[1, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (1) | Train Loss: 0.1363 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.1306 | Train Acc: 0.9778
 Site-art_painting              (1) | Train Loss: 0.3808 | Train Acc: 0.8867
 Site-art_painting              (1) | Train Loss: 0.3387 | Train Acc: 0.9222
 Site-cartoon                   (2) | Train Loss: 0.3577 | Train Acc: 0.8800
 Site-cartoon                   (2) | Train Loss: 0.3016 | Train Acc: 0.9111
 Site-sketch                    (3) | Train Loss: 0.4139 | Train Acc: 0.8667
 Site-sketch                    (0) | Train Loss: 0.4767 | Train Acc: 0.8600
Average Train Accuracy: 0.9106
 Best site-photo                     | Epoch:21 | Val Acc: 0.9800
 Best site-photo                     | Epoch:21 | Val Acc: 0.9778
 Best site-art_painting              | Epoch:21 | Val Acc: 0.8867
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9222
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.8800
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.9111
 Best site-sketch                    | Epoch:21 | Val Acc: 0.8667
 Best site-sketch                    | Epoch:21 | Val Acc: 0.8600
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (3) | Train Loss: 0.1441 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.1173 | Train Acc: 0.9800
 Site-art_painting              (0) | Train Loss: 0.3743 | Train Acc: 0.8667
 Site-art_painting              (0) | Train Loss: 0.2938 | Train Acc: 0.9244
 Site-cartoon                   (2) | Train Loss: 0.3657 | Train Acc: 0.8733
 Site-cartoon                   (2) | Train Loss: 0.3672 | Train Acc: 0.8867
 Site-sketch                    (1) | Train Loss: 0.4605 | Train Acc: 0.8400
 Site-sketch                    (1) | Train Loss: 0.4389 | Train Acc: 0.8467
Average Train Accuracy: 0.8997
============ Train epoch 23 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (3) | Train Loss: 0.1168 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.1029 | Train Acc: 0.9756
 Site-art_painting              (2) | Train Loss: 0.3449 | Train Acc: 0.9067
 Site-art_painting              (2) | Train Loss: 0.2628 | Train Acc: 0.9178
 Site-cartoon                   (0) | Train Loss: 0.3469 | Train Acc: 0.8800
 Site-cartoon                   (0) | Train Loss: 0.3239 | Train Acc: 0.9044
 Site-sketch                    (1) | Train Loss: 0.4676 | Train Acc: 0.8467
 Site-sketch                    (1) | Train Loss: 0.4411 | Train Acc: 0.8622
Average Train Accuracy: 0.9092
============ Train epoch 24 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (3) | Train Loss: 0.1132 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.1037 | Train Acc: 0.9778
 Site-art_painting              (1) | Train Loss: 0.3143 | Train Acc: 0.9067
 Site-art_painting              (1) | Train Loss: 0.2887 | Train Acc: 0.9267
 Site-cartoon                   (2) | Train Loss: 0.3707 | Train Acc: 0.8600
 Site-cartoon                   (2) | Train Loss: 0.2843 | Train Acc: 0.9111
 Site-sketch                    (0) | Train Loss: 0.4159 | Train Acc: 0.8467
 Site-sketch                    (0) | Train Loss: 0.4067 | Train Acc: 0.8489
Average Train Accuracy: 0.9081
============ Train epoch 25 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (1) | Train Loss: 0.0946 | Train Acc: 0.9867
 Site-photo                     (1) | Train Loss: 0.1058 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.3520 | Train Acc: 0.9200
 Site-art_painting              (3) | Train Loss: 0.2114 | Train Acc: 0.9511
 Site-cartoon                   (2) | Train Loss: 0.3640 | Train Acc: 0.8667
 Site-cartoon                   (2) | Train Loss: 0.3678 | Train Acc: 0.9089
 Site-sketch                    (0) | Train Loss: 0.3930 | Train Acc: 0.8800
 Site-sketch                    (0) | Train Loss: 0.3524 | Train Acc: 0.8889
Average Train Accuracy: 0.9219
 Best site-photo                     | Epoch:25 | Val Acc: 0.9867
 Best site-photo                     | Epoch:25 | Val Acc: 0.9733
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9511
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.8667
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.9089
 Best site-sketch                    | Epoch:25 | Val Acc: 0.8800
 Best site-sketch                    | Epoch:25 | Val Acc: 0.8889
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 26 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (1) | Train Loss: 0.1068 | Train Acc: 0.9733
 Site-photo                     (1) | Train Loss: 0.1152 | Train Acc: 0.9689
 Site-art_painting              (3) | Train Loss: 0.3809 | Train Acc: 0.8467
 Site-art_painting              (3) | Train Loss: 0.2502 | Train Acc: 0.9244
 Site-cartoon                   (2) | Train Loss: 0.3262 | Train Acc: 0.8867
 Site-cartoon                   (2) | Train Loss: 0.2487 | Train Acc: 0.9356
 Site-sketch                    (0) | Train Loss: 0.3799 | Train Acc: 0.8533
 Site-sketch                    (0) | Train Loss: 0.3899 | Train Acc: 0.8778
Average Train Accuracy: 0.9083
============ Train epoch 27 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (0) | Train Loss: 0.0858 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.1062 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.3672 | Train Acc: 0.8800
 Site-art_painting              (3) | Train Loss: 0.3475 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.3160 | Train Acc: 0.8867
 Site-cartoon                   (2) | Train Loss: 0.2589 | Train Acc: 0.9222
 Site-sketch                    (1) | Train Loss: 0.3983 | Train Acc: 0.8667
 Site-sketch                    (1) | Train Loss: 0.4143 | Train Acc: 0.8889
Average Train Accuracy: 0.9158
============ Train epoch 28 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (3) | Train Loss: 0.1077 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.0975 | Train Acc: 0.9689
 Site-art_painting              (2) | Train Loss: 0.3271 | Train Acc: 0.8867
 Site-art_painting              (2) | Train Loss: 0.2249 | Train Acc: 0.9378
 Site-cartoon                   (0) | Train Loss: 0.3614 | Train Acc: 0.8800
 Site-cartoon                   (0) | Train Loss: 0.2696 | Train Acc: 0.9178
 Site-sketch                    (1) | Train Loss: 0.4255 | Train Acc: 0.8600
 Site-sketch                    (1) | Train Loss: 0.3626 | Train Acc: 0.8956
Average Train Accuracy: 0.9158
============ Train epoch 29 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (1) | Train Loss: 0.0923 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.0917 | Train Acc: 0.9844
 Site-art_painting              (3) | Train Loss: 0.3262 | Train Acc: 0.8933
 Site-art_painting              (3) | Train Loss: 0.2182 | Train Acc: 0.9444
 Site-cartoon                   (2) | Train Loss: 0.3109 | Train Acc: 0.8933
 Site-cartoon                   (2) | Train Loss: 0.2838 | Train Acc: 0.9044
 Site-sketch                    (0) | Train Loss: 0.3950 | Train Acc: 0.8800
 Site-sketch                    (0) | Train Loss: 0.3545 | Train Acc: 0.8778
Average Train Accuracy: 0.9197
============ Train epoch 30 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (1) | Train Loss: 0.1202 | Train Acc: 0.9867
 Site-photo                     (1) | Train Loss: 0.0926 | Train Acc: 0.9822
 Site-art_painting              (3) | Train Loss: 0.3544 | Train Acc: 0.8667
 Site-art_painting              (3) | Train Loss: 0.2222 | Train Acc: 0.9444
 Site-cartoon                   (2) | Train Loss: 0.3179 | Train Acc: 0.8733
 Site-cartoon                   (2) | Train Loss: 0.2513 | Train Acc: 0.9133
 Site-sketch                    (0) | Train Loss: 0.3906 | Train Acc: 0.8733
 Site-sketch                    (0) | Train Loss: 0.3191 | Train Acc: 0.8844
Average Train Accuracy: 0.9156
============ Train epoch 31 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (3) | Train Loss: 0.0924 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.0925 | Train Acc: 0.9778
 Site-art_painting              (2) | Train Loss: 0.2891 | Train Acc: 0.8867
 Site-art_painting              (2) | Train Loss: 0.2108 | Train Acc: 0.9333
 Site-cartoon                   (0) | Train Loss: 0.2974 | Train Acc: 0.8933
 Site-cartoon                   (0) | Train Loss: 0.2710 | Train Acc: 0.9200
 Site-sketch                    (1) | Train Loss: 0.3678 | Train Acc: 0.8600
 Site-sketch                    (1) | Train Loss: 0.3563 | Train Acc: 0.8644
Average Train Accuracy: 0.9153
============ Train epoch 32 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (3) | Train Loss: 0.1023 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.1465 | Train Acc: 0.9756
 Site-art_painting              (2) | Train Loss: 0.3086 | Train Acc: 0.8733
 Site-art_painting              (2) | Train Loss: 0.2149 | Train Acc: 0.9333
 Site-cartoon                   (0) | Train Loss: 0.2999 | Train Acc: 0.9000
 Site-cartoon                   (0) | Train Loss: 0.2901 | Train Acc: 0.9133
 Site-sketch                    (1) | Train Loss: 0.3636 | Train Acc: 0.8733
 Site-sketch                    (1) | Train Loss: 0.3448 | Train Acc: 0.8778
Average Train Accuracy: 0.9158
============ Train epoch 33 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (2) | Train Loss: 0.1250 | Train Acc: 0.9800
 Site-photo                     (2) | Train Loss: 0.1043 | Train Acc: 0.9822
 Site-art_painting              (3) | Train Loss: 0.3312 | Train Acc: 0.9000
 Site-art_painting              (3) | Train Loss: 0.2295 | Train Acc: 0.9311
 Site-cartoon                   (0) | Train Loss: 0.3432 | Train Acc: 0.8467
 Site-cartoon                   (0) | Train Loss: 0.2630 | Train Acc: 0.9289
 Site-sketch                    (1) | Train Loss: 0.3641 | Train Acc: 0.8600
 Site-sketch                    (1) | Train Loss: 0.3434 | Train Acc: 0.9000
Average Train Accuracy: 0.9161
============ Train epoch 34 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (3) | Train Loss: 0.1086 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.0875 | Train Acc: 0.9822
 Site-art_painting              (0) | Train Loss: 0.3299 | Train Acc: 0.8733
 Site-art_painting              (0) | Train Loss: 0.2015 | Train Acc: 0.9356
 Site-cartoon                   (2) | Train Loss: 0.2841 | Train Acc: 0.9000
 Site-cartoon                   (2) | Train Loss: 0.2318 | Train Acc: 0.9267
 Site-sketch                    (1) | Train Loss: 0.3608 | Train Acc: 0.8600
 Site-sketch                    (1) | Train Loss: 0.3079 | Train Acc: 0.8956
Average Train Accuracy: 0.9192
============ Train epoch 35 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (3) | Train Loss: 0.0735 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.0823 | Train Acc: 0.9756
 Site-art_painting              (0) | Train Loss: 0.3617 | Train Acc: 0.8667
 Site-art_painting              (0) | Train Loss: 0.2027 | Train Acc: 0.9444
 Site-cartoon                   (2) | Train Loss: 0.2823 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.2140 | Train Acc: 0.9378
 Site-sketch                    (1) | Train Loss: 0.4366 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.3187 | Train Acc: 0.8978
Average Train Accuracy: 0.9186
============ Train epoch 36 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (1) | Train Loss: 0.0942 | Train Acc: 0.9867
 Site-photo                     (1) | Train Loss: 0.0927 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.2527 | Train Acc: 0.9133
 Site-art_painting              (3) | Train Loss: 0.1849 | Train Acc: 0.9489
 Site-cartoon                   (2) | Train Loss: 0.2949 | Train Acc: 0.9133
 Site-cartoon                   (2) | Train Loss: 0.2116 | Train Acc: 0.9422
 Site-sketch                    (0) | Train Loss: 0.3518 | Train Acc: 0.8600
 Site-sketch                    (0) | Train Loss: 0.3169 | Train Acc: 0.8867
Average Train Accuracy: 0.9281
 Best site-photo                     | Epoch:36 | Val Acc: 0.9867
 Best site-photo                     | Epoch:36 | Val Acc: 0.9733
 Best site-art_painting              | Epoch:36 | Val Acc: 0.9133
 Best site-art_painting              | Epoch:36 | Val Acc: 0.9489
 Best site-cartoon                   | Epoch:36 | Val Acc: 0.9133
 Best site-cartoon                   | Epoch:36 | Val Acc: 0.9422
 Best site-sketch                    | Epoch:36 | Val Acc: 0.8600
 Best site-sketch                    | Epoch:36 | Val Acc: 0.8867
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 37 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (3) | Train Loss: 0.0928 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.0954 | Train Acc: 0.9800
 Site-art_painting              (0) | Train Loss: 0.2504 | Train Acc: 0.9400
 Site-art_painting              (0) | Train Loss: 0.2051 | Train Acc: 0.9311
 Site-cartoon                   (2) | Train Loss: 0.2723 | Train Acc: 0.9067
 Site-cartoon                   (2) | Train Loss: 0.2210 | Train Acc: 0.9267
 Site-sketch                    (1) | Train Loss: 0.3838 | Train Acc: 0.8467
 Site-sketch                    (1) | Train Loss: 0.3092 | Train Acc: 0.8933
Average Train Accuracy: 0.9256
============ Train epoch 38 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (3) | Train Loss: 0.1007 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.0825 | Train Acc: 0.9711
 Site-art_painting              (0) | Train Loss: 0.3037 | Train Acc: 0.8867
 Site-art_painting              (0) | Train Loss: 0.1895 | Train Acc: 0.9422
 Site-cartoon                   (2) | Train Loss: 0.2710 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.2254 | Train Acc: 0.9422
 Site-sketch                    (1) | Train Loss: 0.3486 | Train Acc: 0.8733
 Site-sketch                    (1) | Train Loss: 0.3267 | Train Acc: 0.8844
Average Train Accuracy: 0.9258
============ Train epoch 39 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (3) | Train Loss: 0.1045 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.0799 | Train Acc: 0.9844
 Site-art_painting              (0) | Train Loss: 0.3100 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.2030 | Train Acc: 0.9511
 Site-cartoon                   (2) | Train Loss: 0.2621 | Train Acc: 0.9133
 Site-cartoon                   (2) | Train Loss: 0.2491 | Train Acc: 0.9244
 Site-sketch                    (1) | Train Loss: 0.3741 | Train Acc: 0.8600
 Site-sketch                    (1) | Train Loss: 0.3497 | Train Acc: 0.8956
Average Train Accuracy: 0.9269
============ Train epoch 40 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (1) | Train Loss: 0.1132 | Train Acc: 0.9733
 Site-photo                     (1) | Train Loss: 0.1262 | Train Acc: 0.9778
 Site-art_painting              (3) | Train Loss: 0.2653 | Train Acc: 0.8867
 Site-art_painting              (3) | Train Loss: 0.1784 | Train Acc: 0.9422
 Site-cartoon                   (2) | Train Loss: 0.2721 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.2077 | Train Acc: 0.9467
 Site-sketch                    (0) | Train Loss: 0.3628 | Train Acc: 0.8733
 Site-sketch                    (0) | Train Loss: 0.2801 | Train Acc: 0.9044
Average Train Accuracy: 0.9281
============ Train epoch 41 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-photo                     (0) | Train Loss: 0.0947 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.0888 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.2838 | Train Acc: 0.8933
 Site-art_painting              (3) | Train Loss: 0.2010 | Train Acc: 0.9444
 Site-cartoon                   (2) | Train Loss: 0.2752 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.2008 | Train Acc: 0.9467
 Site-sketch                    (1) | Train Loss: 0.3324 | Train Acc: 0.8867
 Site-sketch                    (1) | Train Loss: 0.3157 | Train Acc: 0.8911
Average Train Accuracy: 0.9306
 Best site-photo                     | Epoch:41 | Val Acc: 0.9867
 Best site-photo                     | Epoch:41 | Val Acc: 0.9756
 Best site-art_painting              | Epoch:41 | Val Acc: 0.8933
 Best site-art_painting              | Epoch:41 | Val Acc: 0.9444
 Best site-cartoon                   | Epoch:41 | Val Acc: 0.9200
 Best site-cartoon                   | Epoch:41 | Val Acc: 0.9467
 Best site-sketch                    | Epoch:41 | Val Acc: 0.8867
 Best site-sketch                    | Epoch:41 | Val Acc: 0.8911
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 42 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-photo                     (3) | Train Loss: 0.0659 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.0868 | Train Acc: 0.9756
 Site-art_painting              (1) | Train Loss: 0.2600 | Train Acc: 0.9000
 Site-art_painting              (1) | Train Loss: 0.1748 | Train Acc: 0.9511
 Site-cartoon                   (2) | Train Loss: 0.2555 | Train Acc: 0.9000
 Site-cartoon                   (2) | Train Loss: 0.2058 | Train Acc: 0.9444
 Site-sketch                    (0) | Train Loss: 0.3278 | Train Acc: 0.9000
 Site-sketch                    (0) | Train Loss: 0.3387 | Train Acc: 0.8956
Average Train Accuracy: 0.9317
 Best site-photo                     | Epoch:42 | Val Acc: 0.9867
 Best site-photo                     | Epoch:42 | Val Acc: 0.9756
 Best site-art_painting              | Epoch:42 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:42 | Val Acc: 0.9511
 Best site-cartoon                   | Epoch:42 | Val Acc: 0.9000
 Best site-cartoon                   | Epoch:42 | Val Acc: 0.9444
 Best site-sketch                    | Epoch:42 | Val Acc: 0.9000
 Best site-sketch                    | Epoch:42 | Val Acc: 0.8956
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 43 ============
cnt=[4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-photo                     (0) | Train Loss: 0.0750 | Train Acc: 0.9800
 Site-photo                     (0) | Train Loss: 0.0802 | Train Acc: 0.9711
 Site-art_painting              (0) | Train Loss: 0.2801 | Train Acc: 0.9200
 Site-art_painting              (0) | Train Loss: 0.2109 | Train Acc: 0.9489
 Site-cartoon                   (2) | Train Loss: 0.2562 | Train Acc: 0.9067
 Site-cartoon                   (2) | Train Loss: 0.1884 | Train Acc: 0.9422
 Site-sketch                    (3) | Train Loss: 0.3700 | Train Acc: 0.8800
 Site-sketch                    (1) | Train Loss: 0.2705 | Train Acc: 0.9089
Average Train Accuracy: 0.9322
 Best site-photo                     | Epoch:43 | Val Acc: 0.9800
 Best site-photo                     | Epoch:43 | Val Acc: 0.9711
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9489
 Best site-cartoon                   | Epoch:43 | Val Acc: 0.9067
 Best site-cartoon                   | Epoch:43 | Val Acc: 0.9422
 Best site-sketch                    | Epoch:43 | Val Acc: 0.8800
 Best site-sketch                    | Epoch:43 | Val Acc: 0.9089
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 44 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-photo                     (1) | Train Loss: 0.0817 | Train Acc: 0.9867
 Site-photo                     (1) | Train Loss: 0.0808 | Train Acc: 0.9778
 Site-art_painting              (3) | Train Loss: 0.2422 | Train Acc: 0.9133
 Site-art_painting              (3) | Train Loss: 0.1669 | Train Acc: 0.9444
 Site-cartoon                   (2) | Train Loss: 0.2663 | Train Acc: 0.9133
 Site-cartoon                   (2) | Train Loss: 0.2055 | Train Acc: 0.9356
 Site-sketch                    (0) | Train Loss: 0.3790 | Train Acc: 0.8800
 Site-sketch                    (0) | Train Loss: 0.3057 | Train Acc: 0.8733
Average Train Accuracy: 0.9281
============ Train epoch 45 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-photo                     (3) | Train Loss: 0.0960 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.0853 | Train Acc: 0.9711
 Site-art_painting              (1) | Train Loss: 0.2981 | Train Acc: 0.9200
 Site-art_painting              (1) | Train Loss: 0.1876 | Train Acc: 0.9467
 Site-cartoon                   (2) | Train Loss: 0.2183 | Train Acc: 0.9400
 Site-cartoon                   (2) | Train Loss: 0.1843 | Train Acc: 0.9489
 Site-sketch                    (0) | Train Loss: 0.3544 | Train Acc: 0.8667
 Site-sketch                    (0) | Train Loss: 0.2723 | Train Acc: 0.8978
Average Train Accuracy: 0.9331
 Best site-photo                     | Epoch:45 | Val Acc: 0.9733
 Best site-photo                     | Epoch:45 | Val Acc: 0.9711
 Best site-art_painting              | Epoch:45 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:45 | Val Acc: 0.9467
 Best site-cartoon                   | Epoch:45 | Val Acc: 0.9400
 Best site-cartoon                   | Epoch:45 | Val Acc: 0.9489
 Best site-sketch                    | Epoch:45 | Val Acc: 0.8667
 Best site-sketch                    | Epoch:45 | Val Acc: 0.8978
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 46 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-photo                     (3) | Train Loss: 0.0645 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.0783 | Train Acc: 0.9733
 Site-art_painting              (0) | Train Loss: 0.2328 | Train Acc: 0.9267
 Site-art_painting              (0) | Train Loss: 0.1675 | Train Acc: 0.9622
 Site-cartoon                   (2) | Train Loss: 0.3051 | Train Acc: 0.8933
 Site-cartoon                   (2) | Train Loss: 0.1928 | Train Acc: 0.9356
 Site-sketch                    (1) | Train Loss: 0.3216 | Train Acc: 0.8867
 Site-sketch                    (1) | Train Loss: 0.3010 | Train Acc: 0.8933
Average Train Accuracy: 0.9322
============ Train epoch 47 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-photo                     (3) | Train Loss: 0.0640 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.0773 | Train Acc: 0.9778
 Site-art_painting              (0) | Train Loss: 0.2748 | Train Acc: 0.9200
 Site-art_painting              (0) | Train Loss: 0.1791 | Train Acc: 0.9533
 Site-cartoon                   (2) | Train Loss: 0.2756 | Train Acc: 0.9067
 Site-cartoon                   (2) | Train Loss: 0.1939 | Train Acc: 0.9422
 Site-sketch                    (1) | Train Loss: 0.2966 | Train Acc: 0.9200
 Site-sketch                    (1) | Train Loss: 0.3735 | Train Acc: 0.9111
Average Train Accuracy: 0.9397
 Best site-photo                     | Epoch:47 | Val Acc: 0.9867
 Best site-photo                     | Epoch:47 | Val Acc: 0.9778
 Best site-art_painting              | Epoch:47 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:47 | Val Acc: 0.9533
 Best site-cartoon                   | Epoch:47 | Val Acc: 0.9067
 Best site-cartoon                   | Epoch:47 | Val Acc: 0.9422
 Best site-sketch                    | Epoch:47 | Val Acc: 0.9200
 Best site-sketch                    | Epoch:47 | Val Acc: 0.9111
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
============ Train epoch 48 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-photo                     (3) | Train Loss: 0.1074 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.0681 | Train Acc: 0.9822
 Site-art_painting              (2) | Train Loss: 0.2454 | Train Acc: 0.9133
 Site-art_painting              (2) | Train Loss: 0.1608 | Train Acc: 0.9511
 Site-cartoon                   (0) | Train Loss: 0.2729 | Train Acc: 0.9133
 Site-cartoon                   (0) | Train Loss: 0.1854 | Train Acc: 0.9556
 Site-sketch                    (1) | Train Loss: 0.3516 | Train Acc: 0.8800
 Site-sketch                    (1) | Train Loss: 0.2747 | Train Acc: 0.9133
Average Train Accuracy: 0.9353
============ Train epoch 49 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-photo                     (0) | Train Loss: 0.0915 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.0687 | Train Acc: 0.9800
 Site-art_painting              (3) | Train Loss: 0.2477 | Train Acc: 0.9133
 Site-art_painting              (3) | Train Loss: 0.1994 | Train Acc: 0.9444
 Site-cartoon                   (2) | Train Loss: 0.2352 | Train Acc: 0.9267
 Site-cartoon                   (2) | Train Loss: 0.1750 | Train Acc: 0.9511
 Site-sketch                    (1) | Train Loss: 0.3586 | Train Acc: 0.9000
 Site-sketch                    (1) | Train Loss: 0.2682 | Train Acc: 0.9178
Average Train Accuracy: 0.9400
 Best site-photo                     | Epoch:49 | Val Acc: 0.9867
 Best site-photo                     | Epoch:49 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:49 | Val Acc: 0.9133
 Best site-art_painting              | Epoch:49 | Val Acc: 0.9444
 Best site-cartoon                   | Epoch:49 | Val Acc: 0.9267
 Best site-cartoon                   | Epoch:49 | Val Acc: 0.9511
 Best site-sketch                    | Epoch:49 | Val Acc: 0.9000
 Best site-sketch                    | Epoch:49 | Val Acc: 0.9178
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1_gmap...
 Test site-photo                     (0)| Epoch:49 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:49 | Test Acc: 0.9111
 Test site-cartoon                   (2)| Epoch:49 | Test Acc: 0.8989
 Test site-sketch                    (1)| Epoch:49 | Test Acc: 0.8577
photo: 0.9896, art_painting: 0.9111, cartoon: 0.8989, sketch: 0.8577, 
Average Test Accuracy(group): 0.9143, Average Test Accuracy(individual): 0.9143,
domain std=0.0477, cluster std=0.0477, individual std=0.0477, 
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/ccop_q=1...
===2023-08-17 09:51:19===
===2023-08-17 09:51:23===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
Loading snapshots...
 Test site-photo                     (0)| Epoch:49 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:49 | Test Acc: 0.9111
 Test site-cartoon                   (2)| Epoch:49 | Test Acc: 0.8989
 Test site-sketch                    (1)| Epoch:49 | Test Acc: 0.8577
photo: 0.9896, art_painting: 0.9111, cartoon: 0.8989, sketch: 0.8577, 
Average Test Accuracy(group): 0.9143, Average Test Accuracy(individual): 0.9143,
domain std=0.0477, cluster std=0.0477, individual std=0.0477, 
