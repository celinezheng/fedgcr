===2023-08-17 02:27:29===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
============ Train epoch 0 ============
 Site-photo-0                       | Train Loss: 1.7321 | Train Acc: 0.8533
 Site-photo-1                       | Train Loss: 1.7230 | Train Acc: 0.8356
 Site-art_painting-0                | Train Loss: 1.8286 | Train Acc: 0.4667
 Site-art_painting-1                | Train Loss: 1.8105 | Train Acc: 0.4933
 Site-cartoon-0                     | Train Loss: 1.7987 | Train Acc: 0.4933
 Site-cartoon-1                     | Train Loss: 1.7985 | Train Acc: 0.5422
 Site-sketch-0                      | Train Loss: 1.8063 | Train Acc: 0.2533
 Site-sketch-1                      | Train Loss: 1.8082 | Train Acc: 0.2356
Average Train Accuracy: 0.5217
 Best site-photo-0                   | Epoch:0 | Val Acc: 0.8533
 Best site-photo-1                   | Epoch:0 | Val Acc: 0.8356
 Best site-art_painting-0            | Epoch:0 | Val Acc: 0.4667
 Best site-art_painting-1            | Epoch:0 | Val Acc: 0.4933
 Best site-cartoon-0                 | Epoch:0 | Val Acc: 0.4933
 Best site-cartoon-1                 | Epoch:0 | Val Acc: 0.5422
 Best site-sketch-0                  | Epoch:0 | Val Acc: 0.2533
 Best site-sketch-1                  | Epoch:0 | Val Acc: 0.2356
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 1 ============
 Site-photo-0                       | Train Loss: 1.5068 | Train Acc: 0.9800
 Site-photo-1                       | Train Loss: 1.4961 | Train Acc: 0.9667
 Site-art_painting-0                | Train Loss: 1.6839 | Train Acc: 0.6867
 Site-art_painting-1                | Train Loss: 1.6547 | Train Acc: 0.6800
 Site-cartoon-0                     | Train Loss: 1.6466 | Train Acc: 0.7200
 Site-cartoon-1                     | Train Loss: 1.6479 | Train Acc: 0.6778
 Site-sketch-0                      | Train Loss: 1.6970 | Train Acc: 0.3333
 Site-sketch-1                      | Train Loss: 1.7120 | Train Acc: 0.3356
Average Train Accuracy: 0.6725
 Best site-photo-0                   | Epoch:1 | Val Acc: 0.9800
 Best site-photo-1                   | Epoch:1 | Val Acc: 0.9667
 Best site-art_painting-0            | Epoch:1 | Val Acc: 0.6867
 Best site-art_painting-1            | Epoch:1 | Val Acc: 0.6800
 Best site-cartoon-0                 | Epoch:1 | Val Acc: 0.7200
 Best site-cartoon-1                 | Epoch:1 | Val Acc: 0.6778
 Best site-sketch-0                  | Epoch:1 | Val Acc: 0.3333
 Best site-sketch-1                  | Epoch:1 | Val Acc: 0.3356
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 2 ============
 Site-photo-0                       | Train Loss: 1.2698 | Train Acc: 0.9933
 Site-photo-1                       | Train Loss: 1.2763 | Train Acc: 0.9778
 Site-art_painting-0                | Train Loss: 1.5346 | Train Acc: 0.7000
 Site-art_painting-1                | Train Loss: 1.5142 | Train Acc: 0.7733
 Site-cartoon-0                     | Train Loss: 1.5082 | Train Acc: 0.7800
 Site-cartoon-1                     | Train Loss: 1.5089 | Train Acc: 0.7400
 Site-sketch-0                      | Train Loss: 1.6170 | Train Acc: 0.4467
 Site-sketch-1                      | Train Loss: 1.6405 | Train Acc: 0.3956
Average Train Accuracy: 0.7258
 Best site-photo-0                   | Epoch:2 | Val Acc: 0.9933
 Best site-photo-1                   | Epoch:2 | Val Acc: 0.9778
 Best site-art_painting-0            | Epoch:2 | Val Acc: 0.7000
 Best site-art_painting-1            | Epoch:2 | Val Acc: 0.7733
 Best site-cartoon-0                 | Epoch:2 | Val Acc: 0.7800
 Best site-cartoon-1                 | Epoch:2 | Val Acc: 0.7400
 Best site-sketch-0                  | Epoch:2 | Val Acc: 0.4467
 Best site-sketch-1                  | Epoch:2 | Val Acc: 0.3956
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 3 ============
 Site-photo-0                       | Train Loss: 1.0715 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 1.0509 | Train Acc: 0.9911
 Site-art_painting-0                | Train Loss: 1.4002 | Train Acc: 0.8000
 Site-art_painting-1                | Train Loss: 1.3764 | Train Acc: 0.7822
 Site-cartoon-0                     | Train Loss: 1.3854 | Train Acc: 0.7933
 Site-cartoon-1                     | Train Loss: 1.4125 | Train Acc: 0.7644
 Site-sketch-0                      | Train Loss: 1.5264 | Train Acc: 0.5067
 Site-sketch-1                      | Train Loss: 1.5428 | Train Acc: 0.4956
Average Train Accuracy: 0.7650
 Best site-photo-0                   | Epoch:3 | Val Acc: 0.9867
 Best site-photo-1                   | Epoch:3 | Val Acc: 0.9911
 Best site-art_painting-0            | Epoch:3 | Val Acc: 0.8000
 Best site-art_painting-1            | Epoch:3 | Val Acc: 0.7822
 Best site-cartoon-0                 | Epoch:3 | Val Acc: 0.7933
 Best site-cartoon-1                 | Epoch:3 | Val Acc: 0.7644
 Best site-sketch-0                  | Epoch:3 | Val Acc: 0.5067
 Best site-sketch-1                  | Epoch:3 | Val Acc: 0.4956
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 4 ============
 Site-photo-0                       | Train Loss: 0.9062 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.9081 | Train Acc: 0.9844
 Site-art_painting-0                | Train Loss: 1.2789 | Train Acc: 0.7667
 Site-art_painting-1                | Train Loss: 1.2409 | Train Acc: 0.8133
 Site-cartoon-0                     | Train Loss: 1.3002 | Train Acc: 0.7733
 Site-cartoon-1                     | Train Loss: 1.3030 | Train Acc: 0.7822
 Site-sketch-0                      | Train Loss: 1.4785 | Train Acc: 0.5200
 Site-sketch-1                      | Train Loss: 1.4960 | Train Acc: 0.4533
Average Train Accuracy: 0.7600
============ Train epoch 5 ============
 Site-photo-0                       | Train Loss: 0.7522 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.7375 | Train Acc: 0.9778
 Site-art_painting-0                | Train Loss: 1.1928 | Train Acc: 0.7867
 Site-art_painting-1                | Train Loss: 1.1416 | Train Acc: 0.8222
 Site-cartoon-0                     | Train Loss: 1.2056 | Train Acc: 0.7733
 Site-cartoon-1                     | Train Loss: 1.2170 | Train Acc: 0.7867
 Site-sketch-0                      | Train Loss: 1.4230 | Train Acc: 0.5467
 Site-sketch-1                      | Train Loss: 1.4390 | Train Acc: 0.5333
Average Train Accuracy: 0.7767
 Best site-photo-0                   | Epoch:5 | Val Acc: 0.9867
 Best site-photo-1                   | Epoch:5 | Val Acc: 0.9778
 Best site-art_painting-0            | Epoch:5 | Val Acc: 0.7867
 Best site-art_painting-1            | Epoch:5 | Val Acc: 0.8222
 Best site-cartoon-0                 | Epoch:5 | Val Acc: 0.7733
 Best site-cartoon-1                 | Epoch:5 | Val Acc: 0.7867
 Best site-sketch-0                  | Epoch:5 | Val Acc: 0.5467
 Best site-sketch-1                  | Epoch:5 | Val Acc: 0.5333
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 6 ============
 Site-photo-0                       | Train Loss: 0.6230 | Train Acc: 0.9933
 Site-photo-1                       | Train Loss: 0.6006 | Train Acc: 0.9867
 Site-art_painting-0                | Train Loss: 1.1116 | Train Acc: 0.7933
 Site-art_painting-1                | Train Loss: 1.1125 | Train Acc: 0.8267
 Site-cartoon-0                     | Train Loss: 1.1403 | Train Acc: 0.8067
 Site-cartoon-1                     | Train Loss: 1.1461 | Train Acc: 0.7800
 Site-sketch-0                      | Train Loss: 1.3792 | Train Acc: 0.5467
 Site-sketch-1                      | Train Loss: 1.3843 | Train Acc: 0.5333
Average Train Accuracy: 0.7833
 Best site-photo-0                   | Epoch:6 | Val Acc: 0.9933
 Best site-photo-1                   | Epoch:6 | Val Acc: 0.9867
 Best site-art_painting-0            | Epoch:6 | Val Acc: 0.7933
 Best site-art_painting-1            | Epoch:6 | Val Acc: 0.8267
 Best site-cartoon-0                 | Epoch:6 | Val Acc: 0.8067
 Best site-cartoon-1                 | Epoch:6 | Val Acc: 0.7800
 Best site-sketch-0                  | Epoch:6 | Val Acc: 0.5467
 Best site-sketch-1                  | Epoch:6 | Val Acc: 0.5333
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 7 ============
 Site-photo-0                       | Train Loss: 0.5220 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.5136 | Train Acc: 0.9844
 Site-art_painting-0                | Train Loss: 1.0006 | Train Acc: 0.8200
 Site-art_painting-1                | Train Loss: 0.9839 | Train Acc: 0.8289
 Site-cartoon-0                     | Train Loss: 1.0407 | Train Acc: 0.8333
 Site-cartoon-1                     | Train Loss: 1.0407 | Train Acc: 0.7911
 Site-sketch-0                      | Train Loss: 1.3196 | Train Acc: 0.5933
 Site-sketch-1                      | Train Loss: 1.3554 | Train Acc: 0.5578
Average Train Accuracy: 0.7994
 Best site-photo-0                   | Epoch:7 | Val Acc: 0.9867
 Best site-photo-1                   | Epoch:7 | Val Acc: 0.9844
 Best site-art_painting-0            | Epoch:7 | Val Acc: 0.8200
 Best site-art_painting-1            | Epoch:7 | Val Acc: 0.8289
 Best site-cartoon-0                 | Epoch:7 | Val Acc: 0.8333
 Best site-cartoon-1                 | Epoch:7 | Val Acc: 0.7911
 Best site-sketch-0                  | Epoch:7 | Val Acc: 0.5933
 Best site-sketch-1                  | Epoch:7 | Val Acc: 0.5578
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 8 ============
 Site-photo-0                       | Train Loss: 0.4231 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.4221 | Train Acc: 0.9867
 Site-art_painting-0                | Train Loss: 0.9862 | Train Acc: 0.7867
 Site-art_painting-1                | Train Loss: 0.8522 | Train Acc: 0.8400
 Site-cartoon-0                     | Train Loss: 0.9667 | Train Acc: 0.8400
 Site-cartoon-1                     | Train Loss: 1.0708 | Train Acc: 0.7978
 Site-sketch-0                      | Train Loss: 1.2717 | Train Acc: 0.5800
 Site-sketch-1                      | Train Loss: 1.2800 | Train Acc: 0.5867
Average Train Accuracy: 0.8022
 Best site-photo-0                   | Epoch:8 | Val Acc: 1.0000
 Best site-photo-1                   | Epoch:8 | Val Acc: 0.9867
 Best site-art_painting-0            | Epoch:8 | Val Acc: 0.7867
 Best site-art_painting-1            | Epoch:8 | Val Acc: 0.8400
 Best site-cartoon-0                 | Epoch:8 | Val Acc: 0.8400
 Best site-cartoon-1                 | Epoch:8 | Val Acc: 0.7978
 Best site-sketch-0                  | Epoch:8 | Val Acc: 0.5800
 Best site-sketch-1                  | Epoch:8 | Val Acc: 0.5867
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 9 ============
 Site-photo-0                       | Train Loss: 0.3449 | Train Acc: 0.9933
 Site-photo-1                       | Train Loss: 0.3754 | Train Acc: 0.9844
 Site-art_painting-0                | Train Loss: 0.8796 | Train Acc: 0.8067
 Site-art_painting-1                | Train Loss: 0.8087 | Train Acc: 0.8644
 Site-cartoon-0                     | Train Loss: 0.9277 | Train Acc: 0.8667
 Site-cartoon-1                     | Train Loss: 0.9615 | Train Acc: 0.8022
 Site-sketch-0                      | Train Loss: 1.2613 | Train Acc: 0.5667
 Site-sketch-1                      | Train Loss: 1.2412 | Train Acc: 0.6133
Average Train Accuracy: 0.8122
 Best site-photo-0                   | Epoch:9 | Val Acc: 0.9933
 Best site-photo-1                   | Epoch:9 | Val Acc: 0.9844
 Best site-art_painting-0            | Epoch:9 | Val Acc: 0.8067
 Best site-art_painting-1            | Epoch:9 | Val Acc: 0.8644
 Best site-cartoon-0                 | Epoch:9 | Val Acc: 0.8667
 Best site-cartoon-1                 | Epoch:9 | Val Acc: 0.8022
 Best site-sketch-0                  | Epoch:9 | Val Acc: 0.5667
 Best site-sketch-1                  | Epoch:9 | Val Acc: 0.6133
 Test site-photo-0                   | Epoch:9 | Test Acc: 0.9940
 Test site-photo-1                   | Epoch:9 | Test Acc: 1.0000
 Test site-art_painting-0            | Epoch:9 | Test Acc: 0.8878
 Test site-art_painting-1            | Epoch:9 | Test Acc: 0.8699
 Test site-cartoon-0                 | Epoch:9 | Test Acc: 0.7957
 Test site-cartoon-1                 | Epoch:9 | Test Acc: 0.7872
 Test site-sketch-0                  | Epoch:9 | Test Acc: 0.5878
 Test site-sketch-1                  | Epoch:9 | Test Acc: 0.5805
photo-0: 0.9940, photo-1: 1.0000, art_painting-0: 0.8878, art_painting-1: 0.8699, cartoon-0: 0.7957, cartoon-1: 0.7872, sketch-0: 0.5878, sketch-1: 0.5805, 
Average Test Accuracy(group): 0.8129, Average Test Accuracy(individual): 0.8129,
domain std=0.1510, cluster std=-1.0000, individual std=0.1510, 
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 10 ============
 Site-photo-0                       | Train Loss: 0.3125 | Train Acc: 0.9933
 Site-photo-1                       | Train Loss: 0.3001 | Train Acc: 0.9867
 Site-art_painting-0                | Train Loss: 0.8243 | Train Acc: 0.8400
 Site-art_painting-1                | Train Loss: 0.7554 | Train Acc: 0.8800
 Site-cartoon-0                     | Train Loss: 0.9062 | Train Acc: 0.8000
 Site-cartoon-1                     | Train Loss: 0.9206 | Train Acc: 0.8089
 Site-sketch-0                      | Train Loss: 1.2227 | Train Acc: 0.5800
 Site-sketch-1                      | Train Loss: 1.2487 | Train Acc: 0.5800
Average Train Accuracy: 0.8086
============ Train epoch 11 ============
 Site-photo-0                       | Train Loss: 0.2489 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.2672 | Train Acc: 0.9867
 Site-art_painting-0                | Train Loss: 0.7956 | Train Acc: 0.8333
 Site-art_painting-1                | Train Loss: 0.7288 | Train Acc: 0.8622
 Site-cartoon-0                     | Train Loss: 0.8294 | Train Acc: 0.8533
 Site-cartoon-1                     | Train Loss: 0.8560 | Train Acc: 0.8111
 Site-sketch-0                      | Train Loss: 1.1786 | Train Acc: 0.5600
 Site-sketch-1                      | Train Loss: 1.1892 | Train Acc: 0.6467
Average Train Accuracy: 0.8192
 Best site-photo-0                   | Epoch:11 | Val Acc: 1.0000
 Best site-photo-1                   | Epoch:11 | Val Acc: 0.9867
 Best site-art_painting-0            | Epoch:11 | Val Acc: 0.8333
 Best site-art_painting-1            | Epoch:11 | Val Acc: 0.8622
 Best site-cartoon-0                 | Epoch:11 | Val Acc: 0.8533
 Best site-cartoon-1                 | Epoch:11 | Val Acc: 0.8111
 Best site-sketch-0                  | Epoch:11 | Val Acc: 0.5600
 Best site-sketch-1                  | Epoch:11 | Val Acc: 0.6467
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 12 ============
 Site-photo-0                       | Train Loss: 0.2074 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.2179 | Train Acc: 0.9844
 Site-art_painting-0                | Train Loss: 0.7708 | Train Acc: 0.8400
 Site-art_painting-1                | Train Loss: 0.6993 | Train Acc: 0.8556
 Site-cartoon-0                     | Train Loss: 0.8339 | Train Acc: 0.8667
 Site-cartoon-1                     | Train Loss: 0.8489 | Train Acc: 0.8000
 Site-sketch-0                      | Train Loss: 1.1341 | Train Acc: 0.5600
 Site-sketch-1                      | Train Loss: 1.1667 | Train Acc: 0.6222
Average Train Accuracy: 0.8161
============ Train epoch 13 ============
 Site-photo-0                       | Train Loss: 0.1781 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.1837 | Train Acc: 0.9889
 Site-art_painting-0                | Train Loss: 0.7426 | Train Acc: 0.8267
 Site-art_painting-1                | Train Loss: 0.6367 | Train Acc: 0.8778
 Site-cartoon-0                     | Train Loss: 0.7754 | Train Acc: 0.8533
 Site-cartoon-1                     | Train Loss: 0.7743 | Train Acc: 0.8200
 Site-sketch-0                      | Train Loss: 1.1612 | Train Acc: 0.5800
 Site-sketch-1                      | Train Loss: 1.1413 | Train Acc: 0.6289
Average Train Accuracy: 0.8219
 Best site-photo-0                   | Epoch:13 | Val Acc: 1.0000
 Best site-photo-1                   | Epoch:13 | Val Acc: 0.9889
 Best site-art_painting-0            | Epoch:13 | Val Acc: 0.8267
 Best site-art_painting-1            | Epoch:13 | Val Acc: 0.8778
 Best site-cartoon-0                 | Epoch:13 | Val Acc: 0.8533
 Best site-cartoon-1                 | Epoch:13 | Val Acc: 0.8200
 Best site-sketch-0                  | Epoch:13 | Val Acc: 0.5800
 Best site-sketch-1                  | Epoch:13 | Val Acc: 0.6289
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 14 ============
 Site-photo-0                       | Train Loss: 0.1527 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.1634 | Train Acc: 0.9867
 Site-art_painting-0                | Train Loss: 0.6742 | Train Acc: 0.8467
 Site-art_painting-1                | Train Loss: 0.5869 | Train Acc: 0.8911
 Site-cartoon-0                     | Train Loss: 0.7663 | Train Acc: 0.8467
 Site-cartoon-1                     | Train Loss: 0.7387 | Train Acc: 0.8044
 Site-sketch-0                      | Train Loss: 1.1105 | Train Acc: 0.6400
 Site-sketch-1                      | Train Loss: 1.1086 | Train Acc: 0.6356
Average Train Accuracy: 0.8314
 Best site-photo-0                   | Epoch:14 | Val Acc: 1.0000
 Best site-photo-1                   | Epoch:14 | Val Acc: 0.9867
 Best site-art_painting-0            | Epoch:14 | Val Acc: 0.8467
 Best site-art_painting-1            | Epoch:14 | Val Acc: 0.8911
 Best site-cartoon-0                 | Epoch:14 | Val Acc: 0.8467
 Best site-cartoon-1                 | Epoch:14 | Val Acc: 0.8044
 Best site-sketch-0                  | Epoch:14 | Val Acc: 0.6400
 Best site-sketch-1                  | Epoch:14 | Val Acc: 0.6356
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 15 ============
 Site-photo-0                       | Train Loss: 0.1349 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.1449 | Train Acc: 0.9822
 Site-art_painting-0                | Train Loss: 0.6797 | Train Acc: 0.8133
 Site-art_painting-1                | Train Loss: 0.5407 | Train Acc: 0.8956
 Site-cartoon-0                     | Train Loss: 0.7460 | Train Acc: 0.8067
 Site-cartoon-1                     | Train Loss: 0.7465 | Train Acc: 0.8356
 Site-sketch-0                      | Train Loss: 1.0893 | Train Acc: 0.6267
 Site-sketch-1                      | Train Loss: 1.0851 | Train Acc: 0.6489
Average Train Accuracy: 0.8261
============ Train epoch 16 ============
 Site-photo-0                       | Train Loss: 0.1304 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.1296 | Train Acc: 0.9889
 Site-art_painting-0                | Train Loss: 0.6794 | Train Acc: 0.8267
 Site-art_painting-1                | Train Loss: 0.5378 | Train Acc: 0.8822
 Site-cartoon-0                     | Train Loss: 0.7031 | Train Acc: 0.7933
 Site-cartoon-1                     | Train Loss: 0.6973 | Train Acc: 0.8356
 Site-sketch-0                      | Train Loss: 1.0884 | Train Acc: 0.6133
 Site-sketch-1                      | Train Loss: 1.1091 | Train Acc: 0.6556
Average Train Accuracy: 0.8244
============ Train epoch 17 ============
 Site-photo-0                       | Train Loss: 0.1046 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.1197 | Train Acc: 0.9867
 Site-art_painting-0                | Train Loss: 0.6247 | Train Acc: 0.8200
 Site-art_painting-1                | Train Loss: 0.4951 | Train Acc: 0.8956
 Site-cartoon-0                     | Train Loss: 0.6752 | Train Acc: 0.8200
 Site-cartoon-1                     | Train Loss: 0.7440 | Train Acc: 0.8333
 Site-sketch-0                      | Train Loss: 1.0476 | Train Acc: 0.6067
 Site-sketch-1                      | Train Loss: 1.0384 | Train Acc: 0.6578
Average Train Accuracy: 0.8275
============ Train epoch 18 ============
 Site-photo-0                       | Train Loss: 0.0925 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.0991 | Train Acc: 0.9933
 Site-art_painting-0                | Train Loss: 0.6140 | Train Acc: 0.8333
 Site-art_painting-1                | Train Loss: 0.5421 | Train Acc: 0.8911
 Site-cartoon-0                     | Train Loss: 0.6612 | Train Acc: 0.8600
 Site-cartoon-1                     | Train Loss: 0.6943 | Train Acc: 0.8333
 Site-sketch-0                      | Train Loss: 1.0865 | Train Acc: 0.6667
 Site-sketch-1                      | Train Loss: 1.0159 | Train Acc: 0.6644
Average Train Accuracy: 0.8428
 Best site-photo-0                   | Epoch:18 | Val Acc: 1.0000
 Best site-photo-1                   | Epoch:18 | Val Acc: 0.9933
 Best site-art_painting-0            | Epoch:18 | Val Acc: 0.8333
 Best site-art_painting-1            | Epoch:18 | Val Acc: 0.8911
 Best site-cartoon-0                 | Epoch:18 | Val Acc: 0.8600
 Best site-cartoon-1                 | Epoch:18 | Val Acc: 0.8333
 Best site-sketch-0                  | Epoch:18 | Val Acc: 0.6667
 Best site-sketch-1                  | Epoch:18 | Val Acc: 0.6644
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 19 ============
 Site-photo-0                       | Train Loss: 0.0945 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.0949 | Train Acc: 0.9889
 Site-art_painting-0                | Train Loss: 0.5506 | Train Acc: 0.8667
 Site-art_painting-1                | Train Loss: 0.5702 | Train Acc: 0.8911
 Site-cartoon-0                     | Train Loss: 0.6545 | Train Acc: 0.8267
 Site-cartoon-1                     | Train Loss: 0.6641 | Train Acc: 0.8156
 Site-sketch-0                      | Train Loss: 1.0417 | Train Acc: 0.6667
 Site-sketch-1                      | Train Loss: 0.9910 | Train Acc: 0.6622
Average Train Accuracy: 0.8397
 Test site-photo-0                   | Epoch:18 | Test Acc: 0.9940
 Test site-photo-1                   | Epoch:18 | Test Acc: 1.0000
 Test site-art_painting-0            | Epoch:18 | Test Acc: 0.9122
 Test site-art_painting-1            | Epoch:18 | Test Acc: 0.9024
 Test site-cartoon-0                 | Epoch:18 | Test Acc: 0.8128
 Test site-cartoon-1                 | Epoch:18 | Test Acc: 0.8241
 Test site-sketch-0                  | Epoch:18 | Test Acc: 0.6514
 Test site-sketch-1                  | Epoch:18 | Test Acc: 0.6441
photo-0: 0.9940, photo-1: 1.0000, art_painting-0: 0.9122, art_painting-1: 0.9024, cartoon-0: 0.8128, cartoon-1: 0.8241, sketch-0: 0.6514, sketch-1: 0.6441, 
Average Test Accuracy(group): 0.8426, Average Test Accuracy(individual): 0.8426,
domain std=0.1291, cluster std=-1.0000, individual std=0.1291, 
============ Train epoch 20 ============
 Site-photo-0                       | Train Loss: 0.0780 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.0913 | Train Acc: 0.9889
 Site-art_painting-0                | Train Loss: 0.5791 | Train Acc: 0.8533
 Site-art_painting-1                | Train Loss: 0.4522 | Train Acc: 0.9044
 Site-cartoon-0                     | Train Loss: 0.6280 | Train Acc: 0.8600
 Site-cartoon-1                     | Train Loss: 0.6224 | Train Acc: 0.8267
 Site-sketch-0                      | Train Loss: 1.0260 | Train Acc: 0.6333
 Site-sketch-1                      | Train Loss: 0.9755 | Train Acc: 0.6756
Average Train Accuracy: 0.8428
 Best site-photo-0                   | Epoch:20 | Val Acc: 1.0000
 Best site-photo-1                   | Epoch:20 | Val Acc: 0.9889
 Best site-art_painting-0            | Epoch:20 | Val Acc: 0.8533
 Best site-art_painting-1            | Epoch:20 | Val Acc: 0.9044
 Best site-cartoon-0                 | Epoch:20 | Val Acc: 0.8600
 Best site-cartoon-1                 | Epoch:20 | Val Acc: 0.8267
 Best site-sketch-0                  | Epoch:20 | Val Acc: 0.6333
 Best site-sketch-1                  | Epoch:20 | Val Acc: 0.6756
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 21 ============
 Site-photo-0                       | Train Loss: 0.0867 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.0851 | Train Acc: 0.9867
 Site-art_painting-0                | Train Loss: 0.5729 | Train Acc: 0.8467
 Site-art_painting-1                | Train Loss: 0.4623 | Train Acc: 0.8822
 Site-cartoon-0                     | Train Loss: 0.5741 | Train Acc: 0.8533
 Site-cartoon-1                     | Train Loss: 0.6028 | Train Acc: 0.8444
 Site-sketch-0                      | Train Loss: 1.0137 | Train Acc: 0.6533
 Site-sketch-1                      | Train Loss: 0.9206 | Train Acc: 0.6778
Average Train Accuracy: 0.8431
 Best site-photo-0                   | Epoch:21 | Val Acc: 1.0000
 Best site-photo-1                   | Epoch:21 | Val Acc: 0.9867
 Best site-art_painting-0            | Epoch:21 | Val Acc: 0.8467
 Best site-art_painting-1            | Epoch:21 | Val Acc: 0.8822
 Best site-cartoon-0                 | Epoch:21 | Val Acc: 0.8533
 Best site-cartoon-1                 | Epoch:21 | Val Acc: 0.8444
 Best site-sketch-0                  | Epoch:21 | Val Acc: 0.6533
 Best site-sketch-1                  | Epoch:21 | Val Acc: 0.6778
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 22 ============
 Site-photo-0                       | Train Loss: 0.0698 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.0765 | Train Acc: 0.9889
 Site-art_painting-0                | Train Loss: 0.5520 | Train Acc: 0.8600
 Site-art_painting-1                | Train Loss: 0.4386 | Train Acc: 0.9111
 Site-cartoon-0                     | Train Loss: 0.6254 | Train Acc: 0.8333
 Site-cartoon-1                     | Train Loss: 0.6065 | Train Acc: 0.8400
 Site-sketch-0                      | Train Loss: 1.0206 | Train Acc: 0.6333
 Site-sketch-1                      | Train Loss: 0.9590 | Train Acc: 0.6844
Average Train Accuracy: 0.8439
 Best site-photo-0                   | Epoch:22 | Val Acc: 1.0000
 Best site-photo-1                   | Epoch:22 | Val Acc: 0.9889
 Best site-art_painting-0            | Epoch:22 | Val Acc: 0.8600
 Best site-art_painting-1            | Epoch:22 | Val Acc: 0.9111
 Best site-cartoon-0                 | Epoch:22 | Val Acc: 0.8333
 Best site-cartoon-1                 | Epoch:22 | Val Acc: 0.8400
 Best site-sketch-0                  | Epoch:22 | Val Acc: 0.6333
 Best site-sketch-1                  | Epoch:22 | Val Acc: 0.6844
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 23 ============
 Site-photo-0                       | Train Loss: 0.0562 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.0853 | Train Acc: 0.9822
 Site-art_painting-0                | Train Loss: 0.5314 | Train Acc: 0.8533
 Site-art_painting-1                | Train Loss: 0.4175 | Train Acc: 0.9133
 Site-cartoon-0                     | Train Loss: 0.5870 | Train Acc: 0.8400
 Site-cartoon-1                     | Train Loss: 0.6049 | Train Acc: 0.8467
 Site-sketch-0                      | Train Loss: 1.0145 | Train Acc: 0.6467
 Site-sketch-1                      | Train Loss: 1.0476 | Train Acc: 0.6867
Average Train Accuracy: 0.8461
 Best site-photo-0                   | Epoch:23 | Val Acc: 1.0000
 Best site-photo-1                   | Epoch:23 | Val Acc: 0.9822
 Best site-art_painting-0            | Epoch:23 | Val Acc: 0.8533
 Best site-art_painting-1            | Epoch:23 | Val Acc: 0.9133
 Best site-cartoon-0                 | Epoch:23 | Val Acc: 0.8400
 Best site-cartoon-1                 | Epoch:23 | Val Acc: 0.8467
 Best site-sketch-0                  | Epoch:23 | Val Acc: 0.6467
 Best site-sketch-1                  | Epoch:23 | Val Acc: 0.6867
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 24 ============
 Site-photo-0                       | Train Loss: 0.0631 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.0765 | Train Acc: 0.9889
 Site-art_painting-0                | Train Loss: 0.5414 | Train Acc: 0.8667
 Site-art_painting-1                | Train Loss: 0.4047 | Train Acc: 0.9044
 Site-cartoon-0                     | Train Loss: 0.5432 | Train Acc: 0.8667
 Site-cartoon-1                     | Train Loss: 0.6704 | Train Acc: 0.8311
 Site-sketch-0                      | Train Loss: 0.9680 | Train Acc: 0.6467
 Site-sketch-1                      | Train Loss: 0.9703 | Train Acc: 0.7044
Average Train Accuracy: 0.8511
 Best site-photo-0                   | Epoch:24 | Val Acc: 1.0000
 Best site-photo-1                   | Epoch:24 | Val Acc: 0.9889
 Best site-art_painting-0            | Epoch:24 | Val Acc: 0.8667
 Best site-art_painting-1            | Epoch:24 | Val Acc: 0.9044
 Best site-cartoon-0                 | Epoch:24 | Val Acc: 0.8667
 Best site-cartoon-1                 | Epoch:24 | Val Acc: 0.8311
 Best site-sketch-0                  | Epoch:24 | Val Acc: 0.6467
 Best site-sketch-1                  | Epoch:24 | Val Acc: 0.7044
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 25 ============
 Site-photo-0                       | Train Loss: 0.0625 | Train Acc: 0.9933
 Site-photo-1                       | Train Loss: 0.0650 | Train Acc: 0.9911
 Site-art_painting-0                | Train Loss: 0.4883 | Train Acc: 0.8667
 Site-art_painting-1                | Train Loss: 0.4227 | Train Acc: 0.8956
 Site-cartoon-0                     | Train Loss: 0.5673 | Train Acc: 0.8800
 Site-cartoon-1                     | Train Loss: 0.6103 | Train Acc: 0.8311
 Site-sketch-0                      | Train Loss: 0.9214 | Train Acc: 0.6733
 Site-sketch-1                      | Train Loss: 0.9637 | Train Acc: 0.7267
Average Train Accuracy: 0.8572
 Best site-photo-0                   | Epoch:25 | Val Acc: 0.9933
 Best site-photo-1                   | Epoch:25 | Val Acc: 0.9911
 Best site-art_painting-0            | Epoch:25 | Val Acc: 0.8667
 Best site-art_painting-1            | Epoch:25 | Val Acc: 0.8956
 Best site-cartoon-0                 | Epoch:25 | Val Acc: 0.8800
 Best site-cartoon-1                 | Epoch:25 | Val Acc: 0.8311
 Best site-sketch-0                  | Epoch:25 | Val Acc: 0.6733
 Best site-sketch-1                  | Epoch:25 | Val Acc: 0.7267
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 26 ============
 Site-photo-0                       | Train Loss: 0.0620 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0558 | Train Acc: 0.9889
 Site-art_painting-0                | Train Loss: 0.4814 | Train Acc: 0.8533
 Site-art_painting-1                | Train Loss: 0.3915 | Train Acc: 0.9044
 Site-cartoon-0                     | Train Loss: 0.5506 | Train Acc: 0.8933
 Site-cartoon-1                     | Train Loss: 0.5547 | Train Acc: 0.8467
 Site-sketch-0                      | Train Loss: 0.9350 | Train Acc: 0.7000
 Site-sketch-1                      | Train Loss: 0.8776 | Train Acc: 0.6867
Average Train Accuracy: 0.8575
 Best site-photo-0                   | Epoch:26 | Val Acc: 0.9867
 Best site-photo-1                   | Epoch:26 | Val Acc: 0.9889
 Best site-art_painting-0            | Epoch:26 | Val Acc: 0.8533
 Best site-art_painting-1            | Epoch:26 | Val Acc: 0.9044
 Best site-cartoon-0                 | Epoch:26 | Val Acc: 0.8933
 Best site-cartoon-1                 | Epoch:26 | Val Acc: 0.8467
 Best site-sketch-0                  | Epoch:26 | Val Acc: 0.7000
 Best site-sketch-1                  | Epoch:26 | Val Acc: 0.6867
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 27 ============
 Site-photo-0                       | Train Loss: 0.0455 | Train Acc: 0.9933
 Site-photo-1                       | Train Loss: 0.0673 | Train Acc: 0.9867
 Site-art_painting-0                | Train Loss: 0.4898 | Train Acc: 0.8733
 Site-art_painting-1                | Train Loss: 0.4210 | Train Acc: 0.8911
 Site-cartoon-0                     | Train Loss: 0.5648 | Train Acc: 0.8733
 Site-cartoon-1                     | Train Loss: 0.6068 | Train Acc: 0.8644
 Site-sketch-0                      | Train Loss: 0.9344 | Train Acc: 0.6933
 Site-sketch-1                      | Train Loss: 0.8923 | Train Acc: 0.6800
Average Train Accuracy: 0.8569
============ Train epoch 28 ============
 Site-photo-0                       | Train Loss: 0.0457 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.0624 | Train Acc: 0.9844
 Site-art_painting-0                | Train Loss: 0.5003 | Train Acc: 0.8800
 Site-art_painting-1                | Train Loss: 0.3601 | Train Acc: 0.9000
 Site-cartoon-0                     | Train Loss: 0.5650 | Train Acc: 0.8267
 Site-cartoon-1                     | Train Loss: 0.5094 | Train Acc: 0.8733
 Site-sketch-0                      | Train Loss: 0.9087 | Train Acc: 0.6467
 Site-sketch-1                      | Train Loss: 0.9175 | Train Acc: 0.7422
Average Train Accuracy: 0.8567
============ Train epoch 29 ============
 Site-photo-0                       | Train Loss: 0.0369 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.0491 | Train Acc: 0.9911
 Site-art_painting-0                | Train Loss: 0.4280 | Train Acc: 0.9000
 Site-art_painting-1                | Train Loss: 0.3842 | Train Acc: 0.8956
 Site-cartoon-0                     | Train Loss: 0.5117 | Train Acc: 0.8933
 Site-cartoon-1                     | Train Loss: 0.5100 | Train Acc: 0.8600
 Site-sketch-0                      | Train Loss: 0.9347 | Train Acc: 0.6467
 Site-sketch-1                      | Train Loss: 0.8555 | Train Acc: 0.7289
Average Train Accuracy: 0.8644
 Best site-photo-0                   | Epoch:29 | Val Acc: 1.0000
 Best site-photo-1                   | Epoch:29 | Val Acc: 0.9911
 Best site-art_painting-0            | Epoch:29 | Val Acc: 0.9000
 Best site-art_painting-1            | Epoch:29 | Val Acc: 0.8956
 Best site-cartoon-0                 | Epoch:29 | Val Acc: 0.8933
 Best site-cartoon-1                 | Epoch:29 | Val Acc: 0.8600
 Best site-sketch-0                  | Epoch:29 | Val Acc: 0.6467
 Best site-sketch-1                  | Epoch:29 | Val Acc: 0.7289
 Test site-photo-0                   | Epoch:29 | Test Acc: 0.9940
 Test site-photo-1                   | Epoch:29 | Test Acc: 1.0000
 Test site-art_painting-0            | Epoch:29 | Test Acc: 0.9220
 Test site-art_painting-1            | Epoch:29 | Test Acc: 0.9089
 Test site-cartoon-0                 | Epoch:29 | Test Acc: 0.8383
 Test site-cartoon-1                 | Epoch:29 | Test Acc: 0.8411
 Test site-sketch-0                  | Epoch:29 | Test Acc: 0.6947
 Test site-sketch-1                  | Epoch:29 | Test Acc: 0.6864
photo-0: 0.9940, photo-1: 1.0000, art_painting-0: 0.9220, art_painting-1: 0.9089, cartoon-0: 0.8383, cartoon-1: 0.8411, sketch-0: 0.6947, sketch-1: 0.6864, 
Average Test Accuracy(group): 0.8607, Average Test Accuracy(individual): 0.8607,
domain std=0.1130, cluster std=-1.0000, individual std=0.1130, 
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 30 ============
 Site-photo-0                       | Train Loss: 0.0467 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.0574 | Train Acc: 0.9844
 Site-art_painting-0                | Train Loss: 0.4629 | Train Acc: 0.8867
 Site-art_painting-1                | Train Loss: 0.3855 | Train Acc: 0.8867
 Site-cartoon-0                     | Train Loss: 0.5413 | Train Acc: 0.8267
 Site-cartoon-1                     | Train Loss: 0.5253 | Train Acc: 0.8578
 Site-sketch-0                      | Train Loss: 0.9556 | Train Acc: 0.6467
 Site-sketch-1                      | Train Loss: 0.8660 | Train Acc: 0.7089
Average Train Accuracy: 0.8497
============ Train epoch 31 ============
 Site-photo-0                       | Train Loss: 0.0426 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.0509 | Train Acc: 0.9889
 Site-art_painting-0                | Train Loss: 0.4840 | Train Acc: 0.8733
 Site-art_painting-1                | Train Loss: 0.3544 | Train Acc: 0.9044
 Site-cartoon-0                     | Train Loss: 0.5380 | Train Acc: 0.8533
 Site-cartoon-1                     | Train Loss: 0.5303 | Train Acc: 0.8356
 Site-sketch-0                      | Train Loss: 0.9152 | Train Acc: 0.6533
 Site-sketch-1                      | Train Loss: 0.8503 | Train Acc: 0.7222
Average Train Accuracy: 0.8539
============ Train epoch 32 ============
===2023-08-17 02:53:28===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
===2023-08-17 02:54:14===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
===2023-08-17 02:56:19===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
Loading snapshots...
 Test site-photo-0                   | Epoch:29 | Test Acc: 0.9940
 Test site-photo-1                   | Epoch:29 | Test Acc: 1.0000
 Test site-art_painting-0            | Epoch:29 | Test Acc: 0.9220
 Test site-art_painting-1            | Epoch:29 | Test Acc: 0.9089
 Test site-cartoon-0                 | Epoch:29 | Test Acc: 0.8383
 Test site-cartoon-1                 | Epoch:29 | Test Acc: 0.8411
 Test site-sketch-0                  | Epoch:29 | Test Acc: 0.6947
 Test site-sketch-1                  | Epoch:29 | Test Acc: 0.6864
photo-0: 0.9940, photo-1: 1.0000, art_painting-0: 0.9220, art_painting-1: 0.9089, cartoon-0: 0.8383, cartoon-1: 0.8411, sketch-0: 0.6947, sketch-1: 0.6864, 
Average Test Accuracy(group): 0.8607, Average Test Accuracy(individual): 0.8607,
domain std=0.1130, cluster std=-1.0000, individual std=0.1130, 
