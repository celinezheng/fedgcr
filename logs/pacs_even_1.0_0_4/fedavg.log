===2023-08-16 17:25:57===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
============ Train epoch 0 ============
 Site-photo                         | Train Loss: 1.7321 | Train Acc: 0.8533
 Site-photo                         | Train Loss: 1.7230 | Train Acc: 0.8356
 Site-art_painting                  | Train Loss: 1.8286 | Train Acc: 0.4667
 Site-art_painting                  | Train Loss: 1.8105 | Train Acc: 0.4933
 Site-cartoon                       | Train Loss: 1.7987 | Train Acc: 0.4933
 Site-cartoon                       | Train Loss: 1.7985 | Train Acc: 0.5422
 Site-sketch                        | Train Loss: 1.8063 | Train Acc: 0.2533
 Site-sketch                        | Train Loss: 1.8082 | Train Acc: 0.2356
Average Train Accuracy: 0.5217
 Best site-photo                     | Epoch:0 | Val Acc: 0.8533
 Best site-photo                     | Epoch:0 | Val Acc: 0.8356
 Best site-art_painting              | Epoch:0 | Val Acc: 0.4667
 Best site-art_painting              | Epoch:0 | Val Acc: 0.4933
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.4933
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.5422
 Best site-sketch                    | Epoch:0 | Val Acc: 0.2533
 Best site-sketch                    | Epoch:0 | Val Acc: 0.2356
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 1 ============
 Site-photo                         | Train Loss: 1.5068 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 1.4961 | Train Acc: 0.9667
 Site-art_painting                  | Train Loss: 1.6839 | Train Acc: 0.6867
 Site-art_painting                  | Train Loss: 1.6547 | Train Acc: 0.6800
 Site-cartoon                       | Train Loss: 1.6466 | Train Acc: 0.7200
 Site-cartoon                       | Train Loss: 1.6479 | Train Acc: 0.6778
 Site-sketch                        | Train Loss: 1.6970 | Train Acc: 0.3333
 Site-sketch                        | Train Loss: 1.7120 | Train Acc: 0.3356
Average Train Accuracy: 0.6725
 Best site-photo                     | Epoch:1 | Val Acc: 0.9800
 Best site-photo                     | Epoch:1 | Val Acc: 0.9667
 Best site-art_painting              | Epoch:1 | Val Acc: 0.6867
 Best site-art_painting              | Epoch:1 | Val Acc: 0.6800
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.7200
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.6778
 Best site-sketch                    | Epoch:1 | Val Acc: 0.3333
 Best site-sketch                    | Epoch:1 | Val Acc: 0.3356
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 2 ============
 Site-photo                         | Train Loss: 1.2698 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 1.2763 | Train Acc: 0.9778
 Site-art_painting                  | Train Loss: 1.5346 | Train Acc: 0.7000
 Site-art_painting                  | Train Loss: 1.5142 | Train Acc: 0.7733
 Site-cartoon                       | Train Loss: 1.5082 | Train Acc: 0.7800
 Site-cartoon                       | Train Loss: 1.5089 | Train Acc: 0.7400
 Site-sketch                        | Train Loss: 1.6170 | Train Acc: 0.4467
 Site-sketch                        | Train Loss: 1.6405 | Train Acc: 0.3956
Average Train Accuracy: 0.7258
 Best site-photo                     | Epoch:2 | Val Acc: 0.9933
 Best site-photo                     | Epoch:2 | Val Acc: 0.9778
 Best site-art_painting              | Epoch:2 | Val Acc: 0.7000
 Best site-art_painting              | Epoch:2 | Val Acc: 0.7733
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.7800
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.7400
 Best site-sketch                    | Epoch:2 | Val Acc: 0.4467
 Best site-sketch                    | Epoch:2 | Val Acc: 0.3956
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 3 ============
 Site-photo                         | Train Loss: 1.0715 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 1.0509 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 1.4002 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 1.3764 | Train Acc: 0.7822
 Site-cartoon                       | Train Loss: 1.3854 | Train Acc: 0.7933
 Site-cartoon                       | Train Loss: 1.4125 | Train Acc: 0.7644
 Site-sketch                        | Train Loss: 1.5264 | Train Acc: 0.5067
 Site-sketch                        | Train Loss: 1.5428 | Train Acc: 0.4956
Average Train Accuracy: 0.7650
 Best site-photo                     | Epoch:3 | Val Acc: 0.9867
 Best site-photo                     | Epoch:3 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8000
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7822
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.7933
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.7644
 Best site-sketch                    | Epoch:3 | Val Acc: 0.5067
 Best site-sketch                    | Epoch:3 | Val Acc: 0.4956
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 4 ============
 Site-photo                         | Train Loss: 0.9062 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.9081 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 1.2789 | Train Acc: 0.7667
 Site-art_painting                  | Train Loss: 1.2409 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 1.3002 | Train Acc: 0.7733
 Site-cartoon                       | Train Loss: 1.3030 | Train Acc: 0.7822
 Site-sketch                        | Train Loss: 1.4785 | Train Acc: 0.5200
 Site-sketch                        | Train Loss: 1.4960 | Train Acc: 0.4533
Average Train Accuracy: 0.7600
============ Train epoch 5 ============
 Site-photo                         | Train Loss: 0.7522 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.7375 | Train Acc: 0.9778
 Site-art_painting                  | Train Loss: 1.1928 | Train Acc: 0.7867
 Site-art_painting                  | Train Loss: 1.1416 | Train Acc: 0.8222
 Site-cartoon                       | Train Loss: 1.2056 | Train Acc: 0.7733
 Site-cartoon                       | Train Loss: 1.2170 | Train Acc: 0.7867
 Site-sketch                        | Train Loss: 1.4230 | Train Acc: 0.5467
 Site-sketch                        | Train Loss: 1.4390 | Train Acc: 0.5333
Average Train Accuracy: 0.7767
 Best site-photo                     | Epoch:5 | Val Acc: 0.9867
 Best site-photo                     | Epoch:5 | Val Acc: 0.9778
 Best site-art_painting              | Epoch:5 | Val Acc: 0.7867
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8222
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.7733
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.7867
 Best site-sketch                    | Epoch:5 | Val Acc: 0.5467
 Best site-sketch                    | Epoch:5 | Val Acc: 0.5333
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 6 ============
 Site-photo                         | Train Loss: 0.6230 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.6006 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 1.1116 | Train Acc: 0.7933
 Site-art_painting                  | Train Loss: 1.1125 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 1.1403 | Train Acc: 0.8067
 Site-cartoon                       | Train Loss: 1.1461 | Train Acc: 0.7800
 Site-sketch                        | Train Loss: 1.3792 | Train Acc: 0.5467
 Site-sketch                        | Train Loss: 1.3843 | Train Acc: 0.5333
Average Train Accuracy: 0.7833
 Best site-photo                     | Epoch:6 | Val Acc: 0.9933
 Best site-photo                     | Epoch:6 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7933
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8267
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.8067
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.7800
 Best site-sketch                    | Epoch:6 | Val Acc: 0.5467
 Best site-sketch                    | Epoch:6 | Val Acc: 0.5333
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 7 ============
 Site-photo                         | Train Loss: 0.5220 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.5136 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 1.0006 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.9839 | Train Acc: 0.8289
 Site-cartoon                       | Train Loss: 1.0407 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 1.0407 | Train Acc: 0.7911
 Site-sketch                        | Train Loss: 1.3196 | Train Acc: 0.5933
 Site-sketch                        | Train Loss: 1.3554 | Train Acc: 0.5578
Average Train Accuracy: 0.7994
 Best site-photo                     | Epoch:7 | Val Acc: 0.9867
 Best site-photo                     | Epoch:7 | Val Acc: 0.9844
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8200
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8289
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.8333
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.7911
 Best site-sketch                    | Epoch:7 | Val Acc: 0.5933
 Best site-sketch                    | Epoch:7 | Val Acc: 0.5578
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 8 ============
 Site-photo                         | Train Loss: 0.4231 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4221 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.9862 | Train Acc: 0.7867
 Site-art_painting                  | Train Loss: 0.8522 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.9667 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 1.0708 | Train Acc: 0.7978
 Site-sketch                        | Train Loss: 1.2717 | Train Acc: 0.5800
 Site-sketch                        | Train Loss: 1.2800 | Train Acc: 0.5867
Average Train Accuracy: 0.8022
 Best site-photo                     | Epoch:8 | Val Acc: 1.0000
 Best site-photo                     | Epoch:8 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:8 | Val Acc: 0.7867
 Best site-art_painting              | Epoch:8 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:8 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:8 | Val Acc: 0.7978
 Best site-sketch                    | Epoch:8 | Val Acc: 0.5800
 Best site-sketch                    | Epoch:8 | Val Acc: 0.5867
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 9 ============
 Site-photo                         | Train Loss: 0.3449 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.3754 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 0.8796 | Train Acc: 0.8067
 Site-art_painting                  | Train Loss: 0.8087 | Train Acc: 0.8644
 Site-cartoon                       | Train Loss: 0.9277 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.9615 | Train Acc: 0.8022
 Site-sketch                        | Train Loss: 1.2613 | Train Acc: 0.5667
 Site-sketch                        | Train Loss: 1.2412 | Train Acc: 0.6133
Average Train Accuracy: 0.8122
 Best site-photo                     | Epoch:9 | Val Acc: 0.9933
 Best site-photo                     | Epoch:9 | Val Acc: 0.9844
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8067
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8644
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.8667
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.8022
 Best site-sketch                    | Epoch:9 | Val Acc: 0.5667
 Best site-sketch                    | Epoch:9 | Val Acc: 0.6133
 Test site-photo                     | Epoch:9 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:9 | Test Acc: 0.8733
 Test site-cartoon                   | Epoch:9 | Test Acc: 0.7894
 Test site-sketch                    | Epoch:9 | Test Acc: 0.5820
photo: 0.9985, art_painting: 0.8733, cartoon: 0.7894, sketch: 0.5820, 
Average Test Accuracy(group): 0.8108, Average Test Accuracy(individual): 0.8108,
domain std=0.1516, cluster std=-1.0000, individual std=0.1516, 
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 10 ============
 Site-photo                         | Train Loss: 0.3110 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.2871 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.8593 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.7418 | Train Acc: 0.8756
 Site-cartoon                       | Train Loss: 0.9055 | Train Acc: 0.7867
 Site-cartoon                       | Train Loss: 0.8892 | Train Acc: 0.8089
 Site-sketch                        | Train Loss: 1.2079 | Train Acc: 0.6267
 Site-sketch                        | Train Loss: 1.2035 | Train Acc: 0.6156
Average Train Accuracy: 0.8147
 Best site-photo                     | Epoch:10 | Val Acc: 0.9933
 Best site-photo                     | Epoch:10 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8200
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8756
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.7867
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.8089
 Best site-sketch                    | Epoch:10 | Val Acc: 0.6267
 Best site-sketch                    | Epoch:10 | Val Acc: 0.6156
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 11 ============
 Site-photo                         | Train Loss: 0.2531 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2502 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.8005 | Train Acc: 0.8133
 Site-art_painting                  | Train Loss: 0.7261 | Train Acc: 0.8844
 Site-cartoon                       | Train Loss: 0.8299 | Train Acc: 0.7867
 Site-cartoon                       | Train Loss: 0.9276 | Train Acc: 0.8089
 Site-sketch                        | Train Loss: 1.1663 | Train Acc: 0.6267
 Site-sketch                        | Train Loss: 1.1878 | Train Acc: 0.6200
Average Train Accuracy: 0.8164
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8133
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8844
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.7867
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.8089
 Best site-sketch                    | Epoch:11 | Val Acc: 0.6267
 Best site-sketch                    | Epoch:11 | Val Acc: 0.6200
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 12 ============
 Site-photo                         | Train Loss: 0.2071 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2381 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.7085 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.6228 | Train Acc: 0.8978
 Site-cartoon                       | Train Loss: 0.8123 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.8287 | Train Acc: 0.8222
 Site-sketch                        | Train Loss: 1.1618 | Train Acc: 0.6467
 Site-sketch                        | Train Loss: 1.1367 | Train Acc: 0.6089
Average Train Accuracy: 0.8319
 Best site-photo                     | Epoch:12 | Val Acc: 1.0000
 Best site-photo                     | Epoch:12 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8978
 Best site-cartoon                   | Epoch:12 | Val Acc: 0.8600
 Best site-cartoon                   | Epoch:12 | Val Acc: 0.8222
 Best site-sketch                    | Epoch:12 | Val Acc: 0.6467
 Best site-sketch                    | Epoch:12 | Val Acc: 0.6089
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 13 ============
 Site-photo                         | Train Loss: 0.1788 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1805 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.7477 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.6690 | Train Acc: 0.8956
 Site-cartoon                       | Train Loss: 0.7968 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.8087 | Train Acc: 0.8222
 Site-sketch                        | Train Loss: 1.1169 | Train Acc: 0.6133
 Site-sketch                        | Train Loss: 1.1217 | Train Acc: 0.6311
Average Train Accuracy: 0.8286
============ Train epoch 14 ============
 Site-photo                         | Train Loss: 0.1474 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2192 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 0.6957 | Train Acc: 0.8533
 Site-art_painting                  | Train Loss: 0.5855 | Train Acc: 0.8844
 Site-cartoon                       | Train Loss: 0.8036 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.7864 | Train Acc: 0.8111
 Site-sketch                        | Train Loss: 1.0809 | Train Acc: 0.6533
 Site-sketch                        | Train Loss: 1.0666 | Train Acc: 0.6711
Average Train Accuracy: 0.8364
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 0.9844
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8533
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8844
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.8333
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.8111
 Best site-sketch                    | Epoch:14 | Val Acc: 0.6533
 Best site-sketch                    | Epoch:14 | Val Acc: 0.6711
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 15 ============
 Site-photo                         | Train Loss: 0.1337 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1391 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.6486 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.5794 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.7237 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.7650 | Train Acc: 0.8133
 Site-sketch                        | Train Loss: 1.0665 | Train Acc: 0.6600
 Site-sketch                        | Train Loss: 1.0617 | Train Acc: 0.6444
Average Train Accuracy: 0.8400
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 0.9889
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8933
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8800
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.8133
 Best site-sketch                    | Epoch:15 | Val Acc: 0.6600
 Best site-sketch                    | Epoch:15 | Val Acc: 0.6444
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 16 ============
 Site-photo                         | Train Loss: 0.1115 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1365 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 0.6749 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.5706 | Train Acc: 0.8778
 Site-cartoon                       | Train Loss: 0.7061 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.6981 | Train Acc: 0.8311
 Site-sketch                        | Train Loss: 1.0663 | Train Acc: 0.6467
 Site-sketch                        | Train Loss: 1.0373 | Train Acc: 0.6533
Average Train Accuracy: 0.8333
============ Train epoch 17 ============
 Site-photo                         | Train Loss: 0.1029 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1249 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.6181 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.5076 | Train Acc: 0.8822
 Site-cartoon                       | Train Loss: 0.6830 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.6734 | Train Acc: 0.8444
 Site-sketch                        | Train Loss: 1.0736 | Train Acc: 0.6533
 Site-sketch                        | Train Loss: 1.0900 | Train Acc: 0.6600
Average Train Accuracy: 0.8358
============ Train epoch 18 ============
 Site-photo                         | Train Loss: 0.1039 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.1046 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.6350 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.5041 | Train Acc: 0.8867
 Site-cartoon                       | Train Loss: 0.6629 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.6586 | Train Acc: 0.8244
 Site-sketch                        | Train Loss: 1.0617 | Train Acc: 0.6400
 Site-sketch                        | Train Loss: 0.9964 | Train Acc: 0.7089
Average Train Accuracy: 0.8450
 Best site-photo                     | Epoch:18 | Val Acc: 0.9933
 Best site-photo                     | Epoch:18 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8867
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.8533
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.8244
 Best site-sketch                    | Epoch:18 | Val Acc: 0.6400
 Best site-sketch                    | Epoch:18 | Val Acc: 0.7089
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 19 ============
 Site-photo                         | Train Loss: 0.0832 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0970 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5734 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.5388 | Train Acc: 0.8956
 Site-cartoon                       | Train Loss: 0.6298 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.6723 | Train Acc: 0.8244
 Site-sketch                        | Train Loss: 1.0237 | Train Acc: 0.6600
 Site-sketch                        | Train Loss: 0.9743 | Train Acc: 0.6667
Average Train Accuracy: 0.8447
 Test site-photo                     | Epoch:18 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:18 | Test Acc: 0.9050
 Test site-cartoon                   | Epoch:18 | Test Acc: 0.8202
 Test site-sketch                    | Epoch:18 | Test Acc: 0.6436
photo: 0.9985, art_painting: 0.9050, cartoon: 0.8202, sketch: 0.6436, 
Average Test Accuracy(group): 0.8418, Average Test Accuracy(individual): 0.8418,
domain std=0.1307, cluster std=-1.0000, individual std=0.1307, 
============ Train epoch 20 ============
 Site-photo                         | Train Loss: 0.0716 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0893 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5500 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.5646 | Train Acc: 0.9133
 Site-cartoon                       | Train Loss: 0.6661 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.6093 | Train Acc: 0.8311
 Site-sketch                        | Train Loss: 1.0441 | Train Acc: 0.6267
 Site-sketch                        | Train Loss: 1.0730 | Train Acc: 0.6667
Average Train Accuracy: 0.8403
============ Train epoch 21 ============
 Site-photo                         | Train Loss: 0.0826 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0794 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.5592 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.4963 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.6272 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.5987 | Train Acc: 0.8511
 Site-sketch                        | Train Loss: 1.0168 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.9864 | Train Acc: 0.6911
Average Train Accuracy: 0.8528
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:21 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:21 | Val Acc: 0.8933
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.8733
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.8511
 Best site-sketch                    | Epoch:21 | Val Acc: 0.6667
 Best site-sketch                    | Epoch:21 | Val Acc: 0.6911
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 22 ============
 Site-photo                         | Train Loss: 0.0747 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0790 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5551 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.4463 | Train Acc: 0.8978
 Site-cartoon                       | Train Loss: 0.6298 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.6033 | Train Acc: 0.8311
 Site-sketch                        | Train Loss: 1.0196 | Train Acc: 0.6533
 Site-sketch                        | Train Loss: 0.9542 | Train Acc: 0.6778
Average Train Accuracy: 0.8397
============ Train epoch 23 ============
 Site-photo                         | Train Loss: 0.0655 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0712 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.5606 | Train Acc: 0.8533
 Site-art_painting                  | Train Loss: 0.4573 | Train Acc: 0.9156
 Site-cartoon                       | Train Loss: 0.6288 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.6312 | Train Acc: 0.8622
 Site-sketch                        | Train Loss: 0.9702 | Train Acc: 0.6400
 Site-sketch                        | Train Loss: 0.9229 | Train Acc: 0.7044
Average Train Accuracy: 0.8511
============ Train epoch 24 ============
 Site-photo                         | Train Loss: 0.0713 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0669 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5114 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.4359 | Train Acc: 0.9133
 Site-cartoon                       | Train Loss: 0.5987 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.5724 | Train Acc: 0.8533
 Site-sketch                        | Train Loss: 0.9665 | Train Acc: 0.6867
 Site-sketch                        | Train Loss: 0.9545 | Train Acc: 0.6844
Average Train Accuracy: 0.8569
 Best site-photo                     | Epoch:24 | Val Acc: 0.9933
 Best site-photo                     | Epoch:24 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:24 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:24 | Val Acc: 0.9133
 Best site-cartoon                   | Epoch:24 | Val Acc: 0.8733
 Best site-cartoon                   | Epoch:24 | Val Acc: 0.8533
 Best site-sketch                    | Epoch:24 | Val Acc: 0.6867
 Best site-sketch                    | Epoch:24 | Val Acc: 0.6844
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 25 ============
 Site-photo                         | Train Loss: 0.0465 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0712 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.4984 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.4024 | Train Acc: 0.8978
 Site-cartoon                       | Train Loss: 0.5350 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.6298 | Train Acc: 0.8333
 Site-sketch                        | Train Loss: 0.9277 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.9151 | Train Acc: 0.7156
Average Train Accuracy: 0.8575
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8978
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.9000
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.8333
 Best site-sketch                    | Epoch:25 | Val Acc: 0.6667
 Best site-sketch                    | Epoch:25 | Val Acc: 0.7156
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 26 ============
 Site-photo                         | Train Loss: 0.0483 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0744 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 0.5026 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.4008 | Train Acc: 0.9067
 Site-cartoon                       | Train Loss: 0.6098 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.5553 | Train Acc: 0.8533
 Site-sketch                        | Train Loss: 0.9444 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.8924 | Train Acc: 0.7178
Average Train Accuracy: 0.8528
============ Train epoch 27 ============
 Site-photo                         | Train Loss: 0.0408 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0603 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.4970 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.3901 | Train Acc: 0.9067
 Site-cartoon                       | Train Loss: 0.5251 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.5796 | Train Acc: 0.8333
 Site-sketch                        | Train Loss: 0.9789 | Train Acc: 0.6467
 Site-sketch                        | Train Loss: 0.8949 | Train Acc: 0.6867
Average Train Accuracy: 0.8494
============ Train epoch 28 ============
 Site-photo                         | Train Loss: 0.0589 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0555 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.5076 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.4021 | Train Acc: 0.9178
 Site-cartoon                       | Train Loss: 0.5549 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.5495 | Train Acc: 0.8400
 Site-sketch                        | Train Loss: 0.9177 | Train Acc: 0.6867
 Site-sketch                        | Train Loss: 0.8604 | Train Acc: 0.7111
Average Train Accuracy: 0.8547
============ Train epoch 29 ============
 Site-photo                         | Train Loss: 0.0478 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0462 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.5221 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.3615 | Train Acc: 0.9111
 Site-cartoon                       | Train Loss: 0.5337 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.5362 | Train Acc: 0.8578
 Site-sketch                        | Train Loss: 0.9263 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.9020 | Train Acc: 0.6756
Average Train Accuracy: 0.8531
 Test site-photo                     | Epoch:25 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:25 | Test Acc: 0.9074
 Test site-cartoon                   | Epoch:25 | Test Acc: 0.8372
 Test site-sketch                    | Epoch:25 | Test Acc: 0.6874
photo: 0.9985, art_painting: 0.9074, cartoon: 0.8372, sketch: 0.6874, 
Average Test Accuracy(group): 0.8576, Average Test Accuracy(individual): 0.8576,
domain std=0.1137, cluster std=-1.0000, individual std=0.1137, 
============ Train epoch 30 ============
 Site-photo                         | Train Loss: 0.0431 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0539 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.4515 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.3804 | Train Acc: 0.9111
 Site-cartoon                       | Train Loss: 0.5176 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.5295 | Train Acc: 0.8422
 Site-sketch                        | Train Loss: 0.9198 | Train Acc: 0.6733
 Site-sketch                        | Train Loss: 0.8902 | Train Acc: 0.7244
Average Train Accuracy: 0.8589
 Best site-photo                     | Epoch:30 | Val Acc: 1.0000
 Best site-photo                     | Epoch:30 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:30 | Val Acc: 0.8733
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9111
 Best site-cartoon                   | Epoch:30 | Val Acc: 0.8533
 Best site-cartoon                   | Epoch:30 | Val Acc: 0.8422
 Best site-sketch                    | Epoch:30 | Val Acc: 0.6733
 Best site-sketch                    | Epoch:30 | Val Acc: 0.7244
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 31 ============
 Site-photo                         | Train Loss: 0.0338 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0519 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.4520 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.3551 | Train Acc: 0.9067
 Site-cartoon                       | Train Loss: 0.4872 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.5600 | Train Acc: 0.8333
 Site-sketch                        | Train Loss: 0.9037 | Train Acc: 0.6933
 Site-sketch                        | Train Loss: 0.9071 | Train Acc: 0.7089
Average Train Accuracy: 0.8622
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 0.9889
 Best site-art_painting              | Epoch:31 | Val Acc: 0.8867
 Best site-art_painting              | Epoch:31 | Val Acc: 0.9067
 Best site-cartoon                   | Epoch:31 | Val Acc: 0.8800
 Best site-cartoon                   | Epoch:31 | Val Acc: 0.8333
 Best site-sketch                    | Epoch:31 | Val Acc: 0.6933
 Best site-sketch                    | Epoch:31 | Val Acc: 0.7089
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 32 ============
 Site-photo                         | Train Loss: 0.0382 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0501 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.4793 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.3466 | Train Acc: 0.9200
 Site-cartoon                       | Train Loss: 0.5326 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.5182 | Train Acc: 0.8644
 Site-sketch                        | Train Loss: 0.9149 | Train Acc: 0.6933
 Site-sketch                        | Train Loss: 0.8714 | Train Acc: 0.6911
Average Train Accuracy: 0.8639
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-photo                     | Epoch:32 | Val Acc: 0.9889
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:32 | Val Acc: 0.9200
 Best site-cartoon                   | Epoch:32 | Val Acc: 0.8933
 Best site-cartoon                   | Epoch:32 | Val Acc: 0.8644
 Best site-sketch                    | Epoch:32 | Val Acc: 0.6933
 Best site-sketch                    | Epoch:32 | Val Acc: 0.6911
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 33 ============
 Site-photo                         | Train Loss: 0.0344 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0412 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.5038 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.3400 | Train Acc: 0.9244
 Site-cartoon                       | Train Loss: 0.4960 | Train Acc: 0.9133
 Site-cartoon                       | Train Loss: 0.5003 | Train Acc: 0.8489
 Site-sketch                        | Train Loss: 0.9466 | Train Acc: 0.6467
 Site-sketch                        | Train Loss: 0.7973 | Train Acc: 0.7289
Average Train Accuracy: 0.8644
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9244
 Best site-cartoon                   | Epoch:33 | Val Acc: 0.9133
 Best site-cartoon                   | Epoch:33 | Val Acc: 0.8489
 Best site-sketch                    | Epoch:33 | Val Acc: 0.6467
 Best site-sketch                    | Epoch:33 | Val Acc: 0.7289
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 34 ============
 Site-photo                         | Train Loss: 0.0359 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0523 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4400 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.3218 | Train Acc: 0.9267
 Site-cartoon                       | Train Loss: 0.4725 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.5093 | Train Acc: 0.8711
 Site-sketch                        | Train Loss: 0.8720 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.8653 | Train Acc: 0.7422
Average Train Accuracy: 0.8672
 Best site-photo                     | Epoch:34 | Val Acc: 0.9867
 Best site-photo                     | Epoch:34 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:34 | Val Acc: 0.8800
 Best site-art_painting              | Epoch:34 | Val Acc: 0.9267
 Best site-cartoon                   | Epoch:34 | Val Acc: 0.8733
 Best site-cartoon                   | Epoch:34 | Val Acc: 0.8711
 Best site-sketch                    | Epoch:34 | Val Acc: 0.6667
 Best site-sketch                    | Epoch:34 | Val Acc: 0.7422
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 35 ============
 Site-photo                         | Train Loss: 0.0425 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0558 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 0.4082 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.3212 | Train Acc: 0.9133
 Site-cartoon                       | Train Loss: 0.5098 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.5573 | Train Acc: 0.8511
 Site-sketch                        | Train Loss: 0.8744 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.8751 | Train Acc: 0.7156
Average Train Accuracy: 0.8664
============ Train epoch 36 ============
 Site-photo                         | Train Loss: 0.0288 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0508 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4450 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.3511 | Train Acc: 0.9200
 Site-cartoon                       | Train Loss: 0.4858 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.4984 | Train Acc: 0.8600
 Site-sketch                        | Train Loss: 0.8924 | Train Acc: 0.6933
 Site-sketch                        | Train Loss: 0.7931 | Train Acc: 0.7356
Average Train Accuracy: 0.8725
 Best site-photo                     | Epoch:36 | Val Acc: 1.0000
 Best site-photo                     | Epoch:36 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:36 | Val Acc: 0.8867
 Best site-art_painting              | Epoch:36 | Val Acc: 0.9200
 Best site-cartoon                   | Epoch:36 | Val Acc: 0.8933
 Best site-cartoon                   | Epoch:36 | Val Acc: 0.8600
 Best site-sketch                    | Epoch:36 | Val Acc: 0.6933
 Best site-sketch                    | Epoch:36 | Val Acc: 0.7356
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 37 ============
 Site-photo                         | Train Loss: 0.0200 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0436 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.4556 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.3113 | Train Acc: 0.9178
 Site-cartoon                       | Train Loss: 0.4764 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.4939 | Train Acc: 0.8578
 Site-sketch                        | Train Loss: 0.8830 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.8408 | Train Acc: 0.7311
Average Train Accuracy: 0.8650
============ Train epoch 38 ============
 Site-photo                         | Train Loss: 0.0245 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1022 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.4013 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.3714 | Train Acc: 0.9156
 Site-cartoon                       | Train Loss: 0.4937 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.5050 | Train Acc: 0.8689
 Site-sketch                        | Train Loss: 0.8450 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.8027 | Train Acc: 0.7289
Average Train Accuracy: 0.8717
============ Train epoch 39 ============
 Site-photo                         | Train Loss: 0.0253 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0345 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4177 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.3029 | Train Acc: 0.9267
 Site-cartoon                       | Train Loss: 0.5009 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.4794 | Train Acc: 0.8622
 Site-sketch                        | Train Loss: 0.8765 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.8110 | Train Acc: 0.7044
Average Train Accuracy: 0.8672
 Test site-photo                     | Epoch:36 | Test Acc: 1.0000
 Test site-art_painting              | Epoch:36 | Test Acc: 0.9184
 Test site-cartoon                   | Epoch:36 | Test Acc: 0.8489
 Test site-sketch                    | Epoch:36 | Test Acc: 0.7122
photo: 1.0000, art_painting: 0.9184, cartoon: 0.8489, sketch: 0.7122, 
Average Test Accuracy(group): 0.8699, Average Test Accuracy(individual): 0.8699,
domain std=0.1056, cluster std=-1.0000, individual std=0.1056, 
============ Train epoch 40 ============
 Site-photo                         | Train Loss: 0.0279 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0408 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.4532 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.3116 | Train Acc: 0.9222
 Site-cartoon                       | Train Loss: 0.4627 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.4388 | Train Acc: 0.8778
 Site-sketch                        | Train Loss: 0.8790 | Train Acc: 0.6867
 Site-sketch                        | Train Loss: 0.7657 | Train Acc: 0.7556
Average Train Accuracy: 0.8736
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:40 | Val Acc: 0.8933
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9222
 Best site-cartoon                   | Epoch:40 | Val Acc: 0.8600
 Best site-cartoon                   | Epoch:40 | Val Acc: 0.8778
 Best site-sketch                    | Epoch:40 | Val Acc: 0.6867
 Best site-sketch                    | Epoch:40 | Val Acc: 0.7556
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 41 ============
 Site-photo                         | Train Loss: 0.0334 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0349 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4179 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.2777 | Train Acc: 0.9333
 Site-cartoon                       | Train Loss: 0.4630 | Train Acc: 0.8867
 Site-cartoon                       | Train Loss: 0.4637 | Train Acc: 0.8733
 Site-sketch                        | Train Loss: 0.8528 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.8246 | Train Acc: 0.7400
Average Train Accuracy: 0.8739
 Best site-photo                     | Epoch:41 | Val Acc: 0.9933
 Best site-photo                     | Epoch:41 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:41 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:41 | Val Acc: 0.9333
 Best site-cartoon                   | Epoch:41 | Val Acc: 0.8867
 Best site-cartoon                   | Epoch:41 | Val Acc: 0.8733
 Best site-sketch                    | Epoch:41 | Val Acc: 0.7067
 Best site-sketch                    | Epoch:41 | Val Acc: 0.7400
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 42 ============
 Site-photo                         | Train Loss: 0.0254 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0287 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4244 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.3045 | Train Acc: 0.9156
 Site-cartoon                       | Train Loss: 0.4208 | Train Acc: 0.9267
 Site-cartoon                       | Train Loss: 0.4601 | Train Acc: 0.8778
 Site-sketch                        | Train Loss: 0.8818 | Train Acc: 0.6600
 Site-sketch                        | Train Loss: 0.8121 | Train Acc: 0.7222
Average Train Accuracy: 0.8725
============ Train epoch 43 ============
 Site-photo                         | Train Loss: 0.0250 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0261 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.4390 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.3693 | Train Acc: 0.9200
 Site-cartoon                       | Train Loss: 0.4330 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.4550 | Train Acc: 0.8822
 Site-sketch                        | Train Loss: 0.8796 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.7372 | Train Acc: 0.7800
Average Train Accuracy: 0.8753
 Best site-photo                     | Epoch:43 | Val Acc: 1.0000
 Best site-photo                     | Epoch:43 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:43 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9200
 Best site-cartoon                   | Epoch:43 | Val Acc: 0.9000
 Best site-cartoon                   | Epoch:43 | Val Acc: 0.8822
 Best site-sketch                    | Epoch:43 | Val Acc: 0.6667
 Best site-sketch                    | Epoch:43 | Val Acc: 0.7800
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 44 ============
 Site-photo                         | Train Loss: 0.0262 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0405 | Train Acc: 0.9822
 Site-art_painting                  | Train Loss: 0.4774 | Train Acc: 0.8533
 Site-art_painting                  | Train Loss: 0.3044 | Train Acc: 0.9244
 Site-cartoon                       | Train Loss: 0.4433 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.4516 | Train Acc: 0.8556
 Site-sketch                        | Train Loss: 0.8765 | Train Acc: 0.6800
 Site-sketch                        | Train Loss: 0.7564 | Train Acc: 0.7444
Average Train Accuracy: 0.8650
============ Train epoch 45 ============
 Site-photo                         | Train Loss: 0.0226 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0369 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.3762 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.3250 | Train Acc: 0.9044
 Site-cartoon                       | Train Loss: 0.4513 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.4262 | Train Acc: 0.8689
 Site-sketch                        | Train Loss: 0.7877 | Train Acc: 0.7267
 Site-sketch                        | Train Loss: 0.7310 | Train Acc: 0.7756
Average Train Accuracy: 0.8800
 Best site-photo                     | Epoch:45 | Val Acc: 1.0000
 Best site-photo                     | Epoch:45 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:45 | Val Acc: 0.8733
 Best site-art_painting              | Epoch:45 | Val Acc: 0.9044
 Best site-cartoon                   | Epoch:45 | Val Acc: 0.9000
 Best site-cartoon                   | Epoch:45 | Val Acc: 0.8689
 Best site-sketch                    | Epoch:45 | Val Acc: 0.7267
 Best site-sketch                    | Epoch:45 | Val Acc: 0.7756
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 46 ============
 Site-photo                         | Train Loss: 0.0249 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0317 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4347 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.3203 | Train Acc: 0.9133
 Site-cartoon                       | Train Loss: 0.4365 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.4256 | Train Acc: 0.8778
 Site-sketch                        | Train Loss: 0.8115 | Train Acc: 0.7333
 Site-sketch                        | Train Loss: 0.7625 | Train Acc: 0.7644
Average Train Accuracy: 0.8800
 Best site-photo                     | Epoch:46 | Val Acc: 0.9933
 Best site-photo                     | Epoch:46 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:46 | Val Acc: 0.8733
 Best site-art_painting              | Epoch:46 | Val Acc: 0.9133
 Best site-cartoon                   | Epoch:46 | Val Acc: 0.8933
 Best site-cartoon                   | Epoch:46 | Val Acc: 0.8778
 Best site-sketch                    | Epoch:46 | Val Acc: 0.7333
 Best site-sketch                    | Epoch:46 | Val Acc: 0.7644
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 47 ============
 Site-photo                         | Train Loss: 0.0159 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0363 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.3706 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.3164 | Train Acc: 0.9289
 Site-cartoon                       | Train Loss: 0.4404 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.4194 | Train Acc: 0.8800
 Site-sketch                        | Train Loss: 0.8201 | Train Acc: 0.7000
 Site-sketch                        | Train Loss: 0.7565 | Train Acc: 0.7444
Average Train Accuracy: 0.8772
============ Train epoch 48 ============
 Site-photo                         | Train Loss: 0.0195 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0274 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.3749 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.3452 | Train Acc: 0.9356
 Site-cartoon                       | Train Loss: 0.4325 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.4157 | Train Acc: 0.8822
 Site-sketch                        | Train Loss: 0.8285 | Train Acc: 0.7000
 Site-sketch                        | Train Loss: 0.7984 | Train Acc: 0.7422
Average Train Accuracy: 0.8733
============ Train epoch 49 ============
 Site-photo                         | Train Loss: 0.0231 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0241 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.4542 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.3288 | Train Acc: 0.9222
 Site-cartoon                       | Train Loss: 0.4256 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.4813 | Train Acc: 0.8689
 Site-sketch                        | Train Loss: 0.8196 | Train Acc: 0.7000
 Site-sketch                        | Train Loss: 0.7867 | Train Acc: 0.7356
Average Train Accuracy: 0.8733
 Test site-photo                     | Epoch:46 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:46 | Test Acc: 0.9220
 Test site-cartoon                   | Epoch:46 | Test Acc: 0.8553
 Test site-sketch                    | Epoch:46 | Test Acc: 0.7294
photo: 0.9985, art_painting: 0.9220, cartoon: 0.8553, sketch: 0.7294, 
Average Test Accuracy(group): 0.8763, Average Test Accuracy(individual): 0.8763,
domain std=0.0988, cluster std=-1.0000, individual std=0.0988, 
===2023-08-16 18:04:39===
===2023-08-17 01:46:16===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
============ Train epoch 0 ============
 Site-photo                         | Train Loss: 1.7321 | Train Acc: 0.8533
 Site-photo                         | Train Loss: 1.7230 | Train Acc: 0.8356
 Site-art_painting                  | Train Loss: 1.8286 | Train Acc: 0.4667
 Site-art_painting                  | Train Loss: 1.8105 | Train Acc: 0.4933
 Site-cartoon                       | Train Loss: 1.7987 | Train Acc: 0.4933
 Site-cartoon                       | Train Loss: 1.7985 | Train Acc: 0.5422
 Site-sketch                        | Train Loss: 1.8063 | Train Acc: 0.2533
 Site-sketch                        | Train Loss: 1.8082 | Train Acc: 0.2356
Average Train Accuracy: 0.5217
 Best site-photo                     | Epoch:0 | Val Acc: 0.8533
 Best site-photo                     | Epoch:0 | Val Acc: 0.8356
 Best site-art_painting              | Epoch:0 | Val Acc: 0.4667
 Best site-art_painting              | Epoch:0 | Val Acc: 0.4933
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.4933
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.5422
 Best site-sketch                    | Epoch:0 | Val Acc: 0.2533
 Best site-sketch                    | Epoch:0 | Val Acc: 0.2356
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 1 ============
 Site-photo                         | Train Loss: 1.5068 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 1.4961 | Train Acc: 0.9667
 Site-art_painting                  | Train Loss: 1.6839 | Train Acc: 0.6867
 Site-art_painting                  | Train Loss: 1.6547 | Train Acc: 0.6800
 Site-cartoon                       | Train Loss: 1.6466 | Train Acc: 0.7200
 Site-cartoon                       | Train Loss: 1.6479 | Train Acc: 0.6778
 Site-sketch                        | Train Loss: 1.6970 | Train Acc: 0.3333
 Site-sketch                        | Train Loss: 1.7120 | Train Acc: 0.3356
Average Train Accuracy: 0.6725
 Best site-photo                     | Epoch:1 | Val Acc: 0.9800
 Best site-photo                     | Epoch:1 | Val Acc: 0.9667
 Best site-art_painting              | Epoch:1 | Val Acc: 0.6867
 Best site-art_painting              | Epoch:1 | Val Acc: 0.6800
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.7200
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.6778
 Best site-sketch                    | Epoch:1 | Val Acc: 0.3333
 Best site-sketch                    | Epoch:1 | Val Acc: 0.3356
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 2 ============
 Site-photo                         | Train Loss: 1.2698 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 1.2763 | Train Acc: 0.9778
 Site-art_painting                  | Train Loss: 1.5346 | Train Acc: 0.7000
 Site-art_painting                  | Train Loss: 1.5142 | Train Acc: 0.7733
 Site-cartoon                       | Train Loss: 1.5082 | Train Acc: 0.7800
 Site-cartoon                       | Train Loss: 1.5089 | Train Acc: 0.7400
 Site-sketch                        | Train Loss: 1.6170 | Train Acc: 0.4467
 Site-sketch                        | Train Loss: 1.6405 | Train Acc: 0.3956
Average Train Accuracy: 0.7258
 Best site-photo                     | Epoch:2 | Val Acc: 0.9933
 Best site-photo                     | Epoch:2 | Val Acc: 0.9778
 Best site-art_painting              | Epoch:2 | Val Acc: 0.7000
 Best site-art_painting              | Epoch:2 | Val Acc: 0.7733
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.7800
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.7400
 Best site-sketch                    | Epoch:2 | Val Acc: 0.4467
 Best site-sketch                    | Epoch:2 | Val Acc: 0.3956
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 3 ============
 Site-photo                         | Train Loss: 1.0715 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 1.0509 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 1.4002 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 1.3764 | Train Acc: 0.7822
 Site-cartoon                       | Train Loss: 1.3854 | Train Acc: 0.7933
 Site-cartoon                       | Train Loss: 1.4125 | Train Acc: 0.7644
 Site-sketch                        | Train Loss: 1.5264 | Train Acc: 0.5067
 Site-sketch                        | Train Loss: 1.5428 | Train Acc: 0.4956
Average Train Accuracy: 0.7650
 Best site-photo                     | Epoch:3 | Val Acc: 0.9867
 Best site-photo                     | Epoch:3 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8000
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7822
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.7933
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.7644
 Best site-sketch                    | Epoch:3 | Val Acc: 0.5067
 Best site-sketch                    | Epoch:3 | Val Acc: 0.4956
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 4 ============
 Site-photo                         | Train Loss: 0.9062 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.9081 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 1.2789 | Train Acc: 0.7667
 Site-art_painting                  | Train Loss: 1.2409 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 1.3002 | Train Acc: 0.7733
 Site-cartoon                       | Train Loss: 1.3030 | Train Acc: 0.7822
 Site-sketch                        | Train Loss: 1.4785 | Train Acc: 0.5200
 Site-sketch                        | Train Loss: 1.4960 | Train Acc: 0.4533
Average Train Accuracy: 0.7600
============ Train epoch 5 ============
 Site-photo                         | Train Loss: 0.7522 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.7375 | Train Acc: 0.9778
 Site-art_painting                  | Train Loss: 1.1928 | Train Acc: 0.7867
 Site-art_painting                  | Train Loss: 1.1416 | Train Acc: 0.8222
 Site-cartoon                       | Train Loss: 1.2056 | Train Acc: 0.7733
 Site-cartoon                       | Train Loss: 1.2170 | Train Acc: 0.7867
 Site-sketch                        | Train Loss: 1.4230 | Train Acc: 0.5467
 Site-sketch                        | Train Loss: 1.4390 | Train Acc: 0.5333
Average Train Accuracy: 0.7767
 Best site-photo                     | Epoch:5 | Val Acc: 0.9867
 Best site-photo                     | Epoch:5 | Val Acc: 0.9778
 Best site-art_painting              | Epoch:5 | Val Acc: 0.7867
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8222
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.7733
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.7867
 Best site-sketch                    | Epoch:5 | Val Acc: 0.5467
 Best site-sketch                    | Epoch:5 | Val Acc: 0.5333
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 6 ============
 Site-photo                         | Train Loss: 0.6230 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.6006 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 1.1116 | Train Acc: 0.7933
 Site-art_painting                  | Train Loss: 1.1125 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 1.1403 | Train Acc: 0.8067
 Site-cartoon                       | Train Loss: 1.1461 | Train Acc: 0.7800
 Site-sketch                        | Train Loss: 1.3792 | Train Acc: 0.5467
 Site-sketch                        | Train Loss: 1.3843 | Train Acc: 0.5333
Average Train Accuracy: 0.7833
 Best site-photo                     | Epoch:6 | Val Acc: 0.9933
 Best site-photo                     | Epoch:6 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7933
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8267
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.8067
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.7800
 Best site-sketch                    | Epoch:6 | Val Acc: 0.5467
 Best site-sketch                    | Epoch:6 | Val Acc: 0.5333
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 7 ============
 Site-photo                         | Train Loss: 0.5220 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.5136 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 1.0006 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.9839 | Train Acc: 0.8289
 Site-cartoon                       | Train Loss: 1.0407 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 1.0407 | Train Acc: 0.7911
 Site-sketch                        | Train Loss: 1.3196 | Train Acc: 0.5933
 Site-sketch                        | Train Loss: 1.3554 | Train Acc: 0.5578
Average Train Accuracy: 0.7994
 Best site-photo                     | Epoch:7 | Val Acc: 0.9867
 Best site-photo                     | Epoch:7 | Val Acc: 0.9844
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8200
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8289
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.8333
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.7911
 Best site-sketch                    | Epoch:7 | Val Acc: 0.5933
 Best site-sketch                    | Epoch:7 | Val Acc: 0.5578
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 8 ============
 Site-photo                         | Train Loss: 0.4231 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4221 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.9862 | Train Acc: 0.7867
 Site-art_painting                  | Train Loss: 0.8522 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.9667 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 1.0708 | Train Acc: 0.7978
 Site-sketch                        | Train Loss: 1.2717 | Train Acc: 0.5800
 Site-sketch                        | Train Loss: 1.2800 | Train Acc: 0.5867
Average Train Accuracy: 0.8022
 Best site-photo                     | Epoch:8 | Val Acc: 1.0000
 Best site-photo                     | Epoch:8 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:8 | Val Acc: 0.7867
 Best site-art_painting              | Epoch:8 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:8 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:8 | Val Acc: 0.7978
 Best site-sketch                    | Epoch:8 | Val Acc: 0.5800
 Best site-sketch                    | Epoch:8 | Val Acc: 0.5867
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 9 ============
 Site-photo                         | Train Loss: 0.3449 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.3754 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 0.8796 | Train Acc: 0.8067
 Site-art_painting                  | Train Loss: 0.8087 | Train Acc: 0.8644
 Site-cartoon                       | Train Loss: 0.9277 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.9615 | Train Acc: 0.8022
 Site-sketch                        | Train Loss: 1.2613 | Train Acc: 0.5667
 Site-sketch                        | Train Loss: 1.2412 | Train Acc: 0.6133
Average Train Accuracy: 0.8122
 Best site-photo                     | Epoch:9 | Val Acc: 0.9933
 Best site-photo                     | Epoch:9 | Val Acc: 0.9844
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8067
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8644
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.8667
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.8022
 Best site-sketch                    | Epoch:9 | Val Acc: 0.5667
 Best site-sketch                    | Epoch:9 | Val Acc: 0.6133
 Test site-photo                     | Epoch:9 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:9 | Test Acc: 0.8733
 Test site-cartoon                   | Epoch:9 | Test Acc: 0.7894
 Test site-sketch                    | Epoch:9 | Test Acc: 0.5820
photo: 0.9985, art_painting: 0.8733, cartoon: 0.7894, sketch: 0.5820, 
Average Test Accuracy(group): 0.8108, Average Test Accuracy(individual): 0.8108,
domain std=0.1516, cluster std=-1.0000, individual std=0.1516, 
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 10 ============
 Site-photo                         | Train Loss: 0.3110 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.2871 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.8593 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.7418 | Train Acc: 0.8756
 Site-cartoon                       | Train Loss: 0.9055 | Train Acc: 0.7867
 Site-cartoon                       | Train Loss: 0.8892 | Train Acc: 0.8089
 Site-sketch                        | Train Loss: 1.2079 | Train Acc: 0.6267
 Site-sketch                        | Train Loss: 1.2035 | Train Acc: 0.6156
Average Train Accuracy: 0.8147
 Best site-photo                     | Epoch:10 | Val Acc: 0.9933
 Best site-photo                     | Epoch:10 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8200
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8756
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.7867
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.8089
 Best site-sketch                    | Epoch:10 | Val Acc: 0.6267
 Best site-sketch                    | Epoch:10 | Val Acc: 0.6156
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 11 ============
 Site-photo                         | Train Loss: 0.2531 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2502 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.8005 | Train Acc: 0.8133
 Site-art_painting                  | Train Loss: 0.7261 | Train Acc: 0.8844
 Site-cartoon                       | Train Loss: 0.8299 | Train Acc: 0.7867
 Site-cartoon                       | Train Loss: 0.9276 | Train Acc: 0.8089
 Site-sketch                        | Train Loss: 1.1663 | Train Acc: 0.6267
 Site-sketch                        | Train Loss: 1.1878 | Train Acc: 0.6200
Average Train Accuracy: 0.8164
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8133
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8844
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.7867
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.8089
 Best site-sketch                    | Epoch:11 | Val Acc: 0.6267
 Best site-sketch                    | Epoch:11 | Val Acc: 0.6200
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 12 ============
 Site-photo                         | Train Loss: 0.2071 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2381 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.7085 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.6228 | Train Acc: 0.8978
 Site-cartoon                       | Train Loss: 0.8123 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.8287 | Train Acc: 0.8222
 Site-sketch                        | Train Loss: 1.1618 | Train Acc: 0.6467
 Site-sketch                        | Train Loss: 1.1367 | Train Acc: 0.6089
Average Train Accuracy: 0.8319
 Best site-photo                     | Epoch:12 | Val Acc: 1.0000
 Best site-photo                     | Epoch:12 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8978
 Best site-cartoon                   | Epoch:12 | Val Acc: 0.8600
 Best site-cartoon                   | Epoch:12 | Val Acc: 0.8222
 Best site-sketch                    | Epoch:12 | Val Acc: 0.6467
 Best site-sketch                    | Epoch:12 | Val Acc: 0.6089
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 13 ============
 Site-photo                         | Train Loss: 0.1788 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1805 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.7477 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.6690 | Train Acc: 0.8956
 Site-cartoon                       | Train Loss: 0.7968 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.8087 | Train Acc: 0.8222
 Site-sketch                        | Train Loss: 1.1169 | Train Acc: 0.6133
 Site-sketch                        | Train Loss: 1.1217 | Train Acc: 0.6311
Average Train Accuracy: 0.8286
============ Train epoch 14 ============
 Site-photo                         | Train Loss: 0.1474 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2192 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 0.6957 | Train Acc: 0.8533
 Site-art_painting                  | Train Loss: 0.5855 | Train Acc: 0.8844
 Site-cartoon                       | Train Loss: 0.8036 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.7864 | Train Acc: 0.8111
 Site-sketch                        | Train Loss: 1.0809 | Train Acc: 0.6533
 Site-sketch                        | Train Loss: 1.0666 | Train Acc: 0.6711
Average Train Accuracy: 0.8364
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 0.9844
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8533
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8844
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.8333
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.8111
 Best site-sketch                    | Epoch:14 | Val Acc: 0.6533
 Best site-sketch                    | Epoch:14 | Val Acc: 0.6711
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 15 ============
 Site-photo                         | Train Loss: 0.1337 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1391 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.6486 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.5794 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.7237 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.7650 | Train Acc: 0.8133
 Site-sketch                        | Train Loss: 1.0665 | Train Acc: 0.6600
 Site-sketch                        | Train Loss: 1.0617 | Train Acc: 0.6444
Average Train Accuracy: 0.8400
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 0.9889
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8933
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8800
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.8133
 Best site-sketch                    | Epoch:15 | Val Acc: 0.6600
 Best site-sketch                    | Epoch:15 | Val Acc: 0.6444
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 16 ============
 Site-photo                         | Train Loss: 0.1115 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1365 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 0.6749 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.5706 | Train Acc: 0.8778
 Site-cartoon                       | Train Loss: 0.7061 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.6981 | Train Acc: 0.8311
 Site-sketch                        | Train Loss: 1.0663 | Train Acc: 0.6467
 Site-sketch                        | Train Loss: 1.0373 | Train Acc: 0.6533
Average Train Accuracy: 0.8333
============ Train epoch 17 ============
 Site-photo                         | Train Loss: 0.1029 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1249 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.6181 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.5076 | Train Acc: 0.8822
 Site-cartoon                       | Train Loss: 0.6830 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.6734 | Train Acc: 0.8444
 Site-sketch                        | Train Loss: 1.0736 | Train Acc: 0.6533
 Site-sketch                        | Train Loss: 1.0900 | Train Acc: 0.6600
Average Train Accuracy: 0.8358
============ Train epoch 18 ============
 Site-photo                         | Train Loss: 0.1039 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.1046 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.6350 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.5041 | Train Acc: 0.8867
 Site-cartoon                       | Train Loss: 0.6629 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.6586 | Train Acc: 0.8244
 Site-sketch                        | Train Loss: 1.0617 | Train Acc: 0.6400
 Site-sketch                        | Train Loss: 0.9964 | Train Acc: 0.7089
Average Train Accuracy: 0.8450
 Best site-photo                     | Epoch:18 | Val Acc: 0.9933
 Best site-photo                     | Epoch:18 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8867
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.8533
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.8244
 Best site-sketch                    | Epoch:18 | Val Acc: 0.6400
 Best site-sketch                    | Epoch:18 | Val Acc: 0.7089
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 19 ============
 Site-photo                         | Train Loss: 0.0832 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0970 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5734 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.5388 | Train Acc: 0.8956
 Site-cartoon                       | Train Loss: 0.6298 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.6723 | Train Acc: 0.8244
 Site-sketch                        | Train Loss: 1.0237 | Train Acc: 0.6600
 Site-sketch                        | Train Loss: 0.9743 | Train Acc: 0.6667
Average Train Accuracy: 0.8447
 Test site-photo                     | Epoch:18 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:18 | Test Acc: 0.9050
 Test site-cartoon                   | Epoch:18 | Test Acc: 0.8202
 Test site-sketch                    | Epoch:18 | Test Acc: 0.6436
photo: 0.9985, art_painting: 0.9050, cartoon: 0.8202, sketch: 0.6436, 
Average Test Accuracy(group): 0.8418, Average Test Accuracy(individual): 0.8418,
domain std=0.1307, cluster std=-1.0000, individual std=0.1307, 
============ Train epoch 20 ============
 Site-photo                         | Train Loss: 0.0716 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0893 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5500 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.5646 | Train Acc: 0.9133
 Site-cartoon                       | Train Loss: 0.6661 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.6093 | Train Acc: 0.8311
 Site-sketch                        | Train Loss: 1.0441 | Train Acc: 0.6267
 Site-sketch                        | Train Loss: 1.0730 | Train Acc: 0.6667
Average Train Accuracy: 0.8403
============ Train epoch 21 ============
 Site-photo                         | Train Loss: 0.0826 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0794 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.5592 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.4963 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.6272 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.5987 | Train Acc: 0.8511
 Site-sketch                        | Train Loss: 1.0168 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.9864 | Train Acc: 0.6911
Average Train Accuracy: 0.8528
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:21 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:21 | Val Acc: 0.8933
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.8733
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.8511
 Best site-sketch                    | Epoch:21 | Val Acc: 0.6667
 Best site-sketch                    | Epoch:21 | Val Acc: 0.6911
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 22 ============
 Site-photo                         | Train Loss: 0.0747 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0790 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5551 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.4463 | Train Acc: 0.8978
 Site-cartoon                       | Train Loss: 0.6298 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.6033 | Train Acc: 0.8311
 Site-sketch                        | Train Loss: 1.0196 | Train Acc: 0.6533
 Site-sketch                        | Train Loss: 0.9542 | Train Acc: 0.6778
Average Train Accuracy: 0.8397
============ Train epoch 23 ============
 Site-photo                         | Train Loss: 0.0655 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0712 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.5606 | Train Acc: 0.8533
 Site-art_painting                  | Train Loss: 0.4573 | Train Acc: 0.9156
 Site-cartoon                       | Train Loss: 0.6288 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.6312 | Train Acc: 0.8622
 Site-sketch                        | Train Loss: 0.9702 | Train Acc: 0.6400
 Site-sketch                        | Train Loss: 0.9229 | Train Acc: 0.7044
Average Train Accuracy: 0.8511
============ Train epoch 24 ============
 Site-photo                         | Train Loss: 0.0713 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0669 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5114 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.4359 | Train Acc: 0.9133
 Site-cartoon                       | Train Loss: 0.5987 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.5724 | Train Acc: 0.8533
 Site-sketch                        | Train Loss: 0.9665 | Train Acc: 0.6867
 Site-sketch                        | Train Loss: 0.9545 | Train Acc: 0.6844
Average Train Accuracy: 0.8569
 Best site-photo                     | Epoch:24 | Val Acc: 0.9933
 Best site-photo                     | Epoch:24 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:24 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:24 | Val Acc: 0.9133
 Best site-cartoon                   | Epoch:24 | Val Acc: 0.8733
 Best site-cartoon                   | Epoch:24 | Val Acc: 0.8533
 Best site-sketch                    | Epoch:24 | Val Acc: 0.6867
 Best site-sketch                    | Epoch:24 | Val Acc: 0.6844
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 25 ============
 Site-photo                         | Train Loss: 0.0465 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0712 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.4984 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.4024 | Train Acc: 0.8978
 Site-cartoon                       | Train Loss: 0.5350 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.6298 | Train Acc: 0.8333
 Site-sketch                        | Train Loss: 0.9277 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.9151 | Train Acc: 0.7156
Average Train Accuracy: 0.8575
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8978
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.9000
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.8333
 Best site-sketch                    | Epoch:25 | Val Acc: 0.6667
 Best site-sketch                    | Epoch:25 | Val Acc: 0.7156
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 26 ============
 Site-photo                         | Train Loss: 0.0483 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0744 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 0.5026 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.4008 | Train Acc: 0.9067
 Site-cartoon                       | Train Loss: 0.6098 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.5553 | Train Acc: 0.8533
 Site-sketch                        | Train Loss: 0.9444 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.8924 | Train Acc: 0.7178
Average Train Accuracy: 0.8528
============ Train epoch 27 ============
 Site-photo                         | Train Loss: 0.0408 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0603 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.4970 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.3901 | Train Acc: 0.9067
 Site-cartoon                       | Train Loss: 0.5251 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.5796 | Train Acc: 0.8333
 Site-sketch                        | Train Loss: 0.9789 | Train Acc: 0.6467
 Site-sketch                        | Train Loss: 0.8949 | Train Acc: 0.6867
Average Train Accuracy: 0.8494
============ Train epoch 28 ============
 Site-photo                         | Train Loss: 0.0589 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0555 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.5076 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.4021 | Train Acc: 0.9178
 Site-cartoon                       | Train Loss: 0.5549 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.5495 | Train Acc: 0.8400
 Site-sketch                        | Train Loss: 0.9177 | Train Acc: 0.6867
 Site-sketch                        | Train Loss: 0.8604 | Train Acc: 0.7111
Average Train Accuracy: 0.8547
============ Train epoch 29 ============
 Site-photo                         | Train Loss: 0.0478 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0462 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.5221 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.3615 | Train Acc: 0.9111
 Site-cartoon                       | Train Loss: 0.5337 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.5362 | Train Acc: 0.8578
 Site-sketch                        | Train Loss: 0.9263 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.9020 | Train Acc: 0.6756
Average Train Accuracy: 0.8531
 Test site-photo                     | Epoch:25 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:25 | Test Acc: 0.9074
 Test site-cartoon                   | Epoch:25 | Test Acc: 0.8372
 Test site-sketch                    | Epoch:25 | Test Acc: 0.6874
photo: 0.9985, art_painting: 0.9074, cartoon: 0.8372, sketch: 0.6874, 
Average Test Accuracy(group): 0.8576, Average Test Accuracy(individual): 0.8576,
domain std=0.1137, cluster std=-1.0000, individual std=0.1137, 
============ Train epoch 30 ============
 Site-photo                         | Train Loss: 0.0431 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0539 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.4515 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.3804 | Train Acc: 0.9111
 Site-cartoon                       | Train Loss: 0.5176 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.5295 | Train Acc: 0.8422
 Site-sketch                        | Train Loss: 0.9198 | Train Acc: 0.6733
 Site-sketch                        | Train Loss: 0.8902 | Train Acc: 0.7244
Average Train Accuracy: 0.8589
 Best site-photo                     | Epoch:30 | Val Acc: 1.0000
 Best site-photo                     | Epoch:30 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:30 | Val Acc: 0.8733
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9111
 Best site-cartoon                   | Epoch:30 | Val Acc: 0.8533
 Best site-cartoon                   | Epoch:30 | Val Acc: 0.8422
 Best site-sketch                    | Epoch:30 | Val Acc: 0.6733
 Best site-sketch                    | Epoch:30 | Val Acc: 0.7244
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 31 ============
 Site-photo                         | Train Loss: 0.0338 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0519 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.4520 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.3551 | Train Acc: 0.9067
 Site-cartoon                       | Train Loss: 0.4872 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.5600 | Train Acc: 0.8333
 Site-sketch                        | Train Loss: 0.9037 | Train Acc: 0.6933
 Site-sketch                        | Train Loss: 0.9071 | Train Acc: 0.7089
Average Train Accuracy: 0.8622
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 0.9889
 Best site-art_painting              | Epoch:31 | Val Acc: 0.8867
 Best site-art_painting              | Epoch:31 | Val Acc: 0.9067
 Best site-cartoon                   | Epoch:31 | Val Acc: 0.8800
 Best site-cartoon                   | Epoch:31 | Val Acc: 0.8333
 Best site-sketch                    | Epoch:31 | Val Acc: 0.6933
 Best site-sketch                    | Epoch:31 | Val Acc: 0.7089
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 32 ============
 Site-photo                         | Train Loss: 0.0382 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0501 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.4793 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.3466 | Train Acc: 0.9200
 Site-cartoon                       | Train Loss: 0.5326 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.5182 | Train Acc: 0.8644
 Site-sketch                        | Train Loss: 0.9149 | Train Acc: 0.6933
 Site-sketch                        | Train Loss: 0.8714 | Train Acc: 0.6911
Average Train Accuracy: 0.8639
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-photo                     | Epoch:32 | Val Acc: 0.9889
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:32 | Val Acc: 0.9200
 Best site-cartoon                   | Epoch:32 | Val Acc: 0.8933
 Best site-cartoon                   | Epoch:32 | Val Acc: 0.8644
 Best site-sketch                    | Epoch:32 | Val Acc: 0.6933
 Best site-sketch                    | Epoch:32 | Val Acc: 0.6911
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 33 ============
 Site-photo                         | Train Loss: 0.0344 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0412 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.5038 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.3400 | Train Acc: 0.9244
 Site-cartoon                       | Train Loss: 0.4960 | Train Acc: 0.9133
 Site-cartoon                       | Train Loss: 0.5003 | Train Acc: 0.8489
 Site-sketch                        | Train Loss: 0.9466 | Train Acc: 0.6467
 Site-sketch                        | Train Loss: 0.7973 | Train Acc: 0.7289
Average Train Accuracy: 0.8644
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9244
 Best site-cartoon                   | Epoch:33 | Val Acc: 0.9133
 Best site-cartoon                   | Epoch:33 | Val Acc: 0.8489
 Best site-sketch                    | Epoch:33 | Val Acc: 0.6467
 Best site-sketch                    | Epoch:33 | Val Acc: 0.7289
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 34 ============
 Site-photo                         | Train Loss: 0.0359 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0523 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4400 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.3218 | Train Acc: 0.9267
 Site-cartoon                       | Train Loss: 0.4725 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.5093 | Train Acc: 0.8711
 Site-sketch                        | Train Loss: 0.8720 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.8653 | Train Acc: 0.7422
Average Train Accuracy: 0.8672
 Best site-photo                     | Epoch:34 | Val Acc: 0.9867
 Best site-photo                     | Epoch:34 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:34 | Val Acc: 0.8800
 Best site-art_painting              | Epoch:34 | Val Acc: 0.9267
 Best site-cartoon                   | Epoch:34 | Val Acc: 0.8733
 Best site-cartoon                   | Epoch:34 | Val Acc: 0.8711
 Best site-sketch                    | Epoch:34 | Val Acc: 0.6667
 Best site-sketch                    | Epoch:34 | Val Acc: 0.7422
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 35 ============
 Site-photo                         | Train Loss: 0.0425 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0558 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 0.4082 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.3212 | Train Acc: 0.9133
 Site-cartoon                       | Train Loss: 0.5098 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.5573 | Train Acc: 0.8511
 Site-sketch                        | Train Loss: 0.8744 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.8751 | Train Acc: 0.7156
Average Train Accuracy: 0.8664
============ Train epoch 36 ============
 Site-photo                         | Train Loss: 0.0288 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0508 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4450 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.3511 | Train Acc: 0.9200
 Site-cartoon                       | Train Loss: 0.4858 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.4984 | Train Acc: 0.8600
 Site-sketch                        | Train Loss: 0.8924 | Train Acc: 0.6933
 Site-sketch                        | Train Loss: 0.7931 | Train Acc: 0.7356
Average Train Accuracy: 0.8725
 Best site-photo                     | Epoch:36 | Val Acc: 1.0000
 Best site-photo                     | Epoch:36 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:36 | Val Acc: 0.8867
 Best site-art_painting              | Epoch:36 | Val Acc: 0.9200
 Best site-cartoon                   | Epoch:36 | Val Acc: 0.8933
 Best site-cartoon                   | Epoch:36 | Val Acc: 0.8600
 Best site-sketch                    | Epoch:36 | Val Acc: 0.6933
 Best site-sketch                    | Epoch:36 | Val Acc: 0.7356
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 37 ============
 Site-photo                         | Train Loss: 0.0200 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0436 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.4556 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.3113 | Train Acc: 0.9178
 Site-cartoon                       | Train Loss: 0.4764 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.4939 | Train Acc: 0.8578
 Site-sketch                        | Train Loss: 0.8830 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.8408 | Train Acc: 0.7311
Average Train Accuracy: 0.8650
============ Train epoch 38 ============
 Site-photo                         | Train Loss: 0.0245 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1022 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.4013 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.3714 | Train Acc: 0.9156
 Site-cartoon                       | Train Loss: 0.4937 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.5050 | Train Acc: 0.8689
 Site-sketch                        | Train Loss: 0.8450 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.8027 | Train Acc: 0.7289
Average Train Accuracy: 0.8717
============ Train epoch 39 ============
 Site-photo                         | Train Loss: 0.0253 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0345 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4177 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.3029 | Train Acc: 0.9267
 Site-cartoon                       | Train Loss: 0.5009 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.4794 | Train Acc: 0.8622
 Site-sketch                        | Train Loss: 0.8765 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.8110 | Train Acc: 0.7044
Average Train Accuracy: 0.8672
 Test site-photo                     | Epoch:36 | Test Acc: 1.0000
 Test site-art_painting              | Epoch:36 | Test Acc: 0.9184
 Test site-cartoon                   | Epoch:36 | Test Acc: 0.8489
 Test site-sketch                    | Epoch:36 | Test Acc: 0.7122
photo: 1.0000, art_painting: 0.9184, cartoon: 0.8489, sketch: 0.7122, 
Average Test Accuracy(group): 0.8699, Average Test Accuracy(individual): 0.8699,
domain std=0.1056, cluster std=-1.0000, individual std=0.1056, 
============ Train epoch 40 ============
 Site-photo                         | Train Loss: 0.0279 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0408 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.4532 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.3116 | Train Acc: 0.9222
 Site-cartoon                       | Train Loss: 0.4627 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.4388 | Train Acc: 0.8778
 Site-sketch                        | Train Loss: 0.8790 | Train Acc: 0.6867
 Site-sketch                        | Train Loss: 0.7657 | Train Acc: 0.7556
Average Train Accuracy: 0.8736
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:40 | Val Acc: 0.8933
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9222
 Best site-cartoon                   | Epoch:40 | Val Acc: 0.8600
 Best site-cartoon                   | Epoch:40 | Val Acc: 0.8778
 Best site-sketch                    | Epoch:40 | Val Acc: 0.6867
 Best site-sketch                    | Epoch:40 | Val Acc: 0.7556
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 41 ============
 Site-photo                         | Train Loss: 0.0334 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0349 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4179 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.2777 | Train Acc: 0.9333
 Site-cartoon                       | Train Loss: 0.4630 | Train Acc: 0.8867
 Site-cartoon                       | Train Loss: 0.4637 | Train Acc: 0.8733
 Site-sketch                        | Train Loss: 0.8528 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.8246 | Train Acc: 0.7400
Average Train Accuracy: 0.8739
 Best site-photo                     | Epoch:41 | Val Acc: 0.9933
 Best site-photo                     | Epoch:41 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:41 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:41 | Val Acc: 0.9333
 Best site-cartoon                   | Epoch:41 | Val Acc: 0.8867
 Best site-cartoon                   | Epoch:41 | Val Acc: 0.8733
 Best site-sketch                    | Epoch:41 | Val Acc: 0.7067
 Best site-sketch                    | Epoch:41 | Val Acc: 0.7400
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 42 ============
 Site-photo                         | Train Loss: 0.0254 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0287 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4244 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.3045 | Train Acc: 0.9156
 Site-cartoon                       | Train Loss: 0.4208 | Train Acc: 0.9267
 Site-cartoon                       | Train Loss: 0.4601 | Train Acc: 0.8778
 Site-sketch                        | Train Loss: 0.8818 | Train Acc: 0.6600
 Site-sketch                        | Train Loss: 0.8121 | Train Acc: 0.7222
Average Train Accuracy: 0.8725
============ Train epoch 43 ============
 Site-photo                         | Train Loss: 0.0250 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0261 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.4390 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.3693 | Train Acc: 0.9200
 Site-cartoon                       | Train Loss: 0.4330 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.4550 | Train Acc: 0.8822
 Site-sketch                        | Train Loss: 0.8796 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.7372 | Train Acc: 0.7800
Average Train Accuracy: 0.8753
 Best site-photo                     | Epoch:43 | Val Acc: 1.0000
 Best site-photo                     | Epoch:43 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:43 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9200
 Best site-cartoon                   | Epoch:43 | Val Acc: 0.9000
 Best site-cartoon                   | Epoch:43 | Val Acc: 0.8822
 Best site-sketch                    | Epoch:43 | Val Acc: 0.6667
 Best site-sketch                    | Epoch:43 | Val Acc: 0.7800
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 44 ============
 Site-photo                         | Train Loss: 0.0262 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0405 | Train Acc: 0.9822
 Site-art_painting                  | Train Loss: 0.4774 | Train Acc: 0.8533
 Site-art_painting                  | Train Loss: 0.3044 | Train Acc: 0.9244
 Site-cartoon                       | Train Loss: 0.4433 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.4516 | Train Acc: 0.8556
 Site-sketch                        | Train Loss: 0.8765 | Train Acc: 0.6800
 Site-sketch                        | Train Loss: 0.7564 | Train Acc: 0.7444
Average Train Accuracy: 0.8650
============ Train epoch 45 ============
 Site-photo                         | Train Loss: 0.0226 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0369 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.3762 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.3250 | Train Acc: 0.9044
 Site-cartoon                       | Train Loss: 0.4513 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.4262 | Train Acc: 0.8689
 Site-sketch                        | Train Loss: 0.7877 | Train Acc: 0.7267
 Site-sketch                        | Train Loss: 0.7310 | Train Acc: 0.7756
Average Train Accuracy: 0.8800
 Best site-photo                     | Epoch:45 | Val Acc: 1.0000
 Best site-photo                     | Epoch:45 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:45 | Val Acc: 0.8733
 Best site-art_painting              | Epoch:45 | Val Acc: 0.9044
 Best site-cartoon                   | Epoch:45 | Val Acc: 0.9000
 Best site-cartoon                   | Epoch:45 | Val Acc: 0.8689
 Best site-sketch                    | Epoch:45 | Val Acc: 0.7267
 Best site-sketch                    | Epoch:45 | Val Acc: 0.7756
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 46 ============
 Site-photo                         | Train Loss: 0.0249 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0317 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4347 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.3203 | Train Acc: 0.9133
 Site-cartoon                       | Train Loss: 0.4365 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.4256 | Train Acc: 0.8778
 Site-sketch                        | Train Loss: 0.8115 | Train Acc: 0.7333
 Site-sketch                        | Train Loss: 0.7625 | Train Acc: 0.7644
Average Train Accuracy: 0.8800
 Best site-photo                     | Epoch:46 | Val Acc: 0.9933
 Best site-photo                     | Epoch:46 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:46 | Val Acc: 0.8733
 Best site-art_painting              | Epoch:46 | Val Acc: 0.9133
 Best site-cartoon                   | Epoch:46 | Val Acc: 0.8933
 Best site-cartoon                   | Epoch:46 | Val Acc: 0.8778
 Best site-sketch                    | Epoch:46 | Val Acc: 0.7333
 Best site-sketch                    | Epoch:46 | Val Acc: 0.7644
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_0/fedavg...
============ Train epoch 47 ============
 Site-photo                         | Train Loss: 0.0159 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0363 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.3706 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.3164 | Train Acc: 0.9289
 Site-cartoon                       | Train Loss: 0.4404 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.4194 | Train Acc: 0.8800
 Site-sketch                        | Train Loss: 0.8201 | Train Acc: 0.7000
 Site-sketch                        | Train Loss: 0.7565 | Train Acc: 0.7444
Average Train Accuracy: 0.8772
============ Train epoch 48 ============
 Site-photo                         | Train Loss: 0.0195 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0274 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.3749 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.3452 | Train Acc: 0.9356
 Site-cartoon                       | Train Loss: 0.4325 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.4157 | Train Acc: 0.8822
 Site-sketch                        | Train Loss: 0.8285 | Train Acc: 0.7000
 Site-sketch                        | Train Loss: 0.7984 | Train Acc: 0.7422
Average Train Accuracy: 0.8733
============ Train epoch 49 ============
 Site-photo                         | Train Loss: 0.0231 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0241 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.4542 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.3288 | Train Acc: 0.9222
 Site-cartoon                       | Train Loss: 0.4256 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.4813 | Train Acc: 0.8689
 Site-sketch                        | Train Loss: 0.8196 | Train Acc: 0.7000
 Site-sketch                        | Train Loss: 0.7867 | Train Acc: 0.7356
Average Train Accuracy: 0.8733
 Test site-photo                     | Epoch:46 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:46 | Test Acc: 0.9220
 Test site-cartoon                   | Epoch:46 | Test Acc: 0.8553
 Test site-sketch                    | Epoch:46 | Test Acc: 0.7294
photo: 0.9985, art_painting: 0.9220, cartoon: 0.8553, sketch: 0.7294, 
Average Test Accuracy(group): 0.8763, Average Test Accuracy(individual): 0.8763,
domain std=0.0988, cluster std=-1.0000, individual std=0.0988, 
===2023-08-17 02:26:31===
===2023-08-17 02:26:33===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
Loading snapshots...
 Test site-photo                     | Epoch:46 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:46 | Test Acc: 0.9220
 Test site-cartoon                   | Epoch:46 | Test Acc: 0.8543
 Test site-sketch                    | Epoch:46 | Test Acc: 0.7249
photo: 0.9985, art_painting: 0.9220, cartoon: 0.8543, sketch: 0.7249, 
Average Test Accuracy(group): 0.8749, Average Test Accuracy(individual): 0.8749,
domain std=0.1005, cluster std=-1.0000, individual std=0.1005, 
