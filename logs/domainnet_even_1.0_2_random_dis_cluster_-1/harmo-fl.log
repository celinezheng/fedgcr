===2023-07-30 02:31:54===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 1.3222 | Train Acc: 0.7580
 Site-Clipart                       | Train Loss: 1.2850 | Train Acc: 0.8030
 Site-Real                          | Train Loss: 1.0751 | Train Acc: 0.8917
 Site-Real                          | Train Loss: 0.9785 | Train Acc: 0.9428
 Site-Painting                      | Train Loss: 1.2205 | Train Acc: 0.8408
 Site-Painting                      | Train Loss: 1.1845 | Train Acc: 0.8305
 Site-Sketch                        | Train Loss: 1.3499 | Train Acc: 0.7006
 Site-Sketch                        | Train Loss: 1.2147 | Train Acc: 0.7564
 Site-QuickDraw                     | Train Loss: 1.9453 | Train Acc: 0.4331
 Site-QuickDraw                     | Train Loss: 1.9571 | Train Acc: 0.4174
 Site-Infograph                     | Train Loss: 1.8624 | Train Acc: 0.4841
 Site-Infograph                     | Train Loss: 1.8308 | Train Acc: 0.5127
Average Train Accuracy: 0.6976
 Site-Clipart                       | Val  Loss: 1.3145 | Val  Acc: 0.7905
 Site-Clipart                       | Val  Loss: 1.3219 | Val  Acc: 0.7810
 Site-Real                          | Val  Loss: 1.0007 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 1.0018 | Val  Acc: 0.9556
 Site-Painting                      | Val  Loss: 1.1009 | Val  Acc: 0.8857
 Site-Painting                      | Val  Loss: 1.2057 | Val  Acc: 0.8159
 Site-Sketch                        | Val  Loss: 1.2599 | Val  Acc: 0.7524
 Site-Sketch                        | Val  Loss: 1.2522 | Val  Acc: 0.7365
 Site-QuickDraw                     | Val  Loss: 1.9521 | Val  Acc: 0.4476
 Site-QuickDraw                     | Val  Loss: 1.9532 | Val  Acc: 0.4571
 Site-Infograph                     | Val  Loss: 1.8900 | Val  Acc: 0.4476
 Site-Infograph                     | Val  Loss: 1.8547 | Val  Acc: 0.4825
Average Valid Accuracy: 0.7071
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.7905
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.7810
 Best site-Real                      | Epoch:0 | Val Acc: 0.9333
 Best site-Real                      | Epoch:0 | Val Acc: 0.9556
 Best site-Painting                  | Epoch:0 | Val Acc: 0.8857
 Best site-Painting                  | Epoch:0 | Val Acc: 0.8159
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.7524
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.7365
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.4476
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.4571
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.4476
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.4825
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 0.9625 | Train Acc: 0.8089
 Site-Clipart                       | Train Loss: 0.8605 | Train Acc: 0.8432
 Site-Real                          | Train Loss: 0.5668 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.4685 | Train Acc: 0.9661
 Site-Painting                      | Train Loss: 0.6962 | Train Acc: 0.8344
 Site-Painting                      | Train Loss: 0.7301 | Train Acc: 0.8686
 Site-Sketch                        | Train Loss: 0.8965 | Train Acc: 0.7389
 Site-Sketch                        | Train Loss: 0.7959 | Train Acc: 0.8178
 Site-QuickDraw                     | Train Loss: 1.7383 | Train Acc: 0.4395
 Site-QuickDraw                     | Train Loss: 1.7376 | Train Acc: 0.4979
 Site-Infograph                     | Train Loss: 1.7353 | Train Acc: 0.4841
 Site-Infograph                     | Train Loss: 1.6367 | Train Acc: 0.5318
Average Train Accuracy: 0.7301
 Site-Clipart                       | Val  Loss: 0.8675 | Val  Acc: 0.8476
 Site-Clipart                       | Val  Loss: 0.8955 | Val  Acc: 0.8381
 Site-Real                          | Val  Loss: 0.5023 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.5000 | Val  Acc: 0.9556
 Site-Painting                      | Val  Loss: 0.6068 | Val  Acc: 0.9238
 Site-Painting                      | Val  Loss: 0.7350 | Val  Acc: 0.8540
 Site-Sketch                        | Val  Loss: 0.7825 | Val  Acc: 0.8286
 Site-Sketch                        | Val  Loss: 0.8144 | Val  Acc: 0.8127
 Site-QuickDraw                     | Val  Loss: 1.7294 | Val  Acc: 0.4571
 Site-QuickDraw                     | Val  Loss: 1.7220 | Val  Acc: 0.5270
 Site-Infograph                     | Val  Loss: 1.7337 | Val  Acc: 0.4667
 Site-Infograph                     | Val  Loss: 1.6509 | Val  Acc: 0.4889
Average Valid Accuracy: 0.7468
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.8476
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.8381
 Best site-Real                      | Epoch:1 | Val Acc: 0.9619
 Best site-Real                      | Epoch:1 | Val Acc: 0.9556
 Best site-Painting                  | Epoch:1 | Val Acc: 0.9238
 Best site-Painting                  | Epoch:1 | Val Acc: 0.8540
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.8286
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.8127
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.4571
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.5270
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.4667
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.4889
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 0.6826 | Train Acc: 0.8471
 Site-Clipart                       | Train Loss: 0.6671 | Train Acc: 0.8623
 Site-Real                          | Train Loss: 0.3895 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.3029 | Train Acc: 0.9703
 Site-Painting                      | Train Loss: 0.5922 | Train Acc: 0.8408
 Site-Painting                      | Train Loss: 0.5729 | Train Acc: 0.8729
 Site-Sketch                        | Train Loss: 0.7503 | Train Acc: 0.8089
 Site-Sketch                        | Train Loss: 0.6416 | Train Acc: 0.8136
 Site-QuickDraw                     | Train Loss: 1.6216 | Train Acc: 0.4841
 Site-QuickDraw                     | Train Loss: 1.5609 | Train Acc: 0.5169
 Site-Infograph                     | Train Loss: 1.5985 | Train Acc: 0.4713
 Site-Infograph                     | Train Loss: 1.5124 | Train Acc: 0.5297
Average Train Accuracy: 0.7457
 Site-Clipart                       | Val  Loss: 0.6637 | Val  Acc: 0.8762
 Site-Clipart                       | Val  Loss: 0.6958 | Val  Acc: 0.8857
 Site-Real                          | Val  Loss: 0.3368 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.3366 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.4177 | Val  Acc: 0.9429
 Site-Painting                      | Val  Loss: 0.5868 | Val  Acc: 0.8603
 Site-Sketch                        | Val  Loss: 0.6093 | Val  Acc: 0.8286
 Site-Sketch                        | Val  Loss: 0.7075 | Val  Acc: 0.7968
 Site-QuickDraw                     | Val  Loss: 1.6173 | Val  Acc: 0.4952
 Site-QuickDraw                     | Val  Loss: 1.5617 | Val  Acc: 0.5365
 Site-Infograph                     | Val  Loss: 1.6622 | Val  Acc: 0.4667
 Site-Infograph                     | Val  Loss: 1.5325 | Val  Acc: 0.5016
Average Valid Accuracy: 0.7595
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8762
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8857
 Best site-Real                      | Epoch:2 | Val Acc: 0.9619
 Best site-Real                      | Epoch:2 | Val Acc: 0.9619
 Best site-Painting                  | Epoch:2 | Val Acc: 0.9429
 Best site-Painting                  | Epoch:2 | Val Acc: 0.8603
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.8286
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.7968
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.4952
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.5365
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.4667
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.5016
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 0.5891 | Train Acc: 0.8726
 Site-Clipart                       | Train Loss: 0.5620 | Train Acc: 0.8708
 Site-Real                          | Train Loss: 0.2775 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.2213 | Train Acc: 0.9788
 Site-Painting                      | Train Loss: 0.5140 | Train Acc: 0.8662
 Site-Painting                      | Train Loss: 0.4769 | Train Acc: 0.8814
 Site-Sketch                        | Train Loss: 0.6423 | Train Acc: 0.8217
 Site-Sketch                        | Train Loss: 0.5567 | Train Acc: 0.8326
 Site-QuickDraw                     | Train Loss: 1.4419 | Train Acc: 0.5414
 Site-QuickDraw                     | Train Loss: 1.4539 | Train Acc: 0.5805
 Site-Infograph                     | Train Loss: 1.5856 | Train Acc: 0.4777
 Site-Infograph                     | Train Loss: 1.4278 | Train Acc: 0.5551
Average Train Accuracy: 0.7679
 Site-Clipart                       | Val  Loss: 0.6197 | Val  Acc: 0.8952
 Site-Clipart                       | Val  Loss: 0.5949 | Val  Acc: 0.8540
 Site-Real                          | Val  Loss: 0.2558 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.2442 | Val  Acc: 0.9746
 Site-Painting                      | Val  Loss: 0.3747 | Val  Acc: 0.9333
 Site-Painting                      | Val  Loss: 0.5027 | Val  Acc: 0.8857
 Site-Sketch                        | Val  Loss: 0.4961 | Val  Acc: 0.8857
 Site-Sketch                        | Val  Loss: 0.5630 | Val  Acc: 0.8476
 Site-QuickDraw                     | Val  Loss: 1.5059 | Val  Acc: 0.4857
 Site-QuickDraw                     | Val  Loss: 1.4393 | Val  Acc: 0.6000
 Site-Infograph                     | Val  Loss: 1.6197 | Val  Acc: 0.5429
 Site-Infograph                     | Val  Loss: 1.4812 | Val  Acc: 0.5397
Average Valid Accuracy: 0.7847
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8952
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8540
 Best site-Real                      | Epoch:3 | Val Acc: 0.9714
 Best site-Real                      | Epoch:3 | Val Acc: 0.9746
 Best site-Painting                  | Epoch:3 | Val Acc: 0.9333
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8857
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.8857
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.8476
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.4857
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.6000
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.5429
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.5397
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 0.5403 | Train Acc: 0.8726
 Site-Clipart                       | Train Loss: 0.5208 | Train Acc: 0.8686
 Site-Real                          | Train Loss: 0.2576 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.2020 | Train Acc: 0.9725
 Site-Painting                      | Train Loss: 0.4354 | Train Acc: 0.8599
 Site-Painting                      | Train Loss: 0.4452 | Train Acc: 0.8941
 Site-Sketch                        | Train Loss: 0.5845 | Train Acc: 0.8217
 Site-Sketch                        | Train Loss: 0.5025 | Train Acc: 0.8623
 Site-QuickDraw                     | Train Loss: 1.4294 | Train Acc: 0.5669
 Site-QuickDraw                     | Train Loss: 1.3717 | Train Acc: 0.5742
 Site-Infograph                     | Train Loss: 1.5230 | Train Acc: 0.5223
 Site-Infograph                     | Train Loss: 1.3965 | Train Acc: 0.5657
Average Train Accuracy: 0.7764
 Site-Clipart                       | Val  Loss: 0.5366 | Val  Acc: 0.8952
 Site-Clipart                       | Val  Loss: 0.5794 | Val  Acc: 0.8603
 Site-Real                          | Val  Loss: 0.1945 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.2090 | Val  Acc: 0.9651
 Site-Painting                      | Val  Loss: 0.3671 | Val  Acc: 0.9238
 Site-Painting                      | Val  Loss: 0.4315 | Val  Acc: 0.8889
 Site-Sketch                        | Val  Loss: 0.4679 | Val  Acc: 0.8762
 Site-Sketch                        | Val  Loss: 0.4556 | Val  Acc: 0.8794
 Site-QuickDraw                     | Val  Loss: 1.4604 | Val  Acc: 0.5524
 Site-QuickDraw                     | Val  Loss: 1.3471 | Val  Acc: 0.5968
 Site-Infograph                     | Val  Loss: 1.5542 | Val  Acc: 0.5143
 Site-Infograph                     | Val  Loss: 1.4732 | Val  Acc: 0.5206
Average Valid Accuracy: 0.7870
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8952
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8603
 Best site-Real                      | Epoch:4 | Val Acc: 0.9714
 Best site-Real                      | Epoch:4 | Val Acc: 0.9651
 Best site-Painting                  | Epoch:4 | Val Acc: 0.9238
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8889
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.8762
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.8794
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.5524
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.5968
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.5143
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.5206
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 0.4719 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.4299 | Train Acc: 0.9025
 Site-Real                          | Train Loss: 0.2468 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.1645 | Train Acc: 0.9767
 Site-Painting                      | Train Loss: 0.3733 | Train Acc: 0.8981
 Site-Painting                      | Train Loss: 0.3949 | Train Acc: 0.8962
 Site-Sketch                        | Train Loss: 0.5233 | Train Acc: 0.8344
 Site-Sketch                        | Train Loss: 0.4478 | Train Acc: 0.8835
 Site-QuickDraw                     | Train Loss: 1.3420 | Train Acc: 0.5796
 Site-QuickDraw                     | Train Loss: 1.3103 | Train Acc: 0.6038
 Site-Infograph                     | Train Loss: 1.4670 | Train Acc: 0.5350
 Site-Infograph                     | Train Loss: 1.3498 | Train Acc: 0.5614
Average Train Accuracy: 0.7921
 Site-Clipart                       | Val  Loss: 0.4350 | Val  Acc: 0.9238
 Site-Clipart                       | Val  Loss: 0.5157 | Val  Acc: 0.8635
 Site-Real                          | Val  Loss: 0.1577 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.1849 | Val  Acc: 0.9746
 Site-Painting                      | Val  Loss: 0.2662 | Val  Acc: 0.9238
 Site-Painting                      | Val  Loss: 0.4140 | Val  Acc: 0.8794
 Site-Sketch                        | Val  Loss: 0.4244 | Val  Acc: 0.8952
 Site-Sketch                        | Val  Loss: 0.4514 | Val  Acc: 0.8762
 Site-QuickDraw                     | Val  Loss: 1.3205 | Val  Acc: 0.6000
 Site-QuickDraw                     | Val  Loss: 1.2629 | Val  Acc: 0.6127
 Site-Infograph                     | Val  Loss: 1.4626 | Val  Acc: 0.5333
 Site-Infograph                     | Val  Loss: 1.4343 | Val  Acc: 0.5556
Average Valid Accuracy: 0.8016
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.9238
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8635
 Best site-Real                      | Epoch:5 | Val Acc: 0.9810
 Best site-Real                      | Epoch:5 | Val Acc: 0.9746
 Best site-Painting                  | Epoch:5 | Val Acc: 0.9238
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8794
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.8952
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.8762
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.6000
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.6127
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.5333
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.5556
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 0.4665 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.4282 | Train Acc: 0.9110
 Site-Real                          | Train Loss: 0.1852 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.1449 | Train Acc: 0.9725
 Site-Painting                      | Train Loss: 0.3715 | Train Acc: 0.8790
 Site-Painting                      | Train Loss: 0.3689 | Train Acc: 0.9174
 Site-Sketch                        | Train Loss: 0.5052 | Train Acc: 0.8471
 Site-Sketch                        | Train Loss: 0.4415 | Train Acc: 0.8729
 Site-QuickDraw                     | Train Loss: 1.2437 | Train Acc: 0.6115
 Site-QuickDraw                     | Train Loss: 1.2349 | Train Acc: 0.6462
 Site-Infograph                     | Train Loss: 1.4695 | Train Acc: 0.5287
 Site-Infograph                     | Train Loss: 1.3579 | Train Acc: 0.5996
Average Train Accuracy: 0.8022
 Site-Clipart                       | Val  Loss: 0.4386 | Val  Acc: 0.9048
 Site-Clipart                       | Val  Loss: 0.4526 | Val  Acc: 0.9048
 Site-Real                          | Val  Loss: 0.1307 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.1692 | Val  Acc: 0.9778
 Site-Painting                      | Val  Loss: 0.2598 | Val  Acc: 0.9333
 Site-Painting                      | Val  Loss: 0.3615 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.3915 | Val  Acc: 0.8857
 Site-Sketch                        | Val  Loss: 0.4513 | Val  Acc: 0.8667
 Site-QuickDraw                     | Val  Loss: 1.2438 | Val  Acc: 0.5714
 Site-QuickDraw                     | Val  Loss: 1.2380 | Val  Acc: 0.6381
 Site-Infograph                     | Val  Loss: 1.5430 | Val  Acc: 0.4857
 Site-Infograph                     | Val  Loss: 1.4088 | Val  Acc: 0.5429
Average Valid Accuracy: 0.8005
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 0.4559 | Train Acc: 0.8599
 Site-Clipart                       | Train Loss: 0.4140 | Train Acc: 0.9004
 Site-Real                          | Train Loss: 0.2064 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.1247 | Train Acc: 0.9767
 Site-Painting                      | Train Loss: 0.3801 | Train Acc: 0.8917
 Site-Painting                      | Train Loss: 0.3542 | Train Acc: 0.9258
 Site-Sketch                        | Train Loss: 0.5264 | Train Acc: 0.8471
 Site-Sketch                        | Train Loss: 0.4259 | Train Acc: 0.8708
 Site-QuickDraw                     | Train Loss: 1.2216 | Train Acc: 0.6497
 Site-QuickDraw                     | Train Loss: 1.1450 | Train Acc: 0.6441
 Site-Infograph                     | Train Loss: 1.5044 | Train Acc: 0.5350
 Site-Infograph                     | Train Loss: 1.3002 | Train Acc: 0.5699
Average Train Accuracy: 0.8017
 Site-Clipart                       | Val  Loss: 0.4293 | Val  Acc: 0.8762
 Site-Clipart                       | Val  Loss: 0.4175 | Val  Acc: 0.9111
 Site-Real                          | Val  Loss: 0.1431 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.1583 | Val  Acc: 0.9683
 Site-Painting                      | Val  Loss: 0.2742 | Val  Acc: 0.9143
 Site-Painting                      | Val  Loss: 0.3299 | Val  Acc: 0.9079
 Site-Sketch                        | Val  Loss: 0.3949 | Val  Acc: 0.8952
 Site-Sketch                        | Val  Loss: 0.4207 | Val  Acc: 0.8825
 Site-QuickDraw                     | Val  Loss: 1.1609 | Val  Acc: 0.6476
 Site-QuickDraw                     | Val  Loss: 1.1338 | Val  Acc: 0.6603
 Site-Infograph                     | Val  Loss: 1.3938 | Val  Acc: 0.5524
 Site-Infograph                     | Val  Loss: 1.3503 | Val  Acc: 0.5619
Average Valid Accuracy: 0.8132
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8762
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9111
 Best site-Real                      | Epoch:7 | Val Acc: 0.9810
 Best site-Real                      | Epoch:7 | Val Acc: 0.9683
 Best site-Painting                  | Epoch:7 | Val Acc: 0.9143
 Best site-Painting                  | Epoch:7 | Val Acc: 0.9079
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.8952
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.8825
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.6476
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.6603
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.5524
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.5619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 0.5095 | Train Acc: 0.8599
 Site-Clipart                       | Train Loss: 0.3698 | Train Acc: 0.9068
 Site-Real                          | Train Loss: 0.1766 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.1244 | Train Acc: 0.9746
 Site-Painting                      | Train Loss: 0.4052 | Train Acc: 0.8854
 Site-Painting                      | Train Loss: 0.3130 | Train Acc: 0.9280
 Site-Sketch                        | Train Loss: 0.4718 | Train Acc: 0.8662
 Site-Sketch                        | Train Loss: 0.3919 | Train Acc: 0.8941
 Site-QuickDraw                     | Train Loss: 1.1983 | Train Acc: 0.6242
 Site-QuickDraw                     | Train Loss: 1.1285 | Train Acc: 0.6419
 Site-Infograph                     | Train Loss: 1.4836 | Train Acc: 0.5159
 Site-Infograph                     | Train Loss: 1.2817 | Train Acc: 0.5890
Average Train Accuracy: 0.8024
 Site-Clipart                       | Val  Loss: 0.3652 | Val  Acc: 0.9143
 Site-Clipart                       | Val  Loss: 0.4121 | Val  Acc: 0.9016
 Site-Real                          | Val  Loss: 0.1355 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.1206 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.2466 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.3342 | Val  Acc: 0.9206
 Site-Sketch                        | Val  Loss: 0.3235 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.4224 | Val  Acc: 0.8667
 Site-QuickDraw                     | Val  Loss: 1.1646 | Val  Acc: 0.6190
 Site-QuickDraw                     | Val  Loss: 1.1618 | Val  Acc: 0.6571
 Site-Infograph                     | Val  Loss: 1.3574 | Val  Acc: 0.5238
 Site-Infograph                     | Val  Loss: 1.3736 | Val  Acc: 0.5683
Average Valid Accuracy: 0.8175
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9143
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9016
 Best site-Real                      | Epoch:8 | Val Acc: 0.9714
 Best site-Real                      | Epoch:8 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:8 | Val Acc: 0.9619
 Best site-Painting                  | Epoch:8 | Val Acc: 0.9206
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.9238
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.8667
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.6190
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.6571
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.5238
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.5683
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 0.4675 | Train Acc: 0.8599
 Site-Clipart                       | Train Loss: 0.3534 | Train Acc: 0.9068
 Site-Real                          | Train Loss: 0.1731 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.1147 | Train Acc: 0.9831
 Site-Painting                      | Train Loss: 0.3606 | Train Acc: 0.8981
 Site-Painting                      | Train Loss: 0.3037 | Train Acc: 0.9153
 Site-Sketch                        | Train Loss: 0.4320 | Train Acc: 0.8599
 Site-Sketch                        | Train Loss: 0.3876 | Train Acc: 0.8729
 Site-QuickDraw                     | Train Loss: 1.1775 | Train Acc: 0.6433
 Site-QuickDraw                     | Train Loss: 1.1103 | Train Acc: 0.6547
 Site-Infograph                     | Train Loss: 1.4217 | Train Acc: 0.5541
 Site-Infograph                     | Train Loss: 1.2981 | Train Acc: 0.5720
Average Train Accuracy: 0.8063
 Site-Clipart                       | Val  Loss: 0.4120 | Val  Acc: 0.9143
 Site-Clipart                       | Val  Loss: 0.4043 | Val  Acc: 0.9143
 Site-Real                          | Val  Loss: 0.1304 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.1183 | Val  Acc: 0.9873
 Site-Painting                      | Val  Loss: 0.2135 | Val  Acc: 0.9429
 Site-Painting                      | Val  Loss: 0.3151 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.3525 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.3934 | Val  Acc: 0.8762
 Site-QuickDraw                     | Val  Loss: 1.1691 | Val  Acc: 0.6476
 Site-QuickDraw                     | Val  Loss: 1.1000 | Val  Acc: 0.6571
 Site-Infograph                     | Val  Loss: 1.4229 | Val  Acc: 0.5714
 Site-Infograph                     | Val  Loss: 1.3637 | Val  Acc: 0.5333
Average Valid Accuracy: 0.8180
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9143
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9143
 Best site-Real                      | Epoch:9 | Val Acc: 0.9619
 Best site-Real                      | Epoch:9 | Val Acc: 0.9873
 Best site-Painting                  | Epoch:9 | Val Acc: 0.9429
 Best site-Painting                  | Epoch:9 | Val Acc: 0.9048
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.9048
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8762
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.6476
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.6571
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.5714
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.5333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 0.4261 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.3595 | Train Acc: 0.9153
 Site-Real                          | Train Loss: 0.1845 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.1221 | Train Acc: 0.9746
 Site-Painting                      | Train Loss: 0.3412 | Train Acc: 0.8917
 Site-Painting                      | Train Loss: 0.2934 | Train Acc: 0.9322
 Site-Sketch                        | Train Loss: 0.4605 | Train Acc: 0.8471
 Site-Sketch                        | Train Loss: 0.3944 | Train Acc: 0.8792
 Site-QuickDraw                     | Train Loss: 1.0247 | Train Acc: 0.6433
 Site-QuickDraw                     | Train Loss: 1.0311 | Train Acc: 0.6843
 Site-Infograph                     | Train Loss: 1.3597 | Train Acc: 0.5541
 Site-Infograph                     | Train Loss: 1.2774 | Train Acc: 0.5869
Average Train Accuracy: 0.8135
 Site-Clipart                       | Val  Loss: 0.2882 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.3530 | Val  Acc: 0.9175
 Site-Real                          | Val  Loss: 0.0924 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.1101 | Val  Acc: 0.9841
 Site-Painting                      | Val  Loss: 0.1903 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.2936 | Val  Acc: 0.9302
 Site-Sketch                        | Val  Loss: 0.3240 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.3574 | Val  Acc: 0.8857
 Site-QuickDraw                     | Val  Loss: 1.0996 | Val  Acc: 0.6667
 Site-QuickDraw                     | Val  Loss: 1.0479 | Val  Acc: 0.6889
 Site-Infograph                     | Val  Loss: 1.3836 | Val  Acc: 0.4952
 Site-Infograph                     | Val  Loss: 1.2868 | Val  Acc: 0.5810
Average Valid Accuracy: 0.8299
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9619
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9175
 Best site-Real                      | Epoch:10 | Val Acc: 0.9905
 Best site-Real                      | Epoch:10 | Val Acc: 0.9841
 Best site-Painting                  | Epoch:10 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:10 | Val Acc: 0.9302
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.9048
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.8857
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.6667
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.6889
 Best site-Infograph                 | Epoch:10 | Val Acc: 0.4952
 Best site-Infograph                 | Epoch:10 | Val Acc: 0.5810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 0.4038 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.3385 | Train Acc: 0.9258
 Site-Real                          | Train Loss: 0.1575 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0971 | Train Acc: 0.9809
 Site-Painting                      | Train Loss: 0.3327 | Train Acc: 0.8981
 Site-Painting                      | Train Loss: 0.2807 | Train Acc: 0.9258
 Site-Sketch                        | Train Loss: 0.3985 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.3721 | Train Acc: 0.8686
 Site-QuickDraw                     | Train Loss: 1.1577 | Train Acc: 0.6178
 Site-QuickDraw                     | Train Loss: 1.0696 | Train Acc: 0.6737
 Site-Infograph                     | Train Loss: 1.3359 | Train Acc: 0.5350
 Site-Infograph                     | Train Loss: 1.2166 | Train Acc: 0.6081
Average Train Accuracy: 0.8133
 Site-Clipart                       | Val  Loss: 0.3206 | Val  Acc: 0.9238
 Site-Clipart                       | Val  Loss: 0.3635 | Val  Acc: 0.9048
 Site-Real                          | Val  Loss: 0.0908 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.1073 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.2196 | Val  Acc: 0.9333
 Site-Painting                      | Val  Loss: 0.2551 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.3166 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.3441 | Val  Acc: 0.8889
 Site-QuickDraw                     | Val  Loss: 1.0948 | Val  Acc: 0.6286
 Site-QuickDraw                     | Val  Loss: 1.0472 | Val  Acc: 0.6857
 Site-Infograph                     | Val  Loss: 1.3208 | Val  Acc: 0.5905
 Site-Infograph                     | Val  Loss: 1.2502 | Val  Acc: 0.6095
Average Valid Accuracy: 0.8328
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9238
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9048
 Best site-Real                      | Epoch:11 | Val Acc: 0.9905
 Best site-Real                      | Epoch:11 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:11 | Val Acc: 0.9333
 Best site-Painting                  | Epoch:11 | Val Acc: 0.9429
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.9143
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.8889
 Best site-QuickDraw                 | Epoch:11 | Val Acc: 0.6286
 Best site-QuickDraw                 | Epoch:11 | Val Acc: 0.6857
 Best site-Infograph                 | Epoch:11 | Val Acc: 0.5905
 Best site-Infograph                 | Epoch:11 | Val Acc: 0.6095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 0.4425 | Train Acc: 0.8726
 Site-Clipart                       | Train Loss: 0.3348 | Train Acc: 0.9131
 Site-Real                          | Train Loss: 0.1687 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0778 | Train Acc: 0.9852
 Site-Painting                      | Train Loss: 0.3299 | Train Acc: 0.9108
 Site-Painting                      | Train Loss: 0.2703 | Train Acc: 0.9280
 Site-Sketch                        | Train Loss: 0.4462 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.3513 | Train Acc: 0.8856
 Site-QuickDraw                     | Train Loss: 1.0939 | Train Acc: 0.6624
 Site-QuickDraw                     | Train Loss: 1.0345 | Train Acc: 0.6886
 Site-Infograph                     | Train Loss: 1.3602 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.2447 | Train Acc: 0.6038
Average Train Accuracy: 0.8209
 Site-Clipart                       | Val  Loss: 0.3501 | Val  Acc: 0.9048
 Site-Clipart                       | Val  Loss: 0.3503 | Val  Acc: 0.9079
 Site-Real                          | Val  Loss: 0.1016 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.0947 | Val  Acc: 0.9841
 Site-Painting                      | Val  Loss: 0.2032 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.2742 | Val  Acc: 0.9302
 Site-Sketch                        | Val  Loss: 0.3604 | Val  Acc: 0.8762
 Site-Sketch                        | Val  Loss: 0.3387 | Val  Acc: 0.9048
 Site-QuickDraw                     | Val  Loss: 1.1343 | Val  Acc: 0.6190
 Site-QuickDraw                     | Val  Loss: 1.0332 | Val  Acc: 0.7206
 Site-Infograph                     | Val  Loss: 1.3136 | Val  Acc: 0.5429
 Site-Infograph                     | Val  Loss: 1.2501 | Val  Acc: 0.6063
Average Valid Accuracy: 0.8275
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 0.3541 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.3032 | Train Acc: 0.9280
 Site-Real                          | Train Loss: 0.1379 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0989 | Train Acc: 0.9788
 Site-Painting                      | Train Loss: 0.3221 | Train Acc: 0.9045
 Site-Painting                      | Train Loss: 0.2421 | Train Acc: 0.9407
 Site-Sketch                        | Train Loss: 0.3617 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.3576 | Train Acc: 0.8898
 Site-QuickDraw                     | Train Loss: 0.9408 | Train Acc: 0.6561
 Site-QuickDraw                     | Train Loss: 0.9939 | Train Acc: 0.6843
 Site-Infograph                     | Train Loss: 1.3981 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 1.2180 | Train Acc: 0.5932
Average Train Accuracy: 0.8234
 Site-Clipart                       | Val  Loss: 0.3090 | Val  Acc: 0.9048
 Site-Clipart                       | Val  Loss: 0.3443 | Val  Acc: 0.9143
 Site-Real                          | Val  Loss: 0.0755 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0886 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1959 | Val  Acc: 0.9429
 Site-Painting                      | Val  Loss: 0.2897 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2712 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.3273 | Val  Acc: 0.9079
 Site-QuickDraw                     | Val  Loss: 1.0350 | Val  Acc: 0.6667
 Site-QuickDraw                     | Val  Loss: 0.9310 | Val  Acc: 0.7048
 Site-Infograph                     | Val  Loss: 1.3623 | Val  Acc: 0.5714
 Site-Infograph                     | Val  Loss: 1.2551 | Val  Acc: 0.6032
Average Valid Accuracy: 0.8373
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9048
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9143
 Best site-Real                      | Epoch:13 | Val Acc: 1.0000
 Best site-Real                      | Epoch:13 | Val Acc: 0.9937
 Best site-Painting                  | Epoch:13 | Val Acc: 0.9429
 Best site-Painting                  | Epoch:13 | Val Acc: 0.9333
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.9048
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.9079
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.6667
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.7048
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.5714
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.6032
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 0.4627 | Train Acc: 0.8408
 Site-Clipart                       | Train Loss: 0.3036 | Train Acc: 0.9364
 Site-Real                          | Train Loss: 0.1755 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0907 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2861 | Train Acc: 0.8981
 Site-Painting                      | Train Loss: 0.2615 | Train Acc: 0.9449
 Site-Sketch                        | Train Loss: 0.4004 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.3294 | Train Acc: 0.8941
 Site-QuickDraw                     | Train Loss: 0.9387 | Train Acc: 0.6624
 Site-QuickDraw                     | Train Loss: 0.9826 | Train Acc: 0.6949
 Site-Infograph                     | Train Loss: 1.4091 | Train Acc: 0.5860
 Site-Infograph                     | Train Loss: 1.1771 | Train Acc: 0.6165
Average Train Accuracy: 0.8239
 Site-Clipart                       | Val  Loss: 0.3304 | Val  Acc: 0.9238
 Site-Clipart                       | Val  Loss: 0.3338 | Val  Acc: 0.9175
 Site-Real                          | Val  Loss: 0.0855 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0850 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1782 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.3050 | Val  Acc: 0.9206
 Site-Sketch                        | Val  Loss: 0.2811 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.3357 | Val  Acc: 0.8730
 Site-QuickDraw                     | Val  Loss: 1.0509 | Val  Acc: 0.6190
 Site-QuickDraw                     | Val  Loss: 0.9453 | Val  Acc: 0.7079
 Site-Infograph                     | Val  Loss: 1.3372 | Val  Acc: 0.5905
 Site-Infograph                     | Val  Loss: 1.2415 | Val  Acc: 0.6095
Average Valid Accuracy: 0.8373
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 0.3222 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.3115 | Train Acc: 0.9195
 Site-Real                          | Train Loss: 0.1701 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0721 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2958 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.2623 | Train Acc: 0.9301
 Site-Sketch                        | Train Loss: 0.4142 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.2990 | Train Acc: 0.9131
 Site-QuickDraw                     | Train Loss: 1.0102 | Train Acc: 0.6815
 Site-QuickDraw                     | Train Loss: 0.9373 | Train Acc: 0.7034
 Site-Infograph                     | Train Loss: 1.4166 | Train Acc: 0.5414
 Site-Infograph                     | Train Loss: 1.1692 | Train Acc: 0.6165
Average Train Accuracy: 0.8294
 Site-Clipart                       | Val  Loss: 0.2715 | Val  Acc: 0.9238
 Site-Clipart                       | Val  Loss: 0.3022 | Val  Acc: 0.9270
 Site-Real                          | Val  Loss: 0.0791 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.0858 | Val  Acc: 0.9873
 Site-Painting                      | Val  Loss: 0.1946 | Val  Acc: 0.9429
 Site-Painting                      | Val  Loss: 0.2301 | Val  Acc: 0.9397
 Site-Sketch                        | Val  Loss: 0.2529 | Val  Acc: 0.8857
 Site-Sketch                        | Val  Loss: 0.3176 | Val  Acc: 0.8921
 Site-QuickDraw                     | Val  Loss: 1.0351 | Val  Acc: 0.6667
 Site-QuickDraw                     | Val  Loss: 0.9666 | Val  Acc: 0.6952
 Site-Infograph                     | Val  Loss: 1.3008 | Val  Acc: 0.6000
 Site-Infograph                     | Val  Loss: 1.1648 | Val  Acc: 0.6254
Average Valid Accuracy: 0.8389
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.9238
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.9270
 Best site-Real                      | Epoch:15 | Val Acc: 0.9810
 Best site-Real                      | Epoch:15 | Val Acc: 0.9873
 Best site-Painting                  | Epoch:15 | Val Acc: 0.9429
 Best site-Painting                  | Epoch:15 | Val Acc: 0.9397
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.8857
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.8921
 Best site-QuickDraw                 | Epoch:15 | Val Acc: 0.6667
 Best site-QuickDraw                 | Epoch:15 | Val Acc: 0.6952
 Best site-Infograph                 | Epoch:15 | Val Acc: 0.6000
 Best site-Infograph                 | Epoch:15 | Val Acc: 0.6254
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 0.4118 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.2998 | Train Acc: 0.9258
 Site-Real                          | Train Loss: 0.1755 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0675 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2506 | Train Acc: 0.9172
 Site-Painting                      | Train Loss: 0.2327 | Train Acc: 0.9470
 Site-Sketch                        | Train Loss: 0.3769 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.2949 | Train Acc: 0.9131
 Site-QuickDraw                     | Train Loss: 1.0264 | Train Acc: 0.6624
 Site-QuickDraw                     | Train Loss: 0.9245 | Train Acc: 0.7267
 Site-Infograph                     | Train Loss: 1.3486 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 1.1291 | Train Acc: 0.6398
Average Train Accuracy: 0.8326
 Site-Clipart                       | Val  Loss: 0.3148 | Val  Acc: 0.9238
 Site-Clipart                       | Val  Loss: 0.3118 | Val  Acc: 0.9302
 Site-Real                          | Val  Loss: 0.0689 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0789 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1270 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.2561 | Val  Acc: 0.9175
 Site-Sketch                        | Val  Loss: 0.2457 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.3179 | Val  Acc: 0.8889
 Site-QuickDraw                     | Val  Loss: 1.0219 | Val  Acc: 0.6762
 Site-QuickDraw                     | Val  Loss: 0.9424 | Val  Acc: 0.7302
 Site-Infograph                     | Val  Loss: 1.2975 | Val  Acc: 0.5238
 Site-Infograph                     | Val  Loss: 1.1345 | Val  Acc: 0.6413
Average Valid Accuracy: 0.8434
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.9238
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.9302
 Best site-Real                      | Epoch:16 | Val Acc: 1.0000
 Best site-Real                      | Epoch:16 | Val Acc: 0.9937
 Best site-Painting                  | Epoch:16 | Val Acc: 0.9714
 Best site-Painting                  | Epoch:16 | Val Acc: 0.9175
 Best site-Sketch                    | Epoch:16 | Val Acc: 0.9238
 Best site-Sketch                    | Epoch:16 | Val Acc: 0.8889
 Best site-QuickDraw                 | Epoch:16 | Val Acc: 0.6762
 Best site-QuickDraw                 | Epoch:16 | Val Acc: 0.7302
 Best site-Infograph                 | Epoch:16 | Val Acc: 0.5238
 Best site-Infograph                 | Epoch:16 | Val Acc: 0.6413
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 0.3229 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.2882 | Train Acc: 0.9301
 Site-Real                          | Train Loss: 0.1711 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0679 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2747 | Train Acc: 0.9045
 Site-Painting                      | Train Loss: 0.2152 | Train Acc: 0.9428
 Site-Sketch                        | Train Loss: 0.4165 | Train Acc: 0.8471
 Site-Sketch                        | Train Loss: 0.2867 | Train Acc: 0.9216
 Site-QuickDraw                     | Train Loss: 0.9786 | Train Acc: 0.6752
 Site-QuickDraw                     | Train Loss: 0.9584 | Train Acc: 0.6864
 Site-Infograph                     | Train Loss: 1.4027 | Train Acc: 0.5414
 Site-Infograph                     | Train Loss: 1.1153 | Train Acc: 0.6462
Average Train Accuracy: 0.8303
 Site-Clipart                       | Val  Loss: 0.3205 | Val  Acc: 0.8857
 Site-Clipart                       | Val  Loss: 0.3006 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 0.0486 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0637 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1370 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.2424 | Val  Acc: 0.9492
 Site-Sketch                        | Val  Loss: 0.2409 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.3008 | Val  Acc: 0.9206
 Site-QuickDraw                     | Val  Loss: 1.0188 | Val  Acc: 0.6381
 Site-QuickDraw                     | Val  Loss: 0.9321 | Val  Acc: 0.7175
 Site-Infograph                     | Val  Loss: 1.2891 | Val  Acc: 0.5524
 Site-Infograph                     | Val  Loss: 1.2170 | Val  Acc: 0.6254
Average Valid Accuracy: 0.8426
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 0.3841 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.2548 | Train Acc: 0.9280
 Site-Real                          | Train Loss: 0.1543 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0764 | Train Acc: 0.9894
 Site-Painting                      | Train Loss: 0.2313 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.2254 | Train Acc: 0.9513
 Site-Sketch                        | Train Loss: 0.3130 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.3022 | Train Acc: 0.9110
 Site-QuickDraw                     | Train Loss: 0.9177 | Train Acc: 0.6815
 Site-QuickDraw                     | Train Loss: 0.9437 | Train Acc: 0.7203
 Site-Infograph                     | Train Loss: 1.4098 | Train Acc: 0.5414
 Site-Infograph                     | Train Loss: 1.1189 | Train Acc: 0.6356
Average Train Accuracy: 0.8351
 Site-Clipart                       | Val  Loss: 0.2394 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.2948 | Val  Acc: 0.9143
 Site-Real                          | Val  Loss: 0.0742 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0724 | Val  Acc: 0.9873
 Site-Painting                      | Val  Loss: 0.1341 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.2213 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2262 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.3138 | Val  Acc: 0.8984
 Site-QuickDraw                     | Val  Loss: 0.9671 | Val  Acc: 0.7048
 Site-QuickDraw                     | Val  Loss: 0.9199 | Val  Acc: 0.7365
 Site-Infograph                     | Val  Loss: 1.1739 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 1.1964 | Val  Acc: 0.6032
Average Valid Accuracy: 0.8529
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9143
 Best site-Real                      | Epoch:18 | Val Acc: 0.9905
 Best site-Real                      | Epoch:18 | Val Acc: 0.9873
 Best site-Painting                  | Epoch:18 | Val Acc: 0.9714
 Best site-Painting                  | Epoch:18 | Val Acc: 0.9429
 Best site-Sketch                    | Epoch:18 | Val Acc: 0.9429
 Best site-Sketch                    | Epoch:18 | Val Acc: 0.8984
 Best site-QuickDraw                 | Epoch:18 | Val Acc: 0.7048
 Best site-QuickDraw                 | Epoch:18 | Val Acc: 0.7365
 Best site-Infograph                 | Epoch:18 | Val Acc: 0.6095
 Best site-Infograph                 | Epoch:18 | Val Acc: 0.6032
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 0.3212 | Train Acc: 0.8726
 Site-Clipart                       | Train Loss: 0.2563 | Train Acc: 0.9343
 Site-Real                          | Train Loss: 0.1448 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0655 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.3168 | Train Acc: 0.8917
 Site-Painting                      | Train Loss: 0.1888 | Train Acc: 0.9513
 Site-Sketch                        | Train Loss: 0.4105 | Train Acc: 0.8981
 Site-Sketch                        | Train Loss: 0.2826 | Train Acc: 0.9068
 Site-QuickDraw                     | Train Loss: 0.9434 | Train Acc: 0.6688
 Site-QuickDraw                     | Train Loss: 0.9388 | Train Acc: 0.7097
 Site-Infograph                     | Train Loss: 1.3666 | Train Acc: 0.5541
 Site-Infograph                     | Train Loss: 1.1240 | Train Acc: 0.6419
Average Train Accuracy: 0.8319
 Site-Clipart                       | Val  Loss: 0.2292 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.2872 | Val  Acc: 0.9302
 Site-Real                          | Val  Loss: 0.0457 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0601 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1197 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.2320 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2422 | Val  Acc: 0.8952
 Site-Sketch                        | Val  Loss: 0.2781 | Val  Acc: 0.9079
 Site-QuickDraw                     | Val  Loss: 0.9398 | Val  Acc: 0.7429
 Site-QuickDraw                     | Val  Loss: 0.9081 | Val  Acc: 0.7492
 Site-Infograph                     | Val  Loss: 1.2735 | Val  Acc: 0.5810
 Site-Infograph                     | Val  Loss: 1.1559 | Val  Acc: 0.6254
Average Valid Accuracy: 0.8553
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.9429
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.9302
 Best site-Real                      | Epoch:19 | Val Acc: 1.0000
 Best site-Real                      | Epoch:19 | Val Acc: 0.9937
 Best site-Painting                  | Epoch:19 | Val Acc: 0.9619
 Best site-Painting                  | Epoch:19 | Val Acc: 0.9333
 Best site-Sketch                    | Epoch:19 | Val Acc: 0.8952
 Best site-Sketch                    | Epoch:19 | Val Acc: 0.9079
 Best site-QuickDraw                 | Epoch:19 | Val Acc: 0.7429
 Best site-QuickDraw                 | Epoch:19 | Val Acc: 0.7492
 Best site-Infograph                 | Epoch:19 | Val Acc: 0.5810
 Best site-Infograph                 | Epoch:19 | Val Acc: 0.6254
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 0.4272 | Train Acc: 0.8535
 Site-Clipart                       | Train Loss: 0.2664 | Train Acc: 0.9343
 Site-Real                          | Train Loss: 0.1486 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0560 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2769 | Train Acc: 0.9172
 Site-Painting                      | Train Loss: 0.1755 | Train Acc: 0.9597
 Site-Sketch                        | Train Loss: 0.3501 | Train Acc: 0.9299
 Site-Sketch                        | Train Loss: 0.2691 | Train Acc: 0.9216
 Site-QuickDraw                     | Train Loss: 0.9142 | Train Acc: 0.7197
 Site-QuickDraw                     | Train Loss: 0.8998 | Train Acc: 0.7309
 Site-Infograph                     | Train Loss: 1.4151 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 1.0785 | Train Acc: 0.6568
Average Train Accuracy: 0.8444
 Site-Clipart                       | Val  Loss: 0.2398 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.2871 | Val  Acc: 0.9365
 Site-Real                          | Val  Loss: 0.0610 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0721 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1613 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.2189 | Val  Acc: 0.9365
 Site-Sketch                        | Val  Loss: 0.2016 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.2662 | Val  Acc: 0.9079
 Site-QuickDraw                     | Val  Loss: 0.9907 | Val  Acc: 0.6381
 Site-QuickDraw                     | Val  Loss: 0.8648 | Val  Acc: 0.7524
 Site-Infograph                     | Val  Loss: 1.1634 | Val  Acc: 0.5905
 Site-Infograph                     | Val  Loss: 1.1587 | Val  Acc: 0.6413
Average Valid Accuracy: 0.8537
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 0.3299 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.2446 | Train Acc: 0.9322
 Site-Real                          | Train Loss: 0.1426 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0576 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2852 | Train Acc: 0.9172
 Site-Painting                      | Train Loss: 0.1878 | Train Acc: 0.9534
 Site-Sketch                        | Train Loss: 0.3788 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.2899 | Train Acc: 0.9068
 Site-QuickDraw                     | Train Loss: 0.8852 | Train Acc: 0.6879
 Site-QuickDraw                     | Train Loss: 0.9126 | Train Acc: 0.7415
 Site-Infograph                     | Train Loss: 1.3710 | Train Acc: 0.5541
 Site-Infograph                     | Train Loss: 1.0800 | Train Acc: 0.6589
Average Train Accuracy: 0.8409
 Site-Clipart                       | Val  Loss: 0.2405 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.3096 | Val  Acc: 0.9079
 Site-Real                          | Val  Loss: 0.0459 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0675 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1295 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.2083 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2919 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.3089 | Val  Acc: 0.8984
 Site-QuickDraw                     | Val  Loss: 0.9411 | Val  Acc: 0.6762
 Site-QuickDraw                     | Val  Loss: 0.8483 | Val  Acc: 0.7270
 Site-Infograph                     | Val  Loss: 1.2695 | Val  Acc: 0.5619
 Site-Infograph                     | Val  Loss: 1.1262 | Val  Acc: 0.6381
Average Valid Accuracy: 0.8500
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 0.3611 | Train Acc: 0.8790
 Site-Clipart                       | Train Loss: 0.2258 | Train Acc: 0.9449
 Site-Real                          | Train Loss: 0.1539 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0568 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.3201 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.1723 | Train Acc: 0.9619
 Site-Sketch                        | Train Loss: 0.3749 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2818 | Train Acc: 0.9110
 Site-QuickDraw                     | Train Loss: 0.9232 | Train Acc: 0.7006
 Site-QuickDraw                     | Train Loss: 0.8789 | Train Acc: 0.7288
 Site-Infograph                     | Train Loss: 1.3888 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.1015 | Train Acc: 0.6631
Average Train Accuracy: 0.8420
 Site-Clipart                       | Val  Loss: 0.2298 | Val  Acc: 0.9238
 Site-Clipart                       | Val  Loss: 0.2874 | Val  Acc: 0.9206
 Site-Real                          | Val  Loss: 0.0860 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0599 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1354 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1884 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2528 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.2708 | Val  Acc: 0.9143
 Site-QuickDraw                     | Val  Loss: 0.8824 | Val  Acc: 0.7143
 Site-QuickDraw                     | Val  Loss: 0.8480 | Val  Acc: 0.7333
 Site-Infograph                     | Val  Loss: 1.1524 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 1.1378 | Val  Acc: 0.6317
Average Valid Accuracy: 0.8574
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.9238
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.9206
 Best site-Real                      | Epoch:22 | Val Acc: 0.9905
 Best site-Real                      | Epoch:22 | Val Acc: 0.9937
 Best site-Painting                  | Epoch:22 | Val Acc: 0.9905
 Best site-Painting                  | Epoch:22 | Val Acc: 0.9524
 Best site-Sketch                    | Epoch:22 | Val Acc: 0.9143
 Best site-Sketch                    | Epoch:22 | Val Acc: 0.9143
 Best site-QuickDraw                 | Epoch:22 | Val Acc: 0.7143
 Best site-QuickDraw                 | Epoch:22 | Val Acc: 0.7333
 Best site-Infograph                 | Epoch:22 | Val Acc: 0.6095
 Best site-Infograph                 | Epoch:22 | Val Acc: 0.6317
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.3145 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.2631 | Train Acc: 0.9258
 Site-Real                          | Train Loss: 0.1215 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0518 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2560 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.1992 | Train Acc: 0.9576
 Site-Sketch                        | Train Loss: 0.2931 | Train Acc: 0.9172
 Site-Sketch                        | Train Loss: 0.2477 | Train Acc: 0.9174
 Site-QuickDraw                     | Train Loss: 0.8689 | Train Acc: 0.7197
 Site-QuickDraw                     | Train Loss: 0.8364 | Train Acc: 0.7331
 Site-Infograph                     | Train Loss: 1.3267 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.1124 | Train Acc: 0.6631
Average Train Accuracy: 0.8492
 Site-Clipart                       | Val  Loss: 0.2658 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.2694 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0461 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0488 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1022 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1739 | Val  Acc: 0.9587
 Site-Sketch                        | Val  Loss: 0.2289 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.2867 | Val  Acc: 0.9238
 Site-QuickDraw                     | Val  Loss: 0.9388 | Val  Acc: 0.6762
 Site-QuickDraw                     | Val  Loss: 0.8403 | Val  Acc: 0.7587
 Site-Infograph                     | Val  Loss: 1.2314 | Val  Acc: 0.5810
 Site-Infograph                     | Val  Loss: 1.1195 | Val  Acc: 0.6413
Average Valid Accuracy: 0.8598
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.9429
 Best site-Real                      | Epoch:23 | Val Acc: 1.0000
 Best site-Real                      | Epoch:23 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:23 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:23 | Val Acc: 0.9587
 Best site-Sketch                    | Epoch:23 | Val Acc: 0.9238
 Best site-Sketch                    | Epoch:23 | Val Acc: 0.9238
 Best site-QuickDraw                 | Epoch:23 | Val Acc: 0.6762
 Best site-QuickDraw                 | Epoch:23 | Val Acc: 0.7587
 Best site-Infograph                 | Epoch:23 | Val Acc: 0.5810
 Best site-Infograph                 | Epoch:23 | Val Acc: 0.6413
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 0.2930 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.2668 | Train Acc: 0.9470
 Site-Real                          | Train Loss: 0.1287 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0442 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2791 | Train Acc: 0.8981
 Site-Painting                      | Train Loss: 0.1739 | Train Acc: 0.9640
 Site-Sketch                        | Train Loss: 0.2757 | Train Acc: 0.8981
 Site-Sketch                        | Train Loss: 0.2646 | Train Acc: 0.9216
 Site-QuickDraw                     | Train Loss: 0.9128 | Train Acc: 0.7070
 Site-QuickDraw                     | Train Loss: 0.8382 | Train Acc: 0.7500
 Site-Infograph                     | Train Loss: 1.3417 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 1.0684 | Train Acc: 0.6547
Average Train Accuracy: 0.8467
 Site-Clipart                       | Val  Loss: 0.2313 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2627 | Val  Acc: 0.9270
 Site-Real                          | Val  Loss: 0.0459 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0517 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1166 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1997 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2074 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.2346 | Val  Acc: 0.9333
 Site-QuickDraw                     | Val  Loss: 0.8402 | Val  Acc: 0.7143
 Site-QuickDraw                     | Val  Loss: 0.8511 | Val  Acc: 0.7492
 Site-Infograph                     | Val  Loss: 1.1423 | Val  Acc: 0.6286
 Site-Infograph                     | Val  Loss: 1.1261 | Val  Acc: 0.6508
Average Valid Accuracy: 0.8675
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9619
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9270
 Best site-Real                      | Epoch:24 | Val Acc: 0.9905
 Best site-Real                      | Epoch:24 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:24 | Val Acc: 0.9905
 Best site-Painting                  | Epoch:24 | Val Acc: 0.9524
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.9143
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.9333
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.7143
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.7492
 Best site-Infograph                 | Epoch:24 | Val Acc: 0.6286
 Best site-Infograph                 | Epoch:24 | Val Acc: 0.6508
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 0.3145 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.2548 | Train Acc: 0.9428
 Site-Real                          | Train Loss: 0.1547 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0455 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2665 | Train Acc: 0.9108
 Site-Painting                      | Train Loss: 0.1775 | Train Acc: 0.9746
 Site-Sketch                        | Train Loss: 0.3976 | Train Acc: 0.8662
 Site-Sketch                        | Train Loss: 0.2644 | Train Acc: 0.9089
 Site-QuickDraw                     | Train Loss: 0.8398 | Train Acc: 0.6815
 Site-QuickDraw                     | Train Loss: 0.8059 | Train Acc: 0.7373
 Site-Infograph                     | Train Loss: 1.3943 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.0792 | Train Acc: 0.6758
Average Train Accuracy: 0.8441
 Site-Clipart                       | Val  Loss: 0.2603 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2603 | Val  Acc: 0.9206
 Site-Real                          | Val  Loss: 0.0550 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0470 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1052 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1723 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.2781 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2562 | Val  Acc: 0.9143
 Site-QuickDraw                     | Val  Loss: 0.9543 | Val  Acc: 0.6952
 Site-QuickDraw                     | Val  Loss: 0.8623 | Val  Acc: 0.7270
 Site-Infograph                     | Val  Loss: 1.1511 | Val  Acc: 0.5905
 Site-Infograph                     | Val  Loss: 1.0709 | Val  Acc: 0.6508
Average Valid Accuracy: 0.8601
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.3545 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.2248 | Train Acc: 0.9449
 Site-Real                          | Train Loss: 0.1456 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0467 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2505 | Train Acc: 0.9172
 Site-Painting                      | Train Loss: 0.1565 | Train Acc: 0.9682
 Site-Sketch                        | Train Loss: 0.3741 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.2337 | Train Acc: 0.9322
 Site-QuickDraw                     | Train Loss: 0.8726 | Train Acc: 0.7006
 Site-QuickDraw                     | Train Loss: 0.8121 | Train Acc: 0.7542
 Site-Infograph                     | Train Loss: 1.3551 | Train Acc: 0.5350
 Site-Infograph                     | Train Loss: 1.0403 | Train Acc: 0.6631
Average Train Accuracy: 0.8441
 Site-Clipart                       | Val  Loss: 0.2012 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2579 | Val  Acc: 0.9302
 Site-Real                          | Val  Loss: 0.0630 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0519 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1501 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.1747 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.2314 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2323 | Val  Acc: 0.9397
 Site-QuickDraw                     | Val  Loss: 0.8970 | Val  Acc: 0.7143
 Site-QuickDraw                     | Val  Loss: 0.8015 | Val  Acc: 0.7619
 Site-Infograph                     | Val  Loss: 1.2098 | Val  Acc: 0.6000
 Site-Infograph                     | Val  Loss: 1.0756 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8675
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 0.2985 | Train Acc: 0.9172
 Site-Clipart                       | Train Loss: 0.2110 | Train Acc: 0.9428
 Site-Real                          | Train Loss: 0.1548 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0506 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2346 | Train Acc: 0.9554
 Site-Painting                      | Train Loss: 0.1628 | Train Acc: 0.9534
 Site-Sketch                        | Train Loss: 0.4666 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.2462 | Train Acc: 0.9195
 Site-QuickDraw                     | Train Loss: 0.8718 | Train Acc: 0.6879
 Site-QuickDraw                     | Train Loss: 0.8240 | Train Acc: 0.7415
 Site-Infograph                     | Train Loss: 1.4161 | Train Acc: 0.4904
 Site-Infograph                     | Train Loss: 1.0361 | Train Acc: 0.6674
Average Train Accuracy: 0.8420
 Site-Clipart                       | Val  Loss: 0.2092 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2608 | Val  Acc: 0.9206
 Site-Real                          | Val  Loss: 0.0481 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0482 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1285 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1599 | Val  Acc: 0.9587
 Site-Sketch                        | Val  Loss: 0.2240 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2416 | Val  Acc: 0.9238
 Site-QuickDraw                     | Val  Loss: 0.8804 | Val  Acc: 0.7048
 Site-QuickDraw                     | Val  Loss: 0.8481 | Val  Acc: 0.7270
 Site-Infograph                     | Val  Loss: 1.0804 | Val  Acc: 0.6190
 Site-Infograph                     | Val  Loss: 1.0884 | Val  Acc: 0.6349
Average Valid Accuracy: 0.8624
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 0.3781 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.2336 | Train Acc: 0.9322
 Site-Real                          | Train Loss: 0.1453 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0404 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2169 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.1655 | Train Acc: 0.9661
 Site-Sketch                        | Train Loss: 0.3129 | Train Acc: 0.9045
 Site-Sketch                        | Train Loss: 0.2526 | Train Acc: 0.9322
 Site-QuickDraw                     | Train Loss: 0.7749 | Train Acc: 0.7389
 Site-QuickDraw                     | Train Loss: 0.7666 | Train Acc: 0.7775
 Site-Infograph                     | Train Loss: 1.2840 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.0956 | Train Acc: 0.6419
Average Train Accuracy: 0.8508
 Site-Clipart                       | Val  Loss: 0.2447 | Val  Acc: 0.9238
 Site-Clipart                       | Val  Loss: 0.2186 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0287 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0554 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1387 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.1418 | Val  Acc: 0.9746
 Site-Sketch                        | Val  Loss: 0.2220 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.2448 | Val  Acc: 0.9302
 Site-QuickDraw                     | Val  Loss: 0.8076 | Val  Acc: 0.7429
 Site-QuickDraw                     | Val  Loss: 0.8106 | Val  Acc: 0.7651
 Site-Infograph                     | Val  Loss: 1.1811 | Val  Acc: 0.6190
 Site-Infograph                     | Val  Loss: 1.1159 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8688
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.9238
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.9429
 Best site-Real                      | Epoch:28 | Val Acc: 1.0000
 Best site-Real                      | Epoch:28 | Val Acc: 0.9937
 Best site-Painting                  | Epoch:28 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:28 | Val Acc: 0.9746
 Best site-Sketch                    | Epoch:28 | Val Acc: 0.9238
 Best site-Sketch                    | Epoch:28 | Val Acc: 0.9302
 Best site-QuickDraw                 | Epoch:28 | Val Acc: 0.7429
 Best site-QuickDraw                 | Epoch:28 | Val Acc: 0.7651
 Best site-Infograph                 | Epoch:28 | Val Acc: 0.6190
 Best site-Infograph                 | Epoch:28 | Val Acc: 0.6571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.2992 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.2072 | Train Acc: 0.9428
 Site-Real                          | Train Loss: 0.0994 | Train Acc: 0.9809
 Site-Real                          | Train Loss: 0.0544 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2606 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.1372 | Train Acc: 0.9725
 Site-Sketch                        | Train Loss: 0.4051 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2244 | Train Acc: 0.9449
 Site-QuickDraw                     | Train Loss: 0.9112 | Train Acc: 0.7006
 Site-QuickDraw                     | Train Loss: 0.7935 | Train Acc: 0.7648
 Site-Infograph                     | Train Loss: 1.2890 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 1.0464 | Train Acc: 0.6525
Average Train Accuracy: 0.8517
 Site-Clipart                       | Val  Loss: 0.2431 | Val  Acc: 0.9238
 Site-Clipart                       | Val  Loss: 0.2345 | Val  Acc: 0.9460
 Site-Real                          | Val  Loss: 0.0396 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0545 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1169 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.1372 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.2171 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.2311 | Val  Acc: 0.9429
 Site-QuickDraw                     | Val  Loss: 0.8577 | Val  Acc: 0.7238
 Site-QuickDraw                     | Val  Loss: 0.7826 | Val  Acc: 0.7524
 Site-Infograph                     | Val  Loss: 1.1787 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 1.0888 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8685
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.2979 | Train Acc: 0.8726
 Site-Clipart                       | Train Loss: 0.2291 | Train Acc: 0.9428
 Site-Real                          | Train Loss: 0.1210 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0417 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2116 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.1422 | Train Acc: 0.9725
 Site-Sketch                        | Train Loss: 0.2770 | Train Acc: 0.9108
 Site-Sketch                        | Train Loss: 0.2303 | Train Acc: 0.9216
 Site-QuickDraw                     | Train Loss: 0.8401 | Train Acc: 0.7134
 Site-QuickDraw                     | Train Loss: 0.7920 | Train Acc: 0.7648
 Site-Infograph                     | Train Loss: 1.3151 | Train Acc: 0.5414
 Site-Infograph                     | Train Loss: 1.0308 | Train Acc: 0.6758
Average Train Accuracy: 0.8524
 Site-Clipart                       | Val  Loss: 0.2202 | Val  Acc: 0.9810
 Site-Clipart                       | Val  Loss: 0.2591 | Val  Acc: 0.9111
 Site-Real                          | Val  Loss: 0.0366 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0616 | Val  Acc: 0.9873
 Site-Painting                      | Val  Loss: 0.1325 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.1426 | Val  Acc: 0.9746
 Site-Sketch                        | Val  Loss: 0.2268 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2164 | Val  Acc: 0.9397
 Site-QuickDraw                     | Val  Loss: 0.7705 | Val  Acc: 0.7238
 Site-QuickDraw                     | Val  Loss: 0.7763 | Val  Acc: 0.7683
 Site-Infograph                     | Val  Loss: 1.1367 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 1.0734 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8730
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.9810
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.9111
 Best site-Real                      | Epoch:30 | Val Acc: 1.0000
 Best site-Real                      | Epoch:30 | Val Acc: 0.9873
 Best site-Painting                  | Epoch:30 | Val Acc: 0.9714
 Best site-Painting                  | Epoch:30 | Val Acc: 0.9746
 Best site-Sketch                    | Epoch:30 | Val Acc: 0.9429
 Best site-Sketch                    | Epoch:30 | Val Acc: 0.9397
 Best site-QuickDraw                 | Epoch:30 | Val Acc: 0.7238
 Best site-QuickDraw                 | Epoch:30 | Val Acc: 0.7683
 Best site-Infograph                 | Epoch:30 | Val Acc: 0.6095
 Best site-Infograph                 | Epoch:30 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.3163 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.2216 | Train Acc: 0.9470
 Site-Real                          | Train Loss: 0.1502 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0507 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.1907 | Train Acc: 0.9554
 Site-Painting                      | Train Loss: 0.1434 | Train Acc: 0.9661
 Site-Sketch                        | Train Loss: 0.3245 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.2186 | Train Acc: 0.9428
 Site-QuickDraw                     | Train Loss: 0.9323 | Train Acc: 0.6624
 Site-QuickDraw                     | Train Loss: 0.7706 | Train Acc: 0.7500
 Site-Infograph                     | Train Loss: 1.4037 | Train Acc: 0.5287
 Site-Infograph                     | Train Loss: 1.0397 | Train Acc: 0.6928
Average Train Accuracy: 0.8485
 Site-Clipart                       | Val  Loss: 0.1960 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.2629 | Val  Acc: 0.9111
 Site-Real                          | Val  Loss: 0.0355 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0365 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1220 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1692 | Val  Acc: 0.9556
 Site-Sketch                        | Val  Loss: 0.1973 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2205 | Val  Acc: 0.9397
 Site-QuickDraw                     | Val  Loss: 0.8437 | Val  Acc: 0.7238
 Site-QuickDraw                     | Val  Loss: 0.7442 | Val  Acc: 0.7651
 Site-Infograph                     | Val  Loss: 1.1023 | Val  Acc: 0.6190
 Site-Infograph                     | Val  Loss: 1.0599 | Val  Acc: 0.6762
Average Valid Accuracy: 0.8706
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.2803 | Train Acc: 0.9172
 Site-Clipart                       | Train Loss: 0.1863 | Train Acc: 0.9619
 Site-Real                          | Train Loss: 0.1427 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0368 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.1888 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.1420 | Train Acc: 0.9703
 Site-Sketch                        | Train Loss: 0.3603 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2445 | Train Acc: 0.9428
 Site-QuickDraw                     | Train Loss: 0.7674 | Train Acc: 0.7134
 Site-QuickDraw                     | Train Loss: 0.7242 | Train Acc: 0.7797
 Site-Infograph                     | Train Loss: 1.3002 | Train Acc: 0.5541
 Site-Infograph                     | Train Loss: 1.0555 | Train Acc: 0.6674
Average Train Accuracy: 0.8570
 Site-Clipart                       | Val  Loss: 0.2006 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.2465 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0248 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0520 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1305 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1510 | Val  Acc: 0.9651
 Site-Sketch                        | Val  Loss: 0.1692 | Val  Acc: 0.9905
 Site-Sketch                        | Val  Loss: 0.2016 | Val  Acc: 0.9587
 Site-QuickDraw                     | Val  Loss: 0.7737 | Val  Acc: 0.7905
 Site-QuickDraw                     | Val  Loss: 0.7858 | Val  Acc: 0.7556
 Site-Infograph                     | Val  Loss: 1.1145 | Val  Acc: 0.6000
 Site-Infograph                     | Val  Loss: 1.0574 | Val  Acc: 0.6635
Average Valid Accuracy: 0.8847
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.9714
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.9429
 Best site-Real                      | Epoch:32 | Val Acc: 1.0000
 Best site-Real                      | Epoch:32 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:32 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:32 | Val Acc: 0.9651
 Best site-Sketch                    | Epoch:32 | Val Acc: 0.9905
 Best site-Sketch                    | Epoch:32 | Val Acc: 0.9587
 Best site-QuickDraw                 | Epoch:32 | Val Acc: 0.7905
 Best site-QuickDraw                 | Epoch:32 | Val Acc: 0.7556
 Best site-Infograph                 | Epoch:32 | Val Acc: 0.6000
 Best site-Infograph                 | Epoch:32 | Val Acc: 0.6635
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.2892 | Train Acc: 0.9172
 Site-Clipart                       | Train Loss: 0.2030 | Train Acc: 0.9555
 Site-Real                          | Train Loss: 0.1365 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0379 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.1881 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.1352 | Train Acc: 0.9725
 Site-Sketch                        | Train Loss: 0.2691 | Train Acc: 0.9236
 Site-Sketch                        | Train Loss: 0.2083 | Train Acc: 0.9322
 Site-QuickDraw                     | Train Loss: 0.8716 | Train Acc: 0.7197
 Site-QuickDraw                     | Train Loss: 0.7570 | Train Acc: 0.7754
 Site-Infograph                     | Train Loss: 1.2834 | Train Acc: 0.5350
 Site-Infograph                     | Train Loss: 1.0410 | Train Acc: 0.6716
Average Train Accuracy: 0.8589
 Site-Clipart                       | Val  Loss: 0.1960 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2193 | Val  Acc: 0.9492
 Site-Real                          | Val  Loss: 0.0246 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0472 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0835 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.1417 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.2288 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2387 | Val  Acc: 0.9079
 Site-QuickDraw                     | Val  Loss: 0.7383 | Val  Acc: 0.7619
 Site-QuickDraw                     | Val  Loss: 0.7581 | Val  Acc: 0.7841
 Site-Infograph                     | Val  Loss: 1.0942 | Val  Acc: 0.6762
 Site-Infograph                     | Val  Loss: 1.0387 | Val  Acc: 0.6762
Average Valid Accuracy: 0.8815
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 0.3262 | Train Acc: 0.8790
 Site-Clipart                       | Train Loss: 0.2018 | Train Acc: 0.9470
 Site-Real                          | Train Loss: 0.1557 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.0378 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2203 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.1428 | Train Acc: 0.9725
 Site-Sketch                        | Train Loss: 0.3691 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.2345 | Train Acc: 0.9280
 Site-QuickDraw                     | Train Loss: 0.8414 | Train Acc: 0.6943
 Site-QuickDraw                     | Train Loss: 0.7623 | Train Acc: 0.7606
 Site-Infograph                     | Train Loss: 1.3299 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 0.9895 | Train Acc: 0.6907
Average Train Accuracy: 0.8489
 Site-Clipart                       | Val  Loss: 0.1959 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2406 | Val  Acc: 0.9365
 Site-Real                          | Val  Loss: 0.0478 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0520 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0806 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1476 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.1606 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2278 | Val  Acc: 0.9238
 Site-QuickDraw                     | Val  Loss: 0.8435 | Val  Acc: 0.7238
 Site-QuickDraw                     | Val  Loss: 0.7875 | Val  Acc: 0.7524
 Site-Infograph                     | Val  Loss: 1.2019 | Val  Acc: 0.6000
 Site-Infograph                     | Val  Loss: 1.0599 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8698
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 0.3156 | Train Acc: 0.9236
 Site-Clipart                       | Train Loss: 0.1857 | Train Acc: 0.9470
 Site-Real                          | Train Loss: 0.1590 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0451 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2352 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.1334 | Train Acc: 0.9682
 Site-Sketch                        | Train Loss: 0.3783 | Train Acc: 0.8981
 Site-Sketch                        | Train Loss: 0.2114 | Train Acc: 0.9470
 Site-QuickDraw                     | Train Loss: 0.8201 | Train Acc: 0.6815
 Site-QuickDraw                     | Train Loss: 0.7259 | Train Acc: 0.7797
 Site-Infograph                     | Train Loss: 1.4134 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 1.0024 | Train Acc: 0.6843
Average Train Accuracy: 0.8549
 Site-Clipart                       | Val  Loss: 0.2059 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2217 | Val  Acc: 0.9492
 Site-Real                          | Val  Loss: 0.0580 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0484 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0988 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1386 | Val  Acc: 0.9746
 Site-Sketch                        | Val  Loss: 0.2117 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.2230 | Val  Acc: 0.9333
 Site-QuickDraw                     | Val  Loss: 0.7502 | Val  Acc: 0.7524
 Site-QuickDraw                     | Val  Loss: 0.7408 | Val  Acc: 0.7429
 Site-Infograph                     | Val  Loss: 1.0699 | Val  Acc: 0.6476
 Site-Infograph                     | Val  Loss: 1.0077 | Val  Acc: 0.6794
Average Valid Accuracy: 0.8783
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.3327 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.1849 | Train Acc: 0.9449
 Site-Real                          | Train Loss: 0.1144 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0319 | Train Acc: 0.9979
 Site-Painting                      | Train Loss: 0.2231 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.1216 | Train Acc: 0.9746
 Site-Sketch                        | Train Loss: 0.3568 | Train Acc: 0.8981
 Site-Sketch                        | Train Loss: 0.2204 | Train Acc: 0.9301
 Site-QuickDraw                     | Train Loss: 0.8003 | Train Acc: 0.7516
 Site-QuickDraw                     | Train Loss: 0.7280 | Train Acc: 0.7924
 Site-Infograph                     | Train Loss: 1.2918 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 0.9865 | Train Acc: 0.6843
Average Train Accuracy: 0.8598
 Site-Clipart                       | Val  Loss: 0.2008 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2327 | Val  Acc: 0.9365
 Site-Real                          | Val  Loss: 0.0362 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0482 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0812 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1540 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.2377 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.1998 | Val  Acc: 0.9460
 Site-QuickDraw                     | Val  Loss: 0.7740 | Val  Acc: 0.7524
 Site-QuickDraw                     | Val  Loss: 0.7891 | Val  Acc: 0.7460
 Site-Infograph                     | Val  Loss: 1.0774 | Val  Acc: 0.6190
 Site-Infograph                     | Val  Loss: 1.0306 | Val  Acc: 0.6730
Average Valid Accuracy: 0.8741
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 0.2933 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.1776 | Train Acc: 0.9534
 Site-Real                          | Train Loss: 0.1274 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0369 | Train Acc: 0.9979
 Site-Painting                      | Train Loss: 0.2674 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.1196 | Train Acc: 0.9788
 Site-Sketch                        | Train Loss: 0.2605 | Train Acc: 0.9172
 Site-Sketch                        | Train Loss: 0.2311 | Train Acc: 0.9280
 Site-QuickDraw                     | Train Loss: 0.7710 | Train Acc: 0.7070
 Site-QuickDraw                     | Train Loss: 0.7245 | Train Acc: 0.7754
 Site-Infograph                     | Train Loss: 1.3027 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 0.9597 | Train Acc: 0.6949
Average Train Accuracy: 0.8596
 Site-Clipart                       | Val  Loss: 0.1962 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.2126 | Val  Acc: 0.9492
 Site-Real                          | Val  Loss: 0.0344 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0411 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0687 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1508 | Val  Acc: 0.9587
 Site-Sketch                        | Val  Loss: 0.1781 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2203 | Val  Acc: 0.9397
 Site-QuickDraw                     | Val  Loss: 0.8013 | Val  Acc: 0.7619
 Site-QuickDraw                     | Val  Loss: 0.7154 | Val  Acc: 0.7873
 Site-Infograph                     | Val  Loss: 1.0824 | Val  Acc: 0.6190
 Site-Infograph                     | Val  Loss: 1.0493 | Val  Acc: 0.6635
Average Valid Accuracy: 0.8810
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.3203 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.1968 | Train Acc: 0.9470
 Site-Real                          | Train Loss: 0.1149 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0389 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2066 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.1377 | Train Acc: 0.9682
 Site-Sketch                        | Train Loss: 0.3183 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.2038 | Train Acc: 0.9449
 Site-QuickDraw                     | Train Loss: 0.7748 | Train Acc: 0.7197
 Site-QuickDraw                     | Train Loss: 0.7506 | Train Acc: 0.7585
 Site-Infograph                     | Train Loss: 1.2792 | Train Acc: 0.5541
 Site-Infograph                     | Train Loss: 0.9837 | Train Acc: 0.6949
Average Train Accuracy: 0.8586
 Site-Clipart                       | Val  Loss: 0.1754 | Val  Acc: 0.9810
 Site-Clipart                       | Val  Loss: 0.1755 | Val  Acc: 0.9587
 Site-Real                          | Val  Loss: 0.0354 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0440 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0800 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1311 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.1783 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2049 | Val  Acc: 0.9397
 Site-QuickDraw                     | Val  Loss: 0.6894 | Val  Acc: 0.8000
 Site-QuickDraw                     | Val  Loss: 0.7415 | Val  Acc: 0.7524
 Site-Infograph                     | Val  Loss: 1.1254 | Val  Acc: 0.6381
 Site-Infograph                     | Val  Loss: 0.9918 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8862
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.9810
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.9587
 Best site-Real                      | Epoch:38 | Val Acc: 1.0000
 Best site-Real                      | Epoch:38 | Val Acc: 0.9937
 Best site-Painting                  | Epoch:38 | Val Acc: 0.9905
 Best site-Painting                  | Epoch:38 | Val Acc: 0.9714
 Best site-Sketch                    | Epoch:38 | Val Acc: 0.9429
 Best site-Sketch                    | Epoch:38 | Val Acc: 0.9397
 Best site-QuickDraw                 | Epoch:38 | Val Acc: 0.8000
 Best site-QuickDraw                 | Epoch:38 | Val Acc: 0.7524
 Best site-Infograph                 | Epoch:38 | Val Acc: 0.6381
 Best site-Infograph                 | Epoch:38 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.2711 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.2091 | Train Acc: 0.9534
 Site-Real                          | Train Loss: 0.0977 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0368 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2433 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.1142 | Train Acc: 0.9746
 Site-Sketch                        | Train Loss: 0.3557 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.2119 | Train Acc: 0.9364
 Site-QuickDraw                     | Train Loss: 0.8352 | Train Acc: 0.7006
 Site-QuickDraw                     | Train Loss: 0.7169 | Train Acc: 0.7839
 Site-Infograph                     | Train Loss: 1.3088 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 0.9642 | Train Acc: 0.6970
Average Train Accuracy: 0.8579
 Site-Clipart                       | Val  Loss: 0.1928 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.1986 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0338 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0385 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0875 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1320 | Val  Acc: 0.9683
 Site-Sketch                        | Val  Loss: 0.1508 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2058 | Val  Acc: 0.9302
 Site-QuickDraw                     | Val  Loss: 0.7557 | Val  Acc: 0.7714
 Site-QuickDraw                     | Val  Loss: 0.7225 | Val  Acc: 0.7746
 Site-Infograph                     | Val  Loss: 1.1222 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 1.0440 | Val  Acc: 0.6794
Average Valid Accuracy: 0.8791
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.3035 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.1570 | Train Acc: 0.9576
 Site-Real                          | Train Loss: 0.0995 | Train Acc: 0.9809
 Site-Real                          | Train Loss: 0.0411 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2268 | Train Acc: 0.9299
 Site-Painting                      | Train Loss: 0.1271 | Train Acc: 0.9788
 Site-Sketch                        | Train Loss: 0.3731 | Train Acc: 0.8662
 Site-Sketch                        | Train Loss: 0.2094 | Train Acc: 0.9343
 Site-QuickDraw                     | Train Loss: 0.7308 | Train Acc: 0.7389
 Site-QuickDraw                     | Train Loss: 0.7079 | Train Acc: 0.7903
 Site-Infograph                     | Train Loss: 1.2865 | Train Acc: 0.5924
 Site-Infograph                     | Train Loss: 0.9417 | Train Acc: 0.7013
Average Train Accuracy: 0.8623
 Site-Clipart                       | Val  Loss: 0.1922 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.2373 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0384 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0384 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1003 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1238 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.1614 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.1956 | Val  Acc: 0.9683
 Site-QuickDraw                     | Val  Loss: 0.7786 | Val  Acc: 0.7333
 Site-QuickDraw                     | Val  Loss: 0.7062 | Val  Acc: 0.8032
 Site-Infograph                     | Val  Loss: 1.0833 | Val  Acc: 0.6857
 Site-Infograph                     | Val  Loss: 1.0001 | Val  Acc: 0.6952
Average Valid Accuracy: 0.8934
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.9714
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.9429
 Best site-Real                      | Epoch:40 | Val Acc: 1.0000
 Best site-Real                      | Epoch:40 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:40 | Val Acc: 0.9905
 Best site-Painting                  | Epoch:40 | Val Acc: 0.9810
 Best site-Sketch                    | Epoch:40 | Val Acc: 0.9524
 Best site-Sketch                    | Epoch:40 | Val Acc: 0.9683
 Best site-QuickDraw                 | Epoch:40 | Val Acc: 0.7333
 Best site-QuickDraw                 | Epoch:40 | Val Acc: 0.8032
 Best site-Infograph                 | Epoch:40 | Val Acc: 0.6857
 Best site-Infograph                 | Epoch:40 | Val Acc: 0.6952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 0.2666 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.1664 | Train Acc: 0.9640
 Site-Real                          | Train Loss: 0.1117 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0378 | Train Acc: 0.9894
 Site-Painting                      | Train Loss: 0.2347 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.1202 | Train Acc: 0.9725
 Site-Sketch                        | Train Loss: 0.3185 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.2065 | Train Acc: 0.9301
 Site-QuickDraw                     | Train Loss: 0.7740 | Train Acc: 0.7325
 Site-QuickDraw                     | Train Loss: 0.7449 | Train Acc: 0.7797
 Site-Infograph                     | Train Loss: 1.3031 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 0.9760 | Train Acc: 0.7076
Average Train Accuracy: 0.8609
 Site-Clipart                       | Val  Loss: 0.2201 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2195 | Val  Acc: 0.9492
 Site-Real                          | Val  Loss: 0.0259 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0351 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0717 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1170 | Val  Acc: 0.9746
 Site-Sketch                        | Val  Loss: 0.1602 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.2009 | Val  Acc: 0.9397
 Site-QuickDraw                     | Val  Loss: 0.7409 | Val  Acc: 0.7524
 Site-QuickDraw                     | Val  Loss: 0.7097 | Val  Acc: 0.7841
 Site-Infograph                     | Val  Loss: 1.0622 | Val  Acc: 0.6762
 Site-Infograph                     | Val  Loss: 0.9677 | Val  Acc: 0.6889
Average Valid Accuracy: 0.8899
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 0.2951 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.1887 | Train Acc: 0.9492
 Site-Real                          | Train Loss: 0.1010 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0418 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2130 | Train Acc: 0.9299
 Site-Painting                      | Train Loss: 0.0970 | Train Acc: 0.9852
 Site-Sketch                        | Train Loss: 0.3743 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.1882 | Train Acc: 0.9428
 Site-QuickDraw                     | Train Loss: 0.7280 | Train Acc: 0.7197
 Site-QuickDraw                     | Train Loss: 0.6899 | Train Acc: 0.8093
 Site-Infograph                     | Train Loss: 1.3254 | Train Acc: 0.5287
 Site-Infograph                     | Train Loss: 0.9679 | Train Acc: 0.6970
Average Train Accuracy: 0.8584
 Site-Clipart                       | Val  Loss: 0.1545 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.2361 | Val  Acc: 0.9365
 Site-Real                          | Val  Loss: 0.0256 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0373 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0766 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1334 | Val  Acc: 0.9683
 Site-Sketch                        | Val  Loss: 0.1223 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.2251 | Val  Acc: 0.9238
 Site-QuickDraw                     | Val  Loss: 0.7239 | Val  Acc: 0.8000
 Site-QuickDraw                     | Val  Loss: 0.7364 | Val  Acc: 0.7651
 Site-Infograph                     | Val  Loss: 1.0215 | Val  Acc: 0.6762
 Site-Infograph                     | Val  Loss: 0.9463 | Val  Acc: 0.7206
Average Valid Accuracy: 0.8942
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.9714
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.9365
 Best site-Real                      | Epoch:42 | Val Acc: 1.0000
 Best site-Real                      | Epoch:42 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:42 | Val Acc: 0.9905
 Best site-Painting                  | Epoch:42 | Val Acc: 0.9683
 Best site-Sketch                    | Epoch:42 | Val Acc: 0.9810
 Best site-Sketch                    | Epoch:42 | Val Acc: 0.9238
 Best site-QuickDraw                 | Epoch:42 | Val Acc: 0.8000
 Best site-QuickDraw                 | Epoch:42 | Val Acc: 0.7651
 Best site-Infograph                 | Epoch:42 | Val Acc: 0.6762
 Best site-Infograph                 | Epoch:42 | Val Acc: 0.7206
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 0.2601 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.1714 | Train Acc: 0.9470
 Site-Real                          | Train Loss: 0.1061 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0466 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.1965 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.1363 | Train Acc: 0.9746
 Site-Sketch                        | Train Loss: 0.3048 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.2227 | Train Acc: 0.9343
 Site-QuickDraw                     | Train Loss: 0.7075 | Train Acc: 0.7197
 Site-QuickDraw                     | Train Loss: 0.7118 | Train Acc: 0.7797
 Site-Infograph                     | Train Loss: 1.3560 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 0.9178 | Train Acc: 0.7119
Average Train Accuracy: 0.8603
 Site-Clipart                       | Val  Loss: 0.1877 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2289 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0245 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0298 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0686 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1355 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.1871 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2099 | Val  Acc: 0.9429
 Site-QuickDraw                     | Val  Loss: 0.7197 | Val  Acc: 0.7810
 Site-QuickDraw                     | Val  Loss: 0.6915 | Val  Acc: 0.7968
 Site-Infograph                     | Val  Loss: 0.9537 | Val  Acc: 0.6857
 Site-Infograph                     | Val  Loss: 0.9593 | Val  Acc: 0.6921
Average Valid Accuracy: 0.8931
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.3003 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.1948 | Train Acc: 0.9449
 Site-Real                          | Train Loss: 0.1255 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0351 | Train Acc: 0.9894
 Site-Painting                      | Train Loss: 0.2342 | Train Acc: 0.9172
 Site-Painting                      | Train Loss: 0.0998 | Train Acc: 0.9831
 Site-Sketch                        | Train Loss: 0.3219 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.1888 | Train Acc: 0.9534
 Site-QuickDraw                     | Train Loss: 0.7843 | Train Acc: 0.7389
 Site-QuickDraw                     | Train Loss: 0.6682 | Train Acc: 0.8114
 Site-Infograph                     | Train Loss: 1.2745 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 0.8864 | Train Acc: 0.7246
Average Train Accuracy: 0.8651
 Site-Clipart                       | Val  Loss: 0.2216 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.2102 | Val  Acc: 0.9556
 Site-Real                          | Val  Loss: 0.0590 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0478 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0736 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1124 | Val  Acc: 0.9746
 Site-Sketch                        | Val  Loss: 0.1598 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.1937 | Val  Acc: 0.9460
 Site-QuickDraw                     | Val  Loss: 0.7077 | Val  Acc: 0.7714
 Site-QuickDraw                     | Val  Loss: 0.7090 | Val  Acc: 0.7841
 Site-Infograph                     | Val  Loss: 0.9374 | Val  Acc: 0.7333
 Site-Infograph                     | Val  Loss: 0.9474 | Val  Acc: 0.7016
Average Valid Accuracy: 0.8947
 Best site-Clipart                   | Epoch:44 | Val Acc: 0.9429
 Best site-Clipart                   | Epoch:44 | Val Acc: 0.9556
 Best site-Real                      | Epoch:44 | Val Acc: 0.9905
 Best site-Real                      | Epoch:44 | Val Acc: 0.9937
 Best site-Painting                  | Epoch:44 | Val Acc: 0.9905
 Best site-Painting                  | Epoch:44 | Val Acc: 0.9746
 Best site-Sketch                    | Epoch:44 | Val Acc: 0.9524
 Best site-Sketch                    | Epoch:44 | Val Acc: 0.9460
 Best site-QuickDraw                 | Epoch:44 | Val Acc: 0.7714
 Best site-QuickDraw                 | Epoch:44 | Val Acc: 0.7841
 Best site-Infograph                 | Epoch:44 | Val Acc: 0.7333
 Best site-Infograph                 | Epoch:44 | Val Acc: 0.7016
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/harmo-fl...
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 0.2030 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.1774 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.1438 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0326 | Train Acc: 0.9979
 Site-Painting                      | Train Loss: 0.2115 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.1199 | Train Acc: 0.9682
 Site-Sketch                        | Train Loss: 0.3208 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.1958 | Train Acc: 0.9407
 Site-QuickDraw                     | Train Loss: 0.7357 | Train Acc: 0.7325
 Site-QuickDraw                     | Train Loss: 0.7071 | Train Acc: 0.7712
 Site-Infograph                     | Train Loss: 1.3422 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 0.9421 | Train Acc: 0.7225
Average Train Accuracy: 0.8625
 Site-Clipart                       | Val  Loss: 0.2201 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.1877 | Val  Acc: 0.9492
 Site-Real                          | Val  Loss: 0.0311 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0466 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0775 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1200 | Val  Acc: 0.9746
 Site-Sketch                        | Val  Loss: 0.1792 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.1944 | Val  Acc: 0.9460
 Site-QuickDraw                     | Val  Loss: 0.7450 | Val  Acc: 0.7810
 Site-QuickDraw                     | Val  Loss: 0.6711 | Val  Acc: 0.7905
 Site-Infograph                     | Val  Loss: 0.9794 | Val  Acc: 0.6952
 Site-Infograph                     | Val  Loss: 0.9429 | Val  Acc: 0.7079
Average Valid Accuracy: 0.8944
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.2993 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.1663 | Train Acc: 0.9555
 Site-Real                          | Train Loss: 0.1236 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0417 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2020 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.1104 | Train Acc: 0.9767
 Site-Sketch                        | Train Loss: 0.3071 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.2006 | Train Acc: 0.9492
 Site-QuickDraw                     | Train Loss: 0.8085 | Train Acc: 0.7261
 Site-QuickDraw                     | Train Loss: 0.7276 | Train Acc: 0.7712
 Site-Infograph                     | Train Loss: 1.2954 | Train Acc: 0.6051
 Site-Infograph                     | Train Loss: 0.9990 | Train Acc: 0.6758
Average Train Accuracy: 0.8632
 Site-Clipart                       | Val  Loss: 0.1897 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2161 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 0.0461 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0431 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0868 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1112 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.1309 | Val  Acc: 0.9905
 Site-Sketch                        | Val  Loss: 0.1897 | Val  Acc: 0.9524
 Site-QuickDraw                     | Val  Loss: 0.7346 | Val  Acc: 0.7714
 Site-QuickDraw                     | Val  Loss: 0.6861 | Val  Acc: 0.7841
 Site-Infograph                     | Val  Loss: 1.0313 | Val  Acc: 0.6381
 Site-Infograph                     | Val  Loss: 0.9795 | Val  Acc: 0.7048
Average Valid Accuracy: 0.8894
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 0.2841 | Train Acc: 0.8790
 Site-Clipart                       | Train Loss: 0.1647 | Train Acc: 0.9492
 Site-Real                          | Train Loss: 0.1143 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0320 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.1925 | Train Acc: 0.9618
 Site-Painting                      | Train Loss: 0.1155 | Train Acc: 0.9703
 Site-Sketch                        | Train Loss: 0.4069 | Train Acc: 0.9172
 Site-Sketch                        | Train Loss: 0.1838 | Train Acc: 0.9555
 Site-QuickDraw                     | Train Loss: 0.7869 | Train Acc: 0.7389
 Site-QuickDraw                     | Train Loss: 0.6884 | Train Acc: 0.7860
 Site-Infograph                     | Train Loss: 1.2502 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 0.9162 | Train Acc: 0.7140
Average Train Accuracy: 0.8658
 Site-Clipart                       | Val  Loss: 0.2045 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2220 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 0.0323 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0455 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0899 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.1119 | Val  Acc: 0.9746
 Site-Sketch                        | Val  Loss: 0.1229 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.1747 | Val  Acc: 0.9492
 Site-QuickDraw                     | Val  Loss: 0.7720 | Val  Acc: 0.7143
 Site-QuickDraw                     | Val  Loss: 0.6815 | Val  Acc: 0.8063
 Site-Infograph                     | Val  Loss: 0.9567 | Val  Acc: 0.6762
 Site-Infograph                     | Val  Loss: 0.9516 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8865
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 0.3025 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.1627 | Train Acc: 0.9492
 Site-Real                          | Train Loss: 0.1226 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.0404 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2250 | Train Acc: 0.9299
 Site-Painting                      | Train Loss: 0.1060 | Train Acc: 0.9788
 Site-Sketch                        | Train Loss: 0.3582 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.1850 | Train Acc: 0.9470
 Site-QuickDraw                     | Train Loss: 0.7157 | Train Acc: 0.6943
 Site-QuickDraw                     | Train Loss: 0.6581 | Train Acc: 0.7818
 Site-Infograph                     | Train Loss: 1.2608 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 0.9235 | Train Acc: 0.7182
Average Train Accuracy: 0.8570
 Site-Clipart                       | Val  Loss: 0.1925 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.2136 | Val  Acc: 0.9397
 Site-Real                          | Val  Loss: 0.0241 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0371 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0509 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1293 | Val  Acc: 0.9683
 Site-Sketch                        | Val  Loss: 0.1572 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.1653 | Val  Acc: 0.9651
 Site-QuickDraw                     | Val  Loss: 0.7079 | Val  Acc: 0.8286
 Site-QuickDraw                     | Val  Loss: 0.6994 | Val  Acc: 0.7714
 Site-Infograph                     | Val  Loss: 1.0005 | Val  Acc: 0.6952
 Site-Infograph                     | Val  Loss: 0.9334 | Val  Acc: 0.6762
Average Valid Accuracy: 0.8937
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.3180 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.1503 | Train Acc: 0.9513
 Site-Real                          | Train Loss: 0.1163 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0347 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.1946 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.1068 | Train Acc: 0.9767
 Site-Sketch                        | Train Loss: 0.2940 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.1782 | Train Acc: 0.9597
 Site-QuickDraw                     | Train Loss: 0.7496 | Train Acc: 0.7006
 Site-QuickDraw                     | Train Loss: 0.6767 | Train Acc: 0.8114
 Site-Infograph                     | Train Loss: 1.3337 | Train Acc: 0.5223
 Site-Infograph                     | Train Loss: 0.9444 | Train Acc: 0.7013
Average Train Accuracy: 0.8593
 Site-Clipart                       | Val  Loss: 0.1483 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2128 | Val  Acc: 0.9397
 Site-Real                          | Val  Loss: 0.0285 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0360 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0709 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1359 | Val  Acc: 0.9746
 Site-Sketch                        | Val  Loss: 0.1496 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.2063 | Val  Acc: 0.9397
 Site-QuickDraw                     | Val  Loss: 0.7890 | Val  Acc: 0.7429
 Site-QuickDraw                     | Val  Loss: 0.6664 | Val  Acc: 0.7905
 Site-Infograph                     | Val  Loss: 1.0377 | Val  Acc: 0.6476
 Site-Infograph                     | Val  Loss: 0.9476 | Val  Acc: 0.7016
Average Valid Accuracy: 0.8865
===2023-07-30 06:23:42===
===2023-07-30 06:23:58===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   | Epoch:44 | Test Acc: 0.9278
 Test site-Real                      | Epoch:44 | Test Acc: 0.9556
 Test site-Painting                  | Epoch:44 | Test Acc: 0.9225
 Test site-Sketch                    | Epoch:44 | Test Acc: 0.8971
 Test site-QuickDraw                 | Epoch:44 | Test Acc: 0.7310
 Test site-Infograph                 | Epoch:44 | Test Acc: 0.5540
Clipart: 0.9278, Real: 0.9556, Painting: 0.9225, Sketch: 0.8971, QuickDraw: 0.7310, Infograph: 0.5540, 
Average Test Accuracy(group): 0.8313, Average Test Accuracy(individual): 0.8313,
domain std=0.1440, cluster std=-1.0000, individual std=0.1440, 
