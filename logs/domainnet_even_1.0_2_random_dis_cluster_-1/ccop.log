===2023-07-30 10:25:02===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (2) | Train Loss: 2.1273 | Train Acc: 0.3503
 Site-Clipart                   (2) | Train Loss: 2.1116 | Train Acc: 0.3326
 Site-Real                      (1) | Train Loss: 1.9981 | Train Acc: 0.4968
 Site-Real                      (1) | Train Loss: 2.0112 | Train Acc: 0.4873
 Site-Painting                  (5) | Train Loss: 2.0893 | Train Acc: 0.3822
 Site-Painting                  (5) | Train Loss: 2.0777 | Train Acc: 0.4301
 Site-Sketch                    (4) | Train Loss: 2.1248 | Train Acc: 0.3503
 Site-Sketch                    (4) | Train Loss: 2.1204 | Train Acc: 0.3581
 Site-QuickDraw                 (0) | Train Loss: 2.2725 | Train Acc: 0.2038
 Site-QuickDraw                 (0) | Train Loss: 2.2734 | Train Acc: 0.1462
 Site-Infograph                 (3) | Train Loss: 2.2584 | Train Acc: 0.1911
 Site-Infograph                 (3) | Train Loss: 2.1984 | Train Acc: 0.2203
Average Train Accuracy: 0.3291
 Site-Clipart                   (2) | Val  Loss: 2.0913 | Val  Acc: 0.3619
 Site-Clipart                   (2) | Val  Loss: 2.0931 | Val  Acc: 0.3365
 Site-Real                      (1) | Val  Loss: 1.9958 | Val  Acc: 0.5238
 Site-Real                      (1) | Val  Loss: 2.0133 | Val  Acc: 0.5079
 Site-Painting                  (5) | Val  Loss: 2.0183 | Val  Acc: 0.5524
 Site-Painting                  (5) | Val  Loss: 2.0802 | Val  Acc: 0.4190
 Site-Sketch                    (4) | Val  Loss: 2.1165 | Val  Acc: 0.3810
 Site-Sketch                    (4) | Val  Loss: 2.1112 | Val  Acc: 0.3587
 Site-QuickDraw                 (0) | Val  Loss: 2.2485 | Val  Acc: 0.0952
 Site-QuickDraw                 (0) | Val  Loss: 2.2589 | Val  Acc: 0.1651
 Site-Infograph                 (3) | Val  Loss: 2.2516 | Val  Acc: 0.1905
 Site-Infograph                 (3) | Val  Loss: 2.2067 | Val  Acc: 0.2286
Average Valid Accuracy: 0.3434
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.3619
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.3365
 Best site-Real                     (1)  | Epoch:0 | Val Acc: 0.5238
 Best site-Real                     (1)  | Epoch:0 | Val Acc: 0.5079
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.5524
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4190
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3810
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3587
 Best site-QuickDraw                (0)  | Epoch:0 | Val Acc: 0.0952
 Best site-QuickDraw                (0)  | Epoch:0 | Val Acc: 0.1651
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.1905
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2286
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (5) | Train Loss: 1.8781 | Train Acc: 0.4777
 Site-Clipart                   (5) | Train Loss: 1.8663 | Train Acc: 0.4831
 Site-Real                      (0) | Train Loss: 1.6390 | Train Acc: 0.6879
 Site-Real                      (0) | Train Loss: 1.6508 | Train Acc: 0.7055
 Site-Painting                  (4) | Train Loss: 1.8168 | Train Acc: 0.5605
 Site-Painting                  (4) | Train Loss: 1.7551 | Train Acc: 0.5742
 Site-Sketch                    (2) | Train Loss: 1.8692 | Train Acc: 0.4586
 Site-Sketch                    (2) | Train Loss: 1.8404 | Train Acc: 0.4746
 Site-QuickDraw                 (1) | Train Loss: 2.1355 | Train Acc: 0.2866
 Site-QuickDraw                 (1) | Train Loss: 2.1840 | Train Acc: 0.2076
 Site-Infograph                 (3) | Train Loss: 2.1604 | Train Acc: 0.2803
 Site-Infograph                 (3) | Train Loss: 2.1029 | Train Acc: 0.2987
Average Train Accuracy: 0.4579
 Site-Clipart                   (5) | Val  Loss: 1.8973 | Val  Acc: 0.4857
 Site-Clipart                   (5) | Val  Loss: 1.8806 | Val  Acc: 0.5206
 Site-Real                      (0) | Val  Loss: 1.6624 | Val  Acc: 0.6286
 Site-Real                      (0) | Val  Loss: 1.6608 | Val  Acc: 0.6952
 Site-Painting                  (4) | Val  Loss: 1.6779 | Val  Acc: 0.6571
 Site-Painting                  (4) | Val  Loss: 1.7536 | Val  Acc: 0.6032
 Site-Sketch                    (2) | Val  Loss: 1.8541 | Val  Acc: 0.5238
 Site-Sketch                    (2) | Val  Loss: 1.8387 | Val  Acc: 0.5365
 Site-QuickDraw                 (1) | Val  Loss: 2.1457 | Val  Acc: 0.2952
 Site-QuickDraw                 (1) | Val  Loss: 2.1696 | Val  Acc: 0.2349
 Site-Infograph                 (3) | Val  Loss: 2.1603 | Val  Acc: 0.2952
 Site-Infograph                 (3) | Val  Loss: 2.1059 | Val  Acc: 0.3111
Average Valid Accuracy: 0.4823
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.4857
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.5206
 Best site-Real                     (0)  | Epoch:1 | Val Acc: 0.6286
 Best site-Real                     (0)  | Epoch:1 | Val Acc: 0.6952
 Best site-Painting                 (4)  | Epoch:1 | Val Acc: 0.6571
 Best site-Painting                 (4)  | Epoch:1 | Val Acc: 0.6032
 Best site-Sketch                   (2)  | Epoch:1 | Val Acc: 0.5238
 Best site-Sketch                   (2)  | Epoch:1 | Val Acc: 0.5365
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.2952
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.2349
 Best site-Infograph                (3)  | Epoch:1 | Val Acc: 0.2952
 Best site-Infograph                (3)  | Epoch:1 | Val Acc: 0.3111
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (5) | Train Loss: 1.6319 | Train Acc: 0.6051
 Site-Clipart                   (5) | Train Loss: 1.5762 | Train Acc: 0.6335
 Site-Real                      (2) | Train Loss: 1.3353 | Train Acc: 0.7962
 Site-Real                      (2) | Train Loss: 1.2756 | Train Acc: 0.8072
 Site-Painting                  (4) | Train Loss: 1.5010 | Train Acc: 0.6624
 Site-Painting                  (4) | Train Loss: 1.4290 | Train Acc: 0.7055
 Site-Sketch                    (3) | Train Loss: 1.5549 | Train Acc: 0.5796
 Site-Sketch                    (3) | Train Loss: 1.5415 | Train Acc: 0.6081
 Site-QuickDraw                 (1) | Train Loss: 2.0834 | Train Acc: 0.3694
 Site-QuickDraw                 (1) | Train Loss: 2.0829 | Train Acc: 0.3708
 Site-Infograph                 (0) | Train Loss: 2.0053 | Train Acc: 0.3567
 Site-Infograph                 (0) | Train Loss: 1.9484 | Train Acc: 0.4068
Average Train Accuracy: 0.5751
 Site-Clipart                   (5) | Val  Loss: 1.6196 | Val  Acc: 0.6571
 Site-Clipart                   (5) | Val  Loss: 1.5788 | Val  Acc: 0.6190
 Site-Real                      (2) | Val  Loss: 1.2629 | Val  Acc: 0.7714
 Site-Real                      (2) | Val  Loss: 1.2763 | Val  Acc: 0.8190
 Site-Painting                  (4) | Val  Loss: 1.3382 | Val  Acc: 0.8000
 Site-Painting                  (4) | Val  Loss: 1.4293 | Val  Acc: 0.7079
 Site-Sketch                    (3) | Val  Loss: 1.5735 | Val  Acc: 0.5714
 Site-Sketch                    (3) | Val  Loss: 1.5380 | Val  Acc: 0.6159
 Site-QuickDraw                 (1) | Val  Loss: 2.0619 | Val  Acc: 0.3333
 Site-QuickDraw                 (1) | Val  Loss: 2.0713 | Val  Acc: 0.3651
 Site-Infograph                 (0) | Val  Loss: 2.0553 | Val  Acc: 0.3143
 Site-Infograph                 (0) | Val  Loss: 1.9611 | Val  Acc: 0.3968
Average Valid Accuracy: 0.5810
 Best site-Clipart                  (5)  | Epoch:2 | Val Acc: 0.6571
 Best site-Clipart                  (5)  | Epoch:2 | Val Acc: 0.6190
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7714
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.8190
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.8000
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.7079
 Best site-Sketch                   (3)  | Epoch:2 | Val Acc: 0.5714
 Best site-Sketch                   (3)  | Epoch:2 | Val Acc: 0.6159
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.3333
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.3651
 Best site-Infograph                (0)  | Epoch:2 | Val Acc: 0.3143
 Best site-Infograph                (0)  | Epoch:2 | Val Acc: 0.3968
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (5) | Train Loss: 1.3753 | Train Acc: 0.6369
 Site-Clipart                   (5) | Train Loss: 1.3425 | Train Acc: 0.6970
 Site-Real                      (2) | Train Loss: 1.0686 | Train Acc: 0.8471
 Site-Real                      (2) | Train Loss: 1.0066 | Train Acc: 0.8559
 Site-Painting                  (4) | Train Loss: 1.2373 | Train Acc: 0.7643
 Site-Painting                  (4) | Train Loss: 1.1822 | Train Acc: 0.7818
 Site-Sketch                    (3) | Train Loss: 1.3208 | Train Acc: 0.7006
 Site-Sketch                    (3) | Train Loss: 1.2754 | Train Acc: 0.6801
 Site-QuickDraw                 (0) | Train Loss: 1.9813 | Train Acc: 0.3631
 Site-QuickDraw                 (0) | Train Loss: 1.9928 | Train Acc: 0.3453
 Site-Infograph                 (1) | Train Loss: 1.8891 | Train Acc: 0.4459
 Site-Infograph                 (1) | Train Loss: 1.7711 | Train Acc: 0.4619
Average Train Accuracy: 0.6317
 Site-Clipart                   (5) | Val  Loss: 1.3664 | Val  Acc: 0.7048
 Site-Clipart                   (5) | Val  Loss: 1.3334 | Val  Acc: 0.7175
 Site-Real                      (2) | Val  Loss: 1.0652 | Val  Acc: 0.8381
 Site-Real                      (2) | Val  Loss: 1.0325 | Val  Acc: 0.8603
 Site-Painting                  (4) | Val  Loss: 1.0677 | Val  Acc: 0.8381
 Site-Painting                  (4) | Val  Loss: 1.1582 | Val  Acc: 0.7968
 Site-Sketch                    (3) | Val  Loss: 1.2717 | Val  Acc: 0.6952
 Site-Sketch                    (3) | Val  Loss: 1.3090 | Val  Acc: 0.6571
 Site-QuickDraw                 (0) | Val  Loss: 1.9533 | Val  Acc: 0.3619
 Site-QuickDraw                 (0) | Val  Loss: 1.9834 | Val  Acc: 0.3619
 Site-Infograph                 (1) | Val  Loss: 1.8474 | Val  Acc: 0.4095
 Site-Infograph                 (1) | Val  Loss: 1.8272 | Val  Acc: 0.4286
Average Valid Accuracy: 0.6392
 Best site-Clipart                  (5)  | Epoch:3 | Val Acc: 0.7048
 Best site-Clipart                  (5)  | Epoch:3 | Val Acc: 0.7175
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8381
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8603
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.8381
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.7968
 Best site-Sketch                   (3)  | Epoch:3 | Val Acc: 0.6952
 Best site-Sketch                   (3)  | Epoch:3 | Val Acc: 0.6571
 Best site-QuickDraw                (0)  | Epoch:3 | Val Acc: 0.3619
 Best site-QuickDraw                (0)  | Epoch:3 | Val Acc: 0.3619
 Best site-Infograph                (1)  | Epoch:3 | Val Acc: 0.4095
 Best site-Infograph                (1)  | Epoch:3 | Val Acc: 0.4286
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (2) | Train Loss: 1.1977 | Train Acc: 0.7325
 Site-Clipart                   (2) | Train Loss: 1.1087 | Train Acc: 0.7500
 Site-Real                      (0) | Train Loss: 0.9270 | Train Acc: 0.8790
 Site-Real                      (0) | Train Loss: 0.8271 | Train Acc: 0.9047
 Site-Painting                  (5) | Train Loss: 1.0338 | Train Acc: 0.7834
 Site-Painting                  (5) | Train Loss: 0.9840 | Train Acc: 0.8136
 Site-Sketch                    (4) | Train Loss: 1.0416 | Train Acc: 0.7898
 Site-Sketch                    (4) | Train Loss: 1.1130 | Train Acc: 0.7161
 Site-QuickDraw                 (1) | Train Loss: 1.7917 | Train Acc: 0.4204
 Site-QuickDraw                 (1) | Train Loss: 1.8398 | Train Acc: 0.4237
 Site-Infograph                 (3) | Train Loss: 1.7276 | Train Acc: 0.4650
 Site-Infograph                 (3) | Train Loss: 1.6245 | Train Acc: 0.5127
Average Train Accuracy: 0.6826
 Site-Clipart                   (2) | Val  Loss: 1.1727 | Val  Acc: 0.7714
 Site-Clipart                   (2) | Val  Loss: 1.1401 | Val  Acc: 0.7524
 Site-Real                      (0) | Val  Loss: 0.8865 | Val  Acc: 0.8571
 Site-Real                      (0) | Val  Loss: 0.8469 | Val  Acc: 0.8984
 Site-Painting                  (5) | Val  Loss: 0.8661 | Val  Acc: 0.8762
 Site-Painting                  (5) | Val  Loss: 0.9560 | Val  Acc: 0.8444
 Site-Sketch                    (4) | Val  Loss: 1.1133 | Val  Acc: 0.7429
 Site-Sketch                    (4) | Val  Loss: 1.0982 | Val  Acc: 0.6889
 Site-QuickDraw                 (1) | Val  Loss: 1.8434 | Val  Acc: 0.3810
 Site-QuickDraw                 (1) | Val  Loss: 1.8156 | Val  Acc: 0.4444
 Site-Infograph                 (3) | Val  Loss: 1.6551 | Val  Acc: 0.5333
 Site-Infograph                 (3) | Val  Loss: 1.6651 | Val  Acc: 0.4698
Average Valid Accuracy: 0.6884
 Best site-Clipart                  (2)  | Epoch:4 | Val Acc: 0.7714
 Best site-Clipart                  (2)  | Epoch:4 | Val Acc: 0.7524
 Best site-Real                     (0)  | Epoch:4 | Val Acc: 0.8571
 Best site-Real                     (0)  | Epoch:4 | Val Acc: 0.8984
 Best site-Painting                 (5)  | Epoch:4 | Val Acc: 0.8762
 Best site-Painting                 (5)  | Epoch:4 | Val Acc: 0.8444
 Best site-Sketch                   (4)  | Epoch:4 | Val Acc: 0.7429
 Best site-Sketch                   (4)  | Epoch:4 | Val Acc: 0.6889
 Best site-QuickDraw                (1)  | Epoch:4 | Val Acc: 0.3810
 Best site-QuickDraw                (1)  | Epoch:4 | Val Acc: 0.4444
 Best site-Infograph                (3)  | Epoch:4 | Val Acc: 0.5333
 Best site-Infograph                (3)  | Epoch:4 | Val Acc: 0.4698
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (2) | Train Loss: 1.0206 | Train Acc: 0.7325
 Site-Clipart                   (2) | Train Loss: 0.9628 | Train Acc: 0.8030
 Site-Real                      (4) | Train Loss: 0.8115 | Train Acc: 0.8854
 Site-Real                      (4) | Train Loss: 0.6823 | Train Acc: 0.9153
 Site-Painting                  (0) | Train Loss: 0.9214 | Train Acc: 0.8408
 Site-Painting                  (0) | Train Loss: 0.8627 | Train Acc: 0.8432
 Site-Sketch                    (3) | Train Loss: 0.9073 | Train Acc: 0.7962
 Site-Sketch                    (3) | Train Loss: 0.9754 | Train Acc: 0.7691
 Site-QuickDraw                 (1) | Train Loss: 1.6542 | Train Acc: 0.5287
 Site-QuickDraw                 (1) | Train Loss: 1.6571 | Train Acc: 0.5212
 Site-Infograph                 (5) | Train Loss: 1.7134 | Train Acc: 0.4968
 Site-Infograph                 (5) | Train Loss: 1.5475 | Train Acc: 0.5233
Average Train Accuracy: 0.7213
 Site-Clipart                   (2) | Val  Loss: 0.9558 | Val  Acc: 0.8381
 Site-Clipart                   (2) | Val  Loss: 0.9971 | Val  Acc: 0.7714
 Site-Real                      (4) | Val  Loss: 0.7726 | Val  Acc: 0.9048
 Site-Real                      (4) | Val  Loss: 0.7282 | Val  Acc: 0.9111
 Site-Painting                  (0) | Val  Loss: 0.7680 | Val  Acc: 0.8667
 Site-Painting                  (0) | Val  Loss: 0.8645 | Val  Acc: 0.8381
 Site-Sketch                    (3) | Val  Loss: 0.9896 | Val  Acc: 0.7524
 Site-Sketch                    (3) | Val  Loss: 0.9547 | Val  Acc: 0.7619
 Site-QuickDraw                 (1) | Val  Loss: 1.6475 | Val  Acc: 0.4857
 Site-QuickDraw                 (1) | Val  Loss: 1.6532 | Val  Acc: 0.5048
 Site-Infograph                 (5) | Val  Loss: 1.6679 | Val  Acc: 0.5048
 Site-Infograph                 (5) | Val  Loss: 1.6064 | Val  Acc: 0.4984
Average Valid Accuracy: 0.7198
 Best site-Clipart                  (2)  | Epoch:5 | Val Acc: 0.8381
 Best site-Clipart                  (2)  | Epoch:5 | Val Acc: 0.7714
 Best site-Real                     (4)  | Epoch:5 | Val Acc: 0.9048
 Best site-Real                     (4)  | Epoch:5 | Val Acc: 0.9111
 Best site-Painting                 (0)  | Epoch:5 | Val Acc: 0.8667
 Best site-Painting                 (0)  | Epoch:5 | Val Acc: 0.8381
 Best site-Sketch                   (3)  | Epoch:5 | Val Acc: 0.7524
 Best site-Sketch                   (3)  | Epoch:5 | Val Acc: 0.7619
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.4857
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.5048
 Best site-Infograph                (5)  | Epoch:5 | Val Acc: 0.5048
 Best site-Infograph                (5)  | Epoch:5 | Val Acc: 0.4984
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 6 ============
cnt=[3, 2, 2, 1, 3, 1, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (2) | Train Loss: 0.9237 | Train Acc: 0.7389
 Site-Clipart                   (2) | Train Loss: 0.8890 | Train Acc: 0.7775
 Site-Real                      (0) | Train Loss: 0.6986 | Train Acc: 0.8854
 Site-Real                      (0) | Train Loss: 0.5907 | Train Acc: 0.9258
 Site-Painting                  (4) | Train Loss: 0.8093 | Train Acc: 0.8344
 Site-Painting                  (0) | Train Loss: 0.7574 | Train Acc: 0.8517
 Site-Sketch                    (3) | Train Loss: 0.8143 | Train Acc: 0.8025
 Site-Sketch                    (5) | Train Loss: 0.8793 | Train Acc: 0.7691
 Site-QuickDraw                 (1) | Train Loss: 1.5506 | Train Acc: 0.5732
 Site-QuickDraw                 (1) | Train Loss: 1.5903 | Train Acc: 0.5593
 Site-Infograph                 (4) | Train Loss: 1.6176 | Train Acc: 0.5096
 Site-Infograph                 (4) | Train Loss: 1.4593 | Train Acc: 0.5466
Average Train Accuracy: 0.7312
 Site-Clipart                   (2) | Val  Loss: 0.9571 | Val  Acc: 0.7810
 Site-Clipart                   (2) | Val  Loss: 0.9125 | Val  Acc: 0.7937
 Site-Real                      (0) | Val  Loss: 0.6657 | Val  Acc: 0.8952
 Site-Real                      (0) | Val  Loss: 0.6099 | Val  Acc: 0.9048
 Site-Painting                  (4) | Val  Loss: 0.6272 | Val  Acc: 0.9048
 Site-Painting                  (0) | Val  Loss: 0.7425 | Val  Acc: 0.8444
 Site-Sketch                    (3) | Val  Loss: 0.9016 | Val  Acc: 0.7524
 Site-Sketch                    (5) | Val  Loss: 0.8624 | Val  Acc: 0.7651
 Site-QuickDraw                 (1) | Val  Loss: 1.6448 | Val  Acc: 0.5238
 Site-QuickDraw                 (1) | Val  Loss: 1.5675 | Val  Acc: 0.5651
 Site-Infograph                 (4) | Val  Loss: 1.5599 | Val  Acc: 0.5524
 Site-Infograph                 (4) | Val  Loss: 1.4964 | Val  Acc: 0.5302
Average Valid Accuracy: 0.7344
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.7810
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.7937
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8952
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.9048
 Best site-Painting                 (4)  | Epoch:6 | Val Acc: 0.9048
 Best site-Painting                 (0)  | Epoch:6 | Val Acc: 0.8444
 Best site-Sketch                   (3)  | Epoch:6 | Val Acc: 0.7524
 Best site-Sketch                   (5)  | Epoch:6 | Val Acc: 0.7651
 Best site-QuickDraw                (1)  | Epoch:6 | Val Acc: 0.5238
 Best site-QuickDraw                (1)  | Epoch:6 | Val Acc: 0.5651
 Best site-Infograph                (4)  | Epoch:6 | Val Acc: 0.5524
 Best site-Infograph                (4)  | Epoch:6 | Val Acc: 0.5302
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 2, 3, 1, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (5) | Train Loss: 0.8355 | Train Acc: 0.7452
 Site-Clipart                   (5) | Train Loss: 0.7697 | Train Acc: 0.8178
 Site-Real                      (3) | Train Loss: 0.6473 | Train Acc: 0.9045
 Site-Real                      (2) | Train Loss: 0.5449 | Train Acc: 0.9301
 Site-Painting                  (2) | Train Loss: 0.7794 | Train Acc: 0.8153
 Site-Painting                  (2) | Train Loss: 0.7176 | Train Acc: 0.8496
 Site-Sketch                    (4) | Train Loss: 0.7801 | Train Acc: 0.8599
 Site-Sketch                    (4) | Train Loss: 0.7887 | Train Acc: 0.7924
 Site-QuickDraw                 (1) | Train Loss: 1.4396 | Train Acc: 0.6115
 Site-QuickDraw                 (1) | Train Loss: 1.4445 | Train Acc: 0.5890
 Site-Infograph                 (0) | Train Loss: 1.5542 | Train Acc: 0.5287
 Site-Infograph                 (0) | Train Loss: 1.4228 | Train Acc: 0.5763
Average Train Accuracy: 0.7517
 Site-Clipart                   (5) | Val  Loss: 0.8307 | Val  Acc: 0.8095
 Site-Clipart                   (5) | Val  Loss: 0.8226 | Val  Acc: 0.8127
 Site-Real                      (3) | Val  Loss: 0.6118 | Val  Acc: 0.9143
 Site-Real                      (2) | Val  Loss: 0.5638 | Val  Acc: 0.9238
 Site-Painting                  (2) | Val  Loss: 0.5979 | Val  Acc: 0.8667
 Site-Painting                  (2) | Val  Loss: 0.6894 | Val  Acc: 0.8571
 Site-Sketch                    (4) | Val  Loss: 0.7808 | Val  Acc: 0.7714
 Site-Sketch                    (4) | Val  Loss: 0.7918 | Val  Acc: 0.8127
 Site-QuickDraw                 (1) | Val  Loss: 1.4724 | Val  Acc: 0.5619
 Site-QuickDraw                 (1) | Val  Loss: 1.4369 | Val  Acc: 0.5810
 Site-Infograph                 (0) | Val  Loss: 1.5424 | Val  Acc: 0.4952
 Site-Infograph                 (0) | Val  Loss: 1.4940 | Val  Acc: 0.5270
Average Valid Accuracy: 0.7444
 Best site-Clipart                  (5)  | Epoch:7 | Val Acc: 0.8095
 Best site-Clipart                  (5)  | Epoch:7 | Val Acc: 0.8127
 Best site-Real                     (3)  | Epoch:7 | Val Acc: 0.9143
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.9238
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8667
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8571
 Best site-Sketch                   (4)  | Epoch:7 | Val Acc: 0.7714
 Best site-Sketch                   (4)  | Epoch:7 | Val Acc: 0.8127
 Best site-QuickDraw                (1)  | Epoch:7 | Val Acc: 0.5619
 Best site-QuickDraw                (1)  | Epoch:7 | Val Acc: 0.5810
 Best site-Infograph                (0)  | Epoch:7 | Val Acc: 0.4952
 Best site-Infograph                (0)  | Epoch:7 | Val Acc: 0.5270
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 2, 3, 2, 1, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (2) | Train Loss: 0.7785 | Train Acc: 0.7962
 Site-Clipart                   (2) | Train Loss: 0.7581 | Train Acc: 0.8326
 Site-Real                      (0) | Train Loss: 0.5846 | Train Acc: 0.8917
 Site-Real                      (0) | Train Loss: 0.4887 | Train Acc: 0.9237
 Site-Painting                  (3) | Train Loss: 0.7702 | Train Acc: 0.8153
 Site-Painting                  (3) | Train Loss: 0.6435 | Train Acc: 0.8581
 Site-Sketch                    (2) | Train Loss: 0.6965 | Train Acc: 0.8280
 Site-Sketch                    (4) | Train Loss: 0.7855 | Train Acc: 0.7754
 Site-QuickDraw                 (1) | Train Loss: 1.3458 | Train Acc: 0.6242
 Site-QuickDraw                 (1) | Train Loss: 1.3453 | Train Acc: 0.6081
 Site-Infograph                 (5) | Train Loss: 1.4480 | Train Acc: 0.5223
 Site-Infograph                 (5) | Train Loss: 1.3715 | Train Acc: 0.5847
Average Train Accuracy: 0.7550
 Site-Clipart                   (2) | Val  Loss: 0.7428 | Val  Acc: 0.8095
 Site-Clipart                   (2) | Val  Loss: 0.7743 | Val  Acc: 0.8095
 Site-Real                      (0) | Val  Loss: 0.5753 | Val  Acc: 0.8762
 Site-Real                      (0) | Val  Loss: 0.5102 | Val  Acc: 0.9111
 Site-Painting                  (3) | Val  Loss: 0.5735 | Val  Acc: 0.8667
 Site-Painting                  (3) | Val  Loss: 0.6511 | Val  Acc: 0.8794
 Site-Sketch                    (2) | Val  Loss: 0.7811 | Val  Acc: 0.7905
 Site-Sketch                    (4) | Val  Loss: 0.7554 | Val  Acc: 0.7778
 Site-QuickDraw                 (1) | Val  Loss: 1.3778 | Val  Acc: 0.6000
 Site-QuickDraw                 (1) | Val  Loss: 1.3580 | Val  Acc: 0.6222
 Site-Infograph                 (5) | Val  Loss: 1.4778 | Val  Acc: 0.4952
 Site-Infograph                 (5) | Val  Loss: 1.4209 | Val  Acc: 0.5714
Average Valid Accuracy: 0.7508
 Best site-Clipart                  (2)  | Epoch:8 | Val Acc: 0.8095
 Best site-Clipart                  (2)  | Epoch:8 | Val Acc: 0.8095
 Best site-Real                     (0)  | Epoch:8 | Val Acc: 0.8762
 Best site-Real                     (0)  | Epoch:8 | Val Acc: 0.9111
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8667
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8794
 Best site-Sketch                   (2)  | Epoch:8 | Val Acc: 0.7905
 Best site-Sketch                   (4)  | Epoch:8 | Val Acc: 0.7778
 Best site-QuickDraw                (1)  | Epoch:8 | Val Acc: 0.6000
 Best site-QuickDraw                (1)  | Epoch:8 | Val Acc: 0.6222
 Best site-Infograph                (5)  | Epoch:8 | Val Acc: 0.4952
 Best site-Infograph                (5)  | Epoch:8 | Val Acc: 0.5714
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (3) | Train Loss: 0.8117 | Train Acc: 0.8025
 Site-Clipart                   (3) | Train Loss: 0.7223 | Train Acc: 0.8305
 Site-Real                      (4) | Train Loss: 0.5297 | Train Acc: 0.8981
 Site-Real                      (4) | Train Loss: 0.4421 | Train Acc: 0.9343
 Site-Painting                  (2) | Train Loss: 0.6577 | Train Acc: 0.8599
 Site-Painting                  (2) | Train Loss: 0.6365 | Train Acc: 0.8432
 Site-Sketch                    (0) | Train Loss: 0.6872 | Train Acc: 0.8408
 Site-Sketch                    (0) | Train Loss: 0.7396 | Train Acc: 0.8030
 Site-QuickDraw                 (1) | Train Loss: 1.2682 | Train Acc: 0.6688
 Site-QuickDraw                 (1) | Train Loss: 1.3016 | Train Acc: 0.6419
 Site-Infograph                 (5) | Train Loss: 1.5226 | Train Acc: 0.5478
 Site-Infograph                 (5) | Train Loss: 1.2951 | Train Acc: 0.5890
Average Train Accuracy: 0.7716
 Site-Clipart                   (3) | Val  Loss: 0.7241 | Val  Acc: 0.8095
 Site-Clipart                   (3) | Val  Loss: 0.7577 | Val  Acc: 0.7873
 Site-Real                      (4) | Val  Loss: 0.5089 | Val  Acc: 0.8952
 Site-Real                      (4) | Val  Loss: 0.4772 | Val  Acc: 0.9333
 Site-Painting                  (2) | Val  Loss: 0.4978 | Val  Acc: 0.9048
 Site-Painting                  (2) | Val  Loss: 0.6018 | Val  Acc: 0.8635
 Site-Sketch                    (0) | Val  Loss: 0.7140 | Val  Acc: 0.8286
 Site-Sketch                    (0) | Val  Loss: 0.7259 | Val  Acc: 0.7873
 Site-QuickDraw                 (1) | Val  Loss: 1.3155 | Val  Acc: 0.6571
 Site-QuickDraw                 (1) | Val  Loss: 1.2953 | Val  Acc: 0.6349
 Site-Infograph                 (5) | Val  Loss: 1.4415 | Val  Acc: 0.5810
 Site-Infograph                 (5) | Val  Loss: 1.3682 | Val  Acc: 0.5556
Average Valid Accuracy: 0.7698
 Best site-Clipart                  (3)  | Epoch:9 | Val Acc: 0.8095
 Best site-Clipart                  (3)  | Epoch:9 | Val Acc: 0.7873
 Best site-Real                     (4)  | Epoch:9 | Val Acc: 0.8952
 Best site-Real                     (4)  | Epoch:9 | Val Acc: 0.9333
 Best site-Painting                 (2)  | Epoch:9 | Val Acc: 0.9048
 Best site-Painting                 (2)  | Epoch:9 | Val Acc: 0.8635
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.8286
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.7873
 Best site-QuickDraw                (1)  | Epoch:9 | Val Acc: 0.6571
 Best site-QuickDraw                (1)  | Epoch:9 | Val Acc: 0.6349
 Best site-Infograph                (5)  | Epoch:9 | Val Acc: 0.5810
 Best site-Infograph                (5)  | Epoch:9 | Val Acc: 0.5556
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 10 ============
cnt=[2, 2, 2, 3, 2, 1, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (3) | Train Loss: 0.6738 | Train Acc: 0.8089
 Site-Clipart                   (3) | Train Loss: 0.6677 | Train Acc: 0.8284
 Site-Real                      (2) | Train Loss: 0.5001 | Train Acc: 0.9108
 Site-Real                      (2) | Train Loss: 0.4056 | Train Acc: 0.9343
 Site-Painting                  (4) | Train Loss: 0.6273 | Train Acc: 0.8344
 Site-Painting                  (4) | Train Loss: 0.5933 | Train Acc: 0.8686
 Site-Sketch                    (5) | Train Loss: 0.6733 | Train Acc: 0.8217
 Site-Sketch                    (3) | Train Loss: 0.6988 | Train Acc: 0.8030
 Site-QuickDraw                 (0) | Train Loss: 1.2718 | Train Acc: 0.6752
 Site-QuickDraw                 (0) | Train Loss: 1.2458 | Train Acc: 0.6419
 Site-Infograph                 (1) | Train Loss: 1.4073 | Train Acc: 0.5860
 Site-Infograph                 (1) | Train Loss: 1.2454 | Train Acc: 0.5996
Average Train Accuracy: 0.7761
 Site-Clipart                   (3) | Val  Loss: 0.6530 | Val  Acc: 0.8476
 Site-Clipart                   (3) | Val  Loss: 0.7299 | Val  Acc: 0.8063
 Site-Real                      (2) | Val  Loss: 0.4979 | Val  Acc: 0.9048
 Site-Real                      (2) | Val  Loss: 0.4456 | Val  Acc: 0.9270
 Site-Painting                  (4) | Val  Loss: 0.5204 | Val  Acc: 0.8762
 Site-Painting                  (4) | Val  Loss: 0.5670 | Val  Acc: 0.8603
 Site-Sketch                    (5) | Val  Loss: 0.6912 | Val  Acc: 0.8095
 Site-Sketch                    (3) | Val  Loss: 0.6900 | Val  Acc: 0.8000
 Site-QuickDraw                 (0) | Val  Loss: 1.2279 | Val  Acc: 0.6190
 Site-QuickDraw                 (0) | Val  Loss: 1.2379 | Val  Acc: 0.6349
 Site-Infograph                 (1) | Val  Loss: 1.3505 | Val  Acc: 0.6190
 Site-Infograph                 (1) | Val  Loss: 1.3338 | Val  Acc: 0.5651
Average Valid Accuracy: 0.7725
 Best site-Clipart                  (3)  | Epoch:10 | Val Acc: 0.8476
 Best site-Clipart                  (3)  | Epoch:10 | Val Acc: 0.8063
 Best site-Real                     (2)  | Epoch:10 | Val Acc: 0.9048
 Best site-Real                     (2)  | Epoch:10 | Val Acc: 0.9270
 Best site-Painting                 (4)  | Epoch:10 | Val Acc: 0.8762
 Best site-Painting                 (4)  | Epoch:10 | Val Acc: 0.8603
 Best site-Sketch                   (5)  | Epoch:10 | Val Acc: 0.8095
 Best site-Sketch                   (3)  | Epoch:10 | Val Acc: 0.8000
 Best site-QuickDraw                (0)  | Epoch:10 | Val Acc: 0.6190
 Best site-QuickDraw                (0)  | Epoch:10 | Val Acc: 0.6349
 Best site-Infograph                (1)  | Epoch:10 | Val Acc: 0.6190
 Best site-Infograph                (1)  | Epoch:10 | Val Acc: 0.5651
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (4) | Train Loss: 0.7064 | Train Acc: 0.8153
 Site-Clipart                   (4) | Train Loss: 0.6458 | Train Acc: 0.8369
 Site-Real                      (3) | Train Loss: 0.4622 | Train Acc: 0.9236
 Site-Real                      (3) | Train Loss: 0.4102 | Train Acc: 0.9322
 Site-Painting                  (2) | Train Loss: 0.5980 | Train Acc: 0.8599
 Site-Painting                  (2) | Train Loss: 0.5385 | Train Acc: 0.8644
 Site-Sketch                    (0) | Train Loss: 0.5796 | Train Acc: 0.8662
 Site-Sketch                    (0) | Train Loss: 0.7000 | Train Acc: 0.8178
 Site-QuickDraw                 (1) | Train Loss: 1.1184 | Train Acc: 0.6624
 Site-QuickDraw                 (1) | Train Loss: 1.1652 | Train Acc: 0.6568
 Site-Infograph                 (5) | Train Loss: 1.3658 | Train Acc: 0.5796
 Site-Infograph                 (5) | Train Loss: 1.2638 | Train Acc: 0.5996
Average Train Accuracy: 0.7846
 Site-Clipart                   (4) | Val  Loss: 0.6702 | Val  Acc: 0.8190
 Site-Clipart                   (4) | Val  Loss: 0.6940 | Val  Acc: 0.8222
 Site-Real                      (3) | Val  Loss: 0.4798 | Val  Acc: 0.9143
 Site-Real                      (3) | Val  Loss: 0.4107 | Val  Acc: 0.9302
 Site-Painting                  (2) | Val  Loss: 0.4368 | Val  Acc: 0.9143
 Site-Painting                  (2) | Val  Loss: 0.5320 | Val  Acc: 0.8825
 Site-Sketch                    (0) | Val  Loss: 0.6785 | Val  Acc: 0.8095
 Site-Sketch                    (0) | Val  Loss: 0.6484 | Val  Acc: 0.8286
 Site-QuickDraw                 (1) | Val  Loss: 1.2104 | Val  Acc: 0.6381
 Site-QuickDraw                 (1) | Val  Loss: 1.1547 | Val  Acc: 0.6571
 Site-Infograph                 (5) | Val  Loss: 1.3499 | Val  Acc: 0.5810
 Site-Infograph                 (5) | Val  Loss: 1.3333 | Val  Acc: 0.5492
Average Valid Accuracy: 0.7788
 Best site-Clipart                  (4)  | Epoch:11 | Val Acc: 0.8190
 Best site-Clipart                  (4)  | Epoch:11 | Val Acc: 0.8222
 Best site-Real                     (3)  | Epoch:11 | Val Acc: 0.9143
 Best site-Real                     (3)  | Epoch:11 | Val Acc: 0.9302
 Best site-Painting                 (2)  | Epoch:11 | Val Acc: 0.9143
 Best site-Painting                 (2)  | Epoch:11 | Val Acc: 0.8825
 Best site-Sketch                   (0)  | Epoch:11 | Val Acc: 0.8095
 Best site-Sketch                   (0)  | Epoch:11 | Val Acc: 0.8286
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.6381
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.6571
 Best site-Infograph                (5)  | Epoch:11 | Val Acc: 0.5810
 Best site-Infograph                (5)  | Epoch:11 | Val Acc: 0.5492
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (0) | Train Loss: 0.6715 | Train Acc: 0.7834
 Site-Clipart                   (0) | Train Loss: 0.6235 | Train Acc: 0.8284
 Site-Real                      (5) | Train Loss: 0.4711 | Train Acc: 0.9045
 Site-Real                      (5) | Train Loss: 0.3717 | Train Acc: 0.9343
 Site-Painting                  (2) | Train Loss: 0.5767 | Train Acc: 0.8535
 Site-Painting                  (2) | Train Loss: 0.5097 | Train Acc: 0.8686
 Site-Sketch                    (3) | Train Loss: 0.6021 | Train Acc: 0.8471
 Site-Sketch                    (3) | Train Loss: 0.6256 | Train Acc: 0.8178
 Site-QuickDraw                 (1) | Train Loss: 1.0219 | Train Acc: 0.6943
 Site-QuickDraw                 (1) | Train Loss: 1.1104 | Train Acc: 0.6568
 Site-Infograph                 (4) | Train Loss: 1.3287 | Train Acc: 0.5669
 Site-Infograph                 (4) | Train Loss: 1.2361 | Train Acc: 0.5953
Average Train Accuracy: 0.7792
 Site-Clipart                   (0) | Val  Loss: 0.5789 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.6933 | Val  Acc: 0.8095
 Site-Real                      (5) | Val  Loss: 0.4423 | Val  Acc: 0.8952
 Site-Real                      (5) | Val  Loss: 0.3849 | Val  Acc: 0.9333
 Site-Painting                  (2) | Val  Loss: 0.4290 | Val  Acc: 0.9048
 Site-Painting                  (2) | Val  Loss: 0.5190 | Val  Acc: 0.8698
 Site-Sketch                    (3) | Val  Loss: 0.6509 | Val  Acc: 0.8000
 Site-Sketch                    (3) | Val  Loss: 0.6503 | Val  Acc: 0.7905
 Site-QuickDraw                 (1) | Val  Loss: 1.1433 | Val  Acc: 0.6952
 Site-QuickDraw                 (1) | Val  Loss: 1.0936 | Val  Acc: 0.6794
 Site-Infograph                 (4) | Val  Loss: 1.3020 | Val  Acc: 0.6286
 Site-Infograph                 (4) | Val  Loss: 1.2834 | Val  Acc: 0.5683
Average Valid Accuracy: 0.7868
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.8667
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.8095
 Best site-Real                     (5)  | Epoch:12 | Val Acc: 0.8952
 Best site-Real                     (5)  | Epoch:12 | Val Acc: 0.9333
 Best site-Painting                 (2)  | Epoch:12 | Val Acc: 0.9048
 Best site-Painting                 (2)  | Epoch:12 | Val Acc: 0.8698
 Best site-Sketch                   (3)  | Epoch:12 | Val Acc: 0.8000
 Best site-Sketch                   (3)  | Epoch:12 | Val Acc: 0.7905
 Best site-QuickDraw                (1)  | Epoch:12 | Val Acc: 0.6952
 Best site-QuickDraw                (1)  | Epoch:12 | Val Acc: 0.6794
 Best site-Infograph                (4)  | Epoch:12 | Val Acc: 0.6286
 Best site-Infograph                (4)  | Epoch:12 | Val Acc: 0.5683
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (4) | Train Loss: 0.5844 | Train Acc: 0.8471
 Site-Clipart                   (4) | Train Loss: 0.6194 | Train Acc: 0.8369
 Site-Real                      (2) | Train Loss: 0.4283 | Train Acc: 0.9236
 Site-Real                      (2) | Train Loss: 0.3447 | Train Acc: 0.9386
 Site-Painting                  (5) | Train Loss: 0.5295 | Train Acc: 0.8344
 Site-Painting                  (5) | Train Loss: 0.5212 | Train Acc: 0.8602
 Site-Sketch                    (0) | Train Loss: 0.5121 | Train Acc: 0.8280
 Site-Sketch                    (0) | Train Loss: 0.6048 | Train Acc: 0.8051
 Site-QuickDraw                 (1) | Train Loss: 1.1027 | Train Acc: 0.6752
 Site-QuickDraw                 (1) | Train Loss: 1.0876 | Train Acc: 0.6886
 Site-Infograph                 (3) | Train Loss: 1.3948 | Train Acc: 0.5541
 Site-Infograph                 (3) | Train Loss: 1.1829 | Train Acc: 0.6292
Average Train Accuracy: 0.7851
 Site-Clipart                   (4) | Val  Loss: 0.6212 | Val  Acc: 0.8381
 Site-Clipart                   (4) | Val  Loss: 0.6806 | Val  Acc: 0.7937
 Site-Real                      (2) | Val  Loss: 0.4222 | Val  Acc: 0.8952
 Site-Real                      (2) | Val  Loss: 0.3748 | Val  Acc: 0.9270
 Site-Painting                  (5) | Val  Loss: 0.4044 | Val  Acc: 0.9238
 Site-Painting                  (5) | Val  Loss: 0.4788 | Val  Acc: 0.8952
 Site-Sketch                    (0) | Val  Loss: 0.6165 | Val  Acc: 0.8190
 Site-Sketch                    (0) | Val  Loss: 0.6009 | Val  Acc: 0.8444
 Site-QuickDraw                 (1) | Val  Loss: 1.1330 | Val  Acc: 0.6571
 Site-QuickDraw                 (1) | Val  Loss: 1.0955 | Val  Acc: 0.6825
 Site-Infograph                 (3) | Val  Loss: 1.2966 | Val  Acc: 0.6286
 Site-Infograph                 (3) | Val  Loss: 1.2865 | Val  Acc: 0.5683
Average Valid Accuracy: 0.7894
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8381
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.7937
 Best site-Real                     (2)  | Epoch:13 | Val Acc: 0.8952
 Best site-Real                     (2)  | Epoch:13 | Val Acc: 0.9270
 Best site-Painting                 (5)  | Epoch:13 | Val Acc: 0.9238
 Best site-Painting                 (5)  | Epoch:13 | Val Acc: 0.8952
 Best site-Sketch                   (0)  | Epoch:13 | Val Acc: 0.8190
 Best site-Sketch                   (0)  | Epoch:13 | Val Acc: 0.8444
 Best site-QuickDraw                (1)  | Epoch:13 | Val Acc: 0.6571
 Best site-QuickDraw                (1)  | Epoch:13 | Val Acc: 0.6825
 Best site-Infograph                (3)  | Epoch:13 | Val Acc: 0.6286
 Best site-Infograph                (3)  | Epoch:13 | Val Acc: 0.5683
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 14 ============
cnt=[4, 2, 1, 2, 2, 1, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (0) | Train Loss: 0.6028 | Train Acc: 0.8408
 Site-Clipart                   (0) | Train Loss: 0.5790 | Train Acc: 0.8453
 Site-Real                      (4) | Train Loss: 0.4015 | Train Acc: 0.9172
 Site-Real                      (4) | Train Loss: 0.3460 | Train Acc: 0.9386
 Site-Painting                  (5) | Train Loss: 0.5542 | Train Acc: 0.8471
 Site-Painting                  (2) | Train Loss: 0.5087 | Train Acc: 0.8686
 Site-Sketch                    (0) | Train Loss: 0.5277 | Train Acc: 0.8790
 Site-Sketch                    (0) | Train Loss: 0.6140 | Train Acc: 0.8199
 Site-QuickDraw                 (1) | Train Loss: 1.0425 | Train Acc: 0.6879
 Site-QuickDraw                 (1) | Train Loss: 1.0134 | Train Acc: 0.7119
 Site-Infograph                 (3) | Train Loss: 1.3366 | Train Acc: 0.5924
 Site-Infograph                 (3) | Train Loss: 1.1326 | Train Acc: 0.6314
Average Train Accuracy: 0.7983
 Site-Clipart                   (0) | Val  Loss: 0.6167 | Val  Acc: 0.8381
 Site-Clipart                   (0) | Val  Loss: 0.6439 | Val  Acc: 0.8159
 Site-Real                      (4) | Val  Loss: 0.3953 | Val  Acc: 0.9238
 Site-Real                      (4) | Val  Loss: 0.3572 | Val  Acc: 0.9270
 Site-Painting                  (5) | Val  Loss: 0.3890 | Val  Acc: 0.9143
 Site-Painting                  (2) | Val  Loss: 0.4779 | Val  Acc: 0.8825
 Site-Sketch                    (0) | Val  Loss: 0.6193 | Val  Acc: 0.8381
 Site-Sketch                    (0) | Val  Loss: 0.5872 | Val  Acc: 0.8508
 Site-QuickDraw                 (1) | Val  Loss: 1.0859 | Val  Acc: 0.6381
 Site-QuickDraw                 (1) | Val  Loss: 1.0319 | Val  Acc: 0.7111
 Site-Infograph                 (3) | Val  Loss: 1.2986 | Val  Acc: 0.6095
 Site-Infograph                 (3) | Val  Loss: 1.2269 | Val  Acc: 0.6127
Average Valid Accuracy: 0.7968
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8381
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8159
 Best site-Real                     (4)  | Epoch:14 | Val Acc: 0.9238
 Best site-Real                     (4)  | Epoch:14 | Val Acc: 0.9270
 Best site-Painting                 (5)  | Epoch:14 | Val Acc: 0.9143
 Best site-Painting                 (2)  | Epoch:14 | Val Acc: 0.8825
 Best site-Sketch                   (0)  | Epoch:14 | Val Acc: 0.8381
 Best site-Sketch                   (0)  | Epoch:14 | Val Acc: 0.8508
 Best site-QuickDraw                (1)  | Epoch:14 | Val Acc: 0.6381
 Best site-QuickDraw                (1)  | Epoch:14 | Val Acc: 0.7111
 Best site-Infograph                (3)  | Epoch:14 | Val Acc: 0.6095
 Best site-Infograph                (3)  | Epoch:14 | Val Acc: 0.6127
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (4) | Train Loss: 0.6117 | Train Acc: 0.8471
 Site-Clipart                   (4) | Train Loss: 0.5555 | Train Acc: 0.8665
 Site-Real                      (3) | Train Loss: 0.3589 | Train Acc: 0.9363
 Site-Real                      (3) | Train Loss: 0.3118 | Train Acc: 0.9534
 Site-Painting                  (0) | Train Loss: 0.4889 | Train Acc: 0.8790
 Site-Painting                  (0) | Train Loss: 0.4693 | Train Acc: 0.8919
 Site-Sketch                    (2) | Train Loss: 0.5297 | Train Acc: 0.8344
 Site-Sketch                    (2) | Train Loss: 0.5811 | Train Acc: 0.8369
 Site-QuickDraw                 (1) | Train Loss: 0.9849 | Train Acc: 0.6943
 Site-QuickDraw                 (1) | Train Loss: 0.9902 | Train Acc: 0.7288
 Site-Infograph                 (5) | Train Loss: 1.3408 | Train Acc: 0.5987
 Site-Infograph                 (5) | Train Loss: 1.1561 | Train Acc: 0.6208
Average Train Accuracy: 0.8073
 Site-Clipart                   (4) | Val  Loss: 0.5312 | Val  Acc: 0.9048
 Site-Clipart                   (4) | Val  Loss: 0.6126 | Val  Acc: 0.8476
 Site-Real                      (3) | Val  Loss: 0.3849 | Val  Acc: 0.9143
 Site-Real                      (3) | Val  Loss: 0.3495 | Val  Acc: 0.9270
 Site-Painting                  (0) | Val  Loss: 0.3563 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.4793 | Val  Acc: 0.8857
 Site-Sketch                    (2) | Val  Loss: 0.5715 | Val  Acc: 0.8476
 Site-Sketch                    (2) | Val  Loss: 0.5728 | Val  Acc: 0.8508
 Site-QuickDraw                 (1) | Val  Loss: 1.0063 | Val  Acc: 0.6952
 Site-QuickDraw                 (1) | Val  Loss: 0.9688 | Val  Acc: 0.7524
 Site-Infograph                 (5) | Val  Loss: 1.2388 | Val  Acc: 0.6095
 Site-Infograph                 (5) | Val  Loss: 1.1938 | Val  Acc: 0.6254
Average Valid Accuracy: 0.8177
 Best site-Clipart                  (4)  | Epoch:15 | Val Acc: 0.9048
 Best site-Clipart                  (4)  | Epoch:15 | Val Acc: 0.8476
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9143
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9270
 Best site-Painting                 (0)  | Epoch:15 | Val Acc: 0.9524
 Best site-Painting                 (0)  | Epoch:15 | Val Acc: 0.8857
 Best site-Sketch                   (2)  | Epoch:15 | Val Acc: 0.8476
 Best site-Sketch                   (2)  | Epoch:15 | Val Acc: 0.8508
 Best site-QuickDraw                (1)  | Epoch:15 | Val Acc: 0.6952
 Best site-QuickDraw                (1)  | Epoch:15 | Val Acc: 0.7524
 Best site-Infograph                (5)  | Epoch:15 | Val Acc: 0.6095
 Best site-Infograph                (5)  | Epoch:15 | Val Acc: 0.6254
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 16 ============
cnt=[2, 2, 2, 3, 2, 1, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (5) | Train Loss: 0.6241 | Train Acc: 0.8344
 Site-Clipart                   (3) | Train Loss: 0.5728 | Train Acc: 0.8496
 Site-Real                      (4) | Train Loss: 0.4125 | Train Acc: 0.9172
 Site-Real                      (4) | Train Loss: 0.2970 | Train Acc: 0.9407
 Site-Painting                  (2) | Train Loss: 0.5434 | Train Acc: 0.8662
 Site-Painting                  (2) | Train Loss: 0.4643 | Train Acc: 0.8877
 Site-Sketch                    (3) | Train Loss: 0.5147 | Train Acc: 0.8535
 Site-Sketch                    (3) | Train Loss: 0.5798 | Train Acc: 0.8369
 Site-QuickDraw                 (1) | Train Loss: 0.9987 | Train Acc: 0.7006
 Site-QuickDraw                 (1) | Train Loss: 0.9728 | Train Acc: 0.7436
 Site-Infograph                 (0) | Train Loss: 1.3577 | Train Acc: 0.6306
 Site-Infograph                 (0) | Train Loss: 1.1023 | Train Acc: 0.6504
Average Train Accuracy: 0.8093
 Site-Clipart                   (5) | Val  Loss: 0.5512 | Val  Acc: 0.8571
 Site-Clipart                   (3) | Val  Loss: 0.6077 | Val  Acc: 0.8222
 Site-Real                      (4) | Val  Loss: 0.3662 | Val  Acc: 0.9238
 Site-Real                      (4) | Val  Loss: 0.3505 | Val  Acc: 0.9365
 Site-Painting                  (2) | Val  Loss: 0.3456 | Val  Acc: 0.9429
 Site-Painting                  (2) | Val  Loss: 0.4509 | Val  Acc: 0.9016
 Site-Sketch                    (3) | Val  Loss: 0.6069 | Val  Acc: 0.8000
 Site-Sketch                    (3) | Val  Loss: 0.5441 | Val  Acc: 0.8635
 Site-QuickDraw                 (1) | Val  Loss: 0.9861 | Val  Acc: 0.7143
 Site-QuickDraw                 (1) | Val  Loss: 0.9450 | Val  Acc: 0.7587
 Site-Infograph                 (0) | Val  Loss: 1.2242 | Val  Acc: 0.6476
 Site-Infograph                 (0) | Val  Loss: 1.1786 | Val  Acc: 0.6159
Average Valid Accuracy: 0.8153
============ Train epoch 17 ============
cnt=[1, 2, 2, 2, 2, 3, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (0) | Train Loss: 0.5477 | Train Acc: 0.8471
 Site-Clipart                   (5) | Train Loss: 0.5529 | Train Acc: 0.8559
 Site-Real                      (3) | Train Loss: 0.4236 | Train Acc: 0.8981
 Site-Real                      (3) | Train Loss: 0.3266 | Train Acc: 0.9343
 Site-Painting                  (2) | Train Loss: 0.4744 | Train Acc: 0.8790
 Site-Painting                  (2) | Train Loss: 0.4439 | Train Acc: 0.8941
 Site-Sketch                    (5) | Train Loss: 0.5258 | Train Acc: 0.8599
 Site-Sketch                    (5) | Train Loss: 0.5669 | Train Acc: 0.8453
 Site-QuickDraw                 (1) | Train Loss: 0.9415 | Train Acc: 0.7134
 Site-QuickDraw                 (1) | Train Loss: 0.9103 | Train Acc: 0.7436
 Site-Infograph                 (4) | Train Loss: 1.3201 | Train Acc: 0.6115
 Site-Infograph                 (4) | Train Loss: 1.1182 | Train Acc: 0.6398
Average Train Accuracy: 0.8102
 Site-Clipart                   (0) | Val  Loss: 0.5433 | Val  Acc: 0.8667
 Site-Clipart                   (5) | Val  Loss: 0.6275 | Val  Acc: 0.8159
 Site-Real                      (3) | Val  Loss: 0.3881 | Val  Acc: 0.8952
 Site-Real                      (3) | Val  Loss: 0.3481 | Val  Acc: 0.9238
 Site-Painting                  (2) | Val  Loss: 0.3581 | Val  Acc: 0.9238
 Site-Painting                  (2) | Val  Loss: 0.4288 | Val  Acc: 0.8762
 Site-Sketch                    (5) | Val  Loss: 0.5681 | Val  Acc: 0.8190
 Site-Sketch                    (5) | Val  Loss: 0.5425 | Val  Acc: 0.8413
 Site-QuickDraw                 (1) | Val  Loss: 0.9631 | Val  Acc: 0.7333
 Site-QuickDraw                 (1) | Val  Loss: 0.8984 | Val  Acc: 0.7587
 Site-Infograph                 (4) | Val  Loss: 1.2100 | Val  Acc: 0.6381
 Site-Infograph                 (4) | Val  Loss: 1.1666 | Val  Acc: 0.6413
Average Valid Accuracy: 0.8111
============ Train epoch 18 ============
cnt=[2, 3, 2, 2, 2, 1, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (1) | Train Loss: 0.5429 | Train Acc: 0.8471
 Site-Clipart                   (1) | Train Loss: 0.5271 | Train Acc: 0.8644
 Site-Real                      (3) | Train Loss: 0.4302 | Train Acc: 0.9108
 Site-Real                      (3) | Train Loss: 0.2822 | Train Acc: 0.9407
 Site-Painting                  (4) | Train Loss: 0.5370 | Train Acc: 0.8790
 Site-Painting                  (4) | Train Loss: 0.4141 | Train Acc: 0.9047
 Site-Sketch                    (5) | Train Loss: 0.5135 | Train Acc: 0.8599
 Site-Sketch                    (1) | Train Loss: 0.5520 | Train Acc: 0.8369
 Site-QuickDraw                 (0) | Train Loss: 0.9419 | Train Acc: 0.7389
 Site-QuickDraw                 (0) | Train Loss: 0.9053 | Train Acc: 0.7606
 Site-Infograph                 (2) | Train Loss: 1.2311 | Train Acc: 0.6369
 Site-Infograph                 (2) | Train Loss: 1.0932 | Train Acc: 0.6568
Average Train Accuracy: 0.8197
 Site-Clipart                   (1) | Val  Loss: 0.5178 | Val  Acc: 0.8571
 Site-Clipart                   (1) | Val  Loss: 0.5872 | Val  Acc: 0.8476
 Site-Real                      (3) | Val  Loss: 0.3376 | Val  Acc: 0.8952
 Site-Real                      (3) | Val  Loss: 0.3258 | Val  Acc: 0.9302
 Site-Painting                  (4) | Val  Loss: 0.3793 | Val  Acc: 0.9143
 Site-Painting                  (4) | Val  Loss: 0.4254 | Val  Acc: 0.8952
 Site-Sketch                    (5) | Val  Loss: 0.5913 | Val  Acc: 0.8095
 Site-Sketch                    (1) | Val  Loss: 0.5513 | Val  Acc: 0.8381
 Site-QuickDraw                 (0) | Val  Loss: 0.9014 | Val  Acc: 0.7143
 Site-QuickDraw                 (0) | Val  Loss: 0.8842 | Val  Acc: 0.7683
 Site-Infograph                 (2) | Val  Loss: 1.1645 | Val  Acc: 0.6667
 Site-Infograph                 (2) | Val  Loss: 1.1314 | Val  Acc: 0.6381
Average Valid Accuracy: 0.8146
============ Train epoch 19 ============
cnt=[2, 2, 3, 2, 2, 1, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (2) | Train Loss: 0.5672 | Train Acc: 0.8408
 Site-Clipart                   (2) | Train Loss: 0.5138 | Train Acc: 0.8559
 Site-Real                      (3) | Train Loss: 0.3861 | Train Acc: 0.9108
 Site-Real                      (3) | Train Loss: 0.2884 | Train Acc: 0.9364
 Site-Painting                  (4) | Train Loss: 0.4786 | Train Acc: 0.8790
 Site-Painting                  (4) | Train Loss: 0.4049 | Train Acc: 0.8962
 Site-Sketch                    (5) | Train Loss: 0.4973 | Train Acc: 0.8535
 Site-Sketch                    (2) | Train Loss: 0.5605 | Train Acc: 0.8538
 Site-QuickDraw                 (1) | Train Loss: 0.8402 | Train Acc: 0.7325
 Site-QuickDraw                 (1) | Train Loss: 0.8736 | Train Acc: 0.7691
 Site-Infograph                 (0) | Train Loss: 1.1964 | Train Acc: 0.6178
 Site-Infograph                 (0) | Train Loss: 1.0684 | Train Acc: 0.6589
Average Train Accuracy: 0.8171
 Site-Clipart                   (2) | Val  Loss: 0.4891 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.5823 | Val  Acc: 0.8317
 Site-Real                      (3) | Val  Loss: 0.3518 | Val  Acc: 0.9143
 Site-Real                      (3) | Val  Loss: 0.3021 | Val  Acc: 0.9460
 Site-Painting                  (4) | Val  Loss: 0.3321 | Val  Acc: 0.9238
 Site-Painting                  (4) | Val  Loss: 0.3957 | Val  Acc: 0.8952
 Site-Sketch                    (5) | Val  Loss: 0.5895 | Val  Acc: 0.8190
 Site-Sketch                    (2) | Val  Loss: 0.5301 | Val  Acc: 0.8540
 Site-QuickDraw                 (1) | Val  Loss: 0.9282 | Val  Acc: 0.7143
 Site-QuickDraw                 (1) | Val  Loss: 0.8800 | Val  Acc: 0.7556
 Site-Infograph                 (0) | Val  Loss: 1.1925 | Val  Acc: 0.6476
 Site-Infograph                 (0) | Val  Loss: 1.1398 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8156
============ Train epoch 20 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (2) | Train Loss: 0.5984 | Train Acc: 0.8344
 Site-Clipart                   (2) | Train Loss: 0.5250 | Train Acc: 0.8708
 Site-Real                      (4) | Train Loss: 0.3298 | Train Acc: 0.9172
 Site-Real                      (4) | Train Loss: 0.2795 | Train Acc: 0.9407
 Site-Painting                  (1) | Train Loss: 0.4555 | Train Acc: 0.8854
 Site-Painting                  (1) | Train Loss: 0.4275 | Train Acc: 0.8919
 Site-Sketch                    (5) | Train Loss: 0.4950 | Train Acc: 0.8599
 Site-Sketch                    (5) | Train Loss: 0.5408 | Train Acc: 0.8305
 Site-QuickDraw                 (0) | Train Loss: 0.8393 | Train Acc: 0.7389
 Site-QuickDraw                 (0) | Train Loss: 0.8524 | Train Acc: 0.7585
 Site-Infograph                 (3) | Train Loss: 1.2235 | Train Acc: 0.5987
 Site-Infograph                 (3) | Train Loss: 1.0384 | Train Acc: 0.6864
Average Train Accuracy: 0.8178
 Site-Clipart                   (2) | Val  Loss: 0.4988 | Val  Acc: 0.8762
 Site-Clipart                   (2) | Val  Loss: 0.5645 | Val  Acc: 0.8317
 Site-Real                      (4) | Val  Loss: 0.3070 | Val  Acc: 0.9238
 Site-Real                      (4) | Val  Loss: 0.3021 | Val  Acc: 0.9365
 Site-Painting                  (1) | Val  Loss: 0.3134 | Val  Acc: 0.9429
 Site-Painting                  (1) | Val  Loss: 0.4321 | Val  Acc: 0.9111
 Site-Sketch                    (5) | Val  Loss: 0.5649 | Val  Acc: 0.8476
 Site-Sketch                    (5) | Val  Loss: 0.5480 | Val  Acc: 0.8667
 Site-QuickDraw                 (0) | Val  Loss: 0.9331 | Val  Acc: 0.7333
 Site-QuickDraw                 (0) | Val  Loss: 0.8654 | Val  Acc: 0.7714
 Site-Infograph                 (3) | Val  Loss: 1.1832 | Val  Acc: 0.6762
 Site-Infograph                 (3) | Val  Loss: 1.0890 | Val  Acc: 0.6635
Average Valid Accuracy: 0.8317
 Best site-Clipart                  (2)  | Epoch:20 | Val Acc: 0.8762
 Best site-Clipart                  (2)  | Epoch:20 | Val Acc: 0.8317
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9238
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9365
 Best site-Painting                 (1)  | Epoch:20 | Val Acc: 0.9429
 Best site-Painting                 (1)  | Epoch:20 | Val Acc: 0.9111
 Best site-Sketch                   (5)  | Epoch:20 | Val Acc: 0.8476
 Best site-Sketch                   (5)  | Epoch:20 | Val Acc: 0.8667
 Best site-QuickDraw                (0)  | Epoch:20 | Val Acc: 0.7333
 Best site-QuickDraw                (0)  | Epoch:20 | Val Acc: 0.7714
 Best site-Infograph                (3)  | Epoch:20 | Val Acc: 0.6762
 Best site-Infograph                (3)  | Epoch:20 | Val Acc: 0.6635
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 21 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (2) | Train Loss: 0.5860 | Train Acc: 0.8662
 Site-Clipart                   (2) | Train Loss: 0.5447 | Train Acc: 0.8496
 Site-Real                      (4) | Train Loss: 0.3433 | Train Acc: 0.9299
 Site-Real                      (4) | Train Loss: 0.2833 | Train Acc: 0.9534
 Site-Painting                  (3) | Train Loss: 0.4629 | Train Acc: 0.8471
 Site-Painting                  (3) | Train Loss: 0.3997 | Train Acc: 0.9025
 Site-Sketch                    (5) | Train Loss: 0.4995 | Train Acc: 0.8726
 Site-Sketch                    (5) | Train Loss: 0.5163 | Train Acc: 0.8305
 Site-QuickDraw                 (1) | Train Loss: 0.8572 | Train Acc: 0.7452
 Site-QuickDraw                 (1) | Train Loss: 0.8755 | Train Acc: 0.7373
 Site-Infograph                 (0) | Train Loss: 1.2273 | Train Acc: 0.6115
 Site-Infograph                 (0) | Train Loss: 1.0490 | Train Acc: 0.6758
Average Train Accuracy: 0.8185
 Site-Clipart                   (2) | Val  Loss: 0.4407 | Val  Acc: 0.8952
 Site-Clipart                   (2) | Val  Loss: 0.5612 | Val  Acc: 0.8540
 Site-Real                      (4) | Val  Loss: 0.3221 | Val  Acc: 0.9238
 Site-Real                      (4) | Val  Loss: 0.3123 | Val  Acc: 0.9365
 Site-Painting                  (3) | Val  Loss: 0.3130 | Val  Acc: 0.9429
 Site-Painting                  (3) | Val  Loss: 0.3825 | Val  Acc: 0.9302
 Site-Sketch                    (5) | Val  Loss: 0.4826 | Val  Acc: 0.8667
 Site-Sketch                    (5) | Val  Loss: 0.4909 | Val  Acc: 0.8667
 Site-QuickDraw                 (1) | Val  Loss: 0.8641 | Val  Acc: 0.7810
 Site-QuickDraw                 (1) | Val  Loss: 0.8414 | Val  Acc: 0.7714
 Site-Infograph                 (0) | Val  Loss: 1.1333 | Val  Acc: 0.6857
 Site-Infograph                 (0) | Val  Loss: 1.1257 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8402
 Best site-Clipart                  (2)  | Epoch:21 | Val Acc: 0.8952
 Best site-Clipart                  (2)  | Epoch:21 | Val Acc: 0.8540
 Best site-Real                     (4)  | Epoch:21 | Val Acc: 0.9238
 Best site-Real                     (4)  | Epoch:21 | Val Acc: 0.9365
 Best site-Painting                 (3)  | Epoch:21 | Val Acc: 0.9429
 Best site-Painting                 (3)  | Epoch:21 | Val Acc: 0.9302
 Best site-Sketch                   (5)  | Epoch:21 | Val Acc: 0.8667
 Best site-Sketch                   (5)  | Epoch:21 | Val Acc: 0.8667
 Best site-QuickDraw                (1)  | Epoch:21 | Val Acc: 0.7810
 Best site-QuickDraw                (1)  | Epoch:21 | Val Acc: 0.7714
 Best site-Infograph                (0)  | Epoch:21 | Val Acc: 0.6857
 Best site-Infograph                (0)  | Epoch:21 | Val Acc: 0.6286
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (2) | Train Loss: 0.5033 | Train Acc: 0.8344
 Site-Clipart                   (2) | Train Loss: 0.4928 | Train Acc: 0.8708
 Site-Real                      (4) | Train Loss: 0.3390 | Train Acc: 0.9108
 Site-Real                      (4) | Train Loss: 0.2737 | Train Acc: 0.9428
 Site-Painting                  (0) | Train Loss: 0.4261 | Train Acc: 0.8790
 Site-Painting                  (0) | Train Loss: 0.4240 | Train Acc: 0.8877
 Site-Sketch                    (5) | Train Loss: 0.4565 | Train Acc: 0.8662
 Site-Sketch                    (5) | Train Loss: 0.5194 | Train Acc: 0.8581
 Site-QuickDraw                 (1) | Train Loss: 0.8806 | Train Acc: 0.7516
 Site-QuickDraw                 (1) | Train Loss: 0.8527 | Train Acc: 0.7373
 Site-Infograph                 (3) | Train Loss: 1.3347 | Train Acc: 0.5987
 Site-Infograph                 (3) | Train Loss: 0.9975 | Train Acc: 0.6843
Average Train Accuracy: 0.8185
 Site-Clipart                   (2) | Val  Loss: 0.4855 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.5424 | Val  Acc: 0.8476
 Site-Real                      (4) | Val  Loss: 0.3870 | Val  Acc: 0.9048
 Site-Real                      (4) | Val  Loss: 0.3027 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.3099 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.3908 | Val  Acc: 0.8921
 Site-Sketch                    (5) | Val  Loss: 0.4611 | Val  Acc: 0.8571
 Site-Sketch                    (5) | Val  Loss: 0.5221 | Val  Acc: 0.8381
 Site-QuickDraw                 (1) | Val  Loss: 0.9483 | Val  Acc: 0.7048
 Site-QuickDraw                 (1) | Val  Loss: 0.8054 | Val  Acc: 0.7746
 Site-Infograph                 (3) | Val  Loss: 1.1699 | Val  Acc: 0.6571
 Site-Infograph                 (3) | Val  Loss: 1.1029 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8198
============ Train epoch 23 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (5) | Train Loss: 0.5653 | Train Acc: 0.8344
 Site-Clipart                   (5) | Train Loss: 0.4711 | Train Acc: 0.8729
 Site-Real                      (4) | Train Loss: 0.3476 | Train Acc: 0.9236
 Site-Real                      (4) | Train Loss: 0.2835 | Train Acc: 0.9449
 Site-Painting                  (3) | Train Loss: 0.4714 | Train Acc: 0.8790
 Site-Painting                  (3) | Train Loss: 0.3802 | Train Acc: 0.9195
 Site-Sketch                    (2) | Train Loss: 0.4849 | Train Acc: 0.8726
 Site-Sketch                    (2) | Train Loss: 0.4866 | Train Acc: 0.8475
 Site-QuickDraw                 (1) | Train Loss: 0.8324 | Train Acc: 0.7452
 Site-QuickDraw                 (1) | Train Loss: 0.8416 | Train Acc: 0.7627
 Site-Infograph                 (0) | Train Loss: 1.2605 | Train Acc: 0.6688
 Site-Infograph                 (0) | Train Loss: 1.0061 | Train Acc: 0.6758
Average Train Accuracy: 0.8289
 Site-Clipart                   (5) | Val  Loss: 0.4770 | Val  Acc: 0.8571
 Site-Clipart                   (5) | Val  Loss: 0.5681 | Val  Acc: 0.8222
 Site-Real                      (4) | Val  Loss: 0.3050 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.2860 | Val  Acc: 0.9429
 Site-Painting                  (3) | Val  Loss: 0.3112 | Val  Acc: 0.9143
 Site-Painting                  (3) | Val  Loss: 0.3848 | Val  Acc: 0.9016
 Site-Sketch                    (2) | Val  Loss: 0.5371 | Val  Acc: 0.8381
 Site-Sketch                    (2) | Val  Loss: 0.4965 | Val  Acc: 0.8540
 Site-QuickDraw                 (1) | Val  Loss: 0.8492 | Val  Acc: 0.7333
 Site-QuickDraw                 (1) | Val  Loss: 0.8340 | Val  Acc: 0.7587
 Site-Infograph                 (0) | Val  Loss: 1.1143 | Val  Acc: 0.6667
 Site-Infograph                 (0) | Val  Loss: 1.0782 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8241
============ Train epoch 24 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (4) | Train Loss: 0.5372 | Train Acc: 0.8471
 Site-Clipart                   (4) | Train Loss: 0.5086 | Train Acc: 0.8559
 Site-Real                      (5) | Train Loss: 0.3469 | Train Acc: 0.9172
 Site-Real                      (5) | Train Loss: 0.2664 | Train Acc: 0.9428
 Site-Painting                  (3) | Train Loss: 0.4413 | Train Acc: 0.8981
 Site-Painting                  (3) | Train Loss: 0.4014 | Train Acc: 0.8898
 Site-Sketch                    (0) | Train Loss: 0.4659 | Train Acc: 0.8726
 Site-Sketch                    (0) | Train Loss: 0.5086 | Train Acc: 0.8432
 Site-QuickDraw                 (1) | Train Loss: 0.9342 | Train Acc: 0.7070
 Site-QuickDraw                 (1) | Train Loss: 0.7781 | Train Acc: 0.7860
 Site-Infograph                 (2) | Train Loss: 1.1512 | Train Acc: 0.6051
 Site-Infograph                 (2) | Train Loss: 0.9441 | Train Acc: 0.6992
Average Train Accuracy: 0.8220
 Site-Clipart                   (4) | Val  Loss: 0.4446 | Val  Acc: 0.8857
 Site-Clipart                   (4) | Val  Loss: 0.5266 | Val  Acc: 0.8508
 Site-Real                      (5) | Val  Loss: 0.3512 | Val  Acc: 0.9238
 Site-Real                      (5) | Val  Loss: 0.2884 | Val  Acc: 0.9460
 Site-Painting                  (3) | Val  Loss: 0.2860 | Val  Acc: 0.9429
 Site-Painting                  (3) | Val  Loss: 0.3449 | Val  Acc: 0.9238
 Site-Sketch                    (0) | Val  Loss: 0.4810 | Val  Acc: 0.8762
 Site-Sketch                    (0) | Val  Loss: 0.4491 | Val  Acc: 0.8667
 Site-QuickDraw                 (1) | Val  Loss: 0.9089 | Val  Acc: 0.7238
 Site-QuickDraw                 (1) | Val  Loss: 0.7946 | Val  Acc: 0.7587
 Site-Infograph                 (2) | Val  Loss: 1.1671 | Val  Acc: 0.6476
 Site-Infograph                 (2) | Val  Loss: 1.0380 | Val  Acc: 0.6635
Average Valid Accuracy: 0.8341
============ Train epoch 25 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (5) | Train Loss: 0.5346 | Train Acc: 0.8662
 Site-Clipart                   (5) | Train Loss: 0.4788 | Train Acc: 0.8729
 Site-Real                      (4) | Train Loss: 0.3549 | Train Acc: 0.9172
 Site-Real                      (4) | Train Loss: 0.2594 | Train Acc: 0.9428
 Site-Painting                  (2) | Train Loss: 0.4526 | Train Acc: 0.8790
 Site-Painting                  (2) | Train Loss: 0.3902 | Train Acc: 0.8962
 Site-Sketch                    (0) | Train Loss: 0.4525 | Train Acc: 0.8790
 Site-Sketch                    (0) | Train Loss: 0.4758 | Train Acc: 0.8453
 Site-QuickDraw                 (1) | Train Loss: 0.8629 | Train Acc: 0.7389
 Site-QuickDraw                 (1) | Train Loss: 0.7867 | Train Acc: 0.7818
 Site-Infograph                 (3) | Train Loss: 1.2248 | Train Acc: 0.6306
 Site-Infograph                 (3) | Train Loss: 0.9629 | Train Acc: 0.7076
Average Train Accuracy: 0.8298
 Site-Clipart                   (5) | Val  Loss: 0.4433 | Val  Acc: 0.9143
 Site-Clipart                   (5) | Val  Loss: 0.4935 | Val  Acc: 0.8508
 Site-Real                      (4) | Val  Loss: 0.3107 | Val  Acc: 0.9238
 Site-Real                      (4) | Val  Loss: 0.2856 | Val  Acc: 0.9429
 Site-Painting                  (2) | Val  Loss: 0.2927 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.3716 | Val  Acc: 0.9048
 Site-Sketch                    (0) | Val  Loss: 0.5319 | Val  Acc: 0.8286
 Site-Sketch                    (0) | Val  Loss: 0.5151 | Val  Acc: 0.8667
 Site-QuickDraw                 (1) | Val  Loss: 0.8390 | Val  Acc: 0.7048
 Site-QuickDraw                 (1) | Val  Loss: 0.7888 | Val  Acc: 0.7524
 Site-Infograph                 (3) | Val  Loss: 1.1505 | Val  Acc: 0.5714
 Site-Infograph                 (3) | Val  Loss: 1.0176 | Val  Acc: 0.6889
Average Valid Accuracy: 0.8251
============ Train epoch 26 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (5) | Train Loss: 0.5164 | Train Acc: 0.8471
 Site-Clipart                   (5) | Train Loss: 0.4756 | Train Acc: 0.8623
 Site-Real                      (1) | Train Loss: 0.3673 | Train Acc: 0.9172
 Site-Real                      (1) | Train Loss: 0.2576 | Train Acc: 0.9343
 Site-Painting                  (4) | Train Loss: 0.3932 | Train Acc: 0.9045
 Site-Painting                  (4) | Train Loss: 0.3899 | Train Acc: 0.9131
 Site-Sketch                    (3) | Train Loss: 0.4451 | Train Acc: 0.8790
 Site-Sketch                    (3) | Train Loss: 0.5038 | Train Acc: 0.8411
 Site-QuickDraw                 (0) | Train Loss: 0.7856 | Train Acc: 0.7452
 Site-QuickDraw                 (0) | Train Loss: 0.7532 | Train Acc: 0.7881
 Site-Infograph                 (2) | Train Loss: 1.1750 | Train Acc: 0.6433
 Site-Infograph                 (2) | Train Loss: 0.9925 | Train Acc: 0.6949
Average Train Accuracy: 0.8309
 Site-Clipart                   (5) | Val  Loss: 0.4287 | Val  Acc: 0.9048
 Site-Clipart                   (5) | Val  Loss: 0.5074 | Val  Acc: 0.8635
 Site-Real                      (1) | Val  Loss: 0.3320 | Val  Acc: 0.9238
 Site-Real                      (1) | Val  Loss: 0.2974 | Val  Acc: 0.9238
 Site-Painting                  (4) | Val  Loss: 0.2850 | Val  Acc: 0.9429
 Site-Painting                  (4) | Val  Loss: 0.3634 | Val  Acc: 0.9143
 Site-Sketch                    (3) | Val  Loss: 0.4306 | Val  Acc: 0.8952
 Site-Sketch                    (3) | Val  Loss: 0.4644 | Val  Acc: 0.8571
 Site-QuickDraw                 (0) | Val  Loss: 0.8152 | Val  Acc: 0.7810
 Site-QuickDraw                 (0) | Val  Loss: 0.7827 | Val  Acc: 0.7651
 Site-Infograph                 (2) | Val  Loss: 1.0382 | Val  Acc: 0.6952
 Site-Infograph                 (2) | Val  Loss: 1.0472 | Val  Acc: 0.6444
Average Valid Accuracy: 0.8426
 Best site-Clipart                  (5)  | Epoch:26 | Val Acc: 0.9048
 Best site-Clipart                  (5)  | Epoch:26 | Val Acc: 0.8635
 Best site-Real                     (1)  | Epoch:26 | Val Acc: 0.9238
 Best site-Real                     (1)  | Epoch:26 | Val Acc: 0.9238
 Best site-Painting                 (4)  | Epoch:26 | Val Acc: 0.9429
 Best site-Painting                 (4)  | Epoch:26 | Val Acc: 0.9143
 Best site-Sketch                   (3)  | Epoch:26 | Val Acc: 0.8952
 Best site-Sketch                   (3)  | Epoch:26 | Val Acc: 0.8571
 Best site-QuickDraw                (0)  | Epoch:26 | Val Acc: 0.7810
 Best site-QuickDraw                (0)  | Epoch:26 | Val Acc: 0.7651
 Best site-Infograph                (2)  | Epoch:26 | Val Acc: 0.6952
 Best site-Infograph                (2)  | Epoch:26 | Val Acc: 0.6444
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 27 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (2) | Train Loss: 0.5209 | Train Acc: 0.8599
 Site-Clipart                   (2) | Train Loss: 0.4752 | Train Acc: 0.8729
 Site-Real                      (4) | Train Loss: 0.3506 | Train Acc: 0.9236
 Site-Real                      (4) | Train Loss: 0.2519 | Train Acc: 0.9492
 Site-Painting                  (3) | Train Loss: 0.4645 | Train Acc: 0.8854
 Site-Painting                  (3) | Train Loss: 0.3806 | Train Acc: 0.8962
 Site-Sketch                    (5) | Train Loss: 0.4560 | Train Acc: 0.8280
 Site-Sketch                    (5) | Train Loss: 0.4592 | Train Acc: 0.8538
 Site-QuickDraw                 (1) | Train Loss: 0.8386 | Train Acc: 0.7707
 Site-QuickDraw                 (1) | Train Loss: 0.7561 | Train Acc: 0.7733
 Site-Infograph                 (0) | Train Loss: 1.2008 | Train Acc: 0.6306
 Site-Infograph                 (0) | Train Loss: 0.9611 | Train Acc: 0.6928
Average Train Accuracy: 0.8280
 Site-Clipart                   (2) | Val  Loss: 0.4151 | Val  Acc: 0.8952
 Site-Clipart                   (2) | Val  Loss: 0.5133 | Val  Acc: 0.8444
 Site-Real                      (4) | Val  Loss: 0.2932 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.3004 | Val  Acc: 0.9270
 Site-Painting                  (3) | Val  Loss: 0.2600 | Val  Acc: 0.9429
 Site-Painting                  (3) | Val  Loss: 0.3533 | Val  Acc: 0.9175
 Site-Sketch                    (5) | Val  Loss: 0.4990 | Val  Acc: 0.8476
 Site-Sketch                    (5) | Val  Loss: 0.4673 | Val  Acc: 0.8571
 Site-QuickDraw                 (1) | Val  Loss: 0.8054 | Val  Acc: 0.7905
 Site-QuickDraw                 (1) | Val  Loss: 0.7672 | Val  Acc: 0.8000
 Site-Infograph                 (0) | Val  Loss: 1.0204 | Val  Acc: 0.6762
 Site-Infograph                 (0) | Val  Loss: 0.9921 | Val  Acc: 0.6794
Average Valid Accuracy: 0.8442
 Best site-Clipart                  (2)  | Epoch:27 | Val Acc: 0.8952
 Best site-Clipart                  (2)  | Epoch:27 | Val Acc: 0.8444
 Best site-Real                     (4)  | Epoch:27 | Val Acc: 0.9524
 Best site-Real                     (4)  | Epoch:27 | Val Acc: 0.9270
 Best site-Painting                 (3)  | Epoch:27 | Val Acc: 0.9429
 Best site-Painting                 (3)  | Epoch:27 | Val Acc: 0.9175
 Best site-Sketch                   (5)  | Epoch:27 | Val Acc: 0.8476
 Best site-Sketch                   (5)  | Epoch:27 | Val Acc: 0.8571
 Best site-QuickDraw                (1)  | Epoch:27 | Val Acc: 0.7905
 Best site-QuickDraw                (1)  | Epoch:27 | Val Acc: 0.8000
 Best site-Infograph                (0)  | Epoch:27 | Val Acc: 0.6762
 Best site-Infograph                (0)  | Epoch:27 | Val Acc: 0.6794
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 28 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (5) | Train Loss: 0.5308 | Train Acc: 0.8662
 Site-Clipart                   (5) | Train Loss: 0.4481 | Train Acc: 0.8686
 Site-Real                      (4) | Train Loss: 0.3083 | Train Acc: 0.9236
 Site-Real                      (4) | Train Loss: 0.2804 | Train Acc: 0.9364
 Site-Painting                  (0) | Train Loss: 0.4004 | Train Acc: 0.8790
 Site-Painting                  (0) | Train Loss: 0.3835 | Train Acc: 0.9195
 Site-Sketch                    (2) | Train Loss: 0.4364 | Train Acc: 0.8854
 Site-Sketch                    (2) | Train Loss: 0.5137 | Train Acc: 0.8369
 Site-QuickDraw                 (1) | Train Loss: 0.8261 | Train Acc: 0.7325
 Site-QuickDraw                 (1) | Train Loss: 0.7348 | Train Acc: 0.7903
 Site-Infograph                 (3) | Train Loss: 1.2294 | Train Acc: 0.5987
 Site-Infograph                 (3) | Train Loss: 0.8972 | Train Acc: 0.7140
Average Train Accuracy: 0.8293
 Site-Clipart                   (5) | Val  Loss: 0.4506 | Val  Acc: 0.8667
 Site-Clipart                   (5) | Val  Loss: 0.5021 | Val  Acc: 0.8571
 Site-Real                      (4) | Val  Loss: 0.2946 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.2797 | Val  Acc: 0.9270
 Site-Painting                  (0) | Val  Loss: 0.3054 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.3491 | Val  Acc: 0.9111
 Site-Sketch                    (2) | Val  Loss: 0.4831 | Val  Acc: 0.8571
 Site-Sketch                    (2) | Val  Loss: 0.5167 | Val  Acc: 0.8413
 Site-QuickDraw                 (1) | Val  Loss: 0.8006 | Val  Acc: 0.7619
 Site-QuickDraw                 (1) | Val  Loss: 0.7289 | Val  Acc: 0.7873
 Site-Infograph                 (3) | Val  Loss: 1.0937 | Val  Acc: 0.6857
 Site-Infograph                 (3) | Val  Loss: 1.0076 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8357
============ Train epoch 29 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (4) | Train Loss: 0.5321 | Train Acc: 0.8471
 Site-Clipart                   (4) | Train Loss: 0.4744 | Train Acc: 0.8623
 Site-Real                      (0) | Train Loss: 0.3125 | Train Acc: 0.9108
 Site-Real                      (0) | Train Loss: 0.2544 | Train Acc: 0.9513
 Site-Painting                  (5) | Train Loss: 0.4283 | Train Acc: 0.8790
 Site-Painting                  (5) | Train Loss: 0.3549 | Train Acc: 0.9174
 Site-Sketch                    (3) | Train Loss: 0.4710 | Train Acc: 0.8726
 Site-Sketch                    (3) | Train Loss: 0.4432 | Train Acc: 0.8814
 Site-QuickDraw                 (1) | Train Loss: 0.8245 | Train Acc: 0.7516
 Site-QuickDraw                 (1) | Train Loss: 0.7329 | Train Acc: 0.7945
 Site-Infograph                 (2) | Train Loss: 1.2036 | Train Acc: 0.6178
 Site-Infograph                 (2) | Train Loss: 0.9017 | Train Acc: 0.7373
Average Train Accuracy: 0.8353
 Site-Clipart                   (4) | Val  Loss: 0.3914 | Val  Acc: 0.8857
 Site-Clipart                   (4) | Val  Loss: 0.5100 | Val  Acc: 0.8413
 Site-Real                      (0) | Val  Loss: 0.2989 | Val  Acc: 0.9048
 Site-Real                      (0) | Val  Loss: 0.2784 | Val  Acc: 0.9429
 Site-Painting                  (5) | Val  Loss: 0.2630 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.3348 | Val  Acc: 0.9270
 Site-Sketch                    (3) | Val  Loss: 0.4743 | Val  Acc: 0.8476
 Site-Sketch                    (3) | Val  Loss: 0.4755 | Val  Acc: 0.8508
 Site-QuickDraw                 (1) | Val  Loss: 0.7354 | Val  Acc: 0.7905
 Site-QuickDraw                 (1) | Val  Loss: 0.7266 | Val  Acc: 0.8159
 Site-Infograph                 (2) | Val  Loss: 1.0451 | Val  Acc: 0.6667
 Site-Infograph                 (2) | Val  Loss: 0.9752 | Val  Acc: 0.6762
Average Valid Accuracy: 0.8418
============ Train epoch 30 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (5) | Train Loss: 0.4819 | Train Acc: 0.8535
 Site-Clipart                   (5) | Train Loss: 0.4511 | Train Acc: 0.8771
 Site-Real                      (0) | Train Loss: 0.3174 | Train Acc: 0.9108
 Site-Real                      (0) | Train Loss: 0.2332 | Train Acc: 0.9492
 Site-Painting                  (4) | Train Loss: 0.4271 | Train Acc: 0.8726
 Site-Painting                  (4) | Train Loss: 0.3414 | Train Acc: 0.9343
 Site-Sketch                    (3) | Train Loss: 0.4637 | Train Acc: 0.8535
 Site-Sketch                    (3) | Train Loss: 0.4408 | Train Acc: 0.8708
 Site-QuickDraw                 (1) | Train Loss: 0.7509 | Train Acc: 0.7580
 Site-QuickDraw                 (1) | Train Loss: 0.7371 | Train Acc: 0.8008
 Site-Infograph                 (2) | Train Loss: 1.1442 | Train Acc: 0.6497
 Site-Infograph                 (2) | Train Loss: 0.9298 | Train Acc: 0.7034
Average Train Accuracy: 0.8361
 Site-Clipart                   (5) | Val  Loss: 0.4385 | Val  Acc: 0.8667
 Site-Clipart                   (5) | Val  Loss: 0.4915 | Val  Acc: 0.8667
 Site-Real                      (0) | Val  Loss: 0.2924 | Val  Acc: 0.9048
 Site-Real                      (0) | Val  Loss: 0.2531 | Val  Acc: 0.9365
 Site-Painting                  (4) | Val  Loss: 0.2692 | Val  Acc: 0.9429
 Site-Painting                  (4) | Val  Loss: 0.3431 | Val  Acc: 0.9206
 Site-Sketch                    (3) | Val  Loss: 0.5067 | Val  Acc: 0.8667
 Site-Sketch                    (3) | Val  Loss: 0.4727 | Val  Acc: 0.8571
 Site-QuickDraw                 (1) | Val  Loss: 0.7667 | Val  Acc: 0.7810
 Site-QuickDraw                 (1) | Val  Loss: 0.7205 | Val  Acc: 0.8032
 Site-Infograph                 (2) | Val  Loss: 1.0103 | Val  Acc: 0.7143
 Site-Infograph                 (2) | Val  Loss: 0.9241 | Val  Acc: 0.7079
Average Valid Accuracy: 0.8474
 Best site-Clipart                  (5)  | Epoch:30 | Val Acc: 0.8667
 Best site-Clipart                  (5)  | Epoch:30 | Val Acc: 0.8667
 Best site-Real                     (0)  | Epoch:30 | Val Acc: 0.9048
 Best site-Real                     (0)  | Epoch:30 | Val Acc: 0.9365
 Best site-Painting                 (4)  | Epoch:30 | Val Acc: 0.9429
 Best site-Painting                 (4)  | Epoch:30 | Val Acc: 0.9206
 Best site-Sketch                   (3)  | Epoch:30 | Val Acc: 0.8667
 Best site-Sketch                   (3)  | Epoch:30 | Val Acc: 0.8571
 Best site-QuickDraw                (1)  | Epoch:30 | Val Acc: 0.7810
 Best site-QuickDraw                (1)  | Epoch:30 | Val Acc: 0.8032
 Best site-Infograph                (2)  | Epoch:30 | Val Acc: 0.7143
 Best site-Infograph                (2)  | Epoch:30 | Val Acc: 0.7079
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 31 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (2) | Train Loss: 0.5040 | Train Acc: 0.8471
 Site-Clipart                   (2) | Train Loss: 0.4335 | Train Acc: 0.8792
 Site-Real                      (4) | Train Loss: 0.3908 | Train Acc: 0.9172
 Site-Real                      (4) | Train Loss: 0.2384 | Train Acc: 0.9407
 Site-Painting                  (0) | Train Loss: 0.3840 | Train Acc: 0.8981
 Site-Painting                  (0) | Train Loss: 0.3588 | Train Acc: 0.9174
 Site-Sketch                    (5) | Train Loss: 0.4167 | Train Acc: 0.8471
 Site-Sketch                    (5) | Train Loss: 0.4595 | Train Acc: 0.8453
 Site-QuickDraw                 (1) | Train Loss: 0.7164 | Train Acc: 0.7834
 Site-QuickDraw                 (1) | Train Loss: 0.7063 | Train Acc: 0.8093
 Site-Infograph                 (3) | Train Loss: 1.1891 | Train Acc: 0.6433
 Site-Infograph                 (3) | Train Loss: 0.9356 | Train Acc: 0.7161
Average Train Accuracy: 0.8370
 Site-Clipart                   (2) | Val  Loss: 0.3975 | Val  Acc: 0.8857
 Site-Clipart                   (2) | Val  Loss: 0.4906 | Val  Acc: 0.8571
 Site-Real                      (4) | Val  Loss: 0.3333 | Val  Acc: 0.9048
 Site-Real                      (4) | Val  Loss: 0.2781 | Val  Acc: 0.9429
 Site-Painting                  (0) | Val  Loss: 0.2643 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.3253 | Val  Acc: 0.9238
 Site-Sketch                    (5) | Val  Loss: 0.4617 | Val  Acc: 0.9048
 Site-Sketch                    (5) | Val  Loss: 0.4330 | Val  Acc: 0.8635
 Site-QuickDraw                 (1) | Val  Loss: 0.8041 | Val  Acc: 0.7238
 Site-QuickDraw                 (1) | Val  Loss: 0.7112 | Val  Acc: 0.7873
 Site-Infograph                 (3) | Val  Loss: 0.9479 | Val  Acc: 0.7143
 Site-Infograph                 (3) | Val  Loss: 0.9331 | Val  Acc: 0.7111
Average Valid Accuracy: 0.8460
============ Train epoch 32 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (2) | Train Loss: 0.5046 | Train Acc: 0.8599
 Site-Clipart                   (2) | Train Loss: 0.4266 | Train Acc: 0.9004
 Site-Real                      (4) | Train Loss: 0.3075 | Train Acc: 0.9236
 Site-Real                      (4) | Train Loss: 0.2594 | Train Acc: 0.9470
 Site-Painting                  (3) | Train Loss: 0.3681 | Train Acc: 0.9108
 Site-Painting                  (3) | Train Loss: 0.3411 | Train Acc: 0.9131
 Site-Sketch                    (5) | Train Loss: 0.4256 | Train Acc: 0.8344
 Site-Sketch                    (5) | Train Loss: 0.4353 | Train Acc: 0.8665
 Site-QuickDraw                 (1) | Train Loss: 0.7227 | Train Acc: 0.7389
 Site-QuickDraw                 (1) | Train Loss: 0.6996 | Train Acc: 0.8199
 Site-Infograph                 (0) | Train Loss: 1.1829 | Train Acc: 0.6306
 Site-Infograph                 (0) | Train Loss: 0.8888 | Train Acc: 0.6992
Average Train Accuracy: 0.8370
 Site-Clipart                   (2) | Val  Loss: 0.3895 | Val  Acc: 0.8952
 Site-Clipart                   (2) | Val  Loss: 0.5045 | Val  Acc: 0.8635
 Site-Real                      (4) | Val  Loss: 0.2892 | Val  Acc: 0.9143
 Site-Real                      (4) | Val  Loss: 0.2789 | Val  Acc: 0.9365
 Site-Painting                  (3) | Val  Loss: 0.2617 | Val  Acc: 0.9524
 Site-Painting                  (3) | Val  Loss: 0.3501 | Val  Acc: 0.9143
 Site-Sketch                    (5) | Val  Loss: 0.4947 | Val  Acc: 0.8667
 Site-Sketch                    (5) | Val  Loss: 0.4415 | Val  Acc: 0.8635
 Site-QuickDraw                 (1) | Val  Loss: 0.7184 | Val  Acc: 0.8000
 Site-QuickDraw                 (1) | Val  Loss: 0.6950 | Val  Acc: 0.8222
 Site-Infograph                 (0) | Val  Loss: 0.9707 | Val  Acc: 0.7143
 Site-Infograph                 (0) | Val  Loss: 0.9256 | Val  Acc: 0.7175
Average Valid Accuracy: 0.8550
 Best site-Clipart                  (2)  | Epoch:32 | Val Acc: 0.8952
 Best site-Clipart                  (2)  | Epoch:32 | Val Acc: 0.8635
 Best site-Real                     (4)  | Epoch:32 | Val Acc: 0.9143
 Best site-Real                     (4)  | Epoch:32 | Val Acc: 0.9365
 Best site-Painting                 (3)  | Epoch:32 | Val Acc: 0.9524
 Best site-Painting                 (3)  | Epoch:32 | Val Acc: 0.9143
 Best site-Sketch                   (5)  | Epoch:32 | Val Acc: 0.8667
 Best site-Sketch                   (5)  | Epoch:32 | Val Acc: 0.8635
 Best site-QuickDraw                (1)  | Epoch:32 | Val Acc: 0.8000
 Best site-QuickDraw                (1)  | Epoch:32 | Val Acc: 0.8222
 Best site-Infograph                (0)  | Epoch:32 | Val Acc: 0.7143
 Best site-Infograph                (0)  | Epoch:32 | Val Acc: 0.7175
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 33 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (0) | Train Loss: 0.4416 | Train Acc: 0.8662
 Site-Clipart                   (0) | Train Loss: 0.4475 | Train Acc: 0.8750
 Site-Real                      (4) | Train Loss: 0.2989 | Train Acc: 0.9299
 Site-Real                      (4) | Train Loss: 0.2310 | Train Acc: 0.9428
 Site-Painting                  (3) | Train Loss: 0.3964 | Train Acc: 0.8917
 Site-Painting                  (3) | Train Loss: 0.3356 | Train Acc: 0.9153
 Site-Sketch                    (5) | Train Loss: 0.4891 | Train Acc: 0.8599
 Site-Sketch                    (5) | Train Loss: 0.4483 | Train Acc: 0.8750
 Site-QuickDraw                 (1) | Train Loss: 0.7675 | Train Acc: 0.7070
 Site-QuickDraw                 (1) | Train Loss: 0.6834 | Train Acc: 0.8093
 Site-Infograph                 (2) | Train Loss: 1.1338 | Train Acc: 0.6688
 Site-Infograph                 (2) | Train Loss: 0.8510 | Train Acc: 0.7288
Average Train Accuracy: 0.8391
 Site-Clipart                   (0) | Val  Loss: 0.4140 | Val  Acc: 0.8952
 Site-Clipart                   (0) | Val  Loss: 0.4868 | Val  Acc: 0.8413
 Site-Real                      (4) | Val  Loss: 0.2832 | Val  Acc: 0.9238
 Site-Real                      (4) | Val  Loss: 0.2720 | Val  Acc: 0.9270
 Site-Painting                  (3) | Val  Loss: 0.2652 | Val  Acc: 0.9143
 Site-Painting                  (3) | Val  Loss: 0.3567 | Val  Acc: 0.8984
 Site-Sketch                    (5) | Val  Loss: 0.4794 | Val  Acc: 0.8476
 Site-Sketch                    (5) | Val  Loss: 0.4498 | Val  Acc: 0.8635
 Site-QuickDraw                 (1) | Val  Loss: 0.7307 | Val  Acc: 0.8000
 Site-QuickDraw                 (1) | Val  Loss: 0.6828 | Val  Acc: 0.8159
 Site-Infograph                 (2) | Val  Loss: 0.9170 | Val  Acc: 0.7333
 Site-Infograph                 (2) | Val  Loss: 0.9487 | Val  Acc: 0.6984
Average Valid Accuracy: 0.8466
============ Train epoch 34 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (4) | Train Loss: 0.4565 | Train Acc: 0.8471
 Site-Clipart                   (4) | Train Loss: 0.4350 | Train Acc: 0.8835
 Site-Real                      (5) | Train Loss: 0.3045 | Train Acc: 0.9172
 Site-Real                      (5) | Train Loss: 0.2282 | Train Acc: 0.9428
 Site-Painting                  (0) | Train Loss: 0.3538 | Train Acc: 0.9108
 Site-Painting                  (0) | Train Loss: 0.3361 | Train Acc: 0.9174
 Site-Sketch                    (2) | Train Loss: 0.4159 | Train Acc: 0.8344
 Site-Sketch                    (2) | Train Loss: 0.4262 | Train Acc: 0.8623
 Site-QuickDraw                 (1) | Train Loss: 0.6548 | Train Acc: 0.7643
 Site-QuickDraw                 (1) | Train Loss: 0.7137 | Train Acc: 0.8199
 Site-Infograph                 (3) | Train Loss: 1.1112 | Train Acc: 0.6815
 Site-Infograph                 (3) | Train Loss: 0.8585 | Train Acc: 0.7182
Average Train Accuracy: 0.8416
 Site-Clipart                   (4) | Val  Loss: 0.4035 | Val  Acc: 0.8857
 Site-Clipart                   (4) | Val  Loss: 0.5126 | Val  Acc: 0.8413
 Site-Real                      (5) | Val  Loss: 0.2950 | Val  Acc: 0.9143
 Site-Real                      (5) | Val  Loss: 0.2467 | Val  Acc: 0.9365
 Site-Painting                  (0) | Val  Loss: 0.2442 | Val  Acc: 0.9619
 Site-Painting                  (0) | Val  Loss: 0.3386 | Val  Acc: 0.9143
 Site-Sketch                    (2) | Val  Loss: 0.4511 | Val  Acc: 0.8762
 Site-Sketch                    (2) | Val  Loss: 0.4174 | Val  Acc: 0.8952
 Site-QuickDraw                 (1) | Val  Loss: 0.7740 | Val  Acc: 0.7810
 Site-QuickDraw                 (1) | Val  Loss: 0.6641 | Val  Acc: 0.8190
 Site-Infograph                 (3) | Val  Loss: 0.9963 | Val  Acc: 0.7143
 Site-Infograph                 (3) | Val  Loss: 0.9470 | Val  Acc: 0.6889
Average Valid Accuracy: 0.8524
============ Train epoch 35 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (4) | Train Loss: 0.4704 | Train Acc: 0.8535
 Site-Clipart                   (4) | Train Loss: 0.4168 | Train Acc: 0.8792
 Site-Real                      (3) | Train Loss: 0.2667 | Train Acc: 0.9236
 Site-Real                      (3) | Train Loss: 0.2232 | Train Acc: 0.9513
 Site-Painting                  (5) | Train Loss: 0.3955 | Train Acc: 0.8790
 Site-Painting                  (5) | Train Loss: 0.3635 | Train Acc: 0.8919
 Site-Sketch                    (0) | Train Loss: 0.4715 | Train Acc: 0.8599
 Site-Sketch                    (0) | Train Loss: 0.4371 | Train Acc: 0.8496
 Site-QuickDraw                 (1) | Train Loss: 0.6956 | Train Acc: 0.8089
 Site-QuickDraw                 (1) | Train Loss: 0.6413 | Train Acc: 0.8347
 Site-Infograph                 (2) | Train Loss: 1.1588 | Train Acc: 0.6306
 Site-Infograph                 (2) | Train Loss: 0.8387 | Train Acc: 0.7542
Average Train Accuracy: 0.8430
 Site-Clipart                   (4) | Val  Loss: 0.3823 | Val  Acc: 0.8857
 Site-Clipart                   (4) | Val  Loss: 0.4671 | Val  Acc: 0.8540
 Site-Real                      (3) | Val  Loss: 0.2981 | Val  Acc: 0.9143
 Site-Real                      (3) | Val  Loss: 0.2400 | Val  Acc: 0.9492
 Site-Painting                  (5) | Val  Loss: 0.2330 | Val  Acc: 0.9619
 Site-Painting                  (5) | Val  Loss: 0.3299 | Val  Acc: 0.9048
 Site-Sketch                    (0) | Val  Loss: 0.4912 | Val  Acc: 0.8857
 Site-Sketch                    (0) | Val  Loss: 0.3974 | Val  Acc: 0.8825
 Site-QuickDraw                 (1) | Val  Loss: 0.6973 | Val  Acc: 0.8000
 Site-QuickDraw                 (1) | Val  Loss: 0.6779 | Val  Acc: 0.8159
 Site-Infograph                 (2) | Val  Loss: 0.9289 | Val  Acc: 0.7238
 Site-Infograph                 (2) | Val  Loss: 0.9115 | Val  Acc: 0.7175
Average Valid Accuracy: 0.8579
 Best site-Clipart                  (4)  | Epoch:35 | Val Acc: 0.8857
 Best site-Clipart                  (4)  | Epoch:35 | Val Acc: 0.8540
 Best site-Real                     (3)  | Epoch:35 | Val Acc: 0.9143
 Best site-Real                     (3)  | Epoch:35 | Val Acc: 0.9492
 Best site-Painting                 (5)  | Epoch:35 | Val Acc: 0.9619
 Best site-Painting                 (5)  | Epoch:35 | Val Acc: 0.9048
 Best site-Sketch                   (0)  | Epoch:35 | Val Acc: 0.8857
 Best site-Sketch                   (0)  | Epoch:35 | Val Acc: 0.8825
 Best site-QuickDraw                (1)  | Epoch:35 | Val Acc: 0.8000
 Best site-QuickDraw                (1)  | Epoch:35 | Val Acc: 0.8159
 Best site-Infograph                (2)  | Epoch:35 | Val Acc: 0.7238
 Best site-Infograph                (2)  | Epoch:35 | Val Acc: 0.7175
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 36 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (5) | Train Loss: 0.4035 | Train Acc: 0.8662
 Site-Clipart                   (5) | Train Loss: 0.4444 | Train Acc: 0.8771
 Site-Real                      (0) | Train Loss: 0.3262 | Train Acc: 0.9363
 Site-Real                      (0) | Train Loss: 0.2318 | Train Acc: 0.9449
 Site-Painting                  (4) | Train Loss: 0.4238 | Train Acc: 0.8790
 Site-Painting                  (4) | Train Loss: 0.3496 | Train Acc: 0.9047
 Site-Sketch                    (3) | Train Loss: 0.4282 | Train Acc: 0.8471
 Site-Sketch                    (3) | Train Loss: 0.4478 | Train Acc: 0.8750
 Site-QuickDraw                 (1) | Train Loss: 0.6738 | Train Acc: 0.7834
 Site-QuickDraw                 (1) | Train Loss: 0.6580 | Train Acc: 0.8178
 Site-Infograph                 (2) | Train Loss: 1.1077 | Train Acc: 0.6879
 Site-Infograph                 (2) | Train Loss: 0.7914 | Train Acc: 0.7458
Average Train Accuracy: 0.8471
 Site-Clipart                   (5) | Val  Loss: 0.4178 | Val  Acc: 0.8857
 Site-Clipart                   (5) | Val  Loss: 0.4796 | Val  Acc: 0.8476
 Site-Real                      (0) | Val  Loss: 0.2476 | Val  Acc: 0.9429
 Site-Real                      (0) | Val  Loss: 0.2622 | Val  Acc: 0.9365
 Site-Painting                  (4) | Val  Loss: 0.2336 | Val  Acc: 0.9429
 Site-Painting                  (4) | Val  Loss: 0.2979 | Val  Acc: 0.9333
 Site-Sketch                    (3) | Val  Loss: 0.4692 | Val  Acc: 0.8571
 Site-Sketch                    (3) | Val  Loss: 0.4143 | Val  Acc: 0.8857
 Site-QuickDraw                 (1) | Val  Loss: 0.6706 | Val  Acc: 0.8190
 Site-QuickDraw                 (1) | Val  Loss: 0.6840 | Val  Acc: 0.8127
 Site-Infograph                 (2) | Val  Loss: 0.9073 | Val  Acc: 0.7238
 Site-Infograph                 (2) | Val  Loss: 0.8895 | Val  Acc: 0.7365
Average Valid Accuracy: 0.8603
 Best site-Clipart                  (5)  | Epoch:36 | Val Acc: 0.8857
 Best site-Clipart                  (5)  | Epoch:36 | Val Acc: 0.8476
 Best site-Real                     (0)  | Epoch:36 | Val Acc: 0.9429
 Best site-Real                     (0)  | Epoch:36 | Val Acc: 0.9365
 Best site-Painting                 (4)  | Epoch:36 | Val Acc: 0.9429
 Best site-Painting                 (4)  | Epoch:36 | Val Acc: 0.9333
 Best site-Sketch                   (3)  | Epoch:36 | Val Acc: 0.8571
 Best site-Sketch                   (3)  | Epoch:36 | Val Acc: 0.8857
 Best site-QuickDraw                (1)  | Epoch:36 | Val Acc: 0.8190
 Best site-QuickDraw                (1)  | Epoch:36 | Val Acc: 0.8127
 Best site-Infograph                (2)  | Epoch:36 | Val Acc: 0.7238
 Best site-Infograph                (2)  | Epoch:36 | Val Acc: 0.7365
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 37 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (0) | Train Loss: 0.4994 | Train Acc: 0.8408
 Site-Clipart                   (0) | Train Loss: 0.4101 | Train Acc: 0.8750
 Site-Real                      (5) | Train Loss: 0.3190 | Train Acc: 0.9299
 Site-Real                      (5) | Train Loss: 0.2209 | Train Acc: 0.9449
 Site-Painting                  (3) | Train Loss: 0.3857 | Train Acc: 0.9108
 Site-Painting                  (3) | Train Loss: 0.3234 | Train Acc: 0.9047
 Site-Sketch                    (4) | Train Loss: 0.4171 | Train Acc: 0.8662
 Site-Sketch                    (4) | Train Loss: 0.4065 | Train Acc: 0.8750
 Site-QuickDraw                 (1) | Train Loss: 0.6673 | Train Acc: 0.8025
 Site-QuickDraw                 (1) | Train Loss: 0.6301 | Train Acc: 0.8347
 Site-Infograph                 (2) | Train Loss: 1.0934 | Train Acc: 0.6688
 Site-Infograph                 (2) | Train Loss: 0.8123 | Train Acc: 0.7394
Average Train Accuracy: 0.8494
 Site-Clipart                   (0) | Val  Loss: 0.3885 | Val  Acc: 0.8857
 Site-Clipart                   (0) | Val  Loss: 0.4364 | Val  Acc: 0.8730
 Site-Real                      (5) | Val  Loss: 0.2639 | Val  Acc: 0.9048
 Site-Real                      (5) | Val  Loss: 0.2526 | Val  Acc: 0.9365
 Site-Painting                  (3) | Val  Loss: 0.2237 | Val  Acc: 0.9429
 Site-Painting                  (3) | Val  Loss: 0.3161 | Val  Acc: 0.8984
 Site-Sketch                    (4) | Val  Loss: 0.4298 | Val  Acc: 0.8857
 Site-Sketch                    (4) | Val  Loss: 0.4014 | Val  Acc: 0.8667
 Site-QuickDraw                 (1) | Val  Loss: 0.6674 | Val  Acc: 0.8190
 Site-QuickDraw                 (1) | Val  Loss: 0.6683 | Val  Acc: 0.8254
 Site-Infograph                 (2) | Val  Loss: 0.9539 | Val  Acc: 0.7333
 Site-Infograph                 (2) | Val  Loss: 0.8949 | Val  Acc: 0.7270
Average Valid Accuracy: 0.8582
============ Train epoch 38 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (2) | Train Loss: 0.4806 | Train Acc: 0.8599
 Site-Clipart                   (2) | Train Loss: 0.4187 | Train Acc: 0.8792
 Site-Real                      (5) | Train Loss: 0.2630 | Train Acc: 0.9363
 Site-Real                      (5) | Train Loss: 0.2186 | Train Acc: 0.9449
 Site-Painting                  (3) | Train Loss: 0.3440 | Train Acc: 0.9172
 Site-Painting                  (3) | Train Loss: 0.3196 | Train Acc: 0.9153
 Site-Sketch                    (4) | Train Loss: 0.4024 | Train Acc: 0.8854
 Site-Sketch                    (4) | Train Loss: 0.3913 | Train Acc: 0.8729
 Site-QuickDraw                 (1) | Train Loss: 0.7342 | Train Acc: 0.7452
 Site-QuickDraw                 (1) | Train Loss: 0.6190 | Train Acc: 0.8220
 Site-Infograph                 (0) | Train Loss: 1.1149 | Train Acc: 0.6369
 Site-Infograph                 (0) | Train Loss: 0.8278 | Train Acc: 0.7585
Average Train Accuracy: 0.8478
 Site-Clipart                   (2) | Val  Loss: 0.3899 | Val  Acc: 0.8952
 Site-Clipart                   (2) | Val  Loss: 0.4357 | Val  Acc: 0.8540
 Site-Real                      (5) | Val  Loss: 0.2810 | Val  Acc: 0.9238
 Site-Real                      (5) | Val  Loss: 0.2454 | Val  Acc: 0.9492
 Site-Painting                  (3) | Val  Loss: 0.2384 | Val  Acc: 0.9238
 Site-Painting                  (3) | Val  Loss: 0.2974 | Val  Acc: 0.9206
 Site-Sketch                    (4) | Val  Loss: 0.4411 | Val  Acc: 0.9048
 Site-Sketch                    (4) | Val  Loss: 0.4255 | Val  Acc: 0.8889
 Site-QuickDraw                 (1) | Val  Loss: 0.7036 | Val  Acc: 0.7619
 Site-QuickDraw                 (1) | Val  Loss: 0.6305 | Val  Acc: 0.8508
 Site-Infograph                 (0) | Val  Loss: 0.9055 | Val  Acc: 0.7429
 Site-Infograph                 (0) | Val  Loss: 0.8788 | Val  Acc: 0.7238
Average Valid Accuracy: 0.8616
 Best site-Clipart                  (2)  | Epoch:38 | Val Acc: 0.8952
 Best site-Clipart                  (2)  | Epoch:38 | Val Acc: 0.8540
 Best site-Real                     (5)  | Epoch:38 | Val Acc: 0.9238
 Best site-Real                     (5)  | Epoch:38 | Val Acc: 0.9492
 Best site-Painting                 (3)  | Epoch:38 | Val Acc: 0.9238
 Best site-Painting                 (3)  | Epoch:38 | Val Acc: 0.9206
 Best site-Sketch                   (4)  | Epoch:38 | Val Acc: 0.9048
 Best site-Sketch                   (4)  | Epoch:38 | Val Acc: 0.8889
 Best site-QuickDraw                (1)  | Epoch:38 | Val Acc: 0.7619
 Best site-QuickDraw                (1)  | Epoch:38 | Val Acc: 0.8508
 Best site-Infograph                (0)  | Epoch:38 | Val Acc: 0.7429
 Best site-Infograph                (0)  | Epoch:38 | Val Acc: 0.7238
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 39 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (5) | Train Loss: 0.4349 | Train Acc: 0.8726
 Site-Clipart                   (5) | Train Loss: 0.4062 | Train Acc: 0.8856
 Site-Real                      (0) | Train Loss: 0.3080 | Train Acc: 0.9299
 Site-Real                      (0) | Train Loss: 0.2006 | Train Acc: 0.9555
 Site-Painting                  (4) | Train Loss: 0.3793 | Train Acc: 0.8790
 Site-Painting                  (4) | Train Loss: 0.2807 | Train Acc: 0.9280
 Site-Sketch                    (3) | Train Loss: 0.4205 | Train Acc: 0.8790
 Site-Sketch                    (3) | Train Loss: 0.4145 | Train Acc: 0.8771
 Site-QuickDraw                 (1) | Train Loss: 0.6564 | Train Acc: 0.8217
 Site-QuickDraw                 (1) | Train Loss: 0.6556 | Train Acc: 0.8093
 Site-Infograph                 (2) | Train Loss: 1.1290 | Train Acc: 0.6497
 Site-Infograph                 (2) | Train Loss: 0.8135 | Train Acc: 0.7373
Average Train Accuracy: 0.8521
 Site-Clipart                   (5) | Val  Loss: 0.3320 | Val  Acc: 0.9238
 Site-Clipart                   (5) | Val  Loss: 0.4445 | Val  Acc: 0.8762
 Site-Real                      (0) | Val  Loss: 0.2924 | Val  Acc: 0.9143
 Site-Real                      (0) | Val  Loss: 0.2381 | Val  Acc: 0.9460
 Site-Painting                  (4) | Val  Loss: 0.2240 | Val  Acc: 0.9143
 Site-Painting                  (4) | Val  Loss: 0.3055 | Val  Acc: 0.9206
 Site-Sketch                    (3) | Val  Loss: 0.4004 | Val  Acc: 0.8857
 Site-Sketch                    (3) | Val  Loss: 0.3963 | Val  Acc: 0.8698
 Site-QuickDraw                 (1) | Val  Loss: 0.6215 | Val  Acc: 0.8476
 Site-QuickDraw                 (1) | Val  Loss: 0.6175 | Val  Acc: 0.8476
 Site-Infograph                 (2) | Val  Loss: 0.9052 | Val  Acc: 0.7048
 Site-Infograph                 (2) | Val  Loss: 0.8490 | Val  Acc: 0.7333
Average Valid Accuracy: 0.8653
 Best site-Clipart                  (5)  | Epoch:39 | Val Acc: 0.9238
 Best site-Clipart                  (5)  | Epoch:39 | Val Acc: 0.8762
 Best site-Real                     (0)  | Epoch:39 | Val Acc: 0.9143
 Best site-Real                     (0)  | Epoch:39 | Val Acc: 0.9460
 Best site-Painting                 (4)  | Epoch:39 | Val Acc: 0.9143
 Best site-Painting                 (4)  | Epoch:39 | Val Acc: 0.9206
 Best site-Sketch                   (3)  | Epoch:39 | Val Acc: 0.8857
 Best site-Sketch                   (3)  | Epoch:39 | Val Acc: 0.8698
 Best site-QuickDraw                (1)  | Epoch:39 | Val Acc: 0.8476
 Best site-QuickDraw                (1)  | Epoch:39 | Val Acc: 0.8476
 Best site-Infograph                (2)  | Epoch:39 | Val Acc: 0.7048
 Best site-Infograph                (2)  | Epoch:39 | Val Acc: 0.7333
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (0) | Train Loss: 0.5217 | Train Acc: 0.8662
 Site-Clipart                   (0) | Train Loss: 0.4035 | Train Acc: 0.8856
 Site-Real                      (5) | Train Loss: 0.3226 | Train Acc: 0.9236
 Site-Real                      (5) | Train Loss: 0.2329 | Train Acc: 0.9428
 Site-Painting                  (3) | Train Loss: 0.3088 | Train Acc: 0.8917
 Site-Painting                  (3) | Train Loss: 0.3022 | Train Acc: 0.9047
 Site-Sketch                    (4) | Train Loss: 0.4289 | Train Acc: 0.8662
 Site-Sketch                    (4) | Train Loss: 0.4041 | Train Acc: 0.8581
 Site-QuickDraw                 (1) | Train Loss: 0.6743 | Train Acc: 0.7834
 Site-QuickDraw                 (1) | Train Loss: 0.6438 | Train Acc: 0.8347
 Site-Infograph                 (2) | Train Loss: 1.1604 | Train Acc: 0.6497
 Site-Infograph                 (2) | Train Loss: 0.8514 | Train Acc: 0.7500
Average Train Accuracy: 0.8464
 Site-Clipart                   (0) | Val  Loss: 0.3708 | Val  Acc: 0.8952
 Site-Clipart                   (0) | Val  Loss: 0.4675 | Val  Acc: 0.8603
 Site-Real                      (5) | Val  Loss: 0.2861 | Val  Acc: 0.9143
 Site-Real                      (5) | Val  Loss: 0.2576 | Val  Acc: 0.9397
 Site-Painting                  (3) | Val  Loss: 0.2383 | Val  Acc: 0.9429
 Site-Painting                  (3) | Val  Loss: 0.3204 | Val  Acc: 0.9206
 Site-Sketch                    (4) | Val  Loss: 0.4148 | Val  Acc: 0.8762
 Site-Sketch                    (4) | Val  Loss: 0.3780 | Val  Acc: 0.8825
 Site-QuickDraw                 (1) | Val  Loss: 0.6820 | Val  Acc: 0.7619
 Site-QuickDraw                 (1) | Val  Loss: 0.6538 | Val  Acc: 0.8349
 Site-Infograph                 (2) | Val  Loss: 0.8852 | Val  Acc: 0.7238
 Site-Infograph                 (2) | Val  Loss: 0.8737 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8556
 Test site-Clipart                   (0)| Epoch:39 | Test Acc: 0.8593
 Test site-Real                      (5)| Epoch:39 | Test Acc: 0.9359
 Test site-Painting                  (3)| Epoch:39 | Test Acc: 0.9225
 Test site-Sketch                    (4)| Epoch:39 | Test Acc: 0.8791
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.7930
 Test site-Infograph                 (2)| Epoch:39 | Test Acc: 0.6225
Clipart: 0.8593, Real: 0.9359, Painting: 0.9225, Sketch: 0.8791, QuickDraw: 0.7930, Infograph: 0.6225, 
Average Test Accuracy(group): 0.8354, Average Test Accuracy(individual): 0.8354,
domain std=0.1059, cluster std=0.1059, individual std=0.1059, 
Average Test Accuracy: 0.8354
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 41 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                   (3) | Train Loss: 0.4456 | Train Acc: 0.8662
 Site-Clipart                   (3) | Train Loss: 0.4138 | Train Acc: 0.8792
 Site-Real                      (4) | Train Loss: 0.2834 | Train Acc: 0.9236
 Site-Real                      (4) | Train Loss: 0.2307 | Train Acc: 0.9407
 Site-Painting                  (0) | Train Loss: 0.3523 | Train Acc: 0.9236
 Site-Painting                  (0) | Train Loss: 0.2889 | Train Acc: 0.9343
 Site-Sketch                    (5) | Train Loss: 0.3771 | Train Acc: 0.8981
 Site-Sketch                    (5) | Train Loss: 0.3650 | Train Acc: 0.8729
 Site-QuickDraw                 (1) | Train Loss: 0.6714 | Train Acc: 0.7962
 Site-QuickDraw                 (1) | Train Loss: 0.6317 | Train Acc: 0.8369
 Site-Infograph                 (2) | Train Loss: 1.0881 | Train Acc: 0.6752
 Site-Infograph                 (2) | Train Loss: 0.7966 | Train Acc: 0.7458
Average Train Accuracy: 0.8577
 Site-Clipart                   (3) | Val  Loss: 0.3545 | Val  Acc: 0.9238
 Site-Clipart                   (3) | Val  Loss: 0.4737 | Val  Acc: 0.8508
 Site-Real                      (4) | Val  Loss: 0.2774 | Val  Acc: 0.9238
 Site-Real                      (4) | Val  Loss: 0.2674 | Val  Acc: 0.9365
 Site-Painting                  (0) | Val  Loss: 0.1911 | Val  Acc: 0.9619
 Site-Painting                  (0) | Val  Loss: 0.3122 | Val  Acc: 0.9270
 Site-Sketch                    (5) | Val  Loss: 0.4106 | Val  Acc: 0.8762
 Site-Sketch                    (5) | Val  Loss: 0.3950 | Val  Acc: 0.8730
 Site-QuickDraw                 (1) | Val  Loss: 0.6531 | Val  Acc: 0.8190
 Site-QuickDraw                 (1) | Val  Loss: 0.6282 | Val  Acc: 0.8254
 Site-Infograph                 (2) | Val  Loss: 0.9218 | Val  Acc: 0.7143
 Site-Infograph                 (2) | Val  Loss: 0.8931 | Val  Acc: 0.7079
Average Valid Accuracy: 0.8616
 Test site-Clipart                   (3)| Epoch:40 | Test Acc: 0.8593
 Test site-Real                      (4)| Epoch:40 | Test Acc: 0.9376
 Test site-Painting                  (0)| Epoch:40 | Test Acc: 0.9257
 Test site-Sketch                    (5)| Epoch:40 | Test Acc: 0.8827
 Test site-QuickDraw                 (1)| Epoch:40 | Test Acc: 0.7920
 Test site-Infograph                 (2)| Epoch:40 | Test Acc: 0.6149
Clipart: 0.8593, Real: 0.9376, Painting: 0.9257, Sketch: 0.8827, QuickDraw: 0.7920, Infograph: 0.6149, 
Average Test Accuracy(group): 0.8354, Average Test Accuracy(individual): 0.8354,
domain std=0.1095, cluster std=0.1095, individual std=0.1095, 
Average Test Accuracy: 0.8354
============ Train epoch 42 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                   (4) | Train Loss: 0.4728 | Train Acc: 0.8726
 Site-Clipart                   (4) | Train Loss: 0.4048 | Train Acc: 0.8792
 Site-Real                      (0) | Train Loss: 0.3292 | Train Acc: 0.9172
 Site-Real                      (0) | Train Loss: 0.2129 | Train Acc: 0.9470
 Site-Painting                  (2) | Train Loss: 0.3717 | Train Acc: 0.9045
 Site-Painting                  (2) | Train Loss: 0.3036 | Train Acc: 0.9216
 Site-Sketch                    (5) | Train Loss: 0.3657 | Train Acc: 0.8917
 Site-Sketch                    (5) | Train Loss: 0.4041 | Train Acc: 0.8686
 Site-QuickDraw                 (1) | Train Loss: 0.6425 | Train Acc: 0.7834
 Site-QuickDraw                 (1) | Train Loss: 0.5986 | Train Acc: 0.8114
 Site-Infograph                 (3) | Train Loss: 1.0587 | Train Acc: 0.6561
 Site-Infograph                 (3) | Train Loss: 0.8034 | Train Acc: 0.7585
Average Train Accuracy: 0.8510
 Site-Clipart                   (4) | Val  Loss: 0.3801 | Val  Acc: 0.9048
 Site-Clipart                   (4) | Val  Loss: 0.4534 | Val  Acc: 0.8635
 Site-Real                      (0) | Val  Loss: 0.2985 | Val  Acc: 0.9238
 Site-Real                      (0) | Val  Loss: 0.2561 | Val  Acc: 0.9397
 Site-Painting                  (2) | Val  Loss: 0.2389 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.3075 | Val  Acc: 0.9175
 Site-Sketch                    (5) | Val  Loss: 0.4060 | Val  Acc: 0.8952
 Site-Sketch                    (5) | Val  Loss: 0.3950 | Val  Acc: 0.8825
 Site-QuickDraw                 (1) | Val  Loss: 0.6816 | Val  Acc: 0.8286
 Site-QuickDraw                 (1) | Val  Loss: 0.6186 | Val  Acc: 0.8476
 Site-Infograph                 (3) | Val  Loss: 0.8147 | Val  Acc: 0.7429
 Site-Infograph                 (3) | Val  Loss: 0.8288 | Val  Acc: 0.7587
Average Valid Accuracy: 0.8714
 Best site-Clipart                  (4)  | Epoch:42 | Val Acc: 0.9048
 Best site-Clipart                  (4)  | Epoch:42 | Val Acc: 0.8635
 Best site-Real                     (0)  | Epoch:42 | Val Acc: 0.9238
 Best site-Real                     (0)  | Epoch:42 | Val Acc: 0.9397
 Best site-Painting                 (2)  | Epoch:42 | Val Acc: 0.9524
 Best site-Painting                 (2)  | Epoch:42 | Val Acc: 0.9175
 Best site-Sketch                   (5)  | Epoch:42 | Val Acc: 0.8952
 Best site-Sketch                   (5)  | Epoch:42 | Val Acc: 0.8825
 Best site-QuickDraw                (1)  | Epoch:42 | Val Acc: 0.8286
 Best site-QuickDraw                (1)  | Epoch:42 | Val Acc: 0.8476
 Best site-Infograph                (3)  | Epoch:42 | Val Acc: 0.7429
 Best site-Infograph                (3)  | Epoch:42 | Val Acc: 0.7587
 Test site-Clipart                   (4)| Epoch:42 | Test Acc: 0.8726
 Test site-Real                      (0)| Epoch:42 | Test Acc: 0.9408
 Test site-Painting                  (2)| Epoch:42 | Test Acc: 0.9176
 Test site-Sketch                    (5)| Epoch:42 | Test Acc: 0.8791
 Test site-QuickDraw                 (1)| Epoch:42 | Test Acc: 0.7990
 Test site-Infograph                 (3)| Epoch:42 | Test Acc: 0.6225
Clipart: 0.8726, Real: 0.9408, Painting: 0.9176, Sketch: 0.8791, QuickDraw: 0.7990, Infograph: 0.6225, 
Average Test Accuracy(group): 0.8386, Average Test Accuracy(individual): 0.8386,
domain std=0.1063, cluster std=0.1063, individual std=0.1063, 
Average Test Accuracy: 0.8386
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 43 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                   (0) | Train Loss: 0.4366 | Train Acc: 0.8790
 Site-Clipart                   (0) | Train Loss: 0.3844 | Train Acc: 0.8814
 Site-Real                      (5) | Train Loss: 0.3054 | Train Acc: 0.9236
 Site-Real                      (5) | Train Loss: 0.2186 | Train Acc: 0.9492
 Site-Painting                  (3) | Train Loss: 0.3600 | Train Acc: 0.8854
 Site-Painting                  (3) | Train Loss: 0.3149 | Train Acc: 0.9131
 Site-Sketch                    (4) | Train Loss: 0.4174 | Train Acc: 0.8662
 Site-Sketch                    (4) | Train Loss: 0.3824 | Train Acc: 0.8856
 Site-QuickDraw                 (1) | Train Loss: 0.6759 | Train Acc: 0.7643
 Site-QuickDraw                 (1) | Train Loss: 0.6334 | Train Acc: 0.8199
 Site-Infograph                 (2) | Train Loss: 1.1044 | Train Acc: 0.6943
 Site-Infograph                 (2) | Train Loss: 0.7829 | Train Acc: 0.7564
Average Train Accuracy: 0.8515
 Site-Clipart                   (0) | Val  Loss: 0.3667 | Val  Acc: 0.9048
 Site-Clipart                   (0) | Val  Loss: 0.4171 | Val  Acc: 0.8762
 Site-Real                      (5) | Val  Loss: 0.2761 | Val  Acc: 0.9048
 Site-Real                      (5) | Val  Loss: 0.2346 | Val  Acc: 0.9429
 Site-Painting                  (3) | Val  Loss: 0.2305 | Val  Acc: 0.9714
 Site-Painting                  (3) | Val  Loss: 0.3055 | Val  Acc: 0.9111
 Site-Sketch                    (4) | Val  Loss: 0.4274 | Val  Acc: 0.8667
 Site-Sketch                    (4) | Val  Loss: 0.3872 | Val  Acc: 0.8889
 Site-QuickDraw                 (1) | Val  Loss: 0.6283 | Val  Acc: 0.8286
 Site-QuickDraw                 (1) | Val  Loss: 0.5964 | Val  Acc: 0.8540
 Site-Infograph                 (2) | Val  Loss: 0.8658 | Val  Acc: 0.7619
 Site-Infograph                 (2) | Val  Loss: 0.8207 | Val  Acc: 0.7556
Average Valid Accuracy: 0.8722
 Best site-Clipart                  (0)  | Epoch:43 | Val Acc: 0.9048
 Best site-Clipart                  (0)  | Epoch:43 | Val Acc: 0.8762
 Best site-Real                     (5)  | Epoch:43 | Val Acc: 0.9048
 Best site-Real                     (5)  | Epoch:43 | Val Acc: 0.9429
 Best site-Painting                 (3)  | Epoch:43 | Val Acc: 0.9714
 Best site-Painting                 (3)  | Epoch:43 | Val Acc: 0.9111
 Best site-Sketch                   (4)  | Epoch:43 | Val Acc: 0.8667
 Best site-Sketch                   (4)  | Epoch:43 | Val Acc: 0.8889
 Best site-QuickDraw                (1)  | Epoch:43 | Val Acc: 0.8286
 Best site-QuickDraw                (1)  | Epoch:43 | Val Acc: 0.8540
 Best site-Infograph                (2)  | Epoch:43 | Val Acc: 0.7619
 Best site-Infograph                (2)  | Epoch:43 | Val Acc: 0.7556
 Test site-Clipart                   (0)| Epoch:43 | Test Acc: 0.8764
 Test site-Real                      (5)| Epoch:43 | Test Acc: 0.9417
 Test site-Painting                  (3)| Epoch:43 | Test Acc: 0.9241
 Test site-Sketch                    (4)| Epoch:43 | Test Acc: 0.8809
 Test site-QuickDraw                 (1)| Epoch:43 | Test Acc: 0.7940
 Test site-Infograph                 (2)| Epoch:43 | Test Acc: 0.6164
Clipart: 0.8764, Real: 0.9417, Painting: 0.9241, Sketch: 0.8809, QuickDraw: 0.7940, Infograph: 0.6164, 
Average Test Accuracy(group): 0.8389, Average Test Accuracy(individual): 0.8389,
domain std=0.1099, cluster std=0.1099, individual std=0.1099, 
Average Test Accuracy: 0.8389
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 44 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                   (3) | Train Loss: 0.3545 | Train Acc: 0.8981
 Site-Clipart                   (3) | Train Loss: 0.4072 | Train Acc: 0.8792
 Site-Real                      (4) | Train Loss: 0.3144 | Train Acc: 0.9172
 Site-Real                      (4) | Train Loss: 0.2267 | Train Acc: 0.9470
 Site-Painting                  (1) | Train Loss: 0.3415 | Train Acc: 0.8981
 Site-Painting                  (1) | Train Loss: 0.2964 | Train Acc: 0.9216
 Site-Sketch                    (5) | Train Loss: 0.4040 | Train Acc: 0.8726
 Site-Sketch                    (5) | Train Loss: 0.3771 | Train Acc: 0.8644
 Site-QuickDraw                 (0) | Train Loss: 0.6584 | Train Acc: 0.8280
 Site-QuickDraw                 (0) | Train Loss: 0.6481 | Train Acc: 0.8326
 Site-Infograph                 (2) | Train Loss: 1.0353 | Train Acc: 0.7134
 Site-Infograph                 (2) | Train Loss: 0.7606 | Train Acc: 0.7542
Average Train Accuracy: 0.8605
 Site-Clipart                   (3) | Val  Loss: 0.3956 | Val  Acc: 0.8762
 Site-Clipart                   (3) | Val  Loss: 0.4393 | Val  Acc: 0.8540
 Site-Real                      (4) | Val  Loss: 0.2658 | Val  Acc: 0.9143
 Site-Real                      (4) | Val  Loss: 0.2502 | Val  Acc: 0.9302
 Site-Painting                  (1) | Val  Loss: 0.2194 | Val  Acc: 0.9524
 Site-Painting                  (1) | Val  Loss: 0.3154 | Val  Acc: 0.9270
 Site-Sketch                    (5) | Val  Loss: 0.3935 | Val  Acc: 0.8571
 Site-Sketch                    (5) | Val  Loss: 0.4009 | Val  Acc: 0.8730
 Site-QuickDraw                 (0) | Val  Loss: 0.6259 | Val  Acc: 0.8000
 Site-QuickDraw                 (0) | Val  Loss: 0.6410 | Val  Acc: 0.8286
 Site-Infograph                 (2) | Val  Loss: 0.7872 | Val  Acc: 0.7333
 Site-Infograph                 (2) | Val  Loss: 0.8211 | Val  Acc: 0.7175
Average Valid Accuracy: 0.8553
 Test site-Clipart                   (3)| Epoch:43 | Test Acc: 0.8745
 Test site-Real                      (4)| Epoch:43 | Test Acc: 0.9392
 Test site-Painting                  (1)| Epoch:43 | Test Acc: 0.9208
 Test site-Sketch                    (5)| Epoch:43 | Test Acc: 0.8827
 Test site-QuickDraw                 (0)| Epoch:43 | Test Acc: 0.7910
 Test site-Infograph                 (2)| Epoch:43 | Test Acc: 0.6195
Clipart: 0.8745, Real: 0.9392, Painting: 0.9208, Sketch: 0.8827, QuickDraw: 0.7910, Infograph: 0.6195, 
Average Test Accuracy(group): 0.8380, Average Test Accuracy(individual): 0.8380,
domain std=0.1083, cluster std=0.1083, individual std=0.1083, 
Average Test Accuracy: 0.8380
============ Train epoch 45 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                   (3) | Train Loss: 0.3851 | Train Acc: 0.8917
 Site-Clipart                   (3) | Train Loss: 0.3708 | Train Acc: 0.8919
 Site-Real                      (5) | Train Loss: 0.3149 | Train Acc: 0.9172
 Site-Real                      (5) | Train Loss: 0.2184 | Train Acc: 0.9470
 Site-Painting                  (0) | Train Loss: 0.3445 | Train Acc: 0.9172
 Site-Painting                  (0) | Train Loss: 0.3159 | Train Acc: 0.9195
 Site-Sketch                    (4) | Train Loss: 0.3502 | Train Acc: 0.8662
 Site-Sketch                    (4) | Train Loss: 0.3882 | Train Acc: 0.8792
 Site-QuickDraw                 (1) | Train Loss: 0.6534 | Train Acc: 0.7516
 Site-QuickDraw                 (1) | Train Loss: 0.5895 | Train Acc: 0.8432
 Site-Infograph                 (2) | Train Loss: 1.0672 | Train Acc: 0.6943
 Site-Infograph                 (2) | Train Loss: 0.7439 | Train Acc: 0.7691
Average Train Accuracy: 0.8574
 Site-Clipart                   (3) | Val  Loss: 0.3584 | Val  Acc: 0.8952
 Site-Clipart                   (3) | Val  Loss: 0.4365 | Val  Acc: 0.8698
 Site-Real                      (5) | Val  Loss: 0.2472 | Val  Acc: 0.9143
 Site-Real                      (5) | Val  Loss: 0.2328 | Val  Acc: 0.9397
 Site-Painting                  (0) | Val  Loss: 0.2324 | Val  Acc: 0.9429
 Site-Painting                  (0) | Val  Loss: 0.2958 | Val  Acc: 0.9206
 Site-Sketch                    (4) | Val  Loss: 0.3887 | Val  Acc: 0.8952
 Site-Sketch                    (4) | Val  Loss: 0.3496 | Val  Acc: 0.9016
 Site-QuickDraw                 (1) | Val  Loss: 0.6162 | Val  Acc: 0.8571
 Site-QuickDraw                 (1) | Val  Loss: 0.5949 | Val  Acc: 0.8413
 Site-Infograph                 (2) | Val  Loss: 0.8529 | Val  Acc: 0.7714
 Site-Infograph                 (2) | Val  Loss: 0.7759 | Val  Acc: 0.7810
Average Valid Accuracy: 0.8775
 Best site-Clipart                  (3)  | Epoch:45 | Val Acc: 0.8952
 Best site-Clipart                  (3)  | Epoch:45 | Val Acc: 0.8698
 Best site-Real                     (5)  | Epoch:45 | Val Acc: 0.9143
 Best site-Real                     (5)  | Epoch:45 | Val Acc: 0.9397
 Best site-Painting                 (0)  | Epoch:45 | Val Acc: 0.9429
 Best site-Painting                 (0)  | Epoch:45 | Val Acc: 0.9206
 Best site-Sketch                   (4)  | Epoch:45 | Val Acc: 0.8952
 Best site-Sketch                   (4)  | Epoch:45 | Val Acc: 0.9016
 Best site-QuickDraw                (1)  | Epoch:45 | Val Acc: 0.8571
 Best site-QuickDraw                (1)  | Epoch:45 | Val Acc: 0.8413
 Best site-Infograph                (2)  | Epoch:45 | Val Acc: 0.7714
 Best site-Infograph                (2)  | Epoch:45 | Val Acc: 0.7810
 Test site-Clipart                   (3)| Epoch:45 | Test Acc: 0.8783
 Test site-Real                      (5)| Epoch:45 | Test Acc: 0.9392
 Test site-Painting                  (0)| Epoch:45 | Test Acc: 0.9192
 Test site-Sketch                    (4)| Epoch:45 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7950
 Test site-Infograph                 (2)| Epoch:45 | Test Acc: 0.6073
Clipart: 0.8783, Real: 0.9392, Painting: 0.9192, Sketch: 0.8917, QuickDraw: 0.7950, Infograph: 0.6073, 
Average Test Accuracy(group): 0.8385, Average Test Accuracy(individual): 0.8385,
domain std=0.1129, cluster std=0.1129, individual std=0.1129, 
Average Test Accuracy: 0.8385
============ Train epoch 46 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                   (4) | Train Loss: 0.4098 | Train Acc: 0.8790
 Site-Clipart                   (4) | Train Loss: 0.4018 | Train Acc: 0.8856
 Site-Real                      (0) | Train Loss: 0.3423 | Train Acc: 0.9236
 Site-Real                      (0) | Train Loss: 0.2097 | Train Acc: 0.9492
 Site-Painting                  (5) | Train Loss: 0.3705 | Train Acc: 0.8726
 Site-Painting                  (5) | Train Loss: 0.3013 | Train Acc: 0.9195
 Site-Sketch                    (3) | Train Loss: 0.3791 | Train Acc: 0.8790
 Site-Sketch                    (3) | Train Loss: 0.3557 | Train Acc: 0.8792
 Site-QuickDraw                 (1) | Train Loss: 0.6562 | Train Acc: 0.7962
 Site-QuickDraw                 (1) | Train Loss: 0.5891 | Train Acc: 0.8178
 Site-Infograph                 (2) | Train Loss: 0.9639 | Train Acc: 0.6943
 Site-Infograph                 (2) | Train Loss: 0.7386 | Train Acc: 0.7627
Average Train Accuracy: 0.8549
 Site-Clipart                   (4) | Val  Loss: 0.3485 | Val  Acc: 0.9048
 Site-Clipart                   (4) | Val  Loss: 0.4552 | Val  Acc: 0.8508
 Site-Real                      (0) | Val  Loss: 0.2440 | Val  Acc: 0.9429
 Site-Real                      (0) | Val  Loss: 0.2266 | Val  Acc: 0.9365
 Site-Painting                  (5) | Val  Loss: 0.2712 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2865 | Val  Acc: 0.9333
 Site-Sketch                    (3) | Val  Loss: 0.3828 | Val  Acc: 0.8857
 Site-Sketch                    (3) | Val  Loss: 0.3862 | Val  Acc: 0.8825
 Site-QuickDraw                 (1) | Val  Loss: 0.7204 | Val  Acc: 0.7333
 Site-QuickDraw                 (1) | Val  Loss: 0.6118 | Val  Acc: 0.8127
 Site-Infograph                 (2) | Val  Loss: 0.7850 | Val  Acc: 0.7524
 Site-Infograph                 (2) | Val  Loss: 0.8564 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8608
 Test site-Clipart                   (4)| Epoch:45 | Test Acc: 0.8745
 Test site-Real                      (0)| Epoch:45 | Test Acc: 0.9408
 Test site-Painting                  (5)| Epoch:45 | Test Acc: 0.9225
 Test site-Sketch                    (3)| Epoch:45 | Test Acc: 0.8827
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7900
 Test site-Infograph                 (2)| Epoch:45 | Test Acc: 0.6073
Clipart: 0.8745, Real: 0.9408, Painting: 0.9225, Sketch: 0.8827, QuickDraw: 0.7900, Infograph: 0.6073, 
Average Test Accuracy(group): 0.8363, Average Test Accuracy(individual): 0.8363,
domain std=0.1129, cluster std=0.1129, individual std=0.1129, 
Average Test Accuracy: 0.8363
============ Train epoch 47 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                   (4) | Train Loss: 0.4225 | Train Acc: 0.8790
 Site-Clipart                   (4) | Train Loss: 0.3917 | Train Acc: 0.8898
 Site-Real                      (5) | Train Loss: 0.2897 | Train Acc: 0.9236
 Site-Real                      (5) | Train Loss: 0.2231 | Train Acc: 0.9470
 Site-Painting                  (3) | Train Loss: 0.3406 | Train Acc: 0.8790
 Site-Painting                  (3) | Train Loss: 0.3186 | Train Acc: 0.9258
 Site-Sketch                    (0) | Train Loss: 0.3776 | Train Acc: 0.8854
 Site-Sketch                    (0) | Train Loss: 0.4314 | Train Acc: 0.8496
 Site-QuickDraw                 (1) | Train Loss: 0.6424 | Train Acc: 0.8153
 Site-QuickDraw                 (1) | Train Loss: 0.5797 | Train Acc: 0.8432
 Site-Infograph                 (2) | Train Loss: 1.1057 | Train Acc: 0.6815
 Site-Infograph                 (2) | Train Loss: 0.7654 | Train Acc: 0.7712
Average Train Accuracy: 0.8575
 Site-Clipart                   (4) | Val  Loss: 0.3241 | Val  Acc: 0.9143
 Site-Clipart                   (4) | Val  Loss: 0.4247 | Val  Acc: 0.8730
 Site-Real                      (5) | Val  Loss: 0.2858 | Val  Acc: 0.9143
 Site-Real                      (5) | Val  Loss: 0.2558 | Val  Acc: 0.9238
 Site-Painting                  (3) | Val  Loss: 0.2530 | Val  Acc: 0.9429
 Site-Painting                  (3) | Val  Loss: 0.2951 | Val  Acc: 0.9397
 Site-Sketch                    (0) | Val  Loss: 0.3431 | Val  Acc: 0.8952
 Site-Sketch                    (0) | Val  Loss: 0.3905 | Val  Acc: 0.8730
 Site-QuickDraw                 (1) | Val  Loss: 0.6977 | Val  Acc: 0.8381
 Site-QuickDraw                 (1) | Val  Loss: 0.5950 | Val  Acc: 0.8444
 Site-Infograph                 (2) | Val  Loss: 0.8166 | Val  Acc: 0.7714
 Site-Infograph                 (2) | Val  Loss: 0.7798 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8728
 Test site-Clipart                   (4)| Epoch:45 | Test Acc: 0.8802
 Test site-Real                      (5)| Epoch:45 | Test Acc: 0.9425
 Test site-Painting                  (3)| Epoch:45 | Test Acc: 0.9225
 Test site-Sketch                    (0)| Epoch:45 | Test Acc: 0.8863
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7940
 Test site-Infograph                 (2)| Epoch:45 | Test Acc: 0.6088
Clipart: 0.8802, Real: 0.9425, Painting: 0.9225, Sketch: 0.8863, QuickDraw: 0.7940, Infograph: 0.6088, 
Average Test Accuracy(group): 0.8390, Average Test Accuracy(individual): 0.8390,
domain std=0.1130, cluster std=0.1130, individual std=0.1130, 
Average Test Accuracy: 0.8390
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 48 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                   (0) | Train Loss: 0.3887 | Train Acc: 0.8790
 Site-Clipart                   (0) | Train Loss: 0.3930 | Train Acc: 0.8792
 Site-Real                      (4) | Train Loss: 0.2589 | Train Acc: 0.9236
 Site-Real                      (4) | Train Loss: 0.2079 | Train Acc: 0.9470
 Site-Painting                  (3) | Train Loss: 0.3260 | Train Acc: 0.8981
 Site-Painting                  (3) | Train Loss: 0.3266 | Train Acc: 0.9131
 Site-Sketch                    (5) | Train Loss: 0.4023 | Train Acc: 0.8981
 Site-Sketch                    (5) | Train Loss: 0.3805 | Train Acc: 0.8814
 Site-QuickDraw                 (1) | Train Loss: 0.6352 | Train Acc: 0.8344
 Site-QuickDraw                 (1) | Train Loss: 0.6079 | Train Acc: 0.8263
 Site-Infograph                 (2) | Train Loss: 1.0686 | Train Acc: 0.6752
 Site-Infograph                 (2) | Train Loss: 0.7447 | Train Acc: 0.7585
Average Train Accuracy: 0.8595
 Site-Clipart                   (0) | Val  Loss: 0.3776 | Val  Acc: 0.9143
 Site-Clipart                   (0) | Val  Loss: 0.4227 | Val  Acc: 0.8794
 Site-Real                      (4) | Val  Loss: 0.2589 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.2249 | Val  Acc: 0.9429
 Site-Painting                  (3) | Val  Loss: 0.2328 | Val  Acc: 0.9524
 Site-Painting                  (3) | Val  Loss: 0.2755 | Val  Acc: 0.9302
 Site-Sketch                    (5) | Val  Loss: 0.3330 | Val  Acc: 0.8762
 Site-Sketch                    (5) | Val  Loss: 0.3921 | Val  Acc: 0.8635
 Site-QuickDraw                 (1) | Val  Loss: 0.6845 | Val  Acc: 0.7905
 Site-QuickDraw                 (1) | Val  Loss: 0.6319 | Val  Acc: 0.8381
 Site-Infograph                 (2) | Val  Loss: 0.8557 | Val  Acc: 0.7429
 Site-Infograph                 (2) | Val  Loss: 0.8033 | Val  Acc: 0.7651
Average Valid Accuracy: 0.8690
 Test site-Clipart                   (0)| Epoch:47 | Test Acc: 0.8783
 Test site-Real                      (4)| Epoch:47 | Test Acc: 0.9425
 Test site-Painting                  (3)| Epoch:47 | Test Acc: 0.9257
 Test site-Sketch                    (5)| Epoch:47 | Test Acc: 0.8845
 Test site-QuickDraw                 (1)| Epoch:47 | Test Acc: 0.7870
 Test site-Infograph                 (2)| Epoch:47 | Test Acc: 0.6164
Clipart: 0.8783, Real: 0.9425, Painting: 0.9257, Sketch: 0.8845, QuickDraw: 0.7870, Infograph: 0.6164, 
Average Test Accuracy(group): 0.8391, Average Test Accuracy(individual): 0.8391,
domain std=0.1111, cluster std=0.1111, individual std=0.1111, 
Average Test Accuracy: 0.8391
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
============ Train epoch 49 ============
cnt=[2, 2, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                   (4) | Train Loss: 0.4070 | Train Acc: 0.8854
 Site-Clipart                   (4) | Train Loss: 0.3653 | Train Acc: 0.8898
 Site-Real                      (0) | Train Loss: 0.2609 | Train Acc: 0.9236
 Site-Real                      (0) | Train Loss: 0.1927 | Train Acc: 0.9513
 Site-Painting                  (5) | Train Loss: 0.3298 | Train Acc: 0.8981
 Site-Painting                  (5) | Train Loss: 0.2597 | Train Acc: 0.9280
 Site-Sketch                    (3) | Train Loss: 0.4063 | Train Acc: 0.8662
 Site-Sketch                    (3) | Train Loss: 0.3980 | Train Acc: 0.8708
 Site-QuickDraw                 (1) | Train Loss: 0.6636 | Train Acc: 0.7898
 Site-QuickDraw                 (1) | Train Loss: 0.5976 | Train Acc: 0.8284
 Site-Infograph                 (2) | Train Loss: 1.0872 | Train Acc: 0.6752
 Site-Infograph                 (2) | Train Loss: 0.7371 | Train Acc: 0.7648
Average Train Accuracy: 0.8559
 Site-Clipart                   (4) | Val  Loss: 0.3458 | Val  Acc: 0.9143
 Site-Clipart                   (4) | Val  Loss: 0.4269 | Val  Acc: 0.8667
 Site-Real                      (0) | Val  Loss: 0.2361 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2265 | Val  Acc: 0.9429
 Site-Painting                  (5) | Val  Loss: 0.1989 | Val  Acc: 0.9619
 Site-Painting                  (5) | Val  Loss: 0.3051 | Val  Acc: 0.9206
 Site-Sketch                    (3) | Val  Loss: 0.3689 | Val  Acc: 0.8952
 Site-Sketch                    (3) | Val  Loss: 0.3611 | Val  Acc: 0.8794
 Site-QuickDraw                 (1) | Val  Loss: 0.6794 | Val  Acc: 0.8000
 Site-QuickDraw                 (1) | Val  Loss: 0.5641 | Val  Acc: 0.8540
 Site-Infograph                 (2) | Val  Loss: 0.8326 | Val  Acc: 0.7429
 Site-Infograph                 (2) | Val  Loss: 0.8139 | Val  Acc: 0.7302
Average Valid Accuracy: 0.8701
 Test site-Clipart                   (4)| Epoch:48 | Test Acc: 0.8783
 Test site-Real                      (0)| Epoch:48 | Test Acc: 0.9449
 Test site-Painting                  (5)| Epoch:48 | Test Acc: 0.9257
 Test site-Sketch                    (3)| Epoch:48 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:48 | Test Acc: 0.7860
 Test site-Infograph                 (2)| Epoch:48 | Test Acc: 0.6119
Clipart: 0.8783, Real: 0.9449, Painting: 0.9257, Sketch: 0.8917, QuickDraw: 0.7860, Infograph: 0.6119, 
Average Test Accuracy(group): 0.8398, Average Test Accuracy(individual): 0.8398,
domain std=0.1136, cluster std=0.1136, individual std=0.1136, 
Average Test Accuracy: 0.8398
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/ccop_q=1...
===2023-07-30 13:56:23===
===2023-07-30 13:56:38===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (4)| Epoch:49 | Test Acc: 0.8783
 Test site-Real                      (0)| Epoch:49 | Test Acc: 0.9449
 Test site-Painting                  (5)| Epoch:49 | Test Acc: 0.9257
 Test site-Sketch                    (3)| Epoch:49 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:49 | Test Acc: 0.7860
 Test site-Infograph                 (2)| Epoch:49 | Test Acc: 0.6119
Clipart: 0.8783, Real: 0.9449, Painting: 0.9257, Sketch: 0.8917, QuickDraw: 0.7860, Infograph: 0.6119, 
Average Test Accuracy(group): 0.8398, Average Test Accuracy(individual): 0.8398,
domain std=0.1136, cluster std=0.1136, individual std=0.1136, 
