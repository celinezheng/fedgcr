===2023-07-30 06:27:16===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 1.3137 | Train Acc: 0.7707
 Site-Clipart                       | Train Loss: 1.2914 | Train Acc: 0.8008
 Site-Real                          | Train Loss: 1.0559 | Train Acc: 0.8981
 Site-Real                          | Train Loss: 0.9666 | Train Acc: 0.9449
 Site-Painting                      | Train Loss: 1.2040 | Train Acc: 0.8153
 Site-Painting                      | Train Loss: 1.1750 | Train Acc: 0.8390
 Site-Sketch                        | Train Loss: 1.3890 | Train Acc: 0.6879
 Site-Sketch                        | Train Loss: 1.2219 | Train Acc: 0.7394
 Site-QuickDraw                     | Train Loss: 1.9311 | Train Acc: 0.4204
 Site-QuickDraw                     | Train Loss: 1.9421 | Train Acc: 0.3962
 Site-Infograph                     | Train Loss: 1.8395 | Train Acc: 0.4968
 Site-Infograph                     | Train Loss: 1.8104 | Train Acc: 0.5106
Average Train Accuracy: 0.6933
 Site-Clipart                       | Val  Loss: 1.3232 | Val  Acc: 0.7905
 Site-Clipart                       | Val  Loss: 1.3315 | Val  Acc: 0.7841
 Site-Real                          | Val  Loss: 0.9739 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.9852 | Val  Acc: 0.9556
 Site-Painting                      | Val  Loss: 1.1008 | Val  Acc: 0.8762
 Site-Painting                      | Val  Loss: 1.1847 | Val  Acc: 0.8190
 Site-Sketch                        | Val  Loss: 1.2817 | Val  Acc: 0.7143
 Site-Sketch                        | Val  Loss: 1.2638 | Val  Acc: 0.7238
 Site-QuickDraw                     | Val  Loss: 1.9293 | Val  Acc: 0.4571
 Site-QuickDraw                     | Val  Loss: 1.9353 | Val  Acc: 0.4540
 Site-Infograph                     | Val  Loss: 1.8821 | Val  Acc: 0.4667
 Site-Infograph                     | Val  Loss: 1.8372 | Val  Acc: 0.5048
Average Valid Accuracy: 0.7074
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.7905
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.7841
 Best site-Real                      | Epoch:0 | Val Acc: 0.9429
 Best site-Real                      | Epoch:0 | Val Acc: 0.9556
 Best site-Painting                  | Epoch:0 | Val Acc: 0.8762
 Best site-Painting                  | Epoch:0 | Val Acc: 0.8190
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.7143
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.7238
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.4571
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.4540
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.4667
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.5048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 0.9315 | Train Acc: 0.8344
 Site-Clipart                       | Train Loss: 0.8392 | Train Acc: 0.8581
 Site-Real                          | Train Loss: 0.5443 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.4519 | Train Acc: 0.9682
 Site-Painting                      | Train Loss: 0.6553 | Train Acc: 0.8599
 Site-Painting                      | Train Loss: 0.6958 | Train Acc: 0.8856
 Site-Sketch                        | Train Loss: 0.9114 | Train Acc: 0.7452
 Site-Sketch                        | Train Loss: 0.7918 | Train Acc: 0.8008
 Site-QuickDraw                     | Train Loss: 1.7233 | Train Acc: 0.4650
 Site-QuickDraw                     | Train Loss: 1.7189 | Train Acc: 0.4958
 Site-Infograph                     | Train Loss: 1.6868 | Train Acc: 0.4904
 Site-Infograph                     | Train Loss: 1.6086 | Train Acc: 0.5148
Average Train Accuracy: 0.7373
 Site-Clipart                       | Val  Loss: 0.8671 | Val  Acc: 0.8190
 Site-Clipart                       | Val  Loss: 0.8905 | Val  Acc: 0.8413
 Site-Real                          | Val  Loss: 0.4849 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.4774 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.5923 | Val  Acc: 0.9048
 Site-Painting                      | Val  Loss: 0.7208 | Val  Acc: 0.8540
 Site-Sketch                        | Val  Loss: 0.7849 | Val  Acc: 0.8095
 Site-Sketch                        | Val  Loss: 0.8196 | Val  Acc: 0.8063
 Site-QuickDraw                     | Val  Loss: 1.6929 | Val  Acc: 0.4476
 Site-QuickDraw                     | Val  Loss: 1.7148 | Val  Acc: 0.5016
 Site-Infograph                     | Val  Loss: 1.7116 | Val  Acc: 0.4476
 Site-Infograph                     | Val  Loss: 1.6273 | Val  Acc: 0.5048
Average Valid Accuracy: 0.7392
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.8190
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.8413
 Best site-Real                      | Epoch:1 | Val Acc: 0.9714
 Best site-Real                      | Epoch:1 | Val Acc: 0.9619
 Best site-Painting                  | Epoch:1 | Val Acc: 0.9048
 Best site-Painting                  | Epoch:1 | Val Acc: 0.8540
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.8095
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.8063
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.4476
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.5016
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.4476
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.5048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 0.6507 | Train Acc: 0.8599
 Site-Clipart                       | Train Loss: 0.6529 | Train Acc: 0.8729
 Site-Real                          | Train Loss: 0.3734 | Train Acc: 0.9236
 Site-Real                          | Train Loss: 0.2784 | Train Acc: 0.9788
 Site-Painting                      | Train Loss: 0.5581 | Train Acc: 0.8854
 Site-Painting                      | Train Loss: 0.5395 | Train Acc: 0.8856
 Site-Sketch                        | Train Loss: 0.7521 | Train Acc: 0.7898
 Site-Sketch                        | Train Loss: 0.6500 | Train Acc: 0.8136
 Site-QuickDraw                     | Train Loss: 1.5912 | Train Acc: 0.4522
 Site-QuickDraw                     | Train Loss: 1.5593 | Train Acc: 0.5148
 Site-Infograph                     | Train Loss: 1.5881 | Train Acc: 0.4650
 Site-Infograph                     | Train Loss: 1.4841 | Train Acc: 0.5297
Average Train Accuracy: 0.7476
 Site-Clipart                       | Val  Loss: 0.6648 | Val  Acc: 0.8381
 Site-Clipart                       | Val  Loss: 0.6747 | Val  Acc: 0.8825
 Site-Real                          | Val  Loss: 0.3351 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.3156 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.4169 | Val  Acc: 0.9333
 Site-Painting                      | Val  Loss: 0.5535 | Val  Acc: 0.8762
 Site-Sketch                        | Val  Loss: 0.6256 | Val  Acc: 0.8000
 Site-Sketch                        | Val  Loss: 0.7089 | Val  Acc: 0.7841
 Site-QuickDraw                     | Val  Loss: 1.6184 | Val  Acc: 0.4286
 Site-QuickDraw                     | Val  Loss: 1.5614 | Val  Acc: 0.5270
 Site-Infograph                     | Val  Loss: 1.6586 | Val  Acc: 0.4762
 Site-Infograph                     | Val  Loss: 1.5127 | Val  Acc: 0.5111
Average Valid Accuracy: 0.7508
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8381
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8825
 Best site-Real                      | Epoch:2 | Val Acc: 0.9810
 Best site-Real                      | Epoch:2 | Val Acc: 0.9714
 Best site-Painting                  | Epoch:2 | Val Acc: 0.9333
 Best site-Painting                  | Epoch:2 | Val Acc: 0.8762
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.8000
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.7841
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.4286
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.5270
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.4762
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.5111
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 0.5573 | Train Acc: 0.8662
 Site-Clipart                       | Train Loss: 0.5395 | Train Acc: 0.8877
 Site-Real                          | Train Loss: 0.2620 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.2048 | Train Acc: 0.9809
 Site-Painting                      | Train Loss: 0.5009 | Train Acc: 0.8662
 Site-Painting                      | Train Loss: 0.4479 | Train Acc: 0.8835
 Site-Sketch                        | Train Loss: 0.6789 | Train Acc: 0.8025
 Site-Sketch                        | Train Loss: 0.5699 | Train Acc: 0.8305
 Site-QuickDraw                     | Train Loss: 1.4171 | Train Acc: 0.5414
 Site-QuickDraw                     | Train Loss: 1.4499 | Train Acc: 0.5699
 Site-Infograph                     | Train Loss: 1.5363 | Train Acc: 0.5223
 Site-Infograph                     | Train Loss: 1.3996 | Train Acc: 0.5508
Average Train Accuracy: 0.7699
 Site-Clipart                       | Val  Loss: 0.6303 | Val  Acc: 0.8667
 Site-Clipart                       | Val  Loss: 0.5871 | Val  Acc: 0.8762
 Site-Real                          | Val  Loss: 0.2390 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.2338 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.3547 | Val  Acc: 0.9333
 Site-Painting                      | Val  Loss: 0.4854 | Val  Acc: 0.9079
 Site-Sketch                        | Val  Loss: 0.5146 | Val  Acc: 0.8476
 Site-Sketch                        | Val  Loss: 0.5735 | Val  Acc: 0.8444
 Site-QuickDraw                     | Val  Loss: 1.5104 | Val  Acc: 0.5238
 Site-QuickDraw                     | Val  Loss: 1.4446 | Val  Acc: 0.5746
 Site-Infograph                     | Val  Loss: 1.6216 | Val  Acc: 0.5048
 Site-Infograph                     | Val  Loss: 1.4696 | Val  Acc: 0.5524
Average Valid Accuracy: 0.7828
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8667
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8762
 Best site-Real                      | Epoch:3 | Val Acc: 0.9810
 Best site-Real                      | Epoch:3 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:3 | Val Acc: 0.9333
 Best site-Painting                  | Epoch:3 | Val Acc: 0.9079
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.8476
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.8444
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.5238
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.5746
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.5048
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.5524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 0.5094 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.4896 | Train Acc: 0.8983
 Site-Real                          | Train Loss: 0.2547 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.1820 | Train Acc: 0.9831
 Site-Painting                      | Train Loss: 0.3888 | Train Acc: 0.9108
 Site-Painting                      | Train Loss: 0.4303 | Train Acc: 0.9004
 Site-Sketch                        | Train Loss: 0.6553 | Train Acc: 0.8217
 Site-Sketch                        | Train Loss: 0.5250 | Train Acc: 0.8475
 Site-QuickDraw                     | Train Loss: 1.3825 | Train Acc: 0.5924
 Site-QuickDraw                     | Train Loss: 1.3513 | Train Acc: 0.5869
 Site-Infograph                     | Train Loss: 1.4986 | Train Acc: 0.5350
 Site-Infograph                     | Train Loss: 1.3646 | Train Acc: 0.5742
Average Train Accuracy: 0.7898
 Site-Clipart                       | Val  Loss: 0.5251 | Val  Acc: 0.9143
 Site-Clipart                       | Val  Loss: 0.5526 | Val  Acc: 0.8794
 Site-Real                          | Val  Loss: 0.1890 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.2030 | Val  Acc: 0.9683
 Site-Painting                      | Val  Loss: 0.3421 | Val  Acc: 0.9333
 Site-Painting                      | Val  Loss: 0.4140 | Val  Acc: 0.9079
 Site-Sketch                        | Val  Loss: 0.5032 | Val  Acc: 0.8667
 Site-Sketch                        | Val  Loss: 0.4924 | Val  Acc: 0.8667
 Site-QuickDraw                     | Val  Loss: 1.4688 | Val  Acc: 0.5143
 Site-QuickDraw                     | Val  Loss: 1.3438 | Val  Acc: 0.5746
 Site-Infograph                     | Val  Loss: 1.5770 | Val  Acc: 0.4952
 Site-Infograph                     | Val  Loss: 1.4444 | Val  Acc: 0.5397
Average Valid Accuracy: 0.7860
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.9143
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8794
 Best site-Real                      | Epoch:4 | Val Acc: 0.9714
 Best site-Real                      | Epoch:4 | Val Acc: 0.9683
 Best site-Painting                  | Epoch:4 | Val Acc: 0.9333
 Best site-Painting                  | Epoch:4 | Val Acc: 0.9079
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.8667
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.8667
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.5143
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.5746
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.4952
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.5397
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 0.4488 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.4131 | Train Acc: 0.9131
 Site-Real                          | Train Loss: 0.2299 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.1475 | Train Acc: 0.9788
 Site-Painting                      | Train Loss: 0.3545 | Train Acc: 0.9108
 Site-Painting                      | Train Loss: 0.3718 | Train Acc: 0.9025
 Site-Sketch                        | Train Loss: 0.5417 | Train Acc: 0.8408
 Site-Sketch                        | Train Loss: 0.4494 | Train Acc: 0.8623
 Site-QuickDraw                     | Train Loss: 1.3222 | Train Acc: 0.6051
 Site-QuickDraw                     | Train Loss: 1.2944 | Train Acc: 0.6229
 Site-Infograph                     | Train Loss: 1.4321 | Train Acc: 0.5541
 Site-Infograph                     | Train Loss: 1.3250 | Train Acc: 0.5720
Average Train Accuracy: 0.7992
 Site-Clipart                       | Val  Loss: 0.4192 | Val  Acc: 0.9143
 Site-Clipart                       | Val  Loss: 0.4988 | Val  Acc: 0.8667
 Site-Real                          | Val  Loss: 0.1524 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.1717 | Val  Acc: 0.9778
 Site-Painting                      | Val  Loss: 0.2410 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.3690 | Val  Acc: 0.9111
 Site-Sketch                        | Val  Loss: 0.4617 | Val  Acc: 0.8667
 Site-Sketch                        | Val  Loss: 0.4570 | Val  Acc: 0.8794
 Site-QuickDraw                     | Val  Loss: 1.3164 | Val  Acc: 0.5810
 Site-QuickDraw                     | Val  Loss: 1.2538 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 1.4700 | Val  Acc: 0.4857
 Site-Infograph                     | Val  Loss: 1.4122 | Val  Acc: 0.5556
Average Valid Accuracy: 0.7984
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.9143
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8667
 Best site-Real                      | Epoch:5 | Val Acc: 0.9810
 Best site-Real                      | Epoch:5 | Val Acc: 0.9778
 Best site-Painting                  | Epoch:5 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:5 | Val Acc: 0.9111
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.8667
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.8794
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.5810
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.6095
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.4857
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.5556
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 0.4440 | Train Acc: 0.8535
 Site-Clipart                       | Train Loss: 0.4099 | Train Acc: 0.9089
 Site-Real                          | Train Loss: 0.1767 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.1345 | Train Acc: 0.9788
 Site-Painting                      | Train Loss: 0.3389 | Train Acc: 0.8790
 Site-Painting                      | Train Loss: 0.3463 | Train Acc: 0.9216
 Site-Sketch                        | Train Loss: 0.5468 | Train Acc: 0.8089
 Site-Sketch                        | Train Loss: 0.4491 | Train Acc: 0.8750
 Site-QuickDraw                     | Train Loss: 1.2161 | Train Acc: 0.6178
 Site-QuickDraw                     | Train Loss: 1.2336 | Train Acc: 0.6314
 Site-Infograph                     | Train Loss: 1.4321 | Train Acc: 0.5414
 Site-Infograph                     | Train Loss: 1.3155 | Train Acc: 0.5911
Average Train Accuracy: 0.7953
 Site-Clipart                       | Val  Loss: 0.4174 | Val  Acc: 0.8952
 Site-Clipart                       | Val  Loss: 0.4348 | Val  Acc: 0.9143
 Site-Real                          | Val  Loss: 0.1243 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.1545 | Val  Acc: 0.9778
 Site-Painting                      | Val  Loss: 0.2595 | Val  Acc: 0.9333
 Site-Painting                      | Val  Loss: 0.3402 | Val  Acc: 0.9206
 Site-Sketch                        | Val  Loss: 0.3859 | Val  Acc: 0.8857
 Site-Sketch                        | Val  Loss: 0.4625 | Val  Acc: 0.8603
 Site-QuickDraw                     | Val  Loss: 1.2135 | Val  Acc: 0.6286
 Site-QuickDraw                     | Val  Loss: 1.2192 | Val  Acc: 0.6540
 Site-Infograph                     | Val  Loss: 1.5357 | Val  Acc: 0.4857
 Site-Infograph                     | Val  Loss: 1.3823 | Val  Acc: 0.5460
Average Valid Accuracy: 0.8077
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8952
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.9143
 Best site-Real                      | Epoch:6 | Val Acc: 0.9905
 Best site-Real                      | Epoch:6 | Val Acc: 0.9778
 Best site-Painting                  | Epoch:6 | Val Acc: 0.9333
 Best site-Painting                  | Epoch:6 | Val Acc: 0.9206
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.8857
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.8603
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.6286
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.6540
 Best site-Infograph                 | Epoch:6 | Val Acc: 0.4857
 Best site-Infograph                 | Epoch:6 | Val Acc: 0.5460
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 0.4154 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.4015 | Train Acc: 0.9004
 Site-Real                          | Train Loss: 0.1892 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.1105 | Train Acc: 0.9767
 Site-Painting                      | Train Loss: 0.3469 | Train Acc: 0.8854
 Site-Painting                      | Train Loss: 0.3061 | Train Acc: 0.9258
 Site-Sketch                        | Train Loss: 0.5858 | Train Acc: 0.8089
 Site-Sketch                        | Train Loss: 0.4357 | Train Acc: 0.8665
 Site-QuickDraw                     | Train Loss: 1.1800 | Train Acc: 0.6688
 Site-QuickDraw                     | Train Loss: 1.1169 | Train Acc: 0.6695
 Site-Infograph                     | Train Loss: 1.4500 | Train Acc: 0.5287
 Site-Infograph                     | Train Loss: 1.2713 | Train Acc: 0.5678
Average Train Accuracy: 0.8038
 Site-Clipart                       | Val  Loss: 0.4208 | Val  Acc: 0.8667
 Site-Clipart                       | Val  Loss: 0.4169 | Val  Acc: 0.9016
 Site-Real                          | Val  Loss: 0.1475 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.1343 | Val  Acc: 0.9873
 Site-Painting                      | Val  Loss: 0.2761 | Val  Acc: 0.9333
 Site-Painting                      | Val  Loss: 0.3013 | Val  Acc: 0.9111
 Site-Sketch                        | Val  Loss: 0.3947 | Val  Acc: 0.8762
 Site-Sketch                        | Val  Loss: 0.4272 | Val  Acc: 0.8794
 Site-QuickDraw                     | Val  Loss: 1.1561 | Val  Acc: 0.6381
 Site-QuickDraw                     | Val  Loss: 1.1162 | Val  Acc: 0.6857
 Site-Infograph                     | Val  Loss: 1.4138 | Val  Acc: 0.5333
 Site-Infograph                     | Val  Loss: 1.3173 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8138
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8667
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9016
 Best site-Real                      | Epoch:7 | Val Acc: 0.9810
 Best site-Real                      | Epoch:7 | Val Acc: 0.9873
 Best site-Painting                  | Epoch:7 | Val Acc: 0.9333
 Best site-Painting                  | Epoch:7 | Val Acc: 0.9111
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.8762
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.8794
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.6381
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.6857
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.5333
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.5714
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 0.4737 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.3610 | Train Acc: 0.9131
 Site-Real                          | Train Loss: 0.1756 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.1111 | Train Acc: 0.9852
 Site-Painting                      | Train Loss: 0.3483 | Train Acc: 0.8981
 Site-Painting                      | Train Loss: 0.2979 | Train Acc: 0.9322
 Site-Sketch                        | Train Loss: 0.5097 | Train Acc: 0.8471
 Site-Sketch                        | Train Loss: 0.3880 | Train Acc: 0.8814
 Site-QuickDraw                     | Train Loss: 1.1540 | Train Acc: 0.6242
 Site-QuickDraw                     | Train Loss: 1.1155 | Train Acc: 0.6568
 Site-Infograph                     | Train Loss: 1.4405 | Train Acc: 0.5159
 Site-Infograph                     | Train Loss: 1.2459 | Train Acc: 0.5975
Average Train Accuracy: 0.8061
 Site-Clipart                       | Val  Loss: 0.3254 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.3999 | Val  Acc: 0.9079
 Site-Real                          | Val  Loss: 0.1243 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.1087 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.2401 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.3048 | Val  Acc: 0.9270
 Site-Sketch                        | Val  Loss: 0.3466 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.4288 | Val  Acc: 0.8730
 Site-QuickDraw                     | Val  Loss: 1.1951 | Val  Acc: 0.6381
 Site-QuickDraw                     | Val  Loss: 1.1509 | Val  Acc: 0.6413
 Site-Infograph                     | Val  Loss: 1.3924 | Val  Acc: 0.5333
 Site-Infograph                     | Val  Loss: 1.3323 | Val  Acc: 0.5810
Average Valid Accuracy: 0.8212
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9079
 Best site-Real                      | Epoch:8 | Val Acc: 0.9810
 Best site-Real                      | Epoch:8 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:8 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:8 | Val Acc: 0.9270
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.9048
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.8730
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.6381
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.6413
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.5333
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.5810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 0.4306 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.3359 | Train Acc: 0.9131
 Site-Real                          | Train Loss: 0.1619 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.1008 | Train Acc: 0.9873
 Site-Painting                      | Train Loss: 0.3363 | Train Acc: 0.8854
 Site-Painting                      | Train Loss: 0.2855 | Train Acc: 0.9237
 Site-Sketch                        | Train Loss: 0.4718 | Train Acc: 0.8535
 Site-Sketch                        | Train Loss: 0.4116 | Train Acc: 0.8708
 Site-QuickDraw                     | Train Loss: 1.1518 | Train Acc: 0.6306
 Site-QuickDraw                     | Train Loss: 1.1029 | Train Acc: 0.6610
 Site-Infograph                     | Train Loss: 1.3817 | Train Acc: 0.5350
 Site-Infograph                     | Train Loss: 1.2765 | Train Acc: 0.5826
Average Train Accuracy: 0.8059
 Site-Clipart                       | Val  Loss: 0.3863 | Val  Acc: 0.9238
 Site-Clipart                       | Val  Loss: 0.3940 | Val  Acc: 0.8952
 Site-Real                          | Val  Loss: 0.1182 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.1099 | Val  Acc: 0.9873
 Site-Painting                      | Val  Loss: 0.2113 | Val  Acc: 0.9429
 Site-Painting                      | Val  Loss: 0.2905 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.3609 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.3913 | Val  Acc: 0.8889
 Site-QuickDraw                     | Val  Loss: 1.1495 | Val  Acc: 0.6762
 Site-QuickDraw                     | Val  Loss: 1.0892 | Val  Acc: 0.6635
 Site-Infograph                     | Val  Loss: 1.5012 | Val  Acc: 0.5143
 Site-Infograph                     | Val  Loss: 1.3429 | Val  Acc: 0.5841
Average Valid Accuracy: 0.8246
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9238
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8952
 Best site-Real                      | Epoch:9 | Val Acc: 0.9714
 Best site-Real                      | Epoch:9 | Val Acc: 0.9873
 Best site-Painting                  | Epoch:9 | Val Acc: 0.9429
 Best site-Painting                  | Epoch:9 | Val Acc: 0.9238
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.9238
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8889
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.6762
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.6635
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.5143
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.5841
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 0.4142 | Train Acc: 0.8662
 Site-Clipart                       | Train Loss: 0.3386 | Train Acc: 0.9174
 Site-Real                          | Train Loss: 0.1715 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.1094 | Train Acc: 0.9831
 Site-Painting                      | Train Loss: 0.3108 | Train Acc: 0.9299
 Site-Painting                      | Train Loss: 0.2764 | Train Acc: 0.9407
 Site-Sketch                        | Train Loss: 0.4791 | Train Acc: 0.8344
 Site-Sketch                        | Train Loss: 0.4107 | Train Acc: 0.8750
 Site-QuickDraw                     | Train Loss: 0.9817 | Train Acc: 0.6369
 Site-QuickDraw                     | Train Loss: 1.0218 | Train Acc: 0.7013
 Site-Infograph                     | Train Loss: 1.2791 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.2353 | Train Acc: 0.6144
Average Train Accuracy: 0.8179
 Site-Clipart                       | Val  Loss: 0.2723 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.3435 | Val  Acc: 0.9048
 Site-Real                          | Val  Loss: 0.0844 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.1002 | Val  Acc: 0.9873
 Site-Painting                      | Val  Loss: 0.1824 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.2660 | Val  Acc: 0.9365
 Site-Sketch                        | Val  Loss: 0.3170 | Val  Acc: 0.8952
 Site-Sketch                        | Val  Loss: 0.3681 | Val  Acc: 0.8794
 Site-QuickDraw                     | Val  Loss: 1.0910 | Val  Acc: 0.6190
 Site-QuickDraw                     | Val  Loss: 1.0016 | Val  Acc: 0.7270
 Site-Infograph                     | Val  Loss: 1.4213 | Val  Acc: 0.5429
 Site-Infograph                     | Val  Loss: 1.2419 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8323
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9429
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9048
 Best site-Real                      | Epoch:10 | Val Acc: 0.9905
 Best site-Real                      | Epoch:10 | Val Acc: 0.9873
 Best site-Painting                  | Epoch:10 | Val Acc: 0.9619
 Best site-Painting                  | Epoch:10 | Val Acc: 0.9365
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.8952
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.8794
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.6190
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.7270
 Best site-Infograph                 | Epoch:10 | Val Acc: 0.5429
 Best site-Infograph                 | Epoch:10 | Val Acc: 0.6000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 0.3329 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.3134 | Train Acc: 0.9449
 Site-Real                          | Train Loss: 0.1474 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0860 | Train Acc: 0.9873
 Site-Painting                      | Train Loss: 0.2829 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.2498 | Train Acc: 0.9258
 Site-Sketch                        | Train Loss: 0.4065 | Train Acc: 0.8662
 Site-Sketch                        | Train Loss: 0.3611 | Train Acc: 0.8962
 Site-QuickDraw                     | Train Loss: 1.1573 | Train Acc: 0.6178
 Site-QuickDraw                     | Train Loss: 1.0371 | Train Acc: 0.6801
 Site-Infograph                     | Train Loss: 1.2883 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 1.1980 | Train Acc: 0.6017
Average Train Accuracy: 0.8215
 Site-Clipart                       | Val  Loss: 0.3100 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.3549 | Val  Acc: 0.9175
 Site-Real                          | Val  Loss: 0.0827 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0936 | Val  Acc: 0.9841
 Site-Painting                      | Val  Loss: 0.1978 | Val  Acc: 0.9429
 Site-Painting                      | Val  Loss: 0.2410 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.3291 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.3431 | Val  Acc: 0.8889
 Site-QuickDraw                     | Val  Loss: 1.1302 | Val  Acc: 0.5714
 Site-QuickDraw                     | Val  Loss: 1.0244 | Val  Acc: 0.6857
 Site-Infograph                     | Val  Loss: 1.3558 | Val  Acc: 0.5714
 Site-Infograph                     | Val  Loss: 1.2239 | Val  Acc: 0.6222
Average Valid Accuracy: 0.8312
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 0.4054 | Train Acc: 0.8790
 Site-Clipart                       | Train Loss: 0.3173 | Train Acc: 0.9195
 Site-Real                          | Train Loss: 0.1424 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0723 | Train Acc: 0.9788
 Site-Painting                      | Train Loss: 0.2987 | Train Acc: 0.9108
 Site-Painting                      | Train Loss: 0.2322 | Train Acc: 0.9364
 Site-Sketch                        | Train Loss: 0.4919 | Train Acc: 0.8471
 Site-Sketch                        | Train Loss: 0.3657 | Train Acc: 0.8792
 Site-QuickDraw                     | Train Loss: 1.0761 | Train Acc: 0.6306
 Site-QuickDraw                     | Train Loss: 1.0065 | Train Acc: 0.6822
 Site-Infograph                     | Train Loss: 1.3013 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.2222 | Train Acc: 0.6102
Average Train Accuracy: 0.8163
 Site-Clipart                       | Val  Loss: 0.3129 | Val  Acc: 0.9143
 Site-Clipart                       | Val  Loss: 0.3419 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.0998 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.0792 | Val  Acc: 0.9873
 Site-Painting                      | Val  Loss: 0.1889 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.2545 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.3712 | Val  Acc: 0.8857
 Site-Sketch                        | Val  Loss: 0.3477 | Val  Acc: 0.8921
 Site-QuickDraw                     | Val  Loss: 1.1724 | Val  Acc: 0.6190
 Site-QuickDraw                     | Val  Loss: 1.0252 | Val  Acc: 0.7016
 Site-Infograph                     | Val  Loss: 1.3323 | Val  Acc: 0.5810
 Site-Infograph                     | Val  Loss: 1.2372 | Val  Acc: 0.6190
Average Valid Accuracy: 0.8325
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9143
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9238
 Best site-Real                      | Epoch:12 | Val Acc: 0.9714
 Best site-Real                      | Epoch:12 | Val Acc: 0.9873
 Best site-Painting                  | Epoch:12 | Val Acc: 0.9619
 Best site-Painting                  | Epoch:12 | Val Acc: 0.9333
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.8857
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.8921
 Best site-QuickDraw                 | Epoch:12 | Val Acc: 0.6190
 Best site-QuickDraw                 | Epoch:12 | Val Acc: 0.7016
 Best site-Infograph                 | Epoch:12 | Val Acc: 0.5810
 Best site-Infograph                 | Epoch:12 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 0.3302 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.2817 | Train Acc: 0.9386
 Site-Real                          | Train Loss: 0.1223 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0890 | Train Acc: 0.9852
 Site-Painting                      | Train Loss: 0.2814 | Train Acc: 0.9172
 Site-Painting                      | Train Loss: 0.2158 | Train Acc: 0.9470
 Site-Sketch                        | Train Loss: 0.3979 | Train Acc: 0.8535
 Site-Sketch                        | Train Loss: 0.3486 | Train Acc: 0.8898
 Site-QuickDraw                     | Train Loss: 0.9370 | Train Acc: 0.6624
 Site-QuickDraw                     | Train Loss: 0.9991 | Train Acc: 0.6928
 Site-Infograph                     | Train Loss: 1.3517 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.1678 | Train Acc: 0.6208
Average Train Accuracy: 0.8278
 Site-Clipart                       | Val  Loss: 0.2975 | Val  Acc: 0.9048
 Site-Clipart                       | Val  Loss: 0.3289 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.0727 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0766 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1542 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.2538 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2482 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.3255 | Val  Acc: 0.8984
 Site-QuickDraw                     | Val  Loss: 1.0414 | Val  Acc: 0.6476
 Site-QuickDraw                     | Val  Loss: 0.9530 | Val  Acc: 0.7016
 Site-Infograph                     | Val  Loss: 1.3546 | Val  Acc: 0.5905
 Site-Infograph                     | Val  Loss: 1.2487 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8431
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9048
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9238
 Best site-Real                      | Epoch:13 | Val Acc: 0.9905
 Best site-Real                      | Epoch:13 | Val Acc: 0.9937
 Best site-Painting                  | Epoch:13 | Val Acc: 0.9619
 Best site-Painting                  | Epoch:13 | Val Acc: 0.9429
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.9333
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.8984
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.6476
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.7016
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.5905
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.6286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 0.4386 | Train Acc: 0.8662
 Site-Clipart                       | Train Loss: 0.2738 | Train Acc: 0.9386
 Site-Real                          | Train Loss: 0.1549 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0834 | Train Acc: 0.9831
 Site-Painting                      | Train Loss: 0.2451 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.2286 | Train Acc: 0.9513
 Site-Sketch                        | Train Loss: 0.4019 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.3260 | Train Acc: 0.9068
 Site-QuickDraw                     | Train Loss: 0.9488 | Train Acc: 0.6688
 Site-QuickDraw                     | Train Loss: 0.9746 | Train Acc: 0.6949
 Site-Infograph                     | Train Loss: 1.3375 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.1420 | Train Acc: 0.6398
Average Train Accuracy: 0.8312
 Site-Clipart                       | Val  Loss: 0.2773 | Val  Acc: 0.9238
 Site-Clipart                       | Val  Loss: 0.3173 | Val  Acc: 0.9143
 Site-Real                          | Val  Loss: 0.0774 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0755 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1566 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.2662 | Val  Acc: 0.9397
 Site-Sketch                        | Val  Loss: 0.2556 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.3234 | Val  Acc: 0.8984
 Site-QuickDraw                     | Val  Loss: 1.0714 | Val  Acc: 0.6190
 Site-QuickDraw                     | Val  Loss: 0.9649 | Val  Acc: 0.6857
 Site-Infograph                     | Val  Loss: 1.3399 | Val  Acc: 0.6000
 Site-Infograph                     | Val  Loss: 1.2122 | Val  Acc: 0.5968
Average Valid Accuracy: 0.8389
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 0.3034 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.2786 | Train Acc: 0.9258
 Site-Real                          | Train Loss: 0.1519 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.0681 | Train Acc: 0.9894
 Site-Painting                      | Train Loss: 0.2527 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.2201 | Train Acc: 0.9555
 Site-Sketch                        | Train Loss: 0.4365 | Train Acc: 0.8535
 Site-Sketch                        | Train Loss: 0.2984 | Train Acc: 0.9025
 Site-QuickDraw                     | Train Loss: 1.0172 | Train Acc: 0.6497
 Site-QuickDraw                     | Train Loss: 0.9481 | Train Acc: 0.6843
 Site-Infograph                     | Train Loss: 1.3532 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.1244 | Train Acc: 0.6356
Average Train Accuracy: 0.8268
 Site-Clipart                       | Val  Loss: 0.2789 | Val  Acc: 0.9048
 Site-Clipart                       | Val  Loss: 0.2952 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.0922 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.0832 | Val  Acc: 0.9841
 Site-Painting                      | Val  Loss: 0.1680 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.2152 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2609 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.3081 | Val  Acc: 0.8921
 Site-QuickDraw                     | Val  Loss: 1.0592 | Val  Acc: 0.6286
 Site-QuickDraw                     | Val  Loss: 0.9658 | Val  Acc: 0.6730
 Site-Infograph                     | Val  Loss: 1.3562 | Val  Acc: 0.5714
 Site-Infograph                     | Val  Loss: 1.1631 | Val  Acc: 0.6127
Average Valid Accuracy: 0.8325
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 0.4001 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.2804 | Train Acc: 0.9258
 Site-Real                          | Train Loss: 0.1696 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0577 | Train Acc: 0.9894
 Site-Painting                      | Train Loss: 0.2236 | Train Acc: 0.9299
 Site-Painting                      | Train Loss: 0.1977 | Train Acc: 0.9555
 Site-Sketch                        | Train Loss: 0.4001 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.3019 | Train Acc: 0.9153
 Site-QuickDraw                     | Train Loss: 0.9785 | Train Acc: 0.6752
 Site-QuickDraw                     | Train Loss: 0.9078 | Train Acc: 0.7225
 Site-Infograph                     | Train Loss: 1.3015 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 1.1240 | Train Acc: 0.6292
Average Train Accuracy: 0.8368
 Site-Clipart                       | Val  Loss: 0.2791 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.2823 | Val  Acc: 0.9397
 Site-Real                          | Val  Loss: 0.0638 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0657 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1176 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.2161 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2434 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.3133 | Val  Acc: 0.9016
 Site-QuickDraw                     | Val  Loss: 1.0066 | Val  Acc: 0.6857
 Site-QuickDraw                     | Val  Loss: 0.9412 | Val  Acc: 0.7143
 Site-Infograph                     | Val  Loss: 1.2965 | Val  Acc: 0.5429
 Site-Infograph                     | Val  Loss: 1.1228 | Val  Acc: 0.6635
Average Valid Accuracy: 0.8526
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.9397
 Best site-Real                      | Epoch:16 | Val Acc: 1.0000
 Best site-Real                      | Epoch:16 | Val Acc: 0.9937
 Best site-Painting                  | Epoch:16 | Val Acc: 0.9905
 Best site-Painting                  | Epoch:16 | Val Acc: 0.9429
 Best site-Sketch                    | Epoch:16 | Val Acc: 0.9238
 Best site-Sketch                    | Epoch:16 | Val Acc: 0.9016
 Best site-QuickDraw                 | Epoch:16 | Val Acc: 0.6857
 Best site-QuickDraw                 | Epoch:16 | Val Acc: 0.7143
 Best site-Infograph                 | Epoch:16 | Val Acc: 0.5429
 Best site-Infograph                 | Epoch:16 | Val Acc: 0.6635
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 0.3063 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.2624 | Train Acc: 0.9364
 Site-Real                          | Train Loss: 0.1674 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.0635 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2373 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.2011 | Train Acc: 0.9449
 Site-Sketch                        | Train Loss: 0.4210 | Train Acc: 0.8471
 Site-Sketch                        | Train Loss: 0.2701 | Train Acc: 0.9343
 Site-QuickDraw                     | Train Loss: 0.9557 | Train Acc: 0.7134
 Site-QuickDraw                     | Train Loss: 0.9290 | Train Acc: 0.7161
 Site-Infograph                     | Train Loss: 1.3410 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.0971 | Train Acc: 0.6377
Average Train Accuracy: 0.8376
 Site-Clipart                       | Val  Loss: 0.3077 | Val  Acc: 0.8857
 Site-Clipart                       | Val  Loss: 0.2842 | Val  Acc: 0.9175
 Site-Real                          | Val  Loss: 0.0581 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0595 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1286 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.2009 | Val  Acc: 0.9587
 Site-Sketch                        | Val  Loss: 0.2349 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.2758 | Val  Acc: 0.9206
 Site-QuickDraw                     | Val  Loss: 1.0016 | Val  Acc: 0.6667
 Site-QuickDraw                     | Val  Loss: 0.9114 | Val  Acc: 0.7143
 Site-Infograph                     | Val  Loss: 1.2890 | Val  Acc: 0.5810
 Site-Infograph                     | Val  Loss: 1.1975 | Val  Acc: 0.6222
Average Valid Accuracy: 0.8463
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 0.3482 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.2388 | Train Acc: 0.9237
 Site-Real                          | Train Loss: 0.1422 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.0636 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.1968 | Train Acc: 0.9618
 Site-Painting                      | Train Loss: 0.1933 | Train Acc: 0.9534
 Site-Sketch                        | Train Loss: 0.3236 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2849 | Train Acc: 0.9131
 Site-QuickDraw                     | Train Loss: 0.9333 | Train Acc: 0.6688
 Site-QuickDraw                     | Train Loss: 0.9092 | Train Acc: 0.7225
 Site-Infograph                     | Train Loss: 1.3596 | Train Acc: 0.5541
 Site-Infograph                     | Train Loss: 1.0938 | Train Acc: 0.6398
Average Train Accuracy: 0.8376
 Site-Clipart                       | Val  Loss: 0.2041 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2926 | Val  Acc: 0.9175
 Site-Real                          | Val  Loss: 0.0797 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0592 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1175 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1869 | Val  Acc: 0.9587
 Site-Sketch                        | Val  Loss: 0.2459 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.3234 | Val  Acc: 0.8889
 Site-QuickDraw                     | Val  Loss: 1.0025 | Val  Acc: 0.6571
 Site-QuickDraw                     | Val  Loss: 0.9124 | Val  Acc: 0.7333
 Site-Infograph                     | Val  Loss: 1.1889 | Val  Acc: 0.6000
 Site-Infograph                     | Val  Loss: 1.1748 | Val  Acc: 0.6317
Average Valid Accuracy: 0.8542
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9619
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9175
 Best site-Real                      | Epoch:18 | Val Acc: 0.9905
 Best site-Real                      | Epoch:18 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:18 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:18 | Val Acc: 0.9587
 Best site-Sketch                    | Epoch:18 | Val Acc: 0.9333
 Best site-Sketch                    | Epoch:18 | Val Acc: 0.8889
 Best site-QuickDraw                 | Epoch:18 | Val Acc: 0.6571
 Best site-QuickDraw                 | Epoch:18 | Val Acc: 0.7333
 Best site-Infograph                 | Epoch:18 | Val Acc: 0.6000
 Best site-Infograph                 | Epoch:18 | Val Acc: 0.6317
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 0.3245 | Train Acc: 0.8662
 Site-Clipart                       | Train Loss: 0.2322 | Train Acc: 0.9428
 Site-Real                          | Train Loss: 0.1387 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0589 | Train Acc: 0.9894
 Site-Painting                      | Train Loss: 0.2601 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.1558 | Train Acc: 0.9703
 Site-Sketch                        | Train Loss: 0.4322 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.2567 | Train Acc: 0.9237
 Site-QuickDraw                     | Train Loss: 0.9593 | Train Acc: 0.6624
 Site-QuickDraw                     | Train Loss: 0.9187 | Train Acc: 0.6970
 Site-Infograph                     | Train Loss: 1.3011 | Train Acc: 0.5924
 Site-Infograph                     | Train Loss: 1.1158 | Train Acc: 0.6419
Average Train Accuracy: 0.8381
 Site-Clipart                       | Val  Loss: 0.2265 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.2655 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.0446 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.0540 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1228 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.2154 | Val  Acc: 0.9492
 Site-Sketch                        | Val  Loss: 0.2576 | Val  Acc: 0.8952
 Site-Sketch                        | Val  Loss: 0.2746 | Val  Acc: 0.9175
 Site-QuickDraw                     | Val  Loss: 0.9672 | Val  Acc: 0.6667
 Site-QuickDraw                     | Val  Loss: 0.9048 | Val  Acc: 0.7429
 Site-Infograph                     | Val  Loss: 1.3103 | Val  Acc: 0.5905
 Site-Infograph                     | Val  Loss: 1.1279 | Val  Acc: 0.6476
Average Valid Accuracy: 0.8537
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 0.4127 | Train Acc: 0.8726
 Site-Clipart                       | Train Loss: 0.2410 | Train Acc: 0.9301
 Site-Real                          | Train Loss: 0.1323 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0497 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2370 | Train Acc: 0.9554
 Site-Painting                      | Train Loss: 0.1572 | Train Acc: 0.9534
 Site-Sketch                        | Train Loss: 0.3849 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.2652 | Train Acc: 0.9174
 Site-QuickDraw                     | Train Loss: 0.8971 | Train Acc: 0.7006
 Site-QuickDraw                     | Train Loss: 0.8816 | Train Acc: 0.7309
 Site-Infograph                     | Train Loss: 1.3671 | Train Acc: 0.5860
 Site-Infograph                     | Train Loss: 1.0663 | Train Acc: 0.6716
Average Train Accuracy: 0.8483
 Site-Clipart                       | Val  Loss: 0.2114 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.2727 | Val  Acc: 0.9397
 Site-Real                          | Val  Loss: 0.0653 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0594 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1352 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.1741 | Val  Acc: 0.9587
 Site-Sketch                        | Val  Loss: 0.2161 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.2555 | Val  Acc: 0.9238
 Site-QuickDraw                     | Val  Loss: 0.9955 | Val  Acc: 0.6857
 Site-QuickDraw                     | Val  Loss: 0.8808 | Val  Acc: 0.7429
 Site-Infograph                     | Val  Loss: 1.2333 | Val  Acc: 0.6190
 Site-Infograph                     | Val  Loss: 1.1504 | Val  Acc: 0.6508
Average Valid Accuracy: 0.8638
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9397
 Best site-Real                      | Epoch:20 | Val Acc: 1.0000
 Best site-Real                      | Epoch:20 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:20 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:20 | Val Acc: 0.9587
 Best site-Sketch                    | Epoch:20 | Val Acc: 0.9619
 Best site-Sketch                    | Epoch:20 | Val Acc: 0.9238
 Best site-QuickDraw                 | Epoch:20 | Val Acc: 0.6857
 Best site-QuickDraw                 | Epoch:20 | Val Acc: 0.7429
 Best site-Infograph                 | Epoch:20 | Val Acc: 0.6190
 Best site-Infograph                 | Epoch:20 | Val Acc: 0.6508
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 0.3006 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.2209 | Train Acc: 0.9449
 Site-Real                          | Train Loss: 0.1212 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0513 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2522 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.1630 | Train Acc: 0.9682
 Site-Sketch                        | Train Loss: 0.4120 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.2822 | Train Acc: 0.9110
 Site-QuickDraw                     | Train Loss: 0.8515 | Train Acc: 0.7070
 Site-QuickDraw                     | Train Loss: 0.9206 | Train Acc: 0.7331
 Site-Infograph                     | Train Loss: 1.3220 | Train Acc: 0.6115
 Site-Infograph                     | Train Loss: 1.0366 | Train Acc: 0.6653
Average Train Accuracy: 0.8519
 Site-Clipart                       | Val  Loss: 0.1979 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2849 | Val  Acc: 0.9016
 Site-Real                          | Val  Loss: 0.0425 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0574 | Val  Acc: 0.9873
 Site-Painting                      | Val  Loss: 0.1166 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1701 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.2892 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.2879 | Val  Acc: 0.9016
 Site-QuickDraw                     | Val  Loss: 0.9177 | Val  Acc: 0.6762
 Site-QuickDraw                     | Val  Loss: 0.8725 | Val  Acc: 0.7302
 Site-Infograph                     | Val  Loss: 1.2838 | Val  Acc: 0.5619
 Site-Infograph                     | Val  Loss: 1.0978 | Val  Acc: 0.6635
Average Valid Accuracy: 0.8542
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 0.3384 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.1988 | Train Acc: 0.9576
 Site-Real                          | Train Loss: 0.1243 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0474 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2840 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.1465 | Train Acc: 0.9661
 Site-Sketch                        | Train Loss: 0.4000 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2652 | Train Acc: 0.9153
 Site-QuickDraw                     | Train Loss: 0.9433 | Train Acc: 0.6879
 Site-QuickDraw                     | Train Loss: 0.8902 | Train Acc: 0.6992
 Site-Infograph                     | Train Loss: 1.3349 | Train Acc: 0.6051
 Site-Infograph                     | Train Loss: 1.0846 | Train Acc: 0.6547
Average Train Accuracy: 0.8459
 Site-Clipart                       | Val  Loss: 0.2055 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2672 | Val  Acc: 0.9397
 Site-Real                          | Val  Loss: 0.0879 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0532 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1255 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.1509 | Val  Acc: 0.9683
 Site-Sketch                        | Val  Loss: 0.2245 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.2647 | Val  Acc: 0.9143
 Site-QuickDraw                     | Val  Loss: 0.9585 | Val  Acc: 0.6857
 Site-QuickDraw                     | Val  Loss: 0.8703 | Val  Acc: 0.7333
 Site-Infograph                     | Val  Loss: 1.2024 | Val  Acc: 0.5714
 Site-Infograph                     | Val  Loss: 1.1156 | Val  Acc: 0.6381
Average Valid Accuracy: 0.8577
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.2714 | Train Acc: 0.9236
 Site-Clipart                       | Train Loss: 0.2449 | Train Acc: 0.9301
 Site-Real                          | Train Loss: 0.1139 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0413 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2346 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.1598 | Train Acc: 0.9576
 Site-Sketch                        | Train Loss: 0.3253 | Train Acc: 0.9172
 Site-Sketch                        | Train Loss: 0.2428 | Train Acc: 0.9174
 Site-QuickDraw                     | Train Loss: 0.8451 | Train Acc: 0.7070
 Site-QuickDraw                     | Train Loss: 0.8071 | Train Acc: 0.7415
 Site-Infograph                     | Train Loss: 1.2709 | Train Acc: 0.5924
 Site-Infograph                     | Train Loss: 1.0680 | Train Acc: 0.6695
Average Train Accuracy: 0.8542
 Site-Clipart                       | Val  Loss: 0.2170 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.2333 | Val  Acc: 0.9492
 Site-Real                          | Val  Loss: 0.0413 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0454 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1186 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1431 | Val  Acc: 0.9683
 Site-Sketch                        | Val  Loss: 0.2449 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.2618 | Val  Acc: 0.9175
 Site-QuickDraw                     | Val  Loss: 0.9179 | Val  Acc: 0.7048
 Site-QuickDraw                     | Val  Loss: 0.8220 | Val  Acc: 0.7397
 Site-Infograph                     | Val  Loss: 1.2833 | Val  Acc: 0.5810
 Site-Infograph                     | Val  Loss: 1.0944 | Val  Acc: 0.6413
Average Valid Accuracy: 0.8603
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 0.2713 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.2350 | Train Acc: 0.9534
 Site-Real                          | Train Loss: 0.1168 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0346 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2597 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.1492 | Train Acc: 0.9682
 Site-Sketch                        | Train Loss: 0.2974 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2524 | Train Acc: 0.9216
 Site-QuickDraw                     | Train Loss: 0.9049 | Train Acc: 0.7006
 Site-QuickDraw                     | Train Loss: 0.8202 | Train Acc: 0.7542
 Site-Infograph                     | Train Loss: 1.2467 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 1.0218 | Train Acc: 0.6525
Average Train Accuracy: 0.8517
 Site-Clipart                       | Val  Loss: 0.2080 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2503 | Val  Acc: 0.9270
 Site-Real                          | Val  Loss: 0.0464 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0439 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1161 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1827 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2062 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.2139 | Val  Acc: 0.9238
 Site-QuickDraw                     | Val  Loss: 0.8460 | Val  Acc: 0.7048
 Site-QuickDraw                     | Val  Loss: 0.8533 | Val  Acc: 0.7333
 Site-Infograph                     | Val  Loss: 1.1299 | Val  Acc: 0.6190
 Site-Infograph                     | Val  Loss: 1.0935 | Val  Acc: 0.6635
Average Valid Accuracy: 0.8640
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9524
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9270
 Best site-Real                      | Epoch:24 | Val Acc: 1.0000
 Best site-Real                      | Epoch:24 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:24 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:24 | Val Acc: 0.9429
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.9238
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.9238
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.7048
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.7333
 Best site-Infograph                 | Epoch:24 | Val Acc: 0.6190
 Best site-Infograph                 | Epoch:24 | Val Acc: 0.6635
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 0.2771 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.2357 | Train Acc: 0.9449
 Site-Real                          | Train Loss: 0.1437 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0414 | Train Acc: 0.9894
 Site-Painting                      | Train Loss: 0.2367 | Train Acc: 0.9108
 Site-Painting                      | Train Loss: 0.1434 | Train Acc: 0.9725
 Site-Sketch                        | Train Loss: 0.4077 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.2294 | Train Acc: 0.9301
 Site-QuickDraw                     | Train Loss: 0.8521 | Train Acc: 0.6752
 Site-QuickDraw                     | Train Loss: 0.7991 | Train Acc: 0.7415
 Site-Infograph                     | Train Loss: 1.3864 | Train Acc: 0.5414
 Site-Infograph                     | Train Loss: 1.0544 | Train Acc: 0.6568
Average Train Accuracy: 0.8439
 Site-Clipart                       | Val  Loss: 0.2280 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2362 | Val  Acc: 0.9397
 Site-Real                          | Val  Loss: 0.0492 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0428 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0898 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1322 | Val  Acc: 0.9778
 Site-Sketch                        | Val  Loss: 0.2516 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2358 | Val  Acc: 0.9397
 Site-QuickDraw                     | Val  Loss: 0.9885 | Val  Acc: 0.7048
 Site-QuickDraw                     | Val  Loss: 0.8627 | Val  Acc: 0.7048
 Site-Infograph                     | Val  Loss: 1.1520 | Val  Acc: 0.5810
 Site-Infograph                     | Val  Loss: 1.0429 | Val  Acc: 0.6794
Average Valid Accuracy: 0.8680
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.9619
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.9397
 Best site-Real                      | Epoch:25 | Val Acc: 1.0000
 Best site-Real                      | Epoch:25 | Val Acc: 0.9937
 Best site-Painting                  | Epoch:25 | Val Acc: 1.0000
 Best site-Painting                  | Epoch:25 | Val Acc: 0.9778
 Best site-Sketch                    | Epoch:25 | Val Acc: 0.9333
 Best site-Sketch                    | Epoch:25 | Val Acc: 0.9397
 Best site-QuickDraw                 | Epoch:25 | Val Acc: 0.7048
 Best site-QuickDraw                 | Epoch:25 | Val Acc: 0.7048
 Best site-Infograph                 | Epoch:25 | Val Acc: 0.5810
 Best site-Infograph                 | Epoch:25 | Val Acc: 0.6794
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.3122 | Train Acc: 0.8790
 Site-Clipart                       | Train Loss: 0.2219 | Train Acc: 0.9449
 Site-Real                          | Train Loss: 0.1315 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0366 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2221 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.1230 | Train Acc: 0.9788
 Site-Sketch                        | Train Loss: 0.3907 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2193 | Train Acc: 0.9386
 Site-QuickDraw                     | Train Loss: 0.9096 | Train Acc: 0.7006
 Site-QuickDraw                     | Train Loss: 0.7990 | Train Acc: 0.7479
 Site-Infograph                     | Train Loss: 1.3164 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.0022 | Train Acc: 0.6653
Average Train Accuracy: 0.8506
 Site-Clipart                       | Val  Loss: 0.1751 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.2369 | Val  Acc: 0.9397
 Site-Real                          | Val  Loss: 0.0675 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0426 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1229 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1306 | Val  Acc: 0.9683
 Site-Sketch                        | Val  Loss: 0.2183 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2380 | Val  Acc: 0.9365
 Site-QuickDraw                     | Val  Loss: 0.9012 | Val  Acc: 0.6952
 Site-QuickDraw                     | Val  Loss: 0.7957 | Val  Acc: 0.7270
 Site-Infograph                     | Val  Loss: 1.2840 | Val  Acc: 0.5619
 Site-Infograph                     | Val  Loss: 1.0742 | Val  Acc: 0.6635
Average Valid Accuracy: 0.8646
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 0.2522 | Train Acc: 0.9363
 Site-Clipart                       | Train Loss: 0.1881 | Train Acc: 0.9470
 Site-Real                          | Train Loss: 0.1264 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0425 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.1639 | Train Acc: 0.9682
 Site-Painting                      | Train Loss: 0.1405 | Train Acc: 0.9576
 Site-Sketch                        | Train Loss: 0.4711 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.2208 | Train Acc: 0.9258
 Site-QuickDraw                     | Train Loss: 0.8391 | Train Acc: 0.6943
 Site-QuickDraw                     | Train Loss: 0.8250 | Train Acc: 0.7267
 Site-Infograph                     | Train Loss: 1.3445 | Train Acc: 0.5223
 Site-Infograph                     | Train Loss: 1.0263 | Train Acc: 0.6822
Average Train Accuracy: 0.8501
 Site-Clipart                       | Val  Loss: 0.1819 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2481 | Val  Acc: 0.9302
 Site-Real                          | Val  Loss: 0.0473 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0382 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1195 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.1107 | Val  Acc: 0.9778
 Site-Sketch                        | Val  Loss: 0.2085 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2298 | Val  Acc: 0.9206
 Site-QuickDraw                     | Val  Loss: 0.9274 | Val  Acc: 0.7238
 Site-QuickDraw                     | Val  Loss: 0.8376 | Val  Acc: 0.7524
 Site-Infograph                     | Val  Loss: 1.1436 | Val  Acc: 0.6857
 Site-Infograph                     | Val  Loss: 1.0705 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8746
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.9524
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.9302
 Best site-Real                      | Epoch:27 | Val Acc: 1.0000
 Best site-Real                      | Epoch:27 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:27 | Val Acc: 0.9619
 Best site-Painting                  | Epoch:27 | Val Acc: 0.9778
 Best site-Sketch                    | Epoch:27 | Val Acc: 0.9333
 Best site-Sketch                    | Epoch:27 | Val Acc: 0.9206
 Best site-QuickDraw                 | Epoch:27 | Val Acc: 0.7238
 Best site-QuickDraw                 | Epoch:27 | Val Acc: 0.7524
 Best site-Infograph                 | Epoch:27 | Val Acc: 0.6857
 Best site-Infograph                 | Epoch:27 | Val Acc: 0.6603
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 0.3490 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.2114 | Train Acc: 0.9386
 Site-Real                          | Train Loss: 0.1168 | Train Acc: 0.9809
 Site-Real                          | Train Loss: 0.0341 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.1942 | Train Acc: 0.9554
 Site-Painting                      | Train Loss: 0.1270 | Train Acc: 0.9746
 Site-Sketch                        | Train Loss: 0.3245 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.2393 | Train Acc: 0.9364
 Site-QuickDraw                     | Train Loss: 0.8173 | Train Acc: 0.7070
 Site-QuickDraw                     | Train Loss: 0.7643 | Train Acc: 0.7648
 Site-Infograph                     | Train Loss: 1.2037 | Train Acc: 0.5860
 Site-Infograph                     | Train Loss: 1.0682 | Train Acc: 0.6631
Average Train Accuracy: 0.8563
 Site-Clipart                       | Val  Loss: 0.2339 | Val  Acc: 0.9238
 Site-Clipart                       | Val  Loss: 0.2206 | Val  Acc: 0.9302
 Site-Real                          | Val  Loss: 0.0275 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0413 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1045 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1106 | Val  Acc: 0.9746
 Site-Sketch                        | Val  Loss: 0.1876 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2415 | Val  Acc: 0.9206
 Site-QuickDraw                     | Val  Loss: 0.8742 | Val  Acc: 0.7429
 Site-QuickDraw                     | Val  Loss: 0.7963 | Val  Acc: 0.7619
 Site-Infograph                     | Val  Loss: 1.1697 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 1.1265 | Val  Acc: 0.6635
Average Valid Accuracy: 0.8717
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.2670 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.1980 | Train Acc: 0.9343
 Site-Real                          | Train Loss: 0.0951 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0414 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2303 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.1122 | Train Acc: 0.9809
 Site-Sketch                        | Train Loss: 0.3865 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2185 | Train Acc: 0.9364
 Site-QuickDraw                     | Train Loss: 0.8879 | Train Acc: 0.7070
 Site-QuickDraw                     | Train Loss: 0.7701 | Train Acc: 0.7775
 Site-Infograph                     | Train Loss: 1.2468 | Train Acc: 0.5860
 Site-Infograph                     | Train Loss: 1.0002 | Train Acc: 0.6758
Average Train Accuracy: 0.8568
 Site-Clipart                       | Val  Loss: 0.1982 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2169 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0276 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0383 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0971 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1096 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.2557 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.2356 | Val  Acc: 0.9333
 Site-QuickDraw                     | Val  Loss: 0.8294 | Val  Acc: 0.7524
 Site-QuickDraw                     | Val  Loss: 0.7707 | Val  Acc: 0.7556
 Site-Infograph                     | Val  Loss: 1.2200 | Val  Acc: 0.6381
 Site-Infograph                     | Val  Loss: 1.0862 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8759
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.9524
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.9429
 Best site-Real                      | Epoch:29 | Val Acc: 1.0000
 Best site-Real                      | Epoch:29 | Val Acc: 1.0000
 Best site-Painting                  | Epoch:29 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:29 | Val Acc: 0.9810
 Best site-Sketch                    | Epoch:29 | Val Acc: 0.9143
 Best site-Sketch                    | Epoch:29 | Val Acc: 0.9333
 Best site-QuickDraw                 | Epoch:29 | Val Acc: 0.7524
 Best site-QuickDraw                 | Epoch:29 | Val Acc: 0.7556
 Best site-Infograph                 | Epoch:29 | Val Acc: 0.6381
 Best site-Infograph                 | Epoch:29 | Val Acc: 0.6603
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.2787 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.2008 | Train Acc: 0.9534
 Site-Real                          | Train Loss: 0.1062 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0390 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.1935 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.1034 | Train Acc: 0.9788
 Site-Sketch                        | Train Loss: 0.2890 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.2125 | Train Acc: 0.9216
 Site-QuickDraw                     | Train Loss: 0.8448 | Train Acc: 0.7006
 Site-QuickDraw                     | Train Loss: 0.7798 | Train Acc: 0.7542
 Site-Infograph                     | Train Loss: 1.2793 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.0005 | Train Acc: 0.6737
Average Train Accuracy: 0.8533
 Site-Clipart                       | Val  Loss: 0.2308 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.2279 | Val  Acc: 0.9302
 Site-Real                          | Val  Loss: 0.0318 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0593 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1228 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.1167 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.2459 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.2205 | Val  Acc: 0.9365
 Site-QuickDraw                     | Val  Loss: 0.8387 | Val  Acc: 0.7143
 Site-QuickDraw                     | Val  Loss: 0.7605 | Val  Acc: 0.7714
 Site-Infograph                     | Val  Loss: 1.1588 | Val  Acc: 0.6476
 Site-Infograph                     | Val  Loss: 1.0622 | Val  Acc: 0.6889
Average Valid Accuracy: 0.8728
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.2885 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.2036 | Train Acc: 0.9470
 Site-Real                          | Train Loss: 0.1473 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0419 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.1677 | Train Acc: 0.9618
 Site-Painting                      | Train Loss: 0.1218 | Train Acc: 0.9725
 Site-Sketch                        | Train Loss: 0.3080 | Train Acc: 0.8535
 Site-Sketch                        | Train Loss: 0.2279 | Train Acc: 0.9216
 Site-QuickDraw                     | Train Loss: 0.9304 | Train Acc: 0.6752
 Site-QuickDraw                     | Train Loss: 0.7875 | Train Acc: 0.7373
 Site-Infograph                     | Train Loss: 1.3346 | Train Acc: 0.5414
 Site-Infograph                     | Train Loss: 1.0099 | Train Acc: 0.6801
Average Train Accuracy: 0.8448
 Site-Clipart                       | Val  Loss: 0.1521 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2383 | Val  Acc: 0.9302
 Site-Real                          | Val  Loss: 0.0277 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0268 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0907 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1239 | Val  Acc: 0.9683
 Site-Sketch                        | Val  Loss: 0.2108 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.2171 | Val  Acc: 0.9429
 Site-QuickDraw                     | Val  Loss: 0.8438 | Val  Acc: 0.7048
 Site-QuickDraw                     | Val  Loss: 0.7467 | Val  Acc: 0.7841
 Site-Infograph                     | Val  Loss: 1.0749 | Val  Acc: 0.6190
 Site-Infograph                     | Val  Loss: 1.0289 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8728
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.2385 | Train Acc: 0.9363
 Site-Clipart                       | Train Loss: 0.1802 | Train Acc: 0.9576
 Site-Real                          | Train Loss: 0.1227 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0323 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.1688 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.1165 | Train Acc: 0.9703
 Site-Sketch                        | Train Loss: 0.3469 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.2070 | Train Acc: 0.9449
 Site-QuickDraw                     | Train Loss: 0.7952 | Train Acc: 0.6752
 Site-QuickDraw                     | Train Loss: 0.7503 | Train Acc: 0.7669
 Site-Infograph                     | Train Loss: 1.2417 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.0159 | Train Acc: 0.6716
Average Train Accuracy: 0.8561
 Site-Clipart                       | Val  Loss: 0.1751 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.2180 | Val  Acc: 0.9460
 Site-Real                          | Val  Loss: 0.0241 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0434 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0944 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1099 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.1654 | Val  Acc: 0.9905
 Site-Sketch                        | Val  Loss: 0.1992 | Val  Acc: 0.9397
 Site-QuickDraw                     | Val  Loss: 0.8349 | Val  Acc: 0.7333
 Site-QuickDraw                     | Val  Loss: 0.7641 | Val  Acc: 0.7714
 Site-Infograph                     | Val  Loss: 1.1134 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 0.9980 | Val  Acc: 0.6794
Average Valid Accuracy: 0.8817
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.9429
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.9460
 Best site-Real                      | Epoch:32 | Val Acc: 1.0000
 Best site-Real                      | Epoch:32 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:32 | Val Acc: 1.0000
 Best site-Painting                  | Epoch:32 | Val Acc: 0.9714
 Best site-Sketch                    | Epoch:32 | Val Acc: 0.9905
 Best site-Sketch                    | Epoch:32 | Val Acc: 0.9397
 Best site-QuickDraw                 | Epoch:32 | Val Acc: 0.7333
 Best site-QuickDraw                 | Epoch:32 | Val Acc: 0.7714
 Best site-Infograph                 | Epoch:32 | Val Acc: 0.6095
 Best site-Infograph                 | Epoch:32 | Val Acc: 0.6794
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.2466 | Train Acc: 0.9172
 Site-Clipart                       | Train Loss: 0.1872 | Train Acc: 0.9555
 Site-Real                          | Train Loss: 0.1203 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0365 | Train Acc: 0.9894
 Site-Painting                      | Train Loss: 0.1480 | Train Acc: 0.9618
 Site-Painting                      | Train Loss: 0.1113 | Train Acc: 0.9873
 Site-Sketch                        | Train Loss: 0.2634 | Train Acc: 0.9299
 Site-Sketch                        | Train Loss: 0.1658 | Train Acc: 0.9534
 Site-QuickDraw                     | Train Loss: 0.8782 | Train Acc: 0.7006
 Site-QuickDraw                     | Train Loss: 0.7444 | Train Acc: 0.7669
 Site-Infograph                     | Train Loss: 1.2302 | Train Acc: 0.5924
 Site-Infograph                     | Train Loss: 1.0014 | Train Acc: 0.6525
Average Train Accuracy: 0.8646
 Site-Clipart                       | Val  Loss: 0.1691 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.1970 | Val  Acc: 0.9556
 Site-Real                          | Val  Loss: 0.0314 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0392 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0789 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1248 | Val  Acc: 0.9683
 Site-Sketch                        | Val  Loss: 0.1923 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2040 | Val  Acc: 0.9397
 Site-QuickDraw                     | Val  Loss: 0.7893 | Val  Acc: 0.7333
 Site-QuickDraw                     | Val  Loss: 0.7510 | Val  Acc: 0.7746
 Site-Infograph                     | Val  Loss: 1.0759 | Val  Acc: 0.6952
 Site-Infograph                     | Val  Loss: 1.0070 | Val  Acc: 0.7016
Average Valid Accuracy: 0.8868
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.9619
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.9556
 Best site-Real                      | Epoch:33 | Val Acc: 1.0000
 Best site-Real                      | Epoch:33 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:33 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:33 | Val Acc: 0.9683
 Best site-Sketch                    | Epoch:33 | Val Acc: 0.9333
 Best site-Sketch                    | Epoch:33 | Val Acc: 0.9397
 Best site-QuickDraw                 | Epoch:33 | Val Acc: 0.7333
 Best site-QuickDraw                 | Epoch:33 | Val Acc: 0.7746
 Best site-Infograph                 | Epoch:33 | Val Acc: 0.6952
 Best site-Infograph                 | Epoch:33 | Val Acc: 0.7016
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 0.2789 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.1772 | Train Acc: 0.9513
 Site-Real                          | Train Loss: 0.1415 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0300 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.1977 | Train Acc: 0.9554
 Site-Painting                      | Train Loss: 0.1121 | Train Acc: 0.9767
 Site-Sketch                        | Train Loss: 0.3384 | Train Acc: 0.8981
 Site-Sketch                        | Train Loss: 0.2233 | Train Acc: 0.9343
 Site-QuickDraw                     | Train Loss: 0.8911 | Train Acc: 0.7134
 Site-QuickDraw                     | Train Loss: 0.7306 | Train Acc: 0.7733
 Site-Infograph                     | Train Loss: 1.2875 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 0.9542 | Train Acc: 0.7034
Average Train Accuracy: 0.8591
 Site-Clipart                       | Val  Loss: 0.1605 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.2108 | Val  Acc: 0.9397
 Site-Real                          | Val  Loss: 0.0469 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.0447 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0670 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1261 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.1793 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2048 | Val  Acc: 0.9333
 Site-QuickDraw                     | Val  Loss: 0.8100 | Val  Acc: 0.7714
 Site-QuickDraw                     | Val  Loss: 0.7881 | Val  Acc: 0.7460
 Site-Infograph                     | Val  Loss: 1.1596 | Val  Acc: 0.6286
 Site-Infograph                     | Val  Loss: 1.0176 | Val  Acc: 0.6698
Average Valid Accuracy: 0.8783
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 0.2554 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.1715 | Train Acc: 0.9492
 Site-Real                          | Train Loss: 0.1321 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0363 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.1941 | Train Acc: 0.9299
 Site-Painting                      | Train Loss: 0.1260 | Train Acc: 0.9682
 Site-Sketch                        | Train Loss: 0.3387 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.1873 | Train Acc: 0.9364
 Site-QuickDraw                     | Train Loss: 0.8726 | Train Acc: 0.6815
 Site-QuickDraw                     | Train Loss: 0.7236 | Train Acc: 0.7479
 Site-Infograph                     | Train Loss: 1.4187 | Train Acc: 0.5860
 Site-Infograph                     | Train Loss: 0.9818 | Train Acc: 0.6780
Average Train Accuracy: 0.8524
 Site-Clipart                       | Val  Loss: 0.1994 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2017 | Val  Acc: 0.9492
 Site-Real                          | Val  Loss: 0.0402 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0407 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.0857 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1086 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.1973 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2224 | Val  Acc: 0.9397
 Site-QuickDraw                     | Val  Loss: 0.8109 | Val  Acc: 0.7238
 Site-QuickDraw                     | Val  Loss: 0.7540 | Val  Acc: 0.7683
 Site-Infograph                     | Val  Loss: 1.1299 | Val  Acc: 0.6571
 Site-Infograph                     | Val  Loss: 1.0151 | Val  Acc: 0.7016
Average Valid Accuracy: 0.8823
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.2921 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.1654 | Train Acc: 0.9640
 Site-Real                          | Train Loss: 0.0877 | Train Acc: 0.9809
 Site-Real                          | Train Loss: 0.0244 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.1827 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.0944 | Train Acc: 0.9788
 Site-Sketch                        | Train Loss: 0.3738 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.1886 | Train Acc: 0.9555
 Site-QuickDraw                     | Train Loss: 0.7738 | Train Acc: 0.7134
 Site-QuickDraw                     | Train Loss: 0.7365 | Train Acc: 0.7606
 Site-Infograph                     | Train Loss: 1.2278 | Train Acc: 0.5860
 Site-Infograph                     | Train Loss: 0.9325 | Train Acc: 0.7119
Average Train Accuracy: 0.8639
 Site-Clipart                       | Val  Loss: 0.1747 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2074 | Val  Acc: 0.9397
 Site-Real                          | Val  Loss: 0.0361 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0394 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0664 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.0941 | Val  Acc: 0.9873
 Site-Sketch                        | Val  Loss: 0.2108 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.1941 | Val  Acc: 0.9524
 Site-QuickDraw                     | Val  Loss: 0.8328 | Val  Acc: 0.7143
 Site-QuickDraw                     | Val  Loss: 0.7500 | Val  Acc: 0.7524
 Site-Infograph                     | Val  Loss: 1.0793 | Val  Acc: 0.6190
 Site-Infograph                     | Val  Loss: 1.0210 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8770
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 0.2585 | Train Acc: 0.9299
 Site-Clipart                       | Train Loss: 0.1492 | Train Acc: 0.9513
 Site-Real                          | Train Loss: 0.1089 | Train Acc: 0.9873
 Site-Real                          | Train Loss: 0.0285 | Train Acc: 0.9979
 Site-Painting                      | Train Loss: 0.2174 | Train Acc: 0.9299
 Site-Painting                      | Train Loss: 0.0944 | Train Acc: 0.9788
 Site-Sketch                        | Train Loss: 0.2663 | Train Acc: 0.9108
 Site-Sketch                        | Train Loss: 0.2174 | Train Acc: 0.9258
 Site-QuickDraw                     | Train Loss: 0.7136 | Train Acc: 0.7261
 Site-QuickDraw                     | Train Loss: 0.7466 | Train Acc: 0.7669
 Site-Infograph                     | Train Loss: 1.2789 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 0.9216 | Train Acc: 0.6907
Average Train Accuracy: 0.8619
 Site-Clipart                       | Val  Loss: 0.1709 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.1800 | Val  Acc: 0.9556
 Site-Real                          | Val  Loss: 0.0285 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0275 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0714 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1222 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.1678 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2126 | Val  Acc: 0.9238
 Site-QuickDraw                     | Val  Loss: 0.8031 | Val  Acc: 0.7333
 Site-QuickDraw                     | Val  Loss: 0.6743 | Val  Acc: 0.8032
 Site-Infograph                     | Val  Loss: 1.0925 | Val  Acc: 0.6476
 Site-Infograph                     | Val  Loss: 0.9916 | Val  Acc: 0.6952
Average Valid Accuracy: 0.8847
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.2887 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.1705 | Train Acc: 0.9555
 Site-Real                          | Train Loss: 0.1084 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0273 | Train Acc: 0.9979
 Site-Painting                      | Train Loss: 0.1938 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.0976 | Train Acc: 0.9852
 Site-Sketch                        | Train Loss: 0.2877 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.1836 | Train Acc: 0.9428
 Site-QuickDraw                     | Train Loss: 0.8012 | Train Acc: 0.6943
 Site-QuickDraw                     | Train Loss: 0.7486 | Train Acc: 0.7500
 Site-Infograph                     | Train Loss: 1.2398 | Train Acc: 0.5541
 Site-Infograph                     | Train Loss: 0.9678 | Train Acc: 0.6801
Average Train Accuracy: 0.8550
 Site-Clipart                       | Val  Loss: 0.1608 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.1558 | Val  Acc: 0.9556
 Site-Real                          | Val  Loss: 0.0324 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0335 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0540 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0881 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.1777 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.1814 | Val  Acc: 0.9587
 Site-QuickDraw                     | Val  Loss: 0.7355 | Val  Acc: 0.7810
 Site-QuickDraw                     | Val  Loss: 0.7288 | Val  Acc: 0.7556
 Site-Infograph                     | Val  Loss: 1.2052 | Val  Acc: 0.6667
 Site-Infograph                     | Val  Loss: 0.9609 | Val  Acc: 0.6921
Average Valid Accuracy: 0.8926
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.9714
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.9556
 Best site-Real                      | Epoch:38 | Val Acc: 1.0000
 Best site-Real                      | Epoch:38 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:38 | Val Acc: 1.0000
 Best site-Painting                  | Epoch:38 | Val Acc: 0.9810
 Best site-Sketch                    | Epoch:38 | Val Acc: 0.9524
 Best site-Sketch                    | Epoch:38 | Val Acc: 0.9587
 Best site-QuickDraw                 | Epoch:38 | Val Acc: 0.7810
 Best site-QuickDraw                 | Epoch:38 | Val Acc: 0.7556
 Best site-Infograph                 | Epoch:38 | Val Acc: 0.6667
 Best site-Infograph                 | Epoch:38 | Val Acc: 0.6921
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.2491 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.1994 | Train Acc: 0.9513
 Site-Real                          | Train Loss: 0.0816 | Train Acc: 0.9809
 Site-Real                          | Train Loss: 0.0228 | Train Acc: 0.9979
 Site-Painting                      | Train Loss: 0.2289 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.0848 | Train Acc: 0.9915
 Site-Sketch                        | Train Loss: 0.3974 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.1861 | Train Acc: 0.9492
 Site-QuickDraw                     | Train Loss: 0.8490 | Train Acc: 0.6752
 Site-QuickDraw                     | Train Loss: 0.7096 | Train Acc: 0.7415
 Site-Infograph                     | Train Loss: 1.2396 | Train Acc: 0.5860
 Site-Infograph                     | Train Loss: 0.9329 | Train Acc: 0.6970
Average Train Accuracy: 0.8565
 Site-Clipart                       | Val  Loss: 0.1408 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.1902 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0241 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0328 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0665 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.0949 | Val  Acc: 0.9778
 Site-Sketch                        | Val  Loss: 0.1763 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.1963 | Val  Acc: 0.9365
 Site-QuickDraw                     | Val  Loss: 0.7743 | Val  Acc: 0.7429
 Site-QuickDraw                     | Val  Loss: 0.7273 | Val  Acc: 0.7651
 Site-Infograph                     | Val  Loss: 1.1885 | Val  Acc: 0.6190
 Site-Infograph                     | Val  Loss: 0.9841 | Val  Acc: 0.7016
Average Valid Accuracy: 0.8817
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.2655 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.1493 | Train Acc: 0.9492
 Site-Real                          | Train Loss: 0.0865 | Train Acc: 0.9873
 Site-Real                          | Train Loss: 0.0336 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.1964 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.0913 | Train Acc: 0.9788
 Site-Sketch                        | Train Loss: 0.3283 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.1849 | Train Acc: 0.9576
 Site-QuickDraw                     | Train Loss: 0.7441 | Train Acc: 0.7452
 Site-QuickDraw                     | Train Loss: 0.7016 | Train Acc: 0.7818
 Site-Infograph                     | Train Loss: 1.2662 | Train Acc: 0.5924
 Site-Infograph                     | Train Loss: 0.9194 | Train Acc: 0.7055
Average Train Accuracy: 0.8685
 Site-Clipart                       | Val  Loss: 0.1517 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2161 | Val  Acc: 0.9397
 Site-Real                          | Val  Loss: 0.0297 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0289 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0664 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0899 | Val  Acc: 0.9841
 Site-Sketch                        | Val  Loss: 0.1670 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.1952 | Val  Acc: 0.9619
 Site-QuickDraw                     | Val  Loss: 0.8052 | Val  Acc: 0.7333
 Site-QuickDraw                     | Val  Loss: 0.7332 | Val  Acc: 0.7651
 Site-Infograph                     | Val  Loss: 1.0841 | Val  Acc: 0.7048
 Site-Infograph                     | Val  Loss: 0.9538 | Val  Acc: 0.7048
Average Valid Accuracy: 0.8915
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 0.2378 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.1634 | Train Acc: 0.9576
 Site-Real                          | Train Loss: 0.0875 | Train Acc: 0.9809
 Site-Real                          | Train Loss: 0.0307 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2142 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.0899 | Train Acc: 0.9831
 Site-Sketch                        | Train Loss: 0.2948 | Train Acc: 0.9108
 Site-Sketch                        | Train Loss: 0.1904 | Train Acc: 0.9470
 Site-QuickDraw                     | Train Loss: 0.8338 | Train Acc: 0.7134
 Site-QuickDraw                     | Train Loss: 0.7370 | Train Acc: 0.7712
 Site-Infograph                     | Train Loss: 1.2600 | Train Acc: 0.6051
 Site-Infograph                     | Train Loss: 0.9427 | Train Acc: 0.6949
Average Train Accuracy: 0.8660
 Site-Clipart                       | Val  Loss: 0.1824 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.1953 | Val  Acc: 0.9460
 Site-Real                          | Val  Loss: 0.0170 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0276 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0836 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.0802 | Val  Acc: 0.9905
 Site-Sketch                        | Val  Loss: 0.1833 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2046 | Val  Acc: 0.9397
 Site-QuickDraw                     | Val  Loss: 0.7570 | Val  Acc: 0.7429
 Site-QuickDraw                     | Val  Loss: 0.7272 | Val  Acc: 0.7683
 Site-Infograph                     | Val  Loss: 1.0387 | Val  Acc: 0.6857
 Site-Infograph                     | Val  Loss: 0.9110 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8902
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 0.2673 | Train Acc: 0.9172
 Site-Clipart                       | Train Loss: 0.1752 | Train Acc: 0.9513
 Site-Real                          | Train Loss: 0.0881 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0327 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2004 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.0772 | Train Acc: 0.9873
 Site-Sketch                        | Train Loss: 0.3786 | Train Acc: 0.8662
 Site-Sketch                        | Train Loss: 0.1611 | Train Acc: 0.9470
 Site-QuickDraw                     | Train Loss: 0.7444 | Train Acc: 0.7070
 Site-QuickDraw                     | Train Loss: 0.6634 | Train Acc: 0.8114
 Site-Infograph                     | Train Loss: 1.2495 | Train Acc: 0.6178
 Site-Infograph                     | Train Loss: 0.9205 | Train Acc: 0.7055
Average Train Accuracy: 0.8674
 Site-Clipart                       | Val  Loss: 0.1280 | Val  Acc: 0.9810
 Site-Clipart                       | Val  Loss: 0.2017 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0225 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0271 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0588 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1087 | Val  Acc: 0.9778
 Site-Sketch                        | Val  Loss: 0.1186 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.2041 | Val  Acc: 0.9175
 Site-QuickDraw                     | Val  Loss: 0.7798 | Val  Acc: 0.7810
 Site-QuickDraw                     | Val  Loss: 0.7257 | Val  Acc: 0.7714
 Site-Infograph                     | Val  Loss: 0.9817 | Val  Acc: 0.7048
 Site-Infograph                     | Val  Loss: 0.9075 | Val  Acc: 0.7270
Average Valid Accuracy: 0.8979
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.9810
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.9429
 Best site-Real                      | Epoch:42 | Val Acc: 1.0000
 Best site-Real                      | Epoch:42 | Val Acc: 1.0000
 Best site-Painting                  | Epoch:42 | Val Acc: 1.0000
 Best site-Painting                  | Epoch:42 | Val Acc: 0.9778
 Best site-Sketch                    | Epoch:42 | Val Acc: 0.9714
 Best site-Sketch                    | Epoch:42 | Val Acc: 0.9175
 Best site-QuickDraw                 | Epoch:42 | Val Acc: 0.7810
 Best site-QuickDraw                 | Epoch:42 | Val Acc: 0.7714
 Best site-Infograph                 | Epoch:42 | Val Acc: 0.7048
 Best site-Infograph                 | Epoch:42 | Val Acc: 0.7270
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 0.2561 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.1506 | Train Acc: 0.9513
 Site-Real                          | Train Loss: 0.0998 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0358 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.1647 | Train Acc: 0.9554
 Site-Painting                      | Train Loss: 0.0962 | Train Acc: 0.9831
 Site-Sketch                        | Train Loss: 0.2901 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.2102 | Train Acc: 0.9470
 Site-QuickDraw                     | Train Loss: 0.7219 | Train Acc: 0.7261
 Site-QuickDraw                     | Train Loss: 0.6981 | Train Acc: 0.7648
 Site-Infograph                     | Train Loss: 1.3390 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 0.8764 | Train Acc: 0.7203
Average Train Accuracy: 0.8630
 Site-Clipart                       | Val  Loss: 0.1707 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2210 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 0.0153 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0235 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0475 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0943 | Val  Acc: 0.9873
 Site-Sketch                        | Val  Loss: 0.2254 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.1997 | Val  Acc: 0.9460
 Site-QuickDraw                     | Val  Loss: 0.7506 | Val  Acc: 0.7333
 Site-QuickDraw                     | Val  Loss: 0.6969 | Val  Acc: 0.7746
 Site-Infograph                     | Val  Loss: 1.0508 | Val  Acc: 0.6857
 Site-Infograph                     | Val  Loss: 0.9320 | Val  Acc: 0.7079
Average Valid Accuracy: 0.8876
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.2742 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.1755 | Train Acc: 0.9470
 Site-Real                          | Train Loss: 0.1023 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0221 | Train Acc: 0.9979
 Site-Painting                      | Train Loss: 0.1809 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.0659 | Train Acc: 0.9958
 Site-Sketch                        | Train Loss: 0.2829 | Train Acc: 0.8981
 Site-Sketch                        | Train Loss: 0.1778 | Train Acc: 0.9555
 Site-QuickDraw                     | Train Loss: 0.7621 | Train Acc: 0.7325
 Site-QuickDraw                     | Train Loss: 0.6736 | Train Acc: 0.7881
 Site-Infograph                     | Train Loss: 1.2565 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 0.8587 | Train Acc: 0.7161
Average Train Accuracy: 0.8683
 Site-Clipart                       | Val  Loss: 0.1676 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.1950 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0720 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0346 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0694 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0752 | Val  Acc: 0.9873
 Site-Sketch                        | Val  Loss: 0.1573 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.1685 | Val  Acc: 0.9587
 Site-QuickDraw                     | Val  Loss: 0.6981 | Val  Acc: 0.7810
 Site-QuickDraw                     | Val  Loss: 0.6693 | Val  Acc: 0.8127
 Site-Infograph                     | Val  Loss: 0.9776 | Val  Acc: 0.7143
 Site-Infograph                     | Val  Loss: 0.9239 | Val  Acc: 0.7143
Average Valid Accuracy: 0.9005
 Best site-Clipart                   | Epoch:44 | Val Acc: 0.9619
 Best site-Clipart                   | Epoch:44 | Val Acc: 0.9524
 Best site-Real                      | Epoch:44 | Val Acc: 0.9905
 Best site-Real                      | Epoch:44 | Val Acc: 1.0000
 Best site-Painting                  | Epoch:44 | Val Acc: 1.0000
 Best site-Painting                  | Epoch:44 | Val Acc: 0.9873
 Best site-Sketch                    | Epoch:44 | Val Acc: 0.9333
 Best site-Sketch                    | Epoch:44 | Val Acc: 0.9587
 Best site-QuickDraw                 | Epoch:44 | Val Acc: 0.7810
 Best site-QuickDraw                 | Epoch:44 | Val Acc: 0.8127
 Best site-Infograph                 | Epoch:44 | Val Acc: 0.7143
 Best site-Infograph                 | Epoch:44 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_2/fedsam...
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 0.2297 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.1649 | Train Acc: 0.9534
 Site-Real                          | Train Loss: 0.1197 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0226 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.1568 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.0901 | Train Acc: 0.9788
 Site-Sketch                        | Train Loss: 0.2948 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.1683 | Train Acc: 0.9555
 Site-QuickDraw                     | Train Loss: 0.7375 | Train Acc: 0.7389
 Site-QuickDraw                     | Train Loss: 0.6778 | Train Acc: 0.7860
 Site-Infograph                     | Train Loss: 1.3051 | Train Acc: 0.6051
 Site-Infograph                     | Train Loss: 0.9274 | Train Acc: 0.7055
Average Train Accuracy: 0.8688
 Site-Clipart                       | Val  Loss: 0.1780 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.1629 | Val  Acc: 0.9556
 Site-Real                          | Val  Loss: 0.0324 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0423 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0634 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.0910 | Val  Acc: 0.9778
 Site-Sketch                        | Val  Loss: 0.1593 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.1671 | Val  Acc: 0.9460
 Site-QuickDraw                     | Val  Loss: 0.7611 | Val  Acc: 0.6952
 Site-QuickDraw                     | Val  Loss: 0.6769 | Val  Acc: 0.7841
 Site-Infograph                     | Val  Loss: 0.9996 | Val  Acc: 0.7048
 Site-Infograph                     | Val  Loss: 0.9224 | Val  Acc: 0.7206
Average Valid Accuracy: 0.8905
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.2661 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.1425 | Train Acc: 0.9640
 Site-Real                          | Train Loss: 0.1021 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0264 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.1489 | Train Acc: 0.9618
 Site-Painting                      | Train Loss: 0.0813 | Train Acc: 0.9894
 Site-Sketch                        | Train Loss: 0.3089 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.1616 | Train Acc: 0.9534
 Site-QuickDraw                     | Train Loss: 0.8157 | Train Acc: 0.7134
 Site-QuickDraw                     | Train Loss: 0.7120 | Train Acc: 0.7648
 Site-Infograph                     | Train Loss: 1.2505 | Train Acc: 0.6051
 Site-Infograph                     | Train Loss: 0.9768 | Train Acc: 0.6907
Average Train Accuracy: 0.8653
 Site-Clipart                       | Val  Loss: 0.1511 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.1992 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0481 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0286 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0617 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0719 | Val  Acc: 0.9841
 Site-Sketch                        | Val  Loss: 0.1357 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.1750 | Val  Acc: 0.9556
 Site-QuickDraw                     | Val  Loss: 0.7761 | Val  Acc: 0.7524
 Site-QuickDraw                     | Val  Loss: 0.6945 | Val  Acc: 0.7524
 Site-Infograph                     | Val  Loss: 0.9566 | Val  Acc: 0.6571
 Site-Infograph                     | Val  Loss: 0.9785 | Val  Acc: 0.6952
Average Valid Accuracy: 0.8889
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 0.2446 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.1570 | Train Acc: 0.9449
 Site-Real                          | Train Loss: 0.0813 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0243 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.1604 | Train Acc: 0.9618
 Site-Painting                      | Train Loss: 0.0740 | Train Acc: 0.9831
 Site-Sketch                        | Train Loss: 0.4059 | Train Acc: 0.9108
 Site-Sketch                        | Train Loss: 0.1558 | Train Acc: 0.9576
 Site-QuickDraw                     | Train Loss: 0.7366 | Train Acc: 0.7325
 Site-QuickDraw                     | Train Loss: 0.6750 | Train Acc: 0.7733
 Site-Infograph                     | Train Loss: 1.1996 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 0.8557 | Train Acc: 0.7203
Average Train Accuracy: 0.8687
 Site-Clipart                       | Val  Loss: 0.1718 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.2146 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.0208 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0290 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0686 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.0810 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.1245 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.1619 | Val  Acc: 0.9556
 Site-QuickDraw                     | Val  Loss: 0.7331 | Val  Acc: 0.7524
 Site-QuickDraw                     | Val  Loss: 0.6456 | Val  Acc: 0.7968
 Site-Infograph                     | Val  Loss: 0.9609 | Val  Acc: 0.6476
 Site-Infograph                     | Val  Loss: 0.9463 | Val  Acc: 0.7079
Average Valid Accuracy: 0.8873
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 0.2691 | Train Acc: 0.9172
 Site-Clipart                       | Train Loss: 0.1407 | Train Acc: 0.9534
 Site-Real                          | Train Loss: 0.0918 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0300 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2000 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.0754 | Train Acc: 0.9767
 Site-Sketch                        | Train Loss: 0.3491 | Train Acc: 0.8599
 Site-Sketch                        | Train Loss: 0.1639 | Train Acc: 0.9492
 Site-QuickDraw                     | Train Loss: 0.6829 | Train Acc: 0.7325
 Site-QuickDraw                     | Train Loss: 0.6518 | Train Acc: 0.7818
 Site-Infograph                     | Train Loss: 1.2448 | Train Acc: 0.5987
 Site-Infograph                     | Train Loss: 0.9105 | Train Acc: 0.6949
Average Train Accuracy: 0.8639
 Site-Clipart                       | Val  Loss: 0.1600 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.2016 | Val  Acc: 0.9397
 Site-Real                          | Val  Loss: 0.0169 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0312 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0474 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0801 | Val  Acc: 0.9873
 Site-Sketch                        | Val  Loss: 0.1719 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.1529 | Val  Acc: 0.9714
 Site-QuickDraw                     | Val  Loss: 0.7306 | Val  Acc: 0.7619
 Site-QuickDraw                     | Val  Loss: 0.6755 | Val  Acc: 0.7968
 Site-Infograph                     | Val  Loss: 1.0609 | Val  Acc: 0.6667
 Site-Infograph                     | Val  Loss: 0.9272 | Val  Acc: 0.6889
Average Valid Accuracy: 0.8934
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.3102 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.1271 | Train Acc: 0.9597
 Site-Real                          | Train Loss: 0.0972 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0244 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.1640 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.0768 | Train Acc: 0.9809
 Site-Sketch                        | Train Loss: 0.2784 | Train Acc: 0.9045
 Site-Sketch                        | Train Loss: 0.1485 | Train Acc: 0.9703
 Site-QuickDraw                     | Train Loss: 0.7209 | Train Acc: 0.7261
 Site-QuickDraw                     | Train Loss: 0.6389 | Train Acc: 0.8030
 Site-Infograph                     | Train Loss: 1.2863 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 0.8975 | Train Acc: 0.7288
Average Train Accuracy: 0.8692
 Site-Clipart                       | Val  Loss: 0.1325 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.1848 | Val  Acc: 0.9460
 Site-Real                          | Val  Loss: 0.0181 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0268 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0604 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.0895 | Val  Acc: 0.9873
 Site-Sketch                        | Val  Loss: 0.1241 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.1892 | Val  Acc: 0.9492
 Site-QuickDraw                     | Val  Loss: 0.8447 | Val  Acc: 0.7143
 Site-QuickDraw                     | Val  Loss: 0.6452 | Val  Acc: 0.8222
 Site-Infograph                     | Val  Loss: 1.1246 | Val  Acc: 0.6667
 Site-Infograph                     | Val  Loss: 0.9262 | Val  Acc: 0.7079
Average Valid Accuracy: 0.8934
===2023-07-30 08:17:41===
===2023-07-30 08:17:57===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   | Epoch:44 | Test Acc: 0.9183
 Test site-Real                      | Epoch:44 | Test Acc: 0.9573
 Test site-Painting                  | Epoch:44 | Test Acc: 0.9370
 Test site-Sketch                    | Epoch:44 | Test Acc: 0.9025
 Test site-QuickDraw                 | Epoch:44 | Test Acc: 0.7180
 Test site-Infograph                 | Epoch:44 | Test Acc: 0.5799
Clipart: 0.9183, Real: 0.9573, Painting: 0.9370, Sketch: 0.9025, QuickDraw: 0.7180, Infograph: 0.5799, 
Average Test Accuracy(group): 0.8355, Average Test Accuracy(individual): 0.8355,
domain std=0.1388, cluster std=-1.0000, individual std=0.1388, 
