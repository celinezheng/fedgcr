===2023-07-01 20:45:34===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[630,394,246,153,96,60,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,1314,821,513,320,200,]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 1.0393 | Train Acc: 0.8302
 Site-Real                          | Train Loss: 0.7630 | Train Acc: 0.9594
 Site-Painting                      | Train Loss: 1.0270 | Train Acc: 0.8211
 Site-Sketch                        | Train Loss: 1.0824 | Train Acc: 0.6928
 Site-QuickDraw                     | Train Loss: 2.1017 | Train Acc: 0.3229
 Site-Infograph                     | Train Loss: 2.0418 | Train Acc: 0.2833
Average Train Accuracy: 0.6516
 Site-Clipart                       | Val  Loss: 1.0428 | Val  Acc: 0.8452
 Site-Real                          | Val  Loss: 0.7158 | Val  Acc: 0.9618
 Site-Painting                      | Val  Loss: 0.9719 | Val  Acc: 0.8476
 Site-Sketch                        | Val  Loss: 1.1685 | Val  Acc: 0.7549
 Site-QuickDraw                     | Val  Loss: 2.0378 | Val  Acc: 0.3281
 Site-Infograph                     | Val  Loss: 2.0302 | Val  Acc: 0.3250
Average Valid Accuracy: 0.6771
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.8452
 Best site-Real                      | Epoch:0 | Val Acc: 0.9618
 Best site-Painting                  | Epoch:0 | Val Acc: 0.8476
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.7549
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.3281
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.3250
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/harmo-fl...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 0.6385 | Train Acc: 0.8746
 Site-Real                          | Train Loss: 0.3374 | Train Acc: 0.9594
 Site-Painting                      | Train Loss: 0.6448 | Train Acc: 0.8618
 Site-Sketch                        | Train Loss: 0.8856 | Train Acc: 0.7647
 Site-QuickDraw                     | Train Loss: 1.9778 | Train Acc: 0.3542
 Site-Infograph                     | Train Loss: 1.9485 | Train Acc: 0.3000
Average Train Accuracy: 0.6858
 Site-Clipart                       | Val  Loss: 0.6613 | Val  Acc: 0.8667
 Site-Real                          | Val  Loss: 0.3362 | Val  Acc: 0.9580
 Site-Painting                      | Val  Loss: 0.5955 | Val  Acc: 0.8659
 Site-Sketch                        | Val  Loss: 0.8423 | Val  Acc: 0.7647
 Site-QuickDraw                     | Val  Loss: 2.0050 | Val  Acc: 0.3281
 Site-Infograph                     | Val  Loss: 1.9539 | Val  Acc: 0.4000
Average Valid Accuracy: 0.6972
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.8667
 Best site-Real                      | Epoch:1 | Val Acc: 0.9580
 Best site-Painting                  | Epoch:1 | Val Acc: 0.8659
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.7647
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.3281
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/harmo-fl...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 0.4802 | Train Acc: 0.8937
 Site-Real                          | Train Loss: 0.2120 | Train Acc: 0.9695
 Site-Painting                      | Train Loss: 0.5419 | Train Acc: 0.8618
 Site-Sketch                        | Train Loss: 0.7222 | Train Acc: 0.7582
 Site-QuickDraw                     | Train Loss: 1.9538 | Train Acc: 0.3229
 Site-Infograph                     | Train Loss: 1.8983 | Train Acc: 0.3333
Average Train Accuracy: 0.6899
 Site-Clipart                       | Val  Loss: 0.5229 | Val  Acc: 0.9000
 Site-Real                          | Val  Loss: 0.1917 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.4830 | Val  Acc: 0.8537
 Site-Sketch                        | Val  Loss: 0.7428 | Val  Acc: 0.7745
 Site-QuickDraw                     | Val  Loss: 1.8841 | Val  Acc: 0.3906
 Site-Infograph                     | Val  Loss: 1.8828 | Val  Acc: 0.3000
Average Valid Accuracy: 0.6974
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.9000
 Best site-Real                      | Epoch:2 | Val Acc: 0.9656
 Best site-Painting                  | Epoch:2 | Val Acc: 0.8537
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.7745
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.3906
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.3000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/harmo-fl...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 0.3793 | Train Acc: 0.9317
 Site-Real                          | Train Loss: 0.1567 | Train Acc: 0.9721
 Site-Painting                      | Train Loss: 0.4754 | Train Acc: 0.8537
 Site-Sketch                        | Train Loss: 0.5854 | Train Acc: 0.8301
 Site-QuickDraw                     | Train Loss: 1.7340 | Train Acc: 0.4062
 Site-Infograph                     | Train Loss: 1.9902 | Train Acc: 0.3000
Average Train Accuracy: 0.7156
 Site-Clipart                       | Val  Loss: 0.4332 | Val  Acc: 0.9095
 Site-Real                          | Val  Loss: 0.1467 | Val  Acc: 0.9771
 Site-Painting                      | Val  Loss: 0.4243 | Val  Acc: 0.8659
 Site-Sketch                        | Val  Loss: 0.6951 | Val  Acc: 0.7745
 Site-QuickDraw                     | Val  Loss: 1.8645 | Val  Acc: 0.3438
 Site-Infograph                     | Val  Loss: 1.8999 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7035
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.9095
 Best site-Real                      | Epoch:3 | Val Acc: 0.9771
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8659
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.7745
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.3438
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.3500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/harmo-fl...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 0.3172 | Train Acc: 0.9381
 Site-Real                          | Train Loss: 0.1381 | Train Acc: 0.9721
 Site-Painting                      | Train Loss: 0.4444 | Train Acc: 0.8699
 Site-Sketch                        | Train Loss: 0.6163 | Train Acc: 0.8039
 Site-QuickDraw                     | Train Loss: 1.9234 | Train Acc: 0.3542
 Site-Infograph                     | Train Loss: 1.8989 | Train Acc: 0.3500
Average Train Accuracy: 0.7147
 Site-Clipart                       | Val  Loss: 0.3970 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.1195 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.3919 | Val  Acc: 0.8659
 Site-Sketch                        | Val  Loss: 0.6995 | Val  Acc: 0.7745
 Site-QuickDraw                     | Val  Loss: 1.8998 | Val  Acc: 0.3750
 Site-Infograph                     | Val  Loss: 1.9860 | Val  Acc: 0.3250
Average Valid Accuracy: 0.7062
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.9238
 Best site-Real                      | Epoch:4 | Val Acc: 0.9733
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8659
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7745
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.3750
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.3250
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/harmo-fl...
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 0.2713 | Train Acc: 0.9333
 Site-Real                          | Train Loss: 0.1249 | Train Acc: 0.9746
 Site-Painting                      | Train Loss: 0.4128 | Train Acc: 0.8699
 Site-Sketch                        | Train Loss: 0.5386 | Train Acc: 0.8105
 Site-QuickDraw                     | Train Loss: 1.9563 | Train Acc: 0.3854
 Site-Infograph                     | Train Loss: 1.9294 | Train Acc: 0.3167
Average Train Accuracy: 0.7151
 Site-Clipart                       | Val  Loss: 0.3707 | Val  Acc: 0.9024
 Site-Real                          | Val  Loss: 0.1231 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.3656 | Val  Acc: 0.8841
 Site-Sketch                        | Val  Loss: 0.6591 | Val  Acc: 0.7941
 Site-QuickDraw                     | Val  Loss: 1.8460 | Val  Acc: 0.3906
 Site-Infograph                     | Val  Loss: 1.9338 | Val  Acc: 0.3000
Average Valid Accuracy: 0.7062
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 0.2832 | Train Acc: 0.9365
 Site-Real                          | Train Loss: 0.1160 | Train Acc: 0.9797
 Site-Painting                      | Train Loss: 0.3723 | Train Acc: 0.8862
 Site-Sketch                        | Train Loss: 0.4896 | Train Acc: 0.8105
 Site-QuickDraw                     | Train Loss: 1.8772 | Train Acc: 0.3646
 Site-Infograph                     | Train Loss: 1.9544 | Train Acc: 0.3167
Average Train Accuracy: 0.7157
 Site-Clipart                       | Val  Loss: 0.3082 | Val  Acc: 0.9167
 Site-Real                          | Val  Loss: 0.1000 | Val  Acc: 0.9695
 Site-Painting                      | Val  Loss: 0.3498 | Val  Acc: 0.8659
 Site-Sketch                        | Val  Loss: 0.6321 | Val  Acc: 0.7941
 Site-QuickDraw                     | Val  Loss: 1.8109 | Val  Acc: 0.4062
 Site-Infograph                     | Val  Loss: 1.7846 | Val  Acc: 0.4500
Average Valid Accuracy: 0.7337
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.9167
 Best site-Real                      | Epoch:6 | Val Acc: 0.9695
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8659
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.7941
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.4062
 Best site-Infograph                 | Epoch:6 | Val Acc: 0.4500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/harmo-fl...
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 0.2301 | Train Acc: 0.9587
 Site-Real                          | Train Loss: 0.0808 | Train Acc: 0.9873
 Site-Painting                      | Train Loss: 0.3861 | Train Acc: 0.8902
 Site-Sketch                        | Train Loss: 0.5685 | Train Acc: 0.8301
 Site-QuickDraw                     | Train Loss: 1.9060 | Train Acc: 0.3542
 Site-Infograph                     | Train Loss: 2.1093 | Train Acc: 0.2500
Average Train Accuracy: 0.7118
 Site-Clipart                       | Val  Loss: 0.3184 | Val  Acc: 0.9190
 Site-Real                          | Val  Loss: 0.1209 | Val  Acc: 0.9580
 Site-Painting                      | Val  Loss: 0.3206 | Val  Acc: 0.9207
 Site-Sketch                        | Val  Loss: 0.5937 | Val  Acc: 0.7745
 Site-QuickDraw                     | Val  Loss: 1.7701 | Val  Acc: 0.4219
 Site-Infograph                     | Val  Loss: 1.7548 | Val  Acc: 0.3250
Average Valid Accuracy: 0.7199
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 0.1961 | Train Acc: 0.9619
 Site-Real                          | Train Loss: 0.0864 | Train Acc: 0.9873
 Site-Painting                      | Train Loss: 0.3464 | Train Acc: 0.8821
 Site-Sketch                        | Train Loss: 0.4792 | Train Acc: 0.8562
 Site-QuickDraw                     | Train Loss: 1.8361 | Train Acc: 0.3542
 Site-Infograph                     | Train Loss: 1.9816 | Train Acc: 0.3000
Average Train Accuracy: 0.7236
 Site-Clipart                       | Val  Loss: 0.2746 | Val  Acc: 0.9381
 Site-Real                          | Val  Loss: 0.0995 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.3153 | Val  Acc: 0.8902
 Site-Sketch                        | Val  Loss: 0.6373 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.8473 | Val  Acc: 0.3594
 Site-Infograph                     | Val  Loss: 1.8071 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7188
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 0.2060 | Train Acc: 0.9571
 Site-Real                          | Train Loss: 0.0800 | Train Acc: 0.9898
 Site-Painting                      | Train Loss: 0.3133 | Train Acc: 0.9146
 Site-Sketch                        | Train Loss: 0.4980 | Train Acc: 0.8170
 Site-QuickDraw                     | Train Loss: 1.7193 | Train Acc: 0.4271
 Site-Infograph                     | Train Loss: 2.1128 | Train Acc: 0.3333
Average Train Accuracy: 0.7398
 Site-Clipart                       | Val  Loss: 0.2565 | Val  Acc: 0.9286
 Site-Real                          | Val  Loss: 0.0901 | Val  Acc: 0.9695
 Site-Painting                      | Val  Loss: 0.3003 | Val  Acc: 0.8963
 Site-Sketch                        | Val  Loss: 0.4895 | Val  Acc: 0.8529
 Site-QuickDraw                     | Val  Loss: 1.8037 | Val  Acc: 0.3906
 Site-Infograph                     | Val  Loss: 1.9364 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7355
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9286
 Best site-Real                      | Epoch:9 | Val Acc: 0.9695
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8963
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8529
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.3906
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.3750
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/harmo-fl...
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 0.1788 | Train Acc: 0.9667
 Site-Real                          | Train Loss: 0.0775 | Train Acc: 0.9924
 Site-Painting                      | Train Loss: 0.2881 | Train Acc: 0.9146
 Site-Sketch                        | Train Loss: 0.5758 | Train Acc: 0.8235
 Site-QuickDraw                     | Train Loss: 1.8973 | Train Acc: 0.4167
 Site-Infograph                     | Train Loss: 1.9852 | Train Acc: 0.3500
Average Train Accuracy: 0.7440
 Site-Clipart                       | Val  Loss: 0.2483 | Val  Acc: 0.9452
 Site-Real                          | Val  Loss: 0.0794 | Val  Acc: 0.9809
 Site-Painting                      | Val  Loss: 0.2600 | Val  Acc: 0.9268
 Site-Sketch                        | Val  Loss: 0.5784 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.8959 | Val  Acc: 0.3750
 Site-Infograph                     | Val  Loss: 1.8455 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7410
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9452
 Best site-Real                      | Epoch:10 | Val Acc: 0.9809
 Best site-Painting                  | Epoch:10 | Val Acc: 0.9268
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.8431
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.3750
 Best site-Infograph                 | Epoch:10 | Val Acc: 0.3750
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/harmo-fl...
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 0.1615 | Train Acc: 0.9730
 Site-Real                          | Train Loss: 0.0794 | Train Acc: 0.9924
 Site-Painting                      | Train Loss: 0.2754 | Train Acc: 0.9106
 Site-Sketch                        | Train Loss: 0.5664 | Train Acc: 0.8235
 Site-QuickDraw                     | Train Loss: 1.7133 | Train Acc: 0.3438
 Site-Infograph                     | Train Loss: 2.0331 | Train Acc: 0.3500
Average Train Accuracy: 0.7322
 Site-Clipart                       | Val  Loss: 0.2340 | Val  Acc: 0.9452
 Site-Real                          | Val  Loss: 0.0758 | Val  Acc: 0.9847
 Site-Painting                      | Val  Loss: 0.3195 | Val  Acc: 0.9024
 Site-Sketch                        | Val  Loss: 0.5491 | Val  Acc: 0.8529
 Site-QuickDraw                     | Val  Loss: 1.8764 | Val  Acc: 0.3750
 Site-Infograph                     | Val  Loss: 1.7105 | Val  Acc: 0.4750
Average Valid Accuracy: 0.7559
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9452
 Best site-Real                      | Epoch:11 | Val Acc: 0.9847
 Best site-Painting                  | Epoch:11 | Val Acc: 0.9024
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.8529
 Best site-QuickDraw                 | Epoch:11 | Val Acc: 0.3750
 Best site-Infograph                 | Epoch:11 | Val Acc: 0.4750
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/harmo-fl...
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 0.1356 | Train Acc: 0.9810
 Site-Real                          | Train Loss: 0.0694 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.3326 | Train Acc: 0.8984
 Site-Sketch                        | Train Loss: 0.4820 | Train Acc: 0.8497
 Site-QuickDraw                     | Train Loss: 1.7507 | Train Acc: 0.3646
 Site-Infograph                     | Train Loss: 2.0795 | Train Acc: 0.3667
Average Train Accuracy: 0.7425
 Site-Clipart                       | Val  Loss: 0.2399 | Val  Acc: 0.9476
 Site-Real                          | Val  Loss: 0.0991 | Val  Acc: 0.9618
 Site-Painting                      | Val  Loss: 0.2826 | Val  Acc: 0.9146
 Site-Sketch                        | Val  Loss: 0.6220 | Val  Acc: 0.7745
 Site-QuickDraw                     | Val  Loss: 1.8724 | Val  Acc: 0.3906
 Site-Infograph                     | Val  Loss: 1.9349 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7232
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 0.1403 | Train Acc: 0.9730
 Site-Real                          | Train Loss: 0.0480 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.2799 | Train Acc: 0.9065
 Site-Sketch                        | Train Loss: 0.4708 | Train Acc: 0.8758
 Site-QuickDraw                     | Train Loss: 1.7612 | Train Acc: 0.4583
 Site-Infograph                     | Train Loss: 2.0307 | Train Acc: 0.3333
Average Train Accuracy: 0.7570
 Site-Clipart                       | Val  Loss: 0.2279 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 0.0774 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.2904 | Val  Acc: 0.9085
 Site-Sketch                        | Val  Loss: 0.5802 | Val  Acc: 0.8333
 Site-QuickDraw                     | Val  Loss: 1.6777 | Val  Acc: 0.4531
 Site-Infograph                     | Val  Loss: 1.8901 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7503
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 0.1434 | Train Acc: 0.9730
 Site-Real                          | Train Loss: 0.0430 | Train Acc: 0.9898
 Site-Painting                      | Train Loss: 0.3132 | Train Acc: 0.8862
 Site-Sketch                        | Train Loss: 0.4762 | Train Acc: 0.8562
 Site-QuickDraw                     | Train Loss: 1.9471 | Train Acc: 0.3958
 Site-Infograph                     | Train Loss: 2.0375 | Train Acc: 0.4000
Average Train Accuracy: 0.7502
 Site-Clipart                       | Val  Loss: 0.2374 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.0779 | Val  Acc: 0.9809
 Site-Painting                      | Val  Loss: 0.3029 | Val  Acc: 0.9024
 Site-Sketch                        | Val  Loss: 0.5886 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.8194 | Val  Acc: 0.3438
 Site-Infograph                     | Val  Loss: 1.6870 | Val  Acc: 0.4500
Average Valid Accuracy: 0.7435
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 0.1405 | Train Acc: 0.9651
 Site-Real                          | Train Loss: 0.0479 | Train Acc: 0.9898
 Site-Painting                      | Train Loss: 0.2589 | Train Acc: 0.9146
 Site-Sketch                        | Train Loss: 0.5259 | Train Acc: 0.8301
 Site-QuickDraw                     | Train Loss: 1.8107 | Train Acc: 0.4479
 Site-Infograph                     | Train Loss: 2.0224 | Train Acc: 0.3333
Average Train Accuracy: 0.7468
 Site-Clipart                       | Val  Loss: 0.1938 | Val  Acc: 0.9548
 Site-Real                          | Val  Loss: 0.0793 | Val  Acc: 0.9695
 Site-Painting                      | Val  Loss: 0.2800 | Val  Acc: 0.8780
 Site-Sketch                        | Val  Loss: 0.5448 | Val  Acc: 0.8333
 Site-QuickDraw                     | Val  Loss: 1.8268 | Val  Acc: 0.4062
 Site-Infograph                     | Val  Loss: 1.9377 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7320
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 0.1288 | Train Acc: 0.9746
 Site-Real                          | Train Loss: 0.0394 | Train Acc: 0.9975
 Site-Painting                      | Train Loss: 0.2764 | Train Acc: 0.9228
 Site-Sketch                        | Train Loss: 0.4384 | Train Acc: 0.8758
 Site-QuickDraw                     | Train Loss: 2.0283 | Train Acc: 0.4167
 Site-Infograph                     | Train Loss: 2.0369 | Train Acc: 0.3500
Average Train Accuracy: 0.7562
 Site-Clipart                       | Val  Loss: 0.2233 | Val  Acc: 0.9381
 Site-Real                          | Val  Loss: 0.0591 | Val  Acc: 0.9847
 Site-Painting                      | Val  Loss: 0.2631 | Val  Acc: 0.9085
 Site-Sketch                        | Val  Loss: 0.6228 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.9015 | Val  Acc: 0.4375
 Site-Infograph                     | Val  Loss: 1.8595 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7478
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 0.1132 | Train Acc: 0.9746
 Site-Real                          | Train Loss: 0.0367 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.2325 | Train Acc: 0.9268
 Site-Sketch                        | Train Loss: 0.4516 | Train Acc: 0.8693
 Site-QuickDraw                     | Train Loss: 1.7126 | Train Acc: 0.4271
 Site-Infograph                     | Train Loss: 2.1097 | Train Acc: 0.3667
Average Train Accuracy: 0.7599
 Site-Clipart                       | Val  Loss: 0.2076 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0749 | Val  Acc: 0.9771
 Site-Painting                      | Val  Loss: 0.2996 | Val  Acc: 0.9024
 Site-Sketch                        | Val  Loss: 0.5950 | Val  Acc: 0.8137
 Site-QuickDraw                     | Val  Loss: 1.7025 | Val  Acc: 0.3906
 Site-Infograph                     | Val  Loss: 1.8514 | Val  Acc: 0.4250
Average Valid Accuracy: 0.7420
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 0.1250 | Train Acc: 0.9714
 Site-Real                          | Train Loss: 0.0304 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.2442 | Train Acc: 0.9146
 Site-Sketch                        | Train Loss: 0.4594 | Train Acc: 0.8366
 Site-QuickDraw                     | Train Loss: 1.9867 | Train Acc: 0.3854
 Site-Infograph                     | Train Loss: 2.2383 | Train Acc: 0.2833
Average Train Accuracy: 0.7311
 Site-Clipart                       | Val  Loss: 0.2033 | Val  Acc: 0.9500
 Site-Real                          | Val  Loss: 0.0564 | Val  Acc: 0.9809
 Site-Painting                      | Val  Loss: 0.2673 | Val  Acc: 0.9146
 Site-Sketch                        | Val  Loss: 0.6183 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.8171 | Val  Acc: 0.4375
 Site-Infograph                     | Val  Loss: 1.8940 | Val  Acc: 0.4250
Average Valid Accuracy: 0.7553
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 0.1099 | Train Acc: 0.9778
 Site-Real                          | Train Loss: 0.0290 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.2686 | Train Acc: 0.9146
 Site-Sketch                        | Train Loss: 0.4165 | Train Acc: 0.8627
 Site-QuickDraw                     | Train Loss: 1.9218 | Train Acc: 0.3646
 Site-Infograph                     | Train Loss: 2.1411 | Train Acc: 0.2833
Average Train Accuracy: 0.7330
 Site-Clipart                       | Val  Loss: 0.2136 | Val  Acc: 0.9500
 Site-Real                          | Val  Loss: 0.0657 | Val  Acc: 0.9771
 Site-Painting                      | Val  Loss: 0.3025 | Val  Acc: 0.9207
 Site-Sketch                        | Val  Loss: 0.5642 | Val  Acc: 0.8333
 Site-QuickDraw                     | Val  Loss: 1.8400 | Val  Acc: 0.4375
 Site-Infograph                     | Val  Loss: 2.1008 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7448
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 0.1049 | Train Acc: 0.9762
 Site-Real                          | Train Loss: 0.0529 | Train Acc: 0.9924
 Site-Painting                      | Train Loss: 0.2440 | Train Acc: 0.9350
 Site-Sketch                        | Train Loss: 0.3908 | Train Acc: 0.8889
 Site-QuickDraw                     | Train Loss: 1.9371 | Train Acc: 0.3750
 Site-Infograph                     | Train Loss: 2.1947 | Train Acc: 0.3500
Average Train Accuracy: 0.7529
 Site-Clipart                       | Val  Loss: 0.2019 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0708 | Val  Acc: 0.9771
 Site-Painting                      | Val  Loss: 0.2508 | Val  Acc: 0.9146
 Site-Sketch                        | Val  Loss: 0.5835 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.9180 | Val  Acc: 0.3438
 Site-Infograph                     | Val  Loss: 1.7500 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7385
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 0.1075 | Train Acc: 0.9794
 Site-Real                          | Train Loss: 0.0320 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.2470 | Train Acc: 0.9106
 Site-Sketch                        | Train Loss: 0.3822 | Train Acc: 0.8824
 Site-QuickDraw                     | Train Loss: 1.8462 | Train Acc: 0.4167
 Site-Infograph                     | Train Loss: 2.0591 | Train Acc: 0.3000
Average Train Accuracy: 0.7473
 Site-Clipart                       | Val  Loss: 0.1865 | Val  Acc: 0.9548
 Site-Real                          | Val  Loss: 0.0736 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.2491 | Val  Acc: 0.9024
 Site-Sketch                        | Val  Loss: 0.5797 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.8813 | Val  Acc: 0.4219
 Site-Infograph                     | Val  Loss: 1.7335 | Val  Acc: 0.4500
Average Valid Accuracy: 0.7543
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 0.1015 | Train Acc: 0.9810
 Site-Real                          | Train Loss: 0.0302 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.2148 | Train Acc: 0.9268
 Site-Sketch                        | Train Loss: 0.3819 | Train Acc: 0.8758
 Site-QuickDraw                     | Train Loss: 1.7229 | Train Acc: 0.4688
 Site-Infograph                     | Train Loss: 2.0622 | Train Acc: 0.3333
Average Train Accuracy: 0.7634
 Site-Clipart                       | Val  Loss: 0.2150 | Val  Acc: 0.9476
 Site-Real                          | Val  Loss: 0.0677 | Val  Acc: 0.9695
 Site-Painting                      | Val  Loss: 0.3072 | Val  Acc: 0.8963
 Site-Sketch                        | Val  Loss: 0.5751 | Val  Acc: 0.8627
 Site-QuickDraw                     | Val  Loss: 1.8483 | Val  Acc: 0.4062
 Site-Infograph                     | Val  Loss: 1.8092 | Val  Acc: 0.4500
Average Valid Accuracy: 0.7554
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.0861 | Train Acc: 0.9810
 Site-Real                          | Train Loss: 0.0252 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.2526 | Train Acc: 0.9309
 Site-Sketch                        | Train Loss: 0.4748 | Train Acc: 0.8366
 Site-QuickDraw                     | Train Loss: 1.8452 | Train Acc: 0.3958
 Site-Infograph                     | Train Loss: 2.2323 | Train Acc: 0.3667
Average Train Accuracy: 0.7510
 Site-Clipart                       | Val  Loss: 0.1879 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0709 | Val  Acc: 0.9695
 Site-Painting                      | Val  Loss: 0.2989 | Val  Acc: 0.8902
 Site-Sketch                        | Val  Loss: 0.5543 | Val  Acc: 0.8333
 Site-QuickDraw                     | Val  Loss: 1.8783 | Val  Acc: 0.3750
 Site-Infograph                     | Val  Loss: 2.0251 | Val  Acc: 0.3250
Average Valid Accuracy: 0.7242
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 0.1008 | Train Acc: 0.9794
 Site-Real                          | Train Loss: 0.0240 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.2220 | Train Acc: 0.9228
 Site-Sketch                        | Train Loss: 0.5110 | Train Acc: 0.8562
 Site-QuickDraw                     | Train Loss: 1.8882 | Train Acc: 0.3958
 Site-Infograph                     | Train Loss: 2.1494 | Train Acc: 0.4167
Average Train Accuracy: 0.7610
 Site-Clipart                       | Val  Loss: 0.2032 | Val  Acc: 0.9452
 Site-Real                          | Val  Loss: 0.0650 | Val  Acc: 0.9695
 Site-Painting                      | Val  Loss: 0.2284 | Val  Acc: 0.9390
 Site-Sketch                        | Val  Loss: 0.5866 | Val  Acc: 0.8725
 Site-QuickDraw                     | Val  Loss: 1.8412 | Val  Acc: 0.4062
 Site-Infograph                     | Val  Loss: 2.0119 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7554
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 0.0852 | Train Acc: 0.9841
 Site-Real                          | Train Loss: 0.0328 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.2496 | Train Acc: 0.9106
 Site-Sketch                        | Train Loss: 0.3592 | Train Acc: 0.9085
 Site-QuickDraw                     | Train Loss: 1.8323 | Train Acc: 0.4375
 Site-Infograph                     | Train Loss: 2.1452 | Train Acc: 0.3333
Average Train Accuracy: 0.7615
 Site-Clipart                       | Val  Loss: 0.2119 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0737 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.2676 | Val  Acc: 0.9024
 Site-Sketch                        | Val  Loss: 0.5203 | Val  Acc: 0.8529
 Site-QuickDraw                     | Val  Loss: 1.6519 | Val  Acc: 0.4219
 Site-Infograph                     | Val  Loss: 1.9665 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7447
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.0793 | Train Acc: 0.9841
 Site-Real                          | Train Loss: 0.0205 | Train Acc: 0.9975
 Site-Painting                      | Train Loss: 0.1954 | Train Acc: 0.9268
 Site-Sketch                        | Train Loss: 0.3954 | Train Acc: 0.8824
 Site-QuickDraw                     | Train Loss: 1.7889 | Train Acc: 0.4271
 Site-Infograph                     | Train Loss: 2.2130 | Train Acc: 0.3333
Average Train Accuracy: 0.7585
 Site-Clipart                       | Val  Loss: 0.1845 | Val  Acc: 0.9452
 Site-Real                          | Val  Loss: 0.0564 | Val  Acc: 0.9809
 Site-Painting                      | Val  Loss: 0.2973 | Val  Acc: 0.9146
 Site-Sketch                        | Val  Loss: 0.5493 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.8196 | Val  Acc: 0.4062
 Site-Infograph                     | Val  Loss: 1.9942 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7400
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 0.0853 | Train Acc: 0.9857
 Site-Real                          | Train Loss: 0.0218 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.2129 | Train Acc: 0.9228
 Site-Sketch                        | Train Loss: 0.3011 | Train Acc: 0.9216
 Site-QuickDraw                     | Train Loss: 1.6707 | Train Acc: 0.4792
 Site-Infograph                     | Train Loss: 2.1041 | Train Acc: 0.3500
Average Train Accuracy: 0.7757
 Site-Clipart                       | Val  Loss: 0.1896 | Val  Acc: 0.9571
 Site-Real                          | Val  Loss: 0.0789 | Val  Acc: 0.9695
 Site-Painting                      | Val  Loss: 0.2711 | Val  Acc: 0.9146
 Site-Sketch                        | Val  Loss: 0.4803 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.6294 | Val  Acc: 0.4688
 Site-Infograph                     | Val  Loss: 1.8588 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7547
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 0.0969 | Train Acc: 0.9762
 Site-Real                          | Train Loss: 0.0247 | Train Acc: 0.9924
 Site-Painting                      | Train Loss: 0.1814 | Train Acc: 0.9553
 Site-Sketch                        | Train Loss: 0.5029 | Train Acc: 0.8627
 Site-QuickDraw                     | Train Loss: 1.6159 | Train Acc: 0.5312
 Site-Infograph                     | Train Loss: 2.1924 | Train Acc: 0.3333
Average Train Accuracy: 0.7752
 Site-Clipart                       | Val  Loss: 0.1862 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0583 | Val  Acc: 0.9809
 Site-Painting                      | Val  Loss: 0.3155 | Val  Acc: 0.8963
 Site-Sketch                        | Val  Loss: 0.4791 | Val  Acc: 0.8824
 Site-QuickDraw                     | Val  Loss: 1.7509 | Val  Acc: 0.4062
 Site-Infograph                     | Val  Loss: 1.7171 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7697
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.9524
 Best site-Real                      | Epoch:28 | Val Acc: 0.9809
 Best site-Painting                  | Epoch:28 | Val Acc: 0.8963
 Best site-Sketch                    | Epoch:28 | Val Acc: 0.8824
 Best site-QuickDraw                 | Epoch:28 | Val Acc: 0.4062
 Best site-Infograph                 | Epoch:28 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/harmo-fl...
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.0805 | Train Acc: 0.9841
 Site-Real                          | Train Loss: 0.0245 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.1868 | Train Acc: 0.9472
 Site-Sketch                        | Train Loss: 0.3661 | Train Acc: 0.8889
 Site-QuickDraw                     | Train Loss: 1.7549 | Train Acc: 0.4167
 Site-Infograph                     | Train Loss: 2.1581 | Train Acc: 0.3167
Average Train Accuracy: 0.7581
 Site-Clipart                       | Val  Loss: 0.1880 | Val  Acc: 0.9595
 Site-Real                          | Val  Loss: 0.0601 | Val  Acc: 0.9847
 Site-Painting                      | Val  Loss: 0.2152 | Val  Acc: 0.9451
 Site-Sketch                        | Val  Loss: 0.5717 | Val  Acc: 0.8529
 Site-QuickDraw                     | Val  Loss: 1.7767 | Val  Acc: 0.4688
 Site-Infograph                     | Val  Loss: 1.7393 | Val  Acc: 0.4250
Average Valid Accuracy: 0.7727
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.9595
 Best site-Real                      | Epoch:29 | Val Acc: 0.9847
 Best site-Painting                  | Epoch:29 | Val Acc: 0.9451
 Best site-Sketch                    | Epoch:29 | Val Acc: 0.8529
 Best site-QuickDraw                 | Epoch:29 | Val Acc: 0.4688
 Best site-Infograph                 | Epoch:29 | Val Acc: 0.4250
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/harmo-fl...
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.0792 | Train Acc: 0.9873
 Site-Real                          | Train Loss: 0.0183 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.1717 | Train Acc: 0.9512
 Site-Sketch                        | Train Loss: 0.3452 | Train Acc: 0.9020
 Site-QuickDraw                     | Train Loss: 1.8168 | Train Acc: 0.4688
 Site-Infograph                     | Train Loss: 2.1765 | Train Acc: 0.3000
Average Train Accuracy: 0.7674
 Site-Clipart                       | Val  Loss: 0.1755 | Val  Acc: 0.9571
 Site-Real                          | Val  Loss: 0.0574 | Val  Acc: 0.9809
 Site-Painting                      | Val  Loss: 0.3745 | Val  Acc: 0.8537
 Site-Sketch                        | Val  Loss: 0.5332 | Val  Acc: 0.8627
 Site-QuickDraw                     | Val  Loss: 1.6810 | Val  Acc: 0.5156
 Site-Infograph                     | Val  Loss: 1.8581 | Val  Acc: 0.4750
Average Valid Accuracy: 0.7742
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.9571
 Best site-Real                      | Epoch:30 | Val Acc: 0.9809
 Best site-Painting                  | Epoch:30 | Val Acc: 0.8537
 Best site-Sketch                    | Epoch:30 | Val Acc: 0.8627
 Best site-QuickDraw                 | Epoch:30 | Val Acc: 0.5156
 Best site-Infograph                 | Epoch:30 | Val Acc: 0.4750
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/harmo-fl...
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.0909 | Train Acc: 0.9714
 Site-Real                          | Train Loss: 0.0223 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.1771 | Train Acc: 0.9675
 Site-Sketch                        | Train Loss: 0.4335 | Train Acc: 0.8824
 Site-QuickDraw                     | Train Loss: 1.8359 | Train Acc: 0.4167
 Site-Infograph                     | Train Loss: 2.1056 | Train Acc: 0.2833
Average Train Accuracy: 0.7527
 Site-Clipart                       | Val  Loss: 0.1669 | Val  Acc: 0.9571
 Site-Real                          | Val  Loss: 0.0759 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.2445 | Val  Acc: 0.9146
 Site-Sketch                        | Val  Loss: 0.5467 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.8810 | Val  Acc: 0.4219
 Site-Infograph                     | Val  Loss: 1.9651 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7442
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.0835 | Train Acc: 0.9794
 Site-Real                          | Train Loss: 0.0181 | Train Acc: 0.9975
 Site-Painting                      | Train Loss: 0.1968 | Train Acc: 0.9268
 Site-Sketch                        | Train Loss: 0.4182 | Train Acc: 0.8758
 Site-QuickDraw                     | Train Loss: 1.7447 | Train Acc: 0.4271
 Site-Infograph                     | Train Loss: 2.1655 | Train Acc: 0.3667
Average Train Accuracy: 0.7622
 Site-Clipart                       | Val  Loss: 0.1889 | Val  Acc: 0.9500
 Site-Real                          | Val  Loss: 0.0716 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.2664 | Val  Acc: 0.9146
 Site-Sketch                        | Val  Loss: 0.6922 | Val  Acc: 0.8137
 Site-QuickDraw                     | Val  Loss: 2.0200 | Val  Acc: 0.4688
 Site-Infograph                     | Val  Loss: 2.0082 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7480
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.0727 | Train Acc: 0.9873
 Site-Real                          | Train Loss: 0.0204 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.1818 | Train Acc: 0.9634
 Site-Sketch                        | Train Loss: 0.3202 | Train Acc: 0.8954
 Site-QuickDraw                     | Train Loss: 1.9776 | Train Acc: 0.4271
 Site-Infograph                     | Train Loss: 2.1388 | Train Acc: 0.3333
Average Train Accuracy: 0.7669
 Site-Clipart                       | Val  Loss: 0.1671 | Val  Acc: 0.9548
 Site-Real                          | Val  Loss: 0.0613 | Val  Acc: 0.9771
 Site-Painting                      | Val  Loss: 0.3259 | Val  Acc: 0.8841
 Site-Sketch                        | Val  Loss: 0.5599 | Val  Acc: 0.8529
 Site-QuickDraw                     | Val  Loss: 1.9229 | Val  Acc: 0.3594
 Site-Infograph                     | Val  Loss: 1.7122 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7381
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 0.0762 | Train Acc: 0.9841
 Site-Real                          | Train Loss: 0.0493 | Train Acc: 0.9924
 Site-Painting                      | Train Loss: 0.1834 | Train Acc: 0.9472
 Site-Sketch                        | Train Loss: 0.3952 | Train Acc: 0.8562
 Site-QuickDraw                     | Train Loss: 1.7308 | Train Acc: 0.4479
 Site-Infograph                     | Train Loss: 2.1578 | Train Acc: 0.3667
Average Train Accuracy: 0.7657
 Site-Clipart                       | Val  Loss: 0.1535 | Val  Acc: 0.9643
 Site-Real                          | Val  Loss: 0.0712 | Val  Acc: 0.9695
 Site-Painting                      | Val  Loss: 0.2323 | Val  Acc: 0.9512
 Site-Sketch                        | Val  Loss: 0.5148 | Val  Acc: 0.8725
 Site-QuickDraw                     | Val  Loss: 1.9326 | Val  Acc: 0.4219
 Site-Infograph                     | Val  Loss: 1.9433 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7632
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 0.0799 | Train Acc: 0.9841
 Site-Real                          | Train Loss: 0.0209 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.2329 | Train Acc: 0.9350
 Site-Sketch                        | Train Loss: 0.3527 | Train Acc: 0.9085
 Site-QuickDraw                     | Train Loss: 1.6526 | Train Acc: 0.4271
 Site-Infograph                     | Train Loss: 2.1566 | Train Acc: 0.3667
Average Train Accuracy: 0.7694
 Site-Clipart                       | Val  Loss: 0.1913 | Val  Acc: 0.9500
 Site-Real                          | Val  Loss: 0.0615 | Val  Acc: 0.9695
 Site-Painting                      | Val  Loss: 0.2651 | Val  Acc: 0.9024
 Site-Sketch                        | Val  Loss: 0.5648 | Val  Acc: 0.8529
 Site-QuickDraw                     | Val  Loss: 1.9562 | Val  Acc: 0.3750
 Site-Infograph                     | Val  Loss: 1.9585 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7333
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.0757 | Train Acc: 0.9841
 Site-Real                          | Train Loss: 0.0278 | Train Acc: 0.9924
 Site-Painting                      | Train Loss: 0.1591 | Train Acc: 0.9512
 Site-Sketch                        | Train Loss: 0.3914 | Train Acc: 0.8562
 Site-QuickDraw                     | Train Loss: 1.6585 | Train Acc: 0.4896
 Site-Infograph                     | Train Loss: 2.1237 | Train Acc: 0.3667
Average Train Accuracy: 0.7734
 Site-Clipart                       | Val  Loss: 0.1600 | Val  Acc: 0.9548
 Site-Real                          | Val  Loss: 0.0746 | Val  Acc: 0.9618
 Site-Painting                      | Val  Loss: 0.2892 | Val  Acc: 0.9268
 Site-Sketch                        | Val  Loss: 0.5410 | Val  Acc: 0.8725
 Site-QuickDraw                     | Val  Loss: 1.7490 | Val  Acc: 0.5000
 Site-Infograph                     | Val  Loss: 1.7458 | Val  Acc: 0.4500
Average Valid Accuracy: 0.7777
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.9548
 Best site-Real                      | Epoch:36 | Val Acc: 0.9618
 Best site-Painting                  | Epoch:36 | Val Acc: 0.9268
 Best site-Sketch                    | Epoch:36 | Val Acc: 0.8725
 Best site-QuickDraw                 | Epoch:36 | Val Acc: 0.5000
 Best site-Infograph                 | Epoch:36 | Val Acc: 0.4500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/harmo-fl...
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 0.0682 | Train Acc: 0.9873
 Site-Real                          | Train Loss: 0.0194 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.1570 | Train Acc: 0.9472
 Site-Sketch                        | Train Loss: 0.3486 | Train Acc: 0.8824
 Site-QuickDraw                     | Train Loss: 1.7170 | Train Acc: 0.3854
 Site-Infograph                     | Train Loss: 2.3080 | Train Acc: 0.3167
Average Train Accuracy: 0.7523
 Site-Clipart                       | Val  Loss: 0.2176 | Val  Acc: 0.9476
 Site-Real                          | Val  Loss: 0.0672 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.2752 | Val  Acc: 0.9024
 Site-Sketch                        | Val  Loss: 0.5440 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.7445 | Val  Acc: 0.3906
 Site-Infograph                     | Val  Loss: 1.9667 | Val  Acc: 0.4750
Average Valid Accuracy: 0.7554
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.0801 | Train Acc: 0.9810
 Site-Real                          | Train Loss: 0.0205 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.1281 | Train Acc: 0.9634
 Site-Sketch                        | Train Loss: 0.4278 | Train Acc: 0.8824
 Site-QuickDraw                     | Train Loss: 1.6377 | Train Acc: 0.4583
 Site-Infograph                     | Train Loss: 2.2238 | Train Acc: 0.3833
Average Train Accuracy: 0.7772
 Site-Clipart                       | Val  Loss: 0.1688 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.0732 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.2508 | Val  Acc: 0.9146
 Site-Sketch                        | Val  Loss: 0.5077 | Val  Acc: 0.8725
 Site-QuickDraw                     | Val  Loss: 1.7498 | Val  Acc: 0.4375
 Site-Infograph                     | Val  Loss: 1.7729 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7587
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.0751 | Train Acc: 0.9857
 Site-Real                          | Train Loss: 0.0187 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.1756 | Train Acc: 0.9431
 Site-Sketch                        | Train Loss: 0.3905 | Train Acc: 0.8693
 Site-QuickDraw                     | Train Loss: 1.6993 | Train Acc: 0.4896
 Site-Infograph                     | Train Loss: 2.1392 | Train Acc: 0.3500
Average Train Accuracy: 0.7721
 Site-Clipart                       | Val  Loss: 0.1907 | Val  Acc: 0.9548
 Site-Real                          | Val  Loss: 0.0582 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.3267 | Val  Acc: 0.9085
 Site-Sketch                        | Val  Loss: 0.4566 | Val  Acc: 0.8725
 Site-QuickDraw                     | Val  Loss: 1.7578 | Val  Acc: 0.3906
 Site-Infograph                     | Val  Loss: 1.9700 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7458
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.0798 | Train Acc: 0.9794
 Site-Real                          | Train Loss: 0.0173 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.1527 | Train Acc: 0.9634
 Site-Sketch                        | Train Loss: 0.3674 | Train Acc: 0.8824
 Site-QuickDraw                     | Train Loss: 1.8000 | Train Acc: 0.4479
 Site-Infograph                     | Train Loss: 2.0601 | Train Acc: 0.3333
Average Train Accuracy: 0.7669
 Site-Clipart                       | Val  Loss: 0.1849 | Val  Acc: 0.9476
 Site-Real                          | Val  Loss: 0.0574 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.2477 | Val  Acc: 0.9207
 Site-Sketch                        | Val  Loss: 0.5257 | Val  Acc: 0.8529
 Site-QuickDraw                     | Val  Loss: 1.9324 | Val  Acc: 0.3750
 Site-Infograph                     | Val  Loss: 1.9115 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7449
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 0.0729 | Train Acc: 0.9794
 Site-Real                          | Train Loss: 0.0217 | Train Acc: 0.9924
 Site-Painting                      | Train Loss: 0.1345 | Train Acc: 0.9593
 Site-Sketch                        | Train Loss: 0.3896 | Train Acc: 0.8889
 Site-QuickDraw                     | Train Loss: 1.8448 | Train Acc: 0.4271
 Site-Infograph                     | Train Loss: 2.1925 | Train Acc: 0.3833
Average Train Accuracy: 0.7717
 Site-Clipart                       | Val  Loss: 0.1906 | Val  Acc: 0.9476
 Site-Real                          | Val  Loss: 0.0650 | Val  Acc: 0.9771
 Site-Painting                      | Val  Loss: 0.2773 | Val  Acc: 0.9207
 Site-Sketch                        | Val  Loss: 0.5730 | Val  Acc: 0.8529
 Site-QuickDraw                     | Val  Loss: 1.7263 | Val  Acc: 0.5156
 Site-Infograph                     | Val  Loss: 1.7259 | Val  Acc: 0.4750
Average Valid Accuracy: 0.7815
 Best site-Clipart                   | Epoch:41 | Val Acc: 0.9476
 Best site-Real                      | Epoch:41 | Val Acc: 0.9771
 Best site-Painting                  | Epoch:41 | Val Acc: 0.9207
 Best site-Sketch                    | Epoch:41 | Val Acc: 0.8529
 Best site-QuickDraw                 | Epoch:41 | Val Acc: 0.5156
 Best site-Infograph                 | Epoch:41 | Val Acc: 0.4750
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/harmo-fl...
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 0.0792 | Train Acc: 0.9794
 Site-Real                          | Train Loss: 0.0212 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.1795 | Train Acc: 0.9553
 Site-Sketch                        | Train Loss: 0.3735 | Train Acc: 0.8758
 Site-QuickDraw                     | Train Loss: 1.7456 | Train Acc: 0.5000
 Site-Infograph                     | Train Loss: 2.3042 | Train Acc: 0.3000
Average Train Accuracy: 0.7676
 Site-Clipart                       | Val  Loss: 0.1908 | Val  Acc: 0.9500
 Site-Real                          | Val  Loss: 0.0634 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.2325 | Val  Acc: 0.9268
 Site-Sketch                        | Val  Loss: 0.5368 | Val  Acc: 0.8627
 Site-QuickDraw                     | Val  Loss: 1.8644 | Val  Acc: 0.3906
 Site-Infograph                     | Val  Loss: 2.0072 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7464
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 0.0668 | Train Acc: 0.9841
 Site-Real                          | Train Loss: 0.0205 | Train Acc: 0.9975
 Site-Painting                      | Train Loss: 0.1510 | Train Acc: 0.9715
 Site-Sketch                        | Train Loss: 0.3907 | Train Acc: 0.9085
 Site-QuickDraw                     | Train Loss: 1.7976 | Train Acc: 0.4792
 Site-Infograph                     | Train Loss: 2.0486 | Train Acc: 0.4333
Average Train Accuracy: 0.7957
 Site-Clipart                       | Val  Loss: 0.1747 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0588 | Val  Acc: 0.9809
 Site-Painting                      | Val  Loss: 0.2497 | Val  Acc: 0.9451
 Site-Sketch                        | Val  Loss: 0.5423 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.8926 | Val  Acc: 0.4531
 Site-Infograph                     | Val  Loss: 1.8797 | Val  Acc: 0.4250
Average Valid Accuracy: 0.7666
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.0730 | Train Acc: 0.9810
 Site-Real                          | Train Loss: 0.0198 | Train Acc: 0.9975
 Site-Painting                      | Train Loss: 0.1615 | Train Acc: 0.9634
 Site-Sketch                        | Train Loss: 0.2981 | Train Acc: 0.9020
 Site-QuickDraw                     | Train Loss: 1.5743 | Train Acc: 0.5208
 Site-Infograph                     | Train Loss: 2.1465 | Train Acc: 0.3667
Average Train Accuracy: 0.7885
 Site-Clipart                       | Val  Loss: 0.1679 | Val  Acc: 0.9571
 Site-Real                          | Val  Loss: 0.0637 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.2169 | Val  Acc: 0.9329
 Site-Sketch                        | Val  Loss: 0.5742 | Val  Acc: 0.8333
 Site-QuickDraw                     | Val  Loss: 1.7878 | Val  Acc: 0.4219
 Site-Infograph                     | Val  Loss: 2.1387 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7518
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 0.0702 | Train Acc: 0.9794
 Site-Real                          | Train Loss: 0.0167 | Train Acc: 0.9975
 Site-Painting                      | Train Loss: 0.1772 | Train Acc: 0.9593
 Site-Sketch                        | Train Loss: 0.4704 | Train Acc: 0.8693
 Site-QuickDraw                     | Train Loss: 1.6927 | Train Acc: 0.4479
 Site-Infograph                     | Train Loss: 2.1261 | Train Acc: 0.4167
Average Train Accuracy: 0.7783
 Site-Clipart                       | Val  Loss: 0.1952 | Val  Acc: 0.9500
 Site-Real                          | Val  Loss: 0.0646 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.2275 | Val  Acc: 0.9268
 Site-Sketch                        | Val  Loss: 0.4977 | Val  Acc: 0.8529
 Site-QuickDraw                     | Val  Loss: 1.6181 | Val  Acc: 0.4688
 Site-Infograph                     | Val  Loss: 1.9642 | Val  Acc: 0.4250
Average Valid Accuracy: 0.7661
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.0686 | Train Acc: 0.9825
 Site-Real                          | Train Loss: 0.0199 | Train Acc: 0.9975
 Site-Painting                      | Train Loss: 0.1516 | Train Acc: 0.9593
 Site-Sketch                        | Train Loss: 0.3864 | Train Acc: 0.8627
 Site-QuickDraw                     | Train Loss: 1.7930 | Train Acc: 0.4688
 Site-Infograph                     | Train Loss: 2.0699 | Train Acc: 0.4000
Average Train Accuracy: 0.7785
 Site-Clipart                       | Val  Loss: 0.1726 | Val  Acc: 0.9476
 Site-Real                          | Val  Loss: 0.0579 | Val  Acc: 0.9771
 Site-Painting                      | Val  Loss: 0.2650 | Val  Acc: 0.9268
 Site-Sketch                        | Val  Loss: 0.6259 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.7973 | Val  Acc: 0.3906
 Site-Infograph                     | Val  Loss: 2.0104 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7392
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 0.0818 | Train Acc: 0.9794
 Site-Real                          | Train Loss: 0.0182 | Train Acc: 0.9975
 Site-Painting                      | Train Loss: 0.1594 | Train Acc: 0.9472
 Site-Sketch                        | Train Loss: 0.3867 | Train Acc: 0.8889
 Site-QuickDraw                     | Train Loss: 1.7683 | Train Acc: 0.4271
 Site-Infograph                     | Train Loss: 2.2100 | Train Acc: 0.3000
Average Train Accuracy: 0.7567
 Site-Clipart                       | Val  Loss: 0.1859 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0633 | Val  Acc: 0.9771
 Site-Painting                      | Val  Loss: 0.2536 | Val  Acc: 0.9268
 Site-Sketch                        | Val  Loss: 0.5489 | Val  Acc: 0.8922
 Site-QuickDraw                     | Val  Loss: 1.6781 | Val  Acc: 0.4062
 Site-Infograph                     | Val  Loss: 1.8861 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7575
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 0.0649 | Train Acc: 0.9857
 Site-Real                          | Train Loss: 0.0183 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.1611 | Train Acc: 0.9593
 Site-Sketch                        | Train Loss: 0.3538 | Train Acc: 0.8824
 Site-QuickDraw                     | Train Loss: 1.5804 | Train Acc: 0.5000
 Site-Infograph                     | Train Loss: 2.1344 | Train Acc: 0.4167
Average Train Accuracy: 0.7898
 Site-Clipart                       | Val  Loss: 0.1888 | Val  Acc: 0.9548
 Site-Real                          | Val  Loss: 0.0557 | Val  Acc: 0.9771
 Site-Painting                      | Val  Loss: 0.2145 | Val  Acc: 0.9390
 Site-Sketch                        | Val  Loss: 0.5447 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.8167 | Val  Acc: 0.4531
 Site-Infograph                     | Val  Loss: 1.6794 | Val  Acc: 0.4500
Average Valid Accuracy: 0.7695
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.0773 | Train Acc: 0.9810
 Site-Real                          | Train Loss: 0.0189 | Train Acc: 0.9949
 Site-Painting                      | Train Loss: 0.1863 | Train Acc: 0.9472
 Site-Sketch                        | Train Loss: 0.3821 | Train Acc: 0.8758
 Site-QuickDraw                     | Train Loss: 1.6558 | Train Acc: 0.4479
 Site-Infograph                     | Train Loss: 2.4098 | Train Acc: 0.3000
Average Train Accuracy: 0.7578
 Site-Clipart                       | Val  Loss: 0.1888 | Val  Acc: 0.9500
 Site-Real                          | Val  Loss: 0.0528 | Val  Acc: 0.9847
 Site-Painting                      | Val  Loss: 0.2630 | Val  Acc: 0.9268
 Site-Sketch                        | Val  Loss: 0.4639 | Val  Acc: 0.8627
 Site-QuickDraw                     | Val  Loss: 1.7080 | Val  Acc: 0.4531
 Site-Infograph                     | Val  Loss: 1.7402 | Val  Acc: 0.4250
Average Valid Accuracy: 0.7671
===2023-07-01 22:20:40===
===2023-07-01 22:20:43===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[630,394,246,153,96,60,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,1314,821,513,320,200,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   | Epoch:41 | Test Acc: 0.9449
 Test site-Real                      | Epoch:41 | Test Acc: 0.9614
 Test site-Painting                  | Epoch:41 | Test Acc: 0.9160
 Test site-Sketch                    | Epoch:41 | Test Acc: 0.8827
 Test site-QuickDraw                 | Epoch:41 | Test Acc: 0.5430
 Test site-Infograph                 | Epoch:41 | Test Acc: 0.4886
Clipart: 0.9449, Real: 0.9614, Painting: 0.9160, Sketch: 0.8827, QuickDraw: 0.5430, Infograph: 0.4886, 
Average Test Accuracy(group): 0.7894, Average Test Accuracy(individual): 0.7894,
domain std=0.1957, cluster std=-1.0000, individual std=0.1957, 
