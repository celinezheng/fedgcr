===2023-07-01 18:18:03===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[630,394,246,153,96,60,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,1314,821,513,320,200,]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 2.1216 | Train Acc: 0.5651
 Site-Real                          | Train Loss: 2.1018 | Train Acc: 0.7614
 Site-Painting                      | Train Loss: 2.1322 | Train Acc: 0.5935
 Site-Sketch                        | Train Loss: 2.1378 | Train Acc: 0.5490
 Site-QuickDraw                     | Train Loss: 2.2640 | Train Acc: 0.2083
 Site-Infograph                     | Train Loss: 2.3022 | Train Acc: 0.1833
Average Train Accuracy: 0.4768
 Site-Clipart                       | Val  Loss: 2.1177 | Val  Acc: 0.6048
 Site-Real                          | Val  Loss: 2.0912 | Val  Acc: 0.7557
 Site-Painting                      | Val  Loss: 2.1172 | Val  Acc: 0.6341
 Site-Sketch                        | Val  Loss: 2.1640 | Val  Acc: 0.4412
 Site-QuickDraw                     | Val  Loss: 2.2626 | Val  Acc: 0.1875
 Site-Infograph                     | Val  Loss: 2.2734 | Val  Acc: 0.2000
Average Valid Accuracy: 0.4706
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.6048
 Best site-Real                      | Epoch:0 | Val Acc: 0.7557
 Best site-Painting                  | Epoch:0 | Val Acc: 0.6341
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.4412
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.1875
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.2000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/fedavg...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 1.9521 | Train Acc: 0.6984
 Site-Real                          | Train Loss: 1.8947 | Train Acc: 0.8883
 Site-Painting                      | Train Loss: 1.9705 | Train Acc: 0.7033
 Site-Sketch                        | Train Loss: 1.9917 | Train Acc: 0.6993
 Site-QuickDraw                     | Train Loss: 2.2329 | Train Acc: 0.3021
 Site-Infograph                     | Train Loss: 2.2539 | Train Acc: 0.1667
Average Train Accuracy: 0.5763
 Site-Clipart                       | Val  Loss: 1.9525 | Val  Acc: 0.7333
 Site-Real                          | Val  Loss: 1.8797 | Val  Acc: 0.9084
 Site-Painting                      | Val  Loss: 1.9542 | Val  Acc: 0.7195
 Site-Sketch                        | Val  Loss: 2.0208 | Val  Acc: 0.5980
 Site-QuickDraw                     | Val  Loss: 2.2410 | Val  Acc: 0.2656
 Site-Infograph                     | Val  Loss: 2.2570 | Val  Acc: 0.2500
Average Valid Accuracy: 0.5792
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.7333
 Best site-Real                      | Epoch:1 | Val Acc: 0.9084
 Best site-Painting                  | Epoch:1 | Val Acc: 0.7195
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.5980
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.2656
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/fedavg...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 1.7837 | Train Acc: 0.7524
 Site-Real                          | Train Loss: 1.6928 | Train Acc: 0.9213
 Site-Painting                      | Train Loss: 1.7918 | Train Acc: 0.7764
 Site-Sketch                        | Train Loss: 1.8408 | Train Acc: 0.6928
 Site-QuickDraw                     | Train Loss: 2.2010 | Train Acc: 0.2917
 Site-Infograph                     | Train Loss: 2.2204 | Train Acc: 0.2000
Average Train Accuracy: 0.6058
 Site-Clipart                       | Val  Loss: 1.7807 | Val  Acc: 0.7524
 Site-Real                          | Val  Loss: 1.6810 | Val  Acc: 0.9198
 Site-Painting                      | Val  Loss: 1.7738 | Val  Acc: 0.7866
 Site-Sketch                        | Val  Loss: 1.8699 | Val  Acc: 0.6471
 Site-QuickDraw                     | Val  Loss: 2.1926 | Val  Acc: 0.2812
 Site-Infograph                     | Val  Loss: 2.1974 | Val  Acc: 0.3000
Average Valid Accuracy: 0.6145
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7524
 Best site-Real                      | Epoch:2 | Val Acc: 0.9198
 Best site-Painting                  | Epoch:2 | Val Acc: 0.7866
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.6471
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.2812
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.3000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/fedavg...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 1.6177 | Train Acc: 0.7857
 Site-Real                          | Train Loss: 1.4970 | Train Acc: 0.9391
 Site-Painting                      | Train Loss: 1.6398 | Train Acc: 0.7967
 Site-Sketch                        | Train Loss: 1.7250 | Train Acc: 0.7255
 Site-QuickDraw                     | Train Loss: 2.1544 | Train Acc: 0.3229
 Site-Infograph                     | Train Loss: 2.2040 | Train Acc: 0.2500
Average Train Accuracy: 0.6367
 Site-Clipart                       | Val  Loss: 1.6342 | Val  Acc: 0.7786
 Site-Real                          | Val  Loss: 1.4830 | Val  Acc: 0.9466
 Site-Painting                      | Val  Loss: 1.6221 | Val  Acc: 0.8110
 Site-Sketch                        | Val  Loss: 1.7037 | Val  Acc: 0.7353
 Site-QuickDraw                     | Val  Loss: 2.1759 | Val  Acc: 0.3125
 Site-Infograph                     | Val  Loss: 2.1687 | Val  Acc: 0.3000
Average Valid Accuracy: 0.6473
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7786
 Best site-Real                      | Epoch:3 | Val Acc: 0.9466
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8110
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.7353
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.3125
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.3000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/fedavg...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 1.4804 | Train Acc: 0.8175
 Site-Real                          | Train Loss: 1.3149 | Train Acc: 0.9467
 Site-Painting                      | Train Loss: 1.4918 | Train Acc: 0.8171
 Site-Sketch                        | Train Loss: 1.5682 | Train Acc: 0.7386
 Site-QuickDraw                     | Train Loss: 2.1261 | Train Acc: 0.3750
 Site-Infograph                     | Train Loss: 2.1441 | Train Acc: 0.2500
Average Train Accuracy: 0.6575
 Site-Clipart                       | Val  Loss: 1.4939 | Val  Acc: 0.7952
 Site-Real                          | Val  Loss: 1.3081 | Val  Acc: 0.9313
 Site-Painting                      | Val  Loss: 1.4813 | Val  Acc: 0.8415
 Site-Sketch                        | Val  Loss: 1.5730 | Val  Acc: 0.7353
 Site-QuickDraw                     | Val  Loss: 2.1381 | Val  Acc: 0.3750
 Site-Infograph                     | Val  Loss: 2.1220 | Val  Acc: 0.3000
Average Valid Accuracy: 0.6630
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7952
 Best site-Real                      | Epoch:4 | Val Acc: 0.9313
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8415
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7353
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.3750
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.3000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/fedavg...
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 1.3668 | Train Acc: 0.8175
 Site-Real                          | Train Loss: 1.1823 | Train Acc: 0.9467
 Site-Painting                      | Train Loss: 1.3803 | Train Acc: 0.7927
 Site-Sketch                        | Train Loss: 1.4581 | Train Acc: 0.7582
 Site-QuickDraw                     | Train Loss: 2.0915 | Train Acc: 0.3646
 Site-Infograph                     | Train Loss: 2.1143 | Train Acc: 0.2667
Average Train Accuracy: 0.6577
 Site-Clipart                       | Val  Loss: 1.3668 | Val  Acc: 0.8071
 Site-Real                          | Val  Loss: 1.1448 | Val  Acc: 0.9542
 Site-Painting                      | Val  Loss: 1.3777 | Val  Acc: 0.7866
 Site-Sketch                        | Val  Loss: 1.5005 | Val  Acc: 0.6863
 Site-QuickDraw                     | Val  Loss: 2.1112 | Val  Acc: 0.3281
 Site-Infograph                     | Val  Loss: 2.1292 | Val  Acc: 0.3000
Average Valid Accuracy: 0.6437
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 1.2289 | Train Acc: 0.8238
 Site-Real                          | Train Loss: 1.0257 | Train Acc: 0.9543
 Site-Painting                      | Train Loss: 1.2507 | Train Acc: 0.8171
 Site-Sketch                        | Train Loss: 1.2871 | Train Acc: 0.7712
 Site-QuickDraw                     | Train Loss: 2.0898 | Train Acc: 0.3438
 Site-Infograph                     | Train Loss: 2.0933 | Train Acc: 0.2500
Average Train Accuracy: 0.6600
 Site-Clipart                       | Val  Loss: 1.2506 | Val  Acc: 0.8238
 Site-Real                          | Val  Loss: 0.9929 | Val  Acc: 0.9580
 Site-Painting                      | Val  Loss: 1.2450 | Val  Acc: 0.8110
 Site-Sketch                        | Val  Loss: 1.3338 | Val  Acc: 0.7059
 Site-QuickDraw                     | Val  Loss: 2.0728 | Val  Acc: 0.3906
 Site-Infograph                     | Val  Loss: 2.0899 | Val  Acc: 0.3000
Average Valid Accuracy: 0.6649
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8238
 Best site-Real                      | Epoch:6 | Val Acc: 0.9580
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8110
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.7059
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.3906
 Best site-Infograph                 | Epoch:6 | Val Acc: 0.3000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/fedavg...
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 1.1524 | Train Acc: 0.8317
 Site-Real                          | Train Loss: 0.9499 | Train Acc: 0.9492
 Site-Painting                      | Train Loss: 1.1618 | Train Acc: 0.8211
 Site-Sketch                        | Train Loss: 1.2306 | Train Acc: 0.7843
 Site-QuickDraw                     | Train Loss: 2.0842 | Train Acc: 0.2917
 Site-Infograph                     | Train Loss: 2.1043 | Train Acc: 0.1833
Average Train Accuracy: 0.6436
 Site-Clipart                       | Val  Loss: 1.1474 | Val  Acc: 0.8286
 Site-Real                          | Val  Loss: 0.8922 | Val  Acc: 0.9504
 Site-Painting                      | Val  Loss: 1.1154 | Val  Acc: 0.8049
 Site-Sketch                        | Val  Loss: 1.2791 | Val  Acc: 0.7255
 Site-QuickDraw                     | Val  Loss: 2.0442 | Val  Acc: 0.3906
 Site-Infograph                     | Val  Loss: 2.0392 | Val  Acc: 0.3750
Average Valid Accuracy: 0.6792
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8286
 Best site-Real                      | Epoch:7 | Val Acc: 0.9504
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8049
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.7255
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.3906
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.3750
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/fedavg...
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 1.0508 | Train Acc: 0.8429
 Site-Real                          | Train Loss: 0.8136 | Train Acc: 0.9543
 Site-Painting                      | Train Loss: 1.0602 | Train Acc: 0.8455
 Site-Sketch                        | Train Loss: 1.2036 | Train Acc: 0.7843
 Site-QuickDraw                     | Train Loss: 2.0911 | Train Acc: 0.3125
 Site-Infograph                     | Train Loss: 2.0205 | Train Acc: 0.3167
Average Train Accuracy: 0.6760
 Site-Clipart                       | Val  Loss: 1.0694 | Val  Acc: 0.8167
 Site-Real                          | Val  Loss: 0.7756 | Val  Acc: 0.9542
 Site-Painting                      | Val  Loss: 1.0422 | Val  Acc: 0.7988
 Site-Sketch                        | Val  Loss: 1.1718 | Val  Acc: 0.7059
 Site-QuickDraw                     | Val  Loss: 2.0597 | Val  Acc: 0.3594
 Site-Infograph                     | Val  Loss: 1.9874 | Val  Acc: 0.3250
Average Valid Accuracy: 0.6600
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 0.9881 | Train Acc: 0.8492
 Site-Real                          | Train Loss: 0.6860 | Train Acc: 0.9645
 Site-Painting                      | Train Loss: 0.9918 | Train Acc: 0.8171
 Site-Sketch                        | Train Loss: 1.0745 | Train Acc: 0.7712
 Site-QuickDraw                     | Train Loss: 2.0517 | Train Acc: 0.3646
 Site-Infograph                     | Train Loss: 2.0362 | Train Acc: 0.3000
Average Train Accuracy: 0.6778
 Site-Clipart                       | Val  Loss: 0.9978 | Val  Acc: 0.8405
 Site-Real                          | Val  Loss: 0.6818 | Val  Acc: 0.9580
 Site-Painting                      | Val  Loss: 0.9590 | Val  Acc: 0.8476
 Site-Sketch                        | Val  Loss: 1.1162 | Val  Acc: 0.7549
 Site-QuickDraw                     | Val  Loss: 2.0293 | Val  Acc: 0.3594
 Site-Infograph                     | Val  Loss: 1.9983 | Val  Acc: 0.3500
Average Valid Accuracy: 0.6851
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8405
 Best site-Real                      | Epoch:9 | Val Acc: 0.9580
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8476
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.7549
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.3594
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.3500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/fedavg...
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 0.9205 | Train Acc: 0.8508
 Site-Real                          | Train Loss: 0.6305 | Train Acc: 0.9594
 Site-Painting                      | Train Loss: 0.9367 | Train Acc: 0.8374
 Site-Sketch                        | Train Loss: 1.0321 | Train Acc: 0.7843
 Site-QuickDraw                     | Train Loss: 2.0065 | Train Acc: 0.3438
 Site-Infograph                     | Train Loss: 2.0038 | Train Acc: 0.3167
Average Train Accuracy: 0.6821
 Site-Clipart                       | Val  Loss: 0.9299 | Val  Acc: 0.8500
 Site-Real                          | Val  Loss: 0.6208 | Val  Acc: 0.9504
 Site-Painting                      | Val  Loss: 0.9059 | Val  Acc: 0.8232
 Site-Sketch                        | Val  Loss: 1.0955 | Val  Acc: 0.6961
 Site-QuickDraw                     | Val  Loss: 2.0218 | Val  Acc: 0.3438
 Site-Infograph                     | Val  Loss: 1.9140 | Val  Acc: 0.4250
Average Valid Accuracy: 0.6814
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 0.8539 | Train Acc: 0.8619
 Site-Real                          | Train Loss: 0.5781 | Train Acc: 0.9670
 Site-Painting                      | Train Loss: 0.8658 | Train Acc: 0.8496
 Site-Sketch                        | Train Loss: 0.9616 | Train Acc: 0.7582
 Site-QuickDraw                     | Train Loss: 1.9420 | Train Acc: 0.3646
 Site-Infograph                     | Train Loss: 1.9689 | Train Acc: 0.3000
Average Train Accuracy: 0.6835
 Site-Clipart                       | Val  Loss: 0.8686 | Val  Acc: 0.8667
 Site-Real                          | Val  Loss: 0.5558 | Val  Acc: 0.9542
 Site-Painting                      | Val  Loss: 0.8084 | Val  Acc: 0.8537
 Site-Sketch                        | Val  Loss: 1.0181 | Val  Acc: 0.7745
 Site-QuickDraw                     | Val  Loss: 2.0337 | Val  Acc: 0.3594
 Site-Infograph                     | Val  Loss: 1.9103 | Val  Acc: 0.3750
Average Valid Accuracy: 0.6972
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8667
 Best site-Real                      | Epoch:11 | Val Acc: 0.9542
 Best site-Painting                  | Epoch:11 | Val Acc: 0.8537
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.7745
 Best site-QuickDraw                 | Epoch:11 | Val Acc: 0.3594
 Best site-Infograph                 | Epoch:11 | Val Acc: 0.3750
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/fedavg...
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 0.8111 | Train Acc: 0.8651
 Site-Real                          | Train Loss: 0.5264 | Train Acc: 0.9645
 Site-Painting                      | Train Loss: 0.8245 | Train Acc: 0.8455
 Site-Sketch                        | Train Loss: 0.9361 | Train Acc: 0.7778
 Site-QuickDraw                     | Train Loss: 2.0200 | Train Acc: 0.3438
 Site-Infograph                     | Train Loss: 2.0017 | Train Acc: 0.2500
Average Train Accuracy: 0.6744
 Site-Clipart                       | Val  Loss: 0.8061 | Val  Acc: 0.8595
 Site-Real                          | Val  Loss: 0.5022 | Val  Acc: 0.9504
 Site-Painting                      | Val  Loss: 0.7692 | Val  Acc: 0.8415
 Site-Sketch                        | Val  Loss: 1.0216 | Val  Acc: 0.7255
 Site-QuickDraw                     | Val  Loss: 2.0076 | Val  Acc: 0.3594
 Site-Infograph                     | Val  Loss: 1.9697 | Val  Acc: 0.4000
Average Valid Accuracy: 0.6894
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 0.7523 | Train Acc: 0.8857
 Site-Real                          | Train Loss: 0.4681 | Train Acc: 0.9492
 Site-Painting                      | Train Loss: 0.7763 | Train Acc: 0.8252
 Site-Sketch                        | Train Loss: 0.9011 | Train Acc: 0.7974
 Site-QuickDraw                     | Train Loss: 2.0108 | Train Acc: 0.3125
 Site-Infograph                     | Train Loss: 1.9960 | Train Acc: 0.3000
Average Train Accuracy: 0.6783
 Site-Clipart                       | Val  Loss: 0.7756 | Val  Acc: 0.8643
 Site-Real                          | Val  Loss: 0.4461 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.7449 | Val  Acc: 0.8293
 Site-Sketch                        | Val  Loss: 0.8703 | Val  Acc: 0.7941
 Site-QuickDraw                     | Val  Loss: 1.9633 | Val  Acc: 0.3906
 Site-Infograph                     | Val  Loss: 1.8583 | Val  Acc: 0.4250
Average Valid Accuracy: 0.7115
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8643
 Best site-Real                      | Epoch:13 | Val Acc: 0.9656
 Best site-Painting                  | Epoch:13 | Val Acc: 0.8293
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.7941
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.3906
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.4250
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/fedavg...
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 0.7170 | Train Acc: 0.8746
 Site-Real                          | Train Loss: 0.4104 | Train Acc: 0.9670
 Site-Painting                      | Train Loss: 0.7653 | Train Acc: 0.8252
 Site-Sketch                        | Train Loss: 0.9181 | Train Acc: 0.7712
 Site-QuickDraw                     | Train Loss: 2.0217 | Train Acc: 0.3125
 Site-Infograph                     | Train Loss: 1.9669 | Train Acc: 0.3167
Average Train Accuracy: 0.6779
 Site-Clipart                       | Val  Loss: 0.7400 | Val  Acc: 0.8405
 Site-Real                          | Val  Loss: 0.4076 | Val  Acc: 0.9580
 Site-Painting                      | Val  Loss: 0.6929 | Val  Acc: 0.8537
 Site-Sketch                        | Val  Loss: 0.9325 | Val  Acc: 0.7353
 Site-QuickDraw                     | Val  Loss: 1.9503 | Val  Acc: 0.4219
 Site-Infograph                     | Val  Loss: 1.9513 | Val  Acc: 0.2500
Average Valid Accuracy: 0.6766
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 0.6800 | Train Acc: 0.8778
 Site-Real                          | Train Loss: 0.4080 | Train Acc: 0.9619
 Site-Painting                      | Train Loss: 0.7129 | Train Acc: 0.8496
 Site-Sketch                        | Train Loss: 0.8447 | Train Acc: 0.7908
 Site-QuickDraw                     | Train Loss: 1.8957 | Train Acc: 0.3438
 Site-Infograph                     | Train Loss: 1.9565 | Train Acc: 0.3167
Average Train Accuracy: 0.6901
 Site-Clipart                       | Val  Loss: 0.6873 | Val  Acc: 0.8810
 Site-Real                          | Val  Loss: 0.3964 | Val  Acc: 0.9542
 Site-Painting                      | Val  Loss: 0.6964 | Val  Acc: 0.8232
 Site-Sketch                        | Val  Loss: 0.8144 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.9284 | Val  Acc: 0.3750
 Site-Infograph                     | Val  Loss: 1.8952 | Val  Acc: 0.3750
Average Valid Accuracy: 0.6988
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 0.6541 | Train Acc: 0.8810
 Site-Real                          | Train Loss: 0.3565 | Train Acc: 0.9594
 Site-Painting                      | Train Loss: 0.6698 | Train Acc: 0.8455
 Site-Sketch                        | Train Loss: 0.8209 | Train Acc: 0.7778
 Site-QuickDraw                     | Train Loss: 1.8974 | Train Acc: 0.3854
 Site-Infograph                     | Train Loss: 1.9644 | Train Acc: 0.3333
Average Train Accuracy: 0.6971
 Site-Clipart                       | Val  Loss: 0.6704 | Val  Acc: 0.8786
 Site-Real                          | Val  Loss: 0.3528 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.6742 | Val  Acc: 0.8415
 Site-Sketch                        | Val  Loss: 0.8577 | Val  Acc: 0.7745
 Site-QuickDraw                     | Val  Loss: 1.9208 | Val  Acc: 0.4062
 Site-Infograph                     | Val  Loss: 1.9307 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7027
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 0.6074 | Train Acc: 0.9032
 Site-Real                          | Train Loss: 0.3465 | Train Acc: 0.9645
 Site-Painting                      | Train Loss: 0.6673 | Train Acc: 0.8537
 Site-Sketch                        | Train Loss: 0.8125 | Train Acc: 0.8170
 Site-QuickDraw                     | Train Loss: 1.9225 | Train Acc: 0.3438
 Site-Infograph                     | Train Loss: 1.9684 | Train Acc: 0.2667
Average Train Accuracy: 0.6915
 Site-Clipart                       | Val  Loss: 0.6667 | Val  Acc: 0.8714
 Site-Real                          | Val  Loss: 0.3224 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.6235 | Val  Acc: 0.8232
 Site-Sketch                        | Val  Loss: 0.8832 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.8800 | Val  Acc: 0.4375
 Site-Infograph                     | Val  Loss: 1.9096 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7095
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 0.6061 | Train Acc: 0.8968
 Site-Real                          | Train Loss: 0.3298 | Train Acc: 0.9670
 Site-Painting                      | Train Loss: 0.6838 | Train Acc: 0.8374
 Site-Sketch                        | Train Loss: 0.7737 | Train Acc: 0.7712
 Site-QuickDraw                     | Train Loss: 1.9114 | Train Acc: 0.3750
 Site-Infograph                     | Train Loss: 1.8853 | Train Acc: 0.3500
Average Train Accuracy: 0.6996
 Site-Clipart                       | Val  Loss: 0.6289 | Val  Acc: 0.8786
 Site-Real                          | Val  Loss: 0.3196 | Val  Acc: 0.9580
 Site-Painting                      | Val  Loss: 0.5901 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.8931 | Val  Acc: 0.7647
 Site-QuickDraw                     | Val  Loss: 1.9396 | Val  Acc: 0.3906
 Site-Infograph                     | Val  Loss: 1.8720 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7003
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 0.5600 | Train Acc: 0.8968
 Site-Real                          | Train Loss: 0.2937 | Train Acc: 0.9670
 Site-Painting                      | Train Loss: 0.6097 | Train Acc: 0.8780
 Site-Sketch                        | Train Loss: 0.8447 | Train Acc: 0.7582
 Site-QuickDraw                     | Train Loss: 1.8932 | Train Acc: 0.3542
 Site-Infograph                     | Train Loss: 1.8832 | Train Acc: 0.3333
Average Train Accuracy: 0.6979
 Site-Clipart                       | Val  Loss: 0.5929 | Val  Acc: 0.8714
 Site-Real                          | Val  Loss: 0.2960 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.5559 | Val  Acc: 0.8659
 Site-Sketch                        | Val  Loss: 0.8638 | Val  Acc: 0.7745
 Site-QuickDraw                     | Val  Loss: 1.9215 | Val  Acc: 0.3906
 Site-Infograph                     | Val  Loss: 1.8520 | Val  Acc: 0.3250
Average Valid Accuracy: 0.6988
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 0.5289 | Train Acc: 0.9048
 Site-Real                          | Train Loss: 0.2724 | Train Acc: 0.9645
 Site-Painting                      | Train Loss: 0.6001 | Train Acc: 0.8415
 Site-Sketch                        | Train Loss: 0.7156 | Train Acc: 0.8170
 Site-QuickDraw                     | Train Loss: 1.9022 | Train Acc: 0.3854
 Site-Infograph                     | Train Loss: 1.9351 | Train Acc: 0.2667
Average Train Accuracy: 0.6966
 Site-Clipart                       | Val  Loss: 0.5810 | Val  Acc: 0.8929
 Site-Real                          | Val  Loss: 0.2774 | Val  Acc: 0.9771
 Site-Painting                      | Val  Loss: 0.5711 | Val  Acc: 0.8659
 Site-Sketch                        | Val  Loss: 0.8358 | Val  Acc: 0.7745
 Site-QuickDraw                     | Val  Loss: 1.8530 | Val  Acc: 0.4219
 Site-Infograph                     | Val  Loss: 1.8534 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7220
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8929
 Best site-Real                      | Epoch:20 | Val Acc: 0.9771
 Best site-Painting                  | Epoch:20 | Val Acc: 0.8659
 Best site-Sketch                    | Epoch:20 | Val Acc: 0.7745
 Best site-QuickDraw                 | Epoch:20 | Val Acc: 0.4219
 Best site-Infograph                 | Epoch:20 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/fedavg...
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 0.5282 | Train Acc: 0.9032
 Site-Real                          | Train Loss: 0.2712 | Train Acc: 0.9746
 Site-Painting                      | Train Loss: 0.6106 | Train Acc: 0.8537
 Site-Sketch                        | Train Loss: 0.7981 | Train Acc: 0.7582
 Site-QuickDraw                     | Train Loss: 1.8816 | Train Acc: 0.3646
 Site-Infograph                     | Train Loss: 1.9025 | Train Acc: 0.2667
Average Train Accuracy: 0.6868
 Site-Clipart                       | Val  Loss: 0.5567 | Val  Acc: 0.8833
 Site-Real                          | Val  Loss: 0.2725 | Val  Acc: 0.9580
 Site-Painting                      | Val  Loss: 0.5445 | Val  Acc: 0.8659
 Site-Sketch                        | Val  Loss: 0.7794 | Val  Acc: 0.7745
 Site-QuickDraw                     | Val  Loss: 1.8052 | Val  Acc: 0.4375
 Site-Infograph                     | Val  Loss: 1.8235 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7157
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 0.5118 | Train Acc: 0.9079
 Site-Real                          | Train Loss: 0.2850 | Train Acc: 0.9721
 Site-Painting                      | Train Loss: 0.5767 | Train Acc: 0.8577
 Site-Sketch                        | Train Loss: 0.7685 | Train Acc: 0.7712
 Site-QuickDraw                     | Train Loss: 1.8108 | Train Acc: 0.4167
 Site-Infograph                     | Train Loss: 1.8711 | Train Acc: 0.3167
Average Train Accuracy: 0.7071
 Site-Clipart                       | Val  Loss: 0.5370 | Val  Acc: 0.8952
 Site-Real                          | Val  Loss: 0.2599 | Val  Acc: 0.9695
 Site-Painting                      | Val  Loss: 0.5389 | Val  Acc: 0.8537
 Site-Sketch                        | Val  Loss: 0.7400 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.9087 | Val  Acc: 0.3594
 Site-Infograph                     | Val  Loss: 1.8496 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7062
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.4862 | Train Acc: 0.9175
 Site-Real                          | Train Loss: 0.2376 | Train Acc: 0.9721
 Site-Painting                      | Train Loss: 0.5911 | Train Acc: 0.8577
 Site-Sketch                        | Train Loss: 0.7670 | Train Acc: 0.7843
 Site-QuickDraw                     | Train Loss: 1.8761 | Train Acc: 0.3958
 Site-Infograph                     | Train Loss: 1.9329 | Train Acc: 0.3167
Average Train Accuracy: 0.7073
 Site-Clipart                       | Val  Loss: 0.5343 | Val  Acc: 0.8905
 Site-Real                          | Val  Loss: 0.2566 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.5218 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.7676 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.7778 | Val  Acc: 0.4375
 Site-Infograph                     | Val  Loss: 1.7903 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7188
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 0.4745 | Train Acc: 0.9127
 Site-Real                          | Train Loss: 0.2645 | Train Acc: 0.9721
 Site-Painting                      | Train Loss: 0.5429 | Train Acc: 0.8496
 Site-Sketch                        | Train Loss: 0.6792 | Train Acc: 0.8105
 Site-QuickDraw                     | Train Loss: 1.8768 | Train Acc: 0.3854
 Site-Infograph                     | Train Loss: 1.8429 | Train Acc: 0.3500
Average Train Accuracy: 0.7134
 Site-Clipart                       | Val  Loss: 0.4943 | Val  Acc: 0.8952
 Site-Real                          | Val  Loss: 0.2323 | Val  Acc: 0.9695
 Site-Painting                      | Val  Loss: 0.5398 | Val  Acc: 0.8415
 Site-Sketch                        | Val  Loss: 0.7335 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.8669 | Val  Acc: 0.4062
 Site-Infograph                     | Val  Loss: 1.8118 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7120
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 0.4517 | Train Acc: 0.9143
 Site-Real                          | Train Loss: 0.2723 | Train Acc: 0.9721
 Site-Painting                      | Train Loss: 0.5126 | Train Acc: 0.8659
 Site-Sketch                        | Train Loss: 0.7499 | Train Acc: 0.7974
 Site-QuickDraw                     | Train Loss: 1.8271 | Train Acc: 0.3646
 Site-Infograph                     | Train Loss: 1.8525 | Train Acc: 0.3333
Average Train Accuracy: 0.7079
 Site-Clipart                       | Val  Loss: 0.5399 | Val  Acc: 0.8833
 Site-Real                          | Val  Loss: 0.2183 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.4902 | Val  Acc: 0.8780
 Site-Sketch                        | Val  Loss: 0.7270 | Val  Acc: 0.7745
 Site-QuickDraw                     | Val  Loss: 1.8183 | Val  Acc: 0.4219
 Site-Infograph                     | Val  Loss: 1.8984 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7122
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.4527 | Train Acc: 0.9127
 Site-Real                          | Train Loss: 0.2151 | Train Acc: 0.9822
 Site-Painting                      | Train Loss: 0.4965 | Train Acc: 0.8780
 Site-Sketch                        | Train Loss: 0.7453 | Train Acc: 0.7843
 Site-QuickDraw                     | Train Loss: 1.8651 | Train Acc: 0.3854
 Site-Infograph                     | Train Loss: 1.9441 | Train Acc: 0.3167
Average Train Accuracy: 0.7099
 Site-Clipart                       | Val  Loss: 0.4914 | Val  Acc: 0.9024
 Site-Real                          | Val  Loss: 0.2027 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.4636 | Val  Acc: 0.8780
 Site-Sketch                        | Val  Loss: 0.6840 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.8604 | Val  Acc: 0.4062
 Site-Infograph                     | Val  Loss: 1.7610 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7326
 Best site-Clipart                   | Epoch:26 | Val Acc: 0.9024
 Best site-Real                      | Epoch:26 | Val Acc: 0.9656
 Best site-Painting                  | Epoch:26 | Val Acc: 0.8780
 Best site-Sketch                    | Epoch:26 | Val Acc: 0.8431
 Best site-QuickDraw                 | Epoch:26 | Val Acc: 0.4062
 Best site-Infograph                 | Epoch:26 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/fedavg...
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 0.4313 | Train Acc: 0.9143
 Site-Real                          | Train Loss: 0.2151 | Train Acc: 0.9746
 Site-Painting                      | Train Loss: 0.5272 | Train Acc: 0.8659
 Site-Sketch                        | Train Loss: 0.6806 | Train Acc: 0.8039
 Site-QuickDraw                     | Train Loss: 1.8183 | Train Acc: 0.4167
 Site-Infograph                     | Train Loss: 1.8978 | Train Acc: 0.3000
Average Train Accuracy: 0.7126
 Site-Clipart                       | Val  Loss: 0.4664 | Val  Acc: 0.9071
 Site-Real                          | Val  Loss: 0.2071 | Val  Acc: 0.9618
 Site-Painting                      | Val  Loss: 0.4743 | Val  Acc: 0.8720
 Site-Sketch                        | Val  Loss: 0.7454 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.8044 | Val  Acc: 0.4375
 Site-Infograph                     | Val  Loss: 1.7653 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7262
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 0.4254 | Train Acc: 0.9190
 Site-Real                          | Train Loss: 0.2166 | Train Acc: 0.9695
 Site-Painting                      | Train Loss: 0.4985 | Train Acc: 0.8740
 Site-Sketch                        | Train Loss: 0.6783 | Train Acc: 0.8105
 Site-QuickDraw                     | Train Loss: 1.7125 | Train Acc: 0.4375
 Site-Infograph                     | Train Loss: 1.9195 | Train Acc: 0.3333
Average Train Accuracy: 0.7240
 Site-Clipart                       | Val  Loss: 0.4694 | Val  Acc: 0.9024
 Site-Real                          | Val  Loss: 0.2101 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.5023 | Val  Acc: 0.8659
 Site-Sketch                        | Val  Loss: 0.7736 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.7614 | Val  Acc: 0.4219
 Site-Infograph                     | Val  Loss: 1.8420 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7192
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.4059 | Train Acc: 0.9238
 Site-Real                          | Train Loss: 0.2224 | Train Acc: 0.9721
 Site-Painting                      | Train Loss: 0.5248 | Train Acc: 0.8537
 Site-Sketch                        | Train Loss: 0.6160 | Train Acc: 0.8366
 Site-QuickDraw                     | Train Loss: 1.7701 | Train Acc: 0.4271
 Site-Infograph                     | Train Loss: 1.8264 | Train Acc: 0.3667
Average Train Accuracy: 0.7300
 Site-Clipart                       | Val  Loss: 0.4455 | Val  Acc: 0.9095
 Site-Real                          | Val  Loss: 0.1979 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.4775 | Val  Acc: 0.8476
 Site-Sketch                        | Val  Loss: 0.6994 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.7784 | Val  Acc: 0.4531
 Site-Infograph                     | Val  Loss: 1.7785 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7184
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.3835 | Train Acc: 0.9317
 Site-Real                          | Train Loss: 0.1909 | Train Acc: 0.9695
 Site-Painting                      | Train Loss: 0.4666 | Train Acc: 0.8740
 Site-Sketch                        | Train Loss: 0.7264 | Train Acc: 0.7974
 Site-QuickDraw                     | Train Loss: 1.8758 | Train Acc: 0.4062
 Site-Infograph                     | Train Loss: 1.9083 | Train Acc: 0.3500
Average Train Accuracy: 0.7215
 Site-Clipart                       | Val  Loss: 0.4317 | Val  Acc: 0.9143
 Site-Real                          | Val  Loss: 0.1850 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.4460 | Val  Acc: 0.8659
 Site-Sketch                        | Val  Loss: 0.6586 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.7608 | Val  Acc: 0.4688
 Site-Infograph                     | Val  Loss: 1.7363 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7344
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.9143
 Best site-Real                      | Epoch:30 | Val Acc: 0.9733
 Best site-Painting                  | Epoch:30 | Val Acc: 0.8659
 Best site-Sketch                    | Epoch:30 | Val Acc: 0.7843
 Best site-QuickDraw                 | Epoch:30 | Val Acc: 0.4688
 Best site-Infograph                 | Epoch:30 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/fedavg...
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.3853 | Train Acc: 0.9254
 Site-Real                          | Train Loss: 0.1727 | Train Acc: 0.9721
 Site-Painting                      | Train Loss: 0.4456 | Train Acc: 0.8740
 Site-Sketch                        | Train Loss: 0.6119 | Train Acc: 0.8301
 Site-QuickDraw                     | Train Loss: 1.8312 | Train Acc: 0.4271
 Site-Infograph                     | Train Loss: 1.9598 | Train Acc: 0.3167
Average Train Accuracy: 0.7242
 Site-Clipart                       | Val  Loss: 0.4248 | Val  Acc: 0.9143
 Site-Real                          | Val  Loss: 0.1865 | Val  Acc: 0.9618
 Site-Painting                      | Val  Loss: 0.4644 | Val  Acc: 0.8659
 Site-Sketch                        | Val  Loss: 0.6616 | Val  Acc: 0.7941
 Site-QuickDraw                     | Val  Loss: 1.8118 | Val  Acc: 0.4062
 Site-Infograph                     | Val  Loss: 1.7626 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7237
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.3811 | Train Acc: 0.9302
 Site-Real                          | Train Loss: 0.1717 | Train Acc: 0.9797
 Site-Painting                      | Train Loss: 0.4786 | Train Acc: 0.8659
 Site-Sketch                        | Train Loss: 0.5940 | Train Acc: 0.7974
 Site-QuickDraw                     | Train Loss: 1.9028 | Train Acc: 0.4271
 Site-Infograph                     | Train Loss: 1.8261 | Train Acc: 0.3833
Average Train Accuracy: 0.7306
 Site-Clipart                       | Val  Loss: 0.4088 | Val  Acc: 0.9262
 Site-Real                          | Val  Loss: 0.1766 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.4708 | Val  Acc: 0.8659
 Site-Sketch                        | Val  Loss: 0.7168 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.7721 | Val  Acc: 0.4219
 Site-Infograph                     | Val  Loss: 1.7354 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7273
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.3601 | Train Acc: 0.9270
 Site-Real                          | Train Loss: 0.2118 | Train Acc: 0.9772
 Site-Painting                      | Train Loss: 0.4562 | Train Acc: 0.8943
 Site-Sketch                        | Train Loss: 0.5676 | Train Acc: 0.8039
 Site-QuickDraw                     | Train Loss: 1.8209 | Train Acc: 0.4479
 Site-Infograph                     | Train Loss: 1.9169 | Train Acc: 0.3333
Average Train Accuracy: 0.7306
 Site-Clipart                       | Val  Loss: 0.4184 | Val  Acc: 0.9119
 Site-Real                          | Val  Loss: 0.1740 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.4413 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.6584 | Val  Acc: 0.8333
 Site-QuickDraw                     | Val  Loss: 1.7907 | Val  Acc: 0.4219
 Site-Infograph                     | Val  Loss: 1.7279 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7279
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 0.3661 | Train Acc: 0.9222
 Site-Real                          | Train Loss: 0.1805 | Train Acc: 0.9695
 Site-Painting                      | Train Loss: 0.4505 | Train Acc: 0.8821
 Site-Sketch                        | Train Loss: 0.6235 | Train Acc: 0.8235
 Site-QuickDraw                     | Train Loss: 1.8104 | Train Acc: 0.4479
 Site-Infograph                     | Train Loss: 1.9006 | Train Acc: 0.3000
Average Train Accuracy: 0.7242
 Site-Clipart                       | Val  Loss: 0.3955 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.1796 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.4253 | Val  Acc: 0.8780
 Site-Sketch                        | Val  Loss: 0.6607 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.7234 | Val  Acc: 0.4375
 Site-Infograph                     | Val  Loss: 1.7488 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7361
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.9238
 Best site-Real                      | Epoch:34 | Val Acc: 0.9733
 Best site-Painting                  | Epoch:34 | Val Acc: 0.8780
 Best site-Sketch                    | Epoch:34 | Val Acc: 0.8039
 Best site-QuickDraw                 | Epoch:34 | Val Acc: 0.4375
 Best site-Infograph                 | Epoch:34 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/fedavg...
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 0.3497 | Train Acc: 0.9381
 Site-Real                          | Train Loss: 0.1746 | Train Acc: 0.9772
 Site-Painting                      | Train Loss: 0.4615 | Train Acc: 0.8780
 Site-Sketch                        | Train Loss: 0.5682 | Train Acc: 0.8431
 Site-QuickDraw                     | Train Loss: 1.7975 | Train Acc: 0.4271
 Site-Infograph                     | Train Loss: 1.8970 | Train Acc: 0.3167
Average Train Accuracy: 0.7300
 Site-Clipart                       | Val  Loss: 0.4091 | Val  Acc: 0.9262
 Site-Real                          | Val  Loss: 0.1681 | Val  Acc: 0.9580
 Site-Painting                      | Val  Loss: 0.4383 | Val  Acc: 0.8780
 Site-Sketch                        | Val  Loss: 0.6367 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.7614 | Val  Acc: 0.4688
 Site-Infograph                     | Val  Loss: 1.5916 | Val  Acc: 0.4750
Average Valid Accuracy: 0.7484
 Best site-Clipart                   | Epoch:35 | Val Acc: 0.9262
 Best site-Real                      | Epoch:35 | Val Acc: 0.9580
 Best site-Painting                  | Epoch:35 | Val Acc: 0.8780
 Best site-Sketch                    | Epoch:35 | Val Acc: 0.7843
 Best site-QuickDraw                 | Epoch:35 | Val Acc: 0.4688
 Best site-Infograph                 | Epoch:35 | Val Acc: 0.4750
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/fedavg...
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.3283 | Train Acc: 0.9603
 Site-Real                          | Train Loss: 0.1623 | Train Acc: 0.9772
 Site-Painting                      | Train Loss: 0.4545 | Train Acc: 0.8577
 Site-Sketch                        | Train Loss: 0.5720 | Train Acc: 0.8170
 Site-QuickDraw                     | Train Loss: 1.8427 | Train Acc: 0.4062
 Site-Infograph                     | Train Loss: 1.8547 | Train Acc: 0.3333
Average Train Accuracy: 0.7253
 Site-Clipart                       | Val  Loss: 0.3837 | Val  Acc: 0.9262
 Site-Real                          | Val  Loss: 0.1580 | Val  Acc: 0.9618
 Site-Painting                      | Val  Loss: 0.4136 | Val  Acc: 0.8841
 Site-Sketch                        | Val  Loss: 0.6652 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.8354 | Val  Acc: 0.3906
 Site-Infograph                     | Val  Loss: 1.7211 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7195
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 0.3222 | Train Acc: 0.9492
 Site-Real                          | Train Loss: 0.1465 | Train Acc: 0.9797
 Site-Painting                      | Train Loss: 0.4059 | Train Acc: 0.8902
 Site-Sketch                        | Train Loss: 0.5902 | Train Acc: 0.8235
 Site-QuickDraw                     | Train Loss: 1.7661 | Train Acc: 0.4583
 Site-Infograph                     | Train Loss: 1.8833 | Train Acc: 0.3333
Average Train Accuracy: 0.7391
 Site-Clipart                       | Val  Loss: 0.3881 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.1511 | Val  Acc: 0.9695
 Site-Painting                      | Val  Loss: 0.4277 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.6154 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.7772 | Val  Acc: 0.4375
 Site-Infograph                     | Val  Loss: 1.7798 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7357
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.3423 | Train Acc: 0.9302
 Site-Real                          | Train Loss: 0.1481 | Train Acc: 0.9797
 Site-Painting                      | Train Loss: 0.4516 | Train Acc: 0.8780
 Site-Sketch                        | Train Loss: 0.6073 | Train Acc: 0.8235
 Site-QuickDraw                     | Train Loss: 1.8466 | Train Acc: 0.3958
 Site-Infograph                     | Train Loss: 1.9275 | Train Acc: 0.3333
Average Train Accuracy: 0.7234
 Site-Clipart                       | Val  Loss: 0.3921 | Val  Acc: 0.9214
 Site-Real                          | Val  Loss: 0.1638 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.4094 | Val  Acc: 0.8780
 Site-Sketch                        | Val  Loss: 0.6501 | Val  Acc: 0.7941
 Site-QuickDraw                     | Val  Loss: 1.7124 | Val  Acc: 0.5000
 Site-Infograph                     | Val  Loss: 1.7718 | Val  Acc: 0.4500
Average Valid Accuracy: 0.7515
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.9214
 Best site-Real                      | Epoch:38 | Val Acc: 0.9656
 Best site-Painting                  | Epoch:38 | Val Acc: 0.8780
 Best site-Sketch                    | Epoch:38 | Val Acc: 0.7941
 Best site-QuickDraw                 | Epoch:38 | Val Acc: 0.5000
 Best site-Infograph                 | Epoch:38 | Val Acc: 0.4500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/fedavg...
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.3162 | Train Acc: 0.9333
 Site-Real                          | Train Loss: 0.1639 | Train Acc: 0.9746
 Site-Painting                      | Train Loss: 0.4292 | Train Acc: 0.8699
 Site-Sketch                        | Train Loss: 0.6373 | Train Acc: 0.8170
 Site-QuickDraw                     | Train Loss: 1.7556 | Train Acc: 0.4479
 Site-Infograph                     | Train Loss: 1.8093 | Train Acc: 0.4000
Average Train Accuracy: 0.7405
 Site-Clipart                       | Val  Loss: 0.3697 | Val  Acc: 0.9190
 Site-Real                          | Val  Loss: 0.1507 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.4328 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.6547 | Val  Acc: 0.8137
 Site-QuickDraw                     | Val  Loss: 1.6993 | Val  Acc: 0.4688
 Site-Infograph                     | Val  Loss: 1.6276 | Val  Acc: 0.4500
Average Valid Accuracy: 0.7474
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.3200 | Train Acc: 0.9476
 Site-Real                          | Train Loss: 0.1410 | Train Acc: 0.9797
 Site-Painting                      | Train Loss: 0.4122 | Train Acc: 0.8659
 Site-Sketch                        | Train Loss: 0.6225 | Train Acc: 0.8170
 Site-QuickDraw                     | Train Loss: 1.7631 | Train Acc: 0.3958
 Site-Infograph                     | Train Loss: 1.8403 | Train Acc: 0.3833
Average Train Accuracy: 0.7316
 Site-Clipart                       | Val  Loss: 0.3628 | Val  Acc: 0.9286
 Site-Real                          | Val  Loss: 0.1397 | Val  Acc: 0.9695
 Site-Painting                      | Val  Loss: 0.4071 | Val  Acc: 0.8659
 Site-Sketch                        | Val  Loss: 0.6507 | Val  Acc: 0.7745
 Site-QuickDraw                     | Val  Loss: 1.7800 | Val  Acc: 0.4688
 Site-Infograph                     | Val  Loss: 1.8300 | Val  Acc: 0.3000
Average Valid Accuracy: 0.7179
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 0.3054 | Train Acc: 0.9460
 Site-Real                          | Train Loss: 0.1440 | Train Acc: 0.9746
 Site-Painting                      | Train Loss: 0.4048 | Train Acc: 0.9065
 Site-Sketch                        | Train Loss: 0.5699 | Train Acc: 0.8301
 Site-QuickDraw                     | Train Loss: 1.8099 | Train Acc: 0.4583
 Site-Infograph                     | Train Loss: 1.8232 | Train Acc: 0.3333
Average Train Accuracy: 0.7415
 Site-Clipart                       | Val  Loss: 0.3718 | Val  Acc: 0.9190
 Site-Real                          | Val  Loss: 0.1548 | Val  Acc: 0.9580
 Site-Painting                      | Val  Loss: 0.4014 | Val  Acc: 0.8720
 Site-Sketch                        | Val  Loss: 0.6093 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.7433 | Val  Acc: 0.4531
 Site-Infograph                     | Val  Loss: 1.7921 | Val  Acc: 0.3250
Average Valid Accuracy: 0.7218
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 0.3162 | Train Acc: 0.9444
 Site-Real                          | Train Loss: 0.1313 | Train Acc: 0.9797
 Site-Painting                      | Train Loss: 0.4162 | Train Acc: 0.8902
 Site-Sketch                        | Train Loss: 0.5931 | Train Acc: 0.8105
 Site-QuickDraw                     | Train Loss: 1.7702 | Train Acc: 0.4479
 Site-Infograph                     | Train Loss: 1.8741 | Train Acc: 0.3667
Average Train Accuracy: 0.7399
 Site-Clipart                       | Val  Loss: 0.3600 | Val  Acc: 0.9190
 Site-Real                          | Val  Loss: 0.1574 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.3772 | Val  Acc: 0.8902
 Site-Sketch                        | Val  Loss: 0.6237 | Val  Acc: 0.8137
 Site-QuickDraw                     | Val  Loss: 1.7428 | Val  Acc: 0.4844
 Site-Infograph                     | Val  Loss: 1.6270 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7634
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.9190
 Best site-Real                      | Epoch:42 | Val Acc: 0.9733
 Best site-Painting                  | Epoch:42 | Val Acc: 0.8902
 Best site-Sketch                    | Epoch:42 | Val Acc: 0.8137
 Best site-QuickDraw                 | Epoch:42 | Val Acc: 0.4844
 Best site-Infograph                 | Epoch:42 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_distinct/fedavg...
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 0.2991 | Train Acc: 0.9444
 Site-Real                          | Train Loss: 0.1241 | Train Acc: 0.9797
 Site-Painting                      | Train Loss: 0.4102 | Train Acc: 0.9065
 Site-Sketch                        | Train Loss: 0.4852 | Train Acc: 0.8562
 Site-QuickDraw                     | Train Loss: 1.7280 | Train Acc: 0.4062
 Site-Infograph                     | Train Loss: 1.9185 | Train Acc: 0.3167
Average Train Accuracy: 0.7350
 Site-Clipart                       | Val  Loss: 0.3714 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 0.1322 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.4036 | Val  Acc: 0.8720
 Site-Sketch                        | Val  Loss: 0.7088 | Val  Acc: 0.7745
 Site-QuickDraw                     | Val  Loss: 1.7059 | Val  Acc: 0.5000
 Site-Infograph                     | Val  Loss: 1.7444 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7422
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.3015 | Train Acc: 0.9476
 Site-Real                          | Train Loss: 0.1408 | Train Acc: 0.9898
 Site-Painting                      | Train Loss: 0.3872 | Train Acc: 0.8821
 Site-Sketch                        | Train Loss: 0.5849 | Train Acc: 0.8301
 Site-QuickDraw                     | Train Loss: 1.7295 | Train Acc: 0.4167
 Site-Infograph                     | Train Loss: 1.8175 | Train Acc: 0.4000
Average Train Accuracy: 0.7444
 Site-Clipart                       | Val  Loss: 0.3283 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.1410 | Val  Acc: 0.9656
 Site-Painting                      | Val  Loss: 0.4078 | Val  Acc: 0.8659
 Site-Sketch                        | Val  Loss: 0.6182 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.7160 | Val  Acc: 0.5000
 Site-Infograph                     | Val  Loss: 1.7192 | Val  Acc: 0.4500
Average Valid Accuracy: 0.7576
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 0.2859 | Train Acc: 0.9556
 Site-Real                          | Train Loss: 0.1304 | Train Acc: 0.9822
 Site-Painting                      | Train Loss: 0.3650 | Train Acc: 0.9024
 Site-Sketch                        | Train Loss: 0.5555 | Train Acc: 0.8366
 Site-QuickDraw                     | Train Loss: 1.7579 | Train Acc: 0.4167
 Site-Infograph                     | Train Loss: 1.8637 | Train Acc: 0.3833
Average Train Accuracy: 0.7461
 Site-Clipart                       | Val  Loss: 0.3269 | Val  Acc: 0.9476
 Site-Real                          | Val  Loss: 0.1259 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.3927 | Val  Acc: 0.8902
 Site-Sketch                        | Val  Loss: 0.5560 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.7047 | Val  Acc: 0.4844
 Site-Infograph                     | Val  Loss: 1.7099 | Val  Acc: 0.4500
Average Valid Accuracy: 0.7615
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.2774 | Train Acc: 0.9524
 Site-Real                          | Train Loss: 0.1441 | Train Acc: 0.9772
 Site-Painting                      | Train Loss: 0.3758 | Train Acc: 0.8902
 Site-Sketch                        | Train Loss: 0.6072 | Train Acc: 0.8301
 Site-QuickDraw                     | Train Loss: 1.6913 | Train Acc: 0.4688
 Site-Infograph                     | Train Loss: 1.8909 | Train Acc: 0.3667
Average Train Accuracy: 0.7475
 Site-Clipart                       | Val  Loss: 0.3444 | Val  Acc: 0.9262
 Site-Real                          | Val  Loss: 0.1471 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.4027 | Val  Acc: 0.8780
 Site-Sketch                        | Val  Loss: 0.5857 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.7173 | Val  Acc: 0.4375
 Site-Infograph                     | Val  Loss: 1.7766 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7282
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 0.2841 | Train Acc: 0.9492
 Site-Real                          | Train Loss: 0.1121 | Train Acc: 0.9822
 Site-Painting                      | Train Loss: 0.3699 | Train Acc: 0.9024
 Site-Sketch                        | Train Loss: 0.5353 | Train Acc: 0.8497
 Site-QuickDraw                     | Train Loss: 1.7914 | Train Acc: 0.4271
 Site-Infograph                     | Train Loss: 1.9088 | Train Acc: 0.3833
Average Train Accuracy: 0.7490
 Site-Clipart                       | Val  Loss: 0.3279 | Val  Acc: 0.9476
 Site-Real                          | Val  Loss: 0.1232 | Val  Acc: 0.9695
 Site-Painting                      | Val  Loss: 0.3907 | Val  Acc: 0.8476
 Site-Sketch                        | Val  Loss: 0.6268 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.7981 | Val  Acc: 0.4219
 Site-Infograph                     | Val  Loss: 1.8348 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7234
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 0.2762 | Train Acc: 0.9603
 Site-Real                          | Train Loss: 0.1255 | Train Acc: 0.9848
 Site-Painting                      | Train Loss: 0.3875 | Train Acc: 0.8699
 Site-Sketch                        | Train Loss: 0.6235 | Train Acc: 0.8039
 Site-QuickDraw                     | Train Loss: 1.6749 | Train Acc: 0.4688
 Site-Infograph                     | Train Loss: 1.8809 | Train Acc: 0.3333
Average Train Accuracy: 0.7368
 Site-Clipart                       | Val  Loss: 0.3225 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.1191 | Val  Acc: 0.9771
 Site-Painting                      | Val  Loss: 0.3893 | Val  Acc: 0.8780
 Site-Sketch                        | Val  Loss: 0.5845 | Val  Acc: 0.8137
 Site-QuickDraw                     | Val  Loss: 1.7233 | Val  Acc: 0.4531
 Site-Infograph                     | Val  Loss: 1.7587 | Val  Acc: 0.4250
Average Valid Accuracy: 0.7479
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.2665 | Train Acc: 0.9556
 Site-Real                          | Train Loss: 0.1098 | Train Acc: 0.9772
 Site-Painting                      | Train Loss: 0.3962 | Train Acc: 0.8780
 Site-Sketch                        | Train Loss: 0.5378 | Train Acc: 0.8105
 Site-QuickDraw                     | Train Loss: 1.7963 | Train Acc: 0.4479
 Site-Infograph                     | Train Loss: 1.9503 | Train Acc: 0.3333
Average Train Accuracy: 0.7337
 Site-Clipart                       | Val  Loss: 0.3138 | Val  Acc: 0.9452
 Site-Real                          | Val  Loss: 0.1172 | Val  Acc: 0.9771
 Site-Painting                      | Val  Loss: 0.3582 | Val  Acc: 0.9085
 Site-Sketch                        | Val  Loss: 0.6520 | Val  Acc: 0.8137
 Site-QuickDraw                     | Val  Loss: 1.7023 | Val  Acc: 0.4219
 Site-Infograph                     | Val  Loss: 1.7856 | Val  Acc: 0.3750
Average Valid Accuracy: 0.7402
===2023-07-01 18:54:42===
===2023-07-01 18:54:45===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[630,394,246,153,96,60,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,1314,821,513,320,200,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   | Epoch:42 | Test Acc: 0.9392
 Test site-Real                      | Epoch:42 | Test Acc: 0.9638
 Test site-Painting                  | Epoch:42 | Test Acc: 0.8998
 Test site-Sketch                    | Epoch:42 | Test Acc: 0.8736
 Test site-QuickDraw                 | Epoch:42 | Test Acc: 0.5300
 Test site-Infograph                 | Epoch:42 | Test Acc: 0.5145
Clipart: 0.9392, Real: 0.9638, Painting: 0.8998, Sketch: 0.8736, QuickDraw: 0.5300, Infograph: 0.5145, 
Average Test Accuracy(group): 0.7868, Average Test Accuracy(individual): 0.7868,
domain std=0.1893, cluster std=-1.0000, individual std=0.1893, 
