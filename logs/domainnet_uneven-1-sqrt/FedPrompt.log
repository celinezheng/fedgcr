===2023-03-30 19:55:25===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
clients=[(7,)(0,)(5,)]
 Site-Clipart   | Train Loss: 1.9878 | Train Acc: 0.3492
 Site-Clipart   | Train Loss: 1.9139 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.8535 | Train Acc: 0.5079
 Site-Clipart   | Train Loss: 1.8557 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 2.1420 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.1485 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 2.0108 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.9741 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.9863 | Train Acc: 0.4127
 Site-QuickDraw | Train Loss: 2.3244 | Train Acc: 0.0794
 Site-Real      | Train Loss: 1.8891 | Train Acc: 0.5397
 Site-Sketch    | Train Loss: 1.8887 | Train Acc: 0.4444
 Site-Clipart   | Val  Loss: 1.8827 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.8730 | Val  Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.9562 | Val  Acc: 0.4048
 Site-Clipart   | Val  Loss: 1.9937 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0322 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.0869 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.2040 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.8561 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 2.0394 | Val  Acc: 0.4048
 Site-QuickDraw | Val  Loss: 2.2808 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 1.9986 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 2.0416 | Val  Acc: 0.3810
Average Valid Accuracy: 0.3750
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4286
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4048
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Painting   | Epoch:0 | Val Acc: 0.4762
 Best site-Painting   | Epoch:0 | Val Acc: 0.4048
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0952
 Best site-Real       | Epoch:0 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
clients=[(7,)(0,)(5,)]
 Site-Clipart   | Train Loss: 1.6116 | Train Acc: 0.5238
 Site-Clipart   | Train Loss: 1.6107 | Train Acc: 0.5714
 Site-Clipart   | Train Loss: 1.5129 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.4714 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 2.0689 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 1.9598 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.8685 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.4540 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 1.4608 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.2435 | Train Acc: 0.1905
 Site-Real      | Train Loss: 1.3856 | Train Acc: 0.7302
 Site-Sketch    | Train Loss: 1.4368 | Train Acc: 0.6984
 Site-Clipart   | Val  Loss: 1.4132 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.4520 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.5811 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.5788 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.9542 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 1.9093 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.1085 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 1.3364 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 1.5973 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 2.2547 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.5124 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.6243 | Val  Acc: 0.5476
Average Valid Accuracy: 0.5556
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3095
 Best site-Painting   | Epoch:1 | Val Acc: 0.7381
 Best site-Painting   | Epoch:1 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1905
 Best site-Real       | Epoch:1 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5476
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
clients=[(7,)(0,)(5,)]
 Site-Clipart   | Train Loss: 1.2184 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.3336 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.1736 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.0512 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.9712 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.7815 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.7092 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 1.1379 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 1.0859 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 2.1584 | Train Acc: 0.2381
 Site-Real      | Train Loss: 1.0205 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.1720 | Train Acc: 0.7302
 Site-Clipart   | Val  Loss: 1.0917 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.1169 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.3548 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.2887 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.7609 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 1.7408 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 2.0549 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 0.9695 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 1.2719 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 2.2335 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.0823 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 1.4272 | Val  Acc: 0.6190
Average Valid Accuracy: 0.6250
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3095
 Best site-Painting   | Epoch:2 | Val Acc: 0.9286
 Best site-Painting   | Epoch:2 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2381
 Best site-Real       | Epoch:2 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
clients=[(7,)(0,)(5,)]
 Site-Clipart   | Train Loss: 0.9888 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.0286 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 0.9075 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.7783 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.8034 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.5897 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.4383 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.8638 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.7966 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.9836 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.7755 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.9336 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.8347 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8411 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.1271 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.9274 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.5694 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.4931 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7961 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.6920 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.9454 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 2.0270 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.7988 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.1533 | Val  Acc: 0.6429
Average Valid Accuracy: 0.6944
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4524
 Best site-Painting   | Epoch:3 | Val Acc: 0.9048
 Best site-Painting   | Epoch:3 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3333
 Best site-Real       | Epoch:3 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
clients=[(7,)(0,)(5,)]
 Site-Clipart   | Train Loss: 0.6836 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.7601 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.6860 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.5117 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.6405 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.4299 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.2516 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.6324 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.5739 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.8688 | Train Acc: 0.2857
 Site-Real      | Train Loss: 0.5603 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.6868 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.5436 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5675 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.9373 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.7884 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.3676 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.3675 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6953 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.5287 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.7437 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.9720 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5325 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.9332 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7282
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4524
 Best site-Painting   | Epoch:4 | Val Acc: 0.8810
 Best site-Painting   | Epoch:4 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2857
 Best site-Real       | Epoch:4 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
clients=[(7,)(0,)(5,)]
 Site-Clipart   | Train Loss: 0.5148 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.7499 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.5976 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.4243 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.6497 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.3856 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1460 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.5277 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.4844 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.7195 | Train Acc: 0.3492
 Site-Real      | Train Loss: 0.4380 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.6577 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.4780 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5386 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.8240 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.6400 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.1499 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.2010 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7350 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 0.4924 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.6471 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.8777 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.4412 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.8237 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7341
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3333
 Best site-Painting   | Epoch:5 | Val Acc: 0.9048
 Best site-Painting   | Epoch:5 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3333
 Best site-Real       | Epoch:5 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
clients=[(7,)(0,)(5,)]
 Site-Clipart   | Train Loss: 0.4267 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.7056 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.4359 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3061 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.5241 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.1845 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.0669 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.4464 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.3590 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.4442 | Train Acc: 0.5238
 Site-Real      | Train Loss: 0.3801 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.6453 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 0.2991 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3769 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.5944 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4949 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.2013 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 0.9697 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.5719 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.4004 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.5265 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.4784 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.4176 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8402 | Val  Acc: 0.7381
Average Valid Accuracy: 0.7956
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4524
 Best site-Painting   | Epoch:6 | Val Acc: 0.9286
 Best site-Painting   | Epoch:6 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5238
 Best site-Real       | Epoch:6 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
clients=[(7,)(0,)(5,)]
 Site-Clipart   | Train Loss: 0.2395 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.5116 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.4003 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2388 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.3336 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 0.9178 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.9308 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.2837 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.3108 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.2631 | Train Acc: 0.7143
 Site-Real      | Train Loss: 0.3571 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.4725 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.2478 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3881 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4570 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4259 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.9322 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.8542 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.6343 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 0.2754 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.3836 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.6282 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.3687 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6044 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8095
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:7 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:7 | Val Acc: 0.3333
 Best site-Painting   | Epoch:7 | Val Acc: 0.9524
 Best site-Painting   | Epoch:7 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.4524
 Best site-Real       | Epoch:7 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
clients=[(7,)(0,)(5,)]
 Site-Clipart   | Train Loss: 0.2699 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3621 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.2594 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1960 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.2347 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 0.9465 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.7408 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.1979 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2869 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.1936 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.2704 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.4211 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.2263 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2301 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.4766 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3184 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.7825 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.9491 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.0414 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.1732 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2457 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.4712 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.2896 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7066 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8433
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6667
 Best site-Painting   | Epoch:8 | Val Acc: 1.0000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.4762
 Best site-Real       | Epoch:8 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
clients=[(7,)(0,)(5,)]
 Site-Clipart   | Train Loss: 0.2576 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3386 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2311 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2002 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.9809 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.6672 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 0.5772 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.2316 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.1741 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.3698 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.3006 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.3685 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.1972 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1823 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2857 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2188 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.7079 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.5900 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.8845 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 0.1173 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.2584 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.4050 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.3499 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6959 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8690
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7143
 Best site-Painting   | Epoch:9 | Val Acc: 0.9762
 Best site-Painting   | Epoch:9 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.5476
 Best site-Real       | Epoch:9 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:9 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt/FedPrompt...
===2023-03-30 20:28:03===
===2023-03-30 20:28:05===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8460
 Test site-Infograph | Epoch:9 | Test Acc: 0.5023
 Test site-Painting  | Epoch:9 | Test Acc: 0.8481
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.4570
 Test site-Real      | Epoch:9 | Test Acc: 0.9047
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7816
Average Test Accuracy: 0.7233
