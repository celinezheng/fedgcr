===2023-08-01 12:19:32===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 2, 4, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (2) | Train Loss: 1.6627 | Train Acc: 0.5849
 Site-MNIST                     (2) | Train Loss: 1.7236 | Train Acc: 0.5390
 Site-USPS                      (2) | Train Loss: 1.6203 | Train Acc: 0.6927
 Site-USPS                      (2) | Train Loss: 1.6366 | Train Acc: 0.6574
 Site-SynthDigits               (0) | Train Loss: 2.0559 | Train Acc: 0.2992
 Site-SynthDigits               (0) | Train Loss: 2.0226 | Train Acc: 0.3417
 Site-MNIST_M                   (3) | Train Loss: 2.1848 | Train Acc: 0.2210
 Site-MNIST_M                   (3) | Train Loss: 2.1833 | Train Acc: 0.2251
 Site-SVHN                      (1) | Train Loss: 2.1921 | Train Acc: 0.1995
 Site-SVHN                      (1) | Train Loss: 2.1735 | Train Acc: 0.2359
Average Train Accuracy: 0.3996
 Site-MNIST                     (2) | Val  Loss: 1.7611 | Val  Acc: 0.5109
 Site-MNIST                     (2) | Val  Loss: 1.6877 | Val  Acc: 0.5791
 Site-USPS                      (2) | Val  Loss: 1.6446 | Val  Acc: 0.6522
 Site-USPS                      (2) | Val  Loss: 1.6560 | Val  Acc: 0.6367
 Site-SynthDigits               (0) | Val  Loss: 2.0734 | Val  Acc: 0.2935
 Site-SynthDigits               (0) | Val  Loss: 2.0365 | Val  Acc: 0.3309
 Site-MNIST_M                   (3) | Val  Loss: 2.2369 | Val  Acc: 0.2283
 Site-MNIST_M                   (3) | Val  Loss: 2.1856 | Val  Acc: 0.2374
 Site-SVHN                      (1) | Val  Loss: 2.1650 | Val  Acc: 0.2935
 Site-SVHN                      (1) | Val  Loss: 2.1733 | Val  Acc: 0.2374
Average Valid Accuracy: 0.4000
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5109
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5791
 Best site-USPS                     (2)  | Epoch:0 | Val Acc: 0.6522
 Best site-USPS                     (2)  | Epoch:0 | Val Acc: 0.6367
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.2935
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.3309
 Best site-MNIST_M                  (3)  | Epoch:0 | Val Acc: 0.2283
 Best site-MNIST_M                  (3)  | Epoch:0 | Val Acc: 0.2374
 Best site-SVHN                     (1)  | Epoch:0 | Val Acc: 0.2935
 Best site-SVHN                     (1)  | Epoch:0 | Val Acc: 0.2374
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 1 ============
cnt=[3, 2, 3, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (0) | Train Loss: 1.2566 | Train Acc: 0.8032
 Site-MNIST                     (0) | Train Loss: 1.3327 | Train Acc: 0.7318
 Site-USPS                      (2) | Train Loss: 1.1643 | Train Acc: 0.8113
 Site-USPS                      (2) | Train Loss: 1.1929 | Train Acc: 0.7883
 Site-SynthDigits               (2) | Train Loss: 1.8255 | Train Acc: 0.3801
 Site-SynthDigits               (0) | Train Loss: 1.7456 | Train Acc: 0.4359
 Site-MNIST_M                   (3) | Train Loss: 1.9512 | Train Acc: 0.3585
 Site-MNIST_M                   (3) | Train Loss: 1.9756 | Train Acc: 0.3345
 Site-SVHN                      (1) | Train Loss: 2.0671 | Train Acc: 0.2642
 Site-SVHN                      (1) | Train Loss: 2.0267 | Train Acc: 0.2969
Average Train Accuracy: 0.5205
 Site-MNIST                     (0) | Val  Loss: 1.3403 | Val  Acc: 0.7283
 Site-MNIST                     (0) | Val  Loss: 1.2986 | Val  Acc: 0.7734
 Site-USPS                      (2) | Val  Loss: 1.2124 | Val  Acc: 0.7609
 Site-USPS                      (2) | Val  Loss: 1.2281 | Val  Acc: 0.7734
 Site-SynthDigits               (2) | Val  Loss: 1.7759 | Val  Acc: 0.3913
 Site-SynthDigits               (0) | Val  Loss: 1.7544 | Val  Acc: 0.3921
 Site-MNIST_M                   (3) | Val  Loss: 2.0138 | Val  Acc: 0.3261
 Site-MNIST_M                   (3) | Val  Loss: 1.9415 | Val  Acc: 0.4029
 Site-SVHN                      (1) | Val  Loss: 2.0484 | Val  Acc: 0.3043
 Site-SVHN                      (1) | Val  Loss: 2.0628 | Val  Acc: 0.3129
Average Valid Accuracy: 0.5166
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7283
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7734
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.7609
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.7734
 Best site-SynthDigits              (2)  | Epoch:1 | Val Acc: 0.3913
 Best site-SynthDigits              (0)  | Epoch:1 | Val Acc: 0.3921
 Best site-MNIST_M                  (3)  | Epoch:1 | Val Acc: 0.3261
 Best site-MNIST_M                  (3)  | Epoch:1 | Val Acc: 0.4029
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.3043
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.3129
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 2, 4, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (2) | Train Loss: 1.1135 | Train Acc: 0.7763
 Site-MNIST                     (2) | Train Loss: 1.2019 | Train Acc: 0.7166
 Site-USPS                      (0) | Train Loss: 1.0007 | Train Acc: 0.8275
 Site-USPS                      (0) | Train Loss: 1.0358 | Train Acc: 0.7910
 Site-SynthDigits               (2) | Train Loss: 1.5854 | Train Acc: 0.4987
 Site-SynthDigits               (2) | Train Loss: 1.5048 | Train Acc: 0.5220
 Site-MNIST_M                   (3) | Train Loss: 1.7173 | Train Acc: 0.4663
 Site-MNIST_M                   (3) | Train Loss: 1.7777 | Train Acc: 0.4126
 Site-SVHN                      (1) | Train Loss: 1.9435 | Train Acc: 0.3396
 Site-SVHN                      (1) | Train Loss: 1.8856 | Train Acc: 0.3453
Average Train Accuracy: 0.5696
 Site-MNIST                     (2) | Val  Loss: 1.1908 | Val  Acc: 0.7391
 Site-MNIST                     (2) | Val  Loss: 1.1724 | Val  Acc: 0.7842
 Site-USPS                      (0) | Val  Loss: 1.0517 | Val  Acc: 0.7826
 Site-USPS                      (0) | Val  Loss: 1.0722 | Val  Acc: 0.7914
 Site-SynthDigits               (2) | Val  Loss: 1.5152 | Val  Acc: 0.4674
 Site-SynthDigits               (2) | Val  Loss: 1.4902 | Val  Acc: 0.5000
 Site-MNIST_M                   (3) | Val  Loss: 1.8044 | Val  Acc: 0.4239
 Site-MNIST_M                   (3) | Val  Loss: 1.7155 | Val  Acc: 0.4964
 Site-SVHN                      (1) | Val  Loss: 1.9233 | Val  Acc: 0.3261
 Site-SVHN                      (1) | Val  Loss: 1.9451 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5671
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.7391
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.7842
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7826
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7914
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.4674
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.5000
 Best site-MNIST_M                  (3)  | Epoch:2 | Val Acc: 0.4239
 Best site-MNIST_M                  (3)  | Epoch:2 | Val Acc: 0.4964
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.3261
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.3597
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 3 ============
cnt=[4, 2, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (0) | Train Loss: 0.8548 | Train Acc: 0.8679
 Site-MNIST                     (0) | Train Loss: 0.9408 | Train Acc: 0.8018
 Site-USPS                      (2) | Train Loss: 0.8093 | Train Acc: 0.8571
 Site-USPS                      (2) | Train Loss: 0.8370 | Train Acc: 0.8314
 Site-SynthDigits               (0) | Train Loss: 1.3884 | Train Acc: 0.5876
 Site-SynthDigits               (0) | Train Loss: 1.2929 | Train Acc: 0.6359
 Site-MNIST_M                   (1) | Train Loss: 1.5780 | Train Acc: 0.5121
 Site-MNIST_M                   (1) | Train Loss: 1.6108 | Train Acc: 0.4942
 Site-SVHN                      (3) | Train Loss: 1.8302 | Train Acc: 0.3827
 Site-SVHN                      (3) | Train Loss: 1.7519 | Train Acc: 0.4161
Average Train Accuracy: 0.6387
 Site-MNIST                     (0) | Val  Loss: 0.9288 | Val  Acc: 0.8152
 Site-MNIST                     (0) | Val  Loss: 0.9228 | Val  Acc: 0.8309
 Site-USPS                      (2) | Val  Loss: 0.8849 | Val  Acc: 0.7500
 Site-USPS                      (2) | Val  Loss: 0.8832 | Val  Acc: 0.8094
 Site-SynthDigits               (0) | Val  Loss: 1.3330 | Val  Acc: 0.5761
 Site-SynthDigits               (0) | Val  Loss: 1.2931 | Val  Acc: 0.5719
 Site-MNIST_M                   (1) | Val  Loss: 1.6598 | Val  Acc: 0.4348
 Site-MNIST_M                   (1) | Val  Loss: 1.5618 | Val  Acc: 0.5324
 Site-SVHN                      (3) | Val  Loss: 1.8102 | Val  Acc: 0.3587
 Site-SVHN                      (3) | Val  Loss: 1.8374 | Val  Acc: 0.3921
Average Valid Accuracy: 0.6071
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8152
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8309
 Best site-USPS                     (2)  | Epoch:3 | Val Acc: 0.7500
 Best site-USPS                     (2)  | Epoch:3 | Val Acc: 0.8094
 Best site-SynthDigits              (0)  | Epoch:3 | Val Acc: 0.5761
 Best site-SynthDigits              (0)  | Epoch:3 | Val Acc: 0.5719
 Best site-MNIST_M                  (1)  | Epoch:3 | Val Acc: 0.4348
 Best site-MNIST_M                  (1)  | Epoch:3 | Val Acc: 0.5324
 Best site-SVHN                     (3)  | Epoch:3 | Val Acc: 0.3587
 Best site-SVHN                     (3)  | Epoch:3 | Val Acc: 0.3921
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 4 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (0) | Train Loss: 0.7352 | Train Acc: 0.8706
 Site-MNIST                     (0) | Train Loss: 0.8300 | Train Acc: 0.8269
 Site-USPS                      (2) | Train Loss: 0.7251 | Train Acc: 0.8598
 Site-USPS                      (2) | Train Loss: 0.7501 | Train Acc: 0.8377
 Site-SynthDigits               (0) | Train Loss: 1.2159 | Train Acc: 0.6415
 Site-SynthDigits               (0) | Train Loss: 1.1281 | Train Acc: 0.6915
 Site-MNIST_M                   (1) | Train Loss: 1.4607 | Train Acc: 0.5876
 Site-MNIST_M                   (1) | Train Loss: 1.5060 | Train Acc: 0.5426
 Site-SVHN                      (3) | Train Loss: 1.6795 | Train Acc: 0.4367
 Site-SVHN                      (3) | Train Loss: 1.6027 | Train Acc: 0.4735
Average Train Accuracy: 0.6768
 Site-MNIST                     (0) | Val  Loss: 0.7795 | Val  Acc: 0.8043
 Site-MNIST                     (0) | Val  Loss: 0.8040 | Val  Acc: 0.8381
 Site-USPS                      (2) | Val  Loss: 0.8122 | Val  Acc: 0.7717
 Site-USPS                      (2) | Val  Loss: 0.8081 | Val  Acc: 0.8201
 Site-SynthDigits               (0) | Val  Loss: 1.1521 | Val  Acc: 0.6196
 Site-SynthDigits               (0) | Val  Loss: 1.1413 | Val  Acc: 0.6259
 Site-MNIST_M                   (1) | Val  Loss: 1.5618 | Val  Acc: 0.5326
 Site-MNIST_M                   (1) | Val  Loss: 1.4571 | Val  Acc: 0.5899
 Site-SVHN                      (3) | Val  Loss: 1.6756 | Val  Acc: 0.3696
 Site-SVHN                      (3) | Val  Loss: 1.6857 | Val  Acc: 0.4532
Average Valid Accuracy: 0.6425
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8043
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8381
 Best site-USPS                     (2)  | Epoch:4 | Val Acc: 0.7717
 Best site-USPS                     (2)  | Epoch:4 | Val Acc: 0.8201
 Best site-SynthDigits              (0)  | Epoch:4 | Val Acc: 0.6196
 Best site-SynthDigits              (0)  | Epoch:4 | Val Acc: 0.6259
 Best site-MNIST_M                  (1)  | Epoch:4 | Val Acc: 0.5326
 Best site-MNIST_M                  (1)  | Epoch:4 | Val Acc: 0.5899
 Best site-SVHN                     (3)  | Epoch:4 | Val Acc: 0.3696
 Best site-SVHN                     (3)  | Epoch:4 | Val Acc: 0.4532
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (1) | Train Loss: 0.6491 | Train Acc: 0.8814
 Site-MNIST                     (1) | Train Loss: 0.7332 | Train Acc: 0.8260
 Site-USPS                      (2) | Train Loss: 0.6685 | Train Acc: 0.8437
 Site-USPS                      (2) | Train Loss: 0.6893 | Train Acc: 0.8323
 Site-SynthDigits               (1) | Train Loss: 1.1243 | Train Acc: 0.6334
 Site-SynthDigits               (1) | Train Loss: 1.0303 | Train Acc: 0.7085
 Site-MNIST_M                   (0) | Train Loss: 1.3379 | Train Acc: 0.6307
 Site-MNIST_M                   (0) | Train Loss: 1.3912 | Train Acc: 0.5874
 Site-SVHN                      (3) | Train Loss: 1.5691 | Train Acc: 0.4663
 Site-SVHN                      (3) | Train Loss: 1.4858 | Train Acc: 0.5067
Average Train Accuracy: 0.6917
 Site-MNIST                     (1) | Val  Loss: 0.6779 | Val  Acc: 0.8478
 Site-MNIST                     (1) | Val  Loss: 0.7164 | Val  Acc: 0.8525
 Site-USPS                      (2) | Val  Loss: 0.7648 | Val  Acc: 0.7609
 Site-USPS                      (2) | Val  Loss: 0.7524 | Val  Acc: 0.8094
 Site-SynthDigits               (1) | Val  Loss: 1.0515 | Val  Acc: 0.6304
 Site-SynthDigits               (1) | Val  Loss: 1.0584 | Val  Acc: 0.6151
 Site-MNIST_M                   (0) | Val  Loss: 1.4449 | Val  Acc: 0.5543
 Site-MNIST_M                   (0) | Val  Loss: 1.3429 | Val  Acc: 0.6367
 Site-SVHN                      (3) | Val  Loss: 1.5392 | Val  Acc: 0.4239
 Site-SVHN                      (3) | Val  Loss: 1.5492 | Val  Acc: 0.4856
Average Valid Accuracy: 0.6617
 Best site-MNIST                    (1)  | Epoch:5 | Val Acc: 0.8478
 Best site-MNIST                    (1)  | Epoch:5 | Val Acc: 0.8525
 Best site-USPS                     (2)  | Epoch:5 | Val Acc: 0.7609
 Best site-USPS                     (2)  | Epoch:5 | Val Acc: 0.8094
 Best site-SynthDigits              (1)  | Epoch:5 | Val Acc: 0.6304
 Best site-SynthDigits              (1)  | Epoch:5 | Val Acc: 0.6151
 Best site-MNIST_M                  (0)  | Epoch:5 | Val Acc: 0.5543
 Best site-MNIST_M                  (0)  | Epoch:5 | Val Acc: 0.6367
 Best site-SVHN                     (3)  | Epoch:5 | Val Acc: 0.4239
 Best site-SVHN                     (3)  | Epoch:5 | Val Acc: 0.4856
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 4, 2, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (1) | Train Loss: 0.5612 | Train Acc: 0.8841
 Site-MNIST                     (1) | Train Loss: 0.6556 | Train Acc: 0.8430
 Site-USPS                      (3) | Train Loss: 0.6143 | Train Acc: 0.8733
 Site-USPS                      (3) | Train Loss: 0.6329 | Train Acc: 0.8511
 Site-SynthDigits               (1) | Train Loss: 0.9905 | Train Acc: 0.6927
 Site-SynthDigits               (1) | Train Loss: 0.9127 | Train Acc: 0.7435
 Site-MNIST_M                   (2) | Train Loss: 1.2899 | Train Acc: 0.6415
 Site-MNIST_M                   (2) | Train Loss: 1.3159 | Train Acc: 0.6054
 Site-SVHN                      (0) | Train Loss: 1.4320 | Train Acc: 0.5364
 Site-SVHN                      (0) | Train Loss: 1.3437 | Train Acc: 0.5704
Average Train Accuracy: 0.7241
 Site-MNIST                     (1) | Val  Loss: 0.5902 | Val  Acc: 0.8370
 Site-MNIST                     (1) | Val  Loss: 0.6361 | Val  Acc: 0.8525
 Site-USPS                      (3) | Val  Loss: 0.7167 | Val  Acc: 0.7935
 Site-USPS                      (3) | Val  Loss: 0.6938 | Val  Acc: 0.8309
 Site-SynthDigits               (1) | Val  Loss: 0.9390 | Val  Acc: 0.6739
 Site-SynthDigits               (1) | Val  Loss: 0.9358 | Val  Acc: 0.6871
 Site-MNIST_M                   (2) | Val  Loss: 1.3756 | Val  Acc: 0.5326
 Site-MNIST_M                   (2) | Val  Loss: 1.2826 | Val  Acc: 0.6331
 Site-SVHN                      (0) | Val  Loss: 1.3749 | Val  Acc: 0.5326
 Site-SVHN                      (0) | Val  Loss: 1.3939 | Val  Acc: 0.5468
Average Valid Accuracy: 0.6920
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8370
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8525
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.7935
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.8309
 Best site-SynthDigits              (1)  | Epoch:6 | Val Acc: 0.6739
 Best site-SynthDigits              (1)  | Epoch:6 | Val Acc: 0.6871
 Best site-MNIST_M                  (2)  | Epoch:6 | Val Acc: 0.5326
 Best site-MNIST_M                  (2)  | Epoch:6 | Val Acc: 0.6331
 Best site-SVHN                     (0)  | Epoch:6 | Val Acc: 0.5326
 Best site-SVHN                     (0)  | Epoch:6 | Val Acc: 0.5468
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 7 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (0) | Train Loss: 0.5261 | Train Acc: 0.8814
 Site-MNIST                     (0) | Train Loss: 0.6095 | Train Acc: 0.8368
 Site-USPS                      (2) | Train Loss: 0.5686 | Train Acc: 0.8814
 Site-USPS                      (2) | Train Loss: 0.5932 | Train Acc: 0.8574
 Site-SynthDigits               (0) | Train Loss: 0.9449 | Train Acc: 0.7143
 Site-SynthDigits               (0) | Train Loss: 0.8522 | Train Acc: 0.7605
 Site-MNIST_M                   (1) | Train Loss: 1.1863 | Train Acc: 0.6577
 Site-MNIST_M                   (1) | Train Loss: 1.2140 | Train Acc: 0.6466
 Site-SVHN                      (3) | Train Loss: 1.3778 | Train Acc: 0.5472
 Site-SVHN                      (3) | Train Loss: 1.3037 | Train Acc: 0.5892
Average Train Accuracy: 0.7373
 Site-MNIST                     (0) | Val  Loss: 0.5351 | Val  Acc: 0.8261
 Site-MNIST                     (0) | Val  Loss: 0.5927 | Val  Acc: 0.8453
 Site-USPS                      (2) | Val  Loss: 0.6758 | Val  Acc: 0.7826
 Site-USPS                      (2) | Val  Loss: 0.6455 | Val  Acc: 0.8417
 Site-SynthDigits               (0) | Val  Loss: 0.8928 | Val  Acc: 0.6957
 Site-SynthDigits               (0) | Val  Loss: 0.8802 | Val  Acc: 0.7230
 Site-MNIST_M                   (1) | Val  Loss: 1.2706 | Val  Acc: 0.5761
 Site-MNIST_M                   (1) | Val  Loss: 1.1847 | Val  Acc: 0.6547
 Site-SVHN                      (3) | Val  Loss: 1.3194 | Val  Acc: 0.5435
 Site-SVHN                      (3) | Val  Loss: 1.3486 | Val  Acc: 0.5683
Average Valid Accuracy: 0.7057
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8261
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8453
 Best site-USPS                     (2)  | Epoch:7 | Val Acc: 0.7826
 Best site-USPS                     (2)  | Epoch:7 | Val Acc: 0.8417
 Best site-SynthDigits              (0)  | Epoch:7 | Val Acc: 0.6957
 Best site-SynthDigits              (0)  | Epoch:7 | Val Acc: 0.7230
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.5761
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.6547
 Best site-SVHN                     (3)  | Epoch:7 | Val Acc: 0.5435
 Best site-SVHN                     (3)  | Epoch:7 | Val Acc: 0.5683
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 4, 2, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (1) | Train Loss: 0.4752 | Train Acc: 0.8976
 Site-MNIST                     (1) | Train Loss: 0.5662 | Train Acc: 0.8466
 Site-USPS                      (2) | Train Loss: 0.5438 | Train Acc: 0.8652
 Site-USPS                      (2) | Train Loss: 0.5615 | Train Acc: 0.8520
 Site-SynthDigits               (1) | Train Loss: 0.8561 | Train Acc: 0.7547
 Site-SynthDigits               (1) | Train Loss: 0.7749 | Train Acc: 0.7848
 Site-MNIST_M                   (0) | Train Loss: 1.1333 | Train Acc: 0.6496
 Site-MNIST_M                   (0) | Train Loss: 1.1490 | Train Acc: 0.6628
 Site-SVHN                      (3) | Train Loss: 1.3148 | Train Acc: 0.5660
 Site-SVHN                      (3) | Train Loss: 1.2502 | Train Acc: 0.5937
Average Train Accuracy: 0.7473
 Site-MNIST                     (1) | Val  Loss: 0.4846 | Val  Acc: 0.8478
 Site-MNIST                     (1) | Val  Loss: 0.5476 | Val  Acc: 0.8561
 Site-USPS                      (2) | Val  Loss: 0.6559 | Val  Acc: 0.7826
 Site-USPS                      (2) | Val  Loss: 0.6240 | Val  Acc: 0.8309
 Site-SynthDigits               (1) | Val  Loss: 0.8019 | Val  Acc: 0.7500
 Site-SynthDigits               (1) | Val  Loss: 0.8069 | Val  Acc: 0.7446
 Site-MNIST_M                   (0) | Val  Loss: 1.2157 | Val  Acc: 0.5870
 Site-MNIST_M                   (0) | Val  Loss: 1.1236 | Val  Acc: 0.6763
 Site-SVHN                      (3) | Val  Loss: 1.2892 | Val  Acc: 0.5652
 Site-SVHN                      (3) | Val  Loss: 1.3004 | Val  Acc: 0.5827
Average Valid Accuracy: 0.7223
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8478
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8561
 Best site-USPS                     (2)  | Epoch:8 | Val Acc: 0.7826
 Best site-USPS                     (2)  | Epoch:8 | Val Acc: 0.8309
 Best site-SynthDigits              (1)  | Epoch:8 | Val Acc: 0.7500
 Best site-SynthDigits              (1)  | Epoch:8 | Val Acc: 0.7446
 Best site-MNIST_M                  (0)  | Epoch:8 | Val Acc: 0.5870
 Best site-MNIST_M                  (0)  | Epoch:8 | Val Acc: 0.6763
 Best site-SVHN                     (3)  | Epoch:8 | Val Acc: 0.5652
 Best site-SVHN                     (3)  | Epoch:8 | Val Acc: 0.5827
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 4, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (0) | Train Loss: 0.4383 | Train Acc: 0.8949
 Site-MNIST                     (0) | Train Loss: 0.5247 | Train Acc: 0.8457
 Site-USPS                      (1) | Train Loss: 0.5109 | Train Acc: 0.8706
 Site-USPS                      (1) | Train Loss: 0.5250 | Train Acc: 0.8646
 Site-SynthDigits               (1) | Train Loss: 0.8357 | Train Acc: 0.7547
 Site-SynthDigits               (1) | Train Loss: 0.7527 | Train Acc: 0.7821
 Site-MNIST_M                   (2) | Train Loss: 1.0924 | Train Acc: 0.6631
 Site-MNIST_M                   (2) | Train Loss: 1.1052 | Train Acc: 0.6709
 Site-SVHN                      (3) | Train Loss: 1.2578 | Train Acc: 0.5714
 Site-SVHN                      (3) | Train Loss: 1.1862 | Train Acc: 0.6090
Average Train Accuracy: 0.7527
 Site-MNIST                     (0) | Val  Loss: 0.4484 | Val  Acc: 0.8370
 Site-MNIST                     (0) | Val  Loss: 0.5086 | Val  Acc: 0.8453
 Site-USPS                      (1) | Val  Loss: 0.6288 | Val  Acc: 0.7826
 Site-USPS                      (1) | Val  Loss: 0.5880 | Val  Acc: 0.8381
 Site-SynthDigits               (1) | Val  Loss: 0.8001 | Val  Acc: 0.7283
 Site-SynthDigits               (1) | Val  Loss: 0.7814 | Val  Acc: 0.7374
 Site-MNIST_M                   (2) | Val  Loss: 1.1724 | Val  Acc: 0.5761
 Site-MNIST_M                   (2) | Val  Loss: 1.0694 | Val  Acc: 0.6763
 Site-SVHN                      (3) | Val  Loss: 1.2205 | Val  Acc: 0.5761
 Site-SVHN                      (3) | Val  Loss: 1.2405 | Val  Acc: 0.5899
Average Valid Accuracy: 0.7187
============ Train epoch 10 ============
cnt=[4, 2, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (2) | Train Loss: 0.4232 | Train Acc: 0.8895
 Site-MNIST                     (2) | Train Loss: 0.5138 | Train Acc: 0.8439
 Site-USPS                      (0) | Train Loss: 0.5212 | Train Acc: 0.8571
 Site-USPS                      (0) | Train Loss: 0.5436 | Train Acc: 0.8556
 Site-SynthDigits               (0) | Train Loss: 0.7551 | Train Acc: 0.7898
 Site-SynthDigits               (0) | Train Loss: 0.6858 | Train Acc: 0.7991
 Site-MNIST_M                   (1) | Train Loss: 1.0310 | Train Acc: 0.6685
 Site-MNIST_M                   (1) | Train Loss: 1.0257 | Train Acc: 0.7067
 Site-SVHN                      (3) | Train Loss: 1.2393 | Train Acc: 0.5876
 Site-SVHN                      (3) | Train Loss: 1.1688 | Train Acc: 0.6242
Average Train Accuracy: 0.7622
 Site-MNIST                     (2) | Val  Loss: 0.4241 | Val  Acc: 0.8587
 Site-MNIST                     (2) | Val  Loss: 0.5017 | Val  Acc: 0.8525
 Site-USPS                      (0) | Val  Loss: 0.6366 | Val  Acc: 0.7826
 Site-USPS                      (0) | Val  Loss: 0.6004 | Val  Acc: 0.8273
 Site-SynthDigits               (0) | Val  Loss: 0.7034 | Val  Acc: 0.7500
 Site-SynthDigits               (0) | Val  Loss: 0.7183 | Val  Acc: 0.7554
 Site-MNIST_M                   (1) | Val  Loss: 1.0950 | Val  Acc: 0.6087
 Site-MNIST_M                   (1) | Val  Loss: 1.0057 | Val  Acc: 0.6871
 Site-SVHN                      (3) | Val  Loss: 1.1929 | Val  Acc: 0.5978
 Site-SVHN                      (3) | Val  Loss: 1.2069 | Val  Acc: 0.6079
Average Valid Accuracy: 0.7328
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.8587
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.8525
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.7826
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8273
 Best site-SynthDigits              (0)  | Epoch:10 | Val Acc: 0.7500
 Best site-SynthDigits              (0)  | Epoch:10 | Val Acc: 0.7554
 Best site-MNIST_M                  (1)  | Epoch:10 | Val Acc: 0.6087
 Best site-MNIST_M                  (1)  | Epoch:10 | Val Acc: 0.6871
 Best site-SVHN                     (3)  | Epoch:10 | Val Acc: 0.5978
 Best site-SVHN                     (3)  | Epoch:10 | Val Acc: 0.6079
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (0) | Train Loss: 0.3997 | Train Acc: 0.8949
 Site-MNIST                     (0) | Train Loss: 0.4924 | Train Acc: 0.8520
 Site-USPS                      (1) | Train Loss: 0.4629 | Train Acc: 0.8679
 Site-USPS                      (1) | Train Loss: 0.4925 | Train Acc: 0.8717
 Site-SynthDigits               (1) | Train Loss: 0.7312 | Train Acc: 0.7790
 Site-SynthDigits               (1) | Train Loss: 0.6590 | Train Acc: 0.8099
 Site-MNIST_M                   (2) | Train Loss: 1.0001 | Train Acc: 0.6792
 Site-MNIST_M                   (2) | Train Loss: 0.9961 | Train Acc: 0.7049
 Site-SVHN                      (3) | Train Loss: 1.1884 | Train Acc: 0.5957
 Site-SVHN                      (3) | Train Loss: 1.0909 | Train Acc: 0.6502
Average Train Accuracy: 0.7706
 Site-MNIST                     (0) | Val  Loss: 0.4023 | Val  Acc: 0.8478
 Site-MNIST                     (0) | Val  Loss: 0.4750 | Val  Acc: 0.8633
 Site-USPS                      (1) | Val  Loss: 0.5869 | Val  Acc: 0.8043
 Site-USPS                      (1) | Val  Loss: 0.5449 | Val  Acc: 0.8381
 Site-SynthDigits               (1) | Val  Loss: 0.6963 | Val  Acc: 0.7391
 Site-SynthDigits               (1) | Val  Loss: 0.6898 | Val  Acc: 0.7482
 Site-MNIST_M                   (2) | Val  Loss: 1.0646 | Val  Acc: 0.6413
 Site-MNIST_M                   (2) | Val  Loss: 0.9725 | Val  Acc: 0.7014
 Site-SVHN                      (3) | Val  Loss: 1.1202 | Val  Acc: 0.5978
 Site-SVHN                      (3) | Val  Loss: 1.1455 | Val  Acc: 0.6295
Average Valid Accuracy: 0.7411
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.8478
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.8633
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.8043
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.8381
 Best site-SynthDigits              (1)  | Epoch:11 | Val Acc: 0.7391
 Best site-SynthDigits              (1)  | Epoch:11 | Val Acc: 0.7482
 Best site-MNIST_M                  (2)  | Epoch:11 | Val Acc: 0.6413
 Best site-MNIST_M                  (2)  | Epoch:11 | Val Acc: 0.7014
 Best site-SVHN                     (3)  | Epoch:11 | Val Acc: 0.5978
 Best site-SVHN                     (3)  | Epoch:11 | Val Acc: 0.6295
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 4, 2, 2, ]
cnt=[2, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (2) | Train Loss: 0.3760 | Train Acc: 0.8949
 Site-MNIST                     (2) | Train Loss: 0.4610 | Train Acc: 0.8565
 Site-USPS                      (1) | Train Loss: 0.4646 | Train Acc: 0.8571
 Site-USPS                      (1) | Train Loss: 0.4840 | Train Acc: 0.8601
 Site-SynthDigits               (1) | Train Loss: 0.6781 | Train Acc: 0.8086
 Site-SynthDigits               (1) | Train Loss: 0.6013 | Train Acc: 0.8152
 Site-MNIST_M                   (0) | Train Loss: 0.9626 | Train Acc: 0.6981
 Site-MNIST_M                   (0) | Train Loss: 0.9392 | Train Acc: 0.7291
 Site-SVHN                      (3) | Train Loss: 1.1332 | Train Acc: 0.6038
 Site-SVHN                      (3) | Train Loss: 1.0494 | Train Acc: 0.6556
Average Train Accuracy: 0.7779
 Site-MNIST                     (2) | Val  Loss: 0.3818 | Val  Acc: 0.8478
 Site-MNIST                     (2) | Val  Loss: 0.4556 | Val  Acc: 0.8561
 Site-USPS                      (1) | Val  Loss: 0.5846 | Val  Acc: 0.8043
 Site-USPS                      (1) | Val  Loss: 0.5430 | Val  Acc: 0.8453
 Site-SynthDigits               (1) | Val  Loss: 0.6390 | Val  Acc: 0.7717
 Site-SynthDigits               (1) | Val  Loss: 0.6432 | Val  Acc: 0.7842
 Site-MNIST_M                   (0) | Val  Loss: 1.0228 | Val  Acc: 0.6413
 Site-MNIST_M                   (0) | Val  Loss: 0.9251 | Val  Acc: 0.7122
 Site-SVHN                      (3) | Val  Loss: 1.0966 | Val  Acc: 0.5870
 Site-SVHN                      (3) | Val  Loss: 1.1025 | Val  Acc: 0.6439
Average Valid Accuracy: 0.7494
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.8478
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.8561
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.8043
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.8453
 Best site-SynthDigits              (1)  | Epoch:12 | Val Acc: 0.7717
 Best site-SynthDigits              (1)  | Epoch:12 | Val Acc: 0.7842
 Best site-MNIST_M                  (0)  | Epoch:12 | Val Acc: 0.6413
 Best site-MNIST_M                  (0)  | Epoch:12 | Val Acc: 0.7122
 Best site-SVHN                     (3)  | Epoch:12 | Val Acc: 0.5870
 Best site-SVHN                     (3)  | Epoch:12 | Val Acc: 0.6439
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 2, 4, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (3) | Train Loss: 0.3499 | Train Acc: 0.8976
 Site-MNIST                     (3) | Train Loss: 0.4324 | Train Acc: 0.8717
 Site-USPS                      (2) | Train Loss: 0.4264 | Train Acc: 0.8706
 Site-USPS                      (2) | Train Loss: 0.4418 | Train Acc: 0.8717
 Site-SynthDigits               (2) | Train Loss: 0.6599 | Train Acc: 0.8194
 Site-SynthDigits               (2) | Train Loss: 0.5844 | Train Acc: 0.8251
 Site-MNIST_M                   (1) | Train Loss: 0.9087 | Train Acc: 0.7251
 Site-MNIST_M                   (1) | Train Loss: 0.8973 | Train Acc: 0.7435
 Site-SVHN                      (0) | Train Loss: 1.1301 | Train Acc: 0.6065
 Site-SVHN                      (0) | Train Loss: 1.0299 | Train Acc: 0.6664
Average Train Accuracy: 0.7898
 Site-MNIST                     (3) | Val  Loss: 0.3447 | Val  Acc: 0.8587
 Site-MNIST                     (3) | Val  Loss: 0.4242 | Val  Acc: 0.8813
 Site-USPS                      (2) | Val  Loss: 0.5552 | Val  Acc: 0.8152
 Site-USPS                      (2) | Val  Loss: 0.5059 | Val  Acc: 0.8417
 Site-SynthDigits               (2) | Val  Loss: 0.6289 | Val  Acc: 0.7609
 Site-SynthDigits               (2) | Val  Loss: 0.6242 | Val  Acc: 0.7806
 Site-MNIST_M                   (1) | Val  Loss: 0.9694 | Val  Acc: 0.6957
 Site-MNIST_M                   (1) | Val  Loss: 0.8753 | Val  Acc: 0.7482
 Site-SVHN                      (0) | Val  Loss: 1.0641 | Val  Acc: 0.6413
 Site-SVHN                      (0) | Val  Loss: 1.0866 | Val  Acc: 0.6619
Average Valid Accuracy: 0.7685
 Best site-MNIST                    (3)  | Epoch:13 | Val Acc: 0.8587
 Best site-MNIST                    (3)  | Epoch:13 | Val Acc: 0.8813
 Best site-USPS                     (2)  | Epoch:13 | Val Acc: 0.8152
 Best site-USPS                     (2)  | Epoch:13 | Val Acc: 0.8417
 Best site-SynthDigits              (2)  | Epoch:13 | Val Acc: 0.7609
 Best site-SynthDigits              (2)  | Epoch:13 | Val Acc: 0.7806
 Best site-MNIST_M                  (1)  | Epoch:13 | Val Acc: 0.6957
 Best site-MNIST_M                  (1)  | Epoch:13 | Val Acc: 0.7482
 Best site-SVHN                     (0)  | Epoch:13 | Val Acc: 0.6413
 Best site-SVHN                     (0)  | Epoch:13 | Val Acc: 0.6619
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 2, 2, 4, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (1) | Train Loss: 0.3251 | Train Acc: 0.9003
 Site-MNIST                     (1) | Train Loss: 0.4049 | Train Acc: 0.8843
 Site-USPS                      (3) | Train Loss: 0.4231 | Train Acc: 0.8706
 Site-USPS                      (3) | Train Loss: 0.4376 | Train Acc: 0.8717
 Site-SynthDigits               (3) | Train Loss: 0.6239 | Train Acc: 0.8302
 Site-SynthDigits               (3) | Train Loss: 0.5545 | Train Acc: 0.8493
 Site-MNIST_M                   (2) | Train Loss: 0.8778 | Train Acc: 0.7305
 Site-MNIST_M                   (2) | Train Loss: 0.8596 | Train Acc: 0.7614
 Site-SVHN                      (0) | Train Loss: 1.0737 | Train Acc: 0.6334
 Site-SVHN                      (0) | Train Loss: 0.9881 | Train Acc: 0.6852
Average Train Accuracy: 0.8017
 Site-MNIST                     (1) | Val  Loss: 0.3230 | Val  Acc: 0.8804
 Site-MNIST                     (1) | Val  Loss: 0.4012 | Val  Acc: 0.8885
 Site-USPS                      (3) | Val  Loss: 0.5527 | Val  Acc: 0.8043
 Site-USPS                      (3) | Val  Loss: 0.4976 | Val  Acc: 0.8345
 Site-SynthDigits               (3) | Val  Loss: 0.5919 | Val  Acc: 0.8152
 Site-SynthDigits               (3) | Val  Loss: 0.5858 | Val  Acc: 0.8058
 Site-MNIST_M                   (2) | Val  Loss: 0.9233 | Val  Acc: 0.7065
 Site-MNIST_M                   (2) | Val  Loss: 0.8325 | Val  Acc: 0.7626
 Site-SVHN                      (0) | Val  Loss: 1.0289 | Val  Acc: 0.6630
 Site-SVHN                      (0) | Val  Loss: 1.0409 | Val  Acc: 0.6871
Average Valid Accuracy: 0.7848
 Best site-MNIST                    (1)  | Epoch:14 | Val Acc: 0.8804
 Best site-MNIST                    (1)  | Epoch:14 | Val Acc: 0.8885
 Best site-USPS                     (3)  | Epoch:14 | Val Acc: 0.8043
 Best site-USPS                     (3)  | Epoch:14 | Val Acc: 0.8345
 Best site-SynthDigits              (3)  | Epoch:14 | Val Acc: 0.8152
 Best site-SynthDigits              (3)  | Epoch:14 | Val Acc: 0.8058
 Best site-MNIST_M                  (2)  | Epoch:14 | Val Acc: 0.7065
 Best site-MNIST_M                  (2)  | Epoch:14 | Val Acc: 0.7626
 Best site-SVHN                     (0)  | Epoch:14 | Val Acc: 0.6630
 Best site-SVHN                     (0)  | Epoch:14 | Val Acc: 0.6871
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 4, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (2) | Train Loss: 0.3196 | Train Acc: 0.9084
 Site-MNIST                     (2) | Train Loss: 0.3952 | Train Acc: 0.8834
 Site-USPS                      (1) | Train Loss: 0.4229 | Train Acc: 0.8706
 Site-USPS                      (1) | Train Loss: 0.4317 | Train Acc: 0.8709
 Site-SynthDigits               (1) | Train Loss: 0.5944 | Train Acc: 0.8275
 Site-SynthDigits               (1) | Train Loss: 0.5359 | Train Acc: 0.8493
 Site-MNIST_M                   (0) | Train Loss: 0.8292 | Train Acc: 0.7493
 Site-MNIST_M                   (0) | Train Loss: 0.8091 | Train Acc: 0.7713
 Site-SVHN                      (3) | Train Loss: 1.0573 | Train Acc: 0.6361
 Site-SVHN                      (3) | Train Loss: 0.9854 | Train Acc: 0.6735
Average Train Accuracy: 0.8040
 Site-MNIST                     (2) | Val  Loss: 0.3135 | Val  Acc: 0.8913
 Site-MNIST                     (2) | Val  Loss: 0.3913 | Val  Acc: 0.8957
 Site-USPS                      (1) | Val  Loss: 0.5369 | Val  Acc: 0.8043
 Site-USPS                      (1) | Val  Loss: 0.4889 | Val  Acc: 0.8453
 Site-SynthDigits               (1) | Val  Loss: 0.5623 | Val  Acc: 0.8152
 Site-SynthDigits               (1) | Val  Loss: 0.5667 | Val  Acc: 0.8094
 Site-MNIST_M                   (0) | Val  Loss: 0.8887 | Val  Acc: 0.6957
 Site-MNIST_M                   (0) | Val  Loss: 0.7875 | Val  Acc: 0.7770
 Site-SVHN                      (3) | Val  Loss: 1.0373 | Val  Acc: 0.6630
 Site-SVHN                      (3) | Val  Loss: 1.0263 | Val  Acc: 0.6763
Average Valid Accuracy: 0.7873
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8913
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8957
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.8043
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.8453
 Best site-SynthDigits              (1)  | Epoch:15 | Val Acc: 0.8152
 Best site-SynthDigits              (1)  | Epoch:15 | Val Acc: 0.8094
 Best site-MNIST_M                  (0)  | Epoch:15 | Val Acc: 0.6957
 Best site-MNIST_M                  (0)  | Epoch:15 | Val Acc: 0.7770
 Best site-SVHN                     (3)  | Epoch:15 | Val Acc: 0.6630
 Best site-SVHN                     (3)  | Epoch:15 | Val Acc: 0.6763
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 16 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (2) | Train Loss: 0.3052 | Train Acc: 0.9057
 Site-MNIST                     (2) | Train Loss: 0.3852 | Train Acc: 0.8870
 Site-USPS                      (0) | Train Loss: 0.4022 | Train Acc: 0.8706
 Site-USPS                      (0) | Train Loss: 0.4187 | Train Acc: 0.8825
 Site-SynthDigits               (0) | Train Loss: 0.5848 | Train Acc: 0.8329
 Site-SynthDigits               (0) | Train Loss: 0.5278 | Train Acc: 0.8547
 Site-MNIST_M                   (1) | Train Loss: 0.8207 | Train Acc: 0.7385
 Site-MNIST_M                   (1) | Train Loss: 0.7912 | Train Acc: 0.7812
 Site-SVHN                      (3) | Train Loss: 1.0187 | Train Acc: 0.6550
 Site-SVHN                      (3) | Train Loss: 0.9216 | Train Acc: 0.7103
Average Train Accuracy: 0.8118
 Site-MNIST                     (2) | Val  Loss: 0.2981 | Val  Acc: 0.9022
 Site-MNIST                     (2) | Val  Loss: 0.3782 | Val  Acc: 0.8885
 Site-USPS                      (0) | Val  Loss: 0.5265 | Val  Acc: 0.8043
 Site-USPS                      (0) | Val  Loss: 0.4677 | Val  Acc: 0.8381
 Site-SynthDigits               (0) | Val  Loss: 0.5598 | Val  Acc: 0.8370
 Site-SynthDigits               (0) | Val  Loss: 0.5526 | Val  Acc: 0.8201
 Site-MNIST_M                   (1) | Val  Loss: 0.8659 | Val  Acc: 0.7283
 Site-MNIST_M                   (1) | Val  Loss: 0.7732 | Val  Acc: 0.7662
 Site-SVHN                      (3) | Val  Loss: 0.9566 | Val  Acc: 0.7283
 Site-SVHN                      (3) | Val  Loss: 0.9713 | Val  Acc: 0.7158
Average Valid Accuracy: 0.8029
 Best site-MNIST                    (2)  | Epoch:16 | Val Acc: 0.9022
 Best site-MNIST                    (2)  | Epoch:16 | Val Acc: 0.8885
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.8043
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.8381
 Best site-SynthDigits              (0)  | Epoch:16 | Val Acc: 0.8370
 Best site-SynthDigits              (0)  | Epoch:16 | Val Acc: 0.8201
 Best site-MNIST_M                  (1)  | Epoch:16 | Val Acc: 0.7283
 Best site-MNIST_M                  (1)  | Epoch:16 | Val Acc: 0.7662
 Best site-SVHN                     (3)  | Epoch:16 | Val Acc: 0.7283
 Best site-SVHN                     (3)  | Epoch:16 | Val Acc: 0.7158
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 17 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (2) | Train Loss: 0.2890 | Train Acc: 0.9084
 Site-MNIST                     (2) | Train Loss: 0.3629 | Train Acc: 0.8942
 Site-USPS                      (0) | Train Loss: 0.3734 | Train Acc: 0.8760
 Site-USPS                      (0) | Train Loss: 0.3902 | Train Acc: 0.8861
 Site-SynthDigits               (0) | Train Loss: 0.5807 | Train Acc: 0.8302
 Site-SynthDigits               (0) | Train Loss: 0.5238 | Train Acc: 0.8547
 Site-MNIST_M                   (1) | Train Loss: 0.7846 | Train Acc: 0.7439
 Site-MNIST_M                   (1) | Train Loss: 0.7569 | Train Acc: 0.7865
 Site-SVHN                      (3) | Train Loss: 1.0062 | Train Acc: 0.6523
 Site-SVHN                      (3) | Train Loss: 0.8959 | Train Acc: 0.7067
Average Train Accuracy: 0.8139
 Site-MNIST                     (2) | Val  Loss: 0.2846 | Val  Acc: 0.8913
 Site-MNIST                     (2) | Val  Loss: 0.3641 | Val  Acc: 0.8921
 Site-USPS                      (0) | Val  Loss: 0.5067 | Val  Acc: 0.8152
 Site-USPS                      (0) | Val  Loss: 0.4465 | Val  Acc: 0.8489
 Site-SynthDigits               (0) | Val  Loss: 0.5588 | Val  Acc: 0.8261
 Site-SynthDigits               (0) | Val  Loss: 0.5485 | Val  Acc: 0.8129
 Site-MNIST_M                   (1) | Val  Loss: 0.8371 | Val  Acc: 0.7391
 Site-MNIST_M                   (1) | Val  Loss: 0.7515 | Val  Acc: 0.7770
 Site-SVHN                      (3) | Val  Loss: 0.9321 | Val  Acc: 0.7391
 Site-SVHN                      (3) | Val  Loss: 0.9479 | Val  Acc: 0.7014
Average Valid Accuracy: 0.8043
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.8913
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.8921
 Best site-USPS                     (0)  | Epoch:17 | Val Acc: 0.8152
 Best site-USPS                     (0)  | Epoch:17 | Val Acc: 0.8489
 Best site-SynthDigits              (0)  | Epoch:17 | Val Acc: 0.8261
 Best site-SynthDigits              (0)  | Epoch:17 | Val Acc: 0.8129
 Best site-MNIST_M                  (1)  | Epoch:17 | Val Acc: 0.7391
 Best site-MNIST_M                  (1)  | Epoch:17 | Val Acc: 0.7770
 Best site-SVHN                     (3)  | Epoch:17 | Val Acc: 0.7391
 Best site-SVHN                     (3)  | Epoch:17 | Val Acc: 0.7014
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 18 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (0) | Train Loss: 0.2870 | Train Acc: 0.9084
 Site-MNIST                     (0) | Train Loss: 0.3568 | Train Acc: 0.8924
 Site-USPS                      (1) | Train Loss: 0.3789 | Train Acc: 0.8787
 Site-USPS                      (1) | Train Loss: 0.3800 | Train Acc: 0.8906
 Site-SynthDigits               (1) | Train Loss: 0.5486 | Train Acc: 0.8437
 Site-SynthDigits               (1) | Train Loss: 0.4927 | Train Acc: 0.8700
 Site-MNIST_M                   (2) | Train Loss: 0.7587 | Train Acc: 0.7628
 Site-MNIST_M                   (2) | Train Loss: 0.7194 | Train Acc: 0.8063
 Site-SVHN                      (3) | Train Loss: 0.9801 | Train Acc: 0.6658
 Site-SVHN                      (3) | Train Loss: 0.8905 | Train Acc: 0.7139
Average Train Accuracy: 0.8232
 Site-MNIST                     (0) | Val  Loss: 0.2770 | Val  Acc: 0.9022
 Site-MNIST                     (0) | Val  Loss: 0.3580 | Val  Acc: 0.9029
 Site-USPS                      (1) | Val  Loss: 0.4983 | Val  Acc: 0.8043
 Site-USPS                      (1) | Val  Loss: 0.4396 | Val  Acc: 0.8417
 Site-SynthDigits               (1) | Val  Loss: 0.5205 | Val  Acc: 0.8261
 Site-SynthDigits               (1) | Val  Loss: 0.5131 | Val  Acc: 0.8381
 Site-MNIST_M                   (2) | Val  Loss: 0.7969 | Val  Acc: 0.7717
 Site-MNIST_M                   (2) | Val  Loss: 0.7175 | Val  Acc: 0.7842
 Site-SVHN                      (3) | Val  Loss: 0.9254 | Val  Acc: 0.7500
 Site-SVHN                      (3) | Val  Loss: 0.9320 | Val  Acc: 0.7194
Average Valid Accuracy: 0.8141
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9022
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9029
 Best site-USPS                     (1)  | Epoch:18 | Val Acc: 0.8043
 Best site-USPS                     (1)  | Epoch:18 | Val Acc: 0.8417
 Best site-SynthDigits              (1)  | Epoch:18 | Val Acc: 0.8261
 Best site-SynthDigits              (1)  | Epoch:18 | Val Acc: 0.8381
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.7717
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.7842
 Best site-SVHN                     (3)  | Epoch:18 | Val Acc: 0.7500
 Best site-SVHN                     (3)  | Epoch:18 | Val Acc: 0.7194
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 4, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (2) | Train Loss: 0.2741 | Train Acc: 0.9111
 Site-MNIST                     (2) | Train Loss: 0.3507 | Train Acc: 0.8924
 Site-USPS                      (1) | Train Loss: 0.3647 | Train Acc: 0.8841
 Site-USPS                      (1) | Train Loss: 0.3801 | Train Acc: 0.8870
 Site-SynthDigits               (1) | Train Loss: 0.5415 | Train Acc: 0.8518
 Site-SynthDigits               (1) | Train Loss: 0.4927 | Train Acc: 0.8646
 Site-MNIST_M                   (0) | Train Loss: 0.7395 | Train Acc: 0.7601
 Site-MNIST_M                   (0) | Train Loss: 0.7136 | Train Acc: 0.8018
 Site-SVHN                      (3) | Train Loss: 0.9844 | Train Acc: 0.6685
 Site-SVHN                      (3) | Train Loss: 0.8866 | Train Acc: 0.7103
Average Train Accuracy: 0.8232
 Site-MNIST                     (2) | Val  Loss: 0.2756 | Val  Acc: 0.8913
 Site-MNIST                     (2) | Val  Loss: 0.3535 | Val  Acc: 0.8921
 Site-USPS                      (1) | Val  Loss: 0.4896 | Val  Acc: 0.7935
 Site-USPS                      (1) | Val  Loss: 0.4333 | Val  Acc: 0.8525
 Site-SynthDigits               (1) | Val  Loss: 0.5125 | Val  Acc: 0.8261
 Site-SynthDigits               (1) | Val  Loss: 0.5130 | Val  Acc: 0.8273
 Site-MNIST_M                   (0) | Val  Loss: 0.7806 | Val  Acc: 0.7391
 Site-MNIST_M                   (0) | Val  Loss: 0.6956 | Val  Acc: 0.8022
 Site-SVHN                      (3) | Val  Loss: 0.9101 | Val  Acc: 0.7283
 Site-SVHN                      (3) | Val  Loss: 0.9268 | Val  Acc: 0.7158
Average Valid Accuracy: 0.8068
============ Train epoch 20 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (2) | Train Loss: 0.2663 | Train Acc: 0.9164
 Site-MNIST                     (2) | Train Loss: 0.3432 | Train Acc: 0.8915
 Site-USPS                      (0) | Train Loss: 0.3585 | Train Acc: 0.8895
 Site-USPS                      (0) | Train Loss: 0.3586 | Train Acc: 0.8960
 Site-SynthDigits               (0) | Train Loss: 0.5356 | Train Acc: 0.8410
 Site-SynthDigits               (0) | Train Loss: 0.4838 | Train Acc: 0.8601
 Site-MNIST_M                   (1) | Train Loss: 0.7240 | Train Acc: 0.7655
 Site-MNIST_M                   (1) | Train Loss: 0.6925 | Train Acc: 0.8054
 Site-SVHN                      (3) | Train Loss: 0.9543 | Train Acc: 0.6712
 Site-SVHN                      (3) | Train Loss: 0.8454 | Train Acc: 0.7283
Average Train Accuracy: 0.8265
 Site-MNIST                     (2) | Val  Loss: 0.2675 | Val  Acc: 0.9022
 Site-MNIST                     (2) | Val  Loss: 0.3440 | Val  Acc: 0.8885
 Site-USPS                      (0) | Val  Loss: 0.4702 | Val  Acc: 0.8152
 Site-USPS                      (0) | Val  Loss: 0.4161 | Val  Acc: 0.8633
 Site-SynthDigits               (0) | Val  Loss: 0.5142 | Val  Acc: 0.8370
 Site-SynthDigits               (0) | Val  Loss: 0.5006 | Val  Acc: 0.8345
 Site-MNIST_M                   (1) | Val  Loss: 0.7745 | Val  Acc: 0.7391
 Site-MNIST_M                   (1) | Val  Loss: 0.6869 | Val  Acc: 0.7986
 Site-SVHN                      (3) | Val  Loss: 0.8706 | Val  Acc: 0.7391
 Site-SVHN                      (3) | Val  Loss: 0.8980 | Val  Acc: 0.7122
Average Valid Accuracy: 0.8130
============ Train epoch 21 ============
cnt=[2, 2, 2, 4, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (2) | Train Loss: 0.2587 | Train Acc: 0.9299
 Site-MNIST                     (2) | Train Loss: 0.3242 | Train Acc: 0.9022
 Site-USPS                      (1) | Train Loss: 0.3585 | Train Acc: 0.8868
 Site-USPS                      (1) | Train Loss: 0.3742 | Train Acc: 0.8906
 Site-SynthDigits               (3) | Train Loss: 0.4898 | Train Acc: 0.8598
 Site-SynthDigits               (3) | Train Loss: 0.4487 | Train Acc: 0.8807
 Site-MNIST_M                   (0) | Train Loss: 0.7081 | Train Acc: 0.7709
 Site-MNIST_M                   (0) | Train Loss: 0.6611 | Train Acc: 0.8161
 Site-SVHN                      (3) | Train Loss: 0.9533 | Train Acc: 0.6658
 Site-SVHN                      (3) | Train Loss: 0.8519 | Train Acc: 0.7238
Average Train Accuracy: 0.8327
 Site-MNIST                     (2) | Val  Loss: 0.2481 | Val  Acc: 0.9130
 Site-MNIST                     (2) | Val  Loss: 0.3329 | Val  Acc: 0.9245
 Site-USPS                      (1) | Val  Loss: 0.4775 | Val  Acc: 0.8261
 Site-USPS                      (1) | Val  Loss: 0.4223 | Val  Acc: 0.8633
 Site-SynthDigits               (3) | Val  Loss: 0.4661 | Val  Acc: 0.8370
 Site-SynthDigits               (3) | Val  Loss: 0.4625 | Val  Acc: 0.8525
 Site-MNIST_M                   (0) | Val  Loss: 0.7396 | Val  Acc: 0.7717
 Site-MNIST_M                   (0) | Val  Loss: 0.6557 | Val  Acc: 0.8094
 Site-SVHN                      (3) | Val  Loss: 0.8865 | Val  Acc: 0.7391
 Site-SVHN                      (3) | Val  Loss: 0.8969 | Val  Acc: 0.7086
Average Valid Accuracy: 0.8245
 Best site-MNIST                    (2)  | Epoch:21 | Val Acc: 0.9130
 Best site-MNIST                    (2)  | Epoch:21 | Val Acc: 0.9245
 Best site-USPS                     (1)  | Epoch:21 | Val Acc: 0.8261
 Best site-USPS                     (1)  | Epoch:21 | Val Acc: 0.8633
 Best site-SynthDigits              (3)  | Epoch:21 | Val Acc: 0.8370
 Best site-SynthDigits              (3)  | Epoch:21 | Val Acc: 0.8525
 Best site-MNIST_M                  (0)  | Epoch:21 | Val Acc: 0.7717
 Best site-MNIST_M                  (0)  | Epoch:21 | Val Acc: 0.8094
 Best site-SVHN                     (3)  | Epoch:21 | Val Acc: 0.7391
 Best site-SVHN                     (3)  | Epoch:21 | Val Acc: 0.7086
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 22 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (1) | Train Loss: 0.2604 | Train Acc: 0.9218
 Site-MNIST                     (1) | Train Loss: 0.3244 | Train Acc: 0.9004
 Site-USPS                      (0) | Train Loss: 0.3502 | Train Acc: 0.8895
 Site-USPS                      (0) | Train Loss: 0.3505 | Train Acc: 0.8924
 Site-SynthDigits               (0) | Train Loss: 0.4846 | Train Acc: 0.8652
 Site-SynthDigits               (0) | Train Loss: 0.4337 | Train Acc: 0.8825
 Site-MNIST_M                   (2) | Train Loss: 0.6917 | Train Acc: 0.7790
 Site-MNIST_M                   (2) | Train Loss: 0.6525 | Train Acc: 0.8188
 Site-SVHN                      (3) | Train Loss: 0.9441 | Train Acc: 0.6712
 Site-SVHN                      (3) | Train Loss: 0.8532 | Train Acc: 0.7229
Average Train Accuracy: 0.8344
 Site-MNIST                     (1) | Val  Loss: 0.2489 | Val  Acc: 0.9239
 Site-MNIST                     (1) | Val  Loss: 0.3294 | Val  Acc: 0.9137
 Site-USPS                      (0) | Val  Loss: 0.4534 | Val  Acc: 0.8043
 Site-USPS                      (0) | Val  Loss: 0.4026 | Val  Acc: 0.8525
 Site-SynthDigits               (0) | Val  Loss: 0.4542 | Val  Acc: 0.8261
 Site-SynthDigits               (0) | Val  Loss: 0.4560 | Val  Acc: 0.8453
 Site-MNIST_M                   (2) | Val  Loss: 0.7202 | Val  Acc: 0.7717
 Site-MNIST_M                   (2) | Val  Loss: 0.6419 | Val  Acc: 0.8273
 Site-SVHN                      (3) | Val  Loss: 0.8652 | Val  Acc: 0.7283
 Site-SVHN                      (3) | Val  Loss: 0.8890 | Val  Acc: 0.7194
Average Valid Accuracy: 0.8213
============ Train epoch 23 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (2) | Train Loss: 0.2441 | Train Acc: 0.9272
 Site-MNIST                     (2) | Train Loss: 0.3089 | Train Acc: 0.9121
 Site-USPS                      (0) | Train Loss: 0.3347 | Train Acc: 0.8949
 Site-USPS                      (0) | Train Loss: 0.3356 | Train Acc: 0.8978
 Site-SynthDigits               (0) | Train Loss: 0.4982 | Train Acc: 0.8625
 Site-SynthDigits               (0) | Train Loss: 0.4451 | Train Acc: 0.8789
 Site-MNIST_M                   (1) | Train Loss: 0.7026 | Train Acc: 0.7628
 Site-MNIST_M                   (1) | Train Loss: 0.6672 | Train Acc: 0.8072
 Site-SVHN                      (3) | Train Loss: 0.9236 | Train Acc: 0.6873
 Site-SVHN                      (3) | Train Loss: 0.7966 | Train Acc: 0.7462
Average Train Accuracy: 0.8377
 Site-MNIST                     (2) | Val  Loss: 0.2314 | Val  Acc: 0.9348
 Site-MNIST                     (2) | Val  Loss: 0.3167 | Val  Acc: 0.9281
 Site-USPS                      (0) | Val  Loss: 0.4449 | Val  Acc: 0.8152
 Site-USPS                      (0) | Val  Loss: 0.3883 | Val  Acc: 0.8597
 Site-SynthDigits               (0) | Val  Loss: 0.4674 | Val  Acc: 0.8370
 Site-SynthDigits               (0) | Val  Loss: 0.4579 | Val  Acc: 0.8453
 Site-MNIST_M                   (1) | Val  Loss: 0.7300 | Val  Acc: 0.7609
 Site-MNIST_M                   (1) | Val  Loss: 0.6557 | Val  Acc: 0.8094
 Site-SVHN                      (3) | Val  Loss: 0.8227 | Val  Acc: 0.7174
 Site-SVHN                      (3) | Val  Loss: 0.8516 | Val  Acc: 0.7266
Average Valid Accuracy: 0.8234
============ Train epoch 24 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (3) | Train Loss: 0.2419 | Train Acc: 0.9245
 Site-MNIST                     (3) | Train Loss: 0.3095 | Train Acc: 0.9085
 Site-USPS                      (0) | Train Loss: 0.3225 | Train Acc: 0.9111
 Site-USPS                      (0) | Train Loss: 0.3242 | Train Acc: 0.9058
 Site-SynthDigits               (0) | Train Loss: 0.4715 | Train Acc: 0.8733
 Site-SynthDigits               (0) | Train Loss: 0.4235 | Train Acc: 0.8879
 Site-MNIST_M                   (1) | Train Loss: 0.6757 | Train Acc: 0.7709
 Site-MNIST_M                   (1) | Train Loss: 0.6296 | Train Acc: 0.8233
 Site-SVHN                      (2) | Train Loss: 0.9299 | Train Acc: 0.6900
 Site-SVHN                      (2) | Train Loss: 0.7997 | Train Acc: 0.7345
Average Train Accuracy: 0.8430
 Site-MNIST                     (3) | Val  Loss: 0.2285 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.3081 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.4280 | Val  Acc: 0.8370
 Site-USPS                      (0) | Val  Loss: 0.3747 | Val  Acc: 0.8741
 Site-SynthDigits               (0) | Val  Loss: 0.4427 | Val  Acc: 0.8370
 Site-SynthDigits               (0) | Val  Loss: 0.4350 | Val  Acc: 0.8525
 Site-MNIST_M                   (1) | Val  Loss: 0.6972 | Val  Acc: 0.7717
 Site-MNIST_M                   (1) | Val  Loss: 0.6258 | Val  Acc: 0.8129
 Site-SVHN                      (2) | Val  Loss: 0.8377 | Val  Acc: 0.7174
 Site-SVHN                      (2) | Val  Loss: 0.8560 | Val  Acc: 0.7230
Average Valid Accuracy: 0.8292
 Best site-MNIST                    (3)  | Epoch:24 | Val Acc: 0.9348
 Best site-MNIST                    (3)  | Epoch:24 | Val Acc: 0.9317
 Best site-USPS                     (0)  | Epoch:24 | Val Acc: 0.8370
 Best site-USPS                     (0)  | Epoch:24 | Val Acc: 0.8741
 Best site-SynthDigits              (0)  | Epoch:24 | Val Acc: 0.8370
 Best site-SynthDigits              (0)  | Epoch:24 | Val Acc: 0.8525
 Best site-MNIST_M                  (1)  | Epoch:24 | Val Acc: 0.7717
 Best site-MNIST_M                  (1)  | Epoch:24 | Val Acc: 0.8129
 Best site-SVHN                     (2)  | Epoch:24 | Val Acc: 0.7174
 Best site-SVHN                     (2)  | Epoch:24 | Val Acc: 0.7230
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 25 ============
cnt=[4, 2, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (1) | Train Loss: 0.2332 | Train Acc: 0.9353
 Site-MNIST                     (1) | Train Loss: 0.2982 | Train Acc: 0.9103
 Site-USPS                      (0) | Train Loss: 0.3244 | Train Acc: 0.8895
 Site-USPS                      (0) | Train Loss: 0.3259 | Train Acc: 0.9067
 Site-SynthDigits               (0) | Train Loss: 0.4686 | Train Acc: 0.8625
 Site-SynthDigits               (0) | Train Loss: 0.4232 | Train Acc: 0.8825
 Site-MNIST_M                   (2) | Train Loss: 0.6687 | Train Acc: 0.7736
 Site-MNIST_M                   (2) | Train Loss: 0.6284 | Train Acc: 0.8179
 Site-SVHN                      (3) | Train Loss: 0.9047 | Train Acc: 0.6954
 Site-SVHN                      (3) | Train Loss: 0.7760 | Train Acc: 0.7525
Average Train Accuracy: 0.8426
 Site-MNIST                     (1) | Val  Loss: 0.2238 | Val  Acc: 0.9239
 Site-MNIST                     (1) | Val  Loss: 0.3010 | Val  Acc: 0.9173
 Site-USPS                      (0) | Val  Loss: 0.4308 | Val  Acc: 0.8370
 Site-USPS                      (0) | Val  Loss: 0.3737 | Val  Acc: 0.8705
 Site-SynthDigits               (0) | Val  Loss: 0.4460 | Val  Acc: 0.8478
 Site-SynthDigits               (0) | Val  Loss: 0.4382 | Val  Acc: 0.8453
 Site-MNIST_M                   (2) | Val  Loss: 0.6944 | Val  Acc: 0.7935
 Site-MNIST_M                   (2) | Val  Loss: 0.6179 | Val  Acc: 0.8129
 Site-SVHN                      (3) | Val  Loss: 0.8170 | Val  Acc: 0.7609
 Site-SVHN                      (3) | Val  Loss: 0.8354 | Val  Acc: 0.7374
Average Valid Accuracy: 0.8346
 Best site-MNIST                    (1)  | Epoch:25 | Val Acc: 0.9239
 Best site-MNIST                    (1)  | Epoch:25 | Val Acc: 0.9173
 Best site-USPS                     (0)  | Epoch:25 | Val Acc: 0.8370
 Best site-USPS                     (0)  | Epoch:25 | Val Acc: 0.8705
 Best site-SynthDigits              (0)  | Epoch:25 | Val Acc: 0.8478
 Best site-SynthDigits              (0)  | Epoch:25 | Val Acc: 0.8453
 Best site-MNIST_M                  (2)  | Epoch:25 | Val Acc: 0.7935
 Best site-MNIST_M                  (2)  | Epoch:25 | Val Acc: 0.8129
 Best site-SVHN                     (3)  | Epoch:25 | Val Acc: 0.7609
 Best site-SVHN                     (3)  | Epoch:25 | Val Acc: 0.7374
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 26 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (1) | Train Loss: 0.2341 | Train Acc: 0.9299
 Site-MNIST                     (1) | Train Loss: 0.2992 | Train Acc: 0.9130
 Site-USPS                      (0) | Train Loss: 0.3053 | Train Acc: 0.9111
 Site-USPS                      (0) | Train Loss: 0.3077 | Train Acc: 0.9112
 Site-SynthDigits               (0) | Train Loss: 0.4736 | Train Acc: 0.8652
 Site-SynthDigits               (0) | Train Loss: 0.4232 | Train Acc: 0.8870
 Site-MNIST_M                   (2) | Train Loss: 0.6626 | Train Acc: 0.7790
 Site-MNIST_M                   (2) | Train Loss: 0.6125 | Train Acc: 0.8233
 Site-SVHN                      (3) | Train Loss: 0.9062 | Train Acc: 0.6792
 Site-SVHN                      (3) | Train Loss: 0.7790 | Train Acc: 0.7552
Average Train Accuracy: 0.8454
 Site-MNIST                     (1) | Val  Loss: 0.2234 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.3010 | Val  Acc: 0.9245
 Site-USPS                      (0) | Val  Loss: 0.4173 | Val  Acc: 0.8370
 Site-USPS                      (0) | Val  Loss: 0.3560 | Val  Acc: 0.8741
 Site-SynthDigits               (0) | Val  Loss: 0.4382 | Val  Acc: 0.8478
 Site-SynthDigits               (0) | Val  Loss: 0.4332 | Val  Acc: 0.8633
 Site-MNIST_M                   (2) | Val  Loss: 0.6708 | Val  Acc: 0.7935
 Site-MNIST_M                   (2) | Val  Loss: 0.6047 | Val  Acc: 0.8129
 Site-SVHN                      (3) | Val  Loss: 0.8021 | Val  Acc: 0.7609
 Site-SVHN                      (3) | Val  Loss: 0.8266 | Val  Acc: 0.7338
Average Valid Accuracy: 0.8393
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.9457
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.9245
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.8370
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.8741
 Best site-SynthDigits              (0)  | Epoch:26 | Val Acc: 0.8478
 Best site-SynthDigits              (0)  | Epoch:26 | Val Acc: 0.8633
 Best site-MNIST_M                  (2)  | Epoch:26 | Val Acc: 0.7935
 Best site-MNIST_M                  (2)  | Epoch:26 | Val Acc: 0.8129
 Best site-SVHN                     (3)  | Epoch:26 | Val Acc: 0.7609
 Best site-SVHN                     (3)  | Epoch:26 | Val Acc: 0.7338
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 27 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (2) | Train Loss: 0.2398 | Train Acc: 0.9326
 Site-MNIST                     (2) | Train Loss: 0.2928 | Train Acc: 0.9130
 Site-USPS                      (1) | Train Loss: 0.3048 | Train Acc: 0.9003
 Site-USPS                      (1) | Train Loss: 0.3040 | Train Acc: 0.9121
 Site-SynthDigits               (1) | Train Loss: 0.4540 | Train Acc: 0.8652
 Site-SynthDigits               (1) | Train Loss: 0.4084 | Train Acc: 0.8906
 Site-MNIST_M                   (0) | Train Loss: 0.6519 | Train Acc: 0.7844
 Site-MNIST_M                   (0) | Train Loss: 0.6009 | Train Acc: 0.8332
 Site-SVHN                      (3) | Train Loss: 0.8999 | Train Acc: 0.7035
 Site-SVHN                      (3) | Train Loss: 0.7526 | Train Acc: 0.7713
Average Train Accuracy: 0.8506
 Site-MNIST                     (2) | Val  Loss: 0.2212 | Val  Acc: 0.9457
 Site-MNIST                     (2) | Val  Loss: 0.3011 | Val  Acc: 0.9281
 Site-USPS                      (1) | Val  Loss: 0.4087 | Val  Acc: 0.8370
 Site-USPS                      (1) | Val  Loss: 0.3521 | Val  Acc: 0.8705
 Site-SynthDigits               (1) | Val  Loss: 0.4302 | Val  Acc: 0.8587
 Site-SynthDigits               (1) | Val  Loss: 0.4163 | Val  Acc: 0.8597
 Site-MNIST_M                   (0) | Val  Loss: 0.6770 | Val  Acc: 0.7935
 Site-MNIST_M                   (0) | Val  Loss: 0.6017 | Val  Acc: 0.8165
 Site-SVHN                      (3) | Val  Loss: 0.7830 | Val  Acc: 0.7935
 Site-SVHN                      (3) | Val  Loss: 0.8087 | Val  Acc: 0.7554
Average Valid Accuracy: 0.8458
 Best site-MNIST                    (2)  | Epoch:27 | Val Acc: 0.9457
 Best site-MNIST                    (2)  | Epoch:27 | Val Acc: 0.9281
 Best site-USPS                     (1)  | Epoch:27 | Val Acc: 0.8370
 Best site-USPS                     (1)  | Epoch:27 | Val Acc: 0.8705
 Best site-SynthDigits              (1)  | Epoch:27 | Val Acc: 0.8587
 Best site-SynthDigits              (1)  | Epoch:27 | Val Acc: 0.8597
 Best site-MNIST_M                  (0)  | Epoch:27 | Val Acc: 0.7935
 Best site-MNIST_M                  (0)  | Epoch:27 | Val Acc: 0.8165
 Best site-SVHN                     (3)  | Epoch:27 | Val Acc: 0.7935
 Best site-SVHN                     (3)  | Epoch:27 | Val Acc: 0.7554
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 28 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (2) | Train Loss: 0.2367 | Train Acc: 0.9299
 Site-MNIST                     (2) | Train Loss: 0.2980 | Train Acc: 0.9121
 Site-USPS                      (1) | Train Loss: 0.3059 | Train Acc: 0.9003
 Site-USPS                      (1) | Train Loss: 0.3080 | Train Acc: 0.9130
 Site-SynthDigits               (1) | Train Loss: 0.4290 | Train Acc: 0.8760
 Site-SynthDigits               (1) | Train Loss: 0.3847 | Train Acc: 0.8978
 Site-MNIST_M                   (0) | Train Loss: 0.6361 | Train Acc: 0.7925
 Site-MNIST_M                   (0) | Train Loss: 0.5827 | Train Acc: 0.8368
 Site-SVHN                      (3) | Train Loss: 0.8858 | Train Acc: 0.7062
 Site-SVHN                      (3) | Train Loss: 0.7577 | Train Acc: 0.7668
Average Train Accuracy: 0.8531
 Site-MNIST                     (2) | Val  Loss: 0.2223 | Val  Acc: 0.9239
 Site-MNIST                     (2) | Val  Loss: 0.3074 | Val  Acc: 0.9209
 Site-USPS                      (1) | Val  Loss: 0.4172 | Val  Acc: 0.8478
 Site-USPS                      (1) | Val  Loss: 0.3621 | Val  Acc: 0.8777
 Site-SynthDigits               (1) | Val  Loss: 0.3987 | Val  Acc: 0.8696
 Site-SynthDigits               (1) | Val  Loss: 0.4001 | Val  Acc: 0.8705
 Site-MNIST_M                   (0) | Val  Loss: 0.6550 | Val  Acc: 0.8152
 Site-MNIST_M                   (0) | Val  Loss: 0.5908 | Val  Acc: 0.8165
 Site-SVHN                      (3) | Val  Loss: 0.7934 | Val  Acc: 0.7935
 Site-SVHN                      (3) | Val  Loss: 0.8019 | Val  Acc: 0.7554
Average Valid Accuracy: 0.8491
 Best site-MNIST                    (2)  | Epoch:28 | Val Acc: 0.9239
 Best site-MNIST                    (2)  | Epoch:28 | Val Acc: 0.9209
 Best site-USPS                     (1)  | Epoch:28 | Val Acc: 0.8478
 Best site-USPS                     (1)  | Epoch:28 | Val Acc: 0.8777
 Best site-SynthDigits              (1)  | Epoch:28 | Val Acc: 0.8696
 Best site-SynthDigits              (1)  | Epoch:28 | Val Acc: 0.8705
 Best site-MNIST_M                  (0)  | Epoch:28 | Val Acc: 0.8152
 Best site-MNIST_M                  (0)  | Epoch:28 | Val Acc: 0.8165
 Best site-SVHN                     (3)  | Epoch:28 | Val Acc: 0.7935
 Best site-SVHN                     (3)  | Epoch:28 | Val Acc: 0.7554
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 29 ============
cnt=[4, 2, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (2) | Train Loss: 0.2325 | Train Acc: 0.9407
 Site-MNIST                     (2) | Train Loss: 0.2906 | Train Acc: 0.9112
 Site-USPS                      (0) | Train Loss: 0.3040 | Train Acc: 0.8949
 Site-USPS                      (0) | Train Loss: 0.2929 | Train Acc: 0.9112
 Site-SynthDigits               (0) | Train Loss: 0.4431 | Train Acc: 0.8625
 Site-SynthDigits               (0) | Train Loss: 0.3938 | Train Acc: 0.8897
 Site-MNIST_M                   (1) | Train Loss: 0.6278 | Train Acc: 0.7951
 Site-MNIST_M                   (1) | Train Loss: 0.5781 | Train Acc: 0.8305
 Site-SVHN                      (3) | Train Loss: 0.8726 | Train Acc: 0.7062
 Site-SVHN                      (3) | Train Loss: 0.7456 | Train Acc: 0.7740
Average Train Accuracy: 0.8516
 Site-MNIST                     (2) | Val  Loss: 0.2234 | Val  Acc: 0.9348
 Site-MNIST                     (2) | Val  Loss: 0.3018 | Val  Acc: 0.9173
 Site-USPS                      (0) | Val  Loss: 0.4010 | Val  Acc: 0.8587
 Site-USPS                      (0) | Val  Loss: 0.3443 | Val  Acc: 0.8777
 Site-SynthDigits               (0) | Val  Loss: 0.4202 | Val  Acc: 0.8478
 Site-SynthDigits               (0) | Val  Loss: 0.4056 | Val  Acc: 0.8597
 Site-MNIST_M                   (1) | Val  Loss: 0.6467 | Val  Acc: 0.8152
 Site-MNIST_M                   (1) | Val  Loss: 0.5745 | Val  Acc: 0.8273
 Site-SVHN                      (3) | Val  Loss: 0.7689 | Val  Acc: 0.7717
 Site-SVHN                      (3) | Val  Loss: 0.7920 | Val  Acc: 0.7698
Average Valid Accuracy: 0.8480
============ Train epoch 30 ============
cnt=[2, 2, 2, 4, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (1) | Train Loss: 0.2313 | Train Acc: 0.9353
 Site-MNIST                     (1) | Train Loss: 0.2854 | Train Acc: 0.9157
 Site-USPS                      (3) | Train Loss: 0.2878 | Train Acc: 0.9057
 Site-USPS                      (3) | Train Loss: 0.2896 | Train Acc: 0.9130
 Site-SynthDigits               (3) | Train Loss: 0.4447 | Train Acc: 0.8598
 Site-SynthDigits               (3) | Train Loss: 0.3904 | Train Acc: 0.8969
 Site-MNIST_M                   (2) | Train Loss: 0.6266 | Train Acc: 0.7951
 Site-MNIST_M                   (2) | Train Loss: 0.5844 | Train Acc: 0.8395
 Site-SVHN                      (0) | Train Loss: 0.8704 | Train Acc: 0.7008
 Site-SVHN                      (0) | Train Loss: 0.7347 | Train Acc: 0.7767
Average Train Accuracy: 0.8538
 Site-MNIST                     (1) | Val  Loss: 0.2205 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.2998 | Val  Acc: 0.9245
 Site-USPS                      (3) | Val  Loss: 0.3869 | Val  Acc: 0.8587
 Site-USPS                      (3) | Val  Loss: 0.3331 | Val  Acc: 0.8849
 Site-SynthDigits               (3) | Val  Loss: 0.4169 | Val  Acc: 0.8696
 Site-SynthDigits               (3) | Val  Loss: 0.4016 | Val  Acc: 0.8705
 Site-MNIST_M                   (2) | Val  Loss: 0.6387 | Val  Acc: 0.8370
 Site-MNIST_M                   (2) | Val  Loss: 0.5745 | Val  Acc: 0.8309
 Site-SVHN                      (0) | Val  Loss: 0.7576 | Val  Acc: 0.7609
 Site-SVHN                      (0) | Val  Loss: 0.7832 | Val  Acc: 0.7590
Average Valid Accuracy: 0.8542
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9457
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9245
 Best site-USPS                     (3)  | Epoch:30 | Val Acc: 0.8587
 Best site-USPS                     (3)  | Epoch:30 | Val Acc: 0.8849
 Best site-SynthDigits              (3)  | Epoch:30 | Val Acc: 0.8696
 Best site-SynthDigits              (3)  | Epoch:30 | Val Acc: 0.8705
 Best site-MNIST_M                  (2)  | Epoch:30 | Val Acc: 0.8370
 Best site-MNIST_M                  (2)  | Epoch:30 | Val Acc: 0.8309
 Best site-SVHN                     (0)  | Epoch:30 | Val Acc: 0.7609
 Best site-SVHN                     (0)  | Epoch:30 | Val Acc: 0.7590
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 31 ============
cnt=[2, 2, 2, 4, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (1) | Train Loss: 0.2178 | Train Acc: 0.9407
 Site-MNIST                     (1) | Train Loss: 0.2781 | Train Acc: 0.9184
 Site-USPS                      (3) | Train Loss: 0.2881 | Train Acc: 0.9164
 Site-USPS                      (3) | Train Loss: 0.2784 | Train Acc: 0.9130
 Site-SynthDigits               (3) | Train Loss: 0.4393 | Train Acc: 0.8652
 Site-SynthDigits               (3) | Train Loss: 0.3857 | Train Acc: 0.8987
 Site-MNIST_M                   (2) | Train Loss: 0.6172 | Train Acc: 0.8059
 Site-MNIST_M                   (2) | Train Loss: 0.5613 | Train Acc: 0.8404
 Site-SVHN                      (0) | Train Loss: 0.8572 | Train Acc: 0.7116
 Site-SVHN                      (0) | Train Loss: 0.7246 | Train Acc: 0.7758
Average Train Accuracy: 0.8586
 Site-MNIST                     (1) | Val  Loss: 0.2008 | Val  Acc: 0.9348
 Site-MNIST                     (1) | Val  Loss: 0.2807 | Val  Acc: 0.9281
 Site-USPS                      (3) | Val  Loss: 0.3801 | Val  Acc: 0.8478
 Site-USPS                      (3) | Val  Loss: 0.3238 | Val  Acc: 0.8849
 Site-SynthDigits               (3) | Val  Loss: 0.4098 | Val  Acc: 0.8587
 Site-SynthDigits               (3) | Val  Loss: 0.3967 | Val  Acc: 0.8669
 Site-MNIST_M                   (2) | Val  Loss: 0.6187 | Val  Acc: 0.8370
 Site-MNIST_M                   (2) | Val  Loss: 0.5612 | Val  Acc: 0.8345
 Site-SVHN                      (0) | Val  Loss: 0.7578 | Val  Acc: 0.7717
 Site-SVHN                      (0) | Val  Loss: 0.7753 | Val  Acc: 0.7626
Average Valid Accuracy: 0.8527
============ Train epoch 32 ============
cnt=[2, 2, 2, 4, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (0) | Train Loss: 0.2154 | Train Acc: 0.9353
 Site-MNIST                     (0) | Train Loss: 0.2606 | Train Acc: 0.9247
 Site-USPS                      (3) | Train Loss: 0.2847 | Train Acc: 0.9137
 Site-USPS                      (3) | Train Loss: 0.2824 | Train Acc: 0.9184
 Site-SynthDigits               (3) | Train Loss: 0.4218 | Train Acc: 0.8706
 Site-SynthDigits               (3) | Train Loss: 0.3766 | Train Acc: 0.8969
 Site-MNIST_M                   (2) | Train Loss: 0.5928 | Train Acc: 0.8059
 Site-MNIST_M                   (2) | Train Loss: 0.5485 | Train Acc: 0.8457
 Site-SVHN                      (1) | Train Loss: 0.8490 | Train Acc: 0.7089
 Site-SVHN                      (1) | Train Loss: 0.7072 | Train Acc: 0.7803
Average Train Accuracy: 0.8600
 Site-MNIST                     (0) | Val  Loss: 0.1907 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2720 | Val  Acc: 0.9281
 Site-USPS                      (3) | Val  Loss: 0.3817 | Val  Acc: 0.8587
 Site-USPS                      (3) | Val  Loss: 0.3221 | Val  Acc: 0.8921
 Site-SynthDigits               (3) | Val  Loss: 0.4065 | Val  Acc: 0.8696
 Site-SynthDigits               (3) | Val  Loss: 0.3854 | Val  Acc: 0.8705
 Site-MNIST_M                   (2) | Val  Loss: 0.6029 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.5475 | Val  Acc: 0.8345
 Site-SVHN                      (1) | Val  Loss: 0.7448 | Val  Acc: 0.7935
 Site-SVHN                      (1) | Val  Loss: 0.7601 | Val  Acc: 0.7662
Average Valid Accuracy: 0.8617
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9457
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9281
 Best site-USPS                     (3)  | Epoch:32 | Val Acc: 0.8587
 Best site-USPS                     (3)  | Epoch:32 | Val Acc: 0.8921
 Best site-SynthDigits              (3)  | Epoch:32 | Val Acc: 0.8696
 Best site-SynthDigits              (3)  | Epoch:32 | Val Acc: 0.8705
 Best site-MNIST_M                  (2)  | Epoch:32 | Val Acc: 0.8587
 Best site-MNIST_M                  (2)  | Epoch:32 | Val Acc: 0.8345
 Best site-SVHN                     (1)  | Epoch:32 | Val Acc: 0.7935
 Best site-SVHN                     (1)  | Epoch:32 | Val Acc: 0.7662
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 33 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (2) | Train Loss: 0.2111 | Train Acc: 0.9434
 Site-MNIST                     (2) | Train Loss: 0.2641 | Train Acc: 0.9211
 Site-USPS                      (0) | Train Loss: 0.2777 | Train Acc: 0.9164
 Site-USPS                      (0) | Train Loss: 0.2697 | Train Acc: 0.9175
 Site-SynthDigits               (0) | Train Loss: 0.4235 | Train Acc: 0.8679
 Site-SynthDigits               (0) | Train Loss: 0.3758 | Train Acc: 0.8942
 Site-MNIST_M                   (1) | Train Loss: 0.5886 | Train Acc: 0.8086
 Site-MNIST_M                   (1) | Train Loss: 0.5453 | Train Acc: 0.8448
 Site-SVHN                      (3) | Train Loss: 0.8316 | Train Acc: 0.7143
 Site-SVHN                      (3) | Train Loss: 0.6962 | Train Acc: 0.7883
Average Train Accuracy: 0.8617
 Site-MNIST                     (2) | Val  Loss: 0.1905 | Val  Acc: 0.9348
 Site-MNIST                     (2) | Val  Loss: 0.2734 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.3772 | Val  Acc: 0.8696
 Site-USPS                      (0) | Val  Loss: 0.3179 | Val  Acc: 0.8957
 Site-SynthDigits               (0) | Val  Loss: 0.4033 | Val  Acc: 0.8587
 Site-SynthDigits               (0) | Val  Loss: 0.3887 | Val  Acc: 0.8669
 Site-MNIST_M                   (1) | Val  Loss: 0.6073 | Val  Acc: 0.8370
 Site-MNIST_M                   (1) | Val  Loss: 0.5448 | Val  Acc: 0.8309
 Site-SVHN                      (3) | Val  Loss: 0.7363 | Val  Acc: 0.8043
 Site-SVHN                      (3) | Val  Loss: 0.7465 | Val  Acc: 0.7734
Average Valid Accuracy: 0.8603
============ Train epoch 34 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (0) | Train Loss: 0.2016 | Train Acc: 0.9380
 Site-MNIST                     (0) | Train Loss: 0.2589 | Train Acc: 0.9238
 Site-USPS                      (1) | Train Loss: 0.2632 | Train Acc: 0.9326
 Site-USPS                      (1) | Train Loss: 0.2584 | Train Acc: 0.9247
 Site-SynthDigits               (1) | Train Loss: 0.4145 | Train Acc: 0.8625
 Site-SynthDigits               (1) | Train Loss: 0.3637 | Train Acc: 0.8978
 Site-MNIST_M                   (2) | Train Loss: 0.5842 | Train Acc: 0.7871
 Site-MNIST_M                   (2) | Train Loss: 0.5290 | Train Acc: 0.8475
 Site-SVHN                      (3) | Train Loss: 0.8393 | Train Acc: 0.7251
 Site-SVHN                      (3) | Train Loss: 0.6905 | Train Acc: 0.7928
Average Train Accuracy: 0.8632
 Site-MNIST                     (0) | Val  Loss: 0.1817 | Val  Acc: 0.9348
 Site-MNIST                     (0) | Val  Loss: 0.2680 | Val  Acc: 0.9281
 Site-USPS                      (1) | Val  Loss: 0.3667 | Val  Acc: 0.8804
 Site-USPS                      (1) | Val  Loss: 0.3061 | Val  Acc: 0.8993
 Site-SynthDigits               (1) | Val  Loss: 0.3907 | Val  Acc: 0.8696
 Site-SynthDigits               (1) | Val  Loss: 0.3760 | Val  Acc: 0.8633
 Site-MNIST_M                   (2) | Val  Loss: 0.6000 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.5365 | Val  Acc: 0.8345
 Site-SVHN                      (3) | Val  Loss: 0.7356 | Val  Acc: 0.8043
 Site-SVHN                      (3) | Val  Loss: 0.7460 | Val  Acc: 0.7770
Average Valid Accuracy: 0.8650
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9348
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9281
 Best site-USPS                     (1)  | Epoch:34 | Val Acc: 0.8804
 Best site-USPS                     (1)  | Epoch:34 | Val Acc: 0.8993
 Best site-SynthDigits              (1)  | Epoch:34 | Val Acc: 0.8696
 Best site-SynthDigits              (1)  | Epoch:34 | Val Acc: 0.8633
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.8587
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.8345
 Best site-SVHN                     (3)  | Epoch:34 | Val Acc: 0.8043
 Best site-SVHN                     (3)  | Epoch:34 | Val Acc: 0.7770
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 35 ============
cnt=[2, 2, 4, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (3) | Train Loss: 0.2034 | Train Acc: 0.9407
 Site-MNIST                     (3) | Train Loss: 0.2518 | Train Acc: 0.9300
 Site-USPS                      (2) | Train Loss: 0.2684 | Train Acc: 0.9245
 Site-USPS                      (2) | Train Loss: 0.2663 | Train Acc: 0.9247
 Site-SynthDigits               (2) | Train Loss: 0.4010 | Train Acc: 0.8679
 Site-SynthDigits               (2) | Train Loss: 0.3595 | Train Acc: 0.9004
 Site-MNIST_M                   (0) | Train Loss: 0.5788 | Train Acc: 0.8086
 Site-MNIST_M                   (0) | Train Loss: 0.5299 | Train Acc: 0.8439
 Site-SVHN                      (1) | Train Loss: 0.8188 | Train Acc: 0.7197
 Site-SVHN                      (1) | Train Loss: 0.6730 | Train Acc: 0.8009
Average Train Accuracy: 0.8661
 Site-MNIST                     (3) | Val  Loss: 0.1787 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2675 | Val  Acc: 0.9317
 Site-USPS                      (2) | Val  Loss: 0.3641 | Val  Acc: 0.8696
 Site-USPS                      (2) | Val  Loss: 0.3036 | Val  Acc: 0.8993
 Site-SynthDigits               (2) | Val  Loss: 0.3878 | Val  Acc: 0.8696
 Site-SynthDigits               (2) | Val  Loss: 0.3637 | Val  Acc: 0.8741
 Site-MNIST_M                   (0) | Val  Loss: 0.5869 | Val  Acc: 0.8478
 Site-MNIST_M                   (0) | Val  Loss: 0.5253 | Val  Acc: 0.8309
 Site-SVHN                      (1) | Val  Loss: 0.7070 | Val  Acc: 0.8261
 Site-SVHN                      (1) | Val  Loss: 0.7255 | Val  Acc: 0.7914
Average Valid Accuracy: 0.8686
 Best site-MNIST                    (3)  | Epoch:35 | Val Acc: 0.9457
 Best site-MNIST                    (3)  | Epoch:35 | Val Acc: 0.9317
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.8696
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.8993
 Best site-SynthDigits              (2)  | Epoch:35 | Val Acc: 0.8696
 Best site-SynthDigits              (2)  | Epoch:35 | Val Acc: 0.8741
 Best site-MNIST_M                  (0)  | Epoch:35 | Val Acc: 0.8478
 Best site-MNIST_M                  (0)  | Epoch:35 | Val Acc: 0.8309
 Best site-SVHN                     (1)  | Epoch:35 | Val Acc: 0.8261
 Best site-SVHN                     (1)  | Epoch:35 | Val Acc: 0.7914
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 36 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (2) | Train Loss: 0.2004 | Train Acc: 0.9434
 Site-MNIST                     (2) | Train Loss: 0.2519 | Train Acc: 0.9300
 Site-USPS                      (1) | Train Loss: 0.2610 | Train Acc: 0.9218
 Site-USPS                      (1) | Train Loss: 0.2578 | Train Acc: 0.9265
 Site-SynthDigits               (1) | Train Loss: 0.4161 | Train Acc: 0.8733
 Site-SynthDigits               (1) | Train Loss: 0.3626 | Train Acc: 0.9013
 Site-MNIST_M                   (0) | Train Loss: 0.5810 | Train Acc: 0.8140
 Site-MNIST_M                   (0) | Train Loss: 0.5206 | Train Acc: 0.8529
 Site-SVHN                      (3) | Train Loss: 0.8342 | Train Acc: 0.7170
 Site-SVHN                      (3) | Train Loss: 0.6761 | Train Acc: 0.7964
Average Train Accuracy: 0.8677
 Site-MNIST                     (2) | Val  Loss: 0.1743 | Val  Acc: 0.9457
 Site-MNIST                     (2) | Val  Loss: 0.2618 | Val  Acc: 0.9317
 Site-USPS                      (1) | Val  Loss: 0.3660 | Val  Acc: 0.8804
 Site-USPS                      (1) | Val  Loss: 0.3027 | Val  Acc: 0.8993
 Site-SynthDigits               (1) | Val  Loss: 0.3919 | Val  Acc: 0.8804
 Site-SynthDigits               (1) | Val  Loss: 0.3721 | Val  Acc: 0.8777
 Site-MNIST_M                   (0) | Val  Loss: 0.5833 | Val  Acc: 0.8696
 Site-MNIST_M                   (0) | Val  Loss: 0.5243 | Val  Acc: 0.8453
 Site-SVHN                      (3) | Val  Loss: 0.7100 | Val  Acc: 0.7935
 Site-SVHN                      (3) | Val  Loss: 0.7300 | Val  Acc: 0.7806
Average Valid Accuracy: 0.8704
 Best site-MNIST                    (2)  | Epoch:36 | Val Acc: 0.9457
 Best site-MNIST                    (2)  | Epoch:36 | Val Acc: 0.9317
 Best site-USPS                     (1)  | Epoch:36 | Val Acc: 0.8804
 Best site-USPS                     (1)  | Epoch:36 | Val Acc: 0.8993
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.8804
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.8777
 Best site-MNIST_M                  (0)  | Epoch:36 | Val Acc: 0.8696
 Best site-MNIST_M                  (0)  | Epoch:36 | Val Acc: 0.8453
 Best site-SVHN                     (3)  | Epoch:36 | Val Acc: 0.7935
 Best site-SVHN                     (3)  | Epoch:36 | Val Acc: 0.7806
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 37 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (3) | Train Loss: 0.1988 | Train Acc: 0.9326
 Site-MNIST                     (3) | Train Loss: 0.2531 | Train Acc: 0.9345
 Site-USPS                      (0) | Train Loss: 0.2531 | Train Acc: 0.9272
 Site-USPS                      (0) | Train Loss: 0.2524 | Train Acc: 0.9256
 Site-SynthDigits               (0) | Train Loss: 0.3896 | Train Acc: 0.8868
 Site-SynthDigits               (0) | Train Loss: 0.3489 | Train Acc: 0.8969
 Site-MNIST_M                   (1) | Train Loss: 0.5744 | Train Acc: 0.8086
 Site-MNIST_M                   (1) | Train Loss: 0.5168 | Train Acc: 0.8601
 Site-SVHN                      (2) | Train Loss: 0.8186 | Train Acc: 0.7385
 Site-SVHN                      (2) | Train Loss: 0.6633 | Train Acc: 0.7946
Average Train Accuracy: 0.8705
 Site-MNIST                     (3) | Val  Loss: 0.1695 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2565 | Val  Acc: 0.9353
 Site-USPS                      (0) | Val  Loss: 0.3525 | Val  Acc: 0.8696
 Site-USPS                      (0) | Val  Loss: 0.2948 | Val  Acc: 0.9065
 Site-SynthDigits               (0) | Val  Loss: 0.3605 | Val  Acc: 0.8696
 Site-SynthDigits               (0) | Val  Loss: 0.3563 | Val  Acc: 0.8813
 Site-MNIST_M                   (1) | Val  Loss: 0.5698 | Val  Acc: 0.8696
 Site-MNIST_M                   (1) | Val  Loss: 0.5155 | Val  Acc: 0.8489
 Site-SVHN                      (2) | Val  Loss: 0.7071 | Val  Acc: 0.7935
 Site-SVHN                      (2) | Val  Loss: 0.7164 | Val  Acc: 0.7842
Average Valid Accuracy: 0.8715
 Best site-MNIST                    (3)  | Epoch:37 | Val Acc: 0.9565
 Best site-MNIST                    (3)  | Epoch:37 | Val Acc: 0.9353
 Best site-USPS                     (0)  | Epoch:37 | Val Acc: 0.8696
 Best site-USPS                     (0)  | Epoch:37 | Val Acc: 0.9065
 Best site-SynthDigits              (0)  | Epoch:37 | Val Acc: 0.8696
 Best site-SynthDigits              (0)  | Epoch:37 | Val Acc: 0.8813
 Best site-MNIST_M                  (1)  | Epoch:37 | Val Acc: 0.8696
 Best site-MNIST_M                  (1)  | Epoch:37 | Val Acc: 0.8489
 Best site-SVHN                     (2)  | Epoch:37 | Val Acc: 0.7935
 Best site-SVHN                     (2)  | Epoch:37 | Val Acc: 0.7842
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 38 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (1) | Train Loss: 0.2004 | Train Acc: 0.9353
 Site-MNIST                     (1) | Train Loss: 0.2530 | Train Acc: 0.9336
 Site-USPS                      (0) | Train Loss: 0.2599 | Train Acc: 0.9353
 Site-USPS                      (0) | Train Loss: 0.2545 | Train Acc: 0.9238
 Site-SynthDigits               (0) | Train Loss: 0.3851 | Train Acc: 0.8787
 Site-SynthDigits               (0) | Train Loss: 0.3452 | Train Acc: 0.9049
 Site-MNIST_M                   (2) | Train Loss: 0.5552 | Train Acc: 0.8005
 Site-MNIST_M                   (2) | Train Loss: 0.5026 | Train Acc: 0.8556
 Site-SVHN                      (3) | Train Loss: 0.8132 | Train Acc: 0.7224
 Site-SVHN                      (3) | Train Loss: 0.6635 | Train Acc: 0.7982
Average Train Accuracy: 0.8688
 Site-MNIST                     (1) | Val  Loss: 0.1679 | Val  Acc: 0.9565
 Site-MNIST                     (1) | Val  Loss: 0.2579 | Val  Acc: 0.9353
 Site-USPS                      (0) | Val  Loss: 0.3506 | Val  Acc: 0.8587
 Site-USPS                      (0) | Val  Loss: 0.2955 | Val  Acc: 0.9065
 Site-SynthDigits               (0) | Val  Loss: 0.3675 | Val  Acc: 0.8804
 Site-SynthDigits               (0) | Val  Loss: 0.3538 | Val  Acc: 0.8849
 Site-MNIST_M                   (2) | Val  Loss: 0.5641 | Val  Acc: 0.8696
 Site-MNIST_M                   (2) | Val  Loss: 0.5093 | Val  Acc: 0.8381
 Site-SVHN                      (3) | Val  Loss: 0.6904 | Val  Acc: 0.8043
 Site-SVHN                      (3) | Val  Loss: 0.7031 | Val  Acc: 0.7878
Average Valid Accuracy: 0.8722
 Best site-MNIST                    (1)  | Epoch:38 | Val Acc: 0.9565
 Best site-MNIST                    (1)  | Epoch:38 | Val Acc: 0.9353
 Best site-USPS                     (0)  | Epoch:38 | Val Acc: 0.8587
 Best site-USPS                     (0)  | Epoch:38 | Val Acc: 0.9065
 Best site-SynthDigits              (0)  | Epoch:38 | Val Acc: 0.8804
 Best site-SynthDigits              (0)  | Epoch:38 | Val Acc: 0.8849
 Best site-MNIST_M                  (2)  | Epoch:38 | Val Acc: 0.8696
 Best site-MNIST_M                  (2)  | Epoch:38 | Val Acc: 0.8381
 Best site-SVHN                     (3)  | Epoch:38 | Val Acc: 0.8043
 Best site-SVHN                     (3)  | Epoch:38 | Val Acc: 0.7878
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 39 ============
cnt=[2, 4, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (0) | Train Loss: 0.1982 | Train Acc: 0.9380
 Site-MNIST                     (0) | Train Loss: 0.2454 | Train Acc: 0.9274
 Site-USPS                      (1) | Train Loss: 0.2614 | Train Acc: 0.9380
 Site-USPS                      (1) | Train Loss: 0.2548 | Train Acc: 0.9211
 Site-SynthDigits               (1) | Train Loss: 0.3827 | Train Acc: 0.8814
 Site-SynthDigits               (1) | Train Loss: 0.3342 | Train Acc: 0.9076
 Site-MNIST_M                   (2) | Train Loss: 0.5573 | Train Acc: 0.8167
 Site-MNIST_M                   (2) | Train Loss: 0.4950 | Train Acc: 0.8619
 Site-SVHN                      (3) | Train Loss: 0.7985 | Train Acc: 0.7224
 Site-SVHN                      (3) | Train Loss: 0.6474 | Train Acc: 0.7973
Average Train Accuracy: 0.8712
 Site-MNIST                     (0) | Val  Loss: 0.1678 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2565 | Val  Acc: 0.9353
 Site-USPS                      (1) | Val  Loss: 0.3443 | Val  Acc: 0.8696
 Site-USPS                      (1) | Val  Loss: 0.2961 | Val  Acc: 0.9137
 Site-SynthDigits               (1) | Val  Loss: 0.3499 | Val  Acc: 0.8696
 Site-SynthDigits               (1) | Val  Loss: 0.3471 | Val  Acc: 0.8849
 Site-MNIST_M                   (2) | Val  Loss: 0.5564 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.5048 | Val  Acc: 0.8453
 Site-SVHN                      (3) | Val  Loss: 0.6848 | Val  Acc: 0.8152
 Site-SVHN                      (3) | Val  Loss: 0.6921 | Val  Acc: 0.7950
Average Valid Accuracy: 0.8733
 Best site-MNIST                    (0)  | Epoch:39 | Val Acc: 0.9457
 Best site-MNIST                    (0)  | Epoch:39 | Val Acc: 0.9353
 Best site-USPS                     (1)  | Epoch:39 | Val Acc: 0.8696
 Best site-USPS                     (1)  | Epoch:39 | Val Acc: 0.9137
 Best site-SynthDigits              (1)  | Epoch:39 | Val Acc: 0.8696
 Best site-SynthDigits              (1)  | Epoch:39 | Val Acc: 0.8849
 Best site-MNIST_M                  (2)  | Epoch:39 | Val Acc: 0.8587
 Best site-MNIST_M                  (2)  | Epoch:39 | Val Acc: 0.8453
 Best site-SVHN                     (3)  | Epoch:39 | Val Acc: 0.8152
 Best site-SVHN                     (3)  | Epoch:39 | Val Acc: 0.7950
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 4, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (2) | Train Loss: 0.1872 | Train Acc: 0.9407
 Site-MNIST                     (2) | Train Loss: 0.2401 | Train Acc: 0.9336
 Site-USPS                      (1) | Train Loss: 0.2630 | Train Acc: 0.9245
 Site-USPS                      (1) | Train Loss: 0.2511 | Train Acc: 0.9309
 Site-SynthDigits               (1) | Train Loss: 0.3723 | Train Acc: 0.8841
 Site-SynthDigits               (1) | Train Loss: 0.3335 | Train Acc: 0.9013
 Site-MNIST_M                   (0) | Train Loss: 0.5570 | Train Acc: 0.8005
 Site-MNIST_M                   (0) | Train Loss: 0.4925 | Train Acc: 0.8547
 Site-SVHN                      (3) | Train Loss: 0.7937 | Train Acc: 0.7358
 Site-SVHN                      (3) | Train Loss: 0.6380 | Train Acc: 0.8108
Average Train Accuracy: 0.8717
 Site-MNIST                     (2) | Val  Loss: 0.1596 | Val  Acc: 0.9565
 Site-MNIST                     (2) | Val  Loss: 0.2463 | Val  Acc: 0.9388
 Site-USPS                      (1) | Val  Loss: 0.3402 | Val  Acc: 0.9022
 Site-USPS                      (1) | Val  Loss: 0.2832 | Val  Acc: 0.9101
 Site-SynthDigits               (1) | Val  Loss: 0.3489 | Val  Acc: 0.8804
 Site-SynthDigits               (1) | Val  Loss: 0.3356 | Val  Acc: 0.8921
 Site-MNIST_M                   (0) | Val  Loss: 0.5370 | Val  Acc: 0.8587
 Site-MNIST_M                   (0) | Val  Loss: 0.4927 | Val  Acc: 0.8417
 Site-SVHN                      (3) | Val  Loss: 0.6849 | Val  Acc: 0.8152
 Site-SVHN                      (3) | Val  Loss: 0.6849 | Val  Acc: 0.7986
Average Valid Accuracy: 0.8794
 Best site-MNIST                    (2)  | Epoch:40 | Val Acc: 0.9565
 Best site-MNIST                    (2)  | Epoch:40 | Val Acc: 0.9388
 Best site-USPS                     (1)  | Epoch:40 | Val Acc: 0.9022
 Best site-USPS                     (1)  | Epoch:40 | Val Acc: 0.9101
 Best site-SynthDigits              (1)  | Epoch:40 | Val Acc: 0.8804
 Best site-SynthDigits              (1)  | Epoch:40 | Val Acc: 0.8921
 Best site-MNIST_M                  (0)  | Epoch:40 | Val Acc: 0.8587
 Best site-MNIST_M                  (0)  | Epoch:40 | Val Acc: 0.8417
 Best site-SVHN                     (3)  | Epoch:40 | Val Acc: 0.8152
 Best site-SVHN                     (3)  | Epoch:40 | Val Acc: 0.7986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 41 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (3) | Train Loss: 0.1867 | Train Acc: 0.9272
 Site-MNIST                     (3) | Train Loss: 0.2415 | Train Acc: 0.9327
 Site-USPS                      (1) | Train Loss: 0.2454 | Train Acc: 0.9380
 Site-USPS                      (1) | Train Loss: 0.2355 | Train Acc: 0.9274
 Site-SynthDigits               (1) | Train Loss: 0.3802 | Train Acc: 0.8760
 Site-SynthDigits               (1) | Train Loss: 0.3378 | Train Acc: 0.9067
 Site-MNIST_M                   (2) | Train Loss: 0.5335 | Train Acc: 0.8221
 Site-MNIST_M                   (2) | Train Loss: 0.4858 | Train Acc: 0.8628
 Site-SVHN                      (0) | Train Loss: 0.7926 | Train Acc: 0.7278
 Site-SVHN                      (0) | Train Loss: 0.6293 | Train Acc: 0.8018
Average Train Accuracy: 0.8722
 Site-MNIST                     (3) | Val  Loss: 0.1644 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2462 | Val  Acc: 0.9388
 Site-USPS                      (1) | Val  Loss: 0.3308 | Val  Acc: 0.8804
 Site-USPS                      (1) | Val  Loss: 0.2764 | Val  Acc: 0.9137
 Site-SynthDigits               (1) | Val  Loss: 0.3608 | Val  Acc: 0.8696
 Site-SynthDigits               (1) | Val  Loss: 0.3436 | Val  Acc: 0.8813
 Site-MNIST_M                   (2) | Val  Loss: 0.5273 | Val  Acc: 0.8696
 Site-MNIST_M                   (2) | Val  Loss: 0.4877 | Val  Acc: 0.8417
 Site-SVHN                      (0) | Val  Loss: 0.6781 | Val  Acc: 0.7935
 Site-SVHN                      (0) | Val  Loss: 0.6864 | Val  Acc: 0.7914
Average Valid Accuracy: 0.8736
============ Train epoch 42 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (2) | Train Loss: 0.1920 | Train Acc: 0.9407
 Site-MNIST                     (2) | Train Loss: 0.2349 | Train Acc: 0.9336
 Site-USPS                      (0) | Train Loss: 0.2419 | Train Acc: 0.9380
 Site-USPS                      (0) | Train Loss: 0.2421 | Train Acc: 0.9283
 Site-SynthDigits               (0) | Train Loss: 0.3647 | Train Acc: 0.8895
 Site-SynthDigits               (0) | Train Loss: 0.3205 | Train Acc: 0.9112
 Site-MNIST_M                   (1) | Train Loss: 0.5417 | Train Acc: 0.8248
 Site-MNIST_M                   (1) | Train Loss: 0.4821 | Train Acc: 0.8637
 Site-SVHN                      (3) | Train Loss: 0.7898 | Train Acc: 0.7278
 Site-SVHN                      (3) | Train Loss: 0.6217 | Train Acc: 0.8099
Average Train Accuracy: 0.8767
 Site-MNIST                     (2) | Val  Loss: 0.1587 | Val  Acc: 0.9565
 Site-MNIST                     (2) | Val  Loss: 0.2454 | Val  Acc: 0.9353
 Site-USPS                      (0) | Val  Loss: 0.3360 | Val  Acc: 0.8804
 Site-USPS                      (0) | Val  Loss: 0.2734 | Val  Acc: 0.9065
 Site-SynthDigits               (0) | Val  Loss: 0.3400 | Val  Acc: 0.8804
 Site-SynthDigits               (0) | Val  Loss: 0.3262 | Val  Acc: 0.8885
 Site-MNIST_M                   (1) | Val  Loss: 0.5131 | Val  Acc: 0.8696
 Site-MNIST_M                   (1) | Val  Loss: 0.4791 | Val  Acc: 0.8453
 Site-SVHN                      (3) | Val  Loss: 0.6747 | Val  Acc: 0.8043
 Site-SVHN                      (3) | Val  Loss: 0.6834 | Val  Acc: 0.7914
Average Valid Accuracy: 0.8758
============ Train epoch 43 ============
cnt=[2, 2, 2, 4, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (0) | Train Loss: 0.2015 | Train Acc: 0.9272
 Site-MNIST                     (0) | Train Loss: 0.2485 | Train Acc: 0.9238
 Site-USPS                      (3) | Train Loss: 0.2328 | Train Acc: 0.9407
 Site-USPS                      (3) | Train Loss: 0.2383 | Train Acc: 0.9274
 Site-SynthDigits               (3) | Train Loss: 0.3579 | Train Acc: 0.8922
 Site-SynthDigits               (3) | Train Loss: 0.3301 | Train Acc: 0.9094
 Site-MNIST_M                   (2) | Train Loss: 0.5300 | Train Acc: 0.8248
 Site-MNIST_M                   (2) | Train Loss: 0.4698 | Train Acc: 0.8726
 Site-SVHN                      (1) | Train Loss: 0.7862 | Train Acc: 0.7385
 Site-SVHN                      (1) | Train Loss: 0.6110 | Train Acc: 0.8081
Average Train Accuracy: 0.8765
 Site-MNIST                     (0) | Val  Loss: 0.1722 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2524 | Val  Acc: 0.9281
 Site-USPS                      (3) | Val  Loss: 0.3232 | Val  Acc: 0.8913
 Site-USPS                      (3) | Val  Loss: 0.2659 | Val  Acc: 0.9101
 Site-SynthDigits               (3) | Val  Loss: 0.3444 | Val  Acc: 0.8913
 Site-SynthDigits               (3) | Val  Loss: 0.3251 | Val  Acc: 0.8957
 Site-MNIST_M                   (2) | Val  Loss: 0.5119 | Val  Acc: 0.8696
 Site-MNIST_M                   (2) | Val  Loss: 0.4734 | Val  Acc: 0.8489
 Site-SVHN                      (1) | Val  Loss: 0.6620 | Val  Acc: 0.8152
 Site-SVHN                      (1) | Val  Loss: 0.6685 | Val  Acc: 0.7986
Average Valid Accuracy: 0.8794
============ Train epoch 44 ============
cnt=[2, 2, 4, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (1) | Train Loss: 0.1998 | Train Acc: 0.9299
 Site-MNIST                     (1) | Train Loss: 0.2399 | Train Acc: 0.9274
 Site-USPS                      (2) | Train Loss: 0.2362 | Train Acc: 0.9488
 Site-USPS                      (2) | Train Loss: 0.2342 | Train Acc: 0.9336
 Site-SynthDigits               (2) | Train Loss: 0.3545 | Train Acc: 0.8976
 Site-SynthDigits               (2) | Train Loss: 0.3152 | Train Acc: 0.9112
 Site-MNIST_M                   (3) | Train Loss: 0.5261 | Train Acc: 0.8383
 Site-MNIST_M                   (3) | Train Loss: 0.4704 | Train Acc: 0.8601
 Site-SVHN                      (0) | Train Loss: 0.7778 | Train Acc: 0.7520
 Site-SVHN                      (0) | Train Loss: 0.6161 | Train Acc: 0.8117
Average Train Accuracy: 0.8811
 Site-MNIST                     (1) | Val  Loss: 0.1754 | Val  Acc: 0.9239
 Site-MNIST                     (1) | Val  Loss: 0.2494 | Val  Acc: 0.9353
 Site-USPS                      (2) | Val  Loss: 0.3124 | Val  Acc: 0.8913
 Site-USPS                      (2) | Val  Loss: 0.2614 | Val  Acc: 0.9209
 Site-SynthDigits               (2) | Val  Loss: 0.3299 | Val  Acc: 0.9022
 Site-SynthDigits               (2) | Val  Loss: 0.3160 | Val  Acc: 0.8957
 Site-MNIST_M                   (3) | Val  Loss: 0.5059 | Val  Acc: 0.8478
 Site-MNIST_M                   (3) | Val  Loss: 0.4708 | Val  Acc: 0.8525
 Site-SVHN                      (0) | Val  Loss: 0.6531 | Val  Acc: 0.8043
 Site-SVHN                      (0) | Val  Loss: 0.6603 | Val  Acc: 0.8058
Average Valid Accuracy: 0.8780
============ Train epoch 45 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (3) | Train Loss: 0.1837 | Train Acc: 0.9434
 Site-MNIST                     (3) | Train Loss: 0.2347 | Train Acc: 0.9336
 Site-USPS                      (1) | Train Loss: 0.2315 | Train Acc: 0.9353
 Site-USPS                      (1) | Train Loss: 0.2249 | Train Acc: 0.9300
 Site-SynthDigits               (1) | Train Loss: 0.3600 | Train Acc: 0.8868
 Site-SynthDigits               (1) | Train Loss: 0.3149 | Train Acc: 0.9130
 Site-MNIST_M                   (2) | Train Loss: 0.5245 | Train Acc: 0.8275
 Site-MNIST_M                   (2) | Train Loss: 0.4710 | Train Acc: 0.8547
 Site-SVHN                      (0) | Train Loss: 0.7803 | Train Acc: 0.7439
 Site-SVHN                      (0) | Train Loss: 0.6130 | Train Acc: 0.8152
Average Train Accuracy: 0.8784
 Site-MNIST                     (3) | Val  Loss: 0.1650 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2337 | Val  Acc: 0.9388
 Site-USPS                      (1) | Val  Loss: 0.3105 | Val  Acc: 0.8804
 Site-USPS                      (1) | Val  Loss: 0.2602 | Val  Acc: 0.9173
 Site-SynthDigits               (1) | Val  Loss: 0.3309 | Val  Acc: 0.8804
 Site-SynthDigits               (1) | Val  Loss: 0.3171 | Val  Acc: 0.8885
 Site-MNIST_M                   (2) | Val  Loss: 0.4998 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.4611 | Val  Acc: 0.8525
 Site-SVHN                      (0) | Val  Loss: 0.6574 | Val  Acc: 0.8152
 Site-SVHN                      (0) | Val  Loss: 0.6522 | Val  Acc: 0.8129
Average Valid Accuracy: 0.8801
 Best site-MNIST                    (3)  | Epoch:45 | Val Acc: 0.9565
 Best site-MNIST                    (3)  | Epoch:45 | Val Acc: 0.9388
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 0.8804
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 0.9173
 Best site-SynthDigits              (1)  | Epoch:45 | Val Acc: 0.8804
 Best site-SynthDigits              (1)  | Epoch:45 | Val Acc: 0.8885
 Best site-MNIST_M                  (2)  | Epoch:45 | Val Acc: 0.8587
 Best site-MNIST_M                  (2)  | Epoch:45 | Val Acc: 0.8525
 Best site-SVHN                     (0)  | Epoch:45 | Val Acc: 0.8152
 Best site-SVHN                     (0)  | Epoch:45 | Val Acc: 0.8129
 Test site-MNIST                     (3)| Epoch:45 | Test Acc: 0.9389
 Test site-USPS                      (1)| Epoch:45 | Test Acc: 0.9376
 Test site-SynthDigits               (1)| Epoch:45 | Test Acc: 0.8958
 Test site-MNIST_M                   (2)| Epoch:45 | Test Acc: 0.7743
 Test site-SVHN                      (0)| Epoch:45 | Test Acc: 0.7331
MNIST: 0.9389, USPS: 0.9376, SynthDigits: 0.8958, MNIST_M: 0.7743, SVHN: 0.7331, 
Average Test Accuracy(group): 0.8559, Average Test Accuracy(individual): 0.8559,
domain std=0.0859, cluster std=0.0886, individual std=0.0859, 
===2023-08-01 16:06:41===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 4
Loading snapshots...
 Test site-MNIST                     (2)| Epoch:40 | Test Acc: 0.9384
 Test site-USPS                      (1)| Epoch:40 | Test Acc: 0.9301
===2023-08-01 16:21:11===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 2, 4, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (2) | Train Loss: 1.6627 | Train Acc: 0.5849
 Site-MNIST                     (2) | Train Loss: 1.7236 | Train Acc: 0.5390
 Site-USPS                      (2) | Train Loss: 1.6203 | Train Acc: 0.6927
 Site-USPS                      (2) | Train Loss: 1.6366 | Train Acc: 0.6574
 Site-SynthDigits               (0) | Train Loss: 2.0559 | Train Acc: 0.2992
 Site-SynthDigits               (0) | Train Loss: 2.0226 | Train Acc: 0.3417
 Site-MNIST_M                   (3) | Train Loss: 2.1848 | Train Acc: 0.2210
 Site-MNIST_M                   (3) | Train Loss: 2.1833 | Train Acc: 0.2251
 Site-SVHN                      (1) | Train Loss: 2.1921 | Train Acc: 0.1995
 Site-SVHN                      (1) | Train Loss: 2.1735 | Train Acc: 0.2359
Average Train Accuracy: 0.3996
 Site-MNIST                     (2) | Val  Loss: 1.7611 | Val  Acc: 0.5109
 Site-MNIST                     (2) | Val  Loss: 1.6877 | Val  Acc: 0.5791
 Site-USPS                      (2) | Val  Loss: 1.6446 | Val  Acc: 0.6522
 Site-USPS                      (2) | Val  Loss: 1.6560 | Val  Acc: 0.6367
 Site-SynthDigits               (0) | Val  Loss: 2.0734 | Val  Acc: 0.2935
 Site-SynthDigits               (0) | Val  Loss: 2.0365 | Val  Acc: 0.3309
 Site-MNIST_M                   (3) | Val  Loss: 2.2369 | Val  Acc: 0.2283
 Site-MNIST_M                   (3) | Val  Loss: 2.1856 | Val  Acc: 0.2374
 Site-SVHN                      (1) | Val  Loss: 2.1650 | Val  Acc: 0.2935
 Site-SVHN                      (1) | Val  Loss: 2.1733 | Val  Acc: 0.2374
Average Valid Accuracy: 0.4000
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5109
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5791
 Best site-USPS                     (2)  | Epoch:0 | Val Acc: 0.6522
 Best site-USPS                     (2)  | Epoch:0 | Val Acc: 0.6367
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.2935
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.3309
 Best site-MNIST_M                  (3)  | Epoch:0 | Val Acc: 0.2283
 Best site-MNIST_M                  (3)  | Epoch:0 | Val Acc: 0.2374
 Best site-SVHN                     (1)  | Epoch:0 | Val Acc: 0.2935
 Best site-SVHN                     (1)  | Epoch:0 | Val Acc: 0.2374
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 1 ============
cnt=[3, 2, 3, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (0) | Train Loss: 1.2566 | Train Acc: 0.8032
 Site-MNIST                     (0) | Train Loss: 1.3327 | Train Acc: 0.7318
 Site-USPS                      (2) | Train Loss: 1.1643 | Train Acc: 0.8113
 Site-USPS                      (2) | Train Loss: 1.1929 | Train Acc: 0.7883
 Site-SynthDigits               (2) | Train Loss: 1.8255 | Train Acc: 0.3801
 Site-SynthDigits               (0) | Train Loss: 1.7456 | Train Acc: 0.4359
 Site-MNIST_M                   (3) | Train Loss: 1.9512 | Train Acc: 0.3585
 Site-MNIST_M                   (3) | Train Loss: 1.9756 | Train Acc: 0.3345
 Site-SVHN                      (1) | Train Loss: 2.0671 | Train Acc: 0.2642
 Site-SVHN                      (1) | Train Loss: 2.0267 | Train Acc: 0.2969
Average Train Accuracy: 0.5205
 Site-MNIST                     (0) | Val  Loss: 1.3403 | Val  Acc: 0.7283
 Site-MNIST                     (0) | Val  Loss: 1.2986 | Val  Acc: 0.7734
 Site-USPS                      (2) | Val  Loss: 1.2124 | Val  Acc: 0.7609
 Site-USPS                      (2) | Val  Loss: 1.2281 | Val  Acc: 0.7734
 Site-SynthDigits               (2) | Val  Loss: 1.7759 | Val  Acc: 0.3913
 Site-SynthDigits               (0) | Val  Loss: 1.7544 | Val  Acc: 0.3921
 Site-MNIST_M                   (3) | Val  Loss: 2.0138 | Val  Acc: 0.3261
 Site-MNIST_M                   (3) | Val  Loss: 1.9415 | Val  Acc: 0.4029
 Site-SVHN                      (1) | Val  Loss: 2.0484 | Val  Acc: 0.3043
 Site-SVHN                      (1) | Val  Loss: 2.0628 | Val  Acc: 0.3129
Average Valid Accuracy: 0.5166
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7283
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7734
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.7609
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.7734
 Best site-SynthDigits              (2)  | Epoch:1 | Val Acc: 0.3913
 Best site-SynthDigits              (0)  | Epoch:1 | Val Acc: 0.3921
 Best site-MNIST_M                  (3)  | Epoch:1 | Val Acc: 0.3261
 Best site-MNIST_M                  (3)  | Epoch:1 | Val Acc: 0.4029
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.3043
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.3129
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 2, 4, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (2) | Train Loss: 1.1135 | Train Acc: 0.7763
 Site-MNIST                     (2) | Train Loss: 1.2019 | Train Acc: 0.7166
 Site-USPS                      (0) | Train Loss: 1.0007 | Train Acc: 0.8275
 Site-USPS                      (0) | Train Loss: 1.0358 | Train Acc: 0.7910
 Site-SynthDigits               (2) | Train Loss: 1.5854 | Train Acc: 0.4987
 Site-SynthDigits               (2) | Train Loss: 1.5048 | Train Acc: 0.5220
 Site-MNIST_M                   (3) | Train Loss: 1.7173 | Train Acc: 0.4663
 Site-MNIST_M                   (3) | Train Loss: 1.7777 | Train Acc: 0.4126
 Site-SVHN                      (1) | Train Loss: 1.9435 | Train Acc: 0.3396
 Site-SVHN                      (1) | Train Loss: 1.8856 | Train Acc: 0.3453
Average Train Accuracy: 0.5696
 Site-MNIST                     (2) | Val  Loss: 1.1908 | Val  Acc: 0.7391
 Site-MNIST                     (2) | Val  Loss: 1.1724 | Val  Acc: 0.7842
 Site-USPS                      (0) | Val  Loss: 1.0517 | Val  Acc: 0.7826
 Site-USPS                      (0) | Val  Loss: 1.0722 | Val  Acc: 0.7914
 Site-SynthDigits               (2) | Val  Loss: 1.5152 | Val  Acc: 0.4674
 Site-SynthDigits               (2) | Val  Loss: 1.4902 | Val  Acc: 0.5000
 Site-MNIST_M                   (3) | Val  Loss: 1.8044 | Val  Acc: 0.4239
 Site-MNIST_M                   (3) | Val  Loss: 1.7155 | Val  Acc: 0.4964
 Site-SVHN                      (1) | Val  Loss: 1.9233 | Val  Acc: 0.3261
 Site-SVHN                      (1) | Val  Loss: 1.9451 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5671
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.7391
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.7842
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7826
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7914
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.4674
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.5000
 Best site-MNIST_M                  (3)  | Epoch:2 | Val Acc: 0.4239
 Best site-MNIST_M                  (3)  | Epoch:2 | Val Acc: 0.4964
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.3261
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.3597
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 3 ============
cnt=[4, 2, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (0) | Train Loss: 0.8548 | Train Acc: 0.8679
 Site-MNIST                     (0) | Train Loss: 0.9408 | Train Acc: 0.8018
 Site-USPS                      (2) | Train Loss: 0.8093 | Train Acc: 0.8571
 Site-USPS                      (2) | Train Loss: 0.8370 | Train Acc: 0.8314
 Site-SynthDigits               (0) | Train Loss: 1.3884 | Train Acc: 0.5876
 Site-SynthDigits               (0) | Train Loss: 1.2929 | Train Acc: 0.6359
 Site-MNIST_M                   (1) | Train Loss: 1.5780 | Train Acc: 0.5121
 Site-MNIST_M                   (1) | Train Loss: 1.6108 | Train Acc: 0.4942
 Site-SVHN                      (3) | Train Loss: 1.8302 | Train Acc: 0.3827
 Site-SVHN                      (3) | Train Loss: 1.7519 | Train Acc: 0.4161
Average Train Accuracy: 0.6387
 Site-MNIST                     (0) | Val  Loss: 0.9288 | Val  Acc: 0.8152
 Site-MNIST                     (0) | Val  Loss: 0.9228 | Val  Acc: 0.8309
 Site-USPS                      (2) | Val  Loss: 0.8849 | Val  Acc: 0.7500
 Site-USPS                      (2) | Val  Loss: 0.8832 | Val  Acc: 0.8094
 Site-SynthDigits               (0) | Val  Loss: 1.3330 | Val  Acc: 0.5761
 Site-SynthDigits               (0) | Val  Loss: 1.2931 | Val  Acc: 0.5719
 Site-MNIST_M                   (1) | Val  Loss: 1.6598 | Val  Acc: 0.4348
 Site-MNIST_M                   (1) | Val  Loss: 1.5618 | Val  Acc: 0.5324
 Site-SVHN                      (3) | Val  Loss: 1.8102 | Val  Acc: 0.3587
 Site-SVHN                      (3) | Val  Loss: 1.8374 | Val  Acc: 0.3921
Average Valid Accuracy: 0.6071
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8152
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8309
 Best site-USPS                     (2)  | Epoch:3 | Val Acc: 0.7500
 Best site-USPS                     (2)  | Epoch:3 | Val Acc: 0.8094
 Best site-SynthDigits              (0)  | Epoch:3 | Val Acc: 0.5761
 Best site-SynthDigits              (0)  | Epoch:3 | Val Acc: 0.5719
 Best site-MNIST_M                  (1)  | Epoch:3 | Val Acc: 0.4348
 Best site-MNIST_M                  (1)  | Epoch:3 | Val Acc: 0.5324
 Best site-SVHN                     (3)  | Epoch:3 | Val Acc: 0.3587
 Best site-SVHN                     (3)  | Epoch:3 | Val Acc: 0.3921
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 4 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (0) | Train Loss: 0.7352 | Train Acc: 0.8706
 Site-MNIST                     (0) | Train Loss: 0.8300 | Train Acc: 0.8269
 Site-USPS                      (2) | Train Loss: 0.7251 | Train Acc: 0.8598
 Site-USPS                      (2) | Train Loss: 0.7501 | Train Acc: 0.8377
 Site-SynthDigits               (0) | Train Loss: 1.2159 | Train Acc: 0.6415
 Site-SynthDigits               (0) | Train Loss: 1.1281 | Train Acc: 0.6915
 Site-MNIST_M                   (1) | Train Loss: 1.4607 | Train Acc: 0.5876
 Site-MNIST_M                   (1) | Train Loss: 1.5060 | Train Acc: 0.5426
 Site-SVHN                      (3) | Train Loss: 1.6795 | Train Acc: 0.4367
 Site-SVHN                      (3) | Train Loss: 1.6027 | Train Acc: 0.4735
Average Train Accuracy: 0.6768
 Site-MNIST                     (0) | Val  Loss: 0.7795 | Val  Acc: 0.8043
 Site-MNIST                     (0) | Val  Loss: 0.8040 | Val  Acc: 0.8381
 Site-USPS                      (2) | Val  Loss: 0.8122 | Val  Acc: 0.7717
 Site-USPS                      (2) | Val  Loss: 0.8081 | Val  Acc: 0.8201
 Site-SynthDigits               (0) | Val  Loss: 1.1521 | Val  Acc: 0.6196
 Site-SynthDigits               (0) | Val  Loss: 1.1413 | Val  Acc: 0.6259
 Site-MNIST_M                   (1) | Val  Loss: 1.5618 | Val  Acc: 0.5326
 Site-MNIST_M                   (1) | Val  Loss: 1.4571 | Val  Acc: 0.5899
 Site-SVHN                      (3) | Val  Loss: 1.6756 | Val  Acc: 0.3696
 Site-SVHN                      (3) | Val  Loss: 1.6857 | Val  Acc: 0.4532
Average Valid Accuracy: 0.6425
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8043
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8381
 Best site-USPS                     (2)  | Epoch:4 | Val Acc: 0.7717
 Best site-USPS                     (2)  | Epoch:4 | Val Acc: 0.8201
 Best site-SynthDigits              (0)  | Epoch:4 | Val Acc: 0.6196
 Best site-SynthDigits              (0)  | Epoch:4 | Val Acc: 0.6259
 Best site-MNIST_M                  (1)  | Epoch:4 | Val Acc: 0.5326
 Best site-MNIST_M                  (1)  | Epoch:4 | Val Acc: 0.5899
 Best site-SVHN                     (3)  | Epoch:4 | Val Acc: 0.3696
 Best site-SVHN                     (3)  | Epoch:4 | Val Acc: 0.4532
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (1) | Train Loss: 0.6491 | Train Acc: 0.8814
 Site-MNIST                     (1) | Train Loss: 0.7332 | Train Acc: 0.8260
 Site-USPS                      (2) | Train Loss: 0.6685 | Train Acc: 0.8437
 Site-USPS                      (2) | Train Loss: 0.6893 | Train Acc: 0.8323
 Site-SynthDigits               (1) | Train Loss: 1.1243 | Train Acc: 0.6334
 Site-SynthDigits               (1) | Train Loss: 1.0303 | Train Acc: 0.7085
 Site-MNIST_M                   (0) | Train Loss: 1.3379 | Train Acc: 0.6307
 Site-MNIST_M                   (0) | Train Loss: 1.3912 | Train Acc: 0.5874
 Site-SVHN                      (3) | Train Loss: 1.5691 | Train Acc: 0.4663
 Site-SVHN                      (3) | Train Loss: 1.4858 | Train Acc: 0.5067
Average Train Accuracy: 0.6917
 Site-MNIST                     (1) | Val  Loss: 0.6779 | Val  Acc: 0.8478
 Site-MNIST                     (1) | Val  Loss: 0.7164 | Val  Acc: 0.8525
 Site-USPS                      (2) | Val  Loss: 0.7648 | Val  Acc: 0.7609
 Site-USPS                      (2) | Val  Loss: 0.7524 | Val  Acc: 0.8094
 Site-SynthDigits               (1) | Val  Loss: 1.0515 | Val  Acc: 0.6304
 Site-SynthDigits               (1) | Val  Loss: 1.0584 | Val  Acc: 0.6151
 Site-MNIST_M                   (0) | Val  Loss: 1.4449 | Val  Acc: 0.5543
 Site-MNIST_M                   (0) | Val  Loss: 1.3429 | Val  Acc: 0.6367
 Site-SVHN                      (3) | Val  Loss: 1.5392 | Val  Acc: 0.4239
 Site-SVHN                      (3) | Val  Loss: 1.5492 | Val  Acc: 0.4856
Average Valid Accuracy: 0.6617
 Best site-MNIST                    (1)  | Epoch:5 | Val Acc: 0.8478
 Best site-MNIST                    (1)  | Epoch:5 | Val Acc: 0.8525
 Best site-USPS                     (2)  | Epoch:5 | Val Acc: 0.7609
 Best site-USPS                     (2)  | Epoch:5 | Val Acc: 0.8094
 Best site-SynthDigits              (1)  | Epoch:5 | Val Acc: 0.6304
 Best site-SynthDigits              (1)  | Epoch:5 | Val Acc: 0.6151
 Best site-MNIST_M                  (0)  | Epoch:5 | Val Acc: 0.5543
 Best site-MNIST_M                  (0)  | Epoch:5 | Val Acc: 0.6367
 Best site-SVHN                     (3)  | Epoch:5 | Val Acc: 0.4239
 Best site-SVHN                     (3)  | Epoch:5 | Val Acc: 0.4856
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 4, 2, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (1) | Train Loss: 0.5612 | Train Acc: 0.8841
 Site-MNIST                     (1) | Train Loss: 0.6556 | Train Acc: 0.8430
 Site-USPS                      (3) | Train Loss: 0.6143 | Train Acc: 0.8733
 Site-USPS                      (3) | Train Loss: 0.6329 | Train Acc: 0.8511
 Site-SynthDigits               (1) | Train Loss: 0.9905 | Train Acc: 0.6927
 Site-SynthDigits               (1) | Train Loss: 0.9127 | Train Acc: 0.7435
 Site-MNIST_M                   (2) | Train Loss: 1.2899 | Train Acc: 0.6415
 Site-MNIST_M                   (2) | Train Loss: 1.3159 | Train Acc: 0.6054
 Site-SVHN                      (0) | Train Loss: 1.4320 | Train Acc: 0.5364
 Site-SVHN                      (0) | Train Loss: 1.3437 | Train Acc: 0.5704
Average Train Accuracy: 0.7241
 Site-MNIST                     (1) | Val  Loss: 0.5902 | Val  Acc: 0.8370
 Site-MNIST                     (1) | Val  Loss: 0.6361 | Val  Acc: 0.8525
 Site-USPS                      (3) | Val  Loss: 0.7167 | Val  Acc: 0.7935
 Site-USPS                      (3) | Val  Loss: 0.6938 | Val  Acc: 0.8309
 Site-SynthDigits               (1) | Val  Loss: 0.9390 | Val  Acc: 0.6739
 Site-SynthDigits               (1) | Val  Loss: 0.9358 | Val  Acc: 0.6871
 Site-MNIST_M                   (2) | Val  Loss: 1.3756 | Val  Acc: 0.5326
 Site-MNIST_M                   (2) | Val  Loss: 1.2826 | Val  Acc: 0.6331
 Site-SVHN                      (0) | Val  Loss: 1.3749 | Val  Acc: 0.5326
 Site-SVHN                      (0) | Val  Loss: 1.3939 | Val  Acc: 0.5468
Average Valid Accuracy: 0.6920
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8370
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8525
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.7935
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.8309
 Best site-SynthDigits              (1)  | Epoch:6 | Val Acc: 0.6739
 Best site-SynthDigits              (1)  | Epoch:6 | Val Acc: 0.6871
 Best site-MNIST_M                  (2)  | Epoch:6 | Val Acc: 0.5326
 Best site-MNIST_M                  (2)  | Epoch:6 | Val Acc: 0.6331
 Best site-SVHN                     (0)  | Epoch:6 | Val Acc: 0.5326
 Best site-SVHN                     (0)  | Epoch:6 | Val Acc: 0.5468
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 7 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (0) | Train Loss: 0.5261 | Train Acc: 0.8814
 Site-MNIST                     (0) | Train Loss: 0.6095 | Train Acc: 0.8368
 Site-USPS                      (2) | Train Loss: 0.5686 | Train Acc: 0.8814
 Site-USPS                      (2) | Train Loss: 0.5932 | Train Acc: 0.8574
 Site-SynthDigits               (0) | Train Loss: 0.9449 | Train Acc: 0.7143
 Site-SynthDigits               (0) | Train Loss: 0.8522 | Train Acc: 0.7605
 Site-MNIST_M                   (1) | Train Loss: 1.1863 | Train Acc: 0.6577
 Site-MNIST_M                   (1) | Train Loss: 1.2140 | Train Acc: 0.6466
 Site-SVHN                      (3) | Train Loss: 1.3778 | Train Acc: 0.5472
 Site-SVHN                      (3) | Train Loss: 1.3037 | Train Acc: 0.5892
Average Train Accuracy: 0.7373
 Site-MNIST                     (0) | Val  Loss: 0.5351 | Val  Acc: 0.8261
 Site-MNIST                     (0) | Val  Loss: 0.5927 | Val  Acc: 0.8453
 Site-USPS                      (2) | Val  Loss: 0.6758 | Val  Acc: 0.7826
 Site-USPS                      (2) | Val  Loss: 0.6455 | Val  Acc: 0.8417
 Site-SynthDigits               (0) | Val  Loss: 0.8928 | Val  Acc: 0.6957
 Site-SynthDigits               (0) | Val  Loss: 0.8802 | Val  Acc: 0.7230
 Site-MNIST_M                   (1) | Val  Loss: 1.2706 | Val  Acc: 0.5761
 Site-MNIST_M                   (1) | Val  Loss: 1.1847 | Val  Acc: 0.6547
 Site-SVHN                      (3) | Val  Loss: 1.3194 | Val  Acc: 0.5435
 Site-SVHN                      (3) | Val  Loss: 1.3486 | Val  Acc: 0.5683
Average Valid Accuracy: 0.7057
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8261
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8453
 Best site-USPS                     (2)  | Epoch:7 | Val Acc: 0.7826
 Best site-USPS                     (2)  | Epoch:7 | Val Acc: 0.8417
 Best site-SynthDigits              (0)  | Epoch:7 | Val Acc: 0.6957
 Best site-SynthDigits              (0)  | Epoch:7 | Val Acc: 0.7230
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.5761
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.6547
 Best site-SVHN                     (3)  | Epoch:7 | Val Acc: 0.5435
 Best site-SVHN                     (3)  | Epoch:7 | Val Acc: 0.5683
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 4, 2, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (1) | Train Loss: 0.4752 | Train Acc: 0.8976
 Site-MNIST                     (1) | Train Loss: 0.5662 | Train Acc: 0.8466
 Site-USPS                      (2) | Train Loss: 0.5438 | Train Acc: 0.8652
 Site-USPS                      (2) | Train Loss: 0.5615 | Train Acc: 0.8520
 Site-SynthDigits               (1) | Train Loss: 0.8561 | Train Acc: 0.7547
 Site-SynthDigits               (1) | Train Loss: 0.7749 | Train Acc: 0.7848
 Site-MNIST_M                   (0) | Train Loss: 1.1333 | Train Acc: 0.6496
 Site-MNIST_M                   (0) | Train Loss: 1.1490 | Train Acc: 0.6628
 Site-SVHN                      (3) | Train Loss: 1.3148 | Train Acc: 0.5660
 Site-SVHN                      (3) | Train Loss: 1.2502 | Train Acc: 0.5937
Average Train Accuracy: 0.7473
 Site-MNIST                     (1) | Val  Loss: 0.4846 | Val  Acc: 0.8478
 Site-MNIST                     (1) | Val  Loss: 0.5476 | Val  Acc: 0.8561
 Site-USPS                      (2) | Val  Loss: 0.6559 | Val  Acc: 0.7826
 Site-USPS                      (2) | Val  Loss: 0.6240 | Val  Acc: 0.8309
 Site-SynthDigits               (1) | Val  Loss: 0.8019 | Val  Acc: 0.7500
 Site-SynthDigits               (1) | Val  Loss: 0.8069 | Val  Acc: 0.7446
 Site-MNIST_M                   (0) | Val  Loss: 1.2157 | Val  Acc: 0.5870
 Site-MNIST_M                   (0) | Val  Loss: 1.1236 | Val  Acc: 0.6763
 Site-SVHN                      (3) | Val  Loss: 1.2892 | Val  Acc: 0.5652
 Site-SVHN                      (3) | Val  Loss: 1.3004 | Val  Acc: 0.5827
Average Valid Accuracy: 0.7223
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8478
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8561
 Best site-USPS                     (2)  | Epoch:8 | Val Acc: 0.7826
 Best site-USPS                     (2)  | Epoch:8 | Val Acc: 0.8309
 Best site-SynthDigits              (1)  | Epoch:8 | Val Acc: 0.7500
 Best site-SynthDigits              (1)  | Epoch:8 | Val Acc: 0.7446
 Best site-MNIST_M                  (0)  | Epoch:8 | Val Acc: 0.5870
 Best site-MNIST_M                  (0)  | Epoch:8 | Val Acc: 0.6763
 Best site-SVHN                     (3)  | Epoch:8 | Val Acc: 0.5652
 Best site-SVHN                     (3)  | Epoch:8 | Val Acc: 0.5827
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 4, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (0) | Train Loss: 0.4383 | Train Acc: 0.8949
 Site-MNIST                     (0) | Train Loss: 0.5247 | Train Acc: 0.8457
 Site-USPS                      (1) | Train Loss: 0.5109 | Train Acc: 0.8706
 Site-USPS                      (1) | Train Loss: 0.5250 | Train Acc: 0.8646
 Site-SynthDigits               (1) | Train Loss: 0.8357 | Train Acc: 0.7547
 Site-SynthDigits               (1) | Train Loss: 0.7527 | Train Acc: 0.7821
 Site-MNIST_M                   (2) | Train Loss: 1.0924 | Train Acc: 0.6631
 Site-MNIST_M                   (2) | Train Loss: 1.1052 | Train Acc: 0.6709
 Site-SVHN                      (3) | Train Loss: 1.2578 | Train Acc: 0.5714
 Site-SVHN                      (3) | Train Loss: 1.1862 | Train Acc: 0.6090
Average Train Accuracy: 0.7527
 Site-MNIST                     (0) | Val  Loss: 0.4484 | Val  Acc: 0.8370
 Site-MNIST                     (0) | Val  Loss: 0.5086 | Val  Acc: 0.8453
 Site-USPS                      (1) | Val  Loss: 0.6288 | Val  Acc: 0.7826
 Site-USPS                      (1) | Val  Loss: 0.5880 | Val  Acc: 0.8381
 Site-SynthDigits               (1) | Val  Loss: 0.8001 | Val  Acc: 0.7283
 Site-SynthDigits               (1) | Val  Loss: 0.7814 | Val  Acc: 0.7374
 Site-MNIST_M                   (2) | Val  Loss: 1.1724 | Val  Acc: 0.5761
 Site-MNIST_M                   (2) | Val  Loss: 1.0694 | Val  Acc: 0.6763
 Site-SVHN                      (3) | Val  Loss: 1.2205 | Val  Acc: 0.5761
 Site-SVHN                      (3) | Val  Loss: 1.2405 | Val  Acc: 0.5899
Average Valid Accuracy: 0.7187
============ Train epoch 10 ============
cnt=[4, 2, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (2) | Train Loss: 0.4232 | Train Acc: 0.8895
 Site-MNIST                     (2) | Train Loss: 0.5138 | Train Acc: 0.8439
 Site-USPS                      (0) | Train Loss: 0.5212 | Train Acc: 0.8571
 Site-USPS                      (0) | Train Loss: 0.5436 | Train Acc: 0.8556
 Site-SynthDigits               (0) | Train Loss: 0.7551 | Train Acc: 0.7898
 Site-SynthDigits               (0) | Train Loss: 0.6858 | Train Acc: 0.7991
 Site-MNIST_M                   (1) | Train Loss: 1.0310 | Train Acc: 0.6685
 Site-MNIST_M                   (1) | Train Loss: 1.0257 | Train Acc: 0.7067
 Site-SVHN                      (3) | Train Loss: 1.2393 | Train Acc: 0.5876
 Site-SVHN                      (3) | Train Loss: 1.1688 | Train Acc: 0.6242
Average Train Accuracy: 0.7622
 Site-MNIST                     (2) | Val  Loss: 0.4241 | Val  Acc: 0.8587
 Site-MNIST                     (2) | Val  Loss: 0.5017 | Val  Acc: 0.8525
 Site-USPS                      (0) | Val  Loss: 0.6366 | Val  Acc: 0.7826
 Site-USPS                      (0) | Val  Loss: 0.6004 | Val  Acc: 0.8273
 Site-SynthDigits               (0) | Val  Loss: 0.7034 | Val  Acc: 0.7500
 Site-SynthDigits               (0) | Val  Loss: 0.7183 | Val  Acc: 0.7554
 Site-MNIST_M                   (1) | Val  Loss: 1.0950 | Val  Acc: 0.6087
 Site-MNIST_M                   (1) | Val  Loss: 1.0057 | Val  Acc: 0.6871
 Site-SVHN                      (3) | Val  Loss: 1.1929 | Val  Acc: 0.5978
 Site-SVHN                      (3) | Val  Loss: 1.2069 | Val  Acc: 0.6079
Average Valid Accuracy: 0.7328
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.8587
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.8525
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.7826
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8273
 Best site-SynthDigits              (0)  | Epoch:10 | Val Acc: 0.7500
 Best site-SynthDigits              (0)  | Epoch:10 | Val Acc: 0.7554
 Best site-MNIST_M                  (1)  | Epoch:10 | Val Acc: 0.6087
 Best site-MNIST_M                  (1)  | Epoch:10 | Val Acc: 0.6871
 Best site-SVHN                     (3)  | Epoch:10 | Val Acc: 0.5978
 Best site-SVHN                     (3)  | Epoch:10 | Val Acc: 0.6079
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (0) | Train Loss: 0.3997 | Train Acc: 0.8949
 Site-MNIST                     (0) | Train Loss: 0.4924 | Train Acc: 0.8520
 Site-USPS                      (1) | Train Loss: 0.4629 | Train Acc: 0.8679
 Site-USPS                      (1) | Train Loss: 0.4925 | Train Acc: 0.8717
 Site-SynthDigits               (1) | Train Loss: 0.7312 | Train Acc: 0.7790
 Site-SynthDigits               (1) | Train Loss: 0.6590 | Train Acc: 0.8099
 Site-MNIST_M                   (2) | Train Loss: 1.0001 | Train Acc: 0.6792
 Site-MNIST_M                   (2) | Train Loss: 0.9961 | Train Acc: 0.7049
 Site-SVHN                      (3) | Train Loss: 1.1884 | Train Acc: 0.5957
 Site-SVHN                      (3) | Train Loss: 1.0909 | Train Acc: 0.6502
Average Train Accuracy: 0.7706
 Site-MNIST                     (0) | Val  Loss: 0.4023 | Val  Acc: 0.8478
 Site-MNIST                     (0) | Val  Loss: 0.4750 | Val  Acc: 0.8633
 Site-USPS                      (1) | Val  Loss: 0.5869 | Val  Acc: 0.8043
 Site-USPS                      (1) | Val  Loss: 0.5449 | Val  Acc: 0.8381
 Site-SynthDigits               (1) | Val  Loss: 0.6963 | Val  Acc: 0.7391
 Site-SynthDigits               (1) | Val  Loss: 0.6898 | Val  Acc: 0.7482
 Site-MNIST_M                   (2) | Val  Loss: 1.0646 | Val  Acc: 0.6413
 Site-MNIST_M                   (2) | Val  Loss: 0.9725 | Val  Acc: 0.7014
 Site-SVHN                      (3) | Val  Loss: 1.1202 | Val  Acc: 0.5978
 Site-SVHN                      (3) | Val  Loss: 1.1455 | Val  Acc: 0.6295
Average Valid Accuracy: 0.7411
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.8478
 Best site-MNIST                    (0)  | Epoch:11 | Val Acc: 0.8633
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.8043
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.8381
 Best site-SynthDigits              (1)  | Epoch:11 | Val Acc: 0.7391
 Best site-SynthDigits              (1)  | Epoch:11 | Val Acc: 0.7482
 Best site-MNIST_M                  (2)  | Epoch:11 | Val Acc: 0.6413
 Best site-MNIST_M                  (2)  | Epoch:11 | Val Acc: 0.7014
 Best site-SVHN                     (3)  | Epoch:11 | Val Acc: 0.5978
 Best site-SVHN                     (3)  | Epoch:11 | Val Acc: 0.6295
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 4, 2, 2, ]
cnt=[2, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (2) | Train Loss: 0.3760 | Train Acc: 0.8949
 Site-MNIST                     (2) | Train Loss: 0.4610 | Train Acc: 0.8565
 Site-USPS                      (1) | Train Loss: 0.4646 | Train Acc: 0.8571
 Site-USPS                      (1) | Train Loss: 0.4840 | Train Acc: 0.8601
 Site-SynthDigits               (1) | Train Loss: 0.6781 | Train Acc: 0.8086
 Site-SynthDigits               (1) | Train Loss: 0.6013 | Train Acc: 0.8152
 Site-MNIST_M                   (0) | Train Loss: 0.9626 | Train Acc: 0.6981
 Site-MNIST_M                   (0) | Train Loss: 0.9392 | Train Acc: 0.7291
 Site-SVHN                      (3) | Train Loss: 1.1332 | Train Acc: 0.6038
 Site-SVHN                      (3) | Train Loss: 1.0494 | Train Acc: 0.6556
Average Train Accuracy: 0.7779
 Site-MNIST                     (2) | Val  Loss: 0.3818 | Val  Acc: 0.8478
 Site-MNIST                     (2) | Val  Loss: 0.4556 | Val  Acc: 0.8561
 Site-USPS                      (1) | Val  Loss: 0.5846 | Val  Acc: 0.8043
 Site-USPS                      (1) | Val  Loss: 0.5430 | Val  Acc: 0.8453
 Site-SynthDigits               (1) | Val  Loss: 0.6390 | Val  Acc: 0.7717
 Site-SynthDigits               (1) | Val  Loss: 0.6432 | Val  Acc: 0.7842
 Site-MNIST_M                   (0) | Val  Loss: 1.0228 | Val  Acc: 0.6413
 Site-MNIST_M                   (0) | Val  Loss: 0.9251 | Val  Acc: 0.7122
 Site-SVHN                      (3) | Val  Loss: 1.0966 | Val  Acc: 0.5870
 Site-SVHN                      (3) | Val  Loss: 1.1025 | Val  Acc: 0.6439
Average Valid Accuracy: 0.7494
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.8478
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.8561
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.8043
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.8453
 Best site-SynthDigits              (1)  | Epoch:12 | Val Acc: 0.7717
 Best site-SynthDigits              (1)  | Epoch:12 | Val Acc: 0.7842
 Best site-MNIST_M                  (0)  | Epoch:12 | Val Acc: 0.6413
 Best site-MNIST_M                  (0)  | Epoch:12 | Val Acc: 0.7122
 Best site-SVHN                     (3)  | Epoch:12 | Val Acc: 0.5870
 Best site-SVHN                     (3)  | Epoch:12 | Val Acc: 0.6439
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 2, 4, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (3) | Train Loss: 0.3499 | Train Acc: 0.8976
 Site-MNIST                     (3) | Train Loss: 0.4324 | Train Acc: 0.8717
 Site-USPS                      (2) | Train Loss: 0.4264 | Train Acc: 0.8706
 Site-USPS                      (2) | Train Loss: 0.4418 | Train Acc: 0.8717
 Site-SynthDigits               (2) | Train Loss: 0.6599 | Train Acc: 0.8194
 Site-SynthDigits               (2) | Train Loss: 0.5844 | Train Acc: 0.8251
 Site-MNIST_M                   (1) | Train Loss: 0.9087 | Train Acc: 0.7251
 Site-MNIST_M                   (1) | Train Loss: 0.8973 | Train Acc: 0.7435
 Site-SVHN                      (0) | Train Loss: 1.1301 | Train Acc: 0.6065
 Site-SVHN                      (0) | Train Loss: 1.0299 | Train Acc: 0.6664
Average Train Accuracy: 0.7898
 Site-MNIST                     (3) | Val  Loss: 0.3447 | Val  Acc: 0.8587
 Site-MNIST                     (3) | Val  Loss: 0.4242 | Val  Acc: 0.8813
 Site-USPS                      (2) | Val  Loss: 0.5552 | Val  Acc: 0.8152
 Site-USPS                      (2) | Val  Loss: 0.5059 | Val  Acc: 0.8417
 Site-SynthDigits               (2) | Val  Loss: 0.6289 | Val  Acc: 0.7609
 Site-SynthDigits               (2) | Val  Loss: 0.6242 | Val  Acc: 0.7806
 Site-MNIST_M                   (1) | Val  Loss: 0.9694 | Val  Acc: 0.6957
 Site-MNIST_M                   (1) | Val  Loss: 0.8753 | Val  Acc: 0.7482
 Site-SVHN                      (0) | Val  Loss: 1.0641 | Val  Acc: 0.6413
 Site-SVHN                      (0) | Val  Loss: 1.0866 | Val  Acc: 0.6619
Average Valid Accuracy: 0.7685
 Best site-MNIST                    (3)  | Epoch:13 | Val Acc: 0.8587
 Best site-MNIST                    (3)  | Epoch:13 | Val Acc: 0.8813
 Best site-USPS                     (2)  | Epoch:13 | Val Acc: 0.8152
 Best site-USPS                     (2)  | Epoch:13 | Val Acc: 0.8417
 Best site-SynthDigits              (2)  | Epoch:13 | Val Acc: 0.7609
 Best site-SynthDigits              (2)  | Epoch:13 | Val Acc: 0.7806
 Best site-MNIST_M                  (1)  | Epoch:13 | Val Acc: 0.6957
 Best site-MNIST_M                  (1)  | Epoch:13 | Val Acc: 0.7482
 Best site-SVHN                     (0)  | Epoch:13 | Val Acc: 0.6413
 Best site-SVHN                     (0)  | Epoch:13 | Val Acc: 0.6619
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 2, 2, 4, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (1) | Train Loss: 0.3251 | Train Acc: 0.9003
 Site-MNIST                     (1) | Train Loss: 0.4049 | Train Acc: 0.8843
 Site-USPS                      (3) | Train Loss: 0.4231 | Train Acc: 0.8706
 Site-USPS                      (3) | Train Loss: 0.4376 | Train Acc: 0.8717
 Site-SynthDigits               (3) | Train Loss: 0.6239 | Train Acc: 0.8302
 Site-SynthDigits               (3) | Train Loss: 0.5545 | Train Acc: 0.8493
 Site-MNIST_M                   (2) | Train Loss: 0.8778 | Train Acc: 0.7305
 Site-MNIST_M                   (2) | Train Loss: 0.8596 | Train Acc: 0.7614
 Site-SVHN                      (0) | Train Loss: 1.0737 | Train Acc: 0.6334
 Site-SVHN                      (0) | Train Loss: 0.9881 | Train Acc: 0.6852
Average Train Accuracy: 0.8017
 Site-MNIST                     (1) | Val  Loss: 0.3230 | Val  Acc: 0.8804
 Site-MNIST                     (1) | Val  Loss: 0.4012 | Val  Acc: 0.8885
 Site-USPS                      (3) | Val  Loss: 0.5527 | Val  Acc: 0.8043
 Site-USPS                      (3) | Val  Loss: 0.4976 | Val  Acc: 0.8345
 Site-SynthDigits               (3) | Val  Loss: 0.5919 | Val  Acc: 0.8152
 Site-SynthDigits               (3) | Val  Loss: 0.5858 | Val  Acc: 0.8058
 Site-MNIST_M                   (2) | Val  Loss: 0.9233 | Val  Acc: 0.7065
 Site-MNIST_M                   (2) | Val  Loss: 0.8325 | Val  Acc: 0.7626
 Site-SVHN                      (0) | Val  Loss: 1.0289 | Val  Acc: 0.6630
 Site-SVHN                      (0) | Val  Loss: 1.0409 | Val  Acc: 0.6871
Average Valid Accuracy: 0.7848
 Best site-MNIST                    (1)  | Epoch:14 | Val Acc: 0.8804
 Best site-MNIST                    (1)  | Epoch:14 | Val Acc: 0.8885
 Best site-USPS                     (3)  | Epoch:14 | Val Acc: 0.8043
 Best site-USPS                     (3)  | Epoch:14 | Val Acc: 0.8345
 Best site-SynthDigits              (3)  | Epoch:14 | Val Acc: 0.8152
 Best site-SynthDigits              (3)  | Epoch:14 | Val Acc: 0.8058
 Best site-MNIST_M                  (2)  | Epoch:14 | Val Acc: 0.7065
 Best site-MNIST_M                  (2)  | Epoch:14 | Val Acc: 0.7626
 Best site-SVHN                     (0)  | Epoch:14 | Val Acc: 0.6630
 Best site-SVHN                     (0)  | Epoch:14 | Val Acc: 0.6871
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 4, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (2) | Train Loss: 0.3196 | Train Acc: 0.9084
 Site-MNIST                     (2) | Train Loss: 0.3952 | Train Acc: 0.8834
 Site-USPS                      (1) | Train Loss: 0.4229 | Train Acc: 0.8706
 Site-USPS                      (1) | Train Loss: 0.4317 | Train Acc: 0.8709
 Site-SynthDigits               (1) | Train Loss: 0.5944 | Train Acc: 0.8275
 Site-SynthDigits               (1) | Train Loss: 0.5359 | Train Acc: 0.8493
 Site-MNIST_M                   (0) | Train Loss: 0.8292 | Train Acc: 0.7493
 Site-MNIST_M                   (0) | Train Loss: 0.8091 | Train Acc: 0.7713
 Site-SVHN                      (3) | Train Loss: 1.0573 | Train Acc: 0.6361
 Site-SVHN                      (3) | Train Loss: 0.9854 | Train Acc: 0.6735
Average Train Accuracy: 0.8040
 Site-MNIST                     (2) | Val  Loss: 0.3135 | Val  Acc: 0.8913
 Site-MNIST                     (2) | Val  Loss: 0.3913 | Val  Acc: 0.8957
 Site-USPS                      (1) | Val  Loss: 0.5369 | Val  Acc: 0.8043
 Site-USPS                      (1) | Val  Loss: 0.4889 | Val  Acc: 0.8453
 Site-SynthDigits               (1) | Val  Loss: 0.5623 | Val  Acc: 0.8152
 Site-SynthDigits               (1) | Val  Loss: 0.5667 | Val  Acc: 0.8094
 Site-MNIST_M                   (0) | Val  Loss: 0.8887 | Val  Acc: 0.6957
 Site-MNIST_M                   (0) | Val  Loss: 0.7875 | Val  Acc: 0.7770
 Site-SVHN                      (3) | Val  Loss: 1.0373 | Val  Acc: 0.6630
 Site-SVHN                      (3) | Val  Loss: 1.0263 | Val  Acc: 0.6763
Average Valid Accuracy: 0.7873
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8913
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8957
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.8043
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.8453
 Best site-SynthDigits              (1)  | Epoch:15 | Val Acc: 0.8152
 Best site-SynthDigits              (1)  | Epoch:15 | Val Acc: 0.8094
 Best site-MNIST_M                  (0)  | Epoch:15 | Val Acc: 0.6957
 Best site-MNIST_M                  (0)  | Epoch:15 | Val Acc: 0.7770
 Best site-SVHN                     (3)  | Epoch:15 | Val Acc: 0.6630
 Best site-SVHN                     (3)  | Epoch:15 | Val Acc: 0.6763
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 16 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (2) | Train Loss: 0.3052 | Train Acc: 0.9057
 Site-MNIST                     (2) | Train Loss: 0.3852 | Train Acc: 0.8870
 Site-USPS                      (0) | Train Loss: 0.4022 | Train Acc: 0.8706
 Site-USPS                      (0) | Train Loss: 0.4187 | Train Acc: 0.8825
 Site-SynthDigits               (0) | Train Loss: 0.5848 | Train Acc: 0.8329
 Site-SynthDigits               (0) | Train Loss: 0.5278 | Train Acc: 0.8547
 Site-MNIST_M                   (1) | Train Loss: 0.8207 | Train Acc: 0.7385
 Site-MNIST_M                   (1) | Train Loss: 0.7912 | Train Acc: 0.7812
 Site-SVHN                      (3) | Train Loss: 1.0187 | Train Acc: 0.6550
 Site-SVHN                      (3) | Train Loss: 0.9216 | Train Acc: 0.7103
Average Train Accuracy: 0.8118
 Site-MNIST                     (2) | Val  Loss: 0.2981 | Val  Acc: 0.9022
 Site-MNIST                     (2) | Val  Loss: 0.3782 | Val  Acc: 0.8885
 Site-USPS                      (0) | Val  Loss: 0.5265 | Val  Acc: 0.8043
 Site-USPS                      (0) | Val  Loss: 0.4677 | Val  Acc: 0.8381
 Site-SynthDigits               (0) | Val  Loss: 0.5598 | Val  Acc: 0.8370
 Site-SynthDigits               (0) | Val  Loss: 0.5526 | Val  Acc: 0.8201
 Site-MNIST_M                   (1) | Val  Loss: 0.8659 | Val  Acc: 0.7283
 Site-MNIST_M                   (1) | Val  Loss: 0.7732 | Val  Acc: 0.7662
 Site-SVHN                      (3) | Val  Loss: 0.9566 | Val  Acc: 0.7283
 Site-SVHN                      (3) | Val  Loss: 0.9713 | Val  Acc: 0.7158
Average Valid Accuracy: 0.8029
 Best site-MNIST                    (2)  | Epoch:16 | Val Acc: 0.9022
 Best site-MNIST                    (2)  | Epoch:16 | Val Acc: 0.8885
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.8043
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.8381
 Best site-SynthDigits              (0)  | Epoch:16 | Val Acc: 0.8370
 Best site-SynthDigits              (0)  | Epoch:16 | Val Acc: 0.8201
 Best site-MNIST_M                  (1)  | Epoch:16 | Val Acc: 0.7283
 Best site-MNIST_M                  (1)  | Epoch:16 | Val Acc: 0.7662
 Best site-SVHN                     (3)  | Epoch:16 | Val Acc: 0.7283
 Best site-SVHN                     (3)  | Epoch:16 | Val Acc: 0.7158
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 17 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (2) | Train Loss: 0.2890 | Train Acc: 0.9084
 Site-MNIST                     (2) | Train Loss: 0.3629 | Train Acc: 0.8942
 Site-USPS                      (0) | Train Loss: 0.3734 | Train Acc: 0.8760
 Site-USPS                      (0) | Train Loss: 0.3902 | Train Acc: 0.8861
 Site-SynthDigits               (0) | Train Loss: 0.5807 | Train Acc: 0.8302
 Site-SynthDigits               (0) | Train Loss: 0.5238 | Train Acc: 0.8547
 Site-MNIST_M                   (1) | Train Loss: 0.7846 | Train Acc: 0.7439
 Site-MNIST_M                   (1) | Train Loss: 0.7569 | Train Acc: 0.7865
 Site-SVHN                      (3) | Train Loss: 1.0062 | Train Acc: 0.6523
 Site-SVHN                      (3) | Train Loss: 0.8959 | Train Acc: 0.7067
Average Train Accuracy: 0.8139
 Site-MNIST                     (2) | Val  Loss: 0.2846 | Val  Acc: 0.8913
 Site-MNIST                     (2) | Val  Loss: 0.3641 | Val  Acc: 0.8921
 Site-USPS                      (0) | Val  Loss: 0.5067 | Val  Acc: 0.8152
 Site-USPS                      (0) | Val  Loss: 0.4465 | Val  Acc: 0.8489
 Site-SynthDigits               (0) | Val  Loss: 0.5588 | Val  Acc: 0.8261
 Site-SynthDigits               (0) | Val  Loss: 0.5485 | Val  Acc: 0.8129
 Site-MNIST_M                   (1) | Val  Loss: 0.8371 | Val  Acc: 0.7391
 Site-MNIST_M                   (1) | Val  Loss: 0.7515 | Val  Acc: 0.7770
 Site-SVHN                      (3) | Val  Loss: 0.9321 | Val  Acc: 0.7391
 Site-SVHN                      (3) | Val  Loss: 0.9479 | Val  Acc: 0.7014
Average Valid Accuracy: 0.8043
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.8913
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.8921
 Best site-USPS                     (0)  | Epoch:17 | Val Acc: 0.8152
 Best site-USPS                     (0)  | Epoch:17 | Val Acc: 0.8489
 Best site-SynthDigits              (0)  | Epoch:17 | Val Acc: 0.8261
 Best site-SynthDigits              (0)  | Epoch:17 | Val Acc: 0.8129
 Best site-MNIST_M                  (1)  | Epoch:17 | Val Acc: 0.7391
 Best site-MNIST_M                  (1)  | Epoch:17 | Val Acc: 0.7770
 Best site-SVHN                     (3)  | Epoch:17 | Val Acc: 0.7391
 Best site-SVHN                     (3)  | Epoch:17 | Val Acc: 0.7014
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 18 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (0) | Train Loss: 0.2870 | Train Acc: 0.9084
 Site-MNIST                     (0) | Train Loss: 0.3568 | Train Acc: 0.8924
 Site-USPS                      (1) | Train Loss: 0.3789 | Train Acc: 0.8787
 Site-USPS                      (1) | Train Loss: 0.3800 | Train Acc: 0.8906
 Site-SynthDigits               (1) | Train Loss: 0.5486 | Train Acc: 0.8437
 Site-SynthDigits               (1) | Train Loss: 0.4927 | Train Acc: 0.8700
 Site-MNIST_M                   (2) | Train Loss: 0.7587 | Train Acc: 0.7628
 Site-MNIST_M                   (2) | Train Loss: 0.7194 | Train Acc: 0.8063
 Site-SVHN                      (3) | Train Loss: 0.9801 | Train Acc: 0.6658
 Site-SVHN                      (3) | Train Loss: 0.8905 | Train Acc: 0.7139
Average Train Accuracy: 0.8232
 Site-MNIST                     (0) | Val  Loss: 0.2770 | Val  Acc: 0.9022
 Site-MNIST                     (0) | Val  Loss: 0.3580 | Val  Acc: 0.9029
 Site-USPS                      (1) | Val  Loss: 0.4983 | Val  Acc: 0.8043
 Site-USPS                      (1) | Val  Loss: 0.4396 | Val  Acc: 0.8417
 Site-SynthDigits               (1) | Val  Loss: 0.5205 | Val  Acc: 0.8261
 Site-SynthDigits               (1) | Val  Loss: 0.5131 | Val  Acc: 0.8381
 Site-MNIST_M                   (2) | Val  Loss: 0.7969 | Val  Acc: 0.7717
 Site-MNIST_M                   (2) | Val  Loss: 0.7175 | Val  Acc: 0.7842
 Site-SVHN                      (3) | Val  Loss: 0.9254 | Val  Acc: 0.7500
 Site-SVHN                      (3) | Val  Loss: 0.9320 | Val  Acc: 0.7194
Average Valid Accuracy: 0.8141
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9022
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9029
 Best site-USPS                     (1)  | Epoch:18 | Val Acc: 0.8043
 Best site-USPS                     (1)  | Epoch:18 | Val Acc: 0.8417
 Best site-SynthDigits              (1)  | Epoch:18 | Val Acc: 0.8261
 Best site-SynthDigits              (1)  | Epoch:18 | Val Acc: 0.8381
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.7717
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.7842
 Best site-SVHN                     (3)  | Epoch:18 | Val Acc: 0.7500
 Best site-SVHN                     (3)  | Epoch:18 | Val Acc: 0.7194
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 4, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (2) | Train Loss: 0.2741 | Train Acc: 0.9111
 Site-MNIST                     (2) | Train Loss: 0.3507 | Train Acc: 0.8924
 Site-USPS                      (1) | Train Loss: 0.3647 | Train Acc: 0.8841
 Site-USPS                      (1) | Train Loss: 0.3801 | Train Acc: 0.8870
 Site-SynthDigits               (1) | Train Loss: 0.5415 | Train Acc: 0.8518
 Site-SynthDigits               (1) | Train Loss: 0.4927 | Train Acc: 0.8646
 Site-MNIST_M                   (0) | Train Loss: 0.7395 | Train Acc: 0.7601
 Site-MNIST_M                   (0) | Train Loss: 0.7136 | Train Acc: 0.8018
 Site-SVHN                      (3) | Train Loss: 0.9844 | Train Acc: 0.6685
 Site-SVHN                      (3) | Train Loss: 0.8866 | Train Acc: 0.7103
Average Train Accuracy: 0.8232
 Site-MNIST                     (2) | Val  Loss: 0.2756 | Val  Acc: 0.8913
 Site-MNIST                     (2) | Val  Loss: 0.3535 | Val  Acc: 0.8921
 Site-USPS                      (1) | Val  Loss: 0.4896 | Val  Acc: 0.7935
 Site-USPS                      (1) | Val  Loss: 0.4333 | Val  Acc: 0.8525
 Site-SynthDigits               (1) | Val  Loss: 0.5125 | Val  Acc: 0.8261
 Site-SynthDigits               (1) | Val  Loss: 0.5130 | Val  Acc: 0.8273
 Site-MNIST_M                   (0) | Val  Loss: 0.7806 | Val  Acc: 0.7391
 Site-MNIST_M                   (0) | Val  Loss: 0.6956 | Val  Acc: 0.8022
 Site-SVHN                      (3) | Val  Loss: 0.9101 | Val  Acc: 0.7283
 Site-SVHN                      (3) | Val  Loss: 0.9268 | Val  Acc: 0.7158
Average Valid Accuracy: 0.8068
============ Train epoch 20 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (2) | Train Loss: 0.2663 | Train Acc: 0.9164
 Site-MNIST                     (2) | Train Loss: 0.3432 | Train Acc: 0.8915
 Site-USPS                      (0) | Train Loss: 0.3585 | Train Acc: 0.8895
 Site-USPS                      (0) | Train Loss: 0.3586 | Train Acc: 0.8960
 Site-SynthDigits               (0) | Train Loss: 0.5356 | Train Acc: 0.8410
 Site-SynthDigits               (0) | Train Loss: 0.4838 | Train Acc: 0.8601
 Site-MNIST_M                   (1) | Train Loss: 0.7240 | Train Acc: 0.7655
 Site-MNIST_M                   (1) | Train Loss: 0.6925 | Train Acc: 0.8054
 Site-SVHN                      (3) | Train Loss: 0.9543 | Train Acc: 0.6712
 Site-SVHN                      (3) | Train Loss: 0.8454 | Train Acc: 0.7283
Average Train Accuracy: 0.8265
 Site-MNIST                     (2) | Val  Loss: 0.2675 | Val  Acc: 0.9022
 Site-MNIST                     (2) | Val  Loss: 0.3440 | Val  Acc: 0.8885
 Site-USPS                      (0) | Val  Loss: 0.4702 | Val  Acc: 0.8152
 Site-USPS                      (0) | Val  Loss: 0.4161 | Val  Acc: 0.8633
 Site-SynthDigits               (0) | Val  Loss: 0.5142 | Val  Acc: 0.8370
 Site-SynthDigits               (0) | Val  Loss: 0.5006 | Val  Acc: 0.8345
 Site-MNIST_M                   (1) | Val  Loss: 0.7745 | Val  Acc: 0.7391
 Site-MNIST_M                   (1) | Val  Loss: 0.6869 | Val  Acc: 0.7986
 Site-SVHN                      (3) | Val  Loss: 0.8706 | Val  Acc: 0.7391
 Site-SVHN                      (3) | Val  Loss: 0.8980 | Val  Acc: 0.7122
Average Valid Accuracy: 0.8130
============ Train epoch 21 ============
cnt=[2, 2, 2, 4, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (2) | Train Loss: 0.2587 | Train Acc: 0.9299
 Site-MNIST                     (2) | Train Loss: 0.3242 | Train Acc: 0.9022
 Site-USPS                      (1) | Train Loss: 0.3585 | Train Acc: 0.8868
 Site-USPS                      (1) | Train Loss: 0.3742 | Train Acc: 0.8906
 Site-SynthDigits               (3) | Train Loss: 0.4898 | Train Acc: 0.8598
 Site-SynthDigits               (3) | Train Loss: 0.4487 | Train Acc: 0.8807
 Site-MNIST_M                   (0) | Train Loss: 0.7081 | Train Acc: 0.7709
 Site-MNIST_M                   (0) | Train Loss: 0.6611 | Train Acc: 0.8161
 Site-SVHN                      (3) | Train Loss: 0.9533 | Train Acc: 0.6658
 Site-SVHN                      (3) | Train Loss: 0.8519 | Train Acc: 0.7238
Average Train Accuracy: 0.8327
 Site-MNIST                     (2) | Val  Loss: 0.2481 | Val  Acc: 0.9130
 Site-MNIST                     (2) | Val  Loss: 0.3329 | Val  Acc: 0.9245
 Site-USPS                      (1) | Val  Loss: 0.4775 | Val  Acc: 0.8261
 Site-USPS                      (1) | Val  Loss: 0.4223 | Val  Acc: 0.8633
 Site-SynthDigits               (3) | Val  Loss: 0.4661 | Val  Acc: 0.8370
 Site-SynthDigits               (3) | Val  Loss: 0.4625 | Val  Acc: 0.8525
 Site-MNIST_M                   (0) | Val  Loss: 0.7396 | Val  Acc: 0.7717
 Site-MNIST_M                   (0) | Val  Loss: 0.6557 | Val  Acc: 0.8094
 Site-SVHN                      (3) | Val  Loss: 0.8865 | Val  Acc: 0.7391
 Site-SVHN                      (3) | Val  Loss: 0.8969 | Val  Acc: 0.7086
Average Valid Accuracy: 0.8245
 Best site-MNIST                    (2)  | Epoch:21 | Val Acc: 0.9130
 Best site-MNIST                    (2)  | Epoch:21 | Val Acc: 0.9245
 Best site-USPS                     (1)  | Epoch:21 | Val Acc: 0.8261
 Best site-USPS                     (1)  | Epoch:21 | Val Acc: 0.8633
 Best site-SynthDigits              (3)  | Epoch:21 | Val Acc: 0.8370
 Best site-SynthDigits              (3)  | Epoch:21 | Val Acc: 0.8525
 Best site-MNIST_M                  (0)  | Epoch:21 | Val Acc: 0.7717
 Best site-MNIST_M                  (0)  | Epoch:21 | Val Acc: 0.8094
 Best site-SVHN                     (3)  | Epoch:21 | Val Acc: 0.7391
 Best site-SVHN                     (3)  | Epoch:21 | Val Acc: 0.7086
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 22 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (1) | Train Loss: 0.2604 | Train Acc: 0.9218
 Site-MNIST                     (1) | Train Loss: 0.3244 | Train Acc: 0.9004
 Site-USPS                      (0) | Train Loss: 0.3502 | Train Acc: 0.8895
 Site-USPS                      (0) | Train Loss: 0.3505 | Train Acc: 0.8924
 Site-SynthDigits               (0) | Train Loss: 0.4846 | Train Acc: 0.8652
 Site-SynthDigits               (0) | Train Loss: 0.4337 | Train Acc: 0.8825
 Site-MNIST_M                   (2) | Train Loss: 0.6917 | Train Acc: 0.7790
 Site-MNIST_M                   (2) | Train Loss: 0.6525 | Train Acc: 0.8188
 Site-SVHN                      (3) | Train Loss: 0.9441 | Train Acc: 0.6712
 Site-SVHN                      (3) | Train Loss: 0.8532 | Train Acc: 0.7229
Average Train Accuracy: 0.8344
 Site-MNIST                     (1) | Val  Loss: 0.2489 | Val  Acc: 0.9239
 Site-MNIST                     (1) | Val  Loss: 0.3294 | Val  Acc: 0.9137
 Site-USPS                      (0) | Val  Loss: 0.4534 | Val  Acc: 0.8043
 Site-USPS                      (0) | Val  Loss: 0.4026 | Val  Acc: 0.8525
 Site-SynthDigits               (0) | Val  Loss: 0.4542 | Val  Acc: 0.8261
 Site-SynthDigits               (0) | Val  Loss: 0.4560 | Val  Acc: 0.8453
 Site-MNIST_M                   (2) | Val  Loss: 0.7202 | Val  Acc: 0.7717
 Site-MNIST_M                   (2) | Val  Loss: 0.6419 | Val  Acc: 0.8273
 Site-SVHN                      (3) | Val  Loss: 0.8652 | Val  Acc: 0.7283
 Site-SVHN                      (3) | Val  Loss: 0.8890 | Val  Acc: 0.7194
Average Valid Accuracy: 0.8213
============ Train epoch 23 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (2) | Train Loss: 0.2441 | Train Acc: 0.9272
 Site-MNIST                     (2) | Train Loss: 0.3089 | Train Acc: 0.9121
 Site-USPS                      (0) | Train Loss: 0.3347 | Train Acc: 0.8949
 Site-USPS                      (0) | Train Loss: 0.3356 | Train Acc: 0.8978
 Site-SynthDigits               (0) | Train Loss: 0.4982 | Train Acc: 0.8625
 Site-SynthDigits               (0) | Train Loss: 0.4451 | Train Acc: 0.8789
 Site-MNIST_M                   (1) | Train Loss: 0.7026 | Train Acc: 0.7628
 Site-MNIST_M                   (1) | Train Loss: 0.6672 | Train Acc: 0.8072
 Site-SVHN                      (3) | Train Loss: 0.9236 | Train Acc: 0.6873
 Site-SVHN                      (3) | Train Loss: 0.7966 | Train Acc: 0.7462
Average Train Accuracy: 0.8377
 Site-MNIST                     (2) | Val  Loss: 0.2314 | Val  Acc: 0.9348
 Site-MNIST                     (2) | Val  Loss: 0.3167 | Val  Acc: 0.9281
 Site-USPS                      (0) | Val  Loss: 0.4449 | Val  Acc: 0.8152
 Site-USPS                      (0) | Val  Loss: 0.3883 | Val  Acc: 0.8597
 Site-SynthDigits               (0) | Val  Loss: 0.4674 | Val  Acc: 0.8370
 Site-SynthDigits               (0) | Val  Loss: 0.4579 | Val  Acc: 0.8453
 Site-MNIST_M                   (1) | Val  Loss: 0.7300 | Val  Acc: 0.7609
 Site-MNIST_M                   (1) | Val  Loss: 0.6557 | Val  Acc: 0.8094
 Site-SVHN                      (3) | Val  Loss: 0.8227 | Val  Acc: 0.7174
 Site-SVHN                      (3) | Val  Loss: 0.8516 | Val  Acc: 0.7266
Average Valid Accuracy: 0.8234
============ Train epoch 24 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (3) | Train Loss: 0.2419 | Train Acc: 0.9245
 Site-MNIST                     (3) | Train Loss: 0.3095 | Train Acc: 0.9085
 Site-USPS                      (0) | Train Loss: 0.3225 | Train Acc: 0.9111
 Site-USPS                      (0) | Train Loss: 0.3242 | Train Acc: 0.9058
 Site-SynthDigits               (0) | Train Loss: 0.4715 | Train Acc: 0.8733
 Site-SynthDigits               (0) | Train Loss: 0.4235 | Train Acc: 0.8879
 Site-MNIST_M                   (1) | Train Loss: 0.6757 | Train Acc: 0.7709
 Site-MNIST_M                   (1) | Train Loss: 0.6296 | Train Acc: 0.8233
 Site-SVHN                      (2) | Train Loss: 0.9299 | Train Acc: 0.6900
 Site-SVHN                      (2) | Train Loss: 0.7997 | Train Acc: 0.7345
Average Train Accuracy: 0.8430
 Site-MNIST                     (3) | Val  Loss: 0.2285 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.3081 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.4280 | Val  Acc: 0.8370
 Site-USPS                      (0) | Val  Loss: 0.3747 | Val  Acc: 0.8741
 Site-SynthDigits               (0) | Val  Loss: 0.4427 | Val  Acc: 0.8370
 Site-SynthDigits               (0) | Val  Loss: 0.4350 | Val  Acc: 0.8525
 Site-MNIST_M                   (1) | Val  Loss: 0.6972 | Val  Acc: 0.7717
 Site-MNIST_M                   (1) | Val  Loss: 0.6258 | Val  Acc: 0.8129
 Site-SVHN                      (2) | Val  Loss: 0.8377 | Val  Acc: 0.7174
 Site-SVHN                      (2) | Val  Loss: 0.8560 | Val  Acc: 0.7230
Average Valid Accuracy: 0.8292
 Best site-MNIST                    (3)  | Epoch:24 | Val Acc: 0.9348
 Best site-MNIST                    (3)  | Epoch:24 | Val Acc: 0.9317
 Best site-USPS                     (0)  | Epoch:24 | Val Acc: 0.8370
 Best site-USPS                     (0)  | Epoch:24 | Val Acc: 0.8741
 Best site-SynthDigits              (0)  | Epoch:24 | Val Acc: 0.8370
 Best site-SynthDigits              (0)  | Epoch:24 | Val Acc: 0.8525
 Best site-MNIST_M                  (1)  | Epoch:24 | Val Acc: 0.7717
 Best site-MNIST_M                  (1)  | Epoch:24 | Val Acc: 0.8129
 Best site-SVHN                     (2)  | Epoch:24 | Val Acc: 0.7174
 Best site-SVHN                     (2)  | Epoch:24 | Val Acc: 0.7230
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 25 ============
cnt=[4, 2, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (1) | Train Loss: 0.2332 | Train Acc: 0.9353
 Site-MNIST                     (1) | Train Loss: 0.2982 | Train Acc: 0.9103
 Site-USPS                      (0) | Train Loss: 0.3244 | Train Acc: 0.8895
 Site-USPS                      (0) | Train Loss: 0.3259 | Train Acc: 0.9067
 Site-SynthDigits               (0) | Train Loss: 0.4686 | Train Acc: 0.8625
 Site-SynthDigits               (0) | Train Loss: 0.4232 | Train Acc: 0.8825
 Site-MNIST_M                   (2) | Train Loss: 0.6687 | Train Acc: 0.7736
 Site-MNIST_M                   (2) | Train Loss: 0.6284 | Train Acc: 0.8179
 Site-SVHN                      (3) | Train Loss: 0.9047 | Train Acc: 0.6954
 Site-SVHN                      (3) | Train Loss: 0.7760 | Train Acc: 0.7525
Average Train Accuracy: 0.8426
 Site-MNIST                     (1) | Val  Loss: 0.2238 | Val  Acc: 0.9239
 Site-MNIST                     (1) | Val  Loss: 0.3010 | Val  Acc: 0.9173
 Site-USPS                      (0) | Val  Loss: 0.4308 | Val  Acc: 0.8370
 Site-USPS                      (0) | Val  Loss: 0.3737 | Val  Acc: 0.8705
 Site-SynthDigits               (0) | Val  Loss: 0.4460 | Val  Acc: 0.8478
 Site-SynthDigits               (0) | Val  Loss: 0.4382 | Val  Acc: 0.8453
 Site-MNIST_M                   (2) | Val  Loss: 0.6944 | Val  Acc: 0.7935
 Site-MNIST_M                   (2) | Val  Loss: 0.6179 | Val  Acc: 0.8129
 Site-SVHN                      (3) | Val  Loss: 0.8170 | Val  Acc: 0.7609
 Site-SVHN                      (3) | Val  Loss: 0.8354 | Val  Acc: 0.7374
Average Valid Accuracy: 0.8346
 Best site-MNIST                    (1)  | Epoch:25 | Val Acc: 0.9239
 Best site-MNIST                    (1)  | Epoch:25 | Val Acc: 0.9173
 Best site-USPS                     (0)  | Epoch:25 | Val Acc: 0.8370
 Best site-USPS                     (0)  | Epoch:25 | Val Acc: 0.8705
 Best site-SynthDigits              (0)  | Epoch:25 | Val Acc: 0.8478
 Best site-SynthDigits              (0)  | Epoch:25 | Val Acc: 0.8453
 Best site-MNIST_M                  (2)  | Epoch:25 | Val Acc: 0.7935
 Best site-MNIST_M                  (2)  | Epoch:25 | Val Acc: 0.8129
 Best site-SVHN                     (3)  | Epoch:25 | Val Acc: 0.7609
 Best site-SVHN                     (3)  | Epoch:25 | Val Acc: 0.7374
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 26 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (1) | Train Loss: 0.2341 | Train Acc: 0.9299
 Site-MNIST                     (1) | Train Loss: 0.2992 | Train Acc: 0.9130
 Site-USPS                      (0) | Train Loss: 0.3053 | Train Acc: 0.9111
 Site-USPS                      (0) | Train Loss: 0.3077 | Train Acc: 0.9112
 Site-SynthDigits               (0) | Train Loss: 0.4736 | Train Acc: 0.8652
 Site-SynthDigits               (0) | Train Loss: 0.4232 | Train Acc: 0.8870
 Site-MNIST_M                   (2) | Train Loss: 0.6626 | Train Acc: 0.7790
 Site-MNIST_M                   (2) | Train Loss: 0.6125 | Train Acc: 0.8233
 Site-SVHN                      (3) | Train Loss: 0.9062 | Train Acc: 0.6792
 Site-SVHN                      (3) | Train Loss: 0.7790 | Train Acc: 0.7552
Average Train Accuracy: 0.8454
 Site-MNIST                     (1) | Val  Loss: 0.2234 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.3010 | Val  Acc: 0.9245
 Site-USPS                      (0) | Val  Loss: 0.4173 | Val  Acc: 0.8370
 Site-USPS                      (0) | Val  Loss: 0.3560 | Val  Acc: 0.8741
 Site-SynthDigits               (0) | Val  Loss: 0.4382 | Val  Acc: 0.8478
 Site-SynthDigits               (0) | Val  Loss: 0.4332 | Val  Acc: 0.8633
 Site-MNIST_M                   (2) | Val  Loss: 0.6708 | Val  Acc: 0.7935
 Site-MNIST_M                   (2) | Val  Loss: 0.6047 | Val  Acc: 0.8129
 Site-SVHN                      (3) | Val  Loss: 0.8021 | Val  Acc: 0.7609
 Site-SVHN                      (3) | Val  Loss: 0.8266 | Val  Acc: 0.7338
Average Valid Accuracy: 0.8393
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.9457
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.9245
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.8370
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.8741
 Best site-SynthDigits              (0)  | Epoch:26 | Val Acc: 0.8478
 Best site-SynthDigits              (0)  | Epoch:26 | Val Acc: 0.8633
 Best site-MNIST_M                  (2)  | Epoch:26 | Val Acc: 0.7935
 Best site-MNIST_M                  (2)  | Epoch:26 | Val Acc: 0.8129
 Best site-SVHN                     (3)  | Epoch:26 | Val Acc: 0.7609
 Best site-SVHN                     (3)  | Epoch:26 | Val Acc: 0.7338
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 27 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (2) | Train Loss: 0.2398 | Train Acc: 0.9326
 Site-MNIST                     (2) | Train Loss: 0.2928 | Train Acc: 0.9130
 Site-USPS                      (1) | Train Loss: 0.3048 | Train Acc: 0.9003
 Site-USPS                      (1) | Train Loss: 0.3040 | Train Acc: 0.9121
 Site-SynthDigits               (1) | Train Loss: 0.4540 | Train Acc: 0.8652
 Site-SynthDigits               (1) | Train Loss: 0.4084 | Train Acc: 0.8906
 Site-MNIST_M                   (0) | Train Loss: 0.6519 | Train Acc: 0.7844
 Site-MNIST_M                   (0) | Train Loss: 0.6009 | Train Acc: 0.8332
 Site-SVHN                      (3) | Train Loss: 0.8999 | Train Acc: 0.7035
 Site-SVHN                      (3) | Train Loss: 0.7526 | Train Acc: 0.7713
Average Train Accuracy: 0.8506
 Site-MNIST                     (2) | Val  Loss: 0.2212 | Val  Acc: 0.9457
 Site-MNIST                     (2) | Val  Loss: 0.3011 | Val  Acc: 0.9281
 Site-USPS                      (1) | Val  Loss: 0.4087 | Val  Acc: 0.8370
 Site-USPS                      (1) | Val  Loss: 0.3521 | Val  Acc: 0.8705
 Site-SynthDigits               (1) | Val  Loss: 0.4302 | Val  Acc: 0.8587
 Site-SynthDigits               (1) | Val  Loss: 0.4163 | Val  Acc: 0.8597
 Site-MNIST_M                   (0) | Val  Loss: 0.6770 | Val  Acc: 0.7935
 Site-MNIST_M                   (0) | Val  Loss: 0.6017 | Val  Acc: 0.8165
 Site-SVHN                      (3) | Val  Loss: 0.7830 | Val  Acc: 0.7935
 Site-SVHN                      (3) | Val  Loss: 0.8087 | Val  Acc: 0.7554
Average Valid Accuracy: 0.8458
 Best site-MNIST                    (2)  | Epoch:27 | Val Acc: 0.9457
 Best site-MNIST                    (2)  | Epoch:27 | Val Acc: 0.9281
 Best site-USPS                     (1)  | Epoch:27 | Val Acc: 0.8370
 Best site-USPS                     (1)  | Epoch:27 | Val Acc: 0.8705
 Best site-SynthDigits              (1)  | Epoch:27 | Val Acc: 0.8587
 Best site-SynthDigits              (1)  | Epoch:27 | Val Acc: 0.8597
 Best site-MNIST_M                  (0)  | Epoch:27 | Val Acc: 0.7935
 Best site-MNIST_M                  (0)  | Epoch:27 | Val Acc: 0.8165
 Best site-SVHN                     (3)  | Epoch:27 | Val Acc: 0.7935
 Best site-SVHN                     (3)  | Epoch:27 | Val Acc: 0.7554
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 28 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (2) | Train Loss: 0.2367 | Train Acc: 0.9299
 Site-MNIST                     (2) | Train Loss: 0.2980 | Train Acc: 0.9121
 Site-USPS                      (1) | Train Loss: 0.3059 | Train Acc: 0.9003
 Site-USPS                      (1) | Train Loss: 0.3080 | Train Acc: 0.9130
 Site-SynthDigits               (1) | Train Loss: 0.4290 | Train Acc: 0.8760
 Site-SynthDigits               (1) | Train Loss: 0.3847 | Train Acc: 0.8978
 Site-MNIST_M                   (0) | Train Loss: 0.6361 | Train Acc: 0.7925
 Site-MNIST_M                   (0) | Train Loss: 0.5827 | Train Acc: 0.8368
 Site-SVHN                      (3) | Train Loss: 0.8858 | Train Acc: 0.7062
 Site-SVHN                      (3) | Train Loss: 0.7577 | Train Acc: 0.7668
Average Train Accuracy: 0.8531
 Site-MNIST                     (2) | Val  Loss: 0.2223 | Val  Acc: 0.9239
 Site-MNIST                     (2) | Val  Loss: 0.3074 | Val  Acc: 0.9209
 Site-USPS                      (1) | Val  Loss: 0.4172 | Val  Acc: 0.8478
 Site-USPS                      (1) | Val  Loss: 0.3621 | Val  Acc: 0.8777
 Site-SynthDigits               (1) | Val  Loss: 0.3987 | Val  Acc: 0.8696
 Site-SynthDigits               (1) | Val  Loss: 0.4001 | Val  Acc: 0.8705
 Site-MNIST_M                   (0) | Val  Loss: 0.6550 | Val  Acc: 0.8152
 Site-MNIST_M                   (0) | Val  Loss: 0.5908 | Val  Acc: 0.8165
 Site-SVHN                      (3) | Val  Loss: 0.7934 | Val  Acc: 0.7935
 Site-SVHN                      (3) | Val  Loss: 0.8019 | Val  Acc: 0.7554
Average Valid Accuracy: 0.8491
 Best site-MNIST                    (2)  | Epoch:28 | Val Acc: 0.9239
 Best site-MNIST                    (2)  | Epoch:28 | Val Acc: 0.9209
 Best site-USPS                     (1)  | Epoch:28 | Val Acc: 0.8478
 Best site-USPS                     (1)  | Epoch:28 | Val Acc: 0.8777
 Best site-SynthDigits              (1)  | Epoch:28 | Val Acc: 0.8696
 Best site-SynthDigits              (1)  | Epoch:28 | Val Acc: 0.8705
 Best site-MNIST_M                  (0)  | Epoch:28 | Val Acc: 0.8152
 Best site-MNIST_M                  (0)  | Epoch:28 | Val Acc: 0.8165
 Best site-SVHN                     (3)  | Epoch:28 | Val Acc: 0.7935
 Best site-SVHN                     (3)  | Epoch:28 | Val Acc: 0.7554
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 29 ============
cnt=[4, 2, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (2) | Train Loss: 0.2325 | Train Acc: 0.9407
 Site-MNIST                     (2) | Train Loss: 0.2906 | Train Acc: 0.9112
 Site-USPS                      (0) | Train Loss: 0.3040 | Train Acc: 0.8949
 Site-USPS                      (0) | Train Loss: 0.2929 | Train Acc: 0.9112
 Site-SynthDigits               (0) | Train Loss: 0.4431 | Train Acc: 0.8625
 Site-SynthDigits               (0) | Train Loss: 0.3938 | Train Acc: 0.8897
 Site-MNIST_M                   (1) | Train Loss: 0.6278 | Train Acc: 0.7951
 Site-MNIST_M                   (1) | Train Loss: 0.5781 | Train Acc: 0.8305
 Site-SVHN                      (3) | Train Loss: 0.8726 | Train Acc: 0.7062
 Site-SVHN                      (3) | Train Loss: 0.7456 | Train Acc: 0.7740
Average Train Accuracy: 0.8516
 Site-MNIST                     (2) | Val  Loss: 0.2234 | Val  Acc: 0.9348
 Site-MNIST                     (2) | Val  Loss: 0.3018 | Val  Acc: 0.9173
 Site-USPS                      (0) | Val  Loss: 0.4010 | Val  Acc: 0.8587
 Site-USPS                      (0) | Val  Loss: 0.3443 | Val  Acc: 0.8777
 Site-SynthDigits               (0) | Val  Loss: 0.4202 | Val  Acc: 0.8478
 Site-SynthDigits               (0) | Val  Loss: 0.4056 | Val  Acc: 0.8597
 Site-MNIST_M                   (1) | Val  Loss: 0.6467 | Val  Acc: 0.8152
 Site-MNIST_M                   (1) | Val  Loss: 0.5745 | Val  Acc: 0.8273
 Site-SVHN                      (3) | Val  Loss: 0.7689 | Val  Acc: 0.7717
 Site-SVHN                      (3) | Val  Loss: 0.7920 | Val  Acc: 0.7698
Average Valid Accuracy: 0.8480
============ Train epoch 30 ============
cnt=[2, 2, 2, 4, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (1) | Train Loss: 0.2313 | Train Acc: 0.9353
 Site-MNIST                     (1) | Train Loss: 0.2854 | Train Acc: 0.9157
 Site-USPS                      (3) | Train Loss: 0.2878 | Train Acc: 0.9057
 Site-USPS                      (3) | Train Loss: 0.2896 | Train Acc: 0.9130
 Site-SynthDigits               (3) | Train Loss: 0.4447 | Train Acc: 0.8598
 Site-SynthDigits               (3) | Train Loss: 0.3904 | Train Acc: 0.8969
 Site-MNIST_M                   (2) | Train Loss: 0.6266 | Train Acc: 0.7951
 Site-MNIST_M                   (2) | Train Loss: 0.5844 | Train Acc: 0.8395
 Site-SVHN                      (0) | Train Loss: 0.8704 | Train Acc: 0.7008
 Site-SVHN                      (0) | Train Loss: 0.7347 | Train Acc: 0.7767
Average Train Accuracy: 0.8538
 Site-MNIST                     (1) | Val  Loss: 0.2205 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.2998 | Val  Acc: 0.9245
 Site-USPS                      (3) | Val  Loss: 0.3869 | Val  Acc: 0.8587
 Site-USPS                      (3) | Val  Loss: 0.3331 | Val  Acc: 0.8849
 Site-SynthDigits               (3) | Val  Loss: 0.4169 | Val  Acc: 0.8696
 Site-SynthDigits               (3) | Val  Loss: 0.4016 | Val  Acc: 0.8705
 Site-MNIST_M                   (2) | Val  Loss: 0.6387 | Val  Acc: 0.8370
 Site-MNIST_M                   (2) | Val  Loss: 0.5745 | Val  Acc: 0.8309
 Site-SVHN                      (0) | Val  Loss: 0.7576 | Val  Acc: 0.7609
 Site-SVHN                      (0) | Val  Loss: 0.7832 | Val  Acc: 0.7590
Average Valid Accuracy: 0.8542
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9457
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9245
 Best site-USPS                     (3)  | Epoch:30 | Val Acc: 0.8587
 Best site-USPS                     (3)  | Epoch:30 | Val Acc: 0.8849
 Best site-SynthDigits              (3)  | Epoch:30 | Val Acc: 0.8696
 Best site-SynthDigits              (3)  | Epoch:30 | Val Acc: 0.8705
 Best site-MNIST_M                  (2)  | Epoch:30 | Val Acc: 0.8370
 Best site-MNIST_M                  (2)  | Epoch:30 | Val Acc: 0.8309
 Best site-SVHN                     (0)  | Epoch:30 | Val Acc: 0.7609
 Best site-SVHN                     (0)  | Epoch:30 | Val Acc: 0.7590
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 31 ============
cnt=[2, 2, 2, 4, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (1) | Train Loss: 0.2178 | Train Acc: 0.9407
 Site-MNIST                     (1) | Train Loss: 0.2781 | Train Acc: 0.9184
 Site-USPS                      (3) | Train Loss: 0.2881 | Train Acc: 0.9164
 Site-USPS                      (3) | Train Loss: 0.2784 | Train Acc: 0.9130
 Site-SynthDigits               (3) | Train Loss: 0.4393 | Train Acc: 0.8652
 Site-SynthDigits               (3) | Train Loss: 0.3857 | Train Acc: 0.8987
 Site-MNIST_M                   (2) | Train Loss: 0.6172 | Train Acc: 0.8059
 Site-MNIST_M                   (2) | Train Loss: 0.5613 | Train Acc: 0.8404
 Site-SVHN                      (0) | Train Loss: 0.8572 | Train Acc: 0.7116
 Site-SVHN                      (0) | Train Loss: 0.7246 | Train Acc: 0.7758
Average Train Accuracy: 0.8586
 Site-MNIST                     (1) | Val  Loss: 0.2008 | Val  Acc: 0.9348
 Site-MNIST                     (1) | Val  Loss: 0.2807 | Val  Acc: 0.9281
 Site-USPS                      (3) | Val  Loss: 0.3801 | Val  Acc: 0.8478
 Site-USPS                      (3) | Val  Loss: 0.3238 | Val  Acc: 0.8849
 Site-SynthDigits               (3) | Val  Loss: 0.4098 | Val  Acc: 0.8587
 Site-SynthDigits               (3) | Val  Loss: 0.3967 | Val  Acc: 0.8669
 Site-MNIST_M                   (2) | Val  Loss: 0.6187 | Val  Acc: 0.8370
 Site-MNIST_M                   (2) | Val  Loss: 0.5612 | Val  Acc: 0.8345
 Site-SVHN                      (0) | Val  Loss: 0.7578 | Val  Acc: 0.7717
 Site-SVHN                      (0) | Val  Loss: 0.7753 | Val  Acc: 0.7626
Average Valid Accuracy: 0.8527
============ Train epoch 32 ============
cnt=[2, 2, 2, 4, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (0) | Train Loss: 0.2154 | Train Acc: 0.9353
 Site-MNIST                     (0) | Train Loss: 0.2606 | Train Acc: 0.9247
 Site-USPS                      (3) | Train Loss: 0.2847 | Train Acc: 0.9137
 Site-USPS                      (3) | Train Loss: 0.2824 | Train Acc: 0.9184
 Site-SynthDigits               (3) | Train Loss: 0.4218 | Train Acc: 0.8706
 Site-SynthDigits               (3) | Train Loss: 0.3766 | Train Acc: 0.8969
 Site-MNIST_M                   (2) | Train Loss: 0.5928 | Train Acc: 0.8059
 Site-MNIST_M                   (2) | Train Loss: 0.5485 | Train Acc: 0.8457
 Site-SVHN                      (1) | Train Loss: 0.8490 | Train Acc: 0.7089
 Site-SVHN                      (1) | Train Loss: 0.7072 | Train Acc: 0.7803
Average Train Accuracy: 0.8600
 Site-MNIST                     (0) | Val  Loss: 0.1907 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2720 | Val  Acc: 0.9281
 Site-USPS                      (3) | Val  Loss: 0.3817 | Val  Acc: 0.8587
 Site-USPS                      (3) | Val  Loss: 0.3221 | Val  Acc: 0.8921
 Site-SynthDigits               (3) | Val  Loss: 0.4065 | Val  Acc: 0.8696
 Site-SynthDigits               (3) | Val  Loss: 0.3854 | Val  Acc: 0.8705
 Site-MNIST_M                   (2) | Val  Loss: 0.6029 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.5475 | Val  Acc: 0.8345
 Site-SVHN                      (1) | Val  Loss: 0.7448 | Val  Acc: 0.7935
 Site-SVHN                      (1) | Val  Loss: 0.7601 | Val  Acc: 0.7662
Average Valid Accuracy: 0.8617
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9457
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9281
 Best site-USPS                     (3)  | Epoch:32 | Val Acc: 0.8587
 Best site-USPS                     (3)  | Epoch:32 | Val Acc: 0.8921
 Best site-SynthDigits              (3)  | Epoch:32 | Val Acc: 0.8696
 Best site-SynthDigits              (3)  | Epoch:32 | Val Acc: 0.8705
 Best site-MNIST_M                  (2)  | Epoch:32 | Val Acc: 0.8587
 Best site-MNIST_M                  (2)  | Epoch:32 | Val Acc: 0.8345
 Best site-SVHN                     (1)  | Epoch:32 | Val Acc: 0.7935
 Best site-SVHN                     (1)  | Epoch:32 | Val Acc: 0.7662
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 33 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (2) | Train Loss: 0.2111 | Train Acc: 0.9434
 Site-MNIST                     (2) | Train Loss: 0.2641 | Train Acc: 0.9211
 Site-USPS                      (0) | Train Loss: 0.2777 | Train Acc: 0.9164
 Site-USPS                      (0) | Train Loss: 0.2697 | Train Acc: 0.9175
 Site-SynthDigits               (0) | Train Loss: 0.4235 | Train Acc: 0.8679
 Site-SynthDigits               (0) | Train Loss: 0.3758 | Train Acc: 0.8942
 Site-MNIST_M                   (1) | Train Loss: 0.5886 | Train Acc: 0.8086
 Site-MNIST_M                   (1) | Train Loss: 0.5453 | Train Acc: 0.8448
 Site-SVHN                      (3) | Train Loss: 0.8316 | Train Acc: 0.7143
 Site-SVHN                      (3) | Train Loss: 0.6962 | Train Acc: 0.7883
Average Train Accuracy: 0.8617
 Site-MNIST                     (2) | Val  Loss: 0.1905 | Val  Acc: 0.9348
 Site-MNIST                     (2) | Val  Loss: 0.2734 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.3772 | Val  Acc: 0.8696
 Site-USPS                      (0) | Val  Loss: 0.3179 | Val  Acc: 0.8957
 Site-SynthDigits               (0) | Val  Loss: 0.4033 | Val  Acc: 0.8587
 Site-SynthDigits               (0) | Val  Loss: 0.3887 | Val  Acc: 0.8669
 Site-MNIST_M                   (1) | Val  Loss: 0.6073 | Val  Acc: 0.8370
 Site-MNIST_M                   (1) | Val  Loss: 0.5448 | Val  Acc: 0.8309
 Site-SVHN                      (3) | Val  Loss: 0.7363 | Val  Acc: 0.8043
 Site-SVHN                      (3) | Val  Loss: 0.7465 | Val  Acc: 0.7734
Average Valid Accuracy: 0.8603
============ Train epoch 34 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (0) | Train Loss: 0.2016 | Train Acc: 0.9380
 Site-MNIST                     (0) | Train Loss: 0.2589 | Train Acc: 0.9238
 Site-USPS                      (1) | Train Loss: 0.2632 | Train Acc: 0.9326
 Site-USPS                      (1) | Train Loss: 0.2584 | Train Acc: 0.9247
 Site-SynthDigits               (1) | Train Loss: 0.4145 | Train Acc: 0.8625
 Site-SynthDigits               (1) | Train Loss: 0.3637 | Train Acc: 0.8978
 Site-MNIST_M                   (2) | Train Loss: 0.5842 | Train Acc: 0.7871
 Site-MNIST_M                   (2) | Train Loss: 0.5290 | Train Acc: 0.8475
 Site-SVHN                      (3) | Train Loss: 0.8393 | Train Acc: 0.7251
 Site-SVHN                      (3) | Train Loss: 0.6905 | Train Acc: 0.7928
Average Train Accuracy: 0.8632
 Site-MNIST                     (0) | Val  Loss: 0.1817 | Val  Acc: 0.9348
 Site-MNIST                     (0) | Val  Loss: 0.2680 | Val  Acc: 0.9281
 Site-USPS                      (1) | Val  Loss: 0.3667 | Val  Acc: 0.8804
 Site-USPS                      (1) | Val  Loss: 0.3061 | Val  Acc: 0.8993
 Site-SynthDigits               (1) | Val  Loss: 0.3907 | Val  Acc: 0.8696
 Site-SynthDigits               (1) | Val  Loss: 0.3760 | Val  Acc: 0.8633
 Site-MNIST_M                   (2) | Val  Loss: 0.6000 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.5365 | Val  Acc: 0.8345
 Site-SVHN                      (3) | Val  Loss: 0.7356 | Val  Acc: 0.8043
 Site-SVHN                      (3) | Val  Loss: 0.7460 | Val  Acc: 0.7770
Average Valid Accuracy: 0.8650
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9348
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9281
 Best site-USPS                     (1)  | Epoch:34 | Val Acc: 0.8804
 Best site-USPS                     (1)  | Epoch:34 | Val Acc: 0.8993
 Best site-SynthDigits              (1)  | Epoch:34 | Val Acc: 0.8696
 Best site-SynthDigits              (1)  | Epoch:34 | Val Acc: 0.8633
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.8587
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.8345
 Best site-SVHN                     (3)  | Epoch:34 | Val Acc: 0.8043
 Best site-SVHN                     (3)  | Epoch:34 | Val Acc: 0.7770
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 35 ============
cnt=[2, 2, 4, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (3) | Train Loss: 0.2034 | Train Acc: 0.9407
 Site-MNIST                     (3) | Train Loss: 0.2518 | Train Acc: 0.9300
 Site-USPS                      (2) | Train Loss: 0.2684 | Train Acc: 0.9245
 Site-USPS                      (2) | Train Loss: 0.2663 | Train Acc: 0.9247
 Site-SynthDigits               (2) | Train Loss: 0.4010 | Train Acc: 0.8679
 Site-SynthDigits               (2) | Train Loss: 0.3595 | Train Acc: 0.9004
 Site-MNIST_M                   (0) | Train Loss: 0.5788 | Train Acc: 0.8086
 Site-MNIST_M                   (0) | Train Loss: 0.5299 | Train Acc: 0.8439
 Site-SVHN                      (1) | Train Loss: 0.8188 | Train Acc: 0.7197
 Site-SVHN                      (1) | Train Loss: 0.6730 | Train Acc: 0.8009
Average Train Accuracy: 0.8661
 Site-MNIST                     (3) | Val  Loss: 0.1787 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2675 | Val  Acc: 0.9317
 Site-USPS                      (2) | Val  Loss: 0.3641 | Val  Acc: 0.8696
 Site-USPS                      (2) | Val  Loss: 0.3036 | Val  Acc: 0.8993
 Site-SynthDigits               (2) | Val  Loss: 0.3878 | Val  Acc: 0.8696
 Site-SynthDigits               (2) | Val  Loss: 0.3637 | Val  Acc: 0.8741
 Site-MNIST_M                   (0) | Val  Loss: 0.5869 | Val  Acc: 0.8478
 Site-MNIST_M                   (0) | Val  Loss: 0.5253 | Val  Acc: 0.8309
 Site-SVHN                      (1) | Val  Loss: 0.7070 | Val  Acc: 0.8261
 Site-SVHN                      (1) | Val  Loss: 0.7255 | Val  Acc: 0.7914
Average Valid Accuracy: 0.8686
 Best site-MNIST                    (3)  | Epoch:35 | Val Acc: 0.9457
 Best site-MNIST                    (3)  | Epoch:35 | Val Acc: 0.9317
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.8696
 Best site-USPS                     (2)  | Epoch:35 | Val Acc: 0.8993
 Best site-SynthDigits              (2)  | Epoch:35 | Val Acc: 0.8696
 Best site-SynthDigits              (2)  | Epoch:35 | Val Acc: 0.8741
 Best site-MNIST_M                  (0)  | Epoch:35 | Val Acc: 0.8478
 Best site-MNIST_M                  (0)  | Epoch:35 | Val Acc: 0.8309
 Best site-SVHN                     (1)  | Epoch:35 | Val Acc: 0.8261
 Best site-SVHN                     (1)  | Epoch:35 | Val Acc: 0.7914
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 36 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (2) | Train Loss: 0.2004 | Train Acc: 0.9434
 Site-MNIST                     (2) | Train Loss: 0.2519 | Train Acc: 0.9300
 Site-USPS                      (1) | Train Loss: 0.2610 | Train Acc: 0.9218
 Site-USPS                      (1) | Train Loss: 0.2578 | Train Acc: 0.9265
 Site-SynthDigits               (1) | Train Loss: 0.4161 | Train Acc: 0.8733
 Site-SynthDigits               (1) | Train Loss: 0.3626 | Train Acc: 0.9013
 Site-MNIST_M                   (0) | Train Loss: 0.5810 | Train Acc: 0.8140
 Site-MNIST_M                   (0) | Train Loss: 0.5206 | Train Acc: 0.8529
 Site-SVHN                      (3) | Train Loss: 0.8342 | Train Acc: 0.7170
 Site-SVHN                      (3) | Train Loss: 0.6761 | Train Acc: 0.7964
Average Train Accuracy: 0.8677
 Site-MNIST                     (2) | Val  Loss: 0.1743 | Val  Acc: 0.9457
 Site-MNIST                     (2) | Val  Loss: 0.2618 | Val  Acc: 0.9317
 Site-USPS                      (1) | Val  Loss: 0.3660 | Val  Acc: 0.8804
 Site-USPS                      (1) | Val  Loss: 0.3027 | Val  Acc: 0.8993
 Site-SynthDigits               (1) | Val  Loss: 0.3919 | Val  Acc: 0.8804
 Site-SynthDigits               (1) | Val  Loss: 0.3721 | Val  Acc: 0.8777
 Site-MNIST_M                   (0) | Val  Loss: 0.5833 | Val  Acc: 0.8696
 Site-MNIST_M                   (0) | Val  Loss: 0.5243 | Val  Acc: 0.8453
 Site-SVHN                      (3) | Val  Loss: 0.7100 | Val  Acc: 0.7935
 Site-SVHN                      (3) | Val  Loss: 0.7300 | Val  Acc: 0.7806
Average Valid Accuracy: 0.8704
 Best site-MNIST                    (2)  | Epoch:36 | Val Acc: 0.9457
 Best site-MNIST                    (2)  | Epoch:36 | Val Acc: 0.9317
 Best site-USPS                     (1)  | Epoch:36 | Val Acc: 0.8804
 Best site-USPS                     (1)  | Epoch:36 | Val Acc: 0.8993
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.8804
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.8777
 Best site-MNIST_M                  (0)  | Epoch:36 | Val Acc: 0.8696
 Best site-MNIST_M                  (0)  | Epoch:36 | Val Acc: 0.8453
 Best site-SVHN                     (3)  | Epoch:36 | Val Acc: 0.7935
 Best site-SVHN                     (3)  | Epoch:36 | Val Acc: 0.7806
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 37 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (3) | Train Loss: 0.1988 | Train Acc: 0.9326
 Site-MNIST                     (3) | Train Loss: 0.2531 | Train Acc: 0.9345
 Site-USPS                      (0) | Train Loss: 0.2531 | Train Acc: 0.9272
 Site-USPS                      (0) | Train Loss: 0.2524 | Train Acc: 0.9256
 Site-SynthDigits               (0) | Train Loss: 0.3896 | Train Acc: 0.8868
 Site-SynthDigits               (0) | Train Loss: 0.3489 | Train Acc: 0.8969
 Site-MNIST_M                   (1) | Train Loss: 0.5744 | Train Acc: 0.8086
 Site-MNIST_M                   (1) | Train Loss: 0.5168 | Train Acc: 0.8601
 Site-SVHN                      (2) | Train Loss: 0.8186 | Train Acc: 0.7385
 Site-SVHN                      (2) | Train Loss: 0.6633 | Train Acc: 0.7946
Average Train Accuracy: 0.8705
 Site-MNIST                     (3) | Val  Loss: 0.1695 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2565 | Val  Acc: 0.9353
 Site-USPS                      (0) | Val  Loss: 0.3525 | Val  Acc: 0.8696
 Site-USPS                      (0) | Val  Loss: 0.2948 | Val  Acc: 0.9065
 Site-SynthDigits               (0) | Val  Loss: 0.3605 | Val  Acc: 0.8696
 Site-SynthDigits               (0) | Val  Loss: 0.3563 | Val  Acc: 0.8813
 Site-MNIST_M                   (1) | Val  Loss: 0.5698 | Val  Acc: 0.8696
 Site-MNIST_M                   (1) | Val  Loss: 0.5155 | Val  Acc: 0.8489
 Site-SVHN                      (2) | Val  Loss: 0.7071 | Val  Acc: 0.7935
 Site-SVHN                      (2) | Val  Loss: 0.7164 | Val  Acc: 0.7842
Average Valid Accuracy: 0.8715
 Best site-MNIST                    (3)  | Epoch:37 | Val Acc: 0.9565
 Best site-MNIST                    (3)  | Epoch:37 | Val Acc: 0.9353
 Best site-USPS                     (0)  | Epoch:37 | Val Acc: 0.8696
 Best site-USPS                     (0)  | Epoch:37 | Val Acc: 0.9065
 Best site-SynthDigits              (0)  | Epoch:37 | Val Acc: 0.8696
 Best site-SynthDigits              (0)  | Epoch:37 | Val Acc: 0.8813
 Best site-MNIST_M                  (1)  | Epoch:37 | Val Acc: 0.8696
 Best site-MNIST_M                  (1)  | Epoch:37 | Val Acc: 0.8489
 Best site-SVHN                     (2)  | Epoch:37 | Val Acc: 0.7935
 Best site-SVHN                     (2)  | Epoch:37 | Val Acc: 0.7842
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 38 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (1) | Train Loss: 0.2004 | Train Acc: 0.9353
 Site-MNIST                     (1) | Train Loss: 0.2530 | Train Acc: 0.9336
 Site-USPS                      (0) | Train Loss: 0.2599 | Train Acc: 0.9353
 Site-USPS                      (0) | Train Loss: 0.2545 | Train Acc: 0.9238
 Site-SynthDigits               (0) | Train Loss: 0.3851 | Train Acc: 0.8787
 Site-SynthDigits               (0) | Train Loss: 0.3452 | Train Acc: 0.9049
 Site-MNIST_M                   (2) | Train Loss: 0.5552 | Train Acc: 0.8005
 Site-MNIST_M                   (2) | Train Loss: 0.5026 | Train Acc: 0.8556
 Site-SVHN                      (3) | Train Loss: 0.8132 | Train Acc: 0.7224
 Site-SVHN                      (3) | Train Loss: 0.6635 | Train Acc: 0.7982
Average Train Accuracy: 0.8688
 Site-MNIST                     (1) | Val  Loss: 0.1679 | Val  Acc: 0.9565
 Site-MNIST                     (1) | Val  Loss: 0.2579 | Val  Acc: 0.9353
 Site-USPS                      (0) | Val  Loss: 0.3506 | Val  Acc: 0.8587
 Site-USPS                      (0) | Val  Loss: 0.2955 | Val  Acc: 0.9065
 Site-SynthDigits               (0) | Val  Loss: 0.3675 | Val  Acc: 0.8804
 Site-SynthDigits               (0) | Val  Loss: 0.3538 | Val  Acc: 0.8849
 Site-MNIST_M                   (2) | Val  Loss: 0.5641 | Val  Acc: 0.8696
 Site-MNIST_M                   (2) | Val  Loss: 0.5093 | Val  Acc: 0.8381
 Site-SVHN                      (3) | Val  Loss: 0.6904 | Val  Acc: 0.8043
 Site-SVHN                      (3) | Val  Loss: 0.7031 | Val  Acc: 0.7878
Average Valid Accuracy: 0.8722
 Best site-MNIST                    (1)  | Epoch:38 | Val Acc: 0.9565
 Best site-MNIST                    (1)  | Epoch:38 | Val Acc: 0.9353
 Best site-USPS                     (0)  | Epoch:38 | Val Acc: 0.8587
 Best site-USPS                     (0)  | Epoch:38 | Val Acc: 0.9065
 Best site-SynthDigits              (0)  | Epoch:38 | Val Acc: 0.8804
 Best site-SynthDigits              (0)  | Epoch:38 | Val Acc: 0.8849
 Best site-MNIST_M                  (2)  | Epoch:38 | Val Acc: 0.8696
 Best site-MNIST_M                  (2)  | Epoch:38 | Val Acc: 0.8381
 Best site-SVHN                     (3)  | Epoch:38 | Val Acc: 0.8043
 Best site-SVHN                     (3)  | Epoch:38 | Val Acc: 0.7878
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 39 ============
cnt=[2, 4, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (0) | Train Loss: 0.1982 | Train Acc: 0.9380
 Site-MNIST                     (0) | Train Loss: 0.2454 | Train Acc: 0.9274
 Site-USPS                      (1) | Train Loss: 0.2614 | Train Acc: 0.9380
 Site-USPS                      (1) | Train Loss: 0.2548 | Train Acc: 0.9211
 Site-SynthDigits               (1) | Train Loss: 0.3827 | Train Acc: 0.8814
 Site-SynthDigits               (1) | Train Loss: 0.3342 | Train Acc: 0.9076
 Site-MNIST_M                   (2) | Train Loss: 0.5573 | Train Acc: 0.8167
 Site-MNIST_M                   (2) | Train Loss: 0.4950 | Train Acc: 0.8619
 Site-SVHN                      (3) | Train Loss: 0.7985 | Train Acc: 0.7224
 Site-SVHN                      (3) | Train Loss: 0.6474 | Train Acc: 0.7973
Average Train Accuracy: 0.8712
 Site-MNIST                     (0) | Val  Loss: 0.1678 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2565 | Val  Acc: 0.9353
 Site-USPS                      (1) | Val  Loss: 0.3443 | Val  Acc: 0.8696
 Site-USPS                      (1) | Val  Loss: 0.2961 | Val  Acc: 0.9137
 Site-SynthDigits               (1) | Val  Loss: 0.3499 | Val  Acc: 0.8696
 Site-SynthDigits               (1) | Val  Loss: 0.3471 | Val  Acc: 0.8849
 Site-MNIST_M                   (2) | Val  Loss: 0.5564 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.5048 | Val  Acc: 0.8453
 Site-SVHN                      (3) | Val  Loss: 0.6848 | Val  Acc: 0.8152
 Site-SVHN                      (3) | Val  Loss: 0.6921 | Val  Acc: 0.7950
Average Valid Accuracy: 0.8733
 Best site-MNIST                    (0)  | Epoch:39 | Val Acc: 0.9457
 Best site-MNIST                    (0)  | Epoch:39 | Val Acc: 0.9353
 Best site-USPS                     (1)  | Epoch:39 | Val Acc: 0.8696
 Best site-USPS                     (1)  | Epoch:39 | Val Acc: 0.9137
 Best site-SynthDigits              (1)  | Epoch:39 | Val Acc: 0.8696
 Best site-SynthDigits              (1)  | Epoch:39 | Val Acc: 0.8849
 Best site-MNIST_M                  (2)  | Epoch:39 | Val Acc: 0.8587
 Best site-MNIST_M                  (2)  | Epoch:39 | Val Acc: 0.8453
 Best site-SVHN                     (3)  | Epoch:39 | Val Acc: 0.8152
 Best site-SVHN                     (3)  | Epoch:39 | Val Acc: 0.7950
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 4, 2, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (2) | Train Loss: 0.1872 | Train Acc: 0.9407
 Site-MNIST                     (2) | Train Loss: 0.2401 | Train Acc: 0.9336
 Site-USPS                      (1) | Train Loss: 0.2630 | Train Acc: 0.9245
 Site-USPS                      (1) | Train Loss: 0.2511 | Train Acc: 0.9309
 Site-SynthDigits               (1) | Train Loss: 0.3723 | Train Acc: 0.8841
 Site-SynthDigits               (1) | Train Loss: 0.3335 | Train Acc: 0.9013
 Site-MNIST_M                   (0) | Train Loss: 0.5570 | Train Acc: 0.8005
 Site-MNIST_M                   (0) | Train Loss: 0.4925 | Train Acc: 0.8547
 Site-SVHN                      (3) | Train Loss: 0.7937 | Train Acc: 0.7358
 Site-SVHN                      (3) | Train Loss: 0.6380 | Train Acc: 0.8108
Average Train Accuracy: 0.8717
 Site-MNIST                     (2) | Val  Loss: 0.1596 | Val  Acc: 0.9565
 Site-MNIST                     (2) | Val  Loss: 0.2463 | Val  Acc: 0.9388
 Site-USPS                      (1) | Val  Loss: 0.3402 | Val  Acc: 0.9022
 Site-USPS                      (1) | Val  Loss: 0.2832 | Val  Acc: 0.9101
 Site-SynthDigits               (1) | Val  Loss: 0.3489 | Val  Acc: 0.8804
 Site-SynthDigits               (1) | Val  Loss: 0.3356 | Val  Acc: 0.8921
 Site-MNIST_M                   (0) | Val  Loss: 0.5370 | Val  Acc: 0.8587
 Site-MNIST_M                   (0) | Val  Loss: 0.4927 | Val  Acc: 0.8417
 Site-SVHN                      (3) | Val  Loss: 0.6849 | Val  Acc: 0.8152
 Site-SVHN                      (3) | Val  Loss: 0.6849 | Val  Acc: 0.7986
Average Valid Accuracy: 0.8794
 Best site-MNIST                    (2)  | Epoch:40 | Val Acc: 0.9565
 Best site-MNIST                    (2)  | Epoch:40 | Val Acc: 0.9388
 Best site-USPS                     (1)  | Epoch:40 | Val Acc: 0.9022
 Best site-USPS                     (1)  | Epoch:40 | Val Acc: 0.9101
 Best site-SynthDigits              (1)  | Epoch:40 | Val Acc: 0.8804
 Best site-SynthDigits              (1)  | Epoch:40 | Val Acc: 0.8921
 Best site-MNIST_M                  (0)  | Epoch:40 | Val Acc: 0.8587
 Best site-MNIST_M                  (0)  | Epoch:40 | Val Acc: 0.8417
 Best site-SVHN                     (3)  | Epoch:40 | Val Acc: 0.8152
 Best site-SVHN                     (3)  | Epoch:40 | Val Acc: 0.7986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_4/ccop_q=1...
============ Train epoch 41 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (3) | Train Loss: 0.1867 | Train Acc: 0.9272
 Site-MNIST                     (3) | Train Loss: 0.2415 | Train Acc: 0.9327
 Site-USPS                      (1) | Train Loss: 0.2454 | Train Acc: 0.9380
 Site-USPS                      (1) | Train Loss: 0.2355 | Train Acc: 0.9274
 Site-SynthDigits               (1) | Train Loss: 0.3802 | Train Acc: 0.8760
 Site-SynthDigits               (1) | Train Loss: 0.3378 | Train Acc: 0.9067
 Site-MNIST_M                   (2) | Train Loss: 0.5335 | Train Acc: 0.8221
 Site-MNIST_M                   (2) | Train Loss: 0.4858 | Train Acc: 0.8628
 Site-SVHN                      (0) | Train Loss: 0.7926 | Train Acc: 0.7278
 Site-SVHN                      (0) | Train Loss: 0.6293 | Train Acc: 0.8018
Average Train Accuracy: 0.8722
 Site-MNIST                     (3) | Val  Loss: 0.1644 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2462 | Val  Acc: 0.9388
 Site-USPS                      (1) | Val  Loss: 0.3308 | Val  Acc: 0.8804
 Site-USPS                      (1) | Val  Loss: 0.2764 | Val  Acc: 0.9137
 Site-SynthDigits               (1) | Val  Loss: 0.3608 | Val  Acc: 0.8696
 Site-SynthDigits               (1) | Val  Loss: 0.3436 | Val  Acc: 0.8813
 Site-MNIST_M                   (2) | Val  Loss: 0.5273 | Val  Acc: 0.8696
 Site-MNIST_M                   (2) | Val  Loss: 0.4877 | Val  Acc: 0.8417
 Site-SVHN                      (0) | Val  Loss: 0.6781 | Val  Acc: 0.7935
 Site-SVHN                      (0) | Val  Loss: 0.6864 | Val  Acc: 0.7914
Average Valid Accuracy: 0.8736
============ Train epoch 42 ============
cnt=[4, 2, 2, 2, ]
cnt=[2, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (2) | Train Loss: 0.1920 | Train Acc: 0.9407
 Site-MNIST                     (2) | Train Loss: 0.2349 | Train Acc: 0.9336
 Site-USPS                      (0) | Train Loss: 0.2419 | Train Acc: 0.9380
 Site-USPS                      (0) | Train Loss: 0.2421 | Train Acc: 0.9283
 Site-SynthDigits               (0) | Train Loss: 0.3647 | Train Acc: 0.8895
 Site-SynthDigits               (0) | Train Loss: 0.3205 | Train Acc: 0.9112
 Site-MNIST_M                   (1) | Train Loss: 0.5417 | Train Acc: 0.8248
 Site-MNIST_M                   (1) | Train Loss: 0.4821 | Train Acc: 0.8637
 Site-SVHN                      (3) | Train Loss: 0.7898 | Train Acc: 0.7278
 Site-SVHN                      (3) | Train Loss: 0.6217 | Train Acc: 0.8099
Average Train Accuracy: 0.8767
 Site-MNIST                     (2) | Val  Loss: 0.1587 | Val  Acc: 0.9565
 Site-MNIST                     (2) | Val  Loss: 0.2454 | Val  Acc: 0.9353
 Site-USPS                      (0) | Val  Loss: 0.3360 | Val  Acc: 0.8804
 Site-USPS                      (0) | Val  Loss: 0.2734 | Val  Acc: 0.9065
 Site-SynthDigits               (0) | Val  Loss: 0.3400 | Val  Acc: 0.8804
 Site-SynthDigits               (0) | Val  Loss: 0.3262 | Val  Acc: 0.8885
 Site-MNIST_M                   (1) | Val  Loss: 0.5131 | Val  Acc: 0.8696
 Site-MNIST_M                   (1) | Val  Loss: 0.4791 | Val  Acc: 0.8453
 Site-SVHN                      (3) | Val  Loss: 0.6747 | Val  Acc: 0.8043
 Site-SVHN                      (3) | Val  Loss: 0.6834 | Val  Acc: 0.7914
Average Valid Accuracy: 0.8758
============ Train epoch 43 ============
cnt=[2, 2, 2, 4, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (0) | Train Loss: 0.2015 | Train Acc: 0.9272
 Site-MNIST                     (0) | Train Loss: 0.2485 | Train Acc: 0.9238
 Site-USPS                      (3) | Train Loss: 0.2328 | Train Acc: 0.9407
 Site-USPS                      (3) | Train Loss: 0.2383 | Train Acc: 0.9274
 Site-SynthDigits               (3) | Train Loss: 0.3579 | Train Acc: 0.8922
 Site-SynthDigits               (3) | Train Loss: 0.3301 | Train Acc: 0.9094
 Site-MNIST_M                   (2) | Train Loss: 0.5300 | Train Acc: 0.8248
 Site-MNIST_M                   (2) | Train Loss: 0.4698 | Train Acc: 0.8726
 Site-SVHN                      (1) | Train Loss: 0.7862 | Train Acc: 0.7385
 Site-SVHN                      (1) | Train Loss: 0.6110 | Train Acc: 0.8081
Average Train Accuracy: 0.8765
 Site-MNIST                     (0) | Val  Loss: 0.1722 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2524 | Val  Acc: 0.9281
 Site-USPS                      (3) | Val  Loss: 0.3232 | Val  Acc: 0.8913
 Site-USPS                      (3) | Val  Loss: 0.2659 | Val  Acc: 0.9101
 Site-SynthDigits               (3) | Val  Loss: 0.3444 | Val  Acc: 0.8913
 Site-SynthDigits               (3) | Val  Loss: 0.3251 | Val  Acc: 0.8957
 Site-MNIST_M                   (2) | Val  Loss: 0.5119 | Val  Acc: 0.8696
 Site-MNIST_M                   (2) | Val  Loss: 0.4734 | Val  Acc: 0.8489
 Site-SVHN                      (1) | Val  Loss: 0.6620 | Val  Acc: 0.8152
 Site-SVHN                      (1) | Val  Loss: 0.6685 | Val  Acc: 0.7986
Average Valid Accuracy: 0.8794
============ Train epoch 44 ============
cnt=[2, 2, 4, 2, ]
cnt=[2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (1) | Train Loss: 0.1998 | Train Acc: 0.9299
 Site-MNIST                     (1) | Train Loss: 0.2399 | Train Acc: 0.9274
 Site-USPS                      (2) | Train Loss: 0.2362 | Train Acc: 0.9488
 Site-USPS                      (2) | Train Loss: 0.2342 | Train Acc: 0.9336
 Site-SynthDigits               (2) | Train Loss: 0.3545 | Train Acc: 0.8976
 Site-SynthDigits               (2) | Train Loss: 0.3152 | Train Acc: 0.9112
 Site-MNIST_M                   (3) | Train Loss: 0.5261 | Train Acc: 0.8383
 Site-MNIST_M                   (3) | Train Loss: 0.4704 | Train Acc: 0.8601
 Site-SVHN                      (0) | Train Loss: 0.7778 | Train Acc: 0.7520
 Site-SVHN                      (0) | Train Loss: 0.6161 | Train Acc: 0.8117
Average Train Accuracy: 0.8811
 Site-MNIST                     (1) | Val  Loss: 0.1754 | Val  Acc: 0.9239
 Site-MNIST                     (1) | Val  Loss: 0.2494 | Val  Acc: 0.9353
 Site-USPS                      (2) | Val  Loss: 0.3124 | Val  Acc: 0.8913
 Site-USPS                      (2) | Val  Loss: 0.2614 | Val  Acc: 0.9209
 Site-SynthDigits               (2) | Val  Loss: 0.3299 | Val  Acc: 0.9022
 Site-SynthDigits               (2) | Val  Loss: 0.3160 | Val  Acc: 0.8957
 Site-MNIST_M                   (3) | Val  Loss: 0.5059 | Val  Acc: 0.8478
 Site-MNIST_M                   (3) | Val  Loss: 0.4708 | Val  Acc: 0.8525
 Site-SVHN                      (0) | Val  Loss: 0.6531 | Val  Acc: 0.8043
 Site-SVHN                      (0) | Val  Loss: 0.6603 | Val  Acc: 0.8058
Average Valid Accuracy: 0.8780
============ Train epoch 45 ============
cnt=[2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (3) | Train Loss: 0.1837 | Train Acc: 0.9434
 Site-MNIST                     (3) | Train Loss: 0.2347 | Train Acc: 0.9336
 Site-USPS                      (1) | Train Loss: 0.2315 | Train Acc: 0.9353
 Site-USPS                      (1) | Train Loss: 0.2249 | Train Acc: 0.9300
 Site-SynthDigits               (1) | Train Loss: 0.3600 | Train Acc: 0.8868
 Site-SynthDigits               (1) | Train Loss: 0.3149 | Train Acc: 0.9130
 Site-MNIST_M                   (2) | Train Loss: 0.5245 | Train Acc: 0.8275
 Site-MNIST_M                   (2) | Train Loss: 0.4710 | Train Acc: 0.8547
 Site-SVHN                      (0) | Train Loss: 0.7803 | Train Acc: 0.7439
 Site-SVHN                      (0) | Train Loss: 0.6130 | Train Acc: 0.8152
Average Train Accuracy: 0.8784
 Site-MNIST                     (3) | Val  Loss: 0.1650 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2337 | Val  Acc: 0.9388
 Site-USPS                      (1) | Val  Loss: 0.3105 | Val  Acc: 0.8804
 Site-USPS                      (1) | Val  Loss: 0.2602 | Val  Acc: 0.9173
 Site-SynthDigits               (1) | Val  Loss: 0.3309 | Val  Acc: 0.8804
 Site-SynthDigits               (1) | Val  Loss: 0.3171 | Val  Acc: 0.8885
 Site-MNIST_M                   (2) | Val  Loss: 0.4998 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.4611 | Val  Acc: 0.8525
 Site-SVHN                      (0) | Val  Loss: 0.6574 | Val  Acc: 0.8152
 Site-SVHN                      (0) | Val  Loss: 0.6522 | Val  Acc: 0.8129
Average Valid Accuracy: 0.8801
 Best site-MNIST                    (3)  | Epoch:45 | Val Acc: 0.9565
 Best site-MNIST                    (3)  | Epoch:45 | Val Acc: 0.9388
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 0.8804
 Best site-USPS                     (1)  | Epoch:45 | Val Acc: 0.9173
 Best site-SynthDigits              (1)  | Epoch:45 | Val Acc: 0.8804
 Best site-SynthDigits              (1)  | Epoch:45 | Val Acc: 0.8885
 Best site-MNIST_M                  (2)  | Epoch:45 | Val Acc: 0.8587
 Best site-MNIST_M                  (2)  | Epoch:45 | Val Acc: 0.8525
 Best site-SVHN                     (0)  | Epoch:45 | Val Acc: 0.8152
 Best site-SVHN                     (0)  | Epoch:45 | Val Acc: 0.8129
 Test site-MNIST                     (3)| Epoch:45 | Test Acc: 0.9389
 Test site-USPS                      (1)| Epoch:45 | Test Acc: 0.9376
 Test site-SynthDigits               (1)| Epoch:45 | Test Acc: 0.8958
 Test site-MNIST_M                   (2)| Epoch:45 | Test Acc: 0.7743
 Test site-SVHN                      (0)| Epoch:45 | Test Acc: 0.7331
MNIST: 0.9389, USPS: 0.9376, SynthDigits: 0.8958, MNIST_M: 0.7743, SVHN: 0.7331, 
Average Test Accuracy(group): 0.8559, Average Test Accuracy(individual): 0.8559,
domain std=0.0859, cluster std=0.0886, individual std=0.0859, 
===2023-08-01 20:11:01===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 4
Loading snapshots...
 Test site-MNIST                     (2)| Epoch:40 | Test Acc: 0.9384
 Test site-USPS                      (1)| Epoch:40 | Test Acc: 0.9301
 Test site-SynthDigits               (1)| Epoch:40 | Test Acc: 0.8943
 Test site-MNIST_M                   (0)| Epoch:40 | Test Acc: 0.7703
 Test site-SVHN                      (3)| Epoch:40 | Test Acc: 0.7281
MNIST: 0.9384, USPS: 0.9301, SynthDigits: 0.8943, MNIST_M: 0.7703, SVHN: 0.7281, 
Average Test Accuracy(group): 0.8522, Average Test Accuracy(individual): 0.8522,
domain std=0.0865, cluster std=0.0898, individual std=0.0865, 
