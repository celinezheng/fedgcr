===2023-03-25 12:51:16===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7798 | Train Acc: 0.5586
 Site-MNIST     | Train Loss: 1.7888 | Train Acc: 0.4955
 Site-SVHN      | Train Loss: 2.2097 | Train Acc: 0.1532
 Site-SVHN      | Train Loss: 2.2419 | Train Acc: 0.2072
 Site-USPS      | Train Loss: 1.7189 | Train Acc: 0.6036
 Site-USPS      | Train Loss: 1.7716 | Train Acc: 0.6486
 Site-SynthDigits| Train Loss: 2.0909 | Train Acc: 0.2342
 Site-SynthDigits| Train Loss: 2.1187 | Train Acc: 0.2162
 Site-MNIST-M   | Train Loss: 2.1972 | Train Acc: 0.1892
 Site-MNIST-M   | Train Loss: 2.1932 | Train Acc: 0.2162
 Site-MNIST     | Val  Loss: 1.7933 | Val  Acc: 0.4730
 Site-MNIST     | Val  Loss: 1.7244 | Val  Acc: 0.6216
 Site-SVHN      | Val  Loss: 2.2790 | Val  Acc: 0.1622
 Site-SVHN      | Val  Loss: 2.2009 | Val  Acc: 0.1892
 Site-USPS      | Val  Loss: 1.7559 | Val  Acc: 0.6622
 Site-USPS      | Val  Loss: 1.7370 | Val  Acc: 0.6486
 Site-SynthDigits| Val  Loss: 2.1145 | Val  Acc: 0.2027
 Site-SynthDigits| Val  Loss: 2.0966 | Val  Acc: 0.2027
 Site-MNIST-M   | Val  Loss: 2.1968 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.1765 | Val  Acc: 0.1757
Average Valid Accuracy: 0.3581
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4730
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6216
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1622
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1892
 Best site-USPS       | Epoch:0 | Val Acc: 0.6622
 Best site-USPS       | Epoch:0 | Val Acc: 0.6486
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2027
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2027
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3745 | Train Acc: 0.6667
 Site-MNIST     | Train Loss: 1.4094 | Train Acc: 0.6847
 Site-SVHN      | Train Loss: 2.1111 | Train Acc: 0.2072
 Site-SVHN      | Train Loss: 2.1217 | Train Acc: 0.2973
 Site-USPS      | Train Loss: 1.2882 | Train Acc: 0.8018
 Site-USPS      | Train Loss: 1.3465 | Train Acc: 0.8018
 Site-SynthDigits| Train Loss: 1.8829 | Train Acc: 0.3694
 Site-SynthDigits| Train Loss: 1.9329 | Train Acc: 0.3333
 Site-MNIST-M   | Train Loss: 2.0536 | Train Acc: 0.2703
 Site-MNIST-M   | Train Loss: 2.0437 | Train Acc: 0.2973
 Site-MNIST     | Val  Loss: 1.4220 | Val  Acc: 0.6757
 Site-MNIST     | Val  Loss: 1.3174 | Val  Acc: 0.7432
 Site-SVHN      | Val  Loss: 2.1695 | Val  Acc: 0.2297
 Site-SVHN      | Val  Loss: 2.0821 | Val  Acc: 0.2568
 Site-USPS      | Val  Loss: 1.3352 | Val  Acc: 0.7973
 Site-USPS      | Val  Loss: 1.3116 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.9339 | Val  Acc: 0.2838
 Site-SynthDigits| Val  Loss: 1.8893 | Val  Acc: 0.4189
 Site-MNIST-M   | Val  Loss: 2.0252 | Val  Acc: 0.3243
 Site-MNIST-M   | Val  Loss: 2.0364 | Val  Acc: 0.2432
Average Valid Accuracy: 0.4797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6757
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7432
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2297
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2568
 Best site-USPS       | Epoch:1 | Val Acc: 0.7973
 Best site-USPS       | Epoch:1 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2838
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4189
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3243
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.0245 | Train Acc: 0.7658
 Site-MNIST     | Train Loss: 1.1043 | Train Acc: 0.7477
 Site-SVHN      | Train Loss: 2.0025 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.0064 | Train Acc: 0.2883
 Site-USPS      | Train Loss: 0.8973 | Train Acc: 0.8559
 Site-USPS      | Train Loss: 0.9528 | Train Acc: 0.8288
 Site-SynthDigits| Train Loss: 1.6668 | Train Acc: 0.4234
 Site-SynthDigits| Train Loss: 1.6901 | Train Acc: 0.4144
 Site-MNIST-M   | Train Loss: 1.8946 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 1.9590 | Train Acc: 0.3243
 Site-MNIST     | Val  Loss: 1.1263 | Val  Acc: 0.7297
 Site-MNIST     | Val  Loss: 0.9823 | Val  Acc: 0.7838
 Site-SVHN      | Val  Loss: 2.1417 | Val  Acc: 0.2027
 Site-SVHN      | Val  Loss: 1.8564 | Val  Acc: 0.2973
 Site-USPS      | Val  Loss: 0.9571 | Val  Acc: 0.8243
 Site-USPS      | Val  Loss: 0.9259 | Val  Acc: 0.8514
 Site-SynthDigits| Val  Loss: 1.7155 | Val  Acc: 0.4054
 Site-SynthDigits| Val  Loss: 1.6375 | Val  Acc: 0.4189
 Site-MNIST-M   | Val  Loss: 1.9461 | Val  Acc: 0.3378
 Site-MNIST-M   | Val  Loss: 1.8858 | Val  Acc: 0.3649
Average Valid Accuracy: 0.5216
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7297
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7838
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2027
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2973
 Best site-USPS       | Epoch:2 | Val Acc: 0.8243
 Best site-USPS       | Epoch:2 | Val Acc: 0.8514
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4054
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4189
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3378
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.6190 | Train Acc: 0.8378
 Site-MNIST     | Train Loss: 0.7185 | Train Acc: 0.7928
 Site-SVHN      | Train Loss: 1.8324 | Train Acc: 0.3423
 Site-SVHN      | Train Loss: 1.8619 | Train Acc: 0.3964
 Site-USPS      | Train Loss: 0.5131 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.6001 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 1.4719 | Train Acc: 0.4955
 Site-SynthDigits| Train Loss: 1.4407 | Train Acc: 0.4595
 Site-MNIST-M   | Train Loss: 1.6477 | Train Acc: 0.4595
 Site-MNIST-M   | Train Loss: 1.7273 | Train Acc: 0.4595
 Site-MNIST     | Val  Loss: 0.7337 | Val  Acc: 0.7973
 Site-MNIST     | Val  Loss: 0.6203 | Val  Acc: 0.8243
 Site-SVHN      | Val  Loss: 1.9150 | Val  Acc: 0.3649
 Site-SVHN      | Val  Loss: 1.8127 | Val  Acc: 0.3649
 Site-USPS      | Val  Loss: 0.6051 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.5392 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.4721 | Val  Acc: 0.4324
 Site-SynthDigits| Val  Loss: 1.4292 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 1.6726 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.6844 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6041
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7973
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8243
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3649
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3649
 Best site-USPS       | Epoch:3 | Val Acc: 0.8919
 Best site-USPS       | Epoch:3 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4324
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.4934 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 0.5838 | Train Acc: 0.8198
 Site-SVHN      | Train Loss: 1.6041 | Train Acc: 0.4414
 Site-SVHN      | Train Loss: 1.6673 | Train Acc: 0.4865
 Site-USPS      | Train Loss: 0.3758 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.4331 | Train Acc: 0.8739
 Site-SynthDigits| Train Loss: 1.3016 | Train Acc: 0.5766
 Site-SynthDigits| Train Loss: 1.2315 | Train Acc: 0.5586
 Site-MNIST-M   | Train Loss: 1.4355 | Train Acc: 0.5586
 Site-MNIST-M   | Train Loss: 1.4840 | Train Acc: 0.5315
 Site-MNIST     | Val  Loss: 0.5897 | Val  Acc: 0.8243
 Site-MNIST     | Val  Loss: 0.5137 | Val  Acc: 0.8649
 Site-SVHN      | Val  Loss: 1.7271 | Val  Acc: 0.4595
 Site-SVHN      | Val  Loss: 1.6136 | Val  Acc: 0.4595
 Site-USPS      | Val  Loss: 0.4385 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.3743 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.2524 | Val  Acc: 0.5405
 Site-SynthDigits| Val  Loss: 1.2887 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.4257 | Val  Acc: 0.5541
 Site-MNIST-M   | Val  Loss: 1.4388 | Val  Acc: 0.5541
Average Valid Accuracy: 0.6608
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8243
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8649
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4595
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4595
 Best site-USPS       | Epoch:4 | Val Acc: 0.8649
 Best site-USPS       | Epoch:4 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5405
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5541
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5541
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.3519 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.4287 | Train Acc: 0.9009
 Site-SVHN      | Train Loss: 1.6327 | Train Acc: 0.3874
 Site-SVHN      | Train Loss: 1.7253 | Train Acc: 0.4595
 Site-USPS      | Train Loss: 0.3497 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.4345 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.1090 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 0.9972 | Train Acc: 0.6937
 Site-MNIST-M   | Train Loss: 1.2876 | Train Acc: 0.6396
 Site-MNIST-M   | Train Loss: 1.4496 | Train Acc: 0.5135
 Site-MNIST     | Val  Loss: 0.4098 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.3978 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.8657 | Val  Acc: 0.4054
 Site-SVHN      | Val  Loss: 1.6091 | Val  Acc: 0.4189
 Site-USPS      | Val  Loss: 0.4274 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.3852 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.0441 | Val  Acc: 0.6892
 Site-SynthDigits| Val  Loss: 1.0391 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.3865 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.3339 | Val  Acc: 0.6081
Average Valid Accuracy: 0.6878
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4054
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4189
 Best site-USPS       | Epoch:5 | Val Acc: 0.8649
 Best site-USPS       | Epoch:5 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6892
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6081
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.3173 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.4036 | Train Acc: 0.8829
 Site-SVHN      | Train Loss: 1.3584 | Train Acc: 0.4955
 Site-SVHN      | Train Loss: 1.3836 | Train Acc: 0.5586
 Site-USPS      | Train Loss: 0.3485 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.3994 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 0.9288 | Train Acc: 0.7387
 Site-SynthDigits| Train Loss: 0.8312 | Train Acc: 0.7477
 Site-MNIST-M   | Train Loss: 1.0961 | Train Acc: 0.6577
 Site-MNIST-M   | Train Loss: 1.2132 | Train Acc: 0.6126
 Site-MNIST     | Val  Loss: 0.3917 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.3755 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.4781 | Val  Acc: 0.5270
 Site-SVHN      | Val  Loss: 1.3013 | Val  Acc: 0.5405
 Site-USPS      | Val  Loss: 0.3916 | Val  Acc: 0.9189
 Site-USPS      | Val  Loss: 0.3580 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.8537 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 0.8644 | Val  Acc: 0.7297
 Site-MNIST-M   | Val  Loss: 1.1304 | Val  Acc: 0.6757
 Site-MNIST-M   | Val  Loss: 1.1653 | Val  Acc: 0.5811
Average Valid Accuracy: 0.7432
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5270
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5405
 Best site-USPS       | Epoch:6 | Val Acc: 0.9189
 Best site-USPS       | Epoch:6 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7568
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7297
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6757
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5811
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.2177 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.2518 | Train Acc: 0.9369
 Site-SVHN      | Train Loss: 1.1215 | Train Acc: 0.6036
 Site-SVHN      | Train Loss: 1.1453 | Train Acc: 0.6126
 Site-USPS      | Train Loss: 0.2384 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.2759 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 0.7452 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.6522 | Train Acc: 0.8198
 Site-MNIST-M   | Train Loss: 0.7348 | Train Acc: 0.7748
 Site-MNIST-M   | Train Loss: 0.8177 | Train Acc: 0.7568
 Site-MNIST     | Val  Loss: 0.2337 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.2567 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.2056 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 1.0935 | Val  Acc: 0.6081
 Site-USPS      | Val  Loss: 0.2631 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.2361 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.6896 | Val  Acc: 0.8514
 Site-SynthDigits| Val  Loss: 0.6974 | Val  Acc: 0.7568
 Site-MNIST-M   | Val  Loss: 0.7934 | Val  Acc: 0.7703
 Site-MNIST-M   | Val  Loss: 0.7199 | Val  Acc: 0.8108
Average Valid Accuracy: 0.8081
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6081
 Best site-USPS       | Epoch:7 | Val Acc: 0.9054
 Best site-USPS       | Epoch:7 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8514
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7568
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.7703
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1852 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.2204 | Train Acc: 0.9459
 Site-SVHN      | Train Loss: 0.9734 | Train Acc: 0.6486
 Site-SVHN      | Train Loss: 1.0533 | Train Acc: 0.6667
 Site-USPS      | Train Loss: 0.2122 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.2277 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.6233 | Train Acc: 0.8468
 Site-SynthDigits| Train Loss: 0.5116 | Train Acc: 0.8739
 Site-MNIST-M   | Train Loss: 0.6140 | Train Acc: 0.8198
 Site-MNIST-M   | Train Loss: 0.7142 | Train Acc: 0.8198
 Site-MNIST     | Val  Loss: 0.2161 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.2187 | Val  Acc: 0.9189
 Site-SVHN      | Val  Loss: 1.1431 | Val  Acc: 0.6216
 Site-SVHN      | Val  Loss: 0.9398 | Val  Acc: 0.6892
 Site-USPS      | Val  Loss: 0.2170 | Val  Acc: 0.9459
 Site-USPS      | Val  Loss: 0.2053 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.5306 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 0.5726 | Val  Acc: 0.8378
 Site-MNIST-M   | Val  Loss: 0.6874 | Val  Acc: 0.8243
 Site-MNIST-M   | Val  Loss: 0.6192 | Val  Acc: 0.8649
Average Valid Accuracy: 0.8459
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9189
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6216
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6892
 Best site-USPS       | Epoch:8 | Val Acc: 0.9459
 Best site-USPS       | Epoch:8 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8378
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.8243
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.8649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.1428 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.1460 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 0.7976 | Train Acc: 0.7117
 Site-SVHN      | Train Loss: 0.8758 | Train Acc: 0.7297
 Site-USPS      | Train Loss: 0.1739 | Train Acc: 0.9369
 Site-USPS      | Train Loss: 0.1922 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.4907 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 0.4013 | Train Acc: 0.9189
 Site-MNIST-M   | Train Loss: 0.3967 | Train Acc: 0.9009
 Site-MNIST-M   | Train Loss: 0.4569 | Train Acc: 0.9009
 Site-MNIST     | Val  Loss: 0.1342 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1568 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.9055 | Val  Acc: 0.7297
 Site-SVHN      | Val  Loss: 0.8416 | Val  Acc: 0.7297
 Site-USPS      | Val  Loss: 0.1817 | Val  Acc: 0.9459
 Site-USPS      | Val  Loss: 0.1670 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.4359 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.4266 | Val  Acc: 0.8919
 Site-MNIST-M   | Val  Loss: 0.4408 | Val  Acc: 0.8784
 Site-MNIST-M   | Val  Loss: 0.3893 | Val  Acc: 0.9459
Average Valid Accuracy: 0.8932
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7297
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7297
 Best site-USPS       | Epoch:9 | Val Acc: 0.9459
 Best site-USPS       | Epoch:9 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8919
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.8784
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/FedPrompt...
===2023-03-25 13:34:25===
===2023-03-25 13:34:26===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8843
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3390
 Test site-USPS      | Epoch:9 | Test Acc: 0.8871
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.6398
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.4436
Average Test Accuracy: 0.6388
