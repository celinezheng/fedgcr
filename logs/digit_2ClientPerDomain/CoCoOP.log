===2023-03-24 16:42:11===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7331 | Train Acc: 0.5135
 Site-MNIST     | Train Loss: 1.7532 | Train Acc: 0.5315
 Site-SVHN      | Train Loss: 1.9749 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 2.0036 | Train Acc: 0.3514
 Site-USPS      | Train Loss: 1.6306 | Train Acc: 0.7117
 Site-USPS      | Train Loss: 1.6905 | Train Acc: 0.6757
 Site-SynthDigits| Train Loss: 1.9764 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 2.0024 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.1986 | Train Acc: 0.1712
 Site-MNIST-M   | Train Loss: 2.1929 | Train Acc: 0.1982
 Site-MNIST     | Val  Loss: 1.7547 | Val  Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.6871 | Val  Acc: 0.5946
 Site-SVHN      | Val  Loss: 2.0231 | Val  Acc: 0.2973
 Site-SVHN      | Val  Loss: 1.9457 | Val  Acc: 0.4189
 Site-USPS      | Val  Loss: 1.6745 | Val  Acc: 0.7027
 Site-USPS      | Val  Loss: 1.6576 | Val  Acc: 0.7297
 Site-SynthDigits| Val  Loss: 2.0231 | Val  Acc: 0.2973
 Site-SynthDigits| Val  Loss: 1.9457 | Val  Acc: 0.4189
 Site-MNIST-M   | Val  Loss: 2.1972 | Val  Acc: 0.2297
 Site-MNIST-M   | Val  Loss: 2.2007 | Val  Acc: 0.1486
Average Valid Accuracy: 0.4351
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5135
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5946
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2973
 Best site-SVHN       | Epoch:0 | Val Acc: 0.4189
 Best site-USPS       | Epoch:0 | Val Acc: 0.7027
 Best site-USPS       | Epoch:0 | Val Acc: 0.7297
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2973
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.4189
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2297
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1486
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2761 | Train Acc: 0.6306
 Site-MNIST     | Train Loss: 1.3431 | Train Acc: 0.6216
 Site-SVHN      | Train Loss: 1.5835 | Train Acc: 0.5495
 Site-SVHN      | Train Loss: 1.6304 | Train Acc: 0.5495
 Site-USPS      | Train Loss: 1.0719 | Train Acc: 0.8198
 Site-USPS      | Train Loss: 1.1876 | Train Acc: 0.7207
 Site-SynthDigits| Train Loss: 1.5837 | Train Acc: 0.5495
 Site-SynthDigits| Train Loss: 1.6319 | Train Acc: 0.5495
 Site-MNIST-M   | Train Loss: 2.0274 | Train Acc: 0.2883
 Site-MNIST-M   | Train Loss: 2.0354 | Train Acc: 0.2973
 Site-MNIST     | Val  Loss: 1.3761 | Val  Acc: 0.6081
 Site-MNIST     | Val  Loss: 1.2197 | Val  Acc: 0.6892
 Site-SVHN      | Val  Loss: 1.6519 | Val  Acc: 0.5135
 Site-SVHN      | Val  Loss: 1.5563 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 1.1835 | Val  Acc: 0.7162
 Site-USPS      | Val  Loss: 1.1158 | Val  Acc: 0.7703
 Site-SynthDigits| Val  Loss: 1.6519 | Val  Acc: 0.5135
 Site-SynthDigits| Val  Loss: 1.5563 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 2.0417 | Val  Acc: 0.3108
 Site-MNIST-M   | Val  Loss: 2.0236 | Val  Acc: 0.2838
Average Valid Accuracy: 0.5649
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6081
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6892
 Best site-SVHN       | Epoch:1 | Val Acc: 0.5135
 Best site-SVHN       | Epoch:1 | Val Acc: 0.6216
 Best site-USPS       | Epoch:1 | Val Acc: 0.7162
 Best site-USPS       | Epoch:1 | Val Acc: 0.7703
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5135
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3108
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.7949 | Train Acc: 0.7838
 Site-MNIST     | Train Loss: 0.8444 | Train Acc: 0.8108
 Site-SVHN      | Train Loss: 1.2416 | Train Acc: 0.6396
 Site-SVHN      | Train Loss: 1.2575 | Train Acc: 0.6306
 Site-USPS      | Train Loss: 0.6821 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.7903 | Train Acc: 0.7928
 Site-SynthDigits| Train Loss: 1.2432 | Train Acc: 0.6396
 Site-SynthDigits| Train Loss: 1.2557 | Train Acc: 0.6306
 Site-MNIST-M   | Train Loss: 1.8513 | Train Acc: 0.3784
 Site-MNIST-M   | Train Loss: 1.8834 | Train Acc: 0.3694
 Site-MNIST     | Val  Loss: 0.8449 | Val  Acc: 0.8243
 Site-MNIST     | Val  Loss: 0.7610 | Val  Acc: 0.8108
 Site-SVHN      | Val  Loss: 1.2966 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 1.1958 | Val  Acc: 0.6622
 Site-USPS      | Val  Loss: 0.7793 | Val  Acc: 0.7838
 Site-USPS      | Val  Loss: 0.7361 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.2966 | Val  Acc: 0.5811
 Site-SynthDigits| Val  Loss: 1.1958 | Val  Acc: 0.6622
 Site-MNIST-M   | Val  Loss: 1.8698 | Val  Acc: 0.3919
 Site-MNIST-M   | Val  Loss: 1.8505 | Val  Acc: 0.3649
Average Valid Accuracy: 0.6486
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8243
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8108
 Best site-SVHN       | Epoch:2 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:2 | Val Acc: 0.6622
 Best site-USPS       | Epoch:2 | Val Acc: 0.7838
 Best site-USPS       | Epoch:2 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5811
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.6622
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3919
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.5505 | Train Acc: 0.8468
 Site-MNIST     | Train Loss: 0.6090 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 0.9843 | Train Acc: 0.6577
 Site-SVHN      | Train Loss: 0.9881 | Train Acc: 0.7027
 Site-USPS      | Train Loss: 0.4777 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.5668 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 0.9814 | Train Acc: 0.6577
 Site-SynthDigits| Train Loss: 0.9924 | Train Acc: 0.7027
 Site-MNIST-M   | Train Loss: 1.6026 | Train Acc: 0.4505
 Site-MNIST-M   | Train Loss: 1.6686 | Train Acc: 0.4595
 Site-MNIST     | Val  Loss: 0.6055 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.5470 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 1.0388 | Val  Acc: 0.7027
 Site-SVHN      | Val  Loss: 0.9352 | Val  Acc: 0.6622
 Site-USPS      | Val  Loss: 0.5493 | Val  Acc: 0.8378
 Site-USPS      | Val  Loss: 0.5292 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.0388 | Val  Acc: 0.7027
 Site-SynthDigits| Val  Loss: 0.9352 | Val  Acc: 0.6622
 Site-MNIST-M   | Val  Loss: 1.6769 | Val  Acc: 0.4595
 Site-MNIST-M   | Val  Loss: 1.5814 | Val  Acc: 0.4865
Average Valid Accuracy: 0.7122
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:3 | Val Acc: 0.7027
 Best site-SVHN       | Epoch:3 | Val Acc: 0.6622
 Best site-USPS       | Epoch:3 | Val Acc: 0.8378
 Best site-USPS       | Epoch:3 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.7027
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.6622
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4595
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.3720 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.4220 | Train Acc: 0.9009
 Site-SVHN      | Train Loss: 0.7123 | Train Acc: 0.7838
 Site-SVHN      | Train Loss: 0.6943 | Train Acc: 0.8198
 Site-USPS      | Train Loss: 0.3911 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.4467 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.7086 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.6936 | Train Acc: 0.8198
 Site-MNIST-M   | Train Loss: 1.3138 | Train Acc: 0.5766
 Site-MNIST-M   | Train Loss: 1.3856 | Train Acc: 0.5586
 Site-MNIST     | Val  Loss: 0.4141 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.3903 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 0.7370 | Val  Acc: 0.7973
 Site-SVHN      | Val  Loss: 0.6559 | Val  Acc: 0.7973
 Site-USPS      | Val  Loss: 0.4095 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.4367 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.7370 | Val  Acc: 0.7973
 Site-SynthDigits| Val  Loss: 0.6559 | Val  Acc: 0.7973
 Site-MNIST-M   | Val  Loss: 1.4010 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.2917 | Val  Acc: 0.5946
Average Valid Accuracy: 0.7919
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:4 | Val Acc: 0.7973
 Best site-SVHN       | Epoch:4 | Val Acc: 0.7973
 Best site-USPS       | Epoch:4 | Val Acc: 0.8649
 Best site-USPS       | Epoch:4 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.7973
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.7973
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5946
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2432 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.2896 | Train Acc: 0.9459
 Site-SVHN      | Train Loss: 0.5176 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 0.4912 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.2826 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.3390 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.5153 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 0.4890 | Train Acc: 0.8919
 Site-MNIST-M   | Train Loss: 1.1410 | Train Acc: 0.6306
 Site-MNIST-M   | Train Loss: 1.2456 | Train Acc: 0.5766
 Site-MNIST     | Val  Loss: 0.2710 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.2778 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 0.5250 | Val  Acc: 0.8919
 Site-SVHN      | Val  Loss: 0.4652 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.3024 | Val  Acc: 0.9459
 Site-USPS      | Val  Loss: 0.3422 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.5250 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 0.4652 | Val  Acc: 0.8649
 Site-MNIST-M   | Val  Loss: 1.2731 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 1.1241 | Val  Acc: 0.6216
Average Valid Accuracy: 0.8446
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:5 | Val Acc: 0.8919
 Best site-SVHN       | Epoch:5 | Val Acc: 0.8649
 Best site-USPS       | Epoch:5 | Val Acc: 0.9459
 Best site-USPS       | Epoch:5 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.8649
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6216
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1879 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.2148 | Train Acc: 0.9550
 Site-SVHN      | Train Loss: 0.3468 | Train Acc: 0.9640
 Site-SVHN      | Train Loss: 0.3497 | Train Acc: 0.9369
 Site-USPS      | Train Loss: 0.2337 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2665 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.3465 | Train Acc: 0.9640
 Site-SynthDigits| Train Loss: 0.3494 | Train Acc: 0.9369
 Site-MNIST-M   | Train Loss: 0.8701 | Train Acc: 0.7297
 Site-MNIST-M   | Train Loss: 1.0260 | Train Acc: 0.7117
 Site-MNIST     | Val  Loss: 0.1993 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.2056 | Val  Acc: 0.9324
 Site-SVHN      | Val  Loss: 0.3799 | Val  Acc: 0.9459
 Site-SVHN      | Val  Loss: 0.3242 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.2282 | Val  Acc: 0.9459
 Site-USPS      | Val  Loss: 0.2898 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.3799 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.3242 | Val  Acc: 0.9324
 Site-MNIST-M   | Val  Loss: 1.0554 | Val  Acc: 0.7027
 Site-MNIST-M   | Val  Loss: 0.8918 | Val  Acc: 0.7432
Average Valid Accuracy: 0.8959
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9324
 Best site-SVHN       | Epoch:6 | Val Acc: 0.9459
 Best site-SVHN       | Epoch:6 | Val Acc: 0.9324
 Best site-USPS       | Epoch:6 | Val Acc: 0.9459
 Best site-USPS       | Epoch:6 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.9324
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7027
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1745 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.1919 | Train Acc: 0.9550
 Site-SVHN      | Train Loss: 0.2136 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 0.2271 | Train Acc: 0.9820
 Site-USPS      | Train Loss: 0.2098 | Train Acc: 0.9369
 Site-USPS      | Train Loss: 0.2125 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.2136 | Train Acc: 0.9820
 Site-SynthDigits| Train Loss: 0.2268 | Train Acc: 0.9820
 Site-MNIST-M   | Train Loss: 0.6389 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 0.7947 | Train Acc: 0.8018
 Site-MNIST     | Val  Loss: 0.1834 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.1884 | Val  Acc: 0.9324
 Site-SVHN      | Val  Loss: 0.2414 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.2138 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.1785 | Val  Acc: 0.9595
 Site-USPS      | Val  Loss: 0.2543 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.2414 | Val  Acc: 0.9730
 Site-SynthDigits| Val  Loss: 0.2138 | Val  Acc: 0.9865
 Site-MNIST-M   | Val  Loss: 0.8250 | Val  Acc: 0.7703
 Site-MNIST-M   | Val  Loss: 0.6630 | Val  Acc: 0.8784
Average Valid Accuracy: 0.9351
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9324
 Best site-SVHN       | Epoch:7 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:7 | Val Acc: 0.9865
 Best site-USPS       | Epoch:7 | Val Acc: 0.9595
 Best site-USPS       | Epoch:7 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.9730
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.9865
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.7703
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1251 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.1398 | Train Acc: 0.9550
 Site-SVHN      | Train Loss: 0.1496 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 0.1528 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1547 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.1393 | Train Acc: 0.9640
 Site-SynthDigits| Train Loss: 0.1488 | Train Acc: 0.9820
 Site-SynthDigits| Train Loss: 0.1530 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.4321 | Train Acc: 0.9189
 Site-MNIST-M   | Train Loss: 0.5870 | Train Acc: 0.8829
 Site-MNIST     | Val  Loss: 0.1310 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.1298 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.1692 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.1354 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.1147 | Val  Acc: 0.9730
 Site-USPS      | Val  Loss: 0.1812 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.1692 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1354 | Val  Acc: 0.9865
 Site-MNIST-M   | Val  Loss: 0.6307 | Val  Acc: 0.8514
 Site-MNIST-M   | Val  Loss: 0.4553 | Val  Acc: 0.9459
Average Valid Accuracy: 0.9622
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:8 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:8 | Val Acc: 0.9865
 Best site-USPS       | Epoch:8 | Val Acc: 0.9730
 Best site-USPS       | Epoch:8 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:8 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9865
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.8514
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/CoCoOP...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0874 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.1026 | Train Acc: 0.9730
 Site-SVHN      | Train Loss: 0.1400 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 0.1236 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1189 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.0975 | Train Acc: 0.9640
 Site-SynthDigits| Train Loss: 0.1408 | Train Acc: 0.9910
 Site-SynthDigits| Train Loss: 0.1230 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.3108 | Train Acc: 0.9730
 Site-MNIST-M   | Train Loss: 0.4050 | Train Acc: 0.9099
 Site-MNIST     | Val  Loss: 0.0940 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.0949 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.1382 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.1160 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.0751 | Val  Acc: 0.9730
 Site-USPS      | Val  Loss: 0.1410 | Val  Acc: 0.9595
 Site-SynthDigits| Val  Loss: 0.1382 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1160 | Val  Acc: 0.9865
 Site-MNIST-M   | Val  Loss: 0.4433 | Val  Acc: 0.8919
 Site-MNIST-M   | Val  Loss: 0.3170 | Val  Acc: 0.9595
Average Valid Accuracy: 0.9716
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.9865
 Best site-USPS       | Epoch:9 | Val Acc: 0.9730
 Best site-USPS       | Epoch:9 | Val Acc: 0.9595
 Best site-SynthDigits | Epoch:9 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9865
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.8919
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_2ClientPerDomain/CoCoOP...
===2023-03-24 17:23:08===
===2023-03-24 17:23:10===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8600
 Test site-SVHN      | Epoch:9 | Test Acc: 0.6105
 Test site-USPS      | Epoch:9 | Test Acc: 0.8710
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.6105
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3764
Average Test Accuracy: 0.6657
