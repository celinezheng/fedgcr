===2023-08-08 02:25:15===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
============ Train epoch 0 ============
 Site-photo                         | Train Loss: 0.8315 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.7775 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 1.1767 | Train Acc: 0.7800
 Site-art_painting                  | Train Loss: 1.0947 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 1.3017 | Train Acc: 0.7600
 Site-cartoon                       | Train Loss: 1.3035 | Train Acc: 0.7533
 Site-sketch                        | Train Loss: 1.4810 | Train Acc: 0.5267
 Site-sketch                        | Train Loss: 1.4920 | Train Acc: 0.5267
Average Train Accuracy: 0.7714
 Site-photo                         | Val  Loss: 0.7763 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.7656 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 1.1184 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 1.1540 | Val  Acc: 0.8367
 Site-cartoon                       | Val  Loss: 1.2675 | Val  Acc: 0.7300
 Site-cartoon                       | Val  Loss: 1.2630 | Val  Acc: 0.7233
 Site-sketch                        | Val  Loss: 1.4575 | Val  Acc: 0.4700
 Site-sketch                        | Val  Loss: 1.4606 | Val  Acc: 0.4900
Average Valid Accuracy: 0.7642
 Best site-photo                     | Epoch:0 | Val Acc: 0.9800
 Best site-photo                     | Epoch:0 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:0 | Val Acc: 0.8900
 Best site-art_painting              | Epoch:0 | Val Acc: 0.8367
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.7300
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.7233
 Best site-sketch                    | Epoch:0 | Val Acc: 0.4700
 Best site-sketch                    | Epoch:0 | Val Acc: 0.4900
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 1 ============
 Site-photo                         | Train Loss: 0.3359 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.2848 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.8076 | Train Acc: 0.8267
 Site-art_painting                  | Train Loss: 0.8226 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.8386 | Train Acc: 0.7867
 Site-cartoon                       | Train Loss: 0.8599 | Train Acc: 0.8178
 Site-sketch                        | Train Loss: 1.2377 | Train Acc: 0.5800
 Site-sketch                        | Train Loss: 1.2476 | Train Acc: 0.5400
Average Train Accuracy: 0.7981
 Site-photo                         | Val  Loss: 0.2778 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.2737 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.6975 | Val  Acc: 0.8800
 Site-art_painting                  | Val  Loss: 0.7132 | Val  Acc: 0.8567
 Site-cartoon                       | Val  Loss: 0.8915 | Val  Acc: 0.7500
 Site-cartoon                       | Val  Loss: 0.8730 | Val  Acc: 0.8167
 Site-sketch                        | Val  Loss: 1.2061 | Val  Acc: 0.4700
 Site-sketch                        | Val  Loss: 1.2137 | Val  Acc: 0.5367
Average Valid Accuracy: 0.7863
 Best site-photo                     | Epoch:1 | Val Acc: 0.9900
 Best site-photo                     | Epoch:1 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:1 | Val Acc: 0.8800
 Best site-art_painting              | Epoch:1 | Val Acc: 0.8567
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.7500
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.8167
 Best site-sketch                    | Epoch:1 | Val Acc: 0.4700
 Best site-sketch                    | Epoch:1 | Val Acc: 0.5367
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 2 ============
 Site-photo                         | Train Loss: 0.1439 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.1114 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.6171 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.5972 | Train Acc: 0.9022
 Site-cartoon                       | Train Loss: 0.7414 | Train Acc: 0.7867
 Site-cartoon                       | Train Loss: 0.7093 | Train Acc: 0.8111
 Site-sketch                        | Train Loss: 1.1226 | Train Acc: 0.6200
 Site-sketch                        | Train Loss: 1.0635 | Train Acc: 0.5956
Average Train Accuracy: 0.8231
 Site-photo                         | Val  Loss: 0.1089 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1239 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.4772 | Val  Acc: 0.9400
 Site-art_painting                  | Val  Loss: 0.5087 | Val  Acc: 0.9000
 Site-cartoon                       | Val  Loss: 0.7167 | Val  Acc: 0.7900
 Site-cartoon                       | Val  Loss: 0.7145 | Val  Acc: 0.7833
 Site-sketch                        | Val  Loss: 1.0230 | Val  Acc: 0.5800
 Site-sketch                        | Val  Loss: 1.0259 | Val  Acc: 0.6267
Average Valid Accuracy: 0.8262
 Best site-photo                     | Epoch:2 | Val Acc: 1.0000
 Best site-photo                     | Epoch:2 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:2 | Val Acc: 0.9400
 Best site-art_painting              | Epoch:2 | Val Acc: 0.9000
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.7900
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.7833
 Best site-sketch                    | Epoch:2 | Val Acc: 0.5800
 Best site-sketch                    | Epoch:2 | Val Acc: 0.6267
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 3 ============
 Site-photo                         | Train Loss: 0.1254 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0650 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.5564 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.3800 | Train Acc: 0.9044
 Site-cartoon                       | Train Loss: 0.6481 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.8069 | Train Acc: 0.8400
 Site-sketch                        | Train Loss: 1.0391 | Train Acc: 0.6267
 Site-sketch                        | Train Loss: 0.9612 | Train Acc: 0.5889
Average Train Accuracy: 0.8233
 Site-photo                         | Val  Loss: 0.0618 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0691 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4155 | Val  Acc: 0.9000
 Site-art_painting                  | Val  Loss: 0.4493 | Val  Acc: 0.8933
 Site-cartoon                       | Val  Loss: 0.5786 | Val  Acc: 0.8200
 Site-cartoon                       | Val  Loss: 0.6194 | Val  Acc: 0.8067
 Site-sketch                        | Val  Loss: 0.9653 | Val  Acc: 0.5700
 Site-sketch                        | Val  Loss: 1.0159 | Val  Acc: 0.5733
Average Valid Accuracy: 0.8183
============ Train epoch 4 ============
 Site-photo                         | Train Loss: 0.0904 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.0552 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.5592 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.3073 | Train Acc: 0.9267
 Site-cartoon                       | Train Loss: 0.5812 | Train Acc: 0.8067
 Site-cartoon                       | Train Loss: 0.4987 | Train Acc: 0.8378
 Site-sketch                        | Train Loss: 0.8807 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.8687 | Train Acc: 0.5889
Average Train Accuracy: 0.8325
 Site-photo                         | Val  Loss: 0.0369 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0466 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.3422 | Val  Acc: 0.9200
 Site-art_painting                  | Val  Loss: 0.3252 | Val  Acc: 0.9333
 Site-cartoon                       | Val  Loss: 0.5703 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 0.6025 | Val  Acc: 0.8233
 Site-sketch                        | Val  Loss: 0.8242 | Val  Acc: 0.6200
 Site-sketch                        | Val  Loss: 0.9325 | Val  Acc: 0.6200
Average Valid Accuracy: 0.8450
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:4 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:4 | Val Acc: 0.9333
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.8500
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.8233
 Best site-sketch                    | Epoch:4 | Val Acc: 0.6200
 Best site-sketch                    | Epoch:4 | Val Acc: 0.6200
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 5 ============
 Site-photo                         | Train Loss: 0.1246 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0327 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4901 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.3135 | Train Acc: 0.9089
 Site-cartoon                       | Train Loss: 0.5809 | Train Acc: 0.8067
 Site-cartoon                       | Train Loss: 0.5544 | Train Acc: 0.8511
 Site-sketch                        | Train Loss: 0.9359 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.9808 | Train Acc: 0.6111
Average Train Accuracy: 0.8367
 Site-photo                         | Val  Loss: 0.0206 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0257 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.3158 | Val  Acc: 0.9500
 Site-art_painting                  | Val  Loss: 0.3085 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.5577 | Val  Acc: 0.8000
 Site-cartoon                       | Val  Loss: 0.5341 | Val  Acc: 0.8467
 Site-sketch                        | Val  Loss: 0.8317 | Val  Acc: 0.6400
 Site-sketch                        | Val  Loss: 0.8819 | Val  Acc: 0.6367
Average Valid Accuracy: 0.8500
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 0.9967
 Best site-art_painting              | Epoch:5 | Val Acc: 0.9500
 Best site-art_painting              | Epoch:5 | Val Acc: 0.9300
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.8000
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.8467
 Best site-sketch                    | Epoch:5 | Val Acc: 0.6400
 Best site-sketch                    | Epoch:5 | Val Acc: 0.6367
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 6 ============
 Site-photo                         | Train Loss: 0.0556 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0240 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.4531 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.2974 | Train Acc: 0.9289
 Site-cartoon                       | Train Loss: 0.5854 | Train Acc: 0.7867
 Site-cartoon                       | Train Loss: 0.4187 | Train Acc: 0.8533
 Site-sketch                        | Train Loss: 0.8992 | Train Acc: 0.7000
 Site-sketch                        | Train Loss: 0.7631 | Train Acc: 0.6911
Average Train Accuracy: 0.8508
 Site-photo                         | Val  Loss: 0.0320 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0284 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.2464 | Val  Acc: 0.9400
 Site-art_painting                  | Val  Loss: 0.2715 | Val  Acc: 0.9333
 Site-cartoon                       | Val  Loss: 0.4667 | Val  Acc: 0.8600
 Site-cartoon                       | Val  Loss: 0.4835 | Val  Acc: 0.8500
 Site-sketch                        | Val  Loss: 0.8142 | Val  Acc: 0.6200
 Site-sketch                        | Val  Loss: 0.8318 | Val  Acc: 0.6767
Average Valid Accuracy: 0.8579
 Best site-photo                     | Epoch:6 | Val Acc: 0.9900
 Best site-photo                     | Epoch:6 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9400
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9333
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.8600
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.8500
 Best site-sketch                    | Epoch:6 | Val Acc: 0.6200
 Best site-sketch                    | Epoch:6 | Val Acc: 0.6767
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 7 ============
 Site-photo                         | Train Loss: 0.0712 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.0218 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3800 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.2559 | Train Acc: 0.9378
 Site-cartoon                       | Train Loss: 0.5313 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.3856 | Train Acc: 0.8711
 Site-sketch                        | Train Loss: 0.8362 | Train Acc: 0.7400
 Site-sketch                        | Train Loss: 0.7381 | Train Acc: 0.6867
Average Train Accuracy: 0.8689
 Site-photo                         | Val  Loss: 0.0127 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0176 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1968 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.2748 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.4492 | Val  Acc: 0.8600
 Site-cartoon                       | Val  Loss: 0.4456 | Val  Acc: 0.8667
 Site-sketch                        | Val  Loss: 0.8013 | Val  Acc: 0.7500
 Site-sketch                        | Val  Loss: 0.8427 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8846
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:7 | Val Acc: 0.9700
 Best site-art_painting              | Epoch:7 | Val Acc: 0.9300
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.8600
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.8667
 Best site-sketch                    | Epoch:7 | Val Acc: 0.7500
 Best site-sketch                    | Epoch:7 | Val Acc: 0.7000
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 8 ============
 Site-photo                         | Train Loss: 0.0447 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0184 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.3182 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.2327 | Train Acc: 0.9311
 Site-cartoon                       | Train Loss: 0.5048 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.4097 | Train Acc: 0.8844
 Site-sketch                        | Train Loss: 0.7720 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.7217 | Train Acc: 0.7244
Average Train Accuracy: 0.8667
 Site-photo                         | Val  Loss: 0.0311 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0260 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.1775 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.2405 | Val  Acc: 0.9333
 Site-cartoon                       | Val  Loss: 0.4449 | Val  Acc: 0.8300
 Site-cartoon                       | Val  Loss: 0.4525 | Val  Acc: 0.8567
 Site-sketch                        | Val  Loss: 0.6995 | Val  Acc: 0.7000
 Site-sketch                        | Val  Loss: 0.7810 | Val  Acc: 0.7133
Average Valid Accuracy: 0.8746
============ Train epoch 9 ============
 Site-photo                         | Train Loss: 0.0469 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0231 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4282 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.2052 | Train Acc: 0.9400
 Site-cartoon                       | Train Loss: 0.4784 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.3733 | Train Acc: 0.8956
 Site-sketch                        | Train Loss: 0.8565 | Train Acc: 0.7200
 Site-sketch                        | Train Loss: 0.7832 | Train Acc: 0.7089
Average Train Accuracy: 0.8719
 Site-photo                         | Val  Loss: 0.0157 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0179 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.2414 | Val  Acc: 0.9500
 Site-art_painting                  | Val  Loss: 0.2451 | Val  Acc: 0.9267
 Site-cartoon                       | Val  Loss: 0.4082 | Val  Acc: 0.8300
 Site-cartoon                       | Val  Loss: 0.4073 | Val  Acc: 0.8833
 Site-sketch                        | Val  Loss: 0.7363 | Val  Acc: 0.6800
 Site-sketch                        | Val  Loss: 0.7653 | Val  Acc: 0.7033
Average Valid Accuracy: 0.8708
============ Train epoch 10 ============
 Site-photo                         | Train Loss: 0.0417 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0182 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.2827 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.1879 | Train Acc: 0.9489
 Site-cartoon                       | Train Loss: 0.4976 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.3806 | Train Acc: 0.8733
 Site-sketch                        | Train Loss: 0.7877 | Train Acc: 0.7600
 Site-sketch                        | Train Loss: 0.7178 | Train Acc: 0.7422
Average Train Accuracy: 0.8806
 Site-photo                         | Val  Loss: 0.0046 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0108 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.2247 | Val  Acc: 0.9600
 Site-art_painting                  | Val  Loss: 0.2202 | Val  Acc: 0.9433
 Site-cartoon                       | Val  Loss: 0.3812 | Val  Acc: 0.8800
 Site-cartoon                       | Val  Loss: 0.3806 | Val  Acc: 0.8800
 Site-sketch                        | Val  Loss: 0.6586 | Val  Acc: 0.7500
 Site-sketch                        | Val  Loss: 0.7092 | Val  Acc: 0.7467
Average Valid Accuracy: 0.8942
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9600
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9433
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.8800
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.8800
 Best site-sketch                    | Epoch:10 | Val Acc: 0.7500
 Best site-sketch                    | Epoch:10 | Val Acc: 0.7467
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 11 ============
 Site-photo                         | Train Loss: 0.0396 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0196 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3118 | Train Acc: 0.9067
 Site-art_painting                  | Train Loss: 0.2136 | Train Acc: 0.9400
 Site-cartoon                       | Train Loss: 0.4547 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.5407 | Train Acc: 0.8933
 Site-sketch                        | Train Loss: 0.6845 | Train Acc: 0.7867
 Site-sketch                        | Train Loss: 0.7424 | Train Acc: 0.7378
Average Train Accuracy: 0.8850
 Site-photo                         | Val  Loss: 0.0088 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0154 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.1352 | Val  Acc: 0.9500
 Site-art_painting                  | Val  Loss: 0.1923 | Val  Acc: 0.9567
 Site-cartoon                       | Val  Loss: 0.3633 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 0.3879 | Val  Acc: 0.8800
 Site-sketch                        | Val  Loss: 0.6200 | Val  Acc: 0.7900
 Site-sketch                        | Val  Loss: 0.7198 | Val  Acc: 0.7467
Average Valid Accuracy: 0.8962
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 0.9967
 Best site-art_painting              | Epoch:11 | Val Acc: 0.9500
 Best site-art_painting              | Epoch:11 | Val Acc: 0.9567
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.8500
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.8800
 Best site-sketch                    | Epoch:11 | Val Acc: 0.7900
 Best site-sketch                    | Epoch:11 | Val Acc: 0.7467
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 12 ============
 Site-photo                         | Train Loss: 0.0334 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0167 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.3540 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.1804 | Train Acc: 0.9556
 Site-cartoon                       | Train Loss: 0.4094 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.2748 | Train Acc: 0.9111
 Site-sketch                        | Train Loss: 0.7968 | Train Acc: 0.7267
 Site-sketch                        | Train Loss: 0.6493 | Train Acc: 0.7244
Average Train Accuracy: 0.8847
 Site-photo                         | Val  Loss: 0.0048 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0155 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.2099 | Val  Acc: 0.9500
 Site-art_painting                  | Val  Loss: 0.1793 | Val  Acc: 0.9367
 Site-cartoon                       | Val  Loss: 0.3286 | Val  Acc: 0.8800
 Site-cartoon                       | Val  Loss: 0.3277 | Val  Acc: 0.8867
 Site-sketch                        | Val  Loss: 0.6447 | Val  Acc: 0.7300
 Site-sketch                        | Val  Loss: 0.7176 | Val  Acc: 0.7367
Average Valid Accuracy: 0.8896
============ Train epoch 13 ============
 Site-photo                         | Train Loss: 0.0295 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0133 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3274 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.1874 | Train Acc: 0.9400
 Site-cartoon                       | Train Loss: 0.3862 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.3061 | Train Acc: 0.9022
 Site-sketch                        | Train Loss: 0.7605 | Train Acc: 0.7267
 Site-sketch                        | Train Loss: 0.6948 | Train Acc: 0.7422
Average Train Accuracy: 0.8792
 Site-photo                         | Val  Loss: 0.0144 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0070 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1519 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1789 | Val  Acc: 0.9433
 Site-cartoon                       | Val  Loss: 0.3269 | Val  Acc: 0.9200
 Site-cartoon                       | Val  Loss: 0.3003 | Val  Acc: 0.9267
 Site-sketch                        | Val  Loss: 0.6562 | Val  Acc: 0.7400
 Site-sketch                        | Val  Loss: 0.7191 | Val  Acc: 0.7367
Average Valid Accuracy: 0.9033
 Best site-photo                     | Epoch:13 | Val Acc: 0.9900
 Best site-photo                     | Epoch:13 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:13 | Val Acc: 0.9700
 Best site-art_painting              | Epoch:13 | Val Acc: 0.9433
 Best site-cartoon                   | Epoch:13 | Val Acc: 0.9200
 Best site-cartoon                   | Epoch:13 | Val Acc: 0.9267
 Best site-sketch                    | Epoch:13 | Val Acc: 0.7400
 Best site-sketch                    | Epoch:13 | Val Acc: 0.7367
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 14 ============
 Site-photo                         | Train Loss: 0.0197 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0152 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3144 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1723 | Train Acc: 0.9556
 Site-cartoon                       | Train Loss: 0.4299 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.2806 | Train Acc: 0.9111
 Site-sketch                        | Train Loss: 0.8320 | Train Acc: 0.7400
 Site-sketch                        | Train Loss: 0.6396 | Train Acc: 0.7844
Average Train Accuracy: 0.8908
 Site-photo                         | Val  Loss: 0.0052 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1435 | Val  Acc: 0.9600
 Site-art_painting                  | Val  Loss: 0.1462 | Val  Acc: 0.9633
 Site-cartoon                       | Val  Loss: 0.3044 | Val  Acc: 0.9100
 Site-cartoon                       | Val  Loss: 0.2910 | Val  Acc: 0.9200
 Site-sketch                        | Val  Loss: 0.6537 | Val  Acc: 0.7800
 Site-sketch                        | Val  Loss: 0.7040 | Val  Acc: 0.7400
Average Valid Accuracy: 0.9092
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:14 | Val Acc: 0.9600
 Best site-art_painting              | Epoch:14 | Val Acc: 0.9633
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.9100
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.9200
 Best site-sketch                    | Epoch:14 | Val Acc: 0.7800
 Best site-sketch                    | Epoch:14 | Val Acc: 0.7400
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 15 ============
 Site-photo                         | Train Loss: 0.0332 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0092 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3170 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.1520 | Train Acc: 0.9489
 Site-cartoon                       | Train Loss: 0.4396 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.3031 | Train Acc: 0.9067
 Site-sketch                        | Train Loss: 0.6980 | Train Acc: 0.7467
 Site-sketch                        | Train Loss: 0.6243 | Train Acc: 0.7444
Average Train Accuracy: 0.8861
 Site-photo                         | Val  Loss: 0.0160 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1580 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1663 | Val  Acc: 0.9567
 Site-cartoon                       | Val  Loss: 0.2932 | Val  Acc: 0.9200
 Site-cartoon                       | Val  Loss: 0.3048 | Val  Acc: 0.9033
 Site-sketch                        | Val  Loss: 0.6477 | Val  Acc: 0.7000
 Site-sketch                        | Val  Loss: 0.6577 | Val  Acc: 0.7433
Average Valid Accuracy: 0.8979
============ Train epoch 16 ============
 Site-photo                         | Train Loss: 0.0726 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0056 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2610 | Train Acc: 0.9267
 Site-art_painting                  | Train Loss: 0.1532 | Train Acc: 0.9644
 Site-cartoon                       | Train Loss: 0.4311 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.2656 | Train Acc: 0.9111
 Site-sketch                        | Train Loss: 0.7989 | Train Acc: 0.7400
 Site-sketch                        | Train Loss: 0.6738 | Train Acc: 0.7667
Average Train Accuracy: 0.8928
 Site-photo                         | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0132 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.1517 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1525 | Val  Acc: 0.9533
 Site-cartoon                       | Val  Loss: 0.3380 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 0.2617 | Val  Acc: 0.9300
 Site-sketch                        | Val  Loss: 0.5382 | Val  Acc: 0.7900
 Site-sketch                        | Val  Loss: 0.6639 | Val  Acc: 0.7733
Average Valid Accuracy: 0.9079
============ Train epoch 17 ============
 Site-photo                         | Train Loss: 0.0264 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0109 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3616 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.1453 | Train Acc: 0.9533
 Site-cartoon                       | Train Loss: 0.4927 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.2530 | Train Acc: 0.9222
 Site-sketch                        | Train Loss: 0.7232 | Train Acc: 0.7133
 Site-sketch                        | Train Loss: 0.9376 | Train Acc: 0.7689
Average Train Accuracy: 0.8844
 Site-photo                         | Val  Loss: 0.0277 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0053 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1483 | Val  Acc: 0.9600
 Site-art_painting                  | Val  Loss: 0.1314 | Val  Acc: 0.9567
 Site-cartoon                       | Val  Loss: 0.3154 | Val  Acc: 0.9000
 Site-cartoon                       | Val  Loss: 0.3168 | Val  Acc: 0.8933
 Site-sketch                        | Val  Loss: 0.5335 | Val  Acc: 0.8000
 Site-sketch                        | Val  Loss: 0.6667 | Val  Acc: 0.7633
Average Valid Accuracy: 0.9079
============ Train epoch 18 ============
 Site-photo                         | Train Loss: 0.0437 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0071 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3814 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1466 | Train Acc: 0.9667
 Site-cartoon                       | Train Loss: 0.3869 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.2499 | Train Acc: 0.9133
 Site-sketch                        | Train Loss: 0.7157 | Train Acc: 0.7800
 Site-sketch                        | Train Loss: 0.5529 | Train Acc: 0.7733
Average Train Accuracy: 0.8956
 Site-photo                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0053 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1803 | Val  Acc: 0.9400
 Site-art_painting                  | Val  Loss: 0.1327 | Val  Acc: 0.9633
 Site-cartoon                       | Val  Loss: 0.2691 | Val  Acc: 0.8900
 Site-cartoon                       | Val  Loss: 0.2678 | Val  Acc: 0.9200
 Site-sketch                        | Val  Loss: 0.5520 | Val  Acc: 0.7900
 Site-sketch                        | Val  Loss: 0.6191 | Val  Acc: 0.7800
Average Valid Accuracy: 0.9104
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:18 | Val Acc: 0.9400
 Best site-art_painting              | Epoch:18 | Val Acc: 0.9633
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.8900
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.9200
 Best site-sketch                    | Epoch:18 | Val Acc: 0.7900
 Best site-sketch                    | Epoch:18 | Val Acc: 0.7800
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 19 ============
 Site-photo                         | Train Loss: 0.0680 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0082 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3005 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.1507 | Train Acc: 0.9533
 Site-cartoon                       | Train Loss: 0.3646 | Train Acc: 0.8867
 Site-cartoon                       | Train Loss: 0.2279 | Train Acc: 0.9222
 Site-sketch                        | Train Loss: 0.7268 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 0.5841 | Train Acc: 0.7667
Average Train Accuracy: 0.8967
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1745 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.1644 | Val  Acc: 0.9633
 Site-cartoon                       | Val  Loss: 0.2463 | Val  Acc: 0.9100
 Site-cartoon                       | Val  Loss: 0.2631 | Val  Acc: 0.9100
 Site-sketch                        | Val  Loss: 0.6107 | Val  Acc: 0.7600
 Site-sketch                        | Val  Loss: 0.6052 | Val  Acc: 0.7700
Average Valid Accuracy: 0.9054
============ Train epoch 20 ============
 Site-photo                         | Train Loss: 0.0448 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0074 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2606 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.1376 | Train Acc: 0.9622
 Site-cartoon                       | Train Loss: 0.3862 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.2536 | Train Acc: 0.9022
 Site-sketch                        | Train Loss: 0.6668 | Train Acc: 0.7933
 Site-sketch                        | Train Loss: 0.6141 | Train Acc: 0.7933
Average Train Accuracy: 0.9036
 Site-photo                         | Val  Loss: 0.0274 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0141 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.1223 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1411 | Val  Acc: 0.9567
 Site-cartoon                       | Val  Loss: 0.2744 | Val  Acc: 0.9400
 Site-cartoon                       | Val  Loss: 0.2569 | Val  Acc: 0.9167
 Site-sketch                        | Val  Loss: 0.5268 | Val  Acc: 0.8400
 Site-sketch                        | Val  Loss: 0.6220 | Val  Acc: 0.7800
Average Valid Accuracy: 0.9238
 Best site-photo                     | Epoch:20 | Val Acc: 0.9900
 Best site-photo                     | Epoch:20 | Val Acc: 0.9967
 Best site-art_painting              | Epoch:20 | Val Acc: 0.9700
 Best site-art_painting              | Epoch:20 | Val Acc: 0.9567
 Best site-cartoon                   | Epoch:20 | Val Acc: 0.9400
 Best site-cartoon                   | Epoch:20 | Val Acc: 0.9167
 Best site-sketch                    | Epoch:20 | Val Acc: 0.8400
 Best site-sketch                    | Epoch:20 | Val Acc: 0.7800
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 21 ============
 Site-photo                         | Train Loss: 0.0203 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0087 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2879 | Train Acc: 0.9067
 Site-art_painting                  | Train Loss: 0.1697 | Train Acc: 0.9511
 Site-cartoon                       | Train Loss: 0.3831 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.2244 | Train Acc: 0.9200
 Site-sketch                        | Train Loss: 0.6756 | Train Acc: 0.7400
 Site-sketch                        | Train Loss: 0.6644 | Train Acc: 0.7622
Average Train Accuracy: 0.8939
 Site-photo                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0088 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.1307 | Val  Acc: 0.9400
 Site-art_painting                  | Val  Loss: 0.1470 | Val  Acc: 0.9633
 Site-cartoon                       | Val  Loss: 0.3002 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 0.2839 | Val  Acc: 0.9067
 Site-sketch                        | Val  Loss: 0.5779 | Val  Acc: 0.7800
 Site-sketch                        | Val  Loss: 0.6405 | Val  Acc: 0.7467
Average Valid Accuracy: 0.8979
============ Train epoch 22 ============
 Site-photo                         | Train Loss: 0.0375 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0050 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3142 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.2066 | Train Acc: 0.9378
 Site-cartoon                       | Train Loss: 0.4083 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.2139 | Train Acc: 0.9311
 Site-sketch                        | Train Loss: 0.5991 | Train Acc: 0.7867
 Site-sketch                        | Train Loss: 0.6082 | Train Acc: 0.7689
Average Train Accuracy: 0.9039
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1254 | Val  Acc: 0.9600
 Site-art_painting                  | Val  Loss: 0.1396 | Val  Acc: 0.9633
 Site-cartoon                       | Val  Loss: 0.2564 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.2476 | Val  Acc: 0.9233
 Site-sketch                        | Val  Loss: 0.6214 | Val  Acc: 0.7900
 Site-sketch                        | Val  Loss: 0.6051 | Val  Acc: 0.7600
Average Valid Accuracy: 0.9158
============ Train epoch 23 ============
 Site-photo                         | Train Loss: 0.0256 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0090 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2926 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.1285 | Train Acc: 0.9578
 Site-cartoon                       | Train Loss: 0.3697 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.2255 | Train Acc: 0.9356
 Site-sketch                        | Train Loss: 0.6176 | Train Acc: 0.7933
 Site-sketch                        | Train Loss: 0.5505 | Train Acc: 0.7644
Average Train Accuracy: 0.9019
 Site-photo                         | Val  Loss: 0.0166 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1330 | Val  Acc: 0.9600
 Site-art_painting                  | Val  Loss: 0.1257 | Val  Acc: 0.9633
 Site-cartoon                       | Val  Loss: 0.2389 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.2421 | Val  Acc: 0.9200
 Site-sketch                        | Val  Loss: 0.4739 | Val  Acc: 0.8100
 Site-sketch                        | Val  Loss: 0.5993 | Val  Acc: 0.7767
Average Valid Accuracy: 0.9187
============ Train epoch 24 ============
 Site-photo                         | Train Loss: 0.0388 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2758 | Train Acc: 0.9333
 Site-art_painting                  | Train Loss: 0.1217 | Train Acc: 0.9644
 Site-cartoon                       | Train Loss: 0.3570 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.3325 | Train Acc: 0.9356
 Site-sketch                        | Train Loss: 0.6366 | Train Acc: 0.7800
 Site-sketch                        | Train Loss: 0.5404 | Train Acc: 0.7867
Average Train Accuracy: 0.9067
 Site-photo                         | Val  Loss: 0.0121 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0181 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.1156 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1450 | Val  Acc: 0.9533
 Site-cartoon                       | Val  Loss: 0.2414 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.2282 | Val  Acc: 0.9400
 Site-sketch                        | Val  Loss: 0.5893 | Val  Acc: 0.7300
 Site-sketch                        | Val  Loss: 0.5469 | Val  Acc: 0.8100
Average Valid Accuracy: 0.9150
============ Train epoch 25 ============
 Site-photo                         | Train Loss: 0.0194 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0091 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2749 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.1369 | Train Acc: 0.9578
 Site-cartoon                       | Train Loss: 0.4108 | Train Acc: 0.8867
 Site-cartoon                       | Train Loss: 0.2007 | Train Acc: 0.9289
 Site-sketch                        | Train Loss: 0.5886 | Train Acc: 0.8067
 Site-sketch                        | Train Loss: 0.5163 | Train Acc: 0.7978
Average Train Accuracy: 0.9061
 Site-photo                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1088 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.1138 | Val  Acc: 0.9667
 Site-cartoon                       | Val  Loss: 0.2692 | Val  Acc: 0.8900
 Site-cartoon                       | Val  Loss: 0.1994 | Val  Acc: 0.9433
 Site-sketch                        | Val  Loss: 0.5360 | Val  Acc: 0.7900
 Site-sketch                        | Val  Loss: 0.5555 | Val  Acc: 0.7900
Average Valid Accuracy: 0.9200
============ Train epoch 26 ============
 Site-photo                         | Train Loss: 0.0654 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0084 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3390 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.1614 | Train Acc: 0.9511
 Site-cartoon                       | Train Loss: 0.4624 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.2616 | Train Acc: 0.9311
 Site-sketch                        | Train Loss: 0.7208 | Train Acc: 0.7800
 Site-sketch                        | Train Loss: 0.6681 | Train Acc: 0.7756
Average Train Accuracy: 0.8919
 Site-photo                         | Val  Loss: 0.0083 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1035 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1294 | Val  Acc: 0.9633
 Site-cartoon                       | Val  Loss: 0.2052 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.2147 | Val  Acc: 0.9367
 Site-sketch                        | Val  Loss: 0.5485 | Val  Acc: 0.7800
 Site-sketch                        | Val  Loss: 0.5733 | Val  Acc: 0.8000
Average Valid Accuracy: 0.9213
============ Train epoch 27 ============
 Site-photo                         | Train Loss: 0.0406 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0069 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2334 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.1135 | Train Acc: 0.9667
 Site-cartoon                       | Train Loss: 0.3941 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.1840 | Train Acc: 0.9444
 Site-sketch                        | Train Loss: 0.6235 | Train Acc: 0.7800
 Site-sketch                        | Train Loss: 0.6163 | Train Acc: 0.8267
Average Train Accuracy: 0.9086
 Site-photo                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1116 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.1242 | Val  Acc: 0.9567
 Site-cartoon                       | Val  Loss: 0.1754 | Val  Acc: 0.9600
 Site-cartoon                       | Val  Loss: 0.2111 | Val  Acc: 0.9367
 Site-sketch                        | Val  Loss: 0.4710 | Val  Acc: 0.8200
 Site-sketch                        | Val  Loss: 0.5716 | Val  Acc: 0.8167
Average Valid Accuracy: 0.9337
 Best site-photo                     | Epoch:27 | Val Acc: 1.0000
 Best site-photo                     | Epoch:27 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:27 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:27 | Val Acc: 0.9567
 Best site-cartoon                   | Epoch:27 | Val Acc: 0.9600
 Best site-cartoon                   | Epoch:27 | Val Acc: 0.9367
 Best site-sketch                    | Epoch:27 | Val Acc: 0.8200
 Best site-sketch                    | Epoch:27 | Val Acc: 0.8167
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 28 ============
 Site-photo                         | Train Loss: 0.0258 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3371 | Train Acc: 0.9067
 Site-art_painting                  | Train Loss: 0.1088 | Train Acc: 0.9733
 Site-cartoon                       | Train Loss: 0.3761 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.1794 | Train Acc: 0.9400
 Site-sketch                        | Train Loss: 0.6099 | Train Acc: 0.7800
 Site-sketch                        | Train Loss: 0.6834 | Train Acc: 0.7844
Average Train Accuracy: 0.9022
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0127 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.0637 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1010 | Val  Acc: 0.9733
 Site-cartoon                       | Val  Loss: 0.1797 | Val  Acc: 0.9400
 Site-cartoon                       | Val  Loss: 0.1838 | Val  Acc: 0.9433
 Site-sketch                        | Val  Loss: 0.5271 | Val  Acc: 0.7900
 Site-sketch                        | Val  Loss: 0.5576 | Val  Acc: 0.7967
Average Valid Accuracy: 0.9300
============ Train epoch 29 ============
 Site-photo                         | Train Loss: 0.0224 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0041 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2575 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.1022 | Train Acc: 0.9689
 Site-cartoon                       | Train Loss: 0.4374 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.1754 | Train Acc: 0.9467
 Site-sketch                        | Train Loss: 0.6185 | Train Acc: 0.7800
 Site-sketch                        | Train Loss: 0.6275 | Train Acc: 0.7600
Average Train Accuracy: 0.9042
 Site-photo                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0065 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.0936 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.0820 | Val  Acc: 0.9933
 Site-cartoon                       | Val  Loss: 0.2327 | Val  Acc: 0.9200
 Site-cartoon                       | Val  Loss: 0.1971 | Val  Acc: 0.9367
 Site-sketch                        | Val  Loss: 0.4830 | Val  Acc: 0.7700
 Site-sketch                        | Val  Loss: 0.5655 | Val  Acc: 0.7767
Average Valid Accuracy: 0.9204
============ Train epoch 30 ============
 Site-photo                         | Train Loss: 0.0328 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0040 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2910 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1162 | Train Acc: 0.9622
 Site-cartoon                       | Train Loss: 0.3082 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.1741 | Train Acc: 0.9467
 Site-sketch                        | Train Loss: 0.6427 | Train Acc: 0.7400
 Site-sketch                        | Train Loss: 0.4934 | Train Acc: 0.8000
Average Train Accuracy: 0.9033
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1198 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.1092 | Val  Acc: 0.9667
 Site-cartoon                       | Val  Loss: 0.2155 | Val  Acc: 0.9200
 Site-cartoon                       | Val  Loss: 0.2365 | Val  Acc: 0.9167
 Site-sketch                        | Val  Loss: 0.5456 | Val  Acc: 0.7600
 Site-sketch                        | Val  Loss: 0.5625 | Val  Acc: 0.7833
Average Valid Accuracy: 0.9158
============ Train epoch 31 ============
 Site-photo                         | Train Loss: 0.0378 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0057 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3062 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1674 | Train Acc: 0.9711
 Site-cartoon                       | Train Loss: 0.4041 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.1602 | Train Acc: 0.9511
 Site-sketch                        | Train Loss: 0.6259 | Train Acc: 0.7867
 Site-sketch                        | Train Loss: 0.5102 | Train Acc: 0.8022
Average Train Accuracy: 0.9103
 Site-photo                         | Val  Loss: 0.0201 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0922 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.1215 | Val  Acc: 0.9700
 Site-cartoon                       | Val  Loss: 0.2019 | Val  Acc: 0.9600
 Site-cartoon                       | Val  Loss: 0.2170 | Val  Acc: 0.9400
 Site-sketch                        | Val  Loss: 0.4658 | Val  Acc: 0.8100
 Site-sketch                        | Val  Loss: 0.5784 | Val  Acc: 0.7733
Average Valid Accuracy: 0.9279
============ Train epoch 32 ============
 Site-photo                         | Train Loss: 0.0119 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2058 | Train Acc: 0.9400
 Site-art_painting                  | Train Loss: 0.1067 | Train Acc: 0.9778
 Site-cartoon                       | Train Loss: 0.2900 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.1636 | Train Acc: 0.9511
 Site-sketch                        | Train Loss: 0.5765 | Train Acc: 0.7933
 Site-sketch                        | Train Loss: 0.6365 | Train Acc: 0.7689
Average Train Accuracy: 0.9156
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0528 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.1104 | Val  Acc: 0.9700
 Site-cartoon                       | Val  Loss: 0.1651 | Val  Acc: 0.9400
 Site-cartoon                       | Val  Loss: 0.2054 | Val  Acc: 0.9467
 Site-sketch                        | Val  Loss: 0.4918 | Val  Acc: 0.8200
 Site-sketch                        | Val  Loss: 0.5097 | Val  Acc: 0.8100
Average Valid Accuracy: 0.9346
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:32 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:32 | Val Acc: 0.9700
 Best site-cartoon                   | Epoch:32 | Val Acc: 0.9400
 Best site-cartoon                   | Epoch:32 | Val Acc: 0.9467
 Best site-sketch                    | Epoch:32 | Val Acc: 0.8200
 Best site-sketch                    | Epoch:32 | Val Acc: 0.8100
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 33 ============
 Site-photo                         | Train Loss: 0.0356 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0020 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3307 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.1344 | Train Acc: 0.9778
 Site-cartoon                       | Train Loss: 0.3398 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.1549 | Train Acc: 0.9489
 Site-sketch                        | Train Loss: 0.5423 | Train Acc: 0.8133
 Site-sketch                        | Train Loss: 0.5032 | Train Acc: 0.7911
Average Train Accuracy: 0.9131
 Site-photo                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1021 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.0854 | Val  Acc: 0.9767
 Site-cartoon                       | Val  Loss: 0.1998 | Val  Acc: 0.9400
 Site-cartoon                       | Val  Loss: 0.1898 | Val  Acc: 0.9400
 Site-sketch                        | Val  Loss: 0.4764 | Val  Acc: 0.8000
 Site-sketch                        | Val  Loss: 0.5070 | Val  Acc: 0.8167
Average Valid Accuracy: 0.9329
============ Train epoch 34 ============
 Site-photo                         | Train Loss: 0.0127 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0042 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2241 | Train Acc: 0.9400
 Site-art_painting                  | Train Loss: 0.1375 | Train Acc: 0.9822
 Site-cartoon                       | Train Loss: 0.3194 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.2855 | Train Acc: 0.9533
 Site-sketch                        | Train Loss: 0.4994 | Train Acc: 0.8267
 Site-sketch                        | Train Loss: 0.5197 | Train Acc: 0.8000
Average Train Accuracy: 0.9242
 Site-photo                         | Val  Loss: 0.0276 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0883 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.0897 | Val  Acc: 0.9833
 Site-cartoon                       | Val  Loss: 0.2163 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.1870 | Val  Acc: 0.9300
 Site-sketch                        | Val  Loss: 0.4799 | Val  Acc: 0.8000
 Site-sketch                        | Val  Loss: 0.5034 | Val  Acc: 0.8267
Average Valid Accuracy: 0.9312
============ Train epoch 35 ============
 Site-photo                         | Train Loss: 0.0170 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2443 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.1264 | Train Acc: 0.9600
 Site-cartoon                       | Train Loss: 0.3058 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.1654 | Train Acc: 0.9511
 Site-sketch                        | Train Loss: 0.6056 | Train Acc: 0.7600
 Site-sketch                        | Train Loss: 0.4726 | Train Acc: 0.8267
Average Train Accuracy: 0.9114
 Site-photo                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0959 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.1030 | Val  Acc: 0.9700
 Site-cartoon                       | Val  Loss: 0.1443 | Val  Acc: 0.9500
 Site-cartoon                       | Val  Loss: 0.1879 | Val  Acc: 0.9400
 Site-sketch                        | Val  Loss: 0.5462 | Val  Acc: 0.7600
 Site-sketch                        | Val  Loss: 0.5106 | Val  Acc: 0.8267
Average Valid Accuracy: 0.9283
============ Train epoch 36 ============
 Site-photo                         | Train Loss: 0.0289 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0062 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2283 | Train Acc: 0.9067
 Site-art_painting                  | Train Loss: 0.1067 | Train Acc: 0.9689
 Site-cartoon                       | Train Loss: 0.3349 | Train Acc: 0.9067
 Site-cartoon                       | Train Loss: 0.1284 | Train Acc: 0.9622
 Site-sketch                        | Train Loss: 0.5569 | Train Acc: 0.7867
 Site-sketch                        | Train Loss: 0.5168 | Train Acc: 0.7933
Average Train Accuracy: 0.9144
 Site-photo                         | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0914 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.0867 | Val  Acc: 0.9767
 Site-cartoon                       | Val  Loss: 0.1346 | Val  Acc: 0.9700
 Site-cartoon                       | Val  Loss: 0.1789 | Val  Acc: 0.9500
 Site-sketch                        | Val  Loss: 0.4462 | Val  Acc: 0.8100
 Site-sketch                        | Val  Loss: 0.4979 | Val  Acc: 0.8300
Average Valid Accuracy: 0.9396
 Best site-photo                     | Epoch:36 | Val Acc: 1.0000
 Best site-photo                     | Epoch:36 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:36 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:36 | Val Acc: 0.9767
 Best site-cartoon                   | Epoch:36 | Val Acc: 0.9700
 Best site-cartoon                   | Epoch:36 | Val Acc: 0.9500
 Best site-sketch                    | Epoch:36 | Val Acc: 0.8100
 Best site-sketch                    | Epoch:36 | Val Acc: 0.8300
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 37 ============
 Site-photo                         | Train Loss: 0.0150 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3253 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.0904 | Train Acc: 0.9800
 Site-cartoon                       | Train Loss: 0.2828 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.1436 | Train Acc: 0.9556
 Site-sketch                        | Train Loss: 0.5848 | Train Acc: 0.7533
 Site-sketch                        | Train Loss: 0.5190 | Train Acc: 0.7956
Average Train Accuracy: 0.9089
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0912 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.0856 | Val  Acc: 0.9800
 Site-cartoon                       | Val  Loss: 0.1472 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.1540 | Val  Acc: 0.9567
 Site-sketch                        | Val  Loss: 0.5192 | Val  Acc: 0.7600
 Site-sketch                        | Val  Loss: 0.5272 | Val  Acc: 0.8033
Average Valid Accuracy: 0.9250
============ Train epoch 38 ============
 Site-photo                         | Train Loss: 0.0206 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2404 | Train Acc: 0.9267
 Site-art_painting                  | Train Loss: 0.1113 | Train Acc: 0.9733
 Site-cartoon                       | Train Loss: 0.3006 | Train Acc: 0.9267
 Site-cartoon                       | Train Loss: 0.1238 | Train Acc: 0.9622
 Site-sketch                        | Train Loss: 0.6167 | Train Acc: 0.7933
 Site-sketch                        | Train Loss: 0.5309 | Train Acc: 0.7956
Average Train Accuracy: 0.9206
 Site-photo                         | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0931 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.0803 | Val  Acc: 0.9800
 Site-cartoon                       | Val  Loss: 0.1854 | Val  Acc: 0.9500
 Site-cartoon                       | Val  Loss: 0.1716 | Val  Acc: 0.9467
 Site-sketch                        | Val  Loss: 0.5136 | Val  Acc: 0.7300
 Site-sketch                        | Val  Loss: 0.5310 | Val  Acc: 0.8167
Average Valid Accuracy: 0.9254
============ Train epoch 39 ============
 Site-photo                         | Train Loss: 0.0135 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2376 | Train Acc: 0.9067
 Site-art_painting                  | Train Loss: 0.0681 | Train Acc: 0.9844
 Site-cartoon                       | Train Loss: 0.3951 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.1571 | Train Acc: 0.9400
 Site-sketch                        | Train Loss: 0.5698 | Train Acc: 0.8267
 Site-sketch                        | Train Loss: 0.4911 | Train Acc: 0.7956
Average Train Accuracy: 0.9158
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0746 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.0911 | Val  Acc: 0.9733
 Site-cartoon                       | Val  Loss: 0.1283 | Val  Acc: 0.9800
 Site-cartoon                       | Val  Loss: 0.1352 | Val  Acc: 0.9600
 Site-sketch                        | Val  Loss: 0.4397 | Val  Acc: 0.8200
 Site-sketch                        | Val  Loss: 0.5050 | Val  Acc: 0.8167
Average Valid Accuracy: 0.9425
 Best site-photo                     | Epoch:39 | Val Acc: 1.0000
 Best site-photo                     | Epoch:39 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:39 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:39 | Val Acc: 0.9733
 Best site-cartoon                   | Epoch:39 | Val Acc: 0.9800
 Best site-cartoon                   | Epoch:39 | Val Acc: 0.9600
 Best site-sketch                    | Epoch:39 | Val Acc: 0.8200
 Best site-sketch                    | Epoch:39 | Val Acc: 0.8167
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 40 ============
 Site-photo                         | Train Loss: 0.0222 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2781 | Train Acc: 0.9067
 Site-art_painting                  | Train Loss: 0.0768 | Train Acc: 0.9733
 Site-cartoon                       | Train Loss: 0.2844 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.2511 | Train Acc: 0.9667
 Site-sketch                        | Train Loss: 0.5913 | Train Acc: 0.8467
 Site-sketch                        | Train Loss: 0.4427 | Train Acc: 0.8089
Average Train Accuracy: 0.9211
 Site-photo                         | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0965 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.0792 | Val  Acc: 0.9867
 Site-cartoon                       | Val  Loss: 0.1573 | Val  Acc: 0.9400
 Site-cartoon                       | Val  Loss: 0.1772 | Val  Acc: 0.9433
 Site-sketch                        | Val  Loss: 0.4356 | Val  Acc: 0.8300
 Site-sketch                        | Val  Loss: 0.5107 | Val  Acc: 0.7967
Average Valid Accuracy: 0.9346
============ Train epoch 41 ============
 Site-photo                         | Train Loss: 0.0266 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.1724 | Train Acc: 0.9400
 Site-art_painting                  | Train Loss: 0.0710 | Train Acc: 0.9867
 Site-cartoon                       | Train Loss: 0.2928 | Train Acc: 0.9067
 Site-cartoon                       | Train Loss: 0.1313 | Train Acc: 0.9578
 Site-sketch                        | Train Loss: 0.5004 | Train Acc: 0.7933
 Site-sketch                        | Train Loss: 0.4494 | Train Acc: 0.8067
Average Train Accuracy: 0.9222
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0077 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.0819 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.0501 | Val  Acc: 0.9867
 Site-cartoon                       | Val  Loss: 0.1343 | Val  Acc: 0.9800
 Site-cartoon                       | Val  Loss: 0.1263 | Val  Acc: 0.9667
 Site-sketch                        | Val  Loss: 0.4393 | Val  Acc: 0.8400
 Site-sketch                        | Val  Loss: 0.4616 | Val  Acc: 0.8300
Average Valid Accuracy: 0.9463
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-photo                     | Epoch:41 | Val Acc: 0.9967
 Best site-art_painting              | Epoch:41 | Val Acc: 0.9700
 Best site-art_painting              | Epoch:41 | Val Acc: 0.9867
 Best site-cartoon                   | Epoch:41 | Val Acc: 0.9800
 Best site-cartoon                   | Epoch:41 | Val Acc: 0.9667
 Best site-sketch                    | Epoch:41 | Val Acc: 0.8400
 Best site-sketch                    | Epoch:41 | Val Acc: 0.8300
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 42 ============
 Site-photo                         | Train Loss: 0.0330 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3211 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.0825 | Train Acc: 0.9711
 Site-cartoon                       | Train Loss: 0.2878 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.1323 | Train Acc: 0.9689
 Site-sketch                        | Train Loss: 0.6072 | Train Acc: 0.7933
 Site-sketch                        | Train Loss: 0.5669 | Train Acc: 0.8089
Average Train Accuracy: 0.9128
 Site-photo                         | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0699 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.0857 | Val  Acc: 0.9800
 Site-cartoon                       | Val  Loss: 0.1237 | Val  Acc: 0.9900
 Site-cartoon                       | Val  Loss: 0.1500 | Val  Acc: 0.9700
 Site-sketch                        | Val  Loss: 0.4338 | Val  Acc: 0.8400
 Site-sketch                        | Val  Loss: 0.5176 | Val  Acc: 0.8233
Average Valid Accuracy: 0.9479
 Best site-photo                     | Epoch:42 | Val Acc: 1.0000
 Best site-photo                     | Epoch:42 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:42 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:42 | Val Acc: 0.9800
 Best site-cartoon                   | Epoch:42 | Val Acc: 0.9900
 Best site-cartoon                   | Epoch:42 | Val Acc: 0.9700
 Best site-sketch                    | Epoch:42 | Val Acc: 0.8400
 Best site-sketch                    | Epoch:42 | Val Acc: 0.8233
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedsam...
============ Train epoch 43 ============
 Site-photo                         | Train Loss: 0.0070 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2384 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.0954 | Train Acc: 0.9711
 Site-cartoon                       | Train Loss: 0.3804 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.1458 | Train Acc: 0.9600
 Site-sketch                        | Train Loss: 0.5064 | Train Acc: 0.7867
 Site-sketch                        | Train Loss: 0.4422 | Train Acc: 0.8156
Average Train Accuracy: 0.9100
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0961 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.0857 | Val  Acc: 0.9833
 Site-cartoon                       | Val  Loss: 0.1521 | Val  Acc: 0.9400
 Site-cartoon                       | Val  Loss: 0.1526 | Val  Acc: 0.9500
 Site-sketch                        | Val  Loss: 0.4436 | Val  Acc: 0.7900
 Site-sketch                        | Val  Loss: 0.4856 | Val  Acc: 0.8300
Average Valid Accuracy: 0.9329
============ Train epoch 44 ============
 Site-photo                         | Train Loss: 0.0232 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0072 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3176 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.0777 | Train Acc: 0.9756
 Site-cartoon                       | Train Loss: 0.3300 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.1625 | Train Acc: 0.9444
 Site-sketch                        | Train Loss: 0.6331 | Train Acc: 0.8000
 Site-sketch                        | Train Loss: 0.4676 | Train Acc: 0.8067
Average Train Accuracy: 0.9097
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0734 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.0686 | Val  Acc: 0.9800
 Site-cartoon                       | Val  Loss: 0.1477 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.1551 | Val  Acc: 0.9567
 Site-sketch                        | Val  Loss: 0.4690 | Val  Acc: 0.8300
 Site-sketch                        | Val  Loss: 0.5230 | Val  Acc: 0.8233
Average Valid Accuracy: 0.9363
============ Train epoch 45 ============
 Site-photo                         | Train Loss: 0.0713 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2066 | Train Acc: 0.9267
 Site-art_painting                  | Train Loss: 0.0773 | Train Acc: 0.9889
 Site-cartoon                       | Train Loss: 0.2892 | Train Acc: 0.9067
 Site-cartoon                       | Train Loss: 0.1372 | Train Acc: 0.9556
 Site-sketch                        | Train Loss: 0.6418 | Train Acc: 0.7867
 Site-sketch                        | Train Loss: 0.4636 | Train Acc: 0.8178
Average Train Accuracy: 0.9211
 Site-photo                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0824 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.0685 | Val  Acc: 0.9900
 Site-cartoon                       | Val  Loss: 0.1392 | Val  Acc: 0.9600
 Site-cartoon                       | Val  Loss: 0.1697 | Val  Acc: 0.9433
 Site-sketch                        | Val  Loss: 0.3942 | Val  Acc: 0.8500
 Site-sketch                        | Val  Loss: 0.5029 | Val  Acc: 0.8167
Average Valid Accuracy: 0.9425
============ Train epoch 46 ============
 Site-photo                         | Train Loss: 0.0085 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3379 | Train Acc: 0.9067
 Site-art_painting                  | Train Loss: 0.0696 | Train Acc: 0.9844
 Site-cartoon                       | Train Loss: 0.3365 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.1419 | Train Acc: 0.9400
 Site-sketch                        | Train Loss: 0.5031 | Train Acc: 0.8067
 Site-sketch                        | Train Loss: 0.5288 | Train Acc: 0.8200
Average Train Accuracy: 0.9156
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0134 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.0413 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.0828 | Val  Acc: 0.9800
 Site-cartoon                       | Val  Loss: 0.1091 | Val  Acc: 0.9800
 Site-cartoon                       | Val  Loss: 0.1687 | Val  Acc: 0.9400
 Site-sketch                        | Val  Loss: 0.4423 | Val  Acc: 0.8100
 Site-sketch                        | Val  Loss: 0.5093 | Val  Acc: 0.8267
Average Valid Accuracy: 0.9400
============ Train epoch 47 ============
 Site-photo                         | Train Loss: 0.0345 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.1951 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.0696 | Train Acc: 0.9800
 Site-cartoon                       | Train Loss: 0.3292 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.1475 | Train Acc: 0.9578
 Site-sketch                        | Train Loss: 0.5984 | Train Acc: 0.7933
 Site-sketch                        | Train Loss: 0.4552 | Train Acc: 0.8244
Average Train Accuracy: 0.9136
 Site-photo                         | Val  Loss: 0.0001 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0775 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.0626 | Val  Acc: 0.9933
 Site-cartoon                       | Val  Loss: 0.1417 | Val  Acc: 0.9800
 Site-cartoon                       | Val  Loss: 0.1285 | Val  Acc: 0.9600
 Site-sketch                        | Val  Loss: 0.3400 | Val  Acc: 0.8500
 Site-sketch                        | Val  Loss: 0.4965 | Val  Acc: 0.7967
Average Valid Accuracy: 0.9450
============ Train epoch 48 ============
 Site-photo                         | Train Loss: 0.0661 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0038 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2522 | Train Acc: 0.9267
 Site-art_painting                  | Train Loss: 0.0712 | Train Acc: 0.9800
 Site-cartoon                       | Train Loss: 0.2999 | Train Acc: 0.8867
 Site-cartoon                       | Train Loss: 0.1280 | Train Acc: 0.9556
 Site-sketch                        | Train Loss: 0.4759 | Train Acc: 0.8133
 Site-sketch                        | Train Loss: 0.4512 | Train Acc: 0.8311
Average Train Accuracy: 0.9222
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0932 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.0692 | Val  Acc: 0.9867
 Site-cartoon                       | Val  Loss: 0.1598 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.1342 | Val  Acc: 0.9733
 Site-sketch                        | Val  Loss: 0.4216 | Val  Acc: 0.8000
 Site-sketch                        | Val  Loss: 0.4738 | Val  Acc: 0.8100
Average Valid Accuracy: 0.9338
============ Train epoch 49 ============
 Site-photo                         | Train Loss: 0.0195 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0054 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3663 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.0752 | Train Acc: 0.9800
 Site-cartoon                       | Train Loss: 0.3174 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.1152 | Train Acc: 0.9644
 Site-sketch                        | Train Loss: 0.5402 | Train Acc: 0.7467
 Site-sketch                        | Train Loss: 0.4790 | Train Acc: 0.8311
Average Train Accuracy: 0.9114
 Site-photo                         | Val  Loss: 0.0002 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0946 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.0756 | Val  Acc: 0.9900
 Site-cartoon                       | Val  Loss: 0.1625 | Val  Acc: 0.9600
 Site-cartoon                       | Val  Loss: 0.1291 | Val  Acc: 0.9667
 Site-sketch                        | Val  Loss: 0.3967 | Val  Acc: 0.8500
 Site-sketch                        | Val  Loss: 0.4822 | Val  Acc: 0.8233
Average Valid Accuracy: 0.9463
===2023-08-08 03:20:00===
===2023-08-08 03:20:16===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
Loading snapshots...
 Test site-photo                     (1)| Epoch:42 | Test Acc: 0.9985
 Test site-art_painting              (3)| Epoch:42 | Test Acc: 0.9342
 Test site-cartoon                   (2)| Epoch:42 | Test Acc: 0.8936
 Test site-sketch                    (0)| Epoch:42 | Test Acc: 0.7738
photo: 0.9985, art_painting: 0.9342, cartoon: 0.8936, sketch: 0.7738, 
Average Test Accuracy(group): 0.9000, Average Test Accuracy(individual): 0.9000,
domain std=0.0819, cluster std=0.0819, individual std=0.0819, 
