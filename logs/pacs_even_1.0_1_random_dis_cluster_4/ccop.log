===2023-08-07 22:15:41===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (3) | Train Loss: 1.6158 | Train Acc: 0.5733
 Site-photo                     (3) | Train Loss: 1.4886 | Train Acc: 0.6311
 Site-art_painting              (1) | Train Loss: 1.7779 | Train Acc: 0.2933
 Site-art_painting              (1) | Train Loss: 1.6805 | Train Acc: 0.4022
 Site-cartoon                   (2) | Train Loss: 1.7684 | Train Acc: 0.3333
 Site-cartoon                   (2) | Train Loss: 1.7106 | Train Acc: 0.3156
 Site-sketch                    (0) | Train Loss: 1.7783 | Train Acc: 0.2267
 Site-sketch                    (0) | Train Loss: 1.7646 | Train Acc: 0.2467
Average Train Accuracy: 0.3778
 Site-photo                     (3) | Val  Loss: 1.5287 | Val  Acc: 0.6600
 Site-photo                     (3) | Val  Loss: 1.5713 | Val  Acc: 0.6200
 Site-art_painting              (1) | Val  Loss: 1.6422 | Val  Acc: 0.4500
 Site-art_painting              (1) | Val  Loss: 1.6794 | Val  Acc: 0.4267
 Site-cartoon                   (2) | Val  Loss: 1.7516 | Val  Acc: 0.2700
 Site-cartoon                   (2) | Val  Loss: 1.7579 | Val  Acc: 0.3333
 Site-sketch                    (0) | Val  Loss: 1.7498 | Val  Acc: 0.3100
 Site-sketch                    (0) | Val  Loss: 1.7667 | Val  Acc: 0.2500
Average Valid Accuracy: 0.4150
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.6600
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.6200
 Best site-art_painting             (1)  | Epoch:0 | Val Acc: 0.4500
 Best site-art_painting             (1)  | Epoch:0 | Val Acc: 0.4267
 Best site-cartoon                  (2)  | Epoch:0 | Val Acc: 0.2700
 Best site-cartoon                  (2)  | Epoch:0 | Val Acc: 0.3333
 Best site-sketch                   (0)  | Epoch:0 | Val Acc: 0.3100
 Best site-sketch                   (0)  | Epoch:0 | Val Acc: 0.2500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (2) | Train Loss: 1.2733 | Train Acc: 0.7667
 Site-photo                     (2) | Train Loss: 1.2222 | Train Acc: 0.8133
 Site-art_painting              (3) | Train Loss: 1.5654 | Train Acc: 0.5267
 Site-art_painting              (3) | Train Loss: 1.4965 | Train Acc: 0.5489
 Site-cartoon                   (0) | Train Loss: 1.5769 | Train Acc: 0.4400
 Site-cartoon                   (0) | Train Loss: 1.5657 | Train Acc: 0.5133
 Site-sketch                    (1) | Train Loss: 1.6709 | Train Acc: 0.3800
 Site-sketch                    (1) | Train Loss: 1.6098 | Train Acc: 0.3778
Average Train Accuracy: 0.5458
 Site-photo                     (2) | Val  Loss: 1.2049 | Val  Acc: 0.8600
 Site-photo                     (2) | Val  Loss: 1.2516 | Val  Acc: 0.8033
 Site-art_painting              (3) | Val  Loss: 1.4526 | Val  Acc: 0.5600
 Site-art_painting              (3) | Val  Loss: 1.4675 | Val  Acc: 0.5633
 Site-cartoon                   (0) | Val  Loss: 1.5349 | Val  Acc: 0.5400
 Site-cartoon                   (0) | Val  Loss: 1.5314 | Val  Acc: 0.5000
 Site-sketch                    (1) | Val  Loss: 1.5862 | Val  Acc: 0.3800
 Site-sketch                    (1) | Val  Loss: 1.5746 | Val  Acc: 0.4000
Average Valid Accuracy: 0.5758
 Best site-photo                    (2)  | Epoch:1 | Val Acc: 0.8600
 Best site-photo                    (2)  | Epoch:1 | Val Acc: 0.8033
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.5600
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.5633
 Best site-cartoon                  (0)  | Epoch:1 | Val Acc: 0.5400
 Best site-cartoon                  (0)  | Epoch:1 | Val Acc: 0.5000
 Best site-sketch                   (1)  | Epoch:1 | Val Acc: 0.3800
 Best site-sketch                   (1)  | Epoch:1 | Val Acc: 0.4000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (3) | Train Loss: 1.0314 | Train Acc: 0.9133
 Site-photo                     (3) | Train Loss: 1.0202 | Train Acc: 0.9067
 Site-art_painting              (1) | Train Loss: 1.3382 | Train Acc: 0.5933
 Site-art_painting              (1) | Train Loss: 1.2254 | Train Acc: 0.7067
 Site-cartoon                   (2) | Train Loss: 1.4368 | Train Acc: 0.5467
 Site-cartoon                   (2) | Train Loss: 1.3410 | Train Acc: 0.6089
 Site-sketch                    (0) | Train Loss: 1.4796 | Train Acc: 0.4467
 Site-sketch                    (0) | Train Loss: 1.4390 | Train Acc: 0.4533
Average Train Accuracy: 0.6469
 Site-photo                     (3) | Val  Loss: 0.9694 | Val  Acc: 0.9000
 Site-photo                     (3) | Val  Loss: 0.9835 | Val  Acc: 0.8933
 Site-art_painting              (1) | Val  Loss: 1.1976 | Val  Acc: 0.7700
 Site-art_painting              (1) | Val  Loss: 1.2392 | Val  Acc: 0.7100
 Site-cartoon                   (2) | Val  Loss: 1.4104 | Val  Acc: 0.6000
 Site-cartoon                   (2) | Val  Loss: 1.3535 | Val  Acc: 0.6433
 Site-sketch                    (0) | Val  Loss: 1.4276 | Val  Acc: 0.5200
 Site-sketch                    (0) | Val  Loss: 1.4670 | Val  Acc: 0.4733
Average Valid Accuracy: 0.6887
 Best site-photo                    (3)  | Epoch:2 | Val Acc: 0.9000
 Best site-photo                    (3)  | Epoch:2 | Val Acc: 0.8933
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.7700
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.7100
 Best site-cartoon                  (2)  | Epoch:2 | Val Acc: 0.6000
 Best site-cartoon                  (2)  | Epoch:2 | Val Acc: 0.6433
 Best site-sketch                   (0)  | Epoch:2 | Val Acc: 0.5200
 Best site-sketch                   (0)  | Epoch:2 | Val Acc: 0.4733
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (3) | Train Loss: 0.8357 | Train Acc: 0.9333
 Site-photo                     (3) | Train Loss: 0.7682 | Train Acc: 0.9444
 Site-art_painting              (2) | Train Loss: 1.1414 | Train Acc: 0.6933
 Site-art_painting              (2) | Train Loss: 1.1856 | Train Acc: 0.7778
 Site-cartoon                   (0) | Train Loss: 1.2650 | Train Acc: 0.6333
 Site-cartoon                   (0) | Train Loss: 1.1378 | Train Acc: 0.6933
 Site-sketch                    (1) | Train Loss: 1.4269 | Train Acc: 0.4600
 Site-sketch                    (1) | Train Loss: 1.3148 | Train Acc: 0.5378
Average Train Accuracy: 0.7092
 Site-photo                     (3) | Val  Loss: 0.7593 | Val  Acc: 0.9400
 Site-photo                     (3) | Val  Loss: 0.7744 | Val  Acc: 0.9533
 Site-art_painting              (2) | Val  Loss: 1.0199 | Val  Acc: 0.8600
 Site-art_painting              (2) | Val  Loss: 1.0868 | Val  Acc: 0.7733
 Site-cartoon                   (0) | Val  Loss: 1.2086 | Val  Acc: 0.7100
 Site-cartoon                   (0) | Val  Loss: 1.1895 | Val  Acc: 0.6767
 Site-sketch                    (1) | Val  Loss: 1.3298 | Val  Acc: 0.4500
 Site-sketch                    (1) | Val  Loss: 1.3281 | Val  Acc: 0.5133
Average Valid Accuracy: 0.7346
 Best site-photo                    (3)  | Epoch:3 | Val Acc: 0.9400
 Best site-photo                    (3)  | Epoch:3 | Val Acc: 0.9533
 Best site-art_painting             (2)  | Epoch:3 | Val Acc: 0.8600
 Best site-art_painting             (2)  | Epoch:3 | Val Acc: 0.7733
 Best site-cartoon                  (0)  | Epoch:3 | Val Acc: 0.7100
 Best site-cartoon                  (0)  | Epoch:3 | Val Acc: 0.6767
 Best site-sketch                   (1)  | Epoch:3 | Val Acc: 0.4500
 Best site-sketch                   (1)  | Epoch:3 | Val Acc: 0.5133
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (3) | Train Loss: 0.6996 | Train Acc: 0.9333
 Site-photo                     (3) | Train Loss: 0.6476 | Train Acc: 0.9689
 Site-art_painting              (1) | Train Loss: 1.0009 | Train Acc: 0.7733
 Site-art_painting              (1) | Train Loss: 0.9697 | Train Acc: 0.8200
 Site-cartoon                   (2) | Train Loss: 1.0907 | Train Acc: 0.6933
 Site-cartoon                   (2) | Train Loss: 0.9855 | Train Acc: 0.6911
 Site-sketch                    (0) | Train Loss: 1.2180 | Train Acc: 0.5867
 Site-sketch                    (0) | Train Loss: 1.1395 | Train Acc: 0.5889
Average Train Accuracy: 0.7569
 Site-photo                     (3) | Val  Loss: 0.6181 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.6600 | Val  Acc: 0.9467
 Site-art_painting              (1) | Val  Loss: 0.9282 | Val  Acc: 0.8400
 Site-art_painting              (1) | Val  Loss: 0.8900 | Val  Acc: 0.8233
 Site-cartoon                   (2) | Val  Loss: 1.0489 | Val  Acc: 0.6700
 Site-cartoon                   (2) | Val  Loss: 1.0298 | Val  Acc: 0.7167
 Site-sketch                    (0) | Val  Loss: 1.1393 | Val  Acc: 0.6500
 Site-sketch                    (0) | Val  Loss: 1.1817 | Val  Acc: 0.6000
Average Valid Accuracy: 0.7746
 Best site-photo                    (3)  | Epoch:4 | Val Acc: 0.9500
 Best site-photo                    (3)  | Epoch:4 | Val Acc: 0.9467
 Best site-art_painting             (1)  | Epoch:4 | Val Acc: 0.8400
 Best site-art_painting             (1)  | Epoch:4 | Val Acc: 0.8233
 Best site-cartoon                  (2)  | Epoch:4 | Val Acc: 0.6700
 Best site-cartoon                  (2)  | Epoch:4 | Val Acc: 0.7167
 Best site-sketch                   (0)  | Epoch:4 | Val Acc: 0.6500
 Best site-sketch                   (0)  | Epoch:4 | Val Acc: 0.6000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (3) | Train Loss: 0.6028 | Train Acc: 0.9600
 Site-photo                     (3) | Train Loss: 0.5297 | Train Acc: 0.9578
 Site-art_painting              (1) | Train Loss: 0.8426 | Train Acc: 0.8200
 Site-art_painting              (1) | Train Loss: 0.8084 | Train Acc: 0.8467
 Site-cartoon                   (2) | Train Loss: 0.9821 | Train Acc: 0.7267
 Site-cartoon                   (2) | Train Loss: 0.9259 | Train Acc: 0.7400
 Site-sketch                    (0) | Train Loss: 1.1092 | Train Acc: 0.6200
 Site-sketch                    (0) | Train Loss: 1.1027 | Train Acc: 0.6511
Average Train Accuracy: 0.7903
 Site-photo                     (3) | Val  Loss: 0.4957 | Val  Acc: 0.9300
 Site-photo                     (3) | Val  Loss: 0.5498 | Val  Acc: 0.9500
 Site-art_painting              (1) | Val  Loss: 0.7986 | Val  Acc: 0.8700
 Site-art_painting              (1) | Val  Loss: 0.8081 | Val  Acc: 0.8233
 Site-cartoon                   (2) | Val  Loss: 0.9297 | Val  Acc: 0.7100
 Site-cartoon                   (2) | Val  Loss: 0.9357 | Val  Acc: 0.7300
 Site-sketch                    (0) | Val  Loss: 1.0933 | Val  Acc: 0.6100
 Site-sketch                    (0) | Val  Loss: 1.0456 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7863
 Best site-photo                    (3)  | Epoch:5 | Val Acc: 0.9300
 Best site-photo                    (3)  | Epoch:5 | Val Acc: 0.9500
 Best site-art_painting             (1)  | Epoch:5 | Val Acc: 0.8700
 Best site-art_painting             (1)  | Epoch:5 | Val Acc: 0.8233
 Best site-cartoon                  (2)  | Epoch:5 | Val Acc: 0.7100
 Best site-cartoon                  (2)  | Epoch:5 | Val Acc: 0.7300
 Best site-sketch                   (0)  | Epoch:5 | Val Acc: 0.6100
 Best site-sketch                   (0)  | Epoch:5 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 2, 2, 3, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (3) | Train Loss: 0.4883 | Train Acc: 0.9600
 Site-photo                     (3) | Train Loss: 0.4343 | Train Acc: 0.9667
 Site-art_painting              (0) | Train Loss: 0.8102 | Train Acc: 0.8400
 Site-art_painting              (3) | Train Loss: 0.6769 | Train Acc: 0.8667
 Site-cartoon                   (2) | Train Loss: 0.8064 | Train Acc: 0.7533
 Site-cartoon                   (2) | Train Loss: 0.7696 | Train Acc: 0.7689
 Site-sketch                    (1) | Train Loss: 0.9913 | Train Acc: 0.7067
 Site-sketch                    (1) | Train Loss: 1.0447 | Train Acc: 0.6867
Average Train Accuracy: 0.8186
 Site-photo                     (3) | Val  Loss: 0.4357 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.4578 | Val  Acc: 0.9667
 Site-art_painting              (0) | Val  Loss: 0.7453 | Val  Acc: 0.8600
 Site-art_painting              (3) | Val  Loss: 0.7206 | Val  Acc: 0.8567
 Site-cartoon                   (2) | Val  Loss: 0.8052 | Val  Acc: 0.8100
 Site-cartoon                   (2) | Val  Loss: 0.8435 | Val  Acc: 0.7700
 Site-sketch                    (1) | Val  Loss: 0.9969 | Val  Acc: 0.6300
 Site-sketch                    (1) | Val  Loss: 0.9669 | Val  Acc: 0.6967
Average Valid Accuracy: 0.8200
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.9700
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.9667
 Best site-art_painting             (0)  | Epoch:6 | Val Acc: 0.8600
 Best site-art_painting             (3)  | Epoch:6 | Val Acc: 0.8567
 Best site-cartoon                  (2)  | Epoch:6 | Val Acc: 0.8100
 Best site-cartoon                  (2)  | Epoch:6 | Val Acc: 0.7700
 Best site-sketch                   (1)  | Epoch:6 | Val Acc: 0.6300
 Best site-sketch                   (1)  | Epoch:6 | Val Acc: 0.6967
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (2) | Train Loss: 0.4495 | Train Acc: 0.9600
 Site-photo                     (2) | Train Loss: 0.4126 | Train Acc: 0.9644
 Site-art_painting              (3) | Train Loss: 0.7051 | Train Acc: 0.8600
 Site-art_painting              (3) | Train Loss: 0.6355 | Train Acc: 0.8578
 Site-cartoon                   (0) | Train Loss: 0.8485 | Train Acc: 0.7867
 Site-cartoon                   (0) | Train Loss: 0.7674 | Train Acc: 0.7956
 Site-sketch                    (1) | Train Loss: 0.8558 | Train Acc: 0.7733
 Site-sketch                    (1) | Train Loss: 0.9220 | Train Acc: 0.7200
Average Train Accuracy: 0.8397
 Site-photo                     (2) | Val  Loss: 0.3872 | Val  Acc: 0.9600
 Site-photo                     (2) | Val  Loss: 0.3901 | Val  Acc: 0.9633
 Site-art_painting              (3) | Val  Loss: 0.6514 | Val  Acc: 0.9000
 Site-art_painting              (3) | Val  Loss: 0.6356 | Val  Acc: 0.8600
 Site-cartoon                   (0) | Val  Loss: 0.8229 | Val  Acc: 0.7000
 Site-cartoon                   (0) | Val  Loss: 0.7567 | Val  Acc: 0.7933
 Site-sketch                    (1) | Val  Loss: 0.8640 | Val  Acc: 0.7100
 Site-sketch                    (1) | Val  Loss: 0.8816 | Val  Acc: 0.7267
Average Valid Accuracy: 0.8267
 Best site-photo                    (2)  | Epoch:7 | Val Acc: 0.9600
 Best site-photo                    (2)  | Epoch:7 | Val Acc: 0.9633
 Best site-art_painting             (3)  | Epoch:7 | Val Acc: 0.9000
 Best site-art_painting             (3)  | Epoch:7 | Val Acc: 0.8600
 Best site-cartoon                  (0)  | Epoch:7 | Val Acc: 0.7000
 Best site-cartoon                  (0)  | Epoch:7 | Val Acc: 0.7933
 Best site-sketch                   (1)  | Epoch:7 | Val Acc: 0.7100
 Best site-sketch                   (1)  | Epoch:7 | Val Acc: 0.7267
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (0) | Train Loss: 0.4154 | Train Acc: 0.9533
 Site-photo                     (0) | Train Loss: 0.3300 | Train Acc: 0.9711
 Site-art_painting              (3) | Train Loss: 0.6910 | Train Acc: 0.8267
 Site-art_painting              (3) | Train Loss: 0.6711 | Train Acc: 0.8800
 Site-cartoon                   (2) | Train Loss: 0.7396 | Train Acc: 0.7800
 Site-cartoon                   (2) | Train Loss: 0.5982 | Train Acc: 0.8244
 Site-sketch                    (1) | Train Loss: 0.8822 | Train Acc: 0.7200
 Site-sketch                    (1) | Train Loss: 0.8111 | Train Acc: 0.7622
Average Train Accuracy: 0.8397
 Site-photo                     (0) | Val  Loss: 0.3742 | Val  Acc: 0.9500
 Site-photo                     (0) | Val  Loss: 0.3736 | Val  Acc: 0.9667
 Site-art_painting              (3) | Val  Loss: 0.6242 | Val  Acc: 0.8800
 Site-art_painting              (3) | Val  Loss: 0.6354 | Val  Acc: 0.8767
 Site-cartoon                   (2) | Val  Loss: 0.7216 | Val  Acc: 0.7900
 Site-cartoon                   (2) | Val  Loss: 0.6955 | Val  Acc: 0.8133
 Site-sketch                    (1) | Val  Loss: 0.8476 | Val  Acc: 0.6400
 Site-sketch                    (1) | Val  Loss: 0.8473 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8271
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9500
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9667
 Best site-art_painting             (3)  | Epoch:8 | Val Acc: 0.8800
 Best site-art_painting             (3)  | Epoch:8 | Val Acc: 0.8767
 Best site-cartoon                  (2)  | Epoch:8 | Val Acc: 0.7900
 Best site-cartoon                  (2)  | Epoch:8 | Val Acc: 0.8133
 Best site-sketch                   (1)  | Epoch:8 | Val Acc: 0.6400
 Best site-sketch                   (1)  | Epoch:8 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (3) | Train Loss: 0.3281 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.3419 | Train Acc: 0.9689
 Site-art_painting              (3) | Train Loss: 0.6633 | Train Acc: 0.8400
 Site-art_painting              (1) | Train Loss: 0.6343 | Train Acc: 0.8889
 Site-cartoon                   (2) | Train Loss: 0.6557 | Train Acc: 0.8200
 Site-cartoon                   (2) | Train Loss: 0.6119 | Train Acc: 0.8222
 Site-sketch                    (0) | Train Loss: 0.8081 | Train Acc: 0.7467
 Site-sketch                    (0) | Train Loss: 0.7207 | Train Acc: 0.7511
Average Train Accuracy: 0.8514
 Site-photo                     (3) | Val  Loss: 0.3342 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.3367 | Val  Acc: 0.9667
 Site-art_painting              (3) | Val  Loss: 0.5959 | Val  Acc: 0.8800
 Site-art_painting              (1) | Val  Loss: 0.5718 | Val  Acc: 0.8667
 Site-cartoon                   (2) | Val  Loss: 0.6558 | Val  Acc: 0.8300
 Site-cartoon                   (2) | Val  Loss: 0.6332 | Val  Acc: 0.8333
 Site-sketch                    (0) | Val  Loss: 0.7662 | Val  Acc: 0.7300
 Site-sketch                    (0) | Val  Loss: 0.7917 | Val  Acc: 0.7633
Average Valid Accuracy: 0.8538
 Best site-photo                    (3)  | Epoch:9 | Val Acc: 0.9600
 Best site-photo                    (3)  | Epoch:9 | Val Acc: 0.9667
 Best site-art_painting             (3)  | Epoch:9 | Val Acc: 0.8800
 Best site-art_painting             (1)  | Epoch:9 | Val Acc: 0.8667
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.8300
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.8333
 Best site-sketch                   (0)  | Epoch:9 | Val Acc: 0.7300
 Best site-sketch                   (0)  | Epoch:9 | Val Acc: 0.7633
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 10 ============
cnt=[1, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (1) | Train Loss: 0.3310 | Train Acc: 0.9667
 Site-photo                     (1) | Train Loss: 0.3374 | Train Acc: 0.9733
 Site-art_painting              (1) | Train Loss: 0.5603 | Train Acc: 0.8467
 Site-art_painting              (1) | Train Loss: 0.4812 | Train Acc: 0.8844
 Site-cartoon                   (0) | Train Loss: 0.6353 | Train Acc: 0.7867
 Site-cartoon                   (3) | Train Loss: 0.6943 | Train Acc: 0.8222
 Site-sketch                    (2) | Train Loss: 0.7282 | Train Acc: 0.7600
 Site-sketch                    (2) | Train Loss: 0.6936 | Train Acc: 0.7689
Average Train Accuracy: 0.8511
 Site-photo                     (1) | Val  Loss: 0.2806 | Val  Acc: 0.9500
 Site-photo                     (1) | Val  Loss: 0.2944 | Val  Acc: 0.9733
 Site-art_painting              (1) | Val  Loss: 0.5275 | Val  Acc: 0.9000
 Site-art_painting              (1) | Val  Loss: 0.5173 | Val  Acc: 0.8933
 Site-cartoon                   (0) | Val  Loss: 0.6743 | Val  Acc: 0.7700
 Site-cartoon                   (3) | Val  Loss: 0.6524 | Val  Acc: 0.7933
 Site-sketch                    (2) | Val  Loss: 0.7123 | Val  Acc: 0.7600
 Site-sketch                    (2) | Val  Loss: 0.7614 | Val  Acc: 0.7400
Average Valid Accuracy: 0.8475
============ Train epoch 11 ============
cnt=[2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (2) | Train Loss: 0.2734 | Train Acc: 0.9533
 Site-photo                     (2) | Train Loss: 0.2722 | Train Acc: 0.9667
 Site-art_painting              (2) | Train Loss: 0.5932 | Train Acc: 0.8800
 Site-art_painting              (3) | Train Loss: 0.4925 | Train Acc: 0.8844
 Site-cartoon                   (0) | Train Loss: 0.5579 | Train Acc: 0.8400
 Site-cartoon                   (0) | Train Loss: 0.5014 | Train Acc: 0.8378
 Site-sketch                    (1) | Train Loss: 0.7663 | Train Acc: 0.7733
 Site-sketch                    (1) | Train Loss: 0.6698 | Train Acc: 0.7756
Average Train Accuracy: 0.8639
 Site-photo                     (2) | Val  Loss: 0.3045 | Val  Acc: 0.9500
 Site-photo                     (2) | Val  Loss: 0.2877 | Val  Acc: 0.9633
 Site-art_painting              (2) | Val  Loss: 0.5185 | Val  Acc: 0.9000
 Site-art_painting              (3) | Val  Loss: 0.5255 | Val  Acc: 0.8867
 Site-cartoon                   (0) | Val  Loss: 0.6227 | Val  Acc: 0.7900
 Site-cartoon                   (0) | Val  Loss: 0.5755 | Val  Acc: 0.8267
 Site-sketch                    (1) | Val  Loss: 0.7090 | Val  Acc: 0.7700
 Site-sketch                    (1) | Val  Loss: 0.6998 | Val  Acc: 0.8033
Average Valid Accuracy: 0.8613
 Best site-photo                    (2)  | Epoch:11 | Val Acc: 0.9500
 Best site-photo                    (2)  | Epoch:11 | Val Acc: 0.9633
 Best site-art_painting             (2)  | Epoch:11 | Val Acc: 0.9000
 Best site-art_painting             (3)  | Epoch:11 | Val Acc: 0.8867
 Best site-cartoon                  (0)  | Epoch:11 | Val Acc: 0.7900
 Best site-cartoon                  (0)  | Epoch:11 | Val Acc: 0.8267
 Best site-sketch                   (1)  | Epoch:11 | Val Acc: 0.7700
 Best site-sketch                   (1)  | Epoch:11 | Val Acc: 0.8033
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (3) | Train Loss: 0.2395 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.2545 | Train Acc: 0.9733
 Site-art_painting              (2) | Train Loss: 0.5553 | Train Acc: 0.8733
 Site-art_painting              (2) | Train Loss: 0.5903 | Train Acc: 0.8911
 Site-cartoon                   (0) | Train Loss: 0.6627 | Train Acc: 0.8067
 Site-cartoon                   (0) | Train Loss: 0.5625 | Train Acc: 0.8289
 Site-sketch                    (1) | Train Loss: 0.7079 | Train Acc: 0.7267
 Site-sketch                    (1) | Train Loss: 0.7224 | Train Acc: 0.7733
Average Train Accuracy: 0.8558
 Site-photo                     (3) | Val  Loss: 0.2379 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.2366 | Val  Acc: 0.9667
 Site-art_painting              (2) | Val  Loss: 0.4942 | Val  Acc: 0.8600
 Site-art_painting              (2) | Val  Loss: 0.5062 | Val  Acc: 0.8600
 Site-cartoon                   (0) | Val  Loss: 0.6061 | Val  Acc: 0.8200
 Site-cartoon                   (0) | Val  Loss: 0.5690 | Val  Acc: 0.8267
 Site-sketch                    (1) | Val  Loss: 0.7089 | Val  Acc: 0.7500
 Site-sketch                    (1) | Val  Loss: 0.7104 | Val  Acc: 0.7633
Average Valid Accuracy: 0.8496
============ Train epoch 13 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (3) | Train Loss: 0.2554 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.2056 | Train Acc: 0.9822
 Site-art_painting              (2) | Train Loss: 0.5067 | Train Acc: 0.8733
 Site-art_painting              (2) | Train Loss: 0.4065 | Train Acc: 0.9022
 Site-cartoon                   (0) | Train Loss: 0.5950 | Train Acc: 0.8133
 Site-cartoon                   (0) | Train Loss: 0.5023 | Train Acc: 0.8400
 Site-sketch                    (1) | Train Loss: 0.6553 | Train Acc: 0.7733
 Site-sketch                    (1) | Train Loss: 0.6216 | Train Acc: 0.7644
Average Train Accuracy: 0.8644
 Site-photo                     (3) | Val  Loss: 0.2617 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.2357 | Val  Acc: 0.9733
 Site-art_painting              (2) | Val  Loss: 0.5218 | Val  Acc: 0.8600
 Site-art_painting              (2) | Val  Loss: 0.4375 | Val  Acc: 0.8900
 Site-cartoon                   (0) | Val  Loss: 0.5783 | Val  Acc: 0.8000
 Site-cartoon                   (0) | Val  Loss: 0.5515 | Val  Acc: 0.8100
 Site-sketch                    (1) | Val  Loss: 0.6547 | Val  Acc: 0.7700
 Site-sketch                    (1) | Val  Loss: 0.6674 | Val  Acc: 0.7700
Average Valid Accuracy: 0.8542
============ Train epoch 14 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (3) | Train Loss: 0.2211 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.1966 | Train Acc: 0.9733
 Site-art_painting              (1) | Train Loss: 0.4708 | Train Acc: 0.8733
 Site-art_painting              (1) | Train Loss: 0.5040 | Train Acc: 0.8822
 Site-cartoon                   (2) | Train Loss: 0.5617 | Train Acc: 0.8133
 Site-cartoon                   (2) | Train Loss: 0.4616 | Train Acc: 0.8511
 Site-sketch                    (0) | Train Loss: 0.6616 | Train Acc: 0.8067
 Site-sketch                    (0) | Train Loss: 0.6285 | Train Acc: 0.7644
Average Train Accuracy: 0.8689
 Site-photo                     (3) | Val  Loss: 0.2241 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.2186 | Val  Acc: 0.9633
 Site-art_painting              (1) | Val  Loss: 0.4491 | Val  Acc: 0.8700
 Site-art_painting              (1) | Val  Loss: 0.4330 | Val  Acc: 0.8933
 Site-cartoon                   (2) | Val  Loss: 0.5501 | Val  Acc: 0.8100
 Site-cartoon                   (2) | Val  Loss: 0.4835 | Val  Acc: 0.8700
 Site-sketch                    (0) | Val  Loss: 0.6049 | Val  Acc: 0.7900
 Site-sketch                    (0) | Val  Loss: 0.6590 | Val  Acc: 0.7433
Average Valid Accuracy: 0.8625
 Best site-photo                    (3)  | Epoch:14 | Val Acc: 0.9600
 Best site-photo                    (3)  | Epoch:14 | Val Acc: 0.9633
 Best site-art_painting             (1)  | Epoch:14 | Val Acc: 0.8700
 Best site-art_painting             (1)  | Epoch:14 | Val Acc: 0.8933
 Best site-cartoon                  (2)  | Epoch:14 | Val Acc: 0.8100
 Best site-cartoon                  (2)  | Epoch:14 | Val Acc: 0.8700
 Best site-sketch                   (0)  | Epoch:14 | Val Acc: 0.7900
 Best site-sketch                   (0)  | Epoch:14 | Val Acc: 0.7433
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 15 ============
cnt=[4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (0) | Train Loss: 0.1979 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.1911 | Train Acc: 0.9733
 Site-art_painting              (0) | Train Loss: 0.4765 | Train Acc: 0.8600
 Site-art_painting              (0) | Train Loss: 0.3779 | Train Acc: 0.9044
 Site-cartoon                   (2) | Train Loss: 0.5363 | Train Acc: 0.8267
 Site-cartoon                   (2) | Train Loss: 0.4396 | Train Acc: 0.8511
 Site-sketch                    (3) | Train Loss: 0.6388 | Train Acc: 0.8000
 Site-sketch                    (1) | Train Loss: 0.5672 | Train Acc: 0.7844
Average Train Accuracy: 0.8733
 Site-photo                     (0) | Val  Loss: 0.2520 | Val  Acc: 0.9500
 Site-photo                     (0) | Val  Loss: 0.2116 | Val  Acc: 0.9700
 Site-art_painting              (0) | Val  Loss: 0.4308 | Val  Acc: 0.8800
 Site-art_painting              (0) | Val  Loss: 0.4487 | Val  Acc: 0.8900
 Site-cartoon                   (2) | Val  Loss: 0.5820 | Val  Acc: 0.7700
 Site-cartoon                   (2) | Val  Loss: 0.4935 | Val  Acc: 0.8567
 Site-sketch                    (3) | Val  Loss: 0.6215 | Val  Acc: 0.7800
 Site-sketch                    (1) | Val  Loss: 0.6466 | Val  Acc: 0.8100
Average Valid Accuracy: 0.8633
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9500
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9700
 Best site-art_painting             (0)  | Epoch:15 | Val Acc: 0.8800
 Best site-art_painting             (0)  | Epoch:15 | Val Acc: 0.8900
 Best site-cartoon                  (2)  | Epoch:15 | Val Acc: 0.7700
 Best site-cartoon                  (2)  | Epoch:15 | Val Acc: 0.8567
 Best site-sketch                   (3)  | Epoch:15 | Val Acc: 0.7800
 Best site-sketch                   (1)  | Epoch:15 | Val Acc: 0.8100
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 16 ============
cnt=[4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (0) | Train Loss: 0.2341 | Train Acc: 0.9667
 Site-photo                     (0) | Train Loss: 0.1785 | Train Acc: 0.9756
 Site-art_painting              (0) | Train Loss: 0.5094 | Train Acc: 0.8467
 Site-art_painting              (0) | Train Loss: 0.4154 | Train Acc: 0.8933
 Site-cartoon                   (2) | Train Loss: 0.5222 | Train Acc: 0.8400
 Site-cartoon                   (3) | Train Loss: 0.4049 | Train Acc: 0.8689
 Site-sketch                    (1) | Train Loss: 0.6708 | Train Acc: 0.7667
 Site-sketch                    (1) | Train Loss: 0.5845 | Train Acc: 0.7733
Average Train Accuracy: 0.8664
 Site-photo                     (0) | Val  Loss: 0.2150 | Val  Acc: 0.9700
 Site-photo                     (0) | Val  Loss: 0.2090 | Val  Acc: 0.9667
 Site-art_painting              (0) | Val  Loss: 0.4857 | Val  Acc: 0.8500
 Site-art_painting              (0) | Val  Loss: 0.4699 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.5520 | Val  Acc: 0.8300
 Site-cartoon                   (3) | Val  Loss: 0.4728 | Val  Acc: 0.8500
 Site-sketch                    (1) | Val  Loss: 0.6526 | Val  Acc: 0.7500
 Site-sketch                    (1) | Val  Loss: 0.5881 | Val  Acc: 0.8033
Average Valid Accuracy: 0.8625
============ Train epoch 17 ============
cnt=[4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (0) | Train Loss: 0.2467 | Train Acc: 0.9467
 Site-photo                     (0) | Train Loss: 0.2266 | Train Acc: 0.9689
 Site-art_painting              (0) | Train Loss: 0.5294 | Train Acc: 0.8867
 Site-art_painting              (0) | Train Loss: 0.4026 | Train Acc: 0.9000
 Site-cartoon                   (3) | Train Loss: 0.4981 | Train Acc: 0.8733
 Site-cartoon                   (2) | Train Loss: 0.4517 | Train Acc: 0.8711
 Site-sketch                    (1) | Train Loss: 0.5943 | Train Acc: 0.7733
 Site-sketch                    (1) | Train Loss: 0.5390 | Train Acc: 0.7778
Average Train Accuracy: 0.8747
 Site-photo                     (0) | Val  Loss: 0.1933 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.2028 | Val  Acc: 0.9700
 Site-art_painting              (0) | Val  Loss: 0.4462 | Val  Acc: 0.8800
 Site-art_painting              (0) | Val  Loss: 0.4174 | Val  Acc: 0.9000
 Site-cartoon                   (3) | Val  Loss: 0.4572 | Val  Acc: 0.8400
 Site-cartoon                   (2) | Val  Loss: 0.4575 | Val  Acc: 0.8533
 Site-sketch                    (1) | Val  Loss: 0.5483 | Val  Acc: 0.7800
 Site-sketch                    (1) | Val  Loss: 0.5998 | Val  Acc: 0.7867
Average Valid Accuracy: 0.8712
 Best site-photo                    (0)  | Epoch:17 | Val Acc: 0.9600
 Best site-photo                    (0)  | Epoch:17 | Val Acc: 0.9700
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8800
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.9000
 Best site-cartoon                  (3)  | Epoch:17 | Val Acc: 0.8400
 Best site-cartoon                  (2)  | Epoch:17 | Val Acc: 0.8533
 Best site-sketch                   (1)  | Epoch:17 | Val Acc: 0.7800
 Best site-sketch                   (1)  | Epoch:17 | Val Acc: 0.7867
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 18 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (0) | Train Loss: 0.1953 | Train Acc: 0.9667
 Site-photo                     (0) | Train Loss: 0.1766 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.4345 | Train Acc: 0.8667
 Site-art_painting              (3) | Train Loss: 0.3691 | Train Acc: 0.8933
 Site-cartoon                   (2) | Train Loss: 0.4760 | Train Acc: 0.8667
 Site-cartoon                   (2) | Train Loss: 0.4890 | Train Acc: 0.8444
 Site-sketch                    (1) | Train Loss: 0.6475 | Train Acc: 0.7733
 Site-sketch                    (1) | Train Loss: 0.6227 | Train Acc: 0.7889
Average Train Accuracy: 0.8717
 Site-photo                     (0) | Val  Loss: 0.1865 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.1980 | Val  Acc: 0.9700
 Site-art_painting              (3) | Val  Loss: 0.4101 | Val  Acc: 0.8800
 Site-art_painting              (3) | Val  Loss: 0.4178 | Val  Acc: 0.8867
 Site-cartoon                   (2) | Val  Loss: 0.5216 | Val  Acc: 0.7900
 Site-cartoon                   (2) | Val  Loss: 0.4493 | Val  Acc: 0.8500
 Site-sketch                    (1) | Val  Loss: 0.5991 | Val  Acc: 0.7600
 Site-sketch                    (1) | Val  Loss: 0.6186 | Val  Acc: 0.7567
Average Valid Accuracy: 0.8567
============ Train epoch 19 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (1) | Train Loss: 0.2040 | Train Acc: 0.9733
 Site-photo                     (1) | Train Loss: 0.1699 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.3900 | Train Acc: 0.9133
 Site-art_painting              (3) | Train Loss: 0.4399 | Train Acc: 0.8933
 Site-cartoon                   (2) | Train Loss: 0.4677 | Train Acc: 0.8533
 Site-cartoon                   (2) | Train Loss: 0.4371 | Train Acc: 0.8756
 Site-sketch                    (0) | Train Loss: 0.5340 | Train Acc: 0.8333
 Site-sketch                    (0) | Train Loss: 0.5806 | Train Acc: 0.7978
Average Train Accuracy: 0.8894
 Site-photo                     (1) | Val  Loss: 0.1817 | Val  Acc: 0.9700
 Site-photo                     (1) | Val  Loss: 0.1911 | Val  Acc: 0.9700
 Site-art_painting              (3) | Val  Loss: 0.3758 | Val  Acc: 0.8900
 Site-art_painting              (3) | Val  Loss: 0.3644 | Val  Acc: 0.9233
 Site-cartoon                   (2) | Val  Loss: 0.4824 | Val  Acc: 0.8000
 Site-cartoon                   (2) | Val  Loss: 0.4478 | Val  Acc: 0.8433
 Site-sketch                    (0) | Val  Loss: 0.5422 | Val  Acc: 0.8600
 Site-sketch                    (0) | Val  Loss: 0.5874 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8821
 Best site-photo                    (1)  | Epoch:19 | Val Acc: 0.9700
 Best site-photo                    (1)  | Epoch:19 | Val Acc: 0.9700
 Best site-art_painting             (3)  | Epoch:19 | Val Acc: 0.8900
 Best site-art_painting             (3)  | Epoch:19 | Val Acc: 0.9233
 Best site-cartoon                  (2)  | Epoch:19 | Val Acc: 0.8000
 Best site-cartoon                  (2)  | Epoch:19 | Val Acc: 0.8433
 Best site-sketch                   (0)  | Epoch:19 | Val Acc: 0.8600
 Best site-sketch                   (0)  | Epoch:19 | Val Acc: 0.8000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 20 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (3) | Train Loss: 0.1844 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.1613 | Train Acc: 0.9800
 Site-art_painting              (2) | Train Loss: 0.4021 | Train Acc: 0.8800
 Site-art_painting              (2) | Train Loss: 0.3177 | Train Acc: 0.9289
 Site-cartoon                   (0) | Train Loss: 0.4103 | Train Acc: 0.8400
 Site-cartoon                   (0) | Train Loss: 0.4213 | Train Acc: 0.8667
 Site-sketch                    (1) | Train Loss: 0.4959 | Train Acc: 0.8067
 Site-sketch                    (1) | Train Loss: 0.5277 | Train Acc: 0.8000
Average Train Accuracy: 0.8836
 Site-photo                     (3) | Val  Loss: 0.1838 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.1874 | Val  Acc: 0.9667
 Site-art_painting              (2) | Val  Loss: 0.4470 | Val  Acc: 0.8700
 Site-art_painting              (2) | Val  Loss: 0.3596 | Val  Acc: 0.8967
 Site-cartoon                   (0) | Val  Loss: 0.4533 | Val  Acc: 0.8600
 Site-cartoon                   (0) | Val  Loss: 0.4403 | Val  Acc: 0.8267
 Site-sketch                    (1) | Val  Loss: 0.5318 | Val  Acc: 0.8100
 Site-sketch                    (1) | Val  Loss: 0.6023 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8738
============ Train epoch 21 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (2) | Train Loss: 0.1485 | Train Acc: 0.9867
 Site-photo                     (2) | Train Loss: 0.1482 | Train Acc: 0.9800
 Site-art_painting              (3) | Train Loss: 0.4752 | Train Acc: 0.8533
 Site-art_painting              (3) | Train Loss: 0.3207 | Train Acc: 0.9111
 Site-cartoon                   (0) | Train Loss: 0.4271 | Train Acc: 0.8267
 Site-cartoon                   (0) | Train Loss: 0.4766 | Train Acc: 0.8711
 Site-sketch                    (1) | Train Loss: 0.5633 | Train Acc: 0.7867
 Site-sketch                    (1) | Train Loss: 0.6037 | Train Acc: 0.7911
Average Train Accuracy: 0.8758
 Site-photo                     (2) | Val  Loss: 0.1549 | Val  Acc: 0.9900
 Site-photo                     (2) | Val  Loss: 0.1567 | Val  Acc: 0.9767
 Site-art_painting              (3) | Val  Loss: 0.4078 | Val  Acc: 0.8800
 Site-art_painting              (3) | Val  Loss: 0.3885 | Val  Acc: 0.8867
 Site-cartoon                   (0) | Val  Loss: 0.4452 | Val  Acc: 0.8500
 Site-cartoon                   (0) | Val  Loss: 0.4255 | Val  Acc: 0.8633
 Site-sketch                    (1) | Val  Loss: 0.5389 | Val  Acc: 0.7700
 Site-sketch                    (1) | Val  Loss: 0.5844 | Val  Acc: 0.7833
Average Valid Accuracy: 0.8750
============ Train epoch 22 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (0) | Train Loss: 0.1691 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.1538 | Train Acc: 0.9778
 Site-art_painting              (3) | Train Loss: 0.4264 | Train Acc: 0.8933
 Site-art_painting              (3) | Train Loss: 0.4113 | Train Acc: 0.9000
 Site-cartoon                   (2) | Train Loss: 0.3900 | Train Acc: 0.9067
 Site-cartoon                   (2) | Train Loss: 0.4669 | Train Acc: 0.8867
 Site-sketch                    (1) | Train Loss: 0.5575 | Train Acc: 0.7867
 Site-sketch                    (1) | Train Loss: 0.4916 | Train Acc: 0.7978
Average Train Accuracy: 0.8919
 Site-photo                     (0) | Val  Loss: 0.1588 | Val  Acc: 0.9700
 Site-photo                     (0) | Val  Loss: 0.1610 | Val  Acc: 0.9733
 Site-art_painting              (3) | Val  Loss: 0.3212 | Val  Acc: 0.9000
 Site-art_painting              (3) | Val  Loss: 0.3566 | Val  Acc: 0.8867
 Site-cartoon                   (2) | Val  Loss: 0.4371 | Val  Acc: 0.8400
 Site-cartoon                   (2) | Val  Loss: 0.4069 | Val  Acc: 0.8633
 Site-sketch                    (1) | Val  Loss: 0.5185 | Val  Acc: 0.8200
 Site-sketch                    (1) | Val  Loss: 0.5812 | Val  Acc: 0.7800
Average Valid Accuracy: 0.8792
============ Train epoch 23 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (1) | Train Loss: 0.1685 | Train Acc: 0.9733
 Site-photo                     (1) | Train Loss: 0.1354 | Train Acc: 0.9844
 Site-art_painting              (3) | Train Loss: 0.3811 | Train Acc: 0.8733
 Site-art_painting              (3) | Train Loss: 0.3072 | Train Acc: 0.9111
 Site-cartoon                   (2) | Train Loss: 0.4074 | Train Acc: 0.8667
 Site-cartoon                   (2) | Train Loss: 0.3600 | Train Acc: 0.8756
 Site-sketch                    (0) | Train Loss: 0.6223 | Train Acc: 0.7867
 Site-sketch                    (0) | Train Loss: 0.4820 | Train Acc: 0.8067
Average Train Accuracy: 0.8847
 Site-photo                     (1) | Val  Loss: 0.1627 | Val  Acc: 0.9800
 Site-photo                     (1) | Val  Loss: 0.1733 | Val  Acc: 0.9700
 Site-art_painting              (3) | Val  Loss: 0.4074 | Val  Acc: 0.8700
 Site-art_painting              (3) | Val  Loss: 0.3318 | Val  Acc: 0.9233
 Site-cartoon                   (2) | Val  Loss: 0.4024 | Val  Acc: 0.8500
 Site-cartoon                   (2) | Val  Loss: 0.3861 | Val  Acc: 0.8667
 Site-sketch                    (0) | Val  Loss: 0.5502 | Val  Acc: 0.7500
 Site-sketch                    (0) | Val  Loss: 0.5736 | Val  Acc: 0.8100
Average Valid Accuracy: 0.8775
============ Train epoch 24 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (1) | Train Loss: 0.1870 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.1403 | Train Acc: 0.9711
 Site-art_painting              (3) | Train Loss: 0.3792 | Train Acc: 0.8800
 Site-art_painting              (3) | Train Loss: 0.3048 | Train Acc: 0.9156
 Site-cartoon                   (2) | Train Loss: 0.4437 | Train Acc: 0.8733
 Site-cartoon                   (2) | Train Loss: 0.5749 | Train Acc: 0.8733
 Site-sketch                    (0) | Train Loss: 0.6742 | Train Acc: 0.7733
 Site-sketch                    (0) | Train Loss: 0.4993 | Train Acc: 0.7956
Average Train Accuracy: 0.8828
 Site-photo                     (1) | Val  Loss: 0.1727 | Val  Acc: 0.9800
 Site-photo                     (1) | Val  Loss: 0.1673 | Val  Acc: 0.9733
 Site-art_painting              (3) | Val  Loss: 0.3576 | Val  Acc: 0.8900
 Site-art_painting              (3) | Val  Loss: 0.3201 | Val  Acc: 0.9200
 Site-cartoon                   (2) | Val  Loss: 0.4195 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.3868 | Val  Acc: 0.8733
 Site-sketch                    (0) | Val  Loss: 0.5095 | Val  Acc: 0.8200
 Site-sketch                    (0) | Val  Loss: 0.5385 | Val  Acc: 0.8233
Average Valid Accuracy: 0.8950
 Best site-photo                    (1)  | Epoch:24 | Val Acc: 0.9800
 Best site-photo                    (1)  | Epoch:24 | Val Acc: 0.9733
 Best site-art_painting             (3)  | Epoch:24 | Val Acc: 0.8900
 Best site-art_painting             (3)  | Epoch:24 | Val Acc: 0.9200
 Best site-cartoon                  (2)  | Epoch:24 | Val Acc: 0.8800
 Best site-cartoon                  (2)  | Epoch:24 | Val Acc: 0.8733
 Best site-sketch                   (0)  | Epoch:24 | Val Acc: 0.8200
 Best site-sketch                   (0)  | Epoch:24 | Val Acc: 0.8233
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (3) | Train Loss: 0.1871 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.1401 | Train Acc: 0.9711
 Site-art_painting              (1) | Train Loss: 0.3862 | Train Acc: 0.8800
 Site-art_painting              (1) | Train Loss: 0.3324 | Train Acc: 0.9044
 Site-cartoon                   (2) | Train Loss: 0.3917 | Train Acc: 0.8800
 Site-cartoon                   (2) | Train Loss: 0.3310 | Train Acc: 0.8933
 Site-sketch                    (0) | Train Loss: 0.5369 | Train Acc: 0.8067
 Site-sketch                    (0) | Train Loss: 0.6286 | Train Acc: 0.7956
Average Train Accuracy: 0.8872
 Site-photo                     (3) | Val  Loss: 0.1827 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.1737 | Val  Acc: 0.9667
 Site-art_painting              (1) | Val  Loss: 0.4174 | Val  Acc: 0.8700
 Site-art_painting              (1) | Val  Loss: 0.3539 | Val  Acc: 0.8867
 Site-cartoon                   (2) | Val  Loss: 0.3823 | Val  Acc: 0.8900
 Site-cartoon                   (2) | Val  Loss: 0.3317 | Val  Acc: 0.8967
 Site-sketch                    (0) | Val  Loss: 0.5476 | Val  Acc: 0.7500
 Site-sketch                    (0) | Val  Loss: 0.5460 | Val  Acc: 0.7867
Average Valid Accuracy: 0.8746
============ Train epoch 26 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (0) | Train Loss: 0.1486 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.1364 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.3671 | Train Acc: 0.8800
 Site-art_painting              (3) | Train Loss: 0.3807 | Train Acc: 0.9156
 Site-cartoon                   (2) | Train Loss: 0.4267 | Train Acc: 0.8867
 Site-cartoon                   (2) | Train Loss: 0.3125 | Train Acc: 0.8822
 Site-sketch                    (1) | Train Loss: 0.4934 | Train Acc: 0.8267
 Site-sketch                    (1) | Train Loss: 0.4722 | Train Acc: 0.8400
Average Train Accuracy: 0.8989
 Site-photo                     (0) | Val  Loss: 0.1605 | Val  Acc: 0.9800
 Site-photo                     (0) | Val  Loss: 0.1772 | Val  Acc: 0.9633
 Site-art_painting              (3) | Val  Loss: 0.4449 | Val  Acc: 0.8800
 Site-art_painting              (3) | Val  Loss: 0.3025 | Val  Acc: 0.9300
 Site-cartoon                   (2) | Val  Loss: 0.4395 | Val  Acc: 0.8500
 Site-cartoon                   (2) | Val  Loss: 0.3525 | Val  Acc: 0.9033
 Site-sketch                    (1) | Val  Loss: 0.4762 | Val  Acc: 0.8200
 Site-sketch                    (1) | Val  Loss: 0.5397 | Val  Acc: 0.8167
Average Valid Accuracy: 0.8929
============ Train epoch 27 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (1) | Train Loss: 0.1676 | Train Acc: 0.9667
 Site-photo                     (1) | Train Loss: 0.1191 | Train Acc: 0.9778
 Site-art_painting              (3) | Train Loss: 0.3683 | Train Acc: 0.8867
 Site-art_painting              (3) | Train Loss: 0.3359 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.4579 | Train Acc: 0.8667
 Site-cartoon                   (2) | Train Loss: 0.4358 | Train Acc: 0.8800
 Site-sketch                    (0) | Train Loss: 0.4701 | Train Acc: 0.8533
 Site-sketch                    (0) | Train Loss: 0.4633 | Train Acc: 0.8289
Average Train Accuracy: 0.8975
 Site-photo                     (1) | Val  Loss: 0.1759 | Val  Acc: 0.9700
 Site-photo                     (1) | Val  Loss: 0.1336 | Val  Acc: 0.9767
 Site-art_painting              (3) | Val  Loss: 0.3732 | Val  Acc: 0.8700
 Site-art_painting              (3) | Val  Loss: 0.3099 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.4224 | Val  Acc: 0.8200
 Site-cartoon                   (2) | Val  Loss: 0.3934 | Val  Acc: 0.8633
 Site-sketch                    (0) | Val  Loss: 0.5174 | Val  Acc: 0.7800
 Site-sketch                    (0) | Val  Loss: 0.5250 | Val  Acc: 0.7967
Average Valid Accuracy: 0.8721
============ Train epoch 28 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (3) | Train Loss: 0.1442 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.1512 | Train Acc: 0.9756
 Site-art_painting              (2) | Train Loss: 0.3651 | Train Acc: 0.8933
 Site-art_painting              (2) | Train Loss: 0.2795 | Train Acc: 0.9267
 Site-cartoon                   (0) | Train Loss: 0.3701 | Train Acc: 0.9067
 Site-cartoon                   (0) | Train Loss: 0.3315 | Train Acc: 0.8978
 Site-sketch                    (1) | Train Loss: 0.5040 | Train Acc: 0.8533
 Site-sketch                    (1) | Train Loss: 0.5721 | Train Acc: 0.8200
Average Train Accuracy: 0.9050
 Site-photo                     (3) | Val  Loss: 0.1472 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.1480 | Val  Acc: 0.9767
 Site-art_painting              (2) | Val  Loss: 0.2950 | Val  Acc: 0.9300
 Site-art_painting              (2) | Val  Loss: 0.3029 | Val  Acc: 0.9133
 Site-cartoon                   (0) | Val  Loss: 0.3837 | Val  Acc: 0.8700
 Site-cartoon                   (0) | Val  Loss: 0.3420 | Val  Acc: 0.8733
 Site-sketch                    (1) | Val  Loss: 0.4590 | Val  Acc: 0.8200
 Site-sketch                    (1) | Val  Loss: 0.5052 | Val  Acc: 0.8300
Average Valid Accuracy: 0.8954
 Best site-photo                    (3)  | Epoch:28 | Val Acc: 0.9500
 Best site-photo                    (3)  | Epoch:28 | Val Acc: 0.9767
 Best site-art_painting             (2)  | Epoch:28 | Val Acc: 0.9300
 Best site-art_painting             (2)  | Epoch:28 | Val Acc: 0.9133
 Best site-cartoon                  (0)  | Epoch:28 | Val Acc: 0.8700
 Best site-cartoon                  (0)  | Epoch:28 | Val Acc: 0.8733
 Best site-sketch                   (1)  | Epoch:28 | Val Acc: 0.8200
 Best site-sketch                   (1)  | Epoch:28 | Val Acc: 0.8300
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 29 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (2) | Train Loss: 0.1842 | Train Acc: 0.9867
 Site-photo                     (2) | Train Loss: 0.1132 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.3437 | Train Acc: 0.8867
 Site-art_painting              (3) | Train Loss: 0.2855 | Train Acc: 0.9156
 Site-cartoon                   (0) | Train Loss: 0.4342 | Train Acc: 0.8867
 Site-cartoon                   (0) | Train Loss: 0.3653 | Train Acc: 0.8911
 Site-sketch                    (1) | Train Loss: 0.5100 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.4536 | Train Acc: 0.8289
Average Train Accuracy: 0.8989
 Site-photo                     (2) | Val  Loss: 0.1497 | Val  Acc: 0.9700
 Site-photo                     (2) | Val  Loss: 0.1365 | Val  Acc: 0.9633
 Site-art_painting              (3) | Val  Loss: 0.3559 | Val  Acc: 0.8600
 Site-art_painting              (3) | Val  Loss: 0.2775 | Val  Acc: 0.9167
 Site-cartoon                   (0) | Val  Loss: 0.3870 | Val  Acc: 0.8300
 Site-cartoon                   (0) | Val  Loss: 0.3479 | Val  Acc: 0.8933
 Site-sketch                    (1) | Val  Loss: 0.4953 | Val  Acc: 0.7800
 Site-sketch                    (1) | Val  Loss: 0.4828 | Val  Acc: 0.8433
Average Valid Accuracy: 0.8821
============ Train epoch 30 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (2) | Train Loss: 0.1282 | Train Acc: 0.9800
 Site-photo                     (2) | Train Loss: 0.1374 | Train Acc: 0.9844
 Site-art_painting              (3) | Train Loss: 0.3912 | Train Acc: 0.8733
 Site-art_painting              (3) | Train Loss: 0.2739 | Train Acc: 0.9067
 Site-cartoon                   (0) | Train Loss: 0.3723 | Train Acc: 0.8867
 Site-cartoon                   (0) | Train Loss: 0.2838 | Train Acc: 0.9022
 Site-sketch                    (1) | Train Loss: 0.4800 | Train Acc: 0.8067
 Site-sketch                    (1) | Train Loss: 0.4521 | Train Acc: 0.8200
Average Train Accuracy: 0.8950
 Site-photo                     (2) | Val  Loss: 0.1516 | Val  Acc: 0.9600
 Site-photo                     (2) | Val  Loss: 0.1515 | Val  Acc: 0.9700
 Site-art_painting              (3) | Val  Loss: 0.3050 | Val  Acc: 0.9200
 Site-art_painting              (3) | Val  Loss: 0.2988 | Val  Acc: 0.9133
 Site-cartoon                   (0) | Val  Loss: 0.3774 | Val  Acc: 0.8700
 Site-cartoon                   (0) | Val  Loss: 0.3332 | Val  Acc: 0.8967
 Site-sketch                    (1) | Val  Loss: 0.4219 | Val  Acc: 0.8400
 Site-sketch                    (1) | Val  Loss: 0.4909 | Val  Acc: 0.8467
Average Valid Accuracy: 0.9021
 Best site-photo                    (2)  | Epoch:30 | Val Acc: 0.9600
 Best site-photo                    (2)  | Epoch:30 | Val Acc: 0.9700
 Best site-art_painting             (3)  | Epoch:30 | Val Acc: 0.9200
 Best site-art_painting             (3)  | Epoch:30 | Val Acc: 0.9133
 Best site-cartoon                  (0)  | Epoch:30 | Val Acc: 0.8700
 Best site-cartoon                  (0)  | Epoch:30 | Val Acc: 0.8967
 Best site-sketch                   (1)  | Epoch:30 | Val Acc: 0.8400
 Best site-sketch                   (1)  | Epoch:30 | Val Acc: 0.8467
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 31 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (3) | Train Loss: 0.1459 | Train Acc: 0.9600
 Site-photo                     (3) | Train Loss: 0.1153 | Train Acc: 0.9778
 Site-art_painting              (2) | Train Loss: 0.2867 | Train Acc: 0.9267
 Site-art_painting              (2) | Train Loss: 0.4371 | Train Acc: 0.9311
 Site-cartoon                   (0) | Train Loss: 0.4039 | Train Acc: 0.8600
 Site-cartoon                   (0) | Train Loss: 0.3012 | Train Acc: 0.8933
 Site-sketch                    (1) | Train Loss: 0.4896 | Train Acc: 0.8333
 Site-sketch                    (1) | Train Loss: 0.5183 | Train Acc: 0.8578
Average Train Accuracy: 0.9050
 Site-photo                     (3) | Val  Loss: 0.1626 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.1324 | Val  Acc: 0.9800
 Site-art_painting              (2) | Val  Loss: 0.2964 | Val  Acc: 0.9300
 Site-art_painting              (2) | Val  Loss: 0.2768 | Val  Acc: 0.9133
 Site-cartoon                   (0) | Val  Loss: 0.3708 | Val  Acc: 0.8700
 Site-cartoon                   (0) | Val  Loss: 0.3466 | Val  Acc: 0.8967
 Site-sketch                    (1) | Val  Loss: 0.4321 | Val  Acc: 0.8100
 Site-sketch                    (1) | Val  Loss: 0.4951 | Val  Acc: 0.8033
Average Valid Accuracy: 0.8942
============ Train epoch 32 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (1) | Train Loss: 0.1399 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.1158 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.3071 | Train Acc: 0.8867
 Site-art_painting              (3) | Train Loss: 0.2776 | Train Acc: 0.9244
 Site-cartoon                   (2) | Train Loss: 0.3529 | Train Acc: 0.8733
 Site-cartoon                   (2) | Train Loss: 0.4431 | Train Acc: 0.9000
 Site-sketch                    (0) | Train Loss: 0.5653 | Train Acc: 0.7733
 Site-sketch                    (0) | Train Loss: 0.4570 | Train Acc: 0.8222
Average Train Accuracy: 0.8919
 Site-photo                     (1) | Val  Loss: 0.1023 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1315 | Val  Acc: 0.9700
 Site-art_painting              (3) | Val  Loss: 0.3130 | Val  Acc: 0.8900
 Site-art_painting              (3) | Val  Loss: 0.2617 | Val  Acc: 0.9367
 Site-cartoon                   (2) | Val  Loss: 0.4184 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.3717 | Val  Acc: 0.8867
 Site-sketch                    (0) | Val  Loss: 0.4518 | Val  Acc: 0.8200
 Site-sketch                    (0) | Val  Loss: 0.4706 | Val  Acc: 0.8300
Average Valid Accuracy: 0.9004
============ Train epoch 33 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (0) | Train Loss: 0.1397 | Train Acc: 0.9800
 Site-photo                     (0) | Train Loss: 0.1620 | Train Acc: 0.9667
 Site-art_painting              (3) | Train Loss: 0.3483 | Train Acc: 0.9067
 Site-art_painting              (3) | Train Loss: 0.3513 | Train Acc: 0.9156
 Site-cartoon                   (2) | Train Loss: 0.3710 | Train Acc: 0.8800
 Site-cartoon                   (2) | Train Loss: 0.2755 | Train Acc: 0.9156
 Site-sketch                    (1) | Train Loss: 0.5660 | Train Acc: 0.8267
 Site-sketch                    (1) | Train Loss: 0.5873 | Train Acc: 0.8267
Average Train Accuracy: 0.9022
 Site-photo                     (0) | Val  Loss: 0.1696 | Val  Acc: 0.9800
 Site-photo                     (0) | Val  Loss: 0.1428 | Val  Acc: 0.9800
 Site-art_painting              (3) | Val  Loss: 0.3487 | Val  Acc: 0.8700
 Site-art_painting              (3) | Val  Loss: 0.2714 | Val  Acc: 0.9200
 Site-cartoon                   (2) | Val  Loss: 0.3477 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.3388 | Val  Acc: 0.9067
 Site-sketch                    (1) | Val  Loss: 0.4921 | Val  Acc: 0.8200
 Site-sketch                    (1) | Val  Loss: 0.5113 | Val  Acc: 0.8200
Average Valid Accuracy: 0.8958
============ Train epoch 34 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (0) | Train Loss: 0.1555 | Train Acc: 0.9667
 Site-photo                     (0) | Train Loss: 0.1161 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.2627 | Train Acc: 0.9267
 Site-art_painting              (3) | Train Loss: 0.3087 | Train Acc: 0.9333
 Site-cartoon                   (2) | Train Loss: 0.3465 | Train Acc: 0.8867
 Site-cartoon                   (2) | Train Loss: 0.3397 | Train Acc: 0.9067
 Site-sketch                    (1) | Train Loss: 0.5321 | Train Acc: 0.7933
 Site-sketch                    (1) | Train Loss: 0.4199 | Train Acc: 0.8333
Average Train Accuracy: 0.9025
 Site-photo                     (0) | Val  Loss: 0.1721 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.1332 | Val  Acc: 0.9800
 Site-art_painting              (3) | Val  Loss: 0.3481 | Val  Acc: 0.8600
 Site-art_painting              (3) | Val  Loss: 0.2938 | Val  Acc: 0.9100
 Site-cartoon                   (2) | Val  Loss: 0.3704 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.3186 | Val  Acc: 0.9100
 Site-sketch                    (1) | Val  Loss: 0.4641 | Val  Acc: 0.8700
 Site-sketch                    (1) | Val  Loss: 0.4671 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9004
============ Train epoch 35 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (3) | Train Loss: 0.1288 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.1169 | Train Acc: 0.9800
 Site-art_painting              (0) | Train Loss: 0.3788 | Train Acc: 0.9133
 Site-art_painting              (0) | Train Loss: 0.2434 | Train Acc: 0.9222
 Site-cartoon                   (2) | Train Loss: 0.3128 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.3079 | Train Acc: 0.8978
 Site-sketch                    (1) | Train Loss: 0.4149 | Train Acc: 0.8533
 Site-sketch                    (1) | Train Loss: 0.4126 | Train Acc: 0.8178
Average Train Accuracy: 0.9106
 Site-photo                     (3) | Val  Loss: 0.1534 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.1292 | Val  Acc: 0.9733
 Site-art_painting              (0) | Val  Loss: 0.3151 | Val  Acc: 0.9100
 Site-art_painting              (0) | Val  Loss: 0.2610 | Val  Acc: 0.9267
 Site-cartoon                   (2) | Val  Loss: 0.3533 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.3309 | Val  Acc: 0.8867
 Site-sketch                    (1) | Val  Loss: 0.4236 | Val  Acc: 0.8300
 Site-sketch                    (1) | Val  Loss: 0.4608 | Val  Acc: 0.8467
Average Valid Accuracy: 0.8992
============ Train epoch 36 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (1) | Train Loss: 0.1114 | Train Acc: 0.9733
 Site-photo                     (1) | Train Loss: 0.1152 | Train Acc: 0.9778
 Site-art_painting              (3) | Train Loss: 0.3147 | Train Acc: 0.9267
 Site-art_painting              (3) | Train Loss: 0.3652 | Train Acc: 0.9356
 Site-cartoon                   (2) | Train Loss: 0.3471 | Train Acc: 0.8800
 Site-cartoon                   (2) | Train Loss: 0.2886 | Train Acc: 0.8978
 Site-sketch                    (0) | Train Loss: 0.4760 | Train Acc: 0.8133
 Site-sketch                    (0) | Train Loss: 0.4228 | Train Acc: 0.8511
Average Train Accuracy: 0.9069
 Site-photo                     (1) | Val  Loss: 0.1624 | Val  Acc: 0.9600
 Site-photo                     (1) | Val  Loss: 0.1206 | Val  Acc: 0.9733
 Site-art_painting              (3) | Val  Loss: 0.2837 | Val  Acc: 0.9200
 Site-art_painting              (3) | Val  Loss: 0.2667 | Val  Acc: 0.9267
 Site-cartoon                   (2) | Val  Loss: 0.4284 | Val  Acc: 0.8000
 Site-cartoon                   (2) | Val  Loss: 0.3392 | Val  Acc: 0.8800
 Site-sketch                    (0) | Val  Loss: 0.4152 | Val  Acc: 0.8500
 Site-sketch                    (0) | Val  Loss: 0.4761 | Val  Acc: 0.8167
Average Valid Accuracy: 0.8908
============ Train epoch 37 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (3) | Train Loss: 0.1702 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.0974 | Train Acc: 0.9778
 Site-art_painting              (0) | Train Loss: 0.3002 | Train Acc: 0.9333
 Site-art_painting              (0) | Train Loss: 0.2979 | Train Acc: 0.9333
 Site-cartoon                   (2) | Train Loss: 0.3697 | Train Acc: 0.9000
 Site-cartoon                   (2) | Train Loss: 0.3180 | Train Acc: 0.8733
 Site-sketch                    (1) | Train Loss: 0.5243 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.4865 | Train Acc: 0.8178
Average Train Accuracy: 0.9036
 Site-photo                     (3) | Val  Loss: 0.1200 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1136 | Val  Acc: 0.9800
 Site-art_painting              (0) | Val  Loss: 0.3412 | Val  Acc: 0.8700
 Site-art_painting              (0) | Val  Loss: 0.2281 | Val  Acc: 0.9333
 Site-cartoon                   (2) | Val  Loss: 0.3915 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.3413 | Val  Acc: 0.8767
 Site-sketch                    (1) | Val  Loss: 0.4683 | Val  Acc: 0.8400
 Site-sketch                    (1) | Val  Loss: 0.4650 | Val  Acc: 0.8100
Average Valid Accuracy: 0.8975
============ Train epoch 38 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (0) | Train Loss: 0.1057 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.0980 | Train Acc: 0.9778
 Site-art_painting              (3) | Train Loss: 0.3696 | Train Acc: 0.8933
 Site-art_painting              (3) | Train Loss: 0.2687 | Train Acc: 0.9044
 Site-cartoon                   (2) | Train Loss: 0.3261 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.3638 | Train Acc: 0.9067
 Site-sketch                    (1) | Train Loss: 0.4832 | Train Acc: 0.8000
 Site-sketch                    (1) | Train Loss: 0.4413 | Train Acc: 0.8444
Average Train Accuracy: 0.9042
 Site-photo                     (0) | Val  Loss: 0.1134 | Val  Acc: 0.9700
 Site-photo                     (0) | Val  Loss: 0.1230 | Val  Acc: 0.9833
 Site-art_painting              (3) | Val  Loss: 0.2833 | Val  Acc: 0.8900
 Site-art_painting              (3) | Val  Loss: 0.2780 | Val  Acc: 0.9300
 Site-cartoon                   (2) | Val  Loss: 0.3660 | Val  Acc: 0.8400
 Site-cartoon                   (2) | Val  Loss: 0.3242 | Val  Acc: 0.8833
 Site-sketch                    (1) | Val  Loss: 0.4326 | Val  Acc: 0.9000
 Site-sketch                    (1) | Val  Loss: 0.4783 | Val  Acc: 0.8233
Average Valid Accuracy: 0.9025
 Best site-photo                    (0)  | Epoch:38 | Val Acc: 0.9700
 Best site-photo                    (0)  | Epoch:38 | Val Acc: 0.9833
 Best site-art_painting             (3)  | Epoch:38 | Val Acc: 0.8900
 Best site-art_painting             (3)  | Epoch:38 | Val Acc: 0.9300
 Best site-cartoon                  (2)  | Epoch:38 | Val Acc: 0.8400
 Best site-cartoon                  (2)  | Epoch:38 | Val Acc: 0.8833
 Best site-sketch                   (1)  | Epoch:38 | Val Acc: 0.9000
 Best site-sketch                   (1)  | Epoch:38 | Val Acc: 0.8233
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 39 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (3) | Train Loss: 0.1150 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.0978 | Train Acc: 0.9800
 Site-art_painting              (2) | Train Loss: 0.2672 | Train Acc: 0.9067
 Site-art_painting              (2) | Train Loss: 0.2543 | Train Acc: 0.9244
 Site-cartoon                   (0) | Train Loss: 0.3092 | Train Acc: 0.8933
 Site-cartoon                   (0) | Train Loss: 0.2646 | Train Acc: 0.8933
 Site-sketch                    (1) | Train Loss: 0.4689 | Train Acc: 0.8267
 Site-sketch                    (1) | Train Loss: 0.4334 | Train Acc: 0.8333
Average Train Accuracy: 0.9031
 Site-photo                     (3) | Val  Loss: 0.1106 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1269 | Val  Acc: 0.9767
 Site-art_painting              (2) | Val  Loss: 0.3528 | Val  Acc: 0.9000
 Site-art_painting              (2) | Val  Loss: 0.2611 | Val  Acc: 0.9300
 Site-cartoon                   (0) | Val  Loss: 0.3268 | Val  Acc: 0.8800
 Site-cartoon                   (0) | Val  Loss: 0.2910 | Val  Acc: 0.9233
 Site-sketch                    (1) | Val  Loss: 0.4298 | Val  Acc: 0.8700
 Site-sketch                    (1) | Val  Loss: 0.4223 | Val  Acc: 0.8600
Average Valid Accuracy: 0.9138
 Best site-photo                    (3)  | Epoch:39 | Val Acc: 0.9700
 Best site-photo                    (3)  | Epoch:39 | Val Acc: 0.9767
 Best site-art_painting             (2)  | Epoch:39 | Val Acc: 0.9000
 Best site-art_painting             (2)  | Epoch:39 | Val Acc: 0.9300
 Best site-cartoon                  (0)  | Epoch:39 | Val Acc: 0.8800
 Best site-cartoon                  (0)  | Epoch:39 | Val Acc: 0.9233
 Best site-sketch                   (1)  | Epoch:39 | Val Acc: 0.8700
 Best site-sketch                   (1)  | Epoch:39 | Val Acc: 0.8600
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (0) | Train Loss: 0.1443 | Train Acc: 0.9667
 Site-photo                     (0) | Train Loss: 0.1146 | Train Acc: 0.9689
 Site-art_painting              (3) | Train Loss: 0.3081 | Train Acc: 0.8867
 Site-art_painting              (3) | Train Loss: 0.2191 | Train Acc: 0.9356
 Site-cartoon                   (2) | Train Loss: 0.3597 | Train Acc: 0.9133
 Site-cartoon                   (2) | Train Loss: 0.2637 | Train Acc: 0.8978
 Site-sketch                    (1) | Train Loss: 0.5049 | Train Acc: 0.8467
 Site-sketch                    (1) | Train Loss: 0.3720 | Train Acc: 0.8578
Average Train Accuracy: 0.9092
 Site-photo                     (0) | Val  Loss: 0.1624 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.1392 | Val  Acc: 0.9700
 Site-art_painting              (3) | Val  Loss: 0.3010 | Val  Acc: 0.9100
 Site-art_painting              (3) | Val  Loss: 0.2503 | Val  Acc: 0.9200
 Site-cartoon                   (2) | Val  Loss: 0.3703 | Val  Acc: 0.8500
 Site-cartoon                   (2) | Val  Loss: 0.2772 | Val  Acc: 0.9033
 Site-sketch                    (1) | Val  Loss: 0.4159 | Val  Acc: 0.8900
 Site-sketch                    (1) | Val  Loss: 0.4709 | Val  Acc: 0.8433
Average Valid Accuracy: 0.9058
 Test site-photo                     (0)| Epoch:39 | Test Acc: 0.9910
 Test site-art_painting              (3)| Epoch:39 | Test Acc: 0.9172
 Test site-cartoon                   (2)| Epoch:39 | Test Acc: 0.8894
 Test site-sketch                    (1)| Epoch:39 | Test Acc: 0.8634
photo: 0.9910, art_painting: 0.9172, cartoon: 0.8894, sketch: 0.8634, 
Average Test Accuracy(group): 0.9152, Average Test Accuracy(individual): 0.9152,
domain std=0.0477, cluster std=0.0477, individual std=0.0477, 
Average Test Accuracy: 0.9152
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 41 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-photo                     (3) | Train Loss: 0.0938 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.1128 | Train Acc: 0.9733
 Site-art_painting              (0) | Train Loss: 0.3227 | Train Acc: 0.8867
 Site-art_painting              (0) | Train Loss: 0.2284 | Train Acc: 0.9156
 Site-cartoon                   (2) | Train Loss: 0.2905 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.2485 | Train Acc: 0.9111
 Site-sketch                    (1) | Train Loss: 0.4531 | Train Acc: 0.8267
 Site-sketch                    (1) | Train Loss: 0.3951 | Train Acc: 0.8289
Average Train Accuracy: 0.9053
 Site-photo                     (3) | Val  Loss: 0.1155 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1026 | Val  Acc: 0.9767
 Site-art_painting              (0) | Val  Loss: 0.3405 | Val  Acc: 0.8900
 Site-art_painting              (0) | Val  Loss: 0.2475 | Val  Acc: 0.9233
 Site-cartoon                   (2) | Val  Loss: 0.3761 | Val  Acc: 0.8600
 Site-cartoon                   (2) | Val  Loss: 0.3040 | Val  Acc: 0.9100
 Site-sketch                    (1) | Val  Loss: 0.3969 | Val  Acc: 0.8800
 Site-sketch                    (1) | Val  Loss: 0.4132 | Val  Acc: 0.8700
Average Valid Accuracy: 0.9100
 Test site-photo                     (3)| Epoch:40 | Test Acc: 0.9925
 Test site-art_painting              (0)| Epoch:40 | Test Acc: 0.9172
 Test site-cartoon                   (2)| Epoch:40 | Test Acc: 0.8904
 Test site-sketch                    (1)| Epoch:40 | Test Acc: 0.8596
photo: 0.9925, art_painting: 0.9172, cartoon: 0.8904, sketch: 0.8596, 
Average Test Accuracy(group): 0.9149, Average Test Accuracy(individual): 0.9149,
domain std=0.0492, cluster std=0.0492, individual std=0.0492, 
Average Test Accuracy: 0.9149
============ Train epoch 42 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-photo                     (0) | Train Loss: 0.1074 | Train Acc: 0.9933
 Site-photo                     (0) | Train Loss: 0.1081 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.2812 | Train Acc: 0.9200
 Site-art_painting              (3) | Train Loss: 0.2330 | Train Acc: 0.9222
 Site-cartoon                   (2) | Train Loss: 0.2918 | Train Acc: 0.9333
 Site-cartoon                   (2) | Train Loss: 0.2405 | Train Acc: 0.9244
 Site-sketch                    (1) | Train Loss: 0.4852 | Train Acc: 0.8133
 Site-sketch                    (1) | Train Loss: 0.6296 | Train Acc: 0.8467
Average Train Accuracy: 0.9158
 Site-photo                     (0) | Val  Loss: 0.1060 | Val  Acc: 0.9700
 Site-photo                     (0) | Val  Loss: 0.1146 | Val  Acc: 0.9767
 Site-art_painting              (3) | Val  Loss: 0.2987 | Val  Acc: 0.9200
 Site-art_painting              (3) | Val  Loss: 0.2268 | Val  Acc: 0.9233
 Site-cartoon                   (2) | Val  Loss: 0.2820 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.2816 | Val  Acc: 0.9033
 Site-sketch                    (1) | Val  Loss: 0.4116 | Val  Acc: 0.8600
 Site-sketch                    (1) | Val  Loss: 0.4690 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9108
 Test site-photo                     (0)| Epoch:40 | Test Acc: 0.9910
 Test site-art_painting              (3)| Epoch:40 | Test Acc: 0.9208
 Test site-cartoon                   (2)| Epoch:40 | Test Acc: 0.8926
 Test site-sketch                    (1)| Epoch:40 | Test Acc: 0.8450
photo: 0.9910, art_painting: 0.9208, cartoon: 0.8926, sketch: 0.8450, 
Average Test Accuracy(group): 0.9124, Average Test Accuracy(individual): 0.9124,
domain std=0.0529, cluster std=0.0529, individual std=0.0529, 
Average Test Accuracy: 0.9124
============ Train epoch 43 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-photo                     (3) | Train Loss: 0.0982 | Train Acc: 0.9933
 Site-photo                     (3) | Train Loss: 0.1032 | Train Acc: 0.9733
 Site-art_painting              (2) | Train Loss: 0.2322 | Train Acc: 0.9400
 Site-art_painting              (2) | Train Loss: 0.2029 | Train Acc: 0.9311
 Site-cartoon                   (0) | Train Loss: 0.2619 | Train Acc: 0.9200
 Site-cartoon                   (0) | Train Loss: 0.2335 | Train Acc: 0.9222
 Site-sketch                    (1) | Train Loss: 0.4279 | Train Acc: 0.8600
 Site-sketch                    (1) | Train Loss: 0.4541 | Train Acc: 0.8467
Average Train Accuracy: 0.9233
 Site-photo                     (3) | Val  Loss: 0.1487 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.1272 | Val  Acc: 0.9667
 Site-art_painting              (2) | Val  Loss: 0.3128 | Val  Acc: 0.8800
 Site-art_painting              (2) | Val  Loss: 0.2542 | Val  Acc: 0.9200
 Site-cartoon                   (0) | Val  Loss: 0.3932 | Val  Acc: 0.8300
 Site-cartoon                   (0) | Val  Loss: 0.2776 | Val  Acc: 0.9100
 Site-sketch                    (1) | Val  Loss: 0.3864 | Val  Acc: 0.8300
 Site-sketch                    (1) | Val  Loss: 0.4032 | Val  Acc: 0.8600
Average Valid Accuracy: 0.8946
 Test site-photo                     (3)| Epoch:40 | Test Acc: 0.9896
 Test site-art_painting              (2)| Epoch:40 | Test Acc: 0.9233
 Test site-cartoon                   (0)| Epoch:40 | Test Acc: 0.8926
 Test site-sketch                    (1)| Epoch:40 | Test Acc: 0.8571
photo: 0.9896, art_painting: 0.9233, cartoon: 0.8926, sketch: 0.8571, 
Average Test Accuracy(group): 0.9156, Average Test Accuracy(individual): 0.9156,
domain std=0.0487, cluster std=0.0487, individual std=0.0487, 
Average Test Accuracy: 0.9156
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 44 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-photo                     (3) | Train Loss: 0.1160 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.1010 | Train Acc: 0.9733
 Site-art_painting              (0) | Train Loss: 0.2586 | Train Acc: 0.9133
 Site-art_painting              (0) | Train Loss: 0.2112 | Train Acc: 0.9444
 Site-cartoon                   (2) | Train Loss: 0.3114 | Train Acc: 0.9333
 Site-cartoon                   (2) | Train Loss: 0.2814 | Train Acc: 0.9089
 Site-sketch                    (1) | Train Loss: 0.4208 | Train Acc: 0.8533
 Site-sketch                    (1) | Train Loss: 0.4757 | Train Acc: 0.8311
Average Train Accuracy: 0.9164
 Site-photo                     (3) | Val  Loss: 0.1160 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1199 | Val  Acc: 0.9633
 Site-art_painting              (0) | Val  Loss: 0.2977 | Val  Acc: 0.9200
 Site-art_painting              (0) | Val  Loss: 0.2536 | Val  Acc: 0.9267
 Site-cartoon                   (2) | Val  Loss: 0.3267 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.2747 | Val  Acc: 0.9133
 Site-sketch                    (1) | Val  Loss: 0.3408 | Val  Acc: 0.8900
 Site-sketch                    (1) | Val  Loss: 0.4114 | Val  Acc: 0.8367
Average Valid Accuracy: 0.9125
 Test site-photo                     (3)| Epoch:43 | Test Acc: 0.9910
 Test site-art_painting              (0)| Epoch:43 | Test Acc: 0.9233
 Test site-cartoon                   (2)| Epoch:43 | Test Acc: 0.8947
 Test site-sketch                    (1)| Epoch:43 | Test Acc: 0.8545
photo: 0.9910, art_painting: 0.9233, cartoon: 0.8947, sketch: 0.8545, 
Average Test Accuracy(group): 0.9159, Average Test Accuracy(individual): 0.9159,
domain std=0.0498, cluster std=0.0498, individual std=0.0498, 
Average Test Accuracy: 0.9159
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 45 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-photo                     (3) | Train Loss: 0.1374 | Train Acc: 0.9533
 Site-photo                     (3) | Train Loss: 0.0948 | Train Acc: 0.9844
 Site-art_painting              (0) | Train Loss: 0.2420 | Train Acc: 0.9200
 Site-art_painting              (0) | Train Loss: 0.4256 | Train Acc: 0.9244
 Site-cartoon                   (2) | Train Loss: 0.2800 | Train Acc: 0.9533
 Site-cartoon                   (2) | Train Loss: 0.2352 | Train Acc: 0.9111
 Site-sketch                    (1) | Train Loss: 0.5304 | Train Acc: 0.8400
 Site-sketch                    (1) | Train Loss: 0.3875 | Train Acc: 0.8578
Average Train Accuracy: 0.9181
 Site-photo                     (3) | Val  Loss: 0.1137 | Val  Acc: 0.9800
 Site-photo                     (3) | Val  Loss: 0.1170 | Val  Acc: 0.9800
 Site-art_painting              (0) | Val  Loss: 0.2437 | Val  Acc: 0.9300
 Site-art_painting              (0) | Val  Loss: 0.2637 | Val  Acc: 0.9167
 Site-cartoon                   (2) | Val  Loss: 0.3401 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.3120 | Val  Acc: 0.8933
 Site-sketch                    (1) | Val  Loss: 0.3283 | Val  Acc: 0.8800
 Site-sketch                    (1) | Val  Loss: 0.4139 | Val  Acc: 0.8633
Average Valid Accuracy: 0.9154
 Best site-photo                    (3)  | Epoch:45 | Val Acc: 0.9800
 Best site-photo                    (3)  | Epoch:45 | Val Acc: 0.9800
 Best site-art_painting             (0)  | Epoch:45 | Val Acc: 0.9300
 Best site-art_painting             (0)  | Epoch:45 | Val Acc: 0.9167
 Best site-cartoon                  (2)  | Epoch:45 | Val Acc: 0.8800
 Best site-cartoon                  (2)  | Epoch:45 | Val Acc: 0.8933
 Best site-sketch                   (1)  | Epoch:45 | Val Acc: 0.8800
 Best site-sketch                   (1)  | Epoch:45 | Val Acc: 0.8633
 Test site-photo                     (3)| Epoch:45 | Test Acc: 0.9896
 Test site-art_painting              (0)| Epoch:45 | Test Acc: 0.9233
 Test site-cartoon                   (2)| Epoch:45 | Test Acc: 0.8904
 Test site-sketch                    (1)| Epoch:45 | Test Acc: 0.8437
photo: 0.9896, art_painting: 0.9233, cartoon: 0.8904, sketch: 0.8437, 
Average Test Accuracy(group): 0.9117, Average Test Accuracy(individual): 0.9117,
domain std=0.0531, cluster std=0.0531, individual std=0.0531, 
Average Test Accuracy: 0.9117
============ Train epoch 46 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-photo                     (1) | Train Loss: 0.0912 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.0933 | Train Acc: 0.9844
 Site-art_painting              (3) | Train Loss: 0.2357 | Train Acc: 0.9267
 Site-art_painting              (3) | Train Loss: 0.1874 | Train Acc: 0.9311
 Site-cartoon                   (2) | Train Loss: 0.3413 | Train Acc: 0.9333
 Site-cartoon                   (2) | Train Loss: 0.2716 | Train Acc: 0.9067
 Site-sketch                    (0) | Train Loss: 0.5063 | Train Acc: 0.8400
 Site-sketch                    (0) | Train Loss: 0.3601 | Train Acc: 0.8689
Average Train Accuracy: 0.9214
 Site-photo                     (1) | Val  Loss: 0.1155 | Val  Acc: 0.9700
 Site-photo                     (1) | Val  Loss: 0.1215 | Val  Acc: 0.9700
 Site-art_painting              (3) | Val  Loss: 0.2523 | Val  Acc: 0.9000
 Site-art_painting              (3) | Val  Loss: 0.2302 | Val  Acc: 0.9333
 Site-cartoon                   (2) | Val  Loss: 0.2932 | Val  Acc: 0.9100
 Site-cartoon                   (2) | Val  Loss: 0.3163 | Val  Acc: 0.9000
 Site-sketch                    (0) | Val  Loss: 0.3910 | Val  Acc: 0.8600
 Site-sketch                    (0) | Val  Loss: 0.4171 | Val  Acc: 0.8433
Average Valid Accuracy: 0.9108
 Test site-photo                     (1)| Epoch:45 | Test Acc: 0.9910
 Test site-art_painting              (3)| Epoch:45 | Test Acc: 0.9257
 Test site-cartoon                   (2)| Epoch:45 | Test Acc: 0.8819
 Test site-sketch                    (0)| Epoch:45 | Test Acc: 0.8475
photo: 0.9910, art_painting: 0.9257, cartoon: 0.8819, sketch: 0.8475, 
Average Test Accuracy(group): 0.9115, Average Test Accuracy(individual): 0.9115,
domain std=0.0536, cluster std=0.0536, individual std=0.0536, 
Average Test Accuracy: 0.9115
============ Train epoch 47 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-photo                     (1) | Train Loss: 0.1171 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.0916 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.2959 | Train Acc: 0.9400
 Site-art_painting              (3) | Train Loss: 0.2011 | Train Acc: 0.9333
 Site-cartoon                   (2) | Train Loss: 0.2807 | Train Acc: 0.9267
 Site-cartoon                   (2) | Train Loss: 0.2567 | Train Acc: 0.9133
 Site-sketch                    (0) | Train Loss: 0.4082 | Train Acc: 0.8733
 Site-sketch                    (0) | Train Loss: 0.5207 | Train Acc: 0.8333
Average Train Accuracy: 0.9219
 Site-photo                     (1) | Val  Loss: 0.0950 | Val  Acc: 0.9800
 Site-photo                     (1) | Val  Loss: 0.1145 | Val  Acc: 0.9667
 Site-art_painting              (3) | Val  Loss: 0.2962 | Val  Acc: 0.9100
 Site-art_painting              (3) | Val  Loss: 0.2357 | Val  Acc: 0.9233
 Site-cartoon                   (2) | Val  Loss: 0.2980 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.2626 | Val  Acc: 0.9433
 Site-sketch                    (0) | Val  Loss: 0.3721 | Val  Acc: 0.8900
 Site-sketch                    (0) | Val  Loss: 0.4033 | Val  Acc: 0.8500
Average Valid Accuracy: 0.9204
 Best site-photo                    (1)  | Epoch:47 | Val Acc: 0.9800
 Best site-photo                    (1)  | Epoch:47 | Val Acc: 0.9667
 Best site-art_painting             (3)  | Epoch:47 | Val Acc: 0.9100
 Best site-art_painting             (3)  | Epoch:47 | Val Acc: 0.9233
 Best site-cartoon                  (2)  | Epoch:47 | Val Acc: 0.9000
 Best site-cartoon                  (2)  | Epoch:47 | Val Acc: 0.9433
 Best site-sketch                   (0)  | Epoch:47 | Val Acc: 0.8900
 Best site-sketch                   (0)  | Epoch:47 | Val Acc: 0.8500
 Test site-photo                     (1)| Epoch:47 | Test Acc: 0.9925
 Test site-art_painting              (3)| Epoch:47 | Test Acc: 0.9257
 Test site-cartoon                   (2)| Epoch:47 | Test Acc: 0.8894
 Test site-sketch                    (0)| Epoch:47 | Test Acc: 0.8596
photo: 0.9925, art_painting: 0.9257, cartoon: 0.8894, sketch: 0.8596, 
Average Test Accuracy(group): 0.9168, Average Test Accuracy(individual): 0.9168,
domain std=0.0496, cluster std=0.0496, individual std=0.0496, 
Average Test Accuracy: 0.9168
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/ccop_q=1...
============ Train epoch 48 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-photo                     (3) | Train Loss: 0.1023 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.1148 | Train Acc: 0.9733
 Site-art_painting              (1) | Train Loss: 0.2794 | Train Acc: 0.9133
 Site-art_painting              (1) | Train Loss: 0.1820 | Train Acc: 0.9444
 Site-cartoon                   (2) | Train Loss: 0.3170 | Train Acc: 0.8933
 Site-cartoon                   (2) | Train Loss: 0.2850 | Train Acc: 0.9178
 Site-sketch                    (0) | Train Loss: 0.4544 | Train Acc: 0.8867
 Site-sketch                    (0) | Train Loss: 0.3590 | Train Acc: 0.8600
Average Train Accuracy: 0.9219
 Site-photo                     (3) | Val  Loss: 0.1140 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1053 | Val  Acc: 0.9767
 Site-art_painting              (1) | Val  Loss: 0.2494 | Val  Acc: 0.9200
 Site-art_painting              (1) | Val  Loss: 0.2250 | Val  Acc: 0.9367
 Site-cartoon                   (2) | Val  Loss: 0.3042 | Val  Acc: 0.8500
 Site-cartoon                   (2) | Val  Loss: 0.2887 | Val  Acc: 0.9000
 Site-sketch                    (0) | Val  Loss: 0.3733 | Val  Acc: 0.8700
 Site-sketch                    (0) | Val  Loss: 0.3985 | Val  Acc: 0.8667
Average Valid Accuracy: 0.9113
 Test site-photo                     (3)| Epoch:47 | Test Acc: 0.9896
 Test site-art_painting              (1)| Epoch:47 | Test Acc: 0.9233
 Test site-cartoon                   (2)| Epoch:47 | Test Acc: 0.8862
 Test site-sketch                    (0)| Epoch:47 | Test Acc: 0.8640
photo: 0.9896, art_painting: 0.9233, cartoon: 0.8862, sketch: 0.8640, 
Average Test Accuracy(group): 0.9158, Average Test Accuracy(individual): 0.9158,
domain std=0.0476, cluster std=0.0476, individual std=0.0476, 
Average Test Accuracy: 0.9158
============ Train epoch 49 ============
cnt=[2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-photo                     (2) | Train Loss: 0.1047 | Train Acc: 0.9800
 Site-photo                     (2) | Train Loss: 0.0954 | Train Acc: 0.9778
 Site-art_painting              (3) | Train Loss: 0.2481 | Train Acc: 0.9267
 Site-art_painting              (3) | Train Loss: 0.2509 | Train Acc: 0.9311
 Site-cartoon                   (0) | Train Loss: 0.2791 | Train Acc: 0.9200
 Site-cartoon                   (0) | Train Loss: 0.2362 | Train Acc: 0.9311
 Site-sketch                    (1) | Train Loss: 0.4016 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.3626 | Train Acc: 0.8689
Average Train Accuracy: 0.9194
 Site-photo                     (2) | Val  Loss: 0.1227 | Val  Acc: 0.9700
 Site-photo                     (2) | Val  Loss: 0.1130 | Val  Acc: 0.9767
 Site-art_painting              (3) | Val  Loss: 0.2833 | Val  Acc: 0.9000
 Site-art_painting              (3) | Val  Loss: 0.2034 | Val  Acc: 0.9467
 Site-cartoon                   (0) | Val  Loss: 0.3139 | Val  Acc: 0.9000
 Site-cartoon                   (0) | Val  Loss: 0.2836 | Val  Acc: 0.9100
 Site-sketch                    (1) | Val  Loss: 0.3240 | Val  Acc: 0.9000
 Site-sketch                    (1) | Val  Loss: 0.4022 | Val  Acc: 0.8567
Average Valid Accuracy: 0.9200
 Test site-photo                     (2)| Epoch:47 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:47 | Test Acc: 0.9172
 Test site-cartoon                   (0)| Epoch:47 | Test Acc: 0.8904
 Test site-sketch                    (1)| Epoch:47 | Test Acc: 0.8640
photo: 0.9896, art_painting: 0.9172, cartoon: 0.8904, sketch: 0.8640, 
Average Test Accuracy(group): 0.9153, Average Test Accuracy(individual): 0.9153,
domain std=0.0468, cluster std=0.0468, individual std=0.0468, 
Average Test Accuracy: 0.9153
===2023-08-08 00:17:01===
===2023-08-08 00:17:18===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
Loading snapshots...
 Test site-photo                     (1)| Epoch:47 | Test Acc: 0.9925
 Test site-art_painting              (3)| Epoch:47 | Test Acc: 0.9257
 Test site-cartoon                   (2)| Epoch:47 | Test Acc: 0.8894
 Test site-sketch                    (0)| Epoch:47 | Test Acc: 0.8596
photo: 0.9925, art_painting: 0.9257, cartoon: 0.8894, sketch: 0.8596, 
Average Test Accuracy(group): 0.9168, Average Test Accuracy(individual): 0.9168,
domain std=0.0496, cluster std=0.0496, individual std=0.0496, 
