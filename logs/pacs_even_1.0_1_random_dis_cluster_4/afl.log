===2023-08-08 03:21:52===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
============ Train epoch 0 ============
 Site-photo                         | Train Loss: 1.7914 | Train Acc: 0.7000
 Site-photo                         | Train Loss: 1.7873 | Train Acc: 0.7467
 Site-art_painting                  | Train Loss: 1.8377 | Train Acc: 0.5600
 Site-art_painting                  | Train Loss: 1.8286 | Train Acc: 0.5244
 Site-cartoon                       | Train Loss: 1.8590 | Train Acc: 0.4067
 Site-cartoon                       | Train Loss: 1.8668 | Train Acc: 0.4000
 Site-sketch                        | Train Loss: 1.8753 | Train Acc: 0.2933
 Site-sketch                        | Train Loss: 1.8572 | Train Acc: 0.3111
Average Train Accuracy: 0.4928
 Site-photo                         | Val  Loss: 1.7794 | Val  Acc: 0.6500
 Site-photo                         | Val  Loss: 1.7704 | Val  Acc: 0.7233
 Site-art_painting                  | Val  Loss: 1.8273 | Val  Acc: 0.5800
 Site-art_painting                  | Val  Loss: 1.8392 | Val  Acc: 0.5167
 Site-cartoon                       | Val  Loss: 1.8531 | Val  Acc: 0.3800
 Site-cartoon                       | Val  Loss: 1.8562 | Val  Acc: 0.3767
 Site-sketch                        | Val  Loss: 1.8620 | Val  Acc: 0.3000
 Site-sketch                        | Val  Loss: 1.8652 | Val  Acc: 0.3000
Average Valid Accuracy: 0.4783
 Best site-photo                     | Epoch:0 | Val Acc: 0.6500
 Best site-photo                     | Epoch:0 | Val Acc: 0.7233
 Best site-art_painting              | Epoch:0 | Val Acc: 0.5800
 Best site-art_painting              | Epoch:0 | Val Acc: 0.5167
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.3800
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.3767
 Best site-sketch                    | Epoch:0 | Val Acc: 0.3000
 Best site-sketch                    | Epoch:0 | Val Acc: 0.3000
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 1 ============
 Site-photo                         | Train Loss: 1.6583 | Train Acc: 0.8867
 Site-photo                         | Train Loss: 1.6319 | Train Acc: 0.9067
 Site-art_painting                  | Train Loss: 1.7434 | Train Acc: 0.6333
 Site-art_painting                  | Train Loss: 1.7418 | Train Acc: 0.6667
 Site-cartoon                       | Train Loss: 1.7370 | Train Acc: 0.5200
 Site-cartoon                       | Train Loss: 1.7403 | Train Acc: 0.5044
 Site-sketch                        | Train Loss: 1.7937 | Train Acc: 0.4000
 Site-sketch                        | Train Loss: 1.7733 | Train Acc: 0.3911
Average Train Accuracy: 0.6136
 Site-photo                         | Val  Loss: 1.6320 | Val  Acc: 0.9100
 Site-photo                         | Val  Loss: 1.6302 | Val  Acc: 0.9133
 Site-art_painting                  | Val  Loss: 1.7167 | Val  Acc: 0.7100
 Site-art_painting                  | Val  Loss: 1.7371 | Val  Acc: 0.6800
 Site-cartoon                       | Val  Loss: 1.7606 | Val  Acc: 0.4400
 Site-cartoon                       | Val  Loss: 1.7576 | Val  Acc: 0.4900
 Site-sketch                        | Val  Loss: 1.7739 | Val  Acc: 0.3700
 Site-sketch                        | Val  Loss: 1.7846 | Val  Acc: 0.3833
Average Valid Accuracy: 0.6121
 Best site-photo                     | Epoch:1 | Val Acc: 0.9100
 Best site-photo                     | Epoch:1 | Val Acc: 0.9133
 Best site-art_painting              | Epoch:1 | Val Acc: 0.7100
 Best site-art_painting              | Epoch:1 | Val Acc: 0.6800
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.4400
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.4900
 Best site-sketch                    | Epoch:1 | Val Acc: 0.3700
 Best site-sketch                    | Epoch:1 | Val Acc: 0.3833
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 2 ============
 Site-photo                         | Train Loss: 1.5203 | Train Acc: 0.9667
 Site-photo                         | Train Loss: 1.4952 | Train Acc: 0.9822
 Site-art_painting                  | Train Loss: 1.6650 | Train Acc: 0.7400
 Site-art_painting                  | Train Loss: 1.6568 | Train Acc: 0.7378
 Site-cartoon                       | Train Loss: 1.6617 | Train Acc: 0.6000
 Site-cartoon                       | Train Loss: 1.6797 | Train Acc: 0.5822
 Site-sketch                        | Train Loss: 1.7419 | Train Acc: 0.4133
 Site-sketch                        | Train Loss: 1.7065 | Train Acc: 0.4267
Average Train Accuracy: 0.6811
 Site-photo                         | Val  Loss: 1.4955 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 1.5001 | Val  Acc: 0.9767
 Site-art_painting                  | Val  Loss: 1.6380 | Val  Acc: 0.7600
 Site-art_painting                  | Val  Loss: 1.6292 | Val  Acc: 0.7700
 Site-cartoon                       | Val  Loss: 1.6766 | Val  Acc: 0.5500
 Site-cartoon                       | Val  Loss: 1.6731 | Val  Acc: 0.5700
 Site-sketch                        | Val  Loss: 1.7134 | Val  Acc: 0.4500
 Site-sketch                        | Val  Loss: 1.7127 | Val  Acc: 0.4300
Average Valid Accuracy: 0.6858
 Best site-photo                     | Epoch:2 | Val Acc: 0.9800
 Best site-photo                     | Epoch:2 | Val Acc: 0.9767
 Best site-art_painting              | Epoch:2 | Val Acc: 0.7600
 Best site-art_painting              | Epoch:2 | Val Acc: 0.7700
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.5500
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.5700
 Best site-sketch                    | Epoch:2 | Val Acc: 0.4500
 Best site-sketch                    | Epoch:2 | Val Acc: 0.4300
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 3 ============
 Site-photo                         | Train Loss: 1.4003 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 1.3651 | Train Acc: 0.9800
 Site-art_painting                  | Train Loss: 1.5743 | Train Acc: 0.7200
 Site-art_painting                  | Train Loss: 1.5415 | Train Acc: 0.8044
 Site-cartoon                       | Train Loss: 1.5986 | Train Acc: 0.6400
 Site-cartoon                       | Train Loss: 1.6235 | Train Acc: 0.6489
 Site-sketch                        | Train Loss: 1.6734 | Train Acc: 0.4467
 Site-sketch                        | Train Loss: 1.6360 | Train Acc: 0.4911
Average Train Accuracy: 0.7131
 Site-photo                         | Val  Loss: 1.3793 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 1.3750 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 1.5456 | Val  Acc: 0.7900
 Site-art_painting                  | Val  Loss: 1.5522 | Val  Acc: 0.7867
 Site-cartoon                       | Val  Loss: 1.5766 | Val  Acc: 0.6100
 Site-cartoon                       | Val  Loss: 1.5940 | Val  Acc: 0.6000
 Site-sketch                        | Val  Loss: 1.6319 | Val  Acc: 0.4900
 Site-sketch                        | Val  Loss: 1.6497 | Val  Acc: 0.4533
Average Valid Accuracy: 0.7112
 Best site-photo                     | Epoch:3 | Val Acc: 0.9800
 Best site-photo                     | Epoch:3 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7900
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7867
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.6100
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.6000
 Best site-sketch                    | Epoch:3 | Val Acc: 0.4900
 Best site-sketch                    | Epoch:3 | Val Acc: 0.4533
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 4 ============
 Site-photo                         | Train Loss: 1.2888 | Train Acc: 0.9533
 Site-photo                         | Train Loss: 1.2969 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 1.5044 | Train Acc: 0.7267
 Site-art_painting                  | Train Loss: 1.4417 | Train Acc: 0.8222
 Site-cartoon                       | Train Loss: 1.5323 | Train Acc: 0.6933
 Site-cartoon                       | Train Loss: 1.4870 | Train Acc: 0.6711
 Site-sketch                        | Train Loss: 1.5912 | Train Acc: 0.4733
 Site-sketch                        | Train Loss: 1.5772 | Train Acc: 0.4911
Average Train Accuracy: 0.7269
 Site-photo                         | Val  Loss: 1.2457 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 1.2635 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 1.4715 | Val  Acc: 0.8100
 Site-art_painting                  | Val  Loss: 1.4522 | Val  Acc: 0.8233
 Site-cartoon                       | Val  Loss: 1.5150 | Val  Acc: 0.6100
 Site-cartoon                       | Val  Loss: 1.5240 | Val  Acc: 0.6133
 Site-sketch                        | Val  Loss: 1.5550 | Val  Acc: 0.4700
 Site-sketch                        | Val  Loss: 1.5922 | Val  Acc: 0.4800
Average Valid Accuracy: 0.7221
 Best site-photo                     | Epoch:4 | Val Acc: 0.9900
 Best site-photo                     | Epoch:4 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:4 | Val Acc: 0.8100
 Best site-art_painting              | Epoch:4 | Val Acc: 0.8233
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.6100
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.6133
 Best site-sketch                    | Epoch:4 | Val Acc: 0.4700
 Best site-sketch                    | Epoch:4 | Val Acc: 0.4800
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 5 ============
 Site-photo                         | Train Loss: 1.1989 | Train Acc: 0.9600
 Site-photo                         | Train Loss: 1.1415 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 1.4240 | Train Acc: 0.7133
 Site-art_painting                  | Train Loss: 1.4076 | Train Acc: 0.8089
 Site-cartoon                       | Train Loss: 1.4534 | Train Acc: 0.6800
 Site-cartoon                       | Train Loss: 1.4721 | Train Acc: 0.6978
 Site-sketch                        | Train Loss: 1.5852 | Train Acc: 0.5267
 Site-sketch                        | Train Loss: 1.5795 | Train Acc: 0.4933
Average Train Accuracy: 0.7333
 Site-photo                         | Val  Loss: 1.1265 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 1.1375 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 1.4127 | Val  Acc: 0.8300
 Site-art_painting                  | Val  Loss: 1.3844 | Val  Acc: 0.8133
 Site-cartoon                       | Val  Loss: 1.4626 | Val  Acc: 0.6600
 Site-cartoon                       | Val  Loss: 1.4510 | Val  Acc: 0.6433
 Site-sketch                        | Val  Loss: 1.4961 | Val  Acc: 0.5000
 Site-sketch                        | Val  Loss: 1.5410 | Val  Acc: 0.5100
Average Valid Accuracy: 0.7429
 Best site-photo                     | Epoch:5 | Val Acc: 0.9900
 Best site-photo                     | Epoch:5 | Val Acc: 0.9967
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8300
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8133
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.6600
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.6433
 Best site-sketch                    | Epoch:5 | Val Acc: 0.5000
 Best site-sketch                    | Epoch:5 | Val Acc: 0.5100
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 6 ============
 Site-photo                         | Train Loss: 1.0871 | Train Acc: 0.9667
 Site-photo                         | Train Loss: 1.0305 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 1.3471 | Train Acc: 0.8067
 Site-art_painting                  | Train Loss: 1.3140 | Train Acc: 0.8311
 Site-cartoon                       | Train Loss: 1.3935 | Train Acc: 0.7267
 Site-cartoon                       | Train Loss: 1.3313 | Train Acc: 0.7311
 Site-sketch                        | Train Loss: 1.5303 | Train Acc: 0.5000
 Site-sketch                        | Train Loss: 1.4625 | Train Acc: 0.5400
Average Train Accuracy: 0.7608
 Site-photo                         | Val  Loss: 1.0430 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 1.0454 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 1.3019 | Val  Acc: 0.8600
 Site-art_painting                  | Val  Loss: 1.2864 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 1.3830 | Val  Acc: 0.7000
 Site-cartoon                       | Val  Loss: 1.3773 | Val  Acc: 0.6867
 Site-sketch                        | Val  Loss: 1.4559 | Val  Acc: 0.5000
 Site-sketch                        | Val  Loss: 1.4915 | Val  Acc: 0.5233
Average Valid Accuracy: 0.7612
 Best site-photo                     | Epoch:6 | Val Acc: 0.9900
 Best site-photo                     | Epoch:6 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.7000
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.6867
 Best site-sketch                    | Epoch:6 | Val Acc: 0.5000
 Best site-sketch                    | Epoch:6 | Val Acc: 0.5233
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 7 ============
 Site-photo                         | Train Loss: 0.9918 | Train Acc: 0.9667
 Site-photo                         | Train Loss: 0.9377 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 1.2857 | Train Acc: 0.8067
 Site-art_painting                  | Train Loss: 1.2231 | Train Acc: 0.8311
 Site-cartoon                       | Train Loss: 1.3648 | Train Acc: 0.7200
 Site-cartoon                       | Train Loss: 1.2368 | Train Acc: 0.7422
 Site-sketch                        | Train Loss: 1.4499 | Train Acc: 0.5867
 Site-sketch                        | Train Loss: 1.3946 | Train Acc: 0.5533
Average Train Accuracy: 0.7742
 Site-photo                         | Val  Loss: 0.9432 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.9496 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 1.2171 | Val  Acc: 0.8200
 Site-art_painting                  | Val  Loss: 1.2409 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 1.3232 | Val  Acc: 0.7300
 Site-cartoon                       | Val  Loss: 1.3076 | Val  Acc: 0.7533
 Site-sketch                        | Val  Loss: 1.4408 | Val  Acc: 0.5300
 Site-sketch                        | Val  Loss: 1.4402 | Val  Acc: 0.5533
Average Valid Accuracy: 0.7771
 Best site-photo                     | Epoch:7 | Val Acc: 0.9900
 Best site-photo                     | Epoch:7 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8200
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8500
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.7300
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.7533
 Best site-sketch                    | Epoch:7 | Val Acc: 0.5300
 Best site-sketch                    | Epoch:7 | Val Acc: 0.5533
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 8 ============
 Site-photo                         | Train Loss: 0.9032 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.8727 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 1.1782 | Train Acc: 0.7600
 Site-art_painting                  | Train Loss: 1.1466 | Train Acc: 0.8156
 Site-cartoon                       | Train Loss: 1.2831 | Train Acc: 0.7800
 Site-cartoon                       | Train Loss: 1.2852 | Train Acc: 0.7444
 Site-sketch                        | Train Loss: 1.3833 | Train Acc: 0.6267
 Site-sketch                        | Train Loss: 1.3777 | Train Acc: 0.5733
Average Train Accuracy: 0.7828
 Site-photo                         | Val  Loss: 0.8657 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.8631 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 1.1557 | Val  Acc: 0.8700
 Site-art_painting                  | Val  Loss: 1.1712 | Val  Acc: 0.8367
 Site-cartoon                       | Val  Loss: 1.2731 | Val  Acc: 0.6900
 Site-cartoon                       | Val  Loss: 1.2563 | Val  Acc: 0.7233
 Site-sketch                        | Val  Loss: 1.3341 | Val  Acc: 0.5600
 Site-sketch                        | Val  Loss: 1.3890 | Val  Acc: 0.5833
Average Valid Accuracy: 0.7788
 Best site-photo                     | Epoch:8 | Val Acc: 0.9800
 Best site-photo                     | Epoch:8 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:8 | Val Acc: 0.8700
 Best site-art_painting              | Epoch:8 | Val Acc: 0.8367
 Best site-cartoon                   | Epoch:8 | Val Acc: 0.6900
 Best site-cartoon                   | Epoch:8 | Val Acc: 0.7233
 Best site-sketch                    | Epoch:8 | Val Acc: 0.5600
 Best site-sketch                    | Epoch:8 | Val Acc: 0.5833
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 9 ============
 Site-photo                         | Train Loss: 0.8355 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.8102 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 1.1944 | Train Acc: 0.8133
 Site-art_painting                  | Train Loss: 1.0687 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 1.2320 | Train Acc: 0.7600
 Site-cartoon                       | Train Loss: 1.1952 | Train Acc: 0.7489
 Site-sketch                        | Train Loss: 1.4033 | Train Acc: 0.6267
 Site-sketch                        | Train Loss: 1.2999 | Train Acc: 0.6178
Average Train Accuracy: 0.7956
 Site-photo                         | Val  Loss: 0.7860 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.7784 | Val  Acc: 0.9833
 Site-art_painting                  | Val  Loss: 1.1215 | Val  Acc: 0.8200
 Site-art_painting                  | Val  Loss: 1.1086 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 1.2150 | Val  Acc: 0.7100
 Site-cartoon                       | Val  Loss: 1.1899 | Val  Acc: 0.7667
 Site-sketch                        | Val  Loss: 1.3247 | Val  Acc: 0.5800
 Site-sketch                        | Val  Loss: 1.3470 | Val  Acc: 0.5833
Average Valid Accuracy: 0.7829
 Best site-photo                     | Epoch:9 | Val Acc: 0.9800
 Best site-photo                     | Epoch:9 | Val Acc: 0.9833
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8200
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.7100
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.7667
 Best site-sketch                    | Epoch:9 | Val Acc: 0.5800
 Best site-sketch                    | Epoch:9 | Val Acc: 0.5833
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 10 ============
 Site-photo                         | Train Loss: 0.7342 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.7001 | Train Acc: 0.9800
 Site-art_painting                  | Train Loss: 1.0967 | Train Acc: 0.7667
 Site-art_painting                  | Train Loss: 1.0232 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 1.1898 | Train Acc: 0.7800
 Site-cartoon                       | Train Loss: 1.1469 | Train Acc: 0.7578
 Site-sketch                        | Train Loss: 1.3323 | Train Acc: 0.6133
 Site-sketch                        | Train Loss: 1.3054 | Train Acc: 0.6244
Average Train Accuracy: 0.7928
 Site-photo                         | Val  Loss: 0.7043 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7032 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 1.0847 | Val  Acc: 0.8500
 Site-art_painting                  | Val  Loss: 1.0422 | Val  Acc: 0.8467
 Site-cartoon                       | Val  Loss: 1.1358 | Val  Acc: 0.7300
 Site-cartoon                       | Val  Loss: 1.1509 | Val  Acc: 0.7667
 Site-sketch                        | Val  Loss: 1.2554 | Val  Acc: 0.6200
 Site-sketch                        | Val  Loss: 1.3105 | Val  Acc: 0.5967
Average Valid Accuracy: 0.8000
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8500
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8467
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.7300
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.7667
 Best site-sketch                    | Epoch:10 | Val Acc: 0.6200
 Best site-sketch                    | Epoch:10 | Val Acc: 0.5967
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 11 ============
 Site-photo                         | Train Loss: 0.6865 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.6675 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 1.0552 | Train Acc: 0.8067
 Site-art_painting                  | Train Loss: 1.0304 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 1.1589 | Train Acc: 0.7733
 Site-cartoon                       | Train Loss: 1.2109 | Train Acc: 0.7867
 Site-sketch                        | Train Loss: 1.2778 | Train Acc: 0.6467
 Site-sketch                        | Train Loss: 1.2639 | Train Acc: 0.5889
Average Train Accuracy: 0.8019
 Site-photo                         | Val  Loss: 0.6482 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.6528 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.9685 | Val  Acc: 0.8600
 Site-art_painting                  | Val  Loss: 1.0099 | Val  Acc: 0.8267
 Site-cartoon                       | Val  Loss: 1.1226 | Val  Acc: 0.7300
 Site-cartoon                       | Val  Loss: 1.1059 | Val  Acc: 0.7633
 Site-sketch                        | Val  Loss: 1.2456 | Val  Acc: 0.6300
 Site-sketch                        | Val  Loss: 1.2845 | Val  Acc: 0.6033
Average Valid Accuracy: 0.7983
============ Train epoch 12 ============
 Site-photo                         | Train Loss: 0.6435 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.5978 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.9991 | Train Acc: 0.7733
 Site-art_painting                  | Train Loss: 0.9196 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 1.0481 | Train Acc: 0.7867
 Site-cartoon                       | Train Loss: 0.9938 | Train Acc: 0.8067
 Site-sketch                        | Train Loss: 1.3049 | Train Acc: 0.5933
 Site-sketch                        | Train Loss: 1.2041 | Train Acc: 0.5956
Average Train Accuracy: 0.7992
 Site-photo                         | Val  Loss: 0.5923 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.5873 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.9859 | Val  Acc: 0.8400
 Site-art_painting                  | Val  Loss: 0.9543 | Val  Acc: 0.8267
 Site-cartoon                       | Val  Loss: 1.0850 | Val  Acc: 0.6800
 Site-cartoon                       | Val  Loss: 1.0450 | Val  Acc: 0.7733
 Site-sketch                        | Val  Loss: 1.2063 | Val  Acc: 0.5800
 Site-sketch                        | Val  Loss: 1.2422 | Val  Acc: 0.5900
Average Valid Accuracy: 0.7837
============ Train epoch 13 ============
 Site-photo                         | Train Loss: 0.5564 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.5416 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.9962 | Train Acc: 0.7667
 Site-art_painting                  | Train Loss: 0.9578 | Train Acc: 0.8289
 Site-cartoon                       | Train Loss: 0.9981 | Train Acc: 0.8000
 Site-cartoon                       | Train Loss: 1.0421 | Train Acc: 0.7889
 Site-sketch                        | Train Loss: 1.2871 | Train Acc: 0.5933
 Site-sketch                        | Train Loss: 1.2338 | Train Acc: 0.6178
Average Train Accuracy: 0.7947
 Site-photo                         | Val  Loss: 0.5356 | Val  Acc: 0.9700
 Site-photo                         | Val  Loss: 0.5206 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.9169 | Val  Acc: 0.8700
 Site-art_painting                  | Val  Loss: 0.8910 | Val  Acc: 0.8433
 Site-cartoon                       | Val  Loss: 1.0315 | Val  Acc: 0.7500
 Site-cartoon                       | Val  Loss: 1.0141 | Val  Acc: 0.7900
 Site-sketch                        | Val  Loss: 1.1822 | Val  Acc: 0.6100
 Site-sketch                        | Val  Loss: 1.2296 | Val  Acc: 0.6100
Average Valid Accuracy: 0.8050
 Best site-photo                     | Epoch:13 | Val Acc: 0.9700
 Best site-photo                     | Epoch:13 | Val Acc: 0.9967
 Best site-art_painting              | Epoch:13 | Val Acc: 0.8700
 Best site-art_painting              | Epoch:13 | Val Acc: 0.8433
 Best site-cartoon                   | Epoch:13 | Val Acc: 0.7500
 Best site-cartoon                   | Epoch:13 | Val Acc: 0.7900
 Best site-sketch                    | Epoch:13 | Val Acc: 0.6100
 Best site-sketch                    | Epoch:13 | Val Acc: 0.6100
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 14 ============
 Site-photo                         | Train Loss: 0.4918 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.4467 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.9192 | Train Acc: 0.7733
 Site-art_painting                  | Train Loss: 0.8222 | Train Acc: 0.8311
 Site-cartoon                       | Train Loss: 1.0213 | Train Acc: 0.7800
 Site-cartoon                       | Train Loss: 0.9432 | Train Acc: 0.8067
 Site-sketch                        | Train Loss: 1.2659 | Train Acc: 0.6067
 Site-sketch                        | Train Loss: 1.1623 | Train Acc: 0.6467
Average Train Accuracy: 0.8031
 Site-photo                         | Val  Loss: 0.4768 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.4731 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.8777 | Val  Acc: 0.8300
 Site-art_painting                  | Val  Loss: 0.8612 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 1.0030 | Val  Acc: 0.7600
 Site-cartoon                       | Val  Loss: 0.9745 | Val  Acc: 0.8100
 Site-sketch                        | Val  Loss: 1.1803 | Val  Acc: 0.6200
 Site-sketch                        | Val  Loss: 1.2057 | Val  Acc: 0.6233
Average Valid Accuracy: 0.8075
 Best site-photo                     | Epoch:14 | Val Acc: 0.9800
 Best site-photo                     | Epoch:14 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8300
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8500
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.7600
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.8100
 Best site-sketch                    | Epoch:14 | Val Acc: 0.6200
 Best site-sketch                    | Epoch:14 | Val Acc: 0.6233
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 15 ============
 Site-photo                         | Train Loss: 0.4607 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.4236 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.9217 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.8011 | Train Acc: 0.8444
 Site-cartoon                       | Train Loss: 0.9743 | Train Acc: 0.7800
 Site-cartoon                       | Train Loss: 0.9401 | Train Acc: 0.7978
 Site-sketch                        | Train Loss: 1.1550 | Train Acc: 0.6733
 Site-sketch                        | Train Loss: 1.1940 | Train Acc: 0.6333
Average Train Accuracy: 0.8111
 Site-photo                         | Val  Loss: 0.4429 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.4283 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.8195 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.8111 | Val  Acc: 0.8567
 Site-cartoon                       | Val  Loss: 0.9421 | Val  Acc: 0.7400
 Site-cartoon                       | Val  Loss: 0.9523 | Val  Acc: 0.7833
 Site-sketch                        | Val  Loss: 1.1349 | Val  Acc: 0.5900
 Site-sketch                        | Val  Loss: 1.1529 | Val  Acc: 0.6133
Average Valid Accuracy: 0.8058
============ Train epoch 16 ============
 Site-photo                         | Train Loss: 0.4526 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.3853 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.8671 | Train Acc: 0.8133
 Site-art_painting                  | Train Loss: 0.8665 | Train Acc: 0.8644
 Site-cartoon                       | Train Loss: 0.9255 | Train Acc: 0.7800
 Site-cartoon                       | Train Loss: 0.8469 | Train Acc: 0.8089
 Site-sketch                        | Train Loss: 1.1965 | Train Acc: 0.6533
 Site-sketch                        | Train Loss: 1.1290 | Train Acc: 0.6578
Average Train Accuracy: 0.8186
 Site-photo                         | Val  Loss: 0.4028 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.3951 | Val  Acc: 0.9833
 Site-art_painting                  | Val  Loss: 0.7906 | Val  Acc: 0.8600
 Site-art_painting                  | Val  Loss: 0.7860 | Val  Acc: 0.8667
 Site-cartoon                       | Val  Loss: 0.9314 | Val  Acc: 0.7500
 Site-cartoon                       | Val  Loss: 0.8861 | Val  Acc: 0.8000
 Site-sketch                        | Val  Loss: 1.0494 | Val  Acc: 0.6600
 Site-sketch                        | Val  Loss: 1.1512 | Val  Acc: 0.6500
Average Valid Accuracy: 0.8188
 Best site-photo                     | Epoch:16 | Val Acc: 0.9800
 Best site-photo                     | Epoch:16 | Val Acc: 0.9833
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8667
 Best site-cartoon                   | Epoch:16 | Val Acc: 0.7500
 Best site-cartoon                   | Epoch:16 | Val Acc: 0.8000
 Best site-sketch                    | Epoch:16 | Val Acc: 0.6600
 Best site-sketch                    | Epoch:16 | Val Acc: 0.6500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 17 ============
 Site-photo                         | Train Loss: 0.4045 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.4041 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.9077 | Train Acc: 0.7867
 Site-art_painting                  | Train Loss: 0.7273 | Train Acc: 0.8578
 Site-cartoon                       | Train Loss: 0.9553 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.8116 | Train Acc: 0.8133
 Site-sketch                        | Train Loss: 1.1831 | Train Acc: 0.6400
 Site-sketch                        | Train Loss: 1.2197 | Train Acc: 0.6533
Average Train Accuracy: 0.8172
 Site-photo                         | Val  Loss: 0.3787 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.3593 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.7637 | Val  Acc: 0.8600
 Site-art_painting                  | Val  Loss: 0.7451 | Val  Acc: 0.8667
 Site-cartoon                       | Val  Loss: 0.8890 | Val  Acc: 0.7500
 Site-cartoon                       | Val  Loss: 0.9007 | Val  Acc: 0.8233
 Site-sketch                        | Val  Loss: 1.0274 | Val  Acc: 0.6300
 Site-sketch                        | Val  Loss: 1.1210 | Val  Acc: 0.6467
Average Valid Accuracy: 0.8196
 Best site-photo                     | Epoch:17 | Val Acc: 0.9900
 Best site-photo                     | Epoch:17 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8667
 Best site-cartoon                   | Epoch:17 | Val Acc: 0.7500
 Best site-cartoon                   | Epoch:17 | Val Acc: 0.8233
 Best site-sketch                    | Epoch:17 | Val Acc: 0.6300
 Best site-sketch                    | Epoch:17 | Val Acc: 0.6467
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 18 ============
 Site-photo                         | Train Loss: 0.3673 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.3281 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.8359 | Train Acc: 0.8267
 Site-art_painting                  | Train Loss: 0.8110 | Train Acc: 0.8778
 Site-cartoon                       | Train Loss: 0.8784 | Train Acc: 0.7933
 Site-cartoon                       | Train Loss: 0.8198 | Train Acc: 0.8067
 Site-sketch                        | Train Loss: 1.1616 | Train Acc: 0.6067
 Site-sketch                        | Train Loss: 1.0393 | Train Acc: 0.6622
Average Train Accuracy: 0.8183
 Site-photo                         | Val  Loss: 0.3314 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3250 | Val  Acc: 0.9833
 Site-art_painting                  | Val  Loss: 0.7690 | Val  Acc: 0.8500
 Site-art_painting                  | Val  Loss: 0.7293 | Val  Acc: 0.8667
 Site-cartoon                       | Val  Loss: 0.8488 | Val  Acc: 0.7900
 Site-cartoon                       | Val  Loss: 0.8397 | Val  Acc: 0.8133
 Site-sketch                        | Val  Loss: 1.0170 | Val  Acc: 0.6500
 Site-sketch                        | Val  Loss: 1.0901 | Val  Acc: 0.6467
Average Valid Accuracy: 0.8250
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-photo                     | Epoch:18 | Val Acc: 0.9833
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8500
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8667
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.7900
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.8133
 Best site-sketch                    | Epoch:18 | Val Acc: 0.6500
 Best site-sketch                    | Epoch:18 | Val Acc: 0.6467
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 19 ============
 Site-photo                         | Train Loss: 0.3461 | Train Acc: 0.9667
 Site-photo                         | Train Loss: 0.3504 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 0.7764 | Train Acc: 0.8267
 Site-art_painting                  | Train Loss: 0.6513 | Train Acc: 0.8578
 Site-cartoon                       | Train Loss: 0.8113 | Train Acc: 0.8200
 Site-cartoon                       | Train Loss: 0.7966 | Train Acc: 0.8089
 Site-sketch                        | Train Loss: 1.1136 | Train Acc: 0.6933
 Site-sketch                        | Train Loss: 1.0490 | Train Acc: 0.6711
Average Train Accuracy: 0.8286
 Site-photo                         | Val  Loss: 0.2942 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.2943 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.7424 | Val  Acc: 0.8800
 Site-art_painting                  | Val  Loss: 0.7116 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 0.8354 | Val  Acc: 0.8300
 Site-cartoon                       | Val  Loss: 0.8478 | Val  Acc: 0.8000
 Site-sketch                        | Val  Loss: 1.0383 | Val  Acc: 0.6500
 Site-sketch                        | Val  Loss: 1.0611 | Val  Acc: 0.6867
Average Valid Accuracy: 0.8350
 Best site-photo                     | Epoch:19 | Val Acc: 0.9900
 Best site-photo                     | Epoch:19 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:19 | Val Acc: 0.8800
 Best site-art_painting              | Epoch:19 | Val Acc: 0.8500
 Best site-cartoon                   | Epoch:19 | Val Acc: 0.8300
 Best site-cartoon                   | Epoch:19 | Val Acc: 0.8000
 Best site-sketch                    | Epoch:19 | Val Acc: 0.6500
 Best site-sketch                    | Epoch:19 | Val Acc: 0.6867
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 20 ============
 Site-photo                         | Train Loss: 0.3255 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.2593 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.7665 | Train Acc: 0.8267
 Site-art_painting                  | Train Loss: 0.7012 | Train Acc: 0.8489
 Site-cartoon                       | Train Loss: 0.8250 | Train Acc: 0.8067
 Site-cartoon                       | Train Loss: 0.8066 | Train Acc: 0.8200
 Site-sketch                        | Train Loss: 1.1082 | Train Acc: 0.6733
 Site-sketch                        | Train Loss: 1.0723 | Train Acc: 0.6311
Average Train Accuracy: 0.8225
 Site-photo                         | Val  Loss: 0.2842 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.2703 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.6859 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.6835 | Val  Acc: 0.8767
 Site-cartoon                       | Val  Loss: 0.8401 | Val  Acc: 0.7700
 Site-cartoon                       | Val  Loss: 0.7874 | Val  Acc: 0.8200
 Site-sketch                        | Val  Loss: 0.9983 | Val  Acc: 0.6700
 Site-sketch                        | Val  Loss: 1.0785 | Val  Acc: 0.6333
Average Valid Accuracy: 0.8287
============ Train epoch 21 ============
 Site-photo                         | Train Loss: 0.2779 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.2458 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.7723 | Train Acc: 0.7867
 Site-art_painting                  | Train Loss: 0.6830 | Train Acc: 0.8622
 Site-cartoon                       | Train Loss: 0.8228 | Train Acc: 0.8200
 Site-cartoon                       | Train Loss: 0.7375 | Train Acc: 0.8111
 Site-sketch                        | Train Loss: 1.0893 | Train Acc: 0.6733
 Site-sketch                        | Train Loss: 1.1255 | Train Acc: 0.6578
Average Train Accuracy: 0.8239
 Site-photo                         | Val  Loss: 0.2570 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2563 | Val  Acc: 0.9833
 Site-art_painting                  | Val  Loss: 0.6510 | Val  Acc: 0.8800
 Site-art_painting                  | Val  Loss: 0.6330 | Val  Acc: 0.8667
 Site-cartoon                       | Val  Loss: 0.8220 | Val  Acc: 0.7700
 Site-cartoon                       | Val  Loss: 0.7975 | Val  Acc: 0.8033
 Site-sketch                        | Val  Loss: 0.9923 | Val  Acc: 0.6700
 Site-sketch                        | Val  Loss: 1.0534 | Val  Acc: 0.6533
Average Valid Accuracy: 0.8283
============ Train epoch 22 ============
 Site-photo                         | Train Loss: 0.2928 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.2247 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.6487 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.7074 | Train Acc: 0.8556
 Site-cartoon                       | Train Loss: 0.8326 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.7443 | Train Acc: 0.8356
 Site-sketch                        | Train Loss: 1.0034 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 1.0625 | Train Acc: 0.6333
Average Train Accuracy: 0.8314
 Site-photo                         | Val  Loss: 0.2283 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.2386 | Val  Acc: 0.9833
 Site-art_painting                  | Val  Loss: 0.6016 | Val  Acc: 0.8800
 Site-art_painting                  | Val  Loss: 0.6200 | Val  Acc: 0.8800
 Site-cartoon                       | Val  Loss: 0.7789 | Val  Acc: 0.8000
 Site-cartoon                       | Val  Loss: 0.7665 | Val  Acc: 0.8300
 Site-sketch                        | Val  Loss: 0.9854 | Val  Acc: 0.6500
 Site-sketch                        | Val  Loss: 1.0135 | Val  Acc: 0.6367
Average Valid Accuracy: 0.8313
============ Train epoch 23 ============
 Site-photo                         | Train Loss: 0.2740 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.2076 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.7382 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.5839 | Train Acc: 0.8711
 Site-cartoon                       | Train Loss: 0.7923 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.7783 | Train Acc: 0.8289
 Site-sketch                        | Train Loss: 1.0183 | Train Acc: 0.6800
 Site-sketch                        | Train Loss: 0.9538 | Train Acc: 0.7000
Average Train Accuracy: 0.8364
 Site-photo                         | Val  Loss: 0.2129 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.2087 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.5996 | Val  Acc: 0.9100
 Site-art_painting                  | Val  Loss: 0.5880 | Val  Acc: 0.8733
 Site-cartoon                       | Val  Loss: 0.7584 | Val  Acc: 0.7900
 Site-cartoon                       | Val  Loss: 0.7438 | Val  Acc: 0.8033
 Site-sketch                        | Val  Loss: 0.8853 | Val  Acc: 0.6900
 Site-sketch                        | Val  Loss: 1.0218 | Val  Acc: 0.6600
Average Valid Accuracy: 0.8379
 Best site-photo                     | Epoch:23 | Val Acc: 0.9800
 Best site-photo                     | Epoch:23 | Val Acc: 0.9967
 Best site-art_painting              | Epoch:23 | Val Acc: 0.9100
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8733
 Best site-cartoon                   | Epoch:23 | Val Acc: 0.7900
 Best site-cartoon                   | Epoch:23 | Val Acc: 0.8033
 Best site-sketch                    | Epoch:23 | Val Acc: 0.6900
 Best site-sketch                    | Epoch:23 | Val Acc: 0.6600
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 24 ============
 Site-photo                         | Train Loss: 0.2397 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.2010 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.7187 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.5833 | Train Acc: 0.8689
 Site-cartoon                       | Train Loss: 0.7644 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.7853 | Train Acc: 0.8489
 Site-sketch                        | Train Loss: 1.0137 | Train Acc: 0.7333
 Site-sketch                        | Train Loss: 1.0009 | Train Acc: 0.7044
Average Train Accuracy: 0.8467
 Site-photo                         | Val  Loss: 0.2035 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.2136 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.5519 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.6033 | Val  Acc: 0.8667
 Site-cartoon                       | Val  Loss: 0.7289 | Val  Acc: 0.7800
 Site-cartoon                       | Val  Loss: 0.7163 | Val  Acc: 0.8367
 Site-sketch                        | Val  Loss: 0.9473 | Val  Acc: 0.6300
 Site-sketch                        | Val  Loss: 0.9733 | Val  Acc: 0.7167
Average Valid Accuracy: 0.8375
============ Train epoch 25 ============
 Site-photo                         | Train Loss: 0.2107 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.1887 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.6865 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.5329 | Train Acc: 0.8756
 Site-cartoon                       | Train Loss: 0.7885 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.6734 | Train Acc: 0.8489
 Site-sketch                        | Train Loss: 0.9917 | Train Acc: 0.6867
 Site-sketch                        | Train Loss: 0.9570 | Train Acc: 0.6911
Average Train Accuracy: 0.8439
 Site-photo                         | Val  Loss: 0.1807 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1912 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.5682 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.5623 | Val  Acc: 0.8700
 Site-cartoon                       | Val  Loss: 0.7412 | Val  Acc: 0.7900
 Site-cartoon                       | Val  Loss: 0.7055 | Val  Acc: 0.8267
 Site-sketch                        | Val  Loss: 0.9102 | Val  Acc: 0.7000
 Site-sketch                        | Val  Loss: 0.9753 | Val  Acc: 0.6800
Average Valid Accuracy: 0.8438
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8900
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8700
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.7900
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.8267
 Best site-sketch                    | Epoch:25 | Val Acc: 0.7000
 Best site-sketch                    | Epoch:25 | Val Acc: 0.6800
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 26 ============
 Site-photo                         | Train Loss: 0.2443 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.1892 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.6783 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.6445 | Train Acc: 0.8756
 Site-cartoon                       | Train Loss: 0.7896 | Train Acc: 0.8000
 Site-cartoon                       | Train Loss: 0.6980 | Train Acc: 0.8422
 Site-sketch                        | Train Loss: 1.0262 | Train Acc: 0.7333
 Site-sketch                        | Train Loss: 1.0014 | Train Acc: 0.6600
Average Train Accuracy: 0.8403
 Site-photo                         | Val  Loss: 0.1685 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.1776 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.5103 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.5764 | Val  Acc: 0.8700
 Site-cartoon                       | Val  Loss: 0.7074 | Val  Acc: 0.8300
 Site-cartoon                       | Val  Loss: 0.7046 | Val  Acc: 0.8467
 Site-sketch                        | Val  Loss: 0.9218 | Val  Acc: 0.7300
 Site-sketch                        | Val  Loss: 0.9522 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8558
 Best site-photo                     | Epoch:26 | Val Acc: 0.9900
 Best site-photo                     | Epoch:26 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:26 | Val Acc: 0.8900
 Best site-art_painting              | Epoch:26 | Val Acc: 0.8700
 Best site-cartoon                   | Epoch:26 | Val Acc: 0.8300
 Best site-cartoon                   | Epoch:26 | Val Acc: 0.8467
 Best site-sketch                    | Epoch:26 | Val Acc: 0.7300
 Best site-sketch                    | Epoch:26 | Val Acc: 0.7000
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 27 ============
 Site-photo                         | Train Loss: 0.2121 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.2068 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.6228 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.5446 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.7735 | Train Acc: 0.7733
 Site-cartoon                       | Train Loss: 0.6340 | Train Acc: 0.8667
 Site-sketch                        | Train Loss: 0.9926 | Train Acc: 0.6800
 Site-sketch                        | Train Loss: 0.9715 | Train Acc: 0.7067
Average Train Accuracy: 0.8406
 Site-photo                         | Val  Loss: 0.1369 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1599 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.5218 | Val  Acc: 0.8800
 Site-art_painting                  | Val  Loss: 0.5541 | Val  Acc: 0.8733
 Site-cartoon                       | Val  Loss: 0.6688 | Val  Acc: 0.8200
 Site-cartoon                       | Val  Loss: 0.6981 | Val  Acc: 0.8467
 Site-sketch                        | Val  Loss: 0.8809 | Val  Acc: 0.7100
 Site-sketch                        | Val  Loss: 0.9639 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8487
============ Train epoch 28 ============
 Site-photo                         | Train Loss: 0.1929 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.1438 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.6171 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.5010 | Train Acc: 0.8889
 Site-cartoon                       | Train Loss: 0.7382 | Train Acc: 0.8067
 Site-cartoon                       | Train Loss: 0.6106 | Train Acc: 0.8644
 Site-sketch                        | Train Loss: 0.9532 | Train Acc: 0.7133
 Site-sketch                        | Train Loss: 1.0002 | Train Acc: 0.6867
Average Train Accuracy: 0.8475
 Site-photo                         | Val  Loss: 0.1509 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1577 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.4860 | Val  Acc: 0.9000
 Site-art_painting                  | Val  Loss: 0.5071 | Val  Acc: 0.8867
 Site-cartoon                       | Val  Loss: 0.6401 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 0.6603 | Val  Acc: 0.8500
 Site-sketch                        | Val  Loss: 0.8635 | Val  Acc: 0.7300
 Site-sketch                        | Val  Loss: 0.9217 | Val  Acc: 0.7200
Average Valid Accuracy: 0.8658
 Best site-photo                     | Epoch:28 | Val Acc: 1.0000
 Best site-photo                     | Epoch:28 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:28 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:28 | Val Acc: 0.8867
 Best site-cartoon                   | Epoch:28 | Val Acc: 0.8500
 Best site-cartoon                   | Epoch:28 | Val Acc: 0.8500
 Best site-sketch                    | Epoch:28 | Val Acc: 0.7300
 Best site-sketch                    | Epoch:28 | Val Acc: 0.7200
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 29 ============
 Site-photo                         | Train Loss: 0.1778 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.1368 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.6390 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.4699 | Train Acc: 0.8756
 Site-cartoon                       | Train Loss: 0.7653 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.5777 | Train Acc: 0.8533
 Site-sketch                        | Train Loss: 0.9377 | Train Acc: 0.7267
 Site-sketch                        | Train Loss: 0.9156 | Train Acc: 0.6800
Average Train Accuracy: 0.8486
 Site-photo                         | Val  Loss: 0.1406 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.1518 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.4842 | Val  Acc: 0.9100
 Site-art_painting                  | Val  Loss: 0.5111 | Val  Acc: 0.8700
 Site-cartoon                       | Val  Loss: 0.6983 | Val  Acc: 0.8200
 Site-cartoon                       | Val  Loss: 0.6639 | Val  Acc: 0.8233
 Site-sketch                        | Val  Loss: 0.8177 | Val  Acc: 0.7300
 Site-sketch                        | Val  Loss: 0.9084 | Val  Acc: 0.6967
Average Valid Accuracy: 0.8538
============ Train epoch 30 ============
 Site-photo                         | Train Loss: 0.1874 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.1260 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.6390 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.4988 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.6525 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.5738 | Train Acc: 0.8556
 Site-sketch                        | Train Loss: 1.0028 | Train Acc: 0.6333
 Site-sketch                        | Train Loss: 0.8471 | Train Acc: 0.7156
Average Train Accuracy: 0.8414
 Site-photo                         | Val  Loss: 0.1290 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.1302 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.4560 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.4985 | Val  Acc: 0.8833
 Site-cartoon                       | Val  Loss: 0.6870 | Val  Acc: 0.8300
 Site-cartoon                       | Val  Loss: 0.6467 | Val  Acc: 0.8567
 Site-sketch                        | Val  Loss: 0.8579 | Val  Acc: 0.7700
 Site-sketch                        | Val  Loss: 0.9056 | Val  Acc: 0.6900
Average Valid Accuracy: 0.8683
 Best site-photo                     | Epoch:30 | Val Acc: 0.9900
 Best site-photo                     | Epoch:30 | Val Acc: 0.9967
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9300
 Best site-art_painting              | Epoch:30 | Val Acc: 0.8833
 Best site-cartoon                   | Epoch:30 | Val Acc: 0.8300
 Best site-cartoon                   | Epoch:30 | Val Acc: 0.8567
 Best site-sketch                    | Epoch:30 | Val Acc: 0.7700
 Best site-sketch                    | Epoch:30 | Val Acc: 0.6900
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 31 ============
 Site-photo                         | Train Loss: 0.1706 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.1239 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.6213 | Train Acc: 0.8133
 Site-art_painting                  | Train Loss: 0.5630 | Train Acc: 0.8844
 Site-cartoon                       | Train Loss: 0.7370 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.5841 | Train Acc: 0.8578
 Site-sketch                        | Train Loss: 0.9337 | Train Acc: 0.7000
 Site-sketch                        | Train Loss: 0.8441 | Train Acc: 0.7200
Average Train Accuracy: 0.8481
 Site-photo                         | Val  Loss: 0.1530 | Val  Acc: 0.9700
 Site-photo                         | Val  Loss: 0.1272 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.4445 | Val  Acc: 0.9200
 Site-art_painting                  | Val  Loss: 0.5064 | Val  Acc: 0.8767
 Site-cartoon                       | Val  Loss: 0.6598 | Val  Acc: 0.8200
 Site-cartoon                       | Val  Loss: 0.6339 | Val  Acc: 0.8467
 Site-sketch                        | Val  Loss: 0.8308 | Val  Acc: 0.7400
 Site-sketch                        | Val  Loss: 0.9149 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8575
============ Train epoch 32 ============
 Site-photo                         | Train Loss: 0.1390 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.1065 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.5447 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.5588 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.6376 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.5925 | Train Acc: 0.8689
 Site-sketch                        | Train Loss: 0.8772 | Train Acc: 0.6800
 Site-sketch                        | Train Loss: 0.8744 | Train Acc: 0.7200
Average Train Accuracy: 0.8539
 Site-photo                         | Val  Loss: 0.1186 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.1203 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4128 | Val  Acc: 0.9200
 Site-art_painting                  | Val  Loss: 0.4962 | Val  Acc: 0.8867
 Site-cartoon                       | Val  Loss: 0.6571 | Val  Acc: 0.8100
 Site-cartoon                       | Val  Loss: 0.6434 | Val  Acc: 0.8433
 Site-sketch                        | Val  Loss: 0.8539 | Val  Acc: 0.7400
 Site-sketch                        | Val  Loss: 0.8697 | Val  Acc: 0.7133
Average Valid Accuracy: 0.8621
============ Train epoch 33 ============
 Site-photo                         | Train Loss: 0.1584 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.1149 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.6083 | Train Acc: 0.8133
 Site-art_painting                  | Train Loss: 0.5107 | Train Acc: 0.8911
 Site-cartoon                       | Train Loss: 0.6180 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.5861 | Train Acc: 0.8778
 Site-sketch                        | Train Loss: 0.9012 | Train Acc: 0.7000
 Site-sketch                        | Train Loss: 0.8861 | Train Acc: 0.7089
Average Train Accuracy: 0.8517
 Site-photo                         | Val  Loss: 0.1102 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1197 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.4727 | Val  Acc: 0.9100
 Site-art_painting                  | Val  Loss: 0.4458 | Val  Acc: 0.8967
 Site-cartoon                       | Val  Loss: 0.6264 | Val  Acc: 0.8100
 Site-cartoon                       | Val  Loss: 0.6117 | Val  Acc: 0.8400
 Site-sketch                        | Val  Loss: 0.8222 | Val  Acc: 0.7100
 Site-sketch                        | Val  Loss: 0.8713 | Val  Acc: 0.7300
Average Valid Accuracy: 0.8608
============ Train epoch 34 ============
 Site-photo                         | Train Loss: 0.1387 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.1049 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.5333 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.4789 | Train Acc: 0.8956
 Site-cartoon                       | Train Loss: 0.6494 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.6614 | Train Acc: 0.8711
 Site-sketch                        | Train Loss: 0.8990 | Train Acc: 0.7267
 Site-sketch                        | Train Loss: 0.8796 | Train Acc: 0.7156
Average Train Accuracy: 0.8628
 Site-photo                         | Val  Loss: 0.1379 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.1066 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4382 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.4475 | Val  Acc: 0.8967
 Site-cartoon                       | Val  Loss: 0.6436 | Val  Acc: 0.8000
 Site-cartoon                       | Val  Loss: 0.6078 | Val  Acc: 0.8333
 Site-sketch                        | Val  Loss: 0.8271 | Val  Acc: 0.7600
 Site-sketch                        | Val  Loss: 0.8693 | Val  Acc: 0.7367
Average Valid Accuracy: 0.8625
============ Train epoch 35 ============
 Site-photo                         | Train Loss: 0.1348 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.1038 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.5381 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.5120 | Train Acc: 0.8978
 Site-cartoon                       | Train Loss: 0.6068 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.6041 | Train Acc: 0.8800
 Site-sketch                        | Train Loss: 0.8819 | Train Acc: 0.6867
 Site-sketch                        | Train Loss: 0.8117 | Train Acc: 0.7289
Average Train Accuracy: 0.8583
 Site-photo                         | Val  Loss: 0.0996 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0963 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4432 | Val  Acc: 0.9500
 Site-art_painting                  | Val  Loss: 0.4588 | Val  Acc: 0.8900
 Site-cartoon                       | Val  Loss: 0.6006 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 0.6146 | Val  Acc: 0.8300
 Site-sketch                        | Val  Loss: 0.8527 | Val  Acc: 0.6700
 Site-sketch                        | Val  Loss: 0.8734 | Val  Acc: 0.7200
Average Valid Accuracy: 0.8617
============ Train epoch 36 ============
 Site-photo                         | Train Loss: 0.1185 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.1018 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.4780 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.4396 | Train Acc: 0.8867
 Site-cartoon                       | Train Loss: 0.6424 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.4910 | Train Acc: 0.8756
 Site-sketch                        | Train Loss: 0.8724 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.8333 | Train Acc: 0.7200
Average Train Accuracy: 0.8561
 Site-photo                         | Val  Loss: 0.1074 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0988 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4080 | Val  Acc: 0.9200
 Site-art_painting                  | Val  Loss: 0.4374 | Val  Acc: 0.8933
 Site-cartoon                       | Val  Loss: 0.6140 | Val  Acc: 0.8200
 Site-cartoon                       | Val  Loss: 0.5875 | Val  Acc: 0.8467
 Site-sketch                        | Val  Loss: 0.8105 | Val  Acc: 0.7200
 Site-sketch                        | Val  Loss: 0.8571 | Val  Acc: 0.7367
Average Valid Accuracy: 0.8662
============ Train epoch 37 ============
 Site-photo                         | Train Loss: 0.1176 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0737 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.5249 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.3830 | Train Acc: 0.9022
 Site-cartoon                       | Train Loss: 0.5941 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.4852 | Train Acc: 0.8689
 Site-sketch                        | Train Loss: 0.9088 | Train Acc: 0.7200
 Site-sketch                        | Train Loss: 0.8467 | Train Acc: 0.7289
Average Train Accuracy: 0.8653
 Site-photo                         | Val  Loss: 0.0772 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0899 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4279 | Val  Acc: 0.9100
 Site-art_painting                  | Val  Loss: 0.4312 | Val  Acc: 0.8867
 Site-cartoon                       | Val  Loss: 0.5678 | Val  Acc: 0.8200
 Site-cartoon                       | Val  Loss: 0.5700 | Val  Acc: 0.8667
 Site-sketch                        | Val  Loss: 0.7803 | Val  Acc: 0.7200
 Site-sketch                        | Val  Loss: 0.8523 | Val  Acc: 0.7267
Average Valid Accuracy: 0.8654
============ Train epoch 38 ============
 Site-photo                         | Train Loss: 0.1417 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0858 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.5125 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.4545 | Train Acc: 0.8822
 Site-cartoon                       | Train Loss: 0.6217 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.5085 | Train Acc: 0.8733
 Site-sketch                        | Train Loss: 0.9610 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.8245 | Train Acc: 0.7200
Average Train Accuracy: 0.8539
 Site-photo                         | Val  Loss: 0.0914 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0901 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4498 | Val  Acc: 0.8800
 Site-art_painting                  | Val  Loss: 0.4257 | Val  Acc: 0.9067
 Site-cartoon                       | Val  Loss: 0.5803 | Val  Acc: 0.8300
 Site-cartoon                       | Val  Loss: 0.5645 | Val  Acc: 0.8533
 Site-sketch                        | Val  Loss: 0.8050 | Val  Acc: 0.6600
 Site-sketch                        | Val  Loss: 0.8386 | Val  Acc: 0.7333
Average Valid Accuracy: 0.8558
============ Train epoch 39 ============
 Site-photo                         | Train Loss: 0.1176 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0848 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.4772 | Train Acc: 0.8533
 Site-art_painting                  | Train Loss: 0.3791 | Train Acc: 0.8956
 Site-cartoon                       | Train Loss: 0.6578 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.5260 | Train Acc: 0.8578
 Site-sketch                        | Train Loss: 0.9015 | Train Acc: 0.7200
 Site-sketch                        | Train Loss: 0.8709 | Train Acc: 0.7267
Average Train Accuracy: 0.8553
 Site-photo                         | Val  Loss: 0.0887 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0876 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4178 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.4233 | Val  Acc: 0.8933
 Site-cartoon                       | Val  Loss: 0.5639 | Val  Acc: 0.8100
 Site-cartoon                       | Val  Loss: 0.5490 | Val  Acc: 0.8833
 Site-sketch                        | Val  Loss: 0.7652 | Val  Acc: 0.7200
 Site-sketch                        | Val  Loss: 0.8355 | Val  Acc: 0.7533
Average Valid Accuracy: 0.8679
============ Train epoch 40 ============
 Site-photo                         | Train Loss: 0.1087 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0763 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.4639 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.3898 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.5873 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.6708 | Train Acc: 0.8778
 Site-sketch                        | Train Loss: 0.9007 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.7985 | Train Acc: 0.7356
Average Train Accuracy: 0.8592
 Site-photo                         | Val  Loss: 0.0814 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0750 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.3745 | Val  Acc: 0.9500
 Site-art_painting                  | Val  Loss: 0.4009 | Val  Acc: 0.9133
 Site-cartoon                       | Val  Loss: 0.5466 | Val  Acc: 0.8300
 Site-cartoon                       | Val  Loss: 0.5713 | Val  Acc: 0.8567
 Site-sketch                        | Val  Loss: 0.7699 | Val  Acc: 0.7200
 Site-sketch                        | Val  Loss: 0.8430 | Val  Acc: 0.7067
Average Valid Accuracy: 0.8717
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 0.9967
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9500
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9133
 Best site-cartoon                   | Epoch:40 | Val Acc: 0.8300
 Best site-cartoon                   | Epoch:40 | Val Acc: 0.8567
 Best site-sketch                    | Epoch:40 | Val Acc: 0.7200
 Best site-sketch                    | Epoch:40 | Val Acc: 0.7067
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 41 ============
 Site-photo                         | Train Loss: 0.1046 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0657 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.4469 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.4239 | Train Acc: 0.9022
 Site-cartoon                       | Train Loss: 0.5831 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.5011 | Train Acc: 0.8733
 Site-sketch                        | Train Loss: 0.8453 | Train Acc: 0.6867
 Site-sketch                        | Train Loss: 0.7702 | Train Acc: 0.7311
Average Train Accuracy: 0.8633
 Site-photo                         | Val  Loss: 0.0645 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0911 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.3661 | Val  Acc: 0.9100
 Site-art_painting                  | Val  Loss: 0.3494 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.5663 | Val  Acc: 0.8100
 Site-cartoon                       | Val  Loss: 0.5236 | Val  Acc: 0.8833
 Site-sketch                        | Val  Loss: 0.7905 | Val  Acc: 0.7500
 Site-sketch                        | Val  Loss: 0.8281 | Val  Acc: 0.7600
Average Valid Accuracy: 0.8788
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-photo                     | Epoch:41 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:41 | Val Acc: 0.9100
 Best site-art_painting              | Epoch:41 | Val Acc: 0.9300
 Best site-cartoon                   | Epoch:41 | Val Acc: 0.8100
 Best site-cartoon                   | Epoch:41 | Val Acc: 0.8833
 Best site-sketch                    | Epoch:41 | Val Acc: 0.7500
 Best site-sketch                    | Epoch:41 | Val Acc: 0.7600
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 42 ============
 Site-photo                         | Train Loss: 0.1170 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.0629 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.5451 | Train Acc: 0.8133
 Site-art_painting                  | Train Loss: 0.3649 | Train Acc: 0.8978
 Site-cartoon                       | Train Loss: 0.5638 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.4799 | Train Acc: 0.8711
 Site-sketch                        | Train Loss: 0.8277 | Train Acc: 0.7333
 Site-sketch                        | Train Loss: 0.8377 | Train Acc: 0.7178
Average Train Accuracy: 0.8553
 Site-photo                         | Val  Loss: 0.0600 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0766 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.3733 | Val  Acc: 0.9200
 Site-art_painting                  | Val  Loss: 0.4182 | Val  Acc: 0.9067
 Site-cartoon                       | Val  Loss: 0.5340 | Val  Acc: 0.8600
 Site-cartoon                       | Val  Loss: 0.5504 | Val  Acc: 0.8433
 Site-sketch                        | Val  Loss: 0.7377 | Val  Acc: 0.7800
 Site-sketch                        | Val  Loss: 0.8126 | Val  Acc: 0.7433
Average Valid Accuracy: 0.8804
 Best site-photo                     | Epoch:42 | Val Acc: 1.0000
 Best site-photo                     | Epoch:42 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:42 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:42 | Val Acc: 0.9067
 Best site-cartoon                   | Epoch:42 | Val Acc: 0.8600
 Best site-cartoon                   | Epoch:42 | Val Acc: 0.8433
 Best site-sketch                    | Epoch:42 | Val Acc: 0.7800
 Best site-sketch                    | Epoch:42 | Val Acc: 0.7433
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
============ Train epoch 43 ============
 Site-photo                         | Train Loss: 0.1166 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0640 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.4650 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.4623 | Train Acc: 0.8911
 Site-cartoon                       | Train Loss: 0.6249 | Train Acc: 0.8000
 Site-cartoon                       | Train Loss: 0.4960 | Train Acc: 0.8689
 Site-sketch                        | Train Loss: 0.7738 | Train Acc: 0.7333
 Site-sketch                        | Train Loss: 0.7291 | Train Acc: 0.7578
Average Train Accuracy: 0.8597
 Site-photo                         | Val  Loss: 0.0701 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0664 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.3776 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.3772 | Val  Acc: 0.9067
 Site-cartoon                       | Val  Loss: 0.5485 | Val  Acc: 0.8600
 Site-cartoon                       | Val  Loss: 0.5232 | Val  Acc: 0.8667
 Site-sketch                        | Val  Loss: 0.7773 | Val  Acc: 0.7400
 Site-sketch                        | Val  Loss: 0.7847 | Val  Acc: 0.7500
Average Valid Accuracy: 0.8762
============ Train epoch 44 ============
 Site-photo                         | Train Loss: 0.1079 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.0696 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5046 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.3981 | Train Acc: 0.8978
 Site-cartoon                       | Train Loss: 0.6229 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.4849 | Train Acc: 0.8689
 Site-sketch                        | Train Loss: 0.8616 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 0.7616 | Train Acc: 0.7333
Average Train Accuracy: 0.8656
 Site-photo                         | Val  Loss: 0.0599 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0649 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.3311 | Val  Acc: 0.9400
 Site-art_painting                  | Val  Loss: 0.3742 | Val  Acc: 0.9033
 Site-cartoon                       | Val  Loss: 0.5342 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 0.5284 | Val  Acc: 0.8600
 Site-sketch                        | Val  Loss: 0.7594 | Val  Acc: 0.7400
 Site-sketch                        | Val  Loss: 0.8119 | Val  Acc: 0.7300
Average Valid Accuracy: 0.8767
============ Train epoch 45 ============
 Site-photo                         | Train Loss: 0.1616 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0552 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4840 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.4121 | Train Acc: 0.9067
 Site-cartoon                       | Train Loss: 0.5326 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.4782 | Train Acc: 0.8867
 Site-sketch                        | Train Loss: 0.8849 | Train Acc: 0.7267
 Site-sketch                        | Train Loss: 0.7866 | Train Acc: 0.7378
Average Train Accuracy: 0.8650
 Site-photo                         | Val  Loss: 0.0753 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0558 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.3460 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.3742 | Val  Acc: 0.9000
 Site-cartoon                       | Val  Loss: 0.5235 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 0.5283 | Val  Acc: 0.8500
 Site-sketch                        | Val  Loss: 0.7527 | Val  Acc: 0.7500
 Site-sketch                        | Val  Loss: 0.8075 | Val  Acc: 0.7400
Average Valid Accuracy: 0.8746
============ Train epoch 46 ============
 Site-photo                         | Train Loss: 0.0831 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0581 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.5061 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.3559 | Train Acc: 0.9022
 Site-cartoon                       | Train Loss: 0.6316 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.4577 | Train Acc: 0.8644
 Site-sketch                        | Train Loss: 0.7620 | Train Acc: 0.7200
 Site-sketch                        | Train Loss: 0.7936 | Train Acc: 0.7556
Average Train Accuracy: 0.8636
 Site-photo                         | Val  Loss: 0.0576 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0735 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.3307 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.4059 | Val  Acc: 0.8900
 Site-cartoon                       | Val  Loss: 0.4990 | Val  Acc: 0.8600
 Site-cartoon                       | Val  Loss: 0.5295 | Val  Acc: 0.8567
 Site-sketch                        | Val  Loss: 0.7397 | Val  Acc: 0.7400
 Site-sketch                        | Val  Loss: 0.7997 | Val  Acc: 0.7467
Average Valid Accuracy: 0.8754
============ Train epoch 47 ============
 Site-photo                         | Train Loss: 0.1103 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0532 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4217 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.3380 | Train Acc: 0.9111
 Site-cartoon                       | Train Loss: 0.5712 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.4619 | Train Acc: 0.8822
 Site-sketch                        | Train Loss: 0.8322 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.7752 | Train Acc: 0.7467
Average Train Accuracy: 0.8619
 Site-photo                         | Val  Loss: 0.0455 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0578 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.3655 | Val  Acc: 0.9200
 Site-art_painting                  | Val  Loss: 0.3691 | Val  Acc: 0.8967
 Site-cartoon                       | Val  Loss: 0.5276 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 0.4918 | Val  Acc: 0.8667
 Site-sketch                        | Val  Loss: 0.6950 | Val  Acc: 0.7500
 Site-sketch                        | Val  Loss: 0.7776 | Val  Acc: 0.7333
Average Valid Accuracy: 0.8767
============ Train epoch 48 ============
 Site-photo                         | Train Loss: 0.1289 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.0502 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.4755 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.3581 | Train Acc: 0.9111
 Site-cartoon                       | Train Loss: 0.4958 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.4412 | Train Acc: 0.8778
 Site-sketch                        | Train Loss: 0.7379 | Train Acc: 0.7400
 Site-sketch                        | Train Loss: 0.7802 | Train Acc: 0.7622
Average Train Accuracy: 0.8731
 Site-photo                         | Val  Loss: 0.0529 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0568 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.3408 | Val  Acc: 0.9400
 Site-art_painting                  | Val  Loss: 0.3662 | Val  Acc: 0.9100
 Site-cartoon                       | Val  Loss: 0.4941 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 0.4988 | Val  Acc: 0.8733
 Site-sketch                        | Val  Loss: 0.7362 | Val  Acc: 0.6700
 Site-sketch                        | Val  Loss: 0.7788 | Val  Acc: 0.7433
Average Valid Accuracy: 0.8713
============ Train epoch 49 ============
 Site-photo                         | Train Loss: 0.1193 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0712 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.5401 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.3337 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.5930 | Train Acc: 0.7800
 Site-cartoon                       | Train Loss: 0.4289 | Train Acc: 0.8822
 Site-sketch                        | Train Loss: 0.7766 | Train Acc: 0.7200
 Site-sketch                        | Train Loss: 0.7569 | Train Acc: 0.7511
Average Train Accuracy: 0.8592
 Site-photo                         | Val  Loss: 0.0555 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0571 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.3526 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.3701 | Val  Acc: 0.9067
 Site-cartoon                       | Val  Loss: 0.5127 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 0.4716 | Val  Acc: 0.8767
 Site-sketch                        | Val  Loss: 0.7003 | Val  Acc: 0.7600
 Site-sketch                        | Val  Loss: 0.7745 | Val  Acc: 0.7500
Average Valid Accuracy: 0.8821
 Best site-photo                     | Epoch:49 | Val Acc: 1.0000
 Best site-photo                     | Epoch:49 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:49 | Val Acc: 0.9300
 Best site-art_painting              | Epoch:49 | Val Acc: 0.9067
 Best site-cartoon                   | Epoch:49 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:49 | Val Acc: 0.8767
 Best site-sketch                    | Epoch:49 | Val Acc: 0.7600
 Best site-sketch                    | Epoch:49 | Val Acc: 0.7500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/afl...
===2023-08-08 04:00:43===
===2023-08-08 04:00:56===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
Loading snapshots...
 Test site-photo                     (1)| Epoch:49 | Test Acc: 0.9985
 Test site-art_painting              (3)| Epoch:49 | Test Acc: 0.9026
 Test site-cartoon                   (2)| Epoch:49 | Test Acc: 0.8330
 Test site-sketch                    (0)| Epoch:49 | Test Acc: 0.7255
photo: 0.9985, art_painting: 0.9026, cartoon: 0.8330, sketch: 0.7255, 
Average Test Accuracy(group): 0.8649, Average Test Accuracy(individual): 0.8649,
domain std=0.0996, cluster std=0.0996, individual std=0.0996, 
