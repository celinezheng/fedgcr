===2023-08-07 19:41:07===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
===2023-08-07 19:41:09===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
===2023-08-07 19:42:28===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
============ Train epoch 0 ============
 Site-photo                         | Train Loss: 0.8234 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.7699 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 1.1720 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 1.1095 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 1.2996 | Train Acc: 0.7333
 Site-cartoon                       | Train Loss: 1.3011 | Train Acc: 0.7422
 Site-sketch                        | Train Loss: 1.4855 | Train Acc: 0.5533
 Site-sketch                        | Train Loss: 1.4805 | Train Acc: 0.5400
Average Train Accuracy: 0.7703
 Site-photo                         | Val  Loss: 0.7795 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.7632 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 1.1121 | Val  Acc: 0.9000
 Site-art_painting                  | Val  Loss: 1.1580 | Val  Acc: 0.8167
 Site-cartoon                       | Val  Loss: 1.2690 | Val  Acc: 0.7000
 Site-cartoon                       | Val  Loss: 1.2594 | Val  Acc: 0.7167
 Site-sketch                        | Val  Loss: 1.4404 | Val  Acc: 0.5600
 Site-sketch                        | Val  Loss: 1.4656 | Val  Acc: 0.5267
Average Valid Accuracy: 0.7725
 Best site-photo                     | Epoch:0 | Val Acc: 0.9800
 Best site-photo                     | Epoch:0 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:0 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:0 | Val Acc: 0.8167
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.7000
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.7167
 Best site-sketch                    | Epoch:0 | Val Acc: 0.5600
 Best site-sketch                    | Epoch:0 | Val Acc: 0.5267
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 1 ============
 Site-photo                         | Train Loss: 0.3281 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.2787 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.8260 | Train Acc: 0.7933
 Site-art_painting                  | Train Loss: 0.8353 | Train Acc: 0.8511
 Site-cartoon                       | Train Loss: 0.8357 | Train Acc: 0.7467
 Site-cartoon                       | Train Loss: 0.8505 | Train Acc: 0.7978
 Site-sketch                        | Train Loss: 1.2546 | Train Acc: 0.5800
 Site-sketch                        | Train Loss: 1.2742 | Train Acc: 0.5400
Average Train Accuracy: 0.7839
 Site-photo                         | Val  Loss: 0.2697 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.2756 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.7073 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.7149 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 0.8873 | Val  Acc: 0.7300
 Site-cartoon                       | Val  Loss: 0.8866 | Val  Acc: 0.7933
 Site-sketch                        | Val  Loss: 1.1927 | Val  Acc: 0.5100
 Site-sketch                        | Val  Loss: 1.2169 | Val  Acc: 0.5500
Average Valid Accuracy: 0.7883
 Best site-photo                     | Epoch:1 | Val Acc: 0.9900
 Best site-photo                     | Epoch:1 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:1 | Val Acc: 0.8900
 Best site-art_painting              | Epoch:1 | Val Acc: 0.8500
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.7300
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.7933
 Best site-sketch                    | Epoch:1 | Val Acc: 0.5100
 Best site-sketch                    | Epoch:1 | Val Acc: 0.5500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 2 ============
 Site-photo                         | Train Loss: 0.1504 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.1164 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.6535 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.6326 | Train Acc: 0.8956
 Site-cartoon                       | Train Loss: 0.7659 | Train Acc: 0.7600
 Site-cartoon                       | Train Loss: 0.7425 | Train Acc: 0.7600
 Site-sketch                        | Train Loss: 1.0701 | Train Acc: 0.6400
 Site-sketch                        | Train Loss: 1.0596 | Train Acc: 0.6089
Average Train Accuracy: 0.8156
 Site-photo                         | Val  Loss: 0.1116 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1314 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.5037 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.5395 | Val  Acc: 0.8833
 Site-cartoon                       | Val  Loss: 0.7629 | Val  Acc: 0.7600
 Site-cartoon                       | Val  Loss: 0.7489 | Val  Acc: 0.7600
 Site-sketch                        | Val  Loss: 1.0247 | Val  Acc: 0.5900
 Site-sketch                        | Val  Loss: 1.0151 | Val  Acc: 0.6167
Average Valid Accuracy: 0.8113
 Best site-photo                     | Epoch:2 | Val Acc: 1.0000
 Best site-photo                     | Epoch:2 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:2 | Val Acc: 0.8900
 Best site-art_painting              | Epoch:2 | Val Acc: 0.8833
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.7600
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.7600
 Best site-sketch                    | Epoch:2 | Val Acc: 0.5900
 Best site-sketch                    | Epoch:2 | Val Acc: 0.6167
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 3 ============
 Site-photo                         | Train Loss: 0.1266 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0681 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5322 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.3815 | Train Acc: 0.8956
 Site-cartoon                       | Train Loss: 0.6719 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.8526 | Train Acc: 0.8156
 Site-sketch                        | Train Loss: 1.0597 | Train Acc: 0.6267
 Site-sketch                        | Train Loss: 0.9546 | Train Acc: 0.6267
Average Train Accuracy: 0.8253
 Site-photo                         | Val  Loss: 0.0638 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0815 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.4281 | Val  Acc: 0.9100
 Site-art_painting                  | Val  Loss: 0.4465 | Val  Acc: 0.8767
 Site-cartoon                       | Val  Loss: 0.6015 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 0.6440 | Val  Acc: 0.7833
 Site-sketch                        | Val  Loss: 0.9409 | Val  Acc: 0.5700
 Site-sketch                        | Val  Loss: 1.0189 | Val  Acc: 0.6100
Average Valid Accuracy: 0.8225
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:3 | Val Acc: 0.9100
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8767
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.7833
 Best site-sketch                    | Epoch:3 | Val Acc: 0.5700
 Best site-sketch                    | Epoch:3 | Val Acc: 0.6100
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 4 ============
 Site-photo                         | Train Loss: 0.0895 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.0538 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.5253 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.3165 | Train Acc: 0.9289
 Site-cartoon                       | Train Loss: 0.5801 | Train Acc: 0.8000
 Site-cartoon                       | Train Loss: 0.5098 | Train Acc: 0.8400
 Site-sketch                        | Train Loss: 0.8922 | Train Acc: 0.6600
 Site-sketch                        | Train Loss: 0.9064 | Train Acc: 0.6000
Average Train Accuracy: 0.8322
 Site-photo                         | Val  Loss: 0.0496 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0516 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.3638 | Val  Acc: 0.9200
 Site-art_painting                  | Val  Loss: 0.3223 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.5875 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 0.6299 | Val  Acc: 0.8233
 Site-sketch                        | Val  Loss: 0.8281 | Val  Acc: 0.6200
 Site-sketch                        | Val  Loss: 0.9612 | Val  Acc: 0.6033
Average Valid Accuracy: 0.8417
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:4 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:4 | Val Acc: 0.9300
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.8500
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.8233
 Best site-sketch                    | Epoch:4 | Val Acc: 0.6200
 Best site-sketch                    | Epoch:4 | Val Acc: 0.6033
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 5 ============
 Site-photo                         | Train Loss: 0.1281 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0329 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.5097 | Train Acc: 0.8533
 Site-art_painting                  | Train Loss: 0.3234 | Train Acc: 0.9044
 Site-cartoon                       | Train Loss: 0.5721 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.5356 | Train Acc: 0.8622
 Site-sketch                        | Train Loss: 0.9107 | Train Acc: 0.6800
 Site-sketch                        | Train Loss: 0.9526 | Train Acc: 0.6400
Average Train Accuracy: 0.8411
 Site-photo                         | Val  Loss: 0.0224 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0264 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.3296 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.3388 | Val  Acc: 0.9133
 Site-cartoon                       | Val  Loss: 0.5685 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 0.5464 | Val  Acc: 0.8300
 Site-sketch                        | Val  Loss: 0.8241 | Val  Acc: 0.6500
 Site-sketch                        | Val  Loss: 0.8793 | Val  Acc: 0.6700
Average Valid Accuracy: 0.8538
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 0.9967
 Best site-art_painting              | Epoch:5 | Val Acc: 0.9300
 Best site-art_painting              | Epoch:5 | Val Acc: 0.9133
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.8300
 Best site-sketch                    | Epoch:5 | Val Acc: 0.6500
 Best site-sketch                    | Epoch:5 | Val Acc: 0.6700
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 6 ============
 Site-photo                         | Train Loss: 0.0554 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0266 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.4345 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.3193 | Train Acc: 0.9133
 Site-cartoon                       | Train Loss: 0.5502 | Train Acc: 0.7867
 Site-cartoon                       | Train Loss: 0.4263 | Train Acc: 0.8644
 Site-sketch                        | Train Loss: 0.9005 | Train Acc: 0.6733
 Site-sketch                        | Train Loss: 0.7778 | Train Acc: 0.6667
Average Train Accuracy: 0.8456
 Site-photo                         | Val  Loss: 0.0372 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0317 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.2651 | Val  Acc: 0.9500
 Site-art_painting                  | Val  Loss: 0.2691 | Val  Acc: 0.9267
 Site-cartoon                       | Val  Loss: 0.4879 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 0.4969 | Val  Acc: 0.8567
 Site-sketch                        | Val  Loss: 0.8309 | Val  Acc: 0.6200
 Site-sketch                        | Val  Loss: 0.8374 | Val  Acc: 0.6867
Average Valid Accuracy: 0.8579
 Best site-photo                     | Epoch:6 | Val Acc: 0.9900
 Best site-photo                     | Epoch:6 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9500
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9267
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.8567
 Best site-sketch                    | Epoch:6 | Val Acc: 0.6200
 Best site-sketch                    | Epoch:6 | Val Acc: 0.6867
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 7 ============
 Site-photo                         | Train Loss: 0.0609 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0194 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3735 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.2609 | Train Acc: 0.9333
 Site-cartoon                       | Train Loss: 0.5377 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.3931 | Train Acc: 0.8733
 Site-sketch                        | Train Loss: 0.8307 | Train Acc: 0.7333
 Site-sketch                        | Train Loss: 0.7241 | Train Acc: 0.7444
Average Train Accuracy: 0.8758
 Site-photo                         | Val  Loss: 0.0146 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0221 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2140 | Val  Acc: 0.9500
 Site-art_painting                  | Val  Loss: 0.2801 | Val  Acc: 0.9233
 Site-cartoon                       | Val  Loss: 0.4663 | Val  Acc: 0.8800
 Site-cartoon                       | Val  Loss: 0.4605 | Val  Acc: 0.8667
 Site-sketch                        | Val  Loss: 0.7712 | Val  Acc: 0.6900
 Site-sketch                        | Val  Loss: 0.8091 | Val  Acc: 0.7233
Average Valid Accuracy: 0.8792
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:7 | Val Acc: 0.9500
 Best site-art_painting              | Epoch:7 | Val Acc: 0.9233
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.8800
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.8667
 Best site-sketch                    | Epoch:7 | Val Acc: 0.6900
 Best site-sketch                    | Epoch:7 | Val Acc: 0.7233
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 8 ============
 Site-photo                         | Train Loss: 0.0461 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0184 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3303 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.2526 | Train Acc: 0.9111
 Site-cartoon                       | Train Loss: 0.5096 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.4391 | Train Acc: 0.8800
 Site-sketch                        | Train Loss: 0.7358 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.7024 | Train Acc: 0.7333
Average Train Accuracy: 0.8675
 Site-photo                         | Val  Loss: 0.0344 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0267 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.1918 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.2530 | Val  Acc: 0.9367
 Site-cartoon                       | Val  Loss: 0.4534 | Val  Acc: 0.8100
 Site-cartoon                       | Val  Loss: 0.4657 | Val  Acc: 0.8533
 Site-sketch                        | Val  Loss: 0.6907 | Val  Acc: 0.7100
 Site-sketch                        | Val  Loss: 0.7909 | Val  Acc: 0.7333
Average Valid Accuracy: 0.8771
============ Train epoch 9 ============
 Site-photo                         | Train Loss: 0.0465 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0278 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4540 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.2123 | Train Acc: 0.9400
 Site-cartoon                       | Train Loss: 0.5031 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.4086 | Train Acc: 0.8711
 Site-sketch                        | Train Loss: 0.8362 | Train Acc: 0.7400
 Site-sketch                        | Train Loss: 0.7394 | Train Acc: 0.7244
Average Train Accuracy: 0.8683
 Site-photo                         | Val  Loss: 0.0184 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0200 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.2426 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.2614 | Val  Acc: 0.9233
 Site-cartoon                       | Val  Loss: 0.4494 | Val  Acc: 0.8300
 Site-cartoon                       | Val  Loss: 0.4406 | Val  Acc: 0.8767
 Site-sketch                        | Val  Loss: 0.7108 | Val  Acc: 0.7600
 Site-sketch                        | Val  Loss: 0.7542 | Val  Acc: 0.7133
Average Valid Accuracy: 0.8783
============ Train epoch 10 ============
 Site-photo                         | Train Loss: 0.0405 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0165 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.3233 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.2069 | Train Acc: 0.9444
 Site-cartoon                       | Train Loss: 0.4918 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.3940 | Train Acc: 0.8533
 Site-sketch                        | Train Loss: 0.7714 | Train Acc: 0.7533
 Site-sketch                        | Train Loss: 0.7392 | Train Acc: 0.7489
Average Train Accuracy: 0.8783
 Site-photo                         | Val  Loss: 0.0074 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0145 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.2270 | Val  Acc: 0.9500
 Site-art_painting                  | Val  Loss: 0.2162 | Val  Acc: 0.9400
 Site-cartoon                       | Val  Loss: 0.3870 | Val  Acc: 0.8700
 Site-cartoon                       | Val  Loss: 0.4030 | Val  Acc: 0.8667
 Site-sketch                        | Val  Loss: 0.6308 | Val  Acc: 0.7900
 Site-sketch                        | Val  Loss: 0.7171 | Val  Acc: 0.7567
Average Valid Accuracy: 0.8958
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9500
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9400
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.8700
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.8667
 Best site-sketch                    | Epoch:10 | Val Acc: 0.7900
 Best site-sketch                    | Epoch:10 | Val Acc: 0.7567
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 11 ============
 Site-photo                         | Train Loss: 0.0403 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0169 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3432 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.2344 | Train Acc: 0.9333
 Site-cartoon                       | Train Loss: 0.4698 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.5357 | Train Acc: 0.8778
 Site-sketch                        | Train Loss: 0.6988 | Train Acc: 0.7467
 Site-sketch                        | Train Loss: 0.6922 | Train Acc: 0.7489
Average Train Accuracy: 0.8769
 Site-photo                         | Val  Loss: 0.0214 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0175 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.1565 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.2149 | Val  Acc: 0.9367
 Site-cartoon                       | Val  Loss: 0.3748 | Val  Acc: 0.8700
 Site-cartoon                       | Val  Loss: 0.4120 | Val  Acc: 0.8733
 Site-sketch                        | Val  Loss: 0.6093 | Val  Acc: 0.7600
 Site-sketch                        | Val  Loss: 0.7165 | Val  Acc: 0.7500
Average Valid Accuracy: 0.8958
============ Train epoch 12 ============
 Site-photo                         | Train Loss: 0.0314 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0186 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4091 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.2374 | Train Acc: 0.9467
 Site-cartoon                       | Train Loss: 0.4018 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.2885 | Train Acc: 0.9067
 Site-sketch                        | Train Loss: 0.8504 | Train Acc: 0.7400
 Site-sketch                        | Train Loss: 0.6597 | Train Acc: 0.7467
Average Train Accuracy: 0.8844
 Site-photo                         | Val  Loss: 0.0154 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0194 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.2200 | Val  Acc: 0.9500
 Site-art_painting                  | Val  Loss: 0.2109 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.3534 | Val  Acc: 0.8800
 Site-cartoon                       | Val  Loss: 0.3331 | Val  Acc: 0.9033
 Site-sketch                        | Val  Loss: 0.6160 | Val  Acc: 0.7500
 Site-sketch                        | Val  Loss: 0.7130 | Val  Acc: 0.7333
Average Valid Accuracy: 0.8929
============ Train epoch 13 ============
 Site-photo                         | Train Loss: 0.0334 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0146 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3262 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.2036 | Train Acc: 0.9289
 Site-cartoon                       | Train Loss: 0.4001 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.3165 | Train Acc: 0.9044
 Site-sketch                        | Train Loss: 0.7701 | Train Acc: 0.7267
 Site-sketch                        | Train Loss: 0.7215 | Train Acc: 0.7311
Average Train Accuracy: 0.8700
 Site-photo                         | Val  Loss: 0.0140 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0097 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1486 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.1928 | Val  Acc: 0.9533
 Site-cartoon                       | Val  Loss: 0.3419 | Val  Acc: 0.9100
 Site-cartoon                       | Val  Loss: 0.3184 | Val  Acc: 0.9167
 Site-sketch                        | Val  Loss: 0.6239 | Val  Acc: 0.7700
 Site-sketch                        | Val  Loss: 0.7165 | Val  Acc: 0.7533
Average Valid Accuracy: 0.9092
 Best site-photo                     | Epoch:13 | Val Acc: 0.9900
 Best site-photo                     | Epoch:13 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:13 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:13 | Val Acc: 0.9533
 Best site-cartoon                   | Epoch:13 | Val Acc: 0.9100
 Best site-cartoon                   | Epoch:13 | Val Acc: 0.9167
 Best site-sketch                    | Epoch:13 | Val Acc: 0.7700
 Best site-sketch                    | Epoch:13 | Val Acc: 0.7533
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 14 ============
 Site-photo                         | Train Loss: 0.0223 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0170 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3267 | Train Acc: 0.9067
 Site-art_painting                  | Train Loss: 0.1790 | Train Acc: 0.9467
 Site-cartoon                       | Train Loss: 0.4435 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.2913 | Train Acc: 0.9067
 Site-sketch                        | Train Loss: 0.8347 | Train Acc: 0.7333
 Site-sketch                        | Train Loss: 0.6384 | Train Acc: 0.7800
Average Train Accuracy: 0.8844
 Site-photo                         | Val  Loss: 0.0135 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0078 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1464 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1693 | Val  Acc: 0.9567
 Site-cartoon                       | Val  Loss: 0.3174 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.2950 | Val  Acc: 0.9200
 Site-sketch                        | Val  Loss: 0.6291 | Val  Acc: 0.7900
 Site-sketch                        | Val  Loss: 0.7184 | Val  Acc: 0.7200
Average Valid Accuracy: 0.9108
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:14 | Val Acc: 0.9700
 Best site-art_painting              | Epoch:14 | Val Acc: 0.9567
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.9300
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.9200
 Best site-sketch                    | Epoch:14 | Val Acc: 0.7900
 Best site-sketch                    | Epoch:14 | Val Acc: 0.7200
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 15 ============
 Site-photo                         | Train Loss: 0.0263 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0086 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2994 | Train Acc: 0.9067
 Site-art_painting                  | Train Loss: 0.1766 | Train Acc: 0.9489
 Site-cartoon                       | Train Loss: 0.4396 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.3272 | Train Acc: 0.9267
 Site-sketch                        | Train Loss: 0.7286 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.6557 | Train Acc: 0.7422
Average Train Accuracy: 0.8839
 Site-photo                         | Val  Loss: 0.0154 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1696 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1685 | Val  Acc: 0.9500
 Site-cartoon                       | Val  Loss: 0.3048 | Val  Acc: 0.9200
 Site-cartoon                       | Val  Loss: 0.3231 | Val  Acc: 0.9067
 Site-sketch                        | Val  Loss: 0.6462 | Val  Acc: 0.7200
 Site-sketch                        | Val  Loss: 0.6735 | Val  Acc: 0.7400
Average Valid Accuracy: 0.8996
============ Train epoch 16 ============
 Site-photo                         | Train Loss: 0.0394 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0069 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3198 | Train Acc: 0.8533
 Site-art_painting                  | Train Loss: 0.1916 | Train Acc: 0.9489
 Site-cartoon                       | Train Loss: 0.4051 | Train Acc: 0.8200
 Site-cartoon                       | Train Loss: 0.2765 | Train Acc: 0.9089
 Site-sketch                        | Train Loss: 0.7661 | Train Acc: 0.7400
 Site-sketch                        | Train Loss: 0.6757 | Train Acc: 0.7422
Average Train Accuracy: 0.8758
 Site-photo                         | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0137 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.1615 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1694 | Val  Acc: 0.9500
 Site-cartoon                       | Val  Loss: 0.3589 | Val  Acc: 0.8700
 Site-cartoon                       | Val  Loss: 0.2839 | Val  Acc: 0.9300
 Site-sketch                        | Val  Loss: 0.5636 | Val  Acc: 0.8200
 Site-sketch                        | Val  Loss: 0.6611 | Val  Acc: 0.7467
Average Valid Accuracy: 0.9104
============ Train epoch 17 ============
 Site-photo                         | Train Loss: 0.0363 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0126 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3420 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.1628 | Train Acc: 0.9467
 Site-cartoon                       | Train Loss: 0.4726 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.2635 | Train Acc: 0.9178
 Site-sketch                        | Train Loss: 0.7475 | Train Acc: 0.7267
 Site-sketch                        | Train Loss: 0.9006 | Train Acc: 0.7756
Average Train Accuracy: 0.8872
 Site-photo                         | Val  Loss: 0.0294 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0056 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1692 | Val  Acc: 0.9600
 Site-art_painting                  | Val  Loss: 0.1574 | Val  Acc: 0.9633
 Site-cartoon                       | Val  Loss: 0.3441 | Val  Acc: 0.9100
 Site-cartoon                       | Val  Loss: 0.3428 | Val  Acc: 0.8833
 Site-sketch                        | Val  Loss: 0.5243 | Val  Acc: 0.8300
 Site-sketch                        | Val  Loss: 0.6706 | Val  Acc: 0.7700
Average Valid Accuracy: 0.9133
 Best site-photo                     | Epoch:17 | Val Acc: 0.9900
 Best site-photo                     | Epoch:17 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:17 | Val Acc: 0.9600
 Best site-art_painting              | Epoch:17 | Val Acc: 0.9633
 Best site-cartoon                   | Epoch:17 | Val Acc: 0.9100
 Best site-cartoon                   | Epoch:17 | Val Acc: 0.8833
 Best site-sketch                    | Epoch:17 | Val Acc: 0.8300
 Best site-sketch                    | Epoch:17 | Val Acc: 0.7700
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 18 ============
 Site-photo                         | Train Loss: 0.0417 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0109 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3956 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.1767 | Train Acc: 0.9489
 Site-cartoon                       | Train Loss: 0.4096 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.2830 | Train Acc: 0.9222
 Site-sketch                        | Train Loss: 0.7361 | Train Acc: 0.7600
 Site-sketch                        | Train Loss: 0.6134 | Train Acc: 0.7578
Average Train Accuracy: 0.8883
 Site-photo                         | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0099 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.2163 | Val  Acc: 0.9400
 Site-art_painting                  | Val  Loss: 0.1701 | Val  Acc: 0.9467
 Site-cartoon                       | Val  Loss: 0.3047 | Val  Acc: 0.8900
 Site-cartoon                       | Val  Loss: 0.2957 | Val  Acc: 0.9267
 Site-sketch                        | Val  Loss: 0.5440 | Val  Acc: 0.8200
 Site-sketch                        | Val  Loss: 0.6709 | Val  Acc: 0.7633
Average Valid Accuracy: 0.9104
============ Train epoch 19 ============
 Site-photo                         | Train Loss: 0.0685 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0122 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3509 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.1483 | Train Acc: 0.9578
 Site-cartoon                       | Train Loss: 0.3556 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.2618 | Train Acc: 0.9133
 Site-sketch                        | Train Loss: 0.7712 | Train Acc: 0.7467
 Site-sketch                        | Train Loss: 0.6217 | Train Acc: 0.7467
Average Train Accuracy: 0.8928
 Site-photo                         | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0099 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.1949 | Val  Acc: 0.9400
 Site-art_painting                  | Val  Loss: 0.2047 | Val  Acc: 0.9367
 Site-cartoon                       | Val  Loss: 0.2944 | Val  Acc: 0.8900
 Site-cartoon                       | Val  Loss: 0.3246 | Val  Acc: 0.9000
 Site-sketch                        | Val  Loss: 0.6611 | Val  Acc: 0.7000
 Site-sketch                        | Val  Loss: 0.6600 | Val  Acc: 0.7433
Average Valid Accuracy: 0.8883
============ Train epoch 20 ============
 Site-photo                         | Train Loss: 0.0461 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0083 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2542 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.1613 | Train Acc: 0.9556
 Site-cartoon                       | Train Loss: 0.4155 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.2732 | Train Acc: 0.9044
 Site-sketch                        | Train Loss: 0.7537 | Train Acc: 0.7867
 Site-sketch                        | Train Loss: 0.6523 | Train Acc: 0.7778
Average Train Accuracy: 0.8978
 Site-photo                         | Val  Loss: 0.0207 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0168 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.1387 | Val  Acc: 0.9600
 Site-art_painting                  | Val  Loss: 0.1668 | Val  Acc: 0.9667
 Site-cartoon                       | Val  Loss: 0.3461 | Val  Acc: 0.8900
 Site-cartoon                       | Val  Loss: 0.2854 | Val  Acc: 0.9200
 Site-sketch                        | Val  Loss: 0.5111 | Val  Acc: 0.8000
 Site-sketch                        | Val  Loss: 0.6372 | Val  Acc: 0.7867
Average Valid Accuracy: 0.9138
 Best site-photo                     | Epoch:20 | Val Acc: 0.9900
 Best site-photo                     | Epoch:20 | Val Acc: 0.9967
 Best site-art_painting              | Epoch:20 | Val Acc: 0.9600
 Best site-art_painting              | Epoch:20 | Val Acc: 0.9667
 Best site-cartoon                   | Epoch:20 | Val Acc: 0.8900
 Best site-cartoon                   | Epoch:20 | Val Acc: 0.9200
 Best site-sketch                    | Epoch:20 | Val Acc: 0.8000
 Best site-sketch                    | Epoch:20 | Val Acc: 0.7867
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 21 ============
 Site-photo                         | Train Loss: 0.0218 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0100 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2714 | Train Acc: 0.9067
 Site-art_painting                  | Train Loss: 0.1816 | Train Acc: 0.9556
 Site-cartoon                       | Train Loss: 0.3898 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.2606 | Train Acc: 0.9156
 Site-sketch                        | Train Loss: 0.7129 | Train Acc: 0.7533
 Site-sketch                        | Train Loss: 0.6797 | Train Acc: 0.7444
Average Train Accuracy: 0.8917
 Site-photo                         | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0154 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.1377 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1601 | Val  Acc: 0.9600
 Site-cartoon                       | Val  Loss: 0.3403 | Val  Acc: 0.9100
 Site-cartoon                       | Val  Loss: 0.3272 | Val  Acc: 0.9000
 Site-sketch                        | Val  Loss: 0.6179 | Val  Acc: 0.7100
 Site-sketch                        | Val  Loss: 0.6600 | Val  Acc: 0.7333
Average Valid Accuracy: 0.8971
============ Train epoch 22 ============
 Site-photo                         | Train Loss: 0.0476 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0083 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.2398 | Train Acc: 0.9333
 Site-art_painting                  | Train Loss: 0.2379 | Train Acc: 0.9378
 Site-cartoon                       | Train Loss: 0.4163 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.2548 | Train Acc: 0.9400
 Site-sketch                        | Train Loss: 0.6436 | Train Acc: 0.7533
 Site-sketch                        | Train Loss: 0.6760 | Train Acc: 0.7556
Average Train Accuracy: 0.8994
 Site-photo                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0068 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1574 | Val  Acc: 0.9500
 Site-art_painting                  | Val  Loss: 0.1624 | Val  Acc: 0.9600
 Site-cartoon                       | Val  Loss: 0.2732 | Val  Acc: 0.9200
 Site-cartoon                       | Val  Loss: 0.2961 | Val  Acc: 0.9100
 Site-sketch                        | Val  Loss: 0.6349 | Val  Acc: 0.7000
 Site-sketch                        | Val  Loss: 0.6633 | Val  Acc: 0.7433
Average Valid Accuracy: 0.8979
============ Train epoch 23 ============
 Site-photo                         | Train Loss: 0.0243 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0142 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3377 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.1588 | Train Acc: 0.9644
 Site-cartoon                       | Train Loss: 0.3758 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.2568 | Train Acc: 0.9133
 Site-sketch                        | Train Loss: 0.6636 | Train Acc: 0.7533
 Site-sketch                        | Train Loss: 0.5768 | Train Acc: 0.7622
Average Train Accuracy: 0.8961
 Site-photo                         | Val  Loss: 0.0142 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1497 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1393 | Val  Acc: 0.9633
 Site-cartoon                       | Val  Loss: 0.2695 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.2863 | Val  Acc: 0.9067
 Site-sketch                        | Val  Loss: 0.4636 | Val  Acc: 0.8000
 Site-sketch                        | Val  Loss: 0.6266 | Val  Acc: 0.7867
Average Valid Accuracy: 0.9183
 Best site-photo                     | Epoch:23 | Val Acc: 0.9900
 Best site-photo                     | Epoch:23 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:23 | Val Acc: 0.9700
 Best site-art_painting              | Epoch:23 | Val Acc: 0.9633
 Best site-cartoon                   | Epoch:23 | Val Acc: 0.9300
 Best site-cartoon                   | Epoch:23 | Val Acc: 0.9067
 Best site-sketch                    | Epoch:23 | Val Acc: 0.8000
 Best site-sketch                    | Epoch:23 | Val Acc: 0.7867
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 24 ============
 Site-photo                         | Train Loss: 0.0402 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0039 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3591 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.1542 | Train Acc: 0.9622
 Site-cartoon                       | Train Loss: 0.3902 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.3918 | Train Acc: 0.9422
 Site-sketch                        | Train Loss: 0.6618 | Train Acc: 0.7533
 Site-sketch                        | Train Loss: 0.5785 | Train Acc: 0.7844
Average Train Accuracy: 0.9011
 Site-photo                         | Val  Loss: 0.0113 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0306 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.1496 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1662 | Val  Acc: 0.9567
 Site-cartoon                       | Val  Loss: 0.3107 | Val  Acc: 0.9200
 Site-cartoon                       | Val  Loss: 0.2741 | Val  Acc: 0.9300
 Site-sketch                        | Val  Loss: 0.5519 | Val  Acc: 0.8000
 Site-sketch                        | Val  Loss: 0.5924 | Val  Acc: 0.7900
Average Valid Accuracy: 0.9188
 Best site-photo                     | Epoch:24 | Val Acc: 0.9900
 Best site-photo                     | Epoch:24 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:24 | Val Acc: 0.9700
 Best site-art_painting              | Epoch:24 | Val Acc: 0.9567
 Best site-cartoon                   | Epoch:24 | Val Acc: 0.9200
 Best site-cartoon                   | Epoch:24 | Val Acc: 0.9300
 Best site-sketch                    | Epoch:24 | Val Acc: 0.8000
 Best site-sketch                    | Epoch:24 | Val Acc: 0.7900
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 25 ============
 Site-photo                         | Train Loss: 0.0287 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0170 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.2755 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.1484 | Train Acc: 0.9600
 Site-cartoon                       | Train Loss: 0.4115 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.2572 | Train Acc: 0.9222
 Site-sketch                        | Train Loss: 0.6305 | Train Acc: 0.7800
 Site-sketch                        | Train Loss: 0.5515 | Train Acc: 0.7956
Average Train Accuracy: 0.9036
 Site-photo                         | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0076 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1478 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1327 | Val  Acc: 0.9733
 Site-cartoon                       | Val  Loss: 0.3186 | Val  Acc: 0.8800
 Site-cartoon                       | Val  Loss: 0.2579 | Val  Acc: 0.9400
 Site-sketch                        | Val  Loss: 0.5153 | Val  Acc: 0.8300
 Site-sketch                        | Val  Loss: 0.5818 | Val  Acc: 0.7733
Average Valid Accuracy: 0.9208
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9700
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9733
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.8800
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.9400
 Best site-sketch                    | Epoch:25 | Val Acc: 0.8300
 Best site-sketch                    | Epoch:25 | Val Acc: 0.7733
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 26 ============
 Site-photo                         | Train Loss: 0.0549 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0131 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3300 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.1997 | Train Acc: 0.9511
 Site-cartoon                       | Train Loss: 0.4870 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.2970 | Train Acc: 0.9089
 Site-sketch                        | Train Loss: 0.6813 | Train Acc: 0.7933
 Site-sketch                        | Train Loss: 0.6500 | Train Acc: 0.7644
Average Train Accuracy: 0.8886
 Site-photo                         | Val  Loss: 0.0112 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0118 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.1232 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.1650 | Val  Acc: 0.9533
 Site-cartoon                       | Val  Loss: 0.2406 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.2562 | Val  Acc: 0.9467
 Site-sketch                        | Val  Loss: 0.5293 | Val  Acc: 0.8200
 Site-sketch                        | Val  Loss: 0.5775 | Val  Acc: 0.7767
Average Valid Accuracy: 0.9242
 Best site-photo                     | Epoch:26 | Val Acc: 0.9900
 Best site-photo                     | Epoch:26 | Val Acc: 0.9967
 Best site-art_painting              | Epoch:26 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:26 | Val Acc: 0.9533
 Best site-cartoon                   | Epoch:26 | Val Acc: 0.9300
 Best site-cartoon                   | Epoch:26 | Val Acc: 0.9467
 Best site-sketch                    | Epoch:26 | Val Acc: 0.8200
 Best site-sketch                    | Epoch:26 | Val Acc: 0.7767
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 27 ============
 Site-photo                         | Train Loss: 0.0324 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0144 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3043 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.1383 | Train Acc: 0.9644
 Site-cartoon                       | Train Loss: 0.4467 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.2207 | Train Acc: 0.9267
 Site-sketch                        | Train Loss: 0.6497 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 0.5997 | Train Acc: 0.8156
Average Train Accuracy: 0.8986
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0071 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.1274 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1533 | Val  Acc: 0.9633
 Site-cartoon                       | Val  Loss: 0.1945 | Val  Acc: 0.9500
 Site-cartoon                       | Val  Loss: 0.2582 | Val  Acc: 0.9333
 Site-sketch                        | Val  Loss: 0.4751 | Val  Acc: 0.8200
 Site-sketch                        | Val  Loss: 0.6010 | Val  Acc: 0.7833
Average Valid Accuracy: 0.9271
 Best site-photo                     | Epoch:27 | Val Acc: 1.0000
 Best site-photo                     | Epoch:27 | Val Acc: 0.9967
 Best site-art_painting              | Epoch:27 | Val Acc: 0.9700
 Best site-art_painting              | Epoch:27 | Val Acc: 0.9633
 Best site-cartoon                   | Epoch:27 | Val Acc: 0.9500
 Best site-cartoon                   | Epoch:27 | Val Acc: 0.9333
 Best site-sketch                    | Epoch:27 | Val Acc: 0.8200
 Best site-sketch                    | Epoch:27 | Val Acc: 0.7833
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 28 ============
 Site-photo                         | Train Loss: 0.0268 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0052 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2845 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.1370 | Train Acc: 0.9600
 Site-cartoon                       | Train Loss: 0.4118 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.2121 | Train Acc: 0.9378
 Site-sketch                        | Train Loss: 0.6379 | Train Acc: 0.7600
 Site-sketch                        | Train Loss: 0.7166 | Train Acc: 0.7756
Average Train Accuracy: 0.9008
 Site-photo                         | Val  Loss: 0.0121 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0132 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.1133 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.1158 | Val  Acc: 0.9733
 Site-cartoon                       | Val  Loss: 0.2258 | Val  Acc: 0.9500
 Site-cartoon                       | Val  Loss: 0.2193 | Val  Acc: 0.9400
 Site-sketch                        | Val  Loss: 0.5047 | Val  Acc: 0.8000
 Site-sketch                        | Val  Loss: 0.5984 | Val  Acc: 0.7900
Average Valid Accuracy: 0.9287
 Best site-photo                     | Epoch:28 | Val Acc: 1.0000
 Best site-photo                     | Epoch:28 | Val Acc: 0.9967
 Best site-art_painting              | Epoch:28 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:28 | Val Acc: 0.9733
 Best site-cartoon                   | Epoch:28 | Val Acc: 0.9500
 Best site-cartoon                   | Epoch:28 | Val Acc: 0.9400
 Best site-sketch                    | Epoch:28 | Val Acc: 0.8000
 Best site-sketch                    | Epoch:28 | Val Acc: 0.7900
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 29 ============
 Site-photo                         | Train Loss: 0.0244 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0065 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2912 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1398 | Train Acc: 0.9711
 Site-cartoon                       | Train Loss: 0.4149 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.2015 | Train Acc: 0.9511
 Site-sketch                        | Train Loss: 0.6893 | Train Acc: 0.7467
 Site-sketch                        | Train Loss: 0.6201 | Train Acc: 0.7667
Average Train Accuracy: 0.8978
 Site-photo                         | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0103 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.1315 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.1282 | Val  Acc: 0.9867
 Site-cartoon                       | Val  Loss: 0.2702 | Val  Acc: 0.9000
 Site-cartoon                       | Val  Loss: 0.2403 | Val  Acc: 0.9433
 Site-sketch                        | Val  Loss: 0.4887 | Val  Acc: 0.7900
 Site-sketch                        | Val  Loss: 0.5717 | Val  Acc: 0.7700
Average Valid Accuracy: 0.9208
============ Train epoch 30 ============
 Site-photo                         | Train Loss: 0.0292 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0072 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2800 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.1546 | Train Acc: 0.9600
 Site-cartoon                       | Train Loss: 0.3112 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.2121 | Train Acc: 0.9356
 Site-sketch                        | Train Loss: 0.6753 | Train Acc: 0.7333
 Site-sketch                        | Train Loss: 0.5350 | Train Acc: 0.7756
Average Train Accuracy: 0.9003
 Site-photo                         | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1213 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.1406 | Val  Acc: 0.9667
 Site-cartoon                       | Val  Loss: 0.2639 | Val  Acc: 0.9200
 Site-cartoon                       | Val  Loss: 0.2620 | Val  Acc: 0.9233
 Site-sketch                        | Val  Loss: 0.5363 | Val  Acc: 0.7900
 Site-sketch                        | Val  Loss: 0.5628 | Val  Acc: 0.7833
Average Valid Accuracy: 0.9204
============ Train epoch 31 ============
 Site-photo                         | Train Loss: 0.0372 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0089 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3512 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1914 | Train Acc: 0.9711
 Site-cartoon                       | Train Loss: 0.3784 | Train Acc: 0.9067
 Site-cartoon                       | Train Loss: 0.1987 | Train Acc: 0.9422
 Site-sketch                        | Train Loss: 0.6483 | Train Acc: 0.7600
 Site-sketch                        | Train Loss: 0.5468 | Train Acc: 0.7978
Average Train Accuracy: 0.9078
 Site-photo                         | Val  Loss: 0.0220 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1291 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1551 | Val  Acc: 0.9667
 Site-cartoon                       | Val  Loss: 0.2340 | Val  Acc: 0.9400
 Site-cartoon                       | Val  Loss: 0.2458 | Val  Acc: 0.9567
 Site-sketch                        | Val  Loss: 0.5044 | Val  Acc: 0.7900
 Site-sketch                        | Val  Loss: 0.5979 | Val  Acc: 0.7833
Average Valid Accuracy: 0.9246
============ Train epoch 32 ============
 Site-photo                         | Train Loss: 0.0159 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0064 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2660 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.1436 | Train Acc: 0.9711
 Site-cartoon                       | Train Loss: 0.3164 | Train Acc: 0.9267
 Site-cartoon                       | Train Loss: 0.1971 | Train Acc: 0.9467
 Site-sketch                        | Train Loss: 0.6377 | Train Acc: 0.7333
 Site-sketch                        | Train Loss: 0.6141 | Train Acc: 0.7800
Average Train Accuracy: 0.9078
 Site-photo                         | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0035 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1117 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1573 | Val  Acc: 0.9600
 Site-cartoon                       | Val  Loss: 0.2081 | Val  Acc: 0.9600
 Site-cartoon                       | Val  Loss: 0.2429 | Val  Acc: 0.9333
 Site-sketch                        | Val  Loss: 0.4941 | Val  Acc: 0.8300
 Site-sketch                        | Val  Loss: 0.5541 | Val  Acc: 0.8267
Average Valid Accuracy: 0.9350
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:32 | Val Acc: 0.9700
 Best site-art_painting              | Epoch:32 | Val Acc: 0.9600
 Best site-cartoon                   | Epoch:32 | Val Acc: 0.9600
 Best site-cartoon                   | Epoch:32 | Val Acc: 0.9333
 Best site-sketch                    | Epoch:32 | Val Acc: 0.8300
 Best site-sketch                    | Epoch:32 | Val Acc: 0.8267
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 33 ============
 Site-photo                         | Train Loss: 0.0379 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0068 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3287 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.1988 | Train Acc: 0.9689
 Site-cartoon                       | Train Loss: 0.3754 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.2081 | Train Acc: 0.9400
 Site-sketch                        | Train Loss: 0.6100 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 0.5436 | Train Acc: 0.7822
Average Train Accuracy: 0.9014
 Site-photo                         | Val  Loss: 0.0035 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1309 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1222 | Val  Acc: 0.9800
 Site-cartoon                       | Val  Loss: 0.2364 | Val  Acc: 0.9500
 Site-cartoon                       | Val  Loss: 0.2293 | Val  Acc: 0.9500
 Site-sketch                        | Val  Loss: 0.4727 | Val  Acc: 0.8200
 Site-sketch                        | Val  Loss: 0.5259 | Val  Acc: 0.8067
Average Valid Accuracy: 0.9346
============ Train epoch 34 ============
 Site-photo                         | Train Loss: 0.0182 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0100 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2373 | Train Acc: 0.9267
 Site-art_painting                  | Train Loss: 0.1840 | Train Acc: 0.9600
 Site-cartoon                       | Train Loss: 0.3373 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.3531 | Train Acc: 0.9467
 Site-sketch                        | Train Loss: 0.5230 | Train Acc: 0.7933
 Site-sketch                        | Train Loss: 0.5551 | Train Acc: 0.7800
Average Train Accuracy: 0.9089
 Site-photo                         | Val  Loss: 0.0666 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1183 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.1309 | Val  Acc: 0.9700
 Site-cartoon                       | Val  Loss: 0.2689 | Val  Acc: 0.9200
 Site-cartoon                       | Val  Loss: 0.2327 | Val  Acc: 0.9300
 Site-sketch                        | Val  Loss: 0.4560 | Val  Acc: 0.8500
 Site-sketch                        | Val  Loss: 0.5517 | Val  Acc: 0.8067
Average Valid Accuracy: 0.9321
============ Train epoch 35 ============
 Site-photo                         | Train Loss: 0.0174 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0032 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2422 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1572 | Train Acc: 0.9578
 Site-cartoon                       | Train Loss: 0.3480 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.2291 | Train Acc: 0.9444
 Site-sketch                        | Train Loss: 0.6455 | Train Acc: 0.7467
 Site-sketch                        | Train Loss: 0.4827 | Train Acc: 0.8244
Average Train Accuracy: 0.9033
 Site-photo                         | Val  Loss: 0.0065 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1195 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.1255 | Val  Acc: 0.9667
 Site-cartoon                       | Val  Loss: 0.1897 | Val  Acc: 0.9700
 Site-cartoon                       | Val  Loss: 0.2513 | Val  Acc: 0.9333
 Site-sketch                        | Val  Loss: 0.4884 | Val  Acc: 0.7800
 Site-sketch                        | Val  Loss: 0.5100 | Val  Acc: 0.8100
Average Valid Accuracy: 0.9300
============ Train epoch 36 ============
 Site-photo                         | Train Loss: 0.0265 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0161 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.2720 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1459 | Train Acc: 0.9578
 Site-cartoon                       | Train Loss: 0.3927 | Train Acc: 0.8867
 Site-cartoon                       | Train Loss: 0.1792 | Train Acc: 0.9422
 Site-sketch                        | Train Loss: 0.5984 | Train Acc: 0.7533
 Site-sketch                        | Train Loss: 0.5737 | Train Acc: 0.8044
Average Train Accuracy: 0.9031
 Site-photo                         | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1165 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1156 | Val  Acc: 0.9767
 Site-cartoon                       | Val  Loss: 0.2164 | Val  Acc: 0.9700
 Site-cartoon                       | Val  Loss: 0.2353 | Val  Acc: 0.9333
 Site-sketch                        | Val  Loss: 0.4406 | Val  Acc: 0.8800
 Site-sketch                        | Val  Loss: 0.5145 | Val  Acc: 0.8267
Average Valid Accuracy: 0.9446
 Best site-photo                     | Epoch:36 | Val Acc: 1.0000
 Best site-photo                     | Epoch:36 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:36 | Val Acc: 0.9700
 Best site-art_painting              | Epoch:36 | Val Acc: 0.9767
 Best site-cartoon                   | Epoch:36 | Val Acc: 0.9700
 Best site-cartoon                   | Epoch:36 | Val Acc: 0.9333
 Best site-sketch                    | Epoch:36 | Val Acc: 0.8800
 Best site-sketch                    | Epoch:36 | Val Acc: 0.8267
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 37 ============
 Site-photo                         | Train Loss: 0.0217 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2671 | Train Acc: 0.9067
 Site-art_painting                  | Train Loss: 0.1067 | Train Acc: 0.9733
 Site-cartoon                       | Train Loss: 0.2926 | Train Acc: 0.9067
 Site-cartoon                       | Train Loss: 0.1816 | Train Acc: 0.9467
 Site-sketch                        | Train Loss: 0.5495 | Train Acc: 0.7667
 Site-sketch                        | Train Loss: 0.5980 | Train Acc: 0.7956
Average Train Accuracy: 0.9111
 Site-photo                         | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1218 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1267 | Val  Acc: 0.9867
 Site-cartoon                       | Val  Loss: 0.2107 | Val  Acc: 0.9400
 Site-cartoon                       | Val  Loss: 0.2039 | Val  Acc: 0.9533
 Site-sketch                        | Val  Loss: 0.4949 | Val  Acc: 0.8100
 Site-sketch                        | Val  Loss: 0.5587 | Val  Acc: 0.7833
Average Valid Accuracy: 0.9304
============ Train epoch 38 ============
 Site-photo                         | Train Loss: 0.0323 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0066 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2560 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1500 | Train Acc: 0.9711
 Site-cartoon                       | Train Loss: 0.3295 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.1722 | Train Acc: 0.9511
 Site-sketch                        | Train Loss: 0.6553 | Train Acc: 0.8000
 Site-sketch                        | Train Loss: 0.5497 | Train Acc: 0.7800
Average Train Accuracy: 0.9108
 Site-photo                         | Val  Loss: 0.0042 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1279 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.1227 | Val  Acc: 0.9700
 Site-cartoon                       | Val  Loss: 0.2357 | Val  Acc: 0.9500
 Site-cartoon                       | Val  Loss: 0.2203 | Val  Acc: 0.9333
 Site-sketch                        | Val  Loss: 0.4953 | Val  Acc: 0.8100
 Site-sketch                        | Val  Loss: 0.5361 | Val  Acc: 0.8133
Average Valid Accuracy: 0.9333
============ Train epoch 39 ============
 Site-photo                         | Train Loss: 0.0184 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0063 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2444 | Train Acc: 0.9067
 Site-art_painting                  | Train Loss: 0.0928 | Train Acc: 0.9844
 Site-cartoon                       | Train Loss: 0.3942 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.1892 | Train Acc: 0.9489
 Site-sketch                        | Train Loss: 0.5560 | Train Acc: 0.7933
 Site-sketch                        | Train Loss: 0.5348 | Train Acc: 0.7933
Average Train Accuracy: 0.9117
 Site-photo                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0042 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1212 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.1122 | Val  Acc: 0.9900
 Site-cartoon                       | Val  Loss: 0.1790 | Val  Acc: 0.9600
 Site-cartoon                       | Val  Loss: 0.1843 | Val  Acc: 0.9567
 Site-sketch                        | Val  Loss: 0.4458 | Val  Acc: 0.7900
 Site-sketch                        | Val  Loss: 0.5410 | Val  Acc: 0.8100
Average Valid Accuracy: 0.9358
============ Train epoch 40 ============
 Site-photo                         | Train Loss: 0.0235 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0054 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3083 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.1131 | Train Acc: 0.9756
 Site-cartoon                       | Train Loss: 0.3021 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.2977 | Train Acc: 0.9444
 Site-sketch                        | Train Loss: 0.6728 | Train Acc: 0.8200
 Site-sketch                        | Train Loss: 0.5071 | Train Acc: 0.8311
Average Train Accuracy: 0.9172
 Site-photo                         | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1181 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1079 | Val  Acc: 0.9900
 Site-cartoon                       | Val  Loss: 0.1965 | Val  Acc: 0.9600
 Site-cartoon                       | Val  Loss: 0.2337 | Val  Acc: 0.9433
 Site-sketch                        | Val  Loss: 0.4278 | Val  Acc: 0.8100
 Site-sketch                        | Val  Loss: 0.5371 | Val  Acc: 0.7833
Average Valid Accuracy: 0.9321
============ Train epoch 41 ============
 Site-photo                         | Train Loss: 0.0392 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2140 | Train Acc: 0.9267
 Site-art_painting                  | Train Loss: 0.1072 | Train Acc: 0.9822
 Site-cartoon                       | Train Loss: 0.3511 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.1756 | Train Acc: 0.9467
 Site-sketch                        | Train Loss: 0.5734 | Train Acc: 0.7600
 Site-sketch                        | Train Loss: 0.4964 | Train Acc: 0.8067
Average Train Accuracy: 0.9078
 Site-photo                         | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0190 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.1122 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.0879 | Val  Acc: 0.9933
 Site-cartoon                       | Val  Loss: 0.2006 | Val  Acc: 0.9500
 Site-cartoon                       | Val  Loss: 0.1716 | Val  Acc: 0.9667
 Site-sketch                        | Val  Loss: 0.4601 | Val  Acc: 0.8500
 Site-sketch                        | Val  Loss: 0.5360 | Val  Acc: 0.8200
Average Valid Accuracy: 0.9446
============ Train epoch 42 ============
 Site-photo                         | Train Loss: 0.0306 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0043 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3461 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.1011 | Train Acc: 0.9778
 Site-cartoon                       | Train Loss: 0.2987 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.1781 | Train Acc: 0.9578
 Site-sketch                        | Train Loss: 0.5875 | Train Acc: 0.8000
 Site-sketch                        | Train Loss: 0.6021 | Train Acc: 0.7689
Average Train Accuracy: 0.9039
 Site-photo                         | Val  Loss: 0.0072 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0067 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1057 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.1254 | Val  Acc: 0.9700
 Site-cartoon                       | Val  Loss: 0.1891 | Val  Acc: 0.9700
 Site-cartoon                       | Val  Loss: 0.2076 | Val  Acc: 0.9500
 Site-sketch                        | Val  Loss: 0.4667 | Val  Acc: 0.8400
 Site-sketch                        | Val  Loss: 0.5574 | Val  Acc: 0.8100
Average Valid Accuracy: 0.9400
============ Train epoch 43 ============
 Site-photo                         | Train Loss: 0.0117 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2248 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.1913 | Train Acc: 0.9533
 Site-cartoon                       | Train Loss: 0.3998 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.1981 | Train Acc: 0.9467
 Site-sketch                        | Train Loss: 0.5708 | Train Acc: 0.8267
 Site-sketch                        | Train Loss: 0.4661 | Train Acc: 0.8444
Average Train Accuracy: 0.9156
 Site-photo                         | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1406 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.1161 | Val  Acc: 0.9767
 Site-cartoon                       | Val  Loss: 0.2033 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.2050 | Val  Acc: 0.9467
 Site-sketch                        | Val  Loss: 0.4313 | Val  Acc: 0.8500
 Site-sketch                        | Val  Loss: 0.5153 | Val  Acc: 0.8067
Average Valid Accuracy: 0.9375
============ Train epoch 44 ============
 Site-photo                         | Train Loss: 0.0237 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0096 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3079 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.1126 | Train Acc: 0.9756
 Site-cartoon                       | Train Loss: 0.3489 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.2109 | Train Acc: 0.9444
 Site-sketch                        | Train Loss: 0.6738 | Train Acc: 0.7667
 Site-sketch                        | Train Loss: 0.5015 | Train Acc: 0.8044
Average Train Accuracy: 0.9033
 Site-photo                         | Val  Loss: 0.0042 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.0991 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1125 | Val  Acc: 0.9800
 Site-cartoon                       | Val  Loss: 0.2191 | Val  Acc: 0.9200
 Site-cartoon                       | Val  Loss: 0.2126 | Val  Acc: 0.9433
 Site-sketch                        | Val  Loss: 0.4358 | Val  Acc: 0.8400
 Site-sketch                        | Val  Loss: 0.5337 | Val  Acc: 0.8067
Average Valid Accuracy: 0.9325
============ Train epoch 45 ============
 Site-photo                         | Train Loss: 0.0662 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0039 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2787 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.1190 | Train Acc: 0.9778
 Site-cartoon                       | Train Loss: 0.3461 | Train Acc: 0.8867
 Site-cartoon                       | Train Loss: 0.1880 | Train Acc: 0.9378
 Site-sketch                        | Train Loss: 0.6582 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 0.4945 | Train Acc: 0.8133
Average Train Accuracy: 0.9094
 Site-photo                         | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1182 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.1184 | Val  Acc: 0.9800
 Site-cartoon                       | Val  Loss: 0.2177 | Val  Acc: 0.9600
 Site-cartoon                       | Val  Loss: 0.2362 | Val  Acc: 0.9267
 Site-sketch                        | Val  Loss: 0.3839 | Val  Acc: 0.8800
 Site-sketch                        | Val  Loss: 0.4974 | Val  Acc: 0.8300
Average Valid Accuracy: 0.9446
============ Train epoch 46 ============
 Site-photo                         | Train Loss: 0.0118 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0028 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2890 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1112 | Train Acc: 0.9756
 Site-cartoon                       | Train Loss: 0.3559 | Train Acc: 0.8867
 Site-cartoon                       | Train Loss: 0.1852 | Train Acc: 0.9333
 Site-sketch                        | Train Loss: 0.5038 | Train Acc: 0.7933
 Site-sketch                        | Train Loss: 0.5768 | Train Acc: 0.8222
Average Train Accuracy: 0.9139
 Site-photo                         | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0174 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.0865 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.1269 | Val  Acc: 0.9667
 Site-cartoon                       | Val  Loss: 0.1690 | Val  Acc: 0.9800
 Site-cartoon                       | Val  Loss: 0.2208 | Val  Acc: 0.9333
 Site-sketch                        | Val  Loss: 0.4383 | Val  Acc: 0.8200
 Site-sketch                        | Val  Loss: 0.5293 | Val  Acc: 0.7933
Average Valid Accuracy: 0.9333
============ Train epoch 47 ============
 Site-photo                         | Train Loss: 0.0601 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0037 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2093 | Train Acc: 0.9333
 Site-art_painting                  | Train Loss: 0.1066 | Train Acc: 0.9778
 Site-cartoon                       | Train Loss: 0.3238 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.2060 | Train Acc: 0.9400
 Site-sketch                        | Train Loss: 0.5719 | Train Acc: 0.7600
 Site-sketch                        | Train Loss: 0.4989 | Train Acc: 0.8133
Average Train Accuracy: 0.9097
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0046 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1231 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.1043 | Val  Acc: 0.9867
 Site-cartoon                       | Val  Loss: 0.2095 | Val  Acc: 0.9700
 Site-cartoon                       | Val  Loss: 0.2086 | Val  Acc: 0.9467
 Site-sketch                        | Val  Loss: 0.4203 | Val  Acc: 0.8700
 Site-sketch                        | Val  Loss: 0.5125 | Val  Acc: 0.8067
Average Valid Accuracy: 0.9450
 Best site-photo                     | Epoch:47 | Val Acc: 1.0000
 Best site-photo                     | Epoch:47 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:47 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:47 | Val Acc: 0.9867
 Best site-cartoon                   | Epoch:47 | Val Acc: 0.9700
 Best site-cartoon                   | Epoch:47 | Val Acc: 0.9467
 Best site-sketch                    | Epoch:47 | Val Acc: 0.8700
 Best site-sketch                    | Epoch:47 | Val Acc: 0.8067
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 48 ============
 Site-photo                         | Train Loss: 0.0566 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0042 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2694 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.1120 | Train Acc: 0.9800
 Site-cartoon                       | Train Loss: 0.3032 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.1962 | Train Acc: 0.9489
 Site-sketch                        | Train Loss: 0.5043 | Train Acc: 0.7933
 Site-sketch                        | Train Loss: 0.5173 | Train Acc: 0.8178
Average Train Accuracy: 0.9172
 Site-photo                         | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0099 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.1182 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 0.1018 | Val  Acc: 0.9833
 Site-cartoon                       | Val  Loss: 0.2331 | Val  Acc: 0.9100
 Site-cartoon                       | Val  Loss: 0.2096 | Val  Acc: 0.9533
 Site-sketch                        | Val  Loss: 0.4953 | Val  Acc: 0.7900
 Site-sketch                        | Val  Loss: 0.4814 | Val  Acc: 0.8200
Average Valid Accuracy: 0.9279
============ Train epoch 49 ============
 Site-photo                         | Train Loss: 0.0323 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0131 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3348 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.1122 | Train Acc: 0.9711
 Site-cartoon                       | Train Loss: 0.3482 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.1702 | Train Acc: 0.9489
 Site-sketch                        | Train Loss: 0.5525 | Train Acc: 0.7867
 Site-sketch                        | Train Loss: 0.5529 | Train Acc: 0.8156
Average Train Accuracy: 0.9114
 Site-photo                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0113 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.1168 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.1177 | Val  Acc: 0.9833
 Site-cartoon                       | Val  Loss: 0.2065 | Val  Acc: 0.9200
 Site-cartoon                       | Val  Loss: 0.1795 | Val  Acc: 0.9700
 Site-sketch                        | Val  Loss: 0.4290 | Val  Acc: 0.8500
 Site-sketch                        | Val  Loss: 0.5395 | Val  Acc: 0.7833
Average Valid Accuracy: 0.9363
===2023-08-07 22:11:44===
===2023-08-07 22:12:00===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
Loading snapshots...
 Test site-photo                     | Epoch:47 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:47 | Test Acc: 0.9391
 Test site-cartoon                   | Epoch:47 | Test Acc: 0.8809
 Test site-sketch                    | Epoch:47 | Test Acc: 0.7751
photo: 0.9985, art_painting: 0.9391, cartoon: 0.8809, sketch: 0.7751, 
Average Test Accuracy(group): 0.8984, Average Test Accuracy(individual): 0.8984,
domain std=0.0824, cluster std=-1.0000, individual std=0.0824, 
===2023-08-10 13:13:49===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 0
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
===2023-08-10 13:13:55===
