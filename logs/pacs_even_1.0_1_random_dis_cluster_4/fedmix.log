===2023-08-08 01:11:49===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
============ Train epoch 0 ============
 Site-photo                         | Train Loss: 1.7747 | Train Acc: 0.6933
 Site-photo                         | Train Loss: 1.7575 | Train Acc: 0.7267
 Site-art_painting                  | Train Loss: 1.8395 | Train Acc: 0.5133
 Site-art_painting                  | Train Loss: 1.8230 | Train Acc: 0.5444
 Site-cartoon                       | Train Loss: 1.8630 | Train Acc: 0.4133
 Site-cartoon                       | Train Loss: 1.8671 | Train Acc: 0.3711
 Site-sketch                        | Train Loss: 1.8809 | Train Acc: 0.2867
 Site-sketch                        | Train Loss: 1.8591 | Train Acc: 0.3422
Average Train Accuracy: 0.4864
 Site-photo                         | Val  Loss: 1.7743 | Val  Acc: 0.6700
 Site-photo                         | Val  Loss: 1.7650 | Val  Acc: 0.7567
 Site-art_painting                  | Val  Loss: 1.8247 | Val  Acc: 0.5800
 Site-art_painting                  | Val  Loss: 1.8318 | Val  Acc: 0.5000
 Site-cartoon                       | Val  Loss: 1.8501 | Val  Acc: 0.3900
 Site-cartoon                       | Val  Loss: 1.8567 | Val  Acc: 0.4000
 Site-sketch                        | Val  Loss: 1.8672 | Val  Acc: 0.2000
 Site-sketch                        | Val  Loss: 1.8592 | Val  Acc: 0.3133
Average Valid Accuracy: 0.4763
 Best site-photo                     | Epoch:0 | Val Acc: 0.6700
 Best site-photo                     | Epoch:0 | Val Acc: 0.7567
 Best site-art_painting              | Epoch:0 | Val Acc: 0.5800
 Best site-art_painting              | Epoch:0 | Val Acc: 0.5000
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.3900
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.4000
 Best site-sketch                    | Epoch:0 | Val Acc: 0.2000
 Best site-sketch                    | Epoch:0 | Val Acc: 0.3133
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 1 ============
 Site-photo                         | Train Loss: 1.6202 | Train Acc: 0.9200
 Site-photo                         | Train Loss: 1.6155 | Train Acc: 0.9244
 Site-art_painting                  | Train Loss: 1.7405 | Train Acc: 0.6400
 Site-art_painting                  | Train Loss: 1.6967 | Train Acc: 0.6578
 Site-cartoon                       | Train Loss: 1.7555 | Train Acc: 0.5533
 Site-cartoon                       | Train Loss: 1.7715 | Train Acc: 0.5067
 Site-sketch                        | Train Loss: 1.8041 | Train Acc: 0.3600
 Site-sketch                        | Train Loss: 1.7882 | Train Acc: 0.4400
Average Train Accuracy: 0.6253
 Site-photo                         | Val  Loss: 1.6195 | Val  Acc: 0.9000
 Site-photo                         | Val  Loss: 1.6181 | Val  Acc: 0.9267
 Site-art_painting                  | Val  Loss: 1.7287 | Val  Acc: 0.6900
 Site-art_painting                  | Val  Loss: 1.7300 | Val  Acc: 0.6867
 Site-cartoon                       | Val  Loss: 1.7630 | Val  Acc: 0.4600
 Site-cartoon                       | Val  Loss: 1.7598 | Val  Acc: 0.5367
 Site-sketch                        | Val  Loss: 1.7803 | Val  Acc: 0.4000
 Site-sketch                        | Val  Loss: 1.7851 | Val  Acc: 0.4167
Average Valid Accuracy: 0.6271
 Best site-photo                     | Epoch:1 | Val Acc: 0.9000
 Best site-photo                     | Epoch:1 | Val Acc: 0.9267
 Best site-art_painting              | Epoch:1 | Val Acc: 0.6900
 Best site-art_painting              | Epoch:1 | Val Acc: 0.6867
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.4600
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.5367
 Best site-sketch                    | Epoch:1 | Val Acc: 0.4000
 Best site-sketch                    | Epoch:1 | Val Acc: 0.4167
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 2 ============
 Site-photo                         | Train Loss: 1.4959 | Train Acc: 0.9600
 Site-photo                         | Train Loss: 1.4957 | Train Acc: 0.9800
 Site-art_painting                  | Train Loss: 1.6561 | Train Acc: 0.7133
 Site-art_painting                  | Train Loss: 1.6209 | Train Acc: 0.7733
 Site-cartoon                       | Train Loss: 1.6879 | Train Acc: 0.5933
 Site-cartoon                       | Train Loss: 1.6312 | Train Acc: 0.5667
 Site-sketch                        | Train Loss: 1.7495 | Train Acc: 0.4067
 Site-sketch                        | Train Loss: 1.7138 | Train Acc: 0.4556
Average Train Accuracy: 0.6811
 Site-photo                         | Val  Loss: 1.4815 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 1.4828 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 1.6380 | Val  Acc: 0.7600
 Site-art_painting                  | Val  Loss: 1.6419 | Val  Acc: 0.7600
 Site-cartoon                       | Val  Loss: 1.6755 | Val  Acc: 0.5000
 Site-cartoon                       | Val  Loss: 1.6694 | Val  Acc: 0.5633
 Site-sketch                        | Val  Loss: 1.7060 | Val  Acc: 0.4600
 Site-sketch                        | Val  Loss: 1.7133 | Val  Acc: 0.4533
Average Valid Accuracy: 0.6833
 Best site-photo                     | Epoch:2 | Val Acc: 0.9800
 Best site-photo                     | Epoch:2 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:2 | Val Acc: 0.7600
 Best site-art_painting              | Epoch:2 | Val Acc: 0.7600
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.5000
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.5633
 Best site-sketch                    | Epoch:2 | Val Acc: 0.4600
 Best site-sketch                    | Epoch:2 | Val Acc: 0.4533
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 3 ============
 Site-photo                         | Train Loss: 1.3611 | Train Acc: 0.9600
 Site-photo                         | Train Loss: 1.3417 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 1.5558 | Train Acc: 0.7400
 Site-art_painting                  | Train Loss: 1.5486 | Train Acc: 0.7800
 Site-cartoon                       | Train Loss: 1.5779 | Train Acc: 0.6467
 Site-cartoon                       | Train Loss: 1.5681 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 1.6704 | Train Acc: 0.4533
 Site-sketch                        | Train Loss: 1.6402 | Train Acc: 0.4778
Average Train Accuracy: 0.7139
 Site-photo                         | Val  Loss: 1.3647 | Val  Acc: 0.9700
 Site-photo                         | Val  Loss: 1.3493 | Val  Acc: 0.9833
 Site-art_painting                  | Val  Loss: 1.5370 | Val  Acc: 0.8000
 Site-art_painting                  | Val  Loss: 1.5410 | Val  Acc: 0.7967
 Site-cartoon                       | Val  Loss: 1.6029 | Val  Acc: 0.6100
 Site-cartoon                       | Val  Loss: 1.5920 | Val  Acc: 0.6000
 Site-sketch                        | Val  Loss: 1.6383 | Val  Acc: 0.4600
 Site-sketch                        | Val  Loss: 1.6564 | Val  Acc: 0.4933
Average Valid Accuracy: 0.7142
 Best site-photo                     | Epoch:3 | Val Acc: 0.9700
 Best site-photo                     | Epoch:3 | Val Acc: 0.9833
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8000
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7967
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.6100
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.6000
 Best site-sketch                    | Epoch:3 | Val Acc: 0.4600
 Best site-sketch                    | Epoch:3 | Val Acc: 0.4933
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 4 ============
 Site-photo                         | Train Loss: 1.2550 | Train Acc: 0.9667
 Site-photo                         | Train Loss: 1.2265 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 1.4981 | Train Acc: 0.7267
 Site-art_painting                  | Train Loss: 1.4390 | Train Acc: 0.8044
 Site-cartoon                       | Train Loss: 1.5321 | Train Acc: 0.6600
 Site-cartoon                       | Train Loss: 1.4922 | Train Acc: 0.6289
 Site-sketch                        | Train Loss: 1.6300 | Train Acc: 0.5067
 Site-sketch                        | Train Loss: 1.5510 | Train Acc: 0.4911
Average Train Accuracy: 0.7219
 Site-photo                         | Val  Loss: 1.2252 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 1.2239 | Val  Acc: 0.9833
 Site-art_painting                  | Val  Loss: 1.4336 | Val  Acc: 0.8400
 Site-art_painting                  | Val  Loss: 1.4592 | Val  Acc: 0.8200
 Site-cartoon                       | Val  Loss: 1.5180 | Val  Acc: 0.6300
 Site-cartoon                       | Val  Loss: 1.5241 | Val  Acc: 0.6533
 Site-sketch                        | Val  Loss: 1.5773 | Val  Acc: 0.5200
 Site-sketch                        | Val  Loss: 1.6027 | Val  Acc: 0.4767
Average Valid Accuracy: 0.7392
 Best site-photo                     | Epoch:4 | Val Acc: 0.9900
 Best site-photo                     | Epoch:4 | Val Acc: 0.9833
 Best site-art_painting              | Epoch:4 | Val Acc: 0.8400
 Best site-art_painting              | Epoch:4 | Val Acc: 0.8200
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.6300
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.6533
 Best site-sketch                    | Epoch:4 | Val Acc: 0.5200
 Best site-sketch                    | Epoch:4 | Val Acc: 0.4767
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 5 ============
 Site-photo                         | Train Loss: 1.1404 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 1.0970 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 1.3817 | Train Acc: 0.7800
 Site-art_painting                  | Train Loss: 1.3933 | Train Acc: 0.8289
 Site-cartoon                       | Train Loss: 1.4699 | Train Acc: 0.7200
 Site-cartoon                       | Train Loss: 1.4048 | Train Acc: 0.6800
 Site-sketch                        | Train Loss: 1.5844 | Train Acc: 0.5000
 Site-sketch                        | Train Loss: 1.5331 | Train Acc: 0.5111
Average Train Accuracy: 0.7481
 Site-photo                         | Val  Loss: 1.0992 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.1069 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 1.3493 | Val  Acc: 0.8500
 Site-art_painting                  | Val  Loss: 1.3599 | Val  Acc: 0.8067
 Site-cartoon                       | Val  Loss: 1.4470 | Val  Acc: 0.6300
 Site-cartoon                       | Val  Loss: 1.4471 | Val  Acc: 0.6733
 Site-sketch                        | Val  Loss: 1.5265 | Val  Acc: 0.4800
 Site-sketch                        | Val  Loss: 1.5439 | Val  Acc: 0.5167
Average Valid Accuracy: 0.7429
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8500
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8067
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.6300
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.6733
 Best site-sketch                    | Epoch:5 | Val Acc: 0.4800
 Best site-sketch                    | Epoch:5 | Val Acc: 0.5167
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 6 ============
 Site-photo                         | Train Loss: 1.0483 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.9815 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 1.3322 | Train Acc: 0.7533
 Site-art_painting                  | Train Loss: 1.3404 | Train Acc: 0.8178
 Site-cartoon                       | Train Loss: 1.3991 | Train Acc: 0.7200
 Site-cartoon                       | Train Loss: 1.3964 | Train Acc: 0.7133
 Site-sketch                        | Train Loss: 1.5529 | Train Acc: 0.5467
 Site-sketch                        | Train Loss: 1.5287 | Train Acc: 0.5444
Average Train Accuracy: 0.7575
 Site-photo                         | Val  Loss: 1.0045 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.9958 | Val  Acc: 0.9833
 Site-art_painting                  | Val  Loss: 1.3042 | Val  Acc: 0.8400
 Site-art_painting                  | Val  Loss: 1.3053 | Val  Acc: 0.8167
 Site-cartoon                       | Val  Loss: 1.3875 | Val  Acc: 0.7000
 Site-cartoon                       | Val  Loss: 1.3712 | Val  Acc: 0.6933
 Site-sketch                        | Val  Loss: 1.4702 | Val  Acc: 0.5000
 Site-sketch                        | Val  Loss: 1.5039 | Val  Acc: 0.5267
Average Valid Accuracy: 0.7550
 Best site-photo                     | Epoch:6 | Val Acc: 0.9800
 Best site-photo                     | Epoch:6 | Val Acc: 0.9833
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8400
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8167
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.7000
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.6933
 Best site-sketch                    | Epoch:6 | Val Acc: 0.5000
 Best site-sketch                    | Epoch:6 | Val Acc: 0.5267
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 7 ============
 Site-photo                         | Train Loss: 0.9428 | Train Acc: 0.9667
 Site-photo                         | Train Loss: 0.9324 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 1.2359 | Train Acc: 0.7933
 Site-art_painting                  | Train Loss: 1.2255 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 1.3475 | Train Acc: 0.7200
 Site-cartoon                       | Train Loss: 1.3082 | Train Acc: 0.7244
 Site-sketch                        | Train Loss: 1.4349 | Train Acc: 0.5867
 Site-sketch                        | Train Loss: 1.4313 | Train Acc: 0.5533
Average Train Accuracy: 0.7711
 Site-photo                         | Val  Loss: 0.9063 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8868 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 1.2107 | Val  Acc: 0.8400
 Site-art_painting                  | Val  Loss: 1.2065 | Val  Acc: 0.8533
 Site-cartoon                       | Val  Loss: 1.3448 | Val  Acc: 0.6300
 Site-cartoon                       | Val  Loss: 1.3077 | Val  Acc: 0.6900
 Site-sketch                        | Val  Loss: 1.4237 | Val  Acc: 0.5900
 Site-sketch                        | Val  Loss: 1.4496 | Val  Acc: 0.5500
Average Valid Accuracy: 0.7679
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8400
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8533
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.6300
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.6900
 Best site-sketch                    | Epoch:7 | Val Acc: 0.5900
 Best site-sketch                    | Epoch:7 | Val Acc: 0.5500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 8 ============
 Site-photo                         | Train Loss: 0.8297 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.7676 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 1.1706 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 1.1765 | Train Acc: 0.8244
 Site-cartoon                       | Train Loss: 1.3199 | Train Acc: 0.6933
 Site-cartoon                       | Train Loss: 1.2582 | Train Acc: 0.7600
 Site-sketch                        | Train Loss: 1.4723 | Train Acc: 0.6000
 Site-sketch                        | Train Loss: 1.4427 | Train Acc: 0.5756
Average Train Accuracy: 0.7803
 Site-photo                         | Val  Loss: 0.8122 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.7956 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 1.1237 | Val  Acc: 0.8400
 Site-art_painting                  | Val  Loss: 1.1364 | Val  Acc: 0.8600
 Site-cartoon                       | Val  Loss: 1.2576 | Val  Acc: 0.6800
 Site-cartoon                       | Val  Loss: 1.2543 | Val  Acc: 0.7067
 Site-sketch                        | Val  Loss: 1.3635 | Val  Acc: 0.5200
 Site-sketch                        | Val  Loss: 1.4148 | Val  Acc: 0.6000
Average Valid Accuracy: 0.7721
 Best site-photo                     | Epoch:8 | Val Acc: 0.9900
 Best site-photo                     | Epoch:8 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:8 | Val Acc: 0.8400
 Best site-art_painting              | Epoch:8 | Val Acc: 0.8600
 Best site-cartoon                   | Epoch:8 | Val Acc: 0.6800
 Best site-cartoon                   | Epoch:8 | Val Acc: 0.7067
 Best site-sketch                    | Epoch:8 | Val Acc: 0.5200
 Best site-sketch                    | Epoch:8 | Val Acc: 0.6000
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 9 ============
 Site-photo                         | Train Loss: 0.7337 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.6862 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 1.1715 | Train Acc: 0.7800
 Site-art_painting                  | Train Loss: 1.0626 | Train Acc: 0.8622
 Site-cartoon                       | Train Loss: 1.2409 | Train Acc: 0.7400
 Site-cartoon                       | Train Loss: 1.1685 | Train Acc: 0.7622
 Site-sketch                        | Train Loss: 1.4252 | Train Acc: 0.5800
 Site-sketch                        | Train Loss: 1.3713 | Train Acc: 0.6022
Average Train Accuracy: 0.7861
 Site-photo                         | Val  Loss: 0.7098 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.7073 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 1.0925 | Val  Acc: 0.8800
 Site-art_painting                  | Val  Loss: 1.0624 | Val  Acc: 0.8600
 Site-cartoon                       | Val  Loss: 1.2476 | Val  Acc: 0.6600
 Site-cartoon                       | Val  Loss: 1.1878 | Val  Acc: 0.7700
 Site-sketch                        | Val  Loss: 1.3208 | Val  Acc: 0.5900
 Site-sketch                        | Val  Loss: 1.3759 | Val  Acc: 0.5800
Average Valid Accuracy: 0.7896
 Best site-photo                     | Epoch:9 | Val Acc: 0.9900
 Best site-photo                     | Epoch:9 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8800
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8600
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.6600
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.7700
 Best site-sketch                    | Epoch:9 | Val Acc: 0.5900
 Best site-sketch                    | Epoch:9 | Val Acc: 0.5800
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 10 ============
 Site-photo                         | Train Loss: 0.6733 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.6172 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 1.0641 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.9964 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 1.1755 | Train Acc: 0.7733
 Site-cartoon                       | Train Loss: 1.1260 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 1.3876 | Train Acc: 0.6333
 Site-sketch                        | Train Loss: 1.3120 | Train Acc: 0.5956
Average Train Accuracy: 0.8028
 Site-photo                         | Val  Loss: 0.6597 | Val  Acc: 0.9700
 Site-photo                         | Val  Loss: 0.6225 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 1.0190 | Val  Acc: 0.8600
 Site-art_painting                  | Val  Loss: 1.0427 | Val  Acc: 0.8333
 Site-cartoon                       | Val  Loss: 1.1424 | Val  Acc: 0.7400
 Site-cartoon                       | Val  Loss: 1.1403 | Val  Acc: 0.7500
 Site-sketch                        | Val  Loss: 1.2836 | Val  Acc: 0.6500
 Site-sketch                        | Val  Loss: 1.3376 | Val  Acc: 0.6067
Average Valid Accuracy: 0.7996
 Best site-photo                     | Epoch:10 | Val Acc: 0.9700
 Best site-photo                     | Epoch:10 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8333
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.7400
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.7500
 Best site-sketch                    | Epoch:10 | Val Acc: 0.6500
 Best site-sketch                    | Epoch:10 | Val Acc: 0.6067
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 11 ============
 Site-photo                         | Train Loss: 0.5950 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.5584 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 1.0453 | Train Acc: 0.7733
 Site-art_painting                  | Train Loss: 0.9606 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 1.1235 | Train Acc: 0.7333
 Site-cartoon                       | Train Loss: 1.1332 | Train Acc: 0.7867
 Site-sketch                        | Train Loss: 1.3198 | Train Acc: 0.6267
 Site-sketch                        | Train Loss: 1.2801 | Train Acc: 0.6044
Average Train Accuracy: 0.7944
 Site-photo                         | Val  Loss: 0.5713 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.5592 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.9823 | Val  Acc: 0.8200
 Site-art_painting                  | Val  Loss: 0.9703 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 1.0880 | Val  Acc: 0.7400
 Site-cartoon                       | Val  Loss: 1.0892 | Val  Acc: 0.7467
 Site-sketch                        | Val  Loss: 1.2101 | Val  Acc: 0.6600
 Site-sketch                        | Val  Loss: 1.2971 | Val  Acc: 0.6067
Average Valid Accuracy: 0.7988
============ Train epoch 12 ============
 Site-photo                         | Train Loss: 0.5688 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.5224 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 1.0183 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.9490 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 1.0871 | Train Acc: 0.8200
 Site-cartoon                       | Train Loss: 1.0218 | Train Acc: 0.7822
 Site-sketch                        | Train Loss: 1.3179 | Train Acc: 0.6133
 Site-sketch                        | Train Loss: 1.2604 | Train Acc: 0.5733
Average Train Accuracy: 0.8028
 Site-photo                         | Val  Loss: 0.4987 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5004 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.8963 | Val  Acc: 0.8800
 Site-art_painting                  | Val  Loss: 0.9350 | Val  Acc: 0.8433
 Site-cartoon                       | Val  Loss: 1.0911 | Val  Acc: 0.7300
 Site-cartoon                       | Val  Loss: 1.0658 | Val  Acc: 0.7800
 Site-sketch                        | Val  Loss: 1.2405 | Val  Acc: 0.6200
 Site-sketch                        | Val  Loss: 1.2701 | Val  Acc: 0.6033
Average Valid Accuracy: 0.8054
 Best site-photo                     | Epoch:12 | Val Acc: 1.0000
 Best site-photo                     | Epoch:12 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8800
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8433
 Best site-cartoon                   | Epoch:12 | Val Acc: 0.7300
 Best site-cartoon                   | Epoch:12 | Val Acc: 0.7800
 Best site-sketch                    | Epoch:12 | Val Acc: 0.6200
 Best site-sketch                    | Epoch:12 | Val Acc: 0.6033
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 13 ============
 Site-photo                         | Train Loss: 0.4758 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.4202 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.9363 | Train Acc: 0.8067
 Site-art_painting                  | Train Loss: 0.9564 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 1.0625 | Train Acc: 0.7800
 Site-cartoon                       | Train Loss: 1.0679 | Train Acc: 0.7933
 Site-sketch                        | Train Loss: 1.2845 | Train Acc: 0.6200
 Site-sketch                        | Train Loss: 1.2682 | Train Acc: 0.6178
Average Train Accuracy: 0.8047
 Site-photo                         | Val  Loss: 0.4467 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4510 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.8855 | Val  Acc: 0.8600
 Site-art_painting                  | Val  Loss: 0.8490 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 1.0326 | Val  Acc: 0.7400
 Site-cartoon                       | Val  Loss: 1.0263 | Val  Acc: 0.7500
 Site-sketch                        | Val  Loss: 1.2039 | Val  Acc: 0.5700
 Site-sketch                        | Val  Loss: 1.2308 | Val  Acc: 0.6233
Average Valid Accuracy: 0.7975
============ Train epoch 14 ============
 Site-photo                         | Train Loss: 0.4286 | Train Acc: 0.9600
 Site-photo                         | Train Loss: 0.3873 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.9059 | Train Acc: 0.8067
 Site-art_painting                  | Train Loss: 0.9142 | Train Acc: 0.8622
 Site-cartoon                       | Train Loss: 1.0618 | Train Acc: 0.7800
 Site-cartoon                       | Train Loss: 0.9623 | Train Acc: 0.8022
 Site-sketch                        | Train Loss: 1.2506 | Train Acc: 0.6067
 Site-sketch                        | Train Loss: 1.2370 | Train Acc: 0.6222
Average Train Accuracy: 0.8036
 Site-photo                         | Val  Loss: 0.4061 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.3979 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.8285 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.8479 | Val  Acc: 0.8533
 Site-cartoon                       | Val  Loss: 0.9845 | Val  Acc: 0.7800
 Site-cartoon                       | Val  Loss: 0.9987 | Val  Acc: 0.7633
 Site-sketch                        | Val  Loss: 1.1519 | Val  Acc: 0.6000
 Site-sketch                        | Val  Loss: 1.2106 | Val  Acc: 0.6233
Average Valid Accuracy: 0.8117
 Best site-photo                     | Epoch:14 | Val Acc: 0.9900
 Best site-photo                     | Epoch:14 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8900
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8533
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.7800
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.7633
 Best site-sketch                    | Epoch:14 | Val Acc: 0.6000
 Best site-sketch                    | Epoch:14 | Val Acc: 0.6233
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 15 ============
 Site-photo                         | Train Loss: 0.3836 | Train Acc: 0.9667
 Site-photo                         | Train Loss: 0.3370 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.8813 | Train Acc: 0.8133
 Site-art_painting                  | Train Loss: 0.8078 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.9253 | Train Acc: 0.7867
 Site-cartoon                       | Train Loss: 0.8707 | Train Acc: 0.8067
 Site-sketch                        | Train Loss: 1.2253 | Train Acc: 0.6533
 Site-sketch                        | Train Loss: 1.1858 | Train Acc: 0.6111
Average Train Accuracy: 0.8100
 Site-photo                         | Val  Loss: 0.3851 | Val  Acc: 0.9700
 Site-photo                         | Val  Loss: 0.3507 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.7840 | Val  Acc: 0.8800
 Site-art_painting                  | Val  Loss: 0.8101 | Val  Acc: 0.8667
 Site-cartoon                       | Val  Loss: 0.9692 | Val  Acc: 0.7200
 Site-cartoon                       | Val  Loss: 0.9629 | Val  Acc: 0.7600
 Site-sketch                        | Val  Loss: 1.1328 | Val  Acc: 0.5900
 Site-sketch                        | Val  Loss: 1.1785 | Val  Acc: 0.6000
Average Valid Accuracy: 0.7975
============ Train epoch 16 ============
 Site-photo                         | Train Loss: 0.3521 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.3006 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.8136 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.7283 | Train Acc: 0.8644
 Site-cartoon                       | Train Loss: 0.9626 | Train Acc: 0.7800
 Site-cartoon                       | Train Loss: 0.9821 | Train Acc: 0.7978
 Site-sketch                        | Train Loss: 1.1812 | Train Acc: 0.6200
 Site-sketch                        | Train Loss: 1.1406 | Train Acc: 0.6067
Average Train Accuracy: 0.8050
 Site-photo                         | Val  Loss: 0.3014 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.3271 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.7591 | Val  Acc: 0.8700
 Site-art_painting                  | Val  Loss: 0.7748 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 0.9450 | Val  Acc: 0.7800
 Site-cartoon                       | Val  Loss: 0.9134 | Val  Acc: 0.8167
 Site-sketch                        | Val  Loss: 1.1364 | Val  Acc: 0.6300
 Site-sketch                        | Val  Loss: 1.1616 | Val  Acc: 0.6200
Average Valid Accuracy: 0.8175
 Best site-photo                     | Epoch:16 | Val Acc: 0.9900
 Best site-photo                     | Epoch:16 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8700
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:16 | Val Acc: 0.7800
 Best site-cartoon                   | Epoch:16 | Val Acc: 0.8167
 Best site-sketch                    | Epoch:16 | Val Acc: 0.6300
 Best site-sketch                    | Epoch:16 | Val Acc: 0.6200
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 17 ============
 Site-photo                         | Train Loss: 0.3366 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.2856 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.7867 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.7464 | Train Acc: 0.8578
 Site-cartoon                       | Train Loss: 0.9204 | Train Acc: 0.7800
 Site-cartoon                       | Train Loss: 0.8964 | Train Acc: 0.8022
 Site-sketch                        | Train Loss: 1.2173 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 1.1698 | Train Acc: 0.6156
Average Train Accuracy: 0.8164
 Site-photo                         | Val  Loss: 0.3034 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.2952 | Val  Acc: 0.9833
 Site-art_painting                  | Val  Loss: 0.7344 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.7280 | Val  Acc: 0.8567
 Site-cartoon                       | Val  Loss: 0.8858 | Val  Acc: 0.7200
 Site-cartoon                       | Val  Loss: 0.8920 | Val  Acc: 0.7933
 Site-sketch                        | Val  Loss: 1.1006 | Val  Acc: 0.6300
 Site-sketch                        | Val  Loss: 1.1397 | Val  Acc: 0.6167
Average Valid Accuracy: 0.8087
============ Train epoch 18 ============
 Site-photo                         | Train Loss: 0.3358 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.2495 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.7927 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.7509 | Train Acc: 0.8711
 Site-cartoon                       | Train Loss: 0.8781 | Train Acc: 0.8067
 Site-cartoon                       | Train Loss: 0.9045 | Train Acc: 0.8089
 Site-sketch                        | Train Loss: 1.1559 | Train Acc: 0.6333
 Site-sketch                        | Train Loss: 1.1208 | Train Acc: 0.6422
Average Train Accuracy: 0.8194
 Site-photo                         | Val  Loss: 0.2798 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.2728 | Val  Acc: 0.9833
 Site-art_painting                  | Val  Loss: 0.6719 | Val  Acc: 0.8800
 Site-art_painting                  | Val  Loss: 0.7027 | Val  Acc: 0.8667
 Site-cartoon                       | Val  Loss: 0.8552 | Val  Acc: 0.7900
 Site-cartoon                       | Val  Loss: 0.8714 | Val  Acc: 0.8000
 Site-sketch                        | Val  Loss: 1.0610 | Val  Acc: 0.6500
 Site-sketch                        | Val  Loss: 1.1054 | Val  Acc: 0.6433
Average Valid Accuracy: 0.8254
 Best site-photo                     | Epoch:18 | Val Acc: 0.9900
 Best site-photo                     | Epoch:18 | Val Acc: 0.9833
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8800
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8667
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.7900
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.8000
 Best site-sketch                    | Epoch:18 | Val Acc: 0.6500
 Best site-sketch                    | Epoch:18 | Val Acc: 0.6433
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 19 ============
 Site-photo                         | Train Loss: 0.2669 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.2543 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 0.7164 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.6038 | Train Acc: 0.8867
 Site-cartoon                       | Train Loss: 0.8218 | Train Acc: 0.8067
 Site-cartoon                       | Train Loss: 0.8016 | Train Acc: 0.8156
 Site-sketch                        | Train Loss: 1.1515 | Train Acc: 0.6533
 Site-sketch                        | Train Loss: 1.1423 | Train Acc: 0.6622
Average Train Accuracy: 0.8236
 Site-photo                         | Val  Loss: 0.2493 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.2432 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.6587 | Val  Acc: 0.9100
 Site-art_painting                  | Val  Loss: 0.6902 | Val  Acc: 0.8700
 Site-cartoon                       | Val  Loss: 0.8365 | Val  Acc: 0.7900
 Site-cartoon                       | Val  Loss: 0.8270 | Val  Acc: 0.7900
 Site-sketch                        | Val  Loss: 1.0602 | Val  Acc: 0.5900
 Site-sketch                        | Val  Loss: 1.0921 | Val  Acc: 0.6533
Average Valid Accuracy: 0.8213
============ Train epoch 20 ============
 Site-photo                         | Train Loss: 0.2331 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.1996 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.6823 | Train Acc: 0.8133
 Site-art_painting                  | Train Loss: 0.6340 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.8146 | Train Acc: 0.7867
 Site-cartoon                       | Train Loss: 0.8330 | Train Acc: 0.8178
 Site-sketch                        | Train Loss: 1.1105 | Train Acc: 0.6800
 Site-sketch                        | Train Loss: 1.1381 | Train Acc: 0.6711
Average Train Accuracy: 0.8286
 Site-photo                         | Val  Loss: 0.2190 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.2207 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.6126 | Val  Acc: 0.8800
 Site-art_painting                  | Val  Loss: 0.6611 | Val  Acc: 0.8567
 Site-cartoon                       | Val  Loss: 0.8066 | Val  Acc: 0.8100
 Site-cartoon                       | Val  Loss: 0.8192 | Val  Acc: 0.8067
 Site-sketch                        | Val  Loss: 1.0334 | Val  Acc: 0.6800
 Site-sketch                        | Val  Loss: 1.1030 | Val  Acc: 0.6467
Average Valid Accuracy: 0.8325
 Best site-photo                     | Epoch:20 | Val Acc: 0.9900
 Best site-photo                     | Epoch:20 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:20 | Val Acc: 0.8800
 Best site-art_painting              | Epoch:20 | Val Acc: 0.8567
 Best site-cartoon                   | Epoch:20 | Val Acc: 0.8100
 Best site-cartoon                   | Epoch:20 | Val Acc: 0.8067
 Best site-sketch                    | Epoch:20 | Val Acc: 0.6800
 Best site-sketch                    | Epoch:20 | Val Acc: 0.6467
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 21 ============
 Site-photo                         | Train Loss: 0.2470 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.1877 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.7901 | Train Acc: 0.8067
 Site-art_painting                  | Train Loss: 0.6841 | Train Acc: 0.8844
 Site-cartoon                       | Train Loss: 0.8689 | Train Acc: 0.7933
 Site-cartoon                       | Train Loss: 0.7827 | Train Acc: 0.8244
 Site-sketch                        | Train Loss: 1.1369 | Train Acc: 0.6267
 Site-sketch                        | Train Loss: 1.0649 | Train Acc: 0.6444
Average Train Accuracy: 0.8186
 Site-photo                         | Val  Loss: 0.1822 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1839 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.6107 | Val  Acc: 0.9100
 Site-art_painting                  | Val  Loss: 0.6195 | Val  Acc: 0.8667
 Site-cartoon                       | Val  Loss: 0.8281 | Val  Acc: 0.7700
 Site-cartoon                       | Val  Loss: 0.7899 | Val  Acc: 0.7867
 Site-sketch                        | Val  Loss: 1.0078 | Val  Acc: 0.7000
 Site-sketch                        | Val  Loss: 1.0720 | Val  Acc: 0.6333
Average Valid Accuracy: 0.8325
============ Train epoch 22 ============
 Site-photo                         | Train Loss: 0.2028 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.1654 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.6973 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.5820 | Train Acc: 0.8867
 Site-cartoon                       | Train Loss: 0.8044 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.7096 | Train Acc: 0.8333
 Site-sketch                        | Train Loss: 1.1019 | Train Acc: 0.6533
 Site-sketch                        | Train Loss: 1.1063 | Train Acc: 0.6444
Average Train Accuracy: 0.8306
 Site-photo                         | Val  Loss: 0.1629 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1859 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.5642 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.6131 | Val  Acc: 0.8767
 Site-cartoon                       | Val  Loss: 0.8076 | Val  Acc: 0.7900
 Site-cartoon                       | Val  Loss: 0.7628 | Val  Acc: 0.8100
 Site-sketch                        | Val  Loss: 0.9971 | Val  Acc: 0.6400
 Site-sketch                        | Val  Loss: 1.0453 | Val  Acc: 0.6733
Average Valid Accuracy: 0.8333
 Best site-photo                     | Epoch:22 | Val Acc: 1.0000
 Best site-photo                     | Epoch:22 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:22 | Val Acc: 0.8900
 Best site-art_painting              | Epoch:22 | Val Acc: 0.8767
 Best site-cartoon                   | Epoch:22 | Val Acc: 0.7900
 Best site-cartoon                   | Epoch:22 | Val Acc: 0.8100
 Best site-sketch                    | Epoch:22 | Val Acc: 0.6400
 Best site-sketch                    | Epoch:22 | Val Acc: 0.6733
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 23 ============
 Site-photo                         | Train Loss: 0.2020 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.1617 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.7178 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.5879 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.7989 | Train Acc: 0.8200
 Site-cartoon                       | Train Loss: 0.6910 | Train Acc: 0.8333
 Site-sketch                        | Train Loss: 1.0283 | Train Acc: 0.6800
 Site-sketch                        | Train Loss: 1.1176 | Train Acc: 0.6578
Average Train Accuracy: 0.8325
 Site-photo                         | Val  Loss: 0.1536 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1531 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.5612 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.6002 | Val  Acc: 0.8633
 Site-cartoon                       | Val  Loss: 0.7892 | Val  Acc: 0.8000
 Site-cartoon                       | Val  Loss: 0.7260 | Val  Acc: 0.8433
 Site-sketch                        | Val  Loss: 0.9634 | Val  Acc: 0.6800
 Site-sketch                        | Val  Loss: 1.0585 | Val  Acc: 0.6500
Average Valid Accuracy: 0.8404
 Best site-photo                     | Epoch:23 | Val Acc: 1.0000
 Best site-photo                     | Epoch:23 | Val Acc: 0.9967
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8900
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8633
 Best site-cartoon                   | Epoch:23 | Val Acc: 0.8000
 Best site-cartoon                   | Epoch:23 | Val Acc: 0.8433
 Best site-sketch                    | Epoch:23 | Val Acc: 0.6800
 Best site-sketch                    | Epoch:23 | Val Acc: 0.6500
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 24 ============
 Site-photo                         | Train Loss: 0.1922 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.1394 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.6773 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.5488 | Train Acc: 0.8978
 Site-cartoon                       | Train Loss: 0.7291 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.7745 | Train Acc: 0.8311
 Site-sketch                        | Train Loss: 1.0463 | Train Acc: 0.6467
 Site-sketch                        | Train Loss: 1.0214 | Train Acc: 0.6533
Average Train Accuracy: 0.8361
 Site-photo                         | Val  Loss: 0.1413 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.1492 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.5775 | Val  Acc: 0.8600
 Site-art_painting                  | Val  Loss: 0.5523 | Val  Acc: 0.8733
 Site-cartoon                       | Val  Loss: 0.7537 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 0.7403 | Val  Acc: 0.8033
 Site-sketch                        | Val  Loss: 0.9863 | Val  Acc: 0.6500
 Site-sketch                        | Val  Loss: 1.0126 | Val  Acc: 0.6700
Average Valid Accuracy: 0.8346
============ Train epoch 25 ============
 Site-photo                         | Train Loss: 0.1696 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.1253 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.5956 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.5462 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.7703 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.7440 | Train Acc: 0.8333
 Site-sketch                        | Train Loss: 1.0226 | Train Acc: 0.7133
 Site-sketch                        | Train Loss: 1.0116 | Train Acc: 0.6600
Average Train Accuracy: 0.8383
 Site-photo                         | Val  Loss: 0.1351 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1493 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.5242 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.5250 | Val  Acc: 0.8833
 Site-cartoon                       | Val  Loss: 0.7516 | Val  Acc: 0.8000
 Site-cartoon                       | Val  Loss: 0.7126 | Val  Acc: 0.8200
 Site-sketch                        | Val  Loss: 0.9457 | Val  Acc: 0.7000
 Site-sketch                        | Val  Loss: 1.0096 | Val  Acc: 0.6467
Average Valid Accuracy: 0.8417
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8900
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8833
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.8000
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.8200
 Best site-sketch                    | Epoch:25 | Val Acc: 0.7000
 Best site-sketch                    | Epoch:25 | Val Acc: 0.6467
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 26 ============
 Site-photo                         | Train Loss: 0.1702 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.1131 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.6387 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.5625 | Train Acc: 0.8889
 Site-cartoon                       | Train Loss: 0.7476 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.6162 | Train Acc: 0.8467
 Site-sketch                        | Train Loss: 1.0426 | Train Acc: 0.6733
 Site-sketch                        | Train Loss: 1.1333 | Train Acc: 0.7067
Average Train Accuracy: 0.8478
 Site-photo                         | Val  Loss: 0.1099 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1291 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.5345 | Val  Acc: 0.8800
 Site-art_painting                  | Val  Loss: 0.5172 | Val  Acc: 0.8933
 Site-cartoon                       | Val  Loss: 0.7098 | Val  Acc: 0.7900
 Site-cartoon                       | Val  Loss: 0.7295 | Val  Acc: 0.8067
 Site-sketch                        | Val  Loss: 0.9046 | Val  Acc: 0.7100
 Site-sketch                        | Val  Loss: 1.0168 | Val  Acc: 0.6467
Average Valid Accuracy: 0.8396
============ Train epoch 27 ============
 Site-photo                         | Train Loss: 0.1353 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.1107 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.6873 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.5139 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.7682 | Train Acc: 0.7933
 Site-cartoon                       | Train Loss: 0.6697 | Train Acc: 0.8200
 Site-sketch                        | Train Loss: 1.0249 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.9685 | Train Acc: 0.6800
Average Train Accuracy: 0.8308
 Site-photo                         | Val  Loss: 0.1270 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1215 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.4816 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.5023 | Val  Acc: 0.8767
 Site-cartoon                       | Val  Loss: 0.6875 | Val  Acc: 0.7900
 Site-cartoon                       | Val  Loss: 0.7009 | Val  Acc: 0.8167
 Site-sketch                        | Val  Loss: 0.9424 | Val  Acc: 0.6800
 Site-sketch                        | Val  Loss: 1.0118 | Val  Acc: 0.6633
Average Valid Accuracy: 0.8433
 Best site-photo                     | Epoch:27 | Val Acc: 1.0000
 Best site-photo                     | Epoch:27 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:27 | Val Acc: 0.9300
 Best site-art_painting              | Epoch:27 | Val Acc: 0.8767
 Best site-cartoon                   | Epoch:27 | Val Acc: 0.7900
 Best site-cartoon                   | Epoch:27 | Val Acc: 0.8167
 Best site-sketch                    | Epoch:27 | Val Acc: 0.6800
 Best site-sketch                    | Epoch:27 | Val Acc: 0.6633
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 28 ============
 Site-photo                         | Train Loss: 0.1684 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.1005 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.6083 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.4752 | Train Acc: 0.8889
 Site-cartoon                       | Train Loss: 0.6834 | Train Acc: 0.8200
 Site-cartoon                       | Train Loss: 0.6351 | Train Acc: 0.8444
 Site-sketch                        | Train Loss: 1.0558 | Train Acc: 0.6800
 Site-sketch                        | Train Loss: 0.9170 | Train Acc: 0.6933
Average Train Accuracy: 0.8425
 Site-photo                         | Val  Loss: 0.1014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1057 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.5187 | Val  Acc: 0.8700
 Site-art_painting                  | Val  Loss: 0.5099 | Val  Acc: 0.8933
 Site-cartoon                       | Val  Loss: 0.7024 | Val  Acc: 0.8100
 Site-cartoon                       | Val  Loss: 0.6953 | Val  Acc: 0.8300
 Site-sketch                        | Val  Loss: 0.9165 | Val  Acc: 0.6800
 Site-sketch                        | Val  Loss: 0.9722 | Val  Acc: 0.7133
Average Valid Accuracy: 0.8488
 Best site-photo                     | Epoch:28 | Val Acc: 1.0000
 Best site-photo                     | Epoch:28 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:28 | Val Acc: 0.8700
 Best site-art_painting              | Epoch:28 | Val Acc: 0.8933
 Best site-cartoon                   | Epoch:28 | Val Acc: 0.8100
 Best site-cartoon                   | Epoch:28 | Val Acc: 0.8300
 Best site-sketch                    | Epoch:28 | Val Acc: 0.6800
 Best site-sketch                    | Epoch:28 | Val Acc: 0.7133
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 29 ============
 Site-photo                         | Train Loss: 0.1428 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.1031 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.6101 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.4646 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.6709 | Train Acc: 0.7933
 Site-cartoon                       | Train Loss: 0.6719 | Train Acc: 0.8489
 Site-sketch                        | Train Loss: 0.9947 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.9521 | Train Acc: 0.6822
Average Train Accuracy: 0.8383
 Site-photo                         | Val  Loss: 0.1004 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1195 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.4668 | Val  Acc: 0.9100
 Site-art_painting                  | Val  Loss: 0.4846 | Val  Acc: 0.8867
 Site-cartoon                       | Val  Loss: 0.6780 | Val  Acc: 0.8200
 Site-cartoon                       | Val  Loss: 0.6576 | Val  Acc: 0.8533
 Site-sketch                        | Val  Loss: 0.9013 | Val  Acc: 0.7200
 Site-sketch                        | Val  Loss: 0.9592 | Val  Acc: 0.6633
Average Valid Accuracy: 0.8550
 Best site-photo                     | Epoch:29 | Val Acc: 1.0000
 Best site-photo                     | Epoch:29 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:29 | Val Acc: 0.9100
 Best site-art_painting              | Epoch:29 | Val Acc: 0.8867
 Best site-cartoon                   | Epoch:29 | Val Acc: 0.8200
 Best site-cartoon                   | Epoch:29 | Val Acc: 0.8533
 Best site-sketch                    | Epoch:29 | Val Acc: 0.7200
 Best site-sketch                    | Epoch:29 | Val Acc: 0.6633
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 30 ============
 Site-photo                         | Train Loss: 0.1212 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.0843 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5902 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.4969 | Train Acc: 0.8822
 Site-cartoon                       | Train Loss: 0.6412 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.7430 | Train Acc: 0.8489
 Site-sketch                        | Train Loss: 1.0249 | Train Acc: 0.6600
 Site-sketch                        | Train Loss: 0.9380 | Train Acc: 0.6933
Average Train Accuracy: 0.8461
 Site-photo                         | Val  Loss: 0.0850 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0840 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.4431 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.4902 | Val  Acc: 0.8933
 Site-cartoon                       | Val  Loss: 0.7106 | Val  Acc: 0.7500
 Site-cartoon                       | Val  Loss: 0.6312 | Val  Acc: 0.8267
 Site-sketch                        | Val  Loss: 0.9182 | Val  Acc: 0.7100
 Site-sketch                        | Val  Loss: 0.9502 | Val  Acc: 0.6833
Average Valid Accuracy: 0.8479
============ Train epoch 31 ============
 Site-photo                         | Train Loss: 0.1277 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0846 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5619 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.4673 | Train Acc: 0.8778
 Site-cartoon                       | Train Loss: 0.7277 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.5939 | Train Acc: 0.8378
 Site-sketch                        | Train Loss: 1.0194 | Train Acc: 0.6733
 Site-sketch                        | Train Loss: 0.9123 | Train Acc: 0.7000
Average Train Accuracy: 0.8408
 Site-photo                         | Val  Loss: 0.0886 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0914 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4661 | Val  Acc: 0.9100
 Site-art_painting                  | Val  Loss: 0.4733 | Val  Acc: 0.8867
 Site-cartoon                       | Val  Loss: 0.6704 | Val  Acc: 0.7700
 Site-cartoon                       | Val  Loss: 0.6522 | Val  Acc: 0.8300
 Site-sketch                        | Val  Loss: 0.9144 | Val  Acc: 0.6600
 Site-sketch                        | Val  Loss: 0.9661 | Val  Acc: 0.6900
Average Valid Accuracy: 0.8413
============ Train epoch 32 ============
 Site-photo                         | Train Loss: 0.1015 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0811 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5210 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.4113 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.7034 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.6249 | Train Acc: 0.8467
 Site-sketch                        | Train Loss: 0.9833 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.9662 | Train Acc: 0.6911
Average Train Accuracy: 0.8528
 Site-photo                         | Val  Loss: 0.1145 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0803 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4449 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.4295 | Val  Acc: 0.8933
 Site-cartoon                       | Val  Loss: 0.6380 | Val  Acc: 0.8200
 Site-cartoon                       | Val  Loss: 0.6219 | Val  Acc: 0.8467
 Site-sketch                        | Val  Loss: 0.9413 | Val  Acc: 0.6600
 Site-sketch                        | Val  Loss: 0.9482 | Val  Acc: 0.7100
Average Valid Accuracy: 0.8554
 Best site-photo                     | Epoch:32 | Val Acc: 0.9900
 Best site-photo                     | Epoch:32 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:32 | Val Acc: 0.9300
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8933
 Best site-cartoon                   | Epoch:32 | Val Acc: 0.8200
 Best site-cartoon                   | Epoch:32 | Val Acc: 0.8467
 Best site-sketch                    | Epoch:32 | Val Acc: 0.6600
 Best site-sketch                    | Epoch:32 | Val Acc: 0.7100
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 33 ============
 Site-photo                         | Train Loss: 0.1262 | Train Acc: 0.9667
 Site-photo                         | Train Loss: 0.0828 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.6135 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.5632 | Train Acc: 0.9022
 Site-cartoon                       | Train Loss: 0.6736 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.6011 | Train Acc: 0.8533
 Site-sketch                        | Train Loss: 1.0048 | Train Acc: 0.6467
 Site-sketch                        | Train Loss: 0.8793 | Train Acc: 0.7089
Average Train Accuracy: 0.8422
 Site-photo                         | Val  Loss: 0.0910 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0769 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4513 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.4392 | Val  Acc: 0.9000
 Site-cartoon                       | Val  Loss: 0.6584 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 0.6066 | Val  Acc: 0.8433
 Site-sketch                        | Val  Loss: 0.8746 | Val  Acc: 0.7200
 Site-sketch                        | Val  Loss: 0.9234 | Val  Acc: 0.6867
Average Valid Accuracy: 0.8629
 Best site-photo                     | Epoch:33 | Val Acc: 0.9900
 Best site-photo                     | Epoch:33 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9300
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9000
 Best site-cartoon                   | Epoch:33 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:33 | Val Acc: 0.8433
 Best site-sketch                    | Epoch:33 | Val Acc: 0.7200
 Best site-sketch                    | Epoch:33 | Val Acc: 0.6867
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 34 ============
 Site-photo                         | Train Loss: 0.1146 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.0698 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5306 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.4747 | Train Acc: 0.8844
 Site-cartoon                       | Train Loss: 0.6787 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.5563 | Train Acc: 0.8600
 Site-sketch                        | Train Loss: 0.9994 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.9599 | Train Acc: 0.6867
Average Train Accuracy: 0.8453
 Site-photo                         | Val  Loss: 0.0933 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0679 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4284 | Val  Acc: 0.9100
 Site-art_painting                  | Val  Loss: 0.4225 | Val  Acc: 0.9100
 Site-cartoon                       | Val  Loss: 0.6043 | Val  Acc: 0.8300
 Site-cartoon                       | Val  Loss: 0.6176 | Val  Acc: 0.8400
 Site-sketch                        | Val  Loss: 0.8156 | Val  Acc: 0.7300
 Site-sketch                        | Val  Loss: 0.9208 | Val  Acc: 0.7133
Average Valid Accuracy: 0.8646
 Best site-photo                     | Epoch:34 | Val Acc: 0.9900
 Best site-photo                     | Epoch:34 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:34 | Val Acc: 0.9100
 Best site-art_painting              | Epoch:34 | Val Acc: 0.9100
 Best site-cartoon                   | Epoch:34 | Val Acc: 0.8300
 Best site-cartoon                   | Epoch:34 | Val Acc: 0.8400
 Best site-sketch                    | Epoch:34 | Val Acc: 0.7300
 Best site-sketch                    | Epoch:34 | Val Acc: 0.7133
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 35 ============
 Site-photo                         | Train Loss: 0.1068 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0730 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4825 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.4175 | Train Acc: 0.8867
 Site-cartoon                       | Train Loss: 0.6402 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.6644 | Train Acc: 0.8667
 Site-sketch                        | Train Loss: 0.9903 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.9286 | Train Acc: 0.6911
Average Train Accuracy: 0.8469
 Site-photo                         | Val  Loss: 0.0637 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0689 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4076 | Val  Acc: 0.9200
 Site-art_painting                  | Val  Loss: 0.4238 | Val  Acc: 0.8933
 Site-cartoon                       | Val  Loss: 0.5938 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 0.5910 | Val  Acc: 0.8433
 Site-sketch                        | Val  Loss: 0.8659 | Val  Acc: 0.7400
 Site-sketch                        | Val  Loss: 0.9255 | Val  Acc: 0.6833
Average Valid Accuracy: 0.8642
============ Train epoch 36 ============
 Site-photo                         | Train Loss: 0.1331 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0659 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.5521 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.3977 | Train Acc: 0.9089
 Site-cartoon                       | Train Loss: 0.6007 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.5755 | Train Acc: 0.8622
 Site-sketch                        | Train Loss: 0.9794 | Train Acc: 0.7133
 Site-sketch                        | Train Loss: 0.8511 | Train Acc: 0.6956
Average Train Accuracy: 0.8575
 Site-photo                         | Val  Loss: 0.0827 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0673 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.4028 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.4419 | Val  Acc: 0.8767
 Site-cartoon                       | Val  Loss: 0.6237 | Val  Acc: 0.8200
 Site-cartoon                       | Val  Loss: 0.6043 | Val  Acc: 0.8400
 Site-sketch                        | Val  Loss: 0.8263 | Val  Acc: 0.7100
 Site-sketch                        | Val  Loss: 0.8945 | Val  Acc: 0.7200
Average Valid Accuracy: 0.8604
============ Train epoch 37 ============
 Site-photo                         | Train Loss: 0.0804 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0753 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.5129 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.3654 | Train Acc: 0.9044
 Site-cartoon                       | Train Loss: 0.6779 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.6937 | Train Acc: 0.8644
 Site-sketch                        | Train Loss: 0.9600 | Train Acc: 0.6933
 Site-sketch                        | Train Loss: 0.9784 | Train Acc: 0.7067
Average Train Accuracy: 0.8547
 Site-photo                         | Val  Loss: 0.0710 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0675 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.3944 | Val  Acc: 0.9000
 Site-art_painting                  | Val  Loss: 0.4119 | Val  Acc: 0.8867
 Site-cartoon                       | Val  Loss: 0.5996 | Val  Acc: 0.8200
 Site-cartoon                       | Val  Loss: 0.5684 | Val  Acc: 0.8533
 Site-sketch                        | Val  Loss: 0.8340 | Val  Acc: 0.7300
 Site-sketch                        | Val  Loss: 0.8936 | Val  Acc: 0.7367
Average Valid Accuracy: 0.8646
============ Train epoch 38 ============
 Site-photo                         | Train Loss: 0.0880 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0616 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5136 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.3686 | Train Acc: 0.9022
 Site-cartoon                       | Train Loss: 0.6546 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.5280 | Train Acc: 0.8578
 Site-sketch                        | Train Loss: 0.8950 | Train Acc: 0.7600
 Site-sketch                        | Train Loss: 0.8361 | Train Acc: 0.6978
Average Train Accuracy: 0.8611
 Site-photo                         | Val  Loss: 0.0591 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0625 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4160 | Val  Acc: 0.9000
 Site-art_painting                  | Val  Loss: 0.3858 | Val  Acc: 0.9033
 Site-cartoon                       | Val  Loss: 0.6082 | Val  Acc: 0.8100
 Site-cartoon                       | Val  Loss: 0.5560 | Val  Acc: 0.8533
 Site-sketch                        | Val  Loss: 0.8223 | Val  Acc: 0.7500
 Site-sketch                        | Val  Loss: 0.8813 | Val  Acc: 0.7100
Average Valid Accuracy: 0.8650
 Best site-photo                     | Epoch:38 | Val Acc: 1.0000
 Best site-photo                     | Epoch:38 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:38 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:38 | Val Acc: 0.9033
 Best site-cartoon                   | Epoch:38 | Val Acc: 0.8100
 Best site-cartoon                   | Epoch:38 | Val Acc: 0.8533
 Best site-sketch                    | Epoch:38 | Val Acc: 0.7500
 Best site-sketch                    | Epoch:38 | Val Acc: 0.7100
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 39 ============
 Site-photo                         | Train Loss: 0.0911 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0536 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.5524 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.3626 | Train Acc: 0.8978
 Site-cartoon                       | Train Loss: 0.6001 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.4898 | Train Acc: 0.8689
 Site-sketch                        | Train Loss: 0.9357 | Train Acc: 0.7000
 Site-sketch                        | Train Loss: 0.8810 | Train Acc: 0.7178
Average Train Accuracy: 0.8608
 Site-photo                         | Val  Loss: 0.0605 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0629 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.4057 | Val  Acc: 0.9400
 Site-art_painting                  | Val  Loss: 0.3602 | Val  Acc: 0.9100
 Site-cartoon                       | Val  Loss: 0.5879 | Val  Acc: 0.8700
 Site-cartoon                       | Val  Loss: 0.5729 | Val  Acc: 0.8433
 Site-sketch                        | Val  Loss: 0.8208 | Val  Acc: 0.7500
 Site-sketch                        | Val  Loss: 0.8690 | Val  Acc: 0.7333
Average Valid Accuracy: 0.8783
 Best site-photo                     | Epoch:39 | Val Acc: 0.9900
 Best site-photo                     | Epoch:39 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:39 | Val Acc: 0.9400
 Best site-art_painting              | Epoch:39 | Val Acc: 0.9100
 Best site-cartoon                   | Epoch:39 | Val Acc: 0.8700
 Best site-cartoon                   | Epoch:39 | Val Acc: 0.8433
 Best site-sketch                    | Epoch:39 | Val Acc: 0.7500
 Best site-sketch                    | Epoch:39 | Val Acc: 0.7333
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedmix...
============ Train epoch 40 ============
 Site-photo                         | Train Loss: 0.0671 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0559 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4979 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.5501 | Train Acc: 0.8978
 Site-cartoon                       | Train Loss: 0.6829 | Train Acc: 0.7933
 Site-cartoon                       | Train Loss: 0.4842 | Train Acc: 0.8733
 Site-sketch                        | Train Loss: 0.9308 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.7690 | Train Acc: 0.7156
Average Train Accuracy: 0.8561
 Site-photo                         | Val  Loss: 0.0433 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0682 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.3413 | Val  Acc: 0.9200
 Site-art_painting                  | Val  Loss: 0.3987 | Val  Acc: 0.9133
 Site-cartoon                       | Val  Loss: 0.6109 | Val  Acc: 0.8000
 Site-cartoon                       | Val  Loss: 0.5979 | Val  Acc: 0.8300
 Site-sketch                        | Val  Loss: 0.7680 | Val  Acc: 0.7500
 Site-sketch                        | Val  Loss: 0.8816 | Val  Acc: 0.7300
Average Valid Accuracy: 0.8667
============ Train epoch 41 ============
 Site-photo                         | Train Loss: 0.1042 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.0573 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5068 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.4312 | Train Acc: 0.9044
 Site-cartoon                       | Train Loss: 0.5750 | Train Acc: 0.8000
 Site-cartoon                       | Train Loss: 0.5567 | Train Acc: 0.8467
 Site-sketch                        | Train Loss: 0.9145 | Train Acc: 0.7133
 Site-sketch                        | Train Loss: 0.9675 | Train Acc: 0.7333
Average Train Accuracy: 0.8511
 Site-photo                         | Val  Loss: 0.0539 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0506 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.3601 | Val  Acc: 0.9100
 Site-art_painting                  | Val  Loss: 0.3903 | Val  Acc: 0.9033
 Site-cartoon                       | Val  Loss: 0.5793 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 0.5531 | Val  Acc: 0.8300
 Site-sketch                        | Val  Loss: 0.8406 | Val  Acc: 0.7300
 Site-sketch                        | Val  Loss: 0.8686 | Val  Acc: 0.7533
Average Valid Accuracy: 0.8696
============ Train epoch 42 ============
 Site-photo                         | Train Loss: 0.1164 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0441 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4559 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.3987 | Train Acc: 0.9067
 Site-cartoon                       | Train Loss: 0.5571 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.4817 | Train Acc: 0.8822
 Site-sketch                        | Train Loss: 0.9260 | Train Acc: 0.7000
 Site-sketch                        | Train Loss: 0.7851 | Train Acc: 0.7111
Average Train Accuracy: 0.8653
 Site-photo                         | Val  Loss: 0.0434 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0447 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.4140 | Val  Acc: 0.9000
 Site-art_painting                  | Val  Loss: 0.3459 | Val  Acc: 0.9267
 Site-cartoon                       | Val  Loss: 0.5843 | Val  Acc: 0.8200
 Site-cartoon                       | Val  Loss: 0.5423 | Val  Acc: 0.8700
 Site-sketch                        | Val  Loss: 0.8001 | Val  Acc: 0.7200
 Site-sketch                        | Val  Loss: 0.8369 | Val  Acc: 0.7433
Average Valid Accuracy: 0.8721
============ Train epoch 43 ============
 Site-photo                         | Train Loss: 0.1036 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0479 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.6106 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.4453 | Train Acc: 0.9089
 Site-cartoon                       | Train Loss: 0.5726 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.5501 | Train Acc: 0.8467
 Site-sketch                        | Train Loss: 0.8383 | Train Acc: 0.7400
 Site-sketch                        | Train Loss: 0.8667 | Train Acc: 0.7289
Average Train Accuracy: 0.8614
 Site-photo                         | Val  Loss: 0.0574 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0562 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.3300 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.3853 | Val  Acc: 0.9067
 Site-cartoon                       | Val  Loss: 0.5993 | Val  Acc: 0.8200
 Site-cartoon                       | Val  Loss: 0.5498 | Val  Acc: 0.8333
 Site-sketch                        | Val  Loss: 0.8327 | Val  Acc: 0.7300
 Site-sketch                        | Val  Loss: 0.8762 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8625
============ Train epoch 44 ============
 Site-photo                         | Train Loss: 0.0682 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0511 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.5250 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.3562 | Train Acc: 0.8978
 Site-cartoon                       | Train Loss: 0.5610 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.4769 | Train Acc: 0.8689
 Site-sketch                        | Train Loss: 0.8527 | Train Acc: 0.7200
 Site-sketch                        | Train Loss: 0.8308 | Train Acc: 0.7356
Average Train Accuracy: 0.8631
 Site-photo                         | Val  Loss: 0.0667 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0538 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.3228 | Val  Acc: 0.9200
 Site-art_painting                  | Val  Loss: 0.3575 | Val  Acc: 0.9100
 Site-cartoon                       | Val  Loss: 0.5794 | Val  Acc: 0.8600
 Site-cartoon                       | Val  Loss: 0.5583 | Val  Acc: 0.8500
 Site-sketch                        | Val  Loss: 0.7973 | Val  Acc: 0.7500
 Site-sketch                        | Val  Loss: 0.8597 | Val  Acc: 0.7133
Average Valid Accuracy: 0.8729
============ Train epoch 45 ============
 Site-photo                         | Train Loss: 0.0905 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0517 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4626 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.3321 | Train Acc: 0.9022
 Site-cartoon                       | Train Loss: 0.5796 | Train Acc: 0.8067
 Site-cartoon                       | Train Loss: 0.5544 | Train Acc: 0.8578
 Site-sketch                        | Train Loss: 0.9181 | Train Acc: 0.6933
 Site-sketch                        | Train Loss: 0.8781 | Train Acc: 0.7067
Average Train Accuracy: 0.8478
 Site-photo                         | Val  Loss: 0.0557 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0551 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.3314 | Val  Acc: 0.9400
 Site-art_painting                  | Val  Loss: 0.3576 | Val  Acc: 0.9167
 Site-cartoon                       | Val  Loss: 0.5506 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 0.5323 | Val  Acc: 0.8533
 Site-sketch                        | Val  Loss: 0.8106 | Val  Acc: 0.7200
 Site-sketch                        | Val  Loss: 0.8843 | Val  Acc: 0.7067
Average Valid Accuracy: 0.8696
============ Train epoch 46 ============
 Site-photo                         | Train Loss: 0.0676 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0441 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4640 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.4233 | Train Acc: 0.9111
 Site-cartoon                       | Train Loss: 0.5677 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.4647 | Train Acc: 0.8800
 Site-sketch                        | Train Loss: 0.8218 | Train Acc: 0.7333
 Site-sketch                        | Train Loss: 0.8853 | Train Acc: 0.7333
Average Train Accuracy: 0.8675
 Site-photo                         | Val  Loss: 0.0336 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0465 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.3298 | Val  Acc: 0.9500
 Site-art_painting                  | Val  Loss: 0.3588 | Val  Acc: 0.9233
 Site-cartoon                       | Val  Loss: 0.5644 | Val  Acc: 0.8000
 Site-cartoon                       | Val  Loss: 0.5531 | Val  Acc: 0.8533
 Site-sketch                        | Val  Loss: 0.7539 | Val  Acc: 0.7600
 Site-sketch                        | Val  Loss: 0.8430 | Val  Acc: 0.7200
Average Valid Accuracy: 0.8750
============ Train epoch 47 ============
 Site-photo                         | Train Loss: 0.0987 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0455 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.4355 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.3379 | Train Acc: 0.9067
 Site-cartoon                       | Train Loss: 0.5208 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.5967 | Train Acc: 0.8644
 Site-sketch                        | Train Loss: 0.8969 | Train Acc: 0.7133
 Site-sketch                        | Train Loss: 0.9238 | Train Acc: 0.7467
Average Train Accuracy: 0.8667
 Site-photo                         | Val  Loss: 0.0360 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0561 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.3207 | Val  Acc: 0.9600
 Site-art_painting                  | Val  Loss: 0.3390 | Val  Acc: 0.9167
 Site-cartoon                       | Val  Loss: 0.5133 | Val  Acc: 0.8300
 Site-cartoon                       | Val  Loss: 0.5238 | Val  Acc: 0.8433
 Site-sketch                        | Val  Loss: 0.7473 | Val  Acc: 0.7000
 Site-sketch                        | Val  Loss: 0.8236 | Val  Acc: 0.7300
Average Valid Accuracy: 0.8708
============ Train epoch 48 ============
 Site-photo                         | Train Loss: 0.0827 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0373 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.5403 | Train Acc: 0.8267
 Site-art_painting                  | Train Loss: 0.3258 | Train Acc: 0.9200
 Site-cartoon                       | Train Loss: 0.5759 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.4721 | Train Acc: 0.8756
 Site-sketch                        | Train Loss: 0.9138 | Train Acc: 0.6800
 Site-sketch                        | Train Loss: 0.7451 | Train Acc: 0.7200
Average Train Accuracy: 0.8553
 Site-photo                         | Val  Loss: 0.0329 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0426 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.3332 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.3311 | Val  Acc: 0.9067
 Site-cartoon                       | Val  Loss: 0.5210 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 0.5094 | Val  Acc: 0.8633
 Site-sketch                        | Val  Loss: 0.8153 | Val  Acc: 0.7500
 Site-sketch                        | Val  Loss: 0.8276 | Val  Acc: 0.7167
Average Valid Accuracy: 0.8762
============ Train epoch 49 ============
 Site-photo                         | Train Loss: 0.1004 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0387 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4473 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.3294 | Train Acc: 0.8956
 Site-cartoon                       | Train Loss: 0.5747 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.4614 | Train Acc: 0.8622
 Site-sketch                        | Train Loss: 0.8945 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 0.8897 | Train Acc: 0.7089
Average Train Accuracy: 0.8506
 Site-photo                         | Val  Loss: 0.0331 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0406 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.2856 | Val  Acc: 0.9600
 Site-art_painting                  | Val  Loss: 0.3425 | Val  Acc: 0.9133
 Site-cartoon                       | Val  Loss: 0.5264 | Val  Acc: 0.8100
 Site-cartoon                       | Val  Loss: 0.5168 | Val  Acc: 0.8433
 Site-sketch                        | Val  Loss: 0.7869 | Val  Acc: 0.7700
 Site-sketch                        | Val  Loss: 0.8259 | Val  Acc: 0.7033
Average Valid Accuracy: 0.8746
===2023-08-08 02:23:02===
===2023-08-08 02:23:17===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
Loading snapshots...
 Test site-photo                     (1)| Epoch:39 | Test Acc: 0.9985
 Test site-art_painting              (3)| Epoch:39 | Test Acc: 0.9001
 Test site-cartoon                   (2)| Epoch:39 | Test Acc: 0.8330
 Test site-sketch                    (0)| Epoch:39 | Test Acc: 0.6836
photo: 0.9985, art_painting: 0.9001, cartoon: 0.8330, sketch: 0.6836, 
Average Test Accuracy(group): 0.8538, Average Test Accuracy(individual): 0.8538,
domain std=0.1145, cluster std=0.1145, individual std=0.1145, 
