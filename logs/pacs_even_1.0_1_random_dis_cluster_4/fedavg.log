===2023-08-08 00:18:53===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
============ Train epoch 0 ============
 Site-photo                         | Train Loss: 1.7998 | Train Acc: 0.6400
 Site-photo                         | Train Loss: 1.7964 | Train Acc: 0.6289
 Site-art_painting                  | Train Loss: 1.8497 | Train Acc: 0.4067
 Site-art_painting                  | Train Loss: 1.8311 | Train Acc: 0.4044
 Site-cartoon                       | Train Loss: 1.8641 | Train Acc: 0.3733
 Site-cartoon                       | Train Loss: 1.8541 | Train Acc: 0.3956
 Site-sketch                        | Train Loss: 1.8484 | Train Acc: 0.2533
 Site-sketch                        | Train Loss: 1.8640 | Train Acc: 0.2844
Average Train Accuracy: 0.4233
 Site-photo                         | Val  Loss: 1.8173 | Val  Acc: 0.5000
 Site-photo                         | Val  Loss: 1.8034 | Val  Acc: 0.6567
 Site-art_painting                  | Val  Loss: 1.8410 | Val  Acc: 0.4400
 Site-art_painting                  | Val  Loss: 1.8452 | Val  Acc: 0.4133
 Site-cartoon                       | Val  Loss: 1.8577 | Val  Acc: 0.4200
 Site-cartoon                       | Val  Loss: 1.8622 | Val  Acc: 0.4167
 Site-sketch                        | Val  Loss: 1.8401 | Val  Acc: 0.2800
 Site-sketch                        | Val  Loss: 1.8487 | Val  Acc: 0.2567
Average Valid Accuracy: 0.4229
 Best site-photo                     | Epoch:0 | Val Acc: 0.5000
 Best site-photo                     | Epoch:0 | Val Acc: 0.6567
 Best site-art_painting              | Epoch:0 | Val Acc: 0.4400
 Best site-art_painting              | Epoch:0 | Val Acc: 0.4133
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.4200
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.4167
 Best site-sketch                    | Epoch:0 | Val Acc: 0.2800
 Best site-sketch                    | Epoch:0 | Val Acc: 0.2567
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 1 ============
 Site-photo                         | Train Loss: 1.6704 | Train Acc: 0.9267
 Site-photo                         | Train Loss: 1.6598 | Train Acc: 0.9422
 Site-art_painting                  | Train Loss: 1.7540 | Train Acc: 0.6333
 Site-art_painting                  | Train Loss: 1.7471 | Train Acc: 0.6111
 Site-cartoon                       | Train Loss: 1.7646 | Train Acc: 0.5733
 Site-cartoon                       | Train Loss: 1.7667 | Train Acc: 0.5444
 Site-sketch                        | Train Loss: 1.7657 | Train Acc: 0.4200
 Site-sketch                        | Train Loss: 1.7606 | Train Acc: 0.3644
Average Train Accuracy: 0.6269
 Site-photo                         | Val  Loss: 1.6710 | Val  Acc: 0.9400
 Site-photo                         | Val  Loss: 1.6599 | Val  Acc: 0.9433
 Site-art_painting                  | Val  Loss: 1.7488 | Val  Acc: 0.6300
 Site-art_painting                  | Val  Loss: 1.7462 | Val  Acc: 0.6167
 Site-cartoon                       | Val  Loss: 1.7643 | Val  Acc: 0.5200
 Site-cartoon                       | Val  Loss: 1.7658 | Val  Acc: 0.5400
 Site-sketch                        | Val  Loss: 1.7750 | Val  Acc: 0.2500
 Site-sketch                        | Val  Loss: 1.7728 | Val  Acc: 0.3667
Average Valid Accuracy: 0.6008
 Best site-photo                     | Epoch:1 | Val Acc: 0.9400
 Best site-photo                     | Epoch:1 | Val Acc: 0.9433
 Best site-art_painting              | Epoch:1 | Val Acc: 0.6300
 Best site-art_painting              | Epoch:1 | Val Acc: 0.6167
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.5200
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.5400
 Best site-sketch                    | Epoch:1 | Val Acc: 0.2500
 Best site-sketch                    | Epoch:1 | Val Acc: 0.3667
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 2 ============
 Site-photo                         | Train Loss: 1.5305 | Train Acc: 0.9600
 Site-photo                         | Train Loss: 1.4948 | Train Acc: 0.9778
 Site-art_painting                  | Train Loss: 1.6524 | Train Acc: 0.6933
 Site-art_painting                  | Train Loss: 1.6635 | Train Acc: 0.7156
 Site-cartoon                       | Train Loss: 1.6586 | Train Acc: 0.6600
 Site-cartoon                       | Train Loss: 1.6776 | Train Acc: 0.6444
 Site-sketch                        | Train Loss: 1.7088 | Train Acc: 0.4733
 Site-sketch                        | Train Loss: 1.7010 | Train Acc: 0.4244
Average Train Accuracy: 0.6936
 Site-photo                         | Val  Loss: 1.5277 | Val  Acc: 0.9700
 Site-photo                         | Val  Loss: 1.5143 | Val  Acc: 0.9733
 Site-art_painting                  | Val  Loss: 1.6353 | Val  Acc: 0.7700
 Site-art_painting                  | Val  Loss: 1.6507 | Val  Acc: 0.7233
 Site-cartoon                       | Val  Loss: 1.6737 | Val  Acc: 0.6100
 Site-cartoon                       | Val  Loss: 1.6776 | Val  Acc: 0.6367
 Site-sketch                        | Val  Loss: 1.6927 | Val  Acc: 0.4300
 Site-sketch                        | Val  Loss: 1.7010 | Val  Acc: 0.4467
Average Valid Accuracy: 0.6950
 Best site-photo                     | Epoch:2 | Val Acc: 0.9700
 Best site-photo                     | Epoch:2 | Val Acc: 0.9733
 Best site-art_painting              | Epoch:2 | Val Acc: 0.7700
 Best site-art_painting              | Epoch:2 | Val Acc: 0.7233
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.6100
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.6367
 Best site-sketch                    | Epoch:2 | Val Acc: 0.4300
 Best site-sketch                    | Epoch:2 | Val Acc: 0.4467
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 3 ============
 Site-photo                         | Train Loss: 1.3867 | Train Acc: 0.9533
 Site-photo                         | Train Loss: 1.3734 | Train Acc: 0.9822
 Site-art_painting                  | Train Loss: 1.5751 | Train Acc: 0.7067
 Site-art_painting                  | Train Loss: 1.5779 | Train Acc: 0.7378
 Site-cartoon                       | Train Loss: 1.6215 | Train Acc: 0.6467
 Site-cartoon                       | Train Loss: 1.6071 | Train Acc: 0.6622
 Site-sketch                        | Train Loss: 1.6300 | Train Acc: 0.5000
 Site-sketch                        | Train Loss: 1.6352 | Train Acc: 0.4533
Average Train Accuracy: 0.7053
 Site-photo                         | Val  Loss: 1.3972 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 1.3774 | Val  Acc: 0.9700
 Site-art_painting                  | Val  Loss: 1.5611 | Val  Acc: 0.7200
 Site-art_painting                  | Val  Loss: 1.5566 | Val  Acc: 0.7733
 Site-cartoon                       | Val  Loss: 1.6055 | Val  Acc: 0.6300
 Site-cartoon                       | Val  Loss: 1.5906 | Val  Acc: 0.6733
 Site-sketch                        | Val  Loss: 1.6142 | Val  Acc: 0.4900
 Site-sketch                        | Val  Loss: 1.6453 | Val  Acc: 0.4633
Average Valid Accuracy: 0.7137
 Best site-photo                     | Epoch:3 | Val Acc: 0.9900
 Best site-photo                     | Epoch:3 | Val Acc: 0.9700
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7200
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7733
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.6300
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.6733
 Best site-sketch                    | Epoch:3 | Val Acc: 0.4900
 Best site-sketch                    | Epoch:3 | Val Acc: 0.4633
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 4 ============
 Site-photo                         | Train Loss: 1.2752 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 1.2592 | Train Acc: 0.9822
 Site-art_painting                  | Train Loss: 1.5341 | Train Acc: 0.7200
 Site-art_painting                  | Train Loss: 1.5047 | Train Acc: 0.7867
 Site-cartoon                       | Train Loss: 1.5587 | Train Acc: 0.7133
 Site-cartoon                       | Train Loss: 1.4801 | Train Acc: 0.7178
 Site-sketch                        | Train Loss: 1.6002 | Train Acc: 0.4733
 Site-sketch                        | Train Loss: 1.5901 | Train Acc: 0.4822
Average Train Accuracy: 0.7311
 Site-photo                         | Val  Loss: 1.2638 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 1.2460 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 1.4675 | Val  Acc: 0.8200
 Site-art_painting                  | Val  Loss: 1.4728 | Val  Acc: 0.7833
 Site-cartoon                       | Val  Loss: 1.5190 | Val  Acc: 0.6500
 Site-cartoon                       | Val  Loss: 1.5173 | Val  Acc: 0.7000
 Site-sketch                        | Val  Loss: 1.5634 | Val  Acc: 0.5000
 Site-sketch                        | Val  Loss: 1.5901 | Val  Acc: 0.4967
Average Valid Accuracy: 0.7388
 Best site-photo                     | Epoch:4 | Val Acc: 0.9800
 Best site-photo                     | Epoch:4 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:4 | Val Acc: 0.8200
 Best site-art_painting              | Epoch:4 | Val Acc: 0.7833
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.6500
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.7000
 Best site-sketch                    | Epoch:4 | Val Acc: 0.5000
 Best site-sketch                    | Epoch:4 | Val Acc: 0.4967
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 5 ============
 Site-photo                         | Train Loss: 1.1630 | Train Acc: 0.9667
 Site-photo                         | Train Loss: 1.1208 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 1.4119 | Train Acc: 0.7333
 Site-art_painting                  | Train Loss: 1.3603 | Train Acc: 0.8067
 Site-cartoon                       | Train Loss: 1.4489 | Train Acc: 0.7467
 Site-cartoon                       | Train Loss: 1.4568 | Train Acc: 0.7467
 Site-sketch                        | Train Loss: 1.5502 | Train Acc: 0.5333
 Site-sketch                        | Train Loss: 1.5711 | Train Acc: 0.5222
Average Train Accuracy: 0.7550
 Site-photo                         | Val  Loss: 1.1382 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 1.1249 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 1.3951 | Val  Acc: 0.8200
 Site-art_painting                  | Val  Loss: 1.3861 | Val  Acc: 0.7800
 Site-cartoon                       | Val  Loss: 1.4733 | Val  Acc: 0.6900
 Site-cartoon                       | Val  Loss: 1.4416 | Val  Acc: 0.6967
 Site-sketch                        | Val  Loss: 1.5084 | Val  Acc: 0.5000
 Site-sketch                        | Val  Loss: 1.5337 | Val  Acc: 0.5033
Average Valid Accuracy: 0.7463
 Best site-photo                     | Epoch:5 | Val Acc: 0.9900
 Best site-photo                     | Epoch:5 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8200
 Best site-art_painting              | Epoch:5 | Val Acc: 0.7800
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.6900
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.6967
 Best site-sketch                    | Epoch:5 | Val Acc: 0.5000
 Best site-sketch                    | Epoch:5 | Val Acc: 0.5033
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 6 ============
 Site-photo                         | Train Loss: 1.0440 | Train Acc: 0.9667
 Site-photo                         | Train Loss: 1.0828 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 1.3178 | Train Acc: 0.7467
 Site-art_painting                  | Train Loss: 1.2854 | Train Acc: 0.8044
 Site-cartoon                       | Train Loss: 1.3826 | Train Acc: 0.7600
 Site-cartoon                       | Train Loss: 1.3776 | Train Acc: 0.7444
 Site-sketch                        | Train Loss: 1.5185 | Train Acc: 0.5400
 Site-sketch                        | Train Loss: 1.5133 | Train Acc: 0.5200
Average Train Accuracy: 0.7589
 Site-photo                         | Val  Loss: 1.0287 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 1.0041 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 1.3211 | Val  Acc: 0.7900
 Site-art_painting                  | Val  Loss: 1.3107 | Val  Acc: 0.8033
 Site-cartoon                       | Val  Loss: 1.4051 | Val  Acc: 0.7600
 Site-cartoon                       | Val  Loss: 1.3683 | Val  Acc: 0.7667
 Site-sketch                        | Val  Loss: 1.4618 | Val  Acc: 0.5600
 Site-sketch                        | Val  Loss: 1.4876 | Val  Acc: 0.5433
Average Valid Accuracy: 0.7750
 Best site-photo                     | Epoch:6 | Val Acc: 0.9900
 Best site-photo                     | Epoch:6 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7900
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8033
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.7600
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.7667
 Best site-sketch                    | Epoch:6 | Val Acc: 0.5600
 Best site-sketch                    | Epoch:6 | Val Acc: 0.5433
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 7 ============
 Site-photo                         | Train Loss: 0.9539 | Train Acc: 0.9667
 Site-photo                         | Train Loss: 0.9382 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 1.2951 | Train Acc: 0.7667
 Site-art_painting                  | Train Loss: 1.2317 | Train Acc: 0.8289
 Site-cartoon                       | Train Loss: 1.3925 | Train Acc: 0.7600
 Site-cartoon                       | Train Loss: 1.2894 | Train Acc: 0.7400
 Site-sketch                        | Train Loss: 1.4581 | Train Acc: 0.5533
 Site-sketch                        | Train Loss: 1.4391 | Train Acc: 0.5622
Average Train Accuracy: 0.7708
 Site-photo                         | Val  Loss: 0.9191 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.9048 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 1.2356 | Val  Acc: 0.7900
 Site-art_painting                  | Val  Loss: 1.2359 | Val  Acc: 0.7933
 Site-cartoon                       | Val  Loss: 1.3347 | Val  Acc: 0.6900
 Site-cartoon                       | Val  Loss: 1.2942 | Val  Acc: 0.7667
 Site-sketch                        | Val  Loss: 1.4170 | Val  Acc: 0.5900
 Site-sketch                        | Val  Loss: 1.4427 | Val  Acc: 0.5567
Average Valid Accuracy: 0.7704
============ Train epoch 8 ============
 Site-photo                         | Train Loss: 0.8732 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.7867 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 1.2151 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 1.1932 | Train Acc: 0.8422
 Site-cartoon                       | Train Loss: 1.2801 | Train Acc: 0.7467
 Site-cartoon                       | Train Loss: 1.2682 | Train Acc: 0.7867
 Site-sketch                        | Train Loss: 1.4360 | Train Acc: 0.5533
 Site-sketch                        | Train Loss: 1.4156 | Train Acc: 0.5622
Average Train Accuracy: 0.7839
 Site-photo                         | Val  Loss: 0.8250 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.7979 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 1.1985 | Val  Acc: 0.7600
 Site-art_painting                  | Val  Loss: 1.1605 | Val  Acc: 0.8367
 Site-cartoon                       | Val  Loss: 1.2463 | Val  Acc: 0.7400
 Site-cartoon                       | Val  Loss: 1.2458 | Val  Acc: 0.7867
 Site-sketch                        | Val  Loss: 1.3854 | Val  Acc: 0.5200
 Site-sketch                        | Val  Loss: 1.4056 | Val  Acc: 0.5500
Average Valid Accuracy: 0.7704
============ Train epoch 9 ============
 Site-photo                         | Train Loss: 0.7533 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.7247 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 1.1312 | Train Acc: 0.8067
 Site-art_painting                  | Train Loss: 1.0827 | Train Acc: 0.8222
 Site-cartoon                       | Train Loss: 1.2173 | Train Acc: 0.7400
 Site-cartoon                       | Train Loss: 1.1842 | Train Acc: 0.7822
 Site-sketch                        | Train Loss: 1.4018 | Train Acc: 0.5733
 Site-sketch                        | Train Loss: 1.3591 | Train Acc: 0.5533
Average Train Accuracy: 0.7797
 Site-photo                         | Val  Loss: 0.7308 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.7234 | Val  Acc: 0.9833
 Site-art_painting                  | Val  Loss: 1.1358 | Val  Acc: 0.8000
 Site-art_painting                  | Val  Loss: 1.0978 | Val  Acc: 0.8300
 Site-cartoon                       | Val  Loss: 1.2042 | Val  Acc: 0.7800
 Site-cartoon                       | Val  Loss: 1.1954 | Val  Acc: 0.7667
 Site-sketch                        | Val  Loss: 1.3156 | Val  Acc: 0.5600
 Site-sketch                        | Val  Loss: 1.3647 | Val  Acc: 0.5567
Average Valid Accuracy: 0.7821
 Best site-photo                     | Epoch:9 | Val Acc: 0.9800
 Best site-photo                     | Epoch:9 | Val Acc: 0.9833
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8000
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8300
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.7800
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.7667
 Best site-sketch                    | Epoch:9 | Val Acc: 0.5600
 Best site-sketch                    | Epoch:9 | Val Acc: 0.5567
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 10 ============
 Site-photo                         | Train Loss: 0.6782 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.6563 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 1.1111 | Train Acc: 0.7667
 Site-art_painting                  | Train Loss: 1.0119 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 1.1862 | Train Acc: 0.7533
 Site-cartoon                       | Train Loss: 1.0998 | Train Acc: 0.8000
 Site-sketch                        | Train Loss: 1.3626 | Train Acc: 0.6067
 Site-sketch                        | Train Loss: 1.4161 | Train Acc: 0.5956
Average Train Accuracy: 0.7925
 Site-photo                         | Val  Loss: 0.6667 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.6585 | Val  Acc: 0.9833
 Site-art_painting                  | Val  Loss: 1.0483 | Val  Acc: 0.8100
 Site-art_painting                  | Val  Loss: 1.0135 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 1.1426 | Val  Acc: 0.7900
 Site-cartoon                       | Val  Loss: 1.1343 | Val  Acc: 0.7867
 Site-sketch                        | Val  Loss: 1.2920 | Val  Acc: 0.5300
 Site-sketch                        | Val  Loss: 1.3278 | Val  Acc: 0.5967
Average Valid Accuracy: 0.7908
 Best site-photo                     | Epoch:10 | Val Acc: 0.9800
 Best site-photo                     | Epoch:10 | Val Acc: 0.9833
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8100
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8500
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.7900
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.7867
 Best site-sketch                    | Epoch:10 | Val Acc: 0.5300
 Best site-sketch                    | Epoch:10 | Val Acc: 0.5967
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 11 ============
 Site-photo                         | Train Loss: 0.6330 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.5467 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.9802 | Train Acc: 0.8267
 Site-art_painting                  | Train Loss: 1.0245 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 1.1578 | Train Acc: 0.7733
 Site-cartoon                       | Train Loss: 1.0274 | Train Acc: 0.7933
 Site-sketch                        | Train Loss: 1.3901 | Train Acc: 0.5733
 Site-sketch                        | Train Loss: 1.3145 | Train Acc: 0.6022
Average Train Accuracy: 0.8011
 Site-photo                         | Val  Loss: 0.6000 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.5773 | Val  Acc: 0.9800
 Site-art_painting                  | Val  Loss: 0.9650 | Val  Acc: 0.8700
 Site-art_painting                  | Val  Loss: 0.9663 | Val  Acc: 0.8533
 Site-cartoon                       | Val  Loss: 1.0838 | Val  Acc: 0.8000
 Site-cartoon                       | Val  Loss: 1.1075 | Val  Acc: 0.7700
 Site-sketch                        | Val  Loss: 1.2300 | Val  Acc: 0.6300
 Site-sketch                        | Val  Loss: 1.2880 | Val  Acc: 0.5900
Average Valid Accuracy: 0.8092
 Best site-photo                     | Epoch:11 | Val Acc: 0.9800
 Best site-photo                     | Epoch:11 | Val Acc: 0.9800
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8700
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8533
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.8000
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.7700
 Best site-sketch                    | Epoch:11 | Val Acc: 0.6300
 Best site-sketch                    | Epoch:11 | Val Acc: 0.5900
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 12 ============
 Site-photo                         | Train Loss: 0.5601 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.5020 | Train Acc: 0.9822
 Site-art_painting                  | Train Loss: 0.9834 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.9162 | Train Acc: 0.8511
 Site-cartoon                       | Train Loss: 1.0694 | Train Acc: 0.7600
 Site-cartoon                       | Train Loss: 1.0603 | Train Acc: 0.7911
 Site-sketch                        | Train Loss: 1.2730 | Train Acc: 0.5667
 Site-sketch                        | Train Loss: 1.2843 | Train Acc: 0.5800
Average Train Accuracy: 0.7931
 Site-photo                         | Val  Loss: 0.4998 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.5180 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.9579 | Val  Acc: 0.8200
 Site-art_painting                  | Val  Loss: 0.9393 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 1.0801 | Val  Acc: 0.7900
 Site-cartoon                       | Val  Loss: 1.0511 | Val  Acc: 0.7833
 Site-sketch                        | Val  Loss: 1.2393 | Val  Acc: 0.5500
 Site-sketch                        | Val  Loss: 1.2498 | Val  Acc: 0.5967
Average Valid Accuracy: 0.7950
============ Train epoch 13 ============
 Site-photo                         | Train Loss: 0.4996 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.4479 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.9594 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.8218 | Train Acc: 0.8556
 Site-cartoon                       | Train Loss: 1.0521 | Train Acc: 0.7933
 Site-cartoon                       | Train Loss: 1.0184 | Train Acc: 0.7756
 Site-sketch                        | Train Loss: 1.2805 | Train Acc: 0.5600
 Site-sketch                        | Train Loss: 1.1562 | Train Acc: 0.5978
Average Train Accuracy: 0.7964
 Site-photo                         | Val  Loss: 0.4529 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.4456 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.8786 | Val  Acc: 0.8700
 Site-art_painting                  | Val  Loss: 0.8599 | Val  Acc: 0.8633
 Site-cartoon                       | Val  Loss: 1.0219 | Val  Acc: 0.7000
 Site-cartoon                       | Val  Loss: 1.0134 | Val  Acc: 0.7867
 Site-sketch                        | Val  Loss: 1.1772 | Val  Acc: 0.6000
 Site-sketch                        | Val  Loss: 1.2152 | Val  Acc: 0.6400
Average Valid Accuracy: 0.8046
============ Train epoch 14 ============
 Site-photo                         | Train Loss: 0.4327 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.3904 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 0.8789 | Train Acc: 0.8533
 Site-art_painting                  | Train Loss: 0.8014 | Train Acc: 0.8644
 Site-cartoon                       | Train Loss: 1.0095 | Train Acc: 0.7600
 Site-cartoon                       | Train Loss: 1.0803 | Train Acc: 0.8067
 Site-sketch                        | Train Loss: 1.2267 | Train Acc: 0.6333
 Site-sketch                        | Train Loss: 1.2359 | Train Acc: 0.6111
Average Train Accuracy: 0.8125
 Site-photo                         | Val  Loss: 0.4173 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.4067 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.8209 | Val  Acc: 0.8700
 Site-art_painting                  | Val  Loss: 0.8195 | Val  Acc: 0.8567
 Site-cartoon                       | Val  Loss: 1.0267 | Val  Acc: 0.7600
 Site-cartoon                       | Val  Loss: 0.9836 | Val  Acc: 0.7733
 Site-sketch                        | Val  Loss: 1.1833 | Val  Acc: 0.5600
 Site-sketch                        | Val  Loss: 1.2007 | Val  Acc: 0.5867
Average Valid Accuracy: 0.7967
============ Train epoch 15 ============
 Site-photo                         | Train Loss: 0.4151 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.3602 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.8982 | Train Acc: 0.8133
 Site-art_painting                  | Train Loss: 0.7455 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 1.0187 | Train Acc: 0.8067
 Site-cartoon                       | Train Loss: 0.9213 | Train Acc: 0.8000
 Site-sketch                        | Train Loss: 1.2230 | Train Acc: 0.6000
 Site-sketch                        | Train Loss: 1.1467 | Train Acc: 0.6267
Average Train Accuracy: 0.8117
 Site-photo                         | Val  Loss: 0.3759 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.3543 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.7616 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.8071 | Val  Acc: 0.8600
 Site-cartoon                       | Val  Loss: 0.9392 | Val  Acc: 0.7800
 Site-cartoon                       | Val  Loss: 0.9366 | Val  Acc: 0.8067
 Site-sketch                        | Val  Loss: 1.0883 | Val  Acc: 0.6000
 Site-sketch                        | Val  Loss: 1.1789 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8133
 Best site-photo                     | Epoch:15 | Val Acc: 0.9800
 Best site-photo                     | Epoch:15 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8900
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8600
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.7800
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.8067
 Best site-sketch                    | Epoch:15 | Val Acc: 0.6000
 Best site-sketch                    | Epoch:15 | Val Acc: 0.6000
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 16 ============
 Site-photo                         | Train Loss: 0.3688 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.3268 | Train Acc: 0.9867
 Site-art_painting                  | Train Loss: 0.7529 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.7422 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.9535 | Train Acc: 0.7933
 Site-cartoon                       | Train Loss: 0.9397 | Train Acc: 0.8089
 Site-sketch                        | Train Loss: 1.2154 | Train Acc: 0.6067
 Site-sketch                        | Train Loss: 1.1483 | Train Acc: 0.6267
Average Train Accuracy: 0.8128
 Site-photo                         | Val  Loss: 0.3485 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.3210 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.7692 | Val  Acc: 0.8700
 Site-art_painting                  | Val  Loss: 0.7726 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 0.9037 | Val  Acc: 0.8000
 Site-cartoon                       | Val  Loss: 0.8991 | Val  Acc: 0.8267
 Site-sketch                        | Val  Loss: 1.1074 | Val  Acc: 0.6200
 Site-sketch                        | Val  Loss: 1.1615 | Val  Acc: 0.6400
Average Valid Accuracy: 0.8229
 Best site-photo                     | Epoch:16 | Val Acc: 0.9900
 Best site-photo                     | Epoch:16 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8700
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8500
 Best site-cartoon                   | Epoch:16 | Val Acc: 0.8000
 Best site-cartoon                   | Epoch:16 | Val Acc: 0.8267
 Best site-sketch                    | Epoch:16 | Val Acc: 0.6200
 Best site-sketch                    | Epoch:16 | Val Acc: 0.6400
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 17 ============
 Site-photo                         | Train Loss: 0.3098 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.2943 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.7594 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.7556 | Train Acc: 0.8644
 Site-cartoon                       | Train Loss: 0.9474 | Train Acc: 0.7800
 Site-cartoon                       | Train Loss: 0.8251 | Train Acc: 0.8444
 Site-sketch                        | Train Loss: 1.1912 | Train Acc: 0.6667
 Site-sketch                        | Train Loss: 1.1560 | Train Acc: 0.6267
Average Train Accuracy: 0.8239
 Site-photo                         | Val  Loss: 0.2886 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.2901 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.7355 | Val  Acc: 0.8500
 Site-art_painting                  | Val  Loss: 0.7311 | Val  Acc: 0.8633
 Site-cartoon                       | Val  Loss: 0.8867 | Val  Acc: 0.7900
 Site-cartoon                       | Val  Loss: 0.8844 | Val  Acc: 0.7900
 Site-sketch                        | Val  Loss: 1.1058 | Val  Acc: 0.5900
 Site-sketch                        | Val  Loss: 1.1422 | Val  Acc: 0.6167
Average Valid Accuracy: 0.8096
============ Train epoch 18 ============
 Site-photo                         | Train Loss: 0.2916 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.2623 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 0.7453 | Train Acc: 0.8267
 Site-art_painting                  | Train Loss: 0.7039 | Train Acc: 0.8756
 Site-cartoon                       | Train Loss: 0.9358 | Train Acc: 0.8000
 Site-cartoon                       | Train Loss: 0.7675 | Train Acc: 0.8311
 Site-sketch                        | Train Loss: 1.1615 | Train Acc: 0.6533
 Site-sketch                        | Train Loss: 1.1460 | Train Acc: 0.6289
Average Train Accuracy: 0.8233
 Site-photo                         | Val  Loss: 0.2595 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2577 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.6932 | Val  Acc: 0.9000
 Site-art_painting                  | Val  Loss: 0.6822 | Val  Acc: 0.8567
 Site-cartoon                       | Val  Loss: 0.8522 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 0.8475 | Val  Acc: 0.8300
 Site-sketch                        | Val  Loss: 1.0643 | Val  Acc: 0.6300
 Site-sketch                        | Val  Loss: 1.1023 | Val  Acc: 0.6300
Average Valid Accuracy: 0.8350
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-photo                     | Epoch:18 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:18 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8567
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.8300
 Best site-sketch                    | Epoch:18 | Val Acc: 0.6300
 Best site-sketch                    | Epoch:18 | Val Acc: 0.6300
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 19 ============
 Site-photo                         | Train Loss: 0.2673 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.2538 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.6941 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.6977 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.8552 | Train Acc: 0.8200
 Site-cartoon                       | Train Loss: 0.7984 | Train Acc: 0.8400
 Site-sketch                        | Train Loss: 1.1421 | Train Acc: 0.6200
 Site-sketch                        | Train Loss: 1.0868 | Train Acc: 0.6444
Average Train Accuracy: 0.8236
 Site-photo                         | Val  Loss: 0.2357 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.2359 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.6722 | Val  Acc: 0.9000
 Site-art_painting                  | Val  Loss: 0.6531 | Val  Acc: 0.8767
 Site-cartoon                       | Val  Loss: 0.8398 | Val  Acc: 0.8300
 Site-cartoon                       | Val  Loss: 0.8278 | Val  Acc: 0.8233
 Site-sketch                        | Val  Loss: 1.0654 | Val  Acc: 0.6400
 Site-sketch                        | Val  Loss: 1.1098 | Val  Acc: 0.6433
Average Valid Accuracy: 0.8362
 Best site-photo                     | Epoch:19 | Val Acc: 0.9900
 Best site-photo                     | Epoch:19 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:19 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:19 | Val Acc: 0.8767
 Best site-cartoon                   | Epoch:19 | Val Acc: 0.8300
 Best site-cartoon                   | Epoch:19 | Val Acc: 0.8233
 Best site-sketch                    | Epoch:19 | Val Acc: 0.6400
 Best site-sketch                    | Epoch:19 | Val Acc: 0.6433
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 20 ============
 Site-photo                         | Train Loss: 0.2277 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.2017 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.7397 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.6047 | Train Acc: 0.8822
 Site-cartoon                       | Train Loss: 0.8555 | Train Acc: 0.7867
 Site-cartoon                       | Train Loss: 0.8385 | Train Acc: 0.8222
 Site-sketch                        | Train Loss: 1.1142 | Train Acc: 0.6400
 Site-sketch                        | Train Loss: 1.0519 | Train Acc: 0.6467
Average Train Accuracy: 0.8244
 Site-photo                         | Val  Loss: 0.2033 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.2173 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.6428 | Val  Acc: 0.9000
 Site-art_painting                  | Val  Loss: 0.6571 | Val  Acc: 0.8767
 Site-cartoon                       | Val  Loss: 0.8011 | Val  Acc: 0.8200
 Site-cartoon                       | Val  Loss: 0.7949 | Val  Acc: 0.8200
 Site-sketch                        | Val  Loss: 1.0244 | Val  Acc: 0.6300
 Site-sketch                        | Val  Loss: 1.0848 | Val  Acc: 0.6567
Average Valid Accuracy: 0.8354
============ Train epoch 21 ============
 Site-photo                         | Train Loss: 0.2129 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.1850 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.6546 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.5896 | Train Acc: 0.8889
 Site-cartoon                       | Train Loss: 0.8217 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.8257 | Train Acc: 0.8444
 Site-sketch                        | Train Loss: 1.1586 | Train Acc: 0.6400
 Site-sketch                        | Train Loss: 1.1250 | Train Acc: 0.6400
Average Train Accuracy: 0.8328
 Site-photo                         | Val  Loss: 0.1940 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.1873 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.5949 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.6076 | Val  Acc: 0.8900
 Site-cartoon                       | Val  Loss: 0.8161 | Val  Acc: 0.8000
 Site-cartoon                       | Val  Loss: 0.7922 | Val  Acc: 0.8467
 Site-sketch                        | Val  Loss: 1.0190 | Val  Acc: 0.6500
 Site-sketch                        | Val  Loss: 1.0712 | Val  Acc: 0.6467
Average Valid Accuracy: 0.8375
 Best site-photo                     | Epoch:21 | Val Acc: 0.9900
 Best site-photo                     | Epoch:21 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:21 | Val Acc: 0.8900
 Best site-art_painting              | Epoch:21 | Val Acc: 0.8900
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.8000
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.8467
 Best site-sketch                    | Epoch:21 | Val Acc: 0.6500
 Best site-sketch                    | Epoch:21 | Val Acc: 0.6467
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 22 ============
 Site-photo                         | Train Loss: 0.2194 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.1756 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.6633 | Train Acc: 0.8533
 Site-art_painting                  | Train Loss: 0.5460 | Train Acc: 0.8756
 Site-cartoon                       | Train Loss: 0.7759 | Train Acc: 0.8200
 Site-cartoon                       | Train Loss: 0.6899 | Train Acc: 0.8444
 Site-sketch                        | Train Loss: 1.1006 | Train Acc: 0.6400
 Site-sketch                        | Train Loss: 1.1309 | Train Acc: 0.6378
Average Train Accuracy: 0.8300
 Site-photo                         | Val  Loss: 0.1839 | Val  Acc: 0.9800
 Site-photo                         | Val  Loss: 0.1885 | Val  Acc: 0.9833
 Site-art_painting                  | Val  Loss: 0.6118 | Val  Acc: 0.8800
 Site-art_painting                  | Val  Loss: 0.5894 | Val  Acc: 0.8800
 Site-cartoon                       | Val  Loss: 0.7781 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 0.7595 | Val  Acc: 0.8367
 Site-sketch                        | Val  Loss: 0.9704 | Val  Acc: 0.6900
 Site-sketch                        | Val  Loss: 1.0531 | Val  Acc: 0.6467
Average Valid Accuracy: 0.8421
 Best site-photo                     | Epoch:22 | Val Acc: 0.9800
 Best site-photo                     | Epoch:22 | Val Acc: 0.9833
 Best site-art_painting              | Epoch:22 | Val Acc: 0.8800
 Best site-art_painting              | Epoch:22 | Val Acc: 0.8800
 Best site-cartoon                   | Epoch:22 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:22 | Val Acc: 0.8367
 Best site-sketch                    | Epoch:22 | Val Acc: 0.6900
 Best site-sketch                    | Epoch:22 | Val Acc: 0.6467
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 23 ============
 Site-photo                         | Train Loss: 0.2051 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.1550 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.6587 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.5366 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.7853 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.6784 | Train Acc: 0.8622
 Site-sketch                        | Train Loss: 1.0821 | Train Acc: 0.6467
 Site-sketch                        | Train Loss: 0.9469 | Train Acc: 0.6689
Average Train Accuracy: 0.8347
 Site-photo                         | Val  Loss: 0.1717 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1559 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.5613 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.5686 | Val  Acc: 0.8800
 Site-cartoon                       | Val  Loss: 0.7884 | Val  Acc: 0.8100
 Site-cartoon                       | Val  Loss: 0.7334 | Val  Acc: 0.8400
 Site-sketch                        | Val  Loss: 1.0313 | Val  Acc: 0.6700
 Site-sketch                        | Val  Loss: 1.0202 | Val  Acc: 0.6767
Average Valid Accuracy: 0.8446
 Best site-photo                     | Epoch:23 | Val Acc: 1.0000
 Best site-photo                     | Epoch:23 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8900
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8800
 Best site-cartoon                   | Epoch:23 | Val Acc: 0.8100
 Best site-cartoon                   | Epoch:23 | Val Acc: 0.8400
 Best site-sketch                    | Epoch:23 | Val Acc: 0.6700
 Best site-sketch                    | Epoch:23 | Val Acc: 0.6767
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 24 ============
 Site-photo                         | Train Loss: 0.2032 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.1526 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.6997 | Train Acc: 0.8533
 Site-art_painting                  | Train Loss: 0.5291 | Train Acc: 0.8778
 Site-cartoon                       | Train Loss: 0.8333 | Train Acc: 0.8067
 Site-cartoon                       | Train Loss: 0.6709 | Train Acc: 0.8400
 Site-sketch                        | Train Loss: 1.0692 | Train Acc: 0.6800
 Site-sketch                        | Train Loss: 1.0120 | Train Acc: 0.6444
Average Train Accuracy: 0.8350
 Site-photo                         | Val  Loss: 0.1554 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.1483 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.5835 | Val  Acc: 0.8800
 Site-art_painting                  | Val  Loss: 0.5757 | Val  Acc: 0.8700
 Site-cartoon                       | Val  Loss: 0.7434 | Val  Acc: 0.8100
 Site-cartoon                       | Val  Loss: 0.7201 | Val  Acc: 0.8600
 Site-sketch                        | Val  Loss: 1.0283 | Val  Acc: 0.6400
 Site-sketch                        | Val  Loss: 1.0298 | Val  Acc: 0.6500
Average Valid Accuracy: 0.8362
============ Train epoch 25 ============
 Site-photo                         | Train Loss: 0.1684 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.2213 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.5648 | Train Acc: 0.8133
 Site-art_painting                  | Train Loss: 0.5585 | Train Acc: 0.8778
 Site-cartoon                       | Train Loss: 0.7636 | Train Acc: 0.7933
 Site-cartoon                       | Train Loss: 0.6543 | Train Acc: 0.8267
 Site-sketch                        | Train Loss: 1.0976 | Train Acc: 0.6467
 Site-sketch                        | Train Loss: 0.9661 | Train Acc: 0.6600
Average Train Accuracy: 0.8242
 Site-photo                         | Val  Loss: 0.1424 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.1336 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.5955 | Val  Acc: 0.8700
 Site-art_painting                  | Val  Loss: 0.5472 | Val  Acc: 0.8833
 Site-cartoon                       | Val  Loss: 0.7111 | Val  Acc: 0.8000
 Site-cartoon                       | Val  Loss: 0.7073 | Val  Acc: 0.8367
 Site-sketch                        | Val  Loss: 0.9582 | Val  Acc: 0.6700
 Site-sketch                        | Val  Loss: 0.9956 | Val  Acc: 0.6800
Average Valid Accuracy: 0.8400
============ Train epoch 26 ============
 Site-photo                         | Train Loss: 0.2130 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.1257 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.5931 | Train Acc: 0.8267
 Site-art_painting                  | Train Loss: 0.5322 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.7702 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.6543 | Train Acc: 0.8644
 Site-sketch                        | Train Loss: 1.0270 | Train Acc: 0.6400
 Site-sketch                        | Train Loss: 0.9528 | Train Acc: 0.6733
Average Train Accuracy: 0.8325
 Site-photo                         | Val  Loss: 0.1218 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1182 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.5023 | Val  Acc: 0.8900
 Site-art_painting                  | Val  Loss: 0.4986 | Val  Acc: 0.8867
 Site-cartoon                       | Val  Loss: 0.6978 | Val  Acc: 0.8200
 Site-cartoon                       | Val  Loss: 0.6964 | Val  Acc: 0.8333
 Site-sketch                        | Val  Loss: 0.9138 | Val  Acc: 0.7000
 Site-sketch                        | Val  Loss: 0.9959 | Val  Acc: 0.6733
Average Valid Accuracy: 0.8500
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 0.9967
 Best site-art_painting              | Epoch:26 | Val Acc: 0.8900
 Best site-art_painting              | Epoch:26 | Val Acc: 0.8867
 Best site-cartoon                   | Epoch:26 | Val Acc: 0.8200
 Best site-cartoon                   | Epoch:26 | Val Acc: 0.8333
 Best site-sketch                    | Epoch:26 | Val Acc: 0.7000
 Best site-sketch                    | Epoch:26 | Val Acc: 0.6733
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 27 ============
 Site-photo                         | Train Loss: 0.1761 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.1037 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.6023 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.4836 | Train Acc: 0.8911
 Site-cartoon                       | Train Loss: 0.6473 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.6271 | Train Acc: 0.8600
 Site-sketch                        | Train Loss: 1.0052 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.9244 | Train Acc: 0.6667
Average Train Accuracy: 0.8461
 Site-photo                         | Val  Loss: 0.1137 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1134 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.4848 | Val  Acc: 0.9100
 Site-art_painting                  | Val  Loss: 0.5132 | Val  Acc: 0.8967
 Site-cartoon                       | Val  Loss: 0.6592 | Val  Acc: 0.8300
 Site-cartoon                       | Val  Loss: 0.6849 | Val  Acc: 0.8567
 Site-sketch                        | Val  Loss: 0.9240 | Val  Acc: 0.6900
 Site-sketch                        | Val  Loss: 0.9821 | Val  Acc: 0.6833
Average Valid Accuracy: 0.8571
 Best site-photo                     | Epoch:27 | Val Acc: 1.0000
 Best site-photo                     | Epoch:27 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:27 | Val Acc: 0.9100
 Best site-art_painting              | Epoch:27 | Val Acc: 0.8967
 Best site-cartoon                   | Epoch:27 | Val Acc: 0.8300
 Best site-cartoon                   | Epoch:27 | Val Acc: 0.8567
 Best site-sketch                    | Epoch:27 | Val Acc: 0.6900
 Best site-sketch                    | Epoch:27 | Val Acc: 0.6833
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 28 ============
 Site-photo                         | Train Loss: 0.1399 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.1058 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.5574 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.5087 | Train Acc: 0.8911
 Site-cartoon                       | Train Loss: 0.6398 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.6233 | Train Acc: 0.8578
 Site-sketch                        | Train Loss: 1.0267 | Train Acc: 0.6733
 Site-sketch                        | Train Loss: 0.9845 | Train Acc: 0.6844
Average Train Accuracy: 0.8528
 Site-photo                         | Val  Loss: 0.1123 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.1056 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4885 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.4972 | Val  Acc: 0.8900
 Site-cartoon                       | Val  Loss: 0.6472 | Val  Acc: 0.8600
 Site-cartoon                       | Val  Loss: 0.6552 | Val  Acc: 0.8700
 Site-sketch                        | Val  Loss: 0.9311 | Val  Acc: 0.6700
 Site-sketch                        | Val  Loss: 0.9737 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8629
 Best site-photo                     | Epoch:28 | Val Acc: 0.9900
 Best site-photo                     | Epoch:28 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:28 | Val Acc: 0.9300
 Best site-art_painting              | Epoch:28 | Val Acc: 0.8900
 Best site-cartoon                   | Epoch:28 | Val Acc: 0.8600
 Best site-cartoon                   | Epoch:28 | Val Acc: 0.8700
 Best site-sketch                    | Epoch:28 | Val Acc: 0.6700
 Best site-sketch                    | Epoch:28 | Val Acc: 0.7000
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 29 ============
 Site-photo                         | Train Loss: 0.1449 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.0955 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.5579 | Train Acc: 0.8467
 Site-art_painting                  | Train Loss: 0.5826 | Train Acc: 0.8978
 Site-cartoon                       | Train Loss: 0.6967 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.7759 | Train Acc: 0.8622
 Site-sketch                        | Train Loss: 1.0130 | Train Acc: 0.6267
 Site-sketch                        | Train Loss: 0.9366 | Train Acc: 0.6778
Average Train Accuracy: 0.8358
 Site-photo                         | Val  Loss: 0.1107 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.1112 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.4684 | Val  Acc: 0.9100
 Site-art_painting                  | Val  Loss: 0.4853 | Val  Acc: 0.8900
 Site-cartoon                       | Val  Loss: 0.6357 | Val  Acc: 0.8600
 Site-cartoon                       | Val  Loss: 0.6390 | Val  Acc: 0.8567
 Site-sketch                        | Val  Loss: 0.8792 | Val  Acc: 0.6800
 Site-sketch                        | Val  Loss: 0.9651 | Val  Acc: 0.6600
Average Valid Accuracy: 0.8542
============ Train epoch 30 ============
 Site-photo                         | Train Loss: 0.1227 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.1082 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.5515 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.4330 | Train Acc: 0.9022
 Site-cartoon                       | Train Loss: 0.6658 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.5434 | Train Acc: 0.8667
 Site-sketch                        | Train Loss: 0.9685 | Train Acc: 0.7200
 Site-sketch                        | Train Loss: 0.9001 | Train Acc: 0.6867
Average Train Accuracy: 0.8564
 Site-photo                         | Val  Loss: 0.0927 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1032 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.4672 | Val  Acc: 0.9000
 Site-art_painting                  | Val  Loss: 0.4669 | Val  Acc: 0.9067
 Site-cartoon                       | Val  Loss: 0.6734 | Val  Acc: 0.8700
 Site-cartoon                       | Val  Loss: 0.6449 | Val  Acc: 0.8467
 Site-sketch                        | Val  Loss: 0.9316 | Val  Acc: 0.6600
 Site-sketch                        | Val  Loss: 0.9627 | Val  Acc: 0.6633
Average Valid Accuracy: 0.8542
============ Train epoch 31 ============
 Site-photo                         | Train Loss: 0.1259 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0892 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5074 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.4194 | Train Acc: 0.9067
 Site-cartoon                       | Train Loss: 0.6315 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.5530 | Train Acc: 0.8711
 Site-sketch                        | Train Loss: 1.0096 | Train Acc: 0.6600
 Site-sketch                        | Train Loss: 1.0345 | Train Acc: 0.6844
Average Train Accuracy: 0.8533
 Site-photo                         | Val  Loss: 0.0833 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0927 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.4425 | Val  Acc: 0.9000
 Site-art_painting                  | Val  Loss: 0.4354 | Val  Acc: 0.9100
 Site-cartoon                       | Val  Loss: 0.6160 | Val  Acc: 0.8400
 Site-cartoon                       | Val  Loss: 0.6133 | Val  Acc: 0.8800
 Site-sketch                        | Val  Loss: 0.8850 | Val  Acc: 0.7400
 Site-sketch                        | Val  Loss: 0.9262 | Val  Acc: 0.7033
Average Valid Accuracy: 0.8704
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 0.9900
 Best site-art_painting              | Epoch:31 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:31 | Val Acc: 0.9100
 Best site-cartoon                   | Epoch:31 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:31 | Val Acc: 0.8800
 Best site-sketch                    | Epoch:31 | Val Acc: 0.7400
 Best site-sketch                    | Epoch:31 | Val Acc: 0.7033
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 32 ============
 Site-photo                         | Train Loss: 0.1323 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0726 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.4974 | Train Acc: 0.8533
 Site-art_painting                  | Train Loss: 0.5069 | Train Acc: 0.8911
 Site-cartoon                       | Train Loss: 0.6478 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.5885 | Train Acc: 0.8889
 Site-sketch                        | Train Loss: 1.0001 | Train Acc: 0.7000
 Site-sketch                        | Train Loss: 0.8996 | Train Acc: 0.6733
Average Train Accuracy: 0.8525
 Site-photo                         | Val  Loss: 0.0924 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0832 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4471 | Val  Acc: 0.9200
 Site-art_painting                  | Val  Loss: 0.4474 | Val  Acc: 0.9067
 Site-cartoon                       | Val  Loss: 0.6026 | Val  Acc: 0.8800
 Site-cartoon                       | Val  Loss: 0.6100 | Val  Acc: 0.8600
 Site-sketch                        | Val  Loss: 0.8839 | Val  Acc: 0.6900
 Site-sketch                        | Val  Loss: 0.9336 | Val  Acc: 0.7067
Average Valid Accuracy: 0.8696
============ Train epoch 33 ============
 Site-photo                         | Train Loss: 0.1050 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0792 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5631 | Train Acc: 0.8533
 Site-art_painting                  | Train Loss: 0.4075 | Train Acc: 0.8911
 Site-cartoon                       | Train Loss: 0.6898 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.5733 | Train Acc: 0.8622
 Site-sketch                        | Train Loss: 0.9565 | Train Acc: 0.7267
 Site-sketch                        | Train Loss: 0.9504 | Train Acc: 0.6733
Average Train Accuracy: 0.8522
 Site-photo                         | Val  Loss: 0.0791 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0799 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4426 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.4587 | Val  Acc: 0.8933
 Site-cartoon                       | Val  Loss: 0.6263 | Val  Acc: 0.8300
 Site-cartoon                       | Val  Loss: 0.5786 | Val  Acc: 0.8767
 Site-sketch                        | Val  Loss: 0.8738 | Val  Acc: 0.6900
 Site-sketch                        | Val  Loss: 0.9116 | Val  Acc: 0.6800
Average Valid Accuracy: 0.8604
============ Train epoch 34 ============
 Site-photo                         | Train Loss: 0.0985 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0698 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.5067 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.4250 | Train Acc: 0.9111
 Site-cartoon                       | Train Loss: 0.7099 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.6429 | Train Acc: 0.8556
 Site-sketch                        | Train Loss: 0.9493 | Train Acc: 0.6533
 Site-sketch                        | Train Loss: 0.8880 | Train Acc: 0.7156
Average Train Accuracy: 0.8536
 Site-photo                         | Val  Loss: 0.0787 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0821 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.4057 | Val  Acc: 0.9400
 Site-art_painting                  | Val  Loss: 0.4180 | Val  Acc: 0.9167
 Site-cartoon                       | Val  Loss: 0.5925 | Val  Acc: 0.8200
 Site-cartoon                       | Val  Loss: 0.5861 | Val  Acc: 0.8600
 Site-sketch                        | Val  Loss: 0.8363 | Val  Acc: 0.7000
 Site-sketch                        | Val  Loss: 0.8964 | Val  Acc: 0.7167
Average Valid Accuracy: 0.8667
============ Train epoch 35 ============
 Site-photo                         | Train Loss: 0.0989 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.0652 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5370 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.4197 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.6974 | Train Acc: 0.8200
 Site-cartoon                       | Train Loss: 0.5060 | Train Acc: 0.8689
 Site-sketch                        | Train Loss: 0.9672 | Train Acc: 0.6867
 Site-sketch                        | Train Loss: 0.9103 | Train Acc: 0.7000
Average Train Accuracy: 0.8467
 Site-photo                         | Val  Loss: 0.0574 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0676 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.3801 | Val  Acc: 0.9400
 Site-art_painting                  | Val  Loss: 0.4377 | Val  Acc: 0.9000
 Site-cartoon                       | Val  Loss: 0.6171 | Val  Acc: 0.8200
 Site-cartoon                       | Val  Loss: 0.5854 | Val  Acc: 0.8800
 Site-sketch                        | Val  Loss: 0.8715 | Val  Acc: 0.7300
 Site-sketch                        | Val  Loss: 0.9224 | Val  Acc: 0.6967
Average Valid Accuracy: 0.8704
============ Train epoch 36 ============
 Site-photo                         | Train Loss: 0.0940 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.0679 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4831 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.4429 | Train Acc: 0.9022
 Site-cartoon                       | Train Loss: 0.6439 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.5040 | Train Acc: 0.8600
 Site-sketch                        | Train Loss: 0.8726 | Train Acc: 0.7133
 Site-sketch                        | Train Loss: 0.9987 | Train Acc: 0.7089
Average Train Accuracy: 0.8611
 Site-photo                         | Val  Loss: 0.0666 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0655 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4003 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.4134 | Val  Acc: 0.9167
 Site-cartoon                       | Val  Loss: 0.5959 | Val  Acc: 0.8600
 Site-cartoon                       | Val  Loss: 0.5630 | Val  Acc: 0.8667
 Site-sketch                        | Val  Loss: 0.8491 | Val  Acc: 0.7200
 Site-sketch                        | Val  Loss: 0.9089 | Val  Acc: 0.7067
Average Valid Accuracy: 0.8742
 Best site-photo                     | Epoch:36 | Val Acc: 1.0000
 Best site-photo                     | Epoch:36 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:36 | Val Acc: 0.9300
 Best site-art_painting              | Epoch:36 | Val Acc: 0.9167
 Best site-cartoon                   | Epoch:36 | Val Acc: 0.8600
 Best site-cartoon                   | Epoch:36 | Val Acc: 0.8667
 Best site-sketch                    | Epoch:36 | Val Acc: 0.7200
 Best site-sketch                    | Epoch:36 | Val Acc: 0.7067
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 37 ============
 Site-photo                         | Train Loss: 0.1220 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0605 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4638 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.3588 | Train Acc: 0.9044
 Site-cartoon                       | Train Loss: 0.6318 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.6027 | Train Acc: 0.8711
 Site-sketch                        | Train Loss: 0.9249 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.8527 | Train Acc: 0.7044
Average Train Accuracy: 0.8681
 Site-photo                         | Val  Loss: 0.0515 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0720 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.4429 | Val  Acc: 0.8700
 Site-art_painting                  | Val  Loss: 0.4160 | Val  Acc: 0.8933
 Site-cartoon                       | Val  Loss: 0.5687 | Val  Acc: 0.8600
 Site-cartoon                       | Val  Loss: 0.5148 | Val  Acc: 0.8933
 Site-sketch                        | Val  Loss: 0.8260 | Val  Acc: 0.6700
 Site-sketch                        | Val  Loss: 0.8843 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8604
============ Train epoch 38 ============
 Site-photo                         | Train Loss: 0.0768 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0601 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5295 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.4620 | Train Acc: 0.9156
 Site-cartoon                       | Train Loss: 0.6170 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.4709 | Train Acc: 0.8689
 Site-sketch                        | Train Loss: 0.8775 | Train Acc: 0.6867
 Site-sketch                        | Train Loss: 0.8562 | Train Acc: 0.7111
Average Train Accuracy: 0.8592
 Site-photo                         | Val  Loss: 0.0586 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0600 | Val  Acc: 0.9867
 Site-art_painting                  | Val  Loss: 0.3725 | Val  Acc: 0.9500
 Site-art_painting                  | Val  Loss: 0.4056 | Val  Acc: 0.8933
 Site-cartoon                       | Val  Loss: 0.5650 | Val  Acc: 0.8700
 Site-cartoon                       | Val  Loss: 0.5716 | Val  Acc: 0.8733
 Site-sketch                        | Val  Loss: 0.8303 | Val  Acc: 0.7500
 Site-sketch                        | Val  Loss: 0.8752 | Val  Acc: 0.7233
Average Valid Accuracy: 0.8808
 Best site-photo                     | Epoch:38 | Val Acc: 1.0000
 Best site-photo                     | Epoch:38 | Val Acc: 0.9867
 Best site-art_painting              | Epoch:38 | Val Acc: 0.9500
 Best site-art_painting              | Epoch:38 | Val Acc: 0.8933
 Best site-cartoon                   | Epoch:38 | Val Acc: 0.8700
 Best site-cartoon                   | Epoch:38 | Val Acc: 0.8733
 Best site-sketch                    | Epoch:38 | Val Acc: 0.7500
 Best site-sketch                    | Epoch:38 | Val Acc: 0.7233
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 39 ============
 Site-photo                         | Train Loss: 0.0854 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0590 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4790 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.4047 | Train Acc: 0.8978
 Site-cartoon                       | Train Loss: 0.6265 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.5783 | Train Acc: 0.8711
 Site-sketch                        | Train Loss: 0.8994 | Train Acc: 0.7133
 Site-sketch                        | Train Loss: 0.9028 | Train Acc: 0.7200
Average Train Accuracy: 0.8600
 Site-photo                         | Val  Loss: 0.0470 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0648 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.4174 | Val  Acc: 0.9000
 Site-art_painting                  | Val  Loss: 0.3804 | Val  Acc: 0.8933
 Site-cartoon                       | Val  Loss: 0.5636 | Val  Acc: 0.8700
 Site-cartoon                       | Val  Loss: 0.5562 | Val  Acc: 0.8600
 Site-sketch                        | Val  Loss: 0.8231 | Val  Acc: 0.7100
 Site-sketch                        | Val  Loss: 0.8581 | Val  Acc: 0.7267
Average Valid Accuracy: 0.8692
============ Train epoch 40 ============
 Site-photo                         | Train Loss: 0.0746 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0506 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4452 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.3939 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.6276 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.5141 | Train Acc: 0.8778
 Site-sketch                        | Train Loss: 0.8727 | Train Acc: 0.7400
 Site-sketch                        | Train Loss: 0.8613 | Train Acc: 0.7356
Average Train Accuracy: 0.8669
 Site-photo                         | Val  Loss: 0.0688 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0530 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.3991 | Val  Acc: 0.9100
 Site-art_painting                  | Val  Loss: 0.4086 | Val  Acc: 0.9100
 Site-cartoon                       | Val  Loss: 0.5696 | Val  Acc: 0.8500
 Site-cartoon                       | Val  Loss: 0.5608 | Val  Acc: 0.8667
 Site-sketch                        | Val  Loss: 0.7712 | Val  Acc: 0.7400
 Site-sketch                        | Val  Loss: 0.8927 | Val  Acc: 0.7233
Average Valid Accuracy: 0.8729
============ Train epoch 41 ============
 Site-photo                         | Train Loss: 0.0881 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0533 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.5123 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.3438 | Train Acc: 0.9133
 Site-cartoon                       | Train Loss: 0.6460 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.5435 | Train Acc: 0.8533
 Site-sketch                        | Train Loss: 0.8423 | Train Acc: 0.7267
 Site-sketch                        | Train Loss: 0.8568 | Train Acc: 0.7111
Average Train Accuracy: 0.8636
 Site-photo                         | Val  Loss: 0.0473 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0618 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.3560 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.3839 | Val  Acc: 0.9067
 Site-cartoon                       | Val  Loss: 0.5301 | Val  Acc: 0.8900
 Site-cartoon                       | Val  Loss: 0.5153 | Val  Acc: 0.8800
 Site-sketch                        | Val  Loss: 0.8019 | Val  Acc: 0.7300
 Site-sketch                        | Val  Loss: 0.8656 | Val  Acc: 0.7133
Average Valid Accuracy: 0.8800
============ Train epoch 42 ============
 Site-photo                         | Train Loss: 0.0641 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0495 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.4799 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.3187 | Train Acc: 0.9244
 Site-cartoon                       | Train Loss: 0.5616 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.5993 | Train Acc: 0.8733
 Site-sketch                        | Train Loss: 0.8670 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.8044 | Train Acc: 0.7289
Average Train Accuracy: 0.8664
 Site-photo                         | Val  Loss: 0.0423 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0417 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.3834 | Val  Acc: 0.9100
 Site-art_painting                  | Val  Loss: 0.3625 | Val  Acc: 0.9300
 Site-cartoon                       | Val  Loss: 0.5333 | Val  Acc: 0.8300
 Site-cartoon                       | Val  Loss: 0.5433 | Val  Acc: 0.8400
 Site-sketch                        | Val  Loss: 0.8477 | Val  Acc: 0.6200
 Site-sketch                        | Val  Loss: 0.8414 | Val  Acc: 0.7567
Average Valid Accuracy: 0.8604
============ Train epoch 43 ============
 Site-photo                         | Train Loss: 0.1341 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.0457 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.4727 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.3339 | Train Acc: 0.9044
 Site-cartoon                       | Train Loss: 0.5977 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.4543 | Train Acc: 0.8867
 Site-sketch                        | Train Loss: 0.8675 | Train Acc: 0.7333
 Site-sketch                        | Train Loss: 0.8927 | Train Acc: 0.7311
Average Train Accuracy: 0.8669
 Site-photo                         | Val  Loss: 0.0590 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0434 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.4275 | Val  Acc: 0.8800
 Site-art_painting                  | Val  Loss: 0.3404 | Val  Acc: 0.9133
 Site-cartoon                       | Val  Loss: 0.5437 | Val  Acc: 0.8600
 Site-cartoon                       | Val  Loss: 0.5252 | Val  Acc: 0.8733
 Site-sketch                        | Val  Loss: 0.7663 | Val  Acc: 0.7400
 Site-sketch                        | Val  Loss: 0.8479 | Val  Acc: 0.7333
Average Valid Accuracy: 0.8733
============ Train epoch 44 ============
 Site-photo                         | Train Loss: 0.1048 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0506 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.3757 | Train Acc: 0.9067
 Site-art_painting                  | Train Loss: 0.3164 | Train Acc: 0.9222
 Site-cartoon                       | Train Loss: 0.5946 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.7267 | Train Acc: 0.8756
 Site-sketch                        | Train Loss: 0.8811 | Train Acc: 0.7000
 Site-sketch                        | Train Loss: 0.8132 | Train Acc: 0.7400
Average Train Accuracy: 0.8706
 Site-photo                         | Val  Loss: 0.0513 | Val  Acc: 0.9900
 Site-photo                         | Val  Loss: 0.0526 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.3081 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.3643 | Val  Acc: 0.9000
 Site-cartoon                       | Val  Loss: 0.5120 | Val  Acc: 0.8700
 Site-cartoon                       | Val  Loss: 0.5008 | Val  Acc: 0.8867
 Site-sketch                        | Val  Loss: 0.8353 | Val  Acc: 0.6900
 Site-sketch                        | Val  Loss: 0.8502 | Val  Acc: 0.6800
Average Valid Accuracy: 0.8671
============ Train epoch 45 ============
 Site-photo                         | Train Loss: 0.0821 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0391 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.4488 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.3385 | Train Acc: 0.9311
 Site-cartoon                       | Train Loss: 0.5664 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.4628 | Train Acc: 0.8711
 Site-sketch                        | Train Loss: 0.9196 | Train Acc: 0.7200
 Site-sketch                        | Train Loss: 0.8023 | Train Acc: 0.7222
Average Train Accuracy: 0.8728
 Site-photo                         | Val  Loss: 0.0427 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0362 | Val  Acc: 0.9967
 Site-art_painting                  | Val  Loss: 0.3323 | Val  Acc: 0.9500
 Site-art_painting                  | Val  Loss: 0.3671 | Val  Acc: 0.9000
 Site-cartoon                       | Val  Loss: 0.5128 | Val  Acc: 0.8600
 Site-cartoon                       | Val  Loss: 0.5037 | Val  Acc: 0.8833
 Site-sketch                        | Val  Loss: 0.7488 | Val  Acc: 0.7500
 Site-sketch                        | Val  Loss: 0.8172 | Val  Acc: 0.7467
Average Valid Accuracy: 0.8858
 Best site-photo                     | Epoch:45 | Val Acc: 1.0000
 Best site-photo                     | Epoch:45 | Val Acc: 0.9967
 Best site-art_painting              | Epoch:45 | Val Acc: 0.9500
 Best site-art_painting              | Epoch:45 | Val Acc: 0.9000
 Best site-cartoon                   | Epoch:45 | Val Acc: 0.8600
 Best site-cartoon                   | Epoch:45 | Val Acc: 0.8833
 Best site-sketch                    | Epoch:45 | Val Acc: 0.7500
 Best site-sketch                    | Epoch:45 | Val Acc: 0.7467
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 46 ============
 Site-photo                         | Train Loss: 0.0694 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0365 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4741 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.3706 | Train Acc: 0.9178
 Site-cartoon                       | Train Loss: 0.5748 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.4423 | Train Acc: 0.8711
 Site-sketch                        | Train Loss: 0.8800 | Train Acc: 0.7267
 Site-sketch                        | Train Loss: 0.7991 | Train Acc: 0.7089
Average Train Accuracy: 0.8650
 Site-photo                         | Val  Loss: 0.0534 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0455 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.3366 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.3228 | Val  Acc: 0.9100
 Site-cartoon                       | Val  Loss: 0.4951 | Val  Acc: 0.8700
 Site-cartoon                       | Val  Loss: 0.4861 | Val  Acc: 0.8833
 Site-sketch                        | Val  Loss: 0.7320 | Val  Acc: 0.7800
 Site-sketch                        | Val  Loss: 0.8226 | Val  Acc: 0.7233
Average Valid Accuracy: 0.8862
 Best site-photo                     | Epoch:46 | Val Acc: 1.0000
 Best site-photo                     | Epoch:46 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:46 | Val Acc: 0.9300
 Best site-art_painting              | Epoch:46 | Val Acc: 0.9100
 Best site-cartoon                   | Epoch:46 | Val Acc: 0.8700
 Best site-cartoon                   | Epoch:46 | Val Acc: 0.8833
 Best site-sketch                    | Epoch:46 | Val Acc: 0.7800
 Best site-sketch                    | Epoch:46 | Val Acc: 0.7233
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/fedavg...
============ Train epoch 47 ============
 Site-photo                         | Train Loss: 0.0645 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0447 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4296 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.3209 | Train Acc: 0.9222
 Site-cartoon                       | Train Loss: 0.5281 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.5010 | Train Acc: 0.8844
 Site-sketch                        | Train Loss: 0.8772 | Train Acc: 0.7267
 Site-sketch                        | Train Loss: 0.7974 | Train Acc: 0.6911
Average Train Accuracy: 0.8700
 Site-photo                         | Val  Loss: 0.0404 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0389 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.3210 | Val  Acc: 0.9300
 Site-art_painting                  | Val  Loss: 0.3448 | Val  Acc: 0.9100
 Site-cartoon                       | Val  Loss: 0.4918 | Val  Acc: 0.8900
 Site-cartoon                       | Val  Loss: 0.4874 | Val  Acc: 0.8633
 Site-sketch                        | Val  Loss: 0.7488 | Val  Acc: 0.7100
 Site-sketch                        | Val  Loss: 0.8252 | Val  Acc: 0.7200
Average Valid Accuracy: 0.8771
============ Train epoch 48 ============
 Site-photo                         | Train Loss: 0.0693 | Train Acc: 0.9733
 Site-photo                         | Train Loss: 0.0393 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4149 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.3111 | Train Acc: 0.9244
 Site-cartoon                       | Train Loss: 0.5249 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.4357 | Train Acc: 0.8733
 Site-sketch                        | Train Loss: 0.8180 | Train Acc: 0.6933
 Site-sketch                        | Train Loss: 0.8230 | Train Acc: 0.7489
Average Train Accuracy: 0.8719
 Site-photo                         | Val  Loss: 0.0341 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0414 | Val  Acc: 0.9900
 Site-art_painting                  | Val  Loss: 0.3373 | Val  Acc: 0.9200
 Site-art_painting                  | Val  Loss: 0.3099 | Val  Acc: 0.9267
 Site-cartoon                       | Val  Loss: 0.5022 | Val  Acc: 0.8800
 Site-cartoon                       | Val  Loss: 0.4642 | Val  Acc: 0.8800
 Site-sketch                        | Val  Loss: 0.7333 | Val  Acc: 0.7500
 Site-sketch                        | Val  Loss: 0.8033 | Val  Acc: 0.7333
Average Valid Accuracy: 0.8850
============ Train epoch 49 ============
 Site-photo                         | Train Loss: 0.0818 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0372 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.4330 | Train Acc: 0.8733
 Site-art_painting                  | Train Loss: 0.2874 | Train Acc: 0.9378
 Site-cartoon                       | Train Loss: 0.5381 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.4195 | Train Acc: 0.9022
 Site-sketch                        | Train Loss: 0.8684 | Train Acc: 0.7000
 Site-sketch                        | Train Loss: 0.8939 | Train Acc: 0.7244
Average Train Accuracy: 0.8725
 Site-photo                         | Val  Loss: 0.0276 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0337 | Val  Acc: 0.9933
 Site-art_painting                  | Val  Loss: 0.3320 | Val  Acc: 0.9100
 Site-art_painting                  | Val  Loss: 0.3332 | Val  Acc: 0.9067
 Site-cartoon                       | Val  Loss: 0.5024 | Val  Acc: 0.8300
 Site-cartoon                       | Val  Loss: 0.4629 | Val  Acc: 0.8800
 Site-sketch                        | Val  Loss: 0.6945 | Val  Acc: 0.7300
 Site-sketch                        | Val  Loss: 0.7932 | Val  Acc: 0.7467
Average Valid Accuracy: 0.8746
===2023-08-08 01:09:23===
===2023-08-08 01:09:38===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
Loading snapshots...
 Test site-photo                     (1)| Epoch:46 | Test Acc: 0.9985
 Test site-art_painting              (3)| Epoch:46 | Test Acc: 0.9196
 Test site-cartoon                   (2)| Epoch:46 | Test Acc: 0.8309
 Test site-sketch                    (0)| Epoch:46 | Test Acc: 0.6887
photo: 0.9985, art_painting: 0.9196, cartoon: 0.8309, sketch: 0.6887, 
Average Test Accuracy(group): 0.8594, Average Test Accuracy(individual): 0.8594,
domain std=0.1150, cluster std=0.1150, individual std=0.1150, 
