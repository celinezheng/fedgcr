===2023-08-05 14:14:16===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[25,38,56,85,127,20,33,52,83,25,43,75,34,68,26,52,60,45,
client_nums=[5,4,3,2,2,1,1,]
len_dataset=[555,317,241,173,132,100,76,]
domain number = 7
============ Train epoch 0 ============
 Site-amazon                        | Train Loss: 1.8183 | Train Acc: 0.6000
 Site-amazon                        | Train Loss: 1.7689 | Train Acc: 0.8421
 Site-amazon                        | Train Loss: 1.7568 | Train Acc: 0.7679
 Site-amazon                        | Train Loss: 1.7052 | Train Acc: 0.8000
 Site-amazon                        | Train Loss: 1.7087 | Train Acc: 0.8268
 Site-Art                           | Train Loss: 1.8966 | Train Acc: 0.7000
 Site-Art                           | Train Loss: 1.9545 | Train Acc: 0.6667
 Site-Art                           | Train Loss: 1.9325 | Train Acc: 0.7692
 Site-Art                           | Train Loss: 1.9539 | Train Acc: 0.6627
 Site-RealWorld                     | Train Loss: 1.7927 | Train Acc: 0.8800
 Site-RealWorld                     | Train Loss: 1.7613 | Train Acc: 0.8605
 Site-RealWorld                     | Train Loss: 1.7771 | Train Acc: 0.8667
 Site-webcam                        | Train Loss: 1.6695 | Train Acc: 0.9706
 Site-webcam                        | Train Loss: 1.7307 | Train Acc: 0.8382
 Site-Clipart                       | Train Loss: 1.9092 | Train Acc: 0.6538
 Site-Clipart                       | Train Loss: 1.8436 | Train Acc: 0.7308
 Site-dslr                          | Train Loss: 1.7522 | Train Acc: 0.8333
 Site-Product                       | Train Loss: 1.7587 | Train Acc: 0.8000
Average Train Accuracy: 0.7816
 Site-amazon                        | Val  Loss: 1.7324 | Val  Acc: 0.8125
 Site-amazon                        | Val  Loss: 1.7158 | Val  Acc: 0.8000
 Site-amazon                        | Val  Loss: 1.7006 | Val  Acc: 0.8378
 Site-amazon                        | Val  Loss: 1.7439 | Val  Acc: 0.7857
 Site-amazon                        | Val  Loss: 1.7241 | Val  Acc: 0.8452
 Site-Art                           | Val  Loss: 1.8715 | Val  Acc: 0.7692
 Site-Art                           | Val  Loss: 1.9259 | Val  Acc: 0.7619
 Site-Art                           | Val  Loss: 1.9995 | Val  Acc: 0.6765
 Site-Art                           | Val  Loss: 1.9414 | Val  Acc: 0.7273
 Site-RealWorld                     | Val  Loss: 1.7720 | Val  Acc: 0.8750
 Site-RealWorld                     | Val  Loss: 1.7431 | Val  Acc: 0.8621
 Site-RealWorld                     | Val  Loss: 1.7614 | Val  Acc: 0.8200
 Site-webcam                        | Val  Loss: 1.8666 | Val  Acc: 0.5652
 Site-webcam                        | Val  Loss: 1.7877 | Val  Acc: 0.7826
 Site-Clipart                       | Val  Loss: 1.8815 | Val  Acc: 0.7059
 Site-Clipart                       | Val  Loss: 1.8378 | Val  Acc: 0.7647
 Site-dslr                          | Val  Loss: 1.8060 | Val  Acc: 0.7250
 Site-Product                       | Val  Loss: 1.7289 | Val  Acc: 0.8667
Average Valid Accuracy: 0.7769
 Best site-amazon                    | Epoch:0 | Val Acc: 0.8125
 Best site-amazon                    | Epoch:0 | Val Acc: 0.8000
 Best site-amazon                    | Epoch:0 | Val Acc: 0.8378
 Best site-amazon                    | Epoch:0 | Val Acc: 0.7857
 Best site-amazon                    | Epoch:0 | Val Acc: 0.8452
 Best site-Art                       | Epoch:0 | Val Acc: 0.7692
 Best site-Art                       | Epoch:0 | Val Acc: 0.7619
 Best site-Art                       | Epoch:0 | Val Acc: 0.6765
 Best site-Art                       | Epoch:0 | Val Acc: 0.7273
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.8750
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.8621
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.8200
 Best site-webcam                    | Epoch:0 | Val Acc: 0.5652
 Best site-webcam                    | Epoch:0 | Val Acc: 0.7826
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.7059
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.7647
 Best site-dslr                      | Epoch:0 | Val Acc: 0.7250
 Best site-Product                   | Epoch:0 | Val Acc: 0.8667
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/harmo-fl...
============ Train epoch 1 ============
 Site-amazon                        | Train Loss: 1.4453 | Train Acc: 0.6400
 Site-amazon                        | Train Loss: 1.3200 | Train Acc: 0.8421
 Site-amazon                        | Train Loss: 1.3298 | Train Acc: 0.8393
 Site-amazon                        | Train Loss: 1.2939 | Train Acc: 0.8824
 Site-amazon                        | Train Loss: 1.2823 | Train Acc: 0.8425
 Site-Art                           | Train Loss: 1.5649 | Train Acc: 0.7500
 Site-Art                           | Train Loss: 1.6497 | Train Acc: 0.7879
 Site-Art                           | Train Loss: 1.5945 | Train Acc: 0.8462
 Site-Art                           | Train Loss: 1.6460 | Train Acc: 0.7590
 Site-RealWorld                     | Train Loss: 1.4410 | Train Acc: 0.8800
 Site-RealWorld                     | Train Loss: 1.3307 | Train Acc: 0.8605
 Site-RealWorld                     | Train Loss: 1.3562 | Train Acc: 0.8800
 Site-webcam                        | Train Loss: 1.1900 | Train Acc: 0.9412
 Site-webcam                        | Train Loss: 1.3493 | Train Acc: 0.9853
 Site-Clipart                       | Train Loss: 1.6171 | Train Acc: 0.7308
 Site-Clipart                       | Train Loss: 1.4858 | Train Acc: 0.8269
 Site-dslr                          | Train Loss: 1.3278 | Train Acc: 0.9833
 Site-Product                       | Train Loss: 1.2878 | Train Acc: 0.8667
Average Train Accuracy: 0.8413
 Site-amazon                        | Val  Loss: 1.2763 | Val  Acc: 0.8750
 Site-amazon                        | Val  Loss: 1.2677 | Val  Acc: 0.8400
 Site-amazon                        | Val  Loss: 1.2630 | Val  Acc: 0.8378
 Site-amazon                        | Val  Loss: 1.3107 | Val  Acc: 0.8214
 Site-amazon                        | Val  Loss: 1.2840 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.5876 | Val  Acc: 0.6923
 Site-Art                           | Val  Loss: 1.5936 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.7298 | Val  Acc: 0.7647
 Site-Art                           | Val  Loss: 1.6244 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 1.3964 | Val  Acc: 0.8750
 Site-RealWorld                     | Val  Loss: 1.2829 | Val  Acc: 0.9655
 Site-RealWorld                     | Val  Loss: 1.3438 | Val  Acc: 0.8800
 Site-webcam                        | Val  Loss: 1.4561 | Val  Acc: 0.9130
 Site-webcam                        | Val  Loss: 1.4029 | Val  Acc: 0.8913
 Site-Clipart                       | Val  Loss: 1.4492 | Val  Acc: 0.8824
 Site-Clipart                       | Val  Loss: 1.4522 | Val  Acc: 0.8235
 Site-dslr                          | Val  Loss: 1.3397 | Val  Acc: 0.9250
 Site-Product                       | Val  Loss: 1.2828 | Val  Acc: 0.9333
Average Valid Accuracy: 0.8575
 Best site-amazon                    | Epoch:1 | Val Acc: 0.8750
 Best site-amazon                    | Epoch:1 | Val Acc: 0.8400
 Best site-amazon                    | Epoch:1 | Val Acc: 0.8378
 Best site-amazon                    | Epoch:1 | Val Acc: 0.8214
 Best site-amazon                    | Epoch:1 | Val Acc: 0.8571
 Best site-Art                       | Epoch:1 | Val Acc: 0.6923
 Best site-Art                       | Epoch:1 | Val Acc: 0.8571
 Best site-Art                       | Epoch:1 | Val Acc: 0.7647
 Best site-Art                       | Epoch:1 | Val Acc: 0.8000
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.8750
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.9655
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.8800
 Best site-webcam                    | Epoch:1 | Val Acc: 0.9130
 Best site-webcam                    | Epoch:1 | Val Acc: 0.8913
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.8824
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.8235
 Best site-dslr                      | Epoch:1 | Val Acc: 0.9250
 Best site-Product                   | Epoch:1 | Val Acc: 0.9333
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/harmo-fl...
============ Train epoch 2 ============
 Site-amazon                        | Train Loss: 1.1458 | Train Acc: 0.6800
 Site-amazon                        | Train Loss: 1.0430 | Train Acc: 0.8947
 Site-amazon                        | Train Loss: 1.0118 | Train Acc: 0.8750
 Site-amazon                        | Train Loss: 0.8661 | Train Acc: 0.8824
 Site-amazon                        | Train Loss: 0.9668 | Train Acc: 0.8661
 Site-Art                           | Train Loss: 1.3436 | Train Acc: 0.7500
 Site-Art                           | Train Loss: 1.3780 | Train Acc: 0.8485
 Site-Art                           | Train Loss: 1.3180 | Train Acc: 0.8462
 Site-Art                           | Train Loss: 1.3471 | Train Acc: 0.8072
 Site-RealWorld                     | Train Loss: 1.1305 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.0143 | Train Acc: 0.9070
 Site-RealWorld                     | Train Loss: 1.1331 | Train Acc: 0.8933
 Site-webcam                        | Train Loss: 0.8102 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.9756 | Train Acc: 1.0000
 Site-Clipart                       | Train Loss: 1.3819 | Train Acc: 0.7692
 Site-Clipart                       | Train Loss: 1.1660 | Train Acc: 0.8269
 Site-dslr                          | Train Loss: 1.0111 | Train Acc: 0.9667
 Site-Product                       | Train Loss: 0.9625 | Train Acc: 0.9111
Average Train Accuracy: 0.8691
 Site-amazon                        | Val  Loss: 1.0103 | Val  Acc: 0.8750
 Site-amazon                        | Val  Loss: 0.9777 | Val  Acc: 0.8400
 Site-amazon                        | Val  Loss: 0.9256 | Val  Acc: 0.8649
 Site-amazon                        | Val  Loss: 1.0044 | Val  Acc: 0.8571
 Site-amazon                        | Val  Loss: 1.0127 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.2903 | Val  Acc: 0.6923
 Site-Art                           | Val  Loss: 1.2821 | Val  Acc: 0.9048
 Site-Art                           | Val  Loss: 1.5421 | Val  Acc: 0.8235
 Site-Art                           | Val  Loss: 1.4488 | Val  Acc: 0.7636
 Site-RealWorld                     | Val  Loss: 1.1003 | Val  Acc: 0.8750
 Site-RealWorld                     | Val  Loss: 0.9132 | Val  Acc: 0.9655
 Site-RealWorld                     | Val  Loss: 1.0306 | Val  Acc: 0.9200
 Site-webcam                        | Val  Loss: 1.1752 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 1.0761 | Val  Acc: 0.9783
 Site-Clipart                       | Val  Loss: 1.2199 | Val  Acc: 0.8824
 Site-Clipart                       | Val  Loss: 1.2194 | Val  Acc: 0.8529
 Site-dslr                          | Val  Loss: 1.0304 | Val  Acc: 0.9750
 Site-Product                       | Val  Loss: 0.9637 | Val  Acc: 0.9000
Average Valid Accuracy: 0.8769
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8750
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8400
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8649
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8571
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8571
 Best site-Art                       | Epoch:2 | Val Acc: 0.6923
 Best site-Art                       | Epoch:2 | Val Acc: 0.9048
 Best site-Art                       | Epoch:2 | Val Acc: 0.8235
 Best site-Art                       | Epoch:2 | Val Acc: 0.7636
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.8750
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.9655
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.9200
 Best site-webcam                    | Epoch:2 | Val Acc: 0.9565
 Best site-webcam                    | Epoch:2 | Val Acc: 0.9783
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8824
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8529
 Best site-dslr                      | Epoch:2 | Val Acc: 0.9750
 Best site-Product                   | Epoch:2 | Val Acc: 0.9000
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/harmo-fl...
============ Train epoch 3 ============
 Site-amazon                        | Train Loss: 0.9557 | Train Acc: 0.7600
 Site-amazon                        | Train Loss: 0.8160 | Train Acc: 0.8684
 Site-amazon                        | Train Loss: 0.7920 | Train Acc: 0.8750
 Site-amazon                        | Train Loss: 0.6882 | Train Acc: 0.9059
 Site-amazon                        | Train Loss: 0.7547 | Train Acc: 0.8583
 Site-Art                           | Train Loss: 1.1130 | Train Acc: 0.8500
 Site-Art                           | Train Loss: 1.1546 | Train Acc: 0.8182
 Site-Art                           | Train Loss: 1.1386 | Train Acc: 0.8462
 Site-Art                           | Train Loss: 1.1163 | Train Acc: 0.8554
 Site-RealWorld                     | Train Loss: 0.8929 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 0.7718 | Train Acc: 0.8837
 Site-RealWorld                     | Train Loss: 0.7708 | Train Acc: 0.9067
 Site-webcam                        | Train Loss: 0.5771 | Train Acc: 0.9706
 Site-webcam                        | Train Loss: 0.9479 | Train Acc: 0.9706
 Site-Clipart                       | Train Loss: 1.2298 | Train Acc: 0.7308
 Site-Clipart                       | Train Loss: 1.0483 | Train Acc: 0.8269
 Site-dslr                          | Train Loss: 0.7408 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.7484 | Train Acc: 0.9556
Average Train Accuracy: 0.8779
 Site-amazon                        | Val  Loss: 0.7352 | Val  Acc: 0.8750
 Site-amazon                        | Val  Loss: 0.7128 | Val  Acc: 0.8800
 Site-amazon                        | Val  Loss: 0.7211 | Val  Acc: 0.8649
 Site-amazon                        | Val  Loss: 0.7917 | Val  Acc: 0.8750
 Site-amazon                        | Val  Loss: 0.7566 | Val  Acc: 0.9048
 Site-Art                           | Val  Loss: 1.0979 | Val  Acc: 0.6923
 Site-Art                           | Val  Loss: 1.1474 | Val  Acc: 0.9048
 Site-Art                           | Val  Loss: 1.3752 | Val  Acc: 0.7059
 Site-Art                           | Val  Loss: 1.2582 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 0.8653 | Val  Acc: 0.8750
 Site-RealWorld                     | Val  Loss: 0.7187 | Val  Acc: 0.9310
 Site-RealWorld                     | Val  Loss: 0.8281 | Val  Acc: 0.9000
 Site-webcam                        | Val  Loss: 0.9068 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.8537 | Val  Acc: 0.9783
 Site-Clipart                       | Val  Loss: 0.9678 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.9866 | Val  Acc: 0.8824
 Site-dslr                          | Val  Loss: 0.7848 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6983 | Val  Acc: 0.9667
Average Valid Accuracy: 0.8876
 Best site-amazon                    | Epoch:3 | Val Acc: 0.8750
 Best site-amazon                    | Epoch:3 | Val Acc: 0.8800
 Best site-amazon                    | Epoch:3 | Val Acc: 0.8649
 Best site-amazon                    | Epoch:3 | Val Acc: 0.8750
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9048
 Best site-Art                       | Epoch:3 | Val Acc: 0.6923
 Best site-Art                       | Epoch:3 | Val Acc: 0.9048
 Best site-Art                       | Epoch:3 | Val Acc: 0.7059
 Best site-Art                       | Epoch:3 | Val Acc: 0.8000
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.8750
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.9310
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.9000
 Best site-webcam                    | Epoch:3 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:3 | Val Acc: 0.9783
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8824
 Best site-dslr                      | Epoch:3 | Val Acc: 1.0000
 Best site-Product                   | Epoch:3 | Val Acc: 0.9667
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/harmo-fl...
============ Train epoch 4 ============
 Site-amazon                        | Train Loss: 0.9079 | Train Acc: 0.7600
 Site-amazon                        | Train Loss: 0.6118 | Train Acc: 0.9211
 Site-amazon                        | Train Loss: 0.6494 | Train Acc: 0.8929
 Site-amazon                        | Train Loss: 0.5788 | Train Acc: 0.9176
 Site-amazon                        | Train Loss: 0.6037 | Train Acc: 0.8976
 Site-Art                           | Train Loss: 0.9866 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 0.9898 | Train Acc: 0.8182
 Site-Art                           | Train Loss: 1.0499 | Train Acc: 0.8846
 Site-Art                           | Train Loss: 1.0893 | Train Acc: 0.8313
 Site-RealWorld                     | Train Loss: 0.7617 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 0.6356 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 0.6326 | Train Acc: 0.8800
 Site-webcam                        | Train Loss: 0.4422 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.7165 | Train Acc: 0.9853
 Site-Clipart                       | Train Loss: 1.1676 | Train Acc: 0.7692
 Site-Clipart                       | Train Loss: 0.9023 | Train Acc: 0.8077
 Site-dslr                          | Train Loss: 0.6011 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5879 | Train Acc: 0.9333
Average Train Accuracy: 0.8883
 Site-amazon                        | Val  Loss: 0.5413 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.5899 | Val  Acc: 0.8800
 Site-amazon                        | Val  Loss: 0.6045 | Val  Acc: 0.8919
 Site-amazon                        | Val  Loss: 0.6487 | Val  Acc: 0.9286
 Site-amazon                        | Val  Loss: 0.5949 | Val  Acc: 0.9048
 Site-Art                           | Val  Loss: 0.8739 | Val  Acc: 0.7692
 Site-Art                           | Val  Loss: 0.8779 | Val  Acc: 0.9048
 Site-Art                           | Val  Loss: 1.1840 | Val  Acc: 0.7941
 Site-Art                           | Val  Loss: 1.1483 | Val  Acc: 0.7818
 Site-RealWorld                     | Val  Loss: 0.6175 | Val  Acc: 0.8750
 Site-RealWorld                     | Val  Loss: 0.5684 | Val  Acc: 0.9310
 Site-RealWorld                     | Val  Loss: 0.6659 | Val  Acc: 0.9200
 Site-webcam                        | Val  Loss: 0.7624 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.6776 | Val  Acc: 1.0000
 Site-Clipart                       | Val  Loss: 0.9079 | Val  Acc: 0.8824
 Site-Clipart                       | Val  Loss: 0.8383 | Val  Acc: 0.8824
 Site-dslr                          | Val  Loss: 0.6509 | Val  Acc: 0.9750
 Site-Product                       | Val  Loss: 0.5494 | Val  Acc: 0.9333
Average Valid Accuracy: 0.9006
 Best site-amazon                    | Epoch:4 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:4 | Val Acc: 0.8800
 Best site-amazon                    | Epoch:4 | Val Acc: 0.8919
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9286
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9048
 Best site-Art                       | Epoch:4 | Val Acc: 0.7692
 Best site-Art                       | Epoch:4 | Val Acc: 0.9048
 Best site-Art                       | Epoch:4 | Val Acc: 0.7941
 Best site-Art                       | Epoch:4 | Val Acc: 0.7818
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.8750
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.9310
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.9200
 Best site-webcam                    | Epoch:4 | Val Acc: 0.9565
 Best site-webcam                    | Epoch:4 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8824
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8824
 Best site-dslr                      | Epoch:4 | Val Acc: 0.9750
 Best site-Product                   | Epoch:4 | Val Acc: 0.9333
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/harmo-fl...
============ Train epoch 5 ============
 Site-amazon                        | Train Loss: 0.7397 | Train Acc: 0.8000
 Site-amazon                        | Train Loss: 0.5281 | Train Acc: 0.9211
 Site-amazon                        | Train Loss: 0.5442 | Train Acc: 0.8929
 Site-amazon                        | Train Loss: 0.5430 | Train Acc: 0.9412
 Site-amazon                        | Train Loss: 0.5188 | Train Acc: 0.9055
 Site-Art                           | Train Loss: 0.8601 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 0.8466 | Train Acc: 0.8182
 Site-Art                           | Train Loss: 0.8954 | Train Acc: 0.9038
 Site-Art                           | Train Loss: 0.8704 | Train Acc: 0.8554
 Site-RealWorld                     | Train Loss: 0.6515 | Train Acc: 0.8800
 Site-RealWorld                     | Train Loss: 0.5175 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 0.5001 | Train Acc: 0.9200
 Site-webcam                        | Train Loss: 0.3364 | Train Acc: 0.9706
 Site-webcam                        | Train Loss: 0.5634 | Train Acc: 0.9706
 Site-Clipart                       | Train Loss: 1.1337 | Train Acc: 0.7692
 Site-Clipart                       | Train Loss: 0.7633 | Train Acc: 0.8462
 Site-dslr                          | Train Loss: 0.4949 | Train Acc: 0.9667
 Site-Product                       | Train Loss: 0.4227 | Train Acc: 0.9333
Average Train Accuracy: 0.8903
 Site-amazon                        | Val  Loss: 0.5481 | Val  Acc: 0.8750
 Site-amazon                        | Val  Loss: 0.4685 | Val  Acc: 0.8800
 Site-amazon                        | Val  Loss: 0.4968 | Val  Acc: 0.9189
 Site-amazon                        | Val  Loss: 0.5442 | Val  Acc: 0.9464
 Site-amazon                        | Val  Loss: 0.5307 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.7966 | Val  Acc: 0.7692
 Site-Art                           | Val  Loss: 0.8804 | Val  Acc: 0.9048
 Site-Art                           | Val  Loss: 1.0525 | Val  Acc: 0.8824
 Site-Art                           | Val  Loss: 0.9882 | Val  Acc: 0.7818
 Site-RealWorld                     | Val  Loss: 0.6053 | Val  Acc: 0.8750
 Site-RealWorld                     | Val  Loss: 0.4584 | Val  Acc: 0.9310
 Site-RealWorld                     | Val  Loss: 0.5825 | Val  Acc: 0.9200
 Site-webcam                        | Val  Loss: 0.5863 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.5876 | Val  Acc: 0.9783
 Site-Clipart                       | Val  Loss: 0.7438 | Val  Acc: 0.8824
 Site-Clipart                       | Val  Loss: 0.7181 | Val  Acc: 0.9118
 Site-dslr                          | Val  Loss: 0.5043 | Val  Acc: 0.9750
 Site-Product                       | Val  Loss: 0.4289 | Val  Acc: 0.9667
Average Valid Accuracy: 0.9046
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8750
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8800
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9189
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9464
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9286
 Best site-Art                       | Epoch:5 | Val Acc: 0.7692
 Best site-Art                       | Epoch:5 | Val Acc: 0.9048
 Best site-Art                       | Epoch:5 | Val Acc: 0.8824
 Best site-Art                       | Epoch:5 | Val Acc: 0.7818
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.8750
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.9310
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.9200
 Best site-webcam                    | Epoch:5 | Val Acc: 0.9565
 Best site-webcam                    | Epoch:5 | Val Acc: 0.9783
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8824
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.9118
 Best site-dslr                      | Epoch:5 | Val Acc: 0.9750
 Best site-Product                   | Epoch:5 | Val Acc: 0.9667
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/harmo-fl...
============ Train epoch 6 ============
 Site-amazon                        | Train Loss: 0.7086 | Train Acc: 0.7200
 Site-amazon                        | Train Loss: 0.4451 | Train Acc: 0.9211
 Site-amazon                        | Train Loss: 0.4803 | Train Acc: 0.8929
 Site-amazon                        | Train Loss: 0.3651 | Train Acc: 0.9412
 Site-amazon                        | Train Loss: 0.4567 | Train Acc: 0.8976
 Site-Art                           | Train Loss: 0.7928 | Train Acc: 0.9000
 Site-Art                           | Train Loss: 0.8613 | Train Acc: 0.6667
 Site-Art                           | Train Loss: 0.7561 | Train Acc: 0.8654
 Site-Art                           | Train Loss: 0.8263 | Train Acc: 0.8675
 Site-RealWorld                     | Train Loss: 0.5617 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 0.4599 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 0.4170 | Train Acc: 0.9067
 Site-webcam                        | Train Loss: 0.2719 | Train Acc: 0.9706
 Site-webcam                        | Train Loss: 0.3799 | Train Acc: 0.9853
 Site-Clipart                       | Train Loss: 1.0676 | Train Acc: 0.7692
 Site-Clipart                       | Train Loss: 0.7059 | Train Acc: 0.8077
 Site-dslr                          | Train Loss: 0.3985 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 0.4096 | Train Acc: 0.9333
Average Train Accuracy: 0.8803
 Site-amazon                        | Val  Loss: 0.4516 | Val  Acc: 0.9375
 Site-amazon                        | Val  Loss: 0.4541 | Val  Acc: 0.8800
 Site-amazon                        | Val  Loss: 0.4391 | Val  Acc: 0.9189
 Site-amazon                        | Val  Loss: 0.5037 | Val  Acc: 0.9286
 Site-amazon                        | Val  Loss: 0.4401 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.6486 | Val  Acc: 0.8462
 Site-Art                           | Val  Loss: 0.6483 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.9348 | Val  Acc: 0.8824
 Site-Art                           | Val  Loss: 0.8688 | Val  Acc: 0.8727
 Site-RealWorld                     | Val  Loss: 0.5201 | Val  Acc: 0.8750
 Site-RealWorld                     | Val  Loss: 0.4055 | Val  Acc: 0.9310
 Site-RealWorld                     | Val  Loss: 0.5637 | Val  Acc: 0.9200
 Site-webcam                        | Val  Loss: 0.5830 | Val  Acc: 0.9130
 Site-webcam                        | Val  Loss: 0.4930 | Val  Acc: 0.9565
 Site-Clipart                       | Val  Loss: 0.5972 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.6562 | Val  Acc: 0.9118
 Site-dslr                          | Val  Loss: 0.4285 | Val  Acc: 0.9750
 Site-Product                       | Val  Loss: 0.4140 | Val  Acc: 0.9333
Average Valid Accuracy: 0.9116
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9375
 Best site-amazon                    | Epoch:6 | Val Acc: 0.8800
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9189
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9286
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9286
 Best site-Art                       | Epoch:6 | Val Acc: 0.8462
 Best site-Art                       | Epoch:6 | Val Acc: 0.8571
 Best site-Art                       | Epoch:6 | Val Acc: 0.8824
 Best site-Art                       | Epoch:6 | Val Acc: 0.8727
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.8750
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.9310
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.9200
 Best site-webcam                    | Epoch:6 | Val Acc: 0.9130
 Best site-webcam                    | Epoch:6 | Val Acc: 0.9565
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.9118
 Best site-dslr                      | Epoch:6 | Val Acc: 0.9750
 Best site-Product                   | Epoch:6 | Val Acc: 0.9333
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/harmo-fl...
============ Train epoch 7 ============
 Site-amazon                        | Train Loss: 0.6706 | Train Acc: 0.8000
 Site-amazon                        | Train Loss: 0.4261 | Train Acc: 0.9211
 Site-amazon                        | Train Loss: 0.4428 | Train Acc: 0.9107
 Site-amazon                        | Train Loss: 0.3502 | Train Acc: 0.9529
 Site-amazon                        | Train Loss: 0.4239 | Train Acc: 0.9134
 Site-Art                           | Train Loss: 0.7107 | Train Acc: 0.8500
 Site-Art                           | Train Loss: 0.7582 | Train Acc: 0.7273
 Site-Art                           | Train Loss: 0.6864 | Train Acc: 0.8846
 Site-Art                           | Train Loss: 0.7097 | Train Acc: 0.8916
 Site-RealWorld                     | Train Loss: 0.4847 | Train Acc: 0.8800
 Site-RealWorld                     | Train Loss: 0.3933 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 0.4311 | Train Acc: 0.9333
 Site-webcam                        | Train Loss: 0.2491 | Train Acc: 0.9412
 Site-webcam                        | Train Loss: 0.3537 | Train Acc: 0.9706
 Site-Clipart                       | Train Loss: 0.9395 | Train Acc: 0.7308
 Site-Clipart                       | Train Loss: 0.6151 | Train Acc: 0.8846
 Site-dslr                          | Train Loss: 0.3337 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3417 | Train Acc: 0.9111
Average Train Accuracy: 0.8907
 Site-amazon                        | Val  Loss: 0.2987 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.3710 | Val  Acc: 0.9200
 Site-amazon                        | Val  Loss: 0.4406 | Val  Acc: 0.9189
 Site-amazon                        | Val  Loss: 0.4477 | Val  Acc: 0.9286
 Site-amazon                        | Val  Loss: 0.3893 | Val  Acc: 0.9405
 Site-Art                           | Val  Loss: 0.5832 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.6113 | Val  Acc: 0.9524
 Site-Art                           | Val  Loss: 0.8969 | Val  Acc: 0.8824
 Site-Art                           | Val  Loss: 0.8235 | Val  Acc: 0.8545
 Site-RealWorld                     | Val  Loss: 0.3423 | Val  Acc: 0.9375
 Site-RealWorld                     | Val  Loss: 0.3651 | Val  Acc: 0.9310
 Site-RealWorld                     | Val  Loss: 0.5330 | Val  Acc: 0.9200
 Site-webcam                        | Val  Loss: 0.4457 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.4465 | Val  Acc: 0.9565
 Site-Clipart                       | Val  Loss: 0.6750 | Val  Acc: 0.9412
 Site-Clipart                       | Val  Loss: 0.5252 | Val  Acc: 0.9118
 Site-dslr                          | Val  Loss: 0.3647 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 0.3296 | Val  Acc: 0.9667
Average Valid Accuracy: 0.9329
 Best site-amazon                    | Epoch:7 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9200
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9189
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9286
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9405
 Best site-Art                       | Epoch:7 | Val Acc: 0.9231
 Best site-Art                       | Epoch:7 | Val Acc: 0.9524
 Best site-Art                       | Epoch:7 | Val Acc: 0.8824
 Best site-Art                       | Epoch:7 | Val Acc: 0.8545
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.9375
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.9310
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.9200
 Best site-webcam                    | Epoch:7 | Val Acc: 0.9565
 Best site-webcam                    | Epoch:7 | Val Acc: 0.9565
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9118
 Best site-dslr                      | Epoch:7 | Val Acc: 0.9500
 Best site-Product                   | Epoch:7 | Val Acc: 0.9667
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/harmo-fl...
============ Train epoch 8 ============
 Site-amazon                        | Train Loss: 0.6572 | Train Acc: 0.7600
 Site-amazon                        | Train Loss: 0.3585 | Train Acc: 0.9211
 Site-amazon                        | Train Loss: 0.3906 | Train Acc: 0.9107
 Site-amazon                        | Train Loss: 0.2838 | Train Acc: 0.9647
 Site-amazon                        | Train Loss: 0.3527 | Train Acc: 0.9528
 Site-Art                           | Train Loss: 0.5213 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.7593 | Train Acc: 0.7879
 Site-Art                           | Train Loss: 0.6720 | Train Acc: 0.8846
 Site-Art                           | Train Loss: 0.6275 | Train Acc: 0.9036
 Site-RealWorld                     | Train Loss: 0.4443 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 0.3706 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 0.3834 | Train Acc: 0.8800
 Site-webcam                        | Train Loss: 0.2039 | Train Acc: 0.9412
 Site-webcam                        | Train Loss: 0.2522 | Train Acc: 0.9412
 Site-Clipart                       | Train Loss: 0.9797 | Train Acc: 0.7308
 Site-Clipart                       | Train Loss: 0.6303 | Train Acc: 0.8269
 Site-dslr                          | Train Loss: 0.2873 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2712 | Train Acc: 0.9333
Average Train Accuracy: 0.8994
 Site-amazon                        | Val  Loss: 0.2500 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.3398 | Val  Acc: 0.9200
 Site-amazon                        | Val  Loss: 0.4123 | Val  Acc: 0.9459
 Site-amazon                        | Val  Loss: 0.3470 | Val  Acc: 0.9643
 Site-amazon                        | Val  Loss: 0.3585 | Val  Acc: 0.9405
 Site-Art                           | Val  Loss: 0.4806 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.5996 | Val  Acc: 0.9048
 Site-Art                           | Val  Loss: 0.8484 | Val  Acc: 0.8529
 Site-Art                           | Val  Loss: 0.7583 | Val  Acc: 0.8909
 Site-RealWorld                     | Val  Loss: 0.3674 | Val  Acc: 0.9375
 Site-RealWorld                     | Val  Loss: 0.3249 | Val  Acc: 0.9310
 Site-RealWorld                     | Val  Loss: 0.4796 | Val  Acc: 0.9200
 Site-webcam                        | Val  Loss: 0.4829 | Val  Acc: 0.9130
 Site-webcam                        | Val  Loss: 0.3603 | Val  Acc: 0.9783
 Site-Clipart                       | Val  Loss: 0.6756 | Val  Acc: 0.8824
 Site-Clipart                       | Val  Loss: 0.5434 | Val  Acc: 0.9118
 Site-dslr                          | Val  Loss: 0.2901 | Val  Acc: 0.9750
 Site-Product                       | Val  Loss: 0.2554 | Val  Acc: 0.9333
Average Valid Accuracy: 0.9291
============ Train epoch 9 ============
 Site-amazon                        | Train Loss: 0.5371 | Train Acc: 0.8400
 Site-amazon                        | Train Loss: 0.3217 | Train Acc: 0.9474
 Site-amazon                        | Train Loss: 0.3436 | Train Acc: 0.9107
 Site-amazon                        | Train Loss: 0.2621 | Train Acc: 0.9529
 Site-amazon                        | Train Loss: 0.3664 | Train Acc: 0.9291
 Site-Art                           | Train Loss: 0.5298 | Train Acc: 0.9500
 Site-Art                           | Train Loss: 0.6281 | Train Acc: 0.8182
 Site-Art                           | Train Loss: 0.5397 | Train Acc: 0.9231
 Site-Art                           | Train Loss: 0.6433 | Train Acc: 0.8675
 Site-RealWorld                     | Train Loss: 0.4216 | Train Acc: 0.8800
 Site-RealWorld                     | Train Loss: 0.3363 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 0.5038 | Train Acc: 0.8800
 Site-webcam                        | Train Loss: 0.1432 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.2727 | Train Acc: 0.9853
 Site-Clipart                       | Train Loss: 0.9719 | Train Acc: 0.6923
 Site-Clipart                       | Train Loss: 0.6213 | Train Acc: 0.8077
 Site-dslr                          | Train Loss: 0.2569 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2901 | Train Acc: 0.9111
Average Train Accuracy: 0.9014
 Site-amazon                        | Val  Loss: 0.2538 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.3058 | Val  Acc: 0.9600
 Site-amazon                        | Val  Loss: 0.3555 | Val  Acc: 0.9189
 Site-amazon                        | Val  Loss: 0.3408 | Val  Acc: 0.9464
 Site-amazon                        | Val  Loss: 0.2861 | Val  Acc: 0.9524
 Site-Art                           | Val  Loss: 0.4521 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.4773 | Val  Acc: 0.9048
 Site-Art                           | Val  Loss: 0.7410 | Val  Acc: 0.8529
 Site-Art                           | Val  Loss: 0.7164 | Val  Acc: 0.8545
 Site-RealWorld                     | Val  Loss: 0.4370 | Val  Acc: 0.9375
 Site-RealWorld                     | Val  Loss: 0.2594 | Val  Acc: 0.9310
 Site-RealWorld                     | Val  Loss: 0.4590 | Val  Acc: 0.9200
 Site-webcam                        | Val  Loss: 0.4606 | Val  Acc: 0.9130
 Site-webcam                        | Val  Loss: 0.3365 | Val  Acc: 0.9783
 Site-Clipart                       | Val  Loss: 0.5151 | Val  Acc: 0.8824
 Site-Clipart                       | Val  Loss: 0.5603 | Val  Acc: 0.8824
 Site-dslr                          | Val  Loss: 0.3106 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 0.2544 | Val  Acc: 0.9333
Average Valid Accuracy: 0.9245
===2023-08-05 14:31:01===
===2023-08-05 14:31:09===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[25,38,56,85,127,20,33,52,83,25,43,75,34,68,26,52,60,45,
client_nums=[5,4,3,2,2,1,1,]
len_dataset=[555,317,241,173,132,100,76,]
domain number = 7
Loading snapshots...
 Test site-amazon                    (2)| Epoch:7 | Test Acc: 0.9215
 Test site-Art                       (1)| Epoch:7 | Test Acc: 0.8592
 Test site-RealWorld                 (1)| Epoch:7 | Test Acc: 0.9058
 Test site-webcam                    (5)| Epoch:7 | Test Acc: 0.9620
 Test site-Clipart                   (0)| Epoch:7 | Test Acc: 0.8677
 Test site-dslr                      (3)| Epoch:7 | Test Acc: 0.9796
 Test site-Product                   (4)| Epoch:7 | Test Acc: 0.9463
amazon: 0.9215, Art: 0.8592, RealWorld: 0.9058, webcam: 0.9620, Clipart: 0.8677, dslr: 0.9796, Product: 0.9463, 
Average Test Accuracy(group): 0.9203, Average Test Accuracy(individual): 0.9082,
domain std=0.0425, cluster std=0.0388, individual std=0.0381, 
