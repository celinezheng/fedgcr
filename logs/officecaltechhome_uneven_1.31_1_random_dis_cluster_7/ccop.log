===2023-08-05 13:54:21===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[25,38,56,85,127,20,33,52,83,25,43,75,34,68,26,52,60,45,
client_nums=[5,4,3,2,2,1,1,]
len_dataset=[555,317,241,173,132,100,76,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[6, 3, 1, 1, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-amazon                    (0) | Train Loss: 2.1150 | Train Acc: 0.3200
 Site-amazon                    (0) | Train Loss: 2.1410 | Train Acc: 0.1842
 Site-amazon                    (0) | Train Loss: 2.1216 | Train Acc: 0.2857
 Site-amazon                    (0) | Train Loss: 2.0550 | Train Acc: 0.3529
 Site-amazon                    (0) | Train Loss: 2.0875 | Train Acc: 0.3071
 Site-Art                       (2) | Train Loss: 2.3550 | Train Acc: 0.0000
 Site-Art                       (3) | Train Loss: 2.2869 | Train Acc: 0.1212
 Site-Art                       (5) | Train Loss: 2.2614 | Train Acc: 0.1538
 Site-Art                       (5) | Train Loss: 2.2430 | Train Acc: 0.1687
 Site-RealWorld                 (1) | Train Loss: 2.2026 | Train Acc: 0.2000
 Site-RealWorld                 (1) | Train Loss: 2.1976 | Train Acc: 0.1628
 Site-RealWorld                 (1) | Train Loss: 2.0777 | Train Acc: 0.2933
 Site-webcam                    (4) | Train Loss: 2.1570 | Train Acc: 0.2647
 Site-webcam                    (4) | Train Loss: 2.2778 | Train Acc: 0.2206
 Site-Clipart                   (6) | Train Loss: 2.2554 | Train Acc: 0.1154
 Site-Clipart                   (6) | Train Loss: 2.1470 | Train Acc: 0.2885
 Site-dslr                      (4) | Train Loss: 2.2786 | Train Acc: 0.1667
 Site-Product                   (0) | Train Loss: 2.1187 | Train Acc: 0.2889
Average Train Accuracy: 0.2164
 Site-amazon                    (0) | Val  Loss: 2.2299 | Val  Acc: 0.0625
 Site-amazon                    (0) | Val  Loss: 2.1521 | Val  Acc: 0.2400
 Site-amazon                    (0) | Val  Loss: 2.0480 | Val  Acc: 0.4595
 Site-amazon                    (0) | Val  Loss: 2.0789 | Val  Acc: 0.3393
 Site-amazon                    (0) | Val  Loss: 2.0830 | Val  Acc: 0.3452
 Site-Art                       (2) | Val  Loss: 2.4247 | Val  Acc: 0.0000
 Site-Art                       (3) | Val  Loss: 2.2680 | Val  Acc: 0.1905
 Site-Art                       (5) | Val  Loss: 2.2920 | Val  Acc: 0.1765
 Site-Art                       (5) | Val  Loss: 2.2642 | Val  Acc: 0.1818
 Site-RealWorld                 (1) | Val  Loss: 2.2151 | Val  Acc: 0.1875
 Site-RealWorld                 (1) | Val  Loss: 2.1269 | Val  Acc: 0.3448
 Site-RealWorld                 (1) | Val  Loss: 2.1467 | Val  Acc: 0.3000
 Site-webcam                    (4) | Val  Loss: 2.2328 | Val  Acc: 0.1304
 Site-webcam                    (4) | Val  Loss: 2.1994 | Val  Acc: 0.2174
 Site-Clipart                   (6) | Val  Loss: 2.0996 | Val  Acc: 0.2941
 Site-Clipart                   (6) | Val  Loss: 2.1470 | Val  Acc: 0.2941
 Site-dslr                      (4) | Val  Loss: 2.2146 | Val  Acc: 0.2000
 Site-Product                   (0) | Val  Loss: 2.1673 | Val  Acc: 0.2667
Average Valid Accuracy: 0.2350
 Best site-amazon                   (0)  | Epoch:0 | Val Acc: 0.0625
 Best site-amazon                   (0)  | Epoch:0 | Val Acc: 0.2400
 Best site-amazon                   (0)  | Epoch:0 | Val Acc: 0.4595
 Best site-amazon                   (0)  | Epoch:0 | Val Acc: 0.3393
 Best site-amazon                   (0)  | Epoch:0 | Val Acc: 0.3452
 Best site-Art                      (2)  | Epoch:0 | Val Acc: 0.0000
 Best site-Art                      (3)  | Epoch:0 | Val Acc: 0.1905
 Best site-Art                      (5)  | Epoch:0 | Val Acc: 0.1765
 Best site-Art                      (5)  | Epoch:0 | Val Acc: 0.1818
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.1875
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.3448
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.3000
 Best site-webcam                   (4)  | Epoch:0 | Val Acc: 0.1304
 Best site-webcam                   (4)  | Epoch:0 | Val Acc: 0.2174
 Best site-Clipart                  (6)  | Epoch:0 | Val Acc: 0.2941
 Best site-Clipart                  (6)  | Epoch:0 | Val Acc: 0.2941
 Best site-dslr                     (4)  | Epoch:0 | Val Acc: 0.2000
 Best site-Product                  (0)  | Epoch:0 | Val Acc: 0.2667
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1...
============ Train epoch 1 ============
cnt=[6, 1, 1, 1, 3, 1, 5, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-amazon                    (6) | Train Loss: 2.0214 | Train Acc: 0.4000
 Site-amazon                    (1) | Train Loss: 2.0026 | Train Acc: 0.2632
 Site-amazon                    (6) | Train Loss: 1.9551 | Train Acc: 0.4107
 Site-amazon                    (6) | Train Loss: 1.9317 | Train Acc: 0.5294
 Site-amazon                    (6) | Train Loss: 1.9343 | Train Acc: 0.4567
 Site-Art                       (0) | Train Loss: 2.2480 | Train Acc: 0.2000
 Site-Art                       (0) | Train Loss: 2.1709 | Train Acc: 0.3030
 Site-Art                       (2) | Train Loss: 2.1247 | Train Acc: 0.2885
 Site-Art                       (0) | Train Loss: 2.1656 | Train Acc: 0.2169
 Site-RealWorld                 (0) | Train Loss: 2.0225 | Train Acc: 0.2400
 Site-RealWorld                 (0) | Train Loss: 2.0477 | Train Acc: 0.3256
 Site-RealWorld                 (0) | Train Loss: 1.9628 | Train Acc: 0.3733
 Site-webcam                    (4) | Train Loss: 2.0649 | Train Acc: 0.2647
 Site-webcam                    (4) | Train Loss: 2.0517 | Train Acc: 0.2647
 Site-Clipart                   (5) | Train Loss: 2.1067 | Train Acc: 0.2692
 Site-Clipart                   (3) | Train Loss: 2.0498 | Train Acc: 0.3654
 Site-dslr                      (4) | Train Loss: 2.0753 | Train Acc: 0.3167
 Site-Product                   (6) | Train Loss: 2.0067 | Train Acc: 0.4000
Average Train Accuracy: 0.3271
 Site-amazon                    (6) | Val  Loss: 2.0736 | Val  Acc: 0.1875
 Site-amazon                    (1) | Val  Loss: 1.9457 | Val  Acc: 0.2800
 Site-amazon                    (6) | Val  Loss: 1.9210 | Val  Acc: 0.4595
 Site-amazon                    (6) | Val  Loss: 1.9567 | Val  Acc: 0.5000
 Site-amazon                    (6) | Val  Loss: 1.9204 | Val  Acc: 0.4881
 Site-Art                       (0) | Val  Loss: 2.2490 | Val  Acc: 0.0769
 Site-Art                       (0) | Val  Loss: 2.1714 | Val  Acc: 0.2857
 Site-Art                       (2) | Val  Loss: 2.1577 | Val  Acc: 0.3824
 Site-Art                       (0) | Val  Loss: 2.1768 | Val  Acc: 0.2727
 Site-RealWorld                 (0) | Val  Loss: 2.0809 | Val  Acc: 0.2500
 Site-RealWorld                 (0) | Val  Loss: 1.9362 | Val  Acc: 0.5172
 Site-RealWorld                 (0) | Val  Loss: 1.9740 | Val  Acc: 0.5200
 Site-webcam                    (4) | Val  Loss: 2.0959 | Val  Acc: 0.1739
 Site-webcam                    (4) | Val  Loss: 2.0495 | Val  Acc: 0.3043
 Site-Clipart                   (5) | Val  Loss: 2.0696 | Val  Acc: 0.3529
 Site-Clipart                   (3) | Val  Loss: 2.0185 | Val  Acc: 0.3529
 Site-dslr                      (4) | Val  Loss: 2.0622 | Val  Acc: 0.3250
 Site-Product                   (6) | Val  Loss: 2.0765 | Val  Acc: 0.2667
Average Valid Accuracy: 0.3331
 Best site-amazon                   (6)  | Epoch:1 | Val Acc: 0.1875
 Best site-amazon                   (1)  | Epoch:1 | Val Acc: 0.2800
 Best site-amazon                   (6)  | Epoch:1 | Val Acc: 0.4595
 Best site-amazon                   (6)  | Epoch:1 | Val Acc: 0.5000
 Best site-amazon                   (6)  | Epoch:1 | Val Acc: 0.4881
 Best site-Art                      (0)  | Epoch:1 | Val Acc: 0.0769
 Best site-Art                      (0)  | Epoch:1 | Val Acc: 0.2857
 Best site-Art                      (2)  | Epoch:1 | Val Acc: 0.3824
 Best site-Art                      (0)  | Epoch:1 | Val Acc: 0.2727
 Best site-RealWorld                (0)  | Epoch:1 | Val Acc: 0.2500
 Best site-RealWorld                (0)  | Epoch:1 | Val Acc: 0.5172
 Best site-RealWorld                (0)  | Epoch:1 | Val Acc: 0.5200
 Best site-webcam                   (4)  | Epoch:1 | Val Acc: 0.1739
 Best site-webcam                   (4)  | Epoch:1 | Val Acc: 0.3043
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.3529
 Best site-Clipart                  (3)  | Epoch:1 | Val Acc: 0.3529
 Best site-dslr                     (4)  | Epoch:1 | Val Acc: 0.3250
 Best site-Product                  (6)  | Epoch:1 | Val Acc: 0.2667
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 3, 3, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-amazon                    (0) | Train Loss: 1.9278 | Train Acc: 0.5200
 Site-amazon                    (3) | Train Loss: 1.8861 | Train Acc: 0.5263
 Site-amazon                    (3) | Train Loss: 1.8245 | Train Acc: 0.5714
 Site-amazon                    (3) | Train Loss: 1.8197 | Train Acc: 0.6588
 Site-amazon                    (3) | Train Loss: 1.8362 | Train Acc: 0.6220
 Site-Art                       (1) | Train Loss: 2.1091 | Train Acc: 0.2000
 Site-Art                       (6) | Train Loss: 2.0637 | Train Acc: 0.4242
 Site-Art                       (1) | Train Loss: 1.9797 | Train Acc: 0.4038
 Site-Art                       (1) | Train Loss: 2.0824 | Train Acc: 0.3614
 Site-RealWorld                 (4) | Train Loss: 1.9561 | Train Acc: 0.3600
 Site-RealWorld                 (4) | Train Loss: 1.9190 | Train Acc: 0.5116
 Site-RealWorld                 (4) | Train Loss: 1.8816 | Train Acc: 0.4800
 Site-webcam                    (2) | Train Loss: 1.8736 | Train Acc: 0.5588
 Site-webcam                    (2) | Train Loss: 1.9838 | Train Acc: 0.4853
 Site-Clipart                   (5) | Train Loss: 2.0105 | Train Acc: 0.3077
 Site-Clipart                   (5) | Train Loss: 1.9431 | Train Acc: 0.4615
 Site-dslr                      (2) | Train Loss: 1.9369 | Train Acc: 0.5333
 Site-Product                   (3) | Train Loss: 1.8380 | Train Acc: 0.5556
Average Train Accuracy: 0.4746
 Site-amazon                    (0) | Val  Loss: 1.9198 | Val  Acc: 0.4375
 Site-amazon                    (3) | Val  Loss: 1.8334 | Val  Acc: 0.4800
 Site-amazon                    (3) | Val  Loss: 1.8055 | Val  Acc: 0.6757
 Site-amazon                    (3) | Val  Loss: 1.7912 | Val  Acc: 0.6250
 Site-amazon                    (3) | Val  Loss: 1.8076 | Val  Acc: 0.6905
 Site-Art                       (1) | Val  Loss: 2.2010 | Val  Acc: 0.1538
 Site-Art                       (6) | Val  Loss: 2.0004 | Val  Acc: 0.3810
 Site-Art                       (1) | Val  Loss: 2.0390 | Val  Acc: 0.5588
 Site-Art                       (1) | Val  Loss: 2.0539 | Val  Acc: 0.4000
 Site-RealWorld                 (4) | Val  Loss: 1.9606 | Val  Acc: 0.5625
 Site-RealWorld                 (4) | Val  Loss: 1.8685 | Val  Acc: 0.5517
 Site-RealWorld                 (4) | Val  Loss: 1.8658 | Val  Acc: 0.5600
 Site-webcam                    (2) | Val  Loss: 1.9843 | Val  Acc: 0.5217
 Site-webcam                    (2) | Val  Loss: 1.9835 | Val  Acc: 0.4130
 Site-Clipart                   (5) | Val  Loss: 1.9578 | Val  Acc: 0.3529
 Site-Clipart                   (5) | Val  Loss: 1.9280 | Val  Acc: 0.3824
 Site-dslr                      (2) | Val  Loss: 1.8653 | Val  Acc: 0.6000
 Site-Product                   (3) | Val  Loss: 1.8878 | Val  Acc: 0.4667
Average Valid Accuracy: 0.4896
 Best site-amazon                   (0)  | Epoch:2 | Val Acc: 0.4375
 Best site-amazon                   (3)  | Epoch:2 | Val Acc: 0.4800
 Best site-amazon                   (3)  | Epoch:2 | Val Acc: 0.6757
 Best site-amazon                   (3)  | Epoch:2 | Val Acc: 0.6250
 Best site-amazon                   (3)  | Epoch:2 | Val Acc: 0.6905
 Best site-Art                      (1)  | Epoch:2 | Val Acc: 0.1538
 Best site-Art                      (6)  | Epoch:2 | Val Acc: 0.3810
 Best site-Art                      (1)  | Epoch:2 | Val Acc: 0.5588
 Best site-Art                      (1)  | Epoch:2 | Val Acc: 0.4000
 Best site-RealWorld                (4)  | Epoch:2 | Val Acc: 0.5625
 Best site-RealWorld                (4)  | Epoch:2 | Val Acc: 0.5517
 Best site-RealWorld                (4)  | Epoch:2 | Val Acc: 0.5600
 Best site-webcam                   (2)  | Epoch:2 | Val Acc: 0.5217
 Best site-webcam                   (2)  | Epoch:2 | Val Acc: 0.4130
 Best site-Clipart                  (5)  | Epoch:2 | Val Acc: 0.3529
 Best site-Clipart                  (5)  | Epoch:2 | Val Acc: 0.3824
 Best site-dslr                     (2)  | Epoch:2 | Val Acc: 0.6000
 Best site-Product                  (3)  | Epoch:2 | Val Acc: 0.4667
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1...
============ Train epoch 3 ============
cnt=[6, 6, 1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-amazon                    (1) | Train Loss: 1.7627 | Train Acc: 0.6400
 Site-amazon                    (1) | Train Loss: 1.7177 | Train Acc: 0.7368
 Site-amazon                    (1) | Train Loss: 1.6734 | Train Acc: 0.7857
 Site-amazon                    (1) | Train Loss: 1.6142 | Train Acc: 0.7412
 Site-amazon                    (1) | Train Loss: 1.6585 | Train Acc: 0.7795
 Site-Art                       (6) | Train Loss: 1.8846 | Train Acc: 0.6000
 Site-Art                       (3) | Train Loss: 2.0187 | Train Acc: 0.3636
 Site-Art                       (0) | Train Loss: 1.8732 | Train Acc: 0.4615
 Site-Art                       (0) | Train Loss: 1.9432 | Train Acc: 0.3855
 Site-RealWorld                 (0) | Train Loss: 1.7784 | Train Acc: 0.6400
 Site-RealWorld                 (0) | Train Loss: 1.7641 | Train Acc: 0.6977
 Site-RealWorld                 (0) | Train Loss: 1.7437 | Train Acc: 0.6267
 Site-webcam                    (5) | Train Loss: 1.7516 | Train Acc: 0.7059
 Site-webcam                    (5) | Train Loss: 1.7236 | Train Acc: 0.6471
 Site-Clipart                   (2) | Train Loss: 1.9445 | Train Acc: 0.3077
 Site-Clipart                   (4) | Train Loss: 1.8162 | Train Acc: 0.5769
 Site-dslr                      (0) | Train Loss: 1.7967 | Train Acc: 0.6833
 Site-Product                   (1) | Train Loss: 1.7055 | Train Acc: 0.6889
Average Train Accuracy: 0.6149
 Site-amazon                    (1) | Val  Loss: 1.7667 | Val  Acc: 0.7500
 Site-amazon                    (1) | Val  Loss: 1.6973 | Val  Acc: 0.7200
 Site-amazon                    (1) | Val  Loss: 1.6346 | Val  Acc: 0.7838
 Site-amazon                    (1) | Val  Loss: 1.6700 | Val  Acc: 0.6786
 Site-amazon                    (1) | Val  Loss: 1.6504 | Val  Acc: 0.7738
 Site-Art                       (6) | Val  Loss: 2.0930 | Val  Acc: 0.2308
 Site-Art                       (3) | Val  Loss: 1.8843 | Val  Acc: 0.4286
 Site-Art                       (0) | Val  Loss: 1.9308 | Val  Acc: 0.4706
 Site-Art                       (0) | Val  Loss: 1.9583 | Val  Acc: 0.4182
 Site-RealWorld                 (0) | Val  Loss: 1.8145 | Val  Acc: 0.6875
 Site-RealWorld                 (0) | Val  Loss: 1.7039 | Val  Acc: 0.7241
 Site-RealWorld                 (0) | Val  Loss: 1.7066 | Val  Acc: 0.7400
 Site-webcam                    (5) | Val  Loss: 1.8495 | Val  Acc: 0.5217
 Site-webcam                    (5) | Val  Loss: 1.8309 | Val  Acc: 0.6087
 Site-Clipart                   (2) | Val  Loss: 1.8483 | Val  Acc: 0.3529
 Site-Clipart                   (4) | Val  Loss: 1.8064 | Val  Acc: 0.5588
 Site-dslr                      (0) | Val  Loss: 1.7751 | Val  Acc: 0.6750
 Site-Product                   (1) | Val  Loss: 1.7642 | Val  Acc: 0.5667
Average Valid Accuracy: 0.5939
 Best site-amazon                   (1)  | Epoch:3 | Val Acc: 0.7500
 Best site-amazon                   (1)  | Epoch:3 | Val Acc: 0.7200
 Best site-amazon                   (1)  | Epoch:3 | Val Acc: 0.7838
 Best site-amazon                   (1)  | Epoch:3 | Val Acc: 0.6786
 Best site-amazon                   (1)  | Epoch:3 | Val Acc: 0.7738
 Best site-Art                      (6)  | Epoch:3 | Val Acc: 0.2308
 Best site-Art                      (3)  | Epoch:3 | Val Acc: 0.4286
 Best site-Art                      (0)  | Epoch:3 | Val Acc: 0.4706
 Best site-Art                      (0)  | Epoch:3 | Val Acc: 0.4182
 Best site-RealWorld                (0)  | Epoch:3 | Val Acc: 0.6875
 Best site-RealWorld                (0)  | Epoch:3 | Val Acc: 0.7241
 Best site-RealWorld                (0)  | Epoch:3 | Val Acc: 0.7400
 Best site-webcam                   (5)  | Epoch:3 | Val Acc: 0.5217
 Best site-webcam                   (5)  | Epoch:3 | Val Acc: 0.6087
 Best site-Clipart                  (2)  | Epoch:3 | Val Acc: 0.3529
 Best site-Clipart                  (4)  | Epoch:3 | Val Acc: 0.5588
 Best site-dslr                     (0)  | Epoch:3 | Val Acc: 0.6750
 Best site-Product                  (1)  | Epoch:3 | Val Acc: 0.5667
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1...
============ Train epoch 4 ============
cnt=[4, 5, 3, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-amazon                    (4) | Train Loss: 1.6659 | Train Acc: 0.6800
 Site-amazon                    (1) | Train Loss: 1.6229 | Train Acc: 0.7105
 Site-amazon                    (1) | Train Loss: 1.5581 | Train Acc: 0.8214
 Site-amazon                    (1) | Train Loss: 1.5408 | Train Acc: 0.7412
 Site-amazon                    (1) | Train Loss: 1.5450 | Train Acc: 0.8268
 Site-Art                       (0) | Train Loss: 1.8998 | Train Acc: 0.5000
 Site-Art                       (0) | Train Loss: 1.8541 | Train Acc: 0.4545
 Site-Art                       (0) | Train Loss: 1.7706 | Train Acc: 0.5769
 Site-Art                       (0) | Train Loss: 1.7932 | Train Acc: 0.4819
 Site-RealWorld                 (3) | Train Loss: 1.7270 | Train Acc: 0.6800
 Site-RealWorld                 (3) | Train Loss: 1.6556 | Train Acc: 0.7209
 Site-RealWorld                 (3) | Train Loss: 1.5570 | Train Acc: 0.7067
 Site-webcam                    (2) | Train Loss: 1.5634 | Train Acc: 0.7647
 Site-webcam                    (2) | Train Loss: 1.6820 | Train Acc: 0.6912
 Site-Clipart                   (5) | Train Loss: 1.8141 | Train Acc: 0.3462
 Site-Clipart                   (6) | Train Loss: 1.7048 | Train Acc: 0.6154
 Site-dslr                      (2) | Train Loss: 1.6189 | Train Acc: 0.7833
 Site-Product                   (1) | Train Loss: 1.5495 | Train Acc: 0.6889
Average Train Accuracy: 0.6550
 Site-amazon                    (4) | Val  Loss: 1.5820 | Val  Acc: 0.9375
 Site-amazon                    (1) | Val  Loss: 1.5304 | Val  Acc: 0.8000
 Site-amazon                    (1) | Val  Loss: 1.5209 | Val  Acc: 0.7568
 Site-amazon                    (1) | Val  Loss: 1.5399 | Val  Acc: 0.7321
 Site-amazon                    (1) | Val  Loss: 1.5339 | Val  Acc: 0.7857
 Site-Art                       (0) | Val  Loss: 1.9685 | Val  Acc: 0.3846
 Site-Art                       (0) | Val  Loss: 1.7427 | Val  Acc: 0.6190
 Site-Art                       (0) | Val  Loss: 1.8341 | Val  Acc: 0.5294
 Site-Art                       (0) | Val  Loss: 1.8362 | Val  Acc: 0.5455
 Site-RealWorld                 (3) | Val  Loss: 1.7071 | Val  Acc: 0.6875
 Site-RealWorld                 (3) | Val  Loss: 1.5298 | Val  Acc: 0.7931
 Site-RealWorld                 (3) | Val  Loss: 1.5563 | Val  Acc: 0.8400
 Site-webcam                    (2) | Val  Loss: 1.6760 | Val  Acc: 0.6522
 Site-webcam                    (2) | Val  Loss: 1.7171 | Val  Acc: 0.6304
 Site-Clipart                   (5) | Val  Loss: 1.7510 | Val  Acc: 0.4706
 Site-Clipart                   (6) | Val  Loss: 1.7522 | Val  Acc: 0.5294
 Site-dslr                      (2) | Val  Loss: 1.5914 | Val  Acc: 0.7750
 Site-Product                   (1) | Val  Loss: 1.5718 | Val  Acc: 0.7667
Average Valid Accuracy: 0.6798
 Best site-amazon                   (4)  | Epoch:4 | Val Acc: 0.9375
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.8000
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.7568
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.7321
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.7857
 Best site-Art                      (0)  | Epoch:4 | Val Acc: 0.3846
 Best site-Art                      (0)  | Epoch:4 | Val Acc: 0.6190
 Best site-Art                      (0)  | Epoch:4 | Val Acc: 0.5294
 Best site-Art                      (0)  | Epoch:4 | Val Acc: 0.5455
 Best site-RealWorld                (3)  | Epoch:4 | Val Acc: 0.6875
 Best site-RealWorld                (3)  | Epoch:4 | Val Acc: 0.7931
 Best site-RealWorld                (3)  | Epoch:4 | Val Acc: 0.8400
 Best site-webcam                   (2)  | Epoch:4 | Val Acc: 0.6522
 Best site-webcam                   (2)  | Epoch:4 | Val Acc: 0.6304
 Best site-Clipart                  (5)  | Epoch:4 | Val Acc: 0.4706
 Best site-Clipart                  (6)  | Epoch:4 | Val Acc: 0.5294
 Best site-dslr                     (2)  | Epoch:4 | Val Acc: 0.7750
 Best site-Product                  (1)  | Epoch:4 | Val Acc: 0.7667
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 6, 3, 3, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-amazon                    (1) | Train Loss: 1.5357 | Train Acc: 0.6800
 Site-amazon                    (1) | Train Loss: 1.4517 | Train Acc: 0.8158
 Site-amazon                    (1) | Train Loss: 1.4020 | Train Acc: 0.8393
 Site-amazon                    (1) | Train Loss: 1.3437 | Train Acc: 0.7412
 Site-amazon                    (1) | Train Loss: 1.3907 | Train Acc: 0.8425
 Site-Art                       (5) | Train Loss: 1.7066 | Train Acc: 0.6500
 Site-Art                       (0) | Train Loss: 1.7121 | Train Acc: 0.4848
 Site-Art                       (3) | Train Loss: 1.6006 | Train Acc: 0.7115
 Site-Art                       (3) | Train Loss: 1.7593 | Train Acc: 0.6506
 Site-RealWorld                 (4) | Train Loss: 1.5325 | Train Acc: 0.7200
 Site-RealWorld                 (4) | Train Loss: 1.4931 | Train Acc: 0.6744
 Site-RealWorld                 (4) | Train Loss: 1.4681 | Train Acc: 0.7333
 Site-webcam                    (2) | Train Loss: 1.3452 | Train Acc: 0.8824
 Site-webcam                    (2) | Train Loss: 1.5338 | Train Acc: 0.7647
 Site-Clipart                   (3) | Train Loss: 1.7172 | Train Acc: 0.4615
 Site-Clipart                   (6) | Train Loss: 1.5517 | Train Acc: 0.6731
 Site-dslr                      (2) | Train Loss: 1.4731 | Train Acc: 0.7500
 Site-Product                   (1) | Train Loss: 1.4646 | Train Acc: 0.7111
Average Train Accuracy: 0.7103
 Site-amazon                    (1) | Val  Loss: 1.4383 | Val  Acc: 0.8750
 Site-amazon                    (1) | Val  Loss: 1.4011 | Val  Acc: 0.7600
 Site-amazon                    (1) | Val  Loss: 1.3685 | Val  Acc: 0.7838
 Site-amazon                    (1) | Val  Loss: 1.4064 | Val  Acc: 0.7500
 Site-amazon                    (1) | Val  Loss: 1.3624 | Val  Acc: 0.8095
 Site-Art                       (5) | Val  Loss: 1.9341 | Val  Acc: 0.3077
 Site-Art                       (0) | Val  Loss: 1.5972 | Val  Acc: 0.6190
 Site-Art                       (3) | Val  Loss: 1.7014 | Val  Acc: 0.6176
 Site-Art                       (3) | Val  Loss: 1.7018 | Val  Acc: 0.5636
 Site-RealWorld                 (4) | Val  Loss: 1.5431 | Val  Acc: 0.6875
 Site-RealWorld                 (4) | Val  Loss: 1.4478 | Val  Acc: 0.8276
 Site-RealWorld                 (4) | Val  Loss: 1.4200 | Val  Acc: 0.8000
 Site-webcam                    (2) | Val  Loss: 1.5288 | Val  Acc: 0.8261
 Site-webcam                    (2) | Val  Loss: 1.5461 | Val  Acc: 0.7609
 Site-Clipart                   (3) | Val  Loss: 1.6645 | Val  Acc: 0.5294
 Site-Clipart                   (6) | Val  Loss: 1.6181 | Val  Acc: 0.5882
 Site-dslr                      (2) | Val  Loss: 1.4244 | Val  Acc: 0.7500
 Site-Product                   (1) | Val  Loss: 1.4231 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7050
 Best site-amazon                   (1)  | Epoch:5 | Val Acc: 0.8750
 Best site-amazon                   (1)  | Epoch:5 | Val Acc: 0.7600
 Best site-amazon                   (1)  | Epoch:5 | Val Acc: 0.7838
 Best site-amazon                   (1)  | Epoch:5 | Val Acc: 0.7500
 Best site-amazon                   (1)  | Epoch:5 | Val Acc: 0.8095
 Best site-Art                      (5)  | Epoch:5 | Val Acc: 0.3077
 Best site-Art                      (0)  | Epoch:5 | Val Acc: 0.6190
 Best site-Art                      (3)  | Epoch:5 | Val Acc: 0.6176
 Best site-Art                      (3)  | Epoch:5 | Val Acc: 0.5636
 Best site-RealWorld                (4)  | Epoch:5 | Val Acc: 0.6875
 Best site-RealWorld                (4)  | Epoch:5 | Val Acc: 0.8276
 Best site-RealWorld                (4)  | Epoch:5 | Val Acc: 0.8000
 Best site-webcam                   (2)  | Epoch:5 | Val Acc: 0.8261
 Best site-webcam                   (2)  | Epoch:5 | Val Acc: 0.7609
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.5294
 Best site-Clipart                  (6)  | Epoch:5 | Val Acc: 0.5882
 Best site-dslr                     (2)  | Epoch:5 | Val Acc: 0.7500
 Best site-Product                  (1)  | Epoch:5 | Val Acc: 0.8333
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1...
============ Train epoch 6 ============
cnt=[4, 1, 2, 1, 3, 1, 6, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-amazon                    (6) | Train Loss: 1.3449 | Train Acc: 0.7200
 Site-amazon                    (6) | Train Loss: 1.2955 | Train Acc: 0.8158
 Site-amazon                    (6) | Train Loss: 1.2800 | Train Acc: 0.8214
 Site-amazon                    (6) | Train Loss: 1.2328 | Train Acc: 0.7882
 Site-amazon                    (6) | Train Loss: 1.2555 | Train Acc: 0.8189
 Site-Art                       (0) | Train Loss: 1.5203 | Train Acc: 0.8000
 Site-Art                       (0) | Train Loss: 1.5822 | Train Acc: 0.6364
 Site-Art                       (0) | Train Loss: 1.5237 | Train Acc: 0.6731
 Site-Art                       (0) | Train Loss: 1.6054 | Train Acc: 0.6386
 Site-RealWorld                 (2) | Train Loss: 1.4455 | Train Acc: 0.6400
 Site-RealWorld                 (6) | Train Loss: 1.3353 | Train Acc: 0.7442
 Site-RealWorld                 (2) | Train Loss: 1.2529 | Train Acc: 0.8400
 Site-webcam                    (4) | Train Loss: 1.2646 | Train Acc: 0.8824
 Site-webcam                    (4) | Train Loss: 1.3684 | Train Acc: 0.7500
 Site-Clipart                   (5) | Train Loss: 1.5760 | Train Acc: 0.5769
 Site-Clipart                   (3) | Train Loss: 1.4452 | Train Acc: 0.7308
 Site-dslr                      (4) | Train Loss: 1.3097 | Train Acc: 0.8000
 Site-Product                   (1) | Train Loss: 1.3306 | Train Acc: 0.7333
Average Train Accuracy: 0.7450
 Site-amazon                    (6) | Val  Loss: 1.2388 | Val  Acc: 0.8750
 Site-amazon                    (6) | Val  Loss: 1.2067 | Val  Acc: 0.8400
 Site-amazon                    (6) | Val  Loss: 1.1885 | Val  Acc: 0.7838
 Site-amazon                    (6) | Val  Loss: 1.2376 | Val  Acc: 0.7500
 Site-amazon                    (6) | Val  Loss: 1.2621 | Val  Acc: 0.7857
 Site-Art                       (0) | Val  Loss: 1.6941 | Val  Acc: 0.6154
 Site-Art                       (0) | Val  Loss: 1.4043 | Val  Acc: 0.7619
 Site-Art                       (0) | Val  Loss: 1.6052 | Val  Acc: 0.6471
 Site-Art                       (0) | Val  Loss: 1.6114 | Val  Acc: 0.5636
 Site-RealWorld                 (2) | Val  Loss: 1.4113 | Val  Acc: 0.8125
 Site-RealWorld                 (6) | Val  Loss: 1.2631 | Val  Acc: 0.8621
 Site-RealWorld                 (2) | Val  Loss: 1.2507 | Val  Acc: 0.8600
 Site-webcam                    (4) | Val  Loss: 1.4627 | Val  Acc: 0.6957
 Site-webcam                    (4) | Val  Loss: 1.4451 | Val  Acc: 0.7391
 Site-Clipart                   (5) | Val  Loss: 1.5912 | Val  Acc: 0.7059
 Site-Clipart                   (3) | Val  Loss: 1.4315 | Val  Acc: 0.7353
 Site-dslr                      (4) | Val  Loss: 1.2420 | Val  Acc: 0.8500
 Site-Product                   (1) | Val  Loss: 1.2360 | Val  Acc: 0.9333
Average Valid Accuracy: 0.7676
 Best site-amazon                   (6)  | Epoch:6 | Val Acc: 0.8750
 Best site-amazon                   (6)  | Epoch:6 | Val Acc: 0.8400
 Best site-amazon                   (6)  | Epoch:6 | Val Acc: 0.7838
 Best site-amazon                   (6)  | Epoch:6 | Val Acc: 0.7500
 Best site-amazon                   (6)  | Epoch:6 | Val Acc: 0.7857
 Best site-Art                      (0)  | Epoch:6 | Val Acc: 0.6154
 Best site-Art                      (0)  | Epoch:6 | Val Acc: 0.7619
 Best site-Art                      (0)  | Epoch:6 | Val Acc: 0.6471
 Best site-Art                      (0)  | Epoch:6 | Val Acc: 0.5636
 Best site-RealWorld                (2)  | Epoch:6 | Val Acc: 0.8125
 Best site-RealWorld                (6)  | Epoch:6 | Val Acc: 0.8621
 Best site-RealWorld                (2)  | Epoch:6 | Val Acc: 0.8600
 Best site-webcam                   (4)  | Epoch:6 | Val Acc: 0.6957
 Best site-webcam                   (4)  | Epoch:6 | Val Acc: 0.7391
 Best site-Clipart                  (5)  | Epoch:6 | Val Acc: 0.7059
 Best site-Clipart                  (3)  | Epoch:6 | Val Acc: 0.7353
 Best site-dslr                     (4)  | Epoch:6 | Val Acc: 0.8500
 Best site-Product                  (1)  | Epoch:6 | Val Acc: 0.9333
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 8, 3, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-amazon                    (1) | Train Loss: 1.2944 | Train Acc: 0.7200
 Site-amazon                    (1) | Train Loss: 1.1776 | Train Acc: 0.8421
 Site-amazon                    (1) | Train Loss: 1.1472 | Train Acc: 0.8393
 Site-amazon                    (1) | Train Loss: 1.1227 | Train Acc: 0.8235
 Site-amazon                    (1) | Train Loss: 1.1060 | Train Acc: 0.8740
 Site-Art                       (0) | Train Loss: 1.4824 | Train Acc: 0.8500
 Site-Art                       (6) | Train Loss: 1.4615 | Train Acc: 0.6970
 Site-Art                       (4) | Train Loss: 1.4606 | Train Acc: 0.6923
 Site-Art                       (4) | Train Loss: 1.5270 | Train Acc: 0.6747
 Site-RealWorld                 (5) | Train Loss: 1.2623 | Train Acc: 0.7600
 Site-RealWorld                 (1) | Train Loss: 1.2026 | Train Acc: 0.8372
 Site-RealWorld                 (5) | Train Loss: 1.1636 | Train Acc: 0.8400
 Site-webcam                    (2) | Train Loss: 1.1248 | Train Acc: 0.8824
 Site-webcam                    (2) | Train Loss: 1.3781 | Train Acc: 0.8088
 Site-Clipart                   (3) | Train Loss: 1.5031 | Train Acc: 0.6154
 Site-Clipart                   (1) | Train Loss: 1.2809 | Train Acc: 0.7692
 Site-dslr                      (2) | Train Loss: 1.2114 | Train Acc: 0.8333
 Site-Product                   (1) | Train Loss: 1.1258 | Train Acc: 0.8667
Average Train Accuracy: 0.7903
 Site-amazon                    (1) | Val  Loss: 1.0871 | Val  Acc: 0.9375
 Site-amazon                    (1) | Val  Loss: 1.0595 | Val  Acc: 0.8800
 Site-amazon                    (1) | Val  Loss: 1.0260 | Val  Acc: 0.8649
 Site-amazon                    (1) | Val  Loss: 1.1205 | Val  Acc: 0.8214
 Site-amazon                    (1) | Val  Loss: 1.1174 | Val  Acc: 0.8214
 Site-Art                       (0) | Val  Loss: 1.7545 | Val  Acc: 0.5385
 Site-Art                       (6) | Val  Loss: 1.4143 | Val  Acc: 0.7143
 Site-Art                       (4) | Val  Loss: 1.5303 | Val  Acc: 0.6765
 Site-Art                       (4) | Val  Loss: 1.5675 | Val  Acc: 0.6364
 Site-RealWorld                 (5) | Val  Loss: 1.2484 | Val  Acc: 0.8125
 Site-RealWorld                 (1) | Val  Loss: 1.1473 | Val  Acc: 0.8966
 Site-RealWorld                 (5) | Val  Loss: 1.1097 | Val  Acc: 0.9000
 Site-webcam                    (2) | Val  Loss: 1.2673 | Val  Acc: 0.8696
 Site-webcam                    (2) | Val  Loss: 1.3509 | Val  Acc: 0.7609
 Site-Clipart                   (3) | Val  Loss: 1.4379 | Val  Acc: 0.5882
 Site-Clipart                   (1) | Val  Loss: 1.3481 | Val  Acc: 0.7353
 Site-dslr                      (2) | Val  Loss: 1.1260 | Val  Acc: 0.9250
 Site-Product                   (1) | Val  Loss: 1.1588 | Val  Acc: 0.9333
Average Valid Accuracy: 0.7951
 Best site-amazon                   (1)  | Epoch:7 | Val Acc: 0.9375
 Best site-amazon                   (1)  | Epoch:7 | Val Acc: 0.8800
 Best site-amazon                   (1)  | Epoch:7 | Val Acc: 0.8649
 Best site-amazon                   (1)  | Epoch:7 | Val Acc: 0.8214
 Best site-amazon                   (1)  | Epoch:7 | Val Acc: 0.8214
 Best site-Art                      (0)  | Epoch:7 | Val Acc: 0.5385
 Best site-Art                      (6)  | Epoch:7 | Val Acc: 0.7143
 Best site-Art                      (4)  | Epoch:7 | Val Acc: 0.6765
 Best site-Art                      (4)  | Epoch:7 | Val Acc: 0.6364
 Best site-RealWorld                (5)  | Epoch:7 | Val Acc: 0.8125
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 0.8966
 Best site-RealWorld                (5)  | Epoch:7 | Val Acc: 0.9000
 Best site-webcam                   (2)  | Epoch:7 | Val Acc: 0.8696
 Best site-webcam                   (2)  | Epoch:7 | Val Acc: 0.7609
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.5882
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7353
 Best site-dslr                     (2)  | Epoch:7 | Val Acc: 0.9250
 Best site-Product                  (1)  | Epoch:7 | Val Acc: 0.9333
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 1, 6, 4, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-amazon                    (2) | Train Loss: 1.1552 | Train Acc: 0.7200
 Site-amazon                    (2) | Train Loss: 1.0466 | Train Acc: 0.8684
 Site-amazon                    (2) | Train Loss: 1.0262 | Train Acc: 0.8036
 Site-amazon                    (2) | Train Loss: 0.9578 | Train Acc: 0.8588
 Site-amazon                    (2) | Train Loss: 0.9698 | Train Acc: 0.8819
 Site-Art                       (6) | Train Loss: 1.3752 | Train Acc: 0.7000
 Site-Art                       (3) | Train Loss: 1.3525 | Train Acc: 0.6970
 Site-Art                       (3) | Train Loss: 1.3397 | Train Acc: 0.7500
 Site-Art                       (3) | Train Loss: 1.4006 | Train Acc: 0.6747
 Site-RealWorld                 (5) | Train Loss: 1.1393 | Train Acc: 0.8000
 Site-RealWorld                 (5) | Train Loss: 1.0726 | Train Acc: 0.8372
 Site-RealWorld                 (3) | Train Loss: 1.0767 | Train Acc: 0.8533
 Site-webcam                    (0) | Train Loss: 1.0036 | Train Acc: 0.8824
 Site-webcam                    (0) | Train Loss: 0.9632 | Train Acc: 0.8382
 Site-Clipart                   (5) | Train Loss: 1.4986 | Train Acc: 0.5385
 Site-Clipart                   (1) | Train Loss: 1.2333 | Train Acc: 0.8269
 Site-dslr                      (4) | Train Loss: 1.0526 | Train Acc: 0.8500
 Site-Product                   (2) | Train Loss: 1.0008 | Train Acc: 0.8444
Average Train Accuracy: 0.7903
 Site-amazon                    (2) | Val  Loss: 0.9690 | Val  Acc: 0.9375
 Site-amazon                    (2) | Val  Loss: 0.9735 | Val  Acc: 0.8800
 Site-amazon                    (2) | Val  Loss: 0.9307 | Val  Acc: 0.8378
 Site-amazon                    (2) | Val  Loss: 1.0132 | Val  Acc: 0.7500
 Site-amazon                    (2) | Val  Loss: 1.0197 | Val  Acc: 0.8214
 Site-Art                       (6) | Val  Loss: 1.5701 | Val  Acc: 0.6154
 Site-Art                       (3) | Val  Loss: 1.2726 | Val  Acc: 0.8571
 Site-Art                       (3) | Val  Loss: 1.4600 | Val  Acc: 0.6765
 Site-Art                       (3) | Val  Loss: 1.4874 | Val  Acc: 0.6364
 Site-RealWorld                 (5) | Val  Loss: 1.2208 | Val  Acc: 0.8125
 Site-RealWorld                 (5) | Val  Loss: 1.0208 | Val  Acc: 0.8621
 Site-RealWorld                 (3) | Val  Loss: 0.9862 | Val  Acc: 0.9400
 Site-webcam                    (0) | Val  Loss: 1.2363 | Val  Acc: 0.8261
 Site-webcam                    (0) | Val  Loss: 1.2199 | Val  Acc: 0.8043
 Site-Clipart                   (5) | Val  Loss: 1.3066 | Val  Acc: 0.7647
 Site-Clipart                   (1) | Val  Loss: 1.1634 | Val  Acc: 0.8529
 Site-dslr                      (4) | Val  Loss: 0.9711 | Val  Acc: 0.9750
 Site-Product                   (2) | Val  Loss: 1.0278 | Val  Acc: 0.9667
Average Valid Accuracy: 0.8231
 Best site-amazon                   (2)  | Epoch:8 | Val Acc: 0.9375
 Best site-amazon                   (2)  | Epoch:8 | Val Acc: 0.8800
 Best site-amazon                   (2)  | Epoch:8 | Val Acc: 0.8378
 Best site-amazon                   (2)  | Epoch:8 | Val Acc: 0.7500
 Best site-amazon                   (2)  | Epoch:8 | Val Acc: 0.8214
 Best site-Art                      (6)  | Epoch:8 | Val Acc: 0.6154
 Best site-Art                      (3)  | Epoch:8 | Val Acc: 0.8571
 Best site-Art                      (3)  | Epoch:8 | Val Acc: 0.6765
 Best site-Art                      (3)  | Epoch:8 | Val Acc: 0.6364
 Best site-RealWorld                (5)  | Epoch:8 | Val Acc: 0.8125
 Best site-RealWorld                (5)  | Epoch:8 | Val Acc: 0.8621
 Best site-RealWorld                (3)  | Epoch:8 | Val Acc: 0.9400
 Best site-webcam                   (0)  | Epoch:8 | Val Acc: 0.8261
 Best site-webcam                   (0)  | Epoch:8 | Val Acc: 0.8043
 Best site-Clipart                  (5)  | Epoch:8 | Val Acc: 0.7647
 Best site-Clipart                  (1)  | Epoch:8 | Val Acc: 0.8529
 Best site-dslr                     (4)  | Epoch:8 | Val Acc: 0.9750
 Best site-Product                  (2)  | Epoch:8 | Val Acc: 0.9667
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 4, 2, 1, 4, 4, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-amazon                    (2) | Train Loss: 1.1388 | Train Acc: 0.6800
 Site-amazon                    (2) | Train Loss: 0.9541 | Train Acc: 0.8421
 Site-amazon                    (4) | Train Loss: 0.9239 | Train Acc: 0.8214
 Site-amazon                    (4) | Train Loss: 0.8490 | Train Acc: 0.8941
 Site-amazon                    (4) | Train Loss: 0.9018 | Train Acc: 0.8583
 Site-Art                       (1) | Train Loss: 1.2421 | Train Acc: 0.8000
 Site-Art                       (5) | Train Loss: 1.3342 | Train Acc: 0.6970
 Site-Art                       (6) | Train Loss: 1.2410 | Train Acc: 0.7500
 Site-Art                       (1) | Train Loss: 1.3050 | Train Acc: 0.7229
 Site-RealWorld                 (1) | Train Loss: 1.0341 | Train Acc: 0.8000
 Site-RealWorld                 (1) | Train Loss: 0.9928 | Train Acc: 0.8372
 Site-RealWorld                 (5) | Train Loss: 0.9091 | Train Acc: 0.8533
 Site-webcam                    (5) | Train Loss: 0.8834 | Train Acc: 0.9118
 Site-webcam                    (5) | Train Loss: 1.1671 | Train Acc: 0.8676
 Site-Clipart                   (0) | Train Loss: 1.3779 | Train Acc: 0.6538
 Site-Clipart                   (0) | Train Loss: 1.1922 | Train Acc: 0.7692
 Site-dslr                      (3) | Train Loss: 0.9655 | Train Acc: 0.9000
 Site-Product                   (4) | Train Loss: 0.9725 | Train Acc: 0.8667
Average Train Accuracy: 0.8070
 Site-amazon                    (2) | Val  Loss: 0.9235 | Val  Acc: 1.0000
 Site-amazon                    (2) | Val  Loss: 0.8864 | Val  Acc: 0.8800
 Site-amazon                    (4) | Val  Loss: 0.8339 | Val  Acc: 0.8378
 Site-amazon                    (4) | Val  Loss: 0.9290 | Val  Acc: 0.8393
 Site-amazon                    (4) | Val  Loss: 0.9407 | Val  Acc: 0.8571
 Site-Art                       (1) | Val  Loss: 1.5069 | Val  Acc: 0.6923
 Site-Art                       (5) | Val  Loss: 1.2495 | Val  Acc: 0.8095
 Site-Art                       (6) | Val  Loss: 1.4112 | Val  Acc: 0.6765
 Site-Art                       (1) | Val  Loss: 1.4101 | Val  Acc: 0.5818
 Site-RealWorld                 (1) | Val  Loss: 1.0711 | Val  Acc: 0.8125
 Site-RealWorld                 (1) | Val  Loss: 0.9356 | Val  Acc: 0.8621
 Site-RealWorld                 (5) | Val  Loss: 0.8601 | Val  Acc: 0.9400
 Site-webcam                    (5) | Val  Loss: 1.0839 | Val  Acc: 0.9130
 Site-webcam                    (5) | Val  Loss: 1.1330 | Val  Acc: 0.8261
 Site-Clipart                   (0) | Val  Loss: 1.2910 | Val  Acc: 0.8235
 Site-Clipart                   (0) | Val  Loss: 1.1369 | Val  Acc: 0.7941
 Site-dslr                      (3) | Val  Loss: 0.8888 | Val  Acc: 0.9250
 Site-Product                   (4) | Val  Loss: 0.9316 | Val  Acc: 0.9000
Average Valid Accuracy: 0.8317
 Best site-amazon                   (2)  | Epoch:9 | Val Acc: 1.0000
 Best site-amazon                   (2)  | Epoch:9 | Val Acc: 0.8800
 Best site-amazon                   (4)  | Epoch:9 | Val Acc: 0.8378
 Best site-amazon                   (4)  | Epoch:9 | Val Acc: 0.8393
 Best site-amazon                   (4)  | Epoch:9 | Val Acc: 0.8571
 Best site-Art                      (1)  | Epoch:9 | Val Acc: 0.6923
 Best site-Art                      (5)  | Epoch:9 | Val Acc: 0.8095
 Best site-Art                      (6)  | Epoch:9 | Val Acc: 0.6765
 Best site-Art                      (1)  | Epoch:9 | Val Acc: 0.5818
 Best site-RealWorld                (1)  | Epoch:9 | Val Acc: 0.8125
 Best site-RealWorld                (1)  | Epoch:9 | Val Acc: 0.8621
 Best site-RealWorld                (5)  | Epoch:9 | Val Acc: 0.9400
 Best site-webcam                   (5)  | Epoch:9 | Val Acc: 0.9130
 Best site-webcam                   (5)  | Epoch:9 | Val Acc: 0.8261
 Best site-Clipart                  (0)  | Epoch:9 | Val Acc: 0.8235
 Best site-Clipart                  (0)  | Epoch:9 | Val Acc: 0.7941
 Best site-dslr                     (3)  | Epoch:9 | Val Acc: 0.9250
 Best site-Product                  (4)  | Epoch:9 | Val Acc: 0.9000
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.31_1/ccop_q=1...
===2023-08-05 14:13:21===
===2023-08-05 14:13:29===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[25,38,56,85,127,20,33,52,83,25,43,75,34,68,26,52,60,45,
client_nums=[5,4,3,2,2,1,1,]
len_dataset=[555,317,241,173,132,100,76,]
domain number = 7
Loading snapshots...
 Test site-amazon                    (2)| Epoch:9 | Test Acc: 0.8843
 Test site-Art                       (1)| Epoch:9 | Test Acc: 0.7746
 Test site-RealWorld                 (1)| Epoch:9 | Test Acc: 0.8700
 Test site-webcam                    (5)| Epoch:9 | Test Acc: 0.8734
 Test site-Clipart                   (0)| Epoch:9 | Test Acc: 0.7393
 Test site-dslr                      (3)| Epoch:9 | Test Acc: 0.8367
 Test site-Product                   (4)| Epoch:9 | Test Acc: 0.8802
amazon: 0.8843, Art: 0.7746, RealWorld: 0.8700, webcam: 0.8734, Clipart: 0.7393, dslr: 0.8367, Product: 0.8802, 
Average Test Accuracy(group): 0.8369, Average Test Accuracy(individual): 0.8373,
domain std=0.0534, cluster std=0.0499, individual std=0.0546, 
