===2023-07-31 17:28:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 1.2662 | Train Acc: 0.7305
 Site-MNIST                         | Train Loss: 1.3826 | Train Acc: 0.6206
 Site-USPS                          | Train Loss: 1.1992 | Train Acc: 0.7978
 Site-USPS                          | Train Loss: 1.1627 | Train Acc: 0.8063
 Site-SynthDigits                   | Train Loss: 1.8292 | Train Acc: 0.4340
 Site-SynthDigits                   | Train Loss: 1.7643 | Train Acc: 0.4726
 Site-MNIST_M                       | Train Loss: 2.0424 | Train Acc: 0.2615
 Site-MNIST_M                       | Train Loss: 2.0844 | Train Acc: 0.2619
 Site-SVHN                          | Train Loss: 2.1683 | Train Acc: 0.2668
 Site-SVHN                          | Train Loss: 2.1206 | Train Acc: 0.2843
Average Train Accuracy: 0.4936
 Site-MNIST                         | Val  Loss: 1.4025 | Val  Acc: 0.6087
 Site-MNIST                         | Val  Loss: 1.3894 | Val  Acc: 0.6583
 Site-USPS                          | Val  Loss: 1.2427 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 1.2234 | Val  Acc: 0.7698
 Site-SynthDigits                   | Val  Loss: 1.7547 | Val  Acc: 0.4565
 Site-SynthDigits                   | Val  Loss: 1.7786 | Val  Acc: 0.4460
 Site-MNIST_M                       | Val  Loss: 2.0807 | Val  Acc: 0.2500
 Site-MNIST_M                       | Val  Loss: 2.0347 | Val  Acc: 0.3022
 Site-SVHN                          | Val  Loss: 2.0894 | Val  Acc: 0.2609
 Site-SVHN                          | Val  Loss: 2.1391 | Val  Acc: 0.2770
Average Valid Accuracy: 0.4768
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6087
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6583
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7391
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7698
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.4565
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.4460
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.2500
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.3022
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2609
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2770
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 0.8494 | Train Acc: 0.7978
 Site-MNIST                         | Train Loss: 0.9267 | Train Acc: 0.7372
 Site-USPS                          | Train Loss: 0.7508 | Train Acc: 0.8059
 Site-USPS                          | Train Loss: 0.7346 | Train Acc: 0.8072
 Site-SynthDigits                   | Train Loss: 1.5955 | Train Acc: 0.4555
 Site-SynthDigits                   | Train Loss: 1.4823 | Train Acc: 0.5265
 Site-MNIST_M                       | Train Loss: 1.8602 | Train Acc: 0.3908
 Site-MNIST_M                       | Train Loss: 1.8539 | Train Acc: 0.3901
 Site-SVHN                          | Train Loss: 2.0420 | Train Acc: 0.2965
 Site-SVHN                          | Train Loss: 1.9652 | Train Acc: 0.3561
Average Train Accuracy: 0.5564
 Site-MNIST                         | Val  Loss: 0.9555 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 0.9221 | Val  Acc: 0.7590
 Site-USPS                          | Val  Loss: 0.8547 | Val  Acc: 0.7391
 Site-USPS                          | Val  Loss: 0.7827 | Val  Acc: 0.7842
 Site-SynthDigits                   | Val  Loss: 1.4982 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.5484 | Val  Acc: 0.4532
 Site-MNIST_M                       | Val  Loss: 1.8864 | Val  Acc: 0.3261
 Site-MNIST_M                       | Val  Loss: 1.8275 | Val  Acc: 0.4101
 Site-SVHN                          | Val  Loss: 1.8940 | Val  Acc: 0.3478
 Site-SVHN                          | Val  Loss: 1.9757 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5397
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7590
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7391
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7842
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.4532
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.3261
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.4101
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.3478
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.3597
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 0.6530 | Train Acc: 0.8329
 Site-MNIST                         | Train Loss: 0.7374 | Train Acc: 0.7892
 Site-USPS                          | Train Loss: 0.5689 | Train Acc: 0.8760
 Site-USPS                          | Train Loss: 0.5419 | Train Acc: 0.8682
 Site-SynthDigits                   | Train Loss: 1.4641 | Train Acc: 0.4987
 Site-SynthDigits                   | Train Loss: 1.3299 | Train Acc: 0.5731
 Site-MNIST_M                       | Train Loss: 1.6324 | Train Acc: 0.4609
 Site-MNIST_M                       | Train Loss: 1.6711 | Train Acc: 0.4296
 Site-SVHN                          | Train Loss: 1.9249 | Train Acc: 0.3261
 Site-SVHN                          | Train Loss: 1.8029 | Train Acc: 0.4027
Average Train Accuracy: 0.6057
 Site-MNIST                         | Val  Loss: 0.7730 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 0.7672 | Val  Acc: 0.7986
 Site-USPS                          | Val  Loss: 0.6764 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.5947 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.3333 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.3898 | Val  Acc: 0.5072
 Site-MNIST_M                       | Val  Loss: 1.7115 | Val  Acc: 0.3804
 Site-MNIST_M                       | Val  Loss: 1.6256 | Val  Acc: 0.4820
 Site-SVHN                          | Val  Loss: 1.7159 | Val  Acc: 0.4022
 Site-SVHN                          | Val  Loss: 1.8092 | Val  Acc: 0.3669
Average Valid Accuracy: 0.5815
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7826
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7986
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.5072
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.3804
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4820
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.4022
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.3669
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 0.5353 | Train Acc: 0.8760
 Site-MNIST                         | Train Loss: 0.6097 | Train Acc: 0.8323
 Site-USPS                          | Train Loss: 0.4615 | Train Acc: 0.9030
 Site-USPS                          | Train Loss: 0.4377 | Train Acc: 0.8852
 Site-SynthDigits                   | Train Loss: 1.3246 | Train Acc: 0.5822
 Site-SynthDigits                   | Train Loss: 1.2064 | Train Acc: 0.6152
 Site-MNIST_M                       | Train Loss: 1.6115 | Train Acc: 0.4609
 Site-MNIST_M                       | Train Loss: 1.5983 | Train Acc: 0.4538
 Site-SVHN                          | Train Loss: 1.8929 | Train Acc: 0.3288
 Site-SVHN                          | Train Loss: 1.7636 | Train Acc: 0.4197
Average Train Accuracy: 0.6357
 Site-MNIST                         | Val  Loss: 0.6244 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.6081 | Val  Acc: 0.8597
 Site-USPS                          | Val  Loss: 0.6018 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.4944 | Val  Acc: 0.8417
 Site-SynthDigits                   | Val  Loss: 1.2371 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.2597 | Val  Acc: 0.5827
 Site-MNIST_M                       | Val  Loss: 1.6614 | Val  Acc: 0.4130
 Site-MNIST_M                       | Val  Loss: 1.5675 | Val  Acc: 0.4856
 Site-SVHN                          | Val  Loss: 1.6875 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.7819 | Val  Acc: 0.3669
Average Valid Accuracy: 0.6191
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8478
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8597
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8417
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.5827
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.4130
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.4856
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.4348
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.3669
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 0.4645 | Train Acc: 0.8922
 Site-MNIST                         | Train Loss: 0.5583 | Train Acc: 0.8314
 Site-USPS                          | Train Loss: 0.4020 | Train Acc: 0.9218
 Site-USPS                          | Train Loss: 0.4032 | Train Acc: 0.9022
 Site-SynthDigits                   | Train Loss: 1.2431 | Train Acc: 0.6065
 Site-SynthDigits                   | Train Loss: 1.1217 | Train Acc: 0.6628
 Site-MNIST_M                       | Train Loss: 1.5069 | Train Acc: 0.4879
 Site-MNIST_M                       | Train Loss: 1.5074 | Train Acc: 0.4852
 Site-SVHN                          | Train Loss: 1.8045 | Train Acc: 0.3854
 Site-SVHN                          | Train Loss: 1.6620 | Train Acc: 0.4350
Average Train Accuracy: 0.6610
 Site-MNIST                         | Val  Loss: 0.5671 | Val  Acc: 0.8152
 Site-MNIST                         | Val  Loss: 0.5726 | Val  Acc: 0.8381
 Site-USPS                          | Val  Loss: 0.5749 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.4722 | Val  Acc: 0.8561
 Site-SynthDigits                   | Val  Loss: 1.1398 | Val  Acc: 0.6087
 Site-SynthDigits                   | Val  Loss: 1.1633 | Val  Acc: 0.6259
 Site-MNIST_M                       | Val  Loss: 1.5291 | Val  Acc: 0.4674
 Site-MNIST_M                       | Val  Loss: 1.4750 | Val  Acc: 0.5288
 Site-SVHN                          | Val  Loss: 1.5909 | Val  Acc: 0.4239
 Site-SVHN                          | Val  Loss: 1.6879 | Val  Acc: 0.4209
Average Valid Accuracy: 0.6378
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8152
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8381
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8561
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.6087
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.6259
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.4674
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.5288
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.4239
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.4209
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 0.4281 | Train Acc: 0.8814
 Site-MNIST                         | Train Loss: 0.4991 | Train Acc: 0.8457
 Site-USPS                          | Train Loss: 0.3675 | Train Acc: 0.9164
 Site-USPS                          | Train Loss: 0.3603 | Train Acc: 0.9004
 Site-SynthDigits                   | Train Loss: 1.1846 | Train Acc: 0.6065
 Site-SynthDigits                   | Train Loss: 1.0495 | Train Acc: 0.6637
 Site-MNIST_M                       | Train Loss: 1.4239 | Train Acc: 0.5256
 Site-MNIST_M                       | Train Loss: 1.4089 | Train Acc: 0.5265
 Site-SVHN                          | Train Loss: 1.7711 | Train Acc: 0.4124
 Site-SVHN                          | Train Loss: 1.6106 | Train Acc: 0.4484
Average Train Accuracy: 0.6727
 Site-MNIST                         | Val  Loss: 0.5161 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 0.5191 | Val  Acc: 0.8381
 Site-USPS                          | Val  Loss: 0.5298 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.4267 | Val  Acc: 0.8633
 Site-SynthDigits                   | Val  Loss: 1.0712 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.1039 | Val  Acc: 0.6187
 Site-MNIST_M                       | Val  Loss: 1.4319 | Val  Acc: 0.5217
 Site-MNIST_M                       | Val  Loss: 1.3975 | Val  Acc: 0.5432
 Site-SVHN                          | Val  Loss: 1.5596 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.6213 | Val  Acc: 0.4460
Average Valid Accuracy: 0.6440
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7826
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8381
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8633
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.5761
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.6187
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.5217
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.5432
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.4348
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.4460
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.3647 | Train Acc: 0.8841
 Site-MNIST                         | Train Loss: 0.4240 | Train Acc: 0.8807
 Site-USPS                          | Train Loss: 0.3404 | Train Acc: 0.9191
 Site-USPS                          | Train Loss: 0.3205 | Train Acc: 0.9148
 Site-SynthDigits                   | Train Loss: 1.0811 | Train Acc: 0.6550
 Site-SynthDigits                   | Train Loss: 0.9630 | Train Acc: 0.7058
 Site-MNIST_M                       | Train Loss: 1.3761 | Train Acc: 0.5283
 Site-MNIST_M                       | Train Loss: 1.3655 | Train Acc: 0.5175
 Site-SVHN                          | Train Loss: 1.7088 | Train Acc: 0.4286
 Site-SVHN                          | Train Loss: 1.5641 | Train Acc: 0.4619
Average Train Accuracy: 0.6896
 Site-MNIST                         | Val  Loss: 0.4222 | Val  Acc: 0.8696
 Site-MNIST                         | Val  Loss: 0.4474 | Val  Acc: 0.8813
 Site-USPS                          | Val  Loss: 0.5095 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 0.3918 | Val  Acc: 0.8705
 Site-SynthDigits                   | Val  Loss: 0.9925 | Val  Acc: 0.6957
 Site-SynthDigits                   | Val  Loss: 0.9912 | Val  Acc: 0.6978
 Site-MNIST_M                       | Val  Loss: 1.3627 | Val  Acc: 0.4674
 Site-MNIST_M                       | Val  Loss: 1.3251 | Val  Acc: 0.5468
 Site-SVHN                          | Val  Loss: 1.5236 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.5814 | Val  Acc: 0.4460
Average Valid Accuracy: 0.6692
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8696
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8813
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8705
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.6957
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.6978
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.4674
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.5468
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.4348
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.4460
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.3242 | Train Acc: 0.9030
 Site-MNIST                         | Train Loss: 0.3646 | Train Acc: 0.8834
 Site-USPS                          | Train Loss: 0.3103 | Train Acc: 0.9218
 Site-USPS                          | Train Loss: 0.2917 | Train Acc: 0.9220
 Site-SynthDigits                   | Train Loss: 1.0403 | Train Acc: 0.6631
 Site-SynthDigits                   | Train Loss: 0.9001 | Train Acc: 0.7220
 Site-MNIST_M                       | Train Loss: 1.3691 | Train Acc: 0.5202
 Site-MNIST_M                       | Train Loss: 1.3173 | Train Acc: 0.5480
 Site-SVHN                          | Train Loss: 1.7180 | Train Acc: 0.4447
 Site-SVHN                          | Train Loss: 1.5476 | Train Acc: 0.4700
Average Train Accuracy: 0.6998
 Site-MNIST                         | Val  Loss: 0.3587 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.3794 | Val  Acc: 0.8921
 Site-USPS                          | Val  Loss: 0.4853 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.3470 | Val  Acc: 0.8849
 Site-SynthDigits                   | Val  Loss: 0.9555 | Val  Acc: 0.7174
 Site-SynthDigits                   | Val  Loss: 0.9710 | Val  Acc: 0.6906
 Site-MNIST_M                       | Val  Loss: 1.3299 | Val  Acc: 0.5109
 Site-MNIST_M                       | Val  Loss: 1.2911 | Val  Acc: 0.5504
 Site-SVHN                          | Val  Loss: 1.5029 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.5776 | Val  Acc: 0.4820
Average Valid Accuracy: 0.6891
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8921
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8849
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.7174
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.6906
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.5109
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.5504
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.4457
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.4820
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.3107 | Train Acc: 0.9164
 Site-MNIST                         | Train Loss: 0.3418 | Train Acc: 0.8960
 Site-USPS                          | Train Loss: 0.2983 | Train Acc: 0.9272
 Site-USPS                          | Train Loss: 0.2756 | Train Acc: 0.9157
 Site-SynthDigits                   | Train Loss: 0.9866 | Train Acc: 0.6685
 Site-SynthDigits                   | Train Loss: 0.8585 | Train Acc: 0.7309
 Site-MNIST_M                       | Train Loss: 1.3204 | Train Acc: 0.5499
 Site-MNIST_M                       | Train Loss: 1.2618 | Train Acc: 0.5623
 Site-SVHN                          | Train Loss: 1.6878 | Train Acc: 0.4447
 Site-SVHN                          | Train Loss: 1.5050 | Train Acc: 0.4807
Average Train Accuracy: 0.7092
 Site-MNIST                         | Val  Loss: 0.3327 | Val  Acc: 0.9022
 Site-MNIST                         | Val  Loss: 0.3568 | Val  Acc: 0.9029
 Site-USPS                          | Val  Loss: 0.4764 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.3317 | Val  Acc: 0.8813
 Site-SynthDigits                   | Val  Loss: 0.9087 | Val  Acc: 0.7174
 Site-SynthDigits                   | Val  Loss: 0.8940 | Val  Acc: 0.7122
 Site-MNIST_M                       | Val  Loss: 1.2779 | Val  Acc: 0.5217
 Site-MNIST_M                       | Val  Loss: 1.2338 | Val  Acc: 0.5647
 Site-SVHN                          | Val  Loss: 1.4842 | Val  Acc: 0.4891
 Site-SVHN                          | Val  Loss: 1.5459 | Val  Acc: 0.4856
Average Valid Accuracy: 0.7003
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9022
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9029
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8813
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.7174
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.7122
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.5217
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.5647
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.4891
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.4856
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.2857 | Train Acc: 0.9272
 Site-MNIST                         | Train Loss: 0.3196 | Train Acc: 0.9076
 Site-USPS                          | Train Loss: 0.2692 | Train Acc: 0.9353
 Site-USPS                          | Train Loss: 0.2434 | Train Acc: 0.9327
 Site-SynthDigits                   | Train Loss: 0.9647 | Train Acc: 0.6873
 Site-SynthDigits                   | Train Loss: 0.8420 | Train Acc: 0.7462
 Site-MNIST_M                       | Train Loss: 1.2733 | Train Acc: 0.5714
 Site-MNIST_M                       | Train Loss: 1.1953 | Train Acc: 0.5785
 Site-SVHN                          | Train Loss: 1.6338 | Train Acc: 0.4717
 Site-SVHN                          | Train Loss: 1.4796 | Train Acc: 0.4834
Average Train Accuracy: 0.7241
 Site-MNIST                         | Val  Loss: 0.3105 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.3238 | Val  Acc: 0.8957
 Site-USPS                          | Val  Loss: 0.4454 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.3011 | Val  Acc: 0.9029
 Site-SynthDigits                   | Val  Loss: 0.8785 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 0.8706 | Val  Acc: 0.7338
 Site-MNIST_M                       | Val  Loss: 1.2262 | Val  Acc: 0.5326
 Site-MNIST_M                       | Val  Loss: 1.1851 | Val  Acc: 0.5827
 Site-SVHN                          | Val  Loss: 1.4475 | Val  Acc: 0.5435
 Site-SVHN                          | Val  Loss: 1.5029 | Val  Acc: 0.5180
Average Valid Accuracy: 0.7155
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8913
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8957
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:9 | Val Acc: 0.9029
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.7283
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.7338
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.5326
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.5827
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.5435
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.5180
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.2785 | Train Acc: 0.9245
 Site-MNIST                         | Train Loss: 0.3013 | Train Acc: 0.9130
 Site-USPS                          | Train Loss: 0.2439 | Train Acc: 0.9434
 Site-USPS                          | Train Loss: 0.2231 | Train Acc: 0.9372
 Site-SynthDigits                   | Train Loss: 0.9427 | Train Acc: 0.6846
 Site-SynthDigits                   | Train Loss: 0.8121 | Train Acc: 0.7507
 Site-MNIST_M                       | Train Loss: 1.2407 | Train Acc: 0.5822
 Site-MNIST_M                       | Train Loss: 1.1402 | Train Acc: 0.6090
 Site-SVHN                          | Train Loss: 1.6136 | Train Acc: 0.4501
 Site-SVHN                          | Train Loss: 1.4135 | Train Acc: 0.5130
Average Train Accuracy: 0.7308
 Site-MNIST                         | Val  Loss: 0.2882 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.2996 | Val  Acc: 0.9137
 Site-USPS                          | Val  Loss: 0.4291 | Val  Acc: 0.8370
 Site-USPS                          | Val  Loss: 0.2806 | Val  Acc: 0.9029
 Site-SynthDigits                   | Val  Loss: 0.8761 | Val  Acc: 0.7065
 Site-SynthDigits                   | Val  Loss: 0.8589 | Val  Acc: 0.7302
 Site-MNIST_M                       | Val  Loss: 1.1808 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.1507 | Val  Acc: 0.6007
 Site-SVHN                          | Val  Loss: 1.3941 | Val  Acc: 0.5435
 Site-SVHN                          | Val  Loss: 1.4589 | Val  Acc: 0.5252
Average Valid Accuracy: 0.7216
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9137
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8370
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9029
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.7065
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.7302
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.5435
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.6007
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.5435
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.5252
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.2623 | Train Acc: 0.9245
 Site-MNIST                         | Train Loss: 0.2780 | Train Acc: 0.9157
 Site-USPS                          | Train Loss: 0.2611 | Train Acc: 0.9407
 Site-USPS                          | Train Loss: 0.2362 | Train Acc: 0.9300
 Site-SynthDigits                   | Train Loss: 0.9006 | Train Acc: 0.7035
 Site-SynthDigits                   | Train Loss: 0.7908 | Train Acc: 0.7623
 Site-MNIST_M                       | Train Loss: 1.1952 | Train Acc: 0.6119
 Site-MNIST_M                       | Train Loss: 1.0918 | Train Acc: 0.6359
 Site-SVHN                          | Train Loss: 1.6180 | Train Acc: 0.4663
 Site-SVHN                          | Train Loss: 1.4415 | Train Acc: 0.5058
Average Train Accuracy: 0.7397
 Site-MNIST                         | Val  Loss: 0.2659 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.2790 | Val  Acc: 0.9173
 Site-USPS                          | Val  Loss: 0.4272 | Val  Acc: 0.8370
 Site-USPS                          | Val  Loss: 0.2781 | Val  Acc: 0.9029
 Site-SynthDigits                   | Val  Loss: 0.8013 | Val  Acc: 0.7500
 Site-SynthDigits                   | Val  Loss: 0.8105 | Val  Acc: 0.7482
 Site-MNIST_M                       | Val  Loss: 1.0883 | Val  Acc: 0.5870
 Site-MNIST_M                       | Val  Loss: 1.0837 | Val  Acc: 0.6403
 Site-SVHN                          | Val  Loss: 1.4536 | Val  Acc: 0.4891
 Site-SVHN                          | Val  Loss: 1.4958 | Val  Acc: 0.4964
Average Valid Accuracy: 0.7281
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9173
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8370
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9029
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.7500
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.7482
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.5870
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.6403
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.4891
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.4964
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.2505 | Train Acc: 0.9245
 Site-MNIST                         | Train Loss: 0.2590 | Train Acc: 0.9256
 Site-USPS                          | Train Loss: 0.2438 | Train Acc: 0.9434
 Site-USPS                          | Train Loss: 0.2111 | Train Acc: 0.9354
 Site-SynthDigits                   | Train Loss: 0.8511 | Train Acc: 0.7197
 Site-SynthDigits                   | Train Loss: 0.7211 | Train Acc: 0.7857
 Site-MNIST_M                       | Train Loss: 1.1878 | Train Acc: 0.6038
 Site-MNIST_M                       | Train Loss: 1.0870 | Train Acc: 0.6242
 Site-SVHN                          | Train Loss: 1.5686 | Train Acc: 0.4852
 Site-SVHN                          | Train Loss: 1.3875 | Train Acc: 0.5309
Average Train Accuracy: 0.7478
 Site-MNIST                         | Val  Loss: 0.2436 | Val  Acc: 0.9348
 Site-MNIST                         | Val  Loss: 0.2623 | Val  Acc: 0.9281
 Site-USPS                          | Val  Loss: 0.4190 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.2664 | Val  Acc: 0.9137
 Site-SynthDigits                   | Val  Loss: 0.7606 | Val  Acc: 0.7826
 Site-SynthDigits                   | Val  Loss: 0.7613 | Val  Acc: 0.7662
 Site-MNIST_M                       | Val  Loss: 1.0887 | Val  Acc: 0.5652
 Site-MNIST_M                       | Val  Loss: 1.0841 | Val  Acc: 0.6259
 Site-SVHN                          | Val  Loss: 1.3962 | Val  Acc: 0.5652
 Site-SVHN                          | Val  Loss: 1.4510 | Val  Acc: 0.5468
Average Valid Accuracy: 0.7454
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9348
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9281
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9137
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.7826
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.7662
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.5652
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.6259
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.5652
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.5468
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.2320 | Train Acc: 0.9380
 Site-MNIST                         | Train Loss: 0.2603 | Train Acc: 0.9247
 Site-USPS                          | Train Loss: 0.2376 | Train Acc: 0.9461
 Site-USPS                          | Train Loss: 0.1970 | Train Acc: 0.9399
 Site-SynthDigits                   | Train Loss: 0.8849 | Train Acc: 0.7251
 Site-SynthDigits                   | Train Loss: 0.7340 | Train Acc: 0.7794
 Site-MNIST_M                       | Train Loss: 1.1584 | Train Acc: 0.6038
 Site-MNIST_M                       | Train Loss: 1.0550 | Train Acc: 0.6386
 Site-SVHN                          | Train Loss: 1.6084 | Train Acc: 0.4825
 Site-SVHN                          | Train Loss: 1.3716 | Train Acc: 0.5471
Average Train Accuracy: 0.7525
 Site-MNIST                         | Val  Loss: 0.2459 | Val  Acc: 0.9022
 Site-MNIST                         | Val  Loss: 0.2675 | Val  Acc: 0.9209
 Site-USPS                          | Val  Loss: 0.3916 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.2531 | Val  Acc: 0.9029
 Site-SynthDigits                   | Val  Loss: 0.7885 | Val  Acc: 0.7717
 Site-SynthDigits                   | Val  Loss: 0.7929 | Val  Acc: 0.7662
 Site-MNIST_M                       | Val  Loss: 1.0371 | Val  Acc: 0.5761
 Site-MNIST_M                       | Val  Loss: 1.0492 | Val  Acc: 0.6259
 Site-SVHN                          | Val  Loss: 1.3645 | Val  Acc: 0.5543
 Site-SVHN                          | Val  Loss: 1.4076 | Val  Acc: 0.5252
Average Valid Accuracy: 0.7371
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.2360 | Train Acc: 0.9245
 Site-MNIST                         | Train Loss: 0.2347 | Train Acc: 0.9345
 Site-USPS                          | Train Loss: 0.2019 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.1789 | Train Acc: 0.9480
 Site-SynthDigits                   | Train Loss: 0.8367 | Train Acc: 0.7197
 Site-SynthDigits                   | Train Loss: 0.7060 | Train Acc: 0.7928
 Site-MNIST_M                       | Train Loss: 1.1548 | Train Acc: 0.6011
 Site-MNIST_M                       | Train Loss: 1.0222 | Train Acc: 0.6484
 Site-SVHN                          | Train Loss: 1.5775 | Train Acc: 0.4636
 Site-SVHN                          | Train Loss: 1.3425 | Train Acc: 0.5561
Average Train Accuracy: 0.7548
 Site-MNIST                         | Val  Loss: 0.2128 | Val  Acc: 0.9348
 Site-MNIST                         | Val  Loss: 0.2351 | Val  Acc: 0.9388
 Site-USPS                          | Val  Loss: 0.3685 | Val  Acc: 0.8478
 Site-USPS                          | Val  Loss: 0.2282 | Val  Acc: 0.9173
 Site-SynthDigits                   | Val  Loss: 0.7583 | Val  Acc: 0.7826
 Site-SynthDigits                   | Val  Loss: 0.7353 | Val  Acc: 0.7734
 Site-MNIST_M                       | Val  Loss: 1.0099 | Val  Acc: 0.6087
 Site-MNIST_M                       | Val  Loss: 1.0322 | Val  Acc: 0.6403
 Site-SVHN                          | Val  Loss: 1.3241 | Val  Acc: 0.5326
 Site-SVHN                          | Val  Loss: 1.3768 | Val  Acc: 0.5252
Average Valid Accuracy: 0.7501
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9348
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9388
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8478
 Best site-USPS                      | Epoch:14 | Val Acc: 0.9173
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.7826
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.7734
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.6087
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.6403
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.5326
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.5252
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.2255 | Train Acc: 0.9353
 Site-MNIST                         | Train Loss: 0.2178 | Train Acc: 0.9372
 Site-USPS                          | Train Loss: 0.2117 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.1768 | Train Acc: 0.9489
 Site-SynthDigits                   | Train Loss: 0.8276 | Train Acc: 0.7224
 Site-SynthDigits                   | Train Loss: 0.6715 | Train Acc: 0.8063
 Site-MNIST_M                       | Train Loss: 1.1152 | Train Acc: 0.6119
 Site-MNIST_M                       | Train Loss: 0.9716 | Train Acc: 0.6556
 Site-SVHN                          | Train Loss: 1.5738 | Train Acc: 0.4744
 Site-SVHN                          | Train Loss: 1.3170 | Train Acc: 0.5462
Average Train Accuracy: 0.7592
 Site-MNIST                         | Val  Loss: 0.2056 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.2182 | Val  Acc: 0.9388
 Site-USPS                          | Val  Loss: 0.3669 | Val  Acc: 0.8587
 Site-USPS                          | Val  Loss: 0.2285 | Val  Acc: 0.9209
 Site-SynthDigits                   | Val  Loss: 0.7149 | Val  Acc: 0.7826
 Site-SynthDigits                   | Val  Loss: 0.7194 | Val  Acc: 0.7806
 Site-MNIST_M                       | Val  Loss: 0.9566 | Val  Acc: 0.6087
 Site-MNIST_M                       | Val  Loss: 0.9922 | Val  Acc: 0.6439
 Site-SVHN                          | Val  Loss: 1.3297 | Val  Acc: 0.5109
 Site-SVHN                          | Val  Loss: 1.3761 | Val  Acc: 0.5180
Average Valid Accuracy: 0.7476
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.2199 | Train Acc: 0.9407
 Site-MNIST                         | Train Loss: 0.2173 | Train Acc: 0.9363
 Site-USPS                          | Train Loss: 0.2167 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.1716 | Train Acc: 0.9534
 Site-SynthDigits                   | Train Loss: 0.7846 | Train Acc: 0.7251
 Site-SynthDigits                   | Train Loss: 0.6452 | Train Acc: 0.8152
 Site-MNIST_M                       | Train Loss: 1.0971 | Train Acc: 0.6173
 Site-MNIST_M                       | Train Loss: 0.9382 | Train Acc: 0.6726
 Site-SVHN                          | Train Loss: 1.5430 | Train Acc: 0.4798
 Site-SVHN                          | Train Loss: 1.2926 | Train Acc: 0.5704
Average Train Accuracy: 0.7665
 Site-MNIST                         | Val  Loss: 0.1982 | Val  Acc: 0.9239
 Site-MNIST                         | Val  Loss: 0.2198 | Val  Acc: 0.9424
 Site-USPS                          | Val  Loss: 0.3602 | Val  Acc: 0.8804
 Site-USPS                          | Val  Loss: 0.2227 | Val  Acc: 0.9245
 Site-SynthDigits                   | Val  Loss: 0.6937 | Val  Acc: 0.8043
 Site-SynthDigits                   | Val  Loss: 0.6955 | Val  Acc: 0.7878
 Site-MNIST_M                       | Val  Loss: 0.9315 | Val  Acc: 0.6522
 Site-MNIST_M                       | Val  Loss: 0.9692 | Val  Acc: 0.6619
 Site-SVHN                          | Val  Loss: 1.2572 | Val  Acc: 0.5652
 Site-SVHN                          | Val  Loss: 1.3274 | Val  Acc: 0.5504
Average Valid Accuracy: 0.7693
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9239
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9424
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8804
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9245
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.8043
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.7878
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.6522
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.6619
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.5652
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.5504
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.2120 | Train Acc: 0.9326
 Site-MNIST                         | Train Loss: 0.2147 | Train Acc: 0.9363
 Site-USPS                          | Train Loss: 0.1934 | Train Acc: 0.9569
 Site-USPS                          | Train Loss: 0.1628 | Train Acc: 0.9525
 Site-SynthDigits                   | Train Loss: 0.7737 | Train Acc: 0.7412
 Site-SynthDigits                   | Train Loss: 0.6218 | Train Acc: 0.8188
 Site-MNIST_M                       | Train Loss: 1.0938 | Train Acc: 0.6226
 Site-MNIST_M                       | Train Loss: 0.9322 | Train Acc: 0.6753
 Site-SVHN                          | Train Loss: 1.5435 | Train Acc: 0.4933
 Site-SVHN                          | Train Loss: 1.2725 | Train Acc: 0.5713
Average Train Accuracy: 0.7701
 Site-MNIST                         | Val  Loss: 0.1902 | Val  Acc: 0.9348
 Site-MNIST                         | Val  Loss: 0.2151 | Val  Acc: 0.9388
 Site-USPS                          | Val  Loss: 0.3500 | Val  Acc: 0.8804
 Site-USPS                          | Val  Loss: 0.2097 | Val  Acc: 0.9245
 Site-SynthDigits                   | Val  Loss: 0.6729 | Val  Acc: 0.8043
 Site-SynthDigits                   | Val  Loss: 0.6651 | Val  Acc: 0.7914
 Site-MNIST_M                       | Val  Loss: 0.9112 | Val  Acc: 0.6304
 Site-MNIST_M                       | Val  Loss: 0.9598 | Val  Acc: 0.6547
 Site-SVHN                          | Val  Loss: 1.2637 | Val  Acc: 0.5761
 Site-SVHN                          | Val  Loss: 1.3291 | Val  Acc: 0.5504
Average Valid Accuracy: 0.7686
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.2085 | Train Acc: 0.9353
 Site-MNIST                         | Train Loss: 0.2008 | Train Acc: 0.9381
 Site-USPS                          | Train Loss: 0.1939 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.1529 | Train Acc: 0.9561
 Site-SynthDigits                   | Train Loss: 0.7588 | Train Acc: 0.7439
 Site-SynthDigits                   | Train Loss: 0.6096 | Train Acc: 0.8170
 Site-MNIST_M                       | Train Loss: 1.0673 | Train Acc: 0.6226
 Site-MNIST_M                       | Train Loss: 0.9032 | Train Acc: 0.6843
 Site-SVHN                          | Train Loss: 1.5381 | Train Acc: 0.4798
 Site-SVHN                          | Train Loss: 1.2832 | Train Acc: 0.5740
Average Train Accuracy: 0.7711
 Site-MNIST                         | Val  Loss: 0.1815 | Val  Acc: 0.9348
 Site-MNIST                         | Val  Loss: 0.2025 | Val  Acc: 0.9460
 Site-USPS                          | Val  Loss: 0.3317 | Val  Acc: 0.8804
 Site-USPS                          | Val  Loss: 0.1944 | Val  Acc: 0.9317
 Site-SynthDigits                   | Val  Loss: 0.6714 | Val  Acc: 0.7935
 Site-SynthDigits                   | Val  Loss: 0.6632 | Val  Acc: 0.7878
 Site-MNIST_M                       | Val  Loss: 0.8671 | Val  Acc: 0.6739
 Site-MNIST_M                       | Val  Loss: 0.9350 | Val  Acc: 0.6799
 Site-SVHN                          | Val  Loss: 1.2405 | Val  Acc: 0.5543
 Site-SVHN                          | Val  Loss: 1.3160 | Val  Acc: 0.5468
Average Valid Accuracy: 0.7729
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9348
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9460
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8804
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9317
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.7935
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.7878
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.6739
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.6799
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.5543
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.5468
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.2011 | Train Acc: 0.9407
 Site-MNIST                         | Train Loss: 0.1926 | Train Acc: 0.9462
 Site-USPS                          | Train Loss: 0.1880 | Train Acc: 0.9515
 Site-USPS                          | Train Loss: 0.1494 | Train Acc: 0.9578
 Site-SynthDigits                   | Train Loss: 0.7409 | Train Acc: 0.7385
 Site-SynthDigits                   | Train Loss: 0.5867 | Train Acc: 0.8287
 Site-MNIST_M                       | Train Loss: 1.0602 | Train Acc: 0.6334
 Site-MNIST_M                       | Train Loss: 0.8814 | Train Acc: 0.6996
 Site-SVHN                          | Train Loss: 1.5135 | Train Acc: 0.4933
 Site-SVHN                          | Train Loss: 1.2430 | Train Acc: 0.5812
Average Train Accuracy: 0.7771
 Site-MNIST                         | Val  Loss: 0.1717 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.1918 | Val  Acc: 0.9568
 Site-USPS                          | Val  Loss: 0.3429 | Val  Acc: 0.8804
 Site-USPS                          | Val  Loss: 0.1952 | Val  Acc: 0.9317
 Site-SynthDigits                   | Val  Loss: 0.6357 | Val  Acc: 0.8043
 Site-SynthDigits                   | Val  Loss: 0.6408 | Val  Acc: 0.7914
 Site-MNIST_M                       | Val  Loss: 0.8492 | Val  Acc: 0.7065
 Site-MNIST_M                       | Val  Loss: 0.9059 | Val  Acc: 0.6906
 Site-SVHN                          | Val  Loss: 1.2367 | Val  Acc: 0.5543
 Site-SVHN                          | Val  Loss: 1.3061 | Val  Acc: 0.5504
Average Valid Accuracy: 0.7812
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9457
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9568
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8804
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9317
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.8043
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.7914
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.7065
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.6906
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.5543
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.5504
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.1990 | Train Acc: 0.9407
 Site-MNIST                         | Train Loss: 0.1819 | Train Acc: 0.9516
 Site-USPS                          | Train Loss: 0.1722 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.1454 | Train Acc: 0.9587
 Site-SynthDigits                   | Train Loss: 0.7263 | Train Acc: 0.7439
 Site-SynthDigits                   | Train Loss: 0.5770 | Train Acc: 0.8314
 Site-MNIST_M                       | Train Loss: 1.0458 | Train Acc: 0.6388
 Site-MNIST_M                       | Train Loss: 0.8501 | Train Acc: 0.7139
 Site-SVHN                          | Train Loss: 1.5031 | Train Acc: 0.4879
 Site-SVHN                          | Train Loss: 1.2125 | Train Acc: 0.5973
Average Train Accuracy: 0.7826
 Site-MNIST                         | Val  Loss: 0.1639 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1844 | Val  Acc: 0.9604
 Site-USPS                          | Val  Loss: 0.3190 | Val  Acc: 0.8913
 Site-USPS                          | Val  Loss: 0.1815 | Val  Acc: 0.9424
 Site-SynthDigits                   | Val  Loss: 0.6443 | Val  Acc: 0.7826
 Site-SynthDigits                   | Val  Loss: 0.6303 | Val  Acc: 0.7878
 Site-MNIST_M                       | Val  Loss: 0.8234 | Val  Acc: 0.7283
 Site-MNIST_M                       | Val  Loss: 0.8933 | Val  Acc: 0.6906
 Site-SVHN                          | Val  Loss: 1.1902 | Val  Acc: 0.5978
 Site-SVHN                          | Val  Loss: 1.2736 | Val  Acc: 0.5899
Average Valid Accuracy: 0.7928
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9565
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9604
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8913
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9424
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.7826
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.7878
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.7283
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.6906
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.5978
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.5899
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.1942 | Train Acc: 0.9434
 Site-MNIST                         | Train Loss: 0.1814 | Train Acc: 0.9471
 Site-USPS                          | Train Loss: 0.1665 | Train Acc: 0.9569
 Site-USPS                          | Train Loss: 0.1357 | Train Acc: 0.9623
 Site-SynthDigits                   | Train Loss: 0.7331 | Train Acc: 0.7493
 Site-SynthDigits                   | Train Loss: 0.5733 | Train Acc: 0.8323
 Site-MNIST_M                       | Train Loss: 1.0519 | Train Acc: 0.6361
 Site-MNIST_M                       | Train Loss: 0.8454 | Train Acc: 0.7022
 Site-SVHN                          | Train Loss: 1.5281 | Train Acc: 0.4879
 Site-SVHN                          | Train Loss: 1.1928 | Train Acc: 0.6036
Average Train Accuracy: 0.7821
 Site-MNIST                         | Val  Loss: 0.1647 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1906 | Val  Acc: 0.9496
 Site-USPS                          | Val  Loss: 0.2990 | Val  Acc: 0.8804
 Site-USPS                          | Val  Loss: 0.1719 | Val  Acc: 0.9353
 Site-SynthDigits                   | Val  Loss: 0.6475 | Val  Acc: 0.8043
 Site-SynthDigits                   | Val  Loss: 0.6360 | Val  Acc: 0.8022
 Site-MNIST_M                       | Val  Loss: 0.8147 | Val  Acc: 0.6957
 Site-MNIST_M                       | Val  Loss: 0.8921 | Val  Acc: 0.6763
 Site-SVHN                          | Val  Loss: 1.1900 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.2589 | Val  Acc: 0.5755
Average Valid Accuracy: 0.7885
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.1958 | Train Acc: 0.9407
 Site-MNIST                         | Train Loss: 0.1724 | Train Acc: 0.9552
 Site-USPS                          | Train Loss: 0.1635 | Train Acc: 0.9569
 Site-USPS                          | Train Loss: 0.1438 | Train Acc: 0.9605
 Site-SynthDigits                   | Train Loss: 0.6987 | Train Acc: 0.7547
 Site-SynthDigits                   | Train Loss: 0.5511 | Train Acc: 0.8395
 Site-MNIST_M                       | Train Loss: 1.0226 | Train Acc: 0.6469
 Site-MNIST_M                       | Train Loss: 0.8211 | Train Acc: 0.7193
 Site-SVHN                          | Train Loss: 1.4987 | Train Acc: 0.4879
 Site-SVHN                          | Train Loss: 1.1950 | Train Acc: 0.6027
Average Train Accuracy: 0.7864
 Site-MNIST                         | Val  Loss: 0.1400 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.1693 | Val  Acc: 0.9640
 Site-USPS                          | Val  Loss: 0.3102 | Val  Acc: 0.8804
 Site-USPS                          | Val  Loss: 0.1729 | Val  Acc: 0.9424
 Site-SynthDigits                   | Val  Loss: 0.6086 | Val  Acc: 0.8043
 Site-SynthDigits                   | Val  Loss: 0.6107 | Val  Acc: 0.8058
 Site-MNIST_M                       | Val  Loss: 0.7671 | Val  Acc: 0.7500
 Site-MNIST_M                       | Val  Loss: 0.8550 | Val  Acc: 0.7122
 Site-SVHN                          | Val  Loss: 1.2046 | Val  Acc: 0.5870
 Site-SVHN                          | Val  Loss: 1.2656 | Val  Acc: 0.5719
Average Valid Accuracy: 0.7996
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9783
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9640
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8804
 Best site-USPS                      | Epoch:22 | Val Acc: 0.9424
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.8043
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.8058
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.7500
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.7122
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.5870
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.5719
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.1843 | Train Acc: 0.9488
 Site-MNIST                         | Train Loss: 0.1665 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.1615 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.1272 | Train Acc: 0.9668
 Site-SynthDigits                   | Train Loss: 0.7179 | Train Acc: 0.7520
 Site-SynthDigits                   | Train Loss: 0.5475 | Train Acc: 0.8395
 Site-MNIST_M                       | Train Loss: 0.9991 | Train Acc: 0.6496
 Site-MNIST_M                       | Train Loss: 0.7891 | Train Acc: 0.7354
 Site-SVHN                          | Train Loss: 1.4757 | Train Acc: 0.5040
 Site-SVHN                          | Train Loss: 1.1800 | Train Acc: 0.6143
Average Train Accuracy: 0.7930
 Site-MNIST                         | Val  Loss: 0.1405 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.1608 | Val  Acc: 0.9568
 Site-USPS                          | Val  Loss: 0.2756 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1589 | Val  Acc: 0.9532
 Site-SynthDigits                   | Val  Loss: 0.6105 | Val  Acc: 0.8152
 Site-SynthDigits                   | Val  Loss: 0.6301 | Val  Acc: 0.7986
 Site-MNIST_M                       | Val  Loss: 0.7630 | Val  Acc: 0.7500
 Site-MNIST_M                       | Val  Loss: 0.8437 | Val  Acc: 0.7194
 Site-SVHN                          | Val  Loss: 1.1786 | Val  Acc: 0.6196
 Site-SVHN                          | Val  Loss: 1.2344 | Val  Acc: 0.5827
Average Valid Accuracy: 0.8054
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9457
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9568
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9130
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9532
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.8152
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.7986
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.7500
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.7194
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.6196
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.5827
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.1782 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1689 | Train Acc: 0.9587
 Site-USPS                          | Train Loss: 0.1629 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.1242 | Train Acc: 0.9713
 Site-SynthDigits                   | Train Loss: 0.6834 | Train Acc: 0.7601
 Site-SynthDigits                   | Train Loss: 0.5267 | Train Acc: 0.8493
 Site-MNIST_M                       | Train Loss: 1.0079 | Train Acc: 0.6550
 Site-MNIST_M                       | Train Loss: 0.7817 | Train Acc: 0.7318
 Site-SVHN                          | Train Loss: 1.4821 | Train Acc: 0.5013
 Site-SVHN                          | Train Loss: 1.1545 | Train Acc: 0.6206
Average Train Accuracy: 0.7959
 Site-MNIST                         | Val  Loss: 0.1490 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1731 | Val  Acc: 0.9568
 Site-USPS                          | Val  Loss: 0.2814 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1568 | Val  Acc: 0.9532
 Site-SynthDigits                   | Val  Loss: 0.5839 | Val  Acc: 0.8478
 Site-SynthDigits                   | Val  Loss: 0.5895 | Val  Acc: 0.8237
 Site-MNIST_M                       | Val  Loss: 0.7352 | Val  Acc: 0.7283
 Site-MNIST_M                       | Val  Loss: 0.8258 | Val  Acc: 0.7122
 Site-SVHN                          | Val  Loss: 1.1631 | Val  Acc: 0.5761
 Site-SVHN                          | Val  Loss: 1.2167 | Val  Acc: 0.5863
Average Valid Accuracy: 0.8054
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.1774 | Train Acc: 0.9461
 Site-MNIST                         | Train Loss: 0.1526 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.1526 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.1191 | Train Acc: 0.9695
 Site-SynthDigits                   | Train Loss: 0.6984 | Train Acc: 0.7574
 Site-SynthDigits                   | Train Loss: 0.5282 | Train Acc: 0.8493
 Site-MNIST_M                       | Train Loss: 0.9791 | Train Acc: 0.6496
 Site-MNIST_M                       | Train Loss: 0.7662 | Train Acc: 0.7435
 Site-SVHN                          | Train Loss: 1.4554 | Train Acc: 0.4960
 Site-SVHN                          | Train Loss: 1.1398 | Train Acc: 0.6287
Average Train Accuracy: 0.7967
 Site-MNIST                         | Val  Loss: 0.1291 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1543 | Val  Acc: 0.9640
 Site-USPS                          | Val  Loss: 0.2611 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1492 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.6041 | Val  Acc: 0.8261
 Site-SynthDigits                   | Val  Loss: 0.6151 | Val  Acc: 0.8129
 Site-MNIST_M                       | Val  Loss: 0.7328 | Val  Acc: 0.7500
 Site-MNIST_M                       | Val  Loss: 0.8164 | Val  Acc: 0.7158
 Site-SVHN                          | Val  Loss: 1.1298 | Val  Acc: 0.6304
 Site-SVHN                          | Val  Loss: 1.1972 | Val  Acc: 0.6079
Average Valid Accuracy: 0.8145
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.9640
 Best site-USPS                      | Epoch:25 | Val Acc: 0.9130
 Best site-USPS                      | Epoch:25 | Val Acc: 0.9568
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.8261
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.8129
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.7500
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.7158
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.6304
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.6079
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.1672 | Train Acc: 0.9488
 Site-MNIST                         | Train Loss: 0.1398 | Train Acc: 0.9695
 Site-USPS                          | Train Loss: 0.1558 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.1150 | Train Acc: 0.9677
 Site-SynthDigits                   | Train Loss: 0.6579 | Train Acc: 0.7628
 Site-SynthDigits                   | Train Loss: 0.5023 | Train Acc: 0.8565
 Site-MNIST_M                       | Train Loss: 0.9925 | Train Acc: 0.6469
 Site-MNIST_M                       | Train Loss: 0.7444 | Train Acc: 0.7453
 Site-SVHN                          | Train Loss: 1.4679 | Train Acc: 0.4933
 Site-SVHN                          | Train Loss: 1.1372 | Train Acc: 0.6188
Average Train Accuracy: 0.7975
 Site-MNIST                         | Val  Loss: 0.1194 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.1423 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.2619 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1478 | Val  Acc: 0.9532
 Site-SynthDigits                   | Val  Loss: 0.5505 | Val  Acc: 0.8370
 Site-SynthDigits                   | Val  Loss: 0.5789 | Val  Acc: 0.8237
 Site-MNIST_M                       | Val  Loss: 0.6957 | Val  Acc: 0.7826
 Site-MNIST_M                       | Val  Loss: 0.7869 | Val  Acc: 0.7338
 Site-SVHN                          | Val  Loss: 1.1494 | Val  Acc: 0.6196
 Site-SVHN                          | Val  Loss: 1.2054 | Val  Acc: 0.6043
Average Valid Accuracy: 0.8217
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9783
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9130
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9532
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.8370
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.8237
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.7826
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.7338
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.6196
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.6043
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.1671 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1410 | Train Acc: 0.9632
 Site-USPS                          | Train Loss: 0.1478 | Train Acc: 0.9677
 Site-USPS                          | Train Loss: 0.1156 | Train Acc: 0.9686
 Site-SynthDigits                   | Train Loss: 0.6597 | Train Acc: 0.7628
 Site-SynthDigits                   | Train Loss: 0.4954 | Train Acc: 0.8682
 Site-MNIST_M                       | Train Loss: 0.9869 | Train Acc: 0.6739
 Site-MNIST_M                       | Train Loss: 0.7491 | Train Acc: 0.7462
 Site-SVHN                          | Train Loss: 1.4501 | Train Acc: 0.5121
 Site-SVHN                          | Train Loss: 1.1324 | Train Acc: 0.6197
Average Train Accuracy: 0.8034
 Site-MNIST                         | Val  Loss: 0.1178 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1393 | Val  Acc: 0.9604
 Site-USPS                          | Val  Loss: 0.2565 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1423 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.5541 | Val  Acc: 0.8478
 Site-SynthDigits                   | Val  Loss: 0.5705 | Val  Acc: 0.8273
 Site-MNIST_M                       | Val  Loss: 0.7185 | Val  Acc: 0.7717
 Site-MNIST_M                       | Val  Loss: 0.8012 | Val  Acc: 0.7482
 Site-SVHN                          | Val  Loss: 1.1595 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.2122 | Val  Acc: 0.6043
Average Valid Accuracy: 0.8206
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.1653 | Train Acc: 0.9461
 Site-MNIST                         | Train Loss: 0.1425 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.1499 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.1070 | Train Acc: 0.9704
 Site-SynthDigits                   | Train Loss: 0.6641 | Train Acc: 0.7628
 Site-SynthDigits                   | Train Loss: 0.4784 | Train Acc: 0.8735
 Site-MNIST_M                       | Train Loss: 0.9842 | Train Acc: 0.6658
 Site-MNIST_M                       | Train Loss: 0.7342 | Train Acc: 0.7552
 Site-SVHN                          | Train Loss: 1.4641 | Train Acc: 0.5040
 Site-SVHN                          | Train Loss: 1.1133 | Train Acc: 0.6287
Average Train Accuracy: 0.8028
 Site-MNIST                         | Val  Loss: 0.1211 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1428 | Val  Acc: 0.9640
 Site-USPS                          | Val  Loss: 0.2573 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1407 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.5371 | Val  Acc: 0.8370
 Site-SynthDigits                   | Val  Loss: 0.5613 | Val  Acc: 0.8201
 Site-MNIST_M                       | Val  Loss: 0.7053 | Val  Acc: 0.7717
 Site-MNIST_M                       | Val  Loss: 0.7833 | Val  Acc: 0.7374
 Site-SVHN                          | Val  Loss: 1.1183 | Val  Acc: 0.5870
 Site-SVHN                          | Val  Loss: 1.1886 | Val  Acc: 0.6007
Average Valid Accuracy: 0.8166
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.1614 | Train Acc: 0.9461
 Site-MNIST                         | Train Loss: 0.1451 | Train Acc: 0.9587
 Site-USPS                          | Train Loss: 0.1638 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.1088 | Train Acc: 0.9731
 Site-SynthDigits                   | Train Loss: 0.6355 | Train Acc: 0.7736
 Site-SynthDigits                   | Train Loss: 0.4528 | Train Acc: 0.8771
 Site-MNIST_M                       | Train Loss: 0.9814 | Train Acc: 0.6685
 Site-MNIST_M                       | Train Loss: 0.7201 | Train Acc: 0.7552
 Site-SVHN                          | Train Loss: 1.4373 | Train Acc: 0.5094
 Site-SVHN                          | Train Loss: 1.0900 | Train Acc: 0.6296
Average Train Accuracy: 0.8051
 Site-MNIST                         | Val  Loss: 0.1212 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1485 | Val  Acc: 0.9568
 Site-USPS                          | Val  Loss: 0.2506 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1377 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.5187 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.5431 | Val  Acc: 0.8273
 Site-MNIST_M                       | Val  Loss: 0.6826 | Val  Acc: 0.7500
 Site-MNIST_M                       | Val  Loss: 0.7640 | Val  Acc: 0.7374
 Site-SVHN                          | Val  Loss: 1.1085 | Val  Acc: 0.5870
 Site-SVHN                          | Val  Loss: 1.1697 | Val  Acc: 0.6043
Average Valid Accuracy: 0.8159
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.1554 | Train Acc: 0.9461
 Site-MNIST                         | Train Loss: 0.1299 | Train Acc: 0.9686
 Site-USPS                          | Train Loss: 0.1472 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.1032 | Train Acc: 0.9722
 Site-SynthDigits                   | Train Loss: 0.6326 | Train Acc: 0.7709
 Site-SynthDigits                   | Train Loss: 0.4568 | Train Acc: 0.8771
 Site-MNIST_M                       | Train Loss: 0.9707 | Train Acc: 0.6792
 Site-MNIST_M                       | Train Loss: 0.7264 | Train Acc: 0.7489
 Site-SVHN                          | Train Loss: 1.4371 | Train Acc: 0.5148
 Site-SVHN                          | Train Loss: 1.0875 | Train Acc: 0.6341
Average Train Accuracy: 0.8077
 Site-MNIST                         | Val  Loss: 0.1088 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.1315 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.2284 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1285 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.5109 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.5322 | Val  Acc: 0.8309
 Site-MNIST_M                       | Val  Loss: 0.6828 | Val  Acc: 0.7500
 Site-MNIST_M                       | Val  Loss: 0.7750 | Val  Acc: 0.7374
 Site-SVHN                          | Val  Loss: 1.0861 | Val  Acc: 0.6196
 Site-SVHN                          | Val  Loss: 1.1658 | Val  Acc: 0.6151
Average Valid Accuracy: 0.8253
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9783
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9348
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9568
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.8587
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.8309
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.7500
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.7374
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.6196
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.6151
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.1548 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1252 | Train Acc: 0.9677
 Site-USPS                          | Train Loss: 0.1329 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.1057 | Train Acc: 0.9704
 Site-SynthDigits                   | Train Loss: 0.6344 | Train Acc: 0.7763
 Site-SynthDigits                   | Train Loss: 0.4601 | Train Acc: 0.8807
 Site-MNIST_M                       | Train Loss: 0.9562 | Train Acc: 0.6712
 Site-MNIST_M                       | Train Loss: 0.6821 | Train Acc: 0.7695
 Site-SVHN                          | Train Loss: 1.4568 | Train Acc: 0.5067
 Site-SVHN                          | Train Loss: 1.0650 | Train Acc: 0.6332
Average Train Accuracy: 0.8092
 Site-MNIST                         | Val  Loss: 0.1048 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1271 | Val  Acc: 0.9676
 Site-USPS                          | Val  Loss: 0.2148 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1197 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.5168 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.5458 | Val  Acc: 0.8381
 Site-MNIST_M                       | Val  Loss: 0.6541 | Val  Acc: 0.7609
 Site-MNIST_M                       | Val  Loss: 0.7441 | Val  Acc: 0.7482
 Site-SVHN                          | Val  Loss: 1.0973 | Val  Acc: 0.5978
 Site-SVHN                          | Val  Loss: 1.1561 | Val  Acc: 0.5899
Average Valid Accuracy: 0.8231
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.1539 | Train Acc: 0.9488
 Site-MNIST                         | Train Loss: 0.1254 | Train Acc: 0.9677
 Site-USPS                          | Train Loss: 0.1401 | Train Acc: 0.9704
 Site-USPS                          | Train Loss: 0.0976 | Train Acc: 0.9758
 Site-SynthDigits                   | Train Loss: 0.6188 | Train Acc: 0.7763
 Site-SynthDigits                   | Train Loss: 0.4436 | Train Acc: 0.8852
 Site-MNIST_M                       | Train Loss: 0.9460 | Train Acc: 0.6792
 Site-MNIST_M                       | Train Loss: 0.6846 | Train Acc: 0.7596
 Site-SVHN                          | Train Loss: 1.4185 | Train Acc: 0.5283
 Site-SVHN                          | Train Loss: 1.0376 | Train Acc: 0.6466
Average Train Accuracy: 0.8138
 Site-MNIST                         | Val  Loss: 0.1022 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1296 | Val  Acc: 0.9640
 Site-USPS                          | Val  Loss: 0.2171 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1235 | Val  Acc: 0.9676
 Site-SynthDigits                   | Val  Loss: 0.4948 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.5237 | Val  Acc: 0.8453
 Site-MNIST_M                       | Val  Loss: 0.6596 | Val  Acc: 0.7609
 Site-MNIST_M                       | Val  Loss: 0.7336 | Val  Acc: 0.7446
 Site-SVHN                          | Val  Loss: 1.0832 | Val  Acc: 0.6196
 Site-SVHN                          | Val  Loss: 1.1362 | Val  Acc: 0.6151
Average Valid Accuracy: 0.8289
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.9640
 Best site-USPS                      | Epoch:32 | Val Acc: 0.9348
 Best site-USPS                      | Epoch:32 | Val Acc: 0.9676
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.8696
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.8453
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.7609
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.7446
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.6196
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.6151
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.1498 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1257 | Train Acc: 0.9677
 Site-USPS                          | Train Loss: 0.1438 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.0988 | Train Acc: 0.9695
 Site-SynthDigits                   | Train Loss: 0.6198 | Train Acc: 0.7736
 Site-SynthDigits                   | Train Loss: 0.4317 | Train Acc: 0.8888
 Site-MNIST_M                       | Train Loss: 0.9567 | Train Acc: 0.6819
 Site-MNIST_M                       | Train Loss: 0.6761 | Train Acc: 0.7668
 Site-SVHN                          | Train Loss: 1.4310 | Train Acc: 0.5067
 Site-SVHN                          | Train Loss: 1.0386 | Train Acc: 0.6502
Average Train Accuracy: 0.8116
 Site-MNIST                         | Val  Loss: 0.1050 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1242 | Val  Acc: 0.9640
 Site-USPS                          | Val  Loss: 0.2141 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1213 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.4907 | Val  Acc: 0.8913
 Site-SynthDigits                   | Val  Loss: 0.5120 | Val  Acc: 0.8453
 Site-MNIST_M                       | Val  Loss: 0.6630 | Val  Acc: 0.7826
 Site-MNIST_M                       | Val  Loss: 0.7397 | Val  Acc: 0.7626
 Site-SVHN                          | Val  Loss: 1.0686 | Val  Acc: 0.5978
 Site-SVHN                          | Val  Loss: 1.1297 | Val  Acc: 0.6043
Average Valid Accuracy: 0.8296
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.9640
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9239
 Best site-USPS                      | Epoch:33 | Val Acc: 0.9568
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.8913
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.8453
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.7826
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.7626
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.5978
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.6043
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.1402 | Train Acc: 0.9488
 Site-MNIST                         | Train Loss: 0.1202 | Train Acc: 0.9677
 Site-USPS                          | Train Loss: 0.1413 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.0922 | Train Acc: 0.9749
 Site-SynthDigits                   | Train Loss: 0.6157 | Train Acc: 0.7978
 Site-SynthDigits                   | Train Loss: 0.4366 | Train Acc: 0.8825
 Site-MNIST_M                       | Train Loss: 0.9317 | Train Acc: 0.6900
 Site-MNIST_M                       | Train Loss: 0.6669 | Train Acc: 0.7812
 Site-SVHN                          | Train Loss: 1.4357 | Train Acc: 0.5121
 Site-SVHN                          | Train Loss: 1.0241 | Train Acc: 0.6565
Average Train Accuracy: 0.8174
 Site-MNIST                         | Val  Loss: 0.0989 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1165 | Val  Acc: 0.9640
 Site-USPS                          | Val  Loss: 0.1934 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1139 | Val  Acc: 0.9640
 Site-SynthDigits                   | Val  Loss: 0.4904 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.5244 | Val  Acc: 0.8525
 Site-MNIST_M                       | Val  Loss: 0.6401 | Val  Acc: 0.7935
 Site-MNIST_M                       | Val  Loss: 0.7287 | Val  Acc: 0.7698
 Site-SVHN                          | Val  Loss: 1.0684 | Val  Acc: 0.6196
 Site-SVHN                          | Val  Loss: 1.1271 | Val  Acc: 0.6151
Average Valid Accuracy: 0.8339
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9640
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9348
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9640
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.8587
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.8525
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.7935
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.7698
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.6196
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.6151
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.1486 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1203 | Train Acc: 0.9695
 Site-USPS                          | Train Loss: 0.1262 | Train Acc: 0.9677
 Site-USPS                          | Train Loss: 0.0880 | Train Acc: 0.9749
 Site-SynthDigits                   | Train Loss: 0.6116 | Train Acc: 0.7844
 Site-SynthDigits                   | Train Loss: 0.4183 | Train Acc: 0.8924
 Site-MNIST_M                       | Train Loss: 0.9036 | Train Acc: 0.6846
 Site-MNIST_M                       | Train Loss: 0.6315 | Train Acc: 0.7830
 Site-SVHN                          | Train Loss: 1.4054 | Train Acc: 0.5202
 Site-SVHN                          | Train Loss: 0.9972 | Train Acc: 0.6646
Average Train Accuracy: 0.8193
 Site-MNIST                         | Val  Loss: 0.1003 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1185 | Val  Acc: 0.9676
 Site-USPS                          | Val  Loss: 0.1896 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1092 | Val  Acc: 0.9640
 Site-SynthDigits                   | Val  Loss: 0.4790 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.5071 | Val  Acc: 0.8453
 Site-MNIST_M                       | Val  Loss: 0.5942 | Val  Acc: 0.8043
 Site-MNIST_M                       | Val  Loss: 0.6922 | Val  Acc: 0.7734
 Site-SVHN                          | Val  Loss: 1.0602 | Val  Acc: 0.6522
 Site-SVHN                          | Val  Loss: 1.1187 | Val  Acc: 0.6331
Average Valid Accuracy: 0.8401
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9676
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9239
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9640
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.8696
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.8453
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.8043
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.7734
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.6522
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.6331
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.1522 | Train Acc: 0.9461
 Site-MNIST                         | Train Loss: 0.1120 | Train Acc: 0.9695
 Site-USPS                          | Train Loss: 0.1321 | Train Acc: 0.9704
 Site-USPS                          | Train Loss: 0.0922 | Train Acc: 0.9758
 Site-SynthDigits                   | Train Loss: 0.6055 | Train Acc: 0.7925
 Site-SynthDigits                   | Train Loss: 0.4102 | Train Acc: 0.8915
 Site-MNIST_M                       | Train Loss: 0.8993 | Train Acc: 0.6900
 Site-MNIST_M                       | Train Loss: 0.6357 | Train Acc: 0.7901
 Site-SVHN                          | Train Loss: 1.4122 | Train Acc: 0.5202
 Site-SVHN                          | Train Loss: 1.0140 | Train Acc: 0.6538
Average Train Accuracy: 0.8200
 Site-MNIST                         | Val  Loss: 0.0928 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1135 | Val  Acc: 0.9676
 Site-USPS                          | Val  Loss: 0.1919 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1091 | Val  Acc: 0.9640
 Site-SynthDigits                   | Val  Loss: 0.4463 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.4966 | Val  Acc: 0.8417
 Site-MNIST_M                       | Val  Loss: 0.5895 | Val  Acc: 0.7935
 Site-MNIST_M                       | Val  Loss: 0.6828 | Val  Acc: 0.7770
 Site-SVHN                          | Val  Loss: 1.0809 | Val  Acc: 0.6522
 Site-SVHN                          | Val  Loss: 1.1248 | Val  Acc: 0.6259
Average Valid Accuracy: 0.8383
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.1553 | Train Acc: 0.9434
 Site-MNIST                         | Train Loss: 0.1155 | Train Acc: 0.9668
 Site-USPS                          | Train Loss: 0.1260 | Train Acc: 0.9704
 Site-USPS                          | Train Loss: 0.0846 | Train Acc: 0.9767
 Site-SynthDigits                   | Train Loss: 0.5872 | Train Acc: 0.7898
 Site-SynthDigits                   | Train Loss: 0.4046 | Train Acc: 0.8942
 Site-MNIST_M                       | Train Loss: 0.9265 | Train Acc: 0.6900
 Site-MNIST_M                       | Train Loss: 0.6275 | Train Acc: 0.7848
 Site-SVHN                          | Train Loss: 1.4106 | Train Acc: 0.5229
 Site-SVHN                          | Train Loss: 0.9783 | Train Acc: 0.6664
Average Train Accuracy: 0.8205
 Site-MNIST                         | Val  Loss: 0.0957 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1158 | Val  Acc: 0.9604
 Site-USPS                          | Val  Loss: 0.1722 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.1037 | Val  Acc: 0.9712
 Site-SynthDigits                   | Val  Loss: 0.4593 | Val  Acc: 0.8370
 Site-SynthDigits                   | Val  Loss: 0.4881 | Val  Acc: 0.8345
 Site-MNIST_M                       | Val  Loss: 0.6056 | Val  Acc: 0.8043
 Site-MNIST_M                       | Val  Loss: 0.6993 | Val  Acc: 0.7806
 Site-SVHN                          | Val  Loss: 1.0191 | Val  Acc: 0.6630
 Site-SVHN                          | Val  Loss: 1.0730 | Val  Acc: 0.6367
Average Valid Accuracy: 0.8401
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.1493 | Train Acc: 0.9488
 Site-MNIST                         | Train Loss: 0.1149 | Train Acc: 0.9722
 Site-USPS                          | Train Loss: 0.1329 | Train Acc: 0.9704
 Site-USPS                          | Train Loss: 0.0896 | Train Acc: 0.9776
 Site-SynthDigits                   | Train Loss: 0.5832 | Train Acc: 0.8005
 Site-SynthDigits                   | Train Loss: 0.4064 | Train Acc: 0.8852
 Site-MNIST_M                       | Train Loss: 0.9022 | Train Acc: 0.6873
 Site-MNIST_M                       | Train Loss: 0.6071 | Train Acc: 0.7910
 Site-SVHN                          | Train Loss: 1.3895 | Train Acc: 0.5202
 Site-SVHN                          | Train Loss: 1.0016 | Train Acc: 0.6511
Average Train Accuracy: 0.8204
 Site-MNIST                         | Val  Loss: 0.0965 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1136 | Val  Acc: 0.9676
 Site-USPS                          | Val  Loss: 0.1907 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1117 | Val  Acc: 0.9676
 Site-SynthDigits                   | Val  Loss: 0.4450 | Val  Acc: 0.8478
 Site-SynthDigits                   | Val  Loss: 0.4831 | Val  Acc: 0.8417
 Site-MNIST_M                       | Val  Loss: 0.5721 | Val  Acc: 0.8261
 Site-MNIST_M                       | Val  Loss: 0.6690 | Val  Acc: 0.7842
 Site-SVHN                          | Val  Loss: 1.0697 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.0988 | Val  Acc: 0.6043
Average Valid Accuracy: 0.8350
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.1488 | Train Acc: 0.9488
 Site-MNIST                         | Train Loss: 0.1134 | Train Acc: 0.9686
 Site-USPS                          | Train Loss: 0.1334 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.0841 | Train Acc: 0.9749
 Site-SynthDigits                   | Train Loss: 0.5893 | Train Acc: 0.7951
 Site-SynthDigits                   | Train Loss: 0.3943 | Train Acc: 0.8942
 Site-MNIST_M                       | Train Loss: 0.8861 | Train Acc: 0.6900
 Site-MNIST_M                       | Train Loss: 0.5902 | Train Acc: 0.8018
 Site-SVHN                          | Train Loss: 1.3950 | Train Acc: 0.5148
 Site-SVHN                          | Train Loss: 0.9819 | Train Acc: 0.6709
Average Train Accuracy: 0.8221
 Site-MNIST                         | Val  Loss: 0.0978 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1125 | Val  Acc: 0.9604
 Site-USPS                          | Val  Loss: 0.1933 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1069 | Val  Acc: 0.9604
 Site-SynthDigits                   | Val  Loss: 0.4477 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.4807 | Val  Acc: 0.8489
 Site-MNIST_M                       | Val  Loss: 0.5533 | Val  Acc: 0.7935
 Site-MNIST_M                       | Val  Loss: 0.6615 | Val  Acc: 0.7662
 Site-SVHN                          | Val  Loss: 1.0499 | Val  Acc: 0.6304
 Site-SVHN                          | Val  Loss: 1.0769 | Val  Acc: 0.6295
Average Valid Accuracy: 0.8329
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.1453 | Train Acc: 0.9488
 Site-MNIST                         | Train Loss: 0.1079 | Train Acc: 0.9713
 Site-USPS                          | Train Loss: 0.1286 | Train Acc: 0.9704
 Site-USPS                          | Train Loss: 0.0802 | Train Acc: 0.9785
 Site-SynthDigits                   | Train Loss: 0.5686 | Train Acc: 0.7978
 Site-SynthDigits                   | Train Loss: 0.3893 | Train Acc: 0.8969
 Site-MNIST_M                       | Train Loss: 0.9065 | Train Acc: 0.6873
 Site-MNIST_M                       | Train Loss: 0.5989 | Train Acc: 0.7955
 Site-SVHN                          | Train Loss: 1.3942 | Train Acc: 0.5175
 Site-SVHN                          | Train Loss: 0.9840 | Train Acc: 0.6637
Average Train Accuracy: 0.8228
 Site-MNIST                         | Val  Loss: 0.0938 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1076 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.1740 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.1016 | Val  Acc: 0.9748
 Site-SynthDigits                   | Val  Loss: 0.4260 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.4681 | Val  Acc: 0.8489
 Site-MNIST_M                       | Val  Loss: 0.5547 | Val  Acc: 0.8261
 Site-MNIST_M                       | Val  Loss: 0.6544 | Val  Acc: 0.7698
 Site-SVHN                          | Val  Loss: 1.0435 | Val  Acc: 0.6522
 Site-SVHN                          | Val  Loss: 1.0823 | Val  Acc: 0.6295
Average Valid Accuracy: 0.8455
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9457
 Best site-USPS                      | Epoch:40 | Val Acc: 0.9748
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.8696
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.8489
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.8261
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.7698
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.6522
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.6295
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.1367 | Train Acc: 0.9569
 Site-MNIST                         | Train Loss: 0.1000 | Train Acc: 0.9740
 Site-USPS                          | Train Loss: 0.1227 | Train Acc: 0.9677
 Site-USPS                          | Train Loss: 0.0799 | Train Acc: 0.9785
 Site-SynthDigits                   | Train Loss: 0.5787 | Train Acc: 0.7951
 Site-SynthDigits                   | Train Loss: 0.3815 | Train Acc: 0.9076
 Site-MNIST_M                       | Train Loss: 0.9062 | Train Acc: 0.6873
 Site-MNIST_M                       | Train Loss: 0.5889 | Train Acc: 0.8045
 Site-SVHN                          | Train Loss: 1.4004 | Train Acc: 0.5148
 Site-SVHN                          | Train Loss: 0.9571 | Train Acc: 0.6834
Average Train Accuracy: 0.8270
 Site-MNIST                         | Val  Loss: 0.0857 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.0996 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.1748 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.0992 | Val  Acc: 0.9712
 Site-SynthDigits                   | Val  Loss: 0.4335 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.4694 | Val  Acc: 0.8525
 Site-MNIST_M                       | Val  Loss: 0.5536 | Val  Acc: 0.8261
 Site-MNIST_M                       | Val  Loss: 0.6559 | Val  Acc: 0.7914
 Site-SVHN                          | Val  Loss: 1.0072 | Val  Acc: 0.6630
 Site-SVHN                          | Val  Loss: 1.0659 | Val  Acc: 0.6439
Average Valid Accuracy: 0.8491
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:41 | Val Acc: 0.9457
 Best site-USPS                      | Epoch:41 | Val Acc: 0.9712
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.8587
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.8525
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.8261
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.7914
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.6630
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.6439
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.1421 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.0990 | Train Acc: 0.9749
 Site-USPS                          | Train Loss: 0.1222 | Train Acc: 0.9730
 Site-USPS                          | Train Loss: 0.0777 | Train Acc: 0.9794
 Site-SynthDigits                   | Train Loss: 0.5708 | Train Acc: 0.8032
 Site-SynthDigits                   | Train Loss: 0.3806 | Train Acc: 0.9022
 Site-MNIST_M                       | Train Loss: 0.8991 | Train Acc: 0.6954
 Site-MNIST_M                       | Train Loss: 0.5704 | Train Acc: 0.8036
 Site-SVHN                          | Train Loss: 1.3711 | Train Acc: 0.5256
 Site-SVHN                          | Train Loss: 0.9518 | Train Acc: 0.6807
Average Train Accuracy: 0.8290
 Site-MNIST                         | Val  Loss: 0.0899 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1021 | Val  Acc: 0.9676
 Site-USPS                          | Val  Loss: 0.1607 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.0963 | Val  Acc: 0.9748
 Site-SynthDigits                   | Val  Loss: 0.4285 | Val  Acc: 0.8913
 Site-SynthDigits                   | Val  Loss: 0.4676 | Val  Acc: 0.8633
 Site-MNIST_M                       | Val  Loss: 0.5444 | Val  Acc: 0.8370
 Site-MNIST_M                       | Val  Loss: 0.6475 | Val  Acc: 0.7914
 Site-SVHN                          | Val  Loss: 0.9929 | Val  Acc: 0.6522
 Site-SVHN                          | Val  Loss: 1.0483 | Val  Acc: 0.6403
Average Valid Accuracy: 0.8531
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.9676
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9457
 Best site-USPS                      | Epoch:42 | Val Acc: 0.9748
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.8913
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.8633
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.8370
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.7914
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.6522
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.6403
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.1354 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1000 | Train Acc: 0.9740
 Site-USPS                          | Train Loss: 0.1305 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.0804 | Train Acc: 0.9785
 Site-SynthDigits                   | Train Loss: 0.5511 | Train Acc: 0.8086
 Site-SynthDigits                   | Train Loss: 0.3543 | Train Acc: 0.9076
 Site-MNIST_M                       | Train Loss: 0.9107 | Train Acc: 0.6900
 Site-MNIST_M                       | Train Loss: 0.5868 | Train Acc: 0.7964
 Site-SVHN                          | Train Loss: 1.3879 | Train Acc: 0.5175
 Site-SVHN                          | Train Loss: 0.9465 | Train Acc: 0.6789
Average Train Accuracy: 0.8268
 Site-MNIST                         | Val  Loss: 0.0876 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1000 | Val  Acc: 0.9640
 Site-USPS                          | Val  Loss: 0.1701 | Val  Acc: 0.9565
 Site-USPS                          | Val  Loss: 0.0994 | Val  Acc: 0.9748
 Site-SynthDigits                   | Val  Loss: 0.4002 | Val  Acc: 0.8804
 Site-SynthDigits                   | Val  Loss: 0.4395 | Val  Acc: 0.8669
 Site-MNIST_M                       | Val  Loss: 0.5499 | Val  Acc: 0.8370
 Site-MNIST_M                       | Val  Loss: 0.6480 | Val  Acc: 0.7914
 Site-SVHN                          | Val  Loss: 1.0161 | Val  Acc: 0.6630
 Site-SVHN                          | Val  Loss: 1.0594 | Val  Acc: 0.6511
Average Valid Accuracy: 0.8553
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9640
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9565
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9748
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.8804
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.8669
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.8370
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.7914
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.6630
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.6511
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.1318 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.0981 | Train Acc: 0.9740
 Site-USPS                          | Train Loss: 0.1191 | Train Acc: 0.9704
 Site-USPS                          | Train Loss: 0.0765 | Train Acc: 0.9803
 Site-SynthDigits                   | Train Loss: 0.5546 | Train Acc: 0.8140
 Site-SynthDigits                   | Train Loss: 0.3540 | Train Acc: 0.9121
 Site-MNIST_M                       | Train Loss: 0.8838 | Train Acc: 0.6981
 Site-MNIST_M                       | Train Loss: 0.5576 | Train Acc: 0.8081
 Site-SVHN                          | Train Loss: 1.3882 | Train Acc: 0.5391
 Site-SVHN                          | Train Loss: 0.9468 | Train Acc: 0.6780
Average Train Accuracy: 0.8326
 Site-MNIST                         | Val  Loss: 0.0838 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.0988 | Val  Acc: 0.9676
 Site-USPS                          | Val  Loss: 0.1602 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.0930 | Val  Acc: 0.9712
 Site-SynthDigits                   | Val  Loss: 0.3880 | Val  Acc: 0.8913
 Site-SynthDigits                   | Val  Loss: 0.4428 | Val  Acc: 0.8669
 Site-MNIST_M                       | Val  Loss: 0.4979 | Val  Acc: 0.8370
 Site-MNIST_M                       | Val  Loss: 0.6192 | Val  Acc: 0.7986
 Site-SVHN                          | Val  Loss: 1.0105 | Val  Acc: 0.6630
 Site-SVHN                          | Val  Loss: 1.0599 | Val  Acc: 0.6655
Average Valid Accuracy: 0.8574
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9676
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9457
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9712
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.8913
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.8669
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.8370
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.7986
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.6630
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.6655
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.1353 | Train Acc: 0.9542
 Site-MNIST                         | Train Loss: 0.0957 | Train Acc: 0.9758
 Site-USPS                          | Train Loss: 0.1155 | Train Acc: 0.9704
 Site-USPS                          | Train Loss: 0.0751 | Train Acc: 0.9785
 Site-SynthDigits                   | Train Loss: 0.5447 | Train Acc: 0.8113
 Site-SynthDigits                   | Train Loss: 0.3499 | Train Acc: 0.9121
 Site-MNIST_M                       | Train Loss: 0.9107 | Train Acc: 0.6792
 Site-MNIST_M                       | Train Loss: 0.5513 | Train Acc: 0.8117
 Site-SVHN                          | Train Loss: 1.3726 | Train Acc: 0.5391
 Site-SVHN                          | Train Loss: 0.9318 | Train Acc: 0.6816
Average Train Accuracy: 0.8314
 Site-MNIST                         | Val  Loss: 0.0847 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.0982 | Val  Acc: 0.9748
 Site-USPS                          | Val  Loss: 0.1748 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.1012 | Val  Acc: 0.9712
 Site-SynthDigits                   | Val  Loss: 0.3820 | Val  Acc: 0.9130
 Site-SynthDigits                   | Val  Loss: 0.4274 | Val  Acc: 0.8777
 Site-MNIST_M                       | Val  Loss: 0.4924 | Val  Acc: 0.8587
 Site-MNIST_M                       | Val  Loss: 0.6114 | Val  Acc: 0.8129
 Site-SVHN                          | Val  Loss: 0.9940 | Val  Acc: 0.6413
 Site-SVHN                          | Val  Loss: 1.0491 | Val  Acc: 0.6367
Average Valid Accuracy: 0.8610
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9783
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.9748
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9457
 Best site-USPS                      | Epoch:45 | Val Acc: 0.9712
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.9130
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.8777
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.8587
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.8129
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.6413
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.6367
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.1370 | Train Acc: 0.9569
 Site-MNIST                         | Train Loss: 0.0918 | Train Acc: 0.9758
 Site-USPS                          | Train Loss: 0.1078 | Train Acc: 0.9757
 Site-USPS                          | Train Loss: 0.0688 | Train Acc: 0.9785
 Site-SynthDigits                   | Train Loss: 0.5618 | Train Acc: 0.8032
 Site-SynthDigits                   | Train Loss: 0.3489 | Train Acc: 0.9085
 Site-MNIST_M                       | Train Loss: 0.8853 | Train Acc: 0.7035
 Site-MNIST_M                       | Train Loss: 0.5324 | Train Acc: 0.8251
 Site-SVHN                          | Train Loss: 1.3779 | Train Acc: 0.5391
 Site-SVHN                          | Train Loss: 0.9279 | Train Acc: 0.6861
Average Train Accuracy: 0.8352
 Site-MNIST                         | Val  Loss: 0.0852 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.0960 | Val  Acc: 0.9712
 Site-USPS                          | Val  Loss: 0.1512 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.0866 | Val  Acc: 0.9748
 Site-SynthDigits                   | Val  Loss: 0.3776 | Val  Acc: 0.8913
 Site-SynthDigits                   | Val  Loss: 0.4395 | Val  Acc: 0.8669
 Site-MNIST_M                       | Val  Loss: 0.4736 | Val  Acc: 0.8696
 Site-MNIST_M                       | Val  Loss: 0.5993 | Val  Acc: 0.8165
 Site-SVHN                          | Val  Loss: 0.9706 | Val  Acc: 0.6630
 Site-SVHN                          | Val  Loss: 1.0374 | Val  Acc: 0.6547
Average Valid Accuracy: 0.8621
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:46 | Val Acc: 0.9712
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9457
 Best site-USPS                      | Epoch:46 | Val Acc: 0.9748
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.8913
 Best site-SynthDigits               | Epoch:46 | Val Acc: 0.8669
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.8696
 Best site-MNIST_M                   | Epoch:46 | Val Acc: 0.8165
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.6630
 Best site-SVHN                      | Epoch:46 | Val Acc: 0.6547
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.1399 | Train Acc: 0.9596
 Site-MNIST                         | Train Loss: 0.0950 | Train Acc: 0.9776
 Site-USPS                          | Train Loss: 0.1158 | Train Acc: 0.9730
 Site-USPS                          | Train Loss: 0.0693 | Train Acc: 0.9794
 Site-SynthDigits                   | Train Loss: 0.5525 | Train Acc: 0.8086
 Site-SynthDigits                   | Train Loss: 0.3465 | Train Acc: 0.9076
 Site-MNIST_M                       | Train Loss: 0.8619 | Train Acc: 0.6954
 Site-MNIST_M                       | Train Loss: 0.5122 | Train Acc: 0.8341
 Site-SVHN                          | Train Loss: 1.3742 | Train Acc: 0.5310
 Site-SVHN                          | Train Loss: 0.9107 | Train Acc: 0.6870
Average Train Accuracy: 0.8353
 Site-MNIST                         | Val  Loss: 0.0858 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.0948 | Val  Acc: 0.9748
 Site-USPS                          | Val  Loss: 0.1573 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.0897 | Val  Acc: 0.9676
 Site-SynthDigits                   | Val  Loss: 0.3920 | Val  Acc: 0.8804
 Site-SynthDigits                   | Val  Loss: 0.4418 | Val  Acc: 0.8597
 Site-MNIST_M                       | Val  Loss: 0.4647 | Val  Acc: 0.8478
 Site-MNIST_M                       | Val  Loss: 0.5862 | Val  Acc: 0.7950
 Site-SVHN                          | Val  Loss: 0.9585 | Val  Acc: 0.6522
 Site-SVHN                          | Val  Loss: 1.0272 | Val  Acc: 0.6439
Average Valid Accuracy: 0.8524
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.1212 | Train Acc: 0.9569
 Site-MNIST                         | Train Loss: 0.0907 | Train Acc: 0.9767
 Site-USPS                          | Train Loss: 0.1137 | Train Acc: 0.9730
 Site-USPS                          | Train Loss: 0.0686 | Train Acc: 0.9848
 Site-SynthDigits                   | Train Loss: 0.5569 | Train Acc: 0.8005
 Site-SynthDigits                   | Train Loss: 0.3515 | Train Acc: 0.9067
 Site-MNIST_M                       | Train Loss: 0.8591 | Train Acc: 0.7116
 Site-MNIST_M                       | Train Loss: 0.5128 | Train Acc: 0.8296
 Site-SVHN                          | Train Loss: 1.4138 | Train Acc: 0.5418
 Site-SVHN                          | Train Loss: 0.9470 | Train Acc: 0.6825
Average Train Accuracy: 0.8364
 Site-MNIST                         | Val  Loss: 0.0833 | Val  Acc: 0.9783
 Site-MNIST                         | Val  Loss: 0.0925 | Val  Acc: 0.9748
 Site-USPS                          | Val  Loss: 0.1494 | Val  Acc: 0.9674
 Site-USPS                          | Val  Loss: 0.0847 | Val  Acc: 0.9856
 Site-SynthDigits                   | Val  Loss: 0.3796 | Val  Acc: 0.8913
 Site-SynthDigits                   | Val  Loss: 0.4482 | Val  Acc: 0.8597
 Site-MNIST_M                       | Val  Loss: 0.4577 | Val  Acc: 0.8696
 Site-MNIST_M                       | Val  Loss: 0.5816 | Val  Acc: 0.8094
 Site-SVHN                          | Val  Loss: 1.0076 | Val  Acc: 0.6413
 Site-SVHN                          | Val  Loss: 1.0698 | Val  Acc: 0.6439
Average Valid Accuracy: 0.8621
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9783
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9748
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9674
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9856
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.8913
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.8597
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.8696
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.8094
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.6413
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.6439
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.1252 | Train Acc: 0.9542
 Site-MNIST                         | Train Loss: 0.0957 | Train Acc: 0.9749
 Site-USPS                          | Train Loss: 0.1077 | Train Acc: 0.9730
 Site-USPS                          | Train Loss: 0.0668 | Train Acc: 0.9794
 Site-SynthDigits                   | Train Loss: 0.5600 | Train Acc: 0.7925
 Site-SynthDigits                   | Train Loss: 0.3321 | Train Acc: 0.9175
 Site-MNIST_M                       | Train Loss: 0.8782 | Train Acc: 0.7035
 Site-MNIST_M                       | Train Loss: 0.5108 | Train Acc: 0.8350
 Site-SVHN                          | Train Loss: 1.3931 | Train Acc: 0.5391
 Site-SVHN                          | Train Loss: 0.9007 | Train Acc: 0.6897
Average Train Accuracy: 0.8359
 Site-MNIST                         | Val  Loss: 0.0884 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.0945 | Val  Acc: 0.9676
 Site-USPS                          | Val  Loss: 0.1333 | Val  Acc: 0.9674
 Site-USPS                          | Val  Loss: 0.0827 | Val  Acc: 0.9820
 Site-SynthDigits                   | Val  Loss: 0.3677 | Val  Acc: 0.9022
 Site-SynthDigits                   | Val  Loss: 0.4317 | Val  Acc: 0.8705
 Site-MNIST_M                       | Val  Loss: 0.4762 | Val  Acc: 0.8587
 Site-MNIST_M                       | Val  Loss: 0.5951 | Val  Acc: 0.7986
 Site-SVHN                          | Val  Loss: 0.9437 | Val  Acc: 0.6848
 Site-SVHN                          | Val  Loss: 1.0107 | Val  Acc: 0.6619
Average Valid Accuracy: 0.8650
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9565
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9676
 Best site-USPS                      | Epoch:49 | Val Acc: 0.9674
 Best site-USPS                      | Epoch:49 | Val Acc: 0.9820
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.9022
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.8705
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.8587
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.7986
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.6848
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.6619
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/fedsam...
===2023-07-31 19:33:43===
===2023-07-31 19:33:53===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.9331
 Test site-USPS                      | Epoch:49 | Test Acc: 0.9441
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.8046
 Test site-MNIST_M                   | Epoch:49 | Test Acc: 0.5954
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.4845
MNIST: 0.9331, USPS: 0.9441, SynthDigits: 0.8046, MNIST_M: 0.5954, SVHN: 0.4845, 
Average Test Accuracy(group): 0.7524, Average Test Accuracy(individual): 0.7524,
domain std=0.1836, cluster std=-1.0000, individual std=0.1836, 
