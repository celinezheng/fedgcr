===2023-07-31 10:55:34===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 1.3465 | Train Acc: 0.6334
 Site-MNIST                         | Train Loss: 1.4248 | Train Acc: 0.5776
 Site-USPS                          | Train Loss: 1.1753 | Train Acc: 0.7385
 Site-USPS                          | Train Loss: 1.1490 | Train Acc: 0.7444
 Site-SynthDigits                   | Train Loss: 1.7935 | Train Acc: 0.4205
 Site-SynthDigits                   | Train Loss: 1.7248 | Train Acc: 0.4592
 Site-MNIST_M                       | Train Loss: 2.0518 | Train Acc: 0.2642
 Site-MNIST_M                       | Train Loss: 2.0713 | Train Acc: 0.2700
 Site-SVHN                          | Train Loss: 2.0887 | Train Acc: 0.2722
 Site-SVHN                          | Train Loss: 2.0437 | Train Acc: 0.2942
Average Train Accuracy: 0.4674
 Site-MNIST                         | Val  Loss: 1.4880 | Val  Acc: 0.5326
 Site-MNIST                         | Val  Loss: 1.4263 | Val  Acc: 0.5791
 Site-USPS                          | Val  Loss: 1.2534 | Val  Acc: 0.7174
 Site-USPS                          | Val  Loss: 1.2081 | Val  Acc: 0.7374
 Site-SynthDigits                   | Val  Loss: 1.7396 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.7666 | Val  Acc: 0.4388
 Site-MNIST_M                       | Val  Loss: 2.0950 | Val  Acc: 0.2609
 Site-MNIST_M                       | Val  Loss: 2.0334 | Val  Acc: 0.2734
 Site-SVHN                          | Val  Loss: 1.9753 | Val  Acc: 0.3478
 Site-SVHN                          | Val  Loss: 2.0396 | Val  Acc: 0.3129
Average Valid Accuracy: 0.4668
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5326
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5791
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7174
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7374
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.4674
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.4388
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.2609
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.2734
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.3478
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.3129
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 0.8718 | Train Acc: 0.7898
 Site-MNIST                         | Train Loss: 0.9398 | Train Acc: 0.7516
 Site-USPS                          | Train Loss: 0.7191 | Train Acc: 0.8275
 Site-USPS                          | Train Loss: 0.7301 | Train Acc: 0.8206
 Site-SynthDigits                   | Train Loss: 1.5605 | Train Acc: 0.4825
 Site-SynthDigits                   | Train Loss: 1.4332 | Train Acc: 0.5498
 Site-MNIST_M                       | Train Loss: 1.7738 | Train Acc: 0.3827
 Site-MNIST_M                       | Train Loss: 1.8046 | Train Acc: 0.3964
 Site-SVHN                          | Train Loss: 1.9540 | Train Acc: 0.3288
 Site-SVHN                          | Train Loss: 1.8867 | Train Acc: 0.3444
Average Train Accuracy: 0.5674
 Site-MNIST                         | Val  Loss: 0.9558 | Val  Acc: 0.7935
 Site-MNIST                         | Val  Loss: 0.9143 | Val  Acc: 0.7806
 Site-USPS                          | Val  Loss: 0.8243 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 0.7504 | Val  Acc: 0.8129
 Site-SynthDigits                   | Val  Loss: 1.4532 | Val  Acc: 0.5217
 Site-SynthDigits                   | Val  Loss: 1.5209 | Val  Acc: 0.5144
 Site-MNIST_M                       | Val  Loss: 1.7903 | Val  Acc: 0.3804
 Site-MNIST_M                       | Val  Loss: 1.7342 | Val  Acc: 0.4137
 Site-SVHN                          | Val  Loss: 1.8045 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 1.8748 | Val  Acc: 0.3273
Average Valid Accuracy: 0.5610
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7935
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7806
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:1 | Val Acc: 0.8129
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.5217
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.5144
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.3804
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.4137
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.3273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 0.6681 | Train Acc: 0.8356
 Site-MNIST                         | Train Loss: 0.7684 | Train Acc: 0.7776
 Site-USPS                          | Train Loss: 0.5695 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.5726 | Train Acc: 0.8628
 Site-SynthDigits                   | Train Loss: 1.3870 | Train Acc: 0.5526
 Site-SynthDigits                   | Train Loss: 1.2648 | Train Acc: 0.6054
 Site-MNIST_M                       | Train Loss: 1.6409 | Train Acc: 0.4555
 Site-MNIST_M                       | Train Loss: 1.6936 | Train Acc: 0.4251
 Site-SVHN                          | Train Loss: 1.8615 | Train Acc: 0.3396
 Site-SVHN                          | Train Loss: 1.7623 | Train Acc: 0.3839
Average Train Accuracy: 0.6109
 Site-MNIST                         | Val  Loss: 0.7879 | Val  Acc: 0.7935
 Site-MNIST                         | Val  Loss: 0.7484 | Val  Acc: 0.8094
 Site-USPS                          | Val  Loss: 0.7155 | Val  Acc: 0.8478
 Site-USPS                          | Val  Loss: 0.6273 | Val  Acc: 0.8453
 Site-SynthDigits                   | Val  Loss: 1.2507 | Val  Acc: 0.6304
 Site-SynthDigits                   | Val  Loss: 1.3234 | Val  Acc: 0.6007
 Site-MNIST_M                       | Val  Loss: 1.6993 | Val  Acc: 0.4022
 Site-MNIST_M                       | Val  Loss: 1.6029 | Val  Acc: 0.4640
 Site-SVHN                          | Val  Loss: 1.7131 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 1.7839 | Val  Acc: 0.3381
Average Valid Accuracy: 0.6068
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7935
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8094
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8478
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8453
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.6304
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.6007
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4022
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4640
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.3381
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 0.5412 | Train Acc: 0.8598
 Site-MNIST                         | Train Loss: 0.6356 | Train Acc: 0.8179
 Site-USPS                          | Train Loss: 0.4897 | Train Acc: 0.8733
 Site-USPS                          | Train Loss: 0.4824 | Train Acc: 0.8735
 Site-SynthDigits                   | Train Loss: 1.3183 | Train Acc: 0.5741
 Site-SynthDigits                   | Train Loss: 1.1789 | Train Acc: 0.6278
 Site-MNIST_M                       | Train Loss: 1.5914 | Train Acc: 0.4555
 Site-MNIST_M                       | Train Loss: 1.6005 | Train Acc: 0.4538
 Site-SVHN                          | Train Loss: 1.8204 | Train Acc: 0.3531
 Site-SVHN                          | Train Loss: 1.7219 | Train Acc: 0.4063
Average Train Accuracy: 0.6295
 Site-MNIST                         | Val  Loss: 0.6325 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.6160 | Val  Acc: 0.8453
 Site-USPS                          | Val  Loss: 0.6437 | Val  Acc: 0.8370
 Site-USPS                          | Val  Loss: 0.5404 | Val  Acc: 0.8453
 Site-SynthDigits                   | Val  Loss: 1.2090 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.2527 | Val  Acc: 0.6079
 Site-MNIST_M                       | Val  Loss: 1.6070 | Val  Acc: 0.4130
 Site-MNIST_M                       | Val  Loss: 1.5253 | Val  Acc: 0.4820
 Site-SVHN                          | Val  Loss: 1.6606 | Val  Acc: 0.4022
 Site-SVHN                          | Val  Loss: 1.7303 | Val  Acc: 0.3849
Average Valid Accuracy: 0.6307
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8478
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8453
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8370
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8453
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.6079
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.4130
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.4820
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.4022
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.3849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 0.4676 | Train Acc: 0.8652
 Site-MNIST                         | Train Loss: 0.5544 | Train Acc: 0.8404
 Site-USPS                          | Train Loss: 0.4111 | Train Acc: 0.8922
 Site-USPS                          | Train Loss: 0.4079 | Train Acc: 0.8978
 Site-SynthDigits                   | Train Loss: 1.2647 | Train Acc: 0.5930
 Site-SynthDigits                   | Train Loss: 1.1118 | Train Acc: 0.6439
 Site-MNIST_M                       | Train Loss: 1.5063 | Train Acc: 0.4798
 Site-MNIST_M                       | Train Loss: 1.5250 | Train Acc: 0.4897
 Site-SVHN                          | Train Loss: 1.7838 | Train Acc: 0.3881
 Site-SVHN                          | Train Loss: 1.6515 | Train Acc: 0.4332
Average Train Accuracy: 0.6523
 Site-MNIST                         | Val  Loss: 0.5343 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.5295 | Val  Acc: 0.8561
 Site-USPS                          | Val  Loss: 0.5887 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.4674 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 1.1098 | Val  Acc: 0.6739
 Site-SynthDigits                   | Val  Loss: 1.1830 | Val  Acc: 0.6151
 Site-MNIST_M                       | Val  Loss: 1.5114 | Val  Acc: 0.4565
 Site-MNIST_M                       | Val  Loss: 1.4386 | Val  Acc: 0.5036
 Site-SVHN                          | Val  Loss: 1.5607 | Val  Acc: 0.4674
 Site-SVHN                          | Val  Loss: 1.6736 | Val  Acc: 0.4281
Average Valid Accuracy: 0.6542
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8478
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8561
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8669
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.6739
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.6151
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.4565
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.5036
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.4674
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.4281
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 0.4150 | Train Acc: 0.8733
 Site-MNIST                         | Train Loss: 0.4756 | Train Acc: 0.8583
 Site-USPS                          | Train Loss: 0.3869 | Train Acc: 0.9003
 Site-USPS                          | Train Loss: 0.3731 | Train Acc: 0.8987
 Site-SynthDigits                   | Train Loss: 1.2225 | Train Acc: 0.6065
 Site-SynthDigits                   | Train Loss: 1.0740 | Train Acc: 0.6583
 Site-MNIST_M                       | Train Loss: 1.4241 | Train Acc: 0.5229
 Site-MNIST_M                       | Train Loss: 1.4362 | Train Acc: 0.5166
 Site-SVHN                          | Train Loss: 1.7362 | Train Acc: 0.4232
 Site-SVHN                          | Train Loss: 1.5836 | Train Acc: 0.4556
Average Train Accuracy: 0.6714
 Site-MNIST                         | Val  Loss: 0.4517 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.4629 | Val  Acc: 0.8597
 Site-USPS                          | Val  Loss: 0.5580 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.4294 | Val  Acc: 0.8633
 Site-SynthDigits                   | Val  Loss: 1.0976 | Val  Acc: 0.6739
 Site-SynthDigits                   | Val  Loss: 1.1374 | Val  Acc: 0.6475
 Site-MNIST_M                       | Val  Loss: 1.4106 | Val  Acc: 0.5109
 Site-MNIST_M                       | Val  Loss: 1.3693 | Val  Acc: 0.5396
 Site-SVHN                          | Val  Loss: 1.4803 | Val  Acc: 0.4783
 Site-SVHN                          | Val  Loss: 1.6168 | Val  Acc: 0.4388
Average Valid Accuracy: 0.6697
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8587
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8597
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8633
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.6739
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.6475
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.5109
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.5396
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.4783
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.4388
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.3668 | Train Acc: 0.8922
 Site-MNIST                         | Train Loss: 0.4418 | Train Acc: 0.8735
 Site-USPS                          | Train Loss: 0.3505 | Train Acc: 0.9137
 Site-USPS                          | Train Loss: 0.3356 | Train Acc: 0.9094
 Site-SynthDigits                   | Train Loss: 1.1167 | Train Acc: 0.6496
 Site-SynthDigits                   | Train Loss: 0.9770 | Train Acc: 0.6852
 Site-MNIST_M                       | Train Loss: 1.4203 | Train Acc: 0.4987
 Site-MNIST_M                       | Train Loss: 1.3984 | Train Acc: 0.5390
 Site-SVHN                          | Train Loss: 1.6823 | Train Acc: 0.4420
 Site-SVHN                          | Train Loss: 1.5521 | Train Acc: 0.4762
Average Train Accuracy: 0.6880
 Site-MNIST                         | Val  Loss: 0.4055 | Val  Acc: 0.9022
 Site-MNIST                         | Val  Loss: 0.4275 | Val  Acc: 0.8921
 Site-USPS                          | Val  Loss: 0.5406 | Val  Acc: 0.8587
 Site-USPS                          | Val  Loss: 0.4081 | Val  Acc: 0.8813
 Site-SynthDigits                   | Val  Loss: 0.9943 | Val  Acc: 0.6848
 Site-SynthDigits                   | Val  Loss: 1.0382 | Val  Acc: 0.6799
 Site-MNIST_M                       | Val  Loss: 1.3606 | Val  Acc: 0.4891
 Site-MNIST_M                       | Val  Loss: 1.3295 | Val  Acc: 0.5432
 Site-SVHN                          | Val  Loss: 1.4262 | Val  Acc: 0.5543
 Site-SVHN                          | Val  Loss: 1.5771 | Val  Acc: 0.5036
Average Valid Accuracy: 0.6989
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9022
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8921
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8587
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8813
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.6848
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.6799
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.4891
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.5432
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.5543
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.5036
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.3441 | Train Acc: 0.9137
 Site-MNIST                         | Train Loss: 0.3871 | Train Acc: 0.8888
 Site-USPS                          | Train Loss: 0.3159 | Train Acc: 0.9164
 Site-USPS                          | Train Loss: 0.2995 | Train Acc: 0.9291
 Site-SynthDigits                   | Train Loss: 1.1132 | Train Acc: 0.6361
 Site-SynthDigits                   | Train Loss: 0.9318 | Train Acc: 0.6861
 Site-MNIST_M                       | Train Loss: 1.3774 | Train Acc: 0.5202
 Site-MNIST_M                       | Train Loss: 1.3362 | Train Acc: 0.5489
 Site-SVHN                          | Train Loss: 1.6763 | Train Acc: 0.4286
 Site-SVHN                          | Train Loss: 1.5474 | Train Acc: 0.4753
Average Train Accuracy: 0.6943
 Site-MNIST                         | Val  Loss: 0.3439 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.3755 | Val  Acc: 0.8993
 Site-USPS                          | Val  Loss: 0.4992 | Val  Acc: 0.8696
 Site-USPS                          | Val  Loss: 0.3672 | Val  Acc: 0.9065
 Site-SynthDigits                   | Val  Loss: 0.9885 | Val  Acc: 0.6957
 Site-SynthDigits                   | Val  Loss: 1.0354 | Val  Acc: 0.6655
 Site-MNIST_M                       | Val  Loss: 1.2971 | Val  Acc: 0.5326
 Site-MNIST_M                       | Val  Loss: 1.2720 | Val  Acc: 0.5468
 Site-SVHN                          | Val  Loss: 1.4358 | Val  Acc: 0.5217
 Site-SVHN                          | Val  Loss: 1.5693 | Val  Acc: 0.4820
Average Valid Accuracy: 0.7011
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8913
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8993
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8696
 Best site-USPS                      | Epoch:7 | Val Acc: 0.9065
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.6957
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.6655
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.5326
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.5468
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.5217
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.4820
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.3243 | Train Acc: 0.9164
 Site-MNIST                         | Train Loss: 0.3616 | Train Acc: 0.8951
 Site-USPS                          | Train Loss: 0.3178 | Train Acc: 0.9111
 Site-USPS                          | Train Loss: 0.2861 | Train Acc: 0.9202
 Site-SynthDigits                   | Train Loss: 1.0784 | Train Acc: 0.6388
 Site-SynthDigits                   | Train Loss: 0.9176 | Train Acc: 0.7058
 Site-MNIST_M                       | Train Loss: 1.3127 | Train Acc: 0.5499
 Site-MNIST_M                       | Train Loss: 1.2852 | Train Acc: 0.5749
 Site-SVHN                          | Train Loss: 1.6485 | Train Acc: 0.4340
 Site-SVHN                          | Train Loss: 1.5022 | Train Acc: 0.4942
Average Train Accuracy: 0.7040
 Site-MNIST                         | Val  Loss: 0.3193 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.3441 | Val  Acc: 0.9101
 Site-USPS                          | Val  Loss: 0.5044 | Val  Acc: 0.8370
 Site-USPS                          | Val  Loss: 0.3597 | Val  Acc: 0.8885
 Site-SynthDigits                   | Val  Loss: 0.9679 | Val  Acc: 0.7065
 Site-SynthDigits                   | Val  Loss: 0.9916 | Val  Acc: 0.6835
 Site-MNIST_M                       | Val  Loss: 1.2393 | Val  Acc: 0.5543
 Site-MNIST_M                       | Val  Loss: 1.2225 | Val  Acc: 0.5827
 Site-SVHN                          | Val  Loss: 1.3791 | Val  Acc: 0.5326
 Site-SVHN                          | Val  Loss: 1.5355 | Val  Acc: 0.4928
Average Valid Accuracy: 0.7101
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9101
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8370
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8885
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.7065
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.6835
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.5543
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.5827
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.5326
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.4928
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.2948 | Train Acc: 0.9218
 Site-MNIST                         | Train Loss: 0.3553 | Train Acc: 0.8978
 Site-USPS                          | Train Loss: 0.2962 | Train Acc: 0.9164
 Site-USPS                          | Train Loss: 0.2720 | Train Acc: 0.9211
 Site-SynthDigits                   | Train Loss: 1.0425 | Train Acc: 0.6496
 Site-SynthDigits                   | Train Loss: 0.8803 | Train Acc: 0.7175
 Site-MNIST_M                       | Train Loss: 1.2848 | Train Acc: 0.5714
 Site-MNIST_M                       | Train Loss: 1.2339 | Train Acc: 0.5857
 Site-SVHN                          | Train Loss: 1.5948 | Train Acc: 0.4528
 Site-SVHN                          | Train Loss: 1.4408 | Train Acc: 0.5031
Average Train Accuracy: 0.7137
 Site-MNIST                         | Val  Loss: 0.3240 | Val  Acc: 0.9022
 Site-MNIST                         | Val  Loss: 0.3396 | Val  Acc: 0.9101
 Site-USPS                          | Val  Loss: 0.4841 | Val  Acc: 0.8587
 Site-USPS                          | Val  Loss: 0.3475 | Val  Acc: 0.8957
 Site-SynthDigits                   | Val  Loss: 0.9010 | Val  Acc: 0.7283
 Site-SynthDigits                   | Val  Loss: 0.9457 | Val  Acc: 0.6978
 Site-MNIST_M                       | Val  Loss: 1.2154 | Val  Acc: 0.5761
 Site-MNIST_M                       | Val  Loss: 1.1995 | Val  Acc: 0.6151
 Site-SVHN                          | Val  Loss: 1.3072 | Val  Acc: 0.5761
 Site-SVHN                          | Val  Loss: 1.4615 | Val  Acc: 0.5072
Average Valid Accuracy: 0.7267
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.9022
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.9101
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8587
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8957
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.7283
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.6978
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.5761
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.6151
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.5761
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.5072
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.2863 | Train Acc: 0.9218
 Site-MNIST                         | Train Loss: 0.3149 | Train Acc: 0.9103
 Site-USPS                          | Train Loss: 0.2545 | Train Acc: 0.9407
 Site-USPS                          | Train Loss: 0.2319 | Train Acc: 0.9381
 Site-SynthDigits                   | Train Loss: 1.0344 | Train Acc: 0.6442
 Site-SynthDigits                   | Train Loss: 0.8454 | Train Acc: 0.7247
 Site-MNIST_M                       | Train Loss: 1.2338 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.1660 | Train Acc: 0.6170
 Site-SVHN                          | Train Loss: 1.5987 | Train Acc: 0.4259
 Site-SVHN                          | Train Loss: 1.4293 | Train Acc: 0.5121
Average Train Accuracy: 0.7214
 Site-MNIST                         | Val  Loss: 0.2843 | Val  Acc: 0.9022
 Site-MNIST                         | Val  Loss: 0.3045 | Val  Acc: 0.9137
 Site-USPS                          | Val  Loss: 0.4200 | Val  Acc: 0.8696
 Site-USPS                          | Val  Loss: 0.2961 | Val  Acc: 0.9209
 Site-SynthDigits                   | Val  Loss: 0.8722 | Val  Acc: 0.7391
 Site-SynthDigits                   | Val  Loss: 0.9604 | Val  Acc: 0.6799
 Site-MNIST_M                       | Val  Loss: 1.1531 | Val  Acc: 0.5978
 Site-MNIST_M                       | Val  Loss: 1.1478 | Val  Acc: 0.5863
 Site-SVHN                          | Val  Loss: 1.3119 | Val  Acc: 0.5652
 Site-SVHN                          | Val  Loss: 1.4478 | Val  Acc: 0.5216
Average Valid Accuracy: 0.7296
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9022
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9137
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8696
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9209
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.7391
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.6799
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.5978
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.5863
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.5652
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.5216
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.2647 | Train Acc: 0.9272
 Site-MNIST                         | Train Loss: 0.3024 | Train Acc: 0.9166
 Site-USPS                          | Train Loss: 0.2613 | Train Acc: 0.9299
 Site-USPS                          | Train Loss: 0.2516 | Train Acc: 0.9309
 Site-SynthDigits                   | Train Loss: 0.9631 | Train Acc: 0.6765
 Site-SynthDigits                   | Train Loss: 0.8014 | Train Acc: 0.7516
 Site-MNIST_M                       | Train Loss: 1.2276 | Train Acc: 0.5768
 Site-MNIST_M                       | Train Loss: 1.1522 | Train Acc: 0.6197
 Site-SVHN                          | Train Loss: 1.5433 | Train Acc: 0.4690
 Site-SVHN                          | Train Loss: 1.3566 | Train Acc: 0.5265
Average Train Accuracy: 0.7325
 Site-MNIST                         | Val  Loss: 0.2845 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.3044 | Val  Acc: 0.9029
 Site-USPS                          | Val  Loss: 0.4360 | Val  Acc: 0.8696
 Site-USPS                          | Val  Loss: 0.3143 | Val  Acc: 0.9101
 Site-SynthDigits                   | Val  Loss: 0.7973 | Val  Acc: 0.7500
 Site-SynthDigits                   | Val  Loss: 0.8703 | Val  Acc: 0.7338
 Site-MNIST_M                       | Val  Loss: 1.1498 | Val  Acc: 0.5978
 Site-MNIST_M                       | Val  Loss: 1.1394 | Val  Acc: 0.6079
 Site-SVHN                          | Val  Loss: 1.2470 | Val  Acc: 0.5543
 Site-SVHN                          | Val  Loss: 1.3909 | Val  Acc: 0.5216
Average Valid Accuracy: 0.7361
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9029
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8696
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9101
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.7500
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.7338
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.5978
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.6079
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.5543
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.5216
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.2488 | Train Acc: 0.9353
 Site-MNIST                         | Train Loss: 0.2746 | Train Acc: 0.9247
 Site-USPS                          | Train Loss: 0.2535 | Train Acc: 0.9272
 Site-USPS                          | Train Loss: 0.2313 | Train Acc: 0.9327
 Site-SynthDigits                   | Train Loss: 0.9239 | Train Acc: 0.6792
 Site-SynthDigits                   | Train Loss: 0.7441 | Train Acc: 0.7623
 Site-MNIST_M                       | Train Loss: 1.1850 | Train Acc: 0.5930
 Site-MNIST_M                       | Train Loss: 1.0969 | Train Acc: 0.6377
 Site-SVHN                          | Train Loss: 1.5455 | Train Acc: 0.4798
 Site-SVHN                          | Train Loss: 1.3396 | Train Acc: 0.5265
Average Train Accuracy: 0.7398
 Site-MNIST                         | Val  Loss: 0.2555 | Val  Acc: 0.9239
 Site-MNIST                         | Val  Loss: 0.2740 | Val  Acc: 0.9137
 Site-USPS                          | Val  Loss: 0.4344 | Val  Acc: 0.8696
 Site-USPS                          | Val  Loss: 0.3014 | Val  Acc: 0.9065
 Site-SynthDigits                   | Val  Loss: 0.7498 | Val  Acc: 0.8043
 Site-SynthDigits                   | Val  Loss: 0.8297 | Val  Acc: 0.7302
 Site-MNIST_M                       | Val  Loss: 1.0915 | Val  Acc: 0.6087
 Site-MNIST_M                       | Val  Loss: 1.0828 | Val  Acc: 0.6187
 Site-SVHN                          | Val  Loss: 1.2211 | Val  Acc: 0.5326
 Site-SVHN                          | Val  Loss: 1.3817 | Val  Acc: 0.5036
Average Valid Accuracy: 0.7412
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9239
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.9137
 Best site-USPS                      | Epoch:12 | Val Acc: 0.8696
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9065
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.8043
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.7302
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.6087
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.6187
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.5326
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.5036
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.2325 | Train Acc: 0.9461
 Site-MNIST                         | Train Loss: 0.2625 | Train Acc: 0.9247
 Site-USPS                          | Train Loss: 0.2361 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.2146 | Train Acc: 0.9399
 Site-SynthDigits                   | Train Loss: 0.9303 | Train Acc: 0.6954
 Site-SynthDigits                   | Train Loss: 0.7369 | Train Acc: 0.7731
 Site-MNIST_M                       | Train Loss: 1.1805 | Train Acc: 0.5876
 Site-MNIST_M                       | Train Loss: 1.0890 | Train Acc: 0.6439
 Site-SVHN                          | Train Loss: 1.5451 | Train Acc: 0.4717
 Site-SVHN                          | Train Loss: 1.3277 | Train Acc: 0.5381
Average Train Accuracy: 0.7459
 Site-MNIST                         | Val  Loss: 0.2587 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.2665 | Val  Acc: 0.9245
 Site-USPS                          | Val  Loss: 0.4076 | Val  Acc: 0.8696
 Site-USPS                          | Val  Loss: 0.2872 | Val  Acc: 0.9137
 Site-SynthDigits                   | Val  Loss: 0.7549 | Val  Acc: 0.7826
 Site-SynthDigits                   | Val  Loss: 0.8175 | Val  Acc: 0.7518
 Site-MNIST_M                       | Val  Loss: 1.0795 | Val  Acc: 0.6087
 Site-MNIST_M                       | Val  Loss: 1.0777 | Val  Acc: 0.6259
 Site-SVHN                          | Val  Loss: 1.2125 | Val  Acc: 0.5870
 Site-SVHN                          | Val  Loss: 1.3652 | Val  Acc: 0.5252
Average Valid Accuracy: 0.7502
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9245
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8696
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9137
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.7826
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.7518
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.6087
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.6259
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.5870
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.5252
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.2328 | Train Acc: 0.9434
 Site-MNIST                         | Train Loss: 0.2502 | Train Acc: 0.9256
 Site-USPS                          | Train Loss: 0.2280 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.2050 | Train Acc: 0.9435
 Site-SynthDigits                   | Train Loss: 0.8874 | Train Acc: 0.7116
 Site-SynthDigits                   | Train Loss: 0.7053 | Train Acc: 0.7901
 Site-MNIST_M                       | Train Loss: 1.1371 | Train Acc: 0.6092
 Site-MNIST_M                       | Train Loss: 1.0405 | Train Acc: 0.6520
 Site-SVHN                          | Train Loss: 1.5488 | Train Acc: 0.4663
 Site-SVHN                          | Train Loss: 1.3236 | Train Acc: 0.5372
Average Train Accuracy: 0.7517
 Site-MNIST                         | Val  Loss: 0.2344 | Val  Acc: 0.9239
 Site-MNIST                         | Val  Loss: 0.2521 | Val  Acc: 0.9245
 Site-USPS                          | Val  Loss: 0.3893 | Val  Acc: 0.8804
 Site-USPS                          | Val  Loss: 0.2681 | Val  Acc: 0.9173
 Site-SynthDigits                   | Val  Loss: 0.7118 | Val  Acc: 0.8043
 Site-SynthDigits                   | Val  Loss: 0.7919 | Val  Acc: 0.7626
 Site-MNIST_M                       | Val  Loss: 1.0259 | Val  Acc: 0.6522
 Site-MNIST_M                       | Val  Loss: 1.0247 | Val  Acc: 0.6655
 Site-SVHN                          | Val  Loss: 1.2095 | Val  Acc: 0.5326
 Site-SVHN                          | Val  Loss: 1.3653 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7563
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9239
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9245
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8804
 Best site-USPS                      | Epoch:14 | Val Acc: 0.9173
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.8043
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.7626
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.6522
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.6655
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.5326
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.2220 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.2377 | Train Acc: 0.9247
 Site-USPS                          | Train Loss: 0.2333 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.2034 | Train Acc: 0.9426
 Site-SynthDigits                   | Train Loss: 0.8757 | Train Acc: 0.7089
 Site-SynthDigits                   | Train Loss: 0.6896 | Train Acc: 0.7848
 Site-MNIST_M                       | Train Loss: 1.0949 | Train Acc: 0.6092
 Site-MNIST_M                       | Train Loss: 0.9996 | Train Acc: 0.6798
 Site-SVHN                          | Train Loss: 1.5234 | Train Acc: 0.4771
 Site-SVHN                          | Train Loss: 1.2822 | Train Acc: 0.5507
Average Train Accuracy: 0.7567
 Site-MNIST                         | Val  Loss: 0.2191 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.2350 | Val  Acc: 0.9317
 Site-USPS                          | Val  Loss: 0.3863 | Val  Acc: 0.8913
 Site-USPS                          | Val  Loss: 0.2590 | Val  Acc: 0.9281
 Site-SynthDigits                   | Val  Loss: 0.6979 | Val  Acc: 0.8043
 Site-SynthDigits                   | Val  Loss: 0.7792 | Val  Acc: 0.7518
 Site-MNIST_M                       | Val  Loss: 0.9762 | Val  Acc: 0.6957
 Site-MNIST_M                       | Val  Loss: 0.9808 | Val  Acc: 0.6727
 Site-SVHN                          | Val  Loss: 1.1546 | Val  Acc: 0.5543
 Site-SVHN                          | Val  Loss: 1.3306 | Val  Acc: 0.5252
Average Valid Accuracy: 0.7668
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.9317
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8913
 Best site-USPS                      | Epoch:15 | Val Acc: 0.9281
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.8043
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.7518
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.6957
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.6727
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.5543
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.5252
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.2137 | Train Acc: 0.9488
 Site-MNIST                         | Train Loss: 0.2282 | Train Acc: 0.9363
 Site-USPS                          | Train Loss: 0.2257 | Train Acc: 0.9407
 Site-USPS                          | Train Loss: 0.1921 | Train Acc: 0.9435
 Site-SynthDigits                   | Train Loss: 0.8704 | Train Acc: 0.7008
 Site-SynthDigits                   | Train Loss: 0.6838 | Train Acc: 0.7892
 Site-MNIST_M                       | Train Loss: 1.0665 | Train Acc: 0.6092
 Site-MNIST_M                       | Train Loss: 0.9519 | Train Acc: 0.6852
 Site-SVHN                          | Train Loss: 1.4963 | Train Acc: 0.4771
 Site-SVHN                          | Train Loss: 1.2615 | Train Acc: 0.5605
Average Train Accuracy: 0.7591
 Site-MNIST                         | Val  Loss: 0.2361 | Val  Acc: 0.9022
 Site-MNIST                         | Val  Loss: 0.2309 | Val  Acc: 0.9245
 Site-USPS                          | Val  Loss: 0.3733 | Val  Acc: 0.8804
 Site-USPS                          | Val  Loss: 0.2507 | Val  Acc: 0.9245
 Site-SynthDigits                   | Val  Loss: 0.6891 | Val  Acc: 0.8043
 Site-SynthDigits                   | Val  Loss: 0.7651 | Val  Acc: 0.7626
 Site-MNIST_M                       | Val  Loss: 0.9434 | Val  Acc: 0.6739
 Site-MNIST_M                       | Val  Loss: 0.9519 | Val  Acc: 0.6691
 Site-SVHN                          | Val  Loss: 1.1478 | Val  Acc: 0.5978
 Site-SVHN                          | Val  Loss: 1.2894 | Val  Acc: 0.5396
Average Valid Accuracy: 0.7679
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9022
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9245
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8804
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9245
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.8043
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.7626
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.6739
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.6691
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.5978
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.5396
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.2017 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.2228 | Train Acc: 0.9408
 Site-USPS                          | Train Loss: 0.2165 | Train Acc: 0.9326
 Site-USPS                          | Train Loss: 0.1952 | Train Acc: 0.9444
 Site-SynthDigits                   | Train Loss: 0.8448 | Train Acc: 0.7143
 Site-SynthDigits                   | Train Loss: 0.6403 | Train Acc: 0.8045
 Site-MNIST_M                       | Train Loss: 1.0635 | Train Acc: 0.6307
 Site-MNIST_M                       | Train Loss: 0.9411 | Train Acc: 0.6861
 Site-SVHN                          | Train Loss: 1.4825 | Train Acc: 0.4879
 Site-SVHN                          | Train Loss: 1.2306 | Train Acc: 0.5740
Average Train Accuracy: 0.7667
 Site-MNIST                         | Val  Loss: 0.2274 | Val  Acc: 0.9348
 Site-MNIST                         | Val  Loss: 0.2266 | Val  Acc: 0.9460
 Site-USPS                          | Val  Loss: 0.3855 | Val  Acc: 0.8696
 Site-USPS                          | Val  Loss: 0.2569 | Val  Acc: 0.9137
 Site-SynthDigits                   | Val  Loss: 0.6380 | Val  Acc: 0.8043
 Site-SynthDigits                   | Val  Loss: 0.7207 | Val  Acc: 0.7626
 Site-MNIST_M                       | Val  Loss: 0.9309 | Val  Acc: 0.7065
 Site-MNIST_M                       | Val  Loss: 0.9478 | Val  Acc: 0.6906
 Site-SVHN                          | Val  Loss: 1.0924 | Val  Acc: 0.6196
 Site-SVHN                          | Val  Loss: 1.2677 | Val  Acc: 0.5612
Average Valid Accuracy: 0.7809
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9348
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9460
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8696
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9137
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.8043
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.7626
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.7065
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.6906
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.6196
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.5612
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.1997 | Train Acc: 0.9461
 Site-MNIST                         | Train Loss: 0.2123 | Train Acc: 0.9462
 Site-USPS                          | Train Loss: 0.2067 | Train Acc: 0.9515
 Site-USPS                          | Train Loss: 0.1757 | Train Acc: 0.9543
 Site-SynthDigits                   | Train Loss: 0.8358 | Train Acc: 0.7143
 Site-SynthDigits                   | Train Loss: 0.6298 | Train Acc: 0.8009
 Site-MNIST_M                       | Train Loss: 1.0385 | Train Acc: 0.6415
 Site-MNIST_M                       | Train Loss: 0.9035 | Train Acc: 0.7076
 Site-SVHN                          | Train Loss: 1.4995 | Train Acc: 0.4879
 Site-SVHN                          | Train Loss: 1.2425 | Train Acc: 0.5704
Average Train Accuracy: 0.7721
 Site-MNIST                         | Val  Loss: 0.2085 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.2148 | Val  Acc: 0.9496
 Site-USPS                          | Val  Loss: 0.3462 | Val  Acc: 0.8913
 Site-USPS                          | Val  Loss: 0.2315 | Val  Acc: 0.9353
 Site-SynthDigits                   | Val  Loss: 0.6516 | Val  Acc: 0.8043
 Site-SynthDigits                   | Val  Loss: 0.7216 | Val  Acc: 0.7626
 Site-MNIST_M                       | Val  Loss: 0.8774 | Val  Acc: 0.7609
 Site-MNIST_M                       | Val  Loss: 0.9065 | Val  Acc: 0.7050
 Site-SVHN                          | Val  Loss: 1.0964 | Val  Acc: 0.5652
 Site-SVHN                          | Val  Loss: 1.2747 | Val  Acc: 0.5468
Average Valid Accuracy: 0.7867
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9457
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9496
 Best site-USPS                      | Epoch:18 | Val Acc: 0.8913
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9353
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.8043
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.7626
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.7609
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.7050
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.5652
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.5468
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.1955 | Train Acc: 0.9488
 Site-MNIST                         | Train Loss: 0.2149 | Train Acc: 0.9426
 Site-USPS                          | Train Loss: 0.2025 | Train Acc: 0.9515
 Site-USPS                          | Train Loss: 0.1741 | Train Acc: 0.9507
 Site-SynthDigits                   | Train Loss: 0.8034 | Train Acc: 0.7224
 Site-SynthDigits                   | Train Loss: 0.6108 | Train Acc: 0.8081
 Site-MNIST_M                       | Train Loss: 1.0122 | Train Acc: 0.6685
 Site-MNIST_M                       | Train Loss: 0.8853 | Train Acc: 0.7256
 Site-SVHN                          | Train Loss: 1.4804 | Train Acc: 0.4933
 Site-SVHN                          | Train Loss: 1.1891 | Train Acc: 0.5874
Average Train Accuracy: 0.7799
 Site-MNIST                         | Val  Loss: 0.2195 | Val  Acc: 0.9239
 Site-MNIST                         | Val  Loss: 0.2200 | Val  Acc: 0.9424
 Site-USPS                          | Val  Loss: 0.3548 | Val  Acc: 0.8587
 Site-USPS                          | Val  Loss: 0.2313 | Val  Acc: 0.9209
 Site-SynthDigits                   | Val  Loss: 0.6381 | Val  Acc: 0.7935
 Site-SynthDigits                   | Val  Loss: 0.7102 | Val  Acc: 0.7662
 Site-MNIST_M                       | Val  Loss: 0.8800 | Val  Acc: 0.7609
 Site-MNIST_M                       | Val  Loss: 0.8908 | Val  Acc: 0.7158
 Site-SVHN                          | Val  Loss: 1.0949 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.2432 | Val  Acc: 0.5827
Average Valid Accuracy: 0.7874
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9239
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9424
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8587
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9209
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.7935
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.7662
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.7609
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.7158
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.6087
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.5827
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.1871 | Train Acc: 0.9461
 Site-MNIST                         | Train Loss: 0.2053 | Train Acc: 0.9453
 Site-USPS                          | Train Loss: 0.1991 | Train Acc: 0.9461
 Site-USPS                          | Train Loss: 0.1757 | Train Acc: 0.9570
 Site-SynthDigits                   | Train Loss: 0.7883 | Train Acc: 0.7358
 Site-SynthDigits                   | Train Loss: 0.5955 | Train Acc: 0.8152
 Site-MNIST_M                       | Train Loss: 1.0037 | Train Acc: 0.6577
 Site-MNIST_M                       | Train Loss: 0.8606 | Train Acc: 0.7247
 Site-SVHN                          | Train Loss: 1.4581 | Train Acc: 0.5094
 Site-SVHN                          | Train Loss: 1.1743 | Train Acc: 0.5964
Average Train Accuracy: 0.7834
 Site-MNIST                         | Val  Loss: 0.2069 | Val  Acc: 0.9348
 Site-MNIST                         | Val  Loss: 0.2118 | Val  Acc: 0.9424
 Site-USPS                          | Val  Loss: 0.3220 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.2272 | Val  Acc: 0.9388
 Site-SynthDigits                   | Val  Loss: 0.6286 | Val  Acc: 0.8152
 Site-SynthDigits                   | Val  Loss: 0.6859 | Val  Acc: 0.7914
 Site-MNIST_M                       | Val  Loss: 0.8598 | Val  Acc: 0.7609
 Site-MNIST_M                       | Val  Loss: 0.8707 | Val  Acc: 0.7122
 Site-SVHN                          | Val  Loss: 1.0582 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.2236 | Val  Acc: 0.5755
Average Valid Accuracy: 0.7993
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9348
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.9424
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9130
 Best site-USPS                      | Epoch:20 | Val Acc: 0.9388
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.8152
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.7914
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.7609
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.7122
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.6087
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.5755
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.1878 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1970 | Train Acc: 0.9426
 Site-USPS                          | Train Loss: 0.1884 | Train Acc: 0.9488
 Site-USPS                          | Train Loss: 0.1653 | Train Acc: 0.9578
 Site-SynthDigits                   | Train Loss: 0.7884 | Train Acc: 0.7062
 Site-SynthDigits                   | Train Loss: 0.5921 | Train Acc: 0.8206
 Site-MNIST_M                       | Train Loss: 1.0067 | Train Acc: 0.6658
 Site-MNIST_M                       | Train Loss: 0.8480 | Train Acc: 0.7363
 Site-SVHN                          | Train Loss: 1.4734 | Train Acc: 0.5013
 Site-SVHN                          | Train Loss: 1.1692 | Train Acc: 0.5928
Average Train Accuracy: 0.7824
 Site-MNIST                         | Val  Loss: 0.2021 | Val  Acc: 0.9239
 Site-MNIST                         | Val  Loss: 0.2062 | Val  Acc: 0.9388
 Site-USPS                          | Val  Loss: 0.3135 | Val  Acc: 0.9022
 Site-USPS                          | Val  Loss: 0.2221 | Val  Acc: 0.9281
 Site-SynthDigits                   | Val  Loss: 0.6327 | Val  Acc: 0.8152
 Site-SynthDigits                   | Val  Loss: 0.6961 | Val  Acc: 0.7662
 Site-MNIST_M                       | Val  Loss: 0.8293 | Val  Acc: 0.7717
 Site-MNIST_M                       | Val  Loss: 0.8652 | Val  Acc: 0.7122
 Site-SVHN                          | Val  Loss: 1.0599 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.2138 | Val  Acc: 0.5791
Average Valid Accuracy: 0.7946
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.1912 | Train Acc: 0.9434
 Site-MNIST                         | Train Loss: 0.2049 | Train Acc: 0.9381
 Site-USPS                          | Train Loss: 0.1875 | Train Acc: 0.9515
 Site-USPS                          | Train Loss: 0.1670 | Train Acc: 0.9570
 Site-SynthDigits                   | Train Loss: 0.7535 | Train Acc: 0.7305
 Site-SynthDigits                   | Train Loss: 0.5753 | Train Acc: 0.8278
 Site-MNIST_M                       | Train Loss: 0.9971 | Train Acc: 0.6550
 Site-MNIST_M                       | Train Loss: 0.8129 | Train Acc: 0.7417
 Site-SVHN                          | Train Loss: 1.4594 | Train Acc: 0.4987
 Site-SVHN                          | Train Loss: 1.1738 | Train Acc: 0.6072
Average Train Accuracy: 0.7851
 Site-MNIST                         | Val  Loss: 0.1896 | Val  Acc: 0.9348
 Site-MNIST                         | Val  Loss: 0.2025 | Val  Acc: 0.9424
 Site-USPS                          | Val  Loss: 0.3214 | Val  Acc: 0.9022
 Site-USPS                          | Val  Loss: 0.2099 | Val  Acc: 0.9388
 Site-SynthDigits                   | Val  Loss: 0.6035 | Val  Acc: 0.8043
 Site-SynthDigits                   | Val  Loss: 0.6664 | Val  Acc: 0.7806
 Site-MNIST_M                       | Val  Loss: 0.8146 | Val  Acc: 0.7717
 Site-MNIST_M                       | Val  Loss: 0.8506 | Val  Acc: 0.7158
 Site-SVHN                          | Val  Loss: 1.0589 | Val  Acc: 0.6413
 Site-SVHN                          | Val  Loss: 1.2216 | Val  Acc: 0.5899
Average Valid Accuracy: 0.8022
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9348
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9424
 Best site-USPS                      | Epoch:22 | Val Acc: 0.9022
 Best site-USPS                      | Epoch:22 | Val Acc: 0.9388
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.8043
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.7806
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.7717
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.7158
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.6413
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.5899
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.1759 | Train Acc: 0.9569
 Site-MNIST                         | Train Loss: 0.2010 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.1835 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.1516 | Train Acc: 0.9605
 Site-SynthDigits                   | Train Loss: 0.7692 | Train Acc: 0.7332
 Site-SynthDigits                   | Train Loss: 0.5672 | Train Acc: 0.8341
 Site-MNIST_M                       | Train Loss: 0.9917 | Train Acc: 0.6631
 Site-MNIST_M                       | Train Loss: 0.8224 | Train Acc: 0.7372
 Site-SVHN                          | Train Loss: 1.4407 | Train Acc: 0.4933
 Site-SVHN                          | Train Loss: 1.1454 | Train Acc: 0.6009
Average Train Accuracy: 0.7873
 Site-MNIST                         | Val  Loss: 0.1958 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.2032 | Val  Acc: 0.9317
 Site-USPS                          | Val  Loss: 0.2985 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.2065 | Val  Acc: 0.9317
 Site-SynthDigits                   | Val  Loss: 0.5822 | Val  Acc: 0.8261
 Site-SynthDigits                   | Val  Loss: 0.6516 | Val  Acc: 0.7878
 Site-MNIST_M                       | Val  Loss: 0.8499 | Val  Acc: 0.7935
 Site-MNIST_M                       | Val  Loss: 0.8472 | Val  Acc: 0.7338
 Site-SVHN                          | Val  Loss: 1.0498 | Val  Acc: 0.6522
 Site-SVHN                          | Val  Loss: 1.2097 | Val  Acc: 0.5935
Average Valid Accuracy: 0.8076
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9130
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9317
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9130
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9317
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.8261
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.7878
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.7935
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.7338
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.6522
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.5935
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.1717 | Train Acc: 0.9569
 Site-MNIST                         | Train Loss: 0.1803 | Train Acc: 0.9498
 Site-USPS                          | Train Loss: 0.1849 | Train Acc: 0.9569
 Site-USPS                          | Train Loss: 0.1448 | Train Acc: 0.9641
 Site-SynthDigits                   | Train Loss: 0.7655 | Train Acc: 0.7385
 Site-SynthDigits                   | Train Loss: 0.5705 | Train Acc: 0.8305
 Site-MNIST_M                       | Train Loss: 0.9531 | Train Acc: 0.6631
 Site-MNIST_M                       | Train Loss: 0.7736 | Train Acc: 0.7570
 Site-SVHN                          | Train Loss: 1.4189 | Train Acc: 0.5013
 Site-SVHN                          | Train Loss: 1.1350 | Train Acc: 0.6126
Average Train Accuracy: 0.7931
 Site-MNIST                         | Val  Loss: 0.1852 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.1836 | Val  Acc: 0.9353
 Site-USPS                          | Val  Loss: 0.2960 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1930 | Val  Acc: 0.9424
 Site-SynthDigits                   | Val  Loss: 0.6006 | Val  Acc: 0.8370
 Site-SynthDigits                   | Val  Loss: 0.6566 | Val  Acc: 0.7914
 Site-MNIST_M                       | Val  Loss: 0.7899 | Val  Acc: 0.7717
 Site-MNIST_M                       | Val  Loss: 0.7966 | Val  Acc: 0.7158
 Site-SVHN                          | Val  Loss: 1.0348 | Val  Acc: 0.6630
 Site-SVHN                          | Val  Loss: 1.1845 | Val  Acc: 0.5935
Average Valid Accuracy: 0.8076
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.1684 | Train Acc: 0.9488
 Site-MNIST                         | Train Loss: 0.1722 | Train Acc: 0.9561
 Site-USPS                          | Train Loss: 0.1860 | Train Acc: 0.9569
 Site-USPS                          | Train Loss: 0.1423 | Train Acc: 0.9614
 Site-SynthDigits                   | Train Loss: 0.7462 | Train Acc: 0.7358
 Site-SynthDigits                   | Train Loss: 0.5486 | Train Acc: 0.8404
 Site-MNIST_M                       | Train Loss: 0.9421 | Train Acc: 0.6631
 Site-MNIST_M                       | Train Loss: 0.7623 | Train Acc: 0.7578
 Site-SVHN                          | Train Loss: 1.4285 | Train Acc: 0.5121
 Site-SVHN                          | Train Loss: 1.1302 | Train Acc: 0.6108
Average Train Accuracy: 0.7943
 Site-MNIST                         | Val  Loss: 0.1746 | Val  Acc: 0.9239
 Site-MNIST                         | Val  Loss: 0.1782 | Val  Acc: 0.9424
 Site-USPS                          | Val  Loss: 0.2812 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1889 | Val  Acc: 0.9424
 Site-SynthDigits                   | Val  Loss: 0.5905 | Val  Acc: 0.8043
 Site-SynthDigits                   | Val  Loss: 0.6468 | Val  Acc: 0.7842
 Site-MNIST_M                       | Val  Loss: 0.7746 | Val  Acc: 0.7826
 Site-MNIST_M                       | Val  Loss: 0.7825 | Val  Acc: 0.7266
 Site-SVHN                          | Val  Loss: 1.0291 | Val  Acc: 0.6522
 Site-SVHN                          | Val  Loss: 1.1820 | Val  Acc: 0.5935
Average Valid Accuracy: 0.8076
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.1780 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1772 | Train Acc: 0.9489
 Site-USPS                          | Train Loss: 0.1798 | Train Acc: 0.9542
 Site-USPS                          | Train Loss: 0.1424 | Train Acc: 0.9632
 Site-SynthDigits                   | Train Loss: 0.7293 | Train Acc: 0.7520
 Site-SynthDigits                   | Train Loss: 0.5412 | Train Acc: 0.8413
 Site-MNIST_M                       | Train Loss: 0.9343 | Train Acc: 0.6685
 Site-MNIST_M                       | Train Loss: 0.7563 | Train Acc: 0.7632
 Site-SVHN                          | Train Loss: 1.4181 | Train Acc: 0.5256
 Site-SVHN                          | Train Loss: 1.1210 | Train Acc: 0.6143
Average Train Accuracy: 0.7983
 Site-MNIST                         | Val  Loss: 0.1675 | Val  Acc: 0.9348
 Site-MNIST                         | Val  Loss: 0.1798 | Val  Acc: 0.9532
 Site-USPS                          | Val  Loss: 0.2750 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1787 | Val  Acc: 0.9460
 Site-SynthDigits                   | Val  Loss: 0.5632 | Val  Acc: 0.8261
 Site-SynthDigits                   | Val  Loss: 0.6236 | Val  Acc: 0.7950
 Site-MNIST_M                       | Val  Loss: 0.7443 | Val  Acc: 0.7935
 Site-MNIST_M                       | Val  Loss: 0.7718 | Val  Acc: 0.7410
 Site-SVHN                          | Val  Loss: 1.0014 | Val  Acc: 0.6522
 Site-SVHN                          | Val  Loss: 1.1671 | Val  Acc: 0.6007
Average Valid Accuracy: 0.8156
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9348
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.9532
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9130
 Best site-USPS                      | Epoch:26 | Val Acc: 0.9460
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.8261
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.7950
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.7935
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.7410
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.6522
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.6007
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.1537 | Train Acc: 0.9569
 Site-MNIST                         | Train Loss: 0.1619 | Train Acc: 0.9561
 Site-USPS                          | Train Loss: 0.1746 | Train Acc: 0.9515
 Site-USPS                          | Train Loss: 0.1444 | Train Acc: 0.9632
 Site-SynthDigits                   | Train Loss: 0.7261 | Train Acc: 0.7466
 Site-SynthDigits                   | Train Loss: 0.5338 | Train Acc: 0.8466
 Site-MNIST_M                       | Train Loss: 0.9351 | Train Acc: 0.6819
 Site-MNIST_M                       | Train Loss: 0.7351 | Train Acc: 0.7587
 Site-SVHN                          | Train Loss: 1.3825 | Train Acc: 0.5175
 Site-SVHN                          | Train Loss: 1.0911 | Train Acc: 0.6287
Average Train Accuracy: 0.8008
 Site-MNIST                         | Val  Loss: 0.1514 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.1627 | Val  Acc: 0.9532
 Site-USPS                          | Val  Loss: 0.2798 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1834 | Val  Acc: 0.9424
 Site-SynthDigits                   | Val  Loss: 0.5544 | Val  Acc: 0.8370
 Site-SynthDigits                   | Val  Loss: 0.6079 | Val  Acc: 0.7986
 Site-MNIST_M                       | Val  Loss: 0.7381 | Val  Acc: 0.7717
 Site-MNIST_M                       | Val  Loss: 0.7652 | Val  Acc: 0.7302
 Site-SVHN                          | Val  Loss: 1.0018 | Val  Acc: 0.6522
 Site-SVHN                          | Val  Loss: 1.1421 | Val  Acc: 0.6007
Average Valid Accuracy: 0.8145
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.1547 | Train Acc: 0.9542
 Site-MNIST                         | Train Loss: 0.1570 | Train Acc: 0.9561
 Site-USPS                          | Train Loss: 0.1684 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.1334 | Train Acc: 0.9659
 Site-SynthDigits                   | Train Loss: 0.7458 | Train Acc: 0.7493
 Site-SynthDigits                   | Train Loss: 0.5274 | Train Acc: 0.8484
 Site-MNIST_M                       | Train Loss: 0.9216 | Train Acc: 0.6712
 Site-MNIST_M                       | Train Loss: 0.7297 | Train Acc: 0.7731
 Site-SVHN                          | Train Loss: 1.4112 | Train Acc: 0.5175
 Site-SVHN                          | Train Loss: 1.0940 | Train Acc: 0.6260
Average Train Accuracy: 0.8021
 Site-MNIST                         | Val  Loss: 0.1444 | Val  Acc: 0.9348
 Site-MNIST                         | Val  Loss: 0.1588 | Val  Acc: 0.9460
 Site-USPS                          | Val  Loss: 0.2631 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1750 | Val  Acc: 0.9496
 Site-SynthDigits                   | Val  Loss: 0.5536 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.6192 | Val  Acc: 0.8022
 Site-MNIST_M                       | Val  Loss: 0.7268 | Val  Acc: 0.8370
 Site-MNIST_M                       | Val  Loss: 0.7425 | Val  Acc: 0.7482
 Site-SVHN                          | Val  Loss: 1.0250 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.1564 | Val  Acc: 0.5935
Average Valid Accuracy: 0.8192
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9348
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.9460
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9130
 Best site-USPS                      | Epoch:28 | Val Acc: 0.9496
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.8587
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.8022
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.8370
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.7482
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.6087
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.5935
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.1446 | Train Acc: 0.9596
 Site-MNIST                         | Train Loss: 0.1547 | Train Acc: 0.9561
 Site-USPS                          | Train Loss: 0.1792 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.1313 | Train Acc: 0.9668
 Site-SynthDigits                   | Train Loss: 0.7179 | Train Acc: 0.7628
 Site-SynthDigits                   | Train Loss: 0.5029 | Train Acc: 0.8502
 Site-MNIST_M                       | Train Loss: 0.9273 | Train Acc: 0.6846
 Site-MNIST_M                       | Train Loss: 0.7133 | Train Acc: 0.7892
 Site-SVHN                          | Train Loss: 1.3879 | Train Acc: 0.5256
 Site-SVHN                          | Train Loss: 1.0713 | Train Acc: 0.6323
Average Train Accuracy: 0.8089
 Site-MNIST                         | Val  Loss: 0.1482 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.1598 | Val  Acc: 0.9424
 Site-USPS                          | Val  Loss: 0.2756 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1740 | Val  Acc: 0.9532
 Site-SynthDigits                   | Val  Loss: 0.5159 | Val  Acc: 0.8478
 Site-SynthDigits                   | Val  Loss: 0.5948 | Val  Acc: 0.7986
 Site-MNIST_M                       | Val  Loss: 0.7263 | Val  Acc: 0.8478
 Site-MNIST_M                       | Val  Loss: 0.7402 | Val  Acc: 0.7698
 Site-SVHN                          | Val  Loss: 0.9887 | Val  Acc: 0.6196
 Site-SVHN                          | Val  Loss: 1.1341 | Val  Acc: 0.6007
Average Valid Accuracy: 0.8250
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9457
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9424
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9239
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9532
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.8478
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.7986
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.8478
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.7698
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.6196
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.6007
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.1619 | Train Acc: 0.9461
 Site-MNIST                         | Train Loss: 0.1606 | Train Acc: 0.9534
 Site-USPS                          | Train Loss: 0.1743 | Train Acc: 0.9488
 Site-USPS                          | Train Loss: 0.1325 | Train Acc: 0.9659
 Site-SynthDigits                   | Train Loss: 0.7104 | Train Acc: 0.7736
 Site-SynthDigits                   | Train Loss: 0.4899 | Train Acc: 0.8637
 Site-MNIST_M                       | Train Loss: 0.9230 | Train Acc: 0.6873
 Site-MNIST_M                       | Train Loss: 0.7068 | Train Acc: 0.7848
 Site-SVHN                          | Train Loss: 1.3895 | Train Acc: 0.5229
 Site-SVHN                          | Train Loss: 1.0755 | Train Acc: 0.6395
Average Train Accuracy: 0.8086
 Site-MNIST                         | Val  Loss: 0.1408 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1632 | Val  Acc: 0.9532
 Site-USPS                          | Val  Loss: 0.2752 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1754 | Val  Acc: 0.9460
 Site-SynthDigits                   | Val  Loss: 0.4915 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.5754 | Val  Acc: 0.8165
 Site-MNIST_M                       | Val  Loss: 0.7021 | Val  Acc: 0.8043
 Site-MNIST_M                       | Val  Loss: 0.7302 | Val  Acc: 0.7626
 Site-SVHN                          | Val  Loss: 0.9782 | Val  Acc: 0.6304
 Site-SVHN                          | Val  Loss: 1.1332 | Val  Acc: 0.5971
Average Valid Accuracy: 0.8260
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9532
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9239
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9460
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.8587
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.8165
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.8043
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.7626
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.6304
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.5971
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.1472 | Train Acc: 0.9542
 Site-MNIST                         | Train Loss: 0.1512 | Train Acc: 0.9570
 Site-USPS                          | Train Loss: 0.1577 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.1282 | Train Acc: 0.9668
 Site-SynthDigits                   | Train Loss: 0.7094 | Train Acc: 0.7520
 Site-SynthDigits                   | Train Loss: 0.4937 | Train Acc: 0.8547
 Site-MNIST_M                       | Train Loss: 0.9067 | Train Acc: 0.6739
 Site-MNIST_M                       | Train Loss: 0.6891 | Train Acc: 0.7937
 Site-SVHN                          | Train Loss: 1.3991 | Train Acc: 0.5310
 Site-SVHN                          | Train Loss: 1.0563 | Train Acc: 0.6377
Average Train Accuracy: 0.8086
 Site-MNIST                         | Val  Loss: 0.1438 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.1539 | Val  Acc: 0.9496
 Site-USPS                          | Val  Loss: 0.2506 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1718 | Val  Acc: 0.9496
 Site-SynthDigits                   | Val  Loss: 0.4998 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.5898 | Val  Acc: 0.8022
 Site-MNIST_M                       | Val  Loss: 0.6832 | Val  Acc: 0.8261
 Site-MNIST_M                       | Val  Loss: 0.7123 | Val  Acc: 0.7554
 Site-SVHN                          | Val  Loss: 0.9775 | Val  Acc: 0.6630
 Site-SVHN                          | Val  Loss: 1.1215 | Val  Acc: 0.6223
Average Valid Accuracy: 0.8286
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9457
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.9496
 Best site-USPS                      | Epoch:31 | Val Acc: 0.9130
 Best site-USPS                      | Epoch:31 | Val Acc: 0.9496
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.8587
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.8022
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.8261
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.7554
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.6630
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.6223
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.1542 | Train Acc: 0.9461
 Site-MNIST                         | Train Loss: 0.1572 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.1688 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.1239 | Train Acc: 0.9650
 Site-SynthDigits                   | Train Loss: 0.6971 | Train Acc: 0.7763
 Site-SynthDigits                   | Train Loss: 0.4750 | Train Acc: 0.8646
 Site-MNIST_M                       | Train Loss: 0.9257 | Train Acc: 0.6712
 Site-MNIST_M                       | Train Loss: 0.6891 | Train Acc: 0.7955
 Site-SVHN                          | Train Loss: 1.3860 | Train Acc: 0.5202
 Site-SVHN                          | Train Loss: 1.0423 | Train Acc: 0.6377
Average Train Accuracy: 0.8098
 Site-MNIST                         | Val  Loss: 0.1391 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1589 | Val  Acc: 0.9568
 Site-USPS                          | Val  Loss: 0.2612 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1725 | Val  Acc: 0.9496
 Site-SynthDigits                   | Val  Loss: 0.4899 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.5720 | Val  Acc: 0.8237
 Site-MNIST_M                       | Val  Loss: 0.6901 | Val  Acc: 0.8043
 Site-MNIST_M                       | Val  Loss: 0.7194 | Val  Acc: 0.7554
 Site-SVHN                          | Val  Loss: 0.9880 | Val  Acc: 0.6087
 Site-SVHN                          | Val  Loss: 1.1215 | Val  Acc: 0.5935
Average Valid Accuracy: 0.8242
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.1482 | Train Acc: 0.9542
 Site-MNIST                         | Train Loss: 0.1526 | Train Acc: 0.9578
 Site-USPS                          | Train Loss: 0.1669 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.1152 | Train Acc: 0.9659
 Site-SynthDigits                   | Train Loss: 0.7004 | Train Acc: 0.7682
 Site-SynthDigits                   | Train Loss: 0.4770 | Train Acc: 0.8574
 Site-MNIST_M                       | Train Loss: 0.9031 | Train Acc: 0.6873
 Site-MNIST_M                       | Train Loss: 0.6638 | Train Acc: 0.7991
 Site-SVHN                          | Train Loss: 1.3902 | Train Acc: 0.5229
 Site-SVHN                          | Train Loss: 1.0450 | Train Acc: 0.6457
Average Train Accuracy: 0.8124
 Site-MNIST                         | Val  Loss: 0.1407 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1550 | Val  Acc: 0.9532
 Site-USPS                          | Val  Loss: 0.2466 | Val  Acc: 0.9130
 Site-USPS                          | Val  Loss: 0.1616 | Val  Acc: 0.9460
 Site-SynthDigits                   | Val  Loss: 0.4923 | Val  Acc: 0.8804
 Site-SynthDigits                   | Val  Loss: 0.5732 | Val  Acc: 0.8165
 Site-MNIST_M                       | Val  Loss: 0.6875 | Val  Acc: 0.8152
 Site-MNIST_M                       | Val  Loss: 0.6996 | Val  Acc: 0.7626
 Site-SVHN                          | Val  Loss: 1.0123 | Val  Acc: 0.5978
 Site-SVHN                          | Val  Loss: 1.1372 | Val  Acc: 0.6079
Average Valid Accuracy: 0.8249
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.1366 | Train Acc: 0.9542
 Site-MNIST                         | Train Loss: 0.1465 | Train Acc: 0.9587
 Site-USPS                          | Train Loss: 0.1663 | Train Acc: 0.9569
 Site-USPS                          | Train Loss: 0.1186 | Train Acc: 0.9677
 Site-SynthDigits                   | Train Loss: 0.7074 | Train Acc: 0.7682
 Site-SynthDigits                   | Train Loss: 0.4773 | Train Acc: 0.8547
 Site-MNIST_M                       | Train Loss: 0.8851 | Train Acc: 0.6819
 Site-MNIST_M                       | Train Loss: 0.6598 | Train Acc: 0.8081
 Site-SVHN                          | Train Loss: 1.3923 | Train Acc: 0.5391
 Site-SVHN                          | Train Loss: 1.0275 | Train Acc: 0.6547
Average Train Accuracy: 0.8144
 Site-MNIST                         | Val  Loss: 0.1303 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.1470 | Val  Acc: 0.9496
 Site-USPS                          | Val  Loss: 0.2409 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1680 | Val  Acc: 0.9532
 Site-SynthDigits                   | Val  Loss: 0.4914 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.5590 | Val  Acc: 0.8165
 Site-MNIST_M                       | Val  Loss: 0.6802 | Val  Acc: 0.8261
 Site-MNIST_M                       | Val  Loss: 0.6906 | Val  Acc: 0.7698
 Site-SVHN                          | Val  Loss: 0.9884 | Val  Acc: 0.6196
 Site-SVHN                          | Val  Loss: 1.1099 | Val  Acc: 0.6259
Average Valid Accuracy: 0.8289
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9457
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.9496
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9239
 Best site-USPS                      | Epoch:34 | Val Acc: 0.9532
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.8587
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.8165
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.8261
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.7698
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.6196
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.6259
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.1411 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1534 | Train Acc: 0.9605
 Site-USPS                          | Train Loss: 0.1567 | Train Acc: 0.9677
 Site-USPS                          | Train Loss: 0.1102 | Train Acc: 0.9695
 Site-SynthDigits                   | Train Loss: 0.6801 | Train Acc: 0.7736
 Site-SynthDigits                   | Train Loss: 0.4677 | Train Acc: 0.8637
 Site-MNIST_M                       | Train Loss: 0.8692 | Train Acc: 0.6954
 Site-MNIST_M                       | Train Loss: 0.6283 | Train Acc: 0.8215
 Site-SVHN                          | Train Loss: 1.3886 | Train Acc: 0.5391
 Site-SVHN                          | Train Loss: 1.0232 | Train Acc: 0.6565
Average Train Accuracy: 0.8199
 Site-MNIST                         | Val  Loss: 0.1288 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1432 | Val  Acc: 0.9568
 Site-USPS                          | Val  Loss: 0.2326 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1566 | Val  Acc: 0.9532
 Site-SynthDigits                   | Val  Loss: 0.4853 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.5501 | Val  Acc: 0.8237
 Site-MNIST_M                       | Val  Loss: 0.6501 | Val  Acc: 0.8261
 Site-MNIST_M                       | Val  Loss: 0.6731 | Val  Acc: 0.7806
 Site-SVHN                          | Val  Loss: 0.9851 | Val  Acc: 0.6196
 Site-SVHN                          | Val  Loss: 1.1057 | Val  Acc: 0.6187
Average Valid Accuracy: 0.8329
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9565
 Best site-MNIST                     | Epoch:35 | Val Acc: 0.9568
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9239
 Best site-USPS                      | Epoch:35 | Val Acc: 0.9532
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.8696
 Best site-SynthDigits               | Epoch:35 | Val Acc: 0.8237
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.8261
 Best site-MNIST_M                   | Epoch:35 | Val Acc: 0.7806
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.6196
 Best site-SVHN                      | Epoch:35 | Val Acc: 0.6187
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.1436 | Train Acc: 0.9569
 Site-MNIST                         | Train Loss: 0.1342 | Train Acc: 0.9605
 Site-USPS                          | Train Loss: 0.1543 | Train Acc: 0.9677
 Site-USPS                          | Train Loss: 0.1155 | Train Acc: 0.9713
 Site-SynthDigits                   | Train Loss: 0.6821 | Train Acc: 0.7763
 Site-SynthDigits                   | Train Loss: 0.4495 | Train Acc: 0.8717
 Site-MNIST_M                       | Train Loss: 0.8903 | Train Acc: 0.6900
 Site-MNIST_M                       | Train Loss: 0.6390 | Train Acc: 0.8099
 Site-SVHN                          | Train Loss: 1.3550 | Train Acc: 0.5364
 Site-SVHN                          | Train Loss: 1.0262 | Train Acc: 0.6574
Average Train Accuracy: 0.8198
 Site-MNIST                         | Val  Loss: 0.1174 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1336 | Val  Acc: 0.9568
 Site-USPS                          | Val  Loss: 0.2339 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1606 | Val  Acc: 0.9532
 Site-SynthDigits                   | Val  Loss: 0.4624 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.5364 | Val  Acc: 0.8345
 Site-MNIST_M                       | Val  Loss: 0.6408 | Val  Acc: 0.8043
 Site-MNIST_M                       | Val  Loss: 0.6685 | Val  Acc: 0.7770
 Site-SVHN                          | Val  Loss: 0.9714 | Val  Acc: 0.6304
 Site-SVHN                          | Val  Loss: 1.0958 | Val  Acc: 0.6151
Average Valid Accuracy: 0.8332
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9568
 Best site-USPS                      | Epoch:36 | Val Acc: 0.9239
 Best site-USPS                      | Epoch:36 | Val Acc: 0.9532
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.8696
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.8345
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.8043
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.7770
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.6304
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.6151
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.1497 | Train Acc: 0.9488
 Site-MNIST                         | Train Loss: 0.1437 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.1591 | Train Acc: 0.9569
 Site-USPS                          | Train Loss: 0.1089 | Train Acc: 0.9722
 Site-SynthDigits                   | Train Loss: 0.6701 | Train Acc: 0.7628
 Site-SynthDigits                   | Train Loss: 0.4532 | Train Acc: 0.8691
 Site-MNIST_M                       | Train Loss: 0.8833 | Train Acc: 0.6739
 Site-MNIST_M                       | Train Loss: 0.6192 | Train Acc: 0.8161
 Site-SVHN                          | Train Loss: 1.3589 | Train Acc: 0.5391
 Site-SVHN                          | Train Loss: 1.0105 | Train Acc: 0.6601
Average Train Accuracy: 0.8159
 Site-MNIST                         | Val  Loss: 0.1226 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1410 | Val  Acc: 0.9604
 Site-USPS                          | Val  Loss: 0.2111 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1512 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.4733 | Val  Acc: 0.8478
 Site-SynthDigits                   | Val  Loss: 0.5436 | Val  Acc: 0.8129
 Site-MNIST_M                       | Val  Loss: 0.6181 | Val  Acc: 0.8261
 Site-MNIST_M                       | Val  Loss: 0.6628 | Val  Acc: 0.7662
 Site-SVHN                          | Val  Loss: 0.9447 | Val  Acc: 0.6739
 Site-SVHN                          | Val  Loss: 1.0770 | Val  Acc: 0.6439
Average Valid Accuracy: 0.8390
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.9604
 Best site-USPS                      | Epoch:37 | Val Acc: 0.9348
 Best site-USPS                      | Epoch:37 | Val Acc: 0.9568
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.8478
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.8129
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.8261
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.7662
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.6739
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.6439
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.1413 | Train Acc: 0.9488
 Site-MNIST                         | Train Loss: 0.1429 | Train Acc: 0.9632
 Site-USPS                          | Train Loss: 0.1576 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.1089 | Train Acc: 0.9713
 Site-SynthDigits                   | Train Loss: 0.6783 | Train Acc: 0.7709
 Site-SynthDigits                   | Train Loss: 0.4503 | Train Acc: 0.8682
 Site-MNIST_M                       | Train Loss: 0.8613 | Train Acc: 0.6900
 Site-MNIST_M                       | Train Loss: 0.6066 | Train Acc: 0.8260
 Site-SVHN                          | Train Loss: 1.3492 | Train Acc: 0.5391
 Site-SVHN                          | Train Loss: 1.0048 | Train Acc: 0.6565
Average Train Accuracy: 0.8199
 Site-MNIST                         | Val  Loss: 0.1290 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1394 | Val  Acc: 0.9604
 Site-USPS                          | Val  Loss: 0.2154 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1468 | Val  Acc: 0.9532
 Site-SynthDigits                   | Val  Loss: 0.4498 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.5343 | Val  Acc: 0.8237
 Site-MNIST_M                       | Val  Loss: 0.6260 | Val  Acc: 0.8152
 Site-MNIST_M                       | Val  Loss: 0.6420 | Val  Acc: 0.7842
 Site-SVHN                          | Val  Loss: 0.9543 | Val  Acc: 0.6413
 Site-SVHN                          | Val  Loss: 1.0754 | Val  Acc: 0.6079
Average Valid Accuracy: 0.8347
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.1395 | Train Acc: 0.9542
 Site-MNIST                         | Train Loss: 0.1337 | Train Acc: 0.9641
 Site-USPS                          | Train Loss: 0.1503 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.1007 | Train Acc: 0.9731
 Site-SynthDigits                   | Train Loss: 0.6627 | Train Acc: 0.7655
 Site-SynthDigits                   | Train Loss: 0.4392 | Train Acc: 0.8744
 Site-MNIST_M                       | Train Loss: 0.8579 | Train Acc: 0.6900
 Site-MNIST_M                       | Train Loss: 0.5993 | Train Acc: 0.8314
 Site-SVHN                          | Train Loss: 1.3917 | Train Acc: 0.5337
 Site-SVHN                          | Train Loss: 1.0129 | Train Acc: 0.6682
Average Train Accuracy: 0.8220
 Site-MNIST                         | Val  Loss: 0.1156 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1291 | Val  Acc: 0.9568
 Site-USPS                          | Val  Loss: 0.2036 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1440 | Val  Acc: 0.9604
 Site-SynthDigits                   | Val  Loss: 0.4504 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.5242 | Val  Acc: 0.8165
 Site-MNIST_M                       | Val  Loss: 0.6165 | Val  Acc: 0.8152
 Site-MNIST_M                       | Val  Loss: 0.6385 | Val  Acc: 0.7770
 Site-SVHN                          | Val  Loss: 0.9560 | Val  Acc: 0.6196
 Site-SVHN                          | Val  Loss: 1.0894 | Val  Acc: 0.6187
Average Valid Accuracy: 0.8325
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.1367 | Train Acc: 0.9542
 Site-MNIST                         | Train Loss: 0.1302 | Train Acc: 0.9641
 Site-USPS                          | Train Loss: 0.1593 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.1037 | Train Acc: 0.9704
 Site-SynthDigits                   | Train Loss: 0.6565 | Train Acc: 0.7736
 Site-SynthDigits                   | Train Loss: 0.4384 | Train Acc: 0.8798
 Site-MNIST_M                       | Train Loss: 0.8600 | Train Acc: 0.6954
 Site-MNIST_M                       | Train Loss: 0.5966 | Train Acc: 0.8242
 Site-SVHN                          | Train Loss: 1.3347 | Train Acc: 0.5472
 Site-SVHN                          | Train Loss: 0.9775 | Train Acc: 0.6762
Average Train Accuracy: 0.8245
 Site-MNIST                         | Val  Loss: 0.1151 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1299 | Val  Acc: 0.9640
 Site-USPS                          | Val  Loss: 0.1976 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1477 | Val  Acc: 0.9532
 Site-SynthDigits                   | Val  Loss: 0.4454 | Val  Acc: 0.8804
 Site-SynthDigits                   | Val  Loss: 0.5203 | Val  Acc: 0.8273
 Site-MNIST_M                       | Val  Loss: 0.6149 | Val  Acc: 0.8043
 Site-MNIST_M                       | Val  Loss: 0.6399 | Val  Acc: 0.7698
 Site-SVHN                          | Val  Loss: 0.9166 | Val  Acc: 0.6304
 Site-SVHN                          | Val  Loss: 1.0471 | Val  Acc: 0.6151
Average Valid Accuracy: 0.8336
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.1381 | Train Acc: 0.9461
 Site-MNIST                         | Train Loss: 0.1311 | Train Acc: 0.9632
 Site-USPS                          | Train Loss: 0.1574 | Train Acc: 0.9677
 Site-USPS                          | Train Loss: 0.1079 | Train Acc: 0.9704
 Site-SynthDigits                   | Train Loss: 0.6620 | Train Acc: 0.7682
 Site-SynthDigits                   | Train Loss: 0.4295 | Train Acc: 0.8825
 Site-MNIST_M                       | Train Loss: 0.8577 | Train Acc: 0.6954
 Site-MNIST_M                       | Train Loss: 0.5911 | Train Acc: 0.8215
 Site-SVHN                          | Train Loss: 1.3571 | Train Acc: 0.5606
 Site-SVHN                          | Train Loss: 0.9769 | Train Acc: 0.6744
Average Train Accuracy: 0.8250
 Site-MNIST                         | Val  Loss: 0.1133 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1329 | Val  Acc: 0.9604
 Site-USPS                          | Val  Loss: 0.2222 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1493 | Val  Acc: 0.9532
 Site-SynthDigits                   | Val  Loss: 0.4679 | Val  Acc: 0.8804
 Site-SynthDigits                   | Val  Loss: 0.5075 | Val  Acc: 0.8345
 Site-MNIST_M                       | Val  Loss: 0.5921 | Val  Acc: 0.7826
 Site-MNIST_M                       | Val  Loss: 0.6369 | Val  Acc: 0.7518
 Site-SVHN                          | Val  Loss: 0.8859 | Val  Acc: 0.6957
 Site-SVHN                          | Val  Loss: 1.0404 | Val  Acc: 0.6619
Average Valid Accuracy: 0.8412
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.9604
 Best site-USPS                      | Epoch:41 | Val Acc: 0.9239
 Best site-USPS                      | Epoch:41 | Val Acc: 0.9532
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.8804
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.8345
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.7826
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.7518
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.6957
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.6619
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.1384 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1344 | Train Acc: 0.9641
 Site-USPS                          | Train Loss: 0.1497 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.1023 | Train Acc: 0.9722
 Site-SynthDigits                   | Train Loss: 0.6680 | Train Acc: 0.7601
 Site-SynthDigits                   | Train Loss: 0.4334 | Train Acc: 0.8691
 Site-MNIST_M                       | Train Loss: 0.8667 | Train Acc: 0.6739
 Site-MNIST_M                       | Train Loss: 0.5948 | Train Acc: 0.8188
 Site-SVHN                          | Train Loss: 1.3380 | Train Acc: 0.5445
 Site-SVHN                          | Train Loss: 0.9581 | Train Acc: 0.6861
Average Train Accuracy: 0.8202
 Site-MNIST                         | Val  Loss: 0.1157 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1320 | Val  Acc: 0.9568
 Site-USPS                          | Val  Loss: 0.1880 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1447 | Val  Acc: 0.9532
 Site-SynthDigits                   | Val  Loss: 0.4458 | Val  Acc: 0.8478
 Site-SynthDigits                   | Val  Loss: 0.5147 | Val  Acc: 0.8058
 Site-MNIST_M                       | Val  Loss: 0.6032 | Val  Acc: 0.8043
 Site-MNIST_M                       | Val  Loss: 0.6427 | Val  Acc: 0.7518
 Site-SVHN                          | Val  Loss: 0.9063 | Val  Acc: 0.6304
 Site-SVHN                          | Val  Loss: 1.0384 | Val  Acc: 0.6331
Average Valid Accuracy: 0.8275
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.1306 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1229 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.1545 | Train Acc: 0.9596
 Site-USPS                          | Train Loss: 0.1013 | Train Acc: 0.9731
 Site-SynthDigits                   | Train Loss: 0.6582 | Train Acc: 0.7844
 Site-SynthDigits                   | Train Loss: 0.4164 | Train Acc: 0.8852
 Site-MNIST_M                       | Train Loss: 0.8618 | Train Acc: 0.6873
 Site-MNIST_M                       | Train Loss: 0.5920 | Train Acc: 0.8278
 Site-SVHN                          | Train Loss: 1.3495 | Train Acc: 0.5445
 Site-SVHN                          | Train Loss: 0.9731 | Train Acc: 0.6807
Average Train Accuracy: 0.8256
 Site-MNIST                         | Val  Loss: 0.1150 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1272 | Val  Acc: 0.9532
 Site-USPS                          | Val  Loss: 0.1954 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1357 | Val  Acc: 0.9640
 Site-SynthDigits                   | Val  Loss: 0.4299 | Val  Acc: 0.8804
 Site-SynthDigits                   | Val  Loss: 0.4962 | Val  Acc: 0.8345
 Site-MNIST_M                       | Val  Loss: 0.5825 | Val  Acc: 0.8152
 Site-MNIST_M                       | Val  Loss: 0.6352 | Val  Acc: 0.7662
 Site-SVHN                          | Val  Loss: 0.9078 | Val  Acc: 0.6739
 Site-SVHN                          | Val  Loss: 1.0609 | Val  Acc: 0.6475
Average Valid Accuracy: 0.8426
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9565
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9532
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9348
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9640
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.8804
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.8345
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.8152
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.7662
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.6739
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.6475
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.1247 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1193 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.1466 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.0939 | Train Acc: 0.9731
 Site-SynthDigits                   | Train Loss: 0.6425 | Train Acc: 0.7790
 Site-SynthDigits                   | Train Loss: 0.4130 | Train Acc: 0.8825
 Site-MNIST_M                       | Train Loss: 0.8573 | Train Acc: 0.7116
 Site-MNIST_M                       | Train Loss: 0.5788 | Train Acc: 0.8368
 Site-SVHN                          | Train Loss: 1.3600 | Train Acc: 0.5472
 Site-SVHN                          | Train Loss: 0.9814 | Train Acc: 0.6682
Average Train Accuracy: 0.8277
 Site-MNIST                         | Val  Loss: 0.1138 | Val  Acc: 0.9457
 Site-MNIST                         | Val  Loss: 0.1232 | Val  Acc: 0.9568
 Site-USPS                          | Val  Loss: 0.1771 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1326 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.4478 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.5014 | Val  Acc: 0.8237
 Site-MNIST_M                       | Val  Loss: 0.5803 | Val  Acc: 0.8152
 Site-MNIST_M                       | Val  Loss: 0.6266 | Val  Acc: 0.7878
 Site-SVHN                          | Val  Loss: 0.9256 | Val  Acc: 0.6739
 Site-SVHN                          | Val  Loss: 1.0698 | Val  Acc: 0.6259
Average Valid Accuracy: 0.8379
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.1385 | Train Acc: 0.9488
 Site-MNIST                         | Train Loss: 0.1252 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.1447 | Train Acc: 0.9677
 Site-USPS                          | Train Loss: 0.0942 | Train Acc: 0.9731
 Site-SynthDigits                   | Train Loss: 0.6292 | Train Acc: 0.7844
 Site-SynthDigits                   | Train Loss: 0.4035 | Train Acc: 0.8897
 Site-MNIST_M                       | Train Loss: 0.8491 | Train Acc: 0.7116
 Site-MNIST_M                       | Train Loss: 0.5715 | Train Acc: 0.8377
 Site-SVHN                          | Train Loss: 1.3538 | Train Acc: 0.5526
 Site-SVHN                          | Train Loss: 0.9914 | Train Acc: 0.6691
Average Train Accuracy: 0.8297
 Site-MNIST                         | Val  Loss: 0.1068 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1220 | Val  Acc: 0.9604
 Site-USPS                          | Val  Loss: 0.1886 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1325 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.4369 | Val  Acc: 0.8804
 Site-SynthDigits                   | Val  Loss: 0.4808 | Val  Acc: 0.8381
 Site-MNIST_M                       | Val  Loss: 0.5715 | Val  Acc: 0.8043
 Site-MNIST_M                       | Val  Loss: 0.6152 | Val  Acc: 0.7806
 Site-SVHN                          | Val  Loss: 0.9227 | Val  Acc: 0.6522
 Site-SVHN                          | Val  Loss: 1.0650 | Val  Acc: 0.6295
Average Valid Accuracy: 0.8405
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.1382 | Train Acc: 0.9488
 Site-MNIST                         | Train Loss: 0.1273 | Train Acc: 0.9623
 Site-USPS                          | Train Loss: 0.1399 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.0949 | Train Acc: 0.9740
 Site-SynthDigits                   | Train Loss: 0.6335 | Train Acc: 0.7898
 Site-SynthDigits                   | Train Loss: 0.3987 | Train Acc: 0.8924
 Site-MNIST_M                       | Train Loss: 0.8589 | Train Acc: 0.6981
 Site-MNIST_M                       | Train Loss: 0.5606 | Train Acc: 0.8377
 Site-SVHN                          | Train Loss: 1.3230 | Train Acc: 0.5526
 Site-SVHN                          | Train Loss: 0.9432 | Train Acc: 0.6816
Average Train Accuracy: 0.8302
 Site-MNIST                         | Val  Loss: 0.1178 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1305 | Val  Acc: 0.9532
 Site-USPS                          | Val  Loss: 0.1922 | Val  Acc: 0.9239
 Site-USPS                          | Val  Loss: 0.1310 | Val  Acc: 0.9496
 Site-SynthDigits                   | Val  Loss: 0.4128 | Val  Acc: 0.8696
 Site-SynthDigits                   | Val  Loss: 0.4866 | Val  Acc: 0.8417
 Site-MNIST_M                       | Val  Loss: 0.5636 | Val  Acc: 0.8043
 Site-MNIST_M                       | Val  Loss: 0.6062 | Val  Acc: 0.7770
 Site-SVHN                          | Val  Loss: 0.9080 | Val  Acc: 0.6739
 Site-SVHN                          | Val  Loss: 1.0320 | Val  Acc: 0.6439
Average Valid Accuracy: 0.8394
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.1414 | Train Acc: 0.9542
 Site-MNIST                         | Train Loss: 0.1255 | Train Acc: 0.9677
 Site-USPS                          | Train Loss: 0.1459 | Train Acc: 0.9677
 Site-USPS                          | Train Loss: 0.0952 | Train Acc: 0.9731
 Site-SynthDigits                   | Train Loss: 0.6292 | Train Acc: 0.7871
 Site-SynthDigits                   | Train Loss: 0.4038 | Train Acc: 0.8843
 Site-MNIST_M                       | Train Loss: 0.8298 | Train Acc: 0.7089
 Site-MNIST_M                       | Train Loss: 0.5433 | Train Acc: 0.8422
 Site-SVHN                          | Train Loss: 1.3274 | Train Acc: 0.5337
 Site-SVHN                          | Train Loss: 0.9468 | Train Acc: 0.6852
Average Train Accuracy: 0.8304
 Site-MNIST                         | Val  Loss: 0.1130 | Val  Acc: 0.9674
 Site-MNIST                         | Val  Loss: 0.1230 | Val  Acc: 0.9676
 Site-USPS                          | Val  Loss: 0.1800 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1273 | Val  Acc: 0.9568
 Site-SynthDigits                   | Val  Loss: 0.4139 | Val  Acc: 0.8913
 Site-SynthDigits                   | Val  Loss: 0.4839 | Val  Acc: 0.8417
 Site-MNIST_M                       | Val  Loss: 0.5516 | Val  Acc: 0.8043
 Site-MNIST_M                       | Val  Loss: 0.5904 | Val  Acc: 0.7770
 Site-SVHN                          | Val  Loss: 0.9175 | Val  Acc: 0.6630
 Site-SVHN                          | Val  Loss: 1.0328 | Val  Acc: 0.6295
Average Valid Accuracy: 0.8434
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9674
 Best site-MNIST                     | Epoch:47 | Val Acc: 0.9676
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9348
 Best site-USPS                      | Epoch:47 | Val Acc: 0.9568
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.8913
 Best site-SynthDigits               | Epoch:47 | Val Acc: 0.8417
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.8043
 Best site-MNIST_M                   | Epoch:47 | Val Acc: 0.7770
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.6630
 Best site-SVHN                      | Epoch:47 | Val Acc: 0.6295
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.1212 | Train Acc: 0.9542
 Site-MNIST                         | Train Loss: 0.1163 | Train Acc: 0.9713
 Site-USPS                          | Train Loss: 0.1403 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.0907 | Train Acc: 0.9731
 Site-SynthDigits                   | Train Loss: 0.6476 | Train Acc: 0.7736
 Site-SynthDigits                   | Train Loss: 0.4077 | Train Acc: 0.8870
 Site-MNIST_M                       | Train Loss: 0.8367 | Train Acc: 0.7116
 Site-MNIST_M                       | Train Loss: 0.5513 | Train Acc: 0.8439
 Site-SVHN                          | Train Loss: 1.3267 | Train Acc: 0.5445
 Site-SVHN                          | Train Loss: 0.9532 | Train Acc: 0.6843
Average Train Accuracy: 0.8308
 Site-MNIST                         | Val  Loss: 0.1198 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1207 | Val  Acc: 0.9676
 Site-USPS                          | Val  Loss: 0.1609 | Val  Acc: 0.9348
 Site-USPS                          | Val  Loss: 0.1326 | Val  Acc: 0.9496
 Site-SynthDigits                   | Val  Loss: 0.4074 | Val  Acc: 0.8587
 Site-SynthDigits                   | Val  Loss: 0.4936 | Val  Acc: 0.8165
 Site-MNIST_M                       | Val  Loss: 0.5465 | Val  Acc: 0.8261
 Site-MNIST_M                       | Val  Loss: 0.6041 | Val  Acc: 0.7842
 Site-SVHN                          | Val  Loss: 0.8827 | Val  Acc: 0.6848
 Site-SVHN                          | Val  Loss: 1.0161 | Val  Acc: 0.6439
Average Valid Accuracy: 0.8423
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.1213 | Train Acc: 0.9542
 Site-MNIST                         | Train Loss: 0.1117 | Train Acc: 0.9740
 Site-USPS                          | Train Loss: 0.1431 | Train Acc: 0.9650
 Site-USPS                          | Train Loss: 0.0957 | Train Acc: 0.9767
 Site-SynthDigits                   | Train Loss: 0.6371 | Train Acc: 0.7925
 Site-SynthDigits                   | Train Loss: 0.3895 | Train Acc: 0.8933
 Site-MNIST_M                       | Train Loss: 0.8488 | Train Acc: 0.7008
 Site-MNIST_M                       | Train Loss: 0.5457 | Train Acc: 0.8475
 Site-SVHN                          | Train Loss: 1.3297 | Train Acc: 0.5553
 Site-SVHN                          | Train Loss: 0.9352 | Train Acc: 0.6951
Average Train Accuracy: 0.8354
 Site-MNIST                         | Val  Loss: 0.1086 | Val  Acc: 0.9565
 Site-MNIST                         | Val  Loss: 0.1099 | Val  Acc: 0.9676
 Site-USPS                          | Val  Loss: 0.1759 | Val  Acc: 0.9457
 Site-USPS                          | Val  Loss: 0.1335 | Val  Acc: 0.9640
 Site-SynthDigits                   | Val  Loss: 0.4024 | Val  Acc: 0.8804
 Site-SynthDigits                   | Val  Loss: 0.4745 | Val  Acc: 0.8381
 Site-MNIST_M                       | Val  Loss: 0.5468 | Val  Acc: 0.8370
 Site-MNIST_M                       | Val  Loss: 0.6046 | Val  Acc: 0.7842
 Site-SVHN                          | Val  Loss: 0.8661 | Val  Acc: 0.7283
 Site-SVHN                          | Val  Loss: 0.9977 | Val  Acc: 0.6691
Average Valid Accuracy: 0.8571
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9565
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.9676
 Best site-USPS                      | Epoch:49 | Val Acc: 0.9457
 Best site-USPS                      | Epoch:49 | Val Acc: 0.9640
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.8804
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.8381
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.8370
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.7842
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.7283
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.6691
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/harmo-fl...
===2023-07-31 16:55:23===
===2023-07-31 16:55:30===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.9380
 Test site-USPS                      | Epoch:49 | Test Acc: 0.9441
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.7863
 Test site-MNIST_M                   | Epoch:49 | Test Acc: 0.5867
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.4921
MNIST: 0.9380, USPS: 0.9441, SynthDigits: 0.7863, MNIST_M: 0.5867, SVHN: 0.4921, 
Average Test Accuracy(group): 0.7494, Average Test Accuracy(individual): 0.7494,
domain std=0.1830, cluster std=-1.0000, individual std=0.1830, 
