===2023-07-31 06:12:08===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
============ Train epoch 0 ============
denominator: 30477.51171875
 Site-MNIST                         | Train Loss: 2.1971 | Train Acc: 0.3504
 Site-MNIST                         | Train Loss: 2.2242 | Train Acc: 0.2637
 Site-USPS                          | Train Loss: 2.1753 | Train Acc: 0.3504
 Site-USPS                          | Train Loss: 2.1784 | Train Acc: 0.3758
 Site-SynthDigits                   | Train Loss: 2.2804 | Train Acc: 0.1617
 Site-SynthDigits                   | Train Loss: 2.2603 | Train Acc: 0.2170
 Site-MNIST_M                       | Train Loss: 2.2837 | Train Acc: 0.1725
 Site-MNIST_M                       | Train Loss: 2.2895 | Train Acc: 0.1327
 Site-SVHN                          | Train Loss: 2.2592 | Train Acc: 0.2345
 Site-SVHN                          | Train Loss: 2.2731 | Train Acc: 0.1955
Average Train Accuracy: 0.2454
 Site-MNIST                         | Val  Loss: 2.2318 | Val  Acc: 0.2609
 Site-MNIST                         | Val  Loss: 2.2241 | Val  Acc: 0.2878
 Site-USPS                          | Val  Loss: 2.1841 | Val  Acc: 0.3261
 Site-USPS                          | Val  Loss: 2.1927 | Val  Acc: 0.3165
 Site-SynthDigits                   | Val  Loss: 2.2586 | Val  Acc: 0.2174
 Site-SynthDigits                   | Val  Loss: 2.2750 | Val  Acc: 0.1763
 Site-MNIST_M                       | Val  Loss: 2.2999 | Val  Acc: 0.1304
 Site-MNIST_M                       | Val  Loss: 2.2870 | Val  Acc: 0.1547
 Site-SVHN                          | Val  Loss: 2.2412 | Val  Acc: 0.2609
 Site-SVHN                          | Val  Loss: 2.2583 | Val  Acc: 0.2446
Average Valid Accuracy: 0.2376
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.2609
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.2878
 Best site-USPS                      | Epoch:0 | Val Acc: 0.3261
 Best site-USPS                      | Epoch:0 | Val Acc: 0.3165
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2174
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1763
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1304
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1547
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2609
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2446
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 1 ============
denominator: 29692.158203125
 Site-MNIST                         | Train Loss: 2.0849 | Train Acc: 0.4960
 Site-MNIST                         | Train Loss: 2.1260 | Train Acc: 0.3964
 Site-USPS                          | Train Loss: 2.0427 | Train Acc: 0.4609
 Site-USPS                          | Train Loss: 2.0438 | Train Acc: 0.4879
 Site-SynthDigits                   | Train Loss: 2.2432 | Train Acc: 0.2399
 Site-SynthDigits                   | Train Loss: 2.2150 | Train Acc: 0.3076
 Site-MNIST_M                       | Train Loss: 2.2617 | Train Acc: 0.2237
 Site-MNIST_M                       | Train Loss: 2.2708 | Train Acc: 0.1821
 Site-SVHN                          | Train Loss: 2.2376 | Train Acc: 0.2695
 Site-SVHN                          | Train Loss: 2.2536 | Train Acc: 0.2251
Average Train Accuracy: 0.3289
 Site-MNIST                         | Val  Loss: 2.1382 | Val  Acc: 0.3804
 Site-MNIST                         | Val  Loss: 2.1248 | Val  Acc: 0.4173
 Site-USPS                          | Val  Loss: 2.0637 | Val  Acc: 0.4130
 Site-USPS                          | Val  Loss: 2.0702 | Val  Acc: 0.4353
 Site-SynthDigits                   | Val  Loss: 2.2121 | Val  Acc: 0.2935
 Site-SynthDigits                   | Val  Loss: 2.2353 | Val  Acc: 0.2554
 Site-MNIST_M                       | Val  Loss: 2.2884 | Val  Acc: 0.1848
 Site-MNIST_M                       | Val  Loss: 2.2709 | Val  Acc: 0.1978
 Site-SVHN                          | Val  Loss: 2.2202 | Val  Acc: 0.2609
 Site-SVHN                          | Val  Loss: 2.2360 | Val  Acc: 0.2662
Average Valid Accuracy: 0.3105
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.3804
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.4173
 Best site-USPS                      | Epoch:1 | Val Acc: 0.4130
 Best site-USPS                      | Epoch:1 | Val Acc: 0.4353
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2935
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.2554
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.1848
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.1978
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2609
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2662
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 2 ============
denominator: 29026.01171875
 Site-MNIST                         | Train Loss: 1.9743 | Train Acc: 0.5768
 Site-MNIST                         | Train Loss: 2.0282 | Train Acc: 0.4762
 Site-USPS                          | Train Loss: 1.9168 | Train Acc: 0.5418
 Site-USPS                          | Train Loss: 1.9161 | Train Acc: 0.6036
 Site-SynthDigits                   | Train Loss: 2.2018 | Train Acc: 0.2965
 Site-SynthDigits                   | Train Loss: 2.1647 | Train Acc: 0.3632
 Site-MNIST_M                       | Train Loss: 2.2407 | Train Acc: 0.2453
 Site-MNIST_M                       | Train Loss: 2.2533 | Train Acc: 0.2072
 Site-SVHN                          | Train Loss: 2.2154 | Train Acc: 0.2803
 Site-SVHN                          | Train Loss: 2.2315 | Train Acc: 0.2323
Average Train Accuracy: 0.3823
 Site-MNIST                         | Val  Loss: 2.0418 | Val  Acc: 0.4891
 Site-MNIST                         | Val  Loss: 2.0263 | Val  Acc: 0.5036
 Site-USPS                          | Val  Loss: 1.9436 | Val  Acc: 0.5435
 Site-USPS                          | Val  Loss: 1.9498 | Val  Acc: 0.5252
 Site-SynthDigits                   | Val  Loss: 2.1624 | Val  Acc: 0.3261
 Site-SynthDigits                   | Val  Loss: 2.1915 | Val  Acc: 0.3022
 Site-MNIST_M                       | Val  Loss: 2.2728 | Val  Acc: 0.2500
 Site-MNIST_M                       | Val  Loss: 2.2525 | Val  Acc: 0.2266
 Site-SVHN                          | Val  Loss: 2.1959 | Val  Acc: 0.2717
 Site-SVHN                          | Val  Loss: 2.2129 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3711
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.4891
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.5036
 Best site-USPS                      | Epoch:2 | Val Acc: 0.5435
 Best site-USPS                      | Epoch:2 | Val Acc: 0.5252
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3261
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3022
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2500
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2266
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2717
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 3 ============
denominator: 28602.708984375
 Site-MNIST                         | Train Loss: 1.8719 | Train Acc: 0.6523
 Site-MNIST                         | Train Loss: 1.9299 | Train Acc: 0.5274
 Site-USPS                          | Train Loss: 1.7996 | Train Acc: 0.6307
 Site-USPS                          | Train Loss: 1.7992 | Train Acc: 0.6583
 Site-SynthDigits                   | Train Loss: 2.1576 | Train Acc: 0.3288
 Site-SynthDigits                   | Train Loss: 2.1147 | Train Acc: 0.3973
 Site-MNIST_M                       | Train Loss: 2.2200 | Train Acc: 0.2588
 Site-MNIST_M                       | Train Loss: 2.2327 | Train Acc: 0.2296
 Site-SVHN                          | Train Loss: 2.1995 | Train Acc: 0.3046
 Site-SVHN                          | Train Loss: 2.2148 | Train Acc: 0.2413
Average Train Accuracy: 0.4229
 Site-MNIST                         | Val  Loss: 1.9447 | Val  Acc: 0.5109
 Site-MNIST                         | Val  Loss: 1.9314 | Val  Acc: 0.5647
 Site-USPS                          | Val  Loss: 1.8316 | Val  Acc: 0.5652
 Site-USPS                          | Val  Loss: 1.8364 | Val  Acc: 0.5899
 Site-SynthDigits                   | Val  Loss: 2.1121 | Val  Acc: 0.3696
 Site-SynthDigits                   | Val  Loss: 2.1440 | Val  Acc: 0.3453
 Site-MNIST_M                       | Val  Loss: 2.2521 | Val  Acc: 0.2609
 Site-MNIST_M                       | Val  Loss: 2.2363 | Val  Acc: 0.2518
 Site-SVHN                          | Val  Loss: 2.1760 | Val  Acc: 0.2935
 Site-SVHN                          | Val  Loss: 2.1947 | Val  Acc: 0.2986
Average Valid Accuracy: 0.4050
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5109
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.5647
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5652
 Best site-USPS                      | Epoch:3 | Val Acc: 0.5899
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3696
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.3453
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2609
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.2518
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2935
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2986
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 4 ============
denominator: 28067.96484375
 Site-MNIST                         | Train Loss: 1.7746 | Train Acc: 0.6658
 Site-MNIST                         | Train Loss: 1.8397 | Train Acc: 0.5605
 Site-USPS                          | Train Loss: 1.6806 | Train Acc: 0.6739
 Site-USPS                          | Train Loss: 1.6830 | Train Acc: 0.7049
 Site-SynthDigits                   | Train Loss: 2.1120 | Train Acc: 0.3342
 Site-SynthDigits                   | Train Loss: 2.0652 | Train Acc: 0.4233
 Site-MNIST_M                       | Train Loss: 2.1976 | Train Acc: 0.2668
 Site-MNIST_M                       | Train Loss: 2.2090 | Train Acc: 0.2502
 Site-SVHN                          | Train Loss: 2.1826 | Train Acc: 0.3127
 Site-SVHN                          | Train Loss: 2.1953 | Train Acc: 0.2511
Average Train Accuracy: 0.4444
 Site-MNIST                         | Val  Loss: 1.8561 | Val  Acc: 0.5543
 Site-MNIST                         | Val  Loss: 1.8433 | Val  Acc: 0.5899
 Site-USPS                          | Val  Loss: 1.7153 | Val  Acc: 0.6087
 Site-USPS                          | Val  Loss: 1.7197 | Val  Acc: 0.6331
 Site-SynthDigits                   | Val  Loss: 2.0639 | Val  Acc: 0.3587
 Site-SynthDigits                   | Val  Loss: 2.0964 | Val  Acc: 0.3597
 Site-MNIST_M                       | Val  Loss: 2.2301 | Val  Acc: 0.2826
 Site-MNIST_M                       | Val  Loss: 2.2154 | Val  Acc: 0.2770
 Site-SVHN                          | Val  Loss: 2.1539 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 2.1742 | Val  Acc: 0.3129
Average Valid Accuracy: 0.4281
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5543
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.5899
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6087
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6331
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3587
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3597
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.2826
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.2770
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.3129
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 5 ============
denominator: 27400.361328125
 Site-MNIST                         | Train Loss: 1.6726 | Train Acc: 0.6927
 Site-MNIST                         | Train Loss: 1.7476 | Train Acc: 0.5883
 Site-USPS                          | Train Loss: 1.5648 | Train Acc: 0.7170
 Site-USPS                          | Train Loss: 1.5640 | Train Acc: 0.7327
 Site-SynthDigits                   | Train Loss: 2.0642 | Train Acc: 0.3585
 Site-SynthDigits                   | Train Loss: 2.0069 | Train Acc: 0.4422
 Site-MNIST_M                       | Train Loss: 2.1666 | Train Acc: 0.2749
 Site-MNIST_M                       | Train Loss: 2.1809 | Train Acc: 0.2771
 Site-SVHN                          | Train Loss: 2.1675 | Train Acc: 0.2992
 Site-SVHN                          | Train Loss: 2.1732 | Train Acc: 0.2574
Average Train Accuracy: 0.4640
 Site-MNIST                         | Val  Loss: 1.7625 | Val  Acc: 0.5761
 Site-MNIST                         | Val  Loss: 1.7491 | Val  Acc: 0.6115
 Site-USPS                          | Val  Loss: 1.6050 | Val  Acc: 0.6522
 Site-USPS                          | Val  Loss: 1.6075 | Val  Acc: 0.6727
 Site-SynthDigits                   | Val  Loss: 2.0092 | Val  Acc: 0.3696
 Site-SynthDigits                   | Val  Loss: 2.0431 | Val  Acc: 0.3921
 Site-MNIST_M                       | Val  Loss: 2.2017 | Val  Acc: 0.3043
 Site-MNIST_M                       | Val  Loss: 2.1884 | Val  Acc: 0.2950
 Site-SVHN                          | Val  Loss: 2.1323 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.1545 | Val  Acc: 0.3129
Average Valid Accuracy: 0.4512
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.5761
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.6115
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6522
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6727
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3696
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3921
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.3043
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.2950
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3129
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 6 ============
denominator: 26745.6328125
 Site-MNIST                         | Train Loss: 1.5818 | Train Acc: 0.7251
 Site-MNIST                         | Train Loss: 1.6566 | Train Acc: 0.6269
 Site-USPS                          | Train Loss: 1.4687 | Train Acc: 0.7358
 Site-USPS                          | Train Loss: 1.4644 | Train Acc: 0.7498
 Site-SynthDigits                   | Train Loss: 2.0183 | Train Acc: 0.3827
 Site-SynthDigits                   | Train Loss: 1.9516 | Train Acc: 0.4574
 Site-MNIST_M                       | Train Loss: 2.1359 | Train Acc: 0.3127
 Site-MNIST_M                       | Train Loss: 2.1550 | Train Acc: 0.2870
 Site-SVHN                          | Train Loss: 2.1495 | Train Acc: 0.3046
 Site-SVHN                          | Train Loss: 2.1548 | Train Acc: 0.2610
Average Train Accuracy: 0.4843
 Site-MNIST                         | Val  Loss: 1.6786 | Val  Acc: 0.6196
 Site-MNIST                         | Val  Loss: 1.6660 | Val  Acc: 0.6547
 Site-USPS                          | Val  Loss: 1.5032 | Val  Acc: 0.6848
 Site-USPS                          | Val  Loss: 1.5071 | Val  Acc: 0.6906
 Site-SynthDigits                   | Val  Loss: 1.9548 | Val  Acc: 0.4239
 Site-SynthDigits                   | Val  Loss: 1.9917 | Val  Acc: 0.4245
 Site-MNIST_M                       | Val  Loss: 2.1710 | Val  Acc: 0.2717
 Site-MNIST_M                       | Val  Loss: 2.1592 | Val  Acc: 0.3201
 Site-SVHN                          | Val  Loss: 2.1064 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.1349 | Val  Acc: 0.3129
Average Valid Accuracy: 0.4729
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6196
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.6547
 Best site-USPS                      | Epoch:6 | Val Acc: 0.6848
 Best site-USPS                      | Epoch:6 | Val Acc: 0.6906
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4239
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4245
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.2717
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3201
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3129
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 7 ============
denominator: 26033.79296875
 Site-MNIST                         | Train Loss: 1.4972 | Train Acc: 0.7493
 Site-MNIST                         | Train Loss: 1.5781 | Train Acc: 0.6529
 Site-USPS                          | Train Loss: 1.3683 | Train Acc: 0.7763
 Site-USPS                          | Train Loss: 1.3724 | Train Acc: 0.7704
 Site-SynthDigits                   | Train Loss: 1.9746 | Train Acc: 0.3827
 Site-SynthDigits                   | Train Loss: 1.9068 | Train Acc: 0.4753
 Site-MNIST_M                       | Train Loss: 2.1099 | Train Acc: 0.3315
 Site-MNIST_M                       | Train Loss: 2.1310 | Train Acc: 0.3022
 Site-SVHN                          | Train Loss: 2.1322 | Train Acc: 0.3073
 Site-SVHN                          | Train Loss: 2.1335 | Train Acc: 0.2637
Average Train Accuracy: 0.5012
 Site-MNIST                         | Val  Loss: 1.5985 | Val  Acc: 0.6413
 Site-MNIST                         | Val  Loss: 1.5855 | Val  Acc: 0.6763
 Site-USPS                          | Val  Loss: 1.4082 | Val  Acc: 0.7065
 Site-USPS                          | Val  Loss: 1.4093 | Val  Acc: 0.7230
 Site-SynthDigits                   | Val  Loss: 1.9072 | Val  Acc: 0.4348
 Site-SynthDigits                   | Val  Loss: 1.9465 | Val  Acc: 0.4317
 Site-MNIST_M                       | Val  Loss: 2.1460 | Val  Acc: 0.2826
 Site-MNIST_M                       | Val  Loss: 2.1333 | Val  Acc: 0.3237
 Site-SVHN                          | Val  Loss: 2.0840 | Val  Acc: 0.3261
 Site-SVHN                          | Val  Loss: 2.1146 | Val  Acc: 0.3165
Average Valid Accuracy: 0.4863
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6413
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.6763
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7065
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7230
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4348
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4317
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.2826
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3237
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3261
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3165
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 8 ============
denominator: 25522.0546875
 Site-MNIST                         | Train Loss: 1.4236 | Train Acc: 0.7655
 Site-MNIST                         | Train Loss: 1.5110 | Train Acc: 0.6637
 Site-USPS                          | Train Loss: 1.2868 | Train Acc: 0.7844
 Site-USPS                          | Train Loss: 1.2850 | Train Acc: 0.7740
 Site-SynthDigits                   | Train Loss: 1.9340 | Train Acc: 0.4205
 Site-SynthDigits                   | Train Loss: 1.8544 | Train Acc: 0.4933
 Site-MNIST_M                       | Train Loss: 2.0824 | Train Acc: 0.3450
 Site-MNIST_M                       | Train Loss: 2.1015 | Train Acc: 0.3193
 Site-SVHN                          | Train Loss: 2.1137 | Train Acc: 0.3073
 Site-SVHN                          | Train Loss: 2.1083 | Train Acc: 0.2735
Average Train Accuracy: 0.5146
 Site-MNIST                         | Val  Loss: 1.5282 | Val  Acc: 0.6087
 Site-MNIST                         | Val  Loss: 1.5151 | Val  Acc: 0.6691
 Site-USPS                          | Val  Loss: 1.3232 | Val  Acc: 0.7283
 Site-USPS                          | Val  Loss: 1.3254 | Val  Acc: 0.7446
 Site-SynthDigits                   | Val  Loss: 1.8557 | Val  Acc: 0.4348
 Site-SynthDigits                   | Val  Loss: 1.8993 | Val  Acc: 0.4496
 Site-MNIST_M                       | Val  Loss: 2.1230 | Val  Acc: 0.2826
 Site-MNIST_M                       | Val  Loss: 2.1069 | Val  Acc: 0.3381
 Site-SVHN                          | Val  Loss: 2.0533 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 2.0905 | Val  Acc: 0.3201
Average Valid Accuracy: 0.4913
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6087
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.6691
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7283
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7446
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4348
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.4496
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.2826
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3381
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3201
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 9 ============
denominator: 25021.15234375
 Site-MNIST                         | Train Loss: 1.3392 | Train Acc: 0.7709
 Site-MNIST                         | Train Loss: 1.4343 | Train Acc: 0.6897
 Site-USPS                          | Train Loss: 1.2054 | Train Acc: 0.8086
 Site-USPS                          | Train Loss: 1.2087 | Train Acc: 0.8090
 Site-SynthDigits                   | Train Loss: 1.8919 | Train Acc: 0.4420
 Site-SynthDigits                   | Train Loss: 1.8142 | Train Acc: 0.5085
 Site-MNIST_M                       | Train Loss: 2.0504 | Train Acc: 0.3477
 Site-MNIST_M                       | Train Loss: 2.0767 | Train Acc: 0.3265
 Site-SVHN                          | Train Loss: 2.0923 | Train Acc: 0.3127
 Site-SVHN                          | Train Loss: 2.0921 | Train Acc: 0.2771
Average Train Accuracy: 0.5293
 Site-MNIST                         | Val  Loss: 1.4515 | Val  Acc: 0.6304
 Site-MNIST                         | Val  Loss: 1.4405 | Val  Acc: 0.6871
 Site-USPS                          | Val  Loss: 1.2534 | Val  Acc: 0.7609
 Site-USPS                          | Val  Loss: 1.2514 | Val  Acc: 0.7842
 Site-SynthDigits                   | Val  Loss: 1.8160 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.8571 | Val  Acc: 0.4676
 Site-MNIST_M                       | Val  Loss: 2.0921 | Val  Acc: 0.2826
 Site-MNIST_M                       | Val  Loss: 2.0772 | Val  Acc: 0.3489
 Site-SVHN                          | Val  Loss: 2.0308 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 2.0710 | Val  Acc: 0.3273
Average Valid Accuracy: 0.5093
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6304
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.6871
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7609
 Best site-USPS                      | Epoch:9 | Val Acc: 0.7842
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4674
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.4676
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.2826
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.3489
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 10 ============
denominator: 24466.267578125
 Site-MNIST                         | Train Loss: 1.2774 | Train Acc: 0.7736
 Site-MNIST                         | Train Loss: 1.3637 | Train Acc: 0.7049
 Site-USPS                          | Train Loss: 1.1426 | Train Acc: 0.8113
 Site-USPS                          | Train Loss: 1.1433 | Train Acc: 0.8135
 Site-SynthDigits                   | Train Loss: 1.8539 | Train Acc: 0.4501
 Site-SynthDigits                   | Train Loss: 1.7756 | Train Acc: 0.5256
 Site-MNIST_M                       | Train Loss: 2.0220 | Train Acc: 0.3774
 Site-MNIST_M                       | Train Loss: 2.0471 | Train Acc: 0.3435
 Site-SVHN                          | Train Loss: 2.0737 | Train Acc: 0.3208
 Site-SVHN                          | Train Loss: 2.0694 | Train Acc: 0.2825
Average Train Accuracy: 0.5403
 Site-MNIST                         | Val  Loss: 1.3874 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.3754 | Val  Acc: 0.6978
 Site-USPS                          | Val  Loss: 1.1918 | Val  Acc: 0.7609
 Site-USPS                          | Val  Loss: 1.1880 | Val  Acc: 0.7878
 Site-SynthDigits                   | Val  Loss: 1.7764 | Val  Acc: 0.4674
 Site-SynthDigits                   | Val  Loss: 1.8183 | Val  Acc: 0.4820
 Site-MNIST_M                       | Val  Loss: 2.0635 | Val  Acc: 0.3043
 Site-MNIST_M                       | Val  Loss: 2.0493 | Val  Acc: 0.3705
 Site-SVHN                          | Val  Loss: 2.0122 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0520 | Val  Acc: 0.3201
Average Valid Accuracy: 0.5169
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6630
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.6978
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7609
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7878
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4674
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.4820
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.3043
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.3705
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3201
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 11 ============
denominator: 23921.166015625
 Site-MNIST                         | Train Loss: 1.2186 | Train Acc: 0.7817
 Site-MNIST                         | Train Loss: 1.3149 | Train Acc: 0.7148
 Site-USPS                          | Train Loss: 1.0825 | Train Acc: 0.8194
 Site-USPS                          | Train Loss: 1.0832 | Train Acc: 0.8233
 Site-SynthDigits                   | Train Loss: 1.8161 | Train Acc: 0.4528
 Site-SynthDigits                   | Train Loss: 1.7352 | Train Acc: 0.5363
 Site-MNIST_M                       | Train Loss: 1.9940 | Train Acc: 0.4043
 Site-MNIST_M                       | Train Loss: 2.0253 | Train Acc: 0.3462
 Site-SVHN                          | Train Loss: 2.0569 | Train Acc: 0.3288
 Site-SVHN                          | Train Loss: 2.0520 | Train Acc: 0.2951
Average Train Accuracy: 0.5503
 Site-MNIST                         | Val  Loss: 1.3281 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.3199 | Val  Acc: 0.7122
 Site-USPS                          | Val  Loss: 1.1408 | Val  Acc: 0.7609
 Site-USPS                          | Val  Loss: 1.1335 | Val  Acc: 0.7914
 Site-SynthDigits                   | Val  Loss: 1.7375 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.7820 | Val  Acc: 0.4928
 Site-MNIST_M                       | Val  Loss: 2.0413 | Val  Acc: 0.2935
 Site-MNIST_M                       | Val  Loss: 2.0222 | Val  Acc: 0.3813
 Site-SVHN                          | Val  Loss: 1.9980 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0332 | Val  Acc: 0.3381
Average Valid Accuracy: 0.5248
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.6630
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7122
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7609
 Best site-USPS                      | Epoch:11 | Val Acc: 0.7914
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.4928
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.2935
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.3813
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3381
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 12 ============
denominator: 23437.931640625
 Site-MNIST                         | Train Loss: 1.1546 | Train Acc: 0.7790
 Site-MNIST                         | Train Loss: 1.2563 | Train Acc: 0.7229
 Site-USPS                          | Train Loss: 1.0410 | Train Acc: 0.8221
 Site-USPS                          | Train Loss: 1.0388 | Train Acc: 0.8341
 Site-SynthDigits                   | Train Loss: 1.7778 | Train Acc: 0.4798
 Site-SynthDigits                   | Train Loss: 1.6939 | Train Acc: 0.5516
 Site-MNIST_M                       | Train Loss: 1.9692 | Train Acc: 0.4232
 Site-MNIST_M                       | Train Loss: 1.9987 | Train Acc: 0.3516
 Site-SVHN                          | Train Loss: 2.0424 | Train Acc: 0.3315
 Site-SVHN                          | Train Loss: 2.0367 | Train Acc: 0.2933
Average Train Accuracy: 0.5589
 Site-MNIST                         | Val  Loss: 1.2683 | Val  Acc: 0.6522
 Site-MNIST                         | Val  Loss: 1.2600 | Val  Acc: 0.7086
 Site-USPS                          | Val  Loss: 1.0983 | Val  Acc: 0.7717
 Site-USPS                          | Val  Loss: 1.0892 | Val  Acc: 0.7950
 Site-SynthDigits                   | Val  Loss: 1.6956 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.7410 | Val  Acc: 0.5216
 Site-MNIST_M                       | Val  Loss: 2.0165 | Val  Acc: 0.3043
 Site-MNIST_M                       | Val  Loss: 1.9963 | Val  Acc: 0.3921
 Site-SVHN                          | Val  Loss: 1.9864 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 2.0164 | Val  Acc: 0.3417
Average Valid Accuracy: 0.5313
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.6522
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7086
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7717
 Best site-USPS                      | Epoch:12 | Val Acc: 0.7950
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.5109
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.5216
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.3043
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.3921
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3417
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 13 ============
denominator: 23050.859375
 Site-MNIST                         | Train Loss: 1.1014 | Train Acc: 0.7978
 Site-MNIST                         | Train Loss: 1.2022 | Train Acc: 0.7336
 Site-USPS                          | Train Loss: 0.9918 | Train Acc: 0.8248
 Site-USPS                          | Train Loss: 0.9808 | Train Acc: 0.8341
 Site-SynthDigits                   | Train Loss: 1.7353 | Train Acc: 0.4879
 Site-SynthDigits                   | Train Loss: 1.6513 | Train Acc: 0.5578
 Site-MNIST_M                       | Train Loss: 1.9390 | Train Acc: 0.4555
 Site-MNIST_M                       | Train Loss: 1.9761 | Train Acc: 0.3641
 Site-SVHN                          | Train Loss: 2.0381 | Train Acc: 0.3288
 Site-SVHN                          | Train Loss: 2.0156 | Train Acc: 0.3058
Average Train Accuracy: 0.5690
 Site-MNIST                         | Val  Loss: 1.2132 | Val  Acc: 0.6630
 Site-MNIST                         | Val  Loss: 1.2043 | Val  Acc: 0.7230
 Site-USPS                          | Val  Loss: 1.0515 | Val  Acc: 0.7826
 Site-USPS                          | Val  Loss: 1.0399 | Val  Acc: 0.7986
 Site-SynthDigits                   | Val  Loss: 1.6523 | Val  Acc: 0.4891
 Site-SynthDigits                   | Val  Loss: 1.6991 | Val  Acc: 0.5144
 Site-MNIST_M                       | Val  Loss: 1.9916 | Val  Acc: 0.3043
 Site-MNIST_M                       | Val  Loss: 1.9672 | Val  Acc: 0.4029
 Site-SVHN                          | Val  Loss: 1.9733 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 1.9997 | Val  Acc: 0.3417
Average Valid Accuracy: 0.5335
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.6630
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7230
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7826
 Best site-USPS                      | Epoch:13 | Val Acc: 0.7986
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.4891
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5144
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.3043
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4029
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3417
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 14 ============
denominator: 22628.31640625
 Site-MNIST                         | Train Loss: 1.0553 | Train Acc: 0.7951
 Site-MNIST                         | Train Loss: 1.1454 | Train Acc: 0.7471
 Site-USPS                          | Train Loss: 0.9430 | Train Acc: 0.8356
 Site-USPS                          | Train Loss: 0.9400 | Train Acc: 0.8395
 Site-SynthDigits                   | Train Loss: 1.7008 | Train Acc: 0.4933
 Site-SynthDigits                   | Train Loss: 1.6183 | Train Acc: 0.5677
 Site-MNIST_M                       | Train Loss: 1.9132 | Train Acc: 0.4555
 Site-MNIST_M                       | Train Loss: 1.9571 | Train Acc: 0.3749
 Site-SVHN                          | Train Loss: 2.0193 | Train Acc: 0.3261
 Site-SVHN                          | Train Loss: 1.9997 | Train Acc: 0.3076
Average Train Accuracy: 0.5742
 Site-MNIST                         | Val  Loss: 1.1651 | Val  Acc: 0.6739
 Site-MNIST                         | Val  Loss: 1.1586 | Val  Acc: 0.7374
 Site-USPS                          | Val  Loss: 1.0079 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.9937 | Val  Acc: 0.8129
 Site-SynthDigits                   | Val  Loss: 1.6158 | Val  Acc: 0.4891
 Site-SynthDigits                   | Val  Loss: 1.6623 | Val  Acc: 0.5288
 Site-MNIST_M                       | Val  Loss: 1.9714 | Val  Acc: 0.3261
 Site-MNIST_M                       | Val  Loss: 1.9422 | Val  Acc: 0.4065
 Site-SVHN                          | Val  Loss: 1.9565 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 1.9839 | Val  Acc: 0.3381
Average Valid Accuracy: 0.5422
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.6739
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7374
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8129
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.4891
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5288
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.3261
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.4065
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3381
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 15 ============
denominator: 22126.34765625
 Site-MNIST                         | Train Loss: 0.9992 | Train Acc: 0.8059
 Site-MNIST                         | Train Loss: 1.0979 | Train Acc: 0.7659
 Site-USPS                          | Train Loss: 0.9048 | Train Acc: 0.8437
 Site-USPS                          | Train Loss: 0.8995 | Train Acc: 0.8448
 Site-SynthDigits                   | Train Loss: 1.6787 | Train Acc: 0.4960
 Site-SynthDigits                   | Train Loss: 1.5862 | Train Acc: 0.5632
 Site-MNIST_M                       | Train Loss: 1.8948 | Train Acc: 0.4528
 Site-MNIST_M                       | Train Loss: 1.9427 | Train Acc: 0.3785
 Site-SVHN                          | Train Loss: 2.0100 | Train Acc: 0.3288
 Site-SVHN                          | Train Loss: 1.9902 | Train Acc: 0.3004
Average Train Accuracy: 0.5780
 Site-MNIST                         | Val  Loss: 1.1163 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 1.1094 | Val  Acc: 0.7554
 Site-USPS                          | Val  Loss: 0.9706 | Val  Acc: 0.7935
 Site-USPS                          | Val  Loss: 0.9507 | Val  Acc: 0.8129
 Site-SynthDigits                   | Val  Loss: 1.5873 | Val  Acc: 0.4891
 Site-SynthDigits                   | Val  Loss: 1.6318 | Val  Acc: 0.5252
 Site-MNIST_M                       | Val  Loss: 1.9572 | Val  Acc: 0.3370
 Site-MNIST_M                       | Val  Loss: 1.9270 | Val  Acc: 0.4137
 Site-SVHN                          | Val  Loss: 1.9509 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 1.9766 | Val  Acc: 0.3417
Average Valid Accuracy: 0.5479
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.7554
 Best site-USPS                      | Epoch:15 | Val Acc: 0.7935
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8129
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.4891
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.5252
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.3370
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4137
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3417
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 16 ============
denominator: 21778.197265625
 Site-MNIST                         | Train Loss: 0.9618 | Train Acc: 0.8113
 Site-MNIST                         | Train Loss: 1.0509 | Train Acc: 0.7686
 Site-USPS                          | Train Loss: 0.8615 | Train Acc: 0.8437
 Site-USPS                          | Train Loss: 0.8514 | Train Acc: 0.8493
 Site-SynthDigits                   | Train Loss: 1.6525 | Train Acc: 0.5013
 Site-SynthDigits                   | Train Loss: 1.5682 | Train Acc: 0.5704
 Site-MNIST_M                       | Train Loss: 1.8719 | Train Acc: 0.4609
 Site-MNIST_M                       | Train Loss: 1.9181 | Train Acc: 0.3857
 Site-SVHN                          | Train Loss: 2.0023 | Train Acc: 0.3315
 Site-SVHN                          | Train Loss: 1.9800 | Train Acc: 0.3058
Average Train Accuracy: 0.5829
 Site-MNIST                         | Val  Loss: 1.0738 | Val  Acc: 0.7065
 Site-MNIST                         | Val  Loss: 1.0648 | Val  Acc: 0.7590
 Site-USPS                          | Val  Loss: 0.9304 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.9053 | Val  Acc: 0.8237
 Site-SynthDigits                   | Val  Loss: 1.5580 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.6020 | Val  Acc: 0.5324
 Site-MNIST_M                       | Val  Loss: 1.9364 | Val  Acc: 0.3478
 Site-MNIST_M                       | Val  Loss: 1.9055 | Val  Acc: 0.4137
 Site-SVHN                          | Val  Loss: 1.9390 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 1.9658 | Val  Acc: 0.3381
Average Valid Accuracy: 0.5541
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7065
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.7590
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8237
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.5324
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.3478
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.4137
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3381
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 17 ============
denominator: 21503.55078125
 Site-MNIST                         | Train Loss: 0.9195 | Train Acc: 0.8032
 Site-MNIST                         | Train Loss: 1.0187 | Train Acc: 0.7767
 Site-USPS                          | Train Loss: 0.8386 | Train Acc: 0.8410
 Site-USPS                          | Train Loss: 0.8307 | Train Acc: 0.8457
 Site-SynthDigits                   | Train Loss: 1.6111 | Train Acc: 0.5256
 Site-SynthDigits                   | Train Loss: 1.5232 | Train Acc: 0.5910
 Site-MNIST_M                       | Train Loss: 1.8417 | Train Acc: 0.4690
 Site-MNIST_M                       | Train Loss: 1.8900 | Train Acc: 0.3982
 Site-SVHN                          | Train Loss: 1.9820 | Train Acc: 0.3342
 Site-SVHN                          | Train Loss: 1.9524 | Train Acc: 0.3094
Average Train Accuracy: 0.5894
 Site-MNIST                         | Val  Loss: 1.0351 | Val  Acc: 0.7174
 Site-MNIST                         | Val  Loss: 1.0279 | Val  Acc: 0.7626
 Site-USPS                          | Val  Loss: 0.9102 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.8843 | Val  Acc: 0.8273
 Site-SynthDigits                   | Val  Loss: 1.5167 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.5610 | Val  Acc: 0.5504
 Site-MNIST_M                       | Val  Loss: 1.9117 | Val  Acc: 0.3478
 Site-MNIST_M                       | Val  Loss: 1.8706 | Val  Acc: 0.4317
 Site-SVHN                          | Val  Loss: 1.9199 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 1.9423 | Val  Acc: 0.3309
Average Valid Accuracy: 0.5577
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7174
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.7626
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:17 | Val Acc: 0.8273
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.5504
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.3478
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.4317
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3043
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.3309
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 18 ============
denominator: 21257.01953125
 Site-MNIST                         | Train Loss: 0.8869 | Train Acc: 0.8140
 Site-MNIST                         | Train Loss: 0.9787 | Train Acc: 0.7785
 Site-USPS                          | Train Loss: 0.7895 | Train Acc: 0.8491
 Site-USPS                          | Train Loss: 0.7929 | Train Acc: 0.8538
 Site-SynthDigits                   | Train Loss: 1.5870 | Train Acc: 0.5175
 Site-SynthDigits                   | Train Loss: 1.5002 | Train Acc: 0.5865
 Site-MNIST_M                       | Train Loss: 1.8247 | Train Acc: 0.4852
 Site-MNIST_M                       | Train Loss: 1.8703 | Train Acc: 0.4099
 Site-SVHN                          | Train Loss: 1.9773 | Train Acc: 0.3288
 Site-SVHN                          | Train Loss: 1.9519 | Train Acc: 0.3103
Average Train Accuracy: 0.5934
 Site-MNIST                         | Val  Loss: 0.9938 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 0.9859 | Val  Acc: 0.7662
 Site-USPS                          | Val  Loss: 0.8670 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.8363 | Val  Acc: 0.8309
 Site-SynthDigits                   | Val  Loss: 1.4894 | Val  Acc: 0.4783
 Site-SynthDigits                   | Val  Loss: 1.5349 | Val  Acc: 0.5432
 Site-MNIST_M                       | Val  Loss: 1.8925 | Val  Acc: 0.3696
 Site-MNIST_M                       | Val  Loss: 1.8514 | Val  Acc: 0.4424
 Site-SVHN                          | Val  Loss: 1.9155 | Val  Acc: 0.3043
 Site-SVHN                          | Val  Loss: 1.9383 | Val  Acc: 0.3345
Average Valid Accuracy: 0.5569
============ Train epoch 19 ============
denominator: 20943.900390625
 Site-MNIST                         | Train Loss: 0.8515 | Train Acc: 0.8194
 Site-MNIST                         | Train Loss: 0.9482 | Train Acc: 0.7794
 Site-USPS                          | Train Loss: 0.7756 | Train Acc: 0.8518
 Site-USPS                          | Train Loss: 0.7716 | Train Acc: 0.8538
 Site-SynthDigits                   | Train Loss: 1.5608 | Train Acc: 0.5310
 Site-SynthDigits                   | Train Loss: 1.4620 | Train Acc: 0.5946
 Site-MNIST_M                       | Train Loss: 1.7927 | Train Acc: 0.4798
 Site-MNIST_M                       | Train Loss: 1.8592 | Train Acc: 0.4081
 Site-SVHN                          | Train Loss: 1.9673 | Train Acc: 0.3477
 Site-SVHN                          | Train Loss: 1.9341 | Train Acc: 0.3184
Average Train Accuracy: 0.5984
 Site-MNIST                         | Val  Loss: 0.9566 | Val  Acc: 0.6848
 Site-MNIST                         | Val  Loss: 0.9508 | Val  Acc: 0.7662
 Site-USPS                          | Val  Loss: 0.8523 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.8164 | Val  Acc: 0.8345
 Site-SynthDigits                   | Val  Loss: 1.4566 | Val  Acc: 0.4891
 Site-SynthDigits                   | Val  Loss: 1.5034 | Val  Acc: 0.5504
 Site-MNIST_M                       | Val  Loss: 1.8745 | Val  Acc: 0.3587
 Site-MNIST_M                       | Val  Loss: 1.8287 | Val  Acc: 0.4388
 Site-SVHN                          | Val  Loss: 1.8983 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 1.9241 | Val  Acc: 0.3453
Average Valid Accuracy: 0.5598
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.6848
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.7662
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8345
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.4891
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.5504
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.3587
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.4388
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3453
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 20 ============
denominator: 20624.150390625
 Site-MNIST                         | Train Loss: 0.8098 | Train Acc: 0.8248
 Site-MNIST                         | Train Loss: 0.9062 | Train Acc: 0.7883
 Site-USPS                          | Train Loss: 0.7423 | Train Acc: 0.8571
 Site-USPS                          | Train Loss: 0.7339 | Train Acc: 0.8610
 Site-SynthDigits                   | Train Loss: 1.5454 | Train Acc: 0.5337
 Site-SynthDigits                   | Train Loss: 1.4376 | Train Acc: 0.6009
 Site-MNIST_M                       | Train Loss: 1.7726 | Train Acc: 0.4906
 Site-MNIST_M                       | Train Loss: 1.8320 | Train Acc: 0.4152
 Site-SVHN                          | Train Loss: 1.9556 | Train Acc: 0.3477
 Site-SVHN                          | Train Loss: 1.9165 | Train Acc: 0.3130
Average Train Accuracy: 0.6032
 Site-MNIST                         | Val  Loss: 0.9214 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 0.9115 | Val  Acc: 0.7698
 Site-USPS                          | Val  Loss: 0.8219 | Val  Acc: 0.8370
 Site-USPS                          | Val  Loss: 0.7801 | Val  Acc: 0.8417
 Site-SynthDigits                   | Val  Loss: 1.4327 | Val  Acc: 0.5109
 Site-SynthDigits                   | Val  Loss: 1.4843 | Val  Acc: 0.5540
 Site-MNIST_M                       | Val  Loss: 1.8553 | Val  Acc: 0.3696
 Site-MNIST_M                       | Val  Loss: 1.8066 | Val  Acc: 0.4496
 Site-SVHN                          | Val  Loss: 1.8832 | Val  Acc: 0.3152
 Site-SVHN                          | Val  Loss: 1.9093 | Val  Acc: 0.3453
Average Valid Accuracy: 0.5689
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:20 | Val Acc: 0.7698
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8370
 Best site-USPS                      | Epoch:20 | Val Acc: 0.8417
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5109
 Best site-SynthDigits               | Epoch:20 | Val Acc: 0.5540
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.3696
 Best site-MNIST_M                   | Epoch:20 | Val Acc: 0.4496
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3152
 Best site-SVHN                      | Epoch:20 | Val Acc: 0.3453
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 21 ============
denominator: 20368.55078125
 Site-MNIST                         | Train Loss: 0.7923 | Train Acc: 0.8248
 Site-MNIST                         | Train Loss: 0.8752 | Train Acc: 0.7874
 Site-USPS                          | Train Loss: 0.7425 | Train Acc: 0.8437
 Site-USPS                          | Train Loss: 0.7271 | Train Acc: 0.8457
 Site-SynthDigits                   | Train Loss: 1.5085 | Train Acc: 0.5256
 Site-SynthDigits                   | Train Loss: 1.4080 | Train Acc: 0.6081
 Site-MNIST_M                       | Train Loss: 1.7404 | Train Acc: 0.4933
 Site-MNIST_M                       | Train Loss: 1.8112 | Train Acc: 0.4206
 Site-SVHN                          | Train Loss: 1.9352 | Train Acc: 0.3666
 Site-SVHN                          | Train Loss: 1.8928 | Train Acc: 0.3354
Average Train Accuracy: 0.6051
 Site-MNIST                         | Val  Loss: 0.8908 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 0.8824 | Val  Acc: 0.7734
 Site-USPS                          | Val  Loss: 0.8187 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.7763 | Val  Acc: 0.8345
 Site-SynthDigits                   | Val  Loss: 1.3940 | Val  Acc: 0.5326
 Site-SynthDigits                   | Val  Loss: 1.4501 | Val  Acc: 0.5504
 Site-MNIST_M                       | Val  Loss: 1.8384 | Val  Acc: 0.3696
 Site-MNIST_M                       | Val  Loss: 1.7812 | Val  Acc: 0.4676
 Site-SVHN                          | Val  Loss: 1.8476 | Val  Acc: 0.3370
 Site-SVHN                          | Val  Loss: 1.8841 | Val  Acc: 0.3705
Average Valid Accuracy: 0.5757
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:21 | Val Acc: 0.7734
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:21 | Val Acc: 0.8345
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.5326
 Best site-SynthDigits               | Epoch:21 | Val Acc: 0.5504
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.3696
 Best site-MNIST_M                   | Epoch:21 | Val Acc: 0.4676
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.3370
 Best site-SVHN                      | Epoch:21 | Val Acc: 0.3705
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 22 ============
denominator: 20142.73046875
 Site-MNIST                         | Train Loss: 0.7652 | Train Acc: 0.8275
 Site-MNIST                         | Train Loss: 0.8472 | Train Acc: 0.7892
 Site-USPS                          | Train Loss: 0.7229 | Train Acc: 0.8491
 Site-USPS                          | Train Loss: 0.7121 | Train Acc: 0.8448
 Site-SynthDigits                   | Train Loss: 1.4801 | Train Acc: 0.5472
 Site-SynthDigits                   | Train Loss: 1.3773 | Train Acc: 0.6126
 Site-MNIST_M                       | Train Loss: 1.7234 | Train Acc: 0.4987
 Site-MNIST_M                       | Train Loss: 1.7981 | Train Acc: 0.4269
 Site-SVHN                          | Train Loss: 1.9245 | Train Acc: 0.3666
 Site-SVHN                          | Train Loss: 1.8838 | Train Acc: 0.3363
Average Train Accuracy: 0.6099
 Site-MNIST                         | Val  Loss: 0.8620 | Val  Acc: 0.6957
 Site-MNIST                         | Val  Loss: 0.8544 | Val  Acc: 0.7734
 Site-USPS                          | Val  Loss: 0.8017 | Val  Acc: 0.8043
 Site-USPS                          | Val  Loss: 0.7567 | Val  Acc: 0.8309
 Site-SynthDigits                   | Val  Loss: 1.3714 | Val  Acc: 0.5217
 Site-SynthDigits                   | Val  Loss: 1.4222 | Val  Acc: 0.5612
 Site-MNIST_M                       | Val  Loss: 1.8154 | Val  Acc: 0.3696
 Site-MNIST_M                       | Val  Loss: 1.7619 | Val  Acc: 0.4676
 Site-SVHN                          | Val  Loss: 1.8403 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 1.8774 | Val  Acc: 0.3741
Average Valid Accuracy: 0.5768
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.6957
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.7734
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8043
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8309
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.5217
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.5612
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.3696
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.4676
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.3741
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 23 ============
denominator: 19848.419921875
 Site-MNIST                         | Train Loss: 0.7326 | Train Acc: 0.8275
 Site-MNIST                         | Train Loss: 0.8155 | Train Acc: 0.7964
 Site-USPS                          | Train Loss: 0.6861 | Train Acc: 0.8571
 Site-USPS                          | Train Loss: 0.6780 | Train Acc: 0.8538
 Site-SynthDigits                   | Train Loss: 1.4709 | Train Acc: 0.5499
 Site-SynthDigits                   | Train Loss: 1.3614 | Train Acc: 0.6117
 Site-MNIST_M                       | Train Loss: 1.6974 | Train Acc: 0.5013
 Site-MNIST_M                       | Train Loss: 1.7672 | Train Acc: 0.4359
 Site-SVHN                          | Train Loss: 1.9230 | Train Acc: 0.3639
 Site-SVHN                          | Train Loss: 1.8698 | Train Acc: 0.3408
Average Train Accuracy: 0.6138
 Site-MNIST                         | Val  Loss: 0.8319 | Val  Acc: 0.7283
 Site-MNIST                         | Val  Loss: 0.8227 | Val  Acc: 0.7878
 Site-USPS                          | Val  Loss: 0.7742 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.7237 | Val  Acc: 0.8381
 Site-SynthDigits                   | Val  Loss: 1.3499 | Val  Acc: 0.5217
 Site-SynthDigits                   | Val  Loss: 1.4022 | Val  Acc: 0.5719
 Site-MNIST_M                       | Val  Loss: 1.7978 | Val  Acc: 0.3696
 Site-MNIST_M                       | Val  Loss: 1.7403 | Val  Acc: 0.4712
 Site-SVHN                          | Val  Loss: 1.8300 | Val  Acc: 0.3587
 Site-SVHN                          | Val  Loss: 1.8656 | Val  Acc: 0.3669
Average Valid Accuracy: 0.5829
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7283
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.7878
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8381
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.5217
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.5719
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.3696
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.4712
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.3587
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.3669
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 24 ============
denominator: 19675.537109375
 Site-MNIST                         | Train Loss: 0.7122 | Train Acc: 0.8194
 Site-MNIST                         | Train Loss: 0.7896 | Train Acc: 0.7982
 Site-USPS                          | Train Loss: 0.6629 | Train Acc: 0.8625
 Site-USPS                          | Train Loss: 0.6617 | Train Acc: 0.8601
 Site-SynthDigits                   | Train Loss: 1.4456 | Train Acc: 0.5526
 Site-SynthDigits                   | Train Loss: 1.3295 | Train Acc: 0.6215
 Site-MNIST_M                       | Train Loss: 1.6788 | Train Acc: 0.4906
 Site-MNIST_M                       | Train Loss: 1.7656 | Train Acc: 0.4430
 Site-SVHN                          | Train Loss: 1.9097 | Train Acc: 0.3639
 Site-SVHN                          | Train Loss: 1.8600 | Train Acc: 0.3435
Average Train Accuracy: 0.6155
 Site-MNIST                         | Val  Loss: 0.7982 | Val  Acc: 0.7283
 Site-MNIST                         | Val  Loss: 0.7931 | Val  Acc: 0.7842
 Site-USPS                          | Val  Loss: 0.7491 | Val  Acc: 0.8370
 Site-USPS                          | Val  Loss: 0.6964 | Val  Acc: 0.8561
 Site-SynthDigits                   | Val  Loss: 1.3328 | Val  Acc: 0.5326
 Site-SynthDigits                   | Val  Loss: 1.3770 | Val  Acc: 0.5755
 Site-MNIST_M                       | Val  Loss: 1.7840 | Val  Acc: 0.3696
 Site-MNIST_M                       | Val  Loss: 1.7255 | Val  Acc: 0.4748
 Site-SVHN                          | Val  Loss: 1.8165 | Val  Acc: 0.3804
 Site-SVHN                          | Val  Loss: 1.8560 | Val  Acc: 0.3777
Average Valid Accuracy: 0.5916
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7283
 Best site-MNIST                     | Epoch:24 | Val Acc: 0.7842
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8370
 Best site-USPS                      | Epoch:24 | Val Acc: 0.8561
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.5326
 Best site-SynthDigits               | Epoch:24 | Val Acc: 0.5755
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.3696
 Best site-MNIST_M                   | Epoch:24 | Val Acc: 0.4748
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3804
 Best site-SVHN                      | Epoch:24 | Val Acc: 0.3777
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 25 ============
denominator: 19432.361328125
 Site-MNIST                         | Train Loss: 0.6909 | Train Acc: 0.8329
 Site-MNIST                         | Train Loss: 0.7704 | Train Acc: 0.7991
 Site-USPS                          | Train Loss: 0.6653 | Train Acc: 0.8437
 Site-USPS                          | Train Loss: 0.6497 | Train Acc: 0.8448
 Site-SynthDigits                   | Train Loss: 1.4207 | Train Acc: 0.5687
 Site-SynthDigits                   | Train Loss: 1.3042 | Train Acc: 0.6215
 Site-MNIST_M                       | Train Loss: 1.6605 | Train Acc: 0.5094
 Site-MNIST_M                       | Train Loss: 1.7389 | Train Acc: 0.4413
 Site-SVHN                          | Train Loss: 1.8944 | Train Acc: 0.3666
 Site-SVHN                          | Train Loss: 1.8431 | Train Acc: 0.3516
Average Train Accuracy: 0.6180
 Site-MNIST                         | Val  Loss: 0.7701 | Val  Acc: 0.7391
 Site-MNIST                         | Val  Loss: 0.7673 | Val  Acc: 0.7986
 Site-USPS                          | Val  Loss: 0.7497 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.6950 | Val  Acc: 0.8381
 Site-SynthDigits                   | Val  Loss: 1.3062 | Val  Acc: 0.5326
 Site-SynthDigits                   | Val  Loss: 1.3535 | Val  Acc: 0.5755
 Site-MNIST_M                       | Val  Loss: 1.7678 | Val  Acc: 0.3913
 Site-MNIST_M                       | Val  Loss: 1.7111 | Val  Acc: 0.4856
 Site-SVHN                          | Val  Loss: 1.7931 | Val  Acc: 0.3804
 Site-SVHN                          | Val  Loss: 1.8450 | Val  Acc: 0.3885
Average Valid Accuracy: 0.5945
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7391
 Best site-MNIST                     | Epoch:25 | Val Acc: 0.7986
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:25 | Val Acc: 0.8381
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.5326
 Best site-SynthDigits               | Epoch:25 | Val Acc: 0.5755
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.3913
 Best site-MNIST_M                   | Epoch:25 | Val Acc: 0.4856
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.3804
 Best site-SVHN                      | Epoch:25 | Val Acc: 0.3885
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 26 ============
denominator: 19255.185546875
 Site-MNIST                         | Train Loss: 0.6620 | Train Acc: 0.8437
 Site-MNIST                         | Train Loss: 0.7400 | Train Acc: 0.8108
 Site-USPS                          | Train Loss: 0.6271 | Train Acc: 0.8652
 Site-USPS                          | Train Loss: 0.6086 | Train Acc: 0.8637
 Site-SynthDigits                   | Train Loss: 1.3976 | Train Acc: 0.5822
 Site-SynthDigits                   | Train Loss: 1.2876 | Train Acc: 0.6233
 Site-MNIST_M                       | Train Loss: 1.6424 | Train Acc: 0.5121
 Site-MNIST_M                       | Train Loss: 1.7258 | Train Acc: 0.4386
 Site-SVHN                          | Train Loss: 1.8831 | Train Acc: 0.3693
 Site-SVHN                          | Train Loss: 1.8328 | Train Acc: 0.3498
Average Train Accuracy: 0.6259
 Site-MNIST                         | Val  Loss: 0.7463 | Val  Acc: 0.7609
 Site-MNIST                         | Val  Loss: 0.7402 | Val  Acc: 0.8165
 Site-USPS                          | Val  Loss: 0.7168 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.6569 | Val  Acc: 0.8525
 Site-SynthDigits                   | Val  Loss: 1.2942 | Val  Acc: 0.5217
 Site-SynthDigits                   | Val  Loss: 1.3388 | Val  Acc: 0.5719
 Site-MNIST_M                       | Val  Loss: 1.7523 | Val  Acc: 0.4022
 Site-MNIST_M                       | Val  Loss: 1.6950 | Val  Acc: 0.4892
 Site-SVHN                          | Val  Loss: 1.7879 | Val  Acc: 0.3696
 Site-SVHN                          | Val  Loss: 1.8318 | Val  Acc: 0.3777
Average Valid Accuracy: 0.5988
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.7609
 Best site-MNIST                     | Epoch:26 | Val Acc: 0.8165
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:26 | Val Acc: 0.8525
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.5217
 Best site-SynthDigits               | Epoch:26 | Val Acc: 0.5719
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.4022
 Best site-MNIST_M                   | Epoch:26 | Val Acc: 0.4892
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.3696
 Best site-SVHN                      | Epoch:26 | Val Acc: 0.3777
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 27 ============
denominator: 18934.89453125
 Site-MNIST                         | Train Loss: 0.6516 | Train Acc: 0.8383
 Site-MNIST                         | Train Loss: 0.7271 | Train Acc: 0.8117
 Site-USPS                          | Train Loss: 0.6129 | Train Acc: 0.8598
 Site-USPS                          | Train Loss: 0.6029 | Train Acc: 0.8583
 Site-SynthDigits                   | Train Loss: 1.3792 | Train Acc: 0.5768
 Site-SynthDigits                   | Train Loss: 1.2755 | Train Acc: 0.6350
 Site-MNIST_M                       | Train Loss: 1.6111 | Train Acc: 0.5256
 Site-MNIST_M                       | Train Loss: 1.7016 | Train Acc: 0.4601
 Site-SVHN                          | Train Loss: 1.8646 | Train Acc: 0.3935
 Site-SVHN                          | Train Loss: 1.8050 | Train Acc: 0.3587
Average Train Accuracy: 0.6318
 Site-MNIST                         | Val  Loss: 0.7242 | Val  Acc: 0.7717
 Site-MNIST                         | Val  Loss: 0.7140 | Val  Acc: 0.8201
 Site-USPS                          | Val  Loss: 0.6973 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.6357 | Val  Acc: 0.8381
 Site-SynthDigits                   | Val  Loss: 1.2808 | Val  Acc: 0.5326
 Site-SynthDigits                   | Val  Loss: 1.3244 | Val  Acc: 0.5899
 Site-MNIST_M                       | Val  Loss: 1.7354 | Val  Acc: 0.4022
 Site-MNIST_M                       | Val  Loss: 1.6708 | Val  Acc: 0.4964
 Site-SVHN                          | Val  Loss: 1.7496 | Val  Acc: 0.3804
 Site-SVHN                          | Val  Loss: 1.8074 | Val  Acc: 0.3885
Average Valid Accuracy: 0.6046
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.7717
 Best site-MNIST                     | Epoch:27 | Val Acc: 0.8201
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:27 | Val Acc: 0.8381
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5326
 Best site-SynthDigits               | Epoch:27 | Val Acc: 0.5899
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.4022
 Best site-MNIST_M                   | Epoch:27 | Val Acc: 0.4964
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.3804
 Best site-SVHN                      | Epoch:27 | Val Acc: 0.3885
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 28 ============
denominator: 18671.6015625
 Site-MNIST                         | Train Loss: 0.6323 | Train Acc: 0.8410
 Site-MNIST                         | Train Loss: 0.7063 | Train Acc: 0.8117
 Site-USPS                          | Train Loss: 0.5948 | Train Acc: 0.8598
 Site-USPS                          | Train Loss: 0.5702 | Train Acc: 0.8664
 Site-SynthDigits                   | Train Loss: 1.3530 | Train Acc: 0.5795
 Site-SynthDigits                   | Train Loss: 1.2553 | Train Acc: 0.6359
 Site-MNIST_M                       | Train Loss: 1.5965 | Train Acc: 0.5175
 Site-MNIST_M                       | Train Loss: 1.6923 | Train Acc: 0.4520
 Site-SVHN                          | Train Loss: 1.8542 | Train Acc: 0.3908
 Site-SVHN                          | Train Loss: 1.7927 | Train Acc: 0.3659
Average Train Accuracy: 0.6321
 Site-MNIST                         | Val  Loss: 0.7059 | Val  Acc: 0.7717
 Site-MNIST                         | Val  Loss: 0.6959 | Val  Acc: 0.8237
 Site-USPS                          | Val  Loss: 0.6888 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.6226 | Val  Acc: 0.8489
 Site-SynthDigits                   | Val  Loss: 1.2598 | Val  Acc: 0.5326
 Site-SynthDigits                   | Val  Loss: 1.3009 | Val  Acc: 0.5899
 Site-MNIST_M                       | Val  Loss: 1.7269 | Val  Acc: 0.4022
 Site-MNIST_M                       | Val  Loss: 1.6601 | Val  Acc: 0.4892
 Site-SVHN                          | Val  Loss: 1.7408 | Val  Acc: 0.4022
 Site-SVHN                          | Val  Loss: 1.7975 | Val  Acc: 0.3957
Average Valid Accuracy: 0.6082
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.7717
 Best site-MNIST                     | Epoch:28 | Val Acc: 0.8237
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:28 | Val Acc: 0.8489
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.5326
 Best site-SynthDigits               | Epoch:28 | Val Acc: 0.5899
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.4022
 Best site-MNIST_M                   | Epoch:28 | Val Acc: 0.4892
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.4022
 Best site-SVHN                      | Epoch:28 | Val Acc: 0.3957
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 29 ============
denominator: 18527.375
 Site-MNIST                         | Train Loss: 0.6012 | Train Acc: 0.8491
 Site-MNIST                         | Train Loss: 0.6771 | Train Acc: 0.8251
 Site-USPS                          | Train Loss: 0.5615 | Train Acc: 0.8787
 Site-USPS                          | Train Loss: 0.5371 | Train Acc: 0.8780
 Site-SynthDigits                   | Train Loss: 1.3600 | Train Acc: 0.5984
 Site-SynthDigits                   | Train Loss: 1.2449 | Train Acc: 0.6368
 Site-MNIST_M                       | Train Loss: 1.5820 | Train Acc: 0.5229
 Site-MNIST_M                       | Train Loss: 1.6730 | Train Acc: 0.4556
 Site-SVHN                          | Train Loss: 1.8501 | Train Acc: 0.3827
 Site-SVHN                          | Train Loss: 1.7999 | Train Acc: 0.3596
Average Train Accuracy: 0.6387
 Site-MNIST                         | Val  Loss: 0.6799 | Val  Acc: 0.7826
 Site-MNIST                         | Val  Loss: 0.6712 | Val  Acc: 0.8345
 Site-USPS                          | Val  Loss: 0.6623 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.5856 | Val  Acc: 0.8489
 Site-SynthDigits                   | Val  Loss: 1.2549 | Val  Acc: 0.5652
 Site-SynthDigits                   | Val  Loss: 1.2966 | Val  Acc: 0.5971
 Site-MNIST_M                       | Val  Loss: 1.6982 | Val  Acc: 0.4130
 Site-MNIST_M                       | Val  Loss: 1.6451 | Val  Acc: 0.4928
 Site-SVHN                          | Val  Loss: 1.7534 | Val  Acc: 0.3913
 Site-SVHN                          | Val  Loss: 1.7937 | Val  Acc: 0.3957
Average Valid Accuracy: 0.6136
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.7826
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8345
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8489
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5652
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.5971
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.4130
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.4928
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3913
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3957
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 30 ============
denominator: 18490.583984375
 Site-MNIST                         | Train Loss: 0.5951 | Train Acc: 0.8518
 Site-MNIST                         | Train Loss: 0.6707 | Train Acc: 0.8242
 Site-USPS                          | Train Loss: 0.5872 | Train Acc: 0.8598
 Site-USPS                          | Train Loss: 0.5725 | Train Acc: 0.8565
 Site-SynthDigits                   | Train Loss: 1.3242 | Train Acc: 0.6038
 Site-SynthDigits                   | Train Loss: 1.2157 | Train Acc: 0.6413
 Site-MNIST_M                       | Train Loss: 1.5510 | Train Acc: 0.5526
 Site-MNIST_M                       | Train Loss: 1.6567 | Train Acc: 0.4700
 Site-SVHN                          | Train Loss: 1.8361 | Train Acc: 0.3962
 Site-SVHN                          | Train Loss: 1.7764 | Train Acc: 0.3731
Average Train Accuracy: 0.6429
 Site-MNIST                         | Val  Loss: 0.6553 | Val  Acc: 0.8043
 Site-MNIST                         | Val  Loss: 0.6501 | Val  Acc: 0.8381
 Site-USPS                          | Val  Loss: 0.6790 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.6054 | Val  Acc: 0.8345
 Site-SynthDigits                   | Val  Loss: 1.2182 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.2585 | Val  Acc: 0.6079
 Site-MNIST_M                       | Val  Loss: 1.6996 | Val  Acc: 0.4348
 Site-MNIST_M                       | Val  Loss: 1.6269 | Val  Acc: 0.5252
 Site-SVHN                          | Val  Loss: 1.7174 | Val  Acc: 0.4022
 Site-SVHN                          | Val  Loss: 1.7854 | Val  Acc: 0.3957
Average Valid Accuracy: 0.6245
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8043
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8381
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8345
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.5761
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.6079
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.4348
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5252
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.4022
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.3957
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 31 ============
denominator: 18336.515625
 Site-MNIST                         | Train Loss: 0.5832 | Train Acc: 0.8464
 Site-MNIST                         | Train Loss: 0.6525 | Train Acc: 0.8269
 Site-USPS                          | Train Loss: 0.5729 | Train Acc: 0.8571
 Site-USPS                          | Train Loss: 0.5602 | Train Acc: 0.8556
 Site-SynthDigits                   | Train Loss: 1.2978 | Train Acc: 0.6146
 Site-SynthDigits                   | Train Loss: 1.2007 | Train Acc: 0.6511
 Site-MNIST_M                       | Train Loss: 1.5364 | Train Acc: 0.5445
 Site-MNIST_M                       | Train Loss: 1.6392 | Train Acc: 0.4709
 Site-SVHN                          | Train Loss: 1.8191 | Train Acc: 0.3935
 Site-SVHN                          | Train Loss: 1.7579 | Train Acc: 0.3758
Average Train Accuracy: 0.6436
 Site-MNIST                         | Val  Loss: 0.6442 | Val  Acc: 0.8043
 Site-MNIST                         | Val  Loss: 0.6395 | Val  Acc: 0.8489
 Site-USPS                          | Val  Loss: 0.6746 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.5975 | Val  Acc: 0.8309
 Site-SynthDigits                   | Val  Loss: 1.2070 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.2432 | Val  Acc: 0.6223
 Site-MNIST_M                       | Val  Loss: 1.6818 | Val  Acc: 0.4565
 Site-MNIST_M                       | Val  Loss: 1.6082 | Val  Acc: 0.5252
 Site-SVHN                          | Val  Loss: 1.7025 | Val  Acc: 0.4022
 Site-SVHN                          | Val  Loss: 1.7749 | Val  Acc: 0.3957
Average Valid Accuracy: 0.6288
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8043
 Best site-MNIST                     | Epoch:31 | Val Acc: 0.8489
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:31 | Val Acc: 0.8309
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:31 | Val Acc: 0.6223
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.4565
 Best site-MNIST_M                   | Epoch:31 | Val Acc: 0.5252
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.4022
 Best site-SVHN                      | Epoch:31 | Val Acc: 0.3957
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 32 ============
denominator: 18084.59765625
 Site-MNIST                         | Train Loss: 0.5639 | Train Acc: 0.8598
 Site-MNIST                         | Train Loss: 0.6299 | Train Acc: 0.8368
 Site-USPS                          | Train Loss: 0.5375 | Train Acc: 0.8598
 Site-USPS                          | Train Loss: 0.5182 | Train Acc: 0.8744
 Site-SynthDigits                   | Train Loss: 1.2855 | Train Acc: 0.6146
 Site-SynthDigits                   | Train Loss: 1.1971 | Train Acc: 0.6466
 Site-MNIST_M                       | Train Loss: 1.5262 | Train Acc: 0.5580
 Site-MNIST_M                       | Train Loss: 1.6168 | Train Acc: 0.4726
 Site-SVHN                          | Train Loss: 1.8150 | Train Acc: 0.3989
 Site-SVHN                          | Train Loss: 1.7575 | Train Acc: 0.3794
Average Train Accuracy: 0.6501
 Site-MNIST                         | Val  Loss: 0.6201 | Val  Acc: 0.8152
 Site-MNIST                         | Val  Loss: 0.6136 | Val  Acc: 0.8489
 Site-USPS                          | Val  Loss: 0.6421 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.5584 | Val  Acc: 0.8525
 Site-SynthDigits                   | Val  Loss: 1.2051 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.2352 | Val  Acc: 0.6187
 Site-MNIST_M                       | Val  Loss: 1.6624 | Val  Acc: 0.4565
 Site-MNIST_M                       | Val  Loss: 1.5978 | Val  Acc: 0.5252
 Site-SVHN                          | Val  Loss: 1.7062 | Val  Acc: 0.3804
 Site-SVHN                          | Val  Loss: 1.7683 | Val  Acc: 0.4065
Average Valid Accuracy: 0.6317
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8152
 Best site-MNIST                     | Epoch:32 | Val Acc: 0.8489
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:32 | Val Acc: 0.8525
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:32 | Val Acc: 0.6187
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.4565
 Best site-MNIST_M                   | Epoch:32 | Val Acc: 0.5252
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.3804
 Best site-SVHN                      | Epoch:32 | Val Acc: 0.4065
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 33 ============
denominator: 17943.09765625
 Site-MNIST                         | Train Loss: 0.5478 | Train Acc: 0.8652
 Site-MNIST                         | Train Loss: 0.6138 | Train Acc: 0.8475
 Site-USPS                          | Train Loss: 0.5269 | Train Acc: 0.8598
 Site-USPS                          | Train Loss: 0.4986 | Train Acc: 0.8807
 Site-SynthDigits                   | Train Loss: 1.2756 | Train Acc: 0.6199
 Site-SynthDigits                   | Train Loss: 1.1868 | Train Acc: 0.6493
 Site-MNIST_M                       | Train Loss: 1.5090 | Train Acc: 0.5553
 Site-MNIST_M                       | Train Loss: 1.6112 | Train Acc: 0.4771
 Site-SVHN                          | Train Loss: 1.8064 | Train Acc: 0.4016
 Site-SVHN                          | Train Loss: 1.7549 | Train Acc: 0.3794
Average Train Accuracy: 0.6536
 Site-MNIST                         | Val  Loss: 0.6014 | Val  Acc: 0.8152
 Site-MNIST                         | Val  Loss: 0.5964 | Val  Acc: 0.8525
 Site-USPS                          | Val  Loss: 0.6297 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.5441 | Val  Acc: 0.8525
 Site-SynthDigits                   | Val  Loss: 1.1958 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.2196 | Val  Acc: 0.6259
 Site-MNIST_M                       | Val  Loss: 1.6483 | Val  Acc: 0.4565
 Site-MNIST_M                       | Val  Loss: 1.5825 | Val  Acc: 0.5252
 Site-SVHN                          | Val  Loss: 1.6950 | Val  Acc: 0.3804
 Site-SVHN                          | Val  Loss: 1.7621 | Val  Acc: 0.4101
Average Valid Accuracy: 0.6331
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8152
 Best site-MNIST                     | Epoch:33 | Val Acc: 0.8525
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:33 | Val Acc: 0.8525
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:33 | Val Acc: 0.6259
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.4565
 Best site-MNIST_M                   | Epoch:33 | Val Acc: 0.5252
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.3804
 Best site-SVHN                      | Epoch:33 | Val Acc: 0.4101
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 34 ============
denominator: 17721.783203125
 Site-MNIST                         | Train Loss: 0.5259 | Train Acc: 0.8652
 Site-MNIST                         | Train Loss: 0.5969 | Train Acc: 0.8502
 Site-USPS                          | Train Loss: 0.5157 | Train Acc: 0.8625
 Site-USPS                          | Train Loss: 0.4980 | Train Acc: 0.8816
 Site-SynthDigits                   | Train Loss: 1.2695 | Train Acc: 0.6173
 Site-SynthDigits                   | Train Loss: 1.1704 | Train Acc: 0.6547
 Site-MNIST_M                       | Train Loss: 1.5079 | Train Acc: 0.5553
 Site-MNIST_M                       | Train Loss: 1.5983 | Train Acc: 0.4771
 Site-SVHN                          | Train Loss: 1.7908 | Train Acc: 0.4016
 Site-SVHN                          | Train Loss: 1.7487 | Train Acc: 0.3785
Average Train Accuracy: 0.6544
 Site-MNIST                         | Val  Loss: 0.5869 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.5819 | Val  Acc: 0.8669
 Site-USPS                          | Val  Loss: 0.6229 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.5365 | Val  Acc: 0.8525
 Site-SynthDigits                   | Val  Loss: 1.1747 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.2003 | Val  Acc: 0.6295
 Site-MNIST_M                       | Val  Loss: 1.6274 | Val  Acc: 0.4565
 Site-MNIST_M                       | Val  Loss: 1.5706 | Val  Acc: 0.5324
 Site-SVHN                          | Val  Loss: 1.6897 | Val  Acc: 0.3804
 Site-SVHN                          | Val  Loss: 1.7575 | Val  Acc: 0.4065
Average Valid Accuracy: 0.6386
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.8478
 Best site-MNIST                     | Epoch:34 | Val Acc: 0.8669
 Best site-USPS                      | Epoch:34 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:34 | Val Acc: 0.8525
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:34 | Val Acc: 0.6295
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.4565
 Best site-MNIST_M                   | Epoch:34 | Val Acc: 0.5324
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.3804
 Best site-SVHN                      | Epoch:34 | Val Acc: 0.4065
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 35 ============
denominator: 17633.765625
 Site-MNIST                         | Train Loss: 0.5209 | Train Acc: 0.8706
 Site-MNIST                         | Train Loss: 0.5887 | Train Acc: 0.8520
 Site-USPS                          | Train Loss: 0.5121 | Train Acc: 0.8625
 Site-USPS                          | Train Loss: 0.4872 | Train Acc: 0.8816
 Site-SynthDigits                   | Train Loss: 1.2516 | Train Acc: 0.6253
 Site-SynthDigits                   | Train Loss: 1.1734 | Train Acc: 0.6556
 Site-MNIST_M                       | Train Loss: 1.4855 | Train Acc: 0.5660
 Site-MNIST_M                       | Train Loss: 1.5822 | Train Acc: 0.4834
 Site-SVHN                          | Train Loss: 1.7781 | Train Acc: 0.4016
 Site-SVHN                          | Train Loss: 1.7401 | Train Acc: 0.3812
Average Train Accuracy: 0.6580
 Site-MNIST                         | Val  Loss: 0.5669 | Val  Acc: 0.8478
 Site-MNIST                         | Val  Loss: 0.5607 | Val  Acc: 0.8669
 Site-USPS                          | Val  Loss: 0.6081 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.5237 | Val  Acc: 0.8561
 Site-SynthDigits                   | Val  Loss: 1.1699 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.1943 | Val  Acc: 0.6259
 Site-MNIST_M                       | Val  Loss: 1.6148 | Val  Acc: 0.4565
 Site-MNIST_M                       | Val  Loss: 1.5544 | Val  Acc: 0.5288
 Site-SVHN                          | Val  Loss: 1.6665 | Val  Acc: 0.3804
 Site-SVHN                          | Val  Loss: 1.7449 | Val  Acc: 0.3993
Average Valid Accuracy: 0.6364
============ Train epoch 36 ============
denominator: 17320.59765625
 Site-MNIST                         | Train Loss: 0.5118 | Train Acc: 0.8706
 Site-MNIST                         | Train Loss: 0.5767 | Train Acc: 0.8493
 Site-USPS                          | Train Loss: 0.5225 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.4964 | Train Acc: 0.8771
 Site-SynthDigits                   | Train Loss: 1.2278 | Train Acc: 0.6199
 Site-SynthDigits                   | Train Loss: 1.1397 | Train Acc: 0.6583
 Site-MNIST_M                       | Train Loss: 1.4638 | Train Acc: 0.5687
 Site-MNIST_M                       | Train Loss: 1.5644 | Train Acc: 0.4852
 Site-SVHN                          | Train Loss: 1.7679 | Train Acc: 0.4016
 Site-SVHN                          | Train Loss: 1.7218 | Train Acc: 0.3946
Average Train Accuracy: 0.6596
 Site-MNIST                         | Val  Loss: 0.5562 | Val  Acc: 0.8370
 Site-MNIST                         | Val  Loss: 0.5515 | Val  Acc: 0.8633
 Site-USPS                          | Val  Loss: 0.6209 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.5327 | Val  Acc: 0.8561
 Site-SynthDigits                   | Val  Loss: 1.1473 | Val  Acc: 0.5870
 Site-SynthDigits                   | Val  Loss: 1.1706 | Val  Acc: 0.6223
 Site-MNIST_M                       | Val  Loss: 1.6026 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.5402 | Val  Acc: 0.5468
 Site-SVHN                          | Val  Loss: 1.6538 | Val  Acc: 0.4022
 Site-SVHN                          | Val  Loss: 1.7328 | Val  Acc: 0.4137
Average Valid Accuracy: 0.6454
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.8370
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.8633
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8561
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.5870
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.6223
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.5468
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.4022
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.4137
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 37 ============
denominator: 17196.64453125
 Site-MNIST                         | Train Loss: 0.5096 | Train Acc: 0.8733
 Site-MNIST                         | Train Loss: 0.5717 | Train Acc: 0.8484
 Site-USPS                          | Train Loss: 0.5021 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.4813 | Train Acc: 0.8816
 Site-SynthDigits                   | Train Loss: 1.2142 | Train Acc: 0.6173
 Site-SynthDigits                   | Train Loss: 1.1362 | Train Acc: 0.6565
 Site-MNIST_M                       | Train Loss: 1.4472 | Train Acc: 0.5714
 Site-MNIST_M                       | Train Loss: 1.5556 | Train Acc: 0.4978
 Site-SVHN                          | Train Loss: 1.7546 | Train Acc: 0.3989
 Site-SVHN                          | Train Loss: 1.7122 | Train Acc: 0.4036
Average Train Accuracy: 0.6619
 Site-MNIST                         | Val  Loss: 0.5354 | Val  Acc: 0.8370
 Site-MNIST                         | Val  Loss: 0.5379 | Val  Acc: 0.8561
 Site-USPS                          | Val  Loss: 0.6077 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.5173 | Val  Acc: 0.8561
 Site-SynthDigits                   | Val  Loss: 1.1500 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.1628 | Val  Acc: 0.6295
 Site-MNIST_M                       | Val  Loss: 1.5903 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.5273 | Val  Acc: 0.5540
 Site-SVHN                          | Val  Loss: 1.6457 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.7238 | Val  Acc: 0.4173
Average Valid Accuracy: 0.6465
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8370
 Best site-MNIST                     | Epoch:37 | Val Acc: 0.8561
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:37 | Val Acc: 0.8561
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.5761
 Best site-SynthDigits               | Epoch:37 | Val Acc: 0.6295
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:37 | Val Acc: 0.5540
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:37 | Val Acc: 0.4173
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 38 ============
denominator: 17123.58203125
 Site-MNIST                         | Train Loss: 0.4873 | Train Acc: 0.8733
 Site-MNIST                         | Train Loss: 0.5502 | Train Acc: 0.8610
 Site-USPS                          | Train Loss: 0.4796 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.4557 | Train Acc: 0.8888
 Site-SynthDigits                   | Train Loss: 1.2145 | Train Acc: 0.6253
 Site-SynthDigits                   | Train Loss: 1.1376 | Train Acc: 0.6646
 Site-MNIST_M                       | Train Loss: 1.4325 | Train Acc: 0.5768
 Site-MNIST_M                       | Train Loss: 1.5322 | Train Acc: 0.5139
 Site-SVHN                          | Train Loss: 1.7443 | Train Acc: 0.3962
 Site-SVHN                          | Train Loss: 1.7078 | Train Acc: 0.4009
Average Train Accuracy: 0.6671
 Site-MNIST                         | Val  Loss: 0.5219 | Val  Acc: 0.8804
 Site-MNIST                         | Val  Loss: 0.5174 | Val  Acc: 0.8813
 Site-USPS                          | Val  Loss: 0.5831 | Val  Acc: 0.8370
 Site-USPS                          | Val  Loss: 0.4948 | Val  Acc: 0.8597
 Site-SynthDigits                   | Val  Loss: 1.1452 | Val  Acc: 0.5652
 Site-SynthDigits                   | Val  Loss: 1.1626 | Val  Acc: 0.6295
 Site-MNIST_M                       | Val  Loss: 1.5554 | Val  Acc: 0.5109
 Site-MNIST_M                       | Val  Loss: 1.5020 | Val  Acc: 0.5576
 Site-SVHN                          | Val  Loss: 1.6327 | Val  Acc: 0.4022
 Site-SVHN                          | Val  Loss: 1.7128 | Val  Acc: 0.4101
Average Valid Accuracy: 0.6534
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.8804
 Best site-MNIST                     | Epoch:38 | Val Acc: 0.8813
 Best site-USPS                      | Epoch:38 | Val Acc: 0.8370
 Best site-USPS                      | Epoch:38 | Val Acc: 0.8597
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.5652
 Best site-SynthDigits               | Epoch:38 | Val Acc: 0.6295
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.5109
 Best site-MNIST_M                   | Epoch:38 | Val Acc: 0.5576
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.4022
 Best site-SVHN                      | Epoch:38 | Val Acc: 0.4101
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 39 ============
denominator: 17093.443359375
 Site-MNIST                         | Train Loss: 0.4745 | Train Acc: 0.8895
 Site-MNIST                         | Train Loss: 0.5430 | Train Acc: 0.8637
 Site-USPS                          | Train Loss: 0.4773 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.4537 | Train Acc: 0.8879
 Site-SynthDigits                   | Train Loss: 1.2051 | Train Acc: 0.6334
 Site-SynthDigits                   | Train Loss: 1.1198 | Train Acc: 0.6628
 Site-MNIST_M                       | Train Loss: 1.4215 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.5313 | Train Acc: 0.5049
 Site-SVHN                          | Train Loss: 1.7373 | Train Acc: 0.3989
 Site-SVHN                          | Train Loss: 1.7090 | Train Acc: 0.4000
Average Train Accuracy: 0.6691
 Site-MNIST                         | Val  Loss: 0.5147 | Val  Acc: 0.8587
 Site-MNIST                         | Val  Loss: 0.5096 | Val  Acc: 0.8813
 Site-USPS                          | Val  Loss: 0.5892 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.4949 | Val  Acc: 0.8597
 Site-SynthDigits                   | Val  Loss: 1.1437 | Val  Acc: 0.5652
 Site-SynthDigits                   | Val  Loss: 1.1449 | Val  Acc: 0.6367
 Site-MNIST_M                       | Val  Loss: 1.5628 | Val  Acc: 0.5217
 Site-MNIST_M                       | Val  Loss: 1.5029 | Val  Acc: 0.5612
 Site-SVHN                          | Val  Loss: 1.6285 | Val  Acc: 0.4022
 Site-SVHN                          | Val  Loss: 1.7019 | Val  Acc: 0.4137
Average Valid Accuracy: 0.6526
============ Train epoch 40 ============
denominator: 17007.7421875
 Site-MNIST                         | Train Loss: 0.4918 | Train Acc: 0.8706
 Site-MNIST                         | Train Loss: 0.5425 | Train Acc: 0.8592
 Site-USPS                          | Train Loss: 0.5099 | Train Acc: 0.8679
 Site-USPS                          | Train Loss: 0.4868 | Train Acc: 0.8744
 Site-SynthDigits                   | Train Loss: 1.1717 | Train Acc: 0.6280
 Site-SynthDigits                   | Train Loss: 1.0899 | Train Acc: 0.6753
 Site-MNIST_M                       | Train Loss: 1.4213 | Train Acc: 0.5660
 Site-MNIST_M                       | Train Loss: 1.5282 | Train Acc: 0.5067
 Site-SVHN                          | Train Loss: 1.7250 | Train Acc: 0.4124
 Site-SVHN                          | Train Loss: 1.6872 | Train Acc: 0.4081
Average Train Accuracy: 0.6669
 Site-MNIST                         | Val  Loss: 0.4967 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.5076 | Val  Acc: 0.8633
 Site-USPS                          | Val  Loss: 0.6248 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.5257 | Val  Acc: 0.8525
 Site-SynthDigits                   | Val  Loss: 1.1067 | Val  Acc: 0.6087
 Site-SynthDigits                   | Val  Loss: 1.1210 | Val  Acc: 0.6547
 Site-MNIST_M                       | Val  Loss: 1.5662 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.4942 | Val  Acc: 0.5576
 Site-SVHN                          | Val  Loss: 1.6138 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.6975 | Val  Acc: 0.4029
Average Valid Accuracy: 0.6559
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.8913
 Best site-MNIST                     | Epoch:40 | Val Acc: 0.8633
 Best site-USPS                      | Epoch:40 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:40 | Val Acc: 0.8525
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.6087
 Best site-SynthDigits               | Epoch:40 | Val Acc: 0.6547
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:40 | Val Acc: 0.5576
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:40 | Val Acc: 0.4029
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 41 ============
denominator: 16807.86328125
 Site-MNIST                         | Train Loss: 0.4639 | Train Acc: 0.8814
 Site-MNIST                         | Train Loss: 0.5260 | Train Acc: 0.8646
 Site-USPS                          | Train Loss: 0.4759 | Train Acc: 0.8706
 Site-USPS                          | Train Loss: 0.4468 | Train Acc: 0.8870
 Site-SynthDigits                   | Train Loss: 1.1694 | Train Acc: 0.6226
 Site-SynthDigits                   | Train Loss: 1.0991 | Train Acc: 0.6771
 Site-MNIST_M                       | Train Loss: 1.3982 | Train Acc: 0.5714
 Site-MNIST_M                       | Train Loss: 1.5174 | Train Acc: 0.5103
 Site-SVHN                          | Train Loss: 1.7121 | Train Acc: 0.4232
 Site-SVHN                          | Train Loss: 1.6953 | Train Acc: 0.4054
Average Train Accuracy: 0.6714
 Site-MNIST                         | Val  Loss: 0.4939 | Val  Acc: 0.8804
 Site-MNIST                         | Val  Loss: 0.4946 | Val  Acc: 0.8885
 Site-USPS                          | Val  Loss: 0.5887 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.4903 | Val  Acc: 0.8597
 Site-SynthDigits                   | Val  Loss: 1.1077 | Val  Acc: 0.5978
 Site-SynthDigits                   | Val  Loss: 1.1161 | Val  Acc: 0.6439
 Site-MNIST_M                       | Val  Loss: 1.5486 | Val  Acc: 0.5217
 Site-MNIST_M                       | Val  Loss: 1.4849 | Val  Acc: 0.5647
 Site-SVHN                          | Val  Loss: 1.6100 | Val  Acc: 0.3913
 Site-SVHN                          | Val  Loss: 1.6864 | Val  Acc: 0.4137
Average Valid Accuracy: 0.6588
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.8804
 Best site-MNIST                     | Epoch:41 | Val Acc: 0.8885
 Best site-USPS                      | Epoch:41 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:41 | Val Acc: 0.8597
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.5978
 Best site-SynthDigits               | Epoch:41 | Val Acc: 0.6439
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5217
 Best site-MNIST_M                   | Epoch:41 | Val Acc: 0.5647
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.3913
 Best site-SVHN                      | Epoch:41 | Val Acc: 0.4137
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 42 ============
denominator: 16852.818359375
 Site-MNIST                         | Train Loss: 0.4552 | Train Acc: 0.8760
 Site-MNIST                         | Train Loss: 0.5174 | Train Acc: 0.8682
 Site-USPS                          | Train Loss: 0.4466 | Train Acc: 0.8868
 Site-USPS                          | Train Loss: 0.4207 | Train Acc: 0.8951
 Site-SynthDigits                   | Train Loss: 1.1704 | Train Acc: 0.6334
 Site-SynthDigits                   | Train Loss: 1.0973 | Train Acc: 0.6726
 Site-MNIST_M                       | Train Loss: 1.3924 | Train Acc: 0.5876
 Site-MNIST_M                       | Train Loss: 1.4952 | Train Acc: 0.5139
 Site-SVHN                          | Train Loss: 1.7215 | Train Acc: 0.4205
 Site-SVHN                          | Train Loss: 1.6887 | Train Acc: 0.4081
Average Train Accuracy: 0.6762
 Site-MNIST                         | Val  Loss: 0.4858 | Val  Acc: 0.8804
 Site-MNIST                         | Val  Loss: 0.4828 | Val  Acc: 0.8813
 Site-USPS                          | Val  Loss: 0.5623 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.4645 | Val  Acc: 0.8669
 Site-SynthDigits                   | Val  Loss: 1.1117 | Val  Acc: 0.5978
 Site-SynthDigits                   | Val  Loss: 1.1180 | Val  Acc: 0.6403
 Site-MNIST_M                       | Val  Loss: 1.5219 | Val  Acc: 0.5109
 Site-MNIST_M                       | Val  Loss: 1.4697 | Val  Acc: 0.5683
 Site-SVHN                          | Val  Loss: 1.6107 | Val  Acc: 0.4130
 Site-SVHN                          | Val  Loss: 1.6800 | Val  Acc: 0.4245
Average Valid Accuracy: 0.6610
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8804
 Best site-MNIST                     | Epoch:42 | Val Acc: 0.8813
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:42 | Val Acc: 0.8669
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.5978
 Best site-SynthDigits               | Epoch:42 | Val Acc: 0.6403
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.5109
 Best site-MNIST_M                   | Epoch:42 | Val Acc: 0.5683
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.4130
 Best site-SVHN                      | Epoch:42 | Val Acc: 0.4245
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 43 ============
denominator: 16676.13671875
 Site-MNIST                         | Train Loss: 0.4638 | Train Acc: 0.8598
 Site-MNIST                         | Train Loss: 0.5214 | Train Acc: 0.8601
 Site-USPS                          | Train Loss: 0.4850 | Train Acc: 0.8814
 Site-USPS                          | Train Loss: 0.4634 | Train Acc: 0.8807
 Site-SynthDigits                   | Train Loss: 1.1386 | Train Acc: 0.6334
 Site-SynthDigits                   | Train Loss: 1.0677 | Train Acc: 0.6762
 Site-MNIST_M                       | Train Loss: 1.3770 | Train Acc: 0.5687
 Site-MNIST_M                       | Train Loss: 1.4849 | Train Acc: 0.5202
 Site-SVHN                          | Train Loss: 1.7013 | Train Acc: 0.4313
 Site-SVHN                          | Train Loss: 1.6602 | Train Acc: 0.4323
Average Train Accuracy: 0.6744
 Site-MNIST                         | Val  Loss: 0.4636 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.4773 | Val  Acc: 0.8633
 Site-USPS                          | Val  Loss: 0.6059 | Val  Acc: 0.8152
 Site-USPS                          | Val  Loss: 0.5017 | Val  Acc: 0.8597
 Site-SynthDigits                   | Val  Loss: 1.0757 | Val  Acc: 0.6196
 Site-SynthDigits                   | Val  Loss: 1.0876 | Val  Acc: 0.6691
 Site-MNIST_M                       | Val  Loss: 1.5156 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.4582 | Val  Acc: 0.5791
 Site-SVHN                          | Val  Loss: 1.5869 | Val  Acc: 0.4348
 Site-SVHN                          | Val  Loss: 1.6745 | Val  Acc: 0.4317
Average Valid Accuracy: 0.6707
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8913
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8633
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8152
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8597
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.6196
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.6691
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.5435
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.5791
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.4348
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.4317
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 44 ============
denominator: 16484.91796875
 Site-MNIST                         | Train Loss: 0.4481 | Train Acc: 0.8706
 Site-MNIST                         | Train Loss: 0.4994 | Train Acc: 0.8682
 Site-USPS                          | Train Loss: 0.4599 | Train Acc: 0.8868
 Site-USPS                          | Train Loss: 0.4313 | Train Acc: 0.8933
 Site-SynthDigits                   | Train Loss: 1.1378 | Train Acc: 0.6361
 Site-SynthDigits                   | Train Loss: 1.0701 | Train Acc: 0.6744
 Site-MNIST_M                       | Train Loss: 1.3564 | Train Acc: 0.5795
 Site-MNIST_M                       | Train Loss: 1.4682 | Train Acc: 0.5247
 Site-SVHN                          | Train Loss: 1.6837 | Train Acc: 0.4367
 Site-SVHN                          | Train Loss: 1.6671 | Train Acc: 0.4197
Average Train Accuracy: 0.6790
 Site-MNIST                         | Val  Loss: 0.4527 | Val  Acc: 0.9022
 Site-MNIST                         | Val  Loss: 0.4601 | Val  Acc: 0.8813
 Site-USPS                          | Val  Loss: 0.5765 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.4722 | Val  Acc: 0.8777
 Site-SynthDigits                   | Val  Loss: 1.0819 | Val  Acc: 0.5978
 Site-SynthDigits                   | Val  Loss: 1.0913 | Val  Acc: 0.6511
 Site-MNIST_M                       | Val  Loss: 1.4961 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.4439 | Val  Acc: 0.5791
 Site-SVHN                          | Val  Loss: 1.5864 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.6609 | Val  Acc: 0.4496
Average Valid Accuracy: 0.6754
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9022
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8813
 Best site-USPS                      | Epoch:44 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:44 | Val Acc: 0.8777
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.5978
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.6511
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.5435
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.5791
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.4457
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.4496
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 45 ============
denominator: 16416.033203125
 Site-MNIST                         | Train Loss: 0.4324 | Train Acc: 0.8787
 Site-MNIST                         | Train Loss: 0.4791 | Train Acc: 0.8753
 Site-USPS                          | Train Loss: 0.4463 | Train Acc: 0.8922
 Site-USPS                          | Train Loss: 0.4290 | Train Acc: 0.8897
 Site-SynthDigits                   | Train Loss: 1.1303 | Train Acc: 0.6577
 Site-SynthDigits                   | Train Loss: 1.0644 | Train Acc: 0.6762
 Site-MNIST_M                       | Train Loss: 1.3370 | Train Acc: 0.5822
 Site-MNIST_M                       | Train Loss: 1.4576 | Train Acc: 0.5390
 Site-SVHN                          | Train Loss: 1.6892 | Train Acc: 0.4286
 Site-SVHN                          | Train Loss: 1.6549 | Train Acc: 0.4251
Average Train Accuracy: 0.6845
 Site-MNIST                         | Val  Loss: 0.4435 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.4505 | Val  Acc: 0.8813
 Site-USPS                          | Val  Loss: 0.5709 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.4660 | Val  Acc: 0.8741
 Site-SynthDigits                   | Val  Loss: 1.0744 | Val  Acc: 0.6087
 Site-SynthDigits                   | Val  Loss: 1.0831 | Val  Acc: 0.6583
 Site-MNIST_M                       | Val  Loss: 1.4809 | Val  Acc: 0.5978
 Site-MNIST_M                       | Val  Loss: 1.4291 | Val  Acc: 0.6079
 Site-SVHN                          | Val  Loss: 1.5847 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.6601 | Val  Acc: 0.4460
Average Valid Accuracy: 0.6837
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.8913
 Best site-MNIST                     | Epoch:45 | Val Acc: 0.8813
 Best site-USPS                      | Epoch:45 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:45 | Val Acc: 0.8741
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.6087
 Best site-SynthDigits               | Epoch:45 | Val Acc: 0.6583
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.5978
 Best site-MNIST_M                   | Epoch:45 | Val Acc: 0.6079
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.4457
 Best site-SVHN                      | Epoch:45 | Val Acc: 0.4460
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
============ Train epoch 46 ============
denominator: 16316.283203125
 Site-MNIST                         | Train Loss: 0.4326 | Train Acc: 0.8760
 Site-MNIST                         | Train Loss: 0.4727 | Train Acc: 0.8735
 Site-USPS                          | Train Loss: 0.4355 | Train Acc: 0.8922
 Site-USPS                          | Train Loss: 0.4088 | Train Acc: 0.8951
 Site-SynthDigits                   | Train Loss: 1.1140 | Train Acc: 0.6442
 Site-SynthDigits                   | Train Loss: 1.0513 | Train Acc: 0.6753
 Site-MNIST_M                       | Train Loss: 1.3292 | Train Acc: 0.5849
 Site-MNIST_M                       | Train Loss: 1.4511 | Train Acc: 0.5426
 Site-SVHN                          | Train Loss: 1.6808 | Train Acc: 0.4367
 Site-SVHN                          | Train Loss: 1.6463 | Train Acc: 0.4269
Average Train Accuracy: 0.6847
 Site-MNIST                         | Val  Loss: 0.4350 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.4427 | Val  Acc: 0.8813
 Site-USPS                          | Val  Loss: 0.5555 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.4521 | Val  Acc: 0.8741
 Site-SynthDigits                   | Val  Loss: 1.0634 | Val  Acc: 0.5978
 Site-SynthDigits                   | Val  Loss: 1.0668 | Val  Acc: 0.6547
 Site-MNIST_M                       | Val  Loss: 1.4655 | Val  Acc: 0.5761
 Site-MNIST_M                       | Val  Loss: 1.4164 | Val  Acc: 0.5935
 Site-SVHN                          | Val  Loss: 1.5857 | Val  Acc: 0.4457
 Site-SVHN                          | Val  Loss: 1.6575 | Val  Acc: 0.4460
Average Valid Accuracy: 0.6787
============ Train epoch 47 ============
denominator: 16187.296875
 Site-MNIST                         | Train Loss: 0.4049 | Train Acc: 0.8733
 Site-MNIST                         | Train Loss: 0.4588 | Train Acc: 0.8825
 Site-USPS                          | Train Loss: 0.4088 | Train Acc: 0.8949
 Site-USPS                          | Train Loss: 0.3810 | Train Acc: 0.9076
 Site-SynthDigits                   | Train Loss: 1.1395 | Train Acc: 0.6442
 Site-SynthDigits                   | Train Loss: 1.0600 | Train Acc: 0.6682
 Site-MNIST_M                       | Train Loss: 1.3261 | Train Acc: 0.5957
 Site-MNIST_M                       | Train Loss: 1.4421 | Train Acc: 0.5354
 Site-SVHN                          | Train Loss: 1.6936 | Train Acc: 0.4313
 Site-SVHN                          | Train Loss: 1.6599 | Train Acc: 0.4179
Average Train Accuracy: 0.6851
 Site-MNIST                         | Val  Loss: 0.4270 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.4282 | Val  Acc: 0.8921
 Site-USPS                          | Val  Loss: 0.5347 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.4318 | Val  Acc: 0.8777
 Site-SynthDigits                   | Val  Loss: 1.0742 | Val  Acc: 0.5761
 Site-SynthDigits                   | Val  Loss: 1.0726 | Val  Acc: 0.6511
 Site-MNIST_M                       | Val  Loss: 1.4448 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.4072 | Val  Acc: 0.5863
 Site-SVHN                          | Val  Loss: 1.5874 | Val  Acc: 0.4239
 Site-SVHN                          | Val  Loss: 1.6566 | Val  Acc: 0.4424
Average Valid Accuracy: 0.6711
============ Train epoch 48 ============
denominator: 16203.3349609375
 Site-MNIST                         | Train Loss: 0.3979 | Train Acc: 0.8868
 Site-MNIST                         | Train Loss: 0.4567 | Train Acc: 0.8843
 Site-USPS                          | Train Loss: 0.3958 | Train Acc: 0.8976
 Site-USPS                          | Train Loss: 0.3776 | Train Acc: 0.9085
 Site-SynthDigits                   | Train Loss: 1.1204 | Train Acc: 0.6523
 Site-SynthDigits                   | Train Loss: 1.0556 | Train Acc: 0.6735
 Site-MNIST_M                       | Train Loss: 1.3162 | Train Acc: 0.6038
 Site-MNIST_M                       | Train Loss: 1.4329 | Train Acc: 0.5363
 Site-SVHN                          | Train Loss: 1.6979 | Train Acc: 0.4394
 Site-SVHN                          | Train Loss: 1.6536 | Train Acc: 0.4152
Average Train Accuracy: 0.6898
 Site-MNIST                         | Val  Loss: 0.4178 | Val  Acc: 0.9130
 Site-MNIST                         | Val  Loss: 0.4225 | Val  Acc: 0.9029
 Site-USPS                          | Val  Loss: 0.5238 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.4212 | Val  Acc: 0.8777
 Site-SynthDigits                   | Val  Loss: 1.0671 | Val  Acc: 0.5978
 Site-SynthDigits                   | Val  Loss: 1.0650 | Val  Acc: 0.6583
 Site-MNIST_M                       | Val  Loss: 1.4320 | Val  Acc: 0.5435
 Site-MNIST_M                       | Val  Loss: 1.4010 | Val  Acc: 0.5791
 Site-SVHN                          | Val  Loss: 1.5959 | Val  Acc: 0.4239
 Site-SVHN                          | Val  Loss: 1.6555 | Val  Acc: 0.4424
Average Valid Accuracy: 0.6765
============ Train epoch 49 ============
denominator: 16115.8515625
 Site-MNIST                         | Train Loss: 0.4038 | Train Acc: 0.8706
 Site-MNIST                         | Train Loss: 0.4515 | Train Acc: 0.8816
 Site-USPS                          | Train Loss: 0.4100 | Train Acc: 0.8976
 Site-USPS                          | Train Loss: 0.3856 | Train Acc: 0.9013
 Site-SynthDigits                   | Train Loss: 1.0966 | Train Acc: 0.6523
 Site-SynthDigits                   | Train Loss: 1.0304 | Train Acc: 0.6915
 Site-MNIST_M                       | Train Loss: 1.2908 | Train Acc: 0.6065
 Site-MNIST_M                       | Train Loss: 1.4244 | Train Acc: 0.5498
 Site-SVHN                          | Train Loss: 1.6785 | Train Acc: 0.4313
 Site-SVHN                          | Train Loss: 1.6324 | Train Acc: 0.4269
Average Train Accuracy: 0.6909
 Site-MNIST                         | Val  Loss: 0.4061 | Val  Acc: 0.8913
 Site-MNIST                         | Val  Loss: 0.4164 | Val  Acc: 0.8885
 Site-USPS                          | Val  Loss: 0.5264 | Val  Acc: 0.8261
 Site-USPS                          | Val  Loss: 0.4238 | Val  Acc: 0.8777
 Site-SynthDigits                   | Val  Loss: 1.0424 | Val  Acc: 0.6413
 Site-SynthDigits                   | Val  Loss: 1.0434 | Val  Acc: 0.6799
 Site-MNIST_M                       | Val  Loss: 1.4303 | Val  Acc: 0.5652
 Site-MNIST_M                       | Val  Loss: 1.3869 | Val  Acc: 0.6043
 Site-SVHN                          | Val  Loss: 1.5759 | Val  Acc: 0.4565
 Site-SVHN                          | Val  Loss: 1.6465 | Val  Acc: 0.4604
Average Valid Accuracy: 0.6891
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8913
 Best site-MNIST                     | Epoch:49 | Val Acc: 0.8885
 Best site-USPS                      | Epoch:49 | Val Acc: 0.8261
 Best site-USPS                      | Epoch:49 | Val Acc: 0.8777
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.6413
 Best site-SynthDigits               | Epoch:49 | Val Acc: 0.6799
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.5652
 Best site-MNIST_M                   | Epoch:49 | Val Acc: 0.6043
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.4565
 Best site-SVHN                      | Epoch:49 | Val Acc: 0.4604
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_2/q-ffl...
===2023-07-31 07:35:10===
===2023-07-31 07:35:13===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:49 | Test Acc: 0.8699
 Test site-USPS                      | Epoch:49 | Test Acc: 0.8957
 Test site-SynthDigits               | Epoch:49 | Test Acc: 0.6546
 Test site-MNIST_M                   | Epoch:49 | Test Acc: 0.5079
 Test site-SVHN                      | Epoch:49 | Test Acc: 0.3802
MNIST: 0.8699, USPS: 0.8957, SynthDigits: 0.6546, MNIST_M: 0.5079, SVHN: 0.3802, 
Average Test Accuracy(group): 0.6616, Average Test Accuracy(individual): 0.6616,
domain std=0.2005, cluster std=-1.0000, individual std=0.2005, 
