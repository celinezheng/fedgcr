===2023-08-01 03:50:25===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 3, 5, 2, 2, ]
cnt=[5, 3, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (2) | Train Loss: 1.6424 | Train Acc: 0.6800
 Site-MNIST                     (2) | Train Loss: 1.6601 | Train Acc: 0.6568
 Site-MNIST                     (2) | Train Loss: 1.6874 | Train Acc: 0.5996
 Site-MNIST                     (2) | Train Loss: 1.6536 | Train Acc: 0.6636
 Site-MNIST                     (2) | Train Loss: 1.6537 | Train Acc: 0.6541
 Site-USPS                      (1) | Train Loss: 1.6635 | Train Acc: 0.5564
 Site-USPS                      (1) | Train Loss: 1.6740 | Train Acc: 0.5415
 Site-USPS                      (1) | Train Loss: 1.6605 | Train Acc: 0.5708
 Site-SynthDigits               (3) | Train Loss: 2.1259 | Train Acc: 0.2424
 Site-SynthDigits               (3) | Train Loss: 2.0929 | Train Acc: 0.2917
 Site-MNIST_M                   (4) | Train Loss: 2.1654 | Train Acc: 0.2244
 Site-MNIST_M                   (4) | Train Loss: 2.1833 | Train Acc: 0.2273
 Site-SVHN                      (0) | Train Loss: 2.2314 | Train Acc: 0.1840
Average Train Accuracy: 0.4687
 Site-MNIST                     (2) | Val  Loss: 1.7550 | Val  Acc: 0.5179
 Site-MNIST                     (2) | Val  Loss: 1.7378 | Val  Acc: 0.6429
 Site-MNIST                     (2) | Val  Loss: 1.6350 | Val  Acc: 0.6746
 Site-MNIST                     (2) | Val  Loss: 1.6797 | Val  Acc: 0.6053
 Site-MNIST                     (2) | Val  Loss: 1.6671 | Val  Acc: 0.6316
 Site-USPS                      (1) | Val  Loss: 1.6804 | Val  Acc: 0.5673
 Site-USPS                      (1) | Val  Loss: 1.7411 | Val  Acc: 0.4679
 Site-USPS                      (1) | Val  Loss: 1.6587 | Val  Acc: 0.5684
 Site-SynthDigits               (3) | Val  Loss: 2.2610 | Val  Acc: 0.2576
 Site-SynthDigits               (3) | Val  Loss: 2.0785 | Val  Acc: 0.2273
 Site-MNIST_M                   (4) | Val  Loss: 2.0568 | Val  Acc: 0.2841
 Site-MNIST_M                   (4) | Val  Loss: 2.1376 | Val  Acc: 0.2500
 Site-SVHN                      (0) | Val  Loss: 2.2363 | Val  Acc: 0.1644
Average Valid Accuracy: 0.4507
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5179
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6429
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6746
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6053
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6316
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.5673
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.4679
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.5684
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2576
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2273
 Best site-MNIST_M                  (4)  | Epoch:0 | Val Acc: 0.2841
 Best site-MNIST_M                  (4)  | Epoch:0 | Val Acc: 0.2500
 Best site-SVHN                     (0)  | Epoch:0 | Val Acc: 0.1644
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 1 ============
cnt=[5, 2, 2, 3, 1, ]
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (0) | Train Loss: 1.2243 | Train Acc: 0.7689
 Site-MNIST                     (0) | Train Loss: 1.2234 | Train Acc: 0.7988
 Site-MNIST                     (0) | Train Loss: 1.2620 | Train Acc: 0.7298
 Site-MNIST                     (0) | Train Loss: 1.2152 | Train Acc: 0.7490
 Site-MNIST                     (0) | Train Loss: 1.2204 | Train Acc: 0.7434
 Site-USPS                      (3) | Train Loss: 1.1566 | Train Acc: 0.7770
 Site-USPS                      (3) | Train Loss: 1.1752 | Train Acc: 0.7859
 Site-USPS                      (3) | Train Loss: 1.1674 | Train Acc: 0.7902
 Site-SynthDigits               (2) | Train Loss: 1.8873 | Train Acc: 0.3769
 Site-SynthDigits               (2) | Train Loss: 1.8645 | Train Acc: 0.3902
 Site-MNIST_M                   (1) | Train Loss: 2.0168 | Train Acc: 0.2784
 Site-MNIST_M                   (1) | Train Loss: 2.0552 | Train Acc: 0.2803
 Site-SVHN                      (4) | Train Loss: 2.0980 | Train Acc: 0.2351
Average Train Accuracy: 0.5926
 Site-MNIST                     (0) | Val  Loss: 1.3068 | Val  Acc: 0.6964
 Site-MNIST                     (0) | Val  Loss: 1.2868 | Val  Acc: 0.7738
 Site-MNIST                     (0) | Val  Loss: 1.2037 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 1.2677 | Val  Acc: 0.7474
 Site-MNIST                     (0) | Val  Loss: 1.2345 | Val  Acc: 0.7789
 Site-USPS                      (3) | Val  Loss: 1.1454 | Val  Acc: 0.8558
 Site-USPS                      (3) | Val  Loss: 1.2355 | Val  Acc: 0.7628
 Site-USPS                      (3) | Val  Loss: 1.1722 | Val  Acc: 0.7778
 Site-SynthDigits               (2) | Val  Loss: 2.0784 | Val  Acc: 0.3636
 Site-SynthDigits               (2) | Val  Loss: 1.8208 | Val  Acc: 0.3737
 Site-MNIST_M                   (1) | Val  Loss: 1.8947 | Val  Acc: 0.3864
 Site-MNIST_M                   (1) | Val  Loss: 2.0501 | Val  Acc: 0.2879
 Site-SVHN                      (4) | Val  Loss: 2.0772 | Val  Acc: 0.2397
Average Valid Accuracy: 0.6017
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.6964
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7738
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7474
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7789
 Best site-USPS                     (3)  | Epoch:1 | Val Acc: 0.8558
 Best site-USPS                     (3)  | Epoch:1 | Val Acc: 0.7628
 Best site-USPS                     (3)  | Epoch:1 | Val Acc: 0.7778
 Best site-SynthDigits              (2)  | Epoch:1 | Val Acc: 0.3636
 Best site-SynthDigits              (2)  | Epoch:1 | Val Acc: 0.3737
 Best site-MNIST_M                  (1)  | Epoch:1 | Val Acc: 0.3864
 Best site-MNIST_M                  (1)  | Epoch:1 | Val Acc: 0.2879
 Best site-SVHN                     (4)  | Epoch:1 | Val Acc: 0.2397
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 5, 2, 3, 1, ]
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (1) | Train Loss: 1.0165 | Train Acc: 0.7689
 Site-MNIST                     (1) | Train Loss: 1.0361 | Train Acc: 0.8166
 Site-MNIST                     (1) | Train Loss: 1.1001 | Train Acc: 0.7436
 Site-MNIST                     (1) | Train Loss: 1.0475 | Train Acc: 0.7727
 Site-MNIST                     (1) | Train Loss: 1.0381 | Train Acc: 0.7574
 Site-USPS                      (3) | Train Loss: 0.9702 | Train Acc: 0.7626
 Site-USPS                      (3) | Train Loss: 0.9760 | Train Acc: 0.7636
 Site-USPS                      (3) | Train Loss: 0.9577 | Train Acc: 0.7913
 Site-SynthDigits               (0) | Train Loss: 1.7073 | Train Acc: 0.4451
 Site-SynthDigits               (0) | Train Loss: 1.6165 | Train Acc: 0.4735
 Site-MNIST_M                   (2) | Train Loss: 1.8563 | Train Acc: 0.3551
 Site-MNIST_M                   (2) | Train Loss: 1.8957 | Train Acc: 0.3617
 Site-SVHN                      (4) | Train Loss: 2.0136 | Train Acc: 0.2709
Average Train Accuracy: 0.6218
 Site-MNIST                     (1) | Val  Loss: 1.1193 | Val  Acc: 0.7679
 Site-MNIST                     (1) | Val  Loss: 1.1186 | Val  Acc: 0.7738
 Site-MNIST                     (1) | Val  Loss: 1.0250 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 1.1080 | Val  Acc: 0.7632
 Site-MNIST                     (1) | Val  Loss: 1.0663 | Val  Acc: 0.8070
 Site-USPS                      (3) | Val  Loss: 0.9381 | Val  Acc: 0.8365
 Site-USPS                      (3) | Val  Loss: 1.0355 | Val  Acc: 0.7308
 Site-USPS                      (3) | Val  Loss: 0.9827 | Val  Acc: 0.7607
 Site-SynthDigits               (0) | Val  Loss: 1.8832 | Val  Acc: 0.4545
 Site-SynthDigits               (0) | Val  Loss: 1.5995 | Val  Acc: 0.4596
 Site-MNIST_M                   (2) | Val  Loss: 1.7405 | Val  Acc: 0.4545
 Site-MNIST_M                   (2) | Val  Loss: 1.9143 | Val  Acc: 0.3939
 Site-SVHN                      (4) | Val  Loss: 1.9690 | Val  Acc: 0.2671
Average Valid Accuracy: 0.6344
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.7679
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.7738
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.7632
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.8070
 Best site-USPS                     (3)  | Epoch:2 | Val Acc: 0.8365
 Best site-USPS                     (3)  | Epoch:2 | Val Acc: 0.7308
 Best site-USPS                     (3)  | Epoch:2 | Val Acc: 0.7607
 Best site-SynthDigits              (0)  | Epoch:2 | Val Acc: 0.4545
 Best site-SynthDigits              (0)  | Epoch:2 | Val Acc: 0.4596
 Best site-MNIST_M                  (2)  | Epoch:2 | Val Acc: 0.4545
 Best site-MNIST_M                  (2)  | Epoch:2 | Val Acc: 0.3939
 Best site-SVHN                     (4)  | Epoch:2 | Val Acc: 0.2671
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 3 ============
cnt=[5, 1, 2, 2, 3, ]
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (0) | Train Loss: 0.9125 | Train Acc: 0.7822
 Site-MNIST                     (0) | Train Loss: 0.9123 | Train Acc: 0.8521
 Site-MNIST                     (0) | Train Loss: 0.9597 | Train Acc: 0.7653
 Site-MNIST                     (0) | Train Loss: 0.9138 | Train Acc: 0.7898
 Site-MNIST                     (0) | Train Loss: 0.9065 | Train Acc: 0.7863
 Site-USPS                      (4) | Train Loss: 0.8419 | Train Acc: 0.7938
 Site-USPS                      (4) | Train Loss: 0.8452 | Train Acc: 0.8051
 Site-USPS                      (4) | Train Loss: 0.8254 | Train Acc: 0.8253
 Site-SynthDigits               (2) | Train Loss: 1.5266 | Train Acc: 0.5189
 Site-SynthDigits               (2) | Train Loss: 1.4669 | Train Acc: 0.5492
 Site-MNIST_M                   (3) | Train Loss: 1.7242 | Train Acc: 0.4148
 Site-MNIST_M                   (3) | Train Loss: 1.7939 | Train Acc: 0.4280
 Site-SVHN                      (1) | Train Loss: 1.9285 | Train Acc: 0.3322
Average Train Accuracy: 0.6649
 Site-MNIST                     (0) | Val  Loss: 0.9634 | Val  Acc: 0.7857
 Site-MNIST                     (0) | Val  Loss: 0.9527 | Val  Acc: 0.8214
 Site-MNIST                     (0) | Val  Loss: 0.8813 | Val  Acc: 0.8016
 Site-MNIST                     (0) | Val  Loss: 0.9736 | Val  Acc: 0.7895
 Site-MNIST                     (0) | Val  Loss: 0.9277 | Val  Acc: 0.8386
 Site-USPS                      (4) | Val  Loss: 0.8019 | Val  Acc: 0.8654
 Site-USPS                      (4) | Val  Loss: 0.8895 | Val  Acc: 0.7949
 Site-USPS                      (4) | Val  Loss: 0.8507 | Val  Acc: 0.7906
 Site-SynthDigits               (2) | Val  Loss: 1.7411 | Val  Acc: 0.5000
 Site-SynthDigits               (2) | Val  Loss: 1.4381 | Val  Acc: 0.5051
 Site-MNIST_M                   (3) | Val  Loss: 1.5950 | Val  Acc: 0.5000
 Site-MNIST_M                   (3) | Val  Loss: 1.8133 | Val  Acc: 0.4091
 Site-SVHN                      (1) | Val  Loss: 1.8562 | Val  Acc: 0.3288
Average Valid Accuracy: 0.6716
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.7857
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8214
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8016
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.7895
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8386
 Best site-USPS                     (4)  | Epoch:3 | Val Acc: 0.8654
 Best site-USPS                     (4)  | Epoch:3 | Val Acc: 0.7949
 Best site-USPS                     (4)  | Epoch:3 | Val Acc: 0.7906
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.5000
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.5051
 Best site-MNIST_M                  (3)  | Epoch:3 | Val Acc: 0.5000
 Best site-MNIST_M                  (3)  | Epoch:3 | Val Acc: 0.4091
 Best site-SVHN                     (1)  | Epoch:3 | Val Acc: 0.3288
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 4 ============
cnt=[5, 2, 2, 3, 1, ]
cnt=[1, 5, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (0) | Train Loss: 0.7826 | Train Acc: 0.8222
 Site-MNIST                     (0) | Train Loss: 0.7834 | Train Acc: 0.8580
 Site-MNIST                     (0) | Train Loss: 0.8396 | Train Acc: 0.7870
 Site-MNIST                     (0) | Train Loss: 0.7974 | Train Acc: 0.8068
 Site-MNIST                     (0) | Train Loss: 0.7872 | Train Acc: 0.8214
 Site-USPS                      (3) | Train Loss: 0.7641 | Train Acc: 0.8082
 Site-USPS                      (3) | Train Loss: 0.7662 | Train Acc: 0.8115
 Site-USPS                      (3) | Train Loss: 0.7526 | Train Acc: 0.8285
 Site-SynthDigits               (2) | Train Loss: 1.3900 | Train Acc: 0.5663
 Site-SynthDigits               (2) | Train Loss: 1.3178 | Train Acc: 0.6111
 Site-MNIST_M                   (1) | Train Loss: 1.6394 | Train Acc: 0.4688
 Site-MNIST_M                   (1) | Train Loss: 1.6643 | Train Acc: 0.4640
 Site-SVHN                      (4) | Train Loss: 1.8197 | Train Acc: 0.3629
Average Train Accuracy: 0.6936
 Site-MNIST                     (0) | Val  Loss: 0.8204 | Val  Acc: 0.8036
 Site-MNIST                     (0) | Val  Loss: 0.8105 | Val  Acc: 0.8333
 Site-MNIST                     (0) | Val  Loss: 0.7616 | Val  Acc: 0.8254
 Site-MNIST                     (0) | Val  Loss: 0.8548 | Val  Acc: 0.7947
 Site-MNIST                     (0) | Val  Loss: 0.8038 | Val  Acc: 0.8526
 Site-USPS                      (3) | Val  Loss: 0.7184 | Val  Acc: 0.8654
 Site-USPS                      (3) | Val  Loss: 0.8076 | Val  Acc: 0.7885
 Site-USPS                      (3) | Val  Loss: 0.7827 | Val  Acc: 0.7949
 Site-SynthDigits               (2) | Val  Loss: 1.6112 | Val  Acc: 0.5455
 Site-SynthDigits               (2) | Val  Loss: 1.3037 | Val  Acc: 0.5657
 Site-MNIST_M                   (1) | Val  Loss: 1.5221 | Val  Acc: 0.5341
 Site-MNIST_M                   (1) | Val  Loss: 1.7491 | Val  Acc: 0.4697
 Site-SVHN                      (4) | Val  Loss: 1.7683 | Val  Acc: 0.3904
Average Valid Accuracy: 0.6972
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8036
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8333
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8254
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.7947
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8526
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.8654
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.7885
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.7949
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.5455
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.5657
 Best site-MNIST_M                  (1)  | Epoch:4 | Val Acc: 0.5341
 Best site-MNIST_M                  (1)  | Epoch:4 | Val Acc: 0.4697
 Best site-SVHN                     (4)  | Epoch:4 | Val Acc: 0.3904
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 5, 2, 3, 1, ]
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (1) | Train Loss: 0.7418 | Train Acc: 0.8000
 Site-MNIST                     (1) | Train Loss: 0.7022 | Train Acc: 0.8491
 Site-MNIST                     (1) | Train Loss: 0.7787 | Train Acc: 0.7890
 Site-MNIST                     (1) | Train Loss: 0.7470 | Train Acc: 0.8213
 Site-MNIST                     (1) | Train Loss: 0.7334 | Train Acc: 0.8257
 Site-USPS                      (3) | Train Loss: 0.7074 | Train Acc: 0.8010
 Site-USPS                      (3) | Train Loss: 0.7149 | Train Acc: 0.8211
 Site-USPS                      (3) | Train Loss: 0.6990 | Train Acc: 0.8424
 Site-SynthDigits               (2) | Train Loss: 1.3004 | Train Acc: 0.5928
 Site-SynthDigits               (2) | Train Loss: 1.2187 | Train Acc: 0.6376
 Site-MNIST_M                   (0) | Train Loss: 1.5536 | Train Acc: 0.5227
 Site-MNIST_M                   (0) | Train Loss: 1.5608 | Train Acc: 0.5284
 Site-SVHN                      (4) | Train Loss: 1.7416 | Train Acc: 0.4174
Average Train Accuracy: 0.7114
 Site-MNIST                     (1) | Val  Loss: 0.7555 | Val  Acc: 0.8036
 Site-MNIST                     (1) | Val  Loss: 0.7402 | Val  Acc: 0.8452
 Site-MNIST                     (1) | Val  Loss: 0.7204 | Val  Acc: 0.8175
 Site-MNIST                     (1) | Val  Loss: 0.8015 | Val  Acc: 0.7895
 Site-MNIST                     (1) | Val  Loss: 0.7408 | Val  Acc: 0.8386
 Site-USPS                      (3) | Val  Loss: 0.6800 | Val  Acc: 0.8558
 Site-USPS                      (3) | Val  Loss: 0.7602 | Val  Acc: 0.7949
 Site-USPS                      (3) | Val  Loss: 0.7371 | Val  Acc: 0.7991
 Site-SynthDigits               (2) | Val  Loss: 1.5295 | Val  Acc: 0.5379
 Site-SynthDigits               (2) | Val  Loss: 1.1879 | Val  Acc: 0.5808
 Site-MNIST_M                   (0) | Val  Loss: 1.4211 | Val  Acc: 0.5909
 Site-MNIST_M                   (0) | Val  Loss: 1.6462 | Val  Acc: 0.5379
 Site-SVHN                      (4) | Val  Loss: 1.6640 | Val  Acc: 0.4452
Average Valid Accuracy: 0.7105
 Best site-MNIST                    (1)  | Epoch:5 | Val Acc: 0.8036
 Best site-MNIST                    (1)  | Epoch:5 | Val Acc: 0.8452
 Best site-MNIST                    (1)  | Epoch:5 | Val Acc: 0.8175
 Best site-MNIST                    (1)  | Epoch:5 | Val Acc: 0.7895
 Best site-MNIST                    (1)  | Epoch:5 | Val Acc: 0.8386
 Best site-USPS                     (3)  | Epoch:5 | Val Acc: 0.8558
 Best site-USPS                     (3)  | Epoch:5 | Val Acc: 0.7949
 Best site-USPS                     (3)  | Epoch:5 | Val Acc: 0.7991
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.5379
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.5808
 Best site-MNIST_M                  (0)  | Epoch:5 | Val Acc: 0.5909
 Best site-MNIST_M                  (0)  | Epoch:5 | Val Acc: 0.5379
 Best site-SVHN                     (4)  | Epoch:5 | Val Acc: 0.4452
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 5, 2, 3, 1, ]
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (1) | Train Loss: 0.6713 | Train Acc: 0.8444
 Site-MNIST                     (1) | Train Loss: 0.6037 | Train Acc: 0.8757
 Site-MNIST                     (1) | Train Loss: 0.6932 | Train Acc: 0.8284
 Site-MNIST                     (1) | Train Loss: 0.6627 | Train Acc: 0.8292
 Site-MNIST                     (1) | Train Loss: 0.6439 | Train Acc: 0.8468
 Site-USPS                      (3) | Train Loss: 0.6913 | Train Acc: 0.8177
 Site-USPS                      (3) | Train Loss: 0.6798 | Train Acc: 0.8243
 Site-USPS                      (3) | Train Loss: 0.6703 | Train Acc: 0.8360
 Site-SynthDigits               (0) | Train Loss: 1.1682 | Train Acc: 0.6534
 Site-SynthDigits               (0) | Train Loss: 1.0997 | Train Acc: 0.7033
 Site-MNIST_M                   (2) | Train Loss: 1.4309 | Train Acc: 0.5653
 Site-MNIST_M                   (2) | Train Loss: 1.4872 | Train Acc: 0.5549
 Site-SVHN                      (4) | Train Loss: 1.6623 | Train Acc: 0.4463
Average Train Accuracy: 0.7404
 Site-MNIST                     (1) | Val  Loss: 0.6506 | Val  Acc: 0.8929
 Site-MNIST                     (1) | Val  Loss: 0.6414 | Val  Acc: 0.8929
 Site-MNIST                     (1) | Val  Loss: 0.6289 | Val  Acc: 0.8730
 Site-MNIST                     (1) | Val  Loss: 0.7100 | Val  Acc: 0.8368
 Site-MNIST                     (1) | Val  Loss: 0.6555 | Val  Acc: 0.8667
 Site-USPS                      (3) | Val  Loss: 0.6239 | Val  Acc: 0.8654
 Site-USPS                      (3) | Val  Loss: 0.7188 | Val  Acc: 0.7885
 Site-USPS                      (3) | Val  Loss: 0.7131 | Val  Acc: 0.7991
 Site-SynthDigits               (0) | Val  Loss: 1.4221 | Val  Acc: 0.6136
 Site-SynthDigits               (0) | Val  Loss: 1.0850 | Val  Acc: 0.6414
 Site-MNIST_M                   (2) | Val  Loss: 1.3445 | Val  Acc: 0.6023
 Site-MNIST_M                   (2) | Val  Loss: 1.6003 | Val  Acc: 0.5758
 Site-SVHN                      (4) | Val  Loss: 1.6043 | Val  Acc: 0.4863
Average Valid Accuracy: 0.7488
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8929
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8929
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8730
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8368
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8667
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.8654
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.7885
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.7991
 Best site-SynthDigits              (0)  | Epoch:6 | Val Acc: 0.6136
 Best site-SynthDigits              (0)  | Epoch:6 | Val Acc: 0.6414
 Best site-MNIST_M                  (2)  | Epoch:6 | Val Acc: 0.6023
 Best site-MNIST_M                  (2)  | Epoch:6 | Val Acc: 0.5758
 Best site-SVHN                     (4)  | Epoch:6 | Val Acc: 0.4863
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 7 ============
cnt=[5, 2, 2, 3, 1, ]
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (0) | Train Loss: 0.6285 | Train Acc: 0.8133
 Site-MNIST                     (0) | Train Loss: 0.5724 | Train Acc: 0.8669
 Site-MNIST                     (0) | Train Loss: 0.6495 | Train Acc: 0.8225
 Site-MNIST                     (0) | Train Loss: 0.6203 | Train Acc: 0.8476
 Site-MNIST                     (0) | Train Loss: 0.6042 | Train Acc: 0.8511
 Site-USPS                      (3) | Train Loss: 0.6245 | Train Acc: 0.8297
 Site-USPS                      (3) | Train Loss: 0.6188 | Train Acc: 0.8530
 Site-USPS                      (3) | Train Loss: 0.6098 | Train Acc: 0.8552
 Site-SynthDigits               (2) | Train Loss: 1.0707 | Train Acc: 0.6648
 Site-SynthDigits               (2) | Train Loss: 1.0091 | Train Acc: 0.7273
 Site-MNIST_M                   (1) | Train Loss: 1.3918 | Train Acc: 0.6023
 Site-MNIST_M                   (1) | Train Loss: 1.4119 | Train Acc: 0.5739
 Site-SVHN                      (4) | Train Loss: 1.5756 | Train Acc: 0.4804
Average Train Accuracy: 0.7529
 Site-MNIST                     (0) | Val  Loss: 0.5971 | Val  Acc: 0.8750
 Site-MNIST                     (0) | Val  Loss: 0.5834 | Val  Acc: 0.8810
 Site-MNIST                     (0) | Val  Loss: 0.5994 | Val  Acc: 0.8492
 Site-MNIST                     (0) | Val  Loss: 0.6678 | Val  Acc: 0.8263
 Site-MNIST                     (0) | Val  Loss: 0.6082 | Val  Acc: 0.8667
 Site-USPS                      (3) | Val  Loss: 0.5668 | Val  Acc: 0.8942
 Site-USPS                      (3) | Val  Loss: 0.6589 | Val  Acc: 0.8333
 Site-USPS                      (3) | Val  Loss: 0.6606 | Val  Acc: 0.8162
 Site-SynthDigits               (2) | Val  Loss: 1.3447 | Val  Acc: 0.6212
 Site-SynthDigits               (2) | Val  Loss: 0.9933 | Val  Acc: 0.6717
 Site-MNIST_M                   (1) | Val  Loss: 1.2874 | Val  Acc: 0.6818
 Site-MNIST_M                   (1) | Val  Loss: 1.5185 | Val  Acc: 0.5909
 Site-SVHN                      (4) | Val  Loss: 1.5350 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7621
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8750
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8810
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8492
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8263
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8667
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.8942
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.8333
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.8162
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.6212
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.6717
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.6818
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.5909
 Best site-SVHN                     (4)  | Epoch:7 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 3, 2, 5, 1, ]
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (3) | Train Loss: 0.5822 | Train Acc: 0.8222
 Site-MNIST                     (3) | Train Loss: 0.5665 | Train Acc: 0.8728
 Site-MNIST                     (3) | Train Loss: 0.6011 | Train Acc: 0.8343
 Site-MNIST                     (3) | Train Loss: 0.5813 | Train Acc: 0.8528
 Site-MNIST                     (3) | Train Loss: 0.5631 | Train Acc: 0.8643
 Site-USPS                      (1) | Train Loss: 0.6064 | Train Acc: 0.8297
 Site-USPS                      (1) | Train Loss: 0.5961 | Train Acc: 0.8514
 Site-USPS                      (1) | Train Loss: 0.5958 | Train Acc: 0.8520
 Site-SynthDigits               (2) | Train Loss: 1.0298 | Train Acc: 0.7083
 Site-SynthDigits               (2) | Train Loss: 0.9454 | Train Acc: 0.7576
 Site-MNIST_M                   (0) | Train Loss: 1.3081 | Train Acc: 0.6222
 Site-MNIST_M                   (0) | Train Loss: 1.3153 | Train Acc: 0.5947
 Site-SVHN                      (4) | Train Loss: 1.4859 | Train Acc: 0.5111
Average Train Accuracy: 0.7672
 Site-MNIST                     (3) | Val  Loss: 0.5426 | Val  Acc: 0.8750
 Site-MNIST                     (3) | Val  Loss: 0.5374 | Val  Acc: 0.8690
 Site-MNIST                     (3) | Val  Loss: 0.5604 | Val  Acc: 0.8571
 Site-MNIST                     (3) | Val  Loss: 0.6217 | Val  Acc: 0.8368
 Site-MNIST                     (3) | Val  Loss: 0.5668 | Val  Acc: 0.8667
 Site-USPS                      (1) | Val  Loss: 0.5406 | Val  Acc: 0.8846
 Site-USPS                      (1) | Val  Loss: 0.6294 | Val  Acc: 0.8333
 Site-USPS                      (1) | Val  Loss: 0.6434 | Val  Acc: 0.8248
 Site-SynthDigits               (2) | Val  Loss: 1.2476 | Val  Acc: 0.6515
 Site-SynthDigits               (2) | Val  Loss: 0.9123 | Val  Acc: 0.7020
 Site-MNIST_M                   (0) | Val  Loss: 1.2224 | Val  Acc: 0.6818
 Site-MNIST_M                   (0) | Val  Loss: 1.4233 | Val  Acc: 0.6212
 Site-SVHN                      (4) | Val  Loss: 1.4417 | Val  Acc: 0.5137
Average Valid Accuracy: 0.7706
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.8750
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.8690
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.8571
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.8368
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.8667
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.8846
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.8333
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.8248
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.6515
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.7020
 Best site-MNIST_M                  (0)  | Epoch:8 | Val Acc: 0.6818
 Best site-MNIST_M                  (0)  | Epoch:8 | Val Acc: 0.6212
 Best site-SVHN                     (4)  | Epoch:8 | Val Acc: 0.5137
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 5, 2, 3, 2, ]
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (1) | Train Loss: 0.5666 | Train Acc: 0.8222
 Site-MNIST                     (1) | Train Loss: 0.5154 | Train Acc: 0.8817
 Site-MNIST                     (1) | Train Loss: 0.5684 | Train Acc: 0.8442
 Site-MNIST                     (1) | Train Loss: 0.5446 | Train Acc: 0.8594
 Site-MNIST                     (1) | Train Loss: 0.5231 | Train Acc: 0.8704
 Site-USPS                      (3) | Train Loss: 0.5635 | Train Acc: 0.8369
 Site-USPS                      (3) | Train Loss: 0.5449 | Train Acc: 0.8610
 Site-USPS                      (3) | Train Loss: 0.5449 | Train Acc: 0.8637
 Site-SynthDigits               (4) | Train Loss: 0.9497 | Train Acc: 0.7216
 Site-SynthDigits               (4) | Train Loss: 0.8654 | Train Acc: 0.7652
 Site-MNIST_M                   (2) | Train Loss: 1.2581 | Train Acc: 0.6477
 Site-MNIST_M                   (2) | Train Loss: 1.2749 | Train Acc: 0.6155
 Site-SVHN                      (0) | Train Loss: 1.4321 | Train Acc: 0.5298
Average Train Accuracy: 0.7784
 Site-MNIST                     (1) | Val  Loss: 0.5001 | Val  Acc: 0.8929
 Site-MNIST                     (1) | Val  Loss: 0.4956 | Val  Acc: 0.8810
 Site-MNIST                     (1) | Val  Loss: 0.5232 | Val  Acc: 0.8651
 Site-MNIST                     (1) | Val  Loss: 0.5838 | Val  Acc: 0.8421
 Site-MNIST                     (1) | Val  Loss: 0.5264 | Val  Acc: 0.8737
 Site-USPS                      (3) | Val  Loss: 0.4893 | Val  Acc: 0.8750
 Site-USPS                      (3) | Val  Loss: 0.5782 | Val  Acc: 0.8397
 Site-USPS                      (3) | Val  Loss: 0.5968 | Val  Acc: 0.8162
 Site-SynthDigits               (4) | Val  Loss: 1.1768 | Val  Acc: 0.6894
 Site-SynthDigits               (4) | Val  Loss: 0.8493 | Val  Acc: 0.7222
 Site-MNIST_M                   (2) | Val  Loss: 1.1691 | Val  Acc: 0.7045
 Site-MNIST_M                   (2) | Val  Loss: 1.3663 | Val  Acc: 0.6288
 Site-SVHN                      (0) | Val  Loss: 1.4039 | Val  Acc: 0.5342
Average Valid Accuracy: 0.7819
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8929
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8810
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8651
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8421
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8737
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8750
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8397
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8162
 Best site-SynthDigits              (4)  | Epoch:9 | Val Acc: 0.6894
 Best site-SynthDigits              (4)  | Epoch:9 | Val Acc: 0.7222
 Best site-MNIST_M                  (2)  | Epoch:9 | Val Acc: 0.7045
 Best site-MNIST_M                  (2)  | Epoch:9 | Val Acc: 0.6288
 Best site-SVHN                     (0)  | Epoch:9 | Val Acc: 0.5342
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 10 ============
cnt=[5, 2, 2, 3, 1, ]
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (0) | Train Loss: 0.5432 | Train Acc: 0.8044
 Site-MNIST                     (0) | Train Loss: 0.4778 | Train Acc: 0.8876
 Site-MNIST                     (0) | Train Loss: 0.5631 | Train Acc: 0.8304
 Site-MNIST                     (0) | Train Loss: 0.5354 | Train Acc: 0.8463
 Site-MNIST                     (0) | Train Loss: 0.5149 | Train Acc: 0.8660
 Site-USPS                      (3) | Train Loss: 0.5277 | Train Acc: 0.8657
 Site-USPS                      (3) | Train Loss: 0.5088 | Train Acc: 0.8722
 Site-USPS                      (3) | Train Loss: 0.5036 | Train Acc: 0.8860
 Site-SynthDigits               (2) | Train Loss: 0.8932 | Train Acc: 0.7500
 Site-SynthDigits               (2) | Train Loss: 0.8217 | Train Acc: 0.7689
 Site-MNIST_M                   (1) | Train Loss: 1.2140 | Train Acc: 0.6619
 Site-MNIST_M                   (1) | Train Loss: 1.2184 | Train Acc: 0.6648
 Site-SVHN                      (4) | Train Loss: 1.4217 | Train Acc: 0.5486
Average Train Accuracy: 0.7887
 Site-MNIST                     (0) | Val  Loss: 0.4913 | Val  Acc: 0.8929
 Site-MNIST                     (0) | Val  Loss: 0.4825 | Val  Acc: 0.8333
 Site-MNIST                     (0) | Val  Loss: 0.5163 | Val  Acc: 0.8333
 Site-MNIST                     (0) | Val  Loss: 0.5754 | Val  Acc: 0.8474
 Site-MNIST                     (0) | Val  Loss: 0.5136 | Val  Acc: 0.8842
 Site-USPS                      (3) | Val  Loss: 0.4640 | Val  Acc: 0.8942
 Site-USPS                      (3) | Val  Loss: 0.5426 | Val  Acc: 0.8333
 Site-USPS                      (3) | Val  Loss: 0.5593 | Val  Acc: 0.8376
 Site-SynthDigits               (2) | Val  Loss: 1.0891 | Val  Acc: 0.6970
 Site-SynthDigits               (2) | Val  Loss: 0.7754 | Val  Acc: 0.7475
 Site-MNIST_M                   (1) | Val  Loss: 1.1123 | Val  Acc: 0.6818
 Site-MNIST_M                   (1) | Val  Loss: 1.3064 | Val  Acc: 0.6515
 Site-SVHN                      (4) | Val  Loss: 1.3600 | Val  Acc: 0.5205
Average Valid Accuracy: 0.7811
============ Train epoch 11 ============
cnt=[1, 5, 2, 3, 2, ]
cnt=[5, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (1) | Train Loss: 0.4897 | Train Acc: 0.8489
 Site-MNIST                     (1) | Train Loss: 0.4444 | Train Acc: 0.9053
 Site-MNIST                     (1) | Train Loss: 0.4918 | Train Acc: 0.8738
 Site-MNIST                     (1) | Train Loss: 0.4726 | Train Acc: 0.8725
 Site-MNIST                     (1) | Train Loss: 0.4489 | Train Acc: 0.8975
 Site-USPS                      (3) | Train Loss: 0.5086 | Train Acc: 0.8465
 Site-USPS                      (3) | Train Loss: 0.4994 | Train Acc: 0.8706
 Site-USPS                      (3) | Train Loss: 0.4871 | Train Acc: 0.8807
 Site-SynthDigits               (4) | Train Loss: 0.8451 | Train Acc: 0.7500
 Site-SynthDigits               (4) | Train Loss: 0.7676 | Train Acc: 0.8093
 Site-MNIST_M                   (2) | Train Loss: 1.1678 | Train Acc: 0.6506
 Site-MNIST_M                   (2) | Train Loss: 1.1595 | Train Acc: 0.6534
 Site-SVHN                      (0) | Train Loss: 1.3169 | Train Acc: 0.5707
Average Train Accuracy: 0.8023
 Site-MNIST                     (1) | Val  Loss: 0.4181 | Val  Acc: 0.8929
 Site-MNIST                     (1) | Val  Loss: 0.4055 | Val  Acc: 0.9048
 Site-MNIST                     (1) | Val  Loss: 0.4498 | Val  Acc: 0.8810
 Site-MNIST                     (1) | Val  Loss: 0.5060 | Val  Acc: 0.8684
 Site-MNIST                     (1) | Val  Loss: 0.4481 | Val  Acc: 0.8912
 Site-USPS                      (3) | Val  Loss: 0.4367 | Val  Acc: 0.8942
 Site-USPS                      (3) | Val  Loss: 0.5186 | Val  Acc: 0.8526
 Site-USPS                      (3) | Val  Loss: 0.5482 | Val  Acc: 0.8291
 Site-SynthDigits               (4) | Val  Loss: 1.0257 | Val  Acc: 0.7424
 Site-SynthDigits               (4) | Val  Loss: 0.7377 | Val  Acc: 0.7576
 Site-MNIST_M                   (2) | Val  Loss: 1.1197 | Val  Acc: 0.7045
 Site-MNIST_M                   (2) | Val  Loss: 1.2470 | Val  Acc: 0.6364
 Site-SVHN                      (0) | Val  Loss: 1.2966 | Val  Acc: 0.5753
Average Valid Accuracy: 0.8023
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.8929
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.9048
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.8810
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.8684
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.8912
 Best site-USPS                     (3)  | Epoch:11 | Val Acc: 0.8942
 Best site-USPS                     (3)  | Epoch:11 | Val Acc: 0.8526
 Best site-USPS                     (3)  | Epoch:11 | Val Acc: 0.8291
 Best site-SynthDigits              (4)  | Epoch:11 | Val Acc: 0.7424
 Best site-SynthDigits              (4)  | Epoch:11 | Val Acc: 0.7576
 Best site-MNIST_M                  (2)  | Epoch:11 | Val Acc: 0.7045
 Best site-MNIST_M                  (2)  | Epoch:11 | Val Acc: 0.6364
 Best site-SVHN                     (0)  | Epoch:11 | Val Acc: 0.5753
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 12 ============
cnt=[5, 1, 2, 3, 2, ]
cnt=[5, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (0) | Train Loss: 0.4570 | Train Acc: 0.8489
 Site-MNIST                     (0) | Train Loss: 0.3792 | Train Acc: 0.9053
 Site-MNIST                     (0) | Train Loss: 0.4676 | Train Acc: 0.8817
 Site-MNIST                     (0) | Train Loss: 0.4486 | Train Acc: 0.8752
 Site-MNIST                     (0) | Train Loss: 0.4274 | Train Acc: 0.8975
 Site-USPS                      (3) | Train Loss: 0.4855 | Train Acc: 0.8585
 Site-USPS                      (3) | Train Loss: 0.4681 | Train Acc: 0.8786
 Site-USPS                      (3) | Train Loss: 0.4626 | Train Acc: 0.8935
 Site-SynthDigits               (4) | Train Loss: 0.7878 | Train Acc: 0.7841
 Site-SynthDigits               (4) | Train Loss: 0.7192 | Train Acc: 0.8182
 Site-MNIST_M                   (2) | Train Loss: 1.1096 | Train Acc: 0.6676
 Site-MNIST_M                   (2) | Train Loss: 1.0827 | Train Acc: 0.6894
 Site-SVHN                      (1) | Train Loss: 1.2506 | Train Acc: 0.5877
Average Train Accuracy: 0.8143
 Site-MNIST                     (0) | Val  Loss: 0.3910 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.3803 | Val  Acc: 0.8929
 Site-MNIST                     (0) | Val  Loss: 0.4264 | Val  Acc: 0.8889
 Site-MNIST                     (0) | Val  Loss: 0.4819 | Val  Acc: 0.8842
 Site-MNIST                     (0) | Val  Loss: 0.4270 | Val  Acc: 0.9018
 Site-USPS                      (3) | Val  Loss: 0.4120 | Val  Acc: 0.8942
 Site-USPS                      (3) | Val  Loss: 0.4885 | Val  Acc: 0.8462
 Site-USPS                      (3) | Val  Loss: 0.5219 | Val  Acc: 0.8376
 Site-SynthDigits               (4) | Val  Loss: 0.9413 | Val  Acc: 0.7576
 Site-SynthDigits               (4) | Val  Loss: 0.6788 | Val  Acc: 0.7929
 Site-MNIST_M                   (2) | Val  Loss: 1.0552 | Val  Acc: 0.7045
 Site-MNIST_M                   (2) | Val  Loss: 1.1776 | Val  Acc: 0.6439
 Site-SVHN                      (1) | Val  Loss: 1.2599 | Val  Acc: 0.5616
Average Valid Accuracy: 0.8090
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.8929
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.8889
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.8842
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.9018
 Best site-USPS                     (3)  | Epoch:12 | Val Acc: 0.8942
 Best site-USPS                     (3)  | Epoch:12 | Val Acc: 0.8462
 Best site-USPS                     (3)  | Epoch:12 | Val Acc: 0.8376
 Best site-SynthDigits              (4)  | Epoch:12 | Val Acc: 0.7576
 Best site-SynthDigits              (4)  | Epoch:12 | Val Acc: 0.7929
 Best site-MNIST_M                  (2)  | Epoch:12 | Val Acc: 0.7045
 Best site-MNIST_M                  (2)  | Epoch:12 | Val Acc: 0.6439
 Best site-SVHN                     (1)  | Epoch:12 | Val Acc: 0.5616
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 13 ============
cnt=[3, 2, 5, 2, 1, ]
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (2) | Train Loss: 0.4188 | Train Acc: 0.8533
 Site-MNIST                     (2) | Train Loss: 0.3843 | Train Acc: 0.9112
 Site-MNIST                     (2) | Train Loss: 0.4365 | Train Acc: 0.8895
 Site-MNIST                     (2) | Train Loss: 0.4239 | Train Acc: 0.8844
 Site-MNIST                     (2) | Train Loss: 0.3971 | Train Acc: 0.9046
 Site-USPS                      (0) | Train Loss: 0.4735 | Train Acc: 0.8633
 Site-USPS                      (0) | Train Loss: 0.4442 | Train Acc: 0.8834
 Site-USPS                      (0) | Train Loss: 0.4440 | Train Acc: 0.8967
 Site-SynthDigits               (3) | Train Loss: 0.7487 | Train Acc: 0.7992
 Site-SynthDigits               (3) | Train Loss: 0.6647 | Train Acc: 0.8207
 Site-MNIST_M                   (1) | Train Loss: 1.0537 | Train Acc: 0.6733
 Site-MNIST_M                   (1) | Train Loss: 1.0587 | Train Acc: 0.6875
 Site-SVHN                      (4) | Train Loss: 1.2176 | Train Acc: 0.6116
Average Train Accuracy: 0.8214
 Site-MNIST                     (2) | Val  Loss: 0.3497 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.3443 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.4022 | Val  Acc: 0.9127
 Site-MNIST                     (2) | Val  Loss: 0.4533 | Val  Acc: 0.8895
 Site-MNIST                     (2) | Val  Loss: 0.3979 | Val  Acc: 0.9088
 Site-USPS                      (0) | Val  Loss: 0.3870 | Val  Acc: 0.8942
 Site-USPS                      (0) | Val  Loss: 0.4657 | Val  Acc: 0.8526
 Site-USPS                      (0) | Val  Loss: 0.5041 | Val  Acc: 0.8547
 Site-SynthDigits               (3) | Val  Loss: 0.9019 | Val  Acc: 0.7500
 Site-SynthDigits               (3) | Val  Loss: 0.6368 | Val  Acc: 0.7929
 Site-MNIST_M                   (1) | Val  Loss: 0.9915 | Val  Acc: 0.7386
 Site-MNIST_M                   (1) | Val  Loss: 1.1129 | Val  Acc: 0.6742
 Site-SVHN                      (4) | Val  Loss: 1.2412 | Val  Acc: 0.5753
Average Valid Accuracy: 0.8231
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.9127
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8895
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.9088
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.8942
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.8526
 Best site-USPS                     (0)  | Epoch:13 | Val Acc: 0.8547
 Best site-SynthDigits              (3)  | Epoch:13 | Val Acc: 0.7500
 Best site-SynthDigits              (3)  | Epoch:13 | Val Acc: 0.7929
 Best site-MNIST_M                  (1)  | Epoch:13 | Val Acc: 0.7386
 Best site-MNIST_M                  (1)  | Epoch:13 | Val Acc: 0.6742
 Best site-SVHN                     (4)  | Epoch:13 | Val Acc: 0.5753
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 5, 2, 3, 1, ]
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (1) | Train Loss: 0.4073 | Train Acc: 0.8667
 Site-MNIST                     (1) | Train Loss: 0.3378 | Train Acc: 0.9201
 Site-MNIST                     (1) | Train Loss: 0.4140 | Train Acc: 0.8915
 Site-MNIST                     (1) | Train Loss: 0.3977 | Train Acc: 0.8988
 Site-MNIST                     (1) | Train Loss: 0.3717 | Train Acc: 0.9177
 Site-USPS                      (3) | Train Loss: 0.4416 | Train Acc: 0.8801
 Site-USPS                      (3) | Train Loss: 0.4269 | Train Acc: 0.8786
 Site-USPS                      (3) | Train Loss: 0.4231 | Train Acc: 0.8956
 Site-SynthDigits               (0) | Train Loss: 0.6971 | Train Acc: 0.8106
 Site-SynthDigits               (0) | Train Loss: 0.6291 | Train Acc: 0.8409
 Site-MNIST_M                   (2) | Train Loss: 1.0209 | Train Acc: 0.6960
 Site-MNIST_M                   (2) | Train Loss: 0.9902 | Train Acc: 0.7083
 Site-SVHN                      (4) | Train Loss: 1.2067 | Train Acc: 0.6150
Average Train Accuracy: 0.8323
 Site-MNIST                     (1) | Val  Loss: 0.3349 | Val  Acc: 0.8929
 Site-MNIST                     (1) | Val  Loss: 0.3265 | Val  Acc: 0.9048
 Site-MNIST                     (1) | Val  Loss: 0.3728 | Val  Acc: 0.9048
 Site-MNIST                     (1) | Val  Loss: 0.4248 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.3741 | Val  Acc: 0.9193
 Site-USPS                      (3) | Val  Loss: 0.3712 | Val  Acc: 0.8942
 Site-USPS                      (3) | Val  Loss: 0.4442 | Val  Acc: 0.8590
 Site-USPS                      (3) | Val  Loss: 0.4821 | Val  Acc: 0.8504
 Site-SynthDigits               (0) | Val  Loss: 0.8343 | Val  Acc: 0.7803
 Site-SynthDigits               (0) | Val  Loss: 0.6004 | Val  Acc: 0.7980
 Site-MNIST_M                   (2) | Val  Loss: 0.9569 | Val  Acc: 0.7045
 Site-MNIST_M                   (2) | Val  Loss: 1.0471 | Val  Acc: 0.6970
 Site-SVHN                      (4) | Val  Loss: 1.2190 | Val  Acc: 0.5616
Average Valid Accuracy: 0.8205
============ Train epoch 15 ============
cnt=[3, 2, 5, 2, 1, ]
cnt=[1, 5, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (2) | Train Loss: 0.3701 | Train Acc: 0.8889
 Site-MNIST                     (2) | Train Loss: 0.3226 | Train Acc: 0.9320
 Site-MNIST                     (2) | Train Loss: 0.3873 | Train Acc: 0.8994
 Site-MNIST                     (2) | Train Loss: 0.3744 | Train Acc: 0.9028
 Site-MNIST                     (2) | Train Loss: 0.3441 | Train Acc: 0.9194
 Site-USPS                      (0) | Train Loss: 0.4347 | Train Acc: 0.8753
 Site-USPS                      (0) | Train Loss: 0.4209 | Train Acc: 0.8850
 Site-USPS                      (0) | Train Loss: 0.4124 | Train Acc: 0.8892
 Site-SynthDigits               (3) | Train Loss: 0.6817 | Train Acc: 0.8144
 Site-SynthDigits               (3) | Train Loss: 0.6168 | Train Acc: 0.8548
 Site-MNIST_M                   (1) | Train Loss: 0.9618 | Train Acc: 0.6932
 Site-MNIST_M                   (1) | Train Loss: 0.9880 | Train Acc: 0.7140
 Site-SVHN                      (4) | Train Loss: 1.1165 | Train Acc: 0.6303
Average Train Accuracy: 0.8384
 Site-MNIST                     (2) | Val  Loss: 0.3038 | Val  Acc: 0.9107
 Site-MNIST                     (2) | Val  Loss: 0.2967 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.3462 | Val  Acc: 0.9127
 Site-MNIST                     (2) | Val  Loss: 0.3985 | Val  Acc: 0.9105
 Site-MNIST                     (2) | Val  Loss: 0.3472 | Val  Acc: 0.9263
 Site-USPS                      (0) | Val  Loss: 0.3567 | Val  Acc: 0.8942
 Site-USPS                      (0) | Val  Loss: 0.4271 | Val  Acc: 0.8590
 Site-USPS                      (0) | Val  Loss: 0.4752 | Val  Acc: 0.8504
 Site-SynthDigits               (3) | Val  Loss: 0.8071 | Val  Acc: 0.7803
 Site-SynthDigits               (3) | Val  Loss: 0.5801 | Val  Acc: 0.7980
 Site-MNIST_M                   (1) | Val  Loss: 0.9497 | Val  Acc: 0.7273
 Site-MNIST_M                   (1) | Val  Loss: 1.0208 | Val  Acc: 0.7121
 Site-SVHN                      (4) | Val  Loss: 1.1694 | Val  Acc: 0.5822
Average Valid Accuracy: 0.8302
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.9107
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.9127
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.9105
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.9263
 Best site-USPS                     (0)  | Epoch:15 | Val Acc: 0.8942
 Best site-USPS                     (0)  | Epoch:15 | Val Acc: 0.8590
 Best site-USPS                     (0)  | Epoch:15 | Val Acc: 0.8504
 Best site-SynthDigits              (3)  | Epoch:15 | Val Acc: 0.7803
 Best site-SynthDigits              (3)  | Epoch:15 | Val Acc: 0.7980
 Best site-MNIST_M                  (1)  | Epoch:15 | Val Acc: 0.7273
 Best site-MNIST_M                  (1)  | Epoch:15 | Val Acc: 0.7121
 Best site-SVHN                     (4)  | Epoch:15 | Val Acc: 0.5822
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 16 ============
cnt=[5, 3, 2, 1, 2, ]
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (0) | Train Loss: 0.3755 | Train Acc: 0.8844
 Site-MNIST                     (0) | Train Loss: 0.3068 | Train Acc: 0.9349
 Site-MNIST                     (0) | Train Loss: 0.3680 | Train Acc: 0.9014
 Site-MNIST                     (0) | Train Loss: 0.3556 | Train Acc: 0.9067
 Site-MNIST                     (0) | Train Loss: 0.3256 | Train Acc: 0.9238
 Site-USPS                      (1) | Train Loss: 0.4215 | Train Acc: 0.8825
 Site-USPS                      (1) | Train Loss: 0.4038 | Train Acc: 0.8802
 Site-USPS                      (1) | Train Loss: 0.4052 | Train Acc: 0.8956
 Site-SynthDigits               (4) | Train Loss: 0.6532 | Train Acc: 0.8239
 Site-SynthDigits               (4) | Train Loss: 0.5853 | Train Acc: 0.8598
 Site-MNIST_M                   (2) | Train Loss: 0.9460 | Train Acc: 0.7216
 Site-MNIST_M                   (2) | Train Loss: 0.9292 | Train Acc: 0.7386
 Site-SVHN                      (3) | Train Loss: 1.1266 | Train Acc: 0.6422
Average Train Accuracy: 0.8458
 Site-MNIST                     (0) | Val  Loss: 0.2889 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.2791 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.3249 | Val  Acc: 0.9206
 Site-MNIST                     (0) | Val  Loss: 0.3811 | Val  Acc: 0.9105
 Site-MNIST                     (0) | Val  Loss: 0.3289 | Val  Acc: 0.9298
 Site-USPS                      (1) | Val  Loss: 0.3419 | Val  Acc: 0.8846
 Site-USPS                      (1) | Val  Loss: 0.4135 | Val  Acc: 0.8654
 Site-USPS                      (1) | Val  Loss: 0.4607 | Val  Acc: 0.8547
 Site-SynthDigits               (4) | Val  Loss: 0.7644 | Val  Acc: 0.7803
 Site-SynthDigits               (4) | Val  Loss: 0.5485 | Val  Acc: 0.8081
 Site-MNIST_M                   (2) | Val  Loss: 0.9471 | Val  Acc: 0.7273
 Site-MNIST_M                   (2) | Val  Loss: 0.9932 | Val  Acc: 0.7424
 Site-SVHN                      (3) | Val  Loss: 1.1471 | Val  Acc: 0.5753
Average Valid Accuracy: 0.8337
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9206
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9105
 Best site-MNIST                    (0)  | Epoch:16 | Val Acc: 0.9298
 Best site-USPS                     (1)  | Epoch:16 | Val Acc: 0.8846
 Best site-USPS                     (1)  | Epoch:16 | Val Acc: 0.8654
 Best site-USPS                     (1)  | Epoch:16 | Val Acc: 0.8547
 Best site-SynthDigits              (4)  | Epoch:16 | Val Acc: 0.7803
 Best site-SynthDigits              (4)  | Epoch:16 | Val Acc: 0.8081
 Best site-MNIST_M                  (2)  | Epoch:16 | Val Acc: 0.7273
 Best site-MNIST_M                  (2)  | Epoch:16 | Val Acc: 0.7424
 Best site-SVHN                     (3)  | Epoch:16 | Val Acc: 0.5753
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 17 ============
cnt=[2, 3, 5, 2, 1, ]
cnt=[5, 3, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (2) | Train Loss: 0.3569 | Train Acc: 0.8889
 Site-MNIST                     (2) | Train Loss: 0.2957 | Train Acc: 0.9320
 Site-MNIST                     (2) | Train Loss: 0.3593 | Train Acc: 0.9073
 Site-MNIST                     (2) | Train Loss: 0.3461 | Train Acc: 0.9067
 Site-MNIST                     (2) | Train Loss: 0.3158 | Train Acc: 0.9273
 Site-USPS                      (1) | Train Loss: 0.4139 | Train Acc: 0.8825
 Site-USPS                      (1) | Train Loss: 0.3808 | Train Acc: 0.8850
 Site-USPS                      (1) | Train Loss: 0.3855 | Train Acc: 0.9020
 Site-SynthDigits               (3) | Train Loss: 0.6689 | Train Acc: 0.8201
 Site-SynthDigits               (3) | Train Loss: 0.5710 | Train Acc: 0.8535
 Site-MNIST_M                   (0) | Train Loss: 0.8901 | Train Acc: 0.7443
 Site-MNIST_M                   (0) | Train Loss: 0.8931 | Train Acc: 0.7424
 Site-SVHN                      (4) | Train Loss: 1.1462 | Train Acc: 0.6440
Average Train Accuracy: 0.8489
 Site-MNIST                     (2) | Val  Loss: 0.2753 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2702 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.3185 | Val  Acc: 0.9206
 Site-MNIST                     (2) | Val  Loss: 0.3734 | Val  Acc: 0.9105
 Site-MNIST                     (2) | Val  Loss: 0.3195 | Val  Acc: 0.9333
 Site-USPS                      (1) | Val  Loss: 0.3233 | Val  Acc: 0.8942
 Site-USPS                      (1) | Val  Loss: 0.3921 | Val  Acc: 0.8590
 Site-USPS                      (1) | Val  Loss: 0.4401 | Val  Acc: 0.8675
 Site-SynthDigits               (3) | Val  Loss: 0.7539 | Val  Acc: 0.7879
 Site-SynthDigits               (3) | Val  Loss: 0.5272 | Val  Acc: 0.8131
 Site-MNIST_M                   (0) | Val  Loss: 0.9204 | Val  Acc: 0.7386
 Site-MNIST_M                   (0) | Val  Loss: 0.9510 | Val  Acc: 0.7500
 Site-SVHN                      (4) | Val  Loss: 1.1480 | Val  Acc: 0.5890
Average Valid Accuracy: 0.8401
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.9206
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.9105
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.9333
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.8942
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.8590
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.8675
 Best site-SynthDigits              (3)  | Epoch:17 | Val Acc: 0.7879
 Best site-SynthDigits              (3)  | Epoch:17 | Val Acc: 0.8131
 Best site-MNIST_M                  (0)  | Epoch:17 | Val Acc: 0.7386
 Best site-MNIST_M                  (0)  | Epoch:17 | Val Acc: 0.7500
 Best site-SVHN                     (4)  | Epoch:17 | Val Acc: 0.5890
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 18 ============
cnt=[5, 2, 2, 3, 1, ]
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (0) | Train Loss: 0.3190 | Train Acc: 0.8889
 Site-MNIST                     (0) | Train Loss: 0.3049 | Train Acc: 0.9320
 Site-MNIST                     (0) | Train Loss: 0.3464 | Train Acc: 0.9093
 Site-MNIST                     (0) | Train Loss: 0.3368 | Train Acc: 0.9054
 Site-MNIST                     (0) | Train Loss: 0.3051 | Train Acc: 0.9291
 Site-USPS                      (3) | Train Loss: 0.3977 | Train Acc: 0.8969
 Site-USPS                      (3) | Train Loss: 0.3697 | Train Acc: 0.8866
 Site-USPS                      (3) | Train Loss: 0.3679 | Train Acc: 0.9020
 Site-SynthDigits               (1) | Train Loss: 0.5805 | Train Acc: 0.8352
 Site-SynthDigits               (1) | Train Loss: 0.5315 | Train Acc: 0.8699
 Site-MNIST_M                   (2) | Train Loss: 0.9134 | Train Acc: 0.7585
 Site-MNIST_M                   (2) | Train Loss: 0.8877 | Train Acc: 0.7557
 Site-SVHN                      (4) | Train Loss: 1.0801 | Train Acc: 0.6457
Average Train Accuracy: 0.8550
 Site-MNIST                     (0) | Val  Loss: 0.2723 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.2670 | Val  Acc: 0.9167
 Site-MNIST                     (0) | Val  Loss: 0.3075 | Val  Acc: 0.9206
 Site-MNIST                     (0) | Val  Loss: 0.3606 | Val  Acc: 0.9105
 Site-MNIST                     (0) | Val  Loss: 0.3080 | Val  Acc: 0.9263
 Site-USPS                      (3) | Val  Loss: 0.3121 | Val  Acc: 0.9038
 Site-USPS                      (3) | Val  Loss: 0.3783 | Val  Acc: 0.8654
 Site-USPS                      (3) | Val  Loss: 0.4276 | Val  Acc: 0.8590
 Site-SynthDigits               (1) | Val  Loss: 0.7069 | Val  Acc: 0.8030
 Site-SynthDigits               (1) | Val  Loss: 0.5037 | Val  Acc: 0.8333
 Site-MNIST_M                   (2) | Val  Loss: 0.9090 | Val  Acc: 0.7500
 Site-MNIST_M                   (2) | Val  Loss: 0.9286 | Val  Acc: 0.7879
 Site-SVHN                      (4) | Val  Loss: 1.1035 | Val  Acc: 0.5959
Average Valid Accuracy: 0.8449
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9167
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9206
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9105
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9263
 Best site-USPS                     (3)  | Epoch:18 | Val Acc: 0.9038
 Best site-USPS                     (3)  | Epoch:18 | Val Acc: 0.8654
 Best site-USPS                     (3)  | Epoch:18 | Val Acc: 0.8590
 Best site-SynthDigits              (1)  | Epoch:18 | Val Acc: 0.8030
 Best site-SynthDigits              (1)  | Epoch:18 | Val Acc: 0.8333
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.7500
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.7879
 Best site-SVHN                     (4)  | Epoch:18 | Val Acc: 0.5959
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 3, 5, 2, 1, ]
cnt=[3, 5, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (2) | Train Loss: 0.3090 | Train Acc: 0.8978
 Site-MNIST                     (2) | Train Loss: 0.2744 | Train Acc: 0.9408
 Site-MNIST                     (2) | Train Loss: 0.3333 | Train Acc: 0.9073
 Site-MNIST                     (2) | Train Loss: 0.3220 | Train Acc: 0.9133
 Site-MNIST                     (2) | Train Loss: 0.2902 | Train Acc: 0.9308
 Site-USPS                      (1) | Train Loss: 0.3781 | Train Acc: 0.8873
 Site-USPS                      (1) | Train Loss: 0.3564 | Train Acc: 0.8962
 Site-USPS                      (1) | Train Loss: 0.3545 | Train Acc: 0.9073
 Site-SynthDigits               (3) | Train Loss: 0.5774 | Train Acc: 0.8390
 Site-SynthDigits               (3) | Train Loss: 0.5282 | Train Acc: 0.8674
 Site-MNIST_M                   (0) | Train Loss: 0.8692 | Train Acc: 0.7727
 Site-MNIST_M                   (0) | Train Loss: 0.8304 | Train Acc: 0.7557
 Site-SVHN                      (4) | Train Loss: 1.0831 | Train Acc: 0.6559
Average Train Accuracy: 0.8593
 Site-MNIST                     (2) | Val  Loss: 0.2564 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2513 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2931 | Val  Acc: 0.9127
 Site-MNIST                     (2) | Val  Loss: 0.3476 | Val  Acc: 0.9053
 Site-MNIST                     (2) | Val  Loss: 0.2955 | Val  Acc: 0.9298
 Site-USPS                      (1) | Val  Loss: 0.2926 | Val  Acc: 0.9038
 Site-USPS                      (1) | Val  Loss: 0.3647 | Val  Acc: 0.8590
 Site-USPS                      (1) | Val  Loss: 0.4182 | Val  Acc: 0.8632
 Site-SynthDigits               (3) | Val  Loss: 0.7167 | Val  Acc: 0.8030
 Site-SynthDigits               (3) | Val  Loss: 0.4883 | Val  Acc: 0.8232
 Site-MNIST_M                   (0) | Val  Loss: 0.8710 | Val  Acc: 0.7500
 Site-MNIST_M                   (0) | Val  Loss: 0.9007 | Val  Acc: 0.7652
 Site-SVHN                      (4) | Val  Loss: 1.1084 | Val  Acc: 0.6164
Average Valid Accuracy: 0.8453
 Best site-MNIST                    (2)  | Epoch:19 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:19 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:19 | Val Acc: 0.9127
 Best site-MNIST                    (2)  | Epoch:19 | Val Acc: 0.9053
 Best site-MNIST                    (2)  | Epoch:19 | Val Acc: 0.9298
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.9038
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.8590
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.8632
 Best site-SynthDigits              (3)  | Epoch:19 | Val Acc: 0.8030
 Best site-SynthDigits              (3)  | Epoch:19 | Val Acc: 0.8232
 Best site-MNIST_M                  (0)  | Epoch:19 | Val Acc: 0.7500
 Best site-MNIST_M                  (0)  | Epoch:19 | Val Acc: 0.7652
 Best site-SVHN                     (4)  | Epoch:19 | Val Acc: 0.6164
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 20 ============
cnt=[1, 5, 3, 2, 2, ]
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (1) | Train Loss: 0.3343 | Train Acc: 0.8800
 Site-MNIST                     (1) | Train Loss: 0.3334 | Train Acc: 0.9290
 Site-MNIST                     (1) | Train Loss: 0.3405 | Train Acc: 0.8935
 Site-MNIST                     (1) | Train Loss: 0.3285 | Train Acc: 0.9067
 Site-MNIST                     (1) | Train Loss: 0.2992 | Train Acc: 0.9247
 Site-USPS                      (2) | Train Loss: 0.3808 | Train Acc: 0.8993
 Site-USPS                      (2) | Train Loss: 0.3487 | Train Acc: 0.9042
 Site-USPS                      (2) | Train Loss: 0.3495 | Train Acc: 0.9084
 Site-SynthDigits               (4) | Train Loss: 0.5926 | Train Acc: 0.8258
 Site-SynthDigits               (4) | Train Loss: 0.5250 | Train Acc: 0.8775
 Site-MNIST_M                   (3) | Train Loss: 0.8451 | Train Acc: 0.7784
 Site-MNIST_M                   (3) | Train Loss: 0.8307 | Train Acc: 0.7595
 Site-SVHN                      (0) | Train Loss: 1.0115 | Train Acc: 0.6661
Average Train Accuracy: 0.8579
 Site-MNIST                     (1) | Val  Loss: 0.2665 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2604 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.3022 | Val  Acc: 0.9048
 Site-MNIST                     (1) | Val  Loss: 0.3559 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.3014 | Val  Acc: 0.9228
 Site-USPS                      (2) | Val  Loss: 0.2883 | Val  Acc: 0.9327
 Site-USPS                      (2) | Val  Loss: 0.3528 | Val  Acc: 0.8782
 Site-USPS                      (2) | Val  Loss: 0.4061 | Val  Acc: 0.8675
 Site-SynthDigits               (4) | Val  Loss: 0.7031 | Val  Acc: 0.7879
 Site-SynthDigits               (4) | Val  Loss: 0.4730 | Val  Acc: 0.8333
 Site-MNIST_M                   (3) | Val  Loss: 0.8528 | Val  Acc: 0.7500
 Site-MNIST_M                   (3) | Val  Loss: 0.8883 | Val  Acc: 0.7803
 Site-SVHN                      (0) | Val  Loss: 1.0666 | Val  Acc: 0.6233
Average Valid Accuracy: 0.8491
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9048
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9000
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9228
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.9327
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.8782
 Best site-USPS                     (2)  | Epoch:20 | Val Acc: 0.8675
 Best site-SynthDigits              (4)  | Epoch:20 | Val Acc: 0.7879
 Best site-SynthDigits              (4)  | Epoch:20 | Val Acc: 0.8333
 Best site-MNIST_M                  (3)  | Epoch:20 | Val Acc: 0.7500
 Best site-MNIST_M                  (3)  | Epoch:20 | Val Acc: 0.7803
 Best site-SVHN                     (0)  | Epoch:20 | Val Acc: 0.6233
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 21 ============
cnt=[2, 5, 2, 3, 1, ]
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (1) | Train Loss: 0.3171 | Train Acc: 0.8889
 Site-MNIST                     (1) | Train Loss: 0.2456 | Train Acc: 0.9349
 Site-MNIST                     (1) | Train Loss: 0.3216 | Train Acc: 0.9073
 Site-MNIST                     (1) | Train Loss: 0.3128 | Train Acc: 0.9133
 Site-MNIST                     (1) | Train Loss: 0.2832 | Train Acc: 0.9308
 Site-USPS                      (3) | Train Loss: 0.3618 | Train Acc: 0.9017
 Site-USPS                      (3) | Train Loss: 0.3382 | Train Acc: 0.9042
 Site-USPS                      (3) | Train Loss: 0.3382 | Train Acc: 0.9116
 Site-SynthDigits               (0) | Train Loss: 0.5776 | Train Acc: 0.8504
 Site-SynthDigits               (0) | Train Loss: 0.5036 | Train Acc: 0.8876
 Site-MNIST_M                   (2) | Train Loss: 0.8347 | Train Acc: 0.7699
 Site-MNIST_M                   (2) | Train Loss: 0.8178 | Train Acc: 0.7689
 Site-SVHN                      (4) | Train Loss: 0.9670 | Train Acc: 0.6746
Average Train Accuracy: 0.8649
 Site-MNIST                     (1) | Val  Loss: 0.2542 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2448 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2843 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.3386 | Val  Acc: 0.9211
 Site-MNIST                     (1) | Val  Loss: 0.2841 | Val  Acc: 0.9298
 Site-USPS                      (3) | Val  Loss: 0.2882 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.3432 | Val  Acc: 0.8718
 Site-USPS                      (3) | Val  Loss: 0.3955 | Val  Acc: 0.8632
 Site-SynthDigits               (0) | Val  Loss: 0.6540 | Val  Acc: 0.8258
 Site-SynthDigits               (0) | Val  Loss: 0.4512 | Val  Acc: 0.8535
 Site-MNIST_M                   (2) | Val  Loss: 0.8749 | Val  Acc: 0.7614
 Site-MNIST_M                   (2) | Val  Loss: 0.8852 | Val  Acc: 0.7879
 Site-SVHN                      (4) | Val  Loss: 1.0437 | Val  Acc: 0.6370
Average Valid Accuracy: 0.8585
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9211
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9298
 Best site-USPS                     (3)  | Epoch:21 | Val Acc: 0.9231
 Best site-USPS                     (3)  | Epoch:21 | Val Acc: 0.8718
 Best site-USPS                     (3)  | Epoch:21 | Val Acc: 0.8632
 Best site-SynthDigits              (0)  | Epoch:21 | Val Acc: 0.8258
 Best site-SynthDigits              (0)  | Epoch:21 | Val Acc: 0.8535
 Best site-MNIST_M                  (2)  | Epoch:21 | Val Acc: 0.7614
 Best site-MNIST_M                  (2)  | Epoch:21 | Val Acc: 0.7879
 Best site-SVHN                     (4)  | Epoch:21 | Val Acc: 0.6370
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 22 ============
cnt=[3, 2, 5, 2, 1, ]
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (2) | Train Loss: 0.2919 | Train Acc: 0.8978
 Site-MNIST                     (2) | Train Loss: 0.2473 | Train Acc: 0.9349
 Site-MNIST                     (2) | Train Loss: 0.3020 | Train Acc: 0.9152
 Site-MNIST                     (2) | Train Loss: 0.2980 | Train Acc: 0.9172
 Site-MNIST                     (2) | Train Loss: 0.2681 | Train Acc: 0.9361
 Site-USPS                      (0) | Train Loss: 0.3553 | Train Acc: 0.8945
 Site-USPS                      (0) | Train Loss: 0.3247 | Train Acc: 0.9058
 Site-USPS                      (0) | Train Loss: 0.3229 | Train Acc: 0.9137
 Site-SynthDigits               (3) | Train Loss: 0.5586 | Train Acc: 0.8447
 Site-SynthDigits               (3) | Train Loss: 0.4794 | Train Acc: 0.8876
 Site-MNIST_M                   (1) | Train Loss: 0.7923 | Train Acc: 0.7841
 Site-MNIST_M                   (1) | Train Loss: 0.7899 | Train Acc: 0.7784
 Site-SVHN                      (4) | Train Loss: 0.9870 | Train Acc: 0.6593
Average Train Accuracy: 0.8669
 Site-MNIST                     (2) | Val  Loss: 0.2336 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2280 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2680 | Val  Acc: 0.9206
 Site-MNIST                     (2) | Val  Loss: 0.3209 | Val  Acc: 0.9158
 Site-MNIST                     (2) | Val  Loss: 0.2703 | Val  Acc: 0.9298
 Site-USPS                      (0) | Val  Loss: 0.2660 | Val  Acc: 0.9231
 Site-USPS                      (0) | Val  Loss: 0.3291 | Val  Acc: 0.8718
 Site-USPS                      (0) | Val  Loss: 0.3823 | Val  Acc: 0.8675
 Site-SynthDigits               (3) | Val  Loss: 0.6552 | Val  Acc: 0.8182
 Site-SynthDigits               (3) | Val  Loss: 0.4432 | Val  Acc: 0.8535
 Site-MNIST_M                   (1) | Val  Loss: 0.8222 | Val  Acc: 0.7841
 Site-MNIST_M                   (1) | Val  Loss: 0.8490 | Val  Acc: 0.7879
 Site-SVHN                      (4) | Val  Loss: 1.0533 | Val  Acc: 0.6301
Average Valid Accuracy: 0.8584
============ Train epoch 23 ============
cnt=[3, 5, 2, 2, 1, ]
cnt=[5, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (1) | Train Loss: 0.2824 | Train Acc: 0.9111
 Site-MNIST                     (1) | Train Loss: 0.2470 | Train Acc: 0.9467
 Site-MNIST                     (1) | Train Loss: 0.2917 | Train Acc: 0.9191
 Site-MNIST                     (1) | Train Loss: 0.2907 | Train Acc: 0.9225
 Site-MNIST                     (1) | Train Loss: 0.2562 | Train Acc: 0.9396
 Site-USPS                      (0) | Train Loss: 0.3548 | Train Acc: 0.8945
 Site-USPS                      (0) | Train Loss: 0.3266 | Train Acc: 0.9042
 Site-USPS                      (0) | Train Loss: 0.3195 | Train Acc: 0.9116
 Site-SynthDigits               (3) | Train Loss: 0.5288 | Train Acc: 0.8580
 Site-SynthDigits               (3) | Train Loss: 0.4639 | Train Acc: 0.8977
 Site-MNIST_M                   (2) | Train Loss: 0.7965 | Train Acc: 0.8040
 Site-MNIST_M                   (2) | Train Loss: 0.7983 | Train Acc: 0.7860
 Site-SVHN                      (4) | Train Loss: 0.9916 | Train Acc: 0.6848
Average Train Accuracy: 0.8754
 Site-MNIST                     (1) | Val  Loss: 0.2216 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2175 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2610 | Val  Acc: 0.9365
 Site-MNIST                     (1) | Val  Loss: 0.3116 | Val  Acc: 0.9316
 Site-MNIST                     (1) | Val  Loss: 0.2611 | Val  Acc: 0.9509
 Site-USPS                      (0) | Val  Loss: 0.2602 | Val  Acc: 0.9327
 Site-USPS                      (0) | Val  Loss: 0.3224 | Val  Acc: 0.8782
 Site-USPS                      (0) | Val  Loss: 0.3805 | Val  Acc: 0.8632
 Site-SynthDigits               (3) | Val  Loss: 0.6013 | Val  Acc: 0.8561
 Site-SynthDigits               (3) | Val  Loss: 0.4237 | Val  Acc: 0.8687
 Site-MNIST_M                   (2) | Val  Loss: 0.8314 | Val  Acc: 0.7614
 Site-MNIST_M                   (2) | Val  Loss: 0.8385 | Val  Acc: 0.7803
 Site-SVHN                      (4) | Val  Loss: 1.0091 | Val  Acc: 0.6370
Average Valid Accuracy: 0.8670
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9365
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9316
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9509
 Best site-USPS                     (0)  | Epoch:23 | Val Acc: 0.9327
 Best site-USPS                     (0)  | Epoch:23 | Val Acc: 0.8782
 Best site-USPS                     (0)  | Epoch:23 | Val Acc: 0.8632
 Best site-SynthDigits              (3)  | Epoch:23 | Val Acc: 0.8561
 Best site-SynthDigits              (3)  | Epoch:23 | Val Acc: 0.8687
 Best site-MNIST_M                  (2)  | Epoch:23 | Val Acc: 0.7614
 Best site-MNIST_M                  (2)  | Epoch:23 | Val Acc: 0.7803
 Best site-SVHN                     (4)  | Epoch:23 | Val Acc: 0.6370
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 24 ============
cnt=[2, 5, 2, 3, 1, ]
cnt=[5, 2, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (1) | Train Loss: 0.2897 | Train Acc: 0.9111
 Site-MNIST                     (1) | Train Loss: 0.2295 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2818 | Train Acc: 0.9211
 Site-MNIST                     (1) | Train Loss: 0.2821 | Train Acc: 0.9251
 Site-MNIST                     (1) | Train Loss: 0.2489 | Train Acc: 0.9431
 Site-USPS                      (3) | Train Loss: 0.3393 | Train Acc: 0.9065
 Site-USPS                      (3) | Train Loss: 0.3151 | Train Acc: 0.9105
 Site-USPS                      (3) | Train Loss: 0.3127 | Train Acc: 0.9169
 Site-SynthDigits               (0) | Train Loss: 0.5245 | Train Acc: 0.8523
 Site-SynthDigits               (0) | Train Loss: 0.4671 | Train Acc: 0.8851
 Site-MNIST_M                   (2) | Train Loss: 0.7697 | Train Acc: 0.7812
 Site-MNIST_M                   (2) | Train Loss: 0.7368 | Train Acc: 0.7879
 Site-SVHN                      (4) | Train Loss: 0.9551 | Train Acc: 0.6814
Average Train Accuracy: 0.8743
 Site-MNIST                     (1) | Val  Loss: 0.2146 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2118 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2548 | Val  Acc: 0.9365
 Site-MNIST                     (1) | Val  Loss: 0.3021 | Val  Acc: 0.9421
 Site-MNIST                     (1) | Val  Loss: 0.2539 | Val  Acc: 0.9439
 Site-USPS                      (3) | Val  Loss: 0.2487 | Val  Acc: 0.9423
 Site-USPS                      (3) | Val  Loss: 0.3140 | Val  Acc: 0.8910
 Site-USPS                      (3) | Val  Loss: 0.3709 | Val  Acc: 0.8718
 Site-SynthDigits               (0) | Val  Loss: 0.6028 | Val  Acc: 0.8636
 Site-SynthDigits               (0) | Val  Loss: 0.4185 | Val  Acc: 0.8687
 Site-MNIST_M                   (2) | Val  Loss: 0.8222 | Val  Acc: 0.7614
 Site-MNIST_M                   (2) | Val  Loss: 0.8262 | Val  Acc: 0.7955
 Site-SVHN                      (4) | Val  Loss: 0.9770 | Val  Acc: 0.6849
Average Valid Accuracy: 0.8751
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9365
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9421
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9439
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.9423
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.8910
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.8718
 Best site-SynthDigits              (0)  | Epoch:24 | Val Acc: 0.8636
 Best site-SynthDigits              (0)  | Epoch:24 | Val Acc: 0.8687
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.7614
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.7955
 Best site-SVHN                     (4)  | Epoch:24 | Val Acc: 0.6849
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 25 ============
cnt=[3, 5, 2, 2, 1, ]
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (1) | Train Loss: 0.2799 | Train Acc: 0.9156
 Site-MNIST                     (1) | Train Loss: 0.2178 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2781 | Train Acc: 0.9172
 Site-MNIST                     (1) | Train Loss: 0.2787 | Train Acc: 0.9159
 Site-MNIST                     (1) | Train Loss: 0.2439 | Train Acc: 0.9448
 Site-USPS                      (0) | Train Loss: 0.3306 | Train Acc: 0.8993
 Site-USPS                      (0) | Train Loss: 0.3108 | Train Acc: 0.9121
 Site-USPS                      (0) | Train Loss: 0.3021 | Train Acc: 0.9201
 Site-SynthDigits               (2) | Train Loss: 0.5094 | Train Acc: 0.8598
 Site-SynthDigits               (2) | Train Loss: 0.4459 | Train Acc: 0.8977
 Site-MNIST_M                   (3) | Train Loss: 0.7476 | Train Acc: 0.7926
 Site-MNIST_M                   (3) | Train Loss: 0.7280 | Train Acc: 0.7841
 Site-SVHN                      (4) | Train Loss: 0.9521 | Train Acc: 0.6899
Average Train Accuracy: 0.8764
 Site-MNIST                     (1) | Val  Loss: 0.2200 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2150 | Val  Acc: 0.9167
 Site-MNIST                     (1) | Val  Loss: 0.2510 | Val  Acc: 0.9365
 Site-MNIST                     (1) | Val  Loss: 0.2968 | Val  Acc: 0.9421
 Site-MNIST                     (1) | Val  Loss: 0.2504 | Val  Acc: 0.9404
 Site-USPS                      (0) | Val  Loss: 0.2456 | Val  Acc: 0.9423
 Site-USPS                      (0) | Val  Loss: 0.3043 | Val  Acc: 0.8782
 Site-USPS                      (0) | Val  Loss: 0.3591 | Val  Acc: 0.8718
 Site-SynthDigits               (2) | Val  Loss: 0.5915 | Val  Acc: 0.8485
 Site-SynthDigits               (2) | Val  Loss: 0.4049 | Val  Acc: 0.8788
 Site-MNIST_M                   (3) | Val  Loss: 0.8019 | Val  Acc: 0.7841
 Site-MNIST_M                   (3) | Val  Loss: 0.8035 | Val  Acc: 0.8182
 Site-SVHN                      (4) | Val  Loss: 0.9746 | Val  Acc: 0.6781
Average Valid Accuracy: 0.8742
============ Train epoch 26 ============
cnt=[3, 5, 2, 2, 1, ]
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (1) | Train Loss: 0.2663 | Train Acc: 0.9111
 Site-MNIST                     (1) | Train Loss: 0.2236 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2750 | Train Acc: 0.9211
 Site-MNIST                     (1) | Train Loss: 0.2771 | Train Acc: 0.9185
 Site-MNIST                     (1) | Train Loss: 0.2438 | Train Acc: 0.9422
 Site-USPS                      (0) | Train Loss: 0.3265 | Train Acc: 0.9089
 Site-USPS                      (0) | Train Loss: 0.2988 | Train Acc: 0.9137
 Site-USPS                      (0) | Train Loss: 0.2947 | Train Acc: 0.9212
 Site-SynthDigits               (3) | Train Loss: 0.4851 | Train Acc: 0.8580
 Site-SynthDigits               (3) | Train Loss: 0.4412 | Train Acc: 0.8977
 Site-MNIST_M                   (2) | Train Loss: 0.7456 | Train Acc: 0.7926
 Site-MNIST_M                   (2) | Train Loss: 0.7342 | Train Acc: 0.7879
 Site-SVHN                      (4) | Train Loss: 0.9290 | Train Acc: 0.7019
Average Train Accuracy: 0.8784
 Site-MNIST                     (1) | Val  Loss: 0.2222 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.2173 | Val  Acc: 0.9167
 Site-MNIST                     (1) | Val  Loss: 0.2486 | Val  Acc: 0.9365
 Site-MNIST                     (1) | Val  Loss: 0.2934 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.2491 | Val  Acc: 0.9368
 Site-USPS                      (0) | Val  Loss: 0.2438 | Val  Acc: 0.9327
 Site-USPS                      (0) | Val  Loss: 0.2955 | Val  Acc: 0.8846
 Site-USPS                      (0) | Val  Loss: 0.3472 | Val  Acc: 0.8718
 Site-SynthDigits               (3) | Val  Loss: 0.5694 | Val  Acc: 0.8485
 Site-SynthDigits               (3) | Val  Loss: 0.3922 | Val  Acc: 0.8889
 Site-MNIST_M                   (2) | Val  Loss: 0.7948 | Val  Acc: 0.7614
 Site-MNIST_M                   (2) | Val  Loss: 0.8081 | Val  Acc: 0.7879
 Site-SVHN                      (4) | Val  Loss: 0.9419 | Val  Acc: 0.6849
Average Valid Accuracy: 0.8691
============ Train epoch 27 ============
cnt=[5, 2, 2, 3, 1, ]
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (0) | Train Loss: 0.2747 | Train Acc: 0.9111
 Site-MNIST                     (0) | Train Loss: 0.2326 | Train Acc: 0.9467
 Site-MNIST                     (0) | Train Loss: 0.2754 | Train Acc: 0.9172
 Site-MNIST                     (0) | Train Loss: 0.2764 | Train Acc: 0.9212
 Site-MNIST                     (0) | Train Loss: 0.2397 | Train Acc: 0.9457
 Site-USPS                      (3) | Train Loss: 0.3134 | Train Acc: 0.9065
 Site-USPS                      (3) | Train Loss: 0.2986 | Train Acc: 0.9073
 Site-USPS                      (3) | Train Loss: 0.2893 | Train Acc: 0.9127
 Site-SynthDigits               (1) | Train Loss: 0.4769 | Train Acc: 0.8655
 Site-SynthDigits               (1) | Train Loss: 0.4369 | Train Acc: 0.8990
 Site-MNIST_M                   (2) | Train Loss: 0.7322 | Train Acc: 0.7756
 Site-MNIST_M                   (2) | Train Loss: 0.7024 | Train Acc: 0.7879
 Site-SVHN                      (4) | Train Loss: 0.8656 | Train Acc: 0.7121
Average Train Accuracy: 0.8776
 Site-MNIST                     (0) | Val  Loss: 0.2140 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2158 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2523 | Val  Acc: 0.9365
 Site-MNIST                     (0) | Val  Loss: 0.2951 | Val  Acc: 0.9316
 Site-MNIST                     (0) | Val  Loss: 0.2477 | Val  Acc: 0.9368
 Site-USPS                      (3) | Val  Loss: 0.2435 | Val  Acc: 0.9423
 Site-USPS                      (3) | Val  Loss: 0.2887 | Val  Acc: 0.8910
 Site-USPS                      (3) | Val  Loss: 0.3402 | Val  Acc: 0.8718
 Site-SynthDigits               (1) | Val  Loss: 0.5595 | Val  Acc: 0.8409
 Site-SynthDigits               (1) | Val  Loss: 0.3806 | Val  Acc: 0.8838
 Site-MNIST_M                   (2) | Val  Loss: 0.7682 | Val  Acc: 0.7841
 Site-MNIST_M                   (2) | Val  Loss: 0.7876 | Val  Acc: 0.7879
 Site-SVHN                      (4) | Val  Loss: 0.9083 | Val  Acc: 0.6781
Average Valid Accuracy: 0.8725
============ Train epoch 28 ============
cnt=[2, 5, 2, 3, 1, ]
cnt=[5, 3, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (1) | Train Loss: 0.2448 | Train Acc: 0.9200
 Site-MNIST                     (1) | Train Loss: 0.2371 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2637 | Train Acc: 0.9211
 Site-MNIST                     (1) | Train Loss: 0.2666 | Train Acc: 0.9238
 Site-MNIST                     (1) | Train Loss: 0.2312 | Train Acc: 0.9457
 Site-USPS                      (3) | Train Loss: 0.3137 | Train Acc: 0.9089
 Site-USPS                      (3) | Train Loss: 0.2935 | Train Acc: 0.9121
 Site-USPS                      (3) | Train Loss: 0.2883 | Train Acc: 0.9159
 Site-SynthDigits               (2) | Train Loss: 0.4678 | Train Acc: 0.8712
 Site-SynthDigits               (2) | Train Loss: 0.4116 | Train Acc: 0.9078
 Site-MNIST_M                   (0) | Train Loss: 0.7150 | Train Acc: 0.8040
 Site-MNIST_M                   (0) | Train Loss: 0.6852 | Train Acc: 0.8011
 Site-SVHN                      (4) | Train Loss: 0.8785 | Train Acc: 0.7223
Average Train Accuracy: 0.8844
 Site-MNIST                     (1) | Val  Loss: 0.2031 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2038 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2440 | Val  Acc: 0.9365
 Site-MNIST                     (1) | Val  Loss: 0.2853 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.2374 | Val  Acc: 0.9404
 Site-USPS                      (3) | Val  Loss: 0.2417 | Val  Acc: 0.9327
 Site-USPS                      (3) | Val  Loss: 0.2838 | Val  Acc: 0.8910
 Site-USPS                      (3) | Val  Loss: 0.3369 | Val  Acc: 0.8675
 Site-SynthDigits               (2) | Val  Loss: 0.5431 | Val  Acc: 0.8636
 Site-SynthDigits               (2) | Val  Loss: 0.3686 | Val  Acc: 0.8889
 Site-MNIST_M                   (0) | Val  Loss: 0.7696 | Val  Acc: 0.7955
 Site-MNIST_M                   (0) | Val  Loss: 0.7805 | Val  Acc: 0.8030
 Site-SVHN                      (4) | Val  Loss: 0.8987 | Val  Acc: 0.6986
Average Valid Accuracy: 0.8778
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9365
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9368
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9404
 Best site-USPS                     (3)  | Epoch:28 | Val Acc: 0.9327
 Best site-USPS                     (3)  | Epoch:28 | Val Acc: 0.8910
 Best site-USPS                     (3)  | Epoch:28 | Val Acc: 0.8675
 Best site-SynthDigits              (2)  | Epoch:28 | Val Acc: 0.8636
 Best site-SynthDigits              (2)  | Epoch:28 | Val Acc: 0.8889
 Best site-MNIST_M                  (0)  | Epoch:28 | Val Acc: 0.7955
 Best site-MNIST_M                  (0)  | Epoch:28 | Val Acc: 0.8030
 Best site-SVHN                     (4)  | Epoch:28 | Val Acc: 0.6986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 29 ============
cnt=[1, 5, 2, 3, 2, ]
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (1) | Train Loss: 0.2641 | Train Acc: 0.9244
 Site-MNIST                     (1) | Train Loss: 0.2256 | Train Acc: 0.9467
 Site-MNIST                     (1) | Train Loss: 0.2553 | Train Acc: 0.9231
 Site-MNIST                     (1) | Train Loss: 0.2576 | Train Acc: 0.9225
 Site-MNIST                     (1) | Train Loss: 0.2237 | Train Acc: 0.9466
 Site-USPS                      (3) | Train Loss: 0.3053 | Train Acc: 0.9137
 Site-USPS                      (3) | Train Loss: 0.2807 | Train Acc: 0.9249
 Site-USPS                      (3) | Train Loss: 0.2790 | Train Acc: 0.9191
 Site-SynthDigits               (4) | Train Loss: 0.4605 | Train Acc: 0.8636
 Site-SynthDigits               (4) | Train Loss: 0.4092 | Train Acc: 0.9028
 Site-MNIST_M                   (2) | Train Loss: 0.6802 | Train Acc: 0.8097
 Site-MNIST_M                   (2) | Train Loss: 0.6844 | Train Acc: 0.8030
 Site-SVHN                      (0) | Train Loss: 0.8464 | Train Acc: 0.7087
Average Train Accuracy: 0.8853
 Site-MNIST                     (1) | Val  Loss: 0.1950 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.1960 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2355 | Val  Acc: 0.9365
 Site-MNIST                     (1) | Val  Loss: 0.2745 | Val  Acc: 0.9421
 Site-MNIST                     (1) | Val  Loss: 0.2299 | Val  Acc: 0.9404
 Site-USPS                      (3) | Val  Loss: 0.2305 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2794 | Val  Acc: 0.8974
 Site-USPS                      (3) | Val  Loss: 0.3299 | Val  Acc: 0.8803
 Site-SynthDigits               (4) | Val  Loss: 0.5265 | Val  Acc: 0.8561
 Site-SynthDigits               (4) | Val  Loss: 0.3694 | Val  Acc: 0.8889
 Site-MNIST_M                   (2) | Val  Loss: 0.7451 | Val  Acc: 0.7727
 Site-MNIST_M                   (2) | Val  Loss: 0.7539 | Val  Acc: 0.8106
 Site-SVHN                      (0) | Val  Loss: 0.9002 | Val  Acc: 0.6712
Average Valid Accuracy: 0.8781
 Best site-MNIST                    (1)  | Epoch:29 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:29 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:29 | Val Acc: 0.9365
 Best site-MNIST                    (1)  | Epoch:29 | Val Acc: 0.9421
 Best site-MNIST                    (1)  | Epoch:29 | Val Acc: 0.9404
 Best site-USPS                     (3)  | Epoch:29 | Val Acc: 0.9615
 Best site-USPS                     (3)  | Epoch:29 | Val Acc: 0.8974
 Best site-USPS                     (3)  | Epoch:29 | Val Acc: 0.8803
 Best site-SynthDigits              (4)  | Epoch:29 | Val Acc: 0.8561
 Best site-SynthDigits              (4)  | Epoch:29 | Val Acc: 0.8889
 Best site-MNIST_M                  (2)  | Epoch:29 | Val Acc: 0.7727
 Best site-MNIST_M                  (2)  | Epoch:29 | Val Acc: 0.8106
 Best site-SVHN                     (0)  | Epoch:29 | Val Acc: 0.6712
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 30 ============
cnt=[2, 5, 2, 3, 1, ]
cnt=[1, 5, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (1) | Train Loss: 0.2569 | Train Acc: 0.9156
 Site-MNIST                     (1) | Train Loss: 0.2051 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2497 | Train Acc: 0.9250
 Site-MNIST                     (1) | Train Loss: 0.2527 | Train Acc: 0.9290
 Site-MNIST                     (1) | Train Loss: 0.2222 | Train Acc: 0.9475
 Site-USPS                      (3) | Train Loss: 0.3025 | Train Acc: 0.9113
 Site-USPS                      (3) | Train Loss: 0.2811 | Train Acc: 0.9137
 Site-USPS                      (3) | Train Loss: 0.2770 | Train Acc: 0.9244
 Site-SynthDigits               (0) | Train Loss: 0.4432 | Train Acc: 0.8655
 Site-SynthDigits               (0) | Train Loss: 0.4021 | Train Acc: 0.9053
 Site-MNIST_M                   (2) | Train Loss: 0.7010 | Train Acc: 0.7955
 Site-MNIST_M                   (2) | Train Loss: 0.6645 | Train Acc: 0.8106
 Site-SVHN                      (4) | Train Loss: 0.8533 | Train Acc: 0.7308
Average Train Accuracy: 0.8860
 Site-MNIST                     (1) | Val  Loss: 0.1920 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.1918 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2312 | Val  Acc: 0.9444
 Site-MNIST                     (1) | Val  Loss: 0.2720 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.2251 | Val  Acc: 0.9439
 Site-USPS                      (3) | Val  Loss: 0.2326 | Val  Acc: 0.9519
 Site-USPS                      (3) | Val  Loss: 0.2753 | Val  Acc: 0.9038
 Site-USPS                      (3) | Val  Loss: 0.3272 | Val  Acc: 0.8846
 Site-SynthDigits               (0) | Val  Loss: 0.5156 | Val  Acc: 0.8485
 Site-SynthDigits               (0) | Val  Loss: 0.3531 | Val  Acc: 0.8939
 Site-MNIST_M                   (2) | Val  Loss: 0.7536 | Val  Acc: 0.7500
 Site-MNIST_M                   (2) | Val  Loss: 0.7638 | Val  Acc: 0.7955
 Site-SVHN                      (4) | Val  Loss: 0.8725 | Val  Acc: 0.6849
Average Valid Accuracy: 0.8774
============ Train epoch 31 ============
cnt=[3, 5, 2, 2, 1, ]
cnt=[2, 5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (1) | Train Loss: 0.2393 | Train Acc: 0.9200
 Site-MNIST                     (1) | Train Loss: 0.2002 | Train Acc: 0.9467
 Site-MNIST                     (1) | Train Loss: 0.2421 | Train Acc: 0.9270
 Site-MNIST                     (1) | Train Loss: 0.2438 | Train Acc: 0.9304
 Site-MNIST                     (1) | Train Loss: 0.2145 | Train Acc: 0.9475
 Site-USPS                      (0) | Train Loss: 0.3009 | Train Acc: 0.9089
 Site-USPS                      (0) | Train Loss: 0.2780 | Train Acc: 0.9265
 Site-USPS                      (0) | Train Loss: 0.2710 | Train Acc: 0.9212
 Site-SynthDigits               (3) | Train Loss: 0.4424 | Train Acc: 0.8655
 Site-SynthDigits               (3) | Train Loss: 0.3819 | Train Acc: 0.9141
 Site-MNIST_M                   (2) | Train Loss: 0.6799 | Train Acc: 0.8210
 Site-MNIST_M                   (2) | Train Loss: 0.6694 | Train Acc: 0.8125
 Site-SVHN                      (4) | Train Loss: 0.8051 | Train Acc: 0.7479
Average Train Accuracy: 0.8915
 Site-MNIST                     (1) | Val  Loss: 0.1890 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.1863 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2261 | Val  Acc: 0.9365
 Site-MNIST                     (1) | Val  Loss: 0.2637 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.2186 | Val  Acc: 0.9474
 Site-USPS                      (0) | Val  Loss: 0.2187 | Val  Acc: 0.9519
 Site-USPS                      (0) | Val  Loss: 0.2678 | Val  Acc: 0.8974
 Site-USPS                      (0) | Val  Loss: 0.3240 | Val  Acc: 0.8718
 Site-SynthDigits               (3) | Val  Loss: 0.5055 | Val  Acc: 0.8561
 Site-SynthDigits               (3) | Val  Loss: 0.3476 | Val  Acc: 0.8939
 Site-MNIST_M                   (2) | Val  Loss: 0.7330 | Val  Acc: 0.7614
 Site-MNIST_M                   (2) | Val  Loss: 0.7397 | Val  Acc: 0.8106
 Site-SVHN                      (4) | Val  Loss: 0.8349 | Val  Acc: 0.6918
Average Valid Accuracy: 0.8787
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9365
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9474
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9474
 Best site-USPS                     (0)  | Epoch:31 | Val Acc: 0.9519
 Best site-USPS                     (0)  | Epoch:31 | Val Acc: 0.8974
 Best site-USPS                     (0)  | Epoch:31 | Val Acc: 0.8718
 Best site-SynthDigits              (3)  | Epoch:31 | Val Acc: 0.8561
 Best site-SynthDigits              (3)  | Epoch:31 | Val Acc: 0.8939
 Best site-MNIST_M                  (2)  | Epoch:31 | Val Acc: 0.7614
 Best site-MNIST_M                  (2)  | Epoch:31 | Val Acc: 0.8106
 Best site-SVHN                     (4)  | Epoch:31 | Val Acc: 0.6918
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 32 ============
cnt=[5, 2, 2, 3, 1, ]
cnt=[1, 5, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (0) | Train Loss: 0.2627 | Train Acc: 0.9200
 Site-MNIST                     (0) | Train Loss: 0.2126 | Train Acc: 0.9408
 Site-MNIST                     (0) | Train Loss: 0.2462 | Train Acc: 0.9250
 Site-MNIST                     (0) | Train Loss: 0.2504 | Train Acc: 0.9225
 Site-MNIST                     (0) | Train Loss: 0.2174 | Train Acc: 0.9431
 Site-USPS                      (3) | Train Loss: 0.2813 | Train Acc: 0.9161
 Site-USPS                      (3) | Train Loss: 0.2641 | Train Acc: 0.9233
 Site-USPS                      (3) | Train Loss: 0.2622 | Train Acc: 0.9265
 Site-SynthDigits               (1) | Train Loss: 0.4524 | Train Acc: 0.8731
 Site-SynthDigits               (1) | Train Loss: 0.3757 | Train Acc: 0.9141
 Site-MNIST_M                   (2) | Train Loss: 0.6413 | Train Acc: 0.8267
 Site-MNIST_M                   (2) | Train Loss: 0.6270 | Train Acc: 0.8163
 Site-SVHN                      (4) | Train Loss: 0.7953 | Train Acc: 0.7462
Average Train Accuracy: 0.8918
 Site-MNIST                     (0) | Val  Loss: 0.1998 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.1954 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2280 | Val  Acc: 0.9365
 Site-MNIST                     (0) | Val  Loss: 0.2626 | Val  Acc: 0.9368
 Site-MNIST                     (0) | Val  Loss: 0.2217 | Val  Acc: 0.9368
 Site-USPS                      (3) | Val  Loss: 0.2084 | Val  Acc: 0.9519
 Site-USPS                      (3) | Val  Loss: 0.2583 | Val  Acc: 0.9038
 Site-USPS                      (3) | Val  Loss: 0.3091 | Val  Acc: 0.8846
 Site-SynthDigits               (1) | Val  Loss: 0.5132 | Val  Acc: 0.8712
 Site-SynthDigits               (1) | Val  Loss: 0.3363 | Val  Acc: 0.8889
 Site-MNIST_M                   (2) | Val  Loss: 0.6840 | Val  Acc: 0.7841
 Site-MNIST_M                   (2) | Val  Loss: 0.7195 | Val  Acc: 0.8258
 Site-SVHN                      (4) | Val  Loss: 0.8468 | Val  Acc: 0.7123
Average Valid Accuracy: 0.8838
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9365
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9368
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9368
 Best site-USPS                     (3)  | Epoch:32 | Val Acc: 0.9519
 Best site-USPS                     (3)  | Epoch:32 | Val Acc: 0.9038
 Best site-USPS                     (3)  | Epoch:32 | Val Acc: 0.8846
 Best site-SynthDigits              (1)  | Epoch:32 | Val Acc: 0.8712
 Best site-SynthDigits              (1)  | Epoch:32 | Val Acc: 0.8889
 Best site-MNIST_M                  (2)  | Epoch:32 | Val Acc: 0.7841
 Best site-MNIST_M                  (2)  | Epoch:32 | Val Acc: 0.8258
 Best site-SVHN                     (4)  | Epoch:32 | Val Acc: 0.7123
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 33 ============
cnt=[1, 5, 2, 3, 2, ]
cnt=[5, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (1) | Train Loss: 0.2458 | Train Acc: 0.9289
 Site-MNIST                     (1) | Train Loss: 0.1958 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2328 | Train Acc: 0.9270
 Site-MNIST                     (1) | Train Loss: 0.2403 | Train Acc: 0.9317
 Site-MNIST                     (1) | Train Loss: 0.2112 | Train Acc: 0.9440
 Site-USPS                      (3) | Train Loss: 0.2850 | Train Acc: 0.9161
 Site-USPS                      (3) | Train Loss: 0.2625 | Train Acc: 0.9329
 Site-USPS                      (3) | Train Loss: 0.2583 | Train Acc: 0.9276
 Site-SynthDigits               (4) | Train Loss: 0.4308 | Train Acc: 0.8655
 Site-SynthDigits               (4) | Train Loss: 0.3769 | Train Acc: 0.9192
 Site-MNIST_M                   (2) | Train Loss: 0.6405 | Train Acc: 0.8182
 Site-MNIST_M                   (2) | Train Loss: 0.6282 | Train Acc: 0.8201
 Site-SVHN                      (0) | Train Loss: 0.8060 | Train Acc: 0.7581
Average Train Accuracy: 0.8948
 Site-MNIST                     (1) | Val  Loss: 0.1820 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.1807 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2228 | Val  Acc: 0.9365
 Site-MNIST                     (1) | Val  Loss: 0.2537 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.2107 | Val  Acc: 0.9404
 Site-USPS                      (3) | Val  Loss: 0.1980 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2540 | Val  Acc: 0.9167
 Site-USPS                      (3) | Val  Loss: 0.3077 | Val  Acc: 0.8846
 Site-SynthDigits               (4) | Val  Loss: 0.5101 | Val  Acc: 0.8485
 Site-SynthDigits               (4) | Val  Loss: 0.3375 | Val  Acc: 0.8990
 Site-MNIST_M                   (2) | Val  Loss: 0.6892 | Val  Acc: 0.7727
 Site-MNIST_M                   (2) | Val  Loss: 0.7113 | Val  Acc: 0.8258
 Site-SVHN                      (0) | Val  Loss: 0.8103 | Val  Acc: 0.7055
Average Valid Accuracy: 0.8843
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9365
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9474
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9404
 Best site-USPS                     (3)  | Epoch:33 | Val Acc: 0.9615
 Best site-USPS                     (3)  | Epoch:33 | Val Acc: 0.9167
 Best site-USPS                     (3)  | Epoch:33 | Val Acc: 0.8846
 Best site-SynthDigits              (4)  | Epoch:33 | Val Acc: 0.8485
 Best site-SynthDigits              (4)  | Epoch:33 | Val Acc: 0.8990
 Best site-MNIST_M                  (2)  | Epoch:33 | Val Acc: 0.7727
 Best site-MNIST_M                  (2)  | Epoch:33 | Val Acc: 0.8258
 Best site-SVHN                     (0)  | Epoch:33 | Val Acc: 0.7055
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 34 ============
cnt=[1, 5, 2, 3, 2, ]
cnt=[5, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (1) | Train Loss: 0.2438 | Train Acc: 0.9244
 Site-MNIST                     (1) | Train Loss: 0.1855 | Train Acc: 0.9527
 Site-MNIST                     (1) | Train Loss: 0.2332 | Train Acc: 0.9310
 Site-MNIST                     (1) | Train Loss: 0.2408 | Train Acc: 0.9290
 Site-MNIST                     (1) | Train Loss: 0.2069 | Train Acc: 0.9483
 Site-USPS                      (3) | Train Loss: 0.2786 | Train Acc: 0.9137
 Site-USPS                      (3) | Train Loss: 0.2570 | Train Acc: 0.9281
 Site-USPS                      (3) | Train Loss: 0.2551 | Train Acc: 0.9223
 Site-SynthDigits               (4) | Train Loss: 0.4034 | Train Acc: 0.8826
 Site-SynthDigits               (4) | Train Loss: 0.3602 | Train Acc: 0.9167
 Site-MNIST_M                   (2) | Train Loss: 0.6020 | Train Acc: 0.8295
 Site-MNIST_M                   (2) | Train Loss: 0.6390 | Train Acc: 0.8182
 Site-SVHN                      (0) | Train Loss: 0.8432 | Train Acc: 0.7598
Average Train Accuracy: 0.8966
 Site-MNIST                     (1) | Val  Loss: 0.1800 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.1823 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2229 | Val  Acc: 0.9444
 Site-MNIST                     (1) | Val  Loss: 0.2528 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.2100 | Val  Acc: 0.9544
 Site-USPS                      (3) | Val  Loss: 0.2027 | Val  Acc: 0.9519
 Site-USPS                      (3) | Val  Loss: 0.2486 | Val  Acc: 0.9103
 Site-USPS                      (3) | Val  Loss: 0.3009 | Val  Acc: 0.8803
 Site-SynthDigits               (4) | Val  Loss: 0.4906 | Val  Acc: 0.8788
 Site-SynthDigits               (4) | Val  Loss: 0.3213 | Val  Acc: 0.9040
 Site-MNIST_M                   (2) | Val  Loss: 0.6576 | Val  Acc: 0.7841
 Site-MNIST_M                   (2) | Val  Loss: 0.6829 | Val  Acc: 0.8258
 Site-SVHN                      (0) | Val  Loss: 0.8241 | Val  Acc: 0.7123
Average Valid Accuracy: 0.8885
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9444
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9474
 Best site-MNIST                    (1)  | Epoch:34 | Val Acc: 0.9544
 Best site-USPS                     (3)  | Epoch:34 | Val Acc: 0.9519
 Best site-USPS                     (3)  | Epoch:34 | Val Acc: 0.9103
 Best site-USPS                     (3)  | Epoch:34 | Val Acc: 0.8803
 Best site-SynthDigits              (4)  | Epoch:34 | Val Acc: 0.8788
 Best site-SynthDigits              (4)  | Epoch:34 | Val Acc: 0.9040
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.7841
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.8258
 Best site-SVHN                     (0)  | Epoch:34 | Val Acc: 0.7123
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 35 ============
cnt=[5, 2, 2, 3, 1, ]
cnt=[5, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (0) | Train Loss: 0.2149 | Train Acc: 0.9333
 Site-MNIST                     (0) | Train Loss: 0.1739 | Train Acc: 0.9556
 Site-MNIST                     (0) | Train Loss: 0.2236 | Train Acc: 0.9329
 Site-MNIST                     (0) | Train Loss: 0.2331 | Train Acc: 0.9290
 Site-MNIST                     (0) | Train Loss: 0.2014 | Train Acc: 0.9483
 Site-USPS                      (3) | Train Loss: 0.2844 | Train Acc: 0.9089
 Site-USPS                      (3) | Train Loss: 0.2485 | Train Acc: 0.9393
 Site-USPS                      (3) | Train Loss: 0.2525 | Train Acc: 0.9276
 Site-SynthDigits               (1) | Train Loss: 0.4603 | Train Acc: 0.8693
 Site-SynthDigits               (1) | Train Loss: 0.3583 | Train Acc: 0.9205
 Site-MNIST_M                   (2) | Train Loss: 0.6252 | Train Acc: 0.8324
 Site-MNIST_M                   (2) | Train Loss: 0.6120 | Train Acc: 0.8428
 Site-SVHN                      (4) | Train Loss: 0.7560 | Train Acc: 0.7615
Average Train Accuracy: 0.9001
 Site-MNIST                     (0) | Val  Loss: 0.1691 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.1723 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2148 | Val  Acc: 0.9444
 Site-MNIST                     (0) | Val  Loss: 0.2468 | Val  Acc: 0.9421
 Site-MNIST                     (0) | Val  Loss: 0.2040 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1928 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2462 | Val  Acc: 0.9038
 Site-USPS                      (3) | Val  Loss: 0.3011 | Val  Acc: 0.8803
 Site-SynthDigits               (1) | Val  Loss: 0.4918 | Val  Acc: 0.8712
 Site-SynthDigits               (1) | Val  Loss: 0.3195 | Val  Acc: 0.8990
 Site-MNIST_M                   (2) | Val  Loss: 0.6836 | Val  Acc: 0.7841
 Site-MNIST_M                   (2) | Val  Loss: 0.6997 | Val  Acc: 0.8106
 Site-SVHN                      (4) | Val  Loss: 0.7813 | Val  Acc: 0.6986
Average Valid Accuracy: 0.8863
============ Train epoch 36 ============
cnt=[2, 5, 2, 3, 1, ]
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (1) | Train Loss: 0.2149 | Train Acc: 0.9378
 Site-MNIST                     (1) | Train Loss: 0.1714 | Train Acc: 0.9527
 Site-MNIST                     (1) | Train Loss: 0.2183 | Train Acc: 0.9329
 Site-MNIST                     (1) | Train Loss: 0.2266 | Train Acc: 0.9330
 Site-MNIST                     (1) | Train Loss: 0.1940 | Train Acc: 0.9501
 Site-USPS                      (3) | Train Loss: 0.2686 | Train Acc: 0.9137
 Site-USPS                      (3) | Train Loss: 0.2432 | Train Acc: 0.9345
 Site-USPS                      (3) | Train Loss: 0.2455 | Train Acc: 0.9297
 Site-SynthDigits               (2) | Train Loss: 0.3897 | Train Acc: 0.8807
 Site-SynthDigits               (2) | Train Loss: 0.3462 | Train Acc: 0.9179
 Site-MNIST_M                   (0) | Train Loss: 0.5940 | Train Acc: 0.8523
 Site-MNIST_M                   (0) | Train Loss: 0.6137 | Train Acc: 0.8352
 Site-SVHN                      (4) | Train Loss: 0.8017 | Train Acc: 0.7564
Average Train Accuracy: 0.9021
 Site-MNIST                     (1) | Val  Loss: 0.1614 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.1681 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2078 | Val  Acc: 0.9524
 Site-MNIST                     (1) | Val  Loss: 0.2404 | Val  Acc: 0.9421
 Site-MNIST                     (1) | Val  Loss: 0.1985 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1890 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2394 | Val  Acc: 0.9038
 Site-USPS                      (3) | Val  Loss: 0.2892 | Val  Acc: 0.8803
 Site-SynthDigits               (2) | Val  Loss: 0.4716 | Val  Acc: 0.8712
 Site-SynthDigits               (2) | Val  Loss: 0.3103 | Val  Acc: 0.9091
 Site-MNIST_M                   (0) | Val  Loss: 0.6621 | Val  Acc: 0.7955
 Site-MNIST_M                   (0) | Val  Loss: 0.6810 | Val  Acc: 0.8182
 Site-SVHN                      (4) | Val  Loss: 0.7817 | Val  Acc: 0.7192
Average Valid Accuracy: 0.8907
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9524
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9421
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9509
 Best site-USPS                     (3)  | Epoch:36 | Val Acc: 0.9615
 Best site-USPS                     (3)  | Epoch:36 | Val Acc: 0.9038
 Best site-USPS                     (3)  | Epoch:36 | Val Acc: 0.8803
 Best site-SynthDigits              (2)  | Epoch:36 | Val Acc: 0.8712
 Best site-SynthDigits              (2)  | Epoch:36 | Val Acc: 0.9091
 Best site-MNIST_M                  (0)  | Epoch:36 | Val Acc: 0.7955
 Best site-MNIST_M                  (0)  | Epoch:36 | Val Acc: 0.8182
 Best site-SVHN                     (4)  | Epoch:36 | Val Acc: 0.7192
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 37 ============
cnt=[5, 2, 2, 3, 1, ]
cnt=[5, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (0) | Train Loss: 0.2212 | Train Acc: 0.9378
 Site-MNIST                     (0) | Train Loss: 0.1880 | Train Acc: 0.9586
 Site-MNIST                     (0) | Train Loss: 0.2152 | Train Acc: 0.9369
 Site-MNIST                     (0) | Train Loss: 0.2243 | Train Acc: 0.9330
 Site-MNIST                     (0) | Train Loss: 0.1915 | Train Acc: 0.9501
 Site-USPS                      (3) | Train Loss: 0.2694 | Train Acc: 0.9137
 Site-USPS                      (3) | Train Loss: 0.2438 | Train Acc: 0.9345
 Site-USPS                      (3) | Train Loss: 0.2409 | Train Acc: 0.9308
 Site-SynthDigits               (1) | Train Loss: 0.4011 | Train Acc: 0.8845
 Site-SynthDigits               (1) | Train Loss: 0.3418 | Train Acc: 0.9217
 Site-MNIST_M                   (2) | Train Loss: 0.5884 | Train Acc: 0.8551
 Site-MNIST_M                   (2) | Train Loss: 0.6064 | Train Acc: 0.8409
 Site-SVHN                      (4) | Train Loss: 0.7596 | Train Acc: 0.7666
Average Train Accuracy: 0.9049
 Site-MNIST                     (0) | Val  Loss: 0.1598 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1677 | Val  Acc: 0.9405
 Site-MNIST                     (0) | Val  Loss: 0.2037 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2350 | Val  Acc: 0.9368
 Site-MNIST                     (0) | Val  Loss: 0.1954 | Val  Acc: 0.9544
 Site-USPS                      (3) | Val  Loss: 0.1846 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2337 | Val  Acc: 0.8974
 Site-USPS                      (3) | Val  Loss: 0.2810 | Val  Acc: 0.8803
 Site-SynthDigits               (1) | Val  Loss: 0.4739 | Val  Acc: 0.8788
 Site-SynthDigits               (1) | Val  Loss: 0.3087 | Val  Acc: 0.9141
 Site-MNIST_M                   (2) | Val  Loss: 0.6666 | Val  Acc: 0.7841
 Site-MNIST_M                   (2) | Val  Loss: 0.6698 | Val  Acc: 0.8409
 Site-SVHN                      (4) | Val  Loss: 0.7631 | Val  Acc: 0.7329
Average Valid Accuracy: 0.8953
 Best site-MNIST                    (0)  | Epoch:37 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:37 | Val Acc: 0.9405
 Best site-MNIST                    (0)  | Epoch:37 | Val Acc: 0.9524
 Best site-MNIST                    (0)  | Epoch:37 | Val Acc: 0.9368
 Best site-MNIST                    (0)  | Epoch:37 | Val Acc: 0.9544
 Best site-USPS                     (3)  | Epoch:37 | Val Acc: 0.9615
 Best site-USPS                     (3)  | Epoch:37 | Val Acc: 0.8974
 Best site-USPS                     (3)  | Epoch:37 | Val Acc: 0.8803
 Best site-SynthDigits              (1)  | Epoch:37 | Val Acc: 0.8788
 Best site-SynthDigits              (1)  | Epoch:37 | Val Acc: 0.9141
 Best site-MNIST_M                  (2)  | Epoch:37 | Val Acc: 0.7841
 Best site-MNIST_M                  (2)  | Epoch:37 | Val Acc: 0.8409
 Best site-SVHN                     (4)  | Epoch:37 | Val Acc: 0.7329
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 38 ============
cnt=[2, 5, 2, 3, 1, ]
cnt=[5, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (1) | Train Loss: 0.1979 | Train Acc: 0.9467
 Site-MNIST                     (1) | Train Loss: 0.1673 | Train Acc: 0.9556
 Site-MNIST                     (1) | Train Loss: 0.2110 | Train Acc: 0.9329
 Site-MNIST                     (1) | Train Loss: 0.2203 | Train Acc: 0.9277
 Site-MNIST                     (1) | Train Loss: 0.1867 | Train Acc: 0.9518
 Site-USPS                      (3) | Train Loss: 0.2475 | Train Acc: 0.9185
 Site-USPS                      (3) | Train Loss: 0.2415 | Train Acc: 0.9345
 Site-USPS                      (3) | Train Loss: 0.2305 | Train Acc: 0.9297
 Site-SynthDigits               (0) | Train Loss: 0.3988 | Train Acc: 0.8864
 Site-SynthDigits               (0) | Train Loss: 0.3381 | Train Acc: 0.9154
 Site-MNIST_M                   (2) | Train Loss: 0.5821 | Train Acc: 0.8494
 Site-MNIST_M                   (2) | Train Loss: 0.5712 | Train Acc: 0.8352
 Site-SVHN                      (4) | Train Loss: 0.7253 | Train Acc: 0.7632
Average Train Accuracy: 0.9036
 Site-MNIST                     (1) | Val  Loss: 0.1623 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.1707 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.1998 | Val  Acc: 0.9524
 Site-MNIST                     (1) | Val  Loss: 0.2326 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.1940 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1838 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2332 | Val  Acc: 0.9038
 Site-USPS                      (3) | Val  Loss: 0.2759 | Val  Acc: 0.8803
 Site-SynthDigits               (0) | Val  Loss: 0.4481 | Val  Acc: 0.8788
 Site-SynthDigits               (0) | Val  Loss: 0.3006 | Val  Acc: 0.9040
 Site-MNIST_M                   (2) | Val  Loss: 0.6517 | Val  Acc: 0.8068
 Site-MNIST_M                   (2) | Val  Loss: 0.6571 | Val  Acc: 0.8333
 Site-SVHN                      (4) | Val  Loss: 0.7495 | Val  Acc: 0.7123
Average Valid Accuracy: 0.8920
============ Train epoch 39 ============
cnt=[2, 5, 2, 3, 1, ]
cnt=[5, 3, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (1) | Train Loss: 0.1956 | Train Acc: 0.9511
 Site-MNIST                     (1) | Train Loss: 0.1965 | Train Acc: 0.9556
 Site-MNIST                     (1) | Train Loss: 0.2072 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.2189 | Train Acc: 0.9330
 Site-MNIST                     (1) | Train Loss: 0.1828 | Train Acc: 0.9518
 Site-USPS                      (3) | Train Loss: 0.2508 | Train Acc: 0.9185
 Site-USPS                      (3) | Train Loss: 0.2333 | Train Acc: 0.9409
 Site-USPS                      (3) | Train Loss: 0.2286 | Train Acc: 0.9318
 Site-SynthDigits               (0) | Train Loss: 0.3771 | Train Acc: 0.8883
 Site-SynthDigits               (0) | Train Loss: 0.3389 | Train Acc: 0.9255
 Site-MNIST_M                   (2) | Train Loss: 0.5856 | Train Acc: 0.8352
 Site-MNIST_M                   (2) | Train Loss: 0.5813 | Train Acc: 0.8485
 Site-SVHN                      (4) | Train Loss: 0.6945 | Train Acc: 0.7649
Average Train Accuracy: 0.9065
 Site-MNIST                     (1) | Val  Loss: 0.1571 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1654 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.1981 | Val  Acc: 0.9524
 Site-MNIST                     (1) | Val  Loss: 0.2284 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.1896 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1763 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2266 | Val  Acc: 0.9167
 Site-USPS                      (3) | Val  Loss: 0.2722 | Val  Acc: 0.8846
 Site-SynthDigits               (0) | Val  Loss: 0.4475 | Val  Acc: 0.8788
 Site-SynthDigits               (0) | Val  Loss: 0.2950 | Val  Acc: 0.9141
 Site-MNIST_M                   (2) | Val  Loss: 0.6470 | Val  Acc: 0.7955
 Site-MNIST_M                   (2) | Val  Loss: 0.6512 | Val  Acc: 0.8485
 Site-SVHN                      (4) | Val  Loss: 0.7420 | Val  Acc: 0.7192
Average Valid Accuracy: 0.8963
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9524
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9368
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9509
 Best site-USPS                     (3)  | Epoch:39 | Val Acc: 0.9615
 Best site-USPS                     (3)  | Epoch:39 | Val Acc: 0.9167
 Best site-USPS                     (3)  | Epoch:39 | Val Acc: 0.8846
 Best site-SynthDigits              (0)  | Epoch:39 | Val Acc: 0.8788
 Best site-SynthDigits              (0)  | Epoch:39 | Val Acc: 0.9141
 Best site-MNIST_M                  (2)  | Epoch:39 | Val Acc: 0.7955
 Best site-MNIST_M                  (2)  | Epoch:39 | Val Acc: 0.8485
 Best site-SVHN                     (4)  | Epoch:39 | Val Acc: 0.7192
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 3, 5, 2, 1, ]
cnt=[2, 3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (2) | Train Loss: 0.2052 | Train Acc: 0.9422
 Site-MNIST                     (2) | Train Loss: 0.1917 | Train Acc: 0.9586
 Site-MNIST                     (2) | Train Loss: 0.2055 | Train Acc: 0.9389
 Site-MNIST                     (2) | Train Loss: 0.2151 | Train Acc: 0.9330
 Site-MNIST                     (2) | Train Loss: 0.1816 | Train Acc: 0.9527
 Site-USPS                      (1) | Train Loss: 0.2537 | Train Acc: 0.9161
 Site-USPS                      (1) | Train Loss: 0.2282 | Train Acc: 0.9393
 Site-USPS                      (1) | Train Loss: 0.2262 | Train Acc: 0.9350
 Site-SynthDigits               (3) | Train Loss: 0.3867 | Train Acc: 0.8920
 Site-SynthDigits               (3) | Train Loss: 0.3335 | Train Acc: 0.9280
 Site-MNIST_M                   (0) | Train Loss: 0.5818 | Train Acc: 0.8352
 Site-MNIST_M                   (0) | Train Loss: 0.5865 | Train Acc: 0.8447
 Site-SVHN                      (4) | Train Loss: 0.7130 | Train Acc: 0.7751
Average Train Accuracy: 0.9070
 Site-MNIST                     (2) | Val  Loss: 0.1570 | Val  Acc: 0.9464
 Site-MNIST                     (2) | Val  Loss: 0.1658 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.1959 | Val  Acc: 0.9524
 Site-MNIST                     (2) | Val  Loss: 0.2265 | Val  Acc: 0.9421
 Site-MNIST                     (2) | Val  Loss: 0.1878 | Val  Acc: 0.9544
 Site-USPS                      (1) | Val  Loss: 0.1748 | Val  Acc: 0.9519
 Site-USPS                      (1) | Val  Loss: 0.2234 | Val  Acc: 0.9103
 Site-USPS                      (1) | Val  Loss: 0.2660 | Val  Acc: 0.8803
 Site-SynthDigits               (3) | Val  Loss: 0.4423 | Val  Acc: 0.8788
 Site-SynthDigits               (3) | Val  Loss: 0.2835 | Val  Acc: 0.9192
 Site-MNIST_M                   (0) | Val  Loss: 0.6233 | Val  Acc: 0.8182
 Site-MNIST_M                   (0) | Val  Loss: 0.6445 | Val  Acc: 0.8561
 Site-SVHN                      (4) | Val  Loss: 0.7385 | Val  Acc: 0.7466
Average Valid Accuracy: 0.8989
 Best site-MNIST                    (2)  | Epoch:40 | Val Acc: 0.9464
 Best site-MNIST                    (2)  | Epoch:40 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:40 | Val Acc: 0.9524
 Best site-MNIST                    (2)  | Epoch:40 | Val Acc: 0.9421
 Best site-MNIST                    (2)  | Epoch:40 | Val Acc: 0.9544
 Best site-USPS                     (1)  | Epoch:40 | Val Acc: 0.9519
 Best site-USPS                     (1)  | Epoch:40 | Val Acc: 0.9103
 Best site-USPS                     (1)  | Epoch:40 | Val Acc: 0.8803
 Best site-SynthDigits              (3)  | Epoch:40 | Val Acc: 0.8788
 Best site-SynthDigits              (3)  | Epoch:40 | Val Acc: 0.9192
 Best site-MNIST_M                  (0)  | Epoch:40 | Val Acc: 0.8182
 Best site-MNIST_M                  (0)  | Epoch:40 | Val Acc: 0.8561
 Best site-SVHN                     (4)  | Epoch:40 | Val Acc: 0.7466
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 41 ============
cnt=[5, 2, 2, 3, 1, ]
cnt=[5, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (0) | Train Loss: 0.2109 | Train Acc: 0.9467
 Site-MNIST                     (0) | Train Loss: 0.1849 | Train Acc: 0.9556
 Site-MNIST                     (0) | Train Loss: 0.2002 | Train Acc: 0.9408
 Site-MNIST                     (0) | Train Loss: 0.2102 | Train Acc: 0.9356
 Site-MNIST                     (0) | Train Loss: 0.1758 | Train Acc: 0.9527
 Site-USPS                      (3) | Train Loss: 0.2405 | Train Acc: 0.9209
 Site-USPS                      (3) | Train Loss: 0.2243 | Train Acc: 0.9377
 Site-USPS                      (3) | Train Loss: 0.2247 | Train Acc: 0.9361
 Site-SynthDigits               (1) | Train Loss: 0.3948 | Train Acc: 0.8807
 Site-SynthDigits               (1) | Train Loss: 0.3195 | Train Acc: 0.9280
 Site-MNIST_M                   (2) | Train Loss: 0.5681 | Train Acc: 0.8466
 Site-MNIST_M                   (2) | Train Loss: 0.5552 | Train Acc: 0.8447
 Site-SVHN                      (4) | Train Loss: 0.7078 | Train Acc: 0.7922
Average Train Accuracy: 0.9091
 Site-MNIST                     (0) | Val  Loss: 0.1516 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1610 | Val  Acc: 0.9405
 Site-MNIST                     (0) | Val  Loss: 0.1903 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2230 | Val  Acc: 0.9368
 Site-MNIST                     (0) | Val  Loss: 0.1834 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1715 | Val  Acc: 0.9519
 Site-USPS                      (3) | Val  Loss: 0.2225 | Val  Acc: 0.9103
 Site-USPS                      (3) | Val  Loss: 0.2667 | Val  Acc: 0.8889
 Site-SynthDigits               (1) | Val  Loss: 0.4342 | Val  Acc: 0.8788
 Site-SynthDigits               (1) | Val  Loss: 0.2820 | Val  Acc: 0.9192
 Site-MNIST_M                   (2) | Val  Loss: 0.6175 | Val  Acc: 0.8295
 Site-MNIST_M                   (2) | Val  Loss: 0.6289 | Val  Acc: 0.8636
 Site-SVHN                      (4) | Val  Loss: 0.7200 | Val  Acc: 0.7534
Average Valid Accuracy: 0.9031
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.9405
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.9524
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.9368
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.9509
 Best site-USPS                     (3)  | Epoch:41 | Val Acc: 0.9519
 Best site-USPS                     (3)  | Epoch:41 | Val Acc: 0.9103
 Best site-USPS                     (3)  | Epoch:41 | Val Acc: 0.8889
 Best site-SynthDigits              (1)  | Epoch:41 | Val Acc: 0.8788
 Best site-SynthDigits              (1)  | Epoch:41 | Val Acc: 0.9192
 Best site-MNIST_M                  (2)  | Epoch:41 | Val Acc: 0.8295
 Best site-MNIST_M                  (2)  | Epoch:41 | Val Acc: 0.8636
 Best site-SVHN                     (4)  | Epoch:41 | Val Acc: 0.7534
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 42 ============
cnt=[5, 2, 2, 3, 1, ]
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (0) | Train Loss: 0.1914 | Train Acc: 0.9467
 Site-MNIST                     (0) | Train Loss: 0.1976 | Train Acc: 0.9556
 Site-MNIST                     (0) | Train Loss: 0.1989 | Train Acc: 0.9428
 Site-MNIST                     (0) | Train Loss: 0.2098 | Train Acc: 0.9343
 Site-MNIST                     (0) | Train Loss: 0.1747 | Train Acc: 0.9545
 Site-USPS                      (3) | Train Loss: 0.2553 | Train Acc: 0.9185
 Site-USPS                      (3) | Train Loss: 0.2247 | Train Acc: 0.9393
 Site-USPS                      (3) | Train Loss: 0.2219 | Train Acc: 0.9340
 Site-SynthDigits               (1) | Train Loss: 0.3660 | Train Acc: 0.8902
 Site-SynthDigits               (1) | Train Loss: 0.3060 | Train Acc: 0.9242
 Site-MNIST_M                   (2) | Train Loss: 0.5695 | Train Acc: 0.8580
 Site-MNIST_M                   (2) | Train Loss: 0.5659 | Train Acc: 0.8447
 Site-SVHN                      (4) | Train Loss: 0.7005 | Train Acc: 0.7853
Average Train Accuracy: 0.9098
 Site-MNIST                     (0) | Val  Loss: 0.1507 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1618 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.1873 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2215 | Val  Acc: 0.9368
 Site-MNIST                     (0) | Val  Loss: 0.1825 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1768 | Val  Acc: 0.9519
 Site-USPS                      (3) | Val  Loss: 0.2204 | Val  Acc: 0.9103
 Site-USPS                      (3) | Val  Loss: 0.2626 | Val  Acc: 0.8803
 Site-SynthDigits               (1) | Val  Loss: 0.4241 | Val  Acc: 0.8788
 Site-SynthDigits               (1) | Val  Loss: 0.2748 | Val  Acc: 0.9141
 Site-MNIST_M                   (2) | Val  Loss: 0.6144 | Val  Acc: 0.8068
 Site-MNIST_M                   (2) | Val  Loss: 0.6270 | Val  Acc: 0.8485
 Site-SVHN                      (4) | Val  Loss: 0.7088 | Val  Acc: 0.7466
Average Valid Accuracy: 0.8977
============ Train epoch 43 ============
cnt=[3, 2, 1, 5, 2, ]
cnt=[1, 5, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (3) | Train Loss: 0.1817 | Train Acc: 0.9511
 Site-MNIST                     (3) | Train Loss: 0.1554 | Train Acc: 0.9527
 Site-MNIST                     (3) | Train Loss: 0.1967 | Train Acc: 0.9389
 Site-MNIST                     (3) | Train Loss: 0.2073 | Train Acc: 0.9369
 Site-MNIST                     (3) | Train Loss: 0.1724 | Train Acc: 0.9536
 Site-USPS                      (0) | Train Loss: 0.2457 | Train Acc: 0.9233
 Site-USPS                      (0) | Train Loss: 0.2167 | Train Acc: 0.9329
 Site-USPS                      (0) | Train Loss: 0.2200 | Train Acc: 0.9350
 Site-SynthDigits               (4) | Train Loss: 0.3737 | Train Acc: 0.8939
 Site-SynthDigits               (4) | Train Loss: 0.3227 | Train Acc: 0.9230
 Site-MNIST_M                   (1) | Train Loss: 0.5618 | Train Acc: 0.8580
 Site-MNIST_M                   (1) | Train Loss: 0.5548 | Train Acc: 0.8542
 Site-SVHN                      (2) | Train Loss: 0.7057 | Train Acc: 0.7853
Average Train Accuracy: 0.9107
 Site-MNIST                     (3) | Val  Loss: 0.1501 | Val  Acc: 0.9464
 Site-MNIST                     (3) | Val  Loss: 0.1620 | Val  Acc: 0.9286
 Site-MNIST                     (3) | Val  Loss: 0.1872 | Val  Acc: 0.9524
 Site-MNIST                     (3) | Val  Loss: 0.2192 | Val  Acc: 0.9368
 Site-MNIST                     (3) | Val  Loss: 0.1803 | Val  Acc: 0.9509
 Site-USPS                      (0) | Val  Loss: 0.1674 | Val  Acc: 0.9615
 Site-USPS                      (0) | Val  Loss: 0.2125 | Val  Acc: 0.9103
 Site-USPS                      (0) | Val  Loss: 0.2502 | Val  Acc: 0.8932
 Site-SynthDigits               (4) | Val  Loss: 0.4255 | Val  Acc: 0.8788
 Site-SynthDigits               (4) | Val  Loss: 0.2732 | Val  Acc: 0.9192
 Site-MNIST_M                   (1) | Val  Loss: 0.6153 | Val  Acc: 0.8182
 Site-MNIST_M                   (1) | Val  Loss: 0.6281 | Val  Acc: 0.8333
 Site-SVHN                      (2) | Val  Loss: 0.6970 | Val  Acc: 0.7466
Average Valid Accuracy: 0.8982
============ Train epoch 44 ============
cnt=[5, 2, 2, 3, 1, ]
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (0) | Train Loss: 0.1871 | Train Acc: 0.9511
 Site-MNIST                     (0) | Train Loss: 0.1660 | Train Acc: 0.9527
 Site-MNIST                     (0) | Train Loss: 0.1952 | Train Acc: 0.9428
 Site-MNIST                     (0) | Train Loss: 0.2050 | Train Acc: 0.9369
 Site-MNIST                     (0) | Train Loss: 0.1694 | Train Acc: 0.9536
 Site-USPS                      (3) | Train Loss: 0.2412 | Train Acc: 0.9257
 Site-USPS                      (3) | Train Loss: 0.2213 | Train Acc: 0.9393
 Site-USPS                      (3) | Train Loss: 0.2163 | Train Acc: 0.9361
 Site-SynthDigits               (1) | Train Loss: 0.3518 | Train Acc: 0.8845
 Site-SynthDigits               (1) | Train Loss: 0.3280 | Train Acc: 0.9293
 Site-MNIST_M                   (2) | Train Loss: 0.5280 | Train Acc: 0.8608
 Site-MNIST_M                   (2) | Train Loss: 0.5484 | Train Acc: 0.8371
 Site-SVHN                      (4) | Train Loss: 0.6972 | Train Acc: 0.7871
Average Train Accuracy: 0.9105
 Site-MNIST                     (0) | Val  Loss: 0.1489 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1609 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.1853 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2172 | Val  Acc: 0.9368
 Site-MNIST                     (0) | Val  Loss: 0.1786 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1676 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2104 | Val  Acc: 0.9167
 Site-USPS                      (3) | Val  Loss: 0.2477 | Val  Acc: 0.8932
 Site-SynthDigits               (1) | Val  Loss: 0.4181 | Val  Acc: 0.8788
 Site-SynthDigits               (1) | Val  Loss: 0.2706 | Val  Acc: 0.9141
 Site-MNIST_M                   (2) | Val  Loss: 0.5990 | Val  Acc: 0.8295
 Site-MNIST_M                   (2) | Val  Loss: 0.6137 | Val  Acc: 0.8561
 Site-SVHN                      (4) | Val  Loss: 0.6891 | Val  Acc: 0.7466
Average Valid Accuracy: 0.9023
============ Train epoch 45 ============
cnt=[2, 5, 2, 3, 1, ]
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (1) | Train Loss: 0.2163 | Train Acc: 0.9422
 Site-MNIST                     (1) | Train Loss: 0.1792 | Train Acc: 0.9527
 Site-MNIST                     (1) | Train Loss: 0.1949 | Train Acc: 0.9448
 Site-MNIST                     (1) | Train Loss: 0.2054 | Train Acc: 0.9343
 Site-MNIST                     (1) | Train Loss: 0.1717 | Train Acc: 0.9527
 Site-USPS                      (3) | Train Loss: 0.2250 | Train Acc: 0.9233
 Site-USPS                      (3) | Train Loss: 0.2148 | Train Acc: 0.9377
 Site-USPS                      (3) | Train Loss: 0.2101 | Train Acc: 0.9404
 Site-SynthDigits               (0) | Train Loss: 0.3667 | Train Acc: 0.8864
 Site-SynthDigits               (0) | Train Loss: 0.2981 | Train Acc: 0.9318
 Site-MNIST_M                   (2) | Train Loss: 0.5520 | Train Acc: 0.8523
 Site-MNIST_M                   (2) | Train Loss: 0.5092 | Train Acc: 0.8542
 Site-SVHN                      (4) | Train Loss: 0.6567 | Train Acc: 0.8041
Average Train Accuracy: 0.9121
 Site-MNIST                     (1) | Val  Loss: 0.1527 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1617 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.1850 | Val  Acc: 0.9524
 Site-MNIST                     (1) | Val  Loss: 0.2178 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.1787 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1671 | Val  Acc: 0.9519
 Site-USPS                      (3) | Val  Loss: 0.2107 | Val  Acc: 0.9167
 Site-USPS                      (3) | Val  Loss: 0.2431 | Val  Acc: 0.8974
 Site-SynthDigits               (0) | Val  Loss: 0.4122 | Val  Acc: 0.8712
 Site-SynthDigits               (0) | Val  Loss: 0.2632 | Val  Acc: 0.9242
 Site-MNIST_M                   (2) | Val  Loss: 0.6045 | Val  Acc: 0.8068
 Site-MNIST_M                   (2) | Val  Loss: 0.6245 | Val  Acc: 0.8561
 Site-SVHN                      (4) | Val  Loss: 0.6804 | Val  Acc: 0.7466
Average Valid Accuracy: 0.9003
 Test site-MNIST                     (1)| Epoch:41 | Test Acc: 0.9363
 Test site-USPS                      (3)| Epoch:41 | Test Acc: 0.9484
 Test site-SynthDigits               (0)| Epoch:41 | Test Acc: 0.8992
 Test site-MNIST_M                   (2)| Epoch:41 | Test Acc: 0.7521
 Test site-SVHN                      (4)| Epoch:41 | Test Acc: 0.7040
MNIST: 0.9363, USPS: 0.9484, SynthDigits: 0.8992, MNIST_M: 0.7521, SVHN: 0.7040, 
Average Test Accuracy(group): 0.8480, Average Test Accuracy(individual): 0.8872,
domain std=0.1004, cluster std=0.1004, individual std=0.0849, 
Average Test Accuracy: 0.8480
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 46 ============
cnt=[2, 5, 2, 3, 1, ]
cnt=[3, 2, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-MNIST                     (1) | Train Loss: 0.1908 | Train Acc: 0.9467
 Site-MNIST                     (1) | Train Loss: 0.1565 | Train Acc: 0.9586
 Site-MNIST                     (1) | Train Loss: 0.1927 | Train Acc: 0.9448
 Site-MNIST                     (1) | Train Loss: 0.2025 | Train Acc: 0.9356
 Site-MNIST                     (1) | Train Loss: 0.1695 | Train Acc: 0.9518
 Site-USPS                      (3) | Train Loss: 0.2189 | Train Acc: 0.9209
 Site-USPS                      (3) | Train Loss: 0.2110 | Train Acc: 0.9345
 Site-USPS                      (3) | Train Loss: 0.2147 | Train Acc: 0.9393
 Site-SynthDigits               (0) | Train Loss: 0.3401 | Train Acc: 0.8939
 Site-SynthDigits               (0) | Train Loss: 0.3045 | Train Acc: 0.9280
 Site-MNIST_M                   (2) | Train Loss: 0.5251 | Train Acc: 0.8665
 Site-MNIST_M                   (2) | Train Loss: 0.5382 | Train Acc: 0.8542
 Site-SVHN                      (4) | Train Loss: 0.6723 | Train Acc: 0.7939
Average Train Accuracy: 0.9130
 Site-MNIST                     (1) | Val  Loss: 0.1456 | Val  Acc: 0.9821
 Site-MNIST                     (1) | Val  Loss: 0.1587 | Val  Acc: 0.9405
 Site-MNIST                     (1) | Val  Loss: 0.1863 | Val  Acc: 0.9524
 Site-MNIST                     (1) | Val  Loss: 0.2159 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.1776 | Val  Acc: 0.9544
 Site-USPS                      (3) | Val  Loss: 0.1615 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2036 | Val  Acc: 0.9103
 Site-USPS                      (3) | Val  Loss: 0.2354 | Val  Acc: 0.8974
 Site-SynthDigits               (0) | Val  Loss: 0.4298 | Val  Acc: 0.8788
 Site-SynthDigits               (0) | Val  Loss: 0.2635 | Val  Acc: 0.9192
 Site-MNIST_M                   (2) | Val  Loss: 0.5812 | Val  Acc: 0.8295
 Site-MNIST_M                   (2) | Val  Loss: 0.6095 | Val  Acc: 0.8485
 Site-SVHN                      (4) | Val  Loss: 0.6827 | Val  Acc: 0.7603
Average Valid Accuracy: 0.9055
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.9821
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.9405
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.9524
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.9368
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.9544
 Best site-USPS                     (3)  | Epoch:46 | Val Acc: 0.9615
 Best site-USPS                     (3)  | Epoch:46 | Val Acc: 0.9103
 Best site-USPS                     (3)  | Epoch:46 | Val Acc: 0.8974
 Best site-SynthDigits              (0)  | Epoch:46 | Val Acc: 0.8788
 Best site-SynthDigits              (0)  | Epoch:46 | Val Acc: 0.9192
 Best site-MNIST_M                  (2)  | Epoch:46 | Val Acc: 0.8295
 Best site-MNIST_M                  (2)  | Epoch:46 | Val Acc: 0.8485
 Best site-SVHN                     (4)  | Epoch:46 | Val Acc: 0.7603
 Test site-MNIST                     (1)| Epoch:46 | Test Acc: 0.9383
 Test site-USPS                      (3)| Epoch:46 | Test Acc: 0.9484
 Test site-SynthDigits               (0)| Epoch:46 | Test Acc: 0.8965
 Test site-MNIST_M                   (2)| Epoch:46 | Test Acc: 0.7549
 Test site-SVHN                      (4)| Epoch:46 | Test Acc: 0.7032
MNIST: 0.9383, USPS: 0.9484, SynthDigits: 0.8965, MNIST_M: 0.7549, SVHN: 0.7032, 
Average Test Accuracy(group): 0.8482, Average Test Accuracy(individual): 0.8879,
domain std=0.1002, cluster std=0.1002, individual std=0.0847, 
Average Test Accuracy: 0.8482
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 47 ============
cnt=[3, 2, 1, 5, 2, ]
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-MNIST                     (3) | Train Loss: 0.1874 | Train Acc: 0.9467
 Site-MNIST                     (3) | Train Loss: 0.1500 | Train Acc: 0.9497
 Site-MNIST                     (3) | Train Loss: 0.1894 | Train Acc: 0.9408
 Site-MNIST                     (3) | Train Loss: 0.2008 | Train Acc: 0.9382
 Site-MNIST                     (3) | Train Loss: 0.1688 | Train Acc: 0.9545
 Site-USPS                      (0) | Train Loss: 0.2178 | Train Acc: 0.9209
 Site-USPS                      (0) | Train Loss: 0.2142 | Train Acc: 0.9345
 Site-USPS                      (0) | Train Loss: 0.2121 | Train Acc: 0.9393
 Site-SynthDigits               (4) | Train Loss: 0.3436 | Train Acc: 0.8977
 Site-SynthDigits               (4) | Train Loss: 0.3060 | Train Acc: 0.9242
 Site-MNIST_M                   (1) | Train Loss: 0.5332 | Train Acc: 0.8636
 Site-MNIST_M                   (1) | Train Loss: 0.5205 | Train Acc: 0.8466
 Site-SVHN                      (2) | Train Loss: 0.6312 | Train Acc: 0.7939
Average Train Accuracy: 0.9116
 Site-MNIST                     (3) | Val  Loss: 0.1402 | Val  Acc: 0.9821
 Site-MNIST                     (3) | Val  Loss: 0.1541 | Val  Acc: 0.9405
 Site-MNIST                     (3) | Val  Loss: 0.1881 | Val  Acc: 0.9524
 Site-MNIST                     (3) | Val  Loss: 0.2152 | Val  Acc: 0.9368
 Site-MNIST                     (3) | Val  Loss: 0.1756 | Val  Acc: 0.9509
 Site-USPS                      (0) | Val  Loss: 0.1655 | Val  Acc: 0.9615
 Site-USPS                      (0) | Val  Loss: 0.2010 | Val  Acc: 0.9103
 Site-USPS                      (0) | Val  Loss: 0.2345 | Val  Acc: 0.8932
 Site-SynthDigits               (4) | Val  Loss: 0.4373 | Val  Acc: 0.8788
 Site-SynthDigits               (4) | Val  Loss: 0.2597 | Val  Acc: 0.9444
 Site-MNIST_M                   (1) | Val  Loss: 0.5940 | Val  Acc: 0.8182
 Site-MNIST_M                   (1) | Val  Loss: 0.6204 | Val  Acc: 0.8333
 Site-SVHN                      (2) | Val  Loss: 0.6716 | Val  Acc: 0.7671
Average Valid Accuracy: 0.9053
 Test site-MNIST                     (3)| Epoch:46 | Test Acc: 0.9377
 Test site-USPS                      (0)| Epoch:46 | Test Acc: 0.9505
 Test site-SynthDigits               (4)| Epoch:46 | Test Acc: 0.8978
 Test site-MNIST_M                   (1)| Epoch:46 | Test Acc: 0.7521
 Test site-SVHN                      (2)| Epoch:46 | Test Acc: 0.7074
MNIST: 0.9377, USPS: 0.9505, SynthDigits: 0.8978, MNIST_M: 0.7521, SVHN: 0.7074, 
Average Test Accuracy(group): 0.8491, Average Test Accuracy(individual): 0.8883,
domain std=0.1000, cluster std=0.1000, individual std=0.0849, 
Average Test Accuracy: 0.8491
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 48 ============
cnt=[2, 5, 1, 3, 2, ]
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-MNIST                     (1) | Train Loss: 0.1973 | Train Acc: 0.9467
 Site-MNIST                     (1) | Train Loss: 0.1522 | Train Acc: 0.9527
 Site-MNIST                     (1) | Train Loss: 0.1868 | Train Acc: 0.9428
 Site-MNIST                     (1) | Train Loss: 0.1966 | Train Acc: 0.9409
 Site-MNIST                     (1) | Train Loss: 0.1632 | Train Acc: 0.9545
 Site-USPS                      (3) | Train Loss: 0.2195 | Train Acc: 0.9233
 Site-USPS                      (3) | Train Loss: 0.2113 | Train Acc: 0.9393
 Site-USPS                      (3) | Train Loss: 0.1972 | Train Acc: 0.9436
 Site-SynthDigits               (4) | Train Loss: 0.3647 | Train Acc: 0.8939
 Site-SynthDigits               (4) | Train Loss: 0.2934 | Train Acc: 0.9293
 Site-MNIST_M                   (0) | Train Loss: 0.5168 | Train Acc: 0.8750
 Site-MNIST_M                   (0) | Train Loss: 0.4955 | Train Acc: 0.8428
 Site-SVHN                      (2) | Train Loss: 0.6472 | Train Acc: 0.7990
Average Train Accuracy: 0.9141
 Site-MNIST                     (1) | Val  Loss: 0.1364 | Val  Acc: 0.9821
 Site-MNIST                     (1) | Val  Loss: 0.1511 | Val  Acc: 0.9405
 Site-MNIST                     (1) | Val  Loss: 0.1810 | Val  Acc: 0.9524
 Site-MNIST                     (1) | Val  Loss: 0.2110 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.1727 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1557 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2002 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.2296 | Val  Acc: 0.8974
 Site-SynthDigits               (4) | Val  Loss: 0.3997 | Val  Acc: 0.8939
 Site-SynthDigits               (4) | Val  Loss: 0.2501 | Val  Acc: 0.9242
 Site-MNIST_M                   (0) | Val  Loss: 0.5736 | Val  Acc: 0.8409
 Site-MNIST_M                   (0) | Val  Loss: 0.6137 | Val  Acc: 0.8561
 Site-SVHN                      (2) | Val  Loss: 0.6576 | Val  Acc: 0.7671
Average Valid Accuracy: 0.9098
 Best site-MNIST                    (1)  | Epoch:48 | Val Acc: 0.9821
 Best site-MNIST                    (1)  | Epoch:48 | Val Acc: 0.9405
 Best site-MNIST                    (1)  | Epoch:48 | Val Acc: 0.9524
 Best site-MNIST                    (1)  | Epoch:48 | Val Acc: 0.9368
 Best site-MNIST                    (1)  | Epoch:48 | Val Acc: 0.9509
 Best site-USPS                     (3)  | Epoch:48 | Val Acc: 0.9615
 Best site-USPS                     (3)  | Epoch:48 | Val Acc: 0.9231
 Best site-USPS                     (3)  | Epoch:48 | Val Acc: 0.8974
 Best site-SynthDigits              (4)  | Epoch:48 | Val Acc: 0.8939
 Best site-SynthDigits              (4)  | Epoch:48 | Val Acc: 0.9242
 Best site-MNIST_M                  (0)  | Epoch:48 | Val Acc: 0.8409
 Best site-MNIST_M                  (0)  | Epoch:48 | Val Acc: 0.8561
 Best site-SVHN                     (2)  | Epoch:48 | Val Acc: 0.7671
 Test site-MNIST                     (1)| Epoch:48 | Test Acc: 0.9393
 Test site-USPS                      (3)| Epoch:48 | Test Acc: 0.9495
 Test site-SynthDigits               (4)| Epoch:48 | Test Acc: 0.9008
 Test site-MNIST_M                   (0)| Epoch:48 | Test Acc: 0.7543
 Test site-SVHN                      (2)| Epoch:48 | Test Acc: 0.7055
MNIST: 0.9393, USPS: 0.9495, SynthDigits: 0.9008, MNIST_M: 0.7543, SVHN: 0.7055, 
Average Test Accuracy(group): 0.8499, Average Test Accuracy(individual): 0.8893,
domain std=0.1005, cluster std=0.1005, individual std=0.0850, 
Average Test Accuracy: 0.8499
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
============ Train epoch 49 ============
cnt=[5, 2, 2, 3, 1, ]
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-MNIST                     (0) | Train Loss: 0.1765 | Train Acc: 0.9511
 Site-MNIST                     (0) | Train Loss: 0.1536 | Train Acc: 0.9586
 Site-MNIST                     (0) | Train Loss: 0.1842 | Train Acc: 0.9487
 Site-MNIST                     (0) | Train Loss: 0.1941 | Train Acc: 0.9382
 Site-MNIST                     (0) | Train Loss: 0.1597 | Train Acc: 0.9536
 Site-USPS                      (3) | Train Loss: 0.2245 | Train Acc: 0.9281
 Site-USPS                      (3) | Train Loss: 0.2029 | Train Acc: 0.9345
 Site-USPS                      (3) | Train Loss: 0.1989 | Train Acc: 0.9446
 Site-SynthDigits               (1) | Train Loss: 0.3916 | Train Acc: 0.9053
 Site-SynthDigits               (1) | Train Loss: 0.2916 | Train Acc: 0.9306
 Site-MNIST_M                   (2) | Train Loss: 0.4949 | Train Acc: 0.8665
 Site-MNIST_M                   (2) | Train Loss: 0.5220 | Train Acc: 0.8466
 Site-SVHN                      (4) | Train Loss: 0.6522 | Train Acc: 0.8041
Average Train Accuracy: 0.9162
 Site-MNIST                     (0) | Val  Loss: 0.1366 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1517 | Val  Acc: 0.9405
 Site-MNIST                     (0) | Val  Loss: 0.1789 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2083 | Val  Acc: 0.9368
 Site-MNIST                     (0) | Val  Loss: 0.1705 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1492 | Val  Acc: 0.9519
 Site-USPS                      (3) | Val  Loss: 0.2004 | Val  Acc: 0.9103
 Site-USPS                      (3) | Val  Loss: 0.2268 | Val  Acc: 0.9017
 Site-SynthDigits               (1) | Val  Loss: 0.3918 | Val  Acc: 0.8939
 Site-SynthDigits               (1) | Val  Loss: 0.2458 | Val  Acc: 0.9343
 Site-MNIST_M                   (2) | Val  Loss: 0.5538 | Val  Acc: 0.8523
 Site-MNIST_M                   (2) | Val  Loss: 0.6006 | Val  Acc: 0.8561
 Site-SVHN                      (4) | Val  Loss: 0.6507 | Val  Acc: 0.7877
Average Valid Accuracy: 0.9102
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.9405
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.9524
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.9368
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.9509
 Best site-USPS                     (3)  | Epoch:49 | Val Acc: 0.9519
 Best site-USPS                     (3)  | Epoch:49 | Val Acc: 0.9103
 Best site-USPS                     (3)  | Epoch:49 | Val Acc: 0.9017
 Best site-SynthDigits              (1)  | Epoch:49 | Val Acc: 0.8939
 Best site-SynthDigits              (1)  | Epoch:49 | Val Acc: 0.9343
 Best site-MNIST_M                  (2)  | Epoch:49 | Val Acc: 0.8523
 Best site-MNIST_M                  (2)  | Epoch:49 | Val Acc: 0.8561
 Best site-SVHN                     (4)  | Epoch:49 | Val Acc: 0.7877
 Test site-MNIST                     (0)| Epoch:49 | Test Acc: 0.9390
 Test site-USPS                      (3)| Epoch:49 | Test Acc: 0.9495
 Test site-SynthDigits               (1)| Epoch:49 | Test Acc: 0.9002
 Test site-MNIST_M                   (2)| Epoch:49 | Test Acc: 0.7553
 Test site-SVHN                      (4)| Epoch:49 | Test Acc: 0.7070
MNIST: 0.9390, USPS: 0.9495, SynthDigits: 0.9002, MNIST_M: 0.7553, SVHN: 0.7070, 
Average Test Accuracy(group): 0.8502, Average Test Accuracy(individual): 0.8893,
domain std=0.0997, cluster std=0.0997, individual std=0.0844, 
Average Test Accuracy: 0.8502
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0/ccop_q=1...
===2023-08-01 09:10:25===
===2023-08-01 09:10:31===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     (0)| Epoch:49 | Test Acc: 0.9390
 Test site-USPS                      (3)| Epoch:49 | Test Acc: 0.9495
 Test site-SynthDigits               (1)| Epoch:49 | Test Acc: 0.9002
 Test site-MNIST_M                   (2)| Epoch:49 | Test Acc: 0.7553
 Test site-SVHN                      (4)| Epoch:49 | Test Acc: 0.7070
MNIST: 0.9390, USPS: 0.9495, SynthDigits: 0.9002, MNIST_M: 0.7553, SVHN: 0.7070, 
Average Test Accuracy(group): 0.8502, Average Test Accuracy(individual): 0.8893,
domain std=0.0997, cluster std=0.0997, individual std=0.0844, 
