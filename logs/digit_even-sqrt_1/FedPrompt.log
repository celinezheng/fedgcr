===2023-03-31 20:58:46===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 40
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
cnt=[2, 7, 1, ]
 Site-MNIST     | Train Loss: 1.9115 | Train Acc: 0.5455
 Site-MNIST     | Train Loss: 1.8097 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 2.2349 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.1878 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.8142 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 1.8369 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 2.1531 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 2.1180 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.1948 | Train Acc: 0.1818
 Site-MNIST-M   | Train Loss: 2.1525 | Train Acc: 0.2386
 Site-MNIST     | Val  Loss: 1.8575 | Val  Acc: 0.4915
 Site-MNIST     | Val  Loss: 1.8229 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 2.1953 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.2222 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.8737 | Val  Acc: 0.5593
 Site-USPS      | Val  Loss: 1.8129 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 2.1421 | Val  Acc: 0.2034
 Site-SynthDigits| Val  Loss: 2.1221 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.1520 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.1953 | Val  Acc: 0.1864
Average Valid Accuracy: 0.3508
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4915
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1864
 Best site-USPS       | Epoch:0 | Val Acc: 0.5593
 Best site-USPS       | Epoch:0 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2034
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 1.4657 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.4125 | Train Acc: 0.6932
 Site-SVHN      | Train Loss: 2.1360 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1151 | Train Acc: 0.3182
 Site-USPS      | Train Loss: 1.3063 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 1.3638 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.9492 | Train Acc: 0.3523
 Site-SynthDigits| Train Loss: 1.9378 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 2.0468 | Train Acc: 0.2955
 Site-MNIST-M   | Train Loss: 2.0597 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 1.4637 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.3821 | Val  Acc: 0.6780
 Site-SVHN      | Val  Loss: 2.1121 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.1136 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 1.3809 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 1.3424 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.9836 | Val  Acc: 0.3559
 Site-SynthDigits| Val  Loss: 1.8884 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 2.0314 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.0760 | Val  Acc: 0.1864
Average Valid Accuracy: 0.4746
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6780
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2203
 Best site-USPS       | Epoch:1 | Val Acc: 0.7797
 Best site-USPS       | Epoch:1 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3559
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.9753 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 0.9629 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.0044 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.0316 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 0.8732 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.9293 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.7259 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 1.6710 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.8362 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.8693 | Train Acc: 0.4318
 Site-MNIST     | Val  Loss: 1.0292 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 0.8929 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.0647 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 1.9629 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.9394 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.9311 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.7502 | Val  Acc: 0.3898
 Site-SynthDigits| Val  Loss: 1.6474 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.8540 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.8927 | Val  Acc: 0.4237
Average Valid Accuracy: 0.5475
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2881
 Best site-USPS       | Epoch:2 | Val Acc: 0.8475
 Best site-USPS       | Epoch:2 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3898
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.7148 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 0.7066 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 1.7953 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.9309 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 0.5693 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.6072 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.5301 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 1.4938 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 1.6574 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 1.5068 | Train Acc: 0.5568
 Site-MNIST     | Val  Loss: 0.7492 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 0.6316 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.9334 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.8486 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.5993 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.5720 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.6010 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 1.5058 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.4907 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.5676 | Val  Acc: 0.5424
Average Valid Accuracy: 0.6017
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3559
 Best site-USPS       | Epoch:3 | Val Acc: 0.8983
 Best site-USPS       | Epoch:3 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.4475 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.4689 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 1.6438 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 1.6480 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 0.4339 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.4193 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 1.1411 | Train Acc: 0.5795
 Site-SynthDigits| Train Loss: 1.0682 | Train Acc: 0.6477
 Site-MNIST-M   | Train Loss: 1.3767 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.3710 | Train Acc: 0.5568
 Site-MNIST     | Val  Loss: 0.5342 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.3891 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.6917 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.5801 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.4325 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.3624 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.1395 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.1222 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.3615 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.3824 | Val  Acc: 0.5593
Average Valid Accuracy: 0.6864
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4746
 Best site-USPS       | Epoch:4 | Val Acc: 0.9153
 Best site-USPS       | Epoch:4 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6102
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.3484 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.3673 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 1.4209 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.4364 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.3059 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.2821 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.9328 | Train Acc: 0.6250
 Site-SynthDigits| Train Loss: 0.8969 | Train Acc: 0.7159
 Site-MNIST-M   | Train Loss: 1.0935 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 0.9045 | Train Acc: 0.7386
 Site-MNIST     | Val  Loss: 0.3975 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.2982 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.4877 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.4087 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.3075 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.2495 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.9653 | Val  Acc: 0.6610
 Site-SynthDigits| Val  Loss: 0.9224 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 0.9326 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 0.9464 | Val  Acc: 0.7458
Average Valid Accuracy: 0.7475
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4746
 Best site-USPS       | Epoch:5 | Val Acc: 0.9153
 Best site-USPS       | Epoch:5 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6610
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7458
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.2656 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.3180 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 1.2535 | Train Acc: 0.5909
 Site-SVHN      | Train Loss: 1.2311 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.2474 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.2318 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.7080 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 0.6042 | Train Acc: 0.8295
 Site-MNIST-M   | Train Loss: 0.8375 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 0.7047 | Train Acc: 0.8068
 Site-MNIST     | Val  Loss: 0.3577 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.2440 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.3071 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.2088 | Val  Acc: 0.5254
 Site-USPS      | Val  Loss: 0.2244 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.1770 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.6727 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 0.6958 | Val  Acc: 0.7966
 Site-MNIST-M   | Val  Loss: 0.7153 | Val  Acc: 0.7966
 Site-MNIST-M   | Val  Loss: 0.7311 | Val  Acc: 0.7966
Average Valid Accuracy: 0.7983
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5254
 Best site-USPS       | Epoch:6 | Val Acc: 0.9492
 Best site-USPS       | Epoch:6 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7966
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7966
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7966
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.1799 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.2007 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 0.8967 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 0.9741 | Train Acc: 0.7159
 Site-USPS      | Train Loss: 0.2063 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.1709 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.6362 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 0.4943 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.5424 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.5075 | Train Acc: 0.9091
 Site-MNIST     | Val  Loss: 0.2302 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1553 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.0593 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 0.8926 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 0.1962 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1535 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.5816 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 0.5504 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 0.5729 | Val  Acc: 0.8644
 Site-MNIST-M   | Val  Loss: 0.4756 | Val  Acc: 0.9492
Average Valid Accuracy: 0.8797
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7627
 Best site-USPS       | Epoch:7 | Val Acc: 0.9661
 Best site-USPS       | Epoch:7 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8305
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8644
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9492
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.1611 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.2087 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 0.9232 | Train Acc: 0.6818
 Site-SVHN      | Train Loss: 0.8110 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 0.1831 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.1216 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.4315 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.3619 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.5105 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.4715 | Train Acc: 0.8977
 Site-MNIST     | Val  Loss: 0.2308 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.1504 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.9005 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 0.7546 | Val  Acc: 0.7119
 Site-USPS      | Val  Loss: 0.1290 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1256 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.3695 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.4262 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.4729 | Val  Acc: 0.8814
 Site-MNIST-M   | Val  Loss: 0.4409 | Val  Acc: 0.9322
Average Valid Accuracy: 0.8847
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7119
 Best site-USPS       | Epoch:8 | Val Acc: 0.9661
 Best site-USPS       | Epoch:8 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8475
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.8814
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9322
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0893 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0953 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 0.7082 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 0.7158 | Train Acc: 0.8068
 Site-USPS      | Train Loss: 0.1240 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.0955 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.3570 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.3018 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.3383 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.2963 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.0998 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0873 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.7616 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 0.6408 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.1094 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0883 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.3241 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.3498 | Val  Acc: 0.8983
 Site-MNIST-M   | Val  Loss: 0.3393 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.2848 | Val  Acc: 0.9831
Average Valid Accuracy: 0.9322
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8305
 Best site-USPS       | Epoch:9 | Val Acc: 0.9831
 Best site-USPS       | Epoch:9 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8983
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9831
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 50 ============
============ Train epoch 51 ============
============ Train epoch 52 ============
============ Train epoch 53 ============
============ Train epoch 54 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0664 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0831 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 0.4924 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 0.4704 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.0873 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.0545 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.2839 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.2077 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.2057 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.1799 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0929 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0687 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.5723 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 0.4180 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.0618 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0675 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2171 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2782 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.2014 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.1757 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9746
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:10 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:10 | Val Acc: 0.9661
 Best site-USPS       | Epoch:10 | Val Acc: 1.0000
 Best site-USPS       | Epoch:10 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:10 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 55 ============
============ Train epoch 56 ============
============ Train epoch 57 ============
============ Train epoch 58 ============
============ Train epoch 59 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0486 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0590 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.4187 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 0.3627 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.0770 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.0430 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1938 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.1787 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.1571 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1565 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.0652 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0459 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.4101 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.3482 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.0492 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0519 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.1760 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2127 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.1878 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.1492 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9831
 Best site-MNIST      | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:11 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:11 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:11 | Val Acc: 0.9492
 Best site-USPS       | Epoch:11 | Val Acc: 1.0000
 Best site-USPS       | Epoch:11 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.9831
 Best site-MNIST-M    | Epoch:11 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 60 ============
============ Train epoch 61 ============
============ Train epoch 62 ============
============ Train epoch 63 ============
============ Train epoch 64 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0366 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0593 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.4342 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 0.3333 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.0516 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0327 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1921 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.1248 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1348 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.1230 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0692 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0393 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.3794 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 0.3125 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.0372 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0411 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.1342 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1890 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.1427 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.1212 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9831
============ Train epoch 65 ============
============ Train epoch 66 ============
============ Train epoch 67 ============
============ Train epoch 68 ============
============ Train epoch 69 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0254 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0372 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.4314 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 0.2831 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.0333 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0218 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1195 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.1112 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1311 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.1140 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0380 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0280 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.3279 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.3039 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.0232 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0207 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1174 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1363 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.1417 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.1027 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9864
 Best site-MNIST      | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:13 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:13 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:13 | Val Acc: 0.9492
 Best site-USPS       | Epoch:13 | Val Acc: 1.0000
 Best site-USPS       | Epoch:13 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:13 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:13 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 70 ============
============ Train epoch 71 ============
============ Train epoch 72 ============
============ Train epoch 73 ============
============ Train epoch 74 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0184 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0265 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.2173 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.2038 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0250 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0175 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1217 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.0842 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0602 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0631 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0272 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0197 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.2475 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.1769 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0205 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0192 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0883 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1227 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.0784 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0571 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9949
 Best site-MNIST      | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:14 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:14 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:14 | Val Acc: 1.0000
 Best site-USPS       | Epoch:14 | Val Acc: 1.0000
 Best site-USPS       | Epoch:14 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:14 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:14 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 75 ============
============ Train epoch 76 ============
============ Train epoch 77 ============
============ Train epoch 78 ============
============ Train epoch 79 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0136 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0162 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1998 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1596 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0210 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0129 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0761 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0612 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0655 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0663 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0183 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0126 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.1831 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.1606 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0147 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0136 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0677 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0765 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0792 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0573 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9983
 Best site-MNIST      | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:15 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:15 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:15 | Val Acc: 1.0000
 Best site-USPS       | Epoch:15 | Val Acc: 1.0000
 Best site-USPS       | Epoch:15 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:15 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:15 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 80 ============
============ Train epoch 81 ============
============ Train epoch 82 ============
============ Train epoch 83 ============
============ Train epoch 84 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0120 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0161 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1636 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1239 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0182 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0106 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0750 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.0561 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0444 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0440 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0162 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0121 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.1494 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.1207 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0128 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0123 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0624 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0864 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.0531 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0388 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9966
============ Train epoch 85 ============
============ Train epoch 86 ============
============ Train epoch 87 ============
============ Train epoch 88 ============
============ Train epoch 89 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0104 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0107 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1384 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1022 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0145 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0089 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0417 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0515 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0484 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0434 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0124 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0090 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.1303 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.1179 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0098 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0101 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0563 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0504 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0555 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0385 | Val  Acc: 1.0000
Average Valid Accuracy: 1.0000
 Best site-MNIST      | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:17 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:17 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:17 | Val Acc: 1.0000
 Best site-USPS       | Epoch:17 | Val Acc: 1.0000
 Best site-USPS       | Epoch:17 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:17 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:17 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 90 ============
============ Train epoch 91 ============
============ Train epoch 92 ============
============ Train epoch 93 ============
============ Train epoch 94 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0090 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0116 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1197 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1007 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0127 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0073 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0512 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0391 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0311 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0296 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0089 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.1307 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.0894 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0093 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0091 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0462 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0546 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0358 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0272 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9983
============ Train epoch 95 ============
============ Train epoch 96 ============
============ Train epoch 97 ============
============ Train epoch 98 ============
============ Train epoch 99 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0074 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0080 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0969 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0663 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0116 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0066 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0330 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0343 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0342 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0329 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0089 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0063 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0997 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.0815 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0404 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0351 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0437 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0288 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9983
============ Train epoch 100 ============
============ Train epoch 101 ============
============ Train epoch 102 ============
============ Train epoch 103 ============
============ Train epoch 104 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0071 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0084 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0827 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0905 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0113 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0058 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0376 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0324 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0230 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0221 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0093 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0065 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.1022 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.0686 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0073 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0070 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0359 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0440 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0267 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0208 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9983
============ Train epoch 105 ============
============ Train epoch 106 ============
============ Train epoch 107 ============
============ Train epoch 108 ============
============ Train epoch 109 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0062 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0059 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0917 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0536 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0098 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0055 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0252 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0327 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0304 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0305 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0067 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0053 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0924 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.0714 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0070 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0056 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0355 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0287 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0401 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0261 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9983
============ Train epoch 110 ============
============ Train epoch 111 ============
============ Train epoch 112 ============
============ Train epoch 113 ============
============ Train epoch 114 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0079 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0108 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0902 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0768 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0098 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0045 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0483 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0358 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0213 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0188 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0120 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0072 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.1071 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.0658 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0404 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0468 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0198 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0192 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9983
============ Train epoch 115 ============
============ Train epoch 116 ============
============ Train epoch 117 ============
============ Train epoch 118 ============
============ Train epoch 119 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0055 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0094 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0876 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0424 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0090 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0058 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0249 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0283 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0257 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0246 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0111 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0055 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0864 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.0666 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0056 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0344 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0265 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0386 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0208 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9983
============ Train epoch 120 ============
============ Train epoch 121 ============
============ Train epoch 122 ============
============ Train epoch 123 ============
============ Train epoch 124 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0044 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0063 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0449 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0502 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0079 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0192 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0224 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0147 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0134 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0042 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0772 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0392 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0253 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0241 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0155 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0135 | Val  Acc: 1.0000
Average Valid Accuracy: 1.0000
============ Train epoch 125 ============
============ Train epoch 126 ============
============ Train epoch 127 ============
============ Train epoch 128 ============
============ Train epoch 129 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0041 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0051 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0407 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0270 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0061 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0032 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0153 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0165 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0149 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0148 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0057 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0647 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.0311 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0207 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0154 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0204 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0134 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9983
============ Train epoch 130 ============
============ Train epoch 131 ============
============ Train epoch 132 ============
============ Train epoch 133 ============
============ Train epoch 134 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0047 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0563 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0209 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0047 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0150 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0149 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0149 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0131 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0042 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0035 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0574 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.0351 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0182 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0170 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0170 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0114 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9983
============ Train epoch 135 ============
============ Train epoch 136 ============
============ Train epoch 137 ============
============ Train epoch 138 ============
============ Train epoch 139 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0032 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0261 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0299 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0045 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0118 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0134 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0113 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0096 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0506 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0243 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0159 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0127 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0148 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0094 | Val  Acc: 1.0000
Average Valid Accuracy: 1.0000
============ Train epoch 140 ============
============ Train epoch 141 ============
============ Train epoch 142 ============
============ Train epoch 143 ============
============ Train epoch 144 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0572 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.0151 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0037 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0135 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0136 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0112 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0111 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0440 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.0251 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0181 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0155 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0158 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0105 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9983
============ Train epoch 145 ============
============ Train epoch 146 ============
============ Train epoch 147 ============
============ Train epoch 148 ============
============ Train epoch 149 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0257 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0279 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0096 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0101 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0101 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0090 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0499 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0259 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0142 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0097 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0132 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0082 | Val  Acc: 1.0000
Average Valid Accuracy: 1.0000
============ Train epoch 150 ============
============ Train epoch 151 ============
============ Train epoch 152 ============
============ Train epoch 153 ============
============ Train epoch 154 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0583 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.0122 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0137 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0115 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0096 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0098 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0466 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.0243 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0151 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0148 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0145 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0096 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9983
============ Train epoch 155 ============
============ Train epoch 156 ============
============ Train epoch 157 ============
============ Train epoch 158 ============
============ Train epoch 159 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0263 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0257 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0064 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0090 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0085 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0075 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0469 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0262 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0127 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0135 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0076 | Val  Acc: 1.0000
Average Valid Accuracy: 1.0000
============ Train epoch 160 ============
============ Train epoch 161 ============
============ Train epoch 162 ============
============ Train epoch 163 ============
============ Train epoch 164 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0020 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0548 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.0106 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0129 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0088 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0072 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0081 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0431 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.0205 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0117 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0123 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0112 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0084 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9983
============ Train epoch 165 ============
============ Train epoch 166 ============
============ Train epoch 167 ============
============ Train epoch 168 ============
============ Train epoch 169 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0249 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0302 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0051 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0084 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0077 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0065 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0495 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0290 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0116 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0067 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0138 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0066 | Val  Acc: 1.0000
Average Valid Accuracy: 1.0000
============ Train epoch 170 ============
============ Train epoch 171 ============
============ Train epoch 172 ============
============ Train epoch 173 ============
============ Train epoch 174 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0479 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.0092 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0099 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0091 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0078 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0077 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0431 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.0180 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0129 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0096 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0129 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0071 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9983
============ Train epoch 175 ============
============ Train epoch 176 ============
============ Train epoch 177 ============
============ Train epoch 178 ============
============ Train epoch 179 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0214 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0211 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0047 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0061 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0067 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0053 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0411 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0222 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0089 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0054 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0117 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0055 | Val  Acc: 1.0000
Average Valid Accuracy: 1.0000
============ Train epoch 180 ============
============ Train epoch 181 ============
============ Train epoch 182 ============
============ Train epoch 183 ============
============ Train epoch 184 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0430 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.0071 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0093 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0080 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0065 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0062 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0397 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.0152 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0113 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0088 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0066 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9983
============ Train epoch 185 ============
============ Train epoch 186 ============
============ Train epoch 187 ============
============ Train epoch 188 ============
============ Train epoch 189 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0222 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0153 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0040 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0052 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0056 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0046 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0340 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0204 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0079 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0123 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0046 | Val  Acc: 1.0000
Average Valid Accuracy: 1.0000
============ Train epoch 190 ============
============ Train epoch 191 ============
============ Train epoch 192 ============
============ Train epoch 193 ============
============ Train epoch 194 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0380 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.0066 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0072 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0055 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0054 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0050 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0418 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.0126 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0081 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0070 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0116 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0057 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9983
============ Train epoch 195 ============
============ Train epoch 196 ============
============ Train epoch 197 ============
============ Train epoch 198 ============
============ Train epoch 199 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[7, 2, 1, ]
 Site-MNIST     | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0261 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.0061 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0105 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.0156 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0069 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0060 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.0379 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.0152 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0204 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0115 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0078 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.0067 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9983
===2023-03-31 23:15:20===
===2023-03-31 23:15:21===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:17 | Test Acc: 0.8779
 Test site-SVHN      | Epoch:17 | Test Acc: 0.3854
 Test site-USPS      | Epoch:17 | Test Acc: 0.8925
 Test site-SynthDigits| Epoch:17 | Test Acc: 0.6658
 Test site-MNIST-M   | Epoch:17 | Test Acc: 0.3821
Average Test Accuracy: 0.6407
===2023-04-03 00:15:38===
===2023-04-03 11:23:35===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 20
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[5, 2, 3, ]
 Site-MNIST     | Train Loss: 1.1908 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.2530 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 1.8586 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.8510 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.1547 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 1.2410 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.7436 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.6695 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.6952 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.5421 | Train Acc: 0.5682
 Site-MNIST     | Val  Loss: 1.5169 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.3382 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.1724 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.1203 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.4028 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 1.2799 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 2.0971 | Val  Acc: 0.2373
 Site-SynthDigits| Val  Loss: 1.8440 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 2.2615 | Val  Acc: 0.1525
 Site-MNIST-M   | Val  Loss: 1.9296 | Val  Acc: 0.3051
Average Valid Accuracy: 0.4458
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2034
 Best site-USPS       | Epoch:0 | Val Acc: 0.6780
 Best site-USPS       | Epoch:0 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2373
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1525
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[3, 2, 5, ]
 Site-MNIST     | Train Loss: 0.6896 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.7553 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.6082 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.5560 | Train Acc: 0.4432
 Site-USPS      | Train Loss: 0.6716 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.7398 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.3548 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.2237 | Train Acc: 0.7386
 Site-MNIST-M   | Train Loss: 1.2589 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 1.0739 | Train Acc: 0.8523
 Site-MNIST     | Val  Loss: 1.1054 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 0.9011 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.1823 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 1.8858 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.9693 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 0.7951 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.9217 | Val  Acc: 0.3559
 Site-SynthDigits| Val  Loss: 1.5640 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 2.1901 | Val  Acc: 0.1525
 Site-MNIST-M   | Val  Loss: 1.6633 | Val  Acc: 0.4746
Average Valid Accuracy: 0.5254
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3220
 Best site-USPS       | Epoch:1 | Val Acc: 0.7627
 Best site-USPS       | Epoch:1 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3559
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1525
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[3, 2, 5, ]
 Site-MNIST     | Train Loss: 0.4646 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.5578 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.3924 | Train Acc: 0.5455
 Site-SVHN      | Train Loss: 1.3555 | Train Acc: 0.6023
 Site-USPS      | Train Loss: 0.4591 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.5070 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 1.0855 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 0.9795 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.9499 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.7521 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.9282 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 0.6825 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.1960 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 1.7754 | Val  Acc: 0.3898
 Site-USPS      | Val  Loss: 0.7922 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 0.5671 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.8146 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 1.3968 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 2.1570 | Val  Acc: 0.1356
 Site-MNIST-M   | Val  Loss: 1.4741 | Val  Acc: 0.5763
Average Valid Accuracy: 0.5678
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3898
 Best site-USPS       | Epoch:2 | Val Acc: 0.7797
 Best site-USPS       | Epoch:2 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1356
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[3, 2, 5, ]
 Site-MNIST     | Train Loss: 0.3508 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.4053 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.2777 | Train Acc: 0.6477
 Site-SVHN      | Train Loss: 1.2013 | Train Acc: 0.6932
 Site-USPS      | Train Loss: 0.3467 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.3937 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.8814 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.8042 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.7269 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.5704 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.8488 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 0.5691 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.2360 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 1.7013 | Val  Acc: 0.4407
 Site-USPS      | Val  Loss: 0.7031 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 0.4522 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.7816 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 1.2997 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 2.1457 | Val  Acc: 0.1864
 Site-MNIST-M   | Val  Loss: 1.3706 | Val  Acc: 0.6102
Average Valid Accuracy: 0.5966
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4407
 Best site-USPS       | Epoch:3 | Val Acc: 0.7966
 Best site-USPS       | Epoch:3 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1864
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[3, 2, 5, ]
 Site-MNIST     | Train Loss: 0.2890 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.3299 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.2031 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 1.0376 | Train Acc: 0.7727
 Site-USPS      | Train Loss: 0.2824 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.2988 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.7561 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.6591 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.5747 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.4481 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.8000 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 0.5033 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 2.2747 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 1.6325 | Val  Acc: 0.4915
 Site-USPS      | Val  Loss: 0.6498 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.3918 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.7790 | Val  Acc: 0.3729
 Site-SynthDigits| Val  Loss: 1.2426 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 2.1598 | Val  Acc: 0.1864
 Site-MNIST-M   | Val  Loss: 1.3105 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6017
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4915
 Best site-USPS       | Epoch:4 | Val Acc: 0.8136
 Best site-USPS       | Epoch:4 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3729
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.1864
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[3, 2, 5, ]
 Site-MNIST     | Train Loss: 0.2569 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.2877 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.1147 | Train Acc: 0.6932
 Site-SVHN      | Train Loss: 0.9431 | Train Acc: 0.7955
 Site-USPS      | Train Loss: 0.2369 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.2506 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.6621 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.5776 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.4705 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.3421 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.7719 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.4554 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 2.3254 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 1.5944 | Val  Acc: 0.4915
 Site-USPS      | Val  Loss: 0.6118 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 0.3528 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.7678 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 1.2026 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 2.1684 | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: 1.2688 | Val  Acc: 0.6102
Average Valid Accuracy: 0.6085
 Best site-MNIST      | Epoch:5 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4915
 Best site-USPS       | Epoch:5 | Val Acc: 0.7966
 Best site-USPS       | Epoch:5 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6949
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2034
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 30 ============
===2023-04-03 11:43:44===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 20
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[5, 2, 3, ]
 Site-MNIST     | Train Loss: 1.1908 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.2530 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 1.8586 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.8510 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.1547 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 1.2410 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.7436 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.6695 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.6952 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.5421 | Train Acc: 0.5682
 Site-MNIST     | Val  Loss: 1.5169 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.3382 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.1724 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.1203 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.4028 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 1.2799 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 2.0971 | Val  Acc: 0.2373
 Site-SynthDigits| Val  Loss: 1.8440 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 2.2615 | Val  Acc: 0.1525
 Site-MNIST-M   | Val  Loss: 1.9296 | Val  Acc: 0.3051
Average Valid Accuracy: 0.4458
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2034
 Best site-USPS       | Epoch:0 | Val Acc: 0.6780
 Best site-USPS       | Epoch:0 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2373
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1525
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
===2023-04-03 11:49:29===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 20
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-2
client-3 is in G-0
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
cnt=[6, 2, 2, ]
 Site-MNIST     | Train Loss: 2.0452 | Train Acc: 0.4545
 Site-MNIST     | Train Loss: 1.9674 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 2.1480 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.1481 | Train Acc: 0.2386
 Site-USPS      | Train Loss: 1.9721 | Train Acc: 0.3636
 Site-USPS      | Train Loss: 2.0360 | Train Acc: 0.3977
 Site-SynthDigits| Train Loss: 2.1704 | Train Acc: 0.1591
 Site-SynthDigits| Train Loss: 2.1351 | Train Acc: 0.1591
 Site-MNIST-M   | Train Loss: 2.2138 | Train Acc: 0.1932
 Site-MNIST-M   | Train Loss: 2.1046 | Train Acc: 0.2386
 Site-MNIST     | Val  Loss: 2.0789 | Val  Acc: 0.3220
 Site-MNIST     | Val  Loss: 2.0597 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.2393 | Val  Acc: 0.1356
 Site-SVHN      | Val  Loss: 2.2674 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 2.0744 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 2.0397 | Val  Acc: 0.3390
 Site-SynthDigits| Val  Loss: 2.2824 | Val  Acc: 0.0847
 Site-SynthDigits| Val  Loss: 2.1654 | Val  Acc: 0.1525
 Site-MNIST-M   | Val  Loss: 2.2876 | Val  Acc: 0.1017
 Site-MNIST-M   | Val  Loss: 2.2342 | Val  Acc: 0.2203
Average Valid Accuracy: 0.2102
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3220
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1356
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1864
 Best site-USPS       | Epoch:0 | Val Acc: 0.2881
 Best site-USPS       | Epoch:0 | Val Acc: 0.3390
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0847
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1525
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1017
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 1 ============
===2023-04-03 11:52:21===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 20
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
===2023-04-03 11:52:32===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 20
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-2
client-3 is in G-0
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
cnt=[6, 2, 2, ]
 Site-MNIST     | Train Loss: 2.0341 | Train Acc: 0.4773
 Site-MNIST     | Train Loss: 1.9573 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 2.1513 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1471 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.9597 | Train Acc: 0.3636
 Site-USPS      | Train Loss: 2.0231 | Train Acc: 0.4205
 Site-SynthDigits| Train Loss: 2.1669 | Train Acc: 0.1818
 Site-SynthDigits| Train Loss: 2.1314 | Train Acc: 0.1705
 Site-MNIST-M   | Train Loss: 2.2128 | Train Acc: 0.1591
 Site-MNIST-M   | Train Loss: 2.1011 | Train Acc: 0.2386
 Site-MNIST     | Val  Loss: 2.0679 | Val  Acc: 0.3729
 Site-MNIST     | Val  Loss: 2.0458 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.2351 | Val  Acc: 0.1356
 Site-SVHN      | Val  Loss: 2.2673 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 2.0610 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 2.0268 | Val  Acc: 0.3390
 Site-SynthDigits| Val  Loss: 2.2832 | Val  Acc: 0.1356
 Site-SynthDigits| Val  Loss: 2.1591 | Val  Acc: 0.1525
 Site-MNIST-M   | Val  Loss: 2.2846 | Val  Acc: 0.1017
 Site-MNIST-M   | Val  Loss: 2.2322 | Val  Acc: 0.2203
Average Valid Accuracy: 0.2220
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3729
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1356
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1864
 Best site-USPS       | Epoch:0 | Val Acc: 0.2881
 Best site-USPS       | Epoch:0 | Val Acc: 0.3390
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1356
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1525
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1017
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 1 ============
===2023-04-03 11:53:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 20
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[5, 2, 3, ], 3
 Site-MNIST     | Train Loss: 1.1786 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.2378 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 1.8544 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.8379 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.1289 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 1.2192 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.7272 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 1.6544 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.6971 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.5408 | Train Acc: 0.5114
 Site-MNIST     | Val  Loss: 1.5045 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.3198 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.1668 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.0959 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.3733 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 1.2615 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 2.0893 | Val  Acc: 0.2712
 Site-SynthDigits| Val  Loss: 1.8208 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 2.2587 | Val  Acc: 0.1017
 Site-MNIST-M   | Val  Loss: 1.9261 | Val  Acc: 0.3051
Average Valid Accuracy: 0.4441
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1864
 Best site-USPS       | Epoch:0 | Val Acc: 0.6610
 Best site-USPS       | Epoch:0 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2712
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1017
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[3, 2, 5, ], 3
 Site-MNIST     | Train Loss: 0.6699 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.7316 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.5932 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.5424 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.6340 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.6951 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.3209 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.2104 | Train Acc: 0.7159
 Site-MNIST-M   | Train Loss: 1.2591 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 1.0756 | Train Acc: 0.8864
 Site-MNIST     | Val  Loss: 1.0899 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 0.8621 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.1582 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 1.8557 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 0.9117 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 0.7487 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.8760 | Val  Acc: 0.3390
 Site-SynthDigits| Val  Loss: 1.5215 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 2.1817 | Val  Acc: 0.1525
 Site-MNIST-M   | Val  Loss: 1.6641 | Val  Acc: 0.4915
Average Valid Accuracy: 0.5254
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3390
 Best site-USPS       | Epoch:1 | Val Acc: 0.7627
 Best site-USPS       | Epoch:1 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3390
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1525
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[3, 2, 5, ], 3
 Site-MNIST     | Train Loss: 0.3976 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.4887 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.3373 | Train Acc: 0.5455
 Site-SVHN      | Train Loss: 1.3133 | Train Acc: 0.6591
 Site-USPS      | Train Loss: 0.3913 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.4284 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 1.0061 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.9078 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.9266 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.7348 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.8408 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 0.5932 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.1713 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 1.6948 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.6883 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.4818 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.7247 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.3500 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 2.1119 | Val  Acc: 0.1695
 Site-MNIST-M   | Val  Loss: 1.4494 | Val  Acc: 0.5593
Average Valid Accuracy: 0.5932
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4746
 Best site-USPS       | Epoch:2 | Val Acc: 0.8305
 Best site-USPS       | Epoch:2 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1695
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[3, 2, 5, ], 3
 Site-MNIST     | Train Loss: 0.3047 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.3588 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.1359 | Train Acc: 0.7159
 Site-SVHN      | Train Loss: 1.1053 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 0.2293 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.2613 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.7952 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.7621 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.7043 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.5228 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.7825 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.5082 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 2.1719 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.5862 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 0.5241 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.3133 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.6324 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 1.2504 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 2.0341 | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: 1.3306 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6271
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5085
 Best site-USPS       | Epoch:3 | Val Acc: 0.8475
 Best site-USPS       | Epoch:3 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4576
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2034
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[3, 2, 5, ], 3
 Site-MNIST     | Train Loss: 0.1966 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.2312 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.9310 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 0.8313 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.1868 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1886 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.6542 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.5483 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.5217 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.3670 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.6216 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.3944 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 2.1950 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.4480 | Val  Acc: 0.6102
 Site-USPS      | Val  Loss: 0.4763 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.2729 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 1.5935 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.1902 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 1.9950 | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: 1.2029 | Val  Acc: 0.6610
Average Valid Accuracy: 0.6508
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:4 | Val Acc: 0.6102
 Best site-USPS       | Epoch:4 | Val Acc: 0.8475
 Best site-USPS       | Epoch:4 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2034
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6610
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 25 ============
===2023-04-03 12:11:58===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 20
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[5, 2, 3, ], 3
 Site-MNIST     | Train Loss: 1.1786 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.2378 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 1.8544 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.8379 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.1289 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 1.2192 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.7272 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 1.6544 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.6971 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.5408 | Train Acc: 0.5114
 Site-MNIST     | Val  Loss: 1.5045 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.3198 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.1668 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.0959 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.3733 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 1.2615 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 2.0893 | Val  Acc: 0.2712
 Site-SynthDigits| Val  Loss: 1.8208 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 2.2587 | Val  Acc: 0.1017
 Site-MNIST-M   | Val  Loss: 1.9261 | Val  Acc: 0.3051
Average Valid Accuracy: 0.4441
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1864
 Best site-USPS       | Epoch:0 | Val Acc: 0.6610
 Best site-USPS       | Epoch:0 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2712
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1017
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
cnt=[5, 3, 2, ], 3
 Site-MNIST     | Train Loss: 0.6611 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.7229 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.6087 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.5498 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.6345 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.6953 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.3215 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.2174 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 1.2645 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.0896 | Train Acc: 0.8864
 Site-MNIST     | Val  Loss: 1.0755 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 0.8492 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.1439 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 1.8577 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.9081 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 0.7497 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.8688 | Val  Acc: 0.3390
 Site-SynthDigits| Val  Loss: 1.5280 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 2.1926 | Val  Acc: 0.1864
 Site-MNIST-M   | Val  Loss: 1.6630 | Val  Acc: 0.4915
Average Valid Accuracy: 0.5373
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3220
 Best site-USPS       | Epoch:1 | Val Acc: 0.7627
 Best site-USPS       | Epoch:1 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3390
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1864
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
===2023-04-03 12:21:18===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 20
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[6, 2, 2, ], 3
 Site-MNIST     | Train Loss: 1.1639 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.2221 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 1.8571 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.8396 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.1338 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 1.2257 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.7275 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.6532 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.6944 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.5463 | Train Acc: 0.4886
 Site-MNIST     | Val  Loss: 1.4859 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.3017 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 2.1687 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.0946 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.3782 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 1.2685 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 2.0873 | Val  Acc: 0.2712
 Site-SynthDigits| Val  Loss: 1.8259 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 2.2586 | Val  Acc: 0.1186
 Site-MNIST-M   | Val  Loss: 1.9283 | Val  Acc: 0.3051
Average Valid Accuracy: 0.4475
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1864
 Best site-USPS       | Epoch:0 | Val Acc: 0.6610
 Best site-USPS       | Epoch:0 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2712
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1186
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[6, 2, 2, ], 3
 Site-MNIST     | Train Loss: 0.6569 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.7200 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.6054 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.5515 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.6347 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.6914 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.3337 | Train Acc: 0.7614
 Site-SynthDigits| Train Loss: 1.2253 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 1.2575 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 1.0823 | Train Acc: 0.8864
 Site-MNIST     | Val  Loss: 1.0797 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 0.8490 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.1480 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 1.8626 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.9095 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 0.7509 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.8780 | Val  Acc: 0.3390
 Site-SynthDigits| Val  Loss: 1.5326 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 2.1877 | Val  Acc: 0.1525
 Site-MNIST-M   | Val  Loss: 1.6712 | Val  Acc: 0.4746
Average Valid Accuracy: 0.5237
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3220
 Best site-USPS       | Epoch:1 | Val Acc: 0.7627
 Best site-USPS       | Epoch:1 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3390
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1525
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[6, 2, 2, ], 3
 Site-MNIST     | Train Loss: 0.3501 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.4216 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.3621 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.3375 | Train Acc: 0.6477
 Site-USPS      | Train Loss: 0.4046 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.4416 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.0533 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 0.9386 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.9276 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.7543 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.7535 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.5330 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 2.1728 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 1.7040 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.6979 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 0.4991 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.7262 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 1.3866 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 2.1101 | Val  Acc: 0.1695
 Site-MNIST-M   | Val  Loss: 1.4284 | Val  Acc: 0.5763
Average Valid Accuracy: 0.5915
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4576
 Best site-USPS       | Epoch:2 | Val Acc: 0.7966
 Best site-USPS       | Epoch:2 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1695
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
cnt=[4, 2, 4, ], 3
 Site-MNIST     | Train Loss: 0.2748 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.3173 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.1547 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 1.1297 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 0.2919 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.3093 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.8089 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.7400 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.6877 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.5379 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.7354 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.4636 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 2.2088 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.6283 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.5943 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.3804 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.6629 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.2430 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 2.0785 | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: 1.3254 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6203
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4746
 Best site-USPS       | Epoch:3 | Val Acc: 0.8305
 Best site-USPS       | Epoch:3 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2034
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
cnt=[4, 4, 2, ], 3
 Site-MNIST     | Train Loss: 0.1508 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1728 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.1160 | Train Acc: 0.7045
 Site-SVHN      | Train Loss: 0.9499 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.2189 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.2054 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.6444 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.5671 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.5417 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.4204 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5601 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.3542 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 2.2283 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.5426 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 0.5251 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.2958 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 1.6410 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 1.1973 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 2.0652 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 1.2640 | Val  Acc: 0.6441
Average Valid Accuracy: 0.6492
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5763
 Best site-USPS       | Epoch:4 | Val Acc: 0.8305
 Best site-USPS       | Epoch:4 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4576
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6441
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
cnt=[4, 2, 4, ], 3
 Site-MNIST     | Train Loss: 0.1769 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.2015 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.8968 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 0.8110 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.1461 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.1442 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.5206 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.4525 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.3944 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.2887 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.6635 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.3623 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 2.2343 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.4906 | Val  Acc: 0.5593
 Site-USPS      | Val  Loss: 0.4650 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.2457 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.6007 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 1.1031 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 2.0483 | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: 1.2052 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6339
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
cnt=[4, 2, 4, ], 3
 Site-MNIST     | Train Loss: 0.0869 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0966 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.8033 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 0.6849 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.1375 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.1383 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.4391 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.3514 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.3160 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.2378 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4671 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.2903 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 2.2859 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.4681 | Val  Acc: 0.5932
 Site-USPS      | Val  Loss: 0.4722 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.2317 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.6375 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 1.1259 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 2.0443 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 1.1740 | Val  Acc: 0.6441
Average Valid Accuracy: 0.6508
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5932
 Best site-USPS       | Epoch:6 | Val Acc: 0.8136
 Best site-USPS       | Epoch:6 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4576
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6949
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6441
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
cnt=[4, 2, 4, ], 3
 Site-MNIST     | Train Loss: 0.0822 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1036 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.6848 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 0.5573 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.0962 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0982 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.3748 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.3256 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.2599 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1806 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5371 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.2968 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 2.3026 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.4409 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 0.4029 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.1906 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.6198 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 1.0967 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 2.0671 | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: 1.1617 | Val  Acc: 0.6441
Average Valid Accuracy: 0.6458
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
cnt=[4, 2, 4, ], 3
 Site-MNIST     | Train Loss: 0.0514 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0522 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.6881 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 0.5471 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.0919 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0849 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.3120 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.2774 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.2213 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.1592 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4045 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.2727 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 2.3445 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.4249 | Val  Acc: 0.5932
 Site-USPS      | Val  Loss: 0.4061 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.1839 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.6782 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.1086 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 2.0568 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 1.1551 | Val  Acc: 0.6441
Average Valid Accuracy: 0.6610
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5932
 Best site-USPS       | Epoch:8 | Val Acc: 0.8475
 Best site-USPS       | Epoch:8 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6441
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
cnt=[4, 2, 4, ], 3
 Site-MNIST     | Train Loss: 0.0558 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0702 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.5127 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 0.4274 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.0728 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0701 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.3109 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.2489 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.1915 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1263 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4856 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.2775 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 2.3769 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 1.4042 | Val  Acc: 0.5932
 Site-USPS      | Val  Loss: 0.3757 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.1751 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.7251 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.1203 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 2.0848 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 1.1429 | Val  Acc: 0.6441
Average Valid Accuracy: 0.6542
============ Train epoch 50 ============
===2023-04-03 12:54:36===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:8 | Test Acc: 0.4143
 Test site-SVHN      | Epoch:8 | Test Acc: 0.1582
 Test site-USPS      | Epoch:8 | Test Acc: 0.2796
 Test site-SynthDigits| Epoch:8 | Test Acc: 0.1897
 Test site-MNIST-M   | Epoch:8 | Test Acc: 0.1271
Average Test Accuracy: 0.2338
===2023-04-03 13:00:22===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
===2023-04-03 13:00:30===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[5, 2, 3, ]
 Site-MNIST     | Train Loss: 1.1586 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.2080 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 1.8370 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.8321 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 1.1405 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 1.2062 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.6413 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.5456 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.6684 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.5148 | Train Acc: 0.5682
 Site-MNIST     | Val  Loss: 1.4897 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.2919 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.1752 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.1000 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 1.3937 | Val  Acc: 0.6949
 Site-USPS      | Val  Loss: 1.2462 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 2.0451 | Val  Acc: 0.2712
 Site-SynthDigits| Val  Loss: 1.7366 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 2.2757 | Val  Acc: 0.1525
 Site-MNIST-M   | Val  Loss: 1.9083 | Val  Acc: 0.3051
Average Valid Accuracy: 0.4542
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2203
 Best site-USPS       | Epoch:0 | Val Acc: 0.6949
 Best site-USPS       | Epoch:0 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2712
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1525
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[3, 2, 5, ]
 Site-MNIST     | Train Loss: 0.5111 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.4660 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 1.4493 | Train Acc: 0.6136
 Site-SVHN      | Train Loss: 1.3965 | Train Acc: 0.6023
 Site-USPS      | Train Loss: 0.6375 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.6933 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.9654 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.8456 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 1.0924 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.9176 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.9500 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 0.6585 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.2185 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 1.7570 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.9297 | Val  Acc: 0.7458
 Site-USPS      | Val  Loss: 0.7640 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.7641 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 1.3390 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 2.2234 | Val  Acc: 0.1695
 Site-MNIST-M   | Val  Loss: 1.5501 | Val  Acc: 0.5932
Average Valid Accuracy: 0.5746
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4237
 Best site-USPS       | Epoch:1 | Val Acc: 0.7458
 Best site-USPS       | Epoch:1 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1695
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.5932
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[3, 2, 5, ]
 Site-MNIST     | Train Loss: 0.1144 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1080 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.5537 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.6122 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.3229 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.3735 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.3641 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.3307 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.4865 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.2779 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.6054 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.3489 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 2.2612 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 1.3771 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 0.6422 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 0.4585 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.6418 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 1.0623 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 2.1642 | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: 1.1524 | Val  Acc: 0.6441
Average Valid Accuracy: 0.6220
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:2 | Val Acc: 0.5763
 Best site-USPS       | Epoch:2 | Val Acc: 0.7797
 Best site-USPS       | Epoch:2 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2034
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.6441
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
===2023-04-03 13:14:06===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
cnt=[2, 7, 1, ]
 Site-MNIST     | Train Loss: 1.1808 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.1853 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 1.8255 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.8491 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 1.1576 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 1.2108 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.6230 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 1.5328 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.6762 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.5111 | Train Acc: 0.5682
 Site-MNIST     | Val  Loss: 1.4968 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.3037 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 2.1784 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0928 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 1.3965 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 1.2553 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 2.0473 | Val  Acc: 0.2712
 Site-SynthDigits| Val  Loss: 1.7364 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 2.2781 | Val  Acc: 0.1356
 Site-MNIST-M   | Val  Loss: 1.9117 | Val  Acc: 0.3051
Average Valid Accuracy: 0.4542
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7288
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2203
 Best site-USPS       | Epoch:0 | Val Acc: 0.6780
 Best site-USPS       | Epoch:0 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2712
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1356
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
cnt=[2, 7, 1, ]
 Site-MNIST     | Train Loss: 0.5217 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.4825 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 1.4267 | Train Acc: 0.5909
 Site-SVHN      | Train Loss: 1.4620 | Train Acc: 0.5682
 Site-USPS      | Train Loss: 0.6713 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.6486 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.9346 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.8389 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 1.0719 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.9287 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.9417 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 0.6364 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.2215 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 1.8224 | Val  Acc: 0.3898
 Site-USPS      | Val  Loss: 0.9520 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 0.7223 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.7544 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 1.3250 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 2.2233 | Val  Acc: 0.1525
 Site-MNIST-M   | Val  Loss: 1.5583 | Val  Acc: 0.5763
Average Valid Accuracy: 0.5644
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3898
 Best site-USPS       | Epoch:1 | Val Acc: 0.7288
 Best site-USPS       | Epoch:1 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1525
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
cnt=[2, 7, 1, ]
 Site-MNIST     | Train Loss: 0.1234 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0948 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.6072 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.9395 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 0.3198 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.2639 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.4065 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.3640 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.4598 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.2902 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.6166 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.3676 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 2.2925 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 1.5306 | Val  Acc: 0.5593
 Site-USPS      | Val  Loss: 0.6635 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 0.3974 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.7336 | Val  Acc: 0.3898
 Site-SynthDigits| Val  Loss: 1.0559 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 2.1905 | Val  Acc: 0.1695
 Site-MNIST-M   | Val  Loss: 1.1672 | Val  Acc: 0.6441
Average Valid Accuracy: 0.6119
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:2 | Val Acc: 0.5593
 Best site-USPS       | Epoch:2 | Val Acc: 0.7966
 Best site-USPS       | Epoch:2 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3898
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.6949
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1695
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.6441
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
cnt=[2, 7, 1, ]
 Site-MNIST     | Train Loss: 0.0230 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0217 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1425 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.2865 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1664 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.0913 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1352 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1107 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1006 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.0498 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5124 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.3510 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 2.3599 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.2603 | Val  Acc: 0.6102
 Site-USPS      | Val  Loss: 0.4910 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.2274 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.6752 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 0.9469 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 2.2792 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 1.0106 | Val  Acc: 0.6610
Average Valid Accuracy: 0.6525
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:3 | Val Acc: 0.6102
 Best site-USPS       | Epoch:3 | Val Acc: 0.8136
 Best site-USPS       | Epoch:3 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4576
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.7288
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.6610
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 20 ============
===2023-04-03 13:34:23===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
cnt=[2, 7, 1, ]
 Site-MNIST     | Train Loss: 1.1932 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.2092 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 1.8437 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.8602 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.1462 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.2210 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 1.7123 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 1.6417 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.7007 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.5314 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 1.5063 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.3238 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.1677 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.0966 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.3795 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 1.2662 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 2.0875 | Val  Acc: 0.2712
 Site-SynthDigits| Val  Loss: 1.8192 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 2.2552 | Val  Acc: 0.1186
 Site-MNIST-M   | Val  Loss: 1.9248 | Val  Acc: 0.3051
Average Valid Accuracy: 0.4492
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2034
 Best site-USPS       | Epoch:0 | Val Acc: 0.6780
 Best site-USPS       | Epoch:0 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2712
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1186
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
===2023-04-03 13:38:03===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:0 | Test Acc: 0.0971
 Test site-SVHN      | Epoch:0 | Test Acc: 0.1219
 Test site-USPS      | Epoch:0 | Test Acc: 0.1022
 Test site-SynthDigits| Epoch:0 | Test Acc: 0.0718
===2023-04-03 13:43:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
cnt=[2, 7, 1, ]
 Site-MNIST     | Train Loss: 1.1932 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.2092 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 1.8437 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.8602 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.1462 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.2210 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 1.7123 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 1.6417 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.7007 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.5314 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 1.5063 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.3238 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.1677 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.0966 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.3795 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 1.2662 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 2.0875 | Val  Acc: 0.2712
 Site-SynthDigits| Val  Loss: 1.8192 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 2.2552 | Val  Acc: 0.1186
 Site-MNIST-M   | Val  Loss: 1.9248 | Val  Acc: 0.3051
Average Valid Accuracy: 0.4492
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2034
 Best site-USPS       | Epoch:0 | Val Acc: 0.6780
 Best site-USPS       | Epoch:0 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2712
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1186
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
 Test site-MNIST     | Epoch:0 | Test Acc: 0.0979
 Test site-SVHN      | Epoch:0 | Test Acc: 0.1154
 Test site-USPS      | Epoch:0 | Test Acc: 0.0806
===2023-04-03 13:50:40===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
cnt=[2, 7, 1, ]
 Site-MNIST     | Train Loss: 1.1435 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.1347 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 1.8788 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.8708 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.1063 | Train Acc: 0.7500
 Site-USPS      | Train Loss: 1.1869 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.6554 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.5830 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.7307 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.5573 | Train Acc: 0.5909
 Site-MNIST     | Val  Loss: 1.4239 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.2310 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.1270 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.0341 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.3057 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 1.2217 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.9733 | Val  Acc: 0.3729
 Site-SynthDigits| Val  Loss: 1.7481 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 2.2366 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 1.8995 | Val  Acc: 0.3729
Average Valid Accuracy: 0.4881
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2034
 Best site-USPS       | Epoch:1 | Val Acc: 0.6780
 Best site-USPS       | Epoch:1 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3729
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
cnt=[2, 7, 1, ]
 Site-MNIST     | Train Loss: 0.5878 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.6472 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 1.5268 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.5199 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 0.5555 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.5925 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.2194 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.1053 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 1.2299 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 1.0769 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.9315 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 0.7256 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.0975 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 1.7673 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 0.7783 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 0.6455 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.6583 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 1.4518 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 2.0659 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 1.6060 | Val  Acc: 0.5593
Average Valid Accuracy: 0.5780
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3729
 Best site-USPS       | Epoch:2 | Val Acc: 0.7797
 Best site-USPS       | Epoch:2 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
 Test site-MNIST     | Epoch:2 | Test Acc: 0.3743
 Test site-SVHN      | Epoch:2 | Test Acc: 0.1723
 Test site-USPS      | Epoch:2 | Test Acc: 0.4624
 Test site-SynthDigits| Epoch:2 | Test Acc: 0.2301
 Test site-MNIST-M   | Epoch:2 | Test Acc: 0.1457
Average Test Accuracy: 0.2769
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
cnt=[2, 7, 1, ]
 Site-MNIST     | Train Loss: 0.3469 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.4084 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 1.2344 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 1.2213 | Train Acc: 0.6932
 Site-USPS      | Train Loss: 0.3012 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.3378 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.9286 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 0.8421 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.8749 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.6988 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.7014 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.4993 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 2.0749 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.5725 | Val  Acc: 0.5254
 Site-USPS      | Val  Loss: 0.5482 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.3794 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.4879 | Val  Acc: 0.5593
 Site-SynthDigits| Val  Loss: 1.2762 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.9438 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 1.3694 | Val  Acc: 0.6102
Average Valid Accuracy: 0.6271
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5254
 Best site-USPS       | Epoch:3 | Val Acc: 0.8136
 Best site-USPS       | Epoch:3 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5593
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
cnt=[2, 7, 1, ]
 Site-MNIST     | Train Loss: 0.2724 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2900 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 0.9955 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 0.9785 | Train Acc: 0.8068
 Site-USPS      | Train Loss: 0.2130 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.2238 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.6658 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.6086 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.6180 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.4753 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.6174 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.4158 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.0612 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.4245 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 0.4306 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.2775 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.3864 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.1380 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 1.8809 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 1.1909 | Val  Acc: 0.6441
Average Valid Accuracy: 0.6559
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5763
 Best site-USPS       | Epoch:4 | Val Acc: 0.8475
 Best site-USPS       | Epoch:4 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6441
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
 Test site-MNIST     | Epoch:4 | Test Acc: 0.5479
 Test site-SVHN      | Epoch:4 | Test Acc: 0.2312
 Test site-USPS      | Epoch:4 | Test Acc: 0.6344
 Test site-SynthDigits| Epoch:4 | Test Acc: 0.3905
 Test site-MNIST-M   | Epoch:4 | Test Acc: 0.2114
Average Test Accuracy: 0.4031
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
cnt=[2, 7, 1, ]
 Site-MNIST     | Train Loss: 0.1666 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1962 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.9013 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 0.8726 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.1511 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.1613 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.5150 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.5027 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.4730 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.3305 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5287 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.3183 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 2.0084 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.3875 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 0.3958 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.2056 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.3533 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.0496 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 1.9021 | Val  Acc: 0.2712
 Site-MNIST-M   | Val  Loss: 1.1214 | Val  Acc: 0.6610
Average Valid Accuracy: 0.6661
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5763
 Best site-USPS       | Epoch:5 | Val Acc: 0.8644
 Best site-USPS       | Epoch:5 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2712
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6610
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
cnt=[2, 7, 1, ]
 Site-MNIST     | Train Loss: 0.1448 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1670 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 0.6377 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 0.6988 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.1214 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1391 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.4056 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.3901 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.3310 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.2678 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5089 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.3212 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.0061 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.3240 | Val  Acc: 0.5932
 Site-USPS      | Val  Loss: 0.4128 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.1821 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.3658 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 1.0128 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 1.8551 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 1.0638 | Val  Acc: 0.6441
Average Valid Accuracy: 0.6678
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5932
 Best site-USPS       | Epoch:6 | Val Acc: 0.8814
 Best site-USPS       | Epoch:6 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6441
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
 Test site-MNIST     | Epoch:6 | Test Acc: 0.6057
 Test site-SVHN      | Epoch:6 | Test Acc: 0.2383
 Test site-USPS      | Epoch:6 | Test Acc: 0.6559
 Test site-SynthDigits| Epoch:6 | Test Acc: 0.4109
 Test site-MNIST-M   | Epoch:6 | Test Acc: 0.2036
Average Test Accuracy: 0.4229
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
cnt=[2, 7, 1, ]
 Site-MNIST     | Train Loss: 0.0897 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1247 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.7311 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 0.6068 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.0935 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0840 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.2865 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.2680 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.2528 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1834 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4644 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.2487 | Val  Acc: 0.9153
===2023-04-03 14:25:22===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
cnt=[2, 7, 1, ]
 Site-MNIST     | Train Loss: 1.2500 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.2515 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 1.8572 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.8517 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 1.2155 | Train Acc: 0.8068
 Site-USPS      | Train Loss: 1.2393 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.8174 | Train Acc: 0.4659
 Site-SynthDigits| Train Loss: 1.6639 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.6866 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.5530 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 1.5315 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.3666 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 2.1550 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.0950 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 1.4348 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 1.3065 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 2.0761 | Val  Acc: 0.2712
 Site-SynthDigits| Val  Loss: 1.8541 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.2761 | Val  Acc: 0.1864
 Site-MNIST-M   | Val  Loss: 1.9119 | Val  Acc: 0.3220
Average Valid Accuracy: 0.4508
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7288
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2203
 Best site-USPS       | Epoch:0 | Val Acc: 0.6780
 Best site-USPS       | Epoch:0 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2712
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1864
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
 Test site-MNIST     | Epoch:0 | Test Acc: 0.1150
 Test site-SVHN      | Epoch:0 | Test Acc: 0.1174
 Test site-USPS      | Epoch:0 | Test Acc: 0.1022
 Test site-SynthDigits| Epoch:0 | Test Acc: 0.0685
 Test site-MNIST-M   | Epoch:0 | Test Acc: 0.1007
Average Test Accuracy: 0.1008
============ Train epoch 5 ============
============ Train epoch 6 ============
===2023-04-03 14:33:23===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
===2023-04-03 14:35:34===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 2
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
clients=[(2,)(7,)(1,)]
 Site-MNIST     | Train Loss: 1.9115 | Train Acc: 0.5455
 Site-MNIST     | Train Loss: 1.8097 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 2.2349 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.1878 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.8142 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 1.8369 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 2.1531 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 2.1180 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.1948 | Train Acc: 0.1818
 Site-MNIST-M   | Train Loss: 2.1525 | Train Acc: 0.2386
 Site-MNIST     | Val  Loss: 1.8575 | Val  Acc: 0.4915
 Site-MNIST     | Val  Loss: 1.8229 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 2.1953 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.2222 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.8737 | Val  Acc: 0.5593
 Site-USPS      | Val  Loss: 1.8129 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 2.1421 | Val  Acc: 0.2034
 Site-SynthDigits| Val  Loss: 2.1221 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.1520 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.1953 | Val  Acc: 0.1864
Average Valid Accuracy: 0.3508
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4915
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1864
 Best site-USPS       | Epoch:0 | Val Acc: 0.5593
 Best site-USPS       | Epoch:0 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2034
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
 Test site-MNIST     | Epoch:0 | Test Acc: 0.4421
 Test site-SVHN      | Epoch:0 | Test Acc: 0.2101
 Test site-USPS      | Epoch:0 | Test Acc: 0.5591
 ===2023-04-05 01:30:12===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(7,)(1,)(2,)]
 Site-MNIST     | Train Loss: 2.2258 | Train Acc: 0.1364
 Site-MNIST     | Train Loss: 2.1686 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.3464 | Train Acc: 0.0795
 Site-SVHN      | Train Loss: 2.3149 | Train Acc: 0.1364
 Site-USPS      | Train Loss: 2.1557 | Train Acc: 0.1250
 Site-USPS      | Train Loss: 2.1742 | Train Acc: 0.1477
 Site-SynthDigits| Train Loss: 2.2943 | Train Acc: 0.1364
 Site-SynthDigits| Train Loss: 2.2946 | Train Acc: 0.0682
 Site-MNIST-M   | Train Loss: 2.3238 | Train Acc: 0.1364
 Site-MNIST-M   | Train Loss: 2.3087 | Train Acc: 0.1136
 Site-MNIST     | Val  Loss: 2.1938 | Val  Acc: 0.1695
 Site-MNIST     | Val  Loss: 2.2060 | Val  Acc: 0.1864
 Site-SVHN      | Val  Loss: 2.3193 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.3417 | Val  Acc: 0.0508
 Site-USPS      | Val  Loss: 2.2038 | Val  Acc: 0.1186
 Site-USPS      | Val  Loss: 2.1411 | Val  Acc: 0.1525
 Site-SynthDigits| Val  Loss: 2.2771 | Val  Acc: 0.0678
 Site-SynthDigits| Val  Loss: 2.2867 | Val  Acc: 0.1186
 Site-MNIST-M   | Val  Loss: 2.2892 | Val  Acc: 0.1186
 Site-MNIST-M   | Val  Loss: 2.3236 | Val  Acc: 0.0847
Average Valid Accuracy: 0.1237
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1695
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1864
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0508
 Best site-USPS       | Epoch:0 | Val Acc: 0.1186
 Best site-USPS       | Epoch:0 | Val Acc: 0.1525
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0678
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1186
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1186
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.0847
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 1 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(8,)(1,)(1,)]
 Site-MNIST     | Train Loss: 2.1099 | Train Acc: 0.3523
 Site-MNIST     | Train Loss: 2.0435 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 2.2904 | Train Acc: 0.1023
 Site-SVHN      | Train Loss: 2.2541 | Train Acc: 0.1477
 Site-USPS      | Train Loss: 2.0394 | Train Acc: 0.3295
 Site-USPS      | Train Loss: 2.0641 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 2.2286 | Train Acc: 0.2045
 Site-SynthDigits| Train Loss: 2.2438 | Train Acc: 0.1364
 Site-MNIST-M   | Train Loss: 2.2930 | Train Acc: 0.1250
 Site-MNIST-M   | Train Loss: 2.2355 | Train Acc: 0.1364
 Site-MNIST     | Val  Loss: 2.0729 | Val  Acc: 0.3898
 Site-MNIST     | Val  Loss: 2.0569 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 2.2567 | Val  Acc: 0.1525
 Site-SVHN      | Val  Loss: 2.2753 | Val  Acc: 0.1017
 Site-USPS      | Val  Loss: 2.0937 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 2.0413 | Val  Acc: 0.2881
 Site-SynthDigits| Val  Loss: 2.2333 | Val  Acc: 0.1356
 Site-SynthDigits| Val  Loss: 2.2380 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.2331 | Val  Acc: 0.1525
 Site-MNIST-M   | Val  Loss: 2.2598 | Val  Acc: 0.1017
Average Valid Accuracy: 0.2271
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3898
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1525
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1017
 Best site-USPS       | Epoch:1 | Val Acc: 0.3220
 Best site-USPS       | Epoch:1 | Val Acc: 0.2881
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1356
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1525
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1017
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 2 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(7,)(2,)(1,)]
 Site-MNIST     | Train Loss: 2.0184 | Train Acc: 0.4432
 Site-MNIST     | Train Loss: 1.9054 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 2.2640 | Train Acc: 0.1023
 Site-SVHN      | Train Loss: 2.2001 | Train Acc: 0.2386
 Site-USPS      | Train Loss: 1.9145 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 1.9884 | Train Acc: 0.3977
 Site-SynthDigits| Train Loss: 2.1992 | Train Acc: 0.2614
 Site-SynthDigits| Train Loss: 2.1919 | Train Acc: 0.1932
 Site-MNIST-M   | Train Loss: 2.2517 | Train Acc: 0.1705
 Site-MNIST-M   | Train Loss: 2.1802 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 1.9515 | Val  Acc: 0.4237
 Site-MNIST     | Val  Loss: 1.9144 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 2.2211 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.2369 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.9883 | Val  Acc: 0.4407
 Site-USPS      | Val  Loss: 1.9475 | Val  Acc: 0.3729
 Site-SynthDigits| Val  Loss: 2.1924 | Val  Acc: 0.1695
 Site-SynthDigits| Val  Loss: 2.1835 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1858 | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: 2.2171 | Val  Acc: 0.1525
Average Valid Accuracy: 0.3017
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4237
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1864
 Best site-USPS       | Epoch:2 | Val Acc: 0.4407
 Best site-USPS       | Epoch:2 | Val Acc: 0.3729
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.1695
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2034
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 3 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(6,)(3,)(1,)]
 Site-MNIST     | Train Loss: 1.9040 | Train Acc: 0.4659
 Site-MNIST     | Train Loss: 1.7682 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 2.2470 | Train Acc: 0.1477
 Site-SVHN      | Train Loss: 2.1653 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.7986 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 1.8449 | Train Acc: 0.4659
 Site-SynthDigits| Train Loss: 2.1298 | Train Acc: 0.3068
 Site-SynthDigits| Train Loss: 2.1296 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.2103 | Train Acc: 0.1818
 Site-MNIST-M   | Train Loss: 2.1567 | Train Acc: 0.2273
 Site-MNIST     | Val  Loss: 1.8323 | Val  Acc: 0.4746
 Site-MNIST     | Val  Loss: 1.7798 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 2.1891 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.2018 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 1.8584 | Val  Acc: 0.4915
 Site-USPS      | Val  Loss: 1.8298 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 2.1376 | Val  Acc: 0.2373
 Site-SynthDigits| Val  Loss: 2.1206 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1442 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.1832 | Val  Acc: 0.1864
Average Valid Accuracy: 0.3458
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4746
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2373
 Best site-USPS       | Epoch:3 | Val Acc: 0.4915
 Best site-USPS       | Epoch:3 | Val Acc: 0.4576
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2373
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 4 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(6,)(3,)(1,)]
 Site-MNIST     | Train Loss: 1.7304 | Train Acc: 0.5909
 Site-MNIST     | Train Loss: 1.6348 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 2.2214 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.1373 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.6816 | Train Acc: 0.6591
 Site-USPS      | Train Loss: 1.7476 | Train Acc: 0.6477
 Site-SynthDigits| Train Loss: 2.0576 | Train Acc: 0.3864
 Site-SynthDigits| Train Loss: 2.0655 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 2.1538 | Train Acc: 0.2273
 Site-MNIST-M   | Train Loss: 2.1295 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 1.6915 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.6127 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 2.1707 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1700 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.7434 | Val  Acc: 0.6441
 Site-USPS      | Val  Loss: 1.7118 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 2.0783 | Val  Acc: 0.3729
 Site-SynthDigits| Val  Loss: 2.0364 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.1233 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.1663 | Val  Acc: 0.2034
Average Valid Accuracy: 0.4254
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2034
 Best site-USPS       | Epoch:4 | Val Acc: 0.6441
 Best site-USPS       | Epoch:4 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3729
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 5 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(6,)(3,)(1,)]
 Site-MNIST     | Train Loss: 1.5952 | Train Acc: 0.5909
 Site-MNIST     | Train Loss: 1.4748 | Train Acc: 0.6705
 Site-SVHN      | Train Loss: 2.1800 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.0775 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.4912 | Train Acc: 0.7045
 Site-USPS      | Train Loss: 1.5644 | Train Acc: 0.6705
 Site-SynthDigits| Train Loss: 1.9990 | Train Acc: 0.3523
 Site-SynthDigits| Train Loss: 2.0117 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 2.0984 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.0932 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 1.5469 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.4655 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 2.1297 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1349 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 1.5672 | Val  Acc: 0.6441
 Site-USPS      | Val  Loss: 1.5654 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 2.0122 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 1.9738 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.0823 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1105 | Val  Acc: 0.2034
Average Valid Accuracy: 0.4458
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2373
 Best site-USPS       | Epoch:5 | Val Acc: 0.6441
 Best site-USPS       | Epoch:5 | Val Acc: 0.7119
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 6 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(6,)(3,)(1,)]
 Site-MNIST     | Train Loss: 1.4997 | Train Acc: 0.5909
 Site-MNIST     | Train Loss: 1.3766 | Train Acc: 0.7159
 Site-SVHN      | Train Loss: 2.1409 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.0456 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.3918 | Train Acc: 0.7727
 Site-USPS      | Train Loss: 1.4492 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.9312 | Train Acc: 0.4205
 Site-SynthDigits| Train Loss: 1.9403 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 2.0565 | Train Acc: 0.2841
 Site-MNIST-M   | Train Loss: 2.0179 | Train Acc: 0.3068
 Site-MNIST     | Val  Loss: 1.4300 | Val  Acc: 0.6780
 Site-MNIST     | Val  Loss: 1.3616 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 2.0817 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.1001 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 1.4433 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 1.4403 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.9515 | Val  Acc: 0.3898
 Site-SynthDigits| Val  Loss: 1.9164 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0186 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.0499 | Val  Acc: 0.2373
Average Valid Accuracy: 0.4814
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6780
 Best site-MNIST      | Epoch:6 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2712
 Best site-USPS       | Epoch:6 | Val Acc: 0.7627
 Best site-USPS       | Epoch:6 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3898
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 7 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(6,)(3,)(1,)]
 Site-MNIST     | Train Loss: 1.4214 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.2626 | Train Acc: 0.7386
 Site-SVHN      | Train Loss: 2.1179 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.0358 | Train Acc: 0.3182
 Site-USPS      | Train Loss: 1.2711 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.3064 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 1.8253 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 1.8486 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 2.0017 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 1.9763 | Train Acc: 0.3182
 Site-MNIST     | Val  Loss: 1.3434 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.2658 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 2.0513 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0508 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 1.3136 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 1.3077 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.8699 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 1.8280 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.9722 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 1.9835 | Val  Acc: 0.3220
Average Valid Accuracy: 0.5254
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:7 | Val Acc: 0.7288
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2542
 Best site-USPS       | Epoch:7 | Val Acc: 0.8305
 Best site-USPS       | Epoch:7 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4576
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 8 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(6,)(3,)(1,)]
 Site-MNIST     | Train Loss: 1.2994 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.1947 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 2.0315 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.9787 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 1.1553 | Train Acc: 0.7955
 Site-USPS      | Train Loss: 1.2038 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.7583 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.7786 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.9306 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 1.8686 | Train Acc: 0.4318
 Site-MNIST     | Val  Loss: 1.2539 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.1657 | Val  Acc: 0.6780
 Site-SVHN      | Val  Loss: 2.0163 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0123 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.2132 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.2104 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.7886 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.7617 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.8659 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.8717 | Val  Acc: 0.4237
Average Valid Accuracy: 0.5390
 Best site-MNIST      | Epoch:8 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6780
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2881
 Best site-USPS       | Epoch:8 | Val Acc: 0.7966
 Best site-USPS       | Epoch:8 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 9 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 1.1443 | Train Acc: 0.7159
 Site-MNIST     | Train Loss: 1.0620 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 1.9928 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.9649 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 1.0705 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.1083 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 1.6812 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.6715 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.8486 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.8244 | Train Acc: 0.4659
 Site-MNIST     | Val  Loss: 1.1337 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.0318 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.9946 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.9874 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.1215 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 1.1274 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.7167 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 1.6618 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.8086 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.8154 | Val  Acc: 0.4746
Average Valid Accuracy: 0.5881
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3051
 Best site-USPS       | Epoch:9 | Val Acc: 0.8644
 Best site-USPS       | Epoch:9 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 10 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 1.0736 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 0.9603 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 1.9144 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.8785 | Train Acc: 0.3864
 Site-USPS      | Train Loss: 0.9626 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 1.0212 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.6177 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.5698 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.8077 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 1.7050 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 1.0583 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 0.9490 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.9233 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.9222 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.0172 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 1.0073 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.6253 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.5913 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.7118 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.7075 | Val  Acc: 0.5932
Average Valid Accuracy: 0.6169
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:10 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:10 | Val Acc: 0.3220
 Best site-USPS       | Epoch:10 | Val Acc: 0.8814
 Best site-USPS       | Epoch:10 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.5932
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 11 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 1.0717 | Train Acc: 0.6705
 Site-MNIST     | Train Loss: 0.9639 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 1.8948 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.7755 | Train Acc: 0.3636
 Site-USPS      | Train Loss: 0.8932 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.9359 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.5047 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 1.5338 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.7823 | Train Acc: 0.3750
 Site-MNIST-M   | Train Loss: 1.5926 | Train Acc: 0.6136
 Site-MNIST     | Val  Loss: 1.0147 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 0.9274 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 1.8380 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.8675 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.9385 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.8994 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.5546 | Val  Acc: 0.6271
 Site-SynthDigits| Val  Loss: 1.5563 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.5952 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.6322 | Val  Acc: 0.5763
Average Valid Accuracy: 0.6254
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:11 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:11 | Val Acc: 0.2881
 Best site-USPS       | Epoch:11 | Val Acc: 0.8644
 Best site-USPS       | Epoch:11 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.6271
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 12 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.9057 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 0.8166 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 1.8146 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.7871 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.8187 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.8402 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.4302 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.4420 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.6683 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.5447 | Train Acc: 0.6818
 Site-MNIST     | Val  Loss: 0.9007 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.8010 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.8309 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.8330 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 0.8360 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.8312 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.4886 | Val  Acc: 0.6271
 Site-SynthDigits| Val  Loss: 1.4555 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.5436 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.5648 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6746
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:12 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:12 | Val Acc: 0.3729
 Best site-USPS       | Epoch:12 | Val Acc: 0.8814
 Best site-USPS       | Epoch:12 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.6271
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 13 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.8342 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 0.7734 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.8514 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.6909 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.7301 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.7814 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.3524 | Train Acc: 0.6705
 Site-SynthDigits| Train Loss: 1.3060 | Train Acc: 0.7159
 Site-MNIST-M   | Train Loss: 1.6070 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.4786 | Train Acc: 0.6477
 Site-MNIST     | Val  Loss: 0.8561 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.7550 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.7690 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.7712 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.8013 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.7793 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.3563 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 1.3065 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 1.4972 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.4958 | Val  Acc: 0.6780
Average Valid Accuracy: 0.7017
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:13 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:13 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:13 | Val Acc: 0.3220
 Best site-USPS       | Epoch:13 | Val Acc: 0.9153
 Best site-USPS       | Epoch:13 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.7119
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.6780
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 14 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.8697 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 0.7429 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 1.6764 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.6415 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.6697 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.6720 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.2807 | Train Acc: 0.7159
 Site-SynthDigits| Train Loss: 1.2840 | Train Acc: 0.6932
 Site-MNIST-M   | Train Loss: 1.6011 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.3281 | Train Acc: 0.7614
 Site-MNIST     | Val  Loss: 0.8381 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.7504 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.6594 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.7526 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.7052 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.6652 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.2911 | Val  Acc: 0.6949
 Site-SynthDigits| Val  Loss: 1.2838 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 1.3495 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 1.3805 | Val  Acc: 0.7288
Average Valid Accuracy: 0.7153
 Best site-MNIST      | Epoch:14 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:14 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:14 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:14 | Val Acc: 0.3559
 Best site-USPS       | Epoch:14 | Val Acc: 0.8983
 Best site-USPS       | Epoch:14 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.6949
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.6949
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.7288
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 15 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.7271 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.6463 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 1.6381 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 1.6590 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.5875 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.6427 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 1.2666 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.2041 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 1.4660 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.2850 | Train Acc: 0.7386
 Site-MNIST     | Val  Loss: 0.7175 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.6233 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.6671 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.6795 | Val  Acc: 0.3898
 Site-USPS      | Val  Loss: 0.6408 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.6247 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.2829 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 1.2345 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.3271 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 1.3005 | Val  Acc: 0.7288
Average Valid Accuracy: 0.7339
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:15 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:15 | Val Acc: 0.3898
 Best site-USPS       | Epoch:15 | Val Acc: 0.9153
 Best site-USPS       | Epoch:15 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.7119
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.7288
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 16 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.6547 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.5808 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 1.6641 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.4856 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 0.5563 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.5713 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.1138 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.0668 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 1.4025 | Train Acc: 0.6477
 Site-MNIST-M   | Train Loss: 1.2039 | Train Acc: 0.7386
 Site-MNIST     | Val  Loss: 0.6588 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.5828 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.5642 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.6266 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.6014 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.5762 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.1368 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.0805 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 1.2571 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 1.2261 | Val  Acc: 0.7797
Average Valid Accuracy: 0.7525
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:16 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:16 | Val Acc: 0.4068
 Best site-USPS       | Epoch:16 | Val Acc: 0.9153
 Best site-USPS       | Epoch:16 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.6949
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.7797
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 17 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.6367 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.6172 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.5311 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 1.4159 | Train Acc: 0.5682
 Site-USPS      | Train Loss: 0.5134 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.5082 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.0556 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 1.0632 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 1.3591 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.0776 | Train Acc: 0.8409
 Site-MNIST     | Val  Loss: 0.6386 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.5653 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.4694 | Val  Acc: 0.6271
 Site-SVHN      | Val  Loss: 1.5606 | Val  Acc: 0.3898
 Site-USPS      | Val  Loss: 0.5348 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.5073 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.1012 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.0918 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 1.1158 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 1.1450 | Val  Acc: 0.7966
Average Valid Accuracy: 0.7661
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:17 | Val Acc: 0.6271
 Best site-SVHN       | Epoch:17 | Val Acc: 0.3898
 Best site-USPS       | Epoch:17 | Val Acc: 0.8983
 Best site-USPS       | Epoch:17 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.7797
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.7966
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 18 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.5506 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.5400 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 1.4475 | Train Acc: 0.5455
 Site-SVHN      | Train Loss: 1.3881 | Train Acc: 0.6023
 Site-USPS      | Train Loss: 0.4599 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.4572 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 1.0147 | Train Acc: 0.7614
 Site-SynthDigits| Train Loss: 1.0248 | Train Acc: 0.7841
 Site-MNIST-M   | Train Loss: 1.2740 | Train Acc: 0.7159
 Site-MNIST-M   | Train Loss: 1.0042 | Train Acc: 0.8182
 Site-MNIST     | Val  Loss: 0.5555 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.4896 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.4122 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 1.4798 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.4767 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.4617 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.0565 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.0302 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 1.0386 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 1.0440 | Val  Acc: 0.8136
Average Valid Accuracy: 0.7881
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:18 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:18 | Val Acc: 0.4746
 Best site-USPS       | Epoch:18 | Val Acc: 0.9322
 Best site-USPS       | Epoch:18 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.7458
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.8136
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 19 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.4942 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.4866 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 1.4280 | Train Acc: 0.5682
 Site-SVHN      | Train Loss: 1.3024 | Train Acc: 0.6591
 Site-USPS      | Train Loss: 0.4172 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.4393 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.9735 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.9102 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 1.1591 | Train Acc: 0.7386
 Site-MNIST-M   | Train Loss: 0.9171 | Train Acc: 0.8409
 Site-MNIST     | Val  Loss: 0.5306 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.4572 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.3241 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 1.4034 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 0.4539 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.4353 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.9628 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 0.9362 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 0.9831 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 0.9906 | Val  Acc: 0.8136
Average Valid Accuracy: 0.8119
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:19 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:19 | Val Acc: 0.5085
 Best site-USPS       | Epoch:19 | Val Acc: 0.9492
 Best site-USPS       | Epoch:19 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.7288
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.8136
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.7771
 Test site-SVHN      | Epoch:19 | Test Acc: 0.3154
 Test site-USPS      | Epoch:19 | Test Acc: 0.8441
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.5372
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.3443
Average Test Accuracy: 0.5636
============ Train epoch 20 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.4581 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.4403 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 1.2883 | Train Acc: 0.6705
 Site-SVHN      | Train Loss: 1.2320 | Train Acc: 0.6591
 Site-USPS      | Train Loss: 0.3729 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.3986 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.8900 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 0.8274 | Train Acc: 0.8295
 Site-MNIST-M   | Train Loss: 1.0748 | Train Acc: 0.7841
 Site-MNIST-M   | Train Loss: 0.8630 | Train Acc: 0.8523
 Site-MNIST     | Val  Loss: 0.4725 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4020 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.2766 | Val  Acc: 0.6780
 Site-SVHN      | Val  Loss: 1.3471 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 0.3977 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.3859 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.8743 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 0.8921 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 0.9215 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 0.8858 | Val  Acc: 0.8644
Average Valid Accuracy: 0.8220
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:20 | Val Acc: 0.6780
 Best site-SVHN       | Epoch:20 | Val Acc: 0.5763
 Best site-USPS       | Epoch:20 | Val Acc: 0.9492
 Best site-USPS       | Epoch:20 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.7288
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.8644
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 21 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.4404 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.4421 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 1.2333 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 1.1764 | Train Acc: 0.7045
 Site-USPS      | Train Loss: 0.3473 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.3491 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.7996 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 0.7611 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 1.0088 | Train Acc: 0.7841
 Site-MNIST-M   | Train Loss: 0.7999 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.4656 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4074 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.2111 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 1.2851 | Val  Acc: 0.5593
 Site-USPS      | Val  Loss: 0.3705 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.3483 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.7905 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 0.8351 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 0.8399 | Val  Acc: 0.8814
 Site-MNIST-M   | Val  Loss: 0.8367 | Val  Acc: 0.8644
Average Valid Accuracy: 0.8373
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:21 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:21 | Val Acc: 0.5593
 Best site-USPS       | Epoch:21 | Val Acc: 0.9492
 Best site-USPS       | Epoch:21 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.7288
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.8814
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.8644
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 22 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.3599 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.3441 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.1576 | Train Acc: 0.7045
 Site-SVHN      | Train Loss: 1.0844 | Train Acc: 0.6818
 Site-USPS      | Train Loss: 0.3233 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.3334 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.7572 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 0.7438 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.9169 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.7106 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.3811 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3282 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.1580 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 1.1926 | Val  Acc: 0.6271
 Site-USPS      | Val  Loss: 0.3342 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.3234 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.7487 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 0.7569 | Val  Acc: 0.7966
 Site-MNIST-M   | Val  Loss: 0.7776 | Val  Acc: 0.8983
 Site-MNIST-M   | Val  Loss: 0.7656 | Val  Acc: 0.8814
Average Valid Accuracy: 0.8559
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:22 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:22 | Val Acc: 0.6271
 Best site-USPS       | Epoch:22 | Val Acc: 0.9661
 Best site-USPS       | Epoch:22 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.7966
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.8983
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.8814
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 23 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.3280 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.3029 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.1278 | Train Acc: 0.7386
 Site-SVHN      | Train Loss: 1.0219 | Train Acc: 0.7727
 Site-USPS      | Train Loss: 0.3093 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.3126 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.7500 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.6609 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.8387 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.6886 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.3458 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2975 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.0808 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.0949 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 0.3063 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.2999 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.6864 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.7082 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.7571 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.7162 | Val  Acc: 0.8983
Average Valid Accuracy: 0.8847
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:23 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:23 | Val Acc: 0.6780
 Best site-USPS       | Epoch:23 | Val Acc: 0.9661
 Best site-USPS       | Epoch:23 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.8475
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.8983
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 24 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.2947 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2773 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.0160 | Train Acc: 0.7386
 Site-SVHN      | Train Loss: 0.9085 | Train Acc: 0.7727
 Site-USPS      | Train Loss: 0.2720 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.2729 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.6598 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 0.6427 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.7981 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.6225 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.3099 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2759 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.9772 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.0196 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 0.2840 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.2636 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.6453 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.6752 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.6961 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.6664 | Val  Acc: 0.9153
Average Valid Accuracy: 0.9000
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:24 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:24 | Val Acc: 0.7288
 Best site-USPS       | Epoch:24 | Val Acc: 0.9831
 Best site-USPS       | Epoch:24 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.8475
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.9153
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 25 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.2617 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2632 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.0112 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 0.8981 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 0.2505 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.2544 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.6449 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.5527 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.7279 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.5976 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.2798 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2456 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.9424 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 0.9642 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 0.2595 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.2442 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.5797 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.6146 | Val  Acc: 0.8983
 Site-MNIST-M   | Val  Loss: 0.6495 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.6125 | Val  Acc: 0.9322
Average Valid Accuracy: 0.9136
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:25 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:25 | Val Acc: 0.7627
 Best site-USPS       | Epoch:25 | Val Acc: 0.9831
 Best site-USPS       | Epoch:25 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.8983
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.9322
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 26 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.2472 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2432 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 0.8915 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 0.8474 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 0.2280 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.2112 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.5677 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.5496 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.7239 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.5133 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.2578 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2286 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.9049 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 0.9095 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.2196 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.2136 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.5548 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.5892 | Val  Acc: 0.8983
 Site-MNIST-M   | Val  Loss: 0.5899 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.5725 | Val  Acc: 0.9322
Average Valid Accuracy: 0.9203
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:26 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:26 | Val Acc: 0.8136
 Best site-USPS       | Epoch:26 | Val Acc: 1.0000
 Best site-USPS       | Epoch:26 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.8983
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.9322
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 27 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.2392 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2109 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 0.8554 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 0.8109 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.2132 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1982 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.5365 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.5464 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.6428 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.4809 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.2340 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2205 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.8621 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 0.8403 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.2120 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.2053 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.5377 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.5692 | Val  Acc: 0.8644
 Site-MNIST-M   | Val  Loss: 0.5488 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.5208 | Val  Acc: 0.9831
Average Valid Accuracy: 0.9322
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:27 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:27 | Val Acc: 0.8136
 Best site-USPS       | Epoch:27 | Val Acc: 1.0000
 Best site-USPS       | Epoch:27 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.8644
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.9831
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 28 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.2238 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.2039 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.8110 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 0.7640 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.2266 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1854 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.4878 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.4862 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.5845 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.4516 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.2155 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2030 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.7878 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 0.8154 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.1990 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1879 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4873 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.5268 | Val  Acc: 0.8814
 Site-MNIST-M   | Val  Loss: 0.5138 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.4807 | Val  Acc: 0.9831
Average Valid Accuracy: 0.9356
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:28 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:28 | Val Acc: 0.8136
 Best site-USPS       | Epoch:28 | Val Acc: 1.0000
 Best site-USPS       | Epoch:28 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.8814
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.9831
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 29 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.2005 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1864 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.7473 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 0.7157 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.1965 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1771 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.4589 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.4270 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.5666 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.4080 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1908 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1826 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.7655 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 0.7495 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.1741 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1731 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4418 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4658 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.4701 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.4452 | Val  Acc: 0.9831
Average Valid Accuracy: 0.9525
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:29 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:29 | Val Acc: 0.8644
 Best site-USPS       | Epoch:29 | Val Acc: 1.0000
 Best site-USPS       | Epoch:29 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.9831
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 30 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.1891 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1583 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.7504 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 0.6880 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.1885 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1510 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.4025 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.4170 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.5210 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.3798 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1765 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1667 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.7158 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 0.7265 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.1574 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1584 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4309 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.4509 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.4373 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.4154 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9492
============ Train epoch 31 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.1702 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1539 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.7395 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 0.7023 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.1837 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.1501 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.4128 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.3766 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.4995 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.3523 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1657 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1554 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6760 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 0.7364 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.1598 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1449 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.3912 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4220 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.4135 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.3951 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9678
 Best site-MNIST      | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:31 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:31 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:31 | Val Acc: 0.8983
 Best site-USPS       | Epoch:31 | Val Acc: 1.0000
 Best site-USPS       | Epoch:31 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:31 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 32 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.1534 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1467 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.6490 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 0.5988 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.1460 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1303 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.3531 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.3370 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.4629 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.3115 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1498 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1419 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.6479 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 0.6495 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.1365 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1289 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.3494 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.3778 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.3768 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.3571 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9644
============ Train epoch 33 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.1607 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1241 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.5733 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 0.5516 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.1243 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1157 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.3128 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.2974 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.4118 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.3027 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1365 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1288 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6056 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 0.5717 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.1260 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1151 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.3306 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.3465 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.3520 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.3228 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9644
============ Train epoch 34 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.1442 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1155 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.5804 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 0.5252 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.1215 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.1048 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.3249 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.3297 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.3930 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.2890 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1317 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1259 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5861 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 0.5660 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.1158 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1052 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.3446 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.3483 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.3426 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.3080 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9729
 Best site-MNIST      | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:34 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:34 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:34 | Val Acc: 0.9322
 Best site-USPS       | Epoch:34 | Val Acc: 1.0000
 Best site-USPS       | Epoch:34 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.9831
 Best site-MNIST-M    | Epoch:34 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 35 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.1407 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1135 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.5235 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 0.5528 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.1124 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0950 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.2769 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.3094 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.3716 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.2773 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1208 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1133 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5443 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 0.5449 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.1085 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0942 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.3103 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.3267 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.3195 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.2904 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9763
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:35 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:35 | Val Acc: 0.9322
 Best site-USPS       | Epoch:35 | Val Acc: 1.0000
 Best site-USPS       | Epoch:35 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.9831
 Best site-MNIST-M    | Epoch:35 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 36 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.1194 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0956 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.4951 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 0.4410 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1002 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0876 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.2809 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.2574 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.3450 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.2675 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1052 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1005 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5004 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.4593 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.1064 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0900 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.2876 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2976 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.3083 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.2650 | Val  Acc: 0.9831
Average Valid Accuracy: 0.9814
 Best site-MNIST      | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:36 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:36 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:36 | Val Acc: 0.9831
 Best site-USPS       | Epoch:36 | Val Acc: 1.0000
 Best site-USPS       | Epoch:36 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.9831
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.9831
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 37 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.1159 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0961 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.4609 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 0.4412 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1070 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0805 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.2801 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.2468 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.3226 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.2208 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1041 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0948 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.4854 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 0.4547 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0911 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0814 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.2636 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2846 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.2768 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.2461 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9814
============ Train epoch 38 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.1103 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0883 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.4604 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 0.4094 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.0951 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0801 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.2461 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.2443 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.3068 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.2098 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0987 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0901 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.4730 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 0.4398 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.0876 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0745 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.2615 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2720 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.2701 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.2335 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9797
============ Train epoch 39 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.0980 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0815 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.4414 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 0.4205 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.0888 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0831 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.2172 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.2198 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.2836 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.2018 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0870 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0838 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.4810 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 0.4360 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.0931 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0783 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2401 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2454 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.2598 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.2203 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9814
============ Train epoch 40 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.0972 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0728 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.3709 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 0.3881 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.0864 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0682 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.2288 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.2017 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.2732 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.1927 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0806 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0769 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.4288 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.3751 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0883 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0668 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.2179 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2391 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.2494 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.2059 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9847
 Best site-MNIST      | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:40 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:40 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:40 | Val Acc: 0.9831
 Best site-USPS       | Epoch:40 | Val Acc: 1.0000
 Best site-USPS       | Epoch:40 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:40 | Val Acc: 0.9831
 Best site-MNIST-M    | Epoch:40 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 41 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.0886 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0752 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.3888 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 0.3902 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.0806 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0599 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.2231 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.1946 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.2507 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1787 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0803 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0757 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.4408 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 0.3961 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0726 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0589 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.2258 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2336 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.2275 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.1916 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9831
============ Train epoch 42 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.0777 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0671 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.3351 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.3245 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.0696 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0567 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1915 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.1916 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.2329 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1765 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0702 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0659 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.3799 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.3277 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0779 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0547 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.2126 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2053 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.2250 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.1832 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9898
 Best site-MNIST      | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:42 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:42 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:42 | Val Acc: 1.0000
 Best site-USPS       | Epoch:42 | Val Acc: 1.0000
 Best site-USPS       | Epoch:42 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.9831
 Best site-MNIST-M    | Epoch:42 | Val Acc: 0.9831
 Best site-MNIST-M    | Epoch:42 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 43 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.0848 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0688 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.4209 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 0.3883 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.0745 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0582 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1956 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.1893 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.2276 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1697 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0712 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0710 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.4148 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.4178 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.0745 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0531 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.2095 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.2262 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.2199 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.1773 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9780
============ Train epoch 44 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.0629 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0580 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.3042 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.2967 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0648 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0525 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.2036 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.1588 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.2092 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1801 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0587 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0575 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.3615 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.2937 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0674 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0502 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1798 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.1993 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.2321 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.1766 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9898
============ Train epoch 45 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.0649 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0548 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.3112 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 0.2960 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.0606 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0501 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1621 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.1510 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1938 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1427 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0600 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0541 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.3291 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.3097 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0700 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0464 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1714 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.1774 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.1952 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.1509 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9898
============ Train epoch 46 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.0653 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0521 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.2795 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.2668 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0524 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0430 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1448 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1411 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1826 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1512 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0588 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0510 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.3175 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.2747 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0620 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0399 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1647 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.1614 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.1922 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.1457 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9932
 Best site-MNIST      | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:46 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:46 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:46 | Val Acc: 1.0000
 Best site-USPS       | Epoch:46 | Val Acc: 1.0000
 Best site-USPS       | Epoch:46 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:46 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:46 | Val Acc: 0.9831
 Best site-MNIST-M    | Epoch:46 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 47 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.0613 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0479 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.2593 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.2585 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0470 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0400 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1315 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1407 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1697 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1323 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0520 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0470 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.3186 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.2553 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0576 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0361 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1649 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.1525 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.1815 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.1343 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9932
============ Train epoch 48 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.0566 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0440 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.2465 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.2733 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0586 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0400 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1279 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1386 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1613 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1226 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0483 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0424 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.3073 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.2404 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0564 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0345 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1589 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.1446 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.1680 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.1250 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9932
============ Train epoch 49 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(3,)(3,)(4,)]
 Site-MNIST     | Train Loss: 0.0456 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0416 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.2307 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.2337 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0419 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0388 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1231 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1272 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1522 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1226 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0443 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0377 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.3014 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.2225 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0534 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0318 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1470 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.1326 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.1698 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.1186 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9932
===2023-04-05 02:27:11===
===2023-04-05 02:27:12===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:46 | Test Acc: 0.8664
 Test site-SVHN      | Epoch:46 | Test Acc: 0.3411
 Test site-USPS      | Epoch:46 | Test Acc: 0.8925
 Test site-SynthDigits| Epoch:46 | Test Acc: 0.6160
 Test site-MNIST-M   | Epoch:46 | Test Acc: 0.3657
Average Test Accuracy: 0.6163
===2023-04-05 13:00:52===
===2023-04-05 14:04:41===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 2.2228 | Train Acc: 0.1477
 Site-MNIST     | Train Loss: 2.1621 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.3499 | Train Acc: 0.0909
 Site-SVHN      | Train Loss: 2.3154 | Train Acc: 0.1364
 Site-USPS      | Train Loss: 2.1500 | Train Acc: 0.1250
 Site-USPS      | Train Loss: 2.1762 | Train Acc: 0.1250
 Site-SynthDigits| Train Loss: 2.2907 | Train Acc: 0.1136
 Site-SynthDigits| Train Loss: 2.2926 | Train Acc: 0.0568
 Site-MNIST-M   | Train Loss: 2.3029 | Train Acc: 0.1477
 Site-MNIST-M   | Train Loss: 2.2887 | Train Acc: 0.1136
 Site-MNIST     | Val  Loss: 2.1897 | Val  Acc: 0.1695
 Site-MNIST     | Val  Loss: 2.2096 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.3200 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.3470 | Val  Acc: 0.0508
 Site-USPS      | Val  Loss: 2.2048 | Val  Acc: 0.1017
 Site-USPS      | Val  Loss: 2.1434 | Val  Acc: 0.1525
 Site-SynthDigits| Val  Loss: 2.2800 | Val  Acc: 0.0508
 Site-SynthDigits| Val  Loss: 2.2885 | Val  Acc: 0.1017
 Site-MNIST-M   | Val  Loss: 2.2909 | Val  Acc: 0.1186
 Site-MNIST-M   | Val  Loss: 2.3304 | Val  Acc: 0.0847
Average Valid Accuracy: 0.1169
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1695
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0508
 Best site-USPS       | Epoch:0 | Val Acc: 0.1017
 Best site-USPS       | Epoch:0 | Val Acc: 0.1525
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0508
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1017
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1186
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.0847
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 1 ============
===2023-04-05 14:06:48===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 2.2228 | Train Acc: 0.1477
 Site-MNIST     | Train Loss: 2.1621 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.3499 | Train Acc: 0.0909
 Site-SVHN      | Train Loss: 2.3154 | Train Acc: 0.1364
 Site-USPS      | Train Loss: 2.1500 | Train Acc: 0.1250
 Site-USPS      | Train Loss: 2.1762 | Train Acc: 0.1250
 Site-SynthDigits| Train Loss: 2.2907 | Train Acc: 0.1136
 Site-SynthDigits| Train Loss: 2.2926 | Train Acc: 0.0568
 Site-MNIST-M   | Train Loss: 2.3029 | Train Acc: 0.1477
 Site-MNIST-M   | Train Loss: 2.2887 | Train Acc: 0.1136
 Site-MNIST     | Val  Loss: 2.1897 | Val  Acc: 0.1695
 Site-MNIST     | Val  Loss: 2.2096 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.3200 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.3470 | Val  Acc: 0.0508
 Site-USPS      | Val  Loss: 2.2048 | Val  Acc: 0.1017
 Site-USPS      | Val  Loss: 2.1434 | Val  Acc: 0.1525
 Site-SynthDigits| Val  Loss: 2.2800 | Val  Acc: 0.0508
 Site-SynthDigits| Val  Loss: 2.2885 | Val  Acc: 0.1017
 Site-MNIST-M   | Val  Loss: 2.2909 | Val  Acc: 0.1186
 Site-MNIST-M   | Val  Loss: 2.3304 | Val  Acc: 0.0847
Average Valid Accuracy: 0.1169
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1695
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0508
 Best site-USPS       | Epoch:0 | Val Acc: 0.1017
 Best site-USPS       | Epoch:0 | Val Acc: 0.1525
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0508
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1017
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1186
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.0847
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 1 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 2.1409 | Train Acc: 0.3182
 Site-MNIST     | Train Loss: 2.0608 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 2.2755 | Train Acc: 0.0795
 Site-SVHN      | Train Loss: 2.2671 | Train Acc: 0.1591
 Site-USPS      | Train Loss: 2.0400 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 2.0863 | Train Acc: 0.3068
 Site-SynthDigits| Train Loss: 2.2528 | Train Acc: 0.1705
 Site-SynthDigits| Train Loss: 2.2324 | Train Acc: 0.1591
 Site-MNIST-M   | Train Loss: 2.2846 | Train Acc: 0.1136
 Site-MNIST-M   | Train Loss: 2.2575 | Train Acc: 0.1591
 Site-MNIST     | Val  Loss: 2.0858 | Val  Acc: 0.3559
 Site-MNIST     | Val  Loss: 2.0823 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 2.2581 | Val  Acc: 0.1864
 Site-SVHN      | Val  Loss: 2.2966 | Val  Acc: 0.0678
 Site-USPS      | Val  Loss: 2.0952 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 2.0574 | Val  Acc: 0.3051
 Site-SynthDigits| Val  Loss: 2.2377 | Val  Acc: 0.1695
 Site-SynthDigits| Val  Loss: 2.2523 | Val  Acc: 0.1864
 Site-MNIST-M   | Val  Loss: 2.2354 | Val  Acc: 0.1525
 Site-MNIST-M   | Val  Loss: 2.2695 | Val  Acc: 0.1186
Average Valid Accuracy: 0.2186
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3559
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1864
 Best site-SVHN       | Epoch:1 | Val Acc: 0.0678
 Best site-USPS       | Epoch:1 | Val Acc: 0.2881
 Best site-USPS       | Epoch:1 | Val Acc: 0.3051
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1695
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1864
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1525
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1186
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 2 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 2.0453 | Train Acc: 0.3750
 Site-MNIST     | Train Loss: 1.9341 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 2.2265 | Train Acc: 0.1705
 Site-SVHN      | Train Loss: 2.2316 | Train Acc: 0.2386
 Site-USPS      | Train Loss: 1.9399 | Train Acc: 0.3977
 Site-USPS      | Train Loss: 1.9780 | Train Acc: 0.3977
 Site-SynthDigits| Train Loss: 2.2087 | Train Acc: 0.2045
 Site-SynthDigits| Train Loss: 2.2158 | Train Acc: 0.1932
 Site-MNIST-M   | Train Loss: 2.2436 | Train Acc: 0.1477
 Site-MNIST-M   | Train Loss: 2.2163 | Train Acc: 0.1932
 Site-MNIST     | Val  Loss: 1.9954 | Val  Acc: 0.4237
 Site-MNIST     | Val  Loss: 1.9766 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 2.2264 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2629 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 2.0118 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 1.9701 | Val  Acc: 0.3390
 Site-SynthDigits| Val  Loss: 2.2080 | Val  Acc: 0.1695
 Site-SynthDigits| Val  Loss: 2.2145 | Val  Acc: 0.2712
 Site-MNIST-M   | Val  Loss: 2.2067 | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: 2.2313 | Val  Acc: 0.1525
Average Valid Accuracy: 0.2831
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4237
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1695
 Best site-USPS       | Epoch:2 | Val Acc: 0.4068
 Best site-USPS       | Epoch:2 | Val Acc: 0.3390
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.1695
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2712
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2034
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 3 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 1.9516 | Train Acc: 0.4886
 Site-MNIST     | Train Loss: 1.8619 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 2.2201 | Train Acc: 0.1591
 Site-SVHN      | Train Loss: 2.2121 | Train Acc: 0.2045
 Site-USPS      | Train Loss: 1.8323 | Train Acc: 0.4659
 Site-USPS      | Train Loss: 1.9035 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 2.1726 | Train Acc: 0.2500
 Site-SynthDigits| Train Loss: 2.1617 | Train Acc: 0.2159
 Site-MNIST-M   | Train Loss: 2.2186 | Train Acc: 0.1705
 Site-MNIST-M   | Train Loss: 2.1771 | Train Acc: 0.2045
 Site-MNIST     | Val  Loss: 1.9081 | Val  Acc: 0.4746
 Site-MNIST     | Val  Loss: 1.8707 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 2.2025 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.2374 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.9224 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 1.8779 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 2.1711 | Val  Acc: 0.1864
 Site-SynthDigits| Val  Loss: 2.1657 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.1710 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.1947 | Val  Acc: 0.1695
Average Valid Accuracy: 0.3169
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4746
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1695
 Best site-USPS       | Epoch:3 | Val Acc: 0.5085
 Best site-USPS       | Epoch:3 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.1864
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 4 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
clients=[(4,)(4,)(2,)]
 Site-MNIST     | Train Loss: 1.8593 | Train Acc: 0.5000
 Site-MNIST     | Train Loss: 1.7724 | Train Acc: 0.5455
 Site-SVHN      | Train Loss: 2.1946 | Train Acc: 0.1591
 Site-SVHN      | Train Loss: 2.1720 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 1.7611 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 1.8098 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.1409 | Train Acc: 0.2841
 Site-SynthDigits| Train Loss: 2.1154 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.2024 | Train Acc: 0.1591
 Site-MNIST-M   | Train Loss: 2.1358 | Train Acc: 0.2159
 Site-MNIST     | Val  Loss: 1.8203 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.7714 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 2.1819 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2147 | Val  Acc: 0.1525
 Site-USPS      | Val  Loss: 1.8381 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 1.7962 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 2.1334 | Val  Acc: 0.2203
 Site-SynthDigits| Val  Loss: 2.1283 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1370 | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: 2.1573 | Val  Acc: 0.1864
Average Valid Accuracy: 0.3407
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1525
 Best site-USPS       | Epoch:4 | Val Acc: 0.5085
 Best site-USPS       | Epoch:4 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2203
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2034
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 5 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
clients=[(4,)(2,)(4,)]
 Site-MNIST     | Train Loss: 1.7678 | Train Acc: 0.5227
 Site-MNIST     | Train Loss: 1.6964 | Train Acc: 0.5795
 Site-SVHN      | Train Loss: 2.1752 | Train Acc: 0.1705
 Site-SVHN      | Train Loss: 2.1572 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.6740 | Train Acc: 0.5568
 Site-USPS      | Train Loss: 1.7259 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 2.1004 | Train Acc: 0.2841
 Site-SynthDigits| Train Loss: 2.0556 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 2.1654 | Train Acc: 0.1818
 Site-MNIST-M   | Train Loss: 2.1251 | Train Acc: 0.2159
 Site-MNIST     | Val  Loss: 1.7429 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.6797 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 2.1557 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.1892 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.7611 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 1.7105 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 2.0901 | Val  Acc: 0.2881
 Site-SynthDigits| Val  Loss: 2.0824 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.1114 | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: 2.1312 | Val  Acc: 0.1864
Average Valid Accuracy: 0.3729
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1695
 Best site-USPS       | Epoch:5 | Val Acc: 0.5763
 Best site-USPS       | Epoch:5 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.2881
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2034
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 6 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
clients=[(4,)(2,)(4,)]
 Site-MNIST     | Train Loss: 1.6960 | Train Acc: 0.5227
 Site-MNIST     | Train Loss: 1.6397 | Train Acc: 0.5909
 Site-SVHN      | Train Loss: 2.1455 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.1297 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.6047 | Train Acc: 0.6591
 Site-USPS      | Train Loss: 1.6522 | Train Acc: 0.6023
 Site-SynthDigits| Train Loss: 2.0528 | Train Acc: 0.2841
 Site-SynthDigits| Train Loss: 2.0346 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 2.1484 | Train Acc: 0.2159
 Site-MNIST-M   | Train Loss: 2.0870 | Train Acc: 0.2273
 Site-MNIST     | Val  Loss: 1.6771 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.6032 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 2.1397 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.1741 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.6827 | Val  Acc: 0.6102
 Site-USPS      | Val  Loss: 1.6313 | Val  Acc: 0.5932
 Site-SynthDigits| Val  Loss: 2.0552 | Val  Acc: 0.3390
 Site-SynthDigits| Val  Loss: 2.0321 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.0811 | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: 2.1033 | Val  Acc: 0.2373
Average Valid Accuracy: 0.3898
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:6 | Val Acc: 0.1695
 Best site-USPS       | Epoch:6 | Val Acc: 0.6102
 Best site-USPS       | Epoch:6 | Val Acc: 0.5932
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3390
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.2034
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 7 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.6224 | Train Acc: 0.5455
 Site-MNIST     | Train Loss: 1.5691 | Train Acc: 0.6477
 Site-SVHN      | Train Loss: 2.1399 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.1293 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.5224 | Train Acc: 0.7159
 Site-USPS      | Train Loss: 1.5837 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 2.0233 | Train Acc: 0.3068
 Site-SynthDigits| Train Loss: 1.9825 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 2.1227 | Train Acc: 0.2273
 Site-MNIST-M   | Train Loss: 2.0605 | Train Acc: 0.2386
 Site-MNIST     | Val  Loss: 1.6207 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.5417 | Val  Acc: 0.6780
 Site-SVHN      | Val  Loss: 2.1327 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1670 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.6112 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 1.5519 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 2.0195 | Val  Acc: 0.3729
 Site-SynthDigits| Val  Loss: 1.9970 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.0667 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.0901 | Val  Acc: 0.2373
Average Valid Accuracy: 0.4220
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6780
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:7 | Val Acc: 0.1695
 Best site-USPS       | Epoch:7 | Val Acc: 0.7288
 Best site-USPS       | Epoch:7 | Val Acc: 0.6102
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.3729
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 8 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.6028 | Train Acc: 0.5682
 Site-MNIST     | Train Loss: 1.5358 | Train Acc: 0.6705
 Site-SVHN      | Train Loss: 2.1371 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.1311 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.4586 | Train Acc: 0.6818
 Site-USPS      | Train Loss: 1.5360 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 1.9959 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 1.9671 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 2.1200 | Train Acc: 0.2159
 Site-MNIST-M   | Train Loss: 2.0279 | Train Acc: 0.2614
 Site-MNIST     | Val  Loss: 1.5670 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.4934 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 2.1201 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.1556 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.5663 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 1.5029 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.9994 | Val  Acc: 0.3729
 Site-SynthDigits| Val  Loss: 1.9585 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0429 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.0696 | Val  Acc: 0.2373
Average Valid Accuracy: 0.4254
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:8 | Val Acc: 0.1695
 Best site-USPS       | Epoch:8 | Val Acc: 0.6610
 Best site-USPS       | Epoch:8 | Val Acc: 0.6102
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.3729
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 9 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.5546 | Train Acc: 0.5682
 Site-MNIST     | Train Loss: 1.4627 | Train Acc: 0.7045
 Site-SVHN      | Train Loss: 2.1410 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.1017 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.4087 | Train Acc: 0.7500
 Site-USPS      | Train Loss: 1.4728 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.9487 | Train Acc: 0.3295
 Site-SynthDigits| Train Loss: 1.9469 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 2.0824 | Train Acc: 0.2273
 Site-MNIST-M   | Train Loss: 2.0110 | Train Acc: 0.2955
 Site-MNIST     | Val  Loss: 1.5079 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.4294 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 2.1130 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1431 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.5106 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 1.4460 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 1.9674 | Val  Acc: 0.3729
 Site-SynthDigits| Val  Loss: 1.9283 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0177 | Val  Acc: 0.2712
 Site-MNIST-M   | Val  Loss: 2.0506 | Val  Acc: 0.2542
Average Valid Accuracy: 0.4542
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7288
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:9 | Val Acc: 0.1695
 Best site-USPS       | Epoch:9 | Val Acc: 0.7288
 Best site-USPS       | Epoch:9 | Val Acc: 0.7119
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.3729
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.2712
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.2542
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 10 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.4696 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.4134 | Train Acc: 0.7386
 Site-SVHN      | Train Loss: 2.1136 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.0972 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.3716 | Train Acc: 0.7614
 Site-USPS      | Train Loss: 1.4401 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.9410 | Train Acc: 0.3636
 Site-SynthDigits| Train Loss: 1.8897 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 2.0590 | Train Acc: 0.2386
 Site-MNIST-M   | Train Loss: 1.9955 | Train Acc: 0.3068
 Site-MNIST     | Val  Loss: 1.4520 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.3697 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.0990 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.1306 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.4688 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 1.3975 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.9442 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 1.8986 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 1.9947 | Val  Acc: 0.2712
 Site-MNIST-M   | Val  Loss: 2.0247 | Val  Acc: 0.2712
Average Valid Accuracy: 0.4763
 Best site-MNIST      | Epoch:10 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:10 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:10 | Val Acc: 0.1695
 Best site-USPS       | Epoch:10 | Val Acc: 0.7627
 Best site-USPS       | Epoch:10 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.2712
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.2712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 11 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.4236 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.3357 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 2.1110 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.0694 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.3217 | Train Acc: 0.7841
 Site-USPS      | Train Loss: 1.3694 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 1.8974 | Train Acc: 0.3636
 Site-SynthDigits| Train Loss: 1.8696 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 2.0434 | Train Acc: 0.2386
 Site-MNIST-M   | Train Loss: 1.9658 | Train Acc: 0.3182
 Site-MNIST     | Val  Loss: 1.3983 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.3091 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.0914 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.1145 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.4028 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 1.3365 | Val  Acc: 0.7627
 Site-SynthDigits| Val  Loss: 1.9056 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.8632 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.9679 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 1.9996 | Val  Acc: 0.2881
Average Valid Accuracy: 0.4966
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:11 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:11 | Val Acc: 0.1695
 Best site-USPS       | Epoch:11 | Val Acc: 0.7797
 Best site-USPS       | Epoch:11 | Val Acc: 0.7627
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.2881
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 12 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.3450 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.3015 | Train Acc: 0.7614
 Site-SVHN      | Train Loss: 2.1193 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.0496 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.2628 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.3427 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.8687 | Train Acc: 0.3864
 Site-SynthDigits| Train Loss: 1.8462 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 2.0098 | Train Acc: 0.2386
 Site-MNIST-M   | Train Loss: 1.9520 | Train Acc: 0.3295
 Site-MNIST     | Val  Loss: 1.3494 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.2555 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 2.0805 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.0986 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.3531 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 1.2863 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.8820 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.8287 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.9405 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 1.9728 | Val  Acc: 0.2881
Average Valid Accuracy: 0.5119
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:12 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:12 | Val Acc: 0.1695
 Best site-USPS       | Epoch:12 | Val Acc: 0.8136
 Best site-USPS       | Epoch:12 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.2881
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 13 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.3352 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.2177 | Train Acc: 0.7614
 Site-SVHN      | Train Loss: 2.0789 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.0419 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.2235 | Train Acc: 0.8068
 Site-USPS      | Train Loss: 1.2977 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.8787 | Train Acc: 0.3977
 Site-SynthDigits| Train Loss: 1.8182 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.9939 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 1.9069 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 1.3087 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.2130 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 2.0690 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0919 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.3077 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.2473 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.8592 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.8016 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.9166 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 1.9503 | Val  Acc: 0.3051
Average Valid Accuracy: 0.5186
 Best site-MNIST      | Epoch:13 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:13 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:13 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:13 | Val Acc: 0.1695
 Best site-USPS       | Epoch:13 | Val Acc: 0.7966
 Best site-USPS       | Epoch:13 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 14 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.3042 | Train Acc: 0.6591
 Site-MNIST     | Train Loss: 1.2226 | Train Acc: 0.7614
 Site-SVHN      | Train Loss: 2.0643 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.0313 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.1836 | Train Acc: 0.8068
 Site-USPS      | Train Loss: 1.2393 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.8078 | Train Acc: 0.4205
 Site-SynthDigits| Train Loss: 1.7930 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.9893 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 1.8882 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 1.2727 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.1717 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 2.0638 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0776 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.2601 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 1.2019 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.8369 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.7754 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.8930 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 1.9273 | Val  Acc: 0.3220
Average Valid Accuracy: 0.5237
 Best site-MNIST      | Epoch:14 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:14 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:14 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:14 | Val Acc: 0.1864
 Best site-USPS       | Epoch:14 | Val Acc: 0.8305
 Best site-USPS       | Epoch:14 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 15 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.2144 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 1.1609 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 2.0663 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.0364 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.1520 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.1832 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.8135 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 1.7684 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.9548 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.8588 | Train Acc: 0.3864
 Site-MNIST     | Val  Loss: 1.2338 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.1267 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.0510 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0675 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.2203 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 1.1587 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.8132 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.7507 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.8716 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 1.9049 | Val  Acc: 0.3559
Average Valid Accuracy: 0.5339
 Best site-MNIST      | Epoch:15 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:15 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:15 | Val Acc: 0.1864
 Best site-USPS       | Epoch:15 | Val Acc: 0.8305
 Best site-USPS       | Epoch:15 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 16 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.1901 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 1.1220 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.0566 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.0301 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 1.1111 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.1303 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.8076 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 1.7300 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.9531 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.8264 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.2019 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.0918 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.0450 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 2.0633 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.1782 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 1.1226 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.7956 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.7290 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.8509 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 1.8827 | Val  Acc: 0.3559
Average Valid Accuracy: 0.5424
 Best site-MNIST      | Epoch:16 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:16 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:16 | Val Acc: 0.1864
 Best site-USPS       | Epoch:16 | Val Acc: 0.8305
 Best site-USPS       | Epoch:16 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 17 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.1876 | Train Acc: 0.7159
 Site-MNIST     | Train Loss: 1.0650 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.0634 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.0263 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 1.0904 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.1274 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.7641 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.7351 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.9389 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 1.8114 | Train Acc: 0.3977
 Site-MNIST     | Val  Loss: 1.1674 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.0566 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.0341 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 2.0524 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.1428 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 1.0910 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.7723 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 1.7065 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.8304 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 1.8624 | Val  Acc: 0.3390
Average Valid Accuracy: 0.5407
============ Train epoch 18 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.1407 | Train Acc: 0.7159
 Site-MNIST     | Train Loss: 1.0916 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.0459 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 1.9899 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.0405 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.0785 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.7312 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 1.7050 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.9471 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.8097 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 1.1395 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.0260 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.0294 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0385 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.1100 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 1.0547 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.7602 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 1.6812 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.8109 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 1.8418 | Val  Acc: 0.3559
Average Valid Accuracy: 0.5441
 Best site-MNIST      | Epoch:18 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:18 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:18 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:18 | Val Acc: 0.1864
 Best site-USPS       | Epoch:18 | Val Acc: 0.8305
 Best site-USPS       | Epoch:18 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.4576
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 19 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.1193 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 1.0188 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.0504 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.0066 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.0319 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 1.0541 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.7482 | Train Acc: 0.4659
 Site-SynthDigits| Train Loss: 1.7167 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.9113 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.7825 | Train Acc: 0.4205
 Site-MNIST     | Val  Loss: 1.1151 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.0053 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.0195 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0364 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.0857 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 1.0331 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.7504 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.6732 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.8022 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 1.8284 | Val  Acc: 0.3729
Average Valid Accuracy: 0.5542
 Best site-MNIST      | Epoch:19 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:19 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:19 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:19 | Val Acc: 0.1864
 Best site-USPS       | Epoch:19 | Val Acc: 0.8305
 Best site-USPS       | Epoch:19 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.7043
 Test site-SVHN      | Epoch:19 | Test Acc: 0.2761
 Test site-USPS      | Epoch:19 | Test Acc: 0.8118
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.4059
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.3100
Average Test Accuracy: 0.5016
============ Train epoch 20 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.0764 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.0049 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 2.0201 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 1.9991 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 0.9850 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 1.0117 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.7185 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 1.6531 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.8936 | Train Acc: 0.3295
 Site-MNIST-M   | Train Loss: 1.7624 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 1.0889 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 0.9712 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.0171 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 2.0187 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.0478 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.9901 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.7215 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.6405 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.7711 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 1.8070 | Val  Acc: 0.3898
Average Valid Accuracy: 0.5576
 Best site-MNIST      | Epoch:20 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:20 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:20 | Val Acc: 0.2034
 Best site-USPS       | Epoch:20 | Val Acc: 0.8305
 Best site-USPS       | Epoch:20 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 21 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.0280 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 0.9927 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 2.0328 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 1.9737 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 0.9612 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.9913 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.6959 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 1.6663 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.9067 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 1.7756 | Train Acc: 0.4318
 Site-MNIST     | Val  Loss: 1.0641 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 0.9453 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.0072 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0120 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.0242 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.9668 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.7128 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.6249 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.7563 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 1.7900 | Val  Acc: 0.4237
Average Valid Accuracy: 0.5678
 Best site-MNIST      | Epoch:21 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:21 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:21 | Val Acc: 0.2034
 Best site-USPS       | Epoch:21 | Val Acc: 0.8644
 Best site-USPS       | Epoch:21 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 22 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 1.0363 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 0.9853 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 2.0092 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 1.9637 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 0.9326 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.9615 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.7027 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 1.6297 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.8565 | Train Acc: 0.3750
 Site-MNIST-M   | Train Loss: 1.7150 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 1.0404 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.9203 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.9976 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0013 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.0026 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.9463 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.7014 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 1.6132 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.7408 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.7734 | Val  Acc: 0.4576
Average Valid Accuracy: 0.5780
 Best site-MNIST      | Epoch:22 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:22 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:22 | Val Acc: 0.1864
 Best site-USPS       | Epoch:22 | Val Acc: 0.8814
 Best site-USPS       | Epoch:22 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.4576
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 23 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.9761 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 0.9736 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 1.9869 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 1.9776 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 0.8895 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.9632 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.6443 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 1.6352 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.8445 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 1.7159 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 1.0154 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.8944 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.9904 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0014 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 0.9786 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.9255 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.6857 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.6016 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.7266 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.7530 | Val  Acc: 0.4576
Average Valid Accuracy: 0.5864
 Best site-MNIST      | Epoch:23 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:23 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:23 | Val Acc: 0.2203
 Best site-USPS       | Epoch:23 | Val Acc: 0.8814
 Best site-USPS       | Epoch:23 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 24 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.9655 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 0.9372 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 2.0030 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 1.9481 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 0.8803 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.9385 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.6420 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.6001 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.8335 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 1.7082 | Train Acc: 0.4886
 Site-MNIST     | Val  Loss: 0.9972 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.8702 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.9849 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.9930 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 0.9574 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.9025 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.6688 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 1.5821 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.7092 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.7325 | Val  Acc: 0.4746
Average Valid Accuracy: 0.5881
 Best site-MNIST      | Epoch:24 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:24 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:24 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:24 | Val Acc: 0.1864
 Best site-USPS       | Epoch:24 | Val Acc: 0.8814
 Best site-USPS       | Epoch:24 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 25 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.9314 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 0.8961 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 2.0191 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 1.8957 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 0.8732 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.9258 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.6430 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 1.6185 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.8095 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.6560 | Train Acc: 0.5114
 Site-MNIST     | Val  Loss: 0.9751 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.8482 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.9768 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.9784 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 0.9312 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.8797 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.6482 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.5639 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.6814 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.7123 | Val  Acc: 0.5424
Average Valid Accuracy: 0.5983
 Best site-MNIST      | Epoch:25 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:25 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:25 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:25 | Val Acc: 0.2203
 Best site-USPS       | Epoch:25 | Val Acc: 0.8814
 Best site-USPS       | Epoch:25 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 26 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.9380 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 0.8930 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 2.0081 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.9304 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 0.8430 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.8972 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.6500 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 1.5626 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.8010 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.6333 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 0.9577 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.8299 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.9715 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.9716 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.9146 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.8650 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.6373 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.5511 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.6696 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.6979 | Val  Acc: 0.5424
Average Valid Accuracy: 0.6017
 Best site-MNIST      | Epoch:26 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:26 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:26 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:26 | Val Acc: 0.2373
 Best site-USPS       | Epoch:26 | Val Acc: 0.8814
 Best site-USPS       | Epoch:26 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 27 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.9111 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 0.8700 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 1.9907 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 1.9553 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 0.8104 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.8652 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.6295 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 1.5330 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.7718 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.6297 | Train Acc: 0.5568
 Site-MNIST     | Val  Loss: 0.9359 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.8053 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.9692 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.9588 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.8928 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.8403 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.6123 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 1.5318 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.6538 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.6817 | Val  Acc: 0.6102
Average Valid Accuracy: 0.6136
 Best site-MNIST      | Epoch:27 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:27 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:27 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:27 | Val Acc: 0.2373
 Best site-USPS       | Epoch:27 | Val Acc: 0.8814
 Best site-USPS       | Epoch:27 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 28 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.9089 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 0.8399 | Train Acc: 0.8295
 Site-SVHN      | Train Loss: 1.9876 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 1.9258 | Train Acc: 0.3182
 Site-USPS      | Train Loss: 0.8307 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.8631 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.6142 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 1.5554 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.7463 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.6077 | Train Acc: 0.5568
 Site-MNIST     | Val  Loss: 0.9146 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.7859 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.9599 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.9519 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.8816 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.8291 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.5995 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.5265 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.6374 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.6686 | Val  Acc: 0.5763
Average Valid Accuracy: 0.6169
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:28 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:28 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:28 | Val Acc: 0.2373
 Best site-USPS       | Epoch:28 | Val Acc: 0.8814
 Best site-USPS       | Epoch:28 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 29 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.8569 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 0.8228 | Train Acc: 0.8295
 Site-SVHN      | Train Loss: 1.9906 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.9027 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 0.8018 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.8296 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.6025 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 1.5398 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.7289 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.5861 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.9018 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.7685 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.9563 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.9478 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.8639 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.8081 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.5903 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.5148 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.6211 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.6526 | Val  Acc: 0.5763
Average Valid Accuracy: 0.6169
============ Train epoch 30 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.8510 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 0.8056 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 1.9725 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 1.8968 | Train Acc: 0.3295
 Site-USPS      | Train Loss: 0.8236 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.8226 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.5781 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 1.5515 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.7491 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.6074 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.8865 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.7554 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.9446 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.9472 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 0.8510 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.7979 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.5773 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.5030 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.6168 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.6395 | Val  Acc: 0.5763
Average Valid Accuracy: 0.6186
 Best site-MNIST      | Epoch:30 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:30 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:30 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:30 | Val Acc: 0.2203
 Best site-USPS       | Epoch:30 | Val Acc: 0.8814
 Best site-USPS       | Epoch:30 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 31 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.8636 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 0.8323 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 1.9574 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 1.8505 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 0.7679 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.8382 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.5922 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.5198 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.7297 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.5655 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.8746 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.7418 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.9410 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.9320 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 0.8335 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.7762 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.5623 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 1.4866 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.5926 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.6227 | Val  Acc: 0.5932
Average Valid Accuracy: 0.6220
 Best site-MNIST      | Epoch:31 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:31 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:31 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:31 | Val Acc: 0.2203
 Best site-USPS       | Epoch:31 | Val Acc: 0.8983
 Best site-USPS       | Epoch:31 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.5932
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 32 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.8373 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 0.7836 | Train Acc: 0.8295
 Site-SVHN      | Train Loss: 1.9486 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 1.8750 | Train Acc: 0.3295
 Site-USPS      | Train Loss: 0.7428 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.8181 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.5542 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.5167 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.7023 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.5580 | Train Acc: 0.5568
 Site-MNIST     | Val  Loss: 0.8558 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.7286 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.9334 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.9351 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 0.8261 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.7763 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.5522 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.4851 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.5866 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.6095 | Val  Acc: 0.5932
Average Valid Accuracy: 0.6169
============ Train epoch 33 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.8117 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 0.7841 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.9521 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.9024 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 0.7498 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.7811 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.5102 | Train Acc: 0.5114
 Site-SynthDigits| Train Loss: 1.4895 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.7159 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 1.5603 | Train Acc: 0.5682
 Site-MNIST     | Val  Loss: 0.8410 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.7106 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.9261 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.9187 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.8053 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.7535 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.5368 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.4684 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.5630 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.5947 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6339
 Best site-MNIST      | Epoch:33 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:33 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:33 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:33 | Val Acc: 0.2373
 Best site-USPS       | Epoch:33 | Val Acc: 0.9153
 Best site-USPS       | Epoch:33 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 34 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.7894 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 0.7618 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.9925 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.8752 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 0.7509 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.7580 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.5501 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 1.4710 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.6891 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.5261 | Train Acc: 0.5682
 Site-MNIST     | Val  Loss: 0.8276 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6997 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.9238 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.9156 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.7899 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.7373 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.5168 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.4514 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.5494 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.5772 | Val  Acc: 0.6102
Average Valid Accuracy: 0.6288
============ Train epoch 35 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.7969 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.7533 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.9567 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.8967 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 0.7430 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.7552 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.5130 | Train Acc: 0.5114
 Site-SynthDigits| Train Loss: 1.4514 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.6895 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.5107 | Train Acc: 0.5795
 Site-MNIST     | Val  Loss: 0.8214 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6894 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.9174 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.9057 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.7812 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.7302 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.5120 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.4452 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.5330 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.5642 | Val  Acc: 0.6102
Average Valid Accuracy: 0.6356
 Best site-MNIST      | Epoch:35 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:35 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:35 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:35 | Val Acc: 0.2373
 Best site-USPS       | Epoch:35 | Val Acc: 0.9153
 Best site-USPS       | Epoch:35 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 36 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.7534 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.7246 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 2.0058 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.8794 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 0.7262 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.7361 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.5419 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.4195 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.6846 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.4975 | Train Acc: 0.5795
 Site-MNIST     | Val  Loss: 0.8096 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6742 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.9154 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8954 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.7592 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.7037 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.4863 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.4236 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.5206 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.5513 | Val  Acc: 0.6102
Average Valid Accuracy: 0.6390
 Best site-MNIST      | Epoch:36 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:36 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:36 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:36 | Val Acc: 0.2373
 Best site-USPS       | Epoch:36 | Val Acc: 0.8983
 Best site-USPS       | Epoch:36 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 37 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.7572 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.7368 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.9530 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.8602 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 0.7422 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.7437 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.5239 | Train Acc: 0.5114
 Site-SynthDigits| Train Loss: 1.4500 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.6264 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.4586 | Train Acc: 0.5795
 Site-MNIST     | Val  Loss: 0.8010 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6659 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.9138 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8956 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.7612 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.7100 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.4866 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.4299 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.5161 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.5389 | Val  Acc: 0.5932
Average Valid Accuracy: 0.6373
============ Train epoch 38 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.7274 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.7209 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.9224 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.8490 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 0.7082 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.7406 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.4856 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.4052 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.6602 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.4902 | Train Acc: 0.6023
 Site-MNIST     | Val  Loss: 0.7859 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6493 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.9131 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8855 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.7430 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.6889 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.4785 | Val  Acc: 0.5593
 Site-SynthDigits| Val  Loss: 1.4145 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.5031 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.5256 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6492
 Best site-MNIST      | Epoch:38 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:38 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:38 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:38 | Val Acc: 0.2542
 Best site-USPS       | Epoch:38 | Val Acc: 0.9153
 Best site-USPS       | Epoch:38 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.5593
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 39 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.7363 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.7047 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.9061 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.8750 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 0.7191 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.7285 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.5186 | Train Acc: 0.5114
 Site-SynthDigits| Train Loss: 1.4035 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.6556 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.4623 | Train Acc: 0.6023
 Site-MNIST     | Val  Loss: 0.7734 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6392 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.9035 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8867 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.7470 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.6910 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.4832 | Val  Acc: 0.5593
 Site-SynthDigits| Val  Loss: 1.4217 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.4985 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.5207 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6424
============ Train epoch 40 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.7352 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.6992 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.9649 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.8469 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 0.6747 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.7253 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.4688 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.4423 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.6359 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.4597 | Train Acc: 0.6023
 Site-MNIST     | Val  Loss: 0.7683 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6346 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.8992 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8784 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.7307 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.6737 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.4725 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 1.4072 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.4798 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.5071 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6475
============ Train epoch 41 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.7172 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.6727 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.9259 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.8413 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 0.6914 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.7284 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.5071 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 1.4339 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.6304 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 1.4492 | Train Acc: 0.6250
 Site-MNIST     | Val  Loss: 0.7541 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6241 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.8943 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8794 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.7448 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.6878 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.4746 | Val  Acc: 0.5932
 Site-SynthDigits| Val  Loss: 1.4141 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.4832 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.4963 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6525
 Best site-MNIST      | Epoch:41 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:41 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:41 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:41 | Val Acc: 0.2712
 Best site-USPS       | Epoch:41 | Val Acc: 0.8983
 Best site-USPS       | Epoch:41 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.5932
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:41 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:41 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 42 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.7046 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.6744 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.9615 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.8019 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 0.6640 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.6723 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.4672 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 1.3828 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.6216 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.4398 | Train Acc: 0.6250
 Site-MNIST     | Val  Loss: 0.7459 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6103 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.8948 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8577 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.7002 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.6338 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.4347 | Val  Acc: 0.5932
 Site-SynthDigits| Val  Loss: 1.3805 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.4562 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.4796 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6576
 Best site-MNIST      | Epoch:42 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:42 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:42 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:42 | Val Acc: 0.2542
 Best site-USPS       | Epoch:42 | Val Acc: 0.8814
 Best site-USPS       | Epoch:42 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.5932
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:42 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:42 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 43 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.6848 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.7074 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.9523 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.8210 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 0.6446 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.7026 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.4201 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.3907 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.5987 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 1.4225 | Train Acc: 0.6136
 Site-MNIST     | Val  Loss: 0.7435 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6033 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.8941 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8572 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.6967 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.6328 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.4282 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.3729 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.4441 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.4640 | Val  Acc: 0.6102
Average Valid Accuracy: 0.6576
============ Train epoch 44 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.6838 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.6588 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.9186 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.8303 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 0.6742 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.7036 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.4720 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.3874 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.5892 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.4068 | Train Acc: 0.6250
 Site-MNIST     | Val  Loss: 0.7357 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.5961 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.8813 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8613 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.6943 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.6396 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.4344 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.3809 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.4288 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.4560 | Val  Acc: 0.6441
Average Valid Accuracy: 0.6559
============ Train epoch 45 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.6631 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.6694 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.8847 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.8306 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 0.6498 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.6859 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.4881 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.3904 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.5735 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.4044 | Train Acc: 0.6136
 Site-MNIST     | Val  Loss: 0.7296 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.5858 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.8825 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8628 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.6899 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.6308 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.4261 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.3700 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.4280 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.4445 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6559
============ Train epoch 46 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.6724 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.6720 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.8768 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.8356 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 0.6516 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.6804 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.4009 | Train Acc: 0.5795
 Site-SynthDigits| Train Loss: 1.3705 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.5770 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.3780 | Train Acc: 0.6250
 Site-MNIST     | Val  Loss: 0.7211 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.5797 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.8755 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8481 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.6796 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.6255 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.4252 | Val  Acc: 0.6271
 Site-SynthDigits| Val  Loss: 1.3696 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.4082 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.4340 | Val  Acc: 0.6441
Average Valid Accuracy: 0.6627
 Best site-MNIST      | Epoch:46 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:46 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:46 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:46 | Val Acc: 0.2542
 Best site-USPS       | Epoch:46 | Val Acc: 0.8983
 Best site-USPS       | Epoch:46 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:46 | Val Acc: 0.6271
 Best site-SynthDigits | Epoch:46 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:46 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:46 | Val Acc: 0.6441
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 47 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.6704 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.6352 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.9003 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.7783 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 0.6457 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.6661 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.4515 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.3667 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.5782 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.3646 | Train Acc: 0.6250
 Site-MNIST     | Val  Loss: 0.7149 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.5729 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.8754 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8473 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.6708 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.6167 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.4166 | Val  Acc: 0.6271
 Site-SynthDigits| Val  Loss: 1.3634 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.4006 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.4252 | Val  Acc: 0.6441
Average Valid Accuracy: 0.6610
============ Train epoch 48 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.6537 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.6286 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.8934 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.8272 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 0.6686 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.6862 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.4360 | Train Acc: 0.5795
 Site-SynthDigits| Train Loss: 1.3564 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.5587 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.3545 | Train Acc: 0.6136
 Site-MNIST     | Val  Loss: 0.7075 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.5674 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.8705 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8490 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.6735 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.6209 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.4085 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.3637 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.3944 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.4181 | Val  Acc: 0.6441
Average Valid Accuracy: 0.6610
============ Train epoch 49 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
clients=[(6,)(2,)(2,)]
 Site-MNIST     | Train Loss: 0.6545 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.6606 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.9019 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.8058 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 0.6476 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.6495 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.4343 | Train Acc: 0.6023
 Site-SynthDigits| Train Loss: 1.3561 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.5644 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.3764 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.6985 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.5608 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.8662 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8393 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.6641 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.6098 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.4077 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.3626 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.3863 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.4087 | Val  Acc: 0.6610
Average Valid Accuracy: 0.6610
===2023-04-05 15:05:10===
===2023-04-05 15:23:31===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:46 | Test Acc: 0.7614
 Test site-SVHN      | Epoch:46 | Test Acc: 0.2992
 Test site-USPS      | Epoch:46 | Test Acc: 0.8011
 Test site-SynthDigits| Epoch:46 | Test Acc: 0.4779
 Test site-MNIST-M   | Epoch:46 | Test Acc: 0.3650
Average Test Accuracy: 0.5409
===2023-04-05 16:28:54===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
clients=[(7,)(1,)(2,)]
 Site-MNIST     | Train Loss: 2.2294 | Train Acc: 0.1364
 Site-MNIST     | Train Loss: 2.1744 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.3480 | Train Acc: 0.0795
 Site-SVHN      | Train Loss: 2.3158 | Train Acc: 0.1364
 Site-USPS      | Train Loss: 2.1551 | Train Acc: 0.1250
 Site-USPS      | Train Loss: 2.1696 | Train Acc: 0.1705
 Site-SynthDigits| Train Loss: 2.2953 | Train Acc: 0.1364
 Site-SynthDigits| Train Loss: 2.2931 | Train Acc: 0.0682
 Site-MNIST-M   | Train Loss: 2.3084 | Train Acc: 0.1364
 Site-MNIST-M   | Train Loss: 2.3133 | Train Acc: 0.1136
 Site-MNIST     | Val  Loss: 2.1996 | Val  Acc: 0.1356
 Site-MNIST     | Val  Loss: 2.2133 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.3195 | Val  Acc: 0.1864
 Site-SVHN      | Val  Loss: 2.3428 | Val  Acc: 0.0339
 Site-USPS      | Val  Loss: 2.1993 | Val  Acc: 0.1186
 Site-USPS      | Val  Loss: 2.1353 | Val  Acc: 0.1864
 Site-SynthDigits| Val  Loss: 2.2757 | Val  Acc: 0.0678
 Site-SynthDigits| Val  Loss: 2.2829 | Val  Acc: 0.1186
 Site-MNIST-M   | Val  Loss: 2.2958 | Val  Acc: 0.1186
 Site-MNIST-M   | Val  Loss: 2.3149 | Val  Acc: 0.0847
Average Valid Accuracy: 0.1220
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1356
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1864
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0339
 Best site-USPS       | Epoch:0 | Val Acc: 0.1186
 Best site-USPS       | Epoch:0 | Val Acc: 0.1864
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0678
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1186
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1186
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.0847
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 1 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(8,)(1,)(1,)]
 Site-MNIST     | Train Loss: 2.1148 | Train Acc: 0.2500
 Site-MNIST     | Train Loss: 2.0468 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 2.3048 | Train Acc: 0.1136
 Site-SVHN      | Train Loss: 2.2631 | Train Acc: 0.1591
 Site-USPS      | Train Loss: 2.0045 | Train Acc: 0.3977
 Site-USPS      | Train Loss: 2.0138 | Train Acc: 0.3864
 Site-SynthDigits| Train Loss: 2.2234 | Train Acc: 0.1932
 Site-SynthDigits| Train Loss: 2.2356 | Train Acc: 0.1250
 Site-MNIST-M   | Train Loss: 2.2759 | Train Acc: 0.1591
 Site-MNIST-M   | Train Loss: 2.2485 | Train Acc: 0.1705
 Site-MNIST     | Val  Loss: 2.0778 | Val  Acc: 0.3559
 Site-MNIST     | Val  Loss: 2.0610 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.2628 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.2862 | Val  Acc: 0.0678
 Site-USPS      | Val  Loss: 2.0435 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 1.9920 | Val  Acc: 0.3898
 Site-SynthDigits| Val  Loss: 2.2261 | Val  Acc: 0.1017
 Site-SynthDigits| Val  Loss: 2.2297 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.2494 | Val  Acc: 0.1695
 Site-MNIST-M   | Val  Loss: 2.2598 | Val  Acc: 0.1356
Average Valid Accuracy: 0.2339
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3559
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:1 | Val Acc: 0.0678
 Best site-USPS       | Epoch:1 | Val Acc: 0.3729
 Best site-USPS       | Epoch:1 | Val Acc: 0.3898
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1017
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1695
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 2 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(7,)(2,)(1,)]
 Site-MNIST     | Train Loss: 1.9991 | Train Acc: 0.3750
 Site-MNIST     | Train Loss: 1.9021 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 2.2724 | Train Acc: 0.1250
 Site-SVHN      | Train Loss: 2.2050 | Train Acc: 0.1932
 Site-USPS      | Train Loss: 1.8163 | Train Acc: 0.5682
 Site-USPS      | Train Loss: 1.8650 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 2.1915 | Train Acc: 0.2614
 Site-SynthDigits| Train Loss: 2.1674 | Train Acc: 0.1818
 Site-MNIST-M   | Train Loss: 2.2219 | Train Acc: 0.1591
 Site-MNIST-M   | Train Loss: 2.1979 | Train Acc: 0.1932
 Site-MNIST     | Val  Loss: 1.9528 | Val  Acc: 0.4407
 Site-MNIST     | Val  Loss: 1.9123 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 2.2281 | Val  Acc: 0.1864
 Site-SVHN      | Val  Loss: 2.2358 | Val  Acc: 0.1525
 Site-USPS      | Val  Loss: 1.8792 | Val  Acc: 0.5593
 Site-USPS      | Val  Loss: 1.8242 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 2.1714 | Val  Acc: 0.1695
 Site-SynthDigits| Val  Loss: 2.1663 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.2030 | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: 2.2141 | Val  Acc: 0.1356
Average Valid Accuracy: 0.3102
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4407
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1864
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1525
 Best site-USPS       | Epoch:2 | Val Acc: 0.5593
 Best site-USPS       | Epoch:2 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.1695
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2034
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 3 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(6,)(3,)(1,)]
 Site-MNIST     | Train Loss: 1.8327 | Train Acc: 0.5341
 Site-MNIST     | Train Loss: 1.7461 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 2.2392 | Train Acc: 0.1591
 Site-SVHN      | Train Loss: 2.1630 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.6361 | Train Acc: 0.7273
 Site-USPS      | Train Loss: 1.6464 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 2.1309 | Train Acc: 0.2841
 Site-SynthDigits| Train Loss: 2.0908 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.1766 | Train Acc: 0.2159
 Site-MNIST-M   | Train Loss: 2.1867 | Train Acc: 0.2159
 Site-MNIST     | Val  Loss: 1.8057 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.7496 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 2.1862 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1882 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.6770 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 1.6383 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 2.1054 | Val  Acc: 0.2712
 Site-SynthDigits| Val  Loss: 2.0875 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.1622 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.1846 | Val  Acc: 0.1864
Average Valid Accuracy: 0.4102
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2034
 Best site-USPS       | Epoch:3 | Val Acc: 0.7288
 Best site-USPS       | Epoch:3 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2712
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 4 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(6,)(3,)(1,)]
 Site-MNIST     | Train Loss: 1.7059 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.6379 | Train Acc: 0.6932
 Site-SVHN      | Train Loss: 2.1961 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.0951 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.4604 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.4824 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 2.0352 | Train Acc: 0.3295
 Site-SynthDigits| Train Loss: 2.0243 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 2.1325 | Train Acc: 0.2386
 Site-MNIST-M   | Train Loss: 2.1572 | Train Acc: 0.2159
 Site-MNIST     | Val  Loss: 1.6743 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.6088 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 2.1342 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1293 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 1.4927 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 1.4602 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 2.0474 | Val  Acc: 0.3390
 Site-SynthDigits| Val  Loss: 1.9979 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1396 | Val  Acc: 0.2712
 Site-MNIST-M   | Val  Loss: 2.1567 | Val  Acc: 0.2034
Average Valid Accuracy: 0.4695
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2542
 Best site-USPS       | Epoch:4 | Val Acc: 0.8305
 Best site-USPS       | Epoch:4 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3390
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2712
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 5 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(6,)(3,)(1,)]
 Site-MNIST     | Train Loss: 1.5511 | Train Acc: 0.6250
 Site-MNIST     | Train Loss: 1.4600 | Train Acc: 0.7159
 Site-SVHN      | Train Loss: 2.1312 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.0111 | Train Acc: 0.3295
 Site-USPS      | Train Loss: 1.2734 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 1.3031 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.9803 | Train Acc: 0.3864
 Site-SynthDigits| Train Loss: 1.9740 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 2.0824 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1131 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 1.5237 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.4306 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.0604 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 2.0761 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 1.3216 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 1.3076 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.9846 | Val  Acc: 0.3729
 Site-SynthDigits| Val  Loss: 1.9507 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 2.1039 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.0898 | Val  Acc: 0.2034
Average Valid Accuracy: 0.5017
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:5 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2542
 Best site-USPS       | Epoch:5 | Val Acc: 0.8475
 Best site-USPS       | Epoch:5 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3729
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 6 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(6,)(3,)(1,)]
 Site-MNIST     | Train Loss: 1.4533 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.3483 | Train Acc: 0.7159
 Site-SVHN      | Train Loss: 2.0868 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.9857 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 1.1861 | Train Acc: 0.7955
 Site-USPS      | Train Loss: 1.1706 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.9330 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.9576 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 2.0252 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 2.0348 | Train Acc: 0.2955
 Site-MNIST     | Val  Loss: 1.4086 | Val  Acc: 0.6780
 Site-MNIST     | Val  Loss: 1.3019 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.0157 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 2.0369 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 1.1645 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 1.1845 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.9718 | Val  Acc: 0.3559
 Site-SynthDigits| Val  Loss: 1.9398 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0480 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0162 | Val  Acc: 0.2712
Average Valid Accuracy: 0.5136
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6780
 Best site-MNIST      | Epoch:6 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2712
 Best site-USPS       | Epoch:6 | Val Acc: 0.8644
 Best site-USPS       | Epoch:6 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3559
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.2712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 7 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(6,)(3,)(1,)]
 Site-MNIST     | Train Loss: 1.3549 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.2130 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.0573 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.9390 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 1.0567 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 1.0263 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.8002 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 1.8000 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.9516 | Train Acc: 0.3295
 Site-MNIST-M   | Train Loss: 2.0231 | Train Acc: 0.3295
 Site-MNIST     | Val  Loss: 1.3074 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.1878 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 1.9621 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.9505 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 1.0350 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 1.0425 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.8494 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.7696 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 2.0061 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 1.9860 | Val  Acc: 0.2881
Average Valid Accuracy: 0.5712
 Best site-MNIST      | Epoch:7 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:7 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3729
 Best site-USPS       | Epoch:7 | Val Acc: 0.8814
 Best site-USPS       | Epoch:7 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.2881
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 8 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(6,)(3,)(1,)]
 Site-MNIST     | Train Loss: 1.2428 | Train Acc: 0.6705
 Site-MNIST     | Train Loss: 1.1684 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 1.9582 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.8507 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 0.9469 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.8931 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.7257 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.7429 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.8600 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 1.9161 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 1.2352 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.1025 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 1.8899 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.9063 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 0.9099 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.9328 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.7821 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.7057 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.9206 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.8757 | Val  Acc: 0.4237
Average Valid Accuracy: 0.6000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:8 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3729
 Best site-USPS       | Epoch:8 | Val Acc: 0.8814
 Best site-USPS       | Epoch:8 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 9 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(6,)(3,)(1,)]
 Site-MNIST     | Train Loss: 1.1299 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 1.0781 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 1.9496 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.9477 | Train Acc: 0.3864
 Site-USPS      | Train Loss: 0.8536 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.7766 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 1.7046 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 1.6992 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.7898 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.9109 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 1.1662 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.0026 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 1.9749 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.9509 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 0.8040 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.8323 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.7541 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.7008 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.8586 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.8327 | Val  Acc: 0.4576
Average Valid Accuracy: 0.5966
============ Train epoch 10 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 1.0516 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 0.9504 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 1.8266 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 1.7799 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.7483 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.7063 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 1.5988 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.5963 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.7349 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.7584 | Train Acc: 0.5114
 Site-MNIST     | Val  Loss: 1.0642 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 0.9097 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 1.7912 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.8388 | Val  Acc: 0.3898
 Site-USPS      | Val  Loss: 0.7068 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.7211 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.6691 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.5763 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.7375 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.7337 | Val  Acc: 0.5085
Average Valid Accuracy: 0.6373
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:10 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:10 | Val Acc: 0.3898
 Best site-USPS       | Epoch:10 | Val Acc: 0.9322
 Best site-USPS       | Epoch:10 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 11 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 1.0196 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 0.9405 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 1.7864 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.7001 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.6909 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.6333 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 1.4986 | Train Acc: 0.5795
 Site-SynthDigits| Train Loss: 1.5749 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.6582 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.6559 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 1.0184 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 0.8498 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 1.7348 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.7677 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.6359 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.6599 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.6138 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 1.5511 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.6507 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.6079 | Val  Acc: 0.5593
Average Valid Accuracy: 0.6373
============ Train epoch 12 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.8603 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 0.8237 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.7825 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.7678 | Train Acc: 0.3977
 Site-USPS      | Train Loss: 0.6374 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.5710 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 1.4888 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 1.4589 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.4975 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.6916 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 0.9171 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.7535 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.8033 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.7617 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.5837 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.5986 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.5340 | Val  Acc: 0.5593
 Site-SynthDigits| Val  Loss: 1.4397 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.6805 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.5996 | Val  Acc: 0.5593
Average Valid Accuracy: 0.6559
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:12 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:12 | Val Acc: 0.3559
 Best site-USPS       | Epoch:12 | Val Acc: 0.9153
 Best site-USPS       | Epoch:12 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.5593
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 13 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.8553 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 0.7948 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 1.6454 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 1.5680 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.5265 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.4964 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 1.4125 | Train Acc: 0.6023
 Site-SynthDigits| Train Loss: 1.4226 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.4606 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.5044 | Train Acc: 0.6136
 Site-MNIST     | Val  Loss: 0.8873 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.7326 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.5994 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.6342 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.5103 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.5237 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.4729 | Val  Acc: 0.5593
 Site-SynthDigits| Val  Loss: 1.3955 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.4989 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.4295 | Val  Acc: 0.6780
Average Valid Accuracy: 0.6898
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:13 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:13 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:13 | Val Acc: 0.4576
 Best site-USPS       | Epoch:13 | Val Acc: 0.9661
 Best site-USPS       | Epoch:13 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.5593
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.6780
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 14 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.8024 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.7080 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 1.5142 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.5721 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.4887 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.4262 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 1.4205 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.3984 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.3794 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.3899 | Train Acc: 0.6705
 Site-MNIST     | Val  Loss: 0.8157 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.6463 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.5750 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.6007 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.4474 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.4640 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.4491 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.3746 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.3925 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.3317 | Val  Acc: 0.7288
Average Valid Accuracy: 0.6983
 Best site-MNIST      | Epoch:14 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:14 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:14 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:14 | Val Acc: 0.4576
 Best site-USPS       | Epoch:14 | Val Acc: 0.9831
 Best site-USPS       | Epoch:14 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.7288
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 15 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.7367 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.6745 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 1.4480 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.4751 | Train Acc: 0.5682
 Site-USPS      | Train Loss: 0.4369 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.4083 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 1.2632 | Train Acc: 0.6477
 Site-SynthDigits| Train Loss: 1.2389 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.2780 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.3422 | Train Acc: 0.6932
 Site-MNIST     | Val  Loss: 0.7717 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.6134 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.4339 | Val  Acc: 0.6271
 Site-SVHN      | Val  Loss: 1.4932 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.4139 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.4256 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.3020 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 1.2764 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.3642 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.2552 | Val  Acc: 0.7797
Average Valid Accuracy: 0.7373
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:15 | Val Acc: 0.6271
 Best site-SVHN       | Epoch:15 | Val Acc: 0.4746
 Best site-USPS       | Epoch:15 | Val Acc: 0.9831
 Best site-USPS       | Epoch:15 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.7797
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 16 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.6698 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 0.6054 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 1.4072 | Train Acc: 0.6818
 Site-SVHN      | Train Loss: 1.3397 | Train Acc: 0.6364
 Site-USPS      | Train Loss: 0.3815 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.3414 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 1.2403 | Train Acc: 0.6477
 Site-SynthDigits| Train Loss: 1.2356 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.1936 | Train Acc: 0.7386
 Site-MNIST-M   | Train Loss: 1.2104 | Train Acc: 0.7159
 Site-MNIST     | Val  Loss: 0.7127 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.5643 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.3776 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 1.4233 | Val  Acc: 0.5593
 Site-USPS      | Val  Loss: 0.3597 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.3760 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.2927 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.2450 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.2480 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 1.1531 | Val  Acc: 0.7966
Average Valid Accuracy: 0.7576
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:16 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:16 | Val Acc: 0.5593
 Best site-USPS       | Epoch:16 | Val Acc: 1.0000
 Best site-USPS       | Epoch:16 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.6102
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.7966
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 17 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.6437 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.6367 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 1.3375 | Train Acc: 0.6250
 Site-SVHN      | Train Loss: 1.3046 | Train Acc: 0.5909
 Site-USPS      | Train Loss: 0.3570 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.3132 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 1.1525 | Train Acc: 0.6932
 Site-SynthDigits| Train Loss: 1.1304 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.1102 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 1.1677 | Train Acc: 0.7386
 Site-MNIST     | Val  Loss: 0.6825 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.5366 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.3306 | Val  Acc: 0.6271
 Site-SVHN      | Val  Loss: 1.3830 | Val  Acc: 0.5424
 Site-USPS      | Val  Loss: 0.3238 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.3386 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.1771 | Val  Acc: 0.6780
 Site-SynthDigits| Val  Loss: 1.1587 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 1.1812 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.0931 | Val  Acc: 0.8475
Average Valid Accuracy: 0.7661
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:17 | Val Acc: 0.6271
 Best site-SVHN       | Epoch:17 | Val Acc: 0.5424
 Best site-USPS       | Epoch:17 | Val Acc: 1.0000
 Best site-USPS       | Epoch:17 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.6780
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.8475
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 18 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.5970 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.5856 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 1.2376 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 1.3148 | Train Acc: 0.6250
 Site-USPS      | Train Loss: 0.3100 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.2800 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 1.1097 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.1510 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.0404 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 1.0998 | Train Acc: 0.7841
 Site-MNIST     | Val  Loss: 0.6221 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.4861 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.3097 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 1.3191 | Val  Acc: 0.5932
 Site-USPS      | Val  Loss: 0.2845 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.3070 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.1873 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 1.1292 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 1.1085 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 1.0048 | Val  Acc: 0.8136
Average Valid Accuracy: 0.7881
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:18 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:18 | Val Acc: 0.5932
 Best site-USPS       | Epoch:18 | Val Acc: 1.0000
 Best site-USPS       | Epoch:18 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.7458
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.8136
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 19 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(5,)(3,)(2,)]
 Site-MNIST     | Train Loss: 0.5637 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.5384 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 1.2101 | Train Acc: 0.7045
 Site-SVHN      | Train Loss: 1.1575 | Train Acc: 0.6818
 Site-USPS      | Train Loss: 0.2694 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.2619 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 1.0496 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.0027 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 0.9716 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.0037 | Train Acc: 0.8068
 Site-MNIST     | Val  Loss: 0.6111 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.4803 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.1392 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 1.2113 | Val  Acc: 0.6102
 Site-USPS      | Val  Loss: 0.2688 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.2776 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.0537 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 1.0602 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 1.0455 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 0.9303 | Val  Acc: 0.8814
Average Valid Accuracy: 0.8034
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:19 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:19 | Val Acc: 0.6102
 Best site-USPS       | Epoch:19 | Val Acc: 1.0000
 Best site-USPS       | Epoch:19 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.7119
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.7458
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.8814
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.7557
 Test site-SVHN      | Epoch:19 | Test Acc: 0.3118
 Test site-USPS      | Epoch:19 | Test Acc: 0.8871
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.5345
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.3364
Average Test Accuracy: 0.5651
============ Train epoch 20 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.5082 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4640 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.0801 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 1.0675 | Train Acc: 0.7500
 Site-USPS      | Train Loss: 0.2543 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.2484 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.9386 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 0.9454 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 0.8962 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.9293 | Train Acc: 0.8636
 Site-MNIST     | Val  Loss: 0.5268 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.4169 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.0625 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 1.1546 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 0.2517 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.2592 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.9894 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 1.0191 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 0.9569 | Val  Acc: 0.8136
 Site-MNIST-M   | Val  Loss: 0.8647 | Val  Acc: 0.8814
Average Valid Accuracy: 0.8407
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:20 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:20 | Val Acc: 0.7288
 Best site-USPS       | Epoch:20 | Val Acc: 1.0000
 Best site-USPS       | Epoch:20 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.8136
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.8814
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 21 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.4503 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.4460 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 1.0622 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 1.0188 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 0.2359 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.2194 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.8343 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.8237 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.8338 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.8865 | Train Acc: 0.8750
 Site-MNIST     | Val  Loss: 0.4876 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.3890 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.0372 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 1.0891 | Val  Acc: 0.7458
 Site-USPS      | Val  Loss: 0.2310 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.2350 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.8585 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 0.9185 | Val  Acc: 0.7627
 Site-MNIST-M   | Val  Loss: 0.9212 | Val  Acc: 0.8136
 Site-MNIST-M   | Val  Loss: 0.8064 | Val  Acc: 0.9153
Average Valid Accuracy: 0.8559
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:21 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:21 | Val Acc: 0.7458
 Best site-USPS       | Epoch:21 | Val Acc: 1.0000
 Best site-USPS       | Epoch:21 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.7627
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.8136
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.9153
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 22 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.4096 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.3895 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 0.9916 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 0.9335 | Train Acc: 0.7727
 Site-USPS      | Train Loss: 0.2199 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.2086 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.8098 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 0.8249 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.7640 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.7870 | Train Acc: 0.8977
 Site-MNIST     | Val  Loss: 0.4469 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.3625 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 0.9710 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.0278 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 0.2098 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.2136 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.8210 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 0.8704 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 0.8472 | Val  Acc: 0.8644
 Site-MNIST-M   | Val  Loss: 0.7450 | Val  Acc: 0.9153
Average Valid Accuracy: 0.8729
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:22 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:22 | Val Acc: 0.7627
 Best site-USPS       | Epoch:22 | Val Acc: 1.0000
 Best site-USPS       | Epoch:22 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.8644
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.9153
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 23 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.3509 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3183 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 0.9307 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 0.9919 | Train Acc: 0.7500
 Site-USPS      | Train Loss: 0.2060 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1963 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.7956 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 0.8059 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 0.7410 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.7811 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.3766 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.3016 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.0140 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 0.9978 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 0.1907 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1971 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.8306 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 0.8546 | Val  Acc: 0.7627
 Site-MNIST-M   | Val  Loss: 0.8492 | Val  Acc: 0.8814
 Site-MNIST-M   | Val  Loss: 0.7153 | Val  Acc: 0.9322
Average Valid Accuracy: 0.8729
============ Train epoch 24 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.3643 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3309 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 0.8581 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 0.8143 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 0.1989 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1883 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.6811 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.7144 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.6698 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.6809 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.3854 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3264 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 0.8355 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 0.9059 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 0.1914 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1845 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.7051 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.8035 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 0.7388 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.6474 | Val  Acc: 0.9322
Average Valid Accuracy: 0.8983
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:24 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:24 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:24 | Val Acc: 0.7966
 Best site-USPS       | Epoch:24 | Val Acc: 1.0000
 Best site-USPS       | Epoch:24 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.7458
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.9322
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 25 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.3113 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.3164 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 0.8251 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 0.7899 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.1702 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1632 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.6708 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.6350 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.5928 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.6909 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.3379 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2944 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 0.8132 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 0.8110 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.1649 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1673 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.6338 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.7242 | Val  Acc: 0.8136
 Site-MNIST-M   | Val  Loss: 0.7159 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.6001 | Val  Acc: 0.9492
Average Valid Accuracy: 0.9169
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:25 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:25 | Val Acc: 0.8305
 Best site-USPS       | Epoch:25 | Val Acc: 1.0000
 Best site-USPS       | Epoch:25 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.8136
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.9492
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 26 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.2755 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2853 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 0.7477 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 0.7501 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.1548 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1474 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.5945 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.6030 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.5856 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.6820 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.3030 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2607 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.7723 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 0.7933 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.1519 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1535 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.6145 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.6765 | Val  Acc: 0.8644
 Site-MNIST-M   | Val  Loss: 0.7437 | Val  Acc: 0.8814
 Site-MNIST-M   | Val  Loss: 0.5972 | Val  Acc: 0.9322
Average Valid Accuracy: 0.9203
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:26 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:26 | Val Acc: 0.8136
 Best site-USPS       | Epoch:26 | Val Acc: 1.0000
 Best site-USPS       | Epoch:26 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.8644
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.8814
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.9322
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 27 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.2644 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2443 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 0.7031 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 0.6955 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.1431 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1333 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.5584 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.5520 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.5081 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.5954 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.2793 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2512 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 0.7173 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 0.7223 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.1425 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1385 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.5449 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.6198 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 0.6316 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.5290 | Val  Acc: 0.9831
Average Valid Accuracy: 0.9322
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:27 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:27 | Val Acc: 0.8475
 Best site-USPS       | Epoch:27 | Val Acc: 1.0000
 Best site-USPS       | Epoch:27 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.8305
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.9831
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 28 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.2591 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2461 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 0.6298 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 0.7335 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.1434 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.1300 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.5070 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.5680 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.5070 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.5789 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.2680 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2338 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.7185 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 0.7128 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.1492 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1236 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5586 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.6100 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.6135 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.5103 | Val  Acc: 0.9661
Average Valid Accuracy: 0.9322
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:28 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:28 | Val Acc: 0.8475
 Best site-USPS       | Epoch:28 | Val Acc: 1.0000
 Best site-USPS       | Epoch:28 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.8475
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.9661
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 29 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.2138 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2299 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 0.5694 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 0.6093 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.1321 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.1193 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.4659 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.4639 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.4763 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.5727 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.2389 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2032 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.6281 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 0.6082 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.1203 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1096 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.4581 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.5414 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.6088 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.4762 | Val  Acc: 0.9831
Average Valid Accuracy: 0.9475
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:29 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:29 | Val Acc: 0.8814
 Best site-USPS       | Epoch:29 | Val Acc: 1.0000
 Best site-USPS       | Epoch:29 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.8475
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.9831
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 30 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.2207 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1894 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.5749 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 0.6049 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.1224 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.1054 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.4241 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.4517 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.4119 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.4792 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.2194 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1875 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.6199 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 0.5988 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.1136 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1063 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.4522 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.5298 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.5107 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.4105 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9542
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:30 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:30 | Val Acc: 0.8983
 Best site-USPS       | Epoch:30 | Val Acc: 1.0000
 Best site-USPS       | Epoch:30 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.8475
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:30 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 31 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.1967 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1888 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.5228 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 0.5631 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.1280 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0998 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.4192 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.4282 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.3768 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.4479 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.2056 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1832 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.5749 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 0.5235 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.1152 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0997 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.4250 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.4875 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.4800 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.3761 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9576
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:31 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:31 | Val Acc: 0.9322
 Best site-USPS       | Epoch:31 | Val Acc: 1.0000
 Best site-USPS       | Epoch:31 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.8475
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:31 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 32 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.1681 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1848 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 0.4877 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 0.4717 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.0971 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0898 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.3644 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.3839 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.3564 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.4358 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.1926 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1651 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.5186 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 0.4734 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.1073 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0869 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.3556 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4590 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.4818 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.3642 | Val  Acc: 0.9831
Average Valid Accuracy: 0.9542
============ Train epoch 33 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.1666 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1714 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 0.4608 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 0.4906 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.0823 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0811 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.3550 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.3950 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.3514 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.5058 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.1849 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1558 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.5177 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 0.4756 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.0986 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0791 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.3805 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.4659 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.5447 | Val  Acc: 0.8983
 Site-MNIST-M   | Val  Loss: 0.3656 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9508
============ Train epoch 34 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.1616 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1456 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.4150 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 0.4304 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.0813 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0765 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.3077 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.3560 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.2936 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.3668 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.1701 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1539 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.4846 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 0.4125 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.0887 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0782 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.3411 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4063 | Val  Acc: 0.8814
 Site-MNIST-M   | Val  Loss: 0.3920 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.2995 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9678
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:34 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:34 | Val Acc: 0.9661
 Best site-USPS       | Epoch:34 | Val Acc: 1.0000
 Best site-USPS       | Epoch:34 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.8814
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:34 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 35 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.1604 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1492 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 0.3880 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 0.4112 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.0711 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0652 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.2894 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.3351 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.2715 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.3916 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.1603 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1382 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.4183 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.3661 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0884 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0659 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.3096 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4016 | Val  Acc: 0.8814
 Site-MNIST-M   | Val  Loss: 0.4044 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.2849 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9678
============ Train epoch 36 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.1279 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1217 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.3699 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 0.3626 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.0625 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0579 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.3084 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.3146 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.2706 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.4015 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.1448 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1097 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.4001 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.3520 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0779 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0605 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.3133 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.4000 | Val  Acc: 0.8814
 Site-MNIST-M   | Val  Loss: 0.4362 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.2826 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9729
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:36 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:36 | Val Acc: 1.0000
 Best site-USPS       | Epoch:36 | Val Acc: 1.0000
 Best site-USPS       | Epoch:36 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.8814
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:36 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 37 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.1312 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1332 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.3398 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 0.3463 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.0669 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0564 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.2682 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.2841 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.2353 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.3227 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.1375 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1098 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.3723 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 0.3218 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0737 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0566 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.2755 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.3492 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.3620 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.2487 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9763
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:37 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:37 | Val Acc: 1.0000
 Best site-USPS       | Epoch:37 | Val Acc: 1.0000
 Best site-USPS       | Epoch:37 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:37 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:37 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 38 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.1211 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1096 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.3197 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.2978 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0591 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0560 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.2540 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.2758 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.2242 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.3248 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.1304 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1002 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.3413 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.2828 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0749 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0525 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.2670 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.3274 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.3719 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.2422 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9814
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:38 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:38 | Val Acc: 1.0000
 Best site-USPS       | Epoch:38 | Val Acc: 1.0000
 Best site-USPS       | Epoch:38 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:38 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 39 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.1052 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1004 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.2801 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.2891 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0535 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0562 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.2455 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.2585 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.2058 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.3054 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.1178 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0916 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.3147 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.2645 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0751 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0508 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.2584 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.3208 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.3443 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.2275 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9814
============ Train epoch 40 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.0971 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0877 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.2626 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.3085 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.0529 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0485 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.2149 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.2329 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.1924 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.2692 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1034 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0810 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.3374 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.2743 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0713 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0464 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.2255 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2939 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.2978 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.2033 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9831
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:40 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:40 | Val Acc: 1.0000
 Best site-USPS       | Epoch:40 | Val Acc: 1.0000
 Best site-USPS       | Epoch:40 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:40 | Val Acc: 0.9831
 Best site-MNIST-M    | Epoch:40 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 41 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.0921 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0969 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.2532 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.2748 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0512 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0428 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.2059 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.2295 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.1753 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.2490 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.1102 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0820 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.3059 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.2491 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0709 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0423 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.2236 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.2821 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.2808 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.1889 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9864
 Best site-MNIST      | Epoch:41 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:41 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:41 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:41 | Val Acc: 1.0000
 Best site-USPS       | Epoch:41 | Val Acc: 1.0000
 Best site-USPS       | Epoch:41 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.9831
 Best site-MNIST-M    | Epoch:41 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:41 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 42 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.0735 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0947 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.2202 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.2599 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0395 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0386 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1857 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.2243 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1732 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.2511 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.0933 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0651 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.2971 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.2325 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0653 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0383 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.2085 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.2650 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.2764 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.1821 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9898
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:42 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:42 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:42 | Val Acc: 1.0000
 Best site-USPS       | Epoch:42 | Val Acc: 0.9831
 Best site-USPS       | Epoch:42 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:42 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.9831
 Best site-MNIST-M    | Epoch:42 | Val Acc: 0.9831
 Best site-MNIST-M    | Epoch:42 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 43 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.0715 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0766 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.2172 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.2318 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0406 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0381 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1711 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.1930 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1567 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.2485 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.0866 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0624 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.2689 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.2101 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0593 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0374 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.2040 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2400 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.2698 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.1748 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9898
============ Train epoch 44 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.0640 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0723 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.1926 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.2208 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0393 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0351 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1706 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.1958 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1457 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.2277 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.0800 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0608 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.2615 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.1991 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0630 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0345 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1818 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.2315 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.2459 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.1615 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9915
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:44 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:44 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:44 | Val Acc: 1.0000
 Best site-USPS       | Epoch:44 | Val Acc: 1.0000
 Best site-USPS       | Epoch:44 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:44 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.9831
 Best site-MNIST-M    | Epoch:44 | Val Acc: 0.9831
 Best site-MNIST-M    | Epoch:44 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 45 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.0598 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0633 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1879 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.2255 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0330 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0328 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1464 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.1952 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1376 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.2005 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0719 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0535 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.2589 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.1877 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0566 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0326 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1906 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2178 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.2286 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.1549 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9932
 Best site-MNIST      | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:45 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:45 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:45 | Val Acc: 1.0000
 Best site-USPS       | Epoch:45 | Val Acc: 1.0000
 Best site-USPS       | Epoch:45 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:45 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:45 | Val Acc: 0.9831
 Best site-MNIST-M    | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:45 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
============ Train epoch 46 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.0595 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0629 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1796 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.2021 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0335 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0298 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1352 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.1793 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1341 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.2015 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0710 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0553 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.2395 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.1692 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0609 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0300 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1772 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2029 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.2118 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.1463 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9932
============ Train epoch 47 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.0508 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0620 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1709 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1914 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0299 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0303 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1395 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.1665 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1324 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1958 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0698 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0511 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.2142 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.1612 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0654 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0283 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1653 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.1995 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.2133 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.1438 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9932
============ Train epoch 48 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.0506 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0585 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1670 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1660 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0341 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0290 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1435 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.1674 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1305 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1808 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0674 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0459 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.1987 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.1509 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0594 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0271 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1695 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.1953 | Val  Acc: 0.9831
 Site-MNIST-M   | Val  Loss: 0.2000 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.1350 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9915
============ Train epoch 49 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
clients=[(4,)(3,)(3,)]
 Site-MNIST     | Train Loss: 0.0437 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0555 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1498 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.1518 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0252 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0270 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1243 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.1475 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1155 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1707 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0590 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0418 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.1894 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.1381 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0581 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0248 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1547 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.1735 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.1839 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.1240 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9949
 Best site-MNIST      | Epoch:49 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:49 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:49 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:49 | Val Acc: 1.0000
 Best site-USPS       | Epoch:49 | Val Acc: 0.9831
 Best site-USPS       | Epoch:49 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:49 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:49 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:49 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:49 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/FedPrompt...
===2023-04-05 17:26:55===
===2023-04-05 17:26:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:49 | Test Acc: 0.8807
 Test site-SVHN      | Epoch:49 | Test Acc: 0.3612
 Test site-USPS      | Epoch:49 | Test Acc: 0.8925
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.6179
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.3600
Average Test Accuracy: 0.6225
