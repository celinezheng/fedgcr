===2023-04-01 10:30:18===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 40
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.9166 | Train Acc: 0.4318
 Site-MNIST     | Train Loss: 1.8103 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 2.2334 | Train Acc: 0.1591
 Site-SVHN      | Train Loss: 2.2159 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.8068 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 1.8330 | Train Acc: 0.5114
 Site-SynthDigits| Train Loss: 2.1285 | Train Acc: 0.3068
 Site-SynthDigits| Train Loss: 2.1300 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.2190 | Train Acc: 0.1364
 Site-MNIST-M   | Train Loss: 2.1669 | Train Acc: 0.2159
 Site-MNIST     | Val  Loss: 1.8488 | Val  Acc: 0.4915
 Site-MNIST     | Val  Loss: 1.8171 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 2.2072 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2274 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.8720 | Val  Acc: 0.4915
 Site-USPS      | Val  Loss: 1.8174 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 2.1387 | Val  Acc: 0.2542
 Site-SynthDigits| Val  Loss: 2.1136 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1484 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.1952 | Val  Acc: 0.1186
Average Valid Accuracy: 0.3356
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4915
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2034
 Best site-USPS       | Epoch:0 | Val Acc: 0.4915
 Best site-USPS       | Epoch:0 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2542
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1186
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.5740 | Train Acc: 0.5455
 Site-MNIST     | Train Loss: 1.4591 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 2.1506 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.0875 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 1.4478 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 1.5056 | Train Acc: 0.7159
 Site-SynthDigits| Train Loss: 1.9588 | Train Acc: 0.3295
 Site-SynthDigits| Train Loss: 1.9115 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 2.1233 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.0274 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 1.5274 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.4380 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 2.1036 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.1175 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.5233 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 1.4653 | Val  Acc: 0.6780
 Site-SynthDigits| Val  Loss: 1.9730 | Val  Acc: 0.3729
 Site-SynthDigits| Val  Loss: 1.9200 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0076 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.0594 | Val  Acc: 0.2542
Average Valid Accuracy: 0.4475
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1864
 Best site-USPS       | Epoch:1 | Val Acc: 0.7288
 Best site-USPS       | Epoch:1 | Val Acc: 0.6780
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3729
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2542
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.3171 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.2071 | Train Acc: 0.7614
 Site-SVHN      | Train Loss: 2.0633 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.0079 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 1.1849 | Train Acc: 0.8068
 Site-USPS      | Train Loss: 1.2336 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.8071 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 1.7583 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 2.0100 | Train Acc: 0.3295
 Site-MNIST-M   | Train Loss: 1.9219 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 1.2885 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.1754 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.0295 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 2.0366 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 1.2493 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 1.1958 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.8361 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 1.7758 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 1.8843 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 1.9435 | Val  Acc: 0.3390
Average Valid Accuracy: 0.5186
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2542
 Best site-USPS       | Epoch:2 | Val Acc: 0.8305
 Best site-USPS       | Epoch:2 | Val Acc: 0.7797
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 1.0745 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 1.0147 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 1.9942 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.9487 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 0.9789 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 1.0377 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.6897 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 1.6796 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.9125 | Train Acc: 0.3750
 Site-MNIST-M   | Train Loss: 1.7939 | Train Acc: 0.4318
 Site-MNIST     | Val  Loss: 1.1081 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 0.9786 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 1.9757 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.9495 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.0442 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.9891 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.7281 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 1.6473 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.7755 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.8472 | Val  Acc: 0.4237
Average Valid Accuracy: 0.5627
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3051
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.9231 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 0.8949 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 1.9440 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.8985 | Train Acc: 0.3864
 Site-USPS      | Train Loss: 0.8182 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.8916 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.5731 | Train Acc: 0.5114
 Site-SynthDigits| Train Loss: 1.5980 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.8122 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 1.7086 | Train Acc: 0.5114
 Site-MNIST     | Val  Loss: 0.9714 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 0.8363 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.9419 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.8828 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.8886 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.8359 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.6333 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.5474 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.6615 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.7447 | Val  Acc: 0.4915
Average Valid Accuracy: 0.5966
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3220
 Best site-USPS       | Epoch:4 | Val Acc: 0.8814
 Best site-USPS       | Epoch:4 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.8089 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 0.7975 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 1.9458 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.8329 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 0.7102 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.7666 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.5129 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 1.4723 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.6950 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.5958 | Train Acc: 0.5568
 Site-MNIST     | Val  Loss: 0.8580 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.7219 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.9003 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.8092 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.7675 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.7157 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.5491 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.4508 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.5604 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.6558 | Val  Acc: 0.5424
Average Valid Accuracy: 0.6153
 Best site-MNIST      | Epoch:5 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:5 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3220
 Best site-USPS       | Epoch:5 | Val Acc: 0.8983
 Best site-USPS       | Epoch:5 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.6955 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.6710 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 1.8581 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.7874 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 0.6636 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.6425 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.4380 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.4143 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.6061 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.5048 | Train Acc: 0.5909
 Site-MNIST     | Val  Loss: 0.7624 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.6371 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 1.8570 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.7452 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.6634 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.6124 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.4554 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.3701 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.4689 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.5698 | Val  Acc: 0.6102
Average Valid Accuracy: 0.6390
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:6 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3559
 Best site-USPS       | Epoch:6 | Val Acc: 0.9153
 Best site-USPS       | Epoch:6 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.6331 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.6613 | Train Acc: 0.8295
 Site-SVHN      | Train Loss: 1.8252 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.7139 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.5193 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.5952 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 1.3610 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.3298 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.5697 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.3919 | Train Acc: 0.6136
 Site-MNIST     | Val  Loss: 0.6930 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.5769 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.7883 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.6919 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 0.5916 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.5360 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.3597 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.2943 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.3907 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.4918 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6610
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:7 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3729
 Best site-USPS       | Epoch:7 | Val Acc: 0.9153
 Best site-USPS       | Epoch:7 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.5635 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.6022 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 1.7121 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.6656 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.4678 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.5007 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.2957 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.2053 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.4819 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.3654 | Train Acc: 0.6250
 Site-MNIST     | Val  Loss: 0.6270 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.5315 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.7434 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.6353 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 0.5355 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.4755 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.2527 | Val  Acc: 0.5593
 Site-SynthDigits| Val  Loss: 1.2481 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.3294 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.4206 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6746
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3729
 Best site-USPS       | Epoch:8 | Val Acc: 0.8983
 Best site-USPS       | Epoch:8 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5593
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.5135 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.5036 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.6665 | Train Acc: 0.3977
 Site-SVHN      | Train Loss: 1.5976 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.4186 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.4953 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.2221 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 1.1696 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.3949 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.3017 | Train Acc: 0.6591
 Site-MNIST     | Val  Loss: 0.5586 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.4776 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.6887 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.5757 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.4867 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.4307 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.1679 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 1.2132 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.2732 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.3350 | Val  Acc: 0.6780
Average Valid Accuracy: 0.7051
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4237
 Best site-USPS       | Epoch:9 | Val Acc: 0.8983
 Best site-USPS       | Epoch:9 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6780
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 50 ============
============ Train epoch 51 ============
============ Train epoch 52 ============
============ Train epoch 53 ============
============ Train epoch 54 ============
 Site-MNIST     | Train Loss: 0.4874 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4944 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.6246 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 1.5614 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 0.3892 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.4520 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.1809 | Train Acc: 0.5795
 Site-SynthDigits| Train Loss: 1.0815 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.2996 | Train Acc: 0.6477
 Site-MNIST-M   | Train Loss: 1.1994 | Train Acc: 0.7159
 Site-MNIST     | Val  Loss: 0.5088 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.4282 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.6339 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.5280 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.4335 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.3917 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.0922 | Val  Acc: 0.6780
 Site-SynthDigits| Val  Loss: 1.1568 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.2152 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 1.2420 | Val  Acc: 0.7458
Average Valid Accuracy: 0.7271
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:10 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:10 | Val Acc: 0.4746
 Best site-USPS       | Epoch:10 | Val Acc: 0.8983
 Best site-USPS       | Epoch:10 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.6780
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.7458
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 55 ============
============ Train epoch 56 ============
============ Train epoch 57 ============
============ Train epoch 58 ============
============ Train epoch 59 ============
 Site-MNIST     | Train Loss: 0.4579 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4206 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 1.6331 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 1.5070 | Train Acc: 0.4659
 Site-USPS      | Train Loss: 0.3657 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.3911 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.1050 | Train Acc: 0.6023
 Site-SynthDigits| Train Loss: 0.9942 | Train Acc: 0.6477
 Site-MNIST-M   | Train Loss: 1.2447 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.1669 | Train Acc: 0.7159
 Site-MNIST     | Val  Loss: 0.4668 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4021 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.5732 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.5003 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.3977 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.3690 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.0269 | Val  Acc: 0.6780
 Site-SynthDigits| Val  Loss: 1.1199 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.1593 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.1407 | Val  Acc: 0.7627
Average Valid Accuracy: 0.7271
============ Train epoch 60 ============
============ Train epoch 61 ============
============ Train epoch 62 ============
============ Train epoch 63 ============
============ Train epoch 64 ============
 Site-MNIST     | Train Loss: 0.4268 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.3779 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.5184 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.4469 | Train Acc: 0.5114
 Site-USPS      | Train Loss: 0.3121 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.3769 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.0771 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 0.9519 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.1590 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.0523 | Train Acc: 0.7614
 Site-MNIST     | Val  Loss: 0.4327 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.3747 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.5283 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.4573 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.3642 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.3426 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.9595 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 1.0770 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.1050 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 1.0659 | Val  Acc: 0.7966
Average Valid Accuracy: 0.7407
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:12 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:12 | Val Acc: 0.4746
 Best site-USPS       | Epoch:12 | Val Acc: 0.9322
 Best site-USPS       | Epoch:12 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.7966
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 65 ============
============ Train epoch 66 ============
============ Train epoch 67 ============
============ Train epoch 68 ============
============ Train epoch 69 ============
 Site-MNIST     | Train Loss: 0.4115 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.3551 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 1.5115 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.4145 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 0.3284 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.3669 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.9622 | Train Acc: 0.6477
 Site-SynthDigits| Train Loss: 0.9219 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 1.1204 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 1.0180 | Train Acc: 0.7727
 Site-MNIST     | Val  Loss: 0.3978 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.3493 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.4777 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.4167 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 0.3385 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.3218 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.8972 | Val  Acc: 0.7627
 Site-SynthDigits| Val  Loss: 1.0332 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 1.0521 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 1.0075 | Val  Acc: 0.8305
Average Valid Accuracy: 0.7610
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:13 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:13 | Val Acc: 0.5085
 Best site-USPS       | Epoch:13 | Val Acc: 0.9322
 Best site-USPS       | Epoch:13 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.7627
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.8305
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 70 ============
============ Train epoch 71 ============
============ Train epoch 72 ============
============ Train epoch 73 ============
============ Train epoch 74 ============
 Site-MNIST     | Train Loss: 0.3389 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.3582 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 1.4709 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.2973 | Train Acc: 0.5909
 Site-USPS      | Train Loss: 0.3057 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.3494 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.9248 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 0.8351 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 1.0447 | Train Acc: 0.7386
 Site-MNIST-M   | Train Loss: 0.9393 | Train Acc: 0.7841
 Site-MNIST     | Val  Loss: 0.3746 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3274 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.4108 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.3657 | Val  Acc: 0.5254
 Site-USPS      | Val  Loss: 0.3197 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.3004 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.8293 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 0.9794 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 0.9966 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 0.9490 | Val  Acc: 0.8305
Average Valid Accuracy: 0.7763
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:14 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:14 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:14 | Val Acc: 0.5254
 Best site-USPS       | Epoch:14 | Val Acc: 0.9322
 Best site-USPS       | Epoch:14 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.7288
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.8305
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 75 ============
============ Train epoch 76 ============
============ Train epoch 77 ============
============ Train epoch 78 ============
============ Train epoch 79 ============
 Site-MNIST     | Train Loss: 0.3430 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.3145 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.4781 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.3271 | Train Acc: 0.5795
 Site-USPS      | Train Loss: 0.2597 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.3118 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.8936 | Train Acc: 0.7159
 Site-SynthDigits| Train Loss: 0.8226 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 0.9845 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 0.9291 | Train Acc: 0.7955
 Site-MNIST     | Val  Loss: 0.3500 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3098 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.3575 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.3460 | Val  Acc: 0.5424
 Site-USPS      | Val  Loss: 0.2962 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.2865 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.7891 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 0.9544 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 0.9380 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 0.8926 | Val  Acc: 0.8305
Average Valid Accuracy: 0.7983
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:15 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:15 | Val Acc: 0.5424
 Best site-USPS       | Epoch:15 | Val Acc: 0.9492
 Best site-USPS       | Epoch:15 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.7458
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.8305
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 80 ============
============ Train epoch 81 ============
============ Train epoch 82 ============
============ Train epoch 83 ============
============ Train epoch 84 ============
 Site-MNIST     | Train Loss: 0.3085 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.2877 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.4427 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.2399 | Train Acc: 0.6250
 Site-USPS      | Train Loss: 0.2698 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.2854 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.8456 | Train Acc: 0.7386
 Site-SynthDigits| Train Loss: 0.7694 | Train Acc: 0.8295
 Site-MNIST-M   | Train Loss: 0.9778 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 0.8614 | Train Acc: 0.8523
 Site-MNIST     | Val  Loss: 0.3265 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2903 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.2963 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.3128 | Val  Acc: 0.5424
 Site-USPS      | Val  Loss: 0.2734 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.2721 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.7346 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 0.9214 | Val  Acc: 0.7627
 Site-MNIST-M   | Val  Loss: 0.8804 | Val  Acc: 0.7966
 Site-MNIST-M   | Val  Loss: 0.8452 | Val  Acc: 0.8305
Average Valid Accuracy: 0.8085
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:16 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:16 | Val Acc: 0.5424
 Best site-USPS       | Epoch:16 | Val Acc: 0.9492
 Best site-USPS       | Epoch:16 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.7627
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.7966
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.8305
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 85 ============
============ Train epoch 86 ============
============ Train epoch 87 ============
============ Train epoch 88 ============
============ Train epoch 89 ============
 Site-MNIST     | Train Loss: 0.3002 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.2552 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.4328 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.1817 | Train Acc: 0.6364
 Site-USPS      | Train Loss: 0.2480 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.2787 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.8364 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 0.7275 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.9678 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 0.7775 | Train Acc: 0.8750
 Site-MNIST     | Val  Loss: 0.2973 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2723 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.2564 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 1.2819 | Val  Acc: 0.5593
 Site-USPS      | Val  Loss: 0.2577 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.2620 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.7010 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 0.9037 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 0.8348 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 0.8034 | Val  Acc: 0.8136
Average Valid Accuracy: 0.8169
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:17 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:17 | Val Acc: 0.5593
 Best site-USPS       | Epoch:17 | Val Acc: 0.9492
 Best site-USPS       | Epoch:17 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.7288
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.8305
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.8136
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 90 ============
============ Train epoch 91 ============
============ Train epoch 92 ============
============ Train epoch 93 ============
============ Train epoch 94 ============
 Site-MNIST     | Train Loss: 0.2685 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.2580 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.4139 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.1393 | Train Acc: 0.6932
 Site-USPS      | Train Loss: 0.2435 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.2654 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.7957 | Train Acc: 0.7614
 Site-SynthDigits| Train Loss: 0.6919 | Train Acc: 0.8295
 Site-MNIST-M   | Train Loss: 0.8726 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 0.7682 | Train Acc: 0.8750
 Site-MNIST     | Val  Loss: 0.2726 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2529 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.2072 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 1.2363 | Val  Acc: 0.5932
 Site-USPS      | Val  Loss: 0.2444 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.2478 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.6651 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 0.8712 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 0.8082 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 0.7673 | Val  Acc: 0.8136
Average Valid Accuracy: 0.8203
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:18 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:18 | Val Acc: 0.5932
 Best site-USPS       | Epoch:18 | Val Acc: 0.9492
 Best site-USPS       | Epoch:18 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.7288
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.8305
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.8136
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 95 ============
============ Train epoch 96 ============
============ Train epoch 97 ============
============ Train epoch 98 ============
============ Train epoch 99 ============
 Site-MNIST     | Train Loss: 0.2494 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.2494 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.3606 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 1.0646 | Train Acc: 0.6591
 Site-USPS      | Train Loss: 0.2111 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.2571 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.7627 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.6994 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.8349 | Train Acc: 0.7841
 Site-MNIST-M   | Train Loss: 0.7626 | Train Acc: 0.8864
 Site-MNIST     | Val  Loss: 0.2559 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2331 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.1680 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 1.1900 | Val  Acc: 0.6102
 Site-USPS      | Val  Loss: 0.2302 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.2269 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.6299 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 0.8322 | Val  Acc: 0.7627
 Site-MNIST-M   | Val  Loss: 0.7761 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 0.7404 | Val  Acc: 0.8136
Average Valid Accuracy: 0.8237
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:19 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:19 | Val Acc: 0.6102
 Best site-USPS       | Epoch:19 | Val Acc: 0.9492
 Best site-USPS       | Epoch:19 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.7627
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.8305
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.8136
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 100 ============
============ Train epoch 101 ============
============ Train epoch 102 ============
============ Train epoch 103 ============
============ Train epoch 104 ============
 Site-MNIST     | Train Loss: 0.2619 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2094 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.3257 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 1.0382 | Train Acc: 0.6705
 Site-USPS      | Train Loss: 0.2379 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.2317 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.7342 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.6525 | Train Acc: 0.8295
 Site-MNIST-M   | Train Loss: 0.8254 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 0.7037 | Train Acc: 0.9091
 Site-MNIST     | Val  Loss: 0.2375 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2220 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.1186 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 1.1739 | Val  Acc: 0.6271
 Site-USPS      | Val  Loss: 0.2099 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.2231 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.5936 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 0.8126 | Val  Acc: 0.7627
 Site-MNIST-M   | Val  Loss: 0.7441 | Val  Acc: 0.8644
 Site-MNIST-M   | Val  Loss: 0.7057 | Val  Acc: 0.8475
Average Valid Accuracy: 0.8390
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:20 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:20 | Val Acc: 0.6271
 Best site-USPS       | Epoch:20 | Val Acc: 0.9492
 Best site-USPS       | Epoch:20 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.7627
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.8644
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.8475
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 105 ============
============ Train epoch 106 ============
============ Train epoch 107 ============
============ Train epoch 108 ============
============ Train epoch 109 ============
 Site-MNIST     | Train Loss: 0.2410 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.2003 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.3245 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.0888 | Train Acc: 0.6932
 Site-USPS      | Train Loss: 0.2326 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.2247 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.6880 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 0.6191 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.7917 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 0.6885 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.2286 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2208 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.0788 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 1.1525 | Val  Acc: 0.6271
 Site-USPS      | Val  Loss: 0.2072 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.2221 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.5638 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 0.8040 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 0.6929 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.6649 | Val  Acc: 0.8475
Average Valid Accuracy: 0.8441
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:21 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:21 | Val Acc: 0.6271
 Best site-USPS       | Epoch:21 | Val Acc: 0.9492
 Best site-USPS       | Epoch:21 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.7458
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.8475
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 110 ============
============ Train epoch 111 ============
============ Train epoch 112 ============
============ Train epoch 113 ============
============ Train epoch 114 ============
 Site-MNIST     | Train Loss: 0.2294 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1840 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.2899 | Train Acc: 0.5341
 Site-SVHN      | Train Loss: 0.9813 | Train Acc: 0.6818
 Site-USPS      | Train Loss: 0.2109 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.2419 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.7074 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.6142 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.7444 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 0.6293 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.2098 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2052 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.0323 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 1.1016 | Val  Acc: 0.6441
 Site-USPS      | Val  Loss: 0.1933 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.2173 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.5390 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 0.7740 | Val  Acc: 0.7627
 Site-MNIST-M   | Val  Loss: 0.6793 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.6388 | Val  Acc: 0.8814
Average Valid Accuracy: 0.8576
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:22 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:22 | Val Acc: 0.6441
 Best site-USPS       | Epoch:22 | Val Acc: 0.9492
 Best site-USPS       | Epoch:22 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.7627
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.8814
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 115 ============
============ Train epoch 116 ============
============ Train epoch 117 ============
============ Train epoch 118 ============
============ Train epoch 119 ============
 Site-MNIST     | Train Loss: 0.2326 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1746 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.2545 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 0.9735 | Train Acc: 0.7045
 Site-USPS      | Train Loss: 0.2127 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.2072 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.7068 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.5914 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 0.6976 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.6075 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.1916 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1938 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.9930 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 1.0937 | Val  Acc: 0.6441
 Site-USPS      | Val  Loss: 0.1794 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.2175 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.5194 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 0.7521 | Val  Acc: 0.7966
 Site-MNIST-M   | Val  Loss: 0.6534 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.6101 | Val  Acc: 0.8983
Average Valid Accuracy: 0.8661
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:23 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:23 | Val Acc: 0.6441
 Best site-USPS       | Epoch:23 | Val Acc: 0.9492
 Best site-USPS       | Epoch:23 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.7966
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.8983
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 120 ============
============ Train epoch 121 ============
============ Train epoch 122 ============
============ Train epoch 123 ============
============ Train epoch 124 ============
 Site-MNIST     | Train Loss: 0.1928 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1590 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.2348 | Train Acc: 0.5909
 Site-SVHN      | Train Loss: 0.9179 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 0.2138 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.2241 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.6229 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 0.5457 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.6781 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 0.5993 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.1792 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1797 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.9567 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 1.0619 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 0.1696 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.2037 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4987 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 0.7280 | Val  Acc: 0.7627
 Site-MNIST-M   | Val  Loss: 0.6247 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.5854 | Val  Acc: 0.8983
Average Valid Accuracy: 0.8729
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:24 | Val Acc: 0.7288
 Best site-SVHN       | Epoch:24 | Val Acc: 0.6610
 Best site-USPS       | Epoch:24 | Val Acc: 0.9661
 Best site-USPS       | Epoch:24 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.7627
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.8983
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 125 ============
============ Train epoch 126 ============
============ Train epoch 127 ============
============ Train epoch 128 ============
============ Train epoch 129 ============
 Site-MNIST     | Train Loss: 0.1980 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1504 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.2235 | Train Acc: 0.6023
 Site-SVHN      | Train Loss: 0.8782 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 0.1831 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1975 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.5844 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.5036 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.6513 | Train Acc: 0.8295
 Site-MNIST-M   | Train Loss: 0.5409 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.1701 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1750 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.9336 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 1.0377 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 0.1607 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.1952 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4663 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 0.7072 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 0.5966 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.5572 | Val  Acc: 0.9153
Average Valid Accuracy: 0.8746
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:25 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:25 | Val Acc: 0.6780
 Best site-USPS       | Epoch:25 | Val Acc: 0.9492
 Best site-USPS       | Epoch:25 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.9153
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 130 ============
============ Train epoch 131 ============
============ Train epoch 132 ============
============ Train epoch 133 ============
============ Train epoch 134 ============
 Site-MNIST     | Train Loss: 0.1738 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1388 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.1809 | Train Acc: 0.6136
 Site-SVHN      | Train Loss: 0.8698 | Train Acc: 0.7273
 Site-USPS      | Train Loss: 0.1801 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1824 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.6097 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.4891 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 0.6203 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 0.5508 | Train Acc: 0.9091
 Site-MNIST     | Val  Loss: 0.1560 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1642 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.8963 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 1.0146 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 0.1512 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1968 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4582 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 0.6917 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 0.5798 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.5369 | Val  Acc: 0.9153
Average Valid Accuracy: 0.8797
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:26 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:26 | Val Acc: 0.6780
 Best site-USPS       | Epoch:26 | Val Acc: 0.9661
 Best site-USPS       | Epoch:26 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.9153
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 135 ============
============ Train epoch 136 ============
============ Train epoch 137 ============
============ Train epoch 138 ============
============ Train epoch 139 ============
 Site-MNIST     | Train Loss: 0.1714 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1343 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.1970 | Train Acc: 0.5795
 Site-SVHN      | Train Loss: 0.8359 | Train Acc: 0.7500
 Site-USPS      | Train Loss: 0.1712 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1721 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.5466 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.4779 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.5997 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 0.5156 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.1440 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1551 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.8734 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 1.0039 | Val  Acc: 0.6949
 Site-USPS      | Val  Loss: 0.1433 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.1914 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4314 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.6653 | Val  Acc: 0.7966
 Site-MNIST-M   | Val  Loss: 0.5562 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.5125 | Val  Acc: 0.9153
Average Valid Accuracy: 0.8864
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:27 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:27 | Val Acc: 0.6949
 Best site-USPS       | Epoch:27 | Val Acc: 0.9492
 Best site-USPS       | Epoch:27 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.7966
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.9153
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 140 ============
============ Train epoch 141 ============
============ Train epoch 142 ============
============ Train epoch 143 ============
============ Train epoch 144 ============
 Site-MNIST     | Train Loss: 0.1769 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1255 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.1401 | Train Acc: 0.6250
 Site-SVHN      | Train Loss: 0.8279 | Train Acc: 0.7500
 Site-USPS      | Train Loss: 0.1698 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1842 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.5679 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.4821 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.5925 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 0.5008 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.1361 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1485 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.8474 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 0.9896 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 0.1419 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1810 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4187 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.6635 | Val  Acc: 0.7966
 Site-MNIST-M   | Val  Loss: 0.5338 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.4953 | Val  Acc: 0.9322
Average Valid Accuracy: 0.8881
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:28 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:28 | Val Acc: 0.6780
 Best site-USPS       | Epoch:28 | Val Acc: 0.9661
 Best site-USPS       | Epoch:28 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.7966
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.9322
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 145 ============
============ Train epoch 146 ============
============ Train epoch 147 ============
============ Train epoch 148 ============
============ Train epoch 149 ============
 Site-MNIST     | Train Loss: 0.1550 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1166 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.1061 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 0.7758 | Train Acc: 0.7500
 Site-USPS      | Train Loss: 0.1737 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1675 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.5062 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 0.4674 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.5524 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.4552 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.1284 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1414 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.8211 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 0.9618 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 0.1370 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1779 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4034 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.6370 | Val  Acc: 0.8136
 Site-MNIST-M   | Val  Loss: 0.5086 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.4758 | Val  Acc: 0.9322
Average Valid Accuracy: 0.8915
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:29 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:29 | Val Acc: 0.6780
 Best site-USPS       | Epoch:29 | Val Acc: 0.9661
 Best site-USPS       | Epoch:29 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.8136
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.9322
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 150 ============
============ Train epoch 151 ============
============ Train epoch 152 ============
============ Train epoch 153 ============
============ Train epoch 154 ============
 Site-MNIST     | Train Loss: 0.1417 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1131 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.0567 | Train Acc: 0.6023
 Site-SVHN      | Train Loss: 0.8085 | Train Acc: 0.7500
 Site-USPS      | Train Loss: 0.1440 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1560 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.5326 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.4476 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.5645 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 0.4540 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.1212 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1304 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.7946 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 0.9470 | Val  Acc: 0.6949
 Site-USPS      | Val  Loss: 0.1261 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1689 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.3893 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.6175 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 0.4927 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.4531 | Val  Acc: 0.9492
Average Valid Accuracy: 0.8983
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:30 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:30 | Val Acc: 0.6949
 Best site-USPS       | Epoch:30 | Val Acc: 0.9661
 Best site-USPS       | Epoch:30 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.8305
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.9492
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 155 ============
============ Train epoch 156 ============
============ Train epoch 157 ============
============ Train epoch 158 ============
============ Train epoch 159 ============
 Site-MNIST     | Train Loss: 0.1458 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1101 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.0976 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 0.7344 | Train Acc: 0.7727
 Site-USPS      | Train Loss: 0.1505 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1526 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.4727 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.4159 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.5427 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.4297 | Train Acc: 0.9545
 Site-MNIST     | Val  Loss: 0.1154 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1240 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.7765 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 0.9360 | Val  Acc: 0.6949
 Site-USPS      | Val  Loss: 0.1234 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1656 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.3727 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.5952 | Val  Acc: 0.8644
 Site-MNIST-M   | Val  Loss: 0.4748 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.4321 | Val  Acc: 0.9661
Average Valid Accuracy: 0.9034
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:31 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:31 | Val Acc: 0.6949
 Best site-USPS       | Epoch:31 | Val Acc: 0.9661
 Best site-USPS       | Epoch:31 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.8644
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.9661
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 160 ============
============ Train epoch 161 ============
============ Train epoch 162 ============
============ Train epoch 163 ============
============ Train epoch 164 ============
 Site-MNIST     | Train Loss: 0.1238 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1008 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.0657 | Train Acc: 0.6818
 Site-SVHN      | Train Loss: 0.7773 | Train Acc: 0.7955
 Site-USPS      | Train Loss: 0.1550 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1506 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.4558 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.4142 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.4964 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.4062 | Train Acc: 0.9545
 Site-MNIST     | Val  Loss: 0.1106 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1161 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.7606 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 0.9151 | Val  Acc: 0.6949
 Site-USPS      | Val  Loss: 0.1173 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.1634 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.3616 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.5747 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.4510 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.4112 | Val  Acc: 0.9661
Average Valid Accuracy: 0.9034
============ Train epoch 165 ============
============ Train epoch 166 ============
============ Train epoch 167 ============
============ Train epoch 168 ============
============ Train epoch 169 ============
 Site-MNIST     | Train Loss: 0.1221 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0949 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.0268 | Train Acc: 0.6818
 Site-SVHN      | Train Loss: 0.7322 | Train Acc: 0.7727
 Site-USPS      | Train Loss: 0.1416 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1438 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.4476 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.4072 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.5024 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.4229 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.1029 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1107 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.7409 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 0.9106 | Val  Acc: 0.7119
 Site-USPS      | Val  Loss: 0.1104 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.1583 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.3470 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.5617 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.4376 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.3985 | Val  Acc: 0.9661
Average Valid Accuracy: 0.9085
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:33 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:33 | Val Acc: 0.7119
 Best site-USPS       | Epoch:33 | Val Acc: 0.9831
 Best site-USPS       | Epoch:33 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.8475
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.9661
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 170 ============
============ Train epoch 171 ============
============ Train epoch 172 ============
============ Train epoch 173 ============
============ Train epoch 174 ============
 Site-MNIST     | Train Loss: 0.1180 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0878 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.0132 | Train Acc: 0.6705
 Site-SVHN      | Train Loss: 0.7228 | Train Acc: 0.8068
 Site-USPS      | Train Loss: 0.1354 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1389 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.4658 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.3774 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.4679 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.3979 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.0979 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1051 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7250 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 0.8929 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 0.1061 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1588 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.3354 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.5454 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 0.4223 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.3797 | Val  Acc: 0.9661
Average Valid Accuracy: 0.9169
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:34 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:34 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:34 | Val Acc: 0.7288
 Best site-USPS       | Epoch:34 | Val Acc: 1.0000
 Best site-USPS       | Epoch:34 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.8305
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.9661
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 175 ============
============ Train epoch 176 ============
============ Train epoch 177 ============
============ Train epoch 178 ============
============ Train epoch 179 ============
 Site-MNIST     | Train Loss: 0.1151 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0899 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.9754 | Train Acc: 0.6477
 Site-SVHN      | Train Loss: 0.7007 | Train Acc: 0.7841
 Site-USPS      | Train Loss: 0.1238 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1440 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.4226 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.4068 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.4799 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.3812 | Train Acc: 0.9545
 Site-MNIST     | Val  Loss: 0.0944 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0985 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7105 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 0.8775 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 0.1052 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1478 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.3238 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.5344 | Val  Acc: 0.8644
 Site-MNIST-M   | Val  Loss: 0.4099 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.3666 | Val  Acc: 0.9831
Average Valid Accuracy: 0.9203
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:35 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:35 | Val Acc: 0.7288
 Best site-USPS       | Epoch:35 | Val Acc: 0.9661
 Best site-USPS       | Epoch:35 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.8644
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.9831
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 180 ============
============ Train epoch 181 ============
============ Train epoch 182 ============
============ Train epoch 183 ============
============ Train epoch 184 ============
 Site-MNIST     | Train Loss: 0.1125 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0892 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.9786 | Train Acc: 0.6818
 Site-SVHN      | Train Loss: 0.6659 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 0.1186 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1532 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.4389 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.3566 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.4440 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.3623 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.0897 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0951 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6899 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 0.8572 | Val  Acc: 0.7458
 Site-USPS      | Val  Loss: 0.1011 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.1459 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.3108 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.5145 | Val  Acc: 0.8644
 Site-MNIST-M   | Val  Loss: 0.3980 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.3559 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9271
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:36 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:36 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:36 | Val Acc: 0.7458
 Best site-USPS       | Epoch:36 | Val Acc: 0.9831
 Best site-USPS       | Epoch:36 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.8644
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:36 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 185 ============
============ Train epoch 186 ============
============ Train epoch 187 ============
============ Train epoch 188 ============
============ Train epoch 189 ============
 Site-MNIST     | Train Loss: 0.1040 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0809 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.9520 | Train Acc: 0.6818
 Site-SVHN      | Train Loss: 0.6222 | Train Acc: 0.7955
 Site-USPS      | Train Loss: 0.1167 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1286 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.4163 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.3422 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.4272 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.3451 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.0877 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0905 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6786 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 0.8486 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 0.0981 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.1415 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.3079 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.5111 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.3789 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.3400 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9271
============ Train epoch 190 ============
============ Train epoch 191 ============
============ Train epoch 192 ============
============ Train epoch 193 ============
============ Train epoch 194 ============
 Site-MNIST     | Train Loss: 0.0948 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0712 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.9662 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 0.6367 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 0.1119 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1317 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.3920 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.3387 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.4360 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.3271 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.0841 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0846 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6488 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 0.8284 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 0.0924 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.1345 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2983 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.4887 | Val  Acc: 0.8814
 Site-MNIST-M   | Val  Loss: 0.3705 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.3297 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9373
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:38 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:38 | Val Acc: 0.7627
 Best site-USPS       | Epoch:38 | Val Acc: 0.9831
 Best site-USPS       | Epoch:38 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.8814
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:38 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_1/CoCoOP...
============ Train epoch 195 ============
============ Train epoch 196 ============
============ Train epoch 197 ============
============ Train epoch 198 ============
============ Train epoch 199 ============
 Site-MNIST     | Train Loss: 0.0929 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0679 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.9392 | Train Acc: 0.7045
 Site-SVHN      | Train Loss: 0.6298 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 0.1271 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1226 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.3882 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.3169 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.3972 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.3231 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.0796 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0820 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6439 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 0.8263 | Val  Acc: 0.7458
 Site-USPS      | Val  Loss: 0.0916 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1374 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2886 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.4857 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.3460 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.3117 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9305
===2023-04-01 12:39:51===
===2023-04-01 12:39:53===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:38 | Test Acc: 0.8929
 Test site-SVHN      | Epoch:38 | Test Acc: 0.5370
 Test site-USPS      | Epoch:38 | Test Acc: 0.9086
 Test site-SynthDigits| Epoch:38 | Test Acc: 0.7832
 Test site-MNIST-M   | Epoch:38 | Test Acc: 0.6029
Average Test Accuracy: 0.7449
