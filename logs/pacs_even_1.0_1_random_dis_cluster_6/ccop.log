===2023-08-10 23:48:45===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (3) | Train Loss: 1.6158 | Train Acc: 0.5733
 Site-photo                     (3) | Train Loss: 1.4886 | Train Acc: 0.6311
 Site-art_painting              (4) | Train Loss: 1.7779 | Train Acc: 0.2933
 Site-art_painting              (1) | Train Loss: 1.6805 | Train Acc: 0.4022
 Site-cartoon                   (2) | Train Loss: 1.7684 | Train Acc: 0.3333
 Site-cartoon                   (5) | Train Loss: 1.7106 | Train Acc: 0.3156
 Site-sketch                    (0) | Train Loss: 1.7783 | Train Acc: 0.2267
 Site-sketch                    (0) | Train Loss: 1.7646 | Train Acc: 0.2467
Average Train Accuracy: 0.3778
 Site-photo                     (3) | Val  Loss: 1.5287 | Val  Acc: 0.6600
 Site-photo                     (3) | Val  Loss: 1.5713 | Val  Acc: 0.6200
 Site-art_painting              (4) | Val  Loss: 1.6422 | Val  Acc: 0.4500
 Site-art_painting              (1) | Val  Loss: 1.6794 | Val  Acc: 0.4267
 Site-cartoon                   (2) | Val  Loss: 1.7516 | Val  Acc: 0.2700
 Site-cartoon                   (5) | Val  Loss: 1.7579 | Val  Acc: 0.3333
 Site-sketch                    (0) | Val  Loss: 1.7498 | Val  Acc: 0.3100
 Site-sketch                    (0) | Val  Loss: 1.7667 | Val  Acc: 0.2500
Average Valid Accuracy: 0.4150
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.6600
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.6200
 Best site-art_painting             (4)  | Epoch:0 | Val Acc: 0.4500
 Best site-art_painting             (1)  | Epoch:0 | Val Acc: 0.4267
 Best site-cartoon                  (2)  | Epoch:0 | Val Acc: 0.2700
 Best site-cartoon                  (5)  | Epoch:0 | Val Acc: 0.3333
 Best site-sketch                   (0)  | Epoch:0 | Val Acc: 0.3100
 Best site-sketch                   (0)  | Epoch:0 | Val Acc: 0.2500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (0) | Train Loss: 1.2733 | Train Acc: 0.7667
 Site-photo                     (0) | Train Loss: 1.2221 | Train Acc: 0.8133
 Site-art_painting              (3) | Train Loss: 1.5655 | Train Acc: 0.5267
 Site-art_painting              (3) | Train Loss: 1.4968 | Train Acc: 0.5489
 Site-cartoon                   (2) | Train Loss: 1.5771 | Train Acc: 0.4400
 Site-cartoon                   (5) | Train Loss: 1.5658 | Train Acc: 0.5111
 Site-sketch                    (1) | Train Loss: 1.6711 | Train Acc: 0.3800
 Site-sketch                    (4) | Train Loss: 1.6099 | Train Acc: 0.3800
Average Train Accuracy: 0.5458
 Site-photo                     (0) | Val  Loss: 1.2049 | Val  Acc: 0.8600
 Site-photo                     (0) | Val  Loss: 1.2515 | Val  Acc: 0.8033
 Site-art_painting              (3) | Val  Loss: 1.4530 | Val  Acc: 0.5600
 Site-art_painting              (3) | Val  Loss: 1.4677 | Val  Acc: 0.5633
 Site-cartoon                   (2) | Val  Loss: 1.5350 | Val  Acc: 0.5400
 Site-cartoon                   (5) | Val  Loss: 1.5316 | Val  Acc: 0.5000
 Site-sketch                    (1) | Val  Loss: 1.5860 | Val  Acc: 0.3800
 Site-sketch                    (4) | Val  Loss: 1.5748 | Val  Acc: 0.4000
Average Valid Accuracy: 0.5758
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.8600
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.8033
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.5600
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.5633
 Best site-cartoon                  (2)  | Epoch:1 | Val Acc: 0.5400
 Best site-cartoon                  (5)  | Epoch:1 | Val Acc: 0.5000
 Best site-sketch                   (1)  | Epoch:1 | Val Acc: 0.3800
 Best site-sketch                   (4)  | Epoch:1 | Val Acc: 0.4000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (3) | Train Loss: 1.0316 | Train Acc: 0.9133
 Site-photo                     (3) | Train Loss: 1.0203 | Train Acc: 0.9067
 Site-art_painting              (5) | Train Loss: 1.3381 | Train Acc: 0.5933
 Site-art_painting              (0) | Train Loss: 1.2255 | Train Acc: 0.7044
 Site-cartoon                   (2) | Train Loss: 1.4369 | Train Acc: 0.5467
 Site-cartoon                   (4) | Train Loss: 1.3409 | Train Acc: 0.6089
 Site-sketch                    (1) | Train Loss: 1.4796 | Train Acc: 0.4467
 Site-sketch                    (1) | Train Loss: 1.4390 | Train Acc: 0.4533
Average Train Accuracy: 0.6467
 Site-photo                     (3) | Val  Loss: 0.9695 | Val  Acc: 0.9000
 Site-photo                     (3) | Val  Loss: 0.9838 | Val  Acc: 0.8933
 Site-art_painting              (5) | Val  Loss: 1.1976 | Val  Acc: 0.7700
 Site-art_painting              (0) | Val  Loss: 1.2393 | Val  Acc: 0.7100
 Site-cartoon                   (2) | Val  Loss: 1.4108 | Val  Acc: 0.6000
 Site-cartoon                   (4) | Val  Loss: 1.3538 | Val  Acc: 0.6433
 Site-sketch                    (1) | Val  Loss: 1.4280 | Val  Acc: 0.5200
 Site-sketch                    (1) | Val  Loss: 1.4671 | Val  Acc: 0.4733
Average Valid Accuracy: 0.6887
 Best site-photo                    (3)  | Epoch:2 | Val Acc: 0.9000
 Best site-photo                    (3)  | Epoch:2 | Val Acc: 0.8933
 Best site-art_painting             (5)  | Epoch:2 | Val Acc: 0.7700
 Best site-art_painting             (0)  | Epoch:2 | Val Acc: 0.7100
 Best site-cartoon                  (2)  | Epoch:2 | Val Acc: 0.6000
 Best site-cartoon                  (4)  | Epoch:2 | Val Acc: 0.6433
 Best site-sketch                   (1)  | Epoch:2 | Val Acc: 0.5200
 Best site-sketch                   (1)  | Epoch:2 | Val Acc: 0.4733
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (1) | Train Loss: 0.8360 | Train Acc: 0.9333
 Site-photo                     (1) | Train Loss: 0.7684 | Train Acc: 0.9444
 Site-art_painting              (3) | Train Loss: 1.1420 | Train Acc: 0.6933
 Site-art_painting              (3) | Train Loss: 1.1860 | Train Acc: 0.7778
 Site-cartoon                   (4) | Train Loss: 1.2655 | Train Acc: 0.6333
 Site-cartoon                   (2) | Train Loss: 1.1383 | Train Acc: 0.6933
 Site-sketch                    (0) | Train Loss: 1.4271 | Train Acc: 0.4600
 Site-sketch                    (5) | Train Loss: 1.3149 | Train Acc: 0.5356
Average Train Accuracy: 0.7089
 Site-photo                     (1) | Val  Loss: 0.7595 | Val  Acc: 0.9400
 Site-photo                     (1) | Val  Loss: 0.7747 | Val  Acc: 0.9533
 Site-art_painting              (3) | Val  Loss: 1.0200 | Val  Acc: 0.8600
 Site-art_painting              (3) | Val  Loss: 1.0871 | Val  Acc: 0.7733
 Site-cartoon                   (4) | Val  Loss: 1.2093 | Val  Acc: 0.7100
 Site-cartoon                   (2) | Val  Loss: 1.1902 | Val  Acc: 0.6767
 Site-sketch                    (0) | Val  Loss: 1.3303 | Val  Acc: 0.4700
 Site-sketch                    (5) | Val  Loss: 1.3284 | Val  Acc: 0.5067
Average Valid Accuracy: 0.7362
 Best site-photo                    (1)  | Epoch:3 | Val Acc: 0.9400
 Best site-photo                    (1)  | Epoch:3 | Val Acc: 0.9533
 Best site-art_painting             (3)  | Epoch:3 | Val Acc: 0.8600
 Best site-art_painting             (3)  | Epoch:3 | Val Acc: 0.7733
 Best site-cartoon                  (4)  | Epoch:3 | Val Acc: 0.7100
 Best site-cartoon                  (2)  | Epoch:3 | Val Acc: 0.6767
 Best site-sketch                   (0)  | Epoch:3 | Val Acc: 0.4700
 Best site-sketch                   (5)  | Epoch:3 | Val Acc: 0.5067
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (0) | Train Loss: 0.6996 | Train Acc: 0.9333
 Site-photo                     (0) | Train Loss: 0.6474 | Train Acc: 0.9689
 Site-art_painting              (5) | Train Loss: 1.0009 | Train Acc: 0.7733
 Site-art_painting              (3) | Train Loss: 0.9696 | Train Acc: 0.8178
 Site-cartoon                   (2) | Train Loss: 1.0912 | Train Acc: 0.6933
 Site-cartoon                   (4) | Train Loss: 0.9863 | Train Acc: 0.6911
 Site-sketch                    (1) | Train Loss: 1.2182 | Train Acc: 0.5867
 Site-sketch                    (1) | Train Loss: 1.1399 | Train Acc: 0.5911
Average Train Accuracy: 0.7569
 Site-photo                     (0) | Val  Loss: 0.6178 | Val  Acc: 0.9500
 Site-photo                     (0) | Val  Loss: 0.6600 | Val  Acc: 0.9467
 Site-art_painting              (5) | Val  Loss: 0.9280 | Val  Acc: 0.8400
 Site-art_painting              (3) | Val  Loss: 0.8899 | Val  Acc: 0.8200
 Site-cartoon                   (2) | Val  Loss: 1.0494 | Val  Acc: 0.6700
 Site-cartoon                   (4) | Val  Loss: 1.0306 | Val  Acc: 0.7167
 Site-sketch                    (1) | Val  Loss: 1.1397 | Val  Acc: 0.6500
 Site-sketch                    (1) | Val  Loss: 1.1822 | Val  Acc: 0.6000
Average Valid Accuracy: 0.7742
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9500
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9467
 Best site-art_painting             (5)  | Epoch:4 | Val Acc: 0.8400
 Best site-art_painting             (3)  | Epoch:4 | Val Acc: 0.8200
 Best site-cartoon                  (2)  | Epoch:4 | Val Acc: 0.6700
 Best site-cartoon                  (4)  | Epoch:4 | Val Acc: 0.7167
 Best site-sketch                   (1)  | Epoch:4 | Val Acc: 0.6500
 Best site-sketch                   (1)  | Epoch:4 | Val Acc: 0.6000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (2) | Train Loss: 0.6031 | Train Acc: 0.9600
 Site-photo                     (5) | Train Loss: 0.5302 | Train Acc: 0.9578
 Site-art_painting              (4) | Train Loss: 0.8431 | Train Acc: 0.8200
 Site-art_painting              (3) | Train Loss: 0.8088 | Train Acc: 0.8467
 Site-cartoon                   (0) | Train Loss: 0.9825 | Train Acc: 0.7267
 Site-cartoon                   (0) | Train Loss: 0.9264 | Train Acc: 0.7422
 Site-sketch                    (1) | Train Loss: 1.1093 | Train Acc: 0.6200
 Site-sketch                    (1) | Train Loss: 1.1029 | Train Acc: 0.6511
Average Train Accuracy: 0.7906
 Site-photo                     (2) | Val  Loss: 0.4962 | Val  Acc: 0.9300
 Site-photo                     (5) | Val  Loss: 0.5504 | Val  Acc: 0.9500
 Site-art_painting              (4) | Val  Loss: 0.7990 | Val  Acc: 0.8700
 Site-art_painting              (3) | Val  Loss: 0.8085 | Val  Acc: 0.8233
 Site-cartoon                   (0) | Val  Loss: 0.9302 | Val  Acc: 0.7100
 Site-cartoon                   (0) | Val  Loss: 0.9362 | Val  Acc: 0.7333
 Site-sketch                    (1) | Val  Loss: 1.0934 | Val  Acc: 0.6100
 Site-sketch                    (1) | Val  Loss: 1.0457 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7867
 Best site-photo                    (2)  | Epoch:5 | Val Acc: 0.9300
 Best site-photo                    (5)  | Epoch:5 | Val Acc: 0.9500
 Best site-art_painting             (4)  | Epoch:5 | Val Acc: 0.8700
 Best site-art_painting             (3)  | Epoch:5 | Val Acc: 0.8233
 Best site-cartoon                  (0)  | Epoch:5 | Val Acc: 0.7100
 Best site-cartoon                  (0)  | Epoch:5 | Val Acc: 0.7333
 Best site-sketch                   (1)  | Epoch:5 | Val Acc: 0.6100
 Best site-sketch                   (1)  | Epoch:5 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (1) | Train Loss: 0.4894 | Train Acc: 0.9600
 Site-photo                     (1) | Train Loss: 0.4348 | Train Acc: 0.9667
 Site-art_painting              (3) | Train Loss: 0.8062 | Train Acc: 0.8400
 Site-art_painting              (4) | Train Loss: 0.6728 | Train Acc: 0.8689
 Site-cartoon                   (5) | Train Loss: 0.8072 | Train Acc: 0.7533
 Site-cartoon                   (2) | Train Loss: 0.7698 | Train Acc: 0.7689
 Site-sketch                    (0) | Train Loss: 0.9921 | Train Acc: 0.7067
 Site-sketch                    (0) | Train Loss: 1.0466 | Train Acc: 0.6889
Average Train Accuracy: 0.8192
 Site-photo                     (1) | Val  Loss: 0.4365 | Val  Acc: 0.9700
 Site-photo                     (1) | Val  Loss: 0.4590 | Val  Acc: 0.9633
 Site-art_painting              (3) | Val  Loss: 0.7419 | Val  Acc: 0.8600
 Site-art_painting              (4) | Val  Loss: 0.7163 | Val  Acc: 0.8533
 Site-cartoon                   (5) | Val  Loss: 0.8051 | Val  Acc: 0.8000
 Site-cartoon                   (2) | Val  Loss: 0.8439 | Val  Acc: 0.7700
 Site-sketch                    (0) | Val  Loss: 0.9983 | Val  Acc: 0.6300
 Site-sketch                    (0) | Val  Loss: 0.9682 | Val  Acc: 0.6933
Average Valid Accuracy: 0.8175
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9700
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9633
 Best site-art_painting             (3)  | Epoch:6 | Val Acc: 0.8600
 Best site-art_painting             (4)  | Epoch:6 | Val Acc: 0.8533
 Best site-cartoon                  (5)  | Epoch:6 | Val Acc: 0.8000
 Best site-cartoon                  (2)  | Epoch:6 | Val Acc: 0.7700
 Best site-sketch                   (0)  | Epoch:6 | Val Acc: 0.6300
 Best site-sketch                   (0)  | Epoch:6 | Val Acc: 0.6933
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (5) | Train Loss: 0.4510 | Train Acc: 0.9600
 Site-photo                     (1) | Train Loss: 0.4144 | Train Acc: 0.9644
 Site-art_painting              (3) | Train Loss: 0.7048 | Train Acc: 0.8600
 Site-art_painting              (3) | Train Loss: 0.6345 | Train Acc: 0.8578
 Site-cartoon                   (2) | Train Loss: 0.8479 | Train Acc: 0.7867
 Site-cartoon                   (2) | Train Loss: 0.7663 | Train Acc: 0.7956
 Site-sketch                    (0) | Train Loss: 0.8551 | Train Acc: 0.7733
 Site-sketch                    (4) | Train Loss: 0.9215 | Train Acc: 0.7200
Average Train Accuracy: 0.8397
 Site-photo                     (5) | Val  Loss: 0.3890 | Val  Acc: 0.9600
 Site-photo                     (1) | Val  Loss: 0.3922 | Val  Acc: 0.9633
 Site-art_painting              (3) | Val  Loss: 0.6508 | Val  Acc: 0.9000
 Site-art_painting              (3) | Val  Loss: 0.6349 | Val  Acc: 0.8600
 Site-cartoon                   (2) | Val  Loss: 0.8218 | Val  Acc: 0.7100
 Site-cartoon                   (2) | Val  Loss: 0.7556 | Val  Acc: 0.7933
 Site-sketch                    (0) | Val  Loss: 0.8631 | Val  Acc: 0.7000
 Site-sketch                    (4) | Val  Loss: 0.8808 | Val  Acc: 0.7267
Average Valid Accuracy: 0.8267
 Best site-photo                    (5)  | Epoch:7 | Val Acc: 0.9600
 Best site-photo                    (1)  | Epoch:7 | Val Acc: 0.9633
 Best site-art_painting             (3)  | Epoch:7 | Val Acc: 0.9000
 Best site-art_painting             (3)  | Epoch:7 | Val Acc: 0.8600
 Best site-cartoon                  (2)  | Epoch:7 | Val Acc: 0.7100
 Best site-cartoon                  (2)  | Epoch:7 | Val Acc: 0.7933
 Best site-sketch                   (0)  | Epoch:7 | Val Acc: 0.7000
 Best site-sketch                   (4)  | Epoch:7 | Val Acc: 0.7267
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 2, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (5) | Train Loss: 0.4168 | Train Acc: 0.9533
 Site-photo                     (2) | Train Loss: 0.3314 | Train Acc: 0.9711
 Site-art_painting              (4) | Train Loss: 0.6907 | Train Acc: 0.8267
 Site-art_painting              (4) | Train Loss: 0.6700 | Train Acc: 0.8800
 Site-cartoon                   (0) | Train Loss: 0.7389 | Train Acc: 0.7800
 Site-cartoon                   (3) | Train Loss: 0.5981 | Train Acc: 0.8222
 Site-sketch                    (1) | Train Loss: 0.8819 | Train Acc: 0.7200
 Site-sketch                    (1) | Train Loss: 0.8115 | Train Acc: 0.7556
Average Train Accuracy: 0.8386
 Site-photo                     (5) | Val  Loss: 0.3753 | Val  Acc: 0.9500
 Site-photo                     (2) | Val  Loss: 0.3750 | Val  Acc: 0.9667
 Site-art_painting              (4) | Val  Loss: 0.6241 | Val  Acc: 0.8800
 Site-art_painting              (4) | Val  Loss: 0.6348 | Val  Acc: 0.8767
 Site-cartoon                   (0) | Val  Loss: 0.7213 | Val  Acc: 0.7900
 Site-cartoon                   (3) | Val  Loss: 0.6953 | Val  Acc: 0.8133
 Site-sketch                    (1) | Val  Loss: 0.8487 | Val  Acc: 0.6400
 Site-sketch                    (1) | Val  Loss: 0.8479 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8271
 Best site-photo                    (5)  | Epoch:8 | Val Acc: 0.9500
 Best site-photo                    (2)  | Epoch:8 | Val Acc: 0.9667
 Best site-art_painting             (4)  | Epoch:8 | Val Acc: 0.8800
 Best site-art_painting             (4)  | Epoch:8 | Val Acc: 0.8767
 Best site-cartoon                  (0)  | Epoch:8 | Val Acc: 0.7900
 Best site-cartoon                  (3)  | Epoch:8 | Val Acc: 0.8133
 Best site-sketch                   (1)  | Epoch:8 | Val Acc: 0.6400
 Best site-sketch                   (1)  | Epoch:8 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (3) | Train Loss: 0.3289 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.3435 | Train Acc: 0.9689
 Site-art_painting              (0) | Train Loss: 0.6596 | Train Acc: 0.8400
 Site-art_painting              (5) | Train Loss: 0.6309 | Train Acc: 0.8889
 Site-cartoon                   (4) | Train Loss: 0.6560 | Train Acc: 0.8200
 Site-cartoon                   (2) | Train Loss: 0.6132 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.8097 | Train Acc: 0.7533
 Site-sketch                    (1) | Train Loss: 0.7218 | Train Acc: 0.7489
Average Train Accuracy: 0.8517
 Site-photo                     (3) | Val  Loss: 0.3353 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.3377 | Val  Acc: 0.9667
 Site-art_painting              (0) | Val  Loss: 0.5935 | Val  Acc: 0.8800
 Site-art_painting              (5) | Val  Loss: 0.5688 | Val  Acc: 0.8633
 Site-cartoon                   (4) | Val  Loss: 0.6569 | Val  Acc: 0.8300
 Site-cartoon                   (2) | Val  Loss: 0.6343 | Val  Acc: 0.8300
 Site-sketch                    (1) | Val  Loss: 0.7677 | Val  Acc: 0.7300
 Site-sketch                    (1) | Val  Loss: 0.7930 | Val  Acc: 0.7667
Average Valid Accuracy: 0.8533
 Best site-photo                    (3)  | Epoch:9 | Val Acc: 0.9600
 Best site-photo                    (3)  | Epoch:9 | Val Acc: 0.9667
 Best site-art_painting             (0)  | Epoch:9 | Val Acc: 0.8800
 Best site-art_painting             (5)  | Epoch:9 | Val Acc: 0.8633
 Best site-cartoon                  (4)  | Epoch:9 | Val Acc: 0.8300
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.8300
 Best site-sketch                   (1)  | Epoch:9 | Val Acc: 0.7300
 Best site-sketch                   (1)  | Epoch:9 | Val Acc: 0.7667
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 10 ============
cnt=[2, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (5) | Train Loss: 0.3340 | Train Acc: 0.9667
 Site-photo                     (4) | Train Loss: 0.3407 | Train Acc: 0.9733
 Site-art_painting              (0) | Train Loss: 0.5517 | Train Acc: 0.8467
 Site-art_painting              (0) | Train Loss: 0.4722 | Train Acc: 0.8889
 Site-cartoon                   (2) | Train Loss: 0.6426 | Train Acc: 0.7800
 Site-cartoon                   (3) | Train Loss: 0.7034 | Train Acc: 0.8178
 Site-sketch                    (1) | Train Loss: 0.7325 | Train Acc: 0.7600
 Site-sketch                    (1) | Train Loss: 0.6988 | Train Acc: 0.7689
Average Train Accuracy: 0.8503
 Site-photo                     (5) | Val  Loss: 0.2832 | Val  Acc: 0.9500
 Site-photo                     (4) | Val  Loss: 0.2969 | Val  Acc: 0.9733
 Site-art_painting              (0) | Val  Loss: 0.5199 | Val  Acc: 0.9000
 Site-art_painting              (0) | Val  Loss: 0.5086 | Val  Acc: 0.8933
 Site-cartoon                   (2) | Val  Loss: 0.6824 | Val  Acc: 0.7700
 Site-cartoon                   (3) | Val  Loss: 0.6595 | Val  Acc: 0.7800
 Site-sketch                    (1) | Val  Loss: 0.7185 | Val  Acc: 0.7500
 Site-sketch                    (1) | Val  Loss: 0.7654 | Val  Acc: 0.7367
Average Valid Accuracy: 0.8442
============ Train epoch 11 ============
cnt=[3, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (0) | Train Loss: 0.2778 | Train Acc: 0.9533
 Site-photo                     (0) | Train Loss: 0.2761 | Train Acc: 0.9667
 Site-art_painting              (0) | Train Loss: 0.5933 | Train Acc: 0.8800
 Site-art_painting              (4) | Train Loss: 0.4927 | Train Acc: 0.8822
 Site-cartoon                   (2) | Train Loss: 0.5576 | Train Acc: 0.8400
 Site-cartoon                   (5) | Train Loss: 0.5014 | Train Acc: 0.8400
 Site-sketch                    (1) | Train Loss: 0.7672 | Train Acc: 0.7800
 Site-sketch                    (3) | Train Loss: 0.6720 | Train Acc: 0.7733
Average Train Accuracy: 0.8644
 Site-photo                     (0) | Val  Loss: 0.3097 | Val  Acc: 0.9400
 Site-photo                     (0) | Val  Loss: 0.2921 | Val  Acc: 0.9633
 Site-art_painting              (0) | Val  Loss: 0.5184 | Val  Acc: 0.8900
 Site-art_painting              (4) | Val  Loss: 0.5265 | Val  Acc: 0.8867
 Site-cartoon                   (2) | Val  Loss: 0.6223 | Val  Acc: 0.7900
 Site-cartoon                   (5) | Val  Loss: 0.5756 | Val  Acc: 0.8267
 Site-sketch                    (1) | Val  Loss: 0.7106 | Val  Acc: 0.7700
 Site-sketch                    (3) | Val  Loss: 0.7007 | Val  Acc: 0.8033
Average Valid Accuracy: 0.8588
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 0.9400
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 0.9633
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.8900
 Best site-art_painting             (4)  | Epoch:11 | Val Acc: 0.8867
 Best site-cartoon                  (2)  | Epoch:11 | Val Acc: 0.7900
 Best site-cartoon                  (5)  | Epoch:11 | Val Acc: 0.8267
 Best site-sketch                   (1)  | Epoch:11 | Val Acc: 0.7700
 Best site-sketch                   (3)  | Epoch:11 | Val Acc: 0.8033
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (3) | Train Loss: 0.2421 | Train Acc: 0.9733
 Site-photo                     (5) | Train Loss: 0.2577 | Train Acc: 0.9733
 Site-art_painting              (0) | Train Loss: 0.5548 | Train Acc: 0.8600
 Site-art_painting              (0) | Train Loss: 0.5895 | Train Acc: 0.8911
 Site-cartoon                   (4) | Train Loss: 0.6607 | Train Acc: 0.8067
 Site-cartoon                   (2) | Train Loss: 0.5615 | Train Acc: 0.8289
 Site-sketch                    (1) | Train Loss: 0.7082 | Train Acc: 0.7267
 Site-sketch                    (1) | Train Loss: 0.7225 | Train Acc: 0.7778
Average Train Accuracy: 0.8547
 Site-photo                     (3) | Val  Loss: 0.2409 | Val  Acc: 0.9500
 Site-photo                     (5) | Val  Loss: 0.2396 | Val  Acc: 0.9633
 Site-art_painting              (0) | Val  Loss: 0.4941 | Val  Acc: 0.8600
 Site-art_painting              (0) | Val  Loss: 0.5058 | Val  Acc: 0.8633
 Site-cartoon                   (4) | Val  Loss: 0.6055 | Val  Acc: 0.8200
 Site-cartoon                   (2) | Val  Loss: 0.5686 | Val  Acc: 0.8267
 Site-sketch                    (1) | Val  Loss: 0.7089 | Val  Acc: 0.7500
 Site-sketch                    (1) | Val  Loss: 0.7106 | Val  Acc: 0.7633
Average Valid Accuracy: 0.8496
============ Train epoch 13 ============
cnt=[1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (1) | Train Loss: 0.2568 | Train Acc: 0.9667
 Site-photo                     (1) | Train Loss: 0.2070 | Train Acc: 0.9822
 Site-art_painting              (3) | Train Loss: 0.5040 | Train Acc: 0.8733
 Site-art_painting              (3) | Train Loss: 0.4045 | Train Acc: 0.9044
 Site-cartoon                   (5) | Train Loss: 0.5954 | Train Acc: 0.8200
 Site-cartoon                   (2) | Train Loss: 0.5043 | Train Acc: 0.8400
 Site-sketch                    (0) | Train Loss: 0.6562 | Train Acc: 0.7733
 Site-sketch                    (4) | Train Loss: 0.6222 | Train Acc: 0.7644
Average Train Accuracy: 0.8656
 Site-photo                     (1) | Val  Loss: 0.2630 | Val  Acc: 0.9600
 Site-photo                     (1) | Val  Loss: 0.2373 | Val  Acc: 0.9733
 Site-art_painting              (3) | Val  Loss: 0.5205 | Val  Acc: 0.8600
 Site-art_painting              (3) | Val  Loss: 0.4358 | Val  Acc: 0.8900
 Site-cartoon                   (5) | Val  Loss: 0.5799 | Val  Acc: 0.8000
 Site-cartoon                   (2) | Val  Loss: 0.5534 | Val  Acc: 0.8067
 Site-sketch                    (0) | Val  Loss: 0.6558 | Val  Acc: 0.7700
 Site-sketch                    (4) | Val  Loss: 0.6681 | Val  Acc: 0.7700
Average Valid Accuracy: 0.8538
============ Train epoch 14 ============
cnt=[1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (0) | Train Loss: 0.2224 | Train Acc: 0.9867
 Site-photo                     (5) | Train Loss: 0.1981 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.4702 | Train Acc: 0.8733
 Site-art_painting              (3) | Train Loss: 0.5040 | Train Acc: 0.8844
 Site-cartoon                   (2) | Train Loss: 0.5610 | Train Acc: 0.8067
 Site-cartoon                   (4) | Train Loss: 0.4623 | Train Acc: 0.8511
 Site-sketch                    (1) | Train Loss: 0.6621 | Train Acc: 0.8067
 Site-sketch                    (1) | Train Loss: 0.6292 | Train Acc: 0.7644
Average Train Accuracy: 0.8683
 Site-photo                     (0) | Val  Loss: 0.2255 | Val  Acc: 0.9600
 Site-photo                     (5) | Val  Loss: 0.2202 | Val  Acc: 0.9633
 Site-art_painting              (3) | Val  Loss: 0.4484 | Val  Acc: 0.8700
 Site-art_painting              (3) | Val  Loss: 0.4325 | Val  Acc: 0.8933
 Site-cartoon                   (2) | Val  Loss: 0.5512 | Val  Acc: 0.8100
 Site-cartoon                   (4) | Val  Loss: 0.4846 | Val  Acc: 0.8700
 Site-sketch                    (1) | Val  Loss: 0.6055 | Val  Acc: 0.7900
 Site-sketch                    (1) | Val  Loss: 0.6596 | Val  Acc: 0.7433
Average Valid Accuracy: 0.8625
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9600
 Best site-photo                    (5)  | Epoch:14 | Val Acc: 0.9633
 Best site-art_painting             (3)  | Epoch:14 | Val Acc: 0.8700
 Best site-art_painting             (3)  | Epoch:14 | Val Acc: 0.8933
 Best site-cartoon                  (2)  | Epoch:14 | Val Acc: 0.8100
 Best site-cartoon                  (4)  | Epoch:14 | Val Acc: 0.8700
 Best site-sketch                   (1)  | Epoch:14 | Val Acc: 0.7900
 Best site-sketch                   (1)  | Epoch:14 | Val Acc: 0.7433
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 15 ============
cnt=[1, 1, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (4) | Train Loss: 0.1992 | Train Acc: 0.9867
 Site-photo                     (4) | Train Loss: 0.1924 | Train Acc: 0.9711
 Site-art_painting              (5) | Train Loss: 0.4642 | Train Acc: 0.8600
 Site-art_painting              (0) | Train Loss: 0.3650 | Train Acc: 0.9044
 Site-cartoon                   (2) | Train Loss: 0.5434 | Train Acc: 0.8267
 Site-cartoon                   (2) | Train Loss: 0.4479 | Train Acc: 0.8467
 Site-sketch                    (1) | Train Loss: 0.6403 | Train Acc: 0.8000
 Site-sketch                    (3) | Train Loss: 0.5699 | Train Acc: 0.7844
Average Train Accuracy: 0.8725
 Site-photo                     (4) | Val  Loss: 0.2510 | Val  Acc: 0.9600
 Site-photo                     (4) | Val  Loss: 0.2117 | Val  Acc: 0.9667
 Site-art_painting              (5) | Val  Loss: 0.4206 | Val  Acc: 0.8800
 Site-art_painting              (0) | Val  Loss: 0.4359 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.5921 | Val  Acc: 0.7700
 Site-cartoon                   (2) | Val  Loss: 0.5013 | Val  Acc: 0.8533
 Site-sketch                    (1) | Val  Loss: 0.6260 | Val  Acc: 0.7700
 Site-sketch                    (3) | Val  Loss: 0.6505 | Val  Acc: 0.8100
Average Valid Accuracy: 0.8638
 Best site-photo                    (4)  | Epoch:15 | Val Acc: 0.9600
 Best site-photo                    (4)  | Epoch:15 | Val Acc: 0.9667
 Best site-art_painting             (5)  | Epoch:15 | Val Acc: 0.8800
 Best site-art_painting             (0)  | Epoch:15 | Val Acc: 0.9000
 Best site-cartoon                  (2)  | Epoch:15 | Val Acc: 0.7700
 Best site-cartoon                  (2)  | Epoch:15 | Val Acc: 0.8533
 Best site-sketch                   (1)  | Epoch:15 | Val Acc: 0.7700
 Best site-sketch                   (3)  | Epoch:15 | Val Acc: 0.8100
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 16 ============
cnt=[2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (0) | Train Loss: 0.2372 | Train Acc: 0.9600
 Site-photo                     (0) | Train Loss: 0.1822 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.4999 | Train Acc: 0.8533
 Site-art_painting              (3) | Train Loss: 0.4046 | Train Acc: 0.8956
 Site-cartoon                   (2) | Train Loss: 0.5238 | Train Acc: 0.8400
 Site-cartoon                   (4) | Train Loss: 0.4075 | Train Acc: 0.8644
 Site-sketch                    (5) | Train Loss: 0.6708 | Train Acc: 0.7667
 Site-sketch                    (1) | Train Loss: 0.5849 | Train Acc: 0.7800
Average Train Accuracy: 0.8669
 Site-photo                     (0) | Val  Loss: 0.2172 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.2121 | Val  Acc: 0.9667
 Site-art_painting              (3) | Val  Loss: 0.4776 | Val  Acc: 0.8500
 Site-art_painting              (3) | Val  Loss: 0.4595 | Val  Acc: 0.8833
 Site-cartoon                   (2) | Val  Loss: 0.5543 | Val  Acc: 0.8200
 Site-cartoon                   (4) | Val  Loss: 0.4754 | Val  Acc: 0.8500
 Site-sketch                    (5) | Val  Loss: 0.6538 | Val  Acc: 0.7500
 Site-sketch                    (1) | Val  Loss: 0.5889 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8600
============ Train epoch 17 ============
cnt=[1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (3) | Train Loss: 0.2521 | Train Acc: 0.9467
 Site-photo                     (3) | Train Loss: 0.2357 | Train Acc: 0.9644
 Site-art_painting              (0) | Train Loss: 0.5205 | Train Acc: 0.8867
 Site-art_painting              (5) | Train Loss: 0.3911 | Train Acc: 0.9022
 Site-cartoon                   (2) | Train Loss: 0.5028 | Train Acc: 0.8800
 Site-cartoon                   (4) | Train Loss: 0.4546 | Train Acc: 0.8644
 Site-sketch                    (1) | Train Loss: 0.5956 | Train Acc: 0.7733
 Site-sketch                    (1) | Train Loss: 0.5412 | Train Acc: 0.7778
Average Train Accuracy: 0.8744
 Site-photo                     (3) | Val  Loss: 0.1960 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.2080 | Val  Acc: 0.9700
 Site-art_painting              (0) | Val  Loss: 0.4365 | Val  Acc: 0.8800
 Site-art_painting              (5) | Val  Loss: 0.4074 | Val  Acc: 0.9067
 Site-cartoon                   (2) | Val  Loss: 0.4615 | Val  Acc: 0.8400
 Site-cartoon                   (4) | Val  Loss: 0.4618 | Val  Acc: 0.8500
 Site-sketch                    (1) | Val  Loss: 0.5523 | Val  Acc: 0.7800
 Site-sketch                    (1) | Val  Loss: 0.6033 | Val  Acc: 0.7900
Average Valid Accuracy: 0.8708
 Best site-photo                    (3)  | Epoch:17 | Val Acc: 0.9500
 Best site-photo                    (3)  | Epoch:17 | Val Acc: 0.9700
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8800
 Best site-art_painting             (5)  | Epoch:17 | Val Acc: 0.9067
 Best site-cartoon                  (2)  | Epoch:17 | Val Acc: 0.8400
 Best site-cartoon                  (4)  | Epoch:17 | Val Acc: 0.8500
 Best site-sketch                   (1)  | Epoch:17 | Val Acc: 0.7800
 Best site-sketch                   (1)  | Epoch:17 | Val Acc: 0.7900
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 18 ============
cnt=[1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (2) | Train Loss: 0.2000 | Train Acc: 0.9667
 Site-photo                     (2) | Train Loss: 0.1813 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.4312 | Train Acc: 0.8800
 Site-art_painting              (3) | Train Loss: 0.3664 | Train Acc: 0.8978
 Site-cartoon                   (0) | Train Loss: 0.4746 | Train Acc: 0.8733
 Site-cartoon                   (4) | Train Loss: 0.4874 | Train Acc: 0.8489
 Site-sketch                    (5) | Train Loss: 0.6479 | Train Acc: 0.7800
 Site-sketch                    (1) | Train Loss: 0.6246 | Train Acc: 0.7889
Average Train Accuracy: 0.8761
 Site-photo                     (2) | Val  Loss: 0.1909 | Val  Acc: 0.9600
 Site-photo                     (2) | Val  Loss: 0.2031 | Val  Acc: 0.9700
 Site-art_painting              (3) | Val  Loss: 0.4064 | Val  Acc: 0.8900
 Site-art_painting              (3) | Val  Loss: 0.4152 | Val  Acc: 0.8867
 Site-cartoon                   (0) | Val  Loss: 0.5206 | Val  Acc: 0.7800
 Site-cartoon                   (4) | Val  Loss: 0.4496 | Val  Acc: 0.8533
 Site-sketch                    (5) | Val  Loss: 0.6002 | Val  Acc: 0.7500
 Site-sketch                    (1) | Val  Loss: 0.6189 | Val  Acc: 0.7567
Average Valid Accuracy: 0.8558
============ Train epoch 19 ============
cnt=[1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (3) | Train Loss: 0.2082 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.1737 | Train Acc: 0.9756
 Site-art_painting              (2) | Train Loss: 0.3865 | Train Acc: 0.9133
 Site-art_painting              (2) | Train Loss: 0.4360 | Train Acc: 0.8911
 Site-cartoon                   (4) | Train Loss: 0.4683 | Train Acc: 0.8533
 Site-cartoon                   (0) | Train Loss: 0.4383 | Train Acc: 0.8756
 Site-sketch                    (5) | Train Loss: 0.5355 | Train Acc: 0.8400
 Site-sketch                    (1) | Train Loss: 0.5822 | Train Acc: 0.7956
Average Train Accuracy: 0.8897
 Site-photo                     (3) | Val  Loss: 0.1852 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1949 | Val  Acc: 0.9700
 Site-art_painting              (2) | Val  Loss: 0.3734 | Val  Acc: 0.8900
 Site-art_painting              (2) | Val  Loss: 0.3611 | Val  Acc: 0.9233
 Site-cartoon                   (4) | Val  Loss: 0.4829 | Val  Acc: 0.8000
 Site-cartoon                   (0) | Val  Loss: 0.4486 | Val  Acc: 0.8433
 Site-sketch                    (5) | Val  Loss: 0.5432 | Val  Acc: 0.8600
 Site-sketch                    (1) | Val  Loss: 0.5887 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8821
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 0.9700
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 0.9700
 Best site-art_painting             (2)  | Epoch:19 | Val Acc: 0.8900
 Best site-art_painting             (2)  | Epoch:19 | Val Acc: 0.9233
 Best site-cartoon                  (4)  | Epoch:19 | Val Acc: 0.8000
 Best site-cartoon                  (0)  | Epoch:19 | Val Acc: 0.8433
 Best site-sketch                   (5)  | Epoch:19 | Val Acc: 0.8600
 Best site-sketch                   (1)  | Epoch:19 | Val Acc: 0.8000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 20 ============
cnt=[2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (5) | Train Loss: 0.1877 | Train Acc: 0.9667
 Site-photo                     (1) | Train Loss: 0.1645 | Train Acc: 0.9800
 Site-art_painting              (4) | Train Loss: 0.3987 | Train Acc: 0.8800
 Site-art_painting              (3) | Train Loss: 0.3148 | Train Acc: 0.9289
 Site-cartoon                   (2) | Train Loss: 0.4108 | Train Acc: 0.8533
 Site-cartoon                   (2) | Train Loss: 0.4227 | Train Acc: 0.8644
 Site-sketch                    (0) | Train Loss: 0.4971 | Train Acc: 0.8133
 Site-sketch                    (0) | Train Loss: 0.5287 | Train Acc: 0.8000
Average Train Accuracy: 0.8858
 Site-photo                     (5) | Val  Loss: 0.1867 | Val  Acc: 0.9600
 Site-photo                     (1) | Val  Loss: 0.1905 | Val  Acc: 0.9667
 Site-art_painting              (4) | Val  Loss: 0.4441 | Val  Acc: 0.8700
 Site-art_painting              (3) | Val  Loss: 0.3563 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.4542 | Val  Acc: 0.8500
 Site-cartoon                   (2) | Val  Loss: 0.4412 | Val  Acc: 0.8233
 Site-sketch                    (0) | Val  Loss: 0.5327 | Val  Acc: 0.8000
 Site-sketch                    (0) | Val  Loss: 0.6034 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8713
============ Train epoch 21 ============
cnt=[1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (1) | Train Loss: 0.1512 | Train Acc: 0.9867
 Site-photo                     (1) | Train Loss: 0.1512 | Train Acc: 0.9800
 Site-art_painting              (4) | Train Loss: 0.4729 | Train Acc: 0.8600
 Site-art_painting              (2) | Train Loss: 0.3194 | Train Acc: 0.9111
 Site-cartoon                   (3) | Train Loss: 0.4268 | Train Acc: 0.8267
 Site-cartoon                   (3) | Train Loss: 0.4770 | Train Acc: 0.8711
 Site-sketch                    (5) | Train Loss: 0.5641 | Train Acc: 0.7933
 Site-sketch                    (0) | Train Loss: 0.6047 | Train Acc: 0.7889
Average Train Accuracy: 0.8772
 Site-photo                     (1) | Val  Loss: 0.1578 | Val  Acc: 0.9800
 Site-photo                     (1) | Val  Loss: 0.1596 | Val  Acc: 0.9767
 Site-art_painting              (4) | Val  Loss: 0.4057 | Val  Acc: 0.8800
 Site-art_painting              (2) | Val  Loss: 0.3870 | Val  Acc: 0.8867
 Site-cartoon                   (3) | Val  Loss: 0.4463 | Val  Acc: 0.8500
 Site-cartoon                   (3) | Val  Loss: 0.4261 | Val  Acc: 0.8633
 Site-sketch                    (5) | Val  Loss: 0.5392 | Val  Acc: 0.7700
 Site-sketch                    (0) | Val  Loss: 0.5857 | Val  Acc: 0.7867
Average Valid Accuracy: 0.8742
============ Train epoch 22 ============
cnt=[2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (0) | Train Loss: 0.1714 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.1559 | Train Acc: 0.9778
 Site-art_painting              (3) | Train Loss: 0.4233 | Train Acc: 0.8933
 Site-art_painting              (3) | Train Loss: 0.4082 | Train Acc: 0.9000
 Site-cartoon                   (2) | Train Loss: 0.3902 | Train Acc: 0.9067
 Site-cartoon                   (5) | Train Loss: 0.4672 | Train Acc: 0.8867
 Site-sketch                    (4) | Train Loss: 0.5580 | Train Acc: 0.7867
 Site-sketch                    (1) | Train Loss: 0.4924 | Train Acc: 0.7978
Average Train Accuracy: 0.8919
 Site-photo                     (0) | Val  Loss: 0.1612 | Val  Acc: 0.9700
 Site-photo                     (0) | Val  Loss: 0.1632 | Val  Acc: 0.9733
 Site-art_painting              (3) | Val  Loss: 0.3188 | Val  Acc: 0.9100
 Site-art_painting              (3) | Val  Loss: 0.3537 | Val  Acc: 0.8867
 Site-cartoon                   (2) | Val  Loss: 0.4376 | Val  Acc: 0.8400
 Site-cartoon                   (5) | Val  Loss: 0.4072 | Val  Acc: 0.8633
 Site-sketch                    (4) | Val  Loss: 0.5181 | Val  Acc: 0.8200
 Site-sketch                    (1) | Val  Loss: 0.5815 | Val  Acc: 0.7800
Average Valid Accuracy: 0.8804
============ Train epoch 23 ============
cnt=[1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (5) | Train Loss: 0.1700 | Train Acc: 0.9733
 Site-photo                     (0) | Train Loss: 0.1371 | Train Acc: 0.9844
 Site-art_painting              (3) | Train Loss: 0.3779 | Train Acc: 0.8733
 Site-art_painting              (3) | Train Loss: 0.3047 | Train Acc: 0.9133
 Site-cartoon                   (4) | Train Loss: 0.4069 | Train Acc: 0.8667
 Site-cartoon                   (2) | Train Loss: 0.3599 | Train Acc: 0.8756
 Site-sketch                    (1) | Train Loss: 0.6229 | Train Acc: 0.7867
 Site-sketch                    (1) | Train Loss: 0.4827 | Train Acc: 0.8067
Average Train Accuracy: 0.8850
 Site-photo                     (5) | Val  Loss: 0.1647 | Val  Acc: 0.9800
 Site-photo                     (0) | Val  Loss: 0.1752 | Val  Acc: 0.9700
 Site-art_painting              (3) | Val  Loss: 0.4044 | Val  Acc: 0.8700
 Site-art_painting              (3) | Val  Loss: 0.3294 | Val  Acc: 0.9233
 Site-cartoon                   (4) | Val  Loss: 0.4022 | Val  Acc: 0.8400
 Site-cartoon                   (2) | Val  Loss: 0.3859 | Val  Acc: 0.8700
 Site-sketch                    (1) | Val  Loss: 0.5503 | Val  Acc: 0.7500
 Site-sketch                    (1) | Val  Loss: 0.5739 | Val  Acc: 0.8067
Average Valid Accuracy: 0.8762
============ Train epoch 24 ============
cnt=[2, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (3) | Train Loss: 0.1888 | Train Acc: 0.9800
 Site-photo                     (5) | Train Loss: 0.1422 | Train Acc: 0.9711
 Site-art_painting              (0) | Train Loss: 0.3770 | Train Acc: 0.8867
 Site-art_painting              (0) | Train Loss: 0.3034 | Train Acc: 0.9156
 Site-cartoon                   (4) | Train Loss: 0.4429 | Train Acc: 0.8733
 Site-cartoon                   (2) | Train Loss: 0.5734 | Train Acc: 0.8756
 Site-sketch                    (1) | Train Loss: 0.6747 | Train Acc: 0.7733
 Site-sketch                    (1) | Train Loss: 0.5004 | Train Acc: 0.7911
Average Train Accuracy: 0.8833
 Site-photo                     (3) | Val  Loss: 0.1744 | Val  Acc: 0.9800
 Site-photo                     (5) | Val  Loss: 0.1692 | Val  Acc: 0.9733
 Site-art_painting              (0) | Val  Loss: 0.3559 | Val  Acc: 0.8900
 Site-art_painting              (0) | Val  Loss: 0.3182 | Val  Acc: 0.9200
 Site-cartoon                   (4) | Val  Loss: 0.4189 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.3864 | Val  Acc: 0.8733
 Site-sketch                    (1) | Val  Loss: 0.5103 | Val  Acc: 0.8200
 Site-sketch                    (1) | Val  Loss: 0.5395 | Val  Acc: 0.8233
Average Valid Accuracy: 0.8950
 Best site-photo                    (3)  | Epoch:24 | Val Acc: 0.9800
 Best site-photo                    (5)  | Epoch:24 | Val Acc: 0.9733
 Best site-art_painting             (0)  | Epoch:24 | Val Acc: 0.8900
 Best site-art_painting             (0)  | Epoch:24 | Val Acc: 0.9200
 Best site-cartoon                  (4)  | Epoch:24 | Val Acc: 0.8800
 Best site-cartoon                  (2)  | Epoch:24 | Val Acc: 0.8733
 Best site-sketch                   (1)  | Epoch:24 | Val Acc: 0.8200
 Best site-sketch                   (1)  | Epoch:24 | Val Acc: 0.8233
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 25 ============
cnt=[1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (2) | Train Loss: 0.1889 | Train Acc: 0.9600
 Site-photo                     (5) | Train Loss: 0.1419 | Train Acc: 0.9711
 Site-art_painting              (3) | Train Loss: 0.3837 | Train Acc: 0.8800
 Site-art_painting              (3) | Train Loss: 0.3306 | Train Acc: 0.9067
 Site-cartoon                   (0) | Train Loss: 0.3918 | Train Acc: 0.8800
 Site-cartoon                   (4) | Train Loss: 0.3307 | Train Acc: 0.8956
 Site-sketch                    (1) | Train Loss: 0.5375 | Train Acc: 0.8067
 Site-sketch                    (1) | Train Loss: 0.6292 | Train Acc: 0.7933
Average Train Accuracy: 0.8867
 Site-photo                     (2) | Val  Loss: 0.1848 | Val  Acc: 0.9500
 Site-photo                     (5) | Val  Loss: 0.1759 | Val  Acc: 0.9633
 Site-art_painting              (3) | Val  Loss: 0.4160 | Val  Acc: 0.8700
 Site-art_painting              (3) | Val  Loss: 0.3522 | Val  Acc: 0.8867
 Site-cartoon                   (0) | Val  Loss: 0.3823 | Val  Acc: 0.8900
 Site-cartoon                   (4) | Val  Loss: 0.3314 | Val  Acc: 0.8967
 Site-sketch                    (1) | Val  Loss: 0.5495 | Val  Acc: 0.7500
 Site-sketch                    (1) | Val  Loss: 0.5471 | Val  Acc: 0.7867
Average Valid Accuracy: 0.8742
============ Train epoch 26 ============
cnt=[2, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (0) | Train Loss: 0.1508 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.1384 | Train Acc: 0.9756
 Site-art_painting              (4) | Train Loss: 0.3652 | Train Acc: 0.8867
 Site-art_painting              (3) | Train Loss: 0.3795 | Train Acc: 0.9133
 Site-cartoon                   (2) | Train Loss: 0.4271 | Train Acc: 0.8800
 Site-cartoon                   (5) | Train Loss: 0.3122 | Train Acc: 0.8800
 Site-sketch                    (1) | Train Loss: 0.4940 | Train Acc: 0.8267
 Site-sketch                    (1) | Train Loss: 0.4723 | Train Acc: 0.8400
Average Train Accuracy: 0.8986
 Site-photo                     (0) | Val  Loss: 0.1628 | Val  Acc: 0.9800
 Site-photo                     (0) | Val  Loss: 0.1793 | Val  Acc: 0.9600
 Site-art_painting              (4) | Val  Loss: 0.4439 | Val  Acc: 0.8800
 Site-art_painting              (3) | Val  Loss: 0.3013 | Val  Acc: 0.9300
 Site-cartoon                   (2) | Val  Loss: 0.4392 | Val  Acc: 0.8500
 Site-cartoon                   (5) | Val  Loss: 0.3523 | Val  Acc: 0.9033
 Site-sketch                    (1) | Val  Loss: 0.4765 | Val  Acc: 0.8200
 Site-sketch                    (1) | Val  Loss: 0.5403 | Val  Acc: 0.8133
Average Valid Accuracy: 0.8921
============ Train epoch 27 ============
cnt=[1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (3) | Train Loss: 0.1695 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.1210 | Train Acc: 0.9778
 Site-art_painting              (2) | Train Loss: 0.3665 | Train Acc: 0.8867
 Site-art_painting              (2) | Train Loss: 0.3336 | Train Acc: 0.9200
 Site-cartoon                   (0) | Train Loss: 0.4561 | Train Acc: 0.8667
 Site-cartoon                   (4) | Train Loss: 0.4360 | Train Acc: 0.8800
 Site-sketch                    (5) | Train Loss: 0.4702 | Train Acc: 0.8467
 Site-sketch                    (1) | Train Loss: 0.4634 | Train Acc: 0.8289
Average Train Accuracy: 0.8967
 Site-photo                     (3) | Val  Loss: 0.1778 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1355 | Val  Acc: 0.9767
 Site-art_painting              (2) | Val  Loss: 0.3721 | Val  Acc: 0.8700
 Site-art_painting              (2) | Val  Loss: 0.3085 | Val  Acc: 0.9000
 Site-cartoon                   (0) | Val  Loss: 0.4217 | Val  Acc: 0.8200
 Site-cartoon                   (4) | Val  Loss: 0.3933 | Val  Acc: 0.8600
 Site-sketch                    (5) | Val  Loss: 0.5170 | Val  Acc: 0.7800
 Site-sketch                    (1) | Val  Loss: 0.5244 | Val  Acc: 0.7967
Average Valid Accuracy: 0.8717
============ Train epoch 28 ============
cnt=[2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (0) | Train Loss: 0.1452 | Train Acc: 0.9667
 Site-photo                     (0) | Train Loss: 0.1527 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.3614 | Train Acc: 0.8933
 Site-art_painting              (3) | Train Loss: 0.2777 | Train Acc: 0.9267
 Site-cartoon                   (2) | Train Loss: 0.3707 | Train Acc: 0.9067
 Site-cartoon                   (5) | Train Loss: 0.3327 | Train Acc: 0.8956
 Site-sketch                    (4) | Train Loss: 0.5047 | Train Acc: 0.8467
 Site-sketch                    (1) | Train Loss: 0.5723 | Train Acc: 0.8156
Average Train Accuracy: 0.9033
 Site-photo                     (0) | Val  Loss: 0.1484 | Val  Acc: 0.9500
 Site-photo                     (0) | Val  Loss: 0.1491 | Val  Acc: 0.9767
 Site-art_painting              (3) | Val  Loss: 0.2934 | Val  Acc: 0.9300
 Site-art_painting              (3) | Val  Loss: 0.3013 | Val  Acc: 0.9133
 Site-cartoon                   (2) | Val  Loss: 0.3849 | Val  Acc: 0.8700
 Site-cartoon                   (5) | Val  Loss: 0.3432 | Val  Acc: 0.8733
 Site-sketch                    (4) | Val  Loss: 0.4594 | Val  Acc: 0.8200
 Site-sketch                    (1) | Val  Loss: 0.5050 | Val  Acc: 0.8300
Average Valid Accuracy: 0.8954
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.9500
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.9767
 Best site-art_painting             (3)  | Epoch:28 | Val Acc: 0.9300
 Best site-art_painting             (3)  | Epoch:28 | Val Acc: 0.9133
 Best site-cartoon                  (2)  | Epoch:28 | Val Acc: 0.8700
 Best site-cartoon                  (5)  | Epoch:28 | Val Acc: 0.8733
 Best site-sketch                   (4)  | Epoch:28 | Val Acc: 0.8200
 Best site-sketch                   (1)  | Epoch:28 | Val Acc: 0.8300
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 29 ============
cnt=[1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (1) | Train Loss: 0.1846 | Train Acc: 0.9867
 Site-photo                     (1) | Train Loss: 0.1139 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.3405 | Train Acc: 0.8867
 Site-art_painting              (3) | Train Loss: 0.2844 | Train Acc: 0.9156
 Site-cartoon                   (5) | Train Loss: 0.4341 | Train Acc: 0.8933
 Site-cartoon                   (2) | Train Loss: 0.3668 | Train Acc: 0.8889
 Site-sketch                    (0) | Train Loss: 0.5110 | Train Acc: 0.8200
 Site-sketch                    (4) | Train Loss: 0.4540 | Train Acc: 0.8289
Average Train Accuracy: 0.8994
 Site-photo                     (1) | Val  Loss: 0.1506 | Val  Acc: 0.9700
 Site-photo                     (1) | Val  Loss: 0.1371 | Val  Acc: 0.9633
 Site-art_painting              (3) | Val  Loss: 0.3530 | Val  Acc: 0.8600
 Site-art_painting              (3) | Val  Loss: 0.2755 | Val  Acc: 0.9167
 Site-cartoon                   (5) | Val  Loss: 0.3877 | Val  Acc: 0.8500
 Site-cartoon                   (2) | Val  Loss: 0.3488 | Val  Acc: 0.8933
 Site-sketch                    (0) | Val  Loss: 0.4955 | Val  Acc: 0.7800
 Site-sketch                    (4) | Val  Loss: 0.4827 | Val  Acc: 0.8400
Average Valid Accuracy: 0.8842
============ Train epoch 30 ============
cnt=[2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (3) | Train Loss: 0.1279 | Train Acc: 0.9800
 Site-photo                     (4) | Train Loss: 0.1379 | Train Acc: 0.9844
 Site-art_painting              (2) | Train Loss: 0.3882 | Train Acc: 0.8733
 Site-art_painting              (2) | Train Loss: 0.2728 | Train Acc: 0.9044
 Site-cartoon                   (0) | Train Loss: 0.3717 | Train Acc: 0.8867
 Site-cartoon                   (0) | Train Loss: 0.2838 | Train Acc: 0.9022
 Site-sketch                    (5) | Train Loss: 0.4803 | Train Acc: 0.8067
 Site-sketch                    (1) | Train Loss: 0.4528 | Train Acc: 0.8222
Average Train Accuracy: 0.8950
 Site-photo                     (3) | Val  Loss: 0.1514 | Val  Acc: 0.9600
 Site-photo                     (4) | Val  Loss: 0.1519 | Val  Acc: 0.9700
 Site-art_painting              (2) | Val  Loss: 0.3027 | Val  Acc: 0.9200
 Site-art_painting              (2) | Val  Loss: 0.2969 | Val  Acc: 0.9167
 Site-cartoon                   (0) | Val  Loss: 0.3773 | Val  Acc: 0.8700
 Site-cartoon                   (0) | Val  Loss: 0.3335 | Val  Acc: 0.8967
 Site-sketch                    (5) | Val  Loss: 0.4228 | Val  Acc: 0.8400
 Site-sketch                    (1) | Val  Loss: 0.4914 | Val  Acc: 0.8467
Average Valid Accuracy: 0.9025
 Best site-photo                    (3)  | Epoch:30 | Val Acc: 0.9600
 Best site-photo                    (4)  | Epoch:30 | Val Acc: 0.9700
 Best site-art_painting             (2)  | Epoch:30 | Val Acc: 0.9200
 Best site-art_painting             (2)  | Epoch:30 | Val Acc: 0.9167
 Best site-cartoon                  (0)  | Epoch:30 | Val Acc: 0.8700
 Best site-cartoon                  (0)  | Epoch:30 | Val Acc: 0.8967
 Best site-sketch                   (5)  | Epoch:30 | Val Acc: 0.8400
 Best site-sketch                   (1)  | Epoch:30 | Val Acc: 0.8467
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 31 ============
cnt=[1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (3) | Train Loss: 0.1462 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.1157 | Train Acc: 0.9778
 Site-art_painting              (5) | Train Loss: 0.2843 | Train Acc: 0.9333
 Site-art_painting              (2) | Train Loss: 0.4355 | Train Acc: 0.9311
 Site-cartoon                   (0) | Train Loss: 0.4034 | Train Acc: 0.8533
 Site-cartoon                   (4) | Train Loss: 0.3023 | Train Acc: 0.8911
 Site-sketch                    (1) | Train Loss: 0.4898 | Train Acc: 0.8333
 Site-sketch                    (1) | Train Loss: 0.5188 | Train Acc: 0.8578
Average Train Accuracy: 0.9056
 Site-photo                     (3) | Val  Loss: 0.1623 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.1329 | Val  Acc: 0.9800
 Site-art_painting              (5) | Val  Loss: 0.2956 | Val  Acc: 0.9300
 Site-art_painting              (2) | Val  Loss: 0.2755 | Val  Acc: 0.9200
 Site-cartoon                   (0) | Val  Loss: 0.3709 | Val  Acc: 0.8700
 Site-cartoon                   (4) | Val  Loss: 0.3469 | Val  Acc: 0.8933
 Site-sketch                    (1) | Val  Loss: 0.4321 | Val  Acc: 0.8100
 Site-sketch                    (1) | Val  Loss: 0.4949 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8942
============ Train epoch 32 ============
cnt=[1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (1) | Train Loss: 0.1405 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.1170 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.3044 | Train Acc: 0.8867
 Site-art_painting              (3) | Train Loss: 0.2768 | Train Acc: 0.9244
 Site-cartoon                   (2) | Train Loss: 0.3513 | Train Acc: 0.8733
 Site-cartoon                   (5) | Train Loss: 0.4428 | Train Acc: 0.9000
 Site-sketch                    (4) | Train Loss: 0.5660 | Train Acc: 0.7733
 Site-sketch                    (0) | Train Loss: 0.4574 | Train Acc: 0.8222
Average Train Accuracy: 0.8919
 Site-photo                     (1) | Val  Loss: 0.1034 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1326 | Val  Acc: 0.9700
 Site-art_painting              (3) | Val  Loss: 0.3117 | Val  Acc: 0.8900
 Site-art_painting              (3) | Val  Loss: 0.2606 | Val  Acc: 0.9367
 Site-cartoon                   (2) | Val  Loss: 0.4192 | Val  Acc: 0.8700
 Site-cartoon                   (5) | Val  Loss: 0.3723 | Val  Acc: 0.8867
 Site-sketch                    (4) | Val  Loss: 0.4511 | Val  Acc: 0.8200
 Site-sketch                    (0) | Val  Loss: 0.4702 | Val  Acc: 0.8300
Average Valid Accuracy: 0.9004
============ Train epoch 33 ============
cnt=[1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (1) | Train Loss: 0.1397 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.1638 | Train Acc: 0.9689
 Site-art_painting              (3) | Train Loss: 0.3452 | Train Acc: 0.9133
 Site-art_painting              (5) | Train Loss: 0.3501 | Train Acc: 0.9133
 Site-cartoon                   (2) | Train Loss: 0.3698 | Train Acc: 0.8800
 Site-cartoon                   (2) | Train Loss: 0.2759 | Train Acc: 0.9133
 Site-sketch                    (0) | Train Loss: 0.5653 | Train Acc: 0.8267
 Site-sketch                    (4) | Train Loss: 0.5867 | Train Acc: 0.8267
Average Train Accuracy: 0.9028
 Site-photo                     (1) | Val  Loss: 0.1697 | Val  Acc: 0.9800
 Site-photo                     (1) | Val  Loss: 0.1431 | Val  Acc: 0.9800
 Site-art_painting              (3) | Val  Loss: 0.3471 | Val  Acc: 0.8700
 Site-art_painting              (5) | Val  Loss: 0.2696 | Val  Acc: 0.9200
 Site-cartoon                   (2) | Val  Loss: 0.3481 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.3394 | Val  Acc: 0.9067
 Site-sketch                    (0) | Val  Loss: 0.4917 | Val  Acc: 0.8300
 Site-sketch                    (4) | Val  Loss: 0.5112 | Val  Acc: 0.8200
Average Valid Accuracy: 0.8971
============ Train epoch 34 ============
cnt=[1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (2) | Train Loss: 0.1554 | Train Acc: 0.9667
 Site-photo                     (2) | Train Loss: 0.1166 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.2607 | Train Acc: 0.9267
 Site-art_painting              (3) | Train Loss: 0.3057 | Train Acc: 0.9333
 Site-cartoon                   (5) | Train Loss: 0.3451 | Train Acc: 0.8867
 Site-cartoon                   (0) | Train Loss: 0.3405 | Train Acc: 0.9067
 Site-sketch                    (1) | Train Loss: 0.5325 | Train Acc: 0.7933
 Site-sketch                    (4) | Train Loss: 0.4201 | Train Acc: 0.8311
Average Train Accuracy: 0.9022
 Site-photo                     (2) | Val  Loss: 0.1725 | Val  Acc: 0.9600
 Site-photo                     (2) | Val  Loss: 0.1335 | Val  Acc: 0.9767
 Site-art_painting              (3) | Val  Loss: 0.3465 | Val  Acc: 0.8600
 Site-art_painting              (3) | Val  Loss: 0.2921 | Val  Acc: 0.9100
 Site-cartoon                   (5) | Val  Loss: 0.3712 | Val  Acc: 0.8800
 Site-cartoon                   (0) | Val  Loss: 0.3193 | Val  Acc: 0.9100
 Site-sketch                    (1) | Val  Loss: 0.4652 | Val  Acc: 0.8700
 Site-sketch                    (4) | Val  Loss: 0.4675 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9000
============ Train epoch 35 ============
cnt=[2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (3) | Train Loss: 0.1291 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.1174 | Train Acc: 0.9800
 Site-art_painting              (2) | Train Loss: 0.3767 | Train Acc: 0.9133
 Site-art_painting              (5) | Train Loss: 0.2425 | Train Acc: 0.9222
 Site-cartoon                   (0) | Train Loss: 0.3106 | Train Acc: 0.9200
 Site-cartoon                   (0) | Train Loss: 0.3087 | Train Acc: 0.9022
 Site-sketch                    (1) | Train Loss: 0.4137 | Train Acc: 0.8533
 Site-sketch                    (4) | Train Loss: 0.4138 | Train Acc: 0.8178
Average Train Accuracy: 0.9111
 Site-photo                     (3) | Val  Loss: 0.1540 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.1295 | Val  Acc: 0.9733
 Site-art_painting              (2) | Val  Loss: 0.3139 | Val  Acc: 0.9100
 Site-art_painting              (5) | Val  Loss: 0.2600 | Val  Acc: 0.9267
 Site-cartoon                   (0) | Val  Loss: 0.3536 | Val  Acc: 0.8700
 Site-cartoon                   (0) | Val  Loss: 0.3309 | Val  Acc: 0.8867
 Site-sketch                    (1) | Val  Loss: 0.4249 | Val  Acc: 0.8300
 Site-sketch                    (4) | Val  Loss: 0.4621 | Val  Acc: 0.8467
Average Valid Accuracy: 0.8992
============ Train epoch 36 ============
cnt=[1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (3) | Train Loss: 0.1113 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.1153 | Train Acc: 0.9778
 Site-art_painting              (2) | Train Loss: 0.3122 | Train Acc: 0.9267
 Site-art_painting              (2) | Train Loss: 0.3622 | Train Acc: 0.9333
 Site-cartoon                   (5) | Train Loss: 0.3476 | Train Acc: 0.8800
 Site-cartoon                   (0) | Train Loss: 0.2890 | Train Acc: 0.8978
 Site-sketch                    (4) | Train Loss: 0.4743 | Train Acc: 0.8133
 Site-sketch                    (1) | Train Loss: 0.4228 | Train Acc: 0.8489
Average Train Accuracy: 0.9064
 Site-photo                     (3) | Val  Loss: 0.1626 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.1208 | Val  Acc: 0.9767
 Site-art_painting              (2) | Val  Loss: 0.2822 | Val  Acc: 0.9300
 Site-art_painting              (2) | Val  Loss: 0.2645 | Val  Acc: 0.9267
 Site-cartoon                   (5) | Val  Loss: 0.4296 | Val  Acc: 0.8100
 Site-cartoon                   (0) | Val  Loss: 0.3400 | Val  Acc: 0.8800
 Site-sketch                    (4) | Val  Loss: 0.4160 | Val  Acc: 0.8500
 Site-sketch                    (1) | Val  Loss: 0.4760 | Val  Acc: 0.8200
Average Valid Accuracy: 0.8942
============ Train epoch 37 ============
cnt=[1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (2) | Train Loss: 0.1698 | Train Acc: 0.9733
 Site-photo                     (2) | Train Loss: 0.0977 | Train Acc: 0.9778
 Site-art_painting              (3) | Train Loss: 0.2985 | Train Acc: 0.9333
 Site-art_painting              (5) | Train Loss: 0.2951 | Train Acc: 0.9356
 Site-cartoon                   (4) | Train Loss: 0.3698 | Train Acc: 0.9000
 Site-cartoon                   (0) | Train Loss: 0.3195 | Train Acc: 0.8733
 Site-sketch                    (1) | Train Loss: 0.5251 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.4884 | Train Acc: 0.8178
Average Train Accuracy: 0.9039
 Site-photo                     (2) | Val  Loss: 0.1200 | Val  Acc: 0.9700
 Site-photo                     (2) | Val  Loss: 0.1137 | Val  Acc: 0.9800
 Site-art_painting              (3) | Val  Loss: 0.3406 | Val  Acc: 0.8700
 Site-art_painting              (5) | Val  Loss: 0.2278 | Val  Acc: 0.9333
 Site-cartoon                   (4) | Val  Loss: 0.3935 | Val  Acc: 0.8900
 Site-cartoon                   (0) | Val  Loss: 0.3428 | Val  Acc: 0.8767
 Site-sketch                    (1) | Val  Loss: 0.4689 | Val  Acc: 0.8400
 Site-sketch                    (1) | Val  Loss: 0.4662 | Val  Acc: 0.8100
Average Valid Accuracy: 0.8962
============ Train epoch 38 ============
cnt=[2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (0) | Train Loss: 0.1063 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.0988 | Train Acc: 0.9778
 Site-art_painting              (3) | Train Loss: 0.3696 | Train Acc: 0.9067
 Site-art_painting              (3) | Train Loss: 0.2680 | Train Acc: 0.9044
 Site-cartoon                   (2) | Train Loss: 0.3254 | Train Acc: 0.9200
 Site-cartoon                   (5) | Train Loss: 0.3675 | Train Acc: 0.9044
 Site-sketch                    (4) | Train Loss: 0.4826 | Train Acc: 0.7933
 Site-sketch                    (1) | Train Loss: 0.4426 | Train Acc: 0.8467
Average Train Accuracy: 0.9050
 Site-photo                     (0) | Val  Loss: 0.1129 | Val  Acc: 0.9700
 Site-photo                     (0) | Val  Loss: 0.1237 | Val  Acc: 0.9833
 Site-art_painting              (3) | Val  Loss: 0.2835 | Val  Acc: 0.8900
 Site-art_painting              (3) | Val  Loss: 0.2776 | Val  Acc: 0.9267
 Site-cartoon                   (2) | Val  Loss: 0.3674 | Val  Acc: 0.8400
 Site-cartoon                   (5) | Val  Loss: 0.3250 | Val  Acc: 0.8867
 Site-sketch                    (4) | Val  Loss: 0.4334 | Val  Acc: 0.9000
 Site-sketch                    (1) | Val  Loss: 0.4795 | Val  Acc: 0.8200
Average Valid Accuracy: 0.9021
============ Train epoch 39 ============
cnt=[1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (1) | Train Loss: 0.1163 | Train Acc: 0.9667
 Site-photo                     (1) | Train Loss: 0.0984 | Train Acc: 0.9800
 Site-art_painting              (3) | Train Loss: 0.2667 | Train Acc: 0.9000
 Site-art_painting              (3) | Train Loss: 0.2542 | Train Acc: 0.9244
 Site-cartoon                   (2) | Train Loss: 0.3075 | Train Acc: 0.9000
 Site-cartoon                   (4) | Train Loss: 0.2648 | Train Acc: 0.8911
 Site-sketch                    (5) | Train Loss: 0.4695 | Train Acc: 0.8200
 Site-sketch                    (0) | Train Loss: 0.4331 | Train Acc: 0.8333
Average Train Accuracy: 0.9019
 Site-photo                     (1) | Val  Loss: 0.1099 | Val  Acc: 0.9700
 Site-photo                     (1) | Val  Loss: 0.1269 | Val  Acc: 0.9800
 Site-art_painting              (3) | Val  Loss: 0.3528 | Val  Acc: 0.9000
 Site-art_painting              (3) | Val  Loss: 0.2601 | Val  Acc: 0.9300
 Site-cartoon                   (2) | Val  Loss: 0.3274 | Val  Acc: 0.8800
 Site-cartoon                   (4) | Val  Loss: 0.2916 | Val  Acc: 0.9233
 Site-sketch                    (5) | Val  Loss: 0.4306 | Val  Acc: 0.8600
 Site-sketch                    (0) | Val  Loss: 0.4231 | Val  Acc: 0.8600
Average Valid Accuracy: 0.9129
 Best site-photo                    (1)  | Epoch:39 | Val Acc: 0.9700
 Best site-photo                    (1)  | Epoch:39 | Val Acc: 0.9800
 Best site-art_painting             (3)  | Epoch:39 | Val Acc: 0.9000
 Best site-art_painting             (3)  | Epoch:39 | Val Acc: 0.9300
 Best site-cartoon                  (2)  | Epoch:39 | Val Acc: 0.8800
 Best site-cartoon                  (4)  | Epoch:39 | Val Acc: 0.9233
 Best site-sketch                   (5)  | Epoch:39 | Val Acc: 0.8600
 Best site-sketch                   (0)  | Epoch:39 | Val Acc: 0.8600
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 40 ============
cnt=[1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (1) | Train Loss: 0.1438 | Train Acc: 0.9667
 Site-photo                     (5) | Train Loss: 0.1146 | Train Acc: 0.9689
 Site-art_painting              (3) | Train Loss: 0.3060 | Train Acc: 0.8800
 Site-art_painting              (3) | Train Loss: 0.2176 | Train Acc: 0.9311
 Site-cartoon                   (2) | Train Loss: 0.3590 | Train Acc: 0.9133
 Site-cartoon                   (2) | Train Loss: 0.2637 | Train Acc: 0.8978
 Site-sketch                    (0) | Train Loss: 0.5044 | Train Acc: 0.8467
 Site-sketch                    (4) | Train Loss: 0.3737 | Train Acc: 0.8578
Average Train Accuracy: 0.9078
 Site-photo                     (1) | Val  Loss: 0.1623 | Val  Acc: 0.9600
 Site-photo                     (5) | Val  Loss: 0.1389 | Val  Acc: 0.9733
 Site-art_painting              (3) | Val  Loss: 0.2995 | Val  Acc: 0.9200
 Site-art_painting              (3) | Val  Loss: 0.2487 | Val  Acc: 0.9167
 Site-cartoon                   (2) | Val  Loss: 0.3700 | Val  Acc: 0.8500
 Site-cartoon                   (2) | Val  Loss: 0.2770 | Val  Acc: 0.9033
 Site-sketch                    (0) | Val  Loss: 0.4165 | Val  Acc: 0.8900
 Site-sketch                    (4) | Val  Loss: 0.4728 | Val  Acc: 0.8467
Average Valid Accuracy: 0.9075
 Test site-photo                     (1)| Epoch:39 | Test Acc: 0.9925
 Test site-art_painting              (3)| Epoch:39 | Test Acc: 0.9196
 Test site-cartoon                   (2)| Epoch:39 | Test Acc: 0.8915
 Test site-sketch                    (0)| Epoch:39 | Test Acc: 0.8634
photo: 0.9925, art_painting: 0.9196, cartoon: 0.8915, sketch: 0.8634, 
Average Test Accuracy(group): 0.9168, Average Test Accuracy(individual): 0.9168,
domain std=0.0481, cluster std=0.0544, individual std=0.0481, 
Average Test Accuracy: 0.9168
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 41 ============
cnt=[2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-photo                     (0) | Train Loss: 0.0939 | Train Acc: 0.9800
 Site-photo                     (0) | Train Loss: 0.1130 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.3217 | Train Acc: 0.8800
 Site-art_painting              (3) | Train Loss: 0.2268 | Train Acc: 0.9156
 Site-cartoon                   (5) | Train Loss: 0.2892 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.2496 | Train Acc: 0.9133
 Site-sketch                    (4) | Train Loss: 0.4476 | Train Acc: 0.8267
 Site-sketch                    (1) | Train Loss: 0.3969 | Train Acc: 0.8289
Average Train Accuracy: 0.9047
 Site-photo                     (0) | Val  Loss: 0.1151 | Val  Acc: 0.9700
 Site-photo                     (0) | Val  Loss: 0.1028 | Val  Acc: 0.9767
 Site-art_painting              (3) | Val  Loss: 0.3381 | Val  Acc: 0.8900
 Site-art_painting              (3) | Val  Loss: 0.2458 | Val  Acc: 0.9200
 Site-cartoon                   (5) | Val  Loss: 0.3812 | Val  Acc: 0.8600
 Site-cartoon                   (2) | Val  Loss: 0.3057 | Val  Acc: 0.9100
 Site-sketch                    (4) | Val  Loss: 0.4009 | Val  Acc: 0.8800
 Site-sketch                    (1) | Val  Loss: 0.4138 | Val  Acc: 0.8700
Average Valid Accuracy: 0.9096
 Test site-photo                     (0)| Epoch:40 | Test Acc: 0.9925
 Test site-art_painting              (3)| Epoch:40 | Test Acc: 0.9147
 Test site-cartoon                   (5)| Epoch:40 | Test Acc: 0.8926
 Test site-sketch                    (4)| Epoch:40 | Test Acc: 0.8628
photo: 0.9925, art_painting: 0.9147, cartoon: 0.8926, sketch: 0.8628, 
Average Test Accuracy(group): 0.9156, Average Test Accuracy(individual): 0.9156,
domain std=0.0481, cluster std=0.0440, individual std=0.0481, 
Average Test Accuracy: 0.9156
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 42 ============
cnt=[1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-photo                     (0) | Train Loss: 0.1066 | Train Acc: 0.9933
 Site-photo                     (5) | Train Loss: 0.1084 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.2805 | Train Acc: 0.9200
 Site-art_painting              (3) | Train Loss: 0.2328 | Train Acc: 0.9222
 Site-cartoon                   (2) | Train Loss: 0.2919 | Train Acc: 0.9333
 Site-cartoon                   (2) | Train Loss: 0.2412 | Train Acc: 0.9267
 Site-sketch                    (1) | Train Loss: 0.4839 | Train Acc: 0.8200
 Site-sketch                    (4) | Train Loss: 0.6300 | Train Acc: 0.8444
Average Train Accuracy: 0.9167
 Site-photo                     (0) | Val  Loss: 0.1058 | Val  Acc: 0.9700
 Site-photo                     (5) | Val  Loss: 0.1145 | Val  Acc: 0.9767
 Site-art_painting              (3) | Val  Loss: 0.2982 | Val  Acc: 0.9200
 Site-art_painting              (3) | Val  Loss: 0.2269 | Val  Acc: 0.9233
 Site-cartoon                   (2) | Val  Loss: 0.2833 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.2818 | Val  Acc: 0.9067
 Site-sketch                    (1) | Val  Loss: 0.4127 | Val  Acc: 0.8600
 Site-sketch                    (4) | Val  Loss: 0.4697 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9113
 Test site-photo                     (0)| Epoch:41 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:41 | Test Acc: 0.9208
 Test site-cartoon                   (2)| Epoch:41 | Test Acc: 0.8915
 Test site-sketch                    (1)| Epoch:41 | Test Acc: 0.8482
photo: 0.9896, art_painting: 0.9208, cartoon: 0.8915, sketch: 0.8482, 
Average Test Accuracy(group): 0.9125, Average Test Accuracy(individual): 0.9125,
domain std=0.0514, cluster std=0.0586, individual std=0.0514, 
Average Test Accuracy: 0.9125
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 43 ============
cnt=[1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-photo                     (1) | Train Loss: 0.0977 | Train Acc: 0.9933
 Site-photo                     (1) | Train Loss: 0.1029 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.2311 | Train Acc: 0.9400
 Site-art_painting              (3) | Train Loss: 0.2023 | Train Acc: 0.9311
 Site-cartoon                   (5) | Train Loss: 0.2605 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.2338 | Train Acc: 0.9222
 Site-sketch                    (0) | Train Loss: 0.4279 | Train Acc: 0.8600
 Site-sketch                    (4) | Train Loss: 0.4532 | Train Acc: 0.8489
Average Train Accuracy: 0.9236
 Site-photo                     (1) | Val  Loss: 0.1486 | Val  Acc: 0.9600
 Site-photo                     (1) | Val  Loss: 0.1270 | Val  Acc: 0.9667
 Site-art_painting              (3) | Val  Loss: 0.3128 | Val  Acc: 0.8800
 Site-art_painting              (3) | Val  Loss: 0.2541 | Val  Acc: 0.9200
 Site-cartoon                   (5) | Val  Loss: 0.3949 | Val  Acc: 0.8300
 Site-cartoon                   (2) | Val  Loss: 0.2783 | Val  Acc: 0.9100
 Site-sketch                    (0) | Val  Loss: 0.3858 | Val  Acc: 0.8500
 Site-sketch                    (4) | Val  Loss: 0.4038 | Val  Acc: 0.8633
Average Valid Accuracy: 0.8975
 Test site-photo                     (1)| Epoch:42 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:42 | Test Acc: 0.9233
 Test site-cartoon                   (5)| Epoch:42 | Test Acc: 0.8894
 Test site-sketch                    (0)| Epoch:42 | Test Acc: 0.8590
photo: 0.9896, art_painting: 0.9233, cartoon: 0.8894, sketch: 0.8590, 
Average Test Accuracy(group): 0.9153, Average Test Accuracy(individual): 0.9153,
domain std=0.0485, cluster std=0.0450, individual std=0.0485, 
Average Test Accuracy: 0.9153
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 44 ============
cnt=[2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-photo                     (3) | Train Loss: 0.1146 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.1005 | Train Acc: 0.9733
 Site-art_painting              (0) | Train Loss: 0.2569 | Train Acc: 0.9200
 Site-art_painting              (0) | Train Loss: 0.2108 | Train Acc: 0.9422
 Site-cartoon                   (5) | Train Loss: 0.3098 | Train Acc: 0.9333
 Site-cartoon                   (2) | Train Loss: 0.2837 | Train Acc: 0.9089
 Site-sketch                    (4) | Train Loss: 0.4212 | Train Acc: 0.8467
 Site-sketch                    (1) | Train Loss: 0.4754 | Train Acc: 0.8311
Average Train Accuracy: 0.9161
 Site-photo                     (3) | Val  Loss: 0.1150 | Val  Acc: 0.9800
 Site-photo                     (3) | Val  Loss: 0.1192 | Val  Acc: 0.9633
 Site-art_painting              (0) | Val  Loss: 0.2968 | Val  Acc: 0.9200
 Site-art_painting              (0) | Val  Loss: 0.2526 | Val  Acc: 0.9233
 Site-cartoon                   (5) | Val  Loss: 0.3286 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.2754 | Val  Acc: 0.9133
 Site-sketch                    (4) | Val  Loss: 0.3411 | Val  Acc: 0.8900
 Site-sketch                    (1) | Val  Loss: 0.4116 | Val  Acc: 0.8400
Average Valid Accuracy: 0.9138
 Best site-photo                    (3)  | Epoch:44 | Val Acc: 0.9800
 Best site-photo                    (3)  | Epoch:44 | Val Acc: 0.9633
 Best site-art_painting             (0)  | Epoch:44 | Val Acc: 0.9200
 Best site-art_painting             (0)  | Epoch:44 | Val Acc: 0.9233
 Best site-cartoon                  (5)  | Epoch:44 | Val Acc: 0.8800
 Best site-cartoon                  (2)  | Epoch:44 | Val Acc: 0.9133
 Best site-sketch                   (4)  | Epoch:44 | Val Acc: 0.8900
 Best site-sketch                   (1)  | Epoch:44 | Val Acc: 0.8400
 Test site-photo                     (3)| Epoch:44 | Test Acc: 0.9910
 Test site-art_painting              (0)| Epoch:44 | Test Acc: 0.9220
 Test site-cartoon                   (5)| Epoch:44 | Test Acc: 0.8957
 Test site-sketch                    (4)| Epoch:44 | Test Acc: 0.8545
photo: 0.9910, art_painting: 0.9220, cartoon: 0.8957, sketch: 0.8545, 
Average Test Accuracy(group): 0.9158, Average Test Accuracy(individual): 0.9158,
domain std=0.0496, cluster std=0.0464, individual std=0.0496, 
Average Test Accuracy: 0.9158
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 45 ============
cnt=[2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-photo                     (0) | Train Loss: 0.1355 | Train Acc: 0.9533
 Site-photo                     (0) | Train Loss: 0.0944 | Train Acc: 0.9844
 Site-art_painting              (3) | Train Loss: 0.2405 | Train Acc: 0.9200
 Site-art_painting              (3) | Train Loss: 0.4114 | Train Acc: 0.9244
 Site-cartoon                   (4) | Train Loss: 0.2781 | Train Acc: 0.9467
 Site-cartoon                   (2) | Train Loss: 0.2365 | Train Acc: 0.9089
 Site-sketch                    (1) | Train Loss: 0.5305 | Train Acc: 0.8400
 Site-sketch                    (5) | Train Loss: 0.3868 | Train Acc: 0.8578
Average Train Accuracy: 0.9169
 Site-photo                     (0) | Val  Loss: 0.1124 | Val  Acc: 0.9800
 Site-photo                     (0) | Val  Loss: 0.1164 | Val  Acc: 0.9800
 Site-art_painting              (3) | Val  Loss: 0.2430 | Val  Acc: 0.9300
 Site-art_painting              (3) | Val  Loss: 0.2630 | Val  Acc: 0.9200
 Site-cartoon                   (4) | Val  Loss: 0.3398 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.3130 | Val  Acc: 0.8933
 Site-sketch                    (1) | Val  Loss: 0.3285 | Val  Acc: 0.8800
 Site-sketch                    (5) | Val  Loss: 0.4138 | Val  Acc: 0.8667
Average Valid Accuracy: 0.9163
 Best site-photo                    (0)  | Epoch:45 | Val Acc: 0.9800
 Best site-photo                    (0)  | Epoch:45 | Val Acc: 0.9800
 Best site-art_painting             (3)  | Epoch:45 | Val Acc: 0.9300
 Best site-art_painting             (3)  | Epoch:45 | Val Acc: 0.9200
 Best site-cartoon                  (4)  | Epoch:45 | Val Acc: 0.8800
 Best site-cartoon                  (2)  | Epoch:45 | Val Acc: 0.8933
 Best site-sketch                   (1)  | Epoch:45 | Val Acc: 0.8800
 Best site-sketch                   (5)  | Epoch:45 | Val Acc: 0.8667
 Test site-photo                     (0)| Epoch:45 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:45 | Test Acc: 0.9220
 Test site-cartoon                   (4)| Epoch:45 | Test Acc: 0.8894
 Test site-sketch                    (1)| Epoch:45 | Test Acc: 0.8443
photo: 0.9896, art_painting: 0.9220, cartoon: 0.8894, sketch: 0.8443, 
Average Test Accuracy(group): 0.9113, Average Test Accuracy(individual): 0.9113,
domain std=0.0529, cluster std=0.0498, individual std=0.0529, 
Average Test Accuracy: 0.9113
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 46 ============
cnt=[1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-photo                     (5) | Train Loss: 0.0904 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.0929 | Train Acc: 0.9844
 Site-art_painting              (1) | Train Loss: 0.2338 | Train Acc: 0.9267
 Site-art_painting              (1) | Train Loss: 0.1878 | Train Acc: 0.9311
 Site-cartoon                   (2) | Train Loss: 0.3381 | Train Acc: 0.9333
 Site-cartoon                   (2) | Train Loss: 0.2714 | Train Acc: 0.9067
 Site-sketch                    (0) | Train Loss: 0.5044 | Train Acc: 0.8467
 Site-sketch                    (4) | Train Loss: 0.3607 | Train Acc: 0.8667
Average Train Accuracy: 0.9219
 Site-photo                     (5) | Val  Loss: 0.1152 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1213 | Val  Acc: 0.9700
 Site-art_painting              (1) | Val  Loss: 0.2514 | Val  Acc: 0.9000
 Site-art_painting              (1) | Val  Loss: 0.2305 | Val  Acc: 0.9367
 Site-cartoon                   (2) | Val  Loss: 0.2922 | Val  Acc: 0.9100
 Site-cartoon                   (2) | Val  Loss: 0.3164 | Val  Acc: 0.9033
 Site-sketch                    (0) | Val  Loss: 0.3928 | Val  Acc: 0.8500
 Site-sketch                    (4) | Val  Loss: 0.4179 | Val  Acc: 0.8467
Average Valid Accuracy: 0.9108
 Test site-photo                     (5)| Epoch:45 | Test Acc: 0.9925
 Test site-art_painting              (1)| Epoch:45 | Test Acc: 0.9257
 Test site-cartoon                   (2)| Epoch:45 | Test Acc: 0.8819
 Test site-sketch                    (0)| Epoch:45 | Test Acc: 0.8469
photo: 0.9925, art_painting: 0.9257, cartoon: 0.8819, sketch: 0.8469, 
Average Test Accuracy(group): 0.9118, Average Test Accuracy(individual): 0.9118,
domain std=0.0544, cluster std=0.0613, individual std=0.0544, 
Average Test Accuracy: 0.9118
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 47 ============
cnt=[1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-photo                     (1) | Train Loss: 0.1154 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.0913 | Train Acc: 0.9778
 Site-art_painting              (3) | Train Loss: 0.2945 | Train Acc: 0.9467
 Site-art_painting              (3) | Train Loss: 0.2006 | Train Acc: 0.9356
 Site-cartoon                   (5) | Train Loss: 0.2788 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.2578 | Train Acc: 0.9133
 Site-sketch                    (0) | Train Loss: 0.4037 | Train Acc: 0.8800
 Site-sketch                    (4) | Train Loss: 0.5200 | Train Acc: 0.8311
Average Train Accuracy: 0.9231
 Site-photo                     (1) | Val  Loss: 0.0937 | Val  Acc: 0.9700
 Site-photo                     (1) | Val  Loss: 0.1141 | Val  Acc: 0.9667
 Site-art_painting              (3) | Val  Loss: 0.2960 | Val  Acc: 0.9100
 Site-art_painting              (3) | Val  Loss: 0.2358 | Val  Acc: 0.9267
 Site-cartoon                   (5) | Val  Loss: 0.2989 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.2631 | Val  Acc: 0.9433
 Site-sketch                    (0) | Val  Loss: 0.3738 | Val  Acc: 0.8900
 Site-sketch                    (4) | Val  Loss: 0.4040 | Val  Acc: 0.8467
Average Valid Accuracy: 0.9192
 Best site-photo                    (1)  | Epoch:47 | Val Acc: 0.9700
 Best site-photo                    (1)  | Epoch:47 | Val Acc: 0.9667
 Best site-art_painting             (3)  | Epoch:47 | Val Acc: 0.9100
 Best site-art_painting             (3)  | Epoch:47 | Val Acc: 0.9267
 Best site-cartoon                  (5)  | Epoch:47 | Val Acc: 0.9000
 Best site-cartoon                  (2)  | Epoch:47 | Val Acc: 0.9433
 Best site-sketch                   (0)  | Epoch:47 | Val Acc: 0.8900
 Best site-sketch                   (4)  | Epoch:47 | Val Acc: 0.8467
 Test site-photo                     (1)| Epoch:47 | Test Acc: 0.9925
 Test site-art_painting              (3)| Epoch:47 | Test Acc: 0.9245
 Test site-cartoon                   (5)| Epoch:47 | Test Acc: 0.8904
 Test site-sketch                    (0)| Epoch:47 | Test Acc: 0.8564
photo: 0.9925, art_painting: 0.9245, cartoon: 0.8904, sketch: 0.8564, 
Average Test Accuracy(group): 0.9160, Average Test Accuracy(individual): 0.9160,
domain std=0.0503, cluster std=0.0468, individual std=0.0503, 
Average Test Accuracy: 0.9160
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 48 ============
cnt=[1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-photo                     (3) | Train Loss: 0.1004 | Train Acc: 0.9933
 Site-photo                     (3) | Train Loss: 0.1148 | Train Acc: 0.9733
 Site-art_painting              (5) | Train Loss: 0.2762 | Train Acc: 0.9200
 Site-art_painting              (1) | Train Loss: 0.1831 | Train Acc: 0.9467
 Site-cartoon                   (2) | Train Loss: 0.3137 | Train Acc: 0.8867
 Site-cartoon                   (2) | Train Loss: 0.2854 | Train Acc: 0.9133
 Site-sketch                    (0) | Train Loss: 0.4524 | Train Acc: 0.8867
 Site-sketch                    (4) | Train Loss: 0.3586 | Train Acc: 0.8578
Average Train Accuracy: 0.9222
 Site-photo                     (3) | Val  Loss: 0.1121 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1044 | Val  Acc: 0.9767
 Site-art_painting              (5) | Val  Loss: 0.2507 | Val  Acc: 0.9100
 Site-art_painting              (1) | Val  Loss: 0.2262 | Val  Acc: 0.9433
 Site-cartoon                   (2) | Val  Loss: 0.3036 | Val  Acc: 0.8500
 Site-cartoon                   (2) | Val  Loss: 0.2895 | Val  Acc: 0.9000
 Site-sketch                    (0) | Val  Loss: 0.3724 | Val  Acc: 0.8800
 Site-sketch                    (4) | Val  Loss: 0.3985 | Val  Acc: 0.8700
Average Valid Accuracy: 0.9125
 Test site-photo                     (3)| Epoch:47 | Test Acc: 0.9910
 Test site-art_painting              (5)| Epoch:47 | Test Acc: 0.9208
 Test site-cartoon                   (2)| Epoch:47 | Test Acc: 0.8851
 Test site-sketch                    (0)| Epoch:47 | Test Acc: 0.8634
photo: 0.9910, art_painting: 0.9208, cartoon: 0.8851, sketch: 0.8634, 
Average Test Accuracy(group): 0.9151, Average Test Accuracy(individual): 0.9151,
domain std=0.0484, cluster std=0.0442, individual std=0.0484, 
Average Test Accuracy: 0.9151
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
============ Train epoch 49 ============
cnt=[1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-photo                     (3) | Train Loss: 0.1039 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.0950 | Train Acc: 0.9800
 Site-art_painting              (1) | Train Loss: 0.2465 | Train Acc: 0.9267
 Site-art_painting              (1) | Train Loss: 0.2518 | Train Acc: 0.9267
 Site-cartoon                   (5) | Train Loss: 0.2773 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.2350 | Train Acc: 0.9289
 Site-sketch                    (4) | Train Loss: 0.3991 | Train Acc: 0.8200
 Site-sketch                    (0) | Train Loss: 0.3625 | Train Acc: 0.8689
Average Train Accuracy: 0.9189
 Site-photo                     (3) | Val  Loss: 0.1212 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1128 | Val  Acc: 0.9767
 Site-art_painting              (1) | Val  Loss: 0.2825 | Val  Acc: 0.9000
 Site-art_painting              (1) | Val  Loss: 0.2040 | Val  Acc: 0.9500
 Site-cartoon                   (5) | Val  Loss: 0.3124 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.2842 | Val  Acc: 0.9133
 Site-sketch                    (4) | Val  Loss: 0.3236 | Val  Acc: 0.9000
 Site-sketch                    (0) | Val  Loss: 0.4026 | Val  Acc: 0.8600
Average Valid Accuracy: 0.9213
 Best site-photo                    (3)  | Epoch:49 | Val Acc: 0.9700
 Best site-photo                    (3)  | Epoch:49 | Val Acc: 0.9767
 Best site-art_painting             (1)  | Epoch:49 | Val Acc: 0.9000
 Best site-art_painting             (1)  | Epoch:49 | Val Acc: 0.9500
 Best site-cartoon                  (5)  | Epoch:49 | Val Acc: 0.9000
 Best site-cartoon                  (2)  | Epoch:49 | Val Acc: 0.9133
 Best site-sketch                   (4)  | Epoch:49 | Val Acc: 0.9000
 Best site-sketch                   (0)  | Epoch:49 | Val Acc: 0.8600
 Test site-photo                     (3)| Epoch:49 | Test Acc: 0.9896
 Test site-art_painting              (1)| Epoch:49 | Test Acc: 0.9196
 Test site-cartoon                   (5)| Epoch:49 | Test Acc: 0.8894
 Test site-sketch                    (4)| Epoch:49 | Test Acc: 0.8653
photo: 0.9896, art_painting: 0.9196, cartoon: 0.8894, sketch: 0.8653, 
Average Test Accuracy(group): 0.9160, Average Test Accuracy(individual): 0.9160,
domain std=0.0466, cluster std=0.0428, individual std=0.0466, 
Average Test Accuracy: 0.9160
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_6/ccop_q=1...
===2023-08-11 01:38:52===
===2023-08-11 01:39:08===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 6
Loading snapshots...
 Test site-photo                     (3)| Epoch:49 | Test Acc: 0.9896
 Test site-art_painting              (1)| Epoch:49 | Test Acc: 0.9196
 Test site-cartoon                   (5)| Epoch:49 | Test Acc: 0.8894
 Test site-sketch                    (4)| Epoch:49 | Test Acc: 0.8653
photo: 0.9896, art_painting: 0.9196, cartoon: 0.8894, sketch: 0.8653, 
Average Test Accuracy(group): 0.9160, Average Test Accuracy(individual): 0.9160,
domain std=0.0466, cluster std=0.0428, individual std=0.0466, 
