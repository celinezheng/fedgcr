===2023-07-28 11:21:22===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
============ Train epoch 0 ============
denominator: 42969.27734375
 Site-Clipart                       | Train Loss: 2.2275 | Train Acc: 0.3478
 Site-Clipart                       | Train Loss: 2.2216 | Train Acc: 0.3416
 Site-Clipart                       | Train Loss: 2.2209 | Train Acc: 0.3200
 Site-Clipart                       | Train Loss: 2.2187 | Train Acc: 0.3165
 Site-Clipart                       | Train Loss: 2.2234 | Train Acc: 0.3122
 Site-Real                          | Train Loss: 2.1956 | Train Acc: 0.4762
 Site-Real                          | Train Loss: 2.1996 | Train Acc: 0.4859
 Site-Real                          | Train Loss: 2.1984 | Train Acc: 0.4960
 Site-Real                          | Train Loss: 2.2046 | Train Acc: 0.4626
 Site-Painting                      | Train Loss: 2.2073 | Train Acc: 0.3946
 Site-Painting                      | Train Loss: 2.2167 | Train Acc: 0.3883
 Site-Painting                      | Train Loss: 2.2090 | Train Acc: 0.4187
 Site-Sketch                        | Train Loss: 2.2206 | Train Acc: 0.3455
 Site-Sketch                        | Train Loss: 2.2250 | Train Acc: 0.3184
 Site-QuickDraw                     | Train Loss: 2.2910 | Train Acc: 0.1376
 Site-Infograph                     | Train Loss: 2.2872 | Train Acc: 0.1453
Average Train Accuracy: 0.3567
 Site-Clipart                       | Val  Loss: 2.1942 | Val  Acc: 0.4079
 Site-Clipart                       | Val  Loss: 2.1984 | Val  Acc: 0.4393
 Site-Clipart                       | Val  Loss: 2.2028 | Val  Acc: 0.3733
 Site-Clipart                       | Val  Loss: 2.2217 | Val  Acc: 0.2857
 Site-Clipart                       | Val  Loss: 2.2187 | Val  Acc: 0.3390
 Site-Real                          | Val  Loss: 2.1939 | Val  Acc: 0.4048
 Site-Real                          | Val  Loss: 2.1927 | Val  Acc: 0.4576
 Site-Real                          | Val  Loss: 2.1989 | Val  Acc: 0.5273
 Site-Real                          | Val  Loss: 2.1976 | Val  Acc: 0.4892
 Site-Painting                      | Val  Loss: 2.2282 | Val  Acc: 0.3367
 Site-Painting                      | Val  Loss: 2.2191 | Val  Acc: 0.3504
 Site-Painting                      | Val  Loss: 2.2147 | Val  Acc: 0.4062
 Site-Sketch                        | Val  Loss: 2.2160 | Val  Acc: 0.3071
 Site-Sketch                        | Val  Loss: 2.2326 | Val  Acc: 0.3202
 Site-QuickDraw                     | Val  Loss: 2.3074 | Val  Acc: 0.1514
 Site-Infograph                     | Val  Loss: 2.2793 | Val  Acc: 0.2115
Average Valid Accuracy: 0.3630
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4079
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4393
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3733
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.2857
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3390
 Best site-Real                      | Epoch:0 | Val Acc: 0.4048
 Best site-Real                      | Epoch:0 | Val Acc: 0.4576
 Best site-Real                      | Epoch:0 | Val Acc: 0.5273
 Best site-Real                      | Epoch:0 | Val Acc: 0.4892
 Best site-Painting                  | Epoch:0 | Val Acc: 0.3367
 Best site-Painting                  | Epoch:0 | Val Acc: 0.3504
 Best site-Painting                  | Epoch:0 | Val Acc: 0.4062
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.3071
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.3202
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.1514
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.2115
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 1 ============
denominator: 41588.1953125
 Site-Clipart                       | Train Loss: 2.1410 | Train Acc: 0.4957
 Site-Clipart                       | Train Loss: 2.1476 | Train Acc: 0.5093
 Site-Clipart                       | Train Loss: 2.1415 | Train Acc: 0.5067
 Site-Clipart                       | Train Loss: 2.1356 | Train Acc: 0.5506
 Site-Clipart                       | Train Loss: 2.1461 | Train Acc: 0.5136
 Site-Real                          | Train Loss: 2.0977 | Train Acc: 0.7302
 Site-Real                          | Train Loss: 2.0966 | Train Acc: 0.7401
 Site-Real                          | Train Loss: 2.0893 | Train Acc: 0.7782
 Site-Real                          | Train Loss: 2.1071 | Train Acc: 0.7040
 Site-Painting                      | Train Loss: 2.1102 | Train Acc: 0.6599
 Site-Painting                      | Train Loss: 2.1291 | Train Acc: 0.6214
 Site-Painting                      | Train Loss: 2.1162 | Train Acc: 0.6332
 Site-Sketch                        | Train Loss: 2.1351 | Train Acc: 0.5236
 Site-Sketch                        | Train Loss: 2.1360 | Train Acc: 0.5206
 Site-QuickDraw                     | Train Loss: 2.2774 | Train Acc: 0.1651
 Site-Infograph                     | Train Loss: 2.2512 | Train Acc: 0.2393
Average Train Accuracy: 0.5557
 Site-Clipart                       | Val  Loss: 2.0902 | Val  Acc: 0.5921
 Site-Clipart                       | Val  Loss: 2.1285 | Val  Acc: 0.5327
 Site-Clipart                       | Val  Loss: 2.1335 | Val  Acc: 0.5933
 Site-Clipart                       | Val  Loss: 2.1279 | Val  Acc: 0.5571
 Site-Clipart                       | Val  Loss: 2.1369 | Val  Acc: 0.5356
 Site-Real                          | Val  Loss: 2.0967 | Val  Acc: 0.7024
 Site-Real                          | Val  Loss: 2.0953 | Val  Acc: 0.7542
 Site-Real                          | Val  Loss: 2.0853 | Val  Acc: 0.7273
 Site-Real                          | Val  Loss: 2.0872 | Val  Acc: 0.7879
 Site-Painting                      | Val  Loss: 2.1244 | Val  Acc: 0.5714
 Site-Painting                      | Val  Loss: 2.1300 | Val  Acc: 0.5474
 Site-Painting                      | Val  Loss: 2.1162 | Val  Acc: 0.6615
 Site-Sketch                        | Val  Loss: 2.1155 | Val  Acc: 0.5669
 Site-Sketch                        | Val  Loss: 2.1411 | Val  Acc: 0.4551
 Site-QuickDraw                     | Val  Loss: 2.2864 | Val  Acc: 0.1468
 Site-Infograph                     | Val  Loss: 2.2521 | Val  Acc: 0.2756
Average Valid Accuracy: 0.5630
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5921
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5327
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5933
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5571
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5356
 Best site-Real                      | Epoch:1 | Val Acc: 0.7024
 Best site-Real                      | Epoch:1 | Val Acc: 0.7542
 Best site-Real                      | Epoch:1 | Val Acc: 0.7273
 Best site-Real                      | Epoch:1 | Val Acc: 0.7879
 Best site-Painting                  | Epoch:1 | Val Acc: 0.5714
 Best site-Painting                  | Epoch:1 | Val Acc: 0.5474
 Best site-Painting                  | Epoch:1 | Val Acc: 0.6615
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.5669
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.4551
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.1468
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.2756
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 2 ============
denominator: 40338.92578125
 Site-Clipart                       | Train Loss: 2.0592 | Train Acc: 0.6261
 Site-Clipart                       | Train Loss: 2.0474 | Train Acc: 0.6398
 Site-Clipart                       | Train Loss: 2.0606 | Train Acc: 0.6489
 Site-Clipart                       | Train Loss: 2.0553 | Train Acc: 0.6741
 Site-Clipart                       | Train Loss: 2.0647 | Train Acc: 0.6380
 Site-Real                          | Train Loss: 2.0007 | Train Acc: 0.8333
 Site-Real                          | Train Loss: 1.9893 | Train Acc: 0.8475
 Site-Real                          | Train Loss: 1.9820 | Train Acc: 0.8710
 Site-Real                          | Train Loss: 2.0074 | Train Acc: 0.8247
 Site-Painting                      | Train Loss: 2.0350 | Train Acc: 0.7007
 Site-Painting                      | Train Loss: 2.0228 | Train Acc: 0.7136
 Site-Painting                      | Train Loss: 2.0272 | Train Acc: 0.6817
 Site-Sketch                        | Train Loss: 2.0484 | Train Acc: 0.6283
 Site-Sketch                        | Train Loss: 2.0511 | Train Acc: 0.6442
 Site-QuickDraw                     | Train Loss: 2.2581 | Train Acc: 0.2141
 Site-Infograph                     | Train Loss: 2.2147 | Train Acc: 0.3120
Average Train Accuracy: 0.6561
 Site-Clipart                       | Val  Loss: 2.0028 | Val  Acc: 0.6711
 Site-Clipart                       | Val  Loss: 2.0490 | Val  Acc: 0.6355
 Site-Clipart                       | Val  Loss: 2.0638 | Val  Acc: 0.7067
 Site-Clipart                       | Val  Loss: 2.0468 | Val  Acc: 0.6429
 Site-Clipart                       | Val  Loss: 2.0607 | Val  Acc: 0.6068
 Site-Real                          | Val  Loss: 1.9957 | Val  Acc: 0.7976
 Site-Real                          | Val  Loss: 1.9928 | Val  Acc: 0.8644
 Site-Real                          | Val  Loss: 1.9764 | Val  Acc: 0.8909
 Site-Real                          | Val  Loss: 1.9765 | Val  Acc: 0.8918
 Site-Painting                      | Val  Loss: 2.0224 | Val  Acc: 0.6939
 Site-Painting                      | Val  Loss: 2.0314 | Val  Acc: 0.6277
 Site-Painting                      | Val  Loss: 2.0251 | Val  Acc: 0.7448
 Site-Sketch                        | Val  Loss: 2.0503 | Val  Acc: 0.6378
 Site-Sketch                        | Val  Loss: 2.0645 | Val  Acc: 0.5730
 Site-QuickDraw                     | Val  Loss: 2.2682 | Val  Acc: 0.2110
 Site-Infograph                     | Val  Loss: 2.2037 | Val  Acc: 0.3397
Average Valid Accuracy: 0.6585
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6711
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6355
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7067
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6429
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6068
 Best site-Real                      | Epoch:2 | Val Acc: 0.7976
 Best site-Real                      | Epoch:2 | Val Acc: 0.8644
 Best site-Real                      | Epoch:2 | Val Acc: 0.8909
 Best site-Real                      | Epoch:2 | Val Acc: 0.8918
 Best site-Painting                  | Epoch:2 | Val Acc: 0.6939
 Best site-Painting                  | Epoch:2 | Val Acc: 0.6277
 Best site-Painting                  | Epoch:2 | Val Acc: 0.7448
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.6378
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.5730
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.2110
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.3397
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 3 ============
denominator: 38997.484375
 Site-Clipart                       | Train Loss: 1.9735 | Train Acc: 0.6609
 Site-Clipart                       | Train Loss: 1.9495 | Train Acc: 0.7516
 Site-Clipart                       | Train Loss: 1.9926 | Train Acc: 0.6978
 Site-Clipart                       | Train Loss: 1.9638 | Train Acc: 0.7468
 Site-Clipart                       | Train Loss: 1.9916 | Train Acc: 0.6833
 Site-Real                          | Train Loss: 1.9037 | Train Acc: 0.9048
 Site-Real                          | Train Loss: 1.8825 | Train Acc: 0.8927
 Site-Real                          | Train Loss: 1.8686 | Train Acc: 0.8992
 Site-Real                          | Train Loss: 1.9125 | Train Acc: 0.8333
 Site-Painting                      | Train Loss: 1.9206 | Train Acc: 0.7483
 Site-Painting                      | Train Loss: 1.9680 | Train Acc: 0.7621
 Site-Painting                      | Train Loss: 1.9416 | Train Acc: 0.7266
 Site-Sketch                        | Train Loss: 1.9746 | Train Acc: 0.6649
 Site-Sketch                        | Train Loss: 1.9672 | Train Acc: 0.6742
 Site-QuickDraw                     | Train Loss: 2.2232 | Train Acc: 0.2661
 Site-Infograph                     | Train Loss: 2.1816 | Train Acc: 0.3761
Average Train Accuracy: 0.7055
 Site-Clipart                       | Val  Loss: 1.8984 | Val  Acc: 0.7895
 Site-Clipart                       | Val  Loss: 1.9562 | Val  Acc: 0.7196
 Site-Clipart                       | Val  Loss: 1.9687 | Val  Acc: 0.7267
 Site-Clipart                       | Val  Loss: 1.9568 | Val  Acc: 0.7571
 Site-Clipart                       | Val  Loss: 1.9778 | Val  Acc: 0.6746
 Site-Real                          | Val  Loss: 1.8984 | Val  Acc: 0.8571
 Site-Real                          | Val  Loss: 1.8895 | Val  Acc: 0.9068
 Site-Real                          | Val  Loss: 1.8621 | Val  Acc: 0.8970
 Site-Real                          | Val  Loss: 1.8732 | Val  Acc: 0.9134
 Site-Painting                      | Val  Loss: 1.9505 | Val  Acc: 0.7143
 Site-Painting                      | Val  Loss: 1.9400 | Val  Acc: 0.6788
 Site-Painting                      | Val  Loss: 1.9418 | Val  Acc: 0.7604
 Site-Sketch                        | Val  Loss: 1.9642 | Val  Acc: 0.7638
 Site-Sketch                        | Val  Loss: 1.9941 | Val  Acc: 0.6685
 Site-QuickDraw                     | Val  Loss: 2.2525 | Val  Acc: 0.2615
 Site-Infograph                     | Val  Loss: 2.1625 | Val  Acc: 0.3974
Average Valid Accuracy: 0.7179
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7895
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7196
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7267
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7571
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.6746
 Best site-Real                      | Epoch:3 | Val Acc: 0.8571
 Best site-Real                      | Epoch:3 | Val Acc: 0.9068
 Best site-Real                      | Epoch:3 | Val Acc: 0.8970
 Best site-Real                      | Epoch:3 | Val Acc: 0.9134
 Best site-Painting                  | Epoch:3 | Val Acc: 0.7143
 Best site-Painting                  | Epoch:3 | Val Acc: 0.6788
 Best site-Painting                  | Epoch:3 | Val Acc: 0.7604
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.7638
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.6685
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.2615
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.3974
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 4 ============
denominator: 37669.8125
 Site-Clipart                       | Train Loss: 1.8941 | Train Acc: 0.7043
 Site-Clipart                       | Train Loss: 1.8757 | Train Acc: 0.7578
 Site-Clipart                       | Train Loss: 1.9161 | Train Acc: 0.7333
 Site-Clipart                       | Train Loss: 1.8940 | Train Acc: 0.7690
 Site-Clipart                       | Train Loss: 1.9031 | Train Acc: 0.7579
 Site-Real                          | Train Loss: 1.8113 | Train Acc: 0.9048
 Site-Real                          | Train Loss: 1.7731 | Train Acc: 0.9153
 Site-Real                          | Train Loss: 1.7605 | Train Acc: 0.9315
 Site-Real                          | Train Loss: 1.8120 | Train Acc: 0.8621
 Site-Painting                      | Train Loss: 1.8279 | Train Acc: 0.7687
 Site-Painting                      | Train Loss: 1.8743 | Train Acc: 0.8010
 Site-Painting                      | Train Loss: 1.8567 | Train Acc: 0.7612
 Site-Sketch                        | Train Loss: 1.8859 | Train Acc: 0.6911
 Site-Sketch                        | Train Loss: 1.8799 | Train Acc: 0.7191
 Site-QuickDraw                     | Train Loss: 2.2174 | Train Acc: 0.2936
 Site-Infograph                     | Train Loss: 2.1432 | Train Acc: 0.4103
Average Train Accuracy: 0.7363
 Site-Clipart                       | Val  Loss: 1.8129 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 1.8795 | Val  Acc: 0.7757
 Site-Clipart                       | Val  Loss: 1.8936 | Val  Acc: 0.7933
 Site-Clipart                       | Val  Loss: 1.8570 | Val  Acc: 0.7667
 Site-Clipart                       | Val  Loss: 1.9126 | Val  Acc: 0.7254
 Site-Real                          | Val  Loss: 1.7865 | Val  Acc: 0.8452
 Site-Real                          | Val  Loss: 1.7913 | Val  Acc: 0.8983
 Site-Real                          | Val  Loss: 1.7613 | Val  Acc: 0.9212
 Site-Real                          | Val  Loss: 1.7596 | Val  Acc: 0.9394
 Site-Painting                      | Val  Loss: 1.8379 | Val  Acc: 0.7347
 Site-Painting                      | Val  Loss: 1.8446 | Val  Acc: 0.7737
 Site-Painting                      | Val  Loss: 1.8673 | Val  Acc: 0.7656
 Site-Sketch                        | Val  Loss: 1.8861 | Val  Acc: 0.7244
 Site-Sketch                        | Val  Loss: 1.9043 | Val  Acc: 0.7079
 Site-QuickDraw                     | Val  Loss: 2.2368 | Val  Acc: 0.2294
 Site-Infograph                     | Val  Loss: 2.1231 | Val  Acc: 0.3846
Average Valid Accuracy: 0.7335
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7500
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7757
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7933
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7667
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7254
 Best site-Real                      | Epoch:4 | Val Acc: 0.8452
 Best site-Real                      | Epoch:4 | Val Acc: 0.8983
 Best site-Real                      | Epoch:4 | Val Acc: 0.9212
 Best site-Real                      | Epoch:4 | Val Acc: 0.9394
 Best site-Painting                  | Epoch:4 | Val Acc: 0.7347
 Best site-Painting                  | Epoch:4 | Val Acc: 0.7737
 Best site-Painting                  | Epoch:4 | Val Acc: 0.7656
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7244
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7079
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.2294
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.3846
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 5 ============
denominator: 36317.30859375
 Site-Clipart                       | Train Loss: 1.8107 | Train Acc: 0.8000
 Site-Clipart                       | Train Loss: 1.7954 | Train Acc: 0.8261
 Site-Clipart                       | Train Loss: 1.8376 | Train Acc: 0.7733
 Site-Clipart                       | Train Loss: 1.8085 | Train Acc: 0.7753
 Site-Clipart                       | Train Loss: 1.8158 | Train Acc: 0.7760
 Site-Real                          | Train Loss: 1.7097 | Train Acc: 0.9206
 Site-Real                          | Train Loss: 1.6741 | Train Acc: 0.9209
 Site-Real                          | Train Loss: 1.6654 | Train Acc: 0.9355
 Site-Real                          | Train Loss: 1.7233 | Train Acc: 0.8707
 Site-Painting                      | Train Loss: 1.7517 | Train Acc: 0.8299
 Site-Painting                      | Train Loss: 1.7702 | Train Acc: 0.7961
 Site-Painting                      | Train Loss: 1.7830 | Train Acc: 0.7751
 Site-Sketch                        | Train Loss: 1.8072 | Train Acc: 0.7173
 Site-Sketch                        | Train Loss: 1.8209 | Train Acc: 0.7154
 Site-QuickDraw                     | Train Loss: 2.1844 | Train Acc: 0.3028
 Site-Infograph                     | Train Loss: 2.1213 | Train Acc: 0.3803
Average Train Accuracy: 0.7572
 Site-Clipart                       | Val  Loss: 1.7331 | Val  Acc: 0.7632
 Site-Clipart                       | Val  Loss: 1.8120 | Val  Acc: 0.7383
 Site-Clipart                       | Val  Loss: 1.8122 | Val  Acc: 0.8200
 Site-Clipart                       | Val  Loss: 1.7794 | Val  Acc: 0.8048
 Site-Clipart                       | Val  Loss: 1.8340 | Val  Acc: 0.7322
 Site-Real                          | Val  Loss: 1.7091 | Val  Acc: 0.8333
 Site-Real                          | Val  Loss: 1.7000 | Val  Acc: 0.9322
 Site-Real                          | Val  Loss: 1.6602 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 1.6640 | Val  Acc: 0.9481
 Site-Painting                      | Val  Loss: 1.7313 | Val  Acc: 0.8265
 Site-Painting                      | Val  Loss: 1.7720 | Val  Acc: 0.7737
 Site-Painting                      | Val  Loss: 1.7619 | Val  Acc: 0.7812
 Site-Sketch                        | Val  Loss: 1.7985 | Val  Acc: 0.7008
 Site-Sketch                        | Val  Loss: 1.8203 | Val  Acc: 0.7079
 Site-QuickDraw                     | Val  Loss: 2.2177 | Val  Acc: 0.2936
 Site-Infograph                     | Val  Loss: 2.0864 | Val  Acc: 0.4103
Average Valid Accuracy: 0.7500
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.7632
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.7383
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8200
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8048
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.7322
 Best site-Real                      | Epoch:5 | Val Acc: 0.8333
 Best site-Real                      | Epoch:5 | Val Acc: 0.9322
 Best site-Real                      | Epoch:5 | Val Acc: 0.9333
 Best site-Real                      | Epoch:5 | Val Acc: 0.9481
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8265
 Best site-Painting                  | Epoch:5 | Val Acc: 0.7737
 Best site-Painting                  | Epoch:5 | Val Acc: 0.7812
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.7008
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.7079
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.2936
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 6 ============
denominator: 35136.04296875
 Site-Clipart                       | Train Loss: 1.7350 | Train Acc: 0.7565
 Site-Clipart                       | Train Loss: 1.7208 | Train Acc: 0.7640
 Site-Clipart                       | Train Loss: 1.7673 | Train Acc: 0.7689
 Site-Clipart                       | Train Loss: 1.7242 | Train Acc: 0.8196
 Site-Clipart                       | Train Loss: 1.7461 | Train Acc: 0.7896
 Site-Real                          | Train Loss: 1.6344 | Train Acc: 0.9127
 Site-Real                          | Train Loss: 1.5658 | Train Acc: 0.9209
 Site-Real                          | Train Loss: 1.5642 | Train Acc: 0.9395
 Site-Real                          | Train Loss: 1.6376 | Train Acc: 0.9023
 Site-Painting                      | Train Loss: 1.6910 | Train Acc: 0.8163
 Site-Painting                      | Train Loss: 1.6615 | Train Acc: 0.8155
 Site-Painting                      | Train Loss: 1.6854 | Train Acc: 0.7889
 Site-Sketch                        | Train Loss: 1.7362 | Train Acc: 0.7068
 Site-Sketch                        | Train Loss: 1.7463 | Train Acc: 0.7341
 Site-QuickDraw                     | Train Loss: 2.1726 | Train Acc: 0.3425
 Site-Infograph                     | Train Loss: 2.0827 | Train Acc: 0.3974
Average Train Accuracy: 0.7610
 Site-Clipart                       | Val  Loss: 1.6477 | Val  Acc: 0.7895
 Site-Clipart                       | Val  Loss: 1.7203 | Val  Acc: 0.7850
 Site-Clipart                       | Val  Loss: 1.7446 | Val  Acc: 0.8467
 Site-Clipart                       | Val  Loss: 1.7130 | Val  Acc: 0.8143
 Site-Clipart                       | Val  Loss: 1.7607 | Val  Acc: 0.7763
 Site-Real                          | Val  Loss: 1.6119 | Val  Acc: 0.8929
 Site-Real                          | Val  Loss: 1.6019 | Val  Acc: 0.9322
 Site-Real                          | Val  Loss: 1.5540 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 1.5681 | Val  Acc: 0.9307
 Site-Painting                      | Val  Loss: 1.6376 | Val  Acc: 0.8265
 Site-Painting                      | Val  Loss: 1.6736 | Val  Acc: 0.7810
 Site-Painting                      | Val  Loss: 1.6796 | Val  Acc: 0.8021
 Site-Sketch                        | Val  Loss: 1.7449 | Val  Acc: 0.7087
 Site-Sketch                        | Val  Loss: 1.7419 | Val  Acc: 0.7191
 Site-QuickDraw                     | Val  Loss: 2.1870 | Val  Acc: 0.3394
 Site-Infograph                     | Val  Loss: 2.0398 | Val  Acc: 0.4295
Average Valid Accuracy: 0.7692
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.7895
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.7850
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8467
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8143
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.7763
 Best site-Real                      | Epoch:6 | Val Acc: 0.8929
 Best site-Real                      | Epoch:6 | Val Acc: 0.9322
 Best site-Real                      | Epoch:6 | Val Acc: 0.9333
 Best site-Real                      | Epoch:6 | Val Acc: 0.9307
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8265
 Best site-Painting                  | Epoch:6 | Val Acc: 0.7810
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8021
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.7087
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.7191
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.3394
 Best site-Infograph                 | Epoch:6 | Val Acc: 0.4295
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 7 ============
denominator: 34016.7890625
 Site-Clipart                       | Train Loss: 1.6714 | Train Acc: 0.7913
 Site-Clipart                       | Train Loss: 1.6307 | Train Acc: 0.8323
 Site-Clipart                       | Train Loss: 1.6965 | Train Acc: 0.7867
 Site-Clipart                       | Train Loss: 1.6658 | Train Acc: 0.8259
 Site-Clipart                       | Train Loss: 1.6851 | Train Acc: 0.7828
 Site-Real                          | Train Loss: 1.5255 | Train Acc: 0.9206
 Site-Real                          | Train Loss: 1.4686 | Train Acc: 0.9322
 Site-Real                          | Train Loss: 1.4504 | Train Acc: 0.9435
 Site-Real                          | Train Loss: 1.5368 | Train Acc: 0.8966
 Site-Painting                      | Train Loss: 1.5875 | Train Acc: 0.8639
 Site-Painting                      | Train Loss: 1.6269 | Train Acc: 0.8155
 Site-Painting                      | Train Loss: 1.6127 | Train Acc: 0.8097
 Site-Sketch                        | Train Loss: 1.6683 | Train Acc: 0.7173
 Site-Sketch                        | Train Loss: 1.6686 | Train Acc: 0.7341
 Site-QuickDraw                     | Train Loss: 2.1312 | Train Acc: 0.3394
 Site-Infograph                     | Train Loss: 2.0644 | Train Acc: 0.4017
Average Train Accuracy: 0.7746
 Site-Clipart                       | Val  Loss: 1.5648 | Val  Acc: 0.7895
 Site-Clipart                       | Val  Loss: 1.6709 | Val  Acc: 0.7664
 Site-Clipart                       | Val  Loss: 1.6658 | Val  Acc: 0.8467
 Site-Clipart                       | Val  Loss: 1.6146 | Val  Acc: 0.8286
 Site-Clipart                       | Val  Loss: 1.6738 | Val  Acc: 0.7932
 Site-Real                          | Val  Loss: 1.5113 | Val  Acc: 0.9048
 Site-Real                          | Val  Loss: 1.5176 | Val  Acc: 0.9407
 Site-Real                          | Val  Loss: 1.4483 | Val  Acc: 0.9455
 Site-Real                          | Val  Loss: 1.4616 | Val  Acc: 0.9481
 Site-Painting                      | Val  Loss: 1.5566 | Val  Acc: 0.8571
 Site-Painting                      | Val  Loss: 1.6047 | Val  Acc: 0.7737
 Site-Painting                      | Val  Loss: 1.5876 | Val  Acc: 0.8333
 Site-Sketch                        | Val  Loss: 1.6110 | Val  Acc: 0.7795
 Site-Sketch                        | Val  Loss: 1.6587 | Val  Acc: 0.7247
 Site-QuickDraw                     | Val  Loss: 2.1674 | Val  Acc: 0.3394
 Site-Infograph                     | Val  Loss: 2.0148 | Val  Acc: 0.4295
Average Valid Accuracy: 0.7813
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.7895
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.7664
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8467
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8286
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.7932
 Best site-Real                      | Epoch:7 | Val Acc: 0.9048
 Best site-Real                      | Epoch:7 | Val Acc: 0.9407
 Best site-Real                      | Epoch:7 | Val Acc: 0.9455
 Best site-Real                      | Epoch:7 | Val Acc: 0.9481
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8571
 Best site-Painting                  | Epoch:7 | Val Acc: 0.7737
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8333
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.7795
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.7247
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.3394
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.4295
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 8 ============
denominator: 32812.1875
 Site-Clipart                       | Train Loss: 1.6332 | Train Acc: 0.7478
 Site-Clipart                       | Train Loss: 1.5805 | Train Acc: 0.8509
 Site-Clipart                       | Train Loss: 1.6237 | Train Acc: 0.7911
 Site-Clipart                       | Train Loss: 1.5773 | Train Acc: 0.8323
 Site-Clipart                       | Train Loss: 1.5894 | Train Acc: 0.8054
 Site-Real                          | Train Loss: 1.4390 | Train Acc: 0.9286
 Site-Real                          | Train Loss: 1.3730 | Train Acc: 0.9322
 Site-Real                          | Train Loss: 1.3664 | Train Acc: 0.9476
 Site-Real                          | Train Loss: 1.4396 | Train Acc: 0.9080
 Site-Painting                      | Train Loss: 1.5222 | Train Acc: 0.8027
 Site-Painting                      | Train Loss: 1.5120 | Train Acc: 0.8107
 Site-Painting                      | Train Loss: 1.5047 | Train Acc: 0.8166
 Site-Sketch                        | Train Loss: 1.6256 | Train Acc: 0.6911
 Site-Sketch                        | Train Loss: 1.5832 | Train Acc: 0.7566
 Site-QuickDraw                     | Train Loss: 2.1220 | Train Acc: 0.3394
 Site-Infograph                     | Train Loss: 2.0179 | Train Acc: 0.4017
Average Train Accuracy: 0.7727
 Site-Clipart                       | Val  Loss: 1.4376 | Val  Acc: 0.8026
 Site-Clipart                       | Val  Loss: 1.5613 | Val  Acc: 0.7944
 Site-Clipart                       | Val  Loss: 1.5998 | Val  Acc: 0.8667
 Site-Clipart                       | Val  Loss: 1.5405 | Val  Acc: 0.7952
 Site-Clipart                       | Val  Loss: 1.6178 | Val  Acc: 0.7763
 Site-Real                          | Val  Loss: 1.4253 | Val  Acc: 0.9167
 Site-Real                          | Val  Loss: 1.4184 | Val  Acc: 0.9407
 Site-Real                          | Val  Loss: 1.3512 | Val  Acc: 0.9455
 Site-Real                          | Val  Loss: 1.3567 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 1.4499 | Val  Acc: 0.8469
 Site-Painting                      | Val  Loss: 1.5081 | Val  Acc: 0.8248
 Site-Painting                      | Val  Loss: 1.5286 | Val  Acc: 0.8229
 Site-Sketch                        | Val  Loss: 1.5706 | Val  Acc: 0.7795
 Site-Sketch                        | Val  Loss: 1.5966 | Val  Acc: 0.7191
 Site-QuickDraw                     | Val  Loss: 2.1398 | Val  Acc: 0.3257
 Site-Infograph                     | Val  Loss: 1.9742 | Val  Acc: 0.4295
Average Valid Accuracy: 0.7837
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8026
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.7944
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8667
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.7952
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.7763
 Best site-Real                      | Epoch:8 | Val Acc: 0.9167
 Best site-Real                      | Epoch:8 | Val Acc: 0.9407
 Best site-Real                      | Epoch:8 | Val Acc: 0.9455
 Best site-Real                      | Epoch:8 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8469
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8248
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8229
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.7795
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.7191
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.3257
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.4295
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 9 ============
denominator: 31620.74609375
 Site-Clipart                       | Train Loss: 1.5384 | Train Acc: 0.7826
 Site-Clipart                       | Train Loss: 1.4852 | Train Acc: 0.8820
 Site-Clipart                       | Train Loss: 1.5609 | Train Acc: 0.8044
 Site-Clipart                       | Train Loss: 1.5083 | Train Acc: 0.8418
 Site-Clipart                       | Train Loss: 1.5461 | Train Acc: 0.8190
 Site-Real                          | Train Loss: 1.3530 | Train Acc: 0.9048
 Site-Real                          | Train Loss: 1.2642 | Train Acc: 0.9548
 Site-Real                          | Train Loss: 1.2682 | Train Acc: 0.9476
 Site-Real                          | Train Loss: 1.3652 | Train Acc: 0.9310
 Site-Painting                      | Train Loss: 1.4426 | Train Acc: 0.8231
 Site-Painting                      | Train Loss: 1.4521 | Train Acc: 0.8252
 Site-Painting                      | Train Loss: 1.4426 | Train Acc: 0.7993
 Site-Sketch                        | Train Loss: 1.5200 | Train Acc: 0.7120
 Site-Sketch                        | Train Loss: 1.5410 | Train Acc: 0.7753
 Site-QuickDraw                     | Train Loss: 2.0938 | Train Acc: 0.3547
 Site-Infograph                     | Train Loss: 1.9901 | Train Acc: 0.4231
Average Train Accuracy: 0.7863
 Site-Clipart                       | Val  Loss: 1.3500 | Val  Acc: 0.8421
 Site-Clipart                       | Val  Loss: 1.4711 | Val  Acc: 0.8598
 Site-Clipart                       | Val  Loss: 1.5380 | Val  Acc: 0.8267
 Site-Clipart                       | Val  Loss: 1.4816 | Val  Acc: 0.8333
 Site-Clipart                       | Val  Loss: 1.5344 | Val  Acc: 0.8169
 Site-Real                          | Val  Loss: 1.3600 | Val  Acc: 0.9167
 Site-Real                          | Val  Loss: 1.3231 | Val  Acc: 0.9407
 Site-Real                          | Val  Loss: 1.2772 | Val  Acc: 0.9394
 Site-Real                          | Val  Loss: 1.2578 | Val  Acc: 0.9610
 Site-Painting                      | Val  Loss: 1.3962 | Val  Acc: 0.8878
 Site-Painting                      | Val  Loss: 1.4221 | Val  Acc: 0.8175
 Site-Painting                      | Val  Loss: 1.4281 | Val  Acc: 0.8385
 Site-Sketch                        | Val  Loss: 1.4640 | Val  Acc: 0.8583
 Site-Sketch                        | Val  Loss: 1.5308 | Val  Acc: 0.7303
 Site-QuickDraw                     | Val  Loss: 2.1201 | Val  Acc: 0.3486
 Site-Infograph                     | Val  Loss: 1.9531 | Val  Acc: 0.4615
Average Valid Accuracy: 0.8050
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8421
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8598
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8267
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8169
 Best site-Real                      | Epoch:9 | Val Acc: 0.9167
 Best site-Real                      | Epoch:9 | Val Acc: 0.9407
 Best site-Real                      | Epoch:9 | Val Acc: 0.9394
 Best site-Real                      | Epoch:9 | Val Acc: 0.9610
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8878
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8175
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8385
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8583
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.7303
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.3486
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.4615
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 10 ============
denominator: 30530.79296875
 Site-Clipart                       | Train Loss: 1.4637 | Train Acc: 0.7739
 Site-Clipart                       | Train Loss: 1.4507 | Train Acc: 0.8634
 Site-Clipart                       | Train Loss: 1.4867 | Train Acc: 0.8089
 Site-Clipart                       | Train Loss: 1.4469 | Train Acc: 0.8386
 Site-Clipart                       | Train Loss: 1.4820 | Train Acc: 0.7986
 Site-Real                          | Train Loss: 1.2744 | Train Acc: 0.8889
 Site-Real                          | Train Loss: 1.1815 | Train Acc: 0.9661
 Site-Real                          | Train Loss: 1.1712 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 1.2950 | Train Acc: 0.9195
 Site-Painting                      | Train Loss: 1.3634 | Train Acc: 0.8027
 Site-Painting                      | Train Loss: 1.3253 | Train Acc: 0.8592
 Site-Painting                      | Train Loss: 1.3897 | Train Acc: 0.8270
 Site-Sketch                        | Train Loss: 1.4585 | Train Acc: 0.7277
 Site-Sketch                        | Train Loss: 1.4794 | Train Acc: 0.7378
 Site-QuickDraw                     | Train Loss: 2.0573 | Train Acc: 0.3914
 Site-Infograph                     | Train Loss: 1.9525 | Train Acc: 0.4316
Average Train Accuracy: 0.7880
 Site-Clipart                       | Val  Loss: 1.3076 | Val  Acc: 0.8421
 Site-Clipart                       | Val  Loss: 1.4145 | Val  Acc: 0.8411
 Site-Clipart                       | Val  Loss: 1.4524 | Val  Acc: 0.8400
 Site-Clipart                       | Val  Loss: 1.4183 | Val  Acc: 0.8190
 Site-Clipart                       | Val  Loss: 1.4778 | Val  Acc: 0.8034
 Site-Real                          | Val  Loss: 1.2377 | Val  Acc: 0.9048
 Site-Real                          | Val  Loss: 1.2508 | Val  Acc: 0.9407
 Site-Real                          | Val  Loss: 1.1684 | Val  Acc: 0.9394
 Site-Real                          | Val  Loss: 1.1754 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 1.3332 | Val  Acc: 0.8673
 Site-Painting                      | Val  Loss: 1.3494 | Val  Acc: 0.7956
 Site-Painting                      | Val  Loss: 1.3321 | Val  Acc: 0.8490
 Site-Sketch                        | Val  Loss: 1.4336 | Val  Acc: 0.7559
 Site-Sketch                        | Val  Loss: 1.4884 | Val  Acc: 0.7135
 Site-QuickDraw                     | Val  Loss: 2.1215 | Val  Acc: 0.3578
 Site-Infograph                     | Val  Loss: 1.8820 | Val  Acc: 0.4679
Average Valid Accuracy: 0.7942
============ Train epoch 11 ============
denominator: 29390.283203125
 Site-Clipart                       | Train Loss: 1.3940 | Train Acc: 0.8087
 Site-Clipart                       | Train Loss: 1.3106 | Train Acc: 0.8758
 Site-Clipart                       | Train Loss: 1.4544 | Train Acc: 0.8044
 Site-Clipart                       | Train Loss: 1.3788 | Train Acc: 0.8354
 Site-Clipart                       | Train Loss: 1.4086 | Train Acc: 0.8145
 Site-Real                          | Train Loss: 1.1845 | Train Acc: 0.9206
 Site-Real                          | Train Loss: 1.1034 | Train Acc: 0.9605
 Site-Real                          | Train Loss: 1.0983 | Train Acc: 0.9597
 Site-Real                          | Train Loss: 1.1880 | Train Acc: 0.9368
 Site-Painting                      | Train Loss: 1.3408 | Train Acc: 0.8435
 Site-Painting                      | Train Loss: 1.2314 | Train Acc: 0.8447
 Site-Painting                      | Train Loss: 1.3017 | Train Acc: 0.8339
 Site-Sketch                        | Train Loss: 1.3917 | Train Acc: 0.7173
 Site-Sketch                        | Train Loss: 1.4069 | Train Acc: 0.7566
 Site-QuickDraw                     | Train Loss: 2.0463 | Train Acc: 0.3639
 Site-Infograph                     | Train Loss: 1.9063 | Train Acc: 0.4231
Average Train Accuracy: 0.7937
 Site-Clipart                       | Val  Loss: 1.2294 | Val  Acc: 0.8553
 Site-Clipart                       | Val  Loss: 1.3784 | Val  Acc: 0.8037
 Site-Clipart                       | Val  Loss: 1.4215 | Val  Acc: 0.8600
 Site-Clipart                       | Val  Loss: 1.2995 | Val  Acc: 0.8619
 Site-Clipart                       | Val  Loss: 1.4171 | Val  Acc: 0.8136
 Site-Real                          | Val  Loss: 1.1817 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 1.1551 | Val  Acc: 0.9576
 Site-Real                          | Val  Loss: 1.0987 | Val  Acc: 0.9455
 Site-Real                          | Val  Loss: 1.0995 | Val  Acc: 0.9654
 Site-Painting                      | Val  Loss: 1.2539 | Val  Acc: 0.8878
 Site-Painting                      | Val  Loss: 1.2620 | Val  Acc: 0.8394
 Site-Painting                      | Val  Loss: 1.2939 | Val  Acc: 0.8490
 Site-Sketch                        | Val  Loss: 1.3571 | Val  Acc: 0.7874
 Site-Sketch                        | Val  Loss: 1.4301 | Val  Acc: 0.7360
 Site-QuickDraw                     | Val  Loss: 2.0860 | Val  Acc: 0.3624
 Site-Infograph                     | Val  Loss: 1.8500 | Val  Acc: 0.4872
Average Valid Accuracy: 0.8095
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8553
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8037
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8600
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8619
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8136
 Best site-Real                      | Epoch:11 | Val Acc: 0.9405
 Best site-Real                      | Epoch:11 | Val Acc: 0.9576
 Best site-Real                      | Epoch:11 | Val Acc: 0.9455
 Best site-Real                      | Epoch:11 | Val Acc: 0.9654
 Best site-Painting                  | Epoch:11 | Val Acc: 0.8878
 Best site-Painting                  | Epoch:11 | Val Acc: 0.8394
 Best site-Painting                  | Epoch:11 | Val Acc: 0.8490
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.7874
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.7360
 Best site-QuickDraw                 | Epoch:11 | Val Acc: 0.3624
 Best site-Infograph                 | Epoch:11 | Val Acc: 0.4872
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 12 ============
denominator: 28450.23828125
 Site-Clipart                       | Train Loss: 1.3134 | Train Acc: 0.8174
 Site-Clipart                       | Train Loss: 1.2595 | Train Acc: 0.8447
 Site-Clipart                       | Train Loss: 1.3435 | Train Acc: 0.8356
 Site-Clipart                       | Train Loss: 1.3108 | Train Acc: 0.8291
 Site-Clipart                       | Train Loss: 1.3401 | Train Acc: 0.8416
 Site-Real                          | Train Loss: 1.1373 | Train Acc: 0.9127
 Site-Real                          | Train Loss: 1.0056 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 1.0170 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 1.1361 | Train Acc: 0.9195
 Site-Painting                      | Train Loss: 1.2352 | Train Acc: 0.8435
 Site-Painting                      | Train Loss: 1.2639 | Train Acc: 0.8544
 Site-Painting                      | Train Loss: 1.2154 | Train Acc: 0.8304
 Site-Sketch                        | Train Loss: 1.3333 | Train Acc: 0.7382
 Site-Sketch                        | Train Loss: 1.3420 | Train Acc: 0.7790
 Site-QuickDraw                     | Train Loss: 2.0391 | Train Acc: 0.3914
 Site-Infograph                     | Train Loss: 1.8850 | Train Acc: 0.4145
Average Train Accuracy: 0.7997
 Site-Clipart                       | Val  Loss: 1.1918 | Val  Acc: 0.8289
 Site-Clipart                       | Val  Loss: 1.3063 | Val  Acc: 0.8505
 Site-Clipart                       | Val  Loss: 1.3426 | Val  Acc: 0.8600
 Site-Clipart                       | Val  Loss: 1.2926 | Val  Acc: 0.8571
 Site-Clipart                       | Val  Loss: 1.3623 | Val  Acc: 0.8169
 Site-Real                          | Val  Loss: 1.1230 | Val  Acc: 0.8929
 Site-Real                          | Val  Loss: 1.0767 | Val  Acc: 0.9576
 Site-Real                          | Val  Loss: 1.0106 | Val  Acc: 0.9636
 Site-Real                          | Val  Loss: 1.0343 | Val  Acc: 0.9654
 Site-Painting                      | Val  Loss: 1.1595 | Val  Acc: 0.8980
 Site-Painting                      | Val  Loss: 1.2599 | Val  Acc: 0.8248
 Site-Painting                      | Val  Loss: 1.2207 | Val  Acc: 0.8698
 Site-Sketch                        | Val  Loss: 1.3340 | Val  Acc: 0.7717
 Site-Sketch                        | Val  Loss: 1.3164 | Val  Acc: 0.7528
 Site-QuickDraw                     | Val  Loss: 2.0672 | Val  Acc: 0.3578
 Site-Infograph                     | Val  Loss: 1.8272 | Val  Acc: 0.4936
Average Valid Accuracy: 0.8101
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8289
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8505
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8600
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8169
 Best site-Real                      | Epoch:12 | Val Acc: 0.8929
 Best site-Real                      | Epoch:12 | Val Acc: 0.9576
 Best site-Real                      | Epoch:12 | Val Acc: 0.9636
 Best site-Real                      | Epoch:12 | Val Acc: 0.9654
 Best site-Painting                  | Epoch:12 | Val Acc: 0.8980
 Best site-Painting                  | Epoch:12 | Val Acc: 0.8248
 Best site-Painting                  | Epoch:12 | Val Acc: 0.8698
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.7717
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.7528
 Best site-QuickDraw                 | Epoch:12 | Val Acc: 0.3578
 Best site-Infograph                 | Epoch:12 | Val Acc: 0.4936
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 13 ============
denominator: 27371.71875
 Site-Clipart                       | Train Loss: 1.2566 | Train Acc: 0.8522
 Site-Clipart                       | Train Loss: 1.1894 | Train Acc: 0.8944
 Site-Clipart                       | Train Loss: 1.2840 | Train Acc: 0.8400
 Site-Clipart                       | Train Loss: 1.2293 | Train Acc: 0.8576
 Site-Clipart                       | Train Loss: 1.2900 | Train Acc: 0.8235
 Site-Real                          | Train Loss: 1.0465 | Train Acc: 0.9206
 Site-Real                          | Train Loss: 0.9478 | Train Acc: 0.9605
 Site-Real                          | Train Loss: 0.9398 | Train Acc: 0.9758
 Site-Real                          | Train Loss: 1.0384 | Train Acc: 0.9425
 Site-Painting                      | Train Loss: 1.1717 | Train Acc: 0.8707
 Site-Painting                      | Train Loss: 1.2667 | Train Acc: 0.8592
 Site-Painting                      | Train Loss: 1.1700 | Train Acc: 0.8478
 Site-Sketch                        | Train Loss: 1.3035 | Train Acc: 0.7330
 Site-Sketch                        | Train Loss: 1.2837 | Train Acc: 0.7715
 Site-QuickDraw                     | Train Loss: 2.0266 | Train Acc: 0.3884
 Site-Infograph                     | Train Loss: 1.8624 | Train Acc: 0.4658
Average Train Accuracy: 0.8127
 Site-Clipart                       | Val  Loss: 1.1267 | Val  Acc: 0.8289
 Site-Clipart                       | Val  Loss: 1.2613 | Val  Acc: 0.8411
 Site-Clipart                       | Val  Loss: 1.2924 | Val  Acc: 0.8800
 Site-Clipart                       | Val  Loss: 1.2147 | Val  Acc: 0.8571
 Site-Clipart                       | Val  Loss: 1.2945 | Val  Acc: 0.8136
 Site-Real                          | Val  Loss: 1.0410 | Val  Acc: 0.9286
 Site-Real                          | Val  Loss: 1.0120 | Val  Acc: 0.9746
 Site-Real                          | Val  Loss: 0.9260 | Val  Acc: 0.9758
 Site-Real                          | Val  Loss: 0.9433 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 1.0895 | Val  Acc: 0.8673
 Site-Painting                      | Val  Loss: 1.1984 | Val  Acc: 0.7810
 Site-Painting                      | Val  Loss: 1.1360 | Val  Acc: 0.8542
 Site-Sketch                        | Val  Loss: 1.1835 | Val  Acc: 0.8346
 Site-Sketch                        | Val  Loss: 1.2500 | Val  Acc: 0.7809
 Site-QuickDraw                     | Val  Loss: 2.0458 | Val  Acc: 0.3761
 Site-Infograph                     | Val  Loss: 1.7780 | Val  Acc: 0.5064
Average Valid Accuracy: 0.8169
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8289
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8411
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8800
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8136
 Best site-Real                      | Epoch:13 | Val Acc: 0.9286
 Best site-Real                      | Epoch:13 | Val Acc: 0.9746
 Best site-Real                      | Epoch:13 | Val Acc: 0.9758
 Best site-Real                      | Epoch:13 | Val Acc: 0.9697
 Best site-Painting                  | Epoch:13 | Val Acc: 0.8673
 Best site-Painting                  | Epoch:13 | Val Acc: 0.7810
 Best site-Painting                  | Epoch:13 | Val Acc: 0.8542
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.8346
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.7809
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.3761
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.5064
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 14 ============
denominator: 26591.46875
 Site-Clipart                       | Train Loss: 1.2056 | Train Acc: 0.8609
 Site-Clipart                       | Train Loss: 1.1095 | Train Acc: 0.9193
 Site-Clipart                       | Train Loss: 1.2494 | Train Acc: 0.8489
 Site-Clipart                       | Train Loss: 1.2074 | Train Acc: 0.8259
 Site-Clipart                       | Train Loss: 1.2326 | Train Acc: 0.8281
 Site-Real                          | Train Loss: 0.9885 | Train Acc: 0.9206
 Site-Real                          | Train Loss: 0.8896 | Train Acc: 0.9605
 Site-Real                          | Train Loss: 0.8861 | Train Acc: 0.9597
 Site-Real                          | Train Loss: 0.9907 | Train Acc: 0.9339
 Site-Painting                      | Train Loss: 1.0377 | Train Acc: 0.8639
 Site-Painting                      | Train Loss: 1.1317 | Train Acc: 0.8592
 Site-Painting                      | Train Loss: 1.1075 | Train Acc: 0.8824
 Site-Sketch                        | Train Loss: 1.2446 | Train Acc: 0.7382
 Site-Sketch                        | Train Loss: 1.1954 | Train Acc: 0.7753
 Site-QuickDraw                     | Train Loss: 1.9833 | Train Acc: 0.3823
 Site-Infograph                     | Train Loss: 1.8218 | Train Acc: 0.4615
Average Train Accuracy: 0.8138
 Site-Clipart                       | Val  Loss: 1.0755 | Val  Acc: 0.8684
 Site-Clipart                       | Val  Loss: 1.2316 | Val  Acc: 0.8598
 Site-Clipart                       | Val  Loss: 1.2087 | Val  Acc: 0.8533
 Site-Clipart                       | Val  Loss: 1.1343 | Val  Acc: 0.8571
 Site-Clipart                       | Val  Loss: 1.2232 | Val  Acc: 0.8305
 Site-Real                          | Val  Loss: 0.9791 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.9338 | Val  Acc: 0.9576
 Site-Real                          | Val  Loss: 0.8600 | Val  Acc: 0.9697
 Site-Real                          | Val  Loss: 0.8884 | Val  Acc: 0.9654
 Site-Painting                      | Val  Loss: 1.0426 | Val  Acc: 0.8980
 Site-Painting                      | Val  Loss: 1.1003 | Val  Acc: 0.8467
 Site-Painting                      | Val  Loss: 1.0928 | Val  Acc: 0.8542
 Site-Sketch                        | Val  Loss: 1.1741 | Val  Acc: 0.8031
 Site-Sketch                        | Val  Loss: 1.2430 | Val  Acc: 0.7640
 Site-QuickDraw                     | Val  Loss: 2.0297 | Val  Acc: 0.3807
 Site-Infograph                     | Val  Loss: 1.7653 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8226
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8684
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8598
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8533
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8305
 Best site-Real                      | Epoch:14 | Val Acc: 0.9524
 Best site-Real                      | Epoch:14 | Val Acc: 0.9576
 Best site-Real                      | Epoch:14 | Val Acc: 0.9697
 Best site-Real                      | Epoch:14 | Val Acc: 0.9654
 Best site-Painting                  | Epoch:14 | Val Acc: 0.8980
 Best site-Painting                  | Epoch:14 | Val Acc: 0.8467
 Best site-Painting                  | Epoch:14 | Val Acc: 0.8542
 Best site-Sketch                    | Epoch:14 | Val Acc: 0.8031
 Best site-Sketch                    | Epoch:14 | Val Acc: 0.7640
 Best site-QuickDraw                 | Epoch:14 | Val Acc: 0.3807
 Best site-Infograph                 | Epoch:14 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 15 ============
denominator: 25561.2109375
 Site-Clipart                       | Train Loss: 1.1763 | Train Acc: 0.8348
 Site-Clipart                       | Train Loss: 1.0954 | Train Acc: 0.8882
 Site-Clipart                       | Train Loss: 1.2037 | Train Acc: 0.8400
 Site-Clipart                       | Train Loss: 1.1222 | Train Acc: 0.8639
 Site-Clipart                       | Train Loss: 1.1779 | Train Acc: 0.8484
 Site-Real                          | Train Loss: 0.9316 | Train Acc: 0.9206
 Site-Real                          | Train Loss: 0.8296 | Train Acc: 0.9661
 Site-Real                          | Train Loss: 0.8062 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.9331 | Train Acc: 0.9397
 Site-Painting                      | Train Loss: 0.9962 | Train Acc: 0.8844
 Site-Painting                      | Train Loss: 0.9786 | Train Acc: 0.8447
 Site-Painting                      | Train Loss: 1.0802 | Train Acc: 0.8304
 Site-Sketch                        | Train Loss: 1.2034 | Train Acc: 0.7330
 Site-Sketch                        | Train Loss: 1.2298 | Train Acc: 0.8127
 Site-QuickDraw                     | Train Loss: 1.9655 | Train Acc: 0.3731
 Site-Infograph                     | Train Loss: 1.8148 | Train Acc: 0.4359
Average Train Accuracy: 0.8117
 Site-Clipart                       | Val  Loss: 0.9882 | Val  Acc: 0.8684
 Site-Clipart                       | Val  Loss: 1.1751 | Val  Acc: 0.8411
 Site-Clipart                       | Val  Loss: 1.1529 | Val  Acc: 0.8600
 Site-Clipart                       | Val  Loss: 1.1041 | Val  Acc: 0.8571
 Site-Clipart                       | Val  Loss: 1.2052 | Val  Acc: 0.8203
 Site-Real                          | Val  Loss: 0.9108 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.8726 | Val  Acc: 0.9661
 Site-Real                          | Val  Loss: 0.8015 | Val  Acc: 0.9758
 Site-Real                          | Val  Loss: 0.8083 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 0.9631 | Val  Acc: 0.8776
 Site-Painting                      | Val  Loss: 1.0166 | Val  Acc: 0.8540
 Site-Painting                      | Val  Loss: 1.0163 | Val  Acc: 0.8646
 Site-Sketch                        | Val  Loss: 1.1559 | Val  Acc: 0.8110
 Site-Sketch                        | Val  Loss: 1.1870 | Val  Acc: 0.7247
 Site-QuickDraw                     | Val  Loss: 1.9893 | Val  Acc: 0.3945
 Site-Infograph                     | Val  Loss: 1.7280 | Val  Acc: 0.4808
Average Valid Accuracy: 0.8199
============ Train epoch 16 ============
denominator: 24737.2734375
 Site-Clipart                       | Train Loss: 1.0866 | Train Acc: 0.8522
 Site-Clipart                       | Train Loss: 1.0366 | Train Acc: 0.8882
 Site-Clipart                       | Train Loss: 1.1804 | Train Acc: 0.8356
 Site-Clipart                       | Train Loss: 1.1070 | Train Acc: 0.8544
 Site-Clipart                       | Train Loss: 1.1552 | Train Acc: 0.8258
 Site-Real                          | Train Loss: 0.8576 | Train Acc: 0.9286
 Site-Real                          | Train Loss: 0.7447 | Train Acc: 0.9605
 Site-Real                          | Train Loss: 0.7603 | Train Acc: 0.9677
 Site-Real                          | Train Loss: 0.8650 | Train Acc: 0.9454
 Site-Painting                      | Train Loss: 0.9804 | Train Acc: 0.8571
 Site-Painting                      | Train Loss: 0.9803 | Train Acc: 0.8495
 Site-Painting                      | Train Loss: 1.0234 | Train Acc: 0.8408
 Site-Sketch                        | Train Loss: 1.1267 | Train Acc: 0.7644
 Site-Sketch                        | Train Loss: 1.1035 | Train Acc: 0.7978
 Site-QuickDraw                     | Train Loss: 1.9754 | Train Acc: 0.3976
 Site-Infograph                     | Train Loss: 1.7829 | Train Acc: 0.4744
Average Train Accuracy: 0.8150
 Site-Clipart                       | Val  Loss: 0.9050 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 1.1056 | Val  Acc: 0.8598
 Site-Clipart                       | Val  Loss: 1.0972 | Val  Acc: 0.8733
 Site-Clipart                       | Val  Loss: 1.0316 | Val  Acc: 0.8476
 Site-Clipart                       | Val  Loss: 1.1445 | Val  Acc: 0.8373
 Site-Real                          | Val  Loss: 0.8440 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.8247 | Val  Acc: 0.9576
 Site-Real                          | Val  Loss: 0.7434 | Val  Acc: 0.9636
 Site-Real                          | Val  Loss: 0.7486 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 0.9137 | Val  Acc: 0.8673
 Site-Painting                      | Val  Loss: 0.9879 | Val  Acc: 0.8686
 Site-Painting                      | Val  Loss: 1.0173 | Val  Acc: 0.8385
 Site-Sketch                        | Val  Loss: 1.1082 | Val  Acc: 0.8110
 Site-Sketch                        | Val  Loss: 1.1246 | Val  Acc: 0.7753
 Site-QuickDraw                     | Val  Loss: 2.0104 | Val  Acc: 0.3670
 Site-Infograph                     | Val  Loss: 1.7204 | Val  Acc: 0.5064
Average Valid Accuracy: 0.8237
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.8947
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.8598
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.8733
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.8476
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.8373
 Best site-Real                      | Epoch:16 | Val Acc: 0.9405
 Best site-Real                      | Epoch:16 | Val Acc: 0.9576
 Best site-Real                      | Epoch:16 | Val Acc: 0.9636
 Best site-Real                      | Epoch:16 | Val Acc: 0.9697
 Best site-Painting                  | Epoch:16 | Val Acc: 0.8673
 Best site-Painting                  | Epoch:16 | Val Acc: 0.8686
 Best site-Painting                  | Epoch:16 | Val Acc: 0.8385
 Best site-Sketch                    | Epoch:16 | Val Acc: 0.8110
 Best site-Sketch                    | Epoch:16 | Val Acc: 0.7753
 Best site-QuickDraw                 | Epoch:16 | Val Acc: 0.3670
 Best site-Infograph                 | Epoch:16 | Val Acc: 0.5064
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 17 ============
denominator: 24053.87890625
 Site-Clipart                       | Train Loss: 1.0394 | Train Acc: 0.8261
 Site-Clipart                       | Train Loss: 0.9992 | Train Acc: 0.8820
 Site-Clipart                       | Train Loss: 1.0831 | Train Acc: 0.8533
 Site-Clipart                       | Train Loss: 1.0397 | Train Acc: 0.8797
 Site-Clipart                       | Train Loss: 1.0767 | Train Acc: 0.8303
 Site-Real                          | Train Loss: 0.8177 | Train Acc: 0.9127
 Site-Real                          | Train Loss: 0.7001 | Train Acc: 0.9661
 Site-Real                          | Train Loss: 0.7039 | Train Acc: 0.9637
 Site-Real                          | Train Loss: 0.8221 | Train Acc: 0.9339
 Site-Painting                      | Train Loss: 0.9939 | Train Acc: 0.8367
 Site-Painting                      | Train Loss: 0.9119 | Train Acc: 0.8786
 Site-Painting                      | Train Loss: 0.9845 | Train Acc: 0.8478
 Site-Sketch                        | Train Loss: 1.0773 | Train Acc: 0.7644
 Site-Sketch                        | Train Loss: 1.0706 | Train Acc: 0.8015
 Site-QuickDraw                     | Train Loss: 1.9120 | Train Acc: 0.3670
 Site-Infograph                     | Train Loss: 1.7577 | Train Acc: 0.4744
Average Train Accuracy: 0.8136
 Site-Clipart                       | Val  Loss: 0.8907 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 1.0547 | Val  Acc: 0.8692
 Site-Clipart                       | Val  Loss: 1.0584 | Val  Acc: 0.8667
 Site-Clipart                       | Val  Loss: 1.0129 | Val  Acc: 0.8381
 Site-Clipart                       | Val  Loss: 1.0962 | Val  Acc: 0.8339
 Site-Real                          | Val  Loss: 0.8154 | Val  Acc: 0.9167
 Site-Real                          | Val  Loss: 0.7902 | Val  Acc: 0.9576
 Site-Real                          | Val  Loss: 0.6791 | Val  Acc: 0.9697
 Site-Real                          | Val  Loss: 0.6984 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 0.8746 | Val  Acc: 0.9184
 Site-Painting                      | Val  Loss: 0.9574 | Val  Acc: 0.8759
 Site-Painting                      | Val  Loss: 0.9359 | Val  Acc: 0.8490
 Site-Sketch                        | Val  Loss: 1.0276 | Val  Acc: 0.8189
 Site-Sketch                        | Val  Loss: 1.0912 | Val  Acc: 0.7753
 Site-QuickDraw                     | Val  Loss: 1.9858 | Val  Acc: 0.3716
 Site-Infograph                     | Val  Loss: 1.6798 | Val  Acc: 0.5064
Average Valid Accuracy: 0.8270
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8947
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8692
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8667
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8381
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8339
 Best site-Real                      | Epoch:17 | Val Acc: 0.9167
 Best site-Real                      | Epoch:17 | Val Acc: 0.9576
 Best site-Real                      | Epoch:17 | Val Acc: 0.9697
 Best site-Real                      | Epoch:17 | Val Acc: 0.9697
 Best site-Painting                  | Epoch:17 | Val Acc: 0.9184
 Best site-Painting                  | Epoch:17 | Val Acc: 0.8759
 Best site-Painting                  | Epoch:17 | Val Acc: 0.8490
 Best site-Sketch                    | Epoch:17 | Val Acc: 0.8189
 Best site-Sketch                    | Epoch:17 | Val Acc: 0.7753
 Best site-QuickDraw                 | Epoch:17 | Val Acc: 0.3716
 Best site-Infograph                 | Epoch:17 | Val Acc: 0.5064
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 18 ============
denominator: 23137.359375
 Site-Clipart                       | Train Loss: 1.0131 | Train Acc: 0.8609
 Site-Clipart                       | Train Loss: 0.8898 | Train Acc: 0.9006
 Site-Clipart                       | Train Loss: 1.0589 | Train Acc: 0.8311
 Site-Clipart                       | Train Loss: 1.0054 | Train Acc: 0.8671
 Site-Clipart                       | Train Loss: 1.0372 | Train Acc: 0.8507
 Site-Real                          | Train Loss: 0.7618 | Train Acc: 0.9127
 Site-Real                          | Train Loss: 0.6478 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.6455 | Train Acc: 0.9637
 Site-Real                          | Train Loss: 0.7505 | Train Acc: 0.9339
 Site-Painting                      | Train Loss: 0.8361 | Train Acc: 0.8571
 Site-Painting                      | Train Loss: 0.9089 | Train Acc: 0.8689
 Site-Painting                      | Train Loss: 0.9492 | Train Acc: 0.8478
 Site-Sketch                        | Train Loss: 1.0748 | Train Acc: 0.7382
 Site-Sketch                        | Train Loss: 0.9996 | Train Acc: 0.8015
 Site-QuickDraw                     | Train Loss: 1.9002 | Train Acc: 0.4159
 Site-Infograph                     | Train Loss: 1.7342 | Train Acc: 0.4658
Average Train Accuracy: 0.8180
 Site-Clipart                       | Val  Loss: 0.8106 | Val  Acc: 0.9079
 Site-Clipart                       | Val  Loss: 0.9847 | Val  Acc: 0.8692
 Site-Clipart                       | Val  Loss: 1.0130 | Val  Acc: 0.8733
 Site-Clipart                       | Val  Loss: 0.9717 | Val  Acc: 0.8619
 Site-Clipart                       | Val  Loss: 1.0435 | Val  Acc: 0.8407
 Site-Real                          | Val  Loss: 0.7646 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.7057 | Val  Acc: 0.9576
 Site-Real                          | Val  Loss: 0.6255 | Val  Acc: 0.9515
 Site-Real                          | Val  Loss: 0.6435 | Val  Acc: 0.9740
 Site-Painting                      | Val  Loss: 0.8041 | Val  Acc: 0.9184
 Site-Painting                      | Val  Loss: 0.9085 | Val  Acc: 0.8394
 Site-Painting                      | Val  Loss: 0.8786 | Val  Acc: 0.8802
 Site-Sketch                        | Val  Loss: 0.9977 | Val  Acc: 0.8110
 Site-Sketch                        | Val  Loss: 1.0115 | Val  Acc: 0.7809
 Site-QuickDraw                     | Val  Loss: 1.9788 | Val  Acc: 0.3899
 Site-Infograph                     | Val  Loss: 1.6591 | Val  Acc: 0.5064
Average Valid Accuracy: 0.8322
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9079
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8692
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8733
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8619
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8407
 Best site-Real                      | Epoch:18 | Val Acc: 0.9524
 Best site-Real                      | Epoch:18 | Val Acc: 0.9576
 Best site-Real                      | Epoch:18 | Val Acc: 0.9515
 Best site-Real                      | Epoch:18 | Val Acc: 0.9740
 Best site-Painting                  | Epoch:18 | Val Acc: 0.9184
 Best site-Painting                  | Epoch:18 | Val Acc: 0.8394
 Best site-Painting                  | Epoch:18 | Val Acc: 0.8802
 Best site-Sketch                    | Epoch:18 | Val Acc: 0.8110
 Best site-Sketch                    | Epoch:18 | Val Acc: 0.7809
 Best site-QuickDraw                 | Epoch:18 | Val Acc: 0.3899
 Best site-Infograph                 | Epoch:18 | Val Acc: 0.5064
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 19 ============
denominator: 22461.611328125
 Site-Clipart                       | Train Loss: 0.9869 | Train Acc: 0.8696
 Site-Clipart                       | Train Loss: 0.8923 | Train Acc: 0.8944
 Site-Clipart                       | Train Loss: 1.0309 | Train Acc: 0.8533
 Site-Clipart                       | Train Loss: 0.9648 | Train Acc: 0.8703
 Site-Clipart                       | Train Loss: 1.0094 | Train Acc: 0.8597
 Site-Real                          | Train Loss: 0.7149 | Train Acc: 0.9127
 Site-Real                          | Train Loss: 0.6209 | Train Acc: 0.9605
 Site-Real                          | Train Loss: 0.6047 | Train Acc: 0.9677
 Site-Real                          | Train Loss: 0.6947 | Train Acc: 0.9368
 Site-Painting                      | Train Loss: 0.8168 | Train Acc: 0.8844
 Site-Painting                      | Train Loss: 0.9013 | Train Acc: 0.8544
 Site-Painting                      | Train Loss: 0.8828 | Train Acc: 0.8443
 Site-Sketch                        | Train Loss: 1.0293 | Train Acc: 0.7487
 Site-Sketch                        | Train Loss: 0.9751 | Train Acc: 0.8165
 Site-QuickDraw                     | Train Loss: 1.8828 | Train Acc: 0.3945
 Site-Infograph                     | Train Loss: 1.7192 | Train Acc: 0.4829
Average Train Accuracy: 0.8219
 Site-Clipart                       | Val  Loss: 0.7975 | Val  Acc: 0.8684
 Site-Clipart                       | Val  Loss: 0.9863 | Val  Acc: 0.8411
 Site-Clipart                       | Val  Loss: 0.9811 | Val  Acc: 0.8800
 Site-Clipart                       | Val  Loss: 0.8891 | Val  Acc: 0.8619
 Site-Clipart                       | Val  Loss: 1.0133 | Val  Acc: 0.8610
 Site-Real                          | Val  Loss: 0.7009 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.6778 | Val  Acc: 0.9831
 Site-Real                          | Val  Loss: 0.5946 | Val  Acc: 0.9515
 Site-Real                          | Val  Loss: 0.6056 | Val  Acc: 0.9740
 Site-Painting                      | Val  Loss: 0.7634 | Val  Acc: 0.9286
 Site-Painting                      | Val  Loss: 0.8372 | Val  Acc: 0.8613
 Site-Painting                      | Val  Loss: 0.8895 | Val  Acc: 0.8542
 Site-Sketch                        | Val  Loss: 0.9564 | Val  Acc: 0.8346
 Site-Sketch                        | Val  Loss: 0.9847 | Val  Acc: 0.7697
 Site-QuickDraw                     | Val  Loss: 1.9504 | Val  Acc: 0.4037
 Site-Infograph                     | Val  Loss: 1.6079 | Val  Acc: 0.5577
Average Valid Accuracy: 0.8357
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.8684
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.8411
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.8800
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.8619
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.8610
 Best site-Real                      | Epoch:19 | Val Acc: 0.9405
 Best site-Real                      | Epoch:19 | Val Acc: 0.9831
 Best site-Real                      | Epoch:19 | Val Acc: 0.9515
 Best site-Real                      | Epoch:19 | Val Acc: 0.9740
 Best site-Painting                  | Epoch:19 | Val Acc: 0.9286
 Best site-Painting                  | Epoch:19 | Val Acc: 0.8613
 Best site-Painting                  | Epoch:19 | Val Acc: 0.8542
 Best site-Sketch                    | Epoch:19 | Val Acc: 0.8346
 Best site-Sketch                    | Epoch:19 | Val Acc: 0.7697
 Best site-QuickDraw                 | Epoch:19 | Val Acc: 0.4037
 Best site-Infograph                 | Epoch:19 | Val Acc: 0.5577
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 20 ============
denominator: 21792.30859375
 Site-Clipart                       | Train Loss: 0.9216 | Train Acc: 0.8609
 Site-Clipart                       | Train Loss: 0.8730 | Train Acc: 0.8944
 Site-Clipart                       | Train Loss: 0.9796 | Train Acc: 0.8800
 Site-Clipart                       | Train Loss: 0.8989 | Train Acc: 0.8703
 Site-Clipart                       | Train Loss: 0.9682 | Train Acc: 0.8439
 Site-Real                          | Train Loss: 0.6710 | Train Acc: 0.9365
 Site-Real                          | Train Loss: 0.5589 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.5794 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.6701 | Train Acc: 0.9397
 Site-Painting                      | Train Loss: 0.8079 | Train Acc: 0.8707
 Site-Painting                      | Train Loss: 0.8445 | Train Acc: 0.8495
 Site-Painting                      | Train Loss: 0.8591 | Train Acc: 0.8547
 Site-Sketch                        | Train Loss: 1.0012 | Train Acc: 0.7958
 Site-Sketch                        | Train Loss: 0.9528 | Train Acc: 0.8352
 Site-QuickDraw                     | Train Loss: 1.9259 | Train Acc: 0.3976
 Site-Infograph                     | Train Loss: 1.7228 | Train Acc: 0.4573
Average Train Accuracy: 0.8269
 Site-Clipart                       | Val  Loss: 0.7633 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 0.8984 | Val  Acc: 0.8879
 Site-Clipart                       | Val  Loss: 0.9567 | Val  Acc: 0.8800
 Site-Clipart                       | Val  Loss: 0.8692 | Val  Acc: 0.8619
 Site-Clipart                       | Val  Loss: 0.9650 | Val  Acc: 0.8407
 Site-Real                          | Val  Loss: 0.6789 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.6275 | Val  Acc: 0.9746
 Site-Real                          | Val  Loss: 0.5572 | Val  Acc: 0.9697
 Site-Real                          | Val  Loss: 0.5624 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 0.7770 | Val  Acc: 0.9082
 Site-Painting                      | Val  Loss: 0.8274 | Val  Acc: 0.8613
 Site-Painting                      | Val  Loss: 0.8157 | Val  Acc: 0.8698
 Site-Sketch                        | Val  Loss: 0.9194 | Val  Acc: 0.8346
 Site-Sketch                        | Val  Loss: 0.9691 | Val  Acc: 0.7753
 Site-QuickDraw                     | Val  Loss: 1.9241 | Val  Acc: 0.4037
 Site-Infograph                     | Val  Loss: 1.6256 | Val  Acc: 0.5064
Average Valid Accuracy: 0.8369
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8947
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8879
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8800
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8619
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8407
 Best site-Real                      | Epoch:20 | Val Acc: 0.9524
 Best site-Real                      | Epoch:20 | Val Acc: 0.9746
 Best site-Real                      | Epoch:20 | Val Acc: 0.9697
 Best site-Real                      | Epoch:20 | Val Acc: 0.9697
 Best site-Painting                  | Epoch:20 | Val Acc: 0.9082
 Best site-Painting                  | Epoch:20 | Val Acc: 0.8613
 Best site-Painting                  | Epoch:20 | Val Acc: 0.8698
 Best site-Sketch                    | Epoch:20 | Val Acc: 0.8346
 Best site-Sketch                    | Epoch:20 | Val Acc: 0.7753
 Best site-QuickDraw                 | Epoch:20 | Val Acc: 0.4037
 Best site-Infograph                 | Epoch:20 | Val Acc: 0.5064
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 21 ============
denominator: 21290.4375
 Site-Clipart                       | Train Loss: 0.8658 | Train Acc: 0.8783
 Site-Clipart                       | Train Loss: 0.8393 | Train Acc: 0.8944
 Site-Clipart                       | Train Loss: 0.9675 | Train Acc: 0.8578
 Site-Clipart                       | Train Loss: 0.8662 | Train Acc: 0.8829
 Site-Clipart                       | Train Loss: 0.8874 | Train Acc: 0.8756
 Site-Real                          | Train Loss: 0.6268 | Train Acc: 0.9286
 Site-Real                          | Train Loss: 0.5088 | Train Acc: 0.9887
 Site-Real                          | Train Loss: 0.5150 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.6398 | Train Acc: 0.9454
 Site-Painting                      | Train Loss: 0.8191 | Train Acc: 0.8503
 Site-Painting                      | Train Loss: 0.8375 | Train Acc: 0.8738
 Site-Painting                      | Train Loss: 0.8177 | Train Acc: 0.8616
 Site-Sketch                        | Train Loss: 0.9544 | Train Acc: 0.7853
 Site-Sketch                        | Train Loss: 0.9019 | Train Acc: 0.8240
 Site-QuickDraw                     | Train Loss: 1.8896 | Train Acc: 0.4251
 Site-Infograph                     | Train Loss: 1.7311 | Train Acc: 0.4530
Average Train Accuracy: 0.8310
 Site-Clipart                       | Val  Loss: 0.7531 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 0.9166 | Val  Acc: 0.8785
 Site-Clipart                       | Val  Loss: 0.9523 | Val  Acc: 0.8400
 Site-Clipart                       | Val  Loss: 0.8597 | Val  Acc: 0.8619
 Site-Clipart                       | Val  Loss: 0.9268 | Val  Acc: 0.8508
 Site-Real                          | Val  Loss: 0.6424 | Val  Acc: 0.9286
 Site-Real                          | Val  Loss: 0.6260 | Val  Acc: 0.9661
 Site-Real                          | Val  Loss: 0.5244 | Val  Acc: 0.9576
 Site-Real                          | Val  Loss: 0.5216 | Val  Acc: 0.9740
 Site-Painting                      | Val  Loss: 0.6941 | Val  Acc: 0.8980
 Site-Painting                      | Val  Loss: 0.7909 | Val  Acc: 0.8467
 Site-Painting                      | Val  Loss: 0.7870 | Val  Acc: 0.8646
 Site-Sketch                        | Val  Loss: 0.7768 | Val  Acc: 0.8346
 Site-Sketch                        | Val  Loss: 0.9277 | Val  Acc: 0.7809
 Site-QuickDraw                     | Val  Loss: 1.9183 | Val  Acc: 0.4128
 Site-Infograph                     | Val  Loss: 1.6124 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8306
============ Train epoch 22 ============
denominator: 20617.275390625
 Site-Clipart                       | Train Loss: 0.8639 | Train Acc: 0.8348
 Site-Clipart                       | Train Loss: 0.7738 | Train Acc: 0.9193
 Site-Clipart                       | Train Loss: 0.9208 | Train Acc: 0.8622
 Site-Clipart                       | Train Loss: 0.8422 | Train Acc: 0.8766
 Site-Clipart                       | Train Loss: 0.8810 | Train Acc: 0.8710
 Site-Real                          | Train Loss: 0.5846 | Train Acc: 0.9365
 Site-Real                          | Train Loss: 0.4701 | Train Acc: 0.9661
 Site-Real                          | Train Loss: 0.4880 | Train Acc: 0.9637
 Site-Real                          | Train Loss: 0.6235 | Train Acc: 0.9454
 Site-Painting                      | Train Loss: 0.7671 | Train Acc: 0.8776
 Site-Painting                      | Train Loss: 0.7366 | Train Acc: 0.8689
 Site-Painting                      | Train Loss: 0.7996 | Train Acc: 0.8651
 Site-Sketch                        | Train Loss: 0.9344 | Train Acc: 0.7696
 Site-Sketch                        | Train Loss: 0.9129 | Train Acc: 0.8165
 Site-QuickDraw                     | Train Loss: 1.8160 | Train Acc: 0.4404
 Site-Infograph                     | Train Loss: 1.6560 | Train Acc: 0.4701
Average Train Accuracy: 0.8302
 Site-Clipart                       | Val  Loss: 0.6947 | Val  Acc: 0.8553
 Site-Clipart                       | Val  Loss: 0.8398 | Val  Acc: 0.8879
 Site-Clipart                       | Val  Loss: 0.8733 | Val  Acc: 0.9067
 Site-Clipart                       | Val  Loss: 0.7890 | Val  Acc: 0.8762
 Site-Clipart                       | Val  Loss: 0.9226 | Val  Acc: 0.8305
 Site-Real                          | Val  Loss: 0.5940 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.5906 | Val  Acc: 0.9492
 Site-Real                          | Val  Loss: 0.4873 | Val  Acc: 0.9697
 Site-Real                          | Val  Loss: 0.4867 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 0.6956 | Val  Acc: 0.9082
 Site-Painting                      | Val  Loss: 0.7208 | Val  Acc: 0.8613
 Site-Painting                      | Val  Loss: 0.7498 | Val  Acc: 0.8750
 Site-Sketch                        | Val  Loss: 0.7944 | Val  Acc: 0.8425
 Site-Sketch                        | Val  Loss: 0.8644 | Val  Acc: 0.7865
 Site-QuickDraw                     | Val  Loss: 1.9161 | Val  Acc: 0.4083
 Site-Infograph                     | Val  Loss: 1.5687 | Val  Acc: 0.5192
Average Valid Accuracy: 0.8367
============ Train epoch 23 ============
denominator: 20320.21484375
 Site-Clipart                       | Train Loss: 0.8202 | Train Acc: 0.8522
 Site-Clipart                       | Train Loss: 0.7875 | Train Acc: 0.9006
 Site-Clipart                       | Train Loss: 0.8533 | Train Acc: 0.8578
 Site-Clipart                       | Train Loss: 0.8124 | Train Acc: 0.8703
 Site-Clipart                       | Train Loss: 0.8545 | Train Acc: 0.8575
 Site-Real                          | Train Loss: 0.5698 | Train Acc: 0.9048
 Site-Real                          | Train Loss: 0.4534 | Train Acc: 0.9774
 Site-Real                          | Train Loss: 0.4686 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.5743 | Train Acc: 0.9511
 Site-Painting                      | Train Loss: 0.7677 | Train Acc: 0.8776
 Site-Painting                      | Train Loss: 0.7463 | Train Acc: 0.8835
 Site-Painting                      | Train Loss: 0.7480 | Train Acc: 0.8685
 Site-Sketch                        | Train Loss: 0.8918 | Train Acc: 0.7539
 Site-Sketch                        | Train Loss: 0.8099 | Train Acc: 0.8202
 Site-QuickDraw                     | Train Loss: 1.7988 | Train Acc: 0.4648
 Site-Infograph                     | Train Loss: 1.6649 | Train Acc: 0.4487
Average Train Accuracy: 0.8288
 Site-Clipart                       | Val  Loss: 0.6644 | Val  Acc: 0.8684
 Site-Clipart                       | Val  Loss: 0.8056 | Val  Acc: 0.9065
 Site-Clipart                       | Val  Loss: 0.8476 | Val  Acc: 0.9000
 Site-Clipart                       | Val  Loss: 0.7666 | Val  Acc: 0.8714
 Site-Clipart                       | Val  Loss: 0.8974 | Val  Acc: 0.8373
 Site-Real                          | Val  Loss: 0.5755 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.5361 | Val  Acc: 0.9576
 Site-Real                          | Val  Loss: 0.4541 | Val  Acc: 0.9636
 Site-Real                          | Val  Loss: 0.4732 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 0.6509 | Val  Acc: 0.8980
 Site-Painting                      | Val  Loss: 0.7268 | Val  Acc: 0.8394
 Site-Painting                      | Val  Loss: 0.7192 | Val  Acc: 0.8750
 Site-Sketch                        | Val  Loss: 0.8072 | Val  Acc: 0.8346
 Site-Sketch                        | Val  Loss: 0.8463 | Val  Acc: 0.7809
 Site-QuickDraw                     | Val  Loss: 1.8593 | Val  Acc: 0.4450
 Site-Infograph                     | Val  Loss: 1.5204 | Val  Acc: 0.5256
Average Valid Accuracy: 0.8384
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.8684
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.9065
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.9000
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.8714
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.8373
 Best site-Real                      | Epoch:23 | Val Acc: 0.9405
 Best site-Real                      | Epoch:23 | Val Acc: 0.9576
 Best site-Real                      | Epoch:23 | Val Acc: 0.9636
 Best site-Real                      | Epoch:23 | Val Acc: 0.9697
 Best site-Painting                  | Epoch:23 | Val Acc: 0.8980
 Best site-Painting                  | Epoch:23 | Val Acc: 0.8394
 Best site-Painting                  | Epoch:23 | Val Acc: 0.8750
 Best site-Sketch                    | Epoch:23 | Val Acc: 0.8346
 Best site-Sketch                    | Epoch:23 | Val Acc: 0.7809
 Best site-QuickDraw                 | Epoch:23 | Val Acc: 0.4450
 Best site-Infograph                 | Epoch:23 | Val Acc: 0.5256
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 24 ============
denominator: 19766.67578125
 Site-Clipart                       | Train Loss: 0.8343 | Train Acc: 0.8435
 Site-Clipart                       | Train Loss: 0.7142 | Train Acc: 0.8944
 Site-Clipart                       | Train Loss: 0.8713 | Train Acc: 0.8533
 Site-Clipart                       | Train Loss: 0.8077 | Train Acc: 0.8513
 Site-Clipart                       | Train Loss: 0.8154 | Train Acc: 0.8620
 Site-Real                          | Train Loss: 0.5504 | Train Acc: 0.9048
 Site-Real                          | Train Loss: 0.4221 | Train Acc: 0.9831
 Site-Real                          | Train Loss: 0.4350 | Train Acc: 0.9637
 Site-Real                          | Train Loss: 0.5315 | Train Acc: 0.9425
 Site-Painting                      | Train Loss: 0.6135 | Train Acc: 0.8776
 Site-Painting                      | Train Loss: 0.6541 | Train Acc: 0.8835
 Site-Painting                      | Train Loss: 0.7276 | Train Acc: 0.8754
 Site-Sketch                        | Train Loss: 0.8936 | Train Acc: 0.7539
 Site-Sketch                        | Train Loss: 0.7996 | Train Acc: 0.8315
 Site-QuickDraw                     | Train Loss: 1.9069 | Train Acc: 0.4220
 Site-Infograph                     | Train Loss: 1.6439 | Train Acc: 0.4744
Average Train Accuracy: 0.8260
 Site-Clipart                       | Val  Loss: 0.6600 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 0.7789 | Val  Acc: 0.9065
 Site-Clipart                       | Val  Loss: 0.8158 | Val  Acc: 0.8733
 Site-Clipart                       | Val  Loss: 0.7452 | Val  Acc: 0.8714
 Site-Clipart                       | Val  Loss: 0.8537 | Val  Acc: 0.8441
 Site-Real                          | Val  Loss: 0.5602 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.5251 | Val  Acc: 0.9576
 Site-Real                          | Val  Loss: 0.4231 | Val  Acc: 0.9515
 Site-Real                          | Val  Loss: 0.4207 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 0.5806 | Val  Acc: 0.9490
 Site-Painting                      | Val  Loss: 0.6965 | Val  Acc: 0.8394
 Site-Painting                      | Val  Loss: 0.6903 | Val  Acc: 0.8646
 Site-Sketch                        | Val  Loss: 0.7083 | Val  Acc: 0.8268
 Site-Sketch                        | Val  Loss: 0.8680 | Val  Acc: 0.7921
 Site-QuickDraw                     | Val  Loss: 1.8428 | Val  Acc: 0.4495
 Site-Infograph                     | Val  Loss: 1.5432 | Val  Acc: 0.5385
Average Valid Accuracy: 0.8418
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8947
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9065
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8733
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8714
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8441
 Best site-Real                      | Epoch:24 | Val Acc: 0.9405
 Best site-Real                      | Epoch:24 | Val Acc: 0.9576
 Best site-Real                      | Epoch:24 | Val Acc: 0.9515
 Best site-Real                      | Epoch:24 | Val Acc: 0.9697
 Best site-Painting                  | Epoch:24 | Val Acc: 0.9490
 Best site-Painting                  | Epoch:24 | Val Acc: 0.8394
 Best site-Painting                  | Epoch:24 | Val Acc: 0.8646
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.8268
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.7921
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.4495
 Best site-Infograph                 | Epoch:24 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 25 ============
denominator: 19527.109375
 Site-Clipart                       | Train Loss: 0.7751 | Train Acc: 0.8696
 Site-Clipart                       | Train Loss: 0.6660 | Train Acc: 0.9068
 Site-Clipart                       | Train Loss: 0.8852 | Train Acc: 0.8444
 Site-Clipart                       | Train Loss: 0.7743 | Train Acc: 0.8703
 Site-Clipart                       | Train Loss: 0.8020 | Train Acc: 0.8643
 Site-Real                          | Train Loss: 0.5155 | Train Acc: 0.9206
 Site-Real                          | Train Loss: 0.4235 | Train Acc: 0.9661
 Site-Real                          | Train Loss: 0.4261 | Train Acc: 0.9597
 Site-Real                          | Train Loss: 0.5183 | Train Acc: 0.9483
 Site-Painting                      | Train Loss: 0.7061 | Train Acc: 0.8912
 Site-Painting                      | Train Loss: 0.6698 | Train Acc: 0.9078
 Site-Painting                      | Train Loss: 0.7144 | Train Acc: 0.8616
 Site-Sketch                        | Train Loss: 0.8485 | Train Acc: 0.7644
 Site-Sketch                        | Train Loss: 0.6952 | Train Acc: 0.8352
 Site-QuickDraw                     | Train Loss: 1.7287 | Train Acc: 0.4404
 Site-Infograph                     | Train Loss: 1.6005 | Train Acc: 0.4829
Average Train Accuracy: 0.8333
 Site-Clipart                       | Val  Loss: 0.5728 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 0.8095 | Val  Acc: 0.8785
 Site-Clipart                       | Val  Loss: 0.7836 | Val  Acc: 0.9000
 Site-Clipart                       | Val  Loss: 0.6950 | Val  Acc: 0.8619
 Site-Clipart                       | Val  Loss: 0.8041 | Val  Acc: 0.8780
 Site-Real                          | Val  Loss: 0.5173 | Val  Acc: 0.9643
 Site-Real                          | Val  Loss: 0.4832 | Val  Acc: 0.9661
 Site-Real                          | Val  Loss: 0.4188 | Val  Acc: 0.9636
 Site-Real                          | Val  Loss: 0.3924 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 0.6065 | Val  Acc: 0.9082
 Site-Painting                      | Val  Loss: 0.6750 | Val  Acc: 0.8686
 Site-Painting                      | Val  Loss: 0.6786 | Val  Acc: 0.8542
 Site-Sketch                        | Val  Loss: 0.7465 | Val  Acc: 0.8661
 Site-Sketch                        | Val  Loss: 0.8225 | Val  Acc: 0.7809
 Site-QuickDraw                     | Val  Loss: 1.8214 | Val  Acc: 0.4771
 Site-Infograph                     | Val  Loss: 1.5296 | Val  Acc: 0.5256
Average Valid Accuracy: 0.8473
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.8947
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.8785
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.9000
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.8619
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.8780
 Best site-Real                      | Epoch:25 | Val Acc: 0.9643
 Best site-Real                      | Epoch:25 | Val Acc: 0.9661
 Best site-Real                      | Epoch:25 | Val Acc: 0.9636
 Best site-Real                      | Epoch:25 | Val Acc: 0.9697
 Best site-Painting                  | Epoch:25 | Val Acc: 0.9082
 Best site-Painting                  | Epoch:25 | Val Acc: 0.8686
 Best site-Painting                  | Epoch:25 | Val Acc: 0.8542
 Best site-Sketch                    | Epoch:25 | Val Acc: 0.8661
 Best site-Sketch                    | Epoch:25 | Val Acc: 0.7809
 Best site-QuickDraw                 | Epoch:25 | Val Acc: 0.4771
 Best site-Infograph                 | Epoch:25 | Val Acc: 0.5256
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 26 ============
denominator: 19042.919921875
 Site-Clipart                       | Train Loss: 0.7136 | Train Acc: 0.9043
 Site-Clipart                       | Train Loss: 0.6405 | Train Acc: 0.9068
 Site-Clipart                       | Train Loss: 0.7992 | Train Acc: 0.8756
 Site-Clipart                       | Train Loss: 0.7436 | Train Acc: 0.8544
 Site-Clipart                       | Train Loss: 0.7601 | Train Acc: 0.8778
 Site-Real                          | Train Loss: 0.4809 | Train Acc: 0.9365
 Site-Real                          | Train Loss: 0.3834 | Train Acc: 0.9774
 Site-Real                          | Train Loss: 0.3790 | Train Acc: 0.9677
 Site-Real                          | Train Loss: 0.4889 | Train Acc: 0.9540
 Site-Painting                      | Train Loss: 0.6208 | Train Acc: 0.8912
 Site-Painting                      | Train Loss: 0.6529 | Train Acc: 0.8738
 Site-Painting                      | Train Loss: 0.6686 | Train Acc: 0.8789
 Site-Sketch                        | Train Loss: 0.8067 | Train Acc: 0.7749
 Site-Sketch                        | Train Loss: 0.7342 | Train Acc: 0.8127
 Site-QuickDraw                     | Train Loss: 1.7316 | Train Acc: 0.4771
 Site-Infograph                     | Train Loss: 1.6347 | Train Acc: 0.4701
Average Train Accuracy: 0.8396
 Site-Clipart                       | Val  Loss: 0.6412 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 0.7216 | Val  Acc: 0.8972
 Site-Clipart                       | Val  Loss: 0.7490 | Val  Acc: 0.8667
 Site-Clipart                       | Val  Loss: 0.7233 | Val  Acc: 0.8810
 Site-Clipart                       | Val  Loss: 0.7923 | Val  Acc: 0.8305
 Site-Real                          | Val  Loss: 0.4817 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.4606 | Val  Acc: 0.9661
 Site-Real                          | Val  Loss: 0.4005 | Val  Acc: 0.9515
 Site-Real                          | Val  Loss: 0.3757 | Val  Acc: 0.9740
 Site-Painting                      | Val  Loss: 0.5458 | Val  Acc: 0.9286
 Site-Painting                      | Val  Loss: 0.6559 | Val  Acc: 0.8540
 Site-Painting                      | Val  Loss: 0.6737 | Val  Acc: 0.8750
 Site-Sketch                        | Val  Loss: 0.7137 | Val  Acc: 0.8425
 Site-Sketch                        | Val  Loss: 0.7917 | Val  Acc: 0.8034
 Site-QuickDraw                     | Val  Loss: 1.8405 | Val  Acc: 0.4450
 Site-Infograph                     | Val  Loss: 1.5663 | Val  Acc: 0.4872
Average Valid Accuracy: 0.8399
============ Train epoch 27 ============
denominator: 18523.609375
 Site-Clipart                       | Train Loss: 0.7391 | Train Acc: 0.8609
 Site-Clipart                       | Train Loss: 0.6524 | Train Acc: 0.9193
 Site-Clipart                       | Train Loss: 0.7706 | Train Acc: 0.8711
 Site-Clipart                       | Train Loss: 0.7308 | Train Acc: 0.8892
 Site-Clipart                       | Train Loss: 0.7637 | Train Acc: 0.8575
 Site-Real                          | Train Loss: 0.4801 | Train Acc: 0.9127
 Site-Real                          | Train Loss: 0.3677 | Train Acc: 0.9774
 Site-Real                          | Train Loss: 0.3768 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.4548 | Train Acc: 0.9483
 Site-Painting                      | Train Loss: 0.6552 | Train Acc: 0.8639
 Site-Painting                      | Train Loss: 0.6008 | Train Acc: 0.8981
 Site-Painting                      | Train Loss: 0.6847 | Train Acc: 0.8547
 Site-Sketch                        | Train Loss: 0.7832 | Train Acc: 0.7958
 Site-Sketch                        | Train Loss: 0.7410 | Train Acc: 0.8427
 Site-QuickDraw                     | Train Loss: 1.7111 | Train Acc: 0.4648
 Site-Infograph                     | Train Loss: 1.6124 | Train Acc: 0.4658
Average Train Accuracy: 0.8371
 Site-Clipart                       | Val  Loss: 0.5348 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 0.7737 | Val  Acc: 0.8505
 Site-Clipart                       | Val  Loss: 0.7582 | Val  Acc: 0.9200
 Site-Clipart                       | Val  Loss: 0.6755 | Val  Acc: 0.8857
 Site-Clipart                       | Val  Loss: 0.7803 | Val  Acc: 0.8542
 Site-Real                          | Val  Loss: 0.4929 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.4455 | Val  Acc: 0.9661
 Site-Real                          | Val  Loss: 0.3629 | Val  Acc: 0.9636
 Site-Real                          | Val  Loss: 0.3715 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.5519 | Val  Acc: 0.8980
 Site-Painting                      | Val  Loss: 0.5863 | Val  Acc: 0.8686
 Site-Painting                      | Val  Loss: 0.6351 | Val  Acc: 0.8646
 Site-Sketch                        | Val  Loss: 0.6510 | Val  Acc: 0.8661
 Site-Sketch                        | Val  Loss: 0.7551 | Val  Acc: 0.8090
 Site-QuickDraw                     | Val  Loss: 1.7830 | Val  Acc: 0.4862
 Site-Infograph                     | Val  Loss: 1.5225 | Val  Acc: 0.5064
Average Valid Accuracy: 0.8454
============ Train epoch 28 ============
denominator: 18068.4296875
 Site-Clipart                       | Train Loss: 0.7268 | Train Acc: 0.8609
 Site-Clipart                       | Train Loss: 0.6144 | Train Acc: 0.9130
 Site-Clipart                       | Train Loss: 0.7589 | Train Acc: 0.8622
 Site-Clipart                       | Train Loss: 0.7108 | Train Acc: 0.8639
 Site-Clipart                       | Train Loss: 0.7274 | Train Acc: 0.8665
 Site-Real                          | Train Loss: 0.4388 | Train Acc: 0.9444
 Site-Real                          | Train Loss: 0.3418 | Train Acc: 0.9831
 Site-Real                          | Train Loss: 0.3571 | Train Acc: 0.9637
 Site-Real                          | Train Loss: 0.4601 | Train Acc: 0.9454
 Site-Painting                      | Train Loss: 0.5261 | Train Acc: 0.8639
 Site-Painting                      | Train Loss: 0.5837 | Train Acc: 0.8738
 Site-Painting                      | Train Loss: 0.6583 | Train Acc: 0.8616
 Site-Sketch                        | Train Loss: 0.7724 | Train Acc: 0.7906
 Site-Sketch                        | Train Loss: 0.7406 | Train Acc: 0.8464
 Site-QuickDraw                     | Train Loss: 1.7132 | Train Acc: 0.4373
 Site-Infograph                     | Train Loss: 1.5812 | Train Acc: 0.4872
Average Train Accuracy: 0.8353
 Site-Clipart                       | Val  Loss: 0.5233 | Val  Acc: 0.9342
 Site-Clipart                       | Val  Loss: 0.6942 | Val  Acc: 0.8879
 Site-Clipart                       | Val  Loss: 0.7446 | Val  Acc: 0.8733
 Site-Clipart                       | Val  Loss: 0.6799 | Val  Acc: 0.8810
 Site-Clipart                       | Val  Loss: 0.7591 | Val  Acc: 0.8712
 Site-Real                          | Val  Loss: 0.4336 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.4527 | Val  Acc: 0.9407
 Site-Real                          | Val  Loss: 0.3463 | Val  Acc: 0.9636
 Site-Real                          | Val  Loss: 0.3373 | Val  Acc: 0.9740
 Site-Painting                      | Val  Loss: 0.5300 | Val  Acc: 0.8980
 Site-Painting                      | Val  Loss: 0.6072 | Val  Acc: 0.8832
 Site-Painting                      | Val  Loss: 0.5993 | Val  Acc: 0.8854
 Site-Sketch                        | Val  Loss: 0.6968 | Val  Acc: 0.8740
 Site-Sketch                        | Val  Loss: 0.7619 | Val  Acc: 0.7753
 Site-QuickDraw                     | Val  Loss: 1.8043 | Val  Acc: 0.4495
 Site-Infograph                     | Val  Loss: 1.5197 | Val  Acc: 0.5449
Average Valid Accuracy: 0.8485
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.9342
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.8879
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.8733
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.8810
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.8712
 Best site-Real                      | Epoch:28 | Val Acc: 0.9405
 Best site-Real                      | Epoch:28 | Val Acc: 0.9407
 Best site-Real                      | Epoch:28 | Val Acc: 0.9636
 Best site-Real                      | Epoch:28 | Val Acc: 0.9740
 Best site-Painting                  | Epoch:28 | Val Acc: 0.8980
 Best site-Painting                  | Epoch:28 | Val Acc: 0.8832
 Best site-Painting                  | Epoch:28 | Val Acc: 0.8854
 Best site-Sketch                    | Epoch:28 | Val Acc: 0.8740
 Best site-Sketch                    | Epoch:28 | Val Acc: 0.7753
 Best site-QuickDraw                 | Epoch:28 | Val Acc: 0.4495
 Best site-Infograph                 | Epoch:28 | Val Acc: 0.5449
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 29 ============
denominator: 17914.07421875
 Site-Clipart                       | Train Loss: 0.7014 | Train Acc: 0.8870
 Site-Clipart                       | Train Loss: 0.6449 | Train Acc: 0.8758
 Site-Clipart                       | Train Loss: 0.7185 | Train Acc: 0.8800
 Site-Clipart                       | Train Loss: 0.6814 | Train Acc: 0.8861
 Site-Clipart                       | Train Loss: 0.7201 | Train Acc: 0.8824
 Site-Real                          | Train Loss: 0.4310 | Train Acc: 0.9286
 Site-Real                          | Train Loss: 0.3236 | Train Acc: 0.9774
 Site-Real                          | Train Loss: 0.3377 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.4541 | Train Acc: 0.9454
 Site-Painting                      | Train Loss: 0.5724 | Train Acc: 0.8776
 Site-Painting                      | Train Loss: 0.6363 | Train Acc: 0.8883
 Site-Painting                      | Train Loss: 0.6290 | Train Acc: 0.8858
 Site-Sketch                        | Train Loss: 0.7602 | Train Acc: 0.7958
 Site-Sketch                        | Train Loss: 0.6274 | Train Acc: 0.8127
 Site-QuickDraw                     | Train Loss: 1.7285 | Train Acc: 0.4893
 Site-Infograph                     | Train Loss: 1.5484 | Train Acc: 0.4872
Average Train Accuracy: 0.8419
 Site-Clipart                       | Val  Loss: 0.5366 | Val  Acc: 0.9079
 Site-Clipart                       | Val  Loss: 0.6808 | Val  Acc: 0.8692
 Site-Clipart                       | Val  Loss: 0.7008 | Val  Acc: 0.9000
 Site-Clipart                       | Val  Loss: 0.6538 | Val  Acc: 0.8714
 Site-Clipart                       | Val  Loss: 0.7074 | Val  Acc: 0.8644
 Site-Real                          | Val  Loss: 0.4729 | Val  Acc: 0.9286
 Site-Real                          | Val  Loss: 0.4425 | Val  Acc: 0.9492
 Site-Real                          | Val  Loss: 0.2971 | Val  Acc: 0.9818
 Site-Real                          | Val  Loss: 0.3275 | Val  Acc: 0.9654
 Site-Painting                      | Val  Loss: 0.4968 | Val  Acc: 0.9082
 Site-Painting                      | Val  Loss: 0.6172 | Val  Acc: 0.8759
 Site-Painting                      | Val  Loss: 0.6049 | Val  Acc: 0.8802
 Site-Sketch                        | Val  Loss: 0.5880 | Val  Acc: 0.8740
 Site-Sketch                        | Val  Loss: 0.6938 | Val  Acc: 0.8034
 Site-QuickDraw                     | Val  Loss: 1.7534 | Val  Acc: 0.5092
 Site-Infograph                     | Val  Loss: 1.5102 | Val  Acc: 0.4936
Average Valid Accuracy: 0.8489
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.9079
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.8692
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.9000
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.8714
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.8644
 Best site-Real                      | Epoch:29 | Val Acc: 0.9286
 Best site-Real                      | Epoch:29 | Val Acc: 0.9492
 Best site-Real                      | Epoch:29 | Val Acc: 0.9818
 Best site-Real                      | Epoch:29 | Val Acc: 0.9654
 Best site-Painting                  | Epoch:29 | Val Acc: 0.9082
 Best site-Painting                  | Epoch:29 | Val Acc: 0.8759
 Best site-Painting                  | Epoch:29 | Val Acc: 0.8802
 Best site-Sketch                    | Epoch:29 | Val Acc: 0.8740
 Best site-Sketch                    | Epoch:29 | Val Acc: 0.8034
 Best site-QuickDraw                 | Epoch:29 | Val Acc: 0.5092
 Best site-Infograph                 | Epoch:29 | Val Acc: 0.4936
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 30 ============
denominator: 17499.640625
 Site-Clipart                       | Train Loss: 0.6661 | Train Acc: 0.9130
 Site-Clipart                       | Train Loss: 0.5962 | Train Acc: 0.9255
 Site-Clipart                       | Train Loss: 0.7173 | Train Acc: 0.8578
 Site-Clipart                       | Train Loss: 0.6662 | Train Acc: 0.8924
 Site-Clipart                       | Train Loss: 0.6964 | Train Acc: 0.8733
 Site-Real                          | Train Loss: 0.4253 | Train Acc: 0.9365
 Site-Real                          | Train Loss: 0.2998 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.3223 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.4217 | Train Acc: 0.9569
 Site-Painting                      | Train Loss: 0.5674 | Train Acc: 0.8844
 Site-Painting                      | Train Loss: 0.6000 | Train Acc: 0.8689
 Site-Painting                      | Train Loss: 0.6173 | Train Acc: 0.8581
 Site-Sketch                        | Train Loss: 0.7474 | Train Acc: 0.8325
 Site-Sketch                        | Train Loss: 0.6679 | Train Acc: 0.8127
 Site-QuickDraw                     | Train Loss: 1.6506 | Train Acc: 0.4740
 Site-Infograph                     | Train Loss: 1.6066 | Train Acc: 0.5085
Average Train Accuracy: 0.8461
 Site-Clipart                       | Val  Loss: 0.5453 | Val  Acc: 0.8816
 Site-Clipart                       | Val  Loss: 0.6537 | Val  Acc: 0.8879
 Site-Clipart                       | Val  Loss: 0.6678 | Val  Acc: 0.8867
 Site-Clipart                       | Val  Loss: 0.6229 | Val  Acc: 0.8810
 Site-Clipart                       | Val  Loss: 0.7322 | Val  Acc: 0.8475
 Site-Real                          | Val  Loss: 0.4435 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.4005 | Val  Acc: 0.9661
 Site-Real                          | Val  Loss: 0.3104 | Val  Acc: 0.9818
 Site-Real                          | Val  Loss: 0.3138 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 0.4855 | Val  Acc: 0.9286
 Site-Painting                      | Val  Loss: 0.6236 | Val  Acc: 0.8613
 Site-Painting                      | Val  Loss: 0.5747 | Val  Acc: 0.9062
 Site-Sketch                        | Val  Loss: 0.6252 | Val  Acc: 0.8425
 Site-Sketch                        | Val  Loss: 0.7137 | Val  Acc: 0.8034
 Site-QuickDraw                     | Val  Loss: 1.7388 | Val  Acc: 0.4862
 Site-Infograph                     | Val  Loss: 1.4617 | Val  Acc: 0.5192
Average Valid Accuracy: 0.8494
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.8816
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.8879
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.8867
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.8810
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.8475
 Best site-Real                      | Epoch:30 | Val Acc: 0.9405
 Best site-Real                      | Epoch:30 | Val Acc: 0.9661
 Best site-Real                      | Epoch:30 | Val Acc: 0.9818
 Best site-Real                      | Epoch:30 | Val Acc: 0.9697
 Best site-Painting                  | Epoch:30 | Val Acc: 0.9286
 Best site-Painting                  | Epoch:30 | Val Acc: 0.8613
 Best site-Painting                  | Epoch:30 | Val Acc: 0.9062
 Best site-Sketch                    | Epoch:30 | Val Acc: 0.8425
 Best site-Sketch                    | Epoch:30 | Val Acc: 0.8034
 Best site-QuickDraw                 | Epoch:30 | Val Acc: 0.4862
 Best site-Infograph                 | Epoch:30 | Val Acc: 0.5192
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 31 ============
denominator: 17217.498046875
 Site-Clipart                       | Train Loss: 0.6736 | Train Acc: 0.8957
 Site-Clipart                       | Train Loss: 0.5301 | Train Acc: 0.9193
 Site-Clipart                       | Train Loss: 0.7271 | Train Acc: 0.8622
 Site-Clipart                       | Train Loss: 0.6532 | Train Acc: 0.8671
 Site-Clipart                       | Train Loss: 0.7058 | Train Acc: 0.8462
 Site-Real                          | Train Loss: 0.3881 | Train Acc: 0.9444
 Site-Real                          | Train Loss: 0.3041 | Train Acc: 0.9831
 Site-Real                          | Train Loss: 0.3042 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.4027 | Train Acc: 0.9425
 Site-Painting                      | Train Loss: 0.5914 | Train Acc: 0.8912
 Site-Painting                      | Train Loss: 0.5240 | Train Acc: 0.8883
 Site-Painting                      | Train Loss: 0.6238 | Train Acc: 0.8547
 Site-Sketch                        | Train Loss: 0.7450 | Train Acc: 0.7853
 Site-Sketch                        | Train Loss: 0.6524 | Train Acc: 0.8502
 Site-QuickDraw                     | Train Loss: 1.6822 | Train Acc: 0.4648
 Site-Infograph                     | Train Loss: 1.5982 | Train Acc: 0.5256
Average Train Accuracy: 0.8433
 Site-Clipart                       | Val  Loss: 0.4400 | Val  Acc: 0.9079
 Site-Clipart                       | Val  Loss: 0.7007 | Val  Acc: 0.8598
 Site-Clipart                       | Val  Loss: 0.6967 | Val  Acc: 0.8800
 Site-Clipart                       | Val  Loss: 0.6167 | Val  Acc: 0.8667
 Site-Clipart                       | Val  Loss: 0.6856 | Val  Acc: 0.8814
 Site-Real                          | Val  Loss: 0.3944 | Val  Acc: 0.9167
 Site-Real                          | Val  Loss: 0.3825 | Val  Acc: 0.9661
 Site-Real                          | Val  Loss: 0.3292 | Val  Acc: 0.9515
 Site-Real                          | Val  Loss: 0.3101 | Val  Acc: 0.9784
 Site-Painting                      | Val  Loss: 0.4451 | Val  Acc: 0.9082
 Site-Painting                      | Val  Loss: 0.5467 | Val  Acc: 0.8613
 Site-Painting                      | Val  Loss: 0.5449 | Val  Acc: 0.8750
 Site-Sketch                        | Val  Loss: 0.6343 | Val  Acc: 0.8740
 Site-Sketch                        | Val  Loss: 0.7192 | Val  Acc: 0.8146
 Site-QuickDraw                     | Val  Loss: 1.7534 | Val  Acc: 0.4771
 Site-Infograph                     | Val  Loss: 1.4789 | Val  Acc: 0.5256
Average Valid Accuracy: 0.8465
============ Train epoch 32 ============
denominator: 16895.54296875
 Site-Clipart                       | Train Loss: 0.6311 | Train Acc: 0.8870
 Site-Clipart                       | Train Loss: 0.5657 | Train Acc: 0.8944
 Site-Clipart                       | Train Loss: 0.6799 | Train Acc: 0.8578
 Site-Clipart                       | Train Loss: 0.6289 | Train Acc: 0.8861
 Site-Clipart                       | Train Loss: 0.6751 | Train Acc: 0.8597
 Site-Real                          | Train Loss: 0.3976 | Train Acc: 0.9365
 Site-Real                          | Train Loss: 0.2786 | Train Acc: 0.9774
 Site-Real                          | Train Loss: 0.3009 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.3944 | Train Acc: 0.9483
 Site-Painting                      | Train Loss: 0.5535 | Train Acc: 0.8844
 Site-Painting                      | Train Loss: 0.4892 | Train Acc: 0.8738
 Site-Painting                      | Train Loss: 0.5821 | Train Acc: 0.8824
 Site-Sketch                        | Train Loss: 0.7176 | Train Acc: 0.7958
 Site-Sketch                        | Train Loss: 0.7069 | Train Acc: 0.8652
 Site-QuickDraw                     | Train Loss: 1.6000 | Train Acc: 0.4924
 Site-Infograph                     | Train Loss: 1.5196 | Train Acc: 0.5085
Average Train Accuracy: 0.8451
 Site-Clipart                       | Val  Loss: 0.4827 | Val  Acc: 0.9079
 Site-Clipart                       | Val  Loss: 0.6425 | Val  Acc: 0.8505
 Site-Clipart                       | Val  Loss: 0.6772 | Val  Acc: 0.8800
 Site-Clipart                       | Val  Loss: 0.6100 | Val  Acc: 0.8762
 Site-Clipart                       | Val  Loss: 0.6832 | Val  Acc: 0.8678
 Site-Real                          | Val  Loss: 0.3602 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.3944 | Val  Acc: 0.9407
 Site-Real                          | Val  Loss: 0.2904 | Val  Acc: 0.9758
 Site-Real                          | Val  Loss: 0.3082 | Val  Acc: 0.9654
 Site-Painting                      | Val  Loss: 0.4583 | Val  Acc: 0.9388
 Site-Painting                      | Val  Loss: 0.5556 | Val  Acc: 0.8540
 Site-Painting                      | Val  Loss: 0.5548 | Val  Acc: 0.8698
 Site-Sketch                        | Val  Loss: 0.5923 | Val  Acc: 0.8583
 Site-Sketch                        | Val  Loss: 0.7101 | Val  Acc: 0.8090
 Site-QuickDraw                     | Val  Loss: 1.7164 | Val  Acc: 0.5092
 Site-Infograph                     | Val  Loss: 1.4968 | Val  Acc: 0.5192
Average Valid Accuracy: 0.8484
============ Train epoch 33 ============
denominator: 16793.96484375
 Site-Clipart                       | Train Loss: 0.5790 | Train Acc: 0.9043
 Site-Clipart                       | Train Loss: 0.5350 | Train Acc: 0.9255
 Site-Clipart                       | Train Loss: 0.6399 | Train Acc: 0.8844
 Site-Clipart                       | Train Loss: 0.6292 | Train Acc: 0.8861
 Site-Clipart                       | Train Loss: 0.6328 | Train Acc: 0.8756
 Site-Real                          | Train Loss: 0.3636 | Train Acc: 0.9365
 Site-Real                          | Train Loss: 0.2593 | Train Acc: 0.9774
 Site-Real                          | Train Loss: 0.2931 | Train Acc: 0.9677
 Site-Real                          | Train Loss: 0.3772 | Train Acc: 0.9511
 Site-Painting                      | Train Loss: 0.5539 | Train Acc: 0.8912
 Site-Painting                      | Train Loss: 0.5036 | Train Acc: 0.8883
 Site-Painting                      | Train Loss: 0.5574 | Train Acc: 0.8754
 Site-Sketch                        | Train Loss: 0.7312 | Train Acc: 0.7958
 Site-Sketch                        | Train Loss: 0.6644 | Train Acc: 0.8240
 Site-QuickDraw                     | Train Loss: 1.6785 | Train Acc: 0.5076
 Site-Infograph                     | Train Loss: 1.5728 | Train Acc: 0.4915
Average Train Accuracy: 0.8489
 Site-Clipart                       | Val  Loss: 0.4667 | Val  Acc: 0.9211
 Site-Clipart                       | Val  Loss: 0.6176 | Val  Acc: 0.8879
 Site-Clipart                       | Val  Loss: 0.6011 | Val  Acc: 0.9067
 Site-Clipart                       | Val  Loss: 0.5577 | Val  Acc: 0.8857
 Site-Clipart                       | Val  Loss: 0.6648 | Val  Acc: 0.8847
 Site-Real                          | Val  Loss: 0.3763 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.3248 | Val  Acc: 0.9746
 Site-Real                          | Val  Loss: 0.2885 | Val  Acc: 0.9576
 Site-Real                          | Val  Loss: 0.2666 | Val  Acc: 0.9654
 Site-Painting                      | Val  Loss: 0.4930 | Val  Acc: 0.8980
 Site-Painting                      | Val  Loss: 0.5271 | Val  Acc: 0.8540
 Site-Painting                      | Val  Loss: 0.5395 | Val  Acc: 0.9062
 Site-Sketch                        | Val  Loss: 0.6080 | Val  Acc: 0.8425
 Site-Sketch                        | Val  Loss: 0.6489 | Val  Acc: 0.8258
 Site-QuickDraw                     | Val  Loss: 1.7080 | Val  Acc: 0.5092
 Site-Infograph                     | Val  Loss: 1.4434 | Val  Acc: 0.5449
Average Valid Accuracy: 0.8565
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.9211
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.8879
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.9067
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.8857
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.8847
 Best site-Real                      | Epoch:33 | Val Acc: 0.9405
 Best site-Real                      | Epoch:33 | Val Acc: 0.9746
 Best site-Real                      | Epoch:33 | Val Acc: 0.9576
 Best site-Real                      | Epoch:33 | Val Acc: 0.9654
 Best site-Painting                  | Epoch:33 | Val Acc: 0.8980
 Best site-Painting                  | Epoch:33 | Val Acc: 0.8540
 Best site-Painting                  | Epoch:33 | Val Acc: 0.9062
 Best site-Sketch                    | Epoch:33 | Val Acc: 0.8425
 Best site-Sketch                    | Epoch:33 | Val Acc: 0.8258
 Best site-QuickDraw                 | Epoch:33 | Val Acc: 0.5092
 Best site-Infograph                 | Epoch:33 | Val Acc: 0.5449
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 34 ============
denominator: 16575.859375
 Site-Clipart                       | Train Loss: 0.6041 | Train Acc: 0.9043
 Site-Clipart                       | Train Loss: 0.5186 | Train Acc: 0.9255
 Site-Clipart                       | Train Loss: 0.6582 | Train Acc: 0.9022
 Site-Clipart                       | Train Loss: 0.6076 | Train Acc: 0.8956
 Site-Clipart                       | Train Loss: 0.6133 | Train Acc: 0.8643
 Site-Real                          | Train Loss: 0.3426 | Train Acc: 0.9286
 Site-Real                          | Train Loss: 0.2814 | Train Acc: 0.9661
 Site-Real                          | Train Loss: 0.2669 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.3688 | Train Acc: 0.9569
 Site-Painting                      | Train Loss: 0.4426 | Train Acc: 0.9048
 Site-Painting                      | Train Loss: 0.4914 | Train Acc: 0.8835
 Site-Painting                      | Train Loss: 0.5543 | Train Acc: 0.8720
 Site-Sketch                        | Train Loss: 0.6688 | Train Acc: 0.7906
 Site-Sketch                        | Train Loss: 0.6304 | Train Acc: 0.8502
 Site-QuickDraw                     | Train Loss: 1.6109 | Train Acc: 0.5260
 Site-Infograph                     | Train Loss: 1.5175 | Train Acc: 0.5128
Average Train Accuracy: 0.8534
 Site-Clipart                       | Val  Loss: 0.4493 | Val  Acc: 0.9211
 Site-Clipart                       | Val  Loss: 0.6044 | Val  Acc: 0.8972
 Site-Clipart                       | Val  Loss: 0.5711 | Val  Acc: 0.8933
 Site-Clipart                       | Val  Loss: 0.5771 | Val  Acc: 0.9000
 Site-Clipart                       | Val  Loss: 0.6333 | Val  Acc: 0.8712
 Site-Real                          | Val  Loss: 0.3923 | Val  Acc: 0.9286
 Site-Real                          | Val  Loss: 0.3805 | Val  Acc: 0.9492
 Site-Real                          | Val  Loss: 0.2527 | Val  Acc: 0.9818
 Site-Real                          | Val  Loss: 0.2669 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 0.4610 | Val  Acc: 0.9388
 Site-Painting                      | Val  Loss: 0.5665 | Val  Acc: 0.8467
 Site-Painting                      | Val  Loss: 0.5089 | Val  Acc: 0.8906
 Site-Sketch                        | Val  Loss: 0.6011 | Val  Acc: 0.8504
 Site-Sketch                        | Val  Loss: 0.6495 | Val  Acc: 0.8258
 Site-QuickDraw                     | Val  Loss: 1.7039 | Val  Acc: 0.5138
 Site-Infograph                     | Val  Loss: 1.4248 | Val  Acc: 0.5513
Average Valid Accuracy: 0.8581
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.9211
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.8972
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.8933
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.9000
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.8712
 Best site-Real                      | Epoch:34 | Val Acc: 0.9286
 Best site-Real                      | Epoch:34 | Val Acc: 0.9492
 Best site-Real                      | Epoch:34 | Val Acc: 0.9818
 Best site-Real                      | Epoch:34 | Val Acc: 0.9697
 Best site-Painting                  | Epoch:34 | Val Acc: 0.9388
 Best site-Painting                  | Epoch:34 | Val Acc: 0.8467
 Best site-Painting                  | Epoch:34 | Val Acc: 0.8906
 Best site-Sketch                    | Epoch:34 | Val Acc: 0.8504
 Best site-Sketch                    | Epoch:34 | Val Acc: 0.8258
 Best site-QuickDraw                 | Epoch:34 | Val Acc: 0.5138
 Best site-Infograph                 | Epoch:34 | Val Acc: 0.5513
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 35 ============
denominator: 16314.66796875
 Site-Clipart                       | Train Loss: 0.6116 | Train Acc: 0.8870
 Site-Clipart                       | Train Loss: 0.4743 | Train Acc: 0.9317
 Site-Clipart                       | Train Loss: 0.6422 | Train Acc: 0.8756
 Site-Clipart                       | Train Loss: 0.6036 | Train Acc: 0.8703
 Site-Clipart                       | Train Loss: 0.6211 | Train Acc: 0.8801
 Site-Real                          | Train Loss: 0.3463 | Train Acc: 0.9444
 Site-Real                          | Train Loss: 0.2429 | Train Acc: 0.9774
 Site-Real                          | Train Loss: 0.2674 | Train Acc: 0.9758
 Site-Real                          | Train Loss: 0.3550 | Train Acc: 0.9598
 Site-Painting                      | Train Loss: 0.4776 | Train Acc: 0.8776
 Site-Painting                      | Train Loss: 0.5526 | Train Acc: 0.9029
 Site-Painting                      | Train Loss: 0.5503 | Train Acc: 0.8858
 Site-Sketch                        | Train Loss: 0.6983 | Train Acc: 0.8063
 Site-Sketch                        | Train Loss: 0.5825 | Train Acc: 0.8614
 Site-QuickDraw                     | Train Loss: 1.5722 | Train Acc: 0.5107
 Site-Infograph                     | Train Loss: 1.5335 | Train Acc: 0.5000
Average Train Accuracy: 0.8529
 Site-Clipart                       | Val  Loss: 0.4833 | Val  Acc: 0.8947
 Site-Clipart                       | Val  Loss: 0.5740 | Val  Acc: 0.8785
 Site-Clipart                       | Val  Loss: 0.6084 | Val  Acc: 0.9067
 Site-Clipart                       | Val  Loss: 0.5469 | Val  Acc: 0.8905
 Site-Clipart                       | Val  Loss: 0.6115 | Val  Acc: 0.8712
 Site-Real                          | Val  Loss: 0.3513 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.3479 | Val  Acc: 0.9407
 Site-Real                          | Val  Loss: 0.2611 | Val  Acc: 0.9758
 Site-Real                          | Val  Loss: 0.2513 | Val  Acc: 0.9740
 Site-Painting                      | Val  Loss: 0.4254 | Val  Acc: 0.9082
 Site-Painting                      | Val  Loss: 0.5155 | Val  Acc: 0.8467
 Site-Painting                      | Val  Loss: 0.5099 | Val  Acc: 0.8802
 Site-Sketch                        | Val  Loss: 0.6001 | Val  Acc: 0.8346
 Site-Sketch                        | Val  Loss: 0.6245 | Val  Acc: 0.8258
 Site-QuickDraw                     | Val  Loss: 1.6999 | Val  Acc: 0.5092
 Site-Infograph                     | Val  Loss: 1.4298 | Val  Acc: 0.5513
Average Valid Accuracy: 0.8518
============ Train epoch 36 ============
denominator: 16227.931640625
 Site-Clipart                       | Train Loss: 0.5841 | Train Acc: 0.8957
 Site-Clipart                       | Train Loss: 0.5325 | Train Acc: 0.9317
 Site-Clipart                       | Train Loss: 0.6107 | Train Acc: 0.8844
 Site-Clipart                       | Train Loss: 0.5801 | Train Acc: 0.8924
 Site-Clipart                       | Train Loss: 0.6136 | Train Acc: 0.8891
 Site-Real                          | Train Loss: 0.3571 | Train Acc: 0.9206
 Site-Real                          | Train Loss: 0.2541 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.2617 | Train Acc: 0.9637
 Site-Real                          | Train Loss: 0.3419 | Train Acc: 0.9569
 Site-Painting                      | Train Loss: 0.5111 | Train Acc: 0.8980
 Site-Painting                      | Train Loss: 0.5114 | Train Acc: 0.8786
 Site-Painting                      | Train Loss: 0.5278 | Train Acc: 0.8754
 Site-Sketch                        | Train Loss: 0.6304 | Train Acc: 0.8115
 Site-Sketch                        | Train Loss: 0.5963 | Train Acc: 0.8689
 Site-QuickDraw                     | Train Loss: 1.5478 | Train Acc: 0.5046
 Site-Infograph                     | Train Loss: 1.5393 | Train Acc: 0.5128
Average Train Accuracy: 0.8535
 Site-Clipart                       | Val  Loss: 0.4359 | Val  Acc: 0.9342
 Site-Clipart                       | Val  Loss: 0.5714 | Val  Acc: 0.8972
 Site-Clipart                       | Val  Loss: 0.5461 | Val  Acc: 0.9200
 Site-Clipart                       | Val  Loss: 0.5759 | Val  Acc: 0.8810
 Site-Clipart                       | Val  Loss: 0.6145 | Val  Acc: 0.8644
 Site-Real                          | Val  Loss: 0.3461 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.3423 | Val  Acc: 0.9661
 Site-Real                          | Val  Loss: 0.2792 | Val  Acc: 0.9697
 Site-Real                          | Val  Loss: 0.2507 | Val  Acc: 0.9740
 Site-Painting                      | Val  Loss: 0.4354 | Val  Acc: 0.9082
 Site-Painting                      | Val  Loss: 0.5101 | Val  Acc: 0.8832
 Site-Painting                      | Val  Loss: 0.5070 | Val  Acc: 0.8854
 Site-Sketch                        | Val  Loss: 0.5418 | Val  Acc: 0.8504
 Site-Sketch                        | Val  Loss: 0.6508 | Val  Acc: 0.8258
 Site-QuickDraw                     | Val  Loss: 1.6367 | Val  Acc: 0.5413
 Site-Infograph                     | Val  Loss: 1.4673 | Val  Acc: 0.5321
Average Valid Accuracy: 0.8616
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.9342
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.8972
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.9200
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.8810
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.8644
 Best site-Real                      | Epoch:36 | Val Acc: 0.9524
 Best site-Real                      | Epoch:36 | Val Acc: 0.9661
 Best site-Real                      | Epoch:36 | Val Acc: 0.9697
 Best site-Real                      | Epoch:36 | Val Acc: 0.9740
 Best site-Painting                  | Epoch:36 | Val Acc: 0.9082
 Best site-Painting                  | Epoch:36 | Val Acc: 0.8832
 Best site-Painting                  | Epoch:36 | Val Acc: 0.8854
 Best site-Sketch                    | Epoch:36 | Val Acc: 0.8504
 Best site-Sketch                    | Epoch:36 | Val Acc: 0.8258
 Best site-QuickDraw                 | Epoch:36 | Val Acc: 0.5413
 Best site-Infograph                 | Epoch:36 | Val Acc: 0.5321
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 37 ============
denominator: 15832.8896484375
 Site-Clipart                       | Train Loss: 0.5910 | Train Acc: 0.9130
 Site-Clipart                       | Train Loss: 0.5389 | Train Acc: 0.8696
 Site-Clipart                       | Train Loss: 0.6296 | Train Acc: 0.8889
 Site-Clipart                       | Train Loss: 0.6003 | Train Acc: 0.8987
 Site-Clipart                       | Train Loss: 0.5932 | Train Acc: 0.8756
 Site-Real                          | Train Loss: 0.3588 | Train Acc: 0.9286
 Site-Real                          | Train Loss: 0.2039 | Train Acc: 0.9831
 Site-Real                          | Train Loss: 0.2489 | Train Acc: 0.9637
 Site-Real                          | Train Loss: 0.3130 | Train Acc: 0.9511
 Site-Painting                      | Train Loss: 0.4968 | Train Acc: 0.9048
 Site-Painting                      | Train Loss: 0.4387 | Train Acc: 0.8932
 Site-Painting                      | Train Loss: 0.5519 | Train Acc: 0.8824
 Site-Sketch                        | Train Loss: 0.6580 | Train Acc: 0.8220
 Site-Sketch                        | Train Loss: 0.5305 | Train Acc: 0.8315
 Site-QuickDraw                     | Train Loss: 1.6396 | Train Acc: 0.5199
 Site-Infograph                     | Train Loss: 1.4587 | Train Acc: 0.4915
Average Train Accuracy: 0.8511
 Site-Clipart                       | Val  Loss: 0.4461 | Val  Acc: 0.8816
 Site-Clipart                       | Val  Loss: 0.5544 | Val  Acc: 0.9159
 Site-Clipart                       | Val  Loss: 0.5840 | Val  Acc: 0.8800
 Site-Clipart                       | Val  Loss: 0.5581 | Val  Acc: 0.8762
 Site-Clipart                       | Val  Loss: 0.5938 | Val  Acc: 0.8949
 Site-Real                          | Val  Loss: 0.3178 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.3064 | Val  Acc: 0.9746
 Site-Real                          | Val  Loss: 0.2454 | Val  Acc: 0.9697
 Site-Real                          | Val  Loss: 0.2440 | Val  Acc: 0.9654
 Site-Painting                      | Val  Loss: 0.4199 | Val  Acc: 0.9286
 Site-Painting                      | Val  Loss: 0.5156 | Val  Acc: 0.8613
 Site-Painting                      | Val  Loss: 0.4815 | Val  Acc: 0.8958
 Site-Sketch                        | Val  Loss: 0.5276 | Val  Acc: 0.8583
 Site-Sketch                        | Val  Loss: 0.5613 | Val  Acc: 0.8539
 Site-QuickDraw                     | Val  Loss: 1.6838 | Val  Acc: 0.5413
 Site-Infograph                     | Val  Loss: 1.4297 | Val  Acc: 0.5256
Average Valid Accuracy: 0.8602
============ Train epoch 38 ============
denominator: 15858.9072265625
 Site-Clipart                       | Train Loss: 0.5344 | Train Acc: 0.9130
 Site-Clipart                       | Train Loss: 0.5011 | Train Acc: 0.9006
 Site-Clipart                       | Train Loss: 0.5636 | Train Acc: 0.8844
 Site-Clipart                       | Train Loss: 0.5429 | Train Acc: 0.8956
 Site-Clipart                       | Train Loss: 0.5916 | Train Acc: 0.8710
 Site-Real                          | Train Loss: 0.3187 | Train Acc: 0.9524
 Site-Real                          | Train Loss: 0.2260 | Train Acc: 0.9774
 Site-Real                          | Train Loss: 0.2396 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.3182 | Train Acc: 0.9540
 Site-Painting                      | Train Loss: 0.4293 | Train Acc: 0.9184
 Site-Painting                      | Train Loss: 0.4108 | Train Acc: 0.8981
 Site-Painting                      | Train Loss: 0.5268 | Train Acc: 0.8927
 Site-Sketch                        | Train Loss: 0.6469 | Train Acc: 0.8063
 Site-Sketch                        | Train Loss: 0.5443 | Train Acc: 0.8951
 Site-QuickDraw                     | Train Loss: 1.6273 | Train Acc: 0.5229
 Site-Infograph                     | Train Loss: 1.5784 | Train Acc: 0.4744
Average Train Accuracy: 0.8580
 Site-Clipart                       | Val  Loss: 0.3826 | Val  Acc: 0.9211
 Site-Clipart                       | Val  Loss: 0.5711 | Val  Acc: 0.8972
 Site-Clipart                       | Val  Loss: 0.5665 | Val  Acc: 0.8933
 Site-Clipart                       | Val  Loss: 0.5549 | Val  Acc: 0.8810
 Site-Clipart                       | Val  Loss: 0.6166 | Val  Acc: 0.8644
 Site-Real                          | Val  Loss: 0.3467 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.2835 | Val  Acc: 0.9915
 Site-Real                          | Val  Loss: 0.2405 | Val  Acc: 0.9576
 Site-Real                          | Val  Loss: 0.2408 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.4113 | Val  Acc: 0.9286
 Site-Painting                      | Val  Loss: 0.5096 | Val  Acc: 0.8759
 Site-Painting                      | Val  Loss: 0.4766 | Val  Acc: 0.8698
 Site-Sketch                        | Val  Loss: 0.5696 | Val  Acc: 0.8504
 Site-Sketch                        | Val  Loss: 0.5782 | Val  Acc: 0.8539
 Site-QuickDraw                     | Val  Loss: 1.6149 | Val  Acc: 0.5367
 Site-Infograph                     | Val  Loss: 1.4338 | Val  Acc: 0.5577
Average Valid Accuracy: 0.8607
============ Train epoch 39 ============
denominator: 15875.3701171875
 Site-Clipart                       | Train Loss: 0.5811 | Train Acc: 0.8957
 Site-Clipart                       | Train Loss: 0.5030 | Train Acc: 0.9193
 Site-Clipart                       | Train Loss: 0.6181 | Train Acc: 0.8756
 Site-Clipart                       | Train Loss: 0.5503 | Train Acc: 0.8956
 Site-Clipart                       | Train Loss: 0.5895 | Train Acc: 0.8665
 Site-Real                          | Train Loss: 0.3149 | Train Acc: 0.9524
 Site-Real                          | Train Loss: 0.2348 | Train Acc: 0.9831
 Site-Real                          | Train Loss: 0.2259 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.3153 | Train Acc: 0.9454
 Site-Painting                      | Train Loss: 0.3808 | Train Acc: 0.9116
 Site-Painting                      | Train Loss: 0.4111 | Train Acc: 0.9175
 Site-Painting                      | Train Loss: 0.5118 | Train Acc: 0.8858
 Site-Sketch                        | Train Loss: 0.6595 | Train Acc: 0.7958
 Site-Sketch                        | Train Loss: 0.6375 | Train Acc: 0.8427
 Site-QuickDraw                     | Train Loss: 1.6063 | Train Acc: 0.5260
 Site-Infograph                     | Train Loss: 1.5162 | Train Acc: 0.4915
Average Train Accuracy: 0.8547
 Site-Clipart                       | Val  Loss: 0.3792 | Val  Acc: 0.9079
 Site-Clipart                       | Val  Loss: 0.5498 | Val  Acc: 0.8879
 Site-Clipart                       | Val  Loss: 0.5333 | Val  Acc: 0.9200
 Site-Clipart                       | Val  Loss: 0.5335 | Val  Acc: 0.8857
 Site-Clipart                       | Val  Loss: 0.6073 | Val  Acc: 0.8644
 Site-Real                          | Val  Loss: 0.3226 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.3030 | Val  Acc: 0.9746
 Site-Real                          | Val  Loss: 0.2280 | Val  Acc: 0.9758
 Site-Real                          | Val  Loss: 0.2358 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 0.4005 | Val  Acc: 0.9082
 Site-Painting                      | Val  Loss: 0.5106 | Val  Acc: 0.8832
 Site-Painting                      | Val  Loss: 0.4535 | Val  Acc: 0.8802
 Site-Sketch                        | Val  Loss: 0.4953 | Val  Acc: 0.8898
 Site-Sketch                        | Val  Loss: 0.6064 | Val  Acc: 0.8090
 Site-QuickDraw                     | Val  Loss: 1.6564 | Val  Acc: 0.5138
 Site-Infograph                     | Val  Loss: 1.4246 | Val  Acc: 0.5513
Average Valid Accuracy: 0.8601
============ Train epoch 40 ============
denominator: 15450.02734375
 Site-Clipart                       | Train Loss: 0.5577 | Train Acc: 0.9217
 Site-Clipart                       | Train Loss: 0.4641 | Train Acc: 0.9255
 Site-Clipart                       | Train Loss: 0.6137 | Train Acc: 0.8622
 Site-Clipart                       | Train Loss: 0.5234 | Train Acc: 0.9051
 Site-Clipart                       | Train Loss: 0.5460 | Train Acc: 0.8937
 Site-Real                          | Train Loss: 0.3220 | Train Acc: 0.9444
 Site-Real                          | Train Loss: 0.2046 | Train Acc: 0.9831
 Site-Real                          | Train Loss: 0.2262 | Train Acc: 0.9637
 Site-Real                          | Train Loss: 0.3101 | Train Acc: 0.9598
 Site-Painting                      | Train Loss: 0.4749 | Train Acc: 0.8980
 Site-Painting                      | Train Loss: 0.4188 | Train Acc: 0.8883
 Site-Painting                      | Train Loss: 0.4946 | Train Acc: 0.8893
 Site-Sketch                        | Train Loss: 0.6037 | Train Acc: 0.8534
 Site-Sketch                        | Train Loss: 0.5463 | Train Acc: 0.8727
 Site-QuickDraw                     | Train Loss: 1.5405 | Train Acc: 0.5352
 Site-Infograph                     | Train Loss: 1.5187 | Train Acc: 0.5043
Average Train Accuracy: 0.8625
 Site-Clipart                       | Val  Loss: 0.3885 | Val  Acc: 0.9211
 Site-Clipart                       | Val  Loss: 0.5327 | Val  Acc: 0.8879
 Site-Clipart                       | Val  Loss: 0.5768 | Val  Acc: 0.8933
 Site-Clipart                       | Val  Loss: 0.5142 | Val  Acc: 0.8810
 Site-Clipart                       | Val  Loss: 0.6166 | Val  Acc: 0.8644
 Site-Real                          | Val  Loss: 0.3523 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.3015 | Val  Acc: 0.9661
 Site-Real                          | Val  Loss: 0.2298 | Val  Acc: 0.9697
 Site-Real                          | Val  Loss: 0.2262 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 0.3865 | Val  Acc: 0.9286
 Site-Painting                      | Val  Loss: 0.4577 | Val  Acc: 0.8540
 Site-Painting                      | Val  Loss: 0.4903 | Val  Acc: 0.8854
 Site-Sketch                        | Val  Loss: 0.5058 | Val  Acc: 0.8661
 Site-Sketch                        | Val  Loss: 0.5624 | Val  Acc: 0.8539
 Site-QuickDraw                     | Val  Loss: 1.5942 | Val  Acc: 0.5917
 Site-Infograph                     | Val  Loss: 1.3915 | Val  Acc: 0.5385
Average Valid Accuracy: 0.8632
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.9211
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.8879
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.8933
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.8810
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.8644
 Best site-Real                      | Epoch:40 | Val Acc: 0.9405
 Best site-Real                      | Epoch:40 | Val Acc: 0.9661
 Best site-Real                      | Epoch:40 | Val Acc: 0.9697
 Best site-Real                      | Epoch:40 | Val Acc: 0.9697
 Best site-Painting                  | Epoch:40 | Val Acc: 0.9286
 Best site-Painting                  | Epoch:40 | Val Acc: 0.8540
 Best site-Painting                  | Epoch:40 | Val Acc: 0.8854
 Best site-Sketch                    | Epoch:40 | Val Acc: 0.8661
 Best site-Sketch                    | Epoch:40 | Val Acc: 0.8539
 Best site-QuickDraw                 | Epoch:40 | Val Acc: 0.5917
 Best site-Infograph                 | Epoch:40 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 41 ============
denominator: 15323.216796875
 Site-Clipart                       | Train Loss: 0.5334 | Train Acc: 0.9043
 Site-Clipart                       | Train Loss: 0.4723 | Train Acc: 0.9255
 Site-Clipart                       | Train Loss: 0.5358 | Train Acc: 0.8933
 Site-Clipart                       | Train Loss: 0.5402 | Train Acc: 0.8892
 Site-Clipart                       | Train Loss: 0.5287 | Train Acc: 0.9005
 Site-Real                          | Train Loss: 0.3081 | Train Acc: 0.9365
 Site-Real                          | Train Loss: 0.2106 | Train Acc: 0.9774
 Site-Real                          | Train Loss: 0.2279 | Train Acc: 0.9758
 Site-Real                          | Train Loss: 0.3052 | Train Acc: 0.9598
 Site-Painting                      | Train Loss: 0.4365 | Train Acc: 0.8980
 Site-Painting                      | Train Loss: 0.4477 | Train Acc: 0.9272
 Site-Painting                      | Train Loss: 0.4869 | Train Acc: 0.9066
 Site-Sketch                        | Train Loss: 0.6230 | Train Acc: 0.8272
 Site-Sketch                        | Train Loss: 0.5196 | Train Acc: 0.8614
 Site-QuickDraw                     | Train Loss: 1.5055 | Train Acc: 0.5413
 Site-Infograph                     | Train Loss: 1.5120 | Train Acc: 0.5043
Average Train Accuracy: 0.8643
 Site-Clipart                       | Val  Loss: 0.3835 | Val  Acc: 0.9079
 Site-Clipart                       | Val  Loss: 0.5586 | Val  Acc: 0.8879
 Site-Clipart                       | Val  Loss: 0.5236 | Val  Acc: 0.9067
 Site-Clipart                       | Val  Loss: 0.4940 | Val  Acc: 0.9238
 Site-Clipart                       | Val  Loss: 0.5675 | Val  Acc: 0.8746
 Site-Real                          | Val  Loss: 0.2904 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.2862 | Val  Acc: 0.9576
 Site-Real                          | Val  Loss: 0.1952 | Val  Acc: 0.9818
 Site-Real                          | Val  Loss: 0.2196 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 0.3733 | Val  Acc: 0.9184
 Site-Painting                      | Val  Loss: 0.4384 | Val  Acc: 0.8978
 Site-Painting                      | Val  Loss: 0.4512 | Val  Acc: 0.8854
 Site-Sketch                        | Val  Loss: 0.4620 | Val  Acc: 0.8819
 Site-Sketch                        | Val  Loss: 0.5508 | Val  Acc: 0.8539
 Site-QuickDraw                     | Val  Loss: 1.6433 | Val  Acc: 0.5550
 Site-Infograph                     | Val  Loss: 1.3781 | Val  Acc: 0.5577
Average Valid Accuracy: 0.8695
 Best site-Clipart                   | Epoch:41 | Val Acc: 0.9079
 Best site-Clipart                   | Epoch:41 | Val Acc: 0.8879
 Best site-Clipart                   | Epoch:41 | Val Acc: 0.9067
 Best site-Clipart                   | Epoch:41 | Val Acc: 0.9238
 Best site-Clipart                   | Epoch:41 | Val Acc: 0.8746
 Best site-Real                      | Epoch:41 | Val Acc: 0.9524
 Best site-Real                      | Epoch:41 | Val Acc: 0.9576
 Best site-Real                      | Epoch:41 | Val Acc: 0.9818
 Best site-Real                      | Epoch:41 | Val Acc: 0.9697
 Best site-Painting                  | Epoch:41 | Val Acc: 0.9184
 Best site-Painting                  | Epoch:41 | Val Acc: 0.8978
 Best site-Painting                  | Epoch:41 | Val Acc: 0.8854
 Best site-Sketch                    | Epoch:41 | Val Acc: 0.8819
 Best site-Sketch                    | Epoch:41 | Val Acc: 0.8539
 Best site-QuickDraw                 | Epoch:41 | Val Acc: 0.5550
 Best site-Infograph                 | Epoch:41 | Val Acc: 0.5577
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 42 ============
denominator: 15301.4970703125
 Site-Clipart                       | Train Loss: 0.4840 | Train Acc: 0.9043
 Site-Clipart                       | Train Loss: 0.4161 | Train Acc: 0.9441
 Site-Clipart                       | Train Loss: 0.5822 | Train Acc: 0.8711
 Site-Clipart                       | Train Loss: 0.4876 | Train Acc: 0.9082
 Site-Clipart                       | Train Loss: 0.5279 | Train Acc: 0.8937
 Site-Real                          | Train Loss: 0.2931 | Train Acc: 0.9444
 Site-Real                          | Train Loss: 0.2050 | Train Acc: 0.9774
 Site-Real                          | Train Loss: 0.2091 | Train Acc: 0.9677
 Site-Real                          | Train Loss: 0.2939 | Train Acc: 0.9626
 Site-Painting                      | Train Loss: 0.3724 | Train Acc: 0.9116
 Site-Painting                      | Train Loss: 0.4526 | Train Acc: 0.9175
 Site-Painting                      | Train Loss: 0.4651 | Train Acc: 0.8824
 Site-Sketch                        | Train Loss: 0.5881 | Train Acc: 0.8168
 Site-Sketch                        | Train Loss: 0.5182 | Train Acc: 0.8614
 Site-QuickDraw                     | Train Loss: 1.5140 | Train Acc: 0.5596
 Site-Infograph                     | Train Loss: 1.5471 | Train Acc: 0.4957
Average Train Accuracy: 0.8637
 Site-Clipart                       | Val  Loss: 0.3344 | Val  Acc: 0.9474
 Site-Clipart                       | Val  Loss: 0.5496 | Val  Acc: 0.8972
 Site-Clipart                       | Val  Loss: 0.5086 | Val  Acc: 0.9200
 Site-Clipart                       | Val  Loss: 0.4798 | Val  Acc: 0.8952
 Site-Clipart                       | Val  Loss: 0.5374 | Val  Acc: 0.8915
 Site-Real                          | Val  Loss: 0.2978 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.2670 | Val  Acc: 0.9746
 Site-Real                          | Val  Loss: 0.2080 | Val  Acc: 0.9818
 Site-Real                          | Val  Loss: 0.2094 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 0.3575 | Val  Acc: 0.9286
 Site-Painting                      | Val  Loss: 0.4655 | Val  Acc: 0.8759
 Site-Painting                      | Val  Loss: 0.4358 | Val  Acc: 0.8750
 Site-Sketch                        | Val  Loss: 0.4271 | Val  Acc: 0.9134
 Site-Sketch                        | Val  Loss: 0.5827 | Val  Acc: 0.8258
 Site-QuickDraw                     | Val  Loss: 1.5685 | Val  Acc: 0.5734
 Site-Infograph                     | Val  Loss: 1.3922 | Val  Acc: 0.5321
Average Valid Accuracy: 0.8721
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.9474
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.8972
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.9200
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.8952
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.8915
 Best site-Real                      | Epoch:42 | Val Acc: 0.9524
 Best site-Real                      | Epoch:42 | Val Acc: 0.9746
 Best site-Real                      | Epoch:42 | Val Acc: 0.9818
 Best site-Real                      | Epoch:42 | Val Acc: 0.9697
 Best site-Painting                  | Epoch:42 | Val Acc: 0.9286
 Best site-Painting                  | Epoch:42 | Val Acc: 0.8759
 Best site-Painting                  | Epoch:42 | Val Acc: 0.8750
 Best site-Sketch                    | Epoch:42 | Val Acc: 0.9134
 Best site-Sketch                    | Epoch:42 | Val Acc: 0.8258
 Best site-QuickDraw                 | Epoch:42 | Val Acc: 0.5734
 Best site-Infograph                 | Epoch:42 | Val Acc: 0.5321
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 43 ============
denominator: 15125.21484375
 Site-Clipart                       | Train Loss: 0.4838 | Train Acc: 0.9130
 Site-Clipart                       | Train Loss: 0.4166 | Train Acc: 0.9379
 Site-Clipart                       | Train Loss: 0.5507 | Train Acc: 0.8889
 Site-Clipart                       | Train Loss: 0.4872 | Train Acc: 0.9051
 Site-Clipart                       | Train Loss: 0.5132 | Train Acc: 0.9050
 Site-Real                          | Train Loss: 0.2960 | Train Acc: 0.9444
 Site-Real                          | Train Loss: 0.1879 | Train Acc: 0.9774
 Site-Real                          | Train Loss: 0.2203 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.2804 | Train Acc: 0.9540
 Site-Painting                      | Train Loss: 0.4085 | Train Acc: 0.9048
 Site-Painting                      | Train Loss: 0.4866 | Train Acc: 0.8981
 Site-Painting                      | Train Loss: 0.4818 | Train Acc: 0.8858
 Site-Sketch                        | Train Loss: 0.5987 | Train Acc: 0.8429
 Site-Sketch                        | Train Loss: 0.5404 | Train Acc: 0.8801
 Site-QuickDraw                     | Train Loss: 1.5371 | Train Acc: 0.5535
 Site-Infograph                     | Train Loss: 1.5008 | Train Acc: 0.5085
Average Train Accuracy: 0.8670
 Site-Clipart                       | Val  Loss: 0.3621 | Val  Acc: 0.9211
 Site-Clipart                       | Val  Loss: 0.5050 | Val  Acc: 0.9159
 Site-Clipart                       | Val  Loss: 0.4535 | Val  Acc: 0.9133
 Site-Clipart                       | Val  Loss: 0.5000 | Val  Acc: 0.8905
 Site-Clipart                       | Val  Loss: 0.5445 | Val  Acc: 0.8814
 Site-Real                          | Val  Loss: 0.3001 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.2688 | Val  Acc: 0.9746
 Site-Real                          | Val  Loss: 0.1951 | Val  Acc: 0.9758
 Site-Real                          | Val  Loss: 0.2048 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 0.3494 | Val  Acc: 0.9592
 Site-Painting                      | Val  Loss: 0.4866 | Val  Acc: 0.8467
 Site-Painting                      | Val  Loss: 0.4505 | Val  Acc: 0.8958
 Site-Sketch                        | Val  Loss: 0.4770 | Val  Acc: 0.8976
 Site-Sketch                        | Val  Loss: 0.5551 | Val  Acc: 0.8483
 Site-QuickDraw                     | Val  Loss: 1.5508 | Val  Acc: 0.5734
 Site-Infograph                     | Val  Loss: 1.4056 | Val  Acc: 0.5577
Average Valid Accuracy: 0.8726
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.9211
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.9159
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.9133
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.8905
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.8814
 Best site-Real                      | Epoch:43 | Val Acc: 0.9405
 Best site-Real                      | Epoch:43 | Val Acc: 0.9746
 Best site-Real                      | Epoch:43 | Val Acc: 0.9758
 Best site-Real                      | Epoch:43 | Val Acc: 0.9697
 Best site-Painting                  | Epoch:43 | Val Acc: 0.9592
 Best site-Painting                  | Epoch:43 | Val Acc: 0.8467
 Best site-Painting                  | Epoch:43 | Val Acc: 0.8958
 Best site-Sketch                    | Epoch:43 | Val Acc: 0.8976
 Best site-Sketch                    | Epoch:43 | Val Acc: 0.8483
 Best site-QuickDraw                 | Epoch:43 | Val Acc: 0.5734
 Best site-Infograph                 | Epoch:43 | Val Acc: 0.5577
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 44 ============
denominator: 14990.916015625
 Site-Clipart                       | Train Loss: 0.4697 | Train Acc: 0.9130
 Site-Clipart                       | Train Loss: 0.4028 | Train Acc: 0.9441
 Site-Clipart                       | Train Loss: 0.5158 | Train Acc: 0.8933
 Site-Clipart                       | Train Loss: 0.5041 | Train Acc: 0.9019
 Site-Clipart                       | Train Loss: 0.5224 | Train Acc: 0.8937
 Site-Real                          | Train Loss: 0.2883 | Train Acc: 0.9365
 Site-Real                          | Train Loss: 0.1918 | Train Acc: 0.9774
 Site-Real                          | Train Loss: 0.1938 | Train Acc: 0.9718
 Site-Real                          | Train Loss: 0.2691 | Train Acc: 0.9655
 Site-Painting                      | Train Loss: 0.4751 | Train Acc: 0.8776
 Site-Painting                      | Train Loss: 0.3756 | Train Acc: 0.8835
 Site-Painting                      | Train Loss: 0.4838 | Train Acc: 0.8858
 Site-Sketch                        | Train Loss: 0.5898 | Train Acc: 0.8220
 Site-Sketch                        | Train Loss: 0.4740 | Train Acc: 0.8801
 Site-QuickDraw                     | Train Loss: 1.5101 | Train Acc: 0.5321
 Site-Infograph                     | Train Loss: 1.5073 | Train Acc: 0.5043
Average Train Accuracy: 0.8614
 Site-Clipart                       | Val  Loss: 0.3555 | Val  Acc: 0.9342
 Site-Clipart                       | Val  Loss: 0.5010 | Val  Acc: 0.8972
 Site-Clipart                       | Val  Loss: 0.5098 | Val  Acc: 0.9067
 Site-Clipart                       | Val  Loss: 0.4704 | Val  Acc: 0.8857
 Site-Clipart                       | Val  Loss: 0.5366 | Val  Acc: 0.8881
 Site-Real                          | Val  Loss: 0.2955 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.2613 | Val  Acc: 0.9831
 Site-Real                          | Val  Loss: 0.1916 | Val  Acc: 0.9758
 Site-Real                          | Val  Loss: 0.1970 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 0.3550 | Val  Acc: 0.9184
 Site-Painting                      | Val  Loss: 0.4447 | Val  Acc: 0.8759
 Site-Painting                      | Val  Loss: 0.4253 | Val  Acc: 0.8802
 Site-Sketch                        | Val  Loss: 0.4872 | Val  Acc: 0.8740
 Site-Sketch                        | Val  Loss: 0.5341 | Val  Acc: 0.8371
 Site-QuickDraw                     | Val  Loss: 1.5816 | Val  Acc: 0.5505
 Site-Infograph                     | Val  Loss: 1.3725 | Val  Acc: 0.5321
Average Valid Accuracy: 0.8663
============ Train epoch 45 ============
denominator: 14740.921875
 Site-Clipart                       | Train Loss: 0.4586 | Train Acc: 0.9043
 Site-Clipart                       | Train Loss: 0.4330 | Train Acc: 0.9130
 Site-Clipart                       | Train Loss: 0.5188 | Train Acc: 0.8800
 Site-Clipart                       | Train Loss: 0.5080 | Train Acc: 0.9051
 Site-Clipart                       | Train Loss: 0.5077 | Train Acc: 0.8846
 Site-Real                          | Train Loss: 0.2724 | Train Acc: 0.9603
 Site-Real                          | Train Loss: 0.1720 | Train Acc: 0.9774
 Site-Real                          | Train Loss: 0.2023 | Train Acc: 0.9758
 Site-Real                          | Train Loss: 0.2683 | Train Acc: 0.9626
 Site-Painting                      | Train Loss: 0.4388 | Train Acc: 0.9048
 Site-Painting                      | Train Loss: 0.3703 | Train Acc: 0.9272
 Site-Painting                      | Train Loss: 0.4328 | Train Acc: 0.8962
 Site-Sketch                        | Train Loss: 0.5745 | Train Acc: 0.8325
 Site-Sketch                        | Train Loss: 0.5583 | Train Acc: 0.8801
 Site-QuickDraw                     | Train Loss: 1.6091 | Train Acc: 0.5505
 Site-Infograph                     | Train Loss: 1.4810 | Train Acc: 0.5000
Average Train Accuracy: 0.8659
 Site-Clipart                       | Val  Loss: 0.3633 | Val  Acc: 0.9342
 Site-Clipart                       | Val  Loss: 0.4987 | Val  Acc: 0.8972
 Site-Clipart                       | Val  Loss: 0.4921 | Val  Acc: 0.9133
 Site-Clipart                       | Val  Loss: 0.4744 | Val  Acc: 0.8810
 Site-Clipart                       | Val  Loss: 0.5377 | Val  Acc: 0.8881
 Site-Real                          | Val  Loss: 0.3103 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.2525 | Val  Acc: 0.9831
 Site-Real                          | Val  Loss: 0.1940 | Val  Acc: 0.9576
 Site-Real                          | Val  Loss: 0.1853 | Val  Acc: 0.9654
 Site-Painting                      | Val  Loss: 0.3414 | Val  Acc: 0.9286
 Site-Painting                      | Val  Loss: 0.3702 | Val  Acc: 0.9051
 Site-Painting                      | Val  Loss: 0.4226 | Val  Acc: 0.9010
 Site-Sketch                        | Val  Loss: 0.4961 | Val  Acc: 0.8819
 Site-Sketch                        | Val  Loss: 0.5280 | Val  Acc: 0.8539
 Site-QuickDraw                     | Val  Loss: 1.5432 | Val  Acc: 0.5138
 Site-Infograph                     | Val  Loss: 1.4000 | Val  Acc: 0.5769
Average Valid Accuracy: 0.8701
============ Train epoch 46 ============
denominator: 14794.2705078125
 Site-Clipart                       | Train Loss: 0.5147 | Train Acc: 0.8870
 Site-Clipart                       | Train Loss: 0.4234 | Train Acc: 0.9255
 Site-Clipart                       | Train Loss: 0.5502 | Train Acc: 0.8800
 Site-Clipart                       | Train Loss: 0.4814 | Train Acc: 0.9019
 Site-Clipart                       | Train Loss: 0.4978 | Train Acc: 0.8982
 Site-Real                          | Train Loss: 0.2678 | Train Acc: 0.9524
 Site-Real                          | Train Loss: 0.1865 | Train Acc: 0.9831
 Site-Real                          | Train Loss: 0.1923 | Train Acc: 0.9677
 Site-Real                          | Train Loss: 0.2658 | Train Acc: 0.9626
 Site-Painting                      | Train Loss: 0.3781 | Train Acc: 0.9048
 Site-Painting                      | Train Loss: 0.4545 | Train Acc: 0.8883
 Site-Painting                      | Train Loss: 0.4398 | Train Acc: 0.8824
 Site-Sketch                        | Train Loss: 0.5929 | Train Acc: 0.8168
 Site-Sketch                        | Train Loss: 0.5390 | Train Acc: 0.8801
 Site-QuickDraw                     | Train Loss: 1.4008 | Train Acc: 0.5596
 Site-Infograph                     | Train Loss: 1.4968 | Train Acc: 0.4957
Average Train Accuracy: 0.8616
 Site-Clipart                       | Val  Loss: 0.3503 | Val  Acc: 0.9211
 Site-Clipart                       | Val  Loss: 0.4790 | Val  Acc: 0.9346
 Site-Clipart                       | Val  Loss: 0.5523 | Val  Acc: 0.9000
 Site-Clipart                       | Val  Loss: 0.4516 | Val  Acc: 0.8952
 Site-Clipart                       | Val  Loss: 0.5062 | Val  Acc: 0.8949
 Site-Real                          | Val  Loss: 0.2850 | Val  Acc: 0.9167
 Site-Real                          | Val  Loss: 0.2562 | Val  Acc: 0.9746
 Site-Real                          | Val  Loss: 0.1767 | Val  Acc: 0.9879
 Site-Real                          | Val  Loss: 0.2124 | Val  Acc: 0.9567
 Site-Painting                      | Val  Loss: 0.3500 | Val  Acc: 0.9082
 Site-Painting                      | Val  Loss: 0.4227 | Val  Acc: 0.8832
 Site-Painting                      | Val  Loss: 0.4076 | Val  Acc: 0.8958
 Site-Sketch                        | Val  Loss: 0.5409 | Val  Acc: 0.8504
 Site-Sketch                        | Val  Loss: 0.5649 | Val  Acc: 0.8427
 Site-QuickDraw                     | Val  Loss: 1.5169 | Val  Acc: 0.5596
 Site-Infograph                     | Val  Loss: 1.3719 | Val  Acc: 0.5513
Average Valid Accuracy: 0.8671
============ Train epoch 47 ============
denominator: 14601.5869140625
 Site-Clipart                       | Train Loss: 0.4573 | Train Acc: 0.9043
 Site-Clipart                       | Train Loss: 0.3981 | Train Acc: 0.9379
 Site-Clipart                       | Train Loss: 0.5102 | Train Acc: 0.8800
 Site-Clipart                       | Train Loss: 0.4819 | Train Acc: 0.9051
 Site-Clipart                       | Train Loss: 0.4967 | Train Acc: 0.8959
 Site-Real                          | Train Loss: 0.2684 | Train Acc: 0.9286
 Site-Real                          | Train Loss: 0.1811 | Train Acc: 0.9774
 Site-Real                          | Train Loss: 0.2034 | Train Acc: 0.9677
 Site-Real                          | Train Loss: 0.2706 | Train Acc: 0.9598
 Site-Painting                      | Train Loss: 0.3860 | Train Acc: 0.8980
 Site-Painting                      | Train Loss: 0.4218 | Train Acc: 0.8883
 Site-Painting                      | Train Loss: 0.4397 | Train Acc: 0.8927
 Site-Sketch                        | Train Loss: 0.5778 | Train Acc: 0.8325
 Site-Sketch                        | Train Loss: 0.4933 | Train Acc: 0.8876
 Site-QuickDraw                     | Train Loss: 1.4079 | Train Acc: 0.5688
 Site-Infograph                     | Train Loss: 1.4425 | Train Acc: 0.4915
Average Train Accuracy: 0.8635
 Site-Clipart                       | Val  Loss: 0.3427 | Val  Acc: 0.9474
 Site-Clipart                       | Val  Loss: 0.4893 | Val  Acc: 0.9065
 Site-Clipart                       | Val  Loss: 0.4555 | Val  Acc: 0.9267
 Site-Clipart                       | Val  Loss: 0.4438 | Val  Acc: 0.8905
 Site-Clipart                       | Val  Loss: 0.5293 | Val  Acc: 0.8847
 Site-Real                          | Val  Loss: 0.2841 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.2676 | Val  Acc: 0.9576
 Site-Real                          | Val  Loss: 0.1882 | Val  Acc: 0.9758
 Site-Real                          | Val  Loss: 0.1742 | Val  Acc: 0.9654
 Site-Painting                      | Val  Loss: 0.3495 | Val  Acc: 0.9388
 Site-Painting                      | Val  Loss: 0.4175 | Val  Acc: 0.8978
 Site-Painting                      | Val  Loss: 0.3892 | Val  Acc: 0.9062
 Site-Sketch                        | Val  Loss: 0.4448 | Val  Acc: 0.8976
 Site-Sketch                        | Val  Loss: 0.5301 | Val  Acc: 0.8427
 Site-QuickDraw                     | Val  Loss: 1.4781 | Val  Acc: 0.5963
 Site-Infograph                     | Val  Loss: 1.4443 | Val  Acc: 0.4872
Average Valid Accuracy: 0.8726
 Best site-Clipart                   | Epoch:47 | Val Acc: 0.9474
 Best site-Clipart                   | Epoch:47 | Val Acc: 0.9065
 Best site-Clipart                   | Epoch:47 | Val Acc: 0.9267
 Best site-Clipart                   | Epoch:47 | Val Acc: 0.8905
 Best site-Clipart                   | Epoch:47 | Val Acc: 0.8847
 Best site-Real                      | Epoch:47 | Val Acc: 0.9405
 Best site-Real                      | Epoch:47 | Val Acc: 0.9576
 Best site-Real                      | Epoch:47 | Val Acc: 0.9758
 Best site-Real                      | Epoch:47 | Val Acc: 0.9654
 Best site-Painting                  | Epoch:47 | Val Acc: 0.9388
 Best site-Painting                  | Epoch:47 | Val Acc: 0.8978
 Best site-Painting                  | Epoch:47 | Val Acc: 0.9062
 Best site-Sketch                    | Epoch:47 | Val Acc: 0.8976
 Best site-Sketch                    | Epoch:47 | Val Acc: 0.8427
 Best site-QuickDraw                 | Epoch:47 | Val Acc: 0.5963
 Best site-Infograph                 | Epoch:47 | Val Acc: 0.4872
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
============ Train epoch 48 ============
denominator: 14497.951171875
 Site-Clipart                       | Train Loss: 0.4849 | Train Acc: 0.9130
 Site-Clipart                       | Train Loss: 0.3785 | Train Acc: 0.9255
 Site-Clipart                       | Train Loss: 0.4810 | Train Acc: 0.9111
 Site-Clipart                       | Train Loss: 0.4712 | Train Acc: 0.9241
 Site-Clipart                       | Train Loss: 0.4791 | Train Acc: 0.8982
 Site-Real                          | Train Loss: 0.2656 | Train Acc: 0.9444
 Site-Real                          | Train Loss: 0.1485 | Train Acc: 0.9831
 Site-Real                          | Train Loss: 0.1816 | Train Acc: 0.9677
 Site-Real                          | Train Loss: 0.2358 | Train Acc: 0.9569
 Site-Painting                      | Train Loss: 0.4311 | Train Acc: 0.8776
 Site-Painting                      | Train Loss: 0.3645 | Train Acc: 0.8883
 Site-Painting                      | Train Loss: 0.4534 | Train Acc: 0.8858
 Site-Sketch                        | Train Loss: 0.5558 | Train Acc: 0.8063
 Site-Sketch                        | Train Loss: 0.5384 | Train Acc: 0.8427
 Site-QuickDraw                     | Train Loss: 1.4448 | Train Acc: 0.5657
 Site-Infograph                     | Train Loss: 1.4899 | Train Acc: 0.4744
Average Train Accuracy: 0.8603
 Site-Clipart                       | Val  Loss: 0.3220 | Val  Acc: 0.9211
 Site-Clipart                       | Val  Loss: 0.5166 | Val  Acc: 0.8879
 Site-Clipart                       | Val  Loss: 0.4730 | Val  Acc: 0.9267
 Site-Clipart                       | Val  Loss: 0.4435 | Val  Acc: 0.8952
 Site-Clipart                       | Val  Loss: 0.5348 | Val  Acc: 0.8644
 Site-Real                          | Val  Loss: 0.2792 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.2328 | Val  Acc: 0.9746
 Site-Real                          | Val  Loss: 0.1923 | Val  Acc: 0.9758
 Site-Real                          | Val  Loss: 0.1913 | Val  Acc: 0.9610
 Site-Painting                      | Val  Loss: 0.3432 | Val  Acc: 0.9184
 Site-Painting                      | Val  Loss: 0.4084 | Val  Acc: 0.8759
 Site-Painting                      | Val  Loss: 0.3820 | Val  Acc: 0.9062
 Site-Sketch                        | Val  Loss: 0.4180 | Val  Acc: 0.8976
 Site-Sketch                        | Val  Loss: 0.4720 | Val  Acc: 0.8427
 Site-QuickDraw                     | Val  Loss: 1.5167 | Val  Acc: 0.6009
 Site-Infograph                     | Val  Loss: 1.4396 | Val  Acc: 0.5513
Average Valid Accuracy: 0.8713
============ Train epoch 49 ============
denominator: 14473.17578125
 Site-Clipart                       | Train Loss: 0.4495 | Train Acc: 0.9217
 Site-Clipart                       | Train Loss: 0.3987 | Train Acc: 0.9627
 Site-Clipart                       | Train Loss: 0.5062 | Train Acc: 0.8889
 Site-Clipart                       | Train Loss: 0.4139 | Train Acc: 0.9272
 Site-Clipart                       | Train Loss: 0.4728 | Train Acc: 0.9050
 Site-Real                          | Train Loss: 0.2623 | Train Acc: 0.9524
 Site-Real                          | Train Loss: 0.1680 | Train Acc: 0.9774
 Site-Real                          | Train Loss: 0.1878 | Train Acc: 0.9758
 Site-Real                          | Train Loss: 0.2377 | Train Acc: 0.9684
 Site-Painting                      | Train Loss: 0.3753 | Train Acc: 0.9116
 Site-Painting                      | Train Loss: 0.3989 | Train Acc: 0.8883
 Site-Painting                      | Train Loss: 0.4415 | Train Acc: 0.9135
 Site-Sketch                        | Train Loss: 0.5734 | Train Acc: 0.8377
 Site-Sketch                        | Train Loss: 0.4555 | Train Acc: 0.8876
 Site-QuickDraw                     | Train Loss: 1.3900 | Train Acc: 0.5382
 Site-Infograph                     | Train Loss: 1.4688 | Train Acc: 0.5043
Average Train Accuracy: 0.8725
 Site-Clipart                       | Val  Loss: 0.3154 | Val  Acc: 0.9211
 Site-Clipart                       | Val  Loss: 0.4893 | Val  Acc: 0.8972
 Site-Clipart                       | Val  Loss: 0.4570 | Val  Acc: 0.9267
 Site-Clipart                       | Val  Loss: 0.4326 | Val  Acc: 0.9190
 Site-Clipart                       | Val  Loss: 0.5011 | Val  Acc: 0.8983
 Site-Real                          | Val  Loss: 0.2583 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.2416 | Val  Acc: 0.9831
 Site-Real                          | Val  Loss: 0.1467 | Val  Acc: 0.9818
 Site-Real                          | Val  Loss: 0.1746 | Val  Acc: 0.9697
 Site-Painting                      | Val  Loss: 0.3461 | Val  Acc: 0.9286
 Site-Painting                      | Val  Loss: 0.4038 | Val  Acc: 0.8905
 Site-Painting                      | Val  Loss: 0.3968 | Val  Acc: 0.9219
 Site-Sketch                        | Val  Loss: 0.4571 | Val  Acc: 0.8819
 Site-Sketch                        | Val  Loss: 0.5600 | Val  Acc: 0.8539
 Site-QuickDraw                     | Val  Loss: 1.4795 | Val  Acc: 0.5826
 Site-Infograph                     | Val  Loss: 1.3579 | Val  Acc: 0.5705
Average Valid Accuracy: 0.8799
 Best site-Clipart                   | Epoch:49 | Val Acc: 0.9211
 Best site-Clipart                   | Epoch:49 | Val Acc: 0.8972
 Best site-Clipart                   | Epoch:49 | Val Acc: 0.9267
 Best site-Clipart                   | Epoch:49 | Val Acc: 0.9190
 Best site-Clipart                   | Epoch:49 | Val Acc: 0.8983
 Best site-Real                      | Epoch:49 | Val Acc: 0.9524
 Best site-Real                      | Epoch:49 | Val Acc: 0.9831
 Best site-Real                      | Epoch:49 | Val Acc: 0.9818
 Best site-Real                      | Epoch:49 | Val Acc: 0.9697
 Best site-Painting                  | Epoch:49 | Val Acc: 0.9286
 Best site-Painting                  | Epoch:49 | Val Acc: 0.8905
 Best site-Painting                  | Epoch:49 | Val Acc: 0.9219
 Best site-Sketch                    | Epoch:49 | Val Acc: 0.8819
 Best site-Sketch                    | Epoch:49 | Val Acc: 0.8539
 Best site-QuickDraw                 | Epoch:49 | Val Acc: 0.5826
 Best site-Infograph                 | Epoch:49 | Val Acc: 0.5705
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/q-ffl...
===2023-07-28 12:58:23===
===2023-07-28 12:58:42===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   | Epoch:49 | Test Acc: 0.9335
 Test site-Real                      | Epoch:49 | Test Acc: 0.9663
 Test site-Painting                  | Epoch:49 | Test Acc: 0.9273
 Test site-Sketch                    | Epoch:49 | Test Acc: 0.8827
 Test site-QuickDraw                 | Epoch:49 | Test Acc: 0.6450
 Test site-Infograph                 | Epoch:49 | Test Acc: 0.5510
Clipart: 0.9335, Real: 0.9663, Painting: 0.9273, Sketch: 0.8827, QuickDraw: 0.6450, Infograph: 0.5510, 
Average Test Accuracy(group): 0.8176, Average Test Accuracy(individual): 0.8922,
domain std=0.1595, cluster std=-1.0000, individual std=0.1151, 
