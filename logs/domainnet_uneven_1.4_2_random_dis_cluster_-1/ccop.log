===2023-07-28 22:47:27===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 2, 3, 1, ]
cnt=[4, 1, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1816 | Train Acc: 0.3043
 Site-Clipart                   (1) | Train Loss: 2.1749 | Train Acc: 0.2174
 Site-Clipart                   (1) | Train Loss: 2.1658 | Train Acc: 0.2356
 Site-Clipart                   (1) | Train Loss: 2.1499 | Train Acc: 0.2690
 Site-Clipart                   (1) | Train Loss: 2.1532 | Train Acc: 0.2466
 Site-Real                      (0) | Train Loss: 2.1205 | Train Acc: 0.2778
 Site-Real                      (0) | Train Loss: 2.1129 | Train Acc: 0.2825
 Site-Real                      (0) | Train Loss: 2.0897 | Train Acc: 0.3105
 Site-Real                      (0) | Train Loss: 2.1136 | Train Acc: 0.2989
 Site-Painting                  (4) | Train Loss: 2.1520 | Train Acc: 0.2721
 Site-Painting                  (4) | Train Loss: 2.1987 | Train Acc: 0.2136
 Site-Painting                  (4) | Train Loss: 2.1802 | Train Acc: 0.2284
 Site-Sketch                    (3) | Train Loss: 2.1604 | Train Acc: 0.2775
 Site-Sketch                    (3) | Train Loss: 2.1966 | Train Acc: 0.2434
 Site-QuickDraw                 (2) | Train Loss: 2.3366 | Train Acc: 0.1713
 Site-Infograph                 (5) | Train Loss: 2.3198 | Train Acc: 0.1282
Average Train Accuracy: 0.2486
 Site-Clipart                   (1) | Val  Loss: 2.0802 | Val  Acc: 0.3421
 Site-Clipart                   (1) | Val  Loss: 2.1655 | Val  Acc: 0.2617
 Site-Clipart                   (1) | Val  Loss: 2.1509 | Val  Acc: 0.2467
 Site-Clipart                   (1) | Val  Loss: 2.1366 | Val  Acc: 0.2667
 Site-Clipart                   (1) | Val  Loss: 2.1504 | Val  Acc: 0.2475
 Site-Real                      (0) | Val  Loss: 2.1377 | Val  Acc: 0.2143
 Site-Real                      (0) | Val  Loss: 2.1779 | Val  Acc: 0.1949
 Site-Real                      (0) | Val  Loss: 2.1004 | Val  Acc: 0.3091
 Site-Real                      (0) | Val  Loss: 2.0973 | Val  Acc: 0.3030
 Site-Painting                  (4) | Val  Loss: 2.1490 | Val  Acc: 0.2245
 Site-Painting                  (4) | Val  Loss: 2.1506 | Val  Acc: 0.1898
 Site-Painting                  (4) | Val  Loss: 2.2268 | Val  Acc: 0.1771
 Site-Sketch                    (3) | Val  Loss: 2.2025 | Val  Acc: 0.1890
 Site-Sketch                    (3) | Val  Loss: 2.1732 | Val  Acc: 0.2584
 Site-QuickDraw                 (2) | Val  Loss: 2.3252 | Val  Acc: 0.1651
 Site-Infograph                 (5) | Val  Loss: 2.3016 | Val  Acc: 0.1474
Average Valid Accuracy: 0.2336
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3421
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2617
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2467
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2667
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2475
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.2143
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.1949
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3091
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3030
 Best site-Painting                 (4)  | Epoch:0 | Val Acc: 0.2245
 Best site-Painting                 (4)  | Epoch:0 | Val Acc: 0.1898
 Best site-Painting                 (4)  | Epoch:0 | Val Acc: 0.1771
 Best site-Sketch                   (3)  | Epoch:0 | Val Acc: 0.1890
 Best site-Sketch                   (3)  | Epoch:0 | Val Acc: 0.2584
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1651
 Best site-Infograph                (5)  | Epoch:0 | Val Acc: 0.1474
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 1 ============
cnt=[5, 1, 3, 4, 1, 2, ]
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 2.0062 | Train Acc: 0.4174
 Site-Clipart                   (0) | Train Loss: 1.9349 | Train Acc: 0.4348
 Site-Clipart                   (0) | Train Loss: 1.9781 | Train Acc: 0.4000
 Site-Clipart                   (0) | Train Loss: 1.9188 | Train Acc: 0.4494
 Site-Clipart                   (0) | Train Loss: 1.9547 | Train Acc: 0.4231
 Site-Real                      (3) | Train Loss: 1.8356 | Train Acc: 0.5873
 Site-Real                      (3) | Train Loss: 1.7921 | Train Acc: 0.6836
 Site-Real                      (3) | Train Loss: 1.8074 | Train Acc: 0.6129
 Site-Real                      (3) | Train Loss: 1.8934 | Train Acc: 0.5431
 Site-Painting                  (2) | Train Loss: 1.9325 | Train Acc: 0.4422
 Site-Painting                  (2) | Train Loss: 1.9304 | Train Acc: 0.4709
 Site-Painting                  (2) | Train Loss: 1.9105 | Train Acc: 0.4844
 Site-Sketch                    (5) | Train Loss: 1.9903 | Train Acc: 0.4084
 Site-Sketch                    (5) | Train Loss: 1.9642 | Train Acc: 0.3970
 Site-QuickDraw                 (1) | Train Loss: 2.2419 | Train Acc: 0.1407
 Site-Infograph                 (4) | Train Loss: 2.2385 | Train Acc: 0.2051
Average Train Accuracy: 0.4438
 Site-Clipart                   (0) | Val  Loss: 1.8928 | Val  Acc: 0.4474
 Site-Clipart                   (0) | Val  Loss: 1.9368 | Val  Acc: 0.4766
 Site-Clipart                   (0) | Val  Loss: 1.9497 | Val  Acc: 0.4267
 Site-Clipart                   (0) | Val  Loss: 1.8909 | Val  Acc: 0.4952
 Site-Clipart                   (0) | Val  Loss: 1.9603 | Val  Acc: 0.3966
 Site-Real                      (3) | Val  Loss: 1.8739 | Val  Acc: 0.5000
 Site-Real                      (3) | Val  Loss: 1.9178 | Val  Acc: 0.5085
 Site-Real                      (3) | Val  Loss: 1.8192 | Val  Acc: 0.6061
 Site-Real                      (3) | Val  Loss: 1.8012 | Val  Acc: 0.6234
 Site-Painting                  (2) | Val  Loss: 1.8645 | Val  Acc: 0.5306
 Site-Painting                  (2) | Val  Loss: 1.8860 | Val  Acc: 0.4672
 Site-Painting                  (2) | Val  Loss: 1.9813 | Val  Acc: 0.4583
 Site-Sketch                    (5) | Val  Loss: 1.9823 | Val  Acc: 0.3780
 Site-Sketch                    (5) | Val  Loss: 1.9724 | Val  Acc: 0.4045
 Site-QuickDraw                 (1) | Val  Loss: 2.2807 | Val  Acc: 0.1514
 Site-Infograph                 (4) | Val  Loss: 2.1886 | Val  Acc: 0.2179
Average Valid Accuracy: 0.4430
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4474
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4766
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4267
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4952
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.3966
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 0.5000
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 0.5085
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 0.6061
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 0.6234
 Best site-Painting                 (2)  | Epoch:1 | Val Acc: 0.5306
 Best site-Painting                 (2)  | Epoch:1 | Val Acc: 0.4672
 Best site-Painting                 (2)  | Epoch:1 | Val Acc: 0.4583
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.3780
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4045
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.1514
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.2179
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 2 ============
cnt=[3, 1, 5, 4, 2, 1, ]
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (2) | Train Loss: 1.7592 | Train Acc: 0.5217
 Site-Clipart                   (2) | Train Loss: 1.7256 | Train Acc: 0.5466
 Site-Clipart                   (2) | Train Loss: 1.7692 | Train Acc: 0.5378
 Site-Clipart                   (2) | Train Loss: 1.7332 | Train Acc: 0.5475
 Site-Clipart                   (2) | Train Loss: 1.7397 | Train Acc: 0.5430
 Site-Real                      (3) | Train Loss: 1.5336 | Train Acc: 0.7063
 Site-Real                      (3) | Train Loss: 1.4730 | Train Acc: 0.7797
 Site-Real                      (3) | Train Loss: 1.4846 | Train Acc: 0.7540
 Site-Real                      (3) | Train Loss: 1.6081 | Train Acc: 0.6983
 Site-Painting                  (0) | Train Loss: 1.6571 | Train Acc: 0.6395
 Site-Painting                  (0) | Train Loss: 1.7193 | Train Acc: 0.5485
 Site-Painting                  (0) | Train Loss: 1.6571 | Train Acc: 0.5813
 Site-Sketch                    (4) | Train Loss: 1.7949 | Train Acc: 0.4817
 Site-Sketch                    (4) | Train Loss: 1.8213 | Train Acc: 0.5019
 Site-QuickDraw                 (1) | Train Loss: 2.2061 | Train Acc: 0.2355
 Site-Infograph                 (5) | Train Loss: 2.1728 | Train Acc: 0.2821
Average Train Accuracy: 0.5566
 Site-Clipart                   (2) | Val  Loss: 1.6357 | Val  Acc: 0.4868
 Site-Clipart                   (2) | Val  Loss: 1.6806 | Val  Acc: 0.6262
 Site-Clipart                   (2) | Val  Loss: 1.7453 | Val  Acc: 0.5800
 Site-Clipart                   (2) | Val  Loss: 1.7011 | Val  Acc: 0.5952
 Site-Clipart                   (2) | Val  Loss: 1.7601 | Val  Acc: 0.5797
 Site-Real                      (3) | Val  Loss: 1.5612 | Val  Acc: 0.7143
 Site-Real                      (3) | Val  Loss: 1.5878 | Val  Acc: 0.6949
 Site-Real                      (3) | Val  Loss: 1.4999 | Val  Acc: 0.7212
 Site-Real                      (3) | Val  Loss: 1.4915 | Val  Acc: 0.7879
 Site-Painting                  (0) | Val  Loss: 1.5784 | Val  Acc: 0.5918
 Site-Painting                  (0) | Val  Loss: 1.5996 | Val  Acc: 0.6277
 Site-Painting                  (0) | Val  Loss: 1.7116 | Val  Acc: 0.5833
 Site-Sketch                    (4) | Val  Loss: 1.7877 | Val  Acc: 0.4803
 Site-Sketch                    (4) | Val  Loss: 1.7770 | Val  Acc: 0.5112
 Site-QuickDraw                 (1) | Val  Loss: 2.1907 | Val  Acc: 0.2385
 Site-Infograph                 (5) | Val  Loss: 2.0820 | Val  Acc: 0.3397
Average Valid Accuracy: 0.5724
 Best site-Clipart                  (2)  | Epoch:2 | Val Acc: 0.4868
 Best site-Clipart                  (2)  | Epoch:2 | Val Acc: 0.6262
 Best site-Clipart                  (2)  | Epoch:2 | Val Acc: 0.5800
 Best site-Clipart                  (2)  | Epoch:2 | Val Acc: 0.5952
 Best site-Clipart                  (2)  | Epoch:2 | Val Acc: 0.5797
 Best site-Real                     (3)  | Epoch:2 | Val Acc: 0.7143
 Best site-Real                     (3)  | Epoch:2 | Val Acc: 0.6949
 Best site-Real                     (3)  | Epoch:2 | Val Acc: 0.7212
 Best site-Real                     (3)  | Epoch:2 | Val Acc: 0.7879
 Best site-Painting                 (0)  | Epoch:2 | Val Acc: 0.5918
 Best site-Painting                 (0)  | Epoch:2 | Val Acc: 0.6277
 Best site-Painting                 (0)  | Epoch:2 | Val Acc: 0.5833
 Best site-Sketch                   (4)  | Epoch:2 | Val Acc: 0.4803
 Best site-Sketch                   (4)  | Epoch:2 | Val Acc: 0.5112
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.2385
 Best site-Infograph                (5)  | Epoch:2 | Val Acc: 0.3397
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 3 ============
cnt=[3, 1, 2, 4, 5, 1, ]
cnt=[3, 4, 1, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (4) | Train Loss: 1.6256 | Train Acc: 0.6087
 Site-Clipart                   (4) | Train Loss: 1.4906 | Train Acc: 0.6894
 Site-Clipart                   (4) | Train Loss: 1.5715 | Train Acc: 0.6756
 Site-Clipart                   (4) | Train Loss: 1.5086 | Train Acc: 0.6772
 Site-Clipart                   (4) | Train Loss: 1.5172 | Train Acc: 0.6900
 Site-Real                      (3) | Train Loss: 1.3210 | Train Acc: 0.8016
 Site-Real                      (3) | Train Loss: 1.2267 | Train Acc: 0.8418
 Site-Real                      (3) | Train Loss: 1.2096 | Train Acc: 0.8427
 Site-Real                      (3) | Train Loss: 1.3569 | Train Acc: 0.7787
 Site-Painting                  (0) | Train Loss: 1.4964 | Train Acc: 0.7143
 Site-Painting                  (0) | Train Loss: 1.4770 | Train Acc: 0.6650
 Site-Painting                  (0) | Train Loss: 1.4198 | Train Acc: 0.6920
 Site-Sketch                    (2) | Train Loss: 1.5829 | Train Acc: 0.6283
 Site-Sketch                    (2) | Train Loss: 1.5792 | Train Acc: 0.5730
 Site-QuickDraw                 (1) | Train Loss: 2.1472 | Train Acc: 0.2875
 Site-Infograph                 (5) | Train Loss: 2.0636 | Train Acc: 0.3376
Average Train Accuracy: 0.6565
 Site-Clipart                   (4) | Val  Loss: 1.4754 | Val  Acc: 0.6447
 Site-Clipart                   (4) | Val  Loss: 1.4929 | Val  Acc: 0.6916
 Site-Clipart                   (4) | Val  Loss: 1.5426 | Val  Acc: 0.6867
 Site-Clipart                   (4) | Val  Loss: 1.4709 | Val  Acc: 0.6667
 Site-Clipart                   (4) | Val  Loss: 1.5730 | Val  Acc: 0.6373
 Site-Real                      (3) | Val  Loss: 1.2672 | Val  Acc: 0.8452
 Site-Real                      (3) | Val  Loss: 1.3366 | Val  Acc: 0.7797
 Site-Real                      (3) | Val  Loss: 1.2245 | Val  Acc: 0.8182
 Site-Real                      (3) | Val  Loss: 1.2304 | Val  Acc: 0.8615
 Site-Painting                  (0) | Val  Loss: 1.3462 | Val  Acc: 0.7245
 Site-Painting                  (0) | Val  Loss: 1.3810 | Val  Acc: 0.7080
 Site-Painting                  (0) | Val  Loss: 1.4935 | Val  Acc: 0.6667
 Site-Sketch                    (2) | Val  Loss: 1.6203 | Val  Acc: 0.5669
 Site-Sketch                    (2) | Val  Loss: 1.5343 | Val  Acc: 0.6404
 Site-QuickDraw                 (1) | Val  Loss: 2.1234 | Val  Acc: 0.2890
 Site-Infograph                 (5) | Val  Loss: 1.9600 | Val  Acc: 0.3654
Average Valid Accuracy: 0.6620
 Best site-Clipart                  (4)  | Epoch:3 | Val Acc: 0.6447
 Best site-Clipart                  (4)  | Epoch:3 | Val Acc: 0.6916
 Best site-Clipart                  (4)  | Epoch:3 | Val Acc: 0.6867
 Best site-Clipart                  (4)  | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart                  (4)  | Epoch:3 | Val Acc: 0.6373
 Best site-Real                     (3)  | Epoch:3 | Val Acc: 0.8452
 Best site-Real                     (3)  | Epoch:3 | Val Acc: 0.7797
 Best site-Real                     (3)  | Epoch:3 | Val Acc: 0.8182
 Best site-Real                     (3)  | Epoch:3 | Val Acc: 0.8615
 Best site-Painting                 (0)  | Epoch:3 | Val Acc: 0.7245
 Best site-Painting                 (0)  | Epoch:3 | Val Acc: 0.7080
 Best site-Painting                 (0)  | Epoch:3 | Val Acc: 0.6667
 Best site-Sketch                   (2)  | Epoch:3 | Val Acc: 0.5669
 Best site-Sketch                   (2)  | Epoch:3 | Val Acc: 0.6404
 Best site-QuickDraw                (1)  | Epoch:3 | Val Acc: 0.2890
 Best site-Infograph                (5)  | Epoch:3 | Val Acc: 0.3654
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 1, 4, 2, 4, 3, ]
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (4) | Train Loss: 1.4319 | Train Acc: 0.6696
 Site-Clipart                   (4) | Train Loss: 1.2740 | Train Acc: 0.7205
 Site-Clipart                   (4) | Train Loss: 1.3546 | Train Acc: 0.7022
 Site-Clipart                   (0) | Train Loss: 1.3115 | Train Acc: 0.7563
 Site-Clipart                   (4) | Train Loss: 1.3453 | Train Acc: 0.7353
 Site-Real                      (2) | Train Loss: 1.0810 | Train Acc: 0.8651
 Site-Real                      (2) | Train Loss: 0.9991 | Train Acc: 0.8757
 Site-Real                      (2) | Train Loss: 0.9941 | Train Acc: 0.8871
 Site-Real                      (2) | Train Loss: 1.1241 | Train Acc: 0.8649
 Site-Painting                  (5) | Train Loss: 1.3312 | Train Acc: 0.7347
 Site-Painting                  (5) | Train Loss: 1.2381 | Train Acc: 0.8010
 Site-Painting                  (5) | Train Loss: 1.2381 | Train Acc: 0.7716
 Site-Sketch                    (3) | Train Loss: 1.3719 | Train Acc: 0.6963
 Site-Sketch                    (3) | Train Loss: 1.3620 | Train Acc: 0.6854
 Site-QuickDraw                 (1) | Train Loss: 2.0685 | Train Acc: 0.2997
 Site-Infograph                 (0) | Train Loss: 1.9326 | Train Acc: 0.3974
Average Train Accuracy: 0.7164
 Site-Clipart                   (4) | Val  Loss: 1.2126 | Val  Acc: 0.7763
 Site-Clipart                   (4) | Val  Loss: 1.3294 | Val  Acc: 0.7664
 Site-Clipart                   (4) | Val  Loss: 1.2997 | Val  Acc: 0.7467
 Site-Clipart                   (0) | Val  Loss: 1.2697 | Val  Acc: 0.7000
 Site-Clipart                   (4) | Val  Loss: 1.3660 | Val  Acc: 0.7153
 Site-Real                      (2) | Val  Loss: 1.0874 | Val  Acc: 0.8690
 Site-Real                      (2) | Val  Loss: 1.0623 | Val  Acc: 0.8983
 Site-Real                      (2) | Val  Loss: 1.0183 | Val  Acc: 0.8485
 Site-Real                      (2) | Val  Loss: 0.9947 | Val  Acc: 0.9004
 Site-Painting                  (5) | Val  Loss: 1.1010 | Val  Acc: 0.7857
 Site-Painting                  (5) | Val  Loss: 1.1948 | Val  Acc: 0.7372
 Site-Painting                  (5) | Val  Loss: 1.2817 | Val  Acc: 0.7396
 Site-Sketch                    (3) | Val  Loss: 1.3796 | Val  Acc: 0.6614
 Site-Sketch                    (3) | Val  Loss: 1.4021 | Val  Acc: 0.6629
 Site-QuickDraw                 (1) | Val  Loss: 2.0901 | Val  Acc: 0.2752
 Site-Infograph                 (0) | Val  Loss: 1.8672 | Val  Acc: 0.4167
Average Valid Accuracy: 0.7187
 Best site-Clipart                  (4)  | Epoch:4 | Val Acc: 0.7763
 Best site-Clipart                  (4)  | Epoch:4 | Val Acc: 0.7664
 Best site-Clipart                  (4)  | Epoch:4 | Val Acc: 0.7467
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7000
 Best site-Clipart                  (4)  | Epoch:4 | Val Acc: 0.7153
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8690
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8983
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8485
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.9004
 Best site-Painting                 (5)  | Epoch:4 | Val Acc: 0.7857
 Best site-Painting                 (5)  | Epoch:4 | Val Acc: 0.7372
 Best site-Painting                 (5)  | Epoch:4 | Val Acc: 0.7396
 Best site-Sketch                   (3)  | Epoch:4 | Val Acc: 0.6614
 Best site-Sketch                   (3)  | Epoch:4 | Val Acc: 0.6629
 Best site-QuickDraw                (1)  | Epoch:4 | Val Acc: 0.2752
 Best site-Infograph                (0)  | Epoch:4 | Val Acc: 0.4167
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 5 ============
cnt=[3, 4, 1, 3, 1, 4, ]
cnt=[1, 5, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (0) | Train Loss: 1.2762 | Train Acc: 0.6696
 Site-Clipart                   (5) | Train Loss: 1.1525 | Train Acc: 0.7888
 Site-Clipart                   (5) | Train Loss: 1.2357 | Train Acc: 0.7511
 Site-Clipart                   (0) | Train Loss: 1.1476 | Train Acc: 0.7816
 Site-Clipart                   (0) | Train Loss: 1.2007 | Train Acc: 0.7828
 Site-Real                      (1) | Train Loss: 0.9326 | Train Acc: 0.8889
 Site-Real                      (1) | Train Loss: 0.8012 | Train Acc: 0.9096
 Site-Real                      (1) | Train Loss: 0.8268 | Train Acc: 0.8992
 Site-Real                      (1) | Train Loss: 0.9297 | Train Acc: 0.8966
 Site-Painting                  (3) | Train Loss: 1.0617 | Train Acc: 0.8027
 Site-Painting                  (3) | Train Loss: 1.0792 | Train Acc: 0.7961
 Site-Painting                  (3) | Train Loss: 1.0820 | Train Acc: 0.8201
 Site-Sketch                    (5) | Train Loss: 1.2189 | Train Acc: 0.7487
 Site-Sketch                    (5) | Train Loss: 1.3364 | Train Acc: 0.6816
 Site-QuickDraw                 (2) | Train Loss: 2.0249 | Train Acc: 0.3609
 Site-Infograph                 (4) | Train Loss: 1.8391 | Train Acc: 0.4145
Average Train Accuracy: 0.7496
 Site-Clipart                   (0) | Val  Loss: 1.0504 | Val  Acc: 0.8289
 Site-Clipart                   (5) | Val  Loss: 1.1455 | Val  Acc: 0.8224
 Site-Clipart                   (5) | Val  Loss: 1.1397 | Val  Acc: 0.7800
 Site-Clipart                   (0) | Val  Loss: 1.1144 | Val  Acc: 0.7952
 Site-Clipart                   (0) | Val  Loss: 1.2420 | Val  Acc: 0.7220
 Site-Real                      (1) | Val  Loss: 0.9065 | Val  Acc: 0.8929
 Site-Real                      (1) | Val  Loss: 0.8972 | Val  Acc: 0.8983
 Site-Real                      (1) | Val  Loss: 0.8455 | Val  Acc: 0.8970
 Site-Real                      (1) | Val  Loss: 0.8623 | Val  Acc: 0.9004
 Site-Painting                  (3) | Val  Loss: 0.9726 | Val  Acc: 0.8673
 Site-Painting                  (3) | Val  Loss: 1.0598 | Val  Acc: 0.7810
 Site-Painting                  (3) | Val  Loss: 1.1185 | Val  Acc: 0.7708
 Site-Sketch                    (5) | Val  Loss: 1.2318 | Val  Acc: 0.7165
 Site-Sketch                    (5) | Val  Loss: 1.2080 | Val  Acc: 0.7528
 Site-QuickDraw                 (2) | Val  Loss: 2.0241 | Val  Acc: 0.3394
 Site-Infograph                 (4) | Val  Loss: 1.7509 | Val  Acc: 0.4487
Average Valid Accuracy: 0.7634
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.8289
 Best site-Clipart                  (5)  | Epoch:5 | Val Acc: 0.8224
 Best site-Clipart                  (5)  | Epoch:5 | Val Acc: 0.7800
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7952
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7220
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 0.8929
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 0.8983
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 0.8970
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 0.9004
 Best site-Painting                 (3)  | Epoch:5 | Val Acc: 0.8673
 Best site-Painting                 (3)  | Epoch:5 | Val Acc: 0.7810
 Best site-Painting                 (3)  | Epoch:5 | Val Acc: 0.7708
 Best site-Sketch                   (5)  | Epoch:5 | Val Acc: 0.7165
 Best site-Sketch                   (5)  | Epoch:5 | Val Acc: 0.7528
 Best site-QuickDraw                (2)  | Epoch:5 | Val Acc: 0.3394
 Best site-Infograph                (4)  | Epoch:5 | Val Acc: 0.4487
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 6 ============
cnt=[4, 4, 1, 1, 3, 3, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (5) | Train Loss: 1.1452 | Train Acc: 0.7304
 Site-Clipart                   (5) | Train Loss: 1.0466 | Train Acc: 0.8261
 Site-Clipart                   (1) | Train Loss: 1.0984 | Train Acc: 0.7911
 Site-Clipart                   (5) | Train Loss: 1.0386 | Train Acc: 0.8133
 Site-Clipart                   (1) | Train Loss: 1.0561 | Train Acc: 0.8100
 Site-Real                      (0) | Train Loss: 0.8139 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.7322 | Train Acc: 0.8983
 Site-Real                      (0) | Train Loss: 0.7202 | Train Acc: 0.9153
 Site-Real                      (0) | Train Loss: 0.8110 | Train Acc: 0.9080
 Site-Painting                  (4) | Train Loss: 0.9232 | Train Acc: 0.8571
 Site-Painting                  (4) | Train Loss: 1.1118 | Train Acc: 0.8010
 Site-Painting                  (4) | Train Loss: 0.9789 | Train Acc: 0.8304
 Site-Sketch                    (1) | Train Loss: 1.1105 | Train Acc: 0.7539
 Site-Sketch                    (1) | Train Loss: 1.1929 | Train Acc: 0.6966
 Site-QuickDraw                 (2) | Train Loss: 1.8994 | Train Acc: 0.2997
 Site-Infograph                 (3) | Train Loss: 1.8172 | Train Acc: 0.4359
Average Train Accuracy: 0.7670
 Site-Clipart                   (5) | Val  Loss: 0.9312 | Val  Acc: 0.8421
 Site-Clipart                   (5) | Val  Loss: 1.0038 | Val  Acc: 0.8131
 Site-Clipart                   (1) | Val  Loss: 1.0169 | Val  Acc: 0.8267
 Site-Clipart                   (5) | Val  Loss: 1.0068 | Val  Acc: 0.7714
 Site-Clipart                   (1) | Val  Loss: 1.1036 | Val  Acc: 0.7661
 Site-Real                      (0) | Val  Loss: 0.7678 | Val  Acc: 0.8810
 Site-Real                      (0) | Val  Loss: 0.7878 | Val  Acc: 0.9068
 Site-Real                      (0) | Val  Loss: 0.7777 | Val  Acc: 0.8727
 Site-Real                      (0) | Val  Loss: 0.7225 | Val  Acc: 0.9221
 Site-Painting                  (4) | Val  Loss: 0.8593 | Val  Acc: 0.8571
 Site-Painting                  (4) | Val  Loss: 0.9682 | Val  Acc: 0.8321
 Site-Painting                  (4) | Val  Loss: 1.0049 | Val  Acc: 0.8229
 Site-Sketch                    (1) | Val  Loss: 1.0898 | Val  Acc: 0.7323
 Site-Sketch                    (1) | Val  Loss: 1.1837 | Val  Acc: 0.6629
 Site-QuickDraw                 (2) | Val  Loss: 1.9152 | Val  Acc: 0.3440
 Site-Infograph                 (3) | Val  Loss: 1.6731 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7713
 Best site-Clipart                  (5)  | Epoch:6 | Val Acc: 0.8421
 Best site-Clipart                  (5)  | Epoch:6 | Val Acc: 0.8131
 Best site-Clipart                  (1)  | Epoch:6 | Val Acc: 0.8267
 Best site-Clipart                  (5)  | Epoch:6 | Val Acc: 0.7714
 Best site-Clipart                  (1)  | Epoch:6 | Val Acc: 0.7661
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8810
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.9068
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8727
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.9221
 Best site-Painting                 (4)  | Epoch:6 | Val Acc: 0.8571
 Best site-Painting                 (4)  | Epoch:6 | Val Acc: 0.8321
 Best site-Painting                 (4)  | Epoch:6 | Val Acc: 0.8229
 Best site-Sketch                   (1)  | Epoch:6 | Val Acc: 0.7323
 Best site-Sketch                   (1)  | Epoch:6 | Val Acc: 0.6629
 Best site-QuickDraw                (2)  | Epoch:6 | Val Acc: 0.3440
 Best site-Infograph                (3)  | Epoch:6 | Val Acc: 0.4872
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 4, 1, 3, 3, 3, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (3) | Train Loss: 1.0428 | Train Acc: 0.6957
 Site-Clipart                   (5) | Train Loss: 0.8785 | Train Acc: 0.8882
 Site-Clipart                   (5) | Train Loss: 0.9937 | Train Acc: 0.8044
 Site-Clipart                   (3) | Train Loss: 0.9312 | Train Acc: 0.8038
 Site-Clipart                   (5) | Train Loss: 0.9564 | Train Acc: 0.8122
 Site-Real                      (1) | Train Loss: 0.7270 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.6109 | Train Acc: 0.9435
 Site-Real                      (1) | Train Loss: 0.6287 | Train Acc: 0.9194
 Site-Real                      (1) | Train Loss: 0.7160 | Train Acc: 0.9080
 Site-Painting                  (4) | Train Loss: 0.9382 | Train Acc: 0.8435
 Site-Painting                  (4) | Train Loss: 0.8843 | Train Acc: 0.8350
 Site-Painting                  (4) | Train Loss: 0.8378 | Train Acc: 0.8651
 Site-Sketch                    (0) | Train Loss: 0.9608 | Train Acc: 0.7958
 Site-Sketch                    (0) | Train Loss: 0.9842 | Train Acc: 0.7416
 Site-QuickDraw                 (2) | Train Loss: 1.8801 | Train Acc: 0.3976
 Site-Infograph                 (3) | Train Loss: 1.6893 | Train Acc: 0.5043
Average Train Accuracy: 0.7914
 Site-Clipart                   (3) | Val  Loss: 0.7721 | Val  Acc: 0.8421
 Site-Clipart                   (5) | Val  Loss: 0.8600 | Val  Acc: 0.8318
 Site-Clipart                   (5) | Val  Loss: 0.9251 | Val  Acc: 0.8000
 Site-Clipart                   (3) | Val  Loss: 0.9061 | Val  Acc: 0.7905
 Site-Clipart                   (5) | Val  Loss: 0.9792 | Val  Acc: 0.8000
 Site-Real                      (1) | Val  Loss: 0.6618 | Val  Acc: 0.9048
 Site-Real                      (1) | Val  Loss: 0.6774 | Val  Acc: 0.9068
 Site-Real                      (1) | Val  Loss: 0.6889 | Val  Acc: 0.8848
 Site-Real                      (1) | Val  Loss: 0.6272 | Val  Acc: 0.9264
 Site-Painting                  (4) | Val  Loss: 0.7145 | Val  Acc: 0.8980
 Site-Painting                  (4) | Val  Loss: 0.8285 | Val  Acc: 0.8102
 Site-Painting                  (4) | Val  Loss: 0.8973 | Val  Acc: 0.8281
 Site-Sketch                    (0) | Val  Loss: 1.0060 | Val  Acc: 0.7165
 Site-Sketch                    (0) | Val  Loss: 0.9806 | Val  Acc: 0.7247
 Site-QuickDraw                 (2) | Val  Loss: 1.8316 | Val  Acc: 0.4174
 Site-Infograph                 (3) | Val  Loss: 1.5843 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7880
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.8421
 Best site-Clipart                  (5)  | Epoch:7 | Val Acc: 0.8318
 Best site-Clipart                  (5)  | Epoch:7 | Val Acc: 0.8000
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.7905
 Best site-Clipart                  (5)  | Epoch:7 | Val Acc: 0.8000
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9048
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9068
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.8848
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9264
 Best site-Painting                 (4)  | Epoch:7 | Val Acc: 0.8980
 Best site-Painting                 (4)  | Epoch:7 | Val Acc: 0.8102
 Best site-Painting                 (4)  | Epoch:7 | Val Acc: 0.8281
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.7165
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.7247
 Best site-QuickDraw                (2)  | Epoch:7 | Val Acc: 0.4174
 Best site-Infograph                (3)  | Epoch:7 | Val Acc: 0.5256
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 5, 1, 3, 3, 2, ]
cnt=[1, 5, 1, 4, 2, 3, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (1) | Train Loss: 0.8860 | Train Acc: 0.7826
 Site-Clipart                   (1) | Train Loss: 0.8007 | Train Acc: 0.8634
 Site-Clipart                   (1) | Train Loss: 0.8254 | Train Acc: 0.8311
 Site-Clipart                   (4) | Train Loss: 0.8276 | Train Acc: 0.8165
 Site-Clipart                   (4) | Train Loss: 0.8652 | Train Acc: 0.8281
 Site-Real                      (0) | Train Loss: 0.6347 | Train Acc: 0.8968
 Site-Real                      (0) | Train Loss: 0.5372 | Train Acc: 0.9379
 Site-Real                      (5) | Train Loss: 0.5601 | Train Acc: 0.9315
 Site-Real                      (5) | Train Loss: 0.6365 | Train Acc: 0.9253
 Site-Painting                  (3) | Train Loss: 0.8834 | Train Acc: 0.8299
 Site-Painting                  (3) | Train Loss: 0.7826 | Train Acc: 0.8544
 Site-Painting                  (3) | Train Loss: 0.7627 | Train Acc: 0.8374
 Site-Sketch                    (1) | Train Loss: 0.8284 | Train Acc: 0.8325
 Site-Sketch                    (1) | Train Loss: 0.8645 | Train Acc: 0.7640
 Site-QuickDraw                 (2) | Train Loss: 1.7532 | Train Acc: 0.4893
 Site-Infograph                 (4) | Train Loss: 1.6175 | Train Acc: 0.5128
Average Train Accuracy: 0.8083
 Site-Clipart                   (1) | Val  Loss: 0.7090 | Val  Acc: 0.8158
 Site-Clipart                   (1) | Val  Loss: 0.8007 | Val  Acc: 0.8411
 Site-Clipart                   (1) | Val  Loss: 0.8058 | Val  Acc: 0.8267
 Site-Clipart                   (4) | Val  Loss: 0.7836 | Val  Acc: 0.8190
 Site-Clipart                   (4) | Val  Loss: 0.9112 | Val  Acc: 0.7898
 Site-Real                      (0) | Val  Loss: 0.5853 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.5997 | Val  Acc: 0.8983
 Site-Real                      (5) | Val  Loss: 0.5816 | Val  Acc: 0.9273
 Site-Real                      (5) | Val  Loss: 0.5709 | Val  Acc: 0.9437
 Site-Painting                  (3) | Val  Loss: 0.6158 | Val  Acc: 0.8980
 Site-Painting                  (3) | Val  Loss: 0.7562 | Val  Acc: 0.8248
 Site-Painting                  (3) | Val  Loss: 0.7808 | Val  Acc: 0.8490
 Site-Sketch                    (1) | Val  Loss: 0.9227 | Val  Acc: 0.7480
 Site-Sketch                    (1) | Val  Loss: 0.9202 | Val  Acc: 0.7528
 Site-QuickDraw                 (2) | Val  Loss: 1.7659 | Val  Acc: 0.4266
 Site-Infograph                 (4) | Val  Loss: 1.4792 | Val  Acc: 0.5705
Average Valid Accuracy: 0.8045
 Best site-Clipart                  (1)  | Epoch:8 | Val Acc: 0.8158
 Best site-Clipart                  (1)  | Epoch:8 | Val Acc: 0.8411
 Best site-Clipart                  (1)  | Epoch:8 | Val Acc: 0.8267
 Best site-Clipart                  (4)  | Epoch:8 | Val Acc: 0.8190
 Best site-Clipart                  (4)  | Epoch:8 | Val Acc: 0.7898
 Best site-Real                     (0)  | Epoch:8 | Val Acc: 0.9405
 Best site-Real                     (0)  | Epoch:8 | Val Acc: 0.8983
 Best site-Real                     (5)  | Epoch:8 | Val Acc: 0.9273
 Best site-Real                     (5)  | Epoch:8 | Val Acc: 0.9437
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8980
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8248
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8490
 Best site-Sketch                   (1)  | Epoch:8 | Val Acc: 0.7480
 Best site-Sketch                   (1)  | Epoch:8 | Val Acc: 0.7528
 Best site-QuickDraw                (2)  | Epoch:8 | Val Acc: 0.4266
 Best site-Infograph                (4)  | Epoch:8 | Val Acc: 0.5705
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 9 ============
cnt=[4, 4, 1, 4, 1, 2, ]
cnt=[4, 5, 1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (3) | Train Loss: 0.7876 | Train Acc: 0.8348
 Site-Clipart                   (0) | Train Loss: 0.6888 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.8188 | Train Acc: 0.8400
 Site-Clipart                   (3) | Train Loss: 0.7398 | Train Acc: 0.8354
 Site-Clipart                   (3) | Train Loss: 0.7697 | Train Acc: 0.8122
 Site-Real                      (4) | Train Loss: 0.5833 | Train Acc: 0.9206
 Site-Real                      (1) | Train Loss: 0.4663 | Train Acc: 0.9435
 Site-Real                      (1) | Train Loss: 0.5103 | Train Acc: 0.9274
 Site-Real                      (1) | Train Loss: 0.5850 | Train Acc: 0.9310
 Site-Painting                  (5) | Train Loss: 0.8020 | Train Acc: 0.8367
 Site-Painting                  (5) | Train Loss: 0.6776 | Train Acc: 0.8641
 Site-Painting                  (1) | Train Loss: 0.6983 | Train Acc: 0.8512
 Site-Sketch                    (0) | Train Loss: 0.7904 | Train Acc: 0.8220
 Site-Sketch                    (0) | Train Loss: 0.8369 | Train Acc: 0.7678
 Site-QuickDraw                 (2) | Train Loss: 1.6770 | Train Acc: 0.5107
 Site-Infograph                 (3) | Train Loss: 1.5214 | Train Acc: 0.5598
Average Train Accuracy: 0.8204
 Site-Clipart                   (3) | Val  Loss: 0.6044 | Val  Acc: 0.8947
 Site-Clipart                   (0) | Val  Loss: 0.7410 | Val  Acc: 0.8411
 Site-Clipart                   (0) | Val  Loss: 0.7338 | Val  Acc: 0.8600
 Site-Clipart                   (3) | Val  Loss: 0.7309 | Val  Acc: 0.8333
 Site-Clipart                   (3) | Val  Loss: 0.8116 | Val  Acc: 0.8169
 Site-Real                      (4) | Val  Loss: 0.5394 | Val  Acc: 0.9048
 Site-Real                      (1) | Val  Loss: 0.5217 | Val  Acc: 0.9237
 Site-Real                      (1) | Val  Loss: 0.5146 | Val  Acc: 0.9212
 Site-Real                      (1) | Val  Loss: 0.5066 | Val  Acc: 0.9481
 Site-Painting                  (5) | Val  Loss: 0.5864 | Val  Acc: 0.8980
 Site-Painting                  (5) | Val  Loss: 0.6562 | Val  Acc: 0.8832
 Site-Painting                  (1) | Val  Loss: 0.7017 | Val  Acc: 0.8542
 Site-Sketch                    (0) | Val  Loss: 0.8063 | Val  Acc: 0.7795
 Site-Sketch                    (0) | Val  Loss: 0.8387 | Val  Acc: 0.7528
 Site-QuickDraw                 (2) | Val  Loss: 1.6384 | Val  Acc: 0.5321
 Site-Infograph                 (3) | Val  Loss: 1.4345 | Val  Acc: 0.5833
Average Valid Accuracy: 0.8267
 Best site-Clipart                  (3)  | Epoch:9 | Val Acc: 0.8947
 Best site-Clipart                  (0)  | Epoch:9 | Val Acc: 0.8411
 Best site-Clipart                  (0)  | Epoch:9 | Val Acc: 0.8600
 Best site-Clipart                  (3)  | Epoch:9 | Val Acc: 0.8333
 Best site-Clipart                  (3)  | Epoch:9 | Val Acc: 0.8169
 Best site-Real                     (4)  | Epoch:9 | Val Acc: 0.9048
 Best site-Real                     (1)  | Epoch:9 | Val Acc: 0.9237
 Best site-Real                     (1)  | Epoch:9 | Val Acc: 0.9212
 Best site-Real                     (1)  | Epoch:9 | Val Acc: 0.9481
 Best site-Painting                 (5)  | Epoch:9 | Val Acc: 0.8980
 Best site-Painting                 (5)  | Epoch:9 | Val Acc: 0.8832
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.8542
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.7795
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.7528
 Best site-QuickDraw                (2)  | Epoch:9 | Val Acc: 0.5321
 Best site-Infograph                (3)  | Epoch:9 | Val Acc: 0.5833
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 10 ============
cnt=[4, 3, 1, 2, 4, 2, ]
cnt=[3, 5, 4, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (4) | Train Loss: 0.7316 | Train Acc: 0.8348
 Site-Clipart                   (0) | Train Loss: 0.6048 | Train Acc: 0.8882
 Site-Clipart                   (0) | Train Loss: 0.6934 | Train Acc: 0.8622
 Site-Clipart                   (4) | Train Loss: 0.6748 | Train Acc: 0.8481
 Site-Clipart                   (4) | Train Loss: 0.7216 | Train Acc: 0.8552
 Site-Real                      (1) | Train Loss: 0.5306 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.4380 | Train Acc: 0.9548
 Site-Real                      (1) | Train Loss: 0.4765 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.5235 | Train Acc: 0.9195
 Site-Painting                  (5) | Train Loss: 0.7396 | Train Acc: 0.8299
 Site-Painting                  (5) | Train Loss: 0.7490 | Train Acc: 0.8592
 Site-Painting                  (3) | Train Loss: 0.6398 | Train Acc: 0.8616
 Site-Sketch                    (0) | Train Loss: 0.7389 | Train Acc: 0.8220
 Site-Sketch                    (0) | Train Loss: 0.7309 | Train Acc: 0.7865
 Site-QuickDraw                 (2) | Train Loss: 1.5196 | Train Acc: 0.5474
 Site-Infograph                 (4) | Train Loss: 1.5192 | Train Acc: 0.5299
Average Train Accuracy: 0.8285
 Site-Clipart                   (4) | Val  Loss: 0.5677 | Val  Acc: 0.9211
 Site-Clipart                   (0) | Val  Loss: 0.6754 | Val  Acc: 0.8505
 Site-Clipart                   (0) | Val  Loss: 0.6877 | Val  Acc: 0.8333
 Site-Clipart                   (4) | Val  Loss: 0.6905 | Val  Acc: 0.8095
 Site-Clipart                   (4) | Val  Loss: 0.7864 | Val  Acc: 0.7831
 Site-Real                      (1) | Val  Loss: 0.4761 | Val  Acc: 0.9167
 Site-Real                      (1) | Val  Loss: 0.4728 | Val  Acc: 0.9322
 Site-Real                      (1) | Val  Loss: 0.4682 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.4792 | Val  Acc: 0.9481
 Site-Painting                  (5) | Val  Loss: 0.5625 | Val  Acc: 0.8878
 Site-Painting                  (5) | Val  Loss: 0.6344 | Val  Acc: 0.8759
 Site-Painting                  (3) | Val  Loss: 0.6958 | Val  Acc: 0.8229
 Site-Sketch                    (0) | Val  Loss: 0.8066 | Val  Acc: 0.7717
 Site-Sketch                    (0) | Val  Loss: 0.7938 | Val  Acc: 0.7865
 Site-QuickDraw                 (2) | Val  Loss: 1.5594 | Val  Acc: 0.5688
 Site-Infograph                 (4) | Val  Loss: 1.3959 | Val  Acc: 0.5962
Average Valid Accuracy: 0.8273
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.9211
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8505
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8333
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8095
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.7831
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9167
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9322
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9333
 Best site-Real                     (3)  | Epoch:10 | Val Acc: 0.9481
 Best site-Painting                 (5)  | Epoch:10 | Val Acc: 0.8878
 Best site-Painting                 (5)  | Epoch:10 | Val Acc: 0.8759
 Best site-Painting                 (3)  | Epoch:10 | Val Acc: 0.8229
 Best site-Sketch                   (0)  | Epoch:10 | Val Acc: 0.7717
 Best site-Sketch                   (0)  | Epoch:10 | Val Acc: 0.7865
 Best site-QuickDraw                (2)  | Epoch:10 | Val Acc: 0.5688
 Best site-Infograph                (4)  | Epoch:10 | Val Acc: 0.5962
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 11 ============
cnt=[4, 1, 2, 4, 3, 2, ]
cnt=[3, 1, 5, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (0) | Train Loss: 0.7079 | Train Acc: 0.7913
 Site-Clipart                   (3) | Train Loss: 0.5752 | Train Acc: 0.8882
 Site-Clipart                   (0) | Train Loss: 0.6976 | Train Acc: 0.8311
 Site-Clipart                   (3) | Train Loss: 0.6682 | Train Acc: 0.8354
 Site-Clipart                   (3) | Train Loss: 0.6747 | Train Acc: 0.8416
 Site-Real                      (5) | Train Loss: 0.5153 | Train Acc: 0.9048
 Site-Real                      (5) | Train Loss: 0.4154 | Train Acc: 0.9661
 Site-Real                      (2) | Train Loss: 0.4270 | Train Acc: 0.9355
 Site-Real                      (2) | Train Loss: 0.4890 | Train Acc: 0.9368
 Site-Painting                  (4) | Train Loss: 0.6339 | Train Acc: 0.8639
 Site-Painting                  (4) | Train Loss: 0.6072 | Train Acc: 0.8641
 Site-Painting                  (4) | Train Loss: 0.6055 | Train Acc: 0.8685
 Site-Sketch                    (0) | Train Loss: 0.7058 | Train Acc: 0.8168
 Site-Sketch                    (0) | Train Loss: 0.7714 | Train Acc: 0.7865
 Site-QuickDraw                 (1) | Train Loss: 1.4302 | Train Acc: 0.6300
 Site-Infograph                 (3) | Train Loss: 1.4932 | Train Acc: 0.5470
Average Train Accuracy: 0.8317
 Site-Clipart                   (0) | Val  Loss: 0.5045 | Val  Acc: 0.8553
 Site-Clipart                   (3) | Val  Loss: 0.6349 | Val  Acc: 0.8598
 Site-Clipart                   (0) | Val  Loss: 0.6397 | Val  Acc: 0.8467
 Site-Clipart                   (3) | Val  Loss: 0.6454 | Val  Acc: 0.8190
 Site-Clipart                   (3) | Val  Loss: 0.7304 | Val  Acc: 0.8000
 Site-Real                      (5) | Val  Loss: 0.4404 | Val  Acc: 0.9167
 Site-Real                      (5) | Val  Loss: 0.4365 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.4376 | Val  Acc: 0.9515
 Site-Real                      (2) | Val  Loss: 0.4182 | Val  Acc: 0.9610
 Site-Painting                  (4) | Val  Loss: 0.5184 | Val  Acc: 0.9082
 Site-Painting                  (4) | Val  Loss: 0.6205 | Val  Acc: 0.8394
 Site-Painting                  (4) | Val  Loss: 0.6316 | Val  Acc: 0.8646
 Site-Sketch                    (0) | Val  Loss: 0.7229 | Val  Acc: 0.8031
 Site-Sketch                    (0) | Val  Loss: 0.7281 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 1.4614 | Val  Acc: 0.5872
 Site-Infograph                 (3) | Val  Loss: 1.3582 | Val  Acc: 0.5962
Average Valid Accuracy: 0.8340
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8553
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8598
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8467
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8190
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8000
 Best site-Real                     (5)  | Epoch:11 | Val Acc: 0.9167
 Best site-Real                     (5)  | Epoch:11 | Val Acc: 0.9322
 Best site-Real                     (2)  | Epoch:11 | Val Acc: 0.9515
 Best site-Real                     (2)  | Epoch:11 | Val Acc: 0.9610
 Best site-Painting                 (4)  | Epoch:11 | Val Acc: 0.9082
 Best site-Painting                 (4)  | Epoch:11 | Val Acc: 0.8394
 Best site-Painting                 (4)  | Epoch:11 | Val Acc: 0.8646
 Best site-Sketch                   (0)  | Epoch:11 | Val Acc: 0.8031
 Best site-Sketch                   (0)  | Epoch:11 | Val Acc: 0.8034
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.5872
 Best site-Infograph                (3)  | Epoch:11 | Val Acc: 0.5962
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 12 ============
cnt=[1, 1, 1, 6, 4, 3, ]
cnt=[4, 1, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (5) | Train Loss: 0.6331 | Train Acc: 0.8261
 Site-Clipart                   (4) | Train Loss: 0.5595 | Train Acc: 0.8882
 Site-Clipart                   (4) | Train Loss: 0.6683 | Train Acc: 0.8400
 Site-Clipart                   (5) | Train Loss: 0.5890 | Train Acc: 0.8608
 Site-Clipart                   (5) | Train Loss: 0.6498 | Train Acc: 0.8439
 Site-Real                      (3) | Train Loss: 0.4826 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.3962 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.4041 | Train Acc: 0.9516
 Site-Real                      (3) | Train Loss: 0.4684 | Train Acc: 0.9339
 Site-Painting                  (3) | Train Loss: 0.6585 | Train Acc: 0.8435
 Site-Painting                  (3) | Train Loss: 0.5652 | Train Acc: 0.8835
 Site-Painting                  (3) | Train Loss: 0.5737 | Train Acc: 0.8547
 Site-Sketch                    (4) | Train Loss: 0.6623 | Train Acc: 0.8377
 Site-Sketch                    (4) | Train Loss: 0.7706 | Train Acc: 0.7940
 Site-QuickDraw                 (2) | Train Loss: 1.3303 | Train Acc: 0.6330
 Site-Infograph                 (0) | Train Loss: 1.4334 | Train Acc: 0.5342
Average Train Accuracy: 0.8363
 Site-Clipart                   (5) | Val  Loss: 0.4869 | Val  Acc: 0.8947
 Site-Clipart                   (4) | Val  Loss: 0.5930 | Val  Acc: 0.8785
 Site-Clipart                   (4) | Val  Loss: 0.6048 | Val  Acc: 0.8467
 Site-Clipart                   (5) | Val  Loss: 0.5855 | Val  Acc: 0.8286
 Site-Clipart                   (5) | Val  Loss: 0.6609 | Val  Acc: 0.8407
 Site-Real                      (3) | Val  Loss: 0.4247 | Val  Acc: 0.9048
 Site-Real                      (1) | Val  Loss: 0.3991 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.4247 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.3965 | Val  Acc: 0.9567
 Site-Painting                  (3) | Val  Loss: 0.4771 | Val  Acc: 0.8878
 Site-Painting                  (3) | Val  Loss: 0.5640 | Val  Acc: 0.8467
 Site-Painting                  (3) | Val  Loss: 0.5974 | Val  Acc: 0.8594
 Site-Sketch                    (4) | Val  Loss: 0.7218 | Val  Acc: 0.8110
 Site-Sketch                    (4) | Val  Loss: 0.7276 | Val  Acc: 0.7865
 Site-QuickDraw                 (2) | Val  Loss: 1.4111 | Val  Acc: 0.6193
 Site-Infograph                 (0) | Val  Loss: 1.2860 | Val  Acc: 0.6218
Average Valid Accuracy: 0.8403
 Best site-Clipart                  (5)  | Epoch:12 | Val Acc: 0.8947
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8785
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8467
 Best site-Clipart                  (5)  | Epoch:12 | Val Acc: 0.8286
 Best site-Clipart                  (5)  | Epoch:12 | Val Acc: 0.8407
 Best site-Real                     (3)  | Epoch:12 | Val Acc: 0.9048
 Best site-Real                     (1)  | Epoch:12 | Val Acc: 0.9407
 Best site-Real                     (3)  | Epoch:12 | Val Acc: 0.9212
 Best site-Real                     (3)  | Epoch:12 | Val Acc: 0.9567
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8878
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8467
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8594
 Best site-Sketch                   (4)  | Epoch:12 | Val Acc: 0.8110
 Best site-Sketch                   (4)  | Epoch:12 | Val Acc: 0.7865
 Best site-QuickDraw                (2)  | Epoch:12 | Val Acc: 0.6193
 Best site-Infograph                (0)  | Epoch:12 | Val Acc: 0.6218
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 13 ============
cnt=[3, 3, 4, 1, 3, 2, ]
cnt=[5, 1, 3, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (5) | Train Loss: 0.6474 | Train Acc: 0.8261
 Site-Clipart                   (0) | Train Loss: 0.5218 | Train Acc: 0.9068
 Site-Clipart                   (4) | Train Loss: 0.6104 | Train Acc: 0.8489
 Site-Clipart                   (5) | Train Loss: 0.5925 | Train Acc: 0.8386
 Site-Clipart                   (4) | Train Loss: 0.6200 | Train Acc: 0.8484
 Site-Real                      (2) | Train Loss: 0.4549 | Train Acc: 0.9048
 Site-Real                      (2) | Train Loss: 0.3235 | Train Acc: 0.9661
 Site-Real                      (2) | Train Loss: 0.3552 | Train Acc: 0.9597
 Site-Real                      (2) | Train Loss: 0.3989 | Train Acc: 0.9339
 Site-Painting                  (1) | Train Loss: 0.6769 | Train Acc: 0.8503
 Site-Painting                  (1) | Train Loss: 0.5814 | Train Acc: 0.8689
 Site-Painting                  (1) | Train Loss: 0.5517 | Train Acc: 0.8616
 Site-Sketch                    (0) | Train Loss: 0.6584 | Train Acc: 0.8220
 Site-Sketch                    (0) | Train Loss: 0.6593 | Train Acc: 0.8015
 Site-QuickDraw                 (3) | Train Loss: 1.3253 | Train Acc: 0.6330
 Site-Infograph                 (4) | Train Loss: 1.4232 | Train Acc: 0.5385
Average Train Accuracy: 0.8381
 Site-Clipart                   (5) | Val  Loss: 0.4453 | Val  Acc: 0.8947
 Site-Clipart                   (0) | Val  Loss: 0.5304 | Val  Acc: 0.8785
 Site-Clipart                   (4) | Val  Loss: 0.5587 | Val  Acc: 0.8867
 Site-Clipart                   (5) | Val  Loss: 0.5574 | Val  Acc: 0.8476
 Site-Clipart                   (4) | Val  Loss: 0.6331 | Val  Acc: 0.8508
 Site-Real                      (2) | Val  Loss: 0.4050 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.3829 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.3934 | Val  Acc: 0.9394
 Site-Real                      (2) | Val  Loss: 0.3814 | Val  Acc: 0.9567
 Site-Painting                  (1) | Val  Loss: 0.4520 | Val  Acc: 0.8878
 Site-Painting                  (1) | Val  Loss: 0.5715 | Val  Acc: 0.8321
 Site-Painting                  (1) | Val  Loss: 0.6003 | Val  Acc: 0.8646
 Site-Sketch                    (0) | Val  Loss: 0.7059 | Val  Acc: 0.8189
 Site-Sketch                    (0) | Val  Loss: 0.6631 | Val  Acc: 0.8034
 Site-QuickDraw                 (3) | Val  Loss: 1.2947 | Val  Acc: 0.6468
 Site-Infograph                 (4) | Val  Loss: 1.2707 | Val  Acc: 0.6346
Average Valid Accuracy: 0.8502
 Best site-Clipart                  (5)  | Epoch:13 | Val Acc: 0.8947
 Best site-Clipart                  (0)  | Epoch:13 | Val Acc: 0.8785
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8867
 Best site-Clipart                  (5)  | Epoch:13 | Val Acc: 0.8476
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8508
 Best site-Real                     (2)  | Epoch:13 | Val Acc: 0.9286
 Best site-Real                     (2)  | Epoch:13 | Val Acc: 0.9322
 Best site-Real                     (2)  | Epoch:13 | Val Acc: 0.9394
 Best site-Real                     (2)  | Epoch:13 | Val Acc: 0.9567
 Best site-Painting                 (1)  | Epoch:13 | Val Acc: 0.8878
 Best site-Painting                 (1)  | Epoch:13 | Val Acc: 0.8321
 Best site-Painting                 (1)  | Epoch:13 | Val Acc: 0.8646
 Best site-Sketch                   (0)  | Epoch:13 | Val Acc: 0.8189
 Best site-Sketch                   (0)  | Epoch:13 | Val Acc: 0.8034
 Best site-QuickDraw                (3)  | Epoch:13 | Val Acc: 0.6468
 Best site-Infograph                (4)  | Epoch:13 | Val Acc: 0.6346
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 14 ============
cnt=[5, 4, 1, 2, 2, 2, ]
cnt=[4, 5, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (4) | Train Loss: 0.6416 | Train Acc: 0.8522
 Site-Clipart                   (0) | Train Loss: 0.5299 | Train Acc: 0.9006
 Site-Clipart                   (0) | Train Loss: 0.6107 | Train Acc: 0.8622
 Site-Clipart                   (4) | Train Loss: 0.5612 | Train Acc: 0.8608
 Site-Clipart                   (0) | Train Loss: 0.5820 | Train Acc: 0.8394
 Site-Real                      (1) | Train Loss: 0.4339 | Train Acc: 0.8968
 Site-Real                      (1) | Train Loss: 0.3287 | Train Acc: 0.9548
 Site-Real                      (1) | Train Loss: 0.3500 | Train Acc: 0.9476
 Site-Real                      (1) | Train Loss: 0.4054 | Train Acc: 0.9339
 Site-Painting                  (3) | Train Loss: 0.5953 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.5593 | Train Acc: 0.8641
 Site-Painting                  (5) | Train Loss: 0.5266 | Train Acc: 0.8858
 Site-Sketch                    (0) | Train Loss: 0.5955 | Train Acc: 0.8429
 Site-Sketch                    (0) | Train Loss: 0.6560 | Train Acc: 0.7940
 Site-QuickDraw                 (2) | Train Loss: 1.2953 | Train Acc: 0.6086
 Site-Infograph                 (3) | Train Loss: 1.3383 | Train Acc: 0.5769
Average Train Accuracy: 0.8432
 Site-Clipart                   (4) | Val  Loss: 0.4171 | Val  Acc: 0.8816
 Site-Clipart                   (0) | Val  Loss: 0.5181 | Val  Acc: 0.8972
 Site-Clipart                   (0) | Val  Loss: 0.5299 | Val  Acc: 0.8867
 Site-Clipart                   (4) | Val  Loss: 0.5619 | Val  Acc: 0.8429
 Site-Clipart                   (0) | Val  Loss: 0.6410 | Val  Acc: 0.8271
 Site-Real                      (1) | Val  Loss: 0.3713 | Val  Acc: 0.9048
 Site-Real                      (1) | Val  Loss: 0.3497 | Val  Acc: 0.9492
 Site-Real                      (1) | Val  Loss: 0.3718 | Val  Acc: 0.9273
 Site-Real                      (1) | Val  Loss: 0.3626 | Val  Acc: 0.9394
 Site-Painting                  (3) | Val  Loss: 0.3920 | Val  Acc: 0.8878
 Site-Painting                  (5) | Val  Loss: 0.5507 | Val  Acc: 0.8759
 Site-Painting                  (5) | Val  Loss: 0.5611 | Val  Acc: 0.8802
 Site-Sketch                    (0) | Val  Loss: 0.6288 | Val  Acc: 0.8189
 Site-Sketch                    (0) | Val  Loss: 0.6429 | Val  Acc: 0.8146
 Site-QuickDraw                 (2) | Val  Loss: 1.3025 | Val  Acc: 0.6743
 Site-Infograph                 (3) | Val  Loss: 1.2669 | Val  Acc: 0.6410
Average Valid Accuracy: 0.8530
 Best site-Clipart                  (4)  | Epoch:14 | Val Acc: 0.8816
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8972
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8867
 Best site-Clipart                  (4)  | Epoch:14 | Val Acc: 0.8429
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8271
 Best site-Real                     (1)  | Epoch:14 | Val Acc: 0.9048
 Best site-Real                     (1)  | Epoch:14 | Val Acc: 0.9492
 Best site-Real                     (1)  | Epoch:14 | Val Acc: 0.9273
 Best site-Real                     (1)  | Epoch:14 | Val Acc: 0.9394
 Best site-Painting                 (3)  | Epoch:14 | Val Acc: 0.8878
 Best site-Painting                 (5)  | Epoch:14 | Val Acc: 0.8759
 Best site-Painting                 (5)  | Epoch:14 | Val Acc: 0.8802
 Best site-Sketch                   (0)  | Epoch:14 | Val Acc: 0.8189
 Best site-Sketch                   (0)  | Epoch:14 | Val Acc: 0.8146
 Best site-QuickDraw                (2)  | Epoch:14 | Val Acc: 0.6743
 Best site-Infograph                (3)  | Epoch:14 | Val Acc: 0.6410
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 15 ============
cnt=[3, 1, 4, 2, 3, 3, ]
cnt=[5, 1, 3, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (2) | Train Loss: 0.5488 | Train Acc: 0.8609
 Site-Clipart                   (2) | Train Loss: 0.4725 | Train Acc: 0.8820
 Site-Clipart                   (2) | Train Loss: 0.5630 | Train Acc: 0.8444
 Site-Clipart                   (5) | Train Loss: 0.5662 | Train Acc: 0.8354
 Site-Clipart                   (2) | Train Loss: 0.5630 | Train Acc: 0.8665
 Site-Real                      (4) | Train Loss: 0.4246 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.3339 | Train Acc: 0.9492
 Site-Real                      (0) | Train Loss: 0.3470 | Train Acc: 0.9556
 Site-Real                      (4) | Train Loss: 0.3621 | Train Acc: 0.9368
 Site-Painting                  (5) | Train Loss: 0.6204 | Train Acc: 0.8571
 Site-Painting                  (0) | Train Loss: 0.4904 | Train Acc: 0.8932
 Site-Painting                  (0) | Train Loss: 0.4900 | Train Acc: 0.8547
 Site-Sketch                    (3) | Train Loss: 0.6217 | Train Acc: 0.8220
 Site-Sketch                    (3) | Train Loss: 0.6531 | Train Acc: 0.8277
 Site-QuickDraw                 (1) | Train Loss: 1.2134 | Train Acc: 0.6544
 Site-Infograph                 (5) | Train Loss: 1.3286 | Train Acc: 0.5940
Average Train Accuracy: 0.8462
 Site-Clipart                   (2) | Val  Loss: 0.4186 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.4806 | Val  Acc: 0.9065
 Site-Clipart                   (2) | Val  Loss: 0.4917 | Val  Acc: 0.8800
 Site-Clipart                   (5) | Val  Loss: 0.5590 | Val  Acc: 0.8524
 Site-Clipart                   (2) | Val  Loss: 0.5956 | Val  Acc: 0.8407
 Site-Real                      (4) | Val  Loss: 0.3500 | Val  Acc: 0.9048
 Site-Real                      (4) | Val  Loss: 0.3566 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.3356 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.3441 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.3808 | Val  Acc: 0.8980
 Site-Painting                  (0) | Val  Loss: 0.5261 | Val  Acc: 0.8759
 Site-Painting                  (0) | Val  Loss: 0.5141 | Val  Acc: 0.8490
 Site-Sketch                    (3) | Val  Loss: 0.6115 | Val  Acc: 0.8425
 Site-Sketch                    (3) | Val  Loss: 0.6758 | Val  Acc: 0.7640
 Site-QuickDraw                 (1) | Val  Loss: 1.2546 | Val  Acc: 0.6743
 Site-Infograph                 (5) | Val  Loss: 1.2237 | Val  Acc: 0.6026
Average Valid Accuracy: 0.8522
============ Train epoch 16 ============
cnt=[6, 1, 5, 2, 1, 1, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (5) | Train Loss: 0.5941 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.4809 | Train Acc: 0.8882
 Site-Clipart                   (0) | Train Loss: 0.6185 | Train Acc: 0.8178
 Site-Clipart                   (4) | Train Loss: 0.4924 | Train Acc: 0.8544
 Site-Clipart                   (0) | Train Loss: 0.5267 | Train Acc: 0.8733
 Site-Real                      (3) | Train Loss: 0.3763 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.3253 | Train Acc: 0.9492
 Site-Real                      (2) | Train Loss: 0.3103 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.3757 | Train Acc: 0.9425
 Site-Painting                  (2) | Train Loss: 0.5381 | Train Acc: 0.8435
 Site-Painting                  (2) | Train Loss: 0.5388 | Train Acc: 0.8738
 Site-Painting                  (2) | Train Loss: 0.4753 | Train Acc: 0.8824
 Site-Sketch                    (0) | Train Loss: 0.5544 | Train Acc: 0.8639
 Site-Sketch                    (0) | Train Loss: 0.5937 | Train Acc: 0.8202
 Site-QuickDraw                 (1) | Train Loss: 1.1959 | Train Acc: 0.6575
 Site-Infograph                 (0) | Train Loss: 1.2995 | Train Acc: 0.6111
Average Train Accuracy: 0.8493
 Site-Clipart                   (5) | Val  Loss: 0.3792 | Val  Acc: 0.8816
 Site-Clipart                   (0) | Val  Loss: 0.5234 | Val  Acc: 0.8785
 Site-Clipart                   (0) | Val  Loss: 0.4636 | Val  Acc: 0.9067
 Site-Clipart                   (4) | Val  Loss: 0.4948 | Val  Acc: 0.8286
 Site-Clipart                   (0) | Val  Loss: 0.6068 | Val  Acc: 0.8305
 Site-Real                      (3) | Val  Loss: 0.3289 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3217 | Val  Acc: 0.9237
 Site-Real                      (2) | Val  Loss: 0.3203 | Val  Acc: 0.9576
 Site-Real                      (2) | Val  Loss: 0.3157 | Val  Acc: 0.9610
 Site-Painting                  (2) | Val  Loss: 0.3908 | Val  Acc: 0.9184
 Site-Painting                  (2) | Val  Loss: 0.4966 | Val  Acc: 0.8759
 Site-Painting                  (2) | Val  Loss: 0.5254 | Val  Acc: 0.8802
 Site-Sketch                    (0) | Val  Loss: 0.6138 | Val  Acc: 0.8268
 Site-Sketch                    (0) | Val  Loss: 0.6690 | Val  Acc: 0.7865
 Site-QuickDraw                 (1) | Val  Loss: 1.1511 | Val  Acc: 0.6881
 Site-Infograph                 (0) | Val  Loss: 1.2586 | Val  Acc: 0.5833
Average Valid Accuracy: 0.8542
 Best site-Clipart                  (5)  | Epoch:16 | Val Acc: 0.8816
 Best site-Clipart                  (0)  | Epoch:16 | Val Acc: 0.8785
 Best site-Clipart                  (0)  | Epoch:16 | Val Acc: 0.9067
 Best site-Clipart                  (4)  | Epoch:16 | Val Acc: 0.8286
 Best site-Clipart                  (0)  | Epoch:16 | Val Acc: 0.8305
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9237
 Best site-Real                     (2)  | Epoch:16 | Val Acc: 0.9576
 Best site-Real                     (2)  | Epoch:16 | Val Acc: 0.9610
 Best site-Painting                 (2)  | Epoch:16 | Val Acc: 0.9184
 Best site-Painting                 (2)  | Epoch:16 | Val Acc: 0.8759
 Best site-Painting                 (2)  | Epoch:16 | Val Acc: 0.8802
 Best site-Sketch                   (0)  | Epoch:16 | Val Acc: 0.8268
 Best site-Sketch                   (0)  | Epoch:16 | Val Acc: 0.7865
 Best site-QuickDraw                (1)  | Epoch:16 | Val Acc: 0.6881
 Best site-Infograph                (0)  | Epoch:16 | Val Acc: 0.5833
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 17 ============
cnt=[4, 1, 6, 3, 1, 1, ]
cnt=[3, 1, 5, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (4) | Train Loss: 0.5603 | Train Acc: 0.8522
 Site-Clipart                   (2) | Train Loss: 0.4560 | Train Acc: 0.9068
 Site-Clipart                   (2) | Train Loss: 0.5957 | Train Acc: 0.8267
 Site-Clipart                   (2) | Train Loss: 0.5270 | Train Acc: 0.8513
 Site-Clipart                   (2) | Train Loss: 0.5277 | Train Acc: 0.8507
 Site-Real                      (0) | Train Loss: 0.3906 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.3162 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.3263 | Train Acc: 0.9315
 Site-Real                      (0) | Train Loss: 0.3712 | Train Acc: 0.9282
 Site-Painting                  (3) | Train Loss: 0.5257 | Train Acc: 0.8299
 Site-Painting                  (3) | Train Loss: 0.4840 | Train Acc: 0.8932
 Site-Painting                  (3) | Train Loss: 0.4629 | Train Acc: 0.8893
 Site-Sketch                    (2) | Train Loss: 0.5785 | Train Acc: 0.8429
 Site-Sketch                    (2) | Train Loss: 0.6471 | Train Acc: 0.8165
 Site-QuickDraw                 (1) | Train Loss: 1.0696 | Train Acc: 0.7095
 Site-Infograph                 (5) | Train Loss: 1.3047 | Train Acc: 0.5769
Average Train Accuracy: 0.8483
 Site-Clipart                   (4) | Val  Loss: 0.3787 | Val  Acc: 0.8816
 Site-Clipart                   (2) | Val  Loss: 0.4802 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.4996 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.4869 | Val  Acc: 0.8810
 Site-Clipart                   (2) | Val  Loss: 0.5727 | Val  Acc: 0.8407
 Site-Real                      (0) | Val  Loss: 0.3271 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.3051 | Val  Acc: 0.9492
 Site-Real                      (0) | Val  Loss: 0.3601 | Val  Acc: 0.9091
 Site-Real                      (0) | Val  Loss: 0.3063 | Val  Acc: 0.9524
 Site-Painting                  (3) | Val  Loss: 0.3529 | Val  Acc: 0.9082
 Site-Painting                  (3) | Val  Loss: 0.4719 | Val  Acc: 0.8613
 Site-Painting                  (3) | Val  Loss: 0.4810 | Val  Acc: 0.8802
 Site-Sketch                    (2) | Val  Loss: 0.5980 | Val  Acc: 0.8346
 Site-Sketch                    (2) | Val  Loss: 0.5942 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 1.1220 | Val  Acc: 0.6927
 Site-Infograph                 (5) | Val  Loss: 1.1872 | Val  Acc: 0.6154
Average Valid Accuracy: 0.8578
 Best site-Clipart                  (4)  | Epoch:17 | Val Acc: 0.8816
 Best site-Clipart                  (2)  | Epoch:17 | Val Acc: 0.8972
 Best site-Clipart                  (2)  | Epoch:17 | Val Acc: 0.8667
 Best site-Clipart                  (2)  | Epoch:17 | Val Acc: 0.8810
 Best site-Clipart                  (2)  | Epoch:17 | Val Acc: 0.8407
 Best site-Real                     (0)  | Epoch:17 | Val Acc: 0.9286
 Best site-Real                     (0)  | Epoch:17 | Val Acc: 0.9492
 Best site-Real                     (0)  | Epoch:17 | Val Acc: 0.9091
 Best site-Real                     (0)  | Epoch:17 | Val Acc: 0.9524
 Best site-Painting                 (3)  | Epoch:17 | Val Acc: 0.9082
 Best site-Painting                 (3)  | Epoch:17 | Val Acc: 0.8613
 Best site-Painting                 (3)  | Epoch:17 | Val Acc: 0.8802
 Best site-Sketch                   (2)  | Epoch:17 | Val Acc: 0.8346
 Best site-Sketch                   (2)  | Epoch:17 | Val Acc: 0.8258
 Best site-QuickDraw                (1)  | Epoch:17 | Val Acc: 0.6927
 Best site-Infograph                (5)  | Epoch:17 | Val Acc: 0.6154
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 18 ============
cnt=[2, 1, 3, 5, 4, 1, ]
cnt=[3, 5, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (0) | Train Loss: 0.5942 | Train Acc: 0.8174
 Site-Clipart                   (3) | Train Loss: 0.4322 | Train Acc: 0.8944
 Site-Clipart                   (3) | Train Loss: 0.5456 | Train Acc: 0.8622
 Site-Clipart                   (0) | Train Loss: 0.4938 | Train Acc: 0.8639
 Site-Clipart                   (3) | Train Loss: 0.5274 | Train Acc: 0.8756
 Site-Real                      (4) | Train Loss: 0.4054 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.3082 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.3140 | Train Acc: 0.9355
 Site-Real                      (4) | Train Loss: 0.3488 | Train Acc: 0.9425
 Site-Painting                  (2) | Train Loss: 0.4587 | Train Acc: 0.8707
 Site-Painting                  (2) | Train Loss: 0.4325 | Train Acc: 0.8738
 Site-Painting                  (2) | Train Loss: 0.4398 | Train Acc: 0.8858
 Site-Sketch                    (3) | Train Loss: 0.5688 | Train Acc: 0.8639
 Site-Sketch                    (3) | Train Loss: 0.6332 | Train Acc: 0.8202
 Site-QuickDraw                 (1) | Train Loss: 1.0368 | Train Acc: 0.7064
 Site-Infograph                 (5) | Train Loss: 1.2677 | Train Acc: 0.5855
Average Train Accuracy: 0.8529
 Site-Clipart                   (0) | Val  Loss: 0.3448 | Val  Acc: 0.9211
 Site-Clipart                   (3) | Val  Loss: 0.4799 | Val  Acc: 0.8879
 Site-Clipart                   (3) | Val  Loss: 0.4966 | Val  Acc: 0.8800
 Site-Clipart                   (0) | Val  Loss: 0.4954 | Val  Acc: 0.8571
 Site-Clipart                   (3) | Val  Loss: 0.5592 | Val  Acc: 0.8441
 Site-Real                      (4) | Val  Loss: 0.3247 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.3516 | Val  Acc: 0.9153
 Site-Real                      (4) | Val  Loss: 0.3690 | Val  Acc: 0.9212
 Site-Real                      (4) | Val  Loss: 0.3042 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.3445 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.4670 | Val  Acc: 0.8686
 Site-Painting                  (2) | Val  Loss: 0.4832 | Val  Acc: 0.8646
 Site-Sketch                    (3) | Val  Loss: 0.5242 | Val  Acc: 0.8661
 Site-Sketch                    (3) | Val  Loss: 0.6256 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 1.1143 | Val  Acc: 0.6881
 Site-Infograph                 (5) | Val  Loss: 1.1631 | Val  Acc: 0.6282
Average Valid Accuracy: 0.8617
 Best site-Clipart                  (0)  | Epoch:18 | Val Acc: 0.9211
 Best site-Clipart                  (3)  | Epoch:18 | Val Acc: 0.8879
 Best site-Clipart                  (3)  | Epoch:18 | Val Acc: 0.8800
 Best site-Clipart                  (0)  | Epoch:18 | Val Acc: 0.8571
 Best site-Clipart                  (3)  | Epoch:18 | Val Acc: 0.8441
 Best site-Real                     (4)  | Epoch:18 | Val Acc: 0.9405
 Best site-Real                     (4)  | Epoch:18 | Val Acc: 0.9153
 Best site-Real                     (4)  | Epoch:18 | Val Acc: 0.9212
 Best site-Real                     (4)  | Epoch:18 | Val Acc: 0.9524
 Best site-Painting                 (2)  | Epoch:18 | Val Acc: 0.9490
 Best site-Painting                 (2)  | Epoch:18 | Val Acc: 0.8686
 Best site-Painting                 (2)  | Epoch:18 | Val Acc: 0.8646
 Best site-Sketch                   (3)  | Epoch:18 | Val Acc: 0.8661
 Best site-Sketch                   (3)  | Epoch:18 | Val Acc: 0.8034
 Best site-QuickDraw                (1)  | Epoch:18 | Val Acc: 0.6881
 Best site-Infograph                (5)  | Epoch:18 | Val Acc: 0.6282
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 19 ============
cnt=[1, 3, 4, 4, 3, 1, ]
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (4) | Train Loss: 0.5366 | Train Acc: 0.8261
 Site-Clipart                   (2) | Train Loss: 0.4657 | Train Acc: 0.8944
 Site-Clipart                   (2) | Train Loss: 0.5318 | Train Acc: 0.8489
 Site-Clipart                   (4) | Train Loss: 0.4924 | Train Acc: 0.8703
 Site-Clipart                   (4) | Train Loss: 0.4939 | Train Acc: 0.8778
 Site-Real                      (3) | Train Loss: 0.3851 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2659 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2989 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.3288 | Train Acc: 0.9454
 Site-Painting                  (1) | Train Loss: 0.4769 | Train Acc: 0.8503
 Site-Painting                  (1) | Train Loss: 0.4211 | Train Acc: 0.8738
 Site-Painting                  (1) | Train Loss: 0.4240 | Train Acc: 0.8824
 Site-Sketch                    (2) | Train Loss: 0.5552 | Train Acc: 0.8220
 Site-Sketch                    (2) | Train Loss: 0.5634 | Train Acc: 0.8240
 Site-QuickDraw                 (0) | Train Loss: 1.0108 | Train Acc: 0.7003
 Site-Infograph                 (5) | Train Loss: 1.2215 | Train Acc: 0.6282
Average Train Accuracy: 0.8527
 Site-Clipart                   (4) | Val  Loss: 0.3435 | Val  Acc: 0.9342
 Site-Clipart                   (2) | Val  Loss: 0.4382 | Val  Acc: 0.8785
 Site-Clipart                   (2) | Val  Loss: 0.4272 | Val  Acc: 0.9000
 Site-Clipart                   (4) | Val  Loss: 0.4676 | Val  Acc: 0.8762
 Site-Clipart                   (4) | Val  Loss: 0.5627 | Val  Acc: 0.8407
 Site-Real                      (3) | Val  Loss: 0.3025 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.3152 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2783 | Val  Acc: 0.9515
 Site-Real                      (3) | Val  Loss: 0.2833 | Val  Acc: 0.9567
 Site-Painting                  (1) | Val  Loss: 0.3258 | Val  Acc: 0.9388
 Site-Painting                  (1) | Val  Loss: 0.4160 | Val  Acc: 0.8978
 Site-Painting                  (1) | Val  Loss: 0.4337 | Val  Acc: 0.8750
 Site-Sketch                    (2) | Val  Loss: 0.5630 | Val  Acc: 0.8346
 Site-Sketch                    (2) | Val  Loss: 0.5782 | Val  Acc: 0.8034
 Site-QuickDraw                 (0) | Val  Loss: 1.0867 | Val  Acc: 0.7156
 Site-Infograph                 (5) | Val  Loss: 1.1221 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8695
 Best site-Clipart                  (4)  | Epoch:19 | Val Acc: 0.9342
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8785
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.9000
 Best site-Clipart                  (4)  | Epoch:19 | Val Acc: 0.8762
 Best site-Clipart                  (4)  | Epoch:19 | Val Acc: 0.8407
 Best site-Real                     (3)  | Epoch:19 | Val Acc: 0.9286
 Best site-Real                     (3)  | Epoch:19 | Val Acc: 0.9322
 Best site-Real                     (3)  | Epoch:19 | Val Acc: 0.9515
 Best site-Real                     (3)  | Epoch:19 | Val Acc: 0.9567
 Best site-Painting                 (1)  | Epoch:19 | Val Acc: 0.9388
 Best site-Painting                 (1)  | Epoch:19 | Val Acc: 0.8978
 Best site-Painting                 (1)  | Epoch:19 | Val Acc: 0.8750
 Best site-Sketch                   (2)  | Epoch:19 | Val Acc: 0.8346
 Best site-Sketch                   (2)  | Epoch:19 | Val Acc: 0.8034
 Best site-QuickDraw                (0)  | Epoch:19 | Val Acc: 0.7156
 Best site-Infograph                (5)  | Epoch:19 | Val Acc: 0.6474
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 20 ============
cnt=[4, 1, 2, 4, 4, 1, ]
cnt=[5, 1, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (4) | Train Loss: 0.4990 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.3972 | Train Acc: 0.9068
 Site-Clipart                   (4) | Train Loss: 0.5190 | Train Acc: 0.8444
 Site-Clipart                   (5) | Train Loss: 0.4854 | Train Acc: 0.8544
 Site-Clipart                   (4) | Train Loss: 0.4794 | Train Acc: 0.8869
 Site-Real                      (3) | Train Loss: 0.3465 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2610 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2770 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.3022 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.4704 | Train Acc: 0.8435
 Site-Painting                  (0) | Train Loss: 0.3936 | Train Acc: 0.9078
 Site-Painting                  (0) | Train Loss: 0.4163 | Train Acc: 0.8962
 Site-Sketch                    (2) | Train Loss: 0.5367 | Train Acc: 0.8534
 Site-Sketch                    (2) | Train Loss: 0.5527 | Train Acc: 0.8202
 Site-QuickDraw                 (1) | Train Loss: 0.9802 | Train Acc: 0.7309
 Site-Infograph                 (0) | Train Loss: 1.2226 | Train Acc: 0.5983
Average Train Accuracy: 0.8602
 Site-Clipart                   (4) | Val  Loss: 0.3291 | Val  Acc: 0.8684
 Site-Clipart                   (4) | Val  Loss: 0.4228 | Val  Acc: 0.8879
 Site-Clipart                   (4) | Val  Loss: 0.4250 | Val  Acc: 0.8867
 Site-Clipart                   (5) | Val  Loss: 0.4567 | Val  Acc: 0.8714
 Site-Clipart                   (4) | Val  Loss: 0.5722 | Val  Acc: 0.8373
 Site-Real                      (3) | Val  Loss: 0.2966 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.3012 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.3003 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.2711 | Val  Acc: 0.9567
 Site-Painting                  (0) | Val  Loss: 0.3109 | Val  Acc: 0.9388
 Site-Painting                  (0) | Val  Loss: 0.4535 | Val  Acc: 0.8832
 Site-Painting                  (0) | Val  Loss: 0.4221 | Val  Acc: 0.8906
 Site-Sketch                    (2) | Val  Loss: 0.4960 | Val  Acc: 0.8583
 Site-Sketch                    (2) | Val  Loss: 0.6181 | Val  Acc: 0.7921
 Site-QuickDraw                 (1) | Val  Loss: 1.0461 | Val  Acc: 0.7202
 Site-Infograph                 (0) | Val  Loss: 1.1385 | Val  Acc: 0.6346
Average Valid Accuracy: 0.8630
============ Train epoch 21 ============
cnt=[4, 1, 4, 3, 3, 1, ]
cnt=[7, 1, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (3) | Train Loss: 0.5337 | Train Acc: 0.8522
 Site-Clipart                   (0) | Train Loss: 0.4272 | Train Acc: 0.9193
 Site-Clipart                   (0) | Train Loss: 0.5123 | Train Acc: 0.8622
 Site-Clipart                   (3) | Train Loss: 0.5118 | Train Acc: 0.8544
 Site-Clipart                   (3) | Train Loss: 0.4596 | Train Acc: 0.8688
 Site-Real                      (2) | Train Loss: 0.3831 | Train Acc: 0.9206
 Site-Real                      (2) | Train Loss: 0.2471 | Train Acc: 0.9548
 Site-Real                      (2) | Train Loss: 0.2764 | Train Acc: 0.9395
 Site-Real                      (2) | Train Loss: 0.3112 | Train Acc: 0.9397
 Site-Painting                  (4) | Train Loss: 0.4037 | Train Acc: 0.8912
 Site-Painting                  (4) | Train Loss: 0.4059 | Train Acc: 0.9078
 Site-Painting                  (4) | Train Loss: 0.3893 | Train Acc: 0.9135
 Site-Sketch                    (0) | Train Loss: 0.5151 | Train Acc: 0.8325
 Site-Sketch                    (0) | Train Loss: 0.5327 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.9863 | Train Acc: 0.7309
 Site-Infograph                 (5) | Train Loss: 1.2310 | Train Acc: 0.6154
Average Train Accuracy: 0.8646
 Site-Clipart                   (3) | Val  Loss: 0.3187 | Val  Acc: 0.9211
 Site-Clipart                   (0) | Val  Loss: 0.4412 | Val  Acc: 0.8785
 Site-Clipart                   (0) | Val  Loss: 0.4314 | Val  Acc: 0.8667
 Site-Clipart                   (3) | Val  Loss: 0.4632 | Val  Acc: 0.8524
 Site-Clipart                   (3) | Val  Loss: 0.5522 | Val  Acc: 0.8305
 Site-Real                      (2) | Val  Loss: 0.2790 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.2650 | Val  Acc: 0.9237
 Site-Real                      (2) | Val  Loss: 0.2864 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.2715 | Val  Acc: 0.9567
 Site-Painting                  (4) | Val  Loss: 0.2927 | Val  Acc: 0.8980
 Site-Painting                  (4) | Val  Loss: 0.4027 | Val  Acc: 0.8978
 Site-Painting                  (4) | Val  Loss: 0.4428 | Val  Acc: 0.8698
 Site-Sketch                    (0) | Val  Loss: 0.4982 | Val  Acc: 0.8504
 Site-Sketch                    (0) | Val  Loss: 0.5820 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 1.0175 | Val  Acc: 0.6927
 Site-Infograph                 (5) | Val  Loss: 1.0653 | Val  Acc: 0.6410
Average Valid Accuracy: 0.8598
============ Train epoch 22 ============
cnt=[4, 1, 2, 4, 3, 2, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (4) | Train Loss: 0.4186 | Train Acc: 0.8783
 Site-Clipart                   (0) | Train Loss: 0.3452 | Train Acc: 0.9379
 Site-Clipart                   (0) | Train Loss: 0.5100 | Train Acc: 0.8400
 Site-Clipart                   (4) | Train Loss: 0.4757 | Train Acc: 0.8608
 Site-Clipart                   (4) | Train Loss: 0.4598 | Train Acc: 0.8824
 Site-Real                      (3) | Train Loss: 0.3543 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2361 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2686 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.3200 | Train Acc: 0.9282
 Site-Painting                  (5) | Train Loss: 0.4860 | Train Acc: 0.8707
 Site-Painting                  (2) | Train Loss: 0.4492 | Train Acc: 0.8689
 Site-Painting                  (3) | Train Loss: 0.3596 | Train Acc: 0.9273
 Site-Sketch                    (0) | Train Loss: 0.5212 | Train Acc: 0.8377
 Site-Sketch                    (0) | Train Loss: 0.5165 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.8937 | Train Acc: 0.7523
 Site-Infograph                 (5) | Train Loss: 1.1748 | Train Acc: 0.6239
Average Train Accuracy: 0.8659
 Site-Clipart                   (4) | Val  Loss: 0.3088 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.4399 | Val  Acc: 0.8505
 Site-Clipart                   (0) | Val  Loss: 0.4320 | Val  Acc: 0.8533
 Site-Clipart                   (4) | Val  Loss: 0.4708 | Val  Acc: 0.8286
 Site-Clipart                   (4) | Val  Loss: 0.5039 | Val  Acc: 0.8610
 Site-Real                      (3) | Val  Loss: 0.2810 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.3232 | Val  Acc: 0.9237
 Site-Real                      (3) | Val  Loss: 0.2742 | Val  Acc: 0.9455
 Site-Real                      (2) | Val  Loss: 0.2643 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2742 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.4479 | Val  Acc: 0.8832
 Site-Painting                  (3) | Val  Loss: 0.4199 | Val  Acc: 0.8750
 Site-Sketch                    (0) | Val  Loss: 0.5249 | Val  Acc: 0.8661
 Site-Sketch                    (0) | Val  Loss: 0.5945 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 0.9754 | Val  Acc: 0.7339
 Site-Infograph                 (5) | Val  Loss: 1.1060 | Val  Acc: 0.6346
Average Valid Accuracy: 0.8619
============ Train epoch 23 ============
cnt=[2, 4, 1, 3, 5, 1, ]
cnt=[2, 5, 1, 4, 3, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (4) | Train Loss: 0.4599 | Train Acc: 0.8783
 Site-Clipart                   (4) | Train Loss: 0.3645 | Train Acc: 0.9565
 Site-Clipart                   (4) | Train Loss: 0.4992 | Train Acc: 0.8800
 Site-Clipart                   (4) | Train Loss: 0.4311 | Train Acc: 0.8892
 Site-Clipart                   (4) | Train Loss: 0.4434 | Train Acc: 0.8846
 Site-Real                      (1) | Train Loss: 0.3355 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.2444 | Train Acc: 0.9492
 Site-Real                      (1) | Train Loss: 0.2519 | Train Acc: 0.9556
 Site-Real                      (1) | Train Loss: 0.2998 | Train Acc: 0.9310
 Site-Painting                  (3) | Train Loss: 0.4558 | Train Acc: 0.8707
 Site-Painting                  (3) | Train Loss: 0.3999 | Train Acc: 0.8932
 Site-Painting                  (3) | Train Loss: 0.3833 | Train Acc: 0.8997
 Site-Sketch                    (0) | Train Loss: 0.5116 | Train Acc: 0.8325
 Site-Sketch                    (0) | Train Loss: 0.4970 | Train Acc: 0.8427
 Site-QuickDraw                 (2) | Train Loss: 0.9605 | Train Acc: 0.7431
 Site-Infograph                 (5) | Train Loss: 1.1110 | Train Acc: 0.6538
Average Train Accuracy: 0.8733
 Site-Clipart                   (4) | Val  Loss: 0.3284 | Val  Acc: 0.9211
 Site-Clipart                   (4) | Val  Loss: 0.3940 | Val  Acc: 0.9159
 Site-Clipart                   (4) | Val  Loss: 0.4155 | Val  Acc: 0.8867
 Site-Clipart                   (4) | Val  Loss: 0.4759 | Val  Acc: 0.8524
 Site-Clipart                   (4) | Val  Loss: 0.5562 | Val  Acc: 0.8407
 Site-Real                      (1) | Val  Loss: 0.2743 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.2982 | Val  Acc: 0.9237
 Site-Real                      (1) | Val  Loss: 0.2751 | Val  Acc: 0.9515
 Site-Real                      (1) | Val  Loss: 0.3013 | Val  Acc: 0.9437
 Site-Painting                  (3) | Val  Loss: 0.3210 | Val  Acc: 0.9184
 Site-Painting                  (3) | Val  Loss: 0.4228 | Val  Acc: 0.9051
 Site-Painting                  (3) | Val  Loss: 0.3958 | Val  Acc: 0.8854
 Site-Sketch                    (0) | Val  Loss: 0.5063 | Val  Acc: 0.8740
 Site-Sketch                    (0) | Val  Loss: 0.5679 | Val  Acc: 0.8034
 Site-QuickDraw                 (2) | Val  Loss: 0.9675 | Val  Acc: 0.7477
 Site-Infograph                 (5) | Val  Loss: 1.0505 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8735
 Best site-Clipart                  (4)  | Epoch:23 | Val Acc: 0.9211
 Best site-Clipart                  (4)  | Epoch:23 | Val Acc: 0.9159
 Best site-Clipart                  (4)  | Epoch:23 | Val Acc: 0.8867
 Best site-Clipart                  (4)  | Epoch:23 | Val Acc: 0.8524
 Best site-Clipart                  (4)  | Epoch:23 | Val Acc: 0.8407
 Best site-Real                     (1)  | Epoch:23 | Val Acc: 0.9405
 Best site-Real                     (1)  | Epoch:23 | Val Acc: 0.9237
 Best site-Real                     (1)  | Epoch:23 | Val Acc: 0.9515
 Best site-Real                     (1)  | Epoch:23 | Val Acc: 0.9437
 Best site-Painting                 (3)  | Epoch:23 | Val Acc: 0.9184
 Best site-Painting                 (3)  | Epoch:23 | Val Acc: 0.9051
 Best site-Painting                 (3)  | Epoch:23 | Val Acc: 0.8854
 Best site-Sketch                   (0)  | Epoch:23 | Val Acc: 0.8740
 Best site-Sketch                   (0)  | Epoch:23 | Val Acc: 0.8034
 Best site-QuickDraw                (2)  | Epoch:23 | Val Acc: 0.7477
 Best site-Infograph                (5)  | Epoch:23 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 24 ============
cnt=[4, 1, 5, 3, 2, 1, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (2) | Train Loss: 0.4533 | Train Acc: 0.8435
 Site-Clipart                   (2) | Train Loss: 0.3739 | Train Acc: 0.9317
 Site-Clipart                   (2) | Train Loss: 0.4671 | Train Acc: 0.8667
 Site-Clipart                   (2) | Train Loss: 0.4568 | Train Acc: 0.8703
 Site-Clipart                   (2) | Train Loss: 0.4444 | Train Acc: 0.8959
 Site-Real                      (0) | Train Loss: 0.3620 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2315 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2756 | Train Acc: 0.9435
 Site-Real                      (0) | Train Loss: 0.3199 | Train Acc: 0.9310
 Site-Painting                  (3) | Train Loss: 0.3975 | Train Acc: 0.8707
 Site-Painting                  (3) | Train Loss: 0.3408 | Train Acc: 0.9078
 Site-Painting                  (3) | Train Loss: 0.3735 | Train Acc: 0.8997
 Site-Sketch                    (4) | Train Loss: 0.5036 | Train Acc: 0.8534
 Site-Sketch                    (4) | Train Loss: 0.5506 | Train Acc: 0.8240
 Site-QuickDraw                 (1) | Train Loss: 0.8882 | Train Acc: 0.7676
 Site-Infograph                 (5) | Train Loss: 1.1532 | Train Acc: 0.6154
Average Train Accuracy: 0.8680
 Site-Clipart                   (2) | Val  Loss: 0.3490 | Val  Acc: 0.8947
 Site-Clipart                   (2) | Val  Loss: 0.4208 | Val  Acc: 0.8505
 Site-Clipart                   (2) | Val  Loss: 0.4383 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.4807 | Val  Acc: 0.8381
 Site-Clipart                   (2) | Val  Loss: 0.5131 | Val  Acc: 0.8542
 Site-Real                      (0) | Val  Loss: 0.2735 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.2581 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2841 | Val  Acc: 0.9212
 Site-Real                      (0) | Val  Loss: 0.2615 | Val  Acc: 0.9567
 Site-Painting                  (3) | Val  Loss: 0.2881 | Val  Acc: 0.9286
 Site-Painting                  (3) | Val  Loss: 0.4027 | Val  Acc: 0.9270
 Site-Painting                  (3) | Val  Loss: 0.3677 | Val  Acc: 0.9062
 Site-Sketch                    (4) | Val  Loss: 0.5124 | Val  Acc: 0.8583
 Site-Sketch                    (4) | Val  Loss: 0.5886 | Val  Acc: 0.7809
 Site-QuickDraw                 (1) | Val  Loss: 1.0008 | Val  Acc: 0.7156
 Site-Infograph                 (5) | Val  Loss: 1.0704 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8635
============ Train epoch 25 ============
cnt=[4, 1, 4, 3, 3, 1, ]
cnt=[4, 1, 5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (4) | Train Loss: 0.5241 | Train Acc: 0.8348
 Site-Clipart                   (0) | Train Loss: 0.4108 | Train Acc: 0.9130
 Site-Clipart                   (0) | Train Loss: 0.5009 | Train Acc: 0.8889
 Site-Clipart                   (4) | Train Loss: 0.4549 | Train Acc: 0.8639
 Site-Clipart                   (4) | Train Loss: 0.4484 | Train Acc: 0.8937
 Site-Real                      (2) | Train Loss: 0.3473 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.2213 | Train Acc: 0.9548
 Site-Real                      (2) | Train Loss: 0.2600 | Train Acc: 0.9395
 Site-Real                      (2) | Train Loss: 0.2924 | Train Acc: 0.9540
 Site-Painting                  (3) | Train Loss: 0.4389 | Train Acc: 0.8980
 Site-Painting                  (3) | Train Loss: 0.3834 | Train Acc: 0.8835
 Site-Painting                  (3) | Train Loss: 0.3668 | Train Acc: 0.9170
 Site-Sketch                    (0) | Train Loss: 0.4749 | Train Acc: 0.8743
 Site-Sketch                    (0) | Train Loss: 0.5322 | Train Acc: 0.8390
 Site-QuickDraw                 (1) | Train Loss: 0.8799 | Train Acc: 0.7523
 Site-Infograph                 (5) | Train Loss: 1.0863 | Train Acc: 0.6538
Average Train Accuracy: 0.8733
 Site-Clipart                   (4) | Val  Loss: 0.3079 | Val  Acc: 0.9211
 Site-Clipart                   (0) | Val  Loss: 0.4012 | Val  Acc: 0.9065
 Site-Clipart                   (0) | Val  Loss: 0.3854 | Val  Acc: 0.8733
 Site-Clipart                   (4) | Val  Loss: 0.4458 | Val  Acc: 0.8857
 Site-Clipart                   (4) | Val  Loss: 0.5214 | Val  Acc: 0.8780
 Site-Real                      (2) | Val  Loss: 0.2640 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.2772 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.2533 | Val  Acc: 0.9515
 Site-Real                      (2) | Val  Loss: 0.2641 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.2773 | Val  Acc: 0.9490
 Site-Painting                  (3) | Val  Loss: 0.3912 | Val  Acc: 0.8905
 Site-Painting                  (3) | Val  Loss: 0.3790 | Val  Acc: 0.8854
 Site-Sketch                    (0) | Val  Loss: 0.4479 | Val  Acc: 0.8661
 Site-Sketch                    (0) | Val  Loss: 0.5964 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 0.9351 | Val  Acc: 0.7477
 Site-Infograph                 (5) | Val  Loss: 1.0801 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8798
 Best site-Clipart                  (4)  | Epoch:25 | Val Acc: 0.9211
 Best site-Clipart                  (0)  | Epoch:25 | Val Acc: 0.9065
 Best site-Clipart                  (0)  | Epoch:25 | Val Acc: 0.8733
 Best site-Clipart                  (4)  | Epoch:25 | Val Acc: 0.8857
 Best site-Clipart                  (4)  | Epoch:25 | Val Acc: 0.8780
 Best site-Real                     (2)  | Epoch:25 | Val Acc: 0.9405
 Best site-Real                     (2)  | Epoch:25 | Val Acc: 0.9322
 Best site-Real                     (2)  | Epoch:25 | Val Acc: 0.9515
 Best site-Real                     (2)  | Epoch:25 | Val Acc: 0.9481
 Best site-Painting                 (3)  | Epoch:25 | Val Acc: 0.9490
 Best site-Painting                 (3)  | Epoch:25 | Val Acc: 0.8905
 Best site-Painting                 (3)  | Epoch:25 | Val Acc: 0.8854
 Best site-Sketch                   (0)  | Epoch:25 | Val Acc: 0.8661
 Best site-Sketch                   (0)  | Epoch:25 | Val Acc: 0.8090
 Best site-QuickDraw                (1)  | Epoch:25 | Val Acc: 0.7477
 Best site-Infograph                (5)  | Epoch:25 | Val Acc: 0.6923
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 26 ============
cnt=[1, 4, 3, 4, 1, 3, ]
cnt=[5, 1, 3, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (5) | Train Loss: 0.4612 | Train Acc: 0.8696
 Site-Clipart                   (1) | Train Loss: 0.3662 | Train Acc: 0.9006
 Site-Clipart                   (1) | Train Loss: 0.4624 | Train Acc: 0.8622
 Site-Clipart                   (5) | Train Loss: 0.4452 | Train Acc: 0.8639
 Site-Clipart                   (5) | Train Loss: 0.4474 | Train Acc: 0.8756
 Site-Real                      (3) | Train Loss: 0.3439 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.2277 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2552 | Train Acc: 0.9395
 Site-Real                      (3) | Train Loss: 0.2883 | Train Acc: 0.9483
 Site-Painting                  (2) | Train Loss: 0.4280 | Train Acc: 0.8980
 Site-Painting                  (2) | Train Loss: 0.3236 | Train Acc: 0.9078
 Site-Painting                  (2) | Train Loss: 0.3476 | Train Acc: 0.9377
 Site-Sketch                    (1) | Train Loss: 0.5072 | Train Acc: 0.8482
 Site-Sketch                    (1) | Train Loss: 0.4992 | Train Acc: 0.8427
 Site-QuickDraw                 (0) | Train Loss: 0.8726 | Train Acc: 0.7523
 Site-Infograph                 (4) | Train Loss: 1.1459 | Train Acc: 0.6496
Average Train Accuracy: 0.8732
 Site-Clipart                   (5) | Val  Loss: 0.3171 | Val  Acc: 0.9211
 Site-Clipart                   (1) | Val  Loss: 0.3725 | Val  Acc: 0.9159
 Site-Clipart                   (1) | Val  Loss: 0.3852 | Val  Acc: 0.9000
 Site-Clipart                   (5) | Val  Loss: 0.4131 | Val  Acc: 0.8810
 Site-Clipart                   (5) | Val  Loss: 0.4931 | Val  Acc: 0.8712
 Site-Real                      (3) | Val  Loss: 0.2887 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2695 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2631 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.2483 | Val  Acc: 0.9567
 Site-Painting                  (2) | Val  Loss: 0.2813 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.4126 | Val  Acc: 0.8978
 Site-Painting                  (2) | Val  Loss: 0.3838 | Val  Acc: 0.8802
 Site-Sketch                    (1) | Val  Loss: 0.5151 | Val  Acc: 0.8583
 Site-Sketch                    (1) | Val  Loss: 0.5910 | Val  Acc: 0.8315
 Site-QuickDraw                 (0) | Val  Loss: 0.9663 | Val  Acc: 0.7339
 Site-Infograph                 (4) | Val  Loss: 1.0233 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8801
 Best site-Clipart                  (5)  | Epoch:26 | Val Acc: 0.9211
 Best site-Clipart                  (1)  | Epoch:26 | Val Acc: 0.9159
 Best site-Clipart                  (1)  | Epoch:26 | Val Acc: 0.9000
 Best site-Clipart                  (5)  | Epoch:26 | Val Acc: 0.8810
 Best site-Clipart                  (5)  | Epoch:26 | Val Acc: 0.8712
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9322
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9394
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9567
 Best site-Painting                 (2)  | Epoch:26 | Val Acc: 0.9490
 Best site-Painting                 (2)  | Epoch:26 | Val Acc: 0.8978
 Best site-Painting                 (2)  | Epoch:26 | Val Acc: 0.8802
 Best site-Sketch                   (1)  | Epoch:26 | Val Acc: 0.8583
 Best site-Sketch                   (1)  | Epoch:26 | Val Acc: 0.8315
 Best site-QuickDraw                (0)  | Epoch:26 | Val Acc: 0.7339
 Best site-Infograph                (4)  | Epoch:26 | Val Acc: 0.6731
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 27 ============
cnt=[2, 1, 3, 1, 5, 4, ]
cnt=[4, 5, 1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (4) | Train Loss: 0.4432 | Train Acc: 0.8783
 Site-Clipart                   (4) | Train Loss: 0.3626 | Train Acc: 0.9193
 Site-Clipart                   (4) | Train Loss: 0.4860 | Train Acc: 0.8667
 Site-Clipart                   (4) | Train Loss: 0.3991 | Train Acc: 0.8924
 Site-Clipart                   (4) | Train Loss: 0.4234 | Train Acc: 0.8891
 Site-Real                      (5) | Train Loss: 0.3386 | Train Acc: 0.9206
 Site-Real                      (5) | Train Loss: 0.2129 | Train Acc: 0.9661
 Site-Real                      (5) | Train Loss: 0.2688 | Train Acc: 0.9355
 Site-Real                      (5) | Train Loss: 0.3030 | Train Acc: 0.9368
 Site-Painting                  (2) | Train Loss: 0.4384 | Train Acc: 0.8503
 Site-Painting                  (2) | Train Loss: 0.4146 | Train Acc: 0.8883
 Site-Painting                  (2) | Train Loss: 0.3592 | Train Acc: 0.9239
 Site-Sketch                    (0) | Train Loss: 0.4850 | Train Acc: 0.8586
 Site-Sketch                    (0) | Train Loss: 0.6032 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 0.8324 | Train Acc: 0.7615
 Site-Infograph                 (3) | Train Loss: 1.0416 | Train Acc: 0.6795
Average Train Accuracy: 0.8751
 Site-Clipart                   (4) | Val  Loss: 0.2868 | Val  Acc: 0.9342
 Site-Clipart                   (4) | Val  Loss: 0.3633 | Val  Acc: 0.9252
 Site-Clipart                   (4) | Val  Loss: 0.3764 | Val  Acc: 0.8933
 Site-Clipart                   (4) | Val  Loss: 0.4062 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.4960 | Val  Acc: 0.8678
 Site-Real                      (5) | Val  Loss: 0.2839 | Val  Acc: 0.9167
 Site-Real                      (5) | Val  Loss: 0.2882 | Val  Acc: 0.9322
 Site-Real                      (5) | Val  Loss: 0.2720 | Val  Acc: 0.9333
 Site-Real                      (5) | Val  Loss: 0.2477 | Val  Acc: 0.9567
 Site-Painting                  (2) | Val  Loss: 0.2777 | Val  Acc: 0.9592
 Site-Painting                  (2) | Val  Loss: 0.3584 | Val  Acc: 0.8978
 Site-Painting                  (2) | Val  Loss: 0.3671 | Val  Acc: 0.8906
 Site-Sketch                    (0) | Val  Loss: 0.4962 | Val  Acc: 0.8661
 Site-Sketch                    (0) | Val  Loss: 0.5375 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.8916 | Val  Acc: 0.7706
 Site-Infograph                 (3) | Val  Loss: 1.0412 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8795
============ Train epoch 28 ============
cnt=[4, 1, 3, 3, 4, 1, ]
cnt=[5, 4, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (4) | Train Loss: 0.4568 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.3234 | Train Acc: 0.9068
 Site-Clipart                   (2) | Train Loss: 0.4944 | Train Acc: 0.8711
 Site-Clipart                   (4) | Train Loss: 0.4082 | Train Acc: 0.8892
 Site-Clipart                   (4) | Train Loss: 0.4223 | Train Acc: 0.9005
 Site-Real                      (0) | Train Loss: 0.3324 | Train Acc: 0.9286
 Site-Real                      (0) | Train Loss: 0.2163 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2430 | Train Acc: 0.9435
 Site-Real                      (0) | Train Loss: 0.2803 | Train Acc: 0.9540
 Site-Painting                  (3) | Train Loss: 0.3366 | Train Acc: 0.8844
 Site-Painting                  (3) | Train Loss: 0.3413 | Train Acc: 0.9078
 Site-Painting                  (3) | Train Loss: 0.3688 | Train Acc: 0.8824
 Site-Sketch                    (2) | Train Loss: 0.4879 | Train Acc: 0.8325
 Site-Sketch                    (2) | Train Loss: 0.5714 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 0.7565 | Train Acc: 0.7584
 Site-Infograph                 (5) | Train Loss: 1.0459 | Train Acc: 0.6838
Average Train Accuracy: 0.8752
 Site-Clipart                   (4) | Val  Loss: 0.3104 | Val  Acc: 0.9079
 Site-Clipart                   (4) | Val  Loss: 0.3682 | Val  Acc: 0.9159
 Site-Clipart                   (2) | Val  Loss: 0.3855 | Val  Acc: 0.9133
 Site-Clipart                   (4) | Val  Loss: 0.4289 | Val  Acc: 0.8810
 Site-Clipart                   (4) | Val  Loss: 0.4867 | Val  Acc: 0.8576
 Site-Real                      (0) | Val  Loss: 0.2706 | Val  Acc: 0.9167
 Site-Real                      (0) | Val  Loss: 0.2874 | Val  Acc: 0.9153
 Site-Real                      (0) | Val  Loss: 0.2637 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2596 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.2537 | Val  Acc: 0.9796
 Site-Painting                  (3) | Val  Loss: 0.4286 | Val  Acc: 0.9051
 Site-Painting                  (3) | Val  Loss: 0.3430 | Val  Acc: 0.9115
 Site-Sketch                    (2) | Val  Loss: 0.4715 | Val  Acc: 0.8740
 Site-Sketch                    (2) | Val  Loss: 0.5042 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.8954 | Val  Acc: 0.7706
 Site-Infograph                 (5) | Val  Loss: 1.0265 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8845
 Best site-Clipart                  (4)  | Epoch:28 | Val Acc: 0.9079
 Best site-Clipart                  (4)  | Epoch:28 | Val Acc: 0.9159
 Best site-Clipart                  (2)  | Epoch:28 | Val Acc: 0.9133
 Best site-Clipart                  (4)  | Epoch:28 | Val Acc: 0.8810
 Best site-Clipart                  (4)  | Epoch:28 | Val Acc: 0.8576
 Best site-Real                     (0)  | Epoch:28 | Val Acc: 0.9167
 Best site-Real                     (0)  | Epoch:28 | Val Acc: 0.9153
 Best site-Real                     (0)  | Epoch:28 | Val Acc: 0.9333
 Best site-Real                     (0)  | Epoch:28 | Val Acc: 0.9481
 Best site-Painting                 (3)  | Epoch:28 | Val Acc: 0.9796
 Best site-Painting                 (3)  | Epoch:28 | Val Acc: 0.9051
 Best site-Painting                 (3)  | Epoch:28 | Val Acc: 0.9115
 Best site-Sketch                   (2)  | Epoch:28 | Val Acc: 0.8740
 Best site-Sketch                   (2)  | Epoch:28 | Val Acc: 0.8427
 Best site-QuickDraw                (1)  | Epoch:28 | Val Acc: 0.7706
 Best site-Infograph                (5)  | Epoch:28 | Val Acc: 0.6795
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 29 ============
cnt=[4, 1, 5, 3, 1, 2, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (2) | Train Loss: 0.4762 | Train Acc: 0.8609
 Site-Clipart                   (2) | Train Loss: 0.3776 | Train Acc: 0.9006
 Site-Clipart                   (2) | Train Loss: 0.4700 | Train Acc: 0.8578
 Site-Clipart                   (5) | Train Loss: 0.4267 | Train Acc: 0.8734
 Site-Clipart                   (5) | Train Loss: 0.4068 | Train Acc: 0.8937
 Site-Real                      (0) | Train Loss: 0.3299 | Train Acc: 0.9206
 Site-Real                      (0) | Train Loss: 0.2143 | Train Acc: 0.9492
 Site-Real                      (0) | Train Loss: 0.2392 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.2828 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.4273 | Train Acc: 0.9048
 Site-Painting                  (3) | Train Loss: 0.3494 | Train Acc: 0.9223
 Site-Painting                  (3) | Train Loss: 0.3418 | Train Acc: 0.9100
 Site-Sketch                    (2) | Train Loss: 0.4369 | Train Acc: 0.8639
 Site-Sketch                    (2) | Train Loss: 0.5889 | Train Acc: 0.8277
 Site-QuickDraw                 (1) | Train Loss: 0.8368 | Train Acc: 0.7615
 Site-Infograph                 (4) | Train Loss: 1.0653 | Train Acc: 0.6496
Average Train Accuracy: 0.8739
 Site-Clipart                   (2) | Val  Loss: 0.2713 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.3505 | Val  Acc: 0.9065
 Site-Clipart                   (2) | Val  Loss: 0.3725 | Val  Acc: 0.9000
 Site-Clipart                   (5) | Val  Loss: 0.4017 | Val  Acc: 0.8857
 Site-Clipart                   (5) | Val  Loss: 0.5026 | Val  Acc: 0.8542
 Site-Real                      (0) | Val  Loss: 0.2498 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.2376 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2407 | Val  Acc: 0.9455
 Site-Real                      (0) | Val  Loss: 0.2151 | Val  Acc: 0.9610
 Site-Painting                  (3) | Val  Loss: 0.2275 | Val  Acc: 0.9286
 Site-Painting                  (3) | Val  Loss: 0.3650 | Val  Acc: 0.9197
 Site-Painting                  (3) | Val  Loss: 0.3460 | Val  Acc: 0.9062
 Site-Sketch                    (2) | Val  Loss: 0.4573 | Val  Acc: 0.8740
 Site-Sketch                    (2) | Val  Loss: 0.5199 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 0.9103 | Val  Acc: 0.7431
 Site-Infograph                 (4) | Val  Loss: 1.0212 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8805
============ Train epoch 30 ============
cnt=[5, 1, 1, 3, 2, 4, ]
cnt=[5, 1, 3, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (5) | Train Loss: 0.4039 | Train Acc: 0.9043
 Site-Clipart                   (5) | Train Loss: 0.2901 | Train Acc: 0.9068
 Site-Clipart                   (5) | Train Loss: 0.4352 | Train Acc: 0.8800
 Site-Clipart                   (5) | Train Loss: 0.3871 | Train Acc: 0.8861
 Site-Clipart                   (2) | Train Loss: 0.3950 | Train Acc: 0.9095
 Site-Real                      (0) | Train Loss: 0.3390 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2138 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2594 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.2486 | Train Acc: 0.9483
 Site-Painting                  (3) | Train Loss: 0.3613 | Train Acc: 0.8844
 Site-Painting                  (3) | Train Loss: 0.4154 | Train Acc: 0.8932
 Site-Painting                  (0) | Train Loss: 0.3484 | Train Acc: 0.9135
 Site-Sketch                    (4) | Train Loss: 0.4784 | Train Acc: 0.8639
 Site-Sketch                    (4) | Train Loss: 0.4581 | Train Acc: 0.8539
 Site-QuickDraw                 (1) | Train Loss: 0.7907 | Train Acc: 0.7431
 Site-Infograph                 (3) | Train Loss: 1.0797 | Train Acc: 0.6581
Average Train Accuracy: 0.8791
 Site-Clipart                   (5) | Val  Loss: 0.3108 | Val  Acc: 0.8947
 Site-Clipart                   (5) | Val  Loss: 0.3639 | Val  Acc: 0.9065
 Site-Clipart                   (5) | Val  Loss: 0.3841 | Val  Acc: 0.8933
 Site-Clipart                   (5) | Val  Loss: 0.4007 | Val  Acc: 0.8857
 Site-Clipart                   (2) | Val  Loss: 0.4559 | Val  Acc: 0.8712
 Site-Real                      (0) | Val  Loss: 0.2492 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2283 | Val  Acc: 0.9492
 Site-Real                      (0) | Val  Loss: 0.2480 | Val  Acc: 0.9273
 Site-Real                      (0) | Val  Loss: 0.2641 | Val  Acc: 0.9524
 Site-Painting                  (3) | Val  Loss: 0.2524 | Val  Acc: 0.9388
 Site-Painting                  (3) | Val  Loss: 0.3559 | Val  Acc: 0.8978
 Site-Painting                  (0) | Val  Loss: 0.3387 | Val  Acc: 0.9219
 Site-Sketch                    (4) | Val  Loss: 0.4256 | Val  Acc: 0.8819
 Site-Sketch                    (4) | Val  Loss: 0.5183 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.8715 | Val  Acc: 0.7706
 Site-Infograph                 (3) | Val  Loss: 1.0472 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8836
============ Train epoch 31 ============
cnt=[4, 1, 3, 4, 1, 3, ]
cnt=[5, 4, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (5) | Train Loss: 0.4298 | Train Acc: 0.8348
 Site-Clipart                   (0) | Train Loss: 0.3514 | Train Acc: 0.9006
 Site-Clipart                   (0) | Train Loss: 0.4269 | Train Acc: 0.8711
 Site-Clipart                   (5) | Train Loss: 0.4010 | Train Acc: 0.8671
 Site-Clipart                   (0) | Train Loss: 0.4211 | Train Acc: 0.8846
 Site-Real                      (3) | Train Loss: 0.3344 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.2490 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.2323 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.2624 | Train Acc: 0.9454
 Site-Painting                  (2) | Train Loss: 0.3526 | Train Acc: 0.8912
 Site-Painting                  (2) | Train Loss: 0.3668 | Train Acc: 0.9029
 Site-Painting                  (2) | Train Loss: 0.3232 | Train Acc: 0.9204
 Site-Sketch                    (5) | Train Loss: 0.4732 | Train Acc: 0.8639
 Site-Sketch                    (0) | Train Loss: 0.4757 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.8656 | Train Acc: 0.7676
 Site-Infograph                 (4) | Train Loss: 1.0174 | Train Acc: 0.6709
Average Train Accuracy: 0.8728
 Site-Clipart                   (5) | Val  Loss: 0.2862 | Val  Acc: 0.8947
 Site-Clipart                   (0) | Val  Loss: 0.3339 | Val  Acc: 0.9159
 Site-Clipart                   (0) | Val  Loss: 0.3586 | Val  Acc: 0.8933
 Site-Clipart                   (5) | Val  Loss: 0.3920 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.4604 | Val  Acc: 0.8881
 Site-Real                      (3) | Val  Loss: 0.2471 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2816 | Val  Acc: 0.9153
 Site-Real                      (3) | Val  Loss: 0.2468 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.2398 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.2484 | Val  Acc: 0.9388
 Site-Painting                  (2) | Val  Loss: 0.3412 | Val  Acc: 0.9124
 Site-Painting                  (2) | Val  Loss: 0.3596 | Val  Acc: 0.8906
 Site-Sketch                    (5) | Val  Loss: 0.4382 | Val  Acc: 0.8819
 Site-Sketch                    (0) | Val  Loss: 0.6000 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 0.8967 | Val  Acc: 0.7615
 Site-Infograph                 (4) | Val  Loss: 0.9854 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8796
============ Train epoch 32 ============
cnt=[1, 5, 4, 3, 1, 2, ]
cnt=[5, 4, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (1) | Train Loss: 0.4955 | Train Acc: 0.8435
 Site-Clipart                   (1) | Train Loss: 0.3159 | Train Acc: 0.9317
 Site-Clipart                   (1) | Train Loss: 0.4713 | Train Acc: 0.8444
 Site-Clipart                   (1) | Train Loss: 0.4133 | Train Acc: 0.8797
 Site-Clipart                   (1) | Train Loss: 0.4100 | Train Acc: 0.8914
 Site-Real                      (2) | Train Loss: 0.3432 | Train Acc: 0.9286
 Site-Real                      (2) | Train Loss: 0.2085 | Train Acc: 0.9548
 Site-Real                      (2) | Train Loss: 0.2433 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.2788 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.3300 | Train Acc: 0.8912
 Site-Painting                  (3) | Train Loss: 0.4228 | Train Acc: 0.8835
 Site-Painting                  (3) | Train Loss: 0.3340 | Train Acc: 0.9239
 Site-Sketch                    (5) | Train Loss: 0.4846 | Train Acc: 0.8482
 Site-Sketch                    (5) | Train Loss: 0.5387 | Train Acc: 0.8539
 Site-QuickDraw                 (0) | Train Loss: 0.8310 | Train Acc: 0.7676
 Site-Infograph                 (4) | Train Loss: 1.0705 | Train Acc: 0.6368
Average Train Accuracy: 0.8729
 Site-Clipart                   (1) | Val  Loss: 0.2653 | Val  Acc: 0.9342
 Site-Clipart                   (1) | Val  Loss: 0.3458 | Val  Acc: 0.9159
 Site-Clipart                   (1) | Val  Loss: 0.3844 | Val  Acc: 0.8800
 Site-Clipart                   (1) | Val  Loss: 0.4380 | Val  Acc: 0.8571
 Site-Clipart                   (1) | Val  Loss: 0.4467 | Val  Acc: 0.8678
 Site-Real                      (2) | Val  Loss: 0.2712 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.2477 | Val  Acc: 0.9237
 Site-Real                      (2) | Val  Loss: 0.2420 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.2504 | Val  Acc: 0.9567
 Site-Painting                  (3) | Val  Loss: 0.2715 | Val  Acc: 0.9184
 Site-Painting                  (3) | Val  Loss: 0.3378 | Val  Acc: 0.9051
 Site-Painting                  (3) | Val  Loss: 0.3667 | Val  Acc: 0.9115
 Site-Sketch                    (5) | Val  Loss: 0.4623 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.4982 | Val  Acc: 0.8315
 Site-QuickDraw                 (0) | Val  Loss: 0.8662 | Val  Acc: 0.7294
 Site-Infograph                 (4) | Val  Loss: 1.0160 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8751
============ Train epoch 33 ============
cnt=[1, 4, 5, 3, 1, 2, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (2) | Train Loss: 0.4617 | Train Acc: 0.8348
 Site-Clipart                   (2) | Train Loss: 0.3354 | Train Acc: 0.9193
 Site-Clipart                   (2) | Train Loss: 0.4587 | Train Acc: 0.8711
 Site-Clipart                   (2) | Train Loss: 0.3951 | Train Acc: 0.8829
 Site-Clipart                   (2) | Train Loss: 0.3657 | Train Acc: 0.9140
 Site-Real                      (1) | Train Loss: 0.3300 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.1888 | Train Acc: 0.9661
 Site-Real                      (1) | Train Loss: 0.2259 | Train Acc: 0.9597
 Site-Real                      (1) | Train Loss: 0.2813 | Train Acc: 0.9368
 Site-Painting                  (3) | Train Loss: 0.4089 | Train Acc: 0.8980
 Site-Painting                  (3) | Train Loss: 0.3915 | Train Acc: 0.8883
 Site-Painting                  (3) | Train Loss: 0.3289 | Train Acc: 0.9377
 Site-Sketch                    (5) | Train Loss: 0.4661 | Train Acc: 0.8168
 Site-Sketch                    (5) | Train Loss: 0.4550 | Train Acc: 0.8652
 Site-QuickDraw                 (0) | Train Loss: 0.8103 | Train Acc: 0.7676
 Site-Infograph                 (4) | Train Loss: 0.9724 | Train Acc: 0.6966
Average Train Accuracy: 0.8787
 Site-Clipart                   (2) | Val  Loss: 0.2723 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.3166 | Val  Acc: 0.9159
 Site-Clipart                   (2) | Val  Loss: 0.3449 | Val  Acc: 0.9000
 Site-Clipart                   (2) | Val  Loss: 0.4103 | Val  Acc: 0.8619
 Site-Clipart                   (2) | Val  Loss: 0.4363 | Val  Acc: 0.8814
 Site-Real                      (1) | Val  Loss: 0.2438 | Val  Acc: 0.9286
 Site-Real                      (1) | Val  Loss: 0.2569 | Val  Acc: 0.9153
 Site-Real                      (1) | Val  Loss: 0.2656 | Val  Acc: 0.9273
 Site-Real                      (1) | Val  Loss: 0.2325 | Val  Acc: 0.9610
 Site-Painting                  (3) | Val  Loss: 0.2559 | Val  Acc: 0.9388
 Site-Painting                  (3) | Val  Loss: 0.3301 | Val  Acc: 0.9197
 Site-Painting                  (3) | Val  Loss: 0.3439 | Val  Acc: 0.8906
 Site-Sketch                    (5) | Val  Loss: 0.4105 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.5347 | Val  Acc: 0.8146
 Site-QuickDraw                 (0) | Val  Loss: 0.9085 | Val  Acc: 0.7661
 Site-Infograph                 (4) | Val  Loss: 0.9888 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8799
============ Train epoch 34 ============
cnt=[5, 1, 3, 4, 2, 1, ]
cnt=[2, 4, 1, 1, 3, 5, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (0) | Train Loss: 0.4006 | Train Acc: 0.8870
 Site-Clipart                   (0) | Train Loss: 0.2982 | Train Acc: 0.9503
 Site-Clipart                   (0) | Train Loss: 0.4547 | Train Acc: 0.8622
 Site-Clipart                   (0) | Train Loss: 0.3748 | Train Acc: 0.8861
 Site-Clipart                   (0) | Train Loss: 0.3999 | Train Acc: 0.8959
 Site-Real                      (3) | Train Loss: 0.3085 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2135 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2185 | Train Acc: 0.9516
 Site-Real                      (3) | Train Loss: 0.2617 | Train Acc: 0.9339
 Site-Painting                  (2) | Train Loss: 0.3953 | Train Acc: 0.8844
 Site-Painting                  (2) | Train Loss: 0.3210 | Train Acc: 0.9175
 Site-Painting                  (2) | Train Loss: 0.3396 | Train Acc: 0.9170
 Site-Sketch                    (4) | Train Loss: 0.4421 | Train Acc: 0.8639
 Site-Sketch                    (4) | Train Loss: 0.4249 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.7857 | Train Acc: 0.7951
 Site-Infograph                 (5) | Train Loss: 0.9633 | Train Acc: 0.7308
Average Train Accuracy: 0.8878
 Site-Clipart                   (0) | Val  Loss: 0.2415 | Val  Acc: 0.9474
 Site-Clipart                   (0) | Val  Loss: 0.3115 | Val  Acc: 0.9065
 Site-Clipart                   (0) | Val  Loss: 0.3923 | Val  Acc: 0.8867
 Site-Clipart                   (0) | Val  Loss: 0.4047 | Val  Acc: 0.8524
 Site-Clipart                   (0) | Val  Loss: 0.4527 | Val  Acc: 0.8780
 Site-Real                      (3) | Val  Loss: 0.2345 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2385 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2090 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.2324 | Val  Acc: 0.9437
 Site-Painting                  (2) | Val  Loss: 0.2489 | Val  Acc: 0.9184
 Site-Painting                  (2) | Val  Loss: 0.3028 | Val  Acc: 0.9270
 Site-Painting                  (2) | Val  Loss: 0.3153 | Val  Acc: 0.9323
 Site-Sketch                    (4) | Val  Loss: 0.4293 | Val  Acc: 0.8740
 Site-Sketch                    (4) | Val  Loss: 0.5198 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 0.8585 | Val  Acc: 0.7569
 Site-Infograph                 (5) | Val  Loss: 0.9839 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8865
 Best site-Clipart                  (0)  | Epoch:34 | Val Acc: 0.9474
 Best site-Clipart                  (0)  | Epoch:34 | Val Acc: 0.9065
 Best site-Clipart                  (0)  | Epoch:34 | Val Acc: 0.8867
 Best site-Clipart                  (0)  | Epoch:34 | Val Acc: 0.8524
 Best site-Clipart                  (0)  | Epoch:34 | Val Acc: 0.8780
 Best site-Real                     (3)  | Epoch:34 | Val Acc: 0.9286
 Best site-Real                     (3)  | Epoch:34 | Val Acc: 0.9322
 Best site-Real                     (3)  | Epoch:34 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:34 | Val Acc: 0.9437
 Best site-Painting                 (2)  | Epoch:34 | Val Acc: 0.9184
 Best site-Painting                 (2)  | Epoch:34 | Val Acc: 0.9270
 Best site-Painting                 (2)  | Epoch:34 | Val Acc: 0.9323
 Best site-Sketch                   (4)  | Epoch:34 | Val Acc: 0.8740
 Best site-Sketch                   (4)  | Epoch:34 | Val Acc: 0.8371
 Best site-QuickDraw                (1)  | Epoch:34 | Val Acc: 0.7569
 Best site-Infograph                (5)  | Epoch:34 | Val Acc: 0.7051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 35 ============
cnt=[1, 3, 5, 4, 1, 2, ]
cnt=[1, 4, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (2) | Train Loss: 0.4071 | Train Acc: 0.8609
 Site-Clipart                   (2) | Train Loss: 0.2998 | Train Acc: 0.9503
 Site-Clipart                   (2) | Train Loss: 0.4240 | Train Acc: 0.8756
 Site-Clipart                   (2) | Train Loss: 0.3702 | Train Acc: 0.8829
 Site-Clipart                   (2) | Train Loss: 0.3779 | Train Acc: 0.9005
 Site-Real                      (3) | Train Loss: 0.3136 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.1916 | Train Acc: 0.9661
 Site-Real                      (3) | Train Loss: 0.2262 | Train Acc: 0.9556
 Site-Real                      (3) | Train Loss: 0.2613 | Train Acc: 0.9425
 Site-Painting                  (1) | Train Loss: 0.3684 | Train Acc: 0.8980
 Site-Painting                  (1) | Train Loss: 0.3571 | Train Acc: 0.8932
 Site-Painting                  (1) | Train Loss: 0.3441 | Train Acc: 0.9100
 Site-Sketch                    (5) | Train Loss: 0.4390 | Train Acc: 0.8848
 Site-Sketch                    (5) | Train Loss: 0.4619 | Train Acc: 0.8427
 Site-QuickDraw                 (0) | Train Loss: 0.6894 | Train Acc: 0.8104
 Site-Infograph                 (4) | Train Loss: 0.9869 | Train Acc: 0.6838
Average Train Accuracy: 0.8861
 Site-Clipart                   (2) | Val  Loss: 0.2462 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.3267 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.3468 | Val  Acc: 0.8800
 Site-Clipart                   (2) | Val  Loss: 0.3532 | Val  Acc: 0.8952
 Site-Clipart                   (2) | Val  Loss: 0.4626 | Val  Acc: 0.8712
 Site-Real                      (3) | Val  Loss: 0.2439 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2584 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.2232 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.2046 | Val  Acc: 0.9610
 Site-Painting                  (1) | Val  Loss: 0.2146 | Val  Acc: 0.9592
 Site-Painting                  (1) | Val  Loss: 0.3476 | Val  Acc: 0.8832
 Site-Painting                  (1) | Val  Loss: 0.3377 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.4673 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.5388 | Val  Acc: 0.7978
 Site-QuickDraw                 (0) | Val  Loss: 0.8579 | Val  Acc: 0.7798
 Site-Infograph                 (4) | Val  Loss: 0.9800 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8820
============ Train epoch 36 ============
cnt=[5, 1, 1, 4, 3, 2, ]
cnt=[4, 3, 1, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (0) | Train Loss: 0.5106 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.3003 | Train Acc: 0.9441
 Site-Clipart                   (0) | Train Loss: 0.4300 | Train Acc: 0.8800
 Site-Clipart                   (0) | Train Loss: 0.3643 | Train Acc: 0.9082
 Site-Clipart                   (0) | Train Loss: 0.3645 | Train Acc: 0.9027
 Site-Real                      (3) | Train Loss: 0.3071 | Train Acc: 0.9286
 Site-Real                      (3) | Train Loss: 0.2055 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2263 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.2679 | Train Acc: 0.9425
 Site-Painting                  (4) | Train Loss: 0.3736 | Train Acc: 0.8707
 Site-Painting                  (4) | Train Loss: 0.3889 | Train Acc: 0.9029
 Site-Painting                  (4) | Train Loss: 0.3081 | Train Acc: 0.9204
 Site-Sketch                    (5) | Train Loss: 0.4300 | Train Acc: 0.8691
 Site-Sketch                    (5) | Train Loss: 0.4763 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.7603 | Train Acc: 0.8073
 Site-Infograph                 (2) | Train Loss: 0.9610 | Train Acc: 0.6752
Average Train Accuracy: 0.8847
 Site-Clipart                   (0) | Val  Loss: 0.2452 | Val  Acc: 0.9474
 Site-Clipart                   (0) | Val  Loss: 0.3260 | Val  Acc: 0.8879
 Site-Clipart                   (0) | Val  Loss: 0.3640 | Val  Acc: 0.8933
 Site-Clipart                   (0) | Val  Loss: 0.3906 | Val  Acc: 0.8905
 Site-Clipart                   (0) | Val  Loss: 0.4595 | Val  Acc: 0.8644
 Site-Real                      (3) | Val  Loss: 0.2475 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2915 | Val  Acc: 0.9153
 Site-Real                      (3) | Val  Loss: 0.2420 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.2153 | Val  Acc: 0.9610
 Site-Painting                  (4) | Val  Loss: 0.2609 | Val  Acc: 0.9388
 Site-Painting                  (4) | Val  Loss: 0.3684 | Val  Acc: 0.8905
 Site-Painting                  (4) | Val  Loss: 0.3388 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.4364 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.4791 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 0.8748 | Val  Acc: 0.7294
 Site-Infograph                 (2) | Val  Loss: 0.9957 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8814
============ Train epoch 37 ============
cnt=[4, 1, 3, 4, 1, 3, ]
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (5) | Train Loss: 0.4154 | Train Acc: 0.8783
 Site-Clipart                   (0) | Train Loss: 0.3362 | Train Acc: 0.9193
 Site-Clipart                   (0) | Train Loss: 0.4043 | Train Acc: 0.8800
 Site-Clipart                   (0) | Train Loss: 0.3902 | Train Acc: 0.8924
 Site-Clipart                   (0) | Train Loss: 0.3683 | Train Acc: 0.8937
 Site-Real                      (3) | Train Loss: 0.3248 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.1946 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2039 | Train Acc: 0.9516
 Site-Real                      (3) | Train Loss: 0.2848 | Train Acc: 0.9339
 Site-Painting                  (2) | Train Loss: 0.3784 | Train Acc: 0.8912
 Site-Painting                  (2) | Train Loss: 0.2876 | Train Acc: 0.9078
 Site-Painting                  (2) | Train Loss: 0.2912 | Train Acc: 0.9377
 Site-Sketch                    (5) | Train Loss: 0.4499 | Train Acc: 0.8482
 Site-Sketch                    (5) | Train Loss: 0.4638 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.7907 | Train Acc: 0.7737
 Site-Infograph                 (4) | Train Loss: 0.9569 | Train Acc: 0.6880
Average Train Accuracy: 0.8829
 Site-Clipart                   (5) | Val  Loss: 0.2814 | Val  Acc: 0.8947
 Site-Clipart                   (0) | Val  Loss: 0.3190 | Val  Acc: 0.9159
 Site-Clipart                   (0) | Val  Loss: 0.3185 | Val  Acc: 0.9133
 Site-Clipart                   (0) | Val  Loss: 0.4050 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.4599 | Val  Acc: 0.8644
 Site-Real                      (3) | Val  Loss: 0.2662 | Val  Acc: 0.9167
 Site-Real                      (3) | Val  Loss: 0.2456 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2318 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.2202 | Val  Acc: 0.9654
 Site-Painting                  (2) | Val  Loss: 0.2345 | Val  Acc: 0.9592
 Site-Painting                  (2) | Val  Loss: 0.3112 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.3180 | Val  Acc: 0.9167
 Site-Sketch                    (5) | Val  Loss: 0.4177 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.5266 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 0.8250 | Val  Acc: 0.7523
 Site-Infograph                 (4) | Val  Loss: 0.9119 | Val  Acc: 0.7244
Average Valid Accuracy: 0.8880
 Best site-Clipart                  (5)  | Epoch:37 | Val Acc: 0.8947
 Best site-Clipart                  (0)  | Epoch:37 | Val Acc: 0.9159
 Best site-Clipart                  (0)  | Epoch:37 | Val Acc: 0.9133
 Best site-Clipart                  (0)  | Epoch:37 | Val Acc: 0.8667
 Best site-Clipart                  (0)  | Epoch:37 | Val Acc: 0.8644
 Best site-Real                     (3)  | Epoch:37 | Val Acc: 0.9167
 Best site-Real                     (3)  | Epoch:37 | Val Acc: 0.9322
 Best site-Real                     (3)  | Epoch:37 | Val Acc: 0.9394
 Best site-Real                     (3)  | Epoch:37 | Val Acc: 0.9654
 Best site-Painting                 (2)  | Epoch:37 | Val Acc: 0.9592
 Best site-Painting                 (2)  | Epoch:37 | Val Acc: 0.9197
 Best site-Painting                 (2)  | Epoch:37 | Val Acc: 0.9167
 Best site-Sketch                   (5)  | Epoch:37 | Val Acc: 0.8898
 Best site-Sketch                   (5)  | Epoch:37 | Val Acc: 0.8371
 Best site-QuickDraw                (1)  | Epoch:37 | Val Acc: 0.7523
 Best site-Infograph                (4)  | Epoch:37 | Val Acc: 0.7244
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 38 ============
cnt=[4, 1, 5, 3, 1, 2, ]
cnt=[2, 4, 1, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (2) | Train Loss: 0.4004 | Train Acc: 0.8870
 Site-Clipart                   (2) | Train Loss: 0.2829 | Train Acc: 0.9068
 Site-Clipart                   (2) | Train Loss: 0.4309 | Train Acc: 0.8844
 Site-Clipart                   (2) | Train Loss: 0.3578 | Train Acc: 0.8861
 Site-Clipart                   (2) | Train Loss: 0.3904 | Train Acc: 0.8914
 Site-Real                      (0) | Train Loss: 0.2999 | Train Acc: 0.9286
 Site-Real                      (0) | Train Loss: 0.1987 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2305 | Train Acc: 0.9435
 Site-Real                      (0) | Train Loss: 0.2406 | Train Acc: 0.9540
 Site-Painting                  (3) | Train Loss: 0.3618 | Train Acc: 0.8707
 Site-Painting                  (3) | Train Loss: 0.3732 | Train Acc: 0.8883
 Site-Painting                  (3) | Train Loss: 0.3016 | Train Acc: 0.9204
 Site-Sketch                    (5) | Train Loss: 0.4420 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.4697 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.7107 | Train Acc: 0.8104
 Site-Infograph                 (4) | Train Loss: 0.9717 | Train Acc: 0.6966
Average Train Accuracy: 0.8824
 Site-Clipart                   (2) | Val  Loss: 0.2134 | Val  Acc: 0.9342
 Site-Clipart                   (2) | Val  Loss: 0.3446 | Val  Acc: 0.9252
 Site-Clipart                   (2) | Val  Loss: 0.3355 | Val  Acc: 0.9200
 Site-Clipart                   (2) | Val  Loss: 0.3875 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.4408 | Val  Acc: 0.8915
 Site-Real                      (0) | Val  Loss: 0.2258 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2313 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2186 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.1975 | Val  Acc: 0.9654
 Site-Painting                  (3) | Val  Loss: 0.2058 | Val  Acc: 0.9490
 Site-Painting                  (3) | Val  Loss: 0.3203 | Val  Acc: 0.9124
 Site-Painting                  (3) | Val  Loss: 0.3010 | Val  Acc: 0.9323
 Site-Sketch                    (5) | Val  Loss: 0.4267 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.4770 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.8208 | Val  Acc: 0.7798
 Site-Infograph                 (4) | Val  Loss: 0.9323 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8948
 Best site-Clipart                  (2)  | Epoch:38 | Val Acc: 0.9342
 Best site-Clipart                  (2)  | Epoch:38 | Val Acc: 0.9252
 Best site-Clipart                  (2)  | Epoch:38 | Val Acc: 0.9200
 Best site-Clipart                  (2)  | Epoch:38 | Val Acc: 0.8667
 Best site-Clipart                  (2)  | Epoch:38 | Val Acc: 0.8915
 Best site-Real                     (0)  | Epoch:38 | Val Acc: 0.9405
 Best site-Real                     (0)  | Epoch:38 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:38 | Val Acc: 0.9333
 Best site-Real                     (0)  | Epoch:38 | Val Acc: 0.9654
 Best site-Painting                 (3)  | Epoch:38 | Val Acc: 0.9490
 Best site-Painting                 (3)  | Epoch:38 | Val Acc: 0.9124
 Best site-Painting                 (3)  | Epoch:38 | Val Acc: 0.9323
 Best site-Sketch                   (5)  | Epoch:38 | Val Acc: 0.8661
 Best site-Sketch                   (5)  | Epoch:38 | Val Acc: 0.8483
 Best site-QuickDraw                (1)  | Epoch:38 | Val Acc: 0.7798
 Best site-Infograph                (4)  | Epoch:38 | Val Acc: 0.7115
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 39 ============
cnt=[3, 1, 5, 4, 1, 2, ]
cnt=[5, 1, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (2) | Train Loss: 0.3948 | Train Acc: 0.8783
 Site-Clipart                   (2) | Train Loss: 0.2560 | Train Acc: 0.9503
 Site-Clipart                   (2) | Train Loss: 0.4188 | Train Acc: 0.8844
 Site-Clipart                   (2) | Train Loss: 0.3677 | Train Acc: 0.8924
 Site-Clipart                   (2) | Train Loss: 0.3574 | Train Acc: 0.9276
 Site-Real                      (3) | Train Loss: 0.3305 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.2013 | Train Acc: 0.9661
 Site-Real                      (3) | Train Loss: 0.2283 | Train Acc: 0.9395
 Site-Real                      (3) | Train Loss: 0.2487 | Train Acc: 0.9425
 Site-Painting                  (0) | Train Loss: 0.3560 | Train Acc: 0.8776
 Site-Painting                  (0) | Train Loss: 0.3164 | Train Acc: 0.9126
 Site-Painting                  (0) | Train Loss: 0.2976 | Train Acc: 0.9343
 Site-Sketch                    (5) | Train Loss: 0.3916 | Train Acc: 0.8901
 Site-Sketch                    (5) | Train Loss: 0.4819 | Train Acc: 0.8464
 Site-QuickDraw                 (1) | Train Loss: 0.7274 | Train Acc: 0.8043
 Site-Infograph                 (4) | Train Loss: 0.9293 | Train Acc: 0.7137
Average Train Accuracy: 0.8925
 Site-Clipart                   (2) | Val  Loss: 0.2196 | Val  Acc: 0.9474
 Site-Clipart                   (2) | Val  Loss: 0.3181 | Val  Acc: 0.9346
 Site-Clipart                   (2) | Val  Loss: 0.3408 | Val  Acc: 0.9000
 Site-Clipart                   (2) | Val  Loss: 0.3875 | Val  Acc: 0.8905
 Site-Clipart                   (2) | Val  Loss: 0.4478 | Val  Acc: 0.8576
 Site-Real                      (3) | Val  Loss: 0.2369 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2674 | Val  Acc: 0.9237
 Site-Real                      (3) | Val  Loss: 0.2166 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.2282 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.1958 | Val  Acc: 0.9694
 Site-Painting                  (0) | Val  Loss: 0.3102 | Val  Acc: 0.9343
 Site-Painting                  (0) | Val  Loss: 0.3583 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.4057 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.5124 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.8575 | Val  Acc: 0.7569
 Site-Infograph                 (4) | Val  Loss: 0.9542 | Val  Acc: 0.7244
Average Valid Accuracy: 0.8916
============ Train epoch 40 ============
cnt=[1, 1, 2, 3, 4, 5, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (5) | Train Loss: 0.4026 | Train Acc: 0.8696
 Site-Clipart                   (5) | Train Loss: 0.2972 | Train Acc: 0.9193
 Site-Clipart                   (5) | Train Loss: 0.3967 | Train Acc: 0.8978
 Site-Clipart                   (5) | Train Loss: 0.3735 | Train Acc: 0.8829
 Site-Clipart                   (5) | Train Loss: 0.3443 | Train Acc: 0.9253
 Site-Real                      (4) | Train Loss: 0.3300 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.1829 | Train Acc: 0.9661
 Site-Real                      (4) | Train Loss: 0.2001 | Train Acc: 0.9516
 Site-Real                      (4) | Train Loss: 0.2619 | Train Acc: 0.9425
 Site-Painting                  (3) | Train Loss: 0.4770 | Train Acc: 0.8912
 Site-Painting                  (3) | Train Loss: 0.3669 | Train Acc: 0.9223
 Site-Painting                  (3) | Train Loss: 0.2916 | Train Acc: 0.9204
 Site-Sketch                    (2) | Train Loss: 0.4240 | Train Acc: 0.8639
 Site-Sketch                    (2) | Train Loss: 0.4349 | Train Acc: 0.8464
 Site-QuickDraw                 (1) | Train Loss: 0.6931 | Train Acc: 0.8502
 Site-Infograph                 (0) | Train Loss: 0.9347 | Train Acc: 0.6709
Average Train Accuracy: 0.8901
 Site-Clipart                   (5) | Val  Loss: 0.2452 | Val  Acc: 0.9079
 Site-Clipart                   (5) | Val  Loss: 0.3045 | Val  Acc: 0.9159
 Site-Clipart                   (5) | Val  Loss: 0.2817 | Val  Acc: 0.9267
 Site-Clipart                   (5) | Val  Loss: 0.3879 | Val  Acc: 0.8714
 Site-Clipart                   (5) | Val  Loss: 0.4384 | Val  Acc: 0.8746
 Site-Real                      (4) | Val  Loss: 0.2331 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2117 | Val  Acc: 0.9576
 Site-Real                      (4) | Val  Loss: 0.2227 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.1968 | Val  Acc: 0.9697
 Site-Painting                  (3) | Val  Loss: 0.2550 | Val  Acc: 0.9184
 Site-Painting                  (3) | Val  Loss: 0.3088 | Val  Acc: 0.9343
 Site-Painting                  (3) | Val  Loss: 0.3411 | Val  Acc: 0.9010
 Site-Sketch                    (2) | Val  Loss: 0.4022 | Val  Acc: 0.8583
 Site-Sketch                    (2) | Val  Loss: 0.5355 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 0.7976 | Val  Acc: 0.7752
 Site-Infograph                 (0) | Val  Loss: 0.9333 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8880
 Test site-Clipart                   (5)| Epoch:38 | Test Acc: 0.8935
 Test site-Real                      (4)| Epoch:38 | Test Acc: 0.9417
 Test site-Painting                  (3)| Epoch:38 | Test Acc: 0.9418
 Test site-Sketch                    (2)| Epoch:38 | Test Acc: 0.8809
 Test site-QuickDraw                 (1)| Epoch:38 | Test Acc: 0.7560
 Test site-Infograph                 (0)| Epoch:38 | Test Acc: 0.5662
Clipart: 0.8935, Real: 0.9417, Painting: 0.9418, Sketch: 0.8809, QuickDraw: 0.7560, Infograph: 0.5662, 
Average Test Accuracy(group): 0.8300, Average Test Accuracy(individual): 0.8840,
domain std=0.1333, cluster std=0.1333, individual std=0.0939, 
Average Test Accuracy: 0.8300
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 41 ============
cnt=[3, 1, 5, 1, 4, 2, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                   (2) | Train Loss: 0.3658 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.3040 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.3910 | Train Acc: 0.8889
 Site-Clipart                   (2) | Train Loss: 0.3744 | Train Acc: 0.8734
 Site-Clipart                   (2) | Train Loss: 0.3461 | Train Acc: 0.8982
 Site-Real                      (4) | Train Loss: 0.3089 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.2039 | Train Acc: 0.9661
 Site-Real                      (4) | Train Loss: 0.1896 | Train Acc: 0.9718
 Site-Real                      (4) | Train Loss: 0.2352 | Train Acc: 0.9483
 Site-Painting                  (0) | Train Loss: 0.3394 | Train Acc: 0.8980
 Site-Painting                  (0) | Train Loss: 0.2790 | Train Acc: 0.9223
 Site-Painting                  (0) | Train Loss: 0.2678 | Train Acc: 0.9446
 Site-Sketch                    (5) | Train Loss: 0.4182 | Train Acc: 0.8691
 Site-Sketch                    (5) | Train Loss: 0.3999 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.7227 | Train Acc: 0.7737
 Site-Infograph                 (3) | Train Loss: 0.9205 | Train Acc: 0.7094
Average Train Accuracy: 0.8928
 Site-Clipart                   (2) | Val  Loss: 0.2347 | Val  Acc: 0.9474
 Site-Clipart                   (2) | Val  Loss: 0.3067 | Val  Acc: 0.9159
 Site-Clipart                   (2) | Val  Loss: 0.3474 | Val  Acc: 0.8867
 Site-Clipart                   (2) | Val  Loss: 0.3711 | Val  Acc: 0.8810
 Site-Clipart                   (2) | Val  Loss: 0.4351 | Val  Acc: 0.8780
 Site-Real                      (4) | Val  Loss: 0.2284 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.2107 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.2200 | Val  Acc: 0.9455
 Site-Real                      (4) | Val  Loss: 0.2067 | Val  Acc: 0.9610
 Site-Painting                  (0) | Val  Loss: 0.2289 | Val  Acc: 0.9388
 Site-Painting                  (0) | Val  Loss: 0.3084 | Val  Acc: 0.9197
 Site-Painting                  (0) | Val  Loss: 0.3255 | Val  Acc: 0.9271
 Site-Sketch                    (5) | Val  Loss: 0.3596 | Val  Acc: 0.9134
 Site-Sketch                    (5) | Val  Loss: 0.4962 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.8009 | Val  Acc: 0.8028
 Site-Infograph                 (3) | Val  Loss: 0.9320 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8960
 Best site-Clipart                  (2)  | Epoch:41 | Val Acc: 0.9474
 Best site-Clipart                  (2)  | Epoch:41 | Val Acc: 0.9159
 Best site-Clipart                  (2)  | Epoch:41 | Val Acc: 0.8867
 Best site-Clipart                  (2)  | Epoch:41 | Val Acc: 0.8810
 Best site-Clipart                  (2)  | Epoch:41 | Val Acc: 0.8780
 Best site-Real                     (4)  | Epoch:41 | Val Acc: 0.9405
 Best site-Real                     (4)  | Epoch:41 | Val Acc: 0.9407
 Best site-Real                     (4)  | Epoch:41 | Val Acc: 0.9455
 Best site-Real                     (4)  | Epoch:41 | Val Acc: 0.9610
 Best site-Painting                 (0)  | Epoch:41 | Val Acc: 0.9388
 Best site-Painting                 (0)  | Epoch:41 | Val Acc: 0.9197
 Best site-Painting                 (0)  | Epoch:41 | Val Acc: 0.9271
 Best site-Sketch                   (5)  | Epoch:41 | Val Acc: 0.9134
 Best site-Sketch                   (5)  | Epoch:41 | Val Acc: 0.8202
 Best site-QuickDraw                (1)  | Epoch:41 | Val Acc: 0.8028
 Best site-Infograph                (3)  | Epoch:41 | Val Acc: 0.7179
 Test site-Clipart                   (2)| Epoch:41 | Test Acc: 0.8973
 Test site-Real                      (4)| Epoch:41 | Test Acc: 0.9425
 Test site-Painting                  (0)| Epoch:41 | Test Acc: 0.9354
 Test site-Sketch                    (5)| Epoch:41 | Test Acc: 0.8791
 Test site-QuickDraw                 (1)| Epoch:41 | Test Acc: 0.7540
 Test site-Infograph                 (3)| Epoch:41 | Test Acc: 0.5677
Clipart: 0.8973, Real: 0.9425, Painting: 0.9354, Sketch: 0.8791, QuickDraw: 0.7540, Infograph: 0.5677, 
Average Test Accuracy(group): 0.8293, Average Test Accuracy(individual): 0.8839,
domain std=0.1324, cluster std=0.1324, individual std=0.0934, 
Average Test Accuracy: 0.8293
============ Train epoch 42 ============
cnt=[4, 1, 5, 1, 3, 2, ]
cnt=[5, 1, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                   (2) | Train Loss: 0.4452 | Train Acc: 0.8870
 Site-Clipart                   (2) | Train Loss: 0.2795 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.4318 | Train Acc: 0.8844
 Site-Clipart                   (2) | Train Loss: 0.3315 | Train Acc: 0.9019
 Site-Clipart                   (2) | Train Loss: 0.3305 | Train Acc: 0.9095
 Site-Real                      (0) | Train Loss: 0.3088 | Train Acc: 0.9206
 Site-Real                      (0) | Train Loss: 0.1740 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2314 | Train Acc: 0.9395
 Site-Real                      (0) | Train Loss: 0.2603 | Train Acc: 0.9511
 Site-Painting                  (4) | Train Loss: 0.3026 | Train Acc: 0.9184
 Site-Painting                  (4) | Train Loss: 0.4306 | Train Acc: 0.9175
 Site-Painting                  (4) | Train Loss: 0.2960 | Train Acc: 0.9239
 Site-Sketch                    (5) | Train Loss: 0.4031 | Train Acc: 0.9005
 Site-Sketch                    (5) | Train Loss: 0.4357 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.7003 | Train Acc: 0.8043
 Site-Infograph                 (3) | Train Loss: 0.8914 | Train Acc: 0.7094
Average Train Accuracy: 0.8948
 Site-Clipart                   (2) | Val  Loss: 0.2403 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.3129 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.3071 | Val  Acc: 0.9133
 Site-Clipart                   (2) | Val  Loss: 0.3315 | Val  Acc: 0.8905
 Site-Clipart                   (2) | Val  Loss: 0.4257 | Val  Acc: 0.8678
 Site-Real                      (0) | Val  Loss: 0.2226 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.1965 | Val  Acc: 0.9492
 Site-Real                      (0) | Val  Loss: 0.2250 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2168 | Val  Acc: 0.9567
 Site-Painting                  (4) | Val  Loss: 0.2055 | Val  Acc: 0.9592
 Site-Painting                  (4) | Val  Loss: 0.3192 | Val  Acc: 0.9051
 Site-Painting                  (4) | Val  Loss: 0.3085 | Val  Acc: 0.9219
 Site-Sketch                    (5) | Val  Loss: 0.4338 | Val  Acc: 0.8740
 Site-Sketch                    (5) | Val  Loss: 0.4846 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 0.7653 | Val  Acc: 0.7844
 Site-Infograph                 (3) | Val  Loss: 0.9557 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8917
 Test site-Clipart                   (2)| Epoch:41 | Test Acc: 0.9011
 Test site-Real                      (0)| Epoch:41 | Test Acc: 0.9441
 Test site-Painting                  (4)| Epoch:41 | Test Acc: 0.9338
 Test site-Sketch                    (5)| Epoch:41 | Test Acc: 0.8899
 Test site-QuickDraw                 (1)| Epoch:41 | Test Acc: 0.7520
 Test site-Infograph                 (3)| Epoch:41 | Test Acc: 0.5723
Clipart: 0.9011, Real: 0.9441, Painting: 0.9338, Sketch: 0.8899, QuickDraw: 0.7520, Infograph: 0.5723, 
Average Test Accuracy(group): 0.8322, Average Test Accuracy(individual): 0.8867,
domain std=0.1322, cluster std=0.1322, individual std=0.0928, 
Average Test Accuracy: 0.8322
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 43 ============
cnt=[1, 1, 4, 4, 3, 3, ]
cnt=[2, 4, 5, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                   (5) | Train Loss: 0.4239 | Train Acc: 0.8783
 Site-Clipart                   (2) | Train Loss: 0.2899 | Train Acc: 0.9193
 Site-Clipart                   (2) | Train Loss: 0.3913 | Train Acc: 0.8844
 Site-Clipart                   (2) | Train Loss: 0.3477 | Train Acc: 0.8987
 Site-Clipart                   (2) | Train Loss: 0.3416 | Train Acc: 0.9118
 Site-Real                      (3) | Train Loss: 0.3300 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.1773 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2152 | Train Acc: 0.9395
 Site-Real                      (3) | Train Loss: 0.2404 | Train Acc: 0.9483
 Site-Painting                  (4) | Train Loss: 0.3607 | Train Acc: 0.9184
 Site-Painting                  (4) | Train Loss: 0.2561 | Train Acc: 0.9223
 Site-Painting                  (4) | Train Loss: 0.2865 | Train Acc: 0.9308
 Site-Sketch                    (5) | Train Loss: 0.3829 | Train Acc: 0.8848
 Site-Sketch                    (5) | Train Loss: 0.4878 | Train Acc: 0.8464
 Site-QuickDraw                 (1) | Train Loss: 0.6519 | Train Acc: 0.8135
 Site-Infograph                 (0) | Train Loss: 0.8868 | Train Acc: 0.7350
Average Train Accuracy: 0.8937
 Site-Clipart                   (5) | Val  Loss: 0.2777 | Val  Acc: 0.8947
 Site-Clipart                   (2) | Val  Loss: 0.3401 | Val  Acc: 0.8879
 Site-Clipart                   (2) | Val  Loss: 0.3122 | Val  Acc: 0.9133
 Site-Clipart                   (2) | Val  Loss: 0.3707 | Val  Acc: 0.9000
 Site-Clipart                   (2) | Val  Loss: 0.4215 | Val  Acc: 0.8644
 Site-Real                      (3) | Val  Loss: 0.2379 | Val  Acc: 0.9167
 Site-Real                      (3) | Val  Loss: 0.2326 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.2044 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.2074 | Val  Acc: 0.9610
 Site-Painting                  (4) | Val  Loss: 0.1890 | Val  Acc: 0.9490
 Site-Painting                  (4) | Val  Loss: 0.3062 | Val  Acc: 0.8978
 Site-Painting                  (4) | Val  Loss: 0.3053 | Val  Acc: 0.9167
 Site-Sketch                    (5) | Val  Loss: 0.4082 | Val  Acc: 0.8819
 Site-Sketch                    (5) | Val  Loss: 0.4848 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.8099 | Val  Acc: 0.7615
 Site-Infograph                 (0) | Val  Loss: 0.9121 | Val  Acc: 0.7308
Average Valid Accuracy: 0.8867
 Test site-Clipart                   (5)| Epoch:42 | Test Acc: 0.9030
 Test site-Real                      (3)| Epoch:42 | Test Acc: 0.9449
 Test site-Painting                  (4)| Epoch:42 | Test Acc: 0.9338
 Test site-Sketch                    (5)| Epoch:42 | Test Acc: 0.8863
 Test site-QuickDraw                 (1)| Epoch:42 | Test Acc: 0.7420
 Test site-Infograph                 (0)| Epoch:42 | Test Acc: 0.5693
Clipart: 0.9030, Real: 0.9449, Painting: 0.9338, Sketch: 0.8863, QuickDraw: 0.7420, Infograph: 0.5693, 
Average Test Accuracy(group): 0.8299, Average Test Accuracy(individual): 0.8863,
domain std=0.1343, cluster std=0.1347, individual std=0.0946, 
Average Test Accuracy: 0.8299
============ Train epoch 44 ============
cnt=[4, 1, 4, 1, 3, 3, ]
cnt=[4, 1, 5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                   (5) | Train Loss: 0.4321 | Train Acc: 0.8522
 Site-Clipart                   (2) | Train Loss: 0.2975 | Train Acc: 0.9441
 Site-Clipart                   (2) | Train Loss: 0.4127 | Train Acc: 0.8933
 Site-Clipart                   (2) | Train Loss: 0.3677 | Train Acc: 0.8671
 Site-Clipart                   (2) | Train Loss: 0.3445 | Train Acc: 0.9072
 Site-Real                      (0) | Train Loss: 0.2952 | Train Acc: 0.9286
 Site-Real                      (0) | Train Loss: 0.1901 | Train Acc: 0.9718
 Site-Real                      (0) | Train Loss: 0.1999 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2293 | Train Acc: 0.9511
 Site-Painting                  (4) | Train Loss: 0.3473 | Train Acc: 0.8503
 Site-Painting                  (4) | Train Loss: 0.3399 | Train Acc: 0.9029
 Site-Painting                  (4) | Train Loss: 0.2727 | Train Acc: 0.9343
 Site-Sketch                    (5) | Train Loss: 0.4288 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.4029 | Train Acc: 0.8539
 Site-QuickDraw                 (1) | Train Loss: 0.6611 | Train Acc: 0.8104
 Site-Infograph                 (3) | Train Loss: 0.8664 | Train Acc: 0.7222
Average Train Accuracy: 0.8875
 Site-Clipart                   (5) | Val  Loss: 0.2085 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.3123 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.3070 | Val  Acc: 0.9133
 Site-Clipart                   (2) | Val  Loss: 0.3403 | Val  Acc: 0.8952
 Site-Clipart                   (2) | Val  Loss: 0.3974 | Val  Acc: 0.8847
 Site-Real                      (0) | Val  Loss: 0.2307 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2296 | Val  Acc: 0.9237
 Site-Real                      (0) | Val  Loss: 0.1960 | Val  Acc: 0.9455
 Site-Real                      (0) | Val  Loss: 0.2135 | Val  Acc: 0.9610
 Site-Painting                  (4) | Val  Loss: 0.1803 | Val  Acc: 0.9592
 Site-Painting                  (4) | Val  Loss: 0.2950 | Val  Acc: 0.9197
 Site-Painting                  (4) | Val  Loss: 0.3039 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.3606 | Val  Acc: 0.8740
 Site-Sketch                    (5) | Val  Loss: 0.5271 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 0.7921 | Val  Acc: 0.7936
 Site-Infograph                 (3) | Val  Loss: 0.9459 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8894
 Test site-Clipart                   (5)| Epoch:42 | Test Acc: 0.9068
 Test site-Real                      (0)| Epoch:42 | Test Acc: 0.9466
 Test site-Painting                  (4)| Epoch:42 | Test Acc: 0.9386
 Test site-Sketch                    (5)| Epoch:42 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:42 | Test Acc: 0.7470
 Test site-Infograph                 (3)| Epoch:42 | Test Acc: 0.5769
Clipart: 0.9068, Real: 0.9466, Painting: 0.9386, Sketch: 0.8917, QuickDraw: 0.7470, Infograph: 0.5769, 
Average Test Accuracy(group): 0.8346, Average Test Accuracy(individual): 0.8902,
domain std=0.1329, cluster std=0.1333, individual std=0.0935, 
Average Test Accuracy: 0.8346
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 45 ============
cnt=[3, 1, 5, 1, 4, 2, ]
cnt=[3, 1, 5, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                   (2) | Train Loss: 0.3679 | Train Acc: 0.8522
 Site-Clipart                   (2) | Train Loss: 0.2979 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.4075 | Train Acc: 0.8667
 Site-Clipart                   (2) | Train Loss: 0.3623 | Train Acc: 0.8892
 Site-Clipart                   (2) | Train Loss: 0.3299 | Train Acc: 0.9208
 Site-Real                      (4) | Train Loss: 0.2909 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.1908 | Train Acc: 0.9661
 Site-Real                      (4) | Train Loss: 0.2151 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2827 | Train Acc: 0.9339
 Site-Painting                  (0) | Train Loss: 0.3810 | Train Acc: 0.9252
 Site-Painting                  (0) | Train Loss: 0.3463 | Train Acc: 0.9223
 Site-Painting                  (0) | Train Loss: 0.2892 | Train Acc: 0.9308
 Site-Sketch                    (5) | Train Loss: 0.4104 | Train Acc: 0.8691
 Site-Sketch                    (5) | Train Loss: 0.4354 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 0.6491 | Train Acc: 0.8073
 Site-Infograph                 (3) | Train Loss: 0.8320 | Train Acc: 0.7564
Average Train Accuracy: 0.8927
 Site-Clipart                   (2) | Val  Loss: 0.2557 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.2733 | Val  Acc: 0.9346
 Site-Clipart                   (2) | Val  Loss: 0.3037 | Val  Acc: 0.9200
 Site-Clipart                   (2) | Val  Loss: 0.3549 | Val  Acc: 0.8952
 Site-Clipart                   (2) | Val  Loss: 0.3686 | Val  Acc: 0.9119
 Site-Real                      (4) | Val  Loss: 0.2271 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2288 | Val  Acc: 0.9322
 Site-Real                      (4) | Val  Loss: 0.1885 | Val  Acc: 0.9576
 Site-Real                      (4) | Val  Loss: 0.2028 | Val  Acc: 0.9567
 Site-Painting                  (0) | Val  Loss: 0.2533 | Val  Acc: 0.9388
 Site-Painting                  (0) | Val  Loss: 0.2545 | Val  Acc: 0.9124
 Site-Painting                  (0) | Val  Loss: 0.2936 | Val  Acc: 0.9219
 Site-Sketch                    (5) | Val  Loss: 0.3125 | Val  Acc: 0.9213
 Site-Sketch                    (5) | Val  Loss: 0.4522 | Val  Acc: 0.8596
 Site-QuickDraw                 (1) | Val  Loss: 0.7950 | Val  Acc: 0.7706
 Site-Infograph                 (3) | Val  Loss: 0.9300 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9000
 Best site-Clipart                  (2)  | Epoch:45 | Val Acc: 0.9211
 Best site-Clipart                  (2)  | Epoch:45 | Val Acc: 0.9346
 Best site-Clipart                  (2)  | Epoch:45 | Val Acc: 0.9200
 Best site-Clipart                  (2)  | Epoch:45 | Val Acc: 0.8952
 Best site-Clipart                  (2)  | Epoch:45 | Val Acc: 0.9119
 Best site-Real                     (4)  | Epoch:45 | Val Acc: 0.9286
 Best site-Real                     (4)  | Epoch:45 | Val Acc: 0.9322
 Best site-Real                     (4)  | Epoch:45 | Val Acc: 0.9576
 Best site-Real                     (4)  | Epoch:45 | Val Acc: 0.9567
 Best site-Painting                 (0)  | Epoch:45 | Val Acc: 0.9388
 Best site-Painting                 (0)  | Epoch:45 | Val Acc: 0.9124
 Best site-Painting                 (0)  | Epoch:45 | Val Acc: 0.9219
 Best site-Sketch                   (5)  | Epoch:45 | Val Acc: 0.9213
 Best site-Sketch                   (5)  | Epoch:45 | Val Acc: 0.8596
 Best site-QuickDraw                (1)  | Epoch:45 | Val Acc: 0.7706
 Best site-Infograph                (3)  | Epoch:45 | Val Acc: 0.7179
 Test site-Clipart                   (2)| Epoch:45 | Test Acc: 0.9106
 Test site-Real                      (4)| Epoch:45 | Test Acc: 0.9449
 Test site-Painting                  (0)| Epoch:45 | Test Acc: 0.9370
 Test site-Sketch                    (5)| Epoch:45 | Test Acc: 0.8881
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7440
 Test site-Infograph                 (3)| Epoch:45 | Test Acc: 0.5814
Clipart: 0.9106, Real: 0.9449, Painting: 0.9370, Sketch: 0.8881, QuickDraw: 0.7440, Infograph: 0.5814, 
Average Test Accuracy(group): 0.8344, Average Test Accuracy(individual): 0.8904,
domain std=0.1314, cluster std=0.1314, individual std=0.0927, 
Average Test Accuracy: 0.8344
============ Train epoch 46 ============
cnt=[1, 1, 5, 4, 3, 2, ]
cnt=[5, 1, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                   (2) | Train Loss: 0.4192 | Train Acc: 0.8870
 Site-Clipart                   (2) | Train Loss: 0.2884 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.3772 | Train Acc: 0.8756
 Site-Clipart                   (2) | Train Loss: 0.3459 | Train Acc: 0.8956
 Site-Clipart                   (2) | Train Loss: 0.3516 | Train Acc: 0.9005
 Site-Real                      (3) | Train Loss: 0.2955 | Train Acc: 0.9286
 Site-Real                      (3) | Train Loss: 0.1755 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.1967 | Train Acc: 0.9597
 Site-Real                      (3) | Train Loss: 0.2369 | Train Acc: 0.9454
 Site-Painting                  (4) | Train Loss: 0.3149 | Train Acc: 0.9184
 Site-Painting                  (4) | Train Loss: 0.2842 | Train Acc: 0.9078
 Site-Painting                  (4) | Train Loss: 0.2759 | Train Acc: 0.9273
 Site-Sketch                    (5) | Train Loss: 0.3898 | Train Acc: 0.8796
 Site-Sketch                    (5) | Train Loss: 0.4171 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 0.7366 | Train Acc: 0.8073
 Site-Infograph                 (0) | Train Loss: 0.8689 | Train Acc: 0.7350
Average Train Accuracy: 0.8940
 Site-Clipart                   (2) | Val  Loss: 0.2317 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.2932 | Val  Acc: 0.9346
 Site-Clipart                   (2) | Val  Loss: 0.2876 | Val  Acc: 0.9133
 Site-Clipart                   (2) | Val  Loss: 0.3280 | Val  Acc: 0.9000
 Site-Clipart                   (2) | Val  Loss: 0.4118 | Val  Acc: 0.8814
 Site-Real                      (3) | Val  Loss: 0.2108 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2075 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.1671 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.2077 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.1705 | Val  Acc: 0.9490
 Site-Painting                  (4) | Val  Loss: 0.2359 | Val  Acc: 0.9416
 Site-Painting                  (4) | Val  Loss: 0.3187 | Val  Acc: 0.9167
 Site-Sketch                    (5) | Val  Loss: 0.3847 | Val  Acc: 0.8976
 Site-Sketch                    (5) | Val  Loss: 0.4846 | Val  Acc: 0.8652
 Site-QuickDraw                 (1) | Val  Loss: 0.7667 | Val  Acc: 0.7752
 Site-Infograph                 (0) | Val  Loss: 0.8864 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9026
 Best site-Clipart                  (2)  | Epoch:46 | Val Acc: 0.9211
 Best site-Clipart                  (2)  | Epoch:46 | Val Acc: 0.9346
 Best site-Clipart                  (2)  | Epoch:46 | Val Acc: 0.9133
 Best site-Clipart                  (2)  | Epoch:46 | Val Acc: 0.9000
 Best site-Clipart                  (2)  | Epoch:46 | Val Acc: 0.8814
 Best site-Real                     (3)  | Epoch:46 | Val Acc: 0.9286
 Best site-Real                     (3)  | Epoch:46 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:46 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:46 | Val Acc: 0.9524
 Best site-Painting                 (4)  | Epoch:46 | Val Acc: 0.9490
 Best site-Painting                 (4)  | Epoch:46 | Val Acc: 0.9416
 Best site-Painting                 (4)  | Epoch:46 | Val Acc: 0.9167
 Best site-Sketch                   (5)  | Epoch:46 | Val Acc: 0.8976
 Best site-Sketch                   (5)  | Epoch:46 | Val Acc: 0.8652
 Best site-QuickDraw                (1)  | Epoch:46 | Val Acc: 0.7752
 Best site-Infograph                (0)  | Epoch:46 | Val Acc: 0.7500
 Test site-Clipart                   (2)| Epoch:46 | Test Acc: 0.9125
 Test site-Real                      (3)| Epoch:46 | Test Acc: 0.9458
 Test site-Painting                  (4)| Epoch:46 | Test Acc: 0.9338
 Test site-Sketch                    (5)| Epoch:46 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.7510
 Test site-Infograph                 (0)| Epoch:46 | Test Acc: 0.5769
Clipart: 0.9125, Real: 0.9458, Painting: 0.9338, Sketch: 0.8917, QuickDraw: 0.7510, Infograph: 0.5769, 
Average Test Accuracy(group): 0.8353, Average Test Accuracy(individual): 0.8911,
domain std=0.1323, cluster std=0.1323, individual std=0.0929, 
Average Test Accuracy: 0.8353
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 47 ============
cnt=[4, 1, 2, 1, 5, 3, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                   (4) | Train Loss: 0.4141 | Train Acc: 0.8783
 Site-Clipart                   (4) | Train Loss: 0.2498 | Train Acc: 0.9565
 Site-Clipart                   (4) | Train Loss: 0.3976 | Train Acc: 0.8844
 Site-Clipart                   (4) | Train Loss: 0.3404 | Train Acc: 0.8797
 Site-Clipart                   (4) | Train Loss: 0.3530 | Train Acc: 0.9050
 Site-Real                      (0) | Train Loss: 0.3101 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.1795 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.2086 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.2278 | Train Acc: 0.9454
 Site-Painting                  (5) | Train Loss: 0.3549 | Train Acc: 0.9048
 Site-Painting                  (5) | Train Loss: 0.2634 | Train Acc: 0.9223
 Site-Painting                  (5) | Train Loss: 0.2957 | Train Acc: 0.9343
 Site-Sketch                    (2) | Train Loss: 0.4267 | Train Acc: 0.8691
 Site-Sketch                    (2) | Train Loss: 0.4255 | Train Acc: 0.8727
 Site-QuickDraw                 (1) | Train Loss: 0.6575 | Train Acc: 0.8012
 Site-Infograph                 (3) | Train Loss: 0.8395 | Train Acc: 0.7607
Average Train Accuracy: 0.8963
 Site-Clipart                   (4) | Val  Loss: 0.2081 | Val  Acc: 0.9211
 Site-Clipart                   (4) | Val  Loss: 0.3057 | Val  Acc: 0.9065
 Site-Clipart                   (4) | Val  Loss: 0.3359 | Val  Acc: 0.9000
 Site-Clipart                   (4) | Val  Loss: 0.3639 | Val  Acc: 0.8857
 Site-Clipart                   (4) | Val  Loss: 0.4191 | Val  Acc: 0.8881
 Site-Real                      (0) | Val  Loss: 0.2238 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.2087 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.1801 | Val  Acc: 0.9455
 Site-Real                      (0) | Val  Loss: 0.1931 | Val  Acc: 0.9654
 Site-Painting                  (5) | Val  Loss: 0.1664 | Val  Acc: 0.9796
 Site-Painting                  (5) | Val  Loss: 0.2700 | Val  Acc: 0.9197
 Site-Painting                  (5) | Val  Loss: 0.2756 | Val  Acc: 0.9271
 Site-Sketch                    (2) | Val  Loss: 0.3664 | Val  Acc: 0.8740
 Site-Sketch                    (2) | Val  Loss: 0.4436 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.7804 | Val  Acc: 0.7890
 Site-Infograph                 (3) | Val  Loss: 0.8902 | Val  Acc: 0.7436
Average Valid Accuracy: 0.8973
 Test site-Clipart                   (4)| Epoch:46 | Test Acc: 0.9087
 Test site-Real                      (0)| Epoch:46 | Test Acc: 0.9491
 Test site-Painting                  (5)| Epoch:46 | Test Acc: 0.9338
 Test site-Sketch                    (2)| Epoch:46 | Test Acc: 0.8935
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.7560
 Test site-Infograph                 (3)| Epoch:46 | Test Acc: 0.5799
Clipart: 0.9087, Real: 0.9491, Painting: 0.9338, Sketch: 0.8935, QuickDraw: 0.7560, Infograph: 0.5799, 
Average Test Accuracy(group): 0.8368, Average Test Accuracy(individual): 0.8915,
domain std=0.1310, cluster std=0.1310, individual std=0.0920, 
Average Test Accuracy: 0.8368
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
============ Train epoch 48 ============
cnt=[1, 5, 3, 1, 4, 2, ]
cnt=[2, 4, 1, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                   (1) | Train Loss: 0.4201 | Train Acc: 0.8696
 Site-Clipart                   (1) | Train Loss: 0.2832 | Train Acc: 0.9441
 Site-Clipart                   (1) | Train Loss: 0.3576 | Train Acc: 0.8933
 Site-Clipart                   (1) | Train Loss: 0.3489 | Train Acc: 0.9082
 Site-Clipart                   (1) | Train Loss: 0.3238 | Train Acc: 0.9231
 Site-Real                      (4) | Train Loss: 0.3072 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.1764 | Train Acc: 0.9548
 Site-Real                      (4) | Train Loss: 0.2168 | Train Acc: 0.9395
 Site-Real                      (4) | Train Loss: 0.2572 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.2642 | Train Acc: 0.9116
 Site-Painting                  (2) | Train Loss: 0.3037 | Train Acc: 0.8835
 Site-Painting                  (2) | Train Loss: 0.2857 | Train Acc: 0.9100
 Site-Sketch                    (5) | Train Loss: 0.3487 | Train Acc: 0.9110
 Site-Sketch                    (5) | Train Loss: 0.3672 | Train Acc: 0.8801
 Site-QuickDraw                 (0) | Train Loss: 0.7135 | Train Acc: 0.7982
 Site-Infograph                 (3) | Train Loss: 0.8194 | Train Acc: 0.7607
Average Train Accuracy: 0.8967
 Site-Clipart                   (1) | Val  Loss: 0.2105 | Val  Acc: 0.9342
 Site-Clipart                   (1) | Val  Loss: 0.2984 | Val  Acc: 0.9252
 Site-Clipart                   (1) | Val  Loss: 0.3082 | Val  Acc: 0.8867
 Site-Clipart                   (1) | Val  Loss: 0.3395 | Val  Acc: 0.8905
 Site-Clipart                   (1) | Val  Loss: 0.4168 | Val  Acc: 0.8780
 Site-Real                      (4) | Val  Loss: 0.2336 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.1839 | Val  Acc: 0.9492
 Site-Real                      (4) | Val  Loss: 0.2087 | Val  Acc: 0.9455
 Site-Real                      (4) | Val  Loss: 0.2186 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.2213 | Val  Acc: 0.9184
 Site-Painting                  (2) | Val  Loss: 0.2809 | Val  Acc: 0.9562
 Site-Painting                  (2) | Val  Loss: 0.2902 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.3391 | Val  Acc: 0.8976
 Site-Sketch                    (5) | Val  Loss: 0.4322 | Val  Acc: 0.8371
 Site-QuickDraw                 (0) | Val  Loss: 0.7405 | Val  Acc: 0.7936
 Site-Infograph                 (3) | Val  Loss: 0.9003 | Val  Acc: 0.7308
Average Valid Accuracy: 0.8953
 Test site-Clipart                   (1)| Epoch:47 | Test Acc: 0.9087
 Test site-Real                      (4)| Epoch:47 | Test Acc: 0.9474
 Test site-Painting                  (2)| Epoch:47 | Test Acc: 0.9370
 Test site-Sketch                    (5)| Epoch:47 | Test Acc: 0.8917
 Test site-QuickDraw                 (0)| Epoch:47 | Test Acc: 0.7520
 Test site-Infograph                 (3)| Epoch:47 | Test Acc: 0.5799
Clipart: 0.9087, Real: 0.9474, Painting: 0.9370, Sketch: 0.8917, QuickDraw: 0.7520, Infograph: 0.5799, 
Average Test Accuracy(group): 0.8361, Average Test Accuracy(individual): 0.8912,
domain std=0.1314, cluster std=0.1314, individual std=0.0924, 
Average Test Accuracy: 0.8361
============ Train epoch 49 ============
cnt=[1, 1, 5, 3, 4, 2, ]
cnt=[4, 1, 3, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                   (2) | Train Loss: 0.3861 | Train Acc: 0.8870
 Site-Clipart                   (2) | Train Loss: 0.2349 | Train Acc: 0.9565
 Site-Clipart                   (2) | Train Loss: 0.3613 | Train Acc: 0.8978
 Site-Clipart                   (2) | Train Loss: 0.3247 | Train Acc: 0.8987
 Site-Clipart                   (2) | Train Loss: 0.3274 | Train Acc: 0.9072
 Site-Real                      (4) | Train Loss: 0.3215 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.1725 | Train Acc: 0.9605
 Site-Real                      (4) | Train Loss: 0.2137 | Train Acc: 0.9355
 Site-Real                      (4) | Train Loss: 0.2301 | Train Acc: 0.9511
 Site-Painting                  (3) | Train Loss: 0.2954 | Train Acc: 0.9456
 Site-Painting                  (3) | Train Loss: 0.3025 | Train Acc: 0.9272
 Site-Painting                  (3) | Train Loss: 0.2742 | Train Acc: 0.9273
 Site-Sketch                    (5) | Train Loss: 0.3931 | Train Acc: 0.8901
 Site-Sketch                    (5) | Train Loss: 0.4406 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 0.6061 | Train Acc: 0.8287
 Site-Infograph                 (0) | Train Loss: 0.7807 | Train Acc: 0.7650
Average Train Accuracy: 0.9021
 Site-Clipart                   (2) | Val  Loss: 0.2087 | Val  Acc: 0.9342
 Site-Clipart                   (2) | Val  Loss: 0.2880 | Val  Acc: 0.9159
 Site-Clipart                   (2) | Val  Loss: 0.2886 | Val  Acc: 0.9133
 Site-Clipart                   (2) | Val  Loss: 0.3217 | Val  Acc: 0.9000
 Site-Clipart                   (2) | Val  Loss: 0.3929 | Val  Acc: 0.9017
 Site-Real                      (4) | Val  Loss: 0.2048 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2211 | Val  Acc: 0.9237
 Site-Real                      (4) | Val  Loss: 0.1593 | Val  Acc: 0.9697
 Site-Real                      (4) | Val  Loss: 0.1843 | Val  Acc: 0.9654
 Site-Painting                  (3) | Val  Loss: 0.2085 | Val  Acc: 0.9388
 Site-Painting                  (3) | Val  Loss: 0.2720 | Val  Acc: 0.9270
 Site-Painting                  (3) | Val  Loss: 0.2843 | Val  Acc: 0.9115
 Site-Sketch                    (5) | Val  Loss: 0.4070 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.4667 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.7337 | Val  Acc: 0.7890
 Site-Infograph                 (0) | Val  Loss: 0.9196 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8954
 Test site-Clipart                   (2)| Epoch:47 | Test Acc: 0.9087
 Test site-Real                      (4)| Epoch:47 | Test Acc: 0.9482
 Test site-Painting                  (3)| Epoch:47 | Test Acc: 0.9386
 Test site-Sketch                    (5)| Epoch:47 | Test Acc: 0.8935
 Test site-QuickDraw                 (1)| Epoch:47 | Test Acc: 0.7580
 Test site-Infograph                 (0)| Epoch:47 | Test Acc: 0.5799
Clipart: 0.9087, Real: 0.9482, Painting: 0.9386, Sketch: 0.8935, QuickDraw: 0.7580, Infograph: 0.5799, 
Average Test Accuracy(group): 0.8378, Average Test Accuracy(individual): 0.8923,
domain std=0.1313, cluster std=0.1313, individual std=0.0922, 
Average Test Accuracy: 0.8378
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_2/ccop_q=1...
===2023-07-29 02:38:28===
===2023-07-29 02:38:44===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (2)| Epoch:49 | Test Acc: 0.9087
 Test site-Real                      (4)| Epoch:49 | Test Acc: 0.9482
 Test site-Painting                  (3)| Epoch:49 | Test Acc: 0.9386
 Test site-Sketch                    (5)| Epoch:49 | Test Acc: 0.8935
 Test site-QuickDraw                 (1)| Epoch:49 | Test Acc: 0.7580
 Test site-Infograph                 (0)| Epoch:49 | Test Acc: 0.5799
Clipart: 0.9087, Real: 0.9482, Painting: 0.9386, Sketch: 0.8935, QuickDraw: 0.7580, Infograph: 0.5799, 
Average Test Accuracy(group): 0.8378, Average Test Accuracy(individual): 0.8923,
domain std=0.1313, cluster std=0.1313, individual std=0.0922, 
