===2023-03-28 01:26:16===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0162 | Train Acc: 0.3651
 Site-Clipart   | Train Loss: 1.9813 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 2.1749 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.1494 | Train Acc: 0.2698
 Site-Painting  | Train Loss: 1.9539 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.9501 | Train Acc: 0.4921
 Site-QuickDraw | Train Loss: 2.2399 | Train Acc: 0.1429
 Site-QuickDraw | Train Loss: 2.1895 | Train Acc: 0.2063
 Site-Real      | Train Loss: 1.8330 | Train Acc: 0.6032
 Site-Real      | Train Loss: 1.9223 | Train Acc: 0.4762
 Site-Sketch    | Train Loss: 1.8933 | Train Acc: 0.5397
 Site-Sketch    | Train Loss: 1.9447 | Train Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.9742 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 1.9858 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.2128 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1693 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 1.8747 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 2.0430 | Val  Acc: 0.4048
 Site-QuickDraw | Val  Loss: 2.2037 | Val  Acc: 0.2143
 Site-QuickDraw | Val  Loss: 2.1886 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.8257 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 1.9362 | Val  Acc: 0.5476
 Site-Sketch    | Val  Loss: 1.9193 | Val  Acc: 0.4524
 Site-Sketch    | Val  Loss: 1.9673 | Val  Acc: 0.4762
Average Valid Accuracy: 0.3869
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Painting   | Epoch:0 | Val Acc: 0.4762
 Best site-Painting   | Epoch:0 | Val Acc: 0.4048
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2143
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2619
 Best site-Real       | Epoch:0 | Val Acc: 0.5000
 Best site-Real       | Epoch:0 | Val Acc: 0.5476
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4524
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.6641 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.7822 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 2.1462 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.0257 | Train Acc: 0.3492
 Site-Painting  | Train Loss: 1.5596 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 1.5011 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 2.1394 | Train Acc: 0.3175
 Site-QuickDraw | Train Loss: 2.0433 | Train Acc: 0.3651
 Site-Real      | Train Loss: 1.3745 | Train Acc: 0.7778
 Site-Real      | Train Loss: 1.4118 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 1.4801 | Train Acc: 0.7460
 Site-Sketch    | Train Loss: 1.6264 | Train Acc: 0.7302
 Site-Clipart   | Val  Loss: 1.7180 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.7024 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.0265 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.2389 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 1.4374 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.7290 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 2.0277 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.1160 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.3415 | Val  Acc: 0.8571
 Site-Real      | Val  Loss: 1.4707 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 1.6749 | Val  Acc: 0.5476
 Site-Sketch    | Val  Loss: 1.6500 | Val  Acc: 0.5952
Average Valid Accuracy: 0.5218
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2143
 Best site-Painting   | Epoch:1 | Val Acc: 0.6667
 Best site-Painting   | Epoch:1 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2619
 Best site-Real       | Epoch:1 | Val Acc: 0.8571
 Best site-Real       | Epoch:1 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5476
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.3118 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.4017 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 1.9555 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.7789 | Train Acc: 0.4762
 Site-Painting  | Train Loss: 1.1455 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 1.1170 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.8974 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 1.7814 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.9283 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.9321 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 1.1404 | Train Acc: 0.7778
 Site-Sketch    | Train Loss: 1.2199 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.4361 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.3926 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.6412 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 2.0012 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.0051 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.3553 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.7380 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.8510 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.9343 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.9731 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.2947 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.2621 | Val  Acc: 0.7381
Average Valid Accuracy: 0.6925
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3333
 Best site-Painting   | Epoch:2 | Val Acc: 0.8571
 Best site-Painting   | Epoch:2 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.5000
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.0980 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.1234 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 1.8254 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.5904 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 0.8143 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.8975 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 1.7424 | Train Acc: 0.4921
 Site-QuickDraw | Train Loss: 1.6841 | Train Acc: 0.4603
 Site-Real      | Train Loss: 0.6171 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.6235 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.8981 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 0.9476 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.1378 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.0811 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.4205 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.8635 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.6977 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.9722 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.6359 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 1.7417 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.5836 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.5918 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 1.0368 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 0.9407 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7262
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4048
 Best site-Painting   | Epoch:3 | Val Acc: 0.9048
 Best site-Painting   | Epoch:3 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4524
 Best site-Real       | Epoch:3 | Val Acc: 0.9524
 Best site-Real       | Epoch:3 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.8845 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.0317 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.7506 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.4630 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.6575 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.6492 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.5863 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 1.4277 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.4643 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.4730 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.7329 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 0.8342 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.1008 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 0.9806 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.3112 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.7881 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 0.6223 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.8154 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.2565 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.5389 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.4686 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.4582 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.8945 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 0.8205 | Val  Acc: 0.8095
Average Valid Accuracy: 0.7242
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.7551 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.8983 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.6746 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.3846 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.4992 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.4667 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.5219 | Train Acc: 0.4921
 Site-QuickDraw | Train Loss: 1.3615 | Train Acc: 0.5079
 Site-Real      | Train Loss: 0.3280 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.3103 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.5455 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.6712 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.8499 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.8571 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.2289 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.6961 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 0.4751 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.6367 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.1348 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.4554 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.2679 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.3349 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6456 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.7409 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7560
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3571
 Best site-Painting   | Epoch:5 | Val Acc: 0.8810
 Best site-Painting   | Epoch:5 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4762
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Real       | Epoch:5 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.6225 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.6748 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.3896 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0051 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.4670 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.4071 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.3663 | Train Acc: 0.5873
 Site-QuickDraw | Train Loss: 1.2459 | Train Acc: 0.6032
 Site-Real      | Train Loss: 0.3766 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.2552 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.5805 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 0.5454 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7534 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.6385 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.9604 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.3922 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.3374 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.5363 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.2029 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.5091 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.2473 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.3673 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.5881 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.5953 | Val  Acc: 0.8810
Average Valid Accuracy: 0.7778
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5476
 Best site-Painting   | Epoch:6 | Val Acc: 0.9762
 Best site-Painting   | Epoch:6 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3810
 Best site-Real       | Epoch:6 | Val Acc: 0.9286
 Best site-Real       | Epoch:6 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.3617 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.5432 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.2374 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.0754 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.3039 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.3170 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.2690 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 1.1268 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.1894 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1512 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3137 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.4599 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.5700 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.4824 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 1.0731 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3960 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.2155 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3828 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 0.9572 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.2484 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.1745 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2147 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.3995 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4098 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8274
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5238
 Best site-Painting   | Epoch:7 | Val Acc: 0.9762
 Best site-Painting   | Epoch:7 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5952
 Best site-Real       | Epoch:7 | Val Acc: 0.9524
 Best site-Real       | Epoch:7 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3160 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4473 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.0873 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.7940 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.2622 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.1839 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.1229 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 1.0117 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.1335 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.1536 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3875 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.4208 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.5064 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3883 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.6975 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.0980 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.2343 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.2910 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 0.9474 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.2001 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.1191 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1480 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2860 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4418 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8571
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6667
 Best site-Painting   | Epoch:8 | Val Acc: 0.9524
 Best site-Painting   | Epoch:8 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5476
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Real       | Epoch:8 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:8 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2658 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3694 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.0210 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 0.7603 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.2210 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1570 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.1152 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 1.0580 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.1395 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1019 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.2500 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.2903 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4115 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3285 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.6354 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.1312 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.1948 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.2084 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 0.8222 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.1852 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0935 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1396 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.2435 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.3030 | Val  Acc: 0.9762
Average Valid Accuracy: 0.8810
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6667
 Best site-Painting   | Epoch:9 | Val Acc: 0.9762
 Best site-Painting   | Epoch:9 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.5952
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/FedPrompt...
===2023-03-28 01:58:32===
===2023-03-28 10:31:23===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8232
 Test site-Infograph | Epoch:9 | Test Acc: 0.5053
 Test site-Painting  | Epoch:9 | Test Acc: 0.8627
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.5690
 Test site-Real      | Epoch:9 | Test Acc: 0.9285
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7996
Average Test Accuracy: 0.7481
