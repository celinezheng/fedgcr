===2023-03-28 11:46:03===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0970 | Train Acc: 0.2903
 Site-Clipart   | Train Loss: 2.0994 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.2043 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.3021 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.0847 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.1009 | Train Acc: 0.3226
 Site-QuickDraw | Train Loss: 2.3083 | Train Acc: 0.0645
 Site-QuickDraw | Train Loss: 2.2708 | Train Acc: 0.0968
 Site-Real      | Train Loss: 1.9557 | Train Acc: 0.3226
 Site-Real      | Train Loss: 1.9016 | Train Acc: 0.2903
 Site-Sketch    | Train Loss: 1.9918 | Train Acc: 0.3226
 Site-Sketch    | Train Loss: 2.0266 | Train Acc: 0.2903
 Site-Clipart   | Val  Loss: 2.0383 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 2.1289 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.1290 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.4246 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.1568 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.1521 | Val  Acc: 0.2500
 Site-QuickDraw | Val  Loss: 2.2404 | Val  Acc: 0.1500
 Site-QuickDraw | Val  Loss: 2.2818 | Val  Acc: 0.0500
 Site-Real      | Val  Loss: 2.0459 | Val  Acc: 0.4500
 Site-Real      | Val  Loss: 1.8740 | Val  Acc: 0.4500
 Site-Sketch    | Val  Loss: 2.0577 | Val  Acc: 0.2000
 Site-Sketch    | Val  Loss: 2.1086 | Val  Acc: 0.3500
Average Valid Accuracy: 0.2708
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2500
 Best site-Painting   | Epoch:0 | Val Acc: 0.2500
 Best site-Painting   | Epoch:0 | Val Acc: 0.2500
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1500
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0500
 Best site-Real       | Epoch:0 | Val Acc: 0.4500
 Best site-Real       | Epoch:0 | Val Acc: 0.4500
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.8251 | Train Acc: 0.4839
 Site-Clipart   | Train Loss: 1.8998 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 2.0585 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.2326 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.8136 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 1.8546 | Train Acc: 0.5161
 Site-QuickDraw | Train Loss: 2.2444 | Train Acc: 0.1613
 Site-QuickDraw | Train Loss: 2.1523 | Train Acc: 0.2581
 Site-Real      | Train Loss: 1.6937 | Train Acc: 0.5806
 Site-Real      | Train Loss: 1.5131 | Train Acc: 0.7097
 Site-Sketch    | Train Loss: 1.6802 | Train Acc: 0.6129
 Site-Sketch    | Train Loss: 1.8276 | Train Acc: 0.4194
 Site-Clipart   | Val  Loss: 1.8245 | Val  Acc: 0.4500
 Site-Clipart   | Val  Loss: 1.8454 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.1043 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.2073 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.8502 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.8563 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 2.1336 | Val  Acc: 0.2500
 Site-QuickDraw | Val  Loss: 2.1964 | Val  Acc: 0.1500
 Site-Real      | Val  Loss: 1.7617 | Val  Acc: 0.6500
 Site-Real      | Val  Loss: 1.4519 | Val  Acc: 0.7000
 Site-Sketch    | Val  Loss: 1.8389 | Val  Acc: 0.3000
 Site-Sketch    | Val  Loss: 1.6898 | Val  Acc: 0.4500
Average Valid Accuracy: 0.4125
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4500
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3000
 Best site-Painting   | Epoch:1 | Val Acc: 0.3500
 Best site-Painting   | Epoch:1 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2500
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1500
 Best site-Real       | Epoch:1 | Val Acc: 0.6500
 Best site-Real       | Epoch:1 | Val Acc: 0.7000
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3000
 Best site-Sketch     | Epoch:1 | Val Acc: 0.4500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.5542 | Train Acc: 0.5806
 Site-Clipart   | Train Loss: 1.5393 | Train Acc: 0.6774
 Site-Infograph | Train Loss: 1.9759 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.1409 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.4268 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 1.5830 | Train Acc: 0.5806
 Site-QuickDraw | Train Loss: 2.0297 | Train Acc: 0.3548
 Site-QuickDraw | Train Loss: 2.0062 | Train Acc: 0.3548
 Site-Real      | Train Loss: 1.2965 | Train Acc: 0.8710
 Site-Real      | Train Loss: 1.2608 | Train Acc: 0.8065
 Site-Sketch    | Train Loss: 1.3211 | Train Acc: 0.7097
 Site-Sketch    | Train Loss: 1.5370 | Train Acc: 0.5806
 Site-Clipart   | Val  Loss: 1.6039 | Val  Acc: 0.6500
 Site-Clipart   | Val  Loss: 1.5767 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 2.0189 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.1578 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.3770 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 1.5545 | Val  Acc: 0.6500
 Site-QuickDraw | Val  Loss: 1.9836 | Val  Acc: 0.3500
 Site-QuickDraw | Val  Loss: 2.0613 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.3781 | Val  Acc: 0.8000
 Site-Real      | Val  Loss: 1.1089 | Val  Acc: 0.8500
 Site-Sketch    | Val  Loss: 1.7706 | Val  Acc: 0.4500
 Site-Sketch    | Val  Loss: 1.4001 | Val  Acc: 0.7000
Average Valid Accuracy: 0.5583
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6500
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3000
 Best site-Painting   | Epoch:2 | Val Acc: 0.7000
 Best site-Painting   | Epoch:2 | Val Acc: 0.6500
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3500
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3000
 Best site-Real       | Epoch:2 | Val Acc: 0.8000
 Best site-Real       | Epoch:2 | Val Acc: 0.8500
 Best site-Sketch     | Epoch:2 | Val Acc: 0.4500
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.3444 | Train Acc: 0.7097
 Site-Clipart   | Train Loss: 1.3751 | Train Acc: 0.6774
 Site-Infograph | Train Loss: 1.8151 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 2.0151 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.2161 | Train Acc: 0.8065
 Site-Painting  | Train Loss: 1.3566 | Train Acc: 0.7097
 Site-QuickDraw | Train Loss: 1.8959 | Train Acc: 0.4194
 Site-QuickDraw | Train Loss: 1.8427 | Train Acc: 0.4839
 Site-Real      | Train Loss: 1.0852 | Train Acc: 0.9355
 Site-Real      | Train Loss: 0.9657 | Train Acc: 0.9355
 Site-Sketch    | Train Loss: 1.0848 | Train Acc: 0.8710
 Site-Sketch    | Train Loss: 1.4045 | Train Acc: 0.6774
 Site-Clipart   | Val  Loss: 1.3181 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.3325 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.9657 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.0678 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 1.3499 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.3235 | Val  Acc: 0.7500
 Site-QuickDraw | Val  Loss: 1.7512 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.8709 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 1.1538 | Val  Acc: 0.8500
 Site-Real      | Val  Loss: 0.8309 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 1.3491 | Val  Acc: 0.6500
 Site-Sketch    | Val  Loss: 1.0870 | Val  Acc: 0.8500
Average Valid Accuracy: 0.6667
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4500
 Best site-Painting   | Epoch:3 | Val Acc: 0.6000
 Best site-Painting   | Epoch:3 | Val Acc: 0.7500
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5000
 Best site-Real       | Epoch:3 | Val Acc: 0.8500
 Best site-Real       | Epoch:3 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6500
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.1110 | Train Acc: 0.7742
 Site-Clipart   | Train Loss: 1.1139 | Train Acc: 0.7419
 Site-Infograph | Train Loss: 1.6692 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.8373 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.9415 | Train Acc: 0.9032
 Site-Painting  | Train Loss: 1.0741 | Train Acc: 0.8065
 Site-QuickDraw | Train Loss: 1.8259 | Train Acc: 0.4516
 Site-QuickDraw | Train Loss: 1.8168 | Train Acc: 0.4194
 Site-Real      | Train Loss: 0.8867 | Train Acc: 0.9032
 Site-Real      | Train Loss: 0.8267 | Train Acc: 0.9032
 Site-Sketch    | Train Loss: 0.8642 | Train Acc: 0.8387
 Site-Sketch    | Train Loss: 1.1421 | Train Acc: 0.8065
 Site-Clipart   | Val  Loss: 1.1673 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.9960 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.9217 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.9743 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 1.0716 | Val  Acc: 0.8500
 Site-Painting  | Val  Loss: 1.0301 | Val  Acc: 0.9000
 Site-QuickDraw | Val  Loss: 1.7459 | Val  Acc: 0.4500
 Site-QuickDraw | Val  Loss: 1.7312 | Val  Acc: 0.5500
 Site-Real      | Val  Loss: 0.9240 | Val  Acc: 0.9000
 Site-Real      | Val  Loss: 0.6058 | Val  Acc: 0.9500
 Site-Sketch    | Val  Loss: 1.2922 | Val  Acc: 0.7500
 Site-Sketch    | Val  Loss: 0.8573 | Val  Acc: 0.8500
Average Valid Accuracy: 0.7167
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4500
 Best site-Painting   | Epoch:4 | Val Acc: 0.8500
 Best site-Painting   | Epoch:4 | Val Acc: 0.9000
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.4500
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5500
 Best site-Real       | Epoch:4 | Val Acc: 0.9000
 Best site-Real       | Epoch:4 | Val Acc: 0.9500
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7500
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.8627 | Train Acc: 0.8710
 Site-Clipart   | Train Loss: 0.9337 | Train Acc: 0.8065
 Site-Infograph | Train Loss: 1.5786 | Train Acc: 0.5161
 Site-Infograph | Train Loss: 1.7315 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.7423 | Train Acc: 0.9032
 Site-Painting  | Train Loss: 0.8712 | Train Acc: 0.8710
 Site-QuickDraw | Train Loss: 1.6698 | Train Acc: 0.4516
 Site-QuickDraw | Train Loss: 1.6041 | Train Acc: 0.5161
 Site-Real      | Train Loss: 0.5873 | Train Acc: 0.9677
 Site-Real      | Train Loss: 0.6297 | Train Acc: 0.9355
 Site-Sketch    | Train Loss: 0.6370 | Train Acc: 0.9355
 Site-Sketch    | Train Loss: 0.9479 | Train Acc: 0.8387
 Site-Clipart   | Val  Loss: 0.9278 | Val  Acc: 0.8500
 Site-Clipart   | Val  Loss: 0.8357 | Val  Acc: 0.9500
 Site-Infograph | Val  Loss: 1.7363 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.7640 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.8475 | Val  Acc: 0.8500
 Site-Painting  | Val  Loss: 0.8696 | Val  Acc: 0.9000
 Site-QuickDraw | Val  Loss: 1.5498 | Val  Acc: 0.6500
 Site-QuickDraw | Val  Loss: 1.4633 | Val  Acc: 0.6500
 Site-Real      | Val  Loss: 0.7211 | Val  Acc: 0.9500
 Site-Real      | Val  Loss: 0.4330 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.8379 | Val  Acc: 0.8500
 Site-Sketch    | Val  Loss: 0.6037 | Val  Acc: 0.9500
Average Valid Accuracy: 0.8000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8500
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9500
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5500
 Best site-Painting   | Epoch:5 | Val Acc: 0.8500
 Best site-Painting   | Epoch:5 | Val Acc: 0.9000
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.6500
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.6500
 Best site-Real       | Epoch:5 | Val Acc: 0.9500
 Best site-Real       | Epoch:5 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8500
 Best site-Sketch     | Epoch:5 | Val Acc: 0.9500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.6960 | Train Acc: 0.9355
 Site-Clipart   | Train Loss: 0.6758 | Train Acc: 0.9677
 Site-Infograph | Train Loss: 1.3674 | Train Acc: 0.7097
 Site-Infograph | Train Loss: 1.5780 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 0.7085 | Train Acc: 0.9032
 Site-Painting  | Train Loss: 0.7268 | Train Acc: 0.8710
 Site-QuickDraw | Train Loss: 1.4489 | Train Acc: 0.5806
 Site-QuickDraw | Train Loss: 1.5148 | Train Acc: 0.5484
 Site-Real      | Train Loss: 0.4787 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.4790 | Train Acc: 0.9355
 Site-Sketch    | Train Loss: 0.5665 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.8212 | Train Acc: 0.8710
 Site-Clipart   | Val  Loss: 0.7780 | Val  Acc: 0.8500
 Site-Clipart   | Val  Loss: 0.7055 | Val  Acc: 0.8500
 Site-Infograph | Val  Loss: 1.6343 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.4343 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.6068 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.7330 | Val  Acc: 0.8500
 Site-QuickDraw | Val  Loss: 1.6187 | Val  Acc: 0.4500
 Site-QuickDraw | Val  Loss: 1.4920 | Val  Acc: 0.6500
 Site-Real      | Val  Loss: 0.4977 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3558 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.9223 | Val  Acc: 0.8500
 Site-Sketch    | Val  Loss: 0.4855 | Val  Acc: 0.8500
Average Valid Accuracy: 0.8083
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8500
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8500
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5500
 Best site-Infograph  | Epoch:6 | Val Acc: 0.8000
 Best site-Painting   | Epoch:6 | Val Acc: 1.0000
 Best site-Painting   | Epoch:6 | Val Acc: 0.8500
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.4500
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6500
 Best site-Real       | Epoch:6 | Val Acc: 1.0000
 Best site-Real       | Epoch:6 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8500
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.6586 | Train Acc: 0.9677
 Site-Clipart   | Train Loss: 0.6259 | Train Acc: 0.9355
 Site-Infograph | Train Loss: 1.2553 | Train Acc: 0.6774
 Site-Infograph | Train Loss: 1.4848 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 0.5065 | Train Acc: 0.9355
 Site-Painting  | Train Loss: 0.5784 | Train Acc: 0.9355
 Site-QuickDraw | Train Loss: 1.4029 | Train Acc: 0.6452
 Site-QuickDraw | Train Loss: 1.3644 | Train Acc: 0.5806
 Site-Real      | Train Loss: 0.3488 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.3716 | Train Acc: 0.9677
 Site-Sketch    | Train Loss: 0.4596 | Train Acc: 0.9032
 Site-Sketch    | Train Loss: 0.6908 | Train Acc: 0.8387
 Site-Clipart   | Val  Loss: 0.5606 | Val  Acc: 0.9500
 Site-Clipart   | Val  Loss: 0.4322 | Val  Acc: 0.9500
 Site-Infograph | Val  Loss: 1.4392 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.5052 | Val  Acc: 0.6500
 Site-Painting  | Val  Loss: 0.4915 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5410 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.4016 | Val  Acc: 0.4500
 Site-QuickDraw | Val  Loss: 1.2583 | Val  Acc: 0.7000
 Site-Real      | Val  Loss: 0.5577 | Val  Acc: 0.9500
 Site-Real      | Val  Loss: 0.2903 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.8169 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3639 | Val  Acc: 0.9500
Average Valid Accuracy: 0.8500
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9500
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9500
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6500
 Best site-Painting   | Epoch:7 | Val Acc: 1.0000
 Best site-Painting   | Epoch:7 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.4500
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.7000
 Best site-Real       | Epoch:7 | Val Acc: 0.9500
 Best site-Real       | Epoch:7 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:7 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.4800 | Train Acc: 0.9677
 Site-Clipart   | Train Loss: 0.4987 | Train Acc: 0.9355
 Site-Infograph | Train Loss: 1.2215 | Train Acc: 0.6774
 Site-Infograph | Train Loss: 1.3149 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 0.4080 | Train Acc: 0.9032
 Site-Painting  | Train Loss: 0.4614 | Train Acc: 0.9355
 Site-QuickDraw | Train Loss: 1.1828 | Train Acc: 0.6774
 Site-QuickDraw | Train Loss: 1.2357 | Train Acc: 0.6129
 Site-Real      | Train Loss: 0.3142 | Train Acc: 0.9677
 Site-Real      | Train Loss: 0.2832 | Train Acc: 0.9677
 Site-Sketch    | Train Loss: 0.4212 | Train Acc: 0.9355
 Site-Sketch    | Train Loss: 0.5890 | Train Acc: 0.9355
 Site-Clipart   | Val  Loss: 0.4580 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5320 | Val  Acc: 0.9500
 Site-Infograph | Val  Loss: 1.3945 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.4889 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.4655 | Val  Acc: 0.9000
 Site-Painting  | Val  Loss: 0.5076 | Val  Acc: 0.9000
 Site-QuickDraw | Val  Loss: 1.2290 | Val  Acc: 0.6500
 Site-QuickDraw | Val  Loss: 1.2343 | Val  Acc: 0.7500
 Site-Real      | Val  Loss: 0.2970 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1443 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5313 | Val  Acc: 0.9500
 Site-Sketch    | Val  Loss: 0.3485 | Val  Acc: 0.9000
Average Valid Accuracy: 0.8500
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.3884 | Train Acc: 0.9355
 Site-Clipart   | Train Loss: 0.3742 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.8953 | Train Acc: 0.8387
 Site-Infograph | Train Loss: 1.1098 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.3621 | Train Acc: 0.9355
 Site-Painting  | Train Loss: 0.3662 | Train Acc: 0.9677
 Site-QuickDraw | Train Loss: 1.2165 | Train Acc: 0.7097
 Site-QuickDraw | Train Loss: 1.2625 | Train Acc: 0.6129
 Site-Real      | Train Loss: 0.2236 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.2274 | Train Acc: 0.9677
 Site-Sketch    | Train Loss: 0.3283 | Train Acc: 0.9355
 Site-Sketch    | Train Loss: 0.4090 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4082 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3440 | Val  Acc: 0.9500
 Site-Infograph | Val  Loss: 1.3050 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.1992 | Val  Acc: 0.7500
 Site-Painting  | Val  Loss: 0.3719 | Val  Acc: 0.9500
 Site-Painting  | Val  Loss: 0.2412 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.2574 | Val  Acc: 0.7000
 Site-QuickDraw | Val  Loss: 1.2390 | Val  Acc: 0.7500
 Site-Real      | Val  Loss: 0.4637 | Val  Acc: 0.9000
 Site-Real      | Val  Loss: 0.1202 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4277 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2803 | Val  Acc: 0.9500
Average Valid Accuracy: 0.8917
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9500
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7500
 Best site-Painting   | Epoch:9 | Val Acc: 0.9500
 Best site-Painting   | Epoch:9 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.7000
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.7500
 Best site-Real       | Epoch:9 | Val Acc: 0.9000
 Best site-Real       | Epoch:9 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:9 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
===2023-03-28 12:01:27===
===2023-03-28 12:01:28===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.7548
 Test site-Infograph | Epoch:9 | Test Acc: 0.4368
 Test site-Painting  | Epoch:9 | Test Acc: 0.8207
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.5540
 Test site-Real      | Epoch:9 | Test Acc: 0.8841
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7184
Average Test Accuracy: 0.6948
===2023-03-28 14:50:54===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
===2023-03-28 14:50:58===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
===2023-03-28 14:53:49===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
===2023-03-28 14:54:08===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
===2023-03-28 14:54:30===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
===2023-03-28 14:54:53===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
===2023-03-28 14:55:02===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
===2023-03-28 14:55:16===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
===2023-03-28 14:57:35===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
===2023-03-28 14:57:47===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.2033 | Train Acc: 0.1935
 Site-Clipart   | Train Loss: 2.1436 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.2209 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.3049 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.1176 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.1637 | Train Acc: 0.2581
 Site-QuickDraw | Train Loss: 2.3413 | Train Acc: 0.0000
 Site-QuickDraw | Train Loss: 2.3009 | Train Acc: 0.1290
 Site-Real      | Train Loss: 2.0389 | Train Acc: 0.2903
 Site-Real      | Train Loss: 2.0082 | Train Acc: 0.3871
 Site-Sketch    | Train Loss: 2.0243 | Train Acc: 0.2903
 Site-Sketch    | Train Loss: 2.1464 | Train Acc: 0.1613
 Site-Clipart   | Val  Loss: 2.1194 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 2.2656 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.1396 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.2096 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.0848 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.2124 | Val  Acc: 0.3000
 Site-QuickDraw | Val  Loss: 2.3239 | Val  Acc: 0.1500
 Site-QuickDraw | Val  Loss: 2.3812 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 2.1907 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.9762 | Val  Acc: 0.3000
 Site-Sketch    | Val  Loss: 2.1281 | Val  Acc: 0.1000
 Site-Sketch    | Val  Loss: 2.1653 | Val  Acc: 0.1500
Average Valid Accuracy: 0.2042
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2500
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2000
 Best site-Painting   | Epoch:0 | Val Acc: 0.3000
 Best site-Painting   | Epoch:0 | Val Acc: 0.3000
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1500
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1000
 Best site-Real       | Epoch:0 | Val Acc: 0.2000
 Best site-Real       | Epoch:0 | Val Acc: 0.3000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 2.0410 | Train Acc: 0.2903
 Site-Clipart   | Train Loss: 2.0497 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.2016 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.2192 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 2.0182 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.0034 | Train Acc: 0.3548
 Site-QuickDraw | Train Loss: 2.1851 | Train Acc: 0.3226
 Site-QuickDraw | Train Loss: 2.1623 | Train Acc: 0.3226
 Site-Real      | Train Loss: 1.9889 | Train Acc: 0.2258
 Site-Real      | Train Loss: 1.8627 | Train Acc: 0.4194
 Site-Sketch    | Train Loss: 1.9664 | Train Acc: 0.2581
 Site-Sketch    | Train Loss: 1.9615 | Train Acc: 0.2581
 Site-Clipart   | Val  Loss: 1.9715 | Val  Acc: 0.4500
 Site-Clipart   | Val  Loss: 2.1937 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.1083 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.2626 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.0095 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.0611 | Val  Acc: 0.3000
 Site-QuickDraw | Val  Loss: 2.1795 | Val  Acc: 0.1500
 Site-QuickDraw | Val  Loss: 2.2399 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.0202 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.7448 | Val  Acc: 0.3500
 Site-Sketch    | Val  Loss: 1.9840 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.9101 | Val  Acc: 0.2500
Average Valid Accuracy: 0.2833
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4500
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2000
 Best site-Painting   | Epoch:1 | Val Acc: 0.3000
 Best site-Painting   | Epoch:1 | Val Acc: 0.3000
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1500
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0000
 Best site-Real       | Epoch:1 | Val Acc: 0.3000
 Best site-Real       | Epoch:1 | Val Acc: 0.3500
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:1 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.9394 | Train Acc: 0.4194
 Site-Clipart   | Train Loss: 1.9478 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 2.0867 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.1462 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.7116 | Train Acc: 0.6452
 Site-Painting  | Train Loss: 1.9012 | Train Acc: 0.3226
 Site-QuickDraw | Train Loss: 2.1935 | Train Acc: 0.2903
 Site-QuickDraw | Train Loss: 2.1395 | Train Acc: 0.2581
 Site-Real      | Train Loss: 1.8044 | Train Acc: 0.6129
 Site-Real      | Train Loss: 1.6924 | Train Acc: 0.6129
 Site-Sketch    | Train Loss: 1.8146 | Train Acc: 0.4516
 Site-Sketch    | Train Loss: 1.8224 | Train Acc: 0.5484
 Site-Clipart   | Val  Loss: 1.7974 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.0225 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.0205 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.1269 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.8185 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.8527 | Val  Acc: 0.4500
 Site-QuickDraw | Val  Loss: 2.1244 | Val  Acc: 0.3000
 Site-QuickDraw | Val  Loss: 2.2245 | Val  Acc: 0.1500
 Site-Real      | Val  Loss: 1.7521 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 1.5791 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.8370 | Val  Acc: 0.5500
 Site-Sketch    | Val  Loss: 1.6216 | Val  Acc: 0.5500
Average Valid Accuracy: 0.4042
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2500
 Best site-Painting   | Epoch:2 | Val Acc: 0.4000
 Best site-Painting   | Epoch:2 | Val Acc: 0.4500
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3000
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1500
 Best site-Real       | Epoch:2 | Val Acc: 0.5000
 Best site-Real       | Epoch:2 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:2 | Val Acc: 0.5500
 Best site-Sketch     | Epoch:2 | Val Acc: 0.5500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.7721 | Train Acc: 0.5161
 Site-Clipart   | Train Loss: 1.7397 | Train Acc: 0.5806
 Site-Infograph | Train Loss: 2.0139 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 2.0523 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.6220 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 1.7689 | Train Acc: 0.5161
 Site-QuickDraw | Train Loss: 2.1722 | Train Acc: 0.2903
 Site-QuickDraw | Train Loss: 2.0722 | Train Acc: 0.3871
 Site-Real      | Train Loss: 1.6111 | Train Acc: 0.7097
 Site-Real      | Train Loss: 1.5212 | Train Acc: 0.6774
 Site-Sketch    | Train Loss: 1.5842 | Train Acc: 0.6774
 Site-Sketch    | Train Loss: 1.7322 | Train Acc: 0.5484
 Site-Clipart   | Val  Loss: 1.7119 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.7545 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.9622 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.1292 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.7057 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.7152 | Val  Acc: 0.6500
 Site-QuickDraw | Val  Loss: 2.0231 | Val  Acc: 0.3500
 Site-QuickDraw | Val  Loss: 2.0787 | Val  Acc: 0.2500
 Site-Real      | Val  Loss: 1.7653 | Val  Acc: 0.6500
 Site-Real      | Val  Loss: 1.3364 | Val  Acc: 0.7500
 Site-Sketch    | Val  Loss: 1.6261 | Val  Acc: 0.7000
 Site-Sketch    | Val  Loss: 1.5078 | Val  Acc: 0.7000
Average Valid Accuracy: 0.5333
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:3 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3500
 Best site-Painting   | Epoch:3 | Val Acc: 0.5000
 Best site-Painting   | Epoch:3 | Val Acc: 0.6500
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3500
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2500
 Best site-Real       | Epoch:3 | Val Acc: 0.6500
 Best site-Real       | Epoch:3 | Val Acc: 0.7500
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7000
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.6188 | Train Acc: 0.6129
 Site-Clipart   | Train Loss: 1.6077 | Train Acc: 0.5806
 Site-Infograph | Train Loss: 1.9715 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.9967 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.4665 | Train Acc: 0.8387
 Site-Painting  | Train Loss: 1.6804 | Train Acc: 0.5806
 Site-QuickDraw | Train Loss: 2.0943 | Train Acc: 0.2581
 Site-QuickDraw | Train Loss: 2.0390 | Train Acc: 0.4516
 Site-Real      | Train Loss: 1.4415 | Train Acc: 0.7742
 Site-Real      | Train Loss: 1.4402 | Train Acc: 0.8065
 Site-Sketch    | Train Loss: 1.4084 | Train Acc: 0.7097
 Site-Sketch    | Train Loss: 1.6011 | Train Acc: 0.6129
 Site-Clipart   | Val  Loss: 1.5811 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.6345 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.8822 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.0286 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.5895 | Val  Acc: 0.6500
 Site-Painting  | Val  Loss: 1.5401 | Val  Acc: 0.7500
 Site-QuickDraw | Val  Loss: 2.0143 | Val  Acc: 0.4000
 Site-QuickDraw | Val  Loss: 2.0473 | Val  Acc: 0.4500
 Site-Real      | Val  Loss: 1.5626 | Val  Acc: 0.7000
 Site-Real      | Val  Loss: 1.2146 | Val  Acc: 0.9500
 Site-Sketch    | Val  Loss: 1.5968 | Val  Acc: 0.6500
 Site-Sketch    | Val  Loss: 1.3867 | Val  Acc: 0.6500
Average Valid Accuracy: 0.5875
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3000
 Best site-Painting   | Epoch:4 | Val Acc: 0.6500
 Best site-Painting   | Epoch:4 | Val Acc: 0.7500
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.4000
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.4500
 Best site-Real       | Epoch:4 | Val Acc: 0.7000
 Best site-Real       | Epoch:4 | Val Acc: 0.9500
 Best site-Sketch     | Epoch:4 | Val Acc: 0.6500
 Best site-Sketch     | Epoch:4 | Val Acc: 0.6500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 1.5248 | Train Acc: 0.5806
 Site-Clipart   | Train Loss: 1.5150 | Train Acc: 0.5484
 Site-Infograph | Train Loss: 1.8866 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.9519 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.3076 | Train Acc: 0.8710
 Site-Painting  | Train Loss: 1.5614 | Train Acc: 0.6774
 Site-QuickDraw | Train Loss: 1.9994 | Train Acc: 0.4516
 Site-QuickDraw | Train Loss: 1.9953 | Train Acc: 0.3871
 Site-Real      | Train Loss: 1.3524 | Train Acc: 0.8387
 Site-Real      | Train Loss: 1.2763 | Train Acc: 0.7742
 Site-Sketch    | Train Loss: 1.3093 | Train Acc: 0.8065
 Site-Sketch    | Train Loss: 1.4541 | Train Acc: 0.7419
 Site-Clipart   | Val  Loss: 1.4213 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.4525 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.7635 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.0486 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.4560 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 1.3160 | Val  Acc: 0.9000
 Site-QuickDraw | Val  Loss: 1.9456 | Val  Acc: 0.6500
 Site-QuickDraw | Val  Loss: 2.0606 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 1.5440 | Val  Acc: 0.6500
 Site-Real      | Val  Loss: 1.1000 | Val  Acc: 0.8500
 Site-Sketch    | Val  Loss: 1.4888 | Val  Acc: 0.6000
 Site-Sketch    | Val  Loss: 1.2174 | Val  Acc: 0.8500
Average Valid Accuracy: 0.6250
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3500
 Best site-Painting   | Epoch:5 | Val Acc: 0.7000
 Best site-Painting   | Epoch:5 | Val Acc: 0.9000
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.6500
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4000
 Best site-Real       | Epoch:5 | Val Acc: 0.6500
 Best site-Real       | Epoch:5 | Val Acc: 0.8500
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 1.3159 | Train Acc: 0.6774
 Site-Clipart   | Train Loss: 1.3749 | Train Acc: 0.5806
 Site-Infograph | Train Loss: 1.9231 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.8878 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 1.1799 | Train Acc: 0.8065
 Site-Painting  | Train Loss: 1.3986 | Train Acc: 0.7742
 Site-QuickDraw | Train Loss: 1.9847 | Train Acc: 0.4516
 Site-QuickDraw | Train Loss: 1.8726 | Train Acc: 0.6452
 Site-Real      | Train Loss: 1.1778 | Train Acc: 0.8387
 Site-Real      | Train Loss: 1.1060 | Train Acc: 0.8387
 Site-Sketch    | Train Loss: 1.2244 | Train Acc: 0.7419
 Site-Sketch    | Train Loss: 1.3123 | Train Acc: 0.7419
 Site-Clipart   | Val  Loss: 1.3940 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.3766 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.7416 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.9897 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.2464 | Val  Acc: 0.8500
 Site-Painting  | Val  Loss: 1.3374 | Val  Acc: 0.7000
 Site-QuickDraw | Val  Loss: 1.8774 | Val  Acc: 0.5500
 Site-QuickDraw | Val  Loss: 1.9388 | Val  Acc: 0.3500
 Site-Real      | Val  Loss: 1.2305 | Val  Acc: 0.8000
 Site-Real      | Val  Loss: 0.9645 | Val  Acc: 0.9000
 Site-Sketch    | Val  Loss: 1.5298 | Val  Acc: 0.6000
 Site-Sketch    | Val  Loss: 1.1313 | Val  Acc: 0.6500
Average Valid Accuracy: 0.6125
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 1.2653 | Train Acc: 0.7419
 Site-Clipart   | Train Loss: 1.3158 | Train Acc: 0.6129
 Site-Infograph | Train Loss: 1.8898 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.8194 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 1.1060 | Train Acc: 0.8065
 Site-Painting  | Train Loss: 1.2765 | Train Acc: 0.8065
 Site-QuickDraw | Train Loss: 1.8911 | Train Acc: 0.4194
 Site-QuickDraw | Train Loss: 1.9039 | Train Acc: 0.5806
 Site-Real      | Train Loss: 1.0615 | Train Acc: 0.9355
 Site-Real      | Train Loss: 1.0781 | Train Acc: 0.8710
 Site-Sketch    | Train Loss: 1.0270 | Train Acc: 0.9032
 Site-Sketch    | Train Loss: 1.2822 | Train Acc: 0.7742
 Site-Clipart   | Val  Loss: 1.2356 | Val  Acc: 0.6500
 Site-Clipart   | Val  Loss: 1.2962 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.6946 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9755 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.1949 | Val  Acc: 0.7500
 Site-Painting  | Val  Loss: 1.1374 | Val  Acc: 0.8500
 Site-QuickDraw | Val  Loss: 1.7278 | Val  Acc: 0.5500
 Site-QuickDraw | Val  Loss: 1.9827 | Val  Acc: 0.4500
 Site-Real      | Val  Loss: 1.1345 | Val  Acc: 0.9000
 Site-Real      | Val  Loss: 0.8493 | Val  Acc: 0.9500
 Site-Sketch    | Val  Loss: 1.4141 | Val  Acc: 0.6000
 Site-Sketch    | Val  Loss: 0.9501 | Val  Acc: 0.7000
Average Valid Accuracy: 0.6583
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6500
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6500
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:7 | Val Acc: 0.3500
 Best site-Painting   | Epoch:7 | Val Acc: 0.7500
 Best site-Painting   | Epoch:7 | Val Acc: 0.8500
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5500
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.4500
 Best site-Real       | Epoch:7 | Val Acc: 0.9000
 Best site-Real       | Epoch:7 | Val Acc: 0.9500
 Best site-Sketch     | Epoch:7 | Val Acc: 0.6000
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 1.1894 | Train Acc: 0.7097
 Site-Clipart   | Train Loss: 1.2067 | Train Acc: 0.7742
 Site-Infograph | Train Loss: 1.7705 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.7406 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.9857 | Train Acc: 0.8710
 Site-Painting  | Train Loss: 1.1448 | Train Acc: 0.8710
 Site-QuickDraw | Train Loss: 1.9292 | Train Acc: 0.3226
 Site-QuickDraw | Train Loss: 1.7666 | Train Acc: 0.5161
 Site-Real      | Train Loss: 0.9161 | Train Acc: 0.9677
 Site-Real      | Train Loss: 0.9669 | Train Acc: 0.8387
 Site-Sketch    | Train Loss: 1.1005 | Train Acc: 0.8065
 Site-Sketch    | Train Loss: 1.1227 | Train Acc: 0.8065
 Site-Clipart   | Val  Loss: 1.1578 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.2233 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.6580 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8770 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 1.1090 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.2465 | Val  Acc: 0.9000
 Site-QuickDraw | Val  Loss: 1.7469 | Val  Acc: 0.6000
 Site-QuickDraw | Val  Loss: 1.8844 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 1.0508 | Val  Acc: 0.8500
 Site-Real      | Val  Loss: 0.6798 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 1.2470 | Val  Acc: 0.6500
 Site-Sketch    | Val  Loss: 0.9282 | Val  Acc: 0.8000
Average Valid Accuracy: 0.7083
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.6500
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4500
 Best site-Painting   | Epoch:8 | Val Acc: 0.8000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9000
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.6000
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5000
 Best site-Real       | Epoch:8 | Val Acc: 0.8500
 Best site-Real       | Epoch:8 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:8 | Val Acc: 0.6500
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 1.0270 | Train Acc: 0.8387
 Site-Clipart   | Train Loss: 1.1589 | Train Acc: 0.6774
 Site-Infograph | Train Loss: 1.8180 | Train Acc: 0.5161
 Site-Infograph | Train Loss: 1.7041 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.9231 | Train Acc: 0.8710
 Site-Painting  | Train Loss: 1.1230 | Train Acc: 0.8710
 Site-QuickDraw | Train Loss: 1.8776 | Train Acc: 0.4516
 Site-QuickDraw | Train Loss: 1.6966 | Train Acc: 0.6452
 Site-Real      | Train Loss: 0.7827 | Train Acc: 0.9355
 Site-Real      | Train Loss: 0.8691 | Train Acc: 0.9032
 Site-Sketch    | Train Loss: 0.9212 | Train Acc: 0.8065
 Site-Sketch    | Train Loss: 0.9829 | Train Acc: 0.9032
 Site-Clipart   | Val  Loss: 1.1649 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.0644 | Val  Acc: 0.9000
 Site-Infograph | Val  Loss: 1.6049 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.7809 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.9977 | Val  Acc: 0.9000
 Site-Painting  | Val  Loss: 0.9626 | Val  Acc: 0.9000
 Site-QuickDraw | Val  Loss: 1.5980 | Val  Acc: 0.7000
 Site-QuickDraw | Val  Loss: 1.8004 | Val  Acc: 0.4500
 Site-Real      | Val  Loss: 1.0016 | Val  Acc: 0.8500
 Site-Real      | Val  Loss: 0.6217 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 1.0428 | Val  Acc: 0.8500
 Site-Sketch    | Val  Loss: 0.8584 | Val  Acc: 0.7000
Average Valid Accuracy: 0.7542
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5500
 Best site-Painting   | Epoch:9 | Val Acc: 0.9000
 Best site-Painting   | Epoch:9 | Val Acc: 0.9000
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.7000
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.4500
 Best site-Real       | Epoch:9 | Val Acc: 0.8500
 Best site-Real       | Epoch:9 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8500
 Best site-Sketch     | Epoch:9 | Val Acc: 0.7000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
===2023-03-28 15:13:08===
===2023-03-28 15:19:46===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.7034
 Test site-Infograph | Epoch:9 | Test Acc: 0.4079
 Test site-Painting  | Epoch:9 | Test Acc: 0.7948
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.4640
 Test site-Real      | Epoch:9 | Test Acc: 0.8587
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7022
Average Test Accuracy: 0.6552
===2023-03-28 15:30:53===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.6977
 Test site-Infograph | Epoch:9 | Test Acc: 0.4094
 Test site-Painting  | Epoch:9 | Test Acc: 0.7803
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.4560
 Test site-Real      | Epoch:9 | Test Acc: 0.8422
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7094
Average Test Accuracy: 0.6492
===2023-03-28 15:50:30===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0564 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.9943 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 2.1906 | Train Acc: 0.1905
 Site-Infograph | Train Loss: 2.2031 | Train Acc: 0.2698
 Site-Painting  | Train Loss: 1.9989 | Train Acc: 0.4127
 Site-Painting  | Train Loss: 2.1145 | Train Acc: 0.3175
 Site-QuickDraw | Train Loss: 2.2964 | Train Acc: 0.1111
 Site-QuickDraw | Train Loss: 2.2348 | Train Acc: 0.1905
 Site-Real      | Train Loss: 1.9878 | Train Acc: 0.4127
 Site-Real      | Train Loss: 2.0407 | Train Acc: 0.3651
 Site-Sketch    | Train Loss: 1.9547 | Train Acc: 0.4762
 Site-Sketch    | Train Loss: 1.9932 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.9543 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 2.0147 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.2274 | Val  Acc: 0.2143
 Site-Infograph | Val  Loss: 2.1854 | Val  Acc: 0.1905
 Site-Painting  | Val  Loss: 2.0057 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 2.1152 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.1880 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.2488 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 2.0002 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 2.0556 | Val  Acc: 0.3810
 Site-Sketch    | Val  Loss: 2.0067 | Val  Acc: 0.4524
 Site-Sketch    | Val  Loss: 2.0580 | Val  Acc: 0.4286
Average Valid Accuracy: 0.3532
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1905
 Best site-Painting   | Epoch:0 | Val Acc: 0.3571
 Best site-Painting   | Epoch:0 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2381
 Best site-Real       | Epoch:0 | Val Acc: 0.3810
 Best site-Real       | Epoch:0 | Val Acc: 0.3810
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4524
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.8019 | Train Acc: 0.4921
 Site-Clipart   | Train Loss: 1.7498 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 2.0932 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 2.0423 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.7154 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 1.7044 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 2.1696 | Train Acc: 0.2381
 Site-QuickDraw | Train Loss: 2.0881 | Train Acc: 0.3333
 Site-Real      | Train Loss: 1.5905 | Train Acc: 0.6825
 Site-Real      | Train Loss: 1.6630 | Train Acc: 0.7302
 Site-Sketch    | Train Loss: 1.6553 | Train Acc: 0.6984
 Site-Sketch    | Train Loss: 1.7332 | Train Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.7565 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.7990 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.0382 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1156 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 1.5863 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 1.8886 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 2.0660 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.1352 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.6635 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 1.6771 | Val  Acc: 0.7143
 Site-Sketch    | Val  Loss: 1.7117 | Val  Acc: 0.6429
 Site-Sketch    | Val  Loss: 1.7525 | Val  Acc: 0.6190
Average Valid Accuracy: 0.5258
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3095
 Best site-Painting   | Epoch:1 | Val Acc: 0.7857
 Best site-Painting   | Epoch:1 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3095
 Best site-Real       | Epoch:1 | Val Acc: 0.6429
 Best site-Real       | Epoch:1 | Val Acc: 0.7143
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6429
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.5211 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 1.5174 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 2.0459 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.9231 | Train Acc: 0.3968
 Site-Painting  | Train Loss: 1.4382 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 1.4051 | Train Acc: 0.7619
 Site-QuickDraw | Train Loss: 2.1133 | Train Acc: 0.3016
 Site-QuickDraw | Train Loss: 1.9943 | Train Acc: 0.4286
 Site-Real      | Train Loss: 1.3021 | Train Acc: 0.8730
 Site-Real      | Train Loss: 1.2870 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 1.4320 | Train Acc: 0.6349
 Site-Sketch    | Train Loss: 1.4922 | Train Acc: 0.6825
 Site-Clipart   | Val  Loss: 1.5077 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.5139 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.8669 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 1.9951 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.3013 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 1.5714 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.9390 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.0312 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.2886 | Val  Acc: 0.8571
 Site-Real      | Val  Loss: 1.3498 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.4533 | Val  Acc: 0.6905
 Site-Sketch    | Val  Loss: 1.4915 | Val  Acc: 0.6667
Average Valid Accuracy: 0.6210
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3333
 Best site-Painting   | Epoch:2 | Val Acc: 0.8095
 Best site-Painting   | Epoch:2 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3810
 Best site-Real       | Epoch:2 | Val Acc: 0.8571
 Best site-Real       | Epoch:2 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6905
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.2512 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.3095 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 1.8886 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.7414 | Train Acc: 0.4762
 Site-Painting  | Train Loss: 1.1899 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 1.1629 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 1.9978 | Train Acc: 0.3651
 Site-QuickDraw | Train Loss: 1.8666 | Train Acc: 0.4286
 Site-Real      | Train Loss: 1.0323 | Train Acc: 0.8889
 Site-Real      | Train Loss: 1.0347 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 1.1851 | Train Acc: 0.7778
 Site-Sketch    | Train Loss: 1.2848 | Train Acc: 0.6984
 Site-Clipart   | Val  Loss: 1.3775 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.3522 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7307 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.9268 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 1.0589 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.3047 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.8074 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.9582 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.0293 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 1.1200 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.2552 | Val  Acc: 0.7143
 Site-Sketch    | Val  Loss: 1.4153 | Val  Acc: 0.6667
Average Valid Accuracy: 0.6409
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3571
 Best site-Painting   | Epoch:3 | Val Acc: 0.8571
 Best site-Painting   | Epoch:3 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3571
 Best site-Real       | Epoch:3 | Val Acc: 0.8810
 Best site-Real       | Epoch:3 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7143
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.2162 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.1653 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.8424 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.6410 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 1.0152 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.9939 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 1.9113 | Train Acc: 0.3810
 Site-QuickDraw | Train Loss: 1.7280 | Train Acc: 0.4762
 Site-Real      | Train Loss: 0.8480 | Train Acc: 0.8571
 Site-Real      | Train Loss: 0.8807 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 1.0018 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 1.1170 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 1.1287 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.1507 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.6543 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.8023 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.9236 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.0859 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.7010 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 1.8792 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.8079 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.8950 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.1182 | Val  Acc: 0.7381
 Site-Sketch    | Val  Loss: 1.2431 | Val  Acc: 0.7619
Average Valid Accuracy: 0.6885
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4286
 Best site-Painting   | Epoch:4 | Val Acc: 0.8571
 Best site-Painting   | Epoch:4 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3571
 Best site-Real       | Epoch:4 | Val Acc: 0.9286
 Best site-Real       | Epoch:4 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7381
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.9696 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.0142 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.7897 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.5773 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 0.8933 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.8315 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.8129 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 1.6405 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.7626 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.6960 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.9354 | Train Acc: 0.7460
 Site-Sketch    | Train Loss: 0.9893 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 1.0187 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.0823 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.5427 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.7389 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.7545 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 1.0566 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.5943 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 1.7469 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.7527 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.7548 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.9801 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.0972 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7123
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4048
 Best site-Painting   | Epoch:5 | Val Acc: 0.9048
 Best site-Painting   | Epoch:5 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4762
 Best site-Real       | Epoch:5 | Val Acc: 0.9048
 Best site-Real       | Epoch:5 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.9241 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.9237 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.7423 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.5194 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 0.7852 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.7756 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.7555 | Train Acc: 0.4127
 Site-QuickDraw | Train Loss: 1.5632 | Train Acc: 0.5079
 Site-Real      | Train Loss: 0.6665 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.6218 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.8787 | Train Acc: 0.7619
 Site-Sketch    | Train Loss: 0.8691 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9444 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.9686 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.4296 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6240 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.6763 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.9375 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.5158 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.6177 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.5969 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.6523 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.9065 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.9482 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7381
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5000
 Best site-Painting   | Epoch:6 | Val Acc: 0.8810
 Best site-Painting   | Epoch:6 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5238
 Best site-Real       | Epoch:6 | Val Acc: 0.9286
 Best site-Real       | Epoch:6 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.7917 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.8470 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.6738 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.4508 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 0.7200 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.6453 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.6469 | Train Acc: 0.4603
 Site-QuickDraw | Train Loss: 1.4543 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.5645 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.5386 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.7700 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 0.8319 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9032 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.8569 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.4323 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.6321 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.6027 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.8076 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.3528 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.5804 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.5099 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.5757 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.7873 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.8763 | Val  Acc: 0.8095
Average Valid Accuracy: 0.7599
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5000
 Best site-Painting   | Epoch:7 | Val Acc: 0.9286
 Best site-Painting   | Epoch:7 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5238
 Best site-Real       | Epoch:7 | Val Acc: 0.9524
 Best site-Real       | Epoch:7 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.7339 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.7813 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.6241 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.4001 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.6634 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.5925 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.5649 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 1.4324 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.5250 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.4822 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.6470 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.7172 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.8092 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7392 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.3657 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.5159 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.5534 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.7027 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.3814 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 1.5076 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.5450 | Val  Acc: 0.8571
 Site-Real      | Val  Loss: 0.5206 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.7549 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8015 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7639
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5476
 Best site-Painting   | Epoch:8 | Val Acc: 0.9048
 Best site-Painting   | Epoch:8 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5238
 Best site-Real       | Epoch:8 | Val Acc: 0.8571
 Best site-Real       | Epoch:8 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.7160 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.7516 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.5792 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.3822 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 0.6004 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.5586 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.5138 | Train Acc: 0.5397
 Site-QuickDraw | Train Loss: 1.3187 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.4272 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.4113 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.6818 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.6830 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.7628 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7728 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3235 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.4783 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4314 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.7158 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.2412 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.4502 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.4435 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.4573 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6631 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7836 | Val  Acc: 0.8810
Average Valid Accuracy: 0.7738
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5000
 Best site-Painting   | Epoch:9 | Val Acc: 0.9524
 Best site-Painting   | Epoch:9 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.5476
 Best site-Real       | Epoch:9 | Val Acc: 0.9524
 Best site-Real       | Epoch:9 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/CoCoOP...
===2023-03-28 16:21:35===
===2023-03-28 16:21:36===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.7947
 Test site-Infograph | Epoch:9 | Test Acc: 0.4795
 Test site-Painting  | Epoch:9 | Test Acc: 0.8659
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.4920
 Test site-Real      | Epoch:9 | Test Acc: 0.9236
 Test site-Sketch    | Epoch:9 | Test Acc: 0.8321
Average Test Accuracy: 0.7313
