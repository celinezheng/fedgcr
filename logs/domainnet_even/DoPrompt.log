===2023-03-28 12:19:16===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.2384 | Train Acc: 0.1935
 Site-Clipart   | Train Loss: 2.1757 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.1844 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.2548 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.1461 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.2241 | Train Acc: 0.3226
 Site-QuickDraw | Train Loss: 2.3097 | Train Acc: 0.1935
 Site-QuickDraw | Train Loss: 2.2586 | Train Acc: 0.1613
 Site-Real      | Train Loss: 2.1413 | Train Acc: 0.0968
 Site-Real      | Train Loss: 2.1325 | Train Acc: 0.2581
 Site-Sketch    | Train Loss: 2.0898 | Train Acc: 0.1613
 Site-Sketch    | Train Loss: 2.1342 | Train Acc: 0.2258
 Site-Clipart   | Val  Loss: 2.1563 | Val  Acc: 0.3500
 Site-Clipart   | Val  Loss: 2.3347 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.0718 | Val  Acc: 0.1500
 Site-Infograph | Val  Loss: 2.3296 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 2.2190 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.1178 | Val  Acc: 0.3000
 Site-QuickDraw | Val  Loss: 2.2892 | Val  Acc: 0.1000
 Site-QuickDraw | Val  Loss: 2.3337 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 2.2886 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.9717 | Val  Acc: 0.3500
 Site-Sketch    | Val  Loss: 2.0947 | Val  Acc: 0.2000
 Site-Sketch    | Val  Loss: 2.0724 | Val  Acc: 0.1500
Average Valid Accuracy: 0.2083
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3500
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1500
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1000
 Best site-Painting   | Epoch:0 | Val Acc: 0.3000
 Best site-Painting   | Epoch:0 | Val Acc: 0.3000
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1000
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1000
 Best site-Real       | Epoch:0 | Val Acc: 0.2000
 Best site-Real       | Epoch:0 | Val Acc: 0.3500
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 2.0299 | Train Acc: 0.2258
 Site-Clipart   | Train Loss: 2.0274 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.1627 | Train Acc: 0.1935
 Site-Infograph | Train Loss: 2.1932 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.0196 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 2.1243 | Train Acc: 0.2903
 Site-QuickDraw | Train Loss: 2.2906 | Train Acc: 0.1290
 Site-QuickDraw | Train Loss: 2.1883 | Train Acc: 0.3226
 Site-Real      | Train Loss: 1.9259 | Train Acc: 0.3226
 Site-Real      | Train Loss: 1.8678 | Train Acc: 0.3871
 Site-Sketch    | Train Loss: 1.9210 | Train Acc: 0.2903
 Site-Sketch    | Train Loss: 1.9689 | Train Acc: 0.3548
 Site-Clipart   | Val  Loss: 1.8868 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 2.1204 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.0996 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.1955 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.9296 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.9953 | Val  Acc: 0.4000
 Site-QuickDraw | Val  Loss: 2.2125 | Val  Acc: 0.3000
 Site-QuickDraw | Val  Loss: 2.1934 | Val  Acc: 0.1500
 Site-Real      | Val  Loss: 2.0637 | Val  Acc: 0.3500
 Site-Real      | Val  Loss: 1.7248 | Val  Acc: 0.3000
 Site-Sketch    | Val  Loss: 1.9809 | Val  Acc: 0.2000
 Site-Sketch    | Val  Loss: 1.9042 | Val  Acc: 0.3000
Average Valid Accuracy: 0.2875
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2000
 Best site-Painting   | Epoch:1 | Val Acc: 0.3000
 Best site-Painting   | Epoch:1 | Val Acc: 0.4000
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3000
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1500
 Best site-Real       | Epoch:1 | Val Acc: 0.3500
 Best site-Real       | Epoch:1 | Val Acc: 0.3000
 Best site-Sketch     | Epoch:1 | Val Acc: 0.2000
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.9262 | Train Acc: 0.3226
 Site-Clipart   | Train Loss: 1.9454 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.1036 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.1548 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.7818 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 1.9451 | Train Acc: 0.3548
 Site-QuickDraw | Train Loss: 2.2132 | Train Acc: 0.1935
 Site-QuickDraw | Train Loss: 2.1542 | Train Acc: 0.3226
 Site-Real      | Train Loss: 1.7972 | Train Acc: 0.5806
 Site-Real      | Train Loss: 1.7250 | Train Acc: 0.4516
 Site-Sketch    | Train Loss: 1.7135 | Train Acc: 0.5806
 Site-Sketch    | Train Loss: 1.8759 | Train Acc: 0.3871
 Site-Clipart   | Val  Loss: 1.8359 | Val  Acc: 0.4500
 Site-Clipart   | Val  Loss: 1.9845 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.0129 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.1761 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.8102 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.9015 | Val  Acc: 0.4500
 Site-QuickDraw | Val  Loss: 2.1631 | Val  Acc: 0.3000
 Site-QuickDraw | Val  Loss: 2.1667 | Val  Acc: 0.1500
 Site-Real      | Val  Loss: 1.8838 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 1.5369 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.8898 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.7575 | Val  Acc: 0.4500
Average Valid Accuracy: 0.3875
 Best site-Clipart    | Epoch:2 | Val Acc: 0.4500
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3000
 Best site-Painting   | Epoch:2 | Val Acc: 0.4000
 Best site-Painting   | Epoch:2 | Val Acc: 0.4500
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3000
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1500
 Best site-Real       | Epoch:2 | Val Acc: 0.5000
 Best site-Real       | Epoch:2 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:2 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:2 | Val Acc: 0.4500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.7511 | Train Acc: 0.5806
 Site-Clipart   | Train Loss: 1.8071 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 2.0307 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.0602 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.6613 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 1.7882 | Train Acc: 0.4839
 Site-QuickDraw | Train Loss: 2.1150 | Train Acc: 0.3548
 Site-QuickDraw | Train Loss: 2.1388 | Train Acc: 0.2581
 Site-Real      | Train Loss: 1.5570 | Train Acc: 0.7097
 Site-Real      | Train Loss: 1.5271 | Train Acc: 0.6774
 Site-Sketch    | Train Loss: 1.6107 | Train Acc: 0.5806
 Site-Sketch    | Train Loss: 1.6434 | Train Acc: 0.5806
 Site-Clipart   | Val  Loss: 1.7097 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.8366 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 1.9617 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.1941 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.6705 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 1.7377 | Val  Acc: 0.5500
 Site-QuickDraw | Val  Loss: 2.0547 | Val  Acc: 0.4000
 Site-QuickDraw | Val  Loss: 2.1437 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 1.6896 | Val  Acc: 0.7500
 Site-Real      | Val  Loss: 1.4412 | Val  Acc: 0.6000
 Site-Sketch    | Val  Loss: 1.7139 | Val  Acc: 0.6500
 Site-Sketch    | Val  Loss: 1.5888 | Val  Acc: 0.4500
Average Valid Accuracy: 0.4792
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3500
 Best site-Painting   | Epoch:3 | Val Acc: 0.4500
 Best site-Painting   | Epoch:3 | Val Acc: 0.5500
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4000
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4000
 Best site-Real       | Epoch:3 | Val Acc: 0.7500
 Best site-Real       | Epoch:3 | Val Acc: 0.6000
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6500
 Best site-Sketch     | Epoch:3 | Val Acc: 0.4500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.5801 | Train Acc: 0.6452
 Site-Clipart   | Train Loss: 1.7129 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.9995 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 2.0502 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.5026 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 1.6230 | Train Acc: 0.6129
 Site-QuickDraw | Train Loss: 2.0582 | Train Acc: 0.3871
 Site-QuickDraw | Train Loss: 1.9927 | Train Acc: 0.4516
 Site-Real      | Train Loss: 1.4445 | Train Acc: 0.7742
 Site-Real      | Train Loss: 1.4627 | Train Acc: 0.7419
 Site-Sketch    | Train Loss: 1.4036 | Train Acc: 0.8065
 Site-Sketch    | Train Loss: 1.5057 | Train Acc: 0.6129
 Site-Clipart   | Val  Loss: 1.5789 | Val  Acc: 0.6500
 Site-Clipart   | Val  Loss: 1.7081 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9013 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.0243 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.6728 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 1.5333 | Val  Acc: 0.7000
 Site-QuickDraw | Val  Loss: 1.9719 | Val  Acc: 0.3500
 Site-QuickDraw | Val  Loss: 2.0725 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.5279 | Val  Acc: 0.8000
 Site-Real      | Val  Loss: 1.2537 | Val  Acc: 0.7500
 Site-Sketch    | Val  Loss: 1.5058 | Val  Acc: 0.6500
 Site-Sketch    | Val  Loss: 1.3565 | Val  Acc: 0.7500
Average Valid Accuracy: 0.5500
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6500
 Best site-Clipart    | Epoch:4 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3500
 Best site-Painting   | Epoch:4 | Val Acc: 0.4500
 Best site-Painting   | Epoch:4 | Val Acc: 0.7000
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3500
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3000
 Best site-Real       | Epoch:4 | Val Acc: 0.8000
 Best site-Real       | Epoch:4 | Val Acc: 0.7500
 Best site-Sketch     | Epoch:4 | Val Acc: 0.6500
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 1.5242 | Train Acc: 0.6129
 Site-Clipart   | Train Loss: 1.6214 | Train Acc: 0.5161
 Site-Infograph | Train Loss: 1.9235 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.9785 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.3612 | Train Acc: 0.8065
 Site-Painting  | Train Loss: 1.6034 | Train Acc: 0.6774
 Site-QuickDraw | Train Loss: 2.0126 | Train Acc: 0.4194
 Site-QuickDraw | Train Loss: 1.9715 | Train Acc: 0.4194
 Site-Real      | Train Loss: 1.2723 | Train Acc: 0.9032
 Site-Real      | Train Loss: 1.2744 | Train Acc: 0.8387
 Site-Sketch    | Train Loss: 1.3448 | Train Acc: 0.8387
 Site-Sketch    | Train Loss: 1.4295 | Train Acc: 0.8387
 Site-Clipart   | Val  Loss: 1.5420 | Val  Acc: 0.5500
 Site-Clipart   | Val  Loss: 1.5325 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8335 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.0492 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.4746 | Val  Acc: 0.6500
 Site-Painting  | Val  Loss: 1.4697 | Val  Acc: 0.7500
 Site-QuickDraw | Val  Loss: 1.8996 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.9876 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 1.3915 | Val  Acc: 0.8500
 Site-Real      | Val  Loss: 1.0659 | Val  Acc: 0.9500
 Site-Sketch    | Val  Loss: 1.5169 | Val  Acc: 0.7000
 Site-Sketch    | Val  Loss: 1.3012 | Val  Acc: 0.7500
Average Valid Accuracy: 0.6042
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5500
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3000
 Best site-Painting   | Epoch:5 | Val Acc: 0.6500
 Best site-Painting   | Epoch:5 | Val Acc: 0.7500
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4000
 Best site-Real       | Epoch:5 | Val Acc: 0.8500
 Best site-Real       | Epoch:5 | Val Acc: 0.9500
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 1.3315 | Train Acc: 0.7419
 Site-Clipart   | Train Loss: 1.5125 | Train Acc: 0.6452
 Site-Infograph | Train Loss: 2.0049 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.9533 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.2598 | Train Acc: 0.8710
 Site-Painting  | Train Loss: 1.4484 | Train Acc: 0.7419
 Site-QuickDraw | Train Loss: 2.0222 | Train Acc: 0.4839
 Site-QuickDraw | Train Loss: 1.8997 | Train Acc: 0.5484
 Site-Real      | Train Loss: 1.1017 | Train Acc: 0.9032
 Site-Real      | Train Loss: 1.1273 | Train Acc: 0.9677
 Site-Sketch    | Train Loss: 1.2674 | Train Acc: 0.8065
 Site-Sketch    | Train Loss: 1.3233 | Train Acc: 0.7419
 Site-Clipart   | Val  Loss: 1.4418 | Val  Acc: 0.6500
 Site-Clipart   | Val  Loss: 1.4623 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.7150 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.0119 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 1.3450 | Val  Acc: 0.6500
 Site-Painting  | Val  Loss: 1.3749 | Val  Acc: 0.8000
 Site-QuickDraw | Val  Loss: 1.7318 | Val  Acc: 0.6000
 Site-QuickDraw | Val  Loss: 1.8756 | Val  Acc: 0.6500
 Site-Real      | Val  Loss: 1.1633 | Val  Acc: 0.9000
 Site-Real      | Val  Loss: 1.0085 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 1.4170 | Val  Acc: 0.7000
 Site-Sketch    | Val  Loss: 1.1386 | Val  Acc: 0.8000
Average Valid Accuracy: 0.6792
 Best site-Clipart    | Epoch:6 | Val Acc: 0.6500
 Best site-Clipart    | Epoch:6 | Val Acc: 0.5500
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4500
 Best site-Painting   | Epoch:6 | Val Acc: 0.6500
 Best site-Painting   | Epoch:6 | Val Acc: 0.8000
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6000
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6500
 Best site-Real       | Epoch:6 | Val Acc: 0.9000
 Best site-Real       | Epoch:6 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7000
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 1.2882 | Train Acc: 0.7742
 Site-Clipart   | Train Loss: 1.4391 | Train Acc: 0.6129
 Site-Infograph | Train Loss: 1.8549 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.8355 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.1682 | Train Acc: 0.8387
 Site-Painting  | Train Loss: 1.3281 | Train Acc: 0.7742
 Site-QuickDraw | Train Loss: 1.9955 | Train Acc: 0.3548
 Site-QuickDraw | Train Loss: 1.8608 | Train Acc: 0.5484
 Site-Real      | Train Loss: 1.0628 | Train Acc: 0.9355
 Site-Real      | Train Loss: 1.0649 | Train Acc: 0.8710
 Site-Sketch    | Train Loss: 1.1334 | Train Acc: 0.8065
 Site-Sketch    | Train Loss: 1.2433 | Train Acc: 0.8065
 Site-Clipart   | Val  Loss: 1.2907 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.3400 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.7837 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8851 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 1.2510 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.1464 | Val  Acc: 0.8000
 Site-QuickDraw | Val  Loss: 1.7820 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.8752 | Val  Acc: 0.6000
 Site-Real      | Val  Loss: 1.0723 | Val  Acc: 0.8000
 Site-Real      | Val  Loss: 0.8660 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 1.2799 | Val  Acc: 0.8500
 Site-Sketch    | Val  Loss: 1.0109 | Val  Acc: 0.7000
Average Valid Accuracy: 0.6958
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6500
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4500
 Best site-Painting   | Epoch:7 | Val Acc: 0.8000
 Best site-Painting   | Epoch:7 | Val Acc: 0.8000
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.6000
 Best site-Real       | Epoch:7 | Val Acc: 0.8000
 Best site-Real       | Epoch:7 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8500
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 1.2382 | Train Acc: 0.7097
 Site-Clipart   | Train Loss: 1.2685 | Train Acc: 0.7419
 Site-Infograph | Train Loss: 1.8792 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.7641 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.0398 | Train Acc: 0.9032
 Site-Painting  | Train Loss: 1.2572 | Train Acc: 0.7742
 Site-QuickDraw | Train Loss: 1.9062 | Train Acc: 0.3548
 Site-QuickDraw | Train Loss: 1.8472 | Train Acc: 0.5484
 Site-Real      | Train Loss: 0.9209 | Train Acc: 0.9355
 Site-Real      | Train Loss: 0.9280 | Train Acc: 0.9677
 Site-Sketch    | Train Loss: 1.0338 | Train Acc: 0.9355
 Site-Sketch    | Train Loss: 1.1432 | Train Acc: 0.8065
 Site-Clipart   | Val  Loss: 1.2817 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.2039 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.6853 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9006 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.2094 | Val  Acc: 0.9000
 Site-Painting  | Val  Loss: 1.0566 | Val  Acc: 0.9000
 Site-QuickDraw | Val  Loss: 1.7443 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.8754 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 1.1456 | Val  Acc: 0.9000
 Site-Real      | Val  Loss: 0.8089 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 1.2500 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 0.9842 | Val  Acc: 0.7500
Average Valid Accuracy: 0.7208
 Best site-Clipart    | Epoch:8 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:8 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9000
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.4000
 Best site-Real       | Epoch:8 | Val Acc: 0.9000
 Best site-Real       | Epoch:8 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:8 | Val Acc: 0.7500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 1.1583 | Train Acc: 0.8065
 Site-Clipart   | Train Loss: 1.2550 | Train Acc: 0.6774
 Site-Infograph | Train Loss: 1.8305 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.7634 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 1.0232 | Train Acc: 0.8710
 Site-Painting  | Train Loss: 1.1285 | Train Acc: 0.8710
 Site-QuickDraw | Train Loss: 1.9511 | Train Acc: 0.4194
 Site-QuickDraw | Train Loss: 1.7719 | Train Acc: 0.6129
 Site-Real      | Train Loss: 0.7668 | Train Acc: 0.9677
 Site-Real      | Train Loss: 0.9201 | Train Acc: 0.9032
 Site-Sketch    | Train Loss: 0.9249 | Train Acc: 0.8710
 Site-Sketch    | Train Loss: 1.0871 | Train Acc: 0.8387
 Site-Clipart   | Val  Loss: 1.2353 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.2394 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.6664 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.6953 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 1.0777 | Val  Acc: 0.9000
 Site-Painting  | Val  Loss: 0.9660 | Val  Acc: 0.9000
 Site-QuickDraw | Val  Loss: 1.7048 | Val  Acc: 0.7000
 Site-QuickDraw | Val  Loss: 1.7935 | Val  Acc: 0.6000
 Site-Real      | Val  Loss: 0.8693 | Val  Acc: 0.9000
 Site-Real      | Val  Loss: 0.6934 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 1.2184 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 0.8005 | Val  Acc: 0.8000
Average Valid Accuracy: 0.7500
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5500
 Best site-Painting   | Epoch:9 | Val Acc: 0.9000
 Best site-Painting   | Epoch:9 | Val Acc: 0.9000
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.7000
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.6000
 Best site-Real       | Epoch:9 | Val Acc: 0.9000
 Best site-Real       | Epoch:9 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
===2023-03-28 12:35:21===
===2023-03-28 12:35:23===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.6958
 Test site-Infograph | Epoch:9 | Test Acc: 0.3973
 Test site-Painting  | Epoch:9 | Test Acc: 0.7803
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.4660
 Test site-Real      | Epoch:9 | Test Acc: 0.8595
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7112
Average Test Accuracy: 0.6517
===2023-03-28 17:36:17===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0879 | Train Acc: 0.3492
 Site-Clipart   | Train Loss: 2.0039 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 2.1907 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1905 | Train Acc: 0.2381
 Site-Painting  | Train Loss: 2.0168 | Train Acc: 0.3492
 Site-Painting  | Train Loss: 2.0835 | Train Acc: 0.3492
 Site-QuickDraw | Train Loss: 2.2693 | Train Acc: 0.1429
 Site-QuickDraw | Train Loss: 2.2236 | Train Acc: 0.1905
 Site-Real      | Train Loss: 1.9600 | Train Acc: 0.4127
 Site-Real      | Train Loss: 2.0357 | Train Acc: 0.3175
 Site-Sketch    | Train Loss: 1.9576 | Train Acc: 0.4603
 Site-Sketch    | Train Loss: 1.9614 | Train Acc: 0.4762
 Site-Clipart   | Val  Loss: 2.0149 | Val  Acc: 0.3810
 Site-Clipart   | Val  Loss: 2.0702 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1700 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1757 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.9998 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 2.1616 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.1881 | Val  Acc: 0.2143
 Site-QuickDraw | Val  Loss: 2.1907 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.9757 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 2.0410 | Val  Acc: 0.4524
 Site-Sketch    | Val  Loss: 1.9540 | Val  Acc: 0.4286
 Site-Sketch    | Val  Loss: 2.0087 | Val  Acc: 0.3333
Average Valid Accuracy: 0.3274
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Painting   | Epoch:0 | Val Acc: 0.3333
 Best site-Painting   | Epoch:0 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2143
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2619
 Best site-Real       | Epoch:0 | Val Acc: 0.3810
 Best site-Real       | Epoch:0 | Val Acc: 0.4524
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4286
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.8021 | Train Acc: 0.4921
 Site-Clipart   | Train Loss: 1.7291 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 2.1082 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 2.0463 | Train Acc: 0.3810
 Site-Painting  | Train Loss: 1.6948 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 1.7652 | Train Acc: 0.5397
 Site-QuickDraw | Train Loss: 2.2137 | Train Acc: 0.2222
 Site-QuickDraw | Train Loss: 2.0713 | Train Acc: 0.3810
 Site-Real      | Train Loss: 1.6084 | Train Acc: 0.6825
 Site-Real      | Train Loss: 1.6807 | Train Acc: 0.6667
 Site-Sketch    | Train Loss: 1.6786 | Train Acc: 0.6032
 Site-Sketch    | Train Loss: 1.7130 | Train Acc: 0.6508
 Site-Clipart   | Val  Loss: 1.7245 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.7527 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 2.0262 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1358 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 1.6776 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 1.8808 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 2.0865 | Val  Acc: 0.4048
 Site-QuickDraw | Val  Loss: 2.1898 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.6291 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 1.7016 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.6784 | Val  Acc: 0.6429
 Site-Sketch    | Val  Loss: 1.7869 | Val  Acc: 0.5952
Average Valid Accuracy: 0.5159
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2143
 Best site-Painting   | Epoch:1 | Val Acc: 0.5952
 Best site-Painting   | Epoch:1 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.4048
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2619
 Best site-Real       | Epoch:1 | Val Acc: 0.7143
 Best site-Real       | Epoch:1 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6429
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.5440 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.5740 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 2.0164 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 1.8938 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.4491 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 1.4798 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 2.1172 | Train Acc: 0.2540
 Site-QuickDraw | Train Loss: 1.9879 | Train Acc: 0.3492
 Site-Real      | Train Loss: 1.3229 | Train Acc: 0.8413
 Site-Real      | Train Loss: 1.3780 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 1.4581 | Train Acc: 0.6667
 Site-Sketch    | Train Loss: 1.5053 | Train Acc: 0.6984
 Site-Clipart   | Val  Loss: 1.5528 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.5534 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.8707 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.0204 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.4116 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 1.6381 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 1.9665 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.0527 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.3273 | Val  Acc: 0.8571
 Site-Real      | Val  Loss: 1.3993 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.4749 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.5988 | Val  Acc: 0.6429
Average Valid Accuracy: 0.6032
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3333
 Best site-Painting   | Epoch:2 | Val Acc: 0.7381
 Best site-Painting   | Epoch:2 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3095
 Best site-Real       | Epoch:2 | Val Acc: 0.8571
 Best site-Real       | Epoch:2 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.3652 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.3255 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 1.9302 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.8350 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.2325 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 1.2963 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 2.0244 | Train Acc: 0.2857
 Site-QuickDraw | Train Loss: 1.9242 | Train Acc: 0.3651
 Site-Real      | Train Loss: 1.0609 | Train Acc: 0.8889
 Site-Real      | Train Loss: 1.1183 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 1.2009 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 1.2738 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 1.3858 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.3195 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.7708 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.8760 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.1872 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 1.4251 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.8658 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 1.9852 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.0962 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 1.1641 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.2402 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.3185 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6250
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-Painting   | Epoch:3 | Val Acc: 0.7857
 Best site-Painting   | Epoch:3 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3095
 Best site-Real       | Epoch:3 | Val Acc: 0.8810
 Best site-Real       | Epoch:3 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.2269 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.2016 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.8572 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.7128 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 1.0669 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 1.1462 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 1.9301 | Train Acc: 0.3651
 Site-QuickDraw | Train Loss: 1.8266 | Train Acc: 0.4127
 Site-Real      | Train Loss: 0.8989 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.9153 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 1.1293 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.2053 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 1.1725 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.1721 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.6685 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8086 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.9915 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 1.1839 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.7894 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 1.9243 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.9242 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.9721 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.1558 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.2596 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6667
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4762
 Best site-Painting   | Epoch:4 | Val Acc: 0.8333
 Best site-Painting   | Epoch:4 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2857
 Best site-Real       | Epoch:4 | Val Acc: 0.9286
 Best site-Real       | Epoch:4 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 1.1439 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.0846 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.8087 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.5991 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 0.9417 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 1.0300 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.8676 | Train Acc: 0.3651
 Site-QuickDraw | Train Loss: 1.7322 | Train Acc: 0.4286
 Site-Real      | Train Loss: 0.7761 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.7531 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.9531 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.0439 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 1.1414 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.1187 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.5556 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.8163 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.9044 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 1.1173 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.6296 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.8648 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.7762 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.7979 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.0403 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.0907 | Val  Acc: 0.7857
Average Valid Accuracy: 0.6944
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4286
 Best site-Painting   | Epoch:5 | Val Acc: 0.8095
 Best site-Painting   | Epoch:5 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3810
 Best site-Real       | Epoch:5 | Val Acc: 0.9524
 Best site-Real       | Epoch:5 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 1.0618 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.0207 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.7882 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.5526 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.8741 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.9018 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 1.7854 | Train Acc: 0.4286
 Site-QuickDraw | Train Loss: 1.6645 | Train Acc: 0.4603
 Site-Real      | Train Loss: 0.6083 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.6475 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.8604 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 1.0179 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.0239 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.0284 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.4884 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.7230 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.8515 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.0490 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.5640 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.7836 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.6429 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.7208 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.9539 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 1.0386 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7282
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4762
 Best site-Painting   | Epoch:6 | Val Acc: 0.8571
 Best site-Painting   | Epoch:6 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.4524
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Real       | Epoch:6 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.8996 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.9108 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.7629 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.5040 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 0.6971 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.8044 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.6855 | Train Acc: 0.4921
 Site-QuickDraw | Train Loss: 1.5847 | Train Acc: 0.4762
 Site-Real      | Train Loss: 0.5735 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.6161 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.7893 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 0.8975 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 0.9006 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 1.0423 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.4177 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.6554 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.7316 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 0.9129 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.4352 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 1.6488 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.5157 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.6122 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.9533 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 0.9973 | Val  Acc: 0.7381
Average Valid Accuracy: 0.7381
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5000
 Best site-Painting   | Epoch:7 | Val Acc: 0.8571
 Best site-Painting   | Epoch:7 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5238
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Real       | Epoch:7 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.8669 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.8960 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.6748 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.4370 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.7002 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.7474 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.6212 | Train Acc: 0.5556
 Site-QuickDraw | Train Loss: 1.4779 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.5270 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.4976 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.7348 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.8420 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 0.9359 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.9111 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3417 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5759 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.6588 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.8147 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.3636 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.5529 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.5394 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.4969 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7658 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.8867 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7817
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5476
 Best site-Painting   | Epoch:8 | Val Acc: 0.9048
 Best site-Painting   | Epoch:8 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5714
 Best site-Real       | Epoch:8 | Val Acc: 0.9524
 Best site-Real       | Epoch:8 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.8527 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.7639 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.6363 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.4169 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.6017 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.6796 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.6124 | Train Acc: 0.4762
 Site-QuickDraw | Train Loss: 1.4498 | Train Acc: 0.5397
 Site-Real      | Train Loss: 0.4559 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.4482 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.6858 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.7861 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 0.7568 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.7886 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3602 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.5464 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.5255 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.7755 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.2976 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.5247 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.4307 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.4426 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7841 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8287 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7817
===2023-03-28 18:08:28===
===2023-03-28 18:08:29===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:8 | Test Acc: 0.8099
 Test site-Infograph | Epoch:8 | Test Acc: 0.4551
 Test site-Painting  | Epoch:8 | Test Acc: 0.8352
 Test site-QuickDraw | Epoch:8 | Test Acc: 0.5360
 Test site-Real      | Epoch:8 | Test Acc: 0.9162
 Test site-Sketch    | Epoch:8 | Test Acc: 0.8014
Average Test Accuracy: 0.7256
