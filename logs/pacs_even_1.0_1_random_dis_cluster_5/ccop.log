===2023-08-10 19:19:44===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (3) | Train Loss: 1.6158 | Train Acc: 0.5733
 Site-photo                     (3) | Train Loss: 1.4886 | Train Acc: 0.6311
 Site-art_painting              (4) | Train Loss: 1.7779 | Train Acc: 0.2933
 Site-art_painting              (1) | Train Loss: 1.6805 | Train Acc: 0.4022
 Site-cartoon                   (2) | Train Loss: 1.7684 | Train Acc: 0.3333
 Site-cartoon                   (2) | Train Loss: 1.7106 | Train Acc: 0.3156
 Site-sketch                    (0) | Train Loss: 1.7783 | Train Acc: 0.2267
 Site-sketch                    (0) | Train Loss: 1.7646 | Train Acc: 0.2467
Average Train Accuracy: 0.3778
 Site-photo                     (3) | Val  Loss: 1.5287 | Val  Acc: 0.6600
 Site-photo                     (3) | Val  Loss: 1.5713 | Val  Acc: 0.6200
 Site-art_painting              (4) | Val  Loss: 1.6422 | Val  Acc: 0.4500
 Site-art_painting              (1) | Val  Loss: 1.6794 | Val  Acc: 0.4267
 Site-cartoon                   (2) | Val  Loss: 1.7516 | Val  Acc: 0.2700
 Site-cartoon                   (2) | Val  Loss: 1.7579 | Val  Acc: 0.3333
 Site-sketch                    (0) | Val  Loss: 1.7498 | Val  Acc: 0.3100
 Site-sketch                    (0) | Val  Loss: 1.7667 | Val  Acc: 0.2500
Average Valid Accuracy: 0.4150
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.6600
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.6200
 Best site-art_painting             (4)  | Epoch:0 | Val Acc: 0.4500
 Best site-art_painting             (1)  | Epoch:0 | Val Acc: 0.4267
 Best site-cartoon                  (2)  | Epoch:0 | Val Acc: 0.2700
 Best site-cartoon                  (2)  | Epoch:0 | Val Acc: 0.3333
 Best site-sketch                   (0)  | Epoch:0 | Val Acc: 0.3100
 Best site-sketch                   (0)  | Epoch:0 | Val Acc: 0.2500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (0) | Train Loss: 1.2733 | Train Acc: 0.7667
 Site-photo                     (0) | Train Loss: 1.2221 | Train Acc: 0.8133
 Site-art_painting              (3) | Train Loss: 1.5654 | Train Acc: 0.5267
 Site-art_painting              (3) | Train Loss: 1.4966 | Train Acc: 0.5489
 Site-cartoon                   (2) | Train Loss: 1.5770 | Train Acc: 0.4400
 Site-cartoon                   (2) | Train Loss: 1.5658 | Train Acc: 0.5111
 Site-sketch                    (1) | Train Loss: 1.6710 | Train Acc: 0.3800
 Site-sketch                    (4) | Train Loss: 1.6099 | Train Acc: 0.3778
Average Train Accuracy: 0.5456
 Site-photo                     (0) | Val  Loss: 1.2049 | Val  Acc: 0.8600
 Site-photo                     (0) | Val  Loss: 1.2515 | Val  Acc: 0.8033
 Site-art_painting              (3) | Val  Loss: 1.4527 | Val  Acc: 0.5600
 Site-art_painting              (3) | Val  Loss: 1.4676 | Val  Acc: 0.5633
 Site-cartoon                   (2) | Val  Loss: 1.5350 | Val  Acc: 0.5400
 Site-cartoon                   (2) | Val  Loss: 1.5316 | Val  Acc: 0.5000
 Site-sketch                    (1) | Val  Loss: 1.5863 | Val  Acc: 0.3800
 Site-sketch                    (4) | Val  Loss: 1.5748 | Val  Acc: 0.4000
Average Valid Accuracy: 0.5758
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.8600
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.8033
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.5600
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.5633
 Best site-cartoon                  (2)  | Epoch:1 | Val Acc: 0.5400
 Best site-cartoon                  (2)  | Epoch:1 | Val Acc: 0.5000
 Best site-sketch                   (1)  | Epoch:1 | Val Acc: 0.3800
 Best site-sketch                   (4)  | Epoch:1 | Val Acc: 0.4000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (3) | Train Loss: 1.0316 | Train Acc: 0.9133
 Site-photo                     (3) | Train Loss: 1.0202 | Train Acc: 0.9067
 Site-art_painting              (2) | Train Loss: 1.3382 | Train Acc: 0.5933
 Site-art_painting              (2) | Train Loss: 1.2253 | Train Acc: 0.7044
 Site-cartoon                   (4) | Train Loss: 1.4370 | Train Acc: 0.5467
 Site-cartoon                   (0) | Train Loss: 1.3410 | Train Acc: 0.6089
 Site-sketch                    (1) | Train Loss: 1.4796 | Train Acc: 0.4467
 Site-sketch                    (1) | Train Loss: 1.4392 | Train Acc: 0.4511
Average Train Accuracy: 0.6464
 Site-photo                     (3) | Val  Loss: 0.9695 | Val  Acc: 0.9000
 Site-photo                     (3) | Val  Loss: 0.9837 | Val  Acc: 0.8900
 Site-art_painting              (2) | Val  Loss: 1.1975 | Val  Acc: 0.7700
 Site-art_painting              (2) | Val  Loss: 1.2392 | Val  Acc: 0.7100
 Site-cartoon                   (4) | Val  Loss: 1.4108 | Val  Acc: 0.6000
 Site-cartoon                   (0) | Val  Loss: 1.3538 | Val  Acc: 0.6367
 Site-sketch                    (1) | Val  Loss: 1.4279 | Val  Acc: 0.5200
 Site-sketch                    (1) | Val  Loss: 1.4672 | Val  Acc: 0.4700
Average Valid Accuracy: 0.6871
 Best site-photo                    (3)  | Epoch:2 | Val Acc: 0.9000
 Best site-photo                    (3)  | Epoch:2 | Val Acc: 0.8900
 Best site-art_painting             (2)  | Epoch:2 | Val Acc: 0.7700
 Best site-art_painting             (2)  | Epoch:2 | Val Acc: 0.7100
 Best site-cartoon                  (4)  | Epoch:2 | Val Acc: 0.6000
 Best site-cartoon                  (0)  | Epoch:2 | Val Acc: 0.6367
 Best site-sketch                   (1)  | Epoch:2 | Val Acc: 0.5200
 Best site-sketch                   (1)  | Epoch:2 | Val Acc: 0.4700
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (3) | Train Loss: 0.8359 | Train Acc: 0.9333
 Site-photo                     (3) | Train Loss: 0.7683 | Train Acc: 0.9444
 Site-art_painting              (1) | Train Loss: 1.1418 | Train Acc: 0.6933
 Site-art_painting              (1) | Train Loss: 1.1858 | Train Acc: 0.7800
 Site-cartoon                   (2) | Train Loss: 1.2656 | Train Acc: 0.6333
 Site-cartoon                   (4) | Train Loss: 1.1384 | Train Acc: 0.6956
 Site-sketch                    (0) | Train Loss: 1.4270 | Train Acc: 0.4600
 Site-sketch                    (0) | Train Loss: 1.3150 | Train Acc: 0.5378
Average Train Accuracy: 0.7097
 Site-photo                     (3) | Val  Loss: 0.7592 | Val  Acc: 0.9400
 Site-photo                     (3) | Val  Loss: 0.7745 | Val  Acc: 0.9533
 Site-art_painting              (1) | Val  Loss: 1.0199 | Val  Acc: 0.8600
 Site-art_painting              (1) | Val  Loss: 1.0869 | Val  Acc: 0.7733
 Site-cartoon                   (2) | Val  Loss: 1.2093 | Val  Acc: 0.7100
 Site-cartoon                   (4) | Val  Loss: 1.1901 | Val  Acc: 0.6767
 Site-sketch                    (0) | Val  Loss: 1.3301 | Val  Acc: 0.4600
 Site-sketch                    (0) | Val  Loss: 1.3284 | Val  Acc: 0.5100
Average Valid Accuracy: 0.7354
 Best site-photo                    (3)  | Epoch:3 | Val Acc: 0.9400
 Best site-photo                    (3)  | Epoch:3 | Val Acc: 0.9533
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.8600
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.7733
 Best site-cartoon                  (2)  | Epoch:3 | Val Acc: 0.7100
 Best site-cartoon                  (4)  | Epoch:3 | Val Acc: 0.6767
 Best site-sketch                   (0)  | Epoch:3 | Val Acc: 0.4600
 Best site-sketch                   (0)  | Epoch:3 | Val Acc: 0.5100
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (0) | Train Loss: 0.6993 | Train Acc: 0.9400
 Site-photo                     (0) | Train Loss: 0.6471 | Train Acc: 0.9689
 Site-art_painting              (4) | Train Loss: 1.0007 | Train Acc: 0.7733
 Site-art_painting              (3) | Train Loss: 0.9692 | Train Acc: 0.8200
 Site-cartoon                   (2) | Train Loss: 1.0908 | Train Acc: 0.6933
 Site-cartoon                   (2) | Train Loss: 0.9857 | Train Acc: 0.6911
 Site-sketch                    (1) | Train Loss: 1.2182 | Train Acc: 0.5867
 Site-sketch                    (1) | Train Loss: 1.1397 | Train Acc: 0.5889
Average Train Accuracy: 0.7578
 Site-photo                     (0) | Val  Loss: 0.6176 | Val  Acc: 0.9500
 Site-photo                     (0) | Val  Loss: 0.6596 | Val  Acc: 0.9467
 Site-art_painting              (4) | Val  Loss: 0.9279 | Val  Acc: 0.8400
 Site-art_painting              (3) | Val  Loss: 0.8896 | Val  Acc: 0.8200
 Site-cartoon                   (2) | Val  Loss: 1.0488 | Val  Acc: 0.6800
 Site-cartoon                   (2) | Val  Loss: 1.0300 | Val  Acc: 0.7167
 Site-sketch                    (1) | Val  Loss: 1.1395 | Val  Acc: 0.6500
 Site-sketch                    (1) | Val  Loss: 1.1819 | Val  Acc: 0.6000
Average Valid Accuracy: 0.7754
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9500
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9467
 Best site-art_painting             (4)  | Epoch:4 | Val Acc: 0.8400
 Best site-art_painting             (3)  | Epoch:4 | Val Acc: 0.8200
 Best site-cartoon                  (2)  | Epoch:4 | Val Acc: 0.6800
 Best site-cartoon                  (2)  | Epoch:4 | Val Acc: 0.7167
 Best site-sketch                   (1)  | Epoch:4 | Val Acc: 0.6500
 Best site-sketch                   (1)  | Epoch:4 | Val Acc: 0.6000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (3) | Train Loss: 0.6027 | Train Acc: 0.9600
 Site-photo                     (3) | Train Loss: 0.5296 | Train Acc: 0.9578
 Site-art_painting              (4) | Train Loss: 0.8427 | Train Acc: 0.8200
 Site-art_painting              (1) | Train Loss: 0.8085 | Train Acc: 0.8467
 Site-cartoon                   (2) | Train Loss: 0.9823 | Train Acc: 0.7267
 Site-cartoon                   (2) | Train Loss: 0.9259 | Train Acc: 0.7400
 Site-sketch                    (0) | Train Loss: 1.1092 | Train Acc: 0.6200
 Site-sketch                    (0) | Train Loss: 1.1027 | Train Acc: 0.6511
Average Train Accuracy: 0.7903
 Site-photo                     (3) | Val  Loss: 0.4956 | Val  Acc: 0.9300
 Site-photo                     (3) | Val  Loss: 0.5498 | Val  Acc: 0.9500
 Site-art_painting              (4) | Val  Loss: 0.7988 | Val  Acc: 0.8700
 Site-art_painting              (1) | Val  Loss: 0.8082 | Val  Acc: 0.8233
 Site-cartoon                   (2) | Val  Loss: 0.9298 | Val  Acc: 0.7100
 Site-cartoon                   (2) | Val  Loss: 0.9358 | Val  Acc: 0.7300
 Site-sketch                    (0) | Val  Loss: 1.0932 | Val  Acc: 0.6100
 Site-sketch                    (0) | Val  Loss: 1.0455 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7863
 Best site-photo                    (3)  | Epoch:5 | Val Acc: 0.9300
 Best site-photo                    (3)  | Epoch:5 | Val Acc: 0.9500
 Best site-art_painting             (4)  | Epoch:5 | Val Acc: 0.8700
 Best site-art_painting             (1)  | Epoch:5 | Val Acc: 0.8233
 Best site-cartoon                  (2)  | Epoch:5 | Val Acc: 0.7100
 Best site-cartoon                  (2)  | Epoch:5 | Val Acc: 0.7300
 Best site-sketch                   (0)  | Epoch:5 | Val Acc: 0.6100
 Best site-sketch                   (0)  | Epoch:5 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 6 ============
cnt=[3, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (0) | Train Loss: 0.4885 | Train Acc: 0.9600
 Site-photo                     (0) | Train Loss: 0.4344 | Train Acc: 0.9667
 Site-art_painting              (3) | Train Loss: 0.8101 | Train Acc: 0.8400
 Site-art_painting              (0) | Train Loss: 0.6771 | Train Acc: 0.8667
 Site-cartoon                   (2) | Train Loss: 0.8065 | Train Acc: 0.7533
 Site-cartoon                   (2) | Train Loss: 0.7696 | Train Acc: 0.7733
 Site-sketch                    (1) | Train Loss: 0.9912 | Train Acc: 0.7067
 Site-sketch                    (4) | Train Loss: 1.0446 | Train Acc: 0.6889
Average Train Accuracy: 0.8194
 Site-photo                     (0) | Val  Loss: 0.4358 | Val  Acc: 0.9700
 Site-photo                     (0) | Val  Loss: 0.4578 | Val  Acc: 0.9667
 Site-art_painting              (3) | Val  Loss: 0.7454 | Val  Acc: 0.8600
 Site-art_painting              (0) | Val  Loss: 0.7206 | Val  Acc: 0.8567
 Site-cartoon                   (2) | Val  Loss: 0.8052 | Val  Acc: 0.8100
 Site-cartoon                   (2) | Val  Loss: 0.8434 | Val  Acc: 0.7733
 Site-sketch                    (1) | Val  Loss: 0.9969 | Val  Acc: 0.6300
 Site-sketch                    (4) | Val  Loss: 0.9668 | Val  Acc: 0.6967
Average Valid Accuracy: 0.8204
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9700
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9667
 Best site-art_painting             (3)  | Epoch:6 | Val Acc: 0.8600
 Best site-art_painting             (0)  | Epoch:6 | Val Acc: 0.8567
 Best site-cartoon                  (2)  | Epoch:6 | Val Acc: 0.8100
 Best site-cartoon                  (2)  | Epoch:6 | Val Acc: 0.7733
 Best site-sketch                   (1)  | Epoch:6 | Val Acc: 0.6300
 Best site-sketch                   (4)  | Epoch:6 | Val Acc: 0.6967
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (0) | Train Loss: 0.4496 | Train Acc: 0.9600
 Site-photo                     (0) | Train Loss: 0.4127 | Train Acc: 0.9644
 Site-art_painting              (3) | Train Loss: 0.7054 | Train Acc: 0.8600
 Site-art_painting              (3) | Train Loss: 0.6358 | Train Acc: 0.8578
 Site-cartoon                   (2) | Train Loss: 0.8484 | Train Acc: 0.7867
 Site-cartoon                   (2) | Train Loss: 0.7671 | Train Acc: 0.7956
 Site-sketch                    (4) | Train Loss: 0.8557 | Train Acc: 0.7733
 Site-sketch                    (1) | Train Loss: 0.9219 | Train Acc: 0.7178
Average Train Accuracy: 0.8394
 Site-photo                     (0) | Val  Loss: 0.3873 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.3902 | Val  Acc: 0.9633
 Site-art_painting              (3) | Val  Loss: 0.6516 | Val  Acc: 0.9000
 Site-art_painting              (3) | Val  Loss: 0.6359 | Val  Acc: 0.8600
 Site-cartoon                   (2) | Val  Loss: 0.8227 | Val  Acc: 0.7100
 Site-cartoon                   (2) | Val  Loss: 0.7564 | Val  Acc: 0.7933
 Site-sketch                    (4) | Val  Loss: 0.8637 | Val  Acc: 0.7100
 Site-sketch                    (1) | Val  Loss: 0.8813 | Val  Acc: 0.7267
Average Valid Accuracy: 0.8279
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9600
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9633
 Best site-art_painting             (3)  | Epoch:7 | Val Acc: 0.9000
 Best site-art_painting             (3)  | Epoch:7 | Val Acc: 0.8600
 Best site-cartoon                  (2)  | Epoch:7 | Val Acc: 0.7100
 Best site-cartoon                  (2)  | Epoch:7 | Val Acc: 0.7933
 Best site-sketch                   (4)  | Epoch:7 | Val Acc: 0.7100
 Best site-sketch                   (1)  | Epoch:7 | Val Acc: 0.7267
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (3) | Train Loss: 0.4154 | Train Acc: 0.9533
 Site-photo                     (3) | Train Loss: 0.3299 | Train Acc: 0.9711
 Site-art_painting              (0) | Train Loss: 0.6909 | Train Acc: 0.8267
 Site-art_painting              (0) | Train Loss: 0.6710 | Train Acc: 0.8800
 Site-cartoon                   (2) | Train Loss: 0.7391 | Train Acc: 0.7800
 Site-cartoon                   (4) | Train Loss: 0.5983 | Train Acc: 0.8244
 Site-sketch                    (1) | Train Loss: 0.8818 | Train Acc: 0.7200
 Site-sketch                    (1) | Train Loss: 0.8111 | Train Acc: 0.7578
Average Train Accuracy: 0.8392
 Site-photo                     (3) | Val  Loss: 0.3742 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.3735 | Val  Acc: 0.9667
 Site-art_painting              (0) | Val  Loss: 0.6243 | Val  Acc: 0.8800
 Site-art_painting              (0) | Val  Loss: 0.6353 | Val  Acc: 0.8767
 Site-cartoon                   (2) | Val  Loss: 0.7216 | Val  Acc: 0.7900
 Site-cartoon                   (4) | Val  Loss: 0.6955 | Val  Acc: 0.8167
 Site-sketch                    (1) | Val  Loss: 0.8478 | Val  Acc: 0.6500
 Site-sketch                    (1) | Val  Loss: 0.8474 | Val  Acc: 0.7067
Average Valid Accuracy: 0.8296
 Best site-photo                    (3)  | Epoch:8 | Val Acc: 0.9500
 Best site-photo                    (3)  | Epoch:8 | Val Acc: 0.9667
 Best site-art_painting             (0)  | Epoch:8 | Val Acc: 0.8800
 Best site-art_painting             (0)  | Epoch:8 | Val Acc: 0.8767
 Best site-cartoon                  (2)  | Epoch:8 | Val Acc: 0.7900
 Best site-cartoon                  (4)  | Epoch:8 | Val Acc: 0.8167
 Best site-sketch                   (1)  | Epoch:8 | Val Acc: 0.6500
 Best site-sketch                   (1)  | Epoch:8 | Val Acc: 0.7067
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 1, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (4) | Train Loss: 0.3283 | Train Acc: 0.9733
 Site-photo                     (4) | Train Loss: 0.3425 | Train Acc: 0.9689
 Site-art_painting              (3) | Train Loss: 0.6596 | Train Acc: 0.8400
 Site-art_painting              (1) | Train Loss: 0.6310 | Train Acc: 0.8889
 Site-cartoon                   (2) | Train Loss: 0.6566 | Train Acc: 0.8200
 Site-cartoon                   (2) | Train Loss: 0.6129 | Train Acc: 0.8200
 Site-sketch                    (0) | Train Loss: 0.8092 | Train Acc: 0.7533
 Site-sketch                    (0) | Train Loss: 0.7213 | Train Acc: 0.7511
Average Train Accuracy: 0.8519
 Site-photo                     (4) | Val  Loss: 0.3343 | Val  Acc: 0.9600
 Site-photo                     (4) | Val  Loss: 0.3368 | Val  Acc: 0.9667
 Site-art_painting              (3) | Val  Loss: 0.5937 | Val  Acc: 0.8800
 Site-art_painting              (1) | Val  Loss: 0.5692 | Val  Acc: 0.8633
 Site-cartoon                   (2) | Val  Loss: 0.6567 | Val  Acc: 0.8400
 Site-cartoon                   (2) | Val  Loss: 0.6341 | Val  Acc: 0.8300
 Site-sketch                    (0) | Val  Loss: 0.7669 | Val  Acc: 0.7300
 Site-sketch                    (0) | Val  Loss: 0.7925 | Val  Acc: 0.7633
Average Valid Accuracy: 0.8542
 Best site-photo                    (4)  | Epoch:9 | Val Acc: 0.9600
 Best site-photo                    (4)  | Epoch:9 | Val Acc: 0.9667
 Best site-art_painting             (3)  | Epoch:9 | Val Acc: 0.8800
 Best site-art_painting             (1)  | Epoch:9 | Val Acc: 0.8633
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.8400
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.8300
 Best site-sketch                   (0)  | Epoch:9 | Val Acc: 0.7300
 Best site-sketch                   (0)  | Epoch:9 | Val Acc: 0.7633
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 10 ============
cnt=[3, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (0) | Train Loss: 0.3331 | Train Acc: 0.9667
 Site-photo                     (4) | Train Loss: 0.3397 | Train Acc: 0.9733
 Site-art_painting              (0) | Train Loss: 0.5547 | Train Acc: 0.8467
 Site-art_painting              (0) | Train Loss: 0.4760 | Train Acc: 0.8844
 Site-cartoon                   (2) | Train Loss: 0.6399 | Train Acc: 0.7733
 Site-cartoon                   (3) | Train Loss: 0.6995 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.7307 | Train Acc: 0.7600
 Site-sketch                    (1) | Train Loss: 0.6965 | Train Acc: 0.7644
Average Train Accuracy: 0.8486
 Site-photo                     (0) | Val  Loss: 0.2825 | Val  Acc: 0.9500
 Site-photo                     (4) | Val  Loss: 0.2963 | Val  Acc: 0.9733
 Site-art_painting              (0) | Val  Loss: 0.5229 | Val  Acc: 0.9000
 Site-art_painting              (0) | Val  Loss: 0.5123 | Val  Acc: 0.8933
 Site-cartoon                   (2) | Val  Loss: 0.6791 | Val  Acc: 0.7700
 Site-cartoon                   (3) | Val  Loss: 0.6566 | Val  Acc: 0.7933
 Site-sketch                    (1) | Val  Loss: 0.7163 | Val  Acc: 0.7500
 Site-sketch                    (1) | Val  Loss: 0.7636 | Val  Acc: 0.7400
Average Valid Accuracy: 0.8463
============ Train epoch 11 ============
cnt=[2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (3) | Train Loss: 0.2772 | Train Acc: 0.9533
 Site-photo                     (3) | Train Loss: 0.2756 | Train Acc: 0.9667
 Site-art_painting              (2) | Train Loss: 0.5918 | Train Acc: 0.8800
 Site-art_painting              (4) | Train Loss: 0.4920 | Train Acc: 0.8844
 Site-cartoon                   (0) | Train Loss: 0.5585 | Train Acc: 0.8400
 Site-cartoon                   (0) | Train Loss: 0.5021 | Train Acc: 0.8400
 Site-sketch                    (1) | Train Loss: 0.7667 | Train Acc: 0.7733
 Site-sketch                    (1) | Train Loss: 0.6712 | Train Acc: 0.7733
Average Train Accuracy: 0.8639
 Site-photo                     (3) | Val  Loss: 0.3083 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.2913 | Val  Acc: 0.9633
 Site-art_painting              (2) | Val  Loss: 0.5173 | Val  Acc: 0.8900
 Site-art_painting              (4) | Val  Loss: 0.5253 | Val  Acc: 0.8867
 Site-cartoon                   (0) | Val  Loss: 0.6231 | Val  Acc: 0.7900
 Site-cartoon                   (0) | Val  Loss: 0.5762 | Val  Acc: 0.8267
 Site-sketch                    (1) | Val  Loss: 0.7102 | Val  Acc: 0.7700
 Site-sketch                    (1) | Val  Loss: 0.7005 | Val  Acc: 0.8033
Average Valid Accuracy: 0.8600
 Best site-photo                    (3)  | Epoch:11 | Val Acc: 0.9500
 Best site-photo                    (3)  | Epoch:11 | Val Acc: 0.9633
 Best site-art_painting             (2)  | Epoch:11 | Val Acc: 0.8900
 Best site-art_painting             (4)  | Epoch:11 | Val Acc: 0.8867
 Best site-cartoon                  (0)  | Epoch:11 | Val Acc: 0.7900
 Best site-cartoon                  (0)  | Epoch:11 | Val Acc: 0.8267
 Best site-sketch                   (1)  | Epoch:11 | Val Acc: 0.7700
 Best site-sketch                   (1)  | Epoch:11 | Val Acc: 0.8033
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (1) | Train Loss: 0.2420 | Train Acc: 0.9733
 Site-photo                     (1) | Train Loss: 0.2577 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.5547 | Train Acc: 0.8667
 Site-art_painting              (3) | Train Loss: 0.5900 | Train Acc: 0.8911
 Site-cartoon                   (4) | Train Loss: 0.6618 | Train Acc: 0.8067
 Site-cartoon                   (2) | Train Loss: 0.5624 | Train Acc: 0.8289
 Site-sketch                    (0) | Train Loss: 0.7082 | Train Acc: 0.7267
 Site-sketch                    (0) | Train Loss: 0.7222 | Train Acc: 0.7778
Average Train Accuracy: 0.8556
 Site-photo                     (1) | Val  Loss: 0.2405 | Val  Acc: 0.9500
 Site-photo                     (1) | Val  Loss: 0.2394 | Val  Acc: 0.9633
 Site-art_painting              (3) | Val  Loss: 0.4943 | Val  Acc: 0.8600
 Site-art_painting              (3) | Val  Loss: 0.5064 | Val  Acc: 0.8633
 Site-cartoon                   (4) | Val  Loss: 0.6060 | Val  Acc: 0.8200
 Site-cartoon                   (2) | Val  Loss: 0.5691 | Val  Acc: 0.8267
 Site-sketch                    (0) | Val  Loss: 0.7083 | Val  Acc: 0.7500
 Site-sketch                    (0) | Val  Loss: 0.7102 | Val  Acc: 0.7633
Average Valid Accuracy: 0.8496
============ Train epoch 13 ============
cnt=[2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (3) | Train Loss: 0.2571 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.2071 | Train Acc: 0.9822
 Site-art_painting              (0) | Train Loss: 0.5049 | Train Acc: 0.8733
 Site-art_painting              (0) | Train Loss: 0.4058 | Train Acc: 0.9044
 Site-cartoon                   (2) | Train Loss: 0.5954 | Train Acc: 0.8133
 Site-cartoon                   (2) | Train Loss: 0.5034 | Train Acc: 0.8400
 Site-sketch                    (4) | Train Loss: 0.6558 | Train Acc: 0.7733
 Site-sketch                    (1) | Train Loss: 0.6217 | Train Acc: 0.7644
Average Train Accuracy: 0.8647
 Site-photo                     (3) | Val  Loss: 0.2630 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.2374 | Val  Acc: 0.9733
 Site-art_painting              (0) | Val  Loss: 0.5213 | Val  Acc: 0.8600
 Site-art_painting              (0) | Val  Loss: 0.4369 | Val  Acc: 0.8900
 Site-cartoon                   (2) | Val  Loss: 0.5791 | Val  Acc: 0.8000
 Site-cartoon                   (2) | Val  Loss: 0.5524 | Val  Acc: 0.8100
 Site-sketch                    (4) | Val  Loss: 0.6547 | Val  Acc: 0.7700
 Site-sketch                    (1) | Val  Loss: 0.6675 | Val  Acc: 0.7700
Average Valid Accuracy: 0.8542
============ Train epoch 14 ============
cnt=[2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (3) | Train Loss: 0.2221 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.1977 | Train Acc: 0.9733
 Site-art_painting              (0) | Train Loss: 0.4697 | Train Acc: 0.8733
 Site-art_painting              (0) | Train Loss: 0.5042 | Train Acc: 0.8844
 Site-cartoon                   (2) | Train Loss: 0.5612 | Train Acc: 0.8067
 Site-cartoon                   (4) | Train Loss: 0.4620 | Train Acc: 0.8511
 Site-sketch                    (1) | Train Loss: 0.6619 | Train Acc: 0.8067
 Site-sketch                    (1) | Train Loss: 0.6291 | Train Acc: 0.7644
Average Train Accuracy: 0.8683
 Site-photo                     (3) | Val  Loss: 0.2250 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.2197 | Val  Acc: 0.9633
 Site-art_painting              (0) | Val  Loss: 0.4487 | Val  Acc: 0.8700
 Site-art_painting              (0) | Val  Loss: 0.4328 | Val  Acc: 0.8933
 Site-cartoon                   (2) | Val  Loss: 0.5505 | Val  Acc: 0.8100
 Site-cartoon                   (4) | Val  Loss: 0.4842 | Val  Acc: 0.8667
 Site-sketch                    (1) | Val  Loss: 0.6051 | Val  Acc: 0.7900
 Site-sketch                    (1) | Val  Loss: 0.6594 | Val  Acc: 0.7433
Average Valid Accuracy: 0.8621
 Best site-photo                    (3)  | Epoch:14 | Val Acc: 0.9600
 Best site-photo                    (3)  | Epoch:14 | Val Acc: 0.9633
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.8700
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.8933
 Best site-cartoon                  (2)  | Epoch:14 | Val Acc: 0.8100
 Best site-cartoon                  (4)  | Epoch:14 | Val Acc: 0.8667
 Best site-sketch                   (1)  | Epoch:14 | Val Acc: 0.7900
 Best site-sketch                   (1)  | Epoch:14 | Val Acc: 0.7433
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 1, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (0) | Train Loss: 0.1989 | Train Acc: 0.9867
 Site-photo                     (0) | Train Loss: 0.1921 | Train Acc: 0.9711
 Site-art_painting              (4) | Train Loss: 0.4641 | Train Acc: 0.8600
 Site-art_painting              (4) | Train Loss: 0.3656 | Train Acc: 0.9044
 Site-cartoon                   (2) | Train Loss: 0.5436 | Train Acc: 0.8267
 Site-cartoon                   (2) | Train Loss: 0.4474 | Train Acc: 0.8467
 Site-sketch                    (1) | Train Loss: 0.6402 | Train Acc: 0.8000
 Site-sketch                    (3) | Train Loss: 0.5696 | Train Acc: 0.7844
Average Train Accuracy: 0.8725
 Site-photo                     (0) | Val  Loss: 0.2506 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.2113 | Val  Acc: 0.9667
 Site-art_painting              (4) | Val  Loss: 0.4211 | Val  Acc: 0.8800
 Site-art_painting              (4) | Val  Loss: 0.4365 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.5913 | Val  Acc: 0.7700
 Site-cartoon                   (2) | Val  Loss: 0.5009 | Val  Acc: 0.8533
 Site-sketch                    (1) | Val  Loss: 0.6260 | Val  Acc: 0.7700
 Site-sketch                    (3) | Val  Loss: 0.6503 | Val  Acc: 0.8100
Average Valid Accuracy: 0.8638
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9600
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9667
 Best site-art_painting             (4)  | Epoch:15 | Val Acc: 0.8800
 Best site-art_painting             (4)  | Epoch:15 | Val Acc: 0.9000
 Best site-cartoon                  (2)  | Epoch:15 | Val Acc: 0.7700
 Best site-cartoon                  (2)  | Epoch:15 | Val Acc: 0.8533
 Best site-sketch                   (1)  | Epoch:15 | Val Acc: 0.7700
 Best site-sketch                   (3)  | Epoch:15 | Val Acc: 0.8100
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 16 ============
cnt=[2, 2, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (0) | Train Loss: 0.2368 | Train Acc: 0.9600
 Site-photo                     (0) | Train Loss: 0.1818 | Train Acc: 0.9756
 Site-art_painting              (4) | Train Loss: 0.5001 | Train Acc: 0.8533
 Site-art_painting              (4) | Train Loss: 0.4057 | Train Acc: 0.8956
 Site-cartoon                   (2) | Train Loss: 0.5239 | Train Acc: 0.8400
 Site-cartoon                   (3) | Train Loss: 0.4073 | Train Acc: 0.8667
 Site-sketch                    (1) | Train Loss: 0.6716 | Train Acc: 0.7667
 Site-sketch                    (1) | Train Loss: 0.5849 | Train Acc: 0.7778
Average Train Accuracy: 0.8669
 Site-photo                     (0) | Val  Loss: 0.2167 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.2117 | Val  Acc: 0.9667
 Site-art_painting              (4) | Val  Loss: 0.4786 | Val  Acc: 0.8500
 Site-art_painting              (4) | Val  Loss: 0.4604 | Val  Acc: 0.8833
 Site-cartoon                   (2) | Val  Loss: 0.5540 | Val  Acc: 0.8200
 Site-cartoon                   (3) | Val  Loss: 0.4753 | Val  Acc: 0.8500
 Site-sketch                    (1) | Val  Loss: 0.6534 | Val  Acc: 0.7500
 Site-sketch                    (1) | Val  Loss: 0.5890 | Val  Acc: 0.7967
Average Valid Accuracy: 0.8596
============ Train epoch 17 ============
cnt=[1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (3) | Train Loss: 0.2518 | Train Acc: 0.9467
 Site-photo                     (3) | Train Loss: 0.2356 | Train Acc: 0.9644
 Site-art_painting              (2) | Train Loss: 0.5206 | Train Acc: 0.8867
 Site-art_painting              (2) | Train Loss: 0.3903 | Train Acc: 0.9022
 Site-cartoon                   (0) | Train Loss: 0.5036 | Train Acc: 0.8800
 Site-cartoon                   (4) | Train Loss: 0.4553 | Train Acc: 0.8622
 Site-sketch                    (1) | Train Loss: 0.5957 | Train Acc: 0.7733
 Site-sketch                    (1) | Train Loss: 0.5412 | Train Acc: 0.7800
Average Train Accuracy: 0.8744
 Site-photo                     (3) | Val  Loss: 0.1956 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.2078 | Val  Acc: 0.9700
 Site-art_painting              (2) | Val  Loss: 0.4364 | Val  Acc: 0.8800
 Site-art_painting              (2) | Val  Loss: 0.4073 | Val  Acc: 0.9067
 Site-cartoon                   (0) | Val  Loss: 0.4618 | Val  Acc: 0.8400
 Site-cartoon                   (4) | Val  Loss: 0.4620 | Val  Acc: 0.8500
 Site-sketch                    (1) | Val  Loss: 0.5523 | Val  Acc: 0.7800
 Site-sketch                    (1) | Val  Loss: 0.6034 | Val  Acc: 0.7900
Average Valid Accuracy: 0.8708
 Best site-photo                    (3)  | Epoch:17 | Val Acc: 0.9500
 Best site-photo                    (3)  | Epoch:17 | Val Acc: 0.9700
 Best site-art_painting             (2)  | Epoch:17 | Val Acc: 0.8800
 Best site-art_painting             (2)  | Epoch:17 | Val Acc: 0.9067
 Best site-cartoon                  (0)  | Epoch:17 | Val Acc: 0.8400
 Best site-cartoon                  (4)  | Epoch:17 | Val Acc: 0.8500
 Best site-sketch                   (1)  | Epoch:17 | Val Acc: 0.7800
 Best site-sketch                   (1)  | Epoch:17 | Val Acc: 0.7900
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 18 ============
cnt=[2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (1) | Train Loss: 0.1999 | Train Acc: 0.9667
 Site-photo                     (1) | Train Loss: 0.1812 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.4316 | Train Acc: 0.8800
 Site-art_painting              (3) | Train Loss: 0.3669 | Train Acc: 0.8978
 Site-cartoon                   (2) | Train Loss: 0.4744 | Train Acc: 0.8733
 Site-cartoon                   (4) | Train Loss: 0.4865 | Train Acc: 0.8489
 Site-sketch                    (0) | Train Loss: 0.6486 | Train Acc: 0.7800
 Site-sketch                    (0) | Train Loss: 0.6240 | Train Acc: 0.7867
Average Train Accuracy: 0.8758
 Site-photo                     (1) | Val  Loss: 0.1906 | Val  Acc: 0.9600
 Site-photo                     (1) | Val  Loss: 0.2030 | Val  Acc: 0.9700
 Site-art_painting              (3) | Val  Loss: 0.4066 | Val  Acc: 0.8800
 Site-art_painting              (3) | Val  Loss: 0.4157 | Val  Acc: 0.8867
 Site-cartoon                   (2) | Val  Loss: 0.5201 | Val  Acc: 0.7800
 Site-cartoon                   (4) | Val  Loss: 0.4493 | Val  Acc: 0.8533
 Site-sketch                    (0) | Val  Loss: 0.6004 | Val  Acc: 0.7500
 Site-sketch                    (0) | Val  Loss: 0.6191 | Val  Acc: 0.7567
Average Valid Accuracy: 0.8546
============ Train epoch 19 ============
cnt=[2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (3) | Train Loss: 0.2078 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.1734 | Train Acc: 0.9756
 Site-art_painting              (1) | Train Loss: 0.3863 | Train Acc: 0.9133
 Site-art_painting              (1) | Train Loss: 0.4363 | Train Acc: 0.8933
 Site-cartoon                   (2) | Train Loss: 0.4682 | Train Acc: 0.8533
 Site-cartoon                   (4) | Train Loss: 0.4380 | Train Acc: 0.8756
 Site-sketch                    (0) | Train Loss: 0.5357 | Train Acc: 0.8400
 Site-sketch                    (0) | Train Loss: 0.5816 | Train Acc: 0.7956
Average Train Accuracy: 0.8900
 Site-photo                     (3) | Val  Loss: 0.1848 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1946 | Val  Acc: 0.9700
 Site-art_painting              (1) | Val  Loss: 0.3733 | Val  Acc: 0.8900
 Site-art_painting              (1) | Val  Loss: 0.3613 | Val  Acc: 0.9233
 Site-cartoon                   (2) | Val  Loss: 0.4825 | Val  Acc: 0.8000
 Site-cartoon                   (4) | Val  Loss: 0.4483 | Val  Acc: 0.8467
 Site-sketch                    (0) | Val  Loss: 0.5427 | Val  Acc: 0.8600
 Site-sketch                    (0) | Val  Loss: 0.5882 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8825
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 0.9700
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 0.9700
 Best site-art_painting             (1)  | Epoch:19 | Val Acc: 0.8900
 Best site-art_painting             (1)  | Epoch:19 | Val Acc: 0.9233
 Best site-cartoon                  (2)  | Epoch:19 | Val Acc: 0.8000
 Best site-cartoon                  (4)  | Epoch:19 | Val Acc: 0.8467
 Best site-sketch                   (0)  | Epoch:19 | Val Acc: 0.8600
 Best site-sketch                   (0)  | Epoch:19 | Val Acc: 0.8000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 20 ============
cnt=[2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (1) | Train Loss: 0.1876 | Train Acc: 0.9667
 Site-photo                     (1) | Train Loss: 0.1645 | Train Acc: 0.9800
 Site-art_painting              (3) | Train Loss: 0.3990 | Train Acc: 0.8800
 Site-art_painting              (4) | Train Loss: 0.3150 | Train Acc: 0.9289
 Site-cartoon                   (2) | Train Loss: 0.4111 | Train Acc: 0.8467
 Site-cartoon                   (2) | Train Loss: 0.4227 | Train Acc: 0.8644
 Site-sketch                    (0) | Train Loss: 0.4970 | Train Acc: 0.8133
 Site-sketch                    (0) | Train Loss: 0.5280 | Train Acc: 0.7978
Average Train Accuracy: 0.8847
 Site-photo                     (1) | Val  Loss: 0.1864 | Val  Acc: 0.9600
 Site-photo                     (1) | Val  Loss: 0.1903 | Val  Acc: 0.9667
 Site-art_painting              (3) | Val  Loss: 0.4442 | Val  Acc: 0.8700
 Site-art_painting              (4) | Val  Loss: 0.3567 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.4540 | Val  Acc: 0.8500
 Site-cartoon                   (2) | Val  Loss: 0.4411 | Val  Acc: 0.8233
 Site-sketch                    (0) | Val  Loss: 0.5321 | Val  Acc: 0.8000
 Site-sketch                    (0) | Val  Loss: 0.6028 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8713
============ Train epoch 21 ============
cnt=[2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (2) | Train Loss: 0.1510 | Train Acc: 0.9867
 Site-photo                     (2) | Train Loss: 0.1510 | Train Acc: 0.9800
 Site-art_painting              (3) | Train Loss: 0.4728 | Train Acc: 0.8600
 Site-art_painting              (4) | Train Loss: 0.3195 | Train Acc: 0.9111
 Site-cartoon                   (0) | Train Loss: 0.4273 | Train Acc: 0.8267
 Site-cartoon                   (0) | Train Loss: 0.4772 | Train Acc: 0.8711
 Site-sketch                    (1) | Train Loss: 0.5636 | Train Acc: 0.7933
 Site-sketch                    (1) | Train Loss: 0.6041 | Train Acc: 0.7889
Average Train Accuracy: 0.8772
 Site-photo                     (2) | Val  Loss: 0.1574 | Val  Acc: 0.9800
 Site-photo                     (2) | Val  Loss: 0.1594 | Val  Acc: 0.9767
 Site-art_painting              (3) | Val  Loss: 0.4053 | Val  Acc: 0.8800
 Site-art_painting              (4) | Val  Loss: 0.3870 | Val  Acc: 0.8867
 Site-cartoon                   (0) | Val  Loss: 0.4458 | Val  Acc: 0.8500
 Site-cartoon                   (0) | Val  Loss: 0.4259 | Val  Acc: 0.8633
 Site-sketch                    (1) | Val  Loss: 0.5385 | Val  Acc: 0.7700
 Site-sketch                    (1) | Val  Loss: 0.5852 | Val  Acc: 0.7900
Average Valid Accuracy: 0.8746
============ Train epoch 22 ============
cnt=[2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (2) | Train Loss: 0.1713 | Train Acc: 0.9867
 Site-photo                     (2) | Train Loss: 0.1560 | Train Acc: 0.9778
 Site-art_painting              (3) | Train Loss: 0.4235 | Train Acc: 0.8933
 Site-art_painting              (3) | Train Loss: 0.4084 | Train Acc: 0.9000
 Site-cartoon                   (0) | Train Loss: 0.3904 | Train Acc: 0.9067
 Site-cartoon                   (0) | Train Loss: 0.4673 | Train Acc: 0.8867
 Site-sketch                    (1) | Train Loss: 0.5582 | Train Acc: 0.7867
 Site-sketch                    (4) | Train Loss: 0.4918 | Train Acc: 0.8000
Average Train Accuracy: 0.8922
 Site-photo                     (2) | Val  Loss: 0.1612 | Val  Acc: 0.9700
 Site-photo                     (2) | Val  Loss: 0.1632 | Val  Acc: 0.9733
 Site-art_painting              (3) | Val  Loss: 0.3191 | Val  Acc: 0.9100
 Site-art_painting              (3) | Val  Loss: 0.3542 | Val  Acc: 0.8867
 Site-cartoon                   (0) | Val  Loss: 0.4377 | Val  Acc: 0.8400
 Site-cartoon                   (0) | Val  Loss: 0.4073 | Val  Acc: 0.8633
 Site-sketch                    (1) | Val  Loss: 0.5180 | Val  Acc: 0.8200
 Site-sketch                    (4) | Val  Loss: 0.5811 | Val  Acc: 0.7800
Average Valid Accuracy: 0.8804
============ Train epoch 23 ============
cnt=[2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (1) | Train Loss: 0.1702 | Train Acc: 0.9733
 Site-photo                     (1) | Train Loss: 0.1374 | Train Acc: 0.9844
 Site-art_painting              (3) | Train Loss: 0.3786 | Train Acc: 0.8733
 Site-art_painting              (3) | Train Loss: 0.3054 | Train Acc: 0.9133
 Site-cartoon                   (4) | Train Loss: 0.4067 | Train Acc: 0.8667
 Site-cartoon                   (2) | Train Loss: 0.3597 | Train Acc: 0.8778
 Site-sketch                    (0) | Train Loss: 0.6230 | Train Acc: 0.7867
 Site-sketch                    (0) | Train Loss: 0.4822 | Train Acc: 0.8067
Average Train Accuracy: 0.8853
 Site-photo                     (1) | Val  Loss: 0.1647 | Val  Acc: 0.9800
 Site-photo                     (1) | Val  Loss: 0.1754 | Val  Acc: 0.9700
 Site-art_painting              (3) | Val  Loss: 0.4051 | Val  Acc: 0.8700
 Site-art_painting              (3) | Val  Loss: 0.3300 | Val  Acc: 0.9233
 Site-cartoon                   (4) | Val  Loss: 0.4023 | Val  Acc: 0.8500
 Site-cartoon                   (2) | Val  Loss: 0.3854 | Val  Acc: 0.8700
 Site-sketch                    (0) | Val  Loss: 0.5499 | Val  Acc: 0.7500
 Site-sketch                    (0) | Val  Loss: 0.5733 | Val  Acc: 0.8067
Average Valid Accuracy: 0.8775
============ Train epoch 24 ============
cnt=[2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (4) | Train Loss: 0.1886 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.1420 | Train Acc: 0.9711
 Site-art_painting              (3) | Train Loss: 0.3766 | Train Acc: 0.8800
 Site-art_painting              (3) | Train Loss: 0.3034 | Train Acc: 0.9156
 Site-cartoon                   (2) | Train Loss: 0.4436 | Train Acc: 0.8733
 Site-cartoon                   (2) | Train Loss: 0.5743 | Train Acc: 0.8756
 Site-sketch                    (0) | Train Loss: 0.6749 | Train Acc: 0.7733
 Site-sketch                    (0) | Train Loss: 0.5000 | Train Acc: 0.7956
Average Train Accuracy: 0.8831
 Site-photo                     (4) | Val  Loss: 0.1741 | Val  Acc: 0.9800
 Site-photo                     (1) | Val  Loss: 0.1691 | Val  Acc: 0.9733
 Site-art_painting              (3) | Val  Loss: 0.3558 | Val  Acc: 0.8900
 Site-art_painting              (3) | Val  Loss: 0.3182 | Val  Acc: 0.9200
 Site-cartoon                   (2) | Val  Loss: 0.4196 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.3866 | Val  Acc: 0.8733
 Site-sketch                    (0) | Val  Loss: 0.5101 | Val  Acc: 0.8200
 Site-sketch                    (0) | Val  Loss: 0.5391 | Val  Acc: 0.8233
Average Valid Accuracy: 0.8950
 Best site-photo                    (4)  | Epoch:24 | Val Acc: 0.9800
 Best site-photo                    (1)  | Epoch:24 | Val Acc: 0.9733
 Best site-art_painting             (3)  | Epoch:24 | Val Acc: 0.8900
 Best site-art_painting             (3)  | Epoch:24 | Val Acc: 0.9200
 Best site-cartoon                  (2)  | Epoch:24 | Val Acc: 0.8800
 Best site-cartoon                  (2)  | Epoch:24 | Val Acc: 0.8733
 Best site-sketch                   (0)  | Epoch:24 | Val Acc: 0.8200
 Best site-sketch                   (0)  | Epoch:24 | Val Acc: 0.8233
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (3) | Train Loss: 0.1888 | Train Acc: 0.9600
 Site-photo                     (3) | Train Loss: 0.1418 | Train Acc: 0.9711
 Site-art_painting              (0) | Train Loss: 0.3837 | Train Acc: 0.8800
 Site-art_painting              (0) | Train Loss: 0.3307 | Train Acc: 0.9067
 Site-cartoon                   (2) | Train Loss: 0.3920 | Train Acc: 0.8800
 Site-cartoon                   (4) | Train Loss: 0.3306 | Train Acc: 0.8956
 Site-sketch                    (1) | Train Loss: 0.5375 | Train Acc: 0.8067
 Site-sketch                    (1) | Train Loss: 0.6288 | Train Acc: 0.7933
Average Train Accuracy: 0.8867
 Site-photo                     (3) | Val  Loss: 0.1843 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.1757 | Val  Acc: 0.9633
 Site-art_painting              (0) | Val  Loss: 0.4156 | Val  Acc: 0.8700
 Site-art_painting              (0) | Val  Loss: 0.3522 | Val  Acc: 0.8867
 Site-cartoon                   (2) | Val  Loss: 0.3823 | Val  Acc: 0.8900
 Site-cartoon                   (4) | Val  Loss: 0.3311 | Val  Acc: 0.8967
 Site-sketch                    (1) | Val  Loss: 0.5492 | Val  Acc: 0.7500
 Site-sketch                    (1) | Val  Loss: 0.5469 | Val  Acc: 0.7867
Average Valid Accuracy: 0.8742
============ Train epoch 26 ============
cnt=[2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (2) | Train Loss: 0.1505 | Train Acc: 0.9867
 Site-photo                     (2) | Train Loss: 0.1380 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.3649 | Train Acc: 0.8800
 Site-art_painting              (4) | Train Loss: 0.3786 | Train Acc: 0.9133
 Site-cartoon                   (0) | Train Loss: 0.4275 | Train Acc: 0.8800
 Site-cartoon                   (0) | Train Loss: 0.3119 | Train Acc: 0.8822
 Site-sketch                    (1) | Train Loss: 0.4943 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.4724 | Train Acc: 0.8400
Average Train Accuracy: 0.8972
 Site-photo                     (2) | Val  Loss: 0.1621 | Val  Acc: 0.9800
 Site-photo                     (2) | Val  Loss: 0.1787 | Val  Acc: 0.9633
 Site-art_painting              (3) | Val  Loss: 0.4434 | Val  Acc: 0.8800
 Site-art_painting              (4) | Val  Loss: 0.3011 | Val  Acc: 0.9300
 Site-cartoon                   (0) | Val  Loss: 0.4393 | Val  Acc: 0.8500
 Site-cartoon                   (0) | Val  Loss: 0.3519 | Val  Acc: 0.9033
 Site-sketch                    (1) | Val  Loss: 0.4766 | Val  Acc: 0.8200
 Site-sketch                    (1) | Val  Loss: 0.5404 | Val  Acc: 0.8133
Average Valid Accuracy: 0.8925
============ Train epoch 27 ============
cnt=[2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (1) | Train Loss: 0.1690 | Train Acc: 0.9667
 Site-photo                     (1) | Train Loss: 0.1209 | Train Acc: 0.9778
 Site-art_painting              (3) | Train Loss: 0.3669 | Train Acc: 0.8867
 Site-art_painting              (3) | Train Loss: 0.3337 | Train Acc: 0.9200
 Site-cartoon                   (4) | Train Loss: 0.4561 | Train Acc: 0.8667
 Site-cartoon                   (2) | Train Loss: 0.4346 | Train Acc: 0.8800
 Site-sketch                    (0) | Train Loss: 0.4704 | Train Acc: 0.8467
 Site-sketch                    (0) | Train Loss: 0.4635 | Train Acc: 0.8289
Average Train Accuracy: 0.8967
 Site-photo                     (1) | Val  Loss: 0.1775 | Val  Acc: 0.9700
 Site-photo                     (1) | Val  Loss: 0.1354 | Val  Acc: 0.9767
 Site-art_painting              (3) | Val  Loss: 0.3720 | Val  Acc: 0.8700
 Site-art_painting              (3) | Val  Loss: 0.3090 | Val  Acc: 0.9000
 Site-cartoon                   (4) | Val  Loss: 0.4207 | Val  Acc: 0.8200
 Site-cartoon                   (2) | Val  Loss: 0.3925 | Val  Acc: 0.8633
 Site-sketch                    (0) | Val  Loss: 0.5168 | Val  Acc: 0.7800
 Site-sketch                    (0) | Val  Loss: 0.5247 | Val  Acc: 0.7967
Average Valid Accuracy: 0.8721
============ Train epoch 28 ============
cnt=[2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (3) | Train Loss: 0.1455 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.1531 | Train Acc: 0.9733
 Site-art_painting              (0) | Train Loss: 0.3621 | Train Acc: 0.8933
 Site-art_painting              (0) | Train Loss: 0.2785 | Train Acc: 0.9244
 Site-cartoon                   (4) | Train Loss: 0.3704 | Train Acc: 0.9067
 Site-cartoon                   (2) | Train Loss: 0.3317 | Train Acc: 0.8956
 Site-sketch                    (1) | Train Loss: 0.5044 | Train Acc: 0.8533
 Site-sketch                    (1) | Train Loss: 0.5722 | Train Acc: 0.8222
Average Train Accuracy: 0.9044
 Site-photo                     (3) | Val  Loss: 0.1486 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.1495 | Val  Acc: 0.9767
 Site-art_painting              (0) | Val  Loss: 0.2937 | Val  Acc: 0.9300
 Site-art_painting              (0) | Val  Loss: 0.3018 | Val  Acc: 0.9133
 Site-cartoon                   (4) | Val  Loss: 0.3844 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.3426 | Val  Acc: 0.8733
 Site-sketch                    (1) | Val  Loss: 0.4594 | Val  Acc: 0.8200
 Site-sketch                    (1) | Val  Loss: 0.5050 | Val  Acc: 0.8300
Average Valid Accuracy: 0.8954
 Best site-photo                    (3)  | Epoch:28 | Val Acc: 0.9500
 Best site-photo                    (3)  | Epoch:28 | Val Acc: 0.9767
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.9300
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.9133
 Best site-cartoon                  (4)  | Epoch:28 | Val Acc: 0.8700
 Best site-cartoon                  (2)  | Epoch:28 | Val Acc: 0.8733
 Best site-sketch                   (1)  | Epoch:28 | Val Acc: 0.8200
 Best site-sketch                   (1)  | Epoch:28 | Val Acc: 0.8300
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 29 ============
cnt=[2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (3) | Train Loss: 0.1855 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.1145 | Train Acc: 0.9756
 Site-art_painting              (2) | Train Loss: 0.3415 | Train Acc: 0.8867
 Site-art_painting              (2) | Train Loss: 0.2848 | Train Acc: 0.9156
 Site-cartoon                   (0) | Train Loss: 0.4343 | Train Acc: 0.8800
 Site-cartoon                   (0) | Train Loss: 0.3649 | Train Acc: 0.8889
 Site-sketch                    (4) | Train Loss: 0.5108 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.4539 | Train Acc: 0.8289
Average Train Accuracy: 0.8978
 Site-photo                     (3) | Val  Loss: 0.1512 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1379 | Val  Acc: 0.9633
 Site-art_painting              (2) | Val  Loss: 0.3543 | Val  Acc: 0.8600
 Site-art_painting              (2) | Val  Loss: 0.2764 | Val  Acc: 0.9167
 Site-cartoon                   (0) | Val  Loss: 0.3876 | Val  Acc: 0.8300
 Site-cartoon                   (0) | Val  Loss: 0.3481 | Val  Acc: 0.8900
 Site-sketch                    (4) | Val  Loss: 0.4953 | Val  Acc: 0.7800
 Site-sketch                    (1) | Val  Loss: 0.4826 | Val  Acc: 0.8433
Average Valid Accuracy: 0.8817
============ Train epoch 30 ============
cnt=[2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (4) | Train Loss: 0.1283 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.1379 | Train Acc: 0.9844
 Site-art_painting              (0) | Train Loss: 0.3882 | Train Acc: 0.8733
 Site-art_painting              (0) | Train Loss: 0.2727 | Train Acc: 0.9067
 Site-cartoon                   (2) | Train Loss: 0.3724 | Train Acc: 0.8867
 Site-cartoon                   (2) | Train Loss: 0.2840 | Train Acc: 0.9022
 Site-sketch                    (1) | Train Loss: 0.4808 | Train Acc: 0.8067
 Site-sketch                    (1) | Train Loss: 0.4522 | Train Acc: 0.8200
Average Train Accuracy: 0.8950
 Site-photo                     (4) | Val  Loss: 0.1517 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.1522 | Val  Acc: 0.9700
 Site-art_painting              (0) | Val  Loss: 0.3028 | Val  Acc: 0.9200
 Site-art_painting              (0) | Val  Loss: 0.2972 | Val  Acc: 0.9167
 Site-cartoon                   (2) | Val  Loss: 0.3773 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.3336 | Val  Acc: 0.8967
 Site-sketch                    (1) | Val  Loss: 0.4222 | Val  Acc: 0.8400
 Site-sketch                    (1) | Val  Loss: 0.4911 | Val  Acc: 0.8467
Average Valid Accuracy: 0.9025
 Best site-photo                    (4)  | Epoch:30 | Val Acc: 0.9600
 Best site-photo                    (3)  | Epoch:30 | Val Acc: 0.9700
 Best site-art_painting             (0)  | Epoch:30 | Val Acc: 0.9200
 Best site-art_painting             (0)  | Epoch:30 | Val Acc: 0.9167
 Best site-cartoon                  (2)  | Epoch:30 | Val Acc: 0.8700
 Best site-cartoon                  (2)  | Epoch:30 | Val Acc: 0.8967
 Best site-sketch                   (1)  | Epoch:30 | Val Acc: 0.8400
 Best site-sketch                   (1)  | Epoch:30 | Val Acc: 0.8467
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 31 ============
cnt=[1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (2) | Train Loss: 0.1464 | Train Acc: 0.9600
 Site-photo                     (2) | Train Loss: 0.1161 | Train Acc: 0.9778
 Site-art_painting              (3) | Train Loss: 0.2847 | Train Acc: 0.9267
 Site-art_painting              (3) | Train Loss: 0.4340 | Train Acc: 0.9311
 Site-cartoon                   (0) | Train Loss: 0.4034 | Train Acc: 0.8533
 Site-cartoon                   (4) | Train Loss: 0.3019 | Train Acc: 0.8889
 Site-sketch                    (1) | Train Loss: 0.4899 | Train Acc: 0.8333
 Site-sketch                    (1) | Train Loss: 0.5187 | Train Acc: 0.8600
Average Train Accuracy: 0.9039
 Site-photo                     (2) | Val  Loss: 0.1632 | Val  Acc: 0.9500
 Site-photo                     (2) | Val  Loss: 0.1332 | Val  Acc: 0.9800
 Site-art_painting              (3) | Val  Loss: 0.2950 | Val  Acc: 0.9400
 Site-art_painting              (3) | Val  Loss: 0.2755 | Val  Acc: 0.9133
 Site-cartoon                   (0) | Val  Loss: 0.3708 | Val  Acc: 0.8700
 Site-cartoon                   (4) | Val  Loss: 0.3468 | Val  Acc: 0.8933
 Site-sketch                    (1) | Val  Loss: 0.4318 | Val  Acc: 0.8100
 Site-sketch                    (1) | Val  Loss: 0.4950 | Val  Acc: 0.8033
Average Valid Accuracy: 0.8950
============ Train epoch 32 ============
cnt=[1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (1) | Train Loss: 0.1408 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.1170 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.3053 | Train Acc: 0.8867
 Site-art_painting              (3) | Train Loss: 0.2769 | Train Acc: 0.9267
 Site-cartoon                   (2) | Train Loss: 0.3521 | Train Acc: 0.8733
 Site-cartoon                   (2) | Train Loss: 0.4433 | Train Acc: 0.9022
 Site-sketch                    (0) | Train Loss: 0.5663 | Train Acc: 0.7733
 Site-sketch                    (4) | Train Loss: 0.4574 | Train Acc: 0.8222
Average Train Accuracy: 0.8925
 Site-photo                     (1) | Val  Loss: 0.1035 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1327 | Val  Acc: 0.9700
 Site-art_painting              (3) | Val  Loss: 0.3116 | Val  Acc: 0.8900
 Site-art_painting              (3) | Val  Loss: 0.2606 | Val  Acc: 0.9367
 Site-cartoon                   (2) | Val  Loss: 0.4187 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.3717 | Val  Acc: 0.8867
 Site-sketch                    (0) | Val  Loss: 0.4514 | Val  Acc: 0.8200
 Site-sketch                    (4) | Val  Loss: 0.4704 | Val  Acc: 0.8300
Average Valid Accuracy: 0.9004
============ Train epoch 33 ============
cnt=[2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (0) | Train Loss: 0.1396 | Train Acc: 0.9800
 Site-photo                     (0) | Train Loss: 0.1633 | Train Acc: 0.9689
 Site-art_painting              (3) | Train Loss: 0.3456 | Train Acc: 0.9133
 Site-art_painting              (3) | Train Loss: 0.3483 | Train Acc: 0.9156
 Site-cartoon                   (2) | Train Loss: 0.3708 | Train Acc: 0.8867
 Site-cartoon                   (2) | Train Loss: 0.2756 | Train Acc: 0.9133
 Site-sketch                    (4) | Train Loss: 0.5652 | Train Acc: 0.8267
 Site-sketch                    (1) | Train Loss: 0.5868 | Train Acc: 0.8267
Average Train Accuracy: 0.9039
 Site-photo                     (0) | Val  Loss: 0.1695 | Val  Acc: 0.9800
 Site-photo                     (0) | Val  Loss: 0.1427 | Val  Acc: 0.9800
 Site-art_painting              (3) | Val  Loss: 0.3465 | Val  Acc: 0.8700
 Site-art_painting              (3) | Val  Loss: 0.2693 | Val  Acc: 0.9200
 Site-cartoon                   (2) | Val  Loss: 0.3475 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.3389 | Val  Acc: 0.9067
 Site-sketch                    (4) | Val  Loss: 0.4917 | Val  Acc: 0.8300
 Site-sketch                    (1) | Val  Loss: 0.5114 | Val  Acc: 0.8200
Average Valid Accuracy: 0.8971
============ Train epoch 34 ============
cnt=[2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (3) | Train Loss: 0.1548 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.1160 | Train Acc: 0.9733
 Site-art_painting              (2) | Train Loss: 0.2609 | Train Acc: 0.9267
 Site-art_painting              (2) | Train Loss: 0.3061 | Train Acc: 0.9333
 Site-cartoon                   (0) | Train Loss: 0.3465 | Train Acc: 0.8867
 Site-cartoon                   (0) | Train Loss: 0.3400 | Train Acc: 0.9067
 Site-sketch                    (1) | Train Loss: 0.5326 | Train Acc: 0.7933
 Site-sketch                    (4) | Train Loss: 0.4196 | Train Acc: 0.8311
Average Train Accuracy: 0.9022
 Site-photo                     (3) | Val  Loss: 0.1721 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.1328 | Val  Acc: 0.9800
 Site-art_painting              (2) | Val  Loss: 0.3469 | Val  Acc: 0.8600
 Site-art_painting              (2) | Val  Loss: 0.2914 | Val  Acc: 0.9100
 Site-cartoon                   (0) | Val  Loss: 0.3713 | Val  Acc: 0.8800
 Site-cartoon                   (0) | Val  Loss: 0.3189 | Val  Acc: 0.9100
 Site-sketch                    (1) | Val  Loss: 0.4643 | Val  Acc: 0.8700
 Site-sketch                    (4) | Val  Loss: 0.4673 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9004
============ Train epoch 35 ============
cnt=[1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (3) | Train Loss: 0.1283 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.1167 | Train Acc: 0.9800
 Site-art_painting              (1) | Train Loss: 0.3774 | Train Acc: 0.9133
 Site-art_painting              (1) | Train Loss: 0.2424 | Train Acc: 0.9222
 Site-cartoon                   (2) | Train Loss: 0.3109 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.3080 | Train Acc: 0.9022
 Site-sketch                    (0) | Train Loss: 0.4136 | Train Acc: 0.8533
 Site-sketch                    (4) | Train Loss: 0.4136 | Train Acc: 0.8178
Average Train Accuracy: 0.9111
 Site-photo                     (3) | Val  Loss: 0.1532 | Val  Acc: 0.9500
 Site-photo                     (3) | Val  Loss: 0.1288 | Val  Acc: 0.9733
 Site-art_painting              (1) | Val  Loss: 0.3139 | Val  Acc: 0.9100
 Site-art_painting              (1) | Val  Loss: 0.2599 | Val  Acc: 0.9267
 Site-cartoon                   (2) | Val  Loss: 0.3533 | Val  Acc: 0.8700
 Site-cartoon                   (2) | Val  Loss: 0.3306 | Val  Acc: 0.8867
 Site-sketch                    (0) | Val  Loss: 0.4242 | Val  Acc: 0.8300
 Site-sketch                    (4) | Val  Loss: 0.4615 | Val  Acc: 0.8433
Average Valid Accuracy: 0.8987
============ Train epoch 36 ============
cnt=[2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (3) | Train Loss: 0.1102 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.1146 | Train Acc: 0.9778
 Site-art_painting              (2) | Train Loss: 0.3120 | Train Acc: 0.9267
 Site-art_painting              (2) | Train Loss: 0.3630 | Train Acc: 0.9356
 Site-cartoon                   (0) | Train Loss: 0.3492 | Train Acc: 0.8800
 Site-cartoon                   (0) | Train Loss: 0.2887 | Train Acc: 0.8978
 Site-sketch                    (1) | Train Loss: 0.4741 | Train Acc: 0.8133
 Site-sketch                    (4) | Train Loss: 0.4223 | Train Acc: 0.8533
Average Train Accuracy: 0.9072
 Site-photo                     (3) | Val  Loss: 0.1617 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.1200 | Val  Acc: 0.9733
 Site-art_painting              (2) | Val  Loss: 0.2824 | Val  Acc: 0.9300
 Site-art_painting              (2) | Val  Loss: 0.2642 | Val  Acc: 0.9267
 Site-cartoon                   (0) | Val  Loss: 0.4285 | Val  Acc: 0.8100
 Site-cartoon                   (0) | Val  Loss: 0.3399 | Val  Acc: 0.8800
 Site-sketch                    (1) | Val  Loss: 0.4153 | Val  Acc: 0.8500
 Site-sketch                    (4) | Val  Loss: 0.4757 | Val  Acc: 0.8167
Average Valid Accuracy: 0.8933
============ Train epoch 37 ============
cnt=[2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (3) | Train Loss: 0.1682 | Train Acc: 0.9733
 Site-photo                     (3) | Train Loss: 0.0973 | Train Acc: 0.9778
 Site-art_painting              (0) | Train Loss: 0.2986 | Train Acc: 0.9333
 Site-art_painting              (0) | Train Loss: 0.2956 | Train Acc: 0.9356
 Site-cartoon                   (2) | Train Loss: 0.3696 | Train Acc: 0.9000
 Site-cartoon                   (4) | Train Loss: 0.3184 | Train Acc: 0.8711
 Site-sketch                    (1) | Train Loss: 0.5234 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.4853 | Train Acc: 0.8178
Average Train Accuracy: 0.9036
 Site-photo                     (3) | Val  Loss: 0.1196 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1132 | Val  Acc: 0.9800
 Site-art_painting              (0) | Val  Loss: 0.3404 | Val  Acc: 0.8700
 Site-art_painting              (0) | Val  Loss: 0.2278 | Val  Acc: 0.9300
 Site-cartoon                   (2) | Val  Loss: 0.3927 | Val  Acc: 0.9000
 Site-cartoon                   (4) | Val  Loss: 0.3422 | Val  Acc: 0.8767
 Site-sketch                    (1) | Val  Loss: 0.4665 | Val  Acc: 0.8400
 Site-sketch                    (1) | Val  Loss: 0.4639 | Val  Acc: 0.8133
Average Valid Accuracy: 0.8975
============ Train epoch 38 ============
cnt=[1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (3) | Train Loss: 0.1056 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.0985 | Train Acc: 0.9778
 Site-art_painting              (1) | Train Loss: 0.3699 | Train Acc: 0.9067
 Site-art_painting              (1) | Train Loss: 0.2688 | Train Acc: 0.9044
 Site-cartoon                   (2) | Train Loss: 0.3250 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.3681 | Train Acc: 0.9111
 Site-sketch                    (0) | Train Loss: 0.4825 | Train Acc: 0.8000
 Site-sketch                    (4) | Train Loss: 0.4419 | Train Acc: 0.8444
Average Train Accuracy: 0.9064
 Site-photo                     (3) | Val  Loss: 0.1124 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1234 | Val  Acc: 0.9833
 Site-art_painting              (1) | Val  Loss: 0.2838 | Val  Acc: 0.8900
 Site-art_painting              (1) | Val  Loss: 0.2784 | Val  Acc: 0.9267
 Site-cartoon                   (2) | Val  Loss: 0.3654 | Val  Acc: 0.8400
 Site-cartoon                   (2) | Val  Loss: 0.3239 | Val  Acc: 0.8867
 Site-sketch                    (0) | Val  Loss: 0.4321 | Val  Acc: 0.9000
 Site-sketch                    (4) | Val  Loss: 0.4783 | Val  Acc: 0.8233
Average Valid Accuracy: 0.9025
============ Train epoch 39 ============
cnt=[2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (3) | Train Loss: 0.1166 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.0984 | Train Acc: 0.9800
 Site-art_painting              (0) | Train Loss: 0.2673 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.2548 | Train Acc: 0.9222
 Site-cartoon                   (2) | Train Loss: 0.3068 | Train Acc: 0.9000
 Site-cartoon                   (4) | Train Loss: 0.2636 | Train Acc: 0.8911
 Site-sketch                    (1) | Train Loss: 0.4696 | Train Acc: 0.8200
 Site-sketch                    (1) | Train Loss: 0.4328 | Train Acc: 0.8333
Average Train Accuracy: 0.9017
 Site-photo                     (3) | Val  Loss: 0.1100 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1268 | Val  Acc: 0.9800
 Site-art_painting              (0) | Val  Loss: 0.3538 | Val  Acc: 0.9000
 Site-art_painting              (0) | Val  Loss: 0.2606 | Val  Acc: 0.9300
 Site-cartoon                   (2) | Val  Loss: 0.3264 | Val  Acc: 0.8800
 Site-cartoon                   (4) | Val  Loss: 0.2902 | Val  Acc: 0.9233
 Site-sketch                    (1) | Val  Loss: 0.4302 | Val  Acc: 0.8600
 Site-sketch                    (1) | Val  Loss: 0.4228 | Val  Acc: 0.8600
Average Valid Accuracy: 0.9129
 Best site-photo                    (3)  | Epoch:39 | Val Acc: 0.9700
 Best site-photo                    (3)  | Epoch:39 | Val Acc: 0.9800
 Best site-art_painting             (0)  | Epoch:39 | Val Acc: 0.9000
 Best site-art_painting             (0)  | Epoch:39 | Val Acc: 0.9300
 Best site-cartoon                  (2)  | Epoch:39 | Val Acc: 0.8800
 Best site-cartoon                  (4)  | Epoch:39 | Val Acc: 0.9233
 Best site-sketch                   (1)  | Epoch:39 | Val Acc: 0.8600
 Best site-sketch                   (1)  | Epoch:39 | Val Acc: 0.8600
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (3) | Train Loss: 0.1447 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.1150 | Train Acc: 0.9689
 Site-art_painting              (2) | Train Loss: 0.3070 | Train Acc: 0.8800
 Site-art_painting              (2) | Train Loss: 0.2180 | Train Acc: 0.9311
 Site-cartoon                   (0) | Train Loss: 0.3591 | Train Acc: 0.9133
 Site-cartoon                   (0) | Train Loss: 0.2624 | Train Acc: 0.9000
 Site-sketch                    (1) | Train Loss: 0.5045 | Train Acc: 0.8467
 Site-sketch                    (4) | Train Loss: 0.3735 | Train Acc: 0.8578
Average Train Accuracy: 0.9081
 Site-photo                     (3) | Val  Loss: 0.1625 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.1393 | Val  Acc: 0.9733
 Site-art_painting              (2) | Val  Loss: 0.3005 | Val  Acc: 0.9100
 Site-art_painting              (2) | Val  Loss: 0.2496 | Val  Acc: 0.9167
 Site-cartoon                   (0) | Val  Loss: 0.3684 | Val  Acc: 0.8500
 Site-cartoon                   (0) | Val  Loss: 0.2760 | Val  Acc: 0.9033
 Site-sketch                    (1) | Val  Loss: 0.4165 | Val  Acc: 0.8900
 Site-sketch                    (4) | Val  Loss: 0.4727 | Val  Acc: 0.8433
Average Valid Accuracy: 0.9058
 Test site-photo                     (3)| Epoch:39 | Test Acc: 0.9910
 Test site-art_painting              (2)| Epoch:39 | Test Acc: 0.9208
 Test site-cartoon                   (0)| Epoch:39 | Test Acc: 0.8926
 Test site-sketch                    (1)| Epoch:39 | Test Acc: 0.8628
photo: 0.9910, art_painting: 0.9208, cartoon: 0.8926, sketch: 0.8628, 
Average Test Accuracy(group): 0.9168, Average Test Accuracy(individual): 0.9168,
domain std=0.0475, cluster std=0.0477, individual std=0.0475, 
Average Test Accuracy: 0.9168
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 41 ============
cnt=[1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-photo                     (1) | Train Loss: 0.0938 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.1126 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.3210 | Train Acc: 0.8800
 Site-art_painting              (3) | Train Loss: 0.2267 | Train Acc: 0.9156
 Site-cartoon                   (2) | Train Loss: 0.2895 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.2483 | Train Acc: 0.9111
 Site-sketch                    (0) | Train Loss: 0.4487 | Train Acc: 0.8267
 Site-sketch                    (4) | Train Loss: 0.3965 | Train Acc: 0.8311
Average Train Accuracy: 0.9047
 Site-photo                     (1) | Val  Loss: 0.1141 | Val  Acc: 0.9700
 Site-photo                     (1) | Val  Loss: 0.1025 | Val  Acc: 0.9767
 Site-art_painting              (3) | Val  Loss: 0.3390 | Val  Acc: 0.8900
 Site-art_painting              (3) | Val  Loss: 0.2462 | Val  Acc: 0.9200
 Site-cartoon                   (2) | Val  Loss: 0.3759 | Val  Acc: 0.8600
 Site-cartoon                   (2) | Val  Loss: 0.3045 | Val  Acc: 0.9100
 Site-sketch                    (0) | Val  Loss: 0.4007 | Val  Acc: 0.8800
 Site-sketch                    (4) | Val  Loss: 0.4141 | Val  Acc: 0.8700
Average Valid Accuracy: 0.9096
 Test site-photo                     (1)| Epoch:40 | Test Acc: 0.9925
 Test site-art_painting              (3)| Epoch:40 | Test Acc: 0.9160
 Test site-cartoon                   (2)| Epoch:40 | Test Acc: 0.8904
 Test site-sketch                    (0)| Epoch:40 | Test Acc: 0.8609
photo: 0.9925, art_painting: 0.9160, cartoon: 0.8904, sketch: 0.8609, 
Average Test Accuracy(group): 0.9149, Average Test Accuracy(individual): 0.9149,
domain std=0.0489, cluster std=0.0488, individual std=0.0489, 
Average Test Accuracy: 0.9149
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 42 ============
cnt=[2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-photo                     (0) | Train Loss: 0.1059 | Train Acc: 0.9933
 Site-photo                     (0) | Train Loss: 0.1080 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.2799 | Train Acc: 0.9200
 Site-art_painting              (3) | Train Loss: 0.2326 | Train Acc: 0.9200
 Site-cartoon                   (2) | Train Loss: 0.2925 | Train Acc: 0.9333
 Site-cartoon                   (2) | Train Loss: 0.2404 | Train Acc: 0.9244
 Site-sketch                    (1) | Train Loss: 0.4837 | Train Acc: 0.8200
 Site-sketch                    (4) | Train Loss: 0.6312 | Train Acc: 0.8444
Average Train Accuracy: 0.9161
 Site-photo                     (0) | Val  Loss: 0.1049 | Val  Acc: 0.9700
 Site-photo                     (0) | Val  Loss: 0.1141 | Val  Acc: 0.9767
 Site-art_painting              (3) | Val  Loss: 0.2982 | Val  Acc: 0.9200
 Site-art_painting              (3) | Val  Loss: 0.2268 | Val  Acc: 0.9233
 Site-cartoon                   (2) | Val  Loss: 0.2812 | Val  Acc: 0.9100
 Site-cartoon                   (2) | Val  Loss: 0.2813 | Val  Acc: 0.9033
 Site-sketch                    (1) | Val  Loss: 0.4126 | Val  Acc: 0.8600
 Site-sketch                    (4) | Val  Loss: 0.4702 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9121
 Test site-photo                     (0)| Epoch:41 | Test Acc: 0.9910
 Test site-art_painting              (3)| Epoch:41 | Test Acc: 0.9208
 Test site-cartoon                   (2)| Epoch:41 | Test Acc: 0.8915
 Test site-sketch                    (1)| Epoch:41 | Test Acc: 0.8469
photo: 0.9910, art_painting: 0.9208, cartoon: 0.8915, sketch: 0.8469, 
Average Test Accuracy(group): 0.9126, Average Test Accuracy(individual): 0.9126,
domain std=0.0524, cluster std=0.0537, individual std=0.0524, 
Average Test Accuracy: 0.9126
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 43 ============
cnt=[2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-photo                     (3) | Train Loss: 0.0972 | Train Acc: 0.9933
 Site-photo                     (3) | Train Loss: 0.1020 | Train Acc: 0.9756
 Site-art_painting              (2) | Train Loss: 0.2306 | Train Acc: 0.9400
 Site-art_painting              (2) | Train Loss: 0.2015 | Train Acc: 0.9311
 Site-cartoon                   (0) | Train Loss: 0.2619 | Train Acc: 0.9200
 Site-cartoon                   (0) | Train Loss: 0.2334 | Train Acc: 0.9222
 Site-sketch                    (4) | Train Loss: 0.4280 | Train Acc: 0.8600
 Site-sketch                    (1) | Train Loss: 0.4535 | Train Acc: 0.8489
Average Train Accuracy: 0.9239
 Site-photo                     (3) | Val  Loss: 0.1472 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.1261 | Val  Acc: 0.9667
 Site-art_painting              (2) | Val  Loss: 0.3132 | Val  Acc: 0.8800
 Site-art_painting              (2) | Val  Loss: 0.2529 | Val  Acc: 0.9167
 Site-cartoon                   (0) | Val  Loss: 0.3939 | Val  Acc: 0.8300
 Site-cartoon                   (0) | Val  Loss: 0.2772 | Val  Acc: 0.9067
 Site-sketch                    (4) | Val  Loss: 0.3848 | Val  Acc: 0.8500
 Site-sketch                    (1) | Val  Loss: 0.4035 | Val  Acc: 0.8633
Average Valid Accuracy: 0.8967
 Test site-photo                     (3)| Epoch:42 | Test Acc: 0.9896
 Test site-art_painting              (2)| Epoch:42 | Test Acc: 0.9233
 Test site-cartoon                   (0)| Epoch:42 | Test Acc: 0.8894
 Test site-sketch                    (4)| Epoch:42 | Test Acc: 0.8571
photo: 0.9896, art_painting: 0.9233, cartoon: 0.8894, sketch: 0.8571, 
Average Test Accuracy(group): 0.9148, Average Test Accuracy(individual): 0.9148,
domain std=0.0491, cluster std=0.0496, individual std=0.0491, 
Average Test Accuracy: 0.9148
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 44 ============
cnt=[2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-photo                     (0) | Train Loss: 0.1142 | Train Acc: 0.9733
 Site-photo                     (0) | Train Loss: 0.1002 | Train Acc: 0.9733
 Site-art_painting              (3) | Train Loss: 0.2562 | Train Acc: 0.9200
 Site-art_painting              (3) | Train Loss: 0.2101 | Train Acc: 0.9422
 Site-cartoon                   (2) | Train Loss: 0.3115 | Train Acc: 0.9333
 Site-cartoon                   (2) | Train Loss: 0.2823 | Train Acc: 0.9089
 Site-sketch                    (1) | Train Loss: 0.4210 | Train Acc: 0.8533
 Site-sketch                    (4) | Train Loss: 0.4756 | Train Acc: 0.8311
Average Train Accuracy: 0.9169
 Site-photo                     (0) | Val  Loss: 0.1138 | Val  Acc: 0.9800
 Site-photo                     (0) | Val  Loss: 0.1184 | Val  Acc: 0.9633
 Site-art_painting              (3) | Val  Loss: 0.2962 | Val  Acc: 0.9200
 Site-art_painting              (3) | Val  Loss: 0.2516 | Val  Acc: 0.9233
 Site-cartoon                   (2) | Val  Loss: 0.3274 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.2748 | Val  Acc: 0.9167
 Site-sketch                    (1) | Val  Loss: 0.3408 | Val  Acc: 0.8900
 Site-sketch                    (4) | Val  Loss: 0.4113 | Val  Acc: 0.8467
Average Valid Accuracy: 0.9150
 Best site-photo                    (0)  | Epoch:44 | Val Acc: 0.9800
 Best site-photo                    (0)  | Epoch:44 | Val Acc: 0.9633
 Best site-art_painting             (3)  | Epoch:44 | Val Acc: 0.9200
 Best site-art_painting             (3)  | Epoch:44 | Val Acc: 0.9233
 Best site-cartoon                  (2)  | Epoch:44 | Val Acc: 0.8800
 Best site-cartoon                  (2)  | Epoch:44 | Val Acc: 0.9167
 Best site-sketch                   (1)  | Epoch:44 | Val Acc: 0.8900
 Best site-sketch                   (4)  | Epoch:44 | Val Acc: 0.8467
 Test site-photo                     (0)| Epoch:44 | Test Acc: 0.9910
 Test site-art_painting              (3)| Epoch:44 | Test Acc: 0.9220
 Test site-cartoon                   (2)| Epoch:44 | Test Acc: 0.8957
 Test site-sketch                    (1)| Epoch:44 | Test Acc: 0.8532
photo: 0.9910, art_painting: 0.9220, cartoon: 0.8957, sketch: 0.8532, 
Average Test Accuracy(group): 0.9155, Average Test Accuracy(individual): 0.9155,
domain std=0.0500, cluster std=0.0512, individual std=0.0500, 
Average Test Accuracy: 0.9155
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 45 ============
cnt=[1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-photo                     (1) | Train Loss: 0.1358 | Train Acc: 0.9533
 Site-photo                     (1) | Train Loss: 0.0941 | Train Acc: 0.9844
 Site-art_painting              (3) | Train Loss: 0.2407 | Train Acc: 0.9200
 Site-art_painting              (3) | Train Loss: 0.4103 | Train Acc: 0.9244
 Site-cartoon                   (2) | Train Loss: 0.2798 | Train Acc: 0.9467
 Site-cartoon                   (2) | Train Loss: 0.2354 | Train Acc: 0.9111
 Site-sketch                    (0) | Train Loss: 0.5313 | Train Acc: 0.8400
 Site-sketch                    (4) | Train Loss: 0.3859 | Train Acc: 0.8578
Average Train Accuracy: 0.9172
 Site-photo                     (1) | Val  Loss: 0.1116 | Val  Acc: 0.9800
 Site-photo                     (1) | Val  Loss: 0.1162 | Val  Acc: 0.9800
 Site-art_painting              (3) | Val  Loss: 0.2434 | Val  Acc: 0.9300
 Site-art_painting              (3) | Val  Loss: 0.2621 | Val  Acc: 0.9167
 Site-cartoon                   (2) | Val  Loss: 0.3389 | Val  Acc: 0.8800
 Site-cartoon                   (2) | Val  Loss: 0.3115 | Val  Acc: 0.8967
 Site-sketch                    (0) | Val  Loss: 0.3283 | Val  Acc: 0.8800
 Site-sketch                    (4) | Val  Loss: 0.4133 | Val  Acc: 0.8667
Average Valid Accuracy: 0.9163
 Best site-photo                    (1)  | Epoch:45 | Val Acc: 0.9800
 Best site-photo                    (1)  | Epoch:45 | Val Acc: 0.9800
 Best site-art_painting             (3)  | Epoch:45 | Val Acc: 0.9300
 Best site-art_painting             (3)  | Epoch:45 | Val Acc: 0.9167
 Best site-cartoon                  (2)  | Epoch:45 | Val Acc: 0.8800
 Best site-cartoon                  (2)  | Epoch:45 | Val Acc: 0.8967
 Best site-sketch                   (0)  | Epoch:45 | Val Acc: 0.8800
 Best site-sketch                   (4)  | Epoch:45 | Val Acc: 0.8667
 Test site-photo                     (1)| Epoch:45 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:45 | Test Acc: 0.9220
 Test site-cartoon                   (2)| Epoch:45 | Test Acc: 0.8904
 Test site-sketch                    (0)| Epoch:45 | Test Acc: 0.8456
photo: 0.9896, art_painting: 0.9220, cartoon: 0.8904, sketch: 0.8456, 
Average Test Accuracy(group): 0.9119, Average Test Accuracy(individual): 0.9119,
domain std=0.0524, cluster std=0.0539, individual std=0.0524, 
Average Test Accuracy: 0.9119
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 46 ============
cnt=[2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-photo                     (4) | Train Loss: 0.0904 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.0929 | Train Acc: 0.9844
 Site-art_painting              (1) | Train Loss: 0.2342 | Train Acc: 0.9267
 Site-art_painting              (1) | Train Loss: 0.1882 | Train Acc: 0.9311
 Site-cartoon                   (2) | Train Loss: 0.3383 | Train Acc: 0.9333
 Site-cartoon                   (2) | Train Loss: 0.2704 | Train Acc: 0.9089
 Site-sketch                    (0) | Train Loss: 0.5053 | Train Acc: 0.8400
 Site-sketch                    (0) | Train Loss: 0.3600 | Train Acc: 0.8667
Average Train Accuracy: 0.9214
 Site-photo                     (4) | Val  Loss: 0.1147 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1211 | Val  Acc: 0.9700
 Site-art_painting              (1) | Val  Loss: 0.2524 | Val  Acc: 0.9000
 Site-art_painting              (1) | Val  Loss: 0.2303 | Val  Acc: 0.9333
 Site-cartoon                   (2) | Val  Loss: 0.2905 | Val  Acc: 0.9100
 Site-cartoon                   (2) | Val  Loss: 0.3152 | Val  Acc: 0.9033
 Site-sketch                    (0) | Val  Loss: 0.3911 | Val  Acc: 0.8500
 Site-sketch                    (0) | Val  Loss: 0.4165 | Val  Acc: 0.8467
Average Valid Accuracy: 0.9104
 Test site-photo                     (4)| Epoch:45 | Test Acc: 0.9925
 Test site-art_painting              (1)| Epoch:45 | Test Acc: 0.9257
 Test site-cartoon                   (2)| Epoch:45 | Test Acc: 0.8840
 Test site-sketch                    (0)| Epoch:45 | Test Acc: 0.8469
photo: 0.9925, art_painting: 0.9257, cartoon: 0.8840, sketch: 0.8469, 
Average Test Accuracy(group): 0.9123, Average Test Accuracy(individual): 0.9123,
domain std=0.0541, cluster std=0.0580, individual std=0.0541, 
Average Test Accuracy: 0.9123
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 47 ============
cnt=[1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-photo                     (1) | Train Loss: 0.1173 | Train Acc: 0.9800
 Site-photo                     (1) | Train Loss: 0.0922 | Train Acc: 0.9756
 Site-art_painting              (3) | Train Loss: 0.2959 | Train Acc: 0.9467
 Site-art_painting              (3) | Train Loss: 0.2017 | Train Acc: 0.9333
 Site-cartoon                   (2) | Train Loss: 0.2800 | Train Acc: 0.9267
 Site-cartoon                   (2) | Train Loss: 0.2556 | Train Acc: 0.9133
 Site-sketch                    (0) | Train Loss: 0.4052 | Train Acc: 0.8800
 Site-sketch                    (4) | Train Loss: 0.5210 | Train Acc: 0.8333
Average Train Accuracy: 0.9236
 Site-photo                     (1) | Val  Loss: 0.0948 | Val  Acc: 0.9700
 Site-photo                     (1) | Val  Loss: 0.1149 | Val  Acc: 0.9667
 Site-art_painting              (3) | Val  Loss: 0.2977 | Val  Acc: 0.9100
 Site-art_painting              (3) | Val  Loss: 0.2368 | Val  Acc: 0.9267
 Site-cartoon                   (2) | Val  Loss: 0.2970 | Val  Acc: 0.9000
 Site-cartoon                   (2) | Val  Loss: 0.2618 | Val  Acc: 0.9433
 Site-sketch                    (0) | Val  Loss: 0.3732 | Val  Acc: 0.8900
 Site-sketch                    (4) | Val  Loss: 0.4036 | Val  Acc: 0.8500
Average Valid Accuracy: 0.9196
 Best site-photo                    (1)  | Epoch:47 | Val Acc: 0.9700
 Best site-photo                    (1)  | Epoch:47 | Val Acc: 0.9667
 Best site-art_painting             (3)  | Epoch:47 | Val Acc: 0.9100
 Best site-art_painting             (3)  | Epoch:47 | Val Acc: 0.9267
 Best site-cartoon                  (2)  | Epoch:47 | Val Acc: 0.9000
 Best site-cartoon                  (2)  | Epoch:47 | Val Acc: 0.9433
 Best site-sketch                   (0)  | Epoch:47 | Val Acc: 0.8900
 Best site-sketch                   (4)  | Epoch:47 | Val Acc: 0.8500
 Test site-photo                     (1)| Epoch:47 | Test Acc: 0.9925
 Test site-art_painting              (3)| Epoch:47 | Test Acc: 0.9245
 Test site-cartoon                   (2)| Epoch:47 | Test Acc: 0.8904
 Test site-sketch                    (0)| Epoch:47 | Test Acc: 0.8577
photo: 0.9925, art_painting: 0.9245, cartoon: 0.8904, sketch: 0.8577, 
Average Test Accuracy(group): 0.9163, Average Test Accuracy(individual): 0.9163,
domain std=0.0500, cluster std=0.0505, individual std=0.0500, 
Average Test Accuracy: 0.9163
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 48 ============
cnt=[2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-photo                     (3) | Train Loss: 0.1025 | Train Acc: 0.9867
 Site-photo                     (3) | Train Loss: 0.1154 | Train Acc: 0.9733
 Site-art_painting              (2) | Train Loss: 0.2781 | Train Acc: 0.9200
 Site-art_painting              (2) | Train Loss: 0.1832 | Train Acc: 0.9422
 Site-cartoon                   (0) | Train Loss: 0.3156 | Train Acc: 0.8933
 Site-cartoon                   (0) | Train Loss: 0.2840 | Train Acc: 0.9156
 Site-sketch                    (1) | Train Loss: 0.4535 | Train Acc: 0.8867
 Site-sketch                    (4) | Train Loss: 0.3584 | Train Acc: 0.8600
Average Train Accuracy: 0.9222
 Site-photo                     (3) | Val  Loss: 0.1139 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1058 | Val  Acc: 0.9767
 Site-art_painting              (2) | Val  Loss: 0.2500 | Val  Acc: 0.9200
 Site-art_painting              (2) | Val  Loss: 0.2262 | Val  Acc: 0.9433
 Site-cartoon                   (0) | Val  Loss: 0.3039 | Val  Acc: 0.8500
 Site-cartoon                   (0) | Val  Loss: 0.2883 | Val  Acc: 0.9000
 Site-sketch                    (1) | Val  Loss: 0.3732 | Val  Acc: 0.8700
 Site-sketch                    (4) | Val  Loss: 0.3988 | Val  Acc: 0.8700
Average Valid Accuracy: 0.9125
 Test site-photo                     (3)| Epoch:47 | Test Acc: 0.9910
 Test site-art_painting              (2)| Epoch:47 | Test Acc: 0.9208
 Test site-cartoon                   (0)| Epoch:47 | Test Acc: 0.8851
 Test site-sketch                    (1)| Epoch:47 | Test Acc: 0.8628
photo: 0.9910, art_painting: 0.9208, cartoon: 0.8851, sketch: 0.8628, 
Average Test Accuracy(group): 0.9149, Average Test Accuracy(individual): 0.9149,
domain std=0.0486, cluster std=0.0482, individual std=0.0486, 
Average Test Accuracy: 0.9149
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
============ Train epoch 49 ============
cnt=[2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-photo                     (3) | Train Loss: 0.1047 | Train Acc: 0.9800
 Site-photo                     (3) | Train Loss: 0.0950 | Train Acc: 0.9778
 Site-art_painting              (2) | Train Loss: 0.2468 | Train Acc: 0.9267
 Site-art_painting              (2) | Train Loss: 0.2505 | Train Acc: 0.9267
 Site-cartoon                   (0) | Train Loss: 0.2786 | Train Acc: 0.9200
 Site-cartoon                   (0) | Train Loss: 0.2359 | Train Acc: 0.9311
 Site-sketch                    (1) | Train Loss: 0.4004 | Train Acc: 0.8200
 Site-sketch                    (4) | Train Loss: 0.3618 | Train Acc: 0.8711
Average Train Accuracy: 0.9192
 Site-photo                     (3) | Val  Loss: 0.1207 | Val  Acc: 0.9700
 Site-photo                     (3) | Val  Loss: 0.1129 | Val  Acc: 0.9767
 Site-art_painting              (2) | Val  Loss: 0.2819 | Val  Acc: 0.9000
 Site-art_painting              (2) | Val  Loss: 0.2032 | Val  Acc: 0.9500
 Site-cartoon                   (0) | Val  Loss: 0.3116 | Val  Acc: 0.9000
 Site-cartoon                   (0) | Val  Loss: 0.2840 | Val  Acc: 0.9133
 Site-sketch                    (1) | Val  Loss: 0.3232 | Val  Acc: 0.9000
 Site-sketch                    (4) | Val  Loss: 0.4020 | Val  Acc: 0.8567
Average Valid Accuracy: 0.9208
 Best site-photo                    (3)  | Epoch:49 | Val Acc: 0.9700
 Best site-photo                    (3)  | Epoch:49 | Val Acc: 0.9767
 Best site-art_painting             (2)  | Epoch:49 | Val Acc: 0.9000
 Best site-art_painting             (2)  | Epoch:49 | Val Acc: 0.9500
 Best site-cartoon                  (0)  | Epoch:49 | Val Acc: 0.9000
 Best site-cartoon                  (0)  | Epoch:49 | Val Acc: 0.9133
 Best site-sketch                   (1)  | Epoch:49 | Val Acc: 0.9000
 Best site-sketch                   (4)  | Epoch:49 | Val Acc: 0.8567
 Test site-photo                     (3)| Epoch:49 | Test Acc: 0.9896
 Test site-art_painting              (2)| Epoch:49 | Test Acc: 0.9196
 Test site-cartoon                   (0)| Epoch:49 | Test Acc: 0.8894
 Test site-sketch                    (1)| Epoch:49 | Test Acc: 0.8653
photo: 0.9896, art_painting: 0.9196, cartoon: 0.8894, sketch: 0.8653, 
Average Test Accuracy(group): 0.9160, Average Test Accuracy(individual): 0.9160,
domain std=0.0466, cluster std=0.0464, individual std=0.0466, 
Average Test Accuracy: 0.9160
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1_cluster_5/ccop_q=1...
===2023-08-10 21:08:14===
===2023-08-10 21:08:21===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 5
Loading snapshots...
 Test site-photo                     (3)| Epoch:49 | Test Acc: 0.9896
 Test site-art_painting              (2)| Epoch:49 | Test Acc: 0.9196
 Test site-cartoon                   (0)| Epoch:49 | Test Acc: 0.8894
 Test site-sketch                    (1)| Epoch:49 | Test Acc: 0.8653
photo: 0.9896, art_painting: 0.9196, cartoon: 0.8894, sketch: 0.8653, 
Average Test Accuracy(group): 0.9160, Average Test Accuracy(individual): 0.9160,
domain std=0.0466, cluster std=0.0464, individual std=0.0466, 
