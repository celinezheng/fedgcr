===2023-03-29 10:49:31===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
only align at first round
 Site-MNIST     | Train Loss: 1.7775 | Train Acc: 0.5568
 Site-MNIST     | Train Loss: 1.7378 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.7462 | Train Acc: 0.5682
 Site-MNIST     | Train Loss: 1.6388 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 2.2241 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.1812 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1839 | Train Acc: 0.2159
 Site-USPS      | Train Loss: 1.7932 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.1498 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2163 | Train Acc: 0.2045
 Site-MNIST     | Val  Loss: 1.6531 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.7198 | Val  Acc: 0.5593
 Site-MNIST     | Val  Loss: 1.7612 | Val  Acc: 0.5593
 Site-MNIST     | Val  Loss: 1.7092 | Val  Acc: 0.6780
 Site-SVHN      | Val  Loss: 2.2232 | Val  Acc: 0.1525
 Site-SVHN      | Val  Loss: 2.1662 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.2261 | Val  Acc: 0.1356
 Site-USPS      | Val  Loss: 1.7853 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 2.1203 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.2505 | Val  Acc: 0.1525
Average Valid Accuracy: 0.3915
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5593
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5593
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6780
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1356
 Best site-USPS       | Epoch:0 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-align/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2978 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 1.1982 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 1.2441 | Train Acc: 0.7159
 Site-MNIST     | Train Loss: 1.1561 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.0984 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.0671 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.0695 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 1.3576 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.9207 | Train Acc: 0.3750
 Site-MNIST-M   | Train Loss: 2.0878 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 1.1774 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.2717 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.2751 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.1768 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.1297 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.0755 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1107 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.3849 | Val  Acc: 0.6780
 Site-SynthDigits| Val  Loss: 1.8855 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 2.1380 | Val  Acc: 0.1695
Average Valid Accuracy: 0.4797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1864
 Best site-USPS       | Epoch:1 | Val Acc: 0.6780
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-align/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.9202 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 0.8102 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 0.8077 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.7552 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 2.0364 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.8960 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.9553 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 0.9240 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 1.7223 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 2.0041 | Train Acc: 0.2386
 Site-MNIST     | Val  Loss: 0.7750 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.8367 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.8728 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.7887 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.0238 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.9358 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 1.9881 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.9918 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.7525 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 2.0608 | Val  Acc: 0.2034
Average Valid Accuracy: 0.5644
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2373
 Best site-USPS       | Epoch:2 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-align/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.5989 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.5450 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.5875 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.4833 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 1.8602 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.7584 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.7197 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.6033 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.4881 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.7488 | Train Acc: 0.3977
 Site-MNIST     | Val  Loss: 0.5010 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.5707 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.5424 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.5368 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.8176 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.7922 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.8152 | Val  Acc: 0.3898
 Site-USPS      | Val  Loss: 0.6881 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.5508 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.8634 | Val  Acc: 0.3390
Average Valid Accuracy: 0.6271
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3898
 Best site-USPS       | Epoch:3 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-align/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.4013 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.3302 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.3550 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.2831 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.8098 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.6579 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.6170 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.4721 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.3797 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.7275 | Train Acc: 0.3864
 Site-MNIST     | Val  Loss: 0.2862 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3541 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.3562 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.3753 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.6978 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.7380 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.7082 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.5075 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.5580 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.8999 | Val  Acc: 0.3559
Average Valid Accuracy: 0.6542
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4068
 Best site-USPS       | Epoch:4 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-align/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.3891 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.2829 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3450 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.2614 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.4925 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 1.2869 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.2068 | Train Acc: 0.6250
 Site-USPS      | Train Loss: 0.3829 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.9391 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 1.2763 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.2704 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3588 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.3029 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3432 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.3627 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.3582 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.3746 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 0.3583 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.2997 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.6581 | Val  Acc: 0.4237
Average Valid Accuracy: 0.7237
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5085
 Best site-USPS       | Epoch:5 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-align/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2033 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.1547 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1816 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1261 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.2876 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 1.1173 | Train Acc: 0.6250
 Site-SVHN      | Train Loss: 1.1171 | Train Acc: 0.6136
 Site-USPS      | Train Loss: 0.2928 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.8747 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.0680 | Train Acc: 0.6477
 Site-MNIST     | Val  Loss: 0.1437 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1576 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1673 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1929 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.2134 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.2152 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.1423 | Val  Acc: 0.5932
 Site-USPS      | Val  Loss: 0.3084 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.2694 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.5613 | Val  Acc: 0.4746
Average Valid Accuracy: 0.7627
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5932
 Best site-USPS       | Epoch:6 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-align/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1713 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1165 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1295 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0843 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.1445 | Train Acc: 0.5455
 Site-SVHN      | Train Loss: 0.9465 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 0.9084 | Train Acc: 0.7045
 Site-USPS      | Train Loss: 0.2110 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.5618 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 0.7515 | Train Acc: 0.7386
 Site-MNIST     | Val  Loss: 0.0851 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1341 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1153 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1438 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.9926 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 0.9759 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 0.9480 | Val  Acc: 0.6102
 Site-USPS      | Val  Loss: 0.2360 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.0738 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 1.3700 | Val  Acc: 0.5254
Average Valid Accuracy: 0.8051
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6102
 Best site-USPS       | Epoch:7 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6949
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-align/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1172 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0647 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0898 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0455 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.8755 | Train Acc: 0.6932
 Site-SVHN      | Train Loss: 0.7680 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 0.7061 | Train Acc: 0.7841
 Site-USPS      | Train Loss: 0.1409 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.4967 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 0.6122 | Train Acc: 0.8523
 Site-MNIST     | Val  Loss: 0.0587 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0850 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0747 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1004 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.7583 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 0.8244 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 0.8016 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 0.1827 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.0207 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 1.3480 | Val  Acc: 0.5593
Average Valid Accuracy: 0.8475
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7797
 Best site-USPS       | Epoch:8 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6949
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-align/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0906 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0611 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0646 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0383 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.6748 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 0.5128 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 0.5112 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 0.1448 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.3713 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.4430 | Train Acc: 0.9091
 Site-MNIST     | Val  Loss: 0.0433 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0750 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0735 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0765 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.5494 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 0.5459 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 0.5523 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.1832 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.9761 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 1.2745 | Val  Acc: 0.5593
Average Valid Accuracy: 0.8797
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8814
 Best site-USPS       | Epoch:9 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7288
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-align/FedPrompt...
===2023-03-29 11:23:40===
===2023-03-29 11:23:41===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8850
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3431
 Test site-USPS      | Epoch:9 | Test Acc: 0.8602
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5690
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3593
Average Test Accuracy: 0.6033
