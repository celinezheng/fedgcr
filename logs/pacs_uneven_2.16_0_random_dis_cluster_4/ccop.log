===2023-08-12 05:55:09===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[10, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (0) | Train Loss: 1.8595 | Train Acc: 0.2143
 Site-photo                     (0) | Train Loss: 1.8014 | Train Acc: 0.2778
 Site-photo                     (0) | Train Loss: 1.8579 | Train Acc: 0.2500
 Site-photo                     (0) | Train Loss: 1.8674 | Train Acc: 0.2258
 Site-photo                     (0) | Train Loss: 1.8455 | Train Acc: 0.2250
 Site-photo                     (0) | Train Loss: 1.8179 | Train Acc: 0.2115
 Site-photo                     (0) | Train Loss: 1.7988 | Train Acc: 0.3235
 Site-photo                     (0) | Train Loss: 1.8452 | Train Acc: 0.2273
 Site-photo                     (0) | Train Loss: 1.8650 | Train Acc: 0.1681
 Site-photo                     (0) | Train Loss: 1.8347 | Train Acc: 0.2329
 Site-art_painting              (3) | Train Loss: 1.7920 | Train Acc: 0.5000
 Site-art_painting              (3) | Train Loss: 1.9209 | Train Acc: 0.1364
 Site-art_painting              (3) | Train Loss: 1.9071 | Train Acc: 0.2000
 Site-art_painting              (3) | Train Loss: 1.8593 | Train Acc: 0.2639
 Site-art_painting              (3) | Train Loss: 1.9447 | Train Acc: 0.2422
 Site-cartoon                   (1) | Train Loss: 1.9128 | Train Acc: 0.0909
 Site-cartoon                   (1) | Train Loss: 1.9386 | Train Acc: 0.1739
 Site-sketch                    (2) | Train Loss: 1.9840 | Train Acc: 0.0000
Average Train Accuracy: 0.2202
 Site-photo                     (0) | Val  Loss: 1.7163 | Val  Acc: 0.1111
 Site-photo                     (0) | Val  Loss: 1.8852 | Val  Acc: 0.0833
 Site-photo                     (0) | Val  Loss: 1.8774 | Val  Acc: 0.0000
 Site-photo                     (0) | Val  Loss: 1.9566 | Val  Acc: 0.0476
 Site-photo                     (0) | Val  Loss: 1.8585 | Val  Acc: 0.2593
 Site-photo                     (0) | Val  Loss: 1.9448 | Val  Acc: 0.1714
 Site-photo                     (0) | Val  Loss: 1.8825 | Val  Acc: 0.2667
 Site-photo                     (0) | Val  Loss: 1.8675 | Val  Acc: 0.1379
 Site-photo                     (0) | Val  Loss: 1.8665 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.8292 | Val  Acc: 0.2680
 Site-art_painting              (3) | Val  Loss: 2.0116 | Val  Acc: 0.0000
 Site-art_painting              (3) | Val  Loss: 1.9218 | Val  Acc: 0.1333
 Site-art_painting              (3) | Val  Loss: 1.8519 | Val  Acc: 0.3077
 Site-art_painting              (3) | Val  Loss: 1.9203 | Val  Acc: 0.2340
 Site-art_painting              (3) | Val  Loss: 1.8963 | Val  Acc: 0.2941
 Site-cartoon                   (1) | Val  Loss: 1.9696 | Val  Acc: 0.1429
 Site-cartoon                   (1) | Val  Loss: 2.0247 | Val  Acc: 0.1169
 Site-sketch                    (2) | Val  Loss: 2.0315 | Val  Acc: 0.0256
Average Valid Accuracy: 0.1630
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.1111
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.0833
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.0000
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.0476
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.2593
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.1714
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.2667
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.1379
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.2680
 Best site-art_painting             (3)  | Epoch:0 | Val Acc: 0.0000
 Best site-art_painting             (3)  | Epoch:0 | Val Acc: 0.1333
 Best site-art_painting             (3)  | Epoch:0 | Val Acc: 0.3077
 Best site-art_painting             (3)  | Epoch:0 | Val Acc: 0.2340
 Best site-art_painting             (3)  | Epoch:0 | Val Acc: 0.2941
 Best site-cartoon                  (1)  | Epoch:0 | Val Acc: 0.1429
 Best site-cartoon                  (1)  | Epoch:0 | Val Acc: 0.1169
 Best site-sketch                   (2)  | Epoch:0 | Val Acc: 0.0256
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 10, 1, 5, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (1) | Train Loss: 1.7026 | Train Acc: 0.5000
 Site-photo                     (1) | Train Loss: 1.6940 | Train Acc: 0.3889
 Site-photo                     (1) | Train Loss: 1.6714 | Train Acc: 0.3333
 Site-photo                     (1) | Train Loss: 1.6802 | Train Acc: 0.2581
 Site-photo                     (1) | Train Loss: 1.7169 | Train Acc: 0.3750
 Site-photo                     (1) | Train Loss: 1.7203 | Train Acc: 0.3269
 Site-photo                     (1) | Train Loss: 1.8628 | Train Acc: 0.3088
 Site-photo                     (1) | Train Loss: 1.7510 | Train Acc: 0.3750
 Site-photo                     (1) | Train Loss: 1.7067 | Train Acc: 0.3186
 Site-photo                     (1) | Train Loss: 1.7030 | Train Acc: 0.3151
 Site-art_painting              (3) | Train Loss: 1.6459 | Train Acc: 0.3333
 Site-art_painting              (3) | Train Loss: 1.8226 | Train Acc: 0.0909
 Site-art_painting              (3) | Train Loss: 1.8316 | Train Acc: 0.2500
 Site-art_painting              (3) | Train Loss: 1.7621 | Train Acc: 0.3333
 Site-art_painting              (3) | Train Loss: 1.8737 | Train Acc: 0.2266
 Site-cartoon                   (0) | Train Loss: 1.8449 | Train Acc: 0.0909
 Site-cartoon                   (0) | Train Loss: 1.8821 | Train Acc: 0.1652
 Site-sketch                    (2) | Train Loss: 2.0422 | Train Acc: 0.0172
Average Train Accuracy: 0.2782
 Site-photo                     (1) | Val  Loss: 1.6399 | Val  Acc: 0.4444
 Site-photo                     (1) | Val  Loss: 1.7579 | Val  Acc: 0.1667
 Site-photo                     (1) | Val  Loss: 1.8583 | Val  Acc: 0.1875
 Site-photo                     (1) | Val  Loss: 1.8189 | Val  Acc: 0.1905
 Site-photo                     (1) | Val  Loss: 1.8197 | Val  Acc: 0.2963
 Site-photo                     (1) | Val  Loss: 1.8158 | Val  Acc: 0.2857
 Site-photo                     (1) | Val  Loss: 1.7387 | Val  Acc: 0.3111
 Site-photo                     (1) | Val  Loss: 1.7373 | Val  Acc: 0.3448
 Site-photo                     (1) | Val  Loss: 1.7857 | Val  Acc: 0.3467
 Site-photo                     (1) | Val  Loss: 1.6919 | Val  Acc: 0.3711
 Site-art_painting              (3) | Val  Loss: 2.0509 | Val  Acc: 0.0000
 Site-art_painting              (3) | Val  Loss: 1.8583 | Val  Acc: 0.2000
 Site-art_painting              (3) | Val  Loss: 1.7853 | Val  Acc: 0.2692
 Site-art_painting              (3) | Val  Loss: 1.7961 | Val  Acc: 0.3404
 Site-art_painting              (3) | Val  Loss: 1.7416 | Val  Acc: 0.3647
 Site-cartoon                   (0) | Val  Loss: 2.0407 | Val  Acc: 0.1429
 Site-cartoon                   (0) | Val  Loss: 2.0167 | Val  Acc: 0.1688
 Site-sketch                    (2) | Val  Loss: 2.0530 | Val  Acc: 0.0256
Average Valid Accuracy: 0.2476
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.4444
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.1667
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.1875
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.1905
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.2963
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.2857
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.3111
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.3448
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.3467
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.3711
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.0000
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.2000
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.2692
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.3404
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.3647
 Best site-cartoon                  (0)  | Epoch:1 | Val Acc: 0.1429
 Best site-cartoon                  (0)  | Epoch:1 | Val Acc: 0.1688
 Best site-sketch                   (2)  | Epoch:1 | Val Acc: 0.0256
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 2 ============
cnt=[10, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (0) | Train Loss: 1.5762 | Train Acc: 0.5000
 Site-photo                     (0) | Train Loss: 1.5691 | Train Acc: 0.6111
 Site-photo                     (0) | Train Loss: 1.5398 | Train Acc: 0.6250
 Site-photo                     (0) | Train Loss: 1.5789 | Train Acc: 0.5484
 Site-photo                     (0) | Train Loss: 1.5742 | Train Acc: 0.6000
 Site-photo                     (0) | Train Loss: 1.6239 | Train Acc: 0.5385
 Site-photo                     (0) | Train Loss: 1.5465 | Train Acc: 0.5294
 Site-photo                     (0) | Train Loss: 1.5900 | Train Acc: 0.5114
 Site-photo                     (0) | Train Loss: 1.5322 | Train Acc: 0.6549
 Site-photo                     (0) | Train Loss: 1.5359 | Train Acc: 0.5753
 Site-art_painting              (1) | Train Loss: 1.6985 | Train Acc: 0.5000
 Site-art_painting              (1) | Train Loss: 1.7997 | Train Acc: 0.0909
 Site-art_painting              (1) | Train Loss: 1.7681 | Train Acc: 0.3250
 Site-art_painting              (1) | Train Loss: 1.7571 | Train Acc: 0.3472
 Site-art_painting              (1) | Train Loss: 1.7901 | Train Acc: 0.3203
 Site-cartoon                   (2) | Train Loss: 1.8044 | Train Acc: 0.2727
 Site-cartoon                   (2) | Train Loss: 1.8487 | Train Acc: 0.2348
 Site-sketch                    (3) | Train Loss: 1.9989 | Train Acc: 0.0690
Average Train Accuracy: 0.4363
 Site-photo                     (0) | Val  Loss: 1.3418 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 1.6674 | Val  Acc: 0.5000
 Site-photo                     (0) | Val  Loss: 1.5661 | Val  Acc: 0.5625
 Site-photo                     (0) | Val  Loss: 1.5557 | Val  Acc: 0.6190
 Site-photo                     (0) | Val  Loss: 1.5615 | Val  Acc: 0.5926
 Site-photo                     (0) | Val  Loss: 1.6376 | Val  Acc: 0.5143
 Site-photo                     (0) | Val  Loss: 1.5468 | Val  Acc: 0.5333
 Site-photo                     (0) | Val  Loss: 1.5762 | Val  Acc: 0.5000
 Site-photo                     (0) | Val  Loss: 1.6606 | Val  Acc: 0.5467
 Site-photo                     (0) | Val  Loss: 1.5517 | Val  Acc: 0.5361
 Site-art_painting              (1) | Val  Loss: 1.7330 | Val  Acc: 0.1250
 Site-art_painting              (1) | Val  Loss: 1.7174 | Val  Acc: 0.2667
 Site-art_painting              (1) | Val  Loss: 1.6675 | Val  Acc: 0.4231
 Site-art_painting              (1) | Val  Loss: 1.7282 | Val  Acc: 0.3404
 Site-art_painting              (1) | Val  Loss: 1.6969 | Val  Acc: 0.3647
 Site-cartoon                   (2) | Val  Loss: 2.0010 | Val  Acc: 0.1429
 Site-cartoon                   (2) | Val  Loss: 1.8948 | Val  Acc: 0.1818
 Site-sketch                    (3) | Val  Loss: 2.0153 | Val  Acc: 0.0769
Average Valid Accuracy: 0.4286
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.5000
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.5625
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.6190
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.5926
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.5143
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.5333
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.5000
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.5467
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.5361
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.1250
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.2667
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.4231
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.3404
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.3647
 Best site-cartoon                  (2)  | Epoch:2 | Val Acc: 0.1429
 Best site-cartoon                  (2)  | Epoch:2 | Val Acc: 0.1818
 Best site-sketch                   (3)  | Epoch:2 | Val Acc: 0.0769
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 2, 1, 14, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (0) | Train Loss: 1.4572 | Train Acc: 0.5714
 Site-photo                     (3) | Train Loss: 1.5509 | Train Acc: 0.5556
 Site-photo                     (3) | Train Loss: 1.3927 | Train Acc: 0.6250
 Site-photo                     (3) | Train Loss: 1.3950 | Train Acc: 0.5484
 Site-photo                     (3) | Train Loss: 1.4024 | Train Acc: 0.5750
 Site-photo                     (3) | Train Loss: 1.4444 | Train Acc: 0.6154
 Site-photo                     (3) | Train Loss: 1.4719 | Train Acc: 0.5882
 Site-photo                     (3) | Train Loss: 1.3853 | Train Acc: 0.6023
 Site-photo                     (3) | Train Loss: 1.3940 | Train Acc: 0.6372
 Site-photo                     (3) | Train Loss: 1.3836 | Train Acc: 0.6370
 Site-art_painting              (3) | Train Loss: 1.4625 | Train Acc: 0.5833
 Site-art_painting              (3) | Train Loss: 1.7600 | Train Acc: 0.2273
 Site-art_painting              (3) | Train Loss: 1.7663 | Train Acc: 0.3000
 Site-art_painting              (3) | Train Loss: 1.5433 | Train Acc: 0.4167
 Site-art_painting              (3) | Train Loss: 1.7220 | Train Acc: 0.3516
 Site-cartoon                   (1) | Train Loss: 1.7994 | Train Acc: 0.2727
 Site-cartoon                   (1) | Train Loss: 1.8061 | Train Acc: 0.2870
 Site-sketch                    (2) | Train Loss: 2.0374 | Train Acc: 0.0000
Average Train Accuracy: 0.4663
 Site-photo                     (0) | Val  Loss: 1.3154 | Val  Acc: 0.7778
 Site-photo                     (3) | Val  Loss: 1.5829 | Val  Acc: 0.4167
 Site-photo                     (3) | Val  Loss: 1.4994 | Val  Acc: 0.4375
 Site-photo                     (3) | Val  Loss: 1.4283 | Val  Acc: 0.6190
 Site-photo                     (3) | Val  Loss: 1.4481 | Val  Acc: 0.6667
 Site-photo                     (3) | Val  Loss: 1.5447 | Val  Acc: 0.4857
 Site-photo                     (3) | Val  Loss: 1.4109 | Val  Acc: 0.5333
 Site-photo                     (3) | Val  Loss: 1.4031 | Val  Acc: 0.5862
 Site-photo                     (3) | Val  Loss: 1.4758 | Val  Acc: 0.5467
 Site-photo                     (3) | Val  Loss: 1.3902 | Val  Acc: 0.6289
 Site-art_painting              (3) | Val  Loss: 1.8359 | Val  Acc: 0.0000
 Site-art_painting              (3) | Val  Loss: 1.6422 | Val  Acc: 0.4667
 Site-art_painting              (3) | Val  Loss: 1.6392 | Val  Acc: 0.4231
 Site-art_painting              (3) | Val  Loss: 1.6260 | Val  Acc: 0.5106
 Site-art_painting              (3) | Val  Loss: 1.6525 | Val  Acc: 0.4471
 Site-cartoon                   (1) | Val  Loss: 1.8362 | Val  Acc: 0.1429
 Site-cartoon                   (1) | Val  Loss: 1.8418 | Val  Acc: 0.2208
 Site-sketch                    (2) | Val  Loss: 2.0011 | Val  Acc: 0.0000
Average Valid Accuracy: 0.4394
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.7778
 Best site-photo                    (3)  | Epoch:3 | Val Acc: 0.4167
 Best site-photo                    (3)  | Epoch:3 | Val Acc: 0.4375
 Best site-photo                    (3)  | Epoch:3 | Val Acc: 0.6190
 Best site-photo                    (3)  | Epoch:3 | Val Acc: 0.6667
 Best site-photo                    (3)  | Epoch:3 | Val Acc: 0.4857
 Best site-photo                    (3)  | Epoch:3 | Val Acc: 0.5333
 Best site-photo                    (3)  | Epoch:3 | Val Acc: 0.5862
 Best site-photo                    (3)  | Epoch:3 | Val Acc: 0.5467
 Best site-photo                    (3)  | Epoch:3 | Val Acc: 0.6289
 Best site-art_painting             (3)  | Epoch:3 | Val Acc: 0.0000
 Best site-art_painting             (3)  | Epoch:3 | Val Acc: 0.4667
 Best site-art_painting             (3)  | Epoch:3 | Val Acc: 0.4231
 Best site-art_painting             (3)  | Epoch:3 | Val Acc: 0.5106
 Best site-art_painting             (3)  | Epoch:3 | Val Acc: 0.4471
 Best site-cartoon                  (1)  | Epoch:3 | Val Acc: 0.1429
 Best site-cartoon                  (1)  | Epoch:3 | Val Acc: 0.2208
 Best site-sketch                   (2)  | Epoch:3 | Val Acc: 0.0000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 10, 5, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (1) | Train Loss: 1.3495 | Train Acc: 0.6429
 Site-photo                     (1) | Train Loss: 1.3807 | Train Acc: 0.7778
 Site-photo                     (1) | Train Loss: 1.2363 | Train Acc: 0.7083
 Site-photo                     (1) | Train Loss: 1.1986 | Train Acc: 0.8065
 Site-photo                     (1) | Train Loss: 1.3049 | Train Acc: 0.7250
 Site-photo                     (1) | Train Loss: 1.3180 | Train Acc: 0.6923
 Site-photo                     (1) | Train Loss: 1.3422 | Train Acc: 0.7500
 Site-photo                     (1) | Train Loss: 1.3469 | Train Acc: 0.6932
 Site-photo                     (1) | Train Loss: 1.2740 | Train Acc: 0.7434
 Site-photo                     (1) | Train Loss: 1.2817 | Train Acc: 0.7329
 Site-art_painting              (2) | Train Loss: 1.4895 | Train Acc: 0.6667
 Site-art_painting              (2) | Train Loss: 1.6984 | Train Acc: 0.3636
 Site-art_painting              (2) | Train Loss: 1.6845 | Train Acc: 0.3750
 Site-art_painting              (2) | Train Loss: 1.6116 | Train Acc: 0.5556
 Site-art_painting              (2) | Train Loss: 1.6806 | Train Acc: 0.4375
 Site-cartoon                   (0) | Train Loss: 1.7077 | Train Acc: 0.3636
 Site-cartoon                   (0) | Train Loss: 1.7434 | Train Acc: 0.3043
 Site-sketch                    (3) | Train Loss: 1.9880 | Train Acc: 0.0690
Average Train Accuracy: 0.5782
 Site-photo                     (1) | Val  Loss: 1.1743 | Val  Acc: 0.6667
 Site-photo                     (1) | Val  Loss: 1.4480 | Val  Acc: 0.5833
 Site-photo                     (1) | Val  Loss: 1.3307 | Val  Acc: 0.6875
 Site-photo                     (1) | Val  Loss: 1.3357 | Val  Acc: 0.7143
 Site-photo                     (1) | Val  Loss: 1.3248 | Val  Acc: 0.7407
 Site-photo                     (1) | Val  Loss: 1.4879 | Val  Acc: 0.6000
 Site-photo                     (1) | Val  Loss: 1.2690 | Val  Acc: 0.6667
 Site-photo                     (1) | Val  Loss: 1.2423 | Val  Acc: 0.7586
 Site-photo                     (1) | Val  Loss: 1.3299 | Val  Acc: 0.7333
 Site-photo                     (1) | Val  Loss: 1.2754 | Val  Acc: 0.7010
 Site-art_painting              (2) | Val  Loss: 1.6973 | Val  Acc: 0.2500
 Site-art_painting              (2) | Val  Loss: 1.6314 | Val  Acc: 0.4667
 Site-art_painting              (2) | Val  Loss: 1.6143 | Val  Acc: 0.5000
 Site-art_painting              (2) | Val  Loss: 1.5904 | Val  Acc: 0.5745
 Site-art_painting              (2) | Val  Loss: 1.5754 | Val  Acc: 0.4824
 Site-cartoon                   (0) | Val  Loss: 1.8672 | Val  Acc: 0.2857
 Site-cartoon                   (0) | Val  Loss: 1.8054 | Val  Acc: 0.2597
 Site-sketch                    (3) | Val  Loss: 2.0013 | Val  Acc: 0.0769
Average Valid Accuracy: 0.5416
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.6667
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.5833
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.6875
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.7143
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.7407
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.6000
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.6667
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.7586
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.7333
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.7010
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.2500
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.4667
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.5000
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.5745
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.4824
 Best site-cartoon                  (0)  | Epoch:4 | Val Acc: 0.2857
 Best site-cartoon                  (0)  | Epoch:4 | Val Acc: 0.2597
 Best site-sketch                   (3)  | Epoch:4 | Val Acc: 0.0769
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 5 ============
cnt=[5, 10, 1, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (1) | Train Loss: 1.1600 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 1.2897 | Train Acc: 0.8889
 Site-photo                     (1) | Train Loss: 1.1120 | Train Acc: 0.8750
 Site-photo                     (1) | Train Loss: 1.0968 | Train Acc: 0.9032
 Site-photo                     (1) | Train Loss: 1.2015 | Train Acc: 0.8500
 Site-photo                     (1) | Train Loss: 1.2240 | Train Acc: 0.8654
 Site-photo                     (1) | Train Loss: 1.1513 | Train Acc: 0.9118
 Site-photo                     (1) | Train Loss: 1.2094 | Train Acc: 0.7614
 Site-photo                     (1) | Train Loss: 1.1281 | Train Acc: 0.8673
 Site-photo                     (1) | Train Loss: 1.1393 | Train Acc: 0.8699
 Site-art_painting              (0) | Train Loss: 1.4231 | Train Acc: 0.6667
 Site-art_painting              (0) | Train Loss: 1.6600 | Train Acc: 0.4545
 Site-art_painting              (0) | Train Loss: 1.6286 | Train Acc: 0.5000
 Site-art_painting              (0) | Train Loss: 1.4853 | Train Acc: 0.5278
 Site-art_painting              (0) | Train Loss: 1.5716 | Train Acc: 0.5469
 Site-cartoon                   (3) | Train Loss: 1.5774 | Train Acc: 0.2727
 Site-cartoon                   (3) | Train Loss: 1.7100 | Train Acc: 0.3130
 Site-sketch                    (2) | Train Loss: 1.8851 | Train Acc: 0.1897
Average Train Accuracy: 0.6813
 Site-photo                     (1) | Val  Loss: 1.0294 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 1.2552 | Val  Acc: 0.8333
 Site-photo                     (1) | Val  Loss: 1.1723 | Val  Acc: 0.8750
 Site-photo                     (1) | Val  Loss: 1.1398 | Val  Acc: 0.8095
 Site-photo                     (1) | Val  Loss: 1.1861 | Val  Acc: 0.8148
 Site-photo                     (1) | Val  Loss: 1.3329 | Val  Acc: 0.6857
 Site-photo                     (1) | Val  Loss: 1.1520 | Val  Acc: 0.8222
 Site-photo                     (1) | Val  Loss: 1.1563 | Val  Acc: 0.8103
 Site-photo                     (1) | Val  Loss: 1.1904 | Val  Acc: 0.9067
 Site-photo                     (1) | Val  Loss: 1.1627 | Val  Acc: 0.8866
 Site-art_painting              (0) | Val  Loss: 1.6142 | Val  Acc: 0.5000
 Site-art_painting              (0) | Val  Loss: 1.5441 | Val  Acc: 0.5333
 Site-art_painting              (0) | Val  Loss: 1.5499 | Val  Acc: 0.6154
 Site-art_painting              (0) | Val  Loss: 1.5073 | Val  Acc: 0.5319
 Site-art_painting              (0) | Val  Loss: 1.5332 | Val  Acc: 0.6471
 Site-cartoon                   (3) | Val  Loss: 1.7739 | Val  Acc: 0.2857
 Site-cartoon                   (3) | Val  Loss: 1.7488 | Val  Acc: 0.2727
 Site-sketch                    (2) | Val  Loss: 1.9269 | Val  Acc: 0.1282
Average Valid Accuracy: 0.6582
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8333
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8750
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8095
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8148
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.6857
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8222
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8103
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9067
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8866
 Best site-art_painting             (0)  | Epoch:5 | Val Acc: 0.5000
 Best site-art_painting             (0)  | Epoch:5 | Val Acc: 0.5333
 Best site-art_painting             (0)  | Epoch:5 | Val Acc: 0.6154
 Best site-art_painting             (0)  | Epoch:5 | Val Acc: 0.5319
 Best site-art_painting             (0)  | Epoch:5 | Val Acc: 0.6471
 Best site-cartoon                  (3)  | Epoch:5 | Val Acc: 0.2857
 Best site-cartoon                  (3)  | Epoch:5 | Val Acc: 0.2727
 Best site-sketch                   (2)  | Epoch:5 | Val Acc: 0.1282
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 6 ============
cnt=[8, 7, 1, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (0) | Train Loss: 1.0684 | Train Acc: 0.9286
 Site-photo                     (3) | Train Loss: 1.1715 | Train Acc: 0.8889
 Site-photo                     (0) | Train Loss: 0.9901 | Train Acc: 0.8333
 Site-photo                     (0) | Train Loss: 0.9409 | Train Acc: 0.9355
 Site-photo                     (3) | Train Loss: 1.0916 | Train Acc: 0.8750
 Site-photo                     (0) | Train Loss: 1.0874 | Train Acc: 0.9231
 Site-photo                     (0) | Train Loss: 0.8236 | Train Acc: 0.9118
 Site-photo                     (0) | Train Loss: 1.1303 | Train Acc: 0.8409
 Site-photo                     (0) | Train Loss: 1.0353 | Train Acc: 0.8761
 Site-photo                     (0) | Train Loss: 1.0299 | Train Acc: 0.9110
 Site-art_painting              (1) | Train Loss: 1.4823 | Train Acc: 0.7500
 Site-art_painting              (1) | Train Loss: 1.6906 | Train Acc: 0.3636
 Site-art_painting              (1) | Train Loss: 1.6574 | Train Acc: 0.3750
 Site-art_painting              (1) | Train Loss: 1.4117 | Train Acc: 0.5417
 Site-art_painting              (1) | Train Loss: 1.4964 | Train Acc: 0.5859
 Site-cartoon                   (1) | Train Loss: 1.5348 | Train Acc: 0.4545
 Site-cartoon                   (1) | Train Loss: 1.6334 | Train Acc: 0.3391
 Site-sketch                    (2) | Train Loss: 1.8352 | Train Acc: 0.2241
Average Train Accuracy: 0.6977
 Site-photo                     (0) | Val  Loss: 0.9187 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 1.1462 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 1.0589 | Val  Acc: 0.8750
 Site-photo                     (0) | Val  Loss: 1.0352 | Val  Acc: 0.9048
 Site-photo                     (3) | Val  Loss: 1.1008 | Val  Acc: 0.8519
 Site-photo                     (0) | Val  Loss: 1.2216 | Val  Acc: 0.8000
 Site-photo                     (0) | Val  Loss: 1.1135 | Val  Acc: 0.8222
 Site-photo                     (0) | Val  Loss: 1.0618 | Val  Acc: 0.8621
 Site-photo                     (0) | Val  Loss: 1.0869 | Val  Acc: 0.9200
 Site-photo                     (0) | Val  Loss: 1.0361 | Val  Acc: 0.8866
 Site-art_painting              (1) | Val  Loss: 1.4525 | Val  Acc: 0.7500
 Site-art_painting              (1) | Val  Loss: 1.4503 | Val  Acc: 0.6667
 Site-art_painting              (1) | Val  Loss: 1.5127 | Val  Acc: 0.7308
 Site-art_painting              (1) | Val  Loss: 1.4638 | Val  Acc: 0.6170
 Site-art_painting              (1) | Val  Loss: 1.4107 | Val  Acc: 0.6471
 Site-cartoon                   (1) | Val  Loss: 1.6631 | Val  Acc: 0.4286
 Site-cartoon                   (1) | Val  Loss: 1.6837 | Val  Acc: 0.3506
 Site-sketch                    (2) | Val  Loss: 1.8791 | Val  Acc: 0.1538
Average Valid Accuracy: 0.7324
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.8750
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9048
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.8519
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.8000
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.8222
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.8621
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9200
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.8866
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.7500
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.6667
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.7308
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.6170
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.6471
 Best site-cartoon                  (1)  | Epoch:6 | Val Acc: 0.4286
 Best site-cartoon                  (1)  | Epoch:6 | Val Acc: 0.3506
 Best site-sketch                   (2)  | Epoch:6 | Val Acc: 0.1538
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 7 ============
cnt=[5, 10, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (1) | Train Loss: 0.9629 | Train Acc: 0.9286
 Site-photo                     (1) | Train Loss: 1.1053 | Train Acc: 0.8889
 Site-photo                     (1) | Train Loss: 0.9138 | Train Acc: 0.9167
 Site-photo                     (1) | Train Loss: 0.8971 | Train Acc: 0.9355
 Site-photo                     (1) | Train Loss: 1.0193 | Train Acc: 0.9000
 Site-photo                     (1) | Train Loss: 1.0031 | Train Acc: 0.9423
 Site-photo                     (1) | Train Loss: 0.7830 | Train Acc: 0.9412
 Site-photo                     (1) | Train Loss: 0.9993 | Train Acc: 0.8977
 Site-photo                     (1) | Train Loss: 0.9019 | Train Acc: 0.9292
 Site-photo                     (1) | Train Loss: 0.9920 | Train Acc: 0.8973
 Site-art_painting              (0) | Train Loss: 1.2926 | Train Acc: 0.7500
 Site-art_painting              (0) | Train Loss: 1.5633 | Train Acc: 0.3182
 Site-art_painting              (0) | Train Loss: 1.5340 | Train Acc: 0.5250
 Site-art_painting              (0) | Train Loss: 1.3183 | Train Acc: 0.6389
 Site-art_painting              (0) | Train Loss: 1.4628 | Train Acc: 0.5938
 Site-cartoon                   (2) | Train Loss: 1.3916 | Train Acc: 0.6364
 Site-cartoon                   (2) | Train Loss: 1.5646 | Train Acc: 0.3826
 Site-sketch                    (3) | Train Loss: 1.7945 | Train Acc: 0.2586
Average Train Accuracy: 0.7378
 Site-photo                     (1) | Val  Loss: 0.8484 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.0762 | Val  Acc: 0.8333
 Site-photo                     (1) | Val  Loss: 1.0472 | Val  Acc: 0.8125
 Site-photo                     (1) | Val  Loss: 0.9793 | Val  Acc: 0.8095
 Site-photo                     (1) | Val  Loss: 1.0024 | Val  Acc: 0.8148
 Site-photo                     (1) | Val  Loss: 1.1037 | Val  Acc: 0.8571
 Site-photo                     (1) | Val  Loss: 0.9811 | Val  Acc: 0.9111
 Site-photo                     (1) | Val  Loss: 0.9381 | Val  Acc: 0.9310
 Site-photo                     (1) | Val  Loss: 1.0152 | Val  Acc: 0.9200
 Site-photo                     (1) | Val  Loss: 0.9333 | Val  Acc: 0.9381
 Site-art_painting              (0) | Val  Loss: 1.3618 | Val  Acc: 0.7500
 Site-art_painting              (0) | Val  Loss: 1.3195 | Val  Acc: 0.6667
 Site-art_painting              (0) | Val  Loss: 1.4311 | Val  Acc: 0.6154
 Site-art_painting              (0) | Val  Loss: 1.4002 | Val  Acc: 0.6170
 Site-art_painting              (0) | Val  Loss: 1.3546 | Val  Acc: 0.6588
 Site-cartoon                   (2) | Val  Loss: 1.6429 | Val  Acc: 0.1429
 Site-cartoon                   (2) | Val  Loss: 1.6114 | Val  Acc: 0.4156
 Site-sketch                    (3) | Val  Loss: 1.8315 | Val  Acc: 0.1795
Average Valid Accuracy: 0.7152
============ Train epoch 8 ============
cnt=[10, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (0) | Train Loss: 0.8998 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.0205 | Train Acc: 0.8889
 Site-photo                     (0) | Train Loss: 0.7985 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.8377 | Train Acc: 0.9355
 Site-photo                     (0) | Train Loss: 0.9506 | Train Acc: 0.9000
 Site-photo                     (0) | Train Loss: 0.9053 | Train Acc: 0.9231
 Site-photo                     (0) | Train Loss: 0.8747 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.9248 | Train Acc: 0.8636
 Site-photo                     (0) | Train Loss: 0.8144 | Train Acc: 0.9558
 Site-photo                     (0) | Train Loss: 0.8365 | Train Acc: 0.9041
 Site-art_painting              (3) | Train Loss: 1.3541 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 1.4117 | Train Acc: 0.5000
 Site-art_painting              (3) | Train Loss: 1.4516 | Train Acc: 0.6000
 Site-art_painting              (3) | Train Loss: 1.3396 | Train Acc: 0.6528
 Site-art_painting              (3) | Train Loss: 1.3543 | Train Acc: 0.6328
 Site-cartoon                   (1) | Train Loss: 1.3346 | Train Acc: 0.6364
 Site-cartoon                   (1) | Train Loss: 1.5178 | Train Acc: 0.4435
 Site-sketch                    (2) | Train Loss: 1.7921 | Train Acc: 0.2241
Average Train Accuracy: 0.7679
 Site-photo                     (0) | Val  Loss: 0.6812 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.0060 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.8949 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.8376 | Val  Acc: 0.9048
 Site-photo                     (0) | Val  Loss: 0.8966 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 1.0301 | Val  Acc: 0.8571
 Site-photo                     (0) | Val  Loss: 0.9042 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.8401 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.8631 | Val  Acc: 0.9733
 Site-photo                     (0) | Val  Loss: 0.8429 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 1.1713 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 1.4486 | Val  Acc: 0.6000
 Site-art_painting              (3) | Val  Loss: 1.2486 | Val  Acc: 0.8077
 Site-art_painting              (3) | Val  Loss: 1.3368 | Val  Acc: 0.6596
 Site-art_painting              (3) | Val  Loss: 1.2754 | Val  Acc: 0.6941
 Site-cartoon                   (1) | Val  Loss: 1.6010 | Val  Acc: 0.2857
 Site-cartoon                   (1) | Val  Loss: 1.5234 | Val  Acc: 0.4545
 Site-sketch                    (2) | Val  Loss: 1.8482 | Val  Acc: 0.1795
Average Valid Accuracy: 0.7793
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9048
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.8571
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9733
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9691
 Best site-art_painting             (3)  | Epoch:8 | Val Acc: 1.0000
 Best site-art_painting             (3)  | Epoch:8 | Val Acc: 0.6000
 Best site-art_painting             (3)  | Epoch:8 | Val Acc: 0.8077
 Best site-art_painting             (3)  | Epoch:8 | Val Acc: 0.6596
 Best site-art_painting             (3)  | Epoch:8 | Val Acc: 0.6941
 Best site-cartoon                  (1)  | Epoch:8 | Val Acc: 0.2857
 Best site-cartoon                  (1)  | Epoch:8 | Val Acc: 0.4545
 Best site-sketch                   (2)  | Epoch:8 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 9 ============
cnt=[10, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (0) | Train Loss: 0.8229 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.9545 | Train Acc: 0.8333
 Site-photo                     (0) | Train Loss: 0.7222 | Train Acc: 0.9167
 Site-photo                     (0) | Train Loss: 0.7023 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.8274 | Train Acc: 0.9000
 Site-photo                     (0) | Train Loss: 0.8189 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.6955 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.8528 | Train Acc: 0.8977
 Site-photo                     (0) | Train Loss: 0.7510 | Train Acc: 0.9381
 Site-photo                     (0) | Train Loss: 0.7966 | Train Acc: 0.9247
 Site-art_painting              (1) | Train Loss: 1.3255 | Train Acc: 0.7500
 Site-art_painting              (1) | Train Loss: 1.3558 | Train Acc: 0.6364
 Site-art_painting              (1) | Train Loss: 1.3867 | Train Acc: 0.5750
 Site-art_painting              (1) | Train Loss: 1.1826 | Train Acc: 0.6528
 Site-art_painting              (1) | Train Loss: 1.2831 | Train Acc: 0.6719
 Site-cartoon                   (3) | Train Loss: 1.3245 | Train Acc: 0.7273
 Site-cartoon                   (3) | Train Loss: 1.4379 | Train Acc: 0.4783
 Site-sketch                    (2) | Train Loss: 1.7139 | Train Acc: 0.3276
Average Train Accuracy: 0.7842
 Site-photo                     (0) | Val  Loss: 0.6829 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.8741 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.9100 | Val  Acc: 0.8750
 Site-photo                     (0) | Val  Loss: 0.7264 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7884 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.9042 | Val  Acc: 0.9143
 Site-photo                     (0) | Val  Loss: 0.8102 | Val  Acc: 0.9111
 Site-photo                     (0) | Val  Loss: 0.7399 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.8107 | Val  Acc: 0.9467
 Site-photo                     (0) | Val  Loss: 0.7806 | Val  Acc: 0.9485
 Site-art_painting              (1) | Val  Loss: 1.1567 | Val  Acc: 0.8750
 Site-art_painting              (1) | Val  Loss: 1.3103 | Val  Acc: 0.6667
 Site-art_painting              (1) | Val  Loss: 1.2818 | Val  Acc: 0.6923
 Site-art_painting              (1) | Val  Loss: 1.2502 | Val  Acc: 0.6809
 Site-art_painting              (1) | Val  Loss: 1.2326 | Val  Acc: 0.7059
 Site-cartoon                   (3) | Val  Loss: 1.5018 | Val  Acc: 0.4286
 Site-cartoon                   (3) | Val  Loss: 1.4948 | Val  Acc: 0.4286
 Site-sketch                    (2) | Val  Loss: 1.8083 | Val  Acc: 0.2308
Average Valid Accuracy: 0.7767
============ Train epoch 10 ============
cnt=[7, 3, 5, 3, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (0) | Train Loss: 0.7884 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.8807 | Train Acc: 0.8333
 Site-photo                     (0) | Train Loss: 0.6850 | Train Acc: 0.8750
 Site-photo                     (3) | Train Loss: 0.6232 | Train Acc: 0.9677
 Site-photo                     (3) | Train Loss: 0.7695 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.7496 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.5780 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.7501 | Train Acc: 0.9318
 Site-photo                     (0) | Train Loss: 0.6515 | Train Acc: 0.9646
 Site-photo                     (0) | Train Loss: 0.7206 | Train Acc: 0.9384
 Site-art_painting              (2) | Train Loss: 1.2220 | Train Acc: 0.7500
 Site-art_painting              (2) | Train Loss: 1.3841 | Train Acc: 0.5000
 Site-art_painting              (2) | Train Loss: 1.3671 | Train Acc: 0.6000
 Site-art_painting              (2) | Train Loss: 1.1407 | Train Acc: 0.6944
 Site-art_painting              (2) | Train Loss: 1.1860 | Train Acc: 0.7578
 Site-cartoon                   (1) | Train Loss: 1.2194 | Train Acc: 0.6364
 Site-cartoon                   (1) | Train Loss: 1.3875 | Train Acc: 0.5130
 Site-sketch                    (1) | Train Loss: 1.6972 | Train Acc: 0.4138
Average Train Accuracy: 0.7957
 Site-photo                     (0) | Val  Loss: 0.5969 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.8802 | Val  Acc: 0.8333
 Site-photo                     (0) | Val  Loss: 0.7895 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.6993 | Val  Acc: 0.9048
 Site-photo                     (3) | Val  Loss: 0.7391 | Val  Acc: 0.9259
 Site-photo                     (0) | Val  Loss: 0.8610 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.7778 | Val  Acc: 0.8667
 Site-photo                     (0) | Val  Loss: 0.6687 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.7664 | Val  Acc: 0.9467
 Site-photo                     (0) | Val  Loss: 0.7309 | Val  Acc: 0.9485
 Site-art_painting              (2) | Val  Loss: 1.0476 | Val  Acc: 0.7500
 Site-art_painting              (2) | Val  Loss: 1.2872 | Val  Acc: 0.6000
 Site-art_painting              (2) | Val  Loss: 1.1764 | Val  Acc: 0.8077
 Site-art_painting              (2) | Val  Loss: 1.1742 | Val  Acc: 0.7234
 Site-art_painting              (2) | Val  Loss: 1.1493 | Val  Acc: 0.7529
 Site-cartoon                   (1) | Val  Loss: 1.4624 | Val  Acc: 0.4286
 Site-cartoon                   (1) | Val  Loss: 1.4769 | Val  Acc: 0.4675
 Site-sketch                    (1) | Val  Loss: 1.7802 | Val  Acc: 0.2308
Average Valid Accuracy: 0.7840
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:10 | Val Acc: 0.8333
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:10 | Val Acc: 0.9048
 Best site-photo                    (3)  | Epoch:10 | Val Acc: 0.9259
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9429
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.8667
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9828
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9467
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9485
 Best site-art_painting             (2)  | Epoch:10 | Val Acc: 0.7500
 Best site-art_painting             (2)  | Epoch:10 | Val Acc: 0.6000
 Best site-art_painting             (2)  | Epoch:10 | Val Acc: 0.8077
 Best site-art_painting             (2)  | Epoch:10 | Val Acc: 0.7234
 Best site-art_painting             (2)  | Epoch:10 | Val Acc: 0.7529
 Best site-cartoon                  (1)  | Epoch:10 | Val Acc: 0.4286
 Best site-cartoon                  (1)  | Epoch:10 | Val Acc: 0.4675
 Best site-sketch                   (1)  | Epoch:10 | Val Acc: 0.2308
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 11 ============
cnt=[10, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (0) | Train Loss: 0.6881 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.8180 | Train Acc: 0.8333
 Site-photo                     (0) | Train Loss: 0.5862 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.5436 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.7238 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.6779 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.5957 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.6988 | Train Acc: 0.9545
 Site-photo                     (0) | Train Loss: 0.5878 | Train Acc: 0.9558
 Site-photo                     (0) | Train Loss: 0.6489 | Train Acc: 0.9315
 Site-art_painting              (2) | Train Loss: 1.1201 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 1.3054 | Train Acc: 0.5909
 Site-art_painting              (2) | Train Loss: 1.3005 | Train Acc: 0.7000
 Site-art_painting              (3) | Train Loss: 1.1338 | Train Acc: 0.7778
 Site-art_painting              (3) | Train Loss: 1.1640 | Train Acc: 0.7031
 Site-cartoon                   (1) | Train Loss: 1.3550 | Train Acc: 0.6364
 Site-cartoon                   (1) | Train Loss: 1.3336 | Train Acc: 0.5913
 Site-sketch                    (1) | Train Loss: 1.6162 | Train Acc: 0.3966
Average Train Accuracy: 0.8214
 Site-photo                     (0) | Val  Loss: 0.5510 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.8083 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.6877 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5890 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.6584 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7879 | Val  Acc: 0.8857
 Site-photo                     (0) | Val  Loss: 0.6855 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.6275 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.6666 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.6466 | Val  Acc: 0.9897
 Site-art_painting              (2) | Val  Loss: 0.9919 | Val  Acc: 0.7500
 Site-art_painting              (3) | Val  Loss: 1.1503 | Val  Acc: 0.8000
 Site-art_painting              (2) | Val  Loss: 1.1672 | Val  Acc: 0.7308
 Site-art_painting              (3) | Val  Loss: 1.1417 | Val  Acc: 0.7234
 Site-art_painting              (3) | Val  Loss: 1.1455 | Val  Acc: 0.7294
 Site-cartoon                   (1) | Val  Loss: 1.4898 | Val  Acc: 0.5714
 Site-cartoon                   (1) | Val  Loss: 1.3661 | Val  Acc: 0.5844
 Site-sketch                    (1) | Val  Loss: 1.7186 | Val  Acc: 0.3333
Average Valid Accuracy: 0.8334
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 0.8857
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 0.9828
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 0.9867
 Best site-photo                    (0)  | Epoch:11 | Val Acc: 0.9897
 Best site-art_painting             (2)  | Epoch:11 | Val Acc: 0.7500
 Best site-art_painting             (3)  | Epoch:11 | Val Acc: 0.8000
 Best site-art_painting             (2)  | Epoch:11 | Val Acc: 0.7308
 Best site-art_painting             (3)  | Epoch:11 | Val Acc: 0.7234
 Best site-art_painting             (3)  | Epoch:11 | Val Acc: 0.7294
 Best site-cartoon                  (1)  | Epoch:11 | Val Acc: 0.5714
 Best site-cartoon                  (1)  | Epoch:11 | Val Acc: 0.5844
 Best site-sketch                   (1)  | Epoch:11 | Val Acc: 0.3333
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 12 ============
cnt=[6, 9, 2, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (1) | Train Loss: 0.6457 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.7703 | Train Acc: 0.8889
 Site-photo                     (1) | Train Loss: 0.5596 | Train Acc: 0.9167
 Site-photo                     (1) | Train Loss: 0.5301 | Train Acc: 0.9677
 Site-photo                     (1) | Train Loss: 0.6562 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.6439 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.5168 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.6728 | Train Acc: 0.9318
 Site-photo                     (1) | Train Loss: 0.5434 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.5764 | Train Acc: 0.9452
 Site-art_painting              (0) | Train Loss: 1.0547 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 1.2657 | Train Acc: 0.5000
 Site-art_painting              (0) | Train Loss: 1.2197 | Train Acc: 0.6500
 Site-art_painting              (0) | Train Loss: 1.1774 | Train Acc: 0.8194
 Site-art_painting              (0) | Train Loss: 1.1464 | Train Acc: 0.7578
 Site-cartoon                   (2) | Train Loss: 1.1530 | Train Acc: 0.8182
 Site-cartoon                   (2) | Train Loss: 1.3043 | Train Acc: 0.5913
 Site-sketch                    (3) | Train Loss: 1.5977 | Train Acc: 0.3276
Average Train Accuracy: 0.8303
 Site-photo                     (1) | Val  Loss: 0.4284 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7053 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7016 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5644 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6025 | Val  Acc: 0.9630
 Site-photo                     (1) | Val  Loss: 0.7296 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.6410 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5878 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.6199 | Val  Acc: 0.9733
 Site-photo                     (1) | Val  Loss: 0.5849 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 1.0356 | Val  Acc: 0.7500
 Site-art_painting              (0) | Val  Loss: 1.0701 | Val  Acc: 0.7333
 Site-art_painting              (0) | Val  Loss: 1.1003 | Val  Acc: 0.8077
 Site-art_painting              (0) | Val  Loss: 1.0411 | Val  Acc: 0.8085
 Site-art_painting              (0) | Val  Loss: 1.0522 | Val  Acc: 0.7882
 Site-cartoon                   (2) | Val  Loss: 1.3531 | Val  Acc: 0.4286
 Site-cartoon                   (2) | Val  Loss: 1.3031 | Val  Acc: 0.6234
 Site-sketch                    (3) | Val  Loss: 1.6850 | Val  Acc: 0.3077
Average Valid Accuracy: 0.8367
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.9630
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.9429
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.9733
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.9691
 Best site-art_painting             (0)  | Epoch:12 | Val Acc: 0.7500
 Best site-art_painting             (0)  | Epoch:12 | Val Acc: 0.7333
 Best site-art_painting             (0)  | Epoch:12 | Val Acc: 0.8077
 Best site-art_painting             (0)  | Epoch:12 | Val Acc: 0.8085
 Best site-art_painting             (0)  | Epoch:12 | Val Acc: 0.7882
 Best site-cartoon                  (2)  | Epoch:12 | Val Acc: 0.4286
 Best site-cartoon                  (2)  | Epoch:12 | Val Acc: 0.6234
 Best site-sketch                   (3)  | Epoch:12 | Val Acc: 0.3077
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 13 ============
cnt=[5, 3, 9, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (2) | Train Loss: 0.5804 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.7017 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.5069 | Train Acc: 0.9583
 Site-photo                     (2) | Train Loss: 0.4976 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.5880 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.5813 | Train Acc: 0.9808
 Site-photo                     (2) | Train Loss: 0.5378 | Train Acc: 0.9853
 Site-photo                     (2) | Train Loss: 0.6032 | Train Acc: 0.9773
 Site-photo                     (2) | Train Loss: 0.5185 | Train Acc: 0.9735
 Site-photo                     (2) | Train Loss: 0.5673 | Train Acc: 0.9589
 Site-art_painting              (1) | Train Loss: 0.9493 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 1.2781 | Train Acc: 0.5000
 Site-art_painting              (0) | Train Loss: 1.1963 | Train Acc: 0.6750
 Site-art_painting              (0) | Train Loss: 1.0062 | Train Acc: 0.8194
 Site-art_painting              (0) | Train Loss: 1.0334 | Train Acc: 0.7734
 Site-cartoon                   (1) | Train Loss: 1.1835 | Train Acc: 0.7273
 Site-cartoon                   (1) | Train Loss: 1.2213 | Train Acc: 0.7043
 Site-sketch                    (3) | Train Loss: 1.5661 | Train Acc: 0.4655
Average Train Accuracy: 0.8455
 Site-photo                     (2) | Val  Loss: 0.3825 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.6767 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.6715 | Val  Acc: 0.9375
 Site-photo                     (2) | Val  Loss: 0.5308 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5456 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.6926 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.6140 | Val  Acc: 0.9333
 Site-photo                     (2) | Val  Loss: 0.5096 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.5508 | Val  Acc: 0.9733
 Site-photo                     (2) | Val  Loss: 0.5687 | Val  Acc: 0.9691
 Site-art_painting              (1) | Val  Loss: 0.9272 | Val  Acc: 0.7500
 Site-art_painting              (0) | Val  Loss: 1.0065 | Val  Acc: 0.7333
 Site-art_painting              (0) | Val  Loss: 1.1221 | Val  Acc: 0.8077
 Site-art_painting              (0) | Val  Loss: 1.0662 | Val  Acc: 0.7660
 Site-art_painting              (0) | Val  Loss: 0.9658 | Val  Acc: 0.8235
 Site-cartoon                   (1) | Val  Loss: 1.3520 | Val  Acc: 0.5714
 Site-cartoon                   (1) | Val  Loss: 1.2521 | Val  Acc: 0.6623
 Site-sketch                    (3) | Val  Loss: 1.7063 | Val  Acc: 0.2821
Average Valid Accuracy: 0.8418
 Best site-photo                    (2)  | Epoch:13 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:13 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:13 | Val Acc: 0.9375
 Best site-photo                    (2)  | Epoch:13 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:13 | Val Acc: 0.9429
 Best site-photo                    (2)  | Epoch:13 | Val Acc: 0.9333
 Best site-photo                    (2)  | Epoch:13 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:13 | Val Acc: 0.9733
 Best site-photo                    (2)  | Epoch:13 | Val Acc: 0.9691
 Best site-art_painting             (1)  | Epoch:13 | Val Acc: 0.7500
 Best site-art_painting             (0)  | Epoch:13 | Val Acc: 0.7333
 Best site-art_painting             (0)  | Epoch:13 | Val Acc: 0.8077
 Best site-art_painting             (0)  | Epoch:13 | Val Acc: 0.7660
 Best site-art_painting             (0)  | Epoch:13 | Val Acc: 0.8235
 Best site-cartoon                  (1)  | Epoch:13 | Val Acc: 0.5714
 Best site-cartoon                  (1)  | Epoch:13 | Val Acc: 0.6623
 Best site-sketch                   (3)  | Epoch:13 | Val Acc: 0.2821
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 14 ============
cnt=[7, 1, 8, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (0) | Train Loss: 0.5864 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.6953 | Train Acc: 0.8889
 Site-photo                     (2) | Train Loss: 0.4520 | Train Acc: 0.9583
 Site-photo                     (2) | Train Loss: 0.4559 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.5313 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.5655 | Train Acc: 0.9423
 Site-photo                     (2) | Train Loss: 0.4515 | Train Acc: 0.9706
 Site-photo                     (2) | Train Loss: 0.5352 | Train Acc: 0.9773
 Site-photo                     (2) | Train Loss: 0.4869 | Train Acc: 0.9735
 Site-photo                     (2) | Train Loss: 0.4844 | Train Acc: 0.9589
 Site-art_painting              (0) | Train Loss: 0.9536 | Train Acc: 0.7500
 Site-art_painting              (0) | Train Loss: 1.2253 | Train Acc: 0.5909
 Site-art_painting              (0) | Train Loss: 1.0762 | Train Acc: 0.7250
 Site-art_painting              (0) | Train Loss: 1.0845 | Train Acc: 0.7639
 Site-art_painting              (0) | Train Loss: 0.9715 | Train Acc: 0.7812
 Site-cartoon                   (3) | Train Loss: 1.0944 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 1.2149 | Train Acc: 0.6522
 Site-sketch                    (1) | Train Loss: 1.5394 | Train Acc: 0.4138
Average Train Accuracy: 0.8393
 Site-photo                     (0) | Val  Loss: 0.3646 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.6434 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.5312 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4440 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5254 | Val  Acc: 0.9630
 Site-photo                     (2) | Val  Loss: 0.6121 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.5641 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.4914 | Val  Acc: 0.9828
 Site-photo                     (2) | Val  Loss: 0.5278 | Val  Acc: 0.9733
 Site-photo                     (2) | Val  Loss: 0.4865 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.9017 | Val  Acc: 0.7500
 Site-art_painting              (0) | Val  Loss: 1.0243 | Val  Acc: 0.6667
 Site-art_painting              (0) | Val  Loss: 1.0050 | Val  Acc: 0.8462
 Site-art_painting              (0) | Val  Loss: 0.9682 | Val  Acc: 0.8723
 Site-art_painting              (0) | Val  Loss: 0.9612 | Val  Acc: 0.8235
 Site-cartoon                   (3) | Val  Loss: 1.1166 | Val  Acc: 0.5714
 Site-cartoon                   (3) | Val  Loss: 1.2020 | Val  Acc: 0.5584
 Site-sketch                    (1) | Val  Loss: 1.6095 | Val  Acc: 0.4359
Average Valid Accuracy: 0.8522
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9630
 Best site-photo                    (2)  | Epoch:14 | Val Acc: 0.9714
 Best site-photo                    (2)  | Epoch:14 | Val Acc: 0.9556
 Best site-photo                    (2)  | Epoch:14 | Val Acc: 0.9828
 Best site-photo                    (2)  | Epoch:14 | Val Acc: 0.9733
 Best site-photo                    (2)  | Epoch:14 | Val Acc: 0.9691
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.7500
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.6667
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.8462
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.8723
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.8235
 Best site-cartoon                  (3)  | Epoch:14 | Val Acc: 0.5714
 Best site-cartoon                  (3)  | Epoch:14 | Val Acc: 0.5584
 Best site-sketch                   (1)  | Epoch:14 | Val Acc: 0.4359
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 14, 1, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (1) | Train Loss: 0.4927 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6461 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.4131 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4058 | Train Acc: 0.9677
 Site-photo                     (1) | Train Loss: 0.5557 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.5093 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 0.3720 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.5279 | Train Acc: 0.9659
 Site-photo                     (1) | Train Loss: 0.4290 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.4546 | Train Acc: 0.9658
 Site-art_painting              (3) | Train Loss: 0.9340 | Train Acc: 0.9167
 Site-art_painting              (1) | Train Loss: 1.1933 | Train Acc: 0.5909
 Site-art_painting              (1) | Train Loss: 1.0695 | Train Acc: 0.7250
 Site-art_painting              (1) | Train Loss: 0.9212 | Train Acc: 0.7639
 Site-art_painting              (1) | Train Loss: 0.9681 | Train Acc: 0.8125
 Site-cartoon                   (0) | Train Loss: 1.0403 | Train Acc: 0.8182
 Site-cartoon                   (0) | Train Loss: 1.1039 | Train Acc: 0.6957
 Site-sketch                    (2) | Train Loss: 1.4723 | Train Acc: 0.4483
Average Train Accuracy: 0.8614
 Site-photo                     (1) | Val  Loss: 0.3688 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5790 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5649 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4568 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5098 | Val  Acc: 0.9630
 Site-photo                     (1) | Val  Loss: 0.5700 | Val  Acc: 0.9143
 Site-photo                     (1) | Val  Loss: 0.4979 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.4449 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 0.4909 | Val  Acc: 0.9733
 Site-photo                     (1) | Val  Loss: 0.4650 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.8423 | Val  Acc: 0.8750
 Site-art_painting              (1) | Val  Loss: 0.9219 | Val  Acc: 0.8667
 Site-art_painting              (1) | Val  Loss: 1.0471 | Val  Acc: 0.7692
 Site-art_painting              (1) | Val  Loss: 0.9489 | Val  Acc: 0.8085
 Site-art_painting              (1) | Val  Loss: 0.9205 | Val  Acc: 0.8235
 Site-cartoon                   (0) | Val  Loss: 1.2715 | Val  Acc: 0.5714
 Site-cartoon                   (0) | Val  Loss: 1.1801 | Val  Acc: 0.6234
 Site-sketch                    (2) | Val  Loss: 1.6252 | Val  Acc: 0.3333
Average Valid Accuracy: 0.8577
 Best site-photo                    (1)  | Epoch:15 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:15 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:15 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:15 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:15 | Val Acc: 0.9630
 Best site-photo                    (1)  | Epoch:15 | Val Acc: 0.9143
 Best site-photo                    (1)  | Epoch:15 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:15 | Val Acc: 0.9828
 Best site-photo                    (1)  | Epoch:15 | Val Acc: 0.9733
 Best site-photo                    (1)  | Epoch:15 | Val Acc: 0.9794
 Best site-art_painting             (3)  | Epoch:15 | Val Acc: 0.8750
 Best site-art_painting             (1)  | Epoch:15 | Val Acc: 0.8667
 Best site-art_painting             (1)  | Epoch:15 | Val Acc: 0.7692
 Best site-art_painting             (1)  | Epoch:15 | Val Acc: 0.8085
 Best site-art_painting             (1)  | Epoch:15 | Val Acc: 0.8235
 Best site-cartoon                  (0)  | Epoch:15 | Val Acc: 0.5714
 Best site-cartoon                  (0)  | Epoch:15 | Val Acc: 0.6234
 Best site-sketch                   (2)  | Epoch:15 | Val Acc: 0.3333
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 16 ============
cnt=[7, 8, 1, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (1) | Train Loss: 0.4924 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6124 | Train Acc: 0.8889
 Site-photo                     (1) | Train Loss: 0.4163 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.3956 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.4325 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4728 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 0.3169 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.4650 | Train Acc: 0.9773
 Site-photo                     (1) | Train Loss: 0.4006 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.4415 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.8928 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 1.1139 | Train Acc: 0.7727
 Site-art_painting              (0) | Train Loss: 0.9749 | Train Acc: 0.7500
 Site-art_painting              (0) | Train Loss: 0.8633 | Train Acc: 0.8056
 Site-art_painting              (0) | Train Loss: 0.9076 | Train Acc: 0.8203
 Site-cartoon                   (3) | Train Loss: 1.0894 | Train Acc: 0.7273
 Site-cartoon                   (3) | Train Loss: 1.0916 | Train Acc: 0.7217
 Site-sketch                    (2) | Train Loss: 1.4165 | Train Acc: 0.5345
Average Train Accuracy: 0.8733
 Site-photo                     (1) | Val  Loss: 0.4285 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5338 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5647 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.4128 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.4547 | Val  Acc: 0.9630
 Site-photo                     (1) | Val  Loss: 0.5471 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.4793 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.4236 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 0.4464 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4480 | Val  Acc: 0.9381
 Site-art_painting              (0) | Val  Loss: 0.8663 | Val  Acc: 0.7500
 Site-art_painting              (0) | Val  Loss: 0.9499 | Val  Acc: 0.8000
 Site-art_painting              (0) | Val  Loss: 0.9186 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.8538 | Val  Acc: 0.8723
 Site-art_painting              (0) | Val  Loss: 0.8473 | Val  Acc: 0.8118
 Site-cartoon                   (3) | Val  Loss: 1.2059 | Val  Acc: 0.5714
 Site-cartoon                   (3) | Val  Loss: 1.0675 | Val  Acc: 0.6753
 Site-sketch                    (2) | Val  Loss: 1.5478 | Val  Acc: 0.4615
Average Valid Accuracy: 0.8598
 Best site-photo                    (1)  | Epoch:16 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:16 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:16 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:16 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:16 | Val Acc: 0.9630
 Best site-photo                    (1)  | Epoch:16 | Val Acc: 0.9429
 Best site-photo                    (1)  | Epoch:16 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:16 | Val Acc: 0.9828
 Best site-photo                    (1)  | Epoch:16 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:16 | Val Acc: 0.9381
 Best site-art_painting             (0)  | Epoch:16 | Val Acc: 0.7500
 Best site-art_painting             (0)  | Epoch:16 | Val Acc: 0.8000
 Best site-art_painting             (0)  | Epoch:16 | Val Acc: 0.8846
 Best site-art_painting             (0)  | Epoch:16 | Val Acc: 0.8723
 Best site-art_painting             (0)  | Epoch:16 | Val Acc: 0.8118
 Best site-cartoon                  (3)  | Epoch:16 | Val Acc: 0.5714
 Best site-cartoon                  (3)  | Epoch:16 | Val Acc: 0.6753
 Best site-sketch                   (2)  | Epoch:16 | Val Acc: 0.4615
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 17 ============
cnt=[5, 1, 10, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (2) | Train Loss: 0.4696 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.5696 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3840 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3476 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.4590 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.4630 | Train Acc: 0.9615
 Site-photo                     (2) | Train Loss: 0.3207 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.4685 | Train Acc: 0.9773
 Site-photo                     (2) | Train Loss: 0.3784 | Train Acc: 0.9735
 Site-photo                     (2) | Train Loss: 0.3816 | Train Acc: 0.9863
 Site-art_painting              (0) | Train Loss: 0.7620 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.9983 | Train Acc: 0.6364
 Site-art_painting              (0) | Train Loss: 0.9399 | Train Acc: 0.7500
 Site-art_painting              (0) | Train Loss: 0.9813 | Train Acc: 0.8056
 Site-art_painting              (0) | Train Loss: 0.8385 | Train Acc: 0.8359
 Site-cartoon                   (3) | Train Loss: 1.0957 | Train Acc: 0.7273
 Site-cartoon                   (3) | Train Loss: 1.0551 | Train Acc: 0.7217
 Site-sketch                    (1) | Train Loss: 1.4044 | Train Acc: 0.5517
Average Train Accuracy: 0.8742
 Site-photo                     (2) | Val  Loss: 0.3218 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4973 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.4411 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3557 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4722 | Val  Acc: 0.9630
 Site-photo                     (2) | Val  Loss: 0.5447 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.4415 | Val  Acc: 0.9778
 Site-photo                     (2) | Val  Loss: 0.4117 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4157 | Val  Acc: 0.9867
 Site-photo                     (2) | Val  Loss: 0.4028 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.6867 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 0.8020 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.9536 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.8851 | Val  Acc: 0.8298
 Site-art_painting              (0) | Val  Loss: 0.7887 | Val  Acc: 0.8588
 Site-cartoon                   (3) | Val  Loss: 1.1713 | Val  Acc: 0.5714
 Site-cartoon                   (3) | Val  Loss: 1.0777 | Val  Acc: 0.7273
 Site-sketch                    (1) | Val  Loss: 1.5928 | Val  Acc: 0.3590
Average Valid Accuracy: 0.8791
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9167
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9630
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9714
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9778
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9867
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9691
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8750
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.9333
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8846
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8298
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8588
 Best site-cartoon                  (3)  | Epoch:17 | Val Acc: 0.5714
 Best site-cartoon                  (3)  | Epoch:17 | Val Acc: 0.7273
 Best site-sketch                   (1)  | Epoch:17 | Val Acc: 0.3590
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 18 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (0) | Train Loss: 0.3820 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5580 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.3553 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3502 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.4247 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.4226 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.2885 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.4512 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.3483 | Train Acc: 0.9912
 Site-photo                     (0) | Train Loss: 0.3872 | Train Acc: 0.9521
 Site-art_painting              (3) | Train Loss: 0.7758 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 1.0910 | Train Acc: 0.6364
 Site-art_painting              (3) | Train Loss: 0.9878 | Train Acc: 0.7250
 Site-art_painting              (3) | Train Loss: 0.7807 | Train Acc: 0.8056
 Site-art_painting              (3) | Train Loss: 0.8306 | Train Acc: 0.8438
 Site-cartoon                   (2) | Train Loss: 0.9931 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 0.9864 | Train Acc: 0.7391
 Site-sketch                    (1) | Train Loss: 1.3691 | Train Acc: 0.5517
Average Train Accuracy: 0.8682
 Site-photo                     (0) | Val  Loss: 0.3254 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5211 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4842 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3247 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3895 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4916 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4228 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3664 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.4063 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.3838 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 0.6929 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.9791 | Val  Acc: 0.7333
 Site-art_painting              (3) | Val  Loss: 0.8894 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.7847 | Val  Acc: 0.8936
 Site-art_painting              (3) | Val  Loss: 0.7651 | Val  Acc: 0.8824
 Site-cartoon                   (2) | Val  Loss: 1.1073 | Val  Acc: 0.5714
 Site-cartoon                   (2) | Val  Loss: 1.0221 | Val  Acc: 0.7403
 Site-sketch                    (1) | Val  Loss: 1.5399 | Val  Acc: 0.3846
Average Valid Accuracy: 0.8835
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9828
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9867
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9691
 Best site-art_painting             (3)  | Epoch:18 | Val Acc: 0.8750
 Best site-art_painting             (3)  | Epoch:18 | Val Acc: 0.7333
 Best site-art_painting             (3)  | Epoch:18 | Val Acc: 0.8846
 Best site-art_painting             (3)  | Epoch:18 | Val Acc: 0.8936
 Best site-art_painting             (3)  | Epoch:18 | Val Acc: 0.8824
 Best site-cartoon                  (2)  | Epoch:18 | Val Acc: 0.5714
 Best site-cartoon                  (2)  | Epoch:18 | Val Acc: 0.7403
 Best site-sketch                   (1)  | Epoch:18 | Val Acc: 0.3846
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 1, 12, 3, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (2) | Train Loss: 0.3810 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.4928 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3123 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.3298 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4127 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.3880 | Train Acc: 0.9808
 Site-photo                     (2) | Train Loss: 0.2660 | Train Acc: 0.9853
 Site-photo                     (2) | Train Loss: 0.3854 | Train Acc: 0.9659
 Site-photo                     (2) | Train Loss: 0.3251 | Train Acc: 0.9823
 Site-photo                     (2) | Train Loss: 0.3442 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.7345 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.9487 | Train Acc: 0.6818
 Site-art_painting              (2) | Train Loss: 0.8815 | Train Acc: 0.7750
 Site-art_painting              (2) | Train Loss: 0.6565 | Train Acc: 0.8472
 Site-art_painting              (2) | Train Loss: 0.7888 | Train Acc: 0.8516
 Site-cartoon                   (3) | Train Loss: 1.0974 | Train Acc: 0.6364
 Site-cartoon                   (3) | Train Loss: 0.9503 | Train Acc: 0.7565
 Site-sketch                    (1) | Train Loss: 1.3294 | Train Acc: 0.6379
Average Train Accuracy: 0.8846
 Site-photo                     (2) | Val  Loss: 0.2311 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4676 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4446 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3381 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3794 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4963 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.4189 | Val  Acc: 0.9778
 Site-photo                     (2) | Val  Loss: 0.3349 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3844 | Val  Acc: 0.9867
 Site-photo                     (2) | Val  Loss: 0.3584 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 0.7395 | Val  Acc: 0.6250
 Site-art_painting              (2) | Val  Loss: 0.7044 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.8656 | Val  Acc: 0.8077
 Site-art_painting              (2) | Val  Loss: 0.7598 | Val  Acc: 0.8723
 Site-art_painting              (2) | Val  Loss: 0.7008 | Val  Acc: 0.8824
 Site-cartoon                   (3) | Val  Loss: 1.0052 | Val  Acc: 0.5714
 Site-cartoon                   (3) | Val  Loss: 1.0291 | Val  Acc: 0.7532
 Site-sketch                    (1) | Val  Loss: 1.4244 | Val  Acc: 0.5128
Average Valid Accuracy: 0.8813
============ Train epoch 20 ============
cnt=[5, 2, 1, 10, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (3) | Train Loss: 0.3638 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.4640 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2908 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2953 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.3927 | Train Acc: 0.9750
 Site-photo                     (3) | Train Loss: 0.3923 | Train Acc: 0.9808
 Site-photo                     (3) | Train Loss: 0.2549 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.3544 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.3054 | Train Acc: 0.9823
 Site-photo                     (3) | Train Loss: 0.3500 | Train Acc: 0.9589
 Site-art_painting              (0) | Train Loss: 0.6693 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 1.0823 | Train Acc: 0.5909
 Site-art_painting              (0) | Train Loss: 0.8966 | Train Acc: 0.7750
 Site-art_painting              (0) | Train Loss: 0.7952 | Train Acc: 0.8750
 Site-art_painting              (0) | Train Loss: 0.7586 | Train Acc: 0.8594
 Site-cartoon                   (1) | Train Loss: 1.0511 | Train Acc: 0.6364
 Site-cartoon                   (1) | Train Loss: 0.9013 | Train Acc: 0.7652
 Site-sketch                    (2) | Train Loss: 1.2913 | Train Acc: 0.6207
Average Train Accuracy: 0.8839
 Site-photo                     (3) | Val  Loss: 0.2177 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.4482 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.3988 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.3399 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.3572 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.4775 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.3769 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.3267 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.3271 | Val  Acc: 0.9867
 Site-photo                     (3) | Val  Loss: 0.3326 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.5887 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 0.7472 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.8489 | Val  Acc: 0.8077
 Site-art_painting              (0) | Val  Loss: 0.7379 | Val  Acc: 0.8511
 Site-art_painting              (0) | Val  Loss: 0.6834 | Val  Acc: 0.8824
 Site-cartoon                   (1) | Val  Loss: 1.0132 | Val  Acc: 0.5714
 Site-cartoon                   (1) | Val  Loss: 0.9352 | Val  Acc: 0.7532
 Site-sketch                    (2) | Val  Loss: 1.4324 | Val  Acc: 0.4872
Average Valid Accuracy: 0.8903
 Best site-photo                    (3)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:20 | Val Acc: 0.9524
 Best site-photo                    (3)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:20 | Val Acc: 0.9556
 Best site-photo                    (3)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:20 | Val Acc: 0.9867
 Best site-photo                    (3)  | Epoch:20 | Val Acc: 0.9691
 Best site-art_painting             (0)  | Epoch:20 | Val Acc: 0.8750
 Best site-art_painting             (0)  | Epoch:20 | Val Acc: 0.9333
 Best site-art_painting             (0)  | Epoch:20 | Val Acc: 0.8077
 Best site-art_painting             (0)  | Epoch:20 | Val Acc: 0.8511
 Best site-art_painting             (0)  | Epoch:20 | Val Acc: 0.8824
 Best site-cartoon                  (1)  | Epoch:20 | Val Acc: 0.5714
 Best site-cartoon                  (1)  | Epoch:20 | Val Acc: 0.7532
 Best site-sketch                   (2)  | Epoch:20 | Val Acc: 0.4872
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 21 ============
cnt=[4, 1, 10, 3, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (2) | Train Loss: 0.3551 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.4315 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3094 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2854 | Train Acc: 0.9677
 Site-photo                     (2) | Train Loss: 0.4027 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.3606 | Train Acc: 0.9423
 Site-photo                     (2) | Train Loss: 0.3231 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3405 | Train Acc: 0.9886
 Site-photo                     (2) | Train Loss: 0.3065 | Train Acc: 0.9558
 Site-photo                     (2) | Train Loss: 0.3620 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.6106 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.9323 | Train Acc: 0.6818
 Site-art_painting              (0) | Train Loss: 0.8286 | Train Acc: 0.8500
 Site-art_painting              (0) | Train Loss: 0.8779 | Train Acc: 0.8472
 Site-art_painting              (0) | Train Loss: 0.7050 | Train Acc: 0.8672
 Site-cartoon                   (3) | Train Loss: 1.0041 | Train Acc: 0.6364
 Site-cartoon                   (3) | Train Loss: 0.9041 | Train Acc: 0.7913
 Site-sketch                    (1) | Train Loss: 1.2686 | Train Acc: 0.6034
Average Train Accuracy: 0.8887
 Site-photo                     (2) | Val  Loss: 0.2227 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4281 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3822 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2729 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3292 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4388 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.3484 | Val  Acc: 0.9778
 Site-photo                     (2) | Val  Loss: 0.2899 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3361 | Val  Acc: 0.9867
 Site-photo                     (2) | Val  Loss: 0.3324 | Val  Acc: 0.9588
 Site-art_painting              (3) | Val  Loss: 0.5614 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 0.7145 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.7803 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.7128 | Val  Acc: 0.8723
 Site-art_painting              (0) | Val  Loss: 0.6296 | Val  Acc: 0.8824
 Site-cartoon                   (3) | Val  Loss: 0.8378 | Val  Acc: 0.7143
 Site-cartoon                   (3) | Val  Loss: 0.9417 | Val  Acc: 0.7403
 Site-sketch                    (1) | Val  Loss: 1.3560 | Val  Acc: 0.6154
Average Valid Accuracy: 0.9118
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 0.9714
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 0.9778
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 0.9867
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 0.9588
 Best site-art_painting             (3)  | Epoch:21 | Val Acc: 0.8750
 Best site-art_painting             (0)  | Epoch:21 | Val Acc: 0.9333
 Best site-art_painting             (0)  | Epoch:21 | Val Acc: 0.8846
 Best site-art_painting             (0)  | Epoch:21 | Val Acc: 0.8723
 Best site-art_painting             (0)  | Epoch:21 | Val Acc: 0.8824
 Best site-cartoon                  (3)  | Epoch:21 | Val Acc: 0.7143
 Best site-cartoon                  (3)  | Epoch:21 | Val Acc: 0.7403
 Best site-sketch                   (1)  | Epoch:21 | Val Acc: 0.6154
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 22 ============
cnt=[4, 3, 10, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (2) | Train Loss: 0.4108 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.4235 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2696 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2864 | Train Acc: 0.9677
 Site-photo                     (2) | Train Loss: 0.3339 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3660 | Train Acc: 0.9231
 Site-photo                     (2) | Train Loss: 0.2617 | Train Acc: 0.9853
 Site-photo                     (2) | Train Loss: 0.3113 | Train Acc: 0.9886
 Site-photo                     (2) | Train Loss: 0.2862 | Train Acc: 0.9823
 Site-photo                     (2) | Train Loss: 0.2946 | Train Acc: 0.9521
 Site-art_painting              (1) | Train Loss: 0.6787 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.8987 | Train Acc: 0.5909
 Site-art_painting              (0) | Train Loss: 0.7910 | Train Acc: 0.8000
 Site-art_painting              (0) | Train Loss: 0.5933 | Train Acc: 0.8750
 Site-art_painting              (0) | Train Loss: 0.6711 | Train Acc: 0.8750
 Site-cartoon                   (1) | Train Loss: 0.9129 | Train Acc: 0.7273
 Site-cartoon                   (1) | Train Loss: 0.8547 | Train Acc: 0.8000
 Site-sketch                    (3) | Train Loss: 1.1637 | Train Acc: 0.6552
Average Train Accuracy: 0.8864
 Site-photo                     (2) | Val  Loss: 0.1852 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3493 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3494 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2668 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3801 | Val  Acc: 0.9630
 Site-photo                     (2) | Val  Loss: 0.4094 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.3320 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2941 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3117 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3009 | Val  Acc: 0.9897
 Site-art_painting              (1) | Val  Loss: 0.5663 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 0.6644 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.7404 | Val  Acc: 0.8462
 Site-art_painting              (0) | Val  Loss: 0.7021 | Val  Acc: 0.8298
 Site-art_painting              (0) | Val  Loss: 0.6144 | Val  Acc: 0.8941
 Site-cartoon                   (1) | Val  Loss: 0.7967 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.9251 | Val  Acc: 0.7532
 Site-sketch                    (3) | Val  Loss: 1.3028 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9174
 Best site-photo                    (2)  | Epoch:22 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:22 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:22 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:22 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:22 | Val Acc: 0.9630
 Best site-photo                    (2)  | Epoch:22 | Val Acc: 0.9714
 Best site-photo                    (2)  | Epoch:22 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:22 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:22 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:22 | Val Acc: 0.9897
 Best site-art_painting             (1)  | Epoch:22 | Val Acc: 0.8750
 Best site-art_painting             (0)  | Epoch:22 | Val Acc: 0.8667
 Best site-art_painting             (0)  | Epoch:22 | Val Acc: 0.8462
 Best site-art_painting             (0)  | Epoch:22 | Val Acc: 0.8298
 Best site-art_painting             (0)  | Epoch:22 | Val Acc: 0.8941
 Best site-cartoon                  (1)  | Epoch:22 | Val Acc: 0.8571
 Best site-cartoon                  (1)  | Epoch:22 | Val Acc: 0.7532
 Best site-sketch                   (3)  | Epoch:22 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 23 ============
cnt=[9, 1, 6, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (0) | Train Loss: 0.3401 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.4221 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.2420 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2887 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.2809 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3267 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.2018 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.3161 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.2749 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.2878 | Train Acc: 0.9589
 Site-art_painting              (2) | Train Loss: 0.5842 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 0.9044 | Train Acc: 0.7273
 Site-art_painting              (2) | Train Loss: 0.7761 | Train Acc: 0.8250
 Site-art_painting              (2) | Train Loss: 0.5739 | Train Acc: 0.8611
 Site-art_painting              (2) | Train Loss: 0.6502 | Train Acc: 0.8828
 Site-cartoon                   (3) | Train Loss: 0.9729 | Train Acc: 0.6364
 Site-cartoon                   (3) | Train Loss: 0.8166 | Train Acc: 0.7913
 Site-sketch                    (1) | Train Loss: 1.1824 | Train Acc: 0.6207
Average Train Accuracy: 0.8870
 Site-photo                     (0) | Val  Loss: 0.1812 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3646 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3825 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2498 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3140 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4093 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3410 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2568 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2941 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3185 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 0.5877 | Val  Acc: 0.8750
 Site-art_painting              (2) | Val  Loss: 0.6579 | Val  Acc: 0.8667
 Site-art_painting              (2) | Val  Loss: 0.6958 | Val  Acc: 0.8462
 Site-art_painting              (2) | Val  Loss: 0.6938 | Val  Acc: 0.8936
 Site-art_painting              (2) | Val  Loss: 0.5574 | Val  Acc: 0.9294
 Site-cartoon                   (3) | Val  Loss: 0.8152 | Val  Acc: 0.8571
 Site-cartoon                   (3) | Val  Loss: 0.9371 | Val  Acc: 0.8052
 Site-sketch                    (1) | Val  Loss: 1.3183 | Val  Acc: 0.4615
Average Valid Accuracy: 0.9169
============ Train epoch 24 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (0) | Train Loss: 0.2990 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4178 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2762 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2440 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2750 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3031 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.2859 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2999 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.2565 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.2687 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.5209 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.7633 | Train Acc: 0.7273
 Site-art_painting              (3) | Train Loss: 0.7294 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.5406 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.6368 | Train Acc: 0.8750
 Site-cartoon                   (2) | Train Loss: 0.9061 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 0.7687 | Train Acc: 0.8348
 Site-sketch                    (1) | Train Loss: 1.1523 | Train Acc: 0.6897
Average Train Accuracy: 0.9122
 Site-photo                     (0) | Val  Loss: 0.1657 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3683 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3650 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.2465 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3146 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3585 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2987 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2611 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2818 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2706 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.4004 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.6064 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.6842 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.6313 | Val  Acc: 0.8723
 Site-art_painting              (3) | Val  Loss: 0.5576 | Val  Acc: 0.8824
 Site-cartoon                   (2) | Val  Loss: 0.7415 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 0.8017 | Val  Acc: 0.7662
 Site-sketch                    (1) | Val  Loss: 1.3005 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9116
============ Train epoch 25 ============
cnt=[2, 10, 1, 5, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (1) | Train Loss: 0.3078 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3599 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2316 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2329 | Train Acc: 0.9677
 Site-photo                     (1) | Train Loss: 0.3465 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.2892 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.2187 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3559 | Train Acc: 0.9773
 Site-photo                     (1) | Train Loss: 0.2385 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.3164 | Train Acc: 0.9521
 Site-art_painting              (3) | Train Loss: 0.5047 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.9114 | Train Acc: 0.6818
 Site-art_painting              (3) | Train Loss: 0.6717 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.7566 | Train Acc: 0.8056
 Site-art_painting              (3) | Train Loss: 0.5708 | Train Acc: 0.9062
 Site-cartoon                   (0) | Train Loss: 0.8958 | Train Acc: 0.7273
 Site-cartoon                   (0) | Train Loss: 0.7656 | Train Acc: 0.7913
 Site-sketch                    (2) | Train Loss: 1.1480 | Train Acc: 0.6897
Average Train Accuracy: 0.8997
 Site-photo                     (1) | Val  Loss: 0.3415 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.3387 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3048 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1922 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3197 | Val  Acc: 0.9630
 Site-photo                     (1) | Val  Loss: 0.3957 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.3014 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2326 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2485 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2782 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 0.5120 | Val  Acc: 0.7500
 Site-art_painting              (3) | Val  Loss: 0.5646 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.6491 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.5851 | Val  Acc: 0.9149
 Site-art_painting              (3) | Val  Loss: 0.4971 | Val  Acc: 0.8941
 Site-cartoon                   (0) | Val  Loss: 0.8092 | Val  Acc: 0.8571
 Site-cartoon                   (0) | Val  Loss: 0.7747 | Val  Acc: 0.8052
 Site-sketch                    (2) | Val  Loss: 1.3097 | Val  Acc: 0.5385
Average Valid Accuracy: 0.9116
============ Train epoch 26 ============
cnt=[2, 1, 14, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (2) | Train Loss: 0.2830 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3899 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.2312 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.2493 | Train Acc: 0.9677
 Site-photo                     (2) | Train Loss: 0.3226 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.2938 | Train Acc: 0.9808
 Site-photo                     (2) | Train Loss: 0.1858 | Train Acc: 0.9853
 Site-photo                     (2) | Train Loss: 0.2930 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2232 | Train Acc: 0.9823
 Site-photo                     (2) | Train Loss: 0.2617 | Train Acc: 0.9658
 Site-art_painting              (2) | Train Loss: 0.5671 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.8736 | Train Acc: 0.6818
 Site-art_painting              (2) | Train Loss: 0.7376 | Train Acc: 0.7500
 Site-art_painting              (2) | Train Loss: 0.6973 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 0.6055 | Train Acc: 0.8906
 Site-cartoon                   (3) | Train Loss: 1.0151 | Train Acc: 0.6364
 Site-cartoon                   (0) | Train Loss: 0.7477 | Train Acc: 0.8435
 Site-sketch                    (1) | Train Loss: 1.0798 | Train Acc: 0.6724
Average Train Accuracy: 0.8880
 Site-photo                     (2) | Val  Loss: 0.1752 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2956 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2950 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2094 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2825 | Val  Acc: 0.9630
 Site-photo                     (2) | Val  Loss: 0.3456 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.2709 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2041 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2511 | Val  Acc: 0.9867
 Site-photo                     (2) | Val  Loss: 0.2493 | Val  Acc: 0.9794
 Site-art_painting              (2) | Val  Loss: 0.6509 | Val  Acc: 0.7500
 Site-art_painting              (2) | Val  Loss: 0.6487 | Val  Acc: 0.8667
 Site-art_painting              (2) | Val  Loss: 0.6595 | Val  Acc: 0.9231
 Site-art_painting              (2) | Val  Loss: 0.6622 | Val  Acc: 0.8723
 Site-art_painting              (2) | Val  Loss: 0.5127 | Val  Acc: 0.9176
 Site-cartoon                   (3) | Val  Loss: 0.8203 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 0.7026 | Val  Acc: 0.7792
 Site-sketch                    (1) | Val  Loss: 1.3165 | Val  Acc: 0.5385
Average Valid Accuracy: 0.9035
============ Train epoch 27 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (0) | Train Loss: 0.2579 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3451 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.1889 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2018 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3132 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.2859 | Train Acc: 0.9423
 Site-photo                     (0) | Train Loss: 0.1957 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2793 | Train Acc: 0.9773
 Site-photo                     (0) | Train Loss: 0.2383 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.2542 | Train Acc: 0.9863
 Site-art_painting              (3) | Train Loss: 0.5388 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.7553 | Train Acc: 0.7727
 Site-art_painting              (3) | Train Loss: 0.6907 | Train Acc: 0.7750
 Site-art_painting              (3) | Train Loss: 0.5432 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.6018 | Train Acc: 0.8438
 Site-cartoon                   (2) | Train Loss: 0.9317 | Train Acc: 0.6364
 Site-cartoon                   (2) | Train Loss: 0.7058 | Train Acc: 0.8435
 Site-sketch                    (1) | Train Loss: 1.0183 | Train Acc: 0.7241
Average Train Accuracy: 0.8946
 Site-photo                     (0) | Val  Loss: 0.1749 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3322 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.2804 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1755 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2382 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3268 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2810 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2251 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2346 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2419 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.5871 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.4500 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.5425 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.5923 | Val  Acc: 0.8723
 Site-art_painting              (3) | Val  Loss: 0.5178 | Val  Acc: 0.8941
 Site-cartoon                   (2) | Val  Loss: 0.6659 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.7304 | Val  Acc: 0.8052
 Site-sketch                    (1) | Val  Loss: 1.1798 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9234
 Best site-photo                    (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:27 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:27 | Val Acc: 0.9794
 Best site-art_painting             (3)  | Epoch:27 | Val Acc: 0.8750
 Best site-art_painting             (3)  | Epoch:27 | Val Acc: 0.9333
 Best site-art_painting             (3)  | Epoch:27 | Val Acc: 0.9231
 Best site-art_painting             (3)  | Epoch:27 | Val Acc: 0.8723
 Best site-art_painting             (3)  | Epoch:27 | Val Acc: 0.8941
 Best site-cartoon                  (2)  | Epoch:27 | Val Acc: 0.8571
 Best site-cartoon                  (2)  | Epoch:27 | Val Acc: 0.8052
 Best site-sketch                   (1)  | Epoch:27 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 28 ============
cnt=[1, 10, 2, 5, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (1) | Train Loss: 0.2545 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3447 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.1904 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1879 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3093 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.2621 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 0.2199 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2599 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2182 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.2451 | Train Acc: 0.9521
 Site-art_painting              (3) | Train Loss: 0.4574 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.7543 | Train Acc: 0.7273
 Site-art_painting              (3) | Train Loss: 0.6563 | Train Acc: 0.8250
 Site-art_painting              (3) | Train Loss: 0.5259 | Train Acc: 0.8889
 Site-art_painting              (3) | Train Loss: 0.5108 | Train Acc: 0.9062
 Site-cartoon                   (2) | Train Loss: 0.8394 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 0.6748 | Train Acc: 0.8609
 Site-sketch                    (0) | Train Loss: 0.9715 | Train Acc: 0.7414
Average Train Accuracy: 0.9070
 Site-photo                     (1) | Val  Loss: 0.2824 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.3114 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2934 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1880 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2858 | Val  Acc: 0.9259
 Site-photo                     (1) | Val  Loss: 0.3272 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2639 | Val  Acc: 0.9778
 Site-photo                     (1) | Val  Loss: 0.2167 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2287 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2595 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 0.4339 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.6212 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.6389 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.5773 | Val  Acc: 0.8511
 Site-art_painting              (3) | Val  Loss: 0.4043 | Val  Acc: 0.9529
 Site-cartoon                   (2) | Val  Loss: 0.7030 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 0.7487 | Val  Acc: 0.7922
 Site-sketch                    (0) | Val  Loss: 1.1690 | Val  Acc: 0.6923
Average Valid Accuracy: 0.9143
============ Train epoch 29 ============
cnt=[8, 1, 2, 7, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (3) | Train Loss: 0.2605 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3194 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1777 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1780 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2711 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.2529 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.2869 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2398 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.2242 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.2620 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.5094 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.7278 | Train Acc: 0.7273
 Site-art_painting              (3) | Train Loss: 0.5862 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.4917 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.5445 | Train Acc: 0.8672
 Site-cartoon                   (2) | Train Loss: 0.8042 | Train Acc: 0.6364
 Site-cartoon                   (2) | Train Loss: 0.6417 | Train Acc: 0.8522
 Site-sketch                    (1) | Train Loss: 0.9479 | Train Acc: 0.7414
Average Train Accuracy: 0.9030
 Site-photo                     (3) | Val  Loss: 0.1598 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3187 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2337 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1573 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2097 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3233 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.2744 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1795 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.2352 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.2157 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.5585 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.5451 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.5806 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.5586 | Val  Acc: 0.8723
 Site-art_painting              (3) | Val  Loss: 0.4318 | Val  Acc: 0.9176
 Site-cartoon                   (2) | Val  Loss: 0.7491 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 0.7559 | Val  Acc: 0.7922
 Site-sketch                    (1) | Val  Loss: 1.1185 | Val  Acc: 0.6154
Average Valid Accuracy: 0.9119
============ Train epoch 30 ============
cnt=[11, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (3) | Train Loss: 0.2619 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.3319 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.1629 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1626 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2720 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.2651 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.1622 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.2447 | Train Acc: 0.9773
 Site-photo                     (0) | Train Loss: 0.1955 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.2247 | Train Acc: 0.9863
 Site-art_painting              (0) | Train Loss: 0.4944 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.7164 | Train Acc: 0.7273
 Site-art_painting              (0) | Train Loss: 0.6926 | Train Acc: 0.7750
 Site-art_painting              (0) | Train Loss: 0.5694 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.5175 | Train Acc: 0.8594
 Site-cartoon                   (2) | Train Loss: 0.7959 | Train Acc: 0.5455
 Site-cartoon                   (2) | Train Loss: 0.6264 | Train Acc: 0.8522
 Site-sketch                    (1) | Train Loss: 0.8766 | Train Acc: 0.7759
Average Train Accuracy: 0.8980
 Site-photo                     (3) | Val  Loss: 0.2043 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.2287 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2420 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1805 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2225 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2960 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.2248 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1807 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2173 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2261 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.5456 | Val  Acc: 0.7500
 Site-art_painting              (3) | Val  Loss: 0.6328 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.5744 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.5687 | Val  Acc: 0.8511
 Site-art_painting              (0) | Val  Loss: 0.4219 | Val  Acc: 0.9176
 Site-cartoon                   (2) | Val  Loss: 0.6080 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.6885 | Val  Acc: 0.8182
 Site-sketch                    (1) | Val  Loss: 1.1028 | Val  Acc: 0.6923
Average Valid Accuracy: 0.9148
============ Train epoch 31 ============
cnt=[5, 1, 2, 10, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (3) | Train Loss: 0.1982 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.3186 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.1652 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1525 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1932 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2506 | Train Acc: 0.9615
 Site-photo                     (3) | Train Loss: 0.1674 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2563 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.1838 | Train Acc: 0.9912
 Site-photo                     (3) | Train Loss: 0.2225 | Train Acc: 0.9452
 Site-art_painting              (0) | Train Loss: 0.4135 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.9085 | Train Acc: 0.6818
 Site-art_painting              (0) | Train Loss: 0.5927 | Train Acc: 0.8000
 Site-art_painting              (0) | Train Loss: 0.4591 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.5006 | Train Acc: 0.8672
 Site-cartoon                   (2) | Train Loss: 0.8954 | Train Acc: 0.6364
 Site-cartoon                   (2) | Train Loss: 0.6155 | Train Acc: 0.8348
 Site-sketch                    (1) | Train Loss: 0.8595 | Train Acc: 0.7586
Average Train Accuracy: 0.9024
 Site-photo                     (3) | Val  Loss: 0.1778 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2505 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2500 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1903 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.2022 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2673 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2528 | Val  Acc: 0.9778
 Site-photo                     (3) | Val  Loss: 0.1484 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1932 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1944 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.7041 | Val  Acc: 0.7500
 Site-art_painting              (0) | Val  Loss: 0.4824 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.4922 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.5260 | Val  Acc: 0.8723
 Site-art_painting              (0) | Val  Loss: 0.3845 | Val  Acc: 0.9412
 Site-cartoon                   (2) | Val  Loss: 0.7373 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 0.7417 | Val  Acc: 0.8182
 Site-sketch                    (1) | Val  Loss: 1.0706 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9190
============ Train epoch 32 ============
cnt=[7, 1, 2, 8, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (0) | Train Loss: 0.1965 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.3023 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1537 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1646 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1995 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2527 | Train Acc: 0.9615
 Site-photo                     (3) | Train Loss: 0.1570 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2094 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.1837 | Train Acc: 0.9912
 Site-photo                     (3) | Train Loss: 0.2484 | Train Acc: 0.9589
 Site-art_painting              (0) | Train Loss: 0.4392 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.7627 | Train Acc: 0.7273
 Site-art_painting              (0) | Train Loss: 0.6046 | Train Acc: 0.8250
 Site-art_painting              (0) | Train Loss: 0.4192 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.4564 | Train Acc: 0.9375
 Site-cartoon                   (2) | Train Loss: 0.6646 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 0.6000 | Train Acc: 0.8609
 Site-sketch                    (1) | Train Loss: 0.8129 | Train Acc: 0.7759
Average Train Accuracy: 0.9161
 Site-photo                     (0) | Val  Loss: 0.1536 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2749 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.2030 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1265 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1961 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2787 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.2563 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1653 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1954 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2057 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.4163 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 0.5203 | Val  Acc: 0.8000
 Site-art_painting              (0) | Val  Loss: 0.5030 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.5035 | Val  Acc: 0.8723
 Site-art_painting              (0) | Val  Loss: 0.3543 | Val  Acc: 0.9412
 Site-cartoon                   (2) | Val  Loss: 0.4754 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.6950 | Val  Acc: 0.8052
 Site-sketch                    (1) | Val  Loss: 1.0437 | Val  Acc: 0.6154
Average Valid Accuracy: 0.9152
============ Train epoch 33 ============
cnt=[1, 1, 14, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (2) | Train Loss: 0.1646 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2520 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1587 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1327 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2259 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.2501 | Train Acc: 0.9423
 Site-photo                     (2) | Train Loss: 0.1045 | Train Acc: 0.9853
 Site-photo                     (2) | Train Loss: 0.2042 | Train Acc: 0.9886
 Site-photo                     (2) | Train Loss: 0.1664 | Train Acc: 0.9912
 Site-photo                     (2) | Train Loss: 0.1737 | Train Acc: 0.9658
 Site-art_painting              (2) | Train Loss: 0.4210 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.8194 | Train Acc: 0.6818
 Site-art_painting              (2) | Train Loss: 0.5589 | Train Acc: 0.8750
 Site-art_painting              (2) | Train Loss: 0.5491 | Train Acc: 0.8889
 Site-art_painting              (2) | Train Loss: 0.4462 | Train Acc: 0.9141
 Site-cartoon                   (3) | Train Loss: 0.6672 | Train Acc: 0.6364
 Site-cartoon                   (3) | Train Loss: 0.5615 | Train Acc: 0.8957
 Site-sketch                    (1) | Train Loss: 0.8721 | Train Acc: 0.7414
Average Train Accuracy: 0.9110
 Site-photo                     (2) | Val  Loss: 0.2776 | Val  Acc: 0.8889
 Site-photo                     (2) | Val  Loss: 0.2848 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.2406 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1583 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.1803 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2324 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2130 | Val  Acc: 0.9778
 Site-photo                     (2) | Val  Loss: 0.1537 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.1891 | Val  Acc: 0.9867
 Site-photo                     (2) | Val  Loss: 0.1850 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 0.6059 | Val  Acc: 0.7500
 Site-art_painting              (2) | Val  Loss: 0.4365 | Val  Acc: 0.8667
 Site-art_painting              (2) | Val  Loss: 0.4708 | Val  Acc: 0.9231
 Site-art_painting              (2) | Val  Loss: 0.4463 | Val  Acc: 0.8936
 Site-art_painting              (2) | Val  Loss: 0.4103 | Val  Acc: 0.9059
 Site-cartoon                   (3) | Val  Loss: 0.7002 | Val  Acc: 0.5714
 Site-cartoon                   (3) | Val  Loss: 0.6079 | Val  Acc: 0.8442
 Site-sketch                    (1) | Val  Loss: 1.0270 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8978
============ Train epoch 34 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (0) | Train Loss: 0.1918 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2873 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.1543 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1342 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2612 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.2436 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.0883 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2059 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.1762 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.2344 | Train Acc: 0.9863
 Site-art_painting              (3) | Train Loss: 0.4278 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.7766 | Train Acc: 0.6818
 Site-art_painting              (3) | Train Loss: 0.5908 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.4221 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.4237 | Train Acc: 0.9062
 Site-cartoon                   (2) | Train Loss: 0.8179 | Train Acc: 0.6364
 Site-cartoon                   (2) | Train Loss: 0.5315 | Train Acc: 0.8870
 Site-sketch                    (1) | Train Loss: 0.7381 | Train Acc: 0.7931
Average Train Accuracy: 0.9121
 Site-photo                     (0) | Val  Loss: 0.1880 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.2314 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2324 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1138 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1828 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3014 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.2148 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1596 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1885 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1911 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 0.6968 | Val  Acc: 0.7500
 Site-art_painting              (3) | Val  Loss: 0.4458 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.5008 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.4218 | Val  Acc: 0.9149
 Site-art_painting              (3) | Val  Loss: 0.3675 | Val  Acc: 0.9412
 Site-cartoon                   (2) | Val  Loss: 0.4901 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.6367 | Val  Acc: 0.8182
 Site-sketch                    (1) | Val  Loss: 1.0113 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9204
============ Train epoch 35 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (0) | Train Loss: 0.1950 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2540 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1567 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1447 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2498 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.1966 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.2608 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1848 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.1656 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1687 | Train Acc: 0.9863
 Site-art_painting              (3) | Train Loss: 0.3839 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.7711 | Train Acc: 0.7273
 Site-art_painting              (3) | Train Loss: 0.5608 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.5545 | Train Acc: 0.9444
 Site-art_painting              (3) | Train Loss: 0.4148 | Train Acc: 0.8906
 Site-cartoon                   (2) | Train Loss: 0.7138 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 0.5412 | Train Acc: 0.8522
 Site-sketch                    (1) | Train Loss: 0.7875 | Train Acc: 0.7586
Average Train Accuracy: 0.9198
 Site-photo                     (0) | Val  Loss: 0.1864 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.2103 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1732 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1373 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2002 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.2497 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2232 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.1447 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1650 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1689 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.5009 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.5214 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.4130 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.4520 | Val  Acc: 0.9149
 Site-art_painting              (3) | Val  Loss: 0.3423 | Val  Acc: 0.9529
 Site-cartoon                   (2) | Val  Loss: 0.5520 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.5989 | Val  Acc: 0.8442
 Site-sketch                    (1) | Val  Loss: 1.0182 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9320
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 0.9630
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 0.9778
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 0.9794
 Best site-art_painting             (3)  | Epoch:35 | Val Acc: 0.8750
 Best site-art_painting             (3)  | Epoch:35 | Val Acc: 0.9333
 Best site-art_painting             (3)  | Epoch:35 | Val Acc: 0.9231
 Best site-art_painting             (3)  | Epoch:35 | Val Acc: 0.9149
 Best site-art_painting             (3)  | Epoch:35 | Val Acc: 0.9529
 Best site-cartoon                  (2)  | Epoch:35 | Val Acc: 0.8571
 Best site-cartoon                  (2)  | Epoch:35 | Val Acc: 0.8442
 Best site-sketch                   (1)  | Epoch:35 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 36 ============
cnt=[1, 10, 2, 5, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (1) | Train Loss: 0.1848 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2457 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1528 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1381 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2590 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.2140 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 0.1171 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1980 | Train Acc: 0.9886
 Site-photo                     (1) | Train Loss: 0.1619 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.2320 | Train Acc: 0.9658
 Site-art_painting              (3) | Train Loss: 0.4562 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.7776 | Train Acc: 0.7727
 Site-art_painting              (3) | Train Loss: 0.5220 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.4434 | Train Acc: 0.9306
 Site-art_painting              (3) | Train Loss: 0.3982 | Train Acc: 0.9375
 Site-cartoon                   (2) | Train Loss: 0.7900 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 0.5315 | Train Acc: 0.8783
 Site-sketch                    (0) | Train Loss: 0.6763 | Train Acc: 0.8448
Average Train Accuracy: 0.9309
 Site-photo                     (1) | Val  Loss: 0.1526 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2313 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2232 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1345 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2144 | Val  Acc: 0.9630
 Site-photo                     (1) | Val  Loss: 0.2906 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.2425 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1596 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1641 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.1535 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.7076 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.3771 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.4594 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.4615 | Val  Acc: 0.8936
 Site-art_painting              (3) | Val  Loss: 0.3536 | Val  Acc: 0.9059
 Site-cartoon                   (2) | Val  Loss: 0.3968 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.5669 | Val  Acc: 0.8701
 Site-sketch                    (0) | Val  Loss: 0.9907 | Val  Acc: 0.6923
Average Valid Accuracy: 0.9379
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 0.9630
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 0.9429
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 0.9867
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 0.9794
 Best site-art_painting             (3)  | Epoch:36 | Val Acc: 0.8750
 Best site-art_painting             (3)  | Epoch:36 | Val Acc: 0.9333
 Best site-art_painting             (3)  | Epoch:36 | Val Acc: 0.8846
 Best site-art_painting             (3)  | Epoch:36 | Val Acc: 0.8936
 Best site-art_painting             (3)  | Epoch:36 | Val Acc: 0.9059
 Best site-cartoon                  (2)  | Epoch:36 | Val Acc: 1.0000
 Best site-cartoon                  (2)  | Epoch:36 | Val Acc: 0.8701
 Best site-sketch                   (0)  | Epoch:36 | Val Acc: 0.6923
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 37 ============
cnt=[5, 1, 2, 10, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (3) | Train Loss: 0.1623 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2648 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1387 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1320 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2357 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.2132 | Train Acc: 0.9423
 Site-photo                     (3) | Train Loss: 0.1598 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.1973 | Train Acc: 0.9773
 Site-photo                     (3) | Train Loss: 0.1498 | Train Acc: 0.9823
 Site-photo                     (3) | Train Loss: 0.1632 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.5064 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.7750 | Train Acc: 0.7273
 Site-art_painting              (3) | Train Loss: 0.5819 | Train Acc: 0.8250
 Site-art_painting              (0) | Train Loss: 0.3541 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.3938 | Train Acc: 0.9062
 Site-cartoon                   (2) | Train Loss: 0.6332 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 0.5101 | Train Acc: 0.8957
 Site-sketch                    (1) | Train Loss: 0.7270 | Train Acc: 0.7759
Average Train Accuracy: 0.9127
 Site-photo                     (3) | Val  Loss: 0.1336 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2148 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.1760 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1427 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1543 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2567 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.2243 | Val  Acc: 0.9778
 Site-photo                     (3) | Val  Loss: 0.1665 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1610 | Val  Acc: 0.9867
 Site-photo                     (3) | Val  Loss: 0.1754 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.6161 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 0.4402 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.4378 | Val  Acc: 0.8462
 Site-art_painting              (0) | Val  Loss: 0.4142 | Val  Acc: 0.8723
 Site-art_painting              (0) | Val  Loss: 0.3377 | Val  Acc: 0.9059
 Site-cartoon                   (2) | Val  Loss: 0.4922 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.5558 | Val  Acc: 0.8701
 Site-sketch                    (1) | Val  Loss: 0.9299 | Val  Acc: 0.7692
Average Valid Accuracy: 0.9275
============ Train epoch 38 ============
cnt=[11, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (3) | Train Loss: 0.1625 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2209 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1391 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1225 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1414 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2204 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.1177 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2176 | Train Acc: 0.9773
 Site-photo                     (0) | Train Loss: 0.1515 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1874 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.4070 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.7492 | Train Acc: 0.6818
 Site-art_painting              (0) | Train Loss: 0.5746 | Train Acc: 0.8000
 Site-art_painting              (0) | Train Loss: 0.2981 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.3605 | Train Acc: 0.9453
 Site-cartoon                   (2) | Train Loss: 0.5786 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 0.4570 | Train Acc: 0.9304
 Site-sketch                    (1) | Train Loss: 0.6684 | Train Acc: 0.7586
Average Train Accuracy: 0.9305
 Site-photo                     (3) | Val  Loss: 0.0953 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2162 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1929 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1286 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2235 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.2251 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1774 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.1315 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.1664 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1567 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.4628 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 0.4290 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.4413 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.3971 | Val  Acc: 0.8723
 Site-art_painting              (0) | Val  Loss: 0.2837 | Val  Acc: 0.9647
 Site-cartoon                   (2) | Val  Loss: 0.4562 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.5350 | Val  Acc: 0.9221
 Site-sketch                    (1) | Val  Loss: 0.8737 | Val  Acc: 0.6923
Average Valid Accuracy: 0.9471
 Best site-photo                    (3)  | Epoch:38 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:38 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:38 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:38 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:38 | Val Acc: 0.9630
 Best site-photo                    (0)  | Epoch:38 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:38 | Val Acc: 0.9778
 Best site-photo                    (0)  | Epoch:38 | Val Acc: 0.9828
 Best site-photo                    (0)  | Epoch:38 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:38 | Val Acc: 0.9794
 Best site-art_painting             (3)  | Epoch:38 | Val Acc: 0.8750
 Best site-art_painting             (0)  | Epoch:38 | Val Acc: 0.9333
 Best site-art_painting             (0)  | Epoch:38 | Val Acc: 0.8846
 Best site-art_painting             (0)  | Epoch:38 | Val Acc: 0.8723
 Best site-art_painting             (0)  | Epoch:38 | Val Acc: 0.9647
 Best site-cartoon                  (2)  | Epoch:38 | Val Acc: 1.0000
 Best site-cartoon                  (2)  | Epoch:38 | Val Acc: 0.9221
 Best site-sketch                   (1)  | Epoch:38 | Val Acc: 0.6923
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 39 ============
cnt=[6, 1, 2, 9, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (3) | Train Loss: 0.1959 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2128 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1322 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1297 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2202 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.1913 | Train Acc: 0.9808
 Site-photo                     (3) | Train Loss: 0.0921 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1576 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.1628 | Train Acc: 0.9646
 Site-photo                     (3) | Train Loss: 0.1517 | Train Acc: 0.9863
 Site-art_painting              (0) | Train Loss: 0.5412 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.7196 | Train Acc: 0.7273
 Site-art_painting              (0) | Train Loss: 0.5418 | Train Acc: 0.8250
 Site-art_painting              (0) | Train Loss: 0.3388 | Train Acc: 0.9444
 Site-art_painting              (0) | Train Loss: 0.4073 | Train Acc: 0.8906
 Site-cartoon                   (2) | Train Loss: 0.5168 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 0.4721 | Train Acc: 0.9130
 Site-sketch                    (1) | Train Loss: 0.6673 | Train Acc: 0.8103
Average Train Accuracy: 0.9351
 Site-photo                     (3) | Val  Loss: 0.2279 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.1923 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1633 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1132 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1802 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.2360 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1809 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1226 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1373 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1536 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.6939 | Val  Acc: 0.6250
 Site-art_painting              (0) | Val  Loss: 0.3512 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.4046 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.4374 | Val  Acc: 0.8723
 Site-art_painting              (0) | Val  Loss: 0.3247 | Val  Acc: 0.9412
 Site-cartoon                   (2) | Val  Loss: 0.4782 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 0.5736 | Val  Acc: 0.8571
 Site-sketch                    (1) | Val  Loss: 0.9256 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9098
============ Train epoch 40 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (0) | Train Loss: 0.1422 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2028 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1249 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1490 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2012 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.2026 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.2110 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1675 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1631 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1971 | Train Acc: 0.9795
 Site-art_painting              (3) | Train Loss: 0.3385 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.6080 | Train Acc: 0.7727
 Site-art_painting              (3) | Train Loss: 0.6398 | Train Acc: 0.7750
 Site-art_painting              (3) | Train Loss: 0.3372 | Train Acc: 0.8889
 Site-art_painting              (3) | Train Loss: 0.3694 | Train Acc: 0.9375
 Site-cartoon                   (2) | Train Loss: 0.6396 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 0.4747 | Train Acc: 0.8957
 Site-sketch                    (1) | Train Loss: 0.6731 | Train Acc: 0.8448
Average Train Accuracy: 0.9251
 Site-photo                     (0) | Val  Loss: 0.2489 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.1884 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1459 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1321 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2040 | Val  Acc: 0.9259
 Site-photo                     (0) | Val  Loss: 0.2172 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1772 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.1105 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1580 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1822 | Val  Acc: 0.9588
 Site-art_painting              (3) | Val  Loss: 0.3801 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.5948 | Val  Acc: 0.8000
 Site-art_painting              (3) | Val  Loss: 0.3215 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.4024 | Val  Acc: 0.8723
 Site-art_painting              (3) | Val  Loss: 0.2810 | Val  Acc: 0.9412
 Site-cartoon                   (2) | Val  Loss: 0.3658 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.5755 | Val  Acc: 0.8312
 Site-sketch                    (1) | Val  Loss: 0.9588 | Val  Acc: 0.6923
Average Valid Accuracy: 0.9270
 Test site-photo                     (0)| Epoch:38 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:38 | Test Acc: 0.8794
 Test site-cartoon                   (2)| Epoch:38 | Test Acc: 0.8351
 Test site-sketch                    (1)| Epoch:38 | Test Acc: 0.6544
photo: 0.9896, art_painting: 0.8794, cartoon: 0.8351, sketch: 0.6544, 
Average Test Accuracy(group): 0.8396, Average Test Accuracy(individual): 0.9232,
domain std=0.1208, cluster std=0.1208, individual std=0.0886, 
Average Test Accuracy: 0.8396
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 41 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-photo                     (0) | Train Loss: 0.1386 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1856 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1221 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1433 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.2160 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.1831 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.2053 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2007 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.1391 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.1423 | Train Acc: 0.9863
 Site-art_painting              (3) | Train Loss: 0.4179 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.6284 | Train Acc: 0.7727
 Site-art_painting              (3) | Train Loss: 0.5184 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.4139 | Train Acc: 0.8889
 Site-art_painting              (3) | Train Loss: 0.3817 | Train Acc: 0.8750
 Site-cartoon                   (2) | Train Loss: 0.8247 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 0.4852 | Train Acc: 0.9130
 Site-sketch                    (1) | Train Loss: 0.6126 | Train Acc: 0.8448
Average Train Accuracy: 0.9204
 Site-photo                     (0) | Val  Loss: 0.1564 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.1708 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1286 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0945 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1605 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.2369 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.1733 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1372 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.1639 | Val  Acc: 0.9733
 Site-photo                     (0) | Val  Loss: 0.1369 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.4576 | Val  Acc: 0.7500
 Site-art_painting              (3) | Val  Loss: 0.4186 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.3718 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.3246 | Val  Acc: 0.9149
 Site-art_painting              (3) | Val  Loss: 0.2903 | Val  Acc: 0.9294
 Site-cartoon                   (2) | Val  Loss: 0.4016 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.5608 | Val  Acc: 0.8571
 Site-sketch                    (1) | Val  Loss: 0.8636 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9339
 Test site-photo                     (0)| Epoch:40 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:40 | Test Acc: 0.8831
 Test site-cartoon                   (2)| Epoch:40 | Test Acc: 0.8330
 Test site-sketch                    (1)| Epoch:40 | Test Acc: 0.6468
photo: 0.9896, art_painting: 0.8831, cartoon: 0.8330, sketch: 0.6468, 
Average Test Accuracy(group): 0.8381, Average Test Accuracy(individual): 0.9235,
domain std=0.1241, cluster std=0.1241, individual std=0.0897, 
Average Test Accuracy: 0.8381
============ Train epoch 42 ============
cnt=[4, 1, 2, 11, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-photo                     (0) | Train Loss: 0.1410 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1839 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1418 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1053 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2226 | Train Acc: 0.9750
 Site-photo                     (3) | Train Loss: 0.1866 | Train Acc: 0.9615
 Site-photo                     (3) | Train Loss: 0.1129 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.1788 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.1381 | Train Acc: 0.9735
 Site-photo                     (3) | Train Loss: 0.1856 | Train Acc: 0.9795
 Site-art_painting              (3) | Train Loss: 0.3445 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.6237 | Train Acc: 0.7273
 Site-art_painting              (0) | Train Loss: 0.4946 | Train Acc: 0.8000
 Site-art_painting              (3) | Train Loss: 0.3154 | Train Acc: 0.8611
 Site-art_painting              (3) | Train Loss: 0.3497 | Train Acc: 0.9375
 Site-cartoon                   (2) | Train Loss: 0.4217 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 0.4269 | Train Acc: 0.9217
 Site-sketch                    (1) | Train Loss: 0.5572 | Train Acc: 0.8448
Average Train Accuracy: 0.9323
 Site-photo                     (0) | Val  Loss: 0.0775 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2051 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1614 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0892 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1274 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1964 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1688 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1436 | Val  Acc: 0.9828
 Site-photo                     (3) | Val  Loss: 0.1448 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1356 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 0.3419 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.4113 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.3676 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.4366 | Val  Acc: 0.8936
 Site-art_painting              (3) | Val  Loss: 0.2893 | Val  Acc: 0.9059
 Site-cartoon                   (2) | Val  Loss: 0.3656 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.6045 | Val  Acc: 0.8312
 Site-sketch                    (1) | Val  Loss: 0.8329 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9271
 Test site-photo                     (0)| Epoch:40 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:40 | Test Acc: 0.8831
 Test site-cartoon                   (2)| Epoch:40 | Test Acc: 0.8426
 Test site-sketch                    (1)| Epoch:40 | Test Acc: 0.6531
photo: 0.9896, art_painting: 0.8831, cartoon: 0.8426, sketch: 0.6531, 
Average Test Accuracy(group): 0.8421, Average Test Accuracy(individual): 0.9249,
domain std=0.1216, cluster std=0.1242, individual std=0.0876, 
Average Test Accuracy: 0.8421
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 43 ============
cnt=[2, 10, 1, 5, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-photo                     (1) | Train Loss: 0.1508 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2135 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.1063 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1026 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1427 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1953 | Train Acc: 0.9423
 Site-photo                     (1) | Train Loss: 0.0782 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1493 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1154 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.1277 | Train Acc: 0.9795
 Site-art_painting              (3) | Train Loss: 0.4160 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.7093 | Train Acc: 0.6364
 Site-art_painting              (3) | Train Loss: 0.4961 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.4241 | Train Acc: 0.9306
 Site-art_painting              (3) | Train Loss: 0.3468 | Train Acc: 0.9062
 Site-cartoon                   (0) | Train Loss: 0.6166 | Train Acc: 0.7273
 Site-cartoon                   (0) | Train Loss: 0.4536 | Train Acc: 0.9130
 Site-sketch                    (2) | Train Loss: 0.6089 | Train Acc: 0.7931
Average Train Accuracy: 0.9174
 Site-photo                     (1) | Val  Loss: 0.2418 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.1388 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1185 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.0895 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1312 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1993 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1753 | Val  Acc: 0.9778
 Site-photo                     (1) | Val  Loss: 0.1175 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1322 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1261 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.1359 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.4949 | Val  Acc: 0.8000
 Site-art_painting              (3) | Val  Loss: 0.3364 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.3406 | Val  Acc: 0.9362
 Site-art_painting              (3) | Val  Loss: 0.2626 | Val  Acc: 0.9529
 Site-cartoon                   (0) | Val  Loss: 0.4074 | Val  Acc: 0.8571
 Site-cartoon                   (0) | Val  Loss: 0.5145 | Val  Acc: 0.8831
 Site-sketch                    (2) | Val  Loss: 0.8395 | Val  Acc: 0.7692
Average Valid Accuracy: 0.9427
 Test site-photo                     (1)| Epoch:42 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:42 | Test Acc: 0.8855
 Test site-cartoon                   (0)| Epoch:42 | Test Acc: 0.8489
 Test site-sketch                    (2)| Epoch:42 | Test Acc: 0.6550
photo: 0.9896, art_painting: 0.8855, cartoon: 0.8489, sketch: 0.6550, 
Average Test Accuracy(group): 0.8448, Average Test Accuracy(individual): 0.9264,
domain std=0.1211, cluster std=0.1211, individual std=0.0862, 
Average Test Accuracy: 0.8448
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 44 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-photo                     (3) | Train Loss: 0.1343 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1635 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1001 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0907 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1407 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.1658 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.0798 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1730 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.1168 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.1450 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.3158 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.6887 | Train Acc: 0.7273
 Site-art_painting              (3) | Train Loss: 0.4500 | Train Acc: 0.8500
 Site-art_painting              (0) | Train Loss: 0.4082 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.3927 | Train Acc: 0.8984
 Site-cartoon                   (2) | Train Loss: 0.4771 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 0.3814 | Train Acc: 0.9304
 Site-sketch                    (1) | Train Loss: 0.5269 | Train Acc: 0.8448
Average Train Accuracy: 0.9351
 Site-photo                     (3) | Val  Loss: 0.1090 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1828 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.1249 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.0995 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1191 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2034 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.1769 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.1178 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1172 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1541 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.6831 | Val  Acc: 0.7500
 Site-art_painting              (0) | Val  Loss: 0.5242 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.3760 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.3195 | Val  Acc: 0.8936
 Site-art_painting              (0) | Val  Loss: 0.2707 | Val  Acc: 0.9176
 Site-cartoon                   (2) | Val  Loss: 0.2730 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.5563 | Val  Acc: 0.8571
 Site-sketch                    (1) | Val  Loss: 0.8329 | Val  Acc: 0.6923
Average Valid Accuracy: 0.9296
 Test site-photo                     (3)| Epoch:43 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:43 | Test Acc: 0.8819
 Test site-cartoon                   (2)| Epoch:43 | Test Acc: 0.8532
 Test site-sketch                    (1)| Epoch:43 | Test Acc: 0.6734
photo: 0.9896, art_painting: 0.8819, cartoon: 0.8532, sketch: 0.6734, 
Average Test Accuracy(group): 0.8495, Average Test Accuracy(individual): 0.9269,
domain std=0.1137, cluster std=0.1138, individual std=0.0832, 
Average Test Accuracy: 0.8495
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 45 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-photo                     (0) | Train Loss: 0.1235 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1377 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1116 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1074 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1898 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.1510 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.0759 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1532 | Train Acc: 0.9773
 Site-photo                     (0) | Train Loss: 0.1199 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1572 | Train Acc: 0.9795
 Site-art_painting              (3) | Train Loss: 0.3188 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.7159 | Train Acc: 0.7273
 Site-art_painting              (3) | Train Loss: 0.4733 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.3604 | Train Acc: 0.9028
 Site-art_painting              (3) | Train Loss: 0.3669 | Train Acc: 0.8984
 Site-cartoon                   (2) | Train Loss: 0.4720 | Train Acc: 0.8182
 Site-cartoon                   (2) | Train Loss: 0.4143 | Train Acc: 0.9391
 Site-sketch                    (1) | Train Loss: 0.5612 | Train Acc: 0.8966
Average Train Accuracy: 0.9353
 Site-photo                     (0) | Val  Loss: 0.0692 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1589 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1144 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0945 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1856 | Val  Acc: 0.9259
 Site-photo                     (0) | Val  Loss: 0.1871 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1429 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.1036 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1410 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1265 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 0.5080 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.4459 | Val  Acc: 0.8000
 Site-art_painting              (3) | Val  Loss: 0.3078 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.3170 | Val  Acc: 0.9362
 Site-art_painting              (3) | Val  Loss: 0.2736 | Val  Acc: 0.9529
 Site-cartoon                   (2) | Val  Loss: 0.2762 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.4984 | Val  Acc: 0.8701
 Site-sketch                    (1) | Val  Loss: 0.8911 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9387
 Test site-photo                     (0)| Epoch:44 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:44 | Test Acc: 0.8867
 Test site-cartoon                   (2)| Epoch:44 | Test Acc: 0.8383
 Test site-sketch                    (1)| Epoch:44 | Test Acc: 0.6696
photo: 0.9896, art_painting: 0.8867, cartoon: 0.8383, sketch: 0.6696, 
Average Test Accuracy(group): 0.8461, Average Test Accuracy(individual): 0.9264,
domain std=0.1156, cluster std=0.1156, individual std=0.0847, 
Average Test Accuracy: 0.8461
============ Train epoch 46 ============
cnt=[3, 1, 2, 12, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-photo                     (3) | Train Loss: 0.1081 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1784 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1076 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0986 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1803 | Train Acc: 0.9750
 Site-photo                     (3) | Train Loss: 0.1870 | Train Acc: 0.9615
 Site-photo                     (3) | Train Loss: 0.0975 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.1386 | Train Acc: 0.9659
 Site-photo                     (3) | Train Loss: 0.1154 | Train Acc: 0.9823
 Site-photo                     (3) | Train Loss: 0.1439 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.4148 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.5502 | Train Acc: 0.8182
 Site-art_painting              (3) | Train Loss: 0.4154 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.2926 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.3154 | Train Acc: 0.9297
 Site-cartoon                   (2) | Train Loss: 0.5235 | Train Acc: 0.8182
 Site-cartoon                   (2) | Train Loss: 0.4277 | Train Acc: 0.9043
 Site-sketch                    (1) | Train Loss: 0.5573 | Train Acc: 0.8448
Average Train Accuracy: 0.9338
 Site-photo                     (3) | Val  Loss: 0.1195 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.1231 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1157 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.0781 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1046 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1906 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1324 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.0931 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1151 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1554 | Val  Acc: 0.9588
 Site-art_painting              (3) | Val  Loss: 0.3202 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 0.3750 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.3118 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.3314 | Val  Acc: 0.9362
 Site-art_painting              (0) | Val  Loss: 0.2370 | Val  Acc: 0.9647
 Site-cartoon                   (2) | Val  Loss: 0.2248 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.5392 | Val  Acc: 0.8571
 Site-sketch                    (1) | Val  Loss: 0.8058 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9452
 Test site-photo                     (3)| Epoch:44 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:44 | Test Acc: 0.8904
 Test site-cartoon                   (2)| Epoch:44 | Test Acc: 0.8457
 Test site-sketch                    (1)| Epoch:44 | Test Acc: 0.6665
photo: 0.9896, art_painting: 0.8904, cartoon: 0.8457, sketch: 0.6665, 
Average Test Accuracy(group): 0.8480, Average Test Accuracy(individual): 0.9281,
domain std=0.1170, cluster std=0.1122, individual std=0.0840, 
Average Test Accuracy: 0.8480
============ Train epoch 47 ============
cnt=[4, 1, 2, 11, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-photo                     (3) | Train Loss: 0.1016 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1668 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0985 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0907 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1703 | Train Acc: 0.9750
 Site-photo                     (3) | Train Loss: 0.1692 | Train Acc: 0.9808
 Site-photo                     (3) | Train Loss: 0.0888 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1490 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.1092 | Train Acc: 0.9735
 Site-photo                     (3) | Train Loss: 0.1556 | Train Acc: 0.9658
 Site-art_painting              (3) | Train Loss: 0.3829 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.6259 | Train Acc: 0.8182
 Site-art_painting              (0) | Train Loss: 0.4237 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.4501 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.2840 | Train Acc: 0.9688
 Site-cartoon                   (2) | Train Loss: 0.3647 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 0.3743 | Train Acc: 0.9130
 Site-sketch                    (1) | Train Loss: 0.5246 | Train Acc: 0.8448
Average Train Accuracy: 0.9476
 Site-photo                     (3) | Val  Loss: 0.0658 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2197 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.1315 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1098 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1294 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1641 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1665 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.0999 | Val  Acc: 0.9828
 Site-photo                     (3) | Val  Loss: 0.1233 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1335 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 0.2086 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3522 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.3621 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.3406 | Val  Acc: 0.9149
 Site-art_painting              (0) | Val  Loss: 0.2272 | Val  Acc: 0.9294
 Site-cartoon                   (2) | Val  Loss: 0.3423 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.4624 | Val  Acc: 0.8571
 Site-sketch                    (1) | Val  Loss: 0.8735 | Val  Acc: 0.6923
Average Valid Accuracy: 0.9486
 Best site-photo                    (3)  | Epoch:47 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:47 | Val Acc: 0.9167
 Best site-photo                    (3)  | Epoch:47 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:47 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:47 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:47 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:47 | Val Acc: 0.9556
 Best site-photo                    (3)  | Epoch:47 | Val Acc: 0.9828
 Best site-photo                    (3)  | Epoch:47 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:47 | Val Acc: 0.9691
 Best site-art_painting             (3)  | Epoch:47 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:47 | Val Acc: 0.9333
 Best site-art_painting             (0)  | Epoch:47 | Val Acc: 0.9231
 Best site-art_painting             (0)  | Epoch:47 | Val Acc: 0.9149
 Best site-art_painting             (0)  | Epoch:47 | Val Acc: 0.9294
 Best site-cartoon                  (2)  | Epoch:47 | Val Acc: 1.0000
 Best site-cartoon                  (2)  | Epoch:47 | Val Acc: 0.8571
 Best site-sketch                   (1)  | Epoch:47 | Val Acc: 0.6923
 Test site-photo                     (3)| Epoch:47 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:47 | Test Acc: 0.8879
 Test site-cartoon                   (2)| Epoch:47 | Test Acc: 0.8532
 Test site-sketch                    (1)| Epoch:47 | Test Acc: 0.6766
photo: 0.9896, art_painting: 0.8879, cartoon: 0.8532, sketch: 0.6766, 
Average Test Accuracy(group): 0.8518, Average Test Accuracy(individual): 0.9288,
domain std=0.1129, cluster std=0.1101, individual std=0.0817, 
Average Test Accuracy: 0.8518
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 48 ============
cnt=[12, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-photo                     (0) | Train Loss: 0.1183 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1621 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1103 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1419 | Train Acc: 0.9677
 Site-photo                     (3) | Train Loss: 0.1158 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.1474 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.1400 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1284 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0977 | Train Acc: 0.9912
 Site-photo                     (0) | Train Loss: 0.1838 | Train Acc: 0.9658
 Site-art_painting              (0) | Train Loss: 0.3481 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.4558 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.4401 | Train Acc: 0.8750
 Site-art_painting              (0) | Train Loss: 0.2927 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.2774 | Train Acc: 0.9375
 Site-cartoon                   (2) | Train Loss: 0.9666 | Train Acc: 0.6364
 Site-cartoon                   (2) | Train Loss: 0.3928 | Train Acc: 0.9217
 Site-sketch                    (1) | Train Loss: 0.4941 | Train Acc: 0.8448
Average Train Accuracy: 0.9319
 Site-photo                     (0) | Val  Loss: 0.0602 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1395 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0891 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.0765 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1730 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.1670 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1684 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.0873 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1089 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1351 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.1437 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3751 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.3589 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.3116 | Val  Acc: 0.9362
 Site-art_painting              (0) | Val  Loss: 0.2797 | Val  Acc: 0.9294
 Site-cartoon                   (2) | Val  Loss: 0.2722 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.4212 | Val  Acc: 0.8831
 Site-sketch                    (1) | Val  Loss: 0.8248 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9517
 Best site-photo                    (0)  | Epoch:48 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:48 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:48 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:48 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:48 | Val Acc: 0.9630
 Best site-photo                    (0)  | Epoch:48 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:48 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:48 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:48 | Val Acc: 0.9867
 Best site-photo                    (0)  | Epoch:48 | Val Acc: 0.9691
 Best site-art_painting             (0)  | Epoch:48 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:48 | Val Acc: 0.8667
 Best site-art_painting             (0)  | Epoch:48 | Val Acc: 0.9231
 Best site-art_painting             (0)  | Epoch:48 | Val Acc: 0.9362
 Best site-art_painting             (0)  | Epoch:48 | Val Acc: 0.9294
 Best site-cartoon                  (2)  | Epoch:48 | Val Acc: 1.0000
 Best site-cartoon                  (2)  | Epoch:48 | Val Acc: 0.8831
 Best site-sketch                   (1)  | Epoch:48 | Val Acc: 0.7179
 Test site-photo                     (0)| Epoch:48 | Test Acc: 0.9896
 Test site-art_painting              (0)| Epoch:48 | Test Acc: 0.8831
 Test site-cartoon                   (2)| Epoch:48 | Test Acc: 0.8543
 Test site-sketch                    (1)| Epoch:48 | Test Acc: 0.6919
photo: 0.9896, art_painting: 0.8831, cartoon: 0.8543, sketch: 0.6919, 
Average Test Accuracy(group): 0.8547, Average Test Accuracy(individual): 0.9284,
domain std=0.1067, cluster std=0.1139, individual std=0.0798, 
Average Test Accuracy: 0.8547
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
============ Train epoch 49 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-photo                     (0) | Train Loss: 0.1428 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1367 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0847 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1202 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.1052 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1378 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.0638 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1511 | Train Acc: 0.9773
 Site-photo                     (0) | Train Loss: 0.1172 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1195 | Train Acc: 0.9795
 Site-art_painting              (0) | Train Loss: 0.3098 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.7024 | Train Acc: 0.7273
 Site-art_painting              (3) | Train Loss: 0.4597 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.2595 | Train Acc: 0.9306
 Site-art_painting              (3) | Train Loss: 0.3156 | Train Acc: 0.9297
 Site-cartoon                   (2) | Train Loss: 0.4716 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 0.3725 | Train Acc: 0.9130
 Site-sketch                    (1) | Train Loss: 0.5603 | Train Acc: 0.8448
Average Train Accuracy: 0.9269
 Site-photo                     (0) | Val  Loss: 0.0620 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1382 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1346 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0890 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1228 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1756 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.1516 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.0904 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1108 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1294 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.3891 | Val  Acc: 0.7500
 Site-art_painting              (3) | Val  Loss: 0.2852 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.2874 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.3491 | Val  Acc: 0.8936
 Site-art_painting              (3) | Val  Loss: 0.2436 | Val  Acc: 0.9412
 Site-cartoon                   (2) | Val  Loss: 0.3087 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.5091 | Val  Acc: 0.8831
 Site-sketch                    (1) | Val  Loss: 0.8796 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9407
 Test site-photo                     (0)| Epoch:48 | Test Acc: 0.9896
 Test site-art_painting              (0)| Epoch:48 | Test Acc: 0.8843
 Test site-cartoon                   (2)| Epoch:48 | Test Acc: 0.8489
 Test site-sketch                    (1)| Epoch:48 | Test Acc: 0.7039
photo: 0.9896, art_painting: 0.8843, cartoon: 0.8489, sketch: 0.7039, 
Average Test Accuracy(group): 0.8567, Average Test Accuracy(individual): 0.9288,
domain std=0.1022, cluster std=0.1009, individual std=0.0782, 
Average Test Accuracy: 0.8567
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_0/ccop_q=1...
===2023-08-12 07:10:02===
===2023-08-12 07:10:11===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 4
Loading snapshots...
 Test site-photo                     (0)| Epoch:49 | Test Acc: 0.9896
 Test site-art_painting              (0)| Epoch:49 | Test Acc: 0.8843
 Test site-cartoon                   (2)| Epoch:49 | Test Acc: 0.8489
 Test site-sketch                    (1)| Epoch:49 | Test Acc: 0.7039
photo: 0.9896, art_painting: 0.8843, cartoon: 0.8489, sketch: 0.7039, 
Average Test Accuracy(group): 0.8567, Average Test Accuracy(individual): 0.9288,
domain std=0.1022, cluster std=0.1009, individual std=0.0782, 
