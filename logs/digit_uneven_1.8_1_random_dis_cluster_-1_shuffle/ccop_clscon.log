===2023-06-29 18:00:37===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[10, 6, 3, 2, 1, ]
cnt=[6, 10, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-USPS                      (0) | Train Loss: 1.4603 | Train Acc: 0.8333
 Site-USPS                      (0) | Train Loss: 1.4014 | Train Acc: 0.7500
 Site-USPS                      (0) | Train Loss: 1.5513 | Train Acc: 0.6667
 Site-USPS                      (0) | Train Loss: 1.5652 | Train Acc: 0.6579
 Site-USPS                      (0) | Train Loss: 1.5581 | Train Acc: 0.6429
 Site-USPS                      (0) | Train Loss: 1.4760 | Train Acc: 0.7619
 Site-USPS                      (0) | Train Loss: 1.5160 | Train Acc: 0.7269
 Site-USPS                      (0) | Train Loss: 1.5190 | Train Acc: 0.7286
 Site-USPS                      (0) | Train Loss: 1.5178 | Train Acc: 0.7147
 Site-USPS                      (0) | Train Loss: 1.4807 | Train Acc: 0.7547
 Site-MNIST                     (1) | Train Loss: 1.7485 | Train Acc: 0.5500
 Site-MNIST                     (1) | Train Loss: 1.6407 | Train Acc: 0.6389
 Site-MNIST                     (1) | Train Loss: 2.0132 | Train Acc: 0.5969
 Site-MNIST                     (1) | Train Loss: 1.6684 | Train Acc: 0.5665
 Site-MNIST                     (1) | Train Loss: 1.7533 | Train Acc: 0.5429
 Site-MNIST                     (1) | Train Loss: 1.7518 | Train Acc: 0.5000
 Site-SynthDigits               (2) | Train Loss: 2.1256 | Train Acc: 0.2781
 Site-SynthDigits               (2) | Train Loss: 2.1441 | Train Acc: 0.2051
 Site-SynthDigits               (2) | Train Loss: 2.0921 | Train Acc: 0.2688
 Site-SVHN                      (3) | Train Loss: 2.2079 | Train Acc: 0.2210
 Site-SVHN                      (3) | Train Loss: 2.1806 | Train Acc: 0.2263
 Site-MNIST_M                   (4) | Train Loss: 2.2392 | Train Acc: 0.1809
Average Train Accuracy: 0.5460
 Site-USPS                      (0) | Val  Loss: 2.4285 | Val  Acc: 0.0000
 Site-USPS                      (0) | Val  Loss: 2.0915 | Val  Acc: 0.0000
 Site-USPS                      (0) | Val  Loss: 1.8703 | Val  Acc: 0.2000
 Site-USPS                      (0) | Val  Loss: 1.6060 | Val  Acc: 0.6667
 Site-USPS                      (0) | Val  Loss: 1.6061 | Val  Acc: 0.7647
 Site-USPS                      (0) | Val  Loss: 1.5841 | Val  Acc: 0.7419
 Site-USPS                      (0) | Val  Loss: 1.4938 | Val  Acc: 0.7321
 Site-USPS                      (0) | Val  Loss: 1.4719 | Val  Acc: 0.7647
 Site-USPS                      (0) | Val  Loss: 1.5266 | Val  Acc: 0.7268
 Site-USPS                      (0) | Val  Loss: 1.5262 | Val  Acc: 0.7190
 Site-MNIST                     (1) | Val  Loss: 1.8763 | Val  Acc: 0.3000
 Site-MNIST                     (1) | Val  Loss: 1.7158 | Val  Acc: 0.5000
 Site-MNIST                     (1) | Val  Loss: 1.6745 | Val  Acc: 0.5625
 Site-MNIST                     (1) | Val  Loss: 1.6925 | Val  Acc: 0.5517
 Site-MNIST                     (1) | Val  Loss: 1.6674 | Val  Acc: 0.6095
 Site-MNIST                     (1) | Val  Loss: 1.6497 | Val  Acc: 0.6190
 Site-SynthDigits               (2) | Val  Loss: 2.1463 | Val  Acc: 0.1892
 Site-SynthDigits               (2) | Val  Loss: 2.0653 | Val  Acc: 0.2206
 Site-SynthDigits               (2) | Val  Loss: 2.1399 | Val  Acc: 0.2377
 Site-SVHN                      (3) | Val  Loss: 2.1478 | Val  Acc: 0.3556
 Site-SVHN                      (3) | Val  Loss: 2.1446 | Val  Acc: 0.2716
 Site-MNIST_M                   (4) | Val  Loss: 2.3166 | Val  Acc: 0.1286
Average Valid Accuracy: 0.4483
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.0000
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.0000
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.2000
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.6667
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.7647
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.7419
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.7321
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.7647
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.7268
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.7190
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.3000
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.5000
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.5625
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.5517
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.6095
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.6190
 Best site-SynthDigits              (2)  | Epoch:0 | Val Acc: 0.1892
 Best site-SynthDigits              (2)  | Epoch:0 | Val Acc: 0.2206
 Best site-SynthDigits              (2)  | Epoch:0 | Val Acc: 0.2377
 Best site-SVHN                     (3)  | Epoch:0 | Val Acc: 0.3556
 Best site-SVHN                     (3)  | Epoch:0 | Val Acc: 0.2716
 Best site-MNIST_M                  (4)  | Epoch:0 | Val Acc: 0.1286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 1 ============
cnt=[3, 10, 6, 1, 2, ]
cnt=[6, 1, 3, 3, 9, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-USPS                      (1) | Train Loss: 0.9368 | Train Acc: 0.8333
 Site-USPS                      (1) | Train Loss: 0.8665 | Train Acc: 0.8333
 Site-USPS                      (1) | Train Loss: 1.0766 | Train Acc: 0.7619
 Site-USPS                      (1) | Train Loss: 1.0970 | Train Acc: 0.7895
 Site-USPS                      (1) | Train Loss: 1.0116 | Train Acc: 0.8143
 Site-USPS                      (1) | Train Loss: 0.9942 | Train Acc: 0.8571
 Site-USPS                      (1) | Train Loss: 1.0489 | Train Acc: 0.8194
 Site-USPS                      (1) | Train Loss: 1.0510 | Train Acc: 0.7946
 Site-USPS                      (1) | Train Loss: 1.0446 | Train Acc: 0.8111
 Site-USPS                      (1) | Train Loss: 0.9911 | Train Acc: 0.8460
 Site-MNIST                     (2) | Train Loss: 1.3299 | Train Acc: 0.6750
 Site-MNIST                     (2) | Train Loss: 1.4035 | Train Acc: 0.6667
 Site-MNIST                     (2) | Train Loss: 1.4521 | Train Acc: 0.6977
 Site-MNIST                     (2) | Train Loss: 1.2916 | Train Acc: 0.7296
 Site-MNIST                     (2) | Train Loss: 1.3809 | Train Acc: 0.6762
 Site-MNIST                     (2) | Train Loss: 1.3697 | Train Acc: 0.6561
 Site-SynthDigits               (0) | Train Loss: 1.9963 | Train Acc: 0.3444
 Site-SynthDigits               (0) | Train Loss: 1.9664 | Train Acc: 0.2747
 Site-SynthDigits               (0) | Train Loss: 1.9102 | Train Acc: 0.3360
 Site-SVHN                      (4) | Train Loss: 2.1170 | Train Acc: 0.1989
 Site-SVHN                      (4) | Train Loss: 2.0588 | Train Acc: 0.2844
 Site-MNIST_M                   (3) | Train Loss: 2.1577 | Train Acc: 0.2411
Average Train Accuracy: 0.6337
 Site-USPS                      (1) | Val  Loss: 2.5091 | Val  Acc: 0.0000
 Site-USPS                      (1) | Val  Loss: 1.9317 | Val  Acc: 0.0000
 Site-USPS                      (1) | Val  Loss: 1.6542 | Val  Acc: 0.4000
 Site-USPS                      (1) | Val  Loss: 1.1946 | Val  Acc: 0.7778
 Site-USPS                      (1) | Val  Loss: 1.1311 | Val  Acc: 0.8235
 Site-USPS                      (1) | Val  Loss: 1.0597 | Val  Acc: 0.8065
 Site-USPS                      (1) | Val  Loss: 1.0031 | Val  Acc: 0.7679
 Site-USPS                      (1) | Val  Loss: 0.9963 | Val  Acc: 0.7941
 Site-USPS                      (1) | Val  Loss: 1.0583 | Val  Acc: 0.7705
 Site-USPS                      (1) | Val  Loss: 1.0548 | Val  Acc: 0.7825
 Site-MNIST                     (2) | Val  Loss: 1.4655 | Val  Acc: 0.6000
 Site-MNIST                     (2) | Val  Loss: 1.2887 | Val  Acc: 0.6667
 Site-MNIST                     (2) | Val  Loss: 1.2543 | Val  Acc: 0.7188
 Site-MNIST                     (2) | Val  Loss: 1.3063 | Val  Acc: 0.6552
 Site-MNIST                     (2) | Val  Loss: 1.2776 | Val  Acc: 0.7238
 Site-MNIST                     (2) | Val  Loss: 1.2518 | Val  Acc: 0.7725
 Site-SynthDigits               (0) | Val  Loss: 2.0346 | Val  Acc: 0.3784
 Site-SynthDigits               (0) | Val  Loss: 1.9187 | Val  Acc: 0.3529
 Site-SynthDigits               (0) | Val  Loss: 1.9701 | Val  Acc: 0.3279
 Site-SVHN                      (4) | Val  Loss: 2.0126 | Val  Acc: 0.2667
 Site-SVHN                      (4) | Val  Loss: 2.0056 | Val  Acc: 0.2222
 Site-MNIST_M                   (3) | Val  Loss: 2.2776 | Val  Acc: 0.2286
Average Valid Accuracy: 0.5380
 Best site-USPS                     (1)  | Epoch:1 | Val Acc: 0.0000
 Best site-USPS                     (1)  | Epoch:1 | Val Acc: 0.0000
 Best site-USPS                     (1)  | Epoch:1 | Val Acc: 0.4000
 Best site-USPS                     (1)  | Epoch:1 | Val Acc: 0.7778
 Best site-USPS                     (1)  | Epoch:1 | Val Acc: 0.8235
 Best site-USPS                     (1)  | Epoch:1 | Val Acc: 0.8065
 Best site-USPS                     (1)  | Epoch:1 | Val Acc: 0.7679
 Best site-USPS                     (1)  | Epoch:1 | Val Acc: 0.7941
 Best site-USPS                     (1)  | Epoch:1 | Val Acc: 0.7705
 Best site-USPS                     (1)  | Epoch:1 | Val Acc: 0.7825
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.6000
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.6667
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.7188
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.6552
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.7238
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.7725
 Best site-SynthDigits              (0)  | Epoch:1 | Val Acc: 0.3784
 Best site-SynthDigits              (0)  | Epoch:1 | Val Acc: 0.3529
 Best site-SynthDigits              (0)  | Epoch:1 | Val Acc: 0.3279
 Best site-SVHN                     (4)  | Epoch:1 | Val Acc: 0.2667
 Best site-SVHN                     (4)  | Epoch:1 | Val Acc: 0.2222
 Best site-MNIST_M                  (3)  | Epoch:1 | Val Acc: 0.2286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 10, 6, 1, 3, ]
cnt=[1, 9, 3, 6, 3, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-USPS                      (1) | Train Loss: 0.7501 | Train Acc: 0.8333
 Site-USPS                      (1) | Train Loss: 0.6768 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.8842 | Train Acc: 0.8095
 Site-USPS                      (1) | Train Loss: 0.8964 | Train Acc: 0.8421
 Site-USPS                      (1) | Train Loss: 0.8871 | Train Acc: 0.8714
 Site-USPS                      (1) | Train Loss: 0.8241 | Train Acc: 0.8571
 Site-USPS                      (1) | Train Loss: 0.8701 | Train Acc: 0.8458
 Site-USPS                      (1) | Train Loss: 0.8530 | Train Acc: 0.8313
 Site-USPS                      (1) | Train Loss: 0.8597 | Train Acc: 0.8383
 Site-USPS                      (1) | Train Loss: 0.8146 | Train Acc: 0.8634
 Site-MNIST                     (2) | Train Loss: 1.1258 | Train Acc: 0.7000
 Site-MNIST                     (2) | Train Loss: 1.0649 | Train Acc: 0.7500
 Site-MNIST                     (2) | Train Loss: 1.2543 | Train Acc: 0.7674
 Site-MNIST                     (2) | Train Loss: 1.0696 | Train Acc: 0.7897
 Site-MNIST                     (2) | Train Loss: 1.1807 | Train Acc: 0.7548
 Site-MNIST                     (2) | Train Loss: 1.1585 | Train Acc: 0.7368
 Site-SynthDigits               (4) | Train Loss: 1.8003 | Train Acc: 0.3974
 Site-SynthDigits               (4) | Train Loss: 1.8693 | Train Acc: 0.3260
 Site-SynthDigits               (4) | Train Loss: 1.7866 | Train Acc: 0.3666
 Site-SVHN                      (0) | Train Loss: 2.0900 | Train Acc: 0.2320
 Site-SVHN                      (0) | Train Loss: 2.0756 | Train Acc: 0.2691
 Site-MNIST_M                   (3) | Train Loss: 2.0907 | Train Acc: 0.2766
Average Train Accuracy: 0.6799
 Site-USPS                      (1) | Val  Loss: 2.3758 | Val  Acc: 0.0000
 Site-USPS                      (1) | Val  Loss: 1.7361 | Val  Acc: 0.3333
 Site-USPS                      (1) | Val  Loss: 1.4603 | Val  Acc: 0.4000
 Site-USPS                      (1) | Val  Loss: 0.9531 | Val  Acc: 0.7778
 Site-USPS                      (1) | Val  Loss: 0.8971 | Val  Acc: 0.8235
 Site-USPS                      (1) | Val  Loss: 0.8195 | Val  Acc: 0.8710
 Site-USPS                      (1) | Val  Loss: 0.8041 | Val  Acc: 0.8214
 Site-USPS                      (1) | Val  Loss: 0.8044 | Val  Acc: 0.8235
 Site-USPS                      (1) | Val  Loss: 0.8716 | Val  Acc: 0.8197
 Site-USPS                      (1) | Val  Loss: 0.8680 | Val  Acc: 0.8248
 Site-MNIST                     (2) | Val  Loss: 1.2165 | Val  Acc: 0.7000
 Site-MNIST                     (2) | Val  Loss: 1.0537 | Val  Acc: 0.8333
 Site-MNIST                     (2) | Val  Loss: 1.0467 | Val  Acc: 0.8125
 Site-MNIST                     (2) | Val  Loss: 1.1090 | Val  Acc: 0.7586
 Site-MNIST                     (2) | Val  Loss: 1.0727 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 1.0485 | Val  Acc: 0.8307
 Site-SynthDigits               (4) | Val  Loss: 1.9179 | Val  Acc: 0.4054
 Site-SynthDigits               (4) | Val  Loss: 1.8414 | Val  Acc: 0.3676
 Site-SynthDigits               (4) | Val  Loss: 1.8447 | Val  Acc: 0.3525
 Site-SVHN                      (0) | Val  Loss: 2.0164 | Val  Acc: 0.3333
 Site-SVHN                      (0) | Val  Loss: 1.9905 | Val  Acc: 0.2840
 Site-MNIST_M                   (3) | Val  Loss: 2.2444 | Val  Acc: 0.2571
Average Valid Accuracy: 0.6014
 Best site-USPS                     (1)  | Epoch:2 | Val Acc: 0.0000
 Best site-USPS                     (1)  | Epoch:2 | Val Acc: 0.3333
 Best site-USPS                     (1)  | Epoch:2 | Val Acc: 0.4000
 Best site-USPS                     (1)  | Epoch:2 | Val Acc: 0.7778
 Best site-USPS                     (1)  | Epoch:2 | Val Acc: 0.8235
 Best site-USPS                     (1)  | Epoch:2 | Val Acc: 0.8710
 Best site-USPS                     (1)  | Epoch:2 | Val Acc: 0.8214
 Best site-USPS                     (1)  | Epoch:2 | Val Acc: 0.8235
 Best site-USPS                     (1)  | Epoch:2 | Val Acc: 0.8197
 Best site-USPS                     (1)  | Epoch:2 | Val Acc: 0.8248
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.7000
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.8333
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.8125
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.7586
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.8307
 Best site-SynthDigits              (4)  | Epoch:2 | Val Acc: 0.4054
 Best site-SynthDigits              (4)  | Epoch:2 | Val Acc: 0.3676
 Best site-SynthDigits              (4)  | Epoch:2 | Val Acc: 0.3525
 Best site-SVHN                     (0)  | Epoch:2 | Val Acc: 0.3333
 Best site-SVHN                     (0)  | Epoch:2 | Val Acc: 0.2840
 Best site-MNIST_M                  (3)  | Epoch:2 | Val Acc: 0.2571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 3 ============
cnt=[10, 3, 1, 6, 2, ]
cnt=[2, 10, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-USPS                      (0) | Train Loss: 0.6559 | Train Acc: 0.8333
 Site-USPS                      (0) | Train Loss: 0.5887 | Train Acc: 0.9167
 Site-USPS                      (0) | Train Loss: 0.7932 | Train Acc: 0.7619
 Site-USPS                      (0) | Train Loss: 0.8034 | Train Acc: 0.8684
 Site-USPS                      (0) | Train Loss: 0.6384 | Train Acc: 0.8714
 Site-USPS                      (0) | Train Loss: 0.7322 | Train Acc: 0.8810
 Site-USPS                      (0) | Train Loss: 0.7768 | Train Acc: 0.8546
 Site-USPS                      (0) | Train Loss: 0.7821 | Train Acc: 0.8386
 Site-USPS                      (0) | Train Loss: 0.7786 | Train Acc: 0.8370
 Site-USPS                      (0) | Train Loss: 0.7226 | Train Acc: 0.8740
 Site-MNIST                     (3) | Train Loss: 0.9994 | Train Acc: 0.7500
 Site-MNIST                     (3) | Train Loss: 0.9198 | Train Acc: 0.7778
 Site-MNIST                     (3) | Train Loss: 0.8714 | Train Acc: 0.7829
 Site-MNIST                     (3) | Train Loss: 0.9549 | Train Acc: 0.8069
 Site-MNIST                     (3) | Train Loss: 1.0681 | Train Acc: 0.7738
 Site-MNIST                     (3) | Train Loss: 1.0427 | Train Acc: 0.7474
 Site-SynthDigits               (1) | Train Loss: 1.6983 | Train Acc: 0.4106
 Site-SynthDigits               (1) | Train Loss: 1.7306 | Train Acc: 0.3590
 Site-SynthDigits               (1) | Train Loss: 1.6514 | Train Acc: 0.4358
 Site-SVHN                      (4) | Train Loss: 2.0181 | Train Acc: 0.2597
 Site-SVHN                      (4) | Train Loss: 1.9963 | Train Acc: 0.3364
 Site-MNIST_M                   (2) | Train Loss: 1.9992 | Train Acc: 0.3085
Average Train Accuracy: 0.6948
 Site-USPS                      (0) | Val  Loss: 2.2693 | Val  Acc: 0.0000
 Site-USPS                      (0) | Val  Loss: 1.6191 | Val  Acc: 0.3333
 Site-USPS                      (0) | Val  Loss: 1.3786 | Val  Acc: 0.4000
 Site-USPS                      (0) | Val  Loss: 0.8603 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.8013 | Val  Acc: 0.8235
 Site-USPS                      (0) | Val  Loss: 0.7140 | Val  Acc: 0.8710
 Site-USPS                      (0) | Val  Loss: 0.7098 | Val  Acc: 0.8214
 Site-USPS                      (0) | Val  Loss: 0.7149 | Val  Acc: 0.8235
 Site-USPS                      (0) | Val  Loss: 0.7819 | Val  Acc: 0.8361
 Site-USPS                      (0) | Val  Loss: 0.7808 | Val  Acc: 0.8369
 Site-MNIST                     (3) | Val  Loss: 1.1031 | Val  Acc: 0.7000
 Site-MNIST                     (3) | Val  Loss: 0.9498 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.9221 | Val  Acc: 0.8438
 Site-MNIST                     (3) | Val  Loss: 0.9855 | Val  Acc: 0.7759
 Site-MNIST                     (3) | Val  Loss: 0.9462 | Val  Acc: 0.8286
 Site-MNIST                     (3) | Val  Loss: 0.9326 | Val  Acc: 0.8201
 Site-SynthDigits               (1) | Val  Loss: 1.8006 | Val  Acc: 0.4054
 Site-SynthDigits               (1) | Val  Loss: 1.6905 | Val  Acc: 0.4265
 Site-SynthDigits               (1) | Val  Loss: 1.7274 | Val  Acc: 0.4098
 Site-SVHN                      (4) | Val  Loss: 1.9378 | Val  Acc: 0.3111
 Site-SVHN                      (4) | Val  Loss: 1.9117 | Val  Acc: 0.3086
 Site-MNIST_M                   (2) | Val  Loss: 2.1679 | Val  Acc: 0.2571
Average Valid Accuracy: 0.6086
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.0000
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.3333
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.4000
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8235
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8710
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8214
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8235
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8361
 Best site-USPS                     (0)  | Epoch:3 | Val Acc: 0.8369
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.7000
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8438
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.7759
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8286
 Best site-MNIST                    (3)  | Epoch:3 | Val Acc: 0.8201
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.4054
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.4265
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.4098
 Best site-SVHN                     (4)  | Epoch:3 | Val Acc: 0.3111
 Best site-SVHN                     (4)  | Epoch:3 | Val Acc: 0.3086
 Best site-MNIST_M                  (2)  | Epoch:3 | Val Acc: 0.2571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 4 ============
cnt=[3, 10, 1, 6, 2, ]
cnt=[3, 9, 3, 1, 6, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-USPS                      (1) | Train Loss: 0.5812 | Train Acc: 0.8333
 Site-USPS                      (1) | Train Loss: 0.4953 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.7022 | Train Acc: 0.8571
 Site-USPS                      (1) | Train Loss: 0.7242 | Train Acc: 0.8684
 Site-USPS                      (1) | Train Loss: 0.7172 | Train Acc: 0.9143
 Site-USPS                      (1) | Train Loss: 0.6525 | Train Acc: 0.9048
 Site-USPS                      (1) | Train Loss: 0.6982 | Train Acc: 0.8811
 Site-USPS                      (1) | Train Loss: 0.6966 | Train Acc: 0.8606
 Site-USPS                      (1) | Train Loss: 0.6938 | Train Acc: 0.8519
 Site-USPS                      (1) | Train Loss: 0.6478 | Train Acc: 0.8891
 Site-MNIST                     (3) | Train Loss: 0.9212 | Train Acc: 0.8000
 Site-MNIST                     (3) | Train Loss: 0.8339 | Train Acc: 0.8056
 Site-MNIST                     (3) | Train Loss: 0.8287 | Train Acc: 0.7984
 Site-MNIST                     (3) | Train Loss: 0.8767 | Train Acc: 0.8155
 Site-MNIST                     (3) | Train Loss: 0.9791 | Train Acc: 0.7905
 Site-MNIST                     (3) | Train Loss: 0.9544 | Train Acc: 0.7831
 Site-SynthDigits               (0) | Train Loss: 1.6462 | Train Acc: 0.4570
 Site-SynthDigits               (0) | Train Loss: 1.6253 | Train Acc: 0.4139
 Site-SynthDigits               (0) | Train Loss: 1.5237 | Train Acc: 0.4949
 Site-SVHN                      (4) | Train Loss: 1.9712 | Train Acc: 0.3039
 Site-SVHN                      (4) | Train Loss: 1.9267 | Train Acc: 0.3609
 Site-MNIST_M                   (2) | Train Loss: 1.9730 | Train Acc: 0.3227
Average Train Accuracy: 0.7276
 Site-USPS                      (1) | Val  Loss: 2.1051 | Val  Acc: 0.0000
 Site-USPS                      (1) | Val  Loss: 1.4782 | Val  Acc: 0.6667
 Site-USPS                      (1) | Val  Loss: 1.2867 | Val  Acc: 0.4000
 Site-USPS                      (1) | Val  Loss: 0.7843 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.7143 | Val  Acc: 0.8824
 Site-USPS                      (1) | Val  Loss: 0.6358 | Val  Acc: 0.9032
 Site-USPS                      (1) | Val  Loss: 0.6394 | Val  Acc: 0.8393
 Site-USPS                      (1) | Val  Loss: 0.6498 | Val  Acc: 0.8333
 Site-USPS                      (1) | Val  Loss: 0.7110 | Val  Acc: 0.8415
 Site-USPS                      (1) | Val  Loss: 0.7117 | Val  Acc: 0.8550
 Site-MNIST                     (3) | Val  Loss: 1.0378 | Val  Acc: 0.7000
 Site-MNIST                     (3) | Val  Loss: 0.8721 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.8445 | Val  Acc: 0.8125
 Site-MNIST                     (3) | Val  Loss: 0.9145 | Val  Acc: 0.7931
 Site-MNIST                     (3) | Val  Loss: 0.8692 | Val  Acc: 0.8286
 Site-MNIST                     (3) | Val  Loss: 0.8588 | Val  Acc: 0.8360
 Site-SynthDigits               (0) | Val  Loss: 1.6817 | Val  Acc: 0.4865
 Site-SynthDigits               (0) | Val  Loss: 1.5563 | Val  Acc: 0.4853
 Site-SynthDigits               (0) | Val  Loss: 1.6175 | Val  Acc: 0.4262
 Site-SVHN                      (4) | Val  Loss: 1.8817 | Val  Acc: 0.4222
 Site-SVHN                      (4) | Val  Loss: 1.8479 | Val  Acc: 0.3333
 Site-MNIST_M                   (2) | Val  Loss: 2.1192 | Val  Acc: 0.2714
Average Valid Accuracy: 0.6492
 Best site-USPS                     (1)  | Epoch:4 | Val Acc: 0.0000
 Best site-USPS                     (1)  | Epoch:4 | Val Acc: 0.6667
 Best site-USPS                     (1)  | Epoch:4 | Val Acc: 0.4000
 Best site-USPS                     (1)  | Epoch:4 | Val Acc: 0.8889
 Best site-USPS                     (1)  | Epoch:4 | Val Acc: 0.8824
 Best site-USPS                     (1)  | Epoch:4 | Val Acc: 0.9032
 Best site-USPS                     (1)  | Epoch:4 | Val Acc: 0.8393
 Best site-USPS                     (1)  | Epoch:4 | Val Acc: 0.8333
 Best site-USPS                     (1)  | Epoch:4 | Val Acc: 0.8415
 Best site-USPS                     (1)  | Epoch:4 | Val Acc: 0.8550
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.7000
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8125
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.7931
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8286
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8360
 Best site-SynthDigits              (0)  | Epoch:4 | Val Acc: 0.4865
 Best site-SynthDigits              (0)  | Epoch:4 | Val Acc: 0.4853
 Best site-SynthDigits              (0)  | Epoch:4 | Val Acc: 0.4262
 Best site-SVHN                     (4)  | Epoch:4 | Val Acc: 0.4222
 Best site-SVHN                     (4)  | Epoch:4 | Val Acc: 0.3333
 Best site-MNIST_M                  (2)  | Epoch:4 | Val Acc: 0.2714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 5 ============
cnt=[10, 3, 1, 6, 2, ]
cnt=[1, 6, 9, 3, 3, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-USPS                      (0) | Train Loss: 0.5579 | Train Acc: 0.8333
 Site-USPS                      (0) | Train Loss: 0.4585 | Train Acc: 0.9167
 Site-USPS                      (0) | Train Loss: 0.6376 | Train Acc: 0.8571
 Site-USPS                      (0) | Train Loss: 0.6474 | Train Acc: 0.8947
 Site-USPS                      (0) | Train Loss: 0.5291 | Train Acc: 0.9143
 Site-USPS                      (0) | Train Loss: 0.6043 | Train Acc: 0.8889
 Site-USPS                      (0) | Train Loss: 0.6488 | Train Acc: 0.8811
 Site-USPS                      (0) | Train Loss: 0.6529 | Train Acc: 0.8802
 Site-USPS                      (0) | Train Loss: 0.6424 | Train Acc: 0.8614
 Site-USPS                      (0) | Train Loss: 0.5960 | Train Acc: 0.8891
 Site-MNIST                     (3) | Train Loss: 0.8397 | Train Acc: 0.8000
 Site-MNIST                     (3) | Train Loss: 0.6885 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 1.0224 | Train Acc: 0.7907
 Site-MNIST                     (3) | Train Loss: 0.7963 | Train Acc: 0.8369
 Site-MNIST                     (3) | Train Loss: 0.8945 | Train Acc: 0.8048
 Site-MNIST                     (3) | Train Loss: 0.8774 | Train Acc: 0.8029
 Site-SynthDigits               (1) | Train Loss: 1.6128 | Train Acc: 0.4636
 Site-SynthDigits               (1) | Train Loss: 1.5741 | Train Acc: 0.4689
 Site-SynthDigits               (1) | Train Loss: 1.4500 | Train Acc: 0.5173
 Site-SVHN                      (4) | Train Loss: 1.9230 | Train Acc: 0.3315
 Site-SVHN                      (4) | Train Loss: 1.9241 | Train Acc: 0.3670
 Site-MNIST_M                   (2) | Train Loss: 1.8857 | Train Acc: 0.3475
Average Train Accuracy: 0.7355
 Site-USPS                      (0) | Val  Loss: 1.7021 | Val  Acc: 0.0000
 Site-USPS                      (0) | Val  Loss: 1.1943 | Val  Acc: 0.6667
 Site-USPS                      (0) | Val  Loss: 1.1256 | Val  Acc: 0.6000
 Site-USPS                      (0) | Val  Loss: 0.6907 | Val  Acc: 0.8889
 Site-USPS                      (0) | Val  Loss: 0.6428 | Val  Acc: 0.8824
 Site-USPS                      (0) | Val  Loss: 0.5647 | Val  Acc: 0.8710
 Site-USPS                      (0) | Val  Loss: 0.5857 | Val  Acc: 0.8214
 Site-USPS                      (0) | Val  Loss: 0.5864 | Val  Acc: 0.8529
 Site-USPS                      (0) | Val  Loss: 0.6409 | Val  Acc: 0.8743
 Site-USPS                      (0) | Val  Loss: 0.6456 | Val  Acc: 0.8792
 Site-MNIST                     (3) | Val  Loss: 0.9695 | Val  Acc: 0.7000
 Site-MNIST                     (3) | Val  Loss: 0.7987 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.7661 | Val  Acc: 0.8438
 Site-MNIST                     (3) | Val  Loss: 0.8373 | Val  Acc: 0.8103
 Site-MNIST                     (3) | Val  Loss: 0.7980 | Val  Acc: 0.8667
 Site-MNIST                     (3) | Val  Loss: 0.7911 | Val  Acc: 0.8571
 Site-SynthDigits               (1) | Val  Loss: 1.5974 | Val  Acc: 0.5405
 Site-SynthDigits               (1) | Val  Loss: 1.4672 | Val  Acc: 0.5147
 Site-SynthDigits               (1) | Val  Loss: 1.5356 | Val  Acc: 0.4836
 Site-SVHN                      (4) | Val  Loss: 1.8272 | Val  Acc: 0.4000
 Site-SVHN                      (4) | Val  Loss: 1.8079 | Val  Acc: 0.3827
 Site-MNIST_M                   (2) | Val  Loss: 2.0621 | Val  Acc: 0.3571
Average Valid Accuracy: 0.6760
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.0000
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.6667
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.6000
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8889
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8824
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8710
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8214
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8529
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8743
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8792
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.7000
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.8438
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.8103
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.8667
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.8571
 Best site-SynthDigits              (1)  | Epoch:5 | Val Acc: 0.5405
 Best site-SynthDigits              (1)  | Epoch:5 | Val Acc: 0.5147
 Best site-SynthDigits              (1)  | Epoch:5 | Val Acc: 0.4836
 Best site-SVHN                     (4)  | Epoch:5 | Val Acc: 0.4000
 Best site-SVHN                     (4)  | Epoch:5 | Val Acc: 0.3827
 Best site-MNIST_M                  (2)  | Epoch:5 | Val Acc: 0.3571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 10, 6, 1, 3, ]
cnt=[3, 1, 6, 3, 9, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-USPS                      (1) | Train Loss: 0.5209 | Train Acc: 0.8333
 Site-USPS                      (1) | Train Loss: 0.4054 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.5842 | Train Acc: 0.8571
 Site-USPS                      (1) | Train Loss: 0.6046 | Train Acc: 0.9211
 Site-USPS                      (1) | Train Loss: 0.3757 | Train Acc: 0.9143
 Site-USPS                      (1) | Train Loss: 0.5638 | Train Acc: 0.9127
 Site-USPS                      (1) | Train Loss: 0.6382 | Train Acc: 0.8811
 Site-USPS                      (1) | Train Loss: 0.5931 | Train Acc: 0.8802
 Site-USPS                      (1) | Train Loss: 0.6052 | Train Acc: 0.8709
 Site-USPS                      (1) | Train Loss: 0.5603 | Train Acc: 0.8966
 Site-MNIST                     (2) | Train Loss: 0.8049 | Train Acc: 0.8250
 Site-MNIST                     (2) | Train Loss: 0.8064 | Train Acc: 0.8194
 Site-MNIST                     (2) | Train Loss: 0.9204 | Train Acc: 0.7984
 Site-MNIST                     (2) | Train Loss: 0.7763 | Train Acc: 0.8455
 Site-MNIST                     (2) | Train Loss: 0.8598 | Train Acc: 0.8071
 Site-MNIST                     (2) | Train Loss: 0.8319 | Train Acc: 0.8082
 Site-SynthDigits               (4) | Train Loss: 1.4587 | Train Acc: 0.5298
 Site-SynthDigits               (4) | Train Loss: 1.4246 | Train Acc: 0.5311
 Site-SynthDigits               (4) | Train Loss: 1.3495 | Train Acc: 0.5764
 Site-SVHN                      (0) | Train Loss: 1.8532 | Train Acc: 0.3536
 Site-SVHN                      (0) | Train Loss: 1.7608 | Train Acc: 0.4098
 Site-MNIST_M                   (3) | Train Loss: 1.8634 | Train Acc: 0.3723
Average Train Accuracy: 0.7565
 Site-USPS                      (1) | Val  Loss: 1.6048 | Val  Acc: 0.0000
 Site-USPS                      (1) | Val  Loss: 1.1378 | Val  Acc: 0.6667
 Site-USPS                      (1) | Val  Loss: 1.0710 | Val  Acc: 0.6000
 Site-USPS                      (1) | Val  Loss: 0.6549 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.5896 | Val  Acc: 0.8824
 Site-USPS                      (1) | Val  Loss: 0.5192 | Val  Acc: 0.9355
 Site-USPS                      (1) | Val  Loss: 0.5462 | Val  Acc: 0.8393
 Site-USPS                      (1) | Val  Loss: 0.5607 | Val  Acc: 0.8529
 Site-USPS                      (1) | Val  Loss: 0.6089 | Val  Acc: 0.8634
 Site-USPS                      (1) | Val  Loss: 0.6122 | Val  Acc: 0.8701
 Site-MNIST                     (2) | Val  Loss: 0.9358 | Val  Acc: 0.7000
 Site-MNIST                     (2) | Val  Loss: 0.7702 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.7412 | Val  Acc: 0.8438
 Site-MNIST                     (2) | Val  Loss: 0.8056 | Val  Acc: 0.8103
 Site-MNIST                     (2) | Val  Loss: 0.7621 | Val  Acc: 0.8571
 Site-MNIST                     (2) | Val  Loss: 0.7561 | Val  Acc: 0.8519
 Site-SynthDigits               (4) | Val  Loss: 1.5070 | Val  Acc: 0.5676
 Site-SynthDigits               (4) | Val  Loss: 1.3579 | Val  Acc: 0.5588
 Site-SynthDigits               (4) | Val  Loss: 1.4298 | Val  Acc: 0.5164
 Site-SVHN                      (0) | Val  Loss: 1.7574 | Val  Acc: 0.3778
 Site-SVHN                      (0) | Val  Loss: 1.7219 | Val  Acc: 0.4198
 Site-MNIST_M                   (3) | Val  Loss: 2.0189 | Val  Acc: 0.3571
Average Valid Accuracy: 0.6835
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.0000
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.6667
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.6000
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8889
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8824
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.9355
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8393
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8529
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8634
 Best site-USPS                     (1)  | Epoch:6 | Val Acc: 0.8701
 Best site-MNIST                    (2)  | Epoch:6 | Val Acc: 0.7000
 Best site-MNIST                    (2)  | Epoch:6 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:6 | Val Acc: 0.8438
 Best site-MNIST                    (2)  | Epoch:6 | Val Acc: 0.8103
 Best site-MNIST                    (2)  | Epoch:6 | Val Acc: 0.8571
 Best site-MNIST                    (2)  | Epoch:6 | Val Acc: 0.8519
 Best site-SynthDigits              (4)  | Epoch:6 | Val Acc: 0.5676
 Best site-SynthDigits              (4)  | Epoch:6 | Val Acc: 0.5588
 Best site-SynthDigits              (4)  | Epoch:6 | Val Acc: 0.5164
 Best site-SVHN                     (0)  | Epoch:6 | Val Acc: 0.3778
 Best site-SVHN                     (0)  | Epoch:6 | Val Acc: 0.4198
 Best site-MNIST_M                  (3)  | Epoch:6 | Val Acc: 0.3571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 7 ============
cnt=[10, 6, 2, 1, 3, ]
cnt=[3, 10, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-USPS                      (0) | Train Loss: 0.5099 | Train Acc: 0.8333
 Site-USPS                      (0) | Train Loss: 0.3914 | Train Acc: 0.9167
 Site-USPS                      (0) | Train Loss: 0.5483 | Train Acc: 0.8571
 Site-USPS                      (0) | Train Loss: 0.5641 | Train Acc: 0.9211
 Site-USPS                      (0) | Train Loss: 0.3962 | Train Acc: 0.9143
 Site-USPS                      (0) | Train Loss: 0.5348 | Train Acc: 0.9127
 Site-USPS                      (0) | Train Loss: 0.5843 | Train Acc: 0.8987
 Site-USPS                      (0) | Train Loss: 0.5589 | Train Acc: 0.8826
 Site-USPS                      (0) | Train Loss: 0.5701 | Train Acc: 0.8777
 Site-USPS                      (0) | Train Loss: 0.5258 | Train Acc: 0.9004
 Site-MNIST                     (1) | Train Loss: 0.7320 | Train Acc: 0.8750
 Site-MNIST                     (1) | Train Loss: 0.7024 | Train Acc: 0.8472
 Site-MNIST                     (1) | Train Loss: 0.7745 | Train Acc: 0.8217
 Site-MNIST                     (1) | Train Loss: 0.6969 | Train Acc: 0.8498
 Site-MNIST                     (1) | Train Loss: 0.7928 | Train Acc: 0.8167
 Site-MNIST                     (1) | Train Loss: 0.7664 | Train Acc: 0.8307
 Site-SynthDigits               (4) | Train Loss: 1.3647 | Train Acc: 0.5497
 Site-SynthDigits               (4) | Train Loss: 1.3874 | Train Acc: 0.5311
 Site-SynthDigits               (4) | Train Loss: 1.2731 | Train Acc: 0.6029
 Site-SVHN                      (2) | Train Loss: 1.8040 | Train Acc: 0.3923
 Site-SVHN                      (2) | Train Loss: 1.7859 | Train Acc: 0.4159
 Site-MNIST_M                   (3) | Train Loss: 1.7721 | Train Acc: 0.3830
Average Train Accuracy: 0.7650
 Site-USPS                      (0) | Val  Loss: 1.3664 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 1.0076 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.9919 | Val  Acc: 0.8000
 Site-USPS                      (0) | Val  Loss: 0.6173 | Val  Acc: 0.8889
 Site-USPS                      (0) | Val  Loss: 0.5508 | Val  Acc: 0.8824
 Site-USPS                      (0) | Val  Loss: 0.4760 | Val  Acc: 0.9355
 Site-USPS                      (0) | Val  Loss: 0.5130 | Val  Acc: 0.8571
 Site-USPS                      (0) | Val  Loss: 0.5268 | Val  Acc: 0.8627
 Site-USPS                      (0) | Val  Loss: 0.5700 | Val  Acc: 0.8634
 Site-USPS                      (0) | Val  Loss: 0.5751 | Val  Acc: 0.8731
 Site-MNIST                     (1) | Val  Loss: 0.8688 | Val  Acc: 0.7000
 Site-MNIST                     (1) | Val  Loss: 0.7105 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.6792 | Val  Acc: 0.8438
 Site-MNIST                     (1) | Val  Loss: 0.7427 | Val  Acc: 0.8276
 Site-MNIST                     (1) | Val  Loss: 0.7031 | Val  Acc: 0.8571
 Site-MNIST                     (1) | Val  Loss: 0.6944 | Val  Acc: 0.8571
 Site-SynthDigits               (4) | Val  Loss: 1.4472 | Val  Acc: 0.6216
 Site-SynthDigits               (4) | Val  Loss: 1.2845 | Val  Acc: 0.6176
 Site-SynthDigits               (4) | Val  Loss: 1.3584 | Val  Acc: 0.5656
 Site-SVHN                      (2) | Val  Loss: 1.6945 | Val  Acc: 0.4222
 Site-SVHN                      (2) | Val  Loss: 1.6743 | Val  Acc: 0.4444
 Site-MNIST_M                   (3) | Val  Loss: 1.9539 | Val  Acc: 0.4000
Average Valid Accuracy: 0.7681
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.8000
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.8889
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.8824
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.9355
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.8571
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.8627
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.8634
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.8731
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.7000
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.8438
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.8276
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.8571
 Best site-MNIST                    (1)  | Epoch:7 | Val Acc: 0.8571
 Best site-SynthDigits              (4)  | Epoch:7 | Val Acc: 0.6216
 Best site-SynthDigits              (4)  | Epoch:7 | Val Acc: 0.6176
 Best site-SynthDigits              (4)  | Epoch:7 | Val Acc: 0.5656
 Best site-SVHN                     (2)  | Epoch:7 | Val Acc: 0.4222
 Best site-SVHN                     (2)  | Epoch:7 | Val Acc: 0.4444
 Best site-MNIST_M                  (3)  | Epoch:7 | Val Acc: 0.4000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 10, 3, 6, 2, ]
cnt=[3, 6, 10, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-USPS                      (1) | Train Loss: 0.4886 | Train Acc: 0.8333
 Site-USPS                      (1) | Train Loss: 0.3661 | Train Acc: 0.9167
 Site-USPS                      (1) | Train Loss: 0.5152 | Train Acc: 0.8571
 Site-USPS                      (1) | Train Loss: 0.5357 | Train Acc: 0.9211
 Site-USPS                      (1) | Train Loss: 0.6000 | Train Acc: 0.9286
 Site-USPS                      (1) | Train Loss: 0.5136 | Train Acc: 0.9048
 Site-USPS                      (1) | Train Loss: 0.5618 | Train Acc: 0.8899
 Site-USPS                      (1) | Train Loss: 0.5201 | Train Acc: 0.8900
 Site-USPS                      (1) | Train Loss: 0.5412 | Train Acc: 0.8804
 Site-USPS                      (1) | Train Loss: 0.5049 | Train Acc: 0.9011
 Site-MNIST                     (3) | Train Loss: 0.7068 | Train Acc: 0.9000
 Site-MNIST                     (3) | Train Loss: 0.7693 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.5866 | Train Acc: 0.7984
 Site-MNIST                     (3) | Train Loss: 0.6792 | Train Acc: 0.8498
 Site-MNIST                     (3) | Train Loss: 0.7674 | Train Acc: 0.8190
 Site-MNIST                     (3) | Train Loss: 0.7362 | Train Acc: 0.8347
 Site-SynthDigits               (2) | Train Loss: 1.3087 | Train Acc: 0.6026
 Site-SynthDigits               (2) | Train Loss: 1.2977 | Train Acc: 0.5678
 Site-SynthDigits               (2) | Train Loss: 1.2111 | Train Acc: 0.6171
 Site-SVHN                      (4) | Train Loss: 1.7541 | Train Acc: 0.4144
 Site-SVHN                      (4) | Train Loss: 1.6516 | Train Acc: 0.4373
 Site-MNIST_M                   (0) | Train Loss: 1.7046 | Train Acc: 0.4149
Average Train Accuracy: 0.7733
 Site-USPS                      (1) | Val  Loss: 1.2077 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.8687 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.9151 | Val  Acc: 0.8000
 Site-USPS                      (1) | Val  Loss: 0.5769 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.5131 | Val  Acc: 0.8824
 Site-USPS                      (1) | Val  Loss: 0.4397 | Val  Acc: 0.9032
 Site-USPS                      (1) | Val  Loss: 0.4850 | Val  Acc: 0.8571
 Site-USPS                      (1) | Val  Loss: 0.5024 | Val  Acc: 0.8725
 Site-USPS                      (1) | Val  Loss: 0.5432 | Val  Acc: 0.8852
 Site-USPS                      (1) | Val  Loss: 0.5482 | Val  Acc: 0.8822
 Site-MNIST                     (3) | Val  Loss: 0.8335 | Val  Acc: 0.7000
 Site-MNIST                     (3) | Val  Loss: 0.6799 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.6514 | Val  Acc: 0.8438
 Site-MNIST                     (3) | Val  Loss: 0.7091 | Val  Acc: 0.8276
 Site-MNIST                     (3) | Val  Loss: 0.6674 | Val  Acc: 0.8762
 Site-MNIST                     (3) | Val  Loss: 0.6692 | Val  Acc: 0.8571
 Site-SynthDigits               (2) | Val  Loss: 1.3616 | Val  Acc: 0.6486
 Site-SynthDigits               (2) | Val  Loss: 1.2023 | Val  Acc: 0.6324
 Site-SynthDigits               (2) | Val  Loss: 1.2923 | Val  Acc: 0.5902
 Site-SVHN                      (4) | Val  Loss: 1.6523 | Val  Acc: 0.4444
 Site-SVHN                      (4) | Val  Loss: 1.6335 | Val  Acc: 0.4444
 Site-MNIST_M                   (0) | Val  Loss: 1.8854 | Val  Acc: 0.4714
Average Valid Accuracy: 0.7766
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.8000
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.8889
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.8824
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.9032
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.8571
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.8725
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.8852
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.8822
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.7000
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.8438
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.8276
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.8762
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.8571
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.6486
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.6324
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.5902
 Best site-SVHN                     (4)  | Epoch:8 | Val Acc: 0.4444
 Best site-SVHN                     (4)  | Epoch:8 | Val Acc: 0.4444
 Best site-MNIST_M                  (0)  | Epoch:8 | Val Acc: 0.4714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 9 ============
cnt=[10, 3, 1, 6, 2, ]
cnt=[1, 10, 6, 3, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-USPS                      (0) | Train Loss: 0.4565 | Train Acc: 0.8333
 Site-USPS                      (0) | Train Loss: 0.3402 | Train Acc: 0.9167
 Site-USPS                      (0) | Train Loss: 0.4771 | Train Acc: 0.8571
 Site-USPS                      (0) | Train Loss: 0.5145 | Train Acc: 0.9474
 Site-USPS                      (0) | Train Loss: 0.5026 | Train Acc: 0.9143
 Site-USPS                      (0) | Train Loss: 0.4944 | Train Acc: 0.8968
 Site-USPS                      (0) | Train Loss: 0.5590 | Train Acc: 0.8899
 Site-USPS                      (0) | Train Loss: 0.5074 | Train Acc: 0.8851
 Site-USPS                      (0) | Train Loss: 0.5201 | Train Acc: 0.8886
 Site-USPS                      (0) | Train Loss: 0.4866 | Train Acc: 0.9064
 Site-MNIST                     (3) | Train Loss: 0.6703 | Train Acc: 0.9000
 Site-MNIST                     (3) | Train Loss: 0.5868 | Train Acc: 0.8194
 Site-MNIST                     (3) | Train Loss: 0.6490 | Train Acc: 0.8217
 Site-MNIST                     (3) | Train Loss: 0.6356 | Train Acc: 0.8498
 Site-MNIST                     (3) | Train Loss: 0.7220 | Train Acc: 0.8286
 Site-MNIST                     (3) | Train Loss: 0.6939 | Train Acc: 0.8413
 Site-SynthDigits               (1) | Train Loss: 1.2721 | Train Acc: 0.6159
 Site-SynthDigits               (1) | Train Loss: 1.2391 | Train Acc: 0.6154
 Site-SynthDigits               (1) | Train Loss: 1.1281 | Train Acc: 0.6619
 Site-SVHN                      (4) | Train Loss: 1.6832 | Train Acc: 0.4641
 Site-SVHN                      (4) | Train Loss: 1.6489 | Train Acc: 0.4557
 Site-MNIST_M                   (2) | Train Loss: 1.6461 | Train Acc: 0.4362
Average Train Accuracy: 0.7839
 Site-USPS                      (0) | Val  Loss: 1.0819 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.8088 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.8724 | Val  Acc: 0.8000
 Site-USPS                      (0) | Val  Loss: 0.5602 | Val  Acc: 0.8889
 Site-USPS                      (0) | Val  Loss: 0.4841 | Val  Acc: 0.8824
 Site-USPS                      (0) | Val  Loss: 0.4126 | Val  Acc: 0.9355
 Site-USPS                      (0) | Val  Loss: 0.4588 | Val  Acc: 0.8929
 Site-USPS                      (0) | Val  Loss: 0.4855 | Val  Acc: 0.8824
 Site-USPS                      (0) | Val  Loss: 0.5240 | Val  Acc: 0.8798
 Site-USPS                      (0) | Val  Loss: 0.5295 | Val  Acc: 0.8761
 Site-MNIST                     (3) | Val  Loss: 0.7776 | Val  Acc: 0.7000
 Site-MNIST                     (3) | Val  Loss: 0.6433 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.6242 | Val  Acc: 0.8438
 Site-MNIST                     (3) | Val  Loss: 0.6749 | Val  Acc: 0.8276
 Site-MNIST                     (3) | Val  Loss: 0.6322 | Val  Acc: 0.8571
 Site-MNIST                     (3) | Val  Loss: 0.6298 | Val  Acc: 0.8571
 Site-SynthDigits               (1) | Val  Loss: 1.2667 | Val  Acc: 0.7027
 Site-SynthDigits               (1) | Val  Loss: 1.0912 | Val  Acc: 0.6765
 Site-SynthDigits               (1) | Val  Loss: 1.2028 | Val  Acc: 0.6311
 Site-SVHN                      (4) | Val  Loss: 1.5635 | Val  Acc: 0.5111
 Site-SVHN                      (4) | Val  Loss: 1.5447 | Val  Acc: 0.5062
 Site-MNIST_M                   (2) | Val  Loss: 1.8539 | Val  Acc: 0.5714
Average Valid Accuracy: 0.7955
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8000
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8889
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8824
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.9355
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8929
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8824
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8798
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8761
 Best site-MNIST                    (3)  | Epoch:9 | Val Acc: 0.7000
 Best site-MNIST                    (3)  | Epoch:9 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:9 | Val Acc: 0.8438
 Best site-MNIST                    (3)  | Epoch:9 | Val Acc: 0.8276
 Best site-MNIST                    (3)  | Epoch:9 | Val Acc: 0.8571
 Best site-MNIST                    (3)  | Epoch:9 | Val Acc: 0.8571
 Best site-SynthDigits              (1)  | Epoch:9 | Val Acc: 0.7027
 Best site-SynthDigits              (1)  | Epoch:9 | Val Acc: 0.6765
 Best site-SynthDigits              (1)  | Epoch:9 | Val Acc: 0.6311
 Best site-SVHN                     (4)  | Epoch:9 | Val Acc: 0.5111
 Best site-SVHN                     (4)  | Epoch:9 | Val Acc: 0.5062
 Best site-MNIST_M                  (2)  | Epoch:9 | Val Acc: 0.5714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 10 ============
cnt=[10, 2, 6, 1, 3, ]
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-USPS                      (0) | Train Loss: 0.4349 | Train Acc: 0.8333
 Site-USPS                      (0) | Train Loss: 0.3217 | Train Acc: 0.9167
 Site-USPS                      (0) | Train Loss: 0.4706 | Train Acc: 0.8571
 Site-USPS                      (0) | Train Loss: 0.4846 | Train Acc: 0.9474
 Site-USPS                      (0) | Train Loss: 0.5217 | Train Acc: 0.9143
 Site-USPS                      (0) | Train Loss: 0.4650 | Train Acc: 0.9206
 Site-USPS                      (0) | Train Loss: 0.5261 | Train Acc: 0.8987
 Site-USPS                      (0) | Train Loss: 0.4707 | Train Acc: 0.8924
 Site-USPS                      (0) | Train Loss: 0.4801 | Train Acc: 0.8886
 Site-USPS                      (0) | Train Loss: 0.4544 | Train Acc: 0.9117
 Site-MNIST                     (2) | Train Loss: 0.6293 | Train Acc: 0.9000
 Site-MNIST                     (2) | Train Loss: 0.5276 | Train Acc: 0.8194
 Site-MNIST                     (2) | Train Loss: 0.6699 | Train Acc: 0.8372
 Site-MNIST                     (2) | Train Loss: 0.5906 | Train Acc: 0.8541
 Site-MNIST                     (2) | Train Loss: 0.6819 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.6561 | Train Acc: 0.8505
 Site-SynthDigits               (4) | Train Loss: 1.1823 | Train Acc: 0.6159
 Site-SynthDigits               (4) | Train Loss: 1.1448 | Train Acc: 0.6300
 Site-SynthDigits               (4) | Train Loss: 1.0774 | Train Acc: 0.6802
 Site-SVHN                      (1) | Train Loss: 1.6365 | Train Acc: 0.4530
 Site-SVHN                      (1) | Train Loss: 1.4979 | Train Acc: 0.4801
 Site-MNIST_M                   (3) | Train Loss: 1.5936 | Train Acc: 0.4858
Average Train Accuracy: 0.7918
 Site-USPS                      (0) | Val  Loss: 0.9890 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.7619 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.7990 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.5168 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.4469 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.3818 | Val  Acc: 0.9355
 Site-USPS                      (0) | Val  Loss: 0.4321 | Val  Acc: 0.8929
 Site-USPS                      (0) | Val  Loss: 0.4564 | Val  Acc: 0.8922
 Site-USPS                      (0) | Val  Loss: 0.4919 | Val  Acc: 0.8907
 Site-USPS                      (0) | Val  Loss: 0.4965 | Val  Acc: 0.8852
 Site-MNIST                     (2) | Val  Loss: 0.7457 | Val  Acc: 0.7000
 Site-MNIST                     (2) | Val  Loss: 0.6089 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.5853 | Val  Acc: 0.8438
 Site-MNIST                     (2) | Val  Loss: 0.6379 | Val  Acc: 0.8276
 Site-MNIST                     (2) | Val  Loss: 0.5903 | Val  Acc: 0.8762
 Site-MNIST                     (2) | Val  Loss: 0.5850 | Val  Acc: 0.8783
 Site-SynthDigits               (4) | Val  Loss: 1.2018 | Val  Acc: 0.7027
 Site-SynthDigits               (4) | Val  Loss: 1.0439 | Val  Acc: 0.6618
 Site-SynthDigits               (4) | Val  Loss: 1.1377 | Val  Acc: 0.6230
 Site-SVHN                      (1) | Val  Loss: 1.4979 | Val  Acc: 0.5333
 Site-SVHN                      (1) | Val  Loss: 1.4896 | Val  Acc: 0.5185
 Site-MNIST_M                   (3) | Val  Loss: 1.7769 | Val  Acc: 0.5857
Average Valid Accuracy: 0.8166
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.9412
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.9355
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8929
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8922
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8907
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8852
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.7000
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.8438
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.8276
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.8762
 Best site-MNIST                    (2)  | Epoch:10 | Val Acc: 0.8783
 Best site-SynthDigits              (4)  | Epoch:10 | Val Acc: 0.7027
 Best site-SynthDigits              (4)  | Epoch:10 | Val Acc: 0.6618
 Best site-SynthDigits              (4)  | Epoch:10 | Val Acc: 0.6230
 Best site-SVHN                     (1)  | Epoch:10 | Val Acc: 0.5333
 Best site-SVHN                     (1)  | Epoch:10 | Val Acc: 0.5185
 Best site-MNIST_M                  (3)  | Epoch:10 | Val Acc: 0.5857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 11 ============
cnt=[10, 1, 1, 5, 5, ]
cnt=[10, 3, 6, 1, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-USPS                      (0) | Train Loss: 0.4140 | Train Acc: 0.8333
 Site-USPS                      (0) | Train Loss: 0.3151 | Train Acc: 0.9167
 Site-USPS                      (0) | Train Loss: 0.4575 | Train Acc: 0.8571
 Site-USPS                      (0) | Train Loss: 0.4584 | Train Acc: 0.9474
 Site-USPS                      (0) | Train Loss: 0.4280 | Train Acc: 0.9143
 Site-USPS                      (0) | Train Loss: 0.4459 | Train Acc: 0.9365
 Site-USPS                      (0) | Train Loss: 0.4874 | Train Acc: 0.8899
 Site-USPS                      (0) | Train Loss: 0.4641 | Train Acc: 0.8900
 Site-USPS                      (0) | Train Loss: 0.4626 | Train Acc: 0.8967
 Site-USPS                      (0) | Train Loss: 0.4376 | Train Acc: 0.9132
 Site-MNIST                     (1) | Train Loss: 0.5897 | Train Acc: 0.9000
 Site-MNIST                     (4) | Train Loss: 0.5074 | Train Acc: 0.8194
 Site-MNIST                     (4) | Train Loss: 0.4839 | Train Acc: 0.8450
 Site-MNIST                     (4) | Train Loss: 0.5464 | Train Acc: 0.8584
 Site-MNIST                     (4) | Train Loss: 0.6456 | Train Acc: 0.8357
 Site-MNIST                     (4) | Train Loss: 0.6128 | Train Acc: 0.8505
 Site-SynthDigits               (3) | Train Loss: 1.1614 | Train Acc: 0.6225
 Site-SynthDigits               (3) | Train Loss: 1.1074 | Train Acc: 0.6447
 Site-SynthDigits               (3) | Train Loss: 1.0068 | Train Acc: 0.7149
 Site-SVHN                      (3) | Train Loss: 1.5833 | Train Acc: 0.4751
 Site-SVHN                      (3) | Train Loss: 1.4484 | Train Acc: 0.5138
 Site-MNIST_M                   (2) | Train Loss: 1.5229 | Train Acc: 0.5319
Average Train Accuracy: 0.8003
 Site-USPS                      (0) | Val  Loss: 0.9072 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.7152 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.7219 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.4800 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.4119 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.3573 | Val  Acc: 0.9032
 Site-USPS                      (0) | Val  Loss: 0.4076 | Val  Acc: 0.8750
 Site-USPS                      (0) | Val  Loss: 0.4388 | Val  Acc: 0.8824
 Site-USPS                      (0) | Val  Loss: 0.4701 | Val  Acc: 0.8962
 Site-USPS                      (0) | Val  Loss: 0.4734 | Val  Acc: 0.8882
 Site-MNIST                     (1) | Val  Loss: 0.7062 | Val  Acc: 0.7000
 Site-MNIST                     (4) | Val  Loss: 0.5719 | Val  Acc: 0.7778
 Site-MNIST                     (4) | Val  Loss: 0.5492 | Val  Acc: 0.8438
 Site-MNIST                     (4) | Val  Loss: 0.5979 | Val  Acc: 0.8448
 Site-MNIST                     (4) | Val  Loss: 0.5527 | Val  Acc: 0.8762
 Site-MNIST                     (4) | Val  Loss: 0.5417 | Val  Acc: 0.8836
 Site-SynthDigits               (3) | Val  Loss: 1.1333 | Val  Acc: 0.7297
 Site-SynthDigits               (3) | Val  Loss: 0.9878 | Val  Acc: 0.6765
 Site-SynthDigits               (3) | Val  Loss: 1.0696 | Val  Acc: 0.6475
 Site-SVHN                      (3) | Val  Loss: 1.4463 | Val  Acc: 0.5778
 Site-SVHN                      (3) | Val  Loss: 1.4366 | Val  Acc: 0.5679
 Site-MNIST_M                   (2) | Val  Loss: 1.7132 | Val  Acc: 0.6143
Average Valid Accuracy: 0.8239
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.9412
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.9032
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.8750
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.8824
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.8962
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.8882
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.7000
 Best site-MNIST                    (4)  | Epoch:11 | Val Acc: 0.7778
 Best site-MNIST                    (4)  | Epoch:11 | Val Acc: 0.8438
 Best site-MNIST                    (4)  | Epoch:11 | Val Acc: 0.8448
 Best site-MNIST                    (4)  | Epoch:11 | Val Acc: 0.8762
 Best site-MNIST                    (4)  | Epoch:11 | Val Acc: 0.8836
 Best site-SynthDigits              (3)  | Epoch:11 | Val Acc: 0.7297
 Best site-SynthDigits              (3)  | Epoch:11 | Val Acc: 0.6765
 Best site-SynthDigits              (3)  | Epoch:11 | Val Acc: 0.6475
 Best site-SVHN                     (3)  | Epoch:11 | Val Acc: 0.5778
 Best site-SVHN                     (3)  | Epoch:11 | Val Acc: 0.5679
 Best site-MNIST_M                  (2)  | Epoch:11 | Val Acc: 0.6143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 12 ============
cnt=[10, 6, 2, 1, 3, ]
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-USPS                      (0) | Train Loss: 0.3875 | Train Acc: 0.8333
 Site-USPS                      (0) | Train Loss: 0.3025 | Train Acc: 0.9167
 Site-USPS                      (0) | Train Loss: 0.4310 | Train Acc: 0.8571
 Site-USPS                      (0) | Train Loss: 0.4230 | Train Acc: 0.9474
 Site-USPS                      (0) | Train Loss: 0.3458 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.4322 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.4794 | Train Acc: 0.8987
 Site-USPS                      (0) | Train Loss: 0.4368 | Train Acc: 0.8973
 Site-USPS                      (0) | Train Loss: 0.4489 | Train Acc: 0.8967
 Site-USPS                      (0) | Train Loss: 0.4174 | Train Acc: 0.9147
 Site-MNIST                     (1) | Train Loss: 0.5496 | Train Acc: 0.9250
 Site-MNIST                     (1) | Train Loss: 0.4535 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.5371 | Train Acc: 0.8682
 Site-MNIST                     (1) | Train Loss: 0.5264 | Train Acc: 0.8798
 Site-MNIST                     (1) | Train Loss: 0.6162 | Train Acc: 0.8595
 Site-MNIST                     (1) | Train Loss: 0.5779 | Train Acc: 0.8598
 Site-SynthDigits               (4) | Train Loss: 1.0682 | Train Acc: 0.6490
 Site-SynthDigits               (4) | Train Loss: 1.0352 | Train Acc: 0.6996
 Site-SynthDigits               (4) | Train Loss: 0.9490 | Train Acc: 0.7210
 Site-SVHN                      (2) | Train Loss: 1.5283 | Train Acc: 0.5028
 Site-SVHN                      (2) | Train Loss: 1.5692 | Train Acc: 0.5352
 Site-MNIST_M                   (3) | Train Loss: 1.4673 | Train Acc: 0.5674
Average Train Accuracy: 0.8159
 Site-USPS                      (0) | Val  Loss: 0.7635 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.6139 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.6341 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.4238 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.3753 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.3329 | Val  Acc: 0.8710
 Site-USPS                      (0) | Val  Loss: 0.3847 | Val  Acc: 0.8571
 Site-USPS                      (0) | Val  Loss: 0.4150 | Val  Acc: 0.8922
 Site-USPS                      (0) | Val  Loss: 0.4426 | Val  Acc: 0.9126
 Site-USPS                      (0) | Val  Loss: 0.4473 | Val  Acc: 0.9033
 Site-MNIST                     (1) | Val  Loss: 0.6881 | Val  Acc: 0.7000
 Site-MNIST                     (1) | Val  Loss: 0.5469 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.5083 | Val  Acc: 0.8438
 Site-MNIST                     (1) | Val  Loss: 0.5606 | Val  Acc: 0.8448
 Site-MNIST                     (1) | Val  Loss: 0.5189 | Val  Acc: 0.8952
 Site-MNIST                     (1) | Val  Loss: 0.5107 | Val  Acc: 0.9153
 Site-SynthDigits               (4) | Val  Loss: 1.0621 | Val  Acc: 0.7568
 Site-SynthDigits               (4) | Val  Loss: 0.8946 | Val  Acc: 0.7353
 Site-SynthDigits               (4) | Val  Loss: 1.0047 | Val  Acc: 0.6967
 Site-SVHN                      (2) | Val  Loss: 1.3764 | Val  Acc: 0.6444
 Site-SVHN                      (2) | Val  Loss: 1.3819 | Val  Acc: 0.5926
 Site-MNIST_M                   (3) | Val  Loss: 1.6585 | Val  Acc: 0.6143
Average Valid Accuracy: 0.8361
 Best site-USPS                     (0)  | Epoch:12 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:12 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:12 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:12 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:12 | Val Acc: 0.9412
 Best site-USPS                     (0)  | Epoch:12 | Val Acc: 0.8710
 Best site-USPS                     (0)  | Epoch:12 | Val Acc: 0.8571
 Best site-USPS                     (0)  | Epoch:12 | Val Acc: 0.8922
 Best site-USPS                     (0)  | Epoch:12 | Val Acc: 0.9126
 Best site-USPS                     (0)  | Epoch:12 | Val Acc: 0.9033
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.7000
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8438
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8448
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.8952
 Best site-MNIST                    (1)  | Epoch:12 | Val Acc: 0.9153
 Best site-SynthDigits              (4)  | Epoch:12 | Val Acc: 0.7568
 Best site-SynthDigits              (4)  | Epoch:12 | Val Acc: 0.7353
 Best site-SynthDigits              (4)  | Epoch:12 | Val Acc: 0.6967
 Best site-SVHN                     (2)  | Epoch:12 | Val Acc: 0.6444
 Best site-SVHN                     (2)  | Epoch:12 | Val Acc: 0.5926
 Best site-MNIST_M                  (3)  | Epoch:12 | Val Acc: 0.6143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 13 ============
cnt=[6, 10, 3, 1, 2, ]
cnt=[10, 6, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-USPS                      (1) | Train Loss: 0.3529 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.2850 | Train Acc: 0.9167
 Site-USPS                      (1) | Train Loss: 0.4077 | Train Acc: 0.8571
 Site-USPS                      (1) | Train Loss: 0.4100 | Train Acc: 0.9474
 Site-USPS                      (1) | Train Loss: 0.3341 | Train Acc: 0.9429
 Site-USPS                      (1) | Train Loss: 0.4139 | Train Acc: 0.9365
 Site-USPS                      (1) | Train Loss: 0.4569 | Train Acc: 0.8943
 Site-USPS                      (1) | Train Loss: 0.4127 | Train Acc: 0.9046
 Site-USPS                      (1) | Train Loss: 0.4275 | Train Acc: 0.8981
 Site-USPS                      (1) | Train Loss: 0.3992 | Train Acc: 0.9208
 Site-MNIST                     (0) | Train Loss: 0.5183 | Train Acc: 0.9250
 Site-MNIST                     (0) | Train Loss: 0.4107 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4523 | Train Acc: 0.8760
 Site-MNIST                     (0) | Train Loss: 0.4917 | Train Acc: 0.8798
 Site-MNIST                     (0) | Train Loss: 0.5713 | Train Acc: 0.8595
 Site-MNIST                     (0) | Train Loss: 0.5418 | Train Acc: 0.8677
 Site-SynthDigits               (2) | Train Loss: 1.1333 | Train Acc: 0.6821
 Site-SynthDigits               (2) | Train Loss: 0.9621 | Train Acc: 0.7033
 Site-SynthDigits               (2) | Train Loss: 0.8802 | Train Acc: 0.7413
 Site-SVHN                      (4) | Train Loss: 1.4743 | Train Acc: 0.5359
 Site-SVHN                      (4) | Train Loss: 1.3488 | Train Acc: 0.5352
 Site-MNIST_M                   (3) | Train Loss: 1.4512 | Train Acc: 0.5638
Average Train Accuracy: 0.8282
 Site-USPS                      (1) | Val  Loss: 0.6897 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.5706 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.5869 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3999 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3602 | Val  Acc: 0.9412
 Site-USPS                      (1) | Val  Loss: 0.3290 | Val  Acc: 0.8710
 Site-USPS                      (1) | Val  Loss: 0.3680 | Val  Acc: 0.8571
 Site-USPS                      (1) | Val  Loss: 0.4026 | Val  Acc: 0.8922
 Site-USPS                      (1) | Val  Loss: 0.4241 | Val  Acc: 0.9235
 Site-USPS                      (1) | Val  Loss: 0.4296 | Val  Acc: 0.9033
 Site-MNIST                     (0) | Val  Loss: 0.6741 | Val  Acc: 0.7000
 Site-MNIST                     (0) | Val  Loss: 0.5323 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4835 | Val  Acc: 0.8438
 Site-MNIST                     (0) | Val  Loss: 0.5312 | Val  Acc: 0.8448
 Site-MNIST                     (0) | Val  Loss: 0.4912 | Val  Acc: 0.8952
 Site-MNIST                     (0) | Val  Loss: 0.4780 | Val  Acc: 0.9153
 Site-SynthDigits               (2) | Val  Loss: 0.9921 | Val  Acc: 0.7568
 Site-SynthDigits               (2) | Val  Loss: 0.8229 | Val  Acc: 0.7353
 Site-SynthDigits               (2) | Val  Loss: 0.9510 | Val  Acc: 0.7131
 Site-SVHN                      (4) | Val  Loss: 1.3193 | Val  Acc: 0.6444
 Site-SVHN                      (4) | Val  Loss: 1.3230 | Val  Acc: 0.6173
 Site-MNIST_M                   (3) | Val  Loss: 1.6499 | Val  Acc: 0.6429
Average Valid Accuracy: 0.8398
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.9412
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.8710
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.8571
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.8922
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.9235
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.9033
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.7000
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.8438
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.8448
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.8952
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.9153
 Best site-SynthDigits              (2)  | Epoch:13 | Val Acc: 0.7568
 Best site-SynthDigits              (2)  | Epoch:13 | Val Acc: 0.7353
 Best site-SynthDigits              (2)  | Epoch:13 | Val Acc: 0.7131
 Best site-SVHN                     (4)  | Epoch:13 | Val Acc: 0.6444
 Best site-SVHN                     (4)  | Epoch:13 | Val Acc: 0.6173
 Best site-MNIST_M                  (3)  | Epoch:13 | Val Acc: 0.6429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 14 ============
cnt=[10, 3, 6, 1, 2, ]
cnt=[10, 2, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-USPS                      (0) | Train Loss: 0.3516 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.2900 | Train Acc: 0.9167
 Site-USPS                      (0) | Train Loss: 0.4115 | Train Acc: 0.8571
 Site-USPS                      (0) | Train Loss: 0.3866 | Train Acc: 0.9474
 Site-USPS                      (0) | Train Loss: 0.4222 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.4024 | Train Acc: 0.9286
 Site-USPS                      (0) | Train Loss: 0.4585 | Train Acc: 0.8987
 Site-USPS                      (0) | Train Loss: 0.4014 | Train Acc: 0.9120
 Site-USPS                      (0) | Train Loss: 0.4057 | Train Acc: 0.8967
 Site-USPS                      (0) | Train Loss: 0.3821 | Train Acc: 0.9185
 Site-MNIST                     (2) | Train Loss: 0.4748 | Train Acc: 0.9250
 Site-MNIST                     (2) | Train Loss: 0.3938 | Train Acc: 0.8611
 Site-MNIST                     (2) | Train Loss: 0.3875 | Train Acc: 0.8915
 Site-MNIST                     (2) | Train Loss: 0.4495 | Train Acc: 0.8927
 Site-MNIST                     (2) | Train Loss: 0.5384 | Train Acc: 0.8667
 Site-MNIST                     (2) | Train Loss: 0.5072 | Train Acc: 0.8836
 Site-SynthDigits               (1) | Train Loss: 1.0190 | Train Acc: 0.6821
 Site-SynthDigits               (1) | Train Loss: 0.9344 | Train Acc: 0.7106
 Site-SynthDigits               (1) | Train Loss: 0.8498 | Train Acc: 0.7576
 Site-SVHN                      (4) | Train Loss: 1.4314 | Train Acc: 0.5635
 Site-SVHN                      (4) | Train Loss: 1.3819 | Train Acc: 0.5688
 Site-MNIST_M                   (3) | Train Loss: 1.3585 | Train Acc: 0.5957
Average Train Accuracy: 0.8372
 Site-USPS                      (0) | Val  Loss: 0.6211 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.5275 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.5311 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.3698 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.3382 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.3097 | Val  Acc: 0.8710
 Site-USPS                      (0) | Val  Loss: 0.3520 | Val  Acc: 0.8571
 Site-USPS                      (0) | Val  Loss: 0.3809 | Val  Acc: 0.9020
 Site-USPS                      (0) | Val  Loss: 0.4023 | Val  Acc: 0.9290
 Site-USPS                      (0) | Val  Loss: 0.4087 | Val  Acc: 0.9094
 Site-MNIST                     (2) | Val  Loss: 0.6438 | Val  Acc: 0.7000
 Site-MNIST                     (2) | Val  Loss: 0.5024 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.4450 | Val  Acc: 0.8438
 Site-MNIST                     (2) | Val  Loss: 0.4947 | Val  Acc: 0.8448
 Site-MNIST                     (2) | Val  Loss: 0.4528 | Val  Acc: 0.8857
 Site-MNIST                     (2) | Val  Loss: 0.4374 | Val  Acc: 0.9259
 Site-SynthDigits               (1) | Val  Loss: 0.9355 | Val  Acc: 0.7568
 Site-SynthDigits               (1) | Val  Loss: 0.7851 | Val  Acc: 0.7206
 Site-SynthDigits               (1) | Val  Loss: 0.9094 | Val  Acc: 0.7131
 Site-SVHN                      (4) | Val  Loss: 1.2838 | Val  Acc: 0.6222
 Site-SVHN                      (4) | Val  Loss: 1.2862 | Val  Acc: 0.6173
 Site-MNIST_M                   (3) | Val  Loss: 1.5652 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8398
============ Train epoch 15 ============
cnt=[3, 10, 6, 1, 2, ]
cnt=[10, 6, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-USPS                      (1) | Train Loss: 0.3166 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.2545 | Train Acc: 0.9167
 Site-USPS                      (1) | Train Loss: 0.3890 | Train Acc: 0.8571
 Site-USPS                      (1) | Train Loss: 0.3789 | Train Acc: 0.9737
 Site-USPS                      (1) | Train Loss: 0.4473 | Train Acc: 0.9429
 Site-USPS                      (1) | Train Loss: 0.3795 | Train Acc: 0.9286
 Site-USPS                      (1) | Train Loss: 0.4278 | Train Acc: 0.8899
 Site-USPS                      (1) | Train Loss: 0.3927 | Train Acc: 0.9144
 Site-USPS                      (1) | Train Loss: 0.3873 | Train Acc: 0.8967
 Site-USPS                      (1) | Train Loss: 0.3647 | Train Acc: 0.9185
 Site-MNIST                     (2) | Train Loss: 0.4622 | Train Acc: 0.9250
 Site-MNIST                     (2) | Train Loss: 0.4626 | Train Acc: 0.8611
 Site-MNIST                     (2) | Train Loss: 0.3421 | Train Acc: 0.8837
 Site-MNIST                     (2) | Train Loss: 0.4264 | Train Acc: 0.8927
 Site-MNIST                     (2) | Train Loss: 0.5137 | Train Acc: 0.8667
 Site-MNIST                     (2) | Train Loss: 0.4910 | Train Acc: 0.8796
 Site-SynthDigits               (0) | Train Loss: 1.0362 | Train Acc: 0.6556
 Site-SynthDigits               (0) | Train Loss: 0.8735 | Train Acc: 0.7289
 Site-SynthDigits               (0) | Train Loss: 0.8168 | Train Acc: 0.7556
 Site-SVHN                      (4) | Train Loss: 1.3954 | Train Acc: 0.5746
 Site-SVHN                      (4) | Train Loss: 1.3325 | Train Acc: 0.5780
 Site-MNIST_M                   (3) | Train Loss: 1.3561 | Train Acc: 0.6099
Average Train Accuracy: 0.8386
 Site-USPS                      (1) | Val  Loss: 0.5883 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.4864 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.5107 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3558 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3225 | Val  Acc: 0.9412
 Site-USPS                      (1) | Val  Loss: 0.2986 | Val  Acc: 0.8710
 Site-USPS                      (1) | Val  Loss: 0.3361 | Val  Acc: 0.8750
 Site-USPS                      (1) | Val  Loss: 0.3630 | Val  Acc: 0.9020
 Site-USPS                      (1) | Val  Loss: 0.3848 | Val  Acc: 0.9180
 Site-USPS                      (1) | Val  Loss: 0.3917 | Val  Acc: 0.9063
 Site-MNIST                     (2) | Val  Loss: 0.6355 | Val  Acc: 0.7000
 Site-MNIST                     (2) | Val  Loss: 0.5010 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.4396 | Val  Acc: 0.8438
 Site-MNIST                     (2) | Val  Loss: 0.4820 | Val  Acc: 0.8621
 Site-MNIST                     (2) | Val  Loss: 0.4313 | Val  Acc: 0.8857
 Site-MNIST                     (2) | Val  Loss: 0.4161 | Val  Acc: 0.9259
 Site-SynthDigits               (0) | Val  Loss: 0.8812 | Val  Acc: 0.7838
 Site-SynthDigits               (0) | Val  Loss: 0.7107 | Val  Acc: 0.7500
 Site-SynthDigits               (0) | Val  Loss: 0.8694 | Val  Acc: 0.7295
 Site-SVHN                      (4) | Val  Loss: 1.2380 | Val  Acc: 0.6667
 Site-SVHN                      (4) | Val  Loss: 1.2451 | Val  Acc: 0.5926
 Site-MNIST_M                   (3) | Val  Loss: 1.5131 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8449
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.9412
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.8710
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.8750
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.9020
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.9180
 Best site-USPS                     (1)  | Epoch:15 | Val Acc: 0.9063
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.7000
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8438
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8621
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.8857
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.9259
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.7838
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.7500
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.7295
 Best site-SVHN                     (4)  | Epoch:15 | Val Acc: 0.6667
 Best site-SVHN                     (4)  | Epoch:15 | Val Acc: 0.5926
 Best site-MNIST_M                  (3)  | Epoch:15 | Val Acc: 0.6571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 16 ============
cnt=[2, 10, 6, 1, 3, ]
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-USPS                      (1) | Train Loss: 0.3075 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.2428 | Train Acc: 0.9167
 Site-USPS                      (1) | Train Loss: 0.3845 | Train Acc: 0.9048
 Site-USPS                      (1) | Train Loss: 0.3586 | Train Acc: 0.9474
 Site-USPS                      (1) | Train Loss: 0.4773 | Train Acc: 0.9429
 Site-USPS                      (1) | Train Loss: 0.3692 | Train Acc: 0.9365
 Site-USPS                      (1) | Train Loss: 0.4304 | Train Acc: 0.8855
 Site-USPS                      (1) | Train Loss: 0.3513 | Train Acc: 0.9169
 Site-USPS                      (1) | Train Loss: 0.3817 | Train Acc: 0.9076
 Site-USPS                      (1) | Train Loss: 0.3522 | Train Acc: 0.9208
 Site-MNIST                     (2) | Train Loss: 0.4460 | Train Acc: 0.9250
 Site-MNIST                     (2) | Train Loss: 0.3201 | Train Acc: 0.8472
 Site-MNIST                     (2) | Train Loss: 0.3301 | Train Acc: 0.8915
 Site-MNIST                     (2) | Train Loss: 0.4027 | Train Acc: 0.8970
 Site-MNIST                     (2) | Train Loss: 0.4903 | Train Acc: 0.8786
 Site-MNIST                     (2) | Train Loss: 0.4684 | Train Acc: 0.8849
 Site-SynthDigits               (4) | Train Loss: 0.9437 | Train Acc: 0.6755
 Site-SynthDigits               (4) | Train Loss: 0.8752 | Train Acc: 0.7436
 Site-SynthDigits               (4) | Train Loss: 0.7924 | Train Acc: 0.7821
 Site-SVHN                      (0) | Train Loss: 1.3576 | Train Acc: 0.5912
 Site-SVHN                      (0) | Train Loss: 1.2787 | Train Acc: 0.5994
 Site-MNIST_M                   (3) | Train Loss: 1.2837 | Train Acc: 0.6277
Average Train Accuracy: 0.8465
 Site-USPS                      (1) | Val  Loss: 0.5462 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.4346 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.4549 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3179 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3012 | Val  Acc: 0.9412
 Site-USPS                      (1) | Val  Loss: 0.2869 | Val  Acc: 0.8710
 Site-USPS                      (1) | Val  Loss: 0.3250 | Val  Acc: 0.8750
 Site-USPS                      (1) | Val  Loss: 0.3502 | Val  Acc: 0.9118
 Site-USPS                      (1) | Val  Loss: 0.3667 | Val  Acc: 0.9235
 Site-USPS                      (1) | Val  Loss: 0.3736 | Val  Acc: 0.9063
 Site-MNIST                     (2) | Val  Loss: 0.6260 | Val  Acc: 0.7000
 Site-MNIST                     (2) | Val  Loss: 0.4858 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.4175 | Val  Acc: 0.8750
 Site-MNIST                     (2) | Val  Loss: 0.4665 | Val  Acc: 0.8793
 Site-MNIST                     (2) | Val  Loss: 0.4130 | Val  Acc: 0.9143
 Site-MNIST                     (2) | Val  Loss: 0.3948 | Val  Acc: 0.9312
 Site-SynthDigits               (4) | Val  Loss: 0.8467 | Val  Acc: 0.8108
 Site-SynthDigits               (4) | Val  Loss: 0.6851 | Val  Acc: 0.7353
 Site-SynthDigits               (4) | Val  Loss: 0.8304 | Val  Acc: 0.7295
 Site-SVHN                      (0) | Val  Loss: 1.2095 | Val  Acc: 0.6889
 Site-SVHN                      (0) | Val  Loss: 1.2146 | Val  Acc: 0.6296
 Site-MNIST_M                   (3) | Val  Loss: 1.4514 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8559
 Best site-USPS                     (1)  | Epoch:16 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:16 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:16 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:16 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:16 | Val Acc: 0.9412
 Best site-USPS                     (1)  | Epoch:16 | Val Acc: 0.8710
 Best site-USPS                     (1)  | Epoch:16 | Val Acc: 0.8750
 Best site-USPS                     (1)  | Epoch:16 | Val Acc: 0.9118
 Best site-USPS                     (1)  | Epoch:16 | Val Acc: 0.9235
 Best site-USPS                     (1)  | Epoch:16 | Val Acc: 0.9063
 Best site-MNIST                    (2)  | Epoch:16 | Val Acc: 0.7000
 Best site-MNIST                    (2)  | Epoch:16 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:16 | Val Acc: 0.8750
 Best site-MNIST                    (2)  | Epoch:16 | Val Acc: 0.8793
 Best site-MNIST                    (2)  | Epoch:16 | Val Acc: 0.9143
 Best site-MNIST                    (2)  | Epoch:16 | Val Acc: 0.9312
 Best site-SynthDigits              (4)  | Epoch:16 | Val Acc: 0.8108
 Best site-SynthDigits              (4)  | Epoch:16 | Val Acc: 0.7353
 Best site-SynthDigits              (4)  | Epoch:16 | Val Acc: 0.7295
 Best site-SVHN                     (0)  | Epoch:16 | Val Acc: 0.6889
 Best site-SVHN                     (0)  | Epoch:16 | Val Acc: 0.6296
 Best site-MNIST_M                  (3)  | Epoch:16 | Val Acc: 0.7286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 17 ============
cnt=[3, 6, 10, 1, 2, ]
cnt=[10, 6, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-USPS                      (2) | Train Loss: 0.2931 | Train Acc: 1.0000
 Site-USPS                      (2) | Train Loss: 0.2232 | Train Acc: 1.0000
 Site-USPS                      (2) | Train Loss: 0.3699 | Train Acc: 0.9048
 Site-USPS                      (2) | Train Loss: 0.3372 | Train Acc: 0.9474
 Site-USPS                      (2) | Train Loss: 0.3622 | Train Acc: 0.9286
 Site-USPS                      (2) | Train Loss: 0.3597 | Train Acc: 0.9286
 Site-USPS                      (2) | Train Loss: 0.4143 | Train Acc: 0.8722
 Site-USPS                      (2) | Train Loss: 0.3592 | Train Acc: 0.9169
 Site-USPS                      (2) | Train Loss: 0.3616 | Train Acc: 0.9103
 Site-USPS                      (2) | Train Loss: 0.3440 | Train Acc: 0.9208
 Site-MNIST                     (1) | Train Loss: 0.4275 | Train Acc: 0.9250
 Site-MNIST                     (1) | Train Loss: 0.3057 | Train Acc: 0.8750
 Site-MNIST                     (1) | Train Loss: 0.3584 | Train Acc: 0.8837
 Site-MNIST                     (1) | Train Loss: 0.3927 | Train Acc: 0.8927
 Site-MNIST                     (1) | Train Loss: 0.4714 | Train Acc: 0.8738
 Site-MNIST                     (1) | Train Loss: 0.4501 | Train Acc: 0.8929
 Site-SynthDigits               (0) | Train Loss: 0.9357 | Train Acc: 0.6954
 Site-SynthDigits               (0) | Train Loss: 0.7880 | Train Acc: 0.7582
 Site-SynthDigits               (0) | Train Loss: 0.7569 | Train Acc: 0.8004
 Site-SVHN                      (4) | Train Loss: 1.3205 | Train Acc: 0.5856
 Site-SVHN                      (4) | Train Loss: 1.2075 | Train Acc: 0.5933
 Site-MNIST_M                   (3) | Train Loss: 1.2215 | Train Acc: 0.6596
Average Train Accuracy: 0.8530
 Site-USPS                      (2) | Val  Loss: 0.5182 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.3974 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4225 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.2986 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.2823 | Val  Acc: 0.9412
 Site-USPS                      (2) | Val  Loss: 0.2756 | Val  Acc: 0.8710
 Site-USPS                      (2) | Val  Loss: 0.3124 | Val  Acc: 0.8750
 Site-USPS                      (2) | Val  Loss: 0.3391 | Val  Acc: 0.9118
 Site-USPS                      (2) | Val  Loss: 0.3541 | Val  Acc: 0.9290
 Site-USPS                      (2) | Val  Loss: 0.3608 | Val  Acc: 0.9033
 Site-MNIST                     (1) | Val  Loss: 0.6028 | Val  Acc: 0.7000
 Site-MNIST                     (1) | Val  Loss: 0.4647 | Val  Acc: 0.8333
 Site-MNIST                     (1) | Val  Loss: 0.3969 | Val  Acc: 0.8750
 Site-MNIST                     (1) | Val  Loss: 0.4492 | Val  Acc: 0.8793
 Site-MNIST                     (1) | Val  Loss: 0.3950 | Val  Acc: 0.9143
 Site-MNIST                     (1) | Val  Loss: 0.3752 | Val  Acc: 0.9259
 Site-SynthDigits               (0) | Val  Loss: 0.8121 | Val  Acc: 0.7838
 Site-SynthDigits               (0) | Val  Loss: 0.6476 | Val  Acc: 0.7500
 Site-SynthDigits               (0) | Val  Loss: 0.7995 | Val  Acc: 0.7541
 Site-SVHN                      (4) | Val  Loss: 1.1842 | Val  Acc: 0.6889
 Site-SVHN                      (4) | Val  Loss: 1.1841 | Val  Acc: 0.6420
 Site-MNIST_M                   (3) | Val  Loss: 1.4034 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8594
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 0.9412
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 0.8710
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 0.8750
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 0.9118
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 0.9290
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 0.9033
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.7000
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.8333
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.8750
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.8793
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9143
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9259
 Best site-SynthDigits              (0)  | Epoch:17 | Val Acc: 0.7838
 Best site-SynthDigits              (0)  | Epoch:17 | Val Acc: 0.7500
 Best site-SynthDigits              (0)  | Epoch:17 | Val Acc: 0.7541
 Best site-SVHN                     (4)  | Epoch:17 | Val Acc: 0.6889
 Best site-SVHN                     (4)  | Epoch:17 | Val Acc: 0.6420
 Best site-MNIST_M                  (3)  | Epoch:17 | Val Acc: 0.7286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 18 ============
cnt=[10, 1, 6, 3, 2, ]
cnt=[6, 10, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-USPS                      (0) | Train Loss: 0.2747 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.2419 | Train Acc: 0.9167
 Site-USPS                      (0) | Train Loss: 0.3574 | Train Acc: 0.8571
 Site-USPS                      (0) | Train Loss: 0.3212 | Train Acc: 0.9737
 Site-USPS                      (0) | Train Loss: 0.2260 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.3423 | Train Acc: 0.9286
 Site-USPS                      (0) | Train Loss: 0.3982 | Train Acc: 0.8855
 Site-USPS                      (0) | Train Loss: 0.3326 | Train Acc: 0.9267
 Site-USPS                      (0) | Train Loss: 0.3449 | Train Acc: 0.9158
 Site-USPS                      (0) | Train Loss: 0.3219 | Train Acc: 0.9306
 Site-MNIST                     (2) | Train Loss: 0.3814 | Train Acc: 0.9250
 Site-MNIST                     (2) | Train Loss: 0.4520 | Train Acc: 0.9028
 Site-MNIST                     (2) | Train Loss: 0.4425 | Train Acc: 0.8915
 Site-MNIST                     (2) | Train Loss: 0.3653 | Train Acc: 0.9013
 Site-MNIST                     (2) | Train Loss: 0.4512 | Train Acc: 0.8881
 Site-MNIST                     (2) | Train Loss: 0.4207 | Train Acc: 0.8995
 Site-SynthDigits               (3) | Train Loss: 0.9240 | Train Acc: 0.7086
 Site-SynthDigits               (3) | Train Loss: 0.7651 | Train Acc: 0.7875
 Site-SynthDigits               (3) | Train Loss: 0.7111 | Train Acc: 0.8248
 Site-SVHN                      (4) | Train Loss: 1.2779 | Train Acc: 0.6077
 Site-SVHN                      (4) | Train Loss: 1.1267 | Train Acc: 0.6300
 Site-MNIST_M                   (1) | Train Loss: 1.2229 | Train Acc: 0.6525
Average Train Accuracy: 0.8589
 Site-USPS                      (0) | Val  Loss: 0.4695 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.4054 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.4114 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2905 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2708 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.2616 | Val  Acc: 0.8710
 Site-USPS                      (0) | Val  Loss: 0.2911 | Val  Acc: 0.9107
 Site-USPS                      (0) | Val  Loss: 0.3227 | Val  Acc: 0.9314
 Site-USPS                      (0) | Val  Loss: 0.3323 | Val  Acc: 0.9344
 Site-USPS                      (0) | Val  Loss: 0.3420 | Val  Acc: 0.9184
 Site-MNIST                     (2) | Val  Loss: 0.5516 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 0.4257 | Val  Acc: 0.8333
 Site-MNIST                     (2) | Val  Loss: 0.3731 | Val  Acc: 0.8438
 Site-MNIST                     (2) | Val  Loss: 0.4274 | Val  Acc: 0.8621
 Site-MNIST                     (2) | Val  Loss: 0.3760 | Val  Acc: 0.9048
 Site-MNIST                     (2) | Val  Loss: 0.3476 | Val  Acc: 0.9312
 Site-SynthDigits               (3) | Val  Loss: 0.7569 | Val  Acc: 0.8649
 Site-SynthDigits               (3) | Val  Loss: 0.6210 | Val  Acc: 0.8088
 Site-SynthDigits               (3) | Val  Loss: 0.7686 | Val  Acc: 0.7951
 Site-SVHN                      (4) | Val  Loss: 1.1669 | Val  Acc: 0.6889
 Site-SVHN                      (4) | Val  Loss: 1.1396 | Val  Acc: 0.6543
 Site-MNIST_M                   (1) | Val  Loss: 1.4287 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8738
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.9412
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.8710
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.9107
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.9314
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.9344
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.9184
 Best site-MNIST                    (2)  | Epoch:18 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:18 | Val Acc: 0.8333
 Best site-MNIST                    (2)  | Epoch:18 | Val Acc: 0.8438
 Best site-MNIST                    (2)  | Epoch:18 | Val Acc: 0.8621
 Best site-MNIST                    (2)  | Epoch:18 | Val Acc: 0.9048
 Best site-MNIST                    (2)  | Epoch:18 | Val Acc: 0.9312
 Best site-SynthDigits              (3)  | Epoch:18 | Val Acc: 0.8649
 Best site-SynthDigits              (3)  | Epoch:18 | Val Acc: 0.8088
 Best site-SynthDigits              (3)  | Epoch:18 | Val Acc: 0.7951
 Best site-SVHN                     (4)  | Epoch:18 | Val Acc: 0.6889
 Best site-SVHN                     (4)  | Epoch:18 | Val Acc: 0.6543
 Best site-MNIST_M                  (1)  | Epoch:18 | Val Acc: 0.7286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 19 ============
cnt=[10, 2, 6, 1, 3, ]
cnt=[1, 6, 3, 3, 9, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-USPS                      (0) | Train Loss: 0.2446 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.1991 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.3559 | Train Acc: 0.9048
 Site-USPS                      (0) | Train Loss: 0.3149 | Train Acc: 0.9474
 Site-USPS                      (0) | Train Loss: 0.2348 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.3274 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.3678 | Train Acc: 0.8767
 Site-USPS                      (0) | Train Loss: 0.3179 | Train Acc: 0.9218
 Site-USPS                      (0) | Train Loss: 0.3356 | Train Acc: 0.9158
 Site-USPS                      (0) | Train Loss: 0.3137 | Train Acc: 0.9268
 Site-MNIST                     (2) | Train Loss: 0.3805 | Train Acc: 0.9250
 Site-MNIST                     (2) | Train Loss: 0.5304 | Train Acc: 0.8611
 Site-MNIST                     (2) | Train Loss: 0.3936 | Train Acc: 0.8837
 Site-MNIST                     (2) | Train Loss: 0.3460 | Train Acc: 0.9013
 Site-MNIST                     (2) | Train Loss: 0.4418 | Train Acc: 0.8905
 Site-MNIST                     (2) | Train Loss: 0.4164 | Train Acc: 0.8968
 Site-SynthDigits               (4) | Train Loss: 0.9148 | Train Acc: 0.6887
 Site-SynthDigits               (4) | Train Loss: 0.7328 | Train Acc: 0.7912
 Site-SynthDigits               (4) | Train Loss: 0.6973 | Train Acc: 0.8167
 Site-SVHN                      (1) | Train Loss: 1.2568 | Train Acc: 0.5801
 Site-SVHN                      (1) | Train Loss: 1.2200 | Train Acc: 0.5994
 Site-MNIST_M                   (3) | Train Loss: 1.1231 | Train Acc: 0.6702
Average Train Accuracy: 0.8584
 Site-USPS                      (0) | Val  Loss: 0.4907 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.3798 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.3916 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2699 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2588 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.2588 | Val  Acc: 0.8710
 Site-USPS                      (0) | Val  Loss: 0.2879 | Val  Acc: 0.8750
 Site-USPS                      (0) | Val  Loss: 0.3148 | Val  Acc: 0.9020
 Site-USPS                      (0) | Val  Loss: 0.3267 | Val  Acc: 0.9235
 Site-USPS                      (0) | Val  Loss: 0.3335 | Val  Acc: 0.9063
 Site-MNIST                     (2) | Val  Loss: 0.5776 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 0.4461 | Val  Acc: 0.8333
 Site-MNIST                     (2) | Val  Loss: 0.3708 | Val  Acc: 0.8750
 Site-MNIST                     (2) | Val  Loss: 0.4208 | Val  Acc: 0.8793
 Site-MNIST                     (2) | Val  Loss: 0.3606 | Val  Acc: 0.9238
 Site-MNIST                     (2) | Val  Loss: 0.3379 | Val  Acc: 0.9365
 Site-SynthDigits               (4) | Val  Loss: 0.7356 | Val  Acc: 0.8108
 Site-SynthDigits               (4) | Val  Loss: 0.5636 | Val  Acc: 0.7941
 Site-SynthDigits               (4) | Val  Loss: 0.7284 | Val  Acc: 0.7869
 Site-SVHN                      (1) | Val  Loss: 1.1275 | Val  Acc: 0.6222
 Site-SVHN                      (1) | Val  Loss: 1.1327 | Val  Acc: 0.6049
 Site-MNIST_M                   (3) | Val  Loss: 1.2845 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8643
============ Train epoch 20 ============
cnt=[6, 10, 2, 3, 1, ]
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-USPS                      (1) | Train Loss: 0.2455 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.2070 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.3504 | Train Acc: 0.9048
 Site-USPS                      (1) | Train Loss: 0.2991 | Train Acc: 0.9474
 Site-USPS                      (1) | Train Loss: 0.1951 | Train Acc: 0.9429
 Site-USPS                      (1) | Train Loss: 0.3273 | Train Acc: 0.9365
 Site-USPS                      (1) | Train Loss: 0.3725 | Train Acc: 0.8767
 Site-USPS                      (1) | Train Loss: 0.3094 | Train Acc: 0.9291
 Site-USPS                      (1) | Train Loss: 0.3265 | Train Acc: 0.9212
 Site-USPS                      (1) | Train Loss: 0.3066 | Train Acc: 0.9298
 Site-MNIST                     (0) | Train Loss: 0.3592 | Train Acc: 0.9250
 Site-MNIST                     (0) | Train Loss: 0.3361 | Train Acc: 0.9028
 Site-MNIST                     (0) | Train Loss: 0.4358 | Train Acc: 0.8760
 Site-MNIST                     (0) | Train Loss: 0.3308 | Train Acc: 0.9099
 Site-MNIST                     (0) | Train Loss: 0.4248 | Train Acc: 0.8952
 Site-MNIST                     (0) | Train Loss: 0.3947 | Train Acc: 0.9021
 Site-SynthDigits               (3) | Train Loss: 0.8555 | Train Acc: 0.7152
 Site-SynthDigits               (3) | Train Loss: 0.6958 | Train Acc: 0.8132
 Site-SynthDigits               (3) | Train Loss: 0.6676 | Train Acc: 0.8289
 Site-SVHN                      (2) | Train Loss: 1.1962 | Train Acc: 0.6354
 Site-SVHN                      (2) | Train Loss: 1.2606 | Train Acc: 0.6147
 Site-MNIST_M                   (4) | Train Loss: 1.1468 | Train Acc: 0.6667
Average Train Accuracy: 0.8670
 Site-USPS                      (1) | Val  Loss: 0.4397 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3318 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3513 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2478 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2445 | Val  Acc: 0.9412
 Site-USPS                      (1) | Val  Loss: 0.2482 | Val  Acc: 0.9032
 Site-USPS                      (1) | Val  Loss: 0.2786 | Val  Acc: 0.8929
 Site-USPS                      (1) | Val  Loss: 0.3077 | Val  Acc: 0.9314
 Site-USPS                      (1) | Val  Loss: 0.3169 | Val  Acc: 0.9399
 Site-USPS                      (1) | Val  Loss: 0.3240 | Val  Acc: 0.9033
 Site-MNIST                     (0) | Val  Loss: 0.5475 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4175 | Val  Acc: 0.8333
 Site-MNIST                     (0) | Val  Loss: 0.3416 | Val  Acc: 0.8750
 Site-MNIST                     (0) | Val  Loss: 0.4006 | Val  Acc: 0.8966
 Site-MNIST                     (0) | Val  Loss: 0.3464 | Val  Acc: 0.9238
 Site-MNIST                     (0) | Val  Loss: 0.3223 | Val  Acc: 0.9312
 Site-SynthDigits               (3) | Val  Loss: 0.7009 | Val  Acc: 0.7838
 Site-SynthDigits               (3) | Val  Loss: 0.5570 | Val  Acc: 0.8088
 Site-SynthDigits               (3) | Val  Loss: 0.7002 | Val  Acc: 0.8115
 Site-SVHN                      (2) | Val  Loss: 1.0922 | Val  Acc: 0.6667
 Site-SVHN                      (2) | Val  Loss: 1.0749 | Val  Acc: 0.6667
 Site-MNIST_M                   (4) | Val  Loss: 1.2933 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8744
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 0.9412
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 0.9032
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 0.8929
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 0.9314
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 0.9399
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 0.9033
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.8333
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.8750
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.8966
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9238
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9312
 Best site-SynthDigits              (3)  | Epoch:20 | Val Acc: 0.7838
 Best site-SynthDigits              (3)  | Epoch:20 | Val Acc: 0.8088
 Best site-SynthDigits              (3)  | Epoch:20 | Val Acc: 0.8115
 Best site-SVHN                     (2)  | Epoch:20 | Val Acc: 0.6667
 Best site-SVHN                     (2)  | Epoch:20 | Val Acc: 0.6667
 Best site-MNIST_M                  (4)  | Epoch:20 | Val Acc: 0.7286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 21 ============
cnt=[10, 6, 2, 3, 1, ]
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-USPS                      (0) | Train Loss: 0.2353 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.1984 | Train Acc: 0.9167
 Site-USPS                      (0) | Train Loss: 0.3435 | Train Acc: 0.9048
 Site-USPS                      (0) | Train Loss: 0.2875 | Train Acc: 0.9737
 Site-USPS                      (0) | Train Loss: 0.2038 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.3116 | Train Acc: 0.9365
 Site-USPS                      (0) | Train Loss: 0.3621 | Train Acc: 0.8811
 Site-USPS                      (0) | Train Loss: 0.2855 | Train Acc: 0.9315
 Site-USPS                      (0) | Train Loss: 0.3052 | Train Acc: 0.9185
 Site-USPS                      (0) | Train Loss: 0.2910 | Train Acc: 0.9351
 Site-MNIST                     (1) | Train Loss: 0.3345 | Train Acc: 0.9250
 Site-MNIST                     (1) | Train Loss: 0.3066 | Train Acc: 0.9028
 Site-MNIST                     (1) | Train Loss: 0.2560 | Train Acc: 0.8837
 Site-MNIST                     (1) | Train Loss: 0.3256 | Train Acc: 0.9185
 Site-MNIST                     (1) | Train Loss: 0.3992 | Train Acc: 0.9024
 Site-MNIST                     (1) | Train Loss: 0.3747 | Train Acc: 0.9074
 Site-SynthDigits               (3) | Train Loss: 0.8055 | Train Acc: 0.7086
 Site-SynthDigits               (3) | Train Loss: 0.6612 | Train Acc: 0.7985
 Site-SynthDigits               (3) | Train Loss: 0.6484 | Train Acc: 0.8411
 Site-SVHN                      (2) | Train Loss: 1.1848 | Train Acc: 0.6298
 Site-SVHN                      (2) | Train Loss: 1.1567 | Train Acc: 0.6422
 Site-MNIST_M                   (4) | Train Loss: 1.1392 | Train Acc: 0.6667
Average Train Accuracy: 0.8667
 Site-USPS                      (0) | Val  Loss: 0.4014 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.3277 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.3499 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2443 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2342 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.2307 | Val  Acc: 0.9032
 Site-USPS                      (0) | Val  Loss: 0.2628 | Val  Acc: 0.9107
 Site-USPS                      (0) | Val  Loss: 0.2895 | Val  Acc: 0.9216
 Site-USPS                      (0) | Val  Loss: 0.3005 | Val  Acc: 0.9399
 Site-USPS                      (0) | Val  Loss: 0.3100 | Val  Acc: 0.9184
 Site-MNIST                     (1) | Val  Loss: 0.4900 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.3763 | Val  Acc: 0.8889
 Site-MNIST                     (1) | Val  Loss: 0.3157 | Val  Acc: 0.9062
 Site-MNIST                     (1) | Val  Loss: 0.3790 | Val  Acc: 0.8966
 Site-MNIST                     (1) | Val  Loss: 0.3255 | Val  Acc: 0.9333
 Site-MNIST                     (1) | Val  Loss: 0.2972 | Val  Acc: 0.9365
 Site-SynthDigits               (3) | Val  Loss: 0.6741 | Val  Acc: 0.7838
 Site-SynthDigits               (3) | Val  Loss: 0.5262 | Val  Acc: 0.8382
 Site-SynthDigits               (3) | Val  Loss: 0.6806 | Val  Acc: 0.8115
 Site-SVHN                      (2) | Val  Loss: 1.0781 | Val  Acc: 0.6889
 Site-SVHN                      (2) | Val  Loss: 1.0517 | Val  Acc: 0.6667
 Site-MNIST_M                   (4) | Val  Loss: 1.2665 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8877
 Best site-USPS                     (0)  | Epoch:21 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:21 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:21 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:21 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:21 | Val Acc: 0.9412
 Best site-USPS                     (0)  | Epoch:21 | Val Acc: 0.9032
 Best site-USPS                     (0)  | Epoch:21 | Val Acc: 0.9107
 Best site-USPS                     (0)  | Epoch:21 | Val Acc: 0.9216
 Best site-USPS                     (0)  | Epoch:21 | Val Acc: 0.9399
 Best site-USPS                     (0)  | Epoch:21 | Val Acc: 0.9184
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9000
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.8889
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9062
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.8966
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9333
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9365
 Best site-SynthDigits              (3)  | Epoch:21 | Val Acc: 0.7838
 Best site-SynthDigits              (3)  | Epoch:21 | Val Acc: 0.8382
 Best site-SynthDigits              (3)  | Epoch:21 | Val Acc: 0.8115
 Best site-SVHN                     (2)  | Epoch:21 | Val Acc: 0.6889
 Best site-SVHN                     (2)  | Epoch:21 | Val Acc: 0.6667
 Best site-MNIST_M                  (4)  | Epoch:21 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 10, 6, 1, 3, ]
cnt=[6, 10, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-USPS                      (1) | Train Loss: 0.2361 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.2092 | Train Acc: 0.9167
 Site-USPS                      (1) | Train Loss: 0.3386 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.2808 | Train Acc: 0.9737
 Site-USPS                      (1) | Train Loss: 0.3130 | Train Acc: 0.9571
 Site-USPS                      (1) | Train Loss: 0.3092 | Train Acc: 0.9365
 Site-USPS                      (1) | Train Loss: 0.3420 | Train Acc: 0.8855
 Site-USPS                      (1) | Train Loss: 0.2925 | Train Acc: 0.9389
 Site-USPS                      (1) | Train Loss: 0.3087 | Train Acc: 0.9239
 Site-USPS                      (1) | Train Loss: 0.2854 | Train Acc: 0.9351
 Site-MNIST                     (2) | Train Loss: 0.3131 | Train Acc: 0.9250
 Site-MNIST                     (2) | Train Loss: 0.4378 | Train Acc: 0.9167
 Site-MNIST                     (2) | Train Loss: 0.2764 | Train Acc: 0.8992
 Site-MNIST                     (2) | Train Loss: 0.3098 | Train Acc: 0.9227
 Site-MNIST                     (2) | Train Loss: 0.3819 | Train Acc: 0.9071
 Site-MNIST                     (2) | Train Loss: 0.3618 | Train Acc: 0.9127
 Site-SynthDigits               (4) | Train Loss: 0.8848 | Train Acc: 0.7219
 Site-SynthDigits               (4) | Train Loss: 0.6907 | Train Acc: 0.8278
 Site-SynthDigits               (4) | Train Loss: 0.6185 | Train Acc: 0.8432
 Site-SVHN                      (0) | Train Loss: 1.1356 | Train Acc: 0.6298
 Site-SVHN                      (0) | Train Loss: 1.0930 | Train Acc: 0.6330
 Site-MNIST_M                   (3) | Train Loss: 1.0954 | Train Acc: 0.6773
Average Train Accuracy: 0.8744
 Site-USPS                      (1) | Val  Loss: 0.3455 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2970 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3317 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2296 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2315 | Val  Acc: 0.9412
 Site-USPS                      (1) | Val  Loss: 0.2280 | Val  Acc: 0.9032
 Site-USPS                      (1) | Val  Loss: 0.2573 | Val  Acc: 0.9107
 Site-USPS                      (1) | Val  Loss: 0.2824 | Val  Acc: 0.9412
 Site-USPS                      (1) | Val  Loss: 0.2914 | Val  Acc: 0.9399
 Site-USPS                      (1) | Val  Loss: 0.3022 | Val  Acc: 0.9184
 Site-MNIST                     (2) | Val  Loss: 0.4647 | Val  Acc: 0.9000
 Site-MNIST                     (2) | Val  Loss: 0.3658 | Val  Acc: 0.8889
 Site-MNIST                     (2) | Val  Loss: 0.2991 | Val  Acc: 0.9062
 Site-MNIST                     (2) | Val  Loss: 0.3631 | Val  Acc: 0.8966
 Site-MNIST                     (2) | Val  Loss: 0.3119 | Val  Acc: 0.9333
 Site-MNIST                     (2) | Val  Loss: 0.2844 | Val  Acc: 0.9365
 Site-SynthDigits               (4) | Val  Loss: 0.6418 | Val  Acc: 0.8378
 Site-SynthDigits               (4) | Val  Loss: 0.4966 | Val  Acc: 0.8382
 Site-SynthDigits               (4) | Val  Loss: 0.6576 | Val  Acc: 0.8115
 Site-SVHN                      (0) | Val  Loss: 1.0328 | Val  Acc: 0.6667
 Site-SVHN                      (0) | Val  Loss: 1.0107 | Val  Acc: 0.6667
 Site-MNIST_M                   (3) | Val  Loss: 1.2485 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8900
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 0.9412
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 0.9032
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 0.9107
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 0.9412
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 0.9399
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 0.9184
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9000
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.8889
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9062
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.8966
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9333
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9365
 Best site-SynthDigits              (4)  | Epoch:22 | Val Acc: 0.8378
 Best site-SynthDigits              (4)  | Epoch:22 | Val Acc: 0.8382
 Best site-SynthDigits              (4)  | Epoch:22 | Val Acc: 0.8115
 Best site-SVHN                     (0)  | Epoch:22 | Val Acc: 0.6667
 Best site-SVHN                     (0)  | Epoch:22 | Val Acc: 0.6667
 Best site-MNIST_M                  (3)  | Epoch:22 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 23 ============
cnt=[2, 10, 6, 1, 3, ]
cnt=[1, 6, 9, 3, 3, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-USPS                      (1) | Train Loss: 0.2215 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.1879 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.3433 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.2724 | Train Acc: 0.9474
 Site-USPS                      (1) | Train Loss: 0.2189 | Train Acc: 0.9429
 Site-USPS                      (1) | Train Loss: 0.3038 | Train Acc: 0.9365
 Site-USPS                      (1) | Train Loss: 0.3536 | Train Acc: 0.8811
 Site-USPS                      (1) | Train Loss: 0.2824 | Train Acc: 0.9291
 Site-USPS                      (1) | Train Loss: 0.3021 | Train Acc: 0.9212
 Site-USPS                      (1) | Train Loss: 0.2803 | Train Acc: 0.9313
 Site-MNIST                     (2) | Train Loss: 0.3134 | Train Acc: 0.9250
 Site-MNIST                     (2) | Train Loss: 0.2666 | Train Acc: 0.9306
 Site-MNIST                     (2) | Train Loss: 0.2721 | Train Acc: 0.8915
 Site-MNIST                     (2) | Train Loss: 0.2963 | Train Acc: 0.9313
 Site-MNIST                     (2) | Train Loss: 0.3683 | Train Acc: 0.9143
 Site-MNIST                     (2) | Train Loss: 0.3525 | Train Acc: 0.9127
 Site-SynthDigits               (4) | Train Loss: 0.8280 | Train Acc: 0.7285
 Site-SynthDigits               (4) | Train Loss: 0.6556 | Train Acc: 0.8278
 Site-SynthDigits               (4) | Train Loss: 0.6147 | Train Acc: 0.8473
 Site-SVHN                      (0) | Train Loss: 1.1576 | Train Acc: 0.6133
 Site-SVHN                      (0) | Train Loss: 1.1138 | Train Acc: 0.6544
 Site-MNIST_M                   (3) | Train Loss: 1.0305 | Train Acc: 0.7057
Average Train Accuracy: 0.8784
 Site-USPS                      (1) | Val  Loss: 0.3548 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2760 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.3094 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2143 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2162 | Val  Acc: 0.9412
 Site-USPS                      (1) | Val  Loss: 0.2196 | Val  Acc: 0.9032
 Site-USPS                      (1) | Val  Loss: 0.2516 | Val  Acc: 0.8929
 Site-USPS                      (1) | Val  Loss: 0.2758 | Val  Acc: 0.9216
 Site-USPS                      (1) | Val  Loss: 0.2872 | Val  Acc: 0.9235
 Site-USPS                      (1) | Val  Loss: 0.2975 | Val  Acc: 0.9033
 Site-MNIST                     (2) | Val  Loss: 0.4481 | Val  Acc: 0.9000
 Site-MNIST                     (2) | Val  Loss: 0.3586 | Val  Acc: 0.8889
 Site-MNIST                     (2) | Val  Loss: 0.2885 | Val  Acc: 0.9062
 Site-MNIST                     (2) | Val  Loss: 0.3559 | Val  Acc: 0.8966
 Site-MNIST                     (2) | Val  Loss: 0.3024 | Val  Acc: 0.9429
 Site-MNIST                     (2) | Val  Loss: 0.2756 | Val  Acc: 0.9418
 Site-SynthDigits               (4) | Val  Loss: 0.6314 | Val  Acc: 0.8649
 Site-SynthDigits               (4) | Val  Loss: 0.4722 | Val  Acc: 0.8088
 Site-SynthDigits               (4) | Val  Loss: 0.6297 | Val  Acc: 0.8361
 Site-SVHN                      (0) | Val  Loss: 1.0339 | Val  Acc: 0.6667
 Site-SVHN                      (0) | Val  Loss: 1.0161 | Val  Acc: 0.6543
 Site-MNIST_M                   (3) | Val  Loss: 1.1627 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8906
 Best site-USPS                     (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:23 | Val Acc: 0.9412
 Best site-USPS                     (1)  | Epoch:23 | Val Acc: 0.9032
 Best site-USPS                     (1)  | Epoch:23 | Val Acc: 0.8929
 Best site-USPS                     (1)  | Epoch:23 | Val Acc: 0.9216
 Best site-USPS                     (1)  | Epoch:23 | Val Acc: 0.9235
 Best site-USPS                     (1)  | Epoch:23 | Val Acc: 0.9033
 Best site-MNIST                    (2)  | Epoch:23 | Val Acc: 0.9000
 Best site-MNIST                    (2)  | Epoch:23 | Val Acc: 0.8889
 Best site-MNIST                    (2)  | Epoch:23 | Val Acc: 0.9062
 Best site-MNIST                    (2)  | Epoch:23 | Val Acc: 0.8966
 Best site-MNIST                    (2)  | Epoch:23 | Val Acc: 0.9429
 Best site-MNIST                    (2)  | Epoch:23 | Val Acc: 0.9418
 Best site-SynthDigits              (4)  | Epoch:23 | Val Acc: 0.8649
 Best site-SynthDigits              (4)  | Epoch:23 | Val Acc: 0.8088
 Best site-SynthDigits              (4)  | Epoch:23 | Val Acc: 0.8361
 Best site-SVHN                     (0)  | Epoch:23 | Val Acc: 0.6667
 Best site-SVHN                     (0)  | Epoch:23 | Val Acc: 0.6543
 Best site-MNIST_M                  (3)  | Epoch:23 | Val Acc: 0.8000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 24 ============
cnt=[3, 10, 6, 1, 2, ]
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-USPS                      (1) | Train Loss: 0.2056 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.1789 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.3262 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.2667 | Train Acc: 0.9474
 Site-USPS                      (1) | Train Loss: 0.2844 | Train Acc: 0.9429
 Site-USPS                      (1) | Train Loss: 0.2992 | Train Acc: 0.9286
 Site-USPS                      (1) | Train Loss: 0.3572 | Train Acc: 0.8767
 Site-USPS                      (1) | Train Loss: 0.2734 | Train Acc: 0.9340
 Site-USPS                      (1) | Train Loss: 0.2939 | Train Acc: 0.9226
 Site-USPS                      (1) | Train Loss: 0.2761 | Train Acc: 0.9328
 Site-MNIST                     (2) | Train Loss: 0.2926 | Train Acc: 0.9250
 Site-MNIST                     (2) | Train Loss: 0.5504 | Train Acc: 0.9306
 Site-MNIST                     (2) | Train Loss: 0.2562 | Train Acc: 0.8992
 Site-MNIST                     (2) | Train Loss: 0.2839 | Train Acc: 0.9313
 Site-MNIST                     (2) | Train Loss: 0.3612 | Train Acc: 0.9143
 Site-MNIST                     (2) | Train Loss: 0.3400 | Train Acc: 0.9193
 Site-SynthDigits               (0) | Train Loss: 0.7690 | Train Acc: 0.7351
 Site-SynthDigits               (0) | Train Loss: 0.6870 | Train Acc: 0.8462
 Site-SynthDigits               (0) | Train Loss: 0.5926 | Train Acc: 0.8473
 Site-SVHN                      (4) | Train Loss: 1.1218 | Train Acc: 0.6133
 Site-SVHN                      (4) | Train Loss: 1.0932 | Train Acc: 0.6483
 Site-MNIST_M                   (3) | Train Loss: 1.0153 | Train Acc: 0.7234
Average Train Accuracy: 0.8805
 Site-USPS                      (1) | Val  Loss: 0.3177 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2523 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2962 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2049 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2126 | Val  Acc: 0.9412
 Site-USPS                      (1) | Val  Loss: 0.2153 | Val  Acc: 0.9032
 Site-USPS                      (1) | Val  Loss: 0.2470 | Val  Acc: 0.8929
 Site-USPS                      (1) | Val  Loss: 0.2692 | Val  Acc: 0.9216
 Site-USPS                      (1) | Val  Loss: 0.2791 | Val  Acc: 0.9344
 Site-USPS                      (1) | Val  Loss: 0.2908 | Val  Acc: 0.9033
 Site-MNIST                     (2) | Val  Loss: 0.4350 | Val  Acc: 0.9000
 Site-MNIST                     (2) | Val  Loss: 0.3403 | Val  Acc: 0.8889
 Site-MNIST                     (2) | Val  Loss: 0.2718 | Val  Acc: 0.9062
 Site-MNIST                     (2) | Val  Loss: 0.3422 | Val  Acc: 0.8966
 Site-MNIST                     (2) | Val  Loss: 0.2953 | Val  Acc: 0.9333
 Site-MNIST                     (2) | Val  Loss: 0.2667 | Val  Acc: 0.9418
 Site-SynthDigits               (0) | Val  Loss: 0.6098 | Val  Acc: 0.8649
 Site-SynthDigits               (0) | Val  Loss: 0.4539 | Val  Acc: 0.8382
 Site-SynthDigits               (0) | Val  Loss: 0.6106 | Val  Acc: 0.8197
 Site-SVHN                      (4) | Val  Loss: 1.0105 | Val  Acc: 0.6444
 Site-SVHN                      (4) | Val  Loss: 0.9918 | Val  Acc: 0.6420
 Site-MNIST_M                   (3) | Val  Loss: 1.1644 | Val  Acc: 0.8143
Average Valid Accuracy: 0.8903
============ Train epoch 25 ============
cnt=[1, 10, 3, 6, 2, ]
cnt=[10, 6, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-USPS                      (1) | Train Loss: 0.1985 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.1813 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.3142 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.2694 | Train Acc: 0.9211
 Site-USPS                      (1) | Train Loss: 0.2060 | Train Acc: 0.9571
 Site-USPS                      (1) | Train Loss: 0.2949 | Train Acc: 0.9286
 Site-USPS                      (1) | Train Loss: 0.3395 | Train Acc: 0.8767
 Site-USPS                      (1) | Train Loss: 0.2786 | Train Acc: 0.9364
 Site-USPS                      (1) | Train Loss: 0.2875 | Train Acc: 0.9253
 Site-USPS                      (1) | Train Loss: 0.2706 | Train Acc: 0.9366
 Site-MNIST                     (3) | Train Loss: 0.2850 | Train Acc: 0.9250
 Site-MNIST                     (3) | Train Loss: 0.2240 | Train Acc: 0.9306
 Site-MNIST                     (3) | Train Loss: 0.2995 | Train Acc: 0.8915
 Site-MNIST                     (3) | Train Loss: 0.2911 | Train Acc: 0.9313
 Site-MNIST                     (3) | Train Loss: 0.3505 | Train Acc: 0.9262
 Site-MNIST                     (3) | Train Loss: 0.3300 | Train Acc: 0.9220
 Site-SynthDigits               (2) | Train Loss: 0.7140 | Train Acc: 0.7483
 Site-SynthDigits               (2) | Train Loss: 0.5895 | Train Acc: 0.8645
 Site-SynthDigits               (2) | Train Loss: 0.5687 | Train Acc: 0.8676
 Site-SVHN                      (4) | Train Loss: 1.0728 | Train Acc: 0.6575
 Site-SVHN                      (4) | Train Loss: 1.0638 | Train Acc: 0.6697
 Site-MNIST_M                   (0) | Train Loss: 1.0165 | Train Acc: 0.7163
Average Train Accuracy: 0.8857
 Site-USPS                      (1) | Val  Loss: 0.3005 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2432 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2875 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1995 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2112 | Val  Acc: 0.9412
 Site-USPS                      (1) | Val  Loss: 0.2151 | Val  Acc: 0.9032
 Site-USPS                      (1) | Val  Loss: 0.2429 | Val  Acc: 0.9107
 Site-USPS                      (1) | Val  Loss: 0.2692 | Val  Acc: 0.9216
 Site-USPS                      (1) | Val  Loss: 0.2740 | Val  Acc: 0.9399
 Site-USPS                      (1) | Val  Loss: 0.2853 | Val  Acc: 0.9094
 Site-MNIST                     (3) | Val  Loss: 0.4389 | Val  Acc: 0.9000
 Site-MNIST                     (3) | Val  Loss: 0.3390 | Val  Acc: 0.8889
 Site-MNIST                     (3) | Val  Loss: 0.2696 | Val  Acc: 0.9062
 Site-MNIST                     (3) | Val  Loss: 0.3371 | Val  Acc: 0.8966
 Site-MNIST                     (3) | Val  Loss: 0.2912 | Val  Acc: 0.9333
 Site-MNIST                     (3) | Val  Loss: 0.2619 | Val  Acc: 0.9365
 Site-SynthDigits               (2) | Val  Loss: 0.5816 | Val  Acc: 0.8649
 Site-SynthDigits               (2) | Val  Loss: 0.4419 | Val  Acc: 0.8382
 Site-SynthDigits               (2) | Val  Loss: 0.5987 | Val  Acc: 0.8197
 Site-SVHN                      (4) | Val  Loss: 0.9606 | Val  Acc: 0.6889
 Site-SVHN                      (4) | Val  Loss: 0.9353 | Val  Acc: 0.7037
 Site-MNIST_M                   (0) | Val  Loss: 1.1740 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8943
 Best site-USPS                     (1)  | Epoch:25 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:25 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:25 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:25 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:25 | Val Acc: 0.9412
 Best site-USPS                     (1)  | Epoch:25 | Val Acc: 0.9032
 Best site-USPS                     (1)  | Epoch:25 | Val Acc: 0.9107
 Best site-USPS                     (1)  | Epoch:25 | Val Acc: 0.9216
 Best site-USPS                     (1)  | Epoch:25 | Val Acc: 0.9399
 Best site-USPS                     (1)  | Epoch:25 | Val Acc: 0.9094
 Best site-MNIST                    (3)  | Epoch:25 | Val Acc: 0.9000
 Best site-MNIST                    (3)  | Epoch:25 | Val Acc: 0.8889
 Best site-MNIST                    (3)  | Epoch:25 | Val Acc: 0.9062
 Best site-MNIST                    (3)  | Epoch:25 | Val Acc: 0.8966
 Best site-MNIST                    (3)  | Epoch:25 | Val Acc: 0.9333
 Best site-MNIST                    (3)  | Epoch:25 | Val Acc: 0.9365
 Best site-SynthDigits              (2)  | Epoch:25 | Val Acc: 0.8649
 Best site-SynthDigits              (2)  | Epoch:25 | Val Acc: 0.8382
 Best site-SynthDigits              (2)  | Epoch:25 | Val Acc: 0.8197
 Best site-SVHN                     (4)  | Epoch:25 | Val Acc: 0.6889
 Best site-SVHN                     (4)  | Epoch:25 | Val Acc: 0.7037
 Best site-MNIST_M                  (0)  | Epoch:25 | Val Acc: 0.7714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 26 ============
cnt=[10, 2, 6, 1, 3, ]
cnt=[2, 10, 3, 6, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-USPS                      (0) | Train Loss: 0.1985 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.1596 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.3252 | Train Acc: 0.9524
 Site-USPS                      (0) | Train Loss: 0.2530 | Train Acc: 0.9474
 Site-USPS                      (0) | Train Loss: 0.1995 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.2841 | Train Acc: 0.9365
 Site-USPS                      (0) | Train Loss: 0.3174 | Train Acc: 0.8767
 Site-USPS                      (0) | Train Loss: 0.2690 | Train Acc: 0.9389
 Site-USPS                      (0) | Train Loss: 0.2743 | Train Acc: 0.9226
 Site-USPS                      (0) | Train Loss: 0.2582 | Train Acc: 0.9381
 Site-MNIST                     (2) | Train Loss: 0.2760 | Train Acc: 0.9250
 Site-MNIST                     (2) | Train Loss: 0.4087 | Train Acc: 0.9306
 Site-MNIST                     (2) | Train Loss: 0.2514 | Train Acc: 0.9070
 Site-MNIST                     (2) | Train Loss: 0.2608 | Train Acc: 0.9313
 Site-MNIST                     (2) | Train Loss: 0.3380 | Train Acc: 0.9167
 Site-MNIST                     (2) | Train Loss: 0.3248 | Train Acc: 0.9220
 Site-SynthDigits               (4) | Train Loss: 0.7035 | Train Acc: 0.7616
 Site-SynthDigits               (4) | Train Loss: 0.6161 | Train Acc: 0.8608
 Site-SynthDigits               (4) | Train Loss: 0.5597 | Train Acc: 0.8656
 Site-SVHN                      (1) | Train Loss: 1.0793 | Train Acc: 0.6464
 Site-SVHN                      (1) | Train Loss: 1.0709 | Train Acc: 0.6575
 Site-MNIST_M                   (3) | Train Loss: 0.9697 | Train Acc: 0.7518
Average Train Accuracy: 0.8878
 Site-USPS                      (0) | Val  Loss: 0.3089 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2358 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2706 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1842 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1909 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.1976 | Val  Acc: 0.9032
 Site-USPS                      (0) | Val  Loss: 0.2291 | Val  Acc: 0.9107
 Site-USPS                      (0) | Val  Loss: 0.2554 | Val  Acc: 0.9216
 Site-USPS                      (0) | Val  Loss: 0.2642 | Val  Acc: 0.9399
 Site-USPS                      (0) | Val  Loss: 0.2754 | Val  Acc: 0.9094
 Site-MNIST                     (2) | Val  Loss: 0.4070 | Val  Acc: 0.9000
 Site-MNIST                     (2) | Val  Loss: 0.3254 | Val  Acc: 0.8889
 Site-MNIST                     (2) | Val  Loss: 0.2578 | Val  Acc: 0.9062
 Site-MNIST                     (2) | Val  Loss: 0.3288 | Val  Acc: 0.8966
 Site-MNIST                     (2) | Val  Loss: 0.2766 | Val  Acc: 0.9429
 Site-MNIST                     (2) | Val  Loss: 0.2487 | Val  Acc: 0.9418
 Site-SynthDigits               (4) | Val  Loss: 0.5721 | Val  Acc: 0.8649
 Site-SynthDigits               (4) | Val  Loss: 0.4252 | Val  Acc: 0.8824
 Site-SynthDigits               (4) | Val  Loss: 0.5811 | Val  Acc: 0.8525
 Site-SVHN                      (1) | Val  Loss: 0.9668 | Val  Acc: 0.6222
 Site-SVHN                      (1) | Val  Loss: 0.9520 | Val  Acc: 0.6914
 Site-MNIST_M                   (3) | Val  Loss: 1.0974 | Val  Acc: 0.8143
Average Valid Accuracy: 0.8968
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.9412
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.9032
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.9107
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.9216
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.9399
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.9094
 Best site-MNIST                    (2)  | Epoch:26 | Val Acc: 0.9000
 Best site-MNIST                    (2)  | Epoch:26 | Val Acc: 0.8889
 Best site-MNIST                    (2)  | Epoch:26 | Val Acc: 0.9062
 Best site-MNIST                    (2)  | Epoch:26 | Val Acc: 0.8966
 Best site-MNIST                    (2)  | Epoch:26 | Val Acc: 0.9429
 Best site-MNIST                    (2)  | Epoch:26 | Val Acc: 0.9418
 Best site-SynthDigits              (4)  | Epoch:26 | Val Acc: 0.8649
 Best site-SynthDigits              (4)  | Epoch:26 | Val Acc: 0.8824
 Best site-SynthDigits              (4)  | Epoch:26 | Val Acc: 0.8525
 Best site-SVHN                     (1)  | Epoch:26 | Val Acc: 0.6222
 Best site-SVHN                     (1)  | Epoch:26 | Val Acc: 0.6914
 Best site-MNIST_M                  (3)  | Epoch:26 | Val Acc: 0.8143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 27 ============
cnt=[10, 2, 6, 3, 1, ]
cnt=[6, 10, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-USPS                      (0) | Train Loss: 0.2003 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.1925 | Train Acc: 0.9167
 Site-USPS                      (0) | Train Loss: 0.3175 | Train Acc: 0.9524
 Site-USPS                      (0) | Train Loss: 0.2530 | Train Acc: 0.9737
 Site-USPS                      (0) | Train Loss: 0.3028 | Train Acc: 0.9571
 Site-USPS                      (0) | Train Loss: 0.2787 | Train Acc: 0.9365
 Site-USPS                      (0) | Train Loss: 0.3202 | Train Acc: 0.8943
 Site-USPS                      (0) | Train Loss: 0.2482 | Train Acc: 0.9413
 Site-USPS                      (0) | Train Loss: 0.2669 | Train Acc: 0.9266
 Site-USPS                      (0) | Train Loss: 0.2513 | Train Acc: 0.9404
 Site-MNIST                     (2) | Train Loss: 0.2646 | Train Acc: 0.9500
 Site-MNIST                     (2) | Train Loss: 0.4581 | Train Acc: 0.9444
 Site-MNIST                     (2) | Train Loss: 0.2797 | Train Acc: 0.9070
 Site-MNIST                     (2) | Train Loss: 0.2516 | Train Acc: 0.9356
 Site-MNIST                     (2) | Train Loss: 0.3412 | Train Acc: 0.9190
 Site-MNIST                     (2) | Train Loss: 0.3142 | Train Acc: 0.9233
 Site-SynthDigits               (3) | Train Loss: 0.6756 | Train Acc: 0.7682
 Site-SynthDigits               (3) | Train Loss: 0.5636 | Train Acc: 0.8718
 Site-SynthDigits               (3) | Train Loss: 0.5345 | Train Acc: 0.8758
 Site-SVHN                      (1) | Train Loss: 1.0511 | Train Acc: 0.6685
 Site-SVHN                      (1) | Train Loss: 0.9787 | Train Acc: 0.6820
 Site-MNIST_M                   (4) | Train Loss: 0.9303 | Train Acc: 0.7553
Average Train Accuracy: 0.8927
 Site-USPS                      (0) | Val  Loss: 0.2883 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2304 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2634 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1778 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1841 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.1839 | Val  Acc: 0.9355
 Site-USPS                      (0) | Val  Loss: 0.2166 | Val  Acc: 0.9286
 Site-USPS                      (0) | Val  Loss: 0.2424 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.2540 | Val  Acc: 0.9399
 Site-USPS                      (0) | Val  Loss: 0.2666 | Val  Acc: 0.9124
 Site-MNIST                     (2) | Val  Loss: 0.3554 | Val  Acc: 0.9000
 Site-MNIST                     (2) | Val  Loss: 0.2907 | Val  Acc: 0.9444
 Site-MNIST                     (2) | Val  Loss: 0.2392 | Val  Acc: 0.9375
 Site-MNIST                     (2) | Val  Loss: 0.3118 | Val  Acc: 0.8966
 Site-MNIST                     (2) | Val  Loss: 0.2651 | Val  Acc: 0.9429
 Site-MNIST                     (2) | Val  Loss: 0.2346 | Val  Acc: 0.9418
 Site-SynthDigits               (3) | Val  Loss: 0.5533 | Val  Acc: 0.8649
 Site-SynthDigits               (3) | Val  Loss: 0.4078 | Val  Acc: 0.8676
 Site-SynthDigits               (3) | Val  Loss: 0.5650 | Val  Acc: 0.8279
 Site-SVHN                      (1) | Val  Loss: 0.9444 | Val  Acc: 0.6444
 Site-SVHN                      (1) | Val  Loss: 0.9019 | Val  Acc: 0.6790
 Site-MNIST_M                   (4) | Val  Loss: 1.1227 | Val  Acc: 0.8143
Average Valid Accuracy: 0.9027
 Best site-USPS                     (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:27 | Val Acc: 0.9412
 Best site-USPS                     (0)  | Epoch:27 | Val Acc: 0.9355
 Best site-USPS                     (0)  | Epoch:27 | Val Acc: 0.9286
 Best site-USPS                     (0)  | Epoch:27 | Val Acc: 0.9412
 Best site-USPS                     (0)  | Epoch:27 | Val Acc: 0.9399
 Best site-USPS                     (0)  | Epoch:27 | Val Acc: 0.9124
 Best site-MNIST                    (2)  | Epoch:27 | Val Acc: 0.9000
 Best site-MNIST                    (2)  | Epoch:27 | Val Acc: 0.9444
 Best site-MNIST                    (2)  | Epoch:27 | Val Acc: 0.9375
 Best site-MNIST                    (2)  | Epoch:27 | Val Acc: 0.8966
 Best site-MNIST                    (2)  | Epoch:27 | Val Acc: 0.9429
 Best site-MNIST                    (2)  | Epoch:27 | Val Acc: 0.9418
 Best site-SynthDigits              (3)  | Epoch:27 | Val Acc: 0.8649
 Best site-SynthDigits              (3)  | Epoch:27 | Val Acc: 0.8676
 Best site-SynthDigits              (3)  | Epoch:27 | Val Acc: 0.8279
 Best site-SVHN                     (1)  | Epoch:27 | Val Acc: 0.6444
 Best site-SVHN                     (1)  | Epoch:27 | Val Acc: 0.6790
 Best site-MNIST_M                  (4)  | Epoch:27 | Val Acc: 0.8143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 28 ============
cnt=[1, 10, 3, 6, 2, ]
cnt=[1, 10, 6, 3, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-USPS                      (1) | Train Loss: 0.1817 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.1719 | Train Acc: 0.9167
 Site-USPS                      (1) | Train Loss: 0.3119 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.2426 | Train Acc: 0.9737
 Site-USPS                      (1) | Train Loss: 0.1920 | Train Acc: 0.9571
 Site-USPS                      (1) | Train Loss: 0.2691 | Train Acc: 0.9365
 Site-USPS                      (1) | Train Loss: 0.3059 | Train Acc: 0.8855
 Site-USPS                      (1) | Train Loss: 0.2595 | Train Acc: 0.9413
 Site-USPS                      (1) | Train Loss: 0.2620 | Train Acc: 0.9266
 Site-USPS                      (1) | Train Loss: 0.2410 | Train Acc: 0.9442
 Site-MNIST                     (3) | Train Loss: 0.2695 | Train Acc: 0.9250
 Site-MNIST                     (3) | Train Loss: 0.3509 | Train Acc: 0.9306
 Site-MNIST                     (3) | Train Loss: 0.4726 | Train Acc: 0.9070
 Site-MNIST                     (3) | Train Loss: 0.2563 | Train Acc: 0.9356
 Site-MNIST                     (3) | Train Loss: 0.3267 | Train Acc: 0.9119
 Site-MNIST                     (3) | Train Loss: 0.3117 | Train Acc: 0.9233
 Site-SynthDigits               (2) | Train Loss: 0.7448 | Train Acc: 0.7748
 Site-SynthDigits               (2) | Train Loss: 0.5356 | Train Acc: 0.8864
 Site-SynthDigits               (2) | Train Loss: 0.5278 | Train Acc: 0.8798
 Site-SVHN                      (4) | Train Loss: 1.0231 | Train Acc: 0.6519
 Site-SVHN                      (4) | Train Loss: 1.0172 | Train Acc: 0.6789
 Site-MNIST_M                   (0) | Train Loss: 0.9257 | Train Acc: 0.7340
Average Train Accuracy: 0.8897
 Site-USPS                      (1) | Val  Loss: 0.3138 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2339 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2596 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1694 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1713 | Val  Acc: 0.9412
 Site-USPS                      (1) | Val  Loss: 0.1753 | Val  Acc: 0.9355
 Site-USPS                      (1) | Val  Loss: 0.2082 | Val  Acc: 0.9286
 Site-USPS                      (1) | Val  Loss: 0.2366 | Val  Acc: 0.9412
 Site-USPS                      (1) | Val  Loss: 0.2494 | Val  Acc: 0.9454
 Site-USPS                      (1) | Val  Loss: 0.2601 | Val  Acc: 0.9124
 Site-MNIST                     (3) | Val  Loss: 0.3668 | Val  Acc: 0.9000
 Site-MNIST                     (3) | Val  Loss: 0.3034 | Val  Acc: 0.8889
 Site-MNIST                     (3) | Val  Loss: 0.2466 | Val  Acc: 0.9062
 Site-MNIST                     (3) | Val  Loss: 0.3132 | Val  Acc: 0.8966
 Site-MNIST                     (3) | Val  Loss: 0.2577 | Val  Acc: 0.9429
 Site-MNIST                     (3) | Val  Loss: 0.2302 | Val  Acc: 0.9418
 Site-SynthDigits               (2) | Val  Loss: 0.5298 | Val  Acc: 0.8649
 Site-SynthDigits               (2) | Val  Loss: 0.3835 | Val  Acc: 0.8971
 Site-SynthDigits               (2) | Val  Loss: 0.5439 | Val  Acc: 0.8607
 Site-SVHN                      (4) | Val  Loss: 0.9318 | Val  Acc: 0.6444
 Site-SVHN                      (4) | Val  Loss: 0.8954 | Val  Acc: 0.6790
 Site-MNIST_M                   (0) | Val  Loss: 1.0798 | Val  Acc: 0.8143
Average Valid Accuracy: 0.9019
============ Train epoch 29 ============
cnt=[10, 2, 6, 1, 3, ]
cnt=[6, 10, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-USPS                      (0) | Train Loss: 0.1812 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.1647 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.3162 | Train Acc: 0.9524
 Site-USPS                      (0) | Train Loss: 0.2393 | Train Acc: 0.9737
 Site-USPS                      (0) | Train Loss: 0.1678 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.2589 | Train Acc: 0.9365
 Site-USPS                      (0) | Train Loss: 0.2961 | Train Acc: 0.8987
 Site-USPS                      (0) | Train Loss: 0.2367 | Train Acc: 0.9413
 Site-USPS                      (0) | Train Loss: 0.2575 | Train Acc: 0.9239
 Site-USPS                      (0) | Train Loss: 0.2333 | Train Acc: 0.9449
 Site-MNIST                     (2) | Train Loss: 0.2494 | Train Acc: 0.9500
 Site-MNIST                     (2) | Train Loss: 0.1733 | Train Acc: 0.9306
 Site-MNIST                     (2) | Train Loss: 0.2191 | Train Acc: 0.9225
 Site-MNIST                     (2) | Train Loss: 0.2339 | Train Acc: 0.9399
 Site-MNIST                     (2) | Train Loss: 0.3171 | Train Acc: 0.9119
 Site-MNIST                     (2) | Train Loss: 0.3037 | Train Acc: 0.9246
 Site-SynthDigits               (4) | Train Loss: 0.7018 | Train Acc: 0.7748
 Site-SynthDigits               (4) | Train Loss: 0.5332 | Train Acc: 0.8791
 Site-SynthDigits               (4) | Train Loss: 0.5212 | Train Acc: 0.8697
 Site-SVHN                      (1) | Train Loss: 1.0012 | Train Acc: 0.6630
 Site-SVHN                      (1) | Train Loss: 0.9729 | Train Acc: 0.7034
 Site-MNIST_M                   (3) | Train Loss: 0.9003 | Train Acc: 0.7482
Average Train Accuracy: 0.8969
 Site-USPS                      (0) | Val  Loss: 0.3184 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2411 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2598 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1713 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1739 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.1721 | Val  Acc: 0.9355
 Site-USPS                      (0) | Val  Loss: 0.2043 | Val  Acc: 0.9286
 Site-USPS                      (0) | Val  Loss: 0.2306 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.2433 | Val  Acc: 0.9454
 Site-USPS                      (0) | Val  Loss: 0.2522 | Val  Acc: 0.9275
 Site-MNIST                     (2) | Val  Loss: 0.3363 | Val  Acc: 0.9000
 Site-MNIST                     (2) | Val  Loss: 0.2785 | Val  Acc: 0.9444
 Site-MNIST                     (2) | Val  Loss: 0.2303 | Val  Acc: 0.9375
 Site-MNIST                     (2) | Val  Loss: 0.3031 | Val  Acc: 0.9138
 Site-MNIST                     (2) | Val  Loss: 0.2500 | Val  Acc: 0.9524
 Site-MNIST                     (2) | Val  Loss: 0.2177 | Val  Acc: 0.9524
 Site-SynthDigits               (4) | Val  Loss: 0.5151 | Val  Acc: 0.8919
 Site-SynthDigits               (4) | Val  Loss: 0.3857 | Val  Acc: 0.8824
 Site-SynthDigits               (4) | Val  Loss: 0.5443 | Val  Acc: 0.8525
 Site-SVHN                      (1) | Val  Loss: 0.9101 | Val  Acc: 0.6667
 Site-SVHN                      (1) | Val  Loss: 0.8746 | Val  Acc: 0.7037
 Site-MNIST_M                   (3) | Val  Loss: 1.0307 | Val  Acc: 0.8286
Average Valid Accuracy: 0.9112
 Best site-USPS                     (0)  | Epoch:29 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:29 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:29 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:29 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:29 | Val Acc: 0.9412
 Best site-USPS                     (0)  | Epoch:29 | Val Acc: 0.9355
 Best site-USPS                     (0)  | Epoch:29 | Val Acc: 0.9286
 Best site-USPS                     (0)  | Epoch:29 | Val Acc: 0.9412
 Best site-USPS                     (0)  | Epoch:29 | Val Acc: 0.9454
 Best site-USPS                     (0)  | Epoch:29 | Val Acc: 0.9275
 Best site-MNIST                    (2)  | Epoch:29 | Val Acc: 0.9000
 Best site-MNIST                    (2)  | Epoch:29 | Val Acc: 0.9444
 Best site-MNIST                    (2)  | Epoch:29 | Val Acc: 0.9375
 Best site-MNIST                    (2)  | Epoch:29 | Val Acc: 0.9138
 Best site-MNIST                    (2)  | Epoch:29 | Val Acc: 0.9524
 Best site-MNIST                    (2)  | Epoch:29 | Val Acc: 0.9524
 Best site-SynthDigits              (4)  | Epoch:29 | Val Acc: 0.8919
 Best site-SynthDigits              (4)  | Epoch:29 | Val Acc: 0.8824
 Best site-SynthDigits              (4)  | Epoch:29 | Val Acc: 0.8525
 Best site-SVHN                     (1)  | Epoch:29 | Val Acc: 0.6667
 Best site-SVHN                     (1)  | Epoch:29 | Val Acc: 0.7037
 Best site-MNIST_M                  (3)  | Epoch:29 | Val Acc: 0.8286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Test site-USPS                      (0)| Epoch:29 | Test Acc: 0.9409
 Test site-MNIST                     (2)| Epoch:29 | Test Acc: 0.9196
 Test site-SynthDigits               (4)| Epoch:29 | Test Acc: 0.8514
 Test site-SVHN                      (1)| Epoch:29 | Test Acc: 0.6157
 Test site-MNIST_M                   (3)| Epoch:29 | Test Acc: 0.6113
USPS: 0.9409, MNIST: 0.9196, SynthDigits: 0.8514, SVHN: 0.6157, MNIST_M: 0.6113, 
Average Test Accuracy(group): 0.7878, Average Test Accuracy(individual): 0.8783,
domain std=0.1453, cluster std=0.1453, individual std=0.1089, 
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 30 ============
cnt=[10, 6, 3, 2, 1, ]
cnt=[2, 10, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-USPS                      (0) | Train Loss: 0.1662 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.1488 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.3133 | Train Acc: 0.9524
 Site-USPS                      (0) | Train Loss: 0.2380 | Train Acc: 0.9737
 Site-USPS                      (0) | Train Loss: 0.1803 | Train Acc: 0.9571
 Site-USPS                      (0) | Train Loss: 0.2511 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.2941 | Train Acc: 0.8943
 Site-USPS                      (0) | Train Loss: 0.2409 | Train Acc: 0.9487
 Site-USPS                      (0) | Train Loss: 0.2581 | Train Acc: 0.9253
 Site-USPS                      (0) | Train Loss: 0.2297 | Train Acc: 0.9457
 Site-MNIST                     (1) | Train Loss: 0.2446 | Train Acc: 0.9500
 Site-MNIST                     (1) | Train Loss: 0.2070 | Train Acc: 0.9444
 Site-MNIST                     (1) | Train Loss: 0.4525 | Train Acc: 0.9225
 Site-MNIST                     (1) | Train Loss: 0.2446 | Train Acc: 0.9356
 Site-MNIST                     (1) | Train Loss: 0.3138 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.2991 | Train Acc: 0.9220
 Site-SynthDigits               (2) | Train Loss: 0.6852 | Train Acc: 0.7748
 Site-SynthDigits               (2) | Train Loss: 0.5460 | Train Acc: 0.8828
 Site-SynthDigits               (2) | Train Loss: 0.5061 | Train Acc: 0.8778
 Site-SVHN                      (3) | Train Loss: 1.0089 | Train Acc: 0.6519
 Site-SVHN                      (3) | Train Loss: 0.9879 | Train Acc: 0.6789
 Site-MNIST_M                   (4) | Train Loss: 0.8633 | Train Acc: 0.7837
Average Train Accuracy: 0.8991
 Site-USPS                      (0) | Val  Loss: 0.3131 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2278 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2567 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1654 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1746 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.1741 | Val  Acc: 0.9355
 Site-USPS                      (0) | Val  Loss: 0.2032 | Val  Acc: 0.9286
 Site-USPS                      (0) | Val  Loss: 0.2287 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.2377 | Val  Acc: 0.9508
 Site-USPS                      (0) | Val  Loss: 0.2483 | Val  Acc: 0.9215
 Site-MNIST                     (1) | Val  Loss: 0.3491 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.2805 | Val  Acc: 0.8889
 Site-MNIST                     (1) | Val  Loss: 0.2274 | Val  Acc: 0.9375
 Site-MNIST                     (1) | Val  Loss: 0.3007 | Val  Acc: 0.8966
 Site-MNIST                     (1) | Val  Loss: 0.2477 | Val  Acc: 0.9429
 Site-MNIST                     (1) | Val  Loss: 0.2181 | Val  Acc: 0.9471
 Site-SynthDigits               (2) | Val  Loss: 0.5067 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.3593 | Val  Acc: 0.8824
 Site-SynthDigits               (2) | Val  Loss: 0.5194 | Val  Acc: 0.8361
 Site-SVHN                      (3) | Val  Loss: 0.9065 | Val  Acc: 0.6444
 Site-SVHN                      (3) | Val  Loss: 0.8852 | Val  Acc: 0.6914
 Site-MNIST_M                   (4) | Val  Loss: 0.9903 | Val  Acc: 0.8000
Average Valid Accuracy: 0.9035
============ Train epoch 31 ============
cnt=[2, 10, 6, 1, 3, ]
cnt=[6, 10, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-USPS                      (1) | Train Loss: 0.1780 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.1789 | Train Acc: 0.9167
 Site-USPS                      (1) | Train Loss: 0.3025 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.2359 | Train Acc: 0.9737
 Site-USPS                      (1) | Train Loss: 0.1465 | Train Acc: 0.9429
 Site-USPS                      (1) | Train Loss: 0.2579 | Train Acc: 0.9365
 Site-USPS                      (1) | Train Loss: 0.2954 | Train Acc: 0.9031
 Site-USPS                      (1) | Train Loss: 0.2368 | Train Acc: 0.9462
 Site-USPS                      (1) | Train Loss: 0.2466 | Train Acc: 0.9293
 Site-USPS                      (1) | Train Loss: 0.2280 | Train Acc: 0.9479
 Site-MNIST                     (2) | Train Loss: 0.2406 | Train Acc: 0.9500
 Site-MNIST                     (2) | Train Loss: 0.3212 | Train Acc: 0.9444
 Site-MNIST                     (2) | Train Loss: 0.2394 | Train Acc: 0.9225
 Site-MNIST                     (2) | Train Loss: 0.2149 | Train Acc: 0.9442
 Site-MNIST                     (2) | Train Loss: 0.3147 | Train Acc: 0.9190
 Site-MNIST                     (2) | Train Loss: 0.2904 | Train Acc: 0.9246
 Site-SynthDigits               (4) | Train Loss: 0.6424 | Train Acc: 0.7881
 Site-SynthDigits               (4) | Train Loss: 0.5138 | Train Acc: 0.8828
 Site-SynthDigits               (4) | Train Loss: 0.4886 | Train Acc: 0.8900
 Site-SVHN                      (0) | Train Loss: 0.9669 | Train Acc: 0.6796
 Site-SVHN                      (0) | Train Loss: 0.9539 | Train Acc: 0.7248
 Site-MNIST_M                   (3) | Train Loss: 0.8848 | Train Acc: 0.7518
Average Train Accuracy: 0.8987
 Site-USPS                      (1) | Val  Loss: 0.2856 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2072 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.2459 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1600 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1719 | Val  Acc: 0.9412
 Site-USPS                      (1) | Val  Loss: 0.1722 | Val  Acc: 0.9355
 Site-USPS                      (1) | Val  Loss: 0.1996 | Val  Acc: 0.9286
 Site-USPS                      (1) | Val  Loss: 0.2265 | Val  Acc: 0.9412
 Site-USPS                      (1) | Val  Loss: 0.2343 | Val  Acc: 0.9508
 Site-USPS                      (1) | Val  Loss: 0.2466 | Val  Acc: 0.9215
 Site-MNIST                     (2) | Val  Loss: 0.3269 | Val  Acc: 0.9000
 Site-MNIST                     (2) | Val  Loss: 0.2613 | Val  Acc: 0.9444
 Site-MNIST                     (2) | Val  Loss: 0.2113 | Val  Acc: 0.9375
 Site-MNIST                     (2) | Val  Loss: 0.2879 | Val  Acc: 0.9138
 Site-MNIST                     (2) | Val  Loss: 0.2400 | Val  Acc: 0.9333
 Site-MNIST                     (2) | Val  Loss: 0.2090 | Val  Acc: 0.9471
 Site-SynthDigits               (4) | Val  Loss: 0.4919 | Val  Acc: 0.8919
 Site-SynthDigits               (4) | Val  Loss: 0.3548 | Val  Acc: 0.8676
 Site-SynthDigits               (4) | Val  Loss: 0.5187 | Val  Acc: 0.8443
 Site-SVHN                      (0) | Val  Loss: 0.8615 | Val  Acc: 0.7111
 Site-SVHN                      (0) | Val  Loss: 0.8251 | Val  Acc: 0.7284
 Site-MNIST_M                   (3) | Val  Loss: 0.9997 | Val  Acc: 0.8429
Average Valid Accuracy: 0.9128
 Best site-USPS                     (1)  | Epoch:31 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:31 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:31 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:31 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:31 | Val Acc: 0.9412
 Best site-USPS                     (1)  | Epoch:31 | Val Acc: 0.9355
 Best site-USPS                     (1)  | Epoch:31 | Val Acc: 0.9286
 Best site-USPS                     (1)  | Epoch:31 | Val Acc: 0.9412
 Best site-USPS                     (1)  | Epoch:31 | Val Acc: 0.9508
 Best site-USPS                     (1)  | Epoch:31 | Val Acc: 0.9215
 Best site-MNIST                    (2)  | Epoch:31 | Val Acc: 0.9000
 Best site-MNIST                    (2)  | Epoch:31 | Val Acc: 0.9444
 Best site-MNIST                    (2)  | Epoch:31 | Val Acc: 0.9375
 Best site-MNIST                    (2)  | Epoch:31 | Val Acc: 0.9138
 Best site-MNIST                    (2)  | Epoch:31 | Val Acc: 0.9333
 Best site-MNIST                    (2)  | Epoch:31 | Val Acc: 0.9471
 Best site-SynthDigits              (4)  | Epoch:31 | Val Acc: 0.8919
 Best site-SynthDigits              (4)  | Epoch:31 | Val Acc: 0.8676
 Best site-SynthDigits              (4)  | Epoch:31 | Val Acc: 0.8443
 Best site-SVHN                     (0)  | Epoch:31 | Val Acc: 0.7111
 Best site-SVHN                     (0)  | Epoch:31 | Val Acc: 0.7284
 Best site-MNIST_M                  (3)  | Epoch:31 | Val Acc: 0.8429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 32 ============
cnt=[10, 3, 6, 1, 2, ]
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-USPS                      (0) | Train Loss: 0.1700 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.1435 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.3034 | Train Acc: 0.9524
 Site-USPS                      (0) | Train Loss: 0.2374 | Train Acc: 0.9474
 Site-USPS                      (0) | Train Loss: 0.1359 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.2446 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.2893 | Train Acc: 0.8987
 Site-USPS                      (0) | Train Loss: 0.2141 | Train Acc: 0.9413
 Site-USPS                      (0) | Train Loss: 0.2467 | Train Acc: 0.9307
 Site-USPS                      (0) | Train Loss: 0.2190 | Train Acc: 0.9464
 Site-MNIST                     (2) | Train Loss: 0.2375 | Train Acc: 0.9500
 Site-MNIST                     (2) | Train Loss: 0.4580 | Train Acc: 0.9444
 Site-MNIST                     (2) | Train Loss: 0.2124 | Train Acc: 0.9147
 Site-MNIST                     (2) | Train Loss: 0.2332 | Train Acc: 0.9356
 Site-MNIST                     (2) | Train Loss: 0.2988 | Train Acc: 0.9214
 Site-MNIST                     (2) | Train Loss: 0.2902 | Train Acc: 0.9246
 Site-SynthDigits               (1) | Train Loss: 0.6813 | Train Acc: 0.7682
 Site-SynthDigits               (1) | Train Loss: 0.5260 | Train Acc: 0.8828
 Site-SynthDigits               (1) | Train Loss: 0.4828 | Train Acc: 0.8880
 Site-SVHN                      (4) | Train Loss: 0.9561 | Train Acc: 0.6906
 Site-SVHN                      (4) | Train Loss: 0.9517 | Train Acc: 0.7095
 Site-MNIST_M                   (3) | Train Loss: 0.8058 | Train Acc: 0.7695
Average Train Accuracy: 0.9002
 Site-USPS                      (0) | Val  Loss: 0.2875 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1917 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2375 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1487 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1598 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.1623 | Val  Acc: 0.9355
 Site-USPS                      (0) | Val  Loss: 0.1936 | Val  Acc: 0.9286
 Site-USPS                      (0) | Val  Loss: 0.2161 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.2252 | Val  Acc: 0.9454
 Site-USPS                      (0) | Val  Loss: 0.2373 | Val  Acc: 0.9184
 Site-MNIST                     (2) | Val  Loss: 0.3316 | Val  Acc: 0.9000
 Site-MNIST                     (2) | Val  Loss: 0.2712 | Val  Acc: 0.8889
 Site-MNIST                     (2) | Val  Loss: 0.2150 | Val  Acc: 0.9062
 Site-MNIST                     (2) | Val  Loss: 0.2887 | Val  Acc: 0.8966
 Site-MNIST                     (2) | Val  Loss: 0.2370 | Val  Acc: 0.9429
 Site-MNIST                     (2) | Val  Loss: 0.2091 | Val  Acc: 0.9524
 Site-SynthDigits               (1) | Val  Loss: 0.4880 | Val  Acc: 0.8919
 Site-SynthDigits               (1) | Val  Loss: 0.3478 | Val  Acc: 0.8676
 Site-SynthDigits               (1) | Val  Loss: 0.5105 | Val  Acc: 0.8525
 Site-SVHN                      (4) | Val  Loss: 0.8724 | Val  Acc: 0.7111
 Site-SVHN                      (4) | Val  Loss: 0.8466 | Val  Acc: 0.7160
 Site-MNIST_M                   (3) | Val  Loss: 0.9206 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9088
============ Train epoch 33 ============
cnt=[10, 3, 1, 6, 2, ]
cnt=[10, 6, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-USPS                      (0) | Train Loss: 0.1525 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.1435 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.3007 | Train Acc: 0.9524
 Site-USPS                      (0) | Train Loss: 0.2292 | Train Acc: 0.9737
 Site-USPS                      (0) | Train Loss: 0.1411 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.2419 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.2793 | Train Acc: 0.8943
 Site-USPS                      (0) | Train Loss: 0.2334 | Train Acc: 0.9487
 Site-USPS                      (0) | Train Loss: 0.2296 | Train Acc: 0.9280
 Site-USPS                      (0) | Train Loss: 0.2131 | Train Acc: 0.9472
 Site-MNIST                     (3) | Train Loss: 0.2302 | Train Acc: 0.9500
 Site-MNIST                     (3) | Train Loss: 0.2914 | Train Acc: 0.9444
 Site-MNIST                     (3) | Train Loss: 0.2775 | Train Acc: 0.9225
 Site-MNIST                     (3) | Train Loss: 0.2209 | Train Acc: 0.9399
 Site-MNIST                     (3) | Train Loss: 0.3084 | Train Acc: 0.9214
 Site-MNIST                     (3) | Train Loss: 0.2812 | Train Acc: 0.9272
 Site-SynthDigits               (1) | Train Loss: 0.6008 | Train Acc: 0.8013
 Site-SynthDigits               (1) | Train Loss: 0.5138 | Train Acc: 0.8938
 Site-SynthDigits               (1) | Train Loss: 0.4646 | Train Acc: 0.8900
 Site-SVHN                      (4) | Train Loss: 0.9427 | Train Acc: 0.6961
 Site-SVHN                      (4) | Train Loss: 0.9434 | Train Acc: 0.7125
 Site-MNIST_M                   (2) | Train Loss: 0.8130 | Train Acc: 0.7872
Average Train Accuracy: 0.9054
 Site-USPS                      (0) | Val  Loss: 0.2948 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2000 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2327 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1463 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1517 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.1525 | Val  Acc: 0.9355
 Site-USPS                      (0) | Val  Loss: 0.1847 | Val  Acc: 0.9286
 Site-USPS                      (0) | Val  Loss: 0.2105 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.2230 | Val  Acc: 0.9508
 Site-USPS                      (0) | Val  Loss: 0.2335 | Val  Acc: 0.9215
 Site-MNIST                     (3) | Val  Loss: 0.3125 | Val  Acc: 0.9000
 Site-MNIST                     (3) | Val  Loss: 0.2635 | Val  Acc: 0.8889
 Site-MNIST                     (3) | Val  Loss: 0.2080 | Val  Acc: 0.9062
 Site-MNIST                     (3) | Val  Loss: 0.2838 | Val  Acc: 0.8966
 Site-MNIST                     (3) | Val  Loss: 0.2319 | Val  Acc: 0.9429
 Site-MNIST                     (3) | Val  Loss: 0.2041 | Val  Acc: 0.9524
 Site-SynthDigits               (1) | Val  Loss: 0.4649 | Val  Acc: 0.8919
 Site-SynthDigits               (1) | Val  Loss: 0.3333 | Val  Acc: 0.8824
 Site-SynthDigits               (1) | Val  Loss: 0.4899 | Val  Acc: 0.8607
 Site-SVHN                      (4) | Val  Loss: 0.8633 | Val  Acc: 0.6667
 Site-SVHN                      (4) | Val  Loss: 0.8156 | Val  Acc: 0.7284
 Site-MNIST_M                   (2) | Val  Loss: 0.9067 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9088
============ Train epoch 34 ============
cnt=[6, 3, 10, 1, 2, ]
cnt=[2, 6, 10, 1, 3, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-USPS                      (2) | Train Loss: 0.1517 | Train Acc: 1.0000
 Site-USPS                      (2) | Train Loss: 0.1172 | Train Acc: 1.0000
 Site-USPS                      (2) | Train Loss: 0.3060 | Train Acc: 0.9524
 Site-USPS                      (2) | Train Loss: 0.2311 | Train Acc: 0.9737
 Site-USPS                      (2) | Train Loss: 0.4798 | Train Acc: 0.9429
 Site-USPS                      (2) | Train Loss: 0.2383 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.2796 | Train Acc: 0.8899
 Site-USPS                      (2) | Train Loss: 0.2151 | Train Acc: 0.9487
 Site-USPS                      (2) | Train Loss: 0.2366 | Train Acc: 0.9307
 Site-USPS                      (2) | Train Loss: 0.2088 | Train Acc: 0.9449
 Site-MNIST                     (0) | Train Loss: 0.2334 | Train Acc: 0.9500
 Site-MNIST                     (0) | Train Loss: 0.1988 | Train Acc: 0.9444
 Site-MNIST                     (0) | Train Loss: 0.7333 | Train Acc: 0.9147
 Site-MNIST                     (0) | Train Loss: 0.2185 | Train Acc: 0.9571
 Site-MNIST                     (0) | Train Loss: 0.2964 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.2820 | Train Acc: 0.9312
 Site-SynthDigits               (1) | Train Loss: 0.6555 | Train Acc: 0.8146
 Site-SynthDigits               (1) | Train Loss: 0.4804 | Train Acc: 0.8901
 Site-SynthDigits               (1) | Train Loss: 0.4599 | Train Acc: 0.8798
 Site-SVHN                      (4) | Train Loss: 0.9475 | Train Acc: 0.6906
 Site-SVHN                      (4) | Train Loss: 0.8401 | Train Acc: 0.7095
 Site-MNIST_M                   (3) | Train Loss: 0.7978 | Train Acc: 0.7872
Average Train Accuracy: 0.9050
 Site-USPS                      (2) | Val  Loss: 0.2831 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1839 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.2158 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1339 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1441 | Val  Acc: 0.9412
 Site-USPS                      (2) | Val  Loss: 0.1463 | Val  Acc: 0.9355
 Site-USPS                      (2) | Val  Loss: 0.1816 | Val  Acc: 0.9286
 Site-USPS                      (2) | Val  Loss: 0.2032 | Val  Acc: 0.9412
 Site-USPS                      (2) | Val  Loss: 0.2178 | Val  Acc: 0.9508
 Site-USPS                      (2) | Val  Loss: 0.2262 | Val  Acc: 0.9245
 Site-MNIST                     (0) | Val  Loss: 0.3082 | Val  Acc: 0.9000
 Site-MNIST                     (0) | Val  Loss: 0.2626 | Val  Acc: 0.8889
 Site-MNIST                     (0) | Val  Loss: 0.2022 | Val  Acc: 0.9375
 Site-MNIST                     (0) | Val  Loss: 0.2810 | Val  Acc: 0.8966
 Site-MNIST                     (0) | Val  Loss: 0.2281 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2000 | Val  Acc: 0.9471
 Site-SynthDigits               (1) | Val  Loss: 0.4606 | Val  Acc: 0.8919
 Site-SynthDigits               (1) | Val  Loss: 0.3260 | Val  Acc: 0.8971
 Site-SynthDigits               (1) | Val  Loss: 0.4783 | Val  Acc: 0.8770
 Site-SVHN                      (4) | Val  Loss: 0.8591 | Val  Acc: 0.6667
 Site-SVHN                      (4) | Val  Loss: 0.8253 | Val  Acc: 0.7407
 Site-MNIST_M                   (3) | Val  Loss: 0.8617 | Val  Acc: 0.8714
Average Valid Accuracy: 0.9131
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.9412
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.9355
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.9286
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.9412
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.9508
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.9245
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9000
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.8889
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9375
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.8966
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9524
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9471
 Best site-SynthDigits              (1)  | Epoch:34 | Val Acc: 0.8919
 Best site-SynthDigits              (1)  | Epoch:34 | Val Acc: 0.8971
 Best site-SynthDigits              (1)  | Epoch:34 | Val Acc: 0.8770
 Best site-SVHN                     (4)  | Epoch:34 | Val Acc: 0.6667
 Best site-SVHN                     (4)  | Epoch:34 | Val Acc: 0.7407
 Best site-MNIST_M                  (3)  | Epoch:34 | Val Acc: 0.8714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 35 ============
cnt=[10, 6, 3, 1, 2, ]
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-USPS                      (0) | Train Loss: 0.1486 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.1314 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.3029 | Train Acc: 0.9524
 Site-USPS                      (0) | Train Loss: 0.2257 | Train Acc: 0.9737
 Site-USPS                      (0) | Train Loss: 0.1667 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.2287 | Train Acc: 0.9365
 Site-USPS                      (0) | Train Loss: 0.2527 | Train Acc: 0.9075
 Site-USPS                      (0) | Train Loss: 0.2106 | Train Acc: 0.9487
 Site-USPS                      (0) | Train Loss: 0.2246 | Train Acc: 0.9280
 Site-USPS                      (0) | Train Loss: 0.2064 | Train Acc: 0.9487
 Site-MNIST                     (1) | Train Loss: 0.2190 | Train Acc: 0.9500
 Site-MNIST                     (1) | Train Loss: 0.1877 | Train Acc: 0.9306
 Site-MNIST                     (1) | Train Loss: 0.2060 | Train Acc: 0.9225
 Site-MNIST                     (1) | Train Loss: 0.2037 | Train Acc: 0.9528
 Site-MNIST                     (1) | Train Loss: 0.2863 | Train Acc: 0.9238
 Site-MNIST                     (1) | Train Loss: 0.2706 | Train Acc: 0.9286
 Site-SynthDigits               (2) | Train Loss: 0.5673 | Train Acc: 0.8212
 Site-SynthDigits               (2) | Train Loss: 0.4904 | Train Acc: 0.8828
 Site-SynthDigits               (2) | Train Loss: 0.4493 | Train Acc: 0.8941
 Site-SVHN                      (4) | Train Loss: 0.9315 | Train Acc: 0.7072
 Site-SVHN                      (4) | Train Loss: 0.8566 | Train Acc: 0.7156
 Site-MNIST_M                   (3) | Train Loss: 0.7791 | Train Acc: 0.8050
Average Train Accuracy: 0.9078
 Site-USPS                      (0) | Val  Loss: 0.2763 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1869 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2133 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1344 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1470 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.1458 | Val  Acc: 0.9355
 Site-USPS                      (0) | Val  Loss: 0.1776 | Val  Acc: 0.9286
 Site-USPS                      (0) | Val  Loss: 0.1984 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.2130 | Val  Acc: 0.9563
 Site-USPS                      (0) | Val  Loss: 0.2209 | Val  Acc: 0.9305
 Site-MNIST                     (1) | Val  Loss: 0.2924 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.2443 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1922 | Val  Acc: 0.9688
 Site-MNIST                     (1) | Val  Loss: 0.2639 | Val  Acc: 0.9310
 Site-MNIST                     (1) | Val  Loss: 0.2160 | Val  Acc: 0.9429
 Site-MNIST                     (1) | Val  Loss: 0.1872 | Val  Acc: 0.9471
 Site-SynthDigits               (2) | Val  Loss: 0.4522 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.3195 | Val  Acc: 0.8971
 Site-SynthDigits               (2) | Val  Loss: 0.4719 | Val  Acc: 0.8607
 Site-SVHN                      (4) | Val  Loss: 0.8348 | Val  Acc: 0.6889
 Site-SVHN                      (4) | Val  Loss: 0.7958 | Val  Acc: 0.7407
 Site-MNIST_M                   (3) | Val  Loss: 0.8551 | Val  Acc: 0.8714
Average Valid Accuracy: 0.9261
 Best site-USPS                     (0)  | Epoch:35 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:35 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:35 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:35 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:35 | Val Acc: 0.9412
 Best site-USPS                     (0)  | Epoch:35 | Val Acc: 0.9355
 Best site-USPS                     (0)  | Epoch:35 | Val Acc: 0.9286
 Best site-USPS                     (0)  | Epoch:35 | Val Acc: 0.9412
 Best site-USPS                     (0)  | Epoch:35 | Val Acc: 0.9563
 Best site-USPS                     (0)  | Epoch:35 | Val Acc: 0.9305
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9688
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9310
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9429
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9471
 Best site-SynthDigits              (2)  | Epoch:35 | Val Acc: 0.8919
 Best site-SynthDigits              (2)  | Epoch:35 | Val Acc: 0.8971
 Best site-SynthDigits              (2)  | Epoch:35 | Val Acc: 0.8607
 Best site-SVHN                     (4)  | Epoch:35 | Val Acc: 0.6889
 Best site-SVHN                     (4)  | Epoch:35 | Val Acc: 0.7407
 Best site-MNIST_M                  (3)  | Epoch:35 | Val Acc: 0.8714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 36 ============
cnt=[6, 3, 10, 1, 2, ]
cnt=[1, 3, 6, 9, 3, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-USPS                      (2) | Train Loss: 0.1480 | Train Acc: 1.0000
 Site-USPS                      (2) | Train Loss: 0.1355 | Train Acc: 1.0000
 Site-USPS                      (2) | Train Loss: 0.2909 | Train Acc: 0.9524
 Site-USPS                      (2) | Train Loss: 0.2209 | Train Acc: 0.9737
 Site-USPS                      (2) | Train Loss: 0.1504 | Train Acc: 0.9429
 Site-USPS                      (2) | Train Loss: 0.2268 | Train Acc: 0.9286
 Site-USPS                      (2) | Train Loss: 0.2642 | Train Acc: 0.9031
 Site-USPS                      (2) | Train Loss: 0.2043 | Train Acc: 0.9511
 Site-USPS                      (2) | Train Loss: 0.2175 | Train Acc: 0.9334
 Site-USPS                      (2) | Train Loss: 0.1996 | Train Acc: 0.9487
 Site-MNIST                     (0) | Train Loss: 0.2196 | Train Acc: 0.9500
 Site-MNIST                     (0) | Train Loss: 0.1480 | Train Acc: 0.9444
 Site-MNIST                     (0) | Train Loss: 0.4129 | Train Acc: 0.9225
 Site-MNIST                     (0) | Train Loss: 0.2033 | Train Acc: 0.9571
 Site-MNIST                     (0) | Train Loss: 0.2816 | Train Acc: 0.9262
 Site-MNIST                     (0) | Train Loss: 0.2653 | Train Acc: 0.9325
 Site-SynthDigits               (1) | Train Loss: 0.6323 | Train Acc: 0.8146
 Site-SynthDigits               (1) | Train Loss: 0.4543 | Train Acc: 0.8901
 Site-SynthDigits               (1) | Train Loss: 0.4347 | Train Acc: 0.8900
 Site-SVHN                      (4) | Train Loss: 0.9308 | Train Acc: 0.7017
 Site-SVHN                      (4) | Train Loss: 0.8964 | Train Acc: 0.7248
 Site-MNIST_M                   (3) | Train Loss: 0.7646 | Train Acc: 0.8050
Average Train Accuracy: 0.9088
 Site-USPS                      (2) | Val  Loss: 0.2563 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1730 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.2134 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1320 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1385 | Val  Acc: 0.9412
 Site-USPS                      (2) | Val  Loss: 0.1336 | Val  Acc: 0.9677
 Site-USPS                      (2) | Val  Loss: 0.1713 | Val  Acc: 0.9464
 Site-USPS                      (2) | Val  Loss: 0.1909 | Val  Acc: 0.9510
 Site-USPS                      (2) | Val  Loss: 0.2083 | Val  Acc: 0.9563
 Site-USPS                      (2) | Val  Loss: 0.2188 | Val  Acc: 0.9305
 Site-MNIST                     (0) | Val  Loss: 0.2802 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.2337 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1867 | Val  Acc: 0.9688
 Site-MNIST                     (0) | Val  Loss: 0.2600 | Val  Acc: 0.9310
 Site-MNIST                     (0) | Val  Loss: 0.2124 | Val  Acc: 0.9429
 Site-MNIST                     (0) | Val  Loss: 0.1852 | Val  Acc: 0.9418
 Site-SynthDigits               (1) | Val  Loss: 0.4439 | Val  Acc: 0.9189
 Site-SynthDigits               (1) | Val  Loss: 0.3138 | Val  Acc: 0.8971
 Site-SynthDigits               (1) | Val  Loss: 0.4674 | Val  Acc: 0.8607
 Site-SVHN                      (4) | Val  Loss: 0.8399 | Val  Acc: 0.6667
 Site-SVHN                      (4) | Val  Loss: 0.7931 | Val  Acc: 0.7407
 Site-MNIST_M                   (3) | Val  Loss: 0.8050 | Val  Acc: 0.8714
Average Valid Accuracy: 0.9288
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.9412
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.9677
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.9464
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.9510
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.9563
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.9305
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9688
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9310
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9429
 Best site-MNIST                    (0)  | Epoch:36 | Val Acc: 0.9418
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.9189
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.8971
 Best site-SynthDigits              (1)  | Epoch:36 | Val Acc: 0.8607
 Best site-SVHN                     (4)  | Epoch:36 | Val Acc: 0.6667
 Best site-SVHN                     (4)  | Epoch:36 | Val Acc: 0.7407
 Best site-MNIST_M                  (3)  | Epoch:36 | Val Acc: 0.8714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 37 ============
cnt=[10, 2, 6, 1, 3, ]
cnt=[2, 10, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-USPS                      (0) | Train Loss: 0.1338 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.1397 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.2949 | Train Acc: 0.9524
 Site-USPS                      (0) | Train Loss: 0.2224 | Train Acc: 0.9737
 Site-USPS                      (0) | Train Loss: 0.1394 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.2295 | Train Acc: 0.9365
 Site-USPS                      (0) | Train Loss: 0.2696 | Train Acc: 0.8987
 Site-USPS                      (0) | Train Loss: 0.2069 | Train Acc: 0.9462
 Site-USPS                      (0) | Train Loss: 0.2139 | Train Acc: 0.9348
 Site-USPS                      (0) | Train Loss: 0.1969 | Train Acc: 0.9494
 Site-MNIST                     (2) | Train Loss: 0.2137 | Train Acc: 0.9500
 Site-MNIST                     (2) | Train Loss: 0.4528 | Train Acc: 0.9583
 Site-MNIST                     (2) | Train Loss: 0.1639 | Train Acc: 0.9302
 Site-MNIST                     (2) | Train Loss: 0.2027 | Train Acc: 0.9571
 Site-MNIST                     (2) | Train Loss: 0.2665 | Train Acc: 0.9262
 Site-MNIST                     (2) | Train Loss: 0.2601 | Train Acc: 0.9286
 Site-SynthDigits               (4) | Train Loss: 0.5881 | Train Acc: 0.8079
 Site-SynthDigits               (4) | Train Loss: 0.4500 | Train Acc: 0.8901
 Site-SynthDigits               (4) | Train Loss: 0.4349 | Train Acc: 0.8961
 Site-SVHN                      (1) | Train Loss: 0.8957 | Train Acc: 0.7182
 Site-SVHN                      (1) | Train Loss: 0.9055 | Train Acc: 0.7401
 Site-MNIST_M                   (3) | Train Loss: 0.7437 | Train Acc: 0.7979
Average Train Accuracy: 0.9107
 Site-USPS                      (0) | Val  Loss: 0.2229 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1525 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.2017 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1246 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1466 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.1395 | Val  Acc: 0.9355
 Site-USPS                      (0) | Val  Loss: 0.1755 | Val  Acc: 0.9286
 Site-USPS                      (0) | Val  Loss: 0.1921 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.2049 | Val  Acc: 0.9563
 Site-USPS                      (0) | Val  Loss: 0.2156 | Val  Acc: 0.9305
 Site-MNIST                     (2) | Val  Loss: 0.2732 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.2317 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1797 | Val  Acc: 0.9688
 Site-MNIST                     (2) | Val  Loss: 0.2552 | Val  Acc: 0.9310
 Site-MNIST                     (2) | Val  Loss: 0.2103 | Val  Acc: 0.9429
 Site-MNIST                     (2) | Val  Loss: 0.1815 | Val  Acc: 0.9524
 Site-SynthDigits               (4) | Val  Loss: 0.4344 | Val  Acc: 0.8919
 Site-SynthDigits               (4) | Val  Loss: 0.3097 | Val  Acc: 0.8824
 Site-SynthDigits               (4) | Val  Loss: 0.4602 | Val  Acc: 0.8607
 Site-SVHN                      (1) | Val  Loss: 0.8138 | Val  Acc: 0.7111
 Site-SVHN                      (1) | Val  Loss: 0.7862 | Val  Acc: 0.7531
 Site-MNIST_M                   (3) | Val  Loss: 0.8180 | Val  Acc: 0.8857
Average Valid Accuracy: 0.9279
============ Train epoch 38 ============
cnt=[6, 3, 10, 1, 2, ]
cnt=[2, 10, 3, 6, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-USPS                      (2) | Train Loss: 0.1342 | Train Acc: 1.0000
 Site-USPS                      (2) | Train Loss: 0.1457 | Train Acc: 1.0000
 Site-USPS                      (2) | Train Loss: 0.2931 | Train Acc: 0.9524
 Site-USPS                      (2) | Train Loss: 0.2306 | Train Acc: 0.9737
 Site-USPS                      (2) | Train Loss: 0.3351 | Train Acc: 0.9429
 Site-USPS                      (2) | Train Loss: 0.2255 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.2509 | Train Acc: 0.9075
 Site-USPS                      (2) | Train Loss: 0.1907 | Train Acc: 0.9511
 Site-USPS                      (2) | Train Loss: 0.2162 | Train Acc: 0.9334
 Site-USPS                      (2) | Train Loss: 0.1945 | Train Acc: 0.9479
 Site-MNIST                     (0) | Train Loss: 0.2047 | Train Acc: 0.9500
 Site-MNIST                     (0) | Train Loss: 0.1543 | Train Acc: 0.9444
 Site-MNIST                     (0) | Train Loss: 0.1701 | Train Acc: 0.9302
 Site-MNIST                     (0) | Train Loss: 0.1931 | Train Acc: 0.9571
 Site-MNIST                     (0) | Train Loss: 0.2581 | Train Acc: 0.9310
 Site-MNIST                     (0) | Train Loss: 0.2515 | Train Acc: 0.9365
 Site-SynthDigits               (1) | Train Loss: 0.5642 | Train Acc: 0.8013
 Site-SynthDigits               (1) | Train Loss: 0.4793 | Train Acc: 0.8974
 Site-SynthDigits               (1) | Train Loss: 0.4234 | Train Acc: 0.8961
 Site-SVHN                      (4) | Train Loss: 0.8898 | Train Acc: 0.7127
 Site-SVHN                      (4) | Train Loss: 0.9302 | Train Acc: 0.7492
 Site-MNIST_M                   (3) | Train Loss: 0.7256 | Train Acc: 0.8262
Average Train Accuracy: 0.9130
 Site-USPS                      (2) | Val  Loss: 0.2072 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1428 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.2009 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1242 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1445 | Val  Acc: 0.9412
 Site-USPS                      (2) | Val  Loss: 0.1349 | Val  Acc: 0.9677
 Site-USPS                      (2) | Val  Loss: 0.1726 | Val  Acc: 0.9286
 Site-USPS                      (2) | Val  Loss: 0.1877 | Val  Acc: 0.9510
 Site-USPS                      (2) | Val  Loss: 0.2002 | Val  Acc: 0.9563
 Site-USPS                      (2) | Val  Loss: 0.2122 | Val  Acc: 0.9305
 Site-MNIST                     (0) | Val  Loss: 0.2538 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.2155 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1692 | Val  Acc: 0.9688
 Site-MNIST                     (0) | Val  Loss: 0.2474 | Val  Acc: 0.9483
 Site-MNIST                     (0) | Val  Loss: 0.2065 | Val  Acc: 0.9429
 Site-MNIST                     (0) | Val  Loss: 0.1765 | Val  Acc: 0.9524
 Site-SynthDigits               (1) | Val  Loss: 0.4237 | Val  Acc: 0.8919
 Site-SynthDigits               (1) | Val  Loss: 0.2974 | Val  Acc: 0.8824
 Site-SynthDigits               (1) | Val  Loss: 0.4495 | Val  Acc: 0.8689
 Site-SVHN                      (4) | Val  Loss: 0.8095 | Val  Acc: 0.7333
 Site-SVHN                      (4) | Val  Loss: 0.7655 | Val  Acc: 0.7778
 Site-MNIST_M                   (3) | Val  Loss: 0.8006 | Val  Acc: 0.8857
Average Valid Accuracy: 0.9331
 Best site-USPS                     (2)  | Epoch:38 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:38 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:38 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:38 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:38 | Val Acc: 0.9412
 Best site-USPS                     (2)  | Epoch:38 | Val Acc: 0.9677
 Best site-USPS                     (2)  | Epoch:38 | Val Acc: 0.9286
 Best site-USPS                     (2)  | Epoch:38 | Val Acc: 0.9510
 Best site-USPS                     (2)  | Epoch:38 | Val Acc: 0.9563
 Best site-USPS                     (2)  | Epoch:38 | Val Acc: 0.9305
 Best site-MNIST                    (0)  | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:38 | Val Acc: 0.9688
 Best site-MNIST                    (0)  | Epoch:38 | Val Acc: 0.9483
 Best site-MNIST                    (0)  | Epoch:38 | Val Acc: 0.9429
 Best site-MNIST                    (0)  | Epoch:38 | Val Acc: 0.9524
 Best site-SynthDigits              (1)  | Epoch:38 | Val Acc: 0.8919
 Best site-SynthDigits              (1)  | Epoch:38 | Val Acc: 0.8824
 Best site-SynthDigits              (1)  | Epoch:38 | Val Acc: 0.8689
 Best site-SVHN                     (4)  | Epoch:38 | Val Acc: 0.7333
 Best site-SVHN                     (4)  | Epoch:38 | Val Acc: 0.7778
 Best site-MNIST_M                  (3)  | Epoch:38 | Val Acc: 0.8857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 39 ============
cnt=[10, 3, 6, 1, 2, ]
cnt=[6, 10, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-USPS                      (0) | Train Loss: 0.1331 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.1344 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.2912 | Train Acc: 0.9524
 Site-USPS                      (0) | Train Loss: 0.2087 | Train Acc: 0.9737
 Site-USPS                      (0) | Train Loss: 0.2438 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.2193 | Train Acc: 0.9524
 Site-USPS                      (0) | Train Loss: 0.2434 | Train Acc: 0.9119
 Site-USPS                      (0) | Train Loss: 0.2139 | Train Acc: 0.9560
 Site-USPS                      (0) | Train Loss: 0.2165 | Train Acc: 0.9321
 Site-USPS                      (0) | Train Loss: 0.1864 | Train Acc: 0.9517
 Site-MNIST                     (2) | Train Loss: 0.1988 | Train Acc: 0.9500
 Site-MNIST                     (2) | Train Loss: 0.1840 | Train Acc: 0.9583
 Site-MNIST                     (2) | Train Loss: 0.6064 | Train Acc: 0.9302
 Site-MNIST                     (2) | Train Loss: 0.1868 | Train Acc: 0.9571
 Site-MNIST                     (2) | Train Loss: 0.2609 | Train Acc: 0.9286
 Site-MNIST                     (2) | Train Loss: 0.2483 | Train Acc: 0.9365
 Site-SynthDigits               (1) | Train Loss: 0.5445 | Train Acc: 0.8278
 Site-SynthDigits               (1) | Train Loss: 0.4246 | Train Acc: 0.8974
 Site-SynthDigits               (1) | Train Loss: 0.4223 | Train Acc: 0.9043
 Site-SVHN                      (4) | Train Loss: 0.9040 | Train Acc: 0.7293
 Site-SVHN                      (4) | Train Loss: 0.8101 | Train Acc: 0.7309
 Site-MNIST_M                   (3) | Train Loss: 0.7286 | Train Acc: 0.8191
Average Train Accuracy: 0.9156
 Site-USPS                      (0) | Val  Loss: 0.2153 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1454 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1959 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1178 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1287 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.1204 | Val  Acc: 0.9677
 Site-USPS                      (0) | Val  Loss: 0.1635 | Val  Acc: 0.9464
 Site-USPS                      (0) | Val  Loss: 0.1794 | Val  Acc: 0.9510
 Site-USPS                      (0) | Val  Loss: 0.1953 | Val  Acc: 0.9563
 Site-USPS                      (0) | Val  Loss: 0.2057 | Val  Acc: 0.9245
 Site-MNIST                     (2) | Val  Loss: 0.2399 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.2084 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1637 | Val  Acc: 0.9688
 Site-MNIST                     (2) | Val  Loss: 0.2457 | Val  Acc: 0.9483
 Site-MNIST                     (2) | Val  Loss: 0.2034 | Val  Acc: 0.9429
 Site-MNIST                     (2) | Val  Loss: 0.1738 | Val  Acc: 0.9524
 Site-SynthDigits               (1) | Val  Loss: 0.4151 | Val  Acc: 0.8919
 Site-SynthDigits               (1) | Val  Loss: 0.2883 | Val  Acc: 0.8971
 Site-SynthDigits               (1) | Val  Loss: 0.4316 | Val  Acc: 0.8934
 Site-SVHN                      (4) | Val  Loss: 0.8354 | Val  Acc: 0.7333
 Site-SVHN                      (4) | Val  Loss: 0.7680 | Val  Acc: 0.7531
 Site-MNIST_M                   (3) | Val  Loss: 0.7671 | Val  Acc: 0.8714
Average Valid Accuracy: 0.9336
 Best site-USPS                     (0)  | Epoch:39 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:39 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:39 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:39 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:39 | Val Acc: 0.9412
 Best site-USPS                     (0)  | Epoch:39 | Val Acc: 0.9677
 Best site-USPS                     (0)  | Epoch:39 | Val Acc: 0.9464
 Best site-USPS                     (0)  | Epoch:39 | Val Acc: 0.9510
 Best site-USPS                     (0)  | Epoch:39 | Val Acc: 0.9563
 Best site-USPS                     (0)  | Epoch:39 | Val Acc: 0.9245
 Best site-MNIST                    (2)  | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:39 | Val Acc: 0.9688
 Best site-MNIST                    (2)  | Epoch:39 | Val Acc: 0.9483
 Best site-MNIST                    (2)  | Epoch:39 | Val Acc: 0.9429
 Best site-MNIST                    (2)  | Epoch:39 | Val Acc: 0.9524
 Best site-SynthDigits              (1)  | Epoch:39 | Val Acc: 0.8919
 Best site-SynthDigits              (1)  | Epoch:39 | Val Acc: 0.8971
 Best site-SynthDigits              (1)  | Epoch:39 | Val Acc: 0.8934
 Best site-SVHN                     (4)  | Epoch:39 | Val Acc: 0.7333
 Best site-SVHN                     (4)  | Epoch:39 | Val Acc: 0.7531
 Best site-MNIST_M                  (3)  | Epoch:39 | Val Acc: 0.8714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 40 ============
cnt=[6, 3, 10, 1, 2, ]
cnt=[6, 10, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-USPS                      (2) | Train Loss: 0.1264 | Train Acc: 1.0000
 Site-USPS                      (2) | Train Loss: 0.1500 | Train Acc: 0.9167
 Site-USPS                      (2) | Train Loss: 0.2913 | Train Acc: 0.9524
 Site-USPS                      (2) | Train Loss: 0.2135 | Train Acc: 0.9737
 Site-USPS                      (2) | Train Loss: 0.1516 | Train Acc: 0.9429
 Site-USPS                      (2) | Train Loss: 0.2119 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.2545 | Train Acc: 0.8987
 Site-USPS                      (2) | Train Loss: 0.1884 | Train Acc: 0.9511
 Site-USPS                      (2) | Train Loss: 0.2053 | Train Acc: 0.9348
 Site-USPS                      (2) | Train Loss: 0.1814 | Train Acc: 0.9547
 Site-MNIST                     (0) | Train Loss: 0.1941 | Train Acc: 0.9500
 Site-MNIST                     (0) | Train Loss: 0.3585 | Train Acc: 0.9444
 Site-MNIST                     (0) | Train Loss: 0.1529 | Train Acc: 0.9380
 Site-MNIST                     (0) | Train Loss: 0.1811 | Train Acc: 0.9571
 Site-MNIST                     (0) | Train Loss: 0.2610 | Train Acc: 0.9333
 Site-MNIST                     (0) | Train Loss: 0.2442 | Train Acc: 0.9339
 Site-SynthDigits               (1) | Train Loss: 0.5095 | Train Acc: 0.8344
 Site-SynthDigits               (1) | Train Loss: 0.4414 | Train Acc: 0.9011
 Site-SynthDigits               (1) | Train Loss: 0.4164 | Train Acc: 0.9043
 Site-SVHN                      (4) | Train Loss: 0.8753 | Train Acc: 0.7348
 Site-SVHN                      (4) | Train Loss: 0.7998 | Train Acc: 0.7492
 Site-MNIST_M                   (3) | Train Loss: 0.6865 | Train Acc: 0.8262
Average Train Accuracy: 0.9126
 Site-USPS                      (2) | Val  Loss: 0.2240 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1559 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1902 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1136 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1384 | Val  Acc: 0.9412
 Site-USPS                      (2) | Val  Loss: 0.1261 | Val  Acc: 0.9677
 Site-USPS                      (2) | Val  Loss: 0.1631 | Val  Acc: 0.9464
 Site-USPS                      (2) | Val  Loss: 0.1780 | Val  Acc: 0.9510
 Site-USPS                      (2) | Val  Loss: 0.1911 | Val  Acc: 0.9563
 Site-USPS                      (2) | Val  Loss: 0.1990 | Val  Acc: 0.9366
 Site-MNIST                     (0) | Val  Loss: 0.2248 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1988 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1592 | Val  Acc: 0.9688
 Site-MNIST                     (0) | Val  Loss: 0.2391 | Val  Acc: 0.9483
 Site-MNIST                     (0) | Val  Loss: 0.1989 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.1658 | Val  Acc: 0.9577
 Site-SynthDigits               (1) | Val  Loss: 0.4044 | Val  Acc: 0.8919
 Site-SynthDigits               (1) | Val  Loss: 0.2825 | Val  Acc: 0.8971
 Site-SynthDigits               (1) | Val  Loss: 0.4245 | Val  Acc: 0.8934
 Site-SVHN                      (4) | Val  Loss: 0.8075 | Val  Acc: 0.7333
 Site-SVHN                      (4) | Val  Loss: 0.7571 | Val  Acc: 0.7654
 Site-MNIST_M                   (3) | Val  Loss: 0.7775 | Val  Acc: 0.8714
Average Valid Accuracy: 0.9354
 Best site-USPS                     (2)  | Epoch:40 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:40 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:40 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:40 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:40 | Val Acc: 0.9412
 Best site-USPS                     (2)  | Epoch:40 | Val Acc: 0.9677
 Best site-USPS                     (2)  | Epoch:40 | Val Acc: 0.9464
 Best site-USPS                     (2)  | Epoch:40 | Val Acc: 0.9510
 Best site-USPS                     (2)  | Epoch:40 | Val Acc: 0.9563
 Best site-USPS                     (2)  | Epoch:40 | Val Acc: 0.9366
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 0.9688
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 0.9483
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 0.9524
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 0.9577
 Best site-SynthDigits              (1)  | Epoch:40 | Val Acc: 0.8919
 Best site-SynthDigits              (1)  | Epoch:40 | Val Acc: 0.8971
 Best site-SynthDigits              (1)  | Epoch:40 | Val Acc: 0.8934
 Best site-SVHN                     (4)  | Epoch:40 | Val Acc: 0.7333
 Best site-SVHN                     (4)  | Epoch:40 | Val Acc: 0.7654
 Best site-MNIST_M                  (3)  | Epoch:40 | Val Acc: 0.8714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 41 ============
cnt=[10, 3, 1, 6, 2, ]
cnt=[3, 6, 10, 1, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-USPS                      (0) | Train Loss: 0.1175 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.1311 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.2894 | Train Acc: 0.9524
 Site-USPS                      (0) | Train Loss: 0.2153 | Train Acc: 0.9737
 Site-USPS                      (0) | Train Loss: 0.1162 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.2124 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.2423 | Train Acc: 0.9075
 Site-USPS                      (0) | Train Loss: 0.1941 | Train Acc: 0.9535
 Site-USPS                      (0) | Train Loss: 0.2007 | Train Acc: 0.9416
 Site-USPS                      (0) | Train Loss: 0.1822 | Train Acc: 0.9562
 Site-MNIST                     (3) | Train Loss: 0.1942 | Train Acc: 0.9500
 Site-MNIST                     (3) | Train Loss: 0.1792 | Train Acc: 0.9583
 Site-MNIST                     (3) | Train Loss: 0.2740 | Train Acc: 0.9302
 Site-MNIST                     (3) | Train Loss: 0.1810 | Train Acc: 0.9571
 Site-MNIST                     (3) | Train Loss: 0.2586 | Train Acc: 0.9357
 Site-MNIST                     (3) | Train Loss: 0.2407 | Train Acc: 0.9352
 Site-SynthDigits               (1) | Train Loss: 0.5369 | Train Acc: 0.8079
 Site-SynthDigits               (1) | Train Loss: 0.4314 | Train Acc: 0.9011
 Site-SynthDigits               (1) | Train Loss: 0.4140 | Train Acc: 0.8921
 Site-SVHN                      (4) | Train Loss: 0.8503 | Train Acc: 0.7182
 Site-SVHN                      (4) | Train Loss: 0.8067 | Train Acc: 0.7676
 Site-MNIST_M                   (2) | Train Loss: 0.6875 | Train Acc: 0.8262
Average Train Accuracy: 0.9160
 Site-USPS                      (0) | Val  Loss: 0.2299 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1497 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1736 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1020 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1258 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.1216 | Val  Acc: 0.9677
 Site-USPS                      (0) | Val  Loss: 0.1592 | Val  Acc: 0.9464
 Site-USPS                      (0) | Val  Loss: 0.1793 | Val  Acc: 0.9510
 Site-USPS                      (0) | Val  Loss: 0.1926 | Val  Acc: 0.9563
 Site-USPS                      (0) | Val  Loss: 0.1952 | Val  Acc: 0.9426
 Site-MNIST                     (3) | Val  Loss: 0.2299 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.2034 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.1577 | Val  Acc: 0.9688
 Site-MNIST                     (3) | Val  Loss: 0.2381 | Val  Acc: 0.9483
 Site-MNIST                     (3) | Val  Loss: 0.1958 | Val  Acc: 0.9429
 Site-MNIST                     (3) | Val  Loss: 0.1639 | Val  Acc: 0.9577
 Site-SynthDigits               (1) | Val  Loss: 0.4031 | Val  Acc: 0.8919
 Site-SynthDigits               (1) | Val  Loss: 0.2728 | Val  Acc: 0.8971
 Site-SynthDigits               (1) | Val  Loss: 0.4207 | Val  Acc: 0.8852
 Site-SVHN                      (4) | Val  Loss: 0.7725 | Val  Acc: 0.7111
 Site-SVHN                      (4) | Val  Loss: 0.7328 | Val  Acc: 0.7531
 Site-MNIST_M                   (2) | Val  Loss: 0.7414 | Val  Acc: 0.8714
Average Valid Accuracy: 0.9333
============ Train epoch 42 ============
cnt=[6, 3, 10, 1, 2, ]
cnt=[10, 6, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-USPS                      (2) | Train Loss: 0.1120 | Train Acc: 1.0000
 Site-USPS                      (2) | Train Loss: 0.1135 | Train Acc: 1.0000
 Site-USPS                      (2) | Train Loss: 0.2830 | Train Acc: 0.9524
 Site-USPS                      (2) | Train Loss: 0.2115 | Train Acc: 0.9737
 Site-USPS                      (2) | Train Loss: 0.1375 | Train Acc: 0.9429
 Site-USPS                      (2) | Train Loss: 0.2060 | Train Acc: 0.9524
 Site-USPS                      (2) | Train Loss: 0.2418 | Train Acc: 0.9031
 Site-USPS                      (2) | Train Loss: 0.1889 | Train Acc: 0.9560
 Site-USPS                      (2) | Train Loss: 0.2062 | Train Acc: 0.9402
 Site-USPS                      (2) | Train Loss: 0.1773 | Train Acc: 0.9532
 Site-MNIST                     (0) | Train Loss: 0.1902 | Train Acc: 0.9500
 Site-MNIST                     (0) | Train Loss: 0.3767 | Train Acc: 0.9583
 Site-MNIST                     (0) | Train Loss: 0.1517 | Train Acc: 0.9302
 Site-MNIST                     (0) | Train Loss: 0.1828 | Train Acc: 0.9571
 Site-MNIST                     (0) | Train Loss: 0.2477 | Train Acc: 0.9357
 Site-MNIST                     (0) | Train Loss: 0.2359 | Train Acc: 0.9405
 Site-SynthDigits               (1) | Train Loss: 0.5565 | Train Acc: 0.8344
 Site-SynthDigits               (1) | Train Loss: 0.4240 | Train Acc: 0.9011
 Site-SynthDigits               (1) | Train Loss: 0.4047 | Train Acc: 0.9002
 Site-SVHN                      (4) | Train Loss: 0.8500 | Train Acc: 0.7403
 Site-SVHN                      (4) | Train Loss: 0.7685 | Train Acc: 0.7492
 Site-MNIST_M                   (3) | Train Loss: 0.6865 | Train Acc: 0.8546
Average Train Accuracy: 0.9193
 Site-USPS                      (2) | Val  Loss: 0.2202 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1371 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1703 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.0985 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1173 | Val  Acc: 0.9412
 Site-USPS                      (2) | Val  Loss: 0.1140 | Val  Acc: 0.9677
 Site-USPS                      (2) | Val  Loss: 0.1554 | Val  Acc: 0.9464
 Site-USPS                      (2) | Val  Loss: 0.1718 | Val  Acc: 0.9510
 Site-USPS                      (2) | Val  Loss: 0.1877 | Val  Acc: 0.9563
 Site-USPS                      (2) | Val  Loss: 0.1913 | Val  Acc: 0.9366
 Site-MNIST                     (0) | Val  Loss: 0.2232 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1939 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1518 | Val  Acc: 0.9688
 Site-MNIST                     (0) | Val  Loss: 0.2316 | Val  Acc: 0.9483
 Site-MNIST                     (0) | Val  Loss: 0.1925 | Val  Acc: 0.9429
 Site-MNIST                     (0) | Val  Loss: 0.1640 | Val  Acc: 0.9577
 Site-SynthDigits               (1) | Val  Loss: 0.4102 | Val  Acc: 0.8919
 Site-SynthDigits               (1) | Val  Loss: 0.2656 | Val  Acc: 0.9118
 Site-SynthDigits               (1) | Val  Loss: 0.4114 | Val  Acc: 0.8934
 Site-SVHN                      (4) | Val  Loss: 0.7752 | Val  Acc: 0.7333
 Site-SVHN                      (4) | Val  Loss: 0.7299 | Val  Acc: 0.7654
 Site-MNIST_M                   (3) | Val  Loss: 0.7250 | Val  Acc: 0.9000
Average Valid Accuracy: 0.9369
 Best site-USPS                     (2)  | Epoch:42 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:42 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:42 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:42 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:42 | Val Acc: 0.9412
 Best site-USPS                     (2)  | Epoch:42 | Val Acc: 0.9677
 Best site-USPS                     (2)  | Epoch:42 | Val Acc: 0.9464
 Best site-USPS                     (2)  | Epoch:42 | Val Acc: 0.9510
 Best site-USPS                     (2)  | Epoch:42 | Val Acc: 0.9563
 Best site-USPS                     (2)  | Epoch:42 | Val Acc: 0.9366
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 0.9688
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 0.9483
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 0.9429
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 0.9577
 Best site-SynthDigits              (1)  | Epoch:42 | Val Acc: 0.8919
 Best site-SynthDigits              (1)  | Epoch:42 | Val Acc: 0.9118
 Best site-SynthDigits              (1)  | Epoch:42 | Val Acc: 0.8934
 Best site-SVHN                     (4)  | Epoch:42 | Val Acc: 0.7333
 Best site-SVHN                     (4)  | Epoch:42 | Val Acc: 0.7654
 Best site-MNIST_M                  (3)  | Epoch:42 | Val Acc: 0.9000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 43 ============
cnt=[3, 10, 6, 1, 2, ]
cnt=[1, 3, 6, 9, 3, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-USPS                      (1) | Train Loss: 0.1128 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.1310 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.2864 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.2065 | Train Acc: 0.9737
 Site-USPS                      (1) | Train Loss: 0.1227 | Train Acc: 0.9429
 Site-USPS                      (1) | Train Loss: 0.2105 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.2222 | Train Acc: 0.9075
 Site-USPS                      (1) | Train Loss: 0.1788 | Train Acc: 0.9487
 Site-USPS                      (1) | Train Loss: 0.1970 | Train Acc: 0.9470
 Site-USPS                      (1) | Train Loss: 0.1745 | Train Acc: 0.9577
 Site-MNIST                     (2) | Train Loss: 0.1840 | Train Acc: 0.9500
 Site-MNIST                     (2) | Train Loss: 0.1595 | Train Acc: 0.9444
 Site-MNIST                     (2) | Train Loss: 0.1524 | Train Acc: 0.9380
 Site-MNIST                     (2) | Train Loss: 0.1739 | Train Acc: 0.9571
 Site-MNIST                     (2) | Train Loss: 0.2425 | Train Acc: 0.9405
 Site-MNIST                     (2) | Train Loss: 0.2313 | Train Acc: 0.9444
 Site-SynthDigits               (0) | Train Loss: 0.5715 | Train Acc: 0.8411
 Site-SynthDigits               (0) | Train Loss: 0.3899 | Train Acc: 0.8974
 Site-SynthDigits               (0) | Train Loss: 0.3856 | Train Acc: 0.9043
 Site-SVHN                      (4) | Train Loss: 0.8387 | Train Acc: 0.7403
 Site-SVHN                      (4) | Train Loss: 0.8848 | Train Acc: 0.7554
 Site-MNIST_M                   (3) | Train Loss: 0.6898 | Train Acc: 0.8404
Average Train Accuracy: 0.9198
 Site-USPS                      (1) | Val  Loss: 0.2123 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1436 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1709 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1001 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1234 | Val  Acc: 0.9412
 Site-USPS                      (1) | Val  Loss: 0.1132 | Val  Acc: 0.9677
 Site-USPS                      (1) | Val  Loss: 0.1540 | Val  Acc: 0.9464
 Site-USPS                      (1) | Val  Loss: 0.1702 | Val  Acc: 0.9510
 Site-USPS                      (1) | Val  Loss: 0.1854 | Val  Acc: 0.9563
 Site-USPS                      (1) | Val  Loss: 0.1898 | Val  Acc: 0.9396
 Site-MNIST                     (2) | Val  Loss: 0.2141 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1859 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1449 | Val  Acc: 0.9688
 Site-MNIST                     (2) | Val  Loss: 0.2266 | Val  Acc: 0.9483
 Site-MNIST                     (2) | Val  Loss: 0.1894 | Val  Acc: 0.9429
 Site-MNIST                     (2) | Val  Loss: 0.1599 | Val  Acc: 0.9577
 Site-SynthDigits               (0) | Val  Loss: 0.3890 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.2603 | Val  Acc: 0.9118
 Site-SynthDigits               (0) | Val  Loss: 0.4016 | Val  Acc: 0.8934
 Site-SVHN                      (4) | Val  Loss: 0.7668 | Val  Acc: 0.7111
 Site-SVHN                      (4) | Val  Loss: 0.7224 | Val  Acc: 0.7654
 Site-MNIST_M                   (3) | Val  Loss: 0.7350 | Val  Acc: 0.8857
Average Valid Accuracy: 0.9354
============ Train epoch 44 ============
cnt=[6, 2, 10, 3, 1, ]
cnt=[2, 10, 6, 1, 3, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-USPS                      (2) | Train Loss: 0.1021 | Train Acc: 1.0000
 Site-USPS                      (2) | Train Loss: 0.1074 | Train Acc: 1.0000
 Site-USPS                      (2) | Train Loss: 0.2913 | Train Acc: 0.9524
 Site-USPS                      (2) | Train Loss: 0.2072 | Train Acc: 0.9737
 Site-USPS                      (2) | Train Loss: 0.2065 | Train Acc: 0.9429
 Site-USPS                      (2) | Train Loss: 0.2034 | Train Acc: 0.9603
 Site-USPS                      (2) | Train Loss: 0.2292 | Train Acc: 0.9075
 Site-USPS                      (2) | Train Loss: 0.1848 | Train Acc: 0.9584
 Site-USPS                      (2) | Train Loss: 0.1925 | Train Acc: 0.9429
 Site-USPS                      (2) | Train Loss: 0.1715 | Train Acc: 0.9555
 Site-MNIST                     (0) | Train Loss: 0.1766 | Train Acc: 0.9500
 Site-MNIST                     (0) | Train Loss: 0.1386 | Train Acc: 0.9444
 Site-MNIST                     (0) | Train Loss: 0.6251 | Train Acc: 0.9457
 Site-MNIST                     (0) | Train Loss: 0.1708 | Train Acc: 0.9614
 Site-MNIST                     (0) | Train Loss: 0.2417 | Train Acc: 0.9381
 Site-MNIST                     (0) | Train Loss: 0.2290 | Train Acc: 0.9431
 Site-SynthDigits               (3) | Train Loss: 0.4998 | Train Acc: 0.8543
 Site-SynthDigits               (3) | Train Loss: 0.4413 | Train Acc: 0.9084
 Site-SynthDigits               (3) | Train Loss: 0.3861 | Train Acc: 0.9022
 Site-SVHN                      (1) | Train Loss: 0.8258 | Train Acc: 0.7403
 Site-SVHN                      (1) | Train Loss: 0.8127 | Train Acc: 0.7706
 Site-MNIST_M                   (4) | Train Loss: 0.6459 | Train Acc: 0.8298
Average Train Accuracy: 0.9219
 Site-USPS                      (2) | Val  Loss: 0.2298 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1369 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1674 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.0965 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.1197 | Val  Acc: 0.9412
 Site-USPS                      (2) | Val  Loss: 0.1140 | Val  Acc: 0.9677
 Site-USPS                      (2) | Val  Loss: 0.1576 | Val  Acc: 0.9464
 Site-USPS                      (2) | Val  Loss: 0.1707 | Val  Acc: 0.9510
 Site-USPS                      (2) | Val  Loss: 0.1850 | Val  Acc: 0.9563
 Site-USPS                      (2) | Val  Loss: 0.1869 | Val  Acc: 0.9366
 Site-MNIST                     (0) | Val  Loss: 0.2136 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1865 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1431 | Val  Acc: 0.9688
 Site-MNIST                     (0) | Val  Loss: 0.2294 | Val  Acc: 0.9483
 Site-MNIST                     (0) | Val  Loss: 0.1895 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.1577 | Val  Acc: 0.9630
 Site-SynthDigits               (3) | Val  Loss: 0.3944 | Val  Acc: 0.8919
 Site-SynthDigits               (3) | Val  Loss: 0.2608 | Val  Acc: 0.9118
 Site-SynthDigits               (3) | Val  Loss: 0.3990 | Val  Acc: 0.8934
 Site-SVHN                      (1) | Val  Loss: 0.7577 | Val  Acc: 0.7111
 Site-SVHN                      (1) | Val  Loss: 0.7291 | Val  Acc: 0.7531
 Site-MNIST_M                   (4) | Val  Loss: 0.7030 | Val  Acc: 0.9000
Average Valid Accuracy: 0.9360
============ Train epoch 45 ============
cnt=[3, 10, 6, 1, 2, ]
cnt=[2, 10, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-USPS                      (1) | Train Loss: 0.0999 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.1175 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.2828 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.2061 | Train Acc: 0.9474
 Site-USPS                      (1) | Train Loss: 0.1039 | Train Acc: 0.9429
 Site-USPS                      (1) | Train Loss: 0.2011 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.2345 | Train Acc: 0.9119
 Site-USPS                      (1) | Train Loss: 0.1681 | Train Acc: 0.9584
 Site-USPS                      (1) | Train Loss: 0.1922 | Train Acc: 0.9443
 Site-USPS                      (1) | Train Loss: 0.1703 | Train Acc: 0.9555
 Site-MNIST                     (2) | Train Loss: 0.1814 | Train Acc: 0.9500
 Site-MNIST                     (2) | Train Loss: 0.1852 | Train Acc: 0.9583
 Site-MNIST                     (2) | Train Loss: 0.1469 | Train Acc: 0.9457
 Site-MNIST                     (2) | Train Loss: 0.1657 | Train Acc: 0.9614
 Site-MNIST                     (2) | Train Loss: 0.2302 | Train Acc: 0.9405
 Site-MNIST                     (2) | Train Loss: 0.2254 | Train Acc: 0.9444
 Site-SynthDigits               (0) | Train Loss: 0.5389 | Train Acc: 0.8344
 Site-SynthDigits               (0) | Train Loss: 0.4029 | Train Acc: 0.8938
 Site-SynthDigits               (0) | Train Loss: 0.3785 | Train Acc: 0.9043
 Site-SVHN                      (4) | Train Loss: 0.8292 | Train Acc: 0.7348
 Site-SVHN                      (4) | Train Loss: 0.8085 | Train Acc: 0.7768
 Site-MNIST_M                   (3) | Train Loss: 0.6601 | Train Acc: 0.8333
Average Train Accuracy: 0.9201
 Site-USPS                      (1) | Val  Loss: 0.2290 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1270 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1601 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.0921 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1144 | Val  Acc: 0.9412
 Site-USPS                      (1) | Val  Loss: 0.1125 | Val  Acc: 0.9677
 Site-USPS                      (1) | Val  Loss: 0.1564 | Val  Acc: 0.9464
 Site-USPS                      (1) | Val  Loss: 0.1696 | Val  Acc: 0.9510
 Site-USPS                      (1) | Val  Loss: 0.1828 | Val  Acc: 0.9563
 Site-USPS                      (1) | Val  Loss: 0.1852 | Val  Acc: 0.9366
 Site-MNIST                     (2) | Val  Loss: 0.2125 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1795 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1349 | Val  Acc: 0.9688
 Site-MNIST                     (2) | Val  Loss: 0.2244 | Val  Acc: 0.9483
 Site-MNIST                     (2) | Val  Loss: 0.1860 | Val  Acc: 0.9429
 Site-MNIST                     (2) | Val  Loss: 0.1554 | Val  Acc: 0.9524
 Site-SynthDigits               (0) | Val  Loss: 0.3905 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.2633 | Val  Acc: 0.8971
 Site-SynthDigits               (0) | Val  Loss: 0.3971 | Val  Acc: 0.8934
 Site-SVHN                      (4) | Val  Loss: 0.7552 | Val  Acc: 0.7111
 Site-SVHN                      (4) | Val  Loss: 0.7257 | Val  Acc: 0.7654
 Site-MNIST_M                   (3) | Val  Loss: 0.6724 | Val  Acc: 0.9143
Average Valid Accuracy: 0.9357
 Test site-USPS                      (1)| Epoch:42 | Test Acc: 0.9430
 Test site-MNIST                     (2)| Epoch:42 | Test Acc: 0.9370
 Test site-SynthDigits               (0)| Epoch:42 | Test Acc: 0.8819
 Test site-SVHN                      (4)| Epoch:42 | Test Acc: 0.6601
 Test site-MNIST_M                   (3)| Epoch:42 | Test Acc: 0.6506
USPS: 0.9430, MNIST: 0.9370, SynthDigits: 0.8819, SVHN: 0.6601, MNIST_M: 0.6506, 
Average Test Accuracy(group): 0.8145, Average Test Accuracy(individual): 0.8940,
domain std=0.1317, cluster std=0.1317, individual std=0.0964, 
Average Test Accuracy: 0.8145
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 46 ============
cnt=[2, 10, 6, 3, 1, ]
cnt=[3, 10, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-USPS                      (1) | Train Loss: 0.0931 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.0882 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.2945 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.2107 | Train Acc: 0.9474
 Site-USPS                      (1) | Train Loss: 0.3126 | Train Acc: 0.9429
 Site-USPS                      (1) | Train Loss: 0.2004 | Train Acc: 0.9603
 Site-USPS                      (1) | Train Loss: 0.2249 | Train Acc: 0.9163
 Site-USPS                      (1) | Train Loss: 0.1729 | Train Acc: 0.9609
 Site-USPS                      (1) | Train Loss: 0.2041 | Train Acc: 0.9402
 Site-USPS                      (1) | Train Loss: 0.1685 | Train Acc: 0.9532
 Site-MNIST                     (2) | Train Loss: 0.1791 | Train Acc: 0.9500
 Site-MNIST                     (2) | Train Loss: 0.1491 | Train Acc: 0.9583
 Site-MNIST                     (2) | Train Loss: 0.2778 | Train Acc: 0.9380
 Site-MNIST                     (2) | Train Loss: 0.1745 | Train Acc: 0.9614
 Site-MNIST                     (2) | Train Loss: 0.2373 | Train Acc: 0.9405
 Site-MNIST                     (2) | Train Loss: 0.2221 | Train Acc: 0.9431
 Site-SynthDigits               (3) | Train Loss: 0.6009 | Train Acc: 0.8609
 Site-SynthDigits               (3) | Train Loss: 0.4054 | Train Acc: 0.9011
 Site-SynthDigits               (3) | Train Loss: 0.3849 | Train Acc: 0.9063
 Site-SVHN                      (0) | Train Loss: 0.8133 | Train Acc: 0.7348
 Site-SVHN                      (0) | Train Loss: 0.7494 | Train Acc: 0.7737
 Site-MNIST_M                   (4) | Train Loss: 0.6438 | Train Acc: 0.8475
Average Train Accuracy: 0.9222
 Site-USPS                      (1) | Val  Loss: 0.2270 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1208 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1592 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.0907 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1046 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1031 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1560 | Val  Acc: 0.9643
 Site-USPS                      (1) | Val  Loss: 0.1694 | Val  Acc: 0.9510
 Site-USPS                      (1) | Val  Loss: 0.1851 | Val  Acc: 0.9563
 Site-USPS                      (1) | Val  Loss: 0.1851 | Val  Acc: 0.9366
 Site-MNIST                     (2) | Val  Loss: 0.2032 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1751 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1337 | Val  Acc: 0.9688
 Site-MNIST                     (2) | Val  Loss: 0.2277 | Val  Acc: 0.9483
 Site-MNIST                     (2) | Val  Loss: 0.1862 | Val  Acc: 0.9429
 Site-MNIST                     (2) | Val  Loss: 0.1552 | Val  Acc: 0.9524
 Site-SynthDigits               (3) | Val  Loss: 0.3932 | Val  Acc: 0.8919
 Site-SynthDigits               (3) | Val  Loss: 0.2496 | Val  Acc: 0.9118
 Site-SynthDigits               (3) | Val  Loss: 0.3881 | Val  Acc: 0.8934
 Site-SVHN                      (0) | Val  Loss: 0.7677 | Val  Acc: 0.7333
 Site-SVHN                      (0) | Val  Loss: 0.7178 | Val  Acc: 0.7778
 Site-MNIST_M                   (4) | Val  Loss: 0.6573 | Val  Acc: 0.9143
Average Valid Accuracy: 0.9429
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 0.9643
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 0.9510
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 0.9563
 Best site-USPS                     (1)  | Epoch:46 | Val Acc: 0.9366
 Best site-MNIST                    (2)  | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:46 | Val Acc: 0.9688
 Best site-MNIST                    (2)  | Epoch:46 | Val Acc: 0.9483
 Best site-MNIST                    (2)  | Epoch:46 | Val Acc: 0.9429
 Best site-MNIST                    (2)  | Epoch:46 | Val Acc: 0.9524
 Best site-SynthDigits              (3)  | Epoch:46 | Val Acc: 0.8919
 Best site-SynthDigits              (3)  | Epoch:46 | Val Acc: 0.9118
 Best site-SynthDigits              (3)  | Epoch:46 | Val Acc: 0.8934
 Best site-SVHN                     (0)  | Epoch:46 | Val Acc: 0.7333
 Best site-SVHN                     (0)  | Epoch:46 | Val Acc: 0.7778
 Best site-MNIST_M                  (4)  | Epoch:46 | Val Acc: 0.9143
 Test site-USPS                      (1)| Epoch:46 | Test Acc: 0.9409
 Test site-MNIST                     (2)| Epoch:46 | Test Acc: 0.9357
 Test site-SynthDigits               (3)| Epoch:46 | Test Acc: 0.8814
 Test site-SVHN                      (0)| Epoch:46 | Test Acc: 0.6590
 Test site-MNIST_M                   (4)| Epoch:46 | Test Acc: 0.6550
USPS: 0.9409, MNIST: 0.9357, SynthDigits: 0.8814, SVHN: 0.6590, MNIST_M: 0.6550, 
Average Test Accuracy(group): 0.8144, Average Test Accuracy(individual): 0.8927,
domain std=0.1302, cluster std=0.1302, individual std=0.0954, 
Average Test Accuracy: 0.8144
============ Train epoch 47 ============
cnt=[3, 10, 6, 1, 2, ]
cnt=[10, 3, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-USPS                      (1) | Train Loss: 0.0877 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.0982 | Train Acc: 1.0000
 Site-USPS                      (1) | Train Loss: 0.2819 | Train Acc: 0.9524
 Site-USPS                      (1) | Train Loss: 0.2058 | Train Acc: 0.9474
 Site-USPS                      (1) | Train Loss: 0.1262 | Train Acc: 0.9429
 Site-USPS                      (1) | Train Loss: 0.1932 | Train Acc: 0.9603
 Site-USPS                      (1) | Train Loss: 0.2031 | Train Acc: 0.9207
 Site-USPS                      (1) | Train Loss: 0.1734 | Train Acc: 0.9584
 Site-USPS                      (1) | Train Loss: 0.1804 | Train Acc: 0.9443
 Site-USPS                      (1) | Train Loss: 0.1599 | Train Acc: 0.9547
 Site-MNIST                     (2) | Train Loss: 0.1793 | Train Acc: 0.9500
 Site-MNIST                     (2) | Train Loss: 0.4363 | Train Acc: 0.9583
 Site-MNIST                     (2) | Train Loss: 0.2082 | Train Acc: 0.9380
 Site-MNIST                     (2) | Train Loss: 0.1656 | Train Acc: 0.9571
 Site-MNIST                     (2) | Train Loss: 0.2302 | Train Acc: 0.9429
 Site-MNIST                     (2) | Train Loss: 0.2212 | Train Acc: 0.9405
 Site-SynthDigits               (0) | Train Loss: 0.4958 | Train Acc: 0.8543
 Site-SynthDigits               (0) | Train Loss: 0.3722 | Train Acc: 0.9011
 Site-SynthDigits               (0) | Train Loss: 0.3662 | Train Acc: 0.9063
 Site-SVHN                      (4) | Train Loss: 0.7995 | Train Acc: 0.7569
 Site-SVHN                      (4) | Train Loss: 0.7174 | Train Acc: 0.7859
 Site-MNIST_M                   (3) | Train Loss: 0.6230 | Train Acc: 0.8546
Average Train Accuracy: 0.9240
 Site-USPS                      (1) | Val  Loss: 0.2439 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1325 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1625 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.0916 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1032 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.0981 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.1501 | Val  Acc: 0.9643
 Site-USPS                      (1) | Val  Loss: 0.1644 | Val  Acc: 0.9510
 Site-USPS                      (1) | Val  Loss: 0.1778 | Val  Acc: 0.9563
 Site-USPS                      (1) | Val  Loss: 0.1762 | Val  Acc: 0.9396
 Site-MNIST                     (2) | Val  Loss: 0.1907 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1715 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1334 | Val  Acc: 0.9688
 Site-MNIST                     (2) | Val  Loss: 0.2252 | Val  Acc: 0.9483
 Site-MNIST                     (2) | Val  Loss: 0.1824 | Val  Acc: 0.9429
 Site-MNIST                     (2) | Val  Loss: 0.1515 | Val  Acc: 0.9524
 Site-SynthDigits               (0) | Val  Loss: 0.3658 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.2511 | Val  Acc: 0.9118
 Site-SynthDigits               (0) | Val  Loss: 0.3836 | Val  Acc: 0.9098
 Site-SVHN                      (4) | Val  Loss: 0.7479 | Val  Acc: 0.7778
 Site-SVHN                      (4) | Val  Loss: 0.6841 | Val  Acc: 0.7654
 Site-MNIST_M                   (3) | Val  Loss: 0.6593 | Val  Acc: 0.9143
Average Valid Accuracy: 0.9464
 Best site-USPS                     (1)  | Epoch:47 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:47 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:47 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:47 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:47 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:47 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:47 | Val Acc: 0.9643
 Best site-USPS                     (1)  | Epoch:47 | Val Acc: 0.9510
 Best site-USPS                     (1)  | Epoch:47 | Val Acc: 0.9563
 Best site-USPS                     (1)  | Epoch:47 | Val Acc: 0.9396
 Best site-MNIST                    (2)  | Epoch:47 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:47 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:47 | Val Acc: 0.9688
 Best site-MNIST                    (2)  | Epoch:47 | Val Acc: 0.9483
 Best site-MNIST                    (2)  | Epoch:47 | Val Acc: 0.9429
 Best site-MNIST                    (2)  | Epoch:47 | Val Acc: 0.9524
 Best site-SynthDigits              (0)  | Epoch:47 | Val Acc: 0.9189
 Best site-SynthDigits              (0)  | Epoch:47 | Val Acc: 0.9118
 Best site-SynthDigits              (0)  | Epoch:47 | Val Acc: 0.9098
 Best site-SVHN                     (4)  | Epoch:47 | Val Acc: 0.7778
 Best site-SVHN                     (4)  | Epoch:47 | Val Acc: 0.7654
 Best site-MNIST_M                  (3)  | Epoch:47 | Val Acc: 0.9143
 Test site-USPS                      (1)| Epoch:47 | Test Acc: 0.9473
 Test site-MNIST                     (2)| Epoch:47 | Test Acc: 0.9356
 Test site-SynthDigits               (0)| Epoch:47 | Test Acc: 0.8839
 Test site-SVHN                      (4)| Epoch:47 | Test Acc: 0.6665
 Test site-MNIST_M                   (3)| Epoch:47 | Test Acc: 0.6514
USPS: 0.9473, MNIST: 0.9356, SynthDigits: 0.8839, SVHN: 0.6665, MNIST_M: 0.6514, 
Average Test Accuracy(group): 0.8170, Average Test Accuracy(individual): 0.8965,
domain std=0.1308, cluster std=0.1308, individual std=0.0957, 
Average Test Accuracy: 0.8170
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 48 ============
cnt=[10, 3, 6, 1, 2, ]
cnt=[9, 6, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-USPS                      (0) | Train Loss: 0.0818 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.0879 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.2712 | Train Acc: 0.9524
 Site-USPS                      (0) | Train Loss: 0.2088 | Train Acc: 0.9737
 Site-USPS                      (0) | Train Loss: 0.1194 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.1886 | Train Acc: 0.9603
 Site-USPS                      (0) | Train Loss: 0.2157 | Train Acc: 0.9207
 Site-USPS                      (0) | Train Loss: 0.1792 | Train Acc: 0.9609
 Site-USPS                      (0) | Train Loss: 0.1830 | Train Acc: 0.9470
 Site-USPS                      (0) | Train Loss: 0.1602 | Train Acc: 0.9570
 Site-MNIST                     (2) | Train Loss: 0.1768 | Train Acc: 0.9500
 Site-MNIST                     (2) | Train Loss: 0.1472 | Train Acc: 0.9444
 Site-MNIST                     (2) | Train Loss: 0.1405 | Train Acc: 0.9302
 Site-MNIST                     (2) | Train Loss: 0.1610 | Train Acc: 0.9614
 Site-MNIST                     (2) | Train Loss: 0.2239 | Train Acc: 0.9405
 Site-MNIST                     (2) | Train Loss: 0.2209 | Train Acc: 0.9431
 Site-SynthDigits               (1) | Train Loss: 0.4838 | Train Acc: 0.8278
 Site-SynthDigits               (1) | Train Loss: 0.3891 | Train Acc: 0.9048
 Site-SynthDigits               (1) | Train Loss: 0.3687 | Train Acc: 0.9145
 Site-SVHN                      (4) | Train Loss: 0.7801 | Train Acc: 0.7514
 Site-SVHN                      (4) | Train Loss: 0.7712 | Train Acc: 0.7768
 Site-MNIST_M                   (3) | Train Loss: 0.6277 | Train Acc: 0.8511
Average Train Accuracy: 0.9232
 Site-USPS                      (0) | Val  Loss: 0.2424 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1297 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1628 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.0912 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1024 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.0974 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1525 | Val  Acc: 0.9643
 Site-USPS                      (0) | Val  Loss: 0.1662 | Val  Acc: 0.9510
 Site-USPS                      (0) | Val  Loss: 0.1790 | Val  Acc: 0.9563
 Site-USPS                      (0) | Val  Loss: 0.1757 | Val  Acc: 0.9426
 Site-MNIST                     (2) | Val  Loss: 0.1934 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1701 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1297 | Val  Acc: 0.9688
 Site-MNIST                     (2) | Val  Loss: 0.2225 | Val  Acc: 0.9483
 Site-MNIST                     (2) | Val  Loss: 0.1790 | Val  Acc: 0.9429
 Site-MNIST                     (2) | Val  Loss: 0.1483 | Val  Acc: 0.9524
 Site-SynthDigits               (1) | Val  Loss: 0.3583 | Val  Acc: 0.9189
 Site-SynthDigits               (1) | Val  Loss: 0.2498 | Val  Acc: 0.9265
 Site-SynthDigits               (1) | Val  Loss: 0.3822 | Val  Acc: 0.9016
 Site-SVHN                      (4) | Val  Loss: 0.7221 | Val  Acc: 0.7778
 Site-SVHN                      (4) | Val  Loss: 0.6734 | Val  Acc: 0.7778
 Site-MNIST_M                   (3) | Val  Loss: 0.6398 | Val  Acc: 0.9000
Average Valid Accuracy: 0.9468
 Best site-USPS                     (0)  | Epoch:48 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:48 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:48 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:48 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:48 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:48 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:48 | Val Acc: 0.9643
 Best site-USPS                     (0)  | Epoch:48 | Val Acc: 0.9510
 Best site-USPS                     (0)  | Epoch:48 | Val Acc: 0.9563
 Best site-USPS                     (0)  | Epoch:48 | Val Acc: 0.9426
 Best site-MNIST                    (2)  | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:48 | Val Acc: 0.9688
 Best site-MNIST                    (2)  | Epoch:48 | Val Acc: 0.9483
 Best site-MNIST                    (2)  | Epoch:48 | Val Acc: 0.9429
 Best site-MNIST                    (2)  | Epoch:48 | Val Acc: 0.9524
 Best site-SynthDigits              (1)  | Epoch:48 | Val Acc: 0.9189
 Best site-SynthDigits              (1)  | Epoch:48 | Val Acc: 0.9265
 Best site-SynthDigits              (1)  | Epoch:48 | Val Acc: 0.9016
 Best site-SVHN                     (4)  | Epoch:48 | Val Acc: 0.7778
 Best site-SVHN                     (4)  | Epoch:48 | Val Acc: 0.7778
 Best site-MNIST_M                  (3)  | Epoch:48 | Val Acc: 0.9000
 Test site-USPS                      (0)| Epoch:48 | Test Acc: 0.9452
 Test site-MNIST                     (2)| Epoch:48 | Test Acc: 0.9357
 Test site-SynthDigits               (1)| Epoch:48 | Test Acc: 0.8845
 Test site-SVHN                      (4)| Epoch:48 | Test Acc: 0.6718
 Test site-MNIST_M                   (3)| Epoch:48 | Test Acc: 0.6533
USPS: 0.9452, MNIST: 0.9357, SynthDigits: 0.8845, SVHN: 0.6718, MNIST_M: 0.6533, 
Average Test Accuracy(group): 0.8181, Average Test Accuracy(individual): 0.8962,
domain std=0.1288, cluster std=0.1288, individual std=0.0938, 
Average Test Accuracy: 0.8181
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle_clscon/ccop_q=1...
============ Train epoch 49 ============
cnt=[10, 3, 6, 1, 2, ]
cnt=[6, 10, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-USPS                      (0) | Train Loss: 0.0746 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.0870 | Train Acc: 1.0000
 Site-USPS                      (0) | Train Loss: 0.2759 | Train Acc: 0.9524
 Site-USPS                      (0) | Train Loss: 0.2084 | Train Acc: 0.9737
 Site-USPS                      (0) | Train Loss: 0.1712 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.1835 | Train Acc: 0.9603
 Site-USPS                      (0) | Train Loss: 0.1999 | Train Acc: 0.9163
 Site-USPS                      (0) | Train Loss: 0.1723 | Train Acc: 0.9584
 Site-USPS                      (0) | Train Loss: 0.1798 | Train Acc: 0.9416
 Site-USPS                      (0) | Train Loss: 0.1580 | Train Acc: 0.9562
 Site-MNIST                     (2) | Train Loss: 0.1782 | Train Acc: 0.9500
 Site-MNIST                     (2) | Train Loss: 0.3576 | Train Acc: 0.9583
 Site-MNIST                     (2) | Train Loss: 0.1503 | Train Acc: 0.9380
 Site-MNIST                     (2) | Train Loss: 0.1638 | Train Acc: 0.9571
 Site-MNIST                     (2) | Train Loss: 0.2292 | Train Acc: 0.9405
 Site-MNIST                     (2) | Train Loss: 0.2161 | Train Acc: 0.9418
 Site-SynthDigits               (1) | Train Loss: 0.4657 | Train Acc: 0.8146
 Site-SynthDigits               (1) | Train Loss: 0.4036 | Train Acc: 0.8974
 Site-SynthDigits               (1) | Train Loss: 0.3564 | Train Acc: 0.9145
 Site-SVHN                      (4) | Train Loss: 0.7914 | Train Acc: 0.7403
 Site-SVHN                      (4) | Train Loss: 0.7102 | Train Acc: 0.7920
 Site-MNIST_M                   (3) | Train Loss: 0.5966 | Train Acc: 0.8546
Average Train Accuracy: 0.9228
 Site-USPS                      (0) | Val  Loss: 0.2276 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1164 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1531 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.0861 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.1077 | Val  Acc: 0.9412
 Site-USPS                      (0) | Val  Loss: 0.1031 | Val  Acc: 0.9677
 Site-USPS                      (0) | Val  Loss: 0.1543 | Val  Acc: 0.9643
 Site-USPS                      (0) | Val  Loss: 0.1643 | Val  Acc: 0.9608
 Site-USPS                      (0) | Val  Loss: 0.1770 | Val  Acc: 0.9563
 Site-USPS                      (0) | Val  Loss: 0.1749 | Val  Acc: 0.9456
 Site-MNIST                     (2) | Val  Loss: 0.1981 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1741 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1266 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.2206 | Val  Acc: 0.9483
 Site-MNIST                     (2) | Val  Loss: 0.1764 | Val  Acc: 0.9524
 Site-MNIST                     (2) | Val  Loss: 0.1458 | Val  Acc: 0.9577
 Site-SynthDigits               (1) | Val  Loss: 0.3531 | Val  Acc: 0.8919
 Site-SynthDigits               (1) | Val  Loss: 0.2362 | Val  Acc: 0.9118
 Site-SynthDigits               (1) | Val  Loss: 0.3729 | Val  Acc: 0.8934
 Site-SVHN                      (4) | Val  Loss: 0.7273 | Val  Acc: 0.7111
 Site-SVHN                      (4) | Val  Loss: 0.6875 | Val  Acc: 0.7778
 Site-MNIST_M                   (3) | Val  Loss: 0.6138 | Val  Acc: 0.9143
Average Valid Accuracy: 0.9407
 Test site-USPS                      (0)| Epoch:48 | Test Acc: 0.9452
 Test site-MNIST                     (2)| Epoch:48 | Test Acc: 0.9350
 Test site-SynthDigits               (1)| Epoch:48 | Test Acc: 0.8867
 Test site-SVHN                      (4)| Epoch:48 | Test Acc: 0.6682
 Test site-MNIST_M                   (3)| Epoch:48 | Test Acc: 0.6533
USPS: 0.9452, MNIST: 0.9350, SynthDigits: 0.8867, SVHN: 0.6682, MNIST_M: 0.6533, 
Average Test Accuracy(group): 0.8177, Average Test Accuracy(individual): 0.8960,
domain std=0.1297, cluster std=0.1297, individual std=0.0944, 
Average Test Accuracy: 0.8177
===2023-06-29 23:07:52===
===2023-06-29 23:07:57===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 5
Loading snapshots...
 Test site-USPS                      (0)| Epoch:48 | Test Acc: 0.9452
 Test site-MNIST                     (2)| Epoch:48 | Test Acc: 0.9357
 Test site-SynthDigits               (1)| Epoch:48 | Test Acc: 0.8845
 Test site-SVHN                      (4)| Epoch:48 | Test Acc: 0.6718
 Test site-MNIST_M                   (3)| Epoch:48 | Test Acc: 0.6533
USPS: 0.9452, MNIST: 0.9357, SynthDigits: 0.8845, SVHN: 0.6718, MNIST_M: 0.6533, 
Average Test Accuracy(group): 0.8181, Average Test Accuracy(individual): 0.8962,
domain std=0.1288, cluster std=0.1288, individual std=0.0938, 
