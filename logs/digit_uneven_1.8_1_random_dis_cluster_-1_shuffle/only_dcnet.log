===2023-06-29 18:52:12===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 5
============ Train epoch 0 ============
cnt=[10, 6, 3, 2, 1, ]
cnt=[6, 10, 3, 1, 2, ]
 Site-USPS                          | Train Loss: 1.4603 | Train Acc: 0.8333
 Site-USPS                          | Train Loss: 1.4014 | Train Acc: 0.7500
 Site-USPS                          | Train Loss: 1.5513 | Train Acc: 0.6667
 Site-USPS                          | Train Loss: 1.5652 | Train Acc: 0.6579
 Site-USPS                          | Train Loss: 1.5581 | Train Acc: 0.6429
 Site-USPS                          | Train Loss: 1.4760 | Train Acc: 0.7619
 Site-USPS                          | Train Loss: 1.5160 | Train Acc: 0.7269
 Site-USPS                          | Train Loss: 1.5190 | Train Acc: 0.7286
 Site-USPS                          | Train Loss: 1.5178 | Train Acc: 0.7147
 Site-USPS                          | Train Loss: 1.4807 | Train Acc: 0.7547
 Site-MNIST                         | Train Loss: 1.7485 | Train Acc: 0.5500
 Site-MNIST                         | Train Loss: 1.6407 | Train Acc: 0.6389
 Site-MNIST                         | Train Loss: 2.0132 | Train Acc: 0.5969
 Site-MNIST                         | Train Loss: 1.6684 | Train Acc: 0.5665
 Site-MNIST                         | Train Loss: 1.7533 | Train Acc: 0.5429
 Site-MNIST                         | Train Loss: 1.7518 | Train Acc: 0.5000
 Site-SynthDigits                   | Train Loss: 2.1256 | Train Acc: 0.2781
 Site-SynthDigits                   | Train Loss: 2.1441 | Train Acc: 0.2051
 Site-SynthDigits                   | Train Loss: 2.0921 | Train Acc: 0.2688
 Site-SVHN                          | Train Loss: 2.2079 | Train Acc: 0.2210
 Site-SVHN                          | Train Loss: 2.1806 | Train Acc: 0.2263
 Site-MNIST_M                       | Train Loss: 2.2392 | Train Acc: 0.1809
Average Train Accuracy: 0.5460
 Site-USPS                          | Val  Loss: 2.4285 | Val  Acc: 0.0000
 Site-USPS                          | Val  Loss: 2.0915 | Val  Acc: 0.0000
 Site-USPS                          | Val  Loss: 1.8703 | Val  Acc: 0.2000
 Site-USPS                          | Val  Loss: 1.6060 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 1.6061 | Val  Acc: 0.7647
 Site-USPS                          | Val  Loss: 1.5841 | Val  Acc: 0.7419
 Site-USPS                          | Val  Loss: 1.4938 | Val  Acc: 0.7321
 Site-USPS                          | Val  Loss: 1.4719 | Val  Acc: 0.7647
 Site-USPS                          | Val  Loss: 1.5266 | Val  Acc: 0.7268
 Site-USPS                          | Val  Loss: 1.5262 | Val  Acc: 0.7190
 Site-MNIST                         | Val  Loss: 1.8763 | Val  Acc: 0.3000
 Site-MNIST                         | Val  Loss: 1.7158 | Val  Acc: 0.5000
 Site-MNIST                         | Val  Loss: 1.6745 | Val  Acc: 0.5625
 Site-MNIST                         | Val  Loss: 1.6925 | Val  Acc: 0.5517
 Site-MNIST                         | Val  Loss: 1.6674 | Val  Acc: 0.6095
 Site-MNIST                         | Val  Loss: 1.6497 | Val  Acc: 0.6190
 Site-SynthDigits                   | Val  Loss: 2.1463 | Val  Acc: 0.1892
 Site-SynthDigits                   | Val  Loss: 2.0653 | Val  Acc: 0.2206
 Site-SynthDigits                   | Val  Loss: 2.1399 | Val  Acc: 0.2377
 Site-SVHN                          | Val  Loss: 2.1478 | Val  Acc: 0.3556
 Site-SVHN                          | Val  Loss: 2.1446 | Val  Acc: 0.2716
 Site-MNIST_M                       | Val  Loss: 2.3166 | Val  Acc: 0.1286
Average Valid Accuracy: 0.4483
 Best site-USPS                      | Epoch:0 | Val Acc: 0.0000
 Best site-USPS                      | Epoch:0 | Val Acc: 0.0000
 Best site-USPS                      | Epoch:0 | Val Acc: 0.2000
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7647
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7419
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7321
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7647
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7268
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7190
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.3000
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5000
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5625
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.5517
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6095
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6190
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.1892
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2206
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.2377
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.3556
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.2716
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.1286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle/only_dcnet...
============ Train epoch 1 ============
cnt=[3, 10, 6, 1, 2, ]
cnt=[6, 1, 3, 3, 9, ]
 Site-USPS                          | Train Loss: 0.8351 | Train Acc: 0.8333
 Site-USPS                          | Train Loss: 0.7701 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.9824 | Train Acc: 0.7619
 Site-USPS                          | Train Loss: 1.0021 | Train Acc: 0.8158
 Site-USPS                          | Train Loss: 0.9056 | Train Acc: 0.8429
 Site-USPS                          | Train Loss: 0.9058 | Train Acc: 0.8730
 Site-USPS                          | Train Loss: 0.9634 | Train Acc: 0.8238
 Site-USPS                          | Train Loss: 0.9566 | Train Acc: 0.8093
 Site-USPS                          | Train Loss: 0.9539 | Train Acc: 0.8193
 Site-USPS                          | Train Loss: 0.9005 | Train Acc: 0.8566
 Site-MNIST                         | Train Loss: 1.2752 | Train Acc: 0.6500
 Site-MNIST                         | Train Loss: 1.3629 | Train Acc: 0.6806
 Site-MNIST                         | Train Loss: 1.3946 | Train Acc: 0.7287
 Site-MNIST                         | Train Loss: 1.2424 | Train Acc: 0.7339
 Site-MNIST                         | Train Loss: 1.3306 | Train Acc: 0.7000
 Site-MNIST                         | Train Loss: 1.3187 | Train Acc: 0.6865
 Site-SynthDigits                   | Train Loss: 2.0026 | Train Acc: 0.3510
 Site-SynthDigits                   | Train Loss: 1.9737 | Train Acc: 0.2857
 Site-SynthDigits                   | Train Loss: 1.9131 | Train Acc: 0.3299
 Site-SVHN                          | Train Loss: 2.1321 | Train Acc: 0.2320
 Site-SVHN                          | Train Loss: 2.0742 | Train Acc: 0.2813
 Site-MNIST_M                       | Train Loss: 2.1624 | Train Acc: 0.2411
Average Train Accuracy: 0.6479
 Site-USPS                          | Val  Loss: 2.4729 | Val  Acc: 0.0000
 Site-USPS                          | Val  Loss: 1.8819 | Val  Acc: 0.0000
 Site-USPS                          | Val  Loss: 1.5970 | Val  Acc: 0.2000
 Site-USPS                          | Val  Loss: 1.0974 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 1.0223 | Val  Acc: 0.7647
 Site-USPS                          | Val  Loss: 0.9441 | Val  Acc: 0.8387
 Site-USPS                          | Val  Loss: 0.9053 | Val  Acc: 0.8036
 Site-USPS                          | Val  Loss: 0.9013 | Val  Acc: 0.7941
 Site-USPS                          | Val  Loss: 0.9644 | Val  Acc: 0.7814
 Site-USPS                          | Val  Loss: 0.9590 | Val  Acc: 0.7855
 Site-MNIST                         | Val  Loss: 1.3934 | Val  Acc: 0.6000
 Site-MNIST                         | Val  Loss: 1.2276 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.2081 | Val  Acc: 0.6875
 Site-MNIST                         | Val  Loss: 1.2652 | Val  Acc: 0.6897
 Site-MNIST                         | Val  Loss: 1.2351 | Val  Acc: 0.7429
 Site-MNIST                         | Val  Loss: 1.2028 | Val  Acc: 0.7884
 Site-SynthDigits                   | Val  Loss: 2.0457 | Val  Acc: 0.3514
 Site-SynthDigits                   | Val  Loss: 1.9427 | Val  Acc: 0.3382
 Site-SynthDigits                   | Val  Loss: 1.9715 | Val  Acc: 0.3361
 Site-SVHN                          | Val  Loss: 2.0301 | Val  Acc: 0.3778
 Site-SVHN                          | Val  Loss: 2.0185 | Val  Acc: 0.2716
 Site-MNIST_M                       | Val  Loss: 2.2933 | Val  Acc: 0.2286
Average Valid Accuracy: 0.5324
 Best site-USPS                      | Epoch:1 | Val Acc: 0.0000
 Best site-USPS                      | Epoch:1 | Val Acc: 0.0000
 Best site-USPS                      | Epoch:1 | Val Acc: 0.2000
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7647
 Best site-USPS                      | Epoch:1 | Val Acc: 0.8387
 Best site-USPS                      | Epoch:1 | Val Acc: 0.8036
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7941
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7814
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7855
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6000
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6875
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.6897
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7429
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7884
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3514
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3382
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3361
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.3778
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.2716
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.2286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle/only_dcnet...
============ Train epoch 2 ============
cnt=[2, 10, 6, 1, 3, ]
cnt=[1, 9, 3, 6, 3, ]
 Site-USPS                          | Train Loss: 0.5939 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.5403 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.7336 | Train Acc: 0.8571
 Site-USPS                          | Train Loss: 0.7361 | Train Acc: 0.8421
 Site-USPS                          | Train Loss: 0.7459 | Train Acc: 0.8714
 Site-USPS                          | Train Loss: 0.6817 | Train Acc: 0.8730
 Site-USPS                          | Train Loss: 0.7368 | Train Acc: 0.8767
 Site-USPS                          | Train Loss: 0.6947 | Train Acc: 0.8606
 Site-USPS                          | Train Loss: 0.7101 | Train Acc: 0.8587
 Site-USPS                          | Train Loss: 0.6689 | Train Acc: 0.8785
 Site-MNIST                         | Train Loss: 1.0201 | Train Acc: 0.7750
 Site-MNIST                         | Train Loss: 0.9950 | Train Acc: 0.7639
 Site-MNIST                         | Train Loss: 1.1554 | Train Acc: 0.7829
 Site-MNIST                         | Train Loss: 0.9759 | Train Acc: 0.8069
 Site-MNIST                         | Train Loss: 1.0781 | Train Acc: 0.7714
 Site-MNIST                         | Train Loss: 1.0594 | Train Acc: 0.7513
 Site-SynthDigits                   | Train Loss: 1.8435 | Train Acc: 0.3775
 Site-SynthDigits                   | Train Loss: 1.9266 | Train Acc: 0.2894
 Site-SynthDigits                   | Train Loss: 1.8415 | Train Acc: 0.3381
 Site-SVHN                          | Train Loss: 2.1397 | Train Acc: 0.2099
 Site-SVHN                          | Train Loss: 2.1173 | Train Acc: 0.2783
 Site-MNIST_M                       | Train Loss: 2.1259 | Train Acc: 0.2447
Average Train Accuracy: 0.6958
 Site-USPS                          | Val  Loss: 2.1399 | Val  Acc: 0.0000
 Site-USPS                          | Val  Loss: 1.5104 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 1.3085 | Val  Acc: 0.4000
 Site-USPS                          | Val  Loss: 0.7845 | Val  Acc: 0.7778
 Site-USPS                          | Val  Loss: 0.7246 | Val  Acc: 0.8235
 Site-USPS                          | Val  Loss: 0.6367 | Val  Acc: 0.9032
 Site-USPS                          | Val  Loss: 0.6475 | Val  Acc: 0.8571
 Site-USPS                          | Val  Loss: 0.6455 | Val  Acc: 0.8627
 Site-USPS                          | Val  Loss: 0.7064 | Val  Acc: 0.8634
 Site-USPS                          | Val  Loss: 0.7062 | Val  Acc: 0.8550
 Site-MNIST                         | Val  Loss: 1.1072 | Val  Acc: 0.6000
 Site-MNIST                         | Val  Loss: 0.9448 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.9489 | Val  Acc: 0.7812
 Site-MNIST                         | Val  Loss: 1.0259 | Val  Acc: 0.7586
 Site-MNIST                         | Val  Loss: 0.9923 | Val  Acc: 0.7810
 Site-MNIST                         | Val  Loss: 0.9543 | Val  Acc: 0.8466
 Site-SynthDigits                   | Val  Loss: 1.9878 | Val  Acc: 0.3514
 Site-SynthDigits                   | Val  Loss: 1.9283 | Val  Acc: 0.3235
 Site-SynthDigits                   | Val  Loss: 1.8989 | Val  Acc: 0.3033
 Site-SVHN                          | Val  Loss: 2.0596 | Val  Acc: 0.2889
 Site-SVHN                          | Val  Loss: 2.0321 | Val  Acc: 0.2222
 Site-MNIST_M                       | Val  Loss: 2.2965 | Val  Acc: 0.2143
Average Valid Accuracy: 0.6026
 Best site-USPS                      | Epoch:2 | Val Acc: 0.0000
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:2 | Val Acc: 0.4000
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7778
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8235
 Best site-USPS                      | Epoch:2 | Val Acc: 0.9032
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8571
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8627
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8634
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8550
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.6000
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7812
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7586
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.7810
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8466
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3514
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3235
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.3033
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2889
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2222
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle/only_dcnet...
============ Train epoch 3 ============
cnt=[10, 3, 6, 1, 2, ]
cnt=[2, 10, 6, 3, 1, ]
 Site-USPS                          | Train Loss: 0.4745 | Train Acc: 0.8333
 Site-USPS                          | Train Loss: 0.4506 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.6259 | Train Acc: 0.8095
 Site-USPS                          | Train Loss: 0.6114 | Train Acc: 0.8421
 Site-USPS                          | Train Loss: 0.4776 | Train Acc: 0.9143
 Site-USPS                          | Train Loss: 0.5610 | Train Acc: 0.8968
 Site-USPS                          | Train Loss: 0.6169 | Train Acc: 0.8767
 Site-USPS                          | Train Loss: 0.5935 | Train Acc: 0.8557
 Site-USPS                          | Train Loss: 0.5960 | Train Acc: 0.8668
 Site-USPS                          | Train Loss: 0.5464 | Train Acc: 0.8883
 Site-MNIST                         | Train Loss: 0.8441 | Train Acc: 0.8250
 Site-MNIST                         | Train Loss: 0.8178 | Train Acc: 0.7639
 Site-MNIST                         | Train Loss: 0.6925 | Train Acc: 0.8140
 Site-MNIST                         | Train Loss: 0.8290 | Train Acc: 0.8283
 Site-MNIST                         | Train Loss: 0.9271 | Train Acc: 0.7881
 Site-MNIST                         | Train Loss: 0.9078 | Train Acc: 0.7765
 Site-SynthDigits                   | Train Loss: 1.7828 | Train Acc: 0.4040
 Site-SynthDigits                   | Train Loss: 1.8394 | Train Acc: 0.3260
 Site-SynthDigits                   | Train Loss: 1.7497 | Train Acc: 0.3931
 Site-SVHN                          | Train Loss: 2.1015 | Train Acc: 0.2265
 Site-SVHN                          | Train Loss: 2.0534 | Train Acc: 0.2844
 Site-MNIST_M                       | Train Loss: 2.0522 | Train Acc: 0.2872
Average Train Accuracy: 0.7008
 Site-USPS                          | Val  Loss: 1.9493 | Val  Acc: 0.0000
 Site-USPS                          | Val  Loss: 1.3421 | Val  Acc: 0.3333
 Site-USPS                          | Val  Loss: 1.1873 | Val  Acc: 0.2000
 Site-USPS                          | Val  Loss: 0.6683 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 0.6019 | Val  Acc: 0.8235
 Site-USPS                          | Val  Loss: 0.4986 | Val  Acc: 0.9355
 Site-USPS                          | Val  Loss: 0.5254 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.5222 | Val  Acc: 0.8529
 Site-USPS                          | Val  Loss: 0.5797 | Val  Acc: 0.8525
 Site-USPS                          | Val  Loss: 0.5824 | Val  Acc: 0.8610
 Site-MNIST                         | Val  Loss: 0.9560 | Val  Acc: 0.6000
 Site-MNIST                         | Val  Loss: 0.8016 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.7856 | Val  Acc: 0.8438
 Site-MNIST                         | Val  Loss: 0.8708 | Val  Acc: 0.8103
 Site-MNIST                         | Val  Loss: 0.8350 | Val  Acc: 0.8286
 Site-MNIST                         | Val  Loss: 0.7994 | Val  Acc: 0.8571
 Site-SynthDigits                   | Val  Loss: 1.9066 | Val  Acc: 0.3784
 Site-SynthDigits                   | Val  Loss: 1.8350 | Val  Acc: 0.3676
 Site-SynthDigits                   | Val  Loss: 1.8309 | Val  Acc: 0.3607
 Site-SVHN                          | Val  Loss: 2.0048 | Val  Acc: 0.3778
 Site-SVHN                          | Val  Loss: 1.9819 | Val  Acc: 0.2716
 Site-MNIST_M                       | Val  Loss: 2.2400 | Val  Acc: 0.2429
Average Valid Accuracy: 0.5962
============ Train epoch 4 ============
cnt=[3, 10, 1, 6, 2, ]
cnt=[3, 9, 3, 1, 6, ]
 Site-USPS                          | Train Loss: 0.3918 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.3451 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.5250 | Train Acc: 0.8571
 Site-USPS                          | Train Loss: 0.5087 | Train Acc: 0.8947
 Site-USPS                          | Train Loss: 0.5185 | Train Acc: 0.9286
 Site-USPS                          | Train Loss: 0.4674 | Train Acc: 0.9048
 Site-USPS                          | Train Loss: 0.5273 | Train Acc: 0.8943
 Site-USPS                          | Train Loss: 0.4927 | Train Acc: 0.9046
 Site-USPS                          | Train Loss: 0.4989 | Train Acc: 0.8995
 Site-USPS                          | Train Loss: 0.4589 | Train Acc: 0.9049
 Site-MNIST                         | Train Loss: 0.7627 | Train Acc: 0.8250
 Site-MNIST                         | Train Loss: 0.7109 | Train Acc: 0.8194
 Site-MNIST                         | Train Loss: 0.6535 | Train Acc: 0.8062
 Site-MNIST                         | Train Loss: 0.7394 | Train Acc: 0.8541
 Site-MNIST                         | Train Loss: 0.8290 | Train Acc: 0.8095
 Site-MNIST                         | Train Loss: 0.8097 | Train Acc: 0.8056
 Site-SynthDigits                   | Train Loss: 1.7643 | Train Acc: 0.4371
 Site-SynthDigits                   | Train Loss: 1.7661 | Train Acc: 0.3516
 Site-SynthDigits                   | Train Loss: 1.6501 | Train Acc: 0.4236
 Site-SVHN                          | Train Loss: 2.1010 | Train Acc: 0.2320
 Site-SVHN                          | Train Loss: 2.0222 | Train Acc: 0.2997
 Site-MNIST_M                       | Train Loss: 2.0581 | Train Acc: 0.2801
Average Train Accuracy: 0.7295
 Site-USPS                          | Val  Loss: 1.6791 | Val  Acc: 0.0000
 Site-USPS                          | Val  Loss: 1.1065 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 1.0174 | Val  Acc: 0.8000
 Site-USPS                          | Val  Loss: 0.5536 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4907 | Val  Acc: 0.8824
 Site-USPS                          | Val  Loss: 0.4087 | Val  Acc: 0.9355
 Site-USPS                          | Val  Loss: 0.4442 | Val  Acc: 0.8929
 Site-USPS                          | Val  Loss: 0.4398 | Val  Acc: 0.9118
 Site-USPS                          | Val  Loss: 0.4837 | Val  Acc: 0.8962
 Site-USPS                          | Val  Loss: 0.4917 | Val  Acc: 0.8943
 Site-MNIST                         | Val  Loss: 0.8909 | Val  Acc: 0.6000
 Site-MNIST                         | Val  Loss: 0.7118 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.6975 | Val  Acc: 0.8438
 Site-MNIST                         | Val  Loss: 0.7982 | Val  Acc: 0.8276
 Site-MNIST                         | Val  Loss: 0.7585 | Val  Acc: 0.8667
 Site-MNIST                         | Val  Loss: 0.7215 | Val  Acc: 0.8730
 Site-SynthDigits                   | Val  Loss: 1.8209 | Val  Acc: 0.4054
 Site-SynthDigits                   | Val  Loss: 1.7502 | Val  Acc: 0.3676
 Site-SynthDigits                   | Val  Loss: 1.7497 | Val  Acc: 0.3525
 Site-SVHN                          | Val  Loss: 2.0026 | Val  Acc: 0.3333
 Site-SVHN                          | Val  Loss: 1.9551 | Val  Acc: 0.2593
 Site-MNIST_M                       | Val  Loss: 2.2263 | Val  Acc: 0.2571
Average Valid Accuracy: 0.6656
 Best site-USPS                      | Epoch:4 | Val Acc: 0.0000
 Best site-USPS                      | Epoch:4 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8000
 Best site-USPS                      | Epoch:4 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8824
 Best site-USPS                      | Epoch:4 | Val Acc: 0.9355
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8929
 Best site-USPS                      | Epoch:4 | Val Acc: 0.9118
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8962
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8943
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.6000
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8438
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8276
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8667
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8730
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.4054
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3676
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.3525
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.3333
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2593
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.2571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle/only_dcnet...
============ Train epoch 5 ============
cnt=[10, 3, 1, 6, 2, ]
cnt=[1, 6, 9, 3, 3, ]
 Site-USPS                          | Train Loss: 0.3482 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.3008 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.4799 | Train Acc: 0.8571
 Site-USPS                          | Train Loss: 0.4492 | Train Acc: 0.8947
 Site-USPS                          | Train Loss: 0.3640 | Train Acc: 0.9286
 Site-USPS                          | Train Loss: 0.4058 | Train Acc: 0.9206
 Site-USPS                          | Train Loss: 0.4649 | Train Acc: 0.9075
 Site-USPS                          | Train Loss: 0.4422 | Train Acc: 0.9120
 Site-USPS                          | Train Loss: 0.4422 | Train Acc: 0.9117
 Site-USPS                          | Train Loss: 0.4014 | Train Acc: 0.9155
 Site-MNIST                         | Train Loss: 0.6951 | Train Acc: 0.8000
 Site-MNIST                         | Train Loss: 0.5619 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.8620 | Train Acc: 0.7984
 Site-MNIST                         | Train Loss: 0.6602 | Train Acc: 0.8584
 Site-MNIST                         | Train Loss: 0.7516 | Train Acc: 0.8119
 Site-MNIST                         | Train Loss: 0.7393 | Train Acc: 0.8188
 Site-SynthDigits                   | Train Loss: 1.7715 | Train Acc: 0.4570
 Site-SynthDigits                   | Train Loss: 1.7275 | Train Acc: 0.3846
 Site-SynthDigits                   | Train Loss: 1.5880 | Train Acc: 0.4481
 Site-SVHN                          | Train Loss: 2.0744 | Train Acc: 0.2320
 Site-SVHN                          | Train Loss: 2.0411 | Train Acc: 0.3119
 Site-MNIST_M                       | Train Loss: 2.0149 | Train Acc: 0.3085
Average Train Accuracy: 0.7376
 Site-USPS                          | Val  Loss: 1.4563 | Val  Acc: 0.0000
 Site-USPS                          | Val  Loss: 0.9245 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 0.8571 | Val  Acc: 0.8000
 Site-USPS                          | Val  Loss: 0.4543 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4191 | Val  Acc: 0.9412
 Site-USPS                          | Val  Loss: 0.3576 | Val  Acc: 0.9355
 Site-USPS                          | Val  Loss: 0.3942 | Val  Acc: 0.8929
 Site-USPS                          | Val  Loss: 0.3794 | Val  Acc: 0.9216
 Site-USPS                          | Val  Loss: 0.4168 | Val  Acc: 0.9126
 Site-USPS                          | Val  Loss: 0.4247 | Val  Acc: 0.9063
 Site-MNIST                         | Val  Loss: 0.8517 | Val  Acc: 0.7000
 Site-MNIST                         | Val  Loss: 0.6683 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.6413 | Val  Acc: 0.8438
 Site-MNIST                         | Val  Loss: 0.7365 | Val  Acc: 0.8103
 Site-MNIST                         | Val  Loss: 0.6897 | Val  Acc: 0.8667
 Site-MNIST                         | Val  Loss: 0.6550 | Val  Acc: 0.8624
 Site-SynthDigits                   | Val  Loss: 1.7580 | Val  Acc: 0.4324
 Site-SynthDigits                   | Val  Loss: 1.6835 | Val  Acc: 0.3971
 Site-SynthDigits                   | Val  Loss: 1.6756 | Val  Acc: 0.4098
 Site-SVHN                          | Val  Loss: 1.9604 | Val  Acc: 0.3333
 Site-SVHN                          | Val  Loss: 1.9195 | Val  Acc: 0.2840
 Site-MNIST_M                       | Val  Loss: 2.2031 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6809
 Best site-USPS                      | Epoch:5 | Val Acc: 0.0000
 Best site-USPS                      | Epoch:5 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8000
 Best site-USPS                      | Epoch:5 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:5 | Val Acc: 0.9412
 Best site-USPS                      | Epoch:5 | Val Acc: 0.9355
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8929
 Best site-USPS                      | Epoch:5 | Val Acc: 0.9216
 Best site-USPS                      | Epoch:5 | Val Acc: 0.9126
 Best site-USPS                      | Epoch:5 | Val Acc: 0.9063
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7000
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8438
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8103
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8667
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8624
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4324
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.3971
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4098
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.3333
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2840
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle/only_dcnet...
============ Train epoch 6 ============
cnt=[2, 10, 6, 1, 3, ]
cnt=[3, 1, 6, 3, 9, ]
 Site-USPS                          | Train Loss: 0.3202 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.2756 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.4340 | Train Acc: 0.8571
 Site-USPS                          | Train Loss: 0.4036 | Train Acc: 0.9211
 Site-USPS                          | Train Loss: 0.2295 | Train Acc: 0.9429
 Site-USPS                          | Train Loss: 0.3651 | Train Acc: 0.9206
 Site-USPS                          | Train Loss: 0.4573 | Train Acc: 0.9119
 Site-USPS                          | Train Loss: 0.3856 | Train Acc: 0.9169
 Site-USPS                          | Train Loss: 0.4013 | Train Acc: 0.9144
 Site-USPS                          | Train Loss: 0.3616 | Train Acc: 0.9223
 Site-MNIST                         | Train Loss: 0.6278 | Train Acc: 0.8250
 Site-MNIST                         | Train Loss: 0.6877 | Train Acc: 0.8194
 Site-MNIST                         | Train Loss: 0.6994 | Train Acc: 0.8295
 Site-MNIST                         | Train Loss: 0.6219 | Train Acc: 0.8541
 Site-MNIST                         | Train Loss: 0.7016 | Train Acc: 0.8190
 Site-MNIST                         | Train Loss: 0.6751 | Train Acc: 0.8360
 Site-SynthDigits                   | Train Loss: 1.6242 | Train Acc: 0.4636
 Site-SynthDigits                   | Train Loss: 1.5971 | Train Acc: 0.4359
 Site-SynthDigits                   | Train Loss: 1.5048 | Train Acc: 0.4766
 Site-SVHN                          | Train Loss: 2.0421 | Train Acc: 0.2265
 Site-SVHN                          | Train Loss: 1.8847 | Train Acc: 0.3211
 Site-MNIST_M                       | Train Loss: 1.9934 | Train Acc: 0.3227
Average Train Accuracy: 0.7479
 Site-USPS                          | Val  Loss: 1.2557 | Val  Acc: 0.0000
 Site-USPS                          | Val  Loss: 0.7962 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 0.7616 | Val  Acc: 0.8000
 Site-USPS                          | Val  Loss: 0.4072 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3758 | Val  Acc: 0.9412
 Site-USPS                          | Val  Loss: 0.3234 | Val  Acc: 0.9355
 Site-USPS                          | Val  Loss: 0.3591 | Val  Acc: 0.8929
 Site-USPS                          | Val  Loss: 0.3427 | Val  Acc: 0.9118
 Site-USPS                          | Val  Loss: 0.3736 | Val  Acc: 0.9126
 Site-USPS                          | Val  Loss: 0.3825 | Val  Acc: 0.9063
 Site-MNIST                         | Val  Loss: 0.7863 | Val  Acc: 0.7000
 Site-MNIST                         | Val  Loss: 0.6126 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.5859 | Val  Acc: 0.8438
 Site-MNIST                         | Val  Loss: 0.6786 | Val  Acc: 0.8103
 Site-MNIST                         | Val  Loss: 0.6343 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.6007 | Val  Acc: 0.8677
 Site-SynthDigits                   | Val  Loss: 1.6659 | Val  Acc: 0.5135
 Site-SynthDigits                   | Val  Loss: 1.5884 | Val  Acc: 0.4853
 Site-SynthDigits                   | Val  Loss: 1.6023 | Val  Acc: 0.4426
 Site-SVHN                          | Val  Loss: 1.9304 | Val  Acc: 0.3333
 Site-SVHN                          | Val  Loss: 1.8802 | Val  Acc: 0.2840
 Site-MNIST_M                       | Val  Loss: 2.1530 | Val  Acc: 0.3143
Average Valid Accuracy: 0.6908
 Best site-USPS                      | Epoch:6 | Val Acc: 0.0000
 Best site-USPS                      | Epoch:6 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8000
 Best site-USPS                      | Epoch:6 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:6 | Val Acc: 0.9412
 Best site-USPS                      | Epoch:6 | Val Acc: 0.9355
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8929
 Best site-USPS                      | Epoch:6 | Val Acc: 0.9118
 Best site-USPS                      | Epoch:6 | Val Acc: 0.9126
 Best site-USPS                      | Epoch:6 | Val Acc: 0.9063
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7000
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8438
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8103
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8677
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5135
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4853
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.4426
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.3333
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2840
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.3143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle/only_dcnet...
============ Train epoch 7 ============
cnt=[10, 6, 2, 1, 3, ]
cnt=[3, 10, 2, 6, 1, ]
 Site-USPS                          | Train Loss: 0.2856 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.2461 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.4138 | Train Acc: 0.8095
 Site-USPS                          | Train Loss: 0.3743 | Train Acc: 0.9211
 Site-USPS                          | Train Loss: 0.2288 | Train Acc: 0.9429
 Site-USPS                          | Train Loss: 0.3257 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.3908 | Train Acc: 0.9163
 Site-USPS                          | Train Loss: 0.3493 | Train Acc: 0.9144
 Site-USPS                          | Train Loss: 0.3621 | Train Acc: 0.9185
 Site-USPS                          | Train Loss: 0.3246 | Train Acc: 0.9306
 Site-MNIST                         | Train Loss: 0.5792 | Train Acc: 0.8500
 Site-MNIST                         | Train Loss: 0.6063 | Train Acc: 0.8472
 Site-MNIST                         | Train Loss: 0.5524 | Train Acc: 0.8450
 Site-MNIST                         | Train Loss: 0.5556 | Train Acc: 0.8712
 Site-MNIST                         | Train Loss: 0.6525 | Train Acc: 0.8238
 Site-MNIST                         | Train Loss: 0.6285 | Train Acc: 0.8505
 Site-SynthDigits                   | Train Loss: 1.5300 | Train Acc: 0.4901
 Site-SynthDigits                   | Train Loss: 1.5441 | Train Acc: 0.4542
 Site-SynthDigits                   | Train Loss: 1.4359 | Train Acc: 0.5214
 Site-SVHN                          | Train Loss: 2.0258 | Train Acc: 0.2376
 Site-SVHN                          | Train Loss: 1.9478 | Train Acc: 0.3272
 Site-MNIST_M                       | Train Loss: 1.9518 | Train Acc: 0.3227
Average Train Accuracy: 0.7571
 Site-USPS                          | Val  Loss: 1.1461 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.7581 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.6954 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3698 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3274 | Val  Acc: 0.9412
 Site-USPS                          | Val  Loss: 0.2882 | Val  Acc: 0.9355
 Site-USPS                          | Val  Loss: 0.3271 | Val  Acc: 0.8929
 Site-USPS                          | Val  Loss: 0.3142 | Val  Acc: 0.9216
 Site-USPS                          | Val  Loss: 0.3402 | Val  Acc: 0.9126
 Site-USPS                          | Val  Loss: 0.3507 | Val  Acc: 0.9094
 Site-MNIST                         | Val  Loss: 0.7228 | Val  Acc: 0.7000
 Site-MNIST                         | Val  Loss: 0.5646 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.5541 | Val  Acc: 0.8438
 Site-MNIST                         | Val  Loss: 0.6485 | Val  Acc: 0.8276
 Site-MNIST                         | Val  Loss: 0.5946 | Val  Acc: 0.8667
 Site-MNIST                         | Val  Loss: 0.5550 | Val  Acc: 0.8836
 Site-SynthDigits                   | Val  Loss: 1.5950 | Val  Acc: 0.5405
 Site-SynthDigits                   | Val  Loss: 1.5326 | Val  Acc: 0.5147
 Site-SynthDigits                   | Val  Loss: 1.5326 | Val  Acc: 0.4672
 Site-SVHN                          | Val  Loss: 1.9136 | Val  Acc: 0.3556
 Site-SVHN                          | Val  Loss: 1.8452 | Val  Acc: 0.3086
 Site-MNIST_M                       | Val  Loss: 2.1274 | Val  Acc: 0.3429
Average Valid Accuracy: 0.7701
 Best site-USPS                      | Epoch:7 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:7 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:7 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:7 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:7 | Val Acc: 0.9412
 Best site-USPS                      | Epoch:7 | Val Acc: 0.9355
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8929
 Best site-USPS                      | Epoch:7 | Val Acc: 0.9216
 Best site-USPS                      | Epoch:7 | Val Acc: 0.9126
 Best site-USPS                      | Epoch:7 | Val Acc: 0.9094
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7000
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8438
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8276
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8667
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8836
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5405
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5147
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.4672
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3556
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3086
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.3429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle/only_dcnet...
============ Train epoch 8 ============
cnt=[1, 10, 5, 5, 1, ]
cnt=[3, 6, 10, 2, 1, ]
 Site-USPS                          | Train Loss: 0.2515 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.2236 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.3981 | Train Acc: 0.8095
 Site-USPS                          | Train Loss: 0.3434 | Train Acc: 0.9211
 Site-USPS                          | Train Loss: 0.3543 | Train Acc: 0.9286
 Site-USPS                          | Train Loss: 0.2971 | Train Acc: 0.9524
 Site-USPS                          | Train Loss: 0.3671 | Train Acc: 0.9119
 Site-USPS                          | Train Loss: 0.3112 | Train Acc: 0.9242
 Site-USPS                          | Train Loss: 0.3306 | Train Acc: 0.9266
 Site-USPS                          | Train Loss: 0.2998 | Train Acc: 0.9396
 Site-MNIST                         | Train Loss: 0.5428 | Train Acc: 0.8250
 Site-MNIST                         | Train Loss: 0.6936 | Train Acc: 0.8194
 Site-MNIST                         | Train Loss: 0.4579 | Train Acc: 0.8372
 Site-MNIST                         | Train Loss: 0.5408 | Train Acc: 0.8755
 Site-MNIST                         | Train Loss: 0.6161 | Train Acc: 0.8405
 Site-MNIST                         | Train Loss: 0.5863 | Train Acc: 0.8532
 Site-SynthDigits                   | Train Loss: 1.5118 | Train Acc: 0.5033
 Site-SynthDigits                   | Train Loss: 1.4696 | Train Acc: 0.4982
 Site-SynthDigits                   | Train Loss: 1.3847 | Train Acc: 0.5316
 Site-SVHN                          | Train Loss: 2.0051 | Train Acc: 0.2431
 Site-SVHN                          | Train Loss: 1.8477 | Train Acc: 0.3333
 Site-MNIST_M                       | Train Loss: 1.9197 | Train Acc: 0.3546
Average Train Accuracy: 0.7612
 Site-USPS                          | Val  Loss: 0.9777 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.6336 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.5997 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3233 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2953 | Val  Acc: 0.9412
 Site-USPS                          | Val  Loss: 0.2692 | Val  Acc: 0.9032
 Site-USPS                          | Val  Loss: 0.3045 | Val  Acc: 0.8929
 Site-USPS                          | Val  Loss: 0.2872 | Val  Acc: 0.9314
 Site-USPS                          | Val  Loss: 0.3074 | Val  Acc: 0.9290
 Site-USPS                          | Val  Loss: 0.3177 | Val  Acc: 0.9094
 Site-MNIST                         | Val  Loss: 0.7142 | Val  Acc: 0.7000
 Site-MNIST                         | Val  Loss: 0.5453 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.5191 | Val  Acc: 0.8438
 Site-MNIST                         | Val  Loss: 0.6084 | Val  Acc: 0.8276
 Site-MNIST                         | Val  Loss: 0.5545 | Val  Acc: 0.8857
 Site-MNIST                         | Val  Loss: 0.5186 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.5399 | Val  Acc: 0.5676
 Site-SynthDigits                   | Val  Loss: 1.4665 | Val  Acc: 0.5588
 Site-SynthDigits                   | Val  Loss: 1.4830 | Val  Acc: 0.5082
 Site-SVHN                          | Val  Loss: 1.8913 | Val  Acc: 0.3556
 Site-SVHN                          | Val  Loss: 1.8273 | Val  Acc: 0.3210
 Site-MNIST_M                       | Val  Loss: 2.0793 | Val  Acc: 0.3714
Average Valid Accuracy: 0.7779
 Best site-USPS                      | Epoch:8 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:8 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:8 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:8 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:8 | Val Acc: 0.9412
 Best site-USPS                      | Epoch:8 | Val Acc: 0.9032
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8929
 Best site-USPS                      | Epoch:8 | Val Acc: 0.9314
 Best site-USPS                      | Epoch:8 | Val Acc: 0.9290
 Best site-USPS                      | Epoch:8 | Val Acc: 0.9094
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7000
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8438
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8276
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8857
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5676
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5588
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5082
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3556
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3210
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.3714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle/only_dcnet...
============ Train epoch 9 ============
cnt=[10, 3, 1, 6, 2, ]
cnt=[1, 10, 6, 3, 2, ]
 Site-USPS                          | Train Loss: 0.2276 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.2135 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.3739 | Train Acc: 0.8095
 Site-USPS                          | Train Loss: 0.3222 | Train Acc: 0.9211
 Site-USPS                          | Train Loss: 0.2825 | Train Acc: 0.9429
 Site-USPS                          | Train Loss: 0.2728 | Train Acc: 0.9524
 Site-USPS                          | Train Loss: 0.3539 | Train Acc: 0.9251
 Site-USPS                          | Train Loss: 0.2982 | Train Acc: 0.9242
 Site-USPS                          | Train Loss: 0.3087 | Train Acc: 0.9280
 Site-USPS                          | Train Loss: 0.2808 | Train Acc: 0.9411
 Site-MNIST                         | Train Loss: 0.4988 | Train Acc: 0.8500
 Site-MNIST                         | Train Loss: 0.5165 | Train Acc: 0.8194
 Site-MNIST                         | Train Loss: 0.4633 | Train Acc: 0.8450
 Site-MNIST                         | Train Loss: 0.4869 | Train Acc: 0.8798
 Site-MNIST                         | Train Loss: 0.5655 | Train Acc: 0.8595
 Site-MNIST                         | Train Loss: 0.5417 | Train Acc: 0.8690
 Site-SynthDigits                   | Train Loss: 1.5121 | Train Acc: 0.5232
 Site-SynthDigits                   | Train Loss: 1.4557 | Train Acc: 0.5201
 Site-SynthDigits                   | Train Loss: 1.3268 | Train Acc: 0.5601
 Site-SVHN                          | Train Loss: 1.9723 | Train Acc: 0.2541
 Site-SVHN                          | Train Loss: 1.9102 | Train Acc: 0.3364
 Site-MNIST_M                       | Train Loss: 1.8620 | Train Acc: 0.3582
Average Train Accuracy: 0.7698
 Site-USPS                          | Val  Loss: 0.7866 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.5397 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.5316 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2998 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2725 | Val  Acc: 0.9412
 Site-USPS                          | Val  Loss: 0.2558 | Val  Acc: 0.9032
 Site-USPS                          | Val  Loss: 0.2877 | Val  Acc: 0.8929
 Site-USPS                          | Val  Loss: 0.2697 | Val  Acc: 0.9314
 Site-USPS                          | Val  Loss: 0.2845 | Val  Acc: 0.9290
 Site-USPS                          | Val  Loss: 0.2958 | Val  Acc: 0.9184
 Site-MNIST                         | Val  Loss: 0.6710 | Val  Acc: 0.7000
 Site-MNIST                         | Val  Loss: 0.5118 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.4867 | Val  Acc: 0.8438
 Site-MNIST                         | Val  Loss: 0.5751 | Val  Acc: 0.8276
 Site-MNIST                         | Val  Loss: 0.5227 | Val  Acc: 0.8857
 Site-MNIST                         | Val  Loss: 0.4817 | Val  Acc: 0.8942
 Site-SynthDigits                   | Val  Loss: 1.4749 | Val  Acc: 0.5405
 Site-SynthDigits                   | Val  Loss: 1.3688 | Val  Acc: 0.5882
 Site-SynthDigits                   | Val  Loss: 1.4303 | Val  Acc: 0.5328
 Site-SVHN                          | Val  Loss: 1.8474 | Val  Acc: 0.3778
 Site-SVHN                          | Val  Loss: 1.7791 | Val  Acc: 0.3210
 Site-MNIST_M                       | Val  Loss: 2.0591 | Val  Acc: 0.3571
Average Valid Accuracy: 0.7801
 Best site-USPS                      | Epoch:9 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:9 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:9 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:9 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:9 | Val Acc: 0.9412
 Best site-USPS                      | Epoch:9 | Val Acc: 0.9032
 Best site-USPS                      | Epoch:9 | Val Acc: 0.8929
 Best site-USPS                      | Epoch:9 | Val Acc: 0.9314
 Best site-USPS                      | Epoch:9 | Val Acc: 0.9290
 Best site-USPS                      | Epoch:9 | Val Acc: 0.9184
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7000
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8438
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8276
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8857
 Best site-MNIST                     | Epoch:9 | Val Acc: 0.8942
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.5405
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.5882
 Best site-SynthDigits               | Epoch:9 | Val Acc: 0.5328
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3778
 Best site-SVHN                      | Epoch:9 | Val Acc: 0.3210
 Best site-MNIST_M                   | Epoch:9 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle/only_dcnet...
============ Train epoch 10 ============
cnt=[10, 2, 6, 1, 3, ]
cnt=[10, 6, 3, 2, 1, ]
 Site-USPS                          | Train Loss: 0.2131 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.2143 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.3621 | Train Acc: 0.8095
 Site-USPS                          | Train Loss: 0.3044 | Train Acc: 0.9211
 Site-USPS                          | Train Loss: 0.3240 | Train Acc: 0.9429
 Site-USPS                          | Train Loss: 0.2571 | Train Acc: 0.9524
 Site-USPS                          | Train Loss: 0.3221 | Train Acc: 0.9251
 Site-USPS                          | Train Loss: 0.2802 | Train Acc: 0.9242
 Site-USPS                          | Train Loss: 0.2824 | Train Acc: 0.9375
 Site-USPS                          | Train Loss: 0.2588 | Train Acc: 0.9434
 Site-MNIST                         | Train Loss: 0.4557 | Train Acc: 0.9000
 Site-MNIST                         | Train Loss: 0.4111 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.4944 | Train Acc: 0.8605
 Site-MNIST                         | Train Loss: 0.4517 | Train Acc: 0.8755
 Site-MNIST                         | Train Loss: 0.5277 | Train Acc: 0.8714
 Site-MNIST                         | Train Loss: 0.5038 | Train Acc: 0.8770
 Site-SynthDigits                   | Train Loss: 1.4100 | Train Acc: 0.5430
 Site-SynthDigits                   | Train Loss: 1.3795 | Train Acc: 0.5568
 Site-SynthDigits                   | Train Loss: 1.2917 | Train Acc: 0.5845
 Site-SVHN                          | Train Loss: 1.9580 | Train Acc: 0.2707
 Site-SVHN                          | Train Loss: 1.7902 | Train Acc: 0.3517
 Site-MNIST_M                       | Train Loss: 1.8703 | Train Acc: 0.3759
Average Train Accuracy: 0.7806
 Site-USPS                          | Val  Loss: 0.6603 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4878 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4841 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2798 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2501 | Val  Acc: 0.9412
 Site-USPS                          | Val  Loss: 0.2357 | Val  Acc: 0.9032
 Site-USPS                          | Val  Loss: 0.2678 | Val  Acc: 0.8929
 Site-USPS                          | Val  Loss: 0.2502 | Val  Acc: 0.9412
 Site-USPS                          | Val  Loss: 0.2655 | Val  Acc: 0.9290
 Site-USPS                          | Val  Loss: 0.2786 | Val  Acc: 0.9215
 Site-MNIST                         | Val  Loss: 0.6048 | Val  Acc: 0.7000
 Site-MNIST                         | Val  Loss: 0.4651 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.4526 | Val  Acc: 0.8438
 Site-MNIST                         | Val  Loss: 0.5388 | Val  Acc: 0.8276
 Site-MNIST                         | Val  Loss: 0.4879 | Val  Acc: 0.8667
 Site-MNIST                         | Val  Loss: 0.4419 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.4197 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 1.3140 | Val  Acc: 0.6324
 Site-SynthDigits                   | Val  Loss: 1.3839 | Val  Acc: 0.5574
 Site-SVHN                          | Val  Loss: 1.8218 | Val  Acc: 0.3778
 Site-SVHN                          | Val  Loss: 1.7484 | Val  Acc: 0.3457
 Site-MNIST_M                       | Val  Loss: 2.0402 | Val  Acc: 0.3571
Average Valid Accuracy: 0.7863
 Best site-USPS                      | Epoch:10 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:10 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:10 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:10 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9412
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9032
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8929
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9412
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9290
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9215
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7000
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8438
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8276
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8667
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5946
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.6324
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5574
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3778
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3457
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle/only_dcnet...
============ Train epoch 11 ============
cnt=[10, 1, 1, 5, 5, ]
cnt=[10, 3, 6, 1, 2, ]
 Site-USPS                          | Train Loss: 0.1901 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.2060 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.3574 | Train Acc: 0.8571
 Site-USPS                          | Train Loss: 0.2884 | Train Acc: 0.9211
 Site-USPS                          | Train Loss: 0.2733 | Train Acc: 0.9286
 Site-USPS                          | Train Loss: 0.2427 | Train Acc: 0.9603
 Site-USPS                          | Train Loss: 0.2947 | Train Acc: 0.9427
 Site-USPS                          | Train Loss: 0.2656 | Train Acc: 0.9291
 Site-USPS                          | Train Loss: 0.2689 | Train Acc: 0.9348
 Site-USPS                          | Train Loss: 0.2464 | Train Acc: 0.9464
 Site-MNIST                         | Train Loss: 0.4273 | Train Acc: 0.9250
 Site-MNIST                         | Train Loss: 0.4063 | Train Acc: 0.8472
 Site-MNIST                         | Train Loss: 0.3569 | Train Acc: 0.8527
 Site-MNIST                         | Train Loss: 0.4191 | Train Acc: 0.8755
 Site-MNIST                         | Train Loss: 0.4984 | Train Acc: 0.8762
 Site-MNIST                         | Train Loss: 0.4722 | Train Acc: 0.8836
 Site-SynthDigits                   | Train Loss: 1.4170 | Train Acc: 0.5563
 Site-SynthDigits                   | Train Loss: 1.3503 | Train Acc: 0.5714
 Site-SynthDigits                   | Train Loss: 1.2470 | Train Acc: 0.6049
 Site-SVHN                          | Train Loss: 1.9245 | Train Acc: 0.2873
 Site-SVHN                          | Train Loss: 1.7546 | Train Acc: 0.3609
 Site-MNIST_M                       | Train Loss: 1.8169 | Train Acc: 0.3901
Average Train Accuracy: 0.7894
 Site-USPS                          | Val  Loss: 0.6117 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4424 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4376 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2547 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2332 | Val  Acc: 0.9412
 Site-USPS                          | Val  Loss: 0.2303 | Val  Acc: 0.9032
 Site-USPS                          | Val  Loss: 0.2560 | Val  Acc: 0.8929
 Site-USPS                          | Val  Loss: 0.2361 | Val  Acc: 0.9314
 Site-USPS                          | Val  Loss: 0.2500 | Val  Acc: 0.9290
 Site-USPS                          | Val  Loss: 0.2616 | Val  Acc: 0.9335
 Site-MNIST                         | Val  Loss: 0.5923 | Val  Acc: 0.7000
 Site-MNIST                         | Val  Loss: 0.4507 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.4232 | Val  Acc: 0.8438
 Site-MNIST                         | Val  Loss: 0.5043 | Val  Acc: 0.8276
 Site-MNIST                         | Val  Loss: 0.4547 | Val  Acc: 0.8667
 Site-MNIST                         | Val  Loss: 0.4103 | Val  Acc: 0.8783
 Site-SynthDigits                   | Val  Loss: 1.3771 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 1.2787 | Val  Acc: 0.7059
 Site-SynthDigits                   | Val  Loss: 1.3404 | Val  Acc: 0.6066
 Site-SVHN                          | Val  Loss: 1.7989 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 1.7270 | Val  Acc: 0.3827
 Site-MNIST_M                       | Val  Loss: 1.9873 | Val  Acc: 0.3714
Average Valid Accuracy: 0.7985
 Best site-USPS                      | Epoch:11 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:11 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:11 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:11 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9412
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9032
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8929
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9314
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9290
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9335
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7000
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8438
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8276
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8667
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8783
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.6757
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.7059
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.6066
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3827
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.3714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle/only_dcnet...
============ Train epoch 12 ============
cnt=[1, 5, 1, 6, 9, ]
cnt=[10, 6, 3, 2, 1, ]
 Site-USPS                          | Train Loss: 0.1796 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.2059 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.3407 | Train Acc: 0.8571
 Site-USPS                          | Train Loss: 0.2645 | Train Acc: 0.9211
 Site-USPS                          | Train Loss: 0.2121 | Train Acc: 0.9286
 Site-USPS                          | Train Loss: 0.2326 | Train Acc: 0.9683
 Site-USPS                          | Train Loss: 0.3008 | Train Acc: 0.9427
 Site-USPS                          | Train Loss: 0.2510 | Train Acc: 0.9438
 Site-USPS                          | Train Loss: 0.2620 | Train Acc: 0.9389
 Site-USPS                          | Train Loss: 0.2339 | Train Acc: 0.9472
 Site-MNIST                         | Train Loss: 0.3867 | Train Acc: 0.9000
 Site-MNIST                         | Train Loss: 0.3562 | Train Acc: 0.8472
 Site-MNIST                         | Train Loss: 0.3594 | Train Acc: 0.8682
 Site-MNIST                         | Train Loss: 0.4045 | Train Acc: 0.8841
 Site-MNIST                         | Train Loss: 0.4674 | Train Acc: 0.8929
 Site-MNIST                         | Train Loss: 0.4414 | Train Acc: 0.8942
 Site-SynthDigits                   | Train Loss: 1.3348 | Train Acc: 0.5629
 Site-SynthDigits                   | Train Loss: 1.2841 | Train Acc: 0.5751
 Site-SynthDigits                   | Train Loss: 1.2110 | Train Acc: 0.6029
 Site-SVHN                          | Train Loss: 1.9083 | Train Acc: 0.2873
 Site-SVHN                          | Train Loss: 1.8887 | Train Acc: 0.3731
 Site-MNIST_M                       | Train Loss: 1.7846 | Train Acc: 0.3936
Average Train Accuracy: 0.7930
 Site-USPS                          | Val  Loss: 0.4791 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3592 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3774 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2201 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2167 | Val  Acc: 0.9412
 Site-USPS                          | Val  Loss: 0.2163 | Val  Acc: 0.9032
 Site-USPS                          | Val  Loss: 0.2415 | Val  Acc: 0.9107
 Site-USPS                          | Val  Loss: 0.2179 | Val  Acc: 0.9412
 Site-USPS                          | Val  Loss: 0.2278 | Val  Acc: 0.9672
 Site-USPS                          | Val  Loss: 0.2437 | Val  Acc: 0.9456
 Site-MNIST                         | Val  Loss: 0.5630 | Val  Acc: 0.7000
 Site-MNIST                         | Val  Loss: 0.4195 | Val  Acc: 0.8333
 Site-MNIST                         | Val  Loss: 0.3816 | Val  Acc: 0.8750
 Site-MNIST                         | Val  Loss: 0.4725 | Val  Acc: 0.8621
 Site-MNIST                         | Val  Loss: 0.4299 | Val  Acc: 0.8762
 Site-MNIST                         | Val  Loss: 0.3859 | Val  Acc: 0.8889
 Site-SynthDigits                   | Val  Loss: 1.3527 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 1.2332 | Val  Acc: 0.7059
 Site-SynthDigits                   | Val  Loss: 1.2949 | Val  Acc: 0.6311
 Site-SVHN                          | Val  Loss: 1.7756 | Val  Acc: 0.4000
 Site-SVHN                          | Val  Loss: 1.7097 | Val  Acc: 0.3827
 Site-MNIST_M                       | Val  Loss: 1.9633 | Val  Acc: 0.4143
Average Valid Accuracy: 0.8116
 Best site-USPS                      | Epoch:12 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:12 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:12 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:12 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9412
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9032
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9107
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9412
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9672
 Best site-USPS                      | Epoch:12 | Val Acc: 0.9456
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.7000
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8333
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8750
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8621
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8762
 Best site-MNIST                     | Epoch:12 | Val Acc: 0.8889
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.6757
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.7059
 Best site-SynthDigits               | Epoch:12 | Val Acc: 0.6311
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.4000
 Best site-SVHN                      | Epoch:12 | Val Acc: 0.3827
 Best site-MNIST_M                   | Epoch:12 | Val Acc: 0.4143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle/only_dcnet...
============ Train epoch 13 ============
cnt=[1, 10, 1, 5, 5, ]
cnt=[10, 6, 2, 3, 1, ]
 Site-USPS                          | Train Loss: 0.1591 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.1995 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.3308 | Train Acc: 0.8571
 Site-USPS                          | Train Loss: 0.2590 | Train Acc: 0.9211
 Site-USPS                          | Train Loss: 0.1813 | Train Acc: 0.9286
 Site-USPS                          | Train Loss: 0.2177 | Train Acc: 0.9683
 Site-USPS                          | Train Loss: 0.2774 | Train Acc: 0.9383
 Site-USPS                          | Train Loss: 0.2357 | Train Acc: 0.9438
 Site-USPS                          | Train Loss: 0.2495 | Train Acc: 0.9389
 Site-USPS                          | Train Loss: 0.2188 | Train Acc: 0.9517
 Site-MNIST                         | Train Loss: 0.3629 | Train Acc: 0.9000
 Site-MNIST                         | Train Loss: 0.3273 | Train Acc: 0.8889
 Site-MNIST                         | Train Loss: 0.3112 | Train Acc: 0.8760
 Site-MNIST                         | Train Loss: 0.3741 | Train Acc: 0.8841
 Site-MNIST                         | Train Loss: 0.4377 | Train Acc: 0.8929
 Site-MNIST                         | Train Loss: 0.4119 | Train Acc: 0.9034
 Site-SynthDigits                   | Train Loss: 1.4237 | Train Acc: 0.5563
 Site-SynthDigits                   | Train Loss: 1.2406 | Train Acc: 0.5861
 Site-SynthDigits                   | Train Loss: 1.1530 | Train Acc: 0.6253
 Site-SVHN                          | Train Loss: 1.8854 | Train Acc: 0.3149
 Site-SVHN                          | Train Loss: 1.7663 | Train Acc: 0.3670
 Site-MNIST_M                       | Train Loss: 1.7960 | Train Acc: 0.4220
Average Train Accuracy: 0.7991
 Site-USPS                          | Val  Loss: 0.4353 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3505 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3557 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2154 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2085 | Val  Acc: 0.9412
 Site-USPS                          | Val  Loss: 0.2077 | Val  Acc: 0.9032
 Site-USPS                          | Val  Loss: 0.2304 | Val  Acc: 0.8929
 Site-USPS                          | Val  Loss: 0.2088 | Val  Acc: 0.9412
 Site-USPS                          | Val  Loss: 0.2180 | Val  Acc: 0.9563
 Site-USPS                          | Val  Loss: 0.2335 | Val  Acc: 0.9396
 Site-MNIST                         | Val  Loss: 0.5199 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3898 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.3665 | Val  Acc: 0.8750
 Site-MNIST                         | Val  Loss: 0.4542 | Val  Acc: 0.8793
 Site-MNIST                         | Val  Loss: 0.4100 | Val  Acc: 0.8857
 Site-MNIST                         | Val  Loss: 0.3590 | Val  Acc: 0.8942
 Site-SynthDigits                   | Val  Loss: 1.3065 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.1904 | Val  Acc: 0.7206
 Site-SynthDigits                   | Val  Loss: 1.2545 | Val  Acc: 0.6230
 Site-SVHN                          | Val  Loss: 1.7435 | Val  Acc: 0.4222
 Site-SVHN                          | Val  Loss: 1.6741 | Val  Acc: 0.4444
 Site-MNIST_M                       | Val  Loss: 1.9474 | Val  Acc: 0.4143
Average Valid Accuracy: 0.8251
 Best site-USPS                      | Epoch:13 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:13 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:13 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:13 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9412
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9032
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8929
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9412
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9563
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9396
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8750
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8793
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8857
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8942
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.7297
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.7206
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.6230
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.4222
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.4444
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.4143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle/only_dcnet...
============ Train epoch 14 ============
cnt=[10, 3, 1, 6, 2, ]
cnt=[10, 3, 6, 2, 1, ]
 Site-USPS                          | Train Loss: 0.1537 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.2037 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.3295 | Train Acc: 0.8571
 Site-USPS                          | Train Loss: 0.2460 | Train Acc: 0.9211
 Site-USPS                          | Train Loss: 0.3440 | Train Acc: 0.9286
 Site-USPS                          | Train Loss: 0.2111 | Train Acc: 0.9683
 Site-USPS                          | Train Loss: 0.2868 | Train Acc: 0.9339
 Site-USPS                          | Train Loss: 0.2373 | Train Acc: 0.9511
 Site-USPS                          | Train Loss: 0.2343 | Train Acc: 0.9429
 Site-USPS                          | Train Loss: 0.2100 | Train Acc: 0.9525
 Site-MNIST                         | Train Loss: 0.3339 | Train Acc: 0.9250
 Site-MNIST                         | Train Loss: 0.3162 | Train Acc: 0.8750
 Site-MNIST                         | Train Loss: 0.2799 | Train Acc: 0.8915
 Site-MNIST                         | Train Loss: 0.3440 | Train Acc: 0.8927
 Site-MNIST                         | Train Loss: 0.4090 | Train Acc: 0.9095
 Site-MNIST                         | Train Loss: 0.3863 | Train Acc: 0.9140
 Site-SynthDigits                   | Train Loss: 1.3325 | Train Acc: 0.5828
 Site-SynthDigits                   | Train Loss: 1.2413 | Train Acc: 0.5971
 Site-SynthDigits                   | Train Loss: 1.1278 | Train Acc: 0.6436
 Site-SVHN                          | Train Loss: 1.8404 | Train Acc: 0.3370
 Site-SVHN                          | Train Loss: 1.8105 | Train Acc: 0.3853
 Site-MNIST_M                       | Train Loss: 1.7151 | Train Acc: 0.4433
Average Train Accuracy: 0.8077
 Site-USPS                          | Val  Loss: 0.3923 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3118 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3161 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1948 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1986 | Val  Acc: 0.9412
 Site-USPS                          | Val  Loss: 0.2035 | Val  Acc: 0.9032
 Site-USPS                          | Val  Loss: 0.2237 | Val  Acc: 0.9107
 Site-USPS                          | Val  Loss: 0.1991 | Val  Acc: 0.9510
 Site-USPS                          | Val  Loss: 0.2083 | Val  Acc: 0.9672
 Site-USPS                          | Val  Loss: 0.2226 | Val  Acc: 0.9486
 Site-MNIST                         | Val  Loss: 0.5138 | Val  Acc: 0.7000
 Site-MNIST                         | Val  Loss: 0.3791 | Val  Acc: 0.8333
 Site-MNIST                         | Val  Loss: 0.3397 | Val  Acc: 0.8750
 Site-MNIST                         | Val  Loss: 0.4277 | Val  Acc: 0.8966
 Site-MNIST                         | Val  Loss: 0.3849 | Val  Acc: 0.8952
 Site-MNIST                         | Val  Loss: 0.3333 | Val  Acc: 0.9101
 Site-SynthDigits                   | Val  Loss: 1.2820 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.1409 | Val  Acc: 0.7206
 Site-SynthDigits                   | Val  Loss: 1.2119 | Val  Acc: 0.6475
 Site-SVHN                          | Val  Loss: 1.6886 | Val  Acc: 0.4444
 Site-SVHN                          | Val  Loss: 1.6268 | Val  Acc: 0.4444
 Site-MNIST_M                       | Val  Loss: 1.8860 | Val  Acc: 0.4143
Average Valid Accuracy: 0.8242
============ Train epoch 15 ============
cnt=[3, 10, 6, 1, 2, ]
cnt=[10, 6, 3, 2, 1, ]
 Site-USPS                          | Train Loss: 0.1313 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.1865 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.3191 | Train Acc: 0.8571
 Site-USPS                          | Train Loss: 0.2457 | Train Acc: 0.9211
 Site-USPS                          | Train Loss: 0.2342 | Train Acc: 0.9286
 Site-USPS                          | Train Loss: 0.1938 | Train Acc: 0.9683
 Site-USPS                          | Train Loss: 0.2649 | Train Acc: 0.9427
 Site-USPS                          | Train Loss: 0.2324 | Train Acc: 0.9389
 Site-USPS                          | Train Loss: 0.2226 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1985 | Train Acc: 0.9532
 Site-MNIST                         | Train Loss: 0.3261 | Train Acc: 0.9250
 Site-MNIST                         | Train Loss: 0.3909 | Train Acc: 0.8889
 Site-MNIST                         | Train Loss: 0.2605 | Train Acc: 0.8915
 Site-MNIST                         | Train Loss: 0.3341 | Train Acc: 0.8927
 Site-MNIST                         | Train Loss: 0.3920 | Train Acc: 0.9024
 Site-MNIST                         | Train Loss: 0.3790 | Train Acc: 0.9127
 Site-SynthDigits                   | Train Loss: 1.3639 | Train Acc: 0.5762
 Site-SynthDigits                   | Train Loss: 1.1535 | Train Acc: 0.6154
 Site-SynthDigits                   | Train Loss: 1.0935 | Train Acc: 0.6578
 Site-SVHN                          | Train Loss: 1.8487 | Train Acc: 0.3370
 Site-SVHN                          | Train Loss: 1.7606 | Train Acc: 0.3945
 Site-MNIST_M                       | Train Loss: 1.7332 | Train Acc: 0.4362
Average Train Accuracy: 0.8092
 Site-USPS                          | Val  Loss: 0.4227 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3450 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3201 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1955 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1833 | Val  Acc: 0.9412
 Site-USPS                          | Val  Loss: 0.1900 | Val  Acc: 0.9032
 Site-USPS                          | Val  Loss: 0.2102 | Val  Acc: 0.8929
 Site-USPS                          | Val  Loss: 0.1934 | Val  Acc: 0.9314
 Site-USPS                          | Val  Loss: 0.2026 | Val  Acc: 0.9399
 Site-USPS                          | Val  Loss: 0.2148 | Val  Acc: 0.9335
 Site-MNIST                         | Val  Loss: 0.4868 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3680 | Val  Acc: 0.8333
 Site-MNIST                         | Val  Loss: 0.3476 | Val  Acc: 0.9062
 Site-MNIST                         | Val  Loss: 0.4222 | Val  Acc: 0.8966
 Site-MNIST                         | Val  Loss: 0.3740 | Val  Acc: 0.8952
 Site-MNIST                         | Val  Loss: 0.3221 | Val  Acc: 0.9101
 Site-SynthDigits                   | Val  Loss: 1.2188 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.1205 | Val  Acc: 0.7353
 Site-SynthDigits                   | Val  Loss: 1.1845 | Val  Acc: 0.6393
 Site-SVHN                          | Val  Loss: 1.7035 | Val  Acc: 0.4667
 Site-SVHN                          | Val  Loss: 1.6256 | Val  Acc: 0.4568
 Site-MNIST_M                       | Val  Loss: 1.8870 | Val  Acc: 0.4286
Average Valid Accuracy: 0.8291
 Best site-USPS                      | Epoch:15 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:15 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:15 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:15 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:15 | Val Acc: 0.9412
 Best site-USPS                      | Epoch:15 | Val Acc: 0.9032
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8929
 Best site-USPS                      | Epoch:15 | Val Acc: 0.9314
 Best site-USPS                      | Epoch:15 | Val Acc: 0.9399
 Best site-USPS                      | Epoch:15 | Val Acc: 0.9335
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8333
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.9062
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8966
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8952
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.9101
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.7297
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.7353
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.6393
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.4667
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.4568
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle/only_dcnet...
============ Train epoch 16 ============
cnt=[2, 10, 6, 1, 3, ]
cnt=[3, 10, 2, 6, 1, ]
 Site-USPS                          | Train Loss: 0.1180 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.1523 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.3044 | Train Acc: 0.9048
 Site-USPS                          | Train Loss: 0.2294 | Train Acc: 0.9211
 Site-USPS                          | Train Loss: 0.3249 | Train Acc: 0.9286
 Site-USPS                          | Train Loss: 0.1857 | Train Acc: 0.9762
 Site-USPS                          | Train Loss: 0.2546 | Train Acc: 0.9559
 Site-USPS                          | Train Loss: 0.1949 | Train Acc: 0.9511
 Site-USPS                          | Train Loss: 0.2190 | Train Acc: 0.9429
 Site-USPS                          | Train Loss: 0.1906 | Train Acc: 0.9547
 Site-MNIST                         | Train Loss: 0.3125 | Train Acc: 0.9250
 Site-MNIST                         | Train Loss: 0.2606 | Train Acc: 0.8889
 Site-MNIST                         | Train Loss: 0.2524 | Train Acc: 0.8992
 Site-MNIST                         | Train Loss: 0.3175 | Train Acc: 0.9013
 Site-MNIST                         | Train Loss: 0.3755 | Train Acc: 0.9143
 Site-MNIST                         | Train Loss: 0.3612 | Train Acc: 0.9193
 Site-SynthDigits                   | Train Loss: 1.2414 | Train Acc: 0.5960
 Site-SynthDigits                   | Train Loss: 1.1840 | Train Acc: 0.6337
 Site-SynthDigits                   | Train Loss: 1.0885 | Train Acc: 0.6436
 Site-SVHN                          | Train Loss: 1.8087 | Train Acc: 0.3591
 Site-SVHN                          | Train Loss: 1.7765 | Train Acc: 0.4006
 Site-MNIST_M                       | Train Loss: 1.6697 | Train Acc: 0.4574
Average Train Accuracy: 0.8177
 Site-USPS                          | Val  Loss: 0.3619 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2523 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2532 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1534 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1627 | Val  Acc: 0.9412
 Site-USPS                          | Val  Loss: 0.1828 | Val  Acc: 0.9032
 Site-USPS                          | Val  Loss: 0.2029 | Val  Acc: 0.9107
 Site-USPS                          | Val  Loss: 0.1785 | Val  Acc: 0.9608
 Site-USPS                          | Val  Loss: 0.1863 | Val  Acc: 0.9672
 Site-USPS                          | Val  Loss: 0.1984 | Val  Acc: 0.9547
 Site-MNIST                         | Val  Loss: 0.5034 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3698 | Val  Acc: 0.8333
 Site-MNIST                         | Val  Loss: 0.3229 | Val  Acc: 0.9062
 Site-MNIST                         | Val  Loss: 0.4062 | Val  Acc: 0.8966
 Site-MNIST                         | Val  Loss: 0.3582 | Val  Acc: 0.8952
 Site-MNIST                         | Val  Loss: 0.3125 | Val  Acc: 0.9101
 Site-SynthDigits                   | Val  Loss: 1.2230 | Val  Acc: 0.7568
 Site-SynthDigits                   | Val  Loss: 1.1018 | Val  Acc: 0.7353
 Site-SynthDigits                   | Val  Loss: 1.1459 | Val  Acc: 0.6475
 Site-SVHN                          | Val  Loss: 1.6463 | Val  Acc: 0.4889
 Site-SVHN                          | Val  Loss: 1.5875 | Val  Acc: 0.4568
 Site-MNIST_M                       | Val  Loss: 1.8338 | Val  Acc: 0.4429
Average Valid Accuracy: 0.8367
 Best site-USPS                      | Epoch:16 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:16 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:16 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:16 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9412
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9032
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9107
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9608
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9672
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9547
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8333
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9062
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8966
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8952
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9101
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.7568
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.7353
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.6475
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.4889
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.4568
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.4429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle/only_dcnet...
============ Train epoch 17 ============
cnt=[3, 10, 6, 1, 2, ]
cnt=[10, 6, 2, 3, 1, ]
 Site-USPS                          | Train Loss: 0.1204 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.1689 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.2983 | Train Acc: 0.8571
 Site-USPS                          | Train Loss: 0.2200 | Train Acc: 0.9211
 Site-USPS                          | Train Loss: 0.1899 | Train Acc: 0.9286
 Site-USPS                          | Train Loss: 0.1825 | Train Acc: 0.9683
 Site-USPS                          | Train Loss: 0.2489 | Train Acc: 0.9471
 Site-USPS                          | Train Loss: 0.1965 | Train Acc: 0.9560
 Site-USPS                          | Train Loss: 0.2061 | Train Acc: 0.9443
 Site-USPS                          | Train Loss: 0.1830 | Train Acc: 0.9562
 Site-MNIST                         | Train Loss: 0.2752 | Train Acc: 0.9250
 Site-MNIST                         | Train Loss: 0.2278 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.2427 | Train Acc: 0.9147
 Site-MNIST                         | Train Loss: 0.2946 | Train Acc: 0.9142
 Site-MNIST                         | Train Loss: 0.3479 | Train Acc: 0.9262
 Site-MNIST                         | Train Loss: 0.3318 | Train Acc: 0.9272
 Site-SynthDigits                   | Train Loss: 1.2070 | Train Acc: 0.6291
 Site-SynthDigits                   | Train Loss: 1.0967 | Train Acc: 0.6300
 Site-SynthDigits                   | Train Loss: 1.0307 | Train Acc: 0.6701
 Site-SVHN                          | Train Loss: 1.7825 | Train Acc: 0.3646
 Site-SVHN                          | Train Loss: 1.6601 | Train Acc: 0.4006
 Site-MNIST_M                       | Train Loss: 1.6220 | Train Acc: 0.4752
Average Train Accuracy: 0.8222
 Site-USPS                          | Val  Loss: 0.3118 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2430 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2403 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1523 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1610 | Val  Acc: 0.9412
 Site-USPS                          | Val  Loss: 0.1741 | Val  Acc: 0.9032
 Site-USPS                          | Val  Loss: 0.1914 | Val  Acc: 0.9107
 Site-USPS                          | Val  Loss: 0.1711 | Val  Acc: 0.9608
 Site-USPS                          | Val  Loss: 0.1784 | Val  Acc: 0.9727
 Site-USPS                          | Val  Loss: 0.1922 | Val  Acc: 0.9547
 Site-MNIST                         | Val  Loss: 0.4207 | Val  Acc: 0.9000
 Site-MNIST                         | Val  Loss: 0.3137 | Val  Acc: 0.9444
 Site-MNIST                         | Val  Loss: 0.2872 | Val  Acc: 0.9375
 Site-MNIST                         | Val  Loss: 0.3725 | Val  Acc: 0.9138
 Site-MNIST                         | Val  Loss: 0.3331 | Val  Acc: 0.9048
 Site-MNIST                         | Val  Loss: 0.2780 | Val  Acc: 0.9101
 Site-SynthDigits                   | Val  Loss: 1.1736 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.0708 | Val  Acc: 0.7353
 Site-SynthDigits                   | Val  Loss: 1.1042 | Val  Acc: 0.6557
 Site-SVHN                          | Val  Loss: 1.6270 | Val  Acc: 0.5111
 Site-SVHN                          | Val  Loss: 1.5690 | Val  Acc: 0.4568
 Site-MNIST_M                       | Val  Loss: 1.8277 | Val  Acc: 0.4571
Average Valid Accuracy: 0.8500
 Best site-USPS                      | Epoch:17 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:17 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:17 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:17 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9412
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9032
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9107
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9608
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9727
 Best site-USPS                      | Epoch:17 | Val Acc: 0.9547
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9000
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9444
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9375
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9138
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9048
 Best site-MNIST                     | Epoch:17 | Val Acc: 0.9101
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.7297
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.7353
 Best site-SynthDigits               | Epoch:17 | Val Acc: 0.6557
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.5111
 Best site-SVHN                      | Epoch:17 | Val Acc: 0.4568
 Best site-MNIST_M                   | Epoch:17 | Val Acc: 0.4571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle/only_dcnet...
============ Train epoch 18 ============
cnt=[10, 2, 6, 1, 3, ]
cnt=[6, 3, 1, 9, 3, ]
 Site-USPS                          | Train Loss: 0.1062 | Train Acc: 1.0000
 Site-USPS                          | Train Loss: 0.1682 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.2921 | Train Acc: 0.8571
 Site-USPS                          | Train Loss: 0.2188 | Train Acc: 0.9211
 Site-USPS                          | Train Loss: 0.1374 | Train Acc: 0.9286
 Site-USPS                          | Train Loss: 0.1723 | Train Acc: 0.9762
 Site-USPS                          | Train Loss: 0.2416 | Train Acc: 0.9471
 Site-USPS                          | Train Loss: 0.1913 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.1995 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.1757 | Train Acc: 0.9562
 Site-MNIST                         | Train Loss: 0.2537 | Train Acc: 0.9250
 Site-MNIST                         | Train Loss: 0.3803 | Train Acc: 0.9306
 Site-MNIST                         | Train Loss: 0.3449 | Train Acc: 0.9225
 Site-MNIST                         | Train Loss: 0.2760 | Train Acc: 0.9227
 Site-MNIST                         | Train Loss: 0.3375 | Train Acc: 0.9310
 Site-MNIST                         | Train Loss: 0.3135 | Train Acc: 0.9259
 Site-SynthDigits                   | Train Loss: 1.2414 | Train Acc: 0.6358
 Site-SynthDigits                   | Train Loss: 1.0962 | Train Acc: 0.6484
 Site-SynthDigits                   | Train Loss: 0.9939 | Train Acc: 0.6965
 Site-SVHN                          | Train Loss: 1.7742 | Train Acc: 0.3646
 Site-SVHN                          | Train Loss: 1.5939 | Train Acc: 0.4190
 Site-MNIST_M                       | Train Loss: 1.6249 | Train Acc: 0.4965
Average Train Accuracy: 0.8282
 Site-USPS                          | Val  Loss: 0.3314 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2597 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2376 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1489 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1540 | Val  Acc: 0.9412
 Site-USPS                          | Val  Loss: 0.1711 | Val  Acc: 0.9032
 Site-USPS                          | Val  Loss: 0.1834 | Val  Acc: 0.9107
 Site-USPS                          | Val  Loss: 0.1683 | Val  Acc: 0.9608
 Site-USPS                          | Val  Loss: 0.1731 | Val  Acc: 0.9672
 Site-USPS                          | Val  Loss: 0.1862 | Val  Acc: 0.9517
 Site-MNIST                         | Val  Loss: 0.4058 | Val  Acc: 0.9000
 Site-MNIST                         | Val  Loss: 0.3032 | Val  Acc: 0.9444
 Site-MNIST                         | Val  Loss: 0.2777 | Val  Acc: 0.9375
 Site-MNIST                         | Val  Loss: 0.3554 | Val  Acc: 0.9138
 Site-MNIST                         | Val  Loss: 0.3189 | Val  Acc: 0.9143
 Site-MNIST                         | Val  Loss: 0.2631 | Val  Acc: 0.9206
 Site-SynthDigits                   | Val  Loss: 1.1241 | Val  Acc: 0.7568
 Site-SynthDigits                   | Val  Loss: 1.0419 | Val  Acc: 0.7500
 Site-SynthDigits                   | Val  Loss: 1.0708 | Val  Acc: 0.6639
 Site-SVHN                          | Val  Loss: 1.6104 | Val  Acc: 0.5111
 Site-SVHN                          | Val  Loss: 1.5481 | Val  Acc: 0.4568
 Site-MNIST_M                       | Val  Loss: 1.8226 | Val  Acc: 0.4714
Average Valid Accuracy: 0.8534
 Best site-USPS                      | Epoch:18 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:18 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:18 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:18 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9412
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9032
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9107
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9608
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9672
 Best site-USPS                      | Epoch:18 | Val Acc: 0.9517
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9000
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9444
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9375
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9138
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9143
 Best site-MNIST                     | Epoch:18 | Val Acc: 0.9206
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.7568
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.7500
 Best site-SynthDigits               | Epoch:18 | Val Acc: 0.6639
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.5111
 Best site-SVHN                      | Epoch:18 | Val Acc: 0.4568
 Best site-MNIST_M                   | Epoch:18 | Val Acc: 0.4714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_1_shuffle/only_dcnet...
============ Train epoch 19 ============
