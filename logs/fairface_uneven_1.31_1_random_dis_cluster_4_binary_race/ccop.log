===2023-05-31 00:49:32===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0.7
    std_rw: False
    gender_label: False
    binary_race: True
data_number=[39,52,68,89,117,154,201,264,346,453,154,202,]
client_nums=[10,2,]
len_dataset=[2980,596,]
label set of clients: [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[6, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
min_w=0.01823, quan_i=1.00, quan_c=1.00
minimize weight of clients:[]
 Site-White                    | Train Loss: 1.6653 | Train Acc: 0.3077
 Site-White                    | Train Loss: 1.8206 | Train Acc: 0.3462
 Site-White                    | Train Loss: 1.8820 | Train Acc: 0.2941
 Site-White                    | Train Loss: 1.7925 | Train Acc: 0.3371
 Site-White                    | Train Loss: 1.8731 | Train Acc: 0.3675
 Site-White                    | Train Loss: 1.8203 | Train Acc: 0.3377
 Site-White                    | Train Loss: 1.8379 | Train Acc: 0.3433
 Site-White                    | Train Loss: 1.8099 | Train Acc: 0.3409
 Site-White                    | Train Loss: 1.8042 | Train Acc: 0.3526
 Site-White                    | Train Loss: 1.8748 | Train Acc: 0.3333
 Site-Black                    | Train Loss: 2.0594 | Train Acc: 0.2468
 Site-Black                    | Train Loss: 2.0366 | Train Acc: 0.2178
 Site-White                     (0) | Val  Loss: 1.8406 | Val  Acc: 0.2692
 Site-White                     (2) | Val  Loss: 2.4491 | Val  Acc: 0.2647
 Site-White                     (2) | Val  Loss: 1.6529 | Val  Acc: 0.2667
 Site-White                     (2) | Val  Loss: 1.8058 | Val  Acc: 0.3390
 Site-White                     (0) | Val  Loss: 1.8959 | Val  Acc: 0.3846
 Site-White                     (0) | Val  Loss: 1.6809 | Val  Acc: 0.3529
 Site-White                     (0) | Val  Loss: 2.0231 | Val  Acc: 0.3284
 Site-White                     (0) | Val  Loss: 1.8250 | Val  Acc: 0.3580
 Site-White                     (3) | Val  Loss: 1.7466 | Val  Acc: 0.3478
 Site-White                     (0) | Val  Loss: 1.7993 | Val  Acc: 0.3609
 Site-Black                     (1) | Val  Loss: 2.1889 | Val  Acc: 0.2330
 Site-Black                     (1) | Val  Loss: 2.2610 | Val  Acc: 0.2761
Average Valid Accuracy: 0.3151
Aggregated Acc | Val Acc: 0.3087
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.2692
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.2647
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.2667
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.3390
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.3846
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.3529
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.3284
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.3580
 Best site-White                    (3)  | Epoch:0 | Val Acc: 0.3478
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.3609
 Best site-Black                    (1)  | Epoch:0 | Val Acc: 0.2330
 Best site-Black                    (1)  | Epoch:0 | Val Acc: 0.2761
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 8, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
min_w=0.05065, quan_i=1.89, quan_c=1.85
minimize weight of clients:[0, ]
 Site-White                    | Train Loss: 1.7018 | Train Acc: 0.3077
 Site-White                    | Train Loss: 1.8015 | Train Acc: 0.4231
 Site-White                    | Train Loss: 2.1490 | Train Acc: 0.2941
 Site-White                    | Train Loss: 1.7642 | Train Acc: 0.3708
 Site-White                    | Train Loss: 1.8085 | Train Acc: 0.3419
 Site-White                    | Train Loss: 1.7563 | Train Acc: 0.3571
 Site-White                    | Train Loss: 1.7907 | Train Acc: 0.3731
 Site-White                    | Train Loss: 1.7411 | Train Acc: 0.3598
 Site-White                    | Train Loss: 1.7399 | Train Acc: 0.3728
 Site-White                    | Train Loss: 1.8052 | Train Acc: 0.3554
 Site-Black                    | Train Loss: 1.9999 | Train Acc: 0.2662
 Site-Black                    | Train Loss: 1.9760 | Train Acc: 0.2327
 Site-White                     (3) | Val  Loss: 1.8337 | Val  Acc: 0.2692
 Site-White                     (1) | Val  Loss: 2.3966 | Val  Acc: 0.2941
 Site-White                     (1) | Val  Loss: 1.6142 | Val  Acc: 0.2889
 Site-White                     (1) | Val  Loss: 1.8160 | Val  Acc: 0.3729
 Site-White                     (0) | Val  Loss: 1.8692 | Val  Acc: 0.3590
 Site-White                     (1) | Val  Loss: 1.6424 | Val  Acc: 0.3333
 Site-White                     (1) | Val  Loss: 1.9229 | Val  Acc: 0.3284
 Site-White                     (1) | Val  Loss: 1.7681 | Val  Acc: 0.3523
 Site-White                     (1) | Val  Loss: 1.7092 | Val  Acc: 0.3696
 Site-White                     (1) | Val  Loss: 1.7685 | Val  Acc: 0.3775
 Site-Black                     (2) | Val  Loss: 2.1649 | Val  Acc: 0.2330
 Site-Black                     (2) | Val  Loss: 2.2291 | Val  Acc: 0.2463
Average Valid Accuracy: 0.3187
Aggregated Acc | Val Acc: 0.3019
 Best site-White                    (3)  | Epoch:1 | Val Acc: 0.2692
 Best site-White                    (1)  | Epoch:1 | Val Acc: 0.2941
 Best site-White                    (1)  | Epoch:1 | Val Acc: 0.2889
 Best site-White                    (1)  | Epoch:1 | Val Acc: 0.3729
 Best site-White                    (0)  | Epoch:1 | Val Acc: 0.3590
 Best site-White                    (1)  | Epoch:1 | Val Acc: 0.3333
 Best site-White                    (1)  | Epoch:1 | Val Acc: 0.3284
 Best site-White                    (1)  | Epoch:1 | Val Acc: 0.3523
 Best site-White                    (1)  | Epoch:1 | Val Acc: 0.3696
 Best site-White                    (1)  | Epoch:1 | Val Acc: 0.3775
 Best site-Black                    (2)  | Epoch:1 | Val Acc: 0.2330
 Best site-Black                    (2)  | Epoch:1 | Val Acc: 0.2463
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 1, 2, 8, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
min_w=0.05420, quan_i=1.82, quan_c=1.80
minimize weight of clients:[0, ]
 Site-White                    | Train Loss: 1.5744 | Train Acc: 0.3846
 Site-White                    | Train Loss: 1.7491 | Train Acc: 0.4423
 Site-White                    | Train Loss: 1.8956 | Train Acc: 0.2353
 Site-White                    | Train Loss: 1.6966 | Train Acc: 0.4045
 Site-White                    | Train Loss: 1.7613 | Train Acc: 0.3248
 Site-White                    | Train Loss: 1.7024 | Train Acc: 0.3831
 Site-White                    | Train Loss: 1.6871 | Train Acc: 0.3980
 Site-White                    | Train Loss: 1.7001 | Train Acc: 0.4015
 Site-White                    | Train Loss: 1.6919 | Train Acc: 0.3902
 Site-White                    | Train Loss: 1.7054 | Train Acc: 0.3642
 Site-Black                    | Train Loss: 1.9469 | Train Acc: 0.2013
 Site-Black                    | Train Loss: 1.9802 | Train Acc: 0.2475
 Site-White                     (0) | Val  Loss: 1.7708 | Val  Acc: 0.4231
 Site-White                     (3) | Val  Loss: 2.1727 | Val  Acc: 0.2941
 Site-White                     (3) | Val  Loss: 1.6434 | Val  Acc: 0.3556
 Site-White                     (3) | Val  Loss: 1.7222 | Val  Acc: 0.3729
 Site-White                     (3) | Val  Loss: 1.7685 | Val  Acc: 0.3718
 Site-White                     (3) | Val  Loss: 1.5824 | Val  Acc: 0.3529
 Site-White                     (3) | Val  Loss: 1.8254 | Val  Acc: 0.3507
 Site-White                     (3) | Val  Loss: 1.7327 | Val  Acc: 0.3523
 Site-White                     (3) | Val  Loss: 1.6735 | Val  Acc: 0.3696
 Site-White                     (1) | Val  Loss: 1.7095 | Val  Acc: 0.3841
 Site-Black                     (2) | Val  Loss: 2.0513 | Val  Acc: 0.2233
 Site-Black                     (2) | Val  Loss: 2.1238 | Val  Acc: 0.2463
Average Valid Accuracy: 0.3414
Aggregated Acc | Val Acc: 0.3486
 Best site-White                    (0)  | Epoch:2 | Val Acc: 0.4231
 Best site-White                    (3)  | Epoch:2 | Val Acc: 0.2941
 Best site-White                    (3)  | Epoch:2 | Val Acc: 0.3556
 Best site-White                    (3)  | Epoch:2 | Val Acc: 0.3729
 Best site-White                    (3)  | Epoch:2 | Val Acc: 0.3718
 Best site-White                    (3)  | Epoch:2 | Val Acc: 0.3529
 Best site-White                    (3)  | Epoch:2 | Val Acc: 0.3507
 Best site-White                    (3)  | Epoch:2 | Val Acc: 0.3523
 Best site-White                    (3)  | Epoch:2 | Val Acc: 0.3696
 Best site-White                    (1)  | Epoch:2 | Val Acc: 0.3841
 Best site-Black                    (2)  | Epoch:2 | Val Acc: 0.2233
 Best site-Black                    (2)  | Epoch:2 | Val Acc: 0.2463
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 3, 3, 4, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
min_w=0.04715, quan_i=1.78, quan_c=1.73
minimize weight of clients:[0, 5, 6, 7, 9, ]
 Site-White                    | Train Loss: 1.5985 | Train Acc: 0.4359
 Site-White                    | Train Loss: 1.6588 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.8048 | Train Acc: 0.2794
 Site-White                    | Train Loss: 1.6636 | Train Acc: 0.4494
 Site-White                    | Train Loss: 1.7331 | Train Acc: 0.3590
 Site-White                    | Train Loss: 1.6836 | Train Acc: 0.4026
 Site-White                    | Train Loss: 1.6810 | Train Acc: 0.3831
 Site-White                    | Train Loss: 1.6303 | Train Acc: 0.4242
 Site-White                    | Train Loss: 1.6501 | Train Acc: 0.4422
 Site-White                    | Train Loss: 1.6474 | Train Acc: 0.3863
 Site-Black                    | Train Loss: 1.8595 | Train Acc: 0.2792
 Site-Black                    | Train Loss: 1.8936 | Train Acc: 0.2673
 Site-White                     (2) | Val  Loss: 1.7256 | Val  Acc: 0.3077
 Site-White                     (3) | Val  Loss: 2.1044 | Val  Acc: 0.3529
 Site-White                     (3) | Val  Loss: 1.5800 | Val  Acc: 0.4222
 Site-White                     (3) | Val  Loss: 1.6712 | Val  Acc: 0.4237
 Site-White                     (1) | Val  Loss: 1.6781 | Val  Acc: 0.4615
 Site-White                     (2) | Val  Loss: 1.5705 | Val  Acc: 0.4216
 Site-White                     (1) | Val  Loss: 1.7345 | Val  Acc: 0.4179
 Site-White                     (2) | Val  Loss: 1.6765 | Val  Acc: 0.3750
 Site-White                     (3) | Val  Loss: 1.6524 | Val  Acc: 0.3957
 Site-White                     (1) | Val  Loss: 1.6590 | Val  Acc: 0.3974
 Site-Black                     (0) | Val  Loss: 1.9188 | Val  Acc: 0.2524
 Site-Black                     (0) | Val  Loss: 1.9607 | Val  Acc: 0.2537
Average Valid Accuracy: 0.3735
Aggregated Acc | Val Acc: 0.3614
 Best site-White                    (2)  | Epoch:3 | Val Acc: 0.3077
 Best site-White                    (3)  | Epoch:3 | Val Acc: 0.3529
 Best site-White                    (3)  | Epoch:3 | Val Acc: 0.4222
 Best site-White                    (3)  | Epoch:3 | Val Acc: 0.4237
 Best site-White                    (1)  | Epoch:3 | Val Acc: 0.4615
 Best site-White                    (2)  | Epoch:3 | Val Acc: 0.4216
 Best site-White                    (1)  | Epoch:3 | Val Acc: 0.4179
 Best site-White                    (2)  | Epoch:3 | Val Acc: 0.3750
 Best site-White                    (3)  | Epoch:3 | Val Acc: 0.3957
 Best site-White                    (1)  | Epoch:3 | Val Acc: 0.3974
 Best site-Black                    (0)  | Epoch:3 | Val Acc: 0.2524
 Best site-Black                    (0)  | Epoch:3 | Val Acc: 0.2537
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 4 ============
cnt=[4, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
min_w=0.04810, quan_i=1.74, quan_c=1.69
minimize weight of clients:[0, 3, 5, 7, 9, ]
 Site-White                    | Train Loss: 1.6341 | Train Acc: 0.4103
 Site-White                    | Train Loss: 1.5756 | Train Acc: 0.5385
 Site-White                    | Train Loss: 1.6257 | Train Acc: 0.2941
 Site-White                    | Train Loss: 1.6159 | Train Acc: 0.4270
 Site-White                    | Train Loss: 1.7210 | Train Acc: 0.3419
 Site-White                    | Train Loss: 1.5806 | Train Acc: 0.4091
 Site-White                    | Train Loss: 1.5776 | Train Acc: 0.4129
 Site-White                    | Train Loss: 1.5940 | Train Acc: 0.3864
 Site-White                    | Train Loss: 1.5640 | Train Acc: 0.4422
 Site-White                    | Train Loss: 1.5677 | Train Acc: 0.4062
 Site-Black                    | Train Loss: 1.7831 | Train Acc: 0.2922
 Site-Black                    | Train Loss: 1.8068 | Train Acc: 0.3168
 Site-White                     (0) | Val  Loss: 1.6014 | Val  Acc: 0.4615
 Site-White                     (2) | Val  Loss: 2.0985 | Val  Acc: 0.4118
 Site-White                     (2) | Val  Loss: 1.5119 | Val  Acc: 0.4444
 Site-White                     (0) | Val  Loss: 1.6036 | Val  Acc: 0.4237
 Site-White                     (0) | Val  Loss: 1.5945 | Val  Acc: 0.4615
 Site-White                     (3) | Val  Loss: 1.4512 | Val  Acc: 0.4608
 Site-White                     (2) | Val  Loss: 1.7063 | Val  Acc: 0.4254
 Site-White                     (0) | Val  Loss: 1.6089 | Val  Acc: 0.3523
 Site-White                     (2) | Val  Loss: 1.5645 | Val  Acc: 0.4043
 Site-White                     (3) | Val  Loss: 1.5994 | Val  Acc: 0.3974
 Site-Black                     (1) | Val  Loss: 1.8598 | Val  Acc: 0.3107
 Site-Black                     (1) | Val  Loss: 1.9310 | Val  Acc: 0.2463
Average Valid Accuracy: 0.4000
Aggregated Acc | Val Acc: 0.3884
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.4615
 Best site-White                    (2)  | Epoch:4 | Val Acc: 0.4118
 Best site-White                    (2)  | Epoch:4 | Val Acc: 0.4444
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.4237
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.4615
 Best site-White                    (3)  | Epoch:4 | Val Acc: 0.4608
 Best site-White                    (2)  | Epoch:4 | Val Acc: 0.4254
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.3523
 Best site-White                    (2)  | Epoch:4 | Val Acc: 0.4043
 Best site-White                    (3)  | Epoch:4 | Val Acc: 0.3974
 Best site-Black                    (1)  | Epoch:4 | Val Acc: 0.3107
 Best site-Black                    (1)  | Epoch:4 | Val Acc: 0.2463
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 5, 2, 4, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
min_w=0.04860, quan_i=1.64, quan_c=1.61
minimize weight of clients:[1, 6, 8, ]
 Site-White                    | Train Loss: 1.6364 | Train Acc: 0.3590
 Site-White                    | Train Loss: 1.5736 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.5962 | Train Acc: 0.3088
 Site-White                    | Train Loss: 1.5111 | Train Acc: 0.4382
 Site-White                    | Train Loss: 1.6412 | Train Acc: 0.3932
 Site-White                    | Train Loss: 1.5255 | Train Acc: 0.4156
 Site-White                    | Train Loss: 1.5547 | Train Acc: 0.4328
 Site-White                    | Train Loss: 1.5840 | Train Acc: 0.4280
 Site-White                    | Train Loss: 1.5247 | Train Acc: 0.4393
 Site-White                    | Train Loss: 1.4962 | Train Acc: 0.4238
 Site-Black                    | Train Loss: 1.8486 | Train Acc: 0.2922
 Site-Black                    | Train Loss: 1.8734 | Train Acc: 0.3020
 Site-White                     (3) | Val  Loss: 1.5736 | Val  Acc: 0.3846
 Site-White                     (1) | Val  Loss: 1.9059 | Val  Acc: 0.3824
 Site-White                     (1) | Val  Loss: 1.4753 | Val  Acc: 0.3556
 Site-White                     (1) | Val  Loss: 1.5840 | Val  Acc: 0.4576
 Site-White                     (3) | Val  Loss: 1.5486 | Val  Acc: 0.4231
 Site-White                     (3) | Val  Loss: 1.4395 | Val  Acc: 0.4412
 Site-White                     (1) | Val  Loss: 1.6065 | Val  Acc: 0.4104
 Site-White                     (0) | Val  Loss: 1.5618 | Val  Acc: 0.3977
 Site-White                     (1) | Val  Loss: 1.4925 | Val  Acc: 0.4304
 Site-White                     (3) | Val  Loss: 1.5558 | Val  Acc: 0.4371
 Site-Black                     (2) | Val  Loss: 1.8582 | Val  Acc: 0.3010
 Site-Black                     (2) | Val  Loss: 2.0067 | Val  Acc: 0.2761
Average Valid Accuracy: 0.3914
Aggregated Acc | Val Acc: 0.3788
============ Train epoch 6 ============
cnt=[2, 3, 6, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
min_w=0.04900, quan_i=1.63, quan_c=1.55
minimize weight of clients:[3, 5, 6, 7, 9, ]
 Site-White                    | Train Loss: 1.4655 | Train Acc: 0.3846
 Site-White                    | Train Loss: 1.5161 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.6058 | Train Acc: 0.3529
 Site-White                    | Train Loss: 1.5157 | Train Acc: 0.4607
 Site-White                    | Train Loss: 1.5894 | Train Acc: 0.3846
 Site-White                    | Train Loss: 1.5510 | Train Acc: 0.4091
 Site-White                    | Train Loss: 1.5043 | Train Acc: 0.4428
 Site-White                    | Train Loss: 1.5420 | Train Acc: 0.4545
 Site-White                    | Train Loss: 1.4886 | Train Acc: 0.4393
 Site-White                    | Train Loss: 1.5170 | Train Acc: 0.4128
 Site-Black                    | Train Loss: 1.7058 | Train Acc: 0.3117
 Site-Black                    | Train Loss: 1.7151 | Train Acc: 0.3366
 Site-White                     (3) | Val  Loss: 1.5738 | Val  Acc: 0.5000
 Site-White                     (1) | Val  Loss: 1.9196 | Val  Acc: 0.4412
 Site-White                     (1) | Val  Loss: 1.4377 | Val  Acc: 0.4222
 Site-White                     (2) | Val  Loss: 1.4896 | Val  Acc: 0.5254
 Site-White                     (2) | Val  Loss: 1.5052 | Val  Acc: 0.4615
 Site-White                     (2) | Val  Loss: 1.3859 | Val  Acc: 0.4216
 Site-White                     (2) | Val  Loss: 1.6098 | Val  Acc: 0.4328
 Site-White                     (2) | Val  Loss: 1.5467 | Val  Acc: 0.4091
 Site-White                     (1) | Val  Loss: 1.4877 | Val  Acc: 0.4130
 Site-White                     (2) | Val  Loss: 1.5162 | Val  Acc: 0.4238
 Site-Black                     (0) | Val  Loss: 1.7446 | Val  Acc: 0.4078
 Site-Black                     (0) | Val  Loss: 1.8579 | Val  Acc: 0.3060
Average Valid Accuracy: 0.4304
Aggregated Acc | Val Acc: 0.4320
 Best site-White                    (3)  | Epoch:6 | Val Acc: 0.5000
 Best site-White                    (1)  | Epoch:6 | Val Acc: 0.4412
 Best site-White                    (1)  | Epoch:6 | Val Acc: 0.4222
 Best site-White                    (2)  | Epoch:6 | Val Acc: 0.5254
 Best site-White                    (2)  | Epoch:6 | Val Acc: 0.4615
 Best site-White                    (2)  | Epoch:6 | Val Acc: 0.4216
 Best site-White                    (2)  | Epoch:6 | Val Acc: 0.4328
 Best site-White                    (2)  | Epoch:6 | Val Acc: 0.4091
 Best site-White                    (1)  | Epoch:6 | Val Acc: 0.4130
 Best site-White                    (2)  | Epoch:6 | Val Acc: 0.4238
 Best site-Black                    (0)  | Epoch:6 | Val Acc: 0.4078
 Best site-Black                    (0)  | Epoch:6 | Val Acc: 0.3060
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 7 ============
cnt=[4, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
min_w=0.03943, quan_i=1.60, quan_c=1.55
minimize weight of clients:[0, 1, 7, 8, ]
 Site-White                    | Train Loss: 1.4757 | Train Acc: 0.4872
 Site-White                    | Train Loss: 1.4484 | Train Acc: 0.5385
 Site-White                    | Train Loss: 1.5392 | Train Acc: 0.3382
 Site-White                    | Train Loss: 1.4476 | Train Acc: 0.4494
 Site-White                    | Train Loss: 1.6033 | Train Acc: 0.4103
 Site-White                    | Train Loss: 1.5204 | Train Acc: 0.4091
 Site-White                    | Train Loss: 1.4802 | Train Acc: 0.4279
 Site-White                    | Train Loss: 1.5139 | Train Acc: 0.4242
 Site-White                    | Train Loss: 1.4902 | Train Acc: 0.4249
 Site-White                    | Train Loss: 1.4364 | Train Acc: 0.4371
 Site-Black                    | Train Loss: 1.7400 | Train Acc: 0.3182
 Site-Black                    | Train Loss: 1.7547 | Train Acc: 0.3069
 Site-White                     (2) | Val  Loss: 1.6155 | Val  Acc: 0.3846
 Site-White                     (0) | Val  Loss: 1.9724 | Val  Acc: 0.4706
 Site-White                     (0) | Val  Loss: 1.4137 | Val  Acc: 0.4444
 Site-White                     (3) | Val  Loss: 1.5220 | Val  Acc: 0.4407
 Site-White                     (3) | Val  Loss: 1.5037 | Val  Acc: 0.4487
 Site-White                     (3) | Val  Loss: 1.3630 | Val  Acc: 0.4412
 Site-White                     (3) | Val  Loss: 1.5773 | Val  Acc: 0.4254
 Site-White                     (0) | Val  Loss: 1.4958 | Val  Acc: 0.4545
 Site-White                     (0) | Val  Loss: 1.4825 | Val  Acc: 0.4087
 Site-White                     (3) | Val  Loss: 1.4965 | Val  Acc: 0.4106
 Site-Black                     (1) | Val  Loss: 1.7767 | Val  Acc: 0.3689
 Site-Black                     (1) | Val  Loss: 1.9346 | Val  Acc: 0.3209
Average Valid Accuracy: 0.4183
Aggregated Acc | Val Acc: 0.4019
============ Train epoch 8 ============
cnt=[1, 7, 2, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
min_w=0.04062, quan_i=1.56, quan_c=1.50
minimize weight of clients:[0, 9, ]
 Site-White                    | Train Loss: 1.5189 | Train Acc: 0.4615
 Site-White                    | Train Loss: 1.5028 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.4824 | Train Acc: 0.3824
 Site-White                    | Train Loss: 1.4427 | Train Acc: 0.4157
 Site-White                    | Train Loss: 1.5559 | Train Acc: 0.4444
 Site-White                    | Train Loss: 1.4855 | Train Acc: 0.4805
 Site-White                    | Train Loss: 1.4277 | Train Acc: 0.4328
 Site-White                    | Train Loss: 1.4467 | Train Acc: 0.4545
 Site-White                    | Train Loss: 1.4329 | Train Acc: 0.4711
 Site-White                    | Train Loss: 1.4716 | Train Acc: 0.4525
 Site-Black                    | Train Loss: 1.7560 | Train Acc: 0.3052
 Site-Black                    | Train Loss: 1.7743 | Train Acc: 0.3614
 Site-White                     (0) | Val  Loss: 1.5148 | Val  Acc: 0.4231
 Site-White                     (1) | Val  Loss: 1.7381 | Val  Acc: 0.5000
 Site-White                     (1) | Val  Loss: 1.3897 | Val  Acc: 0.4444
 Site-White                     (1) | Val  Loss: 1.5152 | Val  Acc: 0.4915
 Site-White                     (3) | Val  Loss: 1.4645 | Val  Acc: 0.4359
 Site-White                     (1) | Val  Loss: 1.3419 | Val  Acc: 0.4804
 Site-White                     (1) | Val  Loss: 1.5085 | Val  Acc: 0.4328
 Site-White                     (1) | Val  Loss: 1.4880 | Val  Acc: 0.4602
 Site-White                     (1) | Val  Loss: 1.4417 | Val  Acc: 0.4348
 Site-White                     (3) | Val  Loss: 1.4743 | Val  Acc: 0.4139
 Site-Black                     (2) | Val  Loss: 1.7841 | Val  Acc: 0.3495
 Site-Black                     (2) | Val  Loss: 1.8624 | Val  Acc: 0.3507
Average Valid Accuracy: 0.4348
Aggregated Acc | Val Acc: 0.4154
 Best site-White                    (0)  | Epoch:8 | Val Acc: 0.4231
 Best site-White                    (1)  | Epoch:8 | Val Acc: 0.5000
 Best site-White                    (1)  | Epoch:8 | Val Acc: 0.4444
 Best site-White                    (1)  | Epoch:8 | Val Acc: 0.4915
 Best site-White                    (3)  | Epoch:8 | Val Acc: 0.4359
 Best site-White                    (1)  | Epoch:8 | Val Acc: 0.4804
 Best site-White                    (1)  | Epoch:8 | Val Acc: 0.4328
 Best site-White                    (1)  | Epoch:8 | Val Acc: 0.4602
 Best site-White                    (1)  | Epoch:8 | Val Acc: 0.4348
 Best site-White                    (3)  | Epoch:8 | Val Acc: 0.4139
 Best site-Black                    (2)  | Epoch:8 | Val Acc: 0.3495
 Best site-Black                    (2)  | Epoch:8 | Val Acc: 0.3507
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 4, 2, 4, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
min_w=0.04149, quan_i=1.53, quan_c=1.49
minimize weight of clients:[1, 2, 3, 6, 7, 8, ]
 Site-White                    | Train Loss: 1.5039 | Train Acc: 0.4103
 Site-White                    | Train Loss: 1.3468 | Train Acc: 0.5385
 Site-White                    | Train Loss: 1.4358 | Train Acc: 0.3824
 Site-White                    | Train Loss: 1.4427 | Train Acc: 0.4831
 Site-White                    | Train Loss: 1.5165 | Train Acc: 0.4274
 Site-White                    | Train Loss: 1.4836 | Train Acc: 0.4286
 Site-White                    | Train Loss: 1.4601 | Train Acc: 0.4080
 Site-White                    | Train Loss: 1.5228 | Train Acc: 0.4280
 Site-White                    | Train Loss: 1.4436 | Train Acc: 0.4364
 Site-White                    | Train Loss: 1.3994 | Train Acc: 0.4437
 Site-Black                    | Train Loss: 1.6616 | Train Acc: 0.3312
 Site-Black                    | Train Loss: 1.6717 | Train Acc: 0.3861
 Site-White                     (1) | Val  Loss: 1.5165 | Val  Acc: 0.4231
 Site-White                     (3) | Val  Loss: 1.8284 | Val  Acc: 0.5294
 Site-White                     (3) | Val  Loss: 1.4005 | Val  Acc: 0.4444
 Site-White                     (1) | Val  Loss: 1.5418 | Val  Acc: 0.3898
 Site-White                     (3) | Val  Loss: 1.4566 | Val  Acc: 0.4359
 Site-White                     (0) | Val  Loss: 1.3431 | Val  Acc: 0.4118
 Site-White                     (1) | Val  Loss: 1.4872 | Val  Acc: 0.4552
 Site-White                     (1) | Val  Loss: 1.4789 | Val  Acc: 0.4375
 Site-White                     (3) | Val  Loss: 1.4379 | Val  Acc: 0.4087
 Site-White                     (0) | Val  Loss: 1.4752 | Val  Acc: 0.4404
 Site-Black                     (2) | Val  Loss: 1.7114 | Val  Acc: 0.3786
 Site-Black                     (2) | Val  Loss: 1.8633 | Val  Acc: 0.2985
Average Valid Accuracy: 0.4211
Aggregated Acc | Val Acc: 0.4114
============ Train epoch 10 ============
cnt=[1, 7, 2, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
min_w=0.04077, quan_i=1.53, quan_c=1.46
minimize weight of clients:[9, ]
 Site-White                    | Train Loss: 1.2734 | Train Acc: 0.4359
 Site-White                    | Train Loss: 1.3922 | Train Acc: 0.5192
 Site-White                    | Train Loss: 1.4264 | Train Acc: 0.4118
 Site-White                    | Train Loss: 1.4005 | Train Acc: 0.5056
 Site-White                    | Train Loss: 1.4938 | Train Acc: 0.4359
 Site-White                    | Train Loss: 1.4441 | Train Acc: 0.4221
 Site-White                    | Train Loss: 1.4277 | Train Acc: 0.4328
 Site-White                    | Train Loss: 1.4138 | Train Acc: 0.4432
 Site-White                    | Train Loss: 1.4063 | Train Acc: 0.4422
 Site-White                    | Train Loss: 1.3857 | Train Acc: 0.4702
 Site-Black                    | Train Loss: 1.7495 | Train Acc: 0.3506
 Site-Black                    | Train Loss: 1.6976 | Train Acc: 0.4109
 Site-White                     (1) | Val  Loss: 1.4663 | Val  Acc: 0.5000
 Site-White                     (1) | Val  Loss: 1.8153 | Val  Acc: 0.5000
 Site-White                     (1) | Val  Loss: 1.4504 | Val  Acc: 0.4222
 Site-White                     (1) | Val  Loss: 1.4698 | Val  Acc: 0.4068
 Site-White                     (3) | Val  Loss: 1.4041 | Val  Acc: 0.4231
 Site-White                     (1) | Val  Loss: 1.3358 | Val  Acc: 0.5000
 Site-White                     (1) | Val  Loss: 1.4671 | Val  Acc: 0.5000
 Site-White                     (0) | Val  Loss: 1.4662 | Val  Acc: 0.4205
 Site-White                     (1) | Val  Loss: 1.4281 | Val  Acc: 0.4522
 Site-White                     (3) | Val  Loss: 1.4589 | Val  Acc: 0.4238
 Site-Black                     (2) | Val  Loss: 1.7302 | Val  Acc: 0.4175
 Site-Black                     (2) | Val  Loss: 1.8203 | Val  Acc: 0.2910
Average Valid Accuracy: 0.4381
Aggregated Acc | Val Acc: 0.4167
 Best site-White                    (1)  | Epoch:10 | Val Acc: 0.5000
 Best site-White                    (1)  | Epoch:10 | Val Acc: 0.5000
 Best site-White                    (1)  | Epoch:10 | Val Acc: 0.4222
 Best site-White                    (1)  | Epoch:10 | Val Acc: 0.4068
 Best site-White                    (3)  | Epoch:10 | Val Acc: 0.4231
 Best site-White                    (1)  | Epoch:10 | Val Acc: 0.5000
 Best site-White                    (1)  | Epoch:10 | Val Acc: 0.5000
 Best site-White                    (0)  | Epoch:10 | Val Acc: 0.4205
 Best site-White                    (1)  | Epoch:10 | Val Acc: 0.4522
 Best site-White                    (3)  | Epoch:10 | Val Acc: 0.4238
 Best site-Black                    (2)  | Epoch:10 | Val Acc: 0.4175
 Best site-Black                    (2)  | Epoch:10 | Val Acc: 0.2910
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 11 ============
cnt=[1, 2, 2, 7, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
min_w=0.02997, quan_i=1.44, quan_c=1.42
minimize weight of clients:[0, 2, 8, ]
 Site-White                    | Train Loss: 1.3392 | Train Acc: 0.5128
 Site-White                    | Train Loss: 1.3844 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.6649 | Train Acc: 0.3971
 Site-White                    | Train Loss: 1.3843 | Train Acc: 0.4831
 Site-White                    | Train Loss: 1.4722 | Train Acc: 0.4530
 Site-White                    | Train Loss: 1.4379 | Train Acc: 0.4416
 Site-White                    | Train Loss: 1.4803 | Train Acc: 0.4328
 Site-White                    | Train Loss: 1.3696 | Train Acc: 0.5038
 Site-White                    | Train Loss: 1.4066 | Train Acc: 0.4480
 Site-White                    | Train Loss: 1.3603 | Train Acc: 0.4459
 Site-Black                    | Train Loss: 1.6512 | Train Acc: 0.3442
 Site-Black                    | Train Loss: 1.6876 | Train Acc: 0.3812
 Site-White                     (0) | Val  Loss: 1.5303 | Val  Acc: 0.3462
 Site-White                     (3) | Val  Loss: 1.7831 | Val  Acc: 0.5588
 Site-White                     (1) | Val  Loss: 1.3585 | Val  Acc: 0.4667
 Site-White                     (3) | Val  Loss: 1.4680 | Val  Acc: 0.5085
 Site-White                     (3) | Val  Loss: 1.4396 | Val  Acc: 0.4487
 Site-White                     (3) | Val  Loss: 1.2899 | Val  Acc: 0.5294
 Site-White                     (3) | Val  Loss: 1.4572 | Val  Acc: 0.4925
 Site-White                     (3) | Val  Loss: 1.4234 | Val  Acc: 0.4432
 Site-White                     (1) | Val  Loss: 1.4160 | Val  Acc: 0.4609
 Site-White                     (3) | Val  Loss: 1.4357 | Val  Acc: 0.4570
 Site-Black                     (2) | Val  Loss: 1.7211 | Val  Acc: 0.3398
 Site-Black                     (2) | Val  Loss: 1.7997 | Val  Acc: 0.3134
Average Valid Accuracy: 0.4471
Aggregated Acc | Val Acc: 0.4069
 Best site-White                    (0)  | Epoch:11 | Val Acc: 0.3462
 Best site-White                    (3)  | Epoch:11 | Val Acc: 0.5588
 Best site-White                    (1)  | Epoch:11 | Val Acc: 0.4667
 Best site-White                    (3)  | Epoch:11 | Val Acc: 0.5085
 Best site-White                    (3)  | Epoch:11 | Val Acc: 0.4487
 Best site-White                    (3)  | Epoch:11 | Val Acc: 0.5294
 Best site-White                    (3)  | Epoch:11 | Val Acc: 0.4925
 Best site-White                    (3)  | Epoch:11 | Val Acc: 0.4432
 Best site-White                    (1)  | Epoch:11 | Val Acc: 0.4609
 Best site-White                    (3)  | Epoch:11 | Val Acc: 0.4570
 Best site-Black                    (2)  | Epoch:11 | Val Acc: 0.3398
 Best site-Black                    (2)  | Epoch:11 | Val Acc: 0.3134
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 12 ============
cnt=[1, 2, 2, 7, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
min_w=0.03359, quan_i=1.49, quan_c=1.44
minimize weight of clients:[0, 7, 8, ]
 Site-White                    | Train Loss: 1.4368 | Train Acc: 0.5128
 Site-White                    | Train Loss: 1.4281 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.5199 | Train Acc: 0.3971
 Site-White                    | Train Loss: 1.3901 | Train Acc: 0.4607
 Site-White                    | Train Loss: 1.4782 | Train Acc: 0.4444
 Site-White                    | Train Loss: 1.4236 | Train Acc: 0.4545
 Site-White                    | Train Loss: 1.3947 | Train Acc: 0.4428
 Site-White                    | Train Loss: 1.4372 | Train Acc: 0.4773
 Site-White                    | Train Loss: 1.4202 | Train Acc: 0.4538
 Site-White                    | Train Loss: 1.3344 | Train Acc: 0.4592
 Site-Black                    | Train Loss: 1.6475 | Train Acc: 0.3766
 Site-Black                    | Train Loss: 1.6535 | Train Acc: 0.4109
 Site-White                     (2) | Val  Loss: 1.6488 | Val  Acc: 0.3846
 Site-White                     (3) | Val  Loss: 1.6923 | Val  Acc: 0.5000
 Site-White                     (3) | Val  Loss: 1.3941 | Val  Acc: 0.4889
 Site-White                     (3) | Val  Loss: 1.5296 | Val  Acc: 0.3898
 Site-White                     (3) | Val  Loss: 1.4464 | Val  Acc: 0.4231
 Site-White                     (3) | Val  Loss: 1.3428 | Val  Acc: 0.4902
 Site-White                     (3) | Val  Loss: 1.4356 | Val  Acc: 0.4851
 Site-White                     (2) | Val  Loss: 1.4280 | Val  Acc: 0.4205
 Site-White                     (0) | Val  Loss: 1.3459 | Val  Acc: 0.4696
 Site-White                     (3) | Val  Loss: 1.4244 | Val  Acc: 0.4570
 Site-Black                     (1) | Val  Loss: 1.7370 | Val  Acc: 0.3981
 Site-Black                     (1) | Val  Loss: 1.7553 | Val  Acc: 0.3358
Average Valid Accuracy: 0.4369
Aggregated Acc | Val Acc: 0.4253
============ Train epoch 13 ============
cnt=[2, 2, 7, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
min_w=0.03827, quan_i=1.48, quan_c=1.45
minimize weight of clients:[3, 8, 9, ]
 Site-White                    | Train Loss: 1.6604 | Train Acc: 0.4872
 Site-White                    | Train Loss: 1.3960 | Train Acc: 0.5577
 Site-White                    | Train Loss: 1.4624 | Train Acc: 0.4706
 Site-White                    | Train Loss: 1.4210 | Train Acc: 0.5056
 Site-White                    | Train Loss: 1.4842 | Train Acc: 0.4530
 Site-White                    | Train Loss: 1.4728 | Train Acc: 0.4545
 Site-White                    | Train Loss: 1.4194 | Train Acc: 0.4726
 Site-White                    | Train Loss: 1.3949 | Train Acc: 0.4735
 Site-White                    | Train Loss: 1.4155 | Train Acc: 0.4480
 Site-White                    | Train Loss: 1.3562 | Train Acc: 0.4636
 Site-Black                    | Train Loss: 1.6375 | Train Acc: 0.3442
 Site-Black                    | Train Loss: 1.5975 | Train Acc: 0.3960
 Site-White                     (2) | Val  Loss: 1.5158 | Val  Acc: 0.3462
 Site-White                     (2) | Val  Loss: 1.6505 | Val  Acc: 0.5882
 Site-White                     (2) | Val  Loss: 1.4080 | Val  Acc: 0.4889
 Site-White                     (0) | Val  Loss: 1.5187 | Val  Acc: 0.4407
 Site-White                     (2) | Val  Loss: 1.4491 | Val  Acc: 0.4359
 Site-White                     (2) | Val  Loss: 1.3087 | Val  Acc: 0.4510
 Site-White                     (2) | Val  Loss: 1.4151 | Val  Acc: 0.5224
 Site-White                     (2) | Val  Loss: 1.4344 | Val  Acc: 0.4261
 Site-White                     (0) | Val  Loss: 1.3747 | Val  Acc: 0.4478
 Site-White                     (3) | Val  Loss: 1.4147 | Val  Acc: 0.4536
 Site-Black                     (1) | Val  Loss: 1.6000 | Val  Acc: 0.3883
 Site-Black                     (1) | Val  Loss: 1.7257 | Val  Acc: 0.3507
Average Valid Accuracy: 0.4450
Aggregated Acc | Val Acc: 0.4332
============ Train epoch 14 ============
cnt=[4, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
min_w=0.04928, quan_i=1.49, quan_c=1.45
minimize weight of clients:[3, 6, 7, 9, ]
 Site-White                    | Train Loss: 1.3406 | Train Acc: 0.5128
 Site-White                    | Train Loss: 1.4102 | Train Acc: 0.4808
 Site-White                    | Train Loss: 1.3806 | Train Acc: 0.4412
 Site-White                    | Train Loss: 1.3441 | Train Acc: 0.5169
 Site-White                    | Train Loss: 1.4536 | Train Acc: 0.4530
 Site-White                    | Train Loss: 1.4313 | Train Acc: 0.4610
 Site-White                    | Train Loss: 1.3668 | Train Acc: 0.4478
 Site-White                    | Train Loss: 1.3478 | Train Acc: 0.4697
 Site-White                    | Train Loss: 1.3956 | Train Acc: 0.4566
 Site-White                    | Train Loss: 1.3456 | Train Acc: 0.4680
 Site-Black                    | Train Loss: 1.6358 | Train Acc: 0.3701
 Site-Black                    | Train Loss: 1.5707 | Train Acc: 0.4406
 Site-White                     (3) | Val  Loss: 1.6066 | Val  Acc: 0.4615
 Site-White                     (0) | Val  Loss: 1.6977 | Val  Acc: 0.5294
 Site-White                     (0) | Val  Loss: 1.3495 | Val  Acc: 0.4889
 Site-White                     (2) | Val  Loss: 1.4245 | Val  Acc: 0.4746
 Site-White                     (2) | Val  Loss: 1.3786 | Val  Acc: 0.4744
 Site-White                     (0) | Val  Loss: 1.3185 | Val  Acc: 0.5098
 Site-White                     (2) | Val  Loss: 1.3868 | Val  Acc: 0.4627
 Site-White                     (2) | Val  Loss: 1.4038 | Val  Acc: 0.4602
 Site-White                     (0) | Val  Loss: 1.3399 | Val  Acc: 0.4609
 Site-White                     (2) | Val  Loss: 1.3923 | Val  Acc: 0.4669
 Site-Black                     (1) | Val  Loss: 1.6671 | Val  Acc: 0.3786
 Site-Black                     (1) | Val  Loss: 1.6896 | Val  Acc: 0.3507
Average Valid Accuracy: 0.4599
Aggregated Acc | Val Acc: 0.4478
 Best site-White                    (3)  | Epoch:14 | Val Acc: 0.4615
 Best site-White                    (0)  | Epoch:14 | Val Acc: 0.5294
 Best site-White                    (0)  | Epoch:14 | Val Acc: 0.4889
 Best site-White                    (2)  | Epoch:14 | Val Acc: 0.4746
 Best site-White                    (2)  | Epoch:14 | Val Acc: 0.4744
 Best site-White                    (0)  | Epoch:14 | Val Acc: 0.5098
 Best site-White                    (2)  | Epoch:14 | Val Acc: 0.4627
 Best site-White                    (2)  | Epoch:14 | Val Acc: 0.4602
 Best site-White                    (0)  | Epoch:14 | Val Acc: 0.4609
 Best site-White                    (2)  | Epoch:14 | Val Acc: 0.4669
 Best site-Black                    (1)  | Epoch:14 | Val Acc: 0.3786
 Best site-Black                    (1)  | Epoch:14 | Val Acc: 0.3507
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 15 ============
cnt=[7, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
min_w=0.03330, quan_i=1.44, quan_c=1.40
minimize weight of clients:[0, 1, 2, 3, 7, 8, 9, ]
 Site-White                    | Train Loss: 1.4841 | Train Acc: 0.4103
 Site-White                    | Train Loss: 1.3647 | Train Acc: 0.5192
 Site-White                    | Train Loss: 1.2699 | Train Acc: 0.4559
 Site-White                    | Train Loss: 1.3775 | Train Acc: 0.5056
 Site-White                    | Train Loss: 1.4680 | Train Acc: 0.4444
 Site-White                    | Train Loss: 1.4289 | Train Acc: 0.4740
 Site-White                    | Train Loss: 1.4205 | Train Acc: 0.4577
 Site-White                    | Train Loss: 1.3875 | Train Acc: 0.4773
 Site-White                    | Train Loss: 1.4213 | Train Acc: 0.4682
 Site-White                    | Train Loss: 1.3446 | Train Acc: 0.4702
 Site-Black                    | Train Loss: 1.5501 | Train Acc: 0.3896
 Site-Black                    | Train Loss: 1.5894 | Train Acc: 0.3911
 Site-White                     (2) | Val  Loss: 1.5896 | Val  Acc: 0.4231
 Site-White                     (0) | Val  Loss: 1.7723 | Val  Acc: 0.4412
 Site-White                     (0) | Val  Loss: 1.4284 | Val  Acc: 0.4444
 Site-White                     (0) | Val  Loss: 1.4957 | Val  Acc: 0.3729
 Site-White                     (3) | Val  Loss: 1.4277 | Val  Acc: 0.4872
 Site-White                     (0) | Val  Loss: 1.2598 | Val  Acc: 0.5098
 Site-White                     (3) | Val  Loss: 1.4359 | Val  Acc: 0.4552
 Site-White                     (0) | Val  Loss: 1.4269 | Val  Acc: 0.4545
 Site-White                     (0) | Val  Loss: 1.3524 | Val  Acc: 0.4783
 Site-White                     (0) | Val  Loss: 1.4251 | Val  Acc: 0.4536
 Site-Black                     (1) | Val  Loss: 1.5546 | Val  Acc: 0.4272
 Site-Black                     (1) | Val  Loss: 1.5939 | Val  Acc: 0.3358
Average Valid Accuracy: 0.4403
Aggregated Acc | Val Acc: 0.4316
============ Train epoch 16 ============
cnt=[8, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
min_w=0.04062, quan_i=1.46, quan_c=1.40
minimize weight of clients:[2, ]
 Site-White                    | Train Loss: 1.3214 | Train Acc: 0.4872
 Site-White                    | Train Loss: 1.4256 | Train Acc: 0.5385
 Site-White                    | Train Loss: 1.3890 | Train Acc: 0.3971
 Site-White                    | Train Loss: 1.3390 | Train Acc: 0.5169
 Site-White                    | Train Loss: 1.4776 | Train Acc: 0.4444
 Site-White                    | Train Loss: 1.3997 | Train Acc: 0.4870
 Site-White                    | Train Loss: 1.3032 | Train Acc: 0.4925
 Site-White                    | Train Loss: 1.3670 | Train Acc: 0.4659
 Site-White                    | Train Loss: 1.3660 | Train Acc: 0.4798
 Site-White                    | Train Loss: 1.3188 | Train Acc: 0.4967
 Site-Black                    | Train Loss: 1.6639 | Train Acc: 0.3831
 Site-Black                    | Train Loss: 1.7151 | Train Acc: 0.3416
 Site-White                     (2) | Val  Loss: 1.4867 | Val  Acc: 0.4231
 Site-White                     (0) | Val  Loss: 1.6569 | Val  Acc: 0.5294
 Site-White                     (3) | Val  Loss: 1.3759 | Val  Acc: 0.4444
 Site-White                     (0) | Val  Loss: 1.4773 | Val  Acc: 0.4746
 Site-White                     (0) | Val  Loss: 1.3158 | Val  Acc: 0.5000
 Site-White                     (0) | Val  Loss: 1.2296 | Val  Acc: 0.5098
 Site-White                     (0) | Val  Loss: 1.3426 | Val  Acc: 0.5075
 Site-White                     (0) | Val  Loss: 1.3846 | Val  Acc: 0.4659
 Site-White                     (0) | Val  Loss: 1.3059 | Val  Acc: 0.4696
 Site-White                     (0) | Val  Loss: 1.3809 | Val  Acc: 0.4669
 Site-Black                     (1) | Val  Loss: 1.6870 | Val  Acc: 0.4175
 Site-Black                     (1) | Val  Loss: 1.7679 | Val  Acc: 0.3806
Average Valid Accuracy: 0.4658
Aggregated Acc | Val Acc: 0.4393
 Best site-White                    (2)  | Epoch:16 | Val Acc: 0.4231
 Best site-White                    (0)  | Epoch:16 | Val Acc: 0.5294
 Best site-White                    (3)  | Epoch:16 | Val Acc: 0.4444
 Best site-White                    (0)  | Epoch:16 | Val Acc: 0.4746
 Best site-White                    (0)  | Epoch:16 | Val Acc: 0.5000
 Best site-White                    (0)  | Epoch:16 | Val Acc: 0.5098
 Best site-White                    (0)  | Epoch:16 | Val Acc: 0.5075
 Best site-White                    (0)  | Epoch:16 | Val Acc: 0.4659
 Best site-White                    (0)  | Epoch:16 | Val Acc: 0.4696
 Best site-White                    (0)  | Epoch:16 | Val Acc: 0.4669
 Best site-Black                    (1)  | Epoch:16 | Val Acc: 0.4175
 Best site-Black                    (1)  | Epoch:16 | Val Acc: 0.3806
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 17 ============
cnt=[3, 5, 2, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
min_w=0.03338, quan_i=1.42, quan_c=1.41
minimize weight of clients:[0, 3, 5, 6, 7, 8, 9, ]
 Site-White                    | Train Loss: 1.2855 | Train Acc: 0.4359
 Site-White                    | Train Loss: 1.4356 | Train Acc: 0.5192
 Site-White                    | Train Loss: 1.4394 | Train Acc: 0.4559
 Site-White                    | Train Loss: 1.3598 | Train Acc: 0.4719
 Site-White                    | Train Loss: 1.4305 | Train Acc: 0.4359
 Site-White                    | Train Loss: 1.4354 | Train Acc: 0.4805
 Site-White                    | Train Loss: 1.3176 | Train Acc: 0.4577
 Site-White                    | Train Loss: 1.3747 | Train Acc: 0.4697
 Site-White                    | Train Loss: 1.3947 | Train Acc: 0.4480
 Site-White                    | Train Loss: 1.3837 | Train Acc: 0.4834
 Site-Black                    | Train Loss: 1.5285 | Train Acc: 0.3636
 Site-Black                    | Train Loss: 1.5514 | Train Acc: 0.4158
 Site-White                     (1) | Val  Loss: 1.5578 | Val  Acc: 0.5385
 Site-White                     (3) | Val  Loss: 1.8045 | Val  Acc: 0.4706
 Site-White                     (3) | Val  Loss: 1.3674 | Val  Acc: 0.4444
 Site-White                     (0) | Val  Loss: 1.5075 | Val  Acc: 0.3898
 Site-White                     (1) | Val  Loss: 1.3718 | Val  Acc: 0.4615
 Site-White                     (1) | Val  Loss: 1.2747 | Val  Acc: 0.4804
 Site-White                     (1) | Val  Loss: 1.4290 | Val  Acc: 0.4627
 Site-White                     (1) | Val  Loss: 1.4086 | Val  Acc: 0.4659
 Site-White                     (0) | Val  Loss: 1.3291 | Val  Acc: 0.4609
 Site-White                     (0) | Val  Loss: 1.4119 | Val  Acc: 0.4570
 Site-Black                     (2) | Val  Loss: 1.5418 | Val  Acc: 0.4175
 Site-Black                     (2) | Val  Loss: 1.6156 | Val  Acc: 0.3806
Average Valid Accuracy: 0.4525
Aggregated Acc | Val Acc: 0.4436
============ Train epoch 18 ============
cnt=[2, 2, 7, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
min_w=0.03075, quan_i=1.45, quan_c=1.40
minimize weight of clients:[0, 3, 6, 7, 8, ]
 Site-White                    | Train Loss: 1.3649 | Train Acc: 0.4872
 Site-White                    | Train Loss: 1.4499 | Train Acc: 0.4615
 Site-White                    | Train Loss: 1.5160 | Train Acc: 0.4265
 Site-White                    | Train Loss: 1.3265 | Train Acc: 0.5169
 Site-White                    | Train Loss: 1.4703 | Train Acc: 0.4530
 Site-White                    | Train Loss: 1.4223 | Train Acc: 0.4286
 Site-White                    | Train Loss: 1.3158 | Train Acc: 0.4677
 Site-White                    | Train Loss: 1.3548 | Train Acc: 0.4848
 Site-White                    | Train Loss: 1.3780 | Train Acc: 0.4566
 Site-White                    | Train Loss: 1.2874 | Train Acc: 0.4923
 Site-Black                    | Train Loss: 1.5593 | Train Acc: 0.3896
 Site-Black                    | Train Loss: 1.5631 | Train Acc: 0.4109
 Site-White                     (3) | Val  Loss: 1.5444 | Val  Acc: 0.4615
 Site-White                     (2) | Val  Loss: 1.7442 | Val  Acc: 0.5000
 Site-White                     (2) | Val  Loss: 1.3858 | Val  Acc: 0.4667
 Site-White                     (2) | Val  Loss: 1.4724 | Val  Acc: 0.4407
 Site-White                     (0) | Val  Loss: 1.3490 | Val  Acc: 0.4744
 Site-White                     (2) | Val  Loss: 1.2849 | Val  Acc: 0.4412
 Site-White                     (2) | Val  Loss: 1.3829 | Val  Acc: 0.5224
 Site-White                     (2) | Val  Loss: 1.4379 | Val  Acc: 0.4318
 Site-White                     (2) | Val  Loss: 1.3326 | Val  Acc: 0.4391
 Site-White                     (0) | Val  Loss: 1.3805 | Val  Acc: 0.4636
 Site-Black                     (1) | Val  Loss: 1.6164 | Val  Acc: 0.4466
 Site-Black                     (1) | Val  Loss: 1.5767 | Val  Acc: 0.4104
Average Valid Accuracy: 0.4582
Aggregated Acc | Val Acc: 0.4555
============ Train epoch 19 ============
cnt=[1, 8, 2, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
min_w=0.03421, quan_i=1.47, quan_c=1.37
minimize weight of clients:[3, 5, 6, 7, 8, 9, ]
 Site-White                    | Train Loss: 1.6912 | Train Acc: 0.4615
 Site-White                    | Train Loss: 1.3409 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.5201 | Train Acc: 0.4118
 Site-White                    | Train Loss: 1.3515 | Train Acc: 0.5281
 Site-White                    | Train Loss: 1.4120 | Train Acc: 0.4188
 Site-White                    | Train Loss: 1.4293 | Train Acc: 0.4740
 Site-White                    | Train Loss: 1.3504 | Train Acc: 0.4428
 Site-White                    | Train Loss: 1.3587 | Train Acc: 0.4659
 Site-White                    | Train Loss: 1.3960 | Train Acc: 0.4798
 Site-White                    | Train Loss: 1.3404 | Train Acc: 0.4702
 Site-Black                    | Train Loss: 1.5287 | Train Acc: 0.4091
 Site-Black                    | Train Loss: 1.4988 | Train Acc: 0.4505
 Site-White                     (0) | Val  Loss: 1.5363 | Val  Acc: 0.6154
 Site-White                     (3) | Val  Loss: 1.7153 | Val  Acc: 0.5882
 Site-White                     (1) | Val  Loss: 1.4112 | Val  Acc: 0.5111
 Site-White                     (1) | Val  Loss: 1.4776 | Val  Acc: 0.3898
 Site-White                     (1) | Val  Loss: 1.3696 | Val  Acc: 0.4359
 Site-White                     (1) | Val  Loss: 1.2696 | Val  Acc: 0.5098
 Site-White                     (1) | Val  Loss: 1.3837 | Val  Acc: 0.5075
 Site-White                     (1) | Val  Loss: 1.3847 | Val  Acc: 0.4716
 Site-White                     (1) | Val  Loss: 1.3416 | Val  Acc: 0.4174
 Site-White                     (1) | Val  Loss: 1.3889 | Val  Acc: 0.4536
 Site-Black                     (2) | Val  Loss: 1.5080 | Val  Acc: 0.4466
 Site-Black                     (2) | Val  Loss: 1.5491 | Val  Acc: 0.4104
Average Valid Accuracy: 0.4798
Aggregated Acc | Val Acc: 0.5236
 Best site-White                    (0)  | Epoch:19 | Val Acc: 0.6154
 Best site-White                    (3)  | Epoch:19 | Val Acc: 0.5882
 Best site-White                    (1)  | Epoch:19 | Val Acc: 0.5111
 Best site-White                    (1)  | Epoch:19 | Val Acc: 0.3898
 Best site-White                    (1)  | Epoch:19 | Val Acc: 0.4359
 Best site-White                    (1)  | Epoch:19 | Val Acc: 0.5098
 Best site-White                    (1)  | Epoch:19 | Val Acc: 0.5075
 Best site-White                    (1)  | Epoch:19 | Val Acc: 0.4716
 Best site-White                    (1)  | Epoch:19 | Val Acc: 0.4174
 Best site-White                    (1)  | Epoch:19 | Val Acc: 0.4536
 Best site-Black                    (2)  | Epoch:19 | Val Acc: 0.4466
 Best site-Black                    (2)  | Epoch:19 | Val Acc: 0.4104
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
 Test site-White                    | Epoch:19 | Test Acc: 0.4037
 Test site-Black                    | Epoch:19 | Test Acc: 0.3281
Average Test Accuracy: 0.3659, domain std=0.0378, individual std=0.0282
============ Train epoch 20 ============
cnt=[6, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
min_w=0.04371, quan_i=1.50, quan_c=1.45
minimize weight of clients:[1, 3, 5, 6, 7, 8, 9, ]
 Site-White                    | Train Loss: 1.5526 | Train Acc: 0.4103
 Site-White                    | Train Loss: 1.3246 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.4842 | Train Acc: 0.4265
 Site-White                    | Train Loss: 1.3616 | Train Acc: 0.5056
 Site-White                    | Train Loss: 1.3945 | Train Acc: 0.4444
 Site-White                    | Train Loss: 1.3955 | Train Acc: 0.4870
 Site-White                    | Train Loss: 1.3380 | Train Acc: 0.4527
 Site-White                    | Train Loss: 1.3344 | Train Acc: 0.4811
 Site-White                    | Train Loss: 1.3703 | Train Acc: 0.4884
 Site-White                    | Train Loss: 1.2845 | Train Acc: 0.4901
 Site-Black                    | Train Loss: 1.4929 | Train Acc: 0.4610
 Site-Black                    | Train Loss: 1.4561 | Train Acc: 0.4455
 Site-White                     (0) | Val  Loss: 1.4537 | Val  Acc: 0.5000
 Site-White                     (0) | Val  Loss: 1.9364 | Val  Acc: 0.5294
 Site-White                     (3) | Val  Loss: 1.3646 | Val  Acc: 0.4000
 Site-White                     (0) | Val  Loss: 1.5058 | Val  Acc: 0.4068
 Site-White                     (3) | Val  Loss: 1.4010 | Val  Acc: 0.4487
 Site-White                     (2) | Val  Loss: 1.2597 | Val  Acc: 0.5490
 Site-White                     (2) | Val  Loss: 1.3557 | Val  Acc: 0.5149
 Site-White                     (0) | Val  Loss: 1.3769 | Val  Acc: 0.4659
 Site-White                     (0) | Val  Loss: 1.2842 | Val  Acc: 0.4522
 Site-White                     (0) | Val  Loss: 1.3929 | Val  Acc: 0.4536
 Site-Black                     (1) | Val  Loss: 1.5191 | Val  Acc: 0.4757
 Site-Black                     (1) | Val  Loss: 1.5287 | Val  Acc: 0.4627
Average Valid Accuracy: 0.4716
Aggregated Acc | Val Acc: 0.4734
============ Train epoch 21 ============
cnt=[3, 1, 7, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
min_w=0.03983, quan_i=1.45, quan_c=1.38
minimize weight of clients:[4, 5, 9, ]
 Site-White                    | Train Loss: 1.7866 | Train Acc: 0.4103
 Site-White                    | Train Loss: 1.3313 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.2116 | Train Acc: 0.4265
 Site-White                    | Train Loss: 1.3396 | Train Acc: 0.5056
 Site-White                    | Train Loss: 1.4185 | Train Acc: 0.4359
 Site-White                    | Train Loss: 1.3679 | Train Acc: 0.4545
 Site-White                    | Train Loss: 1.3694 | Train Acc: 0.4776
 Site-White                    | Train Loss: 1.3823 | Train Acc: 0.4962
 Site-White                    | Train Loss: 1.2969 | Train Acc: 0.5260
 Site-White                    | Train Loss: 1.3102 | Train Acc: 0.4812
 Site-Black                    | Train Loss: 1.5929 | Train Acc: 0.4221
 Site-Black                    | Train Loss: 1.5907 | Train Acc: 0.4356
 Site-White                     (2) | Val  Loss: 1.4076 | Val  Acc: 0.5769
 Site-White                     (2) | Val  Loss: 1.6006 | Val  Acc: 0.6471
 Site-White                     (2) | Val  Loss: 1.4260 | Val  Acc: 0.3778
 Site-White                     (2) | Val  Loss: 1.3795 | Val  Acc: 0.4746
 Site-White                     (0) | Val  Loss: 1.3470 | Val  Acc: 0.4744
 Site-White                     (0) | Val  Loss: 1.2002 | Val  Acc: 0.5000
 Site-White                     (2) | Val  Loss: 1.2985 | Val  Acc: 0.5224
 Site-White                     (2) | Val  Loss: 1.3350 | Val  Acc: 0.4659
 Site-White                     (2) | Val  Loss: 1.2893 | Val  Acc: 0.4609
 Site-White                     (0) | Val  Loss: 1.3418 | Val  Acc: 0.5000
 Site-Black                     (1) | Val  Loss: 1.6204 | Val  Acc: 0.3786
 Site-Black                     (3) | Val  Loss: 1.6755 | Val  Acc: 0.4179
Average Valid Accuracy: 0.4830
Aggregated Acc | Val Acc: 0.4479
 Best site-White                    (2)  | Epoch:21 | Val Acc: 0.5769
 Best site-White                    (2)  | Epoch:21 | Val Acc: 0.6471
 Best site-White                    (2)  | Epoch:21 | Val Acc: 0.3778
 Best site-White                    (2)  | Epoch:21 | Val Acc: 0.4746
 Best site-White                    (0)  | Epoch:21 | Val Acc: 0.4744
 Best site-White                    (0)  | Epoch:21 | Val Acc: 0.5000
 Best site-White                    (2)  | Epoch:21 | Val Acc: 0.5224
 Best site-White                    (2)  | Epoch:21 | Val Acc: 0.4659
 Best site-White                    (2)  | Epoch:21 | Val Acc: 0.4609
 Best site-White                    (0)  | Epoch:21 | Val Acc: 0.5000
 Best site-Black                    (1)  | Epoch:21 | Val Acc: 0.3786
 Best site-Black                    (3)  | Epoch:21 | Val Acc: 0.4179
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 2, 3, 5, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
min_w=0.04298, quan_i=1.42, quan_c=1.41
minimize weight of clients:[1, 2, 3, 5, 6, 8, 9, ]
 Site-White                    | Train Loss: 1.5742 | Train Acc: 0.4359
 Site-White                    | Train Loss: 1.3560 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.3180 | Train Acc: 0.4412
 Site-White                    | Train Loss: 1.3414 | Train Acc: 0.4719
 Site-White                    | Train Loss: 1.4272 | Train Acc: 0.4444
 Site-White                    | Train Loss: 1.3895 | Train Acc: 0.4675
 Site-White                    | Train Loss: 1.3124 | Train Acc: 0.4776
 Site-White                    | Train Loss: 1.3090 | Train Acc: 0.4924
 Site-White                    | Train Loss: 1.3357 | Train Acc: 0.4653
 Site-White                    | Train Loss: 1.3171 | Train Acc: 0.5077
 Site-Black                    | Train Loss: 1.5178 | Train Acc: 0.4091
 Site-Black                    | Train Loss: 1.5173 | Train Acc: 0.4901
 Site-White                     (0) | Val  Loss: 1.5782 | Val  Acc: 0.4615
 Site-White                     (3) | Val  Loss: 1.6476 | Val  Acc: 0.5882
 Site-White                     (3) | Val  Loss: 1.3450 | Val  Acc: 0.5111
 Site-White                     (2) | Val  Loss: 1.3950 | Val  Acc: 0.4576
 Site-White                     (2) | Val  Loss: 1.3491 | Val  Acc: 0.5000
 Site-White                     (3) | Val  Loss: 1.2575 | Val  Acc: 0.4412
 Site-White                     (3) | Val  Loss: 1.3165 | Val  Acc: 0.5373
 Site-White                     (0) | Val  Loss: 1.3506 | Val  Acc: 0.4261
 Site-White                     (3) | Val  Loss: 1.2756 | Val  Acc: 0.4739
 Site-White                     (2) | Val  Loss: 1.3642 | Val  Acc: 0.4735
 Site-Black                     (1) | Val  Loss: 1.5354 | Val  Acc: 0.4757
 Site-Black                     (1) | Val  Loss: 1.4891 | Val  Acc: 0.4403
Average Valid Accuracy: 0.4822
Aggregated Acc | Val Acc: 0.4723
============ Train epoch 23 ============
cnt=[3, 2, 5, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
min_w=0.04155, quan_i=1.42, quan_c=1.40
minimize weight of clients:[1, 2, 5, 6, 7, 8, 9, ]
 Site-White                    | Train Loss: 1.4933 | Train Acc: 0.4872
 Site-White                    | Train Loss: 1.3469 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.2039 | Train Acc: 0.4118
 Site-White                    | Train Loss: 1.3311 | Train Acc: 0.4607
 Site-White                    | Train Loss: 1.4144 | Train Acc: 0.4444
 Site-White                    | Train Loss: 1.4186 | Train Acc: 0.4481
 Site-White                    | Train Loss: 1.3072 | Train Acc: 0.4677
 Site-White                    | Train Loss: 1.3462 | Train Acc: 0.4848
 Site-White                    | Train Loss: 1.3681 | Train Acc: 0.4798
 Site-White                    | Train Loss: 1.3419 | Train Acc: 0.4702
 Site-Black                    | Train Loss: 1.4543 | Train Acc: 0.4610
 Site-Black                    | Train Loss: 1.4080 | Train Acc: 0.4950
 Site-White                     (3) | Val  Loss: 1.5816 | Val  Acc: 0.4231
 Site-White                     (2) | Val  Loss: 1.7752 | Val  Acc: 0.4706
 Site-White                     (2) | Val  Loss: 1.4468 | Val  Acc: 0.4222
 Site-White                     (3) | Val  Loss: 1.4057 | Val  Acc: 0.4915
 Site-White                     (0) | Val  Loss: 1.3683 | Val  Acc: 0.4872
 Site-White                     (2) | Val  Loss: 1.2798 | Val  Acc: 0.4902
 Site-White                     (2) | Val  Loss: 1.3931 | Val  Acc: 0.4851
 Site-White                     (2) | Val  Loss: 1.3308 | Val  Acc: 0.4659
 Site-White                     (0) | Val  Loss: 1.2864 | Val  Acc: 0.4565
 Site-White                     (0) | Val  Loss: 1.3669 | Val  Acc: 0.4834
 Site-Black                     (1) | Val  Loss: 1.4576 | Val  Acc: 0.4854
 Site-Black                     (1) | Val  Loss: 1.5162 | Val  Acc: 0.4254
Average Valid Accuracy: 0.4655
Aggregated Acc | Val Acc: 0.4638
============ Train epoch 24 ============
cnt=[6, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
min_w=0.04186, quan_i=1.42, quan_c=1.36
minimize weight of clients:[6, 9, ]
 Site-White                    | Train Loss: 1.4816 | Train Acc: 0.5128
 Site-White                    | Train Loss: 1.3256 | Train Acc: 0.5385
 Site-White                    | Train Loss: 1.4044 | Train Acc: 0.4265
 Site-White                    | Train Loss: 1.2837 | Train Acc: 0.5169
 Site-White                    | Train Loss: 1.3904 | Train Acc: 0.4872
 Site-White                    | Train Loss: 1.3672 | Train Acc: 0.4481
 Site-White                    | Train Loss: 1.2468 | Train Acc: 0.4876
 Site-White                    | Train Loss: 1.3086 | Train Acc: 0.4773
 Site-White                    | Train Loss: 1.3034 | Train Acc: 0.5029
 Site-White                    | Train Loss: 1.2669 | Train Acc: 0.4790
 Site-Black                    | Train Loss: 1.5173 | Train Acc: 0.4156
 Site-Black                    | Train Loss: 1.4997 | Train Acc: 0.4554
 Site-White                     (2) | Val  Loss: 1.4416 | Val  Acc: 0.5000
 Site-White                     (0) | Val  Loss: 1.6222 | Val  Acc: 0.5588
 Site-White                     (0) | Val  Loss: 1.3986 | Val  Acc: 0.4667
 Site-White                     (0) | Val  Loss: 1.4088 | Val  Acc: 0.4407
 Site-White                     (3) | Val  Loss: 1.3533 | Val  Acc: 0.5128
 Site-White                     (0) | Val  Loss: 1.2269 | Val  Acc: 0.4804
 Site-White                     (3) | Val  Loss: 1.2624 | Val  Acc: 0.4851
 Site-White                     (0) | Val  Loss: 1.3000 | Val  Acc: 0.4886
 Site-White                     (0) | Val  Loss: 1.2777 | Val  Acc: 0.4739
 Site-White                     (3) | Val  Loss: 1.3517 | Val  Acc: 0.4669
 Site-Black                     (1) | Val  Loss: 1.6322 | Val  Acc: 0.4466
 Site-Black                     (1) | Val  Loss: 1.6633 | Val  Acc: 0.4478
Average Valid Accuracy: 0.4807
Aggregated Acc | Val Acc: 0.4801
============ Train epoch 25 ============
cnt=[4, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
min_w=0.04062, quan_i=1.41, quan_c=1.33
minimize weight of clients:[3, 6, 9, ]
 Site-White                    | Train Loss: 1.2810 | Train Acc: 0.4359
 Site-White                    | Train Loss: 1.2592 | Train Acc: 0.4808
 Site-White                    | Train Loss: 1.3916 | Train Acc: 0.3529
 Site-White                    | Train Loss: 1.2854 | Train Acc: 0.5506
 Site-White                    | Train Loss: 1.3335 | Train Acc: 0.4786
 Site-White                    | Train Loss: 1.3814 | Train Acc: 0.4740
 Site-White                    | Train Loss: 1.2843 | Train Acc: 0.4677
 Site-White                    | Train Loss: 1.3015 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.2849 | Train Acc: 0.5231
 Site-White                    | Train Loss: 1.3007 | Train Acc: 0.5055
 Site-Black                    | Train Loss: 1.5801 | Train Acc: 0.4026
 Site-Black                    | Train Loss: 1.5072 | Train Acc: 0.5099
 Site-White                     (3) | Val  Loss: 1.3760 | Val  Acc: 0.5769
 Site-White                     (2) | Val  Loss: 1.5755 | Val  Acc: 0.5588
 Site-White                     (2) | Val  Loss: 1.3284 | Val  Acc: 0.4444
 Site-White                     (0) | Val  Loss: 1.3675 | Val  Acc: 0.5254
 Site-White                     (0) | Val  Loss: 1.2805 | Val  Acc: 0.5000
 Site-White                     (2) | Val  Loss: 1.1740 | Val  Acc: 0.4706
 Site-White                     (0) | Val  Loss: 1.2868 | Val  Acc: 0.5448
 Site-White                     (2) | Val  Loss: 1.2916 | Val  Acc: 0.4716
 Site-White                     (2) | Val  Loss: 1.2981 | Val  Acc: 0.4696
 Site-White                     (0) | Val  Loss: 1.3260 | Val  Acc: 0.4868
 Site-Black                     (1) | Val  Loss: 1.5847 | Val  Acc: 0.5146
 Site-Black                     (1) | Val  Loss: 1.7352 | Val  Acc: 0.3955
Average Valid Accuracy: 0.4966
Aggregated Acc | Val Acc: 0.5073
 Best site-White                    (3)  | Epoch:25 | Val Acc: 0.5769
 Best site-White                    (2)  | Epoch:25 | Val Acc: 0.5588
 Best site-White                    (2)  | Epoch:25 | Val Acc: 0.4444
 Best site-White                    (0)  | Epoch:25 | Val Acc: 0.5254
 Best site-White                    (0)  | Epoch:25 | Val Acc: 0.5000
 Best site-White                    (2)  | Epoch:25 | Val Acc: 0.4706
 Best site-White                    (0)  | Epoch:25 | Val Acc: 0.5448
 Best site-White                    (2)  | Epoch:25 | Val Acc: 0.4716
 Best site-White                    (2)  | Epoch:25 | Val Acc: 0.4696
 Best site-White                    (0)  | Epoch:25 | Val Acc: 0.4868
 Best site-Black                    (1)  | Epoch:25 | Val Acc: 0.5146
 Best site-Black                    (1)  | Epoch:25 | Val Acc: 0.3955
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 26 ============
cnt=[7, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
min_w=0.03028, quan_i=1.38, quan_c=1.32
minimize weight of clients:[0, 6, ]
 Site-White                    | Train Loss: 1.3260 | Train Acc: 0.4872
 Site-White                    | Train Loss: 1.2917 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.5843 | Train Acc: 0.4265
 Site-White                    | Train Loss: 1.2901 | Train Acc: 0.5169
 Site-White                    | Train Loss: 1.3630 | Train Acc: 0.4444
 Site-White                    | Train Loss: 1.3932 | Train Acc: 0.4675
 Site-White                    | Train Loss: 1.2887 | Train Acc: 0.4726
 Site-White                    | Train Loss: 1.2620 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.2601 | Train Acc: 0.5260
 Site-White                    | Train Loss: 1.2768 | Train Acc: 0.5121
 Site-Black                    | Train Loss: 1.5310 | Train Acc: 0.4416
 Site-Black                    | Train Loss: 1.4941 | Train Acc: 0.4653
 Site-White                     (3) | Val  Loss: 1.4916 | Val  Acc: 0.5769
 Site-White                     (0) | Val  Loss: 1.5364 | Val  Acc: 0.6471
 Site-White                     (0) | Val  Loss: 1.2947 | Val  Acc: 0.5333
 Site-White                     (0) | Val  Loss: 1.3680 | Val  Acc: 0.4407
 Site-White                     (0) | Val  Loss: 1.2788 | Val  Acc: 0.5000
 Site-White                     (2) | Val  Loss: 1.2104 | Val  Acc: 0.5098
 Site-White                     (3) | Val  Loss: 1.2574 | Val  Acc: 0.4925
 Site-White                     (0) | Val  Loss: 1.3033 | Val  Acc: 0.5057
 Site-White                     (0) | Val  Loss: 1.2914 | Val  Acc: 0.4696
 Site-White                     (0) | Val  Loss: 1.3445 | Val  Acc: 0.4735
 Site-Black                     (1) | Val  Loss: 1.5196 | Val  Acc: 0.5049
 Site-Black                     (1) | Val  Loss: 1.7139 | Val  Acc: 0.4701
Average Valid Accuracy: 0.5103
Aggregated Acc | Val Acc: 0.5105
 Best site-White                    (3)  | Epoch:26 | Val Acc: 0.5769
 Best site-White                    (0)  | Epoch:26 | Val Acc: 0.6471
 Best site-White                    (0)  | Epoch:26 | Val Acc: 0.5333
 Best site-White                    (0)  | Epoch:26 | Val Acc: 0.4407
 Best site-White                    (0)  | Epoch:26 | Val Acc: 0.5000
 Best site-White                    (2)  | Epoch:26 | Val Acc: 0.5098
 Best site-White                    (3)  | Epoch:26 | Val Acc: 0.4925
 Best site-White                    (0)  | Epoch:26 | Val Acc: 0.5057
 Best site-White                    (0)  | Epoch:26 | Val Acc: 0.4696
 Best site-White                    (0)  | Epoch:26 | Val Acc: 0.4735
 Best site-Black                    (1)  | Epoch:26 | Val Acc: 0.5049
 Best site-Black                    (1)  | Epoch:26 | Val Acc: 0.4701
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 27 ============
cnt=[3, 2, 1, 6, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
min_w=0.03241, quan_i=1.40, quan_c=1.32
minimize weight of clients:[4, 6, 9, ]
 Site-White                    | Train Loss: 1.2550 | Train Acc: 0.4103
 Site-White                    | Train Loss: 1.3477 | Train Acc: 0.5192
 Site-White                    | Train Loss: 1.2570 | Train Acc: 0.4118
 Site-White                    | Train Loss: 1.3196 | Train Acc: 0.5281
 Site-White                    | Train Loss: 1.3969 | Train Acc: 0.4615
 Site-White                    | Train Loss: 1.3656 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.3150 | Train Acc: 0.5075
 Site-White                    | Train Loss: 1.2768 | Train Acc: 0.5265
 Site-White                    | Train Loss: 1.2872 | Train Acc: 0.5029
 Site-White                    | Train Loss: 1.2717 | Train Acc: 0.5188
 Site-Black                    | Train Loss: 1.4620 | Train Acc: 0.4675
 Site-Black                    | Train Loss: 1.4761 | Train Acc: 0.4554
 Site-White                     (2) | Val  Loss: 1.5075 | Val  Acc: 0.5000
 Site-White                     (3) | Val  Loss: 1.4871 | Val  Acc: 0.5882
 Site-White                     (3) | Val  Loss: 1.3222 | Val  Acc: 0.4444
 Site-White                     (3) | Val  Loss: 1.3639 | Val  Acc: 0.4746
 Site-White                     (0) | Val  Loss: 1.3056 | Val  Acc: 0.5000
 Site-White                     (3) | Val  Loss: 1.1897 | Val  Acc: 0.4804
 Site-White                     (0) | Val  Loss: 1.2738 | Val  Acc: 0.5448
 Site-White                     (3) | Val  Loss: 1.2607 | Val  Acc: 0.4659
 Site-White                     (3) | Val  Loss: 1.2500 | Val  Acc: 0.4739
 Site-White                     (0) | Val  Loss: 1.3453 | Val  Acc: 0.4901
 Site-Black                     (1) | Val  Loss: 1.5583 | Val  Acc: 0.4466
 Site-Black                     (1) | Val  Loss: 1.5336 | Val  Acc: 0.4701
Average Valid Accuracy: 0.4899
Aggregated Acc | Val Acc: 0.4895
============ Train epoch 28 ============
cnt=[2, 7, 2, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
min_w=0.02953, quan_i=1.36, quan_c=1.31
minimize weight of clients:[0, 7, ]
 Site-White                    | Train Loss: 1.2834 | Train Acc: 0.5385
 Site-White                    | Train Loss: 1.3418 | Train Acc: 0.5577
 Site-White                    | Train Loss: 1.3047 | Train Acc: 0.4412
 Site-White                    | Train Loss: 1.2419 | Train Acc: 0.5393
 Site-White                    | Train Loss: 1.3879 | Train Acc: 0.4359
 Site-White                    | Train Loss: 1.3513 | Train Acc: 0.4740
 Site-White                    | Train Loss: 1.2919 | Train Acc: 0.4776
 Site-White                    | Train Loss: 1.2605 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.2583 | Train Acc: 0.5520
 Site-White                    | Train Loss: 1.2654 | Train Acc: 0.5055
 Site-Black                    | Train Loss: 1.5029 | Train Acc: 0.4610
 Site-Black                    | Train Loss: 1.5036 | Train Acc: 0.4406
 Site-White                     (2) | Val  Loss: 1.5002 | Val  Acc: 0.4615
 Site-White                     (3) | Val  Loss: 1.4412 | Val  Acc: 0.6765
 Site-White                     (1) | Val  Loss: 1.3334 | Val  Acc: 0.5111
 Site-White                     (1) | Val  Loss: 1.4077 | Val  Acc: 0.4407
 Site-White                     (1) | Val  Loss: 1.2606 | Val  Acc: 0.4872
 Site-White                     (1) | Val  Loss: 1.1425 | Val  Acc: 0.5294
 Site-White                     (1) | Val  Loss: 1.2509 | Val  Acc: 0.5672
 Site-White                     (2) | Val  Loss: 1.2933 | Val  Acc: 0.4773
 Site-White                     (1) | Val  Loss: 1.2609 | Val  Acc: 0.5043
 Site-White                     (1) | Val  Loss: 1.3465 | Val  Acc: 0.4735
 Site-Black                     (0) | Val  Loss: 1.5731 | Val  Acc: 0.4563
 Site-Black                     (0) | Val  Loss: 1.6672 | Val  Acc: 0.4776
Average Valid Accuracy: 0.5052
Aggregated Acc | Val Acc: 0.5287
============ Train epoch 29 ============
cnt=[1, 2, 6, 3, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
min_w=0.03000, quan_i=1.35, quan_c=1.29
minimize weight of clients:[0, 3, 8, ]
 Site-White                    | Train Loss: 1.5253 | Train Acc: 0.4872
 Site-White                    | Train Loss: 1.2297 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.3759 | Train Acc: 0.4265
 Site-White                    | Train Loss: 1.2618 | Train Acc: 0.5169
 Site-White                    | Train Loss: 1.3474 | Train Acc: 0.4957
 Site-White                    | Train Loss: 1.3344 | Train Acc: 0.5065
 Site-White                    | Train Loss: 1.2954 | Train Acc: 0.4776
 Site-White                    | Train Loss: 1.2940 | Train Acc: 0.5114
 Site-White                    | Train Loss: 1.2564 | Train Acc: 0.5405
 Site-White                    | Train Loss: 1.2653 | Train Acc: 0.5254
 Site-Black                    | Train Loss: 1.5585 | Train Acc: 0.4351
 Site-Black                    | Train Loss: 1.4595 | Train Acc: 0.4950
 Site-White                     (3) | Val  Loss: 1.4484 | Val  Acc: 0.4615
 Site-White                     (2) | Val  Loss: 1.5965 | Val  Acc: 0.5882
 Site-White                     (2) | Val  Loss: 1.3381 | Val  Acc: 0.4667
 Site-White                     (3) | Val  Loss: 1.3630 | Val  Acc: 0.4576
 Site-White                     (0) | Val  Loss: 1.2237 | Val  Acc: 0.5385
 Site-White                     (2) | Val  Loss: 1.1509 | Val  Acc: 0.5000
 Site-White                     (2) | Val  Loss: 1.2349 | Val  Acc: 0.5448
 Site-White                     (2) | Val  Loss: 1.2908 | Val  Acc: 0.4830
 Site-White                     (3) | Val  Loss: 1.2663 | Val  Acc: 0.4957
 Site-White                     (2) | Val  Loss: 1.3143 | Val  Acc: 0.4801
 Site-Black                     (1) | Val  Loss: 1.5681 | Val  Acc: 0.4660
 Site-Black                     (1) | Val  Loss: 1.6057 | Val  Acc: 0.4478
Average Valid Accuracy: 0.4942
Aggregated Acc | Val Acc: 0.4944
============ Train epoch 30 ============
cnt=[4, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
min_w=0.03857, quan_i=1.38, quan_c=1.30
minimize weight of clients:[1, 3, 4, 9, ]
 Site-White                    | Train Loss: 1.0867 | Train Acc: 0.4615
 Site-White                    | Train Loss: 1.3781 | Train Acc: 0.4231
 Site-White                    | Train Loss: 1.3708 | Train Acc: 0.4412
 Site-White                    | Train Loss: 1.2641 | Train Acc: 0.5393
 Site-White                    | Train Loss: 1.3363 | Train Acc: 0.5043
 Site-White                    | Train Loss: 1.3006 | Train Acc: 0.5325
 Site-White                    | Train Loss: 1.2887 | Train Acc: 0.4826
 Site-White                    | Train Loss: 1.2513 | Train Acc: 0.5038
 Site-White                    | Train Loss: 1.2531 | Train Acc: 0.5434
 Site-White                    | Train Loss: 1.2874 | Train Acc: 0.5143
 Site-Black                    | Train Loss: 1.5290 | Train Acc: 0.4416
 Site-Black                    | Train Loss: 1.4914 | Train Acc: 0.4901
 Site-White                     (3) | Val  Loss: 1.4292 | Val  Acc: 0.5385
 Site-White                     (2) | Val  Loss: 1.6266 | Val  Acc: 0.5294
 Site-White                     (2) | Val  Loss: 1.3443 | Val  Acc: 0.4222
 Site-White                     (2) | Val  Loss: 1.3591 | Val  Acc: 0.4746
 Site-White                     (2) | Val  Loss: 1.2292 | Val  Acc: 0.5513
 Site-White                     (0) | Val  Loss: 1.1605 | Val  Acc: 0.5294
 Site-White                     (0) | Val  Loss: 1.2123 | Val  Acc: 0.5000
 Site-White                     (0) | Val  Loss: 1.2800 | Val  Acc: 0.5170
 Site-White                     (0) | Val  Loss: 1.2018 | Val  Acc: 0.4913
 Site-White                     (2) | Val  Loss: 1.3063 | Val  Acc: 0.5033
 Site-Black                     (1) | Val  Loss: 1.5209 | Val  Acc: 0.4757
 Site-Black                     (1) | Val  Loss: 1.6580 | Val  Acc: 0.4328
Average Valid Accuracy: 0.4971
Aggregated Acc | Val Acc: 0.4996
============ Train epoch 31 ============
cnt=[2, 2, 6, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
min_w=0.02550, quan_i=1.38, quan_c=1.30
minimize weight of clients:[0, 3, 5, 6, 7, 8, ]
 Site-White                    | Train Loss: 1.5305 | Train Acc: 0.4359
 Site-White                    | Train Loss: 1.3306 | Train Acc: 0.5577
 Site-White                    | Train Loss: 1.4316 | Train Acc: 0.4412
 Site-White                    | Train Loss: 1.2993 | Train Acc: 0.5169
 Site-White                    | Train Loss: 1.3839 | Train Acc: 0.4444
 Site-White                    | Train Loss: 1.3675 | Train Acc: 0.5065
 Site-White                    | Train Loss: 1.2477 | Train Acc: 0.4776
 Site-White                    | Train Loss: 1.3250 | Train Acc: 0.5038
 Site-White                    | Train Loss: 1.2763 | Train Acc: 0.5173
 Site-White                    | Train Loss: 1.1999 | Train Acc: 0.5430
 Site-Black                    | Train Loss: 1.4129 | Train Acc: 0.4610
 Site-Black                    | Train Loss: 1.3679 | Train Acc: 0.4653
 Site-White                     (2) | Val  Loss: 1.5719 | Val  Acc: 0.4231
 Site-White                     (2) | Val  Loss: 1.6484 | Val  Acc: 0.5294
 Site-White                     (2) | Val  Loss: 1.3388 | Val  Acc: 0.5111
 Site-White                     (0) | Val  Loss: 1.3803 | Val  Acc: 0.5085
 Site-White                     (3) | Val  Loss: 1.2577 | Val  Acc: 0.5385
 Site-White                     (2) | Val  Loss: 1.1966 | Val  Acc: 0.5490
 Site-White                     (2) | Val  Loss: 1.2147 | Val  Acc: 0.5299
 Site-White                     (2) | Val  Loss: 1.2895 | Val  Acc: 0.5170
 Site-White                     (0) | Val  Loss: 1.2315 | Val  Acc: 0.4913
 Site-White                     (3) | Val  Loss: 1.3019 | Val  Acc: 0.4801
 Site-Black                     (1) | Val  Loss: 1.4542 | Val  Acc: 0.4660
 Site-Black                     (1) | Val  Loss: 1.4128 | Val  Acc: 0.4627
Average Valid Accuracy: 0.5005
Aggregated Acc | Val Acc: 0.4959
============ Train epoch 32 ============
cnt=[1, 5, 5, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
min_w=0.04315, quan_i=1.38, quan_c=1.34
minimize weight of clients:[6, 7, 9, 11, ]
 Site-White                    | Train Loss: 1.4944 | Train Acc: 0.4615
 Site-White                    | Train Loss: 1.2909 | Train Acc: 0.5577
 Site-White                    | Train Loss: 1.5173 | Train Acc: 0.4412
 Site-White                    | Train Loss: 1.2350 | Train Acc: 0.5169
 Site-White                    | Train Loss: 1.3581 | Train Acc: 0.4701
 Site-White                    | Train Loss: 1.3542 | Train Acc: 0.4805
 Site-White                    | Train Loss: 1.2588 | Train Acc: 0.5025
 Site-White                    | Train Loss: 1.2121 | Train Acc: 0.5303
 Site-White                    | Train Loss: 1.2411 | Train Acc: 0.5087
 Site-White                    | Train Loss: 1.2117 | Train Acc: 0.5475
 Site-Black                    | Train Loss: 1.5007 | Train Acc: 0.4805
 Site-Black                    | Train Loss: 1.4871 | Train Acc: 0.4455
 Site-White                     (3) | Val  Loss: 1.4319 | Val  Acc: 0.4615
 Site-White                     (1) | Val  Loss: 1.5189 | Val  Acc: 0.5588
 Site-White                     (2) | Val  Loss: 1.3086 | Val  Acc: 0.4889
 Site-White                     (1) | Val  Loss: 1.3376 | Val  Acc: 0.5085
 Site-White                     (1) | Val  Loss: 1.1952 | Val  Acc: 0.4872
 Site-White                     (0) | Val  Loss: 1.1665 | Val  Acc: 0.4804
 Site-White                     (2) | Val  Loss: 1.2555 | Val  Acc: 0.5149
 Site-White                     (2) | Val  Loss: 1.2737 | Val  Acc: 0.5114
 Site-White                     (1) | Val  Loss: 1.2505 | Val  Acc: 0.4957
 Site-White                     (2) | Val  Loss: 1.3293 | Val  Acc: 0.4470
 Site-Black                     (1) | Val  Loss: 1.5605 | Val  Acc: 0.4951
 Site-Black                     (2) | Val  Loss: 1.5900 | Val  Acc: 0.4478
Average Valid Accuracy: 0.4914
Aggregated Acc | Val Acc: 0.4832
============ Train epoch 33 ============
cnt=[1, 6, 2, 3, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
min_w=0.03994, quan_i=1.46, quan_c=1.29
minimize weight of clients:[1, 5, 7, 8, 9, ]
 Site-White                    | Train Loss: 1.6387 | Train Acc: 0.5128
 Site-White                    | Train Loss: 1.2907 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.3233 | Train Acc: 0.4706
 Site-White                    | Train Loss: 1.2512 | Train Acc: 0.5169
 Site-White                    | Train Loss: 1.3431 | Train Acc: 0.4957
 Site-White                    | Train Loss: 1.3432 | Train Acc: 0.5390
 Site-White                    | Train Loss: 1.2401 | Train Acc: 0.5075
 Site-White                    | Train Loss: 1.2349 | Train Acc: 0.5227
 Site-White                    | Train Loss: 1.2498 | Train Acc: 0.5405
 Site-White                    | Train Loss: 1.2153 | Train Acc: 0.5121
 Site-Black                    | Train Loss: 1.4598 | Train Acc: 0.4221
 Site-Black                    | Train Loss: 1.4509 | Train Acc: 0.4752
 Site-White                     (0) | Val  Loss: 1.4193 | Val  Acc: 0.5000
 Site-White                     (1) | Val  Loss: 1.5242 | Val  Acc: 0.6176
 Site-White                     (1) | Val  Loss: 1.2481 | Val  Acc: 0.4889
 Site-White                     (3) | Val  Loss: 1.2900 | Val  Acc: 0.5254
 Site-White                     (3) | Val  Loss: 1.2379 | Val  Acc: 0.5641
 Site-White                     (1) | Val  Loss: 1.1927 | Val  Acc: 0.5686
 Site-White                     (3) | Val  Loss: 1.2430 | Val  Acc: 0.5522
 Site-White                     (1) | Val  Loss: 1.2681 | Val  Acc: 0.4886
 Site-White                     (1) | Val  Loss: 1.2078 | Val  Acc: 0.5130
 Site-White                     (1) | Val  Loss: 1.3028 | Val  Acc: 0.4967
 Site-Black                     (2) | Val  Loss: 1.4524 | Val  Acc: 0.4854
 Site-Black                     (2) | Val  Loss: 1.5271 | Val  Acc: 0.5075
Average Valid Accuracy: 0.5257
Aggregated Acc | Val Acc: 0.5182
 Best site-White                    (0)  | Epoch:33 | Val Acc: 0.5000
 Best site-White                    (1)  | Epoch:33 | Val Acc: 0.6176
 Best site-White                    (1)  | Epoch:33 | Val Acc: 0.4889
 Best site-White                    (3)  | Epoch:33 | Val Acc: 0.5254
 Best site-White                    (3)  | Epoch:33 | Val Acc: 0.5641
 Best site-White                    (1)  | Epoch:33 | Val Acc: 0.5686
 Best site-White                    (3)  | Epoch:33 | Val Acc: 0.5522
 Best site-White                    (1)  | Epoch:33 | Val Acc: 0.4886
 Best site-White                    (1)  | Epoch:33 | Val Acc: 0.5130
 Best site-White                    (1)  | Epoch:33 | Val Acc: 0.4967
 Best site-Black                    (2)  | Epoch:33 | Val Acc: 0.4854
 Best site-Black                    (2)  | Epoch:33 | Val Acc: 0.5075
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 34 ============
cnt=[5, 2, 1, 4, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
min_w=0.04033, quan_i=1.35, quan_c=1.28
minimize weight of clients:[3, 6, 9, ]
 Site-White                    | Train Loss: 1.3700 | Train Acc: 0.5385
 Site-White                    | Train Loss: 1.2701 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.1420 | Train Acc: 0.4118
 Site-White                    | Train Loss: 1.2678 | Train Acc: 0.5281
 Site-White                    | Train Loss: 1.3221 | Train Acc: 0.4615
 Site-White                    | Train Loss: 1.3077 | Train Acc: 0.4870
 Site-White                    | Train Loss: 1.2293 | Train Acc: 0.4826
 Site-White                    | Train Loss: 1.2735 | Train Acc: 0.5303
 Site-White                    | Train Loss: 1.2315 | Train Acc: 0.5462
 Site-White                    | Train Loss: 1.1890 | Train Acc: 0.5320
 Site-Black                    | Train Loss: 1.4446 | Train Acc: 0.4935
 Site-Black                    | Train Loss: 1.4043 | Train Acc: 0.4950
 Site-White                     (2) | Val  Loss: 1.3545 | Val  Acc: 0.5000
 Site-White                     (0) | Val  Loss: 1.4722 | Val  Acc: 0.6471
 Site-White                     (0) | Val  Loss: 1.3388 | Val  Acc: 0.4444
 Site-White                     (3) | Val  Loss: 1.3675 | Val  Acc: 0.4407
 Site-White                     (3) | Val  Loss: 1.1860 | Val  Acc: 0.5769
 Site-White                     (0) | Val  Loss: 1.1916 | Val  Acc: 0.4902
 Site-White                     (3) | Val  Loss: 1.2176 | Val  Acc: 0.5970
 Site-White                     (0) | Val  Loss: 1.3105 | Val  Acc: 0.4545
 Site-White                     (0) | Val  Loss: 1.2257 | Val  Acc: 0.4870
 Site-White                     (3) | Val  Loss: 1.2963 | Val  Acc: 0.4868
 Site-Black                     (1) | Val  Loss: 1.4845 | Val  Acc: 0.5243
 Site-Black                     (1) | Val  Loss: 1.5945 | Val  Acc: 0.4701
Average Valid Accuracy: 0.5099
Aggregated Acc | Val Acc: 0.5068
============ Train epoch 35 ============
cnt=[3, 1, 2, 6, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
min_w=0.03517, quan_i=1.33, quan_c=1.25
minimize weight of clients:[1, 2, 3, ]
 Site-White                    | Train Loss: 1.3145 | Train Acc: 0.4103
 Site-White                    | Train Loss: 1.2972 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.1630 | Train Acc: 0.4706
 Site-White                    | Train Loss: 1.3108 | Train Acc: 0.5056
 Site-White                    | Train Loss: 1.3174 | Train Acc: 0.4359
 Site-White                    | Train Loss: 1.2957 | Train Acc: 0.4675
 Site-White                    | Train Loss: 1.2711 | Train Acc: 0.5124
 Site-White                    | Train Loss: 1.2753 | Train Acc: 0.5038
 Site-White                    | Train Loss: 1.1908 | Train Acc: 0.5636
 Site-White                    | Train Loss: 1.1910 | Train Acc: 0.5099
 Site-Black                    | Train Loss: 1.5369 | Train Acc: 0.4351
 Site-Black                    | Train Loss: 1.4102 | Train Acc: 0.4406
 Site-White                     (1) | Val  Loss: 1.3842 | Val  Acc: 0.5385
 Site-White                     (0) | Val  Loss: 1.4511 | Val  Acc: 0.5882
 Site-White                     (0) | Val  Loss: 1.3048 | Val  Acc: 0.5111
 Site-White                     (0) | Val  Loss: 1.2732 | Val  Acc: 0.5085
 Site-White                     (3) | Val  Loss: 1.2140 | Val  Acc: 0.5128
 Site-White                     (3) | Val  Loss: 1.1661 | Val  Acc: 0.5588
 Site-White                     (3) | Val  Loss: 1.2064 | Val  Acc: 0.5522
 Site-White                     (3) | Val  Loss: 1.2497 | Val  Acc: 0.4830
 Site-White                     (3) | Val  Loss: 1.2508 | Val  Acc: 0.4739
 Site-White                     (3) | Val  Loss: 1.3112 | Val  Acc: 0.4901
 Site-Black                     (2) | Val  Loss: 1.5040 | Val  Acc: 0.4951
 Site-Black                     (2) | Val  Loss: 1.6767 | Val  Acc: 0.4179
Average Valid Accuracy: 0.5108
Aggregated Acc | Val Acc: 0.5107
============ Train epoch 36 ============
cnt=[4, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
min_w=0.03088, quan_i=1.32, quan_c=1.27
minimize weight of clients:[1, 2, 5, 6, 8, 9, ]
 Site-White                    | Train Loss: 1.5497 | Train Acc: 0.4359
 Site-White                    | Train Loss: 1.3300 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.2473 | Train Acc: 0.4412
 Site-White                    | Train Loss: 1.2449 | Train Acc: 0.4831
 Site-White                    | Train Loss: 1.3143 | Train Acc: 0.5128
 Site-White                    | Train Loss: 1.3219 | Train Acc: 0.4870
 Site-White                    | Train Loss: 1.2094 | Train Acc: 0.5124
 Site-White                    | Train Loss: 1.2427 | Train Acc: 0.4924
 Site-White                    | Train Loss: 1.2388 | Train Acc: 0.5434
 Site-White                    | Train Loss: 1.1970 | Train Acc: 0.5298
 Site-Black                    | Train Loss: 1.3999 | Train Acc: 0.4545
 Site-Black                    | Train Loss: 1.3715 | Train Acc: 0.5050
 Site-White                     (2) | Val  Loss: 1.3601 | Val  Acc: 0.5000
 Site-White                     (3) | Val  Loss: 1.6469 | Val  Acc: 0.5588
 Site-White                     (0) | Val  Loss: 1.2514 | Val  Acc: 0.5333
 Site-White                     (3) | Val  Loss: 1.3370 | Val  Acc: 0.4915
 Site-White                     (0) | Val  Loss: 1.2309 | Val  Acc: 0.5385
 Site-White                     (3) | Val  Loss: 1.1826 | Val  Acc: 0.4902
 Site-White                     (0) | Val  Loss: 1.2435 | Val  Acc: 0.5000
 Site-White                     (2) | Val  Loss: 1.2799 | Val  Acc: 0.4830
 Site-White                     (0) | Val  Loss: 1.2106 | Val  Acc: 0.5000
 Site-White                     (3) | Val  Loss: 1.3089 | Val  Acc: 0.4901
 Site-Black                     (1) | Val  Loss: 1.4408 | Val  Acc: 0.5146
 Site-Black                     (1) | Val  Loss: 1.4232 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5083
Aggregated Acc | Val Acc: 0.5061
============ Train epoch 37 ============
cnt=[7, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
min_w=0.03895, quan_i=1.33, quan_c=1.35
minimize weight of clients:[3, 4, 6, 7, 8, 9, ]
 Site-White                    | Train Loss: 1.1545 | Train Acc: 0.5128
 Site-White                    | Train Loss: 1.2644 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.4037 | Train Acc: 0.4559
 Site-White                    | Train Loss: 1.3050 | Train Acc: 0.4607
 Site-White                    | Train Loss: 1.3846 | Train Acc: 0.4786
 Site-White                    | Train Loss: 1.3369 | Train Acc: 0.5065
 Site-White                    | Train Loss: 1.2474 | Train Acc: 0.4826
 Site-White                    | Train Loss: 1.2362 | Train Acc: 0.5076
 Site-White                    | Train Loss: 1.2783 | Train Acc: 0.5318
 Site-White                    | Train Loss: 1.2540 | Train Acc: 0.5276
 Site-Black                    | Train Loss: 1.3398 | Train Acc: 0.5000
 Site-Black                    | Train Loss: 1.3772 | Train Acc: 0.4703
 Site-White                     (2) | Val  Loss: 1.5440 | Val  Acc: 0.5000
 Site-White                     (3) | Val  Loss: 1.4969 | Val  Acc: 0.6176
 Site-White                     (2) | Val  Loss: 1.1918 | Val  Acc: 0.6000
 Site-White                     (0) | Val  Loss: 1.3790 | Val  Acc: 0.5254
 Site-White                     (0) | Val  Loss: 1.2453 | Val  Acc: 0.5128
 Site-White                     (0) | Val  Loss: 1.1762 | Val  Acc: 0.5294
 Site-White                     (0) | Val  Loss: 1.1927 | Val  Acc: 0.5299
 Site-White                     (0) | Val  Loss: 1.2871 | Val  Acc: 0.5000
 Site-White                     (0) | Val  Loss: 1.2655 | Val  Acc: 0.4957
 Site-White                     (0) | Val  Loss: 1.3007 | Val  Acc: 0.5199
 Site-Black                     (1) | Val  Loss: 1.4602 | Val  Acc: 0.4854
 Site-Black                     (1) | Val  Loss: 1.3777 | Val  Acc: 0.4851
Average Valid Accuracy: 0.5251
Aggregated Acc | Val Acc: 0.5423
============ Train epoch 38 ============
cnt=[1, 8, 2, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
min_w=0.02465, quan_i=1.35, quan_c=1.28
minimize weight of clients:[0, ]
 Site-White                    | Train Loss: 1.3639 | Train Acc: 0.4872
 Site-White                    | Train Loss: 1.2302 | Train Acc: 0.5192
 Site-White                    | Train Loss: 1.2188 | Train Acc: 0.4559
 Site-White                    | Train Loss: 1.2748 | Train Acc: 0.4831
 Site-White                    | Train Loss: 1.3490 | Train Acc: 0.4359
 Site-White                    | Train Loss: 1.2881 | Train Acc: 0.5325
 Site-White                    | Train Loss: 1.1986 | Train Acc: 0.4925
 Site-White                    | Train Loss: 1.2485 | Train Acc: 0.5114
 Site-White                    | Train Loss: 1.1953 | Train Acc: 0.5462
 Site-White                    | Train Loss: 1.2079 | Train Acc: 0.5541
 Site-Black                    | Train Loss: 1.5290 | Train Acc: 0.4545
 Site-Black                    | Train Loss: 1.5418 | Train Acc: 0.4802
 Site-White                     (3) | Val  Loss: 1.4201 | Val  Acc: 0.3846
 Site-White                     (1) | Val  Loss: 1.3644 | Val  Acc: 0.5294
 Site-White                     (1) | Val  Loss: 1.2933 | Val  Acc: 0.5556
 Site-White                     (1) | Val  Loss: 1.3576 | Val  Acc: 0.4746
 Site-White                     (0) | Val  Loss: 1.1911 | Val  Acc: 0.5513
 Site-White                     (1) | Val  Loss: 1.1597 | Val  Acc: 0.5294
 Site-White                     (1) | Val  Loss: 1.1989 | Val  Acc: 0.5373
 Site-White                     (1) | Val  Loss: 1.2034 | Val  Acc: 0.5114
 Site-White                     (1) | Val  Loss: 1.2078 | Val  Acc: 0.4783
 Site-White                     (1) | Val  Loss: 1.2635 | Val  Acc: 0.5298
 Site-Black                     (2) | Val  Loss: 1.5626 | Val  Acc: 0.4757
 Site-Black                     (2) | Val  Loss: 1.5750 | Val  Acc: 0.4403
Average Valid Accuracy: 0.4998
Aggregated Acc | Val Acc: 0.4780
============ Train epoch 39 ============
cnt=[2, 4, 3, 3, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
min_w=0.03138, quan_i=1.34, quan_c=1.25
minimize weight of clients:[1, 2, 3, 8, 9, ]
 Site-White                    | Train Loss: 1.2768 | Train Acc: 0.5128
 Site-White                    | Train Loss: 1.2314 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.3944 | Train Acc: 0.5147
 Site-White                    | Train Loss: 1.2617 | Train Acc: 0.4944
 Site-White                    | Train Loss: 1.3647 | Train Acc: 0.4957
 Site-White                    | Train Loss: 1.3014 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.2033 | Train Acc: 0.5323
 Site-White                    | Train Loss: 1.2392 | Train Acc: 0.5152
 Site-White                    | Train Loss: 1.2556 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.2246 | Train Acc: 0.5386
 Site-Black                    | Train Loss: 1.4672 | Train Acc: 0.4481
 Site-Black                    | Train Loss: 1.3835 | Train Acc: 0.5495
 Site-White                     (1) | Val  Loss: 1.3743 | Val  Acc: 0.4615
 Site-White                     (2) | Val  Loss: 1.6150 | Val  Acc: 0.6471
 Site-White                     (2) | Val  Loss: 1.2618 | Val  Acc: 0.5111
 Site-White                     (2) | Val  Loss: 1.3794 | Val  Acc: 0.4407
 Site-White                     (3) | Val  Loss: 1.1844 | Val  Acc: 0.5769
 Site-White                     (1) | Val  Loss: 1.1044 | Val  Acc: 0.5490
 Site-White                     (1) | Val  Loss: 1.2050 | Val  Acc: 0.5597
 Site-White                     (1) | Val  Loss: 1.2204 | Val  Acc: 0.5057
 Site-White                     (3) | Val  Loss: 1.1894 | Val  Acc: 0.5174
 Site-White                     (3) | Val  Loss: 1.2829 | Val  Acc: 0.4967
 Site-Black                     (0) | Val  Loss: 1.4755 | Val  Acc: 0.5243
 Site-Black                     (0) | Val  Loss: 1.5213 | Val  Acc: 0.4701
Average Valid Accuracy: 0.5217
Aggregated Acc | Val Acc: 0.5199
============ Train epoch 40 ============
cnt=[2, 5, 4, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
min_w=0.02997, quan_i=1.35, quan_c=1.27
minimize weight of clients:[3, 5, 6, 9, ]
 Site-White                    | Train Loss: 1.4642 | Train Acc: 0.4615
 Site-White                    | Train Loss: 1.3072 | Train Acc: 0.5192
 Site-White                    | Train Loss: 1.3359 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.2303 | Train Acc: 0.5169
 Site-White                    | Train Loss: 1.3174 | Train Acc: 0.4957
 Site-White                    | Train Loss: 1.2954 | Train Acc: 0.5130
 Site-White                    | Train Loss: 1.2236 | Train Acc: 0.5672
 Site-White                    | Train Loss: 1.1805 | Train Acc: 0.5379
 Site-White                    | Train Loss: 1.2460 | Train Acc: 0.5289
 Site-White                    | Train Loss: 1.1714 | Train Acc: 0.5298
 Site-Black                    | Train Loss: 1.4134 | Train Acc: 0.4740
 Site-Black                    | Train Loss: 1.3862 | Train Acc: 0.5000
 Site-White                     (3) | Val  Loss: 1.2651 | Val  Acc: 0.5769
 Site-White                     (2) | Val  Loss: 1.7988 | Val  Acc: 0.5588
 Site-White                     (2) | Val  Loss: 1.3332 | Val  Acc: 0.4667
 Site-White                     (1) | Val  Loss: 1.2836 | Val  Acc: 0.5254
 Site-White                     (1) | Val  Loss: 1.1791 | Val  Acc: 0.5513
 Site-White                     (1) | Val  Loss: 1.1301 | Val  Acc: 0.5686
 Site-White                     (1) | Val  Loss: 1.1556 | Val  Acc: 0.5597
 Site-White                     (2) | Val  Loss: 1.2133 | Val  Acc: 0.5170
 Site-White                     (2) | Val  Loss: 1.1990 | Val  Acc: 0.5043
 Site-White                     (1) | Val  Loss: 1.2895 | Val  Acc: 0.5000
 Site-Black                     (0) | Val  Loss: 1.4531 | Val  Acc: 0.5243
 Site-Black                     (0) | Val  Loss: 1.5438 | Val  Acc: 0.4776
Average Valid Accuracy: 0.5276
Aggregated Acc | Val Acc: 0.5326
 Best site-White                    (3)  | Epoch:40 | Val Acc: 0.5769
 Best site-White                    (2)  | Epoch:40 | Val Acc: 0.5588
 Best site-White                    (2)  | Epoch:40 | Val Acc: 0.4667
 Best site-White                    (1)  | Epoch:40 | Val Acc: 0.5254
 Best site-White                    (1)  | Epoch:40 | Val Acc: 0.5513
 Best site-White                    (1)  | Epoch:40 | Val Acc: 0.5686
 Best site-White                    (1)  | Epoch:40 | Val Acc: 0.5597
 Best site-White                    (2)  | Epoch:40 | Val Acc: 0.5170
 Best site-White                    (2)  | Epoch:40 | Val Acc: 0.5043
 Best site-White                    (1)  | Epoch:40 | Val Acc: 0.5000
 Best site-Black                    (0)  | Epoch:40 | Val Acc: 0.5243
 Best site-Black                    (0)  | Epoch:40 | Val Acc: 0.4776
 Test site-White                    | Epoch:40 | Test Acc: 0.4492
 Test site-Black                    | Epoch:40 | Test Acc: 0.3500
Average Test Accuracy: 0.3996, domain std=0.0496, individual std=0.0370
Average Test Accuracy: 0.3996
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 41 ============
cnt=[5, 2, 1, 4, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
min_w=0.03943, quan_i=1.35, quan_c=1.24
minimize weight of clients:[4, 6, 8, 9, ]
 Site-White                    | Train Loss: 1.3404 | Train Acc: 0.4872
 Site-White                    | Train Loss: 1.3700 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.3104 | Train Acc: 0.4412
 Site-White                    | Train Loss: 1.2903 | Train Acc: 0.5169
 Site-White                    | Train Loss: 1.3146 | Train Acc: 0.4957
 Site-White                    | Train Loss: 1.3206 | Train Acc: 0.5195
 Site-White                    | Train Loss: 1.1872 | Train Acc: 0.4975
 Site-White                    | Train Loss: 1.1768 | Train Acc: 0.5644
 Site-White                    | Train Loss: 1.2309 | Train Acc: 0.5462
 Site-White                    | Train Loss: 1.1888 | Train Acc: 0.5188
 Site-Black                    | Train Loss: 1.4413 | Train Acc: 0.4156
 Site-Black                    | Train Loss: 1.4008 | Train Acc: 0.5149
 Site-White                     (2) | Val  Loss: 1.4802 | Val  Acc: 0.4615
 Site-White                     (3) | Val  Loss: 1.4980 | Val  Acc: 0.5588
 Site-White                     (0) | Val  Loss: 1.3019 | Val  Acc: 0.4667
 Site-White                     (3) | Val  Loss: 1.3223 | Val  Acc: 0.5085
 Site-White                     (0) | Val  Loss: 1.1863 | Val  Acc: 0.5641
 Site-White                     (3) | Val  Loss: 1.1240 | Val  Acc: 0.5882
 Site-White                     (0) | Val  Loss: 1.1528 | Val  Acc: 0.5597
 Site-White                     (3) | Val  Loss: 1.2410 | Val  Acc: 0.5398
 Site-White                     (0) | Val  Loss: 1.2132 | Val  Acc: 0.4957
 Site-White                     (0) | Val  Loss: 1.2985 | Val  Acc: 0.4901
 Site-Black                     (1) | Val  Loss: 1.3743 | Val  Acc: 0.5340
 Site-Black                     (1) | Val  Loss: 1.3622 | Val  Acc: 0.5149
Average Valid Accuracy: 0.5235
Aggregated Acc | Val Acc: 0.5125
 Test site-White                    | Epoch:40 | Test Acc: 0.4439
 Test site-Black                    | Epoch:40 | Test Acc: 0.3344
Average Test Accuracy: 0.3891, domain std=0.0547, individual std=0.0408
Average Test Accuracy: 0.3891
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 42 ============
cnt=[5, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
min_w=0.03061, quan_i=1.35, quan_c=1.26
minimize weight of clients:[2, 4, 5, 6, 7, 9, ]
 Site-White                    | Train Loss: 1.3381 | Train Acc: 0.4872
 Site-White                    | Train Loss: 1.2567 | Train Acc: 0.5192
 Site-White                    | Train Loss: 1.2750 | Train Acc: 0.4118
 Site-White                    | Train Loss: 1.2613 | Train Acc: 0.4494
 Site-White                    | Train Loss: 1.2982 | Train Acc: 0.4615
 Site-White                    | Train Loss: 1.3270 | Train Acc: 0.5195
 Site-White                    | Train Loss: 1.2230 | Train Acc: 0.4577
 Site-White                    | Train Loss: 1.1981 | Train Acc: 0.5341
 Site-White                    | Train Loss: 1.1943 | Train Acc: 0.5607
 Site-White                    | Train Loss: 1.1993 | Train Acc: 0.5188
 Site-Black                    | Train Loss: 1.4207 | Train Acc: 0.4935
 Site-Black                    | Train Loss: 1.4026 | Train Acc: 0.5099
 Site-White                     (0) | Val  Loss: 1.2768 | Val  Acc: 0.4615
 Site-White                     (2) | Val  Loss: 1.5807 | Val  Acc: 0.6765
 Site-White                     (0) | Val  Loss: 1.2646 | Val  Acc: 0.5111
 Site-White                     (2) | Val  Loss: 1.3221 | Val  Acc: 0.5424
 Site-White                     (3) | Val  Loss: 1.1994 | Val  Acc: 0.5641
 Site-White                     (0) | Val  Loss: 1.1078 | Val  Acc: 0.5196
 Site-White                     (0) | Val  Loss: 1.1473 | Val  Acc: 0.5896
 Site-White                     (0) | Val  Loss: 1.2419 | Val  Acc: 0.5284
 Site-White                     (2) | Val  Loss: 1.2014 | Val  Acc: 0.5130
 Site-White                     (3) | Val  Loss: 1.2909 | Val  Acc: 0.4801
 Site-Black                     (1) | Val  Loss: 1.4148 | Val  Acc: 0.5049
 Site-Black                     (1) | Val  Loss: 1.4180 | Val  Acc: 0.4776
Average Valid Accuracy: 0.5307
Aggregated Acc | Val Acc: 0.5282
 Best site-White                    (0)  | Epoch:42 | Val Acc: 0.4615
 Best site-White                    (2)  | Epoch:42 | Val Acc: 0.6765
 Best site-White                    (0)  | Epoch:42 | Val Acc: 0.5111
 Best site-White                    (2)  | Epoch:42 | Val Acc: 0.5424
 Best site-White                    (3)  | Epoch:42 | Val Acc: 0.5641
 Best site-White                    (0)  | Epoch:42 | Val Acc: 0.5196
 Best site-White                    (0)  | Epoch:42 | Val Acc: 0.5896
 Best site-White                    (0)  | Epoch:42 | Val Acc: 0.5284
 Best site-White                    (2)  | Epoch:42 | Val Acc: 0.5130
 Best site-White                    (3)  | Epoch:42 | Val Acc: 0.4801
 Best site-Black                    (1)  | Epoch:42 | Val Acc: 0.5049
 Best site-Black                    (1)  | Epoch:42 | Val Acc: 0.4776
 Test site-White                    | Epoch:42 | Test Acc: 0.4439
 Test site-Black                    | Epoch:42 | Test Acc: 0.3406
Average Test Accuracy: 0.3922, domain std=0.0516, individual std=0.0385
Average Test Accuracy: 0.3922
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 43 ============
cnt=[1, 8, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
min_w=0.03330, quan_i=1.32, quan_c=1.28
minimize weight of clients:[1, 2, 3, 6, 7, 8, 9, ]
 Site-White                    | Train Loss: 1.4879 | Train Acc: 0.5641
 Site-White                    | Train Loss: 1.3441 | Train Acc: 0.5385
 Site-White                    | Train Loss: 1.3381 | Train Acc: 0.4118
 Site-White                    | Train Loss: 1.2486 | Train Acc: 0.5056
 Site-White                    | Train Loss: 1.3369 | Train Acc: 0.5043
 Site-White                    | Train Loss: 1.2949 | Train Acc: 0.5260
 Site-White                    | Train Loss: 1.2485 | Train Acc: 0.4975
 Site-White                    | Train Loss: 1.2028 | Train Acc: 0.5644
 Site-White                    | Train Loss: 1.2253 | Train Acc: 0.5462
 Site-White                    | Train Loss: 1.2134 | Train Acc: 0.5497
 Site-Black                    | Train Loss: 1.3671 | Train Acc: 0.4935
 Site-Black                    | Train Loss: 1.3825 | Train Acc: 0.5099
 Site-White                     (0) | Val  Loss: 1.4351 | Val  Acc: 0.4615
 Site-White                     (1) | Val  Loss: 1.5235 | Val  Acc: 0.5882
 Site-White                     (1) | Val  Loss: 1.2126 | Val  Acc: 0.4222
 Site-White                     (1) | Val  Loss: 1.2774 | Val  Acc: 0.5424
 Site-White                     (3) | Val  Loss: 1.1955 | Val  Acc: 0.5385
 Site-White                     (1) | Val  Loss: 1.1430 | Val  Acc: 0.5784
 Site-White                     (1) | Val  Loss: 1.1614 | Val  Acc: 0.5746
 Site-White                     (1) | Val  Loss: 1.2410 | Val  Acc: 0.5000
 Site-White                     (1) | Val  Loss: 1.1999 | Val  Acc: 0.5435
 Site-White                     (1) | Val  Loss: 1.2704 | Val  Acc: 0.5265
 Site-Black                     (2) | Val  Loss: 1.3784 | Val  Acc: 0.5534
 Site-Black                     (2) | Val  Loss: 1.4685 | Val  Acc: 0.4701
Average Valid Accuracy: 0.5250
Aggregated Acc | Val Acc: 0.5116
 Test site-White                    | Epoch:42 | Test Acc: 0.4332
 Test site-Black                    | Epoch:42 | Test Acc: 0.3375
Average Test Accuracy: 0.3853, domain std=0.0478, individual std=0.0356
Average Test Accuracy: 0.3853
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 44 ============
cnt=[6, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
min_w=0.04062, quan_i=1.35, quan_c=1.26
minimize weight of clients:[5, 6, 7, 9, ]
 Site-White                    | Train Loss: 1.2512 | Train Acc: 0.5128
 Site-White                    | Train Loss: 1.2654 | Train Acc: 0.4615
 Site-White                    | Train Loss: 1.6036 | Train Acc: 0.3824
 Site-White                    | Train Loss: 1.3006 | Train Acc: 0.4831
 Site-White                    | Train Loss: 1.2831 | Train Acc: 0.4872
 Site-White                    | Train Loss: 1.3121 | Train Acc: 0.5195
 Site-White                    | Train Loss: 1.2534 | Train Acc: 0.5323
 Site-White                    | Train Loss: 1.2056 | Train Acc: 0.5265
 Site-White                    | Train Loss: 1.1892 | Train Acc: 0.5434
 Site-White                    | Train Loss: 1.1936 | Train Acc: 0.5254
 Site-Black                    | Train Loss: 1.3811 | Train Acc: 0.4870
 Site-Black                    | Train Loss: 1.3782 | Train Acc: 0.5149
 Site-White                     (3) | Val  Loss: 1.3484 | Val  Acc: 0.4615
 Site-White                     (0) | Val  Loss: 1.4338 | Val  Acc: 0.6765
 Site-White                     (0) | Val  Loss: 1.2473 | Val  Acc: 0.5333
 Site-White                     (2) | Val  Loss: 1.2740 | Val  Acc: 0.4746
 Site-White                     (2) | Val  Loss: 1.1441 | Val  Acc: 0.5897
 Site-White                     (0) | Val  Loss: 1.0957 | Val  Acc: 0.5588
 Site-White                     (0) | Val  Loss: 1.1933 | Val  Acc: 0.5224
 Site-White                     (0) | Val  Loss: 1.2179 | Val  Acc: 0.5398
 Site-White                     (2) | Val  Loss: 1.1982 | Val  Acc: 0.5043
 Site-White                     (0) | Val  Loss: 1.3126 | Val  Acc: 0.4570
 Site-Black                     (1) | Val  Loss: 1.4223 | Val  Acc: 0.4660
 Site-Black                     (1) | Val  Loss: 1.4563 | Val  Acc: 0.5075
Average Valid Accuracy: 0.5243
Aggregated Acc | Val Acc: 0.5048
 Test site-White                    | Epoch:43 | Test Acc: 0.4358
 Test site-Black                    | Epoch:43 | Test Acc: 0.3406
Average Test Accuracy: 0.3882, domain std=0.0476, individual std=0.0355
Average Test Accuracy: 0.3882
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 45 ============
cnt=[2, 2, 7, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
min_w=0.02921, quan_i=1.32, quan_c=1.26
minimize weight of clients:[4, 9, ]
 Site-White                    | Train Loss: 1.2055 | Train Acc: 0.4872
 Site-White                    | Train Loss: 1.3079 | Train Acc: 0.5192
 Site-White                    | Train Loss: 1.4896 | Train Acc: 0.4265
 Site-White                    | Train Loss: 1.2734 | Train Acc: 0.5281
 Site-White                    | Train Loss: 1.3069 | Train Acc: 0.4615
 Site-White                    | Train Loss: 1.2587 | Train Acc: 0.5260
 Site-White                    | Train Loss: 1.2241 | Train Acc: 0.4876
 Site-White                    | Train Loss: 1.1731 | Train Acc: 0.5265
 Site-White                    | Train Loss: 1.1620 | Train Acc: 0.5723
 Site-White                    | Train Loss: 1.2263 | Train Acc: 0.5276
 Site-Black                    | Train Loss: 1.4050 | Train Acc: 0.5065
 Site-Black                    | Train Loss: 1.3659 | Train Acc: 0.5248
 Site-White                     (3) | Val  Loss: 1.3649 | Val  Acc: 0.5769
 Site-White                     (2) | Val  Loss: 1.2745 | Val  Acc: 0.6765
 Site-White                     (2) | Val  Loss: 1.2705 | Val  Acc: 0.4444
 Site-White                     (2) | Val  Loss: 1.2833 | Val  Acc: 0.5593
 Site-White                     (0) | Val  Loss: 1.0966 | Val  Acc: 0.5769
 Site-White                     (2) | Val  Loss: 1.1216 | Val  Acc: 0.4804
 Site-White                     (2) | Val  Loss: 1.1633 | Val  Acc: 0.5597
 Site-White                     (2) | Val  Loss: 1.2367 | Val  Acc: 0.5398
 Site-White                     (2) | Val  Loss: 1.1978 | Val  Acc: 0.4870
 Site-White                     (0) | Val  Loss: 1.2486 | Val  Acc: 0.4934
 Site-Black                     (1) | Val  Loss: 1.3678 | Val  Acc: 0.5146
 Site-Black                     (1) | Val  Loss: 1.5389 | Val  Acc: 0.4776
Average Valid Accuracy: 0.5322
Aggregated Acc | Val Acc: 0.5359
 Best site-White                    (3)  | Epoch:45 | Val Acc: 0.5769
 Best site-White                    (2)  | Epoch:45 | Val Acc: 0.6765
 Best site-White                    (2)  | Epoch:45 | Val Acc: 0.4444
 Best site-White                    (2)  | Epoch:45 | Val Acc: 0.5593
 Best site-White                    (0)  | Epoch:45 | Val Acc: 0.5769
 Best site-White                    (2)  | Epoch:45 | Val Acc: 0.4804
 Best site-White                    (2)  | Epoch:45 | Val Acc: 0.5597
 Best site-White                    (2)  | Epoch:45 | Val Acc: 0.5398
 Best site-White                    (2)  | Epoch:45 | Val Acc: 0.4870
 Best site-White                    (0)  | Epoch:45 | Val Acc: 0.4934
 Best site-Black                    (1)  | Epoch:45 | Val Acc: 0.5146
 Best site-Black                    (1)  | Epoch:45 | Val Acc: 0.4776
 Test site-White                    | Epoch:45 | Test Acc: 0.4385
 Test site-Black                    | Epoch:45 | Test Acc: 0.3406
Average Test Accuracy: 0.3896, domain std=0.0489, individual std=0.0365
Average Test Accuracy: 0.3896
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 46 ============
cnt=[3, 2, 1, 6, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
min_w=0.02712, quan_i=1.32, quan_c=1.24
minimize weight of clients:[0, 5, 7, ]
 Site-White                    | Train Loss: 1.5681 | Train Acc: 0.4615
 Site-White                    | Train Loss: 1.3348 | Train Acc: 0.4423
 Site-White                    | Train Loss: 1.2537 | Train Acc: 0.4265
 Site-White                    | Train Loss: 1.2422 | Train Acc: 0.5393
 Site-White                    | Train Loss: 1.3288 | Train Acc: 0.4786
 Site-White                    | Train Loss: 1.2676 | Train Acc: 0.5065
 Site-White                    | Train Loss: 1.1876 | Train Acc: 0.4975
 Site-White                    | Train Loss: 1.2153 | Train Acc: 0.5076
 Site-White                    | Train Loss: 1.1548 | Train Acc: 0.5665
 Site-White                    | Train Loss: 1.1914 | Train Acc: 0.5364
 Site-Black                    | Train Loss: 1.3987 | Train Acc: 0.5195
 Site-Black                    | Train Loss: 1.3404 | Train Acc: 0.5297
 Site-White                     (2) | Val  Loss: 1.3367 | Val  Acc: 0.5385
 Site-White                     (0) | Val  Loss: 1.5260 | Val  Acc: 0.6176
 Site-White                     (3) | Val  Loss: 1.2911 | Val  Acc: 0.5111
 Site-White                     (3) | Val  Loss: 1.2251 | Val  Acc: 0.5593
 Site-White                     (3) | Val  Loss: 1.1321 | Val  Acc: 0.5897
 Site-White                     (0) | Val  Loss: 1.1176 | Val  Acc: 0.5490
 Site-White                     (3) | Val  Loss: 1.1411 | Val  Acc: 0.5672
 Site-White                     (0) | Val  Loss: 1.2433 | Val  Acc: 0.4943
 Site-White                     (3) | Val  Loss: 1.2053 | Val  Acc: 0.5217
 Site-White                     (3) | Val  Loss: 1.2717 | Val  Acc: 0.5166
 Site-Black                     (1) | Val  Loss: 1.4575 | Val  Acc: 0.4951
 Site-Black                     (1) | Val  Loss: 1.4000 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5384
Aggregated Acc | Val Acc: 0.5335
 Best site-White                    (2)  | Epoch:46 | Val Acc: 0.5385
 Best site-White                    (0)  | Epoch:46 | Val Acc: 0.6176
 Best site-White                    (3)  | Epoch:46 | Val Acc: 0.5111
 Best site-White                    (3)  | Epoch:46 | Val Acc: 0.5593
 Best site-White                    (3)  | Epoch:46 | Val Acc: 0.5897
 Best site-White                    (0)  | Epoch:46 | Val Acc: 0.5490
 Best site-White                    (3)  | Epoch:46 | Val Acc: 0.5672
 Best site-White                    (0)  | Epoch:46 | Val Acc: 0.4943
 Best site-White                    (3)  | Epoch:46 | Val Acc: 0.5217
 Best site-White                    (3)  | Epoch:46 | Val Acc: 0.5166
 Best site-Black                    (1)  | Epoch:46 | Val Acc: 0.4951
 Best site-Black                    (1)  | Epoch:46 | Val Acc: 0.5000
 Test site-White                    | Epoch:46 | Test Acc: 0.4251
 Test site-Black                    | Epoch:46 | Test Acc: 0.3187
Average Test Accuracy: 0.3719, domain std=0.0532, individual std=0.0396
Average Test Accuracy: 0.3719
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 47 ============
cnt=[2, 2, 7, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
min_w=0.04231, quan_i=1.35, quan_c=1.29
minimize weight of clients:[2, 4, 5, 6, 7, 8, 9, ]
 Site-White                    | Train Loss: 1.2293 | Train Acc: 0.5897
 Site-White                    | Train Loss: 1.2873 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.4305 | Train Acc: 0.4706
 Site-White                    | Train Loss: 1.2264 | Train Acc: 0.5281
 Site-White                    | Train Loss: 1.2767 | Train Acc: 0.4872
 Site-White                    | Train Loss: 1.3161 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.1988 | Train Acc: 0.5224
 Site-White                    | Train Loss: 1.2618 | Train Acc: 0.5038
 Site-White                    | Train Loss: 1.1661 | Train Acc: 0.5462
 Site-White                    | Train Loss: 1.1904 | Train Acc: 0.5497
 Site-Black                    | Train Loss: 1.2971 | Train Acc: 0.5325
 Site-Black                    | Train Loss: 1.3061 | Train Acc: 0.5396
 Site-White                     (3) | Val  Loss: 1.3910 | Val  Acc: 0.4615
 Site-White                     (0) | Val  Loss: 1.5061 | Val  Acc: 0.5588
 Site-White                     (2) | Val  Loss: 1.2796 | Val  Acc: 0.5111
 Site-White                     (0) | Val  Loss: 1.2689 | Val  Acc: 0.5593
 Site-White                     (2) | Val  Loss: 1.1427 | Val  Acc: 0.5385
 Site-White                     (2) | Val  Loss: 1.0845 | Val  Acc: 0.5588
 Site-White                     (2) | Val  Loss: 1.1824 | Val  Acc: 0.5821
 Site-White                     (2) | Val  Loss: 1.2493 | Val  Acc: 0.5114
 Site-White                     (2) | Val  Loss: 1.1921 | Val  Acc: 0.5217
 Site-White                     (2) | Val  Loss: 1.2806 | Val  Acc: 0.4967
 Site-Black                     (1) | Val  Loss: 1.3352 | Val  Acc: 0.5340
 Site-Black                     (1) | Val  Loss: 1.3447 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5278
Aggregated Acc | Val Acc: 0.5173
 Test site-White                    | Epoch:46 | Test Acc: 0.4225
 Test site-Black                    | Epoch:46 | Test Acc: 0.3375
Average Test Accuracy: 0.3800, domain std=0.0425, individual std=0.0317
Average Test Accuracy: 0.3800
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 48 ============
cnt=[4, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
min_w=0.02779, quan_i=1.30, quan_c=1.24
minimize weight of clients:[0, 3, 8, ]
 Site-White                    | Train Loss: 1.1579 | Train Acc: 0.4872
 Site-White                    | Train Loss: 1.2892 | Train Acc: 0.4615
 Site-White                    | Train Loss: 1.4811 | Train Acc: 0.4412
 Site-White                    | Train Loss: 1.2067 | Train Acc: 0.5169
 Site-White                    | Train Loss: 1.2804 | Train Acc: 0.5299
 Site-White                    | Train Loss: 1.2550 | Train Acc: 0.5390
 Site-White                    | Train Loss: 1.2060 | Train Acc: 0.5124
 Site-White                    | Train Loss: 1.1649 | Train Acc: 0.5606
 Site-White                    | Train Loss: 1.1986 | Train Acc: 0.5462
 Site-White                    | Train Loss: 1.2012 | Train Acc: 0.5453
 Site-Black                    | Train Loss: 1.4033 | Train Acc: 0.4545
 Site-Black                    | Train Loss: 1.3923 | Train Acc: 0.5050
 Site-White                     (3) | Val  Loss: 1.3892 | Val  Acc: 0.3846
 Site-White                     (0) | Val  Loss: 1.5180 | Val  Acc: 0.6176
 Site-White                     (0) | Val  Loss: 1.2181 | Val  Acc: 0.5111
 Site-White                     (0) | Val  Loss: 1.2946 | Val  Acc: 0.5593
 Site-White                     (1) | Val  Loss: 1.1391 | Val  Acc: 0.5000
 Site-White                     (1) | Val  Loss: 1.0956 | Val  Acc: 0.6176
 Site-White                     (1) | Val  Loss: 1.1237 | Val  Acc: 0.5896
 Site-White                     (1) | Val  Loss: 1.2338 | Val  Acc: 0.5227
 Site-White                     (0) | Val  Loss: 1.1923 | Val  Acc: 0.5174
 Site-White                     (1) | Val  Loss: 1.2460 | Val  Acc: 0.5199
 Site-Black                     (2) | Val  Loss: 1.3959 | Val  Acc: 0.5631
 Site-Black                     (2) | Val  Loss: 1.3800 | Val  Acc: 0.4851
Average Valid Accuracy: 0.5323
Aggregated Acc | Val Acc: 0.5025
 Test site-White                    | Epoch:47 | Test Acc: 0.4412
 Test site-Black                    | Epoch:47 | Test Acc: 0.3250
Average Test Accuracy: 0.3831, domain std=0.0581, individual std=0.0433
Average Test Accuracy: 0.3831
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
============ Train epoch 49 ============
cnt=[4, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
min_w=0.02465, quan_i=1.29, quan_c=1.25
minimize weight of clients:[0, 3, 8, 9, ]
 Site-White                    | Train Loss: 1.1886 | Train Acc: 0.4872
 Site-White                    | Train Loss: 1.2216 | Train Acc: 0.5769
 Site-White                    | Train Loss: 1.1509 | Train Acc: 0.4559
 Site-White                    | Train Loss: 1.2523 | Train Acc: 0.5169
 Site-White                    | Train Loss: 1.3251 | Train Acc: 0.4615
 Site-White                    | Train Loss: 1.2628 | Train Acc: 0.5455
 Site-White                    | Train Loss: 1.1729 | Train Acc: 0.5473
 Site-White                    | Train Loss: 1.1833 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.2149 | Train Acc: 0.5780
 Site-White                    | Train Loss: 1.1600 | Train Acc: 0.5585
 Site-Black                    | Train Loss: 1.3756 | Train Acc: 0.4675
 Site-Black                    | Train Loss: 1.3653 | Train Acc: 0.5099
 Site-White                     (2) | Val  Loss: 1.3952 | Val  Acc: 0.4615
 Site-White                     (0) | Val  Loss: 1.4189 | Val  Acc: 0.6176
 Site-White                     (3) | Val  Loss: 1.2829 | Val  Acc: 0.5111
 Site-White                     (0) | Val  Loss: 1.3008 | Val  Acc: 0.5254
 Site-White                     (3) | Val  Loss: 1.1532 | Val  Acc: 0.5769
 Site-White                     (3) | Val  Loss: 1.1414 | Val  Acc: 0.5196
 Site-White                     (3) | Val  Loss: 1.1128 | Val  Acc: 0.5672
 Site-White                     (3) | Val  Loss: 1.1782 | Val  Acc: 0.5398
 Site-White                     (0) | Val  Loss: 1.1708 | Val  Acc: 0.5304
 Site-White                     (0) | Val  Loss: 1.2415 | Val  Acc: 0.5166
 Site-Black                     (1) | Val  Loss: 1.3318 | Val  Acc: 0.5049
 Site-Black                     (1) | Val  Loss: 1.3274 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5309
Aggregated Acc | Val Acc: 0.5136
 Test site-White                    | Epoch:48 | Test Acc: 0.4385
 Test site-Black                    | Epoch:48 | Test Acc: 0.3344
Average Test Accuracy: 0.3864, domain std=0.0521, individual std=0.0388
Average Test Accuracy: 0.3864
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1...
 Test site-White                    | Epoch:49 | Test Acc: 0.4385
 Test site-Black                    | Epoch:49 | Test Acc: 0.3344
Average Test Accuracy: 0.3864, domain std=0.0521, individual std=0.0388
===2023-05-31 03:11:15===
===2023-05-31 03:11:17===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0.7
    std_rw: False
    gender_label: False
    binary_race: True
data_number=[39,52,68,89,117,154,201,264,346,453,154,202,]
client_nums=[10,2,]
len_dataset=[2980,596,]
label set of clients: [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 4
Loading snapshots...
 Test site-White                    | Epoch:49 | Test Acc: 0.4385
 Test site-Black                    | Epoch:49 | Test Acc: 0.3344
Average Test Accuracy: 0.3864, domain std=0.0521, individual std=0.0388
===2023-06-01 17:11:25===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 51
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0.7
    std_rw: False
    gender_label: False
    binary_race: True
    save_iter: -1
data_number=[39,52,68,89,117,154,201,264,346,453,154,202,]
client_nums=[10,2,]
len_dataset=[2980,596,]
label set of clients: [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 50 ============
===2023-06-01 17:49:11===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 51
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0.7
    std_rw: False
    gender_label: False
    binary_race: True
    save_iter: -1
data_number=[39,52,68,89,117,154,201,264,346,453,154,202,]
client_nums=[10,2,]
len_dataset=[2980,596,]
label set of clients: [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 50 ============
cnt=[7, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5023, powerC: 0.4977
min_w=0.01823, quan_i=1.00, quan_c=1.00
minimize weight of clients:[]
 Site-White_0                  | Train Loss: 1.4000 | Train Acc: 0.5641
 Site-White_1                  | Train Loss: 1.3050 | Train Acc: 0.5192
 Site-White_2                  | Train Loss: 1.3635 | Train Acc: 0.4853
 Site-White_3                  | Train Loss: 1.2234 | Train Acc: 0.5393
 Site-White_4                  | Train Loss: 1.2411 | Train Acc: 0.5043
 Site-White_5                  | Train Loss: 1.2892 | Train Acc: 0.5130
 Site-White_6                  | Train Loss: 1.2018 | Train Acc: 0.5124
 Site-White_7                  | Train Loss: 1.1950 | Train Acc: 0.5644
 Site-White_8                  | Train Loss: 1.1863 | Train Acc: 0.5376
 Site-White_9                  | Train Loss: 1.1911 | Train Acc: 0.5386
 Site-Black_0                  | Train Loss: 1.4495 | Train Acc: 0.4416
 Site-Black_1                  | Train Loss: 1.3691 | Train Acc: 0.5297
 Site-White_0                   (0) | Val  Loss: 1.2826 | Val  Acc: 0.5385
 Site-White_1                   (2) | Val  Loss: 1.5594 | Val  Acc: 0.6176
 Site-White_2                   (0) | Val  Loss: 1.2886 | Val  Acc: 0.4667
 Site-White_3                   (2) | Val  Loss: 1.2891 | Val  Acc: 0.5254
 Site-White_4                   (0) | Val  Loss: 1.1516 | Val  Acc: 0.5513
 Site-White_5                   (0) | Val  Loss: 1.1577 | Val  Acc: 0.5196
 Site-White_6                   (0) | Val  Loss: 1.1341 | Val  Acc: 0.6269
 Site-White_7                   (0) | Val  Loss: 1.1983 | Val  Acc: 0.5170
 Site-White_8                   (2) | Val  Loss: 1.1385 | Val  Acc: 0.5522
 Site-White_9                   (0) | Val  Loss: 1.2530 | Val  Acc: 0.4801
 Site-Black_0                   (3) | Val  Loss: 1.4304 | Val  Acc: 0.5437
 Site-Black_1                   (1) | Val  Loss: 1.3710 | Val  Acc: 0.4552
Average Valid Accuracy: 0.5329
 Test site-White_0                   (0)| Epoch:49 | Test Acc: 0.4375
 Test site-White_1                   (2)| Epoch:49 | Test Acc: 0.4688
 Test site-White_2                   (0)| Epoch:49 | Test Acc: 0.3750
 Test site-White_3                   (2)| Epoch:49 | Test Acc: 0.5000
 Test site-White_4                   (0)| Epoch:49 | Test Acc: 0.5312
 Test site-White_5                   (0)| Epoch:49 | Test Acc: 0.3750
 Test site-White_6                   (0)| Epoch:49 | Test Acc: 0.3125
 Test site-White_7                   (0)| Epoch:49 | Test Acc: 0.3438
 Test site-White_8                   (2)| Epoch:49 | Test Acc: 0.5000
 Test site-White_9                   (0)| Epoch:49 | Test Acc: 0.4062
 Test site-Black_0                   (3)| Epoch:49 | Test Acc: 0.3438
 Test site-Black_1                   (1)| Epoch:49 | Test Acc: 0.2500
Average Test Accuracy: 0.3609, domain std=0.0641, cluster std=0.0868, individual std=0.0821, 
Average Test Accuracy: 0.3609
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.31_1_random_dis_cluster_4_binary_race/ccop_q=1_gmap...
===2023-06-01 17:52:13===
===2023-06-02 00:33:24===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: True
    save_iter: -1
data_number=[39,52,68,89,117,154,201,264,346,453,154,202,]
client_nums=[10,2,]
len_dataset=[2980,596,]
label set of clients: [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 4
Loading snapshots...
 Test site-White_0                   (0)| Epoch:49 | Test Acc: 0.5000
 Test site-White_1                   (2)| Epoch:49 | Test Acc: 0.4688
 Test site-White_2                   (0)| Epoch:49 | Test Acc: 0.3750
 Test site-White_3                   (2)| Epoch:49 | Test Acc: 0.4688
 Test site-White_4                   (0)| Epoch:49 | Test Acc: 0.4062
 Test site-White_5                   (0)| Epoch:49 | Test Acc: 0.4375
 Test site-White_6                   (0)| Epoch:49 | Test Acc: 0.3750
 Test site-White_7                   (0)| Epoch:49 | Test Acc: 0.3750
 Test site-White_8                   (2)| Epoch:49 | Test Acc: 0.5000
 Test site-White_9                   (0)| Epoch:49 | Test Acc: 0.4062
 Test site-Black_0                   (3)| Epoch:49 | Test Acc: 0.3125
 Test site-Black_1                   (1)| Epoch:49 | Test Acc: 0.3125
White: 0.431, Black: 0.312, 
Average Test Accuracy: 0.3719, domain std=0.0594, cluster std=0.0705, individual std=0.0623, 
