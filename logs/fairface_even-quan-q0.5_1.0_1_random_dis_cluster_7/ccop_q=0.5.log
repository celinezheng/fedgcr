===2023-06-07 03:58:53===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0.0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[139,417,139,417,139,417,139,417,139,417,139,417,139,417,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1856,1856,1856,1856,1856,1856,1856,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 2, 1, 6, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-White                    | Train Loss: 1.8554 | Train Acc: 0.3453
 Site-White                    | Train Loss: 1.7762 | Train Acc: 0.3549
 Site-Latino_Hispanic          | Train Loss: 1.9418 | Train Acc: 0.2734
 Site-Latino_Hispanic          | Train Loss: 1.8547 | Train Acc: 0.2878
 Site-Black                    | Train Loss: 1.9805 | Train Acc: 0.2590
 Site-Black                    | Train Loss: 1.8946 | Train Acc: 0.2638
 Site-East_Asian               | Train Loss: 1.7597 | Train Acc: 0.3669
 Site-East_Asian               | Train Loss: 1.7527 | Train Acc: 0.3861
 Site-Indian                   | Train Loss: 2.0860 | Train Acc: 0.2302
 Site-Indian                   | Train Loss: 2.1309 | Train Acc: 0.2326
 Site-Southeast_Asian          | Train Loss: 2.0066 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 2.0797 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.9361 | Train Acc: 0.2662
 Site-Middle_Eastern           | Train Loss: 1.9315 | Train Acc: 0.2470
 Site-White                     (3) | Val  Loss: 1.8923 | Val  Acc: 0.2935
 Site-White                     (5) | Val  Loss: 1.8190 | Val  Acc: 0.3525
 Site-Latino_Hispanic           (2) | Val  Loss: 1.9403 | Val  Acc: 0.3370
 Site-Latino_Hispanic           (3) | Val  Loss: 1.9059 | Val  Acc: 0.2806
 Site-Black                     (6) | Val  Loss: 1.8978 | Val  Acc: 0.3043
 Site-Black                     (0) | Val  Loss: 1.9447 | Val  Acc: 0.2554
 Site-East_Asian                (3) | Val  Loss: 1.7008 | Val  Acc: 0.4565
 Site-East_Asian                (3) | Val  Loss: 1.7966 | Val  Acc: 0.3813
 Site-Indian                    (4) | Val  Loss: 2.0572 | Val  Acc: 0.2283
 Site-Indian                    (4) | Val  Loss: 2.0392 | Val  Acc: 0.2410
 Site-Southeast_Asian           (3) | Val  Loss: 1.9884 | Val  Acc: 0.3152
 Site-Southeast_Asian           (3) | Val  Loss: 1.9858 | Val  Acc: 0.3129
 Site-Middle_Eastern            (1) | Val  Loss: 1.9261 | Val  Acc: 0.3043
 Site-Middle_Eastern            (1) | Val  Loss: 1.9600 | Val  Acc: 0.2518
Average Valid Accuracy: 0.3082
 Best site-White                    (3)  | Epoch:0 | Val Acc: 0.2935
 Best site-White                    (5)  | Epoch:0 | Val Acc: 0.3525
 Best site-Latino_Hispanic          (2)  | Epoch:0 | Val Acc: 0.3370
 Best site-Latino_Hispanic          (3)  | Epoch:0 | Val Acc: 0.2806
 Best site-Black                    (6)  | Epoch:0 | Val Acc: 0.3043
 Best site-Black                    (0)  | Epoch:0 | Val Acc: 0.2554
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.4565
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3813
 Best site-Indian                   (4)  | Epoch:0 | Val Acc: 0.2283
 Best site-Indian                   (4)  | Epoch:0 | Val Acc: 0.2410
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.3152
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.3129
 Best site-Middle_Eastern           (1)  | Epoch:0 | Val Acc: 0.3043
 Best site-Middle_Eastern           (1)  | Epoch:0 | Val Acc: 0.2518
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 1 ============
cnt=[1, 4, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-White                    | Train Loss: 1.7852 | Train Acc: 0.3381
 Site-White                    | Train Loss: 1.7198 | Train Acc: 0.3453
 Site-Latino_Hispanic          | Train Loss: 1.8686 | Train Acc: 0.2662
 Site-Latino_Hispanic          | Train Loss: 1.8377 | Train Acc: 0.2782
 Site-Black                    | Train Loss: 1.9620 | Train Acc: 0.1942
 Site-Black                    | Train Loss: 1.9229 | Train Acc: 0.2542
 Site-East_Asian               | Train Loss: 1.7373 | Train Acc: 0.3741
 Site-East_Asian               | Train Loss: 1.7488 | Train Acc: 0.3909
 Site-Indian                   | Train Loss: 1.9235 | Train Acc: 0.2590
 Site-Indian                   | Train Loss: 1.9330 | Train Acc: 0.2470
 Site-Southeast_Asian          | Train Loss: 1.9031 | Train Acc: 0.3309
 Site-Southeast_Asian          | Train Loss: 1.8759 | Train Acc: 0.3141
 Site-Middle_Eastern           | Train Loss: 1.8802 | Train Acc: 0.2662
 Site-Middle_Eastern           | Train Loss: 1.9120 | Train Acc: 0.2806
 Site-White                     (0) | Val  Loss: 1.8577 | Val  Acc: 0.2935
 Site-White                     (6) | Val  Loss: 1.7797 | Val  Acc: 0.3453
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8623 | Val  Acc: 0.3261
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8525 | Val  Acc: 0.2734
 Site-Black                     (3) | Val  Loss: 1.8522 | Val  Acc: 0.3261
 Site-Black                     (3) | Val  Loss: 1.8975 | Val  Acc: 0.2878
 Site-East_Asian                (1) | Val  Loss: 1.6667 | Val  Acc: 0.4239
 Site-East_Asian                (1) | Val  Loss: 1.7389 | Val  Acc: 0.3993
 Site-Indian                    (4) | Val  Loss: 1.9625 | Val  Acc: 0.2283
 Site-Indian                    (4) | Val  Loss: 1.9668 | Val  Acc: 0.2338
 Site-Southeast_Asian           (1) | Val  Loss: 1.8913 | Val  Acc: 0.3152
 Site-Southeast_Asian           (1) | Val  Loss: 1.9068 | Val  Acc: 0.3094
 Site-Middle_Eastern            (2) | Val  Loss: 1.8588 | Val  Acc: 0.2500
 Site-Middle_Eastern            (2) | Val  Loss: 1.8864 | Val  Acc: 0.2698
Average Valid Accuracy: 0.3058
============ Train epoch 2 ============
cnt=[2, 2, 3, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-White                    | Train Loss: 1.7697 | Train Acc: 0.3885
 Site-White                    | Train Loss: 1.7550 | Train Acc: 0.3933
 Site-Latino_Hispanic          | Train Loss: 1.8285 | Train Acc: 0.3022
 Site-Latino_Hispanic          | Train Loss: 1.8446 | Train Acc: 0.3309
 Site-Black                    | Train Loss: 1.9013 | Train Acc: 0.2230
 Site-Black                    | Train Loss: 1.8480 | Train Acc: 0.2806
 Site-East_Asian               | Train Loss: 1.6659 | Train Acc: 0.3885
 Site-East_Asian               | Train Loss: 1.6610 | Train Acc: 0.4149
 Site-Indian                   | Train Loss: 1.8271 | Train Acc: 0.3237
 Site-Indian                   | Train Loss: 1.8880 | Train Acc: 0.2878
 Site-Southeast_Asian          | Train Loss: 1.8283 | Train Acc: 0.3381
 Site-Southeast_Asian          | Train Loss: 1.7869 | Train Acc: 0.3405
 Site-Middle_Eastern           | Train Loss: 1.7796 | Train Acc: 0.3741
 Site-Middle_Eastern           | Train Loss: 1.7631 | Train Acc: 0.3597
 Site-White                     (0) | Val  Loss: 1.7326 | Val  Acc: 0.3478
 Site-White                     (0) | Val  Loss: 1.6946 | Val  Acc: 0.3705
 Site-Latino_Hispanic           (4) | Val  Loss: 1.8180 | Val  Acc: 0.3370
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7852 | Val  Acc: 0.3273
 Site-Black                     (6) | Val  Loss: 1.7677 | Val  Acc: 0.4022
 Site-Black                     (2) | Val  Loss: 1.8295 | Val  Acc: 0.3309
 Site-East_Asian                (5) | Val  Loss: 1.6066 | Val  Acc: 0.4783
 Site-East_Asian                (5) | Val  Loss: 1.6600 | Val  Acc: 0.4065
 Site-Indian                    (2) | Val  Loss: 1.8806 | Val  Acc: 0.2717
 Site-Indian                    (2) | Val  Loss: 1.8490 | Val  Acc: 0.2518
 Site-Southeast_Asian           (1) | Val  Loss: 1.7989 | Val  Acc: 0.3043
 Site-Southeast_Asian           (1) | Val  Loss: 1.7787 | Val  Acc: 0.3741
 Site-Middle_Eastern            (3) | Val  Loss: 1.7552 | Val  Acc: 0.3696
 Site-Middle_Eastern            (3) | Val  Loss: 1.7779 | Val  Acc: 0.3597
Average Valid Accuracy: 0.3523
 Best site-White                    (0)  | Epoch:2 | Val Acc: 0.3478
 Best site-White                    (0)  | Epoch:2 | Val Acc: 0.3705
 Best site-Latino_Hispanic          (4)  | Epoch:2 | Val Acc: 0.3370
 Best site-Latino_Hispanic          (4)  | Epoch:2 | Val Acc: 0.3273
 Best site-Black                    (6)  | Epoch:2 | Val Acc: 0.4022
 Best site-Black                    (2)  | Epoch:2 | Val Acc: 0.3309
 Best site-East_Asian               (5)  | Epoch:2 | Val Acc: 0.4783
 Best site-East_Asian               (5)  | Epoch:2 | Val Acc: 0.4065
 Best site-Indian                   (2)  | Epoch:2 | Val Acc: 0.2717
 Best site-Indian                   (2)  | Epoch:2 | Val Acc: 0.2518
 Best site-Southeast_Asian          (1)  | Epoch:2 | Val Acc: 0.3043
 Best site-Southeast_Asian          (1)  | Epoch:2 | Val Acc: 0.3741
 Best site-Middle_Eastern           (3)  | Epoch:2 | Val Acc: 0.3696
 Best site-Middle_Eastern           (3)  | Epoch:2 | Val Acc: 0.3597
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 3 ============
cnt=[4, 2, 1, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-White                    | Train Loss: 1.6560 | Train Acc: 0.4101
 Site-White                    | Train Loss: 1.6651 | Train Acc: 0.3741
 Site-Latino_Hispanic          | Train Loss: 1.7594 | Train Acc: 0.3237
 Site-Latino_Hispanic          | Train Loss: 1.6864 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.8328 | Train Acc: 0.2734
 Site-Black                    | Train Loss: 1.8586 | Train Acc: 0.3070
 Site-East_Asian               | Train Loss: 1.5483 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.5280 | Train Acc: 0.4484
 Site-Indian                   | Train Loss: 1.7035 | Train Acc: 0.3741
 Site-Indian                   | Train Loss: 1.7036 | Train Acc: 0.3333
 Site-Southeast_Asian          | Train Loss: 1.6889 | Train Acc: 0.3741
 Site-Southeast_Asian          | Train Loss: 1.7097 | Train Acc: 0.3957
 Site-Middle_Eastern           | Train Loss: 1.7226 | Train Acc: 0.3525
 Site-Middle_Eastern           | Train Loss: 1.6742 | Train Acc: 0.4101
 Site-White                     (4) | Val  Loss: 1.6458 | Val  Acc: 0.3804
 Site-White                     (5) | Val  Loss: 1.6416 | Val  Acc: 0.3813
 Site-Latino_Hispanic           (3) | Val  Loss: 1.7521 | Val  Acc: 0.3261
 Site-Latino_Hispanic           (0) | Val  Loss: 1.7252 | Val  Acc: 0.3525
 Site-Black                     (6) | Val  Loss: 1.7250 | Val  Acc: 0.3696
 Site-Black                     (2) | Val  Loss: 1.8019 | Val  Acc: 0.3201
 Site-East_Asian                (3) | Val  Loss: 1.5135 | Val  Acc: 0.4565
 Site-East_Asian                (3) | Val  Loss: 1.5719 | Val  Acc: 0.4532
 Site-Indian                    (0) | Val  Loss: 1.7957 | Val  Acc: 0.2609
 Site-Indian                    (0) | Val  Loss: 1.7412 | Val  Acc: 0.3237
 Site-Southeast_Asian           (3) | Val  Loss: 1.6791 | Val  Acc: 0.4130
 Site-Southeast_Asian           (0) | Val  Loss: 1.6760 | Val  Acc: 0.3957
 Site-Middle_Eastern            (1) | Val  Loss: 1.6607 | Val  Acc: 0.4239
 Site-Middle_Eastern            (1) | Val  Loss: 1.6731 | Val  Acc: 0.3957
Average Valid Accuracy: 0.3752
 Best site-White                    (4)  | Epoch:3 | Val Acc: 0.3804
 Best site-White                    (5)  | Epoch:3 | Val Acc: 0.3813
 Best site-Latino_Hispanic          (3)  | Epoch:3 | Val Acc: 0.3261
 Best site-Latino_Hispanic          (0)  | Epoch:3 | Val Acc: 0.3525
 Best site-Black                    (6)  | Epoch:3 | Val Acc: 0.3696
 Best site-Black                    (2)  | Epoch:3 | Val Acc: 0.3201
 Best site-East_Asian               (3)  | Epoch:3 | Val Acc: 0.4565
 Best site-East_Asian               (3)  | Epoch:3 | Val Acc: 0.4532
 Best site-Indian                   (0)  | Epoch:3 | Val Acc: 0.2609
 Best site-Indian                   (0)  | Epoch:3 | Val Acc: 0.3237
 Best site-Southeast_Asian          (3)  | Epoch:3 | Val Acc: 0.4130
 Best site-Southeast_Asian          (0)  | Epoch:3 | Val Acc: 0.3957
 Best site-Middle_Eastern           (1)  | Epoch:3 | Val Acc: 0.4239
 Best site-Middle_Eastern           (1)  | Epoch:3 | Val Acc: 0.3957
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 4 ============
cnt=[4, 1, 2, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-White                    | Train Loss: 1.6231 | Train Acc: 0.3885
 Site-White                    | Train Loss: 1.5467 | Train Acc: 0.4077
 Site-Latino_Hispanic          | Train Loss: 1.7358 | Train Acc: 0.2878
 Site-Latino_Hispanic          | Train Loss: 1.6505 | Train Acc: 0.3837
 Site-Black                    | Train Loss: 1.8048 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.6797 | Train Acc: 0.3381
 Site-East_Asian               | Train Loss: 1.5647 | Train Acc: 0.3957
 Site-East_Asian               | Train Loss: 1.6006 | Train Acc: 0.4436
 Site-Indian                   | Train Loss: 1.6248 | Train Acc: 0.3669
 Site-Indian                   | Train Loss: 1.7264 | Train Acc: 0.3573
 Site-Southeast_Asian          | Train Loss: 1.6342 | Train Acc: 0.3885
 Site-Southeast_Asian          | Train Loss: 1.7493 | Train Acc: 0.3645
 Site-Middle_Eastern           | Train Loss: 1.6118 | Train Acc: 0.3813
 Site-Middle_Eastern           | Train Loss: 1.6279 | Train Acc: 0.3933
 Site-White                     (6) | Val  Loss: 1.6231 | Val  Acc: 0.4130
 Site-White                     (0) | Val  Loss: 1.6058 | Val  Acc: 0.3741
 Site-Latino_Hispanic           (6) | Val  Loss: 1.6969 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (0) | Val  Loss: 1.6824 | Val  Acc: 0.3777
 Site-Black                     (1) | Val  Loss: 1.6490 | Val  Acc: 0.4239
 Site-Black                     (5) | Val  Loss: 1.7619 | Val  Acc: 0.2950
 Site-East_Asian                (0) | Val  Loss: 1.4667 | Val  Acc: 0.5109
 Site-East_Asian                (0) | Val  Loss: 1.5132 | Val  Acc: 0.4281
 Site-Indian                    (3) | Val  Loss: 1.7303 | Val  Acc: 0.2717
 Site-Indian                    (3) | Val  Loss: 1.7014 | Val  Acc: 0.3058
 Site-Southeast_Asian           (4) | Val  Loss: 1.6333 | Val  Acc: 0.4348
 Site-Southeast_Asian           (4) | Val  Loss: 1.6276 | Val  Acc: 0.4065
 Site-Middle_Eastern            (2) | Val  Loss: 1.6071 | Val  Acc: 0.4565
 Site-Middle_Eastern            (2) | Val  Loss: 1.6387 | Val  Acc: 0.3885
Average Valid Accuracy: 0.3928
 Best site-White                    (6)  | Epoch:4 | Val Acc: 0.4130
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.3741
 Best site-Latino_Hispanic          (6)  | Epoch:4 | Val Acc: 0.4130
 Best site-Latino_Hispanic          (0)  | Epoch:4 | Val Acc: 0.3777
 Best site-Black                    (1)  | Epoch:4 | Val Acc: 0.4239
 Best site-Black                    (5)  | Epoch:4 | Val Acc: 0.2950
 Best site-East_Asian               (0)  | Epoch:4 | Val Acc: 0.5109
 Best site-East_Asian               (0)  | Epoch:4 | Val Acc: 0.4281
 Best site-Indian                   (3)  | Epoch:4 | Val Acc: 0.2717
 Best site-Indian                   (3)  | Epoch:4 | Val Acc: 0.3058
 Best site-Southeast_Asian          (4)  | Epoch:4 | Val Acc: 0.4348
 Best site-Southeast_Asian          (4)  | Epoch:4 | Val Acc: 0.4065
 Best site-Middle_Eastern           (2)  | Epoch:4 | Val Acc: 0.4565
 Best site-Middle_Eastern           (2)  | Epoch:4 | Val Acc: 0.3885
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 5 ============
cnt=[3, 2, 3, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-White                    | Train Loss: 1.5547 | Train Acc: 0.4317
 Site-White                    | Train Loss: 1.6005 | Train Acc: 0.3981
 Site-Latino_Hispanic          | Train Loss: 1.6714 | Train Acc: 0.3597
 Site-Latino_Hispanic          | Train Loss: 1.6760 | Train Acc: 0.3765
 Site-Black                    | Train Loss: 1.8144 | Train Acc: 0.3237
 Site-Black                    | Train Loss: 1.7235 | Train Acc: 0.3237
 Site-East_Asian               | Train Loss: 1.5177 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.4495 | Train Acc: 0.4508
 Site-Indian                   | Train Loss: 1.6165 | Train Acc: 0.4173
 Site-Indian                   | Train Loss: 1.6261 | Train Acc: 0.3669
 Site-Southeast_Asian          | Train Loss: 1.6306 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.6250 | Train Acc: 0.4053
 Site-Middle_Eastern           | Train Loss: 1.6349 | Train Acc: 0.3597
 Site-Middle_Eastern           | Train Loss: 1.5313 | Train Acc: 0.4149
 Site-White                     (0) | Val  Loss: 1.6057 | Val  Acc: 0.3587
 Site-White                     (0) | Val  Loss: 1.5692 | Val  Acc: 0.4029
 Site-Latino_Hispanic           (0) | Val  Loss: 1.6691 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (2) | Val  Loss: 1.6453 | Val  Acc: 0.3633
 Site-Black                     (6) | Val  Loss: 1.5671 | Val  Acc: 0.4674
 Site-Black                     (4) | Val  Loss: 1.6929 | Val  Acc: 0.3921
 Site-East_Asian                (3) | Val  Loss: 1.4006 | Val  Acc: 0.5435
 Site-East_Asian                (3) | Val  Loss: 1.4739 | Val  Acc: 0.4748
 Site-Indian                    (2) | Val  Loss: 1.7192 | Val  Acc: 0.3152
 Site-Indian                    (2) | Val  Loss: 1.6432 | Val  Acc: 0.3489
 Site-Southeast_Asian           (1) | Val  Loss: 1.6277 | Val  Acc: 0.3804
 Site-Southeast_Asian           (1) | Val  Loss: 1.5959 | Val  Acc: 0.4101
 Site-Middle_Eastern            (5) | Val  Loss: 1.5497 | Val  Acc: 0.5000
 Site-Middle_Eastern            (5) | Val  Loss: 1.5958 | Val  Acc: 0.4209
Average Valid Accuracy: 0.4129
 Best site-White                    (0)  | Epoch:5 | Val Acc: 0.3587
 Best site-White                    (0)  | Epoch:5 | Val Acc: 0.4029
 Best site-Latino_Hispanic          (0)  | Epoch:5 | Val Acc: 0.4022
 Best site-Latino_Hispanic          (2)  | Epoch:5 | Val Acc: 0.3633
 Best site-Black                    (6)  | Epoch:5 | Val Acc: 0.4674
 Best site-Black                    (4)  | Epoch:5 | Val Acc: 0.3921
 Best site-East_Asian               (3)  | Epoch:5 | Val Acc: 0.5435
 Best site-East_Asian               (3)  | Epoch:5 | Val Acc: 0.4748
 Best site-Indian                   (2)  | Epoch:5 | Val Acc: 0.3152
 Best site-Indian                   (2)  | Epoch:5 | Val Acc: 0.3489
 Best site-Southeast_Asian          (1)  | Epoch:5 | Val Acc: 0.3804
 Best site-Southeast_Asian          (1)  | Epoch:5 | Val Acc: 0.4101
 Best site-Middle_Eastern           (5)  | Epoch:5 | Val Acc: 0.5000
 Best site-Middle_Eastern           (5)  | Epoch:5 | Val Acc: 0.4209
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 6 ============
cnt=[1, 3, 2, 1, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-White                    | Train Loss: 1.5217 | Train Acc: 0.3885
 Site-White                    | Train Loss: 1.5323 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.6652 | Train Acc: 0.3453
 Site-Latino_Hispanic          | Train Loss: 1.7146 | Train Acc: 0.3549
 Site-Black                    | Train Loss: 1.7675 | Train Acc: 0.3094
 Site-Black                    | Train Loss: 1.7801 | Train Acc: 0.3381
 Site-East_Asian               | Train Loss: 1.5078 | Train Acc: 0.3957
 Site-East_Asian               | Train Loss: 1.5091 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.5512 | Train Acc: 0.4029
 Site-Indian                   | Train Loss: 1.5834 | Train Acc: 0.3669
 Site-Southeast_Asian          | Train Loss: 1.5765 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.6302 | Train Acc: 0.4221
 Site-Middle_Eastern           | Train Loss: 1.6120 | Train Acc: 0.4101
 Site-Middle_Eastern           | Train Loss: 1.5424 | Train Acc: 0.4436
 Site-White                     (4) | Val  Loss: 1.5751 | Val  Acc: 0.4022
 Site-White                     (0) | Val  Loss: 1.5525 | Val  Acc: 0.4101
 Site-Latino_Hispanic           (4) | Val  Loss: 1.6180 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (1) | Val  Loss: 1.6104 | Val  Acc: 0.3777
 Site-Black                     (6) | Val  Loss: 1.5922 | Val  Acc: 0.4891
 Site-Black                     (6) | Val  Loss: 1.6871 | Val  Acc: 0.3309
 Site-East_Asian                (5) | Val  Loss: 1.4315 | Val  Acc: 0.5000
 Site-East_Asian                (3) | Val  Loss: 1.4659 | Val  Acc: 0.4568
 Site-Indian                    (1) | Val  Loss: 1.6344 | Val  Acc: 0.3043
 Site-Indian                    (1) | Val  Loss: 1.6190 | Val  Acc: 0.3381
 Site-Southeast_Asian           (5) | Val  Loss: 1.5703 | Val  Acc: 0.4130
 Site-Southeast_Asian           (5) | Val  Loss: 1.5575 | Val  Acc: 0.4317
 Site-Middle_Eastern            (2) | Val  Loss: 1.5398 | Val  Acc: 0.4891
 Site-Middle_Eastern            (2) | Val  Loss: 1.5481 | Val  Acc: 0.4101
Average Valid Accuracy: 0.4111
============ Train epoch 7 ============
cnt=[1, 2, 2, 2, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-White                    | Train Loss: 1.4872 | Train Acc: 0.4245
 Site-White                    | Train Loss: 1.5612 | Train Acc: 0.4221
 Site-Latino_Hispanic          | Train Loss: 1.6786 | Train Acc: 0.3309
 Site-Latino_Hispanic          | Train Loss: 1.5744 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.7289 | Train Acc: 0.2950
 Site-Black                    | Train Loss: 1.6562 | Train Acc: 0.3549
 Site-East_Asian               | Train Loss: 1.4534 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.4747 | Train Acc: 0.4604
 Site-Indian                   | Train Loss: 1.4973 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.5587 | Train Acc: 0.3549
 Site-Southeast_Asian          | Train Loss: 1.5565 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.4912 | Train Acc: 0.4197
 Site-Middle_Eastern           | Train Loss: 1.5558 | Train Acc: 0.3525
 Site-Middle_Eastern           | Train Loss: 1.4463 | Train Acc: 0.4484
 Site-White                     (4) | Val  Loss: 1.5752 | Val  Acc: 0.3587
 Site-White                     (5) | Val  Loss: 1.5361 | Val  Acc: 0.4137
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5790 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (0) | Val  Loss: 1.6008 | Val  Acc: 0.3957
 Site-Black                     (3) | Val  Loss: 1.5257 | Val  Acc: 0.4457
 Site-Black                     (3) | Val  Loss: 1.6782 | Val  Acc: 0.3273
 Site-East_Asian                (1) | Val  Loss: 1.3866 | Val  Acc: 0.4783
 Site-East_Asian                (1) | Val  Loss: 1.4549 | Val  Acc: 0.4676
 Site-Indian                    (2) | Val  Loss: 1.6534 | Val  Acc: 0.3370
 Site-Indian                    (2) | Val  Loss: 1.6080 | Val  Acc: 0.3381
 Site-Southeast_Asian           (6) | Val  Loss: 1.5551 | Val  Acc: 0.4348
 Site-Southeast_Asian           (6) | Val  Loss: 1.5282 | Val  Acc: 0.4209
 Site-Middle_Eastern            (5) | Val  Loss: 1.4913 | Val  Acc: 0.5000
 Site-Middle_Eastern            (5) | Val  Loss: 1.5116 | Val  Acc: 0.4317
Average Valid Accuracy: 0.4131
 Best site-White                    (4)  | Epoch:7 | Val Acc: 0.3587
 Best site-White                    (5)  | Epoch:7 | Val Acc: 0.4137
 Best site-Latino_Hispanic          (4)  | Epoch:7 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (0)  | Epoch:7 | Val Acc: 0.3957
 Best site-Black                    (3)  | Epoch:7 | Val Acc: 0.4457
 Best site-Black                    (3)  | Epoch:7 | Val Acc: 0.3273
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.4783
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.4676
 Best site-Indian                   (2)  | Epoch:7 | Val Acc: 0.3370
 Best site-Indian                   (2)  | Epoch:7 | Val Acc: 0.3381
 Best site-Southeast_Asian          (6)  | Epoch:7 | Val Acc: 0.4348
 Best site-Southeast_Asian          (6)  | Epoch:7 | Val Acc: 0.4209
 Best site-Middle_Eastern           (5)  | Epoch:7 | Val Acc: 0.5000
 Best site-Middle_Eastern           (5)  | Epoch:7 | Val Acc: 0.4317
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 8 ============
cnt=[1, 2, 1, 5, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-White                    | Train Loss: 1.4741 | Train Acc: 0.4388
 Site-White                    | Train Loss: 1.4421 | Train Acc: 0.4317
 Site-Latino_Hispanic          | Train Loss: 1.6466 | Train Acc: 0.3597
 Site-Latino_Hispanic          | Train Loss: 1.5549 | Train Acc: 0.3765
 Site-Black                    | Train Loss: 1.7282 | Train Acc: 0.3237
 Site-Black                    | Train Loss: 1.6359 | Train Acc: 0.3477
 Site-East_Asian               | Train Loss: 1.5023 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.4924 | Train Acc: 0.4652
 Site-Indian                   | Train Loss: 1.5177 | Train Acc: 0.4245
 Site-Indian                   | Train Loss: 1.7472 | Train Acc: 0.3669
 Site-Southeast_Asian          | Train Loss: 1.5325 | Train Acc: 0.4317
 Site-Southeast_Asian          | Train Loss: 1.5734 | Train Acc: 0.4341
 Site-Middle_Eastern           | Train Loss: 1.4531 | Train Acc: 0.4317
 Site-Middle_Eastern           | Train Loss: 1.4691 | Train Acc: 0.4125
 Site-White                     (0) | Val  Loss: 1.5101 | Val  Acc: 0.3913
 Site-White                     (6) | Val  Loss: 1.4889 | Val  Acc: 0.4424
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5819 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (3) | Val  Loss: 1.5510 | Val  Acc: 0.3885
 Site-Black                     (2) | Val  Loss: 1.5118 | Val  Acc: 0.5000
 Site-Black                     (5) | Val  Loss: 1.6566 | Val  Acc: 0.3597
 Site-East_Asian                (3) | Val  Loss: 1.3826 | Val  Acc: 0.4783
 Site-East_Asian                (3) | Val  Loss: 1.4303 | Val  Acc: 0.4640
 Site-Indian                    (4) | Val  Loss: 1.6563 | Val  Acc: 0.2826
 Site-Indian                    (4) | Val  Loss: 1.5831 | Val  Acc: 0.3453
 Site-Southeast_Asian           (3) | Val  Loss: 1.5158 | Val  Acc: 0.4348
 Site-Southeast_Asian           (3) | Val  Loss: 1.5053 | Val  Acc: 0.4245
 Site-Middle_Eastern            (1) | Val  Loss: 1.4686 | Val  Acc: 0.5109
 Site-Middle_Eastern            (1) | Val  Loss: 1.4985 | Val  Acc: 0.4281
Average Valid Accuracy: 0.4188
 Best site-White                    (0)  | Epoch:8 | Val Acc: 0.3913
 Best site-White                    (6)  | Epoch:8 | Val Acc: 0.4424
 Best site-Latino_Hispanic          (4)  | Epoch:8 | Val Acc: 0.4130
 Best site-Latino_Hispanic          (3)  | Epoch:8 | Val Acc: 0.3885
 Best site-Black                    (2)  | Epoch:8 | Val Acc: 0.5000
 Best site-Black                    (5)  | Epoch:8 | Val Acc: 0.3597
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4783
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4640
 Best site-Indian                   (4)  | Epoch:8 | Val Acc: 0.2826
 Best site-Indian                   (4)  | Epoch:8 | Val Acc: 0.3453
 Best site-Southeast_Asian          (3)  | Epoch:8 | Val Acc: 0.4348
 Best site-Southeast_Asian          (3)  | Epoch:8 | Val Acc: 0.4245
 Best site-Middle_Eastern           (1)  | Epoch:8 | Val Acc: 0.5109
 Best site-Middle_Eastern           (1)  | Epoch:8 | Val Acc: 0.4281
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 9 ============
cnt=[4, 2, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-White                    | Train Loss: 1.4528 | Train Acc: 0.4388
 Site-White                    | Train Loss: 1.4623 | Train Acc: 0.4436
 Site-Latino_Hispanic          | Train Loss: 1.6355 | Train Acc: 0.3741
 Site-Latino_Hispanic          | Train Loss: 1.5687 | Train Acc: 0.3909
 Site-Black                    | Train Loss: 1.6619 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.6788 | Train Acc: 0.3213
 Site-East_Asian               | Train Loss: 1.4486 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3970 | Train Acc: 0.4556
 Site-Indian                   | Train Loss: 1.4495 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.5278 | Train Acc: 0.4221
 Site-Southeast_Asian          | Train Loss: 1.5138 | Train Acc: 0.5036
 Site-Southeast_Asian          | Train Loss: 1.6150 | Train Acc: 0.4293
 Site-Middle_Eastern           | Train Loss: 1.5142 | Train Acc: 0.4173
 Site-Middle_Eastern           | Train Loss: 1.4210 | Train Acc: 0.4412
 Site-White                     (4) | Val  Loss: 1.5247 | Val  Acc: 0.4130
 Site-White                     (5) | Val  Loss: 1.4615 | Val  Acc: 0.4568
 Site-Latino_Hispanic           (6) | Val  Loss: 1.5488 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5558 | Val  Acc: 0.3993
 Site-Black                     (1) | Val  Loss: 1.5253 | Val  Acc: 0.4891
 Site-Black                     (1) | Val  Loss: 1.6510 | Val  Acc: 0.3597
 Site-East_Asian                (0) | Val  Loss: 1.3433 | Val  Acc: 0.5000
 Site-East_Asian                (0) | Val  Loss: 1.4147 | Val  Acc: 0.4964
 Site-Indian                    (2) | Val  Loss: 1.5940 | Val  Acc: 0.2935
 Site-Indian                    (2) | Val  Loss: 1.5408 | Val  Acc: 0.3741
 Site-Southeast_Asian           (0) | Val  Loss: 1.4778 | Val  Acc: 0.4457
 Site-Southeast_Asian           (0) | Val  Loss: 1.4858 | Val  Acc: 0.4532
 Site-Middle_Eastern            (3) | Val  Loss: 1.4315 | Val  Acc: 0.5000
 Site-Middle_Eastern            (3) | Val  Loss: 1.4900 | Val  Acc: 0.4173
Average Valid Accuracy: 0.4317
 Best site-White                    (4)  | Epoch:9 | Val Acc: 0.4130
 Best site-White                    (5)  | Epoch:9 | Val Acc: 0.4568
 Best site-Latino_Hispanic          (6)  | Epoch:9 | Val Acc: 0.4457
 Best site-Latino_Hispanic          (4)  | Epoch:9 | Val Acc: 0.3993
 Best site-Black                    (1)  | Epoch:9 | Val Acc: 0.4891
 Best site-Black                    (1)  | Epoch:9 | Val Acc: 0.3597
 Best site-East_Asian               (0)  | Epoch:9 | Val Acc: 0.5000
 Best site-East_Asian               (0)  | Epoch:9 | Val Acc: 0.4964
 Best site-Indian                   (2)  | Epoch:9 | Val Acc: 0.2935
 Best site-Indian                   (2)  | Epoch:9 | Val Acc: 0.3741
 Best site-Southeast_Asian          (0)  | Epoch:9 | Val Acc: 0.4457
 Best site-Southeast_Asian          (0)  | Epoch:9 | Val Acc: 0.4532
 Best site-Middle_Eastern           (3)  | Epoch:9 | Val Acc: 0.5000
 Best site-Middle_Eastern           (3)  | Epoch:9 | Val Acc: 0.4173
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
 Test site-White                     (4)| Epoch:9 | Test Acc: 0.4305
 Test site-Latino_Hispanic           (6)| Epoch:9 | Test Acc: 0.3544
 Test site-Black                     (1)| Epoch:9 | Test Acc: 0.3187
 Test site-East_Asian                (0)| Epoch:9 | Test Acc: 0.4578
 Test site-Indian                    (2)| Epoch:9 | Test Acc: 0.3230
 Test site-Southeast_Asian           (0)| Epoch:9 | Test Acc: 0.4407
 Test site-Middle_Eastern            (3)| Epoch:9 | Test Acc: 0.3840
White: 0.4305, Latino_Hispanic: 0.3544, Black: 0.3187, East_Asian: 0.4578, Indian: 0.3230, Southeast_Asian: 0.4407, Middle_Eastern: 0.3840, 
Average Test Accuracy: 0.3870, domain std=0.0529, cluster std=nan, individual std=0.0529, 
============ Train epoch 10 ============
cnt=[2, 2, 1, 2, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-White                    | Train Loss: 1.5407 | Train Acc: 0.4245
 Site-White                    | Train Loss: 1.3817 | Train Acc: 0.4508
 Site-Latino_Hispanic          | Train Loss: 1.6325 | Train Acc: 0.3309
 Site-Latino_Hispanic          | Train Loss: 1.4394 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.7148 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.6562 | Train Acc: 0.3741
 Site-East_Asian               | Train Loss: 1.4332 | Train Acc: 0.3957
 Site-East_Asian               | Train Loss: 1.3998 | Train Acc: 0.4628
 Site-Indian                   | Train Loss: 1.5181 | Train Acc: 0.4460
 Site-Indian                   | Train Loss: 1.5431 | Train Acc: 0.3909
 Site-Southeast_Asian          | Train Loss: 1.4765 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.5069 | Train Acc: 0.3957
 Site-Middle_Eastern           | Train Loss: 1.4522 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.4465 | Train Acc: 0.4484
 Site-White                     (6) | Val  Loss: 1.4723 | Val  Acc: 0.4130
 Site-White                     (6) | Val  Loss: 1.4562 | Val  Acc: 0.4460
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5363 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (6) | Val  Loss: 1.5306 | Val  Acc: 0.4245
 Site-Black                     (1) | Val  Loss: 1.4722 | Val  Acc: 0.4565
 Site-Black                     (1) | Val  Loss: 1.6299 | Val  Acc: 0.3489
 Site-East_Asian                (5) | Val  Loss: 1.3272 | Val  Acc: 0.5326
 Site-East_Asian                (5) | Val  Loss: 1.3948 | Val  Acc: 0.4892
 Site-Indian                    (0) | Val  Loss: 1.6128 | Val  Acc: 0.2717
 Site-Indian                    (0) | Val  Loss: 1.5459 | Val  Acc: 0.3705
 Site-Southeast_Asian           (3) | Val  Loss: 1.4361 | Val  Acc: 0.4348
 Site-Southeast_Asian           (3) | Val  Loss: 1.4541 | Val  Acc: 0.4353
 Site-Middle_Eastern            (2) | Val  Loss: 1.4884 | Val  Acc: 0.4891
 Site-Middle_Eastern            (6) | Val  Loss: 1.4713 | Val  Acc: 0.4604
Average Valid Accuracy: 0.4283
============ Train epoch 11 ============
cnt=[2, 3, 1, 2, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-White                    | Train Loss: 1.4757 | Train Acc: 0.4604
 Site-White                    | Train Loss: 1.5069 | Train Acc: 0.4436
 Site-Latino_Hispanic          | Train Loss: 1.6158 | Train Acc: 0.4173
 Site-Latino_Hispanic          | Train Loss: 1.4831 | Train Acc: 0.3909
 Site-Black                    | Train Loss: 1.7435 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.5905 | Train Acc: 0.3717
 Site-East_Asian               | Train Loss: 1.4226 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.5247 | Train Acc: 0.4628
 Site-Indian                   | Train Loss: 1.4467 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.4752 | Train Acc: 0.4101
 Site-Southeast_Asian          | Train Loss: 1.4662 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.6100 | Train Acc: 0.4245
 Site-Middle_Eastern           | Train Loss: 1.5269 | Train Acc: 0.4173
 Site-Middle_Eastern           | Train Loss: 1.5207 | Train Acc: 0.4724
 Site-White                     (1) | Val  Loss: 1.5297 | Val  Acc: 0.4239
 Site-White                     (1) | Val  Loss: 1.4503 | Val  Acc: 0.4424
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5146 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5253 | Val  Acc: 0.4353
 Site-Black                     (6) | Val  Loss: 1.4005 | Val  Acc: 0.5217
 Site-Black                     (2) | Val  Loss: 1.5867 | Val  Acc: 0.3741
 Site-East_Asian                (4) | Val  Loss: 1.3189 | Val  Acc: 0.5652
 Site-East_Asian                (0) | Val  Loss: 1.3792 | Val  Acc: 0.5000
 Site-Indian                    (3) | Val  Loss: 1.5853 | Val  Acc: 0.2935
 Site-Indian                    (3) | Val  Loss: 1.5153 | Val  Acc: 0.3705
 Site-Southeast_Asian           (0) | Val  Loss: 1.4685 | Val  Acc: 0.4348
 Site-Southeast_Asian           (4) | Val  Loss: 1.4380 | Val  Acc: 0.4532
 Site-Middle_Eastern            (1) | Val  Loss: 1.4229 | Val  Acc: 0.5217
 Site-Middle_Eastern            (5) | Val  Loss: 1.4717 | Val  Acc: 0.4460
Average Valid Accuracy: 0.4441
 Best site-White                    (1)  | Epoch:11 | Val Acc: 0.4239
 Best site-White                    (1)  | Epoch:11 | Val Acc: 0.4424
 Best site-Latino_Hispanic          (4)  | Epoch:11 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (4)  | Epoch:11 | Val Acc: 0.4353
 Best site-Black                    (6)  | Epoch:11 | Val Acc: 0.5217
 Best site-Black                    (2)  | Epoch:11 | Val Acc: 0.3741
 Best site-East_Asian               (4)  | Epoch:11 | Val Acc: 0.5652
 Best site-East_Asian               (0)  | Epoch:11 | Val Acc: 0.5000
 Best site-Indian                   (3)  | Epoch:11 | Val Acc: 0.2935
 Best site-Indian                   (3)  | Epoch:11 | Val Acc: 0.3705
 Best site-Southeast_Asian          (0)  | Epoch:11 | Val Acc: 0.4348
 Best site-Southeast_Asian          (4)  | Epoch:11 | Val Acc: 0.4532
 Best site-Middle_Eastern           (1)  | Epoch:11 | Val Acc: 0.5217
 Best site-Middle_Eastern           (5)  | Epoch:11 | Val Acc: 0.4460
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 12 ============
cnt=[2, 1, 3, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-White                    | Train Loss: 1.4531 | Train Acc: 0.4460
 Site-White                    | Train Loss: 1.3921 | Train Acc: 0.4628
 Site-Latino_Hispanic          | Train Loss: 1.5512 | Train Acc: 0.3741
 Site-Latino_Hispanic          | Train Loss: 1.5415 | Train Acc: 0.4341
 Site-Black                    | Train Loss: 1.8062 | Train Acc: 0.3597
 Site-Black                    | Train Loss: 1.6061 | Train Acc: 0.3549
 Site-East_Asian               | Train Loss: 1.4762 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3138 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.3937 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.4793 | Train Acc: 0.4077
 Site-Southeast_Asian          | Train Loss: 1.5251 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.4514 | Train Acc: 0.4580
 Site-Middle_Eastern           | Train Loss: 1.4463 | Train Acc: 0.4317
 Site-Middle_Eastern           | Train Loss: 1.3923 | Train Acc: 0.4484
 Site-White                     (5) | Val  Loss: 1.4619 | Val  Acc: 0.4457
 Site-White                     (2) | Val  Loss: 1.4485 | Val  Acc: 0.4317
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5571 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5074 | Val  Acc: 0.4173
 Site-Black                     (1) | Val  Loss: 1.4373 | Val  Acc: 0.4891
 Site-Black                     (3) | Val  Loss: 1.6101 | Val  Acc: 0.3813
 Site-East_Asian                (6) | Val  Loss: 1.3232 | Val  Acc: 0.4783
 Site-East_Asian                (6) | Val  Loss: 1.3831 | Val  Acc: 0.5216
 Site-Indian                    (4) | Val  Loss: 1.5641 | Val  Acc: 0.2826
 Site-Indian                    (4) | Val  Loss: 1.4894 | Val  Acc: 0.4173
 Site-Southeast_Asian           (0) | Val  Loss: 1.4448 | Val  Acc: 0.4783
 Site-Southeast_Asian           (0) | Val  Loss: 1.4400 | Val  Acc: 0.4748
 Site-Middle_Eastern            (2) | Val  Loss: 1.4278 | Val  Acc: 0.4783
 Site-Middle_Eastern            (2) | Val  Loss: 1.4572 | Val  Acc: 0.4388
Average Valid Accuracy: 0.4415
============ Train epoch 13 ============
cnt=[3, 3, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-White                    | Train Loss: 1.4795 | Train Acc: 0.4604
 Site-White                    | Train Loss: 1.4356 | Train Acc: 0.4892
 Site-Latino_Hispanic          | Train Loss: 1.6249 | Train Acc: 0.3957
 Site-Latino_Hispanic          | Train Loss: 1.6652 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.6627 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.6352 | Train Acc: 0.3717
 Site-East_Asian               | Train Loss: 1.4921 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.3629 | Train Acc: 0.4796
 Site-Indian                   | Train Loss: 1.4571 | Train Acc: 0.4460
 Site-Indian                   | Train Loss: 1.4810 | Train Acc: 0.4029
 Site-Southeast_Asian          | Train Loss: 1.4619 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.4680 | Train Acc: 0.4580
 Site-Middle_Eastern           | Train Loss: 1.4512 | Train Acc: 0.4317
 Site-Middle_Eastern           | Train Loss: 1.4799 | Train Acc: 0.4580
 Site-White                     (2) | Val  Loss: 1.4520 | Val  Acc: 0.4565
 Site-White                     (2) | Val  Loss: 1.4326 | Val  Acc: 0.4496
 Site-Latino_Hispanic           (5) | Val  Loss: 1.5170 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (0) | Val  Loss: 1.5052 | Val  Acc: 0.4029
 Site-Black                     (3) | Val  Loss: 1.4168 | Val  Acc: 0.4891
 Site-Black                     (3) | Val  Loss: 1.5799 | Val  Acc: 0.3921
 Site-East_Asian                (1) | Val  Loss: 1.3180 | Val  Acc: 0.5000
 Site-East_Asian                (6) | Val  Loss: 1.3575 | Val  Acc: 0.5108
 Site-Indian                    (0) | Val  Loss: 1.5415 | Val  Acc: 0.3696
 Site-Indian                    (0) | Val  Loss: 1.4764 | Val  Acc: 0.4424
 Site-Southeast_Asian           (1) | Val  Loss: 1.4887 | Val  Acc: 0.3913
 Site-Southeast_Asian           (1) | Val  Loss: 1.4359 | Val  Acc: 0.4532
 Site-Middle_Eastern            (4) | Val  Loss: 1.3990 | Val  Acc: 0.5217
 Site-Middle_Eastern            (4) | Val  Loss: 1.4583 | Val  Acc: 0.4353
Average Valid Accuracy: 0.4464
 Best site-White                    (2)  | Epoch:13 | Val Acc: 0.4565
 Best site-White                    (2)  | Epoch:13 | Val Acc: 0.4496
 Best site-Latino_Hispanic          (5)  | Epoch:13 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (0)  | Epoch:13 | Val Acc: 0.4029
 Best site-Black                    (3)  | Epoch:13 | Val Acc: 0.4891
 Best site-Black                    (3)  | Epoch:13 | Val Acc: 0.3921
 Best site-East_Asian               (1)  | Epoch:13 | Val Acc: 0.5000
 Best site-East_Asian               (6)  | Epoch:13 | Val Acc: 0.5108
 Best site-Indian                   (0)  | Epoch:13 | Val Acc: 0.3696
 Best site-Indian                   (0)  | Epoch:13 | Val Acc: 0.4424
 Best site-Southeast_Asian          (1)  | Epoch:13 | Val Acc: 0.3913
 Best site-Southeast_Asian          (1)  | Epoch:13 | Val Acc: 0.4532
 Best site-Middle_Eastern           (4)  | Epoch:13 | Val Acc: 0.5217
 Best site-Middle_Eastern           (4)  | Epoch:13 | Val Acc: 0.4353
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 14 ============
cnt=[3, 2, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-White                    | Train Loss: 1.4463 | Train Acc: 0.4676
 Site-White                    | Train Loss: 1.3579 | Train Acc: 0.4604
 Site-Latino_Hispanic          | Train Loss: 1.5808 | Train Acc: 0.3741
 Site-Latino_Hispanic          | Train Loss: 1.5335 | Train Acc: 0.4077
 Site-Black                    | Train Loss: 1.6849 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.5642 | Train Acc: 0.3789
 Site-East_Asian               | Train Loss: 1.4328 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3506 | Train Acc: 0.4988
 Site-Indian                   | Train Loss: 1.3983 | Train Acc: 0.4604
 Site-Indian                   | Train Loss: 1.5065 | Train Acc: 0.4245
 Site-Southeast_Asian          | Train Loss: 1.5223 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.5806 | Train Acc: 0.4221
 Site-Middle_Eastern           | Train Loss: 1.4238 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.3942 | Train Acc: 0.4508
 Site-White                     (4) | Val  Loss: 1.4609 | Val  Acc: 0.4348
 Site-White                     (6) | Val  Loss: 1.4125 | Val  Acc: 0.4353
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4760 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (0) | Val  Loss: 1.5079 | Val  Acc: 0.4065
 Site-Black                     (3) | Val  Loss: 1.4591 | Val  Acc: 0.4783
 Site-Black                     (3) | Val  Loss: 1.5939 | Val  Acc: 0.3705
 Site-East_Asian                (5) | Val  Loss: 1.2757 | Val  Acc: 0.5217
 Site-East_Asian                (5) | Val  Loss: 1.3393 | Val  Acc: 0.4892
 Site-Indian                    (0) | Val  Loss: 1.5806 | Val  Acc: 0.2826
 Site-Indian                    (0) | Val  Loss: 1.5035 | Val  Acc: 0.4101
 Site-Southeast_Asian           (1) | Val  Loss: 1.4609 | Val  Acc: 0.4239
 Site-Southeast_Asian           (1) | Val  Loss: 1.4382 | Val  Acc: 0.4496
 Site-Middle_Eastern            (2) | Val  Loss: 1.4199 | Val  Acc: 0.5543
 Site-Middle_Eastern            (2) | Val  Loss: 1.4340 | Val  Acc: 0.4496
Average Valid Accuracy: 0.4387
============ Train epoch 15 ============
cnt=[2, 2, 1, 2, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-White                    | Train Loss: 1.4067 | Train Acc: 0.4460
 Site-White                    | Train Loss: 1.4162 | Train Acc: 0.4556
 Site-Latino_Hispanic          | Train Loss: 1.6551 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.4906 | Train Acc: 0.4077
 Site-Black                    | Train Loss: 1.6787 | Train Acc: 0.3525
 Site-Black                    | Train Loss: 1.7001 | Train Acc: 0.3597
 Site-East_Asian               | Train Loss: 1.4379 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3152 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.4335 | Train Acc: 0.4604
 Site-Indian                   | Train Loss: 1.4423 | Train Acc: 0.4484
 Site-Southeast_Asian          | Train Loss: 1.4273 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.5374 | Train Acc: 0.4341
 Site-Middle_Eastern           | Train Loss: 1.4791 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.3997 | Train Acc: 0.4988
 Site-White                     (4) | Val  Loss: 1.3907 | Val  Acc: 0.4783
 Site-White                     (4) | Val  Loss: 1.3998 | Val  Acc: 0.4640
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4752 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5090 | Val  Acc: 0.4137
 Site-Black                     (5) | Val  Loss: 1.4917 | Val  Acc: 0.4674
 Site-Black                     (2) | Val  Loss: 1.5850 | Val  Acc: 0.4029
 Site-East_Asian                (0) | Val  Loss: 1.2756 | Val  Acc: 0.5652
 Site-East_Asian                (0) | Val  Loss: 1.3464 | Val  Acc: 0.4820
 Site-Indian                    (6) | Val  Loss: 1.5583 | Val  Acc: 0.3261
 Site-Indian                    (6) | Val  Loss: 1.4867 | Val  Acc: 0.4137
 Site-Southeast_Asian           (3) | Val  Loss: 1.3914 | Val  Acc: 0.4674
 Site-Southeast_Asian           (3) | Val  Loss: 1.4396 | Val  Acc: 0.4604
 Site-Middle_Eastern            (1) | Val  Loss: 1.4123 | Val  Acc: 0.4674
 Site-Middle_Eastern            (1) | Val  Loss: 1.4413 | Val  Acc: 0.4676
Average Valid Accuracy: 0.4500
 Best site-White                    (4)  | Epoch:15 | Val Acc: 0.4783
 Best site-White                    (4)  | Epoch:15 | Val Acc: 0.4640
 Best site-Latino_Hispanic          (4)  | Epoch:15 | Val Acc: 0.4239
 Best site-Latino_Hispanic          (4)  | Epoch:15 | Val Acc: 0.4137
 Best site-Black                    (5)  | Epoch:15 | Val Acc: 0.4674
 Best site-Black                    (2)  | Epoch:15 | Val Acc: 0.4029
 Best site-East_Asian               (0)  | Epoch:15 | Val Acc: 0.5652
 Best site-East_Asian               (0)  | Epoch:15 | Val Acc: 0.4820
 Best site-Indian                   (6)  | Epoch:15 | Val Acc: 0.3261
 Best site-Indian                   (6)  | Epoch:15 | Val Acc: 0.4137
 Best site-Southeast_Asian          (3)  | Epoch:15 | Val Acc: 0.4674
 Best site-Southeast_Asian          (3)  | Epoch:15 | Val Acc: 0.4604
 Best site-Middle_Eastern           (1)  | Epoch:15 | Val Acc: 0.4674
 Best site-Middle_Eastern           (1)  | Epoch:15 | Val Acc: 0.4676
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 16 ============
cnt=[1, 1, 4, 2, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-White                    | Train Loss: 1.5096 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.3317 | Train Acc: 0.4724
 Site-Latino_Hispanic          | Train Loss: 1.5790 | Train Acc: 0.3957
 Site-Latino_Hispanic          | Train Loss: 1.4242 | Train Acc: 0.3861
 Site-Black                    | Train Loss: 1.6855 | Train Acc: 0.3381
 Site-Black                    | Train Loss: 1.5410 | Train Acc: 0.3885
 Site-East_Asian               | Train Loss: 1.3402 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3504 | Train Acc: 0.4940
 Site-Indian                   | Train Loss: 1.4010 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.5279 | Train Acc: 0.4077
 Site-Southeast_Asian          | Train Loss: 1.4756 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.6353 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.4467 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.3967 | Train Acc: 0.4796
 Site-White                     (4) | Val  Loss: 1.4398 | Val  Acc: 0.4783
 Site-White                     (4) | Val  Loss: 1.3860 | Val  Acc: 0.4856
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4845 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4804 | Val  Acc: 0.4137
 Site-Black                     (3) | Val  Loss: 1.4233 | Val  Acc: 0.5109
 Site-Black                     (3) | Val  Loss: 1.5371 | Val  Acc: 0.4173
 Site-East_Asian                (2) | Val  Loss: 1.3097 | Val  Acc: 0.5435
 Site-East_Asian                (2) | Val  Loss: 1.3530 | Val  Acc: 0.5108
 Site-Indian                    (6) | Val  Loss: 1.5826 | Val  Acc: 0.3370
 Site-Indian                    (6) | Val  Loss: 1.4722 | Val  Acc: 0.4137
 Site-Southeast_Asian           (2) | Val  Loss: 1.3998 | Val  Acc: 0.4348
 Site-Southeast_Asian           (2) | Val  Loss: 1.4293 | Val  Acc: 0.4568
 Site-Middle_Eastern            (5) | Val  Loss: 1.3983 | Val  Acc: 0.5109
 Site-Middle_Eastern            (0) | Val  Loss: 1.4084 | Val  Acc: 0.4676
Average Valid Accuracy: 0.4582
 Best site-White                    (4)  | Epoch:16 | Val Acc: 0.4783
 Best site-White                    (4)  | Epoch:16 | Val Acc: 0.4856
 Best site-Latino_Hispanic          (1)  | Epoch:16 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (6)  | Epoch:16 | Val Acc: 0.4137
 Best site-Black                    (3)  | Epoch:16 | Val Acc: 0.5109
 Best site-Black                    (3)  | Epoch:16 | Val Acc: 0.4173
 Best site-East_Asian               (2)  | Epoch:16 | Val Acc: 0.5435
 Best site-East_Asian               (2)  | Epoch:16 | Val Acc: 0.5108
 Best site-Indian                   (6)  | Epoch:16 | Val Acc: 0.3370
 Best site-Indian                   (6)  | Epoch:16 | Val Acc: 0.4137
 Best site-Southeast_Asian          (2)  | Epoch:16 | Val Acc: 0.4348
 Best site-Southeast_Asian          (2)  | Epoch:16 | Val Acc: 0.4568
 Best site-Middle_Eastern           (5)  | Epoch:16 | Val Acc: 0.5109
 Best site-Middle_Eastern           (0)  | Epoch:16 | Val Acc: 0.4676
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 17 ============
cnt=[3, 1, 4, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-White                    | Train Loss: 1.4072 | Train Acc: 0.4676
 Site-White                    | Train Loss: 1.2886 | Train Acc: 0.4676
 Site-Latino_Hispanic          | Train Loss: 1.6104 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.4924 | Train Acc: 0.4293
 Site-Black                    | Train Loss: 1.6116 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.6609 | Train Acc: 0.3861
 Site-East_Asian               | Train Loss: 1.4316 | Train Acc: 0.4029
 Site-East_Asian               | Train Loss: 1.3008 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.4361 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.4676 | Train Acc: 0.4269
 Site-Southeast_Asian          | Train Loss: 1.4998 | Train Acc: 0.5036
 Site-Southeast_Asian          | Train Loss: 1.4495 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.4626 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.3185 | Train Acc: 0.4676
 Site-White                     (3) | Val  Loss: 1.4358 | Val  Acc: 0.4239
 Site-White                     (6) | Val  Loss: 1.3774 | Val  Acc: 0.4784
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4704 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4956 | Val  Acc: 0.4029
 Site-Black                     (1) | Val  Loss: 1.4339 | Val  Acc: 0.4891
 Site-Black                     (5) | Val  Loss: 1.5397 | Val  Acc: 0.3993
 Site-East_Asian                (0) | Val  Loss: 1.2887 | Val  Acc: 0.5326
 Site-East_Asian                (0) | Val  Loss: 1.3161 | Val  Acc: 0.5144
 Site-Indian                    (2) | Val  Loss: 1.5330 | Val  Acc: 0.3804
 Site-Indian                    (2) | Val  Loss: 1.4691 | Val  Acc: 0.4209
 Site-Southeast_Asian           (0) | Val  Loss: 1.3950 | Val  Acc: 0.4130
 Site-Southeast_Asian           (2) | Val  Loss: 1.3958 | Val  Acc: 0.4532
 Site-Middle_Eastern            (4) | Val  Loss: 1.4406 | Val  Acc: 0.4783
 Site-Middle_Eastern            (4) | Val  Loss: 1.4130 | Val  Acc: 0.4604
Average Valid Accuracy: 0.4487
============ Train epoch 18 ============
cnt=[3, 1, 4, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-White                    | Train Loss: 1.4178 | Train Acc: 0.4676
 Site-White                    | Train Loss: 1.3305 | Train Acc: 0.4412
 Site-Latino_Hispanic          | Train Loss: 1.5536 | Train Acc: 0.4460
 Site-Latino_Hispanic          | Train Loss: 1.3819 | Train Acc: 0.4293
 Site-Black                    | Train Loss: 1.7304 | Train Acc: 0.3381
 Site-Black                    | Train Loss: 1.5303 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.4209 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.2925 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.3962 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.4722 | Train Acc: 0.4077
 Site-Southeast_Asian          | Train Loss: 1.4580 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.4170 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.4921 | Train Acc: 0.4101
 Site-Middle_Eastern           | Train Loss: 1.4585 | Train Acc: 0.4940
 Site-White                     (6) | Val  Loss: 1.3948 | Val  Acc: 0.4348
 Site-White                     (0) | Val  Loss: 1.3992 | Val  Acc: 0.4460
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4731 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4712 | Val  Acc: 0.4209
 Site-Black                     (4) | Val  Loss: 1.4048 | Val  Acc: 0.4783
 Site-Black                     (4) | Val  Loss: 1.5919 | Val  Acc: 0.3705
 Site-East_Asian                (5) | Val  Loss: 1.2860 | Val  Acc: 0.5109
 Site-East_Asian                (5) | Val  Loss: 1.3386 | Val  Acc: 0.5000
 Site-Indian                    (3) | Val  Loss: 1.5266 | Val  Acc: 0.3152
 Site-Indian                    (1) | Val  Loss: 1.4628 | Val  Acc: 0.3993
 Site-Southeast_Asian           (2) | Val  Loss: 1.3964 | Val  Acc: 0.4457
 Site-Southeast_Asian           (2) | Val  Loss: 1.3850 | Val  Acc: 0.4676
 Site-Middle_Eastern            (0) | Val  Loss: 1.3817 | Val  Acc: 0.5435
 Site-Middle_Eastern            (0) | Val  Loss: 1.4224 | Val  Acc: 0.4317
Average Valid Accuracy: 0.4420
============ Train epoch 19 ============
cnt=[1, 2, 3, 2, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-White                    | Train Loss: 1.3728 | Train Acc: 0.4892
 Site-White                    | Train Loss: 1.3527 | Train Acc: 0.5012
 Site-Latino_Hispanic          | Train Loss: 1.5448 | Train Acc: 0.4388
 Site-Latino_Hispanic          | Train Loss: 1.4406 | Train Acc: 0.4221
 Site-Black                    | Train Loss: 1.6890 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.5815 | Train Acc: 0.3765
 Site-East_Asian               | Train Loss: 1.3822 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.4094 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.3374 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.5159 | Train Acc: 0.4029
 Site-Southeast_Asian          | Train Loss: 1.4595 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.5105 | Train Acc: 0.4580
 Site-Middle_Eastern           | Train Loss: 1.4306 | Train Acc: 0.4029
 Site-Middle_Eastern           | Train Loss: 1.3232 | Train Acc: 0.4964
 Site-White                     (5) | Val  Loss: 1.3755 | Val  Acc: 0.4674
 Site-White                     (5) | Val  Loss: 1.4058 | Val  Acc: 0.4712
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4563 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4571 | Val  Acc: 0.4317
 Site-Black                     (1) | Val  Loss: 1.4441 | Val  Acc: 0.4348
 Site-Black                     (1) | Val  Loss: 1.5347 | Val  Acc: 0.4209
 Site-East_Asian                (2) | Val  Loss: 1.2678 | Val  Acc: 0.5543
 Site-East_Asian                (0) | Val  Loss: 1.3422 | Val  Acc: 0.5180
 Site-Indian                    (6) | Val  Loss: 1.4964 | Val  Acc: 0.3478
 Site-Indian                    (6) | Val  Loss: 1.4564 | Val  Acc: 0.4388
 Site-Southeast_Asian           (2) | Val  Loss: 1.4129 | Val  Acc: 0.5000
 Site-Southeast_Asian           (2) | Val  Loss: 1.4012 | Val  Acc: 0.4568
 Site-Middle_Eastern            (3) | Val  Loss: 1.3908 | Val  Acc: 0.4891
 Site-Middle_Eastern            (3) | Val  Loss: 1.3844 | Val  Acc: 0.4640
Average Valid Accuracy: 0.4608
 Best site-White                    (5)  | Epoch:19 | Val Acc: 0.4674
 Best site-White                    (5)  | Epoch:19 | Val Acc: 0.4712
 Best site-Latino_Hispanic          (6)  | Epoch:19 | Val Acc: 0.4565
 Best site-Latino_Hispanic          (4)  | Epoch:19 | Val Acc: 0.4317
 Best site-Black                    (1)  | Epoch:19 | Val Acc: 0.4348
 Best site-Black                    (1)  | Epoch:19 | Val Acc: 0.4209
 Best site-East_Asian               (2)  | Epoch:19 | Val Acc: 0.5543
 Best site-East_Asian               (0)  | Epoch:19 | Val Acc: 0.5180
 Best site-Indian                   (6)  | Epoch:19 | Val Acc: 0.3478
 Best site-Indian                   (6)  | Epoch:19 | Val Acc: 0.4388
 Best site-Southeast_Asian          (2)  | Epoch:19 | Val Acc: 0.5000
 Best site-Southeast_Asian          (2)  | Epoch:19 | Val Acc: 0.4568
 Best site-Middle_Eastern           (3)  | Epoch:19 | Val Acc: 0.4891
 Best site-Middle_Eastern           (3)  | Epoch:19 | Val Acc: 0.4640
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
 Test site-White                     (5)| Epoch:19 | Test Acc: 0.4385
 Test site-Latino_Hispanic           (6)| Epoch:19 | Test Acc: 0.3766
 Test site-Black                     (1)| Epoch:19 | Test Acc: 0.3344
 Test site-East_Asian                (2)| Epoch:19 | Test Acc: 0.4903
 Test site-Indian                    (6)| Epoch:19 | Test Acc: 0.3493
 Test site-Southeast_Asian           (2)| Epoch:19 | Test Acc: 0.4259
 Test site-Middle_Eastern            (3)| Epoch:19 | Test Acc: 0.4278
White: 0.4385, Latino_Hispanic: 0.3766, Black: 0.3344, East_Asian: 0.4903, Indian: 0.3493, Southeast_Asian: 0.4259, Middle_Eastern: 0.4278, 
Average Test Accuracy: 0.4061, domain std=0.0510, cluster std=nan, individual std=0.0510, 
============ Train epoch 20 ============
cnt=[3, 2, 2, 1, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-White                    | Train Loss: 1.3973 | Train Acc: 0.4604
 Site-White                    | Train Loss: 1.3070 | Train Acc: 0.5036
 Site-Latino_Hispanic          | Train Loss: 1.5739 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.4821 | Train Acc: 0.4365
 Site-Black                    | Train Loss: 1.6177 | Train Acc: 0.4101
 Site-Black                    | Train Loss: 1.5093 | Train Acc: 0.4029
 Site-East_Asian               | Train Loss: 1.4056 | Train Acc: 0.4029
 Site-East_Asian               | Train Loss: 1.4466 | Train Acc: 0.4844
 Site-Indian                   | Train Loss: 1.3299 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.4270 | Train Acc: 0.4245
 Site-Southeast_Asian          | Train Loss: 1.4445 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.4755 | Train Acc: 0.4676
 Site-Middle_Eastern           | Train Loss: 1.4265 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.3126 | Train Acc: 0.4700
 Site-White                     (0) | Val  Loss: 1.4162 | Val  Acc: 0.4674
 Site-White                     (3) | Val  Loss: 1.3682 | Val  Acc: 0.5036
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4721 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4568 | Val  Acc: 0.4317
 Site-Black                     (4) | Val  Loss: 1.3857 | Val  Acc: 0.4891
 Site-Black                     (4) | Val  Loss: 1.4985 | Val  Acc: 0.4353
 Site-East_Asian                (6) | Val  Loss: 1.2816 | Val  Acc: 0.5326
 Site-East_Asian                (2) | Val  Loss: 1.3420 | Val  Acc: 0.5180
 Site-Indian                    (1) | Val  Loss: 1.5210 | Val  Acc: 0.3696
 Site-Indian                    (1) | Val  Loss: 1.4598 | Val  Acc: 0.4173
 Site-Southeast_Asian           (2) | Val  Loss: 1.4207 | Val  Acc: 0.4348
 Site-Southeast_Asian           (5) | Val  Loss: 1.3977 | Val  Acc: 0.4856
 Site-Middle_Eastern            (0) | Val  Loss: 1.3856 | Val  Acc: 0.5000
 Site-Middle_Eastern            (0) | Val  Loss: 1.3901 | Val  Acc: 0.4784
Average Valid Accuracy: 0.4618
 Best site-White                    (0)  | Epoch:20 | Val Acc: 0.4674
 Best site-White                    (3)  | Epoch:20 | Val Acc: 0.5036
 Best site-Latino_Hispanic          (5)  | Epoch:20 | Val Acc: 0.4022
 Best site-Latino_Hispanic          (5)  | Epoch:20 | Val Acc: 0.4317
 Best site-Black                    (4)  | Epoch:20 | Val Acc: 0.4891
 Best site-Black                    (4)  | Epoch:20 | Val Acc: 0.4353
 Best site-East_Asian               (6)  | Epoch:20 | Val Acc: 0.5326
 Best site-East_Asian               (2)  | Epoch:20 | Val Acc: 0.5180
 Best site-Indian                   (1)  | Epoch:20 | Val Acc: 0.3696
 Best site-Indian                   (1)  | Epoch:20 | Val Acc: 0.4173
 Best site-Southeast_Asian          (2)  | Epoch:20 | Val Acc: 0.4348
 Best site-Southeast_Asian          (5)  | Epoch:20 | Val Acc: 0.4856
 Best site-Middle_Eastern           (0)  | Epoch:20 | Val Acc: 0.5000
 Best site-Middle_Eastern           (0)  | Epoch:20 | Val Acc: 0.4784
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 21 ============
cnt=[4, 5, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-White                    | Train Loss: 1.3236 | Train Acc: 0.4892
 Site-White                    | Train Loss: 1.3304 | Train Acc: 0.4892
 Site-Latino_Hispanic          | Train Loss: 1.5521 | Train Acc: 0.4388
 Site-Latino_Hispanic          | Train Loss: 1.4613 | Train Acc: 0.4221
 Site-Black                    | Train Loss: 1.6780 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.5631 | Train Acc: 0.4053
 Site-East_Asian               | Train Loss: 1.4006 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.2428 | Train Acc: 0.4988
 Site-Indian                   | Train Loss: 1.3100 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.5273 | Train Acc: 0.4173
 Site-Southeast_Asian          | Train Loss: 1.3959 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.4280 | Train Acc: 0.4724
 Site-Middle_Eastern           | Train Loss: 1.4761 | Train Acc: 0.4676
 Site-Middle_Eastern           | Train Loss: 1.3296 | Train Acc: 0.5012
 Site-White                     (0) | Val  Loss: 1.3404 | Val  Acc: 0.5109
 Site-White                     (0) | Val  Loss: 1.3726 | Val  Acc: 0.4640
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4630 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4792 | Val  Acc: 0.3993
 Site-Black                     (6) | Val  Loss: 1.3324 | Val  Acc: 0.5109
 Site-Black                     (2) | Val  Loss: 1.4945 | Val  Acc: 0.3849
 Site-East_Asian                (3) | Val  Loss: 1.2504 | Val  Acc: 0.4783
 Site-East_Asian                (5) | Val  Loss: 1.3354 | Val  Acc: 0.4784
 Site-Indian                    (1) | Val  Loss: 1.5382 | Val  Acc: 0.3587
 Site-Indian                    (1) | Val  Loss: 1.4459 | Val  Acc: 0.4317
 Site-Southeast_Asian           (1) | Val  Loss: 1.4186 | Val  Acc: 0.4891
 Site-Southeast_Asian           (1) | Val  Loss: 1.3483 | Val  Acc: 0.5000
 Site-Middle_Eastern            (0) | Val  Loss: 1.3834 | Val  Acc: 0.4783
 Site-Middle_Eastern            (0) | Val  Loss: 1.3812 | Val  Acc: 0.4496
Average Valid Accuracy: 0.4526
============ Train epoch 22 ============
cnt=[2, 4, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-White                    | Train Loss: 1.3296 | Train Acc: 0.4676
 Site-White                    | Train Loss: 1.4028 | Train Acc: 0.4652
 Site-Latino_Hispanic          | Train Loss: 1.5295 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.3494 | Train Acc: 0.4293
 Site-Black                    | Train Loss: 1.6693 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.4839 | Train Acc: 0.3885
 Site-East_Asian               | Train Loss: 1.4139 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.3999 | Train Acc: 0.4772
 Site-Indian                   | Train Loss: 1.3623 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.3861 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.4396 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.3250 | Train Acc: 0.4844
 Site-Middle_Eastern           | Train Loss: 1.4416 | Train Acc: 0.4676
 Site-Middle_Eastern           | Train Loss: 1.3282 | Train Acc: 0.4820
 Site-White                     (0) | Val  Loss: 1.4036 | Val  Acc: 0.4565
 Site-White                     (0) | Val  Loss: 1.3905 | Val  Acc: 0.4640
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4282 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4397 | Val  Acc: 0.4353
 Site-Black                     (4) | Val  Loss: 1.3452 | Val  Acc: 0.5435
 Site-Black                     (4) | Val  Loss: 1.4911 | Val  Acc: 0.4245
 Site-East_Asian                (1) | Val  Loss: 1.2808 | Val  Acc: 0.5543
 Site-East_Asian                (6) | Val  Loss: 1.3262 | Val  Acc: 0.5000
 Site-Indian                    (2) | Val  Loss: 1.5105 | Val  Acc: 0.3696
 Site-Indian                    (2) | Val  Loss: 1.4258 | Val  Acc: 0.4353
 Site-Southeast_Asian           (1) | Val  Loss: 1.3619 | Val  Acc: 0.5000
 Site-Southeast_Asian           (1) | Val  Loss: 1.3792 | Val  Acc: 0.4532
 Site-Middle_Eastern            (3) | Val  Loss: 1.3789 | Val  Acc: 0.5109
 Site-Middle_Eastern            (3) | Val  Loss: 1.4075 | Val  Acc: 0.4460
Average Valid Accuracy: 0.4655
 Best site-White                    (0)  | Epoch:22 | Val Acc: 0.4565
 Best site-White                    (0)  | Epoch:22 | Val Acc: 0.4640
 Best site-Latino_Hispanic          (5)  | Epoch:22 | Val Acc: 0.4239
 Best site-Latino_Hispanic          (1)  | Epoch:22 | Val Acc: 0.4353
 Best site-Black                    (4)  | Epoch:22 | Val Acc: 0.5435
 Best site-Black                    (4)  | Epoch:22 | Val Acc: 0.4245
 Best site-East_Asian               (1)  | Epoch:22 | Val Acc: 0.5543
 Best site-East_Asian               (6)  | Epoch:22 | Val Acc: 0.5000
 Best site-Indian                   (2)  | Epoch:22 | Val Acc: 0.3696
 Best site-Indian                   (2)  | Epoch:22 | Val Acc: 0.4353
 Best site-Southeast_Asian          (1)  | Epoch:22 | Val Acc: 0.5000
 Best site-Southeast_Asian          (1)  | Epoch:22 | Val Acc: 0.4532
 Best site-Middle_Eastern           (3)  | Epoch:22 | Val Acc: 0.5109
 Best site-Middle_Eastern           (3)  | Epoch:22 | Val Acc: 0.4460
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 23 ============
cnt=[2, 2, 3, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-White                    | Train Loss: 1.3382 | Train Acc: 0.5108
 Site-White                    | Train Loss: 1.3092 | Train Acc: 0.4556
 Site-Latino_Hispanic          | Train Loss: 1.5077 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.4475 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.6256 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.4999 | Train Acc: 0.3861
 Site-East_Asian               | Train Loss: 1.3766 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3595 | Train Acc: 0.4964
 Site-Indian                   | Train Loss: 1.3283 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.4129 | Train Acc: 0.3933
 Site-Southeast_Asian          | Train Loss: 1.4895 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.4354 | Train Acc: 0.4724
 Site-Middle_Eastern           | Train Loss: 1.3460 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.5371 | Train Acc: 0.4748
 Site-White                     (2) | Val  Loss: 1.3470 | Val  Acc: 0.4891
 Site-White                     (6) | Val  Loss: 1.3704 | Val  Acc: 0.4748
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4635 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4250 | Val  Acc: 0.4424
 Site-Black                     (1) | Val  Loss: 1.3583 | Val  Acc: 0.5217
 Site-Black                     (1) | Val  Loss: 1.4858 | Val  Acc: 0.4532
 Site-East_Asian                (5) | Val  Loss: 1.2292 | Val  Acc: 0.5761
 Site-East_Asian                (5) | Val  Loss: 1.2965 | Val  Acc: 0.4928
 Site-Indian                    (3) | Val  Loss: 1.5549 | Val  Acc: 0.4130
 Site-Indian                    (3) | Val  Loss: 1.4561 | Val  Acc: 0.4424
 Site-Southeast_Asian           (4) | Val  Loss: 1.3901 | Val  Acc: 0.4565
 Site-Southeast_Asian           (4) | Val  Loss: 1.3568 | Val  Acc: 0.4748
 Site-Middle_Eastern            (2) | Val  Loss: 1.4019 | Val  Acc: 0.5000
 Site-Middle_Eastern            (2) | Val  Loss: 1.3833 | Val  Acc: 0.4496
Average Valid Accuracy: 0.4737
 Best site-White                    (2)  | Epoch:23 | Val Acc: 0.4891
 Best site-White                    (6)  | Epoch:23 | Val Acc: 0.4748
 Best site-Latino_Hispanic          (0)  | Epoch:23 | Val Acc: 0.4457
 Best site-Latino_Hispanic          (0)  | Epoch:23 | Val Acc: 0.4424
 Best site-Black                    (1)  | Epoch:23 | Val Acc: 0.5217
 Best site-Black                    (1)  | Epoch:23 | Val Acc: 0.4532
 Best site-East_Asian               (5)  | Epoch:23 | Val Acc: 0.5761
 Best site-East_Asian               (5)  | Epoch:23 | Val Acc: 0.4928
 Best site-Indian                   (3)  | Epoch:23 | Val Acc: 0.4130
 Best site-Indian                   (3)  | Epoch:23 | Val Acc: 0.4424
 Best site-Southeast_Asian          (4)  | Epoch:23 | Val Acc: 0.4565
 Best site-Southeast_Asian          (4)  | Epoch:23 | Val Acc: 0.4748
 Best site-Middle_Eastern           (2)  | Epoch:23 | Val Acc: 0.5000
 Best site-Middle_Eastern           (2)  | Epoch:23 | Val Acc: 0.4496
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 24 ============
cnt=[1, 2, 3, 2, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-White                    | Train Loss: 1.3915 | Train Acc: 0.4892
 Site-White                    | Train Loss: 1.3134 | Train Acc: 0.4748
 Site-Latino_Hispanic          | Train Loss: 1.5072 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.4151 | Train Acc: 0.4341
 Site-Black                    | Train Loss: 1.5858 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.5380 | Train Acc: 0.3957
 Site-East_Asian               | Train Loss: 1.3513 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.3369 | Train Acc: 0.5060
 Site-Indian                   | Train Loss: 1.3215 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.4330 | Train Acc: 0.4197
 Site-Southeast_Asian          | Train Loss: 1.4052 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.4012 | Train Acc: 0.4700
 Site-Middle_Eastern           | Train Loss: 1.3705 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.3539 | Train Acc: 0.4964
 Site-White                     (2) | Val  Loss: 1.3612 | Val  Acc: 0.4565
 Site-White                     (2) | Val  Loss: 1.3832 | Val  Acc: 0.4784
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4638 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4375 | Val  Acc: 0.3993
 Site-Black                     (4) | Val  Loss: 1.3436 | Val  Acc: 0.5109
 Site-Black                     (5) | Val  Loss: 1.4930 | Val  Acc: 0.4460
 Site-East_Asian                (6) | Val  Loss: 1.2408 | Val  Acc: 0.5109
 Site-East_Asian                (1) | Val  Loss: 1.3061 | Val  Acc: 0.5324
 Site-Indian                    (4) | Val  Loss: 1.4865 | Val  Acc: 0.3587
 Site-Indian                    (4) | Val  Loss: 1.4467 | Val  Acc: 0.4317
 Site-Southeast_Asian           (1) | Val  Loss: 1.4025 | Val  Acc: 0.4565
 Site-Southeast_Asian           (6) | Val  Loss: 1.3492 | Val  Acc: 0.4856
 Site-Middle_Eastern            (3) | Val  Loss: 1.3462 | Val  Acc: 0.5217
 Site-Middle_Eastern            (3) | Val  Loss: 1.3383 | Val  Acc: 0.4712
Average Valid Accuracy: 0.4647
============ Train epoch 25 ============
cnt=[2, 3, 1, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-White                    | Train Loss: 1.3522 | Train Acc: 0.4532
 Site-White                    | Train Loss: 1.3961 | Train Acc: 0.4844
 Site-Latino_Hispanic          | Train Loss: 1.5019 | Train Acc: 0.3885
 Site-Latino_Hispanic          | Train Loss: 1.4486 | Train Acc: 0.4365
 Site-Black                    | Train Loss: 1.6391 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.5532 | Train Acc: 0.4293
 Site-East_Asian               | Train Loss: 1.3935 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3088 | Train Acc: 0.4988
 Site-Indian                   | Train Loss: 1.4038 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.4289 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.4905 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.4179 | Train Acc: 0.4628
 Site-Middle_Eastern           | Train Loss: 1.3991 | Train Acc: 0.4245
 Site-Middle_Eastern           | Train Loss: 1.2902 | Train Acc: 0.4868
 Site-White                     (0) | Val  Loss: 1.3544 | Val  Acc: 0.4674
 Site-White                     (0) | Val  Loss: 1.3503 | Val  Acc: 0.4784
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4818 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4261 | Val  Acc: 0.4388
 Site-Black                     (5) | Val  Loss: 1.3258 | Val  Acc: 0.5217
 Site-Black                     (5) | Val  Loss: 1.4712 | Val  Acc: 0.4568
 Site-East_Asian                (2) | Val  Loss: 1.2440 | Val  Acc: 0.5326
 Site-East_Asian                (4) | Val  Loss: 1.2945 | Val  Acc: 0.5360
 Site-Indian                    (1) | Val  Loss: 1.4379 | Val  Acc: 0.3696
 Site-Indian                    (1) | Val  Loss: 1.4704 | Val  Acc: 0.4065
 Site-Southeast_Asian           (4) | Val  Loss: 1.3882 | Val  Acc: 0.4891
 Site-Southeast_Asian           (4) | Val  Loss: 1.3954 | Val  Acc: 0.4496
 Site-Middle_Eastern            (3) | Val  Loss: 1.3855 | Val  Acc: 0.5326
 Site-Middle_Eastern            (3) | Val  Loss: 1.3563 | Val  Acc: 0.4784
Average Valid Accuracy: 0.4686
============ Train epoch 26 ============
cnt=[2, 2, 3, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-White                    | Train Loss: 1.3570 | Train Acc: 0.5180
 Site-White                    | Train Loss: 1.2975 | Train Acc: 0.4796
 Site-Latino_Hispanic          | Train Loss: 1.5462 | Train Acc: 0.4173
 Site-Latino_Hispanic          | Train Loss: 1.5446 | Train Acc: 0.4460
 Site-Black                    | Train Loss: 1.5970 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.4848 | Train Acc: 0.3957
 Site-East_Asian               | Train Loss: 1.3283 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.2636 | Train Acc: 0.5084
 Site-Indian                   | Train Loss: 1.3214 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.4695 | Train Acc: 0.4149
 Site-Southeast_Asian          | Train Loss: 1.4670 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.3658 | Train Acc: 0.4796
 Site-Middle_Eastern           | Train Loss: 1.3741 | Train Acc: 0.4676
 Site-Middle_Eastern           | Train Loss: 1.3026 | Train Acc: 0.4796
 Site-White                     (2) | Val  Loss: 1.3915 | Val  Acc: 0.4457
 Site-White                     (2) | Val  Loss: 1.3473 | Val  Acc: 0.4820
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4480 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4119 | Val  Acc: 0.4173
 Site-Black                     (3) | Val  Loss: 1.3191 | Val  Acc: 0.5543
 Site-Black                     (3) | Val  Loss: 1.4421 | Val  Acc: 0.4532
 Site-East_Asian                (0) | Val  Loss: 1.2323 | Val  Acc: 0.5217
 Site-East_Asian                (0) | Val  Loss: 1.3205 | Val  Acc: 0.5036
 Site-Indian                    (1) | Val  Loss: 1.4827 | Val  Acc: 0.3478
 Site-Indian                    (1) | Val  Loss: 1.4271 | Val  Acc: 0.4173
 Site-Southeast_Asian           (6) | Val  Loss: 1.3740 | Val  Acc: 0.4457
 Site-Southeast_Asian           (6) | Val  Loss: 1.3722 | Val  Acc: 0.4784
 Site-Middle_Eastern            (4) | Val  Loss: 1.3316 | Val  Acc: 0.5109
 Site-Middle_Eastern            (4) | Val  Loss: 1.3489 | Val  Acc: 0.4532
Average Valid Accuracy: 0.4603
============ Train epoch 27 ============
cnt=[3, 2, 2, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-White                    | Train Loss: 1.3520 | Train Acc: 0.5324
 Site-White                    | Train Loss: 1.3095 | Train Acc: 0.4748
 Site-Latino_Hispanic          | Train Loss: 1.5368 | Train Acc: 0.4388
 Site-Latino_Hispanic          | Train Loss: 1.4694 | Train Acc: 0.4436
 Site-Black                    | Train Loss: 1.5991 | Train Acc: 0.3525
 Site-Black                    | Train Loss: 1.5172 | Train Acc: 0.4125
 Site-East_Asian               | Train Loss: 1.4099 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3000 | Train Acc: 0.4940
 Site-Indian                   | Train Loss: 1.3362 | Train Acc: 0.5036
 Site-Indian                   | Train Loss: 1.4240 | Train Acc: 0.4293
 Site-Southeast_Asian          | Train Loss: 1.3612 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.3975 | Train Acc: 0.5012
 Site-Middle_Eastern           | Train Loss: 1.3759 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.2533 | Train Acc: 0.5036
 Site-White                     (1) | Val  Loss: 1.3491 | Val  Acc: 0.4891
 Site-White                     (1) | Val  Loss: 1.3340 | Val  Acc: 0.5072
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3903 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4141 | Val  Acc: 0.4317
 Site-Black                     (3) | Val  Loss: 1.3482 | Val  Acc: 0.5761
 Site-Black                     (3) | Val  Loss: 1.4494 | Val  Acc: 0.4676
 Site-East_Asian                (4) | Val  Loss: 1.2527 | Val  Acc: 0.5326
 Site-East_Asian                (4) | Val  Loss: 1.3082 | Val  Acc: 0.5252
 Site-Indian                    (0) | Val  Loss: 1.4781 | Val  Acc: 0.3804
 Site-Indian                    (0) | Val  Loss: 1.4019 | Val  Acc: 0.4460
 Site-Southeast_Asian           (6) | Val  Loss: 1.3728 | Val  Acc: 0.5109
 Site-Southeast_Asian           (6) | Val  Loss: 1.3421 | Val  Acc: 0.4892
 Site-Middle_Eastern            (2) | Val  Loss: 1.3739 | Val  Acc: 0.4891
 Site-Middle_Eastern            (2) | Val  Loss: 1.3342 | Val  Acc: 0.4784
Average Valid Accuracy: 0.4851
 Best site-White                    (1)  | Epoch:27 | Val Acc: 0.4891
 Best site-White                    (1)  | Epoch:27 | Val Acc: 0.5072
 Best site-Latino_Hispanic          (5)  | Epoch:27 | Val Acc: 0.4674
 Best site-Latino_Hispanic          (0)  | Epoch:27 | Val Acc: 0.4317
 Best site-Black                    (3)  | Epoch:27 | Val Acc: 0.5761
 Best site-Black                    (3)  | Epoch:27 | Val Acc: 0.4676
 Best site-East_Asian               (4)  | Epoch:27 | Val Acc: 0.5326
 Best site-East_Asian               (4)  | Epoch:27 | Val Acc: 0.5252
 Best site-Indian                   (0)  | Epoch:27 | Val Acc: 0.3804
 Best site-Indian                   (0)  | Epoch:27 | Val Acc: 0.4460
 Best site-Southeast_Asian          (6)  | Epoch:27 | Val Acc: 0.5109
 Best site-Southeast_Asian          (6)  | Epoch:27 | Val Acc: 0.4892
 Best site-Middle_Eastern           (2)  | Epoch:27 | Val Acc: 0.4891
 Best site-Middle_Eastern           (2)  | Epoch:27 | Val Acc: 0.4784
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 28 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-White                    | Train Loss: 1.3945 | Train Acc: 0.5252
 Site-White                    | Train Loss: 1.3552 | Train Acc: 0.4700
 Site-Latino_Hispanic          | Train Loss: 1.5716 | Train Acc: 0.4317
 Site-Latino_Hispanic          | Train Loss: 1.4268 | Train Acc: 0.4221
 Site-Black                    | Train Loss: 1.5662 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.5510 | Train Acc: 0.4412
 Site-East_Asian               | Train Loss: 1.4240 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.2695 | Train Acc: 0.5012
 Site-Indian                   | Train Loss: 1.3149 | Train Acc: 0.5036
 Site-Indian                   | Train Loss: 1.4217 | Train Acc: 0.4173
 Site-Southeast_Asian          | Train Loss: 1.3756 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.4132 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.3119 | Train Acc: 0.4317
 Site-Middle_Eastern           | Train Loss: 1.3127 | Train Acc: 0.4988
 Site-White                     (3) | Val  Loss: 1.3493 | Val  Acc: 0.4565
 Site-White                     (3) | Val  Loss: 1.3244 | Val  Acc: 0.5000
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3997 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4166 | Val  Acc: 0.4065
 Site-Black                     (0) | Val  Loss: 1.3086 | Val  Acc: 0.5543
 Site-Black                     (0) | Val  Loss: 1.4729 | Val  Acc: 0.4496
 Site-East_Asian                (1) | Val  Loss: 1.2053 | Val  Acc: 0.5326
 Site-East_Asian                (1) | Val  Loss: 1.2737 | Val  Acc: 0.5576
 Site-Indian                    (2) | Val  Loss: 1.4793 | Val  Acc: 0.3696
 Site-Indian                    (2) | Val  Loss: 1.4002 | Val  Acc: 0.4640
 Site-Southeast_Asian           (6) | Val  Loss: 1.3509 | Val  Acc: 0.4565
 Site-Southeast_Asian           (6) | Val  Loss: 1.3522 | Val  Acc: 0.4856
 Site-Middle_Eastern            (4) | Val  Loss: 1.4030 | Val  Acc: 0.4891
 Site-Middle_Eastern            (4) | Val  Loss: 1.3622 | Val  Acc: 0.4712
Average Valid Accuracy: 0.4750
============ Train epoch 29 ============
cnt=[1, 2, 1, 3, 2, 2, 3, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-White                    | Train Loss: 1.3716 | Train Acc: 0.5180
 Site-White                    | Train Loss: 1.2589 | Train Acc: 0.5084
 Site-Latino_Hispanic          | Train Loss: 1.5382 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.3615 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.5964 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.4717 | Train Acc: 0.4341
 Site-East_Asian               | Train Loss: 1.3727 | Train Acc: 0.4892
 Site-East_Asian               | Train Loss: 1.3547 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.3844 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.4490 | Train Acc: 0.4412
 Site-Southeast_Asian          | Train Loss: 1.4083 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.3386 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.4047 | Train Acc: 0.4173
 Site-Middle_Eastern           | Train Loss: 1.3058 | Train Acc: 0.4700
 Site-White                     (3) | Val  Loss: 1.3594 | Val  Acc: 0.4348
 Site-White                     (2) | Val  Loss: 1.3192 | Val  Acc: 0.5180
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4672 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3937 | Val  Acc: 0.4496
 Site-Black                     (5) | Val  Loss: 1.3170 | Val  Acc: 0.5761
 Site-Black                     (5) | Val  Loss: 1.4664 | Val  Acc: 0.4820
 Site-East_Asian                (6) | Val  Loss: 1.2476 | Val  Acc: 0.5435
 Site-East_Asian                (6) | Val  Loss: 1.3081 | Val  Acc: 0.5252
 Site-Indian                    (1) | Val  Loss: 1.4324 | Val  Acc: 0.3804
 Site-Indian                    (1) | Val  Loss: 1.3982 | Val  Acc: 0.4101
 Site-Southeast_Asian           (0) | Val  Loss: 1.3456 | Val  Acc: 0.5000
 Site-Southeast_Asian           (6) | Val  Loss: 1.3736 | Val  Acc: 0.4748
 Site-Middle_Eastern            (4) | Val  Loss: 1.3598 | Val  Acc: 0.5000
 Site-Middle_Eastern            (4) | Val  Loss: 1.3678 | Val  Acc: 0.4604
Average Valid Accuracy: 0.4786
============ Train epoch 30 ============
cnt=[3, 3, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-White                    | Train Loss: 1.3616 | Train Acc: 0.5036
 Site-White                    | Train Loss: 1.2848 | Train Acc: 0.5204
 Site-Latino_Hispanic          | Train Loss: 1.5590 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.3644 | Train Acc: 0.4508
 Site-Black                    | Train Loss: 1.5642 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.5153 | Train Acc: 0.4125
 Site-East_Asian               | Train Loss: 1.3512 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.3046 | Train Acc: 0.5228
 Site-Indian                   | Train Loss: 1.3580 | Train Acc: 0.4964
 Site-Indian                   | Train Loss: 1.4526 | Train Acc: 0.4317
 Site-Southeast_Asian          | Train Loss: 1.5004 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.4056 | Train Acc: 0.4964
 Site-Middle_Eastern           | Train Loss: 1.3293 | Train Acc: 0.5108
 Site-Middle_Eastern           | Train Loss: 1.2374 | Train Acc: 0.5180
 Site-White                     (3) | Val  Loss: 1.3215 | Val  Acc: 0.4783
 Site-White                     (2) | Val  Loss: 1.3029 | Val  Acc: 0.5288
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3972 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4075 | Val  Acc: 0.4424
 Site-Black                     (5) | Val  Loss: 1.3061 | Val  Acc: 0.5326
 Site-Black                     (5) | Val  Loss: 1.4681 | Val  Acc: 0.4568
 Site-East_Asian                (1) | Val  Loss: 1.2214 | Val  Acc: 0.5326
 Site-East_Asian                (4) | Val  Loss: 1.3061 | Val  Acc: 0.5288
 Site-Indian                    (0) | Val  Loss: 1.4680 | Val  Acc: 0.3261
 Site-Indian                    (0) | Val  Loss: 1.4314 | Val  Acc: 0.4388
 Site-Southeast_Asian           (1) | Val  Loss: 1.3924 | Val  Acc: 0.5000
 Site-Southeast_Asian           (1) | Val  Loss: 1.3658 | Val  Acc: 0.5036
 Site-Middle_Eastern            (2) | Val  Loss: 1.3984 | Val  Acc: 0.5000
 Site-Middle_Eastern            (6) | Val  Loss: 1.3457 | Val  Acc: 0.5036
Average Valid Accuracy: 0.4768
============ Train epoch 31 ============
cnt=[1, 2, 2, 4, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-White                    | Train Loss: 1.4054 | Train Acc: 0.4532
 Site-White                    | Train Loss: 1.2875 | Train Acc: 0.4868
 Site-Latino_Hispanic          | Train Loss: 1.5017 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.3427 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.6059 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.5236 | Train Acc: 0.4341
 Site-East_Asian               | Train Loss: 1.2885 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.3638 | Train Acc: 0.5204
 Site-Indian                   | Train Loss: 1.3771 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.4355 | Train Acc: 0.4412
 Site-Southeast_Asian          | Train Loss: 1.4933 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.3959 | Train Acc: 0.4868
 Site-Middle_Eastern           | Train Loss: 1.3446 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.2322 | Train Acc: 0.4892
 Site-White                     (3) | Val  Loss: 1.3699 | Val  Acc: 0.4348
 Site-White                     (3) | Val  Loss: 1.3128 | Val  Acc: 0.5108
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3925 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3889 | Val  Acc: 0.4604
 Site-Black                     (4) | Val  Loss: 1.3204 | Val  Acc: 0.5000
 Site-Black                     (0) | Val  Loss: 1.4831 | Val  Acc: 0.4101
 Site-East_Asian                (5) | Val  Loss: 1.2096 | Val  Acc: 0.5435
 Site-East_Asian                (6) | Val  Loss: 1.2813 | Val  Acc: 0.5324
 Site-Indian                    (4) | Val  Loss: 1.4490 | Val  Acc: 0.3804
 Site-Indian                    (4) | Val  Loss: 1.3921 | Val  Acc: 0.4317
 Site-Southeast_Asian           (1) | Val  Loss: 1.3272 | Val  Acc: 0.4674
 Site-Southeast_Asian           (1) | Val  Loss: 1.3679 | Val  Acc: 0.4928
 Site-Middle_Eastern            (3) | Val  Loss: 1.3942 | Val  Acc: 0.5217
 Site-Middle_Eastern            (3) | Val  Loss: 1.3398 | Val  Acc: 0.4820
Average Valid Accuracy: 0.4724
============ Train epoch 32 ============
cnt=[2, 5, 1, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-White                    | Train Loss: 1.3484 | Train Acc: 0.4964
 Site-White                    | Train Loss: 1.2369 | Train Acc: 0.5108
 Site-Latino_Hispanic          | Train Loss: 1.4732 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.3686 | Train Acc: 0.4460
 Site-Black                    | Train Loss: 1.5594 | Train Acc: 0.4388
 Site-Black                    | Train Loss: 1.4725 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.3201 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.3087 | Train Acc: 0.5060
 Site-Indian                   | Train Loss: 1.3438 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.4189 | Train Acc: 0.4484
 Site-Southeast_Asian          | Train Loss: 1.4345 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.3592 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.3469 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.3022 | Train Acc: 0.4844
 Site-White                     (4) | Val  Loss: 1.3248 | Val  Acc: 0.4783
 Site-White                     (1) | Val  Loss: 1.3088 | Val  Acc: 0.4892
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3816 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4075 | Val  Acc: 0.4496
 Site-Black                     (6) | Val  Loss: 1.3324 | Val  Acc: 0.5652
 Site-Black                     (2) | Val  Loss: 1.4638 | Val  Acc: 0.4604
 Site-East_Asian                (5) | Val  Loss: 1.2282 | Val  Acc: 0.5326
 Site-East_Asian                (5) | Val  Loss: 1.2759 | Val  Acc: 0.5216
 Site-Indian                    (1) | Val  Loss: 1.4279 | Val  Acc: 0.3804
 Site-Indian                    (1) | Val  Loss: 1.3901 | Val  Acc: 0.4424
 Site-Southeast_Asian           (3) | Val  Loss: 1.3839 | Val  Acc: 0.4348
 Site-Southeast_Asian           (3) | Val  Loss: 1.3067 | Val  Acc: 0.5000
 Site-Middle_Eastern            (0) | Val  Loss: 1.3592 | Val  Acc: 0.4674
 Site-Middle_Eastern            (0) | Val  Loss: 1.3425 | Val  Acc: 0.5144
Average Valid Accuracy: 0.4757
============ Train epoch 33 ============
cnt=[1, 2, 2, 3, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-White                    | Train Loss: 1.3782 | Train Acc: 0.4892
 Site-White                    | Train Loss: 1.2617 | Train Acc: 0.4916
 Site-Latino_Hispanic          | Train Loss: 1.5709 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.3827 | Train Acc: 0.4269
 Site-Black                    | Train Loss: 1.6267 | Train Acc: 0.4029
 Site-Black                    | Train Loss: 1.5094 | Train Acc: 0.4484
 Site-East_Asian               | Train Loss: 1.3490 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.3423 | Train Acc: 0.5132
 Site-Indian                   | Train Loss: 1.3176 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.5561 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.4412 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.4058 | Train Acc: 0.4916
 Site-Middle_Eastern           | Train Loss: 1.3709 | Train Acc: 0.4964
 Site-Middle_Eastern           | Train Loss: 1.2620 | Train Acc: 0.4964
 Site-White                     (1) | Val  Loss: 1.3101 | Val  Acc: 0.4891
 Site-White                     (1) | Val  Loss: 1.2973 | Val  Acc: 0.4892
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4028 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4004 | Val  Acc: 0.4353
 Site-Black                     (4) | Val  Loss: 1.3037 | Val  Acc: 0.5652
 Site-Black                     (0) | Val  Loss: 1.4876 | Val  Acc: 0.4173
 Site-East_Asian                (5) | Val  Loss: 1.1992 | Val  Acc: 0.5543
 Site-East_Asian                (5) | Val  Loss: 1.2878 | Val  Acc: 0.5324
 Site-Indian                    (6) | Val  Loss: 1.4639 | Val  Acc: 0.3696
 Site-Indian                    (6) | Val  Loss: 1.4069 | Val  Acc: 0.4496
 Site-Southeast_Asian           (2) | Val  Loss: 1.3644 | Val  Acc: 0.4891
 Site-Southeast_Asian           (2) | Val  Loss: 1.3440 | Val  Acc: 0.4964
 Site-Middle_Eastern            (3) | Val  Loss: 1.2980 | Val  Acc: 0.5543
 Site-Middle_Eastern            (3) | Val  Loss: 1.3338 | Val  Acc: 0.4784
Average Valid Accuracy: 0.4848
============ Train epoch 34 ============
cnt=[3, 3, 1, 2, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-White                    | Train Loss: 1.3617 | Train Acc: 0.4964
 Site-White                    | Train Loss: 1.2317 | Train Acc: 0.5036
 Site-Latino_Hispanic          | Train Loss: 1.4675 | Train Acc: 0.4532
 Site-Latino_Hispanic          | Train Loss: 1.4652 | Train Acc: 0.4221
 Site-Black                    | Train Loss: 1.5731 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.5430 | Train Acc: 0.4221
 Site-East_Asian               | Train Loss: 1.3859 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.3375 | Train Acc: 0.5084
 Site-Indian                   | Train Loss: 1.3252 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.3835 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.4793 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.5227 | Train Acc: 0.4724
 Site-Middle_Eastern           | Train Loss: 1.4348 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.2910 | Train Acc: 0.4868
 Site-White                     (6) | Val  Loss: 1.2926 | Val  Acc: 0.5109
 Site-White                     (6) | Val  Loss: 1.2896 | Val  Acc: 0.4964
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3959 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4278 | Val  Acc: 0.4317
 Site-Black                     (4) | Val  Loss: 1.2945 | Val  Acc: 0.5761
 Site-Black                     (2) | Val  Loss: 1.4606 | Val  Acc: 0.4640
 Site-East_Asian                (5) | Val  Loss: 1.2152 | Val  Acc: 0.5326
 Site-East_Asian                (5) | Val  Loss: 1.2761 | Val  Acc: 0.5360
 Site-Indian                    (0) | Val  Loss: 1.4631 | Val  Acc: 0.3478
 Site-Indian                    (1) | Val  Loss: 1.3980 | Val  Acc: 0.4065
 Site-Southeast_Asian           (0) | Val  Loss: 1.3439 | Val  Acc: 0.4783
 Site-Southeast_Asian           (0) | Val  Loss: 1.3386 | Val  Acc: 0.4928
 Site-Middle_Eastern            (3) | Val  Loss: 1.3060 | Val  Acc: 0.5652
 Site-Middle_Eastern            (3) | Val  Loss: 1.3250 | Val  Acc: 0.4748
Average Valid Accuracy: 0.4835
============ Train epoch 35 ============
cnt=[2, 2, 2, 1, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-White                    | Train Loss: 1.3108 | Train Acc: 0.5324
 Site-White                    | Train Loss: 1.3392 | Train Acc: 0.5132
 Site-Latino_Hispanic          | Train Loss: 1.5380 | Train Acc: 0.4388
 Site-Latino_Hispanic          | Train Loss: 1.4812 | Train Acc: 0.4388
 Site-Black                    | Train Loss: 1.6101 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.4246 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.3852 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.2979 | Train Acc: 0.5060
 Site-Indian                   | Train Loss: 1.3352 | Train Acc: 0.5324
 Site-Indian                   | Train Loss: 1.3708 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.4285 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.3685 | Train Acc: 0.4724
 Site-Middle_Eastern           | Train Loss: 1.4230 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.3274 | Train Acc: 0.5060
 Site-White                     (5) | Val  Loss: 1.3311 | Val  Acc: 0.4891
 Site-White                     (6) | Val  Loss: 1.2744 | Val  Acc: 0.5036
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4194 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4073 | Val  Acc: 0.4353
 Site-Black                     (4) | Val  Loss: 1.2972 | Val  Acc: 0.5217
 Site-Black                     (4) | Val  Loss: 1.4176 | Val  Acc: 0.5000
 Site-East_Asian                (0) | Val  Loss: 1.2227 | Val  Acc: 0.5652
 Site-East_Asian                (0) | Val  Loss: 1.2678 | Val  Acc: 0.5324
 Site-Indian                    (1) | Val  Loss: 1.4186 | Val  Acc: 0.3696
 Site-Indian                    (1) | Val  Loss: 1.3931 | Val  Acc: 0.4532
 Site-Southeast_Asian           (2) | Val  Loss: 1.3461 | Val  Acc: 0.5000
 Site-Southeast_Asian           (2) | Val  Loss: 1.3301 | Val  Acc: 0.5180
 Site-Middle_Eastern            (6) | Val  Loss: 1.3522 | Val  Acc: 0.5109
 Site-Middle_Eastern            (3) | Val  Loss: 1.3723 | Val  Acc: 0.4856
Average Valid Accuracy: 0.4871
 Best site-White                    (5)  | Epoch:35 | Val Acc: 0.4891
 Best site-White                    (6)  | Epoch:35 | Val Acc: 0.5036
 Best site-Latino_Hispanic          (5)  | Epoch:35 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (5)  | Epoch:35 | Val Acc: 0.4353
 Best site-Black                    (4)  | Epoch:35 | Val Acc: 0.5217
 Best site-Black                    (4)  | Epoch:35 | Val Acc: 0.5000
 Best site-East_Asian               (0)  | Epoch:35 | Val Acc: 0.5652
 Best site-East_Asian               (0)  | Epoch:35 | Val Acc: 0.5324
 Best site-Indian                   (1)  | Epoch:35 | Val Acc: 0.3696
 Best site-Indian                   (1)  | Epoch:35 | Val Acc: 0.4532
 Best site-Southeast_Asian          (2)  | Epoch:35 | Val Acc: 0.5000
 Best site-Southeast_Asian          (2)  | Epoch:35 | Val Acc: 0.5180
 Best site-Middle_Eastern           (6)  | Epoch:35 | Val Acc: 0.5109
 Best site-Middle_Eastern           (3)  | Epoch:35 | Val Acc: 0.4856
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 36 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-White                    | Train Loss: 1.3360 | Train Acc: 0.4964
 Site-White                    | Train Loss: 1.3252 | Train Acc: 0.4916
 Site-Latino_Hispanic          | Train Loss: 1.4493 | Train Acc: 0.4820
 Site-Latino_Hispanic          | Train Loss: 1.4671 | Train Acc: 0.4508
 Site-Black                    | Train Loss: 1.5275 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.3866 | Train Acc: 0.4772
 Site-East_Asian               | Train Loss: 1.3704 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.2806 | Train Acc: 0.5012
 Site-Indian                   | Train Loss: 1.3154 | Train Acc: 0.5324
 Site-Indian                   | Train Loss: 1.3293 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.4935 | Train Acc: 0.4317
 Site-Southeast_Asian          | Train Loss: 1.3269 | Train Acc: 0.4916
 Site-Middle_Eastern           | Train Loss: 1.3539 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.2139 | Train Acc: 0.5276
 Site-White                     (4) | Val  Loss: 1.2702 | Val  Acc: 0.5109
 Site-White                     (4) | Val  Loss: 1.3007 | Val  Acc: 0.4892
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3924 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4031 | Val  Acc: 0.4317
 Site-Black                     (5) | Val  Loss: 1.3171 | Val  Acc: 0.5543
 Site-Black                     (5) | Val  Loss: 1.4426 | Val  Acc: 0.4712
 Site-East_Asian                (3) | Val  Loss: 1.2069 | Val  Acc: 0.5217
 Site-East_Asian                (3) | Val  Loss: 1.2622 | Val  Acc: 0.5324
 Site-Indian                    (2) | Val  Loss: 1.4042 | Val  Acc: 0.4674
 Site-Indian                    (2) | Val  Loss: 1.3907 | Val  Acc: 0.4353
 Site-Southeast_Asian           (1) | Val  Loss: 1.3258 | Val  Acc: 0.4674
 Site-Southeast_Asian           (1) | Val  Loss: 1.3339 | Val  Acc: 0.5036
 Site-Middle_Eastern            (0) | Val  Loss: 1.3345 | Val  Acc: 0.4674
 Site-Middle_Eastern            (0) | Val  Loss: 1.3142 | Val  Acc: 0.4784
Average Valid Accuracy: 0.4817
============ Train epoch 37 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-White                    | Train Loss: 1.3861 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.2713 | Train Acc: 0.4820
 Site-Latino_Hispanic          | Train Loss: 1.5220 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.3419 | Train Acc: 0.4508
 Site-Black                    | Train Loss: 1.5414 | Train Acc: 0.4029
 Site-Black                    | Train Loss: 1.4203 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.3271 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.2771 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.3056 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.5281 | Train Acc: 0.4724
 Site-Southeast_Asian          | Train Loss: 1.4382 | Train Acc: 0.5108
 Site-Southeast_Asian          | Train Loss: 1.3527 | Train Acc: 0.4700
 Site-Middle_Eastern           | Train Loss: 1.3603 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.2452 | Train Acc: 0.5156
 Site-White                     (5) | Val  Loss: 1.2794 | Val  Acc: 0.5326
 Site-White                     (5) | Val  Loss: 1.2838 | Val  Acc: 0.4892
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4091 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3959 | Val  Acc: 0.4604
 Site-Black                     (3) | Val  Loss: 1.3249 | Val  Acc: 0.4674
 Site-Black                     (3) | Val  Loss: 1.4105 | Val  Acc: 0.4604
 Site-East_Asian                (6) | Val  Loss: 1.1677 | Val  Acc: 0.6087
 Site-East_Asian                (6) | Val  Loss: 1.2619 | Val  Acc: 0.5396
 Site-Indian                    (1) | Val  Loss: 1.4411 | Val  Acc: 0.4348
 Site-Indian                    (1) | Val  Loss: 1.3851 | Val  Acc: 0.4856
 Site-Southeast_Asian           (2) | Val  Loss: 1.3689 | Val  Acc: 0.4783
 Site-Southeast_Asian           (2) | Val  Loss: 1.3361 | Val  Acc: 0.4640
 Site-Middle_Eastern            (4) | Val  Loss: 1.3505 | Val  Acc: 0.5217
 Site-Middle_Eastern            (4) | Val  Loss: 1.3353 | Val  Acc: 0.4784
Average Valid Accuracy: 0.4897
 Best site-White                    (5)  | Epoch:37 | Val Acc: 0.5326
 Best site-White                    (5)  | Epoch:37 | Val Acc: 0.4892
 Best site-Latino_Hispanic          (0)  | Epoch:37 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (0)  | Epoch:37 | Val Acc: 0.4604
 Best site-Black                    (3)  | Epoch:37 | Val Acc: 0.4674
 Best site-Black                    (3)  | Epoch:37 | Val Acc: 0.4604
 Best site-East_Asian               (6)  | Epoch:37 | Val Acc: 0.6087
 Best site-East_Asian               (6)  | Epoch:37 | Val Acc: 0.5396
 Best site-Indian                   (1)  | Epoch:37 | Val Acc: 0.4348
 Best site-Indian                   (1)  | Epoch:37 | Val Acc: 0.4856
 Best site-Southeast_Asian          (2)  | Epoch:37 | Val Acc: 0.4783
 Best site-Southeast_Asian          (2)  | Epoch:37 | Val Acc: 0.4640
 Best site-Middle_Eastern           (4)  | Epoch:37 | Val Acc: 0.5217
 Best site-Middle_Eastern           (4)  | Epoch:37 | Val Acc: 0.4784
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 38 ============
cnt=[2, 2, 1, 3, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-White                    | Train Loss: 1.3542 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.2835 | Train Acc: 0.4964
 Site-Latino_Hispanic          | Train Loss: 1.5049 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.5243 | Train Acc: 0.4484
 Site-Black                    | Train Loss: 1.5782 | Train Acc: 0.4317
 Site-Black                    | Train Loss: 1.4503 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.3577 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.2228 | Train Acc: 0.4988
 Site-Indian                   | Train Loss: 1.2988 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.4378 | Train Acc: 0.4628
 Site-Southeast_Asian          | Train Loss: 1.4327 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.3285 | Train Acc: 0.4868
 Site-Middle_Eastern           | Train Loss: 1.3951 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.2700 | Train Acc: 0.5180
 Site-White                     (3) | Val  Loss: 1.3598 | Val  Acc: 0.4457
 Site-White                     (3) | Val  Loss: 1.3008 | Val  Acc: 0.4928
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4125 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3991 | Val  Acc: 0.4784
 Site-Black                     (2) | Val  Loss: 1.2437 | Val  Acc: 0.6196
 Site-Black                     (6) | Val  Loss: 1.4160 | Val  Acc: 0.4388
 Site-East_Asian                (5) | Val  Loss: 1.1938 | Val  Acc: 0.5761
 Site-East_Asian                (5) | Val  Loss: 1.2432 | Val  Acc: 0.5360
 Site-Indian                    (4) | Val  Loss: 1.4259 | Val  Acc: 0.4239
 Site-Indian                    (4) | Val  Loss: 1.3770 | Val  Acc: 0.4676
 Site-Southeast_Asian           (0) | Val  Loss: 1.3402 | Val  Acc: 0.4565
 Site-Southeast_Asian           (5) | Val  Loss: 1.3181 | Val  Acc: 0.5180
 Site-Middle_Eastern            (1) | Val  Loss: 1.3531 | Val  Acc: 0.5543
 Site-Middle_Eastern            (1) | Val  Loss: 1.3391 | Val  Acc: 0.4820
Average Valid Accuracy: 0.4946
 Best site-White                    (3)  | Epoch:38 | Val Acc: 0.4457
 Best site-White                    (3)  | Epoch:38 | Val Acc: 0.4928
 Best site-Latino_Hispanic          (3)  | Epoch:38 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (0)  | Epoch:38 | Val Acc: 0.4784
 Best site-Black                    (2)  | Epoch:38 | Val Acc: 0.6196
 Best site-Black                    (6)  | Epoch:38 | Val Acc: 0.4388
 Best site-East_Asian               (5)  | Epoch:38 | Val Acc: 0.5761
 Best site-East_Asian               (5)  | Epoch:38 | Val Acc: 0.5360
 Best site-Indian                   (4)  | Epoch:38 | Val Acc: 0.4239
 Best site-Indian                   (4)  | Epoch:38 | Val Acc: 0.4676
 Best site-Southeast_Asian          (0)  | Epoch:38 | Val Acc: 0.4565
 Best site-Southeast_Asian          (5)  | Epoch:38 | Val Acc: 0.5180
 Best site-Middle_Eastern           (1)  | Epoch:38 | Val Acc: 0.5543
 Best site-Middle_Eastern           (1)  | Epoch:38 | Val Acc: 0.4820
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 39 ============
cnt=[1, 2, 1, 5, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-White                    | Train Loss: 1.4233 | Train Acc: 0.4820
 Site-White                    | Train Loss: 1.2703 | Train Acc: 0.5300
 Site-Latino_Hispanic          | Train Loss: 1.4758 | Train Acc: 0.4460
 Site-Latino_Hispanic          | Train Loss: 1.3573 | Train Acc: 0.4580
 Site-Black                    | Train Loss: 1.5565 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.4260 | Train Acc: 0.4484
 Site-East_Asian               | Train Loss: 1.3668 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.2208 | Train Acc: 0.5300
 Site-Indian                   | Train Loss: 1.3091 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.3352 | Train Acc: 0.4269
 Site-Southeast_Asian          | Train Loss: 1.3979 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.3768 | Train Acc: 0.4940
 Site-Middle_Eastern           | Train Loss: 1.3957 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.3227 | Train Acc: 0.5060
 Site-White                     (6) | Val  Loss: 1.2686 | Val  Acc: 0.5000
 Site-White                     (6) | Val  Loss: 1.2878 | Val  Acc: 0.5180
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3586 | Val  Acc: 0.4891
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3827 | Val  Acc: 0.4640
 Site-Black                     (2) | Val  Loss: 1.2452 | Val  Acc: 0.5435
 Site-Black                     (5) | Val  Loss: 1.4008 | Val  Acc: 0.4820
 Site-East_Asian                (0) | Val  Loss: 1.2178 | Val  Acc: 0.5652
 Site-East_Asian                (3) | Val  Loss: 1.2885 | Val  Acc: 0.5324
 Site-Indian                    (4) | Val  Loss: 1.3880 | Val  Acc: 0.4348
 Site-Indian                    (4) | Val  Loss: 1.3650 | Val  Acc: 0.4173
 Site-Southeast_Asian           (3) | Val  Loss: 1.3578 | Val  Acc: 0.4674
 Site-Southeast_Asian           (3) | Val  Loss: 1.3571 | Val  Acc: 0.4928
 Site-Middle_Eastern            (1) | Val  Loss: 1.3401 | Val  Acc: 0.5000
 Site-Middle_Eastern            (1) | Val  Loss: 1.2969 | Val  Acc: 0.4964
Average Valid Accuracy: 0.4931
============ Train epoch 40 ============
cnt=[2, 2, 3, 1, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-White                    | Train Loss: 1.3060 | Train Acc: 0.4388
 Site-White                    | Train Loss: 1.3261 | Train Acc: 0.5084
 Site-Latino_Hispanic          | Train Loss: 1.4945 | Train Acc: 0.4604
 Site-Latino_Hispanic          | Train Loss: 1.3512 | Train Acc: 0.4556
 Site-Black                    | Train Loss: 1.6297 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.4605 | Train Acc: 0.4724
 Site-East_Asian               | Train Loss: 1.3062 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.2766 | Train Acc: 0.5468
 Site-Indian                   | Train Loss: 1.2357 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.3258 | Train Acc: 0.4580
 Site-Southeast_Asian          | Train Loss: 1.4274 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.3813 | Train Acc: 0.4916
 Site-Middle_Eastern           | Train Loss: 1.3504 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.1617 | Train Acc: 0.5372
 Site-White                     (1) | Val  Loss: 1.2858 | Val  Acc: 0.5326
 Site-White                     (1) | Val  Loss: 1.2813 | Val  Acc: 0.5108
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3609 | Val  Acc: 0.5000
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3853 | Val  Acc: 0.4388
 Site-Black                     (0) | Val  Loss: 1.2588 | Val  Acc: 0.5870
 Site-Black                     (0) | Val  Loss: 1.4117 | Val  Acc: 0.4820
 Site-East_Asian                (5) | Val  Loss: 1.1631 | Val  Acc: 0.5652
 Site-East_Asian                (5) | Val  Loss: 1.2458 | Val  Acc: 0.5288
 Site-Indian                    (6) | Val  Loss: 1.3819 | Val  Acc: 0.4022
 Site-Indian                    (6) | Val  Loss: 1.3614 | Val  Acc: 0.4712
 Site-Southeast_Asian           (2) | Val  Loss: 1.3153 | Val  Acc: 0.4783
 Site-Southeast_Asian           (2) | Val  Loss: 1.3075 | Val  Acc: 0.5108
 Site-Middle_Eastern            (4) | Val  Loss: 1.3173 | Val  Acc: 0.5109
 Site-Middle_Eastern            (4) | Val  Loss: 1.3230 | Val  Acc: 0.4964
Average Valid Accuracy: 0.5011
 Best site-White                    (1)  | Epoch:40 | Val Acc: 0.5326
 Best site-White                    (1)  | Epoch:40 | Val Acc: 0.5108
 Best site-Latino_Hispanic          (2)  | Epoch:40 | Val Acc: 0.5000
 Best site-Latino_Hispanic          (3)  | Epoch:40 | Val Acc: 0.4388
 Best site-Black                    (0)  | Epoch:40 | Val Acc: 0.5870
 Best site-Black                    (0)  | Epoch:40 | Val Acc: 0.4820
 Best site-East_Asian               (5)  | Epoch:40 | Val Acc: 0.5652
 Best site-East_Asian               (5)  | Epoch:40 | Val Acc: 0.5288
 Best site-Indian                   (6)  | Epoch:40 | Val Acc: 0.4022
 Best site-Indian                   (6)  | Epoch:40 | Val Acc: 0.4712
 Best site-Southeast_Asian          (2)  | Epoch:40 | Val Acc: 0.4783
 Best site-Southeast_Asian          (2)  | Epoch:40 | Val Acc: 0.5108
 Best site-Middle_Eastern           (4)  | Epoch:40 | Val Acc: 0.5109
 Best site-Middle_Eastern           (4)  | Epoch:40 | Val Acc: 0.4964
 Test site-White                     (1)| Epoch:40 | Test Acc: 0.4305
 Test site-Latino_Hispanic           (2)| Epoch:40 | Test Acc: 0.3734
 Test site-Black                     (0)| Epoch:40 | Test Acc: 0.3594
 Test site-East_Asian                (5)| Epoch:40 | Test Acc: 0.5032
 Test site-Indian                    (6)| Epoch:40 | Test Acc: 0.3517
 Test site-Southeast_Asian           (2)| Epoch:40 | Test Acc: 0.4333
 Test site-Middle_Eastern            (4)| Epoch:40 | Test Acc: 0.4072
White: 0.4305, Latino_Hispanic: 0.3734, Black: 0.3594, East_Asian: 0.5032, Indian: 0.3517, Southeast_Asian: 0.4333, Middle_Eastern: 0.4072, 
Average Test Accuracy: 0.4084, domain std=0.0492, cluster std=nan, individual std=0.0492, 
Average Test Accuracy: 0.4084
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 41 ============
cnt=[4, 1, 3, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-White                    | Train Loss: 1.3792 | Train Acc: 0.5180
 Site-White                    | Train Loss: 1.2356 | Train Acc: 0.5036
 Site-Latino_Hispanic          | Train Loss: 1.5403 | Train Acc: 0.4460
 Site-Latino_Hispanic          | Train Loss: 1.3625 | Train Acc: 0.4508
 Site-Black                    | Train Loss: 1.5870 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.4407 | Train Acc: 0.4724
 Site-East_Asian               | Train Loss: 1.3171 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.3008 | Train Acc: 0.5204
 Site-Indian                   | Train Loss: 1.2823 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.3367 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.3868 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.2743 | Train Acc: 0.5156
 Site-Middle_Eastern           | Train Loss: 1.3948 | Train Acc: 0.4173
 Site-Middle_Eastern           | Train Loss: 1.2845 | Train Acc: 0.5132
 Site-White                     (0) | Val  Loss: 1.2898 | Val  Acc: 0.5000
 Site-White                     (2) | Val  Loss: 1.2767 | Val  Acc: 0.4856
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3850 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3737 | Val  Acc: 0.4532
 Site-Black                     (1) | Val  Loss: 1.2619 | Val  Acc: 0.5652
 Site-Black                     (6) | Val  Loss: 1.3996 | Val  Acc: 0.5000
 Site-East_Asian                (4) | Val  Loss: 1.1744 | Val  Acc: 0.5326
 Site-East_Asian                (0) | Val  Loss: 1.2622 | Val  Acc: 0.5216
 Site-Indian                    (3) | Val  Loss: 1.4112 | Val  Acc: 0.4130
 Site-Indian                    (5) | Val  Loss: 1.3948 | Val  Acc: 0.4460
 Site-Southeast_Asian           (4) | Val  Loss: 1.3277 | Val  Acc: 0.4565
 Site-Southeast_Asian           (4) | Val  Loss: 1.3204 | Val  Acc: 0.5000
 Site-Middle_Eastern            (2) | Val  Loss: 1.3412 | Val  Acc: 0.5326
 Site-Middle_Eastern            (2) | Val  Loss: 1.3151 | Val  Acc: 0.5036
Average Valid Accuracy: 0.4897
 Test site-White                     (0)| Epoch:40 | Test Acc: 0.4251
 Test site-Latino_Hispanic           (0)| Epoch:40 | Test Acc: 0.3734
 Test site-Black                     (1)| Epoch:40 | Test Acc: 0.3531
 Test site-East_Asian                (4)| Epoch:40 | Test Acc: 0.5227
 Test site-Indian                    (3)| Epoch:40 | Test Acc: 0.3517
 Test site-Southeast_Asian           (4)| Epoch:40 | Test Acc: 0.4296
 Test site-Middle_Eastern            (2)| Epoch:40 | Test Acc: 0.4098
White: 0.4251, Latino_Hispanic: 0.3734, Black: 0.3531, East_Asian: 0.5227, Indian: 0.3517, Southeast_Asian: 0.4296, Middle_Eastern: 0.4098, 
Average Test Accuracy: 0.4094, domain std=0.0552, cluster std=nan, individual std=0.0552, 
Average Test Accuracy: 0.4094
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 42 ============
cnt=[3, 3, 1, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-White                    | Train Loss: 1.3003 | Train Acc: 0.5108
 Site-White                    | Train Loss: 1.2252 | Train Acc: 0.5036
 Site-Latino_Hispanic          | Train Loss: 1.5466 | Train Acc: 0.4173
 Site-Latino_Hispanic          | Train Loss: 1.3393 | Train Acc: 0.4628
 Site-Black                    | Train Loss: 1.5849 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.4256 | Train Acc: 0.4508
 Site-East_Asian               | Train Loss: 1.3355 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.3285 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.3335 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.3905 | Train Acc: 0.4412
 Site-Southeast_Asian          | Train Loss: 1.4461 | Train Acc: 0.4892
 Site-Southeast_Asian          | Train Loss: 1.3847 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.3578 | Train Acc: 0.4676
 Site-Middle_Eastern           | Train Loss: 1.2508 | Train Acc: 0.4916
 Site-White                     (1) | Val  Loss: 1.3091 | Val  Acc: 0.5000
 Site-White                     (6) | Val  Loss: 1.2805 | Val  Acc: 0.5072
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4244 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3635 | Val  Acc: 0.4640
 Site-Black                     (4) | Val  Loss: 1.2900 | Val  Acc: 0.5978
 Site-Black                     (2) | Val  Loss: 1.3921 | Val  Acc: 0.4964
 Site-East_Asian                (0) | Val  Loss: 1.1994 | Val  Acc: 0.5000
 Site-East_Asian                (5) | Val  Loss: 1.2304 | Val  Acc: 0.5396
 Site-Indian                    (4) | Val  Loss: 1.4410 | Val  Acc: 0.4348
 Site-Indian                    (4) | Val  Loss: 1.3643 | Val  Acc: 0.4460
 Site-Southeast_Asian           (0) | Val  Loss: 1.3119 | Val  Acc: 0.4674
 Site-Southeast_Asian           (0) | Val  Loss: 1.3097 | Val  Acc: 0.4892
 Site-Middle_Eastern            (1) | Val  Loss: 1.3901 | Val  Acc: 0.4674
 Site-Middle_Eastern            (1) | Val  Loss: 1.3000 | Val  Acc: 0.5180
Average Valid Accuracy: 0.4917
 Test site-White                     (1)| Epoch:41 | Test Acc: 0.4278
 Test site-Latino_Hispanic           (3)| Epoch:41 | Test Acc: 0.3671
 Test site-Black                     (4)| Epoch:41 | Test Acc: 0.3563
 Test site-East_Asian                (0)| Epoch:41 | Test Acc: 0.5260
 Test site-Indian                    (4)| Epoch:41 | Test Acc: 0.3541
 Test site-Southeast_Asian           (0)| Epoch:41 | Test Acc: 0.4333
 Test site-Middle_Eastern            (1)| Epoch:41 | Test Acc: 0.4149
White: 0.4278, Latino_Hispanic: 0.3671, Black: 0.3563, East_Asian: 0.5260, Indian: 0.3541, Southeast_Asian: 0.4333, Middle_Eastern: 0.4149, 
Average Test Accuracy: 0.4114, domain std=0.0563, cluster std=nan, individual std=0.0563, 
Average Test Accuracy: 0.4114
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 43 ============
cnt=[2, 2, 2, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-White                    | Train Loss: 1.3712 | Train Acc: 0.4892
 Site-White                    | Train Loss: 1.3011 | Train Acc: 0.5276
 Site-Latino_Hispanic          | Train Loss: 1.4466 | Train Acc: 0.4604
 Site-Latino_Hispanic          | Train Loss: 1.4323 | Train Acc: 0.4412
 Site-Black                    | Train Loss: 1.5526 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.4330 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3401 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.2373 | Train Acc: 0.5276
 Site-Indian                   | Train Loss: 1.3437 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.3443 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.4315 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.3778 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.4068 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.1922 | Train Acc: 0.5156
 Site-White                     (5) | Val  Loss: 1.2566 | Val  Acc: 0.5435
 Site-White                     (5) | Val  Loss: 1.2838 | Val  Acc: 0.5144
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4427 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3760 | Val  Acc: 0.4496
 Site-Black                     (2) | Val  Loss: 1.2921 | Val  Acc: 0.5652
 Site-Black                     (2) | Val  Loss: 1.4117 | Val  Acc: 0.4928
 Site-East_Asian                (4) | Val  Loss: 1.1365 | Val  Acc: 0.5652
 Site-East_Asian                (4) | Val  Loss: 1.2352 | Val  Acc: 0.5576
 Site-Indian                    (3) | Val  Loss: 1.3726 | Val  Acc: 0.4130
 Site-Indian                    (3) | Val  Loss: 1.3577 | Val  Acc: 0.4532
 Site-Southeast_Asian           (1) | Val  Loss: 1.2976 | Val  Acc: 0.4674
 Site-Southeast_Asian           (1) | Val  Loss: 1.3139 | Val  Acc: 0.5180
 Site-Middle_Eastern            (0) | Val  Loss: 1.3186 | Val  Acc: 0.5543
 Site-Middle_Eastern            (0) | Val  Loss: 1.2924 | Val  Acc: 0.5252
Average Valid Accuracy: 0.5054
 Best site-White                    (5)  | Epoch:43 | Val Acc: 0.5435
 Best site-White                    (5)  | Epoch:43 | Val Acc: 0.5144
 Best site-Latino_Hispanic          (6)  | Epoch:43 | Val Acc: 0.4565
 Best site-Latino_Hispanic          (3)  | Epoch:43 | Val Acc: 0.4496
 Best site-Black                    (2)  | Epoch:43 | Val Acc: 0.5652
 Best site-Black                    (2)  | Epoch:43 | Val Acc: 0.4928
 Best site-East_Asian               (4)  | Epoch:43 | Val Acc: 0.5652
 Best site-East_Asian               (4)  | Epoch:43 | Val Acc: 0.5576
 Best site-Indian                   (3)  | Epoch:43 | Val Acc: 0.4130
 Best site-Indian                   (3)  | Epoch:43 | Val Acc: 0.4532
 Best site-Southeast_Asian          (1)  | Epoch:43 | Val Acc: 0.4674
 Best site-Southeast_Asian          (1)  | Epoch:43 | Val Acc: 0.5180
 Best site-Middle_Eastern           (0)  | Epoch:43 | Val Acc: 0.5543
 Best site-Middle_Eastern           (0)  | Epoch:43 | Val Acc: 0.5252
 Test site-White                     (5)| Epoch:43 | Test Acc: 0.4225
 Test site-Latino_Hispanic           (6)| Epoch:43 | Test Acc: 0.3734
 Test site-Black                     (2)| Epoch:43 | Test Acc: 0.3469
 Test site-East_Asian                (4)| Epoch:43 | Test Acc: 0.5097
 Test site-Indian                    (3)| Epoch:43 | Test Acc: 0.3589
 Test site-Southeast_Asian           (1)| Epoch:43 | Test Acc: 0.4444
 Test site-Middle_Eastern            (0)| Epoch:43 | Test Acc: 0.4201
White: 0.4225, Latino_Hispanic: 0.3734, Black: 0.3469, East_Asian: 0.5097, Indian: 0.3589, Southeast_Asian: 0.4444, Middle_Eastern: 0.4201, 
Average Test Accuracy: 0.4108, domain std=0.0525, cluster std=0.0525, individual std=0.0525, 
Average Test Accuracy: 0.4108
============ Train epoch 44 ============
cnt=[2, 3, 1, 4, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-White                    | Train Loss: 1.3297 | Train Acc: 0.5612
 Site-White                    | Train Loss: 1.2252 | Train Acc: 0.5084
 Site-Latino_Hispanic          | Train Loss: 1.5447 | Train Acc: 0.4604
 Site-Latino_Hispanic          | Train Loss: 1.3505 | Train Acc: 0.4436
 Site-Black                    | Train Loss: 1.5767 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.3914 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.4406 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.2536 | Train Acc: 0.5300
 Site-Indian                   | Train Loss: 1.2677 | Train Acc: 0.5108
 Site-Indian                   | Train Loss: 1.3693 | Train Acc: 0.4868
 Site-Southeast_Asian          | Train Loss: 1.3942 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3781 | Train Acc: 0.5084
 Site-Middle_Eastern           | Train Loss: 1.2795 | Train Acc: 0.5108
 Site-Middle_Eastern           | Train Loss: 1.3152 | Train Acc: 0.5156
 Site-White                     (3) | Val  Loss: 1.3128 | Val  Acc: 0.4891
 Site-White                     (2) | Val  Loss: 1.2661 | Val  Acc: 0.5144
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3900 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3763 | Val  Acc: 0.4424
 Site-Black                     (1) | Val  Loss: 1.2212 | Val  Acc: 0.5978
 Site-Black                     (5) | Val  Loss: 1.3522 | Val  Acc: 0.5036
 Site-East_Asian                (4) | Val  Loss: 1.1704 | Val  Acc: 0.5543
 Site-East_Asian                (3) | Val  Loss: 1.2276 | Val  Acc: 0.5432
 Site-Indian                    (1) | Val  Loss: 1.4009 | Val  Acc: 0.4348
 Site-Indian                    (1) | Val  Loss: 1.3774 | Val  Acc: 0.4317
 Site-Southeast_Asian           (0) | Val  Loss: 1.3155 | Val  Acc: 0.5109
 Site-Southeast_Asian           (0) | Val  Loss: 1.3157 | Val  Acc: 0.5252
 Site-Middle_Eastern            (3) | Val  Loss: 1.3426 | Val  Acc: 0.5109
 Site-Middle_Eastern            (3) | Val  Loss: 1.3173 | Val  Acc: 0.4784
Average Valid Accuracy: 0.5003
 Test site-White                     (3)| Epoch:43 | Test Acc: 0.4358
 Test site-Latino_Hispanic           (6)| Epoch:43 | Test Acc: 0.3829
 Test site-Black                     (1)| Epoch:43 | Test Acc: 0.3469
 Test site-East_Asian                (4)| Epoch:43 | Test Acc: 0.5000
 Test site-Indian                    (1)| Epoch:43 | Test Acc: 0.3660
 Test site-Southeast_Asian           (0)| Epoch:43 | Test Acc: 0.4259
 Test site-Middle_Eastern            (3)| Epoch:43 | Test Acc: 0.4227
White: 0.4358, Latino_Hispanic: 0.3829, Black: 0.3469, East_Asian: 0.5000, Indian: 0.3660, Southeast_Asian: 0.4259, Middle_Eastern: 0.4227, 
Average Test Accuracy: 0.4115, domain std=0.0475, cluster std=nan, individual std=0.0475, 
Average Test Accuracy: 0.4115
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 45 ============
cnt=[1, 2, 2, 2, 2, 2, 3, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-White                    | Train Loss: 1.3931 | Train Acc: 0.4676
 Site-White                    | Train Loss: 1.2936 | Train Acc: 0.4964
 Site-Latino_Hispanic          | Train Loss: 1.4654 | Train Acc: 0.4820
 Site-Latino_Hispanic          | Train Loss: 1.3713 | Train Acc: 0.4604
 Site-Black                    | Train Loss: 1.6095 | Train Acc: 0.4029
 Site-Black                    | Train Loss: 1.5623 | Train Acc: 0.4508
 Site-East_Asian               | Train Loss: 1.3210 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.2418 | Train Acc: 0.5108
 Site-Indian                   | Train Loss: 1.3560 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.3392 | Train Acc: 0.4628
 Site-Southeast_Asian          | Train Loss: 1.4404 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.3604 | Train Acc: 0.5180
 Site-Middle_Eastern           | Train Loss: 1.3535 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.2986 | Train Acc: 0.5132
 Site-White                     (1) | Val  Loss: 1.2702 | Val  Acc: 0.4783
 Site-White                     (1) | Val  Loss: 1.2672 | Val  Acc: 0.4712
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3262 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3438 | Val  Acc: 0.4748
 Site-Black                     (2) | Val  Loss: 1.2478 | Val  Acc: 0.5761
 Site-Black                     (2) | Val  Loss: 1.4056 | Val  Acc: 0.4568
 Site-East_Asian                (6) | Val  Loss: 1.2014 | Val  Acc: 0.5543
 Site-East_Asian                (6) | Val  Loss: 1.2307 | Val  Acc: 0.5396
 Site-Indian                    (5) | Val  Loss: 1.4415 | Val  Acc: 0.4457
 Site-Indian                    (5) | Val  Loss: 1.3641 | Val  Acc: 0.4640
 Site-Southeast_Asian           (0) | Val  Loss: 1.2966 | Val  Acc: 0.4891
 Site-Southeast_Asian           (6) | Val  Loss: 1.2856 | Val  Acc: 0.5144
 Site-Middle_Eastern            (4) | Val  Loss: 1.3938 | Val  Acc: 0.5326
 Site-Middle_Eastern            (4) | Val  Loss: 1.3146 | Val  Acc: 0.5108
Average Valid Accuracy: 0.4982
 Test site-White                     (1)| Epoch:44 | Test Acc: 0.4412
 Test site-Latino_Hispanic           (3)| Epoch:44 | Test Acc: 0.3766
 Test site-Black                     (2)| Epoch:44 | Test Acc: 0.3563
 Test site-East_Asian                (6)| Epoch:44 | Test Acc: 0.5130
 Test site-Indian                    (5)| Epoch:44 | Test Acc: 0.3541
 Test site-Southeast_Asian           (0)| Epoch:44 | Test Acc: 0.4296
 Test site-Middle_Eastern            (4)| Epoch:44 | Test Acc: 0.4124
White: 0.4412, Latino_Hispanic: 0.3766, Black: 0.3563, East_Asian: 0.5130, Indian: 0.3541, Southeast_Asian: 0.4296, Middle_Eastern: 0.4124, 
Average Test Accuracy: 0.4119, domain std=0.0522, cluster std=0.0522, individual std=0.0522, 
Average Test Accuracy: 0.4119
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 46 ============
cnt=[2, 4, 2, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-White                    | Train Loss: 1.3215 | Train Acc: 0.5827
 Site-White                    | Train Loss: 1.2294 | Train Acc: 0.4940
 Site-Latino_Hispanic          | Train Loss: 1.4567 | Train Acc: 0.4388
 Site-Latino_Hispanic          | Train Loss: 1.4282 | Train Acc: 0.4412
 Site-Black                    | Train Loss: 1.5755 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.4131 | Train Acc: 0.4916
 Site-East_Asian               | Train Loss: 1.3319 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3083 | Train Acc: 0.5060
 Site-Indian                   | Train Loss: 1.3276 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.4058 | Train Acc: 0.4556
 Site-Southeast_Asian          | Train Loss: 1.3906 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.2914 | Train Acc: 0.5228
 Site-Middle_Eastern           | Train Loss: 1.4068 | Train Acc: 0.5108
 Site-Middle_Eastern           | Train Loss: 1.2242 | Train Acc: 0.5108
 Site-White                     (1) | Val  Loss: 1.2602 | Val  Acc: 0.5109
 Site-White                     (1) | Val  Loss: 1.2765 | Val  Acc: 0.5108
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3614 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3710 | Val  Acc: 0.4784
 Site-Black                     (5) | Val  Loss: 1.2446 | Val  Acc: 0.5652
 Site-Black                     (6) | Val  Loss: 1.3767 | Val  Acc: 0.4748
 Site-East_Asian                (3) | Val  Loss: 1.1670 | Val  Acc: 0.5652
 Site-East_Asian                (4) | Val  Loss: 1.2478 | Val  Acc: 0.5324
 Site-Indian                    (0) | Val  Loss: 1.4389 | Val  Acc: 0.4130
 Site-Indian                    (0) | Val  Loss: 1.3555 | Val  Acc: 0.4532
 Site-Southeast_Asian           (4) | Val  Loss: 1.3635 | Val  Acc: 0.4891
 Site-Southeast_Asian           (4) | Val  Loss: 1.2822 | Val  Acc: 0.5324
 Site-Middle_Eastern            (2) | Val  Loss: 1.3162 | Val  Acc: 0.5435
 Site-Middle_Eastern            (2) | Val  Loss: 1.3080 | Val  Acc: 0.4964
Average Valid Accuracy: 0.5008
 Test site-White                     (1)| Epoch:45 | Test Acc: 0.4251
 Test site-Latino_Hispanic           (1)| Epoch:45 | Test Acc: 0.3703
 Test site-Black                     (5)| Epoch:45 | Test Acc: 0.3500
 Test site-East_Asian                (3)| Epoch:45 | Test Acc: 0.5130
 Test site-Indian                    (0)| Epoch:45 | Test Acc: 0.3565
 Test site-Southeast_Asian           (4)| Epoch:45 | Test Acc: 0.4370
 Test site-Middle_Eastern            (2)| Epoch:45 | Test Acc: 0.4021
White: 0.4251, Latino_Hispanic: 0.3703, Black: 0.3500, East_Asian: 0.5130, Indian: 0.3565, Southeast_Asian: 0.4370, Middle_Eastern: 0.4021, 
Average Test Accuracy: 0.4077, domain std=0.0530, cluster std=nan, individual std=0.0530, 
Average Test Accuracy: 0.4077
============ Train epoch 47 ============
cnt=[3, 1, 3, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-White                    | Train Loss: 1.2874 | Train Acc: 0.5468
 Site-White                    | Train Loss: 1.2037 | Train Acc: 0.5372
 Site-Latino_Hispanic          | Train Loss: 1.4864 | Train Acc: 0.4317
 Site-Latino_Hispanic          | Train Loss: 1.3837 | Train Acc: 0.4748
 Site-Black                    | Train Loss: 1.5262 | Train Acc: 0.4101
 Site-Black                    | Train Loss: 1.4204 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.3846 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.2519 | Train Acc: 0.5300
 Site-Indian                   | Train Loss: 1.3178 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.3391 | Train Acc: 0.4868
 Site-Southeast_Asian          | Train Loss: 1.3808 | Train Acc: 0.5252
 Site-Southeast_Asian          | Train Loss: 1.4585 | Train Acc: 0.5156
 Site-Middle_Eastern           | Train Loss: 1.3981 | Train Acc: 0.4676
 Site-Middle_Eastern           | Train Loss: 1.2194 | Train Acc: 0.5228
 Site-White                     (2) | Val  Loss: 1.3009 | Val  Acc: 0.5000
 Site-White                     (2) | Val  Loss: 1.2600 | Val  Acc: 0.5108
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3796 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3642 | Val  Acc: 0.4784
 Site-Black                     (6) | Val  Loss: 1.2340 | Val  Acc: 0.5870
 Site-Black                     (1) | Val  Loss: 1.3496 | Val  Acc: 0.5180
 Site-East_Asian                (4) | Val  Loss: 1.2167 | Val  Acc: 0.5217
 Site-East_Asian                (0) | Val  Loss: 1.2536 | Val  Acc: 0.5468
 Site-Indian                    (3) | Val  Loss: 1.3624 | Val  Acc: 0.4457
 Site-Indian                    (3) | Val  Loss: 1.3365 | Val  Acc: 0.4676
 Site-Southeast_Asian           (0) | Val  Loss: 1.3115 | Val  Acc: 0.5000
 Site-Southeast_Asian           (0) | Val  Loss: 1.3043 | Val  Acc: 0.5000
 Site-Middle_Eastern            (5) | Val  Loss: 1.3834 | Val  Acc: 0.4674
 Site-Middle_Eastern            (5) | Val  Loss: 1.2903 | Val  Acc: 0.5036
Average Valid Accuracy: 0.5010
 Test site-White                     (2)| Epoch:45 | Test Acc: 0.4251
 Test site-Latino_Hispanic           (2)| Epoch:45 | Test Acc: 0.3829
 Test site-Black                     (6)| Epoch:45 | Test Acc: 0.3625
 Test site-East_Asian                (4)| Epoch:45 | Test Acc: 0.5130
 Test site-Indian                    (3)| Epoch:45 | Test Acc: 0.3565
 Test site-Southeast_Asian           (0)| Epoch:45 | Test Acc: 0.4296
 Test site-Middle_Eastern            (5)| Epoch:45 | Test Acc: 0.4021
White: 0.4251, Latino_Hispanic: 0.3829, Black: 0.3625, East_Asian: 0.5130, Indian: 0.3565, Southeast_Asian: 0.4296, Middle_Eastern: 0.4021, 
Average Test Accuracy: 0.4102, domain std=0.0495, cluster std=nan, individual std=0.0495, 
Average Test Accuracy: 0.4102
============ Train epoch 48 ============
cnt=[3, 2, 2, 2, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-White                    | Train Loss: 1.3300 | Train Acc: 0.5252
 Site-White                    | Train Loss: 1.2656 | Train Acc: 0.5204
 Site-Latino_Hispanic          | Train Loss: 1.5490 | Train Acc: 0.4317
 Site-Latino_Hispanic          | Train Loss: 1.3159 | Train Acc: 0.4604
 Site-Black                    | Train Loss: 1.4932 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.5183 | Train Acc: 0.4940
 Site-East_Asian               | Train Loss: 1.4160 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.4092 | Train Acc: 0.4940
 Site-Indian                   | Train Loss: 1.3049 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.3487 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.3119 | Train Acc: 0.4892
 Site-Southeast_Asian          | Train Loss: 1.3403 | Train Acc: 0.4796
 Site-Middle_Eastern           | Train Loss: 1.4033 | Train Acc: 0.5036
 Site-Middle_Eastern           | Train Loss: 1.2738 | Train Acc: 0.5060
 Site-White                     (5) | Val  Loss: 1.3003 | Val  Acc: 0.4674
 Site-White                     (4) | Val  Loss: 1.2629 | Val  Acc: 0.5180
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3257 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3682 | Val  Acc: 0.4568
 Site-Black                     (3) | Val  Loss: 1.2247 | Val  Acc: 0.6087
 Site-Black                     (3) | Val  Loss: 1.3594 | Val  Acc: 0.5216
 Site-East_Asian                (2) | Val  Loss: 1.2327 | Val  Acc: 0.5652
 Site-East_Asian                (6) | Val  Loss: 1.2389 | Val  Acc: 0.5252
 Site-Indian                    (0) | Val  Loss: 1.3732 | Val  Acc: 0.4239
 Site-Indian                    (0) | Val  Loss: 1.3159 | Val  Acc: 0.4676
 Site-Southeast_Asian           (2) | Val  Loss: 1.2929 | Val  Acc: 0.5217
 Site-Southeast_Asian           (6) | Val  Loss: 1.2990 | Val  Acc: 0.5108
 Site-Middle_Eastern            (1) | Val  Loss: 1.3398 | Val  Acc: 0.4565
 Site-Middle_Eastern            (1) | Val  Loss: 1.2869 | Val  Acc: 0.5072
Average Valid Accuracy: 0.5005
 Test site-White                     (5)| Epoch:45 | Test Acc: 0.4091
 Test site-Latino_Hispanic           (6)| Epoch:45 | Test Acc: 0.3797
 Test site-Black                     (3)| Epoch:45 | Test Acc: 0.3750
 Test site-East_Asian                (2)| Epoch:45 | Test Acc: 0.4935
 Test site-Indian                    (0)| Epoch:45 | Test Acc: 0.3589
 Test site-Southeast_Asian           (2)| Epoch:45 | Test Acc: 0.4407
 Test site-Middle_Eastern            (1)| Epoch:45 | Test Acc: 0.4149
White: 0.4091, Latino_Hispanic: 0.3797, Black: 0.3750, East_Asian: 0.4935, Indian: 0.3589, Southeast_Asian: 0.4407, Middle_Eastern: 0.4149, 
Average Test Accuracy: 0.4103, domain std=0.0426, cluster std=nan, individual std=0.0426, 
Average Test Accuracy: 0.4103
============ Train epoch 49 ============
cnt=[4, 2, 3, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-White                    | Train Loss: 1.3873 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.3207 | Train Acc: 0.5132
 Site-Latino_Hispanic          | Train Loss: 1.5237 | Train Acc: 0.4676
 Site-Latino_Hispanic          | Train Loss: 1.3586 | Train Acc: 0.4580
 Site-Black                    | Train Loss: 1.6205 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.3399 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.3476 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.2614 | Train Acc: 0.5084
 Site-Indian                   | Train Loss: 1.2948 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.3516 | Train Acc: 0.4412
 Site-Southeast_Asian          | Train Loss: 1.3690 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.3390 | Train Acc: 0.4868
 Site-Middle_Eastern           | Train Loss: 1.3652 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.2253 | Train Acc: 0.4964
 Site-White                     (2) | Val  Loss: 1.2084 | Val  Acc: 0.5543
 Site-White                     (5) | Val  Loss: 1.2701 | Val  Acc: 0.4892
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3407 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3619 | Val  Acc: 0.4388
 Site-Black                     (6) | Val  Loss: 1.2226 | Val  Acc: 0.5978
 Site-Black                     (3) | Val  Loss: 1.3931 | Val  Acc: 0.4748
 Site-East_Asian                (1) | Val  Loss: 1.2079 | Val  Acc: 0.5652
 Site-East_Asian                (1) | Val  Loss: 1.2219 | Val  Acc: 0.5432
 Site-Indian                    (0) | Val  Loss: 1.3793 | Val  Acc: 0.5000
 Site-Indian                    (0) | Val  Loss: 1.3362 | Val  Acc: 0.4856
 Site-Southeast_Asian           (4) | Val  Loss: 1.3234 | Val  Acc: 0.5000
 Site-Southeast_Asian           (4) | Val  Loss: 1.2838 | Val  Acc: 0.4964
 Site-Middle_Eastern            (2) | Val  Loss: 1.3077 | Val  Acc: 0.4891
 Site-Middle_Eastern            (2) | Val  Loss: 1.3047 | Val  Acc: 0.4928
Average Valid Accuracy: 0.5060
 Best site-White                    (2)  | Epoch:49 | Val Acc: 0.5543
 Best site-White                    (5)  | Epoch:49 | Val Acc: 0.4892
 Best site-Latino_Hispanic          (0)  | Epoch:49 | Val Acc: 0.4565
 Best site-Latino_Hispanic          (0)  | Epoch:49 | Val Acc: 0.4388
 Best site-Black                    (6)  | Epoch:49 | Val Acc: 0.5978
 Best site-Black                    (3)  | Epoch:49 | Val Acc: 0.4748
 Best site-East_Asian               (1)  | Epoch:49 | Val Acc: 0.5652
 Best site-East_Asian               (1)  | Epoch:49 | Val Acc: 0.5432
 Best site-Indian                   (0)  | Epoch:49 | Val Acc: 0.5000
 Best site-Indian                   (0)  | Epoch:49 | Val Acc: 0.4856
 Best site-Southeast_Asian          (4)  | Epoch:49 | Val Acc: 0.5000
 Best site-Southeast_Asian          (4)  | Epoch:49 | Val Acc: 0.4964
 Best site-Middle_Eastern           (2)  | Epoch:49 | Val Acc: 0.4891
 Best site-Middle_Eastern           (2)  | Epoch:49 | Val Acc: 0.4928
 Test site-White                     (2)| Epoch:49 | Test Acc: 0.4251
 Test site-Latino_Hispanic           (0)| Epoch:49 | Test Acc: 0.3734
 Test site-Black                     (6)| Epoch:49 | Test Acc: 0.3531
 Test site-East_Asian                (1)| Epoch:49 | Test Acc: 0.5032
 Test site-Indian                    (0)| Epoch:49 | Test Acc: 0.3469
 Test site-Southeast_Asian           (4)| Epoch:49 | Test Acc: 0.4296
 Test site-Middle_Eastern            (2)| Epoch:49 | Test Acc: 0.4072
White: 0.4251, Latino_Hispanic: 0.3734, Black: 0.3531, East_Asian: 0.5032, Indian: 0.3469, Southeast_Asian: 0.4296, Middle_Eastern: 0.4072, 
Average Test Accuracy: 0.4055, domain std=0.0503, cluster std=nan, individual std=0.0503, 
Average Test Accuracy: 0.4055
===2023-06-07 06:08:57===
===2023-06-07 06:09:12===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0.0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[139,417,139,417,139,417,139,417,139,417,139,417,139,417,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1856,1856,1856,1856,1856,1856,1856,]
domain number = 7
Loading snapshots...
 Test site-White                     (1)| Epoch:45 | Test Acc: 0.4412
 Test site-Latino_Hispanic           (3)| Epoch:45 | Test Acc: 0.3766
 Test site-Black                     (2)| Epoch:45 | Test Acc: 0.3563
 Test site-East_Asian                (6)| Epoch:45 | Test Acc: 0.5130
 Test site-Indian                    (5)| Epoch:45 | Test Acc: 0.3541
 Test site-Southeast_Asian           (0)| Epoch:45 | Test Acc: 0.4296
 Test site-Middle_Eastern            (4)| Epoch:45 | Test Acc: 0.4124
White: 0.4412, Latino_Hispanic: 0.3766, Black: 0.3563, East_Asian: 0.5130, Indian: 0.3541, Southeast_Asian: 0.4296, Middle_Eastern: 0.4124, 
Average Test Accuracy: 0.4119, domain std=0.0522, cluster std=0.0522, individual std=0.0522, 
