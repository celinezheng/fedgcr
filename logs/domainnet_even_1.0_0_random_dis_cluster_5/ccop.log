===2023-08-02 07:01:23===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[315,945,315,945,315,945,315,945,315,945,315,945,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (4) | Train Loss: 1.7342 | Train Acc: 0.5556
 Site-Clipart                   (4) | Train Loss: 1.7783 | Train Acc: 0.5185
 Site-Real                      (0) | Train Loss: 1.6064 | Train Acc: 0.6762
 Site-Real                      (0) | Train Loss: 1.6546 | Train Acc: 0.6624
 Site-Painting                  (0) | Train Loss: 1.7193 | Train Acc: 0.6095
 Site-Painting                  (0) | Train Loss: 1.6727 | Train Acc: 0.6148
 Site-Sketch                    (2) | Train Loss: 1.7067 | Train Acc: 0.5841
 Site-Sketch                    (2) | Train Loss: 1.7728 | Train Acc: 0.5640
 Site-QuickDraw                 (1) | Train Loss: 2.1533 | Train Acc: 0.2571
 Site-QuickDraw                 (1) | Train Loss: 2.1306 | Train Acc: 0.2825
 Site-Infograph                 (3) | Train Loss: 2.1014 | Train Acc: 0.3048
 Site-Infograph                 (3) | Train Loss: 2.0970 | Train Acc: 0.2974
Average Train Accuracy: 0.4939
 Site-Clipart                   (4) | Val  Loss: 1.7958 | Val  Acc: 0.5333
 Site-Clipart                   (4) | Val  Loss: 1.7605 | Val  Acc: 0.5540
 Site-Real                      (0) | Val  Loss: 1.7321 | Val  Acc: 0.6381
 Site-Real                      (0) | Val  Loss: 1.6668 | Val  Acc: 0.6524
 Site-Painting                  (0) | Val  Loss: 1.6943 | Val  Acc: 0.6000
 Site-Painting                  (0) | Val  Loss: 1.6963 | Val  Acc: 0.5921
 Site-Sketch                    (2) | Val  Loss: 1.8195 | Val  Acc: 0.5619
 Site-Sketch                    (2) | Val  Loss: 1.7777 | Val  Acc: 0.5762
 Site-QuickDraw                 (1) | Val  Loss: 2.1524 | Val  Acc: 0.2571
 Site-QuickDraw                 (1) | Val  Loss: 2.1369 | Val  Acc: 0.2810
 Site-Infograph                 (3) | Val  Loss: 2.0877 | Val  Acc: 0.2952
 Site-Infograph                 (3) | Val  Loss: 2.1103 | Val  Acc: 0.2952
Average Valid Accuracy: 0.4864
 Best site-Clipart                  (4)  | Epoch:0 | Val Acc: 0.5333
 Best site-Clipart                  (4)  | Epoch:0 | Val Acc: 0.5540
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.6381
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.6524
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.6000
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.5921
 Best site-Sketch                   (2)  | Epoch:0 | Val Acc: 0.5619
 Best site-Sketch                   (2)  | Epoch:0 | Val Acc: 0.5762
 Best site-QuickDraw                (1)  | Epoch:0 | Val Acc: 0.2571
 Best site-QuickDraw                (1)  | Epoch:0 | Val Acc: 0.2810
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2952
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2952
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 4, 2, 2, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (1) | Train Loss: 1.2188 | Train Acc: 0.7365
 Site-Clipart                   (1) | Train Loss: 1.2806 | Train Acc: 0.6974
 Site-Real                      (2) | Train Loss: 0.9795 | Train Acc: 0.8317
 Site-Real                      (2) | Train Loss: 1.0255 | Train Acc: 0.8307
 Site-Painting                  (4) | Train Loss: 1.1276 | Train Acc: 0.7683
 Site-Painting                  (4) | Train Loss: 1.0803 | Train Acc: 0.7958
 Site-Sketch                    (3) | Train Loss: 1.1688 | Train Acc: 0.7302
 Site-Sketch                    (3) | Train Loss: 1.2464 | Train Acc: 0.7238
 Site-QuickDraw                 (0) | Train Loss: 2.0508 | Train Acc: 0.2381
 Site-QuickDraw                 (0) | Train Loss: 2.0050 | Train Acc: 0.3217
 Site-Infograph                 (1) | Train Loss: 1.7905 | Train Acc: 0.4889
 Site-Infograph                 (1) | Train Loss: 1.8229 | Train Acc: 0.4169
Average Train Accuracy: 0.6317
 Site-Clipart                   (1) | Val  Loss: 1.3440 | Val  Acc: 0.6905
 Site-Clipart                   (1) | Val  Loss: 1.2749 | Val  Acc: 0.7127
 Site-Real                      (2) | Val  Loss: 1.1351 | Val  Acc: 0.8095
 Site-Real                      (2) | Val  Loss: 1.0391 | Val  Acc: 0.8190
 Site-Painting                  (4) | Val  Loss: 1.1128 | Val  Acc: 0.7476
 Site-Painting                  (4) | Val  Loss: 1.1007 | Val  Acc: 0.7683
 Site-Sketch                    (3) | Val  Loss: 1.2871 | Val  Acc: 0.7143
 Site-Sketch                    (3) | Val  Loss: 1.2356 | Val  Acc: 0.7270
 Site-QuickDraw                 (0) | Val  Loss: 2.0558 | Val  Acc: 0.3048
 Site-QuickDraw                 (0) | Val  Loss: 2.0165 | Val  Acc: 0.3048
 Site-Infograph                 (1) | Val  Loss: 1.7715 | Val  Acc: 0.4476
 Site-Infograph                 (1) | Val  Loss: 1.8481 | Val  Acc: 0.4063
Average Valid Accuracy: 0.6210
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.6905
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.7127
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.8095
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.8190
 Best site-Painting                 (4)  | Epoch:1 | Val Acc: 0.7476
 Best site-Painting                 (4)  | Epoch:1 | Val Acc: 0.7683
 Best site-Sketch                   (3)  | Epoch:1 | Val Acc: 0.7143
 Best site-Sketch                   (3)  | Epoch:1 | Val Acc: 0.7270
 Best site-QuickDraw                (0)  | Epoch:1 | Val Acc: 0.3048
 Best site-QuickDraw                (0)  | Epoch:1 | Val Acc: 0.3048
 Best site-Infograph                (1)  | Epoch:1 | Val Acc: 0.4476
 Best site-Infograph                (1)  | Epoch:1 | Val Acc: 0.4063
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 2 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (4) | Train Loss: 0.9466 | Train Acc: 0.7968
 Site-Clipart                   (4) | Train Loss: 1.0174 | Train Acc: 0.7640
 Site-Real                      (0) | Train Loss: 0.7474 | Train Acc: 0.8921
 Site-Real                      (0) | Train Loss: 0.7725 | Train Acc: 0.8899
 Site-Painting                  (0) | Train Loss: 0.8937 | Train Acc: 0.7968
 Site-Painting                  (0) | Train Loss: 0.8476 | Train Acc: 0.8423
 Site-Sketch                    (3) | Train Loss: 0.9262 | Train Acc: 0.7778
 Site-Sketch                    (3) | Train Loss: 0.9896 | Train Acc: 0.7608
 Site-QuickDraw                 (1) | Train Loss: 1.7766 | Train Acc: 0.3968
 Site-QuickDraw                 (1) | Train Loss: 1.7500 | Train Acc: 0.4550
 Site-Infograph                 (2) | Train Loss: 1.6350 | Train Acc: 0.4762
 Site-Infograph                 (2) | Train Loss: 1.6555 | Train Acc: 0.4825
Average Train Accuracy: 0.6943
 Site-Clipart                   (4) | Val  Loss: 1.0680 | Val  Acc: 0.7810
 Site-Clipart                   (4) | Val  Loss: 1.0016 | Val  Acc: 0.7635
 Site-Real                      (0) | Val  Loss: 0.8715 | Val  Acc: 0.8905
 Site-Real                      (0) | Val  Loss: 0.7986 | Val  Acc: 0.8889
 Site-Painting                  (0) | Val  Loss: 0.9135 | Val  Acc: 0.7762
 Site-Painting                  (0) | Val  Loss: 0.8675 | Val  Acc: 0.8349
 Site-Sketch                    (3) | Val  Loss: 1.0279 | Val  Acc: 0.7905
 Site-Sketch                    (3) | Val  Loss: 0.9701 | Val  Acc: 0.7810
 Site-QuickDraw                 (1) | Val  Loss: 1.7901 | Val  Acc: 0.4810
 Site-QuickDraw                 (1) | Val  Loss: 1.7542 | Val  Acc: 0.4397
 Site-Infograph                 (2) | Val  Loss: 1.5845 | Val  Acc: 0.5048
 Site-Infograph                 (2) | Val  Loss: 1.6521 | Val  Acc: 0.4857
Average Valid Accuracy: 0.7015
 Best site-Clipart                  (4)  | Epoch:2 | Val Acc: 0.7810
 Best site-Clipart                  (4)  | Epoch:2 | Val Acc: 0.7635
 Best site-Real                     (0)  | Epoch:2 | Val Acc: 0.8905
 Best site-Real                     (0)  | Epoch:2 | Val Acc: 0.8889
 Best site-Painting                 (0)  | Epoch:2 | Val Acc: 0.7762
 Best site-Painting                 (0)  | Epoch:2 | Val Acc: 0.8349
 Best site-Sketch                   (3)  | Epoch:2 | Val Acc: 0.7905
 Best site-Sketch                   (3)  | Epoch:2 | Val Acc: 0.7810
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.4810
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.4397
 Best site-Infograph                (2)  | Epoch:2 | Val Acc: 0.5048
 Best site-Infograph                (2)  | Epoch:2 | Val Acc: 0.4857
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (3) | Train Loss: 0.8135 | Train Acc: 0.8095
 Site-Clipart                   (3) | Train Loss: 0.8773 | Train Acc: 0.7937
 Site-Real                      (0) | Train Loss: 0.6224 | Train Acc: 0.9016
 Site-Real                      (0) | Train Loss: 0.6473 | Train Acc: 0.8995
 Site-Painting                  (4) | Train Loss: 0.7665 | Train Acc: 0.8254
 Site-Painting                  (4) | Train Loss: 0.7365 | Train Acc: 0.8434
 Site-Sketch                    (1) | Train Loss: 0.7727 | Train Acc: 0.8127
 Site-Sketch                    (1) | Train Loss: 0.8510 | Train Acc: 0.7799
 Site-QuickDraw                 (2) | Train Loss: 1.6207 | Train Acc: 0.4635
 Site-QuickDraw                 (2) | Train Loss: 1.5609 | Train Acc: 0.5164
 Site-Infograph                 (3) | Train Loss: 1.4815 | Train Acc: 0.5651
 Site-Infograph                 (3) | Train Loss: 1.5153 | Train Acc: 0.4984
Average Train Accuracy: 0.7257
 Site-Clipart                   (3) | Val  Loss: 0.8914 | Val  Acc: 0.7952
 Site-Clipart                   (3) | Val  Loss: 0.8562 | Val  Acc: 0.7857
 Site-Real                      (0) | Val  Loss: 0.7555 | Val  Acc: 0.8857
 Site-Real                      (0) | Val  Loss: 0.6659 | Val  Acc: 0.9032
 Site-Painting                  (4) | Val  Loss: 0.8356 | Val  Acc: 0.7810
 Site-Painting                  (4) | Val  Loss: 0.7405 | Val  Acc: 0.8349
 Site-Sketch                    (1) | Val  Loss: 0.9123 | Val  Acc: 0.7667
 Site-Sketch                    (1) | Val  Loss: 0.8540 | Val  Acc: 0.7889
 Site-QuickDraw                 (2) | Val  Loss: 1.6312 | Val  Acc: 0.4857
 Site-QuickDraw                 (2) | Val  Loss: 1.5368 | Val  Acc: 0.5413
 Site-Infograph                 (3) | Val  Loss: 1.4241 | Val  Acc: 0.5571
 Site-Infograph                 (3) | Val  Loss: 1.5109 | Val  Acc: 0.5127
Average Valid Accuracy: 0.7198
 Best site-Clipart                  (3)  | Epoch:3 | Val Acc: 0.7952
 Best site-Clipart                  (3)  | Epoch:3 | Val Acc: 0.7857
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 0.8857
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 0.9032
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.7810
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.8349
 Best site-Sketch                   (1)  | Epoch:3 | Val Acc: 0.7667
 Best site-Sketch                   (1)  | Epoch:3 | Val Acc: 0.7889
 Best site-QuickDraw                (2)  | Epoch:3 | Val Acc: 0.4857
 Best site-QuickDraw                (2)  | Epoch:3 | Val Acc: 0.5413
 Best site-Infograph                (3)  | Epoch:3 | Val Acc: 0.5571
 Best site-Infograph                (3)  | Epoch:3 | Val Acc: 0.5127
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (3) | Train Loss: 0.7205 | Train Acc: 0.8317
 Site-Clipart                   (3) | Train Loss: 0.7989 | Train Acc: 0.7926
 Site-Real                      (0) | Train Loss: 0.5482 | Train Acc: 0.8984
 Site-Real                      (0) | Train Loss: 0.5630 | Train Acc: 0.9026
 Site-Painting                  (4) | Train Loss: 0.6986 | Train Acc: 0.8349
 Site-Painting                  (4) | Train Loss: 0.6623 | Train Acc: 0.8508
 Site-Sketch                    (1) | Train Loss: 0.7089 | Train Acc: 0.8032
 Site-Sketch                    (1) | Train Loss: 0.7833 | Train Acc: 0.7968
 Site-QuickDraw                 (2) | Train Loss: 1.3934 | Train Acc: 0.5587
 Site-QuickDraw                 (2) | Train Loss: 1.3813 | Train Acc: 0.5704
 Site-Infograph                 (3) | Train Loss: 1.4140 | Train Acc: 0.5556
 Site-Infograph                 (3) | Train Loss: 1.4593 | Train Acc: 0.5344
Average Train Accuracy: 0.7442
 Site-Clipart                   (3) | Val  Loss: 0.8382 | Val  Acc: 0.8143
 Site-Clipart                   (3) | Val  Loss: 0.7436 | Val  Acc: 0.8143
 Site-Real                      (0) | Val  Loss: 0.6564 | Val  Acc: 0.8952
 Site-Real                      (0) | Val  Loss: 0.5841 | Val  Acc: 0.9000
 Site-Painting                  (4) | Val  Loss: 0.7207 | Val  Acc: 0.8190
 Site-Painting                  (4) | Val  Loss: 0.6773 | Val  Acc: 0.8381
 Site-Sketch                    (1) | Val  Loss: 0.8431 | Val  Acc: 0.7952
 Site-Sketch                    (1) | Val  Loss: 0.7807 | Val  Acc: 0.7889
 Site-QuickDraw                 (2) | Val  Loss: 1.3486 | Val  Acc: 0.6381
 Site-QuickDraw                 (2) | Val  Loss: 1.3728 | Val  Acc: 0.5587
 Site-Infograph                 (3) | Val  Loss: 1.3236 | Val  Acc: 0.5905
 Site-Infograph                 (3) | Val  Loss: 1.4510 | Val  Acc: 0.5381
Average Valid Accuracy: 0.7492
 Best site-Clipart                  (3)  | Epoch:4 | Val Acc: 0.8143
 Best site-Clipart                  (3)  | Epoch:4 | Val Acc: 0.8143
 Best site-Real                     (0)  | Epoch:4 | Val Acc: 0.8952
 Best site-Real                     (0)  | Epoch:4 | Val Acc: 0.9000
 Best site-Painting                 (4)  | Epoch:4 | Val Acc: 0.8190
 Best site-Painting                 (4)  | Epoch:4 | Val Acc: 0.8381
 Best site-Sketch                   (1)  | Epoch:4 | Val Acc: 0.7952
 Best site-Sketch                   (1)  | Epoch:4 | Val Acc: 0.7889
 Best site-QuickDraw                (2)  | Epoch:4 | Val Acc: 0.6381
 Best site-QuickDraw                (2)  | Epoch:4 | Val Acc: 0.5587
 Best site-Infograph                (3)  | Epoch:4 | Val Acc: 0.5905
 Best site-Infograph                (3)  | Epoch:4 | Val Acc: 0.5381
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 4, 2, 2, 2, ]
cnt=[2, 4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (3) | Train Loss: 0.6579 | Train Acc: 0.8317
 Site-Clipart                   (3) | Train Loss: 0.7266 | Train Acc: 0.8053
 Site-Real                      (1) | Train Loss: 0.4802 | Train Acc: 0.9016
 Site-Real                      (1) | Train Loss: 0.4947 | Train Acc: 0.8984
 Site-Painting                  (1) | Train Loss: 0.6167 | Train Acc: 0.8444
 Site-Painting                  (1) | Train Loss: 0.5824 | Train Acc: 0.8688
 Site-Sketch                    (4) | Train Loss: 0.6471 | Train Acc: 0.8222
 Site-Sketch                    (4) | Train Loss: 0.7033 | Train Acc: 0.8021
 Site-QuickDraw                 (0) | Train Loss: 1.2947 | Train Acc: 0.6159
 Site-QuickDraw                 (0) | Train Loss: 1.2928 | Train Acc: 0.6148
 Site-Infograph                 (2) | Train Loss: 1.3521 | Train Acc: 0.5556
 Site-Infograph                 (2) | Train Loss: 1.3500 | Train Acc: 0.5714
Average Train Accuracy: 0.7610
 Site-Clipart                   (3) | Val  Loss: 0.7800 | Val  Acc: 0.7857
 Site-Clipart                   (3) | Val  Loss: 0.7476 | Val  Acc: 0.7952
 Site-Real                      (1) | Val  Loss: 0.5806 | Val  Acc: 0.9143
 Site-Real                      (1) | Val  Loss: 0.5120 | Val  Acc: 0.9127
 Site-Painting                  (1) | Val  Loss: 0.6660 | Val  Acc: 0.8238
 Site-Painting                  (1) | Val  Loss: 0.5969 | Val  Acc: 0.8587
 Site-Sketch                    (4) | Val  Loss: 0.7216 | Val  Acc: 0.8048
 Site-Sketch                    (4) | Val  Loss: 0.7014 | Val  Acc: 0.8095
 Site-QuickDraw                 (0) | Val  Loss: 1.2908 | Val  Acc: 0.6762
 Site-QuickDraw                 (0) | Val  Loss: 1.2864 | Val  Acc: 0.6317
 Site-Infograph                 (2) | Val  Loss: 1.2590 | Val  Acc: 0.6000
 Site-Infograph                 (2) | Val  Loss: 1.3541 | Val  Acc: 0.5714
Average Valid Accuracy: 0.7653
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7857
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7952
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 0.9143
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 0.9127
 Best site-Painting                 (1)  | Epoch:5 | Val Acc: 0.8238
 Best site-Painting                 (1)  | Epoch:5 | Val Acc: 0.8587
 Best site-Sketch                   (4)  | Epoch:5 | Val Acc: 0.8048
 Best site-Sketch                   (4)  | Epoch:5 | Val Acc: 0.8095
 Best site-QuickDraw                (0)  | Epoch:5 | Val Acc: 0.6762
 Best site-QuickDraw                (0)  | Epoch:5 | Val Acc: 0.6317
 Best site-Infograph                (2)  | Epoch:5 | Val Acc: 0.6000
 Best site-Infograph                (2)  | Epoch:5 | Val Acc: 0.5714
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 2, 4, 2, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (1) | Train Loss: 0.6289 | Train Acc: 0.8222
 Site-Clipart                   (1) | Train Loss: 0.6930 | Train Acc: 0.8053
 Site-Real                      (2) | Train Loss: 0.4447 | Train Acc: 0.9143
 Site-Real                      (2) | Train Loss: 0.4518 | Train Acc: 0.9143
 Site-Painting                  (2) | Train Loss: 0.6182 | Train Acc: 0.8127
 Site-Painting                  (2) | Train Loss: 0.5705 | Train Acc: 0.8455
 Site-Sketch                    (3) | Train Loss: 0.6416 | Train Acc: 0.8222
 Site-Sketch                    (3) | Train Loss: 0.6862 | Train Acc: 0.7947
 Site-QuickDraw                 (0) | Train Loss: 1.1724 | Train Acc: 0.6508
 Site-QuickDraw                 (0) | Train Loss: 1.1088 | Train Acc: 0.6942
 Site-Infograph                 (4) | Train Loss: 1.2859 | Train Acc: 0.6127
 Site-Infograph                 (4) | Train Loss: 1.3003 | Train Acc: 0.5810
Average Train Accuracy: 0.7725
 Site-Clipart                   (1) | Val  Loss: 0.7831 | Val  Acc: 0.8238
 Site-Clipart                   (1) | Val  Loss: 0.6799 | Val  Acc: 0.8111
 Site-Real                      (2) | Val  Loss: 0.5646 | Val  Acc: 0.8905
 Site-Real                      (2) | Val  Loss: 0.4708 | Val  Acc: 0.9127
 Site-Painting                  (2) | Val  Loss: 0.6052 | Val  Acc: 0.8333
 Site-Painting                  (2) | Val  Loss: 0.5610 | Val  Acc: 0.8587
 Site-Sketch                    (3) | Val  Loss: 0.7435 | Val  Acc: 0.8095
 Site-Sketch                    (3) | Val  Loss: 0.6730 | Val  Acc: 0.8000
 Site-QuickDraw                 (0) | Val  Loss: 1.1085 | Val  Acc: 0.6952
 Site-QuickDraw                 (0) | Val  Loss: 1.1278 | Val  Acc: 0.6635
 Site-Infograph                 (4) | Val  Loss: 1.1959 | Val  Acc: 0.6095
 Site-Infograph                 (4) | Val  Loss: 1.3033 | Val  Acc: 0.5873
Average Valid Accuracy: 0.7746
 Best site-Clipart                  (1)  | Epoch:6 | Val Acc: 0.8238
 Best site-Clipart                  (1)  | Epoch:6 | Val Acc: 0.8111
 Best site-Real                     (2)  | Epoch:6 | Val Acc: 0.8905
 Best site-Real                     (2)  | Epoch:6 | Val Acc: 0.9127
 Best site-Painting                 (2)  | Epoch:6 | Val Acc: 0.8333
 Best site-Painting                 (2)  | Epoch:6 | Val Acc: 0.8587
 Best site-Sketch                   (3)  | Epoch:6 | Val Acc: 0.8095
 Best site-Sketch                   (3)  | Epoch:6 | Val Acc: 0.8000
 Best site-QuickDraw                (0)  | Epoch:6 | Val Acc: 0.6952
 Best site-QuickDraw                (0)  | Epoch:6 | Val Acc: 0.6635
 Best site-Infograph                (4)  | Epoch:6 | Val Acc: 0.6095
 Best site-Infograph                (4)  | Epoch:6 | Val Acc: 0.5873
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 2, 4, 2, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (0) | Train Loss: 0.5813 | Train Acc: 0.8540
 Site-Clipart                   (0) | Train Loss: 0.6308 | Train Acc: 0.8212
 Site-Real                      (2) | Train Loss: 0.3860 | Train Acc: 0.9302
 Site-Real                      (2) | Train Loss: 0.3998 | Train Acc: 0.9175
 Site-Painting                  (2) | Train Loss: 0.5422 | Train Acc: 0.8508
 Site-Painting                  (2) | Train Loss: 0.5290 | Train Acc: 0.8646
 Site-Sketch                    (4) | Train Loss: 0.5801 | Train Acc: 0.8413
 Site-Sketch                    (4) | Train Loss: 0.6569 | Train Acc: 0.7926
 Site-QuickDraw                 (1) | Train Loss: 1.1309 | Train Acc: 0.6413
 Site-QuickDraw                 (1) | Train Loss: 1.0720 | Train Acc: 0.6984
 Site-Infograph                 (3) | Train Loss: 1.2586 | Train Acc: 0.6254
 Site-Infograph                 (3) | Train Loss: 1.2814 | Train Acc: 0.5852
Average Train Accuracy: 0.7852
 Site-Clipart                   (0) | Val  Loss: 0.6602 | Val  Acc: 0.8286
 Site-Clipart                   (0) | Val  Loss: 0.6724 | Val  Acc: 0.8063
 Site-Real                      (2) | Val  Loss: 0.5359 | Val  Acc: 0.9000
 Site-Real                      (2) | Val  Loss: 0.4193 | Val  Acc: 0.9111
 Site-Painting                  (2) | Val  Loss: 0.6171 | Val  Acc: 0.8286
 Site-Painting                  (2) | Val  Loss: 0.5016 | Val  Acc: 0.8746
 Site-Sketch                    (4) | Val  Loss: 0.7456 | Val  Acc: 0.7810
 Site-Sketch                    (4) | Val  Loss: 0.6581 | Val  Acc: 0.7952
 Site-QuickDraw                 (1) | Val  Loss: 1.0461 | Val  Acc: 0.7238
 Site-QuickDraw                 (1) | Val  Loss: 1.0662 | Val  Acc: 0.6730
 Site-Infograph                 (3) | Val  Loss: 1.1142 | Val  Acc: 0.6333
 Site-Infograph                 (3) | Val  Loss: 1.2542 | Val  Acc: 0.6016
Average Valid Accuracy: 0.7798
 Best site-Clipart                  (0)  | Epoch:7 | Val Acc: 0.8286
 Best site-Clipart                  (0)  | Epoch:7 | Val Acc: 0.8063
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.9000
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.9111
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8286
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8746
 Best site-Sketch                   (4)  | Epoch:7 | Val Acc: 0.7810
 Best site-Sketch                   (4)  | Epoch:7 | Val Acc: 0.7952
 Best site-QuickDraw                (1)  | Epoch:7 | Val Acc: 0.7238
 Best site-QuickDraw                (1)  | Epoch:7 | Val Acc: 0.6730
 Best site-Infograph                (3)  | Epoch:7 | Val Acc: 0.6333
 Best site-Infograph                (3)  | Epoch:7 | Val Acc: 0.6016
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 8 ============
cnt=[3, 2, 3, 2, 2, ]
cnt=[2, 4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (4) | Train Loss: 0.5414 | Train Acc: 0.8540
 Site-Clipart                   (4) | Train Loss: 0.6047 | Train Acc: 0.8265
 Site-Real                      (2) | Train Loss: 0.3596 | Train Acc: 0.9333
 Site-Real                      (2) | Train Loss: 0.3791 | Train Acc: 0.9238
 Site-Painting                  (2) | Train Loss: 0.5347 | Train Acc: 0.8413
 Site-Painting                  (0) | Train Loss: 0.5037 | Train Acc: 0.8646
 Site-Sketch                    (3) | Train Loss: 0.5854 | Train Acc: 0.8095
 Site-Sketch                    (3) | Train Loss: 0.5970 | Train Acc: 0.8265
 Site-QuickDraw                 (1) | Train Loss: 1.0328 | Train Acc: 0.6444
 Site-QuickDraw                 (1) | Train Loss: 0.9772 | Train Acc: 0.7132
 Site-Infograph                 (0) | Train Loss: 1.2437 | Train Acc: 0.6317
 Site-Infograph                 (0) | Train Loss: 1.2623 | Train Acc: 0.5788
Average Train Accuracy: 0.7873
 Site-Clipart                   (4) | Val  Loss: 0.6328 | Val  Acc: 0.8476
 Site-Clipart                   (4) | Val  Loss: 0.5993 | Val  Acc: 0.8222
 Site-Real                      (2) | Val  Loss: 0.4664 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.3972 | Val  Acc: 0.9222
 Site-Painting                  (2) | Val  Loss: 0.5846 | Val  Acc: 0.8286
 Site-Painting                  (0) | Val  Loss: 0.4899 | Val  Acc: 0.8762
 Site-Sketch                    (3) | Val  Loss: 0.6688 | Val  Acc: 0.8048
 Site-Sketch                    (3) | Val  Loss: 0.6131 | Val  Acc: 0.8222
 Site-QuickDraw                 (1) | Val  Loss: 0.9926 | Val  Acc: 0.7190
 Site-QuickDraw                 (1) | Val  Loss: 0.9502 | Val  Acc: 0.7302
 Site-Infograph                 (0) | Val  Loss: 1.1545 | Val  Acc: 0.5952
 Site-Infograph                 (0) | Val  Loss: 1.2197 | Val  Acc: 0.6063
Average Valid Accuracy: 0.7919
 Best site-Clipart                  (4)  | Epoch:8 | Val Acc: 0.8476
 Best site-Clipart                  (4)  | Epoch:8 | Val Acc: 0.8222
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9286
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9222
 Best site-Painting                 (2)  | Epoch:8 | Val Acc: 0.8286
 Best site-Painting                 (0)  | Epoch:8 | Val Acc: 0.8762
 Best site-Sketch                   (3)  | Epoch:8 | Val Acc: 0.8048
 Best site-Sketch                   (3)  | Epoch:8 | Val Acc: 0.8222
 Best site-QuickDraw                (1)  | Epoch:8 | Val Acc: 0.7190
 Best site-QuickDraw                (1)  | Epoch:8 | Val Acc: 0.7302
 Best site-Infograph                (0)  | Epoch:8 | Val Acc: 0.5952
 Best site-Infograph                (0)  | Epoch:8 | Val Acc: 0.6063
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (2) | Train Loss: 0.5314 | Train Acc: 0.8698
 Site-Clipart                   (2) | Train Loss: 0.5978 | Train Acc: 0.8296
 Site-Real                      (3) | Train Loss: 0.3481 | Train Acc: 0.9302
 Site-Real                      (3) | Train Loss: 0.3686 | Train Acc: 0.9249
 Site-Painting                  (0) | Train Loss: 0.4894 | Train Acc: 0.8698
 Site-Painting                  (0) | Train Loss: 0.4954 | Train Acc: 0.8635
 Site-Sketch                    (2) | Train Loss: 0.5416 | Train Acc: 0.8381
 Site-Sketch                    (2) | Train Loss: 0.5947 | Train Acc: 0.8254
 Site-QuickDraw                 (1) | Train Loss: 0.9933 | Train Acc: 0.6952
 Site-QuickDraw                 (1) | Train Loss: 0.9425 | Train Acc: 0.7312
 Site-Infograph                 (4) | Train Loss: 1.1926 | Train Acc: 0.6317
 Site-Infograph                 (4) | Train Loss: 1.1881 | Train Acc: 0.6233
Average Train Accuracy: 0.8027
 Site-Clipart                   (2) | Val  Loss: 0.6558 | Val  Acc: 0.8190
 Site-Clipart                   (2) | Val  Loss: 0.5740 | Val  Acc: 0.8413
 Site-Real                      (3) | Val  Loss: 0.4717 | Val  Acc: 0.9143
 Site-Real                      (3) | Val  Loss: 0.3698 | Val  Acc: 0.9254
 Site-Painting                  (0) | Val  Loss: 0.5373 | Val  Acc: 0.8381
 Site-Painting                  (0) | Val  Loss: 0.4727 | Val  Acc: 0.8651
 Site-Sketch                    (2) | Val  Loss: 0.6993 | Val  Acc: 0.8095
 Site-Sketch                    (2) | Val  Loss: 0.6075 | Val  Acc: 0.8159
 Site-QuickDraw                 (1) | Val  Loss: 0.8893 | Val  Acc: 0.7810
 Site-QuickDraw                 (1) | Val  Loss: 0.9033 | Val  Acc: 0.7381
 Site-Infograph                 (4) | Val  Loss: 1.0431 | Val  Acc: 0.6381
 Site-Infograph                 (4) | Val  Loss: 1.1812 | Val  Acc: 0.6079
Average Valid Accuracy: 0.7995
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8190
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8413
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.9143
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.9254
 Best site-Painting                 (0)  | Epoch:9 | Val Acc: 0.8381
 Best site-Painting                 (0)  | Epoch:9 | Val Acc: 0.8651
 Best site-Sketch                   (2)  | Epoch:9 | Val Acc: 0.8095
 Best site-Sketch                   (2)  | Epoch:9 | Val Acc: 0.8159
 Best site-QuickDraw                (1)  | Epoch:9 | Val Acc: 0.7810
 Best site-QuickDraw                (1)  | Epoch:9 | Val Acc: 0.7381
 Best site-Infograph                (4)  | Epoch:9 | Val Acc: 0.6381
 Best site-Infograph                (4)  | Epoch:9 | Val Acc: 0.6079
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 10 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (0) | Train Loss: 0.4925 | Train Acc: 0.8984
 Site-Clipart                   (0) | Train Loss: 0.5841 | Train Acc: 0.8296
 Site-Real                      (4) | Train Loss: 0.3149 | Train Acc: 0.9365
 Site-Real                      (4) | Train Loss: 0.3576 | Train Acc: 0.9132
 Site-Painting                  (2) | Train Loss: 0.4662 | Train Acc: 0.8603
 Site-Painting                  (2) | Train Loss: 0.4451 | Train Acc: 0.8772
 Site-Sketch                    (0) | Train Loss: 0.5631 | Train Acc: 0.8381
 Site-Sketch                    (0) | Train Loss: 0.5915 | Train Acc: 0.8127
 Site-QuickDraw                 (1) | Train Loss: 0.9648 | Train Acc: 0.6984
 Site-QuickDraw                 (1) | Train Loss: 0.8981 | Train Acc: 0.7323
 Site-Infograph                 (3) | Train Loss: 1.2138 | Train Acc: 0.6127
 Site-Infograph                 (3) | Train Loss: 1.1540 | Train Acc: 0.6265
Average Train Accuracy: 0.8030
 Site-Clipart                   (0) | Val  Loss: 0.5795 | Val  Acc: 0.8429
 Site-Clipart                   (0) | Val  Loss: 0.5557 | Val  Acc: 0.8429
 Site-Real                      (4) | Val  Loss: 0.4173 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.3507 | Val  Acc: 0.9190
 Site-Painting                  (2) | Val  Loss: 0.5172 | Val  Acc: 0.8524
 Site-Painting                  (2) | Val  Loss: 0.4346 | Val  Acc: 0.9000
 Site-Sketch                    (0) | Val  Loss: 0.6395 | Val  Acc: 0.8143
 Site-Sketch                    (0) | Val  Loss: 0.5958 | Val  Acc: 0.8159
 Site-QuickDraw                 (1) | Val  Loss: 0.8437 | Val  Acc: 0.7667
 Site-QuickDraw                 (1) | Val  Loss: 0.8929 | Val  Acc: 0.7508
 Site-Infograph                 (3) | Val  Loss: 1.0197 | Val  Acc: 0.6571
 Site-Infograph                 (3) | Val  Loss: 1.1429 | Val  Acc: 0.6317
Average Valid Accuracy: 0.8106
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8429
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8429
 Best site-Real                     (4)  | Epoch:10 | Val Acc: 0.9333
 Best site-Real                     (4)  | Epoch:10 | Val Acc: 0.9190
 Best site-Painting                 (2)  | Epoch:10 | Val Acc: 0.8524
 Best site-Painting                 (2)  | Epoch:10 | Val Acc: 0.9000
 Best site-Sketch                   (0)  | Epoch:10 | Val Acc: 0.8143
 Best site-Sketch                   (0)  | Epoch:10 | Val Acc: 0.8159
 Best site-QuickDraw                (1)  | Epoch:10 | Val Acc: 0.7667
 Best site-QuickDraw                (1)  | Epoch:10 | Val Acc: 0.7508
 Best site-Infograph                (3)  | Epoch:10 | Val Acc: 0.6571
 Best site-Infograph                (3)  | Epoch:10 | Val Acc: 0.6317
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 11 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (0) | Train Loss: 0.4925 | Train Acc: 0.8635
 Site-Clipart                   (0) | Train Loss: 0.5657 | Train Acc: 0.8370
 Site-Real                      (2) | Train Loss: 0.3163 | Train Acc: 0.9302
 Site-Real                      (2) | Train Loss: 0.3300 | Train Acc: 0.9259
 Site-Painting                  (4) | Train Loss: 0.4668 | Train Acc: 0.8825
 Site-Painting                  (4) | Train Loss: 0.4260 | Train Acc: 0.8868
 Site-Sketch                    (0) | Train Loss: 0.5130 | Train Acc: 0.8317
 Site-Sketch                    (0) | Train Loss: 0.5676 | Train Acc: 0.8254
 Site-QuickDraw                 (1) | Train Loss: 0.9459 | Train Acc: 0.6921
 Site-QuickDraw                 (1) | Train Loss: 0.8941 | Train Acc: 0.7228
 Site-Infograph                 (3) | Train Loss: 1.1660 | Train Acc: 0.6381
 Site-Infograph                 (3) | Train Loss: 1.1236 | Train Acc: 0.6466
Average Train Accuracy: 0.8069
 Site-Clipart                   (0) | Val  Loss: 0.5720 | Val  Acc: 0.8476
 Site-Clipart                   (0) | Val  Loss: 0.5237 | Val  Acc: 0.8508
 Site-Real                      (2) | Val  Loss: 0.4170 | Val  Acc: 0.9429
 Site-Real                      (2) | Val  Loss: 0.3349 | Val  Acc: 0.9333
 Site-Painting                  (4) | Val  Loss: 0.5466 | Val  Acc: 0.8476
 Site-Painting                  (4) | Val  Loss: 0.4226 | Val  Acc: 0.8873
 Site-Sketch                    (0) | Val  Loss: 0.6677 | Val  Acc: 0.7952
 Site-Sketch                    (0) | Val  Loss: 0.5718 | Val  Acc: 0.8270
 Site-QuickDraw                 (1) | Val  Loss: 0.8509 | Val  Acc: 0.7857
 Site-QuickDraw                 (1) | Val  Loss: 0.8511 | Val  Acc: 0.7429
 Site-Infograph                 (3) | Val  Loss: 1.0563 | Val  Acc: 0.6429
 Site-Infograph                 (3) | Val  Loss: 1.1188 | Val  Acc: 0.6429
Average Valid Accuracy: 0.8122
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8476
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8508
 Best site-Real                     (2)  | Epoch:11 | Val Acc: 0.9429
 Best site-Real                     (2)  | Epoch:11 | Val Acc: 0.9333
 Best site-Painting                 (4)  | Epoch:11 | Val Acc: 0.8476
 Best site-Painting                 (4)  | Epoch:11 | Val Acc: 0.8873
 Best site-Sketch                   (0)  | Epoch:11 | Val Acc: 0.7952
 Best site-Sketch                   (0)  | Epoch:11 | Val Acc: 0.8270
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.7857
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.7429
 Best site-Infograph                (3)  | Epoch:11 | Val Acc: 0.6429
 Best site-Infograph                (3)  | Epoch:11 | Val Acc: 0.6429
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 12 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (2) | Train Loss: 0.4757 | Train Acc: 0.8857
 Site-Clipart                   (2) | Train Loss: 0.5562 | Train Acc: 0.8328
 Site-Real                      (0) | Train Loss: 0.3092 | Train Acc: 0.9270
 Site-Real                      (0) | Train Loss: 0.3321 | Train Acc: 0.9217
 Site-Painting                  (0) | Train Loss: 0.4681 | Train Acc: 0.8667
 Site-Painting                  (0) | Train Loss: 0.4303 | Train Acc: 0.8889
 Site-Sketch                    (4) | Train Loss: 0.5065 | Train Acc: 0.8413
 Site-Sketch                    (4) | Train Loss: 0.5760 | Train Acc: 0.8296
 Site-QuickDraw                 (1) | Train Loss: 0.9303 | Train Acc: 0.6889
 Site-QuickDraw                 (1) | Train Loss: 0.8286 | Train Acc: 0.7471
 Site-Infograph                 (3) | Train Loss: 1.1479 | Train Acc: 0.6444
 Site-Infograph                 (3) | Train Loss: 1.1235 | Train Acc: 0.6275
Average Train Accuracy: 0.8085
 Site-Clipart                   (2) | Val  Loss: 0.5616 | Val  Acc: 0.8762
 Site-Clipart                   (2) | Val  Loss: 0.5482 | Val  Acc: 0.8365
 Site-Real                      (0) | Val  Loss: 0.4404 | Val  Acc: 0.9190
 Site-Real                      (0) | Val  Loss: 0.3350 | Val  Acc: 0.9206
 Site-Painting                  (0) | Val  Loss: 0.4892 | Val  Acc: 0.8714
 Site-Painting                  (0) | Val  Loss: 0.4177 | Val  Acc: 0.8937
 Site-Sketch                    (4) | Val  Loss: 0.6598 | Val  Acc: 0.8000
 Site-Sketch                    (4) | Val  Loss: 0.5600 | Val  Acc: 0.8254
 Site-QuickDraw                 (1) | Val  Loss: 0.7692 | Val  Acc: 0.7762
 Site-QuickDraw                 (1) | Val  Loss: 0.8007 | Val  Acc: 0.7587
 Site-Infograph                 (3) | Val  Loss: 1.0017 | Val  Acc: 0.6429
 Site-Infograph                 (3) | Val  Loss: 1.1104 | Val  Acc: 0.6254
Average Valid Accuracy: 0.8122
============ Train epoch 13 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (0) | Train Loss: 0.4747 | Train Acc: 0.8762
 Site-Clipart                   (0) | Train Loss: 0.5044 | Train Acc: 0.8487
 Site-Real                      (4) | Train Loss: 0.2793 | Train Acc: 0.9333
 Site-Real                      (4) | Train Loss: 0.3064 | Train Acc: 0.9312
 Site-Painting                  (2) | Train Loss: 0.4503 | Train Acc: 0.8794
 Site-Painting                  (2) | Train Loss: 0.4084 | Train Acc: 0.8910
 Site-Sketch                    (0) | Train Loss: 0.5337 | Train Acc: 0.8159
 Site-Sketch                    (0) | Train Loss: 0.5571 | Train Acc: 0.8254
 Site-QuickDraw                 (1) | Train Loss: 0.8595 | Train Acc: 0.7111
 Site-QuickDraw                 (1) | Train Loss: 0.7767 | Train Acc: 0.7704
 Site-Infograph                 (3) | Train Loss: 1.1475 | Train Acc: 0.6317
 Site-Infograph                 (3) | Train Loss: 1.0974 | Train Acc: 0.6476
Average Train Accuracy: 0.8135
 Site-Clipart                   (0) | Val  Loss: 0.5476 | Val  Acc: 0.8429
 Site-Clipart                   (0) | Val  Loss: 0.5204 | Val  Acc: 0.8381
 Site-Real                      (4) | Val  Loss: 0.3917 | Val  Acc: 0.9238
 Site-Real                      (4) | Val  Loss: 0.3069 | Val  Acc: 0.9365
 Site-Painting                  (2) | Val  Loss: 0.4389 | Val  Acc: 0.8762
 Site-Painting                  (2) | Val  Loss: 0.4138 | Val  Acc: 0.9032
 Site-Sketch                    (0) | Val  Loss: 0.6765 | Val  Acc: 0.8048
 Site-Sketch                    (0) | Val  Loss: 0.5318 | Val  Acc: 0.8444
 Site-QuickDraw                 (1) | Val  Loss: 0.7406 | Val  Acc: 0.8238
 Site-QuickDraw                 (1) | Val  Loss: 0.7689 | Val  Acc: 0.7683
 Site-Infograph                 (3) | Val  Loss: 1.0158 | Val  Acc: 0.6571
 Site-Infograph                 (3) | Val  Loss: 1.0917 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8233
 Best site-Clipart                  (0)  | Epoch:13 | Val Acc: 0.8429
 Best site-Clipart                  (0)  | Epoch:13 | Val Acc: 0.8381
 Best site-Real                     (4)  | Epoch:13 | Val Acc: 0.9238
 Best site-Real                     (4)  | Epoch:13 | Val Acc: 0.9365
 Best site-Painting                 (2)  | Epoch:13 | Val Acc: 0.8762
 Best site-Painting                 (2)  | Epoch:13 | Val Acc: 0.9032
 Best site-Sketch                   (0)  | Epoch:13 | Val Acc: 0.8048
 Best site-Sketch                   (0)  | Epoch:13 | Val Acc: 0.8444
 Best site-QuickDraw                (1)  | Epoch:13 | Val Acc: 0.8238
 Best site-QuickDraw                (1)  | Epoch:13 | Val Acc: 0.7683
 Best site-Infograph                (3)  | Epoch:13 | Val Acc: 0.6571
 Best site-Infograph                (3)  | Epoch:13 | Val Acc: 0.6603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 4, 2, 2, 2, ]
cnt=[2, 4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (1) | Train Loss: 0.4676 | Train Acc: 0.8762
 Site-Clipart                   (1) | Train Loss: 0.5164 | Train Acc: 0.8540
 Site-Real                      (4) | Train Loss: 0.2912 | Train Acc: 0.9302
 Site-Real                      (4) | Train Loss: 0.3073 | Train Acc: 0.9291
 Site-Painting                  (3) | Train Loss: 0.4427 | Train Acc: 0.8571
 Site-Painting                  (3) | Train Loss: 0.4048 | Train Acc: 0.8868
 Site-Sketch                    (1) | Train Loss: 0.5144 | Train Acc: 0.8413
 Site-Sketch                    (1) | Train Loss: 0.5393 | Train Acc: 0.8307
 Site-QuickDraw                 (0) | Train Loss: 0.8777 | Train Acc: 0.7079
 Site-QuickDraw                 (0) | Train Loss: 0.7711 | Train Acc: 0.7693
 Site-Infograph                 (2) | Train Loss: 1.0765 | Train Acc: 0.6667
 Site-Infograph                 (2) | Train Loss: 1.0772 | Train Acc: 0.6550
Average Train Accuracy: 0.8170
 Site-Clipart                   (1) | Val  Loss: 0.5167 | Val  Acc: 0.8810
 Site-Clipart                   (1) | Val  Loss: 0.4873 | Val  Acc: 0.8571
 Site-Real                      (4) | Val  Loss: 0.4003 | Val  Acc: 0.9381
 Site-Real                      (4) | Val  Loss: 0.3164 | Val  Acc: 0.9206
 Site-Painting                  (3) | Val  Loss: 0.5199 | Val  Acc: 0.8571
 Site-Painting                  (3) | Val  Loss: 0.3968 | Val  Acc: 0.8921
 Site-Sketch                    (1) | Val  Loss: 0.6660 | Val  Acc: 0.7857
 Site-Sketch                    (1) | Val  Loss: 0.5334 | Val  Acc: 0.8286
 Site-QuickDraw                 (0) | Val  Loss: 0.6865 | Val  Acc: 0.8238
 Site-QuickDraw                 (0) | Val  Loss: 0.7241 | Val  Acc: 0.7952
 Site-Infograph                 (2) | Val  Loss: 0.9580 | Val  Acc: 0.6762
 Site-Infograph                 (2) | Val  Loss: 1.0665 | Val  Acc: 0.6651
Average Valid Accuracy: 0.8267
 Best site-Clipart                  (1)  | Epoch:14 | Val Acc: 0.8810
 Best site-Clipart                  (1)  | Epoch:14 | Val Acc: 0.8571
 Best site-Real                     (4)  | Epoch:14 | Val Acc: 0.9381
 Best site-Real                     (4)  | Epoch:14 | Val Acc: 0.9206
 Best site-Painting                 (3)  | Epoch:14 | Val Acc: 0.8571
 Best site-Painting                 (3)  | Epoch:14 | Val Acc: 0.8921
 Best site-Sketch                   (1)  | Epoch:14 | Val Acc: 0.7857
 Best site-Sketch                   (1)  | Epoch:14 | Val Acc: 0.8286
 Best site-QuickDraw                (0)  | Epoch:14 | Val Acc: 0.8238
 Best site-QuickDraw                (0)  | Epoch:14 | Val Acc: 0.7952
 Best site-Infograph                (2)  | Epoch:14 | Val Acc: 0.6762
 Best site-Infograph                (2)  | Epoch:14 | Val Acc: 0.6651
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (4) | Train Loss: 0.4787 | Train Acc: 0.8635
 Site-Clipart                   (4) | Train Loss: 0.4895 | Train Acc: 0.8677
 Site-Real                      (2) | Train Loss: 0.2790 | Train Acc: 0.9302
 Site-Real                      (2) | Train Loss: 0.3058 | Train Acc: 0.9185
 Site-Painting                  (2) | Train Loss: 0.4154 | Train Acc: 0.8762
 Site-Painting                  (2) | Train Loss: 0.4139 | Train Acc: 0.8878
 Site-Sketch                    (0) | Train Loss: 0.5197 | Train Acc: 0.8381
 Site-Sketch                    (0) | Train Loss: 0.5484 | Train Acc: 0.8116
 Site-QuickDraw                 (1) | Train Loss: 0.8519 | Train Acc: 0.7397
 Site-QuickDraw                 (1) | Train Loss: 0.7620 | Train Acc: 0.7619
 Site-Infograph                 (3) | Train Loss: 1.1090 | Train Acc: 0.6508
 Site-Infograph                 (3) | Train Loss: 1.0421 | Train Acc: 0.6751
Average Train Accuracy: 0.8184
 Site-Clipart                   (4) | Val  Loss: 0.4959 | Val  Acc: 0.8619
 Site-Clipart                   (4) | Val  Loss: 0.4840 | Val  Acc: 0.8603
 Site-Real                      (2) | Val  Loss: 0.4035 | Val  Acc: 0.9238
 Site-Real                      (2) | Val  Loss: 0.3021 | Val  Acc: 0.9254
 Site-Painting                  (2) | Val  Loss: 0.4926 | Val  Acc: 0.8429
 Site-Painting                  (2) | Val  Loss: 0.4167 | Val  Acc: 0.8810
 Site-Sketch                    (0) | Val  Loss: 0.6506 | Val  Acc: 0.7905
 Site-Sketch                    (0) | Val  Loss: 0.5312 | Val  Acc: 0.8349
 Site-QuickDraw                 (1) | Val  Loss: 0.6991 | Val  Acc: 0.7905
 Site-QuickDraw                 (1) | Val  Loss: 0.7299 | Val  Acc: 0.7810
 Site-Infograph                 (3) | Val  Loss: 0.9539 | Val  Acc: 0.6952
 Site-Infograph                 (3) | Val  Loss: 1.0528 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8206
============ Train epoch 16 ============
cnt=[4, 2, 1, 2, 3, ]
cnt=[2, 2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (2) | Train Loss: 0.4554 | Train Acc: 0.8825
 Site-Clipart                   (4) | Train Loss: 0.4940 | Train Acc: 0.8561
 Site-Real                      (3) | Train Loss: 0.2590 | Train Acc: 0.9365
 Site-Real                      (3) | Train Loss: 0.2678 | Train Acc: 0.9323
 Site-Painting                  (0) | Train Loss: 0.3711 | Train Acc: 0.8794
 Site-Painting                  (0) | Train Loss: 0.3572 | Train Acc: 0.9175
 Site-Sketch                    (4) | Train Loss: 0.4948 | Train Acc: 0.8413
 Site-Sketch                    (4) | Train Loss: 0.5135 | Train Acc: 0.8413
 Site-QuickDraw                 (1) | Train Loss: 0.8630 | Train Acc: 0.7143
 Site-QuickDraw                 (1) | Train Loss: 0.7535 | Train Acc: 0.7693
 Site-Infograph                 (0) | Train Loss: 1.1189 | Train Acc: 0.6762
 Site-Infograph                 (0) | Train Loss: 1.0392 | Train Acc: 0.6635
Average Train Accuracy: 0.8258
 Site-Clipart                   (2) | Val  Loss: 0.5131 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.4884 | Val  Acc: 0.8603
 Site-Real                      (3) | Val  Loss: 0.3740 | Val  Acc: 0.9190
 Site-Real                      (3) | Val  Loss: 0.2666 | Val  Acc: 0.9413
 Site-Painting                  (0) | Val  Loss: 0.4314 | Val  Acc: 0.9000
 Site-Painting                  (0) | Val  Loss: 0.3656 | Val  Acc: 0.9016
 Site-Sketch                    (4) | Val  Loss: 0.6108 | Val  Acc: 0.8333
 Site-Sketch                    (4) | Val  Loss: 0.5271 | Val  Acc: 0.8349
 Site-QuickDraw                 (1) | Val  Loss: 0.7149 | Val  Acc: 0.7762
 Site-QuickDraw                 (1) | Val  Loss: 0.7410 | Val  Acc: 0.7810
 Site-Infograph                 (0) | Val  Loss: 0.9555 | Val  Acc: 0.6667
 Site-Infograph                 (0) | Val  Loss: 1.0456 | Val  Acc: 0.6651
Average Valid Accuracy: 0.8288
 Best site-Clipart                  (2)  | Epoch:16 | Val Acc: 0.8667
 Best site-Clipart                  (4)  | Epoch:16 | Val Acc: 0.8603
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9190
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9413
 Best site-Painting                 (0)  | Epoch:16 | Val Acc: 0.9000
 Best site-Painting                 (0)  | Epoch:16 | Val Acc: 0.9016
 Best site-Sketch                   (4)  | Epoch:16 | Val Acc: 0.8333
 Best site-Sketch                   (4)  | Epoch:16 | Val Acc: 0.8349
 Best site-QuickDraw                (1)  | Epoch:16 | Val Acc: 0.7762
 Best site-QuickDraw                (1)  | Epoch:16 | Val Acc: 0.7810
 Best site-Infograph                (0)  | Epoch:16 | Val Acc: 0.6667
 Best site-Infograph                (0)  | Epoch:16 | Val Acc: 0.6651
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 17 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[2, 4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (0) | Train Loss: 0.4209 | Train Acc: 0.8889
 Site-Clipart                   (0) | Train Loss: 0.4880 | Train Acc: 0.8519
 Site-Real                      (4) | Train Loss: 0.2745 | Train Acc: 0.9365
 Site-Real                      (4) | Train Loss: 0.2795 | Train Acc: 0.9344
 Site-Painting                  (2) | Train Loss: 0.4219 | Train Acc: 0.8730
 Site-Painting                  (2) | Train Loss: 0.3895 | Train Acc: 0.8952
 Site-Sketch                    (0) | Train Loss: 0.4839 | Train Acc: 0.8476
 Site-Sketch                    (0) | Train Loss: 0.5284 | Train Acc: 0.8339
 Site-QuickDraw                 (1) | Train Loss: 0.8276 | Train Acc: 0.7333
 Site-QuickDraw                 (1) | Train Loss: 0.7543 | Train Acc: 0.7608
 Site-Infograph                 (3) | Train Loss: 1.1138 | Train Acc: 0.6667
 Site-Infograph                 (3) | Train Loss: 1.0198 | Train Acc: 0.6635
Average Train Accuracy: 0.8238
 Site-Clipart                   (0) | Val  Loss: 0.5271 | Val  Acc: 0.8571
 Site-Clipart                   (0) | Val  Loss: 0.4688 | Val  Acc: 0.8476
 Site-Real                      (4) | Val  Loss: 0.3766 | Val  Acc: 0.9429
 Site-Real                      (4) | Val  Loss: 0.2976 | Val  Acc: 0.9270
 Site-Painting                  (2) | Val  Loss: 0.4240 | Val  Acc: 0.8952
 Site-Painting                  (2) | Val  Loss: 0.3808 | Val  Acc: 0.9000
 Site-Sketch                    (0) | Val  Loss: 0.6087 | Val  Acc: 0.8286
 Site-Sketch                    (0) | Val  Loss: 0.5258 | Val  Acc: 0.8397
 Site-QuickDraw                 (1) | Val  Loss: 0.7492 | Val  Acc: 0.7905
 Site-QuickDraw                 (1) | Val  Loss: 0.7138 | Val  Acc: 0.7825
 Site-Infograph                 (3) | Val  Loss: 0.9441 | Val  Acc: 0.6952
 Site-Infograph                 (3) | Val  Loss: 1.0219 | Val  Acc: 0.6905
Average Valid Accuracy: 0.8331
 Best site-Clipart                  (0)  | Epoch:17 | Val Acc: 0.8571
 Best site-Clipart                  (0)  | Epoch:17 | Val Acc: 0.8476
 Best site-Real                     (4)  | Epoch:17 | Val Acc: 0.9429
 Best site-Real                     (4)  | Epoch:17 | Val Acc: 0.9270
 Best site-Painting                 (2)  | Epoch:17 | Val Acc: 0.8952
 Best site-Painting                 (2)  | Epoch:17 | Val Acc: 0.9000
 Best site-Sketch                   (0)  | Epoch:17 | Val Acc: 0.8286
 Best site-Sketch                   (0)  | Epoch:17 | Val Acc: 0.8397
 Best site-QuickDraw                (1)  | Epoch:17 | Val Acc: 0.7905
 Best site-QuickDraw                (1)  | Epoch:17 | Val Acc: 0.7825
 Best site-Infograph                (3)  | Epoch:17 | Val Acc: 0.6952
 Best site-Infograph                (3)  | Epoch:17 | Val Acc: 0.6905
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 18 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (0) | Train Loss: 0.4257 | Train Acc: 0.8762
 Site-Clipart                   (0) | Train Loss: 0.4895 | Train Acc: 0.8487
 Site-Real                      (4) | Train Loss: 0.2711 | Train Acc: 0.9302
 Site-Real                      (4) | Train Loss: 0.2762 | Train Acc: 0.9280
 Site-Painting                  (2) | Train Loss: 0.4081 | Train Acc: 0.8603
 Site-Painting                  (2) | Train Loss: 0.3637 | Train Acc: 0.8931
 Site-Sketch                    (0) | Train Loss: 0.5221 | Train Acc: 0.8444
 Site-Sketch                    (0) | Train Loss: 0.5354 | Train Acc: 0.8275
 Site-QuickDraw                 (1) | Train Loss: 0.8495 | Train Acc: 0.7302
 Site-QuickDraw                 (1) | Train Loss: 0.7357 | Train Acc: 0.7841
 Site-Infograph                 (3) | Train Loss: 1.1266 | Train Acc: 0.6603
 Site-Infograph                 (3) | Train Loss: 0.9965 | Train Acc: 0.6868
Average Train Accuracy: 0.8225
 Site-Clipart                   (0) | Val  Loss: 0.4537 | Val  Acc: 0.8857
 Site-Clipart                   (0) | Val  Loss: 0.4827 | Val  Acc: 0.8349
 Site-Real                      (4) | Val  Loss: 0.3776 | Val  Acc: 0.9190
 Site-Real                      (4) | Val  Loss: 0.2914 | Val  Acc: 0.9286
 Site-Painting                  (2) | Val  Loss: 0.4483 | Val  Acc: 0.8810
 Site-Painting                  (2) | Val  Loss: 0.3877 | Val  Acc: 0.8952
 Site-Sketch                    (0) | Val  Loss: 0.6086 | Val  Acc: 0.8286
 Site-Sketch                    (0) | Val  Loss: 0.5254 | Val  Acc: 0.8349
 Site-QuickDraw                 (1) | Val  Loss: 0.6952 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.6874 | Val  Acc: 0.7810
 Site-Infograph                 (3) | Val  Loss: 0.8507 | Val  Acc: 0.6810
 Site-Infograph                 (3) | Val  Loss: 0.9891 | Val  Acc: 0.6762
Average Valid Accuracy: 0.8296
============ Train epoch 19 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (0) | Train Loss: 0.4249 | Train Acc: 0.8730
 Site-Clipart                   (0) | Train Loss: 0.4703 | Train Acc: 0.8624
 Site-Real                      (4) | Train Loss: 0.2700 | Train Acc: 0.9460
 Site-Real                      (4) | Train Loss: 0.2811 | Train Acc: 0.9280
 Site-Painting                  (2) | Train Loss: 0.3999 | Train Acc: 0.8540
 Site-Painting                  (2) | Train Loss: 0.3582 | Train Acc: 0.9079
 Site-Sketch                    (0) | Train Loss: 0.4698 | Train Acc: 0.8540
 Site-Sketch                    (0) | Train Loss: 0.5027 | Train Acc: 0.8392
 Site-QuickDraw                 (1) | Train Loss: 0.7888 | Train Acc: 0.7302
 Site-QuickDraw                 (1) | Train Loss: 0.7107 | Train Acc: 0.7788
 Site-Infograph                 (3) | Train Loss: 1.0693 | Train Acc: 0.6508
 Site-Infograph                 (3) | Train Loss: 0.9982 | Train Acc: 0.6783
Average Train Accuracy: 0.8252
 Site-Clipart                   (0) | Val  Loss: 0.4560 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.4699 | Val  Acc: 0.8603
 Site-Real                      (4) | Val  Loss: 0.3675 | Val  Acc: 0.9190
 Site-Real                      (4) | Val  Loss: 0.2853 | Val  Acc: 0.9317
 Site-Painting                  (2) | Val  Loss: 0.4352 | Val  Acc: 0.8810
 Site-Painting                  (2) | Val  Loss: 0.3510 | Val  Acc: 0.8937
 Site-Sketch                    (0) | Val  Loss: 0.5546 | Val  Acc: 0.8286
 Site-Sketch                    (0) | Val  Loss: 0.4858 | Val  Acc: 0.8381
 Site-QuickDraw                 (1) | Val  Loss: 0.6614 | Val  Acc: 0.8000
 Site-QuickDraw                 (1) | Val  Loss: 0.6671 | Val  Acc: 0.8016
 Site-Infograph                 (3) | Val  Loss: 0.8824 | Val  Acc: 0.6905
 Site-Infograph                 (3) | Val  Loss: 0.9777 | Val  Acc: 0.6873
Average Valid Accuracy: 0.8360
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.9000
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8603
 Best site-Real                     (4)  | Epoch:19 | Val Acc: 0.9190
 Best site-Real                     (4)  | Epoch:19 | Val Acc: 0.9317
 Best site-Painting                 (2)  | Epoch:19 | Val Acc: 0.8810
 Best site-Painting                 (2)  | Epoch:19 | Val Acc: 0.8937
 Best site-Sketch                   (0)  | Epoch:19 | Val Acc: 0.8286
 Best site-Sketch                   (0)  | Epoch:19 | Val Acc: 0.8381
 Best site-QuickDraw                (1)  | Epoch:19 | Val Acc: 0.8000
 Best site-QuickDraw                (1)  | Epoch:19 | Val Acc: 0.8016
 Best site-Infograph                (3)  | Epoch:19 | Val Acc: 0.6905
 Best site-Infograph                (3)  | Epoch:19 | Val Acc: 0.6873
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 20 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (0) | Train Loss: 0.4152 | Train Acc: 0.8635
 Site-Clipart                   (0) | Train Loss: 0.4707 | Train Acc: 0.8624
 Site-Real                      (4) | Train Loss: 0.2615 | Train Acc: 0.9333
 Site-Real                      (4) | Train Loss: 0.2647 | Train Acc: 0.9344
 Site-Painting                  (3) | Train Loss: 0.3831 | Train Acc: 0.8698
 Site-Painting                  (3) | Train Loss: 0.3521 | Train Acc: 0.9048
 Site-Sketch                    (0) | Train Loss: 0.4535 | Train Acc: 0.8635
 Site-Sketch                    (0) | Train Loss: 0.5298 | Train Acc: 0.8296
 Site-QuickDraw                 (1) | Train Loss: 0.7922 | Train Acc: 0.7270
 Site-QuickDraw                 (1) | Train Loss: 0.6781 | Train Acc: 0.7873
 Site-Infograph                 (2) | Train Loss: 1.0614 | Train Acc: 0.6762
 Site-Infograph                 (2) | Train Loss: 0.9768 | Train Acc: 0.6878
Average Train Accuracy: 0.8283
 Site-Clipart                   (0) | Val  Loss: 0.5120 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.4403 | Val  Acc: 0.8683
 Site-Real                      (4) | Val  Loss: 0.3217 | Val  Acc: 0.9429
 Site-Real                      (4) | Val  Loss: 0.2795 | Val  Acc: 0.9286
 Site-Painting                  (3) | Val  Loss: 0.4117 | Val  Acc: 0.8810
 Site-Painting                  (3) | Val  Loss: 0.3593 | Val  Acc: 0.8968
 Site-Sketch                    (0) | Val  Loss: 0.6922 | Val  Acc: 0.8238
 Site-Sketch                    (0) | Val  Loss: 0.4813 | Val  Acc: 0.8524
 Site-QuickDraw                 (1) | Val  Loss: 0.6748 | Val  Acc: 0.8238
 Site-QuickDraw                 (1) | Val  Loss: 0.6866 | Val  Acc: 0.7873
 Site-Infograph                 (2) | Val  Loss: 0.8902 | Val  Acc: 0.6810
 Site-Infograph                 (2) | Val  Loss: 0.9770 | Val  Acc: 0.6825
Average Valid Accuracy: 0.8362
 Best site-Clipart                  (0)  | Epoch:20 | Val Acc: 0.8667
 Best site-Clipart                  (0)  | Epoch:20 | Val Acc: 0.8683
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9429
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9286
 Best site-Painting                 (3)  | Epoch:20 | Val Acc: 0.8810
 Best site-Painting                 (3)  | Epoch:20 | Val Acc: 0.8968
 Best site-Sketch                   (0)  | Epoch:20 | Val Acc: 0.8238
 Best site-Sketch                   (0)  | Epoch:20 | Val Acc: 0.8524
 Best site-QuickDraw                (1)  | Epoch:20 | Val Acc: 0.8238
 Best site-QuickDraw                (1)  | Epoch:20 | Val Acc: 0.7873
 Best site-Infograph                (2)  | Epoch:20 | Val Acc: 0.6810
 Best site-Infograph                (2)  | Epoch:20 | Val Acc: 0.6825
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 21 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[2, 2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (2) | Train Loss: 0.4038 | Train Acc: 0.8921
 Site-Clipart                   (2) | Train Loss: 0.4577 | Train Acc: 0.8635
 Site-Real                      (0) | Train Loss: 0.2427 | Train Acc: 0.9397
 Site-Real                      (0) | Train Loss: 0.2560 | Train Acc: 0.9354
 Site-Painting                  (0) | Train Loss: 0.3938 | Train Acc: 0.8762
 Site-Painting                  (0) | Train Loss: 0.3451 | Train Acc: 0.9079
 Site-Sketch                    (4) | Train Loss: 0.4472 | Train Acc: 0.8476
 Site-Sketch                    (4) | Train Loss: 0.4885 | Train Acc: 0.8508
 Site-QuickDraw                 (1) | Train Loss: 0.7896 | Train Acc: 0.7270
 Site-QuickDraw                 (1) | Train Loss: 0.7014 | Train Acc: 0.7831
 Site-Infograph                 (3) | Train Loss: 1.1117 | Train Acc: 0.6540
 Site-Infograph                 (3) | Train Loss: 0.9722 | Train Acc: 0.6931
Average Train Accuracy: 0.8309
 Site-Clipart                   (2) | Val  Loss: 0.4736 | Val  Acc: 0.8810
 Site-Clipart                   (2) | Val  Loss: 0.4399 | Val  Acc: 0.8635
 Site-Real                      (0) | Val  Loss: 0.3417 | Val  Acc: 0.9190
 Site-Real                      (0) | Val  Loss: 0.2633 | Val  Acc: 0.9381
 Site-Painting                  (0) | Val  Loss: 0.4107 | Val  Acc: 0.8762
 Site-Painting                  (0) | Val  Loss: 0.3667 | Val  Acc: 0.8984
 Site-Sketch                    (4) | Val  Loss: 0.5875 | Val  Acc: 0.8333
 Site-Sketch                    (4) | Val  Loss: 0.5142 | Val  Acc: 0.8254
 Site-QuickDraw                 (1) | Val  Loss: 0.6903 | Val  Acc: 0.8238
 Site-QuickDraw                 (1) | Val  Loss: 0.6735 | Val  Acc: 0.7921
 Site-Infograph                 (3) | Val  Loss: 0.8152 | Val  Acc: 0.7667
 Site-Infograph                 (3) | Val  Loss: 0.9348 | Val  Acc: 0.6984
Average Valid Accuracy: 0.8430
 Best site-Clipart                  (2)  | Epoch:21 | Val Acc: 0.8810
 Best site-Clipart                  (2)  | Epoch:21 | Val Acc: 0.8635
 Best site-Real                     (0)  | Epoch:21 | Val Acc: 0.9190
 Best site-Real                     (0)  | Epoch:21 | Val Acc: 0.9381
 Best site-Painting                 (0)  | Epoch:21 | Val Acc: 0.8762
 Best site-Painting                 (0)  | Epoch:21 | Val Acc: 0.8984
 Best site-Sketch                   (4)  | Epoch:21 | Val Acc: 0.8333
 Best site-Sketch                   (4)  | Epoch:21 | Val Acc: 0.8254
 Best site-QuickDraw                (1)  | Epoch:21 | Val Acc: 0.8238
 Best site-QuickDraw                (1)  | Epoch:21 | Val Acc: 0.7921
 Best site-Infograph                (3)  | Epoch:21 | Val Acc: 0.7667
 Best site-Infograph                (3)  | Epoch:21 | Val Acc: 0.6984
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 2, 4, 2, 2, ]
cnt=[2, 4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (2) | Train Loss: 0.4158 | Train Acc: 0.8794
 Site-Clipart                   (2) | Train Loss: 0.4455 | Train Acc: 0.8624
 Site-Real                      (4) | Train Loss: 0.2478 | Train Acc: 0.9397
 Site-Real                      (4) | Train Loss: 0.2560 | Train Acc: 0.9365
 Site-Painting                  (0) | Train Loss: 0.3960 | Train Acc: 0.8635
 Site-Painting                  (0) | Train Loss: 0.3445 | Train Acc: 0.9026
 Site-Sketch                    (2) | Train Loss: 0.4360 | Train Acc: 0.8762
 Site-Sketch                    (2) | Train Loss: 0.4855 | Train Acc: 0.8582
 Site-QuickDraw                 (1) | Train Loss: 0.7618 | Train Acc: 0.7683
 Site-QuickDraw                 (1) | Train Loss: 0.6886 | Train Acc: 0.7905
 Site-Infograph                 (3) | Train Loss: 1.0992 | Train Acc: 0.6508
 Site-Infograph                 (3) | Train Loss: 0.9302 | Train Acc: 0.7079
Average Train Accuracy: 0.8363
 Site-Clipart                   (2) | Val  Loss: 0.4702 | Val  Acc: 0.8810
 Site-Clipart                   (2) | Val  Loss: 0.4381 | Val  Acc: 0.8683
 Site-Real                      (4) | Val  Loss: 0.3785 | Val  Acc: 0.9190
 Site-Real                      (4) | Val  Loss: 0.2635 | Val  Acc: 0.9349
 Site-Painting                  (0) | Val  Loss: 0.4422 | Val  Acc: 0.8571
 Site-Painting                  (0) | Val  Loss: 0.3431 | Val  Acc: 0.9111
 Site-Sketch                    (2) | Val  Loss: 0.6051 | Val  Acc: 0.8190
 Site-Sketch                    (2) | Val  Loss: 0.5063 | Val  Acc: 0.8381
 Site-QuickDraw                 (1) | Val  Loss: 0.6204 | Val  Acc: 0.8333
 Site-QuickDraw                 (1) | Val  Loss: 0.6525 | Val  Acc: 0.7937
 Site-Infograph                 (3) | Val  Loss: 0.9129 | Val  Acc: 0.7238
 Site-Infograph                 (3) | Val  Loss: 0.9302 | Val  Acc: 0.7206
Average Valid Accuracy: 0.8417
============ Train epoch 23 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[2, 4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (0) | Train Loss: 0.3990 | Train Acc: 0.8825
 Site-Clipart                   (0) | Train Loss: 0.4472 | Train Acc: 0.8688
 Site-Real                      (4) | Train Loss: 0.2505 | Train Acc: 0.9365
 Site-Real                      (4) | Train Loss: 0.2549 | Train Acc: 0.9386
 Site-Painting                  (2) | Train Loss: 0.3622 | Train Acc: 0.8889
 Site-Painting                  (2) | Train Loss: 0.3467 | Train Acc: 0.9048
 Site-Sketch                    (0) | Train Loss: 0.4862 | Train Acc: 0.8508
 Site-Sketch                    (0) | Train Loss: 0.4751 | Train Acc: 0.8582
 Site-QuickDraw                 (1) | Train Loss: 0.7768 | Train Acc: 0.7365
 Site-QuickDraw                 (1) | Train Loss: 0.6581 | Train Acc: 0.8032
 Site-Infograph                 (3) | Train Loss: 1.0479 | Train Acc: 0.6730
 Site-Infograph                 (3) | Train Loss: 0.9368 | Train Acc: 0.6836
Average Train Accuracy: 0.8354
 Site-Clipart                   (0) | Val  Loss: 0.4720 | Val  Acc: 0.8762
 Site-Clipart                   (0) | Val  Loss: 0.4259 | Val  Acc: 0.8619
 Site-Real                      (4) | Val  Loss: 0.3583 | Val  Acc: 0.9238
 Site-Real                      (4) | Val  Loss: 0.2785 | Val  Acc: 0.9222
 Site-Painting                  (2) | Val  Loss: 0.3545 | Val  Acc: 0.9095
 Site-Painting                  (2) | Val  Loss: 0.3466 | Val  Acc: 0.9016
 Site-Sketch                    (0) | Val  Loss: 0.5524 | Val  Acc: 0.8476
 Site-Sketch                    (0) | Val  Loss: 0.5164 | Val  Acc: 0.8286
 Site-QuickDraw                 (1) | Val  Loss: 0.6391 | Val  Acc: 0.8143
 Site-QuickDraw                 (1) | Val  Loss: 0.6363 | Val  Acc: 0.8095
 Site-Infograph                 (3) | Val  Loss: 0.8605 | Val  Acc: 0.7143
 Site-Infograph                 (3) | Val  Loss: 0.9177 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8437
 Best site-Clipart                  (0)  | Epoch:23 | Val Acc: 0.8762
 Best site-Clipart                  (0)  | Epoch:23 | Val Acc: 0.8619
 Best site-Real                     (4)  | Epoch:23 | Val Acc: 0.9238
 Best site-Real                     (4)  | Epoch:23 | Val Acc: 0.9222
 Best site-Painting                 (2)  | Epoch:23 | Val Acc: 0.9095
 Best site-Painting                 (2)  | Epoch:23 | Val Acc: 0.9016
 Best site-Sketch                   (0)  | Epoch:23 | Val Acc: 0.8476
 Best site-Sketch                   (0)  | Epoch:23 | Val Acc: 0.8286
 Best site-QuickDraw                (1)  | Epoch:23 | Val Acc: 0.8143
 Best site-QuickDraw                (1)  | Epoch:23 | Val Acc: 0.8095
 Best site-Infograph                (3)  | Epoch:23 | Val Acc: 0.7143
 Best site-Infograph                (3)  | Epoch:23 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 24 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (4) | Train Loss: 0.4194 | Train Acc: 0.8825
 Site-Clipart                   (4) | Train Loss: 0.4650 | Train Acc: 0.8582
 Site-Real                      (0) | Train Loss: 0.2465 | Train Acc: 0.9333
 Site-Real                      (0) | Train Loss: 0.2611 | Train Acc: 0.9249
 Site-Painting                  (0) | Train Loss: 0.3788 | Train Acc: 0.8730
 Site-Painting                  (0) | Train Loss: 0.3453 | Train Acc: 0.8921
 Site-Sketch                    (3) | Train Loss: 0.4478 | Train Acc: 0.8476
 Site-Sketch                    (3) | Train Loss: 0.4956 | Train Acc: 0.8423
 Site-QuickDraw                 (1) | Train Loss: 0.7201 | Train Acc: 0.7905
 Site-QuickDraw                 (1) | Train Loss: 0.6576 | Train Acc: 0.7905
 Site-Infograph                 (2) | Train Loss: 1.0359 | Train Acc: 0.6825
 Site-Infograph                 (2) | Train Loss: 0.8991 | Train Acc: 0.7143
Average Train Accuracy: 0.8360
 Site-Clipart                   (4) | Val  Loss: 0.4580 | Val  Acc: 0.8905
 Site-Clipart                   (4) | Val  Loss: 0.4401 | Val  Acc: 0.8524
 Site-Real                      (0) | Val  Loss: 0.3530 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.2571 | Val  Acc: 0.9349
 Site-Painting                  (0) | Val  Loss: 0.4089 | Val  Acc: 0.9048
 Site-Painting                  (0) | Val  Loss: 0.3580 | Val  Acc: 0.8921
 Site-Sketch                    (3) | Val  Loss: 0.5310 | Val  Acc: 0.8476
 Site-Sketch                    (3) | Val  Loss: 0.5273 | Val  Acc: 0.8270
 Site-QuickDraw                 (1) | Val  Loss: 0.6085 | Val  Acc: 0.8333
 Site-QuickDraw                 (1) | Val  Loss: 0.6566 | Val  Acc: 0.7810
 Site-Infograph                 (2) | Val  Loss: 0.8463 | Val  Acc: 0.7143
 Site-Infograph                 (2) | Val  Loss: 0.9240 | Val  Acc: 0.6984
Average Valid Accuracy: 0.8421
============ Train epoch 25 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (0) | Train Loss: 0.3849 | Train Acc: 0.8984
 Site-Clipart                   (0) | Train Loss: 0.4604 | Train Acc: 0.8497
 Site-Real                      (0) | Train Loss: 0.2313 | Train Acc: 0.9365
 Site-Real                      (0) | Train Loss: 0.2375 | Train Acc: 0.9376
 Site-Painting                  (3) | Train Loss: 0.3850 | Train Acc: 0.8794
 Site-Painting                  (3) | Train Loss: 0.3398 | Train Acc: 0.9037
 Site-Sketch                    (4) | Train Loss: 0.4379 | Train Acc: 0.8571
 Site-Sketch                    (4) | Train Loss: 0.4725 | Train Acc: 0.8455
 Site-QuickDraw                 (1) | Train Loss: 0.7429 | Train Acc: 0.7587
 Site-QuickDraw                 (1) | Train Loss: 0.6582 | Train Acc: 0.8063
 Site-Infograph                 (2) | Train Loss: 1.0251 | Train Acc: 0.6984
 Site-Infograph                 (2) | Train Loss: 0.9111 | Train Acc: 0.7048
Average Train Accuracy: 0.8397
 Site-Clipart                   (0) | Val  Loss: 0.4438 | Val  Acc: 0.8857
 Site-Clipart                   (0) | Val  Loss: 0.4264 | Val  Acc: 0.8698
 Site-Real                      (0) | Val  Loss: 0.3423 | Val  Acc: 0.9190
 Site-Real                      (0) | Val  Loss: 0.2395 | Val  Acc: 0.9333
 Site-Painting                  (3) | Val  Loss: 0.3741 | Val  Acc: 0.8714
 Site-Painting                  (3) | Val  Loss: 0.3483 | Val  Acc: 0.9032
 Site-Sketch                    (4) | Val  Loss: 0.5244 | Val  Acc: 0.8571
 Site-Sketch                    (4) | Val  Loss: 0.4494 | Val  Acc: 0.8492
 Site-QuickDraw                 (1) | Val  Loss: 0.6595 | Val  Acc: 0.8143
 Site-QuickDraw                 (1) | Val  Loss: 0.6228 | Val  Acc: 0.8079
 Site-Infograph                 (2) | Val  Loss: 0.8393 | Val  Acc: 0.7190
 Site-Infograph                 (2) | Val  Loss: 0.8806 | Val  Acc: 0.7254
Average Valid Accuracy: 0.8463
 Best site-Clipart                  (0)  | Epoch:25 | Val Acc: 0.8857
 Best site-Clipart                  (0)  | Epoch:25 | Val Acc: 0.8698
 Best site-Real                     (0)  | Epoch:25 | Val Acc: 0.9190
 Best site-Real                     (0)  | Epoch:25 | Val Acc: 0.9333
 Best site-Painting                 (3)  | Epoch:25 | Val Acc: 0.8714
 Best site-Painting                 (3)  | Epoch:25 | Val Acc: 0.9032
 Best site-Sketch                   (4)  | Epoch:25 | Val Acc: 0.8571
 Best site-Sketch                   (4)  | Epoch:25 | Val Acc: 0.8492
 Best site-QuickDraw                (1)  | Epoch:25 | Val Acc: 0.8143
 Best site-QuickDraw                (1)  | Epoch:25 | Val Acc: 0.8079
 Best site-Infograph                (2)  | Epoch:25 | Val Acc: 0.7190
 Best site-Infograph                (2)  | Epoch:25 | Val Acc: 0.7254
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 26 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (0) | Train Loss: 0.4069 | Train Acc: 0.8794
 Site-Clipart                   (0) | Train Loss: 0.4340 | Train Acc: 0.8540
 Site-Real                      (3) | Train Loss: 0.2375 | Train Acc: 0.9333
 Site-Real                      (3) | Train Loss: 0.2464 | Train Acc: 0.9429
 Site-Painting                  (3) | Train Loss: 0.3550 | Train Acc: 0.8984
 Site-Painting                  (3) | Train Loss: 0.3346 | Train Acc: 0.9143
 Site-Sketch                    (4) | Train Loss: 0.4697 | Train Acc: 0.8413
 Site-Sketch                    (4) | Train Loss: 0.4579 | Train Acc: 0.8540
 Site-QuickDraw                 (1) | Train Loss: 0.7010 | Train Acc: 0.7905
 Site-QuickDraw                 (1) | Train Loss: 0.6686 | Train Acc: 0.7958
 Site-Infograph                 (2) | Train Loss: 1.0416 | Train Acc: 0.6698
 Site-Infograph                 (2) | Train Loss: 0.9001 | Train Acc: 0.7037
Average Train Accuracy: 0.8398
 Site-Clipart                   (0) | Val  Loss: 0.4308 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.4155 | Val  Acc: 0.8825
 Site-Real                      (3) | Val  Loss: 0.3036 | Val  Acc: 0.9381
 Site-Real                      (3) | Val  Loss: 0.2383 | Val  Acc: 0.9413
 Site-Painting                  (3) | Val  Loss: 0.4606 | Val  Acc: 0.8667
 Site-Painting                  (3) | Val  Loss: 0.3414 | Val  Acc: 0.9016
 Site-Sketch                    (4) | Val  Loss: 0.4557 | Val  Acc: 0.8667
 Site-Sketch                    (4) | Val  Loss: 0.4601 | Val  Acc: 0.8524
 Site-QuickDraw                 (1) | Val  Loss: 0.6010 | Val  Acc: 0.8333
 Site-QuickDraw                 (1) | Val  Loss: 0.6297 | Val  Acc: 0.8190
 Site-Infograph                 (2) | Val  Loss: 0.7879 | Val  Acc: 0.7524
 Site-Infograph                 (2) | Val  Loss: 0.8881 | Val  Acc: 0.7222
Average Valid Accuracy: 0.8563
 Best site-Clipart                  (0)  | Epoch:26 | Val Acc: 0.9000
 Best site-Clipart                  (0)  | Epoch:26 | Val Acc: 0.8825
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9381
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9413
 Best site-Painting                 (3)  | Epoch:26 | Val Acc: 0.8667
 Best site-Painting                 (3)  | Epoch:26 | Val Acc: 0.9016
 Best site-Sketch                   (4)  | Epoch:26 | Val Acc: 0.8667
 Best site-Sketch                   (4)  | Epoch:26 | Val Acc: 0.8524
 Best site-QuickDraw                (1)  | Epoch:26 | Val Acc: 0.8333
 Best site-QuickDraw                (1)  | Epoch:26 | Val Acc: 0.8190
 Best site-Infograph                (2)  | Epoch:26 | Val Acc: 0.7524
 Best site-Infograph                (2)  | Epoch:26 | Val Acc: 0.7222
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 27 ============
cnt=[2, 2, 4, 2, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (3) | Train Loss: 0.4127 | Train Acc: 0.8857
 Site-Clipart                   (3) | Train Loss: 0.4159 | Train Acc: 0.8656
 Site-Real                      (2) | Train Loss: 0.2347 | Train Acc: 0.9302
 Site-Real                      (2) | Train Loss: 0.2463 | Train Acc: 0.9323
 Site-Painting                  (2) | Train Loss: 0.3507 | Train Acc: 0.8762
 Site-Painting                  (2) | Train Loss: 0.3369 | Train Acc: 0.9058
 Site-Sketch                    (4) | Train Loss: 0.4387 | Train Acc: 0.8444
 Site-Sketch                    (4) | Train Loss: 0.4585 | Train Acc: 0.8508
 Site-QuickDraw                 (1) | Train Loss: 0.6976 | Train Acc: 0.7841
 Site-QuickDraw                 (1) | Train Loss: 0.6419 | Train Acc: 0.8169
 Site-Infograph                 (0) | Train Loss: 1.0373 | Train Acc: 0.6794
 Site-Infograph                 (0) | Train Loss: 0.8773 | Train Acc: 0.7185
Average Train Accuracy: 0.8408
 Site-Clipart                   (3) | Val  Loss: 0.4386 | Val  Acc: 0.8857
 Site-Clipart                   (3) | Val  Loss: 0.4146 | Val  Acc: 0.8778
 Site-Real                      (2) | Val  Loss: 0.3048 | Val  Acc: 0.9429
 Site-Real                      (2) | Val  Loss: 0.2670 | Val  Acc: 0.9317
 Site-Painting                  (2) | Val  Loss: 0.3937 | Val  Acc: 0.9143
 Site-Painting                  (2) | Val  Loss: 0.3375 | Val  Acc: 0.9111
 Site-Sketch                    (4) | Val  Loss: 0.4904 | Val  Acc: 0.8524
 Site-Sketch                    (4) | Val  Loss: 0.4642 | Val  Acc: 0.8444
 Site-QuickDraw                 (1) | Val  Loss: 0.6002 | Val  Acc: 0.8429
 Site-QuickDraw                 (1) | Val  Loss: 0.6165 | Val  Acc: 0.8032
 Site-Infograph                 (0) | Val  Loss: 0.7815 | Val  Acc: 0.7714
 Site-Infograph                 (0) | Val  Loss: 0.8656 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8589
 Best site-Clipart                  (3)  | Epoch:27 | Val Acc: 0.8857
 Best site-Clipart                  (3)  | Epoch:27 | Val Acc: 0.8778
 Best site-Real                     (2)  | Epoch:27 | Val Acc: 0.9429
 Best site-Real                     (2)  | Epoch:27 | Val Acc: 0.9317
 Best site-Painting                 (2)  | Epoch:27 | Val Acc: 0.9143
 Best site-Painting                 (2)  | Epoch:27 | Val Acc: 0.9111
 Best site-Sketch                   (4)  | Epoch:27 | Val Acc: 0.8524
 Best site-Sketch                   (4)  | Epoch:27 | Val Acc: 0.8444
 Best site-QuickDraw                (1)  | Epoch:27 | Val Acc: 0.8429
 Best site-QuickDraw                (1)  | Epoch:27 | Val Acc: 0.8032
 Best site-Infograph                (0)  | Epoch:27 | Val Acc: 0.7714
 Best site-Infograph                (0)  | Epoch:27 | Val Acc: 0.7286
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 28 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (2) | Train Loss: 0.4048 | Train Acc: 0.9016
 Site-Clipart                   (2) | Train Loss: 0.4367 | Train Acc: 0.8656
 Site-Real                      (3) | Train Loss: 0.2249 | Train Acc: 0.9333
 Site-Real                      (3) | Train Loss: 0.2518 | Train Acc: 0.9354
 Site-Painting                  (3) | Train Loss: 0.3367 | Train Acc: 0.9111
 Site-Painting                  (3) | Train Loss: 0.3337 | Train Acc: 0.9048
 Site-Sketch                    (4) | Train Loss: 0.4198 | Train Acc: 0.8667
 Site-Sketch                    (4) | Train Loss: 0.4668 | Train Acc: 0.8519
 Site-QuickDraw                 (1) | Train Loss: 0.7173 | Train Acc: 0.7619
 Site-QuickDraw                 (1) | Train Loss: 0.6293 | Train Acc: 0.8074
 Site-Infograph                 (0) | Train Loss: 0.9954 | Train Acc: 0.7048
 Site-Infograph                 (0) | Train Loss: 0.8704 | Train Acc: 0.7217
Average Train Accuracy: 0.8472
 Site-Clipart                   (2) | Val  Loss: 0.5119 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.4284 | Val  Acc: 0.8683
 Site-Real                      (3) | Val  Loss: 0.3311 | Val  Acc: 0.9381
 Site-Real                      (3) | Val  Loss: 0.2537 | Val  Acc: 0.9302
 Site-Painting                  (3) | Val  Loss: 0.3740 | Val  Acc: 0.9048
 Site-Painting                  (3) | Val  Loss: 0.3401 | Val  Acc: 0.9000
 Site-Sketch                    (4) | Val  Loss: 0.4712 | Val  Acc: 0.8333
 Site-Sketch                    (4) | Val  Loss: 0.4868 | Val  Acc: 0.8397
 Site-QuickDraw                 (1) | Val  Loss: 0.5798 | Val  Acc: 0.8714
 Site-QuickDraw                 (1) | Val  Loss: 0.6250 | Val  Acc: 0.8238
 Site-Infograph                 (0) | Val  Loss: 0.7839 | Val  Acc: 0.7524
 Site-Infograph                 (0) | Val  Loss: 0.8482 | Val  Acc: 0.7333
Average Valid Accuracy: 0.8552
============ Train epoch 29 ============
cnt=[2, 2, 4, 2, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (4) | Train Loss: 0.3583 | Train Acc: 0.9111
 Site-Clipart                   (4) | Train Loss: 0.4071 | Train Acc: 0.8688
 Site-Real                      (2) | Train Loss: 0.2182 | Train Acc: 0.9429
 Site-Real                      (2) | Train Loss: 0.2407 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.3518 | Train Acc: 0.8698
 Site-Painting                  (2) | Train Loss: 0.3379 | Train Acc: 0.9026
 Site-Sketch                    (0) | Train Loss: 0.4090 | Train Acc: 0.8635
 Site-Sketch                    (0) | Train Loss: 0.4333 | Train Acc: 0.8603
 Site-QuickDraw                 (1) | Train Loss: 0.7022 | Train Acc: 0.7619
 Site-QuickDraw                 (1) | Train Loss: 0.6085 | Train Acc: 0.8148
 Site-Infograph                 (3) | Train Loss: 1.0352 | Train Acc: 0.6794
 Site-Infograph                 (3) | Train Loss: 0.8638 | Train Acc: 0.7185
Average Train Accuracy: 0.8444
 Site-Clipart                   (4) | Val  Loss: 0.3986 | Val  Acc: 0.8714
 Site-Clipart                   (4) | Val  Loss: 0.3945 | Val  Acc: 0.8794
 Site-Real                      (2) | Val  Loss: 0.3117 | Val  Acc: 0.9381
 Site-Real                      (2) | Val  Loss: 0.2386 | Val  Acc: 0.9381
 Site-Painting                  (2) | Val  Loss: 0.4160 | Val  Acc: 0.8762
 Site-Painting                  (2) | Val  Loss: 0.3234 | Val  Acc: 0.9111
 Site-Sketch                    (0) | Val  Loss: 0.5297 | Val  Acc: 0.8524
 Site-Sketch                    (0) | Val  Loss: 0.4407 | Val  Acc: 0.8698
 Site-QuickDraw                 (1) | Val  Loss: 0.5713 | Val  Acc: 0.8619
 Site-QuickDraw                 (1) | Val  Loss: 0.5825 | Val  Acc: 0.8238
 Site-Infograph                 (3) | Val  Loss: 0.7680 | Val  Acc: 0.7476
 Site-Infograph                 (3) | Val  Loss: 0.8496 | Val  Acc: 0.7190
Average Valid Accuracy: 0.8574
============ Train epoch 30 ============
cnt=[3, 2, 2, 3, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (3) | Train Loss: 0.4037 | Train Acc: 0.8794
 Site-Clipart                   (0) | Train Loss: 0.4270 | Train Acc: 0.8688
 Site-Real                      (0) | Train Loss: 0.2373 | Train Acc: 0.9365
 Site-Real                      (0) | Train Loss: 0.2438 | Train Acc: 0.9291
 Site-Painting                  (4) | Train Loss: 0.3519 | Train Acc: 0.8984
 Site-Painting                  (4) | Train Loss: 0.3269 | Train Acc: 0.9111
 Site-Sketch                    (3) | Train Loss: 0.4350 | Train Acc: 0.8603
 Site-Sketch                    (3) | Train Loss: 0.4739 | Train Acc: 0.8508
 Site-QuickDraw                 (1) | Train Loss: 0.7076 | Train Acc: 0.7810
 Site-QuickDraw                 (1) | Train Loss: 0.6299 | Train Acc: 0.7979
 Site-Infograph                 (2) | Train Loss: 1.0406 | Train Acc: 0.6952
 Site-Infograph                 (2) | Train Loss: 0.8448 | Train Acc: 0.7323
Average Train Accuracy: 0.8451
 Site-Clipart                   (3) | Val  Loss: 0.4229 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.4247 | Val  Acc: 0.8651
 Site-Real                      (0) | Val  Loss: 0.3452 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.2405 | Val  Acc: 0.9381
 Site-Painting                  (4) | Val  Loss: 0.3515 | Val  Acc: 0.9000
 Site-Painting                  (4) | Val  Loss: 0.3284 | Val  Acc: 0.9095
 Site-Sketch                    (3) | Val  Loss: 0.5923 | Val  Acc: 0.8333
 Site-Sketch                    (3) | Val  Loss: 0.4778 | Val  Acc: 0.8365
 Site-QuickDraw                 (1) | Val  Loss: 0.5818 | Val  Acc: 0.8381
 Site-QuickDraw                 (1) | Val  Loss: 0.5782 | Val  Acc: 0.8175
 Site-Infograph                 (2) | Val  Loss: 0.7884 | Val  Acc: 0.7429
 Site-Infograph                 (2) | Val  Loss: 0.8390 | Val  Acc: 0.7302
Average Valid Accuracy: 0.8533
============ Train epoch 31 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (0) | Train Loss: 0.3615 | Train Acc: 0.8984
 Site-Clipart                   (0) | Train Loss: 0.4161 | Train Acc: 0.8804
 Site-Real                      (3) | Train Loss: 0.2043 | Train Acc: 0.9460
 Site-Real                      (3) | Train Loss: 0.2408 | Train Acc: 0.9344
 Site-Painting                  (3) | Train Loss: 0.3561 | Train Acc: 0.8921
 Site-Painting                  (3) | Train Loss: 0.3105 | Train Acc: 0.9132
 Site-Sketch                    (4) | Train Loss: 0.4059 | Train Acc: 0.8540
 Site-Sketch                    (4) | Train Loss: 0.4254 | Train Acc: 0.8698
 Site-QuickDraw                 (1) | Train Loss: 0.6895 | Train Acc: 0.7873
 Site-QuickDraw                 (1) | Train Loss: 0.5988 | Train Acc: 0.8275
 Site-Infograph                 (2) | Train Loss: 1.0078 | Train Acc: 0.6794
 Site-Infograph                 (2) | Train Loss: 0.8427 | Train Acc: 0.7249
Average Train Accuracy: 0.8506
 Site-Clipart                   (0) | Val  Loss: 0.4037 | Val  Acc: 0.9143
 Site-Clipart                   (0) | Val  Loss: 0.4030 | Val  Acc: 0.8778
 Site-Real                      (3) | Val  Loss: 0.3134 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2270 | Val  Acc: 0.9429
 Site-Painting                  (3) | Val  Loss: 0.3525 | Val  Acc: 0.9095
 Site-Painting                  (3) | Val  Loss: 0.3390 | Val  Acc: 0.8905
 Site-Sketch                    (4) | Val  Loss: 0.5647 | Val  Acc: 0.8333
 Site-Sketch                    (4) | Val  Loss: 0.4247 | Val  Acc: 0.8556
 Site-QuickDraw                 (1) | Val  Loss: 0.5698 | Val  Acc: 0.8476
 Site-QuickDraw                 (1) | Val  Loss: 0.5801 | Val  Acc: 0.8206
 Site-Infograph                 (2) | Val  Loss: 0.7985 | Val  Acc: 0.7286
 Site-Infograph                 (2) | Val  Loss: 0.8475 | Val  Acc: 0.7365
Average Valid Accuracy: 0.8571
============ Train epoch 32 ============
cnt=[4, 2, 2, 2, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (4) | Train Loss: 0.3451 | Train Acc: 0.9111
 Site-Clipart                   (4) | Train Loss: 0.4007 | Train Acc: 0.8804
 Site-Real                      (0) | Train Loss: 0.2329 | Train Acc: 0.9365
 Site-Real                      (0) | Train Loss: 0.2214 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.3174 | Train Acc: 0.9048
 Site-Painting                  (0) | Train Loss: 0.3071 | Train Acc: 0.9206
 Site-Sketch                    (3) | Train Loss: 0.3968 | Train Acc: 0.8635
 Site-Sketch                    (3) | Train Loss: 0.4135 | Train Acc: 0.8677
 Site-QuickDraw                 (1) | Train Loss: 0.7002 | Train Acc: 0.7873
 Site-QuickDraw                 (1) | Train Loss: 0.6014 | Train Acc: 0.8169
 Site-Infograph                 (2) | Train Loss: 1.0304 | Train Acc: 0.6667
 Site-Infograph                 (2) | Train Loss: 0.8392 | Train Acc: 0.7280
Average Train Accuracy: 0.8519
 Site-Clipart                   (4) | Val  Loss: 0.4292 | Val  Acc: 0.8905
 Site-Clipart                   (4) | Val  Loss: 0.3881 | Val  Acc: 0.8619
 Site-Real                      (0) | Val  Loss: 0.3094 | Val  Acc: 0.9429
 Site-Real                      (0) | Val  Loss: 0.2346 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.3303 | Val  Acc: 0.9190
 Site-Painting                  (0) | Val  Loss: 0.3188 | Val  Acc: 0.9143
 Site-Sketch                    (3) | Val  Loss: 0.4867 | Val  Acc: 0.8571
 Site-Sketch                    (3) | Val  Loss: 0.4264 | Val  Acc: 0.8571
 Site-QuickDraw                 (1) | Val  Loss: 0.5522 | Val  Acc: 0.8714
 Site-QuickDraw                 (1) | Val  Loss: 0.5645 | Val  Acc: 0.8222
 Site-Infograph                 (2) | Val  Loss: 0.7353 | Val  Acc: 0.7524
 Site-Infograph                 (2) | Val  Loss: 0.8124 | Val  Acc: 0.7365
Average Valid Accuracy: 0.8632
 Best site-Clipart                  (4)  | Epoch:32 | Val Acc: 0.8905
 Best site-Clipart                  (4)  | Epoch:32 | Val Acc: 0.8619
 Best site-Real                     (0)  | Epoch:32 | Val Acc: 0.9429
 Best site-Real                     (0)  | Epoch:32 | Val Acc: 0.9333
 Best site-Painting                 (0)  | Epoch:32 | Val Acc: 0.9190
 Best site-Painting                 (0)  | Epoch:32 | Val Acc: 0.9143
 Best site-Sketch                   (3)  | Epoch:32 | Val Acc: 0.8571
 Best site-Sketch                   (3)  | Epoch:32 | Val Acc: 0.8571
 Best site-QuickDraw                (1)  | Epoch:32 | Val Acc: 0.8714
 Best site-QuickDraw                (1)  | Epoch:32 | Val Acc: 0.8222
 Best site-Infograph                (2)  | Epoch:32 | Val Acc: 0.7524
 Best site-Infograph                (2)  | Epoch:32 | Val Acc: 0.7365
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 33 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (4) | Train Loss: 0.3480 | Train Acc: 0.9111
 Site-Clipart                   (4) | Train Loss: 0.3790 | Train Acc: 0.8910
 Site-Real                      (3) | Train Loss: 0.2259 | Train Acc: 0.9365
 Site-Real                      (3) | Train Loss: 0.2305 | Train Acc: 0.9386
 Site-Painting                  (3) | Train Loss: 0.3709 | Train Acc: 0.8794
 Site-Painting                  (3) | Train Loss: 0.3184 | Train Acc: 0.9069
 Site-Sketch                    (0) | Train Loss: 0.4235 | Train Acc: 0.8508
 Site-Sketch                    (0) | Train Loss: 0.4430 | Train Acc: 0.8582
 Site-QuickDraw                 (1) | Train Loss: 0.6781 | Train Acc: 0.7937
 Site-QuickDraw                 (1) | Train Loss: 0.6089 | Train Acc: 0.8254
 Site-Infograph                 (2) | Train Loss: 1.0023 | Train Acc: 0.6952
 Site-Infograph                 (2) | Train Loss: 0.7999 | Train Acc: 0.7598
Average Train Accuracy: 0.8539
 Site-Clipart                   (4) | Val  Loss: 0.4232 | Val  Acc: 0.8762
 Site-Clipart                   (4) | Val  Loss: 0.3746 | Val  Acc: 0.8841
 Site-Real                      (3) | Val  Loss: 0.2642 | Val  Acc: 0.9429
 Site-Real                      (3) | Val  Loss: 0.2428 | Val  Acc: 0.9349
 Site-Painting                  (3) | Val  Loss: 0.3654 | Val  Acc: 0.8952
 Site-Painting                  (3) | Val  Loss: 0.3231 | Val  Acc: 0.9016
 Site-Sketch                    (0) | Val  Loss: 0.4999 | Val  Acc: 0.8381
 Site-Sketch                    (0) | Val  Loss: 0.4461 | Val  Acc: 0.8587
 Site-QuickDraw                 (1) | Val  Loss: 0.5407 | Val  Acc: 0.8381
 Site-QuickDraw                 (1) | Val  Loss: 0.5735 | Val  Acc: 0.8175
 Site-Infograph                 (2) | Val  Loss: 0.7037 | Val  Acc: 0.7524
 Site-Infograph                 (2) | Val  Loss: 0.8144 | Val  Acc: 0.7333
Average Valid Accuracy: 0.8561
============ Train epoch 34 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (2) | Train Loss: 0.3730 | Train Acc: 0.9048
 Site-Clipart                   (2) | Train Loss: 0.3999 | Train Acc: 0.8836
 Site-Real                      (3) | Train Loss: 0.2376 | Train Acc: 0.9365
 Site-Real                      (3) | Train Loss: 0.2411 | Train Acc: 0.9302
 Site-Painting                  (3) | Train Loss: 0.3171 | Train Acc: 0.8889
 Site-Painting                  (3) | Train Loss: 0.3100 | Train Acc: 0.9175
 Site-Sketch                    (4) | Train Loss: 0.4233 | Train Acc: 0.8476
 Site-Sketch                    (4) | Train Loss: 0.4331 | Train Acc: 0.8667
 Site-QuickDraw                 (1) | Train Loss: 0.6807 | Train Acc: 0.7873
 Site-QuickDraw                 (1) | Train Loss: 0.5760 | Train Acc: 0.8286
 Site-Infograph                 (0) | Train Loss: 1.0269 | Train Acc: 0.6825
 Site-Infograph                 (0) | Train Loss: 0.8386 | Train Acc: 0.7302
Average Train Accuracy: 0.8504
 Site-Clipart                   (2) | Val  Loss: 0.4593 | Val  Acc: 0.8810
 Site-Clipart                   (2) | Val  Loss: 0.3880 | Val  Acc: 0.8857
 Site-Real                      (3) | Val  Loss: 0.3083 | Val  Acc: 0.9381
 Site-Real                      (3) | Val  Loss: 0.2489 | Val  Acc: 0.9238
 Site-Painting                  (3) | Val  Loss: 0.3814 | Val  Acc: 0.8952
 Site-Painting                  (3) | Val  Loss: 0.3156 | Val  Acc: 0.9000
 Site-Sketch                    (4) | Val  Loss: 0.5258 | Val  Acc: 0.8810
 Site-Sketch                    (4) | Val  Loss: 0.4291 | Val  Acc: 0.8571
 Site-QuickDraw                 (1) | Val  Loss: 0.5830 | Val  Acc: 0.8333
 Site-QuickDraw                 (1) | Val  Loss: 0.5772 | Val  Acc: 0.8143
 Site-Infograph                 (0) | Val  Loss: 0.7709 | Val  Acc: 0.7714
 Site-Infograph                 (0) | Val  Loss: 0.7856 | Val  Acc: 0.7476
Average Valid Accuracy: 0.8607
============ Train epoch 35 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (2) | Train Loss: 0.3378 | Train Acc: 0.9206
 Site-Clipart                   (2) | Train Loss: 0.3932 | Train Acc: 0.8751
 Site-Real                      (3) | Train Loss: 0.2213 | Train Acc: 0.9365
 Site-Real                      (3) | Train Loss: 0.2358 | Train Acc: 0.9418
 Site-Painting                  (3) | Train Loss: 0.3587 | Train Acc: 0.8857
 Site-Painting                  (3) | Train Loss: 0.2917 | Train Acc: 0.9217
 Site-Sketch                    (4) | Train Loss: 0.3981 | Train Acc: 0.8730
 Site-Sketch                    (4) | Train Loss: 0.4100 | Train Acc: 0.8688
 Site-QuickDraw                 (1) | Train Loss: 0.6659 | Train Acc: 0.7714
 Site-QuickDraw                 (1) | Train Loss: 0.5605 | Train Acc: 0.8296
 Site-Infograph                 (0) | Train Loss: 1.0475 | Train Acc: 0.6762
 Site-Infograph                 (0) | Train Loss: 0.8069 | Train Acc: 0.7471
Average Train Accuracy: 0.8540
 Site-Clipart                   (2) | Val  Loss: 0.4120 | Val  Acc: 0.9190
 Site-Clipart                   (2) | Val  Loss: 0.3877 | Val  Acc: 0.8714
 Site-Real                      (3) | Val  Loss: 0.3008 | Val  Acc: 0.9476
 Site-Real                      (3) | Val  Loss: 0.2367 | Val  Acc: 0.9349
 Site-Painting                  (3) | Val  Loss: 0.3850 | Val  Acc: 0.8952
 Site-Painting                  (3) | Val  Loss: 0.3273 | Val  Acc: 0.8984
 Site-Sketch                    (4) | Val  Loss: 0.6093 | Val  Acc: 0.8571
 Site-Sketch                    (4) | Val  Loss: 0.4383 | Val  Acc: 0.8508
 Site-QuickDraw                 (1) | Val  Loss: 0.5405 | Val  Acc: 0.8429
 Site-QuickDraw                 (1) | Val  Loss: 0.5835 | Val  Acc: 0.8143
 Site-Infograph                 (0) | Val  Loss: 0.7310 | Val  Acc: 0.7619
 Site-Infograph                 (0) | Val  Loss: 0.8118 | Val  Acc: 0.7333
Average Valid Accuracy: 0.8606
============ Train epoch 36 ============
cnt=[2, 4, 2, 2, 2, ]
cnt=[2, 4, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (4) | Train Loss: 0.3564 | Train Acc: 0.9048
 Site-Clipart                   (4) | Train Loss: 0.3823 | Train Acc: 0.8825
 Site-Real                      (1) | Train Loss: 0.2279 | Train Acc: 0.9365
 Site-Real                      (1) | Train Loss: 0.2186 | Train Acc: 0.9429
 Site-Painting                  (1) | Train Loss: 0.2975 | Train Acc: 0.9143
 Site-Painting                  (1) | Train Loss: 0.2972 | Train Acc: 0.9175
 Site-Sketch                    (0) | Train Loss: 0.4199 | Train Acc: 0.8667
 Site-Sketch                    (0) | Train Loss: 0.4099 | Train Acc: 0.8677
 Site-QuickDraw                 (2) | Train Loss: 0.6957 | Train Acc: 0.7683
 Site-QuickDraw                 (2) | Train Loss: 0.5936 | Train Acc: 0.8159
 Site-Infograph                 (3) | Train Loss: 0.9918 | Train Acc: 0.6889
 Site-Infograph                 (3) | Train Loss: 0.8012 | Train Acc: 0.7439
Average Train Accuracy: 0.8541
 Site-Clipart                   (4) | Val  Loss: 0.3650 | Val  Acc: 0.9095
 Site-Clipart                   (4) | Val  Loss: 0.3685 | Val  Acc: 0.8857
 Site-Real                      (1) | Val  Loss: 0.3037 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.2258 | Val  Acc: 0.9429
 Site-Painting                  (1) | Val  Loss: 0.3839 | Val  Acc: 0.8714
 Site-Painting                  (1) | Val  Loss: 0.3169 | Val  Acc: 0.9063
 Site-Sketch                    (0) | Val  Loss: 0.4706 | Val  Acc: 0.8667
 Site-Sketch                    (0) | Val  Loss: 0.4262 | Val  Acc: 0.8587
 Site-QuickDraw                 (2) | Val  Loss: 0.5307 | Val  Acc: 0.8667
 Site-QuickDraw                 (2) | Val  Loss: 0.5470 | Val  Acc: 0.8254
 Site-Infograph                 (3) | Val  Loss: 0.7333 | Val  Acc: 0.7619
 Site-Infograph                 (3) | Val  Loss: 0.7983 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8659
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.9095
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.8857
 Best site-Real                     (1)  | Epoch:36 | Val Acc: 0.9524
 Best site-Real                     (1)  | Epoch:36 | Val Acc: 0.9429
 Best site-Painting                 (1)  | Epoch:36 | Val Acc: 0.8714
 Best site-Painting                 (1)  | Epoch:36 | Val Acc: 0.9063
 Best site-Sketch                   (0)  | Epoch:36 | Val Acc: 0.8667
 Best site-Sketch                   (0)  | Epoch:36 | Val Acc: 0.8587
 Best site-QuickDraw                (2)  | Epoch:36 | Val Acc: 0.8667
 Best site-QuickDraw                (2)  | Epoch:36 | Val Acc: 0.8254
 Best site-Infograph                (3)  | Epoch:36 | Val Acc: 0.7619
 Best site-Infograph                (3)  | Epoch:36 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 37 ============
cnt=[2, 2, 4, 2, 2, ]
cnt=[2, 2, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (4) | Train Loss: 0.3474 | Train Acc: 0.9079
 Site-Clipart                   (4) | Train Loss: 0.3822 | Train Acc: 0.8794
 Site-Real                      (2) | Train Loss: 0.2378 | Train Acc: 0.9333
 Site-Real                      (2) | Train Loss: 0.2254 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.3132 | Train Acc: 0.9111
 Site-Painting                  (2) | Train Loss: 0.2888 | Train Acc: 0.9111
 Site-Sketch                    (0) | Train Loss: 0.3933 | Train Acc: 0.8667
 Site-Sketch                    (0) | Train Loss: 0.4115 | Train Acc: 0.8688
 Site-QuickDraw                 (1) | Train Loss: 0.6182 | Train Acc: 0.8254
 Site-QuickDraw                 (1) | Train Loss: 0.5616 | Train Acc: 0.8328
 Site-Infograph                 (3) | Train Loss: 0.9754 | Train Acc: 0.7016
 Site-Infograph                 (3) | Train Loss: 0.7919 | Train Acc: 0.7418
Average Train Accuracy: 0.8600
 Site-Clipart                   (4) | Val  Loss: 0.3661 | Val  Acc: 0.9000
 Site-Clipart                   (4) | Val  Loss: 0.3552 | Val  Acc: 0.8873
 Site-Real                      (2) | Val  Loss: 0.3455 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.2336 | Val  Acc: 0.9349
 Site-Painting                  (2) | Val  Loss: 0.3663 | Val  Acc: 0.8952
 Site-Painting                  (2) | Val  Loss: 0.3124 | Val  Acc: 0.9143
 Site-Sketch                    (0) | Val  Loss: 0.4679 | Val  Acc: 0.8238
 Site-Sketch                    (0) | Val  Loss: 0.4105 | Val  Acc: 0.8683
 Site-QuickDraw                 (1) | Val  Loss: 0.4922 | Val  Acc: 0.8667
 Site-QuickDraw                 (1) | Val  Loss: 0.5365 | Val  Acc: 0.8444
 Site-Infograph                 (3) | Val  Loss: 0.6892 | Val  Acc: 0.7905
 Site-Infograph                 (3) | Val  Loss: 0.7960 | Val  Acc: 0.7444
Average Valid Accuracy: 0.8669
 Best site-Clipart                  (4)  | Epoch:37 | Val Acc: 0.9000
 Best site-Clipart                  (4)  | Epoch:37 | Val Acc: 0.8873
 Best site-Real                     (2)  | Epoch:37 | Val Acc: 0.9333
 Best site-Real                     (2)  | Epoch:37 | Val Acc: 0.9349
 Best site-Painting                 (2)  | Epoch:37 | Val Acc: 0.8952
 Best site-Painting                 (2)  | Epoch:37 | Val Acc: 0.9143
 Best site-Sketch                   (0)  | Epoch:37 | Val Acc: 0.8238
 Best site-Sketch                   (0)  | Epoch:37 | Val Acc: 0.8683
 Best site-QuickDraw                (1)  | Epoch:37 | Val Acc: 0.8667
 Best site-QuickDraw                (1)  | Epoch:37 | Val Acc: 0.8444
 Best site-Infograph                (3)  | Epoch:37 | Val Acc: 0.7905
 Best site-Infograph                (3)  | Epoch:37 | Val Acc: 0.7444
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 38 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (0) | Train Loss: 0.3556 | Train Acc: 0.8952
 Site-Clipart                   (0) | Train Loss: 0.3825 | Train Acc: 0.8868
 Site-Real                      (3) | Train Loss: 0.2414 | Train Acc: 0.9365
 Site-Real                      (3) | Train Loss: 0.2170 | Train Acc: 0.9418
 Site-Painting                  (3) | Train Loss: 0.3271 | Train Acc: 0.8921
 Site-Painting                  (3) | Train Loss: 0.2847 | Train Acc: 0.9228
 Site-Sketch                    (4) | Train Loss: 0.4007 | Train Acc: 0.8603
 Site-Sketch                    (4) | Train Loss: 0.4130 | Train Acc: 0.8720
 Site-QuickDraw                 (1) | Train Loss: 0.6296 | Train Acc: 0.7905
 Site-QuickDraw                 (1) | Train Loss: 0.5692 | Train Acc: 0.8254
 Site-Infograph                 (2) | Train Loss: 0.9850 | Train Acc: 0.7016
 Site-Infograph                 (2) | Train Loss: 0.7905 | Train Acc: 0.7608
Average Train Accuracy: 0.8571
 Site-Clipart                   (0) | Val  Loss: 0.3589 | Val  Acc: 0.9286
 Site-Clipart                   (0) | Val  Loss: 0.3535 | Val  Acc: 0.8921
 Site-Real                      (3) | Val  Loss: 0.3247 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2394 | Val  Acc: 0.9302
 Site-Painting                  (3) | Val  Loss: 0.3642 | Val  Acc: 0.8810
 Site-Painting                  (3) | Val  Loss: 0.3162 | Val  Acc: 0.9159
 Site-Sketch                    (4) | Val  Loss: 0.4863 | Val  Acc: 0.8667
 Site-Sketch                    (4) | Val  Loss: 0.3943 | Val  Acc: 0.8683
 Site-QuickDraw                 (1) | Val  Loss: 0.4672 | Val  Acc: 0.8905
 Site-QuickDraw                 (1) | Val  Loss: 0.5417 | Val  Acc: 0.8270
 Site-Infograph                 (2) | Val  Loss: 0.7197 | Val  Acc: 0.7810
 Site-Infograph                 (2) | Val  Loss: 0.7460 | Val  Acc: 0.7778
Average Valid Accuracy: 0.8739
 Best site-Clipart                  (0)  | Epoch:38 | Val Acc: 0.9286
 Best site-Clipart                  (0)  | Epoch:38 | Val Acc: 0.8921
 Best site-Real                     (3)  | Epoch:38 | Val Acc: 0.9286
 Best site-Real                     (3)  | Epoch:38 | Val Acc: 0.9302
 Best site-Painting                 (3)  | Epoch:38 | Val Acc: 0.8810
 Best site-Painting                 (3)  | Epoch:38 | Val Acc: 0.9159
 Best site-Sketch                   (4)  | Epoch:38 | Val Acc: 0.8667
 Best site-Sketch                   (4)  | Epoch:38 | Val Acc: 0.8683
 Best site-QuickDraw                (1)  | Epoch:38 | Val Acc: 0.8905
 Best site-QuickDraw                (1)  | Epoch:38 | Val Acc: 0.8270
 Best site-Infograph                (2)  | Epoch:38 | Val Acc: 0.7810
 Best site-Infograph                (2)  | Epoch:38 | Val Acc: 0.7778
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0_cluster_5/ccop_q=1...
============ Train epoch 39 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[2, 2, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (2) | Train Loss: 0.3631 | Train Acc: 0.9048
 Site-Clipart                   (2) | Train Loss: 0.3773 | Train Acc: 0.8889
 Site-Real                      (3) | Train Loss: 0.2337 | Train Acc: 0.9365
 Site-Real                      (3) | Train Loss: 0.2321 | Train Acc: 0.9439
 Site-Painting                  (3) | Train Loss: 0.3179 | Train Acc: 0.8984
 Site-Painting                  (3) | Train Loss: 0.3060 | Train Acc: 0.9101
 Site-Sketch                    (4) | Train Loss: 0.3833 | Train Acc: 0.8952
 Site-Sketch                    (4) | Train Loss: 0.4251 | Train Acc: 0.8624
 Site-QuickDraw                 (1) | Train Loss: 0.6384 | Train Acc: 0.8032
 Site-QuickDraw                 (1) | Train Loss: 0.5376 | Train Acc: 0.8423
 Site-Infograph                 (0) | Train Loss: 0.9883 | Train Acc: 0.7079
 Site-Infograph                 (0) | Train Loss: 0.7737 | Train Acc: 0.7630
Average Train Accuracy: 0.8631
 Site-Clipart                   (2) | Val  Loss: 0.3841 | Val  Acc: 0.9000
 Site-Clipart                   (2) | Val  Loss: 0.3388 | Val  Acc: 0.8937
 Site-Real                      (3) | Val  Loss: 0.2982 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.2228 | Val  Acc: 0.9397
 Site-Painting                  (3) | Val  Loss: 0.3602 | Val  Acc: 0.8857
 Site-Painting                  (3) | Val  Loss: 0.3111 | Val  Acc: 0.9063
 Site-Sketch                    (4) | Val  Loss: 0.4880 | Val  Acc: 0.8476
 Site-Sketch                    (4) | Val  Loss: 0.3886 | Val  Acc: 0.8841
 Site-QuickDraw                 (1) | Val  Loss: 0.5210 | Val  Acc: 0.8571
 Site-QuickDraw                 (1) | Val  Loss: 0.5139 | Val  Acc: 0.8492
 Site-Infograph                 (0) | Val  Loss: 0.6732 | Val  Acc: 0.7952
 Site-Infograph                 (0) | Val  Loss: 0.7644 | Val  Acc: 0.7603
Average Valid Accuracy: 0.8710
============ Train epoch 40 ============
cnt=[2, 2, 2, 4, 2, ]
cnt=[4, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (0) | Train Loss: 0.3325 | Train Acc: 0.9143
 Site-Clipart                   (0) | Train Loss: 0.4068 | Train Acc: 0.8772
 Site-Real                      (3) | Train Loss: 0.2230 | Train Acc: 0.9365
 Site-Real                      (3) | Train Loss: 0.2371 | Train Acc: 0.9418
 Site-Painting                  (3) | Train Loss: 0.3124 | Train Acc: 0.8889
 Site-Painting                  (3) | Train Loss: 0.2982 | Train Acc: 0.9196
 Site-Sketch                    (4) | Train Loss: 0.4021 | Train Acc: 0.8762
 Site-Sketch                    (4) | Train Loss: 0.4244 | Train Acc: 0.8582
 Site-QuickDraw                 (1) | Train Loss: 0.6433 | Train Acc: 0.7810
 Site-QuickDraw                 (1) | Train Loss: 0.5419 | Train Acc: 0.8360
 Site-Infograph                 (2) | Train Loss: 0.9561 | Train Acc: 0.6921
 Site-Infograph                 (2) | Train Loss: 0.7750 | Train Acc: 0.7481
Average Train Accuracy: 0.8558
 Site-Clipart                   (0) | Val  Loss: 0.3812 | Val  Acc: 0.9143
 Site-Clipart                   (0) | Val  Loss: 0.3663 | Val  Acc: 0.8873
 Site-Real                      (3) | Val  Loss: 0.3260 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.2198 | Val  Acc: 0.9413
 Site-Painting                  (3) | Val  Loss: 0.3387 | Val  Acc: 0.8905
 Site-Painting                  (3) | Val  Loss: 0.3042 | Val  Acc: 0.9095
 Site-Sketch                    (4) | Val  Loss: 0.5687 | Val  Acc: 0.8381
 Site-Sketch                    (4) | Val  Loss: 0.4125 | Val  Acc: 0.8667
 Site-QuickDraw                 (1) | Val  Loss: 0.5354 | Val  Acc: 0.8619
 Site-QuickDraw                 (1) | Val  Loss: 0.5268 | Val  Acc: 0.8540
 Site-Infograph                 (2) | Val  Loss: 0.7142 | Val  Acc: 0.7571
 Site-Infograph                 (2) | Val  Loss: 0.7476 | Val  Acc: 0.7746
Average Valid Accuracy: 0.8690
 Test site-Clipart                   (0)| Epoch:38 | Test Acc: 0.8783
 Test site-Real                      (3)| Epoch:38 | Test Acc: 0.9400
 Test site-Painting                  (3)| Epoch:38 | Test Acc: 0.9305
 Test site-Sketch                    (4)| Epoch:38 | Test Acc: 0.8899
 Test site-QuickDraw                 (1)| Epoch:38 | Test Acc: 0.8100
 Test site-Infograph                 (2)| Epoch:38 | Test Acc: 0.6377
Clipart: 0.8783, Real: 0.9400, Painting: 0.9305, Sketch: 0.8899, QuickDraw: 0.8100, Infograph: 0.6377, 
Average Test Accuracy(group): 0.8478, Average Test Accuracy(individual): 0.8478,
domain std=0.1030, cluster std=0.1043, individual std=0.1030, 
===2023-08-02 11:54:17===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[315,945,315,945,315,945,315,945,315,945,315,945,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 5
Loading snapshots...
 Test site-Clipart                   (0)| Epoch:38 | Test Acc: 0.8821
 Test site-Real                      (3)| Epoch:38 | Test Acc: 0.9408
 Test site-Painting                  (3)| Epoch:38 | Test Acc: 0.9305
 Test site-Sketch                    (4)| Epoch:38 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:38 | Test Acc: 0.8140
 Test site-Infograph                 (2)| Epoch:38 | Test Acc: 0.6423
Clipart: 0.8821, Real: 0.9408, Painting: 0.9305, Sketch: 0.8917, QuickDraw: 0.8140, Infograph: 0.6423, 
Average Test Accuracy(group): 0.8503, Average Test Accuracy(individual): 0.8503,
domain std=0.1016, cluster std=0.1031, individual std=0.1016, 
