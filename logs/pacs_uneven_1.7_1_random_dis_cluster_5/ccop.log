===2023-08-10 14:26:54===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 1, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (2) | Train Loss: 1.6736 | Train Acc: 0.4667
 Site-photo                     (2) | Train Loss: 1.7515 | Train Acc: 0.4559
 Site-photo                     (2) | Train Loss: 1.6947 | Train Acc: 0.5000
 Site-photo                     (2) | Train Loss: 1.6159 | Train Acc: 0.5686
 Site-photo                     (2) | Train Loss: 1.6908 | Train Acc: 0.5022
 Site-art_painting              (4) | Train Loss: 1.8027 | Train Acc: 0.3095
 Site-art_painting              (0) | Train Loss: 1.9024 | Train Acc: 0.2526
 Site-art_painting              (0) | Train Loss: 1.7673 | Train Acc: 0.3239
 Site-cartoon                   (3) | Train Loss: 1.8389 | Train Acc: 0.1765
 Site-cartoon                   (3) | Train Loss: 1.8759 | Train Acc: 0.2558
 Site-sketch                    (1) | Train Loss: 1.8480 | Train Acc: 0.1901
Average Train Accuracy: 0.3638
 Site-photo                     (2) | Val  Loss: 1.6976 | Val  Acc: 0.5000
 Site-photo                     (2) | Val  Loss: 1.7470 | Val  Acc: 0.5111
 Site-photo                     (2) | Val  Loss: 1.6030 | Val  Acc: 0.5147
 Site-photo                     (2) | Val  Loss: 1.6918 | Val  Acc: 0.5000
 Site-photo                     (2) | Val  Loss: 1.6341 | Val  Acc: 0.5066
 Site-art_painting              (4) | Val  Loss: 1.9434 | Val  Acc: 0.2143
 Site-art_painting              (0) | Val  Loss: 1.7397 | Val  Acc: 0.4127
 Site-art_painting              (0) | Val  Loss: 1.8255 | Val  Acc: 0.2887
 Site-cartoon                   (3) | Val  Loss: 1.9569 | Val  Acc: 0.3913
 Site-cartoon                   (3) | Val  Loss: 1.8854 | Val  Acc: 0.2348
 Site-sketch                    (1) | Val  Loss: 1.7826 | Val  Acc: 0.2750
Average Valid Accuracy: 0.3954
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.5000
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.5111
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.5147
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.5000
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.5066
 Best site-art_painting             (4)  | Epoch:0 | Val Acc: 0.2143
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.4127
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.2887
 Best site-cartoon                  (3)  | Epoch:0 | Val Acc: 0.3913
 Best site-cartoon                  (3)  | Epoch:0 | Val Acc: 0.2348
 Best site-sketch                   (1)  | Epoch:0 | Val Acc: 0.2750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 5, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (1) | Train Loss: 1.5600 | Train Acc: 0.5556
 Site-photo                     (1) | Train Loss: 1.4513 | Train Acc: 0.5735
 Site-photo                     (1) | Train Loss: 1.4477 | Train Acc: 0.6373
 Site-photo                     (1) | Train Loss: 1.4150 | Train Acc: 0.6667
 Site-photo                     (1) | Train Loss: 1.4965 | Train Acc: 0.6288
 Site-art_painting              (4) | Train Loss: 1.6240 | Train Acc: 0.5476
 Site-art_painting              (3) | Train Loss: 1.8060 | Train Acc: 0.3368
 Site-art_painting              (3) | Train Loss: 1.6439 | Train Acc: 0.4178
 Site-cartoon                   (0) | Train Loss: 1.7338 | Train Acc: 0.2647
 Site-cartoon                   (0) | Train Loss: 1.7924 | Train Acc: 0.3198
 Site-sketch                    (2) | Train Loss: 1.9160 | Train Acc: 0.2397
Average Train Accuracy: 0.4717
 Site-photo                     (1) | Val  Loss: 1.4986 | Val  Acc: 0.6000
 Site-photo                     (1) | Val  Loss: 1.5402 | Val  Acc: 0.6000
 Site-photo                     (1) | Val  Loss: 1.3861 | Val  Acc: 0.6471
 Site-photo                     (1) | Val  Loss: 1.4729 | Val  Acc: 0.6275
 Site-photo                     (1) | Val  Loss: 1.4081 | Val  Acc: 0.7171
 Site-art_painting              (4) | Val  Loss: 1.7189 | Val  Acc: 0.3929
 Site-art_painting              (3) | Val  Loss: 1.6344 | Val  Acc: 0.4286
 Site-art_painting              (3) | Val  Loss: 1.6790 | Val  Acc: 0.4155
 Site-cartoon                   (0) | Val  Loss: 1.8513 | Val  Acc: 0.2174
 Site-cartoon                   (0) | Val  Loss: 1.7572 | Val  Acc: 0.3130
 Site-sketch                    (2) | Val  Loss: 1.8273 | Val  Acc: 0.2625
Average Valid Accuracy: 0.4747
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6000
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6000
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6471
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6275
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.7171
 Best site-art_painting             (4)  | Epoch:1 | Val Acc: 0.3929
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.4286
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.4155
 Best site-cartoon                  (0)  | Epoch:1 | Val Acc: 0.2174
 Best site-cartoon                  (0)  | Epoch:1 | Val Acc: 0.3130
 Best site-sketch                   (2)  | Epoch:1 | Val Acc: 0.2625
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 1, 5, 2, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (2) | Train Loss: 1.3273 | Train Acc: 0.7556
 Site-photo                     (2) | Train Loss: 1.1867 | Train Acc: 0.7941
 Site-photo                     (2) | Train Loss: 1.1971 | Train Acc: 0.8431
 Site-photo                     (2) | Train Loss: 1.2181 | Train Acc: 0.8758
 Site-photo                     (2) | Train Loss: 1.2845 | Train Acc: 0.8079
 Site-art_painting              (0) | Train Loss: 1.6090 | Train Acc: 0.5000
 Site-art_painting              (4) | Train Loss: 1.6055 | Train Acc: 0.4316
 Site-art_painting              (4) | Train Loss: 1.5427 | Train Acc: 0.5070
 Site-cartoon                   (3) | Train Loss: 1.7166 | Train Acc: 0.3235
 Site-cartoon                   (3) | Train Loss: 1.6779 | Train Acc: 0.3605
 Site-sketch                    (1) | Train Loss: 1.8190 | Train Acc: 0.2397
Average Train Accuracy: 0.5853
 Site-photo                     (2) | Val  Loss: 1.2574 | Val  Acc: 0.8000
 Site-photo                     (2) | Val  Loss: 1.3024 | Val  Acc: 0.7333
 Site-photo                     (2) | Val  Loss: 1.2525 | Val  Acc: 0.8235
 Site-photo                     (2) | Val  Loss: 1.2699 | Val  Acc: 0.8627
 Site-photo                     (2) | Val  Loss: 1.1943 | Val  Acc: 0.8553
 Site-art_painting              (0) | Val  Loss: 1.5339 | Val  Acc: 0.5714
 Site-art_painting              (4) | Val  Loss: 1.5061 | Val  Acc: 0.6032
 Site-art_painting              (4) | Val  Loss: 1.5788 | Val  Acc: 0.5070
 Site-cartoon                   (3) | Val  Loss: 1.8145 | Val  Acc: 0.2174
 Site-cartoon                   (3) | Val  Loss: 1.6536 | Val  Acc: 0.4087
 Site-sketch                    (1) | Val  Loss: 1.7330 | Val  Acc: 0.2375
Average Valid Accuracy: 0.6018
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.8000
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.7333
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.8235
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.8627
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.8553
 Best site-art_painting             (0)  | Epoch:2 | Val Acc: 0.5714
 Best site-art_painting             (4)  | Epoch:2 | Val Acc: 0.6032
 Best site-art_painting             (4)  | Epoch:2 | Val Acc: 0.5070
 Best site-cartoon                  (3)  | Epoch:2 | Val Acc: 0.2174
 Best site-cartoon                  (3)  | Epoch:2 | Val Acc: 0.4087
 Best site-sketch                   (1)  | Epoch:2 | Val Acc: 0.2375
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 3 ============
cnt=[3, 1, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (4) | Train Loss: 1.1086 | Train Acc: 0.8444
 Site-photo                     (2) | Train Loss: 1.1849 | Train Acc: 0.8382
 Site-photo                     (2) | Train Loss: 1.0215 | Train Acc: 0.9510
 Site-photo                     (2) | Train Loss: 1.0153 | Train Acc: 0.9281
 Site-photo                     (2) | Train Loss: 1.0591 | Train Acc: 0.8821
 Site-art_painting              (0) | Train Loss: 1.3700 | Train Acc: 0.6429
 Site-art_painting              (0) | Train Loss: 1.4567 | Train Acc: 0.6105
 Site-art_painting              (0) | Train Loss: 1.3834 | Train Acc: 0.6385
 Site-cartoon                   (3) | Train Loss: 1.6071 | Train Acc: 0.4118
 Site-cartoon                   (3) | Train Loss: 1.5579 | Train Acc: 0.4593
 Site-sketch                    (1) | Train Loss: 1.7682 | Train Acc: 0.2975
Average Train Accuracy: 0.6822
 Site-photo                     (4) | Val  Loss: 1.0256 | Val  Acc: 0.9333
 Site-photo                     (2) | Val  Loss: 1.1117 | Val  Acc: 0.8667
 Site-photo                     (2) | Val  Loss: 1.0621 | Val  Acc: 0.9118
 Site-photo                     (2) | Val  Loss: 1.0425 | Val  Acc: 0.9510
 Site-photo                     (2) | Val  Loss: 0.9745 | Val  Acc: 0.9276
 Site-art_painting              (0) | Val  Loss: 1.3620 | Val  Acc: 0.6429
 Site-art_painting              (0) | Val  Loss: 1.3423 | Val  Acc: 0.7143
 Site-art_painting              (0) | Val  Loss: 1.4538 | Val  Acc: 0.6127
 Site-cartoon                   (3) | Val  Loss: 1.6303 | Val  Acc: 0.3913
 Site-cartoon                   (3) | Val  Loss: 1.5355 | Val  Acc: 0.4522
 Site-sketch                    (1) | Val  Loss: 1.6770 | Val  Acc: 0.3250
Average Valid Accuracy: 0.7026
 Best site-photo                    (4)  | Epoch:3 | Val Acc: 0.9333
 Best site-photo                    (2)  | Epoch:3 | Val Acc: 0.8667
 Best site-photo                    (2)  | Epoch:3 | Val Acc: 0.9118
 Best site-photo                    (2)  | Epoch:3 | Val Acc: 0.9510
 Best site-photo                    (2)  | Epoch:3 | Val Acc: 0.9276
 Best site-art_painting             (0)  | Epoch:3 | Val Acc: 0.6429
 Best site-art_painting             (0)  | Epoch:3 | Val Acc: 0.7143
 Best site-art_painting             (0)  | Epoch:3 | Val Acc: 0.6127
 Best site-cartoon                  (3)  | Epoch:3 | Val Acc: 0.3913
 Best site-cartoon                  (3)  | Epoch:3 | Val Acc: 0.4522
 Best site-sketch                   (1)  | Epoch:3 | Val Acc: 0.3250
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 4 ============
cnt=[3, 1, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (0) | Train Loss: 0.9296 | Train Acc: 0.8667
 Site-photo                     (4) | Train Loss: 0.7444 | Train Acc: 0.8971
 Site-photo                     (0) | Train Loss: 0.8112 | Train Acc: 0.9706
 Site-photo                     (4) | Train Loss: 0.8404 | Train Acc: 0.9608
 Site-photo                     (0) | Train Loss: 0.8825 | Train Acc: 0.9476
 Site-art_painting              (3) | Train Loss: 1.3108 | Train Acc: 0.7143
 Site-art_painting              (3) | Train Loss: 1.3709 | Train Acc: 0.5684
 Site-art_painting              (3) | Train Loss: 1.2293 | Train Acc: 0.7371
 Site-cartoon                   (2) | Train Loss: 1.5831 | Train Acc: 0.3824
 Site-cartoon                   (2) | Train Loss: 1.4624 | Train Acc: 0.5233
 Site-sketch                    (1) | Train Loss: 1.7193 | Train Acc: 0.2893
Average Train Accuracy: 0.7143
 Site-photo                     (0) | Val  Loss: 0.8562 | Val  Acc: 0.9333
 Site-photo                     (4) | Val  Loss: 0.8920 | Val  Acc: 0.9111
 Site-photo                     (0) | Val  Loss: 0.8622 | Val  Acc: 0.9706
 Site-photo                     (4) | Val  Loss: 0.8694 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.7865 | Val  Acc: 0.9671
 Site-art_painting              (3) | Val  Loss: 1.2167 | Val  Acc: 0.7143
 Site-art_painting              (3) | Val  Loss: 1.2407 | Val  Acc: 0.7778
 Site-art_painting              (3) | Val  Loss: 1.3001 | Val  Acc: 0.7324
 Site-cartoon                   (2) | Val  Loss: 1.5196 | Val  Acc: 0.3913
 Site-cartoon                   (2) | Val  Loss: 1.4338 | Val  Acc: 0.5217
 Site-sketch                    (1) | Val  Loss: 1.6603 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7473
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9333
 Best site-photo                    (4)  | Epoch:4 | Val Acc: 0.9111
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9706
 Best site-photo                    (4)  | Epoch:4 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9671
 Best site-art_painting             (3)  | Epoch:4 | Val Acc: 0.7143
 Best site-art_painting             (3)  | Epoch:4 | Val Acc: 0.7778
 Best site-art_painting             (3)  | Epoch:4 | Val Acc: 0.7324
 Best site-cartoon                  (2)  | Epoch:4 | Val Acc: 0.3913
 Best site-cartoon                  (2)  | Epoch:4 | Val Acc: 0.5217
 Best site-sketch                   (1)  | Epoch:4 | Val Acc: 0.3500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 5 ============
cnt=[5, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (0) | Train Loss: 0.7999 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.9128 | Train Acc: 0.9118
 Site-photo                     (0) | Train Loss: 0.7114 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.7132 | Train Acc: 0.9477
 Site-photo                     (0) | Train Loss: 0.7469 | Train Acc: 0.9607
 Site-art_painting              (4) | Train Loss: 1.2394 | Train Acc: 0.6667
 Site-art_painting              (3) | Train Loss: 1.2571 | Train Acc: 0.6211
 Site-art_painting              (3) | Train Loss: 1.1149 | Train Acc: 0.7887
 Site-cartoon                   (1) | Train Loss: 1.4440 | Train Acc: 0.5882
 Site-cartoon                   (1) | Train Loss: 1.3583 | Train Acc: 0.5814
 Site-sketch                    (2) | Train Loss: 1.6460 | Train Acc: 0.3719
Average Train Accuracy: 0.7613
 Site-photo                     (0) | Val  Loss: 0.7544 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.7167 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.7639 | Val  Acc: 0.9265
 Site-photo                     (0) | Val  Loss: 0.7516 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.6700 | Val  Acc: 0.9539
 Site-art_painting              (4) | Val  Loss: 1.1288 | Val  Acc: 0.7857
 Site-art_painting              (3) | Val  Loss: 1.1352 | Val  Acc: 0.8095
 Site-art_painting              (3) | Val  Loss: 1.2472 | Val  Acc: 0.7394
 Site-cartoon                   (1) | Val  Loss: 1.3789 | Val  Acc: 0.6087
 Site-cartoon                   (1) | Val  Loss: 1.3580 | Val  Acc: 0.5739
 Site-sketch                    (2) | Val  Loss: 1.5932 | Val  Acc: 0.4250
Average Valid Accuracy: 0.7886
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9778
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9265
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9412
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9539
 Best site-art_painting             (4)  | Epoch:5 | Val Acc: 0.7857
 Best site-art_painting             (3)  | Epoch:5 | Val Acc: 0.8095
 Best site-art_painting             (3)  | Epoch:5 | Val Acc: 0.7394
 Best site-cartoon                  (1)  | Epoch:5 | Val Acc: 0.6087
 Best site-cartoon                  (1)  | Epoch:5 | Val Acc: 0.5739
 Best site-sketch                   (2)  | Epoch:5 | Val Acc: 0.4250
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 5, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (1) | Train Loss: 0.7266 | Train Acc: 0.9333
 Site-photo                     (1) | Train Loss: 0.6966 | Train Acc: 0.9118
 Site-photo                     (1) | Train Loss: 0.6222 | Train Acc: 0.9608
 Site-photo                     (1) | Train Loss: 0.6459 | Train Acc: 0.9542
 Site-photo                     (1) | Train Loss: 0.6249 | Train Acc: 0.9607
 Site-art_painting              (3) | Train Loss: 1.0813 | Train Acc: 0.8095
 Site-art_painting              (3) | Train Loss: 1.1404 | Train Acc: 0.7263
 Site-art_painting              (3) | Train Loss: 1.0391 | Train Acc: 0.8122
 Site-cartoon                   (0) | Train Loss: 1.3215 | Train Acc: 0.6765
 Site-cartoon                   (4) | Train Loss: 1.2788 | Train Acc: 0.6047
 Site-sketch                    (2) | Train Loss: 1.5974 | Train Acc: 0.3967
Average Train Accuracy: 0.7952
 Site-photo                     (1) | Val  Loss: 0.6253 | Val  Acc: 0.9667
 Site-photo                     (1) | Val  Loss: 0.6690 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.6650 | Val  Acc: 0.9559
 Site-photo                     (1) | Val  Loss: 0.6551 | Val  Acc: 0.9510
 Site-photo                     (1) | Val  Loss: 0.5896 | Val  Acc: 0.9671
 Site-art_painting              (3) | Val  Loss: 0.9613 | Val  Acc: 0.8929
 Site-art_painting              (3) | Val  Loss: 0.9383 | Val  Acc: 0.8889
 Site-art_painting              (3) | Val  Loss: 1.0747 | Val  Acc: 0.8521
 Site-cartoon                   (0) | Val  Loss: 1.3782 | Val  Acc: 0.6087
 Site-cartoon                   (4) | Val  Loss: 1.2129 | Val  Acc: 0.6870
 Site-sketch                    (2) | Val  Loss: 1.5667 | Val  Acc: 0.4125
Average Valid Accuracy: 0.8307
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9667
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9559
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9510
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9671
 Best site-art_painting             (3)  | Epoch:6 | Val Acc: 0.8929
 Best site-art_painting             (3)  | Epoch:6 | Val Acc: 0.8889
 Best site-art_painting             (3)  | Epoch:6 | Val Acc: 0.8521
 Best site-cartoon                  (0)  | Epoch:6 | Val Acc: 0.6087
 Best site-cartoon                  (4)  | Epoch:6 | Val Acc: 0.6870
 Best site-sketch                   (2)  | Epoch:6 | Val Acc: 0.4125
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 2, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (3) | Train Loss: 0.6309 | Train Acc: 0.9333
 Site-photo                     (3) | Train Loss: 0.8064 | Train Acc: 0.9265
 Site-photo                     (3) | Train Loss: 0.5403 | Train Acc: 0.9804
 Site-photo                     (1) | Train Loss: 0.5656 | Train Acc: 0.9673
 Site-photo                     (3) | Train Loss: 0.5714 | Train Acc: 0.9651
 Site-art_painting              (4) | Train Loss: 0.9656 | Train Acc: 0.7857
 Site-art_painting              (1) | Train Loss: 1.0355 | Train Acc: 0.6947
 Site-art_painting              (4) | Train Loss: 0.8903 | Train Acc: 0.8404
 Site-cartoon                   (0) | Train Loss: 1.2042 | Train Acc: 0.7059
 Site-cartoon                   (0) | Train Loss: 1.1583 | Train Acc: 0.6860
 Site-sketch                    (2) | Train Loss: 1.4969 | Train Acc: 0.5041
Average Train Accuracy: 0.8172
 Site-photo                     (3) | Val  Loss: 0.5919 | Val  Acc: 0.9000
 Site-photo                     (3) | Val  Loss: 0.5887 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.5966 | Val  Acc: 0.9559
 Site-photo                     (1) | Val  Loss: 0.5974 | Val  Acc: 0.9216
 Site-photo                     (3) | Val  Loss: 0.5199 | Val  Acc: 0.9605
 Site-art_painting              (4) | Val  Loss: 0.9030 | Val  Acc: 0.8214
 Site-art_painting              (1) | Val  Loss: 0.8616 | Val  Acc: 0.8571
 Site-art_painting              (4) | Val  Loss: 0.9566 | Val  Acc: 0.8239
 Site-cartoon                   (0) | Val  Loss: 1.2161 | Val  Acc: 0.5652
 Site-cartoon                   (0) | Val  Loss: 1.1056 | Val  Acc: 0.7217
 Site-sketch                    (2) | Val  Loss: 1.4930 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8101
============ Train epoch 8 ============
cnt=[1, 2, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (4) | Train Loss: 0.5666 | Train Acc: 0.9778
 Site-photo                     (4) | Train Loss: 0.6885 | Train Acc: 0.9559
 Site-photo                     (4) | Train Loss: 0.4686 | Train Acc: 0.9804
 Site-photo                     (4) | Train Loss: 0.5270 | Train Acc: 0.9542
 Site-photo                     (0) | Train Loss: 0.5299 | Train Acc: 0.9607
 Site-art_painting              (2) | Train Loss: 0.9392 | Train Acc: 0.7857
 Site-art_painting              (2) | Train Loss: 0.9479 | Train Acc: 0.7474
 Site-art_painting              (2) | Train Loss: 0.8534 | Train Acc: 0.8498
 Site-cartoon                   (1) | Train Loss: 1.0995 | Train Acc: 0.7059
 Site-cartoon                   (1) | Train Loss: 1.0554 | Train Acc: 0.7151
 Site-sketch                    (3) | Train Loss: 1.3962 | Train Acc: 0.4959
Average Train Accuracy: 0.8299
 Site-photo                     (4) | Val  Loss: 0.5145 | Val  Acc: 0.9333
 Site-photo                     (4) | Val  Loss: 0.5346 | Val  Acc: 0.9556
 Site-photo                     (4) | Val  Loss: 0.5375 | Val  Acc: 0.9265
 Site-photo                     (4) | Val  Loss: 0.5395 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.4717 | Val  Acc: 0.9474
 Site-art_painting              (2) | Val  Loss: 0.7500 | Val  Acc: 0.8571
 Site-art_painting              (2) | Val  Loss: 0.7501 | Val  Acc: 0.9365
 Site-art_painting              (2) | Val  Loss: 0.9170 | Val  Acc: 0.8310
 Site-cartoon                   (1) | Val  Loss: 1.0868 | Val  Acc: 0.6522
 Site-cartoon                   (1) | Val  Loss: 1.0353 | Val  Acc: 0.7478
 Site-sketch                    (3) | Val  Loss: 1.4365 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8325
 Best site-photo                    (4)  | Epoch:8 | Val Acc: 0.9333
 Best site-photo                    (4)  | Epoch:8 | Val Acc: 0.9556
 Best site-photo                    (4)  | Epoch:8 | Val Acc: 0.9265
 Best site-photo                    (4)  | Epoch:8 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9474
 Best site-art_painting             (2)  | Epoch:8 | Val Acc: 0.8571
 Best site-art_painting             (2)  | Epoch:8 | Val Acc: 0.9365
 Best site-art_painting             (2)  | Epoch:8 | Val Acc: 0.8310
 Best site-cartoon                  (1)  | Epoch:8 | Val Acc: 0.6522
 Best site-cartoon                  (1)  | Epoch:8 | Val Acc: 0.7478
 Best site-sketch                   (3)  | Epoch:8 | Val Acc: 0.4000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 9 ============
cnt=[3, 1, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (0) | Train Loss: 0.5113 | Train Acc: 0.9556
 Site-photo                     (4) | Train Loss: 0.6006 | Train Acc: 0.9412
 Site-photo                     (0) | Train Loss: 0.4227 | Train Acc: 0.9804
 Site-photo                     (4) | Train Loss: 0.5003 | Train Acc: 0.9477
 Site-photo                     (0) | Train Loss: 0.4726 | Train Acc: 0.9651
 Site-art_painting              (3) | Train Loss: 0.8721 | Train Acc: 0.8095
 Site-art_painting              (3) | Train Loss: 0.8263 | Train Acc: 0.8211
 Site-art_painting              (3) | Train Loss: 0.7720 | Train Acc: 0.8357
 Site-cartoon                   (2) | Train Loss: 1.0406 | Train Acc: 0.7059
 Site-cartoon                   (2) | Train Loss: 0.9918 | Train Acc: 0.7093
 Site-sketch                    (1) | Train Loss: 1.2454 | Train Acc: 0.6116
Average Train Accuracy: 0.8439
 Site-photo                     (0) | Val  Loss: 0.4792 | Val  Acc: 0.9000
 Site-photo                     (4) | Val  Loss: 0.4513 | Val  Acc: 0.9111
 Site-photo                     (0) | Val  Loss: 0.4636 | Val  Acc: 0.9559
 Site-photo                     (4) | Val  Loss: 0.4925 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.4125 | Val  Acc: 0.9803
 Site-art_painting              (3) | Val  Loss: 0.6954 | Val  Acc: 0.8214
 Site-art_painting              (3) | Val  Loss: 0.7331 | Val  Acc: 0.9048
 Site-art_painting              (3) | Val  Loss: 0.7826 | Val  Acc: 0.8873
 Site-cartoon                   (2) | Val  Loss: 0.9730 | Val  Acc: 0.7826
 Site-cartoon                   (2) | Val  Loss: 0.9310 | Val  Acc: 0.7826
 Site-sketch                    (1) | Val  Loss: 1.3679 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8470
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9000
 Best site-photo                    (4)  | Epoch:9 | Val Acc: 0.9111
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9559
 Best site-photo                    (4)  | Epoch:9 | Val Acc: 0.9412
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9803
 Best site-art_painting             (3)  | Epoch:9 | Val Acc: 0.8214
 Best site-art_painting             (3)  | Epoch:9 | Val Acc: 0.9048
 Best site-art_painting             (3)  | Epoch:9 | Val Acc: 0.8873
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.7826
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.7826
 Best site-sketch                   (1)  | Epoch:9 | Val Acc: 0.4500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 10 ============
cnt=[5, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (0) | Train Loss: 0.4759 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.5278 | Train Acc: 0.9412
 Site-photo                     (0) | Train Loss: 0.3470 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.4397 | Train Acc: 0.9412
 Site-photo                     (0) | Train Loss: 0.4129 | Train Acc: 0.9607
 Site-art_painting              (3) | Train Loss: 0.8096 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.7398 | Train Acc: 0.8316
 Site-art_painting              (3) | Train Loss: 0.6541 | Train Acc: 0.8920
 Site-cartoon                   (2) | Train Loss: 0.8871 | Train Acc: 0.7353
 Site-cartoon                   (4) | Train Loss: 0.9037 | Train Acc: 0.8081
 Site-sketch                    (1) | Train Loss: 1.1760 | Train Acc: 0.6364
Average Train Accuracy: 0.8651
 Site-photo                     (0) | Val  Loss: 0.4111 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.4161 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.4120 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.4211 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.3655 | Val  Acc: 0.9671
 Site-art_painting              (3) | Val  Loss: 0.6189 | Val  Acc: 0.9286
 Site-art_painting              (3) | Val  Loss: 0.6500 | Val  Acc: 0.8889
 Site-art_painting              (3) | Val  Loss: 0.7956 | Val  Acc: 0.8451
 Site-cartoon                   (2) | Val  Loss: 0.9214 | Val  Acc: 0.8261
 Site-cartoon                   (4) | Val  Loss: 0.8468 | Val  Acc: 0.8174
 Site-sketch                    (1) | Val  Loss: 1.3279 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8670
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9412
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9671
 Best site-art_painting             (3)  | Epoch:10 | Val Acc: 0.9286
 Best site-art_painting             (3)  | Epoch:10 | Val Acc: 0.8889
 Best site-art_painting             (3)  | Epoch:10 | Val Acc: 0.8451
 Best site-cartoon                  (2)  | Epoch:10 | Val Acc: 0.8261
 Best site-cartoon                  (4)  | Epoch:10 | Val Acc: 0.8174
 Best site-sketch                   (1)  | Epoch:10 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 11 ============
cnt=[3, 1, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (3) | Train Loss: 0.4396 | Train Acc: 0.9556
 Site-photo                     (3) | Train Loss: 0.3298 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.3380 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.3810 | Train Acc: 0.9608
 Site-photo                     (3) | Train Loss: 0.3802 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.7740 | Train Acc: 0.8571
 Site-art_painting              (0) | Train Loss: 0.7217 | Train Acc: 0.8105
 Site-art_painting              (0) | Train Loss: 0.6430 | Train Acc: 0.8873
 Site-cartoon                   (2) | Train Loss: 0.8845 | Train Acc: 0.7353
 Site-cartoon                   (4) | Train Loss: 0.8223 | Train Acc: 0.8081
 Site-sketch                    (1) | Train Loss: 1.0655 | Train Acc: 0.6694
Average Train Accuracy: 0.8723
 Site-photo                     (3) | Val  Loss: 0.3989 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.4042 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.3806 | Val  Acc: 0.9412
 Site-photo                     (3) | Val  Loss: 0.3737 | Val  Acc: 0.9412
 Site-photo                     (3) | Val  Loss: 0.3237 | Val  Acc: 0.9737
 Site-art_painting              (0) | Val  Loss: 0.4998 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.5920 | Val  Acc: 0.9048
 Site-art_painting              (0) | Val  Loss: 0.7796 | Val  Acc: 0.8592
 Site-cartoon                   (2) | Val  Loss: 0.8487 | Val  Acc: 0.8696
 Site-cartoon                   (4) | Val  Loss: 0.7905 | Val  Acc: 0.8522
 Site-sketch                    (1) | Val  Loss: 1.1434 | Val  Acc: 0.6375
Average Valid Accuracy: 0.8918
 Best site-photo                    (3)  | Epoch:11 | Val Acc: 0.9333
 Best site-photo                    (3)  | Epoch:11 | Val Acc: 0.9333
 Best site-photo                    (3)  | Epoch:11 | Val Acc: 0.9412
 Best site-photo                    (3)  | Epoch:11 | Val Acc: 0.9412
 Best site-photo                    (3)  | Epoch:11 | Val Acc: 0.9737
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.9643
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.9048
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.8592
 Best site-cartoon                  (2)  | Epoch:11 | Val Acc: 0.8696
 Best site-cartoon                  (4)  | Epoch:11 | Val Acc: 0.8522
 Best site-sketch                   (1)  | Epoch:11 | Val Acc: 0.6375
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 12 ============
cnt=[3, 1, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (4) | Train Loss: 0.3795 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.3697 | Train Acc: 0.9559
 Site-photo                     (3) | Train Loss: 0.2814 | Train Acc: 0.9804
 Site-photo                     (3) | Train Loss: 0.3273 | Train Acc: 0.9542
 Site-photo                     (4) | Train Loss: 0.3394 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.6702 | Train Acc: 0.9048
 Site-art_painting              (0) | Train Loss: 0.6438 | Train Acc: 0.8737
 Site-art_painting              (0) | Train Loss: 0.5622 | Train Acc: 0.9014
 Site-cartoon                   (2) | Train Loss: 0.8070 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.8382 | Train Acc: 0.7907
 Site-sketch                    (1) | Train Loss: 1.0380 | Train Acc: 0.6529
Average Train Accuracy: 0.8895
 Site-photo                     (4) | Val  Loss: 0.4052 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.3397 | Val  Acc: 0.9778
 Site-photo                     (3) | Val  Loss: 0.3511 | Val  Acc: 0.9559
 Site-photo                     (3) | Val  Loss: 0.3463 | Val  Acc: 0.9412
 Site-photo                     (4) | Val  Loss: 0.3008 | Val  Acc: 0.9737
 Site-art_painting              (0) | Val  Loss: 0.6095 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.5173 | Val  Acc: 0.9206
 Site-art_painting              (0) | Val  Loss: 0.6819 | Val  Acc: 0.8662
 Site-cartoon                   (2) | Val  Loss: 0.8372 | Val  Acc: 0.8261
 Site-cartoon                   (2) | Val  Loss: 0.7385 | Val  Acc: 0.8522
 Site-sketch                    (1) | Val  Loss: 1.2209 | Val  Acc: 0.6125
Average Valid Accuracy: 0.8866
============ Train epoch 13 ============
cnt=[1, 3, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (3) | Train Loss: 0.3372 | Train Acc: 0.9556
 Site-photo                     (3) | Train Loss: 0.2328 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.2803 | Train Acc: 0.9804
 Site-photo                     (3) | Train Loss: 0.3156 | Train Acc: 0.9673
 Site-photo                     (4) | Train Loss: 0.3247 | Train Acc: 0.9607
 Site-art_painting              (1) | Train Loss: 0.6701 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.6989 | Train Acc: 0.8105
 Site-art_painting              (1) | Train Loss: 0.5611 | Train Acc: 0.8967
 Site-cartoon                   (2) | Train Loss: 0.7115 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.7665 | Train Acc: 0.8081
 Site-sketch                    (0) | Train Loss: 0.9494 | Train Acc: 0.6612
Average Train Accuracy: 0.8802
 Site-photo                     (3) | Val  Loss: 0.3609 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.3713 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.3219 | Val  Acc: 0.9559
 Site-photo                     (3) | Val  Loss: 0.3370 | Val  Acc: 0.9510
 Site-photo                     (4) | Val  Loss: 0.2809 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.5006 | Val  Acc: 0.9286
 Site-art_painting              (1) | Val  Loss: 0.4685 | Val  Acc: 0.9524
 Site-art_painting              (1) | Val  Loss: 0.6678 | Val  Acc: 0.8662
 Site-cartoon                   (2) | Val  Loss: 0.7203 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.7220 | Val  Acc: 0.8261
 Site-sketch                    (0) | Val  Loss: 1.1245 | Val  Acc: 0.6125
Average Valid Accuracy: 0.8917
============ Train epoch 14 ============
cnt=[3, 1, 2, 2, 3, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (4) | Train Loss: 0.2956 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2462 | Train Acc: 0.9559
 Site-photo                     (3) | Train Loss: 0.2334 | Train Acc: 0.9804
 Site-photo                     (4) | Train Loss: 0.2835 | Train Acc: 0.9673
 Site-photo                     (4) | Train Loss: 0.2991 | Train Acc: 0.9607
 Site-art_painting              (0) | Train Loss: 0.5976 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.6581 | Train Acc: 0.8421
 Site-art_painting              (0) | Train Loss: 0.5003 | Train Acc: 0.9155
 Site-cartoon                   (2) | Train Loss: 0.7015 | Train Acc: 0.7941
 Site-cartoon                   (2) | Train Loss: 0.7034 | Train Acc: 0.8372
 Site-sketch                    (1) | Train Loss: 0.9363 | Train Acc: 0.7190
Average Train Accuracy: 0.8914
 Site-photo                     (4) | Val  Loss: 0.3493 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.3013 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.2912 | Val  Acc: 0.9559
 Site-photo                     (4) | Val  Loss: 0.2962 | Val  Acc: 0.9510
 Site-photo                     (4) | Val  Loss: 0.2754 | Val  Acc: 0.9737
 Site-art_painting              (0) | Val  Loss: 0.5883 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.4906 | Val  Acc: 0.9048
 Site-art_painting              (0) | Val  Loss: 0.6312 | Val  Acc: 0.8873
 Site-cartoon                   (2) | Val  Loss: 0.6840 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.6633 | Val  Acc: 0.8435
 Site-sketch                    (1) | Val  Loss: 1.0850 | Val  Acc: 0.6750
Average Valid Accuracy: 0.8987
 Best site-photo                    (4)  | Epoch:14 | Val Acc: 0.9333
 Best site-photo                    (3)  | Epoch:14 | Val Acc: 0.9556
 Best site-photo                    (3)  | Epoch:14 | Val Acc: 0.9559
 Best site-photo                    (4)  | Epoch:14 | Val Acc: 0.9510
 Best site-photo                    (4)  | Epoch:14 | Val Acc: 0.9737
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.8929
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.9048
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.8873
 Best site-cartoon                  (2)  | Epoch:14 | Val Acc: 0.9130
 Best site-cartoon                  (2)  | Epoch:14 | Val Acc: 0.8435
 Best site-sketch                   (1)  | Epoch:14 | Val Acc: 0.6750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 1, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (0) | Train Loss: 0.3026 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.2527 | Train Acc: 0.9412
 Site-photo                     (3) | Train Loss: 0.2469 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.2907 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.2637 | Train Acc: 0.9694
 Site-art_painting              (4) | Train Loss: 0.6500 | Train Acc: 0.8333
 Site-art_painting              (4) | Train Loss: 0.6473 | Train Acc: 0.8421
 Site-art_painting              (3) | Train Loss: 0.4857 | Train Acc: 0.9014
 Site-cartoon                   (2) | Train Loss: 0.6770 | Train Acc: 0.7647
 Site-cartoon                   (2) | Train Loss: 0.6714 | Train Acc: 0.8547
 Site-sketch                    (1) | Train Loss: 0.8296 | Train Acc: 0.7438
Average Train Accuracy: 0.8896
 Site-photo                     (0) | Val  Loss: 0.3752 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.2924 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.2788 | Val  Acc: 0.9559
 Site-photo                     (3) | Val  Loss: 0.2929 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.2517 | Val  Acc: 0.9868
 Site-art_painting              (4) | Val  Loss: 0.3828 | Val  Acc: 0.9643
 Site-art_painting              (4) | Val  Loss: 0.4423 | Val  Acc: 0.9524
 Site-art_painting              (3) | Val  Loss: 0.6432 | Val  Acc: 0.8873
 Site-cartoon                   (2) | Val  Loss: 0.6466 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.6008 | Val  Acc: 0.8696
 Site-sketch                    (1) | Val  Loss: 0.9568 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9114
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9333
 Best site-photo                    (3)  | Epoch:15 | Val Acc: 0.9556
 Best site-photo                    (3)  | Epoch:15 | Val Acc: 0.9559
 Best site-photo                    (3)  | Epoch:15 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9868
 Best site-art_painting             (4)  | Epoch:15 | Val Acc: 0.9643
 Best site-art_painting             (4)  | Epoch:15 | Val Acc: 0.9524
 Best site-art_painting             (3)  | Epoch:15 | Val Acc: 0.8873
 Best site-cartoon                  (2)  | Epoch:15 | Val Acc: 0.8696
 Best site-cartoon                  (2)  | Epoch:15 | Val Acc: 0.8696
 Best site-sketch                   (1)  | Epoch:15 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 16 ============
cnt=[3, 1, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (3) | Train Loss: 0.2549 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2350 | Train Acc: 0.9265
 Site-photo                     (3) | Train Loss: 0.2057 | Train Acc: 0.9804
 Site-photo                     (3) | Train Loss: 0.2443 | Train Acc: 0.9739
 Site-photo                     (3) | Train Loss: 0.2367 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.5942 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.5201 | Train Acc: 0.8421
 Site-art_painting              (0) | Train Loss: 0.4649 | Train Acc: 0.8967
 Site-cartoon                   (2) | Train Loss: 0.6455 | Train Acc: 0.8235
 Site-cartoon                   (4) | Train Loss: 0.6236 | Train Acc: 0.8314
 Site-sketch                    (1) | Train Loss: 0.8232 | Train Acc: 0.7273
Average Train Accuracy: 0.8917
 Site-photo                     (3) | Val  Loss: 0.2931 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.2994 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.2366 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.2578 | Val  Acc: 0.9510
 Site-photo                     (3) | Val  Loss: 0.2284 | Val  Acc: 0.9737
 Site-art_painting              (0) | Val  Loss: 0.4672 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.3381 | Val  Acc: 0.9524
 Site-art_painting              (0) | Val  Loss: 0.5991 | Val  Acc: 0.8873
 Site-cartoon                   (2) | Val  Loss: 0.6847 | Val  Acc: 0.8261
 Site-cartoon                   (4) | Val  Loss: 0.6038 | Val  Acc: 0.8609
 Site-sketch                    (1) | Val  Loss: 1.0199 | Val  Acc: 0.6750
Average Valid Accuracy: 0.8981
============ Train epoch 17 ============
cnt=[2, 3, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (3) | Train Loss: 0.2828 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.1940 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.2011 | Train Acc: 0.9804
 Site-photo                     (4) | Train Loss: 0.2416 | Train Acc: 0.9673
 Site-photo                     (3) | Train Loss: 0.2271 | Train Acc: 0.9694
 Site-art_painting              (1) | Train Loss: 0.5545 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.4583 | Train Acc: 0.8947
 Site-art_painting              (1) | Train Loss: 0.4381 | Train Acc: 0.9249
 Site-cartoon                   (0) | Train Loss: 0.6313 | Train Acc: 0.8235
 Site-cartoon                   (0) | Train Loss: 0.6172 | Train Acc: 0.8256
 Site-sketch                    (2) | Train Loss: 0.7716 | Train Acc: 0.7438
Average Train Accuracy: 0.9024
 Site-photo                     (3) | Val  Loss: 0.2434 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.2836 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.2321 | Val  Acc: 0.9559
 Site-photo                     (4) | Val  Loss: 0.2556 | Val  Acc: 0.9412
 Site-photo                     (3) | Val  Loss: 0.2130 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.5253 | Val  Acc: 0.8571
 Site-art_painting              (1) | Val  Loss: 0.3557 | Val  Acc: 0.9524
 Site-art_painting              (1) | Val  Loss: 0.5562 | Val  Acc: 0.8873
 Site-cartoon                   (0) | Val  Loss: 0.6212 | Val  Acc: 0.8696
 Site-cartoon                   (0) | Val  Loss: 0.5429 | Val  Acc: 0.8870
 Site-sketch                    (2) | Val  Loss: 1.0965 | Val  Acc: 0.6625
Average Valid Accuracy: 0.8984
============ Train epoch 18 ============
cnt=[3, 1, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (3) | Train Loss: 0.2578 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.1778 | Train Acc: 0.9559
 Site-photo                     (3) | Train Loss: 0.1675 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.2063 | Train Acc: 0.9673
 Site-photo                     (3) | Train Loss: 0.2445 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.5347 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.5733 | Train Acc: 0.8526
 Site-art_painting              (0) | Train Loss: 0.4155 | Train Acc: 0.8967
 Site-cartoon                   (4) | Train Loss: 0.5935 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.5977 | Train Acc: 0.8547
 Site-sketch                    (1) | Train Loss: 0.7620 | Train Acc: 0.7521
Average Train Accuracy: 0.9015
 Site-photo                     (3) | Val  Loss: 0.3431 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.2452 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.2234 | Val  Acc: 0.9559
 Site-photo                     (3) | Val  Loss: 0.2495 | Val  Acc: 0.9510
 Site-photo                     (3) | Val  Loss: 0.2031 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.4378 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.3484 | Val  Acc: 0.9524
 Site-art_painting              (0) | Val  Loss: 0.4993 | Val  Acc: 0.9014
 Site-cartoon                   (4) | Val  Loss: 0.5820 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.5106 | Val  Acc: 0.8696
 Site-sketch                    (1) | Val  Loss: 1.0266 | Val  Acc: 0.6875
Average Valid Accuracy: 0.9084
============ Train epoch 19 ============
cnt=[3, 1, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (2) | Train Loss: 0.2360 | Train Acc: 0.9778
 Site-photo                     (2) | Train Loss: 0.3600 | Train Acc: 0.9559
 Site-photo                     (2) | Train Loss: 0.1733 | Train Acc: 0.9902
 Site-photo                     (2) | Train Loss: 0.2113 | Train Acc: 0.9673
 Site-photo                     (2) | Train Loss: 0.2147 | Train Acc: 0.9607
 Site-art_painting              (0) | Train Loss: 0.5507 | Train Acc: 0.8095
 Site-art_painting              (0) | Train Loss: 0.4721 | Train Acc: 0.8737
 Site-art_painting              (0) | Train Loss: 0.4598 | Train Acc: 0.9249
 Site-cartoon                   (3) | Train Loss: 0.5799 | Train Acc: 0.8235
 Site-cartoon                   (4) | Train Loss: 0.5481 | Train Acc: 0.8663
 Site-sketch                    (1) | Train Loss: 0.7290 | Train Acc: 0.7521
Average Train Accuracy: 0.9002
 Site-photo                     (2) | Val  Loss: 0.3003 | Val  Acc: 0.9333
 Site-photo                     (2) | Val  Loss: 0.2167 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.2128 | Val  Acc: 0.9412
 Site-photo                     (2) | Val  Loss: 0.1976 | Val  Acc: 0.9608
 Site-photo                     (2) | Val  Loss: 0.1966 | Val  Acc: 0.9605
 Site-art_painting              (0) | Val  Loss: 0.3418 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.4140 | Val  Acc: 0.8730
 Site-art_painting              (0) | Val  Loss: 0.4691 | Val  Acc: 0.9014
 Site-cartoon                   (3) | Val  Loss: 0.6068 | Val  Acc: 0.8696
 Site-cartoon                   (4) | Val  Loss: 0.4872 | Val  Acc: 0.9217
 Site-sketch                    (1) | Val  Loss: 0.8953 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9087
============ Train epoch 20 ============
cnt=[2, 1, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (4) | Train Loss: 0.1820 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1496 | Train Acc: 0.9559
 Site-photo                     (4) | Train Loss: 0.1520 | Train Acc: 0.9804
 Site-photo                     (4) | Train Loss: 0.2321 | Train Acc: 0.9477
 Site-photo                     (4) | Train Loss: 0.2105 | Train Acc: 0.9563
 Site-art_painting              (0) | Train Loss: 0.4656 | Train Acc: 0.8571
 Site-art_painting              (3) | Train Loss: 0.3732 | Train Acc: 0.8947
 Site-art_painting              (0) | Train Loss: 0.3322 | Train Acc: 0.9390
 Site-cartoon                   (2) | Train Loss: 0.5733 | Train Acc: 0.7941
 Site-cartoon                   (2) | Train Loss: 0.5467 | Train Acc: 0.8372
 Site-sketch                    (1) | Train Loss: 0.7708 | Train Acc: 0.7273
Average Train Accuracy: 0.8991
 Site-photo                     (4) | Val  Loss: 0.2759 | Val  Acc: 0.9000
 Site-photo                     (3) | Val  Loss: 0.2141 | Val  Acc: 0.9556
 Site-photo                     (4) | Val  Loss: 0.1585 | Val  Acc: 0.9706
 Site-photo                     (4) | Val  Loss: 0.1858 | Val  Acc: 0.9510
 Site-photo                     (4) | Val  Loss: 0.1587 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.4006 | Val  Acc: 0.8929
 Site-art_painting              (3) | Val  Loss: 0.3618 | Val  Acc: 0.9048
 Site-art_painting              (0) | Val  Loss: 0.4630 | Val  Acc: 0.9225
 Site-cartoon                   (2) | Val  Loss: 0.5183 | Val  Acc: 0.9565
 Site-cartoon                   (2) | Val  Loss: 0.5164 | Val  Acc: 0.9043
 Site-sketch                    (1) | Val  Loss: 0.8824 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9126
 Best site-photo                    (4)  | Epoch:20 | Val Acc: 0.9000
 Best site-photo                    (3)  | Epoch:20 | Val Acc: 0.9556
 Best site-photo                    (4)  | Epoch:20 | Val Acc: 0.9706
 Best site-photo                    (4)  | Epoch:20 | Val Acc: 0.9510
 Best site-photo                    (4)  | Epoch:20 | Val Acc: 0.9803
 Best site-art_painting             (0)  | Epoch:20 | Val Acc: 0.8929
 Best site-art_painting             (3)  | Epoch:20 | Val Acc: 0.9048
 Best site-art_painting             (0)  | Epoch:20 | Val Acc: 0.9225
 Best site-cartoon                  (2)  | Epoch:20 | Val Acc: 0.9565
 Best site-cartoon                  (2)  | Epoch:20 | Val Acc: 0.9043
 Best site-sketch                   (1)  | Epoch:20 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 21 ============
cnt=[5, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (0) | Train Loss: 0.2332 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.1794 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1350 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1848 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1958 | Train Acc: 0.9738
 Site-art_painting              (4) | Train Loss: 0.5226 | Train Acc: 0.8810
 Site-art_painting              (3) | Train Loss: 0.4717 | Train Acc: 0.8632
 Site-art_painting              (3) | Train Loss: 0.3523 | Train Acc: 0.9296
 Site-cartoon                   (2) | Train Loss: 0.5578 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.5196 | Train Acc: 0.8721
 Site-sketch                    (1) | Train Loss: 0.6686 | Train Acc: 0.7769
Average Train Accuracy: 0.9109
 Site-photo                     (0) | Val  Loss: 0.3054 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2103 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.1716 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1752 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1647 | Val  Acc: 0.9737
 Site-art_painting              (4) | Val  Loss: 0.3443 | Val  Acc: 0.9643
 Site-art_painting              (3) | Val  Loss: 0.3176 | Val  Acc: 0.9524
 Site-art_painting              (3) | Val  Loss: 0.4888 | Val  Acc: 0.9155
 Site-cartoon                   (2) | Val  Loss: 0.5279 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.4687 | Val  Acc: 0.8870
 Site-sketch                    (1) | Val  Loss: 0.9124 | Val  Acc: 0.6500
Average Valid Accuracy: 0.9176
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9778
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9737
 Best site-art_painting             (4)  | Epoch:21 | Val Acc: 0.9643
 Best site-art_painting             (3)  | Epoch:21 | Val Acc: 0.9524
 Best site-art_painting             (3)  | Epoch:21 | Val Acc: 0.9155
 Best site-cartoon                  (2)  | Epoch:21 | Val Acc: 0.9130
 Best site-cartoon                  (2)  | Epoch:21 | Val Acc: 0.8870
 Best site-sketch                   (1)  | Epoch:21 | Val Acc: 0.6500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 22 ============
cnt=[5, 1, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (0) | Train Loss: 0.1831 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.1550 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1303 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1736 | Train Acc: 0.9608
 Site-photo                     (0) | Train Loss: 0.1876 | Train Acc: 0.9651
 Site-art_painting              (4) | Train Loss: 0.5072 | Train Acc: 0.8571
 Site-art_painting              (4) | Train Loss: 0.4332 | Train Acc: 0.8947
 Site-art_painting              (4) | Train Loss: 0.3278 | Train Acc: 0.9249
 Site-cartoon                   (3) | Train Loss: 0.6432 | Train Acc: 0.7647
 Site-cartoon                   (2) | Train Loss: 0.5516 | Train Acc: 0.8256
 Site-sketch                    (1) | Train Loss: 0.6344 | Train Acc: 0.8099
Average Train Accuracy: 0.9026
 Site-photo                     (0) | Val  Loss: 0.2071 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2486 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1765 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1877 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1562 | Val  Acc: 0.9868
 Site-art_painting              (4) | Val  Loss: 0.2853 | Val  Acc: 0.9643
 Site-art_painting              (4) | Val  Loss: 0.3337 | Val  Acc: 0.8730
 Site-art_painting              (4) | Val  Loss: 0.4066 | Val  Acc: 0.9366
 Site-cartoon                   (3) | Val  Loss: 0.4996 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.4448 | Val  Acc: 0.8957
 Site-sketch                    (1) | Val  Loss: 0.9341 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9099
============ Train epoch 23 ============
cnt=[5, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (0) | Train Loss: 0.1799 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.2192 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1458 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1688 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1690 | Train Acc: 0.9694
 Site-art_painting              (3) | Train Loss: 0.4860 | Train Acc: 0.8810
 Site-art_painting              (3) | Train Loss: 0.4544 | Train Acc: 0.9263
 Site-art_painting              (3) | Train Loss: 0.3482 | Train Acc: 0.9249
 Site-cartoon                   (2) | Train Loss: 0.5926 | Train Acc: 0.8529
 Site-cartoon                   (4) | Train Loss: 0.4795 | Train Acc: 0.9012
 Site-sketch                    (1) | Train Loss: 0.6456 | Train Acc: 0.7686
Average Train Accuracy: 0.9215
 Site-photo                     (0) | Val  Loss: 0.2530 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.2373 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1717 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1616 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1440 | Val  Acc: 0.9868
 Site-art_painting              (3) | Val  Loss: 0.3660 | Val  Acc: 0.8571
 Site-art_painting              (3) | Val  Loss: 0.3132 | Val  Acc: 0.9048
 Site-art_painting              (3) | Val  Loss: 0.4459 | Val  Acc: 0.9225
 Site-cartoon                   (2) | Val  Loss: 0.5242 | Val  Acc: 0.8696
 Site-cartoon                   (4) | Val  Loss: 0.4536 | Val  Acc: 0.8957
 Site-sketch                    (1) | Val  Loss: 0.9085 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9077
============ Train epoch 24 ============
cnt=[3, 1, 1, 1, 5, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (4) | Train Loss: 0.1918 | Train Acc: 0.9778
 Site-photo                     (4) | Train Loss: 0.2322 | Train Acc: 0.9559
 Site-photo                     (4) | Train Loss: 0.1401 | Train Acc: 0.9804
 Site-photo                     (4) | Train Loss: 0.1484 | Train Acc: 0.9804
 Site-photo                     (4) | Train Loss: 0.1718 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.4720 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.3777 | Train Acc: 0.8947
 Site-art_painting              (0) | Train Loss: 0.3351 | Train Acc: 0.9108
 Site-cartoon                   (3) | Train Loss: 0.5176 | Train Acc: 0.7941
 Site-cartoon                   (1) | Train Loss: 0.4546 | Train Acc: 0.8895
 Site-sketch                    (2) | Train Loss: 0.6095 | Train Acc: 0.8017
Average Train Accuracy: 0.9080
 Site-photo                     (4) | Val  Loss: 0.1923 | Val  Acc: 0.9667
 Site-photo                     (4) | Val  Loss: 0.2746 | Val  Acc: 0.9556
 Site-photo                     (4) | Val  Loss: 0.1480 | Val  Acc: 0.9706
 Site-photo                     (4) | Val  Loss: 0.1683 | Val  Acc: 0.9510
 Site-photo                     (4) | Val  Loss: 0.1363 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.3406 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.2714 | Val  Acc: 0.9206
 Site-art_painting              (0) | Val  Loss: 0.4395 | Val  Acc: 0.9296
 Site-cartoon                   (3) | Val  Loss: 0.5311 | Val  Acc: 0.8261
 Site-cartoon                   (1) | Val  Loss: 0.4041 | Val  Acc: 0.9217
 Site-sketch                    (2) | Val  Loss: 0.8660 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9156
============ Train epoch 25 ============
cnt=[3, 1, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (3) | Train Loss: 0.1677 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.1142 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.1325 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.1626 | Train Acc: 0.9673
 Site-photo                     (3) | Train Loss: 0.1693 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.4912 | Train Acc: 0.8571
 Site-art_painting              (0) | Train Loss: 0.4113 | Train Acc: 0.8842
 Site-art_painting              (0) | Train Loss: 0.3547 | Train Acc: 0.9014
 Site-cartoon                   (1) | Train Loss: 0.4595 | Train Acc: 0.9118
 Site-cartoon                   (4) | Train Loss: 0.4306 | Train Acc: 0.8895
 Site-sketch                    (2) | Train Loss: 0.6681 | Train Acc: 0.8017
Average Train Accuracy: 0.9197
 Site-photo                     (3) | Val  Loss: 0.2608 | Val  Acc: 0.9000
 Site-photo                     (3) | Val  Loss: 0.2366 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1533 | Val  Acc: 0.9559
 Site-photo                     (3) | Val  Loss: 0.1637 | Val  Acc: 0.9608
 Site-photo                     (3) | Val  Loss: 0.1551 | Val  Acc: 0.9737
 Site-art_painting              (0) | Val  Loss: 0.2115 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.2324 | Val  Acc: 0.9841
 Site-art_painting              (0) | Val  Loss: 0.3479 | Val  Acc: 0.9648
 Site-cartoon                   (1) | Val  Loss: 0.4743 | Val  Acc: 0.8696
 Site-cartoon                   (4) | Val  Loss: 0.3819 | Val  Acc: 0.9217
 Site-sketch                    (2) | Val  Loss: 0.9340 | Val  Acc: 0.6750
Average Valid Accuracy: 0.9237
 Best site-photo                    (3)  | Epoch:25 | Val Acc: 0.9000
 Best site-photo                    (3)  | Epoch:25 | Val Acc: 0.9556
 Best site-photo                    (3)  | Epoch:25 | Val Acc: 0.9559
 Best site-photo                    (3)  | Epoch:25 | Val Acc: 0.9608
 Best site-photo                    (3)  | Epoch:25 | Val Acc: 0.9737
 Best site-art_painting             (0)  | Epoch:25 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:25 | Val Acc: 0.9841
 Best site-art_painting             (0)  | Epoch:25 | Val Acc: 0.9648
 Best site-cartoon                  (1)  | Epoch:25 | Val Acc: 0.8696
 Best site-cartoon                  (4)  | Epoch:25 | Val Acc: 0.9217
 Best site-sketch                   (2)  | Epoch:25 | Val Acc: 0.6750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 26 ============
cnt=[2, 1, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (0) | Train Loss: 0.1398 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.1726 | Train Acc: 0.9559
 Site-photo                     (4) | Train Loss: 0.1021 | Train Acc: 0.9902
 Site-photo                     (4) | Train Loss: 0.1424 | Train Acc: 0.9608
 Site-photo                     (0) | Train Loss: 0.1608 | Train Acc: 0.9694
 Site-art_painting              (3) | Train Loss: 0.3335 | Train Acc: 0.9048
 Site-art_painting              (3) | Train Loss: 0.4059 | Train Acc: 0.9158
 Site-art_painting              (3) | Train Loss: 0.2816 | Train Acc: 0.9343
 Site-cartoon                   (2) | Train Loss: 0.4795 | Train Acc: 0.9118
 Site-cartoon                   (2) | Train Loss: 0.4432 | Train Acc: 0.9070
 Site-sketch                    (1) | Train Loss: 0.6326 | Train Acc: 0.7686
Average Train Accuracy: 0.9290
 Site-photo                     (0) | Val  Loss: 0.2937 | Val  Acc: 0.9333
 Site-photo                     (4) | Val  Loss: 0.2362 | Val  Acc: 0.9556
 Site-photo                     (4) | Val  Loss: 0.1427 | Val  Acc: 0.9706
 Site-photo                     (4) | Val  Loss: 0.1553 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.1353 | Val  Acc: 0.9737
 Site-art_painting              (3) | Val  Loss: 0.2028 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.2562 | Val  Acc: 0.9524
 Site-art_painting              (3) | Val  Loss: 0.3906 | Val  Acc: 0.9225
 Site-cartoon                   (2) | Val  Loss: 0.4426 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.4144 | Val  Acc: 0.8870
 Site-sketch                    (1) | Val  Loss: 0.8995 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9241
 Best site-photo                    (0)  | Epoch:26 | Val Acc: 0.9333
 Best site-photo                    (4)  | Epoch:26 | Val Acc: 0.9556
 Best site-photo                    (4)  | Epoch:26 | Val Acc: 0.9706
 Best site-photo                    (4)  | Epoch:26 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:26 | Val Acc: 0.9737
 Best site-art_painting             (3)  | Epoch:26 | Val Acc: 1.0000
 Best site-art_painting             (3)  | Epoch:26 | Val Acc: 0.9524
 Best site-art_painting             (3)  | Epoch:26 | Val Acc: 0.9225
 Best site-cartoon                  (2)  | Epoch:26 | Val Acc: 0.8696
 Best site-cartoon                  (2)  | Epoch:26 | Val Acc: 0.8870
 Best site-sketch                   (1)  | Epoch:26 | Val Acc: 0.7500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 27 ============
cnt=[3, 1, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (3) | Train Loss: 0.1540 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.1077 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.1065 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.1656 | Train Acc: 0.9673
 Site-photo                     (3) | Train Loss: 0.1659 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.5348 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.3712 | Train Acc: 0.9053
 Site-art_painting              (0) | Train Loss: 0.2840 | Train Acc: 0.9343
 Site-cartoon                   (1) | Train Loss: 0.4605 | Train Acc: 0.8824
 Site-cartoon                   (4) | Train Loss: 0.4401 | Train Acc: 0.8663
 Site-sketch                    (2) | Train Loss: 0.6295 | Train Acc: 0.7851
Average Train Accuracy: 0.9169
 Site-photo                     (3) | Val  Loss: 0.1991 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.2109 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1337 | Val  Acc: 0.9559
 Site-photo                     (3) | Val  Loss: 0.1517 | Val  Acc: 0.9608
 Site-photo                     (3) | Val  Loss: 0.1311 | Val  Acc: 0.9934
 Site-art_painting              (0) | Val  Loss: 0.2479 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.2274 | Val  Acc: 0.9524
 Site-art_painting              (0) | Val  Loss: 0.3333 | Val  Acc: 0.9507
 Site-cartoon                   (1) | Val  Loss: 0.5314 | Val  Acc: 0.8261
 Site-cartoon                   (4) | Val  Loss: 0.4137 | Val  Acc: 0.9043
 Site-sketch                    (2) | Val  Loss: 0.8157 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9224
============ Train epoch 28 ============
cnt=[1, 5, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (1) | Train Loss: 0.1462 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.1520 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.1089 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.1720 | Train Acc: 0.9739
 Site-photo                     (1) | Train Loss: 0.1489 | Train Acc: 0.9694
 Site-art_painting              (3) | Train Loss: 0.4945 | Train Acc: 0.8095
 Site-art_painting              (3) | Train Loss: 0.3333 | Train Acc: 0.9263
 Site-art_painting              (3) | Train Loss: 0.2784 | Train Acc: 0.9249
 Site-cartoon                   (4) | Train Loss: 0.5242 | Train Acc: 0.8235
 Site-cartoon                   (0) | Train Loss: 0.4168 | Train Acc: 0.9012
 Site-sketch                    (2) | Train Loss: 0.5449 | Train Acc: 0.8099
Average Train Accuracy: 0.9161
 Site-photo                     (1) | Val  Loss: 0.2470 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.2535 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1401 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1674 | Val  Acc: 0.9608
 Site-photo                     (1) | Val  Loss: 0.1190 | Val  Acc: 0.9868
 Site-art_painting              (3) | Val  Loss: 0.2454 | Val  Acc: 0.8929
 Site-art_painting              (3) | Val  Loss: 0.2073 | Val  Acc: 0.9683
 Site-art_painting              (3) | Val  Loss: 0.2873 | Val  Acc: 0.9437
 Site-cartoon                   (4) | Val  Loss: 0.4481 | Val  Acc: 0.8696
 Site-cartoon                   (0) | Val  Loss: 0.3769 | Val  Acc: 0.9043
 Site-sketch                    (2) | Val  Loss: 0.8923 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9237
============ Train epoch 29 ============
cnt=[3, 2, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (4) | Train Loss: 0.1383 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.0855 | Train Acc: 0.9706
 Site-photo                     (4) | Train Loss: 0.1194 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.1399 | Train Acc: 0.9608
 Site-photo                     (3) | Train Loss: 0.1585 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.4701 | Train Acc: 0.8095
 Site-art_painting              (0) | Train Loss: 0.4229 | Train Acc: 0.8842
 Site-art_painting              (0) | Train Loss: 0.2858 | Train Acc: 0.9390
 Site-cartoon                   (1) | Train Loss: 0.4410 | Train Acc: 0.9118
 Site-cartoon                   (1) | Train Loss: 0.4171 | Train Acc: 0.9070
 Site-sketch                    (2) | Train Loss: 0.5641 | Train Acc: 0.7686
Average Train Accuracy: 0.9176
 Site-photo                     (4) | Val  Loss: 0.2050 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.2019 | Val  Acc: 0.9556
 Site-photo                     (4) | Val  Loss: 0.1271 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1455 | Val  Acc: 0.9510
 Site-photo                     (3) | Val  Loss: 0.1217 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.2532 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.1980 | Val  Acc: 0.9841
 Site-art_painting              (0) | Val  Loss: 0.4170 | Val  Acc: 0.9296
 Site-cartoon                   (1) | Val  Loss: 0.4166 | Val  Acc: 0.9565
 Site-cartoon                   (1) | Val  Loss: 0.3482 | Val  Acc: 0.9217
 Site-sketch                    (2) | Val  Loss: 0.8319 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9313
 Best site-photo                    (4)  | Epoch:29 | Val Acc: 0.9333
 Best site-photo                    (3)  | Epoch:29 | Val Acc: 0.9556
 Best site-photo                    (4)  | Epoch:29 | Val Acc: 0.9706
 Best site-photo                    (3)  | Epoch:29 | Val Acc: 0.9510
 Best site-photo                    (3)  | Epoch:29 | Val Acc: 0.9868
 Best site-art_painting             (0)  | Epoch:29 | Val Acc: 0.8929
 Best site-art_painting             (0)  | Epoch:29 | Val Acc: 0.9841
 Best site-art_painting             (0)  | Epoch:29 | Val Acc: 0.9296
 Best site-cartoon                  (1)  | Epoch:29 | Val Acc: 0.9565
 Best site-cartoon                  (1)  | Epoch:29 | Val Acc: 0.9217
 Best site-sketch                   (2)  | Epoch:29 | Val Acc: 0.7625
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 30 ============
cnt=[4, 1, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (0) | Train Loss: 0.1474 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.1283 | Train Acc: 0.9559
 Site-photo                     (3) | Train Loss: 0.0912 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.1279 | Train Acc: 0.9739
 Site-photo                     (3) | Train Loss: 0.1583 | Train Acc: 0.9607
 Site-art_painting              (0) | Train Loss: 0.3635 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.3056 | Train Acc: 0.9263
 Site-art_painting              (0) | Train Loss: 0.2557 | Train Acc: 0.9577
 Site-cartoon                   (4) | Train Loss: 0.4796 | Train Acc: 0.8235
 Site-cartoon                   (2) | Train Loss: 0.4086 | Train Acc: 0.9128
 Site-sketch                    (1) | Train Loss: 0.5390 | Train Acc: 0.8182
Average Train Accuracy: 0.9253
 Site-photo                     (0) | Val  Loss: 0.2002 | Val  Acc: 0.9667
 Site-photo                     (3) | Val  Loss: 0.1793 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1211 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1285 | Val  Acc: 0.9608
 Site-photo                     (3) | Val  Loss: 0.1226 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.2272 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.1902 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3351 | Val  Acc: 0.9296
 Site-cartoon                   (4) | Val  Loss: 0.4606 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.3476 | Val  Acc: 0.9217
 Site-sketch                    (1) | Val  Loss: 0.8761 | Val  Acc: 0.6750
Average Valid Accuracy: 0.9273
============ Train epoch 31 ============
cnt=[5, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (0) | Train Loss: 0.1466 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.5620 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.0917 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1449 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1403 | Train Acc: 0.9738
 Site-art_painting              (3) | Train Loss: 0.4232 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.3620 | Train Acc: 0.9053
 Site-art_painting              (3) | Train Loss: 0.2721 | Train Acc: 0.9484
 Site-cartoon                   (1) | Train Loss: 0.5111 | Train Acc: 0.8529
 Site-cartoon                   (4) | Train Loss: 0.3870 | Train Acc: 0.8895
 Site-sketch                    (2) | Train Loss: 0.4893 | Train Acc: 0.8760
Average Train Accuracy: 0.9267
 Site-photo                     (0) | Val  Loss: 0.2609 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2279 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1173 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1433 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1231 | Val  Acc: 0.9803
 Site-art_painting              (3) | Val  Loss: 0.2004 | Val  Acc: 0.9286
 Site-art_painting              (3) | Val  Loss: 0.2667 | Val  Acc: 0.9365
 Site-art_painting              (3) | Val  Loss: 0.3764 | Val  Acc: 0.9366
 Site-cartoon                   (1) | Val  Loss: 0.3894 | Val  Acc: 0.9130
 Site-cartoon                   (4) | Val  Loss: 0.3303 | Val  Acc: 0.9565
 Site-sketch                    (2) | Val  Loss: 0.7260 | Val  Acc: 0.7875
Average Valid Accuracy: 0.9336
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9803
 Best site-art_painting             (3)  | Epoch:31 | Val Acc: 0.9286
 Best site-art_painting             (3)  | Epoch:31 | Val Acc: 0.9365
 Best site-art_painting             (3)  | Epoch:31 | Val Acc: 0.9366
 Best site-cartoon                  (1)  | Epoch:31 | Val Acc: 0.9130
 Best site-cartoon                  (4)  | Epoch:31 | Val Acc: 0.9565
 Best site-sketch                   (2)  | Epoch:31 | Val Acc: 0.7875
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 32 ============
cnt=[3, 1, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (3) | Train Loss: 0.1195 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.4480 | Train Acc: 0.9559
 Site-photo                     (3) | Train Loss: 0.1001 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.1285 | Train Acc: 0.9739
 Site-photo                     (3) | Train Loss: 0.1402 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.4643 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.3377 | Train Acc: 0.9053
 Site-art_painting              (0) | Train Loss: 0.2605 | Train Acc: 0.9202
 Site-cartoon                   (4) | Train Loss: 0.5059 | Train Acc: 0.7941
 Site-cartoon                   (2) | Train Loss: 0.3718 | Train Acc: 0.8953
 Site-sketch                    (1) | Train Loss: 0.5331 | Train Acc: 0.7934
Average Train Accuracy: 0.9119
 Site-photo                     (3) | Val  Loss: 0.1800 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.2347 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.1365 | Val  Acc: 0.9559
 Site-photo                     (3) | Val  Loss: 0.1368 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1222 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.2003 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.1789 | Val  Acc: 0.9841
 Site-art_painting              (0) | Val  Loss: 0.3263 | Val  Acc: 0.9366
 Site-cartoon                   (4) | Val  Loss: 0.4142 | Val  Acc: 0.8696
 Site-cartoon                   (2) | Val  Loss: 0.3415 | Val  Acc: 0.9130
 Site-sketch                    (1) | Val  Loss: 0.8548 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9276
============ Train epoch 33 ============
cnt=[3, 1, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (3) | Train Loss: 0.1939 | Train Acc: 0.9556
 Site-photo                     (3) | Train Loss: 0.1118 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.1043 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.1137 | Train Acc: 0.9739
 Site-photo                     (3) | Train Loss: 0.1514 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.4013 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.2895 | Train Acc: 0.9474
 Site-art_painting              (0) | Train Loss: 0.2558 | Train Acc: 0.9155
 Site-cartoon                   (1) | Train Loss: 0.4337 | Train Acc: 0.8529
 Site-cartoon                   (4) | Train Loss: 0.3878 | Train Acc: 0.9070
 Site-sketch                    (2) | Train Loss: 0.5464 | Train Acc: 0.8017
Average Train Accuracy: 0.9254
 Site-photo                     (3) | Val  Loss: 0.1289 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.1313 | Val  Acc: 0.9778
 Site-photo                     (3) | Val  Loss: 0.0978 | Val  Acc: 0.9559
 Site-photo                     (3) | Val  Loss: 0.1347 | Val  Acc: 0.9608
 Site-photo                     (3) | Val  Loss: 0.0932 | Val  Acc: 0.9934
 Site-art_painting              (0) | Val  Loss: 0.2459 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.2115 | Val  Acc: 0.9683
 Site-art_painting              (0) | Val  Loss: 0.2874 | Val  Acc: 0.9437
 Site-cartoon                   (1) | Val  Loss: 0.4819 | Val  Acc: 0.9130
 Site-cartoon                   (4) | Val  Loss: 0.3412 | Val  Acc: 0.9565
 Site-sketch                    (2) | Val  Loss: 0.7897 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9369
 Best site-photo                    (3)  | Epoch:33 | Val Acc: 0.9333
 Best site-photo                    (3)  | Epoch:33 | Val Acc: 0.9778
 Best site-photo                    (3)  | Epoch:33 | Val Acc: 0.9559
 Best site-photo                    (3)  | Epoch:33 | Val Acc: 0.9608
 Best site-photo                    (3)  | Epoch:33 | Val Acc: 0.9934
 Best site-art_painting             (0)  | Epoch:33 | Val Acc: 0.9286
 Best site-art_painting             (0)  | Epoch:33 | Val Acc: 0.9683
 Best site-art_painting             (0)  | Epoch:33 | Val Acc: 0.9437
 Best site-cartoon                  (1)  | Epoch:33 | Val Acc: 0.9130
 Best site-cartoon                  (4)  | Epoch:33 | Val Acc: 0.9565
 Best site-sketch                   (2)  | Epoch:33 | Val Acc: 0.7750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 34 ============
cnt=[2, 2, 1, 3, 3, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (4) | Train Loss: 0.1773 | Train Acc: 0.9556
 Site-photo                     (4) | Train Loss: 0.1511 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.0840 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.1225 | Train Acc: 0.9739
 Site-photo                     (1) | Train Loss: 0.1465 | Train Acc: 0.9694
 Site-art_painting              (3) | Train Loss: 0.4047 | Train Acc: 0.8571
 Site-art_painting              (3) | Train Loss: 0.3778 | Train Acc: 0.9053
 Site-art_painting              (3) | Train Loss: 0.2253 | Train Acc: 0.9437
 Site-cartoon                   (0) | Train Loss: 0.4314 | Train Acc: 0.8824
 Site-cartoon                   (0) | Train Loss: 0.3589 | Train Acc: 0.9244
 Site-sketch                    (2) | Train Loss: 0.5598 | Train Acc: 0.7769
Average Train Accuracy: 0.9236
 Site-photo                     (4) | Val  Loss: 0.1645 | Val  Acc: 0.9333
 Site-photo                     (4) | Val  Loss: 0.2192 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1166 | Val  Acc: 0.9706
 Site-photo                     (4) | Val  Loss: 0.1172 | Val  Acc: 0.9804
 Site-photo                     (1) | Val  Loss: 0.1142 | Val  Acc: 0.9868
 Site-art_painting              (3) | Val  Loss: 0.2264 | Val  Acc: 0.9286
 Site-art_painting              (3) | Val  Loss: 0.2372 | Val  Acc: 0.9365
 Site-art_painting              (3) | Val  Loss: 0.2552 | Val  Acc: 0.9437
 Site-cartoon                   (0) | Val  Loss: 0.3558 | Val  Acc: 0.9130
 Site-cartoon                   (0) | Val  Loss: 0.3347 | Val  Acc: 0.9043
 Site-sketch                    (2) | Val  Loss: 0.8256 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9287
============ Train epoch 35 ============
cnt=[3, 1, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (3) | Train Loss: 0.1397 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.1619 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.0974 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.1360 | Train Acc: 0.9673
 Site-photo                     (3) | Train Loss: 0.1310 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.3032 | Train Acc: 0.9524
 Site-art_painting              (0) | Train Loss: 0.3515 | Train Acc: 0.9053
 Site-art_painting              (0) | Train Loss: 0.2330 | Train Acc: 0.9343
 Site-cartoon                   (4) | Train Loss: 0.4167 | Train Acc: 0.8824
 Site-cartoon                   (2) | Train Loss: 0.3888 | Train Acc: 0.8953
 Site-sketch                    (1) | Train Loss: 0.4738 | Train Acc: 0.8430
Average Train Accuracy: 0.9353
 Site-photo                     (3) | Val  Loss: 0.1664 | Val  Acc: 0.9667
 Site-photo                     (3) | Val  Loss: 0.1761 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1038 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1527 | Val  Acc: 0.9608
 Site-photo                     (3) | Val  Loss: 0.1122 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.1366 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.1577 | Val  Acc: 0.9841
 Site-art_painting              (0) | Val  Loss: 0.3277 | Val  Acc: 0.9155
 Site-cartoon                   (4) | Val  Loss: 0.3327 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.3286 | Val  Acc: 0.9130
 Site-sketch                    (1) | Val  Loss: 0.6813 | Val  Acc: 0.7375
Average Valid Accuracy: 0.9440
 Best site-photo                    (3)  | Epoch:35 | Val Acc: 0.9667
 Best site-photo                    (3)  | Epoch:35 | Val Acc: 0.9556
 Best site-photo                    (3)  | Epoch:35 | Val Acc: 0.9706
 Best site-photo                    (3)  | Epoch:35 | Val Acc: 0.9608
 Best site-photo                    (3)  | Epoch:35 | Val Acc: 0.9803
 Best site-art_painting             (0)  | Epoch:35 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:35 | Val Acc: 0.9841
 Best site-art_painting             (0)  | Epoch:35 | Val Acc: 0.9155
 Best site-cartoon                  (4)  | Epoch:35 | Val Acc: 1.0000
 Best site-cartoon                  (2)  | Epoch:35 | Val Acc: 0.9130
 Best site-sketch                   (1)  | Epoch:35 | Val Acc: 0.7375
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 36 ============
cnt=[1, 3, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (3) | Train Loss: 0.1627 | Train Acc: 0.9556
 Site-photo                     (3) | Train Loss: 0.1171 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.0985 | Train Acc: 0.9804
 Site-photo                     (3) | Train Loss: 0.1472 | Train Acc: 0.9673
 Site-photo                     (3) | Train Loss: 0.1042 | Train Acc: 0.9869
 Site-art_painting              (1) | Train Loss: 0.3902 | Train Acc: 0.8810
 Site-art_painting              (1) | Train Loss: 0.2978 | Train Acc: 0.9263
 Site-art_painting              (1) | Train Loss: 0.2566 | Train Acc: 0.9155
 Site-cartoon                   (0) | Train Loss: 0.4575 | Train Acc: 0.8824
 Site-cartoon                   (4) | Train Loss: 0.3334 | Train Acc: 0.9360
 Site-sketch                    (2) | Train Loss: 0.5074 | Train Acc: 0.8264
Average Train Accuracy: 0.9312
 Site-photo                     (3) | Val  Loss: 0.1719 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.1811 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1211 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1392 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1036 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.1565 | Val  Acc: 0.9643
 Site-art_painting              (1) | Val  Loss: 0.2016 | Val  Acc: 0.9524
 Site-art_painting              (1) | Val  Loss: 0.2817 | Val  Acc: 0.9225
 Site-cartoon                   (0) | Val  Loss: 0.2983 | Val  Acc: 0.8696
 Site-cartoon                   (4) | Val  Loss: 0.3185 | Val  Acc: 0.9217
 Site-sketch                    (2) | Val  Loss: 0.6479 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9287
============ Train epoch 37 ============
cnt=[1, 3, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (3) | Train Loss: 0.1197 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.1379 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.1025 | Train Acc: 0.9804
 Site-photo                     (3) | Train Loss: 0.1389 | Train Acc: 0.9673
 Site-photo                     (3) | Train Loss: 0.1094 | Train Acc: 0.9782
 Site-art_painting              (1) | Train Loss: 0.4143 | Train Acc: 0.9048
 Site-art_painting              (1) | Train Loss: 0.3057 | Train Acc: 0.9263
 Site-art_painting              (1) | Train Loss: 0.2108 | Train Acc: 0.9671
 Site-cartoon                   (4) | Train Loss: 0.3853 | Train Acc: 0.9118
 Site-cartoon                   (0) | Train Loss: 0.3050 | Train Acc: 0.9535
 Site-sketch                    (2) | Train Loss: 0.4519 | Train Acc: 0.8347
Average Train Accuracy: 0.9429
 Site-photo                     (3) | Val  Loss: 0.1226 | Val  Acc: 0.9667
 Site-photo                     (3) | Val  Loss: 0.1464 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.0986 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1163 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1140 | Val  Acc: 0.9934
 Site-art_painting              (1) | Val  Loss: 0.1669 | Val  Acc: 0.9643
 Site-art_painting              (1) | Val  Loss: 0.1753 | Val  Acc: 0.9841
 Site-art_painting              (1) | Val  Loss: 0.2773 | Val  Acc: 0.9296
 Site-cartoon                   (4) | Val  Loss: 0.4203 | Val  Acc: 0.9565
 Site-cartoon                   (0) | Val  Loss: 0.3083 | Val  Acc: 0.9043
 Site-sketch                    (2) | Val  Loss: 0.7731 | Val  Acc: 0.7875
Average Valid Accuracy: 0.9439
============ Train epoch 38 ============
cnt=[3, 1, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (3) | Train Loss: 0.1461 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.1315 | Train Acc: 0.9559
 Site-photo                     (3) | Train Loss: 0.0818 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.1535 | Train Acc: 0.9673
 Site-photo                     (3) | Train Loss: 0.1071 | Train Acc: 0.9782
 Site-art_painting              (0) | Train Loss: 0.3975 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.2736 | Train Acc: 0.9158
 Site-art_painting              (0) | Train Loss: 0.2138 | Train Acc: 0.9531
 Site-cartoon                   (1) | Train Loss: 0.4135 | Train Acc: 0.8824
 Site-cartoon                   (4) | Train Loss: 0.3590 | Train Acc: 0.9186
 Site-sketch                    (2) | Train Loss: 0.4575 | Train Acc: 0.8512
Average Train Accuracy: 0.9338
 Site-photo                     (3) | Val  Loss: 0.2044 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.1469 | Val  Acc: 0.9778
 Site-photo                     (3) | Val  Loss: 0.0935 | Val  Acc: 0.9853
 Site-photo                     (3) | Val  Loss: 0.1021 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.0994 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.1991 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.2028 | Val  Acc: 0.9683
 Site-art_painting              (0) | Val  Loss: 0.2837 | Val  Acc: 0.9296
 Site-cartoon                   (1) | Val  Loss: 0.3019 | Val  Acc: 0.9565
 Site-cartoon                   (4) | Val  Loss: 0.3082 | Val  Acc: 0.9304
 Site-sketch                    (2) | Val  Loss: 0.8054 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9428
============ Train epoch 39 ============
cnt=[3, 1, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (3) | Train Loss: 0.1134 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.1177 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.0658 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1327 | Train Acc: 0.9804
 Site-photo                     (3) | Train Loss: 0.1210 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.4086 | Train Acc: 0.8571
 Site-art_painting              (0) | Train Loss: 0.2936 | Train Acc: 0.9474
 Site-art_painting              (0) | Train Loss: 0.2096 | Train Acc: 0.9390
 Site-cartoon                   (4) | Train Loss: 0.3915 | Train Acc: 0.9412
 Site-cartoon                   (1) | Train Loss: 0.3188 | Train Acc: 0.9419
 Site-sketch                    (2) | Train Loss: 0.5359 | Train Acc: 0.8264
Average Train Accuracy: 0.9414
 Site-photo                     (3) | Val  Loss: 0.1679 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.1539 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1039 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1204 | Val  Acc: 0.9804
 Site-photo                     (3) | Val  Loss: 0.0922 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.1575 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.1879 | Val  Acc: 0.9683
 Site-art_painting              (0) | Val  Loss: 0.3711 | Val  Acc: 0.9296
 Site-cartoon                   (4) | Val  Loss: 0.3466 | Val  Acc: 0.9565
 Site-cartoon                   (1) | Val  Loss: 0.3051 | Val  Acc: 0.9304
 Site-sketch                    (2) | Val  Loss: 0.7698 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9392
============ Train epoch 40 ============
cnt=[1, 5, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (1) | Train Loss: 0.1091 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.0676 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.0810 | Train Acc: 0.9804
 Site-photo                     (1) | Train Loss: 0.1461 | Train Acc: 0.9673
 Site-photo                     (1) | Train Loss: 0.1178 | Train Acc: 0.9738
 Site-art_painting              (3) | Train Loss: 0.3877 | Train Acc: 0.8810
 Site-art_painting              (3) | Train Loss: 0.2441 | Train Acc: 0.9579
 Site-art_painting              (3) | Train Loss: 0.2229 | Train Acc: 0.9296
 Site-cartoon                   (0) | Train Loss: 0.3968 | Train Acc: 0.9118
 Site-cartoon                   (4) | Train Loss: 0.2997 | Train Acc: 0.9419
 Site-sketch                    (2) | Train Loss: 0.4278 | Train Acc: 0.8843
Average Train Accuracy: 0.9446
 Site-photo                     (1) | Val  Loss: 0.1016 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1529 | Val  Acc: 0.9778
 Site-photo                     (1) | Val  Loss: 0.1032 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1243 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1145 | Val  Acc: 0.9934
 Site-art_painting              (3) | Val  Loss: 0.1951 | Val  Acc: 0.9286
 Site-art_painting              (3) | Val  Loss: 0.2259 | Val  Acc: 0.9206
 Site-art_painting              (3) | Val  Loss: 0.2984 | Val  Acc: 0.9366
 Site-cartoon                   (0) | Val  Loss: 0.2451 | Val  Acc: 0.9565
 Site-cartoon                   (4) | Val  Loss: 0.2862 | Val  Acc: 0.9217
 Site-sketch                    (2) | Val  Loss: 0.7106 | Val  Acc: 0.7875
Average Valid Accuracy: 0.9422
 Test site-photo                     (1)| Epoch:35 | Test Acc: 0.9925
 Test site-art_painting              (3)| Epoch:35 | Test Acc: 0.9074
 Test site-cartoon                   (0)| Epoch:35 | Test Acc: 0.8819
 Test site-sketch                    (2)| Epoch:35 | Test Acc: 0.7986
photo: 0.9925, art_painting: 0.9074, cartoon: 0.8819, sketch: 0.7986, 
Average Test Accuracy(group): 0.8951, Average Test Accuracy(individual): 0.9316,
domain std=0.0692, cluster std=0.0621, individual std=0.0625, 
Average Test Accuracy: 0.8951
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 41 ============
cnt=[1, 5, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-photo                     (1) | Train Loss: 0.1322 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.1470 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.0701 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.1176 | Train Acc: 0.9739
 Site-photo                     (1) | Train Loss: 0.1096 | Train Acc: 0.9738
 Site-art_painting              (3) | Train Loss: 0.3468 | Train Acc: 0.9048
 Site-art_painting              (3) | Train Loss: 0.2497 | Train Acc: 0.9474
 Site-art_painting              (3) | Train Loss: 0.2136 | Train Acc: 0.9343
 Site-cartoon                   (4) | Train Loss: 0.3826 | Train Acc: 0.9412
 Site-cartoon                   (0) | Train Loss: 0.3135 | Train Acc: 0.9186
 Site-sketch                    (2) | Train Loss: 0.4107 | Train Acc: 0.8595
Average Train Accuracy: 0.9447
 Site-photo                     (1) | Val  Loss: 0.1010 | Val  Acc: 0.9667
 Site-photo                     (1) | Val  Loss: 0.1922 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1150 | Val  Acc: 0.9559
 Site-photo                     (1) | Val  Loss: 0.1249 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1257 | Val  Acc: 0.9737
 Site-art_painting              (3) | Val  Loss: 0.2193 | Val  Acc: 0.9286
 Site-art_painting              (3) | Val  Loss: 0.1592 | Val  Acc: 0.9683
 Site-art_painting              (3) | Val  Loss: 0.2391 | Val  Acc: 0.9437
 Site-cartoon                   (4) | Val  Loss: 0.2629 | Val  Acc: 1.0000
 Site-cartoon                   (0) | Val  Loss: 0.2607 | Val  Acc: 0.9565
 Site-sketch                    (2) | Val  Loss: 0.7508 | Val  Acc: 0.7375
Average Valid Accuracy: 0.9415
 Test site-photo                     (1)| Epoch:40 | Test Acc: 0.9925
 Test site-art_painting              (3)| Epoch:40 | Test Acc: 0.9074
 Test site-cartoon                   (4)| Epoch:40 | Test Acc: 0.8766
 Test site-sketch                    (2)| Epoch:40 | Test Acc: 0.8075
photo: 0.9925, art_painting: 0.9074, cartoon: 0.8766, sketch: 0.8075, 
Average Test Accuracy(group): 0.8960, Average Test Accuracy(individual): 0.9314,
domain std=0.0664, cluster std=0.0599, individual std=0.0616, 
Average Test Accuracy: 0.8960
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 42 ============
cnt=[2, 2, 1, 3, 3, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-photo                     (3) | Train Loss: 0.1367 | Train Acc: 0.9556
 Site-photo                     (1) | Train Loss: 0.0683 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.0708 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.0964 | Train Acc: 0.9804
 Site-photo                     (3) | Train Loss: 0.1070 | Train Acc: 0.9782
 Site-art_painting              (4) | Train Loss: 0.3833 | Train Acc: 0.8810
 Site-art_painting              (4) | Train Loss: 0.2084 | Train Acc: 0.9579
 Site-art_painting              (4) | Train Loss: 0.2329 | Train Acc: 0.9202
 Site-cartoon                   (0) | Train Loss: 0.3924 | Train Acc: 0.9118
 Site-cartoon                   (0) | Train Loss: 0.2884 | Train Acc: 0.9302
 Site-sketch                    (2) | Train Loss: 0.4316 | Train Acc: 0.8678
Average Train Accuracy: 0.9417
 Site-photo                     (3) | Val  Loss: 0.1137 | Val  Acc: 0.9667
 Site-photo                     (1) | Val  Loss: 0.1839 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.0998 | Val  Acc: 0.9559
 Site-photo                     (1) | Val  Loss: 0.1278 | Val  Acc: 0.9608
 Site-photo                     (3) | Val  Loss: 0.1126 | Val  Acc: 0.9868
 Site-art_painting              (4) | Val  Loss: 0.2217 | Val  Acc: 0.9286
 Site-art_painting              (4) | Val  Loss: 0.1877 | Val  Acc: 0.9206
 Site-art_painting              (4) | Val  Loss: 0.2997 | Val  Acc: 0.9296
 Site-cartoon                   (0) | Val  Loss: 0.3646 | Val  Acc: 0.9565
 Site-cartoon                   (0) | Val  Loss: 0.2675 | Val  Acc: 0.9391
 Site-sketch                    (2) | Val  Loss: 0.7586 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9341
 Test site-photo                     (3)| Epoch:41 | Test Acc: 0.9925
 Test site-art_painting              (4)| Epoch:41 | Test Acc: 0.9111
 Test site-cartoon                   (0)| Epoch:41 | Test Acc: 0.8904
 Test site-sketch                    (2)| Epoch:41 | Test Acc: 0.8018
photo: 0.9925, art_painting: 0.9111, cartoon: 0.8904, sketch: 0.8018, 
Average Test Accuracy(group): 0.8990, Average Test Accuracy(individual): 0.9344,
domain std=0.0679, cluster std=0.0713, individual std=0.0603, 
Average Test Accuracy: 0.8990
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 43 ============
cnt=[1, 2, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-photo                     (3) | Train Loss: 0.0913 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0672 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.0597 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.0956 | Train Acc: 0.9739
 Site-photo                     (3) | Train Loss: 0.0923 | Train Acc: 0.9869
 Site-art_painting              (0) | Train Loss: 0.3255 | Train Acc: 0.9048
 Site-art_painting              (4) | Train Loss: 0.2662 | Train Acc: 0.8947
 Site-art_painting              (4) | Train Loss: 0.1854 | Train Acc: 0.9577
 Site-cartoon                   (1) | Train Loss: 0.3731 | Train Acc: 0.9118
 Site-cartoon                   (1) | Train Loss: 0.2766 | Train Acc: 0.9477
 Site-sketch                    (2) | Train Loss: 0.4085 | Train Acc: 0.8843
Average Train Accuracy: 0.9475
 Site-photo                     (3) | Val  Loss: 0.1254 | Val  Acc: 0.9667
 Site-photo                     (3) | Val  Loss: 0.1117 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.0948 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.1164 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.0983 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.2213 | Val  Acc: 0.9643
 Site-art_painting              (4) | Val  Loss: 0.1501 | Val  Acc: 0.9683
 Site-art_painting              (4) | Val  Loss: 0.2627 | Val  Acc: 0.9577
 Site-cartoon                   (1) | Val  Loss: 0.2747 | Val  Acc: 1.0000
 Site-cartoon                   (1) | Val  Loss: 0.2545 | Val  Acc: 0.9304
 Site-sketch                    (2) | Val  Loss: 0.7703 | Val  Acc: 0.7375
Average Valid Accuracy: 0.9462
 Best site-photo                    (3)  | Epoch:43 | Val Acc: 0.9667
 Best site-photo                    (3)  | Epoch:43 | Val Acc: 0.9556
 Best site-photo                    (3)  | Epoch:43 | Val Acc: 0.9706
 Best site-photo                    (3)  | Epoch:43 | Val Acc: 0.9706
 Best site-photo                    (3)  | Epoch:43 | Val Acc: 0.9868
 Best site-art_painting             (0)  | Epoch:43 | Val Acc: 0.9643
 Best site-art_painting             (4)  | Epoch:43 | Val Acc: 0.9683
 Best site-art_painting             (4)  | Epoch:43 | Val Acc: 0.9577
 Best site-cartoon                  (1)  | Epoch:43 | Val Acc: 1.0000
 Best site-cartoon                  (1)  | Epoch:43 | Val Acc: 0.9304
 Best site-sketch                   (2)  | Epoch:43 | Val Acc: 0.7375
 Test site-photo                     (3)| Epoch:43 | Test Acc: 0.9925
 Test site-art_painting              (0)| Epoch:43 | Test Acc: 0.9160
 Test site-cartoon                   (1)| Epoch:43 | Test Acc: 0.8979
 Test site-sketch                    (2)| Epoch:43 | Test Acc: 0.8088
photo: 0.9925, art_painting: 0.9160, cartoon: 0.8979, sketch: 0.8088, 
Average Test Accuracy(group): 0.9038, Average Test Accuracy(individual): 0.9377,
domain std=0.0654, cluster std=0.0587, individual std=0.0574, 
Average Test Accuracy: 0.9038
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 44 ============
cnt=[5, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-photo                     (0) | Train Loss: 0.1114 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0803 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1070 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.0917 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1211 | Train Acc: 0.9738
 Site-art_painting              (3) | Train Loss: 0.3070 | Train Acc: 0.9286
 Site-art_painting              (3) | Train Loss: 0.2865 | Train Acc: 0.9053
 Site-art_painting              (3) | Train Loss: 0.2202 | Train Acc: 0.9484
 Site-cartoon                   (2) | Train Loss: 0.3817 | Train Acc: 0.8824
 Site-cartoon                   (4) | Train Loss: 0.2782 | Train Acc: 0.9593
 Site-sketch                    (1) | Train Loss: 0.4730 | Train Acc: 0.8099
Average Train Accuracy: 0.9408
 Site-photo                     (0) | Val  Loss: 0.1974 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.0932 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.0946 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1106 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.1091 | Val  Acc: 0.9868
 Site-art_painting              (3) | Val  Loss: 0.1550 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.1426 | Val  Acc: 0.9841
 Site-art_painting              (3) | Val  Loss: 0.3251 | Val  Acc: 0.9366
 Site-cartoon                   (2) | Val  Loss: 0.2499 | Val  Acc: 1.0000
 Site-cartoon                   (4) | Val  Loss: 0.2534 | Val  Acc: 0.9391
 Site-sketch                    (1) | Val  Loss: 0.5939 | Val  Acc: 0.8250
Average Valid Accuracy: 0.9549
 Best site-photo                    (0)  | Epoch:44 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:44 | Val Acc: 0.9778
 Best site-photo                    (0)  | Epoch:44 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:44 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:44 | Val Acc: 0.9868
 Best site-art_painting             (3)  | Epoch:44 | Val Acc: 1.0000
 Best site-art_painting             (3)  | Epoch:44 | Val Acc: 0.9841
 Best site-art_painting             (3)  | Epoch:44 | Val Acc: 0.9366
 Best site-cartoon                  (2)  | Epoch:44 | Val Acc: 1.0000
 Best site-cartoon                  (4)  | Epoch:44 | Val Acc: 0.9391
 Best site-sketch                   (1)  | Epoch:44 | Val Acc: 0.8250
 Test site-photo                     (0)| Epoch:44 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:44 | Test Acc: 0.9147
 Test site-cartoon                   (2)| Epoch:44 | Test Acc: 0.8936
 Test site-sketch                    (1)| Epoch:44 | Test Acc: 0.8011
photo: 0.9896, art_painting: 0.9147, cartoon: 0.8936, sketch: 0.8011, 
Average Test Accuracy(group): 0.8998, Average Test Accuracy(individual): 0.9346,
domain std=0.0672, cluster std=0.0601, individual std=0.0584, 
Average Test Accuracy: 0.8998
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 45 ============
cnt=[1, 3, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-photo                     (4) | Train Loss: 0.1237 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2493 | Train Acc: 0.9559
 Site-photo                     (1) | Train Loss: 0.0781 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.0756 | Train Acc: 0.9869
 Site-photo                     (4) | Train Loss: 0.1246 | Train Acc: 0.9651
 Site-art_painting              (3) | Train Loss: 0.3299 | Train Acc: 0.9286
 Site-art_painting              (3) | Train Loss: 0.2282 | Train Acc: 0.9789
 Site-art_painting              (3) | Train Loss: 0.1964 | Train Acc: 0.9577
 Site-cartoon                   (2) | Train Loss: 0.2960 | Train Acc: 0.9118
 Site-cartoon                   (2) | Train Loss: 0.2847 | Train Acc: 0.9419
 Site-sketch                    (0) | Train Loss: 0.4187 | Train Acc: 0.8926
Average Train Accuracy: 0.9536
 Site-photo                     (4) | Val  Loss: 0.1858 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.1129 | Val  Acc: 0.9778
 Site-photo                     (1) | Val  Loss: 0.1013 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1153 | Val  Acc: 0.9706
 Site-photo                     (4) | Val  Loss: 0.0920 | Val  Acc: 0.9868
 Site-art_painting              (3) | Val  Loss: 0.2037 | Val  Acc: 0.9286
 Site-art_painting              (3) | Val  Loss: 0.1798 | Val  Acc: 0.9206
 Site-art_painting              (3) | Val  Loss: 0.3106 | Val  Acc: 0.9296
 Site-cartoon                   (2) | Val  Loss: 0.3291 | Val  Acc: 0.9130
 Site-cartoon                   (2) | Val  Loss: 0.2747 | Val  Acc: 0.9565
 Site-sketch                    (0) | Val  Loss: 0.7246 | Val  Acc: 0.7875
Average Valid Accuracy: 0.9341
 Test site-photo                     (4)| Epoch:44 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:44 | Test Acc: 0.9147
 Test site-cartoon                   (2)| Epoch:44 | Test Acc: 0.8883
 Test site-sketch                    (0)| Epoch:44 | Test Acc: 0.7992
photo: 0.9896, art_painting: 0.9147, cartoon: 0.8883, sketch: 0.7992, 
Average Test Accuracy(group): 0.8980, Average Test Accuracy(individual): 0.9334,
domain std=0.0680, cluster std=0.0710, individual std=0.0595, 
Average Test Accuracy: 0.8980
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 46 ============
cnt=[1, 2, 1, 4, 3, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-photo                     (0) | Train Loss: 0.0962 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.0796 | Train Acc: 0.9559
 Site-photo                     (3) | Train Loss: 0.0611 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.0992 | Train Acc: 0.9739
 Site-photo                     (3) | Train Loss: 0.1132 | Train Acc: 0.9694
 Site-art_painting              (4) | Train Loss: 0.2818 | Train Acc: 0.9286
 Site-art_painting              (4) | Train Loss: 0.2670 | Train Acc: 0.9474
 Site-art_painting              (4) | Train Loss: 0.1716 | Train Acc: 0.9484
 Site-cartoon                   (1) | Train Loss: 0.4280 | Train Acc: 0.8529
 Site-cartoon                   (1) | Train Loss: 0.2648 | Train Acc: 0.9244
 Site-sketch                    (2) | Train Loss: 0.4109 | Train Acc: 0.8595
Average Train Accuracy: 0.9389
 Site-photo                     (0) | Val  Loss: 0.1384 | Val  Acc: 0.9667
 Site-photo                     (3) | Val  Loss: 0.0877 | Val  Acc: 0.9778
 Site-photo                     (3) | Val  Loss: 0.0916 | Val  Acc: 0.9706
 Site-photo                     (3) | Val  Loss: 0.0765 | Val  Acc: 0.9804
 Site-photo                     (3) | Val  Loss: 0.1124 | Val  Acc: 0.9737
 Site-art_painting              (4) | Val  Loss: 0.1797 | Val  Acc: 0.9643
 Site-art_painting              (4) | Val  Loss: 0.1505 | Val  Acc: 0.9683
 Site-art_painting              (4) | Val  Loss: 0.2514 | Val  Acc: 0.9507
 Site-cartoon                   (1) | Val  Loss: 0.3007 | Val  Acc: 0.9565
 Site-cartoon                   (1) | Val  Loss: 0.2372 | Val  Acc: 0.9478
 Site-sketch                    (2) | Val  Loss: 0.7938 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9483
 Test site-photo                     (0)| Epoch:45 | Test Acc: 0.9910
 Test site-art_painting              (4)| Epoch:45 | Test Acc: 0.9184
 Test site-cartoon                   (1)| Epoch:45 | Test Acc: 0.8936
 Test site-sketch                    (2)| Epoch:45 | Test Acc: 0.8005
photo: 0.9910, art_painting: 0.9184, cartoon: 0.8936, sketch: 0.8005, 
Average Test Accuracy(group): 0.9009, Average Test Accuracy(individual): 0.9362,
domain std=0.0681, cluster std=0.0708, individual std=0.0588, 
Average Test Accuracy: 0.9009
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 47 ============
cnt=[3, 1, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-photo                     (4) | Train Loss: 0.1134 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1713 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.0701 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1010 | Train Acc: 0.9739
 Site-photo                     (4) | Train Loss: 0.1183 | Train Acc: 0.9738
 Site-art_painting              (3) | Train Loss: 0.3109 | Train Acc: 0.9286
 Site-art_painting              (3) | Train Loss: 0.2444 | Train Acc: 0.9368
 Site-art_painting              (3) | Train Loss: 0.1815 | Train Acc: 0.9577
 Site-cartoon                   (2) | Train Loss: 0.3325 | Train Acc: 0.9412
 Site-cartoon                   (2) | Train Loss: 0.2547 | Train Acc: 0.9477
 Site-sketch                    (1) | Train Loss: 0.4581 | Train Acc: 0.8430
Average Train Accuracy: 0.9488
 Site-photo                     (4) | Val  Loss: 0.1021 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.1342 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.0902 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1255 | Val  Acc: 0.9608
 Site-photo                     (4) | Val  Loss: 0.1050 | Val  Acc: 0.9868
 Site-art_painting              (3) | Val  Loss: 0.1662 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.1279 | Val  Acc: 0.9841
 Site-art_painting              (3) | Val  Loss: 0.1973 | Val  Acc: 0.9648
 Site-cartoon                   (2) | Val  Loss: 0.2911 | Val  Acc: 0.9565
 Site-cartoon                   (2) | Val  Loss: 0.2226 | Val  Acc: 0.9739
 Site-sketch                    (1) | Val  Loss: 0.7005 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9548
 Test site-photo                     (4)| Epoch:46 | Test Acc: 0.9910
 Test site-art_painting              (3)| Epoch:46 | Test Acc: 0.9184
 Test site-cartoon                   (2)| Epoch:46 | Test Acc: 0.8957
 Test site-sketch                    (1)| Epoch:46 | Test Acc: 0.8030
photo: 0.9910, art_painting: 0.9184, cartoon: 0.8957, sketch: 0.8030, 
Average Test Accuracy(group): 0.9021, Average Test Accuracy(individual): 0.9368,
domain std=0.0671, cluster std=0.0698, individual std=0.0580, 
Average Test Accuracy: 0.9021
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 48 ============
cnt=[3, 1, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-photo                     (3) | Train Loss: 0.1185 | Train Acc: 0.9778
 Site-photo                     (3) | Train Loss: 0.0714 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.0568 | Train Acc: 0.9902
 Site-photo                     (3) | Train Loss: 0.0871 | Train Acc: 0.9869
 Site-photo                     (3) | Train Loss: 0.0936 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.3973 | Train Acc: 0.9048
 Site-art_painting              (0) | Train Loss: 0.2395 | Train Acc: 0.9158
 Site-art_painting              (0) | Train Loss: 0.1652 | Train Acc: 0.9577
 Site-cartoon                   (2) | Train Loss: 0.3057 | Train Acc: 0.8824
 Site-cartoon                   (4) | Train Loss: 0.2878 | Train Acc: 0.9244
 Site-sketch                    (1) | Train Loss: 0.4328 | Train Acc: 0.8678
Average Train Accuracy: 0.9424
 Site-photo                     (3) | Val  Loss: 0.0718 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.0480 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.0956 | Val  Acc: 0.9559
 Site-photo                     (3) | Val  Loss: 0.1117 | Val  Acc: 0.9608
 Site-photo                     (3) | Val  Loss: 0.0991 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.1499 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.1310 | Val  Acc: 0.9841
 Site-art_painting              (0) | Val  Loss: 0.2424 | Val  Acc: 0.9296
 Site-cartoon                   (2) | Val  Loss: 0.3167 | Val  Acc: 0.8696
 Site-cartoon                   (4) | Val  Loss: 0.2322 | Val  Acc: 0.9478
 Site-sketch                    (1) | Val  Loss: 0.7033 | Val  Acc: 0.8000
Average Valid Accuracy: 0.9415
 Test site-photo                     (3)| Epoch:47 | Test Acc: 0.9925
 Test site-art_painting              (0)| Epoch:47 | Test Acc: 0.9220
 Test site-cartoon                   (2)| Epoch:47 | Test Acc: 0.8926
 Test site-sketch                    (1)| Epoch:47 | Test Acc: 0.8107
photo: 0.9925, art_painting: 0.9220, cartoon: 0.8926, sketch: 0.8107, 
Average Test Accuracy(group): 0.9045, Average Test Accuracy(individual): 0.9386,
domain std=0.0652, cluster std=0.0585, individual std=0.0572, 
Average Test Accuracy: 0.9045
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
============ Train epoch 49 ============
cnt=[5, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-photo                     (0) | Train Loss: 0.0960 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.3770 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0652 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1021 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.0976 | Train Acc: 0.9694
 Site-art_painting              (3) | Train Loss: 0.4367 | Train Acc: 0.8571
 Site-art_painting              (3) | Train Loss: 0.2269 | Train Acc: 0.9684
 Site-art_painting              (3) | Train Loss: 0.1786 | Train Acc: 0.9671
 Site-cartoon                   (4) | Train Loss: 0.3863 | Train Acc: 0.9118
 Site-cartoon                   (2) | Train Loss: 0.2592 | Train Acc: 0.9535
 Site-sketch                    (1) | Train Loss: 0.3959 | Train Acc: 0.9091
Average Train Accuracy: 0.9508
 Site-photo                     (0) | Val  Loss: 0.1670 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1364 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.0833 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1309 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1007 | Val  Acc: 0.9803
 Site-art_painting              (3) | Val  Loss: 0.1657 | Val  Acc: 0.9643
 Site-art_painting              (3) | Val  Loss: 0.1105 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.2444 | Val  Acc: 0.9577
 Site-cartoon                   (4) | Val  Loss: 0.2378 | Val  Acc: 0.9565
 Site-cartoon                   (2) | Val  Loss: 0.2083 | Val  Acc: 0.9739
 Site-sketch                    (1) | Val  Loss: 0.6751 | Val  Acc: 0.8375
Average Valid Accuracy: 0.9537
 Test site-photo                     (0)| Epoch:48 | Test Acc: 0.9925
 Test site-art_painting              (3)| Epoch:48 | Test Acc: 0.9220
 Test site-cartoon                   (4)| Epoch:48 | Test Acc: 0.8883
 Test site-sketch                    (1)| Epoch:48 | Test Acc: 0.8088
photo: 0.9925, art_painting: 0.9220, cartoon: 0.8883, sketch: 0.8088, 
Average Test Accuracy(group): 0.9029, Average Test Accuracy(individual): 0.9377,
domain std=0.0661, cluster std=0.0594, individual std=0.0582, 
Average Test Accuracy: 0.9029
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_5/ccop_q=1...
===2023-08-10 15:43:25===
===2023-08-10 15:43:40===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 5
Loading snapshots...
 Test site-photo                     (0)| Epoch:49 | Test Acc: 0.9925
 Test site-art_painting              (3)| Epoch:49 | Test Acc: 0.9220
 Test site-cartoon                   (4)| Epoch:49 | Test Acc: 0.8883
 Test site-sketch                    (1)| Epoch:49 | Test Acc: 0.8088
photo: 0.9925, art_painting: 0.9220, cartoon: 0.8883, sketch: 0.8088, 
Average Test Accuracy(group): 0.9029, Average Test Accuracy(individual): 0.9377,
domain std=0.0661, cluster std=0.0594, individual std=0.0582, 
