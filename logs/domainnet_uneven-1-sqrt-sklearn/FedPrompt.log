===2023-03-31 00:55:26===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-2
cnt=[(6,)(2,)(4,)]
 Site-Clipart   | Train Loss: 1.9845 | Train Acc: 0.3492
 Site-Clipart   | Train Loss: 1.9094 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.8515 | Train Acc: 0.4921
 Site-Clipart   | Train Loss: 1.8556 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 2.1381 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.1513 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 2.0158 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.9698 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.9898 | Train Acc: 0.4286
 Site-QuickDraw | Train Loss: 2.3234 | Train Acc: 0.0952
 Site-Real      | Train Loss: 1.8826 | Train Acc: 0.5397
 Site-Sketch    | Train Loss: 1.8880 | Train Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.8806 | Val  Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.8784 | Val  Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.9545 | Val  Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.0017 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0344 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.0874 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.2074 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.8544 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 2.0394 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.2790 | Val  Acc: 0.1190
 Site-Real      | Val  Loss: 1.9946 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 2.0369 | Val  Acc: 0.4048
Average Valid Accuracy: 0.3750
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4286
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4286
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4286
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Painting   | Epoch:0 | Val Acc: 0.4524
 Best site-Painting   | Epoch:0 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1190
 Best site-Real       | Epoch:0 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-sklearn/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-0
cnt=[(6,)(4,)(2,)]
 Site-Clipart   | Train Loss: 1.6097 | Train Acc: 0.5714
 Site-Clipart   | Train Loss: 1.6055 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.5169 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.4720 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 2.0636 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.9579 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.8643 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.4535 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 1.4600 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 2.2335 | Train Acc: 0.1746
 Site-Real      | Train Loss: 1.3859 | Train Acc: 0.7460
 Site-Sketch    | Train Loss: 1.4413 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.4198 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.4523 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.5809 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.5796 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.9561 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 1.9038 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.1121 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.3327 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 1.5943 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 2.2530 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.5089 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.6261 | Val  Acc: 0.5476
Average Valid Accuracy: 0.5516
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:1 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2857
 Best site-Painting   | Epoch:1 | Val Acc: 0.7381
 Best site-Painting   | Epoch:1 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1667
 Best site-Real       | Epoch:1 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5476
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-sklearn/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
client-11 is in G-2
cnt=[(6,)(2,)(4,)]
 Site-Clipart   | Train Loss: 1.2329 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.3455 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.1800 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.0722 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.9728 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.7892 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.7245 | Train Acc: 0.4762
 Site-Painting  | Train Loss: 1.1492 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 1.1183 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 2.1315 | Train Acc: 0.2381
 Site-Real      | Train Loss: 1.0277 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.1772 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 1.1056 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.1168 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.3407 | Val  Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.3148 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7667 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 1.7479 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.0517 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 0.9907 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 1.3036 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 2.1903 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.0881 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.4442 | Val  Acc: 0.6190
Average Valid Accuracy: 0.6250
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6429
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2857
 Best site-Painting   | Epoch:2 | Val Acc: 0.9048
 Best site-Painting   | Epoch:2 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2857
 Best site-Real       | Epoch:2 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-sklearn/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-1
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
cnt=[(6,)(5,)(1,)]
 Site-Clipart   | Train Loss: 0.9811 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.0412 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.9303 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.7880 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.8044 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.5972 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.4677 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.8746 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.8088 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.9398 | Train Acc: 0.3968
 Site-Real      | Train Loss: 0.7607 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.9255 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 0.8458 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.8553 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.1353 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 0.9590 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.6063 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.5077 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7909 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.6901 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.9581 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 2.0010 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.7709 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.1572 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7024
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4762
 Best site-Painting   | Epoch:3 | Val Acc: 0.9286
 Best site-Painting   | Epoch:3 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3810
 Best site-Real       | Epoch:3 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-sklearn/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
client-0 is in G-1
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
cnt=[(6,)(5,)(1,)]
 Site-Clipart   | Train Loss: 0.7128 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.7883 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.6883 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.5240 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.6506 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.4300 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.2711 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.6295 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.5983 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.8254 | Train Acc: 0.3175
 Site-Real      | Train Loss: 0.5458 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.6852 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.5529 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5661 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.9403 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.8098 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.3787 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.3968 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.7173 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.5304 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.7425 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.9413 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.5074 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.9441 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7321
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4524
 Best site-Painting   | Epoch:4 | Val Acc: 0.9048
 Best site-Painting   | Epoch:4 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3095
 Best site-Real       | Epoch:4 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-sklearn/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[(5,)(1,)(6,)]
 Site-Clipart   | Train Loss: 0.5298 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.7276 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.5462 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4261 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.6210 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.3221 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 1.0839 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.5516 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.4641 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.7000 | Train Acc: 0.4286
 Site-Real      | Train Loss: 0.4628 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.6555 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.4979 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5295 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7654 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.6415 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.0843 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.0974 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.6742 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.4502 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.6513 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.7584 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.4773 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8387 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7560
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4286
 Best site-Painting   | Epoch:5 | Val Acc: 0.9286
 Best site-Painting   | Epoch:5 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4286
 Best site-Real       | Epoch:5 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-sklearn/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
cnt=[(8,)(1,)(3,)]
 Site-Clipart   | Train Loss: 0.3402 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.6225 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.3979 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2563 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.4655 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.1473 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 1.0337 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.3911 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.3191 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.4661 | Train Acc: 0.4603
 Site-Real      | Train Loss: 0.3026 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.5263 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.2419 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3255 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.5205 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4427 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.2405 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0349 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.5289 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 0.3627 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.4481 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.5860 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.3347 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.8420 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8036
 Best site-Clipart    | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3810
 Best site-Painting   | Epoch:6 | Val Acc: 0.9524
 Best site-Painting   | Epoch:6 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.4286
 Best site-Real       | Epoch:6 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-sklearn/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
cnt=[(8,)(1,)(3,)]
 Site-Clipart   | Train Loss: 0.2535 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4608 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3679 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2537 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.1947 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 0.8017 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 0.8440 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.2855 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2855 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.3461 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.3972 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.4462 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.2418 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3116 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.4086 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.4375 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.8315 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.7561 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.4384 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.2505 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3297 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.6545 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.3757 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6472 | Val  Acc: 0.7619
Average Valid Accuracy: 0.8254
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4762
 Best site-Painting   | Epoch:7 | Val Acc: 1.0000
 Best site-Painting   | Epoch:7 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.4524
 Best site-Real       | Epoch:7 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-sklearn/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
cnt=[(8,)(1,)(3,)]
 Site-Clipart   | Train Loss: 0.2401 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3112 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2581 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2021 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.1826 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.8978 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.7176 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.1986 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.2763 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.2369 | Train Acc: 0.6190
 Site-Real      | Train Loss: 0.2703 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.4201 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.2051 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2391 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.4038 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.2767 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.7999 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.9063 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.0047 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.1576 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2514 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.4926 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.3046 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6998 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8413
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6667
 Best site-Painting   | Epoch:8 | Val Acc: 1.0000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.4048
 Best site-Real       | Epoch:8 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-sklearn/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
cnt=[(8,)(1,)(3,)]
 Site-Clipart   | Train Loss: 0.2797 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2863 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2141 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2150 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.9638 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.6578 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 0.6146 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.2567 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.1815 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.4558 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.2832 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.3355 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.2125 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.1569 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2939 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2266 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.7156 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.5316 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.8524 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 0.1119 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2701 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.4415 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.3639 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6747 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8730
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7857
 Best site-Painting   | Epoch:9 | Val Acc: 1.0000
 Best site-Painting   | Epoch:9 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.5714
 Best site-Real       | Epoch:9 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:9 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-sklearn/FedPrompt...
===2023-03-31 01:27:48===
===2023-03-31 01:27:49===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8517
 Test site-Infograph | Epoch:9 | Test Acc: 0.5008
 Test site-Painting  | Epoch:9 | Test Acc: 0.8417
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.4330
 Test site-Real      | Epoch:9 | Test Acc: 0.9104
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7888
Average Test Accuracy: 0.7211
