===2023-04-12 14:45:46===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,18,37,56,75,59,32,38,35,]
domain number = 6
============ Train epoch 0 ============
===2023-04-12 14:46:13===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,18,37,56,75,59,32,38,35,]
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
client-0 is in G-2
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-2
client-5 is in G-3
client-6 is in G-2
client-7 is in G-2
client-8 is in G-0
client-9 is in G-3
client-10 is in G-0
client-11 is in G-1
cnt=[2, 1, 4, 5, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 2.1018 | Train Acc: 0.3200
 Site-Clipart   | Train Loss: 2.1607 | Train Acc: 0.2200
 Site-Clipart   | Train Loss: 2.1399 | Train Acc: 0.3467
 Site-Clipart   | Train Loss: 2.1129 | Train Acc: 0.3300
 Site-Infograph | Train Loss: 2.2875 | Train Acc: 0.1111
 Site-Infograph | Train Loss: 2.2949 | Train Acc: 0.1081
 Site-Infograph | Train Loss: 2.2598 | Train Acc: 0.1607
 Site-Infograph | Train Loss: 2.1693 | Train Acc: 0.2133
 Site-Painting  | Train Loss: 2.1984 | Train Acc: 0.2203
 Site-QuickDraw | Train Loss: 2.3676 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.1935 | Train Acc: 0.1842
 Site-Sketch    | Train Loss: 2.1710 | Train Acc: 0.2571
============ Train epoch 2 ============
============ Train epoch 3 ============
client-0 is in G-2
client-1 is in G-0
client-2 is in G-4
client-3 is in G-1
client-4 is in G-0
client-5 is in G-0
client-6 is in G-4
client-7 is in G-0
client-8 is in G-4
client-9 is in G-1
client-10 is in G-3
client-11 is in G-1
cnt=[4, 3, 1, 1, 3, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 2.0526 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.9896 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 1.9520 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.9690 | Train Acc: 0.4400
 Site-Infograph | Train Loss: 2.3907 | Train Acc: 0.1667
 Site-Infograph | Train Loss: 2.2529 | Train Acc: 0.1351
 Site-Infograph | Train Loss: 2.1499 | Train Acc: 0.2321
 Site-Infograph | Train Loss: 2.1571 | Train Acc: 0.2133
 Site-Painting  | Train Loss: 2.1443 | Train Acc: 0.2373
 Site-QuickDraw | Train Loss: 2.3427 | Train Acc: 0.1562
 Site-Real      | Train Loss: 2.0659 | Train Acc: 0.3158
 Site-Sketch    | Train Loss: 2.0047 | Train Acc: 0.3143
 Site-Clipart   | Val  Loss: 1.8738 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.0268 | Val  Acc: 0.4848
 Site-Clipart   | Val  Loss: 2.0013 | Val  Acc: 0.4200
 Site-Clipart   | Val  Loss: 1.9676 | Val  Acc: 0.4627
 Site-Infograph | Val  Loss: 2.0933 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 2.0793 | Val  Acc: 0.4400
 Site-Infograph | Val  Loss: 2.2236 | Val  Acc: 0.2162
 Site-Infograph | Val  Loss: 2.2428 | Val  Acc: 0.1800
 Site-Painting  | Val  Loss: 2.0554 | Val  Acc: 0.3590
 Site-QuickDraw | Val  Loss: 2.2176 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.9898 | Val  Acc: 0.3600
 Site-Sketch    | Val  Loss: 1.9633 | Val  Acc: 0.3913
Average Valid Accuracy: 0.3436
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4848
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4200
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4627
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4400
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2162
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1800
 Best site-Painting   | Epoch:1 | Val Acc: 0.3590
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1429
 Best site-Real       | Epoch:1 | Val Acc: 0.3600
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/Nova...
============ Train epoch 4 ============
============ Train epoch 5 ============
client-0 is in G-0
client-1 is in G-3
client-2 is in G-1
client-3 is in G-3
client-4 is in G-1
client-5 is in G-3
client-6 is in G-1
client-7 is in G-3
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-2
cnt=[4, 3, 1, 4, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.9255 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.8781 | Train Acc: 0.3800
 Site-Clipart   | Train Loss: 1.9060 | Train Acc: 0.4933
 Site-Clipart   | Train Loss: 1.8695 | Train Acc: 0.5300
 Site-Infograph | Train Loss: 2.3521 | Train Acc: 0.1667
 Site-Infograph | Train Loss: 2.1859 | Train Acc: 0.1892
 Site-Infograph | Train Loss: 2.1221 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.0321 | Train Acc: 0.3867
 Site-Painting  | Train Loss: 2.0169 | Train Acc: 0.4068
 Site-QuickDraw | Train Loss: 2.3549 | Train Acc: 0.0312
 Site-Real      | Train Loss: 1.9918 | Train Acc: 0.4737
 Site-Sketch    | Train Loss: 1.8648 | Train Acc: 0.4286
============ Train epoch 6 ============
============ Train epoch 7 ============
client-0 is in G-4
client-1 is in G-3
client-2 is in G-4
client-3 is in G-0
client-4 is in G-3
client-5 is in G-3
client-6 is in G-3
client-7 is in G-4
client-8 is in G-0
client-9 is in G-2
client-10 is in G-0
client-11 is in G-1
cnt=[3, 1, 1, 4, 3, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.8558 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.8079 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.8274 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.7798 | Train Acc: 0.5700
 Site-Infograph | Train Loss: 2.3747 | Train Acc: 0.1667
 Site-Infograph | Train Loss: 2.1419 | Train Acc: 0.1351
 Site-Infograph | Train Loss: 2.0658 | Train Acc: 0.2679
 Site-Infograph | Train Loss: 1.9944 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 1.9298 | Train Acc: 0.3898
 Site-QuickDraw | Train Loss: 2.3013 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.9569 | Train Acc: 0.4737
 Site-Sketch    | Train Loss: 1.6974 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.6102 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.7553 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.6637 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.7711 | Val  Acc: 0.5821
 Site-Infograph | Val  Loss: 2.0085 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.0057 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.0404 | Val  Acc: 0.3514
 Site-Infograph | Val  Loss: 2.1419 | Val  Acc: 0.2400
 Site-Painting  | Val  Loss: 1.7840 | Val  Acc: 0.5641
 Site-QuickDraw | Val  Loss: 2.1675 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.8587 | Val  Acc: 0.4400
 Site-Sketch    | Val  Loss: 1.7881 | Val  Acc: 0.5217
Average Valid Accuracy: 0.4918
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5821
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3514
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2400
 Best site-Painting   | Epoch:3 | Val Acc: 0.5641
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2857
 Best site-Real       | Epoch:3 | Val Acc: 0.4400
 Best site-Sketch     | Epoch:3 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/Nova...
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-5
client-1 is in G-5
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-5
client-6 is in G-4
client-7 is in G-2
client-8 is in G-0
client-9 is in G-2
client-10 is in G-3
client-11 is in G-3
cnt=[1, 2, 3, 2, 1, 3, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.7559 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.5719 | Train Acc: 0.4600
 Site-Clipart   | Train Loss: 1.6971 | Train Acc: 0.6267
 Site-Clipart   | Train Loss: 1.5616 | Train Acc: 0.6500
 Site-Infograph | Train Loss: 2.0843 | Train Acc: 0.2778
 Site-Infograph | Train Loss: 2.0113 | Train Acc: 0.1622
 Site-Infograph | Train Loss: 1.9647 | Train Acc: 0.3393
 Site-Infograph | Train Loss: 1.8874 | Train Acc: 0.4400
 Site-Painting  | Train Loss: 1.8279 | Train Acc: 0.4915
 Site-QuickDraw | Train Loss: 2.3075 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.8058 | Train Acc: 0.5000
 Site-Sketch    | Train Loss: 1.6157 | Train Acc: 0.7429
============ Train epoch 10 ============
============ Train epoch 11 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
cnt=[12, 0, 0, 0, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.5458 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.4959 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 1.5781 | Train Acc: 0.7467
 Site-Clipart   | Train Loss: 1.3812 | Train Acc: 0.7300
 Site-Infograph | Train Loss: 2.0148 | Train Acc: 0.2778
 Site-Infograph | Train Loss: 2.0732 | Train Acc: 0.2432
 Site-Infograph | Train Loss: 1.9141 | Train Acc: 0.3929
 Site-Infograph | Train Loss: 1.8234 | Train Acc: 0.4667
 Site-Painting  | Train Loss: 1.6703 | Train Acc: 0.5424
 Site-QuickDraw | Train Loss: 2.3103 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.6377 | Train Acc: 0.5789
 Site-Sketch    | Train Loss: 1.8281 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.3686 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.4994 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.3514 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.5194 | Val  Acc: 0.7313
 Site-Infograph | Val  Loss: 1.7939 | Val  Acc: 0.5833
 Site-Infograph | Val  Loss: 1.7797 | Val  Acc: 0.6400
 Site-Infograph | Val  Loss: 1.9229 | Val  Acc: 0.3784
 Site-Infograph | Val  Loss: 1.9709 | Val  Acc: 0.3800
 Site-Painting  | Val  Loss: 1.5885 | Val  Acc: 0.5641
 Site-QuickDraw | Val  Loss: 2.1343 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.6744 | Val  Acc: 0.5600
 Site-Sketch    | Val  Loss: 1.5747 | Val  Acc: 0.6522
Average Valid Accuracy: 0.5923
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7313
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5833
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6400
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3784
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3800
 Best site-Painting   | Epoch:5 | Val Acc: 0.5641
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2381
 Best site-Real       | Epoch:5 | Val Acc: 0.5600
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/Nova...
============ Train epoch 12 ============
============ Train epoch 13 ============
client-0 is in G-1
client-1 is in G-4
client-2 is in G-5
client-3 is in G-3
client-4 is in G-2
client-5 is in G-5
client-6 is in G-4
client-7 is in G-5
client-8 is in G-0
client-9 is in G-2
client-10 is in G-4
client-11 is in G-2
cnt=[1, 1, 3, 1, 3, 3, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.4349 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.5132 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.4272 | Train Acc: 0.7333
 Site-Clipart   | Train Loss: 1.3350 | Train Acc: 0.8200
 Site-Infograph | Train Loss: 1.7028 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.9940 | Train Acc: 0.3243
 Site-Infograph | Train Loss: 1.9663 | Train Acc: 0.3750
 Site-Infograph | Train Loss: 1.7606 | Train Acc: 0.5067
 Site-Painting  | Train Loss: 1.6242 | Train Acc: 0.6610
 Site-QuickDraw | Train Loss: 2.3032 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.5514 | Train Acc: 0.6842
 Site-Sketch    | Train Loss: 1.3424 | Train Acc: 0.6857
============ Train epoch 14 ============
============ Train epoch 15 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-1
client-3 is in G-2
client-4 is in G-4
client-5 is in G-0
client-6 is in G-5
client-7 is in G-1
client-8 is in G-0
client-9 is in G-4
client-10 is in G-4
client-11 is in G-3
cnt=[2, 2, 3, 1, 3, 1, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.3686 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2777 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 1.3419 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.2104 | Train Acc: 0.7800
 Site-Infograph | Train Loss: 2.2898 | Train Acc: 0.2778
 Site-Infograph | Train Loss: 2.0094 | Train Acc: 0.2973
 Site-Infograph | Train Loss: 1.8573 | Train Acc: 0.4107
 Site-Infograph | Train Loss: 1.6984 | Train Acc: 0.4800
 Site-Painting  | Train Loss: 1.5283 | Train Acc: 0.6780
 Site-QuickDraw | Train Loss: 2.2951 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.4106 | Train Acc: 0.7105
 Site-Sketch    | Train Loss: 1.5347 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.1158 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.3264 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.0928 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.3147 | Val  Acc: 0.7910
 Site-Infograph | Val  Loss: 1.6551 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.6863 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.7655 | Val  Acc: 0.4595
 Site-Infograph | Val  Loss: 1.8553 | Val  Acc: 0.4600
 Site-Painting  | Val  Loss: 1.3397 | Val  Acc: 0.7436
 Site-QuickDraw | Val  Loss: 2.0508 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.4211 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.4537 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6502
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7910
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4595
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4600
 Best site-Painting   | Epoch:7 | Val Acc: 0.7436
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2857
 Best site-Real       | Epoch:7 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:7 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/Nova...
============ Train epoch 16 ============
============ Train epoch 17 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-0
client-3 is in G-4
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-3
client-8 is in G-0
client-9 is in G-3
client-10 is in G-4
client-11 is in G-0
cnt=[3, 1, 4, 2, 2, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.3608 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.2460 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.2075 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0777 | Train Acc: 0.8200
 Site-Infograph | Train Loss: 2.1007 | Train Acc: 0.2778
 Site-Infograph | Train Loss: 2.0282 | Train Acc: 0.2973
 Site-Infograph | Train Loss: 1.8024 | Train Acc: 0.4464
 Site-Infograph | Train Loss: 1.6437 | Train Acc: 0.5600
 Site-Painting  | Train Loss: 1.4088 | Train Acc: 0.6949
 Site-QuickDraw | Train Loss: 2.3290 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.3005 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.2885 | Train Acc: 0.7714
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-3
client-3 is in G-1
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-2
client-10 is in G-3
client-11 is in G-4
cnt=[3, 2, 4, 2, 1, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.2050 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.4084 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.1669 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.0117 | Train Acc: 0.8600
 Site-Infograph | Train Loss: 1.9460 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.8998 | Train Acc: 0.2973
 Site-Infograph | Train Loss: 1.7520 | Train Acc: 0.4643
 Site-Infograph | Train Loss: 1.5978 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 1.3106 | Train Acc: 0.7458
 Site-QuickDraw | Train Loss: 2.2727 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.3402 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.2037 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 1.0113 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.9744 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.9037 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.1810 | Val  Acc: 0.7463
 Site-Infograph | Val  Loss: 1.5984 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.5546 | Val  Acc: 0.5600
 Site-Infograph | Val  Loss: 1.6427 | Val  Acc: 0.5676
 Site-Infograph | Val  Loss: 1.7897 | Val  Acc: 0.4600
 Site-Painting  | Val  Loss: 1.1530 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 2.0359 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.2649 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.4644 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6828
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7463
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5600
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5676
 Best site-Infograph  | Epoch:9 | Val Acc: 0.4600
 Best site-Painting   | Epoch:9 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.2857
 Best site-Real       | Epoch:9 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:9 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/Nova...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.7205
 Test site-Infograph | Epoch:9 | Test Acc: 0.3866
 Test site-Painting  | Epoch:9 | Test Acc: 0.7124
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.2590
 Test site-Real      | Epoch:9 | Test Acc: 0.7995
 Test site-Sketch    | Epoch:9 | Test Acc: 0.6697
Average Test Accuracy: 0.5913
============ Train epoch 20 ============
============ Train epoch 21 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-1
client-3 is in G-3
client-4 is in G-4
client-5 is in G-3
client-6 is in G-5
client-7 is in G-4
client-8 is in G-5
client-9 is in G-5
client-10 is in G-2
client-11 is in G-1
cnt=[0, 2, 2, 3, 2, 3, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.0354 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 1.1847 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.1504 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.9388 | Train Acc: 0.8400
 Site-Infograph | Train Loss: 2.1108 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.8872 | Train Acc: 0.3514
 Site-Infograph | Train Loss: 1.7670 | Train Acc: 0.4464
 Site-Infograph | Train Loss: 1.5551 | Train Acc: 0.5867
 Site-Painting  | Train Loss: 1.2888 | Train Acc: 0.7966
 Site-QuickDraw | Train Loss: 2.3379 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.1039 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 1.2425 | Train Acc: 0.8000
============ Train epoch 22 ============
============ Train epoch 23 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-4
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-4
client-8 is in G-0
client-9 is in G-0
client-10 is in G-4
client-11 is in G-1
cnt=[5, 1, 2, 1, 3, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.0183 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.1853 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.0614 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8800 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.6806 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.9217 | Train Acc: 0.3784
 Site-Infograph | Train Loss: 1.6673 | Train Acc: 0.5536
 Site-Infograph | Train Loss: 1.5154 | Train Acc: 0.5867
 Site-Painting  | Train Loss: 1.2462 | Train Acc: 0.7458
 Site-QuickDraw | Train Loss: 2.2862 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.0225 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.0338 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.8627 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.0086 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.8378 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 1.0120 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 1.5479 | Val  Acc: 0.5833
 Site-Infograph | Val  Loss: 1.5674 | Val  Acc: 0.6400
 Site-Infograph | Val  Loss: 1.6159 | Val  Acc: 0.5676
 Site-Infograph | Val  Loss: 1.7139 | Val  Acc: 0.5200
 Site-Painting  | Val  Loss: 1.0661 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 2.0295 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.1443 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.3939 | Val  Acc: 0.5217
Average Valid Accuracy: 0.6706
============ Train epoch 24 ============
============ Train epoch 25 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-3
client-3 is in G-1
client-4 is in G-0
client-5 is in G-3
client-6 is in G-2
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-2
client-11 is in G-0
cnt=[4, 3, 2, 3, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.9350 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 1.1447 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.9700 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 0.7961 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8394 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.8964 | Train Acc: 0.4324
 Site-Infograph | Train Loss: 1.5717 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.4563 | Train Acc: 0.5733
 Site-Painting  | Train Loss: 1.1563 | Train Acc: 0.7458
 Site-QuickDraw | Train Loss: 2.2812 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.0990 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 0.8980 | Train Acc: 0.8571
============ Train epoch 26 ============
============ Train epoch 27 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
cnt=[12, 0, 0, 0, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.9449 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8995 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 0.9520 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.7442 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.9417 | Train Acc: 0.2778
 Site-Infograph | Train Loss: 1.8916 | Train Acc: 0.2973
 Site-Infograph | Train Loss: 1.6796 | Train Acc: 0.5179
 Site-Infograph | Train Loss: 1.4090 | Train Acc: 0.6533
 Site-Painting  | Train Loss: 1.0501 | Train Acc: 0.7797
 Site-QuickDraw | Train Loss: 2.3281 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.9638 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.8156 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.8068 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7311 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.7484 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.9098 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 1.3672 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.4161 | Val  Acc: 0.6800
 Site-Infograph | Val  Loss: 1.4876 | Val  Acc: 0.5676
 Site-Infograph | Val  Loss: 1.6037 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.9926 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.9978 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.0350 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.2511 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7206
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8600
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8507
 Best site-Infograph  | Epoch:13 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:13 | Val Acc: 0.6800
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5676
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5000
 Best site-Painting   | Epoch:13 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.2857
 Best site-Real       | Epoch:13 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:13 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/Nova...
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-2
client-3 is in G-4
client-4 is in G-1
client-5 is in G-1
client-6 is in G-0
client-7 is in G-3
client-8 is in G-0
client-9 is in G-4
client-10 is in G-0
client-11 is in G-2
cnt=[3, 4, 2, 1, 2, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.8430 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 1.0481 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 0.8756 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7711 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 2.1219 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.8997 | Train Acc: 0.3784
 Site-Infograph | Train Loss: 1.5351 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.3758 | Train Acc: 0.6267
 Site-Painting  | Train Loss: 1.0329 | Train Acc: 0.7797
 Site-QuickDraw | Train Loss: 2.2956 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.9979 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.0681 | Train Acc: 0.8000
============ Train epoch 30 ============
============ Train epoch 31 ============
client-0 is in G-2
client-1 is in G-1
client-2 is in G-3
client-3 is in G-3
client-4 is in G-4
client-5 is in G-1
client-6 is in G-1
client-7 is in G-2
client-8 is in G-0
client-9 is in G-3
client-10 is in G-5
client-11 is in G-2
cnt=[1, 3, 3, 3, 1, 1, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.8312 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8927 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.8420 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.6557 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 2.2259 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.7652 | Train Acc: 0.3784
 Site-Infograph | Train Loss: 1.6304 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 1.4176 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 0.9528 | Train Acc: 0.8136
 Site-QuickDraw | Train Loss: 2.2581 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.9967 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.8527 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7250 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.6142 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6172 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.8457 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 1.2787 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.3001 | Val  Acc: 0.7200
 Site-Infograph | Val  Loss: 1.5460 | Val  Acc: 0.5676
 Site-Infograph | Val  Loss: 1.5619 | Val  Acc: 0.5400
 Site-Painting  | Val  Loss: 0.9279 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.9977 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.9868 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.2805 | Val  Acc: 0.4783
Average Valid Accuracy: 0.7124
============ Train epoch 32 ============
============ Train epoch 33 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-1
client-5 is in G-0
client-6 is in G-3
client-7 is in G-0
client-8 is in G-0
client-9 is in G-4
client-10 is in G-0
client-11 is in G-2
cnt=[4, 1, 4, 2, 1, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.8071 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.8494 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.8222 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.6099 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 2.1056 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.8793 | Train Acc: 0.3243
 Site-Infograph | Train Loss: 1.4963 | Train Acc: 0.5179
 Site-Infograph | Train Loss: 1.3438 | Train Acc: 0.5867
 Site-Painting  | Train Loss: 0.9174 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 2.2433 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.7728 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.0049 | Train Acc: 0.8571
============ Train epoch 34 ============
============ Train epoch 35 ============
client-0 is in G-4
client-1 is in G-0
client-2 is in G-3
client-3 is in G-2
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-2
client-8 is in G-0
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[2, 2, 4, 2, 2, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.7592 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.9423 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7994 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6059 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 2.0672 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.8451 | Train Acc: 0.3784
 Site-Infograph | Train Loss: 1.4376 | Train Acc: 0.5357
 Site-Infograph | Train Loss: 1.3186 | Train Acc: 0.6400
 Site-Painting  | Train Loss: 0.9655 | Train Acc: 0.7797
 Site-QuickDraw | Train Loss: 2.2355 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.6979 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.9382 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.6522 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6947 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.6254 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.7683 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.3670 | Val  Acc: 0.5833
 Site-Infograph | Val  Loss: 1.3442 | Val  Acc: 0.6800
 Site-Infograph | Val  Loss: 1.3811 | Val  Acc: 0.6486
 Site-Infograph | Val  Loss: 1.4795 | Val  Acc: 0.5400
 Site-Painting  | Val  Loss: 0.8873 | Val  Acc: 0.7436
 Site-QuickDraw | Val  Loss: 1.9729 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.8789 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.1679 | Val  Acc: 0.5652
Average Valid Accuracy: 0.7221
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:17 | Val Acc: 0.5833
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6800
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6486
 Best site-Infograph  | Epoch:17 | Val Acc: 0.5400
 Best site-Painting   | Epoch:17 | Val Acc: 0.7436
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.3810
 Best site-Real       | Epoch:17 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:17 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/Nova...
============ Train epoch 36 ============
============ Train epoch 37 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
cnt=[12, 0, 0, 0, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.7647 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7977 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7279 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6341 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 2.2235 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.6982 | Train Acc: 0.4054
 Site-Infograph | Train Loss: 1.4351 | Train Acc: 0.5357
 Site-Infograph | Train Loss: 1.2738 | Train Acc: 0.5867
 Site-Painting  | Train Loss: 0.8568 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 2.2233 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.7724 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.9969 | Train Acc: 0.8571
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-5
client-1 is in G-0
client-2 is in G-2
client-3 is in G-4
client-4 is in G-5
client-5 is in G-4
client-6 is in G-0
client-7 is in G-3
client-8 is in G-0
client-9 is in G-2
client-10 is in G-5
client-11 is in G-1
cnt=[3, 1, 2, 1, 2, 3, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.6864 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7915 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.6776 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5478 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 1.2415 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.9240 | Train Acc: 0.4054
 Site-Infograph | Train Loss: 1.4333 | Train Acc: 0.5357
 Site-Infograph | Train Loss: 1.2749 | Train Acc: 0.6933
 Site-Painting  | Train Loss: 0.8603 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 2.1852 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.7562 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.8925 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.4923 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6309 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5335 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.6782 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 1.1328 | Val  Acc: 0.5833
 Site-Infograph | Val  Loss: 1.2707 | Val  Acc: 0.6800
 Site-Infograph | Val  Loss: 1.3679 | Val  Acc: 0.6216
 Site-Infograph | Val  Loss: 1.4540 | Val  Acc: 0.5400
 Site-Painting  | Val  Loss: 0.8197 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.9345 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.8208 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.0839 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7273
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:19 | Val Acc: 0.8657
 Best site-Infograph  | Epoch:19 | Val Acc: 0.5833
 Best site-Infograph  | Epoch:19 | Val Acc: 0.6800
 Best site-Infograph  | Epoch:19 | Val Acc: 0.6216
 Best site-Infograph  | Epoch:19 | Val Acc: 0.5400
 Best site-Painting   | Epoch:19 | Val Acc: 0.7949
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.3333
 Best site-Real       | Epoch:19 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:19 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/Nova...
 Test site-Clipart   | Epoch:19 | Test Acc: 0.8213
 Test site-Infograph | Epoch:19 | Test Acc: 0.4521
 Test site-Painting  | Epoch:19 | Test Acc: 0.8174
 Test site-QuickDraw | Epoch:19 | Test Acc: 0.3080
 Test site-Real      | Epoch:19 | Test Acc: 0.8776
 Test site-Sketch    | Epoch:19 | Test Acc: 0.7401
Average Test Accuracy: 0.6694
============ Train epoch 40 ============
============ Train epoch 41 ============
client-0 is in G-3
client-1 is in G-1
client-2 is in G-3
client-3 is in G-3
client-4 is in G-1
client-5 is in G-5
client-6 is in G-5
client-7 is in G-4
client-8 is in G-0
client-9 is in G-3
client-10 is in G-1
client-11 is in G-4
cnt=[1, 3, 0, 4, 2, 2, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.6461 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.9320 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7052 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4753 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.6201 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.6780 | Train Acc: 0.4054
 Site-Infograph | Train Loss: 1.4539 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.2862 | Train Acc: 0.6267
 Site-Painting  | Train Loss: 0.7914 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 2.2535 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.7193 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.6376 | Train Acc: 0.8857
============ Train epoch 42 ============
============ Train epoch 43 ============
client-0 is in G-2
client-1 is in G-0
client-2 is in G-5
client-3 is in G-2
client-4 is in G-3
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-1
cnt=[3, 2, 2, 3, 1, 1, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.6343 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9488 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.6238 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.4808 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.4573 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.6062 | Train Acc: 0.4865
 Site-Infograph | Train Loss: 1.4257 | Train Acc: 0.5893
 Site-Infograph | Train Loss: 1.2216 | Train Acc: 0.6800
 Site-Painting  | Train Loss: 0.7644 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 2.1792 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.6865 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.7572 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5338 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5566 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4906 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.6818 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 1.1113 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.3144 | Val  Acc: 0.6800
 Site-Infograph | Val  Loss: 1.2750 | Val  Acc: 0.7297
 Site-Infograph | Val  Loss: 1.3266 | Val  Acc: 0.5200
 Site-Painting  | Val  Loss: 0.6893 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.8312 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.7546 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.0670 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7603
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8955
 Best site-Infograph  | Epoch:21 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6800
 Best site-Infograph  | Epoch:21 | Val Acc: 0.7297
 Best site-Infograph  | Epoch:21 | Val Acc: 0.5200
 Best site-Painting   | Epoch:21 | Val Acc: 0.8974
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.3333
 Best site-Real       | Epoch:21 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:21 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/Nova...
============ Train epoch 44 ============
============ Train epoch 45 ============
client-0 is in G-2
client-1 is in G-4
client-2 is in G-4
client-3 is in G-2
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-3
client-8 is in G-0
client-9 is in G-1
client-10 is in G-2
client-11 is in G-3
cnt=[1, 2, 4, 2, 3, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.5517 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.6752 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6444 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4345 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 2.2936 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 1.6515 | Train Acc: 0.4054
 Site-Infograph | Train Loss: 1.4471 | Train Acc: 0.6250
 Site-Infograph | Train Loss: 1.1642 | Train Acc: 0.7200
 Site-Painting  | Train Loss: 0.8088 | Train Acc: 0.8136
 Site-QuickDraw | Train Loss: 2.2023 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.7408 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.6156 | Train Acc: 0.8000
============ Train epoch 46 ============
============ Train epoch 47 ============
client-0 is in G-3
client-1 is in G-3
client-2 is in G-2
client-3 is in G-0
client-4 is in G-2
client-5 is in G-0
client-6 is in G-3
client-7 is in G-1
client-8 is in G-0
client-9 is in G-2
client-10 is in G-3
client-11 is in G-1
cnt=[3, 2, 3, 4, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.6290 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.5418 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6092 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4837 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.5577 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.7758 | Train Acc: 0.4865
 Site-Infograph | Train Loss: 1.3198 | Train Acc: 0.6429
 Site-Infograph | Train Loss: 1.1567 | Train Acc: 0.6533
 Site-Painting  | Train Loss: 0.7638 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 2.1766 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.5655 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8545 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.5029 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.4103 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4368 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.6390 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 1.1981 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2358 | Val  Acc: 0.6800
 Site-Infograph | Val  Loss: 1.3175 | Val  Acc: 0.6216
 Site-Infograph | Val  Loss: 1.3482 | Val  Acc: 0.6800
 Site-Painting  | Val  Loss: 0.7472 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.9068 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.7847 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.0795 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7550
============ Train epoch 48 ============
============ Train epoch 49 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-1
client-3 is in G-2
client-4 is in G-1
client-5 is in G-2
client-6 is in G-5
client-7 is in G-3
client-8 is in G-0
client-9 is in G-5
client-10 is in G-2
client-11 is in G-3
cnt=[1, 3, 4, 2, 0, 2, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.6940 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6690 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6392 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4129 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.5546 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.8143 | Train Acc: 0.5135
 Site-Infograph | Train Loss: 1.2666 | Train Acc: 0.6964
 Site-Infograph | Train Loss: 1.1508 | Train Acc: 0.6533
 Site-Painting  | Train Loss: 0.6914 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 2.1431 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.6002 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8059 | Train Acc: 0.8857
============ Train epoch 50 ============
============ Train epoch 51 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
cnt=[12, 0, 0, 0, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.5861 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7217 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.5525 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.4115 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.6972 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.6019 | Train Acc: 0.3784
 Site-Infograph | Train Loss: 1.2752 | Train Acc: 0.6786
 Site-Infograph | Train Loss: 1.1188 | Train Acc: 0.6933
 Site-Painting  | Train Loss: 0.7257 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.1547 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5675 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.7021 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.4848 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.4117 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3616 | Val  Acc: 0.9400
 Site-Clipart   | Val  Loss: 0.5735 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 1.0928 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.0729 | Val  Acc: 0.7600
 Site-Infograph | Val  Loss: 1.2165 | Val  Acc: 0.6486
 Site-Infograph | Val  Loss: 1.2975 | Val  Acc: 0.5600
 Site-Painting  | Val  Loss: 0.7659 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.9402 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.6761 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 0.9990 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7570
============ Train epoch 52 ============
============ Train epoch 53 ============
client-0 is in G-4
client-1 is in G-1
client-2 is in G-3
client-3 is in G-4
client-4 is in G-4
client-5 is in G-5
client-6 is in G-0
client-7 is in G-3
client-8 is in G-0
client-9 is in G-1
client-10 is in G-1
client-11 is in G-2
cnt=[2, 3, 1, 2, 3, 1, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.4718 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6876 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5558 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.3845 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.8210 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.4604 | Train Acc: 0.4595
 Site-Infograph | Train Loss: 1.3213 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.1332 | Train Acc: 0.6800
 Site-Painting  | Train Loss: 0.6423 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 2.0847 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.6790 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.6538 | Train Acc: 0.8000
============ Train epoch 54 ============
============ Train epoch 55 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-3
client-3 is in G-5
client-4 is in G-2
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-0
client-9 is in G-4
client-10 is in G-1
client-11 is in G-1
cnt=[2, 3, 4, 1, 1, 1, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.5902 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8919 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.6045 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.3542 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 2.0942 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.5963 | Train Acc: 0.4595
 Site-Infograph | Train Loss: 1.3452 | Train Acc: 0.6071
 Site-Infograph | Train Loss: 1.1271 | Train Acc: 0.7200
 Site-Painting  | Train Loss: 0.6568 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 2.1309 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.5672 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.6513 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.4489 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.4506 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4061 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.5346 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 0.9847 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.1965 | Val  Acc: 0.7600
 Site-Infograph | Val  Loss: 1.1688 | Val  Acc: 0.7027
 Site-Infograph | Val  Loss: 1.1508 | Val  Acc: 0.6800
 Site-Painting  | Val  Loss: 0.6488 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.9230 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.6042 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.0806 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7798
 Best site-Clipart    | Epoch:27 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:27 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9104
 Best site-Infograph  | Epoch:27 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:27 | Val Acc: 0.7600
 Best site-Infograph  | Epoch:27 | Val Acc: 0.7027
 Best site-Infograph  | Epoch:27 | Val Acc: 0.6800
 Best site-Painting   | Epoch:27 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.3333
 Best site-Real       | Epoch:27 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:27 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/Nova...
============ Train epoch 56 ============
============ Train epoch 57 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
cnt=[12, 0, 0, 0, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.5617 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6835 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5072 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.4024 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 2.0781 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.7609 | Train Acc: 0.4324
 Site-Infograph | Train Loss: 1.1803 | Train Acc: 0.6786
 Site-Infograph | Train Loss: 1.0503 | Train Acc: 0.7467
 Site-Painting  | Train Loss: 0.6976 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.0607 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.4841 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.9363 | Train Acc: 0.8571
============ Train epoch 58 ============
============ Train epoch 59 ============
client-0 is in G-2
client-1 is in G-3
client-2 is in G-4
client-3 is in G-2
client-4 is in G-4
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-1
client-10 is in G-0
client-11 is in G-2
cnt=[4, 1, 4, 1, 2, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.5824 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6305 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4761 | Train Acc: 0.9467
 Site-Clipart   | Train Loss: 0.4251 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.7184 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.6760 | Train Acc: 0.5135
 Site-Infograph | Train Loss: 1.2550 | Train Acc: 0.6250
 Site-Infograph | Train Loss: 1.0613 | Train Acc: 0.7333
 Site-Painting  | Train Loss: 0.6674 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 2.1147 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.5726 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.5768 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4310 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.4050 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4197 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.5243 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 1.0156 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.0134 | Val  Acc: 0.7600
 Site-Infograph | Val  Loss: 1.2554 | Val  Acc: 0.7568
 Site-Infograph | Val  Loss: 1.1347 | Val  Acc: 0.6400
 Site-Painting  | Val  Loss: 0.5938 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.8232 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.6244 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.9601 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7782
===2023-04-12 15:23:42===
===2023-04-12 15:23:43===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,18,37,56,75,59,32,38,35,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:27 | Test Acc: 0.8346
 Test site-Infograph | Epoch:27 | Test Acc: 0.4855
 Test site-Painting  | Epoch:27 | Test Acc: 0.8336
 Test site-QuickDraw | Epoch:27 | Test Acc: 0.3350
 Test site-Real      | Epoch:27 | Test Acc: 0.8989
 Test site-Sketch    | Epoch:27 | Test Acc: 0.7780
Average Test Accuracy: 0.6943
===2023-04-12 16:15:56===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,18,37,56,75,39,32,38,35,]
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
client-0 is in G-5
client-1 is in G-3
client-2 is in G-2
client-3 is in G-0
client-4 is in G-2
client-5 is in G-1
client-6 is in G-4
client-7 is in G-4
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
cnt=[2, 1, 3, 3, 2, 1, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 2.1295 | Train Acc: 0.2400
 Site-Clipart   | Train Loss: 2.2206 | Train Acc: 0.1800
 Site-Clipart   | Train Loss: 2.1066 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.1731 | Train Acc: 0.3300
 Site-Infograph | Train Loss: 2.3264 | Train Acc: 0.1111
 Site-Infograph | Train Loss: 2.3169 | Train Acc: 0.0811
 Site-Infograph | Train Loss: 2.2336 | Train Acc: 0.1964
 Site-Infograph | Train Loss: 2.1412 | Train Acc: 0.2667
 Site-Painting  | Train Loss: 2.3127 | Train Acc: 0.2564
 Site-QuickDraw | Train Loss: 2.4185 | Train Acc: 0.0312
 Site-Real      | Train Loss: 2.2279 | Train Acc: 0.1842
 Site-Sketch    | Train Loss: 2.2575 | Train Acc: 0.2286
============ Train epoch 2 ============
============ Train epoch 3 ============
client-0 is in G-5
client-1 is in G-1
client-2 is in G-3
client-3 is in G-2
client-4 is in G-2
client-5 is in G-0
client-6 is in G-4
client-7 is in G-4
client-8 is in G-0
client-9 is in G-1
client-10 is in G-4
client-11 is in G-5
cnt=[2, 2, 2, 1, 3, 2, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.9972 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.1348 | Train Acc: 0.2600
 Site-Clipart   | Train Loss: 2.0024 | Train Acc: 0.3867
 Site-Clipart   | Train Loss: 2.0055 | Train Acc: 0.3800
 Site-Infograph | Train Loss: 2.1467 | Train Acc: 0.1111
 Site-Infograph | Train Loss: 2.2224 | Train Acc: 0.1622
 Site-Infograph | Train Loss: 2.1640 | Train Acc: 0.3036
 Site-Infograph | Train Loss: 2.1166 | Train Acc: 0.3200
 Site-Painting  | Train Loss: 2.1035 | Train Acc: 0.3590
 Site-QuickDraw | Train Loss: 2.3575 | Train Acc: 0.0312
 Site-Real      | Train Loss: 2.0518 | Train Acc: 0.3158
 Site-Sketch    | Train Loss: 2.0669 | Train Acc: 0.3429
 Site-Clipart   | Val  Loss: 1.8336 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.9580 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 2.0205 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 1.9726 | Val  Acc: 0.4030
 Site-Infograph | Val  Loss: 2.1541 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.0885 | Val  Acc: 0.3600
 Site-Infograph | Val  Loss: 2.2134 | Val  Acc: 0.2432
 Site-Infograph | Val  Loss: 2.2229 | Val  Acc: 0.2600
 Site-Painting  | Val  Loss: 2.1434 | Val  Acc: 0.3846
 Site-QuickDraw | Val  Loss: 2.2815 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.0385 | Val  Acc: 0.4000
 Site-Sketch    | Val  Loss: 2.0334 | Val  Acc: 0.3043
Average Valid Accuracy: 0.3474
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4030
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3600
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2432
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2600
 Best site-Painting   | Epoch:1 | Val Acc: 0.3846
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0952
 Best site-Real       | Epoch:1 | Val Acc: 0.4000
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/Nova...
============ Train epoch 4 ============
============ Train epoch 5 ============
client-0 is in G-5
client-1 is in G-4
client-2 is in G-2
client-3 is in G-1
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-3
client-8 is in G-0
client-9 is in G-3
client-10 is in G-4
client-11 is in G-5
cnt=[2, 1, 1, 3, 3, 2, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.9370 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.8639 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.9020 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.8646 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 2.3030 | Train Acc: 0.1667
 Site-Infograph | Train Loss: 2.1950 | Train Acc: 0.1892
 Site-Infograph | Train Loss: 2.1028 | Train Acc: 0.3036
 Site-Infograph | Train Loss: 2.0469 | Train Acc: 0.3867
 Site-Painting  | Train Loss: 2.0351 | Train Acc: 0.4359
 Site-QuickDraw | Train Loss: 2.3423 | Train Acc: 0.0938
 Site-Real      | Train Loss: 2.0225 | Train Acc: 0.4474
 Site-Sketch    | Train Loss: 1.8315 | Train Acc: 0.4857
============ Train epoch 6 ============
============ Train epoch 7 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-3
client-3 is in G-5
client-4 is in G-2
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-0
client-9 is in G-4
client-10 is in G-1
client-11 is in G-1
cnt=[2, 3, 4, 1, 1, 1, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.7716 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.8774 | Train Acc: 0.5400
 Site-Clipart   | Train Loss: 1.7304 | Train Acc: 0.5733
 Site-Clipart   | Train Loss: 1.7078 | Train Acc: 0.5800
 Site-Infograph | Train Loss: 2.2305 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.1109 | Train Acc: 0.2162
 Site-Infograph | Train Loss: 2.0898 | Train Acc: 0.3214
 Site-Infograph | Train Loss: 2.0174 | Train Acc: 0.3867
 Site-Painting  | Train Loss: 1.9816 | Train Acc: 0.4359
 Site-QuickDraw | Train Loss: 2.3483 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.9169 | Train Acc: 0.5789
 Site-Sketch    | Train Loss: 1.7831 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.5868 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8042 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 1.6302 | Val  Acc: 0.6800
 Site-Clipart   | Val  Loss: 1.7346 | Val  Acc: 0.5373
 Site-Infograph | Val  Loss: 1.9395 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 1.9596 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.0950 | Val  Acc: 0.2973
 Site-Infograph | Val  Loss: 2.0921 | Val  Acc: 0.3200
 Site-Painting  | Val  Loss: 1.8711 | Val  Acc: 0.4615
 Site-QuickDraw | Val  Loss: 2.1495 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.8647 | Val  Acc: 0.6000
 Site-Sketch    | Val  Loss: 1.7589 | Val  Acc: 0.5217
Average Valid Accuracy: 0.4788
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6800
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5373
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2973
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3200
 Best site-Painting   | Epoch:3 | Val Acc: 0.4615
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2381
 Best site-Real       | Epoch:3 | Val Acc: 0.6000
 Best site-Sketch     | Epoch:3 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/Nova...
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-1
client-1 is in G-3
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-1
client-6 is in G-3
client-7 is in G-2
client-8 is in G-0
client-9 is in G-2
client-10 is in G-0
client-11 is in G-3
cnt=[4, 2, 3, 3, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.6398 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.9376 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.6398 | Train Acc: 0.6533
 Site-Clipart   | Train Loss: 1.5544 | Train Acc: 0.7100
 Site-Infograph | Train Loss: 2.2294 | Train Acc: 0.1667
 Site-Infograph | Train Loss: 2.1418 | Train Acc: 0.2432
 Site-Infograph | Train Loss: 2.0252 | Train Acc: 0.3393
 Site-Infograph | Train Loss: 1.8869 | Train Acc: 0.4133
 Site-Painting  | Train Loss: 1.7237 | Train Acc: 0.5897
 Site-QuickDraw | Train Loss: 2.3272 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.7307 | Train Acc: 0.5789
 Site-Sketch    | Train Loss: 1.6515 | Train Acc: 0.5714
============ Train epoch 10 ============
============ Train epoch 11 ============
client-0 is in G-2
client-1 is in G-3
client-2 is in G-0
client-3 is in G-4
client-4 is in G-2
client-5 is in G-0
client-6 is in G-1
client-7 is in G-4
client-8 is in G-0
client-9 is in G-2
client-10 is in G-0
client-11 is in G-3
cnt=[4, 1, 3, 2, 2, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.4757 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.7000 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 1.4780 | Train Acc: 0.7467
 Site-Clipart   | Train Loss: 1.4001 | Train Acc: 0.7400
 Site-Infograph | Train Loss: 2.0802 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 2.1076 | Train Acc: 0.2703
 Site-Infograph | Train Loss: 1.9356 | Train Acc: 0.3929
 Site-Infograph | Train Loss: 1.8649 | Train Acc: 0.4667
 Site-Painting  | Train Loss: 1.6394 | Train Acc: 0.6410
 Site-QuickDraw | Train Loss: 2.3596 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.6119 | Train Acc: 0.6053
 Site-Sketch    | Train Loss: 1.5550 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.4016 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.4717 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.3181 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.5166 | Val  Acc: 0.7015
 Site-Infograph | Val  Loss: 1.7391 | Val  Acc: 0.5833
 Site-Infograph | Val  Loss: 1.7528 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.9322 | Val  Acc: 0.4324
 Site-Infograph | Val  Loss: 1.9495 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.7342 | Val  Acc: 0.4615
 Site-QuickDraw | Val  Loss: 2.1072 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.6599 | Val  Acc: 0.6000
 Site-Sketch    | Val  Loss: 1.6615 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5752
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7200
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7015
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5833
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4324
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4000
 Best site-Painting   | Epoch:5 | Val Acc: 0.4615
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2381
 Best site-Real       | Epoch:5 | Val Acc: 0.6000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/Nova...
============ Train epoch 12 ============
============ Train epoch 13 ============
client-0 is in G-2
client-1 is in G-0
client-2 is in G-1
client-3 is in G-2
client-4 is in G-4
client-5 is in G-3
client-6 is in G-0
client-7 is in G-3
client-8 is in G-0
client-9 is in G-2
client-10 is in G-1
client-11 is in G-3
cnt=[3, 2, 3, 3, 1, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.4205 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.4383 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 1.4132 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 1.3290 | Train Acc: 0.8100
 Site-Infograph | Train Loss: 2.2261 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.0051 | Train Acc: 0.2973
 Site-Infograph | Train Loss: 1.8816 | Train Acc: 0.3929
 Site-Infograph | Train Loss: 1.7656 | Train Acc: 0.5067
 Site-Painting  | Train Loss: 1.5713 | Train Acc: 0.7179
 Site-QuickDraw | Train Loss: 2.3427 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.4924 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.4932 | Train Acc: 0.7143
============ Train epoch 14 ============
============ Train epoch 15 ============
client-0 is in G-2
client-1 is in G-3
client-2 is in G-0
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-3
client-7 is in G-1
client-8 is in G-0
client-9 is in G-4
client-10 is in G-0
client-11 is in G-1
cnt=[4, 2, 2, 2, 2, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.3276 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.3530 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.2812 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 1.1899 | Train Acc: 0.7700
 Site-Infograph | Train Loss: 2.1980 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 2.0425 | Train Acc: 0.3514
 Site-Infograph | Train Loss: 1.7939 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.7183 | Train Acc: 0.5200
 Site-Painting  | Train Loss: 1.4468 | Train Acc: 0.6923
 Site-QuickDraw | Train Loss: 2.3263 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.4217 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 1.3779 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.1553 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.2174 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.0681 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 1.2975 | Val  Acc: 0.7910
 Site-Infograph | Val  Loss: 1.5727 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.6855 | Val  Acc: 0.5600
 Site-Infograph | Val  Loss: 1.7746 | Val  Acc: 0.4595
 Site-Infograph | Val  Loss: 1.8581 | Val  Acc: 0.4400
 Site-Painting  | Val  Loss: 1.5283 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 2.0372 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.4914 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.5251 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6364
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8200
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7910
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5600
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4595
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4400
 Best site-Painting   | Epoch:7 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3333
 Best site-Real       | Epoch:7 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:7 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/Nova...
============ Train epoch 16 ============
============ Train epoch 17 ============
client-0 is in G-4
client-1 is in G-3
client-2 is in G-2
client-3 is in G-4
client-4 is in G-4
client-5 is in G-1
client-6 is in G-3
client-7 is in G-2
client-8 is in G-0
client-9 is in G-1
client-10 is in G-0
client-11 is in G-4
cnt=[2, 2, 2, 2, 4, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.2344 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.1656 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.2167 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 1.0582 | Train Acc: 0.8300
 Site-Infograph | Train Loss: 1.9093 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.9292 | Train Acc: 0.3243
 Site-Infograph | Train Loss: 1.7734 | Train Acc: 0.4643
 Site-Infograph | Train Loss: 1.6491 | Train Acc: 0.5200
 Site-Painting  | Train Loss: 1.4519 | Train Acc: 0.7692
 Site-QuickDraw | Train Loss: 2.3499 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.2809 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.1581 | Train Acc: 0.8000
============ Train epoch 18 ============
