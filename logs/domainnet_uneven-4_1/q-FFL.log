===2023-04-16 21:40:57===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,8,17,26,35,32,38,35,]
label set of clients: [10, 10, 10, 10, 10, 6, 10, 10, 10, 10, 10, 9, ]
domain number = 6
============ Train epoch 0 ============
denominator: 64710.5
 Site-Clipart   | Train Loss: 2.2402 | Train Acc: 0.1200
 Site-Clipart   | Train Loss: 2.1689 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.2728 | Train Acc: 0.1333
 Site-Clipart   | Train Loss: 2.2436 | Train Acc: 0.1800
 Site-Infograph | Train Loss: 2.3376 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.2959 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.4121 | Train Acc: 0.1765
 Site-Painting  | Train Loss: 2.2077 | Train Acc: 0.2692
 Site-Painting  | Train Loss: 2.3579 | Train Acc: 0.0286
 Site-QuickDraw | Train Loss: 2.2723 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.3663 | Train Acc: 0.1053
 Site-Sketch    | Train Loss: 2.2518 | Train Acc: 0.1143
 Site-Clipart   | Val  Loss: 2.4661 | Val  Acc: 0.0625
 Site-Clipart   | Val  Loss: 2.2826 | Val  Acc: 0.0909
 Site-Clipart   | Val  Loss: 2.2848 | Val  Acc: 0.1000
 Site-Clipart   | Val  Loss: 2.3134 | Val  Acc: 0.1493
 Site-Infograph | Val  Loss: 2.4550 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 2.4190 | Val  Acc: 0.0000
 Site-Painting  | Val  Loss: 2.2467 | Val  Acc: 0.2727
 Site-Painting  | Val  Loss: 2.4098 | Val  Acc: 0.2353
 Site-Painting  | Val  Loss: 2.2291 | Val  Acc: 0.3478
 Site-QuickDraw | Val  Loss: 2.4100 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.3966 | Val  Acc: 0.0400
 Site-Sketch    | Val  Loss: 2.1695 | Val  Acc: 0.1739
Average Valid Accuracy: 0.1310
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0625
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0909
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1493
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1000
 Best site-Painting   | Epoch:0 | Val Acc: 0.0000
 Best site-Painting   | Epoch:0 | Val Acc: 0.2727
 Best site-Painting   | Epoch:0 | Val Acc: 0.2353
 Best site-Painting   | Epoch:0 | Val Acc: 0.3478
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0000
 Best site-Real       | Epoch:0 | Val Acc: 0.0400
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 1 ============
denominator: 60417.45703125
 Site-Clipart   | Train Loss: 2.1201 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.1485 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.2477 | Train Acc: 0.1200
 Site-Clipart   | Train Loss: 2.1959 | Train Acc: 0.2100
 Site-Infograph | Train Loss: 2.3008 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.2857 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.2960 | Train Acc: 0.1176
 Site-Painting  | Train Loss: 2.2329 | Train Acc: 0.3077
 Site-Painting  | Train Loss: 2.2907 | Train Acc: 0.0571
 Site-QuickDraw | Train Loss: 2.2961 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.2713 | Train Acc: 0.1053
 Site-Sketch    | Train Loss: 2.2241 | Train Acc: 0.1429
 Site-Clipart   | Val  Loss: 2.3992 | Val  Acc: 0.0625
 Site-Clipart   | Val  Loss: 2.1988 | Val  Acc: 0.0909
 Site-Clipart   | Val  Loss: 2.2295 | Val  Acc: 0.2200
 Site-Clipart   | Val  Loss: 2.2215 | Val  Acc: 0.1194
 Site-Infograph | Val  Loss: 2.4001 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.3384 | Val  Acc: 0.0000
 Site-Painting  | Val  Loss: 2.1905 | Val  Acc: 0.1818
 Site-Painting  | Val  Loss: 2.2219 | Val  Acc: 0.1176
 Site-Painting  | Val  Loss: 2.2032 | Val  Acc: 0.3043
 Site-QuickDraw | Val  Loss: 2.4464 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.3526 | Val  Acc: 0.0800
 Site-Sketch    | Val  Loss: 2.0921 | Val  Acc: 0.2609
Average Valid Accuracy: 0.1323
 Best site-Clipart    | Epoch:1 | Val Acc: 0.0625
 Best site-Clipart    | Epoch:1 | Val Acc: 0.0909
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2200
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1194
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1500
 Best site-Painting   | Epoch:1 | Val Acc: 0.0000
 Best site-Painting   | Epoch:1 | Val Acc: 0.1818
 Best site-Painting   | Epoch:1 | Val Acc: 0.1176
 Best site-Painting   | Epoch:1 | Val Acc: 0.3043
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0000
 Best site-Real       | Epoch:1 | Val Acc: 0.0800
 Best site-Sketch     | Epoch:1 | Val Acc: 0.2609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 2 ============
denominator: 58203.12890625
 Site-Clipart   | Train Loss: 2.2165 | Train Acc: 0.1200
 Site-Clipart   | Train Loss: 2.1397 | Train Acc: 0.2600
 Site-Clipart   | Train Loss: 2.2003 | Train Acc: 0.1333
 Site-Clipart   | Train Loss: 2.1573 | Train Acc: 0.1700
 Site-Infograph | Train Loss: 2.2852 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.2799 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.3508 | Train Acc: 0.2353
 Site-Painting  | Train Loss: 2.1613 | Train Acc: 0.3077
 Site-Painting  | Train Loss: 2.2517 | Train Acc: 0.0857
 Site-QuickDraw | Train Loss: 2.2816 | Train Acc: 0.0938
 Site-Real      | Train Loss: 2.2553 | Train Acc: 0.0789
 Site-Sketch    | Train Loss: 2.1222 | Train Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.2759 | Val  Acc: 0.0625
 Site-Clipart   | Val  Loss: 2.1204 | Val  Acc: 0.1212
 Site-Clipart   | Val  Loss: 2.1594 | Val  Acc: 0.2400
 Site-Clipart   | Val  Loss: 2.2393 | Val  Acc: 0.2090
 Site-Infograph | Val  Loss: 2.4013 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.1880 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.0848 | Val  Acc: 0.3636
 Site-Painting  | Val  Loss: 2.3196 | Val  Acc: 0.1765
 Site-Painting  | Val  Loss: 2.1810 | Val  Acc: 0.3043
 Site-QuickDraw | Val  Loss: 2.3638 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.2705 | Val  Acc: 0.0400
 Site-Sketch    | Val  Loss: 2.1320 | Val  Acc: 0.1739
Average Valid Accuracy: 0.1741
 Best site-Clipart    | Epoch:2 | Val Acc: 0.0625
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1212
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2400
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2090
 Best site-Infograph  | Epoch:2 | Val Acc: 0.1500
 Best site-Painting   | Epoch:2 | Val Acc: 0.2000
 Best site-Painting   | Epoch:2 | Val Acc: 0.3636
 Best site-Painting   | Epoch:2 | Val Acc: 0.1765
 Best site-Painting   | Epoch:2 | Val Acc: 0.3043
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.0476
 Best site-Real       | Epoch:2 | Val Acc: 0.0400
 Best site-Sketch     | Epoch:2 | Val Acc: 0.1739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 3 ============
denominator: 56977.46875
 Site-Clipart   | Train Loss: 2.0541 | Train Acc: 0.3200
 Site-Clipart   | Train Loss: 2.1639 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.1182 | Train Acc: 0.2533
 Site-Clipart   | Train Loss: 2.1390 | Train Acc: 0.2500
 Site-Infograph | Train Loss: 2.3058 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.3005 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.2905 | Train Acc: 0.4118
 Site-Painting  | Train Loss: 2.0738 | Train Acc: 0.3846
 Site-Painting  | Train Loss: 2.2011 | Train Acc: 0.2000
 Site-QuickDraw | Train Loss: 2.2733 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.1001 | Train Acc: 0.2105
 Site-Sketch    | Train Loss: 2.2159 | Train Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.2327 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.0227 | Val  Acc: 0.2424
 Site-Clipart   | Val  Loss: 2.1004 | Val  Acc: 0.2400
 Site-Clipart   | Val  Loss: 2.1699 | Val  Acc: 0.2388
 Site-Infograph | Val  Loss: 2.3513 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.1598 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.1234 | Val  Acc: 0.3636
 Site-Painting  | Val  Loss: 2.2761 | Val  Acc: 0.1765
 Site-Painting  | Val  Loss: 2.1047 | Val  Acc: 0.3043
 Site-QuickDraw | Val  Loss: 2.3622 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.2396 | Val  Acc: 0.1600
 Site-Sketch    | Val  Loss: 2.0807 | Val  Acc: 0.1739
Average Valid Accuracy: 0.2019
 Best site-Clipart    | Epoch:3 | Val Acc: 0.1250
 Best site-Clipart    | Epoch:3 | Val Acc: 0.2424
 Best site-Clipart    | Epoch:3 | Val Acc: 0.2400
 Best site-Clipart    | Epoch:3 | Val Acc: 0.2388
 Best site-Infograph  | Epoch:3 | Val Acc: 0.1500
 Best site-Painting   | Epoch:3 | Val Acc: 0.2000
 Best site-Painting   | Epoch:3 | Val Acc: 0.3636
 Best site-Painting   | Epoch:3 | Val Acc: 0.1765
 Best site-Painting   | Epoch:3 | Val Acc: 0.3043
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.0476
 Best site-Real       | Epoch:3 | Val Acc: 0.1600
 Best site-Sketch     | Epoch:3 | Val Acc: 0.1739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 4 ============
denominator: 55980.4296875
 Site-Clipart   | Train Loss: 2.0391 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.1742 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.0863 | Train Acc: 0.2533
 Site-Clipart   | Train Loss: 2.1139 | Train Acc: 0.3200
 Site-Infograph | Train Loss: 2.2763 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.2717 | Train Acc: 0.2500
 Site-Painting  | Train Loss: 1.7936 | Train Acc: 0.3529
 Site-Painting  | Train Loss: 2.0897 | Train Acc: 0.3077
 Site-Painting  | Train Loss: 2.2069 | Train Acc: 0.2000
 Site-QuickDraw | Train Loss: 2.2414 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.1403 | Train Acc: 0.2895
 Site-Sketch    | Train Loss: 2.0404 | Train Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.1496 | Val  Acc: 0.1875
 Site-Clipart   | Val  Loss: 1.9739 | Val  Acc: 0.3030
 Site-Clipart   | Val  Loss: 2.0710 | Val  Acc: 0.3200
 Site-Clipart   | Val  Loss: 2.1382 | Val  Acc: 0.2537
 Site-Infograph | Val  Loss: 2.4324 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 2.1820 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.0487 | Val  Acc: 0.1818
 Site-Painting  | Val  Loss: 2.1300 | Val  Acc: 0.2353
 Site-Painting  | Val  Loss: 2.1560 | Val  Acc: 0.3913
 Site-QuickDraw | Val  Loss: 2.3737 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.2203 | Val  Acc: 0.2400
 Site-Sketch    | Val  Loss: 2.0586 | Val  Acc: 0.2609
Average Valid Accuracy: 0.2268
 Best site-Clipart    | Epoch:4 | Val Acc: 0.1875
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3030
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3200
 Best site-Clipart    | Epoch:4 | Val Acc: 0.2537
 Best site-Infograph  | Epoch:4 | Val Acc: 0.1000
 Best site-Painting   | Epoch:4 | Val Acc: 0.2000
 Best site-Painting   | Epoch:4 | Val Acc: 0.1818
 Best site-Painting   | Epoch:4 | Val Acc: 0.2353
 Best site-Painting   | Epoch:4 | Val Acc: 0.3913
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.0476
 Best site-Real       | Epoch:4 | Val Acc: 0.2400
 Best site-Sketch     | Epoch:4 | Val Acc: 0.2609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 5 ============
denominator: 55021.90625
 Site-Clipart   | Train Loss: 2.0600 | Train Acc: 0.3200
 Site-Clipart   | Train Loss: 1.9947 | Train Acc: 0.3200
 Site-Clipart   | Train Loss: 2.0553 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 2.0078 | Train Acc: 0.3400
 Site-Infograph | Train Loss: 2.2463 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.1906 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.2572 | Train Acc: 0.3529
 Site-Painting  | Train Loss: 2.0160 | Train Acc: 0.4615
 Site-Painting  | Train Loss: 2.1661 | Train Acc: 0.2286
 Site-QuickDraw | Train Loss: 2.2467 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.0633 | Train Acc: 0.2105
 Site-Sketch    | Train Loss: 1.9680 | Train Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.0888 | Val  Acc: 0.1875
 Site-Clipart   | Val  Loss: 1.9947 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 2.0424 | Val  Acc: 0.4200
 Site-Clipart   | Val  Loss: 2.0328 | Val  Acc: 0.2388
 Site-Infograph | Val  Loss: 2.3170 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 2.0383 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.0880 | Val  Acc: 0.3636
 Site-Painting  | Val  Loss: 2.2014 | Val  Acc: 0.2353
 Site-Painting  | Val  Loss: 2.0224 | Val  Acc: 0.3478
 Site-QuickDraw | Val  Loss: 2.3823 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.2024 | Val  Acc: 0.2000
 Site-Sketch    | Val  Loss: 2.0302 | Val  Acc: 0.3913
Average Valid Accuracy: 0.2515
 Best site-Clipart    | Epoch:5 | Val Acc: 0.1875
 Best site-Clipart    | Epoch:5 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4200
 Best site-Clipart    | Epoch:5 | Val Acc: 0.2388
 Best site-Infograph  | Epoch:5 | Val Acc: 0.1000
 Best site-Painting   | Epoch:5 | Val Acc: 0.2000
 Best site-Painting   | Epoch:5 | Val Acc: 0.3636
 Best site-Painting   | Epoch:5 | Val Acc: 0.2353
 Best site-Painting   | Epoch:5 | Val Acc: 0.3478
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.0000
 Best site-Real       | Epoch:5 | Val Acc: 0.2000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 6 ============
denominator: 54288.0078125
 Site-Clipart   | Train Loss: 2.0251 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.0053 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.0290 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 1.9956 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 2.2114 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.1789 | Train Acc: 0.2500
 Site-Painting  | Train Loss: 2.2347 | Train Acc: 0.4118
 Site-Painting  | Train Loss: 1.9894 | Train Acc: 0.4231
 Site-Painting  | Train Loss: 2.2291 | Train Acc: 0.2571
 Site-QuickDraw | Train Loss: 2.2646 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.0529 | Train Acc: 0.4211
 Site-Sketch    | Train Loss: 2.0284 | Train Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.0863 | Val  Acc: 0.3125
 Site-Clipart   | Val  Loss: 1.9981 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 1.9876 | Val  Acc: 0.3400
 Site-Clipart   | Val  Loss: 2.0572 | Val  Acc: 0.3134
 Site-Infograph | Val  Loss: 2.3978 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 2.1479 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.0045 | Val  Acc: 0.3636
 Site-Painting  | Val  Loss: 2.1103 | Val  Acc: 0.4118
 Site-Painting  | Val  Loss: 1.9690 | Val  Acc: 0.5652
 Site-QuickDraw | Val  Loss: 2.3576 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.1734 | Val  Acc: 0.2000
 Site-Sketch    | Val  Loss: 1.9812 | Val  Acc: 0.3043
Average Valid Accuracy: 0.2859
 Best site-Clipart    | Epoch:6 | Val Acc: 0.3125
 Best site-Clipart    | Epoch:6 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:6 | Val Acc: 0.3400
 Best site-Clipart    | Epoch:6 | Val Acc: 0.3134
 Best site-Infograph  | Epoch:6 | Val Acc: 0.1000
 Best site-Painting   | Epoch:6 | Val Acc: 0.2000
 Best site-Painting   | Epoch:6 | Val Acc: 0.3636
 Best site-Painting   | Epoch:6 | Val Acc: 0.4118
 Best site-Painting   | Epoch:6 | Val Acc: 0.5652
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.0476
 Best site-Real       | Epoch:6 | Val Acc: 0.2000
 Best site-Sketch     | Epoch:6 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 7 ============
denominator: 53267.734375
 Site-Clipart   | Train Loss: 1.9853 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.9514 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 1.9901 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 1.9401 | Train Acc: 0.4400
 Site-Infograph | Train Loss: 2.2466 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.1572 | Train Acc: 0.3750
 Site-Painting  | Train Loss: 2.1055 | Train Acc: 0.3529
 Site-Painting  | Train Loss: 1.9453 | Train Acc: 0.5385
 Site-Painting  | Train Loss: 2.0681 | Train Acc: 0.2286
 Site-QuickDraw | Train Loss: 2.2271 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.0084 | Train Acc: 0.4474
 Site-Sketch    | Train Loss: 1.9904 | Train Acc: 0.2857
 Site-Clipart   | Val  Loss: 1.9995 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 1.9344 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 1.9635 | Val  Acc: 0.4200
 Site-Clipart   | Val  Loss: 2.0180 | Val  Acc: 0.4030
 Site-Infograph | Val  Loss: 2.4380 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 2.0389 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.8780 | Val  Acc: 0.3636
 Site-Painting  | Val  Loss: 2.0297 | Val  Acc: 0.3529
 Site-Painting  | Val  Loss: 1.9577 | Val  Acc: 0.5652
 Site-QuickDraw | Val  Loss: 2.3407 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.1238 | Val  Acc: 0.2800
 Site-Sketch    | Val  Loss: 1.9237 | Val  Acc: 0.4348
Average Valid Accuracy: 0.3422
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4200
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4030
 Best site-Infograph  | Epoch:7 | Val Acc: 0.1000
 Best site-Painting   | Epoch:7 | Val Acc: 0.2000
 Best site-Painting   | Epoch:7 | Val Acc: 0.3636
 Best site-Painting   | Epoch:7 | Val Acc: 0.3529
 Best site-Painting   | Epoch:7 | Val Acc: 0.5652
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.0952
 Best site-Real       | Epoch:7 | Val Acc: 0.2800
 Best site-Sketch     | Epoch:7 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 8 ============
denominator: 52046.21484375
 Site-Clipart   | Train Loss: 1.9053 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.9927 | Train Acc: 0.4200
 Site-Clipart   | Train Loss: 1.9496 | Train Acc: 0.3733
 Site-Clipart   | Train Loss: 1.9058 | Train Acc: 0.4800
 Site-Infograph | Train Loss: 2.2611 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.1552 | Train Acc: 0.2500
 Site-Painting  | Train Loss: 2.0837 | Train Acc: 0.5294
 Site-Painting  | Train Loss: 1.8850 | Train Acc: 0.5385
 Site-Painting  | Train Loss: 2.1310 | Train Acc: 0.3143
 Site-QuickDraw | Train Loss: 2.2463 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.9915 | Train Acc: 0.4211
 Site-Sketch    | Train Loss: 1.9350 | Train Acc: 0.4571
 Site-Clipart   | Val  Loss: 1.9722 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 1.9050 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.8656 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9533 | Val  Acc: 0.3881
 Site-Infograph | Val  Loss: 2.3602 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.8872 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.9500 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 1.9669 | Val  Acc: 0.4118
 Site-Painting  | Val  Loss: 1.9024 | Val  Acc: 0.6087
 Site-QuickDraw | Val  Loss: 2.2851 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1393 | Val  Acc: 0.2400
 Site-Sketch    | Val  Loss: 1.9057 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4100
 Best site-Clipart    | Epoch:8 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.3881
 Best site-Infograph  | Epoch:8 | Val Acc: 0.2000
 Best site-Painting   | Epoch:8 | Val Acc: 0.6000
 Best site-Painting   | Epoch:8 | Val Acc: 0.4545
 Best site-Painting   | Epoch:8 | Val Acc: 0.4118
 Best site-Painting   | Epoch:8 | Val Acc: 0.6087
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.1429
 Best site-Real       | Epoch:8 | Val Acc: 0.2400
 Best site-Sketch     | Epoch:8 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 9 ============
denominator: 51909.921875
 Site-Clipart   | Train Loss: 1.9142 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.9626 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.8791 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.8437 | Train Acc: 0.5400
 Site-Infograph | Train Loss: 2.2216 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.0419 | Train Acc: 0.3750
 Site-Painting  | Train Loss: 2.0871 | Train Acc: 0.4706
 Site-Painting  | Train Loss: 1.8566 | Train Acc: 0.6154
 Site-Painting  | Train Loss: 2.1282 | Train Acc: 0.4286
 Site-QuickDraw | Train Loss: 2.2097 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.9480 | Train Acc: 0.4211
 Site-Sketch    | Train Loss: 1.9470 | Train Acc: 0.4000
 Site-Clipart   | Val  Loss: 2.0169 | Val  Acc: 0.3125
 Site-Clipart   | Val  Loss: 1.7529 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 1.8852 | Val  Acc: 0.4600
 Site-Clipart   | Val  Loss: 1.9321 | Val  Acc: 0.4776
 Site-Infograph | Val  Loss: 2.4465 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.8471 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.9620 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 1.8268 | Val  Acc: 0.4118
 Site-Painting  | Val  Loss: 1.8640 | Val  Acc: 0.6087
 Site-QuickDraw | Val  Loss: 2.3051 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0583 | Val  Acc: 0.3200
 Site-Sketch    | Val  Loss: 1.8846 | Val  Acc: 0.4348
Average Valid Accuracy: 0.3999
============ Train epoch 10 ============
denominator: 51125.4921875
 Site-Clipart   | Train Loss: 1.8837 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.8657 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.8363 | Train Acc: 0.5067
 Site-Clipart   | Train Loss: 1.8344 | Train Acc: 0.5600
 Site-Infograph | Train Loss: 2.2435 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 1.9751 | Train Acc: 0.3750
 Site-Painting  | Train Loss: 1.8211 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 1.8543 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 2.0859 | Train Acc: 0.3714
 Site-QuickDraw | Train Loss: 2.1978 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.9157 | Train Acc: 0.4737
 Site-Sketch    | Train Loss: 1.7359 | Train Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.9929 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 1.7909 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 1.7977 | Val  Acc: 0.5200
 Site-Clipart   | Val  Loss: 1.8494 | Val  Acc: 0.4627
 Site-Infograph | Val  Loss: 2.3270 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 1.9298 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.8455 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 1.9229 | Val  Acc: 0.4706
 Site-Painting  | Val  Loss: 1.8288 | Val  Acc: 0.5652
 Site-QuickDraw | Val  Loss: 2.2912 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 2.0150 | Val  Acc: 0.3600
 Site-Sketch    | Val  Loss: 1.8868 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4006
============ Train epoch 11 ============
denominator: 49316.4609375
 Site-Clipart   | Train Loss: 1.8636 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.8138 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.8168 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.7758 | Train Acc: 0.5400
 Site-Infograph | Train Loss: 2.2508 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.0669 | Train Acc: 0.2500
 Site-Painting  | Train Loss: 1.7994 | Train Acc: 0.5294
 Site-Painting  | Train Loss: 1.7697 | Train Acc: 0.5769
 Site-Painting  | Train Loss: 1.9433 | Train Acc: 0.5429
 Site-QuickDraw | Train Loss: 2.1808 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.8602 | Train Acc: 0.5263
 Site-Sketch    | Train Loss: 1.7537 | Train Acc: 0.5429
 Site-Clipart   | Val  Loss: 1.8981 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.7392 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.7208 | Val  Acc: 0.5800
 Site-Clipart   | Val  Loss: 1.7920 | Val  Acc: 0.5075
 Site-Infograph | Val  Loss: 2.3522 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 1.8338 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.8944 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 1.8820 | Val  Acc: 0.5294
 Site-Painting  | Val  Loss: 1.7712 | Val  Acc: 0.6087
 Site-QuickDraw | Val  Loss: 2.2826 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.9628 | Val  Acc: 0.4000
 Site-Sketch    | Val  Loss: 1.8242 | Val  Acc: 0.4348
Average Valid Accuracy: 0.4672
 Best site-Clipart    | Epoch:11 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:11 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:11 | Val Acc: 0.5800
 Best site-Clipart    | Epoch:11 | Val Acc: 0.5075
 Best site-Infograph  | Epoch:11 | Val Acc: 0.1500
 Best site-Painting   | Epoch:11 | Val Acc: 0.6000
 Best site-Painting   | Epoch:11 | Val Acc: 0.5455
 Best site-Painting   | Epoch:11 | Val Acc: 0.5294
 Best site-Painting   | Epoch:11 | Val Acc: 0.6087
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.1429
 Best site-Real       | Epoch:11 | Val Acc: 0.4000
 Best site-Sketch     | Epoch:11 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 12 ============
denominator: 48712.953125
 Site-Clipart   | Train Loss: 1.8139 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.8101 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.7785 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.7316 | Train Acc: 0.6300
 Site-Infograph | Train Loss: 2.1740 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 2.0460 | Train Acc: 0.2500
 Site-Painting  | Train Loss: 1.9134 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 1.8402 | Train Acc: 0.4615
 Site-Painting  | Train Loss: 1.9378 | Train Acc: 0.5143
 Site-QuickDraw | Train Loss: 2.2141 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.7536 | Train Acc: 0.6579
 Site-Sketch    | Train Loss: 1.7124 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.8437 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6765 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.7384 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.7627 | Val  Acc: 0.5224
 Site-Infograph | Val  Loss: 2.2856 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.7413 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8085 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 1.9414 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 1.7817 | Val  Acc: 0.6522
 Site-QuickDraw | Val  Loss: 2.2732 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.8595 | Val  Acc: 0.5200
 Site-Sketch    | Val  Loss: 1.7920 | Val  Acc: 0.4783
Average Valid Accuracy: 0.5211
 Best site-Clipart    | Epoch:12 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6970
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6000
 Best site-Clipart    | Epoch:12 | Val Acc: 0.5224
 Best site-Infograph  | Epoch:12 | Val Acc: 0.2500
 Best site-Painting   | Epoch:12 | Val Acc: 0.8000
 Best site-Painting   | Epoch:12 | Val Acc: 0.4545
 Best site-Painting   | Epoch:12 | Val Acc: 0.5882
 Best site-Painting   | Epoch:12 | Val Acc: 0.6522
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.1905
 Best site-Real       | Epoch:12 | Val Acc: 0.5200
 Best site-Sketch     | Epoch:12 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 13 ============
denominator: 47342.90625
 Site-Clipart   | Train Loss: 1.6757 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.8160 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 1.7306 | Train Acc: 0.5867
 Site-Clipart   | Train Loss: 1.7160 | Train Acc: 0.5700
 Site-Infograph | Train Loss: 2.2423 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.9082 | Train Acc: 0.6250
 Site-Painting  | Train Loss: 1.9959 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.7481 | Train Acc: 0.6538
 Site-Painting  | Train Loss: 1.8192 | Train Acc: 0.4857
 Site-QuickDraw | Train Loss: 2.2119 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.7214 | Train Acc: 0.6316
 Site-Sketch    | Train Loss: 1.7203 | Train Acc: 0.5143
 Site-Clipart   | Val  Loss: 1.8115 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.6512 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.6532 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.7260 | Val  Acc: 0.5821
 Site-Infograph | Val  Loss: 2.3715 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 1.7845 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.6509 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.8010 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 1.6918 | Val  Acc: 0.7391
 Site-QuickDraw | Val  Loss: 2.2710 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.8738 | Val  Acc: 0.5600
 Site-Sketch    | Val  Loss: 1.7853 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5479
 Best site-Clipart    | Epoch:13 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:13 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:13 | Val Acc: 0.6000
 Best site-Clipart    | Epoch:13 | Val Acc: 0.5821
 Best site-Infograph  | Epoch:13 | Val Acc: 0.1500
 Best site-Painting   | Epoch:13 | Val Acc: 0.6000
 Best site-Painting   | Epoch:13 | Val Acc: 0.8182
 Best site-Painting   | Epoch:13 | Val Acc: 0.5882
 Best site-Painting   | Epoch:13 | Val Acc: 0.7391
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.1429
 Best site-Real       | Epoch:13 | Val Acc: 0.5600
 Best site-Sketch     | Epoch:13 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 14 ============
denominator: 46383.26171875
 Site-Clipart   | Train Loss: 1.6142 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6543 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 1.7052 | Train Acc: 0.6533
 Site-Clipart   | Train Loss: 1.6880 | Train Acc: 0.6400
 Site-Infograph | Train Loss: 2.2540 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 1.8061 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 2.0757 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.6523 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 1.7678 | Train Acc: 0.6571
 Site-QuickDraw | Train Loss: 2.2028 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.6157 | Train Acc: 0.6316
 Site-Sketch    | Train Loss: 1.7336 | Train Acc: 0.5143
 Site-Clipart   | Val  Loss: 1.8605 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6059 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 1.6148 | Val  Acc: 0.6200
 Site-Clipart   | Val  Loss: 1.6905 | Val  Acc: 0.5522
 Site-Infograph | Val  Loss: 2.3397 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.6867 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.7565 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 1.8385 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 1.5680 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.1963 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.8199 | Val  Acc: 0.5200
 Site-Sketch    | Val  Loss: 1.7217 | Val  Acc: 0.4348
Average Valid Accuracy: 0.5080
============ Train epoch 15 ============
denominator: 46783.07421875
 Site-Clipart   | Train Loss: 1.6008 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.7354 | Train Acc: 0.5400
 Site-Clipart   | Train Loss: 1.6959 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.6336 | Train Acc: 0.5800
 Site-Infograph | Train Loss: 2.2162 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.6892 | Train Acc: 0.6250
 Site-Painting  | Train Loss: 1.8807 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.6440 | Train Acc: 0.6538
 Site-Painting  | Train Loss: 1.7234 | Train Acc: 0.5429
 Site-QuickDraw | Train Loss: 2.1701 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.6470 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 1.6011 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.8218 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.5296 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 1.4973 | Val  Acc: 0.6600
 Site-Clipart   | Val  Loss: 1.6198 | Val  Acc: 0.5970
 Site-Infograph | Val  Loss: 2.4476 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 1.6799 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.6445 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.8191 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 1.5629 | Val  Acc: 0.6957
 Site-QuickDraw | Val  Loss: 2.2503 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 1.8011 | Val  Acc: 0.5600
 Site-Sketch    | Val  Loss: 1.7532 | Val  Acc: 0.4783
Average Valid Accuracy: 0.5378
============ Train epoch 16 ============
denominator: 45532.05078125
 Site-Clipart   | Train Loss: 1.5604 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.5622 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6140 | Train Acc: 0.6533
 Site-Clipart   | Train Loss: 1.5073 | Train Acc: 0.6700
 Site-Infograph | Train Loss: 2.2096 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.7309 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.6682 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 1.5891 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 1.7335 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 2.1861 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.5966 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 1.6731 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.6946 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6109 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.4576 | Val  Acc: 0.6600
 Site-Clipart   | Val  Loss: 1.6244 | Val  Acc: 0.5672
 Site-Infograph | Val  Loss: 2.3647 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.7968 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.4877 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.7544 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 1.5903 | Val  Acc: 0.6957
 Site-QuickDraw | Val  Loss: 2.2274 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.7520 | Val  Acc: 0.5200
 Site-Sketch    | Val  Loss: 1.7087 | Val  Acc: 0.4348
Average Valid Accuracy: 0.5390
============ Train epoch 17 ============
denominator: 44163.6171875
 Site-Clipart   | Train Loss: 1.5453 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.6555 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.5870 | Train Acc: 0.6533
 Site-Clipart   | Train Loss: 1.5209 | Train Acc: 0.6700
 Site-Infograph | Train Loss: 2.1860 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.7260 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.4191 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.5405 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 1.6667 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 2.1600 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.6004 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 1.4895 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.6441 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.4133 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.4368 | Val  Acc: 0.6600
 Site-Clipart   | Val  Loss: 1.5258 | Val  Acc: 0.6269
 Site-Infograph | Val  Loss: 2.3725 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.6245 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.6159 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.7018 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 1.4585 | Val  Acc: 0.8696
 Site-QuickDraw | Val  Loss: 2.1951 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.7289 | Val  Acc: 0.6400
 Site-Sketch    | Val  Loss: 1.7690 | Val  Acc: 0.4783
Average Valid Accuracy: 0.5893
 Best site-Clipart    | Epoch:17 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:17 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:17 | Val Acc: 0.6600
 Best site-Clipart    | Epoch:17 | Val Acc: 0.6269
 Best site-Infograph  | Epoch:17 | Val Acc: 0.2500
 Best site-Painting   | Epoch:17 | Val Acc: 0.8000
 Best site-Painting   | Epoch:17 | Val Acc: 0.7273
 Best site-Painting   | Epoch:17 | Val Acc: 0.6471
 Best site-Painting   | Epoch:17 | Val Acc: 0.8696
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.1429
 Best site-Real       | Epoch:17 | Val Acc: 0.6400
 Best site-Sketch     | Epoch:17 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 18 ============
denominator: 44148.49609375
 Site-Clipart   | Train Loss: 1.5623 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.7065 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.5685 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.4388 | Train Acc: 0.7500
 Site-Infograph | Train Loss: 2.1763 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.4985 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 2.2267 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 1.5587 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 1.6866 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 2.2204 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.6394 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.5493 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.6500 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.5193 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.3940 | Val  Acc: 0.6600
 Site-Clipart   | Val  Loss: 1.4975 | Val  Acc: 0.6418
 Site-Infograph | Val  Loss: 2.4005 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.4511 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.6780 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.6522 | Val  Acc: 0.5294
 Site-Painting  | Val  Loss: 1.5081 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.2300 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.7258 | Val  Acc: 0.5600
 Site-Sketch    | Val  Loss: 1.6269 | Val  Acc: 0.4783
Average Valid Accuracy: 0.5642
============ Train epoch 19 ============
denominator: 42902.8203125
 Site-Clipart   | Train Loss: 1.3565 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.4893 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.4975 | Train Acc: 0.7067
 Site-Clipart   | Train Loss: 1.4093 | Train Acc: 0.7600
 Site-Infograph | Train Loss: 2.1772 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.6871 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.4658 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 1.5362 | Train Acc: 0.6538
 Site-Painting  | Train Loss: 1.5783 | Train Acc: 0.6286
 Site-QuickDraw | Train Loss: 2.1440 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.5190 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.4355 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.6522 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.2967 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.3483 | Val  Acc: 0.6800
 Site-Clipart   | Val  Loss: 1.4492 | Val  Acc: 0.6418
 Site-Infograph | Val  Loss: 2.2437 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.6102 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.5023 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.5518 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.5077 | Val  Acc: 0.6957
 Site-QuickDraw | Val  Loss: 2.2093 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.6847 | Val  Acc: 0.6800
 Site-Sketch    | Val  Loss: 1.6554 | Val  Acc: 0.5217
Average Valid Accuracy: 0.5853
============ Train epoch 20 ============
denominator: 42749.9453125
 Site-Clipart   | Train Loss: 1.3368 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.6179 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.4650 | Train Acc: 0.7333
 Site-Clipart   | Train Loss: 1.4383 | Train Acc: 0.7600
 Site-Infograph | Train Loss: 2.1914 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.6650 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.1436 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 1.4993 | Train Acc: 0.6154
 Site-Painting  | Train Loss: 1.5942 | Train Acc: 0.6571
 Site-QuickDraw | Train Loss: 2.1621 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.4042 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.4992 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.5917 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.3747 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.2826 | Val  Acc: 0.6800
 Site-Clipart   | Val  Loss: 1.4347 | Val  Acc: 0.6716
 Site-Infograph | Val  Loss: 2.3792 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.5215 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.5526 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.6604 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.4897 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 2.1905 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.6006 | Val  Acc: 0.6400
 Site-Sketch    | Val  Loss: 1.5670 | Val  Acc: 0.5217
Average Valid Accuracy: 0.6230
 Best site-Clipart    | Epoch:20 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:20 | Val Acc: 0.7576
 Best site-Clipart    | Epoch:20 | Val Acc: 0.6800
 Best site-Clipart    | Epoch:20 | Val Acc: 0.6716
 Best site-Infograph  | Epoch:20 | Val Acc: 0.3500
 Best site-Painting   | Epoch:20 | Val Acc: 0.8000
 Best site-Painting   | Epoch:20 | Val Acc: 0.8182
 Best site-Painting   | Epoch:20 | Val Acc: 0.7059
 Best site-Painting   | Epoch:20 | Val Acc: 0.8261
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.1429
 Best site-Real       | Epoch:20 | Val Acc: 0.6400
 Best site-Sketch     | Epoch:20 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 21 ============
denominator: 42445.87890625
 Site-Clipart   | Train Loss: 1.3562 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.3374 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.4223 | Train Acc: 0.7333
 Site-Clipart   | Train Loss: 1.3400 | Train Acc: 0.7100
 Site-Infograph | Train Loss: 2.1360 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.4859 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 2.1574 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.3297 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 1.5634 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 2.0999 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.4647 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.4696 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.5237 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.2889 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.3282 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.3838 | Val  Acc: 0.7015
 Site-Infograph | Val  Loss: 2.1988 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.4902 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.4343 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.5116 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 1.3757 | Val  Acc: 0.7391
 Site-QuickDraw | Val  Loss: 2.1572 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.5964 | Val  Acc: 0.6400
 Site-Sketch    | Val  Loss: 1.5949 | Val  Acc: 0.4783
Average Valid Accuracy: 0.6082
============ Train epoch 22 ============
denominator: 40027.26171875
 Site-Clipart   | Train Loss: 1.2943 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.3728 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.4522 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.3167 | Train Acc: 0.7400
 Site-Infograph | Train Loss: 2.1263 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.5493 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.3018 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.3519 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.5992 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 2.1187 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.3191 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.3492 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.5191 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.2787 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.2475 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.3912 | Val  Acc: 0.6716
 Site-Infograph | Val  Loss: 2.3419 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.4213 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.4249 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.5367 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 1.3217 | Val  Acc: 0.8696
 Site-QuickDraw | Val  Loss: 2.2161 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 1.5679 | Val  Acc: 0.6800
 Site-Sketch    | Val  Loss: 1.5566 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6235
 Best site-Clipart    | Epoch:22 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7200
 Best site-Clipart    | Epoch:22 | Val Acc: 0.6716
 Best site-Infograph  | Epoch:22 | Val Acc: 0.2000
 Best site-Painting   | Epoch:22 | Val Acc: 0.8000
 Best site-Painting   | Epoch:22 | Val Acc: 0.8182
 Best site-Painting   | Epoch:22 | Val Acc: 0.6471
 Best site-Painting   | Epoch:22 | Val Acc: 0.8696
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.0952
 Best site-Real       | Epoch:22 | Val Acc: 0.6800
 Best site-Sketch     | Epoch:22 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 23 ============
denominator: 39421.14453125
 Site-Clipart   | Train Loss: 1.3867 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.2826 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.4529 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.3259 | Train Acc: 0.7400
 Site-Infograph | Train Loss: 2.1408 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.3691 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.1346 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 1.3361 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.4486 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.1572 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.2834 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.5136 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.5273 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.3351 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.2317 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.3320 | Val  Acc: 0.7164
 Site-Infograph | Val  Loss: 2.3716 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.4533 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.5257 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.6159 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.3359 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.1569 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.4919 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.5216 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6174
============ Train epoch 24 ============
denominator: 39095.13671875
 Site-Clipart   | Train Loss: 1.3017 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.2895 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.3069 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 1.2200 | Train Acc: 0.7700
 Site-Infograph | Train Loss: 2.0746 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.5187 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.6953 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 1.2865 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.6238 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 2.1036 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.3665 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.5249 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.4538 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.2040 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.2124 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.3204 | Val  Acc: 0.7164
 Site-Infograph | Val  Loss: 2.2000 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 1.3138 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.2578 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 1.3597 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.3066 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.1879 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.4688 | Val  Acc: 0.6400
 Site-Sketch    | Val  Loss: 1.5069 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6664
 Best site-Clipart    | Epoch:24 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:24 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:24 | Val Acc: 0.7200
 Best site-Clipart    | Epoch:24 | Val Acc: 0.7164
 Best site-Infograph  | Epoch:24 | Val Acc: 0.4500
 Best site-Painting   | Epoch:24 | Val Acc: 0.8000
 Best site-Painting   | Epoch:24 | Val Acc: 0.9091
 Best site-Painting   | Epoch:24 | Val Acc: 0.7647
 Best site-Painting   | Epoch:24 | Val Acc: 0.7826
 Best site-QuickDraw  | Epoch:24 | Val Acc: 0.1905
 Best site-Real       | Epoch:24 | Val Acc: 0.6400
 Best site-Sketch     | Epoch:24 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 25 ============
denominator: 38807.02734375
 Site-Clipart   | Train Loss: 1.3643 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.1580 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.3150 | Train Acc: 0.7333
 Site-Clipart   | Train Loss: 1.1858 | Train Acc: 0.8100
 Site-Infograph | Train Loss: 2.0153 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.4662 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.1102 | Train Acc: 0.9412
 Site-Painting  | Train Loss: 1.2429 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 1.6117 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.0815 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.2925 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.3649 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.4869 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.2027 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.1013 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.2810 | Val  Acc: 0.7313
 Site-Infograph | Val  Loss: 2.2621 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.2663 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.5272 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 1.5010 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.2869 | Val  Acc: 0.7391
 Site-QuickDraw | Val  Loss: 2.1356 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.4848 | Val  Acc: 0.6800
 Site-Sketch    | Val  Loss: 1.4826 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6275
============ Train epoch 26 ============
denominator: 36886.88671875
 Site-Clipart   | Train Loss: 1.2047 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.5335 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2926 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 1.2346 | Train Acc: 0.8000
 Site-Infograph | Train Loss: 2.0919 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.3423 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 1.1641 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 1.1892 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.4144 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.1279 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.2620 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.3524 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.4177 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.1254 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.0941 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.2557 | Val  Acc: 0.7612
 Site-Infograph | Val  Loss: 2.2832 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.2202 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.3991 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.3482 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.1649 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 2.1198 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.3654 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.4864 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6642
============ Train epoch 27 ============
denominator: 37418.69921875
 Site-Clipart   | Train Loss: 1.1873 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.3356 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.2860 | Train Acc: 0.7333
 Site-Clipart   | Train Loss: 1.2435 | Train Acc: 0.7900
 Site-Infograph | Train Loss: 2.1266 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.2489 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.9211 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.1673 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 1.4070 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.0455 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.3739 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.2918 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.3785 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.1253 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.0848 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 1.2209 | Val  Acc: 0.7910
 Site-Infograph | Val  Loss: 2.2471 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.2831 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.3784 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.2913 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 1.1804 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 2.1335 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.3803 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.4368 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6879
 Best site-Clipart    | Epoch:27 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:27 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:27 | Val Acc: 0.8200
 Best site-Clipart    | Epoch:27 | Val Acc: 0.7910
 Best site-Infograph  | Epoch:27 | Val Acc: 0.3000
 Best site-Painting   | Epoch:27 | Val Acc: 0.8000
 Best site-Painting   | Epoch:27 | Val Acc: 0.7273
 Best site-Painting   | Epoch:27 | Val Acc: 0.8235
 Best site-Painting   | Epoch:27 | Val Acc: 0.8261
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.1905
 Best site-Real       | Epoch:27 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:27 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 28 ============
denominator: 37732.22265625
 Site-Clipart   | Train Loss: 1.3584 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2960 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.2905 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.1391 | Train Acc: 0.8000
 Site-Infograph | Train Loss: 1.9727 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.3671 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.3985 | Train Acc: 0.8824
 Site-Painting  | Train Loss: 1.1835 | Train Acc: 0.8462
 Site-Painting  | Train Loss: 1.5091 | Train Acc: 0.7714
 Site-QuickDraw | Train Loss: 2.0652 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.1193 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.4730 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.2947 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.2183 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.0482 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.1680 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 2.1550 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.2786 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.2962 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.2410 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.1980 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.1156 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.3839 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.5343 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6884
 Best site-Clipart    | Epoch:28 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:28 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:28 | Val Acc: 0.7400
 Best site-Clipart    | Epoch:28 | Val Acc: 0.8060
 Best site-Infograph  | Epoch:28 | Val Acc: 0.4000
 Best site-Painting   | Epoch:28 | Val Acc: 0.8000
 Best site-Painting   | Epoch:28 | Val Acc: 0.8182
 Best site-Painting   | Epoch:28 | Val Acc: 0.7647
 Best site-Painting   | Epoch:28 | Val Acc: 0.7826
 Best site-QuickDraw  | Epoch:28 | Val Acc: 0.1905
 Best site-Real       | Epoch:28 | Val Acc: 0.7200
 Best site-Sketch     | Epoch:28 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 29 ============
denominator: 35494.32421875
 Site-Clipart   | Train Loss: 1.1412 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.2694 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.2125 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.1770 | Train Acc: 0.8000
 Site-Infograph | Train Loss: 2.0626 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.2212 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.2571 | Train Acc: 0.8824
 Site-Painting  | Train Loss: 1.0943 | Train Acc: 0.8462
 Site-Painting  | Train Loss: 1.2460 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 2.1321 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.1429 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 1.2993 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.4807 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.1665 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.0065 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.2072 | Val  Acc: 0.6866
 Site-Infograph | Val  Loss: 2.3587 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.2874 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.2521 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.2428 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 1.1777 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 2.1516 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.3645 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.4183 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6357
============ Train epoch 30 ============
denominator: 35867.67578125
 Site-Clipart   | Train Loss: 1.1850 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.2451 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.1949 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.0535 | Train Acc: 0.8000
 Site-Infograph | Train Loss: 2.1280 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.2489 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.9585 | Train Acc: 0.8824
 Site-Painting  | Train Loss: 1.0797 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.2401 | Train Acc: 0.8286
 Site-QuickDraw | Train Loss: 2.0891 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.1578 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.2059 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.1872 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.0556 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 0.9947 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.1850 | Val  Acc: 0.7612
 Site-Infograph | Val  Loss: 2.3578 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.2496 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.2505 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.2884 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.0505 | Val  Acc: 0.9130
 Site-QuickDraw | Val  Loss: 2.1589 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.3568 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.3611 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6931
 Best site-Clipart    | Epoch:30 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:30 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:30 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:30 | Val Acc: 0.7612
 Best site-Infograph  | Epoch:30 | Val Acc: 0.3000
 Best site-Painting   | Epoch:30 | Val Acc: 0.8000
 Best site-Painting   | Epoch:30 | Val Acc: 0.8182
 Best site-Painting   | Epoch:30 | Val Acc: 0.7647
 Best site-Painting   | Epoch:30 | Val Acc: 0.9130
 Best site-QuickDraw  | Epoch:30 | Val Acc: 0.1905
 Best site-Real       | Epoch:30 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:30 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 31 ============
denominator: 35658.61328125
 Site-Clipart   | Train Loss: 1.0948 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.1454 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2019 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 1.0633 | Train Acc: 0.8100
 Site-Infograph | Train Loss: 1.9759 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.2366 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.4496 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 1.0747 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.3739 | Train Acc: 0.7714
 Site-QuickDraw | Train Loss: 2.0724 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.1445 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.1935 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.2743 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.0571 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.0280 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.1575 | Val  Acc: 0.7313
 Site-Infograph | Val  Loss: 2.2136 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.1064 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.2691 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 0.8942 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 1.0473 | Val  Acc: 0.8696
 Site-QuickDraw | Val  Loss: 2.1678 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.2661 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.3829 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6992
 Best site-Clipart    | Epoch:31 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:31 | Val Acc: 0.7576
 Best site-Clipart    | Epoch:31 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:31 | Val Acc: 0.7313
 Best site-Infograph  | Epoch:31 | Val Acc: 0.3000
 Best site-Painting   | Epoch:31 | Val Acc: 0.8000
 Best site-Painting   | Epoch:31 | Val Acc: 0.7273
 Best site-Painting   | Epoch:31 | Val Acc: 0.8824
 Best site-Painting   | Epoch:31 | Val Acc: 0.8696
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.2381
 Best site-Real       | Epoch:31 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:31 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 32 ============
denominator: 35583.51953125
 Site-Clipart   | Train Loss: 1.1300 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.1180 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.1557 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0692 | Train Acc: 0.8000
 Site-Infograph | Train Loss: 1.9921 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 1.2400 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.7215 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 1.1380 | Train Acc: 0.8462
 Site-Painting  | Train Loss: 1.2837 | Train Acc: 0.7429
 Site-QuickDraw | Train Loss: 2.0306 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.0403 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.2077 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.2834 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.1049 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.0128 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.0957 | Val  Acc: 0.7761
 Site-Infograph | Val  Loss: 2.2319 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.1270 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.2124 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.3291 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 1.0888 | Val  Acc: 0.9565
 Site-QuickDraw | Val  Loss: 2.1066 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.2752 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.2879 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7093
 Best site-Clipart    | Epoch:32 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:32 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:32 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:32 | Val Acc: 0.7761
 Best site-Infograph  | Epoch:32 | Val Acc: 0.2500
 Best site-Painting   | Epoch:32 | Val Acc: 0.8000
 Best site-Painting   | Epoch:32 | Val Acc: 0.8182
 Best site-Painting   | Epoch:32 | Val Acc: 0.8235
 Best site-Painting   | Epoch:32 | Val Acc: 0.9565
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.1905
 Best site-Real       | Epoch:32 | Val Acc: 0.7600
 Best site-Sketch     | Epoch:32 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 33 ============
denominator: 35744.75390625
 Site-Clipart   | Train Loss: 1.0280 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.2674 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.1505 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 1.0065 | Train Acc: 0.8500
 Site-Infograph | Train Loss: 1.9698 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.1045 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.3361 | Train Acc: 0.9412
 Site-Painting  | Train Loss: 1.0829 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 1.2092 | Train Acc: 0.7429
 Site-QuickDraw | Train Loss: 2.0800 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.0438 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.0562 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.2954 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.0352 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.9237 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.0856 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 2.3558 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.1729 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.2327 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 0.9775 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 0.9922 | Val  Acc: 0.9130
 Site-QuickDraw | Val  Loss: 2.0923 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.2428 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.3815 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6966
============ Train epoch 34 ============
denominator: 34726.23828125
 Site-Clipart   | Train Loss: 1.0553 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 1.0588 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.1496 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 0.9907 | Train Acc: 0.8700
 Site-Infograph | Train Loss: 1.9845 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.2135 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.7329 | Train Acc: 0.8824
 Site-Painting  | Train Loss: 1.0834 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 1.3153 | Train Acc: 0.7429
 Site-QuickDraw | Train Loss: 2.0145 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.0696 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.3664 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.2209 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.0565 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 0.9087 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0529 | Val  Acc: 0.7761
 Site-Infograph | Val  Loss: 2.0247 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.1142 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.0573 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 1.1762 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 1.0447 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 2.1500 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.2469 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.3825 | Val  Acc: 0.5652
Average Valid Accuracy: 0.7104
 Best site-Clipart    | Epoch:34 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:34 | Val Acc: 0.7576
 Best site-Clipart    | Epoch:34 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:34 | Val Acc: 0.7761
 Best site-Infograph  | Epoch:34 | Val Acc: 0.5000
 Best site-Painting   | Epoch:34 | Val Acc: 0.8000
 Best site-Painting   | Epoch:34 | Val Acc: 0.9091
 Best site-Painting   | Epoch:34 | Val Acc: 0.8824
 Best site-Painting   | Epoch:34 | Val Acc: 0.8261
 Best site-QuickDraw  | Epoch:34 | Val Acc: 0.2381
 Best site-Real       | Epoch:34 | Val Acc: 0.7200
 Best site-Sketch     | Epoch:34 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 35 ============
denominator: 33040.0546875
 Site-Clipart   | Train Loss: 1.0043 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0537 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.1054 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.0605 | Train Acc: 0.8200
 Site-Infograph | Train Loss: 1.9744 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.2154 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.3533 | Train Acc: 0.8824
 Site-Painting  | Train Loss: 1.0263 | Train Acc: 0.8462
 Site-Painting  | Train Loss: 1.2497 | Train Acc: 0.8000
 Site-QuickDraw | Train Loss: 2.0464 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.0198 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.1552 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.3391 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.0146 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 0.8962 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0408 | Val  Acc: 0.7761
 Site-Infograph | Val  Loss: 2.1863 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.0147 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.1461 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 1.1100 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 0.9726 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 2.0888 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.1697 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.3155 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6940
============ Train epoch 36 ============
denominator: 32436.955078125
 Site-Clipart   | Train Loss: 1.0411 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.1439 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.1323 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.9595 | Train Acc: 0.8400
 Site-Infograph | Train Loss: 2.0643 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.0711 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.3061 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 0.9896 | Train Acc: 0.8462
 Site-Painting  | Train Loss: 1.2549 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.0477 | Train Acc: 0.3438
 Site-Real      | Train Loss: 1.0074 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.0732 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.1780 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 0.8940 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.8771 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.0436 | Val  Acc: 0.7761
 Site-Infograph | Val  Loss: 2.0922 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 1.1067 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.0402 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 0.9965 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 0.9198 | Val  Acc: 0.9130
 Site-QuickDraw | Val  Loss: 2.1224 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.1694 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.3253 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7235
 Best site-Clipart    | Epoch:36 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:36 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:36 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:36 | Val Acc: 0.7761
 Best site-Infograph  | Epoch:36 | Val Acc: 0.4500
 Best site-Painting   | Epoch:36 | Val Acc: 0.8000
 Best site-Painting   | Epoch:36 | Val Acc: 0.9091
 Best site-Painting   | Epoch:36 | Val Acc: 0.8235
 Best site-Painting   | Epoch:36 | Val Acc: 0.9130
 Best site-QuickDraw  | Epoch:36 | Val Acc: 0.2857
 Best site-Real       | Epoch:36 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:36 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 37 ============
denominator: 32353.705078125
 Site-Clipart   | Train Loss: 1.0159 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 1.0611 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.1154 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0404 | Train Acc: 0.8200
 Site-Infograph | Train Loss: 1.9315 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.2160 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 1.1678 | Train Acc: 0.8824
 Site-Painting  | Train Loss: 1.0412 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 1.3296 | Train Acc: 0.7714
 Site-QuickDraw | Train Loss: 2.0515 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.9504 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.1146 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.1507 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.0366 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.8475 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 1.0006 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 2.1035 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 1.1459 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.9105 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 1.0396 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 0.9350 | Val  Acc: 0.9565
 Site-QuickDraw | Val  Loss: 2.0615 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.1470 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.2820 | Val  Acc: 0.5652
Average Valid Accuracy: 0.7274
 Best site-Clipart    | Epoch:37 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:37 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:37 | Val Acc: 0.7600
 Best site-Clipart    | Epoch:37 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:37 | Val Acc: 0.4500
 Best site-Painting   | Epoch:37 | Val Acc: 0.6000
 Best site-Painting   | Epoch:37 | Val Acc: 0.9091
 Best site-Painting   | Epoch:37 | Val Acc: 0.7647
 Best site-Painting   | Epoch:37 | Val Acc: 0.9565
 Best site-QuickDraw  | Epoch:37 | Val Acc: 0.3333
 Best site-Real       | Epoch:37 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:37 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 38 ============
denominator: 31713.673828125
 Site-Clipart   | Train Loss: 0.9506 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0423 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0781 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 0.9409 | Train Acc: 0.8300
 Site-Infograph | Train Loss: 2.0141 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.0445 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.2795 | Train Acc: 0.9412
 Site-Painting  | Train Loss: 1.0188 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.0878 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 1.9843 | Train Acc: 0.3750
 Site-Real      | Train Loss: 1.0389 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.4009 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.2138 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.9266 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.8917 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0549 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 2.2242 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.9831 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.9584 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 0.9359 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 0.8893 | Val  Acc: 0.8696
 Site-QuickDraw | Val  Loss: 2.1303 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.1631 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.3148 | Val  Acc: 0.5652
Average Valid Accuracy: 0.7264
============ Train epoch 39 ============
denominator: 32971.328125
 Site-Clipart   | Train Loss: 0.9105 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.9912 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.0513 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9491 | Train Acc: 0.8300
 Site-Infograph | Train Loss: 2.0687 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 0.9070 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.3975 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 0.9293 | Train Acc: 0.9615
 Site-Painting  | Train Loss: 0.9822 | Train Acc: 0.8286
 Site-QuickDraw | Train Loss: 2.0068 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.9975 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.2521 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.0489 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.9978 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.8453 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 1.0279 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 2.1850 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.9412 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.0583 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 0.8140 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 0.9122 | Val  Acc: 0.8696
 Site-QuickDraw | Val  Loss: 2.0958 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.0958 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.2606 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7364
 Best site-Clipart    | Epoch:39 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:39 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:39 | Val Acc: 0.8400
 Best site-Clipart    | Epoch:39 | Val Acc: 0.8060
 Best site-Infograph  | Epoch:39 | Val Acc: 0.4500
 Best site-Painting   | Epoch:39 | Val Acc: 0.8000
 Best site-Painting   | Epoch:39 | Val Acc: 0.8182
 Best site-Painting   | Epoch:39 | Val Acc: 0.8824
 Best site-Painting   | Epoch:39 | Val Acc: 0.8696
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.1905
 Best site-Real       | Epoch:39 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:39 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.8042
 Test site-Infograph | Epoch:39 | Test Acc: 0.4186
 Test site-Painting  | Epoch:39 | Test Acc: 0.7722
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.3380
 Test site-Real      | Epoch:39 | Test Acc: 0.8472
 Test site-Sketch    | Epoch:39 | Test Acc: 0.6968
Average Test Accuracy: 0.6461
============ Train epoch 40 ============
denominator: 32407.0
 Site-Clipart   | Train Loss: 0.9603 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0310 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 1.0552 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 0.9913 | Train Acc: 0.8200
 Site-Infograph | Train Loss: 1.9345 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.0461 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.8072 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 0.9613 | Train Acc: 0.8846
 Site-Painting  | Train Loss: 1.2217 | Train Acc: 0.7714
 Site-QuickDraw | Train Loss: 1.9490 | Train Acc: 0.4062
 Site-Real      | Train Loss: 0.9713 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.0274 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.1855 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 0.8861 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.7622 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 1.0317 | Val  Acc: 0.7612
 Site-Infograph | Val  Loss: 2.1059 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.9526 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.1079 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 0.9019 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 0.9480 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 2.0559 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.1546 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.2892 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7176
============ Train epoch 41 ============
denominator: 32063.775390625
 Site-Clipart   | Train Loss: 0.9094 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0428 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.9877 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9691 | Train Acc: 0.8100
 Site-Infograph | Train Loss: 1.9305 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.0141 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.8833 | Train Acc: 0.8824
 Site-Painting  | Train Loss: 0.9383 | Train Acc: 0.8846
 Site-Painting  | Train Loss: 1.3390 | Train Acc: 0.7429
 Site-QuickDraw | Train Loss: 1.9883 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.8566 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.0056 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.9841 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.9402 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.7784 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 1.0154 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 2.0188 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.9530 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.9635 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 0.9505 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 0.9008 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 1.9873 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.1221 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.2654 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7475
 Best site-Clipart    | Epoch:41 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:41 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:41 | Val Acc: 0.8400
 Best site-Clipart    | Epoch:41 | Val Acc: 0.8507
 Best site-Infograph  | Epoch:41 | Val Acc: 0.4000
 Best site-Painting   | Epoch:41 | Val Acc: 0.8000
 Best site-Painting   | Epoch:41 | Val Acc: 0.9091
 Best site-Painting   | Epoch:41 | Val Acc: 0.8235
 Best site-Painting   | Epoch:41 | Val Acc: 0.7826
 Best site-QuickDraw  | Epoch:41 | Val Acc: 0.2857
 Best site-Real       | Epoch:41 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:41 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 42 ============
denominator: 30636.9921875
 Site-Clipart   | Train Loss: 0.9912 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.9618 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.0241 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.9377 | Train Acc: 0.8700
 Site-Infograph | Train Loss: 1.9955 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 1.0127 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.1845 | Train Acc: 0.9412
 Site-Painting  | Train Loss: 0.9885 | Train Acc: 0.8462
 Site-Painting  | Train Loss: 1.0654 | Train Acc: 0.8000
 Site-QuickDraw | Train Loss: 1.9885 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.9062 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.8949 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.0711 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.9290 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7686 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.9841 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 2.0908 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.8926 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.1196 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.1159 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 0.8189 | Val  Acc: 0.9130
 Site-QuickDraw | Val  Loss: 2.0429 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.0618 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.2476 | Val  Acc: 0.5652
Average Valid Accuracy: 0.7178
============ Train epoch 43 ============
denominator: 30458.361328125
 Site-Clipart   | Train Loss: 0.7495 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.9261 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.9676 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8568 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.9536 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.9804 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.3966 | Train Acc: 0.8824
 Site-Painting  | Train Loss: 0.9196 | Train Acc: 0.8462
 Site-Painting  | Train Loss: 1.1272 | Train Acc: 0.7429
 Site-QuickDraw | Train Loss: 1.9675 | Train Acc: 0.3438
 Site-Real      | Train Loss: 0.8578 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.8835 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0176 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.8395 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.8139 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 0.9300 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 2.1450 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.9625 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.9348 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 0.8248 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 0.8897 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 2.0471 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.0618 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.1837 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7439
============ Train epoch 44 ============
denominator: 32390.107421875
 Site-Clipart   | Train Loss: 0.8790 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8924 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.9435 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8878 | Train Acc: 0.8500
 Site-Infograph | Train Loss: 1.9438 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.9836 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.3598 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 0.8866 | Train Acc: 0.9231
 Site-Painting  | Train Loss: 1.2070 | Train Acc: 0.7714
 Site-QuickDraw | Train Loss: 1.9630 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.8725 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.0419 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.9832 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.8646 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.7689 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.9784 | Val  Acc: 0.7463
 Site-Infograph | Val  Loss: 2.1332 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.9393 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.0865 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 0.8914 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 0.8442 | Val  Acc: 0.8696
 Site-QuickDraw | Val  Loss: 2.0671 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.0245 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.1568 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7207
============ Train epoch 45 ============
denominator: 29808.9296875
 Site-Clipart   | Train Loss: 0.8407 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.1039 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.9601 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 0.9124 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.9776 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.9212 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.1115 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 0.8339 | Train Acc: 0.8462
 Site-Painting  | Train Loss: 0.9398 | Train Acc: 0.8286
 Site-QuickDraw | Train Loss: 2.0181 | Train Acc: 0.4062
 Site-Real      | Train Loss: 0.9448 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.9125 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.0062 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.8305 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.7450 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.9007 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 2.0446 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.7987 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.9388 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 0.9922 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 0.8087 | Val  Acc: 0.8696
 Site-QuickDraw | Val  Loss: 2.0077 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.0679 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.1796 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7386
============ Train epoch 46 ============
denominator: 30847.322265625
 Site-Clipart   | Train Loss: 0.8749 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 1.0619 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.8992 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8286 | Train Acc: 0.8400
 Site-Infograph | Train Loss: 1.9503 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 0.9128 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.7057 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 0.9436 | Train Acc: 0.8846
 Site-Painting  | Train Loss: 1.0711 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.9392 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.8840 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.1402 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.0343 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.8236 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.7147 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 0.8886 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 2.2132 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 0.9066 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.9294 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 0.8898 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 0.8333 | Val  Acc: 0.9565
 Site-QuickDraw | Val  Loss: 1.9912 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.0182 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.1388 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7362
============ Train epoch 47 ============
denominator: 29061.033203125
 Site-Clipart   | Train Loss: 0.8470 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8155 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.9003 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8212 | Train Acc: 0.8900
 Site-Infograph | Train Loss: 1.8985 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.9341 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.5587 | Train Acc: 0.8824
 Site-Painting  | Train Loss: 0.8376 | Train Acc: 0.8846
 Site-Painting  | Train Loss: 0.8544 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.9723 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.7392 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.0359 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8822 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8020 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.7409 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.8189 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 2.0589 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.8854 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.0840 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 0.7656 | Val  Acc: 0.9412
 Site-Painting  | Val  Loss: 0.7148 | Val  Acc: 0.9565
 Site-QuickDraw | Val  Loss: 1.9916 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.0458 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.2427 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7606
 Best site-Clipart    | Epoch:47 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:47 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:47 | Val Acc: 0.8200
 Best site-Clipart    | Epoch:47 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:47 | Val Acc: 0.3500
 Best site-Painting   | Epoch:47 | Val Acc: 1.0000
 Best site-Painting   | Epoch:47 | Val Acc: 0.8182
 Best site-Painting   | Epoch:47 | Val Acc: 0.9412
 Best site-Painting   | Epoch:47 | Val Acc: 0.9565
 Best site-QuickDraw  | Epoch:47 | Val Acc: 0.2381
 Best site-Real       | Epoch:47 | Val Acc: 0.7600
 Best site-Sketch     | Epoch:47 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-FFL...
============ Train epoch 48 ============
denominator: 29065.99609375
 Site-Clipart   | Train Loss: 0.7702 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7866 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8902 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8481 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.9323 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.8883 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.9503 | Train Acc: 0.9412
 Site-Painting  | Train Loss: 0.8667 | Train Acc: 0.8462
 Site-Painting  | Train Loss: 0.9409 | Train Acc: 0.8000
 Site-QuickDraw | Train Loss: 1.9147 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.8244 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 0.8774 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.9405 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7873 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7178 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.9037 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 2.1805 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.8020 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.8735 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 1.0000 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 0.7954 | Val  Acc: 0.9565
 Site-QuickDraw | Val  Loss: 1.9726 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.9870 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.1807 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7510
============ Train epoch 49 ============
denominator: 28976.720703125
 Site-Clipart   | Train Loss: 0.8134 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9653 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.9099 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7671 | Train Acc: 0.8700
 Site-Infograph | Train Loss: 1.8595 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.8268 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.5929 | Train Acc: 0.8824
 Site-Painting  | Train Loss: 0.8643 | Train Acc: 0.8846
 Site-Painting  | Train Loss: 1.0204 | Train Acc: 0.8286
 Site-QuickDraw | Train Loss: 1.9786 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.8005 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.0361 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.9706 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.7578 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.7426 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.8581 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 2.0507 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.7859 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.9868 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 0.9030 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 0.7320 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.9811 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.9461 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.1408 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7469
===2023-04-16 22:12:51===
===2023-04-16 22:16:07===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,8,17,26,35,32,38,35,]
label set of clients: [10, 10, 10, 10, 10, 6, 10, 10, 10, 10, 10, 9, ]
domain number = 6
=================================
=== model type: cocoop ===
=================================
Loading snapshots...
 Test site-Clipart   | Epoch:47 | Test Acc: 0.8270
 Test site-Infograph | Epoch:47 | Test Acc: 0.4384
 Test site-Painting  | Epoch:47 | Test Acc: 0.7964
 Test site-QuickDraw | Epoch:47 | Test Acc: 0.3530
 Test site-Real      | Epoch:47 | Test Acc: 0.8767
 Test site-Sketch    | Epoch:47 | Test Acc: 0.7365
Average Test Accuracy: 0.6713
